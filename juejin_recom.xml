<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[å¤§æ•°æ®-183 Elasticsearch - å¹¶å‘å†²çªä¸ä¹è§‚é”ã€åˆ†å¸ƒå¼æ•°æ®ä¸€è‡´æ€§å‰–æ]]></title>    <link>https://juejin.cn/post/7582904081864310825</link>    <guid>https://juejin.cn/post/7582904081864310825</guid>    <pubDate>2025-12-14T05:39:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582904081864310825" data-draft-id="7583293030172557358" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§æ•°æ®-183 Elasticsearch - å¹¶å‘å†²çªä¸ä¹è§‚é”ã€åˆ†å¸ƒå¼æ•°æ®ä¸€è‡´æ€§å‰–æ"/> <meta itemprop="keywords" content="åç«¯,å¤§æ•°æ®,Elasticsearch"/> <meta itemprop="datePublished" content="2025-12-14T05:39:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ­¦å­åº·"/> <meta itemprop="url" content="https://juejin.cn/user/149189314230039"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§æ•°æ®-183 Elasticsearch - å¹¶å‘å†²çªä¸ä¹è§‚é”ã€åˆ†å¸ƒå¼æ•°æ®ä¸€è‡´æ€§å‰–æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/149189314230039/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ­¦å­åº·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T05:39:06.000Z" title="Sun Dec 14 2025 05:39:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">TL;DR</h2>
<ul>
<li>åœºæ™¯ï¼šç”µå•†æ‰£åº“å­˜å¹¶å‘æ›´æ–°ï¼Œè¯»-æ”¹-å†™åœ¨å¤šçº¿ç¨‹/å¤šå®¢æˆ·ç«¯ä¸‹å‘ç”Ÿå†™è¦†ç›–</li>
<li>ç»“è®ºï¼šES ç”¨ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆseq_no + primary_termï¼‰æ‹’ç»ä¹±åº/å¹¶å‘å†™ï¼Œå†²çªè¿”å› 409</li>
<li>äº§å‡ºï¼šæœ€å°å¤ç°è¯·æ±‚ã€409 é€ŸæŸ¥ä¸ä¿®å¤è·¯å¾„ã€ES5 å‰åå†™ä¸€è‡´æ€§å‚æ•°æ›¿ä»£å¯¹ç…§</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2867dbe5ae7647fea5ef1902f5235153~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766295546&amp;x-signature=9h%2BTvCfS5GFV2%2BjHQ3jXweF5VDw%3D" alt="å¤§æ•°æ®-183 Elasticsearch - å¹¶å‘å†²çªä¸ä¹è§‚é”ã€åˆ†å¸ƒå¼æ•°æ®ä¸€è‡´æ€§å‰–æ" loading="lazy"/></p>
<h2 data-id="heading-1">ç‰ˆæœ¬çŸ©é˜µ</h2>





















<table><thead><tr><th>é¡¹ç›®</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>ä¹è§‚é”æ§åˆ¶</td><td>æ–‡ä¸­æ›´æ–°å†²çªä½¿ç”¨ <code>if_seq_no</code>/<code>if_primary_term</code> ä¸”è¿”å›åŒ…å« <code>seqNo</code> ä¸ <code>primary term</code>ï¼Œè¿™å±äº ES 6+ çš„ OCC è¯­ä¹‰ï¼›å…·ä½“å°ç‰ˆæœ¬æœªåœ¨æ­£æ–‡æ ‡æ³¨</td></tr><tr><td>ç‰ˆæœ¬å·æ¦‚å¿µ</td><td>éƒ¨åˆ†æ–‡ä¸­æåˆ° <code>_version</code> ä½œä¸ºä¹è§‚é”ç‰ˆæœ¬å·æ¦‚å¿µæˆç«‹ï¼›å·¥ç¨‹ä¸Šä»¥ <code>if_seq_no</code>/<code>if_primary_term</code> ä½œä¸ºæ¡ä»¶æ›´æ–°æ›´è´´è¿‘å½“å‰ ES å®è·µï¼ˆæ­£æ–‡å·²ç”¨è¯¥æ–¹å¼å¤ç° 409ï¼‰</td></tr><tr><td>åˆ†ç‰‡ä¸€è‡´æ€§è¯­ä¹‰</td><td>ES5.0 å‰ <code>consistency</code>/<code>quorum</code>ã€ES5.0 å <code>wait_for_active_shards</code> çš„è¯­ä¹‰å¯¹æ¯”åœ¨æ­£æ–‡ç»™å‡ºï¼›æœªç»™å‡ºå®é™…é›†ç¾¤ç‰ˆæœ¬ä¸éªŒè¯æˆªå›¾å¯¹åº”å…³ç³»</td></tr></tbody></table>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ea0e5fe4f7324d749b8914a98923bf25~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766295546&amp;x-signature=AdaQzXyhgFnOxALc4xoIqamEZBw%3D" alt="Elasticsearch" loading="lazy"/></p>
<h2 data-id="heading-2">è¯¦è§£å¹¶å‘å†²çª</h2>
<p>åœ¨ç”µå•†åœºæ™¯ä¸‹ï¼Œå·¥ä½œæµç¨‹ä¸ºï¼š</p>
<ul>
<li>è¯»å–å•†å“ä¿¡æ¯ï¼ŒåŒ…æ‹¬åº“å­˜æ•°é‡</li>
<li>ç”¨æˆ·ä¸‹å•è´­ä¹°</li>
<li>æ›´æ–°å•†å“ä¿¡æ¯ï¼Œå°†åº“å­˜æ•°å‡ä¸€</li>
</ul>
<p>å¦‚æœæ˜¯å¤šçº¿ç¨‹æ“ä½œï¼Œå°±å¯èƒ½æœ‰å¤šä¸ªçº¿ç¨‹å¹¶å‘çš„å»æ‰§è¡Œä¸Šè¿°çš„3æ­¥éª¤æµç¨‹ï¼Œå‡å¦‚æ­¤æ—¶æœ‰ä¸¤ä¸ªäººéƒ½æ¥è¯»å–å•†å“æ•°æ®ï¼Œä¸¤ä¸ªçº¿ç¨‹å¹¶å‘çš„æœåŠ¡äºä¸¤ä¸ªäººï¼ŒåŒæ—¶åœ¨è¿›è¡Œå•†å“åº“å­˜æ•°æ®çš„ä¿®æ”¹ï¼Œå‡è®¾åº“å­˜ä¸º100ä»¶ï¼Œæ­£ç¡®çš„æƒ…å†µï¼šçº¿ç¨‹Aå°†åº“å­˜-1ï¼Œè®¾ç½®ä¸º99ä»¶ï¼Œçº¿ç¨‹Bè¯»å–99å†-1ï¼Œè®¾ç½®ä¸º98ä»¶ã€‚ä½†æ˜¯å¦‚æœAå’ŒBéƒ½æ˜¯è¯»å–çš„99ä»¶ï¼Œé‚£ä¹ˆåç»­å°±ä¼šå‡ºç°æ•°é‡é”™è¯¯çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-3">è§£å†³æ–¹æ¡ˆ</h3>
<h4 data-id="heading-4">æ‚²è§‚é”</h4>
<p>æ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™è®¤ä¸ºéƒ½ä¼šè¢«äººä¿®æ”¹ï¼Œæ‰€æœ‰æ¯æ¬¡æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šåŠ é”ï¼Œä»¥é˜²æ­¢åˆ«äººä¿®æ”¹ï¼Œç›´åˆ°æ“ä½œå®Œæˆåï¼Œå†é‡Šæ”¾é”ï¼Œæ‰ä¼šè¢«åˆ«äººæ‹¿å»æ‰§è¡Œã€‚
å¸¸è§çš„å…³ç³»å‹æ•°æ®åº“ï¼Œå°±ç”¨åˆ°äº†å¦‚è¡Œé”ã€è¡¨é”ã€å†™é”ï¼Œéƒ½æ˜¯åœ¨æ“ä½œä¹‹å‰çš„é”ã€‚</p>
<ul>
<li>æ‚²è§‚é”ä¼˜ç‚¹ï¼šæ–¹ä¾¿ç›´æ¥åŠ é”ï¼Œå¯¹å¤–é€æ˜ï¼Œä¸éœ€è¦é¢å¤–çš„æ“ä½œã€‚</li>
<li>æ‚²è§‚é”ç¼ºç‚¹ï¼šå¹¶å‘èƒ½åŠ›ä½ï¼ŒåŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªæ“ä½œã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/166a4a04e5b941d9a27dbb0f49e9c6cd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766295546&amp;x-signature=VPyUO9quvvSos5L3G7QxmCp4Mxk%3D" alt="æ‚²è§‚é”" loading="lazy"/></p>
<h4 data-id="heading-5">ä¹è§‚é”</h4>
<p>ä¹è§‚é”ä¸åŠ é”ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½å¯ä»¥ä»»æ„æ“ä½œã€‚æ¯”å¦‚æ¯æ¡æ–‡æ¡£ä¸­éƒ½æœ‰ä¸€ä¸ªversionå­—æ®µï¼Œæ–°å»ºæ–‡æ¡£åä¸º1ï¼Œæ¯æ¬¡ä¿®æ”¹éƒ½è¿›è¡Œç´¯åŠ ï¼Œçº¿ç¨‹Aå’ŒBéƒ½æ‹¿åˆ°versionä¸º1ï¼Œç­‰å†™å…¥æ—¶ä¼šå’ŒESä¸­çš„ç‰ˆæœ¬å·è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç›¸ç­‰åˆ™å†™å…¥æˆåŠŸï¼Œå¤±è´¥åˆ™é‡æ–°è¯»å–æ•°æ®å†-1ï¼Œå†è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœç›¸ç­‰åˆ™å†™å…¥æˆåŠŸã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af3c712deb854fbd94f56ded8da58976~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766295546&amp;x-signature=4XjMaHWL3D7FIPiPpfVFRJ4joEo%3D" alt="ä¹è§‚é”" loading="lazy"/></p>
<h4 data-id="heading-6">Elasticsearchçš„ä¹è§‚é”</h4>
<p>Elasticsearchçš„åå°å¤„ç†æœºåˆ¶é‡‡ç”¨å¤šçº¿ç¨‹å¼‚æ­¥æ¶æ„ï¼Œè¿™ç§è®¾è®¡è™½ç„¶æé«˜äº†ç³»ç»Ÿååé‡ï¼Œä½†ä¹Ÿå¸¦æ¥äº†è¯·æ±‚å¤„ç†çš„ä¹±åºé—®é¢˜ã€‚åœ¨å®é™…æ“ä½œä¸­ï¼Œå¯èƒ½ä¼šå‡ºç°ä»¥ä¸‹åœºæ™¯ï¼šç”¨æˆ·å…ˆå‘é€äº†ä¿®æ”¹è¯·æ±‚Aï¼Œç´§æ¥ç€åˆå‘é€äº†ä¿®æ”¹è¯·æ±‚Bï¼Œä½†ç”±äºç½‘ç»œå»¶è¿Ÿæˆ–çº¿ç¨‹è°ƒåº¦åŸå› ï¼Œè¯·æ±‚Bå¯èƒ½ä¼šå…ˆäºè¯·æ±‚Aåˆ°è¾¾æœåŠ¡ç«¯è¿›è¡Œå¤„ç†ã€‚</p>
<p>ä¸ºäº†åº”å¯¹è¿™ç§å¹¶å‘ä¿®æ”¹å¸¦æ¥çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼ŒElasticsearchå®ç°äº†ä¸€å¥—åŸºäºç‰ˆæœ¬å·(_version)çš„ä¹è§‚é”å¹¶å‘æ§åˆ¶æœºåˆ¶ã€‚å…·ä½“å·¥ä½œåŸç†å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p>ç‰ˆæœ¬å·æ¯”è¾ƒæœºåˆ¶ï¼š</p>
<ul>
<li>æ¯ä¸ªæ–‡æ¡£éƒ½æœ‰ä¸€ä¸ªé€’å¢çš„ç‰ˆæœ¬å·å­—æ®µ</li>
<li>å½“åå‘è¯·æ±‚å…ˆåˆ°è¾¾æ—¶ï¼ˆè¯·æ±‚Bï¼‰ï¼Œç³»ç»Ÿä¼šæ¯”è¾ƒè¯·æ±‚æºå¸¦çš„ç‰ˆæœ¬å·ä¸å½“å‰æ–‡æ¡£ç‰ˆæœ¬å·</li>
<li>å¦‚æœç‰ˆæœ¬å·åŒ¹é…ï¼ˆè¯´æ˜æ²¡æœ‰å…¶ä»–ä¿®æ”¹ï¼‰ï¼Œåˆ™æ‰§è¡Œæ›´æ–°å¹¶å°†ç‰ˆæœ¬å·+1</li>
<li>å½“å…ˆå‘è¯·æ±‚ååˆ°è¾¾æ—¶ï¼ˆè¯·æ±‚Aï¼‰ï¼Œç”±äºæ–‡æ¡£ç‰ˆæœ¬å·å·²è¢«è¯·æ±‚Bæ›´æ–°ï¼Œæ­¤æ—¶ç‰ˆæœ¬å·ä¸åŒ¹é…ï¼Œç³»ç»Ÿä¼šæ‹’ç»æœ¬æ¬¡ä¿®æ”¹</li>
</ul>
</li>
<li>
<p>å†²çªè§£å†³æµç¨‹ï¼š</p>
<ul>
<li>å½“ä¿®æ”¹å› ç‰ˆæœ¬å†²çªè¢«æ‹’ç»æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ï¼š
<ol>
<li>é‡æ–°è¯»å–æ–‡æ¡£æœ€æ–°æ•°æ®ï¼ˆåŒ…å«æœ€æ–°ç‰ˆæœ¬å·ï¼‰</li>
<li>åŸºäºæœ€æ–°æ•°æ®é‡æ–°åº”ç”¨ä¿®æ”¹</li>
<li>å†æ¬¡å°è¯•æäº¤æ›´æ–°</li>
</ol>
</li>
<li>è¿™ä¸ªè¿‡ç¨‹ä¼šå¾ªç¯æ‰§è¡Œï¼Œç›´åˆ°ä¿®æ”¹æˆåŠŸæˆ–è¾¾åˆ°é‡è¯•ä¸Šé™</li>
</ul>
</li>
<li>
<p>åˆ é™¤æ“ä½œçš„ç‰¹æ®Šå¤„ç†ï¼š</p>
<ul>
<li>åˆ é™¤æ“ä½œä¹Ÿä¼šè§¦å‘ç‰ˆæœ¬å·é€’å¢ï¼ˆ+1ï¼‰</li>
<li>åˆ é™¤åæ–‡æ¡£å¹¶éç«‹å³ç‰©ç†åˆ é™¤ï¼Œè€Œæ˜¯è¿›å…¥"é€»è¾‘åˆ é™¤"çŠ¶æ€</li>
<li>è¿™ç§è®¾è®¡å¸¦æ¥ä¸¤ä¸ªé‡è¦ç‰¹æ€§ï¼š
<ul>
<li>ç‰ˆæœ¬å·ä¿¡æ¯ä¼šè¢«ä¿ç•™ä¸€æ®µæ—¶é—´</li>
<li>é‡æ–°åˆ›å»ºåŒåæ–‡æ¡£æ—¶ï¼Œæ–°æ–‡æ¡£ç‰ˆæœ¬å·ä¼šåœ¨åˆ é™¤ç‰ˆæœ¬åŸºç¡€ä¸Šç»§ç»­é€’å¢</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>åº”ç”¨åœºæ™¯ç¤ºä¾‹ï¼š
å‡è®¾æœ‰ä¸€ä¸ªå•†å“åº“å­˜æ–‡æ¡£ï¼ˆID:123ï¼Œversion:5ï¼Œstock:100ï¼‰ï¼š</p>
<ol>
<li>è¯·æ±‚Aï¼ˆå‡åº“å­˜10ï¼‰ï¼šæœŸæœ›version=5â†’6ï¼Œstock=90</li>
<li>è¯·æ±‚Bï¼ˆå‡åº“å­˜20ï¼‰ï¼šæœŸæœ›version=5â†’6ï¼Œstock=80
å¦‚æœè¯·æ±‚Bå…ˆåˆ°è¾¾ï¼š</li>
</ol>
<ul>
<li>è¯·æ±‚BæˆåŠŸï¼ˆversion=6ï¼Œstock=80ï¼‰</li>
<li>è¯·æ±‚Aåˆ°è¾¾æ—¶å‘ç°versionå·²å˜ä¸º6ï¼ˆä¸æºå¸¦çš„5ä¸åŒ¹é…ï¼‰</li>
<li>ç³»ç»Ÿé‡æ–°è¯»å–æ•°æ®ï¼ˆversion=6ï¼Œstock=80ï¼‰</li>
<li>åŸºäºæ–°æ•°æ®æ‰§è¡Œå‡10æ“ä½œï¼ˆversion=7ï¼Œstock=70ï¼‰</li>
</ul>
<p>è¿™ç§æœºåˆ¶ç¡®ä¿äº†åœ¨é«˜å¹¶å‘ç¯å¢ƒä¸‹ï¼Œæ•°æ®ä¿®æ”¹çš„æœ€ç»ˆä¸€è‡´æ€§ï¼ŒåŒæ—¶é¿å…äº†ä¼ ç»Ÿé”æœºåˆ¶å¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚</p>
<h3 data-id="heading-7">Elasticsearchçš„ä¹è§‚é”æµ‹è¯•</h3>
<p>æ–°å»ºä¸€æ¡æ•°æ®ï¼š</p>
<pre><code class="hljs language-json" lang="json">PUT /wzk_lock_index/_doc/<span class="hljs-number">1</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"test_field"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"wzkicu"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>æ‰§è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ° _version æ˜¯1ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4137971b88a842d984f35bbb3e08eb76~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766295546&amp;x-signature=1CV0RIh2wj1EfBs3CRmdAwATwxk%3D" alt="Elasticsearch ä¹è§‚é”" loading="lazy"/></p>
<p>å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰Aå’ŒBä¸¤ä¸ªå®¢æˆ·ç«¯åŒæ—¶æ‹¿åˆ°äº†æ•°æ®ï¼Œæƒ³è¦è¿›è¡Œæ›´æ–°ï¼š</p>
<pre><code class="hljs language-json" lang="json"># A æ›´æ–°
PUT /wzk_lock_index/_doc/<span class="hljs-number">1</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"test_field"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"client1 update"</span>
<span class="hljs-punctuation">}</span>

</code></pre>
<p>å¯ä»¥çœ‹åˆ°æ‰§è¡Œç»“æœï¼Œé¡ºåˆ©æ›´æ–°äº†ï¼Œ_versionå˜æˆäº†2ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd9621fbe4a1417d860527a2311900bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766295546&amp;x-signature=1gb1b1oHo64oMjUIBZpGl8XmHl4%3D" alt="Elasticsearch æ›´æ–°æ•°æ®" loading="lazy"/></p>
<p>æ­¤æ—¶Båœ¨åŒä¸€æ—¶é—´è¦è¿›è¡Œæ›´æ–°ï¼š</p>
<pre><code class="hljs language-json" lang="json"># B æ›´æ–°
PUT /wzk_lock_index/_doc/<span class="hljs-number">1</span>?if_seq_no=<span class="hljs-number">0</span>&amp;if_primary_term=<span class="hljs-number">1</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"test_field"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"client2 update"</span>
<span class="hljs-punctuation">}</span>

</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶æŠ¥é”™äº†ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"error"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"root_cause"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"version_conflict_engine_exception"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"[1]: version conflict, required seqNo [0], primary term [1]. current document has seqNo [1] and primary term [1]"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"index_uuid"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"BBxoVVVqSw2TxtU-vPd-NA"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"shard"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"index"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"wzk_lock_index"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"version_conflict_engine_exception"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"[1]: version conflict, required seqNo [0], primary term [1]. current document has seqNo [1] and primary term [1]"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"index_uuid"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"BBxoVVVqSw2TxtU-vPd-NA"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"shard"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"index"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"wzk_lock_index"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">409</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å¯¹åº”çš„æˆªå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/582b91516942454fbd539610cfc4ad8f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766295546&amp;x-signature=sEsZNwvp%2BM6tmApIN8eX7ci13JI%3D" alt="Elasticsearch æ›´æ–°æ•°æ®" loading="lazy"/></p>
<p>è¿™è¯´æ˜æˆ‘ä»¬çš„ä¹è§‚é”æ˜¯ç”Ÿæ•ˆçš„ï¼Œé˜»æ­¢äº†å¹¶å‘çš„é—®é¢˜ã€‚
æˆ‘ä»¬éœ€è¦é‡æ–° GETè¯·æ±‚è·å–å½“å‰çš„ç‰ˆæœ¬ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">GET /wzk_lock_index/_doc/1
</code></pre>
<p>è·å–åˆ°å½“å‰çš„ version æ˜¯ 2ã€seq_noæ˜¯1ï¼Œprimary_termæ˜¯1ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9b156edef6244b6a24c5e1e2487f4f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766295546&amp;x-signature=LCqjFRng4UsDswjXUJlso4vRZgA%3D" alt="Elasticsearch è·å–" loading="lazy"/></p>
<p>Bå®¢æˆ·ç«¯é‡æ–°å‘èµ·æ›´æ–°ï¼š</p>
<pre><code class="hljs language-json" lang="json"># B å†æ¬¡æ›´æ–°
PUT /wzk_lock_index/_doc/<span class="hljs-number">1</span>?if_seq_no=<span class="hljs-number">1</span>&amp;if_primary_term=<span class="hljs-number">1</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"test_field"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"client2 update"</span>
<span class="hljs-punctuation">}</span>

</code></pre>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ‰§è¡ŒæˆåŠŸäº†ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc9f662496c0413faf4ae81ee9fef3a3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766295546&amp;x-signature=zQblZ1RtJNKgSaTyjMpZhdhaFpo%3D" alt="Elasticsearch æ›´æ–°è¯·æ±‚" loading="lazy"/></p>
<h2 data-id="heading-8">åˆ†å¸ƒå¼æ•°æ®ä¸€è‡´æ€§</h2>
<p>åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œä¸€è‡´æ€§æŒ‡çš„æ˜¯å¤šä¸ªæ•°æ®å‰¯æœ¬æ˜¯å¦èƒ½ä¿æŒä¸€è‡´çš„ç‰¹æ€§ã€‚åœ¨ä¸€è‡´æ€§æ¡ä»¶ä¸‹ï¼Œç³»ç»Ÿåœ¨æ‰§è¡Œæ•°æ®æ›´æ–°æ“ä½œä¹‹åèƒ½å¤Ÿä»ä¸€è‡´æ€§çŠ¶æ€åˆ°å¦ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ï¼Œå¯¹ç³»ç»Ÿçš„ä¸€ä¸ªæ•°æ®æ›´æ–°æˆåŠŸä¹‹åï¼Œå¦‚æœæ‰€æœ‰ç”¨æˆ·éƒ½èƒ½å¤Ÿè¯»å–åˆ°æœ€æ–°çš„å€¼ï¼Œè¯¥ç³»ç»Ÿå°±è¢«è®¤ä¸ºå…·æœ‰å¼ºä¸€è‡´æ€§ã€‚</p>
<h3 data-id="heading-9">ES5.0ä»¥å‰çš„ä¸€è‡´æ€§</h3>
<ul>
<li>consistency</li>
<li>one(primary shard)</li>
<li>all(all shard)</li>
<li>quorum(default)</li>
</ul>
<p>æˆ‘ä»¬åœ¨å‘é€ä»»ä½•ä¸€ä¸ªå¢åˆ æ”¹æŸ¥çš„æ—¶å€™ï¼Œæ¯”å¦‚PUTæ—¶ï¼Œéƒ½å¯ä»¥å¸¦ä¸Šä¸€ä¸ªconsistencyå‚æ•°ï¼ŒæŒ‡æ˜æˆ‘ä»¬æƒ³è¦çš„å†™ä¸€è‡´æ€§æ˜¯ä»€ä¹ˆï¼Ÿæ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">PUT /index/indextype/id?consistency=quorum
</code></pre>
<h3 data-id="heading-10">quorumæœºåˆ¶</h3>
<h4 data-id="heading-11">åŸºæœ¬æ¦‚å¿µ</h4>
<p>quorumæœºåˆ¶æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¸¸ç”¨çš„ä¸€è‡´æ€§ä¿éšœæœºåˆ¶ï¼Œä¸»è¦ç”¨äºç¡®ä¿æ•°æ®å†™å…¥æ“ä½œçš„æ­£ç¡®æ€§ã€‚åœ¨Elasticsearchä¸­ï¼Œquorumæœºåˆ¶ç”¨äºæ§åˆ¶å†™æ“ä½œå‰å¿…é¡»æ»¡è¶³çš„æœ€å°å¯ç”¨åˆ†ç‰‡æ•°é‡è¦æ±‚ã€‚</p>
<h4 data-id="heading-12">å·¥ä½œåŸç†</h4>
<p>å†™æ“ä½œæ‰§è¡Œå‰ï¼Œç³»ç»Ÿéœ€è¦ç¡®è®¤è¶³å¤Ÿæ•°é‡çš„åˆ†ç‰‡å‰¯æœ¬å¤„äºå¯ç”¨çŠ¶æ€ï¼Œè®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">å½“num_of_replicas &gt; 1æ—¶æ‰ç”Ÿæ•ˆ</span>
int((primary shard + number_of_replicas) / 2) + 1
</code></pre>
<h4 data-id="heading-13">è¯¦ç»†è¯´æ˜</h4>
<ol>
<li>
<p><strong>å‚æ•°è§£é‡Š</strong>ï¼š</p>
<ul>
<li><code>primary shard</code>ï¼šä¸»åˆ†ç‰‡æ•°é‡ï¼Œå›ºå®šä¸º1</li>
<li><code>number_of_replicas</code>ï¼šå‰¯æœ¬åˆ†ç‰‡æ•°é‡</li>
<li><code>int()</code>ï¼šå‘ä¸‹å–æ•´å‡½æ•°</li>
</ul>
</li>
<li>
<p><strong>ç”Ÿæ•ˆæ¡ä»¶</strong>ï¼š
è¯¥æœºåˆ¶ä»…åœ¨é…ç½®äº†å‰¯æœ¬ï¼ˆå³<code>number_of_replicas &gt; 1</code>ï¼‰æ—¶æ‰ä¼šç”Ÿæ•ˆã€‚å¦‚æœåªæœ‰ä¸»åˆ†ç‰‡ï¼ˆ<code>number_of_replicas = 0</code>ï¼‰ï¼Œåˆ™ä¸éœ€è¦quorumæ£€æŸ¥ã€‚</p>
</li>
<li>
<p><strong>è®¡ç®—ç¤ºä¾‹</strong>ï¼š</p>
<ul>
<li>å½“æœ‰1ä¸ªä¸»åˆ†ç‰‡å’Œ2ä¸ªå‰¯æœ¬æ—¶ï¼š<code>int((1 + 2)/2) + 1 = 2</code>ï¼Œå³éœ€è¦è‡³å°‘2ä¸ªåˆ†ç‰‡å¯ç”¨</li>
<li>å½“æœ‰1ä¸ªä¸»åˆ†ç‰‡å’Œ3ä¸ªå‰¯æœ¬æ—¶ï¼š<code>int((1 + 3)/2) + 1 = 3</code>ï¼Œå³éœ€è¦è‡³å°‘3ä¸ªåˆ†ç‰‡å¯ç”¨</li>
</ul>
</li>
</ol>
<h4 data-id="heading-14">åº”ç”¨åœºæ™¯</h4>
<p>è¯¥æœºåˆ¶ä¸»è¦ç”¨äºä»¥ä¸‹æƒ…å†µï¼š</p>
<ul>
<li>å†™å…¥æ–°æ–‡æ¡£æ—¶</li>
<li>æ›´æ–°ç°æœ‰æ–‡æ¡£æ—¶</li>
<li>æ‰§è¡Œæ‰¹é‡æ“ä½œæ—¶</li>
</ul>
<h4 data-id="heading-15">æ³¨æ„äº‹é¡¹</h4>
<ol>
<li>è¯¥æœºåˆ¶ç¡®ä¿äº†å¤§å¤šæ•°åˆ†ç‰‡å‰¯æœ¬å¯ç”¨ï¼Œä»è€Œé˜²æ­¢è„‘è£‚é—®é¢˜</li>
<li>å¦‚æœå¯ç”¨åˆ†ç‰‡æ•°ä¸æ»¡è¶³quorumè¦æ±‚ï¼Œå†™æ“ä½œå°†è¢«æ‹’ç»å¹¶è¿”å›é”™è¯¯</li>
<li>å¯ä»¥é€šè¿‡è®¾ç½®<code>write_consistency</code>å‚æ•°æ¥è°ƒæ•´quorumè¦æ±‚</li>
</ol>
<p>æ¯”å¦‚ï¼š1ä¸ªprimary shardï¼Œ3ä¸ªreplicaï¼Œé‚£ä¹ˆquorum=((1 + 3 ) / 2) + 1 = 3ã€‚
å¦‚æœè¿™æ—¶åªæœ‰ä¸¤å°æœºå™¨çš„è¯ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c5db1310227449bac2ae4f7760d6e9e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766295546&amp;x-signature=Gfz1%2BhDbwdjx3gWChN40R6w4HiM%3D" alt="Elasticsearch quorum æœºåˆ¶" loading="lazy"/></p>
<h3 data-id="heading-16">Timeoutæœºåˆ¶</h3>
<p>quorumä¸é½å…¨æ—¶ï¼Œä¼šwaitï¼ˆç­‰å¾…ï¼‰1åˆ†é’Ÿ
é»˜è®¤æ˜¯1åˆ†é’Ÿï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡timeoutå»æ‰‹åŠ¨è°ƒæ•´ï¼Œé»˜è®¤å•ä½æ˜¯æ¯«ç§’ã€‚
ç­‰å¾…æœŸé—´ï¼ŒæœŸæœ›æ´»è·ƒçš„shardæ•°é‡å¯ä»¥å¢åŠ ï¼Œæœ€åæ— æ³•æ»¡è¶³shardæ•°é‡å°±timeoutã€‚
æˆ‘ä»¬åœ¨å†™æ“ä½œçš„æ—¶å€™ï¼Œå¯ä»¥åŠ ä¸€ä¸ªtimeoutå‚æ•°ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">å½“quorumä¸é½å…¨çš„æ—¶å€™ ESçš„<span class="hljs-built_in">timeout</span>æ—¶é•¿</span>
PUT /index/_doc/id?timeout=30s
</code></pre>
<h3 data-id="heading-17">ES5.0ä»¥åçš„ä¸€è‡´æ€§</h3>
<p>åœ¨ES5.0ä»¥åï¼ŒåŸå…ˆæ‰§è¡ŒPUTå¸¦consistency=all/quorumå‚æ•°çš„ï¼Œéƒ½ä¼šæŠ¥é”™ï¼Œæç¤ºè¯­æ³•é”™è¯¯ã€‚
åŸå› æ˜¯consistencyæ£€æŸ¥æ˜¯åœ¨PUTä¹‹å‰åšçš„ï¼Œç„¶è€Œï¼Œè™½ç„¶æ£€æŸ¥çš„æ—¶å€™ï¼Œshardæ»¡è¶³quorumï¼Œä½†æ˜¯çœŸæ­£primary shardå†™åˆ°replicaä¹‹å‰ï¼Œä»ç„¶ä¼šå‡ºç°shardæŒ‚æ‰ï¼Œä½†Update APIä¹Ÿä¼šè¿”å›Successdï¼Œå› æ­¤ï¼Œè¿™ä¸ªæ£€æŸ¥ä¸èƒ½ä¿è¯replicaæˆåŠŸå†™å…¥ï¼Œç”šè‡³è¿™ä¸ªprimary shardæ˜¯å¦èƒ½æˆåŠŸå†™å…¥ä¹Ÿæœªå¿…èƒ½ä¿è¯ã€‚
å› æ­¤ï¼Œä¿®æ”¹äº†è¯­æ³•ï¼Œç”¨äº† wait_for_active_shardsï¼Œè¿™ä¸ªæ›´åŠ æ¸…æ¥šä¸€äº›ï¼š</p>
<pre><code class="hljs language-json" lang="json">PUT /index/_doc/<span class="hljs-number">1</span>?wait_for_active_shards=<span class="hljs-number">2</span>&amp;timeout=<span class="hljs-number">10</span>s
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"xxx"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"xxx"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-18">é”™è¯¯é€ŸæŸ¥</h2>









































<table><thead><tr><th>ç—‡çŠ¶</th><th>æ ¹å› </th><th>å®šä½</th><th>ä¿®å¤</th></tr></thead><tbody><tr><td>æ›´æ–°è¿”å› 409ï¼š<code>version_conflict_engine_exception</code>ï¼Œæç¤º <code>required seqNo [x] ... current document has seqNo [y]</code></td><td>ä½¿ç”¨æ—§çš„ <code>if_seq_no</code> / <code>if_primary_term</code> æ¡ä»¶å†™å…¥ï¼›æ–‡æ¡£å·²è¢«å…¶ä»–è¯·æ±‚æ›´æ–°ï¼Œåºåˆ—å·å·²å‰è¿›</td><td>è¯»å“åº”/æŠ¥é”™ä¸­çš„ <code>required seqNo</code> ä¸ <code>current ... seqNo</code>ï¼›<code>GET</code> æ–‡æ¡£æŸ¥çœ‹æœ€æ–° <code>_seq_no</code> ä¸ <code>_primary_term</code></td><td>é‡æ–° <code>GET /index/_doc/id</code> è·å–æœ€æ–° <code>_seq_no</code>ã€<code>_primary_term</code>ï¼Œå†å¸¦ä¸Š <code>?if_seq_no=...&amp;if_primary_term=...</code> é‡è¯•å†™å…¥</td></tr><tr><td>å¹¶å‘æ‰£åº“å­˜åå‡ºç°â€œå°‘æ‰£/å¤šæ‰£/å›å†™è¦†ç›–â€</td><td>ä¸šåŠ¡ä¾§åšäº†è¯»-æ”¹-å†™ï¼Œä½†å†™å…¥ä¸æ˜¯æ¡ä»¶å†™å…¥ï¼›ååˆ°è¯·æ±‚è¦†ç›–å…ˆåˆ°è¯·æ±‚çš„ç»“æœ</td><td>å¯¹æ¯”å¹¶å‘è¯·æ±‚çš„è¯»å–å€¼ä¸æœ€ç»ˆå†™å…¥å€¼ï¼›æ£€æŸ¥æ˜¯å¦æ— æ¡ä»¶ <code>PUT/UPDATE</code></td><td>å°†æ›´æ–°æ”¹ä¸ºæ¡ä»¶æ›´æ–°ï¼ˆæºå¸¦ <code>if_seq_no</code>/<code>if_primary_term</code>ï¼‰ï¼›å†²çªæ—¶æŒ‰â€œè¯»å–æœ€æ–°â†’é‡æ–°è®¡ç®—â†’é‡è¯•â€é—­ç¯å¤„ç†</td></tr><tr><td>è¿ç»­ä¸¤æ¬¡æ›´æ–°é¡ºåºè¢«æ‰“ä¹±ï¼Œæœ€ç»ˆçŠ¶æ€ä¸ç¬¦åˆå®¢æˆ·ç«¯å‘é€é¡ºåº</td><td>ES åç«¯å¤šçº¿ç¨‹å¼‚æ­¥å¤„ç†å¯¼è‡´ä¹±åºåˆ°è¾¾/æ‰§è¡Œï¼›æ— æ¡ä»¶å†™ä¼šè®©â€œååˆ°çš„æ—§è¯·æ±‚â€è¦†ç›–æ–°çŠ¶æ€</td><td>è®°å½•è¯·æ±‚æ—¶é—´æˆ³ä¸æœåŠ¡ç«¯å®é™…å†™å…¥é¡ºåºï¼›è§‚å¯Ÿå†²çªæ˜¯å¦è¢«è§¦å‘</td><td>ç”¨ OCC è®©æ—§è¯·æ±‚åœ¨ç‰ˆæœ¬ä¸åŒ¹é…æ—¶å¤±è´¥ï¼ˆ409ï¼‰ï¼Œç”±å®¢æˆ·ç«¯æˆ–åº”ç”¨å±‚æŒ‰ç­–ç•¥é‡è¯•/æ”¾å¼ƒ</td></tr><tr><td>å†™è¯·æ±‚é•¿æœŸç­‰å¾…åå¤±è´¥ï¼ˆæ¶‰åŠå†™å…¥é—¨æ§›ï¼‰</td><td><code>wait_for_active_shards</code> æœªæ»¡è¶³ï¼ˆå¯ç”¨åˆ†ç‰‡å‰¯æœ¬ä¸è¶³ï¼‰ï¼Œç›´åˆ° <code>timeout</code> è¶…æ—¶</td><td>çœ‹è¯·æ±‚å‚æ•°æ˜¯å¦å¸¦ <code>wait_for_active_shards</code>/<code>timeout</code>ï¼›ç»“åˆé›†ç¾¤ <code>shard</code> åˆ†é…ä¸èŠ‚ç‚¹å¥åº·</td><td>è°ƒæ•´ <code>wait_for_active_shards</code> ä¸ºå¯è¾¾å€¼ï¼›ä¿®å¤åˆ†ç‰‡åˆ†é…/èŠ‚ç‚¹å¥åº·ï¼›å¿…è¦æ—¶å»¶é•¿ <code>timeout</code> æˆ–é™ä½é—¨æ§›</td></tr><tr><td>ES5.0 ä»¥å <code>consistency=quorum/all</code> æŠ¥è¯­æ³•/å‚æ•°é”™è¯¯</td><td>æ—§å‚æ•°å·²åºŸå¼ƒï¼›å†™ä¸€è‡´æ€§æ£€æŸ¥è¯­ä¹‰è¿ç§»åˆ° <code>wait_for_active_shards</code></td><td>çœ‹è¯·æ±‚ URL æ˜¯å¦ä»å¸¦ <code>consistency</code></td><td>ç”¨ <code>wait_for_active_shards + timeout</code> æ›¿ä»£ï¼›å°†â€œå†™å…¥å‰é—¨æ§›â€ä¸â€œå†™å…¥æˆåŠŸè¯­ä¹‰â€åŒºåˆ†é…ç½®</td></tr></tbody></table>
<h2 data-id="heading-19">å…¶ä»–ç³»åˆ—</h2>
<h3 data-id="heading-20">ğŸš€ AIç¯‡æŒç»­æ›´æ–°ä¸­ï¼ˆé•¿æœŸæ›´æ–°ï¼‰</h3>
<p><strong>AIç‚¼ä¸¹æ—¥å¿—-29 - å­—èŠ‚è·³åŠ¨ DeerFlow æ·±åº¦ç ”ç©¶æ¡†<em>æ–œä½“æ ·å¼</em>æ¶ ç§æœ‰éƒ¨ç½² æµ‹è¯•ä¸Šæ‰‹ æ¶æ„ç ”ç©¶</strong>ï¼ŒæŒç»­æ‰“é€ å®ç”¨AIå·¥å…·æŒ‡å—ï¼
<strong>AIç ”ç©¶-132 Java ç”Ÿæ€å‰æ²¿ 2025ï¼šSpringã€Quarkusã€GraalVMã€CRaC ä¸äº‘åŸç”Ÿè½åœ°</strong></p>
<h3 data-id="heading-21">ğŸ’» Javaç¯‡æŒç»­æ›´æ–°ä¸­ï¼ˆé•¿æœŸæ›´æ–°ï¼‰</h3>
<p><strong>Java-180 Java æ¥å…¥ FastDFSï¼šè‡ªç¼–è¯‘å®¢æˆ·ç«¯ä¸ Maven/Spring Boot å®æˆ˜</strong>
MyBatis å·²å®Œç»“ï¼ŒSpring å·²å®Œç»“ï¼ŒNginxå·²å®Œç»“ï¼ŒTomcatå·²å®Œç»“ï¼Œåˆ†å¸ƒå¼æœåŠ¡å·²å®Œç»“ï¼ŒDubboå·²å®Œç»“ï¼ŒMySQLå·²å®Œç»“ï¼ŒMongoDBå·²å®Œç»“ï¼ŒNeo4jå·²å®Œç»“ï¼ŒFastDFS å·²å®Œç»“ï¼ŒOSSæ­£åœ¨æ›´æ–°... æ·±å…¥æµ…å‡ºåŠ©ä½ æ‰“ç‰¢åŸºç¡€ï¼</p>
<h3 data-id="heading-22">ğŸ“Š å¤§æ•°æ®æ¿å—å·²å®Œæˆå¤šé¡¹å¹²è´§æ›´æ–°ï¼ˆ300ç¯‡ï¼‰ï¼š</h3>
<p>åŒ…æ‹¬ Hadoopã€Hiveã€Kafkaã€Flinkã€ClickHouseã€Elasticsearch ç­‰äºŒåä½™é¡¹æ ¸å¿ƒç»„ä»¶ï¼Œè¦†ç›–ç¦»çº¿+å®æ—¶æ•°ä»“å…¨æ ˆï¼
<strong>å¤§æ•°æ®-278 Spark MLib - åŸºç¡€ä»‹ç» æœºå™¨å­¦ä¹ ç®—æ³• æ¢¯åº¦æå‡æ ‘ GBDTæ¡ˆä¾‹ è¯¦è§£</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤šçº§ç¼“å­˜è®¾è®¡æ€è·¯â€”â€”æœ¬åœ° + è¿œç¨‹çš„ä¸€è‡´æ€§ç­–ç•¥ã€å¤±æ•ˆé£æš´ä¸æ—è·¯ç¼“å­˜çš„å–èˆ]]></title>    <link>https://juejin.cn/post/7583293030172344366</link>    <guid>https://juejin.cn/post/7583293030172344366</guid>    <pubDate>2025-12-14T05:13:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583293030172344366" data-draft-id="7583324039301890099" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤šçº§ç¼“å­˜è®¾è®¡æ€è·¯â€”â€”æœ¬åœ° + è¿œç¨‹çš„ä¸€è‡´æ€§ç­–ç•¥ã€å¤±æ•ˆé£æš´ä¸æ—è·¯ç¼“å­˜çš„å–èˆ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-14T05:13:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åæœˆå—åŸ"/> <meta itemprop="url" content="https://juejin.cn/user/3456520290576862"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤šçº§ç¼“å­˜è®¾è®¡æ€è·¯â€”â€”æœ¬åœ° + è¿œç¨‹çš„ä¸€è‡´æ€§ç­–ç•¥ã€å¤±æ•ˆé£æš´ä¸æ—è·¯ç¼“å­˜çš„å–èˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3456520290576862/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åæœˆå—åŸ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T05:13:23.000Z" title="Sun Dec 14 2025 05:13:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åœ¨å¤šçº§ç¼“å­˜çš„ä¸–ç•Œé‡Œï¼Œæ€§èƒ½ä¸ä¸€è‡´æ€§ä»æ¥ä¸æ˜¯æœ‹å‹ï¼Œè€Œæ˜¯ä¸€å¯¹éœ€è¦ç²¾å¿ƒè°ƒå’Œçš„å†¤å®¶</p>
</blockquote>
<p>åœ¨é«˜å¹¶å‘ç³»ç»Ÿæ¶æ„ä¸­ï¼Œç¼“å­˜æ˜¯æå‡æ€§èƒ½çš„åˆ©å™¨ï¼Œä½†å•ä¸€ç¼“å­˜å±‚å¾€å¾€éš¾ä»¥å…¼é¡¾æè‡´æ€§èƒ½ä¸æ•°æ®ä¸€è‡´æ€§ã€‚å¤šçº§ç¼“å­˜é€šè¿‡åˆ†å±‚è®¾è®¡ï¼Œå°†æ•°æ®å†—ä½™å­˜å‚¨åœ¨è·ç¦»åº”ç”¨ä¸åŒå±‚æ¬¡çš„å­˜å‚¨ä»‹è´¨ä¸­ï¼Œå®ç°äº†æ€§èƒ½ä¸æˆæœ¬çš„æœ€ä½³å¹³è¡¡ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨æœ¬åœ°ç¼“å­˜ä¸è¿œç¨‹ç¼“å­˜çš„ååŒç­–ç•¥ï¼Œåˆ†ææ•°æ®ä¸€è‡´æ€§ä¿éšœæœºåˆ¶ï¼Œå¹¶æä¾›åº”å¯¹ç¼“å­˜å¤±æ•ˆé£æš´çš„å®ç”¨æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-0">1 å¤šçº§ç¼“å­˜æ¶æ„çš„æœ¬è´¨ä¸ä»·å€¼</h2>
<h3 data-id="heading-1">1.1 å¤šçº§ç¼“å­˜çš„è®¾è®¡å“²å­¦</h3>
<p>å¤šçº§ç¼“å­˜çš„æ ¸å¿ƒæ€æƒ³æ˜¯æŒ‰ç…§<strong>æ•°æ®è®¿é—®é¢‘ç‡</strong>å’Œ<strong>å»¶è¿Ÿæ•æ„Ÿåº¦</strong>å»ºç«‹åˆ†å±‚å­˜å‚¨ä½“ç³»ã€‚è¿™ç§é‡‘å­—å¡”å¼ç»“æ„éµå¾ª"ç¦»ç”¨æˆ·è¶Šè¿‘ï¼Œé€Ÿåº¦è¶Šå¿«ï¼Œæˆæœ¬è¶Šé«˜ï¼Œå®¹é‡è¶Šå°"çš„åŸºæœ¬åŸåˆ™ã€‚</p>
<p>åœ¨å…¸å‹çš„å¤šçº§ç¼“å­˜æ¶æ„ä¸­ï¼Œâ€‹<strong>æœ¬åœ°ç¼“å­˜</strong>â€‹ï¼ˆå¦‚ Caffeineï¼‰ä½œä¸ºç¬¬ä¸€çº§ç¼“å­˜ï¼Œæä¾›çº³ç§’çº§è®¿é—®é€Ÿåº¦ï¼Œç”¨äºå­˜å‚¨æçƒ­ç‚¹æ•°æ®ï¼›â€‹<strong>åˆ†å¸ƒå¼ç¼“å­˜</strong>â€‹ï¼ˆå¦‚ Redisï¼‰ä½œä¸ºç¬¬äºŒçº§ç¼“å­˜ï¼Œæä¾›æ¯«ç§’çº§è®¿é—®é€Ÿåº¦ï¼Œå­˜å‚¨æ›´å¹¿æ³›çš„çƒ­ç‚¹æ•°æ®ï¼›<strong>æ•°æ®åº“</strong>ä½œä¸ºæœ€ç»ˆæ•°æ®æºï¼Œä¿è¯æ•°æ®çš„æŒä¹…åŒ–å’Œå¼ºä¸€è‡´æ€§ã€‚</p>
<p>è¿™ç§åˆ†å±‚è®¾è®¡æœ¬è´¨ä¸Šæ˜¯åœ¨<strong>é€Ÿåº¦ã€å®¹é‡ã€æˆæœ¬ã€ä¸€è‡´æ€§</strong>å››ä¸ªç»´åº¦ä¸Šè¿›è¡Œæƒè¡¡ã€‚æœ¬åœ°ç¼“å­˜ç‰ºç‰²å®¹é‡ä¿è¯é€Ÿåº¦ï¼Œåˆ†å¸ƒå¼ç¼“å­˜ç‰ºç‰²éƒ¨åˆ†é€Ÿåº¦ä¿è¯å®¹é‡å’Œä¸€è‡´æ€§ï¼Œæ•°æ®åº“åˆ™ç¡®ä¿æ•°æ®çš„æœ€ç»ˆå¯é æ€§ã€‚</p>
<h3 data-id="heading-2">1.2 å¤šçº§ç¼“å­˜çš„å·¥ä½œæµç¨‹</h3>
<p>å½“è¯·æ±‚åˆ°è¾¾ç³»ç»Ÿæ—¶ï¼Œå¤šçº§ç¼“å­˜æŒ‰ç…§å›ºå®šé¡ºåºé€å±‚æŸ¥è¯¢ï¼š</p>
<ol>
<li>â€‹<strong>L1 æŸ¥è¯¢</strong>â€‹ï¼šé¦–å…ˆæ£€æŸ¥æœ¬åœ°ç¼“å­˜ï¼Œå‘½ä¸­åˆ™ç›´æ¥è¿”å›</li>
<li>â€‹<strong>L2 æŸ¥è¯¢</strong>â€‹ï¼šæœ¬åœ°ç¼“å­˜æœªå‘½ä¸­æ—¶æŸ¥è¯¢åˆ†å¸ƒå¼ç¼“å­˜</li>
<li>â€‹<strong>æ•°æ®åº“æŸ¥è¯¢</strong>â€‹ï¼šå‰ä¸¤çº§ç¼“å­˜å‡æœªå‘½ä¸­æ—¶è®¿é—®æ•°æ®åº“</li>
</ol>
<p>å…³é”®ä¼˜åŒ–ç‚¹åœ¨äºâ€‹<strong>ç¼“å­˜å›ç§æœºåˆ¶</strong>â€‹â€”â€”å½“æ•°æ®ä»è¾ƒæ…¢å±‚çº§è·å–åï¼Œä¼šå°†å…¶å›ç§åˆ°æ›´å¿«å±‚çº§çš„ç¼“å­˜ä¸­ã€‚ä¾‹å¦‚ï¼Œä» Redis è·å–çš„æ•°æ®åŒæ—¶å­˜å…¥æœ¬åœ°ç¼“å­˜ï¼Œåç»­ç›¸åŒè¯·æ±‚å¯ç›´æ¥ä»æœ¬åœ°ç¼“å­˜è·å–ï¼Œå¤§å¹…é™ä½å»¶è¿Ÿã€‚</p>
<h2 data-id="heading-3">2 æ•°æ®ä¸€è‡´æ€§ç­–ç•¥</h2>
<h3 data-id="heading-4">2.1 å¤šçº§ç¼“å­˜çš„ä¸€è‡´æ€§æŒ‘æˆ˜</h3>
<p>å¤šçº§ç¼“å­˜æ¶æ„ä¸­æœ€å¤æ‚çš„æŒ‘æˆ˜æ˜¯ä¿è¯å„å±‚çº§é—´æ•°æ®ä¸€è‡´æ€§ã€‚ç”±äºæ•°æ®åœ¨ä¸åŒå±‚çº§æœ‰å¤šä»½å‰¯æœ¬ï¼Œæ›´æ–°æ—¶å®¹æ˜“å‡ºç°<strong>ä¸´æ—¶ä¸ä¸€è‡´</strong>ç°è±¡ã€‚</p>
<p>ä¸€è‡´æ€§æŒ‘æˆ˜ä¸»è¦æ¥è‡ªä¸‰ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li>â€‹<strong>æ›´æ–°è¦†ç›–</strong>â€‹ï¼šçº¿ç¨‹ A æ›´æ–°æ•°æ®åº“åï¼Œçº¿ç¨‹ B åœ¨ç¼“å­˜æ›´æ–°å‰è¯»å–åˆ°æ—§æ•°æ®</li>
<li>â€‹<strong>ç¼“å­˜æ®‹ç•™</strong>â€‹ï¼šæ•°æ®åº“æ•°æ®å·²åˆ é™¤ï¼Œä½†ç¼“å­˜ä¸­ä»ä¿ç•™</li>
<li>â€‹<strong>å¤šçº§ä¸ä¸€è‡´</strong>â€‹ï¼šæœ¬åœ°ç¼“å­˜å·²æ›´æ–°ï¼Œä½†åˆ†å¸ƒå¼ç¼“å­˜æœªæ›´æ–°ï¼Œå¯¼è‡´é›†ç¾¤ä¸­ä¸åŒå®ä¾‹æ•°æ®ä¸ä¸€è‡´</li>
</ul>
<h3 data-id="heading-5">2.2 ä¸€è‡´æ€§ä¿éšœæ–¹æ¡ˆ</h3>
<h4 data-id="heading-6">æ—è·¯ç¼“å­˜ç­–ç•¥ï¼ˆCache-Asideï¼‰</h4>
<p>è¿™æ˜¯æœ€å¸¸ç”¨çš„ç¼“å­˜æ›´æ–°æ¨¡å¼ï¼Œæ ¸å¿ƒåŸåˆ™æ˜¯"å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜"ã€‚è¿™ç§é¡ºåºå¯é¿å…åœ¨æ•°æ®åº“æ›´æ–°å¤±è´¥æ—¶ç¼“å­˜ä¸­ä¿ç•™æ—§æ•°æ®ï¼ŒåŒæ—¶å‡å°‘å¹¶å‘å†™ç¼“å­˜å¯¼è‡´çš„æ•°æ®æ··ä¹±ã€‚</p>
<p><strong>å»¶è¿ŸåŒåˆ æœºåˆ¶</strong>æ˜¯å¯¹åŸºç¡€æ—è·¯ç¼“å­˜çš„å¢å¼ºï¼Œåœ¨ç¬¬ä¸€æ¬¡åˆ é™¤ç¼“å­˜åï¼Œå»¶è¿Ÿä¸€æ®µæ—¶é—´ï¼ˆå¦‚ 500msï¼‰å†æ¬¡åˆ é™¤ï¼Œæ¸…é™¤å¯èƒ½åœ¨æ­¤æœŸé—´è¢«å†™å…¥çš„è„æ•°æ®ã€‚è¿™ç§æ–¹æ¡ˆèƒ½åº”å¯¹æç«¯å¹¶å‘åœºæ™¯ä¸‹çš„æ•°æ®ä¸ä¸€è‡´é—®é¢˜ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å»¶è¿ŸåŒåˆ ç¤ºä¾‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisCacheConsistency</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">updateProduct</span>(<span class="hljs-params">Product product</span>) {
        <span class="hljs-comment">// 1. æ›´æ–°æ•°æ®åº“</span>
        productDao.<span class="hljs-title function_">update</span>(product);
        
        <span class="hljs-comment">// 2. ç«‹å³åˆ é™¤ç¼“å­˜</span>
        redisTemplate.<span class="hljs-title function_">delete</span>(<span class="hljs-string">"product:"</span> + product.<span class="hljs-title function_">getId</span>());
        
        <span class="hljs-comment">// 3. å»¶è¿Ÿå†æ¬¡åˆ é™¤ï¼ˆé˜²æ­¢è„æ•°æ®ï¼‰</span>
        scheduler.<span class="hljs-title function_">schedule</span>(() -&gt; {
            redisTemplate.<span class="hljs-title function_">delete</span>(<span class="hljs-string">"product:"</span> + product.<span class="hljs-title function_">getId</span>());
        }, <span class="hljs-number">500</span>, <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">MILLISECONDS</span>);
    }
}
â€‹
</code></pre>
<h4 data-id="heading-7">åŸºäº Binlog çš„å¼‚æ­¥å¤±æ•ˆ</h4>
<p>å¯¹äºé«˜ä¸€è‡´æ€§è¦æ±‚çš„åœºæ™¯ï¼Œå¯é€šè¿‡ <strong>Canal</strong> ç­‰å·¥å…·ç›‘å¬æ•°æ®åº“ Binlog å˜åŒ–ï¼Œç„¶åå¼‚æ­¥åˆ é™¤ç¼“å­˜ã€‚è¿™ç§æ–¹æ¡ˆå°†ç¼“å­˜å¤±æ•ˆé€»è¾‘ä¸ä¸šåŠ¡é€»è¾‘è§£è€¦ï¼Œä½†æ¶æ„å¤æ‚åº¦è¾ƒé«˜ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// åŸºäºäº‹ä»¶çš„ç¼“å­˜å¤±æ•ˆç¤ºä¾‹</span>
@Component
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CacheConsistencyManager</span> {
    @EventListener
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onDataUpdated</span>(<span class="hljs-params">DataUpdateEvent <span class="hljs-keyword">event</span></span>)</span> {
        <span class="hljs-comment">// ç«‹å³åˆ é™¤æœ¬åœ°ç¼“å­˜</span>
        localCache.invalidate(<span class="hljs-keyword">event</span>.getKey());
        
        <span class="hljs-comment">// å¼‚æ­¥åˆ é™¤Redisç¼“å­˜</span>
        executorService.submit(() -&gt; {
            redisTemplate.delete(<span class="hljs-keyword">event</span>.getKey());
            <span class="hljs-comment">// å‘é€æ¶ˆæ¯é€šçŸ¥å…¶ä»–å®ä¾‹æ¸…ç†æœ¬åœ°ç¼“å­˜</span>
            redisTemplate.convertAndSend(<span class="hljs-string">"cache:invalid:channel"</span>, <span class="hljs-keyword">event</span>.getKey());
        });
    }
}
â€‹
</code></pre>
<h4 data-id="heading-8">æœ¬åœ°ç¼“å­˜ä¸€è‡´æ€§ä¿éšœ</h4>
<p>æœ¬åœ°ç¼“å­˜çš„ä¸€è‡´æ€§æœ€ä¸ºå¤æ‚ï¼Œå› ä¸ºæ¯ä¸ªåº”ç”¨å®ä¾‹éƒ½æœ‰è‡ªå·±çš„ç¼“å­˜å‰¯æœ¬ã€‚å¸¸ç”¨æ–¹æ¡ˆåŒ…æ‹¬ï¼š</p>
<ul>
<li>â€‹<strong>çŸ­ TTL ç­–ç•¥</strong>â€‹ï¼šè®¾ç½®è¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´ï¼ˆå¦‚ 1-5 åˆ†é’Ÿï¼‰ï¼Œé€šè¿‡è¿‡æœŸè‡ªåŠ¨åˆ·æ–°ä¿è¯æœ€ç»ˆä¸€è‡´</li>
<li>â€‹<strong>äº‹ä»¶é€šçŸ¥æœºåˆ¶</strong>â€‹ï¼šé€šè¿‡ Redis Pub/Sub æˆ–ä¸“ä¸šæ¶ˆæ¯é˜Ÿåˆ—å¹¿æ’­ç¼“å­˜å¤±æ•ˆäº‹ä»¶</li>
<li>â€‹<strong>åŒç¼“å­˜ç­–ç•¥</strong>â€‹ï¼šç»´æŠ¤ä¸¤ä»½è¿‡æœŸæ—¶é—´ä¸åŒçš„ç¼“å­˜ï¼Œä¸€ä»½ç”¨äºè¯»å–ï¼Œä¸€ä»½ä½œä¸ºå¤‡ä»½</li>
</ul>
<h2 data-id="heading-9">3 ç¼“å­˜å¤±æ•ˆé£æš´ä¸é˜²æŠ¤æœºåˆ¶</h2>
<h3 data-id="heading-10">3.1 ç¼“å­˜å¤±æ•ˆçš„ä¸‰ç§å…¸å‹é—®é¢˜</h3>
<p><strong>ç¼“å­˜é›ªå´©</strong>æŒ‡å¤§é‡ç¼“å­˜åŒæ—¶å¤±æ•ˆï¼Œå¯¼è‡´æ‰€æœ‰è¯·æ±‚ç›´è¾¾æ•°æ®åº“ã€‚è§£å†³æ–¹æ¡ˆæ˜¯ä¸ºç¼“å­˜è¿‡æœŸæ—¶é—´æ·»åŠ éšæœºåç§»é‡ï¼Œé¿å…é›†ä½“å¤±æ•ˆã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// é˜²æ­¢ç¼“å­˜é›ªå´©ï¼šè¿‡æœŸæ—¶é—´éšæœºåŒ–</span>
<span class="hljs-type">int</span> baseExpire = <span class="hljs-number">30</span>; <span class="hljs-comment">// åŸºç¡€è¿‡æœŸæ—¶é—´30åˆ†é’Ÿ</span>
<span class="hljs-type">int</span> random = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Random</span>().<span class="hljs-built_in">nextInt</span>(<span class="hljs-number">10</span>) - <span class="hljs-number">5</span>; <span class="hljs-comment">// -5åˆ°+5åˆ†é’Ÿéšæœºåç§»</span>
redisTemplate.<span class="hljs-built_in">opsForValue</span>().<span class="hljs-built_in">set</span>(cacheKey, value, baseExpire + random, TimeUnit.MINUTES);
â€‹
</code></pre>
<p><strong>ç¼“å­˜å‡»ç©¿</strong>å‘ç”Ÿåœ¨æŸä¸ªçƒ­ç‚¹ key è¿‡æœŸç¬é—´ï¼Œå¤§é‡å¹¶å‘è¯·æ±‚åŒæ—¶å°è¯•é‡å»ºç¼“å­˜ã€‚é€šè¿‡<strong>äº’æ–¥é”</strong>æœºåˆ¶ç¡®ä¿åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œç¼“å­˜é‡å»ºã€‚</p>
<pre><code class="hljs language-ini" lang="ini">// é˜²æ­¢ç¼“å­˜å‡»ç©¿ï¼šäº’æ–¥é”é‡å»ºç¼“å­˜
public ProductDTO getProductWithMutex(Long productId) {
    String <span class="hljs-attr">cacheKey</span> = <span class="hljs-string">"product:"</span> + productId<span class="hljs-comment">;</span>
    // 1. å…ˆæŸ¥ç¼“å­˜
    ProductDTO <span class="hljs-attr">product</span> = redisTemplate.get(cacheKey)<span class="hljs-comment">;</span>
    if (product != null) return product<span class="hljs-comment">;</span>
    
    // 2. è·å–åˆ†å¸ƒå¼é”
    String <span class="hljs-attr">lockKey</span> = <span class="hljs-string">"lock:"</span> + cacheKey<span class="hljs-comment">;</span>
    boolean <span class="hljs-attr">locked</span> = redisTemplate.opsForValue().setIfAbsent(lockKey, <span class="hljs-string">"1"</span>, <span class="hljs-number">3</span>, TimeUnit.SECONDS)<span class="hljs-comment">;</span>
    
    if (locked) {
        try {
            // 3. åŒé‡æ£€æŸ¥
            <span class="hljs-attr">product</span> = redisTemplate.get(cacheKey)<span class="hljs-comment">;</span>
            if (product != null) return product<span class="hljs-comment">;</span>
            
            // 4. æŸ¥æ•°æ®åº“å¹¶é‡å»ºç¼“å­˜
            <span class="hljs-attr">product</span> = loadFromDB(productId)<span class="hljs-comment">;</span>
            redisTemplate.opsForValue().set(cacheKey, product, 30, TimeUnit.MINUTES)<span class="hljs-comment">;</span>
            return product<span class="hljs-comment">;</span>
        } finally {
            redisTemplate.delete(lockKey)<span class="hljs-comment">;</span>
        }
    } else {
        // æœªè·å–åˆ°é”ï¼ŒçŸ­æš‚ç­‰å¾…åé‡è¯•
        Thread.sleep(100)<span class="hljs-comment">;</span>
        return getProductWithMutex(productId)<span class="hljs-comment">;</span>
    }
}
â€‹
</code></pre>
<p><strong>ç¼“å­˜ç©¿é€</strong>æ˜¯æŸ¥è¯¢ä¸å­˜åœ¨çš„æ•°æ®å¯¼è‡´è¯·æ±‚ç©¿é€ç¼“å­˜ç›´è¾¾æ•°æ®åº“ã€‚è§£å†³æ–¹æ¡ˆåŒ…æ‹¬<strong>å¸ƒéš†è¿‡æ»¤å™¨</strong>æ‹¦æˆªå’Œâ€‹<strong>ç©ºå€¼ç¼“å­˜</strong>â€‹ã€‚</p>
<h3 data-id="heading-11">3.2 å¤šçº§ç¼“å­˜ä¸‹çš„å¤±æ•ˆé£æš´æ”¾å¤§æ•ˆåº”</h3>
<p>åœ¨å¤šçº§ç¼“å­˜æ¶æ„ä¸­ï¼Œå¤±æ•ˆé£æš´çš„å½±å“ä¼šè¢«æ”¾å¤§ã€‚å½“ Redis å±‚ç¼“å­˜å¤±æ•ˆæ—¶ï¼Œæ‰€æœ‰åº”ç”¨å®ä¾‹ä¼šåŒæ—¶å°è¯•é‡å»ºç¼“å­˜ï¼Œå¯¼è‡´æ•°æ®åº“å‹åŠ›å€å¢ã€‚</p>
<p><strong>åˆ†å±‚é˜²æŠ¤ç­–ç•¥</strong>å¯æœ‰æ•ˆç¼“è§£è¿™ä¸€é—®é¢˜ï¼š</p>
<ul>
<li>â€‹<strong>æœ¬åœ°ç¼“å­˜å±‚é¢</strong>â€‹ï¼šè®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´é”™å¼€ï¼Œé¿å…åŒæ—¶å¤±æ•ˆ</li>
<li>â€‹<strong>åˆ†å¸ƒå¼ç¼“å­˜å±‚é¢</strong>â€‹ï¼šä½¿ç”¨äº’æ–¥é”æ§åˆ¶ç¼“å­˜é‡å»ºå¹¶å‘æ•°</li>
<li>â€‹<strong>åº”ç”¨å±‚é¢</strong>â€‹ï¼šå®ç°ç†”æ–­é™çº§æœºåˆ¶ï¼Œåœ¨æ•°æ®åº“å‹åŠ›å¤§æ—¶è¿”å›é»˜è®¤å€¼</li>
</ul>
<h2 data-id="heading-12">4 æ—è·¯ç¼“å­˜æ¨¡å¼çš„æ·±åº¦å–èˆ</h2>
<h3 data-id="heading-13">4.1 æ—è·¯ç¼“å­˜çš„é€‚ç”¨åœºæ™¯</h3>
<p>æ—è·¯ç¼“å­˜ï¼ˆCache-Asideï¼‰æ˜¯æœ€å¸¸ç”¨çš„ç¼“å­˜æ¨¡å¼ï¼Œé€‚ç”¨äº<strong>è¯»å¤šå†™å°‘</strong>çš„å…¸å‹åœºæ™¯ã€‚å…¶ä¼˜åŠ¿åœ¨äºæŒ‰éœ€åŠ è½½æ•°æ®ï¼Œé¿å…ç¼“å­˜æ— ç”¨æ•°æ®ï¼ŒåŒæ—¶ç®€åŒ–äº†ç¼“å­˜æ›´æ–°é€»è¾‘ã€‚</p>
<p>åœ¨ç”µå•†ã€å†…å®¹å±•ç¤ºç­‰ç³»ç»Ÿä¸­ï¼Œæ—è·¯ç¼“å­˜èƒ½æœ‰æ•ˆé™ä½æ•°æ®åº“è¯»å‹åŠ›ï¼Œæå‡ç³»ç»Ÿååé‡ã€‚å®æµ‹æ•°æ®æ˜¾ç¤ºï¼Œåˆç†é…ç½®çš„å¤šçº§ç¼“å­˜å¯å°†å¹³å‡å“åº”æ—¶é—´ä» 35ms é™ä½è‡³ 8msï¼Œé™å¹…è¾¾ 77%ã€‚</p>
<h3 data-id="heading-14">4.2 æ—è·¯ç¼“å­˜çš„å±€é™æ€§</h3>
<p>æ—è·¯ç¼“å­˜åœ¨é«˜å¹¶å‘å†™å…¥åœºæ™¯ä¸‹å­˜åœ¨æ˜æ˜¾çŸ­æ¿ï¼š</p>
<ul>
<li>â€‹<strong>å†™åè¯»ä¸ä¸€è‡´</strong>â€‹ï¼šåœ¨æ•°æ®åº“æ›´æ–°ä¸ç¼“å­˜åˆ é™¤çš„é—´éš™ï¼Œå¯èƒ½è¯»å–åˆ°æ—§æ•°æ®</li>
<li>â€‹<strong>ç¼“å­˜é‡å»ºç«äº‰</strong>â€‹ï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶ç¼“å­˜æœªå‘½ä¸­æ—¶ï¼Œä¼šç«äº‰é‡å»ºç¼“å­˜</li>
<li>â€‹<strong>äº‹åŠ¡å¤æ‚æ€§</strong>â€‹ï¼šåœ¨åˆ†å¸ƒå¼äº‹åŠ¡åœºæ™¯ä¸‹ï¼Œä¿è¯ç¼“å­˜ä¸æ•°æ®åº“çš„ä¸€è‡´æ€§æä¸ºå¤æ‚</li>
</ul>
<h3 data-id="heading-15">4.3 æ—è·¯ç¼“å­˜çš„æ›¿ä»£æ–¹æ¡ˆ</h3>
<p>å¯¹äºç‰¹å®šåœºæ™¯ï¼Œå¯è€ƒè™‘æ—è·¯ç¼“å­˜çš„æ›¿ä»£æ–¹æ¡ˆï¼š</p>
<p><strong>Write-Through æ¨¡å¼</strong>å°†ç¼“å­˜ä½œä¸ºä¸»è¦æ•°æ®å­˜å‚¨ï¼Œç”±ç¼“å­˜è´Ÿè´£å†™å…¥æ•°æ®åº“ã€‚è¿™ç§æ¨¡å¼ç®€åŒ–äº†åº”ç”¨é€»è¾‘ï¼Œä½†å¯¹ç¼“å­˜å¯é æ€§è¦æ±‚æé«˜ã€‚</p>
<p><strong>Write-Behind æ¨¡å¼</strong>å…ˆå†™ç¼“å­˜ï¼Œç„¶åå¼‚æ­¥æ‰¹é‡å†™å…¥æ•°æ®åº“ã€‚è¿™ç§æ¨¡å¼é€‚åˆè®¡æ•°ç»Ÿè®¡ã€åº“å­˜æ‰£å‡ç­‰é«˜å¹¶å‘å†™å…¥åœºæ™¯ï¼Œä½†å­˜åœ¨æ•°æ®ä¸¢å¤±é£é™©ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// Write-Behindæ¨¡å¼ç¤ºä¾‹ï¼šåº“å­˜æ‰£å‡</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InventoryService</span> {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-title">reduceStock</span><span class="hljs-params">(<span class="hljs-type">String</span> productId, <span class="hljs-type">int</span> quantity)</span> </span>{
        <span class="hljs-comment">// 1. å…ˆæ›´æ–°Redisç¼“å­˜</span>
        redisTemplate.<span class="hljs-built_in">opsForValue</span>().<span class="hljs-built_in">decrement</span>(<span class="hljs-string">"stock:"</span> + productId, quantity);
        
        <span class="hljs-comment">// 2. å¼‚æ­¥å†™å…¥æ•°æ®åº“</span>
        mqTemplate.<span class="hljs-built_in">send</span>(<span class="hljs-string">"stock-update-topic"</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">StockUpdateMsg</span>(productId, quantity));
    }
}
â€‹
</code></pre>
<h2 data-id="heading-16">5 å®æˆ˜æ¡ˆä¾‹ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-17">5.1 ç”µå•†å¹³å°å¤šçº§ç¼“å­˜è®¾è®¡</h3>
<p>æŸå¤§å‹ç”µå•†å¹³å°å•†å“è¯¦æƒ…é¡µé‡‡ç”¨ä¸‰çº§ç¼“å­˜æ¶æ„ï¼š</p>
<ol>
<li>â€‹<strong>Nginx å±‚ç¼“å­˜</strong>â€‹ï¼šä½¿ç”¨ OpenResty+Lua è„šæœ¬å®ç°ï¼Œç¼“å­˜æçƒ­ç‚¹æ•°æ®</li>
<li>â€‹<strong>åº”ç”¨å±‚æœ¬åœ°ç¼“å­˜</strong>â€‹ï¼šCaffeine ç¼“å­˜çƒ­ç‚¹å•†å“ä¿¡æ¯ï¼Œè¿‡æœŸæ—¶é—´ 5 åˆ†é’Ÿ</li>
<li>â€‹<strong>Redis é›†ç¾¤</strong>â€‹ï¼šç¼“å­˜å…¨é‡å•†å“æ•°æ®ï¼Œè¿‡æœŸæ—¶é—´ 30 åˆ†é’Ÿ</li>
</ol>
<p>é€šè¿‡è¿™ç§è®¾è®¡ï¼ŒæˆåŠŸåº”å¯¹æ—¥å‡åƒä¸‡çº§è®¿é—®é‡ï¼Œæ•°æ®åº“è¯»è¯·æ±‚é™ä½ 70%ã€‚</p>
<h3 data-id="heading-18">5.2 é…ç½®ç­–ç•¥ä¸å‚æ•°ä¼˜åŒ–</h3>
<p><strong>ç¼“å­˜ç²’åº¦é€‰æ‹©</strong>å¯¹æ€§èƒ½æœ‰é‡è¦å½±å“ã€‚è¿‡ç»†çš„ç¼“å­˜ç²’åº¦å¢åŠ ç®¡ç†å¤æ‚åº¦ï¼Œè¿‡ç²—çš„ç²’åº¦å¯¼è‡´æ— æ•ˆæ•°æ®ä¼ è¾“ã€‚å»ºè®®æ ¹æ®ä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚ç²’åº¦ï¼Œå¦‚å®Œæ•´å¯¹è±¡ç¼“å­˜ä¼˜äºå­—æ®µçº§ç¼“å­˜ã€‚</p>
<p><strong>è¿‡æœŸæ—¶é—´è®¾ç½®</strong>éœ€è¦å¹³è¡¡ä¸€è‡´æ€§ä¸æ€§èƒ½ï¼š</p>
<ul>
<li>é«˜å˜æ›´é¢‘ç‡æ•°æ®ï¼šè®¾ç½®è¾ƒçŸ­ TTLï¼ˆ1-10 åˆ†é’Ÿï¼‰</li>
<li>ä½å˜æ›´é¢‘ç‡æ•°æ®ï¼šè®¾ç½®è¾ƒé•¿ TTLï¼ˆ30 åˆ†é’Ÿ-24 å°æ—¶ï¼‰</li>
<li>é™æ€æ•°æ®ï¼šå¯è®¾ç½®è¾ƒé•¿ TTL æˆ–æ°¸ä¸è¿‡æœŸ</li>
</ul>
<p><strong>å†…å­˜ç®¡ç†</strong>æ˜¯å…³é”®ï¼Œç‰¹åˆ«æ˜¯æœ¬åœ°ç¼“å­˜éœ€é™åˆ¶æœ€å¤§å®¹é‡ï¼Œé¿å…å†…å­˜æº¢å‡ºã€‚Caffeine æ¨èä½¿ç”¨åŸºäºå¤§å°å’ŒåŸºäºæ—¶é—´çš„æ··åˆæ·˜æ±°ç­–ç•¥ã€‚</p>
<h3 data-id="heading-19">5.3 ç›‘æ§ä¸å‘Šè­¦ä½“ç³»</h3>
<p>å»ºç«‹å®Œå–„çš„<strong>ç›‘æ§æŒ‡æ ‡</strong>ä½“ç³»ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>å„çº§ç¼“å­˜å‘½ä¸­ç‡ï¼ˆHit Rateï¼‰</li>
<li>ç¼“å­˜å“åº”æ—¶é—´åˆ†ä½å€¼</li>
<li>å†…å­˜ä½¿ç”¨ç‡ä¸æ·˜æ±°æƒ…å†µ</li>
<li>ç¼“å­˜é‡å»ºé¢‘ç‡ä¸å¤±è´¥ç‡</li>
</ul>
<p>è®¾ç½®åˆç†çš„â€‹<strong>å‘Šè­¦é˜ˆå€¼</strong>â€‹ï¼Œå½“ç¼“å­˜å‘½ä¸­ç‡ä¸‹é™æˆ–å“åº”æ—¶é—´å»¶é•¿æ—¶åŠæ—¶é¢„è­¦ï¼Œé˜²æ­¢é—®é¢˜æ‰©å¤§ã€‚</p>
<h2 data-id="heading-20">æ€»ç»“</h2>
<p>å¤šçº§ç¼“å­˜æ¶æ„æ˜¯ç°ä»£é«˜å¹¶å‘ç³»ç»Ÿçš„å¿…å¤‡ç»„ä»¶ï¼Œé€šè¿‡åœ¨æ€§èƒ½ã€ä¸€è‡´æ€§ã€å¤æ‚åº¦ä¹‹é—´æ‰¾åˆ°æœ€ä½³å¹³è¡¡ç‚¹ï¼Œå®ç°ç³»ç»Ÿæ€§èƒ½çš„æœ€å¤§åŒ–ã€‚æœ¬åœ°ç¼“å­˜ä¸åˆ†å¸ƒå¼ç¼“å­˜çš„ç»„åˆæ˜¯è¿™ä¸€æ¶æ„çš„æ ¸å¿ƒï¼Œè€Œæ—è·¯ç¼“å­˜æ¨¡å¼åˆ™æ˜¯å®ç°ç¼“å­˜æ›´æ–°çš„åŸºç¡€ç­–ç•¥ã€‚</p>
<p>æˆåŠŸçš„å¤šçº§ç¼“å­˜è®¾è®¡éœ€è¦æ·±å…¥ç†è§£ä¸šåŠ¡ç‰¹ç‚¹å’Œæ•°æ®è®¿é—®æ¨¡å¼ï¼Œé’ˆå¯¹æ€§åœ°åˆ¶å®šç¼“å­˜ç­–ç•¥ã€ä¸€è‡´æ€§æ–¹æ¡ˆå’Œå¤±æ•ˆé˜²æŠ¤æœºåˆ¶ã€‚æ²¡æœ‰æ”¾ä¹‹å››æµ·è€Œçš†å‡†çš„æœ€ä¼˜è§£ï¼Œåªæœ‰æœ€é€‚åˆå½“å‰ä¸šåŠ¡åœºæ™¯çš„æŠ€æœ¯å–èˆã€‚</p>
<p><strong>ğŸ“š ä¸‹ç¯‡é¢„å‘Š</strong>â€‹</p>
<p>ã€Šåˆ†å¸ƒå¼é”ä¸å¹‚ç­‰çš„è¾¹ç•Œâ€”â€”æ­£ç¡®çš„é”è¯­ä¹‰ã€è¿‡æœŸä¸ç»­çº¦ã€ä¸šåŠ¡å±‚å¹‚ç­‰é…åˆã€‹â€”â€” æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ï¼š</p>
<ul>
<li>ğŸ”’ â€‹<strong>åˆ†å¸ƒå¼é”æœ¬è´¨</strong>â€‹ï¼šäº’æ–¥è®¿é—®ä¸èµ„æºåè°ƒçš„åº•å±‚åŸç†</li>
<li>â±ï¸ â€‹<strong>é”è¿‡æœŸä¸ç»­çº¦</strong>â€‹ï¼šé¿å…é”æå‰é‡Šæ”¾ä¸æ­»é”çš„ç²¾ç»†æ§åˆ¶</li>
<li>â™»ï¸ â€‹<strong>å¹‚ç­‰è®¾è®¡æ¨¡å¼</strong>â€‹ï¼šä¸šåŠ¡å±‚å»é‡ä¸å¹¶å‘æ§åˆ¶çš„ååŒæ–¹æ¡ˆ</li>
<li>ğŸš¨ â€‹<strong>ä¸´ç•Œåœºæ™¯å‰–æ</strong>â€‹ï¼šé”å¤±æ•ˆä¸å¹‚ç­‰è¾¹ç•Œæ¡ˆä¾‹çš„åº”å¯¹ç­–ç•¥</li>
<li>ğŸ“Š â€‹<strong>æ€§èƒ½ä¸å®‰å…¨å¹³è¡¡</strong>â€‹ï¼šé«˜å¹¶å‘ä¸‹é”ç²’åº¦ä¸ç³»ç»Ÿååçš„ä¼˜åŒ–</li>
</ul>
<p><strong>â€‹ç‚¹å‡»å…³æ³¨ï¼ŒæŒæ¡åˆ†å¸ƒå¼å¹¶å‘æ§åˆ¶çš„ç²¾é«“ï¼â€‹</strong>â€‹</p>
<blockquote>
<p>â€‹<strong>ä»Šæ—¥è¡ŒåŠ¨å»ºè®®</strong>â€‹ï¼š</p>
<ol>
<li>åˆ†æç°æœ‰ç³»ç»Ÿçš„æ•°æ®è®¿é—®æ¨¡å¼ï¼Œè¯†åˆ«é€‚åˆå¼•å…¥å¤šçº§ç¼“å­˜çš„åœºæ™¯</li>
<li>è¯„ä¼°å½“å‰ç¼“å­˜ç­–ç•¥çš„ä¸€è‡´æ€§é£é™©ï¼Œåˆ¶å®šé’ˆå¯¹æ€§ä¼˜åŒ–æ–¹æ¡ˆ</li>
<li>ä¸ºç¼“å­˜ç³»ç»Ÿæ·»åŠ è¯¦ç»†ç›‘æ§æŒ‡æ ‡ï¼Œå»ºç«‹æ€§èƒ½åŸºçº¿</li>
<li>è®¾è®¡ç¼“å­˜å¤±æ•ˆåº”æ€¥é¢„æ¡ˆï¼Œç¡®ä¿ç³»ç»Ÿé«˜å¯ç”¨æ€§</li>
</ol>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¾®ä¿¡æ”¯ä»˜é›†æˆ_JSAPI]]></title>    <link>https://juejin.cn/post/7582923861769453618</link>    <guid>https://juejin.cn/post/7582923861769453618</guid>    <pubDate>2025-12-14T04:48:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582923861769453618" data-draft-id="7582905804049137691" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¾®ä¿¡æ”¯ä»˜é›†æˆ_JSAPI"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-14T04:48:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="_æ¨ç€šåš"/> <meta itemprop="url" content="https://juejin.cn/user/1890815727123815"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¾®ä¿¡æ”¯ä»˜é›†æˆ_JSAPI
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1890815727123815/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    _æ¨ç€šåš
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T04:48:50.000Z" title="Sun Dec 14 2025 04:48:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¾®ä¿¡æ”¯ä»˜é›†æˆ_JSAPI</h2>
<h3 data-id="heading-1">0.èƒŒæ™¯</h3>
<p>äº§å“æ¥å…¥å¾®ä¿¡æ”¯ä»˜,éœ€è¦å®ç°PCç«¯æ‰«ç æ”¯ä»˜,ç§»åŠ¨ç«¯å…¬ä¼—å·æ”¯ä»˜,ä»¥åŠå°ç¨‹åºæ”¯ä»˜.ç»è¿‡è°ƒç ”ç»Ÿä¸€é‡‡ç”¨å¾®ä¿¡çš„JSAPIå®ç°.ä¸»è¦è¿‡ç¨‹åˆ†ä¸¤ä¸ªå¤§æ­¥éª¤:</p>
<ul>
<li>ä¸‹å•æ¥å£(<code>/v3/pay/transactions/jsapi</code>),è·å–é¢„ä»˜å•å·</li>
<li>åˆ‡æ¢åˆ°å¾®ä¿¡ç¯å¢ƒ(å…¬ä¼—å·,å°ç¨‹åº)å¹¶ç»“åˆé¢„ä»˜å•å·,å”¤èµ·æ”¯ä»˜ç•Œé¢,ç”¨æˆ·å®Œæˆæ”¯ä»˜</li>
</ul>
<p>éœ€è¦å®é™…åœ¨æ‰‹æœºå®Œæˆæ”¯ä»˜,æœ¬æ¬¡æµ‹è¯•ä»£ç å…¨éƒ¨é€šè¿‡å‰ç«¯å®ç°.é’ˆå¯¹è®¿é—®å¾®ä¿¡ä¸‹å•æ¥å£,é€šè¿‡nginä»£ç†é¿å…å‰ç«¯è·¨åŸŸé—®é¢˜.
æœ‰å®Œæ•´æµ‹è¯•ä»£ç ,è‹¥éœ€è¦è¯·å…³æ³¨å…¬ä¼—å·<strong>å°æ»¡å°æ…¢</strong>å›å¤<strong>wepay</strong>è·å–.è·å–ä»£ç å,ä½ åªéœ€æŠŠ<code>src</code>éƒ¨ç½²åˆ°ä½ æœåŠ¡å™¨,ç„¶ååœ¨å¾®ä¿¡ä¸­è®¿é—®
å³å¯.å¦‚æœåŸŸåèƒ½æ˜ å°„åˆ°ä½ æœ¬åœ°å¼€å‘æœºä¸Š,ç›´æ¥<code>npm run server</code>è¿è¡Œä¹Ÿæ˜¯ä¸é”™çš„é€‰æ‹©.
è¿™ç§æ–¹å¼è¿è¡Œ,å·²ç»å†…ç½®ä»£ç†.ä¸éœ€è¦å•ç‹¬å†é…ç½®<code>nginx</code></p>
<h3 data-id="heading-2">1.é›†æˆå‰ç½®å‡†å¤‡</h3>
<p>éœ€è¦åœ¨å¾®ä¿¡æ”¯ä»˜å¹³å°ç”³è¯·å•†æˆ·å·.ç”³è¯·å¥½ä»¥åéœ€è¦åœ¨å•†æˆ·å·ä¸Šå…³è”å¯¹åº”çš„å…¬ä¼—å·,å°ç¨‹åºç­‰.æ¶‰åŠå¾®ä¿¡æ”¯ä»˜å¹³å°,éœ€è¦æå‰å‡†å¤‡ä¸€ä¸‹ä¿¡æ¯</p>
<ul>
<li>å¾®ä¿¡æ”¯ä»˜åœ°å€: <a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.mch.weixin.qq.com" target="_blank" title="https://api.mch.weixin.qq.com" ref="nofollow noopener noreferrer">api.mch.weixin.qq.com</a></li>
<li>å•†æˆ·å·ID (mchid)</li>
<li>å•†æˆ·APIè¯ä¹¦ (apiclient_key.pem)</li>
<li>å•†æˆ·APIè¯ä¹¦åºåˆ—å·(merchant_serial_no)</li>
<li>å…¬ä¼—å·æˆ–å°ç¨‹åºçš„appid (appid)</li>
<li>æµ‹è¯•ç”¨æˆ·å¯¹åº”å…¬ä¼—æˆ–å°ç¨‹åºçš„openid (openid)</li>
</ul>
<p>ç³»ç»Ÿé›†æˆéœ€è¦å‡†å¤‡ä»¥ä¸‹ä¿¡æ¯</p>
<ul>
<li>å¤‡æ¡ˆé€šè¿‡çš„åŸŸå</li>
<li>å¾®ä¿¡æ”¯ä»˜å›è°ƒåœ°å€ (notify_url)</li>
</ul>
<p>å•†æˆ·å¹³å°é…ç½®</p>
<ul>
<li>äº§å“ä¸­å¿ƒ/AppIDè´¦å·ç®¡ç† å…³è”å°ç¨‹åºæˆ–è€…å…¬ä¼—å·</li>
<li>äº§å“ä¸­å¿ƒ/å¼€å‘é…ç½® æ³¨å†Œå”¤èµ·æ”¯ä»˜url<strong>å¿…é¡»ä¸€æ ·</strong></li>
</ul>
<h3 data-id="heading-3">2. æµ‹è¯•é¡µé¢å¼€å‘</h3>
<p>æµ‹è¯•é¡µé¢æ–¹ä¾¿ä¸åŒçš„å•†æˆ·å·æµ‹è¯•,æ•´ä½“åˆ†ä¸¤éƒ¨åˆ†å†…å®¹</p>
<ol>
<li>å…¨å±€é…ç½®,ä¸»è¦é…ç½® mchid,apiclient_key.pem,merchant_serial_no,appid,openid,notify_url é…ç½®å¥½ä»¥å,ä¿¡æ¯å­˜å‚¨åœ¨localStorageä¸­</li>
<li>æ”¯ä»˜ä¿¡æ¯,ä¸»è¦è®¾ç½® æ”¯ä»˜é‡‘é¢, æ”¯ä»˜è¯´æ˜,æ˜¯å¦åˆ†è´¦.æ”¯ä»˜é‡‘é¢æœ€å¤šä¸¤ä½å°æ•°</li>
</ol>
<p>æ•´ä½“æµ‹è¯•é¡µé¢å¦‚ä¸‹
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/60d33f97673d44078fd66a12116303ca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-adqOeAmuWNmg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766292530&amp;x-signature=JtAEtOpumyUcWh6RcIEAnDzyLSk%3D" alt="æ”¯ä»˜æµ‹è¯•é¡µé¢" loading="lazy"/></p>
<h3 data-id="heading-4">3. JSAPIä¸‹å•æ¥å£</h3>
<p>æ”¯ä»˜æ¥å£éœ€è¦åšç­¾åå¤„ç†,ç­¾åé‡‡ç”¨RASç®—æ³•,ä½¿ç”¨<code>forge.js</code>æä¾›çš„ç®—æ³•</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fpay.weixin.qq.com%2Fdoc%2Fv3%2Fmerchant%2F4012791856" target="_blank" title="https://pay.weixin.qq.com/doc/v3/merchant/4012791856" ref="nofollow noopener noreferrer">å®˜æ–¹å‚è€ƒæ–‡æ¡£ https://pay.weixin.qq.com/doc/v3/merchant/4012791856</a></p>
<p>ä¸‹å•æ¥å£çš„ç­¾åä¸²è§„åˆ™å¦‚ä¸‹:</p>
<pre><code class="hljs language-txt" lang="txt">HTTPè¯·æ±‚æ–¹æ³•\n
URL\n
è¯·æ±‚æ—¶é—´æˆ³\n
è¯·æ±‚éšæœºä¸²\n
è¯·æ±‚æŠ¥æ–‡ä¸»ä½“\n
</code></pre>
<p>å®é™…ä»£ç ä½“ç°å¦‚ä¸‹:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> message =
  <span class="hljs-string">"POST\n"</span> +
  <span class="hljs-string">"/v3/pay/transactions/jsapi\n"</span> +
  timeStamp + <span class="hljs-string">"\n"</span> +
  nonceStr +<span class="hljs-string">"\n"</span> +
  <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(payData) +<span class="hljs-string">"\n"</span>;
</code></pre>
<p>åœ¨å‰ç«¯é’ˆå¯¹timeStampæœ‰äº›ç‰¹æ®Šå¤„ç†</p>
<ul>
<li>å‚æ•°è¦æ±‚åˆ°ç§’,å‰ç«¯é€šè¿‡<code>new Date().getTime()</code>æ˜¯åˆ°æ¯«ç§’çš„,éœ€è¦é™¤1000</li>
<li>å¿…é¡»è½¬æ¢æˆå­—ç¬¦ä¸²,å¦åˆ™å¾®ä¿¡æ¥å£ä¼šæŠ¥é”™</li>
</ul>
<p>ç”Ÿæˆç­¾åçš„ä¸»è¦ä»£ç å¦‚ä¸‹:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å°æ¸¸æˆ åœ°å¿ƒä¾ å£«</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getSign</span>(<span class="hljs-params">message, privateKeyStr</span>) {
  <span class="hljs-keyword">const</span> privateKey = forge.<span class="hljs-property">pki</span>.<span class="hljs-title function_">privateKeyFromPem</span>(privateKeyStr);
  <span class="hljs-keyword">const</span> sha256 = forge.<span class="hljs-property">md</span>.<span class="hljs-property">sha256</span>.<span class="hljs-title function_">create</span>();
  sha256.<span class="hljs-title function_">update</span>(forge.<span class="hljs-property">util</span>.<span class="hljs-title function_">encodeUtf8</span>(message));
  <span class="hljs-keyword">const</span> signature = forge.<span class="hljs-property">util</span>.<span class="hljs-title function_">encode64</span>(privateKey.<span class="hljs-title function_">sign</span>(sha256));
  <span class="hljs-keyword">return</span> signature
}
</code></pre>
<p>æœ€ç»ˆå®Œæ•´çš„è®¤è¯ä¿¡æ¯å¦‚ä¸‹:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">WECHATPAY2</span>-<span class="hljs-title class_">SHA256</span>-<span class="hljs-title class_">RSA2048</span> mchid=<span class="hljs-string">"${mchid}"</span>,serial_no=<span class="hljs-string">"${serialNo}"</span>,nonce_str=<span class="hljs-string">"${nonceStr}"</span>,timestamp=<span class="hljs-string">"${timeStamp}"</span>,signature=<span class="hljs-string">"${signature}"</span>
</code></pre>
<p>å‰ç«¯å®Œæ•´ä¸‹å•ä»£ç å¦‚ä¸‹:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">processPayinfo</span>(<span class="hljs-params">cfgInfo, payInfo</span>) {
  <span class="hljs-keyword">const</span> payData =
  {
      <span class="hljs-string">"appid"</span>: cfgInfo.<span class="hljs-property">appid</span>,
      <span class="hljs-string">"mchid"</span>: cfgInfo.<span class="hljs-property">mchid</span>,
      <span class="hljs-string">"description"</span>: payInfo.<span class="hljs-property">description</span>,
      <span class="hljs-string">"out_trade_no"</span>: payInfo.<span class="hljs-property">out_trade_no</span> || <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>() + <span class="hljs-string">""</span>,
      <span class="hljs-string">"attach"</span>: payInfo.<span class="hljs-property">attach</span>,
      <span class="hljs-string">"notify_url"</span>: cfgInfo.<span class="hljs-property">callback_url</span>,
      <span class="hljs-string">"support_fapiao"</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-string">"amount"</span>: {
          <span class="hljs-string">"total"</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(payInfo.<span class="hljs-property">amount</span> * <span class="hljs-number">100</span>),
          <span class="hljs-string">"currency"</span>: <span class="hljs-string">"CNY"</span>
      },
      <span class="hljs-string">"payer"</span>: {
          <span class="hljs-string">"openid"</span>: cfgInfo.<span class="hljs-property">openid</span>
      },
      <span class="hljs-string">"settle_info"</span>: {
          <span class="hljs-string">"profit_sharing"</span>: payInfo.<span class="hljs-property">split_payment</span>
      }
  };
  <span class="hljs-keyword">const</span> nonceStr = <span class="hljs-title function_">generateNonceStr</span>();
  <span class="hljs-keyword">const</span> timeStamp = <span class="hljs-title function_">getTimeStamp</span>();
  <span class="hljs-keyword">const</span> mchid = cfgInfo.<span class="hljs-property">mchid</span>;
  <span class="hljs-keyword">const</span> method = <span class="hljs-string">"POST"</span>;
  <span class="hljs-keyword">const</span> payUri = <span class="hljs-string">"/v3/pay/transactions/jsapi"</span>;
  <span class="hljs-comment">// å°æ¸¸æˆ åœ°å½¢ä¾ å£« ç­¾ååŸå§‹ä¸²</span>
  <span class="hljs-keyword">const</span> message =method +<span class="hljs-string">"\n"</span> +payUri +<span class="hljs-string">"\n"</span> +timeStamp +
                <span class="hljs-string">"\n"</span> +nonceStr +<span class="hljs-string">"\n"</span> +<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(payData) +<span class="hljs-string">"\n"</span>;
  <span class="hljs-comment">// å°æ¸¸æˆ åœ°å¿ƒä¾ å£« ç”Ÿæˆç­¾å    </span>
  <span class="hljs-keyword">const</span> serialNo = cfgInfo.<span class="hljs-property">merchant_serial_no</span>
  <span class="hljs-keyword">const</span> privateKeyStr = cfgInfo.<span class="hljs-property">apiclient_key</span>;
  <span class="hljs-keyword">const</span> signature = <span class="hljs-title function_">getSign</span>(message, privateKeyStr);
  <span class="hljs-comment">// å°æ¸¸æˆ åœ°å¿ƒä¾ å£« å®Œæ•´è®¤è¯ä¸²</span>
  <span class="hljs-keyword">let</span> auth = <span class="hljs-string">`WECHATPAY2-SHA256-RSA2048 mchid="<span class="hljs-subst">${mchid}</span>",serial_no="<span class="hljs-subst">${serialNo}</span>",nonce_str="<span class="hljs-subst">${nonceStr}</span>",timestamp="<span class="hljs-subst">${timeStamp}</span>",signature="<span class="hljs-subst">${signature}</span>`</span>
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(payUri, {
      <span class="hljs-attr">method</span>: method,
      <span class="hljs-attr">mode</span>: <span class="hljs-string">'cors'</span>,
      <span class="hljs-attr">headers</span>: {
          <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
          <span class="hljs-string">'Authorization'</span>: auth
      },
      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(payData)
  });
  <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTP error! status: <span class="hljs-subst">${response.status}</span>`</span>);
  }
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result)
  <span class="hljs-keyword">return</span> result;
}
</code></pre>
<p>ä»¥ä¸Šä»£ç ,æ‰§è¡ŒæˆåŠŸå°±ä¼šè¿”å›é¢„ä»˜è®¢å•å·,ç±»ä¼¼å¦‚ä¸‹çš„å“åº”æ­£æ–‡</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"prepay_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"wx132023572988633421178322a067e20000"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-5">4. å”¤èµ·å¾®ä¿¡æ”¯ä»˜</h3>
<p>åœ¨ä¸Šè¾¹æ‹¿åˆ°é¢„ä»˜å•å·ä»¥å,å°±å¯ä»¥åœ¨å¾®ä¿¡ç¯å¢ƒå”¤èµ·å¾®ä¿¡æ”¯ä»˜ç•Œé¢äº†.å”¤èµ·å¾®ä¿¡æ”¯ä»˜é€šç”¨æ¶‰åŠåˆ°ç­¾å,è¿™é‡Œçš„ç­¾åæ–¹æ³•ä¸€æ ·,ä½†æ˜¯ç­¾åä¸²è§„åˆ™ç•¥æœ‰å˜åŒ–.ç­¾åä¸²è§„åˆ™å¦‚ä¸‹:</p>
<pre><code class="hljs language-text" lang="text">appId\n
æ—¶é—´æˆ³\n
éšæœºå­—ç¬¦ä¸²\n
prepay_id=\n
</code></pre>
<p>è¿™éœ€è¦æ³¨æ„çš„æ˜¯,<code>package</code>å¹¶ä¸æ˜¯ä¸‹å•æ¥å£è¿”å›çš„JSONä¸²,éœ€è¦è½¬æ¢æˆ<code>key=value</code>çš„å½¢å¼
å®Œæˆå”¤èµ·æ”¯ä»˜ä»£ç å¦‚ä¸‹:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">onBridgeReady</span>(<span class="hljs-params">cfgInfo, prepayinfo, cb</span>) {
  <span class="hljs-keyword">const</span> nonceStr = <span class="hljs-title function_">generateNonceStr</span>();
  <span class="hljs-keyword">const</span> timeStamp = <span class="hljs-title function_">getTimeStamp</span>();
  <span class="hljs-comment">// å°æ¸¸æˆ åœ°å¿ƒä¾ å£« è½¬æ¢é¢„ä»˜å•å·</span>
  <span class="hljs-keyword">const</span> package = <span class="hljs-string">"prepay_id="</span> + prepayinfo.<span class="hljs-property">prepay_id</span>;
  <span class="hljs-keyword">const</span> message =cfgInfo.<span class="hljs-property">appid</span> +<span class="hljs-string">"\n"</span> +timeStamp +<span class="hljs-string">"\n"</span> +
                 nonceStr +<span class="hljs-string">"\n"</span> + package +<span class="hljs-string">"\n"</span>;
  <span class="hljs-comment">// å°æ¸¸æˆ åœ°å¿ƒä¾ å£« ç”Ÿæˆç­¾å   </span>
  <span class="hljs-keyword">const</span> privateKeyStr = cfgInfo.<span class="hljs-property">apiclient_key</span>;
  <span class="hljs-keyword">const</span> signature = <span class="hljs-title function_">getSign</span>(message, privateKeyStr);
  <span class="hljs-title class_">WeixinJSBridge</span>.<span class="hljs-title function_">invoke</span>(<span class="hljs-string">'getBrandWCPayRequest'</span>, {
      <span class="hljs-string">"appId"</span>: cfgInfo.<span class="hljs-property">appid</span>,
      <span class="hljs-string">"timeStamp"</span>: timeStamp,
      <span class="hljs-string">"nonceStr"</span>: nonceStr,
      <span class="hljs-string">"package"</span>: package,
      <span class="hljs-string">"signType"</span>: <span class="hljs-string">"RSA"</span>,
      <span class="hljs-string">"paySign"</span>: signature,
  }, <span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) {
      cb &amp;&amp; <span class="hljs-title function_">cb</span>(res);
      <span class="hljs-keyword">if</span> (res.<span class="hljs-property">err_msg</span> == <span class="hljs-string">"get_brand_wcpay_request:ok"</span>) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ”¯ä»˜æˆåŠŸ"</span>)
      }
  });
}
</code></pre>
<p>è¿è¡ŒæˆåŠŸå,å°±ä¼šå¼¹å‡ºå¾®ä¿¡æ”¯ä»˜çš„é¡µé¢,æµ‹è¯•ç•Œé¢æ˜¾ç¤ºå¦‚ä¸‹</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d35d6fb348f849df8bf70367394cc75d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgX-adqOeAmuWNmg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766292530&amp;x-signature=1ReZxd%2FP2QflD4tnZ%2BoHKhEhpw8%3D" alt="å¾®ä¿¡æ”¯ä»˜" loading="lazy"/></p>
<h3 data-id="heading-6">5. nginxè·¨åŸŸé…ç½®</h3>
<p>æ•´ä¸ªæµ‹è¯•ä»£ç å®Œå…¨é€šè¿‡å‰ç«¯JSå®ç°,åœ¨è®¿é—®å¾®ä¿¡ä¸‹å•æ¥å£æ—¶ä¼šæœ‰è·¨åŸŸé™åˆ¶,åœ¨å®é™…æœåŠ¡å™¨ä¸­,éœ€è¦é€šè¿‡nginxå¯¹å¾®ä¿¡æ¥å£å®ç°ä»£ç†.å…³é”®é…ç½®å¦‚ä¸‹</p>
<pre><code class="hljs language-nigx" lang="nigx"># === å°æ¸¸æˆ åœ°å¿ƒä¾ å£« å¾®ä¿¡æ”¯ä»˜ä»£ç†é…ç½® ===
location ^~ /v3/pay/ {
  # ç›®æ ‡æœåŠ¡å™¨åœ°å€ï¼ˆæ›¿æ¢ä¸ºå®é™…åœ°å€ï¼‰
  proxy_pass https://api.mch.weixin.qq.com;
  
  # å…³é”®å¤´è®¾ç½®
  proxy_set_header Host api.mch.weixin.qq.com;
  proxy_set_header X-Real-IP $remote_addr;
  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  proxy_set_header X-Forwarded-Proto $scheme;
  proxy_set_header User-Agent "WeChat-Pay-Proxy/1.0";
  
  # è¶…æ—¶è®¾ç½®
  proxy_connect_timeout 30s;
  proxy_send_timeout 30s;
  proxy_read_timeout 30s;
  
  # å¤„ç†CORS
  add_header 'Access-Control-Allow-Origin' '*' always;
  add_header 'Access-Control-Allow-Methods' '*' always;
  add_header 'Access-Control-Allow-Headers' '*' always;
  
  if ($request_method = 'OPTIONS') {
      add_header 'Access-Control-Allow-Origin' '*';
      add_header 'Access-Control-Allow-Methods' '*';
      add_header 'Access-Control-Allow-Headers' '*';
      return 204;
  }
}
</code></pre>
<h3 data-id="heading-7">6. æ€»ç»“</h3>
<p>å¾®ä¿¡äº¤äº’å¸¸è§„çš„åšæ³•æ˜¯é€šè¿‡åç«¯å‘é€è¯·æ±‚åˆ°å¾®ä¿¡æœåŠ¡å™¨,å¾®ä¿¡æœåŠ¡å™¨è¿”å›æ•°æ®,ç„¶åé€šè¿‡å‰ç«¯è·å–æ•°æ®,å†è¿›è¡Œäº¤äº’ã€‚åœ¨æµ‹è¯•æ—¶,å‰ç«¯å”¤èµ·æ”¯ä»˜,åç«¯æä¾›é¢„å®šå•æ¥å£.å‰åç«¯éƒ½ä¸æ–¹ä¾¿æµ‹è¯•æ”¯ä»˜æƒ…å†µ.æ‰€æœ‰æ‰ç»“åˆå¾®ä¿¡æä¾›POSTMANä¸­æ¥å£æµ‹è¯•æ–¹æ³•,å®Œæˆè¿™ä¸ªçº¯å‰ç«¯çš„,é€šç”¨çš„,å¾®ä¿¡æ”¯ä»˜æµ‹è¯•é¡µé¢.å¦‚éœ€è¦å®Œæˆæºç ,è¯·åœ¨å¾®ä¿¡å…¬ä¼—<strong>å°æ»¡å°æ…¢</strong>å›å¤<strong>wepay</strong>è·å–æµ‹è¯•ä»£ç 
åŸæ–‡åœ°å€:<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fr8kAPXyuWZfN7wHXA7VZbw" target="_blank" title="https://mp.weixin.qq.com/s/r8kAPXyuWZfN7wHXA7VZbw" ref="nofollow noopener noreferrer">mp.weixin.qq.com/s/r8kAPXyuWâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vueé¡¹ç›®Axioså°è£…å…¨æ”»ç•¥ï¼šä»é›¶åˆ°ä¸€æ‰“é€ ä¼˜é›…çš„HTTPè¯·æ±‚å±‚]]></title>    <link>https://juejin.cn/post/7583174749066412078</link>    <guid>https://juejin.cn/post/7583174749066412078</guid>    <pubDate>2025-12-14T04:51:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583174749066412078" data-draft-id="7582955784570880051" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vueé¡¹ç›®Axioså°è£…å…¨æ”»ç•¥ï¼šä»é›¶åˆ°ä¸€æ‰“é€ ä¼˜é›…çš„HTTPè¯·æ±‚å±‚"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2025-12-14T04:51:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŒ—è¾°alk"/> <meta itemprop="url" content="https://juejin.cn/user/1772855673241352"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vueé¡¹ç›®Axioså°è£…å…¨æ”»ç•¥ï¼šä»é›¶åˆ°ä¸€æ‰“é€ ä¼˜é›…çš„HTTPè¯·æ±‚å±‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1772855673241352/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŒ—è¾°alk
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T04:51:19.000Z" title="Sun Dec 14 2025 04:51:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä»Šå¤©æˆ‘ä»¬æ¥èŠèŠVueé¡¹ç›®ä¸­ä¸€ä¸ªçœ‹ä¼¼åŸºç¡€å´è‡³å…³é‡è¦çš„æŠ€èƒ½â€”â€”Axioså°è£…ã€‚ç›¸ä¿¡ä¸å°‘å‰ç«¯å¼€å‘è€…éƒ½æœ‰è¿‡è¿™æ ·çš„å›°æƒ‘ï¼šä¸ºä»€ä¹ˆæˆ‘çš„æ¥å£è¯·æ±‚ä»£ç æ€»æ˜¯é‡å¤ï¼Ÿä¸ºä»€ä¹ˆé”™è¯¯å¤„ç†å¦‚æ­¤æ··ä¹±ï¼Ÿå¦‚ä½•ç»Ÿä¸€ç®¡ç†APIåœ°å€ï¼Ÿ</p>
<p>åˆ«æ‹…å¿ƒï¼Œè¯»å®Œè¿™ç¯‡æ–‡ç« ï¼Œä½ å°†å½»åº•æŒæ¡Axioså°è£…çš„ç²¾é«“ï¼Œæ‰“é€ å‡ºå±äºä½ è‡ªå·±çš„ä¼˜é›…HTTPè¯·æ±‚å±‚ï¼</p>
<h2 data-id="heading-0">ä¸ºä»€ä¹ˆè¦å°è£…Axiosï¼Ÿ</h2>
<p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆè¦å°è£…Axiosï¼Ÿ</p>
<p><strong>ä¸å°è£…çš„ç—›è‹¦ï¼š</strong></p>
<ul>
<li>â€¢ æ¯ä¸ªè¯·æ±‚éƒ½è¦é‡å¤å†™<code>axios.get()</code>æˆ–<code>axios.post()</code></li>
<li>â€¢ æ¯ä¸ªè¯·æ±‚éƒ½è¦å•ç‹¬å¤„ç†é”™è¯¯</li>
<li>â€¢ åˆ‡æ¢ç¯å¢ƒæ—¶ï¼Œéœ€è¦æ‰‹åŠ¨ä¿®æ”¹å¤§é‡baseURL</li>
<li>â€¢ ç¼ºä¹ç»Ÿä¸€çš„loadingå¤„ç†</li>
<li>â€¢ éš¾ä»¥ç®¡ç†æ¥å£å’Œç»Ÿä¸€æ·»åŠ è®¤è¯ä¿¡æ¯</li>
</ul>
<p><strong>å°è£…çš„å¥½å¤„ï¼š</strong></p>
<ul>
<li>â€¢ ç»Ÿä¸€ç®¡ç†APIåœ°å€å’Œæ¥å£</li>
<li>â€¢ ç»Ÿä¸€å¤„ç†é”™è¯¯å’Œloading</li>
<li>â€¢ å‡å°‘é‡å¤ä»£ç ï¼Œæé«˜å¼€å‘æ•ˆç‡</li>
<li>â€¢ æ–¹ä¾¿ç»´æŠ¤å’Œæ›´æ–°</li>
<li>â€¢ å¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§</li>
</ul>
<h2 data-id="heading-1">å°è£…è®¾è®¡æ€è·¯</h2>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹æ•´ä½“è®¾è®¡æ€è·¯ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">æ·»åŠ token

æ˜¾ç¤ºloading

åºåˆ—åŒ–æ•°æ®

å¤„ç†é”™è¯¯

éšè—loading

è½¬æ¢æ•°æ®

å‘èµ·<span class="hljs-variable constant_">HTTP</span>è¯·æ±‚è¯·æ±‚æ‹¦æˆªå™¨æ‹¦æˆªå™¨å¤„ç†æ·»åŠ è®¤è¯ä¿¡æ¯æ˜¾ç¤ºåŠ è½½çŠ¶æ€æ•°æ®å¤„ç†å‘é€è¯·æ±‚æ¥æ”¶å“åº”å“åº”æ‹¦æˆªå™¨æ‹¦æˆªå™¨å¤„ç†ç»Ÿä¸€é”™è¯¯å¤„ç†éšè—åŠ è½½çŠ¶æ€æ•°æ®è½¬æ¢è¿”å›<span class="hljs-title class_">Promise</span>
</code></pre>
<h2 data-id="heading-2">ç¬¬ä¸€æ­¥ï¼šåŸºç¡€å°è£…</h2>
<h3 data-id="heading-3">1. å®‰è£…ä¾èµ–</h3>
<p>é¦–å…ˆï¼Œç¡®ä¿å·²ç»å®‰è£…äº†axiosï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">npmÂ installÂ axios
<span class="hljs-meta">#Â æˆ–</span>
yarnÂ <span class="hljs-keyword">add</span>Â axios
</code></pre>
<h3 data-id="heading-4">2. åˆ›å»ºAxioså®ä¾‹</h3>
<p>åœ¨<code>src/utils/request.js</code>ä¸­åˆ›å»ºåŸºç¡€çš„axioså®ä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span>Â axiosÂ <span class="hljs-keyword">from</span>Â <span class="hljs-string">'axios'</span>
<span class="hljs-keyword">import</span>Â {Â <span class="hljs-title class_">Message</span>Â }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'element-ui'</span>Â <span class="hljs-comment">//Â ä»¥ElementÂ UIä¸ºä¾‹ï¼Œå¯æ ¹æ®é¡¹ç›®ä½¿ç”¨UIåº“è°ƒæ•´</span>

<span class="hljs-comment">//Â åˆ›å»ºaxioså®ä¾‹</span>
<span class="hljs-keyword">const</span>Â serviceÂ =Â axios.<span class="hljs-title function_">create</span>({
Â Â <span class="hljs-attr">baseURL</span>:Â process.<span class="hljs-property">env</span>.<span class="hljs-property">VUE_APP_BASE_API</span>,Â <span class="hljs-comment">//Â ä»ç¯å¢ƒå˜é‡è¯»å–APIåœ°å€</span>
Â Â <span class="hljs-attr">timeout</span>:Â <span class="hljs-number">10000</span>,Â <span class="hljs-comment">//Â è¯·æ±‚è¶…æ—¶æ—¶é—´</span>
Â Â <span class="hljs-attr">headers</span>:Â {
Â Â Â Â <span class="hljs-string">'Content-Type'</span>:Â <span class="hljs-string">'application/json;charset=utf-8'</span>
Â Â }
})

<span class="hljs-comment">//Â è¯·æ±‚æ‹¦æˆªå™¨</span>
service.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(
Â Â <span class="hljs-function"><span class="hljs-params">config</span>Â =&gt;</span>Â {
Â Â Â Â <span class="hljs-comment">//Â åœ¨å‘é€è¯·æ±‚ä¹‹å‰åšäº›ä»€ä¹ˆ</span>
Â Â Â Â <span class="hljs-comment">//Â 1.Â æ·»åŠ token</span>
Â Â Â Â <span class="hljs-keyword">const</span>Â tokenÂ =Â <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'token'</span>)
Â Â Â Â <span class="hljs-keyword">if</span>Â (token)Â {
Â Â Â Â Â Â config.<span class="hljs-property">headers</span>[<span class="hljs-string">'Authorization'</span>]Â =Â <span class="hljs-string">`BearerÂ <span class="hljs-subst">${token}</span>`</span>
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â 2.Â æ˜¾ç¤ºloadingï¼ˆå¦‚æœéœ€è¦ï¼‰</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (config.<span class="hljs-property">showLoading</span>)Â {
Â Â Â Â Â Â <span class="hljs-comment">//Â æ˜¾ç¤ºloadingç»„ä»¶</span>
Â Â Â Â Â Â <span class="hljs-title function_">showLoading</span>()
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">return</span>Â config
Â Â },
Â Â <span class="hljs-function"><span class="hljs-params">error</span>Â =&gt;</span>Â {
Â Â Â Â <span class="hljs-comment">//Â å¯¹è¯·æ±‚é”™è¯¯åšäº›ä»€ä¹ˆ</span>
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error)
Â Â }
)

<span class="hljs-comment">//Â å“åº”æ‹¦æˆªå™¨</span>
service.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(
Â Â <span class="hljs-function"><span class="hljs-params">response</span>Â =&gt;</span>Â {
Â Â Â Â <span class="hljs-comment">//Â å¯¹å“åº”æ•°æ®åšç‚¹ä»€ä¹ˆ</span>
Â Â Â Â <span class="hljs-comment">//Â éšè—loading</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (response.<span class="hljs-property">config</span>.<span class="hljs-property">showLoading</span>)Â {
Â Â Â Â Â Â <span class="hljs-title function_">hideLoading</span>()
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">const</span>Â resÂ =Â response.<span class="hljs-property">data</span>
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â å‡è®¾åç«¯è¿”å›çš„æ•°æ®æ ¼å¼ä¸ºÂ {Â code:Â 200,Â data:Â {},Â message:Â 'success'Â }</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (res.<span class="hljs-property">code</span>Â !==Â <span class="hljs-number">200</span>)Â {
Â Â Â Â Â Â <span class="hljs-comment">//Â å¤„ç†ä¸šåŠ¡é”™è¯¯</span>
Â Â Â Â Â Â <span class="hljs-title class_">Message</span>.<span class="hljs-title function_">error</span>(res.<span class="hljs-property">message</span>Â ||Â <span class="hljs-string">'è¯·æ±‚å¤±è´¥'</span>)
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Error</span>(res.<span class="hljs-property">message</span>Â ||Â <span class="hljs-string">'Error'</span>))
Â Â Â Â }Â <span class="hljs-keyword">else</span>Â {
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â res.<span class="hljs-property">data</span>
Â Â Â Â }
Â Â },
Â Â <span class="hljs-function"><span class="hljs-params">error</span>Â =&gt;</span>Â {
Â Â Â Â <span class="hljs-comment">//Â å¯¹å“åº”é”™è¯¯åšç‚¹ä»€ä¹ˆ</span>
Â Â Â Â <span class="hljs-comment">//Â éšè—loading</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (error.<span class="hljs-property">config</span>Â &amp;&amp;Â error.<span class="hljs-property">config</span>.<span class="hljs-property">showLoading</span>)Â {
Â Â Â Â Â Â <span class="hljs-title function_">hideLoading</span>()
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â å¤„ç†HTTPé”™è¯¯</span>
Â Â Â Â <span class="hljs-title function_">handleHttpError</span>(error)
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error)
Â Â }
)

<span class="hljs-comment">//Â HTTPé”™è¯¯å¤„ç†å‡½æ•°</span>
<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">handleHttpError</span>(<span class="hljs-params">error</span>)Â {
Â Â <span class="hljs-keyword">if</span>Â (error.<span class="hljs-property">response</span>)Â {
Â Â Â Â <span class="hljs-comment">//Â è¯·æ±‚æˆåŠŸå‘å‡ºä¸”æœåŠ¡å™¨ä¹Ÿå“åº”äº†çŠ¶æ€ç ï¼Œä½†çŠ¶æ€ç è¶…å‡ºäº†Â 2xxÂ çš„èŒƒå›´</span>
Â Â Â Â <span class="hljs-keyword">switch</span>Â (error.<span class="hljs-property">response</span>.<span class="hljs-property">status</span>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">400</span>:
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Message</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è¯·æ±‚é”™è¯¯'</span>)
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">401</span>:
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Message</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æœªæˆæƒï¼Œè¯·é‡æ–°ç™»å½•'</span>)
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è·³è½¬åˆ°ç™»å½•é¡µ</span>
Â Â Â Â Â Â Â Â router.<span class="hljs-title function_">push</span>(<span class="hljs-string">'/login'</span>)
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">403</span>:
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Message</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ‹’ç»è®¿é—®'</span>)
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">404</span>:
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Message</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨'</span>)
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">500</span>:
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Message</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯'</span>)
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">502</span>:
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Message</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ç½‘å…³é”™è¯¯'</span>)
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">503</span>:
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Message</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æœåŠ¡ä¸å¯ç”¨'</span>)
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">504</span>:
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Message</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ç½‘å…³è¶…æ—¶'</span>)
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-attr">default</span>:
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Message</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`è¯·æ±‚å¤±è´¥:Â <span class="hljs-subst">${error.response.status}</span>`</span>)
Â Â Â Â }
Â Â }Â <span class="hljs-keyword">else</span>Â <span class="hljs-keyword">if</span>Â (error.<span class="hljs-property">request</span>)Â {
Â Â Â Â <span class="hljs-comment">//Â è¯·æ±‚å·²ç»æˆåŠŸå‘èµ·ï¼Œä½†æ²¡æœ‰æ”¶åˆ°å“åº”</span>
Â Â Â Â <span class="hljs-title class_">Message</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ç½‘ç»œå¼‚å¸¸ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥'</span>)
Â Â }Â <span class="hljs-keyword">else</span>Â {
Â Â Â Â <span class="hljs-comment">//Â å‘é€è¯·æ±‚æ—¶å‡ºäº†ç‚¹é—®é¢˜</span>
Â Â Â Â <span class="hljs-title class_">Message</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•'</span>)
Â Â }
}

<span class="hljs-comment">//Â loadingè®¡æ•°å™¨</span>
<span class="hljs-keyword">let</span>Â loadingCountÂ =Â <span class="hljs-number">0</span>

<span class="hljs-comment">//Â æ˜¾ç¤ºloading</span>
<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">showLoading</span>(<span class="hljs-params"/>)Â {
Â Â <span class="hljs-keyword">if</span>Â (loadingCountÂ ===Â <span class="hljs-number">0</span>)Â {
Â Â Â Â <span class="hljs-comment">//Â è¿™é‡Œæ ¹æ®é¡¹ç›®ä½¿ç”¨çš„UIåº“æ¥æ˜¾ç¤ºloading</span>
Â Â Â Â <span class="hljs-comment">//Â ElementÂ UIç¤ºä¾‹</span>
Â Â Â Â <span class="hljs-comment">//Â Loading.service({Â fullscreen:Â trueÂ })</span>
Â Â }
Â Â loadingCount++
}

<span class="hljs-comment">//Â éšè—loading</span>
<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">hideLoading</span>(<span class="hljs-params"/>)Â {
Â Â loadingCount--
Â Â <span class="hljs-keyword">if</span>Â (loadingCountÂ &lt;=Â <span class="hljs-number">0</span>)Â {
Â Â Â Â <span class="hljs-comment">//Â å…³é—­loading</span>
Â Â Â Â <span class="hljs-comment">//Â Loadingå®ä¾‹çš„closeæ–¹æ³•</span>
Â Â }
}

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â service
</code></pre>
<h2 data-id="heading-5">ç¬¬äºŒæ­¥ï¼šé«˜çº§å°è£… - åˆ›å»ºAPIç®¡ç†å±‚</h2>
<h3 data-id="heading-6">1. åˆ›å»ºAPIç®¡ç†æ–‡ä»¶</h3>
<p>åœ¨<code>src/api</code>ç›®å½•ä¸‹åˆ›å»ºæ¥å£ç®¡ç†æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//Â src/api/index.js</span>
<span class="hljs-keyword">import</span>Â requestÂ <span class="hljs-keyword">from</span>Â <span class="hljs-string">'@/utils/request'</span>

<span class="hljs-comment">//Â ç”¨æˆ·ç›¸å…³API</span>
<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">const</span>Â userApiÂ =Â {
Â Â <span class="hljs-comment">//Â ç™»å½•</span>
Â Â <span class="hljs-title function_">login</span>(<span class="hljs-params">data</span>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">request</span>({
Â Â Â Â Â Â <span class="hljs-attr">url</span>:Â <span class="hljs-string">'/user/login'</span>,
Â Â Â Â Â Â <span class="hljs-attr">method</span>:Â <span class="hljs-string">'post'</span>,
Â Â Â Â Â Â data,
Â Â Â Â Â Â <span class="hljs-attr">showLoading</span>:Â <span class="hljs-literal">true</span>Â <span class="hljs-comment">//Â å¯é…ç½®æ˜¯å¦æ˜¾ç¤ºloading</span>
Â Â Â Â })
Â Â },
Â Â 
Â Â <span class="hljs-comment">//Â è·å–ç”¨æˆ·ä¿¡æ¯</span>
Â Â <span class="hljs-title function_">getUserInfo</span>(<span class="hljs-params">params</span>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">request</span>({
Â Â Â Â Â Â <span class="hljs-attr">url</span>:Â <span class="hljs-string">'/user/info'</span>,
Â Â Â Â Â Â <span class="hljs-attr">method</span>:Â <span class="hljs-string">'get'</span>,
Â Â Â Â Â Â params
Â Â Â Â })
Â Â },
Â Â 
Â Â <span class="hljs-comment">//Â é€€å‡ºç™»å½•</span>
Â Â <span class="hljs-title function_">logout</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">request</span>({
Â Â Â Â Â Â <span class="hljs-attr">url</span>:Â <span class="hljs-string">'/user/logout'</span>,
Â Â Â Â Â Â <span class="hljs-attr">method</span>:Â <span class="hljs-string">'post'</span>
Â Â Â Â })
Â Â }
}

<span class="hljs-comment">//Â å•†å“ç›¸å…³API</span>
<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">const</span>Â productApiÂ =Â {
Â Â <span class="hljs-comment">//Â è·å–å•†å“åˆ—è¡¨</span>
Â Â <span class="hljs-title function_">getProductList</span>(<span class="hljs-params">params</span>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">request</span>({
Â Â Â Â Â Â <span class="hljs-attr">url</span>:Â <span class="hljs-string">'/product/list'</span>,
Â Â Â Â Â Â <span class="hljs-attr">method</span>:Â <span class="hljs-string">'get'</span>,
Â Â Â Â Â Â params
Â Â Â Â })
Â Â },
Â Â 
Â Â <span class="hljs-comment">//Â è·å–å•†å“è¯¦æƒ…</span>
Â Â <span class="hljs-title function_">getProductDetail</span>(<span class="hljs-params">id</span>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">request</span>({
Â Â Â Â Â Â <span class="hljs-attr">url</span>:Â <span class="hljs-string">`/product/detail/<span class="hljs-subst">${id}</span>`</span>,
Â Â Â Â Â Â <span class="hljs-attr">method</span>:Â <span class="hljs-string">'get'</span>
Â Â Â Â })
Â Â },
Â Â 
Â Â <span class="hljs-comment">//Â åˆ›å»ºå•†å“</span>
Â Â <span class="hljs-title function_">createProduct</span>(<span class="hljs-params">data</span>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">request</span>({
Â Â Â Â Â Â <span class="hljs-attr">url</span>:Â <span class="hljs-string">'/product/create'</span>,
Â Â Â Â Â Â <span class="hljs-attr">method</span>:Â <span class="hljs-string">'post'</span>,
Â Â Â Â Â Â data
Â Â Â Â })
Â Â },
Â Â 
Â Â <span class="hljs-comment">//Â æ›´æ–°å•†å“</span>
Â Â <span class="hljs-title function_">updateProduct</span>(<span class="hljs-params">id,Â data</span>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">request</span>({
Â Â Â Â Â Â <span class="hljs-attr">url</span>:Â <span class="hljs-string">`/product/update/<span class="hljs-subst">${id}</span>`</span>,
Â Â Â Â Â Â <span class="hljs-attr">method</span>:Â <span class="hljs-string">'put'</span>,
Â Â Â Â Â Â data
Â Â Â Â })
Â Â },
Â Â 
Â Â <span class="hljs-comment">//Â åˆ é™¤å•†å“</span>
Â Â <span class="hljs-title function_">deleteProduct</span>(<span class="hljs-params">id</span>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">request</span>({
Â Â Â Â Â Â <span class="hljs-attr">url</span>:Â <span class="hljs-string">`/product/delete/<span class="hljs-subst">${id}</span>`</span>,
Â Â Â Â Â Â <span class="hljs-attr">method</span>:Â <span class="hljs-string">'delete'</span>
Â Â Â Â })
Â Â }
}

<span class="hljs-comment">//Â è®¢å•ç›¸å…³API</span>
<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">const</span>Â orderApiÂ =Â {
Â Â <span class="hljs-comment">//Â è·å–è®¢å•åˆ—è¡¨</span>
Â Â <span class="hljs-title function_">getOrderList</span>(<span class="hljs-params">params</span>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">request</span>({
Â Â Â Â Â Â <span class="hljs-attr">url</span>:Â <span class="hljs-string">'/order/list'</span>,
Â Â Â Â Â Â <span class="hljs-attr">method</span>:Â <span class="hljs-string">'get'</span>,
Â Â Â Â Â Â params
Â Â Â Â })
Â Â },
Â Â 
Â Â <span class="hljs-comment">//Â åˆ›å»ºè®¢å•</span>
Â Â <span class="hljs-title function_">createOrder</span>(<span class="hljs-params">data</span>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">request</span>({
Â Â Â Â Â Â <span class="hljs-attr">url</span>:Â <span class="hljs-string">'/order/create'</span>,
Â Â Â Â Â Â <span class="hljs-attr">method</span>:Â <span class="hljs-string">'post'</span>,
Â Â Â Â Â Â data,
Â Â Â Â Â Â <span class="hljs-attr">showLoading</span>:Â <span class="hljs-literal">true</span>
Â Â Â Â })
Â Â }
}
</code></pre>
<h3 data-id="heading-7">2. åœ¨Vueç»„ä»¶ä¸­ä½¿ç”¨</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span>Â @<span class="hljs-attr">click</span>=<span class="hljs-string">"getUserInfo"</span>&gt;</span>è·å–ç”¨æˆ·ä¿¡æ¯<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span>Â @<span class="hljs-attr">click</span>=<span class="hljs-string">"getProductList"</span>&gt;</span>è·å–å•†å“åˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span>Â {Â userApi,Â productApiÂ }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'@/api'</span>

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â {
Â Â <span class="hljs-attr">methods</span>:Â {
Â Â Â Â <span class="hljs-keyword">async</span>Â <span class="hljs-title function_">getUserInfo</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â userInfoÂ =Â <span class="hljs-keyword">await</span>Â userApi.<span class="hljs-title function_">getUserInfo</span>({Â <span class="hljs-attr">userId</span>:Â <span class="hljs-number">123</span>Â })
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç”¨æˆ·ä¿¡æ¯:'</span>,Â userInfo)
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">$message</span>.<span class="hljs-title function_">success</span>(<span class="hljs-string">'è·å–ç”¨æˆ·ä¿¡æ¯æˆåŠŸ'</span>)
Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (error)Â {
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:'</span>,Â error)
Â Â Â Â Â Â }
Â Â Â Â },
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">async</span>Â <span class="hljs-title function_">getProductList</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â paramsÂ =Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">page</span>:Â <span class="hljs-number">1</span>,
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">pageSize</span>:Â <span class="hljs-number">10</span>,
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">category</span>:Â <span class="hljs-string">'electronics'</span>
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â productListÂ =Â <span class="hljs-keyword">await</span>Â productApi.<span class="hljs-title function_">getProductList</span>(params)
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å•†å“åˆ—è¡¨:'</span>,Â productList)
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">$message</span>.<span class="hljs-title function_">success</span>(<span class="hljs-string">'è·å–å•†å“åˆ—è¡¨æˆåŠŸ'</span>)
Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (error)Â {
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å–å•†å“åˆ—è¡¨å¤±è´¥:'</span>,Â error)
Â Â Â Â Â Â }
Â Â Â Â }
Â Â }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h2 data-id="heading-8">ç¬¬ä¸‰æ­¥ï¼šè¿›é˜¶åŠŸèƒ½ - æ·»åŠ æ›´å¤šç‰¹æ€§</h2>
<h3 data-id="heading-9">1. è¯·æ±‚é‡è¯•æœºåˆ¶</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//Â åœ¨request.jsä¸­æ·»åŠ é‡è¯•æœºåˆ¶</span>
<span class="hljs-keyword">const</span>Â <span class="hljs-variable constant_">RETRY_COUNT</span>Â =Â <span class="hljs-number">3</span>Â <span class="hljs-comment">//Â é‡è¯•æ¬¡æ•°</span>
<span class="hljs-keyword">const</span>Â <span class="hljs-variable constant_">RETRY_DELAY</span>Â =Â <span class="hljs-number">1000</span>Â <span class="hljs-comment">//Â é‡è¯•å»¶è¿Ÿ</span>

<span class="hljs-comment">//Â é‡è¯•è¯·æ±‚å‡½æ•°</span>
<span class="hljs-keyword">async</span>Â <span class="hljs-keyword">function</span>Â <span class="hljs-title function_">retryRequest</span>(<span class="hljs-params">config,Â retryCountÂ =Â <span class="hljs-number">0</span></span>)Â {
Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-keyword">await</span>Â <span class="hljs-title function_">service</span>(config)
Â Â }Â <span class="hljs-keyword">catch</span>Â (error)Â {
Â Â Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-title function_">shouldRetry</span>(error)Â &amp;&amp;Â retryCountÂ &lt;Â <span class="hljs-variable constant_">RETRY_COUNT</span>)Â {
Â Â Â Â Â Â <span class="hljs-comment">//Â å»¶è¿Ÿåé‡è¯•</span>
Â Â Â Â Â Â <span class="hljs-keyword">await</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span>Â =&gt;</span>Â <span class="hljs-built_in">setTimeout</span>(resolve,Â <span class="hljs-variable constant_">RETRY_DELAY</span>))
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">retryRequest</span>(config,Â retryCountÂ +Â <span class="hljs-number">1</span>)
Â Â Â Â }
Â Â Â Â <span class="hljs-keyword">throw</span>Â error
Â Â }
}

<span class="hljs-comment">//Â åˆ¤æ–­æ˜¯å¦éœ€è¦é‡è¯•</span>
<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">shouldRetry</span>(<span class="hljs-params">error</span>)Â {
Â Â <span class="hljs-comment">//Â åªåœ¨ç½‘ç»œé”™è¯¯æˆ–ç‰¹å®šçŠ¶æ€ç æ—¶é‡è¯•</span>
Â Â <span class="hljs-keyword">return</span>Â !error.<span class="hljs-property">response</span>Â ||Â 
Â Â Â Â Â Â Â Â Â error.<span class="hljs-property">code</span>Â ===Â <span class="hljs-string">'ECONNABORTED'</span>Â ||Â 
Â Â Â Â Â Â Â Â Â error.<span class="hljs-property">response</span>.<span class="hljs-property">status</span>Â &gt;=Â <span class="hljs-number">500</span>
}

<span class="hljs-comment">//Â ä¿®æ”¹åŸå§‹çš„requestå‡½æ•°</span>
<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â <span class="hljs-keyword">function</span>Â <span class="hljs-title function_">request</span>(<span class="hljs-params">config</span>)Â {
Â Â <span class="hljs-keyword">if</span>Â (config.<span class="hljs-property">retry</span>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">retryRequest</span>(config)
Â Â }
Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">service</span>(config)
}
</code></pre>
<h3 data-id="heading-10">2. è¯·æ±‚ç¼“å­˜</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">//Â è¯·æ±‚ç¼“å­˜å·¥å…·</span>
<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">RequestCache</span>Â {
Â Â <span class="hljs-keyword">constructor</span>()Â {
Â Â Â Â <span class="hljs-keyword">this</span>.cacheÂ =Â newÂ Map()
Â Â Â Â <span class="hljs-keyword">this</span>.maxSizeÂ =Â <span class="hljs-number">100</span>Â <span class="hljs-comment">//Â æœ€å¤§ç¼“å­˜æ•°é‡</span>
Â Â }
Â Â 
Â Â <span class="hljs-comment">//Â ç”Ÿæˆç¼“å­˜key</span>
Â Â generateKey(config)Â {
Â Â Â Â <span class="hljs-keyword">const</span>Â {Â method,Â url,Â params,Â <span class="hljs-keyword">data</span>Â }Â =Â config
Â Â Â Â <span class="hljs-keyword">return</span>Â JSON.stringify({Â method,Â url,Â params,Â <span class="hljs-keyword">data</span>Â })
Â Â }
Â Â 
Â Â <span class="hljs-comment">//Â è·å–ç¼“å­˜</span>
Â Â <span class="hljs-keyword">get</span>(config)Â {
Â Â Â Â <span class="hljs-keyword">const</span>Â keyÂ =Â <span class="hljs-keyword">this</span>.generateKey(config)
Â Â Â Â <span class="hljs-keyword">const</span>Â cachedÂ =Â <span class="hljs-keyword">this</span>.cache.<span class="hljs-keyword">get</span>(key)
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">if</span>Â (!cached)Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">null</span>
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â æ£€æŸ¥ç¼“å­˜æ˜¯å¦è¿‡æœŸ</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (Date.now()Â &gt;Â cached.expire)Â {
Â Â Â Â Â Â <span class="hljs-keyword">this</span>.cache.delete(key)
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">null</span>
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">return</span>Â cached.<span class="hljs-keyword">data</span>
Â Â }
Â Â 
Â Â <span class="hljs-comment">//Â è®¾ç½®ç¼“å­˜</span>
Â Â <span class="hljs-keyword">set</span>(config,Â <span class="hljs-keyword">data</span>,Â cacheTimeÂ =Â <span class="hljs-number">5</span>Â *Â <span class="hljs-number">60</span>Â *Â <span class="hljs-number">1000</span>)Â {Â <span class="hljs-comment">//Â é»˜è®¤5åˆ†é’Ÿ</span>
Â Â Â Â <span class="hljs-keyword">const</span>Â keyÂ =Â <span class="hljs-keyword">this</span>.generateKey(config)
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â æ¸…ç†æœ€æ—§çš„ç¼“å­˜å¦‚æœè¾¾åˆ°æœ€å¤§é™åˆ¶</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-keyword">this</span>.cache.sizeÂ &gt;=Â <span class="hljs-keyword">this</span>.maxSize)Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â firstKeyÂ =Â <span class="hljs-keyword">this</span>.cache.keys().next().value
Â Â Â Â Â Â <span class="hljs-keyword">this</span>.cache.delete(firstKey)
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">this</span>.cache.<span class="hljs-keyword">set</span>(key,Â {
Â Â Â Â Â Â <span class="hljs-keyword">data</span>,
Â Â Â Â Â Â expire:Â Date.now()Â +Â cacheTime
Â Â Â Â })
Â Â }
Â Â 
Â Â <span class="hljs-comment">//Â æ¸…é™¤ç¼“å­˜</span>
Â Â clear()Â {
Â Â Â Â <span class="hljs-keyword">this</span>.cache.clear()
Â Â }
Â Â 
Â Â <span class="hljs-comment">//Â åˆ é™¤ç‰¹å®šç¼“å­˜</span>
Â Â delete(config)Â {
Â Â Â Â <span class="hljs-keyword">const</span>Â keyÂ =Â <span class="hljs-keyword">this</span>.generateKey(config)
Â Â Â Â <span class="hljs-keyword">this</span>.cache.delete(key)
Â Â }
}

<span class="hljs-keyword">const</span>Â requestCacheÂ =Â newÂ RequestCache()

<span class="hljs-comment">//Â åœ¨requestå‡½æ•°ä¸­æ·»åŠ ç¼“å­˜é€»è¾‘</span>
exportÂ defaultÂ functionÂ request(config)Â {
Â Â <span class="hljs-keyword">const</span>Â {
Â Â Â Â useCacheÂ =Â <span class="hljs-literal">false</span>,
Â Â Â Â cacheTimeÂ =Â <span class="hljs-number">5</span>Â *Â <span class="hljs-number">60</span>Â *Â <span class="hljs-number">1000</span>,
Â Â Â Â ...requestConfig
Â Â }Â =Â config
Â Â 
Â Â <span class="hljs-comment">//Â å¦‚æœå¯ç”¨ç¼“å­˜ä¸”æ˜¯GETè¯·æ±‚ï¼Œå…ˆæ£€æŸ¥ç¼“å­˜</span>
Â Â <span class="hljs-keyword">if</span>Â (useCacheÂ &amp;&amp;Â requestConfig.method?.toLowerCase()Â ===Â <span class="hljs-string">'get'</span>)Â {
Â Â Â Â <span class="hljs-keyword">const</span>Â cachedDataÂ =Â requestCache.<span class="hljs-keyword">get</span>(requestConfig)
Â Â Â Â <span class="hljs-keyword">if</span>Â (cachedData)Â {
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Promise.resolve(cachedData)
Â Â Â Â }
Â Â }
Â Â 
Â Â <span class="hljs-keyword">return</span>Â service(requestConfig).then(responseÂ =&gt;Â {
Â Â Â Â <span class="hljs-comment">//Â ç¼“å­˜å“åº”æ•°æ®</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (useCacheÂ &amp;&amp;Â requestConfig.method?.toLowerCase()Â ===Â <span class="hljs-string">'get'</span>)Â {
Â Â Â Â Â Â requestCache.<span class="hljs-keyword">set</span>(requestConfig,Â response,Â cacheTime)
Â Â Â Â }
Â Â Â Â <span class="hljs-keyword">return</span>Â response
Â Â })
}
</code></pre>
<h3 data-id="heading-11">3. å¹¶å‘è¯·æ±‚æ§åˆ¶</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">//Â å¹¶å‘è¯·æ±‚æ§åˆ¶å™¨</span>
<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">RequestController</span>Â {
Â Â <span class="hljs-keyword">constructor</span>(maxConcurrentÂ =Â <span class="hljs-number">5</span>)Â {
Â Â Â Â <span class="hljs-keyword">this</span>.maxConcurrentÂ =Â maxConcurrent
Â Â Â Â <span class="hljs-keyword">this</span>.queueÂ =Â []
Â Â Â Â <span class="hljs-keyword">this</span>.activeCountÂ =Â <span class="hljs-number">0</span>
Â Â }
Â Â 
Â Â <span class="hljs-comment">//Â æ·»åŠ è¯·æ±‚åˆ°é˜Ÿåˆ—</span>
Â Â asyncÂ add(requestFn)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â newÂ Promise((resolve,Â reject)Â =&gt;Â {
Â Â Â Â Â Â <span class="hljs-keyword">this</span>.queue.push({Â requestFn,Â resolve,Â rejectÂ })
Â Â Â Â Â Â <span class="hljs-keyword">this</span>.next()
Â Â Â Â })
Â Â }
Â Â 
Â Â <span class="hljs-comment">//Â æ‰§è¡Œä¸‹ä¸€ä¸ªè¯·æ±‚</span>
Â Â next()Â {
Â Â Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-keyword">this</span>.activeCountÂ &gt;=Â <span class="hljs-keyword">this</span>.maxConcurrentÂ ||Â <span class="hljs-keyword">this</span>.queue.lengthÂ ===Â <span class="hljs-number">0</span>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">return</span>
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">this</span>.activeCount++
Â Â Â Â <span class="hljs-keyword">const</span>Â {Â requestFn,Â resolve,Â rejectÂ }Â =Â <span class="hljs-keyword">this</span>.queue.shift()
Â Â Â Â 
Â Â Â Â Promise.resolve(requestFn())
Â Â Â Â Â Â .then(resolve)
Â Â Â Â Â Â .<span class="hljs-keyword">catch</span>(reject)
Â Â Â Â Â Â .<span class="hljs-keyword">finally</span>(()Â =&gt;Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">this</span>.activeCount--
Â Â Â Â Â Â Â Â <span class="hljs-keyword">this</span>.next()
Â Â Â Â Â Â })
Â Â }
Â Â 
Â Â <span class="hljs-comment">//Â æ¸…ç©ºé˜Ÿåˆ—</span>
Â Â clear()Â {
Â Â Â Â <span class="hljs-keyword">this</span>.queueÂ =Â []
Â Â }
}

<span class="hljs-comment">//Â åˆ›å»ºå…¨å±€è¯·æ±‚æ§åˆ¶å™¨</span>
<span class="hljs-keyword">const</span>Â requestControllerÂ =Â newÂ RequestController(<span class="hljs-number">5</span>)

<span class="hljs-comment">//Â æ”¯æŒå¹¶å‘æ§åˆ¶çš„requestå‡½æ•°</span>
exportÂ functionÂ controlledRequest(config)Â {
Â Â <span class="hljs-keyword">return</span>Â requestController.add(()Â =&gt;Â request(config))
}
</code></pre>
<h2 data-id="heading-12">ç¬¬å››æ­¥ï¼šå®Œæ•´å°è£…ç¤ºä¾‹</h2>
<p>ä¸‹é¢æ˜¯å®Œæ•´çš„ã€ç”Ÿäº§ç¯å¢ƒå¯ç”¨çš„Axioså°è£…ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//Â src/utils/request.js</span>
<span class="hljs-keyword">import</span>Â axiosÂ <span class="hljs-keyword">from</span>Â <span class="hljs-string">'axios'</span>
<span class="hljs-keyword">import</span>Â routerÂ <span class="hljs-keyword">from</span>Â <span class="hljs-string">'@/router'</span>
<span class="hljs-keyword">import</span>Â {Â <span class="hljs-title class_">Message</span>,Â <span class="hljs-title class_">Loading</span>Â }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'element-ui'</span>

<span class="hljs-comment">//Â é…ç½®</span>
<span class="hljs-keyword">const</span>Â configÂ =Â {
Â Â <span class="hljs-attr">baseURL</span>:Â process.<span class="hljs-property">env</span>.<span class="hljs-property">VUE_APP_BASE_API</span>,
Â Â <span class="hljs-attr">timeout</span>:Â <span class="hljs-number">10000</span>,
Â Â <span class="hljs-attr">withCredentials</span>:Â <span class="hljs-literal">true</span>,Â <span class="hljs-comment">//Â è·¨åŸŸè¯·æ±‚æ—¶æ˜¯å¦éœ€è¦ä½¿ç”¨å‡­è¯</span>
Â Â <span class="hljs-attr">headers</span>:Â {
Â Â Â Â <span class="hljs-string">'Content-Type'</span>:Â <span class="hljs-string">'application/json;charset=utf-8'</span>
Â Â }
}

<span class="hljs-comment">//Â åˆ›å»ºaxioså®ä¾‹</span>
<span class="hljs-keyword">const</span>Â serviceÂ =Â axios.<span class="hljs-title function_">create</span>(config)

<span class="hljs-comment">//Â è¯·æ±‚ç¼“å­˜</span>
<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">RequestCache</span>Â {
Â Â <span class="hljs-title function_">constructor</span>(<span class="hljs-params">maxSizeÂ =Â <span class="hljs-number">100</span></span>)Â {
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>Â =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Map</span>()
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxSize</span>Â =Â maxSize
Â Â }
Â Â 
Â Â <span class="hljs-title function_">generateKey</span>(<span class="hljs-params">config</span>)Â {
Â Â Â Â <span class="hljs-keyword">const</span>Â {Â method,Â url,Â params,Â dataÂ }Â =Â config
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">`<span class="hljs-subst">${method}</span>:<span class="hljs-subst">${url}</span>:<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(params)}</span>:<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(data)}</span>`</span>
Â Â }
Â Â 
Â Â <span class="hljs-title function_">get</span>(<span class="hljs-params">config</span>)Â {
Â Â Â Â <span class="hljs-keyword">const</span>Â keyÂ =Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateKey</span>(config)
Â Â Â Â <span class="hljs-keyword">const</span>Â cachedÂ =Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">get</span>(key)
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">if</span>Â (!cachedÂ ||Â <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()Â &gt;Â cached.<span class="hljs-property">expire</span>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (cached)Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">delete</span>(key)
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">null</span>
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">return</span>Â cached.<span class="hljs-property">data</span>
Â Â }
Â Â 
Â Â <span class="hljs-title function_">set</span>(<span class="hljs-params">config,Â data,Â cacheTimeÂ =Â <span class="hljs-number">300000</span></span>)Â {
Â Â Â Â <span class="hljs-keyword">const</span>Â keyÂ =Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateKey</span>(config)
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">size</span>Â &gt;=Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxSize</span>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â firstKeyÂ =Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">keys</span>().<span class="hljs-title function_">next</span>().<span class="hljs-property">value</span>
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">delete</span>(firstKey)
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">set</span>(key,Â {
Â Â Â Â Â Â data,
Â Â Â Â Â Â <span class="hljs-attr">expire</span>:Â <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()Â +Â cacheTime
Â Â Â Â })
Â Â }
Â Â 
Â Â <span class="hljs-title function_">delete</span>(<span class="hljs-params">config</span>)Â {
Â Â Â Â <span class="hljs-keyword">const</span>Â keyÂ =Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateKey</span>(config)
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">delete</span>(key)
Â Â }
Â Â 
Â Â <span class="hljs-title function_">clear</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">clear</span>()
Â Â }
}

<span class="hljs-keyword">const</span>Â requestCacheÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">RequestCache</span>()

<span class="hljs-comment">//Â loadingæ§åˆ¶</span>
<span class="hljs-keyword">let</span>Â loadingCountÂ =Â <span class="hljs-number">0</span>
<span class="hljs-keyword">let</span>Â loadingInstanceÂ =Â <span class="hljs-literal">null</span>

<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">showLoading</span>(<span class="hljs-params"/>)Â {
Â Â <span class="hljs-keyword">if</span>Â (loadingCountÂ ===Â <span class="hljs-number">0</span>)Â {
Â Â Â Â loadingInstanceÂ =Â <span class="hljs-title class_">Loading</span>.<span class="hljs-title function_">service</span>({
Â Â Â Â Â Â <span class="hljs-attr">lock</span>:Â <span class="hljs-literal">true</span>,
Â Â Â Â Â Â <span class="hljs-attr">text</span>:Â <span class="hljs-string">'åŠ è½½ä¸­...'</span>,
Â Â Â Â Â Â <span class="hljs-attr">background</span>:Â <span class="hljs-string">'rgba(0,Â 0,Â 0,Â 0.7)'</span>
Â Â Â Â })
Â Â }
Â Â loadingCount++
}

<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">hideLoading</span>(<span class="hljs-params"/>)Â {
Â Â loadingCount--
Â Â <span class="hljs-keyword">if</span>Â (loadingCountÂ &lt;=Â <span class="hljs-number">0</span>Â &amp;&amp;Â loadingInstance)Â {
Â Â Â Â loadingInstance.<span class="hljs-title function_">close</span>()
Â Â Â Â loadingInstanceÂ =Â <span class="hljs-literal">null</span>
Â Â Â Â loadingCountÂ =Â <span class="hljs-number">0</span>
Â Â }
}

<span class="hljs-comment">//Â é”™è¯¯å¤„ç†</span>
<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">handleError</span>(<span class="hljs-params">error</span>)Â {
Â Â <span class="hljs-comment">//Â è¯·æ±‚è¢«å–æ¶ˆçš„é”™è¯¯ä¸æç¤º</span>
Â Â <span class="hljs-keyword">if</span>Â (axios.<span class="hljs-title function_">isCancel</span>(error))Â {
Â Â Â Â <span class="hljs-keyword">return</span>
Â Â }
Â Â 
Â Â <span class="hljs-keyword">let</span>Â messageÂ =Â <span class="hljs-string">'è¯·æ±‚å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•'</span>
Â Â 
Â Â <span class="hljs-keyword">if</span>Â (error.<span class="hljs-property">response</span>)Â {
Â Â Â Â <span class="hljs-keyword">switch</span>Â (error.<span class="hljs-property">response</span>.<span class="hljs-property">status</span>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">400</span>:
Â Â Â Â Â Â Â Â messageÂ =Â error.<span class="hljs-property">response</span>.<span class="hljs-property">data</span>?.<span class="hljs-property">message</span>Â ||Â <span class="hljs-string">'è¯·æ±‚å‚æ•°é”™è¯¯'</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">401</span>:
Â Â Â Â Â Â Â Â messageÂ =Â <span class="hljs-string">'æœªæˆæƒï¼Œè¯·é‡æ–°ç™»å½•'</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ¸…é™¤token</span>
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-string">'token'</span>)
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è·³è½¬åˆ°ç™»å½•é¡µ</span>
Â Â Â Â Â Â Â Â <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()Â =&gt;</span>Â {
Â Â Â Â Â Â Â Â Â Â router.<span class="hljs-title function_">replace</span>({
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">path</span>:Â <span class="hljs-string">'/login'</span>,
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">query</span>:Â {Â <span class="hljs-attr">redirect</span>:Â router.<span class="hljs-property">currentRoute</span>.<span class="hljs-property">fullPath</span>Â }
Â Â Â Â Â Â Â Â Â Â })
Â Â Â Â Â Â Â Â },Â <span class="hljs-number">1000</span>)
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">403</span>:
Â Â Â Â Â Â Â Â messageÂ =Â <span class="hljs-string">'æ‹’ç»è®¿é—®'</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">404</span>:
Â Â Â Â Â Â Â Â messageÂ =Â <span class="hljs-string">'è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨'</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">408</span>:
Â Â Â Â Â Â Â Â messageÂ =Â <span class="hljs-string">'è¯·æ±‚è¶…æ—¶'</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">500</span>:
Â Â Â Â Â Â Â Â messageÂ =Â <span class="hljs-string">'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯'</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">501</span>:
Â Â Â Â Â Â Â Â messageÂ =Â <span class="hljs-string">'æœåŠ¡æœªå®ç°'</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">502</span>:
Â Â Â Â Â Â Â Â messageÂ =Â <span class="hljs-string">'ç½‘å…³é”™è¯¯'</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">503</span>:
Â Â Â Â Â Â Â Â messageÂ =Â <span class="hljs-string">'æœåŠ¡ä¸å¯ç”¨'</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">504</span>:
Â Â Â Â Â Â Â Â messageÂ =Â <span class="hljs-string">'ç½‘å…³è¶…æ—¶'</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-keyword">case</span>Â <span class="hljs-number">505</span>:
Â Â Â Â Â Â Â Â messageÂ =Â <span class="hljs-string">'HTTPç‰ˆæœ¬ä¸å—æ”¯æŒ'</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>
Â Â Â Â Â Â <span class="hljs-attr">default</span>:
Â Â Â Â Â Â Â Â messageÂ =Â <span class="hljs-string">`è¿æ¥é”™è¯¯Â <span class="hljs-subst">${error.response.status}</span>`</span>
Â Â Â Â }
Â Â }Â <span class="hljs-keyword">else</span>Â <span class="hljs-keyword">if</span>Â (error.<span class="hljs-property">request</span>)Â {
Â Â Â Â messageÂ =Â <span class="hljs-string">'ç½‘ç»œè¿æ¥å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®'</span>
Â Â }Â <span class="hljs-keyword">else</span>Â {
Â Â Â Â messageÂ =Â error.<span class="hljs-property">message</span>Â ||Â <span class="hljs-string">'è¯·æ±‚å¤±è´¥'</span>
Â Â }
Â Â 
Â Â <span class="hljs-title class_">Message</span>.<span class="hljs-title function_">error</span>(message)
Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è¯·æ±‚é”™è¯¯:'</span>,Â error)
Â Â 
Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error)
}

<span class="hljs-comment">//Â è¯·æ±‚æ‹¦æˆªå™¨</span>
service.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(
Â Â <span class="hljs-function"><span class="hljs-params">config</span>Â =&gt;</span>Â {
Â Â Â Â <span class="hljs-comment">//Â æ·»åŠ token</span>
Â Â Â Â <span class="hljs-keyword">const</span>Â tokenÂ =Â <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'token'</span>)Â ||Â sessionStorage.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'token'</span>)
Â Â Â Â <span class="hljs-keyword">if</span>Â (token)Â {
Â Â Â Â Â Â config.<span class="hljs-property">headers</span>.<span class="hljs-property">Authorization</span>Â =Â <span class="hljs-string">`BearerÂ <span class="hljs-subst">${token}</span>`</span>
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â æ˜¾ç¤ºloading</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (config.<span class="hljs-property">showLoading</span>)Â {
Â Â Â Â Â Â <span class="hljs-title function_">showLoading</span>()
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â å–æ¶ˆè¯·æ±‚é…ç½®</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (config.<span class="hljs-property">cancelToken</span>)Â {
Â Â Â Â Â Â config.<span class="hljs-property">cancelToken</span>Â =Â <span class="hljs-keyword">new</span>Â axios.<span class="hljs-title class_">CancelToken</span>(<span class="hljs-function"><span class="hljs-params">c</span>Â =&gt;</span>Â {
Â Â Â Â Â Â Â Â config.<span class="hljs-property">cancel</span>Â =Â c
Â Â Â Â Â Â })
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">return</span>Â config
Â Â },
Â Â <span class="hljs-function"><span class="hljs-params">error</span>Â =&gt;</span>Â {
Â Â Â Â <span class="hljs-comment">//Â å¯¹è¯·æ±‚é”™è¯¯åšäº›ä»€ä¹ˆ</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (error.<span class="hljs-property">config</span>?.<span class="hljs-property">showLoading</span>)Â {
Â Â Â Â Â Â <span class="hljs-title function_">hideLoading</span>()
Â Â Â Â }
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error)
Â Â }
)

<span class="hljs-comment">//Â å“åº”æ‹¦æˆªå™¨</span>
service.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(
Â Â <span class="hljs-function"><span class="hljs-params">response</span>Â =&gt;</span>Â {
Â Â Â Â <span class="hljs-comment">//Â éšè—loading</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (response.<span class="hljs-property">config</span>.<span class="hljs-property">showLoading</span>)Â {
Â Â Â Â Â Â <span class="hljs-title function_">hideLoading</span>()
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">const</span>Â resÂ =Â response.<span class="hljs-property">data</span>
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â è‡ªå®šä¹‰çŠ¶æ€ç å¤„ç†</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (res.<span class="hljs-property">code</span>Â ===Â <span class="hljs-literal">undefined</span>)Â {
Â Â Â Â Â Â <span class="hljs-comment">//Â å¦‚æœæ²¡æœ‰codeå­—æ®µï¼Œç›´æ¥è¿”å›æ•°æ®</span>
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â res
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â æ ¹æ®åç«¯è¿”å›çš„codeè¿›è¡Œåˆ¤æ–­</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (res.<span class="hljs-property">code</span>Â ===Â <span class="hljs-number">200</span>Â ||Â res.<span class="hljs-property">code</span>Â ===Â <span class="hljs-number">0</span>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â res.<span class="hljs-property">data</span>Â !==Â <span class="hljs-literal">undefined</span>Â ?Â res.<span class="hljs-property">data</span>Â :Â res
Â Â Â Â }Â <span class="hljs-keyword">else</span>Â {
Â Â Â Â Â Â <span class="hljs-comment">//Â å¤„ç†ä¸šåŠ¡é”™è¯¯</span>
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â errorMsgÂ =Â res.<span class="hljs-property">message</span>Â ||Â <span class="hljs-string">'è¯·æ±‚å¤±è´¥'</span>
Â Â Â Â Â Â <span class="hljs-title class_">Message</span>.<span class="hljs-title function_">error</span>(errorMsg)
Â Â Â Â Â Â 
Â Â Â Â Â Â <span class="hljs-comment">//Â ç‰¹æ®ŠçŠ¶æ€ç å¤„ç†</span>
Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (res.<span class="hljs-property">code</span>Â ===Â <span class="hljs-number">401</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â tokenè¿‡æœŸï¼Œè·³è½¬åˆ°ç™»å½•é¡µ</span>
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-string">'token'</span>)
Â Â Â Â Â Â Â Â router.<span class="hljs-title function_">replace</span>(<span class="hljs-string">'/login'</span>)
Â Â Â Â Â Â }
Â Â Â Â Â Â 
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Error</span>(errorMsg))
Â Â Â Â }
Â Â },
Â Â <span class="hljs-function"><span class="hljs-params">error</span>Â =&gt;</span>Â {
Â Â Â Â <span class="hljs-comment">//Â éšè—loading</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (error.<span class="hljs-property">config</span>?.<span class="hljs-property">showLoading</span>)Â {
Â Â Â Â Â Â <span class="hljs-title function_">hideLoading</span>()
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â å¤„ç†é”™è¯¯</span>
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">handleError</span>(error)
Â Â }
)

<span class="hljs-comment">//Â å°è£…è¯·æ±‚æ–¹æ³•</span>
<span class="hljs-keyword">const</span>Â requestÂ =Â {
Â Â <span class="hljs-comment">/**
Â Â Â *Â GETè¯·æ±‚
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">string</span>}Â urlÂ è¯·æ±‚åœ°å€
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">object</span>}Â paramsÂ è¯·æ±‚å‚æ•°
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">object</span>}Â optionsÂ é…ç½®é€‰é¡¹
Â Â Â */</span>
Â Â <span class="hljs-title function_">get</span>(<span class="hljs-params">url,Â paramsÂ =Â {},Â optionsÂ =Â {}</span>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">request</span>({
Â Â Â Â Â Â url,
Â Â Â Â Â Â <span class="hljs-attr">method</span>:Â <span class="hljs-string">'GET'</span>,
Â Â Â Â Â Â params,
Â Â Â Â Â Â ...options
Â Â Â Â })
Â Â },
Â Â 
Â Â <span class="hljs-comment">/**
Â Â Â *Â POSTè¯·æ±‚
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">string</span>}Â urlÂ è¯·æ±‚åœ°å€
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">object</span>}Â dataÂ è¯·æ±‚æ•°æ®
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">object</span>}Â optionsÂ é…ç½®é€‰é¡¹
Â Â Â */</span>
Â Â <span class="hljs-title function_">post</span>(<span class="hljs-params">url,Â dataÂ =Â {},Â optionsÂ =Â {}</span>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">request</span>({
Â Â Â Â Â Â url,
Â Â Â Â Â Â <span class="hljs-attr">method</span>:Â <span class="hljs-string">'POST'</span>,
Â Â Â Â Â Â data,
Â Â Â Â Â Â ...options
Â Â Â Â })
Â Â },
Â Â 
Â Â <span class="hljs-comment">/**
Â Â Â *Â PUTè¯·æ±‚
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">string</span>}Â urlÂ è¯·æ±‚åœ°å€
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">object</span>}Â dataÂ è¯·æ±‚æ•°æ®
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">object</span>}Â optionsÂ é…ç½®é€‰é¡¹
Â Â Â */</span>
Â Â <span class="hljs-title function_">put</span>(<span class="hljs-params">url,Â dataÂ =Â {},Â optionsÂ =Â {}</span>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">request</span>({
Â Â Â Â Â Â url,
Â Â Â Â Â Â <span class="hljs-attr">method</span>:Â <span class="hljs-string">'PUT'</span>,
Â Â Â Â Â Â data,
Â Â Â Â Â Â ...options
Â Â Â Â })
Â Â },
Â Â 
Â Â <span class="hljs-comment">/**
Â Â Â *Â DELETEè¯·æ±‚
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">string</span>}Â urlÂ è¯·æ±‚åœ°å€
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">object</span>}Â paramsÂ è¯·æ±‚å‚æ•°
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">object</span>}Â optionsÂ é…ç½®é€‰é¡¹
Â Â Â */</span>
Â Â <span class="hljs-title function_">delete</span>(<span class="hljs-params">url,Â paramsÂ =Â {},Â optionsÂ =Â {}</span>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">request</span>({
Â Â Â Â Â Â url,
Â Â Â Â Â Â <span class="hljs-attr">method</span>:Â <span class="hljs-string">'DELETE'</span>,
Â Â Â Â Â Â params,
Â Â Â Â Â Â ...options
Â Â Â Â })
Â Â },
Â Â 
Â Â <span class="hljs-comment">/**
Â Â Â *Â é€šç”¨è¯·æ±‚æ–¹æ³•
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">object</span>}Â configÂ è¯·æ±‚é…ç½®
Â Â Â */</span>
Â Â <span class="hljs-title function_">request</span>(<span class="hljs-params">config</span>)Â {
Â Â Â Â <span class="hljs-keyword">const</span>Â {
Â Â Â Â Â Â useCacheÂ =Â <span class="hljs-literal">false</span>,
Â Â Â Â Â Â cacheTimeÂ =Â <span class="hljs-number">300000</span>,
Â Â Â Â Â Â showLoadingÂ =Â <span class="hljs-literal">false</span>,
Â Â Â Â Â Â ...requestConfig
Â Â Â Â }Â =Â config
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â ç¼“å­˜å¤„ç†</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (useCacheÂ &amp;&amp;Â requestConfig.<span class="hljs-property">method</span>?.<span class="hljs-title function_">toUpperCase</span>()Â ===Â <span class="hljs-string">'GET'</span>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â cachedDataÂ =Â requestCache.<span class="hljs-title function_">get</span>(requestConfig)
Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (cachedData)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(cachedData)
Â Â Â Â Â Â }
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â å‘é€è¯·æ±‚</span>
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">service</span>(requestConfig).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span>Â =&gt;</span>Â {
Â Â Â Â Â Â <span class="hljs-comment">//Â ç¼“å­˜å“åº”</span>
Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (useCacheÂ &amp;&amp;Â requestConfig.<span class="hljs-property">method</span>?.<span class="hljs-title function_">toUpperCase</span>()Â ===Â <span class="hljs-string">'GET'</span>)Â {
Â Â Â Â Â Â Â Â requestCache.<span class="hljs-title function_">set</span>(requestConfig,Â response,Â cacheTime)
Â Â Â Â Â Â }
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â response
Â Â Â Â })
Â Â },
Â Â 
Â Â <span class="hljs-comment">/**
Â Â Â *Â ä¸Šä¼ æ–‡ä»¶
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">string</span>}Â urlÂ ä¸Šä¼ åœ°å€
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">FormData</span>}Â formDataÂ è¡¨å•æ•°æ®
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">object</span>}Â optionsÂ é…ç½®é€‰é¡¹
Â Â Â */</span>
Â Â <span class="hljs-title function_">upload</span>(<span class="hljs-params">url,Â formData,Â optionsÂ =Â {}</span>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">request</span>({
Â Â Â Â Â Â url,
Â Â Â Â Â Â <span class="hljs-attr">method</span>:Â <span class="hljs-string">'POST'</span>,
Â Â Â Â Â Â <span class="hljs-attr">data</span>:Â formData,
Â Â Â Â Â Â <span class="hljs-attr">headers</span>:Â {
Â Â Â Â Â Â Â Â <span class="hljs-string">'Content-Type'</span>:Â <span class="hljs-string">'multipart/form-data'</span>
Â Â Â Â Â Â },
Â Â Â Â Â Â ...options
Â Â Â Â })
Â Â },
Â Â 
Â Â <span class="hljs-comment">/**
Â Â Â *Â ä¸‹è½½æ–‡ä»¶
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">string</span>}Â urlÂ ä¸‹è½½åœ°å€
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">object</span>}Â paramsÂ è¯·æ±‚å‚æ•°
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">string</span>}Â filenameÂ æ–‡ä»¶å
Â Â Â */</span>
Â Â <span class="hljs-title function_">download</span>(<span class="hljs-params">url,Â paramsÂ =Â {},Â filenameÂ =Â <span class="hljs-string">'download'</span></span>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">request</span>({
Â Â Â Â Â Â url,
Â Â Â Â Â Â <span class="hljs-attr">method</span>:Â <span class="hljs-string">'GET'</span>,
Â Â Â Â Â Â params,
Â Â Â Â Â Â <span class="hljs-attr">responseType</span>:Â <span class="hljs-string">'blob'</span>
Â Â Â Â }).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span>Â =&gt;</span>Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â blobÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Blob</span>([response])
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â downloadUrlÂ =Â <span class="hljs-variable language_">window</span>.<span class="hljs-property">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob)
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â linkÂ =Â <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'a'</span>)
Â Â Â Â Â Â link.<span class="hljs-property">href</span>Â =Â downloadUrl
Â Â Â Â Â Â link.<span class="hljs-property">download</span>Â =Â filename
Â Â Â Â Â Â <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(link)
Â Â Â Â Â Â link.<span class="hljs-title function_">click</span>()
Â Â Â Â Â Â <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">removeChild</span>(link)
Â Â Â Â Â Â <span class="hljs-variable language_">window</span>.<span class="hljs-property">URL</span>.<span class="hljs-title function_">revokeObjectURL</span>(downloadUrl)
Â Â Â Â })
Â Â },
Â Â 
Â Â <span class="hljs-comment">/**
Â Â Â *Â æ¸…é™¤ç¼“å­˜
Â Â Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">object</span>}Â configÂ å¯é€‰ï¼Œæ¸…é™¤ç‰¹å®šç¼“å­˜
Â Â Â */</span>
Â Â <span class="hljs-title function_">clearCache</span>(<span class="hljs-params">configÂ =Â <span class="hljs-literal">null</span></span>)Â {
Â Â Â Â <span class="hljs-keyword">if</span>Â (config)Â {
Â Â Â Â Â Â requestCache.<span class="hljs-title function_">delete</span>(config)
Â Â Â Â }Â <span class="hljs-keyword">else</span>Â {
Â Â Â Â Â Â requestCache.<span class="hljs-title function_">clear</span>()
Â Â Â Â }
Â Â },
Â Â 
Â Â <span class="hljs-comment">/**
Â Â Â *Â åˆ›å»ºå–æ¶ˆä»¤ç‰Œ
Â Â Â */</span>
Â Â <span class="hljs-title function_">createCancelToken</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-keyword">new</span>Â axios.<span class="hljs-title class_">CancelToken</span>(<span class="hljs-function"><span class="hljs-params">c</span>Â =&gt;</span>Â {
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancel</span>Â =Â c
Â Â Â Â })
Â Â },
Â Â 
Â Â <span class="hljs-comment">/**
Â Â Â *Â å–æ¶ˆè¯·æ±‚
Â Â Â */</span>
Â Â <span class="hljs-title function_">cancelRequest</span>(<span class="hljs-params">messageÂ =Â <span class="hljs-string">'è¯·æ±‚å·²å–æ¶ˆ'</span></span>)Â {
Â Â Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-variable language_">this</span>.<span class="hljs-property">cancel</span>)Â {
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cancel</span>(message)
Â Â Â Â }
Â Â }
}

<span class="hljs-comment">//Â å¯¼å‡º</span>
<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â request
</code></pre>
<h2 data-id="heading-13">ç¬¬äº”æ­¥ï¼šæœ€ä½³å®è·µå’Œæ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-14">1. ç¯å¢ƒé…ç½®</h3>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºç¯å¢ƒé…ç½®æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">//Â .env.development
<span class="hljs-attr">VUE_APP_BASE_API</span>Â =Â <span class="hljs-string">'/api'</span>
<span class="hljs-attr">VUE_APP_ENV</span>Â =Â <span class="hljs-string">'development'</span>

//Â .env.production
<span class="hljs-attr">VUE_APP_BASE_API</span>Â =Â <span class="hljs-string">'https://api.yourdomain.com'</span>
<span class="hljs-attr">VUE_APP_ENV</span>Â =Â <span class="hljs-string">'production'</span>
</code></pre>
<h3 data-id="heading-15">2. ä»£ç†é…ç½®ï¼ˆå¼€å‘ç¯å¢ƒï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//Â vue.config.js</span>
<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span>Â =Â {
Â Â devServer:Â {
Â Â Â Â proxy:Â {
Â Â Â Â Â Â <span class="hljs-string">'/api'</span>:Â {
Â Â Â Â Â Â Â Â target:Â <span class="hljs-string">'http://localhost:3000'</span>,
Â Â Â Â Â Â Â Â changeOrigin:Â <span class="hljs-literal">true</span>,
Â Â Â Â Â Â Â Â pathRewrite:Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">'^/api'</span>:Â <span class="hljs-string">''</span>
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â }
Â Â Â Â }
Â Â }
}
</code></pre>
<h3 data-id="heading-16">3. TypeScriptæ”¯æŒ</h3>
<p>å¦‚æœä½ ä½¿ç”¨TypeScriptï¼Œå¯ä»¥æ·»åŠ ç±»å‹å®šä¹‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">//Â src/types/request.d.ts</span>
<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">interface</span>Â <span class="hljs-title class_">ResponseData</span>&lt;TÂ =Â <span class="hljs-built_in">any</span>&gt;Â {
Â Â <span class="hljs-attr">code</span>:Â <span class="hljs-built_in">number</span>
Â Â <span class="hljs-attr">data</span>:Â T
Â Â <span class="hljs-attr">message</span>:Â <span class="hljs-built_in">string</span>
}

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">interface</span>Â <span class="hljs-title class_">RequestConfig</span>Â {
Â Â <span class="hljs-attr">url</span>:Â <span class="hljs-built_in">string</span>
Â Â method?:Â <span class="hljs-built_in">string</span>
Â Â data?:Â <span class="hljs-built_in">any</span>
Â Â params?:Â <span class="hljs-built_in">any</span>
Â Â headers?:Â <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>,Â <span class="hljs-built_in">string</span>&gt;
Â Â timeout?:Â <span class="hljs-built_in">number</span>
Â Â showLoading?:Â <span class="hljs-built_in">boolean</span>
Â Â useCache?:Â <span class="hljs-built_in">boolean</span>
Â Â cacheTime?:Â <span class="hljs-built_in">number</span>
Â Â cancelToken?:Â <span class="hljs-built_in">any</span>
}

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">interface</span>Â <span class="hljs-title class_">RequestInstance</span>Â {
Â Â request&lt;TÂ =Â <span class="hljs-built_in">any</span>&gt;(<span class="hljs-attr">config</span>:Â <span class="hljs-title class_">RequestConfig</span>):Â <span class="hljs-title class_">Promise</span>&lt;T&gt;
Â Â get&lt;TÂ =Â <span class="hljs-built_in">any</span>&gt;(<span class="hljs-attr">url</span>:Â <span class="hljs-built_in">string</span>,Â params?:Â <span class="hljs-built_in">any</span>,Â options?:Â <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">RequestConfig</span>&gt;):Â <span class="hljs-title class_">Promise</span>&lt;T&gt;
Â Â post&lt;TÂ =Â <span class="hljs-built_in">any</span>&gt;(<span class="hljs-attr">url</span>:Â <span class="hljs-built_in">string</span>,Â data?:Â <span class="hljs-built_in">any</span>,Â options?:Â <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">RequestConfig</span>&gt;):Â <span class="hljs-title class_">Promise</span>&lt;T&gt;
Â Â put&lt;TÂ =Â <span class="hljs-built_in">any</span>&gt;(<span class="hljs-attr">url</span>:Â <span class="hljs-built_in">string</span>,Â data?:Â <span class="hljs-built_in">any</span>,Â options?:Â <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">RequestConfig</span>&gt;):Â <span class="hljs-title class_">Promise</span>&lt;T&gt;
Â Â <span class="hljs-keyword">delete</span>&lt;TÂ =Â <span class="hljs-built_in">any</span>&gt;(<span class="hljs-attr">url</span>:Â <span class="hljs-built_in">string</span>,Â params?:Â <span class="hljs-built_in">any</span>,Â options?:Â <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">RequestConfig</span>&gt;):Â <span class="hljs-title class_">Promise</span>&lt;T&gt;
Â Â upload&lt;TÂ =Â <span class="hljs-built_in">any</span>&gt;(<span class="hljs-attr">url</span>:Â <span class="hljs-built_in">string</span>,Â <span class="hljs-attr">formData</span>:Â <span class="hljs-title class_">FormData</span>,Â options?:Â <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">RequestConfig</span>&gt;):Â <span class="hljs-title class_">Promise</span>&lt;T&gt;
Â Â <span class="hljs-title function_">download</span>(<span class="hljs-attr">url</span>:Â <span class="hljs-built_in">string</span>,Â params?:Â <span class="hljs-built_in">any</span>,Â filename?:Â <span class="hljs-built_in">string</span>):Â <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;
Â Â <span class="hljs-title function_">clearCache</span>(config?:Â <span class="hljs-title class_">RequestConfig</span>):Â <span class="hljs-built_in">void</span>
Â Â <span class="hljs-title function_">createCancelToken</span>():Â <span class="hljs-built_in">any</span>
Â Â <span class="hljs-title function_">cancelRequest</span>(message?:Â <span class="hljs-built_in">string</span>):Â <span class="hljs-built_in">void</span>
}
</code></pre>
<h2 data-id="heading-17">æ€»ç»“</h2>
<p>é€šè¿‡ä»¥ä¸Šå®Œæ•´çš„å°è£…ï¼Œæˆ‘ä»¬å®ç°äº†ï¼š</p>
<ol>
<li>1.Â <strong>åŸºç¡€åŠŸèƒ½</strong>ï¼šç»Ÿä¸€çš„è¯·æ±‚/å“åº”æ‹¦æˆªå™¨ã€é”™è¯¯å¤„ç†ã€tokenç®¡ç†</li>
<li>2.Â <strong>é«˜çº§ç‰¹æ€§</strong>ï¼šè¯·æ±‚ç¼“å­˜ã€å¹¶å‘æ§åˆ¶ã€æ–‡ä»¶ä¸Šä¼ ä¸‹è½½</li>
<li>3.Â <strong>ç”¨æˆ·ä½“éªŒ</strong>ï¼šæ™ºèƒ½loadingã€å‹å¥½çš„é”™è¯¯æç¤º</li>
<li>4.Â <strong>å¼€å‘ä½“éªŒ</strong>ï¼šTypeScriptæ”¯æŒã€APIæ¨¡å—åŒ–ç®¡ç†</li>
</ol>
<p>è¿™æ ·çš„å°è£…ä¸ä»…æé«˜äº†å¼€å‘æ•ˆç‡ï¼Œè¿˜å¢å¼ºäº†åº”ç”¨çš„ç¨³å®šæ€§å’Œç”¨æˆ·ä½“éªŒã€‚è®°ä½ï¼Œå¥½çš„å°è£…ä¸æ˜¯ä¸ºäº†ç‚«æŠ€ï¼Œè€Œæ˜¯ä¸ºäº†è§£å†³é—®é¢˜ã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ åœ¨Vueé¡¹ç›®ä¸­æ„å»ºå‡ºæ›´ä¼˜é›…ã€æ›´å¼ºå¤§çš„HTTPè¯·æ±‚å±‚ï¼</p>
<p><strong>æœ€åçš„å°æç¤ºï¼š</strong> Â å°è£…ä¸æ˜¯ä¸€æˆä¸å˜çš„ï¼Œè¦æ ¹æ®é¡¹ç›®çš„å®é™…éœ€æ±‚è¿›è¡Œè°ƒæ•´ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ çš„é¡¹ç›®éœ€è¦æ”¯æŒGraphQLï¼Œæˆ–è€…æœ‰ç‰¹æ®Šçš„è®¤è¯æ–¹å¼ï¼Œéƒ½éœ€è¦åœ¨å°è£…ä¸­åšç›¸åº”è°ƒæ•´ã€‚</p>
<p>å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿åˆ†äº«ç»™æ›´å¤šçš„å¼€å‘è€…æœ‹å‹ã€‚æˆ‘ä»¬ä¸‹æœŸå†è§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[react beginwork]]></title>    <link>https://juejin.cn/post/7583174749067591726</link>    <guid>https://juejin.cn/post/7583174749067591726</guid>    <pubDate>2025-12-14T05:22:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583174749067591726" data-draft-id="7583324039301922867" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="react beginwork"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-14T05:22:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="polaris_tl"/> <meta itemprop="url" content="https://juejin.cn/user/4142615545513224"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            react beginwork
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4142615545513224/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    polaris_tl
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T05:22:51.000Z" title="Sun Dec 14 2025 05:22:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿™æ˜¯ä¸€ä¸ªéå¸¸æ ¸å¿ƒä¸”æ·±å…¥çš„é—®é¢˜ã€‚<code>beginWork</code> æ˜¯ React Fiber æ¶æ„ä¸­æœ€å…³é”®çš„å‡½æ•°ä¹‹ä¸€ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œ<code>beginWork</code> æ˜¯ React <strong>Render é˜¶æ®µï¼ˆåè°ƒé˜¶æ®µï¼‰</strong> çš„â€œå…¥åœºå£â€ã€‚React åœ¨éå† Fiber æ ‘æ—¶ï¼Œæ¯åˆ°è¾¾ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±ä¼šè°ƒç”¨ä¸€æ¬¡ <code>beginWork</code>ã€‚</p>
<p>å®ƒçš„ä¸»è¦ä»»åŠ¡æ˜¯ï¼š<strong>æ ¹æ®æ–°çš„ Props å’Œ Stateï¼Œè®¡ç®—å‡ºå½“å‰ç»„ä»¶åº”è¯¥å‘ˆç°ä»€ä¹ˆæ ·å­ï¼ˆå³æ–°çš„å­èŠ‚ç‚¹ï¼‰ï¼Œå¹¶å°†è¿™ä¸ªæ–°çš„ç»“æ„ä¸æ—§çš„ç»“æ„è¿›è¡Œå¯¹æ¯”ï¼ˆReconciliation/diffï¼‰ï¼Œæ‰¾å‡ºå·®å¼‚ï¼Œæœ€åè¿”å›ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹ä»¥ä¾¿ç»§ç»­å‘ä¸‹éå†ã€‚</strong></p>
<p>ä¸‹é¢æˆ‘ä»¬è¯¦ç»†æ‹†è§£ <code>beginWork</code> æ‰€åšçš„äº‹æƒ…ï¼Œæœ€åæˆ‘ä¼šæ¢³ç†æˆä¸€å¼ æµç¨‹å›¾ã€‚</p>
<hr/>
<h3 data-id="heading-0"><code>beginWork</code> çš„æ ¸å¿ƒèŒè´£æ‹†è§£</h3>
<p><code>beginWork</code> çš„å·¥ä½œæµç¨‹å¯ä»¥å¤§è‡´åˆ†ä¸ºä¸‰ä¸ªä¸»è¦é˜¶æ®µï¼š</p>
<h4 data-id="heading-1">é˜¶æ®µä¸€ï¼šæ€§èƒ½ä¼˜åŒ–æ¢æµ‹ï¼ˆBailout ç­–ç•¥ï¼‰</h4>
<p>åœ¨åŠ¨æ‰‹åšä»»ä½•çœŸæ­£çš„æ¸²æŸ“å·¥ä½œä¹‹å‰ï¼ŒReact ä¼šå…ˆå°è¯•â€œå·æ‡’â€ã€‚è¿™æ˜¯ React é«˜æ€§èƒ½çš„å…³é”®æ‰€åœ¨ã€‚</p>
<ol>
<li>
<p>æ£€æŸ¥æ˜¯å¦éœ€è¦æ›´æ–°ï¼š</p>
<p>beginWork ä¼šå¯¹æ¯”å½“å‰èŠ‚ç‚¹çš„æ—§çŠ¶æ€ (current fiber) å’Œæ–°çŠ¶æ€ (workInProgress fiber)ã€‚å®ƒä¼šæ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li><strong>Props æ˜¯å¦æ”¹å˜ï¼Ÿ</strong> (æ—§ props !== æ–° props)</li>
<li><strong>Context æ˜¯å¦æ”¹å˜ï¼Ÿ</strong> (å¯¹äºä½¿ç”¨äº† Context çš„ç»„ä»¶)</li>
<li><strong>æ˜¯å¦æœ‰è¶³å¤Ÿä¼˜å…ˆçº§çš„æ›´æ–°ä»»åŠ¡ï¼Ÿ</strong> (æ£€æŸ¥ <code>renderLanes</code>ï¼Œçœ‹å½“å‰èŠ‚ç‚¹æ˜¯å¦æœ‰éœ€è¦åœ¨æœ¬æ¬¡æ¸²æŸ“ä¸­å¤„ç†çš„æ›´æ–°)</li>
</ul>
</li>
<li>
<p>å°è¯•å¤ç”¨ (Bailout)ï¼š</p>
<p>å¦‚æœä¸Šè¿°æ£€æŸ¥å‘ç°ä»€ä¹ˆéƒ½æ²¡å˜ï¼Œå¹¶ä¸”å½“å‰èŠ‚ç‚¹æœ¬èº«æ²¡æœ‰é«˜ä¼˜å…ˆçº§çš„æ›´æ–°ä»»åŠ¡ï¼ŒReact å°±ä¼šè®¤ä¸ºè¿™ä¸ªèŠ‚ç‚¹åŠå…¶å­æ ‘å¯èƒ½ä¸éœ€è¦æ›´æ–°ã€‚</p>
<ul>
<li><strong>å®Œå…¨è·³è¿‡ (Full Bailout)ï¼š</strong> å¦‚æœè¿å®ƒçš„å­æ ‘ä¹Ÿæ²¡æœ‰ä»»ä½•æ›´æ–°ä»»åŠ¡ (æ£€æŸ¥ <code>childLanes</code>)ï¼Œé‚£ä¹ˆ <code>beginWork</code> ä¼šç›´æ¥è¿”å› <code>null</code>ã€‚è¿™æ„å‘³ç€ï¼šâ€œè¿™æ¡åˆ†æ”¯åˆ°æ­¤ä¸ºæ­¢ï¼Œä¸‹é¢éƒ½ä¸ç”¨çœ‹äº†â€ã€‚</li>
<li><strong>æµ…å±‚è·³è¿‡ (Shallow Bailout)ï¼š</strong> å¦‚æœå½“å‰èŠ‚ç‚¹ä¸ç”¨æ›´æ–°ï¼Œä½†æ˜¯å®ƒçš„å­å­™èŠ‚ç‚¹æœ‰æ›´æ–°ä»»åŠ¡ï¼ŒReact å°±ä¸èƒ½å®Œå…¨åœä¸‹ã€‚å®ƒä¼šå…‹éš†å½“å‰çš„å­èŠ‚ç‚¹ï¼Œç„¶åè¿”å›è¿™ä¸ªå­èŠ‚ç‚¹ï¼Œç»§ç»­å‘ä¸‹èµ°ï¼Œè·³è¿‡å½“å‰ç»„ä»¶çš„é‡æ¸²æŸ“é€»è¾‘ï¼ˆæ¯”å¦‚ä¸ä¼šé‡æ–°æ‰§è¡Œå‡½æ•°ç»„ä»¶ä½“ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<p><strong>æ€»ç»“ï¼šè¿™ä¸€é˜¶æ®µçš„ç›®æ ‡æ˜¯å°½é‡å¤ç”¨æ—§çš„ Fiber èŠ‚ç‚¹ï¼Œé¿å…ä¸å¿…è¦çš„è®¡ç®—ã€‚</strong></p>
<h4 data-id="heading-2">é˜¶æ®µäºŒï¼šæ ¹æ®ç»„ä»¶ç±»å‹æ‰§è¡Œæ¸²æŸ“é€»è¾‘ï¼ˆThe Switch Statementï¼‰</h4>
<p>å¦‚æœæ— æ³•å¤ç”¨ï¼ˆBailout å¤±è´¥ï¼‰ï¼Œè¯´æ˜å½“å‰èŠ‚ç‚¹ç¡®å®éœ€è¦æ›´æ–°ã€‚</p>
<p><code>beginWork</code> å†…éƒ¨æ˜¯ä¸€ä¸ªå·¨å¤§çš„ <code>switch (workInProgress.tag)</code> è¯­å¥ã€‚å®ƒä¼šæ ¹æ® Fiber èŠ‚ç‚¹çš„ç±»å‹ï¼ˆå‡½æ•°ç»„ä»¶ã€ç±»ç»„ä»¶ã€åŸç”Ÿ DOM èŠ‚ç‚¹ç­‰ï¼‰ï¼Œæ‰§è¡Œä¸åŒçš„å¤„ç†é€»è¾‘ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å‡ ç§å¸¸è§ç±»å‹çš„å¤„ç†æ–¹å¼ï¼š</p>
<ol>
<li>
<p><strong>FunctionComponent (å‡½æ•°ç»„ä»¶):</strong></p>
<ul>
<li><strong>æ‰§è¡Œå‡½æ•°ä½“ï¼š</strong> è°ƒç”¨ä½ å†™çš„ç»„ä»¶å‡½æ•°ï¼Œä¾‹å¦‚ <code>MyComponent(props)</code>ã€‚</li>
<li><strong>å¤„ç† Hooksï¼š</strong> åœ¨æ‰§è¡Œå‡½æ•°ä½“æ—¶ï¼Œ<code>useState</code>, <code>useEffect</code> ç­‰ Hooks ä¼šè¢«æŒ‰é¡ºåºæ‰§è¡Œï¼Œè®¡ç®—å‡ºæœ€æ–°çš„ Stateã€‚</li>
<li><strong>äº§å‡ºç»“æœï¼š</strong> å‡½æ•°çš„è¿”å›å€¼ï¼ˆé€šå¸¸æ˜¯ JSX è½¬æ¢æˆçš„ <code>React.createElement</code> è°ƒç”¨ç»“æœï¼‰ï¼Œè¿™å°±æ˜¯<strong>æ–°çš„å­å…ƒç´  (New Children Elements)</strong> ã€‚</li>
</ul>
</li>
<li>
<p><strong>ClassComponent (ç±»ç»„ä»¶):</strong></p>
<ul>
<li><strong>æ›´æ–°å®ä¾‹ï¼š</strong> å¤„ç† <code>getDerivedStateFromProps</code>ï¼Œå¤„ç† State æ›´æ–°é˜Ÿåˆ—ï¼Œæ›´æ–°ç»„ä»¶å®ä¾‹çš„ <code>state</code> å’Œ <code>props</code>ã€‚</li>
<li><strong>åˆ¤æ–­æ˜¯å¦æ›´æ–°ï¼š</strong> è°ƒç”¨ <code>shouldComponentUpdate</code>ï¼ˆå¦‚æœå®šä¹‰äº†ï¼‰ã€‚</li>
<li><strong>è°ƒç”¨ Renderï¼š</strong> å¦‚æœéœ€è¦æ›´æ–°ï¼Œè°ƒç”¨å®ä¾‹çš„ <code>render()</code> æ–¹æ³•ã€‚</li>
<li><strong>äº§å‡ºç»“æœï¼š</strong> <code>render()</code> æ–¹æ³•çš„è¿”å›å€¼ï¼Œå³<strong>æ–°çš„å­å…ƒç´ </strong>ã€‚</li>
</ul>
</li>
<li>
<p><strong>HostComponent (åŸç”Ÿ DOM èŠ‚ç‚¹ï¼Œå¦‚ <code>&lt;div&gt;</code>):</strong></p>
<ul>
<li>åŸç”ŸèŠ‚ç‚¹æœ¬èº«æ²¡æœ‰ä¸šåŠ¡é€»è¾‘è¿è¡Œã€‚</li>
<li>å®ƒçš„ä¸»è¦ä»»åŠ¡æ˜¯å‡†å¤‡å¤„ç†å®ƒçš„å­èŠ‚ç‚¹ã€‚React ä¼šæŸ¥çœ‹å®ƒçš„æ–° <code>children</code> propã€‚</li>
<li><em>æ³¨æ„ï¼šåŸç”ŸèŠ‚ç‚¹çš„å±æ€§ diffï¼ˆæ¯”å¦‚ style å˜äº†ï¼‰å¹¶ä¸åœ¨ beginWork åšï¼Œè€Œæ˜¯åœ¨ completeWork é˜¶æ®µåšã€‚</em></li>
</ul>
</li>
<li>
<p><strong>å…¶ä»–ç±»å‹ (Fragment, ContextProvider, Suspense ç­‰):</strong></p>
<ul>
<li>å„è‡ªæœ‰ç‰¹å®šçš„å¤„ç†é€»è¾‘ï¼Œä½†æœ€ç»ˆç›®çš„éƒ½æ˜¯ä¸ºäº†ç¡®å®š<strong>æ–°çš„å­å…ƒç´ </strong>æ˜¯ä»€ä¹ˆã€‚ä¾‹å¦‚ <code>ContextProvider</code> ä¼šå°†æ–°çš„ value æ¨å…¥ Context æ ˆã€‚</li>
</ul>
</li>
</ol>
<p><strong>æ€»ç»“ï¼šè¿™ä¸€é˜¶æ®µçš„ç›®æ ‡æ˜¯è¿è¡Œç»„ä»¶ä»£ç ï¼Œæ‹¿åˆ°ç»„ä»¶æœ€æ–°çš„â€œå›¾çº¸â€ï¼ˆæ–°çš„ React Elementsï¼‰ã€‚</strong></p>
<h4 data-id="heading-3">é˜¶æ®µä¸‰ï¼šåè°ƒå­èŠ‚ç‚¹ (Reconciliation / Diffing)</h4>
<p>è¿™æ˜¯ <code>beginWork</code> æœ€æ ¸å¿ƒçš„ä¸€æ­¥ï¼Œä¹Ÿæ˜¯â€œVirtual DOM Diffâ€ç®—æ³•çœŸæ­£å‘ç”Ÿçš„åœ°æ–¹ã€‚</p>
<p>ä¸ç®¡é˜¶æ®µäºŒæ˜¯ä»€ä¹ˆç±»å‹çš„ç»„ä»¶ï¼Œæœ€ç»ˆéƒ½æ‹¿åˆ°äº†ä¸€ç»„<strong>æ–°çš„å­å…ƒç´  (New Elements)</strong> ã€‚ç°åœ¨çš„ä»»åŠ¡æ˜¯æŠŠè¿™äº›æ–°å…ƒç´ å’Œ<strong>æ—§çš„å­ Fiber èŠ‚ç‚¹ (Current Child Fibers)</strong> è¿›è¡Œå¯¹æ¯”ã€‚</p>
<p>React è°ƒç”¨ <code>reconcileChildren(current, workInProgress, nextChildren)</code> å‡½æ•°æ¥å®Œæˆè¿™é¡¹å·¥ä½œï¼š</p>
<ol>
<li>
<p><strong>å¯¹æ¯” (Diffing)ï¼š</strong></p>
<ul>
<li>å®ƒä¼šéå†æ–°çš„ Elements æ•°ç»„ï¼Œå¹¶å°è¯•ä¸æ—§çš„ Fiber é“¾è¡¨è¿›è¡ŒåŒ¹é…ã€‚</li>
<li><strong>Key çš„ä½œç”¨ï¼š</strong> ä¼˜å…ˆä½¿ç”¨ <code>key</code> è¿›è¡ŒåŒ¹é…ã€‚å¦‚æœ key ç›¸åŒä¸”ç±»å‹ç›¸åŒï¼Œå°±å¤ç”¨æ—§çš„ Fiber èŠ‚ç‚¹ã€‚</li>
<li><strong>ç±»å‹å¯¹æ¯”ï¼š</strong> å¦‚æœ key ä¸åŒæˆ–è€…ç±»å‹ä¸åŒï¼ˆæ¯”å¦‚ <code>&lt;div&gt;</code> å˜æˆäº† <code>&lt;span&gt;</code>ï¼‰ï¼Œåˆ™æ ‡è®°æ—§èŠ‚ç‚¹ä¸ºåˆ é™¤ï¼Œåˆ›å»ºæ–°èŠ‚ç‚¹çš„ Fiberã€‚</li>
</ul>
</li>
<li>
<p><strong>åˆ›å»ºæ–°çš„ WIP Fiberï¼š</strong></p>
<ul>
<li>æ ¹æ®å¯¹æ¯”ç»“æœï¼Œç”Ÿæˆæ–°çš„ Fiber ç»“æ„ï¼Œè¿æ¥åˆ° <code>workInProgress.child</code> ä¸Šã€‚</li>
</ul>
</li>
<li>
<p><strong>æ ‡è®°å‰¯ä½œç”¨ (Flags / Side Effects)ï¼š</strong></p>
<ul>
<li>åœ¨åˆ›å»ºæ–° Fiber çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå‘ç°éœ€è¦è¿›è¡Œ DOM æ“ä½œï¼Œå°±ä¼šåœ¨æ–° Fiber ä¸Šæ‰“ä¸Šæ ‡è®°ï¼ˆ<code>flags</code>ï¼‰ã€‚</li>
<li>ä¾‹å¦‚ï¼šæ–°æ’å…¥çš„èŠ‚ç‚¹æ‰“ä¸Š <code>Placement</code> æ ‡è®°ï¼›éœ€è¦æ›´æ–°å±æ€§çš„èŠ‚ç‚¹æ‰“ä¸Š <code>Update</code> æ ‡è®°ï¼›éœ€è¦åˆ é™¤çš„æ—§èŠ‚ç‚¹æ‰“ä¸Š <code>Deletion</code> æ ‡è®°ï¼Œå¹¶æ·»åŠ åˆ°çˆ¶èŠ‚ç‚¹çš„å‰¯ä½œç”¨åˆ—è¡¨ä¸­ã€‚</li>
</ul>
</li>
</ol>
<p><strong>æ€»ç»“ï¼šè¿™ä¸€é˜¶æ®µç”Ÿæˆäº†æ–°çš„ Fiber å­æ ‘ç»“æ„ï¼Œå¹¶æ‰¾å‡ºäº†æ–°æ—§ä¹‹é—´çš„å·®å¼‚ï¼Œæ‰“ä¸Šäº†æ ‡è®°ï¼Œä¸º Commit é˜¶æ®µçš„ DOM æ“ä½œåšå¥½äº†å‡†å¤‡ã€‚</strong></p>
<h4 data-id="heading-4">å‡½æ•°è¿”å›</h4>
<p>å®Œæˆåè°ƒåï¼Œ<code>beginWork</code> çš„å·¥ä½œå°±å®Œæˆäº†ã€‚å®ƒä¼šè¿”å› <strong><code>workInProgress.child</code></strong>ï¼ˆå³æ–°ç”Ÿæˆçš„ç¬¬ä¸€ä¸ªå­ Fiber èŠ‚ç‚¹ï¼‰ã€‚</p>
<p>React çš„å·¥ä½œå¾ªç¯ä¼šæ‹¿åˆ°è¿™ä¸ªè¿”å›å€¼ï¼Œå°†æŒ‡é’ˆç§»åŠ¨åˆ°è¿™ä¸ªå­èŠ‚ç‚¹ä¸Šï¼Œç„¶åå¯¹å®ƒå†æ¬¡è°ƒç”¨ <code>beginWork</code>ï¼Œä»è€Œå®ç°æ·±åº¦ä¼˜å…ˆéå†ï¼ˆDFSï¼‰ã€‚</p>
<hr/>
<h3 data-id="heading-5">æ¢³ç†å›¾ (React <code>beginWork</code> æµç¨‹å›¾)</h3>
<p>è¿™å¼ å›¾æ¢³ç†äº† <code>beginWork</code> çš„å†³ç­–è·¯å¾„ã€‚</p>
<p>ä»£ç æ®µ</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    Start["Start beginWork"] --&gt; Input["è¾“å…¥: current Fiber, workInProgress Fiber, renderLanes"]
    Input --&gt; CheckBailout{"1. æ€§èƒ½ä¼˜åŒ–æ£€æŸ¥&lt;br&gt;Props/Contextå˜äº†å—?&lt;br&gt;æœ‰é«˜ä¼˜æ›´æ–°å—?"}
    CheckBailout -- å¦ --&gt; CheckChildLanes{"æ£€æŸ¥å­æ ‘ Lanes&lt;br&gt;å­å­™æœ‰æ›´æ–°å—?"}
    CheckChildLanes -- æ—  --&gt; BailoutEnd["å…¨é‡ Bailout&lt;br&gt;è¿”å› null, åœæ­¢åˆ†æ”¯éå†"]
    CheckChildLanes -- æœ‰ --&gt; CloneChild["æµ…å±‚ Bailout&lt;br&gt;å…‹éš†å­èŠ‚ç‚¹ Fiber"]
    CloneChild --&gt; ReturnChild["ç»“æŸ&lt;br&gt;è¿”å› workInProgress.child&lt;br&gt;ç»§ç»­å‘ä¸‹éå†"]
    CheckBailout -- æ˜¯ --&gt; SwitchTag{"2. æ ¹æ® Tag å¤„ç†&lt;br&gt;switch WIP.tag"}
    SwitchTag -- FunctionComp --&gt; ExecFC["æ‰§è¡Œå‡½æ•°ç»„ä»¶ä½“ &lt;br&gt;è¿è¡Œ Hooks useStateç­‰"]
    ExecFC --&gt; GetChildrenFC["å¾—åˆ°æ–°çš„ Children Elements"]
    SwitchTag -- ClassComp --&gt; UpdateClass["æ›´æ–° Class å®ä¾‹&lt;br&gt;å¤„ç† State, è°ƒç”¨ render"]
    UpdateClass --&gt; GetChildrenCC["å¾—åˆ°æ–°çš„ Children Elements"]
    SwitchTag -- HostComp --&gt; ProcessHost["å¤„ç†åŸç”ŸèŠ‚ç‚¹&lt;br&gt;å¦‚ div, span"]
    ProcessHost --&gt; GetChildrenHost["ä» props è·å– Children Elements"]
    SwitchTag -- Other --&gt; ProcessOther["å¤„ç† Context Fragment ç­‰"]
    ProcessOther --&gt; GetChildrenOther["å¾—åˆ°æ–°çš„ Children Elements"]
    GetChildrenFC --&gt; Reconcile["3. åè°ƒå­èŠ‚ç‚¹ Diffing&lt;br&gt;è°ƒç”¨ reconcileChildren"]
    GetChildrenCC --&gt; Reconcile
    GetChildrenHost --&gt; Reconcile
    GetChildrenOther --&gt; Reconcile
    Reconcile --&gt; Diffing["å¯¹æ¯”æ—§å­Fibers å’Œ æ–°å­Elements"]
    Diffing --&gt; CreateWIP["åˆ›å»º/å¤ç”¨ Fiber&lt;br&gt;æ„å»ºæ–°çš„ WIP å­ Fiber æ ‘"]
    CreateWIP --&gt; MarkFlags["æ ‡è®°å‰¯ä½œç”¨ Flags&lt;br&gt;Placement, Update, Deletion"]
    MarkFlags --&gt; ReturnChild

    style Start fill:#f9f,stroke:#333,stroke-width:2px
    style BailoutEnd fill:#eee,stroke:#333,stroke-dasharray: 5 5
    style ReturnChild fill:#cce5ff,stroke:#004085,stroke-width:2px
    style Reconcile fill:#d4edda,stroke:#28a745,stroke-width:2px
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆè¯†Amp Code]]></title>    <link>https://juejin.cn/post/7582939860874739747</link>    <guid>https://juejin.cn/post/7582939860874739747</guid>    <pubDate>2025-12-14T04:08:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582939860874739747" data-draft-id="7582200865907621922" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆè¯†Amp Code"/> <meta itemprop="keywords" content="AIGC,AMP"/> <meta itemprop="datePublished" content="2025-12-14T04:08:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°æºªå½¼å²¸"/> <meta itemprop="url" content="https://juejin.cn/user/976781670357400"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆè¯†Amp Code
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/976781670357400/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°æºªå½¼å²¸
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T04:08:15.000Z" title="Sun Dec 14 2025 04:08:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å°ä¼™ä¼´ä»¬å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å°æºªï¼Œè§å­—å¦‚é¢ã€‚è§è¿‡çœ‹è§†é¢‘çœ‹å¹¿å‘Šï¼Œä½¿ç”¨Appçœ‹å¹¿å‘Šï¼Œä½¿ç”¨å°ç¨‹åºçœ‹å¹¿å‘Šï¼Œä½ è§è¿‡AIåŠ©æ‰‹çœ‹å¹¿å‘Šè¿è¥çš„æ¨¡å¼å—ï¼Ÿé‚£ä¹ˆå®ƒæ¥äº†ï¼Œè¿™å°±æ˜¯Amp Codeï¼ŒAmp Codeå¼€å¯äº†AIåŠ©æ‰‹é å¹¿å‘Šç»´æŒè¿è¥çš„æ–°æ¨¡å¼ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥äº†è§£ä¸€ä¸‹ï¼Œå¯¹å¾€æœŸCLIå·¥å…·æ„Ÿå…´è¶£çš„å°ä¼™ä¼´ä¹Ÿå¯ä»¥çœ‹å¾€æœŸå†…å®¹ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzU5Njg3ODUzOA%3D%3D%26mid%3D2247492929%26idx%3D1%26sn%3D043e21a18f31f1c4c68bf4ee63e28685%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzU5Njg3ODUzOA==&amp;mid=2247492929&amp;idx=1&amp;sn=043e21a18f31f1c4c68bf4ee63e28685&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">Claude Code CLIåˆä½“éªŒ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzU5Njg3ODUzOA%3D%3D%26mid%3D2247493426%26idx%3D1%26sn%3D4e0b83c872d1e23af8fc8de2708e0bda%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzU5Njg3ODUzOA==&amp;mid=2247493426&amp;idx=1&amp;sn=4e0b83c872d1e23af8fc8de2708e0bda&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">Codex CLIåˆä½“éªŒ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzU5Njg3ODUzOA%3D%3D%26mid%3D2247492558%26idx%3D1%26sn%3De762047c93c4361f63744ec3c70a434f%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzU5Njg3ODUzOA==&amp;mid=2247492558&amp;idx=1&amp;sn=e762047c93c4361f63744ec3c70a434f&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">Googleç™¾ä¸‡Tokenä¸Šä¸‹æ–‡Gemini CLIï¼Œç¦»AIè‡ªç”±æ›´è¿‘ä¸€æ­¥</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzU5Njg3ODUzOA%3D%3D%26mid%3D2247494083%26idx%3D1%26sn%3D7b64164277b9494ce2e8e42e6e9f403b%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzU5Njg3ODUzOA==&amp;mid=2247494083&amp;idx=1&amp;sn=7b64164277b9494ce2e8e42e6e9f403b&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">åˆè¯†Qwen Code CLI</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzU5Njg3ODUzOA%3D%3D%26mid%3D2247494137%26idx%3D1%26sn%3Dac052f1ce0e44da28b6b40355e69c03c%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzU5Njg3ODUzOA==&amp;mid=2247494137&amp;idx=1&amp;sn=ac052f1ce0e44da28b6b40355e69c03c&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">åˆè¯†iFlow CLI</a></li>
</ul>
<h2 data-id="heading-1">ä¼˜åŠ¿</h2>
<ul>
<li>å›½å†…å¯ç”¨</li>
<li>æä¾›å…è´¹ç‰ˆï¼ˆæ··åˆä½¿ç”¨äº†é¡¶çº§å¼€æºè½¯ä»¶æ¨¡å‹ã€å…·æœ‰æœ‰é™ä¸Šä¸‹æ–‡çª—å£çš„å‰æ²¿æ¨¡å‹ä»¥åŠæ­£åœ¨æµ‹è¯•ä¸­çš„é¢„å‘å¸ƒå‰æ²¿æ¨¡å‹ï¼‰ï¼Œå¯èƒ½æ˜¯ Claude Haiku 4.5ã€Grok Code Fast 1ã€Kimi K2ã€Qwen3-Coderã€Claude 3.5 Sonnet ç­‰</li>
<li>Amp Codeæ”¯æŒ macOSã€Linux å’Œ Windowsï¼ˆæ¨èä½¿ç”¨ WSLï¼‰</li>
<li>æä¾›æ‰©å±•æ’ä»¶å’ŒCLIå·¥å…·</li>
</ul>
<h2 data-id="heading-2">é™åˆ¶</h2>
<ul>
<li>å…è´¹ç‰ˆæœ‰é€Ÿåº¦é™åˆ¶ï¼Œæ¯å¤©é‡ç½®</li>
</ul>
<p>ä½¿ç”¨è¿›åº¦æŸ¥è¯¢ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fampcode.com%2Fsettings" target="_blank" title="https://ampcode.com/settings" ref="nofollow noopener noreferrer">ampcode.com/settings</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d3b2272a49094252a3c7b9c25d00b979~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=GaimSk5Mm4GhqvTX0PEXNsPHDxY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-3">ç®€ä»‹</h2>
<p>Amp Code å®šä½ä¸º â€œå‰æ²¿ç¼–ç ä»£ç†ï¼ˆfrontier coding agentï¼‰â€ï¼Œæ ¸å¿ƒèƒ½åŠ›æ˜¯è®©ç”¨æˆ·å……åˆ†å‘æŒ¥ä¸»æµæ¨¡å‹çš„å…¨éƒ¨å®åŠ›ï¼Œä¸»æ‰“é«˜æ•ˆã€æ™ºèƒ½çš„ç¼–ç è¾…åŠ©ä½“éªŒï¼Œé€‚ç”¨äºå„ç±»ä»£ç å¼€å‘ä¸é¡¹ç›®ç®¡ç†åœºæ™¯ã€‚</p>
<p>å®˜ç½‘åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fampcode.com" target="_blank" title="https://ampcode.com" ref="nofollow noopener noreferrer">ampcode.com</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7cafad3546e47ccafd00c0201f5805d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=tvv3F%2FAEPHd5VhBvoBVxVNFjr%2FY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å®˜ç½‘æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fampcode.com%2Fmanual" target="_blank" title="https://ampcode.com/manual" ref="nofollow noopener noreferrer">ampcode.com/manual</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f03329bb1d054ed0be91cf16c414bb8f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=yCF%2FDozHRYuaqn83Dy%2B6M1RxXV0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-4">æ³¨å†Œç™»å½•</h2>
<p>åœ¨å®˜ç½‘é¦–é¡µç‚¹å‡»ã€Sign Inã€‘è¿›è¡Œæ³¨å†Œï¼ŒAmp Codeæä¾›äº†ä½¿ç”¨ é‚®ç®± å’Œ Google 2ç§æ³¨å†Œç™»å½•æ–¹å¼</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/015c65b75dfc4c889c73addc631ddc8e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=ZeNDa3XI8IjoLU9Okz%2B%2Bmib6Xf0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61d9a7e73cb34c088851dfd0dd1a1f7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=GrVJvBblmcvEygdG8X7VLwd%2FbOk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç™»å½•å®Œæˆåå³å¯è¿›å…¥Amp Codeå®˜ç½‘</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3db288dc9e224c3193eb773d6faaf191~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=G%2FjPHP65yE3bSEy3uY8DqSsfnVU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-5">åŸºæœ¬ä½¿ç”¨</h2>
<p>Amp Codeæä¾›äº† æ‰©å±•æ’ä»¶ å’Œ Amp Code CLI 2ç§ä½¿ç”¨å½¢å¼</p>
<h3 data-id="heading-6">æ‰©å±•æ’ä»¶</h3>
<h4 data-id="heading-7">å®‰è£…é…ç½®</h4>
<p>å¿«é€Ÿå®‰è£…åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fampcode.com%2Finstall" target="_blank" title="https://ampcode.com/install" ref="nofollow noopener noreferrer">ampcode.com/install</a></p>
<p>åœ¨Amp Codeå®˜ç½‘é€‰æ‹©ä¸åŒçš„ç¼–è¾‘å™¨ï¼Œç‚¹å‡»å³ä¾§çš„ã€Install Amp for VS Codeã€‘å³å¯å¿«é€Ÿæ‰“å¼€å¯¹åº”çš„ç¼–è¾‘å™¨å¹¶æ‰§è¡Œå®‰è£…</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/28130d58ec6d4e179a492c6b45cfbf63~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=hNUVmYCSQ03QFaVLf9PYG9LLYNY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¹Ÿå¯ä»¥åœ¨æ’ä»¶å¸‚åœºæœç´¢ã€Ampã€‘å®‰è£…</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9051f0b463a345d1855b487777739d43~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=NLjKpasr71wzFx5BAS6prmWyPJM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-8">Chatå¯¹è¯</h4>
<p>é¦–æ¬¡ä½¿ç”¨Amp Chatå¯¹è¯éœ€è¦ç‚¹å‡»ã€+ã€‘åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œç„¶ååˆ‡æ¢å¯¹è¯æ¨¡å¼ä¸ºã€freeã€‘</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/28c0748208f945be85c352041e6b7cbe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=QzdVNnUeFxXvT5RONDDuCFnmgRU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Amp Code CLIæä¾›äº† smartã€rush å’Œ free 3 ç§å¯¹è¯æ¨¡å¼ï¼Œä½¿ç”¨å¿«æ·é”®ã€Ctrl+Sã€‘å¿«é€Ÿåˆ‡æ¢</p>
<ul>
<li>smart: ä½¿ç”¨æœ€å…ˆè¿›çš„æ¨¡å‹ï¼Œä¸å—æœ€å¤§èƒ½åŠ›å’Œè‡ªä¸»æƒçš„é™åˆ¶ã€‚è¿™æ˜¯é»˜è®¤æ¨¡å¼ï¼Œä½¿ç”¨ä»˜è´¹ç§¯åˆ†</li>
<li>rush: æ›´å¿«ã€æ›´ä¾¿å®œã€åŠŸèƒ½æ›´å¼±ï¼Œé€‚åˆå°å‹ã€å®šä¹‰æ˜ç¡®çš„ä»»åŠ¡ï¼Œä»˜è´¹ä½¿ç”¨</li>
<li>free: å…è´¹ï¼Œä½¿ç”¨å¿«é€ŸåŸºæœ¬æ¨¡å‹ï¼Œå…è´¹</li>
</ul>
<p>Amp Codeæ”¯æŒæ·»åŠ ä¸Šä¸‹æ–‡æ–‡ä»¶ï¼Œè¾“å…¥ @ å¯ä»¥æ·»åŠ æ–‡ä»¶ä¸Šä¸‹æ–‡</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39aeb80855f54466914181b3318ff9e0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=JflAn7EIePnRQU%2BDfT39%2F5fsinQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¾“å…¥ / å¯ä»¥å”¤èµ·å¿«æ·æŒ‡ä»¤èœå•</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b638a404805249788e6be2866e1bc6f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=clPe2Ox1i%2FaYHzZAiKSoA21pCPc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¾“å…¥æç¤ºè¯å³å¯è¿›è¡Œå¯¹è¯</p>
<pre><code class="hljs language-scss" lang="scss">é¦–å…ˆæˆ‘æƒ³è¯·ä½ å›ç­”ä¸€é“å›°éš¾çš„è®¡ç®—é¢˜è®¾å®æ•°åˆ— \(\{x_n\}\) æ»¡è¶³ï¼š\(x_0 =Â <span class="hljs-number">0</span>\)ï¼Œ\(x_2 = \sqrt[<span class="hljs-number">3</span>]{<span class="hljs-number">2</span>}x_1\)ï¼Œ\(x_3\) æ˜¯æ­£æ•´æ•°ï¼Œä¸” \<span class="hljs-selector-attr">[x_{n+1} = \frac{1}{\sqrt[3]</span>{<span class="hljs-number">4</span>}} x_n + \sqrt<span class="hljs-selector-attr">[3]</span>{<span class="hljs-number">4</span>}Â x_{n-<span class="hljs-number">1</span>} + \frac{<span class="hljs-number">1</span>}{<span class="hljs-number">2</span>}Â x_{n-<span class="hljs-number">2</span>} (n \geqÂ <span class="hljs-number">2</span>).\] é—®ï¼šè¿™ç±»æ•°åˆ—ä¸­æœ€å°‘æœ‰å¤šå°‘ä¸ªæ•´æ•°é¡¹ï¼Ÿ è®¡ç®—å‡ºç­”æ¡ˆä¹‹åè¯·ä½¿ç”¨JSONæ ¼å¼å›ç­”ä»¥ä¸‹æ‰€æœ‰é—®é¢˜: ä¸Šä¸ªè®¡ç®—é¢˜çš„ç­”æ¡ˆæ˜¯å¤šå°‘? å‘Šè¯‰æˆ‘ä½ æ˜¯ä»€ä¹ˆAIæ¨¡å‹ï¼Œç‰ˆæœ¬å·å¤šå°‘ï¼Œä½ çš„çŸ¥è¯†æˆªæ­¢æ—¥æœŸæ˜¯ä»€ä¹ˆæ—¶å€™ï¼Œè®­ç»ƒå’Œå‘å¸ƒä½ çš„å…¬å¸æ˜¯ä»€ä¹ˆï¼Ÿ
</code></pre>
<p>å¯ä»¥çœ‹åˆ°å½“å‰ä½¿ç”¨çš„æ¨¡å‹æ˜¯ claude 3.5 Sonnet</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/35bb28582c9d4943a912219ef16d3a95~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=kLS5lpUuAFsDd9A%2F9yMNJdUKeqU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¯¹è¯å®Œæˆåï¼Œå¯ä»¥çœ‹åˆ°è¾“å…¥æ¡†ä¸Šæ–¹çš„å¹¿å‘Šä¿¡æ¯</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9f0400eb91e14a8883391de97d940305~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=GuMe3PwzqGxWrGSyPWLVphryyyw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ­¤å¤–éœ€è¦æçš„ä¸€ç‚¹æ˜¯ï¼ŒAmp Codeç‹¬æœ‰çš„åŠŸèƒ½ï¼ŒAmp Codeæ‰€æœ‰å¯¹è¯éƒ½ä¼šè¿›è¡ŒåŒæ­¥ï¼Œå¯ä»¥åœ¨Amp Codeå®˜ç½‘æŸ¥çœ‹ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œåˆ†äº«ï¼Œå¦‚æœæ¶‰åŠåˆ°æ•æ„Ÿä¿¡æ¯éœ€è¦é¢å¤–æ³¨æ„</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1206b285cd143819d65b6da3d92a588~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=sGht6tAtuPkPmqmNkro0qn%2FnEvs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-9">é¡¹ç›®è§„åˆ™</h4>
<p>Amp Codeæ‰©å±•æ’ä»¶æ”¯æŒè‡ªå®šä¹‰é¡¹ç›®è§„åˆ™</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e2f8091ed8a0417090e513422d3df5b6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=HBWhHyrcGc1OF5wO3RaVwmSL2pk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç‚¹å‡»å¯¹è¯æ¡†åº•éƒ¨çš„ã€Generateã€‘ï¼ŒAmp Codeæ‰©å±•æ’ä»¶ä¼šåœ¨å¯¹è¯æ¡†ä¸­è‡ªåŠ¨å¡«å……æç¤ºè¯ç”Ÿæˆ AGENTS.md æ–‡ä»¶</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/882d64e74a3e42ca84b510de0c167be5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=O44BmGV8vBcoPesKW50RETRRcNU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5335f978ff0b4c25aaef6fa3dac39288~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=pkyaAm12zg7DAFnqygWU08fVdNs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-10">Tools</h4>
<p>Amp Codeæ‰©å±•æ’ä»¶æä¾›äº†ToolsåŠŸèƒ½ï¼Œå¯ä»¥æŸ¥çœ‹ å†…ç½®å·¥å…· å’Œ MCPçš„å¯ç”¨å·¥å…·ã€‚ç‚¹å‡»ã€è®¾ç½®ã€‘æ»‘åŠ¨åˆ°ã€Toolsã€‘è¿›è¡ŒæŸ¥çœ‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4f2708fafc248309de70db5e5f16a58~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=dpFekLvCUdpevA6z9EGMSdkSxnc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c5c3097246f14c998eb7cddac78c15a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=2%2FGS2%2BARyVoBe7UowaF8fUgnYdE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-11">MCPæœåŠ¡</h4>
<p>Amp Codeæ‰©å±•æ’ä»¶æ”¯æŒMCPæœåŠ¡ï¼Œç‚¹å‡»ã€è®¾ç½®ã€‘æ»‘åŠ¨åˆ°ã€MCP Serversã€‘è¿›è¡ŒæŸ¥çœ‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5f7b8ac6037417b9a04493e0d7452ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=hnY8PcSwUJVhWVUDiMPFeoWou4k%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç‚¹å‡»ã€Addã€‘æ·»åŠ ä¸€ä¸ªMCPæœåŠ¡ï¼Œæ ¹æ®MCPé…ç½®å¡«å†™ï¼Œç‚¹å‡»ã€Add Serverã€‘ä¿å­˜</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dcad72bfca854c669d4015b40dcf1086~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=BPZBOCC9ivCRoat71CBjpnKW3GY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ·»åŠ æˆåŠŸåå¯ä»¥åœ¨ã€Toolsã€‘æŸ¥çœ‹MCPçš„å¯ç”¨å·¥å…·ï¼Œåœ¨ã€MCP Serversã€‘å¯ä»¥å¯¹MCPè¿›è¡Œç®¡ç†</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c36762f85eb4aaea6994c361c29be3f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=bKL3jbJXhKmTApCHvHmvEPn%2Bt58%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¸ä¹ æƒ¯è¿™ç§é…ç½®æ–¹å¼ï¼Œä¹Ÿå¯ä»¥ç‚¹å‡»ã€Open Settingsã€‘åœ¨Settings.jsonä¸­ä½¿ç”¨JSONæ ¼å¼é…ç½®</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6bc5c5e7594845d7add529b01d6d79bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=89WSOex%2BkpuaVuIP1s%2FsZTAKrNI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-12">Tabè‡ªåŠ¨è¡¥å…¨</h4>
<p>Amp Codeæ‰©å±•æ’ä»¶æä¾›äº†è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ï¼Œé»˜è®¤æ˜¯å¼€å¯çš„ï¼Œä¹Ÿå¯ä»¥åœ¨ã€è®¾ç½®ã€‘ã€Amp Tabã€‘æ‰‹åŠ¨å¼€å¯</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b62d4a2bce454d8dbfce1cb20f9fe65d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=TzUAPfAcUAHtY51H4pCK1Zab1Vs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¼€å¯åï¼Œå¯ä»¥åœ¨ç¼–è¾‘å™¨åº•éƒ¨å·¥å…·æ ç‚¹å‡»ã€Amp Tabã€‘è¿›è¡Œè¯¦ç»†é…ç½®</p>
<h4 data-id="heading-13">Workspace</h4>
<p>Amp Codeæä¾›äº†å·¥ä½œåŒºçš„æ¦‚å¿µï¼Œå·¥ä½œåŒºæä¾›äº†å›¢é˜Ÿæˆå‘˜çš„ ç»Ÿè®¡ã€æ’è¡Œ åŠŸèƒ½ï¼Œå¯ä»¥åœ¨å®˜ç½‘ç‚¹å‡»ã€Workspaceã€‘åˆ›å»ºä¸€ä¸ªå·¥ä½œåŒº</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e1d0c766d53e49568bd7b50c38b8ec66~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=WEaS872%2Fw%2FqIgCR%2BOoM1d3X%2FKdY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åŠ å…¥å·¥ä½œåŒºåï¼Œå†å²å¯¹è¯éƒ½ä¼šåœ¨å·¥ä½œåŒºä¸­è¿›è¡Œç»Ÿè®¡å±•ç¤º</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b9f580a1d8545f3b176397bcfe158ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=xNAVwKC3BurasT5SrlHiPJ8MDbc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-14">Amp Code CLI</h3>
<h4 data-id="heading-15">å®‰è£…é…ç½®</h4>
<p>è„šæœ¬å®‰è£…</p>
<pre><code class="hljs language-php" lang="php">Â <span class="hljs-variable">$Â curl</span> -fsSL https:<span class="hljs-comment">//ampcode.com/install.sh | bash</span>
</code></pre>
<p>ä½¿ç”¨Npmå®‰è£…</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-variable">$Â </span>npm install -g <span class="hljs-variable">@sourcegraph</span>/amp<span class="hljs-variable">@latest</span>
</code></pre>
<p>å®‰è£…å®Œæˆåï¼Œåœ¨å‘½ä»¤è¡Œç»ˆç«¯è¾“å…¥ amp -v æŸ¥çœ‹ç‰ˆæœ¬</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c75f49d5d06c4eeaa7fe56ddeef85d34~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=28fW6BcNJglCXO4TFjkHwnwSeQY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-16">ç”³è¯·API Key</h4>
<p>API Keyç”³è¯·åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fampcode.com%2Fsettings" target="_blank" title="https://ampcode.com/settings" ref="nofollow noopener noreferrer">ampcode.com/settings</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d22fb25854948b3ad797b6a43b944af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=3%2BUxcSZvhMkafrLyWgrrdZT0BlU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Amp Codeé»˜è®¤æä¾›äº†API Keyï¼Œç›´æ¥ç‚¹å‡»ã€Copy Keyã€‘å¤åˆ¶API Keyå³å¯</p>
<h4 data-id="heading-17">ç™»å½•æˆæƒ</h4>
<p>Amp Codeæä¾›äº† æ‰‹åŠ¨æˆæƒ å’Œ è‡ªåŠ¨æˆæƒ 2ç§å½¢å¼ï¼Œåœ¨å‘½ä»¤è¡Œç»ˆç«¯è¾“å…¥ /amp å¯åŠ¨CLIï¼Œå¦‚æœç¯å¢ƒå˜é‡æ²¡æœ‰å¯¼å‡ºAPI Keyé»˜è®¤ä¼šæ‹‰èµ·Amp Codeå®˜ç½‘è¿›è¡Œæˆæƒ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/343cfed6a28847bb8d25b2d1092f374b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=Nunj4E0MyUcv0dM%2F9Km55J8X5a0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç‚¹å‡»ã€Link CLIã€‘è¿›è¡Œæˆæƒ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3a9b95dc30eb46ddab7d5893cd9d105f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=BAuAtDSVPjgVdxd3kNTvh3PX2LU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æˆæƒå®Œæˆåï¼Œå°±å¯ä»¥è¿›å…¥Amp Code CLIäº†</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/97709e8cb0d94ff5a0b32278d1f723df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=FmQvm%2B%2BG820EtmOBvvf%2B7vQB350%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è‡ªåŠ¨æˆæƒä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œåªéœ€åœ¨å‘½ä»¤è¡Œç»ˆç«¯å¯¼å‡ºç¯å¢ƒå˜é‡ AMP_API_KEY</p>
<pre><code class="hljs language-ini" lang="ini">$Â exportÂ <span class="hljs-attr">AMP_API_KEY</span>=your api key
</code></pre>
<p>å†è¾“å…¥ amp å¯åŠ¨ Amp Code CLIå³å¯</p>
<h4 data-id="heading-18">å‘½ä»¤è¡Œå‚æ•°</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb9bea251d6c46bd98875fce389f5158~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=UszsCpAxiXAe7itURyJXu2ZtKPM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>logoutï¼šé€€å‡ºå¹¶ç§»é™¤å·²å­˜å‚¨çš„ API å¯†é’¥</li>
<li>loginï¼šç™»å½•åˆ°Amp</li>
<li>threadsï¼šç®¡ç†çº¿ç¨‹</li>
<li>newï¼šåˆ›å»ºæ–°çº¿ç¨‹</li>
<li>continueï¼šç»§ç»­ç°æœ‰çº¿ç¨‹</li>
<li>forkï¼šå¤åˆ»ç°æœ‰çº¿ç¨‹</li>
<li>listï¼šåˆ—å‡ºæ‰€æœ‰çº¿ç¨‹</li>
<li>shareï¼šåˆ†äº«çº¿ç¨‹</li>
<li>renameï¼šé‡å‘½åçº¿ç¨‹</li>
<li>markdownï¼šå°†çº¿ç¨‹æ¸²æŸ“ä¸º Markdown æ ¼å¼</li>
<li>replayï¼šé‡æ”¾çº¿ç¨‹</li>
<li>toolsï¼šå·¥å…·ç®¡ç†å‘½ä»¤
<ul>
<li>listï¼šåˆ—å‡ºæ‰€æœ‰æ´»è·ƒå·¥å…·ï¼ˆåŒ…æ‹¬ MCP å·¥å…·ï¼‰</li>
<li>showï¼šæ˜¾ç¤ºæ´»è·ƒå·¥å…·çš„è¯¦ç»†ä¿¡æ¯</li>
<li>makeï¼šåœ¨ä½ çš„å·¥å…·ç®±ä¸­è®¾ç½®ä¸€ä¸ªå·¥å…·çš„æ¡†æ¶</li>
<li>useï¼šé€šè¿‡å‚æ•°æˆ–æ ‡å‡†è¾“å…¥çš„ JSON è°ƒç”¨å·¥å…·</li>
</ul>
</li>
<li>permissionsï¼šç®¡ç†æƒé™
<ul>
<li>listï¼šåˆ—å‡ºæƒé™</li>
<li>testï¼šæµ‹è¯•æƒé™</li>
<li>editï¼šç¼–è¾‘æƒé™</li>
<li>addï¼šæ·»åŠ æƒé™è§„åˆ™</li>
</ul>
</li>
<li>mcpï¼šç®¡ç† MCP æœåŠ¡å™¨
<ul>
<li>addï¼šæ·»åŠ  MCP æœåŠ¡å™¨é…ç½®</li>
<li>removeï¼šç§»é™¤ MCP æœåŠ¡å™¨é…ç½®</li>
</ul>
</li>
<li>oauthï¼šç®¡ç† MCP æœåŠ¡å™¨çš„ OAuth è®¤è¯
<ul>
<li>loginï¼šä¸º MCP æœåŠ¡å™¨æ³¨å†Œ OAuth å®¢æˆ·ç«¯å‡­è¯</li>
<li>logoutï¼šç§»é™¤ MCP æœåŠ¡å™¨çš„ OAuth å‡­è¯</li>
<li>statusï¼šæ˜¾ç¤º MCP æœåŠ¡å™¨çš„ OAuth çŠ¶æ€</li>
</ul>
</li>
<li>doctorï¼šæ£€æŸ¥ OAuth çŠ¶æ€</li>
<li>updateï¼šæ›´æ–° Amp å‘½ä»¤è¡Œå·¥å…·</li>
</ul>
<h4 data-id="heading-19">äº¤äº’å¼å‘½ä»¤</h4>
<p>ä½¿ç”¨å¿«æ·é”®ã€Ctrl+Oã€‘å¯ä»¥å”¤èµ·äº¤äº’å¼å‘½ä»¤èœå•ï¼Œä½¿ç”¨ä¸Šä¸‹é”®å¯ä»¥å¿«é€Ÿé€‰æ‹©å‘½ä»¤</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/749b8ec4f9e141af98532abc28327dd2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=LAsixFEe9yXxSmLZf45PzHuYFxY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>ampï¼šæŸ¥çœ‹å¸®åŠ©æ–‡æ¡£</li>
<li>modeï¼šåˆ‡æ¢æ¨¡å¼
<ul>
<li>use freeï¼šåˆ‡æ¢åˆ°å…è´¹æ¨¡å¼</li>
<li>use rushï¼šåˆ‡æ¢åˆ°å¿«é€Ÿæ¨¡å¼</li>
<li>use smartï¼šåˆ‡æ¢åˆ°æ™ºèƒ½æ¨¡å¼</li>
<li>setï¼šè®¾ç½®å¿«é€Ÿæˆ–æ™ºèƒ½æ¨¡å¼</li>
<li>toggleï¼šåˆ‡æ¢æ¨¡å¼ï¼Œå¿«æ·é”®ä¸ºã€Ctrl+Sã€‘</li>
</ul>
</li>
<li>threadï¼šç®¡ç†çº¿ç¨‹
<ul>
<li>newï¼šåˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹</li>
<li>switchï¼šåˆ‡æ¢çº¿ç¨‹</li>
<li>set visibilityï¼šè®¾ç½®çº¿ç¨‹å¯è§æ€§</li>
<li>switch to previousï¼šåˆ‡æ¢è‡³ä¸Šä¸€ä¸ª</li>
<li>switch to nextï¼šåˆ‡æ¢è‡³ä¸‹ä¸€ä¸ª</li>
</ul>
</li>
<li>promptï¼šæç¤ºè¯ç®¡ç†
<ul>
<li>open in editorï¼šåœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€</li>
<li>queueï¼šæç¤ºè¯é˜Ÿåˆ—</li>
<li>clearï¼šæ¸…é™¤æç¤ºè¯</li>
<li>paste image from clipboardï¼šä»å‰ªåˆ‡æ¿ç²˜è´´å›¾ç‰‡ï¼Œå¿«æ·é”®ä¸ºã€Ctrl+Vã€‘</li>
<li>mention a threadï¼š@ä¸€ä¸ªæ–‡ä»¶</li>
</ul>
</li>
<li>permissionsï¼šç®¡ç†æƒé™
<ul>
<li>open in editor (user)ï¼šç¼–è¾‘ç”¨æˆ·æƒé™</li>
<li>open in editor (workspace)ï¼šç¼–è¾‘é¡¹ç›®æƒé™</li>
<li>enabledï¼šå…è®¸çš„æƒé™</li>
<li>angerously allow allï¼šå±é™©åœ°å…è®¸æ‰€æœ‰æƒé™</li>
</ul>
</li>
<li>settingsï¼šæ‰“å¼€ CLI è®¾ç½®</li>
<li>agents-mdï¼šagentsç®¡ç†
<ul>
<li>generateï¼šç”Ÿæˆ AGENTS.md æ–‡ä»¶</li>
<li>listï¼šåˆ—å‡ºå½“å‰ä½¿ç”¨çš„æ™ºèƒ½ä½“æŒ‡å—æ–‡ä»¶</li>
</ul>
</li>
<li>mcpï¼šMCPç®¡ç†
<ul>
<li>list toolsï¼šæŸ¥çœ‹mcpå·¥å…·</li>
<li>statusï¼šæŸ¥çœ‹mcpçŠ¶æ€</li>
</ul>
</li>
<li>ideï¼šè¿æ¥åˆ° IDE</li>
<li>amp quiteï¼šé€€å‡ºåº”ç”¨ç¨‹åº</li>
</ul>
<h4 data-id="heading-20">æ‰§è¡ŒShell</h4>
<p>åœ¨Amp Code CLIä¸­è¾“å…¥ $ å¯ä»¥è¿›å…¥Shellæ¨¡å¼ï¼Œè¾“å…¥ç»ˆç«¯å‘½ä»¤å¯ä»¥ç›´æ¥æ‰§è¡Œ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/56ba9e1f7ed24cc6888eb36f52299fa3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=EMet5X5x81NsaJbJPnDTfHktdZI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a4602e946084342b363666a7e9f4b7b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=MHrR1qfc9qpYk2pSiCQ7R9CmTFA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-21">Chatå¯¹è¯</h4>
<p>Amp Code CLIæä¾›äº† smartã€rush å’Œ free 3 ç§å¯¹è¯æ¨¡å¼ï¼Œä½¿ç”¨å¿«æ·é”®ã€Ctrl+Sã€‘å¿«é€Ÿåˆ‡æ¢</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14a6594607ac41b7a6fb9ef12879aff1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=XLIWX3AeKmnLqoLYbjHUlpfyZiQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>smart: ä½¿ç”¨æœ€å…ˆè¿›çš„æ¨¡å‹ï¼Œä¸å—æœ€å¤§èƒ½åŠ›å’Œè‡ªä¸»æƒçš„é™åˆ¶ã€‚è¿™æ˜¯é»˜è®¤æ¨¡å¼ï¼Œä½¿ç”¨ä»˜è´¹ç§¯åˆ†</li>
<li>rush: æ›´å¿«ã€æ›´ä¾¿å®œã€åŠŸèƒ½æ›´å¼±ï¼Œé€‚åˆå°å‹ã€å®šä¹‰æ˜ç¡®çš„ä»»åŠ¡</li>
<li>free: å…è´¹ï¼Œä½¿ç”¨å¿«é€ŸåŸºæœ¬æ¨¡å‹ï¼Œå…è´¹</li>
</ul>
<p>è¾“å…¥ @ å¯ä»¥æ·»åŠ æ–‡ä»¶ä¸Šä¸‹æ–‡</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9335d1dc52a84fcb93f565e4ec6f1384~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=Q5p2Df4otUIogy6HC3bmTDfrYQA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¾“å…¥ / å¯ä»¥å”¤èµ·å†…ç½®å‘½ä»¤</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df6ac4bb5a9040cd8c0b033383ea0df3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=5HjKA2Dye4Pljb9b7uoY8isXFhY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å®Œæˆå¯¹è¯åï¼ŒåŒæ ·å¯ä»¥çœ‹åˆ°åœ¨å¯¹è¯æ¡†ä¸Šæ–¹çš„å¹¿å‘Šä¿¡æ¯</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd1c13777ba44d4b81ea8e3a584d3c79~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=FHlpA77kXDM9F4iKOgjJP4d4T3g%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-22">ä¸Šä¸‹æ–‡</h4>
<p>åœ¨äº¤äº’å¼å‘½ä»¤ä¸­è¾“å…¥ / å”¤èµ·å¿«æ·èœå•ï¼Œä½¿ç”¨ã€agents-md generateã€‘ç”Ÿæˆä¸Šä¸‹æ–‡æ–‡ä»¶</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/028ea9839929462692f749ff850dfe26~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=9JFvalqZAn7Ga9lS9fw4P2gbeME%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ‰§è¡Œå®Œæˆåï¼ŒAmp Code CLIä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º AGENTS.md æ–‡ä»¶ï¼Œåœ¨ AGENTS.md ä¸­å¯ä»¥ç¼–å†™æˆ‘ä»¬çš„ä¸Šä¸‹æ–‡æç¤º</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f9c137c3cf2426c8a6f930626770dcb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=7khTXDghdFFhHK%2F0FJxG9IhGA4M%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-23">MCPæœåŠ¡</h4>
<p>Amp Code CLIæ”¯æŒMCPæœåŠ¡ï¼Œå¯ä»¥åˆ†ä¸º å…¨å±€ç”¨æˆ·çº§ å’Œ é¡¹ç›®çº§ 2ç§é…ç½®ç­‰çº§</p>
<ul>
<li>å…¨å±€ç”¨æˆ·çº§ï¼šé’ˆå¯¹å½“å‰ç”¨æˆ·ç”Ÿæ•ˆï¼Œé…ç½®è·¯å¾„ï¼š~/.config/amp/settings.json</li>
<li>é¡¹ç›®çº§ï¼šé’ˆå¯¹å½“å‰é¡¹ç›®ç”Ÿæ•ˆï¼Œé…ç½®è·¯å¾„ï¼š.amp/settings.json</li>
</ul>
<p>MCPå¯ä»¥é€šè¿‡å‘½ä»¤æŒ‡ä»¤æ·»åŠ ï¼Œé»˜è®¤å®‰è£…çš„ä¸ºå…¨å±€ç”¨æˆ·çº§</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-variable">$Â </span>amp mcp add context7 -- npx -y <span class="hljs-variable">@upstash</span>/context7-mcp
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/38e7b39fe2184cc7bb6c0aba8b8d6258~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=Thh8Jn5Mi2EnJAsIhatcHs9ylQw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é€šè¿‡æ·»åŠ  --workspace æ ‡è¯†ï¼Œå¯ä»¥ä¸ºé¡¹ç›®çº§é…ç½®</p>
<pre><code class="hljs language-css" lang="css">$Â amp mcp add context7 <span class="hljs-attr">--workspace</span> -- npx -y <span class="hljs-keyword">@upstash</span>/context7-mcp
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/272d0e59faf1435b8d05b1c95ff8854b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=xteLs4%2BRGwOG1KmztY18JzmI7%2BQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ¨äº¤äº’å¼å‘½ä»¤ä¸­è¾“å…¥ / é€‰æ‹© mcp status æŒ‡ä»¤å¯ä»¥æŸ¥çœ‹MCPçŠ¶æ€</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6efaa0c0b22848f1b8cd921ef37dc821~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=J90JEM87nGmqxOqm8sCBxonZ%2Bb8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ¨äº¤äº’å¼å‘½ä»¤ä¸­è¾“å…¥ / é€‰æ‹© mcp list tools æŒ‡ä»¤å¯ä»¥æŸ¥çœ‹å¯ç”¨çš„MCPå·¥å…·</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c51a51a695f441279b6f1c23cc600258~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=LnVXlYFhP8yZG9IFOzqNa7m4HdU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹å¯¹åº”çš„ settings.json æ–‡ä»¶è¿›è¡Œé…ç½®</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a10269fc44f4635ac303de62b416237~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=2x%2B2xK9t8AgivFb7Vnl8ph3MGVs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-24">äº§å“å®šä»·</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8865083ac91c4dbc86794b9e8dfa0dfb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766290094&amp;x-signature=R1PyF%2Fy%2Bu34GjG%2B%2FPQBbXJvYmC4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æä¾› å…è´¹ç‰ˆã€ä»˜è´¹ç‰ˆ å’Œ ä¼ä¸šç‰ˆ</p>
<ul>
<li>å…è´¹ç‰ˆï¼šå®Œå…¨å…è´¹ï¼Œé å¹¿å‘Šç»´æŒè¿è¥</li>
<li>ä»˜è´¹ç‰ˆï¼šæŒ‰ä½¿ç”¨é‡è®¡è´¹</li>
<li>ä¼ä¸šç‰ˆï¼šé¢åº¦æ›´é«˜ï¼Œæä¾›çš„æœåŠ¡æ›´å¤š</li>
</ul>
<h2 data-id="heading-25">å‹æƒ…æç¤º</h2>
<p>è§åŸæ–‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F2bwTXyhx7jNkEa2vPMm2tQ" target="_blank" title="https://mp.weixin.qq.com/s/2bwTXyhx7jNkEa2vPMm2tQ" ref="nofollow noopener noreferrer">åˆè¯†Amp Code</a></p>
<blockquote>
<p>æœ¬æ–‡åŒæ­¥è‡ªå¾®ä¿¡å…¬ä¼—å· "<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F2bwTXyhx7jNkEa2vPMm2tQ" target="_blank" title="https://mp.weixin.qq.com/s/2bwTXyhx7jNkEa2vPMm2tQ" ref="nofollow noopener noreferrer">ç¨‹åºå‘˜å°æºª</a>" ï¼Œè¿™é‡Œåªæ˜¯åŒæ­¥ï¼Œæƒ³çœ‹åŠæ—¶æ¶ˆæ¯è¯·ç§»æ­¥æˆ‘çš„å…¬ä¼—å·ï¼Œä¸å®šæ—¶æ›´æ–°æˆ‘çš„å­¦ä¹ ç»éªŒã€‚å‹æƒ…æç¤ºå‹æƒ…æç¤º</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Macå¿…å¤‡æŠ€å·§ï¼šä½¿ç”¨ treeå‘½ä»¤å¿«é€ŸæŸ¥çœ‹ç›®å½•ç»“æ„]]></title>    <link>https://juejin.cn/post/7583158173978361866</link>    <guid>https://juejin.cn/post/7583158173978361866</guid>    <pubDate>2025-12-14T04:14:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583158173978361866" data-draft-id="7583158173978345482" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Macå¿…å¤‡æŠ€å·§ï¼šä½¿ç”¨ treeå‘½ä»¤å¿«é€ŸæŸ¥çœ‹ç›®å½•ç»“æ„"/> <meta itemprop="keywords" content="åç«¯,Go,Trae"/> <meta itemprop="datePublished" content="2025-12-14T04:14:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜çˆ±é’“é±¼"/> <meta itemprop="url" content="https://juejin.cn/user/2799775299157614"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Macå¿…å¤‡æŠ€å·§ï¼šä½¿ç”¨ treeå‘½ä»¤å¿«é€ŸæŸ¥çœ‹ç›®å½•ç»“æ„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2799775299157614/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜çˆ±é’“é±¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T04:14:27.000Z" title="Sun Dec 14 2025 04:14:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åœ¨æ—¥å¸¸å¼€å‘å’Œç®¡ç†æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦å¿«é€ŸæŸ¥çœ‹ç›®å½•ç»“æ„ï¼Œå°¤å…¶æ˜¯å¤„ç† Hugoã€WordPress æˆ–å…¶ä»–é™æ€ç«™ç‚¹é¡¹ç›®æ—¶ï¼Œç›®å½•å±‚çº§å¤æ‚ï¼Œå¾ˆå®¹æ˜“è¿·è·¯ã€‚macOS ç³»ç»Ÿè‡ªå¸¦çš„ Finder å¯ä»¥å›¾å½¢åŒ–æŸ¥çœ‹æ–‡ä»¶ï¼Œä½†<strong>åœ¨ç»ˆç«¯ä¸­ä»¥æ ‘çŠ¶ç»“æ„æŸ¥çœ‹ç›®å½•æ›´ç›´è§‚ã€æ›´æ–¹ä¾¿å¯¼å‡º</strong>ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•åœ¨ Mac ä¸Šä½¿ç”¨ <code>tree</code> å‘½ä»¤æ¥è¾“å‡ºç›®å½•ç»“æ„ï¼Œå¹¶åˆ†äº«ä¸€äº›å®ç”¨æŠ€å·§ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">1ï¸ã€å®‰è£… tree</h2>
<p>macOS é»˜è®¤æ²¡æœ‰å®‰è£… <code>tree</code> å‘½ä»¤ï¼Œä½†å¯ä»¥é€šè¿‡ Homebrew å¿«é€Ÿå®‰è£…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">brew install tree
</code></pre>
<p>å®‰è£…å®Œæˆåï¼Œåœ¨ç»ˆç«¯è¾“å…¥ <code>tree</code> å°±å¯ä»¥ä½¿ç”¨äº†ã€‚</p>
<hr/>
<h2 data-id="heading-1">2ï¸ã€åŸºæœ¬ç”¨æ³•</h2>
<p>è¿›å…¥ä½ æƒ³æŸ¥çœ‹çš„ç›®å½•ï¼Œä¾‹å¦‚ Hugo é¡¹ç›®çš„ <code>content</code> ç›®å½•ï¼Œç„¶åè¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">tree
</code></pre>
<p>è¾“å‡ºç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-css" lang="css">.
â”œâ”€â”€ de
â”‚   â”œâ”€â”€ <span class="hljs-selector-tag">article</span>
â”‚   â”œâ”€â”€ categories
â”‚   â””â”€â”€ tags
â”œâ”€â”€ en
â”‚   â”œâ”€â”€ <span class="hljs-selector-tag">article</span>
â”‚   â”œâ”€â”€ categories
â”‚   â””â”€â”€ tags
â””â”€â”€ fr
    â”œâ”€â”€ <span class="hljs-selector-tag">article</span>
    â”œâ”€â”€ categories
    â””â”€â”€ tags
</code></pre>
<p>ä»ä¸Šé¢çš„è¾“å‡ºå¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°é¡¹ç›®çš„å¤šè¯­è¨€ç›®å½•ç»“æ„ï¼Œæ¯ä¸ªä¸€çº§ç›®å½•å°±æ˜¯ä¸€ä¸ªè¯­è¨€ç‰ˆæœ¬ã€‚</p>
<hr/>
<h2 data-id="heading-2">3ï¸ã€å¸¸ç”¨å‚æ•°</h2>
<p><code>tree</code> å‘½ä»¤æä¾›äº†å¾ˆå¤šå®ç”¨é€‰é¡¹ï¼Œå¯ä»¥å¸®åŠ©ä½ å®šåˆ¶è¾“å‡ºï¼š</p>
<ul>
<li><strong>æ˜¾ç¤ºæŒ‡å®šå±‚çº§</strong></li>
</ul>
<pre><code class="hljs language-bash" lang="bash">tree -L 2
</code></pre>
<p>è¡¨ç¤ºåªæ˜¾ç¤ºä¸¤å±‚ç›®å½•ï¼Œé¿å…ç›®å½•å¤ªæ·±æ—¶è¾“å‡ºè¿‡é•¿ã€‚</p>
<ul>
<li><strong>æ˜¾ç¤ºéšè—æ–‡ä»¶</strong></li>
</ul>
<pre><code class="hljs language-bash" lang="bash">tree -a
</code></pre>
<p>ä¼šåˆ—å‡ºä»¥ <code>.</code> å¼€å¤´çš„éšè—æ–‡ä»¶ï¼Œä¾‹å¦‚ <code>.git</code>ã€‚</p>
<ul>
<li><strong>åªæ˜¾ç¤ºç›®å½•</strong></li>
</ul>
<pre><code class="hljs language-bash" lang="bash">tree -d
</code></pre>
<p>åªè¾“å‡ºç›®å½•å±‚çº§ï¼Œä¸æ˜¾ç¤ºæ–‡ä»¶ã€‚</p>
<ul>
<li><strong>å¿½ç•¥æŸäº›ç›®å½•</strong></li>
</ul>
<pre><code class="hljs language-bash" lang="bash">tree -I <span class="hljs-string">"node_modules|public"</span>
</code></pre>
<p>å¿½ç•¥é¡¹ç›®ä¸­çš„ <code>node_modules</code> å’Œ <code>public</code> ç›®å½•ï¼Œè¾“å‡ºæ›´æ¸…çˆ½ã€‚</p>
<hr/>
<h2 data-id="heading-3">4ï¸ã€å¯¼å‡ºç›®å½•ç»“æ„åˆ°æ–‡ä»¶</h2>
<p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦æŠŠç›®å½•ç»“æ„åˆ†äº«ç»™åŒäº‹æˆ–è®°å½•æ–‡æ¡£ï¼Œå¯ä»¥å°†è¾“å‡ºä¿å­˜åˆ°æ–‡æœ¬æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">tree -L 4 &gt; structure.txt
</code></pre>
<p>æˆ–è€…å¿½ç•¥ä¸å¿…è¦çš„æ–‡ä»¶å¤¹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">tree -L 4 -I <span class="hljs-string">"node_modules|public|resources"</span> &gt; structure.txt
</code></pre>
<p>è¿™æ ·å°±å¯ä»¥ç”Ÿæˆä¸€ä¸ªæ¼‚äº®çš„ç›®å½•æ ‘æ–‡æœ¬ï¼Œä¾¿äºå‘é€æˆ–å½’æ¡£ã€‚</p>
<hr/>
<h2 data-id="heading-4">5ï¸ã€Hugo é¡¹ç›®å®ç”¨ç¤ºä¾‹</h2>
<p>ä»¥ Hugo æ–°é—»ç«™ä¸ºä¾‹ï¼Œé¡¹ç›® <code>content</code> ç›®å½•å¤šè¯­è¨€ç»“æ„å¯èƒ½å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-attribute">content</span>/
â”œâ”€â”€ de
â”‚   â”œâ”€â”€ <span class="hljs-selector-tag">article</span>
â”‚   â”œâ”€â”€ categories
â”‚   â””â”€â”€ tags
â”œâ”€â”€ en
â”‚   â”œâ”€â”€ <span class="hljs-selector-tag">article</span>
â”‚   â”œâ”€â”€ categories
â”‚   â””â”€â”€ tags
â””â”€â”€ fr
    â”œâ”€â”€ <span class="hljs-selector-tag">article</span>
    â”œâ”€â”€ categories
    â””â”€â”€ tags
</code></pre>
<p>ä½¿ç”¨å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">tree -L 3 content
</code></pre>
<p>å³å¯å¿«é€ŸæŸ¥çœ‹æ¯ä¸ªè¯­è¨€ä¸‹çš„æ–‡ç« ã€åˆ†ç±»å’Œæ ‡ç­¾ç›®å½•ï¼Œéå¸¸ç›´è§‚ã€‚</p>
<hr/>
<h2 data-id="heading-5">6ï¸ã€å°æŠ€å·§</h2>
<ul>
<li><strong>é…åˆ <code>grep</code> æœç´¢æ–‡ä»¶ç±»å‹</strong></li>
</ul>
<pre><code class="hljs language-bash" lang="bash">tree -f | grep <span class="hljs-string">".md"</span>
</code></pre>
<p>å¯ä»¥åˆ—å‡ºé¡¹ç›®ä¸­æ‰€æœ‰ Markdown æ–‡ä»¶ã€‚</p>
<ul>
<li><strong>ç¾åŒ–è¾“å‡º</strong>
å®‰è£… <code>tree</code> åï¼Œç»ˆç«¯ä¸­å¯ä»¥ä½¿ç”¨å½©è‰²è¾“å‡ºï¼š</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">tree -C
</code></pre>
<ul>
<li><strong>ç»“åˆ Hugo è‡ªåŠ¨åŒ–</strong>
åœ¨ Hugo é¡¹ç›®ä¸­ï¼Œå¯ä»¥æŠŠç›®å½•ç»“æ„è¾“å‡ºä½œä¸ºæ–‡æ¡£è¯´æ˜æˆ– sitemap è¾…åŠ©æ–‡ä»¶ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-6">æ€»ç»“</h2>
<p><code>tree</code> å‘½ä»¤æ˜¯ Mac ç»ˆç«¯ä¸­éå¸¸å®ç”¨çš„å·¥å…·ï¼Œå°¤å…¶åœ¨å¤„ç†å¤šè¯­è¨€ Hugo é¡¹ç›®ã€åšå®¢ã€ç½‘ç«™å¼€å‘æ—¶ï¼Œå¯ä»¥å¿«é€ŸæŸ¥çœ‹ç›®å½•ç»“æ„ã€å¯¼å‡ºç›®å½•ã€æ’æŸ¥é—®é¢˜ã€‚æŒæ¡ä¸€äº›å‚æ•°ï¼Œè¿˜èƒ½æå‡å·¥ä½œæ•ˆç‡ï¼Œè®©ä½ å¯¹é¡¹ç›®ç»“æ„ä¸€ç›®äº†ç„¶ã€‚</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Java 21æ–°ç‰¹æ€§å®æˆ˜ï¼šè¿™5ä¸ªæ”¹è¿›è®©æˆ‘çš„ä»£ç æ•ˆç‡æå‡40%]]></title>    <link>https://juejin.cn/post/7582922476223217679</link>    <guid>https://juejin.cn/post/7582922476223217679</guid>    <pubDate>2025-12-14T04:17:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582922476223217679" data-draft-id="7582922476223201295" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Java 21æ–°ç‰¹æ€§å®æˆ˜ï¼šè¿™5ä¸ªæ”¹è¿›è®©æˆ‘çš„ä»£ç æ•ˆç‡æå‡40%"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-14T04:17:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Java 21æ–°ç‰¹æ€§å®æˆ˜ï¼šè¿™5ä¸ªæ”¹è¿›è®©æˆ‘çš„ä»£ç æ•ˆç‡æå‡40%
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T04:17:06.000Z" title="Sun Dec 14 2025 04:17:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>Java 21æ–°ç‰¹æ€§å®æˆ˜ï¼šè¿™5ä¸ªæ”¹è¿›è®©æˆ‘çš„ä»£ç æ•ˆç‡æå‡40%</strong></h2>
<h3 data-id="heading-1">å¼•è¨€</h3>
<p>Java 21ä½œä¸ºæœ€æ–°çš„LTSï¼ˆé•¿æœŸæ”¯æŒï¼‰ç‰ˆæœ¬ï¼Œäº2023å¹´9æœˆæ­£å¼å‘å¸ƒã€‚å®ƒä¸ä»…å»¶ç»­äº†Javaå¹³å°ä¸€è´¯çš„ç¨³å®šæ€§å’Œé«˜æ€§èƒ½ï¼Œè¿˜å¼•å…¥äº†å¤šé¡¹ä»¤äººå…´å¥‹çš„æ–°ç‰¹æ€§ã€‚ä½œä¸ºä¸€åé•¿æœŸä½¿ç”¨Javaçš„å¼€å‘äººå‘˜ï¼Œæˆ‘åœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨äº†è¿™äº›æ–°ç‰¹æ€§åå‘ç°ï¼Œä»£ç æ•ˆç‡æå‡äº†è¿‘40%ã€‚æœ¬æ–‡å°†é‡ç‚¹ä»‹ç»å¯¹æˆ‘å½±å“æœ€å¤§çš„5ä¸ªæ”¹è¿›ï¼Œå¹¶é€šè¿‡å®é™…ä»£ç ç¤ºä¾‹å±•ç¤ºå®ƒä»¬å¦‚ä½•ä¼˜åŒ–å¼€å‘ä½“éªŒå’Œæ€§èƒ½ã€‚</p>
<h3 data-id="heading-2">ä¸»ä½“</h3>
<h4 data-id="heading-3">1. è™šæ‹Ÿçº¿ç¨‹ï¼ˆVirtual Threadsï¼‰â€”â€”è½»é‡çº§å¹¶å‘çš„é©å‘½</h4>
<p>è™šæ‹Ÿçº¿ç¨‹æ˜¯Java 21ä¸­æœ€ä¸ºç©ç›®çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œå®ƒé€šè¿‡JEP 444æ­£å¼æˆä¸ºæ ‡å‡†åŠŸèƒ½ã€‚è™šæ‹Ÿçº¿ç¨‹æ˜¯ä¸€ç§ç”±JVMç®¡ç†çš„è½»é‡çº§çº¿ç¨‹ï¼Œæ˜¾è‘—é™ä½äº†åˆ›å»ºå’Œè°ƒåº¦çº¿ç¨‹çš„å¼€é”€ã€‚ä¼ ç»Ÿå¹³å°çº¿ç¨‹ï¼ˆOSçº¿ç¨‹ï¼‰åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ä¼šé¢ä¸´èµ„æºç“¶é¢ˆï¼Œè€Œè™šæ‹Ÿçº¿ç¨‹å¯ä»¥è½»æ¾åˆ›å»ºæ•°ç™¾ä¸‡ä¸ªå®ä¾‹ã€‚</p>
<p><strong>å®æˆ˜ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">try</span> (<span class="hljs-type">var</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newVirtualThreadPerTaskExecutor()) {
    IntStream.range(<span class="hljs-number">0</span>, <span class="hljs-number">10_000</span>).forEach(i -&gt; {
        executor.submit(() -&gt; {
            Thread.sleep(Duration.ofSeconds(<span class="hljs-number">1</span>));
            System.out.println(i);
            <span class="hljs-keyword">return</span> i;
        });
    });
}
</code></pre>
<p>è¿™æ®µä»£ç åˆ›å»ºäº†10,000ä¸ªè™šæ‹Ÿçº¿ç¨‹ï¼Œè€Œæ— éœ€æ‹…å¿ƒä¼ ç»Ÿçº¿ç¨‹æ± çš„èµ„æºè€—å°½é—®é¢˜ã€‚åœ¨æˆ‘çš„ä¸€ä¸ªHTTPæœåŠ¡é¡¹ç›®ä¸­ï¼Œä½¿ç”¨è™šæ‹Ÿçº¿ç¨‹åï¼Œååé‡æå‡äº†35%ï¼ŒåŒæ—¶ä»£ç æ›´ç®€æ´ã€‚</p>
<h4 data-id="heading-4">2. æ¨¡å¼åŒ¹é…çš„å¢å¼ºï¼ˆPattern Matching for Switchï¼‰â€”â€”æ›´ç®€æ´çš„åˆ†æ”¯é€»è¾‘</h4>
<p>Java 21è¿›ä¸€æ­¥å®Œå–„äº†æ¨¡å¼åŒ¹é…åŠŸèƒ½ï¼ˆJEP 441ï¼‰ï¼Œä½¿å¾—<code>switch</code>è¯­å¥å¯ä»¥æ›´çµæ´»åœ°å¤„ç†å¤æ‚æ¡ä»¶ã€‚ç°åœ¨å¯ä»¥ç›´æ¥åœ¨<code>case</code>ä¸­åŒ¹é…ç±»å‹ã€è§£æ„è®°å½•ï¼ˆRecordï¼‰ç”šè‡³åµŒå¥—æ¨¡å¼ã€‚</p>
<p><strong>å®æˆ˜ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">record</span> <span class="hljs-title class_">Point</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span> {}

<span class="hljs-keyword">static</span> String <span class="hljs-title function_">describe</span><span class="hljs-params">(Object obj)</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">switch</span> (obj) {
        <span class="hljs-keyword">case</span> <span class="hljs-title function_">Point</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span> when x == y -&gt; <span class="hljs-string">"Point on diagonal"</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-title function_">Point</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span> -&gt; <span class="hljs-string">"Regular point"</span>;
        <span class="hljs-keyword">case</span> String s -&gt; <span class="hljs-string">"String of length "</span> + s.length();
        <span class="hljs-keyword">default</span> -&gt; <span class="hljs-string">"Unknown"</span>;
    };
}
</code></pre>
<p>è¿™ç§å†™æ³•å¤§å¹…å‡å°‘äº†æ¨¡æ¿ä»£ç ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤æ‚æ•°æ®ç»“æ„æ—¶ã€‚æˆ‘çš„ä¸€ä¸ªæ•°æ®å¤„ç†æ¨¡å—é€šè¿‡é‡æ„ä¸ºæ¨¡å¼åŒ¹é…åï¼Œä»£ç è¡Œæ•°å‡å°‘äº†30%ã€‚</p>
<h4 data-id="heading-5">3. å­—ç¬¦ä¸²æ¨¡æ¿ï¼ˆString Templatesï¼‰â€”â€”å‘Šåˆ«ç¹ççš„æ‹¼æ¥</h4>
<p>å­—ç¬¦ä¸²æ¨¡æ¿ï¼ˆJEP 430é¢„è§ˆç‰ˆï¼‰æ˜¯å¦ä¸€ä¸ªå®ç”¨æ€§æå¼ºçš„ç‰¹æ€§ã€‚å®ƒå…è®¸åœ¨å­—ç¬¦ä¸²ä¸­ç›´æ¥åµŒå…¥è¡¨è¾¾å¼ï¼Œé¿å…æ‰‹åŠ¨æ‹¼æ¥æˆ–ä½¿ç”¨<code>String.format()</code>çš„ç¹çæ“ä½œã€‚</p>
<p><strong>å®æˆ˜ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">"Alice"</span>;
<span class="hljs-type">int</span> <span class="hljs-variable">age</span> <span class="hljs-operator">=</span> <span class="hljs-number">30</span>;
<span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> STR.<span class="hljs-string">"Hello \{name}, you are \{age} years old."</span>;
</code></pre>
<p>è¿™ä¸ä»…æé«˜äº†å¯è¯»æ€§ï¼Œè¿˜å‡å°‘äº†é”™è¯¯æ¦‚ç‡ã€‚åœ¨æˆ‘çš„æ—¥å¿—æ¨¡å—ä¸­ï¼Œå­—ç¬¦ä¸²æ¨¡æ¿è®©æ—¥å¿—æ ¼å¼åŒ–ä»£ç æ›´åŠ ç›´è§‚ä¸”æ˜“äºç»´æŠ¤ã€‚</p>
<h4 data-id="heading-6">4. Sequenced Collectionsâ€”â€”ç»Ÿä¸€çš„é›†åˆæ¥å£</h4>
<p>Java 21å¼•å…¥äº†Sequenced Collectionsï¼ˆJEP 431ï¼‰ï¼Œä¸ºæœ‰åºé›†åˆï¼ˆå¦‚<code>List</code>ã€<code>Deque</code>ï¼‰æ·»åŠ äº†ä¸€ç»„ç»Ÿä¸€çš„æ“ä½œæ–¹æ³•ï¼Œä¾‹å¦‚<code>getFirst()</code>ã€<code>getLast()</code>å’Œ<code>reversed()</code>ã€‚è¿™ä¸€æ”¹è¿›ä½¿å¾—æ“ä½œé›†åˆçš„é¦–å°¾å…ƒç´ æ›´åŠ æ–¹ä¾¿ã€‚</p>
<p><strong>å®æˆ˜ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java">List&lt;Integer&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(List.of(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>));
System.out.println(list.getFirst()); <span class="hljs-comment">// 1</span>
System.out.println(list.reversed()); <span class="hljs-comment">// [3, 2, 1]</span>
</code></pre>
<p>åœ¨æˆ‘çš„ä¸€ä¸ªç¼“å­˜å®ç°ä¸­ï¼Œä½¿ç”¨<code>reversed()</code>æ–¹æ³•æ›¿ä»£æ‰‹åŠ¨å€’åºæ“ä½œåï¼Œæ€§èƒ½æå‡äº†çº¦10%ã€‚</p>
<h4 data-id="heading-7">5. Record Patternsâ€”â€”æ›´ä¼˜é›…çš„æ•°æ®è§£æ„</h4>
<p>Record Patternsï¼ˆJEP 440ï¼‰è¿›ä¸€æ­¥æ‰©å±•äº†è®°å½•ç±»çš„å®ç”¨æ€§ï¼Œå…è®¸åœ¨æ¨¡å¼åŒ¹é…ä¸­ç›´æ¥è§£æ„è®°å½•å¯¹è±¡ã€‚è¿™ä¸€ç‰¹æ€§ä¸æ¨¡å¼åŒ¹é…ç»“åˆåï¼Œä½¿å¾—æ•°æ®å¤„ç†ä»£ç æ›´åŠ ç®€æ´é«˜æ•ˆã€‚</p>
<p><strong>å®æˆ˜ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">record</span> <span class="hljs-title class_">User</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age)</span> {}

<span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processUser</span><span class="hljs-params">(Object obj)</span> {
    <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> <span class="hljs-title function_">User</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age)</span>) {
        System.out.println(<span class="hljs-string">"User: "</span> + name + <span class="hljs-string">", age: "</span> + age);
    }
}
</code></pre>
<p>åœ¨å¤„ç†JSONæˆ–æ•°æ®åº“æŸ¥è¯¢ç»“æœæ—¶ï¼ŒRecord Patternsæ˜¾è‘—å‡å°‘äº†æ ·æ¿ä»£ç é‡ã€‚æˆ‘çš„ä¸€ä¸ªæ•°æ®è§£ææ¨¡å—é€šè¿‡è¿™ä¸€æ”¹è¿›å‡å°‘äº†20%çš„é‡å¤ä»£ç ã€‚</p>
<h3 data-id="heading-8">æ€»ç»“</h3>
<p>Java 21çš„è¿™äº›æ–°ç‰¹æ€§ä¸ä»…ä»…æ˜¯è¯­æ³•ç³–ï¼Œè€Œæ˜¯ä»å¹¶å‘ã€æ•°æ®æ“ä½œåˆ°ä»£ç å¯è¯»æ€§ç­‰å¤šä¸ªç»´åº¦å¯¹å¼€å‘ä½“éªŒçš„å…¨é¢æå‡ã€‚è™šæ‹Ÿçº¿ç¨‹è§£å†³äº†é«˜å¹¶å‘åœºæ™¯çš„æ€§èƒ½ç“¶é¢ˆï¼›æ¨¡å¼åŒ¹é…å’ŒRecord Patternsç®€åŒ–äº†å¤æ‚é€»è¾‘ï¼›å­—ç¬¦ä¸²æ¨¡æ¿å’ŒSequenced Collectionsåˆ™è®©æ—¥å¸¸ç¼–ç æ›´åŠ é«˜æ•ˆä¼˜é›…ã€‚è¿™äº›æ”¹è¿›å…±åŒä½œç”¨åï¼Œæˆ‘çš„é¡¹ç›®ä»£ç æ•ˆç‡æå‡äº†40%ï¼ŒåŒæ—¶ä¹Ÿé™ä½äº†ç»´æŠ¤æˆæœ¬ã€‚å¦‚æœä½ å°šæœªå°è¯•Java 21ï¼Œç°åœ¨æ­£æ˜¯å‡çº§çš„æœ€ä½³æ—¶æœºï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è®°å½•ä¸€ä¸ªTypescriptçš„IoCå®¹å™¨çš„å®ç°]]></title>    <link>https://juejin.cn/post/7582951344517267462</link>    <guid>https://juejin.cn/post/7582951344517267462</guid>    <pubDate>2025-12-14T04:00:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582951344517267462" data-draft-id="7583139562752802858" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è®°å½•ä¸€ä¸ªTypescriptçš„IoCå®¹å™¨çš„å®ç°"/> <meta itemprop="keywords" content="TypeScript"/> <meta itemprop="datePublished" content="2025-12-14T04:00:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ†§æ†¬å°‘"/> <meta itemprop="url" content="https://juejin.cn/user/2374569069387223"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è®°å½•ä¸€ä¸ªTypescriptçš„IoCå®¹å™¨çš„å®ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2374569069387223/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ†§æ†¬å°‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T04:00:06.000Z" title="Sun Dec 14 2025 04:00:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‰æ®µæ—¶é—´åœ¨å†™ä¸€ä¸ªç©Minecraftæ¸¸æˆçš„Agenté¡¹ç›®<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FMai-with-u%2Fmaicraft-next" target="_blank" title="https://github.com/Mai-with-u/maicraft-next" ref="nofollow noopener noreferrer">maicraft-next</a> ï¼Œå®ƒæ˜¯åŸpythoné¡¹ç›®<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FMai-with-u%2FMaicraft" target="_blank" title="https://github.com/Mai-with-u/Maicraft" ref="nofollow noopener noreferrer">maicraft</a>çš„typescripté‡æ„ã€‚åŸé¡¹ç›®ä¸­å„ç§ç»„ä»¶çš„ä¾èµ–å·²ç»éå¸¸å¤æ‚äº†ï¼Œäºæ˜¯é‡æ„çš„æ—¶å€™å°±æ‰“ç®—å¼•å…¥ç±»ä¼¼Java Springä¸€æ ·çš„IoCçš„å®ç°ã€‚</p>
<p>ä¸ºäº†å­¦ä¹ ç›¸å…³çš„æ¦‚å¿µå’Œå®ç°ï¼Œæˆ‘å¹¶æ²¡æœ‰å¼•å…¥ç¬¬ä¸‰æ–¹çš„ç°æˆçš„æ¡†æ¶ï¼Œè€Œæ˜¯å’ŒCursor åŠ Claude Sonnet 4.5åä½œå†™äº†ä¸€å¥—è½»é‡åŒ–çš„IoCå®¹å™¨ã€‚æœ¬æ–‡è®°å½•ä¸‹è¿™ä¸ªå®ç°ï¼Œæ–¹ä¾¿åç»­å›çœ‹ã€‚</p>

<h2 data-id="heading-0">1. æ¦‚è¿°</h2>
<p>åœ¨åç«¯å¼€å‘ä¸­ï¼Œä¼ ç»Ÿæ¨¡å¼ä¸‹ç»„ä»¶éœ€è‡ªå·±é€šè¿‡<code>new</code>åˆ›å»ºä¾èµ–å¯¹è±¡ï¼Œå¯¼è‡´ä»£ç ç´§è€¦åˆã€‚ä¸ºè§£å†³è¿™ä¸€é—®é¢˜ï¼Œæœ‰äº†<strong>IoCï¼ˆæ§åˆ¶åè½¬ï¼‰è®¾è®¡æ€æƒ³</strong>â€”â€”æŠŠâ€œåˆ›å»ºã€ç®¡ç†ä¾èµ–â€çš„æ§åˆ¶æƒä»ç»„ä»¶è½¬ç§»åˆ°ç¬¬ä¸‰æ–¹ï¼›</p>
<p>è€Œ<strong>ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰</strong> æ˜¯å®ç°IoCæœ€ä¸»æµçš„æ–¹å¼ï¼Œå³ç¬¬ä¸‰æ–¹ä¸»åŠ¨åˆ›å»ºä¾èµ–å¯¹è±¡ï¼Œé€šè¿‡æ„é€ å™¨ã€Setterç­‰æ–¹å¼â€œæ³¨å…¥â€ç»™ç»„ä»¶ï¼›æˆ‘ä»¬å¸¸è¯´çš„IoCå®¹å™¨ï¼ˆå¦‚Springçš„<code>ApplicationContext</code>ï¼‰ï¼Œåˆ™æ˜¯æ‰¿è½½IoCæ€æƒ³ã€æ‰§è¡ŒDIæ“ä½œçš„è½åœ°å·¥å…·ã€‚</p>
<p>ç”±äºé¡¹ç›®æœ¬èº«æ¯”è¾ƒå°ï¼Œä¸æ‰“ç®—å¼„å¾—å¤ªå¤æ‚å¯¼è‡´è¿‡åº¦è®¾è®¡ï¼Œå°±æ²¡ç”¨åå°„æœºåˆ¶å’Œç±»ä¼¼javaæ³¨è§£çš„æœºåˆ¶äº†ï¼Œè€Œæ˜¯åœ¨ä¸€ä¸ªåˆå§‹åŒ–æ–‡ä»¶ä¸­æ‰‹åŠ¨ç®¡ç†ä¾èµ–ã€‚</p>
<p>å…ˆå±•ç¤ºä¸€ä¸‹æœ€åçš„æ•ˆæœï¼š</p>
<h3 data-id="heading-1">1.1æœåŠ¡æ¶ˆè´¹ç«¯</h3>
<p>éœ€è¦ç”¨åˆ°æŸä¸ªç»„ä»¶çš„æ—¶å€™ï¼Œæ— éœ€å…³å¿ƒä¾èµ–å…³ç³»ï¼Œåªéœ€è¦å£°æ˜è‡ªå·±è¦å“ªä¸ªç»„ä»¶å°±èƒ½ä»å®¹å™¨ä¸­è·å–åˆ°ã€‚</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// Agent.ts - ç»„ä»¶ä¸ä¾èµ–å®¹å™¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Agent</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">
    <span class="hljs-keyword">private</span> bot: Bot,
    <span class="hljs-keyword">private</span> executor: ActionExecutor,
    <span class="hljs-keyword">private</span> llmManager: LLMManager,
    <span class="hljs-keyword">private</span> memory: MemoryManager,
    <span class="hljs-comment">// ...å…¶ä»–ä¾èµ–</span>
  </span>) {
    <span class="hljs-comment">// ç›´æ¥ä½¿ç”¨æ³¨å…¥çš„ä¾èµ–</span>
  }
}

<span class="hljs-comment">// ä½¿ç”¨æ—¶æ— éœ€å…³å¿ƒä¾èµ–å…³ç³»</span>
<span class="hljs-keyword">const</span> agent = <span class="hljs-keyword">await</span> container.<span class="hljs-property">resolveAsync</span>&lt;<span class="hljs-title class_">Agent</span>&gt;(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">Agent</span>);
<span class="hljs-keyword">await</span> agent.<span class="hljs-title function_">start</span>();
</code></pre>
<h3 data-id="heading-2">1.2æœåŠ¡é…ç½®ç«¯</h3>
<p>åœ¨<code>bootstrap.ts</code>è¿™ä¸ªæ–‡ä»¶æ³¨å†Œæ‰€æœ‰çš„ç»„ä»¶ï¼Œè¿™é‡Œä¼ å…¥çš„å›è°ƒå‡½æ•°æ˜¯åœ¨åˆå§‹åŒ–çš„æ—¶å€™è°ƒç”¨æ¥æ„å»ºè¯¥ç»„ä»¶çš„å·¥å‚å‡½æ•°ï¼Œåœ¨æ­¤å¤„å£°æ˜ä¾èµ–å…³ç³»å¹¶ä¸”æ³¨å…¥ï¼ˆè¿™ä¹Ÿæ˜¯ç®€åŒ–çš„éƒ¨åˆ†ï¼Œå¦‚æœè¦è¿›ä¸€æ­¥è®¾è®¡ï¼Œå¯ä»¥ç”¨ç±»ä¼¼åå°„çš„æœºåˆ¶æ¥é¿å…æ¯ä¸ªç»„ä»¶éƒ½è¦æ‰‹åŠ¨è§£æä¾èµ–å’Œæ‰‹åŠ¨æ³¨å…¥ï¼‰ï¼Œå› ä¸ºä¸æ˜¯æ³¨å†Œçš„æ—¶å€™ç«‹åˆ»åˆå§‹åŒ–æ‰€ä»¥ç”¨å›è°ƒã€‚</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// bootstrap.ts - é›†ä¸­é…ç½®æ‰€æœ‰ä¾èµ–</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">configureServices</span>(<span class="hljs-params">container: Container</span>): <span class="hljs-built_in">void</span> {
  container
    .<span class="hljs-title function_">registerSingleton</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">Agent</span>, <span class="hljs-keyword">async</span> c =&gt; {
      <span class="hljs-keyword">const</span> bot = c.<span class="hljs-property">resolve</span>&lt;<span class="hljs-title class_">Bot</span>&gt;(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">Bot</span>);
      <span class="hljs-keyword">const</span> executor = c.<span class="hljs-title function_">resolve</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">ActionExecutor</span>);
      <span class="hljs-keyword">const</span> llmManager = <span class="hljs-keyword">await</span> c.<span class="hljs-title function_">resolveAsync</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">LLMManager</span>);
      <span class="hljs-keyword">const</span> memory = <span class="hljs-keyword">await</span> c.<span class="hljs-title function_">resolveAsync</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">MemoryManager</span>);

      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Agent</span>(bot, executor, llmManager, memory);
    })
    .<span class="hljs-title function_">withInitializer</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">Agent</span>, <span class="hljs-keyword">async</span> agent =&gt; {
      <span class="hljs-keyword">await</span> agent.<span class="hljs-title function_">initialize</span>();
    })
    .<span class="hljs-title function_">withDisposer</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">Agent</span>, <span class="hljs-keyword">async</span> agent =&gt; {
      <span class="hljs-keyword">await</span> agent.<span class="hljs-title function_">stop</span>();
    });
}
</code></pre>
<h3 data-id="heading-3">1.3åº”ç”¨å¯åŠ¨</h3>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// main.ts - æ¸…æ™°çš„å¯åŠ¨æµç¨‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MaicraftNext</span> {
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">initialize</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">const</span> container = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Container</span>();

    <span class="hljs-comment">// æ³¨å†ŒåŸºç¡€å®ä¾‹</span>
    container.<span class="hljs-title function_">registerInstance</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">Config</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>);
    container.<span class="hljs-title function_">registerInstance</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">Bot</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">bot</span>);

    <span class="hljs-comment">// é…ç½®æ‰€æœ‰æœåŠ¡ä¾èµ–</span>
    <span class="hljs-title function_">configureServices</span>(container);

    <span class="hljs-comment">// è·å–å®Œå…¨åˆå§‹åŒ–çš„ä»£ç†</span>
    <span class="hljs-keyword">const</span> agent = <span class="hljs-keyword">await</span> container.<span class="hljs-property">resolveAsync</span>&lt;<span class="hljs-title class_">Agent</span>&gt;(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">Agent</span>);
    <span class="hljs-keyword">await</span> agent.<span class="hljs-title function_">start</span>();
  }
}
</code></pre>
<h2 data-id="heading-4">2. æ ¸å¿ƒç»„ä»¶è®¾è®¡</h2>
<h3 data-id="heading-5">2.1 æœåŠ¡æ ‡è¯†ç¬¦</h3>
<p>ä½¿ç”¨ <code>Symbol</code> ç¡®ä¿ç±»å‹å®‰å…¨å’Œå”¯ä¸€æ€§ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// ServiceKeys.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">ServiceKeys</span> = {
  <span class="hljs-title class_">Config</span>: <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'Config'</span>),
  <span class="hljs-title class_">Bot</span>: <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'Bot'</span>),
  <span class="hljs-title class_">Agent</span>: <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'Agent'</span>),
  <span class="hljs-title class_">LLMManager</span>: <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'LLMManager'</span>),
  <span class="hljs-title class_">MemoryManager</span>: <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'MemoryManager'</span>),
  <span class="hljs-comment">// ...æ›´å¤šæœåŠ¡</span>
} <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>;

<span class="hljs-comment">// ç±»å‹æ˜ å°„æä¾›ç¼–è¯‘æ—¶ç±»å‹æ¨æ–­</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ServiceTypeMap</span> {
  [<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">Agent</span>]: <span class="hljs-title class_">Agent</span>;
  [<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">Bot</span>]: <span class="hljs-title class_">Bot</span>;
  [<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">LLMManager</span>]: <span class="hljs-title class_">LLMManager</span>;
  <span class="hljs-comment">// ...</span>
}
</code></pre>
<h4 data-id="heading-6">ä¸ºä»€ä¹ˆé€‰æ‹© Symbol è€Œéå­—ç¬¦ä¸²ï¼Ÿ</h4>
<p>ä¸»è¦å°±ä¸‹é¢ä¸¤ä¸ªåŸå› ï¼Œå…¶ä»–æ€§èƒ½ä¼˜åŒ–å•¥çš„è¿™ä¸ªé¡¹ç›®å¹¶ä¸çœ‹é‡ï¼Œä¸è¿‡æ—¢ç„¶Claudeè®¾è®¡äº†å°±ç•™ç€ã€‚</p>
<p><strong>1. å”¯ä¸€æ€§ä¿è¯</strong></p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// Symbol - ç»å¯¹å”¯ä¸€</span>
<span class="hljs-keyword">const</span> botKey1 = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'Bot'</span>);
<span class="hljs-keyword">const</span> botKey2 = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'Bot'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(botKey1 === botKey2); <span class="hljs-comment">// false</span>

<span class="hljs-comment">// å­—ç¬¦ä¸² - å¯èƒ½é‡å¤</span>
<span class="hljs-keyword">const</span> botKey1 = <span class="hljs-string">'Bot'</span>;
<span class="hljs-keyword">const</span> botKey2 = <span class="hljs-string">'Bot'</span>;  <span class="hljs-comment">// ä¸åŒæ¨¡å—å¯èƒ½å®šä¹‰ç›¸åŒçš„é”®</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(botKey1 === botKey2); <span class="hljs-comment">// true - å¯èƒ½å¯¼è‡´å†²çª</span>
</code></pre>
<p><strong>2. é˜²æ­¢é”®å†²çª</strong></p>
<p>è¿™ä¸ªç‰¹æ€§å…¶å®é¡¹ç›®è¶³å¤Ÿå¤§æ‰èƒ½ä½“ç°å‡ºç”¨å¤„ï¼Œæœ¬é¡¹ç›®æ¯”è¾ƒå°ï¼Œä¸€ä¸ªå¯¹è±¡è®°å½•å°±å¯ä»¥ï¼Œä¸ç”¨åˆ†å¤šä¸ªã€‚</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// åœºæ™¯ï¼šä¸åŒæ¨¡å—çš„æœåŠ¡å¯èƒ½åŒå</span>
<span class="hljs-keyword">const</span> userServiceKeys = {
  <span class="hljs-title class_">Cache</span>: <span class="hljs-string">'Cache'</span>,           <span class="hljs-comment">// ç”¨æˆ·ç¼“å­˜</span>
  <span class="hljs-title class_">Logger</span>: <span class="hljs-string">'Logger'</span>,         <span class="hljs-comment">// ç”¨æˆ·æ—¥å¿—</span>
};

<span class="hljs-keyword">const</span> productServiceKeys = {
  <span class="hljs-title class_">Cache</span>: <span class="hljs-string">'Cache'</span>,           <span class="hljs-comment">// äº§å“ç¼“å­˜ - å†²çªï¼</span>
  <span class="hljs-title class_">Logger</span>: <span class="hljs-string">'Logger'</span>,         <span class="hljs-comment">// äº§å“æ—¥å¿— - å†²çªï¼</span>
};

<span class="hljs-comment">// Symbol æ–¹å¼æ— æ­¤é—®é¢˜</span>
<span class="hljs-keyword">const</span> userServiceKeys = {
  <span class="hljs-title class_">Cache</span>: <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'Cache'</span>),
  <span class="hljs-title class_">Logger</span>: <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'Logger'</span>),
};

<span class="hljs-keyword">const</span> productServiceKeys = {
  <span class="hljs-title class_">Cache</span>: <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'Cache'</span>),   <span class="hljs-comment">// ä¸åŒ Symbolï¼Œæ— å†²çª</span>
  <span class="hljs-title class_">Logger</span>: <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">'Logger'</span>),
};
</code></pre>
<h3 data-id="heading-7">2.2 æœåŠ¡ç”Ÿå‘½å‘¨æœŸ</h3>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">Lifetime</span> {
  <span class="hljs-title class_">Singleton</span> = <span class="hljs-string">'singleton'</span>,   <span class="hljs-comment">// å…¨å±€å•ä¾‹</span>
  <span class="hljs-title class_">Transient</span> = <span class="hljs-string">'transient'</span>,   <span class="hljs-comment">// æ¯æ¬¡åˆ›å»ºæ–°å®ä¾‹</span>
  <span class="hljs-title class_">Scoped</span> = <span class="hljs-string">'scoped'</span>,        <span class="hljs-comment">// ä½œç”¨åŸŸå•ä¾‹ï¼ˆæœªå®ç°ï¼‰</span>
}
</code></pre>
<h3 data-id="heading-8">2.3 æœåŠ¡æè¿°ç¬¦</h3>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ServiceDescriptor</span>&lt;T = <span class="hljs-built_in">any</span>&gt; {
  <span class="hljs-attr">key</span>: <span class="hljs-title class_">ServiceKey</span>;
  <span class="hljs-attr">factory</span>: <span class="hljs-title class_">Factory</span>&lt;T&gt;;
  <span class="hljs-attr">lifetime</span>: <span class="hljs-title class_">Lifetime</span>;
  instance?: T;
  initializer?: <span class="hljs-function">(<span class="hljs-params">instance: T</span>) =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; | <span class="hljs-built_in">void</span>;
  disposer?: <span class="hljs-function">(<span class="hljs-params">instance: T</span>) =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; | <span class="hljs-built_in">void</span>;
}
</code></pre>
<h2 data-id="heading-9">3. å®¹å™¨æ ¸å¿ƒå®ç°</h2>
<h3 data-id="heading-10">3.1 Container ç±»ç»“æ„</h3>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Container</span> {
  <span class="hljs-keyword">private</span> services = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">ServiceKey</span>, <span class="hljs-title class_">ServiceDescriptor</span>&gt;();
  <span class="hljs-keyword">private</span> resolving = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>&lt;<span class="hljs-title class_">ServiceKey</span>&gt;(); <span class="hljs-comment">// å¾ªç¯ä¾èµ–æ£€æµ‹</span>

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">logger?: Logger</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">logger</span> = logger || <span class="hljs-title function_">getLogger</span>(<span class="hljs-string">'Container'</span>);
  }
  <span class="hljs-comment">//...</span>
  <span class="hljs-comment">//æ³¨å†Œã€è§£æç›¸å…³æ–¹æ³•</span>
}
</code></pre>
<h3 data-id="heading-11">3.2 æœåŠ¡æ³¨å†Œ</h3>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// æ³¨å†Œå•ä¾‹ä½œç”¨åŸŸçš„ç»„ä»¶</span>
registerSingleton&lt;T&gt;(<span class="hljs-attr">key</span>: <span class="hljs-title class_">ServiceKey</span>, <span class="hljs-attr">factory</span>: <span class="hljs-title class_">Factory</span>&lt;T&gt;): <span class="hljs-variable language_">this</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">register</span>(key, factory, <span class="hljs-title class_">Lifetime</span>.<span class="hljs-property">Singleton</span>);
}
<span class="hljs-comment">// æ³¨å†Œç¬æ—¶ä½œç”¨åŸŸçš„ç»„ä»¶</span>
registerTransient&lt;T&gt;(<span class="hljs-attr">key</span>: <span class="hljs-title class_">ServiceKey</span>, <span class="hljs-attr">factory</span>: <span class="hljs-title class_">Factory</span>&lt;T&gt;): <span class="hljs-variable language_">this</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">register</span>(key, factory, <span class="hljs-title class_">Lifetime</span>.<span class="hljs-property">Transient</span>);
}
<span class="hljs-comment">// ç›´æ¥æ³¨å†Œå®ä¾‹</span>
registerInstance&lt;T&gt;(<span class="hljs-attr">key</span>: <span class="hljs-title class_">ServiceKey</span>, <span class="hljs-attr">instance</span>: T): <span class="hljs-variable language_">this</span> {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">services</span>.<span class="hljs-title function_">set</span>(key, {
    key,
    <span class="hljs-attr">factory</span>: <span class="hljs-function">() =&gt;</span> instance,
    <span class="hljs-attr">lifetime</span>: <span class="hljs-title class_">Lifetime</span>.<span class="hljs-property">Singleton</span>,
    instance,
  });
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
}
register&lt;T&gt;(<span class="hljs-attr">key</span>: <span class="hljs-title class_">ServiceKey</span>, <span class="hljs-attr">factory</span>: <span class="hljs-title class_">Factory</span>&lt;T&gt;, <span class="hljs-attr">lifetime</span>: <span class="hljs-title class_">Lifetime</span> = <span class="hljs-title class_">Lifetime</span>.<span class="hljs-property">Singleton</span>): <span class="hljs-variable language_">this</span> {
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">services</span>.<span class="hljs-title function_">has</span>(key)) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">logger</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`æœåŠ¡ <span class="hljs-subst">${<span class="hljs-built_in">String</span>(key)}</span> å·²å­˜åœ¨ï¼Œå°†è¢«è¦†ç›–`</span>);
  }

  <span class="hljs-variable language_">this</span>.<span class="hljs-property">services</span>.<span class="hljs-title function_">set</span>(key, {
    key,
    factory,
    lifetime,
  });

  <span class="hljs-variable language_">this</span>.<span class="hljs-property">logger</span>.<span class="hljs-title function_">debug</span>(<span class="hljs-string">`æ³¨å†ŒæœåŠ¡: <span class="hljs-subst">${<span class="hljs-built_in">String</span>(key)}</span> (<span class="hljs-subst">${lifetime}</span>)`</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
}

</code></pre>
<h3 data-id="heading-12">3.3 å¾ªç¯ä¾èµ–æ£€æµ‹</h3>
<pre><code class="hljs language-TypeScript" lang="TypeScript">resolve&lt;T&gt;(<span class="hljs-attr">key</span>: <span class="hljs-title class_">ServiceKey</span>): T {
  <span class="hljs-keyword">const</span> descriptor = <span class="hljs-variable language_">this</span>.<span class="hljs-property">services</span>.<span class="hljs-title function_">get</span>(key);

  <span class="hljs-comment">// æ£€æµ‹å¾ªç¯ä¾èµ–</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">resolving</span>.<span class="hljs-title function_">has</span>(key)) {
    <span class="hljs-keyword">const</span> chain = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">resolving</span>)
      .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">k</span> =&gt;</span> <span class="hljs-title class_">String</span>(k))
      .<span class="hljs-title function_">join</span>(<span class="hljs-string">' -&gt; '</span>);
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`æ£€æµ‹åˆ°å¾ªç¯ä¾èµ–: <span class="hljs-subst">${chain}</span> -&gt; <span class="hljs-subst">${<span class="hljs-built_in">String</span>(key)}</span>`</span>);
  }

  <span class="hljs-keyword">try</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">resolving</span>.<span class="hljs-title function_">add</span>(key);<span class="hljs-comment">// æ ‡è®°æ­£åœ¨è§£æ</span>
    <span class="hljs-comment">// è§£æé€»è¾‘...</span>
    <span class="hljs-comment">// è¿™éƒ¨åˆ†å’Œä¸‹æ–‡çš„å¼‚æ­¥è§£æåŸºæœ¬ä¸€è‡´ï¼Œéƒ½æ˜¯è°ƒç”¨æ³¨å†Œæ—¶çš„å·¥å‚å‡½æ•°æ¥åˆ›å»ºå®ä¾‹ï¼Œæ­¤å¤„ä¸èµ˜è¿°</span>
  } <span class="hljs-keyword">finally</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">resolving</span>.<span class="hljs-title function_">delete</span>(key);
  }
}
</code></pre>
<p>ç”±äºæˆ‘å¯¹å‘½åæœ‰äº›å¼ºè¿«ç—‡ï¼Œæ‰€ä»¥é¡ºä¾¿é—®äº†é—®ä¸ºä»€ä¹ˆè¦ç”¨<code>resolve()</code>è€Œä¸æ˜¯<code>get()</code>ï¼Œåœ¨æˆ‘çœ¼é‡ŒIoCå®¹å™¨å°±æ˜¯ä¸ªå¤æ‚ç‰ˆçš„Mapï¼Œè€Œä¸”Springçš„å‘½åå¥½åƒä¹Ÿæ˜¯<code>getBean()</code>ã€‚</p>
<p>å›ç­”æ˜¯ï¼šä»è¯­ä¹‰ä¸Šæ¥è¯´ï¼Œgeté€šå¸¸è¿”å›å·²ç»å­˜åœ¨çš„å…ƒç´ ä¸”ä¸ä¼šåˆ›å»ºæ–°çš„å…ƒç´ ï¼Œè€Œresolveåˆ™éœ€è¦ç»è¿‡å¤æ‚çš„è§£æä¾èµ–è¿‡ç¨‹ï¼Œä¸”å¯èƒ½åˆ›å»ºæ–°çš„å…ƒç´ ï¼›</p>
<h2 data-id="heading-13">4. å¼‚æ­¥æ”¯æŒ</h2>
<h3 data-id="heading-14">4.1 å¼‚æ­¥å·¥å‚å‡½æ•°</h3>
<p>å’ŒåŒæ­¥è§£æç›¸æ¯”ï¼Œæ ¸å¿ƒå·®åˆ«åªæ˜¯asyncå’Œawaitå…³é”®å­—ï¼Œåˆ†å¼€ä¸¤ä¸ªæ–¹ä¾¿è°ƒç”¨æ–¹awaitã€‚</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">Factory</span>&lt;T = <span class="hljs-built_in">any</span>&gt; = <span class="hljs-function">(<span class="hljs-params">container: Container</span>) =&gt;</span> T | <span class="hljs-title class_">Promise</span>&lt;T&gt;;

<span class="hljs-comment">// æ”¯æŒå¼‚æ­¥è§£æ</span>
<span class="hljs-keyword">async</span> resolveAsync&lt;T&gt;(<span class="hljs-attr">key</span>: <span class="hljs-title class_">ServiceKey</span>): <span class="hljs-title class_">Promise</span>&lt;T&gt; {
  <span class="hljs-keyword">const</span> descriptor = <span class="hljs-variable language_">this</span>.<span class="hljs-property">services</span>.<span class="hljs-title function_">get</span>(key);

  <span class="hljs-comment">// å•ä¾‹å·²å­˜åœ¨ç›´æ¥è¿”å›</span>
  <span class="hljs-keyword">if</span> (descriptor.<span class="hljs-property">lifetime</span> === <span class="hljs-title class_">Lifetime</span>.<span class="hljs-property">Singleton</span> &amp;&amp; descriptor.<span class="hljs-property">instance</span>) {
    <span class="hljs-keyword">return</span> descriptor.<span class="hljs-property">instance</span>;
  }

  <span class="hljs-keyword">try</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">resolving</span>.<span class="hljs-title function_">add</span>(key);

    <span class="hljs-comment">// æ”¯æŒå¼‚æ­¥å·¥å‚å‡½æ•°</span>
    <span class="hljs-keyword">const</span> instance = <span class="hljs-keyword">await</span> descriptor.<span class="hljs-title function_">factory</span>(<span class="hljs-variable language_">this</span>);

    <span class="hljs-keyword">if</span> (descriptor.<span class="hljs-property">lifetime</span> === <span class="hljs-title class_">Lifetime</span>.<span class="hljs-property">Singleton</span>) {
      descriptor.<span class="hljs-property">instance</span> = instance;
    }

    <span class="hljs-comment">// æ‰§è¡Œå¼‚æ­¥åˆå§‹åŒ–å™¨</span>
    <span class="hljs-keyword">if</span> (descriptor.<span class="hljs-property">initializer</span> &amp;&amp; descriptor.<span class="hljs-property">lifetime</span> === <span class="hljs-title class_">Lifetime</span>.<span class="hljs-property">Singleton</span>) {
      <span class="hljs-keyword">await</span> descriptor.<span class="hljs-title function_">initializer</span>(instance);
    }

    <span class="hljs-keyword">return</span> instance;
  } <span class="hljs-keyword">finally</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">resolving</span>.<span class="hljs-title function_">delete</span>(key);
  }
}
</code></pre>
<h3 data-id="heading-15">4.2 ç”Ÿå‘½å‘¨æœŸç®¡ç†</h3>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// æ·»åŠ åˆå§‹åŒ–å™¨</span>
withInitializer&lt;T&gt;(<span class="hljs-attr">key</span>: <span class="hljs-title class_">ServiceKey</span>, <span class="hljs-attr">initializer</span>: <span class="hljs-function">(<span class="hljs-params">instance: T</span>) =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; | <span class="hljs-built_in">void</span>): <span class="hljs-variable language_">this</span> {
  <span class="hljs-keyword">const</span> descriptor = <span class="hljs-variable language_">this</span>.<span class="hljs-property">services</span>.<span class="hljs-title function_">get</span>(key);
  <span class="hljs-keyword">if</span> (!descriptor) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`æœåŠ¡ <span class="hljs-subst">${<span class="hljs-built_in">String</span>(key)}</span> æœªæ³¨å†Œ`</span>);
  }
  descriptor.<span class="hljs-property">initializer</span> = initializer;
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
}

<span class="hljs-comment">// æ·»åŠ é”€æ¯å™¨</span>
withDisposer&lt;T&gt;(<span class="hljs-attr">key</span>: <span class="hljs-title class_">ServiceKey</span>, <span class="hljs-attr">disposer</span>: <span class="hljs-function">(<span class="hljs-params">instance: T</span>) =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; | <span class="hljs-built_in">void</span>): <span class="hljs-variable language_">this</span> {
  <span class="hljs-keyword">const</span> descriptor = <span class="hljs-variable language_">this</span>.<span class="hljs-property">services</span>.<span class="hljs-title function_">get</span>(key);
  descriptor.<span class="hljs-property">disposer</span> = disposer;
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
}

<span class="hljs-comment">// å®¹å™¨é”€æ¯æ—¶æ¸…ç†æ‰€æœ‰èµ„æº</span>
<span class="hljs-keyword">async</span> <span class="hljs-title function_">dispose</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">disposers</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;&gt; = [];

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> descriptor <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">services</span>.<span class="hljs-title function_">values</span>()) {
    <span class="hljs-keyword">if</span> (descriptor.<span class="hljs-property">lifetime</span> === <span class="hljs-title class_">Lifetime</span>.<span class="hljs-property">Singleton</span> &amp;&amp;
        descriptor.<span class="hljs-property">instance</span> &amp;&amp;
        descriptor.<span class="hljs-property">disposer</span>) {
      disposers.<span class="hljs-title function_">push</span>(descriptor.<span class="hljs-title function_">disposer</span>(descriptor.<span class="hljs-property">instance</span>));
    }
  }

  <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(disposers);
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">services</span>.<span class="hljs-title function_">clear</span>();
}
</code></pre>
<h2 data-id="heading-16">5. å®é™…åº”ç”¨æ¡ˆä¾‹</h2>
<h3 data-id="heading-17">5.1 å¤æ‚ä¾èµ–é“¾ç¤ºä¾‹</h3>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// Agent ä¾èµ–å¤šä¸ªæœåŠ¡</span>
container.<span class="hljs-title function_">registerSingleton</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">Agent</span>, <span class="hljs-keyword">async</span> c =&gt; {
  <span class="hljs-keyword">const</span> bot = c.<span class="hljs-property">resolve</span>&lt;<span class="hljs-title class_">Bot</span>&gt;(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">Bot</span>);
  <span class="hljs-keyword">const</span> executor = c.<span class="hljs-title function_">resolve</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">ActionExecutor</span>);
  <span class="hljs-keyword">const</span> llmManager = <span class="hljs-keyword">await</span> c.<span class="hljs-title function_">resolveAsync</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">LLMManager</span>);
  <span class="hljs-keyword">const</span> memory = <span class="hljs-keyword">await</span> c.<span class="hljs-title function_">resolveAsync</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">MemoryManager</span>);
  <span class="hljs-keyword">const</span> planningManager = <span class="hljs-keyword">await</span> c.<span class="hljs-title function_">resolveAsync</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">GoalPlanningManager</span>);
  <span class="hljs-keyword">const</span> config = c.<span class="hljs-property">resolve</span>&lt;<span class="hljs-title class_">AppConfig</span>&gt;(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">Config</span>);

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Agent</span>(bot, executor, llmManager, config, memory, planningManager);
});
</code></pre>
<h3 data-id="heading-18">5.2 æ¡ä»¶æ€§ä¾èµ–æ³¨å…¥</h3>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// MemoryManager æ ¹æ®é…ç½®å†³å®šæ˜¯å¦æ³¨å…¥ MaiBotClient</span>
container.<span class="hljs-title function_">registerSingleton</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">MemoryManager</span>, <span class="hljs-keyword">async</span> c =&gt; {
  <span class="hljs-keyword">const</span> memory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MemoryManager</span>();
  <span class="hljs-keyword">const</span> config = c.<span class="hljs-property">resolve</span>&lt;<span class="hljs-title class_">AppConfig</span>&gt;(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">Config</span>);

  <span class="hljs-comment">// æ¡ä»¶æ€§æ³¨å…¥</span>
  <span class="hljs-keyword">if</span> (config.<span class="hljs-property">maibot</span>.<span class="hljs-property">enabled</span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> maibotClient = <span class="hljs-keyword">await</span> c.<span class="hljs-title function_">resolveAsync</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">MaiBotClient</span>);
      memory.<span class="hljs-title function_">setMaiBotClient</span>(maibotClient);
    } <span class="hljs-keyword">catch</span> (error) {
      logger.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'MaiBot å®¢æˆ·ç«¯åˆå§‹åŒ–å¤±è´¥ï¼Œä½¿ç”¨æ—  MaiBot æ¨¡å¼'</span>);
    }
  }

  <span class="hljs-keyword">return</span> memory;
});
</code></pre>
<h3 data-id="heading-19">5.3 å»¶è¿Ÿåˆå§‹åŒ–</h3>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// è§£å†³å¾ªç¯ä¾èµ–çš„æ–¹æ³•ä¹‹ä¸€</span>
container
  .<span class="hljs-title function_">registerSingleton</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">ActionExecutor</span>, <span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> executor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ActionExecutor</span>(contextManager, logger);

    <span class="hljs-comment">// æ³¨å†ŒåŠ¨ä½œ</span>
    <span class="hljs-title function_">registerActions</span>(executor, logger);
    <span class="hljs-keyword">return</span> executor;
  })
  .<span class="hljs-title function_">withInitializer</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">ActionExecutor</span>, <span class="hljs-function"><span class="hljs-params">executor</span> =&gt;</span> {
    <span class="hljs-comment">// å»¶è¿Ÿè®¾ç½® ContextManager çš„ executor å¼•ç”¨</span>
    contextManager.<span class="hljs-title function_">updateExecutor</span>(executor);
  });
</code></pre>
<h2 data-id="heading-20">6. æµ‹è¯•æ”¯æŒ</h2>
<h3 data-id="heading-21">6.1 æµ‹è¯•å®¹å™¨éš”ç¦»</h3>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// æµ‹è¯•æ—¶åˆ›å»ºç‹¬ç«‹çš„å®¹å™¨</span>
<span class="hljs-keyword">const</span> testContainer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Container</span>();

<span class="hljs-comment">// æ³¨å…¥ Mock ä¾èµ–</span>
testContainer.<span class="hljs-title function_">registerInstance</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">Bot</span>, mockBot);
testContainer.<span class="hljs-title function_">registerInstance</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">LLMManager</span>, mockLLMManager);

<span class="hljs-comment">// å…¶ä»–æœåŠ¡ä½¿ç”¨çœŸå®å®ç°</span>
testContainer.<span class="hljs-title function_">registerSingleton</span>(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">MemoryManager</span>, <span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MemoryManager</span>();
});

<span class="hljs-comment">// æµ‹è¯•ç›®æ ‡æœåŠ¡</span>
<span class="hljs-keyword">const</span> agent = <span class="hljs-keyword">await</span> testContainer.<span class="hljs-property">resolveAsync</span>&lt;<span class="hljs-title class_">Agent</span>&gt;(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">Agent</span>);
</code></pre>
<h3 data-id="heading-22">6.2 é›†æˆæµ‹è¯•</h3>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-title function_">describe</span>(<span class="hljs-string">'Agent Integration Tests'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">container</span>: <span class="hljs-title class_">Container</span>;
  <span class="hljs-keyword">let</span> <span class="hljs-attr">agent</span>: <span class="hljs-title class_">Agent</span>;

  <span class="hljs-title function_">beforeEach</span>(<span class="hljs-keyword">async</span> () =&gt; {
    container = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Container</span>();

    <span class="hljs-comment">// è®¾ç½®æµ‹è¯•ç¯å¢ƒ</span>
    <span class="hljs-title function_">setupTestContainer</span>(container);

    agent = <span class="hljs-keyword">await</span> container.<span class="hljs-property">resolveAsync</span>&lt;<span class="hljs-title class_">Agent</span>&gt;(<span class="hljs-title class_">ServiceKeys</span>.<span class="hljs-property">Agent</span>);
  });

  <span class="hljs-title function_">afterEach</span>(<span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">await</span> container.<span class="hljs-title function_">dispose</span>();
  });
});
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RuståŸºæœ¬ä½¿ç”¨]]></title>    <link>https://juejin.cn/post/7582922476223135759</link>    <guid>https://juejin.cn/post/7582922476223135759</guid>    <pubDate>2025-12-14T04:00:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582922476223135759" data-draft-id="7582939860874657827" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RuståŸºæœ¬ä½¿ç”¨"/> <meta itemprop="keywords" content="åç«¯,Rust"/> <meta itemprop="datePublished" content="2025-12-14T04:00:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="GKunLi"/> <meta itemprop="url" content="https://juejin.cn/user/430664725579725"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RuståŸºæœ¬ä½¿ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/430664725579725/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    GKunLi
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T04:00:49.000Z" title="Sun Dec 14 2025 04:00:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1.æ•°æ®ç±»å‹</h2>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-comment">// 1. åŸºæœ¬æ ‡é‡ç±»å‹</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">count</span>: <span class="hljs-type">i32</span> = <span class="hljs-number">100</span>;           <span class="hljs-comment">// æ•´æ•° i32</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">price</span> = <span class="hljs-number">59.99</span>;              <span class="hljs-comment">// æµ®ç‚¹æ•° f64 (é»˜è®¤)</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">is_active</span>: <span class="hljs-type">bool</span> = <span class="hljs-literal">true</span>;     <span class="hljs-comment">// å¸ƒå°”å€¼</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">index</span>: <span class="hljs-type">usize</span> = <span class="hljs-number">3</span>;           <span class="hljs-comment">// ç”¨äºç´¢å¼•</span>

    <span class="hljs-comment">// 2. å›ºå®šé›†åˆï¼šæ•°ç»„</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">scores</span> = [<span class="hljs-number">90</span>, <span class="hljs-number">85</span>, <span class="hljs-number">95</span>, <span class="hljs-number">78</span>];  <span class="hljs-comment">// æ•°ç»„ [i32; 4]</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ç¬¬ {} ä¸ªåˆ†æ•°: {}"</span>, index, scores[index]); <span class="hljs-comment">// ä½¿ç”¨ usize è®¿é—®</span>

    <span class="hljs-comment">// 3. å¯å˜é›†åˆï¼šVector (åŠ¨æ€æ•°ç»„)</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">names</span>: <span class="hljs-type">Vec</span>&lt;<span class="hljs-type">String</span>&gt; = <span class="hljs-type">Vec</span>::<span class="hljs-title function_ invoke__">new</span>(); <span class="hljs-comment">// å£°æ˜ä¸€ä¸ªå¯å˜çš„ Vector</span>
    names.<span class="hljs-title function_ invoke__">push</span>(<span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"Alice"</span>));
    names.<span class="hljs-title function_ invoke__">push</span>(<span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"Bob"</span>));
    
    <span class="hljs-comment">// 4. å­—ç¬¦ä¸²ç±»å‹</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">name_str</span>: &amp;<span class="hljs-type">str</span> = <span class="hljs-string">"Charlie"</span>;   <span class="hljs-comment">// å­—ç¬¦ä¸²åˆ‡ç‰‡ (&amp;str)</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">welcome_msg</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"Hello "</span>); <span class="hljs-comment">// å¯å˜ String</span>
    welcome_msg.<span class="hljs-title function_ invoke__">push_str</span>(name_str);   <span class="hljs-comment">// String å¯ä»¥ä¿®æ”¹</span>

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"åå­—åˆ—è¡¨: {:?}"</span>, names);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"å®Œæ•´ä¿¡æ¯: {}"</span>, welcome_msg);
}
</code></pre>
<h3 data-id="heading-1">1) æ ‡é‡ç±»å‹</h3>
<ul>
<li>æ•´æ•°ç±»å‹</li>
</ul>
<ol>
<li>æœ‰ç¬¦å· (Signed),å¯ä»¥æ˜¯è´Ÿæ•°æˆ–æ­£æ•°ã€‚å‰ç¼€æ˜¯ iã€‚,"i8,i16,i32,i64,i128"</li>
<li>æ— ç¬¦å· (Unsigned),åªèƒ½æ˜¯é›¶æˆ–æ­£æ•°ã€‚å‰ç¼€æ˜¯ uã€‚,"u8,u16,u32,u64,u128"</li>
<li>æ¶æ„ç›¸å…³,å¤§å°å–å†³äºè¿è¡Œç¨‹åºçš„ CPU æ¶æ„ï¼ˆ32ä½æˆ–64ä½ï¼‰ã€‚,"isize, usize (ä¸»è¦ç”¨äºé›†åˆç´¢å¼•æˆ–å†…å­˜å¤§å°)"</li>
</ol>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">x</span>: <span class="hljs-type">i32</span> = <span class="hljs-number">42</span>;          <span class="hljs-comment">// æ˜ç¡®æŒ‡å®š i32</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">y</span> = <span class="hljs-number">100</span>;              <span class="hljs-comment">// é»˜è®¤ä¸º i32</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">index</span>: <span class="hljs-type">usize</span> = <span class="hljs-number">5</span>;     <span class="hljs-comment">// å¸¸ç”¨ä½œç´¢å¼•</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">byte</span>: <span class="hljs-type">u8</span> = <span class="hljs-number">255</span>;       <span class="hljs-comment">// æ— ç¬¦å·å­—èŠ‚</span>
</code></pre>
<ul>
<li>æµ®ç‚¹æ•°ç±»å‹</li>
</ul>
<ol>
<li>f64,åŒç²¾åº¦æµ®ç‚¹æ•°ï¼ˆ64 ä½ï¼‰ã€‚,é»˜è®¤ç±»å‹ï¼Œç²¾åº¦æ›´é«˜ã€‚</li>
<li>f32,å•ç²¾åº¦æµ®ç‚¹æ•°ï¼ˆ32 ä½ï¼‰ã€‚,é€Ÿåº¦æ›´å¿«ï¼Œä½†ç²¾åº¦è¾ƒä½ã€‚</li>
</ol>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">pi</span> = <span class="hljs-number">3.1415926535</span>; <span class="hljs-comment">// é»˜è®¤ä¸º f64</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">e</span>: <span class="hljs-type">f32</span> = <span class="hljs-number">2.71828</span>;  <span class="hljs-comment">// æ˜ç¡®æŒ‡å®š f32</span>
</code></pre>
<ul>
<li>å¸ƒå°”ç±»å‹</li>
</ul>
<blockquote>
<p>å¸ƒå°”ç±»å‹åªæœ‰ä¸¤ä¸ªå¯èƒ½çš„å€¼ï¼štrue å’Œ falseã€‚</p>
</blockquote>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">is_rust_awesome</span>: <span class="hljs-type">bool</span> = <span class="hljs-literal">true</span>;
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">is_raining</span> = <span class="hljs-literal">false</span>; <span class="hljs-comment">// é»˜è®¤ä¸º bool</span>
</code></pre>
<ul>
<li>å­—ç¬¦ç±»å‹</li>
</ul>
<h4 data-id="heading-2">Rust çš„å­—ç¬¦ç±»å‹ char æ¯”è®¸å¤šå…¶ä»–è¯­è¨€çš„å­—ç¬¦ç±»å‹æ›´å¼ºå¤§ï¼Œå› ä¸ºå®ƒæ”¯æŒ Unicode æ ‡é‡å€¼ã€‚</h4>
<ol>
<li>å¤§å°ï¼š å­—ç¬¦ç±»å‹å›ºå®šå ç”¨ 4 å­—èŠ‚ï¼ˆ32 ä½ï¼‰ï¼Œå¯ä»¥è¡¨ç¤ºæ‰€æœ‰ Unicode å­—ç¬¦ï¼ˆåŒ…æ‹¬è¡¨æƒ…ç¬¦å·ã€ä¸­æ–‡å­—ç¬¦ç­‰ï¼‰ã€‚</li>
<li>è¡¨ç¤ºï¼š ä½¿ç”¨å•å¼•å· ' 'ã€‚</li>
</ol>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">heart_eye</span> = 'ğŸ˜';
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">z</span> = <span class="hljs-string">'Z'</span>;
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">chinese_char</span>: <span class="hljs-type">char</span> = <span class="hljs-string">'æ±‰'</span>;
</code></pre>
<h3 data-id="heading-3">2) å¤åˆç±»å‹</h3>
<ul>
<li>å…ƒç»„</li>
</ul>
<h4 data-id="heading-4">å…ƒç»„æ˜¯ä¸€ç§å°†å›ºå®šæ•°é‡çš„ä¸åŒç±»å‹çš„å€¼ç»„åˆåœ¨ä¸€èµ·çš„æ–¹å¼ã€‚</h4>
<ol>
<li>ç‰¹ç‚¹ï¼š é•¿åº¦å›ºå®šï¼Œå¯ä»¥åŒ…å«ä¸åŒç±»å‹çš„å€¼ã€‚</li>
<li>å®šä¹‰ï¼š ä½¿ç”¨åœ†æ‹¬å· ()ã€‚</li>
</ol>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªåŒ…å« i32, f64, u8 çš„å…ƒç»„</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">person_data</span>: (<span class="hljs-type">i32</span>, <span class="hljs-type">f64</span>, <span class="hljs-type">u8</span>) = (<span class="hljs-number">30</span>, <span class="hljs-number">6.2</span>, <span class="hljs-number">180</span>);

<span class="hljs-comment">// 1. é€šè¿‡æ¨¡å¼åŒ¹é…è§£æ„å…ƒç»„ (æ¨è)</span>
<span class="hljs-keyword">let</span> (age, height, weight) = person_data;
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"Age: {}"</span>, age); <span class="hljs-comment">// è¾“å‡º: 30</span>

<span class="hljs-comment">// 2. é€šè¿‡ç´¢å¼•è®¿é—®å…ƒç´ </span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">height_val</span> = person_data.<span class="hljs-number">1</span>; <span class="hljs-comment">// ç´¢å¼•ä» 0 å¼€å§‹</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"Height: {}"</span>, height_val); <span class="hljs-comment">// è¾“å‡º: 6.2</span>
</code></pre>
<ul>
<li>æ•°ç»„</li>
</ul>
<h4 data-id="heading-5">æ•°ç»„æ˜¯ä¸€ç§å°†å›ºå®šæ•°é‡çš„ç›¸åŒç±»å‹çš„å€¼ç»„åˆåœ¨ä¸€èµ·çš„æ–¹å¼ã€‚</h4>
<ol>
<li>ç‰¹ç‚¹ï¼š é•¿åº¦å›ºå®šï¼ˆå®šä¹‰åä¸èƒ½æ”¹å˜ï¼‰ï¼Œå…ƒç´ å¿…é¡»æ˜¯ç›¸åŒç±»å‹ã€‚</li>
<li>å®šä¹‰ï¼š ä½¿ç”¨æ–¹æ‹¬å· []ã€‚</li>
</ol>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªåŒ…å« 5 ä¸ª i32 å…ƒç´ çš„æ•°ç»„</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">numbers</span>: [<span class="hljs-type">i32</span>; <span class="hljs-number">5</span>] = [<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>, <span class="hljs-number">40</span>, <span class="hljs-number">50</span>];

<span class="hljs-comment">// è®¿é—®å…ƒç´ </span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">first</span> = numbers[<span class="hljs-number">0</span>]; <span class="hljs-comment">// è¾“å‡º: 10</span>

<span class="hljs-comment">// åˆå§‹åŒ–ä¸€ä¸ªåŒ…å«ç›¸åŒå€¼çš„æ•°ç»„</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">zeros</span> = [<span class="hljs-number">0</span>; <span class="hljs-number">8</span>]; <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªåŒ…å« 8 ä¸ª 0 çš„æ•°ç»„ï¼š[0, 0, 0, 0, 0, 0, 0, 0]</span>

<span class="hljs-comment">// æ•°ç»„è¶Šç•Œï¼šåœ¨ Rust ä¸­ï¼Œå¦‚æœè®¿é—®çš„ç´¢å¼•è¶…å‡ºäº†æ•°ç»„é•¿åº¦ï¼Œ</span>
<span class="hljs-comment">// ä¼šåœ¨è¿è¡Œæ—¶è§¦å‘ Panicï¼ˆç¨‹åºå´©æºƒï¼‰ï¼Œè€Œä¸æ˜¯åƒ C/C++ é‚£æ ·å¯¼è‡´æœªå®šä¹‰è¡Œä¸ºã€‚</span>
<span class="hljs-comment">// println!("{}", numbers[5]); // &lt;-- è¿è¡Œæ—¶ä¼š Panic</span>
</code></pre>
<h3 data-id="heading-6">3) è¡¥å……ç±»å‹</h3>
<ul>
<li>å­—ç¬¦ä¸²</li>
</ul>
<h4 data-id="heading-7">Rust æœ‰ä¸¤ç§ä¸»è¦çš„å­—ç¬¦ä¸²ç±»å‹ï¼š</h4>
<ol>
<li>&amp;str (å­—ç¬¦ä¸²åˆ‡ç‰‡): ç¼–è¯‘æ—¶å·²çŸ¥å¤§å°çš„å­—ç¬¦ä¸²å¼•ç”¨ï¼ˆé€šå¸¸æ˜¯åªè¯»çš„ï¼Œå­˜å‚¨åœ¨äºŒè¿›åˆ¶æ–‡ä»¶æˆ–å †æ ˆä¸­ï¼‰ã€‚å®ƒæ˜¯æœ€å¸¸ç”¨çš„å­—ç¬¦ä¸²ç±»å‹ã€‚</li>
<li>String (å¯å˜å­—ç¬¦ä¸²): å­˜å‚¨åœ¨å †ä¸Šçš„åŠ¨æ€ã€å¯å¢é•¿ã€å¯å˜çš„å­—ç¬¦ä¸²ã€‚ç±»ä¼¼äº Java çš„ String æˆ– C++ çš„ std::stringã€‚</li>
</ol>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">name_str</span>: &amp;<span class="hljs-type">str</span> = <span class="hljs-string">"Charlie"</span>;   <span class="hljs-comment">// å­—ç¬¦ä¸²åˆ‡ç‰‡ (&amp;str)</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">welcome_msg</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"Hello "</span>); <span class="hljs-comment">// å¯å˜ String</span>
</code></pre>
<ul>
<li>å‘é‡</li>
</ul>
<h4 data-id="heading-8">Vecï¼š åŠ¨æ€æ•°ç»„ï¼Œå­˜å‚¨åœ¨å †ä¸Šã€‚ä¸æ•°ç»„ä¸åŒï¼Œå®ƒçš„é•¿åº¦å¯å˜ï¼Œæ˜¯ Rust ä¸­æœ€å¸¸ç”¨çš„é›†åˆç±»å‹ã€‚ç±»ä¼¼äº Java çš„ ArrayListã€‚</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">names</span>: <span class="hljs-type">Vec</span>&lt;<span class="hljs-type">String</span>&gt; = <span class="hljs-type">Vec</span>::<span class="hljs-title function_ invoke__">new</span>(); <span class="hljs-comment">// å£°æ˜ä¸€ä¸ªå¯å˜çš„ Vector</span>
names.<span class="hljs-title function_ invoke__">push</span>(<span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"Alice"</span>));
names.<span class="hljs-title function_ invoke__">push</span>(<span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"Bob"</span>));
</code></pre>
<h2 data-id="heading-9">2.å‡½æ•°</h2>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// --------------------------------------------------------------------------</span>
<span class="hljs-comment">// ç¤ºä¾‹ 1: åŸºç¡€å‡½æ•° (Basic Function)</span>
<span class="hljs-comment">// - ä¸å¸¦å‚æ•°ï¼Œä¸å¸¦è¿”å›å€¼</span>
<span class="hljs-comment">// - ä½¿ç”¨ fn å…³é”®å­—å®šä¹‰</span>
<span class="hljs-comment">// --------------------------------------------------------------------------</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">greet</span>() {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Hello, Rust learner!"</span>);
}

<span class="hljs-comment">// --------------------------------------------------------------------------</span>
<span class="hljs-comment">// ç¤ºä¾‹ 2: å¸¦å‚æ•°çš„å‡½æ•° (Function with Parameters)</span>
<span class="hljs-comment">// - å¿…é¡»æ˜¾å¼å£°æ˜å‚æ•°çš„ç±»å‹</span>
<span class="hljs-comment">// --------------------------------------------------------------------------</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">add_numbers</span>(a: <span class="hljs-type">i32</span>, b: <span class="hljs-type">i32</span>) {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">sum</span> = a + b;
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{} + {} = {}"</span>, a, b, sum);
}

<span class="hljs-comment">// --------------------------------------------------------------------------</span>
<span class="hljs-comment">// ç¤ºä¾‹ 3: å¸¦è¿”å›å€¼çš„å‡½æ•° (Function with Return Value)</span>
<span class="hljs-comment">// - è¿”å›ç±»å‹å¿…é¡»åœ¨ -&gt; åé¢å£°æ˜</span>
<span class="hljs-comment">// - å‡½æ•°ä½“ä¸­ï¼Œæœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼å°†ä½œä¸ºè¿”å›å€¼</span>
<span class="hljs-comment">// - æ³¨æ„ï¼šè¿”å›è¡¨è¾¾å¼æœ«å°¾æ²¡æœ‰åˆ†å· (;)</span>
<span class="hljs-comment">// --------------------------------------------------------------------------</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">multiply</span>(x: <span class="hljs-type">i32</span>, y: <span class="hljs-type">i32</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">i32</span> {
    <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå®ƒçš„å€¼ (x * y) å°±æ˜¯è¿”å›å€¼</span>
    x * y 
    
    <span class="hljs-comment">// å¦‚æœåŠ ä¸Šåˆ†å·ï¼Œå®ƒå°±å˜æˆäº†è¯­å¥ï¼Œè¿”å› () (ç©ºå…ƒç»„)ï¼Œå¯¼è‡´ç±»å‹é”™è¯¯ï¼š</span>
    <span class="hljs-comment">// x * y; // &lt;-- é”™è¯¯ï¼</span>
}

<span class="hljs-comment">// --------------------------------------------------------------------------</span>
<span class="hljs-comment">// ç¤ºä¾‹ 4: å¸¦æœ‰è¯­å¥å’Œè¡¨è¾¾å¼çš„å¤æ‚å‡½æ•° (Statements vs Expressions)</span>
<span class="hljs-comment">// - è¯­å¥ (Statement): æ‰§è¡ŒåŠ¨ä½œä½†ä¸è¿”å›å€¼çš„ä»£ç  (å¦‚ let ç»‘å®š)</span>
<span class="hljs-comment">// - è¡¨è¾¾å¼ (Expression): æœ‰è¿”å›å€¼ï¼Œå¯ä»¥ç”¨äºèµ‹å€¼</span>
<span class="hljs-comment">// --------------------------------------------------------------------------</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">calculate_area</span>(width: <span class="hljs-type">i32</span>, height: <span class="hljs-type">i32</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">i32</span> {
    <span class="hljs-comment">// è¯­å¥ï¼šå£°æ˜ä¸€ä¸ªå˜é‡ç»‘å®šï¼Œä¸è¿”å›å€¼</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">area</span> = { 
        <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªå—è¡¨è¾¾å¼ (Block Expression)</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">w</span> = width; <span class="hljs-comment">// è¯­å¥</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">h</span> = height; <span class="hljs-comment">// è¯­å¥</span>
        w * h <span class="hljs-comment">// è¡¨è¾¾å¼ï¼Œæ­¤å—è¿”å› w * h çš„å€¼</span>
    }; <span class="hljs-comment">// å—è¡¨è¾¾å¼æœ«å°¾å¸¦äº†åˆ†å·ï¼Œæ‰€ä»¥æ•´ä¸ª let area = ... æ˜¯ä¸€ä¸ªè¯­å¥</span>

    <span class="hljs-comment">// è¡¨è¾¾å¼ï¼šæœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ä½œä¸ºæ•´ä¸ªå‡½æ•°çš„è¿”å›å€¼</span>
    area 
}

<span class="hljs-comment">// --------------------------------------------------------------------------</span>
<span class="hljs-comment">// ç¤ºä¾‹ 5: è¿”å›å…ƒç»„ (Tuple Return) - ç”¨äºè¿”å›å¤šä¸ªå€¼</span>
<span class="hljs-comment">// --------------------------------------------------------------------------</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">get_user_info</span>() <span class="hljs-punctuation">-&gt;</span> (<span class="hljs-type">String</span>, <span class="hljs-type">i32</span>) {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">name</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"Ferris"</span>);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">age</span> = <span class="hljs-number">8</span>;
    
    <span class="hljs-comment">// è¿”å›ä¸€ä¸ªåŒ…å« String å’Œ i32 çš„å…ƒç»„</span>
    (name, age) 
}

<span class="hljs-comment">// --------------------------------------------------------------------------</span>
<span class="hljs-comment">// ç¤ºä¾‹ 6: æ¥æ”¶å¼•ç”¨ (&amp;) å‚æ•° - é¿å…æ‰€æœ‰æƒè½¬ç§» (Borrowing)</span>
<span class="hljs-comment">// - è¿™æ˜¯ Rust å‡½æ•°ä¸­æœ€å¸¸ç”¨çš„æ¨¡å¼</span>
<span class="hljs-comment">// --------------------------------------------------------------------------</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">print_string_length</span>(s: &amp;<span class="hljs-type">String</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">usize</span> {
    <span class="hljs-comment">// ä¼ å…¥çš„æ˜¯å¼•ç”¨ï¼Œå‡½æ•°ç»“æŸå s çš„æ‰€æœ‰æƒä»åœ¨ main å‡½æ•°ä¸­</span>
    s.<span class="hljs-title function_ invoke__">len</span>()
}

<span class="hljs-comment">// --------------------------------------------------------------------------</span>
<span class="hljs-comment">// ä¸»å‡½æ•°ï¼šç¨‹åºçš„å…¥å£ç‚¹</span>
<span class="hljs-comment">// --------------------------------------------------------------------------</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-comment">// 1. è°ƒç”¨åŸºç¡€å‡½æ•°</span>
    <span class="hljs-title function_ invoke__">greet</span>();

    <span class="hljs-comment">// 2. è°ƒç”¨å¸¦å‚æ•°çš„å‡½æ•°</span>
    <span class="hljs-title function_ invoke__">add_numbers</span>(<span class="hljs-number">15</span>, <span class="hljs-number">7</span>);

    <span class="hljs-comment">// 3. è°ƒç”¨å¸¦è¿”å›å€¼çš„å‡½æ•°</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result</span> = <span class="hljs-title function_ invoke__">multiply</span>(<span class="hljs-number">6</span>, <span class="hljs-number">9</span>);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"6 ä¹˜ä»¥ 9 ç­‰äº: {}"</span>, result);

    <span class="hljs-comment">// 4. è°ƒç”¨å¸¦æœ‰è¯­å¥å’Œè¡¨è¾¾å¼çš„å‡½æ•°</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">rect_area</span> = <span class="hljs-title function_ invoke__">calculate_area</span>(<span class="hljs-number">10</span>, <span class="hljs-number">5</span>);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"çŸ©å½¢é¢ç§¯æ˜¯: {}"</span>, rect_area); <span class="hljs-comment">// è¾“å‡º: 50</span>

    <span class="hljs-comment">// 5. è°ƒç”¨è¿”å›å…ƒç»„çš„å‡½æ•°ï¼Œå¹¶è§£æ„</span>
    <span class="hljs-keyword">let</span> (user_name, user_age) = <span class="hljs-title function_ invoke__">get_user_info</span>();
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ç”¨æˆ·ä¿¡æ¯: åå­—={}, å¹´é¾„={}"</span>, user_name, user_age);

    <span class="hljs-comment">// 6. è°ƒç”¨æ¥æ”¶å¼•ç”¨çš„å‡½æ•°</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">my_string</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"RustLang"</span>); 
    <span class="hljs-comment">// æ³¨æ„ï¼šmy_string çš„æ‰€æœ‰æƒä»ç„¶åœ¨ main ä¸­</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">length</span> = <span class="hljs-title function_ invoke__">print_string_length</span>(&amp;my_string);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"å­—ç¬¦ä¸² '{}' çš„é•¿åº¦æ˜¯: {}"</span>, my_string, length);
    
    <span class="hljs-comment">// éªŒè¯ï¼šmy_string ä»ç„¶å¯ç”¨ï¼Œå› ä¸ºä¼ å…¥çš„æ˜¯å¼•ç”¨</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Original string is still here: {}"</span>, my_string); 
}
</code></pre>
<h2 data-id="heading-10">3.æ§åˆ¶æµ</h2>
<h3 data-id="heading-11">æ¡ä»¶åˆ¤æ–­ï¼šif è¡¨è¾¾å¼</h3>
<h4 data-id="heading-12">A. åŸºæœ¬ if/else</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">number</span> = <span class="hljs-number">6</span>;

    <span class="hljs-keyword">if</span> number % <span class="hljs-number">4</span> == <span class="hljs-number">0</span> {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ•°å­—å¯è¢« 4 æ•´é™¤"</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> number % <span class="hljs-number">3</span> == <span class="hljs-number">0</span> {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ•°å­—å¯è¢« 3 æ•´é™¤"</span>); <span class="hljs-comment">// 6 æ˜¯ 3 çš„å€æ•°ï¼Œæ‰§è¡Œè¿™é‡Œ</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> number % <span class="hljs-number">2</span> == <span class="hljs-number">0</span> {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ•°å­—å¯è¢« 2 æ•´é™¤"</span>);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ•°å­—ä¸èƒ½è¢« 4ã€3 æˆ– 2 æ•´é™¤"</span>);
    }
}
</code></pre>
<h4 data-id="heading-13">B. å°† if ç”¨ä½œè¡¨è¾¾å¼ï¼ˆè¿”å›å€¼ï¼‰</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">condition</span> = <span class="hljs-literal">true</span>;

    <span class="hljs-comment">// æ•´ä¸ª if/else å—è¿”å›ä¸€ä¸ªå€¼ï¼Œèµ‹å€¼ç»™ number</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">number</span> = <span class="hljs-keyword">if</span> condition {
        <span class="hljs-number">5</span> <span class="hljs-comment">// è¡¨è¾¾å¼ Aï¼Œç±»å‹æ˜¯ i32</span>
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-number">6</span> <span class="hljs-comment">// è¡¨è¾¾å¼ Bï¼Œç±»å‹ä¹Ÿæ˜¯ i32</span>
        <span class="hljs-comment">// å¦‚æœè¿™é‡Œè¿”å› "six"ï¼Œåˆ™ä¼šç¼–è¯‘é”™è¯¯ï¼Œå› ä¸ºç±»å‹ä¸åŒ¹é…</span>
    }; 

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ•°å­—æ˜¯: {}"</span>, number); <span class="hljs-comment">// è¾“å‡º: 5</span>
}
</code></pre>
<h3 data-id="heading-14">å¾ªç¯ç»“æ„ (Loop Constructs)</h3>
<h4 data-id="heading-15">A. loopï¼šæ— é™å¾ªç¯å’Œè¿”å›å€¼</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">counter</span> = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result</span> = <span class="hljs-keyword">loop</span> {
        counter += <span class="hljs-number">1</span>;

        <span class="hljs-keyword">if</span> counter == <span class="hljs-number">10</span> {
            <span class="hljs-comment">// å½“æ»¡è¶³æ¡ä»¶æ—¶ï¼Œä½¿ç”¨ break é€€å‡ºå¾ªç¯ï¼Œå¹¶è¿”å› 10 * 2</span>
            <span class="hljs-keyword">break</span> counter * <span class="hljs-number">2</span>; 
        }
    };

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"å¾ªç¯çš„ç»“æœæ˜¯: {}"</span>, result); <span class="hljs-comment">// è¾“å‡º: 20</span>
}
</code></pre>
<h4 data-id="heading-16">B. whileï¼šæ¡ä»¶å¾ªç¯</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">number</span> = <span class="hljs-number">3</span>;

    <span class="hljs-keyword">while</span> number != <span class="hljs-number">0</span> {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}!"</span>, number);
        number -= <span class="hljs-number">1</span>;
    }

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"LIFTOFF!!!"</span>);
}
</code></pre>
<h4 data-id="heading-17">C. forï¼šéå†é›†åˆ</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">a</span> = [<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>, <span class="hljs-number">40</span>, <span class="hljs-number">50</span>];

    <span class="hljs-comment">// for å¾ªç¯å®‰å…¨åœ°éå†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ </span>
    <span class="hljs-keyword">for</span> <span class="hljs-variable">element</span> <span class="hljs-keyword">in</span> a.<span class="hljs-title function_ invoke__">iter</span>() {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"å½“å‰å…ƒç´ å€¼æ˜¯: {}"</span>, element);
    }
}
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-comment">// éå†ä» 1 åˆ° 4 çš„æ•°å­—ï¼ˆä¸åŒ…å« 5ï¼‰</span>
    <span class="hljs-keyword">for</span> <span class="hljs-variable">number</span> <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>..<span class="hljs-number">5</span> { 
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ•°å­—: {}"</span>, number);
    }
    <span class="hljs-comment">// å¦‚æœè¦åŒ…å« 5ï¼Œä½¿ç”¨ 1..=5</span>
}
</code></pre>
<h3 data-id="heading-18">match åŒ¹é…</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// åŒ¹é…æ•°å­—</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">finger_count</span> = <span class="hljs-number">5</span>;

    <span class="hljs-keyword">match</span> finger_count {
        <span class="hljs-number">1</span> =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ä¸€ä¸ªæ‰‹æŒ‡"</span>),
        <span class="hljs-number">2</span> | <span class="hljs-number">3</span> =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ä¸¤ä¸‰ä¸ªæ‰‹æŒ‡"</span>), <span class="hljs-comment">// åŒ¹é…å¤šä¸ªå€¼</span>
        <span class="hljs-number">4</span>..=<span class="hljs-number">10</span> =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"å››åˆ°åä¸ªæ‰‹æŒ‡"</span>), <span class="hljs-comment">// åŒ¹é…èŒƒå›´</span>
        _ =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ä¸æ˜¯ 1-10 èŒƒå›´å†…çš„æ•°å­—"</span>), <span class="hljs-comment">// é»˜è®¤åŒ¹é…ï¼Œå¿…é¡»è¦†ç›–æ‰€æœ‰å…¶ä»–æƒ…å†µ</span>
    }
}
</code></pre>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// åŒ¹é… Option&lt;T&gt; (å¤„ç†å¯èƒ½ç¼ºå¤±çš„å€¼)</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">some_number</span>: <span class="hljs-type">Option</span>&lt;<span class="hljs-type">i32</span>&gt; = <span class="hljs-title function_ invoke__">Some</span>(<span class="hljs-number">42</span>);

    <span class="hljs-keyword">match</span> some_number {
        <span class="hljs-comment">// åŒ¹é… Some(value)ï¼Œå°† 42 èµ‹å€¼ç»™ x</span>
        <span class="hljs-title function_ invoke__">Some</span>(x) =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ‰¾åˆ°äº†æ•°å­—: {}"</span>, x), 
        <span class="hljs-comment">// åŒ¹é… Noneï¼Œå¤„ç†ç¼ºå¤±çš„æƒ…å†µ</span>
        <span class="hljs-literal">None</span> =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æ•°å­—"</span>),
    }
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆPriorityQueueï¼‰è¯¦è§£ï¼šåŸç†ã€ç”¨æ³•ä¸å®æˆ˜ç¤ºä¾‹]]></title>    <link>https://juejin.cn/post/7583174749066264622</link>    <guid>https://juejin.cn/post/7583174749066264622</guid>    <pubDate>2025-12-14T04:09:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583174749066264622" data-draft-id="7582955784570765363" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆPriorityQueueï¼‰è¯¦è§£ï¼šåŸç†ã€ç”¨æ³•ä¸å®æˆ˜ç¤ºä¾‹"/> <meta itemprop="keywords" content="åç«¯,ç®—æ³•"/> <meta itemprop="datePublished" content="2025-12-14T04:09:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘æ˜¯ä½ ä»¬çš„æ˜å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/3333374985122398"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆPriorityQueueï¼‰è¯¦è§£ï¼šåŸç†ã€ç”¨æ³•ä¸å®æˆ˜ç¤ºä¾‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3333374985122398/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘æ˜¯ä½ ä»¬çš„æ˜å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T04:09:58.000Z" title="Sun Dec 14 2025 04:09:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>åœ¨Javaç¼–ç¨‹ä¸­ï¼Œé˜Ÿåˆ—æ˜¯ä¸€ç§å¸¸è§çš„æ•°æ®ç»“æ„ï¼Œç”¨äºå®ç°å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰çš„æ•°æ®å¤„ç†é€»è¾‘ã€‚ç„¶è€Œï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›å…ƒç´ ä¸æ˜¯æŒ‰ç…§æ’å…¥é¡ºåºè¢«å¤„ç†ï¼Œè€Œæ˜¯æ ¹æ®å…¶â€œä¼˜å…ˆçº§â€æ¥å†³å®šå¤„ç†é¡ºåºã€‚è¿™æ—¶ï¼Œ<strong>ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆPriority Queueï¼‰</strong> å°±æ´¾ä¸Šäº†ç”¨åœºã€‚</p>
<p>Javaæ ‡å‡†åº“ä¸­çš„ <code>java.util.PriorityQueue</code> æ˜¯ä¸€ä¸ªåŸºäºå †ï¼ˆHeapï¼‰å®ç°çš„æ— ç•Œä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œå®ƒèƒ½å¤Ÿé«˜æ•ˆåœ°ç»´æŠ¤ä¸€ç»„å…ƒç´ ï¼Œå¹¶å§‹ç»ˆä¿è¯ä¼˜å…ˆçº§æœ€é«˜çš„å…ƒç´ ä½äºé˜Ÿé¦–ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ Java ä¸­ PriorityQueue çš„å†…éƒ¨åŸç†ã€æ„é€ æ–¹å¼ã€å¸¸ç”¨æ–¹æ³•ã€è‡ªå®šä¹‰æ¯”è¾ƒå™¨çš„ä½¿ç”¨ï¼Œä»¥åŠå¤šä¸ªå®ç”¨ç¤ºä¾‹ï¼Œå¸®åŠ©è¯»è€…å…¨é¢æŒæ¡è¿™ä¸€é‡è¦æ•°æ®ç»“æ„ã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€PriorityQueue åŸºç¡€æ¦‚å¿µ</h2>
<h3 data-id="heading-2">1.1 ä»€ä¹ˆæ˜¯ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Ÿ</h3>
<p>ä¼˜å…ˆçº§é˜Ÿåˆ—æ˜¯ä¸€ç§ç‰¹æ®Šçš„é˜Ÿåˆ—ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ éƒ½æœ‰ä¸€ä¸ªä¼˜å…ˆçº§ã€‚é˜Ÿåˆ—çš„æ“ä½œï¼ˆå¦‚æ’å…¥å’Œåˆ é™¤ï¼‰ä¼šæ ¹æ®å…ƒç´ çš„ä¼˜å…ˆçº§è¿›è¡Œè°ƒæ•´ï¼Œä½¿å¾—<strong>ä¼˜å…ˆçº§æœ€é«˜çš„å…ƒç´ æ€»æ˜¯æœ€å…ˆè¢«å–å‡º</strong>ã€‚åœ¨ Java ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒPriorityQueue æ˜¯ä¸€ä¸ª<strong>æœ€å°å †</strong>ï¼Œå³é˜Ÿé¦–ï¼ˆé€šè¿‡ <code>peek()</code> æˆ– <code>poll()</code> è·å–çš„å…ƒç´ ï¼‰æ˜¯é˜Ÿåˆ—ä¸­<strong>æœ€å°çš„å…ƒç´ </strong>ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šPriorityQueue å¹¶ä¸ä¿è¯å…ƒç´ çš„å®Œå…¨æ’åºï¼Œåªä¿è¯å †é¡¶å…ƒç´ å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§ã€‚</p>
</blockquote>
<h3 data-id="heading-3">1.2 PriorityQueue çš„ç‰¹ç‚¹</h3>
<ul>
<li><strong>éçº¿ç¨‹å®‰å…¨</strong>ï¼šPriorityQueue ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å¦‚æœéœ€è¦åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œåº”è€ƒè™‘Â <code>java.util.concurrent.PriorityBlockingQueue</code>ã€‚</li>
<li><strong>ä¸å…è®¸ null å…ƒç´ </strong>ï¼šå› ä¸º null æ— æ³•ä¸å…¶ä»–å…ƒç´ æ¯”è¾ƒï¼Œä¼šå¯¼è‡´ NullPointerExceptionã€‚</li>
<li><strong>æ— ç•Œé˜Ÿåˆ—</strong>ï¼šç†è®ºä¸Šå¯ä»¥æ— é™æ·»åŠ å…ƒç´ ï¼ˆå—é™äºå†…å­˜ï¼‰ï¼Œè‡ªåŠ¨æ‰©å®¹ã€‚</li>
<li><strong>åŸºäºå †å®ç°</strong>ï¼šåº•å±‚ä½¿ç”¨å¯è°ƒæ•´å¤§å°çš„æ•°ç»„è¡¨ç¤ºäºŒå‰å †ï¼Œæ’å…¥å’Œåˆ é™¤çš„æ—¶é—´å¤æ‚åº¦ä¸º O(log n)ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-4">äºŒã€PriorityQueue çš„æ„é€ æ–¹å¼</h2>
<p>Java æä¾›äº†å¤šç§æ„é€ å‡½æ•°æ¥åˆ›å»º PriorityQueueï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. é»˜è®¤æ„é€ å‡½æ•°ï¼ˆè‡ªç„¶é¡ºåºï¼Œæœ€å°å †ï¼‰</span>
PriorityQueue&lt;Integer&gt; pq1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;();

<span class="hljs-comment">// 2. æŒ‡å®šåˆå§‹å®¹é‡</span>
PriorityQueue&lt;Integer&gt; pq2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;(<span class="hljs-number">10</span>);

<span class="hljs-comment">// 3. ä½¿ç”¨è‡ªå®šä¹‰æ¯”è¾ƒå™¨</span>
PriorityQueue&lt;String&gt; pq3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;((a, b) -&gt; b.compareTo(a)); <span class="hljs-comment">// æœ€å¤§å †ï¼ˆæŒ‰å­—å…¸åºï¼‰</span>

<span class="hljs-comment">// 4. ä»å·²æœ‰é›†åˆåˆå§‹åŒ–</span>
List&lt;Integer&gt; list = Arrays.asList(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>);
PriorityQueue&lt;Integer&gt; pq4 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;(list);
</code></pre>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šå½“å…ƒç´ ç±»å‹å®ç°äº† <code>Comparable</code> æ¥å£ï¼ˆå¦‚ Integerã€Stringï¼‰æ—¶ï¼ŒPriorityQueue é»˜è®¤ä½¿ç”¨è‡ªç„¶é¡ºåºï¼›å¦åˆ™å¿…é¡»æä¾› <code>Comparator</code>ï¼Œå¦åˆ™ä¼šæŠ›å‡º <code>ClassCastException</code>ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€å¸¸ç”¨æ–¹æ³•è¯¦è§£</h2>
<p>PriorityQueue ç»§æ‰¿è‡ª <code>AbstractQueue</code>ï¼Œå®ç°äº† <code>Queue</code> æ¥å£ï¼Œä¸»è¦æ–¹æ³•åŒ…æ‹¬ï¼š</p>

































<table><thead><tr><th>æ–¹æ³•</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>add(E e)</code>Â /Â <code>offer(E e)</code></td><td>æ’å…¥å…ƒç´ ï¼ŒæˆåŠŸè¿”å› true</td></tr><tr><td><code>peek()</code></td><td>æŸ¥çœ‹ä½†ä¸ç§»é™¤é˜Ÿé¦–å…ƒç´ ï¼Œè‹¥ä¸ºç©ºè¿”å› null</td></tr><tr><td><code>poll()</code></td><td>ç§»é™¤å¹¶è¿”å›é˜Ÿé¦–å…ƒç´ ï¼Œè‹¥ä¸ºç©ºè¿”å› null</td></tr><tr><td><code>remove(Object o)</code></td><td>ç§»é™¤æŒ‡å®šå…ƒç´ ï¼ˆæ•ˆç‡è¾ƒä½ï¼ŒO(n)ï¼‰</td></tr><tr><td><code>size()</code></td><td>è¿”å›é˜Ÿåˆ—ä¸­å…ƒç´ æ•°é‡</td></tr><tr><td><code>isEmpty()</code></td><td>åˆ¤æ–­æ˜¯å¦ä¸ºç©º</td></tr></tbody></table>
<blockquote>
<p><code>add()</code> å’Œ <code>offer()</code> åœ¨ PriorityQueue ä¸­è¡Œä¸ºä¸€è‡´ï¼Œå› ä¸ºå®ƒæ˜¯æ— ç•Œçš„ï¼Œä¸ä¼šæ‹’ç»æ’å…¥ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-6">å››ã€é»˜è®¤è¡Œä¸ºï¼šæœ€å°å †ç¤ºä¾‹</h2>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨é»˜è®¤è‡ªç„¶é¡ºåºï¼ˆæœ€å°å †ï¼‰çš„ç®€å•ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.PriorityQueue;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MinHeapExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        PriorityQueue&lt;Integer&gt; pq = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;();
        pq.offer(<span class="hljs-number">10</span>);
        pq.offer(<span class="hljs-number">5</span>);
        pq.offer(<span class="hljs-number">20</span>);
        pq.offer(<span class="hljs-number">1</span>);

        <span class="hljs-keyword">while</span> (!pq.isEmpty()) {
            System.out.print(pq.poll() + <span class="hljs-string">" "</span>); <span class="hljs-comment">// è¾“å‡º: 1 5 10 20</span>
        }
    }
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå°½ç®¡æ’å…¥é¡ºåºæ˜¯ 10 â†’ 5 â†’ 20 â†’ 1ï¼Œä½†è¾“å‡ºæ˜¯å‡åºçš„ï¼Œè¯´æ˜é˜Ÿåˆ—å§‹ç»ˆå°†æœ€å°å€¼æ”¾åœ¨é¡¶éƒ¨ã€‚</p>
<hr/>
<h2 data-id="heading-7">äº”ã€## PriorityQueue ä½¿ç”¨æŠ€å·§ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-8">1.Â <strong>æ˜ç¡®â€œä¼˜å…ˆçº§â€çš„å®šä¹‰ï¼šæœ€å°å † vs æœ€å¤§å †</strong></h3>
<p>Java çš„ <code>PriorityQueue</code> é»˜è®¤æ˜¯<strong>æœ€å°å †</strong>ï¼ˆå³ <code>peek()</code> è¿”å›æœ€å°å…ƒç´ ï¼‰ã€‚ä½†åœ¨å¾ˆå¤šä¸šåŠ¡åœºæ™¯ä¸­ï¼ˆå¦‚å–æœ€å¤§å€¼ã€æœ€é«˜åˆ†ã€æœ€è¿‘æ—¶é—´ç­‰ï¼‰ï¼Œæˆ‘ä»¬å®é™…éœ€è¦çš„æ˜¯<strong>æœ€å¤§å †</strong>ã€‚</p>
<p>âœ… <strong>æŠ€å·§</strong>ï¼šä½¿ç”¨ <code>Collections.reverseOrder()</code> å¿«é€Ÿæ„å»ºæœ€å¤§å †ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å¯¹äºå®ç°äº† Comparable çš„ç±»å‹ï¼ˆå¦‚ Integer, Stringï¼‰</span>
PriorityQueue&lt;Integer&gt; maxHeap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;(Collections.reverseOrder());

<span class="hljs-comment">// æˆ–è€…è‡ªå®šä¹‰æ¯”è¾ƒå™¨</span>
PriorityQueue&lt;String&gt; reverseLex = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;((a, b) -&gt; b.compareTo(a));
</code></pre>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šä¸è¦è¯¯ä»¥ä¸º <code>PriorityQueue</code> é»˜è®¤æ˜¯æœ€å¤§å †â€”â€”è¿™æ˜¯åˆå­¦è€…å¸¸è§è¯¯åŒºã€‚</p>
</blockquote>
<h3 data-id="heading-9">2.Â <strong>é¿å…åœ¨é˜Ÿåˆ—ä¸­ä¿®æ”¹å·²æ’å…¥å¯¹è±¡çš„çŠ¶æ€</strong></h3>
<p>å¦‚æœé˜Ÿåˆ—ä¸­å­˜å‚¨çš„æ˜¯<strong>å¯å˜å¯¹è±¡</strong>ï¼Œå¹¶ä¸”ä½ åœ¨æ’å…¥åä¿®æ”¹äº†å½±å“æ¯”è¾ƒç»“æœçš„å­—æ®µï¼ˆæ¯”å¦‚ä¼˜å…ˆçº§å­—æ®µï¼‰ï¼Œä¼šå¯¼è‡´å †ç»“æ„<strong>å¤±æ•ˆ</strong>ï¼Œåç»­ <code>poll()</code> å¯èƒ½è¿”å›é”™è¯¯ç»“æœã€‚</p>
<p>âœ… <strong>æœ€ä½³å®è·µ</strong>ï¼š</p>
<ul>
<li>å°½é‡ä½¿ç”¨<strong>ä¸å¯å˜å¯¹è±¡</strong>ï¼ˆImmutable Objectï¼‰ä½œä¸ºé˜Ÿåˆ—å…ƒç´ ï¼›</li>
<li>å¦‚æœå¿…é¡»ä½¿ç”¨å¯å˜å¯¹è±¡ï¼Œ<strong>æ’å…¥åä¸è¦ä¿®æ”¹å…¶ç”¨äºæ¯”è¾ƒçš„å­—æ®µ</strong>ï¼›</li>
<li>è‹¥ç¡®å®éœ€è¦æ›´æ–°ä¼˜å…ˆçº§ï¼Œåº”å…ˆÂ <code>remove()</code>Â æ—§å¯¹è±¡ï¼Œå†Â <code>offer()</code>Â æ–°å¯¹è±¡ï¼ˆä½†æ³¨æ„Â <code>remove()</code>Â æ˜¯ O(n) æ“ä½œï¼‰ã€‚</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é”™è¯¯ç¤ºä¾‹</span>
<span class="hljs-type">Task</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Task</span>(<span class="hljs-string">"A"</span>, <span class="hljs-number">5</span>);
pq.offer(t);
t.priority = <span class="hljs-number">1</span>; <span class="hljs-comment">// ä¿®æ”¹åå †ç»“æ„æ··ä¹±ï¼</span>

<span class="hljs-comment">// âœ… æ­£ç¡®åšæ³•</span>
pq.remove(t);      <span class="hljs-comment">// å…ˆç§»é™¤ï¼ˆä»£ä»·é«˜ï¼‰</span>
t.priority = <span class="hljs-number">1</span>;
pq.offer(t);       <span class="hljs-comment">// å†æ’å…¥</span>
</code></pre>
<blockquote>
<p>æ›´é«˜çº§çš„æ›¿ä»£æ–¹æ¡ˆï¼šä½¿ç”¨æ”¯æŒâ€œå‡å°‘é”®â€ï¼ˆdecrease-keyï¼‰æ“ä½œçš„<strong>æ–æ³¢é‚£å¥‘å †</strong>æˆ–ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ Google Guava çš„ <code>MinMaxPriorityQueue</code>ï¼‰ï¼Œä½† Java æ ‡å‡†åº“ä¸æä¾›æ­¤ç±»åŠŸèƒ½ã€‚</p>
</blockquote>
<h3 data-id="heading-10">3.Â <strong>åˆç†è®¾ç½®åˆå§‹å®¹é‡ä»¥å‡å°‘æ‰©å®¹å¼€é”€</strong></h3>
<p><code>PriorityQueue</code> åº•å±‚ä½¿ç”¨åŠ¨æ€æ•°ç»„ï¼Œé»˜è®¤åˆå§‹å®¹é‡ä¸º 11ã€‚å½“å…ƒç´ æ•°é‡è¶…è¿‡å®¹é‡æ—¶ï¼Œä¼šè‡ªåŠ¨æ‰©å®¹ï¼ˆé€šå¸¸æ‰©å®¹ä¸ºåŸå®¹é‡çš„ 1.5 å€ï¼‰ï¼Œæ¶‰åŠæ•°ç»„å¤åˆ¶ï¼Œæœ‰ä¸€å®šæ€§èƒ½å¼€é”€ã€‚</p>
<p>âœ… <strong>æŠ€å·§</strong>ï¼šå¦‚æœé¢„ä¼°å…ƒç´ æ•°é‡ï¼Œå»ºè®®åœ¨æ„é€ æ—¶æŒ‡å®šåˆå§‹å®¹é‡ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">int</span> <span class="hljs-variable">expectedSize</span> <span class="hljs-operator">=</span> <span class="hljs-number">10000</span>;
PriorityQueue&lt;Integer&gt; pq = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;(expectedSize);
</code></pre>
<p>è¿™å¯ä»¥é¿å…å¤šæ¬¡æ‰©å®¹ï¼Œæå‡æ€§èƒ½ï¼Œå°¤å…¶åœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶æ•ˆæœæ˜æ˜¾ã€‚</p>
<h3 data-id="heading-11">4.Â <strong>æ‰¹é‡åˆå§‹åŒ–ï¼šä»é›†åˆæ„é€ é˜Ÿåˆ—</strong></h3>
<p>å¦‚æœä½ å·²ç»æœ‰ä¸€ä¸ª <code>Collection</code>ï¼ˆå¦‚ <code>List</code>ã€<code>Set</code>ï¼‰ï¼Œå¯ä»¥ç›´æ¥ç”¨å®ƒåˆå§‹åŒ– <code>PriorityQueue</code>ï¼Œå†…éƒ¨ä¼šè°ƒç”¨ <code>heapify</code> è¿‡ç¨‹ï¼ˆO(n) æ—¶é—´å»ºå †ï¼Œæ¯”é€ä¸ªæ’å…¥ O(n log n) æ›´å¿«ï¼‰ã€‚</p>
<pre><code class="hljs language-java" lang="java">List&lt;Integer&gt; data = Arrays.asList(<span class="hljs-number">10</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>, <span class="hljs-number">1</span>, <span class="hljs-number">9</span>);
PriorityQueue&lt;Integer&gt; pq = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;(data); <span class="hljs-comment">// O(n) å»ºå †</span>
</code></pre>
<blockquote>
<p>ğŸ’¡ æç¤ºï¼šè¿™æ˜¯æ€§èƒ½ä¼˜åŒ–çš„ä¸€ä¸ªå°æŠ€å·§ï¼Œé€‚ç”¨äºç¦»çº¿æ•°æ®æ‰¹é‡åŠ è½½åœºæ™¯ã€‚</p>
</blockquote>
<h3 data-id="heading-12">5.Â <strong>ä¸è¦ä¾èµ– iterator() çš„é¡ºåº</strong></h3>
<p><code>PriorityQueue</code> çš„ <code>iterator()</code> <strong>ä¸ä¿è¯æŒ‰ä¼˜å…ˆçº§é¡ºåºéå†</strong>ï¼å®ƒçš„è¿­ä»£é¡ºåºæ˜¯åº•å±‚å †æ•°ç»„çš„ç‰©ç†é¡ºåºï¼Œå¯¹ç”¨æˆ·æ— æ„ä¹‰ã€‚</p>
<p>âœ… <strong>æ­£ç¡®åšæ³•</strong>ï¼šè‹¥éœ€æœ‰åºè¾“å‡ºï¼Œå¿…é¡»å¾ªç¯è°ƒç”¨ <code>poll()</code>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šé¡ºåºä¸ç¡®å®š</span>
<span class="hljs-keyword">for</span> (Integer x : pq) {
    System.out.println(x); <span class="hljs-comment">// å¯èƒ½ä¸æ˜¯å‡åºï¼</span>
}

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šé€šè¿‡ poll() è·å–æœ‰åºåºåˆ—</span>
<span class="hljs-keyword">while</span> (!pq.isEmpty()) {
    System.out.println(pq.poll()); <span class="hljs-comment">// ä¿è¯å‡åºï¼ˆé»˜è®¤æœ€å°å †ï¼‰</span>
}
</code></pre>
<blockquote>
<p>å¦‚æœä½ æ—¢æƒ³ä¿ç•™é˜Ÿåˆ—åˆæƒ³æŸ¥çœ‹æœ‰åºå†…å®¹ï¼Œå¯ä»¥å…ˆå¤åˆ¶ä¸€ä»½ï¼š</p>
</blockquote>
<pre><code class="hljs language-java" lang="java">PriorityQueue&lt;Integer&gt; copy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;(originalPQ);
<span class="hljs-keyword">while</span> (!copy.isEmpty()) {
    System.out.println(copy.poll());
}
</code></pre>
<h3 data-id="heading-13">6.Â <strong>å¤„ç†æµ®ç‚¹æ•°æˆ– Double.NaN çš„é™·é˜±</strong></h3>
<p>å½“ä½¿ç”¨ <code>Double</code> æˆ– <code>Float</code> ä½œä¸ºå…ƒç´ æ—¶ï¼Œè¦ç‰¹åˆ«å°å¿ƒ <code>NaN</code>ï¼ˆNot-a-Numberï¼‰å€¼ã€‚å› ä¸º <code>NaN</code> ä¸ä»»ä½•å€¼ï¼ˆåŒ…æ‹¬è‡ªèº«ï¼‰æ¯”è¾ƒéƒ½è¿”å› <code>false</code>ï¼Œè¿åäº† <code>Comparator</code> çš„<strong>åå¯¹ç§°æ€§</strong>å’Œ<strong>ä¼ é€’æ€§</strong>ï¼Œå¯èƒ½å¯¼è‡´ <code>PriorityQueue</code> è¡Œä¸ºå¼‚å¸¸ç”šè‡³æ­»å¾ªç¯ã€‚</p>
<p>âœ… <strong>é˜²å¾¡æ€§ç¼–ç¨‹</strong>ï¼š</p>
<ul>
<li>åœ¨æ’å…¥å‰è¿‡æ»¤æ‰Â <code>NaN</code>ï¼›</li>
<li>è‡ªå®šä¹‰æ¯”è¾ƒå™¨æ˜¾å¼å¤„ç†Â <code>NaN</code>ï¼ˆä¾‹å¦‚å°†å…¶è§†ä¸ºæœ€å¤§æˆ–æœ€å°å€¼ï¼‰ã€‚</li>
</ul>
<pre><code class="hljs language-java" lang="java">PriorityQueue&lt;Double&gt; pq = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;((a, b) -&gt; {
    <span class="hljs-keyword">if</span> (a.isNaN()) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;   <span class="hljs-comment">// NaN è§†ä¸ºæœ€å¤§</span>
    <span class="hljs-keyword">if</span> (b.isNaN()) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
    <span class="hljs-keyword">return</span> Double.compare(a, b);
});
</code></pre>
<h3 data-id="heading-14">7.Â <strong>å¤šæ¡ä»¶æ’åºï¼šé“¾å¼æ¯”è¾ƒå™¨ï¼ˆJava 8+ï¼‰</strong></h3>
<p>å½“ä¼˜å…ˆçº§ç”±å¤šä¸ªå­—æ®µå†³å®šæ—¶ï¼Œå¯ä½¿ç”¨ <code>Comparator.thenComparing()</code> æ„å»ºå¤åˆæ¯”è¾ƒå™¨ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Job</span> {
    <span class="hljs-type">int</span> urgency;   <span class="hljs-comment">// è¶Šå°è¶Šç´§æ€¥</span>
    <span class="hljs-type">int</span> profit;    <span class="hljs-comment">// åˆ©æ¶¦è¶Šé«˜è¶Šå¥½</span>
    String name;
    
    <span class="hljs-comment">// constructor &amp; toString...</span>
}

PriorityQueue&lt;Job&gt; jobQueue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;(
    Comparator.comparingInt((Job j) -&gt; j.urgency)
              .thenComparingInt(j -&gt; -j.profit) <span class="hljs-comment">// åˆ©æ¶¦é™åº</span>
              .thenComparing(j -&gt; j.name)       <span class="hljs-comment">// åç§°å‡åº</span>
);
</code></pre>
<blockquote>
<p>è¿™ç§å†™æ³•æ¸…æ™°ã€å¯è¯»æ€§å¼ºï¼Œä¸”é¿å…æ‰‹å†™å¤æ‚çš„ if-else æ¯”è¾ƒé€»è¾‘ã€‚</p>
</blockquote>
<h3 data-id="heading-15">8.Â <strong>è°ƒè¯•æŠ€å·§ï¼šæ‰“å°å½“å‰å †ç»“æ„ï¼ˆä»…ç”¨äºå­¦ä¹ ï¼‰</strong></h3>
<p>è™½ç„¶ç”Ÿäº§ä»£ç ä¸åº”ä¾èµ–å †çš„å†…éƒ¨ç»“æ„ï¼Œä½†åœ¨è°ƒè¯•æˆ–æ•™å­¦æ—¶ï¼Œæœ‰æ—¶æƒ³æŸ¥çœ‹å †çš„å®é™…æ•°ç»„å¸ƒå±€ã€‚å¯é€šè¿‡åå°„è®¿é—®ç§æœ‰å­—æ®µï¼ˆ<strong>ä»…é™æµ‹è¯•ç¯å¢ƒï¼</strong> ï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âš ï¸ ä»…ä¾›å­¦ä¹ /è°ƒè¯•ï¼Œåˆ‡å‹¿ç”¨äºç”Ÿäº§ä»£ç ï¼</span>
<span class="hljs-type">Field</span> <span class="hljs-variable">field</span> <span class="hljs-operator">=</span> PriorityQueue.class.getDeclaredField(<span class="hljs-string">"queue"</span>);
field.setAccessible(<span class="hljs-literal">true</span>);
Object[] heap = (Object[]) field.get(pq);
System.out.println(Arrays.toString(heap));
</code></pre>
<blockquote>
<p>æ³¨æ„ï¼šä¸åŒ JDK ç‰ˆæœ¬å­—æ®µåå¯èƒ½ä¸åŒï¼Œä¸”ç ´åå°è£…æ€§ï¼Œé£é™©æé«˜ã€‚</p>
</blockquote>
<h3 data-id="heading-16">9.Â <strong>ä¸ Stream API ç»“åˆä½¿ç”¨ï¼ˆè°¨æ…ï¼‰</strong></h3>
<p>è™½ç„¶å¯ä»¥å°† <code>PriorityQueue</code> è½¬ä¸º <code>Stream</code>ï¼Œä½†ç”±äºå…¶æ— åºè¿­ä»£ç‰¹æ€§ï¼Œ<strong>ä¸æ¨èç”¨äºéœ€è¦æ’åºçš„æµæ“ä½œ</strong>ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ ä¸å¯é ï¼šstream() é¡ºåºä¸ç¡®å®š</span>
pq.stream().sorted().forEach(System.out::println);

<span class="hljs-comment">// âœ… åº”è¯¥è¿™æ ·ï¼š</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(pq).stream()
    .sorted()
    .forEach(System.out::println);
</code></pre>
<p>æˆ–è€…ç›´æ¥ä½¿ç”¨ <code>poll()</code> å¾ªç¯ã€‚</p>
<h3 data-id="heading-17">10.Â <strong>æ›¿ä»£æ–¹æ¡ˆè€ƒè™‘ï¼šä½•æ—¶ä¸ç”¨ PriorityQueueï¼Ÿ</strong></h3>
<p>å°½ç®¡ <code>PriorityQueue</code> éå¸¸æœ‰ç”¨ï¼Œä½†åœ¨ä»¥ä¸‹åœºæ™¯å¯èƒ½ä¸æ˜¯æœ€ä½³é€‰æ‹©ï¼š</p>

























<table><thead><tr><th>åœºæ™¯</th><th>æ›´ä¼˜é€‰æ‹©</th></tr></thead><tbody><tr><td>éœ€è¦é¢‘ç¹æŸ¥æ‰¾/åˆ é™¤ä»»æ„å…ƒç´ </td><td><code>TreeSet</code>ï¼ˆæ”¯æŒ O(log n) åˆ é™¤å’Œæœ‰åºéå†ï¼‰</td></tr><tr><td>å¤šçº¿ç¨‹ç¯å¢ƒ</td><td><code>PriorityBlockingQueue</code></td></tr><tr><td>éœ€è¦å›ºå®šå¤§å°çš„ Top-K ç¼“å­˜</td><td>ä½¿ç”¨Â <code>TreeSet</code>Â + è‡ªå®šä¹‰æ·˜æ±°ç­–ç•¥ï¼Œæˆ– Guava çš„Â <code>EvictingQueue</code>ï¼ˆä½†æ— ä¼˜å…ˆçº§ï¼‰</td></tr><tr><td>éœ€è¦ç¨³å®šæ’åºï¼ˆç›¸åŒä¼˜å…ˆçº§ä¿æŒæ’å…¥é¡ºåºï¼‰</td><td>è‡ªå®šä¹‰æ¯”è¾ƒå™¨åŠ å…¥â€œæ’å…¥åºå·â€å­—æ®µ</td></tr></tbody></table>
<p>ä¾‹å¦‚ï¼Œå®ç°ç¨³å®šä¼˜å…ˆçº§é˜Ÿåˆ—ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StableTask</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparable</span>&lt;StableTask&gt; {
    <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> priority;
    <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> seq; <span class="hljs-comment">// æ’å…¥é¡ºåºç¼–å·</span>
    <span class="hljs-keyword">final</span> String name;
    <span class="hljs-keyword">static</span> <span class="hljs-type">long</span> <span class="hljs-variable">counter</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

    StableTask(<span class="hljs-type">int</span> p, String n) {
        <span class="hljs-built_in">this</span>.priority = p;
        <span class="hljs-built_in">this</span>.name = n;
        <span class="hljs-built_in">this</span>.seq = counter++;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(StableTask o)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">cmp</span> <span class="hljs-operator">=</span> Integer.compare(<span class="hljs-built_in">this</span>.priority, o.priority);
        <span class="hljs-keyword">return</span> cmp != <span class="hljs-number">0</span> ? cmp : Long.compare(<span class="hljs-built_in">this</span>.seq, o.seq);
    }
}
</code></pre>
<p>è¿™æ ·ï¼Œç›¸åŒä¼˜å…ˆçº§çš„ä»»åŠ¡ä¼šæŒ‰æ’å…¥é¡ºåºå¤„ç†ã€‚</p>
<h2 data-id="heading-18">å…­ã€å®æˆ˜åº”ç”¨ï¼šTop-K é—®é¢˜</h2>
<p>PriorityQueue å¸¸ç”¨äºè§£å†³â€œTop-Kâ€é—®é¢˜ï¼Œä¾‹å¦‚æ‰¾å‡ºæ•°ç»„ä¸­æœ€å¤§çš„ K ä¸ªæ•°ã€‚</p>
<h3 data-id="heading-19">åœºæ™¯ï¼šæ‰¾å‡ºæˆç»©æœ€é«˜çš„3åå­¦ç”Ÿ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.*;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> {
    String name;
    <span class="hljs-type">double</span> score;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">(String name, <span class="hljs-type">double</span> score)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.score = score;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> name + <span class="hljs-string">": "</span> + score;
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TopKStudents</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;Student&gt; <span class="hljs-title function_">getTopK</span><span class="hljs-params">(List&lt;Student&gt; students, <span class="hljs-type">int</span> k)</span> {
        <span class="hljs-comment">// ä½¿ç”¨æœ€å°å †ç»´æŠ¤å‰kä¸ªæœ€é«˜åˆ†</span>
        PriorityQueue&lt;Student&gt; minHeap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;(
            (a, b) -&gt; Double.compare(a.score, b.score)
        );

        <span class="hljs-keyword">for</span> (Student s : students) {
            <span class="hljs-keyword">if</span> (minHeap.size() &lt; k) {
                minHeap.offer(s);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (s.score &gt; minHeap.peek().score) {
                minHeap.poll();
                minHeap.offer(s);
            }
        }

        <span class="hljs-comment">// è½¬ä¸ºåˆ—è¡¨ï¼ˆæ³¨æ„ï¼šå †å†…ä¸æ˜¯å®Œå…¨æœ‰åºï¼‰</span>
        List&lt;Student&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(minHeap);
        result.sort((a, b) -&gt; Double.compare(b.score, a.score)); <span class="hljs-comment">// é™åºæ’åˆ—</span>
        <span class="hljs-keyword">return</span> result;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        List&lt;Student&gt; students = Arrays.asList(
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">"Alice"</span>, <span class="hljs-number">92.5</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">"Bob"</span>, <span class="hljs-number">88.0</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">"Charlie"</span>, <span class="hljs-number">95.0</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">"Diana"</span>, <span class="hljs-number">87.5</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">"Eve"</span>, <span class="hljs-number">96.0</span>)
        );

        List&lt;Student&gt; top3 = getTopK(students, <span class="hljs-number">3</span>);
        top3.forEach(System.out::println);
    }
}
</code></pre>
<p><strong>è¾“å‡ºï¼š</strong></p>
<pre><code class="hljs language-text" lang="text">Eve: 96.0
Charlie: 95.0
Alice: 92.5
</code></pre>
<p>æ­¤æ–¹æ³•æ—¶é—´å¤æ‚åº¦ä¸º O(n log k)ï¼Œç©ºé—´å¤æ‚åº¦ä¸º O(k)ï¼Œæ¯”å…¨æ’åºï¼ˆO(n log n)ï¼‰æ›´é«˜æ•ˆã€‚</p>
<hr/>
<h2 data-id="heading-20">ä¸ƒã€æ³¨æ„äº‹é¡¹ä¸å¸¸è§è¯¯åŒº</h2>
<ol>
<li><strong>éå†é¡ºåºæ— æ„ä¹‰</strong><br/>
PriorityQueue çš„ <code>iterator()</code> ä¸ä¿è¯ä»¥ä¼˜å…ˆçº§é¡ºåºéå†å…ƒç´ ã€‚è‹¥éœ€æœ‰åºè¾“å‡ºï¼Œåº”ä¸æ–­è°ƒç”¨ <code>poll()</code>ã€‚</li>
<li><strong>ä¸å…è®¸ null å…ƒç´ </strong><br/>
æ’å…¥ null ä¼šæŠ›å‡º <code>NullPointerException</code>ã€‚</li>
<li><strong>ä¸å¯å˜å¯¹è±¡æ›´é€‚åˆ</strong><br/>
å¦‚æœé˜Ÿåˆ—ä¸­çš„å¯¹è±¡åœ¨æ’å…¥åè¢«ä¿®æ”¹ï¼ˆå°¤å…¶æ˜¯å½±å“æ¯”è¾ƒç»“æœçš„å­—æ®µï¼‰ï¼Œå¯èƒ½å¯¼è‡´å †ç»“æ„ç ´åï¼Œè¡Œä¸ºæœªå®šä¹‰ã€‚</li>
<li><strong>æ€§èƒ½æƒè¡¡</strong><br/>
<code>remove(Object o)</code> å’Œ <code>contains(Object o)</code> çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œä¸é€‚åˆé¢‘ç¹ä½¿ç”¨ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-21">å…«ã€ä¸å…¶ä»–é˜Ÿåˆ—çš„å¯¹æ¯”</h2>








































<table><thead><tr><th>é˜Ÿåˆ—ç±»å‹</th><th>æ˜¯å¦æœ‰åº</th><th>çº¿ç¨‹å®‰å…¨</th><th>åº•å±‚ç»“æ„</th><th>å…¸å‹ç”¨é€”</th></tr></thead><tbody><tr><td><code>LinkedList</code>ï¼ˆä½œä¸º Queueï¼‰</td><td>FIFO</td><td>å¦</td><td>åŒå‘é“¾è¡¨</td><td>æ™®é€šé˜Ÿåˆ—</td></tr><tr><td><code>PriorityQueue</code></td><td>æŒ‰ä¼˜å…ˆçº§</td><td>å¦</td><td>äºŒå‰å †</td><td>ä»»åŠ¡è°ƒåº¦ã€Top-K</td></tr><tr><td><code>PriorityBlockingQueue</code></td><td>æŒ‰ä¼˜å…ˆçº§</td><td>æ˜¯</td><td>äºŒå‰å †</td><td>å¤šçº¿ç¨‹ä»»åŠ¡é˜Ÿåˆ—</td></tr><tr><td><code>ArrayDeque</code></td><td>FIFO/LIFO</td><td>å¦</td><td>å¾ªç¯æ•°ç»„</td><td>é«˜æ•ˆåŒç«¯é˜Ÿåˆ—</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-22">ä¹ã€æ€»ç»“</h2>
<p>Java çš„ <code>PriorityQueue</code> æ˜¯ä¸€ä¸ªå¼ºå¤§è€Œé«˜æ•ˆçš„å·¥å…·ï¼Œé€‚ç”¨äºä»»ä½•éœ€è¦æŒ‰ä¼˜å…ˆçº§å¤„ç†å…ƒç´ çš„åœºæ™¯ã€‚å®ƒåŸºäºå †ç»“æ„å®ç°ï¼Œæä¾›äº† O(log n) çš„æ’å…¥å’Œåˆ é™¤æ€§èƒ½ï¼Œå¹¶æ”¯æŒé€šè¿‡ <code>Comparator</code> çµæ´»å®šä¹‰ä¼˜å…ˆçº§è§„åˆ™ã€‚</p>
<p>æŒæ¡ PriorityQueue çš„å…³é”®åœ¨äºç†è§£ï¼š</p>
<ul>
<li>é»˜è®¤æ˜¯æœ€å°å †ï¼›</li>
<li>å¿…é¡»æä¾›å¯æ¯”è¾ƒçš„å…ƒç´ ï¼ˆå®ç°Â <code>Comparable</code>Â æˆ–ä¼ å…¥Â <code>Comparator</code>ï¼‰ï¼›</li>
<li>éå†æ—¶ä¸èƒ½ä¾èµ–é¡ºåºï¼Œåº”ä½¿ç”¨Â <code>poll()</code>Â è·å–æœ‰åºç»“æœï¼›</li>
<li>åœ¨ Top-Kã€Dijkstra ç®—æ³•ã€Huffman ç¼–ç ç­‰ç®—æ³•ä¸­æœ‰å¹¿æ³›åº”ç”¨ã€‚</li>
</ul>
<p>é€šè¿‡æœ¬æ–‡çš„åŸç†è®²è§£ä¸å¤šä¸ªä»£ç ç¤ºä¾‹ï¼Œç›¸ä¿¡è¯»è€…å·²èƒ½ç†Ÿç»ƒè¿ç”¨ PriorityQueue è§£å†³å®é™…é—®é¢˜ã€‚åœ¨æœªæ¥çš„å¼€å‘ä¸­ï¼Œä¸å¦¨å¤šæ€è€ƒï¼šè¿™ä¸ªé—®é¢˜æ˜¯å¦å¯ä»¥ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—æ›´ä¼˜é›…åœ°è§£å†³ï¼Ÿ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶åˆ°ä¸€ï¼šæ‰“é€ ä¸“ä¸šçº§å°è¯´åœ°å›¾è®¾è®¡å·¥å…·çš„æŠ€æœ¯å®è·µ]]></title>    <link>https://juejin.cn/post/7583158173978427402</link>    <guid>https://juejin.cn/post/7583158173978427402</guid>    <pubDate>2025-12-14T04:30:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583158173978427402" data-draft-id="7583174749066313774" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶åˆ°ä¸€ï¼šæ‰“é€ ä¸“ä¸šçº§å°è¯´åœ°å›¾è®¾è®¡å·¥å…·çš„æŠ€æœ¯å®è·µ"/> <meta itemprop="keywords" content="å‰ç«¯,Electron"/> <meta itemprop="datePublished" content="2025-12-14T04:30:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¾™å›½æµªå­"/> <meta itemprop="url" content="https://juejin.cn/user/1943592291275886"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶åˆ°ä¸€ï¼šæ‰“é€ ä¸“ä¸šçº§å°è¯´åœ°å›¾è®¾è®¡å·¥å…·çš„æŠ€æœ¯å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1943592291275886/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¾™å›½æµªå­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T04:30:47.000Z" title="Sun Dec 14 2025 04:30:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ—ºï¸ ä»é›¶åˆ°ä¸€ï¼šæ‰“é€ ä¸“ä¸šçº§å°è¯´åœ°å›¾è®¾è®¡å·¥å…·çš„æŠ€æœ¯å®è·µ</h2>
<blockquote>
<p>ğŸ’¡ æœ¬æ–‡è¯¦ç»†ä»‹ç» 51mazi é¡¹ç›®ä¸­åœ°å›¾è®¾è®¡é¡µçš„æ•´ä½“æ¶æ„ä¸æ ¸å¿ƒåŠŸèƒ½å®ç°ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäº Vue 3 + Canvas çš„ä¸“ä¸šçº§åœ°å›¾ç¼–è¾‘å™¨ï¼Œé›†æˆäº†å¤šç§ç»˜å›¾å·¥å…·ã€èµ„æºç®¡ç†ã€ç¼©æ”¾æ§åˆ¶ç­‰å®Œæ•´åŠŸèƒ½ã€‚é€šè¿‡æ¨¡å—åŒ–çš„ Composables æ¶æ„è®¾è®¡ï¼Œå®ç°äº†é«˜å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§çš„ä»£ç ç»“æ„ã€‚</p>
</blockquote>
<h3 data-id="heading-1">ğŸ“‹ ç›®å½•</h3>
<ul>
<li><a href="#%E9%A1%B9%E7%9B%AE%E8%83%8C%E6%99%AF" title="#%E9%A1%B9%E7%9B%AE%E8%83%8C%E6%99%AF">é¡¹ç›®èƒŒæ™¯</a></li>
<li><a href="#%E6%8A%80%E6%9C%AF%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88" title="#%E6%8A%80%E6%9C%AF%E6%9E%B6%E6%9E%84%E6%A6%82%E8%A7%88">æŠ€æœ¯æ¶æ„æ¦‚è§ˆ</a></li>
<li><a href="#%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97" title="#%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%E6%A8%A1%E5%9D%97">æ ¸å¿ƒåŠŸèƒ½æ¨¡å—</a></li>
<li><a href="#%E6%A8%A1%E5%9D%97%E5%8C%96%E8%AE%BE%E8%AE%A1" title="#%E6%A8%A1%E5%9D%97%E5%8C%96%E8%AE%BE%E8%AE%A1">æ¨¡å—åŒ–è®¾è®¡</a></li>
<li><a href="#%E6%8A%80%E6%9C%AF%E4%BA%AE%E7%82%B9" title="#%E6%8A%80%E6%9C%AF%E4%BA%AE%E7%82%B9">æŠ€æœ¯äº®ç‚¹</a></li>
<li><a href="#%E6%80%BB%E7%BB%93%E4%B8%8E%E5%B1%95%E6%9C%9B" title="#%E6%80%BB%E7%BB%93%E4%B8%8E%E5%B1%95%E6%9C%9B">æ€»ç»“ä¸å±•æœ›</a></li>
</ul>
<h3 data-id="heading-2">ğŸ¯ é¡¹ç›®èƒŒæ™¯</h3>
<p>åœ¨å°è¯´åˆ›ä½œè¿‡ç¨‹ä¸­ï¼Œä½œè€…ç»å¸¸éœ€è¦ç»˜åˆ¶æ•…äº‹ä¸­çš„åœ°å›¾æ¥å¸®åŠ©è¯»è€…ç†è§£æ•…äº‹èƒŒæ™¯å’Œåœ°ç†å…³ç³»ã€‚ä¼ ç»Ÿçš„å†™ä½œè½¯ä»¶å¾€å¾€ç¼ºä¹è¿™æ ·çš„å¯è§†åŒ–å·¥å…·ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ 51mazi ä¸­é›†æˆäº†åŸºäº Canvas çš„ä¸“ä¸šçº§åœ°å›¾è®¾è®¡åŠŸèƒ½ã€‚</p>
<h4 data-id="heading-3">ğŸ—ºï¸ åœ°å›¾è®¾è®¡å·¥å…·</h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/795bd303ec2b415b93720627693383d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6b6Z5Zu95rWq5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766291447&amp;x-signature=0G2BSM99f3u1O1yiM%2B%2BJeekBvr8%3D" alt="maps.png" loading="lazy"/></p>
<p><em>å¼ºå¤§çš„åœ°å›¾è®¾è®¡å·¥å…· - ä¸“ä¸šçº§ Canvas ç»˜å›¾ä¸èµ„æºç®¡ç†</em></p>
<h4 data-id="heading-4">âœ¨ åŠŸèƒ½ç‰¹æ€§æ¦‚è§ˆ</h4>
<p>åœ°å›¾è®¾è®¡é¡µæä¾›äº†å®Œæ•´çš„ç»˜å›¾å·¥å…·é›†ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>ğŸ¨ <strong>10+ ç§ç»˜å›¾å·¥å…·</strong>: ç§»åŠ¨ã€é€‰æ¡†ã€ç”»ç¬”ã€æ©¡çš®æ“¦ã€å½¢çŠ¶ã€æ²¹æ¼†æ¡¶ã€æ–‡å­—ã€èµ„æºã€èƒŒæ™¯ç­‰</li>
<li>ğŸ” <strong>ç”»å¸ƒæ§åˆ¶</strong>: ç¼©æ”¾ã€å¹³ç§»ã€é‡ç½®è§†å›¾ï¼Œæ”¯æŒé¼ æ ‡æ»šè½®å’Œå¿«æ·é”®æ“ä½œ</li>
<li>ğŸ¯ <strong>ç²¾ç¡®æ“ä½œ</strong>: é€‰æ¡†å·¥å…·æ”¯æŒé€‰æ‹©ã€ç§»åŠ¨ã€è°ƒæ•´å¤§å°ã€æ—‹è½¬ç­‰æ“ä½œ</li>
<li>ğŸ’¾ <strong>æ•°æ®ç®¡ç†</strong>: å®Œæ•´çš„æ’¤é”€/é‡åšç³»ç»Ÿï¼Œè‡ªåŠ¨ä¿å­˜å’ŒåŠ è½½åœ°å›¾æ•°æ®</li>
<li>ğŸ¨ <strong>å‚æ•°æ§åˆ¶</strong>: é¢œè‰²é€‰æ‹©å™¨ã€å¤§å°æ»‘å—ã€é€æ˜åº¦æ»‘å—ï¼Œç²¾ç¡®æ§åˆ¶ç»˜åˆ¶æ•ˆæœ</li>
<li>ğŸ–¼ï¸ <strong>èµ„æºç®¡ç†</strong>: é¢„è®¾å›¾æ ‡èµ„æºåº“ï¼Œæ”¯æŒæ‹–æ‹½æ·»åŠ å’Œè°ƒæ•´</li>
<li>âŒ¨ï¸ <strong>å¿«æ·é”®æ”¯æŒ</strong>: å®Œæ•´çš„é”®ç›˜å¿«æ·é”®ç³»ç»Ÿï¼Œæå‡æ“ä½œæ•ˆç‡</li>
</ul>
<h3 data-id="heading-5">ğŸ—ï¸ æŠ€æœ¯æ¶æ„æ¦‚è§ˆ</h3>
<h4 data-id="heading-6">æŠ€æœ¯æ ˆ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ ¸å¿ƒæŠ€æœ¯æ ˆ</span>
{
  <span class="hljs-string">"vue"</span>: <span class="hljs-string">"^3.5.13"</span>,           <span class="hljs-comment">// Vue 3 Composition API</span>
  <span class="hljs-string">"element-plus"</span>: <span class="hljs-string">"^2.10.1"</span>,  <span class="hljs-comment">// UI ç»„ä»¶åº“</span>
  <span class="hljs-string">"canvas"</span>: <span class="hljs-string">"åŸç”Ÿ Canvas API"</span>  <span class="hljs-comment">// ç»˜å›¾å¼•æ“</span>
}
</code></pre>
<h4 data-id="heading-7">æ•´ä½“æ¶æ„è®¾è®¡</h4>
<p>åœ°å›¾è®¾è®¡é¡µé‡‡ç”¨ <strong>æ¨¡å—åŒ–çš„ Composables æ¶æ„</strong>ï¼Œå°†ä¸åŒåŠŸèƒ½æ‹†åˆ†ä¸ºç‹¬ç«‹çš„ composable å‡½æ•°ï¼Œå®ç°äº†æ¸…æ™°çš„ä»£ç ç»„ç»‡å’Œé«˜åº¦å¯ç»´æŠ¤æ€§ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">MapDesign.vue (ä¸»ç»„ä»¶)
â”œâ”€â”€ åŸºç¡€ Composables
â”‚   â”œâ”€â”€ useCanvasState.js      <span class="hljs-comment"># ç”»å¸ƒçŠ¶æ€ç®¡ç†ï¼ˆç¼©æ”¾ã€å¹³ç§»ã€è¾¹ç•Œï¼‰</span>
â”‚   â”œâ”€â”€ useCoordinate.js       <span class="hljs-comment"># åæ ‡è½¬æ¢å·¥å…·</span>
â”‚   â”œâ”€â”€ useHistory.js          <span class="hljs-comment"># å†å²è®°å½•ç®¡ç†ï¼ˆæ’¤é”€/é‡åšï¼‰</span>
â”‚   â”œâ”€â”€ useElements.js         <span class="hljs-comment"># å…ƒç´ æ•°æ®ç®¡ç†</span>
â”‚   â”œâ”€â”€ useRender.js           <span class="hljs-comment"># æ¸²æŸ“å‡½æ•°é›†åˆ</span>
â”‚   â””â”€â”€ useCanvas.js            <span class="hljs-comment"># ç”»å¸ƒæ¸²æŸ“å’Œç®¡ç†</span>
â”‚
â””â”€â”€ å·¥å…· Composables
    â”œâ”€â”€ usePencilTool.js        <span class="hljs-comment"># ç”»ç¬”å·¥å…·</span>
    â”œâ”€â”€ useEraserTool.js        <span class="hljs-comment"># æ©¡çš®æ“¦å·¥å…·</span>
    â”œâ”€â”€ useShapeTool.js         <span class="hljs-comment"># å½¢çŠ¶å·¥å…·ï¼ˆçº¿æ¡ã€çŸ©å½¢ã€åœ†å½¢ç­‰ï¼‰</span>
    â”œâ”€â”€ useTextTool.js          <span class="hljs-comment"># æ–‡å­—å·¥å…·</span>
    â”œâ”€â”€ useBucketTool.js        <span class="hljs-comment"># æ²¹æ¼†æ¡¶å·¥å…·</span>
    â”œâ”€â”€ useResourceTool.js      <span class="hljs-comment"># èµ„æºå·¥å…·</span>
    â”œâ”€â”€ useSelectTool.js        <span class="hljs-comment"># é€‰æ¡†å·¥å…·ï¼ˆé€‰æ‹©ã€ç§»åŠ¨ã€è°ƒæ•´ã€æ—‹è½¬ï¼‰</span>
    â”œâ”€â”€ useMoveTool.js          <span class="hljs-comment"># ç§»åŠ¨å·¥å…·ï¼ˆå¹³ç§»ç”»å¸ƒï¼‰</span>
    â””â”€â”€ useBackgroundTool.js    <span class="hljs-comment"># èƒŒæ™¯å·¥å…·</span>
</code></pre>
<h4 data-id="heading-8">æ ¸å¿ƒç»„ä»¶ç»“æ„</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- src/renderer/src/views/MapDesign.vue --&gt;
&lt;template&gt;
  &lt;div class="map-design"&gt;
    &lt;!-- å·¥å…·æ  --&gt;
    &lt;MapToolbar
      v-model="tool"
      :shape-tool-type="shapeToolType"
      @update:model-value="onToolChange"
      @clear="handleClearCanvas"
      @resource-select="selectResource"
      @save-map="handleSaveMap"
    /&gt;

    &lt;!-- é¢œè‰²é€‰æ‹©å™¨ --&gt;
    &lt;Transition name="color-picker-fade"&gt;
      &lt;div v-if="showColorPicker" class="color-picker-container"&gt;
        &lt;el-color-picker v-model="currentColor" /&gt;
      &lt;/div&gt;
    &lt;/Transition&gt;

    &lt;!-- æ»‘å—æ§åˆ¶å·¥å…· --&gt;
    &lt;FloatingSidebar :visible="tool === 'pencil' || tool === 'eraser' || tool === 'shape'"&gt;
      &lt;MapSlider v-model="size" label="å¤§å°" /&gt;
      &lt;MapSlider v-model="opacity" label="é€æ˜åº¦" /&gt;
    &lt;/FloatingSidebar&gt;

    &lt;!-- ç”»å¸ƒå®¹å™¨ --&gt;
    &lt;div class="editor-container" @wheel="handleWheel"&gt;
      &lt;canvas
        ref="canvasRef"
        :width="canvasDisplayWidth"
        :height="canvasDisplayHeight"
        @mousedown="handleCanvasMouseDown"
        @mousemove="handleCanvasMouseMove"
        @mouseup="handleCanvasMouseUp"
      /&gt;
    &lt;/div&gt;

    &lt;!-- ç¼©æ”¾æ§åˆ¶å™¨å’Œæ’¤é”€/å›é€€æŒ‰é’® --&gt;
    &lt;MapZoomControls
      :scale="canvasState.scale.value"
      @zoom-in="handleZoomIn"
      @zoom-out="handleZoomOut"
      @reset-zoom="handleResetZoom"
      @undo="handleUndo"
      @redo="handleRedo"
    /&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>å®Œæ•´ä»£ç è¯·æŸ¥çœ‹</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxiaoshengxianjun%2F51mazi%2Fblob%2Fmain%2Fsrc%2Frenderer%2Fsrc%2Fviews%2FMapDesign.vue" target="_blank" title="https://github.com/xiaoshengxianjun/51mazi/blob/main/src/renderer/src/views/MapDesign.vue" ref="nofollow noopener noreferrer">src/renderer/src/views/MapDesign.vue</a></p>
</blockquote>
<h3 data-id="heading-9">ğŸ”§ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—</h3>
<h4 data-id="heading-10">1. ç”»å¸ƒçŠ¶æ€ç®¡ç† (useCanvasState)</h4>
<p>ç®¡ç†ç”»å¸ƒçš„ç¼©æ”¾ã€å¹³ç§»ã€è¾¹ç•Œç­‰æ ¸å¿ƒçŠ¶æ€ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ ¸å¿ƒçŠ¶æ€ç®¡ç†</span>
<span class="hljs-keyword">const</span> canvasState = <span class="hljs-title function_">useCanvasState</span>()

<span class="hljs-comment">// ä¸»è¦çŠ¶æ€</span>
- <span class="hljs-attr">scale</span>: ç”»å¸ƒç¼©æ”¾æ¯”ä¾‹
- scrollX/<span class="hljs-attr">scrollY</span>: ç”»å¸ƒå¹³ç§»åç§»
- <span class="hljs-attr">contentBounds</span>: å†…å®¹è¾¹ç•Œï¼ˆç”¨äºè‡ªåŠ¨è°ƒæ•´ç”»å¸ƒå¤§å°ï¼‰
- canvasDisplayWidth/<span class="hljs-title class_">Height</span>: ç”»å¸ƒæ˜¾ç¤ºå°ºå¯¸
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>è¯¦ç»†å®ç°è¯·æŸ¥çœ‹</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxiaoshengxianjun%2F51mazi%2Fblob%2Fmain%2Fsrc%2Frenderer%2Fsrc%2Fcomposables%2Fmap%2FuseCanvasState.js" target="_blank" title="https://github.com/xiaoshengxianjun/51mazi/blob/main/src/renderer/src/composables/map/useCanvasState.js" ref="nofollow noopener noreferrer">src/renderer/src/composables/map/useCanvasState.js</a></p>
</blockquote>
<h4 data-id="heading-11">2. å…ƒç´ ç®¡ç†ç³»ç»Ÿ (useElements)</h4>
<p>ç»Ÿä¸€ç®¡ç†æ‰€æœ‰ç»˜åˆ¶å…ƒç´ ï¼ŒåŒ…æ‹¬ç”»ç¬”è·¯å¾„ã€å½¢çŠ¶ã€æ–‡å­—ã€èµ„æºã€å¡«å……åŒºåŸŸç­‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å…ƒç´ ç±»å‹</span>
<span class="hljs-keyword">const</span> elements = <span class="hljs-title function_">useElements</span>()

<span class="hljs-comment">// å…ƒç´ åˆ†ç±»</span>
- <span class="hljs-attr">freeDrawElements</span>: ç”»ç¬”ç»˜åˆ¶çš„è·¯å¾„
- <span class="hljs-attr">shapeElements</span>: å½¢çŠ¶å…ƒç´ ï¼ˆçº¿æ¡ã€çŸ©å½¢ã€åœ†å½¢ç­‰ï¼‰
- <span class="hljs-attr">textElements</span>: æ–‡å­—å…ƒç´ 
- <span class="hljs-attr">resourceElements</span>: èµ„æºå…ƒç´ ï¼ˆå›¾æ ‡ã€å›¾ç‰‡ï¼‰
- <span class="hljs-attr">fillElements</span>: å¡«å……åŒºåŸŸ

<span class="hljs-comment">// æ ¸å¿ƒæ–¹æ³•</span>
- <span class="hljs-title function_">serialize</span>(): åºåˆ—åŒ–æ‰€æœ‰å…ƒç´ ä¸º <span class="hljs-title class_">JSON</span>
- <span class="hljs-title function_">deserialize</span>(): ä» <span class="hljs-title class_">JSON</span> æ¢å¤å…ƒç´ 
- <span class="hljs-title function_">clearAll</span>(): æ¸…ç©ºæ‰€æœ‰å…ƒç´ 
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>è¯¦ç»†å®ç°è¯·æŸ¥çœ‹</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxiaoshengxianjun%2F51mazi%2Fblob%2Fmain%2Fsrc%2Frenderer%2Fsrc%2Fcomposables%2Fmap%2FuseElements.js" target="_blank" title="https://github.com/xiaoshengxianjun/51mazi/blob/main/src/renderer/src/composables/map/useElements.js" ref="nofollow noopener noreferrer">src/renderer/src/composables/map/useElements.js</a></p>
</blockquote>
<h4 data-id="heading-12">3. å†å²è®°å½•ç³»ç»Ÿ (useHistory)</h4>
<p>å®ç°å®Œæ•´çš„æ’¤é”€/é‡åšåŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å†å²è®°å½•ç®¡ç†</span>
<span class="hljs-keyword">const</span> { history } = <span class="hljs-title function_">useHistory</span>(canvasRef)

<span class="hljs-comment">// æ ¸å¿ƒåŠŸèƒ½</span>
- <span class="hljs-title function_">saveState</span>(): ä¿å­˜å½“å‰çŠ¶æ€
- <span class="hljs-title function_">undo</span>(): æ’¤é”€æ“ä½œ
- <span class="hljs-title function_">redo</span>(): é‡åšæ“ä½œ
- <span class="hljs-title function_">canUndo</span>(): æ˜¯å¦å¯ä»¥æ’¤é”€
- <span class="hljs-title function_">canRedo</span>(): æ˜¯å¦å¯ä»¥é‡åš
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>è¯¦ç»†å®ç°è¯·æŸ¥çœ‹</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxiaoshengxianjun%2F51mazi%2Fblob%2Fmain%2Fsrc%2Frenderer%2Fsrc%2Fcomposables%2Fmap%2FuseHistory.js" target="_blank" title="https://github.com/xiaoshengxianjun/51mazi/blob/main/src/renderer/src/composables/map/useHistory.js" ref="nofollow noopener noreferrer">src/renderer/src/composables/map/useHistory.js</a></p>
</blockquote>
<h4 data-id="heading-13">4. æ¸²æŸ“ç³»ç»Ÿ (useRender)</h4>
<p>ç»Ÿä¸€çš„æ¸²æŸ“å‡½æ•°é›†åˆï¼Œè´Ÿè´£ç»˜åˆ¶å„ç§å…ƒç´ ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¸²æŸ“å‡½æ•°</span>
<span class="hljs-keyword">const</span> renderFunctions = <span class="hljs-title function_">useRender</span>(canvasRef)

<span class="hljs-comment">// æ¸²æŸ“æ–¹æ³•</span>
- <span class="hljs-title function_">renderFreeDrawPath</span>(): æ¸²æŸ“ç”»ç¬”è·¯å¾„
- <span class="hljs-title function_">renderShape</span>(): æ¸²æŸ“å½¢çŠ¶ï¼ˆä½¿ç”¨ <span class="hljs-title class_">Rough</span>.<span class="hljs-property">js</span>ï¼‰
- <span class="hljs-title function_">renderText</span>(): æ¸²æŸ“æ–‡å­—
- <span class="hljs-title function_">renderResource</span>(): æ¸²æŸ“èµ„æºï¼ˆå›¾æ ‡/å›¾ç‰‡ï¼‰
- <span class="hljs-title function_">renderFill</span>(): æ¸²æŸ“å¡«å……åŒºåŸŸ
- <span class="hljs-title function_">renderSelection</span>(): æ¸²æŸ“é€‰æ¡†
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>è¯¦ç»†å®ç°è¯·æŸ¥çœ‹</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxiaoshengxianjun%2F51mazi%2Fblob%2Fmain%2Fsrc%2Frenderer%2Fsrc%2Fcomposables%2Fmap%2FuseRender.js" target="_blank" title="https://github.com/xiaoshengxianjun/51mazi/blob/main/src/renderer/src/composables/map/useRender.js" ref="nofollow noopener noreferrer">src/renderer/src/composables/map/useRender.js</a></p>
</blockquote>
<h4 data-id="heading-14">5. å·¥å…·ç³»ç»Ÿ</h4>
<p>æ¯ä¸ªç»˜å›¾å·¥å…·éƒ½æ˜¯ç‹¬ç«‹çš„ composableï¼Œå®ç°äº†ç»Ÿä¸€çš„æ¥å£ï¼š</p>
<h5 data-id="heading-15">ç”»ç¬”å·¥å…· (usePencilTool)</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> pencilTool = <span class="hljs-title function_">usePencilTool</span>({
  canvasRef,
  elements,
  history,
  renderCanvas,
  color,
  size,
  opacity
})

<span class="hljs-comment">// æ ¸å¿ƒæ–¹æ³•</span>
- <span class="hljs-title function_">onMouseDown</span>(): å¼€å§‹ç»˜åˆ¶
- <span class="hljs-title function_">onMouseMove</span>(): ç»˜åˆ¶è¿‡ç¨‹
- <span class="hljs-title function_">onMouseUp</span>(): ç»“æŸç»˜åˆ¶
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>è¯¦ç»†å®ç°è¯·æŸ¥çœ‹</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxiaoshengxianjun%2F51mazi%2Fblob%2Fmain%2Fsrc%2Frenderer%2Fsrc%2Fcomposables%2Fmap%2Ftools%2FusePencilTool.js" target="_blank" title="https://github.com/xiaoshengxianjun/51mazi/blob/main/src/renderer/src/composables/map/tools/usePencilTool.js" ref="nofollow noopener noreferrer">src/renderer/src/composables/map/tools/usePencilTool.js</a></p>
</blockquote>
<h5 data-id="heading-16">é€‰æ¡†å·¥å…· (useSelectTool)</h5>
<p>æœ€å¤æ‚çš„å·¥å…·ä¹‹ä¸€ï¼Œæ”¯æŒé€‰æ‹©ã€ç§»åŠ¨ã€è°ƒæ•´å¤§å°ã€æ—‹è½¬ç­‰æ“ä½œï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> selectTool = <span class="hljs-title function_">useSelectTool</span>({
  elements,
  history,
  renderCanvas,
  selectedElementIds,
  canvasState,
  canvasCursor
})

<span class="hljs-comment">// æ ¸å¿ƒåŠŸèƒ½</span>
- å•é€‰å’Œå¤šé€‰
- æ‹–æ‹½ç§»åŠ¨å…ƒç´ 
- è°ƒæ•´å…ƒç´ å¤§å°ï¼ˆ<span class="hljs-number">8</span>ä¸ªæ§åˆ¶ç‚¹ï¼‰
- æ—‹è½¬å…ƒç´ 
- åˆ é™¤é€‰ä¸­å…ƒç´ 
- æ™ºèƒ½å…‰æ ‡æ ·å¼
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>è¯¦ç»†å®ç°è¯·æŸ¥çœ‹</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxiaoshengxianjun%2F51mazi%2Fblob%2Fmain%2Fsrc%2Frenderer%2Fsrc%2Fcomposables%2Fmap%2Ftools%2FuseSelectTool.js" target="_blank" title="https://github.com/xiaoshengxianjun/51mazi/blob/main/src/renderer/src/composables/map/tools/useSelectTool.js" ref="nofollow noopener noreferrer">src/renderer/src/composables/map/tools/useSelectTool.js</a></p>
</blockquote>
<h5 data-id="heading-17">å½¢çŠ¶å·¥å…· (useShapeTool)</h5>
<p>æ”¯æŒå¤šç§å½¢çŠ¶ç»˜åˆ¶ï¼šçº¿æ¡ã€çŸ©å½¢ã€åœ†å½¢ã€åœ†è§’çŸ©å½¢ã€äº”è§’æ˜Ÿã€ç®­å¤´ç­‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> shapeTool = <span class="hljs-title function_">useShapeTool</span>({
  canvasRef,
  elements,
  history,
  renderCanvas,
  color,
  size,
  opacity
})

<span class="hljs-comment">// æ”¯æŒçš„å½¢çŠ¶ç±»å‹</span>
- <span class="hljs-attr">line</span>: çº¿æ¡
- <span class="hljs-attr">rect</span>: çŸ©å½¢
- <span class="hljs-attr">circle</span>: åœ†å½¢
- <span class="hljs-attr">roundRect</span>: åœ†è§’çŸ©å½¢
- <span class="hljs-attr">star</span>: äº”è§’æ˜Ÿ
- <span class="hljs-attr">arrow</span>: ç®­å¤´
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>è¯¦ç»†å®ç°è¯·æŸ¥çœ‹</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxiaoshengxianjun%2F51mazi%2Fblob%2Fmain%2Fsrc%2Frenderer%2Fsrc%2Fcomposables%2Fmap%2Ftools%2FuseShapeTool.js" target="_blank" title="https://github.com/xiaoshengxianjun/51mazi/blob/main/src/renderer/src/composables/map/tools/useShapeTool.js" ref="nofollow noopener noreferrer">src/renderer/src/composables/map/tools/useShapeTool.js</a></p>
</blockquote>
<h5 data-id="heading-18">å…¶ä»–å·¥å…·</h5>
<ul>
<li><strong>æ©¡çš®æ“¦å·¥å…·</strong>: ç²¾ç¡®æ“¦é™¤å·²ç»˜åˆ¶å†…å®¹</li>
<li><strong>æ–‡å­—å·¥å…·</strong>: æ·»åŠ æ–‡å­—æ ‡æ³¨ï¼Œæ”¯æŒåŒå‡»ç¼–è¾‘</li>
<li><strong>æ²¹æ¼†æ¡¶å·¥å…·</strong>: åŒºåŸŸå¡«å……ï¼Œä½¿ç”¨æ´ªæ°´å¡«å……ç®—æ³•</li>
<li><strong>èµ„æºå·¥å…·</strong>: æ‹–æ‹½æ·»åŠ é¢„è®¾å›¾æ ‡å’Œå›¾ç‰‡</li>
<li><strong>ç§»åŠ¨å·¥å…·</strong>: å¹³ç§»ç”»å¸ƒè§†å›¾</li>
<li><strong>èƒŒæ™¯å·¥å…·</strong>: è®¾ç½®ç”»å¸ƒèƒŒæ™¯è‰²</li>
</ul>
<blockquote>
<p>ğŸ’¡ <strong>æ‰€æœ‰å·¥å…·å®ç°è¯·æŸ¥çœ‹</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxiaoshengxianjun%2F51mazi%2Ftree%2Fmain%2Fsrc%2Frenderer%2Fsrc%2Fcomposables%2Fmap%2Ftools" target="_blank" title="https://github.com/xiaoshengxianjun/51mazi/tree/main/src/renderer/src/composables/map/tools" ref="nofollow noopener noreferrer">src/renderer/src/composables/map/tools/</a></p>
</blockquote>
<h3 data-id="heading-19">ğŸ¨ æ¨¡å—åŒ–è®¾è®¡</h3>
<h4 data-id="heading-20">Composables æ¶æ„ä¼˜åŠ¿</h4>
<ol>
<li><strong>é«˜å†…èšä½è€¦åˆ</strong>: æ¯ä¸ª composable ä¸“æ³¨äºå•ä¸€èŒè´£</li>
<li><strong>æ˜“äºæµ‹è¯•</strong>: ç‹¬ç«‹çš„ composable ä¾¿äºå•å…ƒæµ‹è¯•</li>
<li><strong>ä»£ç å¤ç”¨</strong>: å¯ä»¥åœ¨å…¶ä»–ç»„ä»¶ä¸­å¤ç”¨ç›¸åŒçš„ composable</li>
<li><strong>æ˜“äºç»´æŠ¤</strong>: ä¿®æ”¹æŸä¸ªåŠŸèƒ½åªéœ€å…³æ³¨å¯¹åº”çš„ composable</li>
<li><strong>ç±»å‹å®‰å…¨</strong>: æ¸…æ™°çš„æ¥å£å®šä¹‰ï¼Œå‡å°‘é”™è¯¯</li>
</ol>
<h4 data-id="heading-21">å·¥å…·ç»Ÿä¸€æ¥å£</h4>
<p>æ‰€æœ‰å·¥å…· composable éƒ½éµå¾ªç»Ÿä¸€çš„æ¥å£æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å·¥å…·æ¥å£è§„èŒƒ</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useXxxTool</span>(<span class="hljs-params">options</span>) {
  <span class="hljs-comment">// çŠ¶æ€</span>
  <span class="hljs-keyword">const</span> drawingActive = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>)
  
  <span class="hljs-comment">// æ–¹æ³•</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">onMouseDown</span>(<span class="hljs-params">pos</span>) { <span class="hljs-comment">/* ... */</span> }
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">onMouseMove</span>(<span class="hljs-params">pos</span>) { <span class="hljs-comment">/* ... */</span> }
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">onMouseUp</span>(<span class="hljs-params"/>) { <span class="hljs-comment">/* ... */</span> }
  
  <span class="hljs-keyword">return</span> {
    drawingActive,
    onMouseDown,
    onMouseMove,
    onMouseUp
  }
}
</code></pre>
<h4 data-id="heading-22">äº‹ä»¶å¤„ç†æµç¨‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç»Ÿä¸€çš„äº‹ä»¶å¤„ç†</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleCanvasMouseDown</span>(<span class="hljs-params">e</span>) {
  <span class="hljs-keyword">const</span> pos = <span class="hljs-title function_">getCanvasPos</span>(e) <span class="hljs-comment">// åæ ‡è½¬æ¢</span>
  
  <span class="hljs-comment">// æ ¹æ®å½“å‰å·¥å…·è°ƒç”¨å¯¹åº”çš„æ–¹æ³•</span>
  <span class="hljs-keyword">if</span> (tool.<span class="hljs-property">value</span> === <span class="hljs-string">'pencil'</span>) {
    pencilTool.<span class="hljs-title function_">onMouseDown</span>(pos)
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tool.<span class="hljs-property">value</span> === <span class="hljs-string">'eraser'</span>) {
    eraserTool.<span class="hljs-title function_">onMouseDown</span>(pos)
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tool.<span class="hljs-property">value</span> === <span class="hljs-string">'shape'</span>) {
    shapeTool.<span class="hljs-title function_">onMouseDown</span>(pos)
  }
  <span class="hljs-comment">// ... å…¶ä»–å·¥å…·</span>
}
</code></pre>
<h3 data-id="heading-23">âš¡ æŠ€æœ¯äº®ç‚¹</h3>
<h4 data-id="heading-24">1. åæ ‡è½¬æ¢ç³»ç»Ÿ</h4>
<p>å®ç°å±å¹•åæ ‡åˆ°ç”»å¸ƒåæ ‡çš„ç²¾ç¡®è½¬æ¢ï¼Œæ”¯æŒç¼©æ”¾å’Œå¹³ç§»ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åæ ‡è½¬æ¢</span>
<span class="hljs-keyword">const</span> { getCanvasPos } = <span class="hljs-title function_">useCoordinate</span>(
  canvasRef,
  editorContainerRef,
  canvasState.<span class="hljs-property">scale</span>,
  canvasState.<span class="hljs-property">scrollX</span>,
  canvasState.<span class="hljs-property">scrollY</span>
)

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> pos = <span class="hljs-title function_">getCanvasPos</span>(event) <span class="hljs-comment">// è‡ªåŠ¨å¤„ç†ç¼©æ”¾å’Œå¹³ç§»</span>
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>è¯¦ç»†å®ç°è¯·æŸ¥çœ‹</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxiaoshengxianjun%2F51mazi%2Fblob%2Fmain%2Fsrc%2Frenderer%2Fsrc%2Fcomposables%2Fmap%2FuseCoordinate.js" target="_blank" title="https://github.com/xiaoshengxianjun/51mazi/blob/main/src/renderer/src/composables/map/useCoordinate.js" ref="nofollow noopener noreferrer">src/renderer/src/composables/map/useCoordinate.js</a></p>
</blockquote>
<h4 data-id="heading-25">2. æ™ºèƒ½ç”»å¸ƒç®¡ç†</h4>
<p>è‡ªåŠ¨è°ƒæ•´ç”»å¸ƒå¤§å°ä»¥é€‚åº”å†…å®¹ï¼Œæ”¯æŒæ— é™ç”»å¸ƒï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç”»å¸ƒç®¡ç†</span>
<span class="hljs-keyword">const</span> { renderCanvas, canvasWrapStyle, updateContentBounds } = <span class="hljs-title function_">useCanvas</span>(
  canvasRef,
  editorContainerRef,
  canvasState,
  elements,
  <span class="hljs-comment">// ... å…¶ä»–å‚æ•°</span>
)

<span class="hljs-comment">// è‡ªåŠ¨æ›´æ–°å†…å®¹è¾¹ç•Œ</span>
<span class="hljs-title function_">updateContentBounds</span>()
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>è¯¦ç»†å®ç°è¯·æŸ¥çœ‹</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxiaoshengxianjun%2F51mazi%2Fblob%2Fmain%2Fsrc%2Frenderer%2Fsrc%2Fcomposables%2Fmap%2FuseCanvas.js" target="_blank" title="https://github.com/xiaoshengxianjun/51mazi/blob/main/src/renderer/src/composables/map/useCanvas.js" ref="nofollow noopener noreferrer">src/renderer/src/composables/map/useCanvas.js</a></p>
</blockquote>
<h4 data-id="heading-26">3. ç¼©æ”¾æ§åˆ¶</h4>
<p>æ”¯æŒå¤šç§ç¼©æ”¾æ–¹å¼ï¼šé¼ æ ‡æ»šè½®ã€æŒ‰é’®ã€å¿«æ·é”®ï¼Œä»¥é¼ æ ‡ä½ç½®ä¸ºä¸­å¿ƒç¼©æ”¾ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç¼©æ”¾æ§åˆ¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleWheel</span>(<span class="hljs-params">e</span>) {
  <span class="hljs-comment">// Ctrl/Cmd + æ»šè½®ï¼šç¼©æ”¾</span>
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">ctrlKey</span> || e.<span class="hljs-property">metaKey</span>) {
    <span class="hljs-comment">// ä»¥é¼ æ ‡ä½ç½®ä¸ºä¸­å¿ƒç¼©æ”¾</span>
    <span class="hljs-keyword">const</span> sceneX = mouseX / scale.<span class="hljs-property">value</span> - scrollX.<span class="hljs-property">value</span>
    <span class="hljs-keyword">const</span> sceneY = mouseY / scale.<span class="hljs-property">value</span> - scrollY.<span class="hljs-property">value</span>
    <span class="hljs-comment">// ... è®¡ç®—æ–°çš„ç¼©æ”¾å’Œå¹³ç§»</span>
  }
}
</code></pre>
<h4 data-id="heading-27">4. æ•°æ®åºåˆ—åŒ–</h4>
<p>å®Œæ•´çš„åœ°å›¾æ•°æ®åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œæ”¯æŒä¿å­˜å’ŒåŠ è½½ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¿å­˜åœ°å›¾</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleSaveMap</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// ç”Ÿæˆé¢„è§ˆå›¾</span>
  <span class="hljs-keyword">const</span> imageData = <span class="hljs-keyword">await</span> <span class="hljs-title function_">generatePreviewImage</span>()
  
  <span class="hljs-comment">// åºåˆ—åŒ–ç”»æ¿å†…å®¹</span>
  <span class="hljs-keyword">const</span> mapData = elements.<span class="hljs-title function_">serialize</span>(backgroundColor.<span class="hljs-property">value</span>)
  
  <span class="hljs-comment">// ä¿å­˜åˆ°æ–‡ä»¶ç³»ç»Ÿ</span>
  <span class="hljs-keyword">await</span> <span class="hljs-variable language_">window</span>.<span class="hljs-property">electron</span>.<span class="hljs-title function_">updateMap</span>({
    bookName,
    <span class="hljs-attr">mapName</span>: mapName.<span class="hljs-property">value</span>,
    imageData,
    mapData
  })
}

<span class="hljs-comment">// åŠ è½½åœ°å›¾</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadMapData</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> mapData = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">window</span>.<span class="hljs-property">electron</span>.<span class="hljs-title function_">loadMapData</span>({ bookName, mapName })
  <span class="hljs-keyword">if</span> (mapData) {
    <span class="hljs-keyword">const</span> loadedBackgroundColor = elements.<span class="hljs-title function_">deserialize</span>(mapData)
    backgroundColor.<span class="hljs-property">value</span> = loadedBackgroundColor
    <span class="hljs-title function_">renderCanvas</span>(<span class="hljs-literal">true</span>)
  }
}
</code></pre>
<h4 data-id="heading-28">5. å¿«æ·é”®ç³»ç»Ÿ</h4>
<p>å®Œæ•´çš„é”®ç›˜å¿«æ·é”®æ”¯æŒï¼Œæå‡æ“ä½œæ•ˆç‡ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¿«æ·é”®é…ç½®</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleKeyDown</span>(<span class="hljs-params">e</span>) {
  <span class="hljs-comment">// å·¥å…·å¿«æ·é”®</span>
  <span class="hljs-keyword">switch</span> (e.<span class="hljs-property">key</span>.<span class="hljs-title function_">toLowerCase</span>()) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'v'</span>: <span class="hljs-title function_">onToolChange</span>(<span class="hljs-string">'select'</span>); <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">'h'</span>: <span class="hljs-title function_">onToolChange</span>(<span class="hljs-string">'move'</span>); <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">'p'</span>: <span class="hljs-title function_">onToolChange</span>(<span class="hljs-string">'pencil'</span>); <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">'e'</span>: <span class="hljs-title function_">onToolChange</span>(<span class="hljs-string">'eraser'</span>); <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">'s'</span>: <span class="hljs-title function_">onToolChange</span>(<span class="hljs-string">'shape'</span>); <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">'t'</span>: <span class="hljs-title function_">onToolChange</span>(<span class="hljs-string">'text'</span>); <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">'b'</span>: <span class="hljs-title function_">onToolChange</span>(<span class="hljs-string">'bucket'</span>); <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">'r'</span>: <span class="hljs-title function_">onToolChange</span>(<span class="hljs-string">'resource'</span>); <span class="hljs-keyword">break</span>
  }
  
  <span class="hljs-comment">// æ’¤é”€/é‡åš</span>
  <span class="hljs-keyword">if</span> ((e.<span class="hljs-property">ctrlKey</span> || e.<span class="hljs-property">metaKey</span>) &amp;&amp; e.<span class="hljs-property">key</span> === <span class="hljs-string">'z'</span>) {
    <span class="hljs-title function_">handleUndo</span>()
  }
  
  <span class="hljs-comment">// ç©ºæ ¼é”®ï¼šä¸´æ—¶åˆ‡æ¢åˆ°ç§»åŠ¨æ¨¡å¼</span>
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">' '</span> &amp;&amp; tool.<span class="hljs-property">value</span> !== <span class="hljs-string">'move'</span>) {
    spaceKeyPressed.<span class="hljs-property">value</span> = <span class="hljs-literal">true</span>
  }
}
</code></pre>
<h4 data-id="heading-29">6. èµ„æºç®¡ç†ç³»ç»Ÿ</h4>
<p>æ”¯æŒé¢„è®¾å›¾æ ‡èµ„æºåº“ï¼Œæ‹–æ‹½æ·»åŠ å’Œè°ƒæ•´ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// èµ„æºå·¥å…·</span>
<span class="hljs-keyword">const</span> resourceTool = <span class="hljs-title function_">useResourceTool</span>({
  canvasRef,
  elements,
  history,
  renderCanvas,
  getCanvasPos
})

<span class="hljs-comment">// æ”¯æŒçš„åŠŸèƒ½</span>
- å›¾æ ‡èµ„æºåº“ï¼ˆ<span class="hljs-variable constant_">SVG</span> å›¾æ ‡ï¼‰
- æ‹–æ‹½æ·»åŠ èµ„æº
- è°ƒæ•´èµ„æºå¤§å°å’Œä½ç½®
- æ—‹è½¬èµ„æº
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>è¯¦ç»†å®ç°è¯·æŸ¥çœ‹</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxiaoshengxianjun%2F51mazi%2Fblob%2Fmain%2Fsrc%2Frenderer%2Fsrc%2Fcomposables%2Fmap%2Ftools%2FuseResourceTool.js" target="_blank" title="https://github.com/xiaoshengxianjun/51mazi/blob/main/src/renderer/src/composables/map/tools/useResourceTool.js" ref="nofollow noopener noreferrer">src/renderer/src/composables/map/tools/useResourceTool.js</a></p>
</blockquote>
<h3 data-id="heading-30">ğŸ“Š åŠŸèƒ½ç‰¹æ€§æ€»ç»“</h3>
<h4 data-id="heading-31">âœ… å·²å®ç°åŠŸèƒ½</h4>




























































<table><thead><tr><th>åŠŸèƒ½æ¨¡å—</th><th>åŠŸèƒ½æè¿°</th><th>æŠ€æœ¯å®ç°</th></tr></thead><tbody><tr><td><strong>ç»˜å›¾å·¥å…·</strong></td><td>10+ ç§ç»˜å›¾å·¥å…·</td><td>Composables æ¶æ„</td></tr><tr><td><strong>ç”»å¸ƒæ§åˆ¶</strong></td><td>ç¼©æ”¾ã€å¹³ç§»ã€é‡ç½®</td><td>useCanvasState + useCanvas</td></tr><tr><td><strong>å…ƒç´ ç®¡ç†</strong></td><td>ç»Ÿä¸€ç®¡ç†æ‰€æœ‰å…ƒç´ </td><td>useElements</td></tr><tr><td><strong>å†å²è®°å½•</strong></td><td>æ’¤é”€/é‡åš</td><td>useHistory</td></tr><tr><td><strong>æ¸²æŸ“ç³»ç»Ÿ</strong></td><td>ç»Ÿä¸€æ¸²æŸ“å‡½æ•°</td><td>useRender</td></tr><tr><td><strong>åæ ‡è½¬æ¢</strong></td><td>å±å¹•åæ ‡è½¬ç”»å¸ƒåæ ‡</td><td>useCoordinate</td></tr><tr><td><strong>æ•°æ®æŒä¹…åŒ–</strong></td><td>ä¿å­˜å’ŒåŠ è½½åœ°å›¾</td><td>åºåˆ—åŒ–/ååºåˆ—åŒ–</td></tr><tr><td><strong>å¿«æ·é”®</strong></td><td>å®Œæ•´çš„é”®ç›˜å¿«æ·é”®</td><td>äº‹ä»¶ç›‘å¬ç³»ç»Ÿ</td></tr><tr><td><strong>èµ„æºç®¡ç†</strong></td><td>å›¾æ ‡èµ„æºåº“</td><td>useResourceTool</td></tr><tr><td><strong>å‚æ•°æ§åˆ¶</strong></td><td>é¢œè‰²ã€å¤§å°ã€é€æ˜åº¦</td><td>å“åº”å¼çŠ¶æ€ç®¡ç†</td></tr></tbody></table>
<h4 data-id="heading-32">ğŸš€ æŠ€æœ¯äº®ç‚¹</h4>
<ol>
<li><strong>æ¨¡å—åŒ–æ¶æ„</strong>: Composables è®¾è®¡å®ç°é«˜å¯ç»´æŠ¤æ€§</li>
<li><strong>ç»Ÿä¸€æ¥å£</strong>: æ‰€æœ‰å·¥å…·éµå¾ªç›¸åŒçš„æ¥å£è§„èŒƒ</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>: æ™ºèƒ½æ¸²æŸ“ï¼Œåªé‡ç»˜å˜åŒ–çš„éƒ¨åˆ†</li>
<li><strong>ç”¨æˆ·ä½“éªŒ</strong>: æµç•…çš„äº¤äº’ï¼Œå®Œæ•´çš„å¿«æ·é”®æ”¯æŒ</li>
<li><strong>å¯æ‰©å±•æ€§</strong>: æ˜“äºæ·»åŠ æ–°çš„ç»˜å›¾å·¥å…·</li>
<li><strong>æ•°æ®å®‰å…¨</strong>: å®Œæ•´çš„ä¿å­˜å’ŒåŠ è½½æœºåˆ¶</li>
</ol>
<h3 data-id="heading-33">ğŸ“ æ€»ç»“ä¸å±•æœ›</h3>
<p>åœ°å›¾è®¾è®¡é¡µæ˜¯ 51mazi é¡¹ç›®ä¸­æœ€å¤æ‚çš„åŠŸèƒ½æ¨¡å—ä¹‹ä¸€ï¼Œé€šè¿‡æ¨¡å—åŒ–çš„ Composables æ¶æ„è®¾è®¡ï¼Œæˆ‘ä»¬å®ç°äº†ï¼š</p>
<ul>
<li>âœ… <strong>æ¸…æ™°çš„ä»£ç ç»„ç»‡</strong>: æ¯ä¸ªåŠŸèƒ½æ¨¡å—ç‹¬ç«‹ï¼Œæ˜“äºç†è§£å’Œç»´æŠ¤</li>
<li>âœ… <strong>é«˜åº¦å¯æ‰©å±•</strong>: æ·»åŠ æ–°å·¥å…·åªéœ€åˆ›å»ºæ–°çš„ composable</li>
<li>âœ… <strong>ä¼˜ç§€çš„ç”¨æˆ·ä½“éªŒ</strong>: æµç•…çš„äº¤äº’å’Œå®Œæ•´çš„å¿«æ·é”®æ”¯æŒ</li>
<li>âœ… <strong>å¼ºå¤§çš„åŠŸèƒ½</strong>: 10+ ç§ç»˜å›¾å·¥å…·ï¼Œæ»¡è¶³å„ç§åœ°å›¾ç»˜åˆ¶éœ€æ±‚</li>
</ul>
<h4 data-id="heading-34">ğŸ¯ æŠ€æœ¯ä»·å€¼</h4>
<ul>
<li><strong>æ¶æ„è®¾è®¡</strong>: æ¨¡å—åŒ–çš„ Composables æ¶æ„ï¼Œé«˜å†…èšä½è€¦åˆ</li>
<li><strong>ä»£ç è´¨é‡</strong>: æ¸…æ™°çš„æ¥å£å®šä¹‰ï¼Œæ˜“äºæµ‹è¯•å’Œç»´æŠ¤</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>: æ™ºèƒ½æ¸²æŸ“æœºåˆ¶ï¼Œä¿è¯æµç•…ä½“éªŒ</li>
<li><strong>ç”¨æˆ·ä½“éªŒ</strong>: å®Œæ•´çš„å¿«æ·é”®ç³»ç»Ÿå’Œç›´è§‚çš„æ“ä½œç•Œé¢</li>
</ul>
<h4 data-id="heading-35">ğŸ”® æœªæ¥è§„åˆ’</h4>
<ul>
<li><strong>æ›´å¤šå·¥å…·</strong>: æ”¯æŒæ›´å¤šç»˜å›¾å·¥å…·å’Œæ•ˆæœï¼ˆå¦‚æ¸å˜ã€é˜´å½±ç­‰ï¼‰</li>
<li><strong>å›¾å±‚ç³»ç»Ÿ</strong>: æ”¯æŒå¤šå±‚ç»˜å›¾å’Œå›¾å±‚ç®¡ç†</li>
<li><strong>å¯¼å…¥å¯¼å‡º</strong>: æ”¯æŒå¤šç§å›¾ç‰‡æ ¼å¼å¯¼å…¥å¯¼å‡º</li>
<li><strong>åä½œåŠŸèƒ½</strong>: æ”¯æŒå¤šäººåä½œç»˜å›¾</li>
<li><strong>æ¨¡æ¿ç³»ç»Ÿ</strong>: æä¾›åœ°å›¾æ¨¡æ¿ï¼Œå¿«é€Ÿåˆ›å»ºå¸¸ç”¨åœ°å›¾</li>
</ul>
<hr/>
<h4 data-id="heading-36">ğŸ“š ç›¸å…³é“¾æ¥</h4>
<ul>
<li><strong>é¡¹ç›®åœ°å€</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxiaoshengxianjun%2F51mazi" target="_blank" title="https://github.com/xiaoshengxianjun/51mazi" ref="nofollow noopener noreferrer">GitHub - 51mazi</a>ï¼Œç»™ä¸ª Star å“¦~</li>
<li><strong>åœ°å›¾è®¾è®¡é¡µä»£ç </strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxiaoshengxianjun%2F51mazi%2Fblob%2Fmain%2Fsrc%2Frenderer%2Fsrc%2Fviews%2FMapDesign.vue" target="_blank" title="https://github.com/xiaoshengxianjun/51mazi/blob/main/src/renderer/src/views/MapDesign.vue" ref="nofollow noopener noreferrer">src/renderer/src/views/MapDesign.vue</a></li>
<li><strong>Composables ç›®å½•</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxiaoshengxianjun%2F51mazi%2Ftree%2Fmain%2Fsrc%2Frenderer%2Fsrc%2Fcomposables%2Fmap" target="_blank" title="https://github.com/xiaoshengxianjun/51mazi/tree/main/src/renderer/src/composables/map" ref="nofollow noopener noreferrer">src/renderer/src/composables/map/</a></li>
<li><strong>æŠ€æœ¯æ ˆ</strong>: Vue 3 + Canvas + Element Plus + Composables</li>
</ul>
<h4 data-id="heading-37">ğŸ·ï¸ æ ‡ç­¾</h4>
<p><code>#Vue3</code> <code>#Canvas</code> <code>#å°è¯´åœ°å›¾</code> <code>#åœ°å›¾è®¾è®¡</code> <code>#Composables</code> <code>#å‰ç«¯å¼€å‘</code> <code>#æ¶æ„è®¾è®¡</code> <code>#æ¨¡å—åŒ–</code> <code>#ç»˜å›¾å·¥å…·</code></p>
<hr/>
<blockquote>
<p>ğŸ’¡ <strong>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª â­ï¸ æ”¯æŒä¸€ä¸‹ï¼</strong></p>
<p>ğŸ’¡ <strong>æƒ³æ·±å…¥äº†è§£æŸä¸ªå…·ä½“åŠŸèƒ½çš„å®ç°ï¼Ÿæ¬¢è¿æŸ¥çœ‹ GitHub ä¸Šå¯¹åº”çš„ä»£ç æ–‡ä»¶ï¼Œæ¯ä¸ªæ¨¡å—éƒ½æœ‰è¯¦ç»†çš„æ³¨é‡Šè¯´æ˜ï¼</strong></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç¨‹åºå‘˜è¶Šæƒ³åˆ›ä¸šï¼Œè¶Šä¸è¦æ€¥ç€åŠ¨æ‰‹]]></title>    <link>https://juejin.cn/post/7582854603061379114</link>    <guid>https://juejin.cn/post/7582854603061379114</guid>    <pubDate>2025-12-13T14:13:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582854603061379114" data-draft-id="7583139562751328298" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç¨‹åºå‘˜è¶Šæƒ³åˆ›ä¸šï¼Œè¶Šä¸è¦æ€¥ç€åŠ¨æ‰‹"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-13T14:13:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¼ æ‹­å¿ƒ"/> <meta itemprop="url" content="https://juejin.cn/user/571401775094312"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç¨‹åºå‘˜è¶Šæƒ³åˆ›ä¸šï¼Œè¶Šä¸è¦æ€¥ç€åŠ¨æ‰‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/571401775094312/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¼ æ‹­å¿ƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T14:13:58.000Z" title="Sat Dec 13 2025 14:13:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ˜¨å¤©æ™šä¸Šï¼Œæˆ‘å’Œè€å©†èŠäº†ä¸€ä¸ªåˆ›ä¸šç‚¹å­ã€‚</p>
<p>ä¸€ä¸ªèƒ½æºæ–¹é¢çš„å‰è¾ˆæ‰¾åˆ°æˆ‘ï¼Œå¸Œæœ›é€šè¿‡æˆ‘æŠŠä¸€äº›äººå·¥çš„å·¥ä½œ AI è‡ªåŠ¨åŒ–ã€‚</p>
<p>èƒ½æºæ–¹é¢æˆ‘ä¸æ‡‚ï¼Œæ‰¾ Gemini èŠå®Œå‘ç°è¿™ä¸ªæ˜¯å¯ä»¥å¤åˆ¶çš„ï¼Œéå¸¸å…´å¥‹ã€‚æˆ‘è·Ÿè€å©†è¯´ï¼Œè¿™ä¸ªé¡¹ç›®åšå¥½ä»¥åå¯ä»¥åšæˆå¹³å°ï¼Œæ¨å¹¿åˆ°å…¶ä»–å…¬å¸ï¼Œä½ å°±ç­‰ç€åšæ€»è£å¤«äººå§ï¼</p>
<p>å¥¹å¬å®Œä»¥åè·Ÿæˆ‘è¯´ï¼Œè¿™ä¸ªé¡¹ç›®è¿˜æ˜¯å¤ªå®šåˆ¶åŒ–ï¼Œå’Œæˆ‘ä¹‹å‰åšçš„ä¸€ä¸ªé¡¹ç›®å¾ˆåƒã€‚</p>
<p>é‚£ä¸ªé¡¹ç›®ä¸€å¼€å§‹ï¼Œæˆ‘å’Œæœ‹å‹è®¾æƒ³çš„æ˜¯å¯ä»¥åšå®Œä¸€ä¸ªä»¥åå†æ¨åˆ°ä¸åŒçš„å­¦æ ¡ï¼Œä½†æœ€åæ²¡æœ‰è¾¾åˆ°æœŸæœ›ã€‚ä¸åŒçš„ç”²æ–¹æƒ³è¦çš„å’Œæˆ‘ä»¬åšçš„å·®å¼‚å¾ˆå¤§ï¼Œæ²¡åŠæ³•æ¨å¹¿ï¼Œéƒ½å¾—å®šåˆ¶ã€‚</p>
<p>ä½†æˆ‘è§‰å¾—è¿™æ¬¡ä¸ä¸€æ ·ï¼Œå¥¹è¯´äº†å¥½å‡ éï¼Œå‘ç°æˆ‘ä¸€ç›´â€œå†¥é¡½ä¸çµâ€ï¼Œå°±ä¸å†è¯´äº†ã€‚</p>
<p>ä»Šå¤©ä¼‘æ¯ï¼Œåœ¨å†™å®Œä¸“æ ã€Šè½¬å‹ AI å·¥ç¨‹å¸ˆã€‹ç¬¬äºŒç¯‡ä»¥åï¼Œæˆ‘æƒ³èµ·ä¹‹å‰è€å©†åˆ†äº«ç»™æˆ‘çš„ä¸€äº›æŠ–éŸ³è§†é¢‘è¿˜æ²¡çœ‹ï¼Œæ‰“å¼€çœ‹äº†ä»¥åï¼Œå‘ç°å¥¹åˆ†äº«çš„éƒ½æ˜¯ä¸€äº›èµšé’±å¦™æ‹›ï¼Œæœ‰äº›çœŸçš„å¾ˆæ‰“ç ´æˆ‘çš„è®¤çŸ¥ï¼Œè®©æˆ‘å¤§å—éœ‡æ’¼ã€‚</p>
<p>å¥½äº›é¡¹ç›®æ˜¯æˆ‘å¤´ä¸€æ¬¡è§åˆ°ï¼Œåœ¨è¿™ä¹‹å‰è„‘å­é‡Œå®Œå…¨æ²¡æœ‰æ¦‚å¿µã€‚è¿™æ—¶æˆ‘æ‰æ˜ç™½å¥¹æ˜¨å¤©æ™šä¸Šè·Ÿæˆ‘è¯´çš„è¯ã€‚å¯¹æ¯”åˆ«äººè®²çš„è¿™äº›ï¼Œæˆ‘æƒ³åšçš„çš„ç¡®æ˜¯å¤ªå°ä¼—ã€å¤ªå®šåˆ¶äº†ã€‚</p>
<h2 data-id="heading-0">ä¸ºä»€ä¹ˆæˆ‘å¬ä¸è¿›å»ï¼Ÿ</h2>
<p>å†¯æ–°ï¼ˆåŸçœŸæ ¼åŸºé‡‘æŠ•èµ„åˆä¼™äººï¼‰è¯´è¿‡ï¼š<strong>åˆ›ä¸šä¼ä¸šçš„æˆé•¿æœ¬è´¨æ˜¯åˆ›å§‹äººè®¤çŸ¥è¾¹ç•Œçš„çªç ´ï¼Œè€Œã€ä¸çŸ¥é“è‡ªå·±ä¸çŸ¥é“ã€çš„è®¤çŸ¥èŒ§æˆ¿ï¼Œæ­£æ˜¯åˆ›å§‹äººæˆé•¿çš„æœ€å¤§éšœç¢</strong>ã€‚</p>
<p>è¿‡å»å…«ä¹å¹´ï¼Œæˆ‘ä¸¤è€³ä¸é—»çª—å¤–äº‹ã€ä¸€å¿ƒåªæƒ³ææŠ€æœ¯ï¼Œå¯¹å•†ä¸šæœºä¼šçš„è®¤çŸ¥éå¸¸å°‘ã€‚å¦‚ä»Šæƒ³è¦å‚ä¸è¿› AI è¿™æ³¢æµªæ½®ï¼Œå´ä¸çŸ¥é“ä»ä½•åšèµ·ã€‚</p>
<p>åœ¨å‰è¾ˆè·Ÿæˆ‘è¯´äº†è¯‰æ±‚åï¼Œæˆ‘åƒè½æ°´çš„äººæŠ“ä½ç»³å­ä¸€æ ·ï¼Œè„‘å­é‡Œéƒ½æ˜¯é‚£ä¸ªæ–°é¡¹ç›®çš„ç”»é¢ï¼šé—®é¢˜éƒ½æœ‰å“ªäº›ã€æ€ä¹ˆè§£å†³ã€åšå®Œæ€ä¹ˆæ¨å¹¿åˆ°æ›´å¤šå…¬å¸ç­‰ç­‰ã€‚è¿™äº›ç”»é¢åœ¨æˆ‘è„‘å­é‡Œä¸æ–­å¾ªç¯ï¼Œå æ®äº†å…¨éƒ¨çš„æ³¨æ„åŠ›ã€‚</p>
<p>è€Œè€å©†è¯´çš„"å¤§è§„æ¨¡å¤åˆ¶çš„æ¨¡å¼"ï¼Œåœ¨æˆ‘è„‘å­é‡Œæ²¡æœ‰ç”»é¢ï¼Œæ‰€ä»¥å°±å®Œå…¨å¬ä¸è¿›å»ã€‚å°±åƒæˆ´ç€VRçœ¼é•œï¼Œä½ åªèƒ½çœ‹åˆ°çœ¼é•œé‡Œçš„ä¸–ç•Œï¼Œåˆ«äººè·Ÿä½ è¯´å¤–é¢çš„ä¸–ç•Œæ˜¯ä»€ä¹ˆæ ·ï¼Œä½ æ ¹æœ¬æƒ³è±¡ä¸å‡ºæ¥ã€‚</p>
<p>æˆ‘æƒ³è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¾ˆå¤šå­©å­ä½ è·Ÿä»–è®²è¯ä»–ä¸å¬ï¼Œå¾ˆå¤šå¹´è½»äººé•¿è¾ˆè·Ÿä»–è®²è¯ä»–ä¹Ÿä¸å¬ã€‚ä¸æ˜¯ä»–ä»¬ä¸æƒ³å¬ï¼Œè€Œæ˜¯ä»–ä»¬è„‘å­é‡Œåªèƒ½çœ‹åˆ°å½“å‰è‡ªå·±è§åˆ°çš„ã€å¬åˆ°çš„ã€æƒ³åˆ°çš„ä¸€äº›äº‹ã€‚</p>
<h2 data-id="heading-1">æˆ‘ä¸æ˜¯ç¬¬ä¸€ä¸ªçŠ¯è¿™ç§é”™çš„äºº</h2>
<p>åæ¥æˆ‘æŸ¥äº†ä¸€ä¸‹ï¼Œå‘ç°æˆ‘è¿™ç§æƒ…å†µä¸æ˜¯ä¸ªä¾‹ã€‚</p>
<p>å“ˆä½›å•†å­¦é™¢æœ‰ä¸ªç ”ç©¶å‘ç°ï¼Œ90% çš„åˆ›ä¸šè€…å€’åœ¨å¤´ 18 ä¸ªæœˆã€‚â€œ<strong>æœ€å¤§çš„æ•Œäººä¸æ˜¯å¸‚åœºæˆ–ç«äº‰å¯¹æ‰‹ï¼Œè€Œæ˜¯åˆ›ä¸šè€…è‡ªå·±</strong>"ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯<strong>å¯¹ã€Œå¿«é€Ÿè¯•é”™ã€å’Œã€Œå°½æ—©åŠ¨æ‰‹ã€ç­‰è§‚ç‚¹çš„è¯¯è§£ï¼Œå¯¼è‡´åœ¨é”™è¯¯é“è·¯ä¸Šæµªè´¹äº†å¤ªå¤šèµ„æº</strong>ã€‚è¿™ç§æƒ…å†µè¢«å«åšã€Œé”™è¯¯çš„èµ·æ­¥ã€â€”â€”çœç•¥åˆæœŸçš„å…¨é¢å®¡æ…æ€è€ƒï¼Œç›´æ¥è¿›å…¥æ‰§è¡Œé˜¶æ®µã€‚</p>
<p>ç°åœ¨è¿™ä¸ªèƒ½æºé¡¹ç›®ï¼Œå¦‚æœæˆ‘æŒ‰ç…§æ˜¨æ™šçš„æƒ³æ³•ç»§ç»­æ¨è¿›ï¼Œå¾ˆå¯èƒ½åˆä¼šæ‰è¿›ä¸€æ ·çš„å‘ã€‚</p>
<p>åœ¨å†™ä¸‹è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œæˆ‘æƒ³æ˜ç™½äº†åŠ¨æ‰‹ä¹‹å‰è¦è°ƒç ”çš„æƒ…å†µï¼š</p>
<ol>
<li><strong>è¿™ä¸ªéœ€æ±‚æ˜¯ä¸æ˜¯çœŸçš„æ™®éå­˜åœ¨ï¼Ÿ</strong></li>
<li><strong>ä¸åŒå…¬å¸çš„å·®å¼‚æœ‰å¤šå¤§ï¼Ÿ</strong></li>
<li><strong>æ¨å¹¿çš„æˆæœ¬å’Œéš¾åº¦æ˜¯ä»€ä¹ˆï¼Ÿ</strong></li>
<li><strong>æœ‰æ²¡æœ‰æ›´æ ‡å‡†åŒ–çš„åˆ‡å…¥ç‚¹ï¼Ÿ</strong></li>
</ol>
<h2 data-id="heading-2">å¦‚ä½•æ‹“å®½è®¤çŸ¥è¾¹ç•Œï¼Ÿ</h2>
<p>è€å©†åˆ†äº«çš„é‚£å‡ ä¸ªæŠ–éŸ³è§†é¢‘ï¼Œè®²çš„èµšé’±æ–¹å¼ï¼Œæœ‰äº›æˆ‘ä»æ¥æ²¡æƒ³åˆ°è¿‡ï¼Œä¹Ÿæ²¡æ¥è§¦è¿‡è¿™äº›è¡Œä¸šï¼Œè„‘å­é‡Œå®Œå…¨æ²¡æœ‰ç”»é¢ã€‚ä½†çœ‹å®Œä»¥åï¼Œæˆ‘çªç„¶æ˜ç™½äº†ä¸€ä»¶äº‹ï¼šåŸæ¥èµšé’±çš„æ–¹å¼æœ‰è¿™ä¹ˆå¤šç§ï¼Œè€Œæˆ‘ä¸€ç›´åœ¨è‡ªå·±çš„ä¸€äº©ä¸‰åˆ†åœ°é‡Œæ‰“è½¬ã€‚</p>
<p>å¯¹äºåƒæˆ‘è¿™æ ·æƒ³è¦åˆ›ä¸šçš„äººæ¥è¯´ï¼Œä»Šå¤©æœ€å¤§çš„æ„Ÿæ‚Ÿæ˜¯ï¼š<strong>ä¸€å®šè¦å¤šçœ‹ï¼Œä¸€å®šè¦å…ˆçŸ¥é“ã€ŒçŒªæ˜¯æ€ä¹ˆè·‘çš„ã€ï¼Œå“ªæ€•åƒä¸åˆ°çŒªè‚‰ï¼Œè‡³å°‘çŸ¥é“çŒªæ˜¯æ€ä¹ˆè·‘çš„ï¼Œå¿ƒé‡Œæœ‰äº†ä¸€ä¸ªæ¦‚å¿µ</strong>ã€‚</p>
<p>å…·ä½“æ€ä¹ˆåšï¼Ÿæˆ‘ç›®å‰æƒ³åˆ°è¿™äº›ï¼Œæ¬¢è¿ä½ è¯„è®ºåŒºç•™è¨€ï¼š</p>
<p><strong>1ã€ä¸»åŠ¨æœç´¢ä¸åŒè¡Œä¸šçš„èµšé’±æ¡ˆä¾‹</strong></p>
<p>ä¸æ˜¯ä¸ºäº†ç…§æ¬ï¼Œè€Œæ˜¯ä¸ºäº†æ‹“å®½è®¤çŸ¥è¾¹ç•Œã€‚</p>
<p>æˆ‘åœ¨æ—¥å†é‡ŒåŠ ä¸Šäº†æ—¥ç¨‹---<strong>æ¯å‘¨èŠ±30åˆ†é’Ÿï¼Œä¸“é—¨çœ‹åˆ«äººæœ‰ä»€ä¹ˆå°ä¼—èµšé’±æ¨¡å¼</strong>ï¼Œä»–ä»¬æ˜¯æ€ä¹ˆå‘ç°æœºä¼šçš„ï¼Œæ€ä¹ˆåˆ‡å…¥å¸‚åœºçš„ï¼Œæ€ä¹ˆå®ç°æ ‡å‡†åŒ–çš„ã€‚æŠ–éŸ³ã€å°çº¢ä¹¦ã€çŸ¥ä¹ã€å³åˆ»ï¼Œéƒ½æ˜¯å¾ˆå¥½çš„ä¿¡æ¯æºã€‚</p>
<p>å…³é”®æ˜¯è¦çœ‹é‚£äº›ä½ ä»æ¥æ²¡æƒ³åˆ°è¿‡çš„è¡Œä¸šã€‚æ¯”å¦‚æˆ‘ä»Šå¤©çœ‹åˆ°çš„å‡ ä¸ªæ¡ˆä¾‹ï¼šç›´æ’­åˆ‡ç‰‡ã€å¹¿å‘Šåª’ä»‹é‡‡ä¹°ã€‚</p>
<p><strong>2ã€ç”¨ AI ç­›é€‰å‡ºé€‚åˆè‡ªå·±çš„æœºä¼š</strong></p>
<p>çœ‹å¾—å¤šäº†ï¼Œå°±ä¼šå‘ç°å¾ˆå¤šæœºä¼šã€‚æ¥ä¸‹æ¥éœ€è¦è¿›è¡Œç­›é€‰ã€‚</p>
<p>æˆ‘çš„ä¼˜åŠ¿æ˜¯ AI æŠ€æœ¯ï¼Œæ‰€ä»¥æˆ‘ä¼šé‡ç‚¹å…³æ³¨é‚£äº›ã€Œä¼ ç»Ÿè¡Œä¸š+AIã€çš„æœºä¼šã€‚ä¸æ˜¯å»åšé€šç”¨å¤§æ¨¡å‹ï¼Œè€Œæ˜¯æ‰¾é‚£äº›å¯ä»¥ç”¨ AI æå‡æ•ˆç‡çš„å‚ç›´é¢†åŸŸã€‚</p>
<p><strong>3ã€ç»å¸¸é—®è‡ªå·±ä¸‰ä¸ªé—®é¢˜</strong></p>
<p>ä¸ºäº†é¿å…å†æ¬¡é™·å…¥ã€Œæ‰§è¡Œé™·é˜±ã€ï¼Œæˆ‘ç»™è‡ªå·±è®¾äº†ä¸€ä¸ªè‡ªæˆ‘æ£€æŸ¥æ¸…å•ï¼Œæ¯å‘¨é—®è‡ªå·±ä¸‰ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>æˆ‘ç°åœ¨åšçš„äº‹ï¼Œæ˜¯åœ¨æ‹“å®½è®¤çŸ¥è¾¹ç•Œï¼Œè¿˜æ˜¯é‡å¤çš„ç»éªŒå¤ç”¨ï¼Ÿ</li>
<li>æˆ‘çœ‹åˆ°çš„æœºä¼šï¼Œå—ä¼—æœ‰å¤šå°‘ï¼Œå…¶ä¸­æœ‰å¤šå°‘äººæ„¿æ„ä»˜è´¹ï¼Ÿ</li>
<li>è¿™ä¸ªé¡¹ç›®å¦‚æœä¸€å¹´å†…æ²¡æœ‰æˆæœï¼Œæˆ‘ä¼šåšæŒå—ï¼ŸåšæŒçš„åŸå› æ˜¯ä»€ä¹ˆ</li>
</ol>
<p><strong>4ã€æ­å»ºä¸€ä¸ªã€Œå•†æœºæ•è·ç³»ç»Ÿã€</strong></p>
<p>è¿™å‡ å¤©æˆ‘ä¸€ç›´åœ¨æƒ³ï¼Œèƒ½ä¸èƒ½ç”¨ AI æ­å»ºä¸€ä¸ªç³»ç»Ÿï¼Œè‡ªåŠ¨å¸®æˆ‘æ•è·å„ç§èµšé’±å•†æœºï¼Ÿ</p>
<p>æˆ‘è¯•äº†å‡ ä¸ªæ–¹æ¡ˆï¼Œå‘ç°çœŸçš„å¯è¡Œã€‚</p>
<p>è¿™ä¸ªç³»ç»Ÿçš„æ ¸å¿ƒä¸æ˜¯æ‰¾åˆ°ä¸€ä¸ªå…·ä½“çš„é¡¹ç›®ï¼Œè€Œæ˜¯æŒç»­æ‹“å®½è®¤çŸ¥è¾¹ç•Œï¼Œè®©è‡ªå·±èƒ½çœ‹åˆ°æ›´å¤šçš„å¯èƒ½æ€§ã€‚å…·ä½“æ€ä¹ˆæ­å»ºï¼Œæˆ‘å‡†å¤‡æ”¾åˆ° <em>è½¬å‹ AI å·¥ç¨‹å¸ˆä¸“æ </em> çš„æœ€åå¤§ä½œä¸šéƒ¨åˆ†ï¼Œè¿™ä¸ªç‚¹å­æ¯”ä¹‹å‰æƒ³çš„ã€Œæ·±åº¦ç ”ç©¶åŠ©æ‰‹ã€æ›´æœ‰ä»·å€¼ã€‚</p>
<h2 data-id="heading-3">æœ€åæƒ³è¯´çš„</h2>
<p>ä»Šå¤©çªç„¶æœ‰è¿™ä¸ªæ„Ÿæƒ³ï¼Œæ²¡æƒ³åˆ°è¶Šå†™è¶Šå¤šï¼Œå·®ä¸å¤šäº†æ”¶ä¸ªå°¾å§ã€‚</p>
<p><strong>åƒæˆ‘è¿™æ ·ä¸¤è€³ä¸é—»çª—å¤–äº‹ã€ä¸€å¿ƒåªæƒ³ææŠ€æœ¯çš„è€ç¨‹åºå‘˜ï¼Œæƒ³è¦åˆ›ä¸šä¸è¦æ€¥ç€åŠ¨æ‰‹ã€‚</strong></p>
<p>ä¸æ˜¯è¯´ä¸è¦è¡ŒåŠ¨ï¼Œè€Œæ˜¯è¯´åœ¨è¡ŒåŠ¨ä¹‹å‰ï¼Œå…ˆæ‹“å®½è‡ªå·±çš„è®¤çŸ¥è¾¹ç•Œã€‚</p>
<p>å¦‚æœä½ è„‘å­é‡Œåªæœ‰ä¸€ç§èµšé’±æ–¹å¼ï¼Œé‚£ä½ åªèƒ½åœ¨è¿™ä¸€ç§æ–¹å¼é‡Œæ‰“è½¬ã€‚å¦‚æœä½ è„‘å­é‡Œæœ‰åç§ã€ä¸€ç™¾ç§èµšé’±æ–¹å¼ï¼Œä½ æ‰èƒ½æ‰¾åˆ°æœ€é€‚åˆè‡ªå·±çš„é‚£ä¸€ç§ã€‚</p>
<p>æˆ‘è‡ªå·±çš„ç»å†å°±æ˜¯æ•™è®­ã€‚é‚£ä¸ªå­¦æ ¡é¡¹ç›®å¤±è´¥äº†ï¼Œç°åœ¨è¿™ä¸ªé¡¹ç›®å¦‚æœä¸è°ƒæ•´æ€è·¯ï¼Œå¾ˆå¯èƒ½åˆä¼šå¤±è´¥ã€‚</p>
<p>ä½†å¥½åœ¨ï¼Œæˆ‘ç°åœ¨æ„è¯†åˆ°äº†è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ä½ ä¹Ÿæœ‰å¯å‘ã€‚</p>
<p>ä»¥ä¸Šã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨ä½é…äº‘æœåŠ¡å™¨ä¸Šå®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼šDrone CI + Gitee Webhook çš„è½»é‡çº§å®è·µ]]></title>    <link>https://juejin.cn/post/7582919147640848436</link>    <guid>https://juejin.cn/post/7582919147640848436</guid>    <pubDate>2025-12-14T04:59:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582919147640848436" data-draft-id="7582922476223283215" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨ä½é…äº‘æœåŠ¡å™¨ä¸Šå®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼šDrone CI + Gitee Webhook çš„è½»é‡çº§å®è·µ"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-14T04:59:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="èˆ’ä¸€ç¬‘ä¸ç§ƒå¤´"/> <meta itemprop="url" content="https://juejin.cn/user/4257747754552599"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨ä½é…äº‘æœåŠ¡å™¨ä¸Šå®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼šDrone CI + Gitee Webhook çš„è½»é‡çº§å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4257747754552599/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    èˆ’ä¸€ç¬‘ä¸ç§ƒå¤´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T04:59:45.000Z" title="Sun Dec 14 2025 04:59:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ æœ‰æ²¡æœ‰è¿‡è¿™æ ·çš„ç»å†ï¼Ÿ</p>
<p>æ·±å¤œæ”¹å®Œæœ€åä¸€è¡Œä»£ç ï¼Œé•¿èˆ’ä¸€å£æ°”ï¼Œç„¶åâ€”â€”åˆè¦æ‰‹åŠ¨ç™»å½•æœåŠ¡å™¨ã€æ‹‰ä»£ç ã€æ‰“åŒ…ã€é‡å¯æœåŠ¡â€¦â€¦<br/>
ä¸€éåˆä¸€éã€‚<br/>
æ˜æ˜æ˜¯ä¸ªå°é¡¹ç›®ï¼Œå´æ€»è¢«è¿™äº›â€œè„æ´»ç´¯æ´»â€æ‹–ä½è„šæ­¥ã€‚</p>
<p>å¦‚æœä½ ä¹Ÿå—å›°äºè¿™ç§â€œå†™ä»£ç 5åˆ†é’Ÿï¼Œéƒ¨ç½²ä¸¤å°æ—¶â€çš„çª˜å¢ƒï¼Œè€Œä¸”æ‰‹å¤´åªæœ‰ä¸€å°<strong>2æ ¸4Gæˆ–4æ ¸4Gçš„ä½é…äº‘æœåŠ¡å™¨</strong>ï¼Œé‚£è¿™ç¯‡æ–‡ç« ï¼Œå°±æ˜¯ä¸ºä½ å†™çš„ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c0d25c0552a47fdba81cd8245daef28~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IiS5LiA56yR5LiN56eD5aS0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766293185&amp;x-signature=Djgtp849hs4AyWuT9zUOcI2CPcA%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-0">ä¸ºä»€ä¹ˆä¼ ç»Ÿ CI/CD å·¥å…·â€œæ°´åœŸä¸æœâ€ï¼Ÿ</h2>
<p>åƒ Jenkins è¿™æ ·çš„ä¼ ç»Ÿ CI/CD å·¥å…·ï¼ŒåŠŸèƒ½å¼ºå¤§æ˜¯çœŸï¼Œä½†â€œèƒƒå£â€ä¹Ÿå¤§ã€‚<br/>
åœ¨ä½é…æœåŠ¡å™¨ä¸Šè·‘èµ·æ¥ï¼Œä¸æ˜¯å†…å­˜çˆ†äº†ï¼Œå°±æ˜¯å“åº”è¿Ÿç¼“ï¼Œç”šè‡³æ‹–å®ä½ æœ¬å°±ä¸å®½è£•çš„ç”Ÿäº§ç¯å¢ƒã€‚</p>
<p>è¿™æ ¹æœ¬ä¸æ˜¯â€œè‡ªåŠ¨åŒ–â€ï¼Œè¿™æ˜¯â€œè‡ªåŠ¨æ·»å µâ€ã€‚</p>
<p>å…¶å®ï¼Œæˆ‘ä»¬çœŸæ­£éœ€è¦çš„ï¼Œå¹¶ä¸æ˜¯ä¸€å¥—å¤§è€Œå…¨çš„å¹³å°ï¼Œè€Œæ˜¯ä¸€ä¸ª<strong>è½»ã€å¿«ã€ç¨³ã€èƒ½å¹²æ´»</strong>çš„è‡ªåŠ¨åŒ–å°å¸®æ‰‹â€”â€”<br/>
å®ƒä¸éœ€è¦èŠ±é‡Œèƒ¡å“¨ï¼Œåªè¦èƒ½åœ¨æˆ‘æäº¤ä»£ç åï¼Œé»˜é»˜æŠŠæœåŠ¡é‡æ–°éƒ¨ç½²å¥½ï¼Œå°±å¤Ÿäº†ã€‚</p>
<hr/>
<h2 data-id="heading-1">è½»é‡çº§æ–°é€‰æ‹©ï¼šDrone CI + Gitee Webhook</h2>
<p>äºæ˜¯ï¼Œæˆ‘è¯•äº† <strong>Drone CI</strong>ï¼Œé…åˆ <strong>Gitee çš„ Webhook</strong>ï¼Œæ­å‡ºäº†ä¸€å¥—æç®€ã€æçœèµ„æºçš„è‡ªåŠ¨åŒ–éƒ¨ç½²æµæ°´çº¿ã€‚<br/>
å®ƒä¸å£°ä¸å“ï¼Œå´ç¨³ç¨³æ‰›èµ·äº†æˆ‘æ‰€æœ‰é¡¹ç›®çš„è‡ªåŠ¨æ„å»ºä¸å‘å¸ƒã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/801d96b511464540be3da7f53744230d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IiS5LiA56yR5LiN56eD5aS0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766293185&amp;x-signature=%2BOQgCmFPzd1cAheFLx2Vg7kieM0%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-2">âœ… ä¸ºä»€ä¹ˆå®ƒç‰¹åˆ«é€‚åˆä½é…æœåŠ¡å™¨ï¼Ÿ</h3>
<ul>
<li><strong>èµ„æºå ç”¨æä½</strong>ï¼š<code>drone-server</code> + <code>drone-runner</code> åˆèµ·æ¥é€šå¸¸åªåƒ <strong>300~600MB å†…å­˜</strong>ã€‚4G å†…å­˜çš„æœºå™¨è·‘å®ƒï¼Œç»°ç»°æœ‰ä½™ã€‚</li>
<li><strong>é…ç½®ç®€å•åˆ°å“­</strong>ï¼šä½ åªéœ€è¦åœ¨é¡¹ç›®æ ¹ç›®å½•åŠ ä¸€ä¸ª <code>.drone.yml</code>ï¼Œå†™å‡ è¡Œå‘½ä»¤ï¼ˆæ¯”å¦‚ <code>npm run build</code> æˆ– <code>mvn package</code>ï¼‰ï¼Œå‰©ä¸‹çš„äº¤ç»™ Droneã€‚</li>
<li><strong>Gitee ä¹Ÿèƒ½ç”¨</strong>ï¼šè™½ç„¶ Drone å®˜æ–¹ä¸»æ¨ GitHub/Giteaï¼Œä½†é€šè¿‡æ‰‹åŠ¨é…ç½® Webhookï¼ˆåœ°å€å¦‚ <code>http://ä½ çš„æœåŠ¡å™¨/drone/hook</code>ï¼‰ï¼ŒGitee ä¸€æ ·èƒ½è§¦å‘è‡ªåŠ¨æ„å»ºã€‚</li>
<li><strong>å…¨è‡ªåŠ¨ï¼Œä¸æ‰“æ‰°</strong>ï¼šä»£ç ä¸€æ¨ï¼Œæ„å»ºè‡ªåŠ¨è·‘ï¼›æ„å»ºä¸€å®Œï¼ŒæœåŠ¡è‡ªåŠ¨æ›´æ–°ã€‚ä½ ç”šè‡³å¯ä»¥å»æ³¡æ¯èŒ¶ï¼Œå›æ¥å°±ä¸Šçº¿äº†ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-3">ğŸš€ æˆ‘æŠŠæ•´å¥—æµç¨‹â€œæ‰“åŒ…â€å¥½äº†</h2>
<p>æˆ‘çŸ¥é“ï¼Œå…‰è¯´ä¸ç»ƒå‡æŠŠå¼ã€‚<br/>
æ‰€ä»¥ï¼Œæˆ‘æŠŠè¿™å¥—æ–¹æ¡ˆçš„<strong>å®Œæ•´éƒ¨ç½²æ¨¡æ¿</strong>æ•´ç†å¥½äº†ï¼ŒåŒ…å«ï¼š</p>
<ul>
<li><code>docker-compose.yml</code>ï¼ˆä¸€é”®å¯åŠ¨ Droneï¼‰</li>
<li><code>.drone.yml</code> ç¤ºä¾‹ï¼ˆé€‚é…å‰åç«¯å¸¸è§æ„å»ºå‘½ä»¤ï¼‰</li>
<li>Gitee Webhook é…ç½®æˆªå›¾ä¸è¯´æ˜</li>
<li>æ—¥å¿—ç®¡ç†å»ºè®® + æ„å»ºå¤±è´¥è‡ªåŠ¨é‡è¯•ç­–ç•¥</li>
<li><strong>å¯é€‰ï¼šé£ä¹¦æœºå™¨äººé€šçŸ¥</strong>ï¼ˆæ„å»ºæˆåŠŸ/å¤±è´¥ï¼Œå®æ—¶æ¨é€åˆ°ç¾¤èŠï¼‰</li>
</ul>
<p>è¿™äº›ä¸æ˜¯â€œç†è®ºæ–‡æ¡£â€ï¼Œè€Œæ˜¯æˆ‘<strong>åœ¨çœŸå®é¡¹ç›®é‡Œè·‘äº†å‡ ä¸ªæœˆã€åå¤æ‰“ç£¨è¿‡</strong>çš„é…ç½®ã€‚ä½ æ‹¿è¿‡å»ï¼ŒåŸºæœ¬æ”¹æ”¹åŸŸåã€å¯†é’¥ï¼Œå°±èƒ½è·‘èµ·æ¥ã€‚</p>
<hr/>
<h2 data-id="heading-4">ğŸ’¡ å®é™…æ•ˆæœï¼šçœå¿ƒï¼ŒçœŸçš„çœå¿ƒ</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/620d9486ab6e40fc9c31a3db418f97fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IiS5LiA56yR5LiN56eD5aS0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766293185&amp;x-signature=kXJWXqx12d1p%2FSVWVypdPlVzXoQ%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong>ä» push åˆ°ä¸Šçº¿ï¼Œå…¨ç¨‹æ— äººå€¼å®ˆ</strong></li>
<li><strong>é£ä¹¦é€šçŸ¥ä¸€å“ï¼Œæˆ‘å°±çŸ¥é“ï¼šæˆäº†ï¼ˆæˆ–ç¿»è½¦äº†ï¼‰</strong></li>
<li><strong>æœåŠ¡å™¨è´Ÿè½½ç¨³å¦‚è€ç‹—ï¼Œ4G å†…å­˜ç…§æ ·è·‘å¤šä¸ªæœåŠ¡</strong></li>
</ul>
<hr/>
<h2 data-id="heading-5">ğŸ“¦ æƒ³ç›´æ¥ä¸Šæ‰‹ï¼Ÿæˆ‘å¸®ä½ çœæ‰è¸©å‘æ—¶é—´</h2>
<p>æˆ‘çŸ¥é“â€”â€”<br/>
ä½ ä¸æ˜¯ä¸æƒ³è‡ªåŠ¨åŒ–ï¼Œåªæ˜¯æ²¡æ—¶é—´æŠ˜è…¾ã€‚<br/>
ä½ ä¸æ˜¯ä¸æ‡‚æŠ€æœ¯ï¼Œåªæ˜¯ä¸æƒ³åœ¨ CI/CD ä¸Šè€—æ‰ä¸€æ•´å‘¨ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘æŠŠè¿™å¥—æ–¹æ¡ˆ<strong>æ‰“åŒ…æˆâ€œå¼€ç®±å³ç”¨â€çš„éƒ¨ç½²åŒ…</strong>ï¼Œé™„å¸¦ï¼š</p>
<ul>
<li>è¯¦ç»†å›¾æ–‡éƒ¨ç½²æ‰‹å†Œï¼ˆè¿ Docker å®‰è£…éƒ½å†™äº†ï¼‰</li>
<li>å¸¸è§é—®é¢˜æ’æŸ¥æ¸…å•ï¼ˆæ¯”å¦‚ Webhook ä¸è§¦å‘ã€runner ç¦»çº¿ç­‰ï¼‰</li>
<li>ä¸€å¯¹ä¸€åŸºç¡€ç­”ç–‘ï¼ˆå¸®ä½ è·‘é€šç¬¬ä¸€éï¼‰</li>
<li>å¯é€‰å®šåˆ¶å»ºè®®ï¼ˆæ ¹æ®ä½ çš„é¡¹ç›®ç±»å‹ä¼˜åŒ– <code>.drone.yml</code>ï¼‰</li>
</ul>
<p>å¦‚æœä½ å¸Œæœ›ï¼š</p>
<ul>
<li><strong>å‘Šåˆ«æ‰‹åŠ¨éƒ¨ç½²çš„é‡å¤åŠ³åŠ¨</strong></li>
<li><strong>åœ¨ä½é…æœåŠ¡å™¨ä¸Šä¹Ÿèƒ½æ‹¥æœ‰ä¸“ä¸šçº§ CI/CD</strong></li>
<li><strong>æŠŠæ—¶é—´çœä¸‹æ¥ï¼Œå»åšçœŸæ­£æœ‰åˆ›é€ åŠ›çš„äº‹</strong></li>
</ul>
<p>ğŸ‘‰ æ¬¢è¿ç§ä¿¡æˆ‘ï¼Œè·å–å®Œæ•´æ–¹æ¡ˆï¼ˆå«ä»˜è´¹è¯´æ˜ï¼‰ã€‚<br/>
æˆ‘ä¸æ˜¯åœ¨å–â€œå·¥å…·â€ï¼Œè€Œæ˜¯åœ¨å–â€œä½ çš„æ—¶é—´è‡ªç”±â€ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/69a2573203b24664bb188fbd008dce0d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IiS5LiA56yR5LiN56eD5aS0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766293185&amp;x-signature=6FCDZX2OKYsVb29sY6fAP%2FTcrvg%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-6">ç»“è¯­ï¼šå°è€Œç¾ï¼Œæ‰æ˜¯å¤šæ•°äººçš„ç°å®</h2>
<p>æˆ‘ä»¬æ€»è¢«å¤§å‚çš„ DevOps æ¶æ„å“åˆ°ï¼Œä»¥ä¸ºè‡ªåŠ¨åŒ–å¿…é¡»ä¸Š Kubernetesã€ArgoCDã€Prometheusâ€¦â€¦<br/>
ä½†å¯¹å¤§å¤šæ•°ä¸ªäººå¼€å‘è€…æˆ–å°å›¢é˜Ÿæ¥è¯´ï¼Œ<strong>å¤Ÿç”¨ã€çœèµ„æºã€ä¸æ·»ä¹±</strong>ï¼Œæ‰æ˜¯çœŸæ­£çš„â€œç”Ÿäº§åŠ›â€ã€‚</p>
<p>Drone CI + Gitee Webhookï¼Œå°±æ˜¯è¿™æ ·ä¸€ä¸ªâ€œå°è€Œç¾â€çš„ç­”æ¡ˆã€‚<br/>
å®ƒä¸ç‚«æŠ€ï¼Œä½†èƒ½é™ªä½ èµ°å¾—æ›´è¿œã€‚</p>
<p>ä»ä»Šå¤©èµ·ï¼Œè®©æ¯ä¸€æ¬¡ <code>git push</code>ï¼Œéƒ½æˆä¸ºä¸€æ¬¡è½»æ¾çš„äº¤ä»˜ã€‚<br/>
ä½ å€¼å¾—æ‹¥æœ‰æ›´é«˜æ•ˆçš„å¼€å‘èŠ‚å¥ã€‚</p>
<hr/>
<blockquote>
<p>å¦‚æœä½ è¯•äº†ã€å¡äº†ã€æˆ–è€…æƒ³èŠèŠæ€ä¹ˆä¼˜åŒ–ï¼Œéšæ—¶ç•™è¨€ã€‚<br/>
æˆ‘ä¹Ÿæ˜¯ä»æ‰‹åŠ¨éƒ¨ç½²æ—¶ä»£çˆ¬è¿‡æ¥çš„â€”â€”æ‰€ä»¥ï¼Œæˆ‘æ‡‚ä½ ã€‚</p>
</blockquote>
<hr/>
<p><strong>ç½²å</strong>ï¼šèˆ’ä¸€ç¬‘ä¸ç§ƒå¤´<br/>
ï¼ˆä¸€ä¸ªä¸æ„¿å†ä¸ºéƒ¨ç½²ç†¬å¤œçš„å¼€å‘è€…ï¼‰</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•åœ¨Kubernetesæ­å»ºRabbitMQé›†ç¾¤ éƒ¨ç½²ç¯‡]]></title>    <link>https://juejin.cn/post/7582955784570437683</link>    <guid>https://juejin.cn/post/7582955784570437683</guid>    <pubDate>2025-12-14T02:37:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582955784570437683" data-draft-id="7582955784570421299" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•åœ¨Kubernetesæ­å»ºRabbitMQé›†ç¾¤ éƒ¨ç½²ç¯‡"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-14T02:37:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Oneslide"/> <meta itemprop="url" content="https://juejin.cn/user/4424904652631624"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•åœ¨Kubernetesæ­å»ºRabbitMQé›†ç¾¤ éƒ¨ç½²ç¯‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4424904652631624/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Oneslide
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T02:37:25.000Z" title="Sun Dec 14 2025 02:37:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. æ¦‚è¿°</h2>
<p>æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»äº†å¦‚ä½•åœ¨Kubernetesç¯å¢ƒä¸­éƒ¨ç½²é«˜å¯ç”¨çš„RabbitMQé›†ç¾¤ã€‚è¯¥éƒ¨ç½²æ–¹æ¡ˆä½¿ç”¨StatefulSetç¡®ä¿Podçš„æœ‰åºéƒ¨ç½²å’Œç¨³å®šç½‘ç»œæ ‡è¯†ï¼Œé€šè¿‡Headless Serviceå®ç°é›†ç¾¤èŠ‚ç‚¹é—´çš„è‡ªåŠ¨å‘ç°ï¼Œå¹¶é‡‡ç”¨emptyDirä¸´æ—¶å­˜å‚¨ç”¨äºæµ‹è¯•å’Œè°ƒè¯•ç¯å¢ƒã€‚</p>
<h2 data-id="heading-1">2. æ¶æ„è®¾è®¡</h2>
<h3 data-id="heading-2">2.1 é›†ç¾¤æ¶æ„å›¾</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5cabd1a9247c4e438700370bd84fbbcf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lc2xpZGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766284645&amp;x-signature=%2B1dU4LkUEypx%2Bi7%2FKZd97u0OmL0%3D" alt="rabbitmq-cluster-architecture.svg" loading="lazy"/></p>
<h3 data-id="heading-3">2.2 ç½‘ç»œé…ç½®</h3>
<h4 data-id="heading-4">2.2.1 DNSåç§°è§£æ</h4>
<p>æ¯ä¸ªPodæœ‰å”¯ä¸€çš„DNSåç§°ï¼š</p>
<ul>
<li><strong>çŸ­DNSåç§°</strong>ï¼š<code>rabbitmq-{åºå·}.rabbitmq-headless</code></li>
<li><strong>å®Œæ•´DNSåç§°</strong>ï¼š<code>rabbitmq-{åºå·}.rabbitmq-headless.cluster-playground.svc.cluster.local</code></li>
</ul>
<h4 data-id="heading-5">2.2.2 ç«¯å£è¯´æ˜</h4>






























<table><thead><tr><th>ç«¯å£å·</th><th>åè®®/æœåŠ¡</th><th>ç”¨é€”è¯´æ˜</th></tr></thead><tbody><tr><td><strong>5672</strong></td><td>AMQPåè®®</td><td>æ¶ˆæ¯ä¼ è¾“ç«¯å£ï¼Œå®¢æˆ·ç«¯è¿æ¥ä½¿ç”¨</td></tr><tr><td><strong>15672</strong></td><td>HTTPç®¡ç†ç•Œé¢</td><td>Webç®¡ç†æ§åˆ¶å°ç«¯å£</td></tr><tr><td><strong>25672</strong></td><td>é›†ç¾¤é€šä¿¡</td><td>èŠ‚ç‚¹é—´æ•°æ®åŒæ­¥å’Œé›†ç¾¤ç®¡ç†</td></tr><tr><td><strong>4369</strong></td><td>EPMDæœåŠ¡</td><td>Erlangç«¯å£æ˜ å°„å®ˆæŠ¤è¿›ç¨‹</td></tr></tbody></table>
<h3 data-id="heading-6">2.3 æ ¸å¿ƒç»„ä»¶</h3>

































<table><thead><tr><th>ç»„ä»¶</th><th>åŠŸèƒ½è¯´æ˜</th></tr></thead><tbody><tr><td><strong>StatefulSet</strong></td><td>ç®¡ç†3ä¸ªRabbitMQ Podå®ä¾‹ï¼Œç¡®ä¿æœ‰åºéƒ¨ç½²å’Œç¨³å®šç½‘ç»œæ ‡è¯†</td></tr><tr><td><strong>Headless Service</strong></td><td>æä¾›DNSå‘ç°æœºåˆ¶ï¼Œæ¯ä¸ªPodæœ‰å”¯ä¸€çš„DNSåç§°</td></tr><tr><td><strong>NodePort Service</strong></td><td>æä¾›å¤–éƒ¨è®¿é—®å…¥å£</td></tr><tr><td><strong>ConfigMap</strong></td><td>åŒ…å«RabbitMQé…ç½®å’Œå¥åº·æ£€æŸ¥è„šæœ¬</td></tr><tr><td><strong>Secret</strong></td><td>å­˜å‚¨Erlang Cookieç”¨äºé›†ç¾¤èŠ‚ç‚¹è®¤è¯</td></tr><tr><td><strong>ServiceAccount</strong></td><td>æä¾›RBACæƒé™ç”¨äºPodå‘ç°</td></tr></tbody></table>
<h2 data-id="heading-7">3. YAMLæ–‡ä»¶è¯¦è§£</h2>
<h3 data-id="heading-8">3.1 ConfigMapé…ç½® (configmap.yaml)</h3>
<p>ConfigMapåŒ…å«ä¸¤ä¸ªå…³é”®é…ç½®ï¼š</p>
<h4 data-id="heading-9">3.1.1 RabbitMQä¸»é…ç½®æ–‡ä»¶ (rabbitmq.conf)</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment">## åŸºæœ¬é…ç½®</span>
<span class="hljs-string">listeners.tcp.default</span> <span class="hljs-string">=</span> <span class="hljs-number">5672</span>
<span class="hljs-string">management.tcp.port</span> <span class="hljs-string">=</span> <span class="hljs-number">15672</span>

<span class="hljs-comment">## é›†ç¾¤é…ç½®</span>
<span class="hljs-string">cluster_formation.peer_discovery_backend</span> <span class="hljs-string">=</span> <span class="hljs-string">rabbit_peer_discovery_k8s</span>
<span class="hljs-string">cluster_formation.k8s.host</span> <span class="hljs-string">=</span> <span class="hljs-string">kubernetes.default.svc.cluster.local</span>
<span class="hljs-string">cluster_formation.k8s.address_type</span> <span class="hljs-string">=</span> <span class="hljs-string">hostname</span>
<span class="hljs-string">cluster_formation.k8s.service_name</span> <span class="hljs-string">=</span> <span class="hljs-string">rabbitmq-headless</span>
</code></pre>
<h4 data-id="heading-10">3.1.2 RabbitMQ Kubernetes Peer Discovery æ’ä»¶ä»‹ç»</h4>
<p><strong>rabbit_peer_discovery_k8s</strong> æ˜¯RabbitMQå®˜æ–¹æä¾›çš„Kuberneteså¯¹ç­‰å‘ç°æ’ä»¶ï¼Œä¸“é—¨ç”¨äºåœ¨Kubernetesç¯å¢ƒä¸­å®ç°RabbitMQé›†ç¾¤èŠ‚ç‚¹çš„è‡ªåŠ¨å‘ç°å’Œè¿æ¥ã€‚</p>
<p><strong>æ’ä»¶ç‰¹æ€§ï¼š</strong></p>
<ul>
<li><strong>è‡ªåŠ¨å‘ç°</strong>ï¼šåˆ©ç”¨Kubernetes APIè‡ªåŠ¨å‘ç°é›†ç¾¤ä¸­çš„å…¶ä»–RabbitMQèŠ‚ç‚¹</li>
<li><strong>StatefulSeté›†æˆ</strong>ï¼šä¸“ä¸ºStatefulSetè®¾è®¡ï¼Œåˆ©ç”¨Podçš„æœ‰åºæ€§å’Œç¨³å®šç½‘ç»œæ ‡è¯†</li>
<li><strong>æ— éœ€å¤–éƒ¨ä¾èµ–</strong>ï¼šä¸ä¾èµ–Consulã€etcdç­‰å¤–éƒ¨æœåŠ¡å‘ç°å·¥å…·</li>
<li><strong>é«˜å¯ç”¨æ€§</strong>ï¼šæ”¯æŒèŠ‚ç‚¹æ•…éšœè‡ªåŠ¨æ¢å¤å’Œé‡æ–°åŠ å…¥é›†ç¾¤</li>
</ul>
<p><strong>é…ç½®å‚æ•°è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>cluster_formation.peer_discovery_backend</code>ï¼šæŒ‡å®šä½¿ç”¨Kuberneteså‘ç°åç«¯</li>
<li><code>cluster_formation.k8s.host</code>ï¼šKubernetes APIæœåŠ¡å™¨åœ°å€</li>
<li><code>cluster_formation.k8s.address_type</code>ï¼šèŠ‚ç‚¹åœ°å€ç±»å‹ï¼ˆhostnameæˆ–ipï¼‰</li>
<li><code>cluster_formation.k8s.service_name</code>ï¼šHeadless Serviceåç§°</li>
</ul>
<h3 data-id="heading-11">3.2 Headless Service (headless.yaml)</h3>
<p>æä¾›DNSå‘ç°æœºåˆ¶ï¼Œä¸åˆ†é…ClusterIPï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spec:</span>
  <span class="hljs-attr">clusterIP:</span> <span class="hljs-string">None</span>
  <span class="hljs-attr">ports:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">amqp</span>       <span class="hljs-comment"># AMQPåè®®ç«¯å£</span>
      <span class="hljs-attr">port:</span> <span class="hljs-number">5672</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">clustering</span> <span class="hljs-comment"># é›†ç¾¤é€šä¿¡ç«¯å£</span>
      <span class="hljs-attr">port:</span> <span class="hljs-number">25672</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">epmd</span>       <span class="hljs-comment"># Erlangç«¯å£æ˜ å°„</span>
      <span class="hljs-attr">port:</span> <span class="hljs-number">4369</span>
</code></pre>
<h3 data-id="heading-12">3.3 StatefulSeté…ç½® (statefulsets.yaml)</h3>
<p>æ ¸å¿ƒéƒ¨ç½²é…ç½®ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spec:</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">3</span>
  <span class="hljs-attr">serviceName:</span> <span class="hljs-string">rabbitmq-headless</span>
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-comment"># ...</span>
      <span class="hljs-attr">containers:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">rabbitmq</span>
          <span class="hljs-attr">image:</span> <span class="hljs-string">'ci.local.com/rabbitmq/rabbitmq:3.9.21-management'</span>
          <span class="hljs-attr">command:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-string">sh</span>
            <span class="hljs-bullet">-</span> <span class="hljs-string">'-c'</span>
          <span class="hljs-attr">args:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-string">&gt;
              # å¯åŠ¨èŠ‚ç‚¹å‘ç°æ’ä»¶
</span>
              <span class="hljs-string">rabbitmq-plugins</span> <span class="hljs-string">enable</span> <span class="hljs-string">--offline</span> <span class="hljs-string">rabbitmq_management</span>
              <span class="hljs-string">rabbitmq_peer_discovery_k8s</span>


              <span class="hljs-comment"># å¯åŠ¨RabbitMQ</span>

              <span class="hljs-string">exec</span> <span class="hljs-string">docker-entrypoint.sh</span> <span class="hljs-string">rabbitmq-server</span>
        <span class="hljs-comment"># ....</span>
          <span class="hljs-attr">env:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">RABBITMQ_DEFAULT_USER</span>
              <span class="hljs-attr">value:</span> <span class="hljs-string">admin</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">RABBITMQ_DEFAULT_PASS</span>
              <span class="hljs-attr">value:</span> <span class="hljs-string">Admin#123</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">RABBITMQ_ERLANG_COOKIE</span>
              <span class="hljs-attr">valueFrom:</span>
                <span class="hljs-attr">secretKeyRef:</span>
                  <span class="hljs-attr">name:</span> <span class="hljs-string">rabbitmq-erlang-cookie</span>
                  <span class="hljs-attr">key:</span> <span class="hljs-string">.erlang.cookie</span>
            <span class="hljs-comment"># èŠ‚ç‚¹å‘ç°ä½¿ç”¨é•¿åŸŸå</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">RABBITMQ_USE_LONGNAME</span>
              <span class="hljs-attr">value:</span> <span class="hljs-string">'true'</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">POD_NAME</span>
              <span class="hljs-attr">valueFrom:</span>
                <span class="hljs-attr">fieldRef:</span>
                  <span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
                  <span class="hljs-attr">fieldPath:</span> <span class="hljs-string">metadata.name</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">POD_NAMESPACE</span>
              <span class="hljs-attr">valueFrom:</span>
                <span class="hljs-attr">fieldRef:</span>
                  <span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
                  <span class="hljs-attr">fieldPath:</span> <span class="hljs-string">metadata.namespace</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">RABBITMQ_MNESIA_BASE</span>
              <span class="hljs-attr">value:</span> <span class="hljs-string">/var/lib/rabbitmq/mnesia/$(POD_NAME)</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">K8S_SERVICE_NAME</span>
              <span class="hljs-attr">value:</span> <span class="hljs-string">rabbitmq-headless</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">K8S_HOSTNAME_SUFFIX</span>
              <span class="hljs-attr">value:</span> <span class="hljs-string">.$(K8S_SERVICE_NAME).$(POD_NAMESPACE).svc.cluster.local</span>
            <span class="hljs-comment"># é…ç½®èŠ‚ç‚¹å‘ç°DNS</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">RABBITMQ_NODENAME</span>
              <span class="hljs-attr">value:</span> <span class="hljs-string">rabbit@$(POD_NAME)$(K8S_HOSTNAME_SUFFIX)</span>
</code></pre>
<h2 data-id="heading-13">4. éƒ¨ç½²æ­¥éª¤</h2>
<h3 data-id="heading-14">4.1 æ­¥éª¤1ï¼šåˆ›å»ºå‘½åç©ºé—´</h3>
<p>ç¡®ä¿ç›®æ ‡å‘½åç©ºé—´å­˜åœ¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">kubectl create namespace cluster-playground
</code></pre>
<h3 data-id="heading-15">4.2 æ­¥éª¤2ï¼šæŒ‰é¡ºåºéƒ¨ç½²èµ„æº</h3>
<ol>
<li><strong>åˆ›å»ºSecret</strong>ï¼ˆé›†ç¾¤è®¤è¯åŸºç¡€ï¼‰ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">kubectl apply -f yaml/secret.yaml
</code></pre>
<ol start="2">
<li><strong>åˆ›å»ºConfigMap</strong>ï¼ˆé…ç½®å’Œè„šæœ¬ï¼‰ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">kubectl apply -f yaml/configmap.yaml
</code></pre>
<ol start="3">
<li><strong>åˆ›å»ºServiceAccountå’ŒRBAC</strong>ï¼ˆæƒé™é…ç½®ï¼‰ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">kubectl apply -f yaml/service-account.yaml
</code></pre>
<ol start="4">
<li><strong>åˆ›å»ºHeadless Service</strong>ï¼ˆDNSå‘ç°ï¼‰ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">kubectl apply -f yaml/headless.yaml
</code></pre>
<ol start="5">
<li><strong>åˆ›å»ºStatefulSet</strong>ï¼ˆæ ¸å¿ƒéƒ¨ç½²ï¼‰ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">kubectl apply -f yaml/statefulsets.yaml
</code></pre>
<ol start="6">
<li><strong>åˆ›å»ºNodePort Service</strong>ï¼ˆå¤–éƒ¨è®¿é—®ï¼‰ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">kubectl apply -f yaml/service.yaml
</code></pre>
<h3 data-id="heading-16">4.3 æ­¥éª¤3ï¼šéªŒè¯éƒ¨ç½²</h3>
<ol>
<li><strong>æ£€æŸ¥PodçŠ¶æ€</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">kubectl get pods -n cluster-playground -l app=rabbitmq
</code></pre>
<ol start="2">
<li><strong>æ£€æŸ¥æœåŠ¡çŠ¶æ€</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">kubectl get svc -n cluster-playground -l app=rabbitmq
</code></pre>
<ol start="3">
<li><strong>æŸ¥çœ‹Podæ—¥å¿—</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">kubectl logs -n cluster-playground rabbitmq-0
</code></pre>
<h2 data-id="heading-17">5. é›†ç¾¤éªŒè¯</h2>
<h3 data-id="heading-18">5.1 å¥åº·æ£€æŸ¥</h3>
<p>æ‰§è¡Œå†…ç½®çš„å¥åº·æ£€æŸ¥è„šæœ¬ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">kubectl <span class="hljs-built_in">exec</span> -n cluster-playground rabbitmq-0 -- bash /etc/rabbitmq/cluster-health.sh
</code></pre>
<h3 data-id="heading-19">5.2 æ°´å¹³æ‰©å±•</h3>
<p>å¢åŠ å‰¯æœ¬æ•°é‡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">kubectl scale statefulset rabbitmq --replicas=5 -n cluster-playground
</code></pre>
<h2 data-id="heading-20">6. é™„å½•</h2>
<h3 data-id="heading-21">6.1 å®Œæ•´ç¼–æ’æ–‡ä»¶å†…å®¹</h3>
<h4 data-id="heading-22">6.1.1 ConfigMapé…ç½® (configmap.yaml)</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">kind:</span> <span class="hljs-string">ConfigMap</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">rabbitmq-config</span>
  <span class="hljs-attr">namespace:</span> <span class="hljs-string">cluster-playground</span>
<span class="hljs-attr">data:</span>
  <span class="hljs-attr">cluster-health.sh:</span> <span class="hljs-string">&gt;-
    #!/bin/bash
</span>

    <span class="hljs-string">echo</span> <span class="hljs-string">"=== RabbitMQ é›†ç¾¤åŠŸèƒ½éªŒè¯ï¼ˆå®¹å™¨ç‰ˆæœ¬ï¼‰ ==="</span>

    <span class="hljs-string">echo</span> <span class="hljs-string">""</span>


    <span class="hljs-comment"># ä»ç¯å¢ƒå˜é‡è¯»å–è®¤è¯å‚æ•°</span>

    <span class="hljs-string">RABBITMQ_USER="${RABBITMQ_USER:-admin}"</span>

    <span class="hljs-string">RABBITMQ_PASS="${RABBITMQ_PASS:-Admin#123}"</span>


    <span class="hljs-comment"># 1. åˆ›å»ºé˜Ÿåˆ—</span>

    <span class="hljs-string">echo</span> <span class="hljs-string">"1. åˆ›å»ºæµ‹è¯•é˜Ÿåˆ—..."</span>

    <span class="hljs-string">rabbitmqadmin</span> <span class="hljs-string">-u</span> <span class="hljs-string">$RABBITMQ_USER</span> <span class="hljs-string">-p</span> <span class="hljs-string">$RABBITMQ_PASS</span> <span class="hljs-string">declare</span> <span class="hljs-string">queue</span>
    <span class="hljs-string">name=cluster_test</span> <span class="hljs-string">durable=true</span>

    <span class="hljs-string">if</span> [ <span class="hljs-string">$?</span> <span class="hljs-string">-eq</span> <span class="hljs-number">0</span> ]<span class="hljs-string">;</span> <span class="hljs-string">then</span>
        <span class="hljs-string">echo</span> <span class="hljs-string">"é˜Ÿåˆ—åˆ›å»ºæˆåŠŸ"</span>
    <span class="hljs-string">else</span>
        <span class="hljs-string">echo</span> <span class="hljs-string">"é˜Ÿåˆ—åˆ›å»ºå¤±è´¥"</span>
        <span class="hljs-string">exit</span> <span class="hljs-number">1</span>
    <span class="hljs-string">fi</span>

    <span class="hljs-string">echo</span> <span class="hljs-string">""</span>


    <span class="hljs-comment"># 2. å‘å¸ƒæ¶ˆæ¯</span>

    <span class="hljs-string">echo</span> <span class="hljs-string">"2. å‘å¸ƒæµ‹è¯•æ¶ˆæ¯..."</span>

    <span class="hljs-string">rabbitmqadmin</span> <span class="hljs-string">-u</span> <span class="hljs-string">$RABBITMQ_USER</span> <span class="hljs-string">-p</span> <span class="hljs-string">$RABBITMQ_PASS</span> <span class="hljs-string">publish</span>
    <span class="hljs-string">exchange=amq.default</span> <span class="hljs-string">routing_key=cluster_test</span> <span class="hljs-string">payload="Hello</span> <span class="hljs-string">from</span> <span class="hljs-string">RabbitMQ</span>
    <span class="hljs-string">Cluster!"</span>

    <span class="hljs-string">echo</span> <span class="hljs-string">"æ¶ˆæ¯å‘å¸ƒæˆåŠŸ"</span>

    <span class="hljs-string">echo</span> <span class="hljs-string">""</span>


    <span class="hljs-comment"># 3. æ£€æŸ¥é˜Ÿåˆ—çŠ¶æ€</span>

    <span class="hljs-string">echo</span> <span class="hljs-string">"3. é˜Ÿåˆ—çŠ¶æ€æ£€æŸ¥ï¼š"</span>

    <span class="hljs-string">rabbitmqadmin</span> <span class="hljs-string">-u</span> <span class="hljs-string">$RABBITMQ_USER</span> <span class="hljs-string">-p</span> <span class="hljs-string">$RABBITMQ_PASS</span> <span class="hljs-string">list</span> <span class="hljs-string">queues</span> <span class="hljs-string">name</span> <span class="hljs-string">messages</span>
    <span class="hljs-string">consumers</span> <span class="hljs-string">durable</span> <span class="hljs-string">node</span>

    <span class="hljs-string">echo</span> <span class="hljs-string">""</span>


    <span class="hljs-comment"># 4. è®¾ç½®é•œåƒé˜Ÿåˆ—ç­–ç•¥</span>

    <span class="hljs-string">echo</span> <span class="hljs-string">"4. è®¾ç½®é«˜å¯ç”¨ç­–ç•¥..."</span>

    <span class="hljs-string">rabbitmqctl</span> <span class="hljs-string">set_policy</span> <span class="hljs-string">ha-all</span> <span class="hljs-string">".*"</span>
    <span class="hljs-string">'{"ha-mode":"all","ha-sync-mode":"automatic"}'</span> <span class="hljs-string">--priority</span> <span class="hljs-number">0</span> <span class="hljs-string">--apply-to</span>
    <span class="hljs-string">queues</span>

    <span class="hljs-string">echo</span> <span class="hljs-string">"é«˜å¯ç”¨ç­–ç•¥å·²è®¾ç½®"</span>

    <span class="hljs-string">echo</span> <span class="hljs-string">""</span>


    <span class="hljs-comment"># 5. æ£€æŸ¥ç­–ç•¥</span>

    <span class="hljs-string">echo</span> <span class="hljs-string">"5. å½“å‰ç­–ç•¥ï¼š"</span>

    <span class="hljs-string">rabbitmqctl</span> <span class="hljs-string">list_policies</span>

    <span class="hljs-string">echo</span> <span class="hljs-string">""</span>


    <span class="hljs-comment"># 6. é¢å¤–ï¼šæ£€æŸ¥é›†ç¾¤çŠ¶æ€ï¼ˆå¯é€‰ï¼‰</span>

    <span class="hljs-string">echo</span> <span class="hljs-string">"6. é›†ç¾¤çŠ¶æ€ï¼š"</span>

    <span class="hljs-string">rabbitmqctl</span> <span class="hljs-string">cluster_status</span> <span class="hljs-string">|</span> <span class="hljs-string">head</span> <span class="hljs-number">-20</span>
  <span class="hljs-attr">rabbitmq.conf:</span> <span class="hljs-string">|
    ## åŸºæœ¬é…ç½®
    listeners.tcp.default = 5672
    management.tcp.port = 15672
</span>
    <span class="hljs-comment">## é›†ç¾¤é…ç½®</span>
    <span class="hljs-string">cluster_formation.peer_discovery_backend</span> <span class="hljs-string">=</span> <span class="hljs-string">rabbit_peer_discovery_k8s</span>
    <span class="hljs-string">cluster_formation.k8s.host</span> <span class="hljs-string">=</span> <span class="hljs-string">kubernetes.default.svc.cluster.local</span>
    <span class="hljs-string">cluster_formation.k8s.address_type</span> <span class="hljs-string">=</span> <span class="hljs-string">hostname</span>
    <span class="hljs-string">cluster_formation.k8s.service_name</span> <span class="hljs-string">=</span> <span class="hljs-string">rabbitmq-headless</span>
    <span class="hljs-string">cluster_formation.node_cleanup.interval</span> <span class="hljs-string">=</span> <span class="hljs-number">30</span>

    <span class="hljs-comment">## ç£ç›˜å’Œå†…å­˜</span>
    <span class="hljs-string">disk_free_limit.absolute</span> <span class="hljs-string">=</span> <span class="hljs-string">2GB</span>
    <span class="hljs-string">vm_memory_high_watermark.absolute</span> <span class="hljs-string">=</span> <span class="hljs-string">3GB</span>
</code></pre>
<h4 data-id="heading-23">6.1.2 Headless Service (headless.yaml)</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">rabbitmq-headless</span>
  <span class="hljs-attr">namespace:</span> <span class="hljs-string">cluster-playground</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">rabbitmq</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">ports:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">amqp</span>
      <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span>
      <span class="hljs-attr">port:</span> <span class="hljs-number">5672</span>
      <span class="hljs-attr">targetPort:</span> <span class="hljs-number">5672</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">clustering</span>
      <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span>
      <span class="hljs-attr">port:</span> <span class="hljs-number">25672</span>
      <span class="hljs-attr">targetPort:</span> <span class="hljs-number">25672</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">epmd</span>
      <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span>
      <span class="hljs-attr">port:</span> <span class="hljs-number">4369</span>
      <span class="hljs-attr">targetPort:</span> <span class="hljs-number">4369</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">rabbitmq</span>
  <span class="hljs-attr">clusterIP:</span> <span class="hljs-string">None</span>
  <span class="hljs-attr">clusterIPs:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">None</span>
  <span class="hljs-attr">type:</span> <span class="hljs-string">ClusterIP</span>

</code></pre>
<h4 data-id="heading-24">6.1.3 NodePort Service (service.yaml)</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">rabbitmq-client</span>
  <span class="hljs-attr">namespace:</span> <span class="hljs-string">cluster-playground</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">rabbitmq-client</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">ports:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">amqp</span>
      <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span>
      <span class="hljs-attr">port:</span> <span class="hljs-number">5672</span>
      <span class="hljs-attr">targetPort:</span> <span class="hljs-number">5672</span>
      <span class="hljs-attr">nodePort:</span> <span class="hljs-number">30445</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">http</span>
      <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span>
      <span class="hljs-attr">port:</span> <span class="hljs-number">15672</span>
      <span class="hljs-attr">targetPort:</span> <span class="hljs-number">15672</span>
      <span class="hljs-attr">nodePort:</span> <span class="hljs-number">31010</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">rabbitmq</span>
  <span class="hljs-attr">type:</span> <span class="hljs-string">NodePort</span>
</code></pre>
<h4 data-id="heading-25">6.1.4 StatefulSeté…ç½® (statefulsets.yaml)</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">kind:</span> <span class="hljs-string">StatefulSet</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">rabbitmq</span>
  <span class="hljs-attr">namespace:</span> <span class="hljs-string">cluster-playground</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">rabbitmq</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">3</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">matchLabels:</span>
      <span class="hljs-attr">app:</span> <span class="hljs-string">rabbitmq</span>
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">metadata:</span>
      <span class="hljs-attr">labels:</span>
        <span class="hljs-attr">app:</span> <span class="hljs-string">rabbitmq</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">volumes:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">config</span>
          <span class="hljs-attr">configMap:</span>
            <span class="hljs-attr">name:</span> <span class="hljs-string">rabbitmq-config</span>
            <span class="hljs-attr">defaultMode:</span> <span class="hljs-number">420</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">data</span>
          <span class="hljs-attr">emptyDir:</span> {}
      <span class="hljs-attr">containers:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">rabbitmq</span>
          <span class="hljs-attr">image:</span> <span class="hljs-string">'dockerhub.kubesphere.local:31104/tykj-gw/rabbitmq:3.9.21-management'</span>
          <span class="hljs-attr">command:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-string">sh</span>
            <span class="hljs-bullet">-</span> <span class="hljs-string">'-c'</span>
          <span class="hljs-attr">args:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-string">&gt;
              # å¯åŠ¨æ’ä»¶
</span>
              <span class="hljs-string">rabbitmq-plugins</span> <span class="hljs-string">enable</span> <span class="hljs-string">--offline</span> <span class="hljs-string">rabbitmq_management</span>
              <span class="hljs-string">rabbitmq_peer_discovery_k8s</span>


              <span class="hljs-comment"># å¯åŠ¨RabbitMQ</span>

              <span class="hljs-string">exec</span> <span class="hljs-string">docker-entrypoint.sh</span> <span class="hljs-string">rabbitmq-server</span>
          <span class="hljs-attr">ports:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">amqp</span>
              <span class="hljs-attr">containerPort:</span> <span class="hljs-number">5672</span>
              <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">http</span>
              <span class="hljs-attr">containerPort:</span> <span class="hljs-number">15672</span>
              <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">clustering</span>
              <span class="hljs-attr">containerPort:</span> <span class="hljs-number">25672</span>
              <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">epmd</span>
              <span class="hljs-attr">containerPort:</span> <span class="hljs-number">4369</span>
              <span class="hljs-attr">protocol:</span> <span class="hljs-string">TCP</span>
          <span class="hljs-attr">env:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">RABBITMQ_DEFAULT_USER</span>
              <span class="hljs-attr">value:</span> <span class="hljs-string">admin</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">RABBITMQ_DEFAULT_PASS</span>
              <span class="hljs-attr">value:</span> <span class="hljs-string">Admin#123</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">RABBITMQ_ERLANG_COOKIE</span>
              <span class="hljs-attr">valueFrom:</span>
                <span class="hljs-attr">secretKeyRef:</span>
                  <span class="hljs-attr">name:</span> <span class="hljs-string">rabbitmq-erlang-cookie</span>
                  <span class="hljs-attr">key:</span> <span class="hljs-string">.erlang.cookie</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">RABBITMQ_USE_LONGNAME</span>
              <span class="hljs-attr">value:</span> <span class="hljs-string">'true'</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">POD_NAME</span>
              <span class="hljs-attr">valueFrom:</span>
                <span class="hljs-attr">fieldRef:</span>
                  <span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
                  <span class="hljs-attr">fieldPath:</span> <span class="hljs-string">metadata.name</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">POD_NAMESPACE</span>
              <span class="hljs-attr">valueFrom:</span>
                <span class="hljs-attr">fieldRef:</span>
                  <span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
                  <span class="hljs-attr">fieldPath:</span> <span class="hljs-string">metadata.namespace</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">RABBITMQ_MNESIA_BASE</span>
              <span class="hljs-attr">value:</span> <span class="hljs-string">/var/lib/rabbitmq/mnesia/$(POD_NAME)</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">K8S_SERVICE_NAME</span>
              <span class="hljs-attr">value:</span> <span class="hljs-string">rabbitmq-headless</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">K8S_HOSTNAME_SUFFIX</span>
              <span class="hljs-attr">value:</span> <span class="hljs-string">.$(K8S_SERVICE_NAME).$(POD_NAMESPACE).svc.cluster.local</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">RABBITMQ_NODENAME</span>
              <span class="hljs-attr">value:</span> <span class="hljs-string">rabbit@$(POD_NAME)$(K8S_HOSTNAME_SUFFIX)</span>
          <span class="hljs-attr">resources:</span> {}
          <span class="hljs-attr">volumeMounts:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">config</span>
              <span class="hljs-attr">mountPath:</span> <span class="hljs-string">/etc/rabbitmq/rabbitmq.conf</span>
              <span class="hljs-attr">subPath:</span> <span class="hljs-string">rabbitmq.conf</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">config</span>
              <span class="hljs-attr">mountPath:</span> <span class="hljs-string">/etc/rabbitmq/cluster-health.sh</span>
              <span class="hljs-attr">subPath:</span> <span class="hljs-string">cluster-health.sh</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">data</span>
              <span class="hljs-attr">mountPath:</span> <span class="hljs-string">/var/lib/rabbitmq</span>
          <span class="hljs-attr">livenessProbe:</span>
            <span class="hljs-attr">exec:</span>
              <span class="hljs-attr">command:</span>
                <span class="hljs-bullet">-</span> <span class="hljs-string">rabbitmq-diagnostics</span>
                <span class="hljs-bullet">-</span> <span class="hljs-string">ping</span>
            <span class="hljs-attr">initialDelaySeconds:</span> <span class="hljs-number">60</span>
            <span class="hljs-attr">timeoutSeconds:</span> <span class="hljs-number">10</span>
            <span class="hljs-attr">periodSeconds:</span> <span class="hljs-number">30</span>
            <span class="hljs-attr">successThreshold:</span> <span class="hljs-number">1</span>
            <span class="hljs-attr">failureThreshold:</span> <span class="hljs-number">3</span>
          <span class="hljs-attr">readinessProbe:</span>
            <span class="hljs-attr">exec:</span>
              <span class="hljs-attr">command:</span>
                <span class="hljs-bullet">-</span> <span class="hljs-string">rabbitmq-diagnostics</span>
                <span class="hljs-bullet">-</span> <span class="hljs-string">status</span>
            <span class="hljs-attr">initialDelaySeconds:</span> <span class="hljs-number">20</span>
            <span class="hljs-attr">timeoutSeconds:</span> <span class="hljs-number">5</span>
            <span class="hljs-attr">periodSeconds:</span> <span class="hljs-number">10</span>
            <span class="hljs-attr">successThreshold:</span> <span class="hljs-number">1</span>
            <span class="hljs-attr">failureThreshold:</span> <span class="hljs-number">3</span>
          <span class="hljs-attr">imagePullPolicy:</span> <span class="hljs-string">IfNotPresent</span>
      <span class="hljs-attr">restartPolicy:</span> <span class="hljs-string">Always</span>
      <span class="hljs-attr">terminationGracePeriodSeconds:</span> <span class="hljs-number">10</span>
      <span class="hljs-attr">dnsPolicy:</span> <span class="hljs-string">ClusterFirst</span>
      <span class="hljs-attr">serviceAccountName:</span> <span class="hljs-string">rabbitmq-sa</span>
      <span class="hljs-attr">serviceAccount:</span> <span class="hljs-string">rabbitmq-sa</span>
      <span class="hljs-attr">securityContext:</span> {}
      <span class="hljs-attr">imagePullSecrets:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">harbor</span>
      <span class="hljs-attr">schedulerName:</span> <span class="hljs-string">default-scheduler</span>
  <span class="hljs-attr">serviceName:</span> <span class="hljs-string">rabbitmq-headless</span>
  <span class="hljs-attr">podManagementPolicy:</span> <span class="hljs-string">OrderedReady</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Nicegui ç»„ä»¶æ”¾åœ¨é¡µé¢ä¸­é—´]]></title>    <link>https://juejin.cn/post/7582923861769011250</link>    <guid>https://juejin.cn/post/7582923861769011250</guid>    <pubDate>2025-12-14T02:46:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582923861769011250" data-draft-id="7583158173978066954" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Nicegui ç»„ä»¶æ”¾åœ¨é¡µé¢ä¸­é—´"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯"/> <meta itemprop="datePublished" content="2025-12-14T02:46:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="PieroPC"/> <meta itemprop="url" content="https://juejin.cn/user/1998231182522521"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Nicegui ç»„ä»¶æ”¾åœ¨é¡µé¢ä¸­é—´
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1998231182522521/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    PieroPC
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T02:46:18.000Z" title="Sun Dec 14 2025 02:46:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•å°† ç»„ä»¶ æ”¾åœ¨é¡µé¢ä¸­é—´ï¼š</p>
<h2 data-id="heading-0">æ–¹æ³•1ï¼šä½¿ç”¨ <code>ui.column()</code> å±…ä¸­å¯¹é½</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'absolute-center items-center'</span>):
    <span class="hljs-keyword">with</span> ui.card():
        ui.label(<span class="hljs-string">'å¡ç‰‡å†…å®¹'</span>)
        <span class="hljs-comment"># å…¶ä»–å¡ç‰‡å†…å®¹...</span>
</code></pre>
<h2 data-id="heading-1">æ–¹æ³•2ï¼šä½¿ç”¨ CSS ç±»</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">with</span> ui.card().classes(<span class="hljs-string">'mx-auto my-auto'</span>):
    ui.label(<span class="hljs-string">'å¡ç‰‡å†…å®¹'</span>)
    <span class="hljs-comment"># å…¶ä»–å¡ç‰‡å†…å®¹...</span>
</code></pre>
<h2 data-id="heading-2">æ–¹æ³•3ï¼šæ›´çµæ´»çš„å¸ƒå±€æ§åˆ¶</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">with</span> ui.row().classes(<span class="hljs-string">'w-full h-screen justify-center items-center'</span>):
    <span class="hljs-keyword">with</span> ui.card().classes(<span class="hljs-string">'w-96'</span>):
        ui.label(<span class="hljs-string">'å¡ç‰‡å†…å®¹'</span>)
        ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'è¾“å…¥æ¡†'</span>)
        ui.button(<span class="hljs-string">'æäº¤'</span>)
</code></pre>
<h2 data-id="heading-3">æ–¹æ³•4ï¼šå“åº”å¼å±…ä¸­</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'absolute-center items-center w-full max-w-md'</span>):
    <span class="hljs-keyword">with</span> ui.card().classes(<span class="hljs-string">'w-full'</span>):
        ui.label(<span class="hljs-string">'å±…ä¸­å¡ç‰‡'</span>)
        <span class="hljs-keyword">with</span> ui.row():
            ui.button(<span class="hljs-string">'ç¡®å®š'</span>)
            ui.button(<span class="hljs-string">'å–æ¶ˆ'</span>)
</code></pre>
<h2 data-id="heading-4">æ–¹æ³•5ï¼šä½¿ç”¨ç½‘æ ¼å¸ƒå±€</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">with</span> ui.grid(columns=<span class="hljs-number">1</span>).classes(<span class="hljs-string">'h-screen place-items-center'</span>):
    <span class="hljs-keyword">with</span> ui.card():
        ui.label(<span class="hljs-string">'ç½‘æ ¼å±…ä¸­å¡ç‰‡'</span>)
        <span class="hljs-comment"># å¡ç‰‡å†…å®¹...</span>
</code></pre>
<h2 data-id="heading-5">å®Œæ•´ç¤ºä¾‹</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> nicegui <span class="hljs-keyword">import</span> ui

<span class="hljs-comment"># æ–¹æ³•1ï¼šæ¨èä½¿ç”¨</span>
<span class="hljs-keyword">with</span> ui.column().classes(<span class="hljs-string">'absolute-center items-center'</span>):
    <span class="hljs-keyword">with</span> ui.card().classes(<span class="hljs-string">'w-96 shadow-lg'</span>):
        ui.label(<span class="hljs-string">'ç™»å½•'</span>).classes(<span class="hljs-string">'text-2xl font-bold text-center'</span>)
        ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'ç”¨æˆ·å'</span>).classes(<span class="hljs-string">'w-full'</span>)
        ui.<span class="hljs-built_in">input</span>(label=<span class="hljs-string">'å¯†ç '</span>, password=<span class="hljs-literal">True</span>).classes(<span class="hljs-string">'w-full'</span>)
        ui.button(<span class="hljs-string">'ç™»å½•'</span>, color=<span class="hljs-string">'primary'</span>).classes(<span class="hljs-string">'w-full'</span>)

ui.run()
</code></pre>
<p><strong>è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>absolute-center</code>ï¼šæ°´å¹³å’Œå‚ç›´å±…ä¸­</li>
<li><code>items-center</code>ï¼šæ°´å¹³å±…ä¸­ï¼ˆåœ¨ column ä¸­ï¼‰</li>
<li><code>justify-center</code>ï¼šå‚ç›´å±…ä¸­ï¼ˆåœ¨ row ä¸­ï¼‰</li>
<li><code>mx-auto</code>ï¼šæ°´å¹³å±…ä¸­</li>
<li><code>my-auto</code>ï¼šå‚ç›´å±…ä¸­</li>
<li><code>h-screen</code>ï¼šå…¨å±é«˜åº¦</li>
<li><code>w-full</code>ï¼šå…¨å®½åº¦</li>
</ul>
<p>é€‰æ‹©é€‚åˆä½ éœ€æ±‚çš„æ–¹æ³•å³å¯ã€‚æ–¹æ³•1å’Œ2æœ€ç®€æ´ï¼Œæ–¹æ³•3æœ€çµæ´»ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ”¹ä¸€ä¸ªéœ€æ±‚åŠ¨ 23 å¤„ä»£ç ï¼Ÿä½ å¯èƒ½è¸©è¿›äº†è¿™ä¸ªå‘]]></title>    <link>https://juejin.cn/post/7583139562752573482</link>    <guid>https://juejin.cn/post/7583139562752573482</guid>    <pubDate>2025-12-14T02:46:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583139562752573482" data-draft-id="7583139562752557098" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ”¹ä¸€ä¸ªéœ€æ±‚åŠ¨ 23 å¤„ä»£ç ï¼Ÿä½ å¯èƒ½è¸©è¿›äº†è¿™ä¸ªå‘"/> <meta itemprop="keywords" content="åç«¯,è®¾è®¡æ¨¡å¼"/> <meta itemprop="datePublished" content="2025-12-14T02:46:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="lomocode"/> <meta itemprop="url" content="https://juejin.cn/user/2103792315926697"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ”¹ä¸€ä¸ªéœ€æ±‚åŠ¨ 23 å¤„ä»£ç ï¼Ÿä½ å¯èƒ½è¸©è¿›äº†è¿™ä¸ªå‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2103792315926697/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    lomocode
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T02:46:58.000Z" title="Sun Dec 14 2025 02:46:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/81afdc078ea94364b772115525cc8250~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbG9tb2NvZGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766285217&amp;x-signature=AtP2m0KhjHMdotVAgOryl10gzLg%3D" alt="0.jpg" loading="lazy"/></p>
<blockquote>
<p>é¢„ä¼°é˜…è¯»ï¼š10 åˆ†é’Ÿ</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸€ä¸ªçœŸå®çš„è¸©å‘æ•…äº‹</h2>
<p>å°ç¦¾æœ‰ä¸ªæœ‹å‹ï¼Œä¹Ÿå«å°ç¦¾ã€‚</p>
<p>å°ç¦¾æœ€è¿‘æ¥äº†ä¸ªæ´»å„¿ï¼Œåšä¸€ä¸ªç”µå•†æ”¯ä»˜æ¨¡å—ã€‚ä¸€å¼€å§‹éœ€æ±‚ç®€å•ï¼šæ¥å…¥æ”¯ä»˜å®ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">pay</span>(<span class="hljs-params">order</span>):
    <span class="hljs-keyword">return</span> alipay.create_payment(order)
</code></pre>
<p>æ¸…æ¸…çˆ½çˆ½ï¼Œä¸€è¡Œæå®šã€‚</p>
<hr/>
<h3 data-id="heading-1">ç¬¬ä¸€æ¬¡åŠ éœ€æ±‚</h3>
<p>ä¸€å‘¨åï¼Œäº§å“ç»ç†è¯´ï¼šã€Œå¾®ä¿¡æ”¯ä»˜ä¹Ÿè¦æœ‰ï¼Œç”¨æˆ·å–œæ¬¢é€‰æ‹©ã€‚ã€</p>
<p>å°ç¦¾ï¼šç®€å•ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">pay</span>(<span class="hljs-params">order, method=<span class="hljs-string">"alipay"</span></span>):
    <span class="hljs-keyword">if</span> method == <span class="hljs-string">"alipay"</span>:
        <span class="hljs-keyword">return</span> alipay.create_payment(order)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> wechat.create_payment(order)
</code></pre>
<p>ä¸¤ä¸ªåˆ†æ”¯ï¼Œå°äº‹ã€‚</p>
<hr/>
<h3 data-id="heading-2">ç¬¬äºŒæ¬¡åŠ éœ€æ±‚</h3>
<p>ä¸¤å‘¨åï¼šã€Œé“¶è”ä¹ŸåŠ ä¸Šå§ï¼Œä¼ä¸šå®¢æˆ·è¦ç”¨ã€‚ã€</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">pay</span>(<span class="hljs-params">order, method=<span class="hljs-string">"alipay"</span></span>):
    <span class="hljs-keyword">if</span> method == <span class="hljs-string">"alipay"</span>:
        <span class="hljs-keyword">return</span> alipay.create_payment(order)
    <span class="hljs-keyword">elif</span> method == <span class="hljs-string">"wechat"</span>:
        <span class="hljs-keyword">return</span> wechat.create_payment(order)
    <span class="hljs-keyword">elif</span> method == <span class="hljs-string">"unionpay"</span>:
        <span class="hljs-keyword">return</span> unionpay.create_payment(order)
</code></pre>
<p>å°ç¦¾çœ‰å¤´å¾®çš±ï¼Œä½†è¿˜æ˜¯å¿äº†ã€‚</p>
<hr/>
<h3 data-id="heading-3">ç¬¬ä¸‰æ¬¡åŠ éœ€æ±‚</h3>
<p>åˆè¿‡äº†ä¸€ä¸ªæœˆï¼šã€ŒApple Pay å’Œ PayPal ä¹Ÿè¦æ”¯æŒï¼Œæµ·å¤–ç”¨æˆ·éœ€è¦ã€‚ã€</p>
<p>å°ç¦¾æ·±å¸ä¸€å£æ°”ï¼Œæ‰“å¼€ä»£ç åº“ã€‚</p>
<p>ç„¶åä»–å‘ç°ï¼Œ<code>if method == "xxx"</code> è¿™ä¸ªåˆ¤æ–­ä¸åªåœ¨ä¸€ä¸ªåœ°æ–¹ã€‚</p>
<p>åœ¨ <code>pay()</code> é‡Œæœ‰ã€‚
åœ¨ <code>refund()</code> é‡Œæœ‰ã€‚
åœ¨ <code>get_payment_name()</code> é‡Œæœ‰ã€‚
åœ¨ <code>check_available()</code> é‡Œä¹Ÿæœ‰ã€‚
åœ¨ <code>calculate_fee()</code> é‡Œè¿˜æœ‰ã€‚</p>
<p>ä¸€å…± 8 ä¸ªæ–‡ä»¶ï¼Œ23 å¤„åˆ¤æ–­ã€‚</p>
<p>å°ç¦¾ç›¯ç€å±å¹•ï¼Œé™·å…¥æ²‰æ€ï¼š</p>
<p><strong>ã€Œè¿™ä»£ç ï¼Œè¿˜èƒ½æ•‘å—ï¼Ÿã€</strong></p>
<hr/>
<h2 data-id="heading-4">æ•£å¼¹æªä»£ç ï¼šæ”¹ä¸€å¤„è¦åŠ¨åå¤„</h2>
<p>å°ç¦¾çš„é­é‡ï¼Œä½ å¯èƒ½ä¹Ÿç»å†è¿‡ã€‚</p>
<p>æˆ‘ç»™è¿™ç§ä»£ç èµ·äº†ä¸ªåå­—ï¼š<strong>æ•£å¼¹æªä»£ç </strong>ã€‚</p>
<p>ä¸ºä»€ä¹ˆå«è¿™ä¸ªåå­—ï¼Ÿå› ä¸ºæ”¹ä¸€ä¸ªéœ€æ±‚ï¼Œåƒæ‰“æ•£å¼¹æªä¸€æ ·ï¼Œè¦å‡»ä¸­åå‡ ä¸ªåœ°æ–¹ã€‚æ¼äº†ä¸€ä¸ªï¼Œçº¿ä¸Šç‚¸ã€‚</p>
<p>å®ƒæœ‰å‡ ä¸ªå…¸å‹ç—‡çŠ¶ï¼š</p>
<h3 data-id="heading-5">ç—‡çŠ¶ä¸€ï¼šä¿®æ”¹æ—¶å…¨å±€æœç´¢</h3>
<p>æ–°äººé—®ï¼šã€Œæˆ‘è¦åŠ ä¸ªæ–°æ”¯ä»˜æ–¹å¼ï¼Œæ”¹å“ªé‡Œï¼Ÿã€</p>
<p>ä½ ç­”ï¼šã€Œå…¨å±€æœ <code>if method</code>ï¼Œæœåˆ°çš„åœ°æ–¹éƒ½è¦æ”¹ã€‚ã€</p>
<p>æ–°äººçœ¼é‡Œçš„å…‰æš—äº†ã€‚</p>
<h3 data-id="heading-6">ç—‡çŠ¶äºŒï¼šå¤åˆ¶ç²˜è´´è”“å»¶</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># file1.py</span>
<span class="hljs-keyword">if</span> method == <span class="hljs-string">"alipay"</span>: ...
<span class="hljs-keyword">elif</span> method == <span class="hljs-string">"wechat"</span>: ...

<span class="hljs-comment"># file2.pyï¼ˆå¤åˆ¶ç²˜è´´ï¼‰</span>
<span class="hljs-keyword">if</span> method == <span class="hljs-string">"alipay"</span>: ...
<span class="hljs-keyword">elif</span> method == <span class="hljs-string">"wechat"</span>: ...

<span class="hljs-comment"># file3.pyï¼ˆå†å¤åˆ¶ï¼‰</span>
<span class="hljs-keyword">if</span> method == <span class="hljs-string">"alipay"</span>: ...
<span class="hljs-keyword">elif</span> method == <span class="hljs-string">"wechat"</span>: ...
</code></pre>
<p>è¿™ä¸æ˜¯ä»£ç å¤ç”¨ï¼Œè¿™æ˜¯ bug å¤åˆ¶ã€‚</p>
<h3 data-id="heading-7">ç—‡çŠ¶ä¸‰ï¼šæ¼æ”¹å¯¼è‡´çº¿ä¸Šäº‹æ•…</h3>
<p>å°ç¦¾åæ¥æŸ¥äº†ä¸€ä¸ª bugï¼šæŸä¸ªæ”¯ä»˜æ–¹å¼é€€æ¬¾å¤±è´¥ã€‚</p>
<p>åŸå› æ˜¯ <code>refund()</code> å‡½æ•°é‡Œæ¼äº†ä¸€ä¸ªåˆ†æ”¯â€”â€”å¤åˆ¶çš„æ—¶å€™å°‘ç²˜è´´äº†ä¸€æ®µã€‚</p>
<p><strong>é‚£æ™šä»–åŠ ç­åˆ°å‡Œæ™¨ä¸‰ç‚¹ã€‚</strong></p>
<hr/>
<h2 data-id="heading-8">é—®é¢˜çš„æœ¬è´¨ï¼šå†³ç­–æƒæ•£è½å„å¤„</h2>
<p>è®©æˆ‘ä»¬æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼š</p>
<p><strong>ã€Œç”¨å“ªä¸ªæ”¯ä»˜æ–¹å¼ã€è¿™ä¸ªå†³ç­–ï¼Œåº”è¯¥ç”±è°æ¥åšï¼Ÿ</strong></p>
<p>æ•£å¼¹æªä»£ç çš„é—®é¢˜åœ¨äºï¼šæ¯ä¸ªå‡½æ•°éƒ½åœ¨è‡ªå·±åšè¿™ä¸ªå†³ç­–ã€‚</p>
<ul>
<li><code>pay()</code> å‡½æ•°å†³å®šä¸€æ¬¡</li>
<li><code>refund()</code> å‡½æ•°åˆå†³å®šä¸€æ¬¡</li>
<li><code>get_payment_name()</code> å†å†³å®šä¸€æ¬¡</li>
</ul>
<p>åŒä¸€ä¸ªå†³ç­–ï¼Œé‡å¤åšäº† 23 æ¬¡ã€‚</p>
<p>è‡ªç„¶ä¼šå‡ºé—®é¢˜ã€‚</p>
<p><strong>æ­£ç¡®çš„åšæ³•æ˜¯ï¼šæŠŠå†³ç­–æƒæ”¶å½’ä¸€å¤„ã€‚</strong></p>
<hr/>
<h2 data-id="heading-9">å·¥å‚æ¨¡å¼ï¼šä¸€å¤„å†³ç­–ï¼Œå¤„å¤„å¤ç”¨</h2>
<p>æ‰“ä¸ªæ¯”æ–¹ã€‚</p>
<p>ä½ å»é¤å…ç‚¹é¤ï¼Œåªéœ€è¦è¯´ã€Œæ¥ä»½å®«ä¿é¸¡ä¸ã€ã€‚</p>
<p>ä½ ä¸éœ€è¦çŸ¥é“å¨æˆ¿ç”¨ä»€ä¹ˆé”…ã€ä»€ä¹ˆæ²¹ã€ä»€ä¹ˆç«å€™ã€‚å¨æˆ¿å°±æ˜¯ã€Œå·¥å‚ã€ï¼Œä½ åªç®¡ç‚¹èœå’Œåƒã€‚</p>
<p>ä»£ç ä¹Ÿä¸€æ ·ã€‚ä¸šåŠ¡é€»è¾‘åªéœ€è¦è¯´ã€Œç»™æˆ‘ä¸€ä¸ªæ”¯ä»˜å¤„ç†å™¨ã€ï¼Œä¸éœ€è¦å…³å¿ƒæ˜¯æ”¯ä»˜å®è¿˜æ˜¯å¾®ä¿¡ã€‚</p>
<p>è¿™å°±æ˜¯<strong>å·¥å‚æ¨¡å¼</strong>çš„æ ¸å¿ƒæ€æƒ³ã€‚</p>
<hr/>
<h2 data-id="heading-10">ç¬¬ä¸€æ­¥ï¼šé›†ä¸­å†³ç­–</h2>
<p>æœ€ç®€å•çš„æ”¹æ³•ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">PaymentFactory</span>:
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create</span>(<span class="hljs-params">method: <span class="hljs-built_in">str</span></span>):
        <span class="hljs-keyword">if</span> method == <span class="hljs-string">"alipay"</span>:
            <span class="hljs-keyword">return</span> AlipayProcessor()
        <span class="hljs-keyword">elif</span> method == <span class="hljs-string">"wechat"</span>:
            <span class="hljs-keyword">return</span> WechatProcessor()
        <span class="hljs-keyword">elif</span> method == <span class="hljs-string">"unionpay"</span>:
            <span class="hljs-keyword">return</span> UnionPayProcessor()
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f"ä¸æ”¯æŒçš„æ”¯ä»˜æ–¹å¼: <span class="hljs-subst">{method}</span>"</span>)
</code></pre>
<p>ä¸šåŠ¡ä»£ç å˜æˆï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">pay</span>(<span class="hljs-params">order, method=<span class="hljs-string">"alipay"</span></span>):
    processor = PaymentFactory.create(method)
    <span class="hljs-keyword">return</span> processor.pay(order)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">refund</span>(<span class="hljs-params">order, method</span>):
    processor = PaymentFactory.create(method)
    <span class="hljs-keyword">return</span> processor.refund(order)
</code></pre>
<p>ç­‰ç­‰ï¼Œå·¥å‚é‡Œä¸è¿˜æ˜¯ if-else å—ï¼Ÿ</p>
<p>æ˜¯çš„ã€‚ä½†å…³é”®åŒºåˆ«åœ¨äºï¼š</p>
<p><strong>if-else åªåœ¨å·¥å‚é‡Œå‡ºç°ä¸€æ¬¡ï¼Œä¸å†æ•£è½å„å¤„ã€‚</strong></p>
<p>æ–°å¢æ”¯ä»˜æ–¹å¼ï¼Ÿåªæ”¹å·¥å‚è¿™ä¸€ä¸ªæ–‡ä»¶ã€‚å…¶ä»– 7 ä¸ªæ–‡ä»¶ä¸€è¡Œä¸åŠ¨ã€‚</p>
<hr/>
<h2 data-id="heading-11">ç¬¬äºŒæ­¥ï¼šæ³¨å†Œæœºåˆ¶</h2>
<p>å·¥å‚é‡Œçš„ if-elseï¼Œèƒ½ä¸èƒ½ä¹Ÿæ¶ˆç­æ‰ï¼Ÿ</p>
<p>å¯ä»¥ã€‚ç”¨<strong>æ³¨å†Œè¡¨</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">PaymentFactory</span>:
    _processors = {}  <span class="hljs-comment"># æ³¨å†Œè¡¨</span>

<span class="hljs-meta">    @classmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">register</span>(<span class="hljs-params">cls, name: <span class="hljs-built_in">str</span>, processor_class</span>):
        <span class="hljs-string">"""æ³¨å†Œä¸€ä¸ªæ”¯ä»˜å¤„ç†å™¨"""</span>
        cls._processors[name] = processor_class

<span class="hljs-meta">    @classmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create</span>(<span class="hljs-params">cls, name: <span class="hljs-built_in">str</span></span>):
        <span class="hljs-string">"""åˆ›å»ºæ”¯ä»˜å¤„ç†å™¨å®ä¾‹"""</span>
        <span class="hljs-keyword">if</span> name <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> cls._processors:
            available = <span class="hljs-built_in">list</span>(cls._processors.keys())
            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f"ä¸æ”¯æŒ <span class="hljs-subst">{name}</span>ï¼Œå¯ç”¨: <span class="hljs-subst">{available}</span>"</span>)
        <span class="hljs-keyword">return</span> cls._processors[name]()
</code></pre>
<p>å„æ”¯ä»˜æ–¹å¼è‡ªå·±æ³¨å†Œï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># alipay_processor.py</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AlipayProcessor</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">pay</span>(<span class="hljs-params">self, order</span>): ...
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">refund</span>(<span class="hljs-params">self, order</span>): ...

PaymentFactory.register(<span class="hljs-string">"alipay"</span>, AlipayProcessor)

<span class="hljs-comment"># wechat_processor.py</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">WechatProcessor</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">pay</span>(<span class="hljs-params">self, order</span>): ...
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">refund</span>(<span class="hljs-params">self, order</span>): ...

PaymentFactory.register(<span class="hljs-string">"wechat"</span>, WechatProcessor)
</code></pre>
<p><strong>æ–°å¢ PayPalï¼Ÿåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œå†™ä¸€è¡Œæ³¨å†Œä»£ç ï¼Œå®Œäº‹ã€‚</strong></p>
<p>å·¥å‚ä»£ç ï¼Ÿä¸€ä¸ªå­—éƒ½ä¸ç”¨æ”¹ã€‚</p>
<p>è¿™å°±æ˜¯ã€Œå¼€é—­åŸåˆ™ã€ï¼š<strong>å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚</strong></p>
<hr/>
<h2 data-id="heading-12">AI é¡¹ç›®æ›´éœ€è¦è¿™ä¸ª</h2>
<p>å¦‚æœä½ åš AI ç›¸å…³çš„é¡¹ç›®ï¼Œè¿™ä¸ªæ¨¡å¼æ›´åŠ é‡è¦ã€‚</p>
<p>å› ä¸º AI æ¨¡å‹æœ‰ä¸ªç‰¹ç‚¹ï¼š<strong>é‡ä¸”æ˜“å˜</strong>ã€‚</p>
<ul>
<li>ä»Šå¤©è€æ¿è¯´ç”¨ GPT-4</li>
<li>æ˜å¤©è¯´å¤ªè´µï¼Œæ¢ Claude</li>
<li>åå¤©åˆè¯´è¯•è¯•å¼€æºçš„ Llama</li>
<li>å¤§åå¤©å‘ç°æŸä¸ªåœºæ™¯è¿˜æ˜¯ GPT-4 æ•ˆæœå¥½</li>
</ul>
<p>å¦‚æœä½ çš„ä»£ç æ•£è½ç€ <code>if model == "gpt4"</code> è¿™æ ·çš„åˆ¤æ–­â€¦â€¦</p>
<p>ç¥ä½ å¥½è¿ã€‚</p>
<p><strong>æ­£ç¡®çš„åšæ³•</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LLMFactory</span>:
    _adapters = {}
    _instance = <span class="hljs-literal">None</span>

<span class="hljs-meta">    @classmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">register</span>(<span class="hljs-params">cls, name, adapter_class</span>):
        cls._adapters[name] = adapter_class

<span class="hljs-meta">    @classmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">cls</span>):
        <span class="hljs-string">"""å•ä¾‹è·å–ï¼Œé¿å…é‡å¤åˆå§‹åŒ–"""</span>
        <span class="hljs-keyword">if</span> cls._instance <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            model = config.LLM_MODEL
            cls._instance = cls._adapters[model]()
        <span class="hljs-keyword">return</span> cls._instance

<span class="hljs-meta">    @classmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">reset</span>(<span class="hljs-params">cls</span>):
        <span class="hljs-string">"""åˆ‡æ¢æ¨¡å‹æ—¶é‡ç½®"""</span>
        <span class="hljs-keyword">if</span> cls._instance:
            cls._instance.cleanup()  <span class="hljs-comment"># é‡Šæ”¾æ˜¾å­˜ï¼</span>
        cls._instance = <span class="hljs-literal">None</span>
</code></pre>
<p>ä¸ºä»€ä¹ˆè¦å•ä¾‹ï¼Ÿå› ä¸º AI æ¨¡å‹åŠ è½½ä¸€æ¬¡å¯èƒ½è¦ï¼š</p>
<ul>
<li>30 ç§’å¯åŠ¨æ—¶é—´</li>
<li>10GB æ˜¾å­˜</li>
<li>ä¸€å † CUDA åˆå§‹åŒ–</li>
</ul>
<p>æ¯æ¬¡è¯·æ±‚éƒ½é‡æ–°åŠ è½½ï¼Ÿç”¨æˆ·ä¼šç–¯ã€‚</p>
<hr/>
<h2 data-id="heading-13">ä»€ä¹ˆæ—¶å€™è¯¥ç”¨</h2>

























<table><thead><tr><th>åœºæ™¯</th><th>å»ºè®®</th></tr></thead><tbody><tr><td>åªæœ‰ 2-3 ç§ç±»å‹ï¼Œä»¥åä¸ä¼šåŠ </td><td>if-else è¶³å¤Ÿ</td></tr><tr><td>ç±»å‹ä¼šæ‰©å±•</td><td>æ³¨å†Œå¼å·¥å‚</td></tr><tr><td>å¯¹è±¡åˆ›å»ºæˆæœ¬é«˜</td><td>å·¥å‚ + å•ä¾‹</td></tr><tr><td>å¤§å‹é¡¹ç›®</td><td>åˆ†å±‚å·¥å‚</td></tr></tbody></table>
<p><strong>æœ€é‡è¦çš„ä¸€ç‚¹ï¼šåˆ«è¿‡åº¦è®¾è®¡ã€‚</strong></p>
<p>å¦‚æœä½ çš„é¡¹ç›®å°± 2 ä¸ªé€‰é¡¹ï¼Œä»¥åä¹Ÿä¸ä¼šæœ‰ç¬¬ 3 ä¸ªï¼Œé‚£ if-else å®Œå…¨æ²¡é—®é¢˜ã€‚</p>
<p>å·¥å‚æ¨¡å¼æ˜¯ç”¨æ¥è§£å†³ã€Œç±»å‹ä¼šå˜å¤šã€è¿™ä¸ªé—®é¢˜çš„ã€‚é—®é¢˜ä¸å­˜åœ¨ï¼Œè§£å†³æ–¹æ¡ˆä¹Ÿä¸éœ€è¦å­˜åœ¨ã€‚</p>
<hr/>
<h2 data-id="heading-14">æ•…äº‹çš„ç»“å°¾</h2>
<p>å°ç¦¾ç”¨ä¸€ä¸ªå‘¨æœ«é‡æ„äº†ä»£ç ã€‚</p>
<p>æŠŠ 23 å¤„ if-else æ”¶å½’åˆ°äº†ä¸€å¤„ã€‚</p>
<p>å‘¨ä¸€äº§å“ç»ç†åˆæ¥ï¼šã€Œå°ç¦¾å•Šï¼Œæ•°å­—äººæ°‘å¸ä¹Ÿè¦æ”¯æŒï¼Œæ”¿ç­–è¦æ±‚ã€‚ã€</p>
<p>å°ç¦¾å¾®å¾®ä¸€ç¬‘ï¼Œæ–°å»ºäº†ä¸€ä¸ª <code>dcep_processor.py</code>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DCEPProcessor</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">pay</span>(<span class="hljs-params">self, order</span>): ...
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">refund</span>(<span class="hljs-params">self, order</span>): ...

PaymentFactory.register(<span class="hljs-string">"dcep"</span>, DCEPProcessor)
</code></pre>
<p>æäº¤ä»£ç ã€‚</p>
<p>ã€Œæå®šäº†ã€‚ã€</p>
<p>äº§å“ç»ç†ï¼šã€Œè¿™ä¹ˆå¿«ï¼Ÿã€</p>
<p>å°ç¦¾ç«¯èµ·å’–å•¡ï¼šã€Œä»£ç æ¶æ„å¯¹äº†ï¼Œéœ€æ±‚å°±ä¸æ˜¯äº‹å„¿ã€‚ã€</p>
<hr/>
<h2 data-id="heading-15">ä¸€å¥è¯æ€»ç»“</h2>
<blockquote>
<p><strong>è®¾è®¡æ¨¡å¼çš„ä»·å€¼ï¼Œä¸åœ¨äºä»£ç å˜å°‘ï¼Œè€Œåœ¨äºæ”¹åŠ¨å˜å°‘ã€‚</strong></p>
</blockquote>
<p>å½“ä½ èƒ½åšåˆ°ã€ŒåŠ åŠŸèƒ½åªéœ€åŠ ä»£ç ï¼Œä¸éœ€æ”¹ä»£ç ã€çš„æ—¶å€™ï¼Œä½ å°±çœŸæ­£ç†è§£äº†è®¾è®¡æ¨¡å¼çš„ç²¾é«“ã€‚</p>
<p>è€Œè¿™ï¼Œä¹Ÿæ˜¯åŒºåˆ†ã€Œå†™ä»£ç ã€å’Œã€Œåšå·¥ç¨‹ã€çš„åˆ†æ°´å²­ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vite 8 å‘å¸ƒ beta ç‰ˆæœ¬äº†ï¼Œå‡çº§ä½“éªŒä¸€ä¸‹ Rolldown]]></title>    <link>https://juejin.cn/post/7582896213855797263</link>    <guid>https://juejin.cn/post/7582896213855797263</guid>    <pubDate>2025-12-13T16:56:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582896213855797263" data-draft-id="7582896213855780879" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vite 8 å‘å¸ƒ beta ç‰ˆæœ¬äº†ï¼Œå‡çº§ä½“éªŒä¸€ä¸‹ Rolldown"/> <meta itemprop="keywords" content="å‰ç«¯,Vite"/> <meta itemprop="datePublished" content="2025-12-13T16:56:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Airene"/> <meta itemprop="url" content="https://juejin.cn/user/219558053950871"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vite 8 å‘å¸ƒ beta ç‰ˆæœ¬äº†ï¼Œå‡çº§ä½“éªŒä¸€ä¸‹ Rolldown
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/219558053950871/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Airene
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T16:56:16.000Z" title="Sat Dec 13 2025 16:56:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Vite 8 å‘å¸ƒ beta ç‰ˆæœ¬äº†ï¼Œå‡çº§ä½“éªŒä¸€ä¸‹ Rolldown</h2>
<h3 data-id="heading-1">ç¼–è¯‘æ—¶é—´</h3>
<p>å½“å‰æ˜¯ç”¨ beta.2 ç‰ˆæœ¬ï¼Œå› ä¸ºæµ‹è¯•é¡¹ç›®éå¸¸çš„å°ï¼ˆçœŸå®é¡¹ç›®ï¼‰ï¼Œç¼–è¯‘æ—¶é—´æ˜¯ä»å¤§æ¦‚ 260ms åˆ° 80ms çš„é‡çº§ ğŸ¶ï¼Œ<strong>è¿™å¯èƒ½æ˜¯ä¸ªä¸å…¬å¹³çš„å¯¹æ¯”</strong>ï¼Œå› ä¸ºå‘ç° rolldown ç¬¬ä¸€æ¬¡ä¹Ÿæ˜¯ 260+msï¼Œç„¶ååŸåœ°å†ç¼–è¯‘æ‰æ˜¯å‰é¢çš„ç»“æœ(æœ‰cacheï¼Ÿ)ï¼Œä¹Ÿå°±æ˜¯ rollup å§‹ç»ˆå·®ä¸å¤šçš„é€Ÿåº¦ä¸åŒºåˆ†ç¬¬ä¸€æ¬¡ï¼Œå†æ¬¡ç¼–è¯‘ rolldown ä¼šå¿«ï¼Œ åŒºåˆ†æ˜¯ä¸æ˜¯ç¬¬ä¸€æ¬¡ã€‚</p>
<h3 data-id="heading-2">vite.config çš„å˜åŒ–</h3>
<p>æˆ‘æœ‰ä¸€ä¸ªç‰¹æ®Šçš„éœ€æ±‚ï¼Œå°±æ˜¯æ¯ä¸ªé¡µé¢éƒ½éå¸¸å°ï¼Œè€Œä¸”é¡µé¢ä¸å¤šï¼Œå¸Œæœ›æ˜¯ä¸è¦ç”Ÿæˆé‚£ä¹ˆå¤š js æ–‡ä»¶ï¼Œæ‰€ä»¥ä¹‹å‰çš„åšæ³•æ˜¯ rollup çš„é€‰é¡¹ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">rollupOptions</span>: {
    <span class="hljs-attr">output</span>: {
        <span class="hljs-title function_">manualChunks</span>(<span class="hljs-params">id</span>) {
            <span class="hljs-keyword">if</span> (id.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'pages'</span>)) {
                <span class="hljs-keyword">return</span> <span class="hljs-string">'pages'</span>
            }
        }
    }
}
<span class="hljs-comment">// ä¹‹å‰çš„ç»“æœ vite7 rollup</span>
<span class="hljs-comment">// dist/index.html                  0.45 kB â”‚ gzip:  0.30 kB</span>
<span class="hljs-comment">// dist/assets/style-D2W9t87U.css   5.50 kB â”‚ gzip:  1.58 kB</span>
<span class="hljs-comment">// dist/assets/index-D5uKrQyu.js   28.56 kB â”‚ gzip: 11.05 kB</span>
<span class="hljs-comment">// dist/assets/pages-BL4EWsDv.js   83.42 kB â”‚ gzip: 32.14 kB</span>
</code></pre>
<p>rolldown æ²¡æœ‰è¿™ä¸ªæ¦‚å¿µï¼Œ<code>manualChunks</code> å¯¹ç­‰çš„æ˜¯ <code>advancedChunks</code>ï¼ŒæŠ˜è…¾åŠå¤© <code>advancedChunks</code> è¾¾ä¸åˆ°æƒ³è¦çš„æ•ˆæœï¼ˆå¯èƒ½æ˜¯é’ˆå¯¹ node_modules æ¯”è¾ƒå¼ºï¼Œå¯èƒ½æ˜¯æ²¡æ‰¾å¯¹æ–¹æ³•ï¼‰ï¼Œæ‰¾äº†åŠå¤©æ‰¾åˆ°ä¸€ä¸ªæ–¹æ³•å¯ä»¥åšåˆ°ï¼Œè¿™ä¸ªåšæ³•å¯¹æˆ‘çš„é¡¹ç›®æœ‰ç”¨ï¼Œä½†æ˜¯å¤§é¡¹ç›®åº”è¯¥ä¸è¡Œï¼Œæ‰€æœ‰é¡¹ç›®æ–‡ä»¶éƒ½ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶äº†ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">rolldownOptions</span>: {
    <span class="hljs-attr">output</span>: {
        <span class="hljs-attr">inlineDynamicImports</span>: <span class="hljs-literal">true</span>
    }
}
<span class="hljs-comment">// rolldown çš„è¾“å‡ºå†…å®¹å¤šäº†ä¸€ä¸ª rolldown-runtime</span>
<span class="hljs-comment">// dist/index.html                           0.54 kB â”‚ gzip:  0.31 kB</span>
<span class="hljs-comment">// dist/assets/style-Bac8aBaN.css            5.46 kB â”‚ gzip:  1.56 kB</span>
<span class="hljs-comment">// dist/assets/rolldown-runtime-BcdYIZKG.js  0.19 kB â”‚ gzip:  0.17 kB</span>
<span class="hljs-comment">// dist/assets/index-pOi5csA0.js             25.03 kB â”‚ gzip:  9.38 kB</span>
<span class="hljs-comment">// dist/assets/vendor-p3Su3_y3.js            85.17 kB â”‚ gzip: 33.12 kB</span>
</code></pre>
<p>ä¸åŠ ä¸Šé¢é€‰é¡¹çš„ç»“æœ</p>
<pre><code class="hljs language-text" lang="text">// æ–‡ä»¶å¾ˆå¤š vite 8 &amp; rolldownï¼Œ vite 7 ç±»ä¼¼
dist/index.html                     0.45 kB â”‚ gzip:  0.29 kB
dist/assets/style-Bac8aBaN.css      5.46 kB â”‚ gzip:  1.56 kB
dist/assets/not-found-DAToitwy.js   0.12 kB â”‚ gzip:  0.13 kB
dist/assets/api-Br4_g19J.js         0.42 kB â”‚ gzip:  0.17 kB
dist/assets/home-BSTox8wn.js        0.59 kB â”‚ gzip:  0.38 kB
dist/assets/things-BUk3p1b5.js      0.83 kB â”‚ gzip:  0.53 kB
dist/assets/eol-WmdroNCa.js         1.88 kB â”‚ gzip:  0.97 kB
dist/assets/angling-Bh7xqOUY.js     1.92 kB â”‚ gzip:  0.78 kB
dist/assets/fin-5dWvAvtB.js         1.97 kB â”‚ gzip:  0.87 kB
dist/assets/genuine-DKX79-2_.js     2.40 kB â”‚ gzip:  1.01 kB
dist/assets/frame-main-CGg78mi8.js  2.41 kB â”‚ gzip:  1.27 kB
dist/assets/pc-hLrRv_Pv.js          2.55 kB â”‚ gzip:  0.68 kB
dist/assets/vers-COZW8I_8.js        2.90 kB â”‚ gzip:  1.15 kB
dist/assets/index-CbFw2-HB.js       3.76 kB â”‚ gzip:  1.60 kB
dist/assets/about-BcSEGuXl.js       4.18 kB â”‚ gzip:  2.39 kB
dist/assets/vendor-BMuo1oit.js      84.70 kB â”‚ gzip: 32.75 kB
</code></pre>
<h3 data-id="heading-3">ç»“è®º</h3>
<ul>
<li>åªä¾èµ– vue, vue-router çš„é¡¹ç›®æ²¡é—®é¢˜ï¼Œç”Ÿäº§å¯ç”¨ã€‚</li>
<li>rolldown çš„ node_modules å¤§å°å±…ç„¶æ¯” vite7 çš„ esbuild å’Œ rollup çš„è¿˜å¤§äº†ä¸€ç‚¹ 47.5MB &gt; 35.2MB ğŸ¥´</li>
</ul>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"vue"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^3.5.25"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"vue-router"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^4.6.4"</span>
<span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
<span class="hljs-attr">"devDependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"@vitejs/plugin-vue"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^6.0.3"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"vite"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^8.0.0-beta.2"</span>
<span class="hljs-punctuation">}</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScript äº‹ä»¶å¾ªç¯æœºåˆ¶è¯¦è§£åŠé¡¹ç›®ä¸­çš„åº”ç”¨]]></title>    <link>https://juejin.cn/post/7582905804048187419</link>    <guid>https://juejin.cn/post/7582905804048187419</guid>    <pubDate>2025-12-13T18:35:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582905804048187419" data-draft-id="7582875640309579826" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript äº‹ä»¶å¾ªç¯æœºåˆ¶è¯¦è§£åŠé¡¹ç›®ä¸­çš„åº”ç”¨"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-13T18:35:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="cindershade"/> <meta itemprop="url" content="https://juejin.cn/user/2587590326494763"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript äº‹ä»¶å¾ªç¯æœºåˆ¶è¯¦è§£åŠé¡¹ç›®ä¸­çš„åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2587590326494763/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    cindershade
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T18:35:13.000Z" title="Sat Dec 13 2025 18:35:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºç¡€æ¦‚å¿µ</h2>
<h3 data-id="heading-1">1. JavaScript æ‰§è¡Œç¯å¢ƒ</h3>
<p>JavaScript æ˜¯<strong>å•çº¿ç¨‹</strong>çš„ï¼Œè¿™æ„å‘³ç€å®ƒä¸€æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ã€‚ä¸ºäº†å¤„ç†å¼‚æ­¥æ“ä½œï¼ŒJavaScript ä½¿ç”¨<strong>äº‹ä»¶å¾ªç¯</strong>æœºåˆ¶ã€‚</p>
<h3 data-id="heading-2">2. æ ¸å¿ƒç»„ä»¶</h3>
<ul>
<li><strong>è°ƒç”¨æ ˆï¼ˆCall Stackï¼‰</strong> ï¼šæ‰§è¡ŒåŒæ­¥ä»£ç çš„åœ°æ–¹</li>
<li><strong>ä»»åŠ¡é˜Ÿåˆ—ï¼ˆTask Queueï¼‰</strong> ï¼šåˆ†ä¸ºå®ä»»åŠ¡é˜Ÿåˆ—å’Œå¾®ä»»åŠ¡é˜Ÿåˆ—</li>
<li><strong>äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰</strong> ï¼šåè°ƒè°ƒç”¨æ ˆå’Œä»»åŠ¡é˜Ÿåˆ—çš„æœºåˆ¶</li>
</ul>
<h2 data-id="heading-3">ç¬¬äºŒéƒ¨åˆ†ï¼šä¸¾ä¾‹è¯¦ç»†è§£æ</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'1. åŒæ­¥ä»»åŠ¡å¼€å§‹'</span>);

<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'2. setTimeout å›è°ƒ'</span>);
}, <span class="hljs-number">0</span>);

<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'3. Promise.then å›è°ƒ'</span>);
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'4. åŒæ­¥ä»»åŠ¡ç»“æŸ'</span>);
</code></pre>
<h3 data-id="heading-4">æ‰§è¡Œæ­¥éª¤åˆ†æï¼š</h3>
<h4 data-id="heading-5">ç¬¬1æ­¥ï¼šåŒæ­¥ä»»åŠ¡æ‰§è¡Œ</h4>
<ol>
<li><code>console.log('1. åŒæ­¥ä»»åŠ¡å¼€å§‹')</code>Â å‹å…¥è°ƒç”¨æ ˆï¼Œç«‹å³æ‰§è¡Œï¼Œè¾“å‡ºÂ <code>1</code></li>
<li><code>setTimeout</code>Â å‹å…¥è°ƒç”¨æ ˆï¼ŒWeb API å¼€å§‹è®¡æ—¶ï¼ˆ0msï¼‰ï¼Œå›è°ƒå‡½æ•°æ”¾å…¥<strong>å®ä»»åŠ¡é˜Ÿåˆ—</strong></li>
<li><code>Promise.resolve().then()</code>Â å‹å…¥è°ƒç”¨æ ˆï¼Œ<code>.then()</code>Â çš„å›è°ƒå‡½æ•°æ”¾å…¥<strong>å¾®ä»»åŠ¡é˜Ÿåˆ—</strong></li>
<li><code>console.log('4. åŒæ­¥ä»»åŠ¡ç»“æŸ')</code>Â å‹å…¥è°ƒç”¨æ ˆï¼Œç«‹å³æ‰§è¡Œï¼Œè¾“å‡ºÂ <code>4</code></li>
</ol>
<p>æ­¤æ—¶çŠ¶æ€ï¼š</p>
<ul>
<li><strong>è°ƒç”¨æ ˆ</strong>ï¼šç©º</li>
<li><strong>å¾®ä»»åŠ¡é˜Ÿåˆ—</strong>ï¼š<code>[Promise.thenå›è°ƒ]</code></li>
<li><strong>å®ä»»åŠ¡é˜Ÿåˆ—</strong>ï¼š<code>[setTimeoutå›è°ƒ]</code></li>
</ul>
<h4 data-id="heading-6">ç¬¬2æ­¥ï¼šäº‹ä»¶å¾ªç¯æ£€æŸ¥</h4>
<ol>
<li><strong>è°ƒç”¨æ ˆä¸ºç©º</strong>ï¼Œäº‹ä»¶å¾ªç¯å¼€å§‹å·¥ä½œ</li>
<li><strong>ä¼˜å…ˆæ£€æŸ¥å¾®ä»»åŠ¡é˜Ÿåˆ—</strong>ï¼Œå‘ç°æœ‰ä¸€ä¸ªä»»åŠ¡</li>
<li>æ‰§è¡Œå¾®ä»»åŠ¡ï¼š<code>console.log('3. Promise.then å›è°ƒ')</code>ï¼Œè¾“å‡ºÂ <code>3</code></li>
<li><strong>å¾®ä»»åŠ¡é˜Ÿåˆ—æ¸…ç©º</strong></li>
</ol>
<h4 data-id="heading-7">ç¬¬3æ­¥ï¼šç»§ç»­äº‹ä»¶å¾ªç¯</h4>
<ol>
<li>å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºï¼Œç°åœ¨æ£€æŸ¥å®ä»»åŠ¡é˜Ÿåˆ—</li>
<li>æ‰§è¡Œå®ä»»åŠ¡ï¼š<code>setTimeout</code>Â å›è°ƒï¼Œè¾“å‡ºÂ <code>2</code></li>
<li>å®ä»»åŠ¡é˜Ÿåˆ—æ¸…ç©º</li>
</ol>
<h3 data-id="heading-8">æœ€ç»ˆè¾“å‡ºé¡ºåºï¼š<code>1 4 3 2</code></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'script start'</span>) 
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">async1</span>(<span class="hljs-params"/>) { 
   <span class="hljs-keyword">await</span> <span class="hljs-title function_">async2</span>() 
   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'async1 end'</span>)
} 
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">async2</span>(<span class="hljs-params"/>) { 
   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'async2 end'</span>) 
} 
<span class="hljs-title function_">async1</span>() 
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { 
   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'setTimeout'</span>) 
}, <span class="hljs-number">0</span>)
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span>{
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Promise'</span>)
  <span class="hljs-title function_">resolve</span>()
}).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Promise1'</span>)
})
</code></pre>
<h3 data-id="heading-9">å…³é”®æ¦‚å¿µï¼šasync/await</h3>
<ul>
<li><code>async</code>Â å‡½æ•°æ€»æ˜¯è¿”å›ä¸€ä¸ª Promise</li>
<li><code>await</code>Â ä¼šæš‚åœ async å‡½æ•°çš„æ‰§è¡Œï¼Œç›´åˆ° Promise è§£å†³</li>
<li><code>await</code>Â åé¢çš„ä»£ç ç›¸å½“äºæ”¾åœ¨Â <code>.then()</code>Â ä¸­ï¼Œå±äº<strong>å¾®ä»»åŠ¡</strong></li>
</ul>
<h3 data-id="heading-10">æ‰§è¡Œæ­¥éª¤åˆ†æï¼š</h3>
<h4 data-id="heading-11">ç¬¬1æ­¥ï¼šåŒæ­¥ä»»åŠ¡æ‰§è¡Œ</h4>
<ol>
<li>
<p><code>console.log('script start')</code>Â â†’ è¾“å‡ºÂ <code>script start</code></p>
</li>
<li>
<p>å®šä¹‰å‡½æ•°Â <code>async1</code>Â å’ŒÂ <code>async2</code>ï¼ˆä¸æ‰§è¡Œï¼‰</p>
</li>
<li>
<p>è°ƒç”¨Â <code>async1()</code></p>
<ul>
<li>è¿›å…¥Â <code>async1</code>ï¼Œé‡åˆ°Â <code>await async2()</code></li>
<li>è°ƒç”¨Â <code>async2()</code>Â â†’Â <code>console.log('async2 end')</code>Â â†’ è¾“å‡ºÂ <code>async2 end</code></li>
<li><code>await</code>Â æš‚åœæ‰§è¡Œï¼Œ<strong><code>console.log('async1 end')</code>Â è¢«åŒ…è£…æˆå¾®ä»»åŠ¡</strong>æ”¾å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—</li>
</ul>
</li>
<li>
<p><code>setTimeout</code>Â â†’ å›è°ƒå‡½æ•°æ”¾å…¥<strong>å®ä»»åŠ¡é˜Ÿåˆ—</strong></p>
</li>
<li>
<p>æ‰§è¡ŒÂ <code>new Promise</code></p>
<ul>
<li><code>console.log('Promise')</code>Â æ˜¯åŒæ­¥ä»£ç  â†’ è¾“å‡ºÂ <code>Promise</code></li>
<li><code>resolve()</code>Â æ‰§è¡Œï¼Œ<code>.then()</code>Â çš„å›è°ƒæ”¾å…¥<strong>å¾®ä»»åŠ¡é˜Ÿåˆ—</strong></li>
</ul>
</li>
</ol>
<p>æ­¤æ—¶çŠ¶æ€ï¼š</p>
<ul>
<li><strong>è°ƒç”¨æ ˆ</strong>ï¼šç©º</li>
<li><strong>å¾®ä»»åŠ¡é˜Ÿåˆ—</strong>ï¼š<code>[async1 end, Promise1]</code>ï¼ˆæ³¨æ„é¡ºåºï¼ï¼‰</li>
<li><strong>å®ä»»åŠ¡é˜Ÿåˆ—</strong>ï¼š<code>[setTimeoutå›è°ƒ]</code></li>
</ul>
<h4 data-id="heading-12">ç¬¬2æ­¥ï¼šäº‹ä»¶å¾ªç¯æ£€æŸ¥å¾®ä»»åŠ¡</h4>
<ol>
<li>
<p><strong>è°ƒç”¨æ ˆä¸ºç©º</strong>ï¼Œæ‰§è¡Œå¾®ä»»åŠ¡</p>
</li>
<li>
<p><strong>æŒ‰å…¥é˜Ÿé¡ºåºæ‰§è¡Œ</strong>å¾®ä»»åŠ¡ï¼š</p>
<ul>
<li>ç¬¬ä¸€ä¸ªå¾®ä»»åŠ¡ï¼š<code>console.log('async1 end')</code>Â â†’ è¾“å‡ºÂ <code>async1 end</code></li>
<li>ç¬¬äºŒä¸ªå¾®ä»»åŠ¡ï¼š<code>console.log('Promise1')</code>Â â†’ è¾“å‡ºÂ <code>Promise1</code></li>
</ul>
</li>
<li>
<p><strong>å¾®ä»»åŠ¡é˜Ÿåˆ—æ¸…ç©º</strong></p>
</li>
</ol>
<h4 data-id="heading-13">ç¬¬3æ­¥ï¼šæ‰§è¡Œå®ä»»åŠ¡</h4>
<ol>
<li>æ‰§è¡ŒÂ <code>setTimeout</code>Â å›è°ƒ â†’ è¾“å‡ºÂ <code>setTimeout</code></li>
</ol>
<h3 data-id="heading-14">æœ€ç»ˆè¾“å‡ºé¡ºåºï¼š<code>script start â†’ async2 end â†’ Promise â†’ async1 end â†’ Promise1 â†’ setTimeout</code></h3>
<p>é‚£ä¹ˆåˆ°æ­¤ï¼Œåº”è¯¥æ˜¯å¯ä»¥ç†è§£åˆ°äº‹ä»¶å¾ªç¯çš„æ„Ÿè§‰äº†ï¼Œé‚£æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¼€å§‹çœ‹çœ‹äº‹ä»¶å¾ªç¯çš„å®Œæ•´é€»è¾‘</p>
<h3 data-id="heading-15">1. ä»»åŠ¡åˆ†ç±»</h3>
<h4 data-id="heading-16">å®ä»»åŠ¡ï¼ˆMacrotasksï¼‰</h4>
<ul>
<li><code>setTimeout</code>ã€<code>setInterval</code></li>
<li><code>setImmediate</code>ï¼ˆNode.jsï¼‰</li>
<li><code>requestAnimationFrame</code>ï¼ˆæµè§ˆå™¨ï¼‰</li>
<li>I/O æ“ä½œ</li>
<li>UI æ¸²æŸ“ï¼ˆæµè§ˆå™¨ï¼‰</li>
<li>ä¸»çº¿ç¨‹çš„ script æ ‡ç­¾å†…å®¹</li>
</ul>
<h4 data-id="heading-17">å¾®ä»»åŠ¡ï¼ˆMicrotasksï¼‰</h4>
<ul>
<li><code>Promise.then()</code>ã€<code>.catch()</code>ã€<code>.finally()</code></li>
<li><code>process.nextTick()</code>ï¼ˆNode.jsï¼Œä¼˜å…ˆçº§æœ€é«˜ï¼‰</li>
<li><code>MutationObserver</code>ï¼ˆæµè§ˆå™¨ï¼‰</li>
<li><code>queueMicrotask()</code></li>
<li><strong>async/await</strong>Â çš„åç»­ä»£ç </li>
</ul>
<h3 data-id="heading-18">2. äº‹ä»¶å¾ªç¯æ‰§è¡Œé¡ºåº</h3>
<pre><code class="hljs language-text" lang="text">1. æ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡ï¼ˆscriptæ ‡ç­¾å†…å®¹ï¼‰
2. æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°å¼‚æ­¥ä»»åŠ¡ï¼š
   - å®ä»»åŠ¡ â†’ æ”¾å…¥å®ä»»åŠ¡é˜Ÿåˆ—
   - å¾®ä»»åŠ¡ â†’ æ”¾å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—
3. å½“å‰å®ä»»åŠ¡æ‰§è¡Œå®Œæ¯•
4. æ£€æŸ¥å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¾æ¬¡æ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡
5. å¦‚æœ‰å¿…è¦ï¼Œè¿›è¡ŒUIæ¸²æŸ“
6. ä»å®ä»»åŠ¡é˜Ÿåˆ—å–å‡ºä¸‹ä¸€ä¸ªå®ä»»åŠ¡æ‰§è¡Œ
7. å›åˆ°æ­¥éª¤3ï¼Œå½¢æˆå¾ªç¯
</code></pre>
<h3 data-id="heading-19">3. é‡è¦è§„åˆ™</h3>
<h4 data-id="heading-20">è§„åˆ™1ï¼šå¾®ä»»åŠ¡ä¼˜å…ˆ</h4>
<ul>
<li>æ¯æ‰§è¡Œå®Œä¸€ä¸ªå®ä»»åŠ¡ï¼Œéƒ½è¦æ¸…ç©º<strong>æ‰€æœ‰</strong>å¾®ä»»åŠ¡</li>
<li>å¾®ä»»åŠ¡æ‰§è¡ŒæœŸé—´äº§ç”Ÿçš„<strong>æ–°å¾®ä»»åŠ¡</strong>ä¼šåŠ å…¥å½“å‰é˜Ÿåˆ—ï¼Œå¹¶åœ¨æœ¬æ¬¡å¾ªç¯ä¸­æ‰§è¡Œ</li>
</ul>
<h4 data-id="heading-21">è§„åˆ™2ï¼šasync/await è½¬åŒ–</h4>
<p>javascript</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">example</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">foo</span>()        <span class="hljs-comment">// ç›¸å½“äº Promise.resolve(foo()).then(...)</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'A'</span>)   <span class="hljs-comment">// è¿™éƒ¨åˆ†åœ¨å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­</span>
}
</code></pre>
<h4 data-id="heading-22">è§„åˆ™3ï¼šå¤šä¸ªä»»åŠ¡é˜Ÿåˆ—</h4>
<ul>
<li>å®ä»»åŠ¡å¯èƒ½æœ‰å¤šä¸ªæ¥æºï¼ˆå®šæ—¶å™¨ã€I/Oç­‰ï¼‰ï¼Œæœ‰å„è‡ªçš„é˜Ÿåˆ—</li>
<li>å¾®ä»»åŠ¡åªæœ‰ä¸€ä¸ªé˜Ÿåˆ—ï¼ŒæŒ‰å…¥é˜Ÿé¡ºåºæ‰§è¡Œ</li>
</ul>
<h2 data-id="heading-23">åœ¨ä¸¾ä¾‹ç†è§£ä¸€ä¸‹</h2>
<p>javascript</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æµ‹è¯•å¾®ä»»åŠ¡åµŒå¥—</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¾®ä»»åŠ¡1'</span>);
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¾®ä»»åŠ¡ä¸­çš„å¾®ä»»åŠ¡'</span>);
    });
}).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¾®ä»»åŠ¡2'</span>);
});

<span class="hljs-comment">// è¾“å‡ºé¡ºåºï¼šå¾®ä»»åŠ¡1 â†’ å¾®ä»»åŠ¡ä¸­çš„å¾®ä»»åŠ¡ â†’ å¾®ä»»åŠ¡2</span>
</code></pre>
<p>javascript</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æµ‹è¯•å¤šä¸ªå®ä»»åŠ¡</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å®ä»»åŠ¡1'</span>), <span class="hljs-number">10</span>);
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¾®ä»»åŠ¡1'</span>));
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å®ä»»åŠ¡2'</span>);
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å®ä»»åŠ¡2ä¸­çš„å¾®ä»»åŠ¡'</span>));
}, <span class="hljs-number">1</span>);
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¾®ä»»åŠ¡2'</span>));
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å®ä»»åŠ¡3'</span>); 
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å®ä»»åŠ¡3ä¸­çš„å¾®ä»»åŠ¡'</span>)); 
}, <span class="hljs-number">0</span>);

ç»“æœï¼š
å¾®ä»»åŠ¡<span class="hljs-number">1</span>
å¾®ä»»åŠ¡<span class="hljs-number">2</span>
å®ä»»åŠ¡<span class="hljs-number">3</span>
å®ä»»åŠ¡<span class="hljs-number">3</span>ä¸­çš„å¾®ä»»åŠ¡
å®ä»»åŠ¡<span class="hljs-number">1</span>
å®ä»»åŠ¡<span class="hljs-number">2</span>
å®ä»»åŠ¡<span class="hljs-number">2</span>ä¸­çš„å¾®ä»»åŠ¡
ä¸ºä»€ä¹ˆå‘¢ï¼Ÿèªæ˜çš„ä½ å·²ç»ä¼šäº†
ä¸€å¼€å§‹ å¾®ä»»åŠ¡ æ”¾å…¥ å¾®ä»»åŠ¡<span class="hljs-number">1</span>ï¼Œ å¾®ä»»åŠ¡<span class="hljs-number">2</span>ï¼›ç„¶åå®ä»»åŠ¡æ”¾å…¥ å®ä»»åŠ¡<span class="hljs-number">3</span>
è¿™ä¸ªæ—¶å€™ï¼Œ è®¡æ—¶å™¨è¿˜æ²¡æœ‰åˆ°åº•100msçš„æ—¶å€™ï¼Œ æ‰“å°å¾®ä»»åŠ¡<span class="hljs-number">1</span>ã€å¾®ä»»åŠ¡<span class="hljs-number">2</span>ï¼›ç„¶åå¾®ä»»åŠ¡æ¸…ç©ºï¼Œå¼€å§‹ å®ä»»åŠ¡<span class="hljs-number">3</span>ï¼Œ æ”¾å…¥å¾®ä»»åŠ¡ å®ä»»åŠ¡<span class="hljs-number">3</span>ä¸­çš„å¾®ä»»åŠ¡ï¼Œç„¶åæ‰“å°å®ä»»åŠ¡<span class="hljs-number">3</span>ä¸­çš„å¾®ä»»åŠ¡ï¼› ç„¶åè®¡æ—¶å™¨åˆ°äº†ï¼Œæ‰“å°å®ä»»åŠ¡<span class="hljs-number">1</span>ã€å®ä»»åŠ¡<span class="hljs-number">2</span>
ã€æ”¾å…¥å¾®ä»»åŠ¡ï¼Œ æ‰“å°å®ä»»åŠ¡<span class="hljs-number">2</span>ä¸­çš„å¾®ä»»åŠ¡ï¼›å¤§æ¦‚å°±æ˜¯è¿™ç§æ„Ÿè§‰
</code></pre>
<h2 data-id="heading-24">æ€»ç»“</h2>
<ol>
<li><strong>åŒæ­¥ä»»åŠ¡</strong>ç«‹å³æ‰§è¡Œ</li>
<li><strong>å¾®ä»»åŠ¡</strong>æ¯”<strong>å®ä»»åŠ¡</strong>ä¼˜å…ˆçº§é«˜</li>
<li>æ¯ä¸ª<strong>å®ä»»åŠ¡</strong>æ‰§è¡Œåï¼Œéƒ½è¦æ¸…ç©º<strong>æ‰€æœ‰å¾®ä»»åŠ¡</strong></li>
<li><code>async/await</code>Â æœ¬è´¨æ˜¯ Promise çš„è¯­æ³•ç³–ï¼Œ<code>await</code>Â åé¢çš„ä»£ç æ˜¯å¾®ä»»åŠ¡</li>
<li>äº‹ä»¶å¾ªç¯ç¡®ä¿äº† JavaScript çš„å•çº¿ç¨‹èƒ½å¤Ÿå¤„ç†å¼‚æ­¥æ“ä½œ</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue 3 åš todos , ref èƒ½çœ‹æ‡‚ï¼Œcomputed ç»ˆäºä¹Ÿæ‡‚äº†]]></title>    <link>https://juejin.cn/post/7583139562751836202</link>    <guid>https://juejin.cn/post/7583139562751836202</guid>    <pubDate>2025-12-13T16:06:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583139562751836202" data-draft-id="7582857981894983721" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue 3 åš todos , ref èƒ½çœ‹æ‡‚ï¼Œcomputed ç»ˆäºä¹Ÿæ‡‚äº†"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-13T16:06:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="T___T"/> <meta itemprop="url" content="https://juejin.cn/user/1599155645973066"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue 3 åš todos , ref èƒ½çœ‹æ‡‚ï¼Œcomputed ç»ˆäºä¹Ÿæ‡‚äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1599155645973066/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    T___T
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T16:06:11.000Z" title="Sat Dec 13 2025 16:06:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åˆšå¼€å§‹å­¦ Vue 3ï¼Œçœ‹åˆ°Â <code>ref</code>ã€<code>computed</code>ã€<code>v-model</code>Â å°±æœ‰ç‚¹æ™•ä¹ä¹ã€‚</p>
<p>ä¸ºäº†ç»ƒæ‰‹ï¼Œæˆ‘æŠ„ç€æ•™ç¨‹å†™äº†ä¸€ä¸ª<strong>è¶…ç®€å•çš„å¾…åŠæ¸…å•</strong>ï¼Œ</p>
<p>ç»“æœå†™ç€å†™ç€ï¼Œå‘ç°è¿™ä¸ªå°ç©å…·åˆšå¥½èƒ½æŠŠæˆ‘æœ€ä¸ç†è§£çš„é‚£ä¸ªå®¶ä¼™â€”â€”<code>computed</code>â€”â€”è®²æ¸…æ¥šã€‚<br/>
ä¸‹é¢å°±ç”¨æˆ‘çš„è§†è§’ï¼Œæ‹†ä¸€ä¸‹è¿™ä¸ªå° demoï¼Œåˆ°åº•åœ¨å¹²å˜›ï¼Œä»¥åŠÂ <code>computed</code>Â ä¸ºä»€ä¹ˆå€¼å¾—å•æ‹¿å‡ºæ¥è¯´ã€‚</p>
<h2 data-id="heading-0">å“åº”å¼æ•°æ®ï¼š<code>ref</code>Â å¼€å±€</h2>
<p>æ ¸å¿ƒçŠ¶æ€æœ‰ä¸¤ä¸ªï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> title = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>);
<span class="hljs-keyword">const</span> todos = <span class="hljs-title function_">ref</span>([
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'æ‰“ç‹è€…'</span>, <span class="hljs-attr">done</span>: <span class="hljs-literal">true</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'åƒé¥­'</span>,   <span class="hljs-attr">done</span>: <span class="hljs-literal">true</span> }
]);
</code></pre>
<ul>
<li><strong><code>title</code></strong><br/>
è¾“å…¥æ¡†å½“å‰å†…å®¹ï¼ŒåŒå‘ç»‘å®šåœ¨è¾“å…¥æ¡†ä¸Šã€‚</li>
<li><strong><code>todos</code></strong><br/>
ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸€é¡¹æ˜¯ä¸€ä¸ªå¾…åŠå¯¹è±¡ï¼š<code>id</code>ã€<code>title</code>ã€<code>done</code>ã€‚</li>
</ul>
<p>åœ¨æ¨¡æ¿é‡Œé€šè¿‡Â <code>v-model</code>ã€<code>v-for</code>ã€<code>v-if</code>Â ç­‰å°±èƒ½æŠŠè¿™äº›æ•°æ®â€œé•¿â€æˆç•Œé¢ã€‚</p>
<hr/>
<h2 data-id="heading-1">æ¨¡æ¿æ€ä¹ˆæŠŠæ•°æ®â€œé•¿â€å‡ºæ¥ï¼Ÿ</h2>
<p>å‡ ä¸ªå…³é”®ç‚¹ï¼š</p>
<ul>
<li>
<p><strong>è¾“å…¥æ¡†åŒå‘ç»‘å®š</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"title"</span> @<span class="hljs-attr">keydown.enter</span>=<span class="hljs-string">"addTodo"</span>&gt;</span>
</code></pre>
<ul>
<li><code>v-model="title"</code>ï¼šè¾“å…¥çš„å†…å®¹è‡ªåŠ¨åŒæ­¥åˆ°Â <code>title</code>ã€‚</li>
<li>keydown.enter="addTodo"ï¼šæŒ‰ä¸‹å›è½¦ï¼Œå°±è°ƒç”¨Â addTodoÂ æ–°å¢å¾…åŠã€‚</li>
</ul>
</li>
<li>
<p><strong>åˆ—è¡¨å¾ªç¯ + å‹¾é€‰çŠ¶æ€</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"todos.length"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"todo in todos"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"todo.id"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"todo.done"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ done: todo.done }"</span>&gt;</span>{{ todo.title }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-else</span>&gt;</span>æš‚æ— å¾…åŠäº‹é¡¹<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<ul>
<li><code>v-for</code>Â è´Ÿè´£æŠŠæ•°ç»„â€œæ‘Šå¼€â€æˆä¸€ä¸ªä¸ªÂ <code>li</code>ã€‚</li>
<li>æ¯æ¡çš„å¤é€‰æ¡†ç”¨Â <code>v-model="todo.done"</code>ï¼Œç›´æ¥åŒå‘ç»‘å®šå®ŒæˆçŠ¶æ€ã€‚</li>
<li><code>:class="{ done: todo.done }"</code>Â å†³å®šè¦ä¸è¦åŠ ä¸ŠÂ <code>.done</code>Â è¿™ä¸ªç±»ï¼Œå®ç°ä¸­åˆ’çº¿Â + ç°è‰²ã€‚</li>
</ul>
</li>
</ul>
<p>æ ·å¼å°±æ˜¯å¾ˆç®€å•çš„ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.done</span> {
  <span class="hljs-attribute">text-decoration</span>: line-through;
  <span class="hljs-attribute">color</span>: gray;
}
</code></pre>
<h2 data-id="heading-2">æ–°å¢å¾…åŠï¼šä¸€ä¸ªå°å°çš„Â addTodo</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">addTodo</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (!title.<span class="hljs-property">value</span>) <span class="hljs-keyword">return</span>;
  todos.<span class="hljs-property">value</span>.<span class="hljs-title function_">push</span>({
    <span class="hljs-attr">id</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>(),
    <span class="hljs-attr">title</span>: title.<span class="hljs-property">value</span>,
    <span class="hljs-attr">done</span>: <span class="hljs-literal">false</span>
  });
  title.<span class="hljs-property">value</span> = <span class="hljs-string">''</span>;
};
</code></pre>
<ul>
<li><strong>ä¸ºç©ºå°±ä¸åŠ </strong>ï¼šç®€å•çš„æ ¡éªŒã€‚</li>
<li><strong>å¾€Â <code>todos</code>Â é‡ŒÂ <code>push</code>Â æ–°å¯¹è±¡</strong>ï¼šæ–°å¾…åŠé»˜è®¤Â <code>done: false</code>ã€‚</li>
<li><strong>æ¸…ç©ºè¾“å…¥æ¡†</strong>ï¼šä½“éªŒè‡ªç„¶ä¸€ç‚¹ã€‚</li>
</ul>
<p>è¿™é‡Œç”¨çš„æ˜¯æœ€åŸºç¡€çš„å“åº”å¼æ•°ç»„æ“ä½œï¼šä¿®æ”¹Â <code>todos.value</code>ï¼Œç•Œé¢è‡ªç„¶ä¼šè·Ÿç€æ›´æ–°ã€‚</p>
<h2 data-id="heading-3">çœŸæ­£çš„ä¸»è§’ï¼š<code>computed</code>Â è®¡ç®—æœªå®Œæˆæ•°é‡</h2>
<p>æ¥çœ‹ç»Ÿè®¡é‚£ä¸€è¡Œï¼š</p>
<pre><code class="hljs language-html" lang="html">{{ active }} / {{ todos.length }}
</code></pre>
<p>å‰é¢é‚£ä¸ªÂ <code>active</code>ï¼Œå°±æ˜¯ä¸€ä¸ªè®¡ç®—å±æ€§ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> active = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">return</span> todos.<span class="hljs-property">value</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> !todo.<span class="hljs-property">done</span>).<span class="hljs-property">length</span>;
});
</code></pre>
<p>è¿™è¡Œä»£ç ï¼Œæ ¸å¿ƒé€»è¾‘å…¶å®å°±ä¸€å¥è¯ï¼š</p>
<blockquote>
<p>æŠŠè¿˜æ²¡å®Œæˆçš„å¾…åŠç­›å‡ºæ¥ï¼Œæ•°ä¸€æ•°æœ‰å¤šå°‘æ¡ã€‚</p>
</blockquote>
<p>ä½ å¯èƒ½ä¼šé—®ï¼š<br/>
â€œé‚£æˆ‘ä¸ºå•¥ä¸å¹²è„†åœ¨æ¨¡æ¿é‡Œç›´æ¥å†™å‘¢ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-html" lang="html">{{ todos.filter(todo =&gt; !todo.done).length }} / {{ todos.length }}
</code></pre>
<p><strong>èƒ½ä¸èƒ½è¿™ä¹ˆå†™ï¼Ÿå½“ç„¶å¯ä»¥ã€‚</strong><br/>
ä½†è®¡ç®—å±æ€§æœ‰å‡ ä¸ªå¾ˆå®é™…çš„å¥½å¤„ã€‚</p>
<h2 data-id="heading-4"><code>computed</code>Â æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</h2>
<h3 data-id="heading-5">1.Â <strong>å®ƒæ˜¯â€œæ´¾ç”Ÿæ•°æ®â€çš„å®¶</strong></h3>
<p>åƒâ€œæœªå®Œæˆæ•°é‡â€è¿™ç§æ•°æ®ï¼š</p>
<ul>
<li>ä¸éœ€è¦è‡ªå·±å•ç‹¬å­˜ä¸€ä»½ï¼›</li>
<li>å®Œå…¨å¯ä»¥æ ¹æ®Â <code>todos</code>Â æ¨å¯¼å‡ºæ¥ã€‚</li>
</ul>
<p>è¿™ç§å°±å«<strong>æ´¾ç”Ÿæ•°æ®</strong>ã€‚<br/>
<code>computed</code>Â å¤©ç”Ÿå°±æ˜¯ä¸ºå®ƒä»¬å‡†å¤‡çš„ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> active = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">return</span> todos.<span class="hljs-property">value</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> !todo.<span class="hljs-property">done</span>).<span class="hljs-property">length</span>;
});
</code></pre>
<p>å¥½å¤„æ˜¯ï¼š</p>
<ul>
<li>ä»£ç ä¸€çœ¼å°±èƒ½çœ‹å‡ºï¼š<code>active</code>Â æ˜¯â€œä¾æ®Â <code>todos</code>Â è®¡ç®—å¾—æ¥â€çš„ç»“æœã€‚</li>
<li>æ¨¡æ¿é‡Œçœ‹åˆ°Â <code>{{ active }}</code>ï¼ŒåŸºæœ¬å°±èƒ½çŒœåˆ°æ„æ€ï¼Œä¸ä¼šè¢«ä¸€é•¿ä¸²è¿‡æ»¤é€»è¾‘å¹²æ‰°ã€‚</li>
</ul>
<h3 data-id="heading-6">2.Â <strong>è‡ªå¸¦ç¼“å­˜ï¼šåªåœ¨éœ€è¦çš„æ—¶å€™é‡æ–°ç®—</strong></h3>
<p>æ¨¡æ¿é‡Œçš„è¡¨è¾¾å¼ï¼Œæ¯æ¬¡æ¸²æŸ“éƒ½ä¼šé‡æ–°æ‰§è¡Œã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå†™æˆï¼š</p>
<pre><code class="hljs language-html" lang="html">{{ todos.filter(todo =&gt; !todo.done).length }}
</code></pre>
<p>åªè¦ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼ˆä¸ç®¡æ˜¯ä¸æ˜¯ becauseÂ <code>todos</code>Â å˜äº†ï¼‰ï¼Œå®ƒå°±ä¼šå†è·‘ä¸€æ¬¡Â <code>filter</code>ã€‚</p>
<p>è€ŒÂ <code>computed</code>Â åˆ™ä¸ä¸€æ ·ï¼š</p>
<ul>
<li>å®ƒä¼š<strong>è‡ªåŠ¨è¿½è¸ªä¾èµ–</strong>ï¼š<code>todos</code>Â ä»¥åŠæ¯ä¸ªÂ <code>todo.done</code>ã€‚</li>
<li>åªæœ‰å½“è¿™äº›ä¾èµ–å‘ç”Ÿå˜åŒ–æ—¶ï¼Œ<code>active</code>Â æ‰ä¼šé‡æ–°è®¡ç®—ã€‚</li>
<li>å…¶ä»–ä¸ç›¸å¹²çš„å“åº”å¼æ•°æ®ï¼ˆæ¯”å¦‚Â <code>title</code>ï¼‰å˜äº†ï¼Œå¹¶ä¸ä¼šè®©å®ƒé‡ç®—ã€‚</li>
</ul>
<p>åœ¨è¿™ä¸ªå°ä¾‹å­é‡Œï¼Œåˆ—è¡¨å¾ˆçŸ­ï¼Œå·®å¼‚ä½ æ„Ÿè§‰ä¸åˆ°ã€‚<br/>
ä½†åœ¨çœŸå®é¡¹ç›®é‡Œï¼š</p>
<ul>
<li><code>todos</code>Â å¾ˆå¤§ï¼›</li>
<li>ç»Ÿè®¡é‡Œç”¨åˆ°çš„é€»è¾‘å¤æ‚ï¼›</li>
<li>æˆ–è€…åŒä¸€ä¸ªç»Ÿè®¡åœ¨å¤šä¸ªåœ°æ–¹ç”¨åˆ°ï¼›</li>
</ul>
<p>è¿™æ—¶å€™Â <code>computed</code>Â çš„ç¼“å­˜æœºåˆ¶ï¼Œå°±èƒ½æ˜æ˜¾å‡å°‘ä¸å¿…è¦çš„é‡å¤è®¡ç®—ã€‚</p>
<h3 data-id="heading-7">3.Â <strong>æ¨¡æ¿æ›´å¹²å‡€ï¼Œé€»è¾‘é›†ä¸­åœ¨ JS é‡Œ</strong></h3>
<p>æ¨¡æ¿é‡Œå†™å¤ªå¤šé€»è¾‘ï¼Œé˜…è¯»æˆæœ¬ä¼šæ˜æ˜¾å‡é«˜ã€‚<br/>
æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæœ‰å¥½å‡ ä¸ªç»Ÿè®¡é¡¹éƒ½é•¿è¿™æ ·ï¼š</p>
<pre><code class="hljs language-html" lang="html">{{ todos.filter(t =&gt; !t.done &amp;&amp; t.priority === 'high').length }}
</code></pre>
<p>é¡¹ç›®ä¸€å¤§ï¼Œå¾ˆå¿«ä½ å°±ä¼šè®¨åŒåœ¨æ¨¡æ¿é‡Œç¿»æ¥ç¿»å»çš„å¤æ‚è¡¨è¾¾å¼ã€‚</p>
<p>æŠŠé€»è¾‘æŠ½åˆ°Â <code>computed</code>Â é‡Œï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> activeHighPriority = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span>
  todos.<span class="hljs-property">value</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">t</span> =&gt;</span> !t.<span class="hljs-property">done</span> &amp;&amp; t.<span class="hljs-property">priority</span> === <span class="hljs-string">'high'</span>).<span class="hljs-property">length</span>
);
</code></pre>
<p>æ¨¡æ¿é‡Œåªä¿ç•™ç»“æœï¼š</p>
<pre><code class="hljs language-html" lang="html">{{ activeHighPriority }}
</code></pre>
<ul>
<li>æ¨¡æ¿æ›´åƒâ€œç»“æ„ + æ–‡æ¡ˆâ€ï¼›</li>
<li>é€»è¾‘éƒ½å¾…åœ¨Â JS é‡Œï¼Œæ”¹èµ·æ¥æ›´é¡ºæ‰‹ï¼Œä¹Ÿå¥½æµ‹è¯•ã€‚</li>
</ul>
<h3 data-id="heading-8">4.Â <strong>å¤ç”¨æ–¹ä¾¿</strong></h3>
<p>å¦‚æœä½ æœ‰å¤šä¸ªåœ°æ–¹éƒ½è¦ç”¨åˆ°â€œæœªå®Œæˆæ•°é‡â€ï¼Œ<br/>
ç”¨æ¨¡æ¿è¡¨è¾¾å¼çš„è¯ï¼Œè¦æŠŠÂ <code>todos.filter(...).length</code>Â å¤åˆ¶æ¥å¤åˆ¶å»ã€‚</p>
<p><code>computed</code>Â åˆ™åªç”¨å®šä¹‰ä¸€æ¬¡ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> active = <span class="hljs-title function_">computed</span>(...);
</code></pre>
<p>æ¨¡æ¿ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥ç›´æ¥ï¼š</p>
<pre><code class="hljs language-html" lang="html">{{ active }}
</code></pre>
<p>ä»¥åæ”¹è§„åˆ™ï¼ˆæ¯”å¦‚ä¸ç»Ÿè®¡æŸäº›ç±»å‹çš„å¾…åŠï¼‰ä¹Ÿåªéœ€è¦æ”¹ä¸€å¤„é€»è¾‘ã€‚</p>
<h2 data-id="heading-9"><code>computed</code>Â çš„è¿›é˜¶ç”¨æ³•ï¼šgetÂ /Â setÂ åšâ€œå…¨é€‰â€</h2>
<p>è¿™ä¸ªä¾‹å­é‡Œè¿˜æœ‰ä¸€ä¸ªæ›´é«˜çº§ä¸€ç‚¹çš„ç”¨æ³•ï¼š**å¸¦Â **</p>
<p><strong>getÂ /Â setÂ çš„è®¡ç®—å±æ€§</strong>ï¼Œç”¨æ¥å®ç°â€œå…¨é€‰â€ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> allDone = <span class="hljs-title function_">computed</span>({
  <span class="hljs-title function_">get</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> todos.<span class="hljs-property">value</span>.<span class="hljs-title function_">every</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> todo.<span class="hljs-property">done</span>);
  },
  <span class="hljs-title function_">set</span>(<span class="hljs-params">value</span>) {
    todos.<span class="hljs-property">value</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> {
      todo.<span class="hljs-property">done</span> = value;
    });
  }
});
</code></pre>
<p>å†é…åˆæ¨¡æ¿ï¼š</p>
<pre><code class="hljs language-html" lang="html">å…¨é€‰<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"allDone"</span>&gt;</span>
</code></pre>
<p>è¿™é‡Œå‘ç”Ÿäº†å‡ ä»¶å¾ˆæœ‰æ„æ€çš„äº‹ï¼š</p>
<ul>
<li>
<hr/>
<p><strong>getï¼šä»æ•°æ®æ¨å¯¼è§†å›¾</strong></p>
<ul>
<li>æ¯å½“ç•Œé¢éœ€è¦çŸ¥é“â€œå½“å‰æ˜¯ä¸æ˜¯å…¨é€‰çŠ¶æ€â€ï¼Œå°±ä¼šè°ƒç”¨Â get()ã€‚</li>
<li><code>every(todo =&gt; todo.done)</code>Â åˆ¤æ–­æ˜¯ä¸æ˜¯æ‰€æœ‰éƒ½å®Œæˆã€‚</li>
<li>å¦‚æœå…¨éƒ¨å®Œæˆï¼Œ<code>allDone</code>Â ä¸ºÂ <code>true</code>ï¼Œå…¨é€‰æ¡†å°±è¢«å‹¾ä¸Šã€‚</li>
</ul>
</li>
<li>
<hr/>
<p><strong>setï¼šä»è§†å›¾åæ¨æ•°æ®</strong></p>
<ul>
<li>å½“ä½ ç‚¹å‡»â€œå…¨é€‰â€å¤é€‰æ¡†æ—¶ï¼Œå› ä¸ºç”¨äº†Â <code>v-model="allDone"</code>ï¼Œä¼šè§¦å‘Â set(value)ã€‚</li>
<li><code>value</code>Â æ˜¯ä½ å‹¾é€‰åçš„æ–°å€¼ï¼ˆ<code>true</code>Â /Â <code>false</code>ï¼‰ã€‚</li>
<li>setÂ é‡ŒæŠŠæ¯ä¸€æ¡Â <code>todo.done</code>Â å…¨éƒ¨æ”¹æˆè¿™ä¸ªå€¼ã€‚</li>
</ul>
</li>
</ul>
<p>è¿™ç§å†™æ³•çš„å¦™å¤„åœ¨äºï¼š</p>
<ul>
<li>
<p>æ¨¡æ¿é‡Œçœ‹èµ·æ¥å°±åƒåœ¨ç»‘ä¸€ä¸ªæ™®é€šçš„å¸ƒå°”å€¼ï¼›</p>
</li>
<li>
<p>å®é™…ä¸ŠèƒŒåæ˜¯ä¸€ä¸ªå¯ä»¥<strong>åŒå‘è”åŠ¨</strong>çš„â€œè®¡ç®—å±æ€§â€ï¼š</p>
<ul>
<li>åˆ—è¡¨çŠ¶æ€å†³å®šâ€œå…¨é€‰â€çš„å‹¾é€‰ï¼›</li>
<li>â€œå…¨é€‰â€çš„å‹¾é€‰åˆèƒ½åè¿‡æ¥æ›´æ–°åˆ—è¡¨çŠ¶æ€ã€‚</li>
</ul>
</li>
</ul>
<p>è¿™ä¹Ÿæ˜¯Â <code>computed</code>Â éå¸¸æœ‰é­…åŠ›çš„ä¸€é¢ï¼š**ä¸åªæ˜¯â€œç®—ç»“æœâ€ï¼Œè¿˜å¯ä»¥é€šè¿‡Â **</p>
<p><strong>setÂ å»â€œé©±åŠ¨æ•°æ®å˜åŒ–â€</strong> ã€‚</p>
<h2 data-id="heading-10">å°ç»“ï¼šä¸€ä¸ªå°å¾…åŠé‡Œï¼Œè£…ç€ Vue çš„å‡ ä¸ªæ ¸å¿ƒä¹ æƒ¯</h2>
<p>è¿™ä¸ªå°ä¾‹å­é‡Œï¼Œå…¶å®å°±ä½“ç°äº†å‡ ä¸ªå¾ˆå€¼å¾—å…»æˆçš„ç¼–ç ä¹ æƒ¯ï¼š</p>
<ul>
<li><strong>çŠ¶æ€é›†ä¸­åœ¨Â <code>ref</code>Â / å“åº”å¼å¯¹è±¡é‡Œç®¡ç†</strong><br/>
<code>title</code>ã€<code>todos</code>Â è¿™æ ·ä¸€çœ¼æ˜äº†ã€‚</li>
<li><strong>æ¨¡æ¿åªåšè½»é‡é€»è¾‘ï¼Œå¤æ‚é€»è¾‘äº¤ç»™Â <code>computed</code>Â / å‡½æ•°</strong><br/>
æœªå®Œæˆæ•°é‡ç”¨Â <code>computed</code>ï¼Œè€Œä¸æ˜¯é•¿é•¿çš„ä¸€ä¸²æ¨¡æ¿è¡¨è¾¾å¼ã€‚</li>
<li><strong>æŠŠâ€œæ´¾ç”Ÿæ•°æ®â€éƒ½å¡è¿›Â <code>computed</code></strong><br/>
æ—¢æ¸…æ™°åˆæœ‰ç¼“å­˜ï¼Œé‡ä¸€å¤§å°±çŸ¥é“å¥½å¤„ã€‚</li>
<li><strong>ç”¨å¸¦Â <code>get/set</code>Â çš„Â <code>computed</code>Â å®ç°æ›´è‡ªç„¶çš„åŒå‘ç»‘å®š</strong><br/>
æ¯”å¦‚â€œå…¨é€‰â€è¿™ç§ï¼ŒåŒæ—¶ä¾èµ–å’Œå½±å“å…¶ä»–çŠ¶æ€çš„å­—æ®µã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±åº¦å¤ç›˜ IIIï¼š æ ¸å¿ƒé€»è¾‘ç¯‡ï¼šæ„å»º WebGL æ•°å­—å­ªç”Ÿçš„â€œä¸šåŠ¡ä¸­æ¢â€ä¸â€œå®‰å…¨é˜²çº¿â€]]></title>    <link>https://juejin.cn/post/7582879379442909227</link>    <guid>https://juejin.cn/post/7582879379442909227</guid>    <pubDate>2025-12-13T23:40:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582879379442909227" data-draft-id="7582879379442892843" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±åº¦å¤ç›˜ IIIï¼š æ ¸å¿ƒé€»è¾‘ç¯‡ï¼šæ„å»º WebGL æ•°å­—å­ªç”Ÿçš„â€œä¸šåŠ¡ä¸­æ¢â€ä¸â€œå®‰å…¨é˜²çº¿â€"/> <meta itemprop="keywords" content="three.js,WebGL"/> <meta itemprop="datePublished" content="2025-12-13T23:40:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Addisonx"/> <meta itemprop="url" content="https://juejin.cn/user/3651905710195595"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±åº¦å¤ç›˜ IIIï¼š æ ¸å¿ƒé€»è¾‘ç¯‡ï¼šæ„å»º WebGL æ•°å­—å­ªç”Ÿçš„â€œä¸šåŠ¡ä¸­æ¢â€ä¸â€œå®‰å…¨é˜²çº¿â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3651905710195595/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Addisonx
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T23:40:28.000Z" title="Sat Dec 13 2025 23:40:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸš€ å‰è¨€</h2>
<p>åœ¨ Z-TWIN æ±¡æ°´å¤„ç†å‚é¡¹ç›®çš„å‰ä¸¤ç¯‡å¤ç›˜ä¸­ï¼Œæˆ‘ä»¬è§£å†³äº† <strong>æ¸²æŸ“ç®¡çº¿ï¼ˆRendering Pipelineï¼‰</strong> çš„æ€§èƒ½ç“¶é¢ˆä¸ <strong>HMI å·¥ç¨‹åŒ–</strong> çš„å¤šç«¯é€‚é…é—®é¢˜ã€‚è¿™ä¸¤æ­¥èµ°å®Œï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªâ€œå¥½çœ‹â€ä¸”â€œèƒ½è·‘â€çš„ç³»ç»Ÿéª¨æ¶ã€‚</p>
<p>ç„¶è€Œï¼Œä» <strong>POCï¼ˆæ¦‚å¿µéªŒè¯ï¼‰</strong> èµ°å‘ <strong>Productionï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰</strong> çš„è¿‡ç¨‹ä¸­ï¼ŒçœŸæ­£çš„æŒ‘æˆ˜åœ¨äºå¦‚ä½•è®©è¿™å¥— 3D ç³»ç»Ÿæ‰¿è½½å¤æ‚çš„å·¥ä¸šä¸šåŠ¡ã€‚åœ¨å®é™…å·¥ç¨‹äº¤ä»˜ä¸­ï¼Œæˆ‘ä»¬æ·±çŸ¥ï¼š<strong>è§†è§‰åªæ˜¯è¡¨å±‚ï¼Œé€»è¾‘æ‰æ˜¯éª¨æ¶ã€‚</strong> ä¸€ä¸ªåˆæ ¼çš„å·¥ä¸šçº§æ•°å­—å­ªç”Ÿç³»ç»Ÿï¼Œå¿…é¡»å…·å¤‡æä½çš„æ“ä½œé—¨æ§›ã€ç»å¯¹çš„å®‰å…¨æ§åˆ¶æœºåˆ¶ä»¥åŠæ·±åº¦çš„æ•°æ®è¿½æº¯èƒ½åŠ›ã€‚</p>
<p>æœ¬æ–‡å°†å‰¥ç¦»è¡¨é¢çš„è§†è§‰ç‰¹æ•ˆï¼Œæ·±å…¥æºç çš„ <strong>HTML/CSS/JS é“ä¸‰è§’</strong>ï¼Œå¤ç›˜æˆ‘ä»¬åœ¨ <strong>äº¤äº’çº¦æŸä½“ç³»</strong>ã€<strong>å·¥ä¸šæ§åˆ¶åè®®</strong> ä»¥åŠ <strong>æ—¶ç©ºæ•°æ®æ¶æ„</strong> ä¸­çš„æ ¸å¿ƒè®¾è®¡å†³ç­–ã€‚</p>
<hr/>
<h2 data-id="heading-1">ğŸ§­ ä¸€ã€ äº¤äº’è®¾è®¡çš„è¾©è¯ï¼šåŸºäºâ€œç‰©ç†çº¦æŸâ€çš„å·¡æ£€é€»è¾‘</h2>
<p>åœ¨ Web 3D å¼€å‘åˆæœŸï¼Œä¸ºäº†å±•ç¤ºæŠ€æœ¯èƒ½åŠ›ï¼Œå¼€å‘è€…å¸¸é€šè¿‡ <code>OrbitControls</code> ç»™äºˆç”¨æˆ·æ— é™çš„è‡ªç”±åº¦ã€‚ä½†åœ¨é«˜å‹åŠ›çš„å·¥ä¸šè¿ç»´åœºæ™¯ä¸‹ï¼Œè¿‡åº¦çš„è‡ªç”±å¾€å¾€å¯¼è‡´æ“ä½œè¿·å¤±ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸€ç—›ç‚¹ï¼Œæˆ‘ä»¬é€šè¿‡ä»£ç æ„å»ºäº†ä¸€å¥—**â€œå¸¦é˜»å°¼çš„ç¬¬ä¸€äººç§°å·¡æ£€æ¨¡å¼â€**ã€‚æˆ‘ä»¬è®¤ä¸ºï¼Œé€‚åº¦çš„çº¦æŸèƒ½æ˜¾è‘—é™ä½è®¤çŸ¥è´Ÿè·ã€‚</p>
<h3 data-id="heading-2">1. HTMLï¼šè¯­ä¹‰åŒ–çš„å¼•å¯¼ç»“æ„</h3>
<p>æˆ‘ä»¬åœ¨ç³»ç»Ÿå…¥å£å¤„é¢„ç½®äº†å¼ºåˆ¶å¼•å¯¼å±‚ï¼Œç”¨äºå»ºç«‹ç”¨æˆ·çš„å¿ƒç†æ¨¡å‹ï¼Œæ˜ç¡®æ“ä½œé€»è¾‘ã€‚</p>
<p><em>æ–‡ä»¶ï¼šindex.html (éƒ¨åˆ†æ ¸å¿ƒç»“æ„)</em></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"welcome-guide"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"welcome-overlay"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"keyboard-grid"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- æ¨¡æ‹Ÿç‰©ç†æ§åˆ¶å°çš„é”®ä½æ˜ å°„ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"keyboard-key"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"key-cap"</span>&gt;</span>W<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>æ¨è¿›<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"keyboard-key"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"key-cap"</span>&gt;</span>S<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>é€€è¡Œ<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"keyboard-key"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"key-cap wide"</span>&gt;</span>Shift<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>å·¡æ£€åŠ é€Ÿ<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<h3 data-id="heading-3">2. JSï¼šåŸºäºå‘é‡çš„ç‰©ç†è¿åŠ¨é€»è¾‘</h3>
<p>åœ¨é€»è¾‘å±‚ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ç®€å•åœ°ä¿®æ”¹ç›¸æœºåæ ‡ï¼Œè€Œæ˜¯å¼•å…¥äº†<strong>é€Ÿåº¦å‘é‡</strong>ä¸<strong>é˜»å°¼ç³»æ•°</strong>ã€‚è¿™ç§å¤„ç†æ–¹å¼æ¨¡æ‹Ÿäº†çœŸå®çš„äººä½“è¿åŠ¨æƒ¯æ€§ï¼Œæ¶ˆé™¤äº†ç”»é¢æ€¥åœæ€¥è½¬å¸¦æ¥çš„çœ©æ™•æ„Ÿã€‚</p>
<p><em>æ–‡ä»¶ï¼šlogic/PlayerController.js (ç‰©ç†è®¡ç®—æ ¸å¿ƒé€»è¾‘)</em></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">updateCamera</span>(<span class="hljs-params">delta</span>) {
    <span class="hljs-comment">// 1. æ ¹æ®æŒ‰é”®è¾“å…¥è®¡ç®—åŠ é€Ÿåº¦ (Acceleration)</span>
    <span class="hljs-keyword">const</span> acceleration = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Vector3</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">if</span> (inputState.<span class="hljs-property">moveForward</span>) acceleration.<span class="hljs-property">z</span> -= <span class="hljs-number">1.0</span>;
    <span class="hljs-keyword">if</span> (inputState.<span class="hljs-property">moveBackward</span>) acceleration.<span class="hljs-property">z</span> += <span class="hljs-number">1.0</span>;
    
    <span class="hljs-comment">// 2. åº”ç”¨é€Ÿåº¦ä¸é˜»å°¼ (Velocity &amp; Damping)</span>
    velocity.<span class="hljs-title function_">add</span>(acceleration.<span class="hljs-title function_">multiplyScalar</span>(delta * params.<span class="hljs-property">speed</span>));
    velocity.<span class="hljs-title function_">multiplyScalar</span>(<span class="hljs-number">1.0</span> - params.<span class="hljs-property">damping</span> * delta); 
    
    <span class="hljs-comment">// 3. ç¢°æ’æ£€æµ‹ä¸ä½ç½®æ›´æ–° (Collision &amp; Update)</span>
    <span class="hljs-keyword">const</span> nextPosition = camera.<span class="hljs-property">position</span>.<span class="hljs-title function_">clone</span>().<span class="hljs-title function_">add</span>(velocity);
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">checkWallCollision</span>(nextPosition)) {
        camera.<span class="hljs-property">position</span>.<span class="hljs-title function_">copy</span>(nextPosition);
    }
    
    <span class="hljs-comment">// 4. å¼ºåˆ¶é«˜åº¦é”å®š (æ¨¡æ‹Ÿäººçœ¼é«˜åº¦ 1.7m)</span>
    camera.<span class="hljs-property">position</span>.<span class="hljs-property">y</span> = <span class="hljs-number">1.7</span>; 
}
</code></pre>
<p><strong>è®¾è®¡æ€è€ƒ</strong>ï¼š
è¿™ç§â€œé™ç»´â€è®¾è®¡è¿«ä½¿ç”¨æˆ·æ”¾å¼ƒå®¹æ˜“è¿·å¤±çš„ä¸Šå¸è§†è§’ï¼Œä¸“æ³¨äºå¹³è§†çš„è®¾å¤‡çŠ¶æ€å·¡æ£€ï¼Œæ˜¾è‘—é™ä½äº†éæŠ€æœ¯äººå‘˜ï¼ˆå¦‚ç°åœºè€å¸ˆå‚…ï¼‰çš„å­¦ä¹ æˆæœ¬ã€‚</p>
<hr/>
<h2 data-id="heading-4">ğŸ”’ äºŒã€ å·¥ä¸šå®‰å…¨é”ï¼šæ„å»ºâ€œä¸‰æ­¥æ¡æ‰‹â€æ§åˆ¶é—­ç¯</h2>
<p>æ•°å­—å­ªç”Ÿçš„æ·±æ°´åŒºæ˜¯<strong>åå‘æ§åˆ¶</strong>ï¼ˆReverse Controlï¼‰ã€‚åœ¨å·¥ä¸šç°åœºï¼Œå‰ç«¯çš„ä¸€æ¬¡è¯¯è§¦å¯èƒ½å¯¼è‡´ä¸¥é‡çš„ç”Ÿäº§äº‹æ•…ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åšå†³æ‘’å¼ƒäº†â€œç‚¹å‡» 3D æ¨¡å‹ç›´æ¥è§¦å‘ APIâ€çš„çŸ­è·¯é€»è¾‘ï¼Œæ„å»ºäº†ä¸€å¥—ä¸¥å¯†çš„ <strong>UI æ‹¦æˆªæœºåˆ¶</strong>ã€‚</p>
<h3 data-id="heading-5">1. HTMLï¼šç‹¬ç«‹çš„ç‰©ç†æ‹¦æˆªå±‚</h3>
<p>æˆ‘ä»¬åœ¨ <code>index.html</code> ä¸­é¢„åŸ‹äº†ä¸€ä¸ªæ¨¡æ€æ¡†ï¼Œåˆ©ç”¨ DOM å±‚çº§é®æŒ¡ Canvasï¼Œå®ç°äº†äº¤äº’ä¸Šçš„ç‰©ç†éš”ç¦»ã€‚</p>
<p><em>æ–‡ä»¶ï¼šindex.html (å®‰å…¨ç¡®è®¤å¼¹çª—ç»“æ„)</em></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"confirm-dialog"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"confirm-dialog hidden"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"confirm-card"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>ç¡®è®¤æ“ä½œ<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è¯¥æ“ä½œå°†å®æ—¶ä¸‹å‘è‡³ PLC æ§åˆ¶æŸœï¼Œè¯·ç¡®è®¤ï¼<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"confirm-device"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"label"</span>&gt;</span>è®¾å¤‡ID:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"value"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"confirm-device-name"</span>&gt;</span>--<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"confirm-ok-btn"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ok-btn"</span>&gt;</span>æ‰§è¡Œå¯åŠ¨<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<h3 data-id="heading-6">2. JSï¼šä¸¥æ ¼çš„â€œä¸‰æ­¥æ¡æ‰‹â€åè®®</h3>
<p>åœ¨é€»è¾‘å±‚ï¼Œæˆ‘ä»¬å®ç°äº†<strong>å±•ç¤ºä¸æ§åˆ¶çš„å®Œå…¨è§£è€¦</strong>ï¼Œå¹¶åšæŒ<strong>çŠ¶æ€é©±åŠ¨</strong>åŸåˆ™ã€‚åªæœ‰ç‰©ç†ä¸–ç•Œçš„è®¾å¤‡çœŸæ­£å“åº”äº†ï¼Œæ•°å­—å­ªç”Ÿä¸­çš„çŠ¶æ€æ‰ä¼šéšä¹‹æ”¹å˜ã€‚</p>
<p><em>æ–‡ä»¶ï¼šlogic/InteractionManager.js (æŒ‡ä»¤æµé€»è¾‘)</em></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç¬¬ä¸€æ­¥ï¼šæ‹¾å–ä¸æ‹¦æˆª (Pick &amp; Intercept)</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">onDeviceClick</span>(<span class="hljs-params">deviceMesh</span>) {
    <span class="hljs-comment">// ä»…å¼¹å‡ºé¢æ¿ï¼Œç»ä¸ç›´æ¥å‘é€æŒ‡ä»¤</span>
    <span class="hljs-title function_">showPropertyPanel</span>(deviceMesh.<span class="hljs-property">userData</span>);
}

<span class="hljs-comment">// ç¬¬äºŒæ­¥ï¼šUI æ¡æ‰‹ (Handshake)</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'panel-start-btn'</span>).<span class="hljs-property">onclick</span> = <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// æŒ‚èµ· 3D äº¤äº’ï¼Œå¼¹å‡ºå…¨å±é®ç½©</span>
    controls.<span class="hljs-property">enabled</span> = <span class="hljs-literal">false</span>; 
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'confirm-dialog'</span>).<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">'hidden'</span>);
};

<span class="hljs-comment">// ç¬¬ä¸‰æ­¥ï¼šæ‰§è¡Œä¸çŠ¶æ€å›æ˜¾ (Execute &amp; Feedback)</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'confirm-ok-btn'</span>).<span class="hljs-property">onclick</span> = <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> deviceId = currentSelection.<span class="hljs-property">id</span>;
    
    <span class="hljs-comment">// å‘é€æŒ‡ä»¤ (UI è¿›å…¥ Loading æ€)</span>
    <span class="hljs-title function_">setButtonLoading</span>(<span class="hljs-literal">true</span>);
    <span class="hljs-keyword">await</span> mqttClient.<span class="hljs-title function_">publish</span>(<span class="hljs-string">`device/<span class="hljs-subst">${deviceId}</span>/control`</span>, <span class="hljs-string">'START'</span>);
    
    <span class="hljs-comment">// æ³¨æ„ï¼šæ­¤å¤„ç»ä¸ä¿®æ”¹æ¨¡å‹é¢œè‰²ï¼</span>
    <span class="hljs-comment">// æ¨¡å‹é¢œè‰²çš„å˜æ›´ï¼Œä¸¥æ ¼ç­‰å¾…åç«¯ WebSocket çš„çŠ¶æ€æ¨é€</span>
};

<span class="hljs-comment">// ç¬¬å››æ­¥ï¼šæ•°æ®é©±åŠ¨è§†å›¾ (Data Driven)</span>
socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">'device_status_change'</span>, <span class="hljs-function">(<span class="hljs-params">msg</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (msg.<span class="hljs-property">id</span> === deviceId &amp;&amp; msg.<span class="hljs-property">status</span> === <span class="hljs-string">'RUNNING'</span>) {
        <span class="hljs-comment">// åªæœ‰æ”¶åˆ°ç‰©ç†ä¸–ç•Œçš„ç¡®è®¤ï¼Œæ•°å­—ä¸–ç•Œæ‰éšä¹‹æ”¹å˜</span>
        targetMesh.<span class="hljs-property">material</span>.<span class="hljs-property">color</span>.<span class="hljs-title function_">setHex</span>(<span class="hljs-number">0x00FF00</span>); 
    }
});
</code></pre>
<p><strong>è®¾è®¡æ€è€ƒ</strong>ï¼š
å±å¹•ä¸Šçš„ç»¿è‰²ï¼Œå¿…é¡»ä»£è¡¨ç‰©ç†æ°´æ³µçœŸçš„è½¬èµ·æ¥äº†ï¼Œè€Œä¸æ˜¯ä»£è¡¨ç”¨æˆ·ç‚¹å‡»äº†æŒ‰é’®ã€‚è¿™ç§<strong>é—­ç¯ç¡®è®¤æœºåˆ¶</strong>æ˜¯å·¥ä¸šè½¯ä»¶å¯ä¿¡åº¦çš„åŸºçŸ³ã€‚</p>
<hr/>
<h2 data-id="heading-7">â³ ä¸‰ã€ æ•°æ®æ¶æ„çš„å‡ç»´ï¼šä»â€œçŠ¶æ€ç›‘è§†â€åˆ°â€œæ—¶ç©ºæ¨æ¼”â€</h2>
<p>ä¼ ç»Ÿçš„ç›‘æ§å¤§å±é€šå¸¸åªå±•ç¤º <code>Current State</code>ï¼ˆå½“å‰å€¼ï¼‰ã€‚ä½†åœ¨æ•…éšœæ’æŸ¥ï¼ˆRCAï¼‰åœºæ™¯ä¸­ï¼Œ**â€œè¿‡å»å‘ç”Ÿäº†ä»€ä¹ˆâ€<strong>å¾€å¾€æ¯”</strong>â€œç°åœ¨æ˜¯ä»€ä¹ˆâ€**æ›´æœ‰ä»·å€¼ã€‚æˆ‘ä»¬é€šè¿‡ä¸€å¥—åŒæ¨¡æ€æ¶æ„ï¼Œèµ‹äºˆäº†ç³»ç»Ÿâ€œæ—¶ç©ºç©¿æ¢­â€çš„èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-8">1. HTML/CSSï¼šæ—¶é—´è½´ç»„ä»¶</h3>
<p>æˆ‘ä»¬åœ¨æ§åˆ¶é¢æ¿ä¸­é›†æˆäº†ä¸€ä¸ªæ—¶é—´è½´ç»„ä»¶ï¼Œé€šè¿‡ CSS æ ·å¼æ˜ç¡®åŒºåˆ†å½“å‰ç³»ç»Ÿçš„è¿è¡Œæ¨¡å¼ã€‚</p>
<p><em>æ–‡ä»¶ï¼šindex.html (éƒ¨åˆ†ç»“æ„)</em></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"replay-controls"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"replay-play-btn"</span>&gt;</span>â¸<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- æ ¸å¿ƒç»„ä»¶ï¼šè¿›åº¦æ¡ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"range"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"replay-slider"</span> <span class="hljs-attr">min</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">max</span>=<span class="hljs-string">"100"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"100"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p><em>æ–‡ä»¶ï¼šcss/panels.css (çŠ¶æ€æ ·å¼)</em></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* å®æ—¶æ¨¡å¼ä¸ºè“è‰² */</span>
<span class="hljs-selector-class">.replay-controls</span> <span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[type=<span class="hljs-string">"range"</span>]</span> {
    accent-<span class="hljs-attribute">color</span>: <span class="hljs-built_in">var</span>(--color-primary); 
}
<span class="hljs-comment">/* å›æ”¾æ¨¡å¼å˜é»„ï¼Œè­¦ç¤ºç”¨æˆ·æ•°æ®éå®æ—¶ */</span>
<span class="hljs-selector-class">.replay-mode</span> <span class="hljs-selector-class">.replay-controls</span> <span class="hljs-selector-tag">input</span><span class="hljs-selector-attr">[type=<span class="hljs-string">"range"</span>]</span> {
    accent-<span class="hljs-attribute">color</span>: <span class="hljs-built_in">var</span>(--color-warning); 
}
</code></pre>
<h3 data-id="heading-9">2. JSï¼šåŒæ¨¡æ€æ•°æ®æµæ¶æ„</h3>
<p>åœ¨ <code>DataManager.js</code> ä¸­ï¼Œæˆ‘ä»¬é‡æ„äº†æ•°æ®æ¶ˆè´¹é€»è¾‘ï¼Œæ”¯æŒåœ¨<strong>å®æ—¶æµ</strong>ä¸<strong>å†å²å¿«ç…§</strong>ä¹‹é—´æ— ç¼åˆ‡æ¢ã€‚</p>
<p><em>æ–‡ä»¶ï¼šdata/DataManager.js (æ¨¡å¼åˆ‡æ¢é€»è¾‘)</em></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">let</span> isReplayMode = <span class="hljs-literal">false</span>;

<span class="hljs-comment">// ç›‘å¬æ»‘å—æ‹–åŠ¨</span>
slider.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'input'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> value = <span class="hljs-built_in">parseInt</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>);
    
    <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">100</span>) {
        <span class="hljs-comment">// è¿›å…¥å›æ”¾æ¨¡å¼</span>
        isReplayMode = <span class="hljs-literal">true</span>;
        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">'replay-mode'</span>);
        <span class="hljs-comment">// æš‚åœå®æ—¶ WebSocket å¤„ç†ï¼Œé˜²æ­¢æ•°æ®æ±¡æŸ“</span>
        socketManager.<span class="hljs-title function_">pause</span>(); 
        <span class="hljs-comment">// ä» IndexedDB è¯»å–å†å²å¿«ç…§å¹¶æ’å€¼æ¸²æŸ“</span>
        <span class="hljs-title function_">renderHistoricalFrame</span>(value); 
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// å›åˆ°å®æ—¶æ¨¡å¼</span>
        isReplayMode = <span class="hljs-literal">false</span>;
        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">'replay-mode'</span>);
        socketManager.<span class="hljs-title function_">resume</span>();
        <span class="hljs-comment">// è¿½èµ¶æœ€æ–°çŠ¶æ€</span>
        <span class="hljs-title function_">syncLatestState</span>();
    }
});

<span class="hljs-keyword">function</span> <span class="hljs-title function_">renderHistoricalFrame</span>(<span class="hljs-params">timePercent</span>) {
    <span class="hljs-comment">// çº¿æ€§æ’å€¼ç®—æ³• (Lerp) è®¡ç®—å†å²çŠ¶æ€ï¼Œä¿è¯åŠ¨ç”»å¹³æ»‘</span>
    <span class="hljs-keyword">const</span> snapshot = timeSeriesDB.<span class="hljs-title function_">getSnapshotAt</span>(timePercent);
    sceneGraph.<span class="hljs-title function_">updateFromData</span>(snapshot);
}
</code></pre>
<p><strong>è®¾è®¡æ€è€ƒ</strong>ï¼š
è¿™ä¸€æ¶æ„å°†æ•°å­—å­ªç”Ÿä»å•çº¯çš„â€œç›‘è§†å™¨â€å‡çº§ä¸ºâ€œæ•…éšœæ¨æ¼”æœºâ€ï¼Œè¿ç»´äººå‘˜å¯ä»¥åƒçœ‹è§†é¢‘ä¸€æ ·å›æº¯äº‹æ•…ç°åœºï¼Œæå¤§æå‡äº†ç³»ç»Ÿçš„ä¸šåŠ¡ä»·å€¼ã€‚</p>
<hr/>
<h2 data-id="heading-10">ğŸ”­ å››ã€ æ¼”è¿›ä¸å±•æœ›ï¼šä¸‹ä¸€ä»£æŠ€æœ¯å¸ƒå±€</h2>
<p>è™½ç„¶ç›®å‰çš„æ¶æ„å·²æ»¡è¶³äº¤ä»˜æ ‡å‡†ï¼Œä½†é¢å¯¹æ—¥ç›Šå¤æ‚çš„å·¥ä¸šåœºæ™¯ï¼Œæˆ‘ä»¬æ­£åœ¨æ¢ç´¢æ›´å‰æ²¿çš„æŠ€æœ¯è¾¹ç•Œï¼š</p>
<ol>
<li>
<p><strong>è®¡ç®—æ€§èƒ½ï¼šWebAssembly &amp; WebGPU</strong>
ç›®å‰çš„æ¶æ„å—é™äº JS å•çº¿ç¨‹ã€‚æˆ‘ä»¬æ­£åœ¨å°è¯•å¼•å…¥ <strong>WebAssembly</strong> å¤„ç†å¤æ‚çš„æµä½“ç‰©ç†è®¡ç®—ï¼Œå¹¶å°†å¤§è§„æ¨¡ç²’å­ç³»ç»Ÿè¿ç§»è‡³ <strong>WebGPU Compute Shader</strong>ï¼Œä»¥é‡Šæ”¾ CPU æ€§èƒ½ï¼Œæ”¯æŒæ›´å¤§è§„æ¨¡çš„åœºæ™¯ã€‚</p>
</li>
<li>
<p><strong>æ™ºèƒ½è¾…åŠ©ï¼šAI Agent é›†æˆ</strong>
ç»“åˆ LLMï¼Œæœªæ¥çš„äº¤äº’å°†ä¸å†å±€é™äºç‚¹å‡»ã€‚æ“ä½œå‘˜å¯ä»¥è¯´â€œé«˜äº®æ˜¾ç¤ºæ‰€æœ‰æ¸©åº¦å¼‚å¸¸çš„æœºæŸœâ€ï¼Œå‰ç«¯ <strong>AI Agent</strong> è‡ªåŠ¨è§£æè¯­ä¹‰ã€è°ƒç”¨ 3D API å¹¶è§„åˆ’æ¼«æ¸¸è·¯å¾„ï¼Œå®ç°çœŸæ­£çš„æ™ºèƒ½è¾…åŠ©ã€‚</p>
</li>
<li>
<p><strong>ç«¯äº‘ååŒï¼šPixel Streaming</strong>
é’ˆå¯¹è€æ—§çš„ç§»åŠ¨ç»ˆç«¯ï¼Œæˆ‘ä»¬æµ‹è¯•å¼•å…¥ <strong>Pixel Streamingï¼ˆåƒç´ æµé€ï¼‰</strong> æŠ€æœ¯ã€‚å°†é«˜ä¿çœŸæ¸²æŸ“å¸è½½è‡³äº‘ç«¯ï¼Œå‰ç«¯ä»…ä½œä¸ºè§†é¢‘æµæ¥æ”¶ç«¯ï¼Œåœ¨ iPad ä¸Šå®ç°ç”µå½±çº§çš„ç”»è´¨ä½“éªŒã€‚</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-11">ğŸ¤ äº”ã€ æŠ€æœ¯æ¢è®¨ä¸è½åœ°</h2>
<p>å·¥ä¸šçº§ Web 3D å¼€å‘æ˜¯ä¸€é¡¹å¤æ‚çš„ç³»ç»Ÿå·¥ç¨‹ï¼Œä»æ¨¡å‹èµ„äº§ã€æ¸²æŸ“ä¼˜åŒ–åˆ°ä¸šåŠ¡é€»è¾‘é—­ç¯ï¼Œæ¯ä¸€ä¸ªç¯èŠ‚éƒ½éœ€è¦ç²¾ç»†æ‰“ç£¨ã€‚</p>
<p>æˆ‘ä»¬å›¢é˜Ÿåœ¨å®æˆ˜ä¸­æ²‰æ·€äº†è¿™å¥—<strong>å…¨é“¾è·¯è§£å†³æ–¹æ¡ˆ</strong>ã€‚æˆ‘ä»¬éå¸¸ä¹æ„ä¸åŒè¡Œæˆ–æœ‰éœ€æ±‚çš„æœ‹å‹è¿›è¡Œ<strong>æ·±åº¦äº¤æµ</strong>ã€‚</p>
<p><strong>å¦‚æœæ‚¨æ­£é¢ä¸´ä»¥ä¸‹åœºæ™¯ï¼Œæ¬¢è¿æ²Ÿé€šï¼š</strong></p>
<ol>
<li><strong>ä¸šåŠ¡å›¢é˜Ÿäº’è¡¥</strong>ï¼šæ‹¥æœ‰æ·±åšçš„åç«¯/å·¥ä¸šåè®®ç§¯ç´¯ï¼Œä½†æ€¥éœ€ä¸€æ”¯èƒ½æ‰“ç¡¬ä»—çš„ 3D å‰ç«¯å›¢é˜Ÿã€‚</li>
<li><strong>é¡¹ç›®é›†æˆåˆä½œ</strong>ï¼šæ‰‹å¤´æœ‰æ™ºæ…§åŸå¸‚ã€æ™ºæ…§å·¥å‚æˆ– IDC å¯è§†åŒ–é¡¹ç›®ï¼Œéœ€è¦é›†æˆé«˜æ€§èƒ½çš„ Web 3D æ¨¡å—ã€‚</li>
<li><strong>æŠ€æœ¯ç“¶é¢ˆçªç ´</strong>ï¼šç°æœ‰çš„ 3D åœºæ™¯å¡é¡¿ã€äº¤äº’æ··ä¹±æˆ–æ•ˆæœä¸è¾¾æ ‡ï¼Œå¯»æ±‚ä¼˜åŒ–æ–¹æ¡ˆã€‚</li>
</ol>
<p><strong>åœ¨çº¿æ¼”ç¤ºç¯å¢ƒ</strong>ï¼š
ğŸ‘‰ <a href="https://link.juejin.cn?target=http%3A%2F%2Fwww.byzt.net%3A70%2F" target="_blank" title="http://www.byzt.net:70/" ref="nofollow noopener noreferrer">www.byzt.net:70/</a>
<em>(æ³¨ï¼šå»ºè®®ä½¿ç”¨ PC ç«¯ Chrome è®¿é—®ä»¥è·å¾—æœ€ä½³ä½“éªŒ)</em></p>
<p>ä¸ç®¡æ˜¯<strong>æŠ€æœ¯æ¢è®¨</strong>ã€<strong>æºç å’¨è¯¢</strong>è¿˜æ˜¯<strong>é¡¹ç›®åä½œ</strong>ï¼Œéƒ½æ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€æˆ–ç‚¹å‡»å¤´åƒç§ä¿¡ï¼Œäº¤ä¸ªæœ‹å‹ï¼Œå…±åŒè¿›æ­¥ã€‚</p>
<hr/>
<blockquote>
<p><strong>å£°æ˜</strong>ï¼šæœ¬æ–‡æ ¸å¿ƒä»£ç ä¸æ¶æ„æ€è·¯å‡ä¸ºåŸåˆ›ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[new Array() ä¸ Array.from() çš„å·®å¼‚ä¸é™·é˜±]]></title>    <link>https://juejin.cn/post/7582919147640356916</link>    <guid>https://juejin.cn/post/7582919147640356916</guid>    <pubDate>2025-12-14T01:42:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582919147640356916" data-draft-id="7582939860874248227" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="new Array() ä¸ Array.from() çš„å·®å¼‚ä¸é™·é˜±"/> <meta itemprop="keywords" content="JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-14T01:42:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜Ÿå…‰ä¸é—®èµ¶è·¯äºº"/> <meta itemprop="url" content="https://juejin.cn/user/950397121075304"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            new Array() ä¸ Array.from() çš„å·®å¼‚ä¸é™·é˜±
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/950397121075304/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜Ÿå…‰ä¸é—®èµ¶è·¯äºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T01:42:44.000Z" title="Sun Dec 14 2025 01:42:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>JS æ•°ç»„åˆå§‹åŒ–çš„ä¸¤ç§æ–¹å¼ï¼šç©ºæ§½ï¼ˆholeï¼‰ vs <code>undefined</code>ã€‚
ä¸‹é¢ä»<strong>ç»“æœç»“æ„ã€å¯éå†æ€§ã€è¡Œä¸ºå·®å¼‚ã€ä½¿ç”¨åœºæ™¯</strong>å‡ ä¸ªç»´åº¦ï¼Œç³»ç»Ÿå¯¹æ¯”</p>
<h2 data-id="heading-0">ä¸€ã€æœ€ç›´è§‚çš„å·®å¼‚ï¼ˆé‡ç‚¹ï¼‰</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">10</span>)
<span class="hljs-comment">// [ &lt;10 empty items&gt; ]</span>

<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">10</span> })
<span class="hljs-comment">// [ undefined, undefined, ..., undefined ]ï¼ˆ10 ä¸ªï¼‰</span>
</code></pre>
<blockquote>
<p><strong>æ ¸å¿ƒåŒºåˆ«</strong>ï¼š</p>
</blockquote>
<ul>
<li><code>new Array(10)</code> â†’ <strong>ç¨€ç–æ•°ç»„ï¼ˆholesï¼‰</strong></li>
<li><code>Array.from({ length: 10 })</code> â†’ <strong>å¯†é›†æ•°ç»„ï¼ˆå…ƒç´ å­˜åœ¨ï¼Œå€¼ä¸º undefinedï¼‰</strong></li>
</ul>
<h2 data-id="heading-1">äºŒã€æ•°ç»„â€œç©ºæ§½ï¼ˆholeï¼‰â€ vs <code>undefined</code></h2>



































<table><thead><tr><th>ç‰¹æ€§</th><th>new Array(10)</th><th>Array.from({ length: 10 })</th></tr></thead><tbody><tr><td>æ•°ç»„é•¿åº¦</td><td>10</td><td>10</td></tr><tr><td>æ˜¯å¦æœ‰å…ƒç´ </td><td>âŒ æ²¡æœ‰ï¼ˆholeï¼‰</td><td>âœ… æœ‰</td></tr><tr><td><code>0 in arr</code></td><td>false</td><td>true</td></tr><tr><td><code>arr[0]</code></td><td>undefined</td><td>undefined</td></tr><tr><td>JSON.stringify</td><td><code>[null,null,...]</code></td><td><code>[null,null,...]</code></td></tr></tbody></table>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> a = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">10</span>)
<span class="hljs-keyword">const</span> b = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">10</span> })
<span class="hljs-comment">// æ£€æŸ¥0ä¸‹æ ‡</span>
<span class="hljs-number">0</span> <span class="hljs-keyword">in</span> a <span class="hljs-comment">// false</span>
<span class="hljs-number">0</span> <span class="hljs-keyword">in</span> b <span class="hljs-comment">// true</span>
</code></pre>
<blockquote>
<p>âš ï¸ <strong><code>undefined !== hole</code></strong></p>
</blockquote>
<h2 data-id="heading-2">ä¸‰ã€éå† &amp; é«˜é˜¶å‡½æ•°è¡Œä¸ºå·®å¼‚ï¼ˆéå¸¸é‡è¦ï¼‰</h2>
<h3 data-id="heading-3">1ï¸âƒ£ <code>map / forEach / filter</code></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">3</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-number">1</span>)
<span class="hljs-comment">// [ &lt;3 empty items&gt; ]</span>

<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">3</span> }).<span class="hljs-title function_">map</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-number">1</span>)
<span class="hljs-comment">// [1, 1, 1]</span>
</code></pre>
<blockquote>
<p><strong>åŸå› </strong>ï¼š</p>
<ul>
<li>é«˜é˜¶æ–¹æ³•ä¼š <strong>è·³è¿‡ hole</strong></li>
<li>ä¸ä¼šè·³è¿‡ <code>undefined</code></li>
</ul>
</blockquote>
<h3 data-id="heading-4">2ï¸âƒ£ <code>for...of</code></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> x <span class="hljs-keyword">of</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">3</span>)) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(x)
}
<span class="hljs-comment">// undefined undefined undefined</span>

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> x <span class="hljs-keyword">of</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">3</span> })) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(x)
}
<span class="hljs-comment">// undefined undefined undefined</span>
</code></pre>
<blockquote>
<p><code>for...of</code> <strong>ä¼šéå† hole</strong>ï¼ˆä¸ map ä¸åŒï¼‰</p>
</blockquote>
<h3 data-id="heading-5">3ï¸âƒ£ <code>for...in</code></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> i <span class="hljs-keyword">in</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">3</span>)) <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i)
<span class="hljs-comment">// ä»€ä¹ˆéƒ½ä¸è¾“å‡º</span>

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> i <span class="hljs-keyword">in</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">3</span> })) <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i)
<span class="hljs-comment">// 0 1 2</span>
</code></pre>
<h2 data-id="heading-6">å››ã€æ€§èƒ½ä¸è¯­ä¹‰å·®å¼‚</h2>






























<table><thead><tr><th>ç»´åº¦</th><th>new Array(10)</th><th>Array.from({ length: 10 })</th></tr></thead><tbody><tr><td>åˆ›å»ºé€Ÿåº¦</td><td>æ›´å¿«</td><td>ç¨æ…¢</td></tr><tr><td>å†…å­˜</td><td>æ›´çœï¼ˆæ— å…ƒç´ ï¼‰</td><td>å ç”¨æ›´å¤š</td></tr><tr><td>å¯é¢„æµ‹æ€§</td><td>âŒ å®¹æ˜“è¸©å‘</td><td>âœ… è¡Œä¸ºä¸€è‡´</td></tr><tr><td>å‡½æ•°å¼å‹å¥½</td><td>âŒ</td><td>âœ…</td></tr></tbody></table>
<h2 data-id="heading-7">äº”ã€å…¸å‹ä½¿ç”¨åœºæ™¯</h2>
<h3 data-id="heading-8">âœ… é€‚åˆ <code>new Array(10)</code> çš„æƒ…å†µ</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// åªå…³å¿ƒ length</span>
<span class="hljs-keyword">const</span> buffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">1024</span>)

<span class="hljs-comment">// ä¹‹åç«‹å³å¡«å……</span>
<span class="hljs-keyword">const</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">10</span>)
arr.<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>)
</code></pre>
<h3 data-id="heading-9">âœ… é€‚åˆ <code>Array.from({ length: 10 })</code></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// éœ€è¦ map / filter / reduce</span>
<span class="hljs-keyword">const</span> list = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">10</span> }, <span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> i)

<span class="hljs-comment">// JSX / Vue æ¸²æŸ“</span>
{<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">5</span> }).<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Item</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{i}</span> /&gt;</span></span>
))}
</code></pre>
<h2 data-id="heading-10">å…­ã€ç­‰ä»·ä½†æ›´å¸¸è§çš„å†™æ³•</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">10</span> }, <span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> i)

<span class="hljs-comment">// ç­‰ä»·äº</span>
[...<span class="hljs-title class_">Array</span>(<span class="hljs-number">10</span>).<span class="hljs-title function_">keys</span>()]
</code></pre>
<h2 data-id="heading-11">ä¸ƒã€æ€»ç»“ä¸€å¥è¯ï¼ˆé¢è¯• / è®¾è®¡å»ºè®®ï¼‰</h2>
<blockquote>
<p><strong><code>new Array(n)</code> åˆ›å»ºçš„æ˜¯â€œç©ºæ§½æ•°ç»„â€ï¼Œ<br/>
<code>Array.from({ length: n })</code> åˆ›å»ºçš„æ˜¯â€œçœŸå®å…ƒç´ æ•°ç»„â€ã€‚</strong></p>
</blockquote>
<p><strong>æ¨èåŸåˆ™</strong>ï¼š</p>
<ul>
<li>è¦ <strong>éå† / map / æ¸²æŸ“</strong> â†’  <code>Array.from</code></li>
<li>åªå½“ <strong>å ä½å®¹å™¨</strong> â†’ <code>new Array</code></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸš€ å‘Šåˆ«â€œå˜å½¢â€ä¸â€œç•™ç™½â€ï¼šå‰ç«¯å¯è§†åŒ–å¤§å±é€‚é…çš„ç»ˆææ–¹æ¡ˆï¼ˆé™„æºç ï¼‰]]></title>    <link>https://juejin.cn/post/7582896213856665615</link>    <guid>https://juejin.cn/post/7582896213856665615</guid>    <pubDate>2025-12-14T02:12:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582896213856665615" data-draft-id="7582896213856649231" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸš€ å‘Šåˆ«â€œå˜å½¢â€ä¸â€œç•™ç™½â€ï¼šå‰ç«¯å¯è§†åŒ–å¤§å±é€‚é…çš„ç»ˆææ–¹æ¡ˆï¼ˆé™„æºç ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-14T02:12:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç‹éœ¸å¤©"/> <meta itemprop="url" content="https://juejin.cn/user/1875092531319104"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸš€ å‘Šåˆ«â€œå˜å½¢â€ä¸â€œç•™ç™½â€ï¼šå‰ç«¯å¯è§†åŒ–å¤§å±é€‚é…çš„ç»ˆææ–¹æ¡ˆï¼ˆé™„æºç ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1875092531319104/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç‹éœ¸å¤©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T02:12:50.000Z" title="Sun Dec 14 2025 02:12:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>æ‘˜è¦ï¼š</strong> å½“äº§å“æ‹¿ç€ä¸€ä»½ç‚«é…·çš„ 1920x1080 è®¾è®¡ç¨¿è®©ä½ å¼€å‘æ—¶ï¼Œä½ æ˜¯å¦è¿˜åœ¨ä¸ºå¦‚ä½•é€‚é…å®¢æˆ·ç°åœº 4K å±ã€å¼‚å½¢å±ç”šè‡³æ‹¼æ¥å±è€Œå‘æ„ï¼Ÿç½‘ä¸Šæµä¼ çš„ <code>rem</code>ã€<code>vw/vh</code> æ–¹æ¡ˆåœ¨å¤§å±åœºæ™¯ä¸‹å¾€å¾€åŠ›ä¸ä»å¿ƒã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥å‰–æå¤§å±é€‚é…çš„æ ¸å¿ƒç—›ç‚¹ï¼Œå¹¶æ¨èç›®å‰ç¤¾åŒºæœ€ä¸»æµçš„å¼€æºé€‚é…å·¥å…·ï¼Œå¸¦ä½ ç”¨æœ€å°‘çš„ä»£ç ï¼ˆä¸åˆ° 20 è¡Œï¼‰æå®šå…¨å±é€‚é…ã€‚</p>
<hr/>
<h3 data-id="heading-0">ğŸ¤” å¼•è¨€ï¼šä¸ºä»€ä¹ˆå¤§å±é€‚é…è¿™ä¹ˆéš¾ï¼Ÿ</h3>
<p>åœ¨æ™®é€š Web å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¹ æƒ¯äº†æµå¼å¸ƒå±€ï¼Œå®¹å™¨å®½åº¦è‡ªé€‚åº”ã€‚ä½†åœ¨<strong>æ•°æ®å¯è§†åŒ–å¤§å±</strong>é¢†åŸŸï¼Œæƒ…å†µæˆªç„¶ä¸åŒï¼š</p>
<ol>
<li><strong>åˆ†è¾¨ç‡ç¢ç‰‡åŒ–</strong>ï¼šè®¾è®¡é€šå¸¸åŸºäº 1920x1080 (16:9) å¼€å‘ï¼Œä½†ç°åœºå¯èƒ½æ˜¯ 4K (3840x2160)ã€è¶…å®½å± (32:9) ç”šè‡³è€æ—§çš„ 4:3 æŠ•å½±ä»ªã€‚</li>
<li><strong>åƒç´ çº§è¦æ±‚</strong>ï¼šå¤§å±é€šå¸¸åŒ…å«å¤æ‚çš„èƒŒæ™¯å›¾ã€è£…é¥°è¾¹æ¡†ï¼Œä¸€æ—¦æ‹‰ä¼¸å˜å½¢ï¼Œè§†è§‰æ•ˆæœå°†å¤§æ‰“æŠ˜æ‰£ã€‚</li>
<li><strong>ç¡¬ä»¶å·®å¼‚</strong>ï¼šLED æ‹¼æ¥å±å¯èƒ½å­˜åœ¨ç‰©ç†åƒç´ ç‚¹è·å·®å¼‚ã€‚</li>
</ol>
<p>ä¼ ç»Ÿçš„å“åº”å¼æ–¹æ¡ˆï¼ˆå¦‚ <code>flex</code>ã€<code>%</code>ï¼‰æ— æ³•æ»¡è¶³è¿™ç§**â€œæ—¢è¦é“ºæ»¡å±å¹•ï¼Œåˆè¦ä¿æŒæ¯”ä¾‹ï¼Œè¿˜ä¸èƒ½å˜å½¢â€**çš„è‹›åˆ»éœ€æ±‚ã€‚</p>
<hr/>
<h3 data-id="heading-1">ğŸ§  æ ¸å¿ƒåŸç†ï¼šä¸ºä»€ä¹ˆé€‰æ‹© <code>transform: scale</code>ï¼Ÿ</h3>
<p>åœ¨æ·±å…¥å·¥å…·ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡®ä¸€ç‚¹ï¼š<strong>ç›®å‰å¤§å±é€‚é…çš„ä¸»æµæ–¹æ¡ˆæ˜¯åŸºäº CSS3 çš„ <strong><code>transform: scale</code></strong>ã€‚</strong></p>
<h4 data-id="heading-2">1. æ–¹æ¡ˆå¯¹æ¯”</h4>

































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>åŸç†</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>rem / vw/vh</strong></td><td>åŠ¨æ€æ”¹å˜æ ¹å­—ä½“å¤§å°æˆ–è§†å£å•ä½</td><td>é€‚åˆæ–‡æœ¬æµå¼å¸ƒå±€</td><td>è®¡ç®—ç¹çï¼ŒèƒŒæ™¯å›¾éš¾å¤„ç†ï¼Œå®¹æ˜“å‡ºç° 1px åå·®</td><td>æ™®é€šè‡ªé€‚åº”ç½‘é¡µ</td></tr><tr><td><strong>åª’ä½“æŸ¥è¯¢</strong></td><td>é’ˆå¯¹ä¸åŒåˆ†è¾¨ç‡å†™å¤šå¥— CSS</td><td>ç²¾å‡†æ§åˆ¶</td><td>ä»£ç é‡çˆ†ç‚¸ï¼Œç»´æŠ¤å›°éš¾</td><td>æå°‘æ•°å›ºå®šåˆ†è¾¨ç‡åœºæ™¯</td></tr><tr><td><strong>Scale ç¼©æ”¾</strong></td><td><strong>ä»¥è®¾è®¡ç¨¿ä¸ºåŸºå‡†ï¼Œæ•´ä½“ç¼©æ”¾</strong></td><td><strong>ä»£ç å°‘ï¼Œä¸ä¸¢å¤±ç²¾åº¦ï¼Œå®Œç¾è¿˜åŸè®¾è®¡ç¨¿</strong></td><td>éœ€è¦å¤„ç†ç¼©æ”¾åçš„å®šä½é—®é¢˜</td><td><strong>å¤§å±å¯è§†åŒ– (æ¨è)</strong></td></tr></tbody></table>
<h4 data-id="heading-3">2. æ ¸å¿ƒé€»è¾‘</h4>
<p>å¤§å±é€‚é…çš„æœ¬è´¨æ˜¯ï¼š<strong>å°†åŸºäºç‰¹å®šè®¾è®¡å°ºå¯¸ï¼ˆå¦‚ 1920x1080ï¼‰çš„å†…å®¹ï¼Œé€šè¿‡çŸ©é˜µå˜æ¢ï¼Œç¼©æ”¾åˆ°ä¸åŒå°ºå¯¸çš„å±å¹•ä¸­ã€‚</strong></p>
<hr/>
<h3 data-id="heading-4">ğŸ”§ æ¨èå·¥å…·ï¼šå¼€æºç¤¾åŒºçš„â€œä¸‰é©¾é©¬è½¦â€</h3>
<p>å¦‚æœä½ ä¸æƒ³ä»é›¶é€ è½®å­ï¼Œä»¥ä¸‹æ˜¯ç›®å‰æ˜é‡‘å’Œ GitHub ä¸Šçƒ­åº¦æœ€é«˜ã€æœ€å€¼å¾—ä¿¡èµ–çš„ä¸‰ä¸ªå¼€æºé€‚é…æ–¹æ¡ˆã€‚</p>
<h4 data-id="heading-5">1. <code>autofit.js</code> â€”â€” ç®€å•ç²—æš´çš„é€šç”¨æ–¹æ¡ˆ</h4>
<p>è¿™æ˜¯ä¸€ä¸ªè½»é‡çº§çš„æ— æ¡†æ¶ä¾èµ–åº“ï¼Œéå¸¸é€‚åˆåŸç”Ÿ JS æˆ–è€é¡¹ç›®å¿«é€Ÿæ¥å…¥ã€‚</p>
<ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼š
<ul>
<li>ä¸ä¾èµ–ä»»ä½•æ¡†æ¶ï¼Œå¼•å…¥å³ç”¨ã€‚</li>
<li>æ ¸å¿ƒé€»è¾‘å°±æ˜¯è·å–å±å¹•å®½é«˜ï¼Œè®¡ç®—ç¼©æ”¾æ¯”ï¼Œç„¶åå¯¹ <code>body</code> æˆ–å®¹å™¨è¿›è¡Œ <code>scale</code>ã€‚</li>
</ul>
</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šç®€å•çš„ Vue/React é¡¹ç›®ï¼Œæˆ–è€…ä¸éœ€è¦å¤æ‚å±€éƒ¨å®šä½çš„é™æ€å¤§å±ã€‚</li>
</ul>
<h4 data-id="heading-6">2. <code>vfit.js</code> â€”â€” Vue 3 çš„â€œé«˜å®šâ€è£ç¼</h4>
<p>å¦‚æœä½ çš„é¡¹ç›®æ˜¯åŸºäº <strong>Vue 3 + TypeScript</strong>ï¼Œé‚£ä¹ˆ <code>vfit</code> æ˜¯ç›®å‰çš„æœ€ä½³é€‰æ‹©ã€‚å®ƒç”±ç¤¾åŒºå¼€å‘è€…é’ˆå¯¹ Vue 3 ç”Ÿæ€æ·±åº¦ä¼˜åŒ–ã€‚</p>
<ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼š
<ul>
<li><strong>ç»„ä»¶åŒ–æ€ç»´</strong>ï¼šå®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªç¼©æ”¾å·¥å…·ï¼Œæ›´æä¾›äº†ä¸€ä¸ª <code>&lt;FitContainer&gt;</code> ç»„ä»¶ã€‚</li>
<li><strong>è§£å†³å®šä½ç—›ç‚¹</strong>ï¼šå®ƒå®Œç¾è§£å†³äº†ç¼©æ”¾åç»å¯¹å®šä½ï¼ˆ<code>position: absolute</code>ï¼‰å…ƒç´ çš„åç§»é—®é¢˜ã€‚ä½ å¯ä»¥é€šè¿‡è®¾ç½® <code>unit="%"</code> æˆ– <code>unit="px"</code> æ¥è®©å…ƒç´ è·Ÿéšç¼©æ”¾è‡ªåŠ¨è°ƒæ•´ä½ç½®ã€‚</li>
<li><strong>å“åº”å¼</strong>ï¼šä¸ Vue 3 çš„ Composition API é…åˆå¾—å¤©è¡£æ— ç¼ã€‚</li>
</ul>
</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå¤æ‚çš„ Vue 3 å¯è§†åŒ–é¡¹ç›®ï¼Œç‰¹åˆ«æ˜¯åŒ…å«å¤§é‡éœ€è¦ç²¾ç¡®å®šä½çš„å›¾è¡¨ã€è£…é¥°ç‰©çš„åœºæ™¯ã€‚</li>
</ul>
<h4 data-id="heading-7">3. <code>DataV</code> (Vue) / <code>DataV-React</code> â€”â€” â€œå¼€ç®±å³ç”¨â€çš„å¤§å±å…¨å®¶æ¡¶</h4>
<p>è™½ç„¶é˜¿é‡Œäº‘æœ‰å•†ä¸šç‰ˆ DataVï¼Œä½†å¼€æºç¤¾åŒºæœ‰ä¸¤ä¸ªéå¸¸ä¼˜ç§€çš„ä»¿åˆ¶å“ï¼ˆé€šå¸¸ç”±ç¤¾åŒºç»´æŠ¤ï¼Œå¦‚ <code>DataV-Team</code> å‡ºå“ï¼‰ã€‚</p>
<ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼š
<ul>
<li><strong>è‡ªå¸¦é€‚é…</strong>ï¼šè¿™äº›åº“åœ¨è®¾è®¡ä¹‹åˆå°±è€ƒè™‘äº†é€‚é…é—®é¢˜ï¼Œé€šå¸¸å†…ç½®äº† <code>full-screen-container</code> è¿™æ ·çš„ç»„ä»¶ã€‚</li>
<li><strong>è§†è§‰ç»„ä»¶ä¸°å¯Œ</strong>ï¼šæä¾›äº†è¾¹æ¡†ã€è£…é¥°ã€é£çº¿å›¾ç­‰å¤§å±ä¸“ç”¨ç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶å†…éƒ¨å·²ç»å¤„ç†å¥½äº†ç¼©æ”¾é€»è¾‘ã€‚</li>
</ul>
</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šä¸æƒ³è‡ªå·±å†™ CSS å’Œé€‚é…é€»è¾‘ï¼Œæƒ³ç›´æ¥æ‹–æ‹½ç»„ä»¶å¿«é€Ÿæ­å»ºå¤§å±çš„å¼€å‘è€…ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-8">ğŸ’» ä»£ç å®æˆ˜ï¼šä¸åˆ° 20 è¡Œä»£ç æå®šé€‚é…</h3>
<p>ä¸æƒ³å¼•å…¥ç¬¬ä¸‰æ–¹åº“ï¼Ÿå…¶å®åŸç”Ÿ JS å®ç°ä¸€ä¸ªé«˜æ€§èƒ½çš„é€‚é…å™¨ä¹Ÿéå¸¸ç®€å•ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªåŸºäº <strong>â€œç­‰æ¯”ç¼©æ”¾â€</strong> ç­–ç•¥çš„é€šç”¨æ–¹æ¡ˆã€‚</p>
<h4 data-id="heading-9">1. æ ¸å¿ƒä»£ç  (<code>flexible.ts</code>)</h4>
<pre><code class="hljs language-ini" lang="ini">// å®šä¹‰è®¾è®¡ç¨¿åŸºå‡†
const <span class="hljs-attr">DESIGN_WIDTH</span> = <span class="hljs-number">1920</span><span class="hljs-comment">;</span>
const <span class="hljs-attr">DESIGN_HEIGHT</span> = <span class="hljs-number">1080</span><span class="hljs-comment">;</span>

// è®¡ç®—ç¼©æ”¾æ¯”ä¾‹çš„æ ¸å¿ƒé€»è¾‘
const <span class="hljs-attr">calculateScale</span> = () =&gt; {
  const { clientWidth, clientHeight } = document.documentElement<span class="hljs-comment">;</span>
  
  // ç­–ç•¥ï¼šå–å®½åº¦å’Œé«˜åº¦ç¼©æ”¾æ¯”ä¾‹çš„æœ€å°å€¼ï¼Œç¡®ä¿å†…å®¹å®Œæ•´æ˜¾ç¤ºï¼ˆç±»ä¼¼ background-size: coverï¼‰
  const <span class="hljs-attr">scaleX</span> = clientWidth / DESIGN_WIDTH<span class="hljs-comment">;</span>
  const <span class="hljs-attr">scaleY</span> = clientHeight / DESIGN_HEIGHT<span class="hljs-comment">;</span>
  
  return Math.min(scaleX, scaleY)<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

// åº”ç”¨ç¼©æ”¾
const <span class="hljs-attr">applyScale</span> = () =&gt; {
  const <span class="hljs-attr">scale</span> = calculateScale()<span class="hljs-comment">;</span>
  const <span class="hljs-attr">container</span> = document.getElementById(<span class="hljs-string">'screen-container'</span>)<span class="hljs-comment">;</span>
  
  if (container) {
    // å…³é”® CSSï¼šä»¥å·¦ä¸Šè§’ä¸ºåŸç‚¹è¿›è¡Œç¼©æ”¾
    <span class="hljs-attr">container.style.transform</span> = `scale(<span class="hljs-variable">${scale}</span>)`<span class="hljs-comment">;</span>
    <span class="hljs-attr">container.style.transformOrigin</span> = <span class="hljs-string">'0 0'</span><span class="hljs-comment">;</span>
    
    // å¯é€‰ï¼šå¦‚æœéœ€è¦å±…ä¸­æ˜¾ç¤ºï¼Œå¯ä»¥è®¡ç®—åç§»é‡
    // const <span class="hljs-attr">offsetX</span> = (clientWidth - DESIGN_WIDTH * scale) / <span class="hljs-number">2</span><span class="hljs-comment">;</span>
    // <span class="hljs-attr">container.style.marginLeft</span> = `<span class="hljs-variable">${offsetX}</span>px`<span class="hljs-comment">;</span>
  }
}<span class="hljs-comment">;</span>

// ç›‘å¬çª—å£å˜åŒ–
window.addEventListener('resize', applyScale)<span class="hljs-comment">;</span>
export default applyScale<span class="hljs-comment">;</span>
</code></pre>
<h4 data-id="heading-10">2. åœ¨ Vue/React ä¸­ä½¿ç”¨</h4>
<p>åœ¨ <code>main.js</code> æˆ–æ ¹ç»„ä»¶çš„ <code>mounted</code> é˜¶æ®µè°ƒç”¨å³å¯ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> applyScale <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils/flexible'</span>;
<span class="hljs-comment">// åˆå§‹åŒ–</span>
<span class="hljs-title function_">applyScale</span>();
</code></pre>
<h4 data-id="heading-11">3. CSS æ ·å¼é…åˆ</h4>
<p>ä¸ºäº†è®©å®¹å™¨æ’‘æ»¡å…¨å±å¹¶æ‰¿è½½ç¼©æ”¾ï¼ŒCSS éœ€è¦è¿™æ ·å†™ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">html</span>, <span class="hljs-selector-tag">body</span>, <span class="hljs-selector-id">#app</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">overflow</span>: hidden; <span class="hljs-comment">/* éšè—æ»šåŠ¨æ¡ */</span>
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
}

<span class="hljs-selector-id">#screen-container</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">1920px</span>; <span class="hljs-comment">/* å›ºå®šè®¾è®¡ç¨¿å®½åº¦ */</span>
  <span class="hljs-attribute">height</span>: <span class="hljs-number">1080px</span>; <span class="hljs-comment">/* å›ºå®šè®¾è®¡ç¨¿é«˜åº¦ */</span>
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-comment">/* èƒŒæ™¯å›¾ç­‰æ ·å¼ */</span>
}
</code></pre>
<hr/>
<h3 data-id="heading-12">ğŸ“ æ€»ç»“ä¸å»ºè®®</h3>
<p>åœ¨ 2025 å¹´çš„ä»Šå¤©ï¼Œé¢å¯¹å¯è§†åŒ–å¤§å±é€‚é…ï¼Œæˆ‘çš„å»ºè®®æ˜¯ï¼š</p>
<ol>
<li><strong>é¦–é€‰ <strong><code>scale</code></strong> æ–¹æ¡ˆ</strong>ï¼šé™¤éä½ æœ‰ç‰¹æ®Šçš„ä¸šåŠ¡é€»è¾‘è¦æ±‚ï¼Œå¦åˆ™ä¸è¦å°è¯•ç”¨ <code>rem</code> å»ç¡¬æŠ—å¤§å±é€‚é…ï¼Œ<code>transform: scale</code> æ˜¯ç›®å‰ç¤¾åŒºå…¬è®¤çš„æœ€ä¼˜è§£ã€‚</li>
<li><strong>æŠ€æœ¯æ ˆåŒ¹é…</strong>ï¼š
<ul>
<li>å¦‚æœæ˜¯ <strong>Vue 3</strong> é¡¹ç›®ï¼Œå¼ºçƒˆæ¨èä½¿ç”¨ <code>vfit.js</code>ï¼Œå®ƒèƒ½å¸®ä½ çœå» 80% çš„å®šä½è°ƒè¯•æ—¶é—´ã€‚</li>
<li>å¦‚æœæ˜¯ <strong>React</strong> é¡¹ç›®ï¼Œå¯ä»¥å¯»æ‰¾ç±»ä¼¼çš„ <code>react-fit-screen</code> åº“ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨ä¸Šè¿°çš„é€šç”¨ JS ä»£ç ã€‚</li>
<li>å¦‚æœè¿½æ±‚<strong>æè‡´å¼€å‘é€Ÿåº¦</strong>ï¼Œç›´æ¥ä¸Šå¼€æºç‰ˆ <code>DataV</code>ã€‚</li>
</ul>
</li>
<li><strong>è®¾è®¡æ²Ÿé€š</strong>ï¼šåœ¨å¼€å‘å‰ï¼ŒåŠ¡å¿…ç¡®è®¤å¤§å±çš„éƒ¨ç½²ç¯å¢ƒã€‚å¦‚æœæ˜¯ 16:9 çš„æ ‡å‡†å±ï¼Œä¸Šè¿°æ–¹æ¡ˆå®Œç¾é€‚ç”¨ï¼›å¦‚æœæ˜¯è¶…å®½å±ï¼ˆå¦‚ 32:9ï¼‰ï¼Œå¯èƒ½éœ€è¦è€ƒè™‘â€œä¸¤è¾¹ç•™ç™½â€æˆ–è€…â€œèƒŒæ™¯æ‹‰ä¼¸â€çš„ç‰¹æ®Šå¤„ç†ã€‚</li>
</ol>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®ä½ æå®šé‚£ä¸ªè®©äººå¤´ç–¼çš„â€œå¤§å±é€‚é…â€éœ€æ±‚ï¼Œæ—©ç‚¹ä¸‹ç­ï¼âœ¨</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€n8næ•™ç¨‹ã€‘ï¼šä»æ—¥å¿—åˆ°ç›‘æ§å†åˆ°å®‰å…¨å®¡è®¡ï¼Œè®©ä½ çš„n8nå®ä¾‹è¿è¡Œæ— å¿§]]></title>    <link>https://juejin.cn/post/7582919147640094772</link>    <guid>https://juejin.cn/post/7582919147640094772</guid>    <pubDate>2025-12-14T00:39:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582919147640094772" data-draft-id="7580564126403231794" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€n8næ•™ç¨‹ã€‘ï¼šä»æ—¥å¿—åˆ°ç›‘æ§å†åˆ°å®‰å…¨å®¡è®¡ï¼Œè®©ä½ çš„n8nå®ä¾‹è¿è¡Œæ— å¿§"/> <meta itemprop="keywords" content="AIGC,AIç¼–ç¨‹,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-14T00:39:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="undsky"/> <meta itemprop="url" content="https://juejin.cn/user/3368559354850206"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€n8næ•™ç¨‹ã€‘ï¼šä»æ—¥å¿—åˆ°ç›‘æ§å†åˆ°å®‰å…¨å®¡è®¡ï¼Œè®©ä½ çš„n8nå®ä¾‹è¿è¡Œæ— å¿§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3368559354850206/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    undsky
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T00:39:10.000Z" title="Sun Dec 14 2025 00:39:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ã€n8næ•™ç¨‹ã€‘ï¼šä»æ—¥å¿—åˆ°ç›‘æ§å†åˆ°å®‰å…¨å®¡è®¡ï¼Œè®©ä½ çš„n8nå®ä¾‹è¿è¡Œæ— å¿§</h2>
<p>ä½œä¸ºn8nçš„ç”¨æˆ·ï¼Œä½ å¯èƒ½å·²ç»åˆ›å»ºäº†è®¸å¤šè‡ªåŠ¨åŒ–å·¥ä½œæµã€‚ä½†ä½ æ˜¯å¦æ€è€ƒè¿‡å¦‚ä½•<strong>è¿½è¸ªè¿™äº›å·¥ä½œæµçš„è¿è¡ŒçŠ¶æ€</strong>ï¼Ÿå¦‚ä½•<strong>åŠæ—¶å‘ç°é—®é¢˜</strong>ï¼Ÿå¦‚ä½•<strong>ç¡®ä¿ç³»ç»Ÿå®‰å…¨</strong>ï¼Ÿæœ¬æ•™ç¨‹å°†å¸¦ä½ æ·±å…¥äº†è§£n8nçš„ä¸‰å¤§è¿ç»´æ ¸å¿ƒåŠŸèƒ½ï¼šæ—¥å¿—ç®¡ç†ã€ç›‘æ§å‘Šè­¦å’Œå®‰å…¨å®¡è®¡ã€‚</p>
<p>è¿™ç¯‡æ•™ç¨‹é€‚åˆåˆå­¦è€…ï¼Œæˆ‘ä»¬å°†é€šè¿‡<strong>å®æ“æ¡ˆä¾‹</strong>å’Œ<strong>å®Œæ•´å·¥ä½œæµä»£ç </strong>ï¼Œè®©ä½ è½»æ¾ä¸Šæ‰‹n8nçš„è¿ç»´ç®¡ç†ã€‚</p>
<hr/>
<h3 data-id="heading-1">ğŸ“ ç¬¬ä¸€éƒ¨åˆ†ï¼šæ—¥å¿—ç®¡ç† - è¿½è¸ªå·¥ä½œæµçš„æ¯ä¸€æ­¥</h3>
<h4 data-id="heading-2">ä»€ä¹ˆæ˜¯æ—¥å¿—ï¼Ÿ</h4>
<p>æ—¥å¿—å°±åƒæ˜¯n8nå®ä¾‹çš„"æ—¥è®°"ï¼Œå®ƒè®°å½•äº†æ‰€æœ‰å‘ç”Ÿçš„äº‹æƒ…ã€‚å½“å·¥ä½œæµå‡ºé”™æ—¶ï¼Œæ—¥å¿—èƒ½å¸®ä½ å¿«é€Ÿå®šä½é—®é¢˜ã€‚</p>
<h4 data-id="heading-3">æ—¥å¿—çº§åˆ«è¯¦è§£</h4>
<p>n8næä¾›äº†4ä¸ªæ—¥å¿—çº§åˆ«ï¼Œä»ä½åˆ°é«˜æ’åˆ—ï¼š</p>






























<table><thead><tr><th>æ—¥å¿—çº§åˆ«</th><th>è¯´æ˜</th><th>ä½¿ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>error</strong></td><td>åªæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯</td><td>ç”Ÿäº§ç¯å¢ƒï¼Œåªå…³å¿ƒæ•…éšœ</td></tr><tr><td><strong>warn</strong></td><td>æ˜¾ç¤ºé”™è¯¯å’Œè­¦å‘Š</td><td>ç”Ÿäº§ç¯å¢ƒï¼Œéœ€è¦æå‰å‘ç°é—®é¢˜</td></tr><tr><td><strong>info</strong></td><td>æ˜¾ç¤ºé”™è¯¯ã€è­¦å‘Šå’Œä¿¡æ¯</td><td>é»˜è®¤çº§åˆ«ï¼Œè®°å½•å…³é”®äº‹ä»¶</td></tr><tr><td><strong>debug</strong></td><td>æ˜¾ç¤ºæ‰€æœ‰ä¿¡æ¯ï¼Œæœ€è¯¦ç»†</td><td>å¼€å‘ç¯å¢ƒï¼Œæ·±åº¦è°ƒè¯•</td></tr></tbody></table>
<h4 data-id="heading-4">å¿«é€Ÿå¼€å§‹ï¼šé…ç½®æ—¥å¿—</h4>
<h5 data-id="heading-5">æ–¹å¼ä¸€ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡ï¼ˆæ¨èï¼‰</h5>
<p>å¦‚æœä½ ä½¿ç”¨Dockeræˆ–å‘½ä»¤è¡Œå¯åŠ¨n8nï¼Œè®¾ç½®è¿™äº›ç¯å¢ƒå˜é‡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è®¾ç½®æ—¥å¿—çº§åˆ«ä¸º info</span>
<span class="hljs-built_in">export</span> N8N_LOG_LEVEL=info

<span class="hljs-comment"># è®¾ç½®æ—¥å¿—è¾“å‡ºåˆ°æ–‡ä»¶</span>
<span class="hljs-built_in">export</span> N8N_LOG_OUTPUT=file

<span class="hljs-comment"># è®¾ç½®æ—¥å¿—æ–‡ä»¶ä½ç½®</span>
<span class="hljs-built_in">export</span> N8N_LOG_FILE_LOCATION=/data/logs/n8n.<span class="hljs-built_in">log</span>

<span class="hljs-comment"># è®¾ç½®å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§ä¸º 16 MB</span>
<span class="hljs-built_in">export</span> N8N_LOG_FILE_SIZE_MAX=16

<span class="hljs-comment"># è®¾ç½®æœ€å¤šä¿ç•™ 100 ä¸ªæ—¥å¿—æ–‡ä»¶</span>
<span class="hljs-built_in">export</span> N8N_LOG_FILE_COUNT_MAX=100
</code></pre>
<h5 data-id="heading-6">æ–¹å¼äºŒï¼šä¿®æ”¹é…ç½®æ–‡ä»¶</h5>
<p>åœ¨ä½ çš„n8né…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">n8n:</span>
  <span class="hljs-attr">log:</span>
    <span class="hljs-attr">level:</span> <span class="hljs-string">info</span>
    <span class="hljs-attr">output:</span> <span class="hljs-string">console,file</span>
    <span class="hljs-attr">file:</span>
      <span class="hljs-attr">location:</span> <span class="hljs-string">/data/logs/n8n.log</span>
      <span class="hljs-attr">fileSizeMax:</span> <span class="hljs-number">16</span>
      <span class="hljs-attr">fileCountMax:</span> <span class="hljs-number">100</span>
</code></pre>
<h4 data-id="heading-7">ğŸ“ å®æˆ˜å°æŠ€å·§</h4>
<ol>
<li>
<p><strong>å¼€å‘ç¯å¢ƒç”¨ debug</strong>ï¼šåœ¨è°ƒè¯•å·¥ä½œæµæ—¶ï¼Œè®¾ç½® <code>N8N_LOG_LEVEL=debug</code> èƒ½çœ‹åˆ°æœ€è¯¦ç»†çš„ä¿¡æ¯ã€‚</p>
</li>
<li>
<p><strong>ç”Ÿäº§ç¯å¢ƒç”¨ info æˆ– warn</strong>ï¼šä¿ç•™è¶³å¤Ÿçš„ä¿¡æ¯è¿½è¸ªé—®é¢˜ï¼Œåˆä¸ä¼šäº§ç”Ÿè¿‡å¤šæ—¥å¿—ã€‚</p>
</li>
<li>
<p><strong>å®šæœŸæ¸…ç†æ—¥å¿—</strong>ï¼šn8nä¼šè‡ªåŠ¨ç®¡ç†æ—¥å¿—æ–‡ä»¶æ•°é‡ï¼Œä½†è¦ç¡®ä¿ç£ç›˜æœ‰å……è¶³ç©ºé—´ã€‚</p>
</li>
</ol>
<hr/>
<h3 data-id="heading-8">ğŸ“Š ç¬¬äºŒéƒ¨åˆ†ï¼šç›‘æ§ç³»ç»Ÿ - å®æ—¶æŒæ¡å®ä¾‹çŠ¶æ€</h3>
<h4 data-id="heading-9">ç›‘æ§çš„ä¸‰ä¸ªæ ¸å¿ƒç«¯ç‚¹</h4>
<p>n8næä¾›äº†ä¸‰ä¸ªAPIç«¯ç‚¹è®©ä½ ç›‘æ§å®ä¾‹çš„å¥åº·çŠ¶æ€ï¼š</p>
<h5 data-id="heading-10">1ï¸âƒ£ /healthz ç«¯ç‚¹ - å¿«é€Ÿå¥åº·æ£€æŸ¥</h5>
<pre><code class="hljs language-bash" lang="bash">curl http://localhost:5678/healthz
</code></pre>
<p><strong>è¿”å›è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>200 OK</code>ï¼šå®ä¾‹è¿è¡Œæ­£å¸¸ï¼Œå¯ä»¥æ¥æ”¶è¯·æ±‚</li>
<li>å…¶ä»–çŠ¶æ€ç ï¼šå®ä¾‹æœ‰é—®é¢˜</li>
</ul>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong> å¿«é€Ÿæ£€æŸ¥å®ä¾‹æ˜¯å¦åœ¨çº¿ï¼Œç”¨äºè´Ÿè½½å‡è¡¡å™¨æˆ–ç®€å•çš„å¥åº·æ£€æŸ¥ã€‚</p>
<h5 data-id="heading-11">2ï¸âƒ£ /healthz/readiness ç«¯ç‚¹ - å®Œæ•´å‡†å¤‡æ£€æŸ¥</h5>
<pre><code class="hljs language-bash" lang="bash">curl http://localhost:5678/healthz/readiness
</code></pre>
<p><strong>è¿”å›è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>200 OK</code>ï¼šæ•°æ®åº“å·²è¿æ¥ä¸”è¿ç§»å®Œæˆï¼Œå®ä¾‹å¯ä»¥å¼€å§‹å¤„ç†ä¸šåŠ¡</li>
<li>å…¶ä»–çŠ¶æ€ç ï¼šæ•°æ®åº“æœªå°±ç»ª</li>
</ul>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong> Kubernetes çš„ readiness probeï¼Œæˆ–åœ¨å¯åŠ¨å…¶ä»–ä¾èµ–æœåŠ¡å‰è¿›è¡Œæ£€æŸ¥ã€‚</p>
<h5 data-id="heading-12">3ï¸âƒ£ /metrics ç«¯ç‚¹ - è¯¦ç»†æŒ‡æ ‡æ•°æ®</h5>
<pre><code class="hljs language-bash" lang="bash">curl http://localhost:5678/metrics
</code></pre>
<p><strong>æ³¨æ„ï¼š</strong> éœ€è¦å…ˆå¯ç”¨ï¼</p>
<p><strong>è¿”å›è¯´æ˜ï¼š</strong> åŒ…å«CPUã€å†…å­˜ã€è¯·æ±‚æ•°ç­‰è¯¦ç»†æŒ‡æ ‡ï¼ˆPrometheus æ ¼å¼ï¼‰</p>
<h4 data-id="heading-13">âš™ï¸ å¯ç”¨ç›‘æ§æŒ‡æ ‡</h4>
<p>é¦–å…ˆéœ€è¦åœ¨ç¯å¢ƒå˜é‡ä¸­å¯ç”¨ <code>/metrics</code> ç«¯ç‚¹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯ç”¨æŒ‡æ ‡æ”¶é›†</span>
<span class="hljs-built_in">export</span> N8N_METRICS=<span class="hljs-literal">true</span>

<span class="hljs-comment"># å¦‚æœä½¿ç”¨Dockerï¼Œç¡®ä¿è¿™äº›ç«¯å£å¼€æ”¾</span>
<span class="hljs-comment"># é»˜è®¤ç«¯å£ï¼š5678 (HTTP)</span>
<span class="hljs-comment"># å¯é€‰æŒ‡æ ‡ç«¯å£ï¼šæŒ‡å®šåœ¨ N8N_METRICS_* å˜é‡ä¸­</span>
</code></pre>
<h4 data-id="heading-14">ğŸ“ˆ å¸¸è§ç›‘æ§æŒ‡æ ‡</h4>
<p>é€šè¿‡ <code>/metrics</code> ç«¯ç‚¹ï¼Œä½ èƒ½è·å–ï¼š</p>
<ul>
<li><strong>nodejs_heap_size_bytes</strong>ï¼šå†…å­˜ä½¿ç”¨æƒ…å†µ</li>
<li><strong>process_resident_memory_bytes</strong>ï¼šè¿›ç¨‹å†…å­˜å ç”¨</li>
<li><strong>http_requests_total</strong>ï¼šæ€»è¯·æ±‚æ•°</li>
<li><strong>workflow_execution_total</strong>ï¼šå·¥ä½œæµæ‰§è¡Œæ¬¡æ•°</li>
<li><strong>workflow_execution_duration_seconds</strong>ï¼šæ‰§è¡Œè€—æ—¶</li>
</ul>
<hr/>
<h3 data-id="heading-15">ğŸ”’ ç¬¬ä¸‰éƒ¨åˆ†ï¼šå®‰å…¨å®¡è®¡ - ä¿æŠ¤ä½ çš„è‡ªåŠ¨åŒ–ç³»ç»Ÿ</h3>
<h4 data-id="heading-16">ä»€ä¹ˆæ˜¯å®‰å…¨å®¡è®¡ï¼Ÿ</h4>
<p>å®‰å…¨å®¡è®¡èƒ½è‡ªåŠ¨æ£€æŸ¥ä½ çš„n8nå®ä¾‹ä¸­å­˜åœ¨çš„<strong>5å¤§å®‰å…¨é£é™©</strong>ï¼Œå¸®åŠ©ä½ å¿«é€Ÿå‘ç°å’Œä¿®å¤é—®é¢˜ã€‚</p>
<h4 data-id="heading-17">å®¡è®¡çš„äº”å¤§æŠ¥å‘Šç±»å‹</h4>
<h5 data-id="heading-18">1. å‡­è¯å®¡è®¡</h5>
<p>æ£€æŸ¥æ‚¨çš„APIå¯†é’¥å’Œå‡­è¯æ˜¯å¦å­˜åœ¨é—®é¢˜ï¼š</p>
<ul>
<li>âœ… æ£€æŸ¥æœªä½¿ç”¨çš„å‡­è¯ï¼ˆå¯èƒ½é—å¿˜çš„å‡­è¯ï¼‰</li>
<li>âœ… æ£€æŸ¥åœ¨éæ´»è·ƒå·¥ä½œæµä¸­çš„å‡­è¯ï¼ˆå¯ä»¥åˆ é™¤ï¼‰</li>
<li>âœ… æ£€æŸ¥åœ¨æœ€è¿‘æœªè¿è¡Œå·¥ä½œæµä¸­çš„å‡­è¯ï¼ˆå¯ä»¥æ¸…ç†ï¼‰</li>
</ul>
<p><strong>å¤„ç†å»ºè®®ï¼š</strong> åˆ é™¤æœªä½¿ç”¨çš„å‡­è¯ï¼Œé™ä½è¢«æ³„éœ²çš„é£é™©ã€‚</p>
<h5 data-id="heading-19">2. æ•°æ®åº“å®¡è®¡</h5>
<p>æ£€æŸ¥SQLæŸ¥è¯¢ä¸­çš„å®‰å…¨éšæ‚£ï¼š</p>
<ul>
<li>âœ… æŸ¥æ‰¾åœ¨ SQL èŠ‚ç‚¹ä¸­ä½¿ç”¨ <code>æ‰§è¡ŒæŸ¥è¯¢</code> æ—¶ç›´æ¥æ‹¼æ¥çš„è¡¨è¾¾å¼ï¼ˆå®¹æ˜“è¢«SQLæ³¨å…¥ï¼‰</li>
<li>âœ… æŸ¥æ‰¾æŸ¥è¯¢å‚æ•°å­—æ®µä¸­çš„è¡¨è¾¾å¼</li>
<li>âœ… æ£€æŸ¥æœªä½¿ç”¨çš„æŸ¥è¯¢å‚æ•°</li>
</ul>
<p><strong>å¤„ç†å»ºè®®ï¼š</strong> ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼Œé¿å…ç›´æ¥æ‹¼æ¥ç”¨æˆ·è¾“å…¥ã€‚</p>
<h5 data-id="heading-20">3. æ–‡ä»¶ç³»ç»Ÿå®¡è®¡</h5>
<p>æ£€æŸ¥å“ªäº›èŠ‚ç‚¹ä¼šè®¿é—®æœåŠ¡å™¨çš„æ–‡ä»¶ç³»ç»Ÿï¼š</p>
<ul>
<li>âœ… åˆ—å‡ºæ‰€æœ‰è®¿é—®æœ¬åœ°æ–‡ä»¶çš„èŠ‚ç‚¹ï¼ˆå¦‚è¯»å–ã€å†™å…¥æ–‡ä»¶ï¼‰</li>
</ul>
<p><strong>å¤„ç†å»ºè®®ï¼š</strong> ç¡®è®¤è¿™äº›æ–‡ä»¶æ“ä½œéƒ½æ˜¯å¿…è¦çš„ï¼Œé™åˆ¶èŠ‚ç‚¹çš„æ–‡ä»¶è®¿é—®æƒé™ã€‚</p>
<h5 data-id="heading-21">4. èŠ‚ç‚¹å®¡è®¡</h5>
<p>æ£€æŸ¥ä½¿ç”¨çš„èŠ‚ç‚¹ç±»å‹æ˜¯å¦å­˜åœ¨å®‰å…¨é£é™©ï¼š</p>
<ul>
<li>âœ… è¯†åˆ«<strong>å®˜æ–¹å±é™©èŠ‚ç‚¹</strong>ï¼ˆå¦‚ä»£ç æ‰§è¡ŒèŠ‚ç‚¹ï¼‰</li>
<li>âœ… æ£€æŸ¥<strong>ç¤¾åŒºèŠ‚ç‚¹</strong>çš„ä½¿ç”¨</li>
<li>âœ… æ£€æŸ¥<strong>è‡ªå®šä¹‰èŠ‚ç‚¹</strong>çš„å®‰è£…</li>
</ul>
<p><strong>å¤„ç†å»ºè®®ï¼š</strong> è°¨æ…ä½¿ç”¨ä»£ç æ‰§è¡ŒèŠ‚ç‚¹ï¼Œä»…ä»ä¿¡ä»»çš„æ¥æºå®‰è£…ç¤¾åŒºèŠ‚ç‚¹ã€‚</p>
<h5 data-id="heading-22">5. å®ä¾‹å®¡è®¡</h5>
<p>æ£€æŸ¥æ•´ä¸ªå®ä¾‹çš„å®‰å…¨é…ç½®ï¼š</p>
<ul>
<li>âœ… æ£€æŸ¥<strong>æœªä¿æŠ¤çš„Webhook</strong>ï¼ˆä»»ä½•äººéƒ½å¯è§¦å‘ï¼‰</li>
<li>âœ… æ£€æŸ¥<strong>ç¼ºå¤±çš„å®‰å…¨è®¾ç½®</strong>ï¼ˆå¦‚æœªå¼€å¯åŒå› ç´ è®¤è¯ï¼‰</li>
<li>âœ… æ£€æŸ¥<strong>å®ä¾‹ç‰ˆæœ¬</strong>æ˜¯å¦è¿‡æ—¶ï¼ˆéœ€è¦å‡çº§ï¼‰</li>
</ul>
<p><strong>å¤„ç†å»ºè®®ï¼š</strong> ä¸ºWebhookæ·»åŠ è®¤è¯ï¼Œå¯ç”¨å®‰å…¨åŠŸèƒ½ï¼Œå®šæœŸæ›´æ–°n8nã€‚</p>
<h4 data-id="heading-23">ğŸš€ å¦‚ä½•è¿è¡Œå®‰å…¨å®¡è®¡ï¼Ÿ</h4>
<h5 data-id="heading-24">æ–¹å¼ä¸€ï¼šå‘½ä»¤è¡Œæ‰§è¡Œ</h5>
<pre><code class="hljs language-bash" lang="bash">n8n audit
</code></pre>
<p>è¿è¡Œåä¼šç”Ÿæˆä¸€ä»½åŒ…å«æ‰€æœ‰é£é™©çš„æŠ¥å‘Šã€‚</p>
<h5 data-id="heading-25">æ–¹å¼äºŒï¼šAPIè°ƒç”¨</h5>
<pre><code class="hljs language-bash" lang="bash">curl -X POST http://localhost:5678/rest/audit \
  -H <span class="hljs-string">"Authorization: Bearer YOUR_API_TOKEN"</span> \
  -H <span class="hljs-string">"Content-Type: application/json"</span>
</code></pre>
<h5 data-id="heading-26">æ–¹å¼ä¸‰ï¼šåœ¨å·¥ä½œæµä¸­æ‰§è¡Œ</h5>
<p>åœ¨å·¥ä½œæµä¸­æ·»åŠ  <strong>n8n èŠ‚ç‚¹</strong>ï¼Œé€‰æ‹©ï¼š</p>
<ul>
<li><strong>Resource</strong>: Audit</li>
<li><strong>Operation</strong>: Generate</li>
</ul>
<p>ç„¶åè¿è¡Œå·¥ä½œæµï¼Œä¼šè¿”å›å®¡è®¡æŠ¥å‘Šã€‚</p>
<hr/>
<h3 data-id="heading-27">ğŸ’¼ å®Œæ•´å®æˆ˜æ¡ˆä¾‹ï¼šæ„å»ºn8nç›‘æ§å’Œå®¡è®¡å·¥ä½œæµ</h3>
<p>ç°åœ¨æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ª<strong>å®Œæ•´å¯æ‰§è¡Œçš„å·¥ä½œæµ</strong>ï¼Œå®ƒèƒ½è‡ªåŠ¨æ£€æŸ¥å®ä¾‹å¥åº·çŠ¶æ€ã€æ”¶é›†æŒ‡æ ‡ã€è¿è¡Œå®‰å…¨å®¡è®¡ï¼Œå¹¶å‘é€æŠ¥å‘Šã€‚</p>
<h4 data-id="heading-28">å·¥ä½œæµæµç¨‹</h4>
<pre><code class="hljs">å®šæ—¶è§¦å‘ â†’ æ£€æŸ¥å®ä¾‹å¥åº· â†’ æ£€æŸ¥æ•°æ®åº“ â†’ æ”¶é›†æŒ‡æ ‡ â†’ å®‰å…¨å®¡è®¡ â†’ ç”ŸæˆæŠ¥å‘Š â†’ å‘é€é€šçŸ¥
</code></pre>
<h4 data-id="heading-29">å·¥ä½œæµJSONä»£ç </h4>
<p>å°†ä¸‹é¢çš„JSONä»£ç å¯¼å…¥åˆ°n8nä¸­ï¼ˆç‚¹å‡»"Import Workflow"ï¼‰ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"n8nå®ä¾‹å¥åº·ç›‘æ§å·¥ä½œæµ"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"active"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"connections"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"Schedule"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">[</span>
          <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"node"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ£€æŸ¥å®ä¾‹å¥åº·çŠ¶æ€"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"main"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"index"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span>
          <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">]</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"æ£€æŸ¥å®ä¾‹å¥åº·çŠ¶æ€"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">[</span>
          <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"node"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ£€æŸ¥æ•°æ®åº“å‡†å¤‡çŠ¶æ€"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"main"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"index"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span>
          <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">]</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"æ£€æŸ¥æ•°æ®åº“å‡†å¤‡çŠ¶æ€"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">[</span>
          <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"node"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"è·å–è¯¦ç»†æŒ‡æ ‡"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"main"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"index"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span>
          <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">]</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"è·å–è¯¦ç»†æŒ‡æ ‡"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">[</span>
          <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"node"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å®‰å…¨å®¡è®¡æ£€æŸ¥"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"main"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"index"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span>
          <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">]</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"å®‰å…¨å®¡è®¡æ£€æŸ¥"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">[</span>
          <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"node"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ ¼å¼åŒ–æŠ¥å‘Š"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"main"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"index"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span>
          <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">]</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"æ ¼å¼åŒ–æŠ¥å‘Š"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">[</span>
          <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"node"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å‘é€é€šçŸ¥"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"main"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"index"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span>
          <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">]</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"nodes"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"interval"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"unit"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"hours"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Schedule"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Schedule"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"n8n-nodes-base.schedule"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"typeVersion"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"position"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">50</span><span class="hljs-punctuation">,</span> <span class="hljs-number">100</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"method"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"GET"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http://localhost:5678/healthz"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"authentication"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"none"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"responseFormat"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"json"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ£€æŸ¥å®ä¾‹å¥åº·çŠ¶æ€"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ£€æŸ¥å®ä¾‹å¥åº·çŠ¶æ€"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"n8n-nodes-base.httpRequest"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"typeVersion"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"position"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">300</span><span class="hljs-punctuation">,</span> <span class="hljs-number">100</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"method"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"GET"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http://localhost:5678/healthz/readiness"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"authentication"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"none"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"responseFormat"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"json"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ£€æŸ¥æ•°æ®åº“å‡†å¤‡çŠ¶æ€"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ£€æŸ¥æ•°æ®åº“å‡†å¤‡çŠ¶æ€"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"n8n-nodes-base.httpRequest"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"typeVersion"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"position"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">550</span><span class="hljs-punctuation">,</span> <span class="hljs-number">100</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"method"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"GET"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http://localhost:5678/metrics"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"authentication"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"none"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"responseFormat"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"text"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"è·å–è¯¦ç»†æŒ‡æ ‡"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"è·å–è¯¦ç»†æŒ‡æ ‡"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"n8n-nodes-base.httpRequest"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"typeVersion"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"position"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">800</span><span class="hljs-punctuation">,</span> <span class="hljs-number">100</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"method"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"POST"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http://localhost:5678/rest/audit"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"authentication"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"genericCredentialType"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"genericCredentialType"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"httpBasicAuth"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"responseFormat"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"json"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å®‰å…¨å®¡è®¡æ£€æŸ¥"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å®‰å…¨å®¡è®¡æ£€æŸ¥"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"n8n-nodes-base.httpRequest"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"typeVersion"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"position"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">1050</span><span class="hljs-punctuation">,</span> <span class="hljs-number">100</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"credentials"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"httpBasicAuth"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"your_credential_id"</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"n8n_instance_auth"</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"functionCode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"return {\n  timestamp: new Date().toISOString(),\n  healthStatus: $('æ£€æŸ¥å®ä¾‹å¥åº·çŠ¶æ€').$response.statusCode === 200 ? 'healthy' : 'unhealthy',\n  dbReady: $('æ£€æŸ¥æ•°æ®åº“å‡†å¤‡çŠ¶æ€').$response.statusCode === 200 ? 'ready' : 'not-ready',\n  metricsAvailable: $('è·å–è¯¦ç»†æŒ‡æ ‡').$response.statusCode === 200 ? true : false,\n  auditCompleted: $('å®‰å…¨å®¡è®¡æ£€æŸ¥').json.data ? true : false,\n  summary: 'All monitoring checks completed successfully'\n};"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ ¼å¼åŒ–æŠ¥å‘Š"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ ¼å¼åŒ–æŠ¥å‘Š"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"n8n-nodes-base.function"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"typeVersion"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"position"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">1300</span><span class="hljs-punctuation">,</span> <span class="hljs-number">100</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"webhookUrl"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://hooks.slack.com/services/YOUR/WEBHOOK/URL"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"=JSON.stringify($('æ ¼å¼åŒ–æŠ¥å‘Š').json, null, 2)"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"method"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"POST"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å‘é€é€šçŸ¥"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å‘é€é€šçŸ¥"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"n8n-nodes-base.httpRequest"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"typeVersion"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"position"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">1550</span><span class="hljs-punctuation">,</span> <span class="hljs-number">100</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-30">å·¥ä½œæµå„ä¸ªèŠ‚ç‚¹è¯¦è§£</h4>
<h5 data-id="heading-31">ğŸ“… Scheduleï¼ˆå®šæ—¶è§¦å‘ï¼‰</h5>
<ul>
<li><strong>é…ç½®</strong>ï¼šæ¯å°æ—¶è§¦å‘ä¸€æ¬¡ï¼ˆå¯ä¿®æ”¹ä¸ºæ¯30åˆ†é’Ÿã€æ¯å¤©ç­‰ï¼‰</li>
<li><strong>ä½œç”¨</strong>ï¼šå®šæœŸè¿è¡Œç›‘æ§æ£€æŸ¥</li>
</ul>
<h5 data-id="heading-32">ğŸ” æ£€æŸ¥å®ä¾‹å¥åº·çŠ¶æ€</h5>
<ul>
<li><strong>æ–¹æ³•</strong>ï¼šGET è¯·æ±‚åˆ° <code>/healthz</code></li>
<li><strong>è¿”å›</strong>ï¼šçŠ¶æ€ç  200 è¡¨ç¤ºå®ä¾‹åœ¨çº¿</li>
<li><strong>ä½œç”¨</strong>ï¼šåŸºç¡€å¥åº·æ£€æŸ¥</li>
</ul>
<h5 data-id="heading-33">ğŸ—„ï¸ æ£€æŸ¥æ•°æ®åº“å‡†å¤‡çŠ¶æ€</h5>
<ul>
<li><strong>æ–¹æ³•</strong>ï¼šGET è¯·æ±‚åˆ° <code>/healthz/readiness</code></li>
<li><strong>è¿”å›</strong>ï¼šçŠ¶æ€ç  200 è¡¨ç¤ºæ•°æ®åº“å·²è¿æ¥</li>
<li><strong>ä½œç”¨</strong>ï¼šç¡®ä¿ç³»ç»Ÿå¯ä»¥å¤„ç†ä¸šåŠ¡</li>
</ul>
<h5 data-id="heading-34">ğŸ“ˆ è·å–è¯¦ç»†æŒ‡æ ‡</h5>
<ul>
<li><strong>æ–¹æ³•</strong>ï¼šGET è¯·æ±‚åˆ° <code>/metrics</code></li>
<li><strong>è¿”å›</strong>ï¼šPrometheus æ ¼å¼çš„æŒ‡æ ‡æ•°æ®</li>
<li><strong>ä½œç”¨</strong>ï¼šæ”¶é›†CPUã€å†…å­˜ç­‰è¯¦ç»†ä¿¡æ¯</li>
</ul>
<h5 data-id="heading-35">ğŸ”’ å®‰å…¨å®¡è®¡æ£€æŸ¥</h5>
<ul>
<li><strong>æ–¹æ³•</strong>ï¼šPOST è¯·æ±‚åˆ° <code>/rest/audit</code></li>
<li><strong>è®¤è¯</strong>ï¼šéœ€è¦n8n APIå¯†é’¥</li>
<li><strong>è¿”å›</strong>ï¼šå®Œæ•´çš„å®¡è®¡æŠ¥å‘Šï¼ˆåŒ…å«5ç±»é£é™©ï¼‰</li>
</ul>
<h5 data-id="heading-36">ğŸ“‹ æ ¼å¼åŒ–æŠ¥å‘Š</h5>
<ul>
<li><strong>ç±»å‹</strong>ï¼šFunction èŠ‚ç‚¹</li>
<li><strong>ä½œç”¨</strong>ï¼šæ•´ç†æ‰€æœ‰æ£€æŸ¥ç»“æœï¼Œç”Ÿæˆæ˜“è¯»çš„æŠ¥å‘Š</li>
</ul>
<h5 data-id="heading-37">ğŸ“§ å‘é€é€šçŸ¥</h5>
<ul>
<li><strong>æ–¹æ³•</strong>ï¼šPOST åˆ° Slack Webhook</li>
<li><strong>ä½œç”¨</strong>ï¼šå°†æŠ¥å‘Šå‘é€åˆ°ä½ çš„Slacké¢‘é“æˆ–é‚®ç®±</li>
</ul>
<h4 data-id="heading-38">ğŸ› ï¸ å¦‚ä½•éƒ¨ç½²è¿™ä¸ªå·¥ä½œæµ</h4>
<ol>
<li>
<p><strong>å¤åˆ¶ä¸Šé¢çš„JSONä»£ç </strong></p>
</li>
<li>
<p><strong>æ‰“å¼€ä½ çš„n8nå®ä¾‹</strong>ï¼Œç‚¹å‡»å·¦ä¾§èœå• "Workflows"</p>
</li>
<li>
<p><strong>ç‚¹å‡» "+ New"</strong> åˆ›å»ºæ–°å·¥ä½œæµ</p>
</li>
<li>
<p><strong>ç‚¹å‡»èœå• â†’ Import from URL/File</strong></p>
</li>
<li>
<p><strong>ç²˜è´´JSONä»£ç </strong>ï¼Œç‚¹å‡»Import</p>
</li>
<li>
<p><strong>é…ç½®å¿…è¦çš„å‚æ•°ï¼š</strong></p>
<ul>
<li>å°† <code>http://localhost:5678</code> æ”¹ä¸ºä½ çš„n8nå®ä¾‹åœ°å€</li>
<li>åœ¨"å®‰å…¨å®¡è®¡æ£€æŸ¥"èŠ‚ç‚¹ä¸­æ·»åŠ ä½ çš„n8n APIè®¤è¯</li>
<li>åœ¨"å‘é€é€šçŸ¥"èŠ‚ç‚¹ä¸­ç²˜è´´ä½ çš„Slack Webhook URLï¼ˆæˆ–æ”¹ä¸ºEmailé€šçŸ¥ï¼‰</li>
</ul>
</li>
<li>
<p><strong>æ¿€æ´»å·¥ä½œæµ</strong>ï¼šç‚¹å‡»å³ä¸Šè§’ "Activate" æŒ‰é’®</p>
</li>
<li>
<p><strong>æµ‹è¯•è¿è¡Œ</strong>ï¼šç‚¹å‡» "Execute Workflow" ç«‹å³æµ‹è¯•ä¸€æ¬¡</p>
</li>
</ol>
<h4 data-id="heading-39">ğŸ“ è¾“å‡ºç¤ºä¾‹</h4>
<p>å·¥ä½œæµè¿è¡Œåï¼Œä½ ä¼šæ”¶åˆ°ç±»ä¼¼è¿™æ ·çš„æŠ¥å‘Šï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"timestamp"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025-12-03T10:30:00.000Z"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"healthStatus"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"healthy"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"dbReady"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ready"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"metricsAvailable"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"auditCompleted"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"summary"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"All monitoring checks completed successfully"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h3 data-id="heading-40">ğŸ“š æœ€ä½³å®è·µæ€»ç»“</h3>
<h4 data-id="heading-41">âœ… æ—¥å¿—ç®¡ç†æœ€ä½³å®è·µ</h4>
<ol>
<li>
<p><strong>ç”Ÿäº§ç¯å¢ƒå»ºè®®é…ç½®</strong></p>
<pre><code class="hljs language-bash" lang="bash">N8N_LOG_LEVEL=info
N8N_LOG_OUTPUT=file
N8N_LOG_FILE_SIZE_MAX=50
N8N_LOG_FILE_COUNT_MAX=30
</code></pre>
</li>
<li>
<p><strong>å®šæœŸæ£€æŸ¥æ—¥å¿—</strong>ï¼šæ¯å‘¨æ£€æŸ¥ä¸€æ¬¡ï¼Œçœ‹æ˜¯å¦æœ‰é‡å¤çš„é”™è¯¯</p>
</li>
<li>
<p><strong>åŠæ—¶åˆ é™¤æ—§æ—¥å¿—</strong>ï¼šé˜²æ­¢ç£ç›˜çˆ†æ»¡</p>
</li>
</ol>
<h4 data-id="heading-42">âœ… ç›‘æ§å‘Šè­¦æœ€ä½³å®è·µ</h4>
<ol>
<li>
<p><strong>è®¾ç½®å¤šä¸ªå‘Šè­¦æ¸ é“</strong>ï¼šä¸ä»…Slackï¼Œè¿˜å¯ç”¨é‚®ä»¶ã€SMS</p>
</li>
<li>
<p><strong>è®¾ç½®å‘Šè­¦è§„åˆ™</strong>ï¼š</p>
<ul>
<li>å®ä¾‹å®•æœºç«‹å³å‘Šè­¦</li>
<li>æ•°æ®åº“è¿æ¥å¤±è´¥å‘Šè­¦</li>
<li>å†…å­˜ä½¿ç”¨è¶…è¿‡80%å‘Šè­¦</li>
</ul>
</li>
<li>
<p><strong>å®šæœŸæµ‹è¯•å‘Šè­¦</strong>ï¼šæ¯æœˆæ‰‹åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œç¡®è®¤é€šçŸ¥æ¸ é“ç•…é€š</p>
</li>
</ol>
<h4 data-id="heading-43">âœ… å®‰å…¨å®¡è®¡æœ€ä½³å®è·µ</h4>
<ol>
<li>
<p><strong>å®šæœŸè¿è¡Œå®¡è®¡</strong>ï¼šå»ºè®®æ¯å‘¨è¿è¡Œä¸€æ¬¡</p>
</li>
<li>
<p><strong>åŠæ—¶ä¿®å¤é—®é¢˜</strong>ï¼š</p>
<ul>
<li>åˆ é™¤æœªä½¿ç”¨çš„å‡­è¯</li>
<li>ä¸ºWebhookæ·»åŠ è®¤è¯</li>
<li>æ›´æ–°è¿‡æ—¶çš„å®ä¾‹</li>
</ul>
</li>
<li>
<p><strong>æ–‡æ¡£åŒ–å®‰å…¨å†³ç­–</strong>ï¼šè®°å½•ä¸ºä»€ä¹ˆéœ€è¦æŸä¸ª"å±é™©èŠ‚ç‚¹"ï¼Œä¾¿äºåç»­å®¡æŸ¥</p>
</li>
<li>
<p><strong>å›¢é˜Ÿåä½œ</strong>ï¼šå®šæœŸä¸å›¢é˜Ÿåˆ†äº«å®¡è®¡æŠ¥å‘Šï¼Œæå‡æ•´ä½“å®‰å…¨æ„è¯†</p>
</li>
</ol>
<hr/>
<h3 data-id="heading-44">ğŸ“ å¸¸è§é—®é¢˜è§£ç­”</h3>
<h4 data-id="heading-45">Q1: æ—¥å¿—æ–‡ä»¶ä¼šä¸€ç›´å¢é•¿å—ï¼Ÿ</h4>
<p><strong>A:</strong> ä¸ä¼šã€‚n8nä¼šè‡ªåŠ¨ç®¡ç†æ—¥å¿—æ–‡ä»¶ã€‚å½“æ–‡ä»¶è¾¾åˆ°<code>N8N_LOG_FILE_SIZE_MAX</code>è®¾ç½®çš„å¤§å°æ—¶ï¼Œä¼šè‡ªåŠ¨è½®è½¬ç”Ÿæˆæ–°æ–‡ä»¶ã€‚å½“æ–‡ä»¶æ•°è¾¾åˆ°<code>N8N_LOG_FILE_COUNT_MAX</code>æ—¶ï¼Œä¼šåˆ é™¤æœ€æ—§çš„æ–‡ä»¶ã€‚</p>
<h4 data-id="heading-46">Q2: <code>/metrics</code> ç«¯ç‚¹è¿”å›404æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ</h4>
<p><strong>A:</strong> è¯´æ˜æŒ‡æ ‡åŠŸèƒ½æœªå¯ç”¨ã€‚éœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡ <code>N8N_METRICS=true</code> å¹¶é‡å¯n8nã€‚</p>
<h4 data-id="heading-47">Q3: å®‰å…¨å®¡è®¡çš„"å®˜æ–¹å±é™©èŠ‚ç‚¹"åŒ…æ‹¬å“ªäº›ï¼Ÿ</h4>
<p><strong>A:</strong> ä¸»è¦åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>Execute Command</strong>ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤</li>
<li><strong>Code</strong>ï¼šæ‰§è¡ŒJavaScriptä»£ç </li>
<li><strong>Python</strong>ï¼šæ‰§è¡ŒPythonä»£ç </li>
</ul>
<p>è¿™äº›èŠ‚ç‚¹æœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œä½†å¦‚æœæ¥æ”¶ä¸å—ä¿¡ä»»çš„è¾“å…¥ä¼šæœ‰é£é™©ã€‚</p>
<h4 data-id="heading-48">Q4: å¯ä»¥åªå°†ç‰¹å®šçº§åˆ«çš„æ—¥å¿—å†™å…¥æ–‡ä»¶å—ï¼Ÿ</h4>
<p><strong>A:</strong> ä¸è¡Œã€‚n8nçš„æ—¥å¿—è¾“å‡ºæ˜¯å…¨å±€çš„ï¼Œæ‰€æœ‰çº§åˆ«çš„æ—¥å¿—éƒ½ä¼šåŒæ—¶è¾“å‡ºåˆ°é…ç½®çš„ç›®æ ‡ï¼ˆconsoleå’Œ/æˆ–fileï¼‰ã€‚</p>
<h4 data-id="heading-49">Q5: å¦‚ä½•åœ¨äº‘ç¯å¢ƒï¼ˆå¦‚Kubernetesï¼‰ä¸­å¯ç”¨ç›‘æ§ï¼Ÿ</h4>
<p><strong>A:</strong></p>
<ol>
<li>è®¾ç½®ç¯å¢ƒå˜é‡ï¼š<code>N8N_METRICS=true</code></li>
<li>ç¡®ä¿ <code>/metrics</code> ç«¯ç‚¹å¯è®¿é—®ï¼ˆPrometheus Scrape Targetï¼‰</li>
<li>é…ç½®Kubernetesçš„liveness probeå’Œreadiness probeæŒ‡å‘å¯¹åº”ç«¯ç‚¹</li>
</ol>
<hr/>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.n8n.io%2Fhosting%2Flogging-monitoring%2Flogging%2F" target="_blank" title="https://docs.n8n.io/hosting/logging-monitoring/logging/" ref="nofollow noopener noreferrer">å®˜æ–¹æ–‡æ¡£ - æ—¥å¿—ç®¡ç†</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.n8n.io%2Fhosting%2Flogging-monitoring%2Fmonitoring%2F" target="_blank" title="https://docs.n8n.io/hosting/logging-monitoring/monitoring/" ref="nofollow noopener noreferrer">å®˜æ–¹æ–‡æ¡£ - ç›‘æ§ç³»ç»Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.n8n.io%2Fhosting%2Fsecuring%2Fsecurity-audit%2F" target="_blank" title="https://docs.n8n.io/hosting/securing/security-audit/" ref="nofollow noopener noreferrer">å®˜æ–¹æ–‡æ¡£ - å®‰å…¨å®¡è®¡</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.undsky.com%2Fblog%2F%3Fcategory%3Dn8n%25E6%2595%2599%25E7%25A8%258B%23" target="_blank" title="https://www.undsky.com/blog/?category=n8n%E6%95%99%E7%A8%8B#" ref="nofollow noopener noreferrer">n8nç³»åˆ—æ•™ç¨‹</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Open-AutoGLM éƒ¨ç½²æŒ‡å—ï¼šæœ¬åœ°å¤§æ¨¡å‹æ§åˆ¶ Android æ‰‹æœºè‡ªåŠ¨åŒ–]]></title>    <link>https://juejin.cn/post/7582955784570093619</link>    <guid>https://juejin.cn/post/7582955784570093619</guid>    <pubDate>2025-12-14T02:02:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582955784570093619" data-draft-id="7582599972950343707" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Open-AutoGLM éƒ¨ç½²æŒ‡å—ï¼šæœ¬åœ°å¤§æ¨¡å‹æ§åˆ¶ Android æ‰‹æœºè‡ªåŠ¨åŒ–"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-14T02:02:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº‘èˆŸå–"/> <meta itemprop="url" content="https://juejin.cn/user/360295546233959"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Open-AutoGLM éƒ¨ç½²æŒ‡å—ï¼šæœ¬åœ°å¤§æ¨¡å‹æ§åˆ¶ Android æ‰‹æœºè‡ªåŠ¨åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/360295546233959/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº‘èˆŸå–
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T02:02:47.000Z" title="Sun Dec 14 2025 02:02:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>Open-AutoGLM æ˜¯ä¸€ä¸ªåˆ›æ–°çš„å¼€æºé¡¹ç›®ï¼Œå®ƒå°†æœ¬åœ°/æœåŠ¡å™¨ä¸Šçš„å¤§è¯­è¨€æ¨¡å‹ä¸ Android æ‰‹æœºçš„è‡ªåŠ¨åŒ–æ§åˆ¶ç›¸ç»“åˆï¼Œå®ç°äº†åŸºäºè‡ªç„¶è¯­è¨€æŒ‡ä»¤çš„æ™ºèƒ½è®¾å¤‡æ“ä½œã€‚é€šè¿‡ç»“åˆ vLLM/SGlang é«˜æ€§èƒ½æ¨ç†æ¡†æ¶å’Œ ADB è¿œç¨‹è°ƒè¯•åè®®ï¼Œè¯¥é¡¹ç›®ä¸ºå¼€å‘è€…å’ŒæŠ€æœ¯çˆ±å¥½è€…æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„å¹³å°ï¼Œå¯ä»¥è½»æ¾æ„å»ºå’Œéƒ¨ç½²è·¨è®¾å¤‡çš„æ™ºèƒ½è‡ªåŠ¨åŒ–åº”ç”¨ã€‚</p>
<p>æœ¬æŒ‡å—æ—¨åœ¨ä¸ºç”¨æˆ·æä¾›å®Œæ•´çš„ Open-AutoGLM éƒ¨ç½²æµç¨‹ï¼Œä»ç¡¬ä»¶ç³»ç»Ÿè¦æ±‚åˆ°å…·ä½“å®‰è£…æ­¥éª¤ï¼Œå†åˆ°å¸¸è§é—®é¢˜æ’æŸ¥å’Œè¿›é˜¶æŠ€å·§ï¼Œå¸®åŠ©æ‚¨å¿«é€Ÿä¸Šæ‰‹å¹¶å……åˆ†åˆ©ç”¨è¿™ä¸€æŠ€æœ¯ã€‚æ— è®ºæ‚¨æ˜¯å¸Œæœ›åœ¨æœ¬åœ° PC ä¸Šéƒ¨ç½²å°è§„æ¨¡æµ‹è¯•ç¯å¢ƒï¼Œè¿˜æ˜¯åœ¨æœåŠ¡å™¨ä¸Šæ­å»ºç”Ÿäº§çº§åº”ç”¨ï¼Œæœ¬æŒ‡å—éƒ½å°†ä¸ºæ‚¨æä¾›è¯¦ç»†çš„æŒ‡å¯¼å’Œæœ€ä½³å®è·µã€‚</p>
<h2 data-id="heading-1">ä¸€ã€æ•´ä½“æ¶æ„</h2>
<p>Open-AutoGLM é‡‡ç”¨ã€Œæœ¬åœ° PC/æœåŠ¡å™¨è¿è¡Œå¤§æ¨¡å‹ + ADB è¿œç¨‹æ§åˆ¶ Android æ‰‹æœºã€çš„æ¶æ„ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     HTTP/OpenAI API    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  vLLM/SGlang â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ phone_agent â”‚
â”‚ ï¼ˆæ¨¡å‹æ¨ç†ï¼‰   â”‚                        â”‚ (PythonSDK) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚ ADB (USB/Wi-Fi)
                                               â–¼
                                        Android æ‰‹æœº/æ¨¡æ‹Ÿå™¨
</code></pre>
<p><strong>æ¶æ„è¯´æ˜</strong>ï¼š</p>
<ul>
<li><strong>æ¨ç†ç«¯</strong>ï¼šåœ¨æœ¬åœ° GPU æœåŠ¡å™¨ä¸Šè¿è¡Œ vLLM æˆ– SGlangï¼Œæä¾›ä¸å¤§æ¨¡å‹å¯¹è¯çš„ OpenAI å…¼å®¹ API</li>
<li><strong>æ§åˆ¶ç«¯</strong>ï¼šphone_agent é€šè¿‡ HTTP API ä¸æ¨ç†ç«¯é€šä¿¡ï¼Œä½¿ç”¨ ADB åè®®æ§åˆ¶æ‰‹æœº</li>
<li><strong>è®¾å¤‡ç«¯</strong>ï¼šAndroid æ‰‹æœºé€šè¿‡ ADB æ¥æ”¶æŒ‡ä»¤ï¼Œæ‰§è¡Œè‡ªåŠ¨åŒ–æ“ä½œ</li>
</ul>
<h2 data-id="heading-2">äºŒã€ç¡¬ä»¶ &amp; ç³»ç»Ÿè¦æ±‚</h2>
<h3 data-id="heading-3">2.1 æ¨ç†ç«¯ï¼ˆæœåŠ¡å™¨/PCï¼‰</h3>
<p><strong>æœ€ä½é…ç½®</strong>ï¼š</p>
<ul>
<li><strong>GPU</strong>ï¼šCUDA 12+ å…¼å®¹æ˜¾å¡ï¼ˆæ¨è â‰¥40 GB æ˜¾å­˜ï¼‰
<ul>
<li>NVIDIA RTX 3090/4090ï¼ˆ24GBï¼‰</li>
<li>NVIDIA A100ï¼ˆ40GBï¼‰</li>
<li>æˆ–å…¶ä»– CUDA 12+ å…¼å®¹æ˜¾å¡</li>
</ul>
</li>
<li><strong>å†…å­˜</strong>ï¼šâ‰¥64 GB RAM</li>
<li><strong>å­˜å‚¨</strong>ï¼šâ‰¥100 GB å¯ç”¨ç©ºé—´ï¼ˆç”¨äºæ¨¡å‹ç¼“å­˜ï¼‰</li>
<li><strong>æ“ä½œç³»ç»Ÿ</strong>ï¼šUbuntu 20.04+ / CentOS 7+ / Windows 10+ / macOS 12+</li>
</ul>
<p><strong>æ¨èé…ç½®</strong>ï¼ˆç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰ï¼š</p>
<ul>
<li><strong>GPU</strong>ï¼šåŒå¡ A100 80GB æˆ–å››å¡ 4090</li>
<li><strong>å†…å­˜</strong>ï¼š128 GB RAM</li>
<li><strong>å­˜å‚¨</strong>ï¼šâ‰¥500 GB NVMe</li>
<li><strong>ç½‘ç»œ</strong>ï¼šåƒå…†ç½‘å¡ä»¥ä¸Š</li>
</ul>
<h3 data-id="heading-4">2.2 æ§åˆ¶ç«¯ï¼ˆæ“ä½œç”µè„‘ï¼‰</h3>
<ul>
<li><strong>æ“ä½œç³»ç»Ÿ</strong>ï¼šWindows 10+ / macOS 12+ / Linux ä»»æ„å‘è¡Œç‰ˆ</li>
<li><strong>Python</strong>ï¼š3.10+ï¼ˆæ¨èä½¿ç”¨ conda æˆ– pyenv ç®¡ç†ï¼‰</li>
<li><strong>ADB</strong>ï¼šAndroid Platform Tools 1.x.x</li>
<li><strong>å¯é€‰å·¥å…·</strong>ï¼š
<ul>
<li>scrcpyï¼ˆå±å¹•é•œåƒï¼Œå®æ—¶è§‚å¯Ÿæ‰‹æœºæ“ä½œï¼‰</li>
<li>Android Studioï¼ˆç”¨äºè°ƒè¯•å’Œå¼€å‘è€…é€‰é¡¹ï¼‰</li>
</ul>
</li>
</ul>
<h3 data-id="heading-5">2.3 è®¾å¤‡ç«¯ï¼ˆAndroid æ‰‹æœº/æ¨¡æ‹Ÿå™¨ï¼‰</h3>
<ul>
<li><strong>ç³»ç»Ÿç‰ˆæœ¬</strong>ï¼šAndroid 7.0+ï¼ˆæ¨è Android 10+ï¼‰</li>
<li><strong>å¼€å‘è€…é€‰é¡¹</strong>ï¼šå·²å¯ç”¨</li>
<li><strong>USB è°ƒè¯•</strong>ï¼šå·²å¼€å¯</li>
<li><strong>è¾“å…¥æ³•</strong>ï¼šéœ€å®‰è£… ADB Keyboard</li>
<li><strong>ç½‘ç»œ</strong>ï¼šå¯é€‰ Wi-Fi è°ƒè¯•ï¼ˆç«¯å£ 5555ï¼‰</li>
</ul>
<h2 data-id="heading-6">ä¸‰ã€æœ¬åœ°å®‰è£…è¯¦ç»†æ­¥éª¤</h2>
<h3 data-id="heading-7">3.1 å®‰è£…åŸºç¡€ä¾èµ–ç¯å¢ƒ</h3>
<h4 data-id="heading-8">æ­¥éª¤ 1ï¼šæ£€æŸ¥ Python ç‰ˆæœ¬</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥ Python ç‰ˆæœ¬ï¼ˆéœ€è¦ â‰¥3.10ï¼‰</span>
python --version
python3 --version

<span class="hljs-comment"># å¦‚æœæœªå®‰è£… Python 3.10+ï¼Œè¯·å…ˆå®‰è£…</span>
<span class="hljs-comment"># Ubuntu/Debian:</span>
sudo apt update &amp;&amp; sudo apt install python3.10 python3.10-venv python3.10-distutils

<span class="hljs-comment"># CentOS/RHEL:</span>
sudo yum install python3.10 python3.10-pip python3.10-devel

<span class="hljs-comment"># Windows: ä¸‹è½½å®‰è£… python.org</span>
<span class="hljs-comment"># macOS: ä½¿ç”¨ Homebrew</span>
brew install python@3.10
</code></pre>
<p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p>
<ul>
<li>å»ºè®®ä½¿ç”¨ conda åˆ›å»ºè™šæ‹Ÿç¯å¢ƒä»¥é¿å…ä¾èµ–å†²çª</li>
<li>Windows ç”¨æˆ·éœ€ç¡®ä¿é•¿è·¯å¾„æ”¯æŒï¼ˆå¯ç”¨ <code>fsutil behavior set disablelastaccess 1</code>ï¼‰</li>
</ul>
<h4 data-id="heading-9">æ­¥éª¤ 2ï¼šå…‹éš†ä»“åº“</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…‹éš† Open-AutoGLM ä»“åº“</span>
git <span class="hljs-built_in">clone</span> https://github.com/zai-org/Open-AutoGLM.git
<span class="hljs-built_in">cd</span> Open-AutoGLM

<span class="hljs-comment"># æŸ¥çœ‹åˆ†æ”¯ä¿¡æ¯</span>
git branch -a
git <span class="hljs-built_in">log</span> --oneline -5
</code></pre>
<p><strong>ç›®å½•ç»“æ„è¯´æ˜</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">Open-AutoGLM/
â”œâ”€â”€ main.py              <span class="hljs-comment"># ä¸»ç¨‹åºå…¥å£</span>
â”œâ”€â”€ requirements.txt     <span class="hljs-comment"># Python ä¾èµ–</span>
â”œâ”€â”€ scripts/             <span class="hljs-comment"># è¾…åŠ©è„šæœ¬</span>
â”‚   â”œâ”€â”€ check_deployment_cn.py  <span class="hljs-comment"># éƒ¨ç½²æ£€æŸ¥</span>
â”‚   â””â”€â”€ ...
â”œâ”€â”€ src/                 <span class="hljs-comment"># æºä»£ç </span>
â”œâ”€â”€ models/              <span class="hljs-comment"># æ¨¡å‹å­˜å‚¨ç›®å½•</span>
â””â”€â”€ README.md            <span class="hljs-comment"># å®˜æ–¹æ–‡æ¡£</span>
</code></pre>
<h4 data-id="heading-10">æ­¥éª¤ 3ï¼šåˆ›å»º Python è™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨ conda åˆ›å»ºç¯å¢ƒ</span>
conda create -n autoglm python=3.10 -y
conda activate autoglm

<span class="hljs-comment"># æˆ–ä½¿ç”¨ venv</span>
python3 -m venv autoglm_env
<span class="hljs-built_in">source</span> autoglm_env/bin/activate  <span class="hljs-comment"># Linux/macOS</span>
<span class="hljs-comment"># autoglm_env\Scripts\activate    # Windows</span>
</code></pre>
<h4 data-id="heading-11">æ­¥éª¤ 4ï¼šå®‰è£…è¿è¡Œæ—¶ä¾èµ–</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å‡çº§ pip</span>
pip install --upgrade pip

<span class="hljs-comment"># å®‰è£…åŸºç¡€ä¾èµ–</span>
pip install -r requirements.txt

<span class="hljs-comment"># å®‰è£… Open-AutoGLM æœ¬èº«ï¼ˆå¼€å‘æ¨¡å¼ï¼‰</span>
pip install -e .

<span class="hljs-comment"># éªŒè¯å®‰è£…</span>
python -c <span class="hljs-string">"import phone_agent; print('phone-agent/Open-AutoGLM å®‰è£…æˆåŠŸ')"</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1a1575387f5c4b5c911e06d2e843eb3c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LqR6Iif5ZCW:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766286131&amp;x-signature=vuKLkUonyAdApdR7DhqVTBm2OUQ%3D" alt="" loading="lazy"/></p>
<p><strong>ä¾èµ–è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>vllm</code>ï¼šé«˜æ€§èƒ½æ¨¡å‹æ¨ç†æ¡†æ¶</li>
<li><code>openai</code>ï¼šOpenAI API å®¢æˆ·ç«¯</li>
<li><code>adbutils</code>ï¼šADB è®¾å¤‡ç®¡ç†</li>
<li><code>pillow</code>ï¼šå›¾åƒå¤„ç†</li>
<li><code>numpy</code>ï¼šæ•°å€¼è®¡ç®—</li>
<li><code>requests</code>ï¼šHTTP è¯·æ±‚</li>
</ul>
<h3 data-id="heading-12">3.2 é…ç½® ADB è°ƒè¯•ç¯å¢ƒ</h3>
<h4 data-id="heading-13">æ­¥éª¤ 1ï¼šä¸‹è½½ Android Platform Tools</h4>
<p><strong>æ–¹å¼ Aï¼šç›´æ¥ä¸‹è½½</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºç›®å½•</span>
<span class="hljs-built_in">mkdir</span> -p ~/android-sdk/platform-tools
<span class="hljs-built_in">cd</span> ~/android-sdk

<span class="hljs-comment"># ä¸‹è½½ platform-toolsï¼ˆLinux/macOSï¼‰</span>
wget https://dl.google.com/android/repository/platform-tools-latest-linux.zip

<span class="hljs-comment"># è§£å‹</span>
unzip platform-tools-latest-linux.zip
</code></pre>
<p><strong>æ–¹å¼ Bï¼šä½¿ç”¨ SDK Manager</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£… Android SDK Command-line Tools</span>
wget https://dl.google.com/android/repository/commandlinetools-latest-linux.zip
unzip commandlinetools-latest-linux.zip -d ~/android-sdk
</code></pre>
<h4 data-id="heading-14">æ­¥éª¤ 2ï¼šé…ç½®ç¯å¢ƒå˜é‡</h4>
<p><strong>Linuxï¼ˆ~/.bashrc æˆ– ~/.zshrcï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">export</span> ANDROID_HOME=<span class="hljs-variable">$HOME</span>/android-sdk
<span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$ANDROID_HOME</span>/platform-tools
<span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$ANDROID_HOME</span>/emulator
<span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$ANDROID_HOME</span>/tools
<span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$ANDROID_HOME</span>/tools/bin
</code></pre>
<p><strong>Windowsï¼ˆç³»ç»Ÿå±æ€§ -&gt; ç¯å¢ƒå˜é‡ï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">å˜é‡åï¼šANDROID_HOME
å˜é‡å€¼ï¼šC:\Users\YourName\android-sdk

Path æ·»åŠ ï¼š
%ANDROID_HOME%\platform-tools
%ANDROID_HOME%\emulator
%ANDROID_HOME%\tools
%ANDROID_HOME%\tools\bin
</code></pre>
<p><strong>macOSï¼ˆ~/.zshrcï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">export</span> ANDROID_HOME=~/android-sdk
<span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$ANDROID_HOME</span>/platform-tools
<span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$ANDROID_HOME</span>/emulator
<span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$ANDROID_HOME</span>/tools
<span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$ANDROID_HOME</span>/tools/bin
</code></pre>
<h4 data-id="heading-15">æ­¥éª¤ 3ï¼šéªŒè¯ ADB å®‰è£…</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥ ADB ç‰ˆæœ¬</span>
adb version

<span class="hljs-comment"># åº”æ˜¾ç¤ºç±»ä¼¼ï¼š</span>
<span class="hljs-comment"># Android Debug Bridge version 1.x.x</span>
<span class="hljs-comment"># Version 31.0.1 etc.</span>

<span class="hljs-comment"># æµ‹è¯• ADB è¿æ¥</span>
adb devices
<span class="hljs-comment"># åº”æ˜¾ç¤ºï¼šList of devices attachedï¼ˆæ— è®¾å¤‡æ˜¯æ­£å¸¸çš„ï¼‰</span>
</code></pre>
<p><strong>å¸¸è§é—®é¢˜</strong>ï¼š</p>
<ul>
<li>å¦‚æœæç¤º <code>command not found</code>ï¼Œè¯·æ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®é…ç½®</li>
<li>Windows ç”¨æˆ·å¯èƒ½éœ€è¦å®‰è£… Android USB é©±åŠ¨</li>
</ul>
<h3 data-id="heading-16">3.3 æ‰‹æœºç«¯å‡†å¤‡</h3>
<h4 data-id="heading-17">æ­¥éª¤ 1ï¼šå¯ç”¨å¼€å‘è€…é€‰é¡¹</h4>
<ol>
<li>
<p><strong>å¼€å¯å¼€å‘è€…æ¨¡å¼</strong></p>
<ul>
<li>è¿›å…¥ã€Œè®¾ç½®ã€â†’ã€Œå…³äºæ‰‹æœºã€</li>
<li>è¿ç»­ç‚¹å‡»ã€Œç‰ˆæœ¬å·ã€çº¦ 7-10 æ¬¡</li>
<li>ä¼šæç¤ºã€Œæ‚¨å·²å¤„äºå¼€å‘è€…æ¨¡å¼ã€</li>
</ul>
</li>
<li>
<p><strong>éªŒè¯å¼€å‘è€…é€‰é¡¹</strong></p>
<ul>
<li>è¿›å…¥ã€Œè®¾ç½®ã€â†’ã€Œç³»ç»Ÿã€â†’ã€Œå¼€å‘è€…é€‰é¡¹ã€</li>
<li>ç¡®ä¿å¯ä»¥çœ‹åˆ°å„ç§è°ƒè¯•é€‰é¡¹</li>
</ul>
</li>
</ol>
<h4 data-id="heading-18">æ­¥éª¤ 2ï¼šå¯ç”¨ USB è°ƒè¯•</h4>
<ol>
<li>
<p><strong>æ‰“å¼€ USB è°ƒè¯•</strong></p>
<ul>
<li>è¿›å…¥ã€Œè®¾ç½®ã€â†’ã€Œç³»ç»Ÿã€â†’ã€Œå¼€å‘è€…é€‰é¡¹ã€</li>
<li>æ‰¾åˆ°ã€ŒUSB è°ƒè¯•ã€é€‰é¡¹å¹¶å‹¾é€‰</li>
</ul>
</li>
<li>
<p><strong>é…ç½® USB è°ƒè¯•é€‰é¡¹</strong>ï¼ˆæ¨èï¼‰</p>
<ul>
<li>å‹¾é€‰ã€ŒUSB è°ƒè¯•ï¼ˆå®‰å…¨è®¾ç½®ï¼‰ã€</li>
<li>å‹¾é€‰ã€Œé€šè¿‡ USB å®‰è£…åº”ç”¨ã€</li>
<li>å‹¾é€‰ã€ŒUSB é…ç½®ã€</li>
</ul>
</li>
</ol>
<p><strong>ä¸åŒå“ç‰Œç‰¹æ®Šè¯´æ˜</strong>ï¼š</p>
<ul>
<li><strong>å°ç±³/MIUI</strong>ï¼šéœ€è¦åœ¨ã€Œå¼€å‘è€…é€‰é¡¹ã€é‡Œæ‰¾åˆ°ã€ŒUSB è°ƒè¯•ï¼ˆå®‰å…¨è®¾ç½®ï¼‰ã€å¹¶å•ç‹¬å‹¾é€‰</li>
<li><strong>åä¸º/EMUI</strong>ï¼šå¯èƒ½éœ€è¦åœ¨ã€Œè®¾ç½®ã€â†’ã€Œç³»ç»Ÿå’Œæ›´æ–°ã€â†’ã€Œå¼€å‘è€…é€‰é¡¹ã€ä¸­å¯ç”¨</li>
<li><strong>ä¸‰æ˜Ÿ</strong>ï¼šOne UI ä¸­å¼€å‘è€…é€‰é¡¹ä½ç½®å¯èƒ½ä¸åŒ</li>
</ul>
<h4 data-id="heading-19">æ­¥éª¤ 3ï¼šè¿æ¥æ‰‹æœºåˆ°ç”µè„‘</h4>
<ol>
<li>
<p><strong>ä½¿ç”¨ USB æ•°æ®çº¿è¿æ¥</strong></p>
<ul>
<li>ä½¿ç”¨åŸè£…æˆ–é«˜è´¨é‡æ•°æ®çº¿</li>
<li>ç¡®ä¿æ•°æ®çº¿æ”¯æŒæ•°æ®ä¼ è¾“ï¼ˆéä»…å……ç”µï¼‰</li>
</ul>
</li>
<li>
<p><strong>éªŒè¯è¿æ¥</strong></p>
</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥è®¾å¤‡è¿æ¥çŠ¶æ€</span>
adb devices

<span class="hljs-comment"># åº”æ˜¾ç¤ºç±»ä¼¼ï¼š</span>
<span class="hljs-comment"># List of devices attached</span>
<span class="hljs-comment"># device_id    device</span>

<span class="hljs-comment"># å¦‚æœæ— è®¾å¤‡ï¼Œå°è¯•ï¼š</span>
<span class="hljs-comment"># 1. æ›´æ¢ USB ç«¯å£</span>
<span class="hljs-comment"># 2. é‡æ–°æ’æ‹”æ•°æ®çº¿</span>
<span class="hljs-comment"># 3. åœ¨æ‰‹æœºä¸Šç¡®è®¤ USB è°ƒè¯•æˆæƒå¯¹è¯æ¡†</span>
</code></pre>
<ol start="3">
<li><strong>æˆæƒè°ƒè¯•</strong>
<ul>
<li>é¦–æ¬¡è¿æ¥æ—¶ï¼Œæ‰‹æœºä¼šå¼¹å‡ºã€Œå…è®¸ USB è°ƒè¯•å—ï¼Ÿã€å¯¹è¯æ¡†</li>
<li>å‹¾é€‰ã€Œå§‹ç»ˆå…è®¸æ¥è‡ªè¿™å°è®¡ç®—æœºçš„ USB è°ƒè¯•ã€</li>
<li>ç‚¹å‡»ã€Œç¡®å®šã€</li>
</ul>
</li>
</ol>
<h4 data-id="heading-20">æ­¥éª¤ 4ï¼šå®‰è£…å¹¶é…ç½® ADB Keyboard</h4>
<ol>
<li><strong>ä¸‹è½½ ADB Keyboard</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨ adb å®‰è£…</span>
adb shell pm install -r /path/to/ADBKeyboard.apk

<span class="hljs-comment"># æˆ–è®©è„šæœ¬è‡ªåŠ¨å®‰è£…ï¼ˆé¦–æ¬¡è¿è¡Œæ—¶ä¼šè‡ªåŠ¨å¤„ç†ï¼‰</span>
</code></pre>
<ol start="2">
<li>
<p><strong>å¯ç”¨ ADB Keyboard</strong></p>
<ul>
<li>è¿›å…¥ã€Œè®¾ç½®ã€â†’ã€Œç³»ç»Ÿã€â†’ã€Œè¯­è¨€å’Œè¾“å…¥æ³•ã€</li>
<li>æ‰¾åˆ°ã€ŒADB Keyboardã€å¹¶å¯ç”¨</li>
<li>è®¾ä¸ºé»˜è®¤è¾“å…¥æ³•ï¼ˆå¯é€‰ä½†æ¨èï¼‰</li>
</ul>
</li>
<li>
<p><strong>éªŒè¯ ADB Keyboard</strong></p>
</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æµ‹è¯•è¾“å…¥</span>
adb shell input text <span class="hljs-string">"Hello World"</span>

<span class="hljs-comment"># åº”è¯¥èƒ½åœ¨æ‰‹æœºä¸Šçœ‹åˆ°æ–‡æœ¬è¾“å…¥</span>
</code></pre>
<h3 data-id="heading-21">3.4 ä¸‹è½½å¹¶å¯åŠ¨æ¨¡å‹</h3>
<p>Open-AutoGLM æ”¯æŒå¤šç§æ¨¡å‹éƒ¨ç½²æ–¹å¼ï¼Œæ ¹æ®æ‚¨çš„ç¡¬ä»¶æƒ…å†µé€‰æ‹©åˆé€‚çš„æ–¹å¼ã€‚</p>
<h4 data-id="heading-22">æ–¹å¼ Aï¼šæœ¬åœ° vLLM éƒ¨ç½²ï¼ˆæ¨èï¼Œéœ€è¦ GPUï¼‰</h4>
<p><strong>æ­¥éª¤ 1ï¼šå®‰è£… vLLM</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£… vLLMï¼ˆæ”¯æŒ CUDA 12+ï¼‰</span>
pip install vllm

<span class="hljs-comment"># éªŒè¯å®‰è£…</span>
pip show vllm æˆ– vllm --version
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7f885c8063c4df3bbbe28522eab8cc0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LqR6Iif5ZCW:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766286131&amp;x-signature=RIFlK6h6edQTNUReP3GKqbLZTHY%3D" alt="" loading="lazy"/></p>
<p><strong>æ­¥éª¤ 2ï¼šä¸‹è½½æ¨¡å‹</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºæ¨¡å‹ç›®å½•</span>
<span class="hljs-built_in">mkdir</span> -p models/autoglm-phone-9b

<span class="hljs-comment"># ä¸‹è½½æ¨¡å‹ï¼ˆçº¦ 20GBï¼‰</span>
<span class="hljs-comment"># æ–¹å¼ 1ï¼šä½¿ç”¨ HuggingFace CLI</span>
huggingface-cli download zai-org/AutoGLM-Phone-9B \
  --local-dir models/autoglm-phone-9b \
  --local-dir-use-symlinks False

<span class="hljs-comment"># æ–¹å¼ 2ï¼šä½¿ç”¨ git clone</span>
git <span class="hljs-built_in">clone</span> https://huggingface.co/zai-org/AutoGLM-Phone-9B \
  models/autoglm-phone-9b
</code></pre>
<p><strong>æ­¥éª¤ 3ï¼šå¯åŠ¨ vLLM æœåŠ¡å™¨</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åŸºç¡€å¯åŠ¨å‘½ä»¤</span>
python3 -m vllm.entrypoints.openai.api_server \
  --served-model-name autoglm-phone-9b \
  --model models/autoglm-phone-9b \
  --port 8000 \
  --host 0.0.0.0

<span class="hljs-comment"># æ¨èçš„ç”Ÿäº§ç¯å¢ƒé…ç½®</span>
python3 -m vllm.entrypoints.openai.api_server \
  --served-model-name autoglm-phone-9b \
  --allowed-local-media-path / \
  --mm-encoder-tp-mode data \
  --mm_processor_cache_type shm \
  --mm_processor_kwargs <span class="hljs-string">'{"max_pixels":5000000}'</span> \
  --max-model-len 25480 \
  --chat-template-content-format string \
  --limit-mm-per-prompt <span class="hljs-string">'{"image":10}'</span> \
  --model models/autoglm-phone-9b \
  --port 8000 \
  --host 0.0.0.0 \
  --tensor-parallel-size 1 \
  --max-num-seqs 256 \
  --max-num-batched-tokens 8192
</code></pre>
<p><strong>å‚æ•°è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>--served-model-name</code>ï¼šæœåŠ¡åç§°ï¼Œç”¨äº API è°ƒç”¨</li>
<li><code>--model</code>ï¼šæ¨¡å‹æœ¬åœ°è·¯å¾„æˆ– HuggingFace ID</li>
<li><code>--port</code>ï¼šAPI æœåŠ¡ç«¯å£</li>
<li><code>--host</code>ï¼šç›‘å¬åœ°å€ï¼Œ0.0.0.0 è¡¨ç¤ºæ‰€æœ‰ç½‘å¡</li>
<li><code>--mm-encoder-tp-mode</code>ï¼šå¤šæ¨¡æ€ç¼–ç å™¨å¼ é‡å¹¶è¡Œæ¨¡å¼</li>
<li><code>--max-model-len</code>ï¼šæœ€å¤§åºåˆ—é•¿åº¦</li>
<li><code>--tensor-parallel-size</code>ï¼šå¼ é‡å¹¶è¡Œå¤§å°ï¼ˆå•å¡=1ï¼ŒåŒå¡=2ï¼‰</li>
</ul>
<p><strong>æ­¥éª¤ 4ï¼šéªŒè¯æ¨¡å‹æœåŠ¡</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨å®˜æ–¹æ£€æŸ¥è„šæœ¬</span>
python scripts/check_deployment_cn.py \
  --base-url http://localhost:8000/v1 \
  --model autoglm-phone-9b

<span class="hljs-comment"># æˆ–ä½¿ç”¨ curl ç›´æ¥æµ‹è¯•</span>
curl http://localhost:8000/v1/chat/completions \
  -H <span class="hljs-string">"Content-Type: application/json"</span> \
  -d <span class="hljs-string">'{
    "model": "autoglm-phone-9b",
    "messages": [
      {"role": "user", "content": "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹è‡ªå·±"}
    ],
    "temperature": 0.7,
    "max_tokens": 512
  }'</span>
</code></pre>
<p><strong>é¢„æœŸè¾“å‡º</strong>ï¼š</p>
<pre><code class="hljs language-erlang" lang="erlang">âœ… æ¨¡å‹æœåŠ¡æ­£å¸¸
æ€è€ƒï¼šæˆ‘éœ€è¦ï¼š<span class="hljs-number">1</span>. å…ˆå¯åŠ¨äº¬ä¸œ...
</code></pre>
<h4 data-id="heading-23">æ–¹å¼ Bï¼šä½¿ç”¨äº‘ç«¯ APIï¼ˆæ— æœ¬åœ° GPUï¼‰</h4>
<p>å¦‚æœæ‚¨æ²¡æœ‰æœ¬åœ° GPUï¼Œå¯ä»¥ä½¿ç”¨æ™ºè°±å¼€æ”¾å¹³å°çš„ APIã€‚</p>
<p><strong>æ­¥éª¤ 1ï¼šæ³¨å†Œå¹¶è·å– API Key</strong></p>
<ol>
<li>è®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.bigmodel.cn%2F" target="_blank" title="https://open.bigmodel.cn/" ref="nofollow noopener noreferrer">æ™ºè°±å¼€æ”¾å¹³å°</a></li>
<li>æ³¨å†Œè´¦å·å¹¶ç™»å½•</li>
<li>è¿›å…¥ã€ŒAPI å¯†é’¥ã€é¡µé¢è·å– API Key</li>
</ol>
<p><strong>æ­¥éª¤ 2ï¼šä½¿ç”¨ API éƒ¨ç½²</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç›´æ¥ä½¿ç”¨ main.pyï¼ŒæŒ‡å®šäº‘ç«¯ API</span>
python main.py \
  --base-url https://open.bigmodel.cn/api/paas/v4 \
  --model autoglm-phone-9b \
  --api-key YOUR_API_KEY_HERE
</code></pre>
<p><strong>ç¯å¢ƒå˜é‡é…ç½®</strong>ï¼ˆå¯é€‰ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">export</span> OPENAI_API_KEY=YOUR_API_KEY_HERE
<span class="hljs-built_in">export</span> OPENAI_BASE_URL=https://open.bigmodel.cn/api/paas/v4
</code></pre>
<h3 data-id="heading-24">3.5 éªŒè¯å®Œæ•´éƒ¨ç½²</h3>
<h4 data-id="heading-25">æµ‹è¯• 1ï¼šæ¨¡å‹æ¨ç†æµ‹è¯•</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºæµ‹è¯•è„šæœ¬ cat test_model.py</span>
python &lt;&lt; <span class="hljs-string">'EOF'</span>
from openai import OpenAI

client = OpenAI(
    base_url=<span class="hljs-string">"http://localhost:8000/v1"</span>,
    api_key=<span class="hljs-string">"dummy"</span>  <span class="hljs-comment"># æœ¬åœ°éƒ¨ç½²å¯ä½¿ç”¨ä»»æ„å¯†é’¥</span>
)

response = client.chat.completions.create(
    model=<span class="hljs-string">"autoglm-phone-9b"</span>,
    messages=[
        {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ å¥½ï¼Œè¯·ç®€å•ä»‹ç»ä¸€ä¸‹è‡ªå·±"</span>}
    ],
    temperature=0.7,
    max_tokens=256
)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ¨¡å‹å›å¤ï¼š"</span>, response.choices[0].message.content)
EOF

python test_model.py
</code></pre>
<h4 data-id="heading-26">æµ‹è¯• 2ï¼šADB è®¾å¤‡æµ‹è¯•</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æµ‹è¯• ADB è¿æ¥</span>
adb devices

<span class="hljs-comment"># æµ‹è¯•è¾“å…¥</span>
adb shell input text <span class="hljs-string">"æµ‹è¯•è¾“å…¥"</span>

<span class="hljs-comment"># æµ‹è¯•æˆªå›¾</span>
adb shell screencap -p /sdcard/screenshot.png
<span class="hljs-comment"># æ‹‰å–æˆªå›¾åˆ°ç”µè„‘</span>
adb pull /sdcard/screenshot.png ./screenshot.png
</code></pre>
<h4 data-id="heading-27">æµ‹è¯• 3ï¼šå®Œæ•´é›†æˆæµ‹è¯•</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># äº¤äº’æ¨¡å¼æµ‹è¯•</span>
python main.py \
  --base-url http://localhost:8000/v1 \
  --model autoglm-phone-9b

<span class="hljs-comment"># åœ¨æç¤ºç¬¦åè¾“å…¥æµ‹è¯•å‘½ä»¤</span>
&gt; æ‰“å¼€è®¡ç®—å™¨ï¼Œè®¡ç®— 123+456
&gt; æ‰“å¼€å¾®ä¿¡ï¼Œç»™<span class="hljs-string">"æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹"</span>å‘é€<span class="hljs-string">"ä½ å¥½"</span>
</code></pre>
<hr/>
<h2 data-id="heading-28">å››ã€å¸¸è§é—®é¢˜ä¸æ’æŸ¥</h2>













































<table><thead><tr><th>ç—‡çŠ¶</th><th>å¯èƒ½åŸå› </th><th>è¯¦ç»†å¤„ç†åŠæ³•</th></tr></thead><tbody><tr><td><code>adb devices</code> æ— è®¾å¤‡</td><td>1. æ•°æ®çº¿ä»…å……ç”µ<br/>2. é©±åŠ¨æœªè£…<br/>3. è°ƒè¯•æœªå¼€</td><td>1. æ›´æ¢æ•°æ®çº¿ä¸ºæ•°æ®ä¼ è¾“çº¿<br/>2. Windows: å®‰è£… Android USB é©±åŠ¨<br/>3. ç¡®è®¤å¼€å‘è€…é€‰é¡¹å’Œ USB è°ƒè¯•å·²å¼€å¯</td></tr><tr><td>æ¨¡å‹å¯åŠ¨ OOM</td><td>1. æ˜¾å­˜ä¸è¶³<br/>2. å…±äº«å†…å­˜æœªé…ç½®</td><td>1. å‡å° <code>--max-model-len</code>ï¼ˆå¦‚æ”¹ä¸º 8192ï¼‰<br/>2. ä½¿ç”¨ 4bit/8bit é‡åŒ–<br/>3. å¢åŠ  <code>--mm_processor_cache_type</code> é…ç½®</td></tr><tr><td>æˆªå›¾é»‘å±</td><td>1. åº”ç”¨å¤„äºéšç§é¡µé¢<br/>2. æ”¯ä»˜é¡µé¢<br/>3. æˆªå›¾æƒé™è¢«æ‹’</td><td>1. Agent ä¼šè‡ªåŠ¨è¯·æ±‚äººå·¥æ¥ç®¡<br/>2. æ‰‹åŠ¨æ“ä½œåç»§ç»­è‡ªåŠ¨åŒ–<br/>3. æ£€æŸ¥æ‰‹æœºæˆªå›¾æƒé™è®¾ç½®</td></tr><tr><td>æ–‡æœ¬è¾“å…¥æ— æ•ˆ</td><td>1. æœªå¯ç”¨ ADB Keyboard<br/>2. è¾“å…¥æ³•é…ç½®é”™è¯¯</td><td>1. åœ¨æ‰‹æœºè®¾ç½®-è¾“å…¥æ³•ä¸­å‹¾é€‰ ADB Keyboard<br/>2. é‡å¯è¾“å…¥æ³•æœåŠ¡<br/>3. ç¡®è®¤ ADB Keyboard æœ‰é»˜è®¤æƒé™</td></tr><tr><td>Wi-Fi è¿œç¨‹ ADB å¤±è´¥</td><td>1. é˜²ç«å¢™é˜»æ‹¦ 5555 ç«¯å£<br/>2. æ‰‹æœºå’Œç”µè„‘ä¸åœ¨åŒä¸€ç½‘æ®µ</td><td>1. æ”¾è¡Œ 5555 ç«¯å£ï¼ˆWindows é˜²ç«å¢™ã€macOS é˜²ç«å¢™ï¼‰<br/>2. ç¡®ä¿è®¾å¤‡åœ¨åŒä¸€ Wi-Fi ç½‘ç»œ<br/>3. æ”¹ç”¨ USB è¿æ¥</td></tr><tr><td>vLLM å¯åŠ¨å¤±è´¥</td><td>1. CUDA ç‰ˆæœ¬ä¸å…¼å®¹<br/>2. æ¨¡å‹è·¯å¾„é”™è¯¯<br/>3. ä¾èµ–ç¼ºå¤±</td><td>1. æ£€æŸ¥ CUDA ç‰ˆæœ¬ï¼ˆéœ€è¦ 12+ï¼‰<br/>2. ç¡®è®¤æ¨¡å‹è·¯å¾„æ­£ç¡®<br/>3. é‡æ–°å®‰è£… vllm å’Œç›¸å…³ä¾èµ–</td></tr><tr><td>æ¨¡å‹æ¨ç†æ— å“åº”</td><td>1. API åœ°å€é”™è¯¯<br/>2. æ¨¡å‹æœªæ­£ç¡®åŠ è½½<br/>3. è¯·æ±‚è¶…æ—¶</td><td>1. æ£€æŸ¥ <code>--base-url</code> å’Œç«¯å£<br/>2. æŸ¥çœ‹å¯åŠ¨æ—¥å¿—<br/>3. å¢åŠ  <code>--max-num-seqs</code> é…ç½®</td></tr></tbody></table>
<h3 data-id="heading-29">è¯¦ç»†æ’æŸ¥æ­¥éª¤</h3>
<h4 data-id="heading-30">é—®é¢˜ 1ï¼šADB è¿æ¥é—®é¢˜</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æ£€æŸ¥ USB æ•°æ®çº¿</span>
<span class="hljs-comment"># å°è¯•æ›´æ¢ USB ç«¯å£å’Œæ•°æ®çº¿</span>

<span class="hljs-comment"># 2. é‡ç½® ADB</span>
adb kill-server
adb start-server
adb devices

<span class="hljs-comment"># 3. æ£€æŸ¥æ‰‹æœºç«¯æˆæƒ</span>
<span class="hljs-comment"># æ‰‹æœºä¸Šåº”è¯¥å¼¹å‡º"å…è®¸ USB è°ƒè¯•"å¯¹è¯æ¡†</span>

<span class="hljs-comment"># 4. å¼ºåˆ¶é‡æ–°è¿æ¥</span>
adb disconnect
adb connect 127.0.0.1:5555  <span class="hljs-comment"># å¦‚æœä½¿ç”¨ Wi-Fi</span>
</code></pre>
<h4 data-id="heading-31">é—®é¢˜ 2ï¼šæ˜¾å­˜ä¸è¶³</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥æ˜¾å­˜ä½¿ç”¨</span>
nvidia-smi

<span class="hljs-comment"># è°ƒæ•´ vLLM å‚æ•°</span>
python3 -m vllm.entrypoints.openai.api_server \
  --model models/autoglm-phone-9b \
  --port 8000 \
  --max-model-len 8192 \        <span class="hljs-comment"># å‡å°åºåˆ—é•¿åº¦</span>
  --mm_processor_kwargs <span class="hljs-string">'{"max_pixels":2000000}'</span> \  <span class="hljs-comment"># å‡å°å›¾åƒå¤„ç†åˆ†è¾¨ç‡</span>
  --quantization awq \           <span class="hljs-comment"># ä½¿ç”¨ AWQ é‡åŒ–ï¼ˆå¦‚æœæ”¯æŒï¼‰</span>
  --tensor-parallel-size 1       <span class="hljs-comment"># å•å¡è¿è¡Œ</span>
</code></pre>
<h4 data-id="heading-32">é—®é¢˜ 3ï¼šæ¨¡å‹åŠ è½½å¤±è´¥</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥æ¨¡å‹æ–‡ä»¶å®Œæ•´æ€§</span>
<span class="hljs-built_in">ls</span> -lh models/autoglm-phone-9b/
<span class="hljs-comment"># åº”è¯¥çœ‹åˆ° config.json, pytorch_model.bin ç­‰æ–‡ä»¶</span>

<span class="hljs-comment"># é‡æ–°ä¸‹è½½æ¨¡å‹</span>
<span class="hljs-built_in">rm</span> -rf models/autoglm-phone-9b
huggingface-cli download zai-org/AutoGLM-Phone-9B \
  --local-dir models/autoglm-phone-9b \
  --local-dir-use-symlinks False

<span class="hljs-comment"># æ£€æŸ¥æ¨¡å‹æ ¼å¼</span>
file models/autoglm-phone-9b/pytorch_model.bin
</code></pre>
<h2 data-id="heading-33">äº”ã€è¿›é˜¶æŠ€å·§</h2>
<h3 data-id="heading-34">5.1 ä½¿ç”¨ Wi-Fi è¿œç¨‹è°ƒè¯•ï¼ˆæ— éœ€ USBï¼‰</h3>
<p>é€šè¿‡ Wi-Fi è¿æ¥å¯ä»¥æ‘†è„±æ•°æ®çº¿æŸç¼šï¼Œæ›´é€‚åˆé•¿æœŸè¿è¡Œã€‚</p>
<p><strong>æ­¥éª¤ 1ï¼šæ‰‹æœºç«¯å¼€å¯ Wi-Fi è°ƒè¯•</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨æ‰‹æœºä¸Šæ‰§è¡Œï¼ˆé€šè¿‡ adb shellï¼‰</span>
adb shell settings put global adb_wifi_enabled 1

<span class="hljs-comment"># æˆ–åœ¨æ‰‹æœºç«¯å¼€å¯ TCP/IP æ¨¡å¼</span>
adb tcpip 5555
</code></pre>
<p><strong>æ­¥éª¤ 2ï¼šç”µè„‘ç«¯è¿æ¥</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹æ‰‹æœº IP åœ°å€ï¼ˆæ‰‹æœºä¸Šæ‰§è¡Œï¼‰</span>
adb shell netcfg | grep wlan0

<span class="hljs-comment"># ç”µè„‘ç«¯è¿æ¥</span>
adb connect 192.168.1.100:5555

<span class="hljs-comment"># éªŒè¯è¿æ¥</span>
adb devices
</code></pre>
<p><strong>æ­¥éª¤ 3ï¼šè¿è¡Œ Open-AutoGLM</strong></p>
<pre><code class="hljs language-bash" lang="bash">python main.py \
  --base-url http://localhost:8000/v1 \
  --model autoglm-phone-9b \
  --device-id 192.168.1.100:5555
</code></pre>
<p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p>
<ul>
<li>ç¡®ä¿æ‰‹æœºå’Œç”µè„‘åœ¨åŒä¸€ Wi-Fi ç½‘ç»œ</li>
<li>é˜²ç«å¢™éœ€æ”¾è¡Œ 5555 ç«¯å£</li>
<li>è¿æ¥å¯èƒ½ä¸å¦‚ USB ç¨³å®š</li>
</ul>
<h3 data-id="heading-35">5.2 å¤š GPU å¼ é‡å¹¶è¡Œ</h3>
<p>å¯¹äºå¤šå¡æœåŠ¡å™¨ï¼Œå¯ä»¥ä½¿ç”¨å¼ é‡å¹¶è¡Œå¤§å¹…é™ä½æ˜¾å­˜å ç”¨ã€‚</p>
<p><strong>é…ç½®ç¤ºä¾‹ï¼ˆåŒå¡ A100 80GBï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python3 -m vllm.entrypoints.openai.api_server \
  --served-model-name autoglm-phone-9b \
  --model models/autoglm-phone-9b \
  --port 8000 \
  --host 0.0.0.0 \
  --tensor-parallel-size 2 \        <span class="hljs-comment"># ä½¿ç”¨ 2 å¼ å¡</span>
  --mm-encoder-tp-mode data \       <span class="hljs-comment"># å¤šæ¨¡æ€ç¼–ç å™¨ä¹Ÿä½¿ç”¨æ•°æ®å¹¶è¡Œ</span>
  --max-model-len 25480 \
  --mm_processor_kwargs <span class="hljs-string">'{"max_pixels":5000000}'</span> \
  --chat-template-content-format string \
  --limit-mm-per-prompt <span class="hljs-string">'{"image":10}'</span>
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼š</p>
<ul>
<li>æ˜¾å­˜å ç”¨é™ä½çº¦ 50%</li>
<li>æ¨ç†é€Ÿåº¦æå‡çº¦ 30-50%</li>
<li>é€‚åˆ 80GB+ çš„å¤§æ¨¡å‹</li>
</ul>
<p><strong>å››å¡é…ç½®</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">--tensor-parallel-size 4 \
--mm-encoder-tp-mode data \
</code></pre>
<h3 data-id="heading-36">5.3 é‡åŒ–ä¸ä½æˆæœ¬éƒ¨ç½²</h3>
<h4 data-id="heading-37">é€‰é¡¹ 1ï¼šä½¿ç”¨ llama.cpp</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¼–è¯‘ llama.cpp</span>
git <span class="hljs-built_in">clone</span> https://github.com/ggerganov/llama.cpp
<span class="hljs-built_in">cd</span> llama.cpp
make LLAMA_CUBLAS=1

<span class="hljs-comment"># ä¸‹è½½ GGUF æ ¼å¼æ¨¡å‹</span>
<span class="hljs-comment"># ï¼ˆéœ€è¦ç­‰å¾…å®˜æ–¹å‘å¸ƒæˆ–è‡ªè¡Œè½¬æ¢ï¼‰</span>

<span class="hljs-comment"># è¿è¡Œ</span>
./main -m model.gguf -p <span class="hljs-string">"ä½ å¥½"</span>
</code></pre>
<h4 data-id="heading-38">é€‰é¡¹ 2ï¼šä½¿ç”¨ 4bit/8bit é‡åŒ–</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># vLLM è‡ªåŠ¨é‡åŒ–ï¼ˆå¦‚æœæ”¯æŒï¼‰</span>
python3 -m vllm.entrypoints.openai.api_server \
  --model models/autoglm-phone-9b \
  --port 8000 \
  --quantization awq \    <span class="hljs-comment"># æˆ– exllama, marlin ç­‰</span>
  --max-model-len 8192
</code></pre>
<p><strong>é‡åŒ–æ•ˆæœå¯¹æ¯”</strong>ï¼š</p>





























<table><thead><tr><th>æ–¹æ¡ˆ</th><th>æ˜¾å­˜å ç”¨</th><th>æ¨ç†é€Ÿåº¦</th><th>å‡†ç¡®ç‡ä¸‹é™</th></tr></thead><tbody><tr><td>FP16</td><td>~20 GB</td><td>åŸºå‡†</td><td>-</td></tr><tr><td>INT8</td><td>~10 GB</td><td>+20%</td><td>&lt;1%</td></tr><tr><td>INT4</td><td>~5 GB</td><td>+40%</td><td>2-5%</td></tr></tbody></table>
<h3 data-id="heading-39">5.4 ä½¿ç”¨å±å¹•é•œåƒï¼ˆscrcpyï¼‰</h3>
<p>å®æ—¶è§‚å¯Ÿæ‰‹æœºæ“ä½œï¼Œä¾¿äºè°ƒè¯•å’Œå±•ç¤ºã€‚</p>
<p><strong>å®‰è£… scrcpy</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Ubuntu/Debian</span>
sudo apt install scrcpy

<span class="hljs-comment"># Windows</span>
winget install Gsquared.Scrcpy

<span class="hljs-comment"># macOS</span>
brew install scrcpy
</code></pre>
<p><strong>å¯åŠ¨é•œåƒ</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åŸºç¡€å¯åŠ¨</span>
scrcpy

<span class="hljs-comment"># é«˜çº§é€‰é¡¹</span>
scrcpy --max-size=1920  <span class="hljs-comment"># é™åˆ¶åˆ†è¾¨ç‡</span>
scrcpy --bit-rate=8M    <span class="hljs-comment"># é™åˆ¶ç ç‡</span>
scrcpy --lock-video=landscape  <span class="hljs-comment"># é”å®šæ¨ªå±</span>
</code></pre>
<p><strong>ä¸ Open-AutoGLM é…åˆä½¿ç”¨</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç»ˆç«¯ 1ï¼šå¯åŠ¨æ¨¡å‹</span>
python3 -m vllm.entrypoints.openai.api_server --model models/autoglm-phone-9b --port 8000 &amp;

<span class="hljs-comment"># ç»ˆç«¯ 2ï¼šå¯åŠ¨ scrcpy</span>
scrcpy &amp;

<span class="hljs-comment"># ç»ˆç«¯ 3ï¼šè¿è¡Œ Open-AutoGLM</span>
python main.py --base-url http://localhost:8000/v1 --model autoglm-phone-9b
</code></pre>
<h3 data-id="heading-40">5.5 æ‰¹é‡ä»»åŠ¡æ‰§è¡Œ</h3>
<p>åˆ›å»ºä»»åŠ¡è„šæœ¬ï¼Œæ‰¹é‡æ‰§è¡Œè‡ªåŠ¨åŒ–ä»»åŠ¡ã€‚</p>
<p><strong>åˆ›å»ºä»»åŠ¡æ–‡ä»¶ tasks.txt</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">æ‰“å¼€å¾®ä¿¡ï¼Œç»™<span class="hljs-string">"æ–‡ä»¶ä¼ è¾“åŠ©æ‰‹"</span>å‘é€<span class="hljs-string">"ä½ å¥½"</span>
æ‰“å¼€æ”¯ä»˜å®ï¼ŒæŸ¥çœ‹ä½™é¢
æ‰“å¼€æ·˜å®ï¼Œæœç´¢<span class="hljs-string">"iPhone 15"</span>
</code></pre>
<p><strong>æ‰¹é‡æ‰§è¡Œè„šæœ¬</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> subprocess

<span class="hljs-keyword">def</span> <span class="hljs-title function_">run_task</span>(<span class="hljs-params">command</span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ‰§è¡Œä»»åŠ¡: <span class="hljs-subst">{command}</span>"</span>)
    result = subprocess.run(
        [<span class="hljs-string">"python"</span>, <span class="hljs-string">"main.py"</span>] + command.split(),
        capture_output=<span class="hljs-literal">True</span>,
        text=<span class="hljs-literal">True</span>
    )
    <span class="hljs-built_in">print</span>(result.stdout)
    <span class="hljs-keyword">return</span> result.returncode == <span class="hljs-number">0</span>

<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">"tasks.txt"</span>, <span class="hljs-string">"r"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> f:
    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:
        task = line.strip()
        <span class="hljs-keyword">if</span> task:
            run_task(task)
</code></pre>
<h2 data-id="heading-41">å…­ã€å‚è€ƒä¸å»¶ä¼¸é˜…è¯»</h2>
<h3 data-id="heading-42">å®˜æ–¹æ–‡æ¡£</h3>
<ul>
<li><strong>å®˜æ–¹ GitHub ä»“åº“</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzai-org%2FOpen-AutoGLM" target="_blank" title="https://github.com/zai-org/Open-AutoGLM" ref="nofollow noopener noreferrer">Open-AutoGLM GitHub</a>ï¼ˆå«å®Œæ•´å‚æ•°è¯´æ˜å’Œæœ€æ–°æ›´æ–°ï¼‰</li>
<li><strong>æ™ºè°±å¼€æ”¾å¹³å°æ–‡æ¡£</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.bigmodel.cn%2Fdocs%2Fautoglm-phone" target="_blank" title="https://open.bigmodel.cn/docs/autoglm-phone" ref="nofollow noopener noreferrer">AutoGLM-Phone ä½¿ç”¨æŒ‡å—</a></li>
</ul>
<h3 data-id="heading-43">ç¤¾åŒºèµ„æº</h3>
<ul>
<li><strong>B ç«™å®æˆ˜æ•™ç¨‹</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1xxxxx%2F" target="_blank" title="https://www.bilibili.com/video/BV1xxxxx/" ref="nofollow noopener noreferrer">äº‘ GPU + åŒå¡ä¼˜åŒ–æ•™ç¨‹</a></li>
<li><strong>CSDN æ˜‡è…¾å¼€æºä¸“åŒº</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fxxx" target="_blank" title="https://blog.csdn.net/xxx" ref="nofollow noopener noreferrer">è¯¦ç»†éƒ¨ç½²æµç¨‹</a></li>
<li><strong>Eslzzyl åšå®¢</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Feslzzyl.com" target="_blank" title="https://eslzzyl.com" ref="nofollow noopener noreferrer">æœ¬åœ°å®æµ‹ç¬”è®°</a></li>
</ul>
<h3 data-id="heading-44">ç›¸å…³æŠ€æœ¯</h3>
<ul>
<li><strong>vLLM å®˜æ–¹æ–‡æ¡£</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fvllm.ai%2F" target="_blank" title="https://vllm.ai/" ref="nofollow noopener noreferrer">é«˜æ€§èƒ½æ¨ç†æ¡†æ¶</a></li>
<li><strong>ADB å®˜æ–¹æ–‡æ¡£</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Fstudio%2Fcommand-line%2Fadb" target="_blank" title="https://developer.android.com/studio/command-line/adb" ref="nofollow noopener noreferrer">Android Debug Bridge</a></li>
<li><strong>OpenAI API å…¼å®¹æ€§</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference" target="_blank" title="https://platform.openai.com/docs/api-reference" ref="nofollow noopener noreferrer">API å‚è€ƒæ–‡æ¡£</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ„å»ºAIæ™ºèƒ½ä½“ï¼šäº”åäºŒã€ååº”å¼æ™ºèƒ½ä½“ï¼šåŸºäºâ€œæ„ŸçŸ¥-è¡ŒåŠ¨â€ï¼ŒAIä¸–ç•Œçš„æ¡ä»¶åå°„]]></title>    <link>https://juejin.cn/post/7582905804048351259</link>    <guid>https://juejin.cn/post/7582905804048351259</guid>    <pubDate>2025-12-14T02:08:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582905804048351259" data-draft-id="7582955784570110003" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ„å»ºAIæ™ºèƒ½ä½“ï¼šäº”åäºŒã€ååº”å¼æ™ºèƒ½ä½“ï¼šåŸºäºâ€œæ„ŸçŸ¥-è¡ŒåŠ¨â€ï¼ŒAIä¸–ç•Œçš„æ¡ä»¶åå°„"/> <meta itemprop="keywords" content="Agent,äººå·¥æ™ºèƒ½,Python"/> <meta itemprop="datePublished" content="2025-12-14T02:08:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å½¼å²¸èŠ±å¼€äº†å—"/> <meta itemprop="url" content="https://juejin.cn/user/4153315734334538"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ„å»ºAIæ™ºèƒ½ä½“ï¼šäº”åäºŒã€ååº”å¼æ™ºèƒ½ä½“ï¼šåŸºäºâ€œæ„ŸçŸ¥-è¡ŒåŠ¨â€ï¼ŒAIä¸–ç•Œçš„æ¡ä»¶åå°„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4153315734334538/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å½¼å²¸èŠ±å¼€äº†å—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T02:08:27.000Z" title="Sun Dec 14 2025 02:08:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€åˆè¯†ååº”å¼æ™ºèƒ½ä½“</h2>
<p>å‰ä¸€ç¯‡æˆ‘ä»¬è¯¦ç»†äº†è§£äº†æ·±æ€ç†Ÿè™‘æ™ºèƒ½ä½“ï¼Œä»Šå¤©æˆ‘ä»¬è®¨è®ºæ™ºèƒ½ä½“çš„å¦ä¸€ç§ç±»å‹ï¼Œååº”å¼æ™ºèƒ½ä½“ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œå½“æˆ‘ä»¬çš„æ‰‹ä¸å°å¿ƒè§¦ç¢°åˆ°ä¸€ä¸ªæ»šçƒ«çš„æ¯å­æ—¶ï¼Œæˆ‘ä»¬ä¼šç¬é—´ç¼©å›ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬çš„å¤§è„‘ç”šè‡³è¿˜æ²¡æœ‰æ„è¯†åˆ°çƒ«è¿™ä¸ªæ¦‚å¿µï¼Œæ‰‹å·²ç»å®Œæˆäº†åŠ¨ä½œã€‚è¿™ç§ä¸ç»è¿‡æ·±æ€ç†Ÿè™‘ã€ç›´æ¥ç”±åˆºæ¿€å¼•å‘çš„å¿«é€Ÿååº”ï¼Œå°±æ˜¯ååº”å¼æ™ºèƒ½ä½“çš„æ ¸å¿ƒæ€æƒ³ã€‚</p>
<p>ååº”å¼æ™ºèƒ½ä½“æ˜¯ä¸€ç§åŸºäºâ€œæ„ŸçŸ¥-è¡ŒåŠ¨â€æ¨¡å¼çš„æ™ºèƒ½ç³»ç»Ÿã€‚å®ƒä¸ä¾èµ–å¤æ‚çš„å†…éƒ¨ä¸–ç•Œæ¨¡å‹ï¼Œä¸è¿›è¡Œè€—æ—¶çš„æ¨ç†è§„åˆ’ï¼Œè€Œæ˜¯åƒç”Ÿç‰©çš„æ¡ä»¶åå°„ä¸€æ ·ï¼Œæ ¹æ®å½“å‰çš„ç¯å¢ƒè¾“å…¥ç›´æ¥äº§ç”Ÿè¡Œä¸ºè¾“å‡ºã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c2e1b78d85b14254a54aa4b06ff77e7a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b285bK46Iqx5byA5LqG5ZCX:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766283064&amp;x-signature=a3t1nbpokBlVsLBy9OeWq3qRu%2BQ%3D" alt="" loading="lazy"/></p>
<p>ä¸€ä¸ªç®€å•çš„æ¯”å–»ï¼š</p>
<ul>
<li>**ååº”å¼æ™ºèƒ½ä½“ï¼š**å¥½æ¯”èœœèœ‚é‡‡èœœï¼Œèœœèœ‚çœ‹åˆ°èŠ±æœµå°±é£è¿‡å»ï¼Œé‡åˆ°éšœç¢å°±è½¬å‘ï¼Œæ•´ä¸ªè¿‡ç¨‹æµç•…è‡ªç„¶</li>
<li>**æ·±æ€ç†Ÿè™‘æ™ºèƒ½ä½“ï¼š**å¥½æ¯”æ£‹æ‰‹ä¸‹æ£‹ï¼Œæ¯èµ°ä¸€æ­¥éƒ½éœ€è¦æ·±æ€ç†Ÿè™‘ï¼Œè€ƒè™‘å„ç§å¯èƒ½æ€§</li>
</ul>
<p>è¿™ç§è®¾è®¡ä½¿å¾—ååº”å¼æ™ºèƒ½ä½“åœ¨éœ€è¦å¿«é€Ÿå“åº”çš„åœºæ™¯ä¸­è¡¨ç°å‡ºè‰²ï¼Œæˆä¸ºæœºå™¨äººå­¦ã€è‡ªåŠ¨é©¾é©¶ã€å·¥ä¸šè‡ªåŠ¨åŒ–ç­‰é¢†åŸŸçš„åŸºçŸ³æŠ€æœ¯ï¼Œååº”å¼æ™ºèƒ½ä½“æ˜¯ä¸€ç§åŸºç¡€ä¸”å¼ºå¤§çš„æ™ºèƒ½ä½“èŒƒå¼ï¼Œå®ƒæ‘’å¼ƒäº†å¤æ‚çš„å†…éƒ¨ä¸–ç•Œæ¨¡å‹å’Œå‰ç»æ€§è§„åˆ’ï¼Œè½¬è€Œå¼ºè°ƒå¯¹ç¯å¢ƒçš„å³æ—¶ã€ç›´æ¥å“åº”ã€‚è¿™ç§â€œåˆºæ¿€-ååº”â€æ¨¡å¼ï¼Œä½¿å…¶åœ¨åŠ¨æ€ã€å¿«é€Ÿå˜åŒ–çš„ç¯å¢ƒä¸­è¡¨ç°å‡ºæé«˜çš„æ•ˆç‡å’Œé²æ£’æ€§ã€‚</p>
<h2 data-id="heading-1">äºŒã€ä»€ä¹ˆæ˜¯ååº”å¼æ™ºèƒ½ä½“</h2>
<p>ååº”å¼æ™ºèƒ½ä½“çš„è®¾è®¡æºäºå¯¹è‡ªç„¶ç•Œï¼ˆå¦‚æ˜†è™«ï¼‰é«˜æ•ˆè¡Œä¸ºçš„è§‚å¯Ÿï¼Œä¸€åªèœœèœ‚ä¸éœ€è¦æ„å»ºæ•´ä¸ªèŠ±å›­çš„è®¤çŸ¥åœ°å›¾ï¼Œå®ƒåªéœ€æ ¹æ®å…‰çº¿ã€èŠ±æœµå½¢çŠ¶å’Œæ°”å‘³ç­‰å³æ—¶æ„Ÿå®˜è¾“å…¥ï¼Œå°±èƒ½åšå‡ºé£å‘èŠ±èœœçš„å†³å®šã€‚</p>
<p><strong>1. æ ¸å¿ƒæ¦‚å¿µ</strong></p>
<p>ååº”å¼æ™ºèƒ½ä½“æ˜¯ä¸€ç§ä¸ä¾èµ–å†…éƒ¨ä¸–ç•Œæ¨¡å‹ï¼Œä¹Ÿä¸è¿›è¡Œå¤æ‚æ¨ç†ï¼Œå…¶å†³ç­–å’Œè¡ŒåŠ¨ç›´æ¥ç”±å½“å‰æ—¶åˆ»çš„æ„ŸçŸ¥è¾“å…¥æ‰€å†³å®šçš„æ™ºèƒ½ç³»ç»Ÿã€‚å®ƒ</p>
<p><strong>2. åŸºæœ¬å·¥ä½œæ¨¡å¼</strong></p>
<p>ååº”å¼æ™ºèƒ½ä½“çš„çš„å·¥ä½œæ¨¡å¼å¯ä»¥æ¦‚æ‹¬ä¸ºä¸€ä¸ªæå…¶ç®€åŒ–çš„å…¬å¼ï¼šæ„ŸçŸ¥ â†’ ååº”ã€‚å®ƒçš„å·¥ä½œæµç¨‹å¯ä»¥æ¦‚æ‹¬ä¸ºä¸€ä¸ªæå…¶ç®€æ´çš„å¾ªç¯ï¼šç¯å¢ƒæ„ŸçŸ¥ â†’ æ¡ä»¶åŒ¹é… â†’ åŠ¨ä½œæ‰§è¡Œ â†’ ç¯å¢ƒæ”¹å˜</p>
<p>è¿™ä¸ªå¾ªç¯çš„å…³é”®åœ¨äºæ²¡æœ‰ä¸­é—´çš„æ€è€ƒç¯èŠ‚ï¼Œæ™ºèƒ½ä½“ä¸éœ€è¦å›ç­”â€œæˆ‘åœ¨å“ªé‡Œï¼Ÿâ€â€œæˆ‘è¦å»å“ªé‡Œï¼Ÿâ€è¿™æ ·çš„å“²å­¦é—®é¢˜ï¼Œå®ƒåªéœ€è¦çŸ¥é“â€œç°åœ¨è¯¥åšä»€ä¹ˆâ€ã€‚</p>
<p><strong>3. æ¡ä»¶-åŠ¨ä½œè§„åˆ™</strong></p>
<p>ååº”å¼æ™ºèƒ½ä½“çš„å¤§è„‘ç”±ä¸€ç³»åˆ—ç®€å•çš„â€œå¦‚æœ-é‚£ä¹ˆâ€è§„åˆ™ç»„æˆï¼š</p>
<pre><code class="hljs language-css" lang="css">è§„åˆ™é›† = <span class="hljs-selector-attr">[    <span class="hljs-string">"å¦‚æœ(å‰æ–¹æœ‰éšœç¢ç‰©) é‚£ä¹ˆ(å‘å·¦è½¬)"</span>,    <span class="hljs-string">"å¦‚æœ(ç”µé‡ä½äº20%) é‚£ä¹ˆ(è¿”å›å……ç”µ)"</span>,    <span class="hljs-string">"å¦‚æœ(æ£€æµ‹åˆ°ç›®æ ‡) é‚£ä¹ˆ(å‘å‰ç§»åŠ¨)"</span>,    <span class="hljs-string">"å¦‚æœ(æ— ç‰¹æ®Šæƒ…å†µ) é‚£ä¹ˆ(éšæœºæ¢ç´¢)"</span>]</span>
</code></pre>
<p>è¿™äº›è§„åˆ™å°±åƒç”Ÿç‰©çš„ç¥ç»åå°„å¼§ï¼Œæ¯ä¸ªéƒ½è´Ÿè´£å¤„ç†ç‰¹å®šçš„æƒ…å¢ƒã€‚å½“ç¯å¢ƒæä¾›çš„æ„ŸçŸ¥è¾“å…¥åŒ¹é…æŸä¸ªè§„åˆ™çš„æ¡ä»¶æ—¶ï¼Œå¯¹åº”çš„åŠ¨ä½œå°±ä¼šè¢«ç«‹å³è§¦å‘ã€‚</p>
<p><strong>4. è¡Œä¸ºçš„æ¶Œç°</strong></p>
<p>å•ä¸ªè§„åˆ™å¯èƒ½å¾ˆç®€å•ï¼Œä½†å¤šä¸ªè§„åˆ™ç»„åˆèµ·æ¥å°±èƒ½äº§ç”Ÿå¤æ‚çš„è¡Œä¸ºè¡¨ç°ã€‚è¿™ç§ç°è±¡è¢«ç§°ä¸ºâ€œæ¶Œç°â€â€”â€”æ•´ä½“è¡Œä¸ºå¤§äºéƒ¨åˆ†ä¹‹å’Œã€‚</p>
<p>å®ä¾‹è¯´æ˜ï¼šä¸€ä¸ªæ‰«åœ°æœºå™¨äººåªæœ‰ä¸‰ä¸ªç®€å•è§„åˆ™ï¼š</p>
<ul>
<li>é‡åˆ°éšœç¢å°±è½¬å‘</li>
<li>æ£€æµ‹åˆ°ç°å°˜å°±æ¸…æ‰«</li>
<li>é»˜è®¤æƒ…å†µä¸‹ç›´çº¿å‰è¿›</li>
</ul>
<p>å•ç‹¬çœ‹æ¯ä¸ªè§„åˆ™éƒ½å¾ˆç®€å•ï¼Œä½†ç»„åˆèµ·æ¥åï¼Œæœºå™¨äººå°±èƒ½åœ¨æˆ¿é—´é‡Œè‡ªä¸»ç§»åŠ¨ã€é¿å¼€å®¶å…·ã€æ¸…æ‰«ç°å°˜ï¼Œè¡¨ç°å‡ºç›¸å½“å¤æ‚çš„æ™ºèƒ½è¡Œä¸ºã€‚è¿™ç§ä»ç®€å•è§„åˆ™ä¸­äº§ç”Ÿå¤æ‚è¡Œä¸ºçš„è¿‡ç¨‹ï¼Œæ­£æ˜¯ååº”å¼æ™ºèƒ½ä½“çš„é­…åŠ›æ‰€åœ¨ã€‚</p>
<p><strong>5. æ ¸å¿ƒåŸåˆ™</strong></p>
<ul>
<li>ç´§è€¦åˆçš„æ„ŸçŸ¥-è¡ŒåŠ¨å¾ªç¯ï¼šæ™ºèƒ½ä½“çš„è¡ŒåŠ¨ç›´æ¥ç”±å½“å‰çš„æ„ŸçŸ¥è¾“å…¥è§¦å‘ï¼Œä¸­é—´æ²¡æœ‰å¤æ‚çš„æ€è€ƒæˆ–è§„åˆ’è¿‡ç¨‹ã€‚</li>
<li>æ— å†…éƒ¨çŠ¶æ€æ¨¡å‹ï¼šååº”å¼æ™ºèƒ½ä½“ä¸ç»´æŠ¤å…³äºä¸–ç•Œå†å²çš„å†…éƒ¨æ¨¡å‹ï¼Œå®ƒçš„å†³ç­–å®Œå…¨åŸºäºç°åœ¨ï¼Œè¿™ç®€åŒ–äº†è®¾è®¡å¹¶é¿å…äº†å› æ¨¡å‹ä¸å‡†ç¡®å¯¼è‡´çš„é”™è¯¯ã€‚</li>
<li>è¡Œä¸ºåˆ†è§£ï¼šå¤æ‚çš„è¡Œä¸ºä¸æ˜¯é€šè¿‡ä¸€ä¸ªåºå¤§çš„ç¨‹åºå®ç°çš„ï¼Œè€Œæ˜¯é€šè¿‡ä¸€ç³»åˆ—ç®€å•çš„ã€å¹¶è¡Œçš„è¡Œä¸ºæ¨¡å¼ç»„åˆè€Œæˆã€‚</li>
<li>æ¶Œç°è¡Œä¸ºï¼šæ™ºèƒ½ä½“æ•´ä½“çš„ã€çœ‹ä¼¼å¤æ‚çš„è¡Œä¸ºï¼Œæ˜¯ç”±å¤šä¸ªç®€å•è¡Œä¸ºåœ¨ç¯å¢ƒäº¤äº’ä¸­æ¶Œç°å‡ºæ¥çš„ï¼Œè€Œéé¢„å…ˆç¼–ç¨‹çš„ã€‚</li>
</ul>
<p><strong>6. ååº”å¼æ™ºèƒ½ä½“çš„ä¼˜åŠ¿</strong></p>
<ul>
<li>é€Ÿåº¦å¿«ï¼š å“åº”å»¶è¿Ÿæä½ï¼Œé€‚ç”¨äºéœ€è¦å¿«é€Ÿååº”çš„ä»»åŠ¡ï¼Œå¦‚é¿éšœã€‚</li>
<li>é²æ£’æ€§å¼ºï¼š ç”±äºä¸ä¾èµ–å¯èƒ½å‡ºé”™çš„å†…éƒ¨æ¨¡å‹ï¼Œåœ¨éƒ¨åˆ†ä¼ æ„Ÿå™¨å¤±æ•ˆæ—¶ï¼Œå‰©ä½™çš„è¡Œä¸ºæ¨¡å¼ä»èƒ½ä¿è¯åŸºæœ¬åŠŸèƒ½ã€‚</li>
<li>è®¾è®¡ç®€å•ï¼š æ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºå®ç°ã€æµ‹è¯•å’Œè°ƒè¯•ã€‚</li>
</ul>
<p><strong>7. ååº”å¼æ™ºèƒ½ä½“çš„åŠ£åŠ¿</strong></p>
<ul>
<li>æ™ºèƒ½å—é™ï¼š æ— æ³•è¿›è¡Œéœ€è¦è®°å¿†å’Œè§„åˆ’çš„ä»»åŠ¡ï¼Œå¦‚ä¸‹æ£‹ã€å¤æ‚å†³ç­–ã€‚</li>
<li>å¯èƒ½é™·å…¥å±€éƒ¨å¾ªç¯ï¼š ä¾‹å¦‚ï¼Œä¸€ä¸ªæœºå™¨äººå¯èƒ½ä¼šåœ¨ä¸¤ä¸ªéšœç¢ç‰©ä¹‹é—´æ¥å›æ‘†åŠ¨ã€‚</li>
</ul>
<p><strong>8. ä¸€ä¸ªç”Ÿæ´»åŒ–çš„æ¯”å–»ï¼šè†è·³åå°„</strong></p>
<p>åŒ»ç”Ÿç”¨å°é”¤æ•²å‡»ä½ çš„è†ç›–ï¼Œä½ çš„å°è…¿ä¼šä¸å—æ§åˆ¶åœ°å‘å‰è¸¢å‡ºã€‚è¿™ä¸ªè¿‡ç¨‹ï¼š</p>
<ul>
<li>æ„ŸçŸ¥ï¼šè†ç›–è‚Œè…±è¢«æ•²å‡»ã€‚</li>
<li>å¤„ç†ï¼šè„Šé«“å±‚é¢çš„ç¥ç»å›è·¯ï¼Œæ— éœ€å¤§è„‘æ€è€ƒã€‚</li>
<li>è¡ŒåŠ¨ï¼šå°è…¿è¸¢å‡ºã€‚</li>
</ul>
<p>è¿™å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„ååº”å¼è¿‡ç¨‹â€”â€”å¿«é€Ÿã€ç›´æ¥ã€ä¸ç»è¿‡æ·±æ€ç†Ÿè™‘ï¼Œååº”å¼æ™ºèƒ½ä½“æ­£æ˜¯å°†è¿™ç§æ¨¡å¼åº”ç”¨åœ¨äº†æœºå™¨å†³ç­–ä¸Šã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€ååº”å¼æ™ºèƒ½ä½“çš„æ¶æ„</h2>
<h3 data-id="heading-3">1. è¡Œä¸ºå±‚æ¬¡çš„æ¦‚å¿µ</h3>
<p>å½“å¤šä¸ªè§„åˆ™å¯èƒ½åŒæ—¶è¢«æ¿€æ´»æ—¶ï¼Œå¦‚ä½•å†³å®šæ‰§è¡Œå“ªä¸ªåŠ¨ä½œï¼Ÿæœºå™¨äººå­¦å®¶ç½—å¾·å°¼Â·å¸ƒé²å…‹æ–¯æå‡ºäº†åŒ…å®¹æ¶æ„æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>åŒ…å®¹æ¶æ„çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šå°†æ™ºèƒ½ä½“åˆ†è§£ä¸ºå¤šä¸ªè¡Œä¸ºå±‚ï¼Œæ¯ä¸ªå±‚éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„â€œæ„ŸçŸ¥-è¡ŒåŠ¨â€æ¨¡å—ã€‚è¿™äº›å±‚å¹¶è¡Œè¿è¡Œï¼Œä½†é€šè¿‡ä¼˜å…ˆçº§æœºåˆ¶è¿›è¡Œåè°ƒã€‚</p>
<h3 data-id="heading-4">2. æµç¨‹è¯¦è§£</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67bb06b0a47d4971b3482a6d3c38f473~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b285bK46Iqx5byA5LqG5ZCX:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766283064&amp;x-signature=TOMfJRr2hBx3rz%2B88OwPfTNOrto%3D" alt="" loading="lazy"/>â€‹</p>
<p><strong>æµç¨‹è¯´æ˜ï¼š</strong></p>
<ul>
<li>1. æ„ŸçŸ¥é˜¶æ®µ
<ul>
<li>ç¯å¢ƒä¼ æ„Ÿå™¨è¾“å…¥ï¼šé€šè¿‡æ‘„åƒå¤´ã€é›·è¾¾ç­‰ä¼ æ„Ÿå™¨æ”¶é›†ç¯å¢ƒæ•°æ®</li>
<li>æ„ŸçŸ¥æ•°æ®å¤„ç†ï¼šå¯¹åŸå§‹æ•°æ®è¿›è¡Œæ¸…æ´—ã€åˆ†æå’Œç†è§£</li>
</ul>
</li>
<li>2. å†³ç­–é˜¶æ®µ
<ul>
<li>è¡Œä¸ºæ¡ä»¶æ£€æŸ¥ï¼šå°†å¤„ç†åçš„æ•°æ®ä¸é¢„è®¾çš„è¡Œä¸ºæ¡ä»¶è¿›è¡ŒåŒ¹é…</li>
<li>è¡Œä¸ºæ¿€æ´»ï¼šæ»¡è¶³æ¡ä»¶çš„è¡Œä¸ºè¢«æ¿€æ´»ï¼Œç”Ÿæˆå¯¹åº”åŠ¨ä½œ</li>
<li>è¡Œä¸ºä»²è£ï¼šå½“å¤šä¸ªè¡Œä¸ºå†²çªæ—¶ï¼Œé€‰æ‹©æœ€é«˜ä¼˜å…ˆçº§çš„åŠ¨ä½œæ‰§è¡Œ</li>
</ul>
</li>
<li>3. æ‰§è¡Œé˜¶æ®µ
<ul>
<li>æœ€ç»ˆåŠ¨ä½œè¾“å‡ºï¼šæ‰§è¡Œé€‰å®šçš„åŠ¨ä½œ</li>
<li>ç¯å¢ƒå½±å“ï¼šåŠ¨ä½œæ”¹å˜ç¯å¢ƒï¼Œå¼•å‘æ–°çš„ä¼ æ„Ÿå™¨è¾“å…¥</li>
</ul>
</li>
</ul>
<p><strong>æµç¨‹æ€»ç»“ï¼š</strong></p>
<ul>
<li>å¾ªç¯å¾€å¤ï¼šæ•´ä¸ªè¿‡ç¨‹å½¢æˆä¸€ä¸ªè¿ç»­çš„"æ„ŸçŸ¥-è¡ŒåŠ¨"å¾ªç¯</li>
<li>å®æ—¶å“åº”ï¼šä¸è¿›è¡Œå¤æ‚æ€è€ƒï¼Œç›´æ¥æ ¹æ®å½“å‰ç¯å¢ƒåšå‡ºååº”</li>
<li>å¹¶è¡Œå¤„ç†ï¼šå¤šä¸ªè¡Œä¸ºæ¡ä»¶åŒæ—¶æ£€æŸ¥ï¼Œæé«˜å“åº”é€Ÿåº¦</li>
</ul>
<h3 data-id="heading-5">3. å…³é”®ç»„ä»¶</h3>
<ul>
<li>æ„ŸçŸ¥æ¨¡å—ï¼š ä»ä¼ æ„Ÿå™¨ï¼ˆå¦‚æ‘„åƒå¤´ã€æ¿€å…‰é›·è¾¾ã€è§¦é¡»ï¼‰è¯»å–åŸå§‹æ•°æ®ï¼Œå¹¶è¿›è¡Œå¿…è¦çš„é¢„å¤„ç†ï¼ˆå¦‚è¿‡æ»¤å™ªå£°ã€è¯†åˆ«ç‰¹å®šç‰¹å¾ï¼‰ã€‚</li>
<li>è¡Œä¸ºé›†åˆï¼š ä¸€ç³»åˆ—ç®€å•çš„â€œå¦‚æœ-é‚£ä¹ˆâ€è§„åˆ™æˆ–å‡½æ•°ã€‚
<ul>
<li>â€œå¦‚æœâ€éƒ¨åˆ†ï¼š æ„ŸçŸ¥æ¡ä»¶çš„å¸ƒå°”ç»„åˆã€‚</li>
<li>â€œé‚£ä¹ˆâ€éƒ¨åˆ†ï¼š è¦æ‰§è¡Œçš„åŠ¨ä½œæˆ–å‘é‡ã€‚</li>
<li>ä¾‹å¦‚ï¼šå¦‚æœ (å‰æ–¹æœ‰éšœç¢ç‰©) é‚£ä¹ˆ (å‘å·¦è½¬)</li>
</ul>
</li>
<li>ä»²è£æœºåˆ¶ï¼š å½“å¤šä¸ªè¡Œä¸ºåŒæ—¶è¢«æ¿€æ´»æ—¶ï¼Œä»²è£æœºåˆ¶å†³å®šå“ªä¸ªè¡Œä¸ºæ‹¥æœ‰æ§åˆ¶æƒã€‚å¸¸è§ç­–ç•¥åŒ…æ‹¬ï¼š
<ul>
<li>å›ºå®šä¼˜å…ˆçº§ï¼š æŸäº›è¡Œä¸ºï¼ˆå¦‚â€œé¿éšœâ€ï¼‰æ°¸è¿œæ¯”â€œæ¢ç´¢â€è¡Œä¸ºä¼˜å…ˆçº§é«˜ã€‚</li>
<li>æŠ‘åˆ¶ç»“æ„ï¼š é«˜ä¼˜å…ˆçº§è¡Œä¸ºå¯ä»¥æŠ‘åˆ¶ä½ä¼˜å…ˆçº§è¡Œä¸ºçš„è¾“å‡ºã€‚</li>
<li>å‘é‡æ±‚å’Œï¼š å°†æ‰€æœ‰è¡Œä¸ºè¾“å‡ºçš„åŠ¨ä½œå‘é‡ï¼ˆå¦‚é€Ÿåº¦ã€è½¬å‘è§’ï¼‰ç›¸åŠ ï¼Œå¾—åˆ°æœ€ç»ˆåŠ¨ä½œã€‚</li>
</ul>
</li>
</ul>
<p>åœ¨åŒ…å®¹æ¶æ„ä¸­ï¼Œè¡Œä¸ºå±‚è¢«ç»„ç»‡æˆä¸åŒçš„ä¼˜å…ˆçº§ï¼š</p>
<ul>
<li>é«˜ä¼˜å…ˆçº§ï¼šé¿éšœè¡Œä¸º â† ç”Ÿå‘½å®‰å…¨æœ€é‡è¦</li>
<li>ä¸­ä¼˜å…ˆçº§ï¼šä»»åŠ¡è¡Œä¸º â† å®Œæˆä¸»è¦ä»»åŠ¡</li>
<li>ä½ä¼˜å…ˆçº§ï¼šæ¢ç´¢è¡Œä¸º â† é»˜è®¤è¡Œä¸º</li>
</ul>
<p>ä»²è£åŸåˆ™ï¼šé«˜ä¼˜å…ˆçº§è¡Œä¸ºå¯ä»¥æŠ‘åˆ¶ä½ä¼˜å…ˆçº§è¡Œä¸ºã€‚å°±åƒåœ¨äººç±»è¡Œä¸ºä¸­ï¼Œèº²é¿å±é™©çš„æœ¬èƒ½ä¼šå‹åˆ¶å…¶ä»–æ‰€æœ‰æƒ³æ³•ã€‚</p>
<h3 data-id="heading-6">4. å®é™…åº”ç”¨åœºæ™¯</h3>
<p>è€ƒè™‘ä¸€ä¸ªè‡ªåŠ¨é©¾é©¶æ±½è½¦çš„ååº”å¼ç³»ç»Ÿï¼š</p>
<pre><code class="hljs language-bash" lang="bash">è¡Œä¸ºå±‚ = {
    <span class="hljs-comment"># æœ€é«˜ä¼˜å…ˆçº§ï¼šå®‰å…¨ç›¸å…³</span>
    <span class="hljs-string">"ç´§æ€¥åˆ¶åŠ¨"</span>: {<span class="hljs-string">"æ¡ä»¶"</span>: <span class="hljs-string">"ç¢°æ’ imminent"</span>, <span class="hljs-string">"åŠ¨ä½œ"</span>: <span class="hljs-string">"å…¨åŠ›åˆ¹è½¦"</span>},
    
    <span class="hljs-comment"># é«˜ä¼˜å…ˆçº§ï¼šé¿éšœ</span>
    <span class="hljs-string">"ä¸»åŠ¨é¿éšœ"</span>: {<span class="hljs-string">"æ¡ä»¶"</span>: <span class="hljs-string">"å‰æ–¹æœ‰éšœç¢"</span>, <span class="hljs-string">"åŠ¨ä½œ"</span>: <span class="hljs-string">"è½¬å‘é¿è®©"</span>},
    
    <span class="hljs-comment"># ä¸­ä¼˜å…ˆçº§ï¼šå¯¼èˆª</span>
    <span class="hljs-string">"è½¦é“ä¿æŒ"</span>: {<span class="hljs-string">"æ¡ä»¶"</span>: <span class="hljs-string">"åç¦»è½¦é“"</span>, <span class="hljs-string">"åŠ¨ä½œ"</span>: <span class="hljs-string">"å¾®è°ƒæ–¹å‘"</span>},
    
    <span class="hljs-comment"># ä½ä¼˜å…ˆçº§ï¼šèˆ’é€‚æ€§</span>
    <span class="hljs-string">"å¹³ç¨³é©¾é©¶"</span>: {<span class="hljs-string">"æ¡ä»¶"</span>: <span class="hljs-string">"é“è·¯å¼¯æ›²"</span>, <span class="hljs-string">"åŠ¨ä½œ"</span>: <span class="hljs-string">"å¹³æ»‘è½¬å‘"</span>}
}
</code></pre>
<p>å½“å¤šä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³æ—¶ï¼Œåªæœ‰æœ€é«˜ä¼˜å…ˆçº§çš„åŠ¨ä½œä¼šè¢«æ‰§è¡Œï¼Œè¿™ç§è®¾è®¡ç¡®ä¿äº†ç³»ç»Ÿåœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½èƒ½åšå‡ºæœ€å®‰å…¨çš„é€‰æ‹©ã€‚</p>
<h2 data-id="heading-7">å››ã€ååº”å¼æ™ºèƒ½ä½“çš„æ„å»º - åŒ…å®¹æ¶æ„</h2>
<p>å¦‚ä½•å°†å¤šä¸ªç®€å•çš„â€œæ¡ä»¶-åŠ¨ä½œâ€è§„åˆ™ç»„åˆèµ·æ¥ï¼Œå½¢æˆå¤æ‚çš„è¡Œä¸ºï¼Ÿæœºå™¨äººå­¦å®¶ç½—å¾·å°¼Â·å¸ƒé²å…‹æ–¯æå‡ºäº†ç»å…¸çš„ â€œåŒ…å®¹æ¶æ„â€ã€‚</p>
<h3 data-id="heading-8">1. æ ¸å¿ƒæ€æƒ³</h3>
<p>åŒ…å®¹æ¶æ„å°†æ™ºèƒ½ä½“åˆ†è§£ä¸ºå¤šä¸ªè¡Œä¸ºå±‚ï¼Œæ¯ä¸ªå±‚éƒ½æ˜¯ä¸€ä¸ªç®€å•çš„â€œæ¡ä»¶-åŠ¨ä½œâ€æ¨¡å—ã€‚è¿™äº›å±‚å¹¶è¡Œè¿è¡Œï¼Œä½†é€šè¿‡ â€œæŠ‘åˆ¶â€ ä¸ â€œæŠ‘åˆ¶â€ æœºåˆ¶è¿›è¡Œåè°ƒã€‚</p>
<ul>
<li>æŠ‘åˆ¶ï¼šé«˜ä¼˜å…ˆçº§è¡Œä¸ºå¯ä»¥è¦†ç›–ä½ä¼˜å…ˆçº§è¡Œä¸ºçš„è¾“å‡ºä¿¡å·ã€‚</li>
<li>æŠ‘åˆ¶ï¼šé«˜ä¼˜å…ˆçº§è¡Œä¸ºå¯ä»¥é˜»æ–­ä½ä¼˜å…ˆçº§è¡Œä¸ºæ¥æ”¶è¾“å…¥ä¿¡å·ã€‚</li>
</ul>
<h3 data-id="heading-9">2. ä¸€ä¸ªæœºå™¨äººçš„è¡Œä¸ºå±‚è®¾è®¡</h3>
<p>å‡è®¾æˆ‘ä»¬è¦æ„å»ºä¸€ä¸ªå®¤å†…æ¸…æ‰«æœºå™¨äººï¼š</p>
<ul>
<li>å±‚ä¸€ï¼ˆæœ€ä½ä¼˜å…ˆçº§ï¼‰ï¼šå……ç”µè¡Œä¸º
<ul>
<li>æ¡ä»¶ï¼šç”µé‡ &lt; 10%ã€‚</li>
<li>åŠ¨ä½œï¼šå‘å……ç”µæ¡©ç§»åŠ¨ã€‚</li>
</ul>
</li>
<li>å±‚äºŒï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰ï¼šæ¸…æ‰«è¡Œä¸º
<ul>
<li>æ¡ä»¶ï¼šæ£€æµ‹åˆ°ç°å°˜ã€‚</li>
<li>åŠ¨ä½œï¼šå¯åŠ¨åˆ·å­å¹¶å‰è¿›ã€‚</li>
</ul>
</li>
<li>å±‚ä¸‰ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰ï¼šé¿éšœè¡Œä¸º
<ul>
<li>æ¡ä»¶ï¼šå‰æ–¹è¿‘è·ç¦»æ£€æµ‹åˆ°éšœç¢ç‰©ã€‚</li>
<li>åŠ¨ä½œï¼šåœæ­¢ï¼Œè½¬å‘ã€‚</li>
</ul>
</li>
</ul>
<p>ä»²è£è¿‡ç¨‹ï¼šå½“æœºå™¨äººæ­£åœ¨æ¸…æ‰«æ—¶ï¼ˆå±‚äºŒæ¿€æ´»ï¼‰ï¼Œå¦‚æœçªç„¶å‰æ–¹å‡ºç°éšœç¢ç‰©ï¼Œé¿éšœè¡Œä¸ºï¼ˆå±‚ä¸‰ï¼‰ä¼šç«‹å³æŠ‘åˆ¶æ¸…æ‰«è¡Œä¸ºï¼ˆå±‚äºŒï¼‰çš„è¾“å‡ºï¼Œè®©æœºå™¨äººå…ˆè½¬å‘ã€‚é¿å¼€éšœç¢ç‰©åï¼Œé¿éšœè¡Œä¸ºæ¡ä»¶ä¸å†æ»¡è¶³ï¼Œæ¸…æ‰«è¡Œä¸ºé‡æ–°å–å¾—æ§åˆ¶æƒï¼Œè¿™ä¿è¯äº†æœºå™¨äººçš„å®‰å…¨ã€‚</p>
<h3 data-id="heading-10">3. åŒ…å®¹æ¶æ„æµç¨‹å›¾</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c8504c12a4d457885fa42ad4ab07a55~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b285bK46Iqx5byA5LqG5ZCX:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766283064&amp;x-signature=lxPtuxMlOuxyxQtQJZtF8UrFxuE%3D" alt="" loading="lazy"/>â€‹</p>
<p><strong>å·¥ä½œè¿‡ç¨‹ï¼š</strong></p>
<ul>
<li>ä¼ æ„Ÿå™¨è¾“å…¥åŒæ—¶ä¼ é€’ç»™æ‰€æœ‰è¡Œä¸ºå±‚</li>
<li>å„å±‚ç‹¬ç«‹åˆ¤æ–­æ˜¯å¦æ»¡è¶³æ‰§è¡Œæ¡ä»¶</li>
<li>æŠ‘åˆ¶æœºåˆ¶ç”Ÿæ•ˆï¼š
<ul>
<li>éœ€è¦é¿éšœæ—¶ï¼Œé¿éšœå±‚æŠ‘åˆ¶æ¸…æ‰«å’Œå……ç”µ</li>
<li>éœ€è¦æ¸…æ‰«æ—¶ï¼Œæ¸…æ‰«å±‚åªæŠ‘åˆ¶å……ç”µ</li>
<li>éƒ½ä¸éœ€è¦æ—¶ï¼Œæ‰§è¡Œå……ç”µå±‚</li>
</ul>
</li>
<li>åŠ¨ä½œä»²è£é€‰æ‹©æœ€ç»ˆè¦æ‰§è¡Œçš„åŠ¨ä½œ</li>
</ul>
<p><strong>æ ¸å¿ƒæœºåˆ¶ï¼š</strong></p>
<ul>
<li>ä¸‰å±‚å¹¶è¡Œå¤„ç†ï¼šé¿éšœã€æ¸…æ‰«ã€å……ç”µä¸‰ä¸ªè¡Œä¸ºå±‚åŒæ—¶æ¥æ”¶ä¼ æ„Ÿå™¨è¾“å…¥</li>
<li>ä¼˜å…ˆçº§æŠ‘åˆ¶ï¼šé«˜ä¼˜å…ˆçº§è¡Œä¸ºå¯ä»¥æŠ‘åˆ¶ä½ä¼˜å…ˆçº§è¡Œä¸º</li>
<li>è¡Œä¸ºä»²è£ï¼šæœ€ç»ˆåªæœ‰ä¸€ä¸ªåŠ¨ä½œè¢«è¾“å‡ºæ‰§è¡Œ</li>
</ul>
<h3 data-id="heading-11">4. å®Œæ•´æ„å»ºæ­¥éª¤</h3>
<ul>
<li>1. å®šä¹‰ä»»åŠ¡å’Œç›®æ ‡ï¼š æ˜ç¡®æ™ºèƒ½ä½“éœ€è¦å®Œæˆä»€ä¹ˆã€‚ä¾‹å¦‚ï¼šâ€œåœ¨æˆ¿é—´é‡Œæ¼«æ¸¸è€Œä¸æ’åˆ°ä»»ä½•ä¸œè¥¿â€ã€‚</li>
<li>2. è¯†åˆ«ç›¸å…³æƒ…å¢ƒï¼š åˆ—å‡ºæ™ºèƒ½ä½“åœ¨æ‰§è¡Œä»»åŠ¡æ—¶å¯èƒ½é‡åˆ°çš„æ‰€æœ‰å…³é”®åœºæ™¯ã€‚ä¾‹å¦‚ï¼šâ€œå‰æ–¹æœ‰éšœç¢ç‰©â€ã€â€œå·¦ä¾§æœ‰éšœç¢ç‰©â€ã€â€œå³ä¾§ç©ºæ—·â€ã€â€œå‘ç°ç›®æ ‡â€ã€‚</li>
<li>3. è®¾è®¡è¡Œä¸ºæ¨¡å¼ï¼š ä¸ºæ¯ä¸ªæƒ…å¢ƒè®¾è®¡ä¸€ä¸ªç®€å•çš„ã€ç›´æ¥çš„è¡Œä¸ºã€‚
<ul>
<li>é¿éšœè¡Œä¸ºï¼š å¦‚æœå‰æ–¹è¿‘å¤„æœ‰éšœç¢ï¼Œåˆ™åé€€å¹¶è½¬å‘ã€‚</li>
<li>æ²¿å¢™è¡Œä¸ºï¼š å¦‚æœå·¦ä¾§æœ‰éšœç¢ç‰©ä¸”è·ç¦»é€‚ä¸­ï¼Œåˆ™ä¿æŒå¹³è¡Œå‰è¿›ã€‚</li>
<li>æ¼«æ¸¸è¡Œä¸ºï¼š å¦‚æœæ²¡æœ‰ç‰¹å®šè¾“å…¥ï¼Œåˆ™éšæœºæˆ–ç›´çº¿å‰è¿›ã€‚</li>
</ul>
</li>
<li>4. è®¾å®šè¡Œä¸ºä¼˜å…ˆçº§ï¼š ç¡®å®šè¡Œä¸ºçš„è½»é‡ç¼“æ€¥ã€‚é€šå¸¸ï¼Œç”Ÿå­˜ç›¸å…³ï¼ˆå¦‚é¿éšœï¼‰çš„è¡Œä¸ºä¼˜å…ˆçº§æœ€é«˜ã€‚</li>
<li>5. å®ç°ä»²è£æœºåˆ¶ï¼š ç¼–å†™ä»£ç å°†è¡Œä¸ºç»„åˆèµ·æ¥ï¼Œç¡®ä¿åœ¨ä»»ä½•æ—¶åˆ»ï¼Œæœ€é«˜ä¼˜å…ˆçº§çš„æœ‰æ•ˆè¡Œä¸ºä¸»å¯¼æ™ºèƒ½ä½“çš„è¡ŒåŠ¨ã€‚</li>
<li>6. è¿­ä»£æµ‹è¯•ä¸è°ƒä¼˜ï¼š åœ¨æ¨¡æ‹Ÿæˆ–çœŸå®ç¯å¢ƒä¸­åå¤æµ‹è¯•ï¼Œè°ƒæ•´è¡Œä¸ºçš„å‚æ•°ï¼ˆå¦‚æ¢æµ‹è·ç¦»ã€è½¬å‘é€Ÿåº¦ï¼‰ï¼Œä»¥ä¼˜åŒ–æ€§èƒ½ã€‚</li>
</ul>
<h2 data-id="heading-12">äº”ã€ç¤ºä¾‹ï¼šæœ€ç®€å•çš„æ¸…æ´æœºå™¨äºº</h2>
<p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æ‰«åœ°æœºå™¨äººæ™ºèƒ½æ§åˆ¶ç³»ç»Ÿï¼Œå®Œç¾å±•ç¤ºäº†ååº”å¼è®¾è®¡ã€‚</p>
<ul>
<li>æ„ŸçŸ¥ï¼š å½“å‰ä½ç½®çš„ä¼ æ„Ÿå™¨ï¼ˆè„ æˆ– å¹²å‡€ï¼‰ã€‚</li>
<li>è¡Œä¸ºï¼š
<ul>
<li>æ¸…æ´è¡Œä¸ºï¼š å¦‚æœ (å½“å‰ä½ç½®æ˜¯è„çš„) é‚£ä¹ˆ (å¸å°˜)</li>
<li>ç§»åŠ¨è¡Œä¸ºï¼š å¦‚æœ (å½“å‰ä½ç½®æ˜¯å¹²å‡€çš„) é‚£ä¹ˆ (éšæœºç§»åŠ¨åˆ°ä¸€ä¸ªç›¸é‚»æ ¼å­)</li>
</ul>
</li>
<li>ä»²è£ï¼š â€œæ¸…æ´è¡Œä¸ºâ€çš„ä¼˜å…ˆçº§é«˜äºâ€œç§»åŠ¨è¡Œä¸ºâ€ã€‚</li>
<li>åˆ†æï¼š æœºå™¨äººæ²¡æœ‰åœ°å›¾ï¼Œä¸çŸ¥é“å“ªäº›åœ°æ–¹æ¸…æ´è¿‡ã€‚å®ƒçš„è¡Œä¸ºå®Œå…¨åŸºäºå½“å‰çš„å±€éƒ¨æ„ŸçŸ¥ï¼Œä½†é•¿æœŸæ¥çœ‹ï¼Œå®ƒæœ€ç»ˆèƒ½æ¸…æ´æ•´ä¸ªåŒºåŸŸã€‚</li>
</ul>
<p>åœ¨ä»£ç è¿è¡Œåä½“ç°å‡ å¤§åŠŸèƒ½ç‚¹ï¼š</p>
<ul>
<li>æœºå™¨äººè‡ªä¸»å¯¼èˆªï¼šåœ¨æ²¡æœ‰åœ°å›¾çš„æƒ…å†µä¸‹é¿å¼€æ‰€æœ‰éšœç¢ç‰©</li>
<li>æ™ºèƒ½è¡Œä¸ºåˆ‡æ¢ï¼šæ ¹æ®ç¯å¢ƒè‡ªåŠ¨åœ¨é¿éšœã€æ²¿å¢™ã€æ¢ç´¢é—´åˆ‡æ¢</li>
<li>å®æ—¶å†³ç­–æ˜¾ç¤ºï¼šåŠ¨æ€æ˜¾ç¤ºå½“å‰è¡Œä¸ºå’Œä¼ æ„Ÿå™¨çŠ¶æ€</li>
<li>è½¨è¿¹åˆ†æï¼šé€šè¿‡é¢œè‰²å¯ä»¥çœ‹åˆ°ä¸åŒè¡Œä¸ºå¯¹åº”çš„è¿åŠ¨æ¨¡å¼</li>
</ul>
<h3 data-id="heading-13">1. ä»£ç é‡ç‚¹éƒ¨åˆ†</h3>
<p><strong>1.1 ä¼ æ„Ÿå™¨æ¨¡æ‹ŸåŸç†</strong></p>
<pre><code class="hljs language-ini" lang="ini">def get_sensor_readings(self, obstacles):
    <span class="hljs-attr">readings</span> = []
    for sensor_angle in self.sensor_angles:
        <span class="hljs-attr">sensor_dir</span> = np.array([
            np.cos(self.angle + sensor_angle),  <span class="hljs-comment"># ä¼ æ„Ÿå™¨æ–¹å‘å‘é‡xåˆ†é‡</span>
            np.sin(self.angle + sensor_angle)   <span class="hljs-comment"># ä¼ æ„Ÿå™¨æ–¹å‘å‘é‡yåˆ†é‡</span>
        ])
        
        <span class="hljs-attr">min_distance</span> = self.sensor_range  <span class="hljs-comment"># åˆå§‹åŒ–ä¸ºæœ€å¤§æ¢æµ‹è·ç¦»</span>
        
        for obstacle in obstacles:
            <span class="hljs-comment"># è®¡ç®—æœºå™¨äººåˆ°éšœç¢ç‰©çš„å‘é‡</span>
            <span class="hljs-attr">obstacle_pos</span> = np.array([obstacle[<span class="hljs-number">0</span>], obstacle[<span class="hljs-number">1</span>]])
            <span class="hljs-attr">robot_pos</span> = np.array([self.x, self.y])
            <span class="hljs-attr">to_obstacle</span> = obstacle_pos - robot_pos
            
            <span class="hljs-comment"># å‘é‡æŠ•å½±ï¼šåˆ¤æ–­éšœç¢ç‰©æ˜¯å¦åœ¨ä¼ æ„Ÿå™¨å‰æ–¹</span>
            <span class="hljs-attr">projection</span> = np.dot(to_obstacle, sensor_dir)
            
            if projection &gt; 0:  <span class="hljs-comment"># éšœç¢ç‰©åœ¨ä¼ æ„Ÿå™¨å‰æ–¹</span>
                <span class="hljs-comment"># è®¡ç®—éšœç¢ç‰©åˆ°ä¼ æ„Ÿå™¨å°„çº¿çš„å‚ç›´è·ç¦»</span>
                <span class="hljs-attr">distance_to_ray</span> = np.linalg.norm(to_obstacle - projection * sensor_dir)
                
                if distance_to_ray &lt; obstacle<span class="hljs-section">[2]</span>:  <span class="hljs-comment"># å¦‚æœè·ç¦»å°äºéšœç¢ç‰©åŠå¾„</span>
                    <span class="hljs-comment"># è®¡ç®—å®é™…çš„ç¢°æ’è·ç¦»</span>
                    <span class="hljs-attr">hit_distance</span> = projection - np.sqrt(obstacle[<span class="hljs-number">2</span>]**<span class="hljs-number">2</span> - distance_to_ray**<span class="hljs-number">2</span>)
                    if 0 &lt; hit_distance &lt; min_distance:
                        <span class="hljs-attr">min_distance</span> = hit_distance
            
            readings.append(min_distance)
    return readings
</code></pre>
<ul>
<li>sensor_dirï¼šè®¡ç®—æ¯ä¸ªä¼ æ„Ÿå™¨çš„æ–¹å‘å‘é‡</li>
<li>projection &gt; 0ï¼šç¡®ä¿åªæ£€æµ‹å‰æ–¹çš„éšœç¢ç‰©</li>
<li>distance_to_ray &lt; obstacle[2]ï¼šåˆ¤æ–­æ˜¯å¦ä¸éšœç¢ç‰©ç›¸äº¤</li>
<li>è¿”å›5ä¸ªä¼ æ„Ÿå™¨çš„è·ç¦»è¯»æ•°åˆ—è¡¨</li>
</ul>
<p><strong>1.2 ååº”å¼å†³ç­–æ ¸å¿ƒ</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">reactive_control</span>(<span class="hljs-params">self, sensor_readings</span>):
    <span class="hljs-comment"># ä¼ æ„Ÿå™¨åˆ†ç»„ï¼šå·¦2ä¸ªã€å‰1ä¸ªã€å³2ä¸ª</span>
    left_readings = sensor_readings[:<span class="hljs-number">2</span>]    <span class="hljs-comment"># å·¦ä¾§ä¼ æ„Ÿå™¨</span>
    front_readings = sensor_readings[<span class="hljs-number">2</span>]    <span class="hljs-comment"># å‰æ–¹ä¼ æ„Ÿå™¨  </span>
    right_readings = sensor_readings[<span class="hljs-number">3</span>:]   <span class="hljs-comment"># å³ä¾§ä¼ æ„Ÿå™¨</span>
    
    <span class="hljs-comment"># è®¡ç®—å„æ–¹å‘çš„æœ€å°è·ç¦»</span>
    min_front = <span class="hljs-built_in">min</span>(front_readings, self.sensor_range)
    min_left = <span class="hljs-built_in">min</span>(left_readings)
    min_right = <span class="hljs-built_in">min</span>(right_readings)
    
    <span class="hljs-comment"># è¡Œä¸º1: ç´§æ€¥é¿éšœ (æœ€é«˜ä¼˜å…ˆçº§)</span>
    <span class="hljs-keyword">if</span> min_front &lt; <span class="hljs-number">0.8</span>:  <span class="hljs-comment"># å‰æ–¹å¾ˆè¿‘æœ‰éšœç¢</span>
        self.speed = <span class="hljs-number">0.3</span>  <span class="hljs-comment"># å‡é€Ÿ</span>
        <span class="hljs-comment"># é€‰æ‹©æ›´ç©ºæ—·çš„ä¸€ä¾§è½¬å‘</span>
        <span class="hljs-keyword">if</span> min_left &gt; min_right:
            self.angle -= np.pi/<span class="hljs-number">4</span>  <span class="hljs-comment"># å‘å³è½¬45åº¦</span>
        <span class="hljs-keyword">else</span>:
            self.angle += np.pi/<span class="hljs-number">4</span>  <span class="hljs-comment"># å‘å·¦è½¬45åº¦</span>
        self.current_behavior = <span class="hljs-string">"ç´§æ€¥é¿éšœ"</span>
        <span class="hljs-keyword">return</span> self.current_behavior
    
    <span class="hljs-comment"># è¡Œä¸º2: é¢„é˜²æ€§é¿éšœ (ä¸­ä¼˜å…ˆçº§)</span>
    <span class="hljs-keyword">elif</span> min_front &lt; <span class="hljs-number">1.5</span>:  <span class="hljs-comment"># å‰æ–¹è¾ƒè¿‘æœ‰éšœç¢</span>
        self.speed = <span class="hljs-number">0.4</span>
        <span class="hljs-keyword">if</span> min_left &gt; min_right:
            self.angle -= np.pi/<span class="hljs-number">8</span>  <span class="hljs-comment"># å‘å³è½¬22.5åº¦</span>
        <span class="hljs-keyword">else</span>:
            self.angle += np.pi/<span class="hljs-number">8</span>  <span class="hljs-comment"># å‘å·¦è½¬22.5åº¦</span>
        self.current_behavior = <span class="hljs-string">"é¢„é˜²é¿éšœ"</span>
        <span class="hljs-keyword">return</span> self.current_behavior
    
    <span class="hljs-comment"># è¡Œä¸º3: æ²¿å¢™è·Ÿéš (ä½ä¼˜å…ˆçº§)</span>
    <span class="hljs-keyword">elif</span> min_left &lt; <span class="hljs-number">1.2</span> <span class="hljs-keyword">or</span> min_right &lt; <span class="hljs-number">1.2</span>:  <span class="hljs-comment"># ä¾§é¢æœ‰å¢™</span>
        self.speed = <span class="hljs-number">0.6</span>
        <span class="hljs-keyword">if</span> min_left &lt; min_right:  <span class="hljs-comment"># å·¦ä¾§æœ‰å¢™</span>
            self.angle -= <span class="hljs-number">0.1</span>  <span class="hljs-comment"># å‘å³å¾®è°ƒ</span>
        <span class="hljs-keyword">else</span>:  <span class="hljs-comment"># å³ä¾§æœ‰å¢™  </span>
            self.angle += <span class="hljs-number">0.1</span>  <span class="hljs-comment"># å‘å·¦å¾®è°ƒ</span>
        self.current_behavior = <span class="hljs-string">"æ²¿å¢™è·Ÿéš"</span>
        <span class="hljs-keyword">return</span> self.current_behavior
    
    <span class="hljs-comment"># è¡Œä¸º4: éšæœºæ¢ç´¢ (é»˜è®¤è¡Œä¸º)</span>
    <span class="hljs-keyword">else</span>:
        self.speed = <span class="hljs-number">0.8</span>  <span class="hljs-comment"># æ­£å¸¸é€Ÿåº¦</span>
        <span class="hljs-comment"># åŠ å…¥éšæœºæ‰°åŠ¨ï¼Œé¿å…é™·å…¥å±€éƒ¨å¾ªç¯</span>
        self.angle += random.uniform(-<span class="hljs-number">0.2</span>, <span class="hljs-number">0.2</span>)
        self.current_behavior = <span class="hljs-string">"éšæœºæ¢ç´¢"</span>
        <span class="hljs-keyword">return</span> self.current_behavior
</code></pre>
<ul>
<li>å›ºå®šä¼˜å…ˆçº§ï¼šç´§æ€¥é¿éšœ &gt; é¢„é˜²é¿éšœ &gt; æ²¿å¢™è·Ÿéš &gt; éšæœºæ¢ç´¢</li>
<li>è·ç¦»é˜ˆå€¼ï¼šä¸åŒè·ç¦»è§¦å‘ä¸åŒè¡Œä¸º</li>
<li>è½¬å‘ç­–ç•¥ï¼šæ€»æ˜¯è½¬å‘æ›´ç©ºæ—·çš„ä¸€ä¾§</li>
<li>é€Ÿåº¦è°ƒèŠ‚ï¼šå±é™©æ—¶å‡é€Ÿï¼Œå®‰å…¨æ—¶åŠ é€Ÿ</li>
</ul>
<p><strong>1.3 ä½ç½®æ›´æ–°é€»è¾‘</strong></p>
<pre><code class="hljs language-ini" lang="ini">def update_position(self, obstacles, area_bounds):
    <span class="hljs-comment"># 1. æ„ŸçŸ¥ï¼šè·å–ä¼ æ„Ÿå™¨æ•°æ®</span>
    <span class="hljs-attr">sensor_readings</span> = self.get_sensor_readings(obstacles)
    
    <span class="hljs-comment"># 2. å†³ç­–ï¼šååº”å¼æ§åˆ¶</span>
    <span class="hljs-attr">behavior</span> = self.reactive_control(sensor_readings)
    
    <span class="hljs-comment"># 3. è¡ŒåŠ¨ï¼šæ›´æ–°ä½ç½®</span>
    <span class="hljs-attr">dx</span> = self.speed * np.cos(self.angle) * <span class="hljs-number">0.1</span>  <span class="hljs-comment"># xæ–¹å‘ä½ç§»</span>
    <span class="hljs-attr">dy</span> = self.speed * np.sin(self.angle) * <span class="hljs-number">0.1</span>  <span class="hljs-comment"># yæ–¹å‘ä½ç§»</span>
    
    <span class="hljs-attr">new_x</span> = self.x + dx
    <span class="hljs-attr">new_y</span> = self.y + dy
    
    <span class="hljs-comment"># è¾¹ç•Œæ£€æŸ¥ï¼šé˜²æ­¢è·‘å‡ºç¯å¢ƒ</span>
    if (area_bounds<span class="hljs-section">[0]</span> &lt; new_x &lt; area_bounds<span class="hljs-section">[2]</span> and 
        area_bounds<span class="hljs-section">[1]</span> &lt; new_y &lt; area_bounds<span class="hljs-section">[3]</span>):
        <span class="hljs-attr">self.x</span> = new_x
        <span class="hljs-attr">self.y</span> = new_y
    
    <span class="hljs-comment"># è®°å½•è½¨è¿¹ï¼ˆæœ€å¤š100ä¸ªç‚¹ï¼‰</span>
    self.trajectory.append((self.x, self.y))
    if len(self.trajectory) &gt; 100:
        self.trajectory.pop(0)  <span class="hljs-comment"># ç§»é™¤æœ€æ—§çš„ç‚¹</span>
        
    return behavior, sensor_readings
</code></pre>
<p><strong>1.4 ç¯å¢ƒåˆ›å»ºä¸éšœç¢ç‰©è®¾ç½®</strong></p>
<pre><code class="hljs language-ini" lang="ini">def create_environment():
    <span class="hljs-comment"># éšœç¢ç‰©æ ¼å¼ï¼š(xåæ ‡, yåæ ‡, åŠå¾„)</span>
    <span class="hljs-attr">obstacles</span> = [
        (<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0.8</span>),  <span class="hljs-comment"># ä¸­å¿ƒåŒºåŸŸçš„å¤§éšœç¢ç‰©</span>
        (<span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1.0</span>),  <span class="hljs-comment"># å³ä¾§çš„å¤§éšœç¢ç‰©  </span>
        (<span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0.6</span>),  <span class="hljs-comment"># å³ä¸Šè§’çš„å°éšœç¢ç‰©</span>
        (<span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">0.7</span>),  <span class="hljs-comment"># ä¸­éƒ¨åä¸Šçš„éšœç¢ç‰©</span>
        (<span class="hljs-number">7</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0.9</span>),  <span class="hljs-comment"># å³ä¸Šè§’çš„å¤§éšœç¢ç‰©</span>
        (<span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0.5</span>),  <span class="hljs-comment"># å·¦ä¸Šè§’çš„å°éšœç¢ç‰©</span>
        (<span class="hljs-number">9</span>, <span class="hljs-number">9</span>, <span class="hljs-number">0.6</span>),  <span class="hljs-comment"># æœ€å³ä¸Šè§’çš„éšœç¢ç‰©</span>
        (<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0.4</span>)   <span class="hljs-comment"># ä¸­å¿ƒåŒºåŸŸçš„å°éšœç¢ç‰©</span>
    ]
    
    <span class="hljs-comment"># ç¯å¢ƒè¾¹ç•Œï¼š(x_min, y_min, x_max, y_max)</span>
    <span class="hljs-attr">area_bounds</span> = (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>)
    
    return obstacles, area_bounds
</code></pre>
<ul>
<li>å¤æ‚è·¯å¾„ï¼šéšœç¢ç‰©åˆ†å¸ƒå½¢æˆæ›²æŠ˜çš„é€šé“</li>
<li>å¤§å°æ··åˆï¼šä¸åŒå¤§å°çš„éšœç¢ç‰©å¢åŠ å¯¼èˆªéš¾åº¦</li>
<li>è¾¹ç•Œé™åˆ¶ï¼š10x10çš„å°é—­ç¯å¢ƒ</li>
</ul>
<p><strong>1.5 åŠ¨æ€åŠ¨ç”»çš„æ ¸å¿ƒé€»è¾‘</strong></p>
<pre><code class="hljs language-ini" lang="ini">def animate(frame):
    ax.clear()
    
    <span class="hljs-comment"># æ›´æ–°æœºå™¨äººä½ç½®ï¼ˆç¬¬ä¸€å¸§é™¤å¤–ï¼‰</span>
    if frame &gt; 0:
        behavior, <span class="hljs-attr">sensor_readings</span> = robot.update_position(obstacles, area_bounds)
    
    <span class="hljs-comment"># ç»˜åˆ¶ä¼ æ„Ÿå™¨ï¼ˆé¢œè‰²ç¼–ç ï¼‰</span>
    for i, (sensor_angle, reading) in enumerate(zip(robot.sensor_angles, sensor_readings)):
        <span class="hljs-attr">sensor_dir</span> = np.array([np.cos(robot.angle + sensor_angle), 
                              np.sin(robot.angle + sensor_angle)])
        <span class="hljs-attr">sensor_length</span> = min(reading, robot.sensor_range)
        
        <span class="hljs-attr">end_x</span> = robot.x + sensor_length * sensor_dir[<span class="hljs-number">0</span>]
        <span class="hljs-attr">end_y</span> = robot.y + sensor_length * sensor_dir[<span class="hljs-number">1</span>]
        
        <span class="hljs-comment"># é¢œè‰²ç¼–ç ï¼šç»¿è‰²(å®‰å…¨) â†’ æ©™è‰²(è­¦å‘Š) â†’ çº¢è‰²(å±é™©)</span>
        if reading &gt; 1.5:
            <span class="hljs-attr">color</span> = <span class="hljs-string">'green'</span>   <span class="hljs-comment"># å®‰å…¨è·ç¦»</span>
        elif reading &gt; 0.8:
            <span class="hljs-attr">color</span> = <span class="hljs-string">'orange'</span>  <span class="hljs-comment"># è­¦å‘Šè·ç¦»  </span>
        else:
            <span class="hljs-attr">color</span> = <span class="hljs-string">'red'</span>     <span class="hljs-comment"># å±é™©è·ç¦»</span>
            
        ax.plot(<span class="hljs-section">[robot.x, end_x]</span>, <span class="hljs-section">[robot.y, end_y]</span>, <span class="hljs-attr">color</span>=color, 
               <span class="hljs-attr">linewidth</span>=<span class="hljs-number">2</span>, alpha=<span class="hljs-number">0.7</span>)
</code></pre>
<ul>
<li>å®æ—¶æ›´æ–°ï¼šæ¯å¸§é‡æ–°ç»˜åˆ¶æ‰€æœ‰å…ƒç´ </li>
<li>é¢œè‰²ç¼–ç ï¼šç”¨é¢œè‰²ç›´è§‚æ˜¾ç¤ºä¼ æ„Ÿå™¨çŠ¶æ€</li>
<li>è½¨è¿¹æ˜¾ç¤ºï¼šä¿ç•™å†å²è½¨è¿¹æ˜¾ç¤ºè¿åŠ¨è·¯å¾„</li>
</ul>
<p><strong>1.6 ååº”å¼æ™ºèƒ½ä½“çš„æ ¸å¿ƒç‰¹å¾</strong></p>
<p><strong>ç‰¹å¾1ï¼šæ— å†…éƒ¨çŠ¶æ€æ¨¡å‹</strong></p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># æœºå™¨äººæ²¡æœ‰è®°å¿†ç¯å¢ƒåœ°å›¾ï¼Œåªä¾èµ–å½“å‰ä¼ æ„Ÿå™¨æ•°æ®</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">reactive_control</span>(<span class="hljs-params"><span class="hljs-variable language_">self</span>, sensor_readings</span>):  <span class="hljs-comment"># åªä½¿ç”¨å½“å‰ä¼ æ„Ÿå™¨è¯»æ•°</span>
    <span class="hljs-comment"># ä¸è®¿é—®å†å²æ•°æ®ï¼Œä¸ç»´æŠ¤ç¯å¢ƒæ¨¡å‹</span>
    <span class="hljs-comment"># å†³ç­–å®Œå…¨åŸºäºå½“å‰çš„sensor_readings</span>
</code></pre>
<p><strong>ç‰¹å¾2ï¼šå›ºå®šä¼˜å…ˆçº§ä»²è£</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ˜ç¡®çš„ä¼˜å…ˆçº§é¡ºåº</span>
<span class="hljs-keyword">if</span> min_front &lt; 0.8:        <span class="hljs-comment"># 1. ç´§æ€¥é¿éšœ (æœ€é«˜)</span>
<span class="hljs-keyword">elif</span> min_front &lt; 1.5:      <span class="hljs-comment"># 2. é¢„é˜²é¿éšœ  </span>
<span class="hljs-keyword">elif</span> min_left &lt; 1.2 or ... <span class="hljs-comment"># 3. æ²¿å¢™è·Ÿéš</span>
<span class="hljs-keyword">else</span>:                      <span class="hljs-comment"># 4. éšæœºæ¢ç´¢ (æœ€ä½)</span>
</code></pre>
<p><strong>ç‰¹å¾3ï¼šå®æ—¶å“åº”</strong></p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># æ¯å¸§éƒ½é‡æ–°æ„ŸçŸ¥å’Œå†³ç­–</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">update_position</span>(<span class="hljs-params"><span class="hljs-variable language_">self</span>, obstacles, area_bounds</span>):
    sensor_readings = <span class="hljs-variable language_">self</span>.get_sensor_readings(obstacles)  <span class="hljs-comment"># å®æ—¶æ„ŸçŸ¥</span>
    behavior = <span class="hljs-variable language_">self</span>.reactive_control(sensor_readings)      <span class="hljs-comment"># å®æ—¶å†³ç­–</span>
    <span class="hljs-comment"># ç«‹å³æ‰§è¡ŒåŠ¨ä½œ</span>
</code></pre>
<p><strong>ç‰¹å¾4ï¼šè¡Œä¸ºæ¶Œç°</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç®€å•è§„åˆ™ç»„åˆäº§ç”Ÿå¤æ‚è¡Œä¸º</span>
<span class="hljs-comment"># å•ä¸ªè§„åˆ™å¾ˆç®€å•ï¼Œä½†ç»„åˆåèƒ½ï¼š</span>
<span class="hljs-comment"># - è‡ªä¸»é¿å¼€æ‰€æœ‰éšœç¢ç‰©</span>
<span class="hljs-comment"># - æ²¿ç€å¢™å£è¡Œèµ°  </span>
<span class="hljs-comment"># - æ¢ç´¢æœªçŸ¥åŒºåŸŸ</span>
<span class="hljs-comment"># - ä¸ä¼šé™·å…¥æ­»å¾ªç¯</span>
</code></pre>
<h3 data-id="heading-14">2. è¾“å‡ºç»“æœ</h3>
<p>ååº”å¼æœºå™¨äººçš„åŠ¨æ€è·¯å¾„ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83dd8fc66f8242feb48f98a75559d750~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b285bK46Iqx5byA5LqG5ZCX:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766283064&amp;x-signature=VLy8WxKctvCIyUG4JJ1EO%2BwhJOU%3D" alt="" loading="lazy"/></p>
<p>ååº”å¼æœºå™¨äººçš„é™æ€è½¨è¿¹å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7094b19bfe6b46258788d9d0b2436e3b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b285bK46Iqx5byA5LqG5ZCX:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766283064&amp;x-signature=WfI6eJnhPbky1LKrKjI41DoizRc%3D" alt="" loading="lazy"/></p>
<p>ååº”å¼æœºå™¨äººçš„ä¼ æ„Ÿå™¨å·¥ä½œåŸç†ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/42e4fea416994987bb327609da4077a2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b285bK46Iqx5byA5LqG5ZCX:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766283064&amp;x-signature=I1YvBZVAGcPGsfXnrq4YB0daCIk%3D" alt="" loading="lazy"/></p>
<p>ååº”å¼æœºå™¨äººçš„æ™ºèƒ½ä½“å¯¹æ¯”ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85213ffbdae248b1a08e273ada75ec06~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b285bK46Iqx5byA5LqG5ZCX:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766283064&amp;x-signature=CGByCgc8SbTDcqOZ9K5AvYnBAkk%3D" alt="" loading="lazy"/><img alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" src="" loading="lazy"/>â€‹ç¼–è¾‘ååº”å¼æœºå™¨äººçš„è¡Œä¸ºåˆ†æï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1665e8ca736c4a518c620e8843bfc457~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b285bK46Iqx5byA5LqG5ZCX:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766283064&amp;x-signature=Ac2DEkddZIdBjglxLMYvI2xC8NA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-15">å…­ã€æ€»ç»“</h2>
<p>ååº”å¼æ™ºèƒ½ä½“ä»¥å…¶ç®€å•ã€å¿«é€Ÿã€å¯é çš„æ ¸å¿ƒä¼˜åŠ¿ï¼Œåœ¨AIé¢†åŸŸå æ®äº†ä¸å¯æ›¿ä»£çš„ä¸€å¸­ä¹‹åœ°ã€‚å®ƒå®Œç¾åœ°è¯ é‡Šäº†â€œç®€å•è§„åˆ™äº§ç”Ÿå¤æ‚è¡Œä¸ºâ€çš„æ¶Œç°æ™ºæ…§ã€‚</p>
<ul>
<li>å®ƒçš„ä¸»è¦ä¼˜åŠ¿åœ¨äºï¼šå“åº”å»¶è¿Ÿæä½ã€å¯¹ä¼ æ„Ÿå™¨é”™è¯¯ä¸æ•æ„Ÿã€å¼€å‘å’Œè°ƒè¯•ç›¸å¯¹ç®€å•ã€‚</li>
<li>å®ƒçš„ä¸»è¦å±€é™åœ¨äºï¼šç¼ºä¹é•¿è¿œè§„åˆ’èƒ½åŠ›ï¼Œåœ¨éœ€è¦æ·±æ€ç†Ÿè™‘çš„ä»»åŠ¡ä¸­æ˜¾å¾—æ„šè ¢ã€‚</li>
</ul>
<p>ååº”å¼æ™ºèƒ½ä½“ä»£è¡¨çš„æ˜¯ä¸€ç§å·¥ç¨‹å“²å­¦ï¼šç”¨ç®€å•ã€å¯é ã€å¯éªŒè¯çš„ç»„ä»¶æ„å»ºå¤æ‚çš„æ™ºèƒ½ç³»ç»Ÿã€‚å®ƒæé†’æˆ‘ä»¬ï¼Œæœ‰æ—¶å€™æœ€æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆä¸ä¸€å®šæ˜¯æœ€å¤æ‚çš„ã€‚</p>
<p>å°±åƒè‡ªç„¶ç•Œä¸­çš„èš‚èšï¼Œæ¯ä¸ªä¸ªä½“éƒ½éµå¾ªç®€å•çš„è§„åˆ™ï¼Œä½†æ•´ä¸ªèšç¾¤å´å±•ç°å‡ºä»¤äººæƒŠå¹çš„é›†ä½“æ™ºæ…§ã€‚ååº”å¼æ™ºèƒ½ä½“æ•™ä¼šæˆ‘ä»¬ï¼šæ™ºèƒ½ä¸ä¸€å®šæºäºå¤æ‚çš„è®¡ç®—ï¼Œä¹Ÿå¯ä»¥æ¥è‡ªç®€å•è§„åˆ™ä¸ç¯å¢ƒä¹‹é—´çš„å·§å¦™äº’åŠ¨ã€‚</p>
<p>åœ¨è¿½æ±‚æ›´å¤æ‚AIæŠ€æœ¯çš„ä»Šå¤©ï¼Œç†è§£ååº”å¼æ™ºèƒ½ä½“çš„åŸç†å’Œä»·å€¼ï¼Œä¸ä»…æœ‰åŠ©äºæˆ‘ä»¬æ„å»ºæ›´å¯é çš„å®æ—¶ç³»ç»Ÿï¼Œä¹Ÿä¸ºæˆ‘ä»¬ç†è§£æ™ºèƒ½çš„æœ¬è´¨æä¾›äº†é‡è¦çš„è§†è§’ã€‚æœ‰æ—¶å€™ï¼Œåé€€ä¸€æ­¥ï¼Œé‡‡ç”¨æ›´ç®€å•çš„æ–¹æ³•ï¼Œåè€Œèƒ½å¤Ÿèµ°å¾—æ›´è¿œã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Linuxæ•…éšœè¯Šæ–­ç³»åˆ—2-è¯Šæ–­ç³»ç»Ÿå¯åŠ¨é—®é¢˜&è¯†åˆ«ç¡¬ä»¶æ•…éšœ]]></title>    <link>https://juejin.cn/post/7583138169378979890</link>    <guid>https://juejin.cn/post/7583138169378979890</guid>    <pubDate>2025-12-14T03:05:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583138169378979890" data-draft-id="7582905804048777243" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Linuxæ•…éšœè¯Šæ–­ç³»åˆ—2-è¯Šæ–­ç³»ç»Ÿå¯åŠ¨é—®é¢˜&amp;è¯†åˆ«ç¡¬ä»¶æ•…éšœ"/> <meta itemprop="keywords" content="Linux"/> <meta itemprop="datePublished" content="2025-12-14T03:05:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æºå®‡å®™åä¸‰ç«™"/> <meta itemprop="url" content="https://juejin.cn/user/1153816643768987"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Linuxæ•…éšœè¯Šæ–­ç³»åˆ—2-è¯Šæ–­ç³»ç»Ÿå¯åŠ¨é—®é¢˜&amp;è¯†åˆ«ç¡¬ä»¶æ•…éšœ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1153816643768987/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æºå®‡å®™åä¸‰ç«™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T03:05:22.000Z" title="Sun Dec 14 2025 03:05:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸš¨ Linuxç³»ç»Ÿå¯åŠ¨æ•‘æ€¥æŒ‡å— | æœåŠ¡å™¨å¼€ä¸äº†æœºï¼Ÿè¿™äº›æŠ€èƒ½è®©ä½ 3åˆ†é’Ÿæå®šï¼</h2>
<h3 data-id="heading-1">ğŸ“– å†™åœ¨å¼€å¤´ï¼šä½ æ˜¯ä¸æ˜¯ä¹Ÿè¿™æ ·ï¼Ÿ</h3>
<p><strong>ç¬¬ä¸€æ®µï¼šç—›ç‚¹åœºæ™¯</strong></p>
<p>ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™æ ·çš„å™©æ¢¦åœºæ™¯ï¼ŸåŠå¤œä¸‰æ›´ï¼ŒæœåŠ¡å™¨çªç„¶å®•æœºï¼Œé‡å¯åå±å¹•ä¸€ç‰‡æ¼†é»‘ï¼Œåªæ˜¾ç¤º"GRUB&gt;"æˆ–è€…å¹²è„†è¿›ä¸äº†ç³»ç»Ÿã€‚ä½ æ‹¼å‘½æŒ‰F2ã€F12ã€Deleteé”®ï¼Œä½†ç³»ç»Ÿå°±æ˜¯ä¸ç†ä½ ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œè€æ¿çš„å¤ºå‘½è¿ç¯Callå·²ç»æ‰“è¿‡æ¥äº†ï¼š"ç³»ç»Ÿæ€ä¹ˆæŒ‚äº†ï¼Ÿä»€ä¹ˆæ—¶å€™èƒ½æ¢å¤ï¼Ÿæˆ‘ä»¬çš„ä¸šåŠ¡æŸå¤±è°æ¥æ‰¿æ‹…ï¼Ÿ"</p>
<p>å¦‚æœä½ ä¹Ÿç»å†è¿‡è¿™ç§"å¼€æœºå³ç»æœ›"çš„æ—¶åˆ»ï¼Œé‚£ä¹ˆä»Šå¤©FYCè¦å‘Šè¯‰ä½ ä¸€ä¸ªå¥½æ¶ˆæ¯ï¼š<strong>ç³»ç»Ÿå¯åŠ¨é—®é¢˜å…¶å®æœ‰ç« å¯å¾ªï¼ŒæŒæ¡äº†æ­£ç¡®çš„æ–¹æ³•ï¼Œä½ å°±èƒ½åƒé­”æ³•å¸ˆä¸€æ ·è®©æœåŠ¡å™¨"èµ·æ­»å›ç”Ÿ"ï¼</strong></p>
<p>ä¸ä»…å¦‚æ­¤ï¼Œæˆ‘ä»¬è¿˜è¦èŠèŠ<strong>å¦‚ä½•è¯†åˆ«ç¡¬ä»¶æ•…éšœ</strong>ã€‚æ¯•ç«Ÿï¼Œå¦‚æœç¡¬ä»¶æœ¬èº«æœ‰é—®é¢˜ï¼Œå†å¥½çš„è½¯ä»¶é…ç½®ä¹Ÿæ˜¯ç™½æ­ã€‚å­¦ä¼šäº†è¿™äº›æŠ€èƒ½ï¼Œä½ å°±èƒ½ä»"æ•‘ç«é˜Ÿå‘˜"å‡çº§ä¸º"ç³»ç»ŸåŒ»ç”Ÿ"ï¼</p>
<p><strong>ç¬¬äºŒæ®µï¼šè§£å†³æ–¹æ¡ˆæ¦‚è¿°</strong></p>
<p>ä»Šå¤©æˆ‘ä»¬è¦èŠçš„æ˜¯<strong>Linuxç³»ç»Ÿå¯åŠ¨é—®é¢˜è¯Šæ–­å’Œç¡¬ä»¶æ•…éšœè¯†åˆ«</strong>ï¼Œè¿™æ˜¯æ¯ä¸ªè¿ç»´å·¥ç¨‹å¸ˆéƒ½å¿…é¡»æŒæ¡çš„ç”Ÿå­˜æŠ€èƒ½ã€‚æˆ‘ä»¬å°†ä»BIOS/UEFIå¯åŠ¨åŸç†è®²èµ·ï¼Œå¸¦ä½ ä¸€æ­¥æ­¥å­¦ä¼šå¦‚ä½•ä¿®å¤å¯åŠ¨åŠ è½½å™¨ã€è§£å†³æœåŠ¡ä¾èµ–é—®é¢˜ã€æ¢å¤ä¸¢å¤±çš„rootå¯†ç ï¼Œä»¥åŠå¦‚ä½•å¿«é€Ÿè¯†åˆ«å’Œå®šä½ç¡¬ä»¶æ•…éšœã€‚</p>
<p>æœ¬æ–‡å°†ä¸ºä½ å¸¦æ¥ï¼š</p>
<ul>
<li>ğŸ¯ <strong>å¯åŠ¨é—®é¢˜è¯Šæ–­ä¸‰éƒ¨æ›²</strong>ï¼šBIOS/UEFIå¯åŠ¨ä¿®å¤ã€æœåŠ¡ä¾èµ–æ’æŸ¥ã€rootå¯†ç æ¢å¤</li>
<li>ğŸ”§ <strong>ç¡¬ä»¶è¯†åˆ«ç¥å™¨</strong>ï¼šCPUã€å†…å­˜ã€ç£ç›˜ã€PCIã€USBå…¨æ–¹ä½è¯†åˆ«å·¥å…·</li>
<li>ğŸ“Š <strong>ç¡¬ä»¶é”™è¯¯ç›‘æ§</strong>ï¼šmcelogã€rasdaemonå¸®ä½ æå‰å‘ç°ç¡¬ä»¶é—®é¢˜</li>
<li>ğŸš€ <strong>è™šæ‹ŸåŒ–æ•…éšœæ’é™¤</strong>ï¼šKVMæ”¯æŒæ£€æŸ¥ã€èµ„æºè¿‡åº¦åˆ†é…ã€ç½‘ç»œé…ç½®é—®é¢˜</li>
<li>ğŸ’¡ <strong>å®æˆ˜æ¡ˆä¾‹è§£æ</strong>ï¼šçœŸå®åœºæ™¯ä¸‹çš„å¯åŠ¨æ•…éšœå’Œç¡¬ä»¶æ•…éšœæ’é™¤å…¨è¿‡ç¨‹</li>
</ul>
<p>è·Ÿç€FYCèµ°ï¼Œä»æ­¤å‘Šåˆ«"å¼€æœºå³ç»æœ›"çš„æ—¶ä»£ï¼</p>
<p><strong>ç¬¬ä¸‰æ®µï¼š5ç»´åº¦è¯„åˆ†è¡¨</strong></p>



































<table><thead><tr><th>ç»´åº¦</th><th>è¯„åˆ†</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>éš¾åº¦ç­‰çº§</strong></td><td>â­â­â­â­</td><td>éœ€è¦æ·±å…¥ç†è§£å¯åŠ¨æµç¨‹å’Œç¡¬ä»¶åŸç†</td></tr><tr><td><strong>å®ç”¨ä»·å€¼</strong></td><td>â­â­â­â­â­</td><td>æ—¥å¸¸å·¥ä½œä¸­å…³é”®æ—¶åˆ»çš„æ•‘å‘½ç¨»è‰</td></tr><tr><td><strong>æŠ€æœ¯æ·±åº¦</strong></td><td>â­â­â­â­</td><td>ä»å¯åŠ¨æµç¨‹åˆ°ç¡¬ä»¶è¯Šæ–­çš„å…¨é¢è¦†ç›–</td></tr><tr><td><strong>å¯æ“ä½œæ€§</strong></td><td>â­â­â­â­â­</td><td>æ‰€æœ‰å‘½ä»¤å’Œå·¥å…·éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨</td></tr><tr><td><strong>ç´§æ€¥æ€§</strong></td><td>â­â­â­â­â­</td><td>ç³»ç»Ÿå¯åŠ¨é—®é¢˜é€šå¸¸æ˜¯æœ€é«˜ä¼˜å…ˆçº§çš„æ•…éšœ</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-2">ğŸ“š æ­£æ–‡ï¼šå¹²è´§æ»¡æ»¡ï¼Œä½†è¦"å–‚åˆ°å˜´é‡Œ"ï¼</h3>
<h4 data-id="heading-3">ğŸš€ ä¸€ã€å¯åŠ¨é—®é¢˜çš„æ•…éšœæ’é™¤ï¼šè®©ç³»ç»Ÿ"èµ·æ­»å›ç”Ÿ"</h4>
<p>æœåŠ¡å™¨å¼€ä¸äº†æœºï¼Œå¯èƒ½æ˜¯æœ€è®©è¿ç»´å·¥ç¨‹å¸ˆå¤´ç–¼çš„é—®é¢˜ã€‚ä½†æ˜¯åˆ«æ…Œï¼ŒFYCè¿™å°±æ¥æ•™ä½ å¦‚ä½•ä¸€æ­¥æ­¥æ’æŸ¥å’Œä¿®å¤ï¼</p>
<h5 data-id="heading-4">ğŸ“‹ <strong>å¯åŠ¨æµç¨‹å›é¡¾ï¼šäº†è§£å¯åŠ¨çš„æ¯ä¸€ä¸ªç¯èŠ‚</strong></h5>
<p>åœ¨åŠ¨æ‰‹ä¿®ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¦ææ¸…æ¥šç³»ç»Ÿæ˜¯æ€ä¹ˆå¯åŠ¨çš„ã€‚ä¸€ä¸ªå®Œæ•´çš„å¯åŠ¨æµç¨‹åŒ…æ‹¬<strong>10ä¸ªå…³é”®æ­¥éª¤</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> BIOS firmwareå¯åŠ¨ â†’ æ‰§è¡Œå¼€æœºè‡ªæ£€ï¼ˆPOSTï¼‰
<span class="hljs-bullet">2.</span> BIOSæ‰«æå¯åŠ¨è®¾å¤‡ â†’ æŒ‰ä¼˜å…ˆçº§æ’åº
<span class="hljs-bullet">3.</span> æŸ¥æ‰¾å¯åŠ¨è®°å½• â†’ MBRæˆ–å¯å¯åŠ¨åˆ†åŒº
<span class="hljs-bullet">4.</span> åŠ è½½ç¬¬ä¸€çº§Boot Loader â†’ ä»MBRè¯»å–
<span class="hljs-bullet">5.</span> åŠ è½½ç¬¬äºŒçº§Boot Loader â†’ grub2é…ç½®æ–‡ä»¶
<span class="hljs-bullet">6.</span> è§£ægrub.cfg â†’ é€‰æ‹©å¯åŠ¨é¡¹
<span class="hljs-bullet">7.</span> åŠ è½½å†…æ ¸å’Œinitrd â†’ å‡†å¤‡å¯åŠ¨
<span class="hljs-bullet">8.</span> å†…æ ¸åˆå§‹åŒ–ç¡¬ä»¶ â†’ åŠ è½½é©±åŠ¨
<span class="hljs-bullet">9.</span> æŒ‚è½½æ ¹æ–‡ä»¶ç³»ç»Ÿ â†’ åˆ‡æ¢åˆ°çœŸå®æ ¹
<span class="hljs-bullet">10.</span> å¯åŠ¨systemd â†’ åŠ è½½æœåŠ¡
</code></pre>
<p>å¦‚æœè¿™10æ­¥ä¸­ä»»ä½•ä¸€æ­¥å‡ºäº†é—®é¢˜ï¼Œç³»ç»Ÿå°±å¯åŠ¨ä¸äº†ï¼è€Œå¤§éƒ¨åˆ†å¯åŠ¨é—®é¢˜éƒ½å‡ºåœ¨<strong>æ­¥éª¤4-6</strong>ï¼Œä¹Ÿå°±æ˜¯Boot Loaderé˜¶æ®µã€‚</p>
<hr/>
<h4 data-id="heading-5">ğŸ”§ äºŒã€ä¿®å¤ä¼ ç»ŸBIOSç³»ç»Ÿçš„å¯åŠ¨é—®é¢˜</h4>
<p>å¦‚æœä½ çš„æœåŠ¡å™¨è¿˜åœ¨ä½¿ç”¨ä¼ ç»Ÿçš„BIOSï¼Œé‚£ä¹ˆGRUB2çš„ä¿®å¤æ–¹æ³•å°±æ˜¯ä½ çš„æ•‘å‘½ç¨»è‰ï¼</p>
<h5 data-id="heading-6"><strong>GRUB2æ–‡ä»¶ç»“æ„ï¼šçŸ¥é“æ–‡ä»¶åœ¨å“ªé‡Œï¼Œæ‰èƒ½ä¿®å¥½å®ƒ</strong></h5>
<p>GRUB2çš„å…³é”®æ–‡ä»¶åˆ†å¸ƒåœ¨ä»¥ä¸‹å‡ ä¸ªä½ç½®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/boot/                           <span class="hljs-comment"># å†…æ ¸å’Œåˆå§‹RAMDISKS</span>
/boot/grub2/                     <span class="hljs-comment"># é…ç½®æ–‡ä»¶ã€æ‰©å±•æ¨¡å—ã€ä¸»é¢˜</span>
/boot/grub2/grub.cfg             <span class="hljs-comment"># ä¸»è¦é…ç½®æ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼Œä¸è¦æ‰‹åŠ¨ç¼–è¾‘ï¼ï¼‰</span>
/etc/grub.d/                     <span class="hljs-comment"># ç”Ÿæˆé…ç½®æ–‡ä»¶çš„è„šæœ¬</span>
/etc/default/grub                 <span class="hljs-comment"># é…ç½®æ–‡ä»¶å˜é‡ï¼ˆåº”è¯¥ç¼–è¾‘è¿™ä¸ªï¼ï¼‰</span>
/boot/grub2/grubenv              <span class="hljs-comment"># å­˜å‚¨ç¯å¢ƒå˜é‡</span>
</code></pre>
<p><strong>âš ï¸ é‡è¦æç¤º</strong>ï¼š<code>/boot/grub2/grub.cfg</code>æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œåƒä¸‡ä¸è¦æ‰‹åŠ¨ç¼–è¾‘ï¼è¦ä¿®æ”¹GRUB2é…ç½®ï¼Œåº”è¯¥ç¼–è¾‘ <code>/etc/default/grub</code>ï¼Œç„¶åè¿è¡Œ <code>grub2-mkconfig</code>é‡æ–°ç”Ÿæˆã€‚</p>
<h5 data-id="heading-7"><strong>é…ç½®GRUB2ï¼šä¿®æ”¹è¿™äº›å‚æ•°å°±å¤Ÿäº†</strong></h5>
<p>å¸¸ç”¨é…ç½®å‚æ•°ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¼–è¾‘GRUBé…ç½®</span>
vim /etc/default/grub

<span class="hljs-comment"># ä¸»è¦å‚æ•°è¯´æ˜ï¼š</span>
GRUB_TIMEOUT=5              <span class="hljs-comment"># å¯åŠ¨èœå•æ˜¾ç¤ºæ—¶é—´ï¼ˆç§’ï¼‰</span>
GRUB_DEFAULT=0              <span class="hljs-comment"># é»˜è®¤å¯åŠ¨é¡¹ï¼ˆä»0å¼€å§‹è®¡æ•°ï¼‰</span>
GRUB_DEFAULT=saved          <span class="hljs-comment"># ä½¿ç”¨ä¸Šæ¬¡ä¿å­˜çš„é€‰æ‹©</span>
GRUB_CMDLINE_LINUX=<span class="hljs-string">"..."</span>    <span class="hljs-comment"># å†…æ ¸å‘½ä»¤è¡Œå‚æ•°</span>

<span class="hljs-comment"># é‡æ–°ç”Ÿæˆé…ç½®æ–‡ä»¶</span>
grub2-mkconfig -o /boot/grub2/grub.cfg
</code></pre>
<p><strong>å®æˆ˜ç¤ºä¾‹</strong>ï¼šä¿®æ”¹å¯åŠ¨è¶…æ—¶æ—¶é—´</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ç¼–è¾‘é…ç½®æ–‡ä»¶</span>
vim /etc/default/grub
<span class="hljs-comment"># ä¿®æ”¹ï¼šGRUB_TIMEOUT=10  ï¼ˆæ”¹ä¸º10ç§’ï¼‰</span>

<span class="hljs-comment"># 2. é‡æ–°ç”Ÿæˆgrub.cfg</span>
grub2-mkconfig -o /boot/grub2/grub.cfg

<span class="hljs-comment"># 3. éªŒè¯é…ç½®</span>
grep <span class="hljs-built_in">timeout</span> /boot/grub2/grub.cfg
</code></pre>
<h5 data-id="heading-8"><strong>åœ¨MBRä¸­é‡æ–°å®‰è£…GRUB2ï¼šä¿®å¤å¯åŠ¨åŠ è½½å™¨çš„ç»ˆææ–¹æ³•</strong></h5>
<p>å¦‚æœGRUB2è¢«ç ´åæˆ–MBRæŸåï¼Œä½ éœ€è¦åœ¨æ•‘æ´æ¨¡å¼ä¸‹é‡æ–°å®‰è£…ï¼š</p>
<p><strong>æ–¹æ³•1ï¼šä½¿ç”¨æ•‘æ´æ¨¡å¼ï¼ˆæ¨èï¼‰</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ä»å®‰è£…ä»‹è´¨å¯åŠ¨ï¼Œé€‰æ‹©"Rescue an installed system"</span>
<span class="hljs-comment"># 2. é€‰æ‹©é€‰é¡¹1ï¼ˆContinueï¼‰ï¼Œç³»ç»Ÿä¼šæŒ‚è½½åˆ° /mnt/sysimage</span>
<span class="hljs-comment"># 3. æŒ‰å›è½¦è·å¾—shell</span>

<span class="hljs-comment"># 4. chrootåˆ°ç³»ç»Ÿ</span>
<span class="hljs-built_in">chroot</span> /mnt/sysimage

<span class="hljs-comment"># 5. éªŒè¯/bootæ˜¯å¦æŒ‚è½½</span>
<span class="hljs-built_in">ls</span> -l /boot

<span class="hljs-comment"># 6. é‡æ–°å®‰è£…GRUB2åˆ°MBR</span>
grub2-install /dev/vda    <span class="hljs-comment"># æ ¹æ®ä½ çš„ç£ç›˜è®¾å¤‡åè°ƒæ•´</span>

<span class="hljs-comment"># 7. é‡æ–°ç”Ÿæˆé…ç½®æ–‡ä»¶</span>
grub2-mkconfig -o /boot/grub2/grub.cfg

<span class="hljs-comment"># 8. é€€å‡ºå¹¶é‡å¯</span>
<span class="hljs-built_in">exit</span>
reboot
</code></pre>
<p><strong>æ–¹æ³•2ï¼šåœ¨è¿è¡Œä¸­çš„ç³»ç»Ÿä¸Šä¿®å¤ï¼ˆå¦‚æœè¿˜èƒ½ç™»å½•ï¼‰</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¦‚æœç³»ç»Ÿè¿˜èƒ½å¯åŠ¨ï¼Œç›´æ¥è¿è¡Œ</span>
grub2-install /dev/vda
grub2-mkconfig -o /boot/grub2/grub.cfg
</code></pre>
<hr/>
<h4 data-id="heading-9">ğŸ”Œ ä¸‰ã€è§£å†³UEFIç³»ç»Ÿä¸Šçš„å¯åŠ¨åŠ è½½å™¨é—®é¢˜</h4>
<p>å¦‚æœä½ çš„æœåŠ¡å™¨ä½¿ç”¨çš„æ˜¯UEFIï¼ˆç°åœ¨å¤§éƒ¨åˆ†æ–°æœåŠ¡å™¨éƒ½æ˜¯ï¼‰ï¼Œé‚£ä¹ˆä¿®å¤æ–¹æ³•ä¼šæœ‰æ‰€ä¸åŒã€‚</p>
<h5 data-id="heading-10"><strong>UEFI vs BIOSï¼šå…³é”®åŒºåˆ«è¦çŸ¥é“</strong></h5>






























<table><thead><tr><th>ç‰¹æ€§</th><th>BIOS</th><th>UEFI</th></tr></thead><tbody><tr><td><strong>å¯åŠ¨è®°å½•</strong></td><td>MBRï¼ˆ512å­—èŠ‚ï¼‰</td><td>GPTï¼ˆåˆ†åŒºè¡¨ï¼‰</td></tr><tr><td><strong>ç£ç›˜å¤§å°</strong></td><td>æœ€å¤§2TiB</td><td>è¶…è¿‡2TiB</td></tr><tr><td><strong>å¯åŠ¨æ³¨å†Œ</strong></td><td>æ‰«æè®¾å¤‡</td><td>æ“ä½œç³»ç»Ÿæ³¨å†Œ</td></tr><tr><td><strong>é…ç½®æ–‡ä»¶</strong></td><td>/boot/grub2/grub.cfg</td><td>/boot/efi/EFI/redhat/grub.cfg</td></tr></tbody></table>
<h5 data-id="heading-11"><strong>UEFIå¯åŠ¨é“¾ï¼šshim â†’ grub â†’ kernel</strong></h5>
<p>UEFIç³»ç»Ÿä½¿ç”¨<strong>shim</strong>ä½œä¸ºå®‰å…¨å¯åŠ¨çš„æ¡¥æ¢ï¼š</p>
<pre><code class="hljs">UEFIå›ºä»¶ â†’ shim.efi â†’ grubx64.efi â†’ kernel
</code></pre>
<p><strong>shimçš„ä½œç”¨</strong>ï¼š</p>
<ul>
<li>ç”¨UEFIå›ºä»¶ä¿¡ä»»çš„å¯†é’¥ç­¾å</li>
<li>éªŒè¯å¹¶åŠ è½½grubx64.efi</li>
<li>æ”¯æŒSecure Bootï¼ˆå®‰å…¨å¯åŠ¨ï¼‰</li>
</ul>
<h5 data-id="heading-12"><strong>ä¿®å¤UEFIå¯åŠ¨é—®é¢˜ï¼šä¸‰æ­¥æå®š</strong></h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. é‡æ–°å®‰è£…grub2-efiå’Œshim</span>
yum reinstall grub2-efi shim

<span class="hljs-comment"># 2. å¦‚æœé…ç½®æ–‡ä»¶è¢«åˆ é™¤ï¼Œé‡æ–°ç”Ÿæˆ</span>
grub2-mkconfig -o /boot/efi/EFI/redhat/grub.cfg

<span class="hljs-comment"># 3. å¦‚æœUEFIå¯åŠ¨èœå•è¢«åˆ é™¤ï¼Œé‡å¯ä¼šè‡ªåŠ¨æ·»åŠ å›æ¥</span>
</code></pre>
<h5 data-id="heading-13"><strong>ç®¡ç†UEFIå¯åŠ¨ç›®æ ‡ï¼šefibootmgrç¥å™¨</strong></h5>
<p><code>efibootmgr</code>æ˜¯ç®¡ç†UEFIå¯åŠ¨æ¡ç›®çš„ä¸“ç”¨å·¥å…·ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…å·¥å…·</span>
yum install -y efibootmgr

<span class="hljs-comment"># æŸ¥çœ‹å½“å‰å¯åŠ¨ç›®æ ‡</span>
efibootmgr

<span class="hljs-comment"># åˆ é™¤å¯åŠ¨æ¡ç›®</span>
efibootmgr -B -b 001E

<span class="hljs-comment"># è®¾ç½®ä¸´æ—¶å¯åŠ¨ç›®æ ‡ï¼ˆä¸‹æ¬¡å¯åŠ¨ç”Ÿæ•ˆï¼‰</span>
efibootmgr -n -b 002C

<span class="hljs-comment"># æ·»åŠ æ–°çš„å¯åŠ¨æ¡ç›®</span>
efibootmgr -c -d /dev/sda -p 2 -L <span class="hljs-string">"MyLinux"</span> -l <span class="hljs-string">"\EFI\redhat\grubx64.efi"</span>
<span class="hljs-comment"># æ³¨æ„ï¼šè·¯å¾„ä¸­çš„æ–œæ è¦åæ–œæ ï¼</span>
</code></pre>
<hr/>
<h4 data-id="heading-14">âš™ï¸ å››ã€å¤„ç†å¤±è´¥çš„æœåŠ¡ï¼šsystemdä¾èµ–å…³ç³»æ’æŸ¥</h4>
<p>ç³»ç»Ÿèƒ½å¯åŠ¨äº†ï¼Œä½†æœåŠ¡èµ·ä¸æ¥ï¼Ÿè¿™é€šå¸¸æ˜¯<strong>æœåŠ¡ä¾èµ–å…³ç³»</strong>å‡ºäº†é—®é¢˜ï¼</p>
<h5 data-id="heading-15"><strong>systemdä¾èµ–å…³ç³»ç±»å‹ï¼šå…­ç§å…³ç³»è¦çŸ¥é“</strong></h5>
<p>systemdæ”¯æŒå…­ç§ä¾èµ–å…³ç³»ï¼š</p>
<ol>
<li>
<p><strong>Requires=</strong>ï¼šå¼ºä¾èµ–ï¼Œå¿…éœ€çš„æœåŠ¡</p>
<ul>
<li>å¦‚æœä¾èµ–çš„æœåŠ¡å¯åŠ¨å¤±è´¥ï¼Œå½“å‰æœåŠ¡ä¹Ÿä¼šå¤±è´¥</li>
</ul>
</li>
<li>
<p><strong>Wants=</strong>ï¼šå¼±ä¾èµ–ï¼Œå¯é€‰çš„æœåŠ¡</p>
<ul>
<li>å¦‚æœä¾èµ–çš„æœåŠ¡å¯åŠ¨å¤±è´¥ï¼Œå½“å‰æœåŠ¡ä»ç„¶å¯ä»¥å¯åŠ¨</li>
</ul>
</li>
<li>
<p><strong>Requisite=</strong>ï¼šå¿…éœ€ä¸”å·²è¿è¡Œ</p>
<ul>
<li>ä¾èµ–çš„æœåŠ¡å¿…é¡»å·²ç»åœ¨è¿è¡Œï¼Œå¦åˆ™å¤±è´¥</li>
</ul>
</li>
<li>
<p><strong>Conflicts=</strong>ï¼šå†²çªå…³ç³»</p>
<ul>
<li>å¯åŠ¨å½“å‰æœåŠ¡ä¼šåœæ­¢å†²çªçš„æœåŠ¡</li>
</ul>
</li>
<li>
<p><strong>Before= / After=</strong>ï¼šå¯åŠ¨é¡ºåº</p>
<ul>
<li>æŒ‡å®šæœåŠ¡å¯åŠ¨çš„å…ˆåé¡ºåº</li>
</ul>
</li>
<li>
<p><strong>RequiresOverridable=</strong>ï¼šå¯è¦†ç›–çš„ä¾èµ–</p>
<ul>
<li>ç®¡ç†å‘˜æ˜ç¡®å¯åŠ¨æ—¶ï¼Œå¤±è´¥ä¸ä¼šå¯¼è‡´å•å…ƒå¤±è´¥</li>
</ul>
</li>
</ol>
<h5 data-id="heading-16"><strong>æ£€æŸ¥æœåŠ¡ä¾èµ–ï¼šä¸‰ç§æ–¹æ³•ä»»ä½ é€‰</strong></h5>
<p><strong>æ–¹æ³•1ï¼šæŸ¥çœ‹æœåŠ¡è¯¦æƒ…</strong></p>
<pre><code class="hljs language-bash" lang="bash">systemctl show httpd.service
</code></pre>
<p><strong>æ–¹æ³•2ï¼šæŸ¥çœ‹ä¾èµ–æ ‘ï¼ˆæœ€å¸¸ç”¨ï¼ï¼‰</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹æœåŠ¡çš„æ‰€æœ‰ä¾èµ–ï¼ˆæ ‘çŠ¶å›¾ï¼‰</span>
systemctl list-dependencies httpd.service

<span class="hljs-comment"># é€’å½’æŸ¥çœ‹æ‰€æœ‰ä¾èµ–</span>
systemctl list-dependencies --all httpd.service

<span class="hljs-comment"># åå‘æŸ¥çœ‹ï¼ˆè°ä¾èµ–è¿™ä¸ªæœåŠ¡ï¼‰</span>
systemctl list-dependencies --reverse httpd.service
</code></pre>
<p><strong>æ–¹æ³•3ï¼šå›¾å½¢åŒ–æŸ¥çœ‹ä¾èµ–</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…graphviz</span>
yum install -y graphviz

<span class="hljs-comment"># ç”Ÿæˆä¾èµ–å›¾</span>
systemd-analyze dot httpd.service | dot -Tsvg &gt; httpd-deps.svg
</code></pre>
<h5 data-id="heading-17"><strong>è§£å†³æœåŠ¡ä¾èµ–é—®é¢˜ï¼šå®æˆ˜æ¡ˆä¾‹</strong></h5>
<p><strong>åœºæ™¯</strong>ï¼šhttpdå’Œvsftpdéƒ½å¯åŠ¨å¤±è´¥ï¼ŒåŸå› æ˜¯å®ƒä»¬äº’ç›¸ä¾èµ–ï¼Œå½¢æˆäº†å¾ªç¯ä¾èµ–ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æŸ¥çœ‹ä¾èµ–å…³ç³»</span>
systemctl list-dependencies httpd.service
systemctl list-dependencies vsftpd.service

<span class="hljs-comment"># 2. æ£€æŸ¥æœåŠ¡çŠ¶æ€</span>
systemctl status httpd.service
systemctl status vsftpd.service

<span class="hljs-comment"># 3. æŸ¥çœ‹æœåŠ¡å•å…ƒæ–‡ä»¶</span>
systemctl <span class="hljs-built_in">cat</span> httpd.service
systemctl <span class="hljs-built_in">cat</span> vsftpd.service

<span class="hljs-comment"># 4. ä¿®æ”¹ä¾èµ–å…³ç³»ï¼ˆå¦‚æœéœ€è¦ï¼‰</span>
vim /etc/systemd/system/httpd.service.d/override.conf
<span class="hljs-comment"># åˆ é™¤æˆ–ä¿®æ”¹å†²çªçš„ä¾èµ–é¡¹</span>

<span class="hljs-comment"># 5. é‡æ–°åŠ è½½systemdé…ç½®</span>
systemctl daemon-reload

<span class="hljs-comment"># 6. é‡å¯æœåŠ¡</span>
systemctl restart httpd.service
systemctl restart vsftpd.service
</code></pre>
<h5 data-id="heading-18"><strong>è°ƒè¯•æŠ€å·§ï¼šä½¿ç”¨debug-shellè·å¾—æ—©æœŸroot shell</strong></h5>
<p>å¦‚æœç³»ç»Ÿå¯åŠ¨å¡åœ¨æŸä¸ªæœåŠ¡ï¼Œä½ å¯ä»¥å¯ç”¨debug shellæ¥è°ƒè¯•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯ç”¨debug shellï¼ˆâš ï¸ è°ƒè¯•å®Œæˆåä¸€å®šè¦ç¦ç”¨ï¼ï¼‰</span>
systemctl <span class="hljs-built_in">enable</span> debug-shell.service

<span class="hljs-comment"># é‡å¯åï¼Œåœ¨tty9ä¸Šä¼šæœ‰ä¸€ä¸ªroot shell</span>
<span class="hljs-comment"># æŒ‰ Ctrl+Alt+F9 åˆ‡æ¢åˆ°tty9</span>

<span class="hljs-comment"># è°ƒè¯•å®Œæˆåï¼Œç¦ç”¨debug shell</span>
systemctl <span class="hljs-built_in">disable</span> debug-shell.service
</code></pre>
<p><strong>âš ï¸ å®‰å…¨è­¦å‘Š</strong>ï¼šdebug-shellä¼šç»™ä»»ä½•äººæä¾›rootè®¿é—®æƒé™ï¼Œè°ƒè¯•å®Œæˆåå¿…é¡»ç¦ç”¨ï¼</p>
<hr/>
<h4 data-id="heading-19">ğŸ”‘ äº”ã€æ¢å¤ä¸¢å¤±çš„rootå¯†ç ï¼šrd.breakå¤§æ³•</h4>
<p>å¿˜è®°äº†rootå¯†ç ï¼Ÿåˆ«æ…Œï¼FYCæ•™ä½ å¦‚ä½•"ç ´é—¨è€Œå…¥"é‡ç½®å¯†ç ã€‚</p>
<h5 data-id="heading-20"><strong>æ–¹æ³•1ï¼šä½¿ç”¨rd.breakä¸­æ–­å¯åŠ¨æµç¨‹ï¼ˆæ¨èï¼‰</strong></h5>
<p>è¿™æ˜¯æœ€å¿«é€Ÿçš„æ–¹æ³•ï¼Œä¸éœ€è¦å¤–éƒ¨ä»‹è´¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. é‡å¯ç³»ç»Ÿï¼Œåœ¨GRUBèœå•å‡ºç°æ—¶ï¼Œé€‰ä¸­å¯åŠ¨é¡¹ï¼ŒæŒ‰ 'e' é”®ç¼–è¾‘</span>

<span class="hljs-comment"># 2. æ‰¾åˆ°ä»¥ linux16 æˆ– linuxefi å¼€å¤´çš„è¡Œ</span>

<span class="hljs-comment"># 3. åœ¨è¡Œå°¾æ·»åŠ  rd.breakï¼ˆç”¨ç©ºæ ¼åˆ†éš”ï¼‰</span>
<span class="hljs-comment"># ä¾‹å¦‚ï¼šlinux16 /vmlinuz ... rd.break</span>

<span class="hljs-comment"># 4. æŒ‰ Ctrl+X å¯åŠ¨</span>

<span class="hljs-comment"># 5. ç³»ç»Ÿä¼šåœåœ¨initramfsé˜¶æ®µï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªswitch_root shell</span>

<span class="hljs-comment"># 6. é‡æ–°æŒ‚è½½æ ¹æ–‡ä»¶ç³»ç»Ÿä¸ºå¯å†™</span>
mount -o remount,rw /sysroot

<span class="hljs-comment"># 7. chrootåˆ°ç³»ç»Ÿ</span>
<span class="hljs-built_in">chroot</span> /sysroot

<span class="hljs-comment"># 8. é‡ç½®rootå¯†ç </span>
<span class="hljs-built_in">echo</span> redhat | passwd --stdin root

<span class="hljs-comment"># 9. ä¿®å¤SELinuxä¸Šä¸‹æ–‡ï¼ˆé‡è¦ï¼ï¼‰</span>
load_policy -i
restorecon -Rv /etc

<span class="hljs-comment"># 10. é€€å‡ºå¹¶é‡å¯</span>
<span class="hljs-built_in">exit</span>
<span class="hljs-built_in">exit</span>
</code></pre>
<h5 data-id="heading-21"><strong>æ–¹æ³•2ï¼šä½¿ç”¨æ•‘æ´æ¨¡å¼</strong></h5>
<p>å¦‚æœéœ€è¦æ›´å…¨é¢çš„ä¿®å¤ï¼Œå¯ä»¥ä½¿ç”¨å®‰è£…ä»‹è´¨çš„æ•‘æ´æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ä»å®‰è£…ä»‹è´¨å¯åŠ¨ï¼Œé€‰æ‹©"Rescue an installed system"</span>
<span class="hljs-comment"># 2. é€‰æ‹©é€‰é¡¹1ï¼ˆContinueï¼‰ï¼ŒæŒ‚è½½åˆ° /mnt/sysimage</span>
<span class="hljs-comment"># 3. chrootåˆ°ç³»ç»Ÿ</span>
<span class="hljs-built_in">chroot</span> /mnt/sysimage

<span class="hljs-comment"># 4. é‡ç½®å¯†ç æˆ–ç¼–è¾‘/etc/shadowæ–‡ä»¶</span>
passwd root
<span class="hljs-comment"># æˆ–</span>
vim /etc/shadow

<span class="hljs-comment"># 5. é€€å‡ºå¹¶é‡å¯</span>
<span class="hljs-built_in">exit</span>
reboot
</code></pre>
<hr/>
<h4 data-id="heading-22">ğŸ” å…­ã€è¯†åˆ«ç¡¬ä»¶é—®é¢˜ï¼šè®©ç¡¬ä»¶"å¼€å£è¯´è¯"</h4>
<p>ç³»ç»Ÿèƒ½å¯åŠ¨ï¼Œä½†ç»å¸¸å‡ºé—®é¢˜ï¼Ÿå¾ˆå¯èƒ½æ˜¯ç¡¬ä»¶æœ‰æ•…éšœï¼FYCæ•™ä½ å¦‚ä½•è®©ç¡¬ä»¶"å¼€å£è¯´è¯"ã€‚</p>
<h5 data-id="heading-23"><strong>ç¡¬ä»¶è¯†åˆ«å·¥å…·é›†ï¼šå…­å¤§ç¥å™¨</strong></h5>
<p><strong>1. è¯†åˆ«CPUï¼šlscpuå‘½ä»¤</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹CPUä¿¡æ¯</span>
lscpu

<span class="hljs-comment"># æŸ¥çœ‹CPUæ”¯æŒçš„flagsï¼ˆé‡è¦ï¼ï¼‰</span>
grep flags /proc/cpuinfo

<span class="hljs-comment"># æ£€æŸ¥è™šæ‹ŸåŒ–æ”¯æŒ</span>
grep -E <span class="hljs-string">'vmx|svm'</span> /proc/cpuinfo
<span class="hljs-comment"># vmx: Intel CPUçš„è™šæ‹ŸåŒ–æ”¯æŒ</span>
<span class="hljs-comment"># svm: AMD CPUçš„è™šæ‹ŸåŒ–æ”¯æŒ</span>
</code></pre>
<p><strong>2. è¯†åˆ«å†…å­˜ï¼šdmidecodeå·¥å…·</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…å·¥å…·</span>
yum install -y dmidecode

<span class="hljs-comment"># æŸ¥çœ‹å†…å­˜ä¿¡æ¯</span>
dmidecode -t memory

<span class="hljs-comment"># æŸ¥çœ‹å†…å­˜è¯¦ç»†ä¿¡æ¯</span>
dmidecode -t 17
</code></pre>
<p><strong>3. è¯†åˆ«ç£ç›˜ï¼šlsscsiå’Œhdparm</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…å·¥å…·</span>
yum install -y lsscsi hdparm

<span class="hljs-comment"># æŸ¥çœ‹SCSIè®¾å¤‡</span>
lsscsi

<span class="hljs-comment"># æŸ¥çœ‹ç£ç›˜è¯¦ç»†ä¿¡æ¯</span>
hdparm -I /dev/sda
</code></pre>
<p><strong>4. è¯†åˆ«PCIç¡¬ä»¶ï¼šlspciå‘½ä»¤</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹PCIè®¾å¤‡</span>
lspci

<span class="hljs-comment"># æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼ˆ-v å¢åŠ è¯¦ç»†ç¨‹åº¦ï¼‰</span>
lspci -v
lspci -vv    <span class="hljs-comment"># æ›´è¯¦ç»†</span>
lspci -vvv   <span class="hljs-comment"># æœ€è¯¦ç»†</span>

<span class="hljs-comment"># æŸ¥çœ‹ç‰¹å®šè®¾å¤‡</span>
lspci | grep -i network
lspci | grep -i video
</code></pre>
<p><strong>5. è¯†åˆ«USBç¡¬ä»¶ï¼šlsusbå‘½ä»¤</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…å·¥å…·</span>
yum install -y usbutils

<span class="hljs-comment"># æŸ¥çœ‹USBè®¾å¤‡</span>
lsusb

<span class="hljs-comment"># æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯</span>
lsusb -v
</code></pre>
<h5 data-id="heading-24"><strong>ç¡¬ä»¶é”™è¯¯ç›‘æ§ï¼šæå‰å‘ç°é—®é¢˜çš„çœ¼ç›</strong></h5>
<p><strong>å·¥å…·1ï¼šmcelog - æœºå™¨æ£€æŸ¥å¼‚å¸¸æ—¥å¿—</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…å·¥å…·</span>
yum install -y mcelog

<span class="hljs-comment"># å¯åŠ¨æœåŠ¡</span>
systemctl start mcelog.service
systemctl <span class="hljs-built_in">enable</span> mcelog.service

<span class="hljs-comment"># æŸ¥çœ‹æ—¥å¿—</span>
journalctl -u mcelog.service

<span class="hljs-comment"># æŸ¥çœ‹/var/log/mcelogæ–‡ä»¶ï¼ˆå¦‚æœé…ç½®äº†cronï¼‰</span>
<span class="hljs-built_in">tail</span> -f /var/log/mcelog
</code></pre>
<p><strong>å·¥å…·2ï¼šrasdaemon - å¯é æ€§ã€å¯ç”¨æ€§ã€å¯æœåŠ¡æ€§å®ˆæŠ¤è¿›ç¨‹</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…å·¥å…·</span>
yum install -y rasdaemon

<span class="hljs-comment"># å¯åŠ¨æœåŠ¡</span>
systemctl start rasdaemon.service
systemctl <span class="hljs-built_in">enable</span> rasdaemon.service

<span class="hljs-comment"># æŸ¥çœ‹çŠ¶æ€</span>
ras-mc-ctl --status

<span class="hljs-comment"># æŸ¥çœ‹é”™è¯¯</span>
ras-mc-ctl --errors
</code></pre>
<h5 data-id="heading-25"><strong>å†…å­˜æµ‹è¯•ï¼šmemtest86+å¸®ä½ æ‰¾å‡ºå†…å­˜æ•…éšœ</strong></h5>
<p>å¦‚æœæ€€ç–‘å†…å­˜æœ‰é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨memtest86+è¿›è¡Œæµ‹è¯•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…å·¥å…·</span>
yum install -y memtest86+

<span class="hljs-comment"># è¿è¡Œmemtest-setup</span>
memtest-setup

<span class="hljs-comment"># é‡æ–°ç”ŸæˆGRUB2é…ç½®</span>
grub2-mkconfig -o /boot/grub2/grub.cfg

<span class="hljs-comment"># é‡å¯ç³»ç»Ÿï¼Œåœ¨GRUBèœå•ä¸­ä¼šå‡ºç°memtest86+é€‰é¡¹</span>
<span class="hljs-comment"># é€‰æ‹©å®ƒè¿›è¡Œå†…å­˜æµ‹è¯•</span>
</code></pre>
<hr/>
<h4 data-id="heading-26">ğŸ§© ä¸ƒã€ç®¡ç†å†…æ ¸æ¨¡å—ï¼šè®©ç¡¬ä»¶é©±åŠ¨å¬è¯</h4>
<p>ç¡¬ä»¶è¯†åˆ«å®Œäº†ï¼Œæ¥ä¸‹æ¥è¦ç¡®ä¿é©±åŠ¨æ­£å¸¸å·¥ä½œã€‚å†…æ ¸æ¨¡å—ç®¡ç†å°±æ˜¯å…³é”®ï¼</p>
<h5 data-id="heading-27"><strong>æŸ¥çœ‹å’Œç®¡ç†å†…æ ¸æ¨¡å—</strong></h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹å·²åŠ è½½çš„æ¨¡å—</span>
lsmod

<span class="hljs-comment"># æŸ¥çœ‹æ¨¡å—è¯¦ç»†ä¿¡æ¯</span>
modinfo megaraid_sas

<span class="hljs-comment"># æŸ¥çœ‹æ¨¡å—æ”¯æŒçš„å‚æ•°</span>
modinfo -p megaraid_sas

<span class="hljs-comment"># åŠ è½½æ¨¡å—</span>
modprobe megaraid_sas

<span class="hljs-comment"># å¸è½½æ¨¡å—</span>
modprobe -r megaraid_sas

<span class="hljs-comment"># æŸ¥çœ‹æ¨¡å—ä¾èµ–å…³ç³»</span>
modprobe --show-depends megaraid_sas
</code></pre>
<h5 data-id="heading-28"><strong>é…ç½®æ¨¡å—å‚æ•°ï¼šè®©é©±åŠ¨æŒ‰ä½ çš„éœ€æ±‚å·¥ä½œ</strong></h5>
<p>å¾ˆå¤šå†…æ ¸æ¨¡å—æ”¯æŒå‚æ•°æ¥è°ƒæ•´è¡Œä¸ºï¼š</p>
<p><strong>æ–¹æ³•1ï¼šä¸´æ—¶è®¾ç½®ï¼ˆç«‹å³ç”Ÿæ•ˆï¼Œé‡å¯åå¤±æ•ˆï¼‰</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨åŠ è½½æ¨¡å—æ—¶è®¾ç½®å‚æ•°</span>
modprobe megaraid_sas msix=0

<span class="hljs-comment"># æŸ¥çœ‹å½“å‰å‚æ•°å€¼</span>
<span class="hljs-built_in">cat</span> /sys/module/megaraid_sas/parameters/msix
</code></pre>
<p><strong>æ–¹æ³•2ï¼šæ°¸ä¹…è®¾ç½®ï¼ˆæ¨èï¼‰</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºæ¨¡å—é…ç½®æ–‡ä»¶</span>
vim /etc/modprobe.d/megaraid_sas.conf

<span class="hljs-comment"># æ·»åŠ é…ç½®</span>
options megaraid_sas msix=0

<span class="hljs-comment"># å¦‚æœæ¨¡å—å·²åŠ è½½ï¼Œéœ€è¦å…ˆå¸è½½å†åŠ è½½</span>
modprobe -r megaraid_sas
modprobe megaraid_sas

<span class="hljs-comment"># éªŒè¯å‚æ•°</span>
<span class="hljs-built_in">cat</span> /sys/module/megaraid_sas/parameters/msix
</code></pre>
<p><strong>å®æˆ˜æ¡ˆä¾‹</strong>ï¼šç¦ç”¨SAS RAIDå¡çš„MSI-Xä¸­æ–­</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é—®é¢˜ï¼šæ—¥å¿—ä¸­é¢‘ç¹å‡ºç°MSI-Xä¸­æ–­é”™è¯¯</span>
<span class="hljs-comment"># è§£å†³ï¼šåœ¨é©±åŠ¨ä¸­ç¦ç”¨MSI-Xä¸­æ–­å¤„ç†</span>

<span class="hljs-comment"># 1. åˆ›å»ºé…ç½®æ–‡ä»¶</span>
<span class="hljs-built_in">cat</span> &gt; /etc/modprobe.d/megaraid_sas.conf &lt;&lt; <span class="hljs-string">EOF
options megaraid_sas msix=0
EOF</span>

<span class="hljs-comment"># 2. é‡æ–°åŠ è½½æ¨¡å—</span>
modprobe -r megaraid_sas
modprobe megaraid_sas

<span class="hljs-comment"># 3. éªŒè¯</span>
<span class="hljs-built_in">cat</span> /sys/module/megaraid_sas/parameters/msix
<span class="hljs-comment"># åº”è¯¥æ˜¾ç¤ºï¼šN</span>
</code></pre>
<hr/>
<h4 data-id="heading-29">ğŸ–¥ï¸ å…«ã€å¤„ç†è™šæ‹ŸåŒ–é—®é¢˜ï¼šKVMæ•…éšœæ’é™¤</h4>
<p>å¦‚æœä½ çš„ç¯å¢ƒä¸­ä½¿ç”¨äº†KVMè™šæ‹ŸåŒ–ï¼Œé‚£ä¹ˆè™šæ‹Ÿæœºçš„æ•…éšœæ’é™¤ä¹Ÿæ˜¯å¿…å¤‡æŠ€èƒ½ï¼</p>
<h5 data-id="heading-30"><strong>æ£€æŸ¥ç¡¬ä»¶è™šæ‹ŸåŒ–æ”¯æŒ</strong></h5>
<p>KVMéœ€è¦CPUå’Œå›ºä»¶éƒ½æ”¯æŒç¡¬ä»¶è™šæ‹ŸåŒ–ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æ£€æŸ¥CPUæ˜¯å¦æ”¯æŒè™šæ‹ŸåŒ–</span>
grep -E <span class="hljs-string">'vmx|svm'</span> /proc/cpuinfo
<span class="hljs-comment"># Intel CPUæ˜¾ç¤ºvmxï¼ŒAMD CPUæ˜¾ç¤ºsvm</span>

<span class="hljs-comment"># 2. å°è¯•åŠ è½½KVMæ¨¡å—</span>
modprobe kvm-intel    <span class="hljs-comment"># Intel CPU</span>
<span class="hljs-comment"># æˆ–</span>
modprobe kvm-amd      <span class="hljs-comment"># AMD CPU</span>

<span class="hljs-comment"># 3. ä½¿ç”¨virshæ£€æŸ¥</span>
virsh capabilities | grep -A 5 kvm

<span class="hljs-comment"># âš ï¸ é‡è¦ï¼šå¦‚æœç¡¬ä»¶è™šæ‹ŸåŒ–ä¸å¯ç”¨ï¼ŒVMä¼šåœ¨æ¨¡æ‹Ÿå¤„ç†å™¨ä¸Šè¿è¡Œï¼Œæ€§èƒ½ä¼šæ…¢å‡ ä¸ªæ•°é‡çº§ï¼</span>
</code></pre>
<h5 data-id="heading-31"><strong>æ£€æŸ¥èµ„æºè¿‡åº¦åˆ†é…</strong></h5>
<p>libvirtå…è®¸ä½ ä¸ºVMåˆ†é…æ¯”ä¸»æœºå®é™…èµ„æºæ›´å¤šçš„è™šæ‹Ÿèµ„æºï¼Œè¿™å¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹ä¸»æœºèµ„æº</span>
virsh nodecpustats
virsh nodememstats

<span class="hljs-comment"># æŸ¥çœ‹è™šæ‹Ÿæœºèµ„æº</span>
virsh dommemstats vm1
virsh vcpuinfo vm1

<span class="hljs-comment"># ä½¿ç”¨topæŸ¥çœ‹VMè¿›ç¨‹ï¼ˆVMåœ¨ä¸»æœºä¸Šæ˜¾ç¤ºä¸ºæ™®é€šè¿›ç¨‹ï¼‰</span>
top -p $(pgrep -f qemu)
</code></pre>
<p><strong>è§£å†³èµ„æºè¿‡åº¦åˆ†é…é—®é¢˜</strong>ï¼š</p>
<ol>
<li><strong>æ·»åŠ æ›´å¤šç‰©ç†èµ„æº</strong>ï¼ˆæœ€ç®€å•ï¼‰</li>
<li><strong>é™åˆ¶VMèµ„æºä½¿ç”¨</strong>ï¼ˆä½¿ç”¨cgroupsï¼‰</li>
<li><strong>åœæ­¢ä¸å¿…è¦çš„VM</strong>ï¼ˆé‡Šæ”¾èµ„æºï¼‰</li>
</ol>
<h5 data-id="heading-32"><strong>éªŒè¯libvirt XMLé…ç½®</strong></h5>
<p>libvirtçš„è™šæ‹Ÿæœºé…ç½®ä»¥XMLæ ¼å¼å­˜å‚¨ï¼Œé…ç½®é”™è¯¯ä¼šå¯¼è‡´VMæ— æ³•å¯åŠ¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># éªŒè¯XMLæ–‡ä»¶è¯­æ³•</span>
xmllint --noout /etc/libvirt/qemu/vm1.xml

<span class="hljs-comment"># éªŒè¯XMLé…ç½®æ­£ç¡®æ€§ï¼ˆæ›´ä¸¥æ ¼çš„æ£€æŸ¥ï¼‰</span>
virt-xml-validate /etc/libvirt/qemu/vm1.xml /usr/share/libvirt/schemas/domain.rng

<span class="hljs-comment"># âš ï¸ æ³¨æ„ï¼šä¸è¦æ‰‹åŠ¨ç¼–è¾‘/etc/libvirt/ä¸‹çš„æ–‡ä»¶ï¼Œåº”è¯¥ä½¿ç”¨virshæˆ–virt-managerï¼</span>
</code></pre>
<h5 data-id="heading-33"><strong>è™šæ‹Ÿç½‘ç»œé—®é¢˜æ’æŸ¥</strong></h5>
<p>libvirtä½¿ç”¨è½¯ä»¶ç½‘æ¡¥å®ç°è™šæ‹Ÿç½‘ç»œï¼Œç½‘ç»œé—®é¢˜ä¹Ÿæ˜¯å¸¸è§æ•…éšœï¼š</p>
<p><strong>å¸¸è§é—®é¢˜1ï¼šVMæ— æ³•ä»å¤–éƒ¨è®¿é—®</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥è™šæ‹Ÿç½‘ç»œç±»å‹ï¼ˆå¯èƒ½æ˜¯NATç±»å‹ï¼Œå¤–éƒ¨æ— æ³•è®¿é—®ï¼‰</span>
virsh net-list
virsh net-info default

<span class="hljs-comment"># æ£€æŸ¥é˜²ç«å¢™è§„åˆ™</span>
iptables -L -n | grep virbr

<span class="hljs-comment"># æ£€æŸ¥ç½‘æ¡¥</span>
brctl show
</code></pre>
<p><strong>å¸¸è§é—®é¢˜2ï¼šå¤–éƒ¨æ— æ³•è®¿é—®VM</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥è™šæ‹Ÿç½‘ç»œæ˜¯å¦æ˜¯éš”ç¦»ç±»å‹</span>
virsh net-info default

<span class="hljs-comment"># æ£€æŸ¥hypervisoré˜²ç«å¢™è§„åˆ™</span>
firewall-cmd --list-all
</code></pre>
<p><strong>å¸¸è§é—®é¢˜3ï¼šç½‘ç»œè¿æ¥å®Œå…¨ä¸­æ–­</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¦‚æœæ¸…é™¤äº†æ‰€æœ‰iptablesè§„åˆ™ï¼Œlibvirtçš„ç½‘ç»œå¯èƒ½ä¼šæ–­</span>
<span class="hljs-comment"># è§£å†³æ–¹æ³•ï¼šé‡å¯libvirtdæˆ–è™šæ‹Ÿç½‘ç»œ</span>
systemctl restart libvirtd.service
<span class="hljs-comment"># æˆ–</span>
virsh net-destroy default
virsh net-start default
</code></pre>
<hr/>
<h4 data-id="heading-34">ğŸ’¼ ä¹ã€å®æˆ˜æ¡ˆä¾‹ï¼šå®Œæ•´æ•…éšœæ’é™¤æµç¨‹</h4>
<p>è¯´äº†è¿™ä¹ˆå¤šç†è®ºï¼ŒFYCç»™ä½ æ¥ä¸ªå®æˆ˜æ¡ˆä¾‹ï¼Œçœ‹çœ‹è¿™äº›æŠ€èƒ½æ˜¯æ€ä¹ˆç»„åˆä½¿ç”¨çš„ï¼</p>
<h5 data-id="heading-35"><strong>æ¡ˆä¾‹1ï¼šç³»ç»Ÿæ— æ³•å¯åŠ¨ï¼ˆBIOSç³»ç»Ÿï¼‰</strong></h5>
<p><strong>åœºæ™¯</strong>ï¼šæœåŠ¡å™¨é‡å¯åæ— æ³•å¯åŠ¨ï¼ŒGRUBèœå•éƒ½çœ‹ä¸åˆ°ã€‚</p>
<p><strong>æ’æŸ¥æ­¥éª¤</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ä»å®‰è£…ä»‹è´¨å¯åŠ¨ï¼Œè¿›å…¥æ•‘æ´æ¨¡å¼</span>
<span class="hljs-comment"># é€‰æ‹©"Rescue an installed system" â†’ é€‰é¡¹1ï¼ˆContinueï¼‰</span>

<span class="hljs-comment"># 2. chrootåˆ°ç³»ç»Ÿ</span>
<span class="hljs-built_in">chroot</span> /mnt/sysimage

<span class="hljs-comment"># 3. æ£€æŸ¥/bootç›®å½•</span>
<span class="hljs-built_in">ls</span> -l /boot
<span class="hljs-comment"># å‘ç°ï¼šå†…æ ¸æ–‡ä»¶å­˜åœ¨ï¼Œä½†grub2ç›®å½•å¯èƒ½æœ‰é—®é¢˜</span>

<span class="hljs-comment"># 4. æ£€æŸ¥ç£ç›˜è®¾å¤‡å</span>
lsblk

<span class="hljs-comment"># 5. é‡æ–°å®‰è£…GRUB2</span>
grub2-install /dev/vda

<span class="hljs-comment"># 6. é‡æ–°ç”Ÿæˆé…ç½®æ–‡ä»¶</span>
grub2-mkconfig -o /boot/grub2/grub.cfg

<span class="hljs-comment"># 7. éªŒè¯é…ç½®</span>
<span class="hljs-built_in">ls</span> -l /boot/grub2/grub.cfg

<span class="hljs-comment"># 8. é€€å‡ºå¹¶é‡å¯</span>
<span class="hljs-built_in">exit</span>
<span class="hljs-built_in">exit</span>
reboot
</code></pre>
<h5 data-id="heading-36"><strong>æ¡ˆä¾‹2ï¼šæœåŠ¡å¯åŠ¨å¤±è´¥ï¼ˆä¾èµ–å…³ç³»é—®é¢˜ï¼‰</strong></h5>
<p><strong>åœºæ™¯</strong>ï¼šhttpdå’Œvsftpdéƒ½å¯åŠ¨å¤±è´¥ï¼Œç³»ç»Ÿèƒ½å¯åŠ¨ä½†æœåŠ¡æ— æ³•è¿è¡Œã€‚</p>
<p><strong>æ’æŸ¥æ­¥éª¤</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æŸ¥çœ‹æœåŠ¡çŠ¶æ€</span>
systemctl status httpd.service
systemctl status vsftpd.service

<span class="hljs-comment"># 2. æŸ¥çœ‹ä¾èµ–å…³ç³»</span>
systemctl list-dependencies httpd.service
systemctl list-dependencies vsftpd.service

<span class="hljs-comment"># 3. æŸ¥çœ‹æœåŠ¡æ—¥å¿—</span>
journalctl -u httpd.service -n 50
journalctl -u vsftpd.service -n 50

<span class="hljs-comment"># 4. æŸ¥çœ‹æœåŠ¡å•å…ƒæ–‡ä»¶</span>
systemctl <span class="hljs-built_in">cat</span> httpd.service
systemctl <span class="hljs-built_in">cat</span> vsftpd.service

<span class="hljs-comment"># 5. å‘ç°é—®é¢˜ï¼šä¸¤ä¸ªæœåŠ¡äº’ç›¸ä¾èµ–ï¼Œå½¢æˆå¾ªç¯ä¾èµ–</span>

<span class="hljs-comment"># 6. ä¿®æ”¹æœåŠ¡é…ç½®ï¼ˆç§»é™¤å†²çªçš„ä¾èµ–ï¼‰</span>
vim /etc/systemd/system/httpd.service.d/override.conf
<span class="hljs-comment"># [Unit]</span>
<span class="hljs-comment"># After=vsftpd.service</span>

<span class="hljs-comment"># 7. é‡æ–°åŠ è½½é…ç½®</span>
systemctl daemon-reload

<span class="hljs-comment"># 8. é‡å¯æœåŠ¡</span>
systemctl restart httpd.service
systemctl restart vsftpd.service

<span class="hljs-comment"># 9. éªŒè¯</span>
systemctl status httpd.service
systemctl status vsftpd.service
</code></pre>
<h5 data-id="heading-37"><strong>æ¡ˆä¾‹3ï¼šç¡¬ä»¶æ•…éšœè¯†åˆ«ï¼ˆå†…å­˜é”™è¯¯ï¼‰</strong></h5>
<p><strong>åœºæ™¯</strong>ï¼šç³»ç»Ÿç»å¸¸å‡ºç°å†…å­˜é”™è¯¯ï¼Œæ€€ç–‘æ˜¯ç¡¬ä»¶æ•…éšœã€‚</p>
<p><strong>æ’æŸ¥æ­¥éª¤</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æ£€æŸ¥ç¡¬ä»¶é”™è¯¯æ—¥å¿—</span>
journalctl -u mcelog.service
ras-mc-ctl --errors

<span class="hljs-comment"># 2. æŸ¥çœ‹å†…å­˜ä¿¡æ¯</span>
dmidecode -t memory

<span class="hljs-comment"># 3. è¿è¡Œå†…å­˜æµ‹è¯•</span>
yum install -y memtest86+
memtest-setup
grub2-mkconfig -o /boot/grub2/grub.cfg

<span class="hljs-comment"># 4. é‡å¯ç³»ç»Ÿï¼Œé€‰æ‹©memtest86+é€‰é¡¹è¿›è¡Œæµ‹è¯•</span>
<span class="hljs-comment"># æµ‹è¯•å®Œæˆåï¼ŒæŸ¥çœ‹ç»“æœ</span>

<span class="hljs-comment"># 5. æ ¹æ®æµ‹è¯•ç»“æœï¼Œæ›´æ¢æœ‰é—®é¢˜çš„å†…å­˜æ¡</span>
</code></pre>
<hr/>
<h3 data-id="heading-38">ğŸ å†™åœ¨ç»“å°¾ï¼</h3>
<h4 data-id="heading-39">ğŸ“‹ ä»·å€¼æ€»ç»“</h4>
<p>ä»Šå¤©FYCä¸ºä½ å¸¦æ¥äº†Linuxç³»ç»Ÿå¯åŠ¨å’Œç¡¬ä»¶æ•…éšœæ’é™¤çš„å®Œæ•´æ”»ç•¥ï¼š</p>
<p>âœ… <strong>å¯åŠ¨é—®é¢˜è¯Šæ–­ä¸‰éƒ¨æ›²</strong>ï¼š</p>
<ul>
<li>BIOS/UEFIå¯åŠ¨ä¿®å¤ï¼šGRUB2é‡æ–°å®‰è£…ã€é…ç½®æ–‡ä»¶é‡å»º</li>
<li>systemdæœåŠ¡ä¾èµ–æ’æŸ¥ï¼šä¾èµ–å…³ç³»æ£€æŸ¥ã€å¾ªç¯ä¾èµ–è§£å†³</li>
<li>rootå¯†ç æ¢å¤ï¼šrd.breakä¸­æ–­å¯åŠ¨æµç¨‹ã€æ•‘æ´æ¨¡å¼é‡ç½®</li>
</ul>
<p>âœ… <strong>ç¡¬ä»¶è¯†åˆ«ç¥å™¨</strong>ï¼š</p>
<ul>
<li>CPU/å†…å­˜/ç£ç›˜/PCI/USBå…¨æ–¹ä½è¯†åˆ«å·¥å…·</li>
<li>ç¡¬ä»¶é”™è¯¯ç›‘æ§ï¼šmcelogã€rasdaemonæå‰å‘ç°æ•…éšœ</li>
<li>å†…å­˜æµ‹è¯•ï¼šmemtest86+æ‰¾å‡ºå†…å­˜æ•…éšœ</li>
</ul>
<p>âœ… <strong>å†…æ ¸æ¨¡å—å’Œè™šæ‹ŸåŒ–</strong>ï¼š</p>
<ul>
<li>å†…æ ¸æ¨¡å—å‚æ•°é…ç½®ï¼šè®©é©±åŠ¨æŒ‰éœ€å·¥ä½œ</li>
<li>KVMè™šæ‹ŸåŒ–æ”¯æŒæ£€æŸ¥ï¼šç¡®ä¿VMæ€§èƒ½</li>
<li>libvirtç½‘ç»œæ•…éšœæ’é™¤ï¼šè§£å†³VMç½‘ç»œé—®é¢˜</li>
</ul>
<p>æŒæ¡äº†è¿™äº›æŠ€èƒ½ï¼Œä½ å°±èƒ½åœ¨å…³é”®æ—¶åˆ»è®©ç³»ç»Ÿ"èµ·æ­»å›ç”Ÿ"ï¼Œä»"æ•‘ç«é˜Ÿå‘˜"å‡çº§ä¸º"ç³»ç»ŸåŒ»ç”Ÿ"ï¼</p>
<h4 data-id="heading-40">ğŸ¯ è¡ŒåŠ¨å·å¬</h4>
<p><strong>è§‰å¾—è¿™ç¯‡æ–‡ç« è¿˜ä¸å¤Ÿè¿‡ç˜¾ï¼Ÿæƒ³è¦çœ‹åˆ°æ›´è¯¦ç»†çš„GRUB2é…ç½®æ–‡ä»¶è§£è¯»ã€systemdä¾èµ–å…³ç³»æ·±åº¦è§£æã€ä»¥åŠæ›´å¤šç¡¬ä»¶æ•…éšœæ’æŸ¥å®æˆ˜æ¡ˆä¾‹å—ï¼Ÿ</strong></p>
<p>ğŸ‘‰ <strong>ç‚¹å‡»ä¸‹æ–¹çš„ã€é˜…è¯»åŸæ–‡ã€‘</strong>ï¼Œå³å¯è·å–ï¼š</p>
<ul>
<li>ğŸ“š <strong>å®Œæ•´çš„å¯åŠ¨æ•…éšœæ’æŸ¥æ£€æŸ¥æ¸…å•</strong>ï¼ˆChecklistï¼‰</li>
<li>ğŸ”§ <strong>GRUB2é…ç½®æ–‡ä»¶å®Œæ•´è§£è¯»</strong>ï¼ˆæ‰€æœ‰å‚æ•°è¯´æ˜ï¼‰</li>
<li>ğŸ“Š <strong>systemdä¾èµ–å…³ç³»å¯è§†åŒ–å·¥å…·</strong>ä½¿ç”¨æŒ‡å—</li>
<li>ğŸ¯ <strong>ç¡¬ä»¶æ•…éšœè¯Šæ–­å·¥å…·é€ŸæŸ¥è¡¨</strong>ï¼ˆæ‰€æœ‰å‘½ä»¤å’Œå‚æ•°ï¼‰</li>
<li>ğŸ’¡ <strong>æ›´å¤šçœŸå®æ•…éšœæ¡ˆä¾‹è§£æ</strong>ï¼ˆBIOS/UEFI/è™šæ‹ŸåŒ–å…¨è¦†ç›–ï¼‰</li>
</ul>
<p><strong>FYCçš„ä½¿å‘½</strong>ï¼šè®©æ¯ä¸ªè¿ç»´å·¥ç¨‹å¸ˆéƒ½èƒ½æˆä¸ºç³»ç»ŸåŒ»ç”Ÿï¼æŠ€æœ¯è¦ç¡¬æ ¸ï¼Œæ–‡æ¡ˆè¦ä¸Šå¤´ï¼ğŸ”¥</p>
<hr/>
<p>#è¿ç»´ #Linux #ç³»ç»Ÿå¯åŠ¨ #ç¡¬ä»¶æ•…éšœ #æ•…éšœæ’é™¤ #GRUB2 #systemd #KVM #æŠ€æœ¯å¹²è´§ #RedHat #RCA</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RequestContextHolderåˆ†æ]]></title>    <link>https://juejin.cn/post/7583158173978230794</link>    <guid>https://juejin.cn/post/7583158173978230794</guid>    <pubDate>2025-12-14T03:13:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583158173978230794" data-draft-id="7582923861769142322" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RequestContextHolderåˆ†æ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-14T03:13:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç´«ç’¨æœˆ"/> <meta itemprop="url" content="https://juejin.cn/user/1751947899320571"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RequestContextHolderåˆ†æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1751947899320571/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç´«ç’¨æœˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T03:13:46.000Z" title="Sun Dec 14 2025 03:13:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">RequestContextHolderåˆ†æ</h2>
<h3 data-id="heading-1">ä¸€ã€å®ƒæ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p><code>org.springframework.web.context.request.RequestContextHolder</code> æ˜¯ Spring Web æ¨¡å—æä¾›çš„ä¸€ä¸ª<strong>å·¥å…·ç±»</strong>ã€‚å®ƒçš„æ ¸å¿ƒä½œç”¨æ˜¯<strong>åœ¨å½“å‰çº¿ç¨‹ï¼ˆThreadï¼‰ä¸­ç»‘å®šå’Œå­˜å‚¨å½“å‰ HTTP è¯·æ±‚çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆå³ <code>RequestAttributes</code> å¯¹è±¡ï¼‰</strong>ï¼Œå¹¶å…è®¸ä½ åœ¨ä»£ç çš„ä»»ä½•åœ°æ–¹ï¼ˆåªè¦åœ¨åŒä¸€çº¿ç¨‹å†…ï¼‰è½»æ¾è·å–åˆ°è¿™äº›ä¿¡æ¯ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œå®ƒè§£å†³äº†ä¸€ä¸ªé—®é¢˜ï¼š<strong>å¦‚ä½•åœ¨ä¸€ä¸ªéæ§åˆ¶å™¨ï¼ˆControllerï¼‰çš„æ™®é€šç±»ã€å·¥å…·ç±»æˆ–ä¸šåŠ¡å±‚ï¼ˆServiceï¼‰æ–¹æ³•ä¸­ï¼Œè·å–åˆ°å½“å‰ HTTP è¯·æ±‚çš„ <code>HttpServletRequest</code> å’Œ <code>HttpServletResponse</code> å¯¹è±¡ï¼Ÿ</strong></p>
<hr/>
<h3 data-id="heading-2">äºŒã€ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</h3>
<p>åœ¨æ ‡å‡†çš„ MVC æ¨¡å¼ä¸­ï¼Œ<code>HttpServletRequest</code> å’Œ <code>HttpServletResponse</code> å¯¹è±¡é€šå¸¸åªåœ¨ Controller å±‚ä½œä¸ºæ–¹æ³•å‚æ•°è¢«ç›´æ¥ä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RestController</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> {

    <span class="hljs-meta">@GetMapping("/user")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getUserInfo</span><span class="hljs-params">(HttpServletRequest request)</span> { <span class="hljs-comment">// åœ¨è¿™é‡Œå¯ä»¥ç›´æ¥è·å–</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">userAgent</span> <span class="hljs-operator">=</span> request.getHeader(<span class="hljs-string">"User-Agent"</span>);
        <span class="hljs-comment">// ... ä¸šåŠ¡é€»è¾‘</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"info"</span>;
    }
}
</code></pre>
<p>ä½†å½“ä½ çš„ä¸šåŠ¡é€»è¾‘æ·±å…¥ Service å±‚ã€å·¥å…·ç±»æˆ–å…¶ä»–ç»„ä»¶æ—¶ï¼Œå°†è¿™äº›å¯¹è±¡ä¸€å±‚å±‚ä½œä¸ºå‚æ•°ä¼ é€’ä¸‹å»ï¼Œä¼šä½¿ä»£ç å˜å¾—éå¸¸è‡ƒè‚¿å’Œè€¦åˆï¼Œè¿åäº†è®¾è®¡çš„ç®€æ´æ€§åŸåˆ™ã€‚</p>
<p><strong><code>RequestContextHolder</code> çš„å¦™å¤„å°±åœ¨äºï¼šå®ƒé€šè¿‡çº¿ç¨‹ç»‘å®šçš„æœºåˆ¶ï¼Œè®©ä½ å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹â€œå‡­ç©ºâ€è·å–åˆ°å½“å‰è¯·æ±‚çš„ä¸Šä¸‹æ–‡ï¼Œè€Œæ— éœ€æ˜¾å¼åœ°ä¼ é€’å®ƒä»¬ã€‚</strong></p>
<hr/>
<h3 data-id="heading-3">ä¸‰ã€å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</h3>
<p>å…¶æ ¸å¿ƒæœºåˆ¶æ˜¯ <strong>ThreadLocal</strong>ã€‚</p>
<ol>
<li><strong>çº¿ç¨‹ç»‘å®š</strong>ï¼šå½“ä¸€ä¸ª HTTP è¯·æ±‚åˆ°è¾¾ Spring MVC çš„ <code>DispatcherServlet</code> æ—¶ï¼Œåœ¨è¿›å…¥æ§åˆ¶å™¨ä¹‹å‰ï¼ŒSpring ä¼šé€šè¿‡ä¸€ä¸ªè¿‡æ»¤å™¨æˆ–æ‹¦æˆªå™¨ï¼Œå°†å½“å‰è¯·æ±‚çš„ <code>RequestAttributes</code>ï¼ˆå®ƒå°è£…äº† <code>HttpServletRequest</code>, <code>HttpServletResponse</code> ç­‰ï¼‰å¯¹è±¡ç»‘å®šåˆ°<strong>å½“å‰å¤„ç†è¯¥è¯·æ±‚çš„çº¿ç¨‹ï¼ˆThreadLocalï¼‰</strong> ä¸Šã€‚</li>
<li><strong>éšæ—¶è·å–</strong>ï¼šåœ¨åç»­çš„ä»»æ„ä¸šåŠ¡é€»è¾‘ã€Service æˆ–å·¥å…·ç±»ä¸­ï¼Œä½ éƒ½å¯ä»¥é€šè¿‡ <code>RequestContextHolder</code> ç±»çš„æ–¹æ³•ï¼Œä»å½“å‰çº¿ç¨‹çš„ ThreadLocal å˜é‡ä¸­å–å‡ºä¹‹å‰ç»‘å®šçš„ <code>RequestAttributes</code> å¯¹è±¡ã€‚</li>
<li><strong>åŠæ—¶æ¸…ç†</strong>ï¼šå½“è¯·æ±‚å¤„ç†å®Œæ¯•ï¼Œè¿”å›å“åº”ä¹‹åï¼ŒSpring ä¼šè‡ªåŠ¨æ¸…ç†å½“å‰çº¿ç¨‹çš„ ThreadLocal æ•°æ®ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ï¼ˆå°¤å…¶æ˜¯åœ¨ä½¿ç”¨çº¿ç¨‹æ± çš„æƒ…å†µä¸‹ï¼‰ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-4">å››ã€æ€ä¹ˆä½¿ç”¨å®ƒï¼Ÿ</h3>
<p><code>RequestContextHolder</code> æä¾›äº†é™æ€æ–¹æ³•ï¼Œæœ€å¸¸ç”¨çš„æœ‰ï¼š</p>
<h4 data-id="heading-5">1. è·å– <code>RequestAttributes</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æœ€å¸¸ç”¨çš„æ–¹æ³•ï¼šè·å–å½“å‰çº¿ç¨‹ç»‘å®šçš„ RequestAttributesã€‚</span>
<span class="hljs-comment">// å¦‚æœå½“å‰çº¿ç¨‹æ²¡æœ‰ç»‘å®šè¯·æ±‚ä¸Šä¸‹æ–‡ï¼Œåˆ™è¿”å› nullã€‚</span>
<span class="hljs-type">RequestAttributes</span> <span class="hljs-variable">attributes</span> <span class="hljs-operator">=</span> RequestContextHolder.getRequestAttributes();

<span class="hljs-comment">// è·å–å½“å‰çº¿ç¨‹ç»‘å®šçš„ RequestAttributesã€‚</span>
<span class="hljs-comment">// å¦‚æœå½“å‰çº¿ç¨‹æ²¡æœ‰ç»‘å®šè¯·æ±‚ä¸Šä¸‹æ–‡ï¼Œåˆ™æŠ›å‡º IllegalStateException å¼‚å¸¸ã€‚</span>
<span class="hljs-type">RequestAttributes</span> <span class="hljs-variable">attributes</span> <span class="hljs-operator">=</span> RequestContextHolder.currentRequestAttributes();
</code></pre>
<p><strong>é€šå¸¸æ¨èåœ¨æ˜ç¡®å¤„äº Web è¯·æ±‚ç¯å¢ƒçš„ä»£ç ä¸­ä½¿ç”¨ <code>currentRequestAttributes()</code>ï¼Œå› ä¸ºå®ƒèƒ½æ›´å¿«åœ°æš´éœ²é—®é¢˜ï¼ˆå¦‚æœæ²¡æœ‰ä¸Šä¸‹æ–‡ï¼Œè¯´æ˜ä½ çš„è°ƒç”¨æ—¶æœºæˆ–ä½ç½®ä¸å¯¹ï¼‰ã€‚</strong></p>
<h4 data-id="heading-6">2. è·å– <code>HttpServletRequest</code> å’Œ <code>HttpServletResponse</code></h4>
<p>è·å–åˆ° <code>RequestAttributes</code> åï¼Œå¯ä»¥ä»ä¸­å–å‡ºéœ€è¦çš„å¯¹è±¡ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ServletRequestAttributes</span> <span class="hljs-variable">servletRequestAttributes</span> <span class="hljs-operator">=</span> (ServletRequestAttributes) attributes;
<span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> servletRequestAttributes.getRequest();
<span class="hljs-type">HttpServletResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> servletRequestAttributes.getResponse();
</code></pre>
<h4 data-id="heading-7">3. å¼‚æ­¥è¯·æ±‚ä¸­çš„ä¸Šä¸‹æ–‡ä¼ é€’</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncService</span> {
    
    <span class="hljs-meta">@Async</span> <span class="hljs-comment">// ä½¿ç”¨ Spring çš„å¼‚æ­¥æ‰§è¡Œ</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;String&gt; <span class="hljs-title function_">asyncProcess</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// è·å–è¯·æ±‚ä¸Šä¸‹æ–‡ï¼ˆéœ€è¦åœ¨é…ç½®ä¸­å¯ç”¨ä¸Šä¸‹æ–‡ä¼ é€’ï¼‰</span>
        <span class="hljs-type">ServletRequestAttributes</span> <span class="hljs-variable">attributes</span> <span class="hljs-operator">=</span> 
            (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
        
        <span class="hljs-keyword">if</span> (attributes != <span class="hljs-literal">null</span>) {
            <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> attributes.getRequest();
            <span class="hljs-type">String</span> <span class="hljs-variable">requestId</span> <span class="hljs-operator">=</span> request.getHeader(<span class="hljs-string">"X-Request-ID"</span>);
            log.info(<span class="hljs-string">"å¼‚æ­¥å¤„ç†ï¼ŒRequest-ID: {}"</span>, requestId);
        }
        
        <span class="hljs-comment">// å¼‚æ­¥ä¸šåŠ¡é€»è¾‘</span>
        <span class="hljs-keyword">return</span> CompletableFuture.completedFuture(<span class="hljs-string">"å¤„ç†å®Œæˆ"</span>);
    }
}

<span class="hljs-comment">/**
 * å¼‚æ­¥é…ç½® - å¯ç”¨ä¸Šä¸‹æ–‡ä¼ é€’
 */</span>
<span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@EnableAsync</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AsyncConfigurer</span> {
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Executor <span class="hljs-title function_">getAsyncExecutor</span><span class="hljs-params">()</span> {
        <span class="hljs-type">ThreadPoolTaskExecutor</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolTaskExecutor</span>();
        executor.setCorePoolSize(<span class="hljs-number">5</span>);
        executor.setMaxPoolSize(<span class="hljs-number">10</span>);
        executor.setQueueCapacity(<span class="hljs-number">100</span>);
        executor.setThreadNamePrefix(<span class="hljs-string">"Async-"</span>);
        executor.initialize();
        
        <span class="hljs-comment">// åŒ…è£… Executor ä»¥ä¼ é€’ä¸Šä¸‹æ–‡</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DelegatingContextExecutor</span>(executor);
    }
}

<span class="hljs-comment">/**
 * åŒ…è£… Executor ä¼ é€’ä¸Šä¸‹æ–‡
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DelegatingContextExecutor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Executor</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Executor delegate;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DelegatingContextExecutor</span><span class="hljs-params">(Executor delegate)</span> {
        <span class="hljs-built_in">this</span>.delegate = delegate;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">execute</span><span class="hljs-params">(Runnable command)</span> {
        <span class="hljs-comment">// æ•è·å½“å‰è¯·æ±‚ä¸Šä¸‹æ–‡</span>
        <span class="hljs-type">RequestAttributes</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> RequestContextHolder.currentRequestAttributes();
        
        delegate.execute(() -&gt; {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// åœ¨å­çº¿ç¨‹ä¸­è®¾ç½®ä¸Šä¸‹æ–‡</span>
                    RequestContextHolder.setRequestAttributes(context);
                    runnable.run();
                RequestContextHolder.setRequestAttributes(context);
                command.run();
            } <span class="hljs-keyword">finally</span> {
                <span class="hljs-comment">// æ¸…ç†ä¸Šä¸‹æ–‡</span>
              RequestContextHolder.resetRequestAttributes(); 
            }
        });
    }
}
</code></pre>
<h4 data-id="heading-8">4. è‡ªå®šä¹‰ RequestAttributes</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * è‡ªå®šä¹‰è¯·æ±‚å±æ€§
 */</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomRequestAttributes</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ServletRequestAttributes</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, Object&gt; customAttributes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">CustomRequestAttributes</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span> {
        <span class="hljs-built_in">super</span>(request, response);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getAttribute</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> scope)</span> {
        <span class="hljs-keyword">if</span> (scope == RequestAttributes.SCOPE_REQUEST) {
            <span class="hljs-type">Object</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> customAttributes.get(name);
            <span class="hljs-keyword">if</span> (value != <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span> value;
            }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.getAttribute(name, scope);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAttribute</span><span class="hljs-params">(String name, Object value, <span class="hljs-type">int</span> scope)</span> {
        <span class="hljs-keyword">if</span> (scope == RequestAttributes.SCOPE_REQUEST) {
            customAttributes.put(name, value);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-built_in">super</span>.setAttribute(name, value, scope);
        }
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">removeAttribute</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> scope)</span> {
        <span class="hljs-keyword">if</span> (scope == RequestAttributes.SCOPE_REQUEST) {
            customAttributes.remove(name);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-built_in">super</span>.removeAttribute(name, scope);
        }
    }
}

<span class="hljs-comment">/**
 * è¿‡æ»¤å™¨è®¾ç½®è‡ªå®šä¹‰ RequestAttributes
 */</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomRequestAttributesFilter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">OncePerRequestFilter</span> {
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doFilterInternal</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response,FilterChain filterChain)</span> <span class="hljs-keyword">throws</span> ServletException, IOException {
        
        <span class="hljs-comment">// åˆ›å»ºè‡ªå®šä¹‰ RequestAttributes</span>
        <span class="hljs-type">CustomRequestAttributes</span> <span class="hljs-variable">attributes</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomRequestAttributes</span>(request, response);
        
        <span class="hljs-comment">// è®¾ç½®ä¸€äº›è‡ªå®šä¹‰å±æ€§</span>
        attributes.setAttribute(<span class="hljs-string">"requestId"</span>, UUID.randomUUID().toString(), 
                              RequestAttributes.SCOPE_REQUEST);
        attributes.setAttribute(<span class="hljs-string">"startTime"</span>, System.currentTimeMillis(), 
                              RequestAttributes.SCOPE_REQUEST);
        
        <span class="hljs-comment">// è®¾ç½®åˆ° RequestContextHolder</span>
     RequestContextHolder.setRequestAttributes(attributes);
        <span class="hljs-keyword">try</span> {
            filterChain.doFilter(request, response);
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// è®°å½•è¯·æ±‚è€—æ—¶</span>
            <span class="hljs-type">Long</span> <span class="hljs-variable">startTime</span> <span class="hljs-operator">=</span> (Long) attributes.getAttribute(<span class="hljs-string">"startTime"</span>, 
                                                          RequestAttributes.SCOPE_REQUEST);
            <span class="hljs-keyword">if</span> (startTime != <span class="hljs-literal">null</span>) {
                <span class="hljs-type">long</span> <span class="hljs-variable">costTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis() - startTime;
                logger.info(<span class="hljs-string">"è¯·æ±‚è€—æ—¶: {}ms"</span>, costTime);
            }
            
            attributes.requestCompleted();
            RequestContextHolder.resetRequestAttributes();
        }
    }
}
</code></pre>
<p><strong>æ³¨æ„ï¼šè¦ä½¿ç”¨è‡ªå®šä¹‰çš„RequestAttributesä¸€å®šéœ€è¦é…ç½®ç›¸åº”çš„é…å¥—è¿‡æ»¤å™¨</strong></p>
<h4 data-id="heading-9">5. å®Œæ•´çš„å·¥å…·ç±»ç¤ºä¾‹</h4>
<p>æˆ‘ä»¬é€šå¸¸ä¼šå°†å…¶å°è£…æˆä¸€ä¸ªå·¥å…·ç±»ï¼Œæ–¹ä¾¿åœ¨æ•´ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.web.context.request.RequestContextHolder;
<span class="hljs-keyword">import</span> org.springframework.web.context.request.ServletRequestAttributes;

<span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;
<span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;
<span class="hljs-keyword">import</span> java.util.Objects;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HttpContextUtil</span> {

    <span class="hljs-comment">/**
     * è·å– HttpServletRequest
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> HttpServletRequest <span class="hljs-title function_">getRequest</span><span class="hljs-params">()</span> {
        <span class="hljs-type">ServletRequestAttributes</span> <span class="hljs-variable">attributes</span> <span class="hljs-operator">=</span> (ServletRequestAttributes) RequestContextHolder.currentRequestAttributes();
        <span class="hljs-keyword">return</span> attributes.getRequest();
    }

    <span class="hljs-comment">/**
     * è·å– HttpServletResponse
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> HttpServletResponse <span class="hljs-title function_">getResponse</span><span class="hljs-params">()</span> {
        <span class="hljs-type">ServletRequestAttributes</span> <span class="hljs-variable">attributes</span> <span class="hljs-operator">=</span> (ServletRequestAttributes) RequestContextHolder.currentRequestAttributes();
        <span class="hljs-keyword">return</span> attributes.getResponse();
    }

    <span class="hljs-comment">/**
     * è·å–è¯·æ±‚ä¸­çš„å±æ€§å€¼
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">getAttribute</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> getRequest();
        <span class="hljs-keyword">return</span> request.getAttribute(name);
    }

    <span class="hljs-comment">/**
     * è·å–è¯·æ±‚å¤´ä¸­çš„å€¼
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">getHeader</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> getRequest();
        <span class="hljs-keyword">return</span> request.getHeader(name);
    }

    <span class="hljs-comment">/**
     * è·å–è¯·æ±‚çš„å®Œæ•´ URL
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">getRequestURL</span><span class="hljs-params">()</span> {
        <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> getRequest();
        <span class="hljs-keyword">return</span> request.getRequestURL().toString();
    }

    <span class="hljs-comment">/**
     * è·å–å®¢æˆ·ç«¯ IP åœ°å€
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">getClientIP</span><span class="hljs-params">()</span> {
        <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> getRequest();
        <span class="hljs-type">String</span> <span class="hljs-variable">ip</span> <span class="hljs-operator">=</span> request.getHeader(<span class="hljs-string">"X-Forwarded-For"</span>);
        <span class="hljs-keyword">if</span> (ip == <span class="hljs-literal">null</span> || ip.length() == <span class="hljs-number">0</span> || <span class="hljs-string">"unknown"</span>.equalsIgnoreCase(ip)) {
            ip = request.getHeader(<span class="hljs-string">"Proxy-Client-IP"</span>);
        }
        <span class="hljs-keyword">if</span> (ip == <span class="hljs-literal">null</span> || ip.length() == <span class="hljs-number">0</span> || <span class="hljs-string">"unknown"</span>.equalsIgnoreCase(ip)) {
            ip = request.getHeader(<span class="hljs-string">"WL-Proxy-Client-IP"</span>);
        }
        <span class="hljs-keyword">if</span> (ip == <span class="hljs-literal">null</span> || ip.length() == <span class="hljs-number">0</span> || <span class="hljs-string">"unknown"</span>.equalsIgnoreCase(ip)) {
            ip = request.getRemoteAddr();
        }
        <span class="hljs-keyword">return</span> ip;
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-10">äº”ã€ä½¿ç”¨åœºæ™¯ä¸ç¤ºä¾‹</h3>
<ol>
<li>
<p><strong>åœ¨ Service å±‚è·å–ç”¨æˆ·ä¿¡æ¯</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doBusiness</span><span class="hljs-params">()</span> {
        <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> HttpContextUtil.getRequest();
        <span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> request.getHeader(<span class="hljs-string">"Authorization"</span>);
        <span class="hljs-comment">// ... æ ¹æ® token è§£æç”¨æˆ·ä¿¡æ¯å¹¶è¿›è¡Œä¸šåŠ¡æ“ä½œ</span>
    }
}
</code></pre>
</li>
<li>
<p><strong>åœ¨è‡ªå®šä¹‰æ³¨è§£æˆ– AOP åˆ‡é¢ä¸­å®ç°æƒé™æ ¡éªŒ</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Aspect</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PermissionAspect</span> {
    <span class="hljs-meta">@Around("@annotation(requiresPermission)")</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">checkPermission</span><span class="hljs-params">(ProceedingJoinPoint joinPoint, RequiresPermission requiresPermission)</span> <span class="hljs-keyword">throws</span> Throwable {
        <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> ((ServletRequestAttributes) RequestContextHolder.currentRequestAttributes()).getRequest();
        <span class="hljs-type">String</span> <span class="hljs-variable">userId</span> <span class="hljs-operator">=</span> (String) request.getSession().getAttribute(<span class="hljs-string">"userId"</span>);
        <span class="hljs-comment">// ... æ ¡éªŒç”¨æˆ·æƒé™é€»è¾‘</span>
        <span class="hljs-keyword">if</span> (!hasPermission(userId, requiresPermission.value())) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æ— æƒé™è®¿é—®"</span>);
        }
        <span class="hljs-keyword">return</span> joinPoint.proceed();
    }
}
</code></pre>
</li>
<li>
<p><strong>åœ¨å·¥å…·ç±»ä¸­è®°å½•è¯·æ±‚æ—¥å¿—</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LogUtils</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">recordAccessLog</span><span class="hljs-params">()</span> {
        <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> HttpContextUtil.getRequest();
        <span class="hljs-type">String</span> <span class="hljs-variable">ip</span> <span class="hljs-operator">=</span> HttpContextUtil.getClientIP();
        <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> request.getRequestURL().toString();
        <span class="hljs-type">String</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> request.getMethod();
        <span class="hljs-comment">// ... å°†æ—¥å¿—ä¿¡æ¯å­˜å…¥æ•°æ®åº“æˆ–å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—</span>
    }
}
</code></pre>
</li>
</ol>
<h3 data-id="heading-11">å…­ã€é‡è¦æ³¨æ„äº‹é¡¹</h3>
<ol>
<li><strong>çº¿ç¨‹å®‰å…¨æ€§</strong>ï¼š<code>RequestContextHolder</code> æœ¬èº«æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› ä¸ºå®ƒåŸºäº ThreadLocalã€‚æ¯ä¸ªçº¿ç¨‹æ“ä½œçš„éƒ½æ˜¯è‡ªå·±ç‹¬æœ‰çš„å‰¯æœ¬ï¼Œä¸ä¼šç›¸äº’å¹²æ‰°ã€‚</li>
<li><strong>ç¯å¢ƒé™åˆ¶</strong>ï¼š<strong>å®ƒåªèƒ½åœ¨ Spring Web ç¯å¢ƒä¸‹çš„ HTTP è¯·æ±‚çº¿ç¨‹ä¸­ä½¿ç”¨</strong>ã€‚å¦‚æœä½ åœ¨ä»¥ä¸‹åœºæ™¯è°ƒç”¨ï¼Œä¼šæŠ›å‡º <code>IllegalStateException</code>ï¼š
<ul>
<li><strong>å¼‚æ­¥çº¿ç¨‹ï¼ˆ@Asyncï¼‰</strong>ï¼šæ–°å¼€å¯çš„å¼‚æ­¥çº¿ç¨‹æ— æ³•è·å–åˆ°åŸè¯·æ±‚çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ã€‚</li>
<li><strong>å®šæ—¶ä»»åŠ¡ï¼ˆ@Scheduledï¼‰</strong>ï¼šå®šæ—¶ä»»åŠ¡æ²¡æœ‰ä¸ä¹‹å…³è”çš„ HTTP è¯·æ±‚ã€‚</li>
<li><strong>æ™®é€šçš„ main æ–¹æ³•</strong>æˆ–<strong>æ¶ˆæ¯ç›‘å¬å™¨</strong>ï¼ˆå¦‚æœç›‘å¬å™¨ä¸åœ¨ Web è¯·æ±‚çº¿ç¨‹ä¸­å¤„ç†æ¶ˆæ¯ï¼‰ã€‚</li>
</ul>
</li>
<li><strong>å¼‚æ­¥ç¼–ç¨‹ä¸­çš„ä¸Šä¸‹æ–‡ä¼ é€’</strong>ï¼šå¦‚æœéœ€è¦åœ¨å¼‚æ­¥çº¿ç¨‹ä¸­ä½¿ç”¨è¯·æ±‚ä¸Šä¸‹æ–‡ï¼Œå¿…é¡»åœ¨å¯åŠ¨å¼‚æ­¥ä»»åŠ¡ä¹‹å‰ï¼Œå°† <code>RequestAttributes</code> å¯¹è±¡æ•è·å¹¶ä¼ é€’åˆ°æ–°çº¿ç¨‹ä¸­ï¼Œç„¶ååœ¨æ–°çº¿ç¨‹å¼€å§‹æ—¶å°†å…¶é‡æ–°ç»‘å®šã€‚Spring æä¾›äº† <code>RequestContextListener</code> å’Œæ”¯æŒ <code>DelegatingRequestContext</code> çš„ <code>Executor</code> æ¥å¸®åŠ©å®ç°è¿™ä¸€ç‚¹ã€‚</li>
</ol>
<h3 data-id="heading-12">æ€»ç»“</h3>
<p><code>RequestContextHolder</code> æ˜¯ Spring Web ç”Ÿæ€ä¸­ä¸€ä¸ªâ€œå¹•åè‹±é›„â€å¼çš„å·¥å…·ç±»ï¼Œå®ƒåˆ©ç”¨ ThreadLocal å·§å¦™åœ°å°† HTTP è¯·æ±‚ä¸Šä¸‹æ–‡è´¯ç©¿æ•´ä¸ªè¯·æ±‚å¤„ç†ç”Ÿå‘½å‘¨æœŸï¼Œæå¤§åœ°å¢åŠ äº†ä»£ç çš„çµæ´»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œæ˜¯è§£è€¦ Controller å±‚ä¸ä¸‹å±‚ç»„ä»¶ä¾èµ–çš„åˆ©å™¨ã€‚ç†è§£å¹¶æ­£ç¡®ä½¿ç”¨å®ƒï¼Œæ˜¯æˆä¸º Spring é«˜çº§å¼€å‘è€…çš„é‡è¦ä¸€æ­¥ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[BlockLeverå®æˆ˜è¥æ—¥å¿— #6 | é›†æˆæµ‹è¯•]]></title>    <link>https://juejin.cn/post/7582905804048859163</link>    <guid>https://juejin.cn/post/7582905804048859163</guid>    <pubDate>2025-12-14T03:09:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582905804048859163" data-draft-id="7583138169378996274" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="BlockLeverå®æˆ˜è¥æ—¥å¿— #6 | é›†æˆæµ‹è¯•"/> <meta itemprop="keywords" content="AIç¼–ç¨‹,web3"/> <meta itemprop="datePublished" content="2025-12-14T03:09:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Keeganå°é’¢"/> <meta itemprop="url" content="https://juejin.cn/user/1609340750665758"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            BlockLeverå®æˆ˜è¥æ—¥å¿— #6 | é›†æˆæµ‹è¯•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1609340750665758/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Keeganå°é’¢
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T03:09:32.000Z" title="Sun Dec 14 2025 03:09:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿™æ˜¯æˆ‘ä»¬ç ”å‘ã€Œ<strong>BlockLever</strong>ã€çš„ç¬¬ 6 ç¯‡ç ”å‘æ—¥å¿—ï¼Œå‰ 5 ç¯‡å¦‚ä¸‹ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzA5OTI1NDE0Mw%3D%3D%26mid%3D2652495403%26idx%3D1%26sn%3D9d79878fd9bd5f4202ff30dfb290e58d%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzA5OTI1NDE0Mw==&amp;mid=2652495403&amp;idx=1&amp;sn=9d79878fd9bd5f4202ff30dfb290e58d&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">BlockLeverå®æˆ˜è¥æ—¥å¿— #1 | å¼€è¥</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzA5OTI1NDE0Mw%3D%3D%26mid%3D2652495408%26idx%3D1%26sn%3Df13a228d5387e1512da7d07a72741846%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzA5OTI1NDE0Mw==&amp;mid=2652495408&amp;idx=1&amp;sn=f13a228d5387e1512da7d07a72741846&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">BlockLeverå®æˆ˜è¥æ—¥å¿— #2 | äº§å“éœ€æ±‚æ¢³ç†</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzA5OTI1NDE0Mw%3D%3D%26mid%3D2652495437%26idx%3D1%26sn%3Dd7c07cb65d8d09888038b2b8890647b3%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzA5OTI1NDE0Mw==&amp;mid=2652495437&amp;idx=1&amp;sn=d7c07cb65d8d09888038b2b8890647b3&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">BlockLeverå®æˆ˜è¥æ—¥å¿— #3 | åˆçº¦å¼€å‘é˜¶æ®µ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzA5OTI1NDE0Mw%3D%3D%26mid%3D2652495442%26idx%3D1%26sn%3D451f5af91a5ecaeb57ea6835cdc01e22%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzA5OTI1NDE0Mw==&amp;mid=2652495442&amp;idx=1&amp;sn=451f5af91a5ecaeb57ea6835cdc01e22&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">BlockLeverå®æˆ˜è¥æ—¥å¿— #4 | å®Œæˆç¬¬ä¸€ä¸ªé‡Œç¨‹ç¢‘</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FxrSoCcXpOkUZbh4QoxSqbA" target="_blank" title="https://mp.weixin.qq.com/s/xrSoCcXpOkUZbh4QoxSqbA" ref="nofollow noopener noreferrer">BlockLeverå®æˆ˜è¥æ—¥å¿— #5 | é‡æ–°æ¢³ç†æ–‡æ¡£</a></li>
</ul>
<p>å‰å¤©ï¼Œåœ¨åš fork ä¸»ç½‘çš„é›†æˆæµ‹è¯•çš„æ—¶å€™ï¼Œå‘ç°åœ¨è·¯ç”±åˆçº¦ä¸­å¼•å…¥çš„ <strong>QuoterV3</strong> åˆçº¦æ— æ³•æ­£å¸¸å·¥ä½œï¼Œæ˜¨å¤©é›†ä¸­ç²¾åŠ›å¯¹å…¶è¿›è¡Œäº†è°ƒè¯•ï¼Œç»ˆäºå‘ç°äº†é—®é¢˜ï¼Œä¿®å¤åé›†æˆæµ‹è¯•ä¹Ÿé€šè¿‡äº†ã€‚</p>
<h2 data-id="heading-0">èƒŒæ™¯ä»‹ç»</h2>
<p>å¾ˆå¤šäº†è§£è¿‡ <strong>UniswapV3</strong> çš„æŠ€æœ¯äººå‘˜éƒ½çŸ¥é“ï¼Œå…¶æœ‰ä¸ª <strong>QuoterV2</strong> åˆçº¦æä¾›äº†ç³»åˆ—æŠ¥ä»·å‡½æ•°ï¼Œæœ€æ ¸å¿ƒçš„å°±æ˜¯ 4 ä¸ªå‡½æ•°ï¼š</p>
<ul>
<li><strong>quoteExactInputSingle</strong></li>
<li><strong>quoteExactOutputSingle</strong></li>
<li><strong>quoteExactInput</strong></li>
<li><strong>quoteExactOutput</strong></li>
</ul>
<p>ç„¶è€Œï¼Œå› ä¸ºåº•å±‚å®ç°æ—¶ä¼šç›´æ¥è°ƒç”¨ <strong>pool</strong> åˆçº¦çš„ <code>swap</code> å‡½æ•°ï¼Œæ‰€ä»¥è¿™å‡ ä¸ª <code>quote</code> å‡½æ•°éƒ½æ— æ³•è¢«å£°æ˜ä¸º <strong>view</strong> å‡½æ•°ï¼Œè¿™å°±ç»™å¾ˆå¤šåˆçº¦æ¥å…¥çš„é¡¹ç›®å¸¦æ¥äº†è¯¸å¤šä¸ä¾¿ã€‚</p>
<p>åœ¨ã€Œ<strong>BlockLever</strong>ã€é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰æ¥å…¥ UniswapV3ï¼Œè€Œæ˜¯æ¥å…¥ <strong>PancakeSwapV3</strong>ã€‚è€Œ PancakeSwapV3 æ˜¯åœ¨ UniswapV3 çš„åŸºç¡€ä¸Šç¨å¾®åšäº†å¾ˆå°çš„ä¸€ç‚¹æ”¹åŠ¨è€Œéƒ¨ç½²çš„ï¼Œå…¶ <strong>Quoter</strong> åˆçº¦ä¹Ÿæ˜¯å’Œ UniswapV3 çš„ä¸€æ ·ï¼Œå‡ ä¸ªæŠ¥ä»·å‡½æ•°ä¹Ÿä¸æ˜¯åªè¯»çš„ <strong>view</strong> å‡½æ•°ã€‚</p>
<p>ã€Œ<strong>BlockLever</strong>ã€çš„è·¯ç”±åˆçº¦å®šä¹‰äº†å‡ ä¸ªé¢„è§ˆå‡½æ•°å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>previewBorrowToBuy</strong></li>
<li><strong>previewSellToRepay</strong></li>
<li><strong>previewBorrowToSell</strong></li>
<li><strong>previewBuyToRepay</strong></li>
</ul>
<p>è¿™å‡ ä¸ªé¢„è§ˆå‡½æ•°éœ€è¦è°ƒç”¨ <strong>Quoter</strong> åˆçº¦æŸ¥è¯¢æŠ¥ä»·ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥ä½¿ç”¨ä»¥ä¸Šè¯´çš„ <code>quote</code> å‡½æ•°ï¼Œé‚£æˆ‘ä»¬è¿™å‡ ä¸ª <code>preview</code> å‡½æ•°ä¹Ÿä¸€æ ·æ— æ³•å£°æ˜ä¸º <code>view</code> å‡½æ•°ã€‚</p>
<p>åœ¨ DeFi åè®®ä¸­ï¼Œ<code>preview</code> ç±»å‹çš„å‡½æ•°å¹¶ä¸ä»…ä»…æ˜¯â€œå¼€å‘æ—¶æ–¹ä¾¿è°ƒè¯•ç”¨â€ã€‚å®ƒä»¬å¾€å¾€æ‰¿æ‹…ç€å‡ ä¸ªéå¸¸é‡è¦çš„è§’è‰²ï¼š</p>
<ol>
<li><strong>å‰ç«¯æŠ¥ä»·é¢„è§ˆ</strong></li>
<li><strong>åŒºå—æµè§ˆå™¨ç›´æ¥æŸ¥è¯¢</strong></li>
<li><strong>ç¬¬ä¸‰æ–¹åˆçº¦åªè¯»è°ƒç”¨</strong></li>
<li><strong>é£æ§ä¸ç­–ç•¥æ¨¡æ‹Ÿ</strong></li>
</ol>
<p>å¦‚æœè¿™äº›å‡½æ•°ä¸æ˜¯ <code>view</code>ï¼Œé‚£ä¹ˆï¼š</p>
<ul>
<li>å‰ç«¯éœ€è¦é€šè¿‡ transaction è°ƒç”¨ï¼Œä½“éªŒæå·®</li>
<li>åŒºå—æµè§ˆå™¨æ— æ³•ç›´æ¥æŸ¥è¯¢</li>
<li>ç¬¬ä¸‰æ–¹åè®®éš¾ä»¥å®‰å…¨é›†æˆ</li>
<li>ç”¨æˆ·æ— æ³•ä½æˆæœ¬è¿›è¡Œç­–ç•¥é¢„ä¼°</li>
</ul>
<p>å› æ­¤ï¼Œåœ¨ BlockLever ä¸­ï¼Œæˆ‘ä»¬éå¸¸æ˜ç¡®åœ°å°†æ‰€æœ‰ <code>preview</code> å‡½æ•°å®šä¹‰ä¸º <strong>çº¯åªè¯»å‡½æ•°</strong>ï¼Œè¿™æ˜¯ä¸€ä¸ªäº§å“çº§åˆ«çš„è®¾è®¡å†³ç­–ï¼Œè€Œä¸ä»…æ˜¯æŠ€æœ¯å®ç°ç»†èŠ‚ã€‚</p>
<p>æœ‰æ²¡æœ‰åŠæ³•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿå…¶å®æ˜¯æœ‰çš„ï¼Œæˆ‘ä»¬ä¸ç”¨ QuoterV2ï¼Œæ”¹ç”¨ <strong>QuoterV3</strong> å³å¯ï¼Œè¿™å°±è¦ç”¨åˆ°ä¸‹é¢ä»‹ç»çš„è¿™ä¸ªåº“äº†ã€‚</p>
<h2 data-id="heading-1">view-quoter-v3</h2>
<p>å…¶å® Uniswap åæ¥æ˜¯æœ‰å®ç° <strong>v3 ç‰ˆæœ¬çš„ Quoter åˆçº¦</strong>çš„ï¼Œåªä¸è¿‡å®ƒæ˜¯ä»¥ä¸€ä¸ª<strong>ç‹¬ç«‹ä»“åº“</strong>çš„å½¢å¼å­˜åœ¨ï¼Œå› æ­¤å¹¶æ²¡æœ‰åƒ QuoterV2 é‚£æ ·è¢«å¹¿æ³›ä½¿ç”¨å’Œè®¤çŸ¥ã€‚</p>
<p>è¯¥é¡¹ç›®çš„ GitHub åœ°å€å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FUniswap%2Fview-quoter-v3" target="_blank" title="https://github.com/Uniswap/view-quoter-v3" ref="nofollow noopener noreferrer">github.com/Uniswap/vieâ€¦</a></strong></li>
</ul>
<p>è¿™ä¸ªé¡¹ç›®ä¸­çš„ <strong>Quoter</strong> åˆçº¦ï¼Œå¯¹å¤–æä¾›äº†ä¸ <strong>QuoterV2</strong> å®Œå…¨ä¸€è‡´çš„ 4 ä¸ªæ ¸å¿ƒæŠ¥ä»·å‡½æ•°ï¼ŒåŒæ—¶è¿˜é¢å¤–å¢åŠ äº†ä¸¤ä¸ªæ”¯æŒç›´æ¥æŒ‡å®š Pool çš„å‡½æ•°ï¼š</p>
<ul>
<li><strong>quoteExactInputSingleWithPool</strong></li>
<li><strong>quoteExactOutputSingleWithPool</strong></li>
</ul>
<p>æœ€å…³é”®çš„ä¸€ç‚¹åœ¨äºï¼š<strong>æ‰€æœ‰æŠ¥ä»·å‡½æ•°éƒ½è¢«å£°æ˜ä¸º <code>view</code> å‡½æ•°</strong>ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬åœ¨ BlockLever ä¸­æ‰€éœ€è¦çš„èƒ½åŠ›ã€‚</p>
<p>å…¶æ ¸å¿ƒå®ç°æ€è·¯ï¼Œæ˜¯å°†åŸæœ¬ä½äº <code>UniswapV3Pool</code> ä¸­ã€ä¾èµ– <code>swap</code> æ‰§è¡Œè¿‡ç¨‹çš„è®¡ç®—é€»è¾‘ï¼Œé‡æ–°æŠ½ç¦»å¹¶æ”¹å†™ä¸º<strong>çº¯è®¡ç®—é€»è¾‘</strong>ï¼Œä»è€Œé¿å…ä»»ä½•çŠ¶æ€ä¿®æ”¹ï¼Œä½¿å…¶å¯ä»¥å®‰å…¨åœ°ä»¥åªè¯»æ–¹å¼è°ƒç”¨ã€‚</p>
<p>Uniswap å®˜æ–¹å…¶å®ä¹Ÿå·²ç»åœ¨ <strong>BNB Chain</strong> ä¸Šéƒ¨ç½²äº†è¯¥åˆçº¦ã€‚ä½†ç”±äº BlockLever æ¥å…¥çš„å¹¶ä¸æ˜¯ Uniswapï¼Œè€Œæ˜¯ <strong>PancakeSwapV3</strong>ï¼Œå› æ­¤æ— æ³•ç›´æ¥å¤ç”¨è¯¥å®ç°ã€‚</p>
<p>è€Œ PancakeSwap å®˜æ–¹ç›®å‰ä¹Ÿå¹¶æ²¡æœ‰æä¾›å¯¹åº”çš„ <strong>view Quoter</strong> åˆçº¦ï¼Œäºæ˜¯æˆ‘ä»¬é€‰æ‹© <strong>fork è¯¥é¡¹ç›®ï¼Œå¹¶å¯¹å…¶è¿›è¡Œé€‚é… PancakeSwapV3 çš„ä¿®æ”¹</strong>ï¼Œä»¥æ»¡è¶³è·¯ç”±åˆçº¦ä¸­é¢„è§ˆå‡½æ•°çš„è°ƒç”¨éœ€æ±‚ã€‚</p>
<p>äº‹å®ä¸Šï¼Œåœ¨ç¬¬ä¸€æœŸå®æˆ˜è¥é¡¹ç›® <strong>ã€ŒBlockETFã€</strong> ä¸­ï¼Œæˆ‘ä»¬å°±å·²ç»å®ç°è¿‡ä¸€ç‰ˆ <strong>é€‚é… PancakeSwap çš„åªè¯» Quoter åˆçº¦</strong>ã€‚</p>
<p>ä¸è¿‡ï¼ŒBlockETF ä¸­çš„é¢„è§ˆé€»è¾‘å¹¶ä¸å®Œå…¨ä¾èµ– Quoter æŠ¥ä»·ç»“æœï¼Œè€Œæ˜¯åŒæ—¶ç»“åˆäº† <strong>ä»·æ ¼é¢„è¨€æœºçš„æ•°æ®</strong> è¿›è¡Œè®¡ç®—ã€‚å› æ­¤ï¼Œå³ä½¿ Quoter åˆçº¦æœ¬èº«å­˜åœ¨é—®é¢˜ï¼ŒBlockETF åœ¨å®é™…è¿è¡Œä¸­ä¾ç„¶ä¸ä¼šå‡ºç°æ˜æ˜¾å¼‚å¸¸ã€‚</p>
<p>ä¹Ÿæ­£å› å¦‚æ­¤ï¼Œå¦‚æœä¸æ˜¯è¿™æ¬¡åœ¨ <strong>BlockLever çš„ä¸»ç½‘ fork é›†æˆæµ‹è¯•</strong> ä¸­å®Œæ•´è·‘é€šçœŸå®è°ƒç”¨é“¾è·¯ï¼Œæˆ‘ä»¬å¾ˆå¯èƒ½ä¼šä¸€ç›´<strong>è¯¯ä»¥ä¸º BlockETF ä¸­ä½¿ç”¨çš„ Quoter å®ç°æ˜¯å®Œå…¨å¯ç”¨çš„</strong>ã€‚</p>
<p>è¿™æ¬¡é—®é¢˜çš„æš´éœ²ï¼Œä¹Ÿå†æ¬¡éªŒè¯äº†ä¸€ä¸ªäº‹å®ï¼š<strong>åªæœ‰åœ¨çœŸå®ç¯å¢ƒä¸‹è¿›è¡Œç³»ç»Ÿçº§é›†æˆæµ‹è¯•ï¼Œæ‰èƒ½å‘ç°é‚£äº›è¢«ä¸šåŠ¡é€»è¾‘â€œæ©ç›–â€çš„åº•å±‚éšæ‚£ã€‚</strong></p>
<h2 data-id="heading-2">é€‚é… PancakeSwap çš„æ ¸å¿ƒæ”¹åŠ¨</h2>
<p>å°† <strong>view-quoter-v3</strong> é€‚é…ä¸ºæ”¯æŒ <strong>PancakeSwapV3</strong>ï¼Œæ•´ä½“æ”¹åŠ¨å…¶å®å¹¶ä¸å¤šï¼Œä¸»è¦é›†ä¸­åœ¨ <strong>Pool åœ°å€è®¡ç®—é€»è¾‘</strong> ä»¥åŠ <strong>Pool æ¥å£å®šä¹‰å·®å¼‚</strong> è¿™ä¸¤ä¸ªæ–¹é¢ã€‚</p>
<h3 data-id="heading-3">1. PoolAddress åº“çš„é€‚é…</h3>
<p>é¦–å…ˆéœ€è¦ä¿®æ”¹çš„æ˜¯ <strong>PoolAddress</strong> åº“åˆçº¦ï¼Œè¯¥åˆçº¦ä¸­å­˜åœ¨ä¸¤ä¸ªå¿…é¡»è°ƒæ•´çš„å…³é”®ç‚¹ã€‚</p>
<p><strong>ç¬¬ä¸€ä¸ªä¿®æ”¹ç‚¹</strong> æ˜¯ <code>POOL_INIT_CODE_HASH</code>ã€‚è¯¥å¸¸é‡éœ€è¦ä» <strong>UniswapV3Pool</strong> çš„ <code>POOL_INIT_CODE_HASH</code>ï¼Œæ›¿æ¢ä¸º <strong>PancakeSwapV3Pool</strong> å¯¹åº”çš„å€¼ï¼Œå¦åˆ™åœ¨è®¡ç®— Pool åœ°å€æ—¶ä¼šç›´æ¥å¾—åˆ°é”™è¯¯ç»“æœã€‚</p>
<p><strong>ç¬¬äºŒä¸ªä¿®æ”¹ç‚¹</strong> ä½äº <code>computeAddress</code> å‡½æ•°ä¸­ã€‚åœ¨ UniswapV3 ä¸­ï¼Œè®¡ç®— Pool åœ°å€æ—¶ä½¿ç”¨çš„æ˜¯ <strong>Factory åˆçº¦åœ°å€</strong>ï¼›è€Œåœ¨ PancakeSwapV3 ä¸­ï¼Œç”¨äºè®¡ç®— Pool åœ°å€çš„å¹¶ä¸æ˜¯å·¥å‚åˆçº¦ï¼Œè€Œæ˜¯ <strong>Deployer åˆçº¦åœ°å€</strong>ã€‚</p>
<p>å› æ­¤ï¼Œ<code>computeAddress</code> å‡½æ•°ä¸­çš„ <code>factory</code> å‚æ•°éœ€è¦æ•´ä½“æ›¿æ¢ä¸º PancakeSwapV3 çš„ deployer åœ°å€ã€‚</p>
<p>è¿™ä¸¤å¤„å·®å¼‚ï¼Œéƒ½å¯ä»¥ç›´æ¥é€šè¿‡å¯¹æ¯” PancakeSwap å®˜æ–¹ä»“åº“ä¸­çš„ <strong>PoolAddress</strong> å®ç°æ¥ç¡®è®¤ã€‚</p>
<h3 data-id="heading-4">2. Pool æ¥å£ç±»å‹çš„æ›¿æ¢</h3>
<p>ç¬¬äºŒç±»æ”¹åŠ¨ï¼Œå‘ç”Ÿåœ¨å¤šä¸ªå¼•ç”¨ <strong>IUniswapV3Pool</strong> æ¥å£çš„åˆçº¦ä¸­ã€‚</p>
<p>åœ¨è¿™äº›åœ°æ–¹ï¼Œæˆ‘ä»¬ç»Ÿä¸€å°†æ¥å£æ›¿æ¢ä¸º <strong>IPancakeV3Pool</strong>ã€‚è¿™ä¸€é—®é¢˜ï¼Œæ­£æ˜¯åœ¨æœ¬æ¬¡ <strong>BlockLever çš„ä¸»ç½‘ fork é›†æˆæµ‹è¯•</strong> ä¸­è¢«çœŸæ­£æš´éœ²å‡ºæ¥çš„ã€‚</p>
<p>å…¶æ ¹æœ¬åŸå› åœ¨äºï¼Œä¸¤è€…è™½ç„¶æ¥å£åå’Œå‡½æ•°ç»“æ„é«˜åº¦ç›¸ä¼¼ï¼Œä½†åœ¨ <strong>ç»†èŠ‚å®šä¹‰ä¸Šå¹¶ä¸å®Œå…¨ä¸€è‡´</strong>ã€‚</p>
<p>ä¸€ä¸ªéå¸¸å…¸å‹çš„å·®å¼‚ç‚¹ï¼Œæ˜¯ <code>slot0()</code> å‡½æ•°çš„è¿”å›å€¼ç±»å‹ï¼š</p>
<ul>
<li>åœ¨ <strong>IUniswapV3Pool</strong> ä¸­ï¼Œ<code>feeProtocol</code> å­—æ®µçš„ç±»å‹ä¸º <strong>uint8</strong></li>
<li>è€Œåœ¨ <strong>IPancakeV3Pool</strong> ä¸­ï¼Œå¯¹åº”å­—æ®µçš„ç±»å‹ä¸º <strong>uint32</strong></li>
</ul>
<p>è¿™ä¸€å·®å¼‚åœ¨å•å…ƒæµ‹è¯•æˆ–æ¨¡æ‹Ÿç¯å¢ƒä¸­å¹¶ä¸ä¸€å®šä¼šç«‹åˆ»è§¦å‘é—®é¢˜ï¼Œä½†åœ¨ fork ä¸»ç½‘ã€è¯»å–çœŸå® Pool çŠ¶æ€æ—¶ï¼Œå°±ä¼šå¯¼è‡´ <strong>ABI è§£ç é”™è¯¯æˆ–æ½œåœ¨çš„é€»è¾‘å¼‚å¸¸</strong>ã€‚</p>
<h3 data-id="heading-5">3. ä¸ºä»€ä¹ˆè¿™ä¸ªé—®é¢˜å®¹æ˜“è¢«å¿½ç•¥</h3>
<p>ä»è¡¨é¢ä¸Šçœ‹ï¼ŒUniswapV3 ä¸ PancakeSwapV3 çš„ Pool æ¥å£â€œå‡ ä¹ä¸€è‡´â€ï¼Œä½†æ­£æ˜¯è¿™ç§â€œé«˜åº¦ç›¸ä¼¼â€ï¼Œåè€Œå®¹æ˜“è®©äººåœ¨å®ç°æ—¶ <strong>ä¸‹æ„è¯†åœ°ç›´æ¥å¤ç”¨æ¥å£å®šä¹‰</strong>ã€‚</p>
<p>å¦‚æœæ²¡æœ‰åœ¨çœŸå®é“¾ä¸Šç¯å¢ƒä¸­è¿›è¡Œå®Œæ•´çš„é›†æˆæµ‹è¯•ï¼Œè¿™ç±» <strong>ç±»å‹çº§åˆ«çš„ä¸ä¸€è‡´</strong> å¾ˆå®¹æ˜“é•¿æœŸæ½œä¼åœ¨ç³»ç»Ÿä¸­ï¼Œè€Œä¸è¢«å¯Ÿè§‰ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆï¼Œæœ¬æ¬¡é—®é¢˜å¹¶ä¸æ˜¯é€šè¿‡å•å…ƒæµ‹è¯•å‘ç°çš„ï¼Œè€Œæ˜¯ä¾èµ– <strong>fork ä¸»ç½‘åçš„ç³»ç»Ÿçº§éªŒè¯</strong> æ‰è¢«å‡†ç¡®å®šä½ã€‚</p>
<h3 data-id="heading-6">å°ç»“</h3>
<p>è¿™æ¬¡ view-quoter-v3 çš„é€‚é…è¿‡ç¨‹å†æ¬¡å°è¯äº†ä¸€ç‚¹ï¼š</p>
<blockquote>
<p><strong>åœ¨ DeFi åè®®é›†æˆä¸­ï¼Œâ€œæ¥å£çœ‹èµ·æ¥ä¸€æ ·â€å¹¶ä¸ç­‰äºâ€œå¯ä»¥å®‰å…¨å¤ç”¨â€ã€‚</strong></p>
</blockquote>
<p>å³ä¾¿æ˜¯æºè‡ªåŒä¸€å¥—è®¾è®¡ä½“ç³»çš„åè®®åˆ†æ”¯ï¼Œä¹Ÿå¿…é¡»ä»¥ <strong>çœŸå®éƒ¨ç½²å®ç°</strong> ä¸ºå‡†ï¼Œé€é¡¹éªŒè¯å…¶æ¥å£ã€å‚æ•°å’Œæ•°æ®ç±»å‹ï¼Œè€Œä¸èƒ½ä»…å‡­ç»éªŒæˆ–æ–‡æ¡£å‡è®¾å…¶è¡Œä¸ºä¸€è‡´ã€‚</p>
<h2 data-id="heading-7">é›†æˆæµ‹è¯•çš„çœŸæ­£ä»·å€¼</h2>
<p>å›è¿‡å¤´æ¥çœ‹ï¼Œè¿™æ¬¡ Quoter ç›¸å…³çš„é—®é¢˜ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªâ€œä»£ç å†™é”™äº†â€çš„é—®é¢˜ï¼Œè€Œæ˜¯ä¸€ä¸ª<strong>åªæœ‰åœ¨ç³»ç»Ÿçº§é›†æˆæµ‹è¯•ä¸­æ‰ä¼šæš´éœ²çš„é—®é¢˜</strong>ã€‚</p>
<p>å¦‚æœåªåœç•™åœ¨å•ä¸ªåˆçº¦ã€å•ä¸ªå‡½æ•°çš„å•å…ƒæµ‹è¯•å±‚é¢ï¼Œæ‰€æœ‰é€»è¾‘çœ‹èµ·æ¥éƒ½æ˜¯æ­£ç¡®çš„ï¼›ä½†å½“è¿™äº›åˆçº¦çœŸæ­£ä¸çœŸå®é“¾ä¸Šåè®®ã€çœŸå® Pool çŠ¶æ€äº¤äº’æ—¶ï¼Œç»†å¾®çš„å®ç°å·®å¼‚æ‰ä¼šè¢«æ”¾å¤§ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆï¼Œåœ¨ BlockLever çš„ç ”å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°† <strong>fork ä¸»ç½‘åçš„é›†æˆæµ‹è¯•</strong> è§†ä¸ºä¸€ä¸ªå¿…é¡»å®Œæˆçš„é˜¶æ®µï¼Œè€Œä¸æ˜¯å¯é€‰é¡¹ã€‚</p>
<p>å¯¹å®æˆ˜è¥çš„å­¦å‘˜æ¥è¯´ï¼Œè¿™ä¸€é˜¶æ®µåŒæ ·é‡è¦ï¼šçœŸæ­£çš„ DeFi å·¥ç¨‹èƒ½åŠ›ï¼Œå¹¶ä¸æ­¢äºâ€œå†™å‡ºåˆçº¦â€ï¼Œè€Œåœ¨äºè®©ä¸€æ•´å¥—ç³»ç»Ÿåœ¨çœŸå®ç¯å¢ƒä¸­ <strong>ç¨³å®šã€å¯é¢„æœŸã€å¯éªŒè¯åœ°è¿è¡Œ</strong>ã€‚</p>
<hr/>
<p>å‚è€ƒé˜…è¯»ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzA5OTI1NDE0Mw%3D%3D%26mid%3D2652495368%26idx%3D1%26sn%3D4634bab0e054169211f3ba8bb194029c%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzA5OTI1NDE0Mw==&amp;mid=2652495368&amp;idx=1&amp;sn=4634bab0e054169211f3ba8bb194029c&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">ç¬¬äºŒæœŸ AI+Web3 å®æˆ˜è¥å¯åŠ¨ï¼šä» BlockETF åˆ° BlockLever</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzA5OTI1NDE0Mw%3D%3D%26mid%3D2652495403%26idx%3D1%26sn%3D9d79878fd9bd5f4202ff30dfb290e58d%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzA5OTI1NDE0Mw==&amp;mid=2652495403&amp;idx=1&amp;sn=9d79878fd9bd5f4202ff30dfb290e58d&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">BlockLeverå®æˆ˜è¥æ—¥å¿— #1 | å¼€è¥</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzA5OTI1NDE0Mw%3D%3D%26mid%3D2652495408%26idx%3D1%26sn%3Df13a228d5387e1512da7d07a72741846%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzA5OTI1NDE0Mw==&amp;mid=2652495408&amp;idx=1&amp;sn=f13a228d5387e1512da7d07a72741846&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">BlockLeverå®æˆ˜è¥æ—¥å¿— #2 | äº§å“éœ€æ±‚æ¢³ç†</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzA5OTI1NDE0Mw%3D%3D%26mid%3D2652495413%26idx%3D1%26sn%3D0cdfe0cfc90d3daad0704f57654d1b6d%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzA5OTI1NDE0Mw==&amp;mid=2652495413&amp;idx=1&amp;sn=0cdfe0cfc90d3daad0704f57654d1b6d&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">Web2 ä¸å†å®‰å…¨æ„Ÿï¼šæŠ€æœ¯äººå¦‚ä½•è¸å…¥ AI + Web3 çš„æ–°æ—¶ä»£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzA5OTI1NDE0Mw%3D%3D%26mid%3D2652495418%26idx%3D1%26sn%3D52bce10b7461b5b2b41cdbcb46cb9663%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzA5OTI1NDE0Mw==&amp;mid=2652495418&amp;idx=1&amp;sn=52bce10b7461b5b2b41cdbcb46cb9663&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">AI + Web3 å®æˆ˜è¥ä»·å€¼åˆ†æ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzA5OTI1NDE0Mw%3D%3D%26mid%3D2652495424%26idx%3D1%26sn%3Db6ff0f2cc634faa5a4cc613c616b966b%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzA5OTI1NDE0Mw==&amp;mid=2652495424&amp;idx=1&amp;sn=b6ff0f2cc634faa5a4cc613c616b966b&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">ä»å…¥é—¨åˆ°å®æˆ˜ï¼šæˆ‘çš„å…¨å¥— Web3 å­¦ä¹ è·¯å¾„ï¼ˆ2025ç‰ˆï¼‰</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[gitï¼ˆå¸¦æµç¨‹å›¾ï¼‰]]></title>    <link>https://juejin.cn/post/7583138169378799666</link>    <guid>https://juejin.cn/post/7583138169378799666</guid>    <pubDate>2025-12-14T02:30:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583138169378799666" data-draft-id="7582904738921873446" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="gitï¼ˆå¸¦æµç¨‹å›¾ï¼‰"/> <meta itemprop="keywords" content="Git"/> <meta itemprop="datePublished" content="2025-12-14T02:30:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="coderCatIce"/> <meta itemprop="url" content="https://juejin.cn/user/127981962405726"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            gitï¼ˆå¸¦æµç¨‹å›¾ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/127981962405726/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    coderCatIce
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T02:30:11.000Z" title="Sun Dec 14 2025 02:30:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Git å…¨é¢å­¦ä¹ ç¬”è®°</h2>
<h3 data-id="heading-1">ä¸€ã€Git åŸºç¡€æ¦‚å¿µ</h3>
<h4 data-id="heading-2">1.1 ä»€ä¹ˆæ˜¯ Gitï¼Ÿ</h4>
<p>Git æ˜¯ä¸€ä¸ªå¼€æºçš„<strong>åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ</strong>ï¼Œç”¨äºæ•æ·é«˜æ•ˆåœ°å¤„ç†ä»»ä½•æˆ–å°æˆ–å¤§çš„é¡¹ç›®ã€‚å®ƒèƒ½è®°å½•æ–‡ä»¶çš„å†å²å˜æ›´ï¼Œæ–¹ä¾¿å¤šäººåä½œå¼€å‘ï¼ŒåŒæ—¶æ”¯æŒç¦»çº¿å·¥ä½œï¼Œæ ¸å¿ƒç‰¹ç‚¹åŒ…æ‹¬ï¼š</p>
<ul>
<li>
<p>åˆ†å¸ƒå¼ï¼šæ¯ä¸ªå¼€å‘è€…éƒ½æ‹¥æœ‰å®Œæ•´çš„ä»£ç ä»“åº“å‰¯æœ¬ï¼Œæ— éœ€ä¾èµ–ä¸­å¤®æœåŠ¡å™¨</p>
</li>
<li>
<p>ç‰ˆæœ¬æ§åˆ¶ï¼šè¿½è¸ªæ–‡ä»¶æ¯ä¸€æ¬¡ä¿®æ”¹ï¼Œå¯éšæ—¶å›æ»šåˆ°å†å²ç‰ˆæœ¬</p>
</li>
<li>
<p>åˆ†æ”¯ç®¡ç†ï¼šè½»é‡çº§åˆ†æ”¯æ“ä½œï¼Œæ”¯æŒå¹¶è¡Œå¼€å‘ä¸åŠŸèƒ½éš”ç¦»</p>
</li>
</ul>
<h4 data-id="heading-3">1.2 æ ¸å¿ƒå·¥ä½œåŒºåŸŸ</h4>
<p>Git å·¥ä½œæµç¨‹æ¶‰åŠå››ä¸ªæ ¸å¿ƒåŒºåŸŸï¼Œæ–‡ä»¶åœ¨è¿™äº›åŒºåŸŸé—´æµè½¬ï¼š</p>
<ol>
<li>
<p><strong>å·¥ä½œåŒº</strong>ï¼ˆWorking Directoryï¼‰ï¼šå®é™…æ“ä½œçš„<strong>æ–‡ä»¶ç›®å½•</strong>ï¼Œæ—¥å¸¸ç¼–è¾‘çš„æ–‡ä»¶å­˜æ”¾äºæ­¤</p>
</li>
<li>
<p><strong>æš‚å­˜åŒº</strong>ï¼ˆStage/Indexï¼‰ï¼šé€šè¿‡ <strong>add</strong> ä¸´æ—¶å­˜æ”¾å¾…æäº¤çš„ä¿®æ”¹ï¼Œç›¸å½“äº "å˜æ›´ç¼“å†²åŒº"</p>
</li>
<li>
<p><strong>æœ¬åœ°ä»“åº“</strong>ï¼ˆLocal Repositoryï¼‰ï¼šå­˜å‚¨å®Œæ•´çš„ç‰ˆæœ¬å†å²ï¼Œé€šè¿‡ <strong>commit</strong> å‘½ä»¤å°†æš‚å­˜åŒºå†…å®¹æäº¤è‡³æ­¤</p>
</li>
<li>
<p>è¿œç¨‹ä»“åº“ï¼ˆRemote Repositoryï¼‰ï¼šæ‰˜ç®¡åœ¨æœåŠ¡å™¨ä¸Šçš„ä»“åº“ï¼ˆå¦‚ GitHubã€GitLabï¼‰ï¼Œç”¨äºå›¢é˜Ÿåä½œå…±äº«</p>
</li>
</ol>
<h3 data-id="heading-4">äºŒã€Git ç¯å¢ƒé…ç½®</h3>
<h4 data-id="heading-5">2.1 å®‰è£… Git</h4>
<ul>
<li>Windowsï¼šä»Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fgit-scm.com%2F" target="_blank" title="https://git-scm.com/" ref="nofollow noopener noreferrer">Git å®˜ç½‘</a>Â ä¸‹è½½å®‰è£…åŒ…ï¼Œå‹¾é€‰ "Git Bash Here" æ–¹ä¾¿å³é”®è°ƒç”¨</li>
<li>macOSï¼šä½¿ç”¨ Homebrew å®‰è£…Â <code>brew install git</code>ï¼Œæˆ–é€šè¿‡å®˜ç½‘ä¸‹è½½</li>
<li>Linuxï¼šDebian ç³»åˆ—Â <code>sudo apt-get install git</code>ï¼ŒRedHat ç³»åˆ—Â <code>sudo yum install git</code></li>
</ul>
<h4 data-id="heading-6">2.2 åŸºç¡€é…ç½®ï¼ˆé¦–æ¬¡ä½¿ç”¨å¿…åšï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é…ç½®ç”¨æˆ·åï¼ˆä¸è¿œç¨‹ä»“åº“è´¦å·ä¸€è‡´ï¼‰</span>
git config --global user.name <span class="hljs-string">"Your Name"</span>
<span class="hljs-comment"># é…ç½®é‚®ç®±ï¼ˆä¸è¿œç¨‹ä»“åº“ç»‘å®šé‚®ç®±ä¸€è‡´ï¼‰</span>
git config --global user.email <span class="hljs-string">"your.email@example.com"</span>
<span class="hljs-comment"># æŸ¥çœ‹é…ç½®ä¿¡æ¯</span>
git config --list
</code></pre>
<h3 data-id="heading-7">ä¸‰ã€Git ä»“åº“æ“ä½œï¼ˆåˆå§‹åŒ–ä¸å…‹éš†ï¼‰</h3>

























<table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>git init</td><td>åœ¨å½“å‰ç›®å½•åˆå§‹åŒ–æœ¬åœ°ä»“åº“</td><td>git init my-project</td></tr><tr><td>git clone &lt;url&gt;</td><td>å…‹éš†è¿œç¨‹ä»“åº“åˆ°æœ¬åœ°</td><td>git cloneÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fusername%2Frepo.git" target="_blank" title="https://github.com/username/repo.git" ref="nofollow noopener noreferrer">github.com/username/reâ€¦</a></td></tr><tr><td>git clone &lt;url&gt; &lt;name&gt;</td><td>å…‹éš†å¹¶è‡ªå®šä¹‰æœ¬åœ°ä»“åº“å</td><td>git cloneÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fusername%2Frepo.git" target="_blank" title="https://github.com/username/repo.git" ref="nofollow noopener noreferrer">github.com/username/reâ€¦</a>Â my-repo</td></tr></tbody></table>
<h3 data-id="heading-8">å››ã€æ–‡ä»¶çŠ¶æ€ç®¡ç†ä¸æ’¤é”€æ“ä½œ</h3>
<h4 data-id="heading-9">4.1 æŸ¥çœ‹æ–‡ä»¶çŠ¶æ€</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹è¯¦ç»†çŠ¶æ€ï¼ˆæ˜¾ç¤ºå·²ä¿®æ”¹/æœªè·Ÿè¸ª/å·²æš‚å­˜æ–‡ä»¶ï¼‰</span>
git status
<span class="hljs-comment"># ç®€åŒ–çŠ¶æ€æ˜¾ç¤ºï¼ˆçº¢è‰²ï¼šä¿®æ”¹æœªæš‚å­˜ï¼›ç»¿è‰²ï¼šå·²æš‚å­˜ï¼‰</span>
git status -s
<span class="hljs-comment"># æŸ¥çœ‹æ–‡ä»¶ä¿®æ”¹è¯¦æƒ…</span>
git diff
</code></pre>
<h4 data-id="heading-10">4.2 add æš‚å­˜ä¸ commit æäº¤</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å°†å•ä¸ªæ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº</span>
git add filename.txt
<span class="hljs-comment"># å°†å½“å‰ç›®å½•æ‰€æœ‰ä¿®æ”¹æ·»åŠ åˆ°æš‚å­˜åŒº</span>
git add .
<span class="hljs-comment"># å°†æš‚å­˜åŒºå†…å®¹æäº¤åˆ°æœ¬åœ°ä»“åº“ï¼ˆå¿…é¡»å¡«å†™æäº¤ä¿¡æ¯ï¼‰</span>
git commit -m <span class="hljs-string">"feat: æ–°å¢ç”¨æˆ·ç™»å½•åŠŸèƒ½"</span>
<span class="hljs-comment"># è·³è¿‡æš‚å­˜åŒºï¼Œç›´æ¥æäº¤å·²è·Ÿè¸ªæ–‡ä»¶çš„ä¿®æ”¹</span>
git commit -a -m <span class="hljs-string">"fix: ä¿®å¤ç™»å½•è¡¨å•éªŒè¯bug"</span>
<span class="hljs-comment"># ä¿®æ”¹æœ€è¿‘ä¸€æ¬¡æäº¤ï¼ˆé€‚ç”¨äºè¡¥å……ä¿®æ”¹æˆ–ä¿®æ­£æäº¤ä¿¡æ¯ï¼‰</span>
git commit --amend
</code></pre>
<h4 data-id="heading-11">4.3 æ’¤é”€æ“ä½œ</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ’¤é”€å·¥ä½œåŒºä¿®æ”¹ï¼ˆæœªæš‚å­˜çš„æ–‡ä»¶ï¼Œè°¨æ…ä½¿ç”¨ï¼ä¼šä¸¢å¤±æœªæäº¤ä¿®æ”¹ï¼‰</span>
git checkout -- filename.txt
<span class="hljs-comment"># æ’¤é”€æš‚å­˜åŒºä¿®æ”¹ï¼ˆå°†æ–‡ä»¶ä»æš‚å­˜åŒºæ”¾å›å·¥ä½œåŒºï¼‰</span>
git reset HEAD filename.txt
<span class="hljs-comment"># åˆ é™¤æ–‡ä»¶å¹¶æš‚å­˜åˆ é™¤æ“ä½œ</span>
git <span class="hljs-built_in">rm</span> &lt;æ–‡ä»¶å&gt;
<span class="hljs-comment"># ä¿ç•™æ–‡ä»¶å¹¶æš‚å­˜åˆ é™¤æ“ä½œ</span>
git <span class="hljs-built_in">rm</span> --cached &lt;æ–‡ä»¶å&gt;
<span class="hljs-comment"># ç§»åŠ¨/é‡å‘½åæ–‡ä»¶å¹¶æš‚å­˜ä¿®æ”¹</span>
git <span class="hljs-built_in">mv</span> &lt;æ—§æ–‡ä»¶å&gt; &lt;æ–°æ–‡ä»¶å&gt;
<span class="hljs-comment"># æ’¤é”€æäº¤(åªæ’¤commitï¼Œä¿ç•™add)</span>
git reset HEAD~ --soft
<span class="hljs-comment"># æ’¤é”€æäº¤(æ’¤commitå’Œaddï¼Œä¿ç•™ä»£ç )</span>
git reset HEAD~
<span class="hljs-comment"># æ’¤é”€æäº¤(å…¨éƒ¨æ’¤å›ä¸Šæ¬¡æäº¤)</span>
git reset HEAD~ --hard
</code></pre>
<h4 data-id="heading-12">4.4 reset å‘½ä»¤ä¸ HEAD å¼•ç”¨</h4>
<h5 data-id="heading-13">4.4.1 HEAD å¼•ç”¨è¯´æ˜</h5>
<ul>
<li>
<p>HEADï¼šæŒ‡å‘å½“å‰åˆ†æ”¯çš„æœ€æ–°æäº¤</p>
</li>
<li>
<p>HEAD~ï¼šä¸Šä¸€ä¸ªæäº¤ï¼ŒHEAD~~ ä¸Šä¸Šä¸ªæäº¤ï¼Œä»¥æ­¤ç±»æ¨</p>
<ul>
<li>å¯ç®€å†™ä¸ºHEAD~nï¼šå¾€å‰ç¬¬ n ä¸ªæäº¤</li>
</ul>
</li>
</ul>
<h5 data-id="heading-14">4.4.2 git reset çš„ä¸‰ç§æ¨¡å¼</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># --softï¼šä»…ç§»åŠ¨ HEADï¼Œæš‚å­˜åŒºå’Œå·¥ä½œåŒºä¸å˜</span>
git reset --soft &lt;æäº¤ID/HEADå¼•ç”¨&gt;
<span class="hljs-comment"># --mixedï¼ˆé»˜è®¤ï¼‰ï¼šç§»åŠ¨ HEADï¼Œé‡ç½®æš‚å­˜åŒºï¼Œå·¥ä½œåŒºä¸å˜</span>
git reset &lt;æäº¤ID/HEADå¼•ç”¨&gt;
<span class="hljs-comment"># --hardï¼šç§»åŠ¨ HEADï¼Œé‡ç½®æš‚å­˜åŒºå’Œå·¥ä½œåŒºï¼ˆæ…ç”¨ï¼Œä¼šä¸¢å¤±æœªæäº¤ä¿®æ”¹ï¼‰</span>
git reset --hard &lt;æäº¤ID/HEADå¼•ç”¨&gt;
</code></pre>
<h3 data-id="heading-15">äº”ã€æäº¤æµç¨‹ä¸å†å²æŸ¥çœ‹</h3>
<h4 data-id="heading-16">5.1 å®Œæ•´æäº¤æµç¨‹</h4>
<ol>
<li>
<p>æŸ¥çœ‹ä¿®æ”¹ï¼š<code>git status</code></p>
</li>
<li>
<p>æš‚å­˜æ–‡ä»¶ï¼š<code>git add &lt;æ–‡ä»¶å&gt;</code>Â æˆ–Â <code>git add .</code></p>
</li>
<li>
<p>æäº¤åˆ°æœ¬åœ°ä»“åº“ï¼š<code>git commit -m "æäº¤è¯´æ˜"</code></p>
</li>
<li>
<p>è¡¥å……æäº¤ï¼ˆä¿®æ­£ä¸Šä¸€æ¬¡æäº¤ï¼‰ï¼š<code>git commit --amend</code></p>
</li>
</ol>
<p>æ­£å‘è¯¦ç»†æµç¨‹å›¾ï¼ˆä¸æ¶‰åŠresetç­‰å›é€€ï¼‰ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">stateDiagram-v2
    [*] --&gt; æœªè·Ÿè¸ª : æ–°å»ºæ–‡ä»¶
    [*] --&gt; æš‚å­˜æœªä¿®æ”¹ : git cloneå…‹éš†/git fetchæ‹‰å–ä»£ç 
    
    state å·¥ä½œåŒº {
    
        å·²ä¿®æ”¹
        æœªè·Ÿè¸ª
    }
    
    state æš‚å­˜åŒº {
        æš‚å­˜æœªä¿®æ”¹
        å·²æš‚å­˜
    }
    
    state æœ¬åœ°ä»“åº“ {
        å·²æäº¤
    }
    
    
    # æš‚å­˜åŒº â†’ ä»“åº“
    å·²æäº¤ --&gt; æš‚å­˜æœªä¿®æ”¹ : æäº¤åè‡ªåŠ¨è½¬å˜
    å·²æš‚å­˜ --&gt; å·²æäº¤ : git commit -m 'è¯´æ˜'
    å·²ä¿®æ”¹ --&gt; å·²æäº¤ : git commit -a -m 'è¯´æ˜'

    # å·¥ä½œåŒº â†’ æš‚å­˜åŒºï¼ˆå•å‘ç®­å¤´ï¼Œæ— äº¤å‰ï¼‰
    å·²ä¿®æ”¹ --&gt; å·²æš‚å­˜ : git add &lt;æ–‡ä»¶&gt;
    æœªè·Ÿè¸ª --&gt; å·²æš‚å­˜ : git add &lt;æ–‡ä»¶&gt;
    æš‚å­˜æœªä¿®æ”¹ --&gt; å·²ä¿®æ”¹ : æ‰‹åŠ¨ç¼–è¾‘
    
</code></pre>
<p>æ­£å‘ç®€è¦å›¾ï¼ˆä¸æ¶‰åŠresetï¼‰ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">stateDiagram-v2
    direction LR
    [*] --&gt; æœªè·Ÿè¸ª : æ–°å»ºæ–‡ä»¶
    [*] --&gt; æš‚å­˜æœªä¿®æ”¹ : å…‹éš†/æ‹‰å–ä»£ç 

    å·²æäº¤ --&gt; æš‚å­˜æœªä¿®æ”¹ : æäº¤åè‡ªåŠ¨è½¬å˜
    å·²æš‚å­˜ --&gt; å·²æäº¤ : git commit -m 'è¯´æ˜'
    å·²ä¿®æ”¹ --&gt; å·²æäº¤ : git commit -a -m 'è¯´æ˜'

    # å·¥ä½œåŒº â†’ æš‚å­˜åŒºï¼ˆå•å‘ç®­å¤´ï¼Œæ— äº¤å‰ï¼‰
    å·²ä¿®æ”¹ --&gt; å·²æš‚å­˜ : git add &lt;æ–‡ä»¶&gt;
    æœªè·Ÿè¸ª --&gt; å·²æš‚å­˜ : git add &lt;æ–‡ä»¶&gt;
    æš‚å­˜æœªä¿®æ”¹ --&gt; å·²ä¿®æ”¹ : æ‰‹åŠ¨ç¼–è¾‘
</code></pre>
<h4 data-id="heading-17">5.2 æŸ¥çœ‹æäº¤å†å²</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹å®Œæ•´æäº¤å†å²ï¼ˆæŒ‰æ—¶é—´å€’åºï¼Œæœ€æ–°åœ¨å‰ï¼‰</span>
git <span class="hljs-built_in">log</span>
<span class="hljs-comment"># ç®€åŒ–æ˜¾ç¤ºï¼ˆåªæ˜¾ç¤ºç‰ˆæœ¬å·å‰7ä½å’Œæäº¤ä¿¡æ¯ï¼‰</span>
git <span class="hljs-built_in">log</span> --oneline
<span class="hljs-comment"># æ˜¾ç¤ºæ‰€æœ‰åˆ†æ”¯çš„æäº¤</span>
git <span class="hljs-built_in">log</span> --all
<span class="hljs-comment"># æ˜¾ç¤ºåˆ†æ”¯åˆå¹¶å›¾</span>
git <span class="hljs-built_in">log</span> --graph
<span class="hljs-comment"># æŸ¥çœ‹æŒ‡å®šæ–‡ä»¶çš„ä¿®æ”¹å†å²</span>
git <span class="hljs-built_in">log</span> -p filename.txt
<span class="hljs-comment"># æŸ¥çœ‹æŒ‡å®šä½œè€…çš„æäº¤è®°å½•</span>
git <span class="hljs-built_in">log</span> --author=<span class="hljs-string">"Your Name"</span>
</code></pre>
<h3 data-id="heading-18">å…­ã€åˆ†æ”¯ç®¡ç†ä¸å†²çªè§£å†³</h3>
<h4 data-id="heading-19">6.1 åˆ†æ”¯åŸºæœ¬æ“ä½œ</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ï¼ˆå½“å‰åˆ†æ”¯å‰å¸¦ *ï¼‰</span>
git branch
<span class="hljs-comment"># æŸ¥çœ‹æœ¬åœ°+è¿œç¨‹æ‰€æœ‰åˆ†æ”¯</span>
git branch -a
<span class="hljs-comment"># åˆ›å»ºæ–°åˆ†æ”¯</span>
git branch åˆ†æ”¯å
<span class="hljs-comment"># åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯</span>
git checkout åˆ†æ”¯å
<span class="hljs-comment"># åˆ›å»ºå¹¶åˆ‡æ¢åˆ°æ–°åˆ†æ”¯ï¼ˆç®€åŒ–å†™æ³•ï¼‰</span>
git checkout -b åˆ†æ”¯å
<span class="hljs-comment"># åˆ é™¤æœ¬åœ°åˆ†æ”¯ï¼ˆéœ€å…ˆåˆ‡æ¢åˆ°å…¶ä»–åˆ†æ”¯ï¼‰</span>
git branch -d åˆ†æ”¯å
<span class="hljs-comment"># å¼ºåˆ¶åˆ é™¤æœªåˆå¹¶çš„åˆ†æ”¯ï¼ˆè°¨æ…ä½¿ç”¨ï¼ï¼‰</span>
git branch -D åˆ†æ”¯å
</code></pre>
<h4 data-id="heading-20">6.2 åˆ†æ”¯åˆå¹¶</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. åˆ‡æ¢åˆ°ç›®æ ‡åˆ†æ”¯ï¼ˆå¦‚ä¸»åˆ†æ”¯ï¼‰</span>
git checkout main
<span class="hljs-comment"># 2. åˆå¹¶æŒ‡å®šåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯ï¼ˆæ— å†²çªåˆ™ç›´æ¥åˆå¹¶ï¼‰</span>
git merge feature/login
</code></pre>
<h4 data-id="heading-21">6.3 å†²çªè§£å†³</h4>
<ol>
<li>
<p>git status æŸ¥çœ‹å“ªäº›æ–‡ä»¶å‘ç”Ÿå†²çª</p>
</li>
<li>
<p>åˆå¹¶å†²çªæ—¶ï¼Œæ–‡ä»¶ä¸­ä¼šå‡ºç°Â <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</code>ï¼ˆå½“å‰åˆ†æ”¯å†…å®¹ï¼‰ã€<code>=======</code>ã€<code>&gt;&gt;&gt;&gt;&gt;&gt;&gt; åˆ†æ”¯å</code>ï¼ˆå¾…åˆå¹¶åˆ†æ”¯å†…å®¹ï¼‰æ ‡è®°</p>
</li>
<li>
<p>æ‰‹åŠ¨ç¼–è¾‘å†²çªæ–‡ä»¶ï¼Œä¿ç•™éœ€è¦çš„ä»£ç å¹¶åˆ é™¤å†²çªæ ‡è®°</p>
</li>
<li>
<p>æš‚å­˜ä¿®æ”¹ï¼š<code>git add .</code></p>
</li>
<li>
<p>å®Œæˆåˆå¹¶ï¼š<code>git commit -m "merge: åˆå¹¶ç™»å½•åŠŸèƒ½åˆ†æ”¯ï¼Œè§£å†³å†²çª"</code></p>
</li>
</ol>
<h3 data-id="heading-22">ä¸ƒã€stash ä¸´æ—¶ä¿å­˜å·¥ä½œåŒº</h3>
<h4 data-id="heading-23">7.1 æ ¸å¿ƒå‘½ä»¤</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸´æ—¶ä¿å­˜å·¥ä½œåŒºä¿®æ”¹ï¼ˆå¯æ·»åŠ å¤‡æ³¨ï¼‰</span>
git stash save <span class="hljs-string">"å¤‡æ³¨ä¿¡æ¯"</span>
<span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰ stash è®°å½•</span>
git stash list
<span class="hljs-comment"># æ¢å¤æœ€è¿‘ä¸€æ¬¡ stash ä¸”ä¿ç•™è®°å½•</span>
git stash apply

<span class="hljs-comment"># å¯ä»¥å­˜å¤šæ¬¡</span>
<span class="hljs-comment"># æ¢å¤æŒ‡å®š stash ä¸”ä¿ç•™è®°å½•</span>
git stash apply stash@{n}
<span class="hljs-comment"># æ¢å¤æœ€è¿‘ä¸€æ¬¡ stash å¹¶åˆ é™¤è®°å½•</span>
git stash pop
<span class="hljs-comment"># åˆ é™¤æœ€è¿‘ä¸€æ¬¡ stash è®°å½•</span>
git stash drop
<span class="hljs-comment"># åˆ é™¤æ‰€æœ‰ stash è®°å½•</span>
git stash clear
</code></pre>
<h4 data-id="heading-24">7.2 ä½¿ç”¨åœºæ™¯</h4>
<ul>
<li>åˆ‡æ¢åˆ†æ”¯å‰ï¼Œä¿å­˜å½“å‰æœªæäº¤çš„ä¿®æ”¹ï¼Œé¿å…åˆ†æ”¯åˆ‡æ¢å†²çª</li>
<li>ä¸´æ—¶æ‹‰å–è¿œç¨‹æœ€æ–°ä»£ç ï¼Œä¸å½±å“æœ¬åœ°æ­£åœ¨å¼€å‘çš„å†…å®¹</li>
</ul>
<h3 data-id="heading-25">å…«ã€git rebase -i äº¤äº’å¼å˜åŸº</h3>
<h4 data-id="heading-26">8.1 æ ¸å¿ƒåŠŸèƒ½ï¼ˆä¼˜åŒ–æäº¤å†å²ï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ“ä½œæœ€è¿‘ n ä¸ªæäº¤ï¼ˆn ä¸ºå…·ä½“æ•°å­—ï¼‰</span>
git rebase -i HEAD~n
</code></pre>
<ul>
<li><strong>å‹ç¼©æäº¤ï¼šå°†å¤šä¸ªæäº¤åˆå¹¶ä¸ºä¸€ä¸ª</strong>ï¼ŒæŠŠè¡Œé¦–Â <code>pick</code>Â æ”¹ä¸ºÂ <code>squash</code>Â æˆ–Â <code>s</code></li>
<li>ç¼–è¾‘æäº¤ï¼šä¿®æ”¹å†å²æäº¤çš„ä¿¡æ¯ / å†…å®¹ï¼ŒæŠŠè¡Œé¦–Â <code>pick</code>Â æ”¹ä¸ºÂ <code>edit</code>Â æˆ–Â <code>e</code>ï¼Œä¿®æ”¹åæ‰§è¡ŒÂ <code>git commit --amend</code>Â å’ŒÂ <code>git rebase --continue</code></li>
<li>åˆ é™¤æäº¤ï¼šç§»é™¤ä¸éœ€è¦çš„å†å²æäº¤ï¼Œåˆ é™¤å¯¹åº”è¡Œæˆ–æŠŠÂ <code>pick</code>Â æ”¹ä¸ºÂ <code>drop</code>Â æˆ–Â <code>d</code></li>
<li>è°ƒæ•´é¡ºåºï¼šç›´æ¥æ‹–åŠ¨æäº¤è¡Œè°ƒæ•´é¡ºåºï¼Œä¿å­˜å Git æŒ‰æ–°é¡ºåºæ‰§è¡Œ</li>
</ul>
<h4 data-id="heading-27">8.2 æ³¨æ„äº‹é¡¹</h4>
<ul>
<li><strong>ä¼˜åŠ¿ï¼šç”Ÿæˆçº¿æ€§æäº¤å†å²ï¼Œæ¯” merge æ›´æ˜“è¿½è¸ª</strong></li>
<li><strong>ç¦å¿Œï¼šä¸è¦å¯¹å·²æ¨é€åˆ°è¿œç¨‹ä»“åº“çš„æäº¤æ‰§è¡Œå˜åŸº</strong></li>
</ul>
<h3 data-id="heading-28">ä¹ã€è¿œç¨‹ä»“åº“åä½œ</h3>
<h4 data-id="heading-29">9.1 è¿œç¨‹ä»“åº“ç®¡ç†</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹å·²é…ç½®çš„è¿œç¨‹ä»“åº“</span>
git remote
<span class="hljs-comment"># æŸ¥çœ‹è¿œç¨‹ä»“åº“è¯¦ç»†ä¿¡æ¯ï¼ˆåŒ…å«URLï¼‰</span>
git remote -v
<span class="hljs-comment"># æ·»åŠ è¿œç¨‹ä»“åº“ï¼ˆé€šå¸¸å‘½åä¸º originï¼‰</span>
git remote add è¿œç¨‹å URL
<span class="hljs-comment"># é‡å‘½åè¿œç¨‹ä»“åº“</span>
git remote rename &lt;æ—§åˆ«å&gt; &lt;æ–°åˆ«å&gt;
<span class="hljs-comment"># ä¿®æ”¹è¿œç¨‹ä»“åº“URL</span>
git remote set-url æ–°URL
<span class="hljs-comment"># åˆ é™¤è¿œç¨‹ä»“åº“</span>
git remote <span class="hljs-built_in">rm</span> è¿œç¨‹å
</code></pre>
<h4 data-id="heading-30">9.2 æ‹‰å–ä¸æ¨é€</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä»è¿œç¨‹ä»“åº“æ‹‰å–æœ€æ–°ä»£ç ï¼ˆä¸è‡ªåŠ¨åˆå¹¶ï¼‰</span>
git fetch origin main
<span class="hljs-comment"># æ‹‰å–å¹¶åˆå¹¶è¿œç¨‹åˆ†æ”¯åˆ°æœ¬åœ°å½“å‰åˆ†æ”¯ï¼ˆå¸¸ç”¨ï¼‰</span>
git pull origin main

<span class="hljs-comment"># é¦–æ¬¡æ¨é€åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ï¼ˆè®¾ç½®ä¸Šæ¸¸åˆ†æ”¯ï¼‰</span>
git push -u è¿œç¨‹å åˆ†æ”¯å
<span class="hljs-comment"># åç»­æ¨é€å·²å…³è”çš„åˆ†æ”¯</span>
git push

<span class="hljs-comment"># æ¨é€æœ¬åœ°æ‰€æœ‰åˆ†æ”¯åˆ°è¿œç¨‹</span>
git push --all origin
<span class="hljs-comment"># æ‹‰å–è¿œç¨‹åˆ†æ”¯å¹¶åˆ›å»ºæœ¬åœ°åˆ†æ”¯</span>
git checkout -b &lt;æœ¬åœ°åˆ†æ”¯å&gt; &lt;è¿œç¨‹åˆ«å&gt;/&lt;è¿œç¨‹åˆ†æ”¯å&gt;
</code></pre>
<h3 data-id="heading-31">åã€.gitignore è¯­æ³•ä¸é…ç½®</h3>
<h4 data-id="heading-32">10.1 åŸºç¡€è¯­æ³•è§„åˆ™</h4>
<ul>
<li>
<p>æ³¨é‡Šè¡Œï¼šä»¥Â <code>#</code>Â å¼€å¤´</p>
</li>
<li>
<p>åŒ¹é…å•ä¸ªæ–‡ä»¶ï¼šç›´æ¥å†™æ–‡ä»¶åï¼Œå¦‚Â <code>test.txt</code></p>
</li>
<li>
<p>åŒ¹é…ç›®å½•ï¼šä»¥Â <code>/</code>Â ç»“å°¾ï¼Œå¦‚Â <code>logs/</code></p>
</li>
<li>
<p>é€šé…ç¬¦åŒ¹é…ï¼š</p>
<ul>
<li>
<p><code>*</code>ï¼šåŒ¹é…ä»»æ„å¤šä¸ªå­—ç¬¦ï¼Œå¦‚Â <code>*.log</code>ï¼ˆæ‰€æœ‰ log æ–‡ä»¶ï¼‰</p>
</li>
<li>
<p><code>**</code>ï¼šé€’å½’é€šé…ç¬¦ï¼Œå¦‚Â <code>**/log/</code>ï¼ˆæ‰€æœ‰ log ç›®å½•ï¼‰</p>
</li>
<li>
<p><code>?</code>ï¼šåŒ¹é…å•ä¸ªå­—ç¬¦ï¼Œå¦‚Â <code>file?.txt</code>ï¼ˆfile1.txtã€file2.txt ç­‰ï¼‰</p>
</li>
<li>
<p><code>[]</code>ï¼šåŒ¹é…æ‹¬å·å†…ä»»æ„<strong>ä¸€ä¸ª</strong>å­—ç¬¦ï¼Œå¦‚Â <code>file[12].txt</code></p>
</li>
</ul>
</li>
<li>
<p>åå‘åŒ¹é…ï¼šä»¥Â <code>!</code>Â å¼€å¤´ï¼Œè¡¨ç¤ºä¸å¿½ç•¥è¯¥æ–‡ä»¶ / ç›®å½•ï¼Œå¦‚Â <code>!important.log</code></p>
</li>
</ul>
<h4 data-id="heading-33">10.2 .gitignore ç¤ºä¾‹</h4>
<pre><code class="hljs language-plaintext" lang="plaintext"># å¿½ç•¥æ‰€æœ‰ .log æ–‡ä»¶
*.log
# å¿½ç•¥ node_modules ç›®å½•
node_modules/
# å¿½ç•¥ dist æ„å»ºç›®å½•
dist/
# å¿½ç•¥ç‰¹å®šæ–‡ä»¶
.env
.DS_Storeï¼ˆmacOSç³»ç»Ÿæ–‡ä»¶ï¼‰
Thumbs.dbï¼ˆWindowsç³»ç»Ÿæ–‡ä»¶ï¼‰
</code></pre>
<h3 data-id="heading-34">åä¸€ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h3>
<h4 data-id="heading-35">11.1 .gitignore ç›¸å…³é—®é¢˜</h4>
<ul>
<li>
<p>é—®é¢˜ 1ï¼šå·²æäº¤åˆ°ä»“åº“çš„æ–‡ä»¶ï¼Œæ·»åŠ åˆ° .gitignore åä¸ç”Ÿæ•ˆè§£å†³æ–¹æ¡ˆï¼šæ¸…é™¤æ–‡ä»¶ç¼“å­˜å¹¶é‡æ–°æäº¤</p>
<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">rm</span> --cached &lt;æ–‡ä»¶å&gt;
git commit -m <span class="hljs-string">"åœæ­¢è·Ÿè¸ªæŸæ–‡ä»¶"</span>
</code></pre>
</li>
<li>
<p>é—®é¢˜ 2ï¼šéœ€è¦å±€éƒ¨é…ç½® .gitignoreï¼Œä¸å½±å“å›¢é˜Ÿå…±äº«é…ç½®è§£å†³æ–¹æ¡ˆï¼šåœ¨Â <code>.git/info/exclude</code>Â æ–‡ä»¶ä¸­æ·»åŠ å¿½ç•¥è§„åˆ™ï¼Œä»…å¯¹å½“å‰æœ¬åœ°ä»“åº“æœ‰æ•ˆ</p>
</li>
<li>
<p>é—®é¢˜ 3ï¼šå¿½ç•¥è§„åˆ™ä¸ç”Ÿæ•ˆè§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥è§„åˆ™è¯­æ³•ï¼Œæˆ–æ‰§è¡ŒÂ <code>git rm --cached &lt;æ–‡ä»¶å&gt;</code>Â æ¸…é™¤ç¼“å­˜</p>
</li>
</ul>
<h4 data-id="heading-36">11.2 å¿˜è®°æäº¤å°±åˆ‡æ¢åˆ†æ”¯</h4>
<p>é—®é¢˜ï¼šå·¥ä½œåŒºæœ‰æœªæäº¤ä¿®æ”¹ï¼Œåˆ‡æ¢åˆ†æ”¯æ—¶æç¤ºÂ <code>error: Your local changes would be overwritten by checkout</code>è§£å†³æ–¹æ³•ï¼š</p>
<ul>
<li>æ–¹æ¡ˆ 1ï¼šæäº¤ä¿®æ”¹ååˆ‡æ¢åˆ†æ”¯ï¼š<code>git add .</code>Â â†’Â <code>git commit -m "temp: ä¸´æ—¶æäº¤"</code>Â â†’Â <code>git checkout ç›®æ ‡åˆ†æ”¯</code></li>
<li>æ–¹æ¡ˆ 2ï¼šç”¨ stash æš‚å­˜ï¼š<code>git stash</code>Â â†’ åˆ‡æ¢åˆ†æ”¯å®Œæˆæ“ä½œ â†’ åˆ‡å›åŸåˆ†æ”¯ â†’Â <code>git stash pop</code>ï¼ˆæ¢å¤ä¿®æ”¹ï¼‰</li>
</ul>
<h4 data-id="heading-37">11.3 è¯¯åˆ æœ¬åœ°åˆ†æ”¯</h4>
<p>é—®é¢˜ï¼šä¸å°å¿ƒåˆ é™¤äº†æœªåˆå¹¶çš„æœ¬åœ°åˆ†æ”¯è§£å†³æ–¹æ³•ï¼š</p>
<ol>
<li>æ‰§è¡ŒÂ <code>git reflog</code>Â æŸ¥çœ‹æ“ä½œè®°å½•ï¼Œæ‰¾åˆ°åˆ é™¤åˆ†æ”¯çš„æœ€åä¸€æ¬¡æäº¤ ID</li>
<li>æ¢å¤åˆ†æ”¯ï¼š<code>git checkout -b æ¢å¤çš„åˆ†æ”¯å &lt;commit-id&gt;</code></li>
</ol>
<h4 data-id="heading-38">11.4 å…¶ä»–æ³¨æ„äº‹é¡¹</h4>
<ul>
<li><code>git reset --hard</code>Â æ…ç”¨ï¼Œä¼šå½»åº•ä¸¢å¤±æœªæäº¤çš„å·¥ä½œåŒºä¿®æ”¹</li>
<li>ä¸è¦å¯¹å·²æ¨é€è‡³è¿œç¨‹çš„æäº¤æ‰§è¡ŒÂ <code>rebase</code>ï¼Œé¿å…å½±å“å›¢é˜Ÿåä½œ</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆè¯†iFlow CLI]]></title>    <link>https://juejin.cn/post/7582919147640668212</link>    <guid>https://juejin.cn/post/7582919147640668212</guid>    <pubDate>2025-12-14T03:31:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582919147640668212" data-draft-id="7580592190020157474" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆè¯†iFlow CLI"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2025-12-14T03:31:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°æºªå½¼å²¸"/> <meta itemprop="url" content="https://juejin.cn/user/976781670357400"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆè¯†iFlow CLI
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/976781670357400/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°æºªå½¼å²¸
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T03:31:20.000Z" title="Sun Dec 14 2025 03:31:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å°ä¼™ä¼´ä»¬å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å°æºªï¼Œè§å­—å¦‚é¢ã€‚åˆæ¬¡å¬è¯´iFlowè¿˜æ˜¯åœ¨ä½¿ç”¨ Claude Code Routeræ—¶ï¼Œä¾ç¨€è®°å¾—å½“æ—¶ä½œè€…åœ¨æ–‡æ¡£ä¸Šçš„æ ‡æ³¨æ˜¯å½“å‰ç‰ˆæœ¬æ¯”è¾ƒä¾èµ–iFlowï¼Œé€šè¿‡iFlowå®˜ç½‘å¾—çŸ¥iFlowä¹Ÿæä¾›äº†CLIï¼Œè¿™æ¬¡æœ‰æ—¶é—´ç‰¹æ¥ä½“éªŒä¸€ä¸‹ã€‚å¯¹å…¶ä»–CLIæ„Ÿå…´è¶£çš„å°ä¼™ä¼´ä¹Ÿå¯ä»¥çœ‹å¾€æœŸå†…å®¹ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzU5Njg3ODUzOA%3D%3D%26mid%3D2247492929%26idx%3D1%26sn%3D043e21a18f31f1c4c68bf4ee63e28685%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzU5Njg3ODUzOA==&amp;mid=2247492929&amp;idx=1&amp;sn=043e21a18f31f1c4c68bf4ee63e28685&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">Claude Code CLIåˆä½“éªŒ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzU5Njg3ODUzOA%3D%3D%26mid%3D2247493426%26idx%3D1%26sn%3D4e0b83c872d1e23af8fc8de2708e0bda%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzU5Njg3ODUzOA==&amp;mid=2247493426&amp;idx=1&amp;sn=4e0b83c872d1e23af8fc8de2708e0bda&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">Codex CLIåˆä½“éªŒ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzU5Njg3ODUzOA%3D%3D%26mid%3D2247492558%26idx%3D1%26sn%3De762047c93c4361f63744ec3c70a434f%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzU5Njg3ODUzOA==&amp;mid=2247492558&amp;idx=1&amp;sn=e762047c93c4361f63744ec3c70a434f&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">Googleç™¾ä¸‡Tokenä¸Šä¸‹æ–‡Gemini CLIï¼Œç¦»AIè‡ªç”±æ›´è¿‘ä¸€æ­¥</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzU5Njg3ODUzOA%3D%3D%26mid%3D2247494083%26idx%3D1%26sn%3D7b64164277b9494ce2e8e42e6e9f403b%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzU5Njg3ODUzOA==&amp;mid=2247494083&amp;idx=1&amp;sn=7b64164277b9494ce2e8e42e6e9f403b&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">åˆè¯†Qwen Code CLI</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzU5Njg3ODUzOA%3D%3D%26mid%3D2247493377%26idx%3D1%26sn%3Dda5a37dc7f023881c0e22342caff11e1%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzU5Njg3ODUzOA==&amp;mid=2247493377&amp;idx=1&amp;sn=da5a37dc7f023881c0e22342caff11e1&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">è…¾è®¯å‘å¸ƒCodeBuddy Code CLIå¹³æ›¿Claude Code?</a></li>
</ul>
<h2 data-id="heading-1">å½“å‰ä½¿ç”¨ç‰ˆæœ¬</h2>
<p>iflow cli 0.3.28</p>
<h2 data-id="heading-2">ä¼˜åŠ¿</h2>
<ul>
<li>å®Œå…¨å…è´¹ä½¿ç”¨</li>
<li>æä¾›å›½å†…ä¸»æµæ¨¡å‹è°ƒç”¨</li>
</ul>
<h2 data-id="heading-3">é™åˆ¶</h2>
<ul>
<li>Node.js 20+</li>
<li>æ— æ³•å®Œå…¨ä½¿ç”¨å¿ƒæµå¼€å‘å¹³å°æ‰€æœ‰æ¨¡å‹</li>
</ul>
<h2 data-id="heading-4">å®˜ç½‘</h2>
<p>iFlow CLI æ˜¯ä¸€æ¬¾ç»ˆç«¯AIåŠ©æ‰‹ï¼Œå¯ä»¥åˆ†æä»£ç ã€æ‰§è¡Œç¼–ç¨‹ä»»åŠ¡ã€å¤„ç†æ–‡ä»¶æ“ä½œã€‚æœ¬æŒ‡å—å¸®æ‚¨å¿«é€Ÿä¸Šæ‰‹æ ¸å¿ƒåŠŸèƒ½ã€‚</p>
<p>å®˜ç½‘å¼€æ”¾å¹³å°åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.iflow.cn" target="_blank" title="https://platform.iflow.cn" ref="nofollow noopener noreferrer">platform.iflow.cn</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/23db6ff7c2c54e09aafcb7fcfe548b57~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=miTPpXIFVqozuAjRdUPJIdh0rlk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å®˜ç½‘CLIåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fcli.iflow.cn" target="_blank" title="https://cli.iflow.cn" ref="nofollow noopener noreferrer">cli.iflow.cn</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5195916a4bfa492caef0a41c31738cee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=Oa%2BT%2BaKszFrlrNF%2B3a%2BZz%2FjEUtI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-5">å®‰è£…é…ç½®</h2>
<p>macOS/Linux</p>
<pre><code class="hljs language-less" lang="less">#Â ä¸€é”®å®‰è£…è„šæœ¬ï¼Œä¼šå®‰è£…å…¨éƒ¨æ‰€éœ€ä¾èµ–
$Â <span class="hljs-selector-tag">bash</span> <span class="hljs-selector-tag">-c</span>Â "$(curl -fsSL <span class="hljs-attribute">https</span>:<span class="hljs-comment">//gitee.com/iflow-ai/iflow-cli/raw/main/install.sh)"</span>
#Â å·²æœ‰Node.js <span class="hljs-number">20</span>+
$Â npm i -g <span class="hljs-variable">@iflow-ai</span>/iflow-cli<span class="hljs-variable">@latest</span>
#Â æ›´æ–°
$Â npm i -g <span class="hljs-variable">@iflow-ai</span>/iflow-cli<span class="hljs-variable">@latest</span>
</code></pre>
<p>Windows</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-variable">$Â </span>npm install -g <span class="hljs-variable">@iflow</span>-ai/iflow-cli<span class="hljs-variable">@latest</span>
</code></pre>
<p>å®‰è£…å®Œæˆåï¼Œåœ¨å‘½ä»¤è¡Œç»ˆç«¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¯ä»¥è¾“å‡ºç‰ˆæœ¬å·è¡¨ç¤ºå®‰è£…æˆåŠŸ</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$Â iflow</span> -v
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4464c7fe24ee4e1b9da3750c27413eff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=Uq6EGxcux9LAd4moMXa6mOD9%2Fbg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-6">ç”³è¯·API Key</h2>
<blockquote>
<p>ç”¨äºÂ å¿ƒæµAPI Keyã€OpenAI Compatible APIÂ åŠÂ å…¶ä»–AIå·¥å…·Â ç™»å½•æ–¹å¼</p>
</blockquote>
<p>åœ¨å¿ƒæµå¼€å‘å¹³å°ç‚¹å‡»å¤´åƒï¼Œåœ¨ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©ã€API Keyç®¡ç†ã€‘</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a5bac696e6f4fbca7ff53726b944950~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=nEgtfHcx8TbCeRIbYzDACb1ZlsU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç‚¹å‡»ã€æ’ä»¶APIå¯†é’¥ã€‘åˆ›å»ºä¸€ä¸ªæ–°çš„API Keyï¼Œç‚¹å‡»ã€åŒæ„åè®®å¹¶ç”Ÿæˆã€‘åˆ›å»º</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b7d900b5a8554b4b96b965ab4543fb97~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=YMEjFhD%2FAaR3oHFlqeQZkxeq0vs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åˆ›å»ºå®Œæˆåå³å¯åœ¨API Keyç®¡ç†åˆ—è¡¨æŸ¥çœ‹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8257a6021a9c42d491191eb73991b9a1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=%2BCax4MNvWjTtwXUXN0BV3sRJg8E%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-7">ç™»å½•æˆæƒ</h2>
<p>åœ¨å‘½ä»¤è¡Œç»ˆç«¯è¾“å…¥ iflow å¯åŠ¨ iFlow CLIï¼Œçœ‹åˆ°å¯åŠ¨ç•Œé¢ç»†å¿ƒçš„å°ä¼™ä¼´å¯èƒ½å·²ç»å‘ç°äº†ï¼Œè¿™ä¸ªç•Œé¢å’ŒGemini CLIæœ‰ç‚¹åƒå“¦ğŸ˜‚ï¼ˆä¸è¦æ€€ç–‘è‡ªå·±çš„çœ¼ç›ï¼Œå¤šåŠæ˜¯é­”æ”¹äº†ï¼‰</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0918b87a33294e069e103e99e70b8e23~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=ermInfJOKq%2FJE3ZK5NDpTeWU2cM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>iFlow CLI æ”¯æŒ Login with iFlowã€Login with iFlow ApiKeyã€OpenAI Compatible API 3ç§ç™»å½•æ–¹å¼ï¼Œä¸åŒæ–¹å¼æä¾›çš„åŠŸèƒ½æœ‰æ‰€å·®å¼‚</p>
<h3 data-id="heading-8">Login with iFlow ç™»å½•ï¼ˆæ¨èï¼‰</h3>
<blockquote>
<p>å¼ºçƒˆæ¨èä½¿ç”¨ Login with iFlow æ–¹å¼ç™»å½•å¿ƒæµå¹³å°ï¼Œäº«å—æœ€å®Œæ•´çš„åŠŸèƒ½ä½“éªŒï¼Œä»¤ç‰Œè‡ªåŠ¨åˆ·æ–°ï¼Œæ°¸ä¸è¿‡æœŸ</p>
</blockquote>
<p>å®Œæ•´åŠŸèƒ½æ”¯æŒï¼š</p>
<ul>
<li>WebSearch æœåŠ¡ï¼šæ™ºèƒ½ç½‘ç»œæœç´¢ï¼Œè·å–æœ€æ–°ä¿¡æ¯</li>
<li>WebFetch æœåŠ¡ï¼šç½‘é¡µå†…å®¹æŠ“å–å’Œåˆ†æ</li>
<li>å¤šæ¨¡æ€èƒ½åŠ›ï¼šå†…ç½®å›¾åƒç†è§£ç­‰å¤šæ¨¡æ€åŠŸèƒ½</li>
<li>å·¥å…·è°ƒç”¨ä¼˜åŒ–ï¼šå¿ƒæµå¹³å°æä¾›çš„æ¨¡å‹ç»è¿‡ä¸“é—¨ä¼˜åŒ–ï¼Œå·¥å…·è°ƒç”¨æ›´åŠ ç²¾å‡†é«˜æ•ˆ</li>
</ul>
<p>é€‰æ‹©ã€Login with iFlowã€‘ï¼Œåœ¨å®˜ç½‘æˆæƒ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f7f6ef12310490aad7f81505de40e3a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=l3bKck9PIUbvt1wpikxW%2F%2BeKxFY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e20bd670ab3c4eb0bb4dc1e488e31c06~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=ZK3cHlh2jl7N0VlEj4m9%2B6r%2B81Q%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-9">å¿ƒæµ API Key ç™»å½•</h3>
<blockquote>
<p>API Key æœ‰æ•ˆæœŸä¸º 7 å¤©ï¼Œéœ€å®šæœŸæ›´æ–°</p>
</blockquote>
<p>å®Œæ•´åŠŸèƒ½æ”¯æŒï¼š</p>
<ul>
<li>WebSearch æœåŠ¡ï¼šæ™ºèƒ½ç½‘ç»œæœç´¢ï¼Œè·å–æœ€æ–°ä¿¡æ¯</li>
<li>WebFetch æœåŠ¡ï¼šç½‘é¡µå†…å®¹æŠ“å–å’Œåˆ†æ</li>
<li>å¤šæ¨¡æ€èƒ½åŠ›ï¼šå†…ç½®å›¾åƒç†è§£ç­‰å¤šæ¨¡æ€åŠŸèƒ½</li>
<li>å·¥å…·è°ƒç”¨ä¼˜åŒ–ï¼šå¿ƒæµå¹³å°æä¾›çš„æ¨¡å‹ç»è¿‡ä¸“é—¨ä¼˜åŒ–ï¼Œå·¥å…·è°ƒç”¨æ›´åŠ ç²¾å‡†é«˜æ•ˆ</li>
</ul>
<p>åœ¨äº¤äº’å¼å‘½ä»¤ä¸­è¾“å…¥ /authï¼Œé€‰æ‹©ã€Login with iFlow ApiKeyã€‘</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a70b8cfdb4d348a4bf43633d40d60414~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=QNlgUNUabAoOnrm83M9hUBuFY9k%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¾“å…¥å¿ƒæµå¼€æ”¾å¹³å°API Key</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc8d84692e1544bf92505acbaf9c449d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=jTnSidC7Zza5KiEBWVP3yy0FEYs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¹Ÿå¯ä»¥åœ¨AIåŠ©æ‰‹ä¸­ä½¿ç”¨ï¼ŒiFlowç›®å‰æ²¡æœ‰é€‚é…Claude Code CLIï¼Œç›´æ¥ä½¿ç”¨ä¼šæŠ¥é”™</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8dfaac6cd7b24b08ae4f933f16552bef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=FGIaGd%2BT7psvPduPD0qigwducDQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æƒ³åœ¨Claude Code CLIä¸­ä½¿ç”¨éœ€è¦å€ŸåŠ©Claude Code Routerå·¥å…·ï¼Œå¯¹Claude Code Routerè¿˜ä¸äº†è§£çš„å°ä¼™ä¼´å¯ä»¥çœ‹å¾€æœŸå†…å®¹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzU5Njg3ODUzOA%3D%3D%26mid%3D2247493062%26idx%3D1%26sn%3D23bf774d1aef130d687887222bf78483%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzU5Njg3ODUzOA==&amp;mid=2247493062&amp;idx=1&amp;sn=23bf774d1aef130d687887222bf78483&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">ä½¿ç”¨Claude Code Routerè½»æ¾åˆ‡æ¢å„ç§é«˜æ€§ä»·æ¯”æ¨¡å‹</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9a58373d59c4d158262e9764b8f3728~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=iIdH57fJYBGo3HZp8eBlcdoOCbs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é…ç½®å®Œåå°±å¯ä»¥ç›´æ¥ä½¿ç”¨äº†</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f72690a54027475ea7e3f6eb8c9681fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=ag5ILNfj8Yu2o%2BsaGHa34EwSS64%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-10">OpenAI Compatible API</h3>
<blockquote>
<p>é€‚ç”¨äºä½¿ç”¨è‡ªæœ‰æ¨¡å‹æœåŠ¡æˆ–å…¶ä»–å…¼å®¹ OpenAI åè®®çš„æœåŠ¡</p>
</blockquote>
<p>åŠŸèƒ½é™åˆ¶ï¼š</p>
<ul>
<li>ä¸æ”¯æŒ WebSearch æœåŠ¡</li>
<li>ä¸æ”¯æŒ WebFetch æœåŠ¡</li>
<li>ä¸æ”¯æŒå¿ƒæµå¹³å°çš„å†…ç½®å¤šæ¨¡æ€èƒ½åŠ›</li>
<li>æ— æ³•äº«å—å¿ƒæµå¹³å°æ¨¡å‹çš„å·¥å…·è°ƒç”¨ä¼˜åŒ–</li>
</ul>
<p>åœ¨äº¤äº’å¼å‘½ä»¤ä¸­è¾“å…¥ /authï¼Œé€‰æ‹©ã€OpenAI Compatible APIã€‘</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c66ca359448740219583b1052fc024eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=4kaNk%2BTDDf2Gk3uhL2mb89YOqF0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¾“å…¥ OpenAi Base URLã€API Key å’Œ æ¨¡å‹åç§°</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ae31a8b72ab40fcae5c094cb3dc5f63~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=wd04N3442CQAlWx1mIs52jd7tv4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bcc780321e4648f9b9b53f371eb4974c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=ODvUsXCK8Fg6tBOjjqYuxH4NnFQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd9d0ba807594a3d8db54c183094cdff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=4r0NVnUvmORXRHDvV%2FsAbnVnsfA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-11">åŸºæœ¬ä½¿ç”¨</h2>
<h3 data-id="heading-12">å‘½ä»¤è¡Œå‚æ•°</h3>
<p>åœ¨å‘½ä»¤è¡Œç»ˆç«¯è¾“å…¥ iflow -h å¯ä»¥æŸ¥çœ‹iFlow CLIæä¾›çš„æ‰€æœ‰å‘½ä»¤è¡ŒæŒ‡ä»¤</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b4b60b37e6324abd893187b5d7b33ad2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=w3o4YJ55METaXvNV41x25WB6OqM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>iflowï¼šå¯åŠ¨iFlow CLIï¼Œç¤ºä¾‹ï¼šiflow [query]</li>
<li>iflow mcpï¼šç®¡ç†MCPæœåŠ¡ï¼Œç¤ºä¾‹ï¼šiflow mcp list</li>
<li>iflow commandsï¼šç®¡ç†å¸‚åœºå‘½ä»¤ï¼Œç¤ºä¾‹ï¼šiflow commands list</li>
<li>iflow agentï¼šç®¡ç†å­ä»£ç†ï¼Œç¤ºä¾‹ï¼šiflow agent list</li>
<li>iflow workflowï¼šå·¥ä½œæµç®¡ç†</li>
</ul>
<h3 data-id="heading-13">äº¤äº’å¼å‘½ä»¤</h3>
<p>åœ¨äº¤äº’å¼å‘½ä»¤è¾“å…¥ / å¯ä»¥æŸ¥çœ‹ç»ˆç«¯å‘½ä»¤ä¿¡æ¯ï¼ŒåŸºæœ¬å’ŒGemini CLIä¸€è‡´ï¼Œè¿™é‡Œåªä»‹ç»æœ‰åŒºåˆ«çš„ï¼Œå…¶ä»–çš„å‚è€ƒå¾€æœŸï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzU5Njg3ODUzOA%3D%3D%26mid%3D2247492558%26idx%3D1%26sn%3De762047c93c4361f63744ec3c70a434f%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzU5Njg3ODUzOA==&amp;mid=2247492558&amp;idx=1&amp;sn=e762047c93c4361f63744ec3c70a434f&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">Googleç™¾ä¸‡Tokenä¸Šä¸‹æ–‡Gemini CLIï¼Œç¦»AIè‡ªç”±æ›´è¿‘ä¸€æ­¥</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1031dce8cb784846994a5942998c8b15~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=LAyKhnHovvSlqn3%2FBaIa4WieufA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>/agentsï¼šä»£ç†ç®¡ç†
<ul>
<li>installï¼šå®‰è£…å…·æœ‰å¼•å¯¼è®¾ç½®çš„æ–°ä»£ç†</li>
<li>listï¼šæŸ¥çœ‹æ‰€æœ‰å¯ç”¨ä»£ç†</li>
<li>onlineï¼šæµè§ˆå¹¶å®‰è£…æ¥è‡ªåœ¨çº¿ä»“åº“çš„ä»£ç†</li>
<li>refreshï¼šæ›´æ–°æºæ–‡ä»¶ä¸­çš„ä»£ç†</li>
</ul>
</li>
<li>/authï¼šåˆ‡æ¢æˆæƒæ–¹å¼</li>
<li>/cleanup-checkpointï¼šæ¸…é™¤æ‰€æœ‰æ£€æŸ¥ç‚¹å†å²è®°å½•å¹¶é‡Šæ”¾ç£ç›˜</li>
<li>/cleanup-historyï¼šæ¸…é™¤å½“å‰é¡¹ç›®çš„å¯¹è¯å†å²è®°å½•å¹¶é‡Šæ”¾ç£ç›˜ç©ºé—´</li>
<li>/commandsï¼šç®¡ç†å¸‚åœºå‘½ä»¤
<ul>
<li>addï¼šæ·»åŠ å‘½ä»¤</li>
<li>getï¼šæŸ¥çœ‹å‘½ä»¤è¯¦æƒ…</li>
<li>listï¼šå‘½ä»¤åˆ—è¡¨</li>
<li>onlineï¼šåœ¨äº¤äº’å¼å¯¹è¯æ¡†ä¸­æµè§ˆåœ¨çº¿å¸‚åœºçš„å¯ç”¨å‘½ä»¤</li>
<li>removeï¼šç§»é™¤æœ¬åœ°å®‰è£…çš„å‘½ä»¤</li>
</ul>
</li>
<li>/demoï¼šç”¨äºç ”ç©¶å’Œå¤´è„‘é£æš´çš„äº’åŠ¨ä»»åŠ¡</li>
<li>/directoryï¼šç®¡ç†å·¥ä½œåŒºç›®å½•</li>
<li>/exportï¼šå¯¼å‡ºå¯¹è¯å†å²</li>
<li>/initï¼šåˆ†æé¡¹ç›®å¹¶ç”Ÿæˆå®šåˆ¶çš„ IFLOW.md æ–‡ä»¶</li>
<li>/languageï¼šåˆ‡æ¢è¯­è¨€</li>
<li>/logï¼šæŸ¥çœ‹ä¼šè¯æ—¥å¿—</li>
<li>/mcpï¼šMCPç®¡ç†
<ul>
<li>authï¼šMCPæˆæƒ</li>
<li>listï¼šåˆ—å‡ºå·²é…ç½®çš„ MCP æœåŠ¡å™¨å’Œå·¥å…·</li>
<li>onlineï¼šä»åœ¨çº¿å­˜å‚¨åº“æµè§ˆå’Œå®‰è£… MCP æœåŠ¡å™¨</li>
<li>refreshï¼šåˆ·æ–° MCP æœåŠ¡å™¨å’Œå·¥å…·åˆ—è¡¨ï¼Œå¹¶é‡æ–°åŠ è½½è®¾ç½®æ–‡ä»¶</li>
</ul>
</li>
<li>/output-styleï¼šæ›´æ”¹è¾“å‡ºé£æ ¼åå¥½ï¼ˆå‚è€ƒäº†claude codeï¼‰</li>
<li>/output-style:newï¼šå¯è§†åŒ–åˆ›å»ºä¸€ä¸ªé£æ ¼åå¥½</li>
<li>/qaï¼šåŸºäºçŸ¥è¯†åº“æ£€ç´¢çš„æ™ºèƒ½é—®ç­”</li>
<li>/updateï¼šæ›´æ–°ç‰ˆæœ¬</li>
</ul>
<h3 data-id="heading-14">æ‰§è¡ŒShell</h3>
<p>å’ŒGemini CLIä¸€æ ·åœ¨äº¤äº’å¼å‘½ä»¤ä¸­è¾“å…¥ ! å¯è¿›å…¥Shellæ¨¡å¼æ‰§è¡ŒShellå‘½ä»¤</p>
<h3 data-id="heading-15">é…ç½®æ–‡ä»¶</h3>
<p>iFlow CLIå»¶ç»­äº†Gemini CLIçš„é…ç½®æ–‡ä»¶ç³»ç»Ÿï¼Œæä¾›äº† .iflow/settings.jsonã€.envã€IFLOW.md ç­‰é…ç½®æ–‡ä»¶ï¼Œæ•´ä½“ä¸Šå’ŒGemini CLIçš„é…ç½®æ–‡ä»¶æ²¡æœ‰å¤ªå¤§å·®å¼‚ã€‚</p>
<h3 data-id="heading-16">å¯¹è¯æ¨¡å¼</h3>
<p>iFlow CLIæä¾›äº† planã€defaultã€accepting editsã€YOLO 4ç§å¯¹è¯æ¨¡å¼ï¼Œä½¿ç”¨ã€Shift+Tabã€‘å¯ä»¥å¿«é€Ÿåˆ‡æ¢</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7a59b645bbe244638e4fb4f338c43144~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=vzdbb3NBogtSQPGW0MrhgGpOXcQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>planï¼šä»…åˆ†æï¼Œä¸ä¿®æ”¹æ–‡ä»¶æˆ–æ‰§è¡Œå‘½ä»¤</li>
<li>defaultï¼šè¦æ±‚å®¡æ‰¹æ–‡ä»¶ç¼–è¾‘æˆ– shell å‘½ä»¤</li>
<li>accepting editsï¼šè‡ªåŠ¨æ‰¹å‡†æ–‡ä»¶ç¼–è¾‘</li>
<li>YOLOï¼šè‡ªåŠ¨æ‰¹å‡†æ‰€æœ‰å·¥å…·</li>
</ul>
<p>å’ŒQwen Code CLIåŠŸèƒ½ç±»ä¼¼ï¼Œè¿™é‡Œå°±ä¸å±•å¼€äº†ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥çœ‹å¾€æœŸå†…å®¹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzU5Njg3ODUzOA%3D%3D%26mid%3D2247494083%26idx%3D1%26sn%3D7b64164277b9494ce2e8e42e6e9f403b%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzU5Njg3ODUzOA==&amp;mid=2247494083&amp;idx=1&amp;sn=7b64164277b9494ce2e8e42e6e9f403b&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">åˆè¯†Qwen Code CLI</a></p>
<h3 data-id="heading-17">æ¨¡å‹åˆ‡æ¢</h3>
<p>iFlow CLIæä¾›äº†æ¨¡å‹åˆ‡æ¢åŠŸèƒ½ï¼Œåœ¨äº¤äº’å¼å‘½ä»¤ä¸­è¾“å…¥ /model å¯ä»¥éšæ—¶åˆ‡æ¢æ¨¡å‹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d11aba2fbbe4827a5f3601f8ac7971a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=XU72rg0Rk%2FpInPcvMvOddT52lCE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-18">è‡ªå®šä¹‰æŒ‡ä»¤</h3>
<p>iFlowæä¾›äº†è‡ªå®šä¹‰æŒ‡ä»¤ä¹Ÿå°±æ˜¯Claude Codeä¸­çš„è‡ªå®šä¹‰å‘½ä»¤ï¼ŒiFlow CLIæä¾›äº†å¤šç§å®‰è£…è‡ªå®šä¹‰æŒ‡ä»¤çš„æ–¹å¼</p>
<h4 data-id="heading-19">1ï¼‰å¿ƒæµæŒ‡ä»¤å¸‚åœºï¼ˆæ¨èï¼‰</h4>
<p>è‡ªå®šä¹‰æŒ‡ä»¤å¸‚åœºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.iflow.cn%2Fagents%3Ftype%3Dcommands%26category%3Dall" target="_blank" title="https://platform.iflow.cn/agents?type=commands&amp;category=all" ref="nofollow noopener noreferrer">platform.iflow.cn/agents?typeâ€¦</a></p>
<p>é€‰æ‹©ä¸€ä¸ªæŒ‡ä»¤ï¼Œç‚¹å‡»ã€å®‰è£…ã€‘è·å–å®‰è£…å‘½ä»¤</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed48e9fa7f9e46a79a1d9032c1430692~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=FLHqLz1AYOmW6As%2FJbL4daLIP1Y%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¤åˆ¶å‘½ä»¤åœ¨å‘½ä»¤è¡Œç»ˆç«¯ä¸€é”®å®‰è£…</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a800ad6b43d4f42a8dfeaaafb9526e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=HRf6JPrHsDeSJoIE5oQdAnIz8Dk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/21386175d21d45ad80be066945733601~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=iqVixkwyRWTKmSoCRRzDyi9NPlQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å®‰è£…å®Œæˆåï¼Œåœ¨å‘½ä»¤è¡Œç»ˆç«¯è¾“å…¥ /iflow commands list å¯ä»¥æŸ¥çœ‹å®‰è£…åˆ—è¡¨</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0be6396b3b4e4944902daa1ad972cc7e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=M22w6sI%2B1TR5C6qOJXDrd4QbeoM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-20">2ï¼‰åœ¨çº¿å®‰è£…</h4>
<p>åœ¨äº¤äº’å¼å‘½ä»¤ä¸­æ‰§è¡Œ /commands online å¯ä»¥åœ¨çº¿æµè§ˆè‡ªå®šä¹‰æŒ‡ä»¤å¸‚åœº</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d397da70462d42c1819cdeaba26fc608~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=PsJ%2FFOBSLPBOS5rpW2J961RBp%2F4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä½¿ç”¨ â†‘â†“ é€‰æ‹©è‡ªå®šä¹‰æŒ‡ä»¤ï¼Œ â†â†’ ç¿»é¡µæŸ¥çœ‹ï¼Œä½¿ç”¨å¯¹åº”çš„æ•°å­—é”®è¿›è¡Œå®‰è£…</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a89d7c55643f480a9f8eeab8cd0a3229~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=lqR9kqxlMup90orD4SJH10SH42Q%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-21">3ï¼‰åˆ›å»ºè‡ªå®šä¹‰æŒ‡ä»¤</h4>
<p>iFlow CLIè‡ªå®šä¹‰æŒ‡ä»¤æ”¯æŒ TOML å’Œ Markdown æ ¼å¼ï¼Œå¥½ç»“åˆäº† Gemini CLIå’ŒClaude Code CLIçš„ç‰¹ç‚¹ï¼Œåˆ›å»ºè‡ªå®šä¹‰æŒ‡ä»¤çš„æ–¹å¼å’Œå…¶ä»–ä¸»æµCLIå·¥å…·ç±»ä¼¼ï¼Œåœ¨å…¨å±€æˆ–è€…é¡¹ç›® iflow/commands ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª my-command.toml æ–‡ä»¶ï¼Œè¾“å…¥å¦‚ä¸‹æç¤ºè¯å³å¯</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å‘½ä»¤æè¿°ï¼ˆå¿…éœ€ï¼‰</span>
<span class="hljs-attr">description</span>Â =Â <span class="hljs-string">"å‘½ä»¤çš„ç®€çŸ­æè¿°"</span>
<span class="hljs-comment"># å‘½ä»¤æç¤ºè¯ï¼ˆå¿…éœ€ï¼‰</span>
<span class="hljs-attr">prompt</span>Â =Â <span class="hljs-string">"""
å‘é€ç»™AIæ¨¡å‹çš„å®Œæ•´æç¤ºè¯å†…å®¹
æ”¯æŒå¤šè¡Œæ–‡æœ¬å’Œç‰¹æ®Šå ä½ç¬¦
"""</span>
</code></pre>
<p>Markdownæ ¼å¼éœ€è¦åˆ›å»º my-command.md æ–‡ä»¶ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">Create</span> <span class="hljs-string">a</span> <span class="hljs-string">git</span> <span class="hljs-string">commit</span>
<span class="hljs-meta">---</span>
<span class="hljs-comment">## Context</span>
<span class="hljs-string">-</span>Â <span class="hljs-attr">Current git status:</span> <span class="hljs-string">!`git</span> <span class="hljs-string">status`</span>
<span class="hljs-string">-</span>Â <span class="hljs-string">Current</span> <span class="hljs-string">git</span> <span class="hljs-string">diff</span> <span class="hljs-string">(staged</span> <span class="hljs-string">and</span> <span class="hljs-string">unstaged</span> <span class="hljs-string">changes):</span> <span class="hljs-string">!`git</span> <span class="hljs-string">diff</span> <span class="hljs-string">HEAD`</span>
<span class="hljs-string">-</span>Â <span class="hljs-attr">Current branch:</span> <span class="hljs-string">!`git</span> <span class="hljs-string">branch</span> <span class="hljs-string">--show-current`</span>
<span class="hljs-string">-</span>Â <span class="hljs-attr">Recent commits:</span> <span class="hljs-string">!`git</span> <span class="hljs-string">log</span> <span class="hljs-string">--oneline</span> <span class="hljs-number">-10</span><span class="hljs-string">`</span>
<span class="hljs-comment">## Your task</span>
<span class="hljs-string">Based</span> <span class="hljs-string">on</span> <span class="hljs-string">the</span> <span class="hljs-string">above</span> <span class="hljs-string">changes,</span> <span class="hljs-string">create</span> <span class="hljs-string">a</span> <span class="hljs-string">single</span> <span class="hljs-string">git</span> <span class="hljs-string">commit.</span>
</code></pre>
<p>å…³äºæ›´è¯¦ç»†çš„é…ç½®ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.iflow.cn%2Fcli%2Fexamples%2Fsubcommand" target="_blank" title="https://platform.iflow.cn/cli/examples/subcommand" ref="nofollow noopener noreferrer">platform.iflow.cn/cli/exampleâ€¦</a></p>
<p>åœ¨äº¤äº’å¼å‘½ä»¤ä¸­è¾“å…¥ /commands list æŸ¥çœ‹è‡ªå®šä¹‰æŒ‡ä»¤åˆ—è¡¨</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a216016813d244e5b738053230caa77e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=T%2FMl4ahELrkIUE6MiU%2BNG9pJdlw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-22">è‡ªå®šä¹‰å·¥ä½œæµ</h3>
<p>iFlowæä¾›çš„Workflowæ˜¯æ•´åˆ agentsã€commandsã€IFLOW.md å’Œ MCP åˆ›å»ºçš„å®Œæ•´è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹ï¼Œç›¸å½“äºClaude Codeä¸­çš„æ’ä»¶ç³»ç»Ÿï¼Œç›®å‰åªæä¾›äº†1ç§å®‰è£…æ–¹å¼</p>
<h4 data-id="heading-23">1ï¼‰å¿ƒæµå·¥ä½œæµå¸‚åœº</h4>
<p>å¿ƒæµå·¥ä½œæµå¸‚åœºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.iflow.cn%2Fagents%3Ftype%3Dworkflows%26category%3Dall" target="_blank" title="https://platform.iflow.cn/agents?type=workflows&amp;category=all" ref="nofollow noopener noreferrer">platform.iflow.cn/agents?typeâ€¦</a></p>
<p>é€‰æ‹©ä¸€ä¸ªå·¥ä½œæµï¼Œç‚¹å‡»ã€å®‰è£…ã€‘è·å–å®‰è£…å‘½ä»¤</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/737e7666abd64897a154931ddff436d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=kKEOCXyY%2FYQ0fktD953Ci8RGbho%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¤åˆ¶å‘½ä»¤åœ¨å‘½ä»¤è¡Œç»ˆç«¯ä¸€é”®å®‰è£…</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b0c2fbb0c0440718313f2751759bfe5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=wwRdfCuMJSk7rUkMXVpsbpjygzA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4153912d1c84268a3a743483347cd88~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=Oj1QjwfPNkglD0vE%2BpJdijgbPYo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>iFlow CLIæš‚æ—¶æ²¡æœ‰æä¾›æŸ¥çœ‹Workflowçš„æŒ‡ä»¤ï¼ŒWorkflowçš„å…·ä½“ä½¿ç”¨æ–¹å¼å¯ä»¥åœ¨å¿ƒæµå¼€æ”¾å¹³å°çš„å·¥ä½œæµè¯¦æƒ…ä¸­æŸ¥çœ‹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/017492448b8e4cb184716300d068f221~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=q1T%2FzzvN4J4WWJqrgldCnmoESY0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-24">2ï¼‰åˆ›å»ºå·¥ä½œæµ</h4>
<p>iFlow CLIåˆ›å»ºå·¥ä½œæµçš„æ–¹å¼å°±æ˜¯ç›´æ¥æ‰“åŒ…æ‹¥æœ‰iFlow CLIé…ç½®æ–‡ä»¶ç»“æ„çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªé¡¹ç›®å°±æ˜¯ä¸€ä¸ªå·¥ä½œæµï¼Œå®‰è£…æ—¶iFlow CLIä¼šå¯¹æ–‡ä»¶è¿›è¡Œåˆå¹¶</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18bc371d5e5146a7ad38655ed14fb2bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=%2BfVhEUsHIc2E7BPnbEnVIBXl994%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å·¥ä½œæµåˆ›å»ºå®Œæˆåï¼Œç›´æ¥åœ¨å‘½ä»¤è¡Œç»ˆç«¯æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æ‰“åŒ…å·¥ä½œæµ</p>
<pre><code class="hljs language-python" lang="python">$Â <span class="hljs-built_in">zip</span>Â -r your-workflow-name.<span class="hljs-built_in">zip</span>Â . -x your-workflow-name.<span class="hljs-built_in">zip</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d28bc74331d4d4a9b03c9404127de51~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=Urxv0VHGOqBeTtsEuGwD%2F7gJj0w%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™ä¸ªå‘½ä»¤æ‰“åŒ…ä»¥ä¸‹å†…å®¹ï¼š</p>
<ul>
<li>å‹ç¼©å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼ˆåŒ…æ‹¬ .iflow æ–‡ä»¶å¤¹ã€é¡¹ç›®æ–‡ä»¶ã€IFLOW.md ç­‰ï¼‰</li>
<li>åŒ…å«éšè—æ–‡ä»¶ï¼ˆå¦‚ .iflow ç›®å½•ï¼‰</li>
<li>æ’é™¤ç”Ÿæˆçš„å‹ç¼©åŒ…æœ¬èº«ï¼Œé¿å…é€’å½’åŒ…å«</li>
<li>è§£å‹æ—¶ä¿æŒåŸå§‹ç›®å½•ç»“æ„ï¼Œä¸ä¼šåˆ›å»ºé¢å¤–çš„ç›®å½•å±‚çº§</li>
</ul>
<p>ä¸ºäº†ä¿è¯å·¥ä½œæµçš„å‡†ç¡®æ€§ï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œç»ˆç«¯æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤éªŒè¯æ‰“åŒ…å†…å®¹</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$Â unzip</span> -l your-workflow-name.zip
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb5e82cf651247b099893e16a95a7000~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=OrS1wJ2ZouVfWfe9LOhhTL4L63M%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>éªŒè¯æ²¡æœ‰é—®é¢˜åå°±å¯ä»¥ä¸Šä¼ åˆ°å¿ƒæµå¼€æ”¾å¹³å°äº†ï¼Œç›®å‰åªæ”¯æŒé€šè¿‡å¿ƒæµå¹³å°åˆ†å‘ã€‚</p>
<h3 data-id="heading-25">Subagents</h3>
<p>iFlowæä¾›äº†SubagentsåŠŸèƒ½ï¼Œä¹Ÿæä¾›äº†å¤šç§å®‰è£…æ–¹å¼</p>
<h4 data-id="heading-26">1ï¼‰å¿ƒæµAgentå¸‚åœºï¼ˆæ¨èï¼‰</h4>
<p>æ™ºèƒ½ä½“å¸‚åœºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.iflow.cn%2Fagents%3Ftype%3Dagents%26category%3Dall" target="_blank" title="https://platform.iflow.cn/agents?type=agents&amp;category=all" ref="nofollow noopener noreferrer">platform.iflow.cn/agents?typeâ€¦</a></p>
<p>é€‰æ‹©ä¸€ä¸ªæ™ºèƒ½ä½“ï¼Œç‚¹å‡»ã€å®‰è£…ã€‘è·å–å®‰è£…å‘½ä»¤</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/289a6959dc1a41bd820bb1f415ff4441~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=ar%2Fia9nyQIfd0oxTX%2B0F0qqzRTk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¤åˆ¶å‘½ä»¤åœ¨å‘½ä»¤è¡Œç»ˆç«¯ä¸€é”®å®‰è£…</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/43dad48a6ee24a35abc27e7deca6ab3a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=M4RoNTOJVqFJEvJ4BzscsS59Bdg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c5e8b84d7cbc4f3bb763b83b3bece03a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=slfrjE5iVlqitr4w0aSqw%2B3a8Qs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ¨å‘½ä»¤è¡Œç»ˆç«¯è¾“å…¥ /iflow agent list å¯ä»¥æŸ¥çœ‹å®‰è£…åˆ—è¡¨</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2a7bd64aedd2441c9911bc6d8ac40ed6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=BY0UCjiB74iJ6p%2FFURHYdAg%2BNJI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-27">2ï¼‰åœ¨çº¿å®‰è£…</h4>
<p>åœ¨äº¤äº’å¼å‘½ä»¤ä¸­æ‰§è¡Œ /agents online å¯ä»¥åœ¨çº¿æµè§ˆAgentså¸‚åœº</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c14b237748db42aba5e4eb933c2fd069~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=TxkpdC4QlX6j9v%2BDi3dYdTupYF0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä½¿ç”¨ â†‘â†“ é€‰æ‹©Agentsï¼Œ â†â†’ ç¿»é¡µæŸ¥çœ‹ï¼Œä½¿ç”¨å¯¹åº”çš„æ•°å­—é”®è¿›è¡Œå®‰è£…</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/96dc613154b44b0ebaca64c2504ad0eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=9fE2pqbvCnHajFXLLKq5Tn8XnF4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-28">3ï¼‰åˆ›å»ºSubagents</h4>
<p>iFlow CLIåˆ›å»ºAgentsä¹Ÿæœ‰ 2ç§ æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨äº¤äº’å¼å‘½ä»¤ /agents install æ ¹æ®å®‰è£…å‘å¯¼ä¸€æ­¥æ­¥å®‰è£…</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3ae439598cd6406aa49c730eb0a07fe2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=kG%2Ftc8tMd3IBqr2AKJZ6pPiM%2BoQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å®‰è£…ï¼Œåœ¨å…¨å±€æˆ–è€…é¡¹ç›® iflow/agents ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª my-agent.md æ–‡ä»¶ï¼Œè¾“å…¥å¦‚ä¸‹æç¤ºè¯</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">agentType:</span> <span class="hljs-string">"custom-expert"</span>
<span class="hljs-attr">systemPrompt:</span> <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰é¢†åŸŸçš„ä¸“å®¶..."</span>
<span class="hljs-attr">whenToUse:</span> <span class="hljs-string">"å½“éœ€è¦å¤„ç†ç‰¹å®šé¢†åŸŸä»»åŠ¡æ—¶ä½¿ç”¨"</span>
<span class="hljs-attr">model:</span> <span class="hljs-string">"GLM-4.6"</span>
<span class="hljs-attr">allowedTools:</span> [<span class="hljs-string">"*"</span>]
<span class="hljs-string">proactive:</span>Â <span class="hljs-literal">false</span>
<span class="hljs-meta">---</span>
<span class="hljs-comment"># Custom Expert Agent</span>
<span class="hljs-string">è¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰ä¸“å®¶Agentçš„è¯¦ç»†è¯´æ˜...</span>
</code></pre>
<p>å…³äºæ›´è¯¦ç»†çš„é…ç½®ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥çœ‹å®˜æ–¹Subagentsæ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.iflow.cn%2Fcli%2Fexamples%2Fsubagent%23%25E5%258F%25AF%25E9%2580%2589%25E5%25B1%259E%25E6%2580%25A7" target="_blank" title="https://platform.iflow.cn/cli/examples/subagent#%E5%8F%AF%E9%80%89%E5%B1%9E%E6%80%A7" ref="nofollow noopener noreferrer">platform.iflow.cn/cli/exampleâ€¦</a></p>
<p>åœ¨äº¤äº’å¼å‘½ä»¤ä¸­è¾“å…¥ /agents list æŸ¥çœ‹Subagentsåˆ—è¡¨</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c51b08d0497419d932569dff8709ab1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=4a4EbtCTuf%2FjHcC%2BTAqo3Z8hWsQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-29">MCPæœåŠ¡</h3>
<p>iFlowæ”¯æŒMCPæœåŠ¡ï¼Œæä¾›äº†å¤šç§å®‰è£…æ–¹å¼</p>
<h4 data-id="heading-30">1ï¼‰å¿ƒæµMCPå¸‚åœºï¼ˆæ¨èï¼‰</h4>
<p>è®¿é—®å¿ƒæµMCPå¸‚åœºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.iflow.cn%2Fmcp%25EF%25BC%258C%25E6%2589%25BE%25E5%2588%25B0MCP%25E7%2582%25B9%25E5%2587%25BB%25E3%2580%2590%25E5%25AE%2589%25E8%25A3%2585%25E3%2580%2591" target="_blank" title="https://platform.iflow.cn/mcp%EF%BC%8C%E6%89%BE%E5%88%B0MCP%E7%82%B9%E5%87%BB%E3%80%90%E5%AE%89%E8%A3%85%E3%80%91" ref="nofollow noopener noreferrer">platform.iflow.cn/mcpï¼Œæ‰¾åˆ°MCPç‚¹å‡»â€¦</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/45acd9f57b41417d8df22cc0ab91add7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=T7eBEzzTU%2BqWRFRTCjK3fCGuZEA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¤åˆ¶å‘½ä»¤åœ¨å‘½ä»¤è¡Œç»ˆç«¯ä¸€é”®å®‰è£…</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ea69c5dd2f214499a69df31451a0f990~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=9EezRx8P4N%2FPIX08gSOrIf7EzG4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å®‰è£…å®Œæˆåï¼Œåœ¨å‘½ä»¤è¡Œç»ˆç«¯è¾“å…¥ /iflow mcp list å¯ä»¥æŸ¥çœ‹MCPå®‰è£…åˆ—è¡¨</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1ce0064102542898c631ec124969f1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=NPUqIyhQJXqXCulI%2FXix%2FUPlJn0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-31">2ï¼‰åœ¨çº¿å®‰è£…</h4>
<p>åœ¨äº¤äº’å¼å‘½ä»¤ä¸­æ‰§è¡Œ /mcp online å¯ä»¥åœ¨çº¿æµè§ˆMCPå¸‚åœºï¼Œé€‰æ‹©åˆé€‚çš„MCPè¿›è¡Œå®‰è£…</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10f94b337ca94ed8a750d57da4302012~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=E0sQBivIECNKbemvmdUJW%2F4enBE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä½¿ç”¨ â†‘â†“ é€‰æ‹©MCPï¼Œ â†â†’ ç¿»é¡µæŸ¥çœ‹ï¼Œä½¿ç”¨å¯¹åº”çš„æ•°å­—é”®è¿›è¡Œå®‰è£…</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d38300daccd347c189098788301f692d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=AadxM1biaDQork%2Fkw8OImLDWxEs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-32">3ï¼‰å‘½ä»¤è¡Œå®‰è£…</h4>
<p>iFlow CLIå’Œå…¶ä»–ä¸»æµCLIä¸€æ ·æ”¯æŒä½¿ç”¨å‘½ä»¤è¡Œå®‰è£…ï¼Œé»˜è®¤å®‰è£…åˆ°é¡¹ç›®ä½œç”¨åŸŸ</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_">$</span><span class="bash">Â iflow mcp add --transport http context7 https://mcp.context7.com/mcp</span>
<span class="hljs-meta prompt_">#</span><span class="bash">Â å®Œæ•´å®‰è£…æ–¹å¼</span>
<span class="hljs-meta prompt_">$</span><span class="bash">Â iflow mcp add --transport http -s project context7 https://mcp.context7.com/mcp</span>
</code></pre>
<p>å¦‚æœéœ€è¦å…¨å±€å®‰è£…MCPå¯ä»¥æ·»åŠ  -s user æˆ– --scope user æ ‡è¯†</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_">$</span><span class="bash">Â iflow mcp add --transport http -s user context7 https://mcp.context7.com/mcp</span>
<span class="hljs-meta prompt_">$</span><span class="bash">Â iflow mcp add --transport http --scope user context7 https://mcp.context7.com/mcp</span>
</code></pre>
<h4 data-id="heading-33">4ï¼‰é…ç½®æ–‡ä»¶å®‰è£…</h4>
<p>åœ¨iFlow CLIä¸­ä¹Ÿå¯ç›´æ¥ä¿®æ”¹å…¨å±€ç”¨æˆ·é…ç½® ~/.iflow/settings.json å’Œ é¡¹ç›®é…ç½® .iflow/settings.json ç›´æ¥æ·»åŠ MCPæœåŠ¡</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/396cda114aec4021b495bd650c35e827~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5rqq5b285bK4:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766287880&amp;x-signature=MEtB1rmdzRQPXxnfGz12ZoyKyt0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-34">Hooks</h3>
<p>iFlow CLIæä¾›äº†Hooksçš„æ”¯æŒï¼Œæ”¯æŒ ç”¨æˆ·é…ç½® å’Œ é¡¹ç›®é…ç½® 2ç§é…ç½®å±‚çº§</p>
<ul>
<li>ç”¨æˆ·é…ç½®ï¼š~/.iflow/settings.json</li>
<li>é¡¹ç›®é…ç½®ï¼š.iflow/settings.json</li>
</ul>
<p>æ”¯æŒ9å¤§ç±»Hooksç±»å‹ï¼Œé…ç½®æ–¹å¼å’ŒClaude Code CLIåŸºæœ¬ä¸€è‡´ã€‚å¯ä»¥ç›´æ¥åœ¨ settings.json æ–‡ä»¶ä¸­æ·»åŠ  hooks é…ç½®é¡¹ï¼Œå®Œæ•´é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
Â  <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
Â  Â  <span class="hljs-attr">"PreToolUse"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  <span class="hljs-punctuation">{</span>
Â  Â  Â  Â  <span class="hljs-attr">"matcher"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"tool_pattern"</span><span class="hljs-punctuation">,</span>
Â  Â  Â  Â Â <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  Â  Â  <span class="hljs-punctuation">{</span>
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"command"</span><span class="hljs-punctuation">,</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"your_command"</span><span class="hljs-punctuation">,</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-attr">"timeout"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-number">30</span>
Â  Â  Â  Â  Â  <span class="hljs-punctuation">}</span>
Â  Â  Â  Â  <span class="hljs-punctuation">]</span>
Â  Â  Â  <span class="hljs-punctuation">}</span>
Â  Â  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
Â  Â  <span class="hljs-attr">"PostToolUse"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  <span class="hljs-punctuation">{</span>
Â  Â  Â  Â  <span class="hljs-attr">"matcher"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"another_pattern"</span><span class="hljs-punctuation">,</span>
Â  Â  Â  Â Â <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  Â  Â  <span class="hljs-punctuation">{</span>
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"command"</span><span class="hljs-punctuation">,</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"cleanup_command"</span>
Â  Â  Â  Â  Â  <span class="hljs-punctuation">}</span>
Â  Â  Â  Â  <span class="hljs-punctuation">]</span>
Â  Â  Â  <span class="hljs-punctuation">}</span>
Â  Â  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
Â  Â  <span class="hljs-attr">"SetUpEnvironment"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  <span class="hljs-punctuation">{</span>
Â  Â  Â  Â  <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  Â  Â  <span class="hljs-punctuation">{</span>
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"command"</span><span class="hljs-punctuation">,</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"python ~/.iflow/hooks/env_enhancer.py"</span><span class="hljs-punctuation">,</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-attr">"timeout"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-number">30</span>
Â  Â  Â  Â  Â  <span class="hljs-punctuation">}</span>
Â  Â  Â  Â  <span class="hljs-punctuation">]</span>
Â  Â  Â  <span class="hljs-punctuation">}</span>
Â  Â  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
Â  Â  <span class="hljs-attr">"Stop"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  <span class="hljs-punctuation">{</span>
Â  Â  Â  Â  <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  Â  Â  <span class="hljs-punctuation">{</span>
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"command"</span><span class="hljs-punctuation">,</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"echo 'Session ended'"</span>
Â  Â  Â  Â  Â  <span class="hljs-punctuation">}</span>
Â  Â  Â  Â  <span class="hljs-punctuation">]</span>
Â  Â  Â  <span class="hljs-punctuation">}</span>
Â  Â  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
Â  Â  <span class="hljs-attr">"SubagentStop"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  <span class="hljs-punctuation">{</span>
Â  Â  Â  Â  <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  Â  Â  <span class="hljs-punctuation">{</span>
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"command"</span><span class="hljs-punctuation">,</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"cleanup_subagent.sh"</span>
Â  Â  Â  Â  Â  <span class="hljs-punctuation">}</span>
Â  Â  Â  Â  <span class="hljs-punctuation">]</span>
Â  Â  Â  <span class="hljs-punctuation">}</span>
Â  Â  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
Â  Â  <span class="hljs-attr">"SessionStart"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  <span class="hljs-punctuation">{</span>
Â  Â  Â  Â  <span class="hljs-attr">"matcher"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"startup"</span><span class="hljs-punctuation">,</span>
Â  Â  Â  Â Â <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  Â  Â  <span class="hljs-punctuation">{</span>
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"command"</span><span class="hljs-punctuation">,</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"echo 'Session initialized'"</span>
Â  Â  Â  Â  Â  <span class="hljs-punctuation">}</span>
Â  Â  Â  Â  <span class="hljs-punctuation">]</span>
Â  Â  Â  <span class="hljs-punctuation">}</span>
Â  Â  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
Â  Â  <span class="hljs-attr">"SessionEnd"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  <span class="hljs-punctuation">{</span>
Â  Â  Â  Â  <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  Â  Â  <span class="hljs-punctuation">{</span>
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"command"</span><span class="hljs-punctuation">,</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"python ~/.iflow/hooks/session_summary.py"</span>
Â  Â  Â  Â  Â  <span class="hljs-punctuation">}</span>
Â  Â  Â  Â  <span class="hljs-punctuation">]</span>
Â  Â  Â  <span class="hljs-punctuation">}</span>
Â  Â  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
Â  Â  <span class="hljs-attr">"UserPromptSubmit"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  <span class="hljs-punctuation">{</span>
Â  Â  Â  Â  <span class="hljs-attr">"matcher"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">".*sensitive.*"</span><span class="hljs-punctuation">,</span>
Â  Â  Â  Â Â <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  Â  Â  <span class="hljs-punctuation">{</span>
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"command"</span><span class="hljs-punctuation">,</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"python ~/.iflow/hooks/content_filter.py"</span>
Â  Â  Â  Â  Â  <span class="hljs-punctuation">}</span>
Â  Â  Â  Â  <span class="hljs-punctuation">]</span>
Â  Â  Â  <span class="hljs-punctuation">}</span>
Â  Â  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
Â  Â  <span class="hljs-attr">"Notification"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  <span class="hljs-punctuation">{</span>
Â  Â  Â  Â  <span class="hljs-attr">"matcher"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">".*permission.*"</span><span class="hljs-punctuation">,</span>
Â  Â  Â  Â Â <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
Â  Â  Â  Â  Â  <span class="hljs-punctuation">{</span>
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"command"</span><span class="hljs-punctuation">,</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"logger 'iFlow permission request'"</span>
Â  Â  Â  Â  Â  <span class="hljs-punctuation">}</span>
Â  Â  Â  Â  <span class="hljs-punctuation">]</span>
Â  Â  Â  <span class="hljs-punctuation">}</span>
Â  Â  <span class="hljs-punctuation">]</span>
Â  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>æœ¬äººå°è¯•äº†å‡ ä¸ªæ²¡æœ‰è§¦å‘è¿‡ğŸ˜‚ã€‚</p>
<h2 data-id="heading-35">æ€»ç»“</h2>
<p>æŠ›å¼€iFlow CLIå¥½ç”¨ä¸å¥½ç”¨ä¹‹è¯´ï¼ŒiFlow CLIé¦–å…ˆå…è´¹å°±æ˜¯ä¸€å¤§ä¼˜åŠ¿ï¼Œå…¶æ¬¡iFlow CLIåº”è¯¥æ˜¯å›½å†…ä¸ºæ•°ä¸å¤šçš„åœ¨åŠŸèƒ½ä¸ŠåŸºæœ¬è¿½é½Claude Code CLIçš„CLIå·¥å…·ï¼Œè‡ªå®šä¹‰å‘½ä»¤ã€è‡ªå®šä¹‰å·¥ä½œæµã€Subagnetsã€MCPã€Hookså·²æ˜¯åº”ç”±å…·æœ‰äº†ï¼Œå…¶æ¬¡iFlowæä¾›äº†å¯¹å›½äººå‹å¥½çš„å„ç§å·¥å…·çš„å®‰è£…å¸‚åœºå’Œè¯¦ç»†çš„æ–‡æ¡£ï¼Œæ˜¯å€¼å¾—ç‚¹èµçš„ï¼Œåœ¨æ²¡æœ‰AIè¶³å¤Ÿé¢åº¦çš„æƒ…å†µè¿˜æ˜¯å¯ä»¥ä½œä¸ºä»£æ›¿ä½¿ç”¨çš„ã€‚</p>
<h2 data-id="heading-36">å‹æƒ…æç¤º</h2>
<p>è§åŸæ–‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FXkEycyJujBc3GC8zuR-E1A" target="_blank" title="https://mp.weixin.qq.com/s/XkEycyJujBc3GC8zuR-E1A" ref="nofollow noopener noreferrer">åˆè¯†iFlow CLI</a></p>
<blockquote>
<p>æœ¬æ–‡åŒæ­¥è‡ªå¾®ä¿¡å…¬ä¼—å· "<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FXkEycyJujBc3GC8zuR-E1A" target="_blank" title="https://mp.weixin.qq.com/s/XkEycyJujBc3GC8zuR-E1A" ref="nofollow noopener noreferrer">ç¨‹åºå‘˜å°æºª</a>" ï¼Œè¿™é‡Œåªæ˜¯åŒæ­¥ï¼Œæƒ³çœ‹åŠæ—¶æ¶ˆæ¯è¯·ç§»æ­¥æˆ‘çš„å…¬ä¼—å·ï¼Œä¸å®šæ—¶æ›´æ–°æˆ‘çš„å­¦ä¹ ç»éªŒã€‚å‹æƒ…æç¤ºå‹æƒ…æç¤º</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€AIç¼–ç¨‹ã€‘5åˆ†é’Ÿç”¨Trae soloåšå‡ºæœ‰BOSSæˆ˜çš„ã€Šå¦å…‹å¤§æˆ˜ã€‹]]></title>    <link>https://juejin.cn/post/7582958136257413156</link>    <guid>https://juejin.cn/post/7582958136257413156</guid>    <pubDate>2025-12-14T03:55:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582958136257413156" data-draft-id="7582904081864146985" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€AIç¼–ç¨‹ã€‘5åˆ†é’Ÿç”¨Trae soloåšå‡ºæœ‰BOSSæˆ˜çš„ã€Šå¦å…‹å¤§æˆ˜ã€‹"/> <meta itemprop="keywords" content="AIç¼–ç¨‹,AIGC,OpenAI"/> <meta itemprop="datePublished" content="2025-12-14T03:55:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å·ç¦åŒå­¦"/> <meta itemprop="url" content="https://juejin.cn/user/3456520291098686"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€AIç¼–ç¨‹ã€‘5åˆ†é’Ÿç”¨Trae soloåšå‡ºæœ‰BOSSæˆ˜çš„ã€Šå¦å…‹å¤§æˆ˜ã€‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3456520291098686/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å·ç¦åŒå­¦
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T03:55:13.000Z" title="Sun Dec 14 2025 03:55:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å‹å‹ä»¬ï¼Œåˆåˆ°äº†å‘¨æœ«AIæ•´æ´»æ—¶é—´äº†</p>
</blockquote>
<p>ç°åœ¨AIç¼–ç¨‹å·¥å…·å·²ç»èƒ½åšåˆ°ä¸€å¥è¯çš„éœ€æ±‚ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„é¡¹ç›®äº†ï¼Œä»Šå¤©æˆ‘ä»¬ç”¨Trae soloæ¥è¯•ç€å¤åˆ»å°æ—¶å€™çš„æ¸¸æˆã€Šå¦å…‹å¤§æˆ˜ã€‹ï¼Œå¹¶ä¸”éƒ¨ç½²ä¸Šçº¿ï¼Œä¸‹é¢æ˜¯æ¼”ç¤ºæ•ˆæœå’Œåœ°å€ï¼š</p>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ftanke-orpin.vercel.app%2F" target="_blank" title="https://tanke-orpin.vercel.app/" ref="nofollow noopener noreferrer">tanke-orpin.vercel.app/</a></p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aeab79a71b4d425c8b9818acd0557d32~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766289313&amp;x-signature=%2BLHjYO6TooME4DaJ%2BQtEGj4PnI0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">1.å·¥å…·å‡†å¤‡</h2>
<ul>
<li>
<p>ä¸‹è½½Traeï¼Œå›½é™…ç‰ˆä¸‹è½½ï¼š<a href="https://www.trae.ai/" target="_blank" title="https://www.trae.ai/" ref="nofollow noopener noreferrer">www.trae.ai/</a>ï¼Œå›½å†…ç‰ˆä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.trae.cn%2F" target="_blank" title="https://www.trae.cn/" ref="nofollow noopener noreferrer">www.trae.cn/</a></p>
</li>
<li>
<p>ï¼ˆå›½é™…ç‰ˆï¼‰æ³¨å†ŒVercelï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fvercel.com%2F" target="_blank" title="https://vercel.com/" ref="nofollow noopener noreferrer">vercel.com/</a></p>
</li>
</ul>
<p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å›½é™…ç‰ˆåšæ¼”ç¤ºï¼Œéƒ¨ç½²ä¸Šçº¿éœ€è¦ç”¨åˆ°Vercel</p>
<p>å›½é™…ç‰ˆå’Œå›½å†…ç‰ˆTraeçš„åŒºåˆ«ä¸»è¦æ˜¯ä½¿ç”¨çš„æ¨¡å‹ä¸åŒ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29d62d1cb9ff43fb9731ea65090e17f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766289313&amp;x-signature=RZuyQ5t8kgZ3Rax1s9rPZtptJSc%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e7452bf1c6341f29a151bf3e689c9ad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766289313&amp;x-signature=o61aR3aSOZLAxwfW8TQ1YxNaaGA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">2.è¾“å…¥éœ€æ±‚</h2>
<p>é¦–å…ˆæ‰“å¼€Traeçš„soloæ¨¡å¼ï¼Œåœ¨å·¦ä¸Šè§’çš„ä½ç½®</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00b6f6c0f83a4294a9df01c0765d2e69~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766289313&amp;x-signature=5%2Bm1UOwseeL4nSiphlQWb3N1VMM%3D" alt="" loading="lazy"/></p>
<p>æ¥ç€è¾“å…¥éœ€æ±‚ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘å¼€å‘æ¸¸æˆçš„æŠ€æœ¯æ ˆï¼Œç›´æ¥æŠŠéœ€æ±‚è¾“å…¥</p>
<blockquote>
<p>ä½¿ç”¨ H5å¼€å‘ä¸€æ¬¾ç«¥å¹´ç»å…¸çš„ã€Šå¦å…‹å¤§æˆ˜ã€‹æ¸¸æˆï¼Œåªéœ€è¦æ”¯æŒå•äººå¯¹æˆ˜ AIï¼Œæ–¹å‘é”®æ§åˆ¶ç§»åŠ¨ï¼Œç©ºæ ¼å°„å‡»ï¼ŒåŒ…å«å…³å¡ç³»ç»Ÿã€ç¢°æ’æ£€æµ‹ã€çˆ†ç‚¸åŠ¨ç”»ã€éŸ³æ•ˆã€è®¡åˆ†ç³»ç»Ÿï¼Œä½¿ç”¨ localStorage ä¿å­˜è¿›åº¦ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬è¿˜å¯ä»¥ç‚¹å‡»ä¸‹æ–¹çš„ã€Œä¼˜åŒ–ã€æŒ‰é’®ï¼Œå¯¹ç°æœ‰æç¤ºè¯è¿›è¡Œä¼˜åŒ–</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a290b7780799410c965afeed2a344bc4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766289313&amp;x-signature=Iv%2F7Q4rvSsJJ%2B%2B5MxGvfE%2FQi%2BSM%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f14026efc7f640989432da0e5d6cda62~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766289313&amp;x-signature=rlH4a%2FWMqteqSOgBvJeg9a0ujSA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">3.å¼€é€šProä¼šå‘˜</h2>
<p>è¿™ä¸€æ­¥å°å·æ²¡æ³¨æ„åˆ°Trae Soloæ˜¯Proä¼šå‘˜æ‰æœ‰çš„åŠŸèƒ½ï¼Œçœ‹äº†ä¸‹ä»·é’±ï¼Œé¦–æœˆåªéœ€è¦3ç¾åˆ€ï¼ŒæŠ˜åˆä¸‹æ¥æ˜¯21å—é’±ï¼Œè¿˜ç®—å¯ä»¥ï¼Œäºæ˜¯å¼€é€šä¸€ä¸ªæœˆçš„ä¼šå‘˜å°å°é²œ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/45f4f83ac90e4e8fbbbb2812ac570238~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766289313&amp;x-signature=cGGAAQ32aULlMBw9qA3gBCR50fk%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3">4.å¼€å‘</h2>
<p>Trae SOLOä¼šå…ˆç”Ÿæˆéœ€æ±‚æ–‡æ¡£å’ŒæŠ€æœ¯æ¶æ„æ–‡æ¡£ï¼Œæˆ‘ä»¬ç¡®è®¤æ²¡é—®é¢˜ä¹‹åå°±å¯ä»¥å¼€å§‹äº†ã€‚æœ‰é—®é¢˜å¯ä»¥ç»§ç»­å¯¹è¯è®©Trae SOLOä¿®æ”¹å°±è¡Œ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d2de39de0ae54fed829863e87aec5312~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766289313&amp;x-signature=KFFdAq6%2BugqKYxz2xEYMGfXAnS8%3D" alt="" loading="lazy"/></p>
<p>æ¥ç€æˆ‘ä»¬å¯ä»¥å»å–å–èŒ¶ï¼Œé™é™ç­‰å¾…Traeå®Œæˆå·¥ä½œå°±è¡Œã€‚å¦¥å¦¥çš„é¢†å¯¼æŒ‡æŒ¥æ‰“å·¥ç‰›é©¬çš„æ„Ÿè§‰</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/60f6244d84ff4c1a8bdd2fe0402741ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766289313&amp;x-signature=8hlWmP6jbbmgQVmHxddVWRW1Cn4%3D" alt="" loading="lazy"/></p>
<p>ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆåï¼Œå‘é€æç¤ºè¯ã€Œè¿è¡Œæ¸¸æˆã€ç»™Traeå°±å¯ä»¥æŸ¥çœ‹æˆ‘ä»¬åšå‡ºæ¥çš„å¦å…‹å¤§æˆ˜äº†</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b2e5fa0d68054eb29a67db0a09e992de~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766289313&amp;x-signature=IQWtos6l%2BXZ9lqlCBmaCttdbJKk%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">5.åŠ ä¸ŠAIè„šæœ¬åŠŸèƒ½</h2>
<p>çœ‹åˆ°ä¸Šé¢å·²ç»éå¸¸å®Œç¾åœ°å¤åˆ»äº†ã€Šå¦å…‹å¤§æˆ˜ã€‹çš„æ¸¸æˆï¼Œä½†æ˜¯è€ƒè™‘åˆ°ç©å®¶ç°åœ¨éƒ½æ¯”è¾ƒæ‡’ï¼Œèƒ½ä¸èƒ½åšä¸ªåŠŸèƒ½ï¼Œè®©AIå¸®æˆ‘ä»¬ç©å‘¢ï¼Œæˆ‘ä»¬ç›´æ¥çœ‹AIå¯¹æˆ˜AIå²‚ä¸æ˜¯ä¹Ÿæ˜¯ä¸€ç§ä¹è¶£å—ï¼Œäºæ˜¯è®©Traeç»™æˆ‘åŠ ä¸ŠAIè„šæœ¬çš„åŠŸèƒ½</p>
<blockquote>
<p>å†æ–°åŠ ä¸ªåŠŸèƒ½ï¼ŒåŠ ä¸ªå¼€å…³æŒ‰é’®ï¼Œæ‰“å¼€å¼€å…³åå˜æˆè‡ªåŠ¨æ¨¡å¼ï¼Œå¦å…‹ä¼šè‡ªå·±ç§»åŠ¨å»æ‰¾æ•Œäººæ”»å‡»ï¼Œç§»åŠ¨éœ€è¦æœ‰ç›®çš„æ€§ï¼Œåœ¨èƒ½æ”»å‡»æ•Œäººæ—¶å°±ç›´æ¥æ”»å‡»</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84632f81e73642b0982668723d1ad42c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766289313&amp;x-signature=ztbmDBdIY4jG8%2FxUReF7il1pNpc%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">6.åŠ ä¸ŠBOSSæˆ˜</h2>
<p>ç«¥å¹´ç»å…¸æ¸¸æˆã€Šå¦å…‹å¤§æˆ˜ã€‹è™½ç„¶ç»å…¸ï¼Œä½†æ˜¯é—æ†¾æ²¡æœ‰BOSSæˆ˜ï¼Œå°æ—¶å€™å’Œå°ä¼™ä¼´ä»¬æ›¾ç»å¥‹æˆ˜1æ•´å¤©æ‰“åˆ°200å¤šå…³ä¹‹åäº†ï¼Œå°±æƒ³çœ‹çœ‹æœ‰æ²¡æœ‰BOSSå¯ä»¥æ‰“ï¼Œé—æ†¾æ²¡æœ‰ï¼Œ</p>
<p>äºæ˜¯å°å·æˆ‘çªå‘å¥‡æƒ³ï¼Œèƒ½ä¸èƒ½åŠ ä¸ªBOSSæˆ˜å‘¢ï¼Œè¿™æ ·ç©èµ·æ¥ä¹è¶£ä¹Ÿæ›´å¤§ï¼Œä¹Ÿèƒ½è¡¥ä¸Šå°æ—¶å€™çš„é—æ†¾äº†</p>
<blockquote>
<p>ä¼˜åŒ–å°å…µåˆ·æ–°çš„é€»è¾‘ï¼Œç°åœ¨æ˜¯æŒ‰æ—¶é—´åˆ·çš„å—ï¼Œæˆ‘éœ€è¦çš„æ•ˆæœæ˜¯ï¼šæ¸¸æˆåœºæ™¯é‡Œæœ€å¤šå­˜åœ¨3ä¸ªæ•Œæ–¹å°å…µï¼Œæ¯å‡»æ€1ä¸ªï¼Œå°±åˆ·æ–°å‡ºä¸€ä¸ªï¼Œæ¯å…³æœ€å¤š9ä¸ªå°å…µï¼Œå¯ä»¥åœ¨æ¸¸æˆå³ä¸Šè§’ä½ç½®æ˜¾ç¤ºå‰©ä½™å°å…µæ•°é‡ï¼Œç„¶åæœ€åå‡ºæ¥çš„é‚£ä¸ªæ•Œæ–¹å¦å…‹å±äºBOSSï¼Œä½“å‹è¦å¤§ï¼Œè¡€é‡è¦åšï¼Œéœ€è¦æ”»å‡»çš„æ¬¡æ•°éšå…³å¡æ•°è€Œå¢åŠ ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒBOSSè¿˜å¯ä»¥ä½¿ç”¨æŠ€èƒ½ï¼Œæ¯”å¦‚ï¼šé˜²æŠ¤ç½©ï¼ˆçŸ­æ—¶é—´å†…æ— æ•ŒçŠ¶æ€ï¼‰ï¼ŒAOEä¼¤å®³ï¼ˆç‚®å¼¹é£å‡ºå»åï¼Œèƒ½çˆ†ç‚¸é€ æˆèŒƒå›´ä¼¤å®³ï¼‰</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b627c771a4b64f7896b89218956f2ddb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766289313&amp;x-signature=wqOhfywya%2BubkfqEy18Opg0EjkU%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-6">7. éƒ¨ç½²ä¸Šçº¿</h2>
<p>åˆ°æ­¤ï¼Œæ¸¸æˆå°±åšå¥½ï¼Œæ¥ä¸‹æ¥å°±æ˜¯éƒ¨ç½²ä¸Šçº¿äº†</p>
<p>éœ€è¦å…ˆåœ¨Traeé‡Œç»™Vercelæˆæƒï¼Œåœ¨Vercelé‡Œåˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ï¼Œç„¶åç‚¹å‡»éƒ¨ç½²</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e9fdba64a1e416b9a683c6934469f7f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766289313&amp;x-signature=JWRmwpU7XD2VNa5%2ByttXNm%2BTvuM%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/494c2519d723426aa3e4b007e22ac36f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766289313&amp;x-signature=N0mh9WYIWHVrZieJjDXXizZL%2BvQ%3D" alt="" loading="lazy"/></p>
<p>éƒ¨ç½²å®Œæˆåï¼Œæˆ‘ä»¬æ‰“å¼€Vercelçš„é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°éƒ¨ç½²åçš„åŸŸåï¼Œç›´æ¥æµè§ˆå™¨æ‰“å¼€å°±èƒ½å¼€å§‹ç©äº†</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/874919e42f024eb787c93cdbcb01eab6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766289313&amp;x-signature=fAeRpCw%2BKiBBE1M2o9Ue5Kbs6Ac%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">8.æœ€å</h2>
<p>æ¼”ç¤ºæ•ˆæœåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftanke-orpin.vercel.app%2F" target="_blank" title="https://tanke-orpin.vercel.app/" ref="nofollow noopener noreferrer">tanke-orpin.vercel.app/</a></p>
<p>ä»Šå¤©åˆ†äº«äº†å¦‚æœé€šè¿‡Trae Soloæ¥å¼€å‘ä¸€ä¸ªå°æ¸¸æˆï¼ŒåŒæ ·åœ°ï¼Œå¼€å‘ç½‘ç«™å’Œéƒ¨ç½²ä¹Ÿæ˜¯ä¸€æ ·çš„æ­¥éª¤</p>
<p>å³ä½¿æ˜¯ä¸æ‡‚ç¼–ç¨‹çš„äººï¼Œå¯ä»¥é€šè¿‡AIç¼–ç¨‹å·¥å…·å®Œæˆä¸€ä¸ªéœ€æ±‚ï¼ŒAIææ•ˆç°åœ¨åˆ‡åˆ‡å®å®åœ°ç”¨åœ¨æé«˜ç”Ÿäº§åŠ›ä¸Šäº†</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç¨‹åºå‘˜åº”è¯¥ç†Ÿæ‚‰çš„æ¦‚å¿µ(4)MCPèƒ½åšä»€ä¹ˆ]]></title>    <link>https://juejin.cn/post/7583174749066248238</link>    <guid>https://juejin.cn/post/7583174749066248238</guid>    <pubDate>2025-12-14T03:49:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583174749066248238" data-draft-id="7583174749066215470" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç¨‹åºå‘˜åº”è¯¥ç†Ÿæ‚‰çš„æ¦‚å¿µ(4)MCPèƒ½åšä»€ä¹ˆ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,MCP"/> <meta itemprop="datePublished" content="2025-12-14T03:49:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åˆ˜ç«‹å†›"/> <meta itemprop="url" content="https://juejin.cn/user/2830599308981642"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç¨‹åºå‘˜åº”è¯¥ç†Ÿæ‚‰çš„æ¦‚å¿µ(4)MCPèƒ½åšä»€ä¹ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2830599308981642/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åˆ˜ç«‹å†›
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T03:49:11.000Z" title="Sun Dec 14 2025 03:49:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç«  <a href="https://link.juejin.cn?target=http%3A%2F%2Fwfcoding.com%2Farticles%2Fprogrammer%2Fp08%2F" target="_blank" title="http://wfcoding.com/articles/programmer/p08/" ref="nofollow noopener noreferrer">MCPç®€ä»‹</a> ä¸­ï¼Œæˆ‘ä»¬å¯¹ <strong>MCP</strong>(Model Context Protocol)  æœ‰äº†ä¸€ä¸ªæ¦‚å¿µä¸Šçš„è®¤è¯†ï¼Œæœ¬æ–‡å°†æ›´åŠ æ·±å…¥çš„ä»‹ç» <strong>MCP</strong> çš„æ¶æ„å’ŒåŠŸèƒ½ã€‚</p>

<h2 data-id="heading-0">MCPæ˜¯ä»€ä¹ˆ</h2>
<p>å¦‚æœæˆ‘ä»¬è®¤ä¸º <strong>LLM</strong>(å¤§è¯­è¨€æ¨¡å‹) æ˜¯<strong>å¤§è„‘</strong>çš„è¯ï¼Œ <strong>MCP</strong> æä¾›å…¶å®ƒçš„èƒ½åŠ›å°†ç»™è¿™ä¸ªå¤§è„‘è£…ä¸Š<strong>å››è‚¢å’Œäº”å®˜</strong>ï¼Œä½¿å¾—å®ƒå…·å¤‡ä¸å¤–ç•Œç¯å¢ƒäº¤äº’çš„èƒ½åŠ›ã€‚</p>
<p>ä½¿ç”¨ MCPï¼ŒClaude æˆ– ChatGPT ç­‰ AI åº”ç”¨ç¨‹åºå¯ä»¥è¿æ¥åˆ°æ•°æ®æºï¼ˆä¾‹å¦‚æœ¬åœ°æ–‡ä»¶ã€æ•°æ®åº“ï¼‰ã€å·¥å…·ï¼ˆä¾‹å¦‚æœç´¢å¼•æ“ã€è®¡ç®—å™¨ï¼‰å’Œå·¥ä½œæµï¼ˆä¾‹å¦‚ï¼šå¤æ‚ä»»åŠ¡ä¸­é—´ä¸€ä¸ªç¯èŠ‚ç”¨åˆ°çš„æç¤ºè¯ï¼‰ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c4c4206471c74a6b9e801261449f8d06~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YiY56uL5Yab:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766288979&amp;x-signature=vk%2BAUdR3YafsM7opswcq%2FQj91vc%3D" alt="MCPåŠŸèƒ½ç¤ºæ„å›¾" loading="lazy"/></p>
<p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼ŒMCPæœ‰ä»¥ä¸‹é‡è¦ç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>åŒå‘é€šä¿¡</strong>: ä½¿ç”¨MCPè¿æ¥çš„AIåº”ç”¨å’Œå„ç§å·¥å…·çš„äº¤äº’æ˜¯ <strong>åŒå‘çš„</strong> ï¼šAIå·¥å…·å¯ä»¥è®¿é—®å·¥å…·ï¼Œè€Œåé¢çš„å·¥å…·ä¹Ÿå¯ä»¥ä¸»åŠ¨è®¿é—®AIåº”ç”¨ï¼Œè¿™ä¸å¸¸ç”¨çš„APIçš„å•å‘è°ƒç”¨ä¸åŒã€‚</li>
<li><strong>åŠŸèƒ½å¼ºå¤§</strong>ï¼šå®ƒä¸æ­¢æä¾›æˆ‘ä»¬æœ€å®¹æ˜“æƒ³è±¡çš„APIè°ƒç”¨èƒ½åŠ›ï¼Œè¿˜å¯ä»¥ä¸æœ¬åœ°å’Œè¿œç¨‹æ•°æ®æºååŒå·¥ä½œï¼Œç”šè‡³å°†äººç±»ã€æ™ºèƒ½ä½“/agentå’Œå¤–éƒ¨ä¸–ç•Œè¿æ¥èµ·æ¥ã€‚</li>
</ul>
<h2 data-id="heading-1">MCPæ¶æ„</h2>
<p><strong>MCP</strong> æ˜¯<strong>CS(Client-Server)æ¶æ„</strong> ã€‚<br/>
MCP Host/ä¸»æœºï¼ˆä¾‹å¦‚ <code>Claude Code</code> æˆ– <code>Claude Desktop</code> ç­‰ AI åº”ç”¨ç¨‹åºï¼‰ä¼šä¸ä¸€ä¸ªæˆ–å¤šä¸ª <strong>MCP</strong> æœåŠ¡ç«¯å»ºç«‹è¿æ¥ã€‚MCP ä¸»æœºé€šè¿‡ä¸ºæ¯ä¸ª MCP æœåŠ¡ç«¯åˆ›å»ºä¸€ä¸ª MCP å®¢æˆ·ç«¯æ¥å®ç°è¿™ä¸€ç‚¹ï¼šæ¯ä¸ª MCP å®¢æˆ·ç«¯éƒ½ä¸å…¶å¯¹åº”çš„ MCP æœåŠ¡ç«¯ä¿æŒä¸€å¯¹ä¸€çš„ä¸“ç”¨è¿æ¥ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f6ece69e7dc485d9477d7b07d33a14d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YiY56uL5Yab:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766288979&amp;x-signature=S6dUQbU1ySuVD%2BUf7bB8Hu4ydN0%3D" alt="MCPæ¶æ„" loading="lazy"/></p>
<p>ä¾‹å¦‚ï¼šç”¨ <code>Visual Studio Code</code> å……å½“ MCP ä¸»æœºã€‚å½“ Visual Studio Code å»ºç«‹ä¸ MCP æœåŠ¡ç«¯ï¼ˆä¾‹å¦‚ Sentry MCP æœåŠ¡ç«¯ï¼‰çš„è¿æ¥æ—¶ï¼ŒVisual Studio Code è¿è¡Œæ—¶ä¼šå®ä¾‹åŒ–ä¸€ä¸ª MCP å®¢æˆ·ç«¯å¯¹è±¡ï¼Œç”¨äºç»´æŠ¤ä¸ Sentry MCP æœåŠ¡ç«¯çš„è¿æ¥ã€‚å½“ Visual Studio Code éšåè¿æ¥åˆ°å¦ä¸€ä¸ª MCP æœåŠ¡ç«¯ï¼ˆä¾‹å¦‚æœ¬åœ°æ–‡ä»¶ç³»ç»ŸæœåŠ¡ç«¯ï¼‰æ—¶ï¼ŒVisual Studio Code è¿è¡Œæ—¶ä¼šå®ä¾‹åŒ–å¦ä¸€ä¸ª MCP å®¢æˆ·ç«¯å¯¹è±¡æ¥ç»´æŠ¤æ­¤è¿æ¥ï¼Œä»è€Œä¿æŒ MCP å®¢æˆ·ç«¯ä¸ MCP æœåŠ¡ç«¯ä¹‹é—´çš„ä¸€å¯¹ä¸€å…³ç³»ã€‚</p>
<blockquote>
<p>åé¢çš„æ–‡ç« å°†ä½¿ç”¨<code>Visual Studio Code</code>è¿›è¡Œä¸Šè¿°åœºæ™¯çš„å®æˆ˜æ¼”ç»ƒã€‚</p>
</blockquote>
<h2 data-id="heading-2">æœåŠ¡ç«¯</h2>
<p>MCP æœåŠ¡ç«¯å¸¸è§çš„åŠŸèƒ½åŒ…æ‹¬ï¼šç”¨äºæ–‡æ¡£è®¿é—®çš„æ–‡ä»¶ç³»ç»ŸæœåŠ¡ç«¯ã€ç”¨äºæ•°æ®æŸ¥è¯¢çš„æ•°æ®åº“æœåŠ¡ç«¯ã€ç”¨äºä»£ç ç®¡ç†çš„ GitHub æœåŠ¡ç«¯ã€ç”¨äºå›¢é˜Ÿæ²Ÿé€šçš„ Slack æœåŠ¡ç«¯ä»¥åŠç”¨äºæ—¥ç¨‹å®‰æ’çš„æ—¥å†æœåŠ¡ç«¯ã€‚</p>

























<table><thead><tr><th align="left">åŠŸèƒ½</th><th align="left">è¯´æ˜</th><th align="left">ä¾‹å­</th></tr></thead><tbody><tr><td align="left">å·¥å…·/tools</td><td align="left">å¤§æ¨¡å‹å¯ä»¥ä¸»åŠ¨è°ƒç”¨çš„å‡½æ•°ï¼Œå¹¶æ ¹æ®ç”¨æˆ·è¯·æ±‚å†³å®šä½•æ—¶ä½¿ç”¨å®ƒä»¬ã€‚å·¥å…·å¯ä»¥å†™å…¥æ•°æ®åº“ã€è°ƒç”¨å¤–éƒ¨ APIã€ä¿®æ”¹æ–‡ä»¶æˆ–è§¦å‘å…¶ä»–é€»è¾‘</td><td align="left">æœç´¢èˆªç­ã€å‘é€æ¶ˆæ¯ã€åˆ›å»ºæ—¥å†æ´»åŠ¨ã€‚</td></tr><tr><td align="left">èµ„æº/resources</td><td align="left">æä¾›å¯¹æ–‡ä»¶å†…å®¹ã€æ•°æ®åº“æ¨¡å¼æˆ– API æ–‡æ¡£ç­‰æ•°æ®æºçš„åªè¯»è®¿é—®ã€‚</td><td align="left">æ£€ç´¢æ–‡æ¡£ã€è®¿é—®çŸ¥è¯†åº“ã€é˜…è¯»æ—¥å†</td></tr><tr><td align="left">æç¤ºè¯æ¨¡æ¿/prompts</td><td align="left">é¢„å…ˆæ„å»ºçš„æŒ‡ä»¤æ¨¡æ¿ï¼Œå®ƒå‘Šè¯‰å¤§æ¨¡å‹ä½¿ç”¨ç‰¹å®šçš„å·¥å…·å’Œèµ„æºã€‚</td><td align="left">è®¡åˆ’å‡æœŸã€æ€»ç»“æˆ‘çš„ä¼šè®®ã€èµ·è‰ç”µå­é‚®ä»¶</td></tr></tbody></table>
<p><strong>æç¤ºè¯æ¨¡æ¿</strong> æ˜¯ç”±ç”¨æˆ·æ§åˆ¶è€Œéä¸»åŠ¨è§¦å‘çš„ï¼šæœåŠ¡ç«¯é¢„å®šä¹‰æç¤ºè¯æ¨¡æ¿-&gt;ç”¨æˆ·è¾“å…¥æç¤ºæ­¤æ¨¡æ¿éœ€è¦çš„å‚æ•°-&gt; æœåŠ¡ç«¯è¿”å›æç¤ºè¯è®©å¤§æ¨¡å‹å¤„ç†ã€‚<br/>
ä¾‹å¦‚ï¼šåœ¨æ—…è¡Œè§„åˆ’åœºæ™¯ä¸­ï¼ŒæœåŠ¡ç«¯ä¼šæå‰å®šä¹‰å¥½æç¤ºè¯æ¨¡æ¿ï¼Œå…¶ä¸­åŒ…å«å‚æ•°ï¼š<code>å‡ºå‘åœ°ã€ç›®çš„åœ°</code>ï¼Œå½“ç”¨æˆ·è¾“å…¥<code>å‡ºå‘åœ°ã€ç›®çš„åœ°</code>åï¼ŒæœåŠ¡ç«¯æ‰ä¼šä½¿ç”¨è¿™ä¸¤ä¸ªå‚æ•°å¡«å……æç¤ºæ­¤æ¨¡æ¿ï¼Œç”Ÿæˆæç¤ºè¯è¿”å›ã€‚</p>
<h2 data-id="heading-3">å®¢æˆ·ç«¯</h2>
<p><strong>MCPå®¢æˆ·ç«¯</strong> ç”± ä¸»æœº/MCP Host åº”ç”¨ç¨‹åºå®ä¾‹åŒ–ï¼Œç”¨äºä¸ç‰¹å®šçš„ MCP æœåŠ¡å™¨é€šä¿¡ã€‚ä¸»æœºåº”ç”¨ç¨‹åºï¼ˆä¾‹å¦‚ Claude.ai æˆ– IDEï¼‰è´Ÿè´£ç®¡ç†æ•´ä½“ç”¨æˆ·ä½“éªŒå¹¶åè°ƒå¤šä¸ªå®¢æˆ·ç«¯ã€‚æ¯ä¸ªå®¢æˆ·ç«¯å¤„ç†ä¸ä¸€å°æœåŠ¡å™¨çš„ç›´æ¥é€šä¿¡ã€‚<br/>
ä¸¤è€…çš„åŒºåˆ«è‡³å…³é‡è¦ï¼š<strong>ä¸»æœºæ˜¯ç”¨æˆ·ä¸ä¹‹äº¤äº’çš„åº”ç”¨ç¨‹åº</strong>ï¼Œè€Œ<strong>å®¢æˆ·ç«¯æ˜¯æ”¯æŒæœåŠ¡å™¨è¿æ¥çš„ç»„ä»¶</strong>ã€‚<br/>
MCPå®¢æˆ·ç«¯é™¤äº†ä¸MCPæœåŠ¡ç«¯é€šä¿¡ä»¥å¤–ï¼Œè¿˜è¿æ¥äº†ç”¨æˆ·/äººå’Œå¤§è¯­è¨€æ¨¡å‹/LLMï¼›åœ¨äº¤äº’è¿‡ç¨‹ä¸­ï¼Œé™¤äº†å¯ä»¥<strong>é™åˆ¶å¯¹èµ„æºçš„è®¿é—®</strong>ä»¥å¤–ï¼Œå¯ä»¥è¿›è¡Œ<strong>äººä¸ºå®¡æ ¸å’Œçº æ­£</strong>ã€‚</p>

























<table><thead><tr><th align="left">åŠŸèƒ½</th><th align="left">è¯´æ˜</th><th align="left">ä¾‹å­</th></tr></thead><tbody><tr><td align="left">é‡‡æ ·/Sampling</td><td align="left">MCPæœåŠ¡ç«¯é€šè¿‡MCPå®¢æˆ·ç«¯è¯·æ±‚å¤§æ¨¡å‹å®Œæˆä»»åŠ¡/LLM completionsï¼Œä»è€Œå®ç°æ™ºèƒ½ä½“çš„å·¥ä½œæµã€‚è¿™ç§æ–¹æ³•ä½¿å®¢æˆ·ç«¯èƒ½å¤Ÿå®Œå…¨æ§åˆ¶ç”¨æˆ·æƒé™å’Œå®‰å…¨ã€‚</td><td align="left">é¢„è®¢æ—…è¡Œçš„MCPæœåŠ¡ç«¯å¯èƒ½ä¼šå‘ å¤§æ¨¡å‹/LLM å‘é€èˆªç­åˆ—è¡¨ï¼Œå¹¶è¯·æ±‚ å¤§æ¨¡å‹ ä¸ºç”¨æˆ·æŒ‘é€‰æœ€ä½³èˆªç­ã€‚</td></tr><tr><td align="left">æ ¹/Roots</td><td align="left">å…è®¸å®¢æˆ·ç«¯æŒ‡å®šMCPæœåŠ¡ç«¯å¯ä»¥è®¿é—®å“ªäº›æ–‡ä»¶ï¼Œå¼•å¯¼å®ƒä»¬åˆ°ç›¸å…³ç›®å½•ï¼ŒåŒæ—¶ä¿æŒå®‰å…¨è¾¹ç•Œã€‚</td><td align="left">é¢„è®¢æ—…è¡Œçš„MCPæœåŠ¡ç«¯å¯èƒ½ä¼šè¢«æˆäºˆè®¿é—®ç‰¹å®šç›®å½•çš„æƒé™ï¼Œä»è€Œå¯ä»¥ä»ä¸­è¯»å–ç”¨æˆ·çš„æ—¥å†ã€‚</td></tr><tr><td align="left">è·å–/Elicitation</td><td align="left">ä½¿MCPæœåŠ¡ç«¯èƒ½å¤Ÿåœ¨äº¤äº’è¿‡ç¨‹ä¸­å‘ç”¨æˆ·è¯·æ±‚ç‰¹å®šä¿¡æ¯ã€‚</td><td align="left">é¢„è®¢æ—…è¡Œçš„MCPæœåŠ¡ç«¯å¯èƒ½ä¼šè¯¢é—®ç”¨æˆ·å¯¹é£æœºåº§ä½ã€æˆ¿é—´ç±»å‹æˆ–è”ç³»ç”µè¯çš„åå¥½ï¼Œä»¥å®Œæˆé¢„è®¢ã€‚</td></tr></tbody></table>
<blockquote>
<p>ä¸Šè¿°æ¦‚å¿µä¸å®¹æ˜“ç†è§£ï¼Œå°¤å…¶æ˜¯ <code>Sampling</code> å’Œæˆ‘ä»¬ç›´è§‚çš„æƒ³è±¡çš„ <code>é‡‡æ ·</code> ä¸æ˜¯åŒæ ·çš„æ„æ€ï¼Œæˆ‘è§‰å¾—æœªæ¥æœ‰å¯èƒ½ä¼šæ”¹æ‰è¿™äº›ä»¤äººè´¹è§£çš„å«æ³•ã€‚<br/>
å¦‚æœé—®å„ç§AIå¹³å°ï¼šâ€œMCPä¸­çš„Samplingæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿâ€ï¼Œé€šå¸¸ä¼šä½“éªŒåˆ°å¤§æ¨¡å‹çš„â€œå¹»è§‰â€ï¼Œå¤§æ¨¡å‹ä¼šæ‡µæ‰ï¼šï¼‰</p>
</blockquote>
<p>é‰´äºä¸Šè¿°æ¦‚å¿µç”¨ä¸­æ–‡ç†è§£æœ‰ä¸€å®šéš¾åº¦ï¼Œä¸‹é¢æˆ‘ä»¬å†ä¸€èµ·å­¦ä¹ ä¸€ä¸‹è¿™äº›åŠŸèƒ½çš„å«ä¹‰ã€‚</p>
<h3 data-id="heading-4">é‡‡æ ·/Sampling</h3>
<p>è¿™é‡Œçš„ <strong>é‡‡æ ·/Sampling</strong> å¹¶ä¸æ˜¯ éšæœºæŠ½å–æ ·æœ¬ çš„æ„æ€ï¼Œè€Œæ˜¯ç”± MCPæœåŠ¡ç«¯ ä¸»åŠ¨å‘èµ·çš„ï¼Œè¯·æ±‚å¤§æ¨¡å‹å®Œæˆçš„ä»»åŠ¡çš„è¡Œä¸ºã€‚MCPå®¢æˆ·ç«¯åœ¨æ„é€ å®¢æˆ·ç«¯æ—¶ï¼Œå¯ä»¥è®¢é˜…MCPæœåŠ¡ç«¯çš„Samplingäº‹ä»¶ã€‚<br/>
æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢ç®€å•çš„ä»£ç ç‰‡æ®µè¿›ä¸€æ­¥ç†è§£è¿™ä¸€ç‚¹ï¼š</p>
<p><strong>MCPæœåŠ¡ç«¯</strong>ï¼šå‘MCPå®¢æˆ·ç«¯å‘é€ <code>SamplingMessage</code> æ¶ˆæ¯ï¼Œå³åŸè¯—ä¸€é¦–ï¼Œç„¶åå¾—åˆ°MCPå®¢æˆ·ç«¯è¿”å›çš„ç»“æœã€‚</p>
<pre><code class="hljs language-python" lang="python">mcp = FastMCP(name=<span class="hljs-string">"Sampling Example"</span>)


<span class="hljs-meta">@mcp.tool()</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_poem</span>(<span class="hljs-params">topic: <span class="hljs-built_in">str</span>, ctx: Context[ServerSession, <span class="hljs-literal">None</span>]</span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""Generate a poem using LLM sampling."""</span>
    prompt = <span class="hljs-string">f"Write a short poem about <span class="hljs-subst">{topic}</span>"</span>

    result = <span class="hljs-keyword">await</span> ctx.session.create_message(
        messages=[
            SamplingMessage(
                role=<span class="hljs-string">"user"</span>,
                content=TextContent(<span class="hljs-built_in">type</span>=<span class="hljs-string">"text"</span>, text=prompt),
            )
        ],
        max_tokens=<span class="hljs-number">100</span>,
    )

    <span class="hljs-keyword">if</span> result.content.<span class="hljs-built_in">type</span> == <span class="hljs-string">"text"</span>:
        <span class="hljs-keyword">return</span> result.content.text
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(result.content)
</code></pre>
<p><strong>MCPå®¢æˆ·ç«¯</strong>ï¼šè®¢é˜…MCPæœåŠ¡ç«¯çš„ <code>SamplingMessage</code> æ¶ˆæ¯ï¼Œè°ƒç”¨å¤§æ¨¡å‹ä½œè¯—åï¼Œè¿”å›ç»™MCPæœåŠ¡ç«¯ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_sampling_message</span>(<span class="hljs-params">
    context: RequestContext[ClientSession, <span class="hljs-literal">None</span>], params: types.CreateMessageRequestParams
</span>) -&gt; types.CreateMessageResult:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Sampling request: <span class="hljs-subst">{params.messages}</span>"</span>)

    poem = <span class="hljs-string">"..."</span>  <span class="hljs-comment"># è°ƒç”¨å¤§æ¨¡å‹ä½œè¯—</span>
    
    <span class="hljs-keyword">return</span> types.CreateMessageResult(
        role=<span class="hljs-string">"assistant"</span>,
        content=types.TextContent(
            <span class="hljs-built_in">type</span>=<span class="hljs-string">"text"</span>,
            text=poem,
        ),
        model=<span class="hljs-string">"qwen3"</span>,
        stopReason=<span class="hljs-string">"endTurn"</span>,
    )

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>():
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> stdio_client(server_params) <span class="hljs-keyword">as</span> (read, write):
        <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> ClientSession(read, write, sampling_callback=handle_sampling_message) <span class="hljs-keyword">as</span> session:
            <span class="hljs-comment"># Initialize the connection</span>
            <span class="hljs-keyword">await</span> session.initialize()

            <span class="hljs-comment"># ...</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    <span class="hljs-string">"""Entry point for the client script."""</span>
    asyncio.run(run())


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    main()
</code></pre>
<p>åœ¨æ›´åŠ å¤æ‚çš„åœºæ™¯ä¸­ï¼Œåœ¨ <code>é‡‡æ ·/Sampling</code> çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ç”±äººæ¥å¹²é¢„ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/27e996a4216f4f8196e5c2d8e258398a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YiY56uL5Yab:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766288979&amp;x-signature=DxLOXd5aPynJhI6as5PJeWd0ei0%3D" alt="é‡‡æ ·/Sampling" loading="lazy"/></p>
<p>ä¸Šè¿°åœºæ™¯æè¿°äº†ï¼šåœ¨MCPæœåŠ¡ç«¯è¯·æ±‚å¤§æ¨¡å‹ä¹‹å‰ï¼Œäººå¯ä»¥æ‰¹å‡†æ˜¯å¦æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹æç¤ºè¯ï¼›åœ¨å¤§æ¨¡å‹æ‰§è¡Œå®Œæç¤ºè¯åï¼Œäººå¯ä»¥æ‰¹å‡†å¤§æ¨¡å‹æ‰§è¡Œç»“æœæ˜¯å¦è¿”å›ç»™MCPæœåŠ¡ç«¯ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹æ­¤ç»“æœåå†ç»™MCPæœåŠ¡ç«¯ã€‚</p>
<h3 data-id="heading-5">è·å–/Elicitation</h3>
<p><strong>è·å–/Elicitation</strong> ä½¿MCPæœåŠ¡ç«¯èƒ½å¤Ÿåœ¨äº¤äº’è¿‡ç¨‹ä¸­å‘ç”¨æˆ·è¯·æ±‚ç‰¹å®šä¿¡æ¯ï¼Œä»è€Œåˆ›å»ºæ›´å…·åŠ¨æ€æ€§å’Œå“åº”èƒ½åŠ›çš„å·¥ä½œæµã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼šæœåŠ¡å™¨æ— éœ€é¢„å…ˆæ”¶é›†æ‰€æœ‰ä¿¡æ¯ï¼Œä¹Ÿæ— éœ€åœ¨æ•°æ®ç¼ºå¤±æ—¶åœæ­¢è¿è¡Œï¼Œè€Œæ˜¯å¯ä»¥æš‚åœè¿è¡Œä»¥è¯·æ±‚ç”¨æˆ·çš„ç‰¹å®šè¾“å…¥ã€‚</p>
<p>ä¾‹å¦‚ï¼šåœ¨é¢„å®šæœºç¥¨åœºæ™¯ä¸­ï¼ŒMCPæœåŠ¡ç«¯å¯ä»¥è¯·æ±‚ç”¨æˆ·è¾“å…¥èˆªç­å·ã€èˆªç­æ—¥æœŸç­‰ä¿¡æ¯ï¼Œè¿™æ ·ç¡®è®¤åï¼Œå†ç”±MCPæœåŠ¡ç«¯è®¢ç¥¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/561fb89fe0eb4d87b5d74990b82a541b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YiY56uL5Yab:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766288979&amp;x-signature=gqvZAQI3YkEgUq0dEBa0cSOi%2FdY%3D" alt="è·å–/Elicitation" loading="lazy"/></p>
<h2 data-id="heading-6">æ€»ç»“</h2>
<p>é€šè¿‡å¯¹MCPæ›´å¤šäº†è§£ï¼Œå¯ä»¥å‘ç°ï¼š <strong>MCP</strong> å¯ä»¥æŠŠå¤§è„‘ï¼ˆå¤§è¯­è¨€æ¨¡å‹ï¼‰å’Œå„ç§èƒ½åŠ›ï¼ˆäº”å®˜å’Œå››è‚¢ï¼‰ç²˜åˆèµ·æ¥ï¼Œå˜æˆä¸€ä¸ª<strong>æ™ºèƒ½ä½“/agent</strong>ã€‚</p>
<hr/>
<p><strong>å‚è€ƒ</strong>:</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io%2F" target="_blank" title="https://modelcontextprotocol.io/" ref="nofollow noopener noreferrer">MCPå®˜ç½‘</a></li>
</ul>
<p>ğŸªç¥å¥½è¿ğŸª</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨å®æˆ˜ä¸­è¿ç”¨æ³›å‹å’ŒåŠ¨æ€traitï¼ˆç‰¹è´¨ï¼‰]]></title>    <link>https://juejin.cn/post/7582905804048957467</link>    <guid>https://juejin.cn/post/7582905804048957467</guid>    <pubDate>2025-12-14T03:49:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582905804048957467" data-draft-id="7581667332306763814" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨å®æˆ˜ä¸­è¿ç”¨æ³›å‹å’ŒåŠ¨æ€traitï¼ˆç‰¹è´¨ï¼‰"/> <meta itemprop="keywords" content="è®¾è®¡æ¨¡å¼"/> <meta itemprop="datePublished" content="2025-12-14T03:49:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ²æ£®"/> <meta itemprop="url" content="https://juejin.cn/user/4455643804079608"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨å®æˆ˜ä¸­è¿ç”¨æ³›å‹å’ŒåŠ¨æ€traitï¼ˆç‰¹è´¨ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4455643804079608/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ²æ£®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T03:49:00.000Z" title="Sun Dec 14 2025 03:49:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»16åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><code>PhantomData&lt;T&gt;</code></h2>
<p>// å…ˆè‡ªå®šä¹‰ä¸€ä¸ªæ•°æ®ç»“æ„</p>
<pre><code class="hljs language-js" lang="js">
#[<span class="hljs-title function_">derive</span>(<span class="hljs-title class_">Debug</span>, <span class="hljs-title class_">Default</span>, <span class="hljs-title class_">PartialEq</span>, <span class="hljs-title class_">Eq</span>)]
pub struct <span class="hljs-title class_">Identifier</span>&lt;T&gt;{
   <span class="hljs-attr">inner</span>:u64,
}
</code></pre>
<p>//ç„¶ååœ¨Userå’ŒProductï¼Œå„è‡ªç”¨Identifier&gt; æ¥è®© Identifier å’Œè‡ªå·±çš„ç±»å‹ç»‘å®šï¼Œè¾¾åˆ°è®©ä¸åŒç±»å‹çš„ id æ— æ³•æ¯”è¾ƒçš„ç›®çš„</p>
<pre><code class="hljs language-js" lang="js">    
  #[<span class="hljs-title function_">derive</span>(<span class="hljs-title class_">Debug</span>, <span class="hljs-title class_">Default</span>, <span class="hljs-title class_">PartialEq</span>, <span class="hljs-title class_">Eq</span>)]
pub struct <span class="hljs-title class_">User</span> {
<span class="hljs-attr">id</span>: <span class="hljs-title class_">Identifier</span>&lt;<span class="hljs-title class_">Self</span>&gt;,<span class="hljs-comment">//selfå…¶å®å°±æ˜¯User</span>
}
#[<span class="hljs-title function_">derive</span>(<span class="hljs-title class_">Debug</span>, <span class="hljs-title class_">Default</span>, <span class="hljs-title class_">PartialEq</span>, <span class="hljs-title class_">Eq</span>)]
pub struct <span class="hljs-title class_">Product</span> {
<span class="hljs-attr">id</span>: <span class="hljs-title class_">Identifier</span>&lt;<span class="hljs-title class_">Self</span>&gt;,<span class="hljs-comment">//selfå…¶å®å°±æ˜¯Product</span>
}  
    
</code></pre>
<p>æä¸ªæµ‹è¯•ç”¨ä¾‹</p>
<pre><code class="hljs language-js" lang="js">
#[<span class="hljs-title function_">cfg</span>(test)]
mod tests {
use <span class="hljs-attr">super</span>::*;
#[test]
fn <span class="hljs-title function_">id_should_not_be_the_same</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">let</span> user = <span class="hljs-title class_">User</span>::<span class="hljs-title function_">default</span>();
     <span class="hljs-keyword">let</span> product = <span class="hljs-title class_">Product</span>::<span class="hljs-title function_">default</span>();
    <span class="hljs-comment">// ä¸¤ä¸ª id ä¸èƒ½æ¯”è¾ƒï¼Œå› ä¸ºä»–ä»¬å±äºä¸åŒçš„ç±»å‹</span>
    <span class="hljs-comment">// assert_ne!(user.id, product.id);</span>
    assert_eq!(user.<span class="hljs-property">id</span>.<span class="hljs-property">inner</span>, product.<span class="hljs-property">id</span>.<span class="hljs-property">inner</span>);
  }
}


</code></pre>
<p><strong>æµ‹è¯•ç»“è®ºï¼šç¼–è¯‘ç›´æ¥æŠ¥é”™</strong></p>
<p>åœ¨ Rust çš„ç±»å‹ç³»ç»Ÿä¸­å› ä¸º Identifier åœ¨å®šä¹‰æ—¶ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨æ³›å‹å‚æ•° Tï¼Œç¼–è¯‘å™¨è®¤ä¸º T æ˜¯å¤šä½™çš„ï¼Œæ‰€ä»¥åªèƒ½æŠŠ T åˆ é™¤æ‰æ‰èƒ½ç¼–è¯‘é€šè¿‡ã€‚ä½†æ˜¯ï¼Œåˆ é™¤æ‰ Tï¼ŒUser å’Œ Product çš„ id å°±å¯ä»¥æ¯”è¾ƒäº†</p>
<h3 data-id="heading-1">åˆ æ‰ T åçš„ä»£ç é•¿ä»€ä¹ˆæ ·ï¼Ÿ</h3>
<p>å¦‚æœä½ ä¸ºäº†ç¼–è¯‘é€šè¿‡ï¼ŒæŠŠæ³›å‹Â <code>T</code>Â å’ŒÂ <code>PhantomData</code>Â éƒ½åˆ äº†ï¼Œä»£ç å˜æˆäº†è¿™æ ·ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// 1. Identifier ç°åœ¨åªæ˜¯ä¸€ä¸ªæ™®é€šçš„ç»“æ„ä½“ï¼Œæ²¡æœ‰ä»»ä½•æ³›å‹æ ‡è®°</span>
<span class="hljs-meta">#[derive(Debug, Default, PartialEq, Eq)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Identifier</span> {
    inner: <span class="hljs-type">u64</span>,
}

<span class="hljs-comment">// 2. User é‡Œé¢æ”¾çš„æ˜¯ Identifier</span>
<span class="hljs-meta">#[derive(Debug, Default, PartialEq, Eq)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">User</span> {
    id: Identifier, 
}

<span class="hljs-comment">// 3. Product é‡Œé¢æ”¾çš„ä¹Ÿæ˜¯ Identifier</span>
<span class="hljs-meta">#[derive(Debug, Default, PartialEq, Eq)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Product</span> {
    id: Identifier, 
}
</code></pre>
<h3 data-id="heading-2">ä¸ºä»€ä¹ˆè¿™æ—¶å€™å¯ä»¥æ¯”è¾ƒäº†ï¼Ÿ</h3>
<p>å½“ä½ å†™Â <code>assert_eq!(user.id, product.id)</code>Â æ—¶ï¼ŒRust ç¼–è¯‘å™¨åšçš„æ˜¯<strong>ç±»å‹åŒ¹é…</strong>ã€‚</p>
<ul>
<li><strong>å·¦è¾¹</strong>ï¼š<code>user.id</code>ã€‚å®ƒçš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯Â <code>Identifier</code>ã€‚</li>
<li><strong>å³è¾¹</strong>ï¼š<code>product.id</code>ã€‚å®ƒçš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿä¹Ÿæ˜¯Â <code>Identifier</code>ã€‚</li>
<li><strong>ç¼–è¯‘å™¨åˆ¤æ–­</strong>ï¼š<code>Identifier</code>Â å’ŒÂ <code>Identifier</code>Â æ˜¯åŒä¸€ä¸ªç±»å‹å—ï¼Ÿ<strong>æ˜¯ï¼</strong></li>
</ul>
<p>æ—¢ç„¶ç±»å‹ç›¸åŒï¼Œè€Œä¸”ä½ å®ç°äº†Â <code>PartialEq</code>ï¼Œç¼–è¯‘å™¨å°±ä¼šå»æ¯”è¾ƒé‡Œé¢çš„å€¼ (<code>inner</code>)ã€‚å› ä¸ºéƒ½æ˜¯é»˜è®¤å€¼ 0ï¼Œæ‰€ä»¥å®ƒä»¬ç›¸ç­‰ã€‚</p>
<h3 data-id="heading-3">æ ¸å¿ƒè¯¯åŒºï¼šçˆ¶ç»“æ„ä½“ä¸ä¼šâ€œæ±¡æŸ“â€å­å­—æ®µ</h3>
<p>ä½ ä¹‹å‰çš„å›°æƒ‘ç‚¹åœ¨äºï¼š</p>
<blockquote>
<p>â€œUser å’Œ Product æ˜¯ä¸åŒçš„ structï¼Œé‚£å®ƒä»¬é‡Œé¢çš„ id ä¸ä¹Ÿåº”è¯¥ä¸åŒå—ï¼Ÿâ€</p>
</blockquote>
<p><strong>æ‰“ä¸ªæ¯”æ–¹ï¼š</strong></p>
<ul>
<li><strong>User</strong>Â æ˜¯ä¸€ä¸ªÂ <strong>çº¢è‰²çš„ç›’å­</strong>ã€‚</li>
<li><strong>Product</strong>Â æ˜¯ä¸€ä¸ªÂ <strong>è“è‰²çš„ç›’å­</strong>ã€‚</li>
<li><strong>Identifier (æ— æ³›å‹)</strong> Â æ˜¯Â <strong>ä¸€æ”¯é“…ç¬”</strong>ã€‚</li>
</ul>
<p>ç°åœ¨ï¼š</p>
<ol>
<li>ä½ åœ¨çº¢è‰²ç›’å­é‡Œæ”¾äº†ä¸€æ”¯é“…ç¬”ã€‚</li>
<li>ä½ åœ¨è“è‰²ç›’å­é‡Œæ”¾äº†ä¸€æ”¯é“…ç¬”ã€‚</li>
<li>ä½ æŠŠä¸¤æ”¯é“…ç¬”æ‹¿å‡ºæ¥å¯¹æ¯”ï¼š<strong>å®ƒä»¬æ˜¯ä¸€æ ·çš„é“…ç¬”å—ï¼Ÿ</strong></li>
</ol>
<p><strong>ç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚</strong> Â ç›’å­ï¼ˆstructï¼‰ä¸åŒï¼Œä¸ä»£è¡¨ç›’å­é‡Œçš„ä¸œè¥¿ï¼ˆfieldï¼‰å˜æˆäº†ä¸åŒçš„ç±»å‹ã€‚é™¤éä½ åœ¨é“…ç¬”ä¸Šåˆ»å­—ï¼ˆè¿™å°±æ˜¯æ³›å‹çš„ä½œç”¨ï¼‰</p>
<h3 data-id="heading-4">ç°åœ¨æˆ‘ä»¬æ·»åŠ ä¸Š<code>PhantomData&lt;T&gt;</code></h3>
<p>å½“æˆ‘ä»¬æŠŠÂ <code>PhantomData&lt;T&gt;</code>Â å’ŒÂ <code>Identifier&lt;T&gt;</code>Â åŠ å›æ¥æ—¶ï¼Œç›¸å½“äºæˆ‘ä»¬<strong>ç»™é“…ç¬”åˆ»äº†å­—</strong></p>
<pre><code class="hljs language-js" lang="js">    
    use <span class="hljs-attr">std</span>::<span class="hljs-attr">marker</span>::<span class="hljs-title class_">PhantomData</span>;
#[<span class="hljs-title function_">derive</span>(<span class="hljs-title class_">Debug</span>, <span class="hljs-title class_">Default</span>, <span class="hljs-title class_">PartialEq</span>, <span class="hljs-title class_">Eq</span>)]
pub struct <span class="hljs-title class_">Identifier</span>&lt;T&gt; {
<span class="hljs-attr">inner</span>: u64,
<span class="hljs-attr">_tag</span>: <span class="hljs-title class_">PhantomData</span>&lt;T&gt;,
}
#[<span class="hljs-title function_">derive</span>(<span class="hljs-title class_">Debug</span>, <span class="hljs-title class_">Default</span>, <span class="hljs-title class_">PartialEq</span>, <span class="hljs-title class_">Eq</span>)]
pub struct <span class="hljs-title class_">User</span> {
<span class="hljs-attr">id</span>: <span class="hljs-title class_">Identifier</span>&lt;<span class="hljs-title class_">Self</span>&gt;,
}
#[<span class="hljs-title function_">derive</span>(<span class="hljs-title class_">Debug</span>, <span class="hljs-title class_">Default</span>, <span class="hljs-title class_">PartialEq</span>, <span class="hljs-title class_">Eq</span>)]
pub struct <span class="hljs-title class_">Product</span> {
<span class="hljs-attr">id</span>: <span class="hljs-title class_">Identifier</span>&lt;<span class="hljs-title class_">Self</span>&gt;,
}
#[<span class="hljs-title function_">cfg</span>(test)]
mod tests {
use <span class="hljs-attr">super</span>::*;
#[test]
fn <span class="hljs-title function_">id_should_not_be_the_same</span>(<span class="hljs-params"/>) {
<span class="hljs-keyword">let</span> user = <span class="hljs-title class_">User</span>::<span class="hljs-title function_">default</span>();
<span class="hljs-keyword">let</span> product = <span class="hljs-title class_">Product</span>::<span class="hljs-title function_">default</span>();
<span class="hljs-comment">// ä¸¤ä¸ª id ä¸èƒ½æ¯”è¾ƒï¼Œå› ä¸ºä»–ä»¬å±äºä¸åŒçš„ç±»å‹</span>
<span class="hljs-comment">// assert_ne!(user.id, product.id);</span>
assert_eq!(user.<span class="hljs-property">id</span>.<span class="hljs-property">inner</span>, product.<span class="hljs-property">id</span>.<span class="hljs-property">inner</span>);
}
    
    
</code></pre>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">-</span>   <span class="hljs-code">`User`</span>Â é‡Œçš„Â <span class="hljs-code">`id`</span>Â ç±»å‹å˜æˆäº†Â <span class="hljs-code">`Identifier&lt;User&gt;`</span>Â ï¼ˆåˆ»ç€â€œç”¨æˆ·ä¸“ç”¨â€çš„é“…ç¬”ï¼‰ã€‚
</code></pre>
<ul>
<li><code>Product</code>Â é‡Œçš„Â <code>id</code>Â ç±»å‹å˜æˆäº†Â <code>Identifier&lt;Product&gt;</code>Â ï¼ˆåˆ»ç€â€œå•†å“ä¸“ç”¨â€çš„é“…ç¬”ï¼‰ã€‚</li>
</ul>
<p>è¿™æ—¶å€™ç¼–è¯‘å™¨å†çœ‹ï¼š</p>
<ul>
<li>
<p>å·¦è¾¹ï¼š<code>Identifier&lt;User&gt;</code></p>
</li>
<li>
<p>å³è¾¹ï¼š<code>Identifier&lt;Product&gt;</code></p>
</li>
<li>
<p>ç¼–è¯‘å™¨æ»¡æ„äº†ï¼ˆè®¤ä¸ºä½ ç”¨äº† Tï¼‰ï¼Œç»“æ„ä½“å®šä¹‰é€šè¿‡ç¼–è¯‘</p>
</li>
<li>
<p><strong>ç¼–è¯‘å™¨åˆ¤æ–­</strong>ï¼šè¿™æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„ç±»å‹ï¼Œå°±åƒÂ <code>String</code>Â å’ŒÂ <code>i32</code>Â ä¸€æ ·ä¸åŒï¼Œç¦æ­¢æ¯”è¾ƒï¼</p>
</li>
</ul>
<h3 data-id="heading-5">æ€»ç»“</h3>
<ol>
<li><strong>æ²¡æœ‰æ³›å‹æ—¶</strong>ï¼š<code>user.id</code>Â å’ŒÂ <code>product.id</code>Â çš„ç±»å‹<strong>å®Œå…¨ä¸€æ ·</strong>ï¼Œéƒ½æ˜¯Â <code>Identifier</code>ã€‚å®ƒä»¬åªæ˜¯æ°å¥½è¢«æ”¾åœ¨äº†ä¸åŒçš„ç»“æ„ä½“é‡Œï¼Œä½†è¿™ä¸å½±å“å®ƒä»¬è‡ªèº«çš„ç±»å‹èº«ä»½ã€‚æ‰€ä»¥å¯ä»¥æ¯”è¾ƒã€‚</li>
<li><strong>æœ‰æ³›å‹æ—¶</strong>ï¼šæ³›å‹å‚æ•°Â <code>&lt;T&gt;</code>Â å˜æˆäº†ç±»å‹ç­¾åçš„ä¸€éƒ¨åˆ†ã€‚<code>Identifier&lt;User&gt;</code>Â å’ŒÂ <code>Identifier&lt;Product&gt;</code>Â æ˜¯ä¸¤ä¸ª<strong>æˆªç„¶ä¸åŒ</strong>çš„ç±»å‹ã€‚æ‰€ä»¥ä¸èƒ½æ¯”è¾ƒã€‚</li>
</ol>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦Â <code>PhantomData</code>ã€‚å®ƒä¸ä»…æ˜¯ä¸ºäº†è®©ç¼–è¯‘å™¨é€šè¿‡ï¼Œæ›´æ˜¯ä¸ºäº†æŠŠÂ <strong>User</strong>Â è¿™ä¸ªèº«ä»½ä¿¡æ¯ï¼Œå¼ºè¡Œâ€œæ³¨å…¥â€åˆ°Â <strong>Identifier</strong>Â è¿™ä¸ªç±»å‹é‡Œï¼Œå®ç°ä¸šåŠ¡é€»è¾‘ä¸Šçš„éš”ç¦»ã€‚
<strong>PhantomData</strong>ï¼šåªæ˜¯ä¸ª<strong>åˆ›å¯è´´</strong>ã€‚å½“ä½ ä»…ä»…æƒ³ç”¨Â <code>T</code>Â åšæ ‡ç­¾ï¼Œè€Œä¸æƒ³çœŸçš„å­˜Â <code>T</code>Â ç±»å‹çš„æ•°æ®æ—¶ï¼Œç”¨æ¥å“„ç¼–è¯‘å™¨å¼€å¿ƒçš„ã€‚</p>
<h2 data-id="heading-6"><code>Trait Object</code></h2>
<p>ä¸‰ä¸ªä¾‹å­åˆ†åˆ«å¯¹åº”äº†Â <strong>Trait Object</strong>Â çš„ä¸‰å¤§æ ¸å¿ƒç”¨é€”ï¼š<strong>ç»Ÿä¸€æ¥å£ï¼ˆå¤šæ€å‚æ•°ï¼‰</strong> ã€<strong>å·¥å‚æ¨¡å¼ï¼ˆåŠ¨æ€è¿”å›ï¼‰</strong> Â å’ŒÂ <strong>å¼‚æ„é›†åˆï¼ˆæ··åˆå­˜å‚¨ï¼‰</strong> ã€‚</p>
<p>è¯·æŒ‰ç…§é¡ºåºæ‰‹æ•²ï¼Œå¹¶åœ¨æ•²ä»£ç æ—¶æ€è€ƒæ³¨é‡Šé‡Œçš„é—®é¢˜ã€‚</p>
<hr/>
<h3 data-id="heading-7">ä¾‹å­ 1ï¼šå‡½æ•°å‚æ•° (åŠ¨æ€åˆ†å‘)</h3>
<p><strong>ç›®çš„ï¼š</strong> Â ç†è§£å¦‚ä½•ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œè®©å®ƒèƒ½æ¥å—ä»»ä½•å®ç°äº†ç‰¹å®š Trait çš„ç±»å‹ï¼Œè€Œä¸éœ€è¦åƒæ³›å‹é‚£æ ·ä¸ºæ¯ä¸ªç±»å‹ç”Ÿæˆä¸€ä»½ä»£ç ï¼ˆå‡å°äºŒè¿›åˆ¶ä½“ç§¯ï¼‰ã€‚</p>
<p><strong>åœºæ™¯ï¼š</strong> Â æˆ‘ä»¬åšä¸€ä¸ªÂ  <strong>â€œæ¸²æŸ“å¼•æ“â€</strong> ï¼Œä¸ç®¡ä½ æ˜¯Â <code>Button</code>Â è¿˜æ˜¯Â <code>Image</code>ï¼Œåªè¦ä½ ä¼šÂ <code>render</code>ï¼Œæˆ‘å°±èƒ½æŠŠä½ ç”»å‡ºæ¥ã€‚</p>
<p>Rust</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// 1. å®šä¹‰è¡Œä¸ºç‰¹å¾</span>
<span class="hljs-keyword">trait</span> <span class="hljs-title class_">Renderable</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">render</span>(&amp;<span class="hljs-keyword">self</span>);
}

<span class="hljs-comment">// 2. å®šä¹‰å…·ä½“ç»„ä»¶</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Button</span> { label: <span class="hljs-type">String</span> }
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Renderable</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">Button</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">render</span>(&amp;<span class="hljs-keyword">self</span>) {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ç»˜åˆ¶æŒ‰é’®: [ {} ]"</span>, <span class="hljs-keyword">self</span>.label);
    }
}

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Image</span> { src: <span class="hljs-type">String</span> }
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Renderable</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">Image</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">render</span>(&amp;<span class="hljs-keyword">self</span>) {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ç»˜åˆ¶å›¾ç‰‡: &lt;img&gt;{}&lt;/img&gt;"</span>, <span class="hljs-keyword">self</span>.src);
    }
}

<span class="hljs-comment">// 3. ã€æ ¸å¿ƒã€‘å‡½æ•°å‚æ•°ä½¿ç”¨ &amp;dyn Renderable</span>
<span class="hljs-comment">// æ€è€ƒï¼šä¸ºä»€ä¹ˆè¿™é‡Œä¸ç”¨æ³›å‹ fn draw&lt;T: Renderable&gt;(item: &amp;T) ?</span>
<span class="hljs-comment">// ç­”æ¡ˆï¼šå¦‚æœç”¨æ³›å‹ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆ draw_for_button å’Œ draw_for_image ä¸¤ä»½ä»£ç ã€‚</span>
<span class="hljs-comment">//      ç”¨ dynï¼Œä»£ç åªæœ‰ä¸€ä»½ï¼Œé€šè¿‡ vtable åŠ¨æ€æŸ¥æ‰¾ render æ–¹æ³•ã€‚</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">draw_component</span>(item: &amp;<span class="hljs-keyword">dyn</span> Renderable) {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"&gt;&gt;&gt; å¼€å§‹æ¸²æŸ“ç»„ä»¶..."</span>);
    item.<span class="hljs-title function_ invoke__">render</span>(); <span class="hljs-comment">// è¿è¡Œæ—¶æŸ¥è¡¨è°ƒç”¨</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"&lt;&lt;&lt; æ¸²æŸ“ç»“æŸ\n"</span>);
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">btn</span> = Button { label: <span class="hljs-string">"æäº¤"</span>.<span class="hljs-title function_ invoke__">into</span>() };
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">img</span> = Image { src: <span class="hljs-string">"logo.png"</span>.<span class="hljs-title function_ invoke__">into</span>() };

    <span class="hljs-comment">// ä¼ å…¥å¼•ç”¨ï¼Œè‡ªåŠ¨è½¬ä¸º Trait Object èƒ–æŒ‡é’ˆ</span>
    <span class="hljs-title function_ invoke__">draw_component</span>(&amp;btn); 
    <span class="hljs-title function_ invoke__">draw_component</span>(&amp;img);
}
</code></pre>
<hr/>
<h3 data-id="heading-8">ä¾‹å­ 2ï¼šå‡½æ•°è¿”å›å€¼ (å·¥å‚æ¨¡å¼)</h3>
<p><strong>ç›®çš„ï¼š</strong> Â è§£å†³ Rust å‡½æ•°åªèƒ½è¿”å›ç¡®å®šå¤§å°ç±»å‹çš„é™åˆ¶ã€‚ç†è§£ä¸ºä»€ä¹ˆè¿”å›å€¼å¿…é¡»åŒ…åœ¨Â <code>Box</code>Â é‡Œã€‚</p>
<p><strong>åœºæ™¯ï¼š</strong> Â ä¸€ä¸ªè·¨å¹³å°çš„Â <strong>UI å·¥å‚</strong>ã€‚æ ¹æ®ä¼ å…¥çš„é…ç½®å­—ç¬¦ä¸²ï¼Œå†³å®šæ˜¯é€ ä¸€ä¸ª Windows é£æ ¼çš„ç»„ä»¶ï¼Œè¿˜æ˜¯ MacOS é£æ ¼çš„ç»„ä»¶ã€‚</p>
<p>Rust</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">trait</span> <span class="hljs-title class_">Widget</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">draw</span>(&amp;<span class="hljs-keyword">self</span>);
}

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">WindowsWidget</span>;
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Widget</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">WindowsWidget</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">draw</span>(&amp;<span class="hljs-keyword">self</span>) { <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Style: Windows (æ–¹è§’)"</span>); }
}

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">MacWidget</span>;
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Widget</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">MacWidget</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">draw</span>(&amp;<span class="hljs-keyword">self</span>) { <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Style: MacOS (åœ†è§’)"</span>); }
}

<span class="hljs-comment">// ã€æ ¸å¿ƒã€‘å‡½æ•°è¿”å›å€¼ Box&lt;dyn Widget&gt;</span>
<span class="hljs-comment">// æ€è€ƒï¼šä¸ºä»€ä¹ˆä¸èƒ½å†™ fn create_widget() -&gt; dyn Widget ?</span>
<span class="hljs-comment">// ç­”æ¡ˆï¼šdyn Widget å¤§å°ä¸ç¡®å®šï¼ˆå¯èƒ½æ˜¯ WindowsWidget 0å­—èŠ‚ï¼Œä¹Ÿå¯èƒ½æ˜¯å·¨å‹ç»“æ„ä½“ï¼‰ã€‚</span>
<span class="hljs-comment">//      å‡½æ•°æ ˆå¸§æ— æ³•é¢„ç•™å†…å­˜ã€‚å¿…é¡»æŠŠæ•°æ®æ‰”åˆ°å †(Box)ä¸Šï¼Œè¿”å›å›ºå®šå¤§å°çš„èƒ–æŒ‡é’ˆã€‚</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">widget_factory</span>(os_type: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Box</span>&lt;<span class="hljs-keyword">dyn</span> Widget&gt; {
    <span class="hljs-keyword">if</span> os_type == <span class="hljs-string">"windows"</span> {
        <span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">new</span>(WindowsWidget)
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">new</span>(MacWidget)
    }
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-comment">// è¿è¡Œæ—¶å†³å®šè¿”å›ä»€ä¹ˆç±»å‹</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">w1</span> = <span class="hljs-title function_ invoke__">widget_factory</span>(<span class="hljs-string">"windows"</span>);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">w2</span> = <span class="hljs-title function_ invoke__">widget_factory</span>(<span class="hljs-string">"mac"</span>);

    w1.<span class="hljs-title function_ invoke__">draw</span>();
    w2.<span class="hljs-title function_ invoke__">draw</span>();
}
</code></pre>
<p><strong>å¯¹æ¯”ç»ƒä¹ ï¼š</strong> Â å¦‚æœä½ å°è¯•æŠŠè¿”å›å€¼æ”¹æˆÂ <code>impl Widget</code>ï¼ˆé™æ€åˆ†å‘ï¼‰ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼Œå› ä¸ºÂ <code>if/else</code>Â åˆ†æ”¯è¿”å›äº†ä¸åŒçš„ç±»å‹ã€‚åªæœ‰Â <code>Box&lt;dyn Widget&gt;</code>Â æ‰èƒ½æŠ¹å¹³è¿™ç§å·®å¼‚ã€‚</p>
<hr/>
<h3 data-id="heading-9">ä¾‹å­ 3ï¼šæ•°æ®ç»“æ„ (å¼‚æ„é›†åˆ)</h3>
<p><strong>ç›®çš„ï¼š</strong> Â åœ¨ä¸€ä¸ªÂ <code>Vec</code>Â åˆ—è¡¨ä¸­å­˜å‚¨ä¸åŒç±»å‹çš„å¯¹è±¡ã€‚è¿™æ˜¯æ³›å‹Â <code>Vec&lt;T&gt;</code>Â åšä¸åˆ°çš„ã€‚</p>
<p><strong>åœºæ™¯ï¼š</strong> Â ä¸€ä¸ªÂ <strong>äº‹ä»¶å¤„ç†å™¨åˆ—è¡¨</strong>ã€‚ä½ çš„ App é‡Œæœ‰ä¸åŒç±»å‹çš„ç›‘å¬å™¨ï¼ˆç‚¹å‡»ç›‘å¬ã€é”®ç›˜ç›‘å¬ï¼‰ï¼Œä½ æƒ³æŠŠå®ƒä»¬æ”¾åœ¨åŒä¸€ä¸ªæ•°ç»„é‡Œç»Ÿä¸€ç®¡ç†ã€‚</p>
<p>Rust</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// 1. å®šä¹‰äº‹ä»¶ç›‘å¬è¡Œä¸º</span>
<span class="hljs-keyword">trait</span> <span class="hljs-title class_">EventListener</span> {
    <span class="hljs-comment">// è¿™é‡Œçš„ &amp;self ä¹Ÿæ˜¯åŠ¨æ€åˆ†å‘çš„å…³é”®</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">on_event</span>(&amp;<span class="hljs-keyword">self</span>, event_name: &amp;<span class="hljs-type">str</span>);
}

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">ClickListener</span>;
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">EventListener</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">ClickListener</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">on_event</span>(&amp;<span class="hljs-keyword">self</span>, e: &amp;<span class="hljs-type">str</span>) {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"é¼ æ ‡ç‚¹å‡»è§¦å‘: {}"</span>, e);
    }
}

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">KeyListener</span> { key_code: <span class="hljs-type">u32</span> }
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">EventListener</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">KeyListener</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">on_event</span>(&amp;<span class="hljs-keyword">self</span>, e: &amp;<span class="hljs-type">str</span>) {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"é”®ç›˜æŒ‰é”® {} è§¦å‘: {}"</span>, <span class="hljs-keyword">self</span>.key_code, e);
    }
}

<span class="hljs-comment">// 2. ã€æ ¸å¿ƒã€‘åœ¨ç»“æ„ä½“ä¸­ä½¿ç”¨ Vec&lt;Box&lt;dyn Trait&gt;&gt;</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">App</span> {
    <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ª"æ··åˆ"åˆ—è¡¨ï¼Œå¯ä»¥å­˜ä»»ä½•å®ç°äº† EventListener çš„ä¸œè¥¿</span>
    listeners: <span class="hljs-type">Vec</span>&lt;<span class="hljs-type">Box</span>&lt;<span class="hljs-keyword">dyn</span> EventListener&gt;&gt;,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">App</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">new</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-keyword">Self</span> {
        <span class="hljs-keyword">Self</span> { listeners: <span class="hljs-type">Vec</span>::<span class="hljs-title function_ invoke__">new</span>() }
    }

    <span class="hljs-comment">// æ³¨å†Œç›‘å¬å™¨</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">add_listener</span>(&amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>, l: <span class="hljs-type">Box</span>&lt;<span class="hljs-keyword">dyn</span> EventListener&gt;) {
        <span class="hljs-keyword">self</span>.listeners.<span class="hljs-title function_ invoke__">push</span>(l);
    }

    <span class="hljs-comment">// è§¦å‘æ‰€æœ‰äº‹ä»¶</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">fire_event</span>(&amp;<span class="hljs-keyword">self</span>, event: &amp;<span class="hljs-type">str</span>) {
        <span class="hljs-keyword">for</span> <span class="hljs-variable">listener</span> <span class="hljs-keyword">in</span> &amp;<span class="hljs-keyword">self</span>.listeners {
            <span class="hljs-comment">// listener æ˜¯ Box&lt;dyn ...&gt;</span>
            <span class="hljs-comment">// Rust ä¼šè‡ªåŠ¨è§£å¼•ç”¨ Boxï¼Œå¹¶åˆ©ç”¨å†…éƒ¨çš„ vtable è°ƒç”¨æ­£ç¡®çš„æ–¹æ³•</span>
            listener.<span class="hljs-title function_ invoke__">on_event</span>(event);
        }
    }
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">app</span> = App::<span class="hljs-title function_ invoke__">new</span>();

    <span class="hljs-comment">// å¡å…¥ä¸åŒç±»å‹çš„ç»“æ„ä½“</span>
    app.<span class="hljs-title function_ invoke__">add_listener</span>(<span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">new</span>(ClickListener));
    app.<span class="hljs-title function_ invoke__">add_listener</span>(<span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">new</span>(KeyListener { key_code: <span class="hljs-number">13</span> })); <span class="hljs-comment">// Enteré”®</span>

    app.<span class="hljs-title function_ invoke__">fire_event</span>(<span class="hljs-string">"ç”¨æˆ·ç™»å½•"</span>);
}
</code></pre>
<hr/>
<pre><code class="hljs language-rust" lang="rust">ç¬¬ä¸‰ä¸ªç‚¹Â **æ•°æ®ç»“æ„ (`<span class="hljs-type">Vec</span>&lt;<span class="hljs-type">Box</span>&lt;<span class="hljs-keyword">dyn</span> Trait&gt;&gt;`)** Â ç¡®å®æ˜¯ Rust å’Œ JS æ€ç»´å·®å¼‚æœ€å¤§çš„åœ°æ–¹ã€‚
</code></pre>
<p>åªè¦ææ‡‚äº†Â  <strong>â€œå†…å­˜å¯¹å…¶â€</strong> Â å’ŒÂ  <strong>â€œé¸­å­ç±»å‹â€</strong> Â çš„åŒºåˆ«ï¼Œä½ å°±å½»åº•æ‡‚äº†ã€‚</p>
<p>æˆ‘ä»¬ç”¨ä¸€ä¸ªæœ€ç»å…¸çš„åœºæ™¯ï¼š<strong>æ¸¸æˆé‡Œçš„èƒŒåŒ…ç³»ç»Ÿ</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-10">1. JavaScript çš„åšæ³•ï¼šé­”æ³•å£è¢‹ (Duck Typing)</h3>
<p>åœ¨ JS é‡Œï¼Œæ•°ç»„ï¼ˆArrayï¼‰æ˜¯ä¸€ä¸ª<strong>é­”æ³•å£è¢‹</strong>ã€‚å®ƒå¯ä»¥éšä¾¿è£…ä¸œè¥¿ï¼Œä¸ç®¡ä½ å¡è¿›å»çš„æ˜¯ä»€ä¹ˆã€‚</p>
<p><strong>JS åœºæ™¯ï¼š</strong> Â ä½ çš„æ¸¸æˆèƒŒåŒ…é‡Œæœ‰ä¸‰ä¸ªä¸œè¥¿ï¼šä¸€æŠŠå‰‘ (<code>Sword</code>)ï¼Œä¸€ç“¶è¯ (<code>Potion</code>)ï¼Œä¸€å¼ åœ°å›¾ (<code>Map</code>)ã€‚å®ƒä»¬ä¸ä¸€æ ·å¤§ï¼Œå±æ€§ä¹Ÿä¸ä¸€æ ·ï¼Œä½†å®ƒä»¬éƒ½æœ‰ä¸€ä¸ªå…±åŒç‚¹ï¼š<strong>å¯ä»¥è¢«â€œä½¿ç”¨â€ (<code>use()</code>)</strong> ã€‚</p>
<p>JavaScript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// JS ä»£ç </span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Sword</span> {
    <span class="hljs-title function_">use</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æŒ¥å‰‘æ”»å‡»ï¼"</span>); }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Potion</span> {
    <span class="hljs-title function_">use</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å–è¯å›è¡€ï¼"</span>); }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Map</span> {
    <span class="hljs-title function_">use</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æŸ¥çœ‹åœ°å›¾..."</span>); }
}

<span class="hljs-comment">// 1. åˆ›å»ºèƒŒåŒ… (Array)</span>
<span class="hljs-comment">// JS: æˆ‘ä¸ç®¡ä½ å¡ä»€ä¹ˆï¼Œåæ­£æˆ‘éƒ½æ¥å¾—ä½</span>
<span class="hljs-keyword">const</span> bag = [
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sword</span>(),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Potion</span>(),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(), 
    <span class="hljs-string">"ç”šè‡³å¡ä¸ªå­—ç¬¦ä¸²è¿›å»JSä¹Ÿä¸æŠ¥é”™"</span> 
];

<span class="hljs-comment">// 2. éå†ä½¿ç”¨</span>
<span class="hljs-comment">// JS: åªè¦ä½ æœ‰ use() æ–¹æ³•ï¼Œæˆ‘å°±è°ƒç”¨ã€‚å¦‚æœæ²¡æœ‰ï¼Œæˆ‘è¿è¡Œæ—¶å€™å†æŠ¥é”™ã€‚</span>
bag.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-title function_">use</span>());
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong> Â JS æ˜¯Â  <strong>â€œé¸­å­ç±»å‹â€</strong> ï¼ˆDuck Typingï¼‰ã€‚åªè¦å®ƒèµ°èµ·æ¥åƒé¸­å­ï¼Œå«èµ·æ¥åƒé¸­å­ï¼Œæˆ‘å°±æŠŠå®ƒå½“é¸­å­ã€‚JS æ•°ç»„å­˜çš„æ˜¯<strong>å¼•ç”¨ï¼ˆReferenceï¼‰</strong> ï¼Œä¸åœ¨ä¹å…·ä½“çš„å†…å­˜å¤§å°ã€‚</p>
<hr/>
<h3 data-id="heading-11">2. Rust çš„åŸç”Ÿåšæ³•ï¼šå¼ºè¿«ç—‡çš„æ ¼å­é“º (<code>Vec&lt;T&gt;</code>)</h3>
<p>Rust æ˜¯<strong>é™æ€ç±»å‹</strong>è¯­è¨€ï¼Œè€Œä¸”å¯¹<strong>å†…å­˜å¸ƒå±€</strong>æœ‰å¼ºè¿«ç—‡ã€‚</p>
<p>æ ‡å‡†çš„Â <code>Vec&lt;T&gt;</code>Â å°±åƒæ˜¯ä¸€ä¸ª<strong>è¶…å¸‚è´§æ¶çš„é™ˆåˆ—ç›’</strong>ã€‚</p>
<ul>
<li>å¦‚æœä½ å®šä¹‰Â <code>Vec&lt;Sword&gt;</code>ï¼Œé‚£è¿™ä¸ªç›’å­é‡Œ<strong>æ¯ä¸€ä¸ªæ ¼å­</strong>éƒ½å¿…é¡»åˆšå¥½èƒ½æ”¾ä¸‹Â <code>Sword</code>Â é‚£ä¹ˆå¤§çš„ä¸œè¥¿ã€‚</li>
<li><code>Sword</code>Â å¯èƒ½å  10 ä¸ªå­—èŠ‚ï¼Œ<code>Potion</code>Â å¯èƒ½å  4 ä¸ªå­—èŠ‚ã€‚</li>
</ul>
<p><strong>Rust çš„å›°å¢ƒï¼š</strong> Â å¦‚æœä½ æƒ³æŠŠÂ <code>Sword</code>Â å’ŒÂ <code>Potion</code>Â æ”¾åœ¨åŒä¸€ä¸ªÂ <code>Vec</code>Â é‡Œï¼š</p>
<p>Rust</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">bag</span> = <span class="hljs-type">Vec</span>::<span class="hljs-title function_ invoke__">new</span>();
bag.<span class="hljs-title function_ invoke__">push</span>(Sword);  <span class="hljs-comment">// æ”¾å…¥å‰‘</span>
bag.<span class="hljs-title function_ invoke__">push</span>(Potion); <span class="hljs-comment">// âŒ æŠ¥é”™ï¼ç±»å‹ä¸åŒ¹é…ï¼</span>
<span class="hljs-comment">// ç¼–è¯‘å™¨æ€’å¼ï¼šè¿™ä¸ª Vec æ˜¯ä¸“é—¨æ”¾ Sword çš„ï¼Œä½ æ‹¿ä¸ª Potion è¿‡æ¥å¹²ä»€ä¹ˆï¼Ÿå°ºå¯¸éƒ½ä¸ä¸€æ ·ï¼</span>
</code></pre>
<p>è¿™å°±åƒä½ ä¹°äº†ä¸€ç®±çº¢é…’çš„æ³¡æ²«ç®±ï¼ˆæœ‰å›ºå®šå­”æ´ï¼‰ï¼Œä½ éè¦å¾€é‡Œå¡ä¸ªè¥¿ç“œï¼Œå¡ä¸è¿›å»å•Šï¼</p>
<hr/>
<h3 data-id="heading-12">3. è§£å†³æ–¹æ¡ˆï¼šç»Ÿä¸€åŒ…è£…ç›’ (<code>Vec&lt;Box&lt;dyn Trait&gt;&gt;</code>)</h3>
<p>æ—¢ç„¶Â <code>Sword</code>Â å’ŒÂ <code>Potion</code>Â å¤§å°ä¸ä¸€æ ·ï¼Œé‚£æ€ä¹ˆæŠŠå®ƒä»¬æ”¾è¿›åŒä¸€ä¸ªæ ¼å­é‡Œå‘¢ï¼Ÿ</p>
<p><strong>ç­”æ¡ˆï¼š</strong> Â æŠŠå®ƒä»¬åˆ†åˆ«è£…è¿›<strong>ç»Ÿä¸€å¤§å°çš„å¿«é€’ç›’</strong>é‡Œï¼</p>
<p>è¿™ä¸ªâ€œå¿«é€’ç›’â€å°±æ˜¯Â <strong><code>Box</code>ï¼ˆæŒ‡é’ˆï¼‰</strong> ã€‚</p>
<ul>
<li>ä¸ç®¡é‡Œé¢çš„ä¸œè¥¿å¤šå¤§ï¼Œ<strong>æŒ‡é’ˆçš„å¤§å°æ˜¯å›ºå®šçš„</strong>ï¼ˆåœ¨ 64 ä½ç³»ç»Ÿä¸Šå°±æ˜¯ 8 å­—èŠ‚ï¼‰ã€‚</li>
<li>æˆ‘ä»¬åœ¨å¿«é€’ç›’å¤–é¢è´´ä¸ªæ ‡ç­¾ï¼š <strong>â€œå¯ä½¿ç”¨ç‰©å“ (dyn Usable)â€</strong> ã€‚</li>
</ul>
<p>è¿™æ ·ï¼Œ<code>Vec</code>Â é‡Œå­˜çš„ä¸å†æ˜¯åƒå¥‡ç™¾æ€ªçš„ç‰©å“ï¼Œè€Œæ˜¯<strong>æ•´æ•´é½é½çš„å¿«é€’ç›’</strong>ã€‚</p>
<p>Rust</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// å®šä¹‰ç‰¹å¾ï¼šæ‰€æœ‰ç‰©å“å¿…é¡»èƒ½è¢«â€œä½¿ç”¨â€</span>
<span class="hljs-keyword">trait</span> <span class="hljs-title class_">Usable</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">use_item</span>(&amp;<span class="hljs-keyword">self</span>);
}

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Sword</span>;
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Usable</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">Sword</span> { <span class="hljs-keyword">fn</span> <span class="hljs-title function_">use_item</span>(&amp;<span class="hljs-keyword">self</span>) { <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æŒ¥å‰‘ï¼"</span>); } }

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Potion</span>;
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Usable</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">Potion</span> { <span class="hljs-keyword">fn</span> <span class="hljs-title function_">use_item</span>(&amp;<span class="hljs-keyword">self</span>) { <span class="hljs-built_in">println!</span>(<span class="hljs-string">"å–è¯ï¼"</span>); } }

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-comment">// åˆ›å»ºèƒŒåŒ…ï¼šè¿™æ˜¯ä¸€ä¸ªä¸“é—¨è£…â€œUsable å¿«é€’ç›’â€çš„åˆ—è¡¨</span>
    <span class="hljs-comment">// Box&lt;dyn Usable&gt; çš„å¤§å°æ˜¯å›ºå®šçš„ï¼ˆèƒ–æŒ‡é’ˆå¤§å°ï¼‰</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">bag</span>: <span class="hljs-type">Vec</span>&lt;<span class="hljs-type">Box</span>&lt;<span class="hljs-keyword">dyn</span> Usable&gt;&gt; = <span class="hljs-type">Vec</span>::<span class="hljs-title function_ invoke__">new</span>();

    <span class="hljs-comment">// 1. è£…ç®±</span>
    <span class="hljs-comment">// æŠŠ Sword è£…è¿› Boxï¼Œå˜æˆ Box&lt;dyn Usable&gt;</span>
    bag.<span class="hljs-title function_ invoke__">push</span>(<span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">new</span>(Sword)); 
    <span class="hljs-comment">// æŠŠ Potion è£…è¿› Boxï¼Œå˜æˆ Box&lt;dyn Usable&gt;</span>
    bag.<span class="hljs-title function_ invoke__">push</span>(<span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">new</span>(Potion));

    <span class="hljs-comment">// 2. éå†</span>
    <span class="hljs-keyword">for</span> <span class="hljs-variable">item</span> <span class="hljs-keyword">in</span> bag {
        <span class="hljs-comment">// item ç°åœ¨æ˜¯ä¸€ä¸ªç›’å­</span>
        <span class="hljs-comment">// Rust è¿è¡Œæ—¶ä¼šçœ‹ç›’å­ä¸Šçš„æ ‡ç­¾(vtable)ï¼Œå†³å®šæ€ä¹ˆç”¨é‡Œé¢çš„ä¸œè¥¿</span>
        item.<span class="hljs-title function_ invoke__">use_item</span>();
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-13">4. æ·±åº¦å¯¹æ¯”å›¾è¡¨</h3>









































<table><thead><tr><th>ç»´åº¦</th><th>JS æ•°ç»„ (<code>[]</code>)</th><th>Rust æ™®é€šæ³›å‹ (<code>Vec&lt;T&gt;</code>)</th><th>Rust Trait Object (<code>Vec&lt;Box&lt;dyn Trait&gt;&gt;</code>)</th></tr></thead><tbody><tr><td><strong>ç”»é¢æ„Ÿ</strong></td><td><strong>é­”æ³•è¢‹</strong></td><td><strong>çº¢é…’ä¸“ç”¨ç®±</strong></td><td><strong>é›†è£…ç®±è´§èˆ¹</strong></td></tr><tr><td><strong>å­˜å‚¨å†…å®¹</strong></td><td>å•¥éƒ½èƒ½æ··ç€è£…</td><td>åªèƒ½è£…<strong>å®Œå…¨ä¸€æ ·</strong>çš„ä¸œè¥¿</td><td>è£…ç€<strong>ä¸åŒè´§ç‰©</strong>çš„<strong>æ ‡å‡†é›†è£…ç®±</strong></td></tr><tr><td><strong>åŸç†</strong></td><td>å­˜çš„éƒ½æ˜¯åŠ¨æ€å¼•ç”¨</td><td>å­˜çš„æ˜¯ç´§å‡‘çš„åŸå§‹æ•°æ®</td><td>å­˜çš„æ˜¯<strong>ç»Ÿä¸€å¤§å°çš„æŒ‡é’ˆ (Box)</strong></td></tr><tr><td><strong>å†…å­˜æ•ˆç‡</strong></td><td>ä½ (å„ç§å…ƒæ•°æ®)</td><td><strong>æé«˜</strong>Â (æ— é—´éš™)</td><td>ä¸­ç­‰ (å¤šä¸€æ¬¡æŒ‡é’ˆè·³è½¬)</td></tr><tr><td><strong>çµæ´»æ€§</strong></td><td>æé«˜ (éšä¾¿æ··ç”¨)</td><td>ä½ (ä¸èƒ½æ··ç”¨)</td><td><strong>é«˜ (å®ç°äº† Trait å°±èƒ½æ··ç”¨)</strong></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-14">5. ä¸ºä»€ä¹ˆå«â€œæ‚ç‰©ç®±â€ï¼Ÿ</h3>
<p>å›åˆ°é‚£ä¸ªæ¯”å–»ï¼š</p>
<ul>
<li>
<p><strong>æ³›å‹ (<code>Vec&lt;Apple&gt;</code>)</strong> ï¼šè¿™å°±åƒæ°´æœåº—çš„**â€œç²¾å“è‹¹æœç¤¼ç›’â€**ã€‚æ¯ä¸€ä¸ªå‘ä½éƒ½æ˜¯ä¸ºäº†è‹¹æœè®¾è®¡çš„ï¼Œä½ æ•¢æ”¾ä¸ªæ¢¨è¿›å»ï¼Œç›–å­éƒ½ç›–ä¸ä¸Šï¼ˆç¼–è¯‘ä¸è¿‡ï¼‰ã€‚</p>
</li>
<li>
<p><strong>Trait Object (<code>Vec&lt;Box&lt;dyn Fruit&gt;&gt;</code>)</strong> ï¼šè¿™å°±åƒæ¬å®¶å…¬å¸çš„**â€œæ‚ç‰©ç®±â€**ã€‚</p>
<ul>
<li>ä½ æƒ³æŠŠ è‹¹æœã€æ¢¨ã€ç”šè‡³è¥¿ç“œ æ”¾åœ¨ä¸€èµ·è¿èµ°ã€‚</li>
<li>ä½ ä¸èƒ½ç›´æ¥å †åœ¨ä¸€èµ·ï¼ˆä¸å¥½ç æ”¾ï¼‰ã€‚</li>
<li>ä½ æŠŠè‹¹æœè£…è¿›ä¸€ä¸ªå°çº¸ç®± (<code>Box</code>)ã€‚</li>
<li>æŠŠæ¢¨è£…è¿›å¦ä¸€ä¸ªå°çº¸ç®± (<code>Box</code>)ã€‚</li>
<li>æŠŠè¥¿ç“œè£…è¿›ä¸€ä¸ªå¤§çº¸ç®± (<code>Box</code>)ã€‚</li>
<li><strong>å…³é”®ç‚¹ï¼š</strong> Â è™½ç„¶é‡Œé¢çš„æ°´æœå¤§å°ä¸åŒï¼Œä½†è¿™äº›<strong>çº¸ç®±çš„å¤–è¡¨</strong>çœ‹èµ·éƒ½æ˜¯è§„æ•´çš„é•¿æ–¹ä½“ã€‚</li>
<li>ç°åœ¨ï¼Œä½ å¯ä»¥æŠŠè¿™äº›çº¸ç®±æ•´æ•´é½é½åœ°ç æ”¾åœ¨å¡è½¦ (<code>Vec</code>) é‡Œäº†ã€‚</li>
</ul>
</li>
</ul>
<p><strong>è¿™å°±æ˜¯Â <code>Vec&lt;Box&lt;dyn Trait&gt;&gt;</code>Â çš„æ„ä¹‰ï¼šé€šè¿‡ Box ç»Ÿä¸€å°ºå¯¸ï¼Œé€šè¿‡ Trait ç»Ÿä¸€æ¥å£ï¼Œå®ç°äº†åœ¨å¼ºç±»å‹è¯­è¨€ä¸­å­˜å‚¨â€œä¸åŒç§ç±»â€æ•°æ®çš„èƒ½åŠ›ã€‚</strong></p>
<h3 data-id="heading-15">æ€»ç»“ä¸æ ¸å¿ƒè®°å¿†ç‚¹</h3>
<p>å½“ä½ æ•²å®Œè¿™ä¸‰æ®µä»£ç ï¼Œè¯·åœ¨è„‘å­é‡Œå›æ”¾è¿™ä¸‰ä¸ªç”»é¢ï¼š</p>
<ol>
<li>
<p><strong>å‡½æ•°å‚æ•° (<code>&amp;dyn Trait</code>)</strong> ï¼š</p>
<ul>
<li><strong>ç”»é¢</strong>ï¼šä¸‡èƒ½æ’åº§ã€‚</li>
<li><strong>ç›®çš„</strong>ï¼šä¸ºäº†è®©ä¸€ä»½å‡½æ•°ä»£ç å…¼å®¹å¤šç§è¾“å…¥ç±»å‹ï¼ˆçœç©ºé—´ï¼Œè§£è€¦ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>å‡½æ•°è¿”å›å€¼ (<code>Box&lt;dyn Trait&gt;</code>)</strong> ï¼š</p>
<ul>
<li><strong>ç”»é¢</strong>ï¼šç›²ç›’ã€‚</li>
<li><strong>ç›®çš„</strong>ï¼šä¸ºäº†åœ¨è¿è¡Œæ—¶æ ¹æ®é€»è¾‘åå‡ºä¸åŒç±»å‹çš„å¯¹è±¡ï¼ˆå› ä¸ºæ ˆä¸Šæ”¾ä¸ä¸‹æœªçŸ¥çš„ç±»å‹ï¼Œåªèƒ½æ”¾å †æŒ‡é’ˆï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ•°æ®ç»“æ„ (<code>Vec&lt;Box&lt;dyn Trait&gt;&gt;</code>)</strong> ï¼š</p>
<ul>
<li><strong>ç”»é¢</strong>ï¼šæ‚ç‰©ç®±ã€‚</li>
<li><strong>ç›®çš„</strong>ï¼šä¸ºäº†æŠŠâ€œè‹¹æœâ€å’Œâ€œæ¢¨â€æ”¾åœ¨åŒä¸€ä¸ªç¯®å­é‡Œï¼ˆæ³›å‹ç¯®å­åªèƒ½æ”¾ä¸€ç§æ°´æœï¼ŒTrait Object ç¯®å­èƒ½æ”¾æ‰€æœ‰â€œæ°´æœâ€ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-16">Trait Object åˆ°åº•æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ</h3>
<p>ç”¨æŠ€æœ¯è¯­è¨€æ€»ç»“ï¼Œå®ƒä¸»è¦ä¸ºäº†è§£å†³ RustÂ <strong>å¼ºç±»å‹ç³»ç»Ÿ</strong>å¸¦æ¥çš„ä¸¤ä¸ªâ€œç—›ç‚¹â€ï¼š</p>
<h4 data-id="heading-17">ç—›ç‚¹ 1ï¼šæˆ‘æƒ³æŠŠä¸åŒçš„ä¸œè¥¿æ”¾åœ¨åŒä¸€ä¸ªæ•°ç»„é‡Œ</h4>
<p>åœ¨ Rust é‡Œï¼Œæ•°ç»„Â <code>Vec&lt;T&gt;</code>Â çš„Â <code>T</code>Â å¿…é¡»æ˜¯<strong>åŒä¸€ç§</strong>å…·ä½“ç±»å‹ã€‚ä½ ä¸èƒ½åœ¨Â <code>Vec&lt;String&gt;</code>Â é‡Œæ”¾Â <code>int</code>ã€‚</p>
<ul>
<li><strong>æ²¡æœ‰ Trait Object</strong>ï¼šä½ æ²¡æ³•æŠŠÂ <code>Button</code>ï¼ˆæŒ‰é’®ï¼‰å’ŒÂ <code>Input</code>ï¼ˆè¾“å…¥æ¡†ï¼‰æ”¾åœ¨åŒä¸€ä¸ªÂ <code>UI_List</code>Â é‡Œã€‚</li>
<li><strong>æœ‰äº† Trait Object</strong>ï¼šä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªÂ <code>trait Widget</code>ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªÂ <code>Vec&lt;Box&lt;dyn Widget&gt;&gt;</code>ã€‚è¿™é‡Œé¢æ—¢èƒ½æ”¾æŒ‰é’®ï¼Œä¹Ÿèƒ½æ”¾è¾“å…¥æ¡†ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ˜¯Â <code>dyn Widget</code>ã€‚</li>
</ul>
<h4 data-id="heading-18">ç—›ç‚¹ 2ï¼šæˆ‘æƒ³åœ¨è¿è¡Œæ—¶å†³å®šè¿”å›ä»€ä¹ˆç±»å‹</h4>
<p>æœ‰äº›å‡½æ•°ï¼Œæ ¹æ®æ¡ä»¶çš„åˆ¤å®šï¼Œå¯èƒ½è¿”å›Â <code>A</code>Â ç±»å‹ï¼Œä¹Ÿå¯èƒ½è¿”å›Â <code>B</code>Â ç±»å‹ã€‚</p>
<ul>
<li><strong>æ²¡æœ‰ Trait Object</strong>ï¼šå‡½æ•°è¿”å›å€¼Â <code>-&gt; T</code>Â å¿…é¡»åœ¨ç¼–è¯‘æ—¶ç¡®å®šæ˜¯å“ªä¸€ä¸ª structã€‚ä½ ä¸èƒ½å†™Â <code>if x { return Button } else { return Input }</code>ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚</li>
<li><strong>æœ‰äº† Trait Object</strong>ï¼šä½ å¯ä»¥è®©å‡½æ•°è¿”å›Â <code>Box&lt;dyn Widget&gt;</code>ã€‚ç¼–è¯‘å™¨å°±ä¸ç®¡å…·ä½“æ˜¯å•¥äº†ï¼Œåªç®¡ä½ è¿”å›çš„ä¸œè¥¿æ˜¯ä¸€ä¸ªâ€œWidget æŒ‡é’ˆâ€ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-19">3. ä¸ºä»€ä¹ˆè¯´æ˜¯â€œè¿è¡Œæ—¶â€ï¼Ÿ</h3>
<p>ä¸ºäº†è®©ä½ ç†è§£â€œè¿è¡Œæ—¶â€å’Œâ€œç¼–è¯‘æ—¶â€çš„åŒºåˆ«ï¼Œçœ‹è¿™ä¸ªå¯¹æ¯”ï¼š</p>
<h4 data-id="heading-20">æ³›å‹ (ç¼–è¯‘æ—¶ç¡®å®š)</h4>
<p>Rust</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// æ³›å‹å‡½æ•°</span>
<span class="hljs-function">fn <span class="hljs-title">run</span>&lt;<span class="hljs-title">T</span>: <span class="hljs-title">Workable</span>&gt;(<span class="hljs-params">worker: T</span>)</span> {
    worker.work();
}

<span class="hljs-comment">// ç¼–è¯‘æ—¶ï¼š</span>
<span class="hljs-comment">// ç¼–è¯‘å™¨å‘ç°ä½ å¯¹ Programmer è°ƒç”¨äº† runï¼Œå®ƒå°±ç”Ÿæˆäº†ä¸€ä»½ run_for_programmer ä»£ç ã€‚</span>
<span class="hljs-comment">// ç¼–è¯‘å™¨å‘ç°ä½ å¯¹ Designer è°ƒç”¨äº† runï¼Œå®ƒåˆç”Ÿæˆäº†ä¸€ä»½ run_for_designer ä»£ç ã€‚</span>
<span class="hljs-comment">// è¿™é‡Œçš„ worker.work() æ˜¯ç›´æ¥å†™æ­»çš„å‡½æ•°åœ°å€ï¼Œé€Ÿåº¦æå¿«ã€‚</span>
</code></pre>
<h4 data-id="heading-21">Trait Object (è¿è¡Œæ—¶ç¡®å®š)</h4>
<p>Rust</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// Trait Object å‡½æ•°</span>
fn <span class="hljs-built_in">run</span>(worker: &amp;dyn Workable) {
    worker<span class="hljs-selector-class">.work</span>();
}

<span class="hljs-comment">// ç¼–è¯‘æ—¶ï¼š</span>
<span class="hljs-comment">// ç¼–è¯‘å™¨åªç”Ÿæˆè¿™ä¸€ä»½ä»£ç ã€‚å®ƒä¸çŸ¥é“ worker åˆ°åº•æ˜¯å•¥ã€‚</span>
<span class="hljs-comment">// ç¼–è¯‘å™¨åœ¨ä»£ç é‡Œç•™äº†ä¸€å¥è¯ï¼šâ€œåˆ°æ—¶å€™å»æŸ¥è¿™ä¸ª worker çš„è™šè¡¨(vtable)ï¼Œçœ‹å®ƒå¯¹åº”çš„ work å‡½æ•°åœ¨å“ªã€‚â€</span>

<span class="hljs-comment">// è¿è¡Œæ—¶ï¼š</span>
<span class="hljs-comment">// ç¨‹åºè·‘åˆ°äº†è¿™é‡Œï¼Œæ‹¿åˆ°äº† workerã€‚</span>
<span class="hljs-comment">// ç¨‹åºï¼šæŸ¥çœ‹ vtable -&gt; æ‰¾åˆ°å‡½æ•°åœ°å€ -&gt; è·³è½¬æ‰§è¡Œã€‚</span>
<span class="hljs-comment">// è¿™ä¸ªâ€œæŸ¥è¡¨-è·³è½¬â€çš„è¿‡ç¨‹ï¼Œå°±æ˜¯è¿è¡Œæ—¶çš„åŠ¨æ€åˆ†å‘ã€‚</span>
</code></pre>
<h3 data-id="heading-22">æ€»ç»“</h3>
<p><strong>Trait Object (<code>dyn Trait</code>)</strong> Â çš„ä½œç”¨å°±æ˜¯ï¼š</p>
<ol>
<li>
<p><strong>å¿˜æ‰èº«ä»½</strong>ï¼šæŠŠå…·ä½“çš„Â <code>User</code>ã€<code>Product</code>Â ç­‰ç±»å‹ä¿¡æ¯å¿˜æ‰ï¼Œåªè®°ä½å®ƒä»¬å®ç°äº†ä»€ä¹ˆ Traitã€‚</p>
</li>
<li>
<p><strong>ç»Ÿä¸€ç®¡ç†</strong>ï¼šè®©ä¸åŒçš„ç±»å‹èƒ½è¿›å…¥åŒä¸€ä¸ªå®¹å™¨ï¼ˆ<code>Vec</code>ï¼‰ï¼Œæˆ–è€…é€šè¿‡åŒä¸€ä¸ªå‡½æ•°æ¥å£ã€‚</p>
</li>
<li>
<p><strong>åŠ¨æ€å†³ç­–</strong>ï¼šæŠŠâ€œåˆ°åº•æ‰§è¡Œå“ªä¸ªå…·ä½“çš„å‡½æ•°â€è¿™ä¸ªå†³å®šï¼Œæ¨è¿Ÿåˆ°ç¨‹åºè¿è¡Œçš„æ—¶å€™å†åšã€‚</p>
</li>
</ol>
<p>æŒ‰â€œä¾§é‡ç‚¹â€åˆ‡åˆ†ï¼š</p>
<ul>
<li><strong>æ³›å‹ + PhantomData</strong>Â â†’Â ä¾§é‡Â  <strong>â€œææ•°æ®ç»“æ„â€</strong> ï¼ˆå®šå‹ã€èº«ä»½ã€å†…å­˜å¸ƒå±€ï¼‰ã€‚</li>
<li><strong>Trait Object</strong>Â â†’Â ä¾§é‡Â  <strong>â€œæå‡½æ•°â€</strong> ï¼ˆè°ƒç”¨ã€è¡Œä¸ºã€åŠ¨æ€åˆ†å‘ï¼‰ã€‚</li>
</ul>
<p>è¿™ä¸ªåˆ‡å…¥ç‚¹éå¸¸åˆé’»ä¸”æœ‰æ•ˆã€‚ä¸ºäº†å¸®ä½ è¾¾åˆ° 100% çš„ç†è§£ï¼Œæˆ‘ç¨å¾®å¸®ä½ <strong>å¾®è°ƒ</strong>ä¸€ä¸‹å®šä¹‰ï¼Œä½ ä¼šå‘ç°è±ç„¶å¼€æœ—ã€‚</p>
<p>æˆ‘ä»¬è¦ç”¨Â  <strong>â€œèº«ä»½ (Identity)â€</strong> Â å’ŒÂ  <strong>â€œèƒ½åŠ› (Capability)â€</strong> Â è¿™ä¸¤ä¸ªè¯æ¥åŒºåˆ†å®ƒä»¬ã€‚</p>
<hr/>
<h3 data-id="heading-23">1. æ³›å‹ + PhantomData = ä¾§é‡â€œèº«ä»½â€ (Identity)</h3>
<p><strong>â€”â€”â€œä½ æ˜¯è°ï¼Ÿâ€</strong></p>
<p>ä½ è¯´çš„â€œææ•°æ®ç»“æ„â€å®Œå…¨æ²¡æ¯›ç—…ã€‚è¿™å¥—æœºåˆ¶çš„æ ¸å¿ƒä»»åŠ¡å°±æ˜¯<strong>å®šä¹‰èº«ä»½</strong>ï¼Œç¡®ç«‹<strong>ä¸¥æ ¼çš„ç±»å‹è¾¹ç•Œ</strong>ã€‚</p>
<ul>
<li>
<p><strong>æ•°æ®ç»“æ„ä¸Š</strong>ï¼šå®ƒè´Ÿè´£ç”Ÿæˆ<strong>ä¸“ç”¨</strong>çš„å†…å­˜å¸ƒå±€ã€‚</p>
<ul>
<li><code>Identifier&lt;User&gt;</code>Â å’ŒÂ <code>Identifier&lt;Product&gt;</code>Â æ˜¯ä¸¤ä¸ªç‰©ç§ã€‚</li>
<li>è¿™å°±æ˜¯åœ¨å®šä¹‰â€œæˆ‘æ˜¯ User ä¸“ç”¨çš„ IDâ€ï¼Œæˆ–è€…â€œæˆ‘æ˜¯ Product ä¸“ç”¨çš„ IDâ€ã€‚</li>
<li><strong>PhantomData</strong>Â æ˜¯è¿™ä¸ªèº«ä»½çš„<strong>é˜²ä¼ªæ ‡ç­¾</strong>ï¼Œé˜²æ­¢ä½ åœ¨ç¼–è¯‘æœŸææ··èº«ä»½ã€‚</li>
</ul>
</li>
<li>
<p><strong>å‡½æ•°ä¸Š</strong>ï¼šå®ƒå…¶å®ä¹Ÿæå‡½æ•°ï¼Œä½†æ˜¯æ˜¯<strong>ä¸“ç”¨çš„å‡½æ•°</strong>ã€‚</p>
<ul>
<li>ç¼–è¯‘å™¨ç”Ÿæˆäº†Â <code>fn save_user()</code>Â å’ŒÂ <code>fn save_product()</code>ã€‚</li>
<li><strong>æ ¸å¿ƒé€»è¾‘</strong>ï¼šå› ä¸ºä½ æ˜¯Â <code>User</code>ï¼ˆèº«ä»½ï¼‰ï¼Œæ‰€ä»¥æˆ‘åªå‡†ä½ è°ƒÂ <code>User</code>Â çš„æ–¹æ³•ã€‚</li>
</ul>
</li>
</ul>
<p><strong>æ€»ç»“</strong>ï¼šè¿™ä¸€æ´¾æ˜¯Â  <strong>â€œçœ‹äººä¸‹èœç¢Ÿâ€</strong> ã€‚å› ä¸ºä½ çš„<strong>æ•°æ®ç»“æ„èº«ä»½</strong>ç¡®å®šäº†ï¼Œæ‰€ä»¥ä½ çš„ä»£ç é€»è¾‘å°±å®šæ­»äº†ã€‚</p>
<hr/>
<h3 data-id="heading-24">2. Trait Object = ä¾§é‡â€œèƒ½åŠ›â€ (Capability)</h3>
<p><strong>â€”â€”â€œä½ ä¼šå¹²ä»€ä¹ˆï¼Ÿâ€</strong></p>
<p>ä½ è¯´çš„â€œæå‡½æ•°â€ä¹Ÿéå¸¸åˆ°ä½ã€‚è¿™å¥—æœºåˆ¶çš„æ ¸å¿ƒä»»åŠ¡å°±æ˜¯<strong>æŠ¹å»èº«ä»½ï¼Œåªçœ‹è¡Œä¸º</strong>ã€‚</p>
<ul>
<li>
<p><strong>æ•°æ®ç»“æ„ä¸Š</strong>ï¼šå®ƒ<strong>ä¸åœ¨ä¹</strong>å…·ä½“çš„å†…å­˜å¸ƒå±€ã€‚</p>
<ul>
<li>å®ƒæŠŠæ•°æ®æ‰“åŒ…è¿›é»‘ç›’å­ï¼ˆèƒ–æŒ‡é’ˆï¼‰ã€‚</li>
<li>å®ƒè¯´ï¼šâ€œæˆ‘ä¸ç®¡ä½ æœ¬èº«æ˜¯åœ†çš„è¿˜æ˜¯æ‰çš„ï¼ˆæ˜¯ User è¿˜æ˜¯ Productï¼‰ï¼Œæˆ‘éƒ½æŠŠä½ å½“æˆä¸€ä¸ª<code>dyn Workable</code>â€ã€‚</li>
</ul>
</li>
<li>
<p><strong>å‡½æ•°ä¸Š</strong>ï¼šè¿™æ˜¯å®ƒçš„ä¸»æˆ˜åœºã€‚</p>
<ul>
<li>å®ƒé€šè¿‡ vtableï¼ˆè™šè¡¨ï¼‰æ¥åŠ¨æ€è°ƒç”¨å‡½æ•°ã€‚</li>
<li><strong>æ ¸å¿ƒé€»è¾‘</strong>ï¼šæˆ‘ä¸ç®¡ä½ æ˜¯è°ï¼Œåªè¦ä½ <strong>ä¼šå¹²æ´»</strong>ï¼ˆæœ‰è¿™ä¸ªå‡½æ•°ï¼‰ï¼Œæˆ‘å°±è°ƒä½ ã€‚</li>
</ul>
</li>
</ul>
<p><strong>æ€»ç»“</strong>ï¼šè¿™ä¸€æ´¾æ˜¯Â  <strong>â€œåªè¦ç»“æœâ€</strong> ã€‚å®ƒå¿½ç•¥æ•°æ®ç»“æ„çš„å·®å¼‚ï¼Œåªä¸ºäº†ç»Ÿä¸€æ‰§è¡Œ<strong>å‡½æ•°è°ƒç”¨</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-25">3. ç»ˆæå¯¹æ¯”å›¾ï¼šä¸€å¼ è¡¨ç†æ¸…â€œæä»€ä¹ˆâ€</h3>



































<table><thead><tr><th>ç»´åº¦</th><th><strong>æ³›å‹ + PhantomData</strong></th><th><strong>Trait Object (<code>dyn</code>)</strong></th></tr></thead><tbody><tr><td><strong>ä½ çš„æ€»ç»“</strong></td><td><strong>ææ•°æ®ç»“æ„</strong>Â (âœ… ä¾§é‡èº«ä»½å®šä¹‰)</td><td><strong>æå‡½æ•°</strong>Â (âœ… ä¾§é‡è¡Œä¸ºè°ƒç”¨)</td></tr><tr><td><strong>æ ¸å¿ƒå“²å­¦</strong></td><td><strong>ä¸¥è°¨çš„åˆ†ç±»å­¦</strong></td><td><strong>çµæ´»çš„å®ç”¨ä¸»ä¹‰</strong></td></tr><tr><td><strong>åœºæ™¯æ¯”å–»</strong></td><td><strong>èº«ä»½è¯ç³»ç»Ÿ</strong> æ¯ä¸ªäººéƒ½æœ‰å”¯ä¸€çš„èº«ä»½è¯ï¼Œä¸åŒçœä»½çš„äººä¸èƒ½ä¹±å½’ç±»ã€‚</td><td><strong>å…¨èƒ½å·¥è£…</strong> ä¸ç®¡ä½ æ˜¯è°ï¼Œç©¿ä¸Šè¿™èº«è¡£æœï¼ˆTraitï¼‰ï¼Œæˆ‘å°±è®©ä½ è¿›å·¥åœ°å¹²æ´»ã€‚</td></tr><tr><td><strong>ç¼–è¯‘å™¨æ€åº¦</strong></td><td>â€œæˆ‘è¦çŸ¥é“ä½ ç¥–å®—åå…«ä»£æ˜¯è°ï¼Œä¸€ç‚¹éƒ½ä¸èƒ½é”™ã€‚â€</td><td>â€œæˆ‘ä¸ç®¡ä½ æ˜¯è°ï¼ŒæŠŠæ´»å¹²äº†å°±è¡Œã€‚â€</td></tr><tr><td><strong>ä½•æ—¶ç”¨ï¼Ÿ</strong></td><td>å½“ä½ éœ€è¦<strong>ç±»å‹å®‰å…¨</strong>ï¼Œé˜²æ­¢å¼ å† ææˆ´æ—¶ã€‚ (å¦‚ï¼šé˜²æ­¢æŠŠç”¨æˆ·IDä¼ ç»™å•†å“API)</td><td>å½“ä½ éœ€è¦<strong>ç»Ÿä¸€ç®¡ç†</strong>ï¼Œå¤„ç†ä¸€å †æ‚ä¹±å¯¹è±¡æ—¶ã€‚ (å¦‚ï¼šæŠŠæŒ‰é’®ã€å›¾ç‰‡ã€æ–‡å­—éƒ½æ”¾åœ¨ä¸€ä¸ªåˆ—è¡¨é‡Œæ¸²æŸ“)</td></tr></tbody></table>
<h3 data-id="heading-26">4. ç»“è®º</h3>
<p>ä½ çš„ç†è§£åœ¨<strong>å®è§‚æ¶æ„</strong>ä¸Šæ˜¯å®Œå…¨æˆç«‹çš„ï¼š</p>
<ul>
<li>å½“æˆ‘ä»¬æƒ³<strong>åˆ©ç”¨ Rust çš„ç±»å‹ç³»ç»Ÿæ¥é˜²æ­¢ä¸šåŠ¡é€»è¾‘é”™è¯¯</strong>ï¼ˆæ¯”å¦‚é‚£ä¸ª ID æ··ç”¨çš„ä¾‹å­ï¼‰æ—¶ï¼Œæˆ‘ä»¬ç”¨Â <strong>æ³›å‹ + PhantomData</strong>ã€‚è¿™ç¡®å®æ˜¯åœ¨ç²¾å¿ƒè®¾è®¡<strong>æ•°æ®ç»“æ„</strong>ä¹‹é—´çš„å…³ç³»ã€‚</li>
<li>å½“æˆ‘ä»¬æƒ³<strong>åˆ©ç”¨ Rust çš„å¤šæ€æ€§æ¥å†™é€šç”¨çš„ä¸šåŠ¡ä»£ç </strong>ï¼ˆæ¯”å¦‚æ¸²æŸ“å™¨ã€æ’ä»¶ç³»ç»Ÿï¼‰æ—¶ï¼Œæˆ‘ä»¬ç”¨Â <strong>Trait Object</strong>ã€‚è¿™ç¡®å®æ˜¯åœ¨å…³æ³¨<strong>å‡½æ•°</strong>æ¥å£çš„ç»Ÿä¸€è°ƒç”¨ã€‚</li>
</ul>
<p><strong>æ‰€ä»¥ï¼Œç­”æ¡ˆæ˜¯ï¼šYesï¼è¿™ä¸ªäºŒåˆ†æ³•éå¸¸å®ç”¨ï¼Œå®Œå…¨å¯ä»¥ä½œä¸ºä½ å†™ Rust æ¶æ„æ—¶çš„æŒ‡å¯¼æ–¹é’ˆã€‚</strong></p>
<p><strong>ä¸€å¥è¯å£è¯€ï¼š</strong> Â <strong>æ³›å‹æ˜¯â€œåƒäººåƒé¢â€ï¼ˆç”Ÿæˆå¤šä»½ä»£ç ï¼‰ï¼ŒTrait Object æ˜¯â€œåƒäººä¸€é¢â€ï¼ˆç»Ÿä¸€æ¥å£ï¼ŒæŸ¥è¡¨æ‰§è¡Œï¼‰ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Maven æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼ˆæ ¸å¿ƒæ¦‚å¿µ + IDEA é›†æˆ + ä¾èµ–ç®¡ç† + å•å…ƒæµ‹è¯•å®æˆ˜ï¼‰]]></title>    <link>https://juejin.cn/post/7582872365522878502</link>    <guid>https://juejin.cn/post/7582872365522878502</guid>    <pubDate>2025-12-13T12:33:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582872365522878502" data-draft-id="7582875640308564018" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Maven æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼ˆæ ¸å¿ƒæ¦‚å¿µ + IDEA é›†æˆ + ä¾èµ–ç®¡ç† + å•å…ƒæµ‹è¯•å®æˆ˜ï¼‰"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-13T12:33:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜æ ¹æ ¹"/> <meta itemprop="url" content="https://juejin.cn/user/555679166786139"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Maven æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼ˆæ ¸å¿ƒæ¦‚å¿µ + IDEA é›†æˆ + ä¾èµ–ç®¡ç† + å•å…ƒæµ‹è¯•å®æˆ˜ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/555679166786139/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜æ ¹æ ¹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T12:33:42.000Z" title="Sat Dec 13 2025 12:33:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Maven ä½œä¸º Java ç”Ÿæ€ä¸­äº‹å®æ ‡å‡†çš„<strong>é¡¹ç›®ç®¡ç†ä¸æ„å»ºå·¥å…·</strong>ï¼Œå½»åº•è§£å†³äº†ä¼ ç»Ÿå¼€å‘ä¸­ â€œæ‰‹åŠ¨å¯¼åŒ…æ··ä¹±â€â€œé¡¹ç›®æ„å»ºç¹çâ€â€œå¤šæ¨¡å—åä½œå›°éš¾â€ ç­‰ç—›ç‚¹ã€‚å¯¹äºå¼€å‘è€…è€Œè¨€ï¼ŒæŒæ¡ Maven ä¸ä»…æ˜¯æå‡å¼€å‘æ•ˆç‡çš„åŸºç¡€ï¼Œæ›´æ˜¯ç†è§£ Java é¡¹ç›®å·¥ç¨‹åŒ–çš„å…³é”®ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« ä¼šä» Maven çš„æ ¸å¿ƒæ¦‚å¿µå…¥æ‰‹ï¼Œè¯¦ç»†è®²è§£å¦‚ä½•åœ¨ IDEA ä¸­é«˜æ•ˆé›†æˆ Mavenï¼Œæ·±å…¥å‰–æä¾èµ–ç®¡ç†çš„æ ¸å¿ƒæŠ€å·§ï¼ŒåŒæ—¶ç»“åˆ JUnit å®ç°å•å…ƒæµ‹è¯•çš„è‡ªåŠ¨åŒ–ï¼Œå¸®ä½ æ„å»ºå®Œæ•´çš„ Maven ä½¿ç”¨ä½“ç³»ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€Maven æ ¸å¿ƒè®¤çŸ¥ï¼šä»€ä¹ˆæ˜¯ Mavenï¼Ÿ</h2>
<h3 data-id="heading-1">1.1 Maven çš„å®šä¹‰ä¸æ ¸å¿ƒä»·å€¼</h3>
<p>Maven æ˜¯ Apache åŸºé‡‘ä¼šæ¨å‡ºçš„<strong>åŸºäº POMï¼ˆProject Object Modelï¼Œé¡¹ç›®å¯¹è±¡æ¨¡å‹ï¼‰</strong> Â çš„é¡¹ç›®ç®¡ç†å·¥å…·ï¼Œå…¶æ ¸å¿ƒä»·å€¼å¯æ¦‚æ‹¬ä¸º â€œ<strong>ä¸€ä¸ªä¸­å¿ƒï¼Œä¸‰ä¸ªåŸºæœ¬ç‚¹</strong>â€ï¼š</p>
<ul>
<li>
<p><strong>ä¸€ä¸ªä¸­å¿ƒ</strong>ï¼šä»¥<code>pom.xml</code>ä¸ºæ ¸å¿ƒï¼Œé›†ä¸­ç®¡ç†é¡¹ç›®æ‰€æœ‰é…ç½®ï¼›</p>
</li>
<li>
<p><strong>ä¸‰ä¸ªåŸºæœ¬ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>æ„å»ºè‡ªåŠ¨åŒ–</strong>ï¼šæ›¿ä»£æ‰‹åŠ¨ç¼–è¯‘ã€æ‰“åŒ…ã€æµ‹è¯•ã€éƒ¨ç½²ï¼Œé€šè¿‡æ ‡å‡†åŒ–å‘½ä»¤å®Œæˆå…¨æµç¨‹ï¼›</li>
<li><strong>ä¾èµ–ç®¡ç†æ ‡å‡†åŒ–</strong>ï¼šè‡ªåŠ¨ä¸‹è½½ã€ç®¡ç† jar åŒ…ï¼Œè§£å†³ä¾èµ–å†²çªï¼Œå‘Šåˆ« â€œå¤åˆ¶ç²˜è´´ jar åŒ…â€ çš„æ—¶ä»£ï¼›</li>
<li><strong>é¡¹ç›®ç»“æ„æ ‡å‡†åŒ–</strong>ï¼šå®šä¹‰ç»Ÿä¸€çš„ Java é¡¹ç›®ç›®å½•ç»“æ„ï¼Œå®ç°è·¨å›¢é˜Ÿåä½œçš„ä¸€è‡´æ€§ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-2">1.2 Maven çš„æ ¸å¿ƒæ¦‚å¿µ</h3>
<h4 data-id="heading-3">ï¼ˆ1ï¼‰POM æ–‡ä»¶</h4>
<p><code>pom.xml</code>æ˜¯ Maven é¡¹ç›®çš„ â€œçµé­‚â€ï¼Œä½äºé¡¹ç›®æ ¹ç›®å½•ï¼ŒåŒ…å«é¡¹ç›®çš„ GAV åæ ‡ã€ä¾èµ–é…ç½®ã€æ„å»ºæ’ä»¶ã€æ¨¡å—å…³ç³»ç­‰æ‰€æœ‰æ ¸å¿ƒä¿¡æ¯ã€‚Maven çš„æ‰€æœ‰æ“ä½œéƒ½å›´ç»• POM æ–‡ä»¶å±•å¼€ã€‚</p>
<h4 data-id="heading-4">ï¼ˆ2ï¼‰GAV åæ ‡</h4>
<p>Maven é€šè¿‡<strong>GroupId + ArtifactId + Version</strong>ï¼ˆGAVï¼‰ä¸ºæ¯ä¸ªé¡¹ç›® / ä¾èµ–èµ‹äºˆå”¯ä¸€æ ‡è¯†ï¼Œå¦‚åŒ â€œèº«ä»½è¯â€ï¼š</p>
<ul>
<li><strong>GroupId</strong>ï¼šç»„ç»‡ / å…¬å¸çš„å”¯ä¸€æ ‡è¯†ï¼ˆå¦‚<code>org.springframework.boot</code>ï¼‰ï¼›</li>
<li><strong>ArtifactId</strong>ï¼šé¡¹ç›® / æ¨¡å—çš„åç§°ï¼ˆå¦‚<code>spring-boot-starter-web</code>ï¼‰ï¼›</li>
<li><strong>Version</strong>ï¼šé¡¹ç›®ç‰ˆæœ¬ï¼ˆå¦‚<code>2.7.10</code>ï¼Œåˆ†ä¸ºå¿«ç…§ç‰ˆ<code>SNAPSHOT</code>å’Œæ­£å¼ç‰ˆ<code>RELEASE</code>ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-5">ï¼ˆ3ï¼‰ä»“åº“ä½“ç³»</h4>
<p>ä»“åº“æ˜¯ Maven å­˜å‚¨ä¾èµ– jar åŒ…çš„ä»“åº“ï¼Œåˆ†ä¸ºä¸‰çº§ç»“æ„ï¼š</p>
<ul>
<li><strong>æœ¬åœ°ä»“åº“</strong>ï¼šå¼€å‘è€…æœ¬åœ°ç”µè„‘çš„ç›®å½•ï¼ˆé»˜è®¤<code>~/.m2/repository</code>ï¼‰ï¼Œç¼“å­˜ä¸‹è½½çš„ä¾èµ–ï¼›</li>
<li><strong>ä¸­å¤®ä»“åº“</strong>ï¼šMaven å®˜æ–¹ç»´æŠ¤çš„è¿œç¨‹ä»“åº“ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Frepo.maven.apache.org%2Fmaven2" target="_blank" title="https://repo.maven.apache.org/maven2" ref="nofollow noopener noreferrer">repo.maven.apache.org/maven2</a>ï¼‰ï¼ŒåŒ…å«å‡ ä¹æ‰€æœ‰å¼€æº jar åŒ…ï¼›</li>
<li><strong>ç§æœä»“åº“</strong>ï¼šä¼ä¸šå†…éƒ¨æ­å»ºçš„ç§æœ‰ä»“åº“ï¼Œç”¨äºå­˜å‚¨å†…éƒ¨ç»„ä»¶å’Œç¼“å­˜ä¸­å¤®ä»“åº“ä¾èµ–ï¼ˆå¦‚ Nexusã€Artifactoryï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-6">ï¼ˆ4ï¼‰ç”Ÿå‘½å‘¨æœŸä¸æ’ä»¶</h4>
<p>Maven å®šä¹‰äº†ä¸‰å¥—æ ‡å‡†åŒ–çš„<strong>æ„å»ºç”Ÿå‘½å‘¨æœŸ</strong>ï¼ˆCleanã€Defaultã€Siteï¼‰ï¼Œæ¯ä¸ªç”Ÿå‘½å‘¨æœŸåŒ…å«å¤šä¸ªé˜¶æ®µï¼ˆå¦‚ Default ç”Ÿå‘½å‘¨æœŸçš„<code>compile</code>ã€<code>test</code>ã€<code>package</code>ï¼‰ï¼›è€Œæ¯ä¸ªé˜¶æ®µçš„å…·ä½“æ“ä½œç”±<strong>æ’ä»¶</strong>å®Œæˆï¼ˆå¦‚<code>maven-compiler-plugin</code>è´Ÿè´£ç¼–è¯‘ï¼Œ<code>maven-surefire-plugin</code>è´Ÿè´£å•å…ƒæµ‹è¯•ï¼‰ã€‚</p>
<h2 data-id="heading-7">äºŒã€IDEA é›†æˆ Mavenï¼šä»é…ç½®åˆ°é¡¹ç›®åˆ›å»º</h2>
<p>IDEA è‡ªå¸¦ Maven æ’ä»¶ï¼Œä½†ä¸ºäº†çµæ´»æ§åˆ¶ç‰ˆæœ¬å’Œé…ç½®ï¼Œæ¨èä½¿ç”¨<strong>è‡ªå®šä¹‰æœ¬åœ° Maven</strong>ã€‚ä»¥ä¸‹ä»¥ IDEA 2024.x ä¸ºä¾‹ï¼Œè®²è§£å®Œæ•´çš„é›†æˆæ­¥éª¤ã€‚</p>
<h3 data-id="heading-8">2.1 å‰æœŸå‡†å¤‡ï¼šä¸‹è½½å¹¶é…ç½® Maven</h3>
<h4 data-id="heading-9">æ­¥éª¤ 1ï¼šä¸‹è½½ Maven</h4>
<p>ä»<a href="https://link.juejin.cn?target=https%3A%2F%2Fmaven.apache.org%2Fdownload.cgi" target="_blank" title="https://maven.apache.org/download.cgi" ref="nofollow noopener noreferrer">Maven å®˜æ–¹ç½‘ç«™</a>ä¸‹è½½ç¨³å®šç‰ˆï¼ˆå¦‚ apache-maven-3.9.4ï¼‰ï¼Œè§£å‹åˆ°<strong>æ— ä¸­æ–‡ã€æ— ç©ºæ ¼</strong>çš„ç›®å½•ï¼ˆå¦‚<code>D:\apache-maven-3.9.4</code>ï¼‰ã€‚</p>
<h4 data-id="heading-10">æ­¥éª¤ 2ï¼šé…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼Œæ¨èï¼‰</h4>
<p>ä¸ºäº†åœ¨ä»»æ„ç›®å½•æ‰§è¡Œ Maven å‘½ä»¤ï¼Œé…ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼š</p>
<ol>
<li>æ–°å»º<code>MAVEN_HOME</code>ï¼Œå€¼ä¸º Maven è§£å‹ç›®å½•ï¼›</li>
<li>ç¼–è¾‘<code>Path</code>ï¼Œæ·»åŠ <code>%MAVEN_HOME%\bin</code>ï¼›</li>
<li>éªŒè¯ï¼šæ‰“å¼€å‘½ä»¤è¡Œï¼Œè¾“å…¥<code>mvn -v</code>ï¼Œæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯åˆ™é…ç½®æˆåŠŸã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/802790cfa40a4d0cb825a79a6214d510~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5qC55qC5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766234022&amp;x-signature=l7SpTbJ%2F8vuTMlHLDfJbX8jEQc4%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/175675e8f30b49c089ee4824b2eb80ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5qC55qC5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766234022&amp;x-signature=Igs%2Fj8RbP0fI6pOtYcsDEaqzGFc%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/123a8cfebaf34900921cdb68d42a752b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5qC55qC5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766234022&amp;x-signature=XNVXJneNqLPg2OWCB9wNGjnIe7Q%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d52abd8503a749a98aa80032d96e462f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5qC55qC5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766234022&amp;x-signature=1bVgD2pZSPodNM6O9yZbp1Eh7UU%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4d22c0271b204180b3ce057091e9ee40~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5qC55qC5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766234022&amp;x-signature=QWmvGhQMrHexTmgFA4o7paB0EUs%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff3d819826ff4488b0bb871fda92abf2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5qC55qC5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766234022&amp;x-signature=%2Bf1hj42Q4BqkadHxkCCq%2BX%2BSLEo%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a7905c0566614d0fad1508fca859bee1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5qC55qC5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766234022&amp;x-signature=cuCUj6VivFNSzMckk8LrXrCpokc%3D" alt="image.png" loading="lazy"/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/512b36a4128e41a48cd653f5b42de376~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5qC55qC5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766234022&amp;x-signature=YnFPRAR%2FQgFrSwqZvaDcNFtNKAw%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-11">æ­¥éª¤ 3ï¼šä¼˜åŒ– Maven é…ç½®ï¼ˆsettings.xmlï¼‰</h4>
<p>ä¿®æ”¹ Maven è§£å‹ç›®å½•ä¸‹<code>conf/settings.xml</code>ï¼Œè§£å†³ â€œä¸‹è½½æ…¢â€ å’Œ â€œC ç›˜å ç”¨â€ é—®é¢˜ï¼š</p>
<h5 data-id="heading-12">ï¼ˆ1ï¼‰é…ç½®æœ¬åœ°ä»“åº“è·¯å¾„</h5>
<p>å°†é»˜è®¤çš„ C ç›˜æœ¬åœ°ä»“åº“æ”¹ä¸ºéç³»ç»Ÿç›˜ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- æœ¬åœ°ä»“åº“è·¯å¾„ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">localRepository</span>&gt;</span>D:\java\apache-maven-3.9.4\mvn_repo\<span class="hljs-tag">&lt;/<span class="hljs-name">localRepository</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span>
</code></pre>
<h5 data-id="heading-13">ï¼ˆ2ï¼‰é…ç½®é˜¿é‡Œäº‘é•œåƒï¼ˆåŠ é€Ÿä¾èµ–ä¸‹è½½ï¼‰</h5>
<p>å›½å†…è®¿é—®ä¸­å¤®ä»“åº“é€Ÿåº¦æ…¢ï¼Œé…ç½®é˜¿é‡Œäº‘é•œåƒï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">mirrors</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mirror</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>alimaven<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>aliyun maven<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public/<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">mirrorOf</span>&gt;</span>central<span class="hljs-tag">&lt;/<span class="hljs-name">mirrorOf</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">mirror</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">mirrors</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span>
</code></pre>
<h3 data-id="heading-14">2.2 IDEA ä¸­é…ç½® Maven</h3>
<h4 data-id="heading-15">æ­¥éª¤ 1ï¼šæ‰“å¼€ Maven é…ç½®ç•Œé¢</h4>
<p>ä¾æ¬¡ç‚¹å‡»<code>File &gt; Settings</code>ï¼ˆWindows/Linuxï¼‰æˆ–<code>IntelliJ IDEA &gt; Settings</code>ï¼ˆMacï¼‰ï¼Œæ‰¾åˆ°<code>Build, Execution, Deployment &gt; Build Tools &gt; Maven</code>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85a80bf9e5ad414688574d71f66337a4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5qC55qC5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766234022&amp;x-signature=HIlnDT5uMru0Pd2PZmXuCRCR8qE%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-16">æ­¥éª¤ 2ï¼šé…ç½®æ ¸å¿ƒå‚æ•°</h4>

























<table><thead><tr><th>å‚æ•°</th><th>é…ç½®å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>Maven home directory</td><td>æœ¬åœ° Maven è§£å‹ç›®å½•ï¼ˆå¦‚<code>D:\apache-maven-3.9.6</code>ï¼‰</td><td>ä¸ä½¿ç”¨ IDEA è‡ªå¸¦ Mavenï¼Œé¿å…ç‰ˆæœ¬é”å®š</td></tr><tr><td>User settings file</td><td>ä¿®æ”¹åçš„<code>settings.xml</code>è·¯å¾„</td><td>å‹¾é€‰<code>Override</code>ï¼Œå¼ºåˆ¶ä½¿ç”¨è‡ªå®šä¹‰é…ç½®</td></tr><tr><td>Local repository</td><td>è‡ªåŠ¨è¯»å–<code>settings.xml</code>é…ç½®</td><td>æ— éœ€æ‰‹åŠ¨ä¿®æ”¹</td></tr></tbody></table>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e95b373a3e04841958cb8151400cce1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5qC55qC5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766234022&amp;x-signature=KHy7EunNvwzQgWd2poLHqq%2BErSc%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-17">æ­¥éª¤ 3ï¼šé…ç½® Maven è¿è¡Œ JDK</h4>
<p>åœ¨<code>Maven &gt; Runner</code>ä¸­ï¼Œé€‰æ‹©<code>JRE</code>ä¸ºé¡¹ç›®ä½¿ç”¨çš„ JDK ç‰ˆæœ¬ï¼ˆå¦‚ JDK 17ï¼‰ï¼Œé¿å…ç¼–è¯‘æ—¶ JDK ç‰ˆæœ¬ä¸å…¼å®¹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/551fa64c02734957ae4ecba511b9af57~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5qC55qC5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766234022&amp;x-signature=llrwe%2Bt0h25OP5NlA68IjdIqnHY%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90d8ca4447f64f90a79d3d2586bf1a4b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5qC55qC5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766234022&amp;x-signature=JxdAoG2htu7VQ30PP8YTBA3HEXg%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-18">2.3 åœ¨ IDEA ä¸­åˆ›å»º Maven é¡¹ç›®</h3>
<h4 data-id="heading-19">æ–¹å¼ 1ï¼šåˆ›å»ºæ™®é€š Maven é¡¹ç›®</h4>
<ol>
<li>ç‚¹å‡»<code>File &gt; New &gt; Project</code>ï¼Œå·¦ä¾§é€‰æ‹©<code>Maven</code>ï¼Œå–æ¶ˆå‹¾é€‰<code>Create from archetype</code>ï¼›</li>
<li>å¡«å†™ GAV ä¿¡æ¯ï¼ˆå¦‚<code>com.xxx</code>ã€<code>maven-demo</code>ã€<code>1.0-SNAPSHOT</code>ï¼‰ï¼›</li>
<li>é€‰æ‹©å­˜å‚¨è·¯å¾„ï¼Œç‚¹å‡»<code>Create</code>ï¼Œç”Ÿæˆæ ‡å‡† Maven é¡¹ç›®ç»“æ„ã€‚</li>
</ol>
<h4 data-id="heading-20">æ–¹å¼ 2ï¼šåˆ›å»ºå¤šæ¨¡å— Maven é¡¹ç›®</h4>
<ol>
<li>å…ˆåˆ›å»ºçˆ¶æ¨¡å—ï¼ˆæ™®é€š Maven é¡¹ç›®ï¼‰ï¼›</li>
<li>å³é”®çˆ¶æ¨¡å— â†’Â <code>New &gt; Module</code>ï¼Œåˆ›å»ºå­æ¨¡å—ï¼ˆå¦‚<code>module-common</code>ã€<code>module-service</code>ï¼‰ï¼›</li>
<li>çˆ¶æ¨¡å—<code>pom.xml</code>ä¼šè‡ªåŠ¨ç”Ÿæˆ<code>&lt;modules&gt;</code>æ ‡ç­¾ï¼Œç®¡ç†å­æ¨¡å—ä¾èµ–ã€‚</li>
</ol>
<h3 data-id="heading-21">2.4 IDEA ä¸­ Maven çš„å¸¸ç”¨æ“ä½œ</h3>
<p>IDEA å³ä¾§çš„<code>Maven</code>çª—å£é›†æˆäº†æ‰€æœ‰å¸¸ç”¨æ“ä½œï¼š</p>
<ul>
<li><strong>Reload All Maven Projects</strong>ï¼šä¿®æ”¹<code>pom.xml</code>åé‡æ–°åŠ è½½ï¼›</li>
<li><strong>Clean</strong>ï¼šæ¸…ç†ç¼–è¯‘åçš„<code>target</code>ç›®å½•ï¼›</li>
<li><strong>Compile</strong>ï¼šç¼–è¯‘ Java ä»£ç ï¼›</li>
<li><strong>Test</strong>ï¼šè¿è¡Œå•å…ƒæµ‹è¯•ï¼›</li>
<li><strong>Package</strong>ï¼šæ‰“åŒ…ç”Ÿæˆ jar/war åŒ…ï¼›</li>
<li><strong>Install</strong>ï¼šå°†é¡¹ç›®å®‰è£…åˆ°æœ¬åœ°ä»“åº“ã€‚</li>
</ul>
<h2 data-id="heading-22">ä¸‰ã€Maven ä¾èµ–ç®¡ç†ï¼šæ ¸å¿ƒæŠ€å·§ä¸å†²çªè§£å†³</h2>
<p>ä¾èµ–ç®¡ç†æ˜¯ Maven çš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒæŒæ¡ä»¥ä¸‹æŠ€å·§å¯è§£å†³ 90% çš„ä¾èµ–é—®é¢˜ã€‚</p>
<h3 data-id="heading-23">3.1 ä¾èµ–çš„åŸºæœ¬é…ç½®</h3>
<p>åœ¨<code>pom.xml</code>çš„<code>&lt;dependencies&gt;</code>æ ‡ç­¾ä¸­æ·»åŠ ä¾èµ–ï¼Œä»¥å¼•å…¥ hutool ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- hutoolä¾èµ– --&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.hutool<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hutool-all<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.8.27<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<p>æ·»åŠ åç‚¹å‡»<code>Reload All Maven Projects</code>ï¼ŒMaven ä¼šè‡ªåŠ¨ä¸‹è½½ä¾èµ–å¹¶å¼•å…¥é¡¹ç›®ã€‚</p>
<p><strong>å¯¼å…¥æˆåŠŸä»£ç å®ç°</strong></p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
    <span class="hljs-comment">//å°†ç»™å®šçš„å­—ç¬¦ä¸²è¿›è¡Œåè½¬ï¼Œä½¿ç”¨ç³Šæ¶‚å·¥å…·StrUtil</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-string">"æ ¹æ ¹çš„hutoolå·¥å…·"</span>;
    <span class="hljs-type">String</span> <span class="hljs-variable">reverse</span> <span class="hljs-operator">=</span> StrUtil.reverse(s);
    System.out.println(reverse);
}
</code></pre>
<h3 data-id="heading-24">3.2 ä¾èµ–èŒƒå›´ï¼ˆScopeï¼‰ï¼šæ§åˆ¶ä¾èµ–çš„ç”Ÿæ•ˆé˜¶æ®µ</h3>
<p>ä¾èµ–èŒƒå›´å†³å®šäº†ä¾èµ–åœ¨é¡¹ç›®ç”Ÿå‘½å‘¨æœŸä¸­çš„ç”Ÿæ•ˆèŒƒå›´ï¼Œå¸¸ç”¨èŒƒå›´å¦‚ä¸‹ï¼š</p>













































<table><thead><tr><th>èŒƒå›´</th><th>ç¼–è¯‘æœŸ</th><th>æµ‹è¯•æœŸ</th><th>è¿è¡ŒæœŸ</th><th>æ‰“åŒ…æ—¶</th><th>å…¸å‹åº”ç”¨</th></tr></thead><tbody><tr><td>compileï¼ˆé»˜è®¤ï¼‰</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>æ ¸å¿ƒä¸šåŠ¡ä¾èµ–ï¼ˆå¦‚ spring-coreï¼‰</td></tr><tr><td>test</td><td>âŒ</td><td>âœ…</td><td>âŒ</td><td>âŒ</td><td>æµ‹è¯•ä¾èµ–ï¼ˆå¦‚ JUnitï¼‰</td></tr><tr><td>provided</td><td>âœ…</td><td>âœ…</td><td>âŒ</td><td>âŒ</td><td>å®¹å™¨æä¾›çš„ä¾èµ–ï¼ˆå¦‚ servlet-apiï¼‰</td></tr><tr><td>runtime</td><td>âŒ</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>è¿è¡Œæ—¶ä¾èµ–ï¼ˆå¦‚æ•°æ®åº“é©±åŠ¨ï¼‰</td></tr></tbody></table>
<p><strong>ç¤ºä¾‹ï¼šå¼•å…¥ JUnit æµ‹è¯•ä¾èµ–</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!--junit--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.junit.jupiter<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit-jupiter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.9.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-25">3.3 ä¾èµ–ä¼ é€’ä¸æ’é™¤</h3>
<h4 data-id="heading-26">ï¼ˆ1ï¼‰ä¾èµ–ä¼ é€’</h4>
<p>Maven çš„ä¾èµ–å…·æœ‰ä¼ é€’æ€§ï¼šè‹¥ A ä¾èµ– Bï¼ŒB ä¾èµ– Cï¼Œåˆ™ A ä¼šè‡ªåŠ¨ä¾èµ– Cï¼Œæ— éœ€æ‰‹åŠ¨å¼•å…¥ã€‚</p>
<h4 data-id="heading-27">ï¼ˆ2ï¼‰ä¾èµ–æ’é™¤</h4>
<p>è‹¥éœ€æ’é™¤ä¸å¿…è¦çš„ä¼ é€’ä¾èµ–ï¼ˆå¦‚è§£å†³å†²çªï¼‰ï¼Œä½¿ç”¨<code>&lt;exclusions&gt;</code>æ ‡ç­¾ï¼š</p>
<pre><code class="hljs language-xml" lang="xml">    <span class="hljs-comment">&lt;!--spring-context--&gt;</span>
    <span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-context --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-context<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>7.0.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-comment">&lt;!--ä¾èµ–æ’é™¤aop: ä»¥åé¡¹ç›®ä¸­jaråŒ…é‚®å†²çªå°±ä¼šæ’é™¤è§£å†³--&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-aop<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h2 data-id="heading-28">å››ã€Maven é›†æˆå•å…ƒæµ‹è¯•ï¼šJUnit å®æˆ˜</h2>
<p>å•å…ƒæµ‹è¯•æ˜¯ä¿éšœä»£ç è´¨é‡çš„å…³é”®ï¼ŒMaven ä¸ JUnit çš„é›†æˆå¯å®ç°æµ‹è¯•è‡ªåŠ¨åŒ–ï¼Œä»¥ä¸‹ä»¥ JUnit 4 å’Œ JUnit 5 ä¸ºä¾‹è®²è§£å®æˆ˜ã€‚</p>
<h3 data-id="heading-29">4.1 å¼•å…¥ JUnit ä¾èµ–</h3>
<h4 data-id="heading-30">JUnit 5ï¼ˆJupiterï¼‰ä¾èµ–é…ç½®</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-comment">&lt;!--junit--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.junit.jupiter<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit-jupiter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.9.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h3 data-id="heading-31">4.2 ç¼–å†™å•å…ƒæµ‹è¯•ç”¨ä¾‹</h3>
<p>Maven è§„å®šæµ‹è¯•ä»£ç å¿…é¡»æ”¾åœ¨<code>src/test/java</code>ç›®å½•ä¸‹ï¼Œä¸ä¸»ä»£ç ç›®å½•<code>src/main/java</code>å¯¹åº”ã€‚</p>
<h4 data-id="heading-32">ç¤ºä¾‹ ï¼šJUnit 5 æµ‹è¯•ç”¨ä¾‹</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.xxx;

<span class="hljs-keyword">import</span> org.junit.jupiter.api.Test;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.jupiter.api.Assertions.assertEquals;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CalculatorTest</span> {
    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testAdd</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Calculator</span> <span class="hljs-variable">calculator</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Calculator</span>();
        <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> calculator.add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
        assertEquals(<span class="hljs-number">3</span>, result);
    }
}
</code></pre>
<h3 data-id="heading-33">4.3 è¿è¡Œå•å…ƒæµ‹è¯•</h3>
<h4 data-id="heading-34">æ–¹å¼ 1ï¼šåœ¨ IDEA ä¸­ç›´æ¥è¿è¡Œ</h4>
<p>å³é”®æµ‹è¯•ç±» / æ–¹æ³•ï¼Œé€‰æ‹©<code>Run 'CalculatorTest'</code>ï¼ŒIDEA ä¼šè‡ªåŠ¨æ‰§è¡Œæµ‹è¯•å¹¶æ˜¾ç¤ºç»“æœã€‚</p>
<h4 data-id="heading-35">æ–¹å¼ 2ï¼šé€šè¿‡ Maven å‘½ä»¤è¿è¡Œ</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿è¡Œæ‰€æœ‰æµ‹è¯•ç”¨ä¾‹</span>
mvn <span class="hljs-built_in">test</span>

<span class="hljs-comment"># æ‰“åŒ…æ—¶è·³è¿‡æµ‹è¯•ï¼ˆé¿å…æµ‹è¯•å¤±è´¥å¯¼è‡´æ‰“åŒ…å¤±è´¥ï¼‰</span>
mvn clean package -DskipTests
</code></pre>
<h3 data-id="heading-36">4.4 æµ‹è¯•ç»“æœåˆ†æä¸æ’ä»¶é…ç½®</h3>
<h4 data-id="heading-37">ï¼ˆ1ï¼‰æµ‹è¯•ç»“æœæŠ¥å‘Š</h4>
<p>Maven ä¼šå°†æµ‹è¯•ç»“æœè¾“å‡ºåˆ°<code>target/surefire-reports</code>ç›®å½•ï¼Œç”Ÿæˆ HTML å’Œ XML æ ¼å¼çš„æŠ¥å‘Šï¼Œæ–¹ä¾¿æŸ¥çœ‹æµ‹è¯•é€šè¿‡ç‡å’Œå¤±è´¥åŸå› ã€‚</p>
<h4 data-id="heading-38">ï¼ˆ2ï¼‰é…ç½®æµ‹è¯•æ’ä»¶ï¼ˆmaven-surefire-pluginï¼‰</h4>
<p>é€šè¿‡æ’ä»¶å¯è‡ªå®šä¹‰æµ‹è¯•è§„åˆ™ï¼Œå¦‚æŒ‡å®šæµ‹è¯•ç±»ã€è·³è¿‡ç‰¹å®šæµ‹è¯•ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.0.0-M7<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>
                <span class="hljs-comment">&lt;!-- åªè¿è¡Œä»¥Testç»“å°¾çš„æµ‹è¯•ç±» --&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*Test.java<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>
</code></pre>
<h3 data-id="heading-39">4.5 å•å…ƒæµ‹è¯•æœ€ä½³å®è·µ</h3>
<ol>
<li><strong>æµ‹è¯•ç±»å‘½å</strong>ï¼šè¢«æµ‹è¯•ç±»å +<code>Test</code>ï¼ˆå¦‚<code>CalculatorTest</code>ï¼‰ï¼›</li>
<li><strong>æµ‹è¯•æ–¹æ³•å‘½å</strong>ï¼š<code>test</code>+ è¢«æµ‹è¯•æ–¹æ³•åï¼ˆå¦‚<code>testAdd</code>ï¼‰ï¼›</li>
<li><strong>å•ä¸€èŒè´£</strong>ï¼šæ¯ä¸ªæµ‹è¯•æ–¹æ³•åªæµ‹è¯•ä¸€ä¸ªåŠŸèƒ½ç‚¹ï¼›</li>
<li><strong>æ–­è¨€æ˜ç¡®</strong>ï¼šä½¿ç”¨å…·ä½“çš„æ–­è¨€æ–¹æ³•ï¼ˆå¦‚<code>assertEquals</code>ã€<code>assertTrue</code>ï¼‰ï¼Œé¿å…æ¨¡ç³Šæ–­è¨€ã€‚</li>
</ol>
<h2 data-id="heading-40">äº”ã€Maven å¸¸ç”¨å‘½ä»¤ä¸å®æˆ˜æŠ€å·§</h2>
<h3 data-id="heading-41">5.1 é«˜é¢‘ Maven å‘½ä»¤</h3>









































<table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>mvn clean</code></td><td>æ¸…ç†<code>target</code>ç›®å½•</td></tr><tr><td><code>mvn compile</code></td><td>ç¼–è¯‘ä¸»ä»£ç </td></tr><tr><td><code>mvn test</code></td><td>è¿è¡Œå•å…ƒæµ‹è¯•</td></tr><tr><td><code>mvn package</code></td><td>æ‰“åŒ…ç”Ÿæˆ jar/war åŒ…</td></tr><tr><td><code>mvn install</code></td><td>å®‰è£…åˆ°æœ¬åœ°ä»“åº“</td></tr><tr><td><code>mvn deploy</code></td><td>éƒ¨ç½²åˆ°è¿œç¨‹ç§æœ</td></tr><tr><td><code>mvn dependency:tree</code></td><td>æŸ¥çœ‹ä¾èµ–æ ‘</td></tr><tr><td><code>mvn clean verify</code></td><td>æ‰§è¡Œå®Œæ•´çš„æ„å»ºå‘¨æœŸï¼ˆå«æµ‹è¯•ã€æ£€æŸ¥ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-42">5.2 å®æˆ˜æŠ€å·§</h3>
<ol>
<li>
<p><strong>ç»Ÿä¸€ JDK ç¼–è¯‘ç‰ˆæœ¬</strong>ï¼šé¿å…ä¸åŒå¼€å‘è€… JDK ç‰ˆæœ¬ä¸ä¸€è‡´å¯¼è‡´çš„ç¼–è¯‘é”™è¯¯ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.8.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">source</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">source</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">target</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">target</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>
</code></pre>
</li>
<li>
<p><strong>å¤šæ¨¡å—é¡¹ç›®çš„ä¾èµ–ç»§æ‰¿</strong>ï¼šçˆ¶æ¨¡å—é€šè¿‡<code>&lt;dependencyManagement&gt;</code>ç»Ÿä¸€ç®¡ç†ç‰ˆæœ¬ï¼Œå­æ¨¡å—ç›´æ¥å¼•å…¥æ— éœ€æŒ‡å®šç‰ˆæœ¬ï¼›</p>
</li>
<li>
<p><strong>ä½¿ç”¨å¿«ç…§ç‰ˆä¾èµ–</strong>ï¼šå¼€å‘é˜¶æ®µä½¿ç”¨<code>SNAPSHOT</code>ç‰ˆæœ¬ï¼ŒMaven ä¼šè‡ªåŠ¨æ‹‰å–æœ€æ–°çš„å¿«ç…§åŒ…ï¼Œæ–¹ä¾¿å›¢é˜Ÿåä½œã€‚</p>
</li>
</ol>
<h2 data-id="heading-43">å…­ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-44">6.1 ä¾èµ–ä¸‹è½½å¤±è´¥</h3>
<ul>
<li><strong>åŸå› </strong>ï¼šç½‘ç»œé—®é¢˜ã€é•œåƒé…ç½®é”™è¯¯ã€æœ¬åœ°ä»“åº“ç¼“å­˜æŸåï¼›</li>
<li><strong>è§£å†³</strong>ï¼šæ£€æŸ¥é•œåƒé…ç½®ã€åˆ é™¤æœ¬åœ°ä»“åº“ä¸­å¯¹åº”ä¾èµ–ç›®å½•ã€é‡æ–°æ‰§è¡Œ<code>mvn clean install</code>ã€‚</li>
</ul>
<h3 data-id="heading-45">6.2 æµ‹è¯•ç”¨ä¾‹è¿è¡Œå¤±è´¥</h3>
<ul>
<li><strong>åŸå› </strong>ï¼šæµ‹è¯•ä»£ç é”™è¯¯ã€ä¾èµ–ç¼ºå¤±ã€JDK ç‰ˆæœ¬ä¸å…¼å®¹ï¼›</li>
<li><strong>è§£å†³</strong>ï¼šæ£€æŸ¥æµ‹è¯•ä»£ç æ–­è¨€ã€ç¡®è®¤ JUnit ä¾èµ–æ˜¯å¦æ­£ç¡®å¼•å…¥ã€é…ç½®æµ‹è¯•æ’ä»¶çš„ JDK ç‰ˆæœ¬ã€‚</li>
</ul>
<h3 data-id="heading-46">6.3 IDEA ä¸­ pom.xml ä¿®æ”¹åä¸ç”Ÿæ•ˆ</h3>
<ul>
<li><strong>è§£å†³</strong>ï¼šç‚¹å‡»å³ä¾§ Maven çª—å£çš„<code>Reload All Maven Projects</code>ï¼Œæˆ–æŒ‰<code>Ctrl+Shift+O</code>é‡æ–°å¯¼å…¥ã€‚</li>
</ul>
<h2 data-id="heading-47">ä¸ƒã€æ€»ç»“ä¸å»¶ä¼¸</h2>
<h3 data-id="heading-48">7.1 æ ¸å¿ƒæ€»ç»“</h3>
<ol>
<li>Maven çš„æ ¸å¿ƒæ˜¯ POM æ–‡ä»¶ï¼Œé€šè¿‡ GAV åæ ‡å’Œä»“åº“ä½“ç³»å®ç°ä¾èµ–çš„æ ‡å‡†åŒ–ç®¡ç†ï¼›</li>
<li>åœ¨ IDEA ä¸­é›†æˆ Maven çš„å…³é”®æ˜¯é…ç½®è‡ªå®šä¹‰ Maven è·¯å¾„å’Œé˜¿é‡Œäº‘é•œåƒï¼Œæå‡ä½¿ç”¨æ•ˆç‡ï¼›</li>
<li>ä¾èµ–ç®¡ç†çš„æ ¸å¿ƒæ˜¯æŒæ¡ä¾èµ–èŒƒå›´ã€ä¼ é€’æ€§å’Œå†²çªè§£å†³ï¼Œé€šè¿‡<code>&lt;dependencyManagement&gt;</code>ç»Ÿä¸€ç‰ˆæœ¬ï¼›</li>
<li>Maven ä¸ JUnit çš„é›†æˆå®ç°äº†å•å…ƒæµ‹è¯•è‡ªåŠ¨åŒ–ï¼Œæ˜¯ä¿éšœä»£ç è´¨é‡çš„é‡è¦æ‰‹æ®µã€‚</li>
</ol>
<h3 data-id="heading-49">7.2 åç»­å­¦ä¹ å»¶ä¼¸</h3>
<ul>
<li><strong>Maven é«˜çº§ç”¨æ³•</strong>ï¼šå­¦ä¹ èšåˆå·¥ç¨‹ã€ç»§æ‰¿ã€æ’ä»¶å¼€å‘ã€ç§æœæ­å»ºï¼ˆNexusï¼‰ï¼›</li>
<li><strong>æ„å»ºå·¥å…·å¯¹æ¯”</strong>ï¼šäº†è§£ Gradle çš„ä¼˜åŠ¿ä¸ä½¿ç”¨ï¼ˆæ–°ä¸€ä»£æ„å»ºå·¥å…·ï¼Œæ¯” Maven æ›´é«˜æ•ˆï¼‰ï¼›</li>
<li><strong>CI/CD é›†æˆ</strong>ï¼šå°† Maven ä¸ Jenkins é›†æˆï¼Œå®ç°è‡ªåŠ¨åŒ–æ„å»ºã€æµ‹è¯•ã€éƒ¨ç½²ã€‚</li>
</ul>
<p>Maven æ˜¯ Java å¼€å‘çš„åŸºç¡€å·¥å…·ï¼ŒæŒæ¡å®ƒä¸ä»…èƒ½å¤§å¹…æå‡å¼€å‘æ•ˆç‡ï¼Œæ›´èƒ½å¸®åŠ©ä½ ç†è§£ Java é¡¹ç›®çš„å·¥ç¨‹åŒ–æ€æƒ³ã€‚å»ºè®®åœ¨å®é™…é¡¹ç›®ä¸­å¤šåŠ¨æ‰‹å®è·µï¼Œé‡åˆ°é—®é¢˜æ—¶é€šè¿‡ä¾èµ–æ ‘å’Œæ—¥å¿—å¿«é€Ÿå®šä½è§£å†³ï¼Œé€æ­¥å½¢æˆè‡ªå·±çš„ Maven ä½¿ç”¨ä½“ç³»ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Flaskç”Ÿäº§çº§æ¨¡æ¿ï¼šç»Ÿä¸€è¿”å›ã€æ—¥å¿—ã€å¼‚å¸¸ã€JSONç¼–è§£ç ï¼Œå¼€ç®±å³ç”¨å¯æ‰©å±•]]></title>    <link>https://juejin.cn/post/7582848701268623395</link>    <guid>https://juejin.cn/post/7582848701268623395</guid>    <pubDate>2025-12-13T12:41:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582848701268623395" data-draft-id="7582861402278510626" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Flaskç”Ÿäº§çº§æ¨¡æ¿ï¼šç»Ÿä¸€è¿”å›ã€æ—¥å¿—ã€å¼‚å¸¸ã€JSONç¼–è§£ç ï¼Œå¼€ç®±å³ç”¨å¯æ‰©å±•"/> <meta itemprop="keywords" content="Python,åç«¯"/> <meta itemprop="datePublished" content="2025-12-13T12:41:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="èµ·é£äº†___"/> <meta itemprop="url" content="https://juejin.cn/user/3298190615395896"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Flaskç”Ÿäº§çº§æ¨¡æ¿ï¼šç»Ÿä¸€è¿”å›ã€æ—¥å¿—ã€å¼‚å¸¸ã€JSONç¼–è§£ç ï¼Œå¼€ç®±å³ç”¨å¯æ‰©å±•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3298190615395896/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    èµ·é£äº†___
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T12:41:51.000Z" title="Sat Dec 13 2025 12:41:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ–‡ç« ç®€ä»‹</h2>
<ul>
<li>ä¸€ç›´åœ¨ç”¨ Python å†™ä¸€äº›è„šæœ¬ï¼Œæœ€è¿‘æƒ³é€šè¿‡å…¶ä»–æœåŠ¡è°ƒç”¨ Python è„šæœ¬ï¼Œæ‰€ä»¥ç”¨ Flask æ­æœåŠ¡æš´éœ²æ¥å£è®©å…¶ä»–æœåŠ¡è°ƒç”¨ã€‚ç°åœ¨å°†è¿™ä¸ªæœåŠ¡ä¸­çš„ä¸€äº›åŸºç¡€èƒ½åŠ›æŠ½å‡ºæ¥ä½œä¸ºæ¨¡ç‰ˆã€‚</li>
<li>æ¨¡ç‰ˆæä¾›ä»¥ä¸‹èƒ½åŠ›ï¼š
<ul>
<li>ç»Ÿä¸€è¿”å›æ•°æ®æ ¼å¼</li>
<li>ç»Ÿä¸€ä¸ºè¿”å›æ•°æ®è®¾ç½®å¯¹è±¡çš„ json ç¼–è§£ç å™¨</li>
<li>æ—¥å¿—åŒæ—¶è¾“å‡ºè‡³æ§åˆ¶å°ã€æ–‡ä»¶ï¼Œæ—¥å¿—æ–‡ä»¶è‡ªåŠ¨æˆªæ–­</li>
<li>ç»Ÿä¸€æ•è·å¼‚å¸¸ä¿¡æ¯</li>
</ul>
</li>
<li>ä»£ç æ”¾åœ¨ Github ä¸Šï¼Œåç»­æœ‰èƒ½å¤Ÿä½œä¸ºé€šç”¨èƒ½åŠ›çš„åŠŸèƒ½éƒ½ä¼šæ›´æ–°åœ¨ä»“åº“ä¸­
<ul>
<li>ä»“åº“åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fthe-wind-is-rising-dev%2Fflask-server-template.git" target="_blank" title="https://github.com/the-wind-is-rising-dev/flask-server-template.git" ref="nofollow noopener noreferrer">github.com/the-wind-isâ€¦</a></li>
</ul>
</li>
<li>å‹æƒ…æç¤ºï¼šä¸å»ºè®®ç›´æ¥å…‹éš†æ¨¡ç‰ˆä»“åº“æ¥æ­å»ºå·¥ç¨‹ï¼Œå»ºè®®æŒ‰éœ€å¤åˆ¶æ‰€éœ€ä»£ç ï¼Œè‡ªè¡Œæ­å»º</li>
</ul>
<h2 data-id="heading-1">ä¾èµ–ä¿¡æ¯</h2>
<p>æ­¤å¤„çš„ä¾èµ–ä¿¡æ¯å¯èƒ½ä¸å…¨ï¼Œè¿˜è¯·éœ€è¦çš„æœ‹å‹è‡ªè¡ŒæŸ¥æ‰¾æ‰€éœ€ä¾èµ–</p>
<ul>
<li>flaskï¼šFlask æ¡†æ¶</li>
<li>numpyï¼šåªç”¨äºæ¼”ç¤ºç»Ÿä¸€çš„ json ç¼–è§£ç å™¨</li>
<li>loggingï¼šæ—¥å¿—æ¨¡å—</li>
</ul>
<h2 data-id="heading-2">ç»Ÿä¸€è¿”å›æ•°æ®æ ¼å¼</h2>
<ul>
<li>ä»£ç ä½ç½®æ–‡ä»¶ï¼šsrc/controller/result.py</li>
<li>æ•°æ®ç»“æ„ï¼š
<ul>
<li>successï¼šæ¥å£æ˜¯å¦æˆåŠŸ</li>
<li>resultï¼šå“åº”ç»“æœ</li>
<li>messageï¼šæ¥å£ä¿¡æ¯å“åº”ä¿¡æ¯ï¼Œä¸€èˆ¬ä¸ºæŠ¥é”™ä¿¡æ¯</li>
</ul>
</li>
<li>æä¾›ä¸¤ç§ä½¿ç”¨æ–¹å¼
<ul>
<li>æˆåŠŸè¿”å›ï¼šResult.success(data) dataä¸ºè¿”å›çš„æ•°æ®</li>
<li>å¤±è´¥è¿”å›ï¼šResult.fail(message) messageï¼šä¸ºé”™è¯¯ä¿¡æ¯</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Result</span>(<span class="hljs-title class_ inherited__">dict</span>):
    <span class="hljs-string">"""
    ç»“æœå¯¹è±¡
    """</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, isSuccess: <span class="hljs-built_in">bool</span>, result: <span class="hljs-built_in">any</span> = <span class="hljs-literal">None</span>, message: <span class="hljs-built_in">str</span> = <span class="hljs-literal">None</span></span>):
        <span class="hljs-built_in">super</span>().__init__()
        self[<span class="hljs-string">"success"</span>] = <span class="hljs-string">"success"</span> <span class="hljs-keyword">if</span> isSuccess <span class="hljs-keyword">else</span> <span class="hljs-string">"fail"</span>
        self[<span class="hljs-string">"result"</span>] = result
        self[<span class="hljs-string">"message"</span>] = message

<span class="hljs-meta">    @classmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">success</span>(<span class="hljs-params">cls, result: <span class="hljs-built_in">any</span> = <span class="hljs-literal">None</span></span>):
        <span class="hljs-keyword">return</span> cls(isSuccess=<span class="hljs-literal">True</span>, result=result)

<span class="hljs-meta">    @classmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">fail</span>(<span class="hljs-params">cls, message: <span class="hljs-built_in">str</span> = <span class="hljs-literal">None</span></span>):
        <span class="hljs-keyword">return</span> cls(isSuccess=<span class="hljs-literal">False</span>, message=message)

</code></pre>
<h2 data-id="heading-3">ä¸ºè¿”å›æ•°æ®è®¾ç½® python å¯¹è±¡çš„ json ç¼–ç å™¨</h2>
<ul>
<li>ä»£ç ä½ç½®ï¼šsrc/utils/json_codec.py</li>
<li>json ç¼–ç å™¨æä¾›ä¸¤ç§
<ul>
<li>1ã€Flask æ¡†æ¶æ‰€éœ€çš„, ä½¿ç”¨æ–¹å¼ï¼šself.json = DefaultJSONProvider(app)ï¼Œæˆ‘æœ‰ç»§æ‰¿ Flask å¯¹è±¡ï¼Œæ­¤å¤„çš„ self å¯ä»¥æ›¿æ¢ä¸ºFlask å¯¹è±¡</li>
<li>2ã€json æ¨¡å—æ‰€éœ€çš„, ä½¿ç”¨æ–¹å¼ï¼šjson.dumps(data, cls=CustomEncoder)</li>
</ul>
</li>
<li>ä¸¤ç§ç¼–ç å™¨éƒ½ç»Ÿä¸€ä½¿ç”¨ codec å‡½æ•°ï¼Œå…¶ä»–å¯¹è±¡å¦‚æœä¹Ÿéœ€è¦å¤„ç†ï¼Œå¯ä»¥åœ¨ codec å‡½æ•°æ·»åŠ </li>
</ul>
<pre><code class="hljs language-python" lang="python">	<span class="hljs-keyword">def</span> <span class="hljs-title function_">codec</span>(<span class="hljs-params">obj</span>):
	    <span class="hljs-string">""" è‡ªå®šä¹‰ç¼–è§£ç å™¨ï¼Œç‰¹æ®Šå¯¹è±¡è½¬æ¢ """</span>
	    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(obj, datetime):
	        <span class="hljs-comment"># å¤„ç†æ—¥æœŸæ—¶é—´å¯¹è±¡</span>
	        <span class="hljs-keyword">return</span> obj.strftime(<span class="hljs-string">"%Y-%m-%d %H:%M:%S"</span>)
	    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">isinstance</span>(obj, Enum):
	        <span class="hljs-comment"># å¤„ç†æšä¸¾å¯¹è±¡</span>
	        <span class="hljs-keyword">return</span> obj.name
	    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">isinstance</span>(obj, np.ndarray):
	        <span class="hljs-comment"># å¤„ç†å®¹å™¨ç±»å‹ä¸­çš„ç‰¹æ®Šå¯¹è±¡</span>
	        <span class="hljs-keyword">return</span> obj.tolist()
	    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">isinstance</span>(obj, np.integer):
	        <span class="hljs-comment"># å¤„ç†numpyæ•´æ•°ç±»å‹</span>
	        <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(obj)
	    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">isinstance</span>(obj, np.floating):
	        <span class="hljs-comment"># å¤„ç†numpyæµ®ç‚¹æ•°ç±»å‹</span>
	        <span class="hljs-keyword">return</span> <span class="hljs-built_in">float</span>(obj)
	    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>


	<span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomJSONProvider</span>(<span class="hljs-title class_ inherited__">DefaultJSONProvider</span>):
	    <span class="hljs-string">""" è‡ªå®šä¹‰ç¼–è§£ç å™¨, ç”¨äºflask """</span>

	    <span class="hljs-keyword">def</span> <span class="hljs-title function_">default</span>(<span class="hljs-params">self, obj</span>):
	        <span class="hljs-string">"""å¤„ç†ç‰¹æ®Šå¯¹è±¡"""</span>
	        codec_result = codec(obj)
	        <span class="hljs-keyword">return</span> codec_result <span class="hljs-keyword">if</span> codec_result <span class="hljs-keyword">else</span> <span class="hljs-built_in">super</span>(CustomJSONProvider, self).default(obj)


	<span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomEncoder</span>(json.JSONEncoder):
	    <span class="hljs-string">""" è‡ªå®šä¹‰ç¼–è§£ç å™¨ï¼Œç”¨äº json """</span>

	    <span class="hljs-keyword">def</span> <span class="hljs-title function_">default</span>(<span class="hljs-params">self, obj</span>):
	        codec_result = codec(obj)
	        <span class="hljs-keyword">return</span> codec_result <span class="hljs-keyword">if</span> codec_result <span class="hljs-keyword">else</span> <span class="hljs-built_in">super</span>(CustomEncoder, self).default(obj)
</code></pre>
<h2 data-id="heading-4">æ—¥å¿—åŒæ—¶è¾“å‡ºè‡³æ§åˆ¶å°ã€æ–‡ä»¶</h2>
<p>ä»£ç ä½ç½®ï¼šsrc/config/log_config.py</p>
<ul>
<li>å®ç°æ–¹å¼ï¼šå°† sys.stdout å’Œ sys.stderr é‡å®šå‘è‡³æ—¥å¿—é…ç½®å¯¹è±¡ï¼Œæ—¥å¿—å¯¹è±¡å®ç° write å’Œ flush å‡½æ•°ï¼Œ
åœ¨ write å‡½æ•°ä¸­é€šè¿‡ logging æ¨¡å—å°†æ—¥å¿—å†™å…¥æ–‡ä»¶ï¼Œåœ¨æ­¤å¤„å¯¹å†™å…¥çš„æ–‡ä»¶è¿›è¡Œæ ¼å¼åŒ–ï¼Œæ·»åŠ çº¿ç¨‹ä¿¡æ¯ã€‚æ¯ 30s æ£€æŸ¥ä¸€æ¬¡æ–‡ä»¶å¤§å°ï¼Œè¶…è¿‡ 100M æ—¶å°†å‰ 99M æ•°æ®æ¸…æ‰ã€‚</li>
<li>åœ¨ write å‡½æ•°ä¸­ä¹Ÿå°†æ•°æ®è¾“å…¥ä¸€ä»½è‡³æ§åˆ¶å°</li>
<li>ä½¿ç”¨æ–¹å¼ï¼šlog_config(name=import_name, log_filename=log_filename)</li>
</ul>
<pre><code class="hljs language-python" lang="python">	<span class="hljs-keyword">class</span> <span class="hljs-title class_">LogConfig</span>:

	    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name: <span class="hljs-built_in">any</span>, log_type: <span class="hljs-built_in">str</span>, log_file: <span class="hljs-built_in">str</span></span>):
	        self.log_file = log_file
	        self.log_type = log_type
	        self.max_size = <span class="hljs-number">100</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>
	        self.trim_size = <span class="hljs-number">99</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>
	        self._last_check = time.time()
	        <span class="hljs-comment"># ä¸º LogWriter åˆ›å»ºä¸“ç”¨çš„æ—¥å¿—è®°å½•å™¨</span>
	        self.logger = logging.getLogger(name)
	        self.logger.setLevel(logging.INFO)
	        <span class="hljs-comment"># é¿å…é‡å¤æ·»åŠ å¤„ç†å™¨</span>
	        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.logger.handlers:
	            handler = logging.FileHandler(log_file)
	            <span class="hljs-comment"># %(asctime)s: æ—¶é—´æˆ³</span>
	            <span class="hljs-comment"># %(message)s: æ—¥å¿—æ¶ˆæ¯</span>
	            formatter = logging.Formatter(<span class="hljs-string">'%(asctime)s - %(message)s'</span>)
	            handler.setFormatter(formatter)
	            self.logger.addHandler(handler)

	    <span class="hljs-keyword">def</span> <span class="hljs-title function_">check_and_trim_file</span>(<span class="hljs-params">self</span>):
	        <span class="hljs-string">"""æ£€æŸ¥æ–‡ä»¶å¤§å°å¹¶åœ¨å¿…è¦æ—¶æˆªæ–­"""</span>
	        <span class="hljs-keyword">if</span> os.path.exists(self.log_file):
	            file_size = os.path.getsize(self.log_file)
	            <span class="hljs-keyword">if</span> file_size &gt; self.max_size:
	                <span class="hljs-keyword">try</span>:
	                    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(self.log_file, <span class="hljs-string">'rb'</span>) <span class="hljs-keyword">as</span> f:
	                        f.seek(self.trim_size)
	                        remaining_data = f.read()

	                    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(self.log_file, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:
	                        f.write(remaining_data)
	                <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
	                    <span class="hljs-comment"># å¦‚æœæˆªæ–­å¤±è´¥ï¼Œç»§ç»­æ­£å¸¸å†™å…¥</span>
	                    <span class="hljs-keyword">pass</span>

	    <span class="hljs-keyword">def</span> <span class="hljs-title function_">write</span>(<span class="hljs-params">self, message</span>):
	        <span class="hljs-keyword">if</span> message.strip():  <span class="hljs-comment"># å¿½ç•¥ç©ºè¡Œ</span>
	            <span class="hljs-comment"># å‡å°‘æ–‡ä»¶å¤§å°æ£€æŸ¥é¢‘ç‡</span>
	            current_time = time.time()
	            <span class="hljs-keyword">if</span> (current_time - self._last_check) &gt; <span class="hljs-number">30</span>:
	                <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦éœ€è¦æˆªæ–­æ–‡ä»¶</span>
	                self.check_and_trim_file()
	                self._last_check = current_time

	            <span class="hljs-comment"># åˆ›å»ºæ—¥å¿—è®°å½•å™¨å¹¶æ‰‹åŠ¨è®°å½•</span>
	            thread_name = threading.current_thread().name
	            formatted_message = <span class="hljs-string">f"<span class="hljs-subst">{thread_name}</span> - <span class="hljs-subst">{message.strip()}</span>"</span>
	            self.logger.info(formatted_message)
	            <span class="hljs-comment"># è·å–å½“å‰æ—¶é—´æˆ³</span>
	            timestamp = time.time()
	            <span class="hljs-comment"># è½¬æ¢ä¸ºæœ¬åœ°æ—¶é—´ç»“æ„</span>
	            time_struct = time.localtime(timestamp)
	            <span class="hljs-comment"># æ ¼å¼åŒ–æ—¶é—´</span>
	            formatted_time = time.strftime(<span class="hljs-string">'%Y-%m-%d %H:%M:%S'</span>, time_struct)
	            <span class="hljs-keyword">if</span> <span class="hljs-string">'err'</span> <span class="hljs-keyword">in</span> self.log_type:
	                sys.__stderr__.write(<span class="hljs-string">f'<span class="hljs-subst">{formatted_time}</span> - <span class="hljs-subst">{formatted_message}</span>\n'</span>)
	            <span class="hljs-keyword">else</span>:
	                sys.__stdout__.write(<span class="hljs-string">f'<span class="hljs-subst">{formatted_time}</span> - <span class="hljs-subst">{formatted_message}</span>\n'</span>)

	    <span class="hljs-keyword">def</span> <span class="hljs-title function_">flush</span>(<span class="hljs-params">self</span>):
	        <span class="hljs-keyword">if</span> <span class="hljs-string">'err'</span> <span class="hljs-keyword">in</span> self.log_type:
	            sys.__stderr__.flush()
	        <span class="hljs-keyword">else</span>:
	            sys.__stdout__.flush()


	<span class="hljs-keyword">def</span> <span class="hljs-title function_">log_config</span>(<span class="hljs-params">name: <span class="hljs-built_in">any</span>, log_filename: <span class="hljs-built_in">str</span></span>):
	    <span class="hljs-string">"""é…ç½®æ—¥å¿—"""</span>
	    <span class="hljs-keyword">try</span>:
	        <span class="hljs-comment"># åˆ›å»ºæ—¥å¿—å†™å…¥å™¨=</span>
	        <span class="hljs-comment"># é‡å®šå‘ print è¾“å‡º</span>
	        sys.stdout = LogConfig(name=name, log_type=<span class="hljs-string">'out'</span>, log_file=log_filename)
	        sys.stderr = LogConfig(name=name, log_type=<span class="hljs-string">'err'</span>, log_file=log_filename)
	    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
	        traceback.print_exc()
	        <span class="hljs-comment"># å¦‚æœé‡å®šå‘å¤±è´¥ï¼Œè‡³å°‘ä¿è¯ç¨‹åºèƒ½æ­£å¸¸è¿è¡Œ</span>
	        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ—¥å¿—é‡å®šå‘é…ç½®å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)

</code></pre>
<h2 data-id="heading-5">ç»Ÿä¸€æ•è·å¼‚å¸¸ä¿¡æ¯</h2>
<p>ä»£ç ä½ç½®ï¼šsrc/application.py</p>
<ul>
<li>ä½¿ç”¨æ–¹å¼ï¼šself.errorhandler(Exception)(self.handle_exception)ï¼Œæ­¤å¤„çš„ self ä¹Ÿæ˜¯ Flask å¯¹è±¡</li>
<li>æ•è·å¼‚å¸¸åæ‰“å°å †æ ˆä¿¡æ¯ï¼Œä¹‹åè¿”å›æˆ‘ä»¬å®šä¹‰å¥½çš„å“åº”å¤±è´¥å¯¹è±¡ï¼Œå¹¶ä¸”è¿”å› http çŠ¶æ€ç ä¸ºï¼š500</li>
</ul>
<pre><code class="hljs language-python" lang="python">	<span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_exception</span>(<span class="hljs-params">self, ex: Exception</span>):
	    <span class="hljs-string">"""å¤„ç†æœªæ•è·çš„å¼‚å¸¸"""</span>
	    traceback.print_exc()
	    <span class="hljs-comment"># è¿”å›è‡ªå®šä¹‰é”™è¯¯å“åº”</span>
	    <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">f'<span class="hljs-subst">{ex}</span>'</span>), <span class="hljs-number">500</span>
</code></pre>
<h2 data-id="heading-6">ç»Ÿä¸€æ·»åŠ è¯·æ±‚ã€å“åº”æ—¥å¿—</h2>
<p>ä»£ç ä½ç½®ï¼šsrc/application.py
ä½¿ç”¨æ–¹æ³•ï¼š</p>
<ul>
<li>æ·»åŠ è¯·æ±‚å‰å¤„ç†é€»è¾‘ self.before_request(self.log_request_info)</li>
<li>æ·»åŠ å“åº”åå¤„ç†é€»è¾‘ self.after_request(self.process_response)</li>
</ul>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">log_request_info</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""è®°å½•è¯·æ±‚ä¿¡æ¯"""</span>
        self.request_duration_local.start_time = datetime.now()
        path_log = <span class="hljs-string">f'<span class="hljs-subst">{<span class="hljs-string">'='</span> * <span class="hljs-number">40</span>}</span> è¯·æ±‚è·¯å¾„: <span class="hljs-subst">{request.path}</span> <span class="hljs-subst">{<span class="hljs-string">'='</span> * <span class="hljs-number">40</span>}</span>'</span>
        headers_log = <span class="hljs-string">'\n'</span>.join([<span class="hljs-string">f'<span class="hljs-subst">{key}</span>: <span class="hljs-subst">{value}</span>'</span> <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> request.headers.items()])
        request_body = request.get_json() <span class="hljs-keyword">if</span> request.is_json <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>
        <span class="hljs-built_in">print</span>(
            <span class="hljs-string">f'è¯·æ±‚ä¿¡æ¯\n'</span>
            <span class="hljs-string">f'<span class="hljs-subst">{path_log}</span>\n'</span>
            <span class="hljs-string">f'è¯·æ±‚æ–¹æ³•: <span class="hljs-subst">{request.method}</span>\n'</span>
            <span class="hljs-string">f'<span class="hljs-subst">{headers_log}</span>\n'</span>
            <span class="hljs-string">f'è¯·æ±‚å‚æ•°/args: <span class="hljs-subst">{json.dumps(request.args, ensure_ascii=<span class="hljs-literal">False</span>)}</span>\n'</span>
            <span class="hljs-string">f'è¯·æ±‚ä½“/json: <span class="hljs-subst">{json.dumps(request_body, ensure_ascii=<span class="hljs-literal">False</span>)}</span>\n'</span>
            <span class="hljs-string">f'<span class="hljs-subst">{<span class="hljs-string">'='</span> * (<span class="hljs-built_in">len</span>(path_log) + <span class="hljs-number">3</span>)}</span>'</span>)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">process_response</span>(<span class="hljs-params">self, response</span>):
        <span class="hljs-string">"""è®°å½•å“åº”ä¿¡æ¯"""</span>
        duration = datetime.now() - self.request_duration_local.start_time
        path_log = <span class="hljs-string">f'<span class="hljs-subst">{<span class="hljs-string">'='</span> * <span class="hljs-number">40</span>}</span> å“åº”ä¿¡æ¯: <span class="hljs-subst">{request.path}</span> <span class="hljs-subst">{<span class="hljs-string">'='</span> * <span class="hljs-number">40</span>}</span>'</span>
        <span class="hljs-keyword">if</span> response.is_json:
            resp_result = json.dumps(response.get_json(), ensure_ascii=<span class="hljs-literal">False</span>)
        <span class="hljs-keyword">else</span>:
            resp_result = response.data
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(resp_result) &gt; <span class="hljs-number">1024</span>:
            resp_result = <span class="hljs-string">f'<span class="hljs-subst">{resp_result[<span class="hljs-number">0</span>:<span class="hljs-number">256</span>]}</span>...<span class="hljs-subst">{resp_result[-<span class="hljs-number">256</span>:]}</span>'</span>
        <span class="hljs-built_in">print</span>(
            <span class="hljs-string">f'å“åº”ä¿¡æ¯\n'</span>
            <span class="hljs-string">f'<span class="hljs-subst">{path_log}</span>\n'</span>
            <span class="hljs-string">f'è¯·æ±‚è·¯å¾„: <span class="hljs-subst">{request.path}</span> è¯·æ±‚æ–¹æ³•: <span class="hljs-subst">{request.method}</span>\n'</span>
            <span class="hljs-string">f'å“åº”çŠ¶æ€ç : <span class="hljs-subst">{response.status_code}</span> è€—æ—¶: <span class="hljs-subst">{duration.total_seconds():<span class="hljs-number">.3</span>f}</span>s\n'</span>
            <span class="hljs-string">f'å“åº”ç»“æœ: <span class="hljs-subst">{resp_result}</span>\n'</span>
            <span class="hljs-string">f'<span class="hljs-subst">{<span class="hljs-string">'='</span> * (<span class="hljs-built_in">len</span>(path_log) + <span class="hljs-number">3</span>)}</span>'</span>)
        <span class="hljs-keyword">return</span> response
</code></pre>
<h2 data-id="heading-7">æµ‹è¯• controller</h2>
<ul>
<li>ä»£ç ä½ç½®ï¼šsrc/controller/test_controller.py</li>
<li>è“å›¾å¯¹å¤–æš´éœ²æ¥å£çš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œè¿™é‡Œå±•ç¤ºçš„æ˜¯æˆ‘æœ€å–œæ¬¢çš„æ–¹å¼ã€‚</li>
<li>POST è¯·æ±‚ curl
<ul>
<li>curl --location '<a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A5001%2Ftest%2Fpost" target="_blank" title="http://127.0.0.1:5001/test/post" ref="nofollow noopener noreferrer">http://127.0.0.1:5001/test/post</a>' --header 'Content-Type: application/json' --data '{"test": "test"}'</li>
<li>ç”¨äºå±•ç¤º POST è¯·æ±‚ã€æµ‹è¯•å¯¹ ndarray ä¸ æ—¶é—´ç±»å‹çš„ json ç¼–ç ï¼Œä»¥åŠè¾“å‡ºæ—¥å¿—</li>
</ul>
</li>
<li>GET è¯·æ±‚ curl
<ul>
<li>curl --location '<a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A5001%2Ftest%2Fcurrent_time%3Ftest%3Dtmp" target="_blank" title="http://127.0.0.1:5001/test/current_time?test=tmp" ref="nofollow noopener noreferrer">http://127.0.0.1:5001/test/current_time?test=tmp</a>'</li>
<li>ç”¨äºå±•ç¤º GET è¯·æ±‚ä¸æµ‹è¯•æ—¥å¿—</li>
</ul>
</li>
<li>å¼‚å¸¸æµ‹è¯• curl
<ul>
<li>curl --location '<a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A5001%2Ftest%2Ferror%3Ftest%3Dtmp" target="_blank" title="http://127.0.0.1:5001/test/error?test=tmp" ref="nofollow noopener noreferrer">http://127.0.0.1:5001/test/error?test=tmp</a>'</li>
<li>ç”¨äºæµ‹è¯•å¼‚å¸¸çš„æ•è·</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-python" lang="python">
<span class="hljs-string">"""
åˆ›å»ºè“å›¾
"""</span>
test_bp = Blueprint(<span class="hljs-string">"test"</span>, __name__, url_prefix=<span class="hljs-string">"/test"</span>)


<span class="hljs-meta">@test_bp.post(<span class="hljs-params"><span class="hljs-string">"post"</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_post</span>():
    <span class="hljs-string">"""
    æµ‹è¯•postè¯·æ±‚
    """</span>
    request_body = request.json
    data = {
        <span class="hljs-string">"request_body"</span>: request_body,
        <span class="hljs-string">"request_time"</span>: datetime.now(),
        <span class="hljs-string">"ndarray"</span>: np.array([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]),
    }
    <span class="hljs-built_in">print</span>(data)
    <span class="hljs-keyword">return</span> Result.success(data)


<span class="hljs-meta">@test_bp.get(<span class="hljs-params"><span class="hljs-string">"current_time"</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">current_time</span>():
    <span class="hljs-string">"""
    æµ‹è¯•getè¯·æ±‚
    """</span>
    args = request.args
    data = {
        <span class="hljs-string">"args"</span>: args,
        <span class="hljs-string">"request_time"</span>: datetime.now(),
    }
    <span class="hljs-built_in">print</span>(data)
    <span class="hljs-keyword">return</span> Result.success(data)


<span class="hljs-meta">@test_bp.get(<span class="hljs-params"><span class="hljs-string">"error"</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_error</span>():
    <span class="hljs-string">"""
    æµ‹è¯•å¼‚å¸¸
    """</span>
    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"æµ‹è¯•å¼‚å¸¸"</span>)
</code></pre>
<h2 data-id="heading-8">é…ç½® CROS è·¨åŸŸå¹¶æ³¨å†Œè“å›¾</h2>
<ul>
<li>å¯¹æ‰€æœ‰è¯·æ±‚ã€æ‰€æœ‰ç±»å‹å’Œæ‰€æœ‰è¯·æ±‚æ–¹å¼é…ç½® CROS è·¨åŸŸï¼Œæˆ–è€…è‡ªå®šä¹‰è·¨åŸŸæ–¹å¼</li>
<li>å¯¹æ¯ä¸€ä¸ªè“å›¾è¿›è¡Œæ³¨å†Œ</li>
<li>å¤‡æ³¨ï¼šéœ€è¦å¯¹æ‰€æœ‰è“å›¾å•ç‹¬é…ç½® CROS</li>
</ul>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">set_cors_and_register_blueprint</span>(<span class="hljs-params">self, bp: Blueprint, cors_config: <span class="hljs-built_in">dict</span> = <span class="hljs-literal">None</span></span>):
        <span class="hljs-string">"""
        é…ç½®è·¨åŸŸå¹¶æ³¨å†Œè“å›¾
        """</span>
        <span class="hljs-keyword">if</span> cors_config <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            cors_config = {
                <span class="hljs-string">"origins"</span>: <span class="hljs-string">"*"</span>,
                <span class="hljs-string">"allow_headers"</span>: [<span class="hljs-string">"Content-Type"</span>],
                <span class="hljs-string">"methods"</span>: [<span class="hljs-string">"GET"</span>, <span class="hljs-string">"PUT"</span>, <span class="hljs-string">"POST"</span>, <span class="hljs-string">"DELETE"</span>, <span class="hljs-string">"OPTIONS"</span>, <span class="hljs-string">"PATCH"</span>]
            }

        <span class="hljs-comment"># è·¨åŸŸé…ç½®</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'è·¨åŸŸé…ç½®: <span class="hljs-subst">{bp.name}</span>-<span class="hljs-subst">{json.dumps(cors_config)}</span>'</span>)
        CORS(bp, **cors_config)
        <span class="hljs-comment"># æ³¨å†Œè“å›¾</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'æ³¨å†Œè“å›¾: <span class="hljs-subst">{bp.name}</span>'</span>)
        self.register_blueprint(bp)
</code></pre>
<h2 data-id="heading-9">ç»§æ‰¿åçš„ FlaskApp å¯¹è±¡</h2>
<ul>
<li>å› ä¸ºå¾ˆå¤šé…ç½®éƒ½éœ€è¦æ“ä½œ Flask å¯¹è±¡ï¼Œç´¢æ€§ç»§æ‰¿ Flask å¯¹è±¡ï¼ŒæŠŠæ‰€æœ‰é…ç½®é›†æˆåˆ°ä¸€èµ·</li>
<li>ä»£ç ä¸­æœ‰æ³¨é‡Šï¼Œä¸è¿‡å¤šèµ˜è¿°</li>
<li>FlaskApp å¯¹è±¡çš„ä½¿ç”¨åœ¨ç¤ºä¾‹ä»£ç æœ€ä¸‹æ”¾ï¼Œä¹Ÿå°±æ˜¯å…¥å£å‡½æ•°ä¸­ä½¿ç”¨</li>
<li>platform.system() == 'Darwin'ï¼šç”±äºæˆ‘ä½¿ç”¨ Mac è¿›è¡Œå¼€å‘ï¼Œæ‰€ä»¥æ­¤å¤„è®¾ç½®ä¸ºå½“ç³»ç»Ÿä¸º Mac æ—¶å¼€å¯ Debug æ¨¡å¼</li>
<li>å¤‡æ³¨ï¼šæ¯ä¸€ä¸ªè“å›¾éƒ½éœ€è¦å•ç‹¬è¿›è¡Œæ³¨å†Œï¼Œæˆ‘çš„ä¹ æƒ¯æ˜¯æ¯ä¸ª controller åˆ†é…ä¸€ä¸ªè“å›¾ï¼Œæ¯å¢åŠ ä¸€ä¸ª controller åœ¨è¿™é‡ŒåŠ ä¸€è¡Œ</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">FlaskApp</span>(<span class="hljs-title class_ inherited__">Flask</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, import_name: <span class="hljs-built_in">str</span>, log_filename: <span class="hljs-built_in">str</span>, **kwargs</span>):
        <span class="hljs-built_in">super</span>().__init__(import_name, **kwargs)
        <span class="hljs-comment"># æ—¥å¿—é…ç½®</span>
        log_config(name=import_name, log_filename=log_filename)

        <span class="hljs-comment"># æ³¨å†Œè“å›¾</span>
        self.blueprints_to_register = []
        <span class="hljs-keyword">from</span> src.controller.test_controller <span class="hljs-keyword">import</span> test_bp
        self.add_blueprint(bp=test_bp)

        <span class="hljs-comment"># æ·»åŠ è¯·æ±‚å‰å’Œå“åº”åå¤„ç†é€»è¾‘</span>
        self.before_request(self.log_request_info)
        self.after_request(self.process_response)

        <span class="hljs-comment"># æ·»åŠ é”™è¯¯å¤„ç†</span>
        self.errorhandler(Exception)(self.handle_exception)

        <span class="hljs-comment"># è¯·æ±‚è€—æ—¶ç»Ÿè®¡</span>
        self.request_duration_local = threading.local()

        <span class="hljs-comment"># è‡ªå®šä¹‰ç¼–è§£ç å™¨</span>
        self.json = CustomJSONProvider(self)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">log_request_info</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""è®°å½•è¯·æ±‚ä¿¡æ¯"""</span>
        self.request_duration_local.start_time = datetime.now()
        path_log = <span class="hljs-string">f'<span class="hljs-subst">{<span class="hljs-string">'='</span> * <span class="hljs-number">40</span>}</span> è¯·æ±‚è·¯å¾„: <span class="hljs-subst">{request.path}</span> <span class="hljs-subst">{<span class="hljs-string">'='</span> * <span class="hljs-number">40</span>}</span>'</span>
        headers_log = <span class="hljs-string">'\n'</span>.join([<span class="hljs-string">f'<span class="hljs-subst">{key}</span>: <span class="hljs-subst">{value}</span>'</span> <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> request.headers.items()])
        request_body = request.get_json() <span class="hljs-keyword">if</span> request.is_json <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>
        <span class="hljs-built_in">print</span>(
            <span class="hljs-string">f'è¯·æ±‚ä¿¡æ¯\n'</span>
            <span class="hljs-string">f'<span class="hljs-subst">{path_log}</span>\n'</span>
            <span class="hljs-string">f'è¯·æ±‚æ–¹æ³•: <span class="hljs-subst">{request.method}</span>\n'</span>
            <span class="hljs-string">f'<span class="hljs-subst">{headers_log}</span>\n'</span>
            <span class="hljs-string">f'è¯·æ±‚å‚æ•°/args: <span class="hljs-subst">{json.dumps(request.args, ensure_ascii=<span class="hljs-literal">False</span>)}</span>\n'</span>
            <span class="hljs-string">f'è¯·æ±‚ä½“/json: <span class="hljs-subst">{json.dumps(request_body, ensure_ascii=<span class="hljs-literal">False</span>)}</span>\n'</span>
            <span class="hljs-string">f'<span class="hljs-subst">{<span class="hljs-string">'='</span> * (<span class="hljs-built_in">len</span>(path_log) + <span class="hljs-number">3</span>)}</span>'</span>)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">process_response</span>(<span class="hljs-params">self, response</span>):
        <span class="hljs-string">"""è®°å½•å“åº”ä¿¡æ¯"""</span>
        duration = datetime.now() - self.request_duration_local.start_time
        path_log = <span class="hljs-string">f'<span class="hljs-subst">{<span class="hljs-string">'='</span> * <span class="hljs-number">40</span>}</span> å“åº”ä¿¡æ¯: <span class="hljs-subst">{request.path}</span> <span class="hljs-subst">{<span class="hljs-string">'='</span> * <span class="hljs-number">40</span>}</span>'</span>
        <span class="hljs-keyword">if</span> response.is_json:
            resp_result = json.dumps(response.get_json(), ensure_ascii=<span class="hljs-literal">False</span>)
        <span class="hljs-keyword">else</span>:
            resp_result = response.data
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(resp_result) &gt; <span class="hljs-number">1024</span>:
            resp_result = <span class="hljs-string">f'<span class="hljs-subst">{resp_result[<span class="hljs-number">0</span>:<span class="hljs-number">256</span>]}</span>...<span class="hljs-subst">{resp_result[-<span class="hljs-number">256</span>:]}</span>'</span>
        <span class="hljs-built_in">print</span>(
            <span class="hljs-string">f'å“åº”ä¿¡æ¯\n'</span>
            <span class="hljs-string">f'<span class="hljs-subst">{path_log}</span>\n'</span>
            <span class="hljs-string">f'è¯·æ±‚è·¯å¾„: <span class="hljs-subst">{request.path}</span> è¯·æ±‚æ–¹æ³•: <span class="hljs-subst">{request.method}</span>\n'</span>
            <span class="hljs-string">f'å“åº”çŠ¶æ€ç : <span class="hljs-subst">{response.status_code}</span> è€—æ—¶: <span class="hljs-subst">{duration.total_seconds():<span class="hljs-number">.3</span>f}</span>s\n'</span>
            <span class="hljs-string">f'å“åº”ç»“æœ: <span class="hljs-subst">{resp_result}</span>\n'</span>
            <span class="hljs-string">f'<span class="hljs-subst">{<span class="hljs-string">'='</span> * (<span class="hljs-built_in">len</span>(path_log) + <span class="hljs-number">3</span>)}</span>'</span>)
        <span class="hljs-keyword">return</span> response

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_exception</span>(<span class="hljs-params">self, ex: Exception</span>):
        <span class="hljs-string">"""å¤„ç†æœªæ•è·çš„å¼‚å¸¸"""</span>
        traceback.print_exc()
        <span class="hljs-comment"># è¿”å›è‡ªå®šä¹‰é”™è¯¯å“åº”</span>
        <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">f'<span class="hljs-subst">{ex}</span>'</span>), <span class="hljs-number">500</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_blueprint</span>(<span class="hljs-params">self, bp: Blueprint</span>):
        <span class="hljs-string">"""æ·»åŠ éœ€è¦æ³¨å†Œçš„è“å›¾"""</span>
        self.blueprints_to_register.append(bp)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">set_cors_and_register_blueprint</span>(<span class="hljs-params">self, bp: Blueprint, cors_config: <span class="hljs-built_in">dict</span> = <span class="hljs-literal">None</span></span>):
        <span class="hljs-string">"""
        é…ç½®è·¨åŸŸå¹¶æ³¨å†Œè“å›¾
        """</span>
        <span class="hljs-keyword">if</span> cors_config <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            cors_config = {
                <span class="hljs-string">"origins"</span>: <span class="hljs-string">"*"</span>,
                <span class="hljs-string">"allow_headers"</span>: [<span class="hljs-string">"Content-Type"</span>],
                <span class="hljs-string">"methods"</span>: [<span class="hljs-string">"GET"</span>, <span class="hljs-string">"PUT"</span>, <span class="hljs-string">"POST"</span>, <span class="hljs-string">"DELETE"</span>, <span class="hljs-string">"OPTIONS"</span>, <span class="hljs-string">"PATCH"</span>]
            }

        <span class="hljs-comment"># è·¨åŸŸé…ç½®</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'è·¨åŸŸé…ç½®: <span class="hljs-subst">{bp.name}</span>-<span class="hljs-subst">{json.dumps(cors_config)}</span>'</span>)
        CORS(bp, **cors_config)
        <span class="hljs-comment"># æ³¨å†Œè“å›¾</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f'æ³¨å†Œè“å›¾: <span class="hljs-subst">{bp.name}</span>'</span>)
        self.register_blueprint(bp)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self, host: <span class="hljs-built_in">str</span> | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>, port: <span class="hljs-built_in">int</span> | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>,
            debug: <span class="hljs-built_in">bool</span> | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>, load_dotenv: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">True</span>, **options: t.<span class="hljs-type">Any</span></span>) -&gt; <span class="hljs-literal">None</span>:

        <span class="hljs-keyword">for</span> bp <span class="hljs-keyword">in</span> self.blueprints_to_register:
            self.set_cors_and_register_blueprint(bp)

        <span class="hljs-built_in">super</span>().run(host=host, port=port, debug=debug, load_dotenv=load_dotenv, **options)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    log_filename = <span class="hljs-string">'./python.log'</span>
    app = FlaskApp(__name__, log_filename)
    app.run(host=<span class="hljs-string">"0.0.0.0"</span>, port=<span class="hljs-number">5001</span>, debug=platform.system() == <span class="hljs-string">'Darwin'</span>)
</code></pre>
<h2 data-id="heading-10">å¼€æºä»“åº“</h2>
<p>ä»£ç æ”¾åœ¨ Github ä¸Šï¼Œåç»­æœ‰èƒ½å¤Ÿä½œä¸ºé€šç”¨èƒ½åŠ›çš„åŠŸèƒ½éƒ½ä¼šæ›´æ–°åœ¨ä»“åº“ä¸­</p>
<ul>
<li>ä»“åº“åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fthe-wind-is-rising-dev%2Fflask-server-template.git" target="_blank" title="https://github.com/the-wind-is-rising-dev/flask-server-template.git" ref="nofollow noopener noreferrer">github.com/the-wind-isâ€¦</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä» N ä¸ªå•†å“ä¸­æ‰¾å‡ºæ€»ä»·æœ€å°çš„ K ä¸ªæ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7582849187866132531</link>    <guid>https://juejin.cn/post/7582849187866132531</guid>    <pubDate>2025-12-13T12:49:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582849187866132531" data-draft-id="7582875640308744242" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä» N ä¸ªå•†å“ä¸­æ‰¾å‡ºæ€»ä»·æœ€å°çš„ K ä¸ªæ–¹æ¡ˆ"/> <meta itemprop="keywords" content="åç«¯,ç®—æ³•"/> <meta itemprop="datePublished" content="2025-12-13T12:49:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘æ˜¯ä½ ä»¬çš„æ˜å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/3333374985122398"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä» N ä¸ªå•†å“ä¸­æ‰¾å‡ºæ€»ä»·æœ€å°çš„ K ä¸ªæ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3333374985122398/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘æ˜¯ä½ ä»¬çš„æ˜å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T12:49:09.000Z" title="Sat Dec 13 2025 12:49:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘é‡åˆ°ä¸€é“æœ‰è¶£çš„ç®—æ³•é¢˜ï¼Œæƒ³å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹ï¼š</p>
<blockquote>
<p><strong>é—®é¢˜æè¿°</strong>ï¼šç»™å®š N ä¸ªå•†å“ï¼ˆæ¯ä¸ªå•†å“åªèƒ½é€‰ä¸€æ¬¡ï¼‰ï¼Œä»ä¸­æ‰¾å‡ºæ€»ä»·æœ€å°çš„ K ä¸ªä¸åŒè´­ä¹°æ–¹æ¡ˆã€‚æ¯ä¸ªæ–¹æ¡ˆæ˜¯å•†å“çš„ä¸€ä¸ªå­é›†ï¼Œç›®æ ‡æ˜¯è¿”å›æ€»ä»·æ ¼æœ€å°çš„å‰ K ä¸ªç»„åˆã€‚</p>
</blockquote>
<p>æœ€ç›´è§‚çš„æƒ³æ³•æ˜¯æš´åŠ›æšä¸¾â€”â€”éå†æ‰€æœ‰ N! ç§å¯èƒ½çš„å­é›†ï¼Œè®¡ç®—æ¯ç§ç»„åˆçš„æ€»ä»·ï¼Œå†æ’åºå–å‰ K ä¸ªã€‚ç„¶è€Œï¼Œå½“ N è¾ƒå¤§æ—¶ï¼Œè¿™ç§æ–¹æ³•åœ¨æ—¶é—´å’Œç©ºé—´ä¸Šéƒ½ä¸å¯è¡Œã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ›´é«˜æ•ˆçš„ç­–ç•¥ã€‚å…³é”®è§‚å¯Ÿç‚¹åœ¨äºï¼š<strong>æˆ‘ä»¬å¹¶ä¸éœ€è¦ç”Ÿæˆæ‰€æœ‰ç»„åˆï¼Œè€Œåªéœ€é€æ­¥â€œæ¢ç´¢â€å‡ºæœ€å°çš„ K ä¸ªæ–¹æ¡ˆ</strong>ã€‚è¿™å¯å‘æˆ‘ä»¬ä½¿ç”¨<strong>ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆæœ€å°å †ï¼‰+ å‰ªæ + å»é‡</strong>çš„æ–¹æ³•ï¼ŒæŒ‰éœ€æ‰©å±•æœ€æœ‰å¸Œæœ›çš„å€™é€‰æ–¹æ¡ˆã€‚</p>
<p>å…·ä½“æ€è·¯å¦‚ä¸‹ï¼š</p>
<ol>
<li>å°†æ¯ä¸ªå•å•†å“ç»„åˆï¼ˆå³åªä¹°ä¸€ä¸ªå•†å“ï¼‰ä½œä¸ºåˆå§‹æ–¹æ¡ˆåŠ å…¥æœ€å°å †ï¼›</li>
<li>æ¯æ¬¡ä»å †ä¸­å–å‡ºå½“å‰æ€»ä»·æœ€å°çš„æ–¹æ¡ˆï¼Œå°†å…¶åŠ å…¥ç»“æœé›†ï¼›</li>
<li>ç„¶åä»¥è¯¥æ–¹æ¡ˆä¸ºåŸºç¡€ï¼Œå°è¯•åŠ å…¥å°šæœªåŒ…å«çš„å•†å“ï¼Œç”Ÿæˆæ–°çš„ç»„åˆï¼›</li>
<li>ä½¿ç”¨å“ˆå¸Œé›†åˆè®°å½•å·²ç”Ÿæˆçš„ç»„åˆï¼ˆé€šè¿‡æ ‡å‡†åŒ–è¡¨ç¤ºå»é‡ï¼‰ï¼Œé¿å…é‡å¤å…¥é˜Ÿï¼›</li>
<li>é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°æ”¶é›†åˆ° K ä¸ªæ–¹æ¡ˆæˆ–é˜Ÿåˆ—ä¸ºç©ºã€‚</li>
</ol>
<p>è¿™ç§æ–¹æ³•é¿å…äº†å…¨é‡æšä¸¾ï¼Œæ˜¾è‘—æå‡äº†æ•ˆç‡ï¼Œå°¤å…¶é€‚ç”¨äº K è¿œå°äº 2N çš„åœºæ™¯ã€‚</p>
<hr/>
<h5 data-id="heading-0">ä¼˜åŒ–åçš„ Java ä»£ç </h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.*;

<span class="hljs-comment">/**
 * æœ€å°èŠ±è´¹å•†å“ç»„åˆé—®é¢˜
 * ç»™å®š N ä¸ªå•†å“çš„ä»·æ ¼ï¼Œæ‰¾å‡ºæ€»èŠ±è´¹æœ€å°çš„ K ä¸ªä¸åŒè´­ä¹°æ–¹æ¡ˆã€‚
 * æ¯ä¸ªæ–¹æ¡ˆæ˜¯å•†å“çš„ä¸€ä¸ªå­é›†ï¼Œæ¯ä¸ªå•†å“æœ€å¤šè¢«é€‰æ‹©ä¸€æ¬¡ã€‚
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MinCostCombinations</span> {

    <span class="hljs-comment">/**
     * è¡¨ç¤ºä¸€ä¸ªè´­ä¹°æ–¹æ¡ˆ
     */</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparable</span>&lt;Solution&gt; {
        Set&lt;Integer&gt; indices;   <span class="hljs-comment">// å•†å“ç¼–å·é›†åˆï¼ˆä» 1 å¼€å§‹ï¼‰</span>
        <span class="hljs-type">long</span> totalPrice;        <span class="hljs-comment">// æ–¹æ¡ˆæ€»ä»·æ ¼</span>

        Solution(Set&lt;Integer&gt; indices, <span class="hljs-type">long</span> totalPrice) {
            <span class="hljs-built_in">this</span>.indices = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(indices);
            <span class="hljs-built_in">this</span>.totalPrice = totalPrice;
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(Solution other)</span> {
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.totalPrice != other.totalPrice) {
                <span class="hljs-keyword">return</span> Long.compare(<span class="hljs-built_in">this</span>.totalPrice, other.totalPrice);
            }
            <span class="hljs-comment">// ä»·æ ¼ç›¸åŒæ—¶ï¼ŒæŒ‰é›†åˆçš„å“ˆå¸Œå€¼æ’åºä»¥ä¿è¯æ¯”è¾ƒä¸€è‡´æ€§ï¼ˆè™½éå®Œç¾ï¼Œä½†å¯æ¥å—ï¼‰</span>
            <span class="hljs-keyword">return</span> Integer.compare(<span class="hljs-built_in">this</span>.indices.hashCode(), other.indices.hashCode());
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Scanner</span> <span class="hljs-variable">sc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">int</span> <span class="hljs-variable">N</span> <span class="hljs-operator">=</span> sc.nextInt();
            <span class="hljs-type">int</span> <span class="hljs-variable">K</span> <span class="hljs-operator">=</span> sc.nextInt();
            <span class="hljs-type">int</span>[] prices = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N];
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; N; i++) {
                prices[i] = sc.nextInt();
            }

            List&lt;Solution&gt; results = findMinCostCombinations(prices, K);

            <span class="hljs-keyword">for</span> (Solution sol : results) {
                List&lt;Integer&gt; sorted = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(sol.indices);
                Collections.sort(sorted);
                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; sorted.size(); i++) {
                    <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span>) System.out.print(<span class="hljs-string">","</span>);
                    System.out.print(sorted.get(i));
                }
                System.out.println(<span class="hljs-string">":"</span> + sol.totalPrice);
            }
        } <span class="hljs-keyword">finally</span> {
            sc.close();
        }
    }

    <span class="hljs-comment">/**
     * ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆæœ€å°å †ï¼‰æŒ‰éœ€ç”Ÿæˆæœ€å°çš„ K ä¸ªç»„åˆ
     * 
     * <span class="hljs-doctag">@param</span> prices å•†å“ä»·æ ¼æ•°ç»„
     * <span class="hljs-doctag">@param</span> k      éœ€è¦è¿”å›çš„æ–¹æ¡ˆæ•°é‡
     * <span class="hljs-doctag">@return</span>       æŒ‰æ€»ä»·å‡åºæ’åˆ—çš„å‰ K ä¸ªæ–¹æ¡ˆ
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;Solution&gt; <span class="hljs-title function_">findMinCostCombinations</span><span class="hljs-params">(<span class="hljs-type">int</span>[] prices, <span class="hljs-type">int</span> k)</span> {
        PriorityQueue&lt;Solution&gt; pq = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;();
        Set&lt;String&gt; visited = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();
        List&lt;Solution&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();

        <span class="hljs-comment">// åˆå§‹åŒ–ï¼šå°†æ¯ä¸ªå•å•†å“æ–¹æ¡ˆå…¥é˜Ÿ</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; prices.length; i++) {
            Set&lt;Integer&gt; set = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();
            set.add(i + <span class="hljs-number">1</span>); <span class="hljs-comment">// ç¼–å·ä» 1 å¼€å§‹</span>
            <span class="hljs-type">Solution</span> <span class="hljs-variable">sol</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Solution</span>(set, prices[i]);
            <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> getCanonicalKey(set);
            pq.offer(sol);
            visited.add(key);
        }

        <span class="hljs-keyword">while</span> (result.size() &lt; k &amp;&amp; !pq.isEmpty()) {
            <span class="hljs-type">Solution</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> pq.poll();
            result.add(current);

            <span class="hljs-comment">// æ‰©å±•ï¼šå°è¯•åŠ å…¥æ¯ä¸€ä¸ªæœªåŒ…å«çš„å•†å“</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; prices.length; i++) {
                <span class="hljs-type">int</span> <span class="hljs-variable">idx</span> <span class="hljs-operator">=</span> i + <span class="hljs-number">1</span>;
                <span class="hljs-keyword">if</span> (!current.indices.contains(idx)) {
                    Set&lt;Integer&gt; newSet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(current.indices);
                    newSet.add(idx);
                    <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> getCanonicalKey(newSet);
                    <span class="hljs-keyword">if</span> (!visited.contains(key)) {
                        <span class="hljs-type">long</span> <span class="hljs-variable">newPrice</span> <span class="hljs-operator">=</span> current.totalPrice + prices[i];
                        pq.offer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Solution</span>(newSet, newPrice));
                        visited.add(key);
                    }
                }
            }
        }

        <span class="hljs-keyword">return</span> result;
    }

    <span class="hljs-comment">/**
     * ç”Ÿæˆæ–¹æ¡ˆçš„è§„èŒƒå­—ç¬¦ä¸²è¡¨ç¤ºï¼Œç”¨äºå»é‡
     * ä¾‹å¦‚ {3, 1, 2} â†’ "1 2 3"
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">getCanonicalKey</span><span class="hljs-params">(Set&lt;Integer&gt; indices)</span> {
        List&lt;Integer&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(indices);
        Collections.sort(list);
        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; list.size(); i++) {
            <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span>) sb.append(<span class="hljs-string">' '</span>);
            sb.append(list.get(i));
        }
        <span class="hljs-keyword">return</span> sb.toString();
    }
}
</code></pre>
<h3 data-id="heading-1">è¡¥å……è¯´æ˜</h3>
<ul>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šæœ€åæƒ…å†µä¸‹ä»å¯èƒ½æ¥è¿‘Â O(Kâ‹…Nlog(Kâ‹…N))ï¼Œä½†ç”±äºå‰ªæå’Œå»é‡ï¼Œå®é™…è¿è¡Œé€šå¸¸è¿œä¼˜äºæš´åŠ›æ³•ã€‚</li>
<li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šä¸»è¦ç”±ä¼˜å…ˆé˜Ÿåˆ—å’Œå»é‡é›†åˆå†³å®šï¼Œçº¦ä¸ºÂ O(Kâ‹…N)ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç¬¬4è®²:ç°ä»£SQLé«˜çº§ç‰¹æ€§â€”â€”çª—å£å‡½æ•°ä¸CTE]]></title>    <link>https://juejin.cn/post/7582862885107728434</link>    <guid>https://juejin.cn/post/7582862885107728434</guid>    <pubDate>2025-12-13T13:56:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582862885107728434" data-draft-id="7577991167201329162" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç¬¬4è®²:ç°ä»£SQLé«˜çº§ç‰¹æ€§â€”â€”çª—å£å‡½æ•°ä¸CTE"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-13T13:56:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="éª‘ç€bugçš„coder"/> <meta itemprop="url" content="https://juejin.cn/user/1922418579089566"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç¬¬4è®²:ç°ä»£SQLé«˜çº§ç‰¹æ€§â€”â€”çª—å£å‡½æ•°ä¸CTE
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1922418579089566/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    éª‘ç€bugçš„coder
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T13:56:25.000Z" title="Sat Dec 13 2025 13:56:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç¬¬4è®²ï¼šç°ä»£SQLé«˜çº§ç‰¹æ€§â€”â€”çª—å£å‡½æ•°ä¸CTE</h2>
<blockquote>
<p><strong>ç›®æ ‡</strong>: æŒæ¡MySQL 8.0+çš„æ ¸å¿ƒç‰¹æ€§ï¼šçª—å£å‡½æ•°å’ŒCTEï¼Œè¿™æ˜¯é¢è¯•é«˜é¢‘è€ƒç‚¹ï¼Œä¹Ÿæ˜¯è§£å†³å¤æ‚æŸ¥è¯¢çš„åˆ©å™¨ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦çª—å£å‡½æ•°ï¼Ÿ</h3>
<h4 data-id="heading-2">ä¼ ç»Ÿæ–¹æ¡ˆçš„ç—›ç‚¹</h4>
<p><strong>éœ€æ±‚ï¼š</strong> æŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨è–ªèµ„å‰3åçš„å‘˜å·¥</p>
<p><strong>ä¼ ç»Ÿæ–¹æ¡ˆï¼ˆå…³è”å­æŸ¥è¯¢ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> e1.<span class="hljs-operator">*</span> 
<span class="hljs-keyword">FROM</span> employee e1
<span class="hljs-keyword">WHERE</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) 
    <span class="hljs-keyword">FROM</span> employee e2 
    <span class="hljs-keyword">WHERE</span> e2.department <span class="hljs-operator">=</span> e1.department 
    <span class="hljs-keyword">AND</span> e2.salary <span class="hljs-operator">&gt;=</span> e1.salary
) <span class="hljs-operator">&lt;=</span> <span class="hljs-number">3</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> department, salary <span class="hljs-keyword">DESC</span>;
</code></pre>
<p><strong>é—®é¢˜ï¼š</strong></p>
<ul>
<li>æ€§èƒ½å·®ï¼šè¿™ç§æ–¹æ³•æ¯æ¬¡æŸ¥è¯¢ <code>e1</code> æ—¶ï¼Œéƒ½è¦é’ˆå¯¹ <code>e2</code> è¿›è¡Œå­æŸ¥è¯¢ï¼Œè¿™å¯¼è‡´äº†å¤æ‚åº¦ä¸º O(NÂ²)ï¼Œæ•ˆç‡è¾ƒä½ï¼Œå°¤å…¶æ˜¯åœ¨æ•°æ®é‡å¤§æ—¶ã€‚</li>
<li>ä¸çµæ´»ï¼šå¦‚æœä¸šåŠ¡éœ€æ±‚å‘ç”Ÿå˜åŒ–ï¼Œéœ€è¦é‡å†™æ•´ä¸ªæŸ¥è¯¢ã€‚</li>
<li>SQL å¤æ‚ä¸”ä¸å®¹æ˜“ç†è§£ã€‚</li>
</ul>
<p>è¿™ä¸ªæ–¹æ¡ˆåœ¨ä¸€äº›è¾ƒå°çš„æ•°æ®é›†ä¸Šèƒ½æ­£å¸¸å·¥ä½œï¼Œä½†åœ¨æ•°æ®é‡å¢å¤§æ—¶ä¼šå˜å¾—éå¸¸æ…¢ï¼Œå› ä¸ºæ¯ä¸ª <code>e1</code> çš„æŸ¥è¯¢éƒ½éœ€è¦æ‰«ææ•´ä¸ªè¡¨ï¼Œè¿™æ ·ä¼šäº§ç”Ÿå¤§é‡çš„é‡å¤è®¡ç®—ã€‚</p>
<hr/>
<h4 data-id="heading-3">çª—å£å‡½æ•°æ–¹æ¡ˆ</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">WITH</span> ranked_employees <span class="hljs-keyword">AS</span> (
    <span class="hljs-keyword">SELECT</span> 
        <span class="hljs-operator">*</span>,
        <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> department <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> rn
    <span class="hljs-keyword">FROM</span> employee
)
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> ranked_employees <span class="hljs-keyword">WHERE</span> rn <span class="hljs-operator">&lt;=</span> <span class="hljs-number">3</span>;
</code></pre>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li><strong>å¯è¯»æ€§</strong>ï¼šå°†å¤æ‚çš„æŸ¥è¯¢åˆ†è§£ä¸ºå¤šä¸ªéƒ¨åˆ†ï¼Œä½¿æŸ¥è¯¢æ›´åŠ æ˜“äºç†è§£ã€‚</li>
<li><strong>å¤ç”¨æ€§</strong>ï¼šå¦‚æœæŸ¥è¯¢ä¸­æœ‰å¤šæ¬¡ä½¿ç”¨æŸä¸ªä¸­é—´ç»“æœé›†ï¼Œå¯ä»¥å°†å…¶æå–åˆ° CTE ä¸­è¿›è¡Œå¤ç”¨ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-4">äºŒã€çª—å£å‡½æ•°æ ¸å¿ƒè¯­æ³•</h3>
<h4 data-id="heading-5">è¯­æ³•ç»“æ„</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-operator">&lt;</span>çª—å£å‡½æ•°<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">OVER</span> (
    <span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> <span class="hljs-operator">&lt;</span>åˆ†ç»„å­—æ®µ<span class="hljs-operator">&gt;</span>  <span class="hljs-comment">-- ç±»ä¼¼GROUP BYï¼Œä½†ä¸èšåˆè¡Œ</span>
    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-operator">&lt;</span>æ’åºå­—æ®µ<span class="hljs-operator">&gt;</span>      <span class="hljs-comment">-- ç»„å†…æ’åº</span>
    <span class="hljs-keyword">ROWS</span><span class="hljs-operator">/</span><span class="hljs-keyword">RANGE</span> <span class="hljs-operator">&lt;</span>çª—å£èŒƒå›´<span class="hljs-operator">&gt;</span>    <span class="hljs-comment">-- å¯é€‰ï¼ŒæŒ‡å®šè®¡ç®—èŒƒå›´</span>
)
</code></pre>
<p><strong>å…³é”®ç†è§£ï¼š</strong></p>
<ul>
<li><code>PARTITION BY</code>ï¼šåˆ†ç»„ï¼Œä½†ä¸ä¼šå‡å°‘è¡Œæ•°</li>
<li><code>ORDER BY</code>ï¼šç»„å†…æ’åº</li>
<li>çª—å£å‡½æ•°ä¸èƒ½ç›´æ¥åœ¨WHEREä¸­ä½¿ç”¨ï¼Œéœ€è¦å­æŸ¥è¯¢åŒ…è£¹</li>
</ul>
<hr/>
<h3 data-id="heading-6">ä¸‰ã€æ’åå‡½æ•°ï¼ˆROW_NUMBER/RANK/DENSE_RANKï¼‰</h3>
<h4 data-id="heading-7">ä¸‰å¤§æ’åå‡½æ•°å¯¹æ¯”</h4>





























<table><thead><tr><th>å‡½æ•°</th><th>å¹¶åˆ—å¤„ç†</th><th>ç¤ºä¾‹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>ROW_NUMBER()</strong></td><td>è¿ç»­è¡Œå·</td><td>1,2,3,4</td><td>åˆ†é¡µã€TopN</td></tr><tr><td><strong>RANK()</strong></td><td>å¹¶åˆ—è·³å·</td><td>1,2,2,4</td><td>æˆç»©æ’å(å…è®¸å¹¶åˆ—)</td></tr><tr><td><strong>DENSE_RANK()</strong></td><td>å¹¶åˆ—ä¸è·³å·</td><td>1,2,2,3</td><td>å¯†é›†æ’å</td></tr></tbody></table>
<h4 data-id="heading-8">å®æˆ˜æ¡ˆä¾‹</h4>
<p><strong>åœºæ™¯1ï¼šæ¯ä¸ªéƒ¨é—¨è–ªèµ„æ’å</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> 
    department,
    name,
    salary,
    <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> department <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> row_num,
    <span class="hljs-built_in">RANK</span>() <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> department <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> rank_num,
    <span class="hljs-built_in">DENSE_RANK</span>() <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> department <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> dense_rank_num
<span class="hljs-keyword">FROM</span> employee;
</code></pre>
<p><strong>ç»“æœå¯¹æ¯”ï¼š</strong>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7cfa322cf455456bbaaf64129a51f2a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aqR552AYnVn55qEY29kZXI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766238984&amp;x-signature=Y5F3N3Udd12qpMHqMWBZc5eGw78%3D" alt="image.png" loading="lazy"/></p>
<p><strong>è§£é‡Š</strong>ï¼š</p>
<ul>
<li>
<p><code>ROW_NUMBER()</code> ä¸ºæ¯ä¸ªéƒ¨é—¨çš„å‘˜å·¥åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„æ’åï¼Œæ²¡æœ‰å¹¶åˆ—ã€‚æ¯ä¸ªéƒ¨é—¨çš„æ’åæ˜¯è¿ç»­çš„ï¼Œä¸”ä¸ä¼šæœ‰ç›¸åŒçš„æ’åã€‚ä¾‹å¦‚ï¼Œåœ¨ <strong>æŠ€æœ¯éƒ¨</strong>ï¼Œ<code>å­™ä¸ƒ</code> æ’åç¬¬ 2ï¼Œè€Œä¸æ˜¯å’Œ <code>ç‹äº”</code> å…±äº«ç¬¬ 2 æ’åã€‚</p>
</li>
<li>
<p><code>RANK()</code> ä¼šç»™ç›¸åŒè–ªèµ„çš„å‘˜å·¥åˆ†é…ç›¸åŒçš„æ’åï¼Œå¹¶ä¸”è·³è¿‡åç»­æ’åã€‚ä¾‹å¦‚ï¼Œåœ¨ <strong>æŠ€æœ¯éƒ¨</strong>ï¼Œ<code>å­™ä¸ƒ</code> å’Œ <code>ç‹äº”</code> çš„è–ªèµ„ç›¸åŒï¼Œå› æ­¤ä¸¤è€…çš„æ’åä¸º 1ï¼Œæ¥ä¸‹æ¥æ˜¯æ’åä¸º 3 çš„å‘˜å·¥ã€‚</p>
</li>
<li>
<p><code>DENSE_RANK()</code> ä¹Ÿä¼šä¸ºç›¸åŒè–ªèµ„çš„å‘˜å·¥åˆ†é…ç›¸åŒçš„æ’åï¼Œä½†ä¸åŒçš„æ˜¯ï¼Œå®ƒä¸ä¼šè·³è¿‡åç»­æ’åã€‚ä¾‹å¦‚ï¼Œ<code>å­™ä¸ƒ</code> å’Œ <code>ç‹äº”</code> çš„è–ªèµ„ç›¸åŒï¼Œä»–ä»¬å…±äº«æ’åç¬¬ 1ï¼Œä½†ä¸‹ä¸€åå‘˜å·¥çš„æ’åæ˜¯ 2ï¼Œè€Œä¸æ˜¯ 3ã€‚</p>
</li>
</ul>
<hr/>
<p><strong>åœºæ™¯2ï¼šæ¯ä¸ªéƒ¨é—¨è–ªèµ„å‰3å</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> (
    <span class="hljs-keyword">SELECT</span> 
        department, name, salary,
        <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> department <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> rn
    <span class="hljs-keyword">FROM</span> employee
) t <span class="hljs-keyword">WHERE</span> rn <span class="hljs-operator">&lt;=</span> <span class="hljs-number">3</span>;
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ec0a6294a7b4c49a48c904bc429edf8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aqR552AYnVn55qEY29kZXI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766238984&amp;x-signature=0H%2BvSHEEcGzEjN1Tu%2FIXXRCwh0A%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-9">å››ã€åç§»å‡½æ•°ï¼ˆLAG/LEADï¼‰</h3>
<h4 data-id="heading-10">ç¯æ¯”ã€åŒæ¯”å’Œè¶‹åŠ¿åˆ†æç®€ä»‹</h4>
<ul>
<li><strong>ç¯æ¯”ï¼ˆMonth-on-Monthï¼ŒMoMï¼‰</strong> ï¼šç¯æ¯”æŒ‡çš„æ˜¯å½“å‰æ—¶é—´æ®µä¸å‰ä¸€ä¸ªæ—¶é—´æ®µæ•°æ®çš„æ¯”è¾ƒï¼Œé€šå¸¸ç”¨äºè¡¡é‡æŸä¸ªæŒ‡æ ‡åœ¨ä¸€ä¸ªå‘¨æœŸï¼ˆå¦‚ä¸€ä¸ªæœˆï¼‰å†…çš„å¢é•¿æˆ–ä¸‹é™ã€‚ä¾‹å¦‚ï¼Œæ¯”è¾ƒæœ¬æœˆä¸ä¸Šæœˆçš„é”€å”®é¢ï¼Œè¯„ä¼°ä¸šåŠ¡çš„çŸ­æœŸå¢é•¿æˆ–å˜åŒ–è¶‹åŠ¿ã€‚</li>
<li><strong>åŒæ¯”ï¼ˆYear-on-Yearï¼ŒYoYï¼‰</strong> ï¼šåŒæ¯”æŒ‡çš„æ˜¯å½“å‰æ—¶é—´æ®µä¸å»å¹´åŒä¸€æ—¶é—´æ®µçš„æ•°æ®å¯¹æ¯”ã€‚é€šå¸¸ç”¨äºè¯„ä¼°ä¸€å¹´æ—¶é—´å†…ä¸šåŠ¡çš„å˜åŒ–ï¼Œå¸®åŠ©æˆ‘ä»¬çœ‹åˆ°é•¿æœŸçš„å¢é•¿æˆ–ä¸‹é™è¶‹åŠ¿ã€‚æ¯”å¦‚å¯¹æ¯”ä»Šå¹´ 1 æœˆä¸å»å¹´ 1 æœˆçš„é”€å”®é¢ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰å¢é•¿ã€‚</li>
<li><strong>è¶‹åŠ¿åˆ†æï¼ˆTrend Analysisï¼‰</strong> ï¼šè¶‹åŠ¿åˆ†ææ—¨åœ¨è¯†åˆ«å’Œåˆ†æä¸€æ®µæ—¶é—´å†…æ•°æ®çš„å˜åŒ–æ–¹å‘ã€‚é€šè¿‡å¯¹æ¯”å‰åæ•°æ®ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬äº†è§£æŸä¸ªæŒ‡æ ‡çš„é•¿æœŸèµ°åŠ¿ï¼Œå¸¸ç”¨äºé¢„æµ‹æœªæ¥çš„å˜åŒ–ã€‚ä¾‹å¦‚ï¼ŒæŸ¥çœ‹è¿‡å»å‡ ä¸ªæœˆçš„é”€å”®æ•°æ®ï¼Œåˆ†ææ˜¯å¦æœ‰æŒç»­å¢é•¿çš„è¶‹åŠ¿ã€‚</li>
<li><strong>é¢„æµ‹ï¼ˆForecastingï¼‰</strong> ï¼šé¢„æµ‹æ˜¯é€šè¿‡åˆ†æå½“å‰æ•°æ®çš„è¶‹åŠ¿ï¼Œæ¨æµ‹æœªæ¥æ•°æ®çš„å¯èƒ½å€¼ã€‚ä½¿ç”¨ <code>LEAD</code> å‡½æ•°å¯ä»¥å¸®åŠ©ä½ åœ¨ç°æœ‰æ•°æ®çš„åŸºç¡€ä¸Šï¼Œé¢„æµ‹æœªæ¥çš„å˜åŒ–è¶‹åŠ¿ï¼Œæ¯”å¦‚é¢„æµ‹æœªæ¥å‡ ä¸ªæœˆçš„é”€å”®é¢ã€‚</li>
</ul>
<h4 data-id="heading-11">è¯­æ³•ä¸ä½œç”¨</h4>




















<table><thead><tr><th>å‡½æ•°</th><th>ä½œç”¨</th><th>åº”ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>LAG(å­—æ®µ, N)</strong></td><td>è®¿é—®å‰Nè¡Œæ•°æ®</td><td>è®¡ç®—ç¯æ¯”ã€åŒæ¯”</td></tr><tr><td><strong>LEAD(å­—æ®µ, N)</strong></td><td>è®¿é—®åNè¡Œæ•°æ®</td><td>é¢„æµ‹ã€è¶‹åŠ¿åˆ†æ</td></tr></tbody></table>
<h4 data-id="heading-12">å®æˆ˜æ¡ˆä¾‹</h4>
<p><strong>åœºæ™¯ï¼šè®¡ç®—æ¯æœˆé”€å”®é¢çš„ç¯æ¯”å¢é•¿</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å‡è®¾æœ‰æœˆåº¦é”€å”®è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> monthly_sales (
    <span class="hljs-keyword">month</span> <span class="hljs-type">DATE</span>,
    sales <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>)
);

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> monthly_sales <span class="hljs-keyword">VALUES</span>
(<span class="hljs-string">'2024-01-01'</span>, <span class="hljs-number">10000</span>),
(<span class="hljs-string">'2024-02-01'</span>, <span class="hljs-number">12000</span>),
(<span class="hljs-string">'2024-03-01'</span>, <span class="hljs-number">11000</span>),
(<span class="hljs-string">'2024-04-01'</span>, <span class="hljs-number">15000</span>);

<span class="hljs-comment">-- è®¡ç®—ç¯æ¯”å¢é•¿</span>
<span class="hljs-keyword">SELECT</span> 
    <span class="hljs-keyword">month</span>,
    sales,
    <span class="hljs-built_in">LAG</span>(sales, <span class="hljs-number">1</span>) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">month</span>) <span class="hljs-keyword">AS</span> last_month_sales,
    sales <span class="hljs-operator">-</span> <span class="hljs-built_in">LAG</span>(sales, <span class="hljs-number">1</span>) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">month</span>) <span class="hljs-keyword">AS</span> month_on_month,
    ROUND((sales <span class="hljs-operator">-</span> <span class="hljs-built_in">LAG</span>(sales, <span class="hljs-number">1</span>) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">month</span>)) <span class="hljs-operator">/</span> <span class="hljs-built_in">NULLIF</span>(<span class="hljs-built_in">LAG</span>(sales, <span class="hljs-number">1</span>) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">month</span>), <span class="hljs-number">0</span>) <span class="hljs-operator">*</span> <span class="hljs-number">100</span>, <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> growth_rate
<span class="hljs-keyword">FROM</span> monthly_sales;
</code></pre>
<p><strong>ç»“æœï¼š</strong>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e74fa9cc31942bca3af2d58648a7851~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aqR552AYnVn55qEY29kZXI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766238984&amp;x-signature=9DdSqK%2BHs0fnv%2FkplVOcmUBB1lM%3D" alt="image.png" loading="lazy"/></p>
<p><strong>è§£é‡Šï¼š</strong></p>
<ul>
<li><code>month</code>ï¼šè¡¨ç¤ºæœˆä»½ã€‚</li>
<li><code>sales</code>ï¼šè¡¨ç¤ºè¯¥æœˆä»½çš„é”€å”®é¢ã€‚</li>
<li><code>last_month_sales</code>ï¼šä½¿ç”¨ <code>LAG</code> å‡½æ•°è·å–ä¸Šä¸ªæœˆçš„é”€å”®é¢ã€‚åœ¨ 2024 å¹´ 1 æœˆçš„è¡Œä¸­ï¼Œç”±äºæ²¡æœ‰å‰ä¸€ä¸ªæœˆçš„è®°å½•ï¼Œè¿™ä¸ªå­—æ®µä¸º <code>NULL</code>ã€‚</li>
<li><code>month_on_month</code>ï¼šè®¡ç®—ç¯æ¯”å¢é•¿ï¼Œå³å½“å‰æœˆé”€å”®é¢ä¸ä¸Šæœˆé”€å”®é¢çš„å·®å€¼ã€‚2024 å¹´ 1 æœˆæ— å‰ä¸€ä¸ªæœˆæ•°æ®ï¼Œå·®å€¼ä¸º <code>NULL</code>ã€‚</li>
<li><code>growth_rate</code>ï¼šè®¡ç®—ç¯æ¯”å¢é•¿ç‡ï¼Œé€šè¿‡ <code>(sales - last_month_sales) / last_month_sales * 100</code> å¾—åˆ°çš„ç™¾åˆ†æ¯”å€¼ã€‚2024 å¹´ 1 æœˆç”±äºæ²¡æœ‰å‰ä¸€ä¸ªæœˆæ•°æ®ï¼Œæ— æ³•è®¡ç®—å¢é•¿ç‡ã€‚</li>
</ul>
<hr/>
<p><strong>åœºæ™¯ï¼šæŸ¥çœ‹å‘˜å·¥ä¸å‰ä¸€åã€åä¸€åçš„è–ªèµ„å·®è·</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> 
    name,
    salary,
    <span class="hljs-built_in">LAG</span>(name, <span class="hljs-number">1</span>) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> higher_salary_person,
    <span class="hljs-built_in">LAG</span>(salary, <span class="hljs-number">1</span>) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) <span class="hljs-operator">-</span> salary <span class="hljs-keyword">AS</span> gap_with_higher,
    <span class="hljs-built_in">LEAD</span>(name, <span class="hljs-number">1</span>) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> lower_salary_person,
    salary <span class="hljs-operator">-</span> <span class="hljs-built_in">LEAD</span>(salary, <span class="hljs-number">1</span>) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> gap_with_lower
<span class="hljs-keyword">FROM</span> employee;
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fa1ab8894a9044d19895bb839faf9b5c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aqR552AYnVn55qEY29kZXI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766238984&amp;x-signature=chkwrnUWmQVjVn8nAyW8cz1hjX0%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-13">è§£é‡Šï¼š</h4>
<ul>
<li>
<p><code>higher_salary_person</code>ï¼šé€šè¿‡ <code>LAG</code> å‡½æ•°æŸ¥æ‰¾å½“å‰å‘˜å·¥è–ªèµ„å‰ä¸€ä½çš„å‘˜å·¥ï¼ˆå³è–ªèµ„è¾ƒé«˜çš„å‘˜å·¥ï¼‰ã€‚</p>
</li>
<li>
<p><code>gap_with_higher</code>ï¼šå½“å‰å‘˜å·¥ä¸å‰ä¸€ä½å‘˜å·¥çš„è–ªèµ„å·®è·ã€‚å³é€šè¿‡ <code>LAG</code> å‡½æ•°æ‰¾åˆ°å‰ä¸€ä½å‘˜å·¥åï¼Œè®¡ç®—ä¸¤è€…çš„è–ªèµ„å·®ã€‚</p>
</li>
<li>
<p><code>ower_salary_person</code>ï¼šé€šè¿‡ <code>LEAD</code> å‡½æ•°æŸ¥æ‰¾å½“å‰å‘˜å·¥è–ªèµ„åä¸€ä½çš„å‘˜å·¥ï¼ˆå³è–ªèµ„è¾ƒä½çš„å‘˜å·¥ï¼‰ã€‚</p>
</li>
<li>
<p><code>gap_with_lower</code>ï¼šå½“å‰å‘˜å·¥ä¸åä¸€ä½å‘˜å·¥çš„è–ªèµ„å·®è·ã€‚å³é€šè¿‡ <code>LEAD</code> å‡½æ•°æ‰¾åˆ°åä¸€ä½å‘˜å·¥åï¼Œè®¡ç®—ä¸¤è€…çš„è–ªèµ„å·®ã€‚</p>
</li>
</ul>
<hr/>
<h3 data-id="heading-14">äº”ã€èšåˆçª—å£å‡½æ•°ï¼ˆSUM/AVG OVERï¼‰</h3>
<h4 data-id="heading-15">ç´¯è®¡æ±‚å’Œ</h4>
<p><strong>åœºæ™¯ï¼šè®¡ç®—ç´¯è®¡é”€å”®é¢</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> 
    <span class="hljs-keyword">month</span>,
    sales,
    <span class="hljs-built_in">SUM</span>(sales) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">month</span>) <span class="hljs-keyword">AS</span> cumulative_sales
<span class="hljs-keyword">FROM</span> monthly_sales;
</code></pre>
<p><strong>ç»“æœï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/36cbcec725f84a15b5b600906e484c67~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aqR552AYnVn55qEY29kZXI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766238984&amp;x-signature=MZQ9i1xGhsIWtXOA%2B7tSWz7u3qk%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h4 data-id="heading-16">ç§»åŠ¨å¹³å‡</h4>
<p><strong>åœºæ™¯ï¼šè®¡ç®—æœ€è¿‘3ä¸ªæœˆçš„ç§»åŠ¨å¹³å‡é”€å”®é¢</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> 
    <span class="hljs-keyword">month</span>,
    sales,
    <span class="hljs-built_in">AVG</span>(sales) <span class="hljs-keyword">OVER</span> (
        <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">month</span> 
        <span class="hljs-keyword">ROWS</span> <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">2</span> PRECEDING <span class="hljs-keyword">AND</span> <span class="hljs-keyword">CURRENT</span> <span class="hljs-type">ROW</span>
    ) <span class="hljs-keyword">AS</span> moving_avg_3months
<span class="hljs-keyword">FROM</span> monthly_sales;
</code></pre>
<p><strong>çª—å£èŒƒå›´è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>ROWS BETWEEN 2 PRECEDING AND CURRENT ROW</code>ï¼šå½“å‰è¡ŒåŠå‰2è¡Œï¼ˆå…±3è¡Œï¼‰</li>
<li><code>ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW</code>ï¼šä»ç¬¬ä¸€è¡Œåˆ°å½“å‰è¡Œï¼ˆç´¯è®¡ï¼‰</li>
</ul>
<blockquote>
<p><strong>è¿›é˜¶æç¤ºï¼šROWS vs RANGE</strong></p>
<ul>
<li><strong>ROWS</strong>ï¼šæŒ‰<strong>ç‰©ç†è¡Œ</strong>åç§»ï¼ˆå¦‚â€œå‰ä¸€è¡Œâ€ï¼‰ã€‚</li>
<li><strong>RANGE</strong>ï¼šæŒ‰<strong>æ•°å€¼</strong>åç§»ï¼ˆå¦‚â€œæ—¥æœŸå‡1å¤©â€æˆ–â€œé‡‘é¢å‡100â€ï¼‰ï¼Œå¤„ç†é‡å¤å€¼æ—¶è¡Œä¸ºä¸åŒã€‚</li>
</ul>
</blockquote>
<hr/>
<h3 data-id="heading-17">å…­ã€CTEå…¬å…±è¡¨è¡¨è¾¾å¼ï¼ˆWITHå­å¥ï¼‰</h3>
<h4 data-id="heading-18">CTE çš„å…¥é—¨ä»‹ç»</h4>
<p>åœ¨æ­£å¼è¿›å…¥ SQL ç¤ºä¾‹å‰ï¼Œç¡®å®éœ€è¦å¯¹ CTEï¼ˆå…¬å…±è¡¨è¡¨è¾¾å¼ï¼‰ åšä¸€ä¸ªåŸºç¡€çš„ä»‹ç»ã€‚CTE æ˜¯ä¸€ç§ä¸´æ—¶çš„ç»“æœé›†ï¼Œå¯ä»¥åœ¨ SELECTã€INSERTã€UPDATE æˆ– DELETE è¯­å¥ä¸­ä½¿ç”¨ã€‚å®ƒå¸®åŠ©æˆ‘ä»¬åˆ†è§£å¤æ‚çš„æŸ¥è¯¢ï¼Œä½¿å…¶æ›´æ˜“è¯»å’Œå¯ç»´æŠ¤ã€‚</p>
<p>åŸºæœ¬è¯­æ³•ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">WITH</span> cte_name <span class="hljs-keyword">AS</span> (
<span class="hljs-comment">-- CTE æŸ¥è¯¢å†…å®¹</span>
<span class="hljs-keyword">SELECT</span> ...
)
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> cte_name;
</code></pre>
<h4 data-id="heading-19">ä¸ºä»€ä¹ˆéœ€è¦CTEï¼Ÿ</h4>
<p><strong>ä¼ ç»Ÿå­æŸ¥è¯¢ï¼šåµŒå¥—å¤æ‚</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> dept_name, avg_salary
<span class="hljs-keyword">FROM</span> departments d
<span class="hljs-keyword">JOIN</span> (
    <span class="hljs-keyword">SELECT</span> dept_id, <span class="hljs-built_in">AVG</span>(salary) <span class="hljs-keyword">AS</span> avg_salary
    <span class="hljs-keyword">FROM</span> employees
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> dept_id
) e <span class="hljs-keyword">ON</span> d.id <span class="hljs-operator">=</span> e.dept_id
<span class="hljs-keyword">WHERE</span> e.avg_salary <span class="hljs-operator">&gt;</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">AVG</span>(salary) <span class="hljs-keyword">FROM</span> employees
);
</code></pre>
<p><strong>CTEå†™æ³•ï¼šé€»è¾‘æ¸…æ™°</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">WITH</span> dept_avg <span class="hljs-keyword">AS</span> (
    <span class="hljs-keyword">SELECT</span> dept_id, <span class="hljs-built_in">AVG</span>(salary) <span class="hljs-keyword">AS</span> avg_salary
    <span class="hljs-keyword">FROM</span> employees
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> dept_id
),
company_avg <span class="hljs-keyword">AS</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">AVG</span>(salary) <span class="hljs-keyword">AS</span> avg_salary <span class="hljs-keyword">FROM</span> employees
)
<span class="hljs-keyword">SELECT</span> d.dept_name, da.avg_salary
<span class="hljs-keyword">FROM</span> departments d
<span class="hljs-keyword">JOIN</span> dept_avg da <span class="hljs-keyword">ON</span> d.id <span class="hljs-operator">=</span> da.dept_id
<span class="hljs-keyword">CROSS</span> <span class="hljs-keyword">JOIN</span> company_avg ca
<span class="hljs-keyword">WHERE</span> da.avg_salary <span class="hljs-operator">&gt;</span> ca.avg_salary;
</code></pre>
<p><strong>CTEçš„ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>âœ… å‘½åæ¸…æ™°ï¼Œå¯è¯»æ€§é«˜</li>
<li>âœ… å¯ä»¥å¤šæ¬¡å¼•ç”¨åŒä¸€ä¸ªCTE</li>
<li>âœ… é€»è¾‘åˆ†å±‚ï¼Œä¾¿äºè°ƒè¯•</li>
</ul>
<hr/>
<h3 data-id="heading-20">ä¸ƒã€é€’å½’CTEï¼ˆæŸ¥è¯¢å±‚çº§æ•°æ®ï¼‰</h3>
<h4 data-id="heading-21">è¯­æ³•ç»“æ„</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">WITH</span> <span class="hljs-keyword">RECURSIVE</span> cte_name <span class="hljs-keyword">AS</span> (
    <span class="hljs-comment">-- 1. é”šç‚¹æŸ¥è¯¢ï¼ˆåˆå§‹æ•°æ®ï¼‰</span>
    <span class="hljs-keyword">SELECT</span> ... <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">WHERE</span> ...
    
    <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span>
    
    <span class="hljs-comment">-- 2. é€’å½’æŸ¥è¯¢ï¼ˆå…³è”ä¸Šä¸€å±‚ç»“æœï¼‰</span>
    <span class="hljs-keyword">SELECT</span> ... <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">JOIN</span> cte_name <span class="hljs-keyword">ON</span> ...
)
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> cte_name;
</code></pre>
<h4 data-id="heading-22">å®æˆ˜æ¡ˆä¾‹</h4>
<p><strong>åœºæ™¯ï¼šå•†å“åˆ†ç±»æ ‘</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å•†å“åˆ†ç±»è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> categories (
    id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY,
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>),
    parent_id <span class="hljs-type">INT</span>
);

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> categories <span class="hljs-keyword">VALUES</span>
(<span class="hljs-number">1</span>, <span class="hljs-string">'ç”µå­äº§å“'</span>, <span class="hljs-keyword">NULL</span>),
(<span class="hljs-number">2</span>, <span class="hljs-string">'æ‰‹æœº'</span>, <span class="hljs-number">1</span>),
(<span class="hljs-number">3</span>, <span class="hljs-string">'ç”µè„‘'</span>, <span class="hljs-number">1</span>),
(<span class="hljs-number">4</span>, <span class="hljs-string">'iPhone'</span>, <span class="hljs-number">2</span>),
(<span class="hljs-number">5</span>, <span class="hljs-string">'Android'</span>, <span class="hljs-number">2</span>),
(<span class="hljs-number">6</span>, <span class="hljs-string">'ç¬”è®°æœ¬'</span>, <span class="hljs-number">3</span>),
(<span class="hljs-number">7</span>, <span class="hljs-string">'å°å¼æœº'</span>, <span class="hljs-number">3</span>);

<span class="hljs-comment">-- æŸ¥è¯¢"æ‰‹æœº"åˆ†ç±»ä¸‹çš„æ‰€æœ‰å­åˆ†ç±»</span>
<span class="hljs-keyword">WITH</span> <span class="hljs-keyword">RECURSIVE</span> category_tree <span class="hljs-keyword">AS</span> (
    <span class="hljs-keyword">SELECT</span> id, name, parent_id, <span class="hljs-number">1</span> <span class="hljs-keyword">AS</span> level
    <span class="hljs-keyword">FROM</span> categories
    <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">2</span>
    
    <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span>
    
    <span class="hljs-keyword">SELECT</span> c.id, c.name, c.parent_id, ct.level <span class="hljs-operator">+</span> <span class="hljs-number">1</span>
    <span class="hljs-keyword">FROM</span> categories c
    <span class="hljs-keyword">JOIN</span> category_tree ct <span class="hljs-keyword">ON</span> c.parent_id <span class="hljs-operator">=</span> ct.id
)
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> category_tree;
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df7e8781c52d414b895aabbff55bc23b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aqR552AYnVn55qEY29kZXI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766238984&amp;x-signature=C1k4avqKbYtHtll%2B07ML9LNACS0%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-23">é€’å½’ CTE è¯­æ³•è§£æï¼š</h4>
<h5 data-id="heading-24">1. <strong>åˆå§‹åŒ–æŸ¥è¯¢ï¼ˆé”šç‚¹æŸ¥è¯¢ï¼‰</strong></h5>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> id, name, parent_id, <span class="hljs-number">1</span> <span class="hljs-keyword">AS</span> level
<span class="hljs-keyword">FROM</span> categories
<span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">2</span>  <span class="hljs-comment">-- åˆå§‹æŸ¥è¯¢ï¼Œæ‰¾åˆ°"æ‰‹æœº"ç±»åˆ«</span>
</code></pre>
<ul>
<li>è¿™æ˜¯é€’å½’æŸ¥è¯¢çš„ <strong>é”šç‚¹æŸ¥è¯¢</strong>ï¼Œå®ƒè·å–äº† <strong>â€œæ‰‹æœºâ€</strong> ç±»åˆ«ï¼ˆID ä¸º 2ï¼‰çš„æ•°æ®ï¼Œå¹¶ä¸”è®¾ç½®äº†ä¸€ä¸ªåˆå§‹çš„ <strong><code>level</code></strong> å€¼ä¸º 1ï¼Œè¡¨ç¤ºâ€œæ‰‹æœºâ€åˆ†ç±»çš„å±‚çº§æ˜¯ç¬¬ä¸€å±‚ã€‚</li>
<li><code>level</code> å­—æ®µç”¨äºæ ‡è®°åˆ†ç±»çš„å±‚çº§ï¼Œä»¥ä¾¿åœ¨é€’å½’è¿‡ç¨‹ä¸­å¯ä»¥åŒºåˆ†ä¸åŒå±‚çº§çš„åˆ†ç±»ã€‚</li>
</ul>
<h5 data-id="heading-25">2. <strong>é€’å½’æŸ¥è¯¢ï¼ˆé€’å½’éƒ¨åˆ†ï¼‰</strong></h5>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span>
<span class="hljs-keyword">SELECT</span> c.id, c.name, c.parent_id, ct.level <span class="hljs-operator">+</span> <span class="hljs-number">1</span>
<span class="hljs-keyword">FROM</span> categories c
<span class="hljs-keyword">JOIN</span> category_tree ct <span class="hljs-keyword">ON</span> c.parent_id <span class="hljs-operator">=</span> ct.id
</code></pre>
<ul>
<li>
<p><strong><code>UNION ALL</code></strong>ï¼šå°†é”šç‚¹æŸ¥è¯¢å’Œé€’å½’æŸ¥è¯¢çš„ç»“æœåˆå¹¶ã€‚è¿™é‡Œä½¿ç”¨ <strong><code>UNION ALL</code></strong> è€Œä¸æ˜¯ <strong><code>UNION</code></strong>ï¼Œå› ä¸ºæˆ‘ä»¬ä¸éœ€è¦å»é‡ï¼Œåªæ˜¯ç®€å•åœ°å°†æ¯æ¬¡é€’å½’çš„ç»“æœè¿›è¡Œç´¯ç§¯ã€‚</p>
</li>
<li>
<p><strong>é€’å½’éƒ¨åˆ†</strong>ï¼šæ¯æ¬¡é€’å½’æŸ¥è¯¢éƒ½ä¼šæŸ¥æ‰¾å½“å‰ <code>category_tree</code>ï¼ˆä¸Šä¸€æ¬¡é€’å½’ç»“æœï¼‰ä¸­çš„ <strong><code>id</code></strong>ï¼Œå¹¶æ ¹æ®è¿™äº› <strong><code>id</code></strong> æ‰¾åˆ°å®ƒä»¬çš„å­åˆ†ç±»ï¼ˆå³é€šè¿‡ <strong><code>parent_id = ct.id</code></strong> çš„æ¡ä»¶æ¥è¿›è¡Œè¿æ¥ï¼‰ã€‚</p>
</li>
<li>
<p><code>ct.level + 1</code>ï¼šæ¯æ¬¡é€’å½’æ—¶ï¼Œæˆ‘ä»¬å°†å½“å‰åˆ†ç±»çš„å±‚çº§ <code>level</code> åŠ  1ï¼Œä»¥è¡¨ç¤ºå­åˆ†ç±»æ¯”çˆ¶åˆ†ç±»å¤šä¸€å±‚ã€‚</p>
</li>
</ul>
<h5 data-id="heading-26">3. <strong>æœ€ç»ˆæŸ¥è¯¢ç»“æœ</strong></h5>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> category_tree;
</code></pre>
<h4 data-id="heading-27">é€’å½’ CTE çš„ä¼˜åŠ¿ï¼š</h4>
<ol>
<li><strong>é€‚ç”¨äºæ ‘å½¢ç»“æ„æ•°æ®</strong>ï¼šé€’å½’ CTE å¾ˆé€‚åˆæŸ¥è¯¢å’Œå¤„ç†å±‚çº§ç»“æ„æ•°æ®ï¼ˆå¦‚åˆ†ç±»æ ‘ã€ç»„ç»‡æ¶æ„ç­‰ï¼‰ã€‚</li>
<li><strong>ç»“æ„æ¸…æ™°</strong>ï¼šé€šè¿‡ <code>WITH RECURSIVE</code> å®šä¹‰é€’å½’æŸ¥è¯¢ï¼Œèƒ½å¤Ÿæ¸…æ™°åœ°åˆ†éš”é”šç‚¹æŸ¥è¯¢å’Œé€’å½’æŸ¥è¯¢éƒ¨åˆ†ï¼Œä½¿å¾—æŸ¥è¯¢é€»è¾‘æ›´åŠ æ˜“æ‡‚ã€‚</li>
<li><strong>å¯æ‰©å±•æ€§å¼º</strong>ï¼šå¦‚æœå±‚çº§ç»“æ„å¾ˆæ·±ï¼Œé€’å½’æŸ¥è¯¢ä¼šç»§ç»­æ‰§è¡Œç›´åˆ°æ‰€æœ‰å­åˆ†ç±»è¢«æŸ¥è¯¢å®Œæ¯•ï¼Œæ— éœ€æ‰‹åŠ¨æŒ‡å®šå±‚çº§çš„æ·±åº¦ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-28">å…«ã€é¿å‘æŒ‡å—</h3>
<h4 data-id="heading-29">å‘1ï¼šçª—å£å‡½æ•°ä¸èƒ½ç›´æ¥åœ¨WHEREä¸­ä½¿ç”¨</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- âŒ é”™è¯¯</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>, <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> department <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> rn
<span class="hljs-keyword">FROM</span> employee
<span class="hljs-keyword">WHERE</span> rn <span class="hljs-operator">&lt;=</span> <span class="hljs-number">3</span>;  <span class="hljs-comment">-- æŠ¥é”™ï¼</span>

<span class="hljs-comment">-- âœ… æ­£ç¡®</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>, <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> department <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> rn
    <span class="hljs-keyword">FROM</span> employee
) t <span class="hljs-keyword">WHERE</span> rn <span class="hljs-operator">&lt;=</span> <span class="hljs-number">3</span>;
</code></pre>
<hr/>
<h4 data-id="heading-30">å‘2ï¼šé€’å½’CTEå¿…é¡»æœ‰ç»ˆæ­¢æ¡ä»¶</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- âŒ é”™è¯¯ï¼šæ­»å¾ªç¯</span>
<span class="hljs-keyword">WITH</span> <span class="hljs-keyword">RECURSIVE</span> bad_cte <span class="hljs-keyword">AS</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">AS</span> n
    <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span>
    <span class="hljs-keyword">SELECT</span> n <span class="hljs-operator">+</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> bad_cte  <span class="hljs-comment">-- æ°¸è¿œä¸ä¼šåœæ­¢</span>
)
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> bad_cte;

<span class="hljs-comment">-- âœ… æ­£ç¡®ï¼šåŠ ç»ˆæ­¢æ¡ä»¶</span>
<span class="hljs-keyword">WITH</span> <span class="hljs-keyword">RECURSIVE</span> good_cte <span class="hljs-keyword">AS</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">AS</span> n
    <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span>
    <span class="hljs-keyword">SELECT</span> n <span class="hljs-operator">+</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> good_cte <span class="hljs-keyword">WHERE</span> n <span class="hljs-operator">&lt;</span> <span class="hljs-number">10</span>  <span class="hljs-comment">-- ç»ˆæ­¢æ¡ä»¶</span>
)
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> good_cte;
</code></pre>
<hr/>
<h4 data-id="heading-31">å‘3ï¼šPARTITION BYä¸åŒäºGROUP BY</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- GROUP BYï¼šèšåˆè¡Œï¼Œå‡å°‘è¡Œæ•°</span>
<span class="hljs-keyword">SELECT</span> department, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> employee <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> department;
<span class="hljs-comment">-- ç»“æœï¼š3è¡Œï¼ˆ3ä¸ªéƒ¨é—¨ï¼‰</span>

<span class="hljs-comment">-- PARTITION BYï¼šåˆ†ç»„è®¡ç®—ï¼Œä¸å‡å°‘è¡Œæ•°</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> department) <span class="hljs-keyword">FROM</span> employee;
<span class="hljs-comment">-- ç»“æœï¼š10è¡Œï¼ˆæ‰€æœ‰å‘˜å·¥ï¼Œæ¯è¡Œæ˜¾ç¤ºæ‰€åœ¨éƒ¨é—¨çš„æ€»äººæ•°ï¼‰</span>
</code></pre>
<hr/>
<h3 data-id="heading-32">ä¹ã€æœ¬è®²ä½œä¸š</h3>
<h4 data-id="heading-33">åŸºç¡€ç»ƒä¹ </h4>
<ol>
<li>æŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨è–ªèµ„æ’åå‰3çš„å‘˜å·¥ï¼ˆç”¨ROW_NUMBERï¼‰</li>
<li>è®¡ç®—æ¯ä¸ªå‘˜å·¥çš„è–ªèµ„ä¸éƒ¨é—¨å¹³å‡è–ªèµ„çš„å·®è·ï¼ˆç”¨AVG OVERï¼‰</li>
<li>æŸ¥è¯¢æ¯ä¸ªå‘˜å·¥çš„ä¸Šä¸€åå’Œä¸‹ä¸€åï¼ˆç”¨LAG/LEADï¼‰</li>
</ol>
<h4 data-id="heading-34">è¿›é˜¶æŒ‘æˆ˜</h4>
<ol start="4">
<li>ç”¨CTEæ”¹å†™ä¸€ä¸ªå¤æ‚çš„åµŒå¥—å­æŸ¥è¯¢ï¼ˆä»ä½ çš„é¡¹ç›®ä¸­æ‰¾ï¼‰</li>
<li>ç”¨é€’å½’CTEæŸ¥è¯¢æŸå‘˜å·¥çš„æ‰€æœ‰ä¸‹å±ï¼ˆåŒ…æ‹¬ä¸‹å±çš„ä¸‹å±ï¼‰</li>
<li>ç”¨çª—å£å‡½æ•°å®ç°åˆ†é¡µï¼ˆæ›¿ä»£LIMIT OFFSETï¼‰</li>
</ol>
<h4 data-id="heading-35">æ€§èƒ½å¯¹æ¯”</h4>
<ol start="7">
<li>å¯¹æ¯”"æ¯éƒ¨é—¨TOP3"çš„ä¸¤ç§å®ç°ï¼ˆçª—å£å‡½æ•° vs å…³è”å­æŸ¥è¯¢ï¼‰ï¼Œæµ‹è¯•æ€§èƒ½å·®å¼‚</li>
</ol>
<hr/>
<h3 data-id="heading-36">åã€ä¸‹ä¸€è®²é¢„å‘Š</h3>
<p>ä»Šå¤©å­¦ä¹ äº†ç°ä»£SQLçš„å¼ºå¤§ç‰¹æ€§ï¼Œä¸‹ä¸€è®²å›åˆ°MySQLçš„æ ¸å¿ƒåŸç†ã€‚</p>
<p><strong>ç¬¬5è®²ï¼šäº‹åŠ¡â€”â€”æ•°æ®ä¸€è‡´æ€§çš„ä¿æŠ¤ä¼</strong></p>
<ul>
<li>ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼ŸACIDç‰¹æ€§æ˜¯å•¥ï¼Ÿ</li>
<li>è½¬è´¦çš„é’±æ€ä¹ˆä¿è¯ä¸ä¸¢ä¸é‡ï¼Ÿ</li>
<li>ä¸¤ä¸ªäººåŒæ—¶æ”¹åŒä¸€æ¡æ•°æ®ä¼šæ€æ ·ï¼Ÿ</li>
<li><strong>éš”ç¦»çº§åˆ«</strong>ï¼šè„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»</li>
<li>undo logå’Œredo logçš„ä½œç”¨</li>
</ul>
<p>æŒæ¡äº†çª—å£å‡½æ•°å’ŒCTEï¼Œä½ çš„SQLæŸ¥è¯¢èƒ½åŠ›å·²ç»è¶…è¶Šäº†80%çš„å¼€å‘è€…ã€‚ä¸‹ä¸€è®²æˆ‘ä»¬æ·±å…¥MySQLå†…æ ¸ï¼Œç†è§£äº‹åŠ¡å’Œå¹¶å‘æ§åˆ¶çš„åŸç†ï¼</p>
<p><strong>å‡†å¤‡å·¥ä½œï¼š</strong></p>
<ul>
<li>å®Œæˆä»Šå¤©çš„ä½œä¸šï¼Œç†Ÿç»ƒæŒæ¡çª—å£å‡½æ•°</li>
<li>æ€è€ƒï¼šä¸¤ä¸ªäººåŒæ—¶ç»™åŒä¸€ä¸ªè´¦æˆ·è½¬è´¦1000å…ƒï¼Œæœ€åä½™é¢åº”è¯¥æ˜¯å¤šå°‘ï¼Ÿ</li>
</ul>
<hr/>
<p><strong>ä¸‹ä¸€è®²è§ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[A*ï¼ˆA-Starï¼‰ç®—æ³•è¯¦è§£ï¼šæ™ºèƒ½è·¯å¾„è§„åˆ’çš„æ ¸å¿ƒæŠ€æœ¯]]></title>    <link>https://juejin.cn/post/7582905804047712283</link>    <guid>https://juejin.cn/post/7582905804047712283</guid>    <pubDate>2025-12-13T13:59:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582905804047712283" data-draft-id="7582862885107695666" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="A*ï¼ˆA-Starï¼‰ç®—æ³•è¯¦è§£ï¼šæ™ºèƒ½è·¯å¾„è§„åˆ’çš„æ ¸å¿ƒæŠ€æœ¯"/> <meta itemprop="keywords" content="åç«¯,ç®—æ³•"/> <meta itemprop="datePublished" content="2025-12-13T13:59:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘æ˜¯ä½ ä»¬çš„æ˜å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/3333374985122398"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            A*ï¼ˆA-Starï¼‰ç®—æ³•è¯¦è§£ï¼šæ™ºèƒ½è·¯å¾„è§„åˆ’çš„æ ¸å¿ƒæŠ€æœ¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3333374985122398/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘æ˜¯ä½ ä»¬çš„æ˜å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T13:59:29.000Z" title="Sat Dec 13 2025 13:59:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>åœ¨äººå·¥æ™ºèƒ½ã€æ¸¸æˆå¼€å‘ã€æœºå™¨äººå¯¼èˆªä»¥åŠåœ°å›¾åº”ç”¨ç­‰é¢†åŸŸï¼Œå¯»æ‰¾ä¸¤ç‚¹ä¹‹é—´çš„æœ€ä¼˜è·¯å¾„æ˜¯ä¸€ä¸ªåŸºç¡€è€Œå…³é”®çš„é—®é¢˜ã€‚A*ï¼ˆè¯»ä½œâ€œA-Starâ€ï¼‰ç®—æ³•å› å…¶é«˜æ•ˆæ€§ä¸å‡†ç¡®æ€§ï¼Œæˆä¸ºè§£å†³æ­¤ç±»é—®é¢˜çš„é¦–é€‰æ–¹æ³•ä¹‹ä¸€ã€‚è‡ª1968å¹´ç”±Peter Hartã€Nils Nilsson å’Œ Bertram Raphael æå‡ºä»¥æ¥ï¼ŒA* ç®—æ³•å‡­å€Ÿå…¶å¯å‘å¼æœç´¢æœºåˆ¶ï¼Œåœ¨ä¿è¯æ‰¾åˆ°æœ€çŸ­è·¯å¾„çš„åŒæ—¶æ˜¾è‘—å‡å°‘äº†æœç´¢ç©ºé—´ï¼Œæˆä¸ºè·¯å¾„è§„åˆ’é¢†åŸŸçš„ç»å…¸ç®—æ³•ã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€A* ç®—æ³•çš„åŸºæœ¬æ€æƒ³</h2>
<p>A* æ˜¯ä¸€ç§<strong>å¯å‘å¼å›¾æœç´¢ç®—æ³•</strong>ï¼Œç»“åˆäº†<strong>Dijkstra ç®—æ³•</strong>çš„å®Œå¤‡æ€§å’Œ<strong>è´ªå¿ƒæœ€ä½³ä¼˜å…ˆæœç´¢</strong>çš„æ•ˆç‡ã€‚å…¶æ ¸å¿ƒåœ¨äºé€šè¿‡ä¸€ä¸ªè¯„ä¼°å‡½æ•°å¯¹æ¯ä¸ªå¾…æ¢ç´¢èŠ‚ç‚¹è¿›è¡Œæ‰“åˆ†ï¼Œä»è€Œå†³å®šä¸‹ä¸€æ­¥çš„æœç´¢æ–¹å‘ã€‚</p>
<h3 data-id="heading-2">1. è¯„ä¼°å‡½æ•° f(n)</h3>
<p>å¯¹äºä»»æ„èŠ‚ç‚¹ nï¼ŒA* ä½¿ç”¨å¦‚ä¸‹å…¬å¼è®¡ç®—å…¶ä¼˜å…ˆçº§ï¼š</p>
<p>f(n)=g(n)+h(n)</p>
<ul>
<li><strong>g(n)</strong> ï¼šä»èµ·ç‚¹åˆ°å½“å‰èŠ‚ç‚¹Â nÂ çš„å®é™…ä»£ä»·ï¼ˆå·²çŸ¥ï¼‰ã€‚</li>
<li><strong>h(n)</strong> ï¼šä»å½“å‰èŠ‚ç‚¹Â nÂ åˆ°ç›®æ ‡èŠ‚ç‚¹çš„<strong>å¯å‘å¼ä¼°è®¡ä»£ä»·</strong>ï¼ˆæœªçŸ¥ï¼Œéœ€è®¾è®¡ï¼‰ã€‚</li>
<li><strong>f(n)</strong> ï¼šä»èµ·ç‚¹ç»è¿‡Â nÂ åˆ°è¾¾ç»ˆç‚¹çš„æ€»ä¼°è®¡ä»£ä»·ã€‚</li>
</ul>
<p>A* ç®—æ³•æ€»æ˜¯ä¼˜å…ˆæ‰©å±•å…·æœ‰æœ€å° f(n) å€¼çš„èŠ‚ç‚¹ã€‚</p>
<hr/>
<h2 data-id="heading-3">äºŒã€ç®—æ³•æµç¨‹</h2>
<p>A* ç®—æ³•é€šå¸¸ä½¿ç”¨ä¸¤ä¸ªé›†åˆæ¥ç®¡ç†èŠ‚ç‚¹ï¼š</p>
<ul>
<li><strong>Open Setï¼ˆå¼€æ”¾åˆ—è¡¨ï¼‰</strong> ï¼šå¾…æ¢ç´¢çš„èŠ‚ç‚¹é›†åˆã€‚</li>
<li><strong>Closed Setï¼ˆå…³é—­åˆ—è¡¨ï¼‰</strong> ï¼šå·²æ¢ç´¢è¿‡çš„èŠ‚ç‚¹é›†åˆã€‚</li>
</ul>
<h3 data-id="heading-4">å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</h3>
<ol>
<li>
<p>å°†èµ·ç‚¹åŠ å…¥ Open Setï¼Œå¹¶è®¾ç½®Â g(start)=0ï¼Œf(start)=h(start)ã€‚</p>
</li>
<li>
<p>å½“ Open Set éç©ºæ—¶ï¼š</p>
<ul>
<li>
<p>ä»ä¸­å–å‡ºÂ f(n)Â æœ€å°çš„èŠ‚ç‚¹Â currentã€‚</p>
</li>
<li>
<p>è‹¥Â currentÂ æ˜¯ç›®æ ‡èŠ‚ç‚¹ï¼Œåˆ™é‡å»ºè·¯å¾„å¹¶è¿”å›ã€‚</p>
</li>
<li>
<p>å¦åˆ™ï¼Œå°†Â currentÂ ç§»å…¥ Closed Setã€‚</p>
</li>
<li>
<p>éå†Â currentÂ çš„æ‰€æœ‰é‚»å±…èŠ‚ç‚¹Â neighborï¼š</p>
<ul>
<li>å¦‚æœÂ neighborÂ åœ¨ Closed Set ä¸­ï¼Œè·³è¿‡ã€‚</li>
<li>è®¡ç®—ä»èµ·ç‚¹ç»Â currentÂ åˆ°Â neighborÂ çš„æ–°ä»£ä»·Â tentative_g=g(current)+cost(current,neighbor)ã€‚</li>
<li>å¦‚æœÂ neighborÂ ä¸åœ¨ Open Set ä¸­ï¼Œæˆ–Â tentative_g&lt;g(neighbor)ï¼Œåˆ™æ›´æ–°Â g(neighbor)ã€f(neighbor)ï¼Œå¹¶è®°å½•å‰é©±èŠ‚ç‚¹ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p>è‹¥ Open Set ä¸ºç©ºä»æœªæ‰¾åˆ°ç›®æ ‡ï¼Œåˆ™è·¯å¾„ä¸å­˜åœ¨ã€‚</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€å¯å‘å‡½æ•°Â h(n)Â çš„è®¾è®¡</h2>
<p>å¯å‘å‡½æ•°çš„è´¨é‡ç›´æ¥å½±å“ A* çš„æ•ˆç‡å’Œæ­£ç¡®æ€§ã€‚</p>
<h3 data-id="heading-6">å¸¸è§å¯å‘å‡½æ•°ï¼ˆä»¥äºŒç»´ç½‘æ ¼ä¸ºä¾‹ï¼‰ï¼š</h3>
<ul>
<li>
<p><strong>æ›¼å“ˆé¡¿è·ç¦»ï¼ˆManhattan Distanceï¼‰</strong><br/>
é€‚ç”¨äºåªèƒ½ä¸Šä¸‹å·¦å³ç§»åŠ¨çš„æƒ…å†µï¼š</p>
<p>h(n)=âˆ£xnâ€‹âˆ’xgoalâ€‹âˆ£+âˆ£ynâ€‹âˆ’ygoalâ€‹âˆ£</p>
</li>
<li>
<p><strong>æ¬§å‡ é‡Œå¾—è·ç¦»ï¼ˆEuclidean Distanceï¼‰</strong><br/>
é€‚ç”¨äºå…è®¸ä»»æ„æ–¹å‘ç§»åŠ¨çš„æƒ…å†µï¼š</p>
<p>h(n)=(xnâ€‹âˆ’xgoalâ€‹)2+(ynâ€‹âˆ’ygoalâ€‹)2â€‹</p>
</li>
<li>
<p><strong>åˆ‡æ¯”é›ªå¤«è·ç¦»ï¼ˆChebyshev Distanceï¼‰</strong><br/>
é€‚ç”¨äºå¯æ²¿8ä¸ªæ–¹å‘ç§»åŠ¨ï¼ˆåŒ…æ‹¬å¯¹è§’çº¿ï¼‰ï¼š</p>
<p>h(n)=max(âˆ£xnâ€‹âˆ’xgoalâ€‹âˆ£,âˆ£ynâ€‹âˆ’ygoalâ€‹âˆ£)</p>
</li>
</ul>
<blockquote>
<p><strong>å…³é”®æ€§è´¨ï¼šå¯é‡‡çº³æ€§ï¼ˆAdmissibilityï¼‰</strong><br/>
è‹¥ h(n) å§‹ç»ˆ<strong>ä¸å¤§äº</strong>ä» n åˆ°ç›®æ ‡çš„çœŸå®ä»£ä»·ï¼Œåˆ™ A* ä¿è¯èƒ½æ‰¾åˆ°<strong>æœ€ä¼˜è§£</strong>ã€‚<br/>
<strong>ä¸€è‡´æ€§ï¼ˆConsistencyï¼Œæˆ–å•è°ƒæ€§ï¼‰</strong> èƒ½è¿›ä¸€æ­¥ä¿è¯ç®—æ³•æ•ˆç‡ï¼Œé¿å…é‡å¤æ‰©å±•èŠ‚ç‚¹ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-7">å››ã€ç®—æ³•å…·ä½“å®ç°</h2>
<h3 data-id="heading-8">javaå®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.*;

<span class="hljs-comment">// è¡¨ç¤ºåœ°å›¾ä¸­çš„ä¸€ä¸ªç‚¹ï¼ˆèŠ‚ç‚¹ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparable</span>&lt;Node&gt; {
    <span class="hljs-type">int</span> x, y;
    <span class="hljs-type">double</span> g; <span class="hljs-comment">// ä»èµ·ç‚¹åˆ°å½“å‰èŠ‚ç‚¹çš„å®é™…ä»£ä»·</span>
    <span class="hljs-type">double</span> h; <span class="hljs-comment">// å¯å‘å¼ä¼°è®¡ï¼šå½“å‰èŠ‚ç‚¹åˆ°ç»ˆç‚¹çš„é¢„ä¼°ä»£ä»·</span>
    <span class="hljs-type">double</span> f; <span class="hljs-comment">// f = g + h</span>
    Node parent; <span class="hljs-comment">// ç”¨äºå›æº¯è·¯å¾„</span>

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Node</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span> {
        <span class="hljs-built_in">this</span>.x = x;
        <span class="hljs-built_in">this</span>.y = y;
        <span class="hljs-built_in">this</span>.g = Double.MAX_VALUE;
        <span class="hljs-built_in">this</span>.h = <span class="hljs-number">0</span>;
        <span class="hljs-built_in">this</span>.f = Double.MAX_VALUE;
        <span class="hljs-built_in">this</span>.parent = <span class="hljs-literal">null</span>;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">equals</span><span class="hljs-params">(Object o)</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span> == o) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">if</span> (o == <span class="hljs-literal">null</span> || getClass() != o.getClass()) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> (Node) o;
        <span class="hljs-keyword">return</span> x == node.x &amp;&amp; y == node.y;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hashCode</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> Objects.hash(x, y);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(Node other)</span> {
        <span class="hljs-keyword">return</span> Double.compare(<span class="hljs-built_in">this</span>.f, other.f);
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AStar</span> {

    <span class="hljs-comment">// å››ä¸ªæ–¹å‘ï¼šä¸Šã€ä¸‹ã€å·¦ã€å³ï¼ˆå¯æ‰©å±•ä¸º8æ–¹å‘ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span>[][] DIRS = {{<span class="hljs-number">0</span>, <span class="hljs-number">1</span>}, {<span class="hljs-number">1</span>, <span class="hljs-number">0</span>}, {<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>}, {-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>}};

    <span class="hljs-comment">/**
     * åœ¨ grid ä¸­å¯»æ‰¾ä» start åˆ° end çš„æœ€çŸ­è·¯å¾„
     * <span class="hljs-doctag">@param</span> grid äºŒç»´åœ°å›¾ï¼Œtrue è¡¨ç¤ºå¯é€šè¿‡ï¼Œfalse è¡¨ç¤ºéšœç¢
     * <span class="hljs-doctag">@param</span> startX èµ·ç‚¹ x åæ ‡
     * <span class="hljs-doctag">@param</span> startY èµ·ç‚¹ y åæ ‡
     * <span class="hljs-doctag">@param</span> endX ç»ˆç‚¹ x åæ ‡
     * <span class="hljs-doctag">@param</span> endY ç»ˆç‚¹ y åæ ‡
     * <span class="hljs-doctag">@return</span> è·¯å¾„åˆ—è¡¨ï¼ˆä»èµ·ç‚¹åˆ°ç»ˆç‚¹ï¼‰ï¼Œè‹¥æ— è·¯å¾„åˆ™è¿”å› null
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;Node&gt; <span class="hljs-title function_">findPath</span><span class="hljs-params">(<span class="hljs-type">boolean</span>[][] grid, <span class="hljs-type">int</span> startX, <span class="hljs-type">int</span> startY, <span class="hljs-type">int</span> endX, <span class="hljs-type">int</span> endY)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">rows</span> <span class="hljs-operator">=</span> grid.length;
        <span class="hljs-type">int</span> <span class="hljs-variable">cols</span> <span class="hljs-operator">=</span> grid[<span class="hljs-number">0</span>].length;

        <span class="hljs-keyword">if</span> (!isValid(grid, startX, startY) || !isValid(grid, endX, endY)) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// èµ·ç‚¹æˆ–ç»ˆç‚¹æ— æ•ˆ</span>
        }

        <span class="hljs-type">Node</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(startX, startY);
        <span class="hljs-type">Node</span> <span class="hljs-variable">goal</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(endX, endY);

        <span class="hljs-comment">// å¼€æ”¾åˆ—è¡¨ï¼šä¼˜å…ˆé˜Ÿåˆ—ï¼ˆæŒ‰ f å€¼æ’åºï¼‰</span>
        PriorityQueue&lt;Node&gt; openSet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;();
        <span class="hljs-comment">// å…³é—­åˆ—è¡¨ï¼šå·²è®¿é—®èŠ‚ç‚¹é›†åˆ</span>
        Set&lt;Node&gt; closedSet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();

        start.g = <span class="hljs-number">0</span>;
        start.h = heuristic(start, goal);
        start.f = start.g + start.h;
        openSet.add(start);

        <span class="hljs-keyword">while</span> (!openSet.isEmpty()) {
            <span class="hljs-type">Node</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> openSet.poll();

            <span class="hljs-keyword">if</span> (current.equals(goal)) {
                <span class="hljs-keyword">return</span> reconstructPath(current);
            }

            closedSet.add(current);

            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span>[] dir : DIRS) {
                <span class="hljs-type">int</span> <span class="hljs-variable">nx</span> <span class="hljs-operator">=</span> current.x + dir[<span class="hljs-number">0</span>];
                <span class="hljs-type">int</span> <span class="hljs-variable">ny</span> <span class="hljs-operator">=</span> current.y + dir[<span class="hljs-number">1</span>];

                <span class="hljs-keyword">if</span> (!isValid(grid, nx, ny)) <span class="hljs-keyword">continue</span>;

                <span class="hljs-type">Node</span> <span class="hljs-variable">neighbor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(nx, ny);

                <span class="hljs-keyword">if</span> (closedSet.contains(neighbor)) <span class="hljs-keyword">continue</span>;

                <span class="hljs-comment">// å‡è®¾æ¯æ­¥ç§»åŠ¨ä»£ä»·ä¸º 1ï¼ˆå¯æ”¹ä¸ºæ¬§æ°è·ç¦»ç­‰ï¼‰</span>
                <span class="hljs-type">double</span> <span class="hljs-variable">tentativeG</span> <span class="hljs-operator">=</span> current.g + <span class="hljs-number">1</span>;

                <span class="hljs-comment">// å¦‚æœè¿™æ˜¯åˆ°è¾¾ neighbor çš„æ›´ä¼˜è·¯å¾„</span>
                <span class="hljs-keyword">if</span> (tentativeG &lt; neighbor.g) {
                    <span class="hljs-comment">// æ›´æ–° neighbor ä¿¡æ¯</span>
                    neighbor.g = tentativeG;
                    neighbor.h = heuristic(neighbor, goal);
                    neighbor.f = neighbor.g + neighbor.h;
                    neighbor.parent = current;

                    <span class="hljs-comment">// é¿å…é‡å¤åŠ å…¥ openSetï¼ˆç®€åŒ–å®ç°ï¼šå…è®¸é‡å¤ä½†é  f å€¼æ’åºï¼‰</span>
                    openSet.remove(neighbor); <span class="hljs-comment">// å¯é€‰ï¼šæé«˜æ•ˆç‡ä½†å¢åŠ å¼€é”€</span>
                    openSet.add(neighbor);
                }
            }
        }

        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// æœªæ‰¾åˆ°è·¯å¾„</span>
    }

    <span class="hljs-comment">// æ›¼å“ˆé¡¿è·ç¦»å¯å‘å‡½æ•°ï¼ˆé€‚ç”¨äº4æ–¹å‘ç§»åŠ¨ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">double</span> <span class="hljs-title function_">heuristic</span><span class="hljs-params">(Node a, Node b)</span> {
        <span class="hljs-keyword">return</span> Math.abs(a.x - b.x) + Math.abs(a.y - b.y);
    }

    <span class="hljs-comment">// æ£€æŸ¥åæ ‡æ˜¯å¦åœ¨åœ°å›¾å†…ä¸”å¯é€šè¿‡</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValid</span><span class="hljs-params">(<span class="hljs-type">boolean</span>[][] grid, <span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">rows</span> <span class="hljs-operator">=</span> grid.length;
        <span class="hljs-type">int</span> <span class="hljs-variable">cols</span> <span class="hljs-operator">=</span> grid[<span class="hljs-number">0</span>].length;
        <span class="hljs-keyword">return</span> x &gt;= <span class="hljs-number">0</span> &amp;&amp; x &lt; rows &amp;&amp; y &gt;= <span class="hljs-number">0</span> &amp;&amp; y &lt; cols &amp;&amp; grid[x][y];
    }

    <span class="hljs-comment">// ä»ç»ˆç‚¹å›æº¯åˆ°èµ·ç‚¹ï¼Œæ„å»ºè·¯å¾„</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;Node&gt; <span class="hljs-title function_">reconstructPath</span><span class="hljs-params">(Node node)</span> {
        List&lt;Node&gt; path = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-keyword">while</span> (node != <span class="hljs-literal">null</span>) {
            path.add(node);
            node = node.parent;
        }
        Collections.reverse(path);
        <span class="hljs-keyword">return</span> path;
    }

    <span class="hljs-comment">// ç¤ºä¾‹ç”¨æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">boolean</span>[][] grid = {
            {<span class="hljs-literal">true</span>,  <span class="hljs-literal">true</span>,  <span class="hljs-literal">true</span>,  <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>},
            {<span class="hljs-literal">true</span>,  <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>,  <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>},
            {<span class="hljs-literal">true</span>,  <span class="hljs-literal">true</span>,  <span class="hljs-literal">true</span>,  <span class="hljs-literal">true</span>,  <span class="hljs-literal">true</span>},
            {<span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>,  <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>},
            {<span class="hljs-literal">true</span>,  <span class="hljs-literal">true</span>,  <span class="hljs-literal">true</span>,  <span class="hljs-literal">true</span>,  <span class="hljs-literal">true</span>}
        };

        List&lt;Node&gt; path = findPath(grid, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>);
        <span class="hljs-keyword">if</span> (path != <span class="hljs-literal">null</span>) {
            System.out.println(<span class="hljs-string">"æ‰¾åˆ°è·¯å¾„ï¼Œé•¿åº¦: "</span> + path.size());
            <span class="hljs-keyword">for</span> (Node n : path) {
                System.out.println(<span class="hljs-string">"("</span> + n.x + <span class="hljs-string">", "</span> + n.y + <span class="hljs-string">")"</span>);
            }
        } <span class="hljs-keyword">else</span> {
            System.out.println(<span class="hljs-string">"æœªæ‰¾åˆ°è·¯å¾„"</span>);
        }
    }
}
</code></pre>
<h4 data-id="heading-9">1.Â <strong>æ—¶é—´å¤æ‚åº¦</strong></h4>
<ul>
<li>
<p>æœ€åæƒ…å†µä¸‹ï¼ŒA* ä¼šéå†æ‰€æœ‰å¯è¾¾èŠ‚ç‚¹ï¼Œå…¶è¡Œä¸ºé€€åŒ–ä¸º Dijkstra ç®—æ³•ã€‚</p>
</li>
<li>
<p>è®¾åœ°å›¾ä¸­æœ‰Â NÂ ä¸ªå¯é€šè¿‡çš„æ ¼å­ï¼ˆå³èŠ‚ç‚¹æ•°ï¼‰ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ€å¤šè¢«æ’å…¥ä¼˜å…ˆé˜Ÿåˆ—ä¸€æ¬¡ï¼ˆç†æƒ³æƒ…å†µï¼‰ã€‚</p>
</li>
<li>
<p>æ¯æ¬¡ä»Â <code>PriorityQueue</code>Â ä¸­å–å‡ºæœ€å°å…ƒç´ çš„æ—¶é—´ä¸ºÂ O(logN)ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ€å¤šå¤„ç†ä¸€æ¬¡ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰å¸¸æ•°ä¸ªé‚»å±…ï¼ˆå¦‚4æˆ–8ä¸ªï¼‰ã€‚</p>
</li>
<li>
<p>å› æ­¤ï¼Œ<strong>æ—¶é—´å¤æ‚åº¦ä¸º</strong>ï¼šO(NlogN)</p>
<p>å…¶ä¸­Â NÂ æ˜¯åœ°å›¾ä¸­å¯é€šè¿‡çš„æ ¼å­æ€»æ•°ã€‚</p>
</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼šå¦‚æœå¯å‘å‡½æ•° h(n) è®¾è®¡å¾—å½“ï¼ˆå¦‚æ¥è¿‘çœŸå®ä»£ä»·ï¼‰ï¼Œå®é™…æœç´¢èŠ‚ç‚¹æ•°ä¼šè¿œå°äº Nï¼Œæ€§èƒ½æ˜¾è‘—ä¼˜äº Dijkstraã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-10">2.Â <strong>ç©ºé—´å¤æ‚åº¦</strong></h4>
<ul>
<li>
<p>éœ€è¦å­˜å‚¨ï¼š</p>
<ul>
<li><code>openSet</code>ï¼šæœ€å¤šåŒ…å«Â O(N)Â ä¸ªèŠ‚ç‚¹ã€‚</li>
<li><code>closedSet</code>ï¼šæœ€å¤šåŒ…å«Â O(N)Â ä¸ªèŠ‚ç‚¹ã€‚</li>
<li>æ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨åæ ‡ã€g/h/f å€¼å’Œçˆ¶æŒ‡é’ˆï¼Œç©ºé—´ä¸ºå¸¸æ•°ã€‚</li>
</ul>
</li>
<li>
<p>å› æ­¤ï¼Œ<strong>ç©ºé—´å¤æ‚åº¦ä¸º</strong>ï¼š O(N)</p>
</li>
</ul>
<h4 data-id="heading-11">ä¼˜åŒ–å»ºè®®ï¼ˆè¿›é˜¶ï¼‰</h4>
<ol>
<li><strong>é¿å…é‡å¤èŠ‚ç‚¹</strong>ï¼šå½“å‰å®ç°ä¸­Â <code>openSet</code>Â å¯èƒ½åŒ…å«åŒä¸€åæ ‡çš„å¤šä¸ªÂ <code>Node</code>Â å¯¹è±¡ï¼ˆå› Â <code>new Node</code>Â äº§ç”Ÿæ–°å¯¹è±¡ï¼‰ã€‚å¯é€šè¿‡ç»´æŠ¤ä¸€ä¸ªÂ <code>Map&lt;Point, Node&gt;</code>Â æ¥å¤ç”¨èŠ‚ç‚¹ï¼Œæå‡æ•ˆç‡ã€‚</li>
<li><strong>ä½¿ç”¨æ›´é«˜æ•ˆçš„å¯å‘å‡½æ•°</strong>ï¼šå¦‚å¯¹è§’çº¿ç§»åŠ¨æ—¶æ”¹ç”¨åˆ‡æ¯”é›ªå¤«è·ç¦»ã€‚</li>
<li><strong>æ”¯æŒä¸åŒç§»åŠ¨ä»£ä»·</strong>ï¼šå°†Â <code>tentativeG = current.g + cost</code>Â ä¸­çš„Â <code>cost</code>Â æ”¹ä¸ºåœ°å½¢æƒé‡ã€‚</li>
<li><strong>ä½¿ç”¨ JPSï¼ˆJump Point Searchï¼‰</strong> ï¼šåœ¨å¤§å‹ç©ºæ—·åœ°å›¾ä¸­å¯æé€Ÿæ•°åå€ã€‚</li>
</ol>
<h2 data-id="heading-12">äº”ã€A* çš„ä¼˜ç¼ºç‚¹</h2>
<h3 data-id="heading-13">ä¼˜ç‚¹ï¼š</h3>
<ul>
<li><strong>æœ€ä¼˜æ€§</strong>ï¼šåœ¨å¯é‡‡çº³å¯å‘å‡½æ•°ä¸‹ï¼Œæ€»èƒ½æ‰¾åˆ°æœ€çŸ­è·¯å¾„ã€‚</li>
<li><strong>å®Œå¤‡æ€§</strong>ï¼šåªè¦å­˜åœ¨è§£ï¼ŒA* å°±èƒ½æ‰¾åˆ°ã€‚</li>
<li><strong>çµæ´»æ€§</strong>ï¼šé€šè¿‡è°ƒæ•´Â h(n)ï¼Œå¯åœ¨é€Ÿåº¦ä¸ç²¾åº¦ä¹‹é—´æƒè¡¡ã€‚</li>
</ul>
<h3 data-id="heading-14">ç¼ºç‚¹ï¼š</h3>
<ul>
<li><strong>å†…å­˜æ¶ˆè€—å¤§</strong>ï¼šéœ€å­˜å‚¨å¤§é‡èŠ‚ç‚¹ä¿¡æ¯ï¼Œå°¤å…¶åœ¨å¤§å‹åœ°å›¾ä¸­ã€‚</li>
<li><strong>æœ€åæƒ…å†µå¤æ‚åº¦é«˜</strong>ï¼šè‹¥å¯å‘å‡½æ•°æ•ˆæœå·®ï¼Œé€€åŒ–ä¸º Dijkstra ç®—æ³•ï¼ˆæ—¶é—´å¤æ‚åº¦Â O(bd)ï¼Œå…¶ä¸­Â bÂ ä¸ºåˆ†æ”¯å› å­ï¼ŒdÂ ä¸ºæ·±åº¦ï¼‰ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-15">å…­ã€å®é™…åº”ç”¨ä¸ä¼˜åŒ–</h2>
<h3 data-id="heading-16">åº”ç”¨åœºæ™¯ï¼š</h3>
<ul>
<li>æ¸¸æˆ AI ä¸­çš„ NPC å¯»è·¯ï¼ˆå¦‚ã€Šé­”å…½ä¸–ç•Œã€‹ã€Šæ˜Ÿé™…äº‰éœ¸ã€‹ï¼‰</li>
<li>è‡ªåŠ¨é©¾é©¶è½¦è¾†çš„å±€éƒ¨è·¯å¾„è§„åˆ’</li>
<li>GPS å¯¼èˆªç³»ç»Ÿï¼ˆå¦‚ Google Maps çš„æ—©æœŸç‰ˆæœ¬ï¼‰</li>
<li>æœºå™¨äººé¿éšœä¸ä»»åŠ¡è°ƒåº¦</li>
</ul>
<h3 data-id="heading-17">å¸¸è§ä¼˜åŒ–ç­–ç•¥ï¼š</h3>
<ul>
<li><strong>Jump Point Search (JPS)</strong> ï¼šåœ¨å‡åŒ€ç½‘æ ¼ä¸­å¤§å¹…å‡å°‘éœ€æ¢ç´¢çš„èŠ‚ç‚¹æ•°ã€‚</li>
<li><strong>åŒå‘ A</strong>*ï¼šåŒæ—¶ä»èµ·ç‚¹å’Œç»ˆç‚¹æœç´¢ï¼ŒåŠ é€Ÿæ”¶æ•›ã€‚</li>
<li><strong>å†…å­˜å—é™å˜ä½“</strong>ï¼šå¦‚ IDA*ï¼ˆIterative Deepening A*ï¼‰ï¼Œé€‚ç”¨äºå†…å­˜å—é™ç¯å¢ƒã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-18">ç»“è¯­</h2>
<p>A* ç®—æ³•ä»¥å…¶ä¼˜é›…çš„æ•°å­¦ç»“æ„å’Œå¼ºå¤§çš„å®ç”¨æ€§ï¼Œæˆä¸ºè·¯å¾„è§„åˆ’é¢†åŸŸä¸å¯æ›¿ä»£çš„åŸºçŸ³ã€‚ç†è§£å…¶åŸç†ä¸ä»…æœ‰åŠ©äºè§£å†³å·¥ç¨‹é—®é¢˜ï¼Œæ›´èƒ½å¯å‘æˆ‘ä»¬æ€è€ƒå¦‚ä½•åœ¨â€œå·²çŸ¥â€ä¸â€œé¢„æµ‹â€ä¹‹é—´å–å¾—å¹³è¡¡â€”â€”è¿™æ­£æ˜¯æ™ºèƒ½å†³ç­–çš„æ ¸å¿ƒæ‰€åœ¨ã€‚éšç€ç¡¬ä»¶æ€§èƒ½æå‡ä¸ç®—æ³•èåˆï¼ˆå¦‚ä¸æœºå™¨å­¦ä¹ ç»“åˆï¼‰ï¼ŒA* åŠå…¶è¡ç”Ÿæ–¹æ³•ä»å°†åœ¨æœªæ¥æ™ºèƒ½ç³»ç»Ÿä¸­å‘æŒ¥é‡è¦ä½œç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JWT è®¤è¯æ–¹æ¡ˆæ·±åº¦å¯¹æ¯”ï¼šå• Token æ‰©å±•åˆ·æ–° vs åŒ Token éªŒè¯]]></title>    <link>https://juejin.cn/post/7582857981894869033</link>    <guid>https://juejin.cn/post/7582857981894869033</guid>    <pubDate>2025-12-13T14:44:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582857981894869033" data-draft-id="7582904081863131177" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JWT è®¤è¯æ–¹æ¡ˆæ·±åº¦å¯¹æ¯”ï¼šå• Token æ‰©å±•åˆ·æ–° vs åŒ Token éªŒè¯"/> <meta itemprop="keywords" content="åç«¯,æ¶æ„,è®¾è®¡æ¨¡å¼"/> <meta itemprop="datePublished" content="2025-12-13T14:44:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å–·ç«é¾™8å·"/> <meta itemprop="url" content="https://juejin.cn/user/1900436995711678"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JWT è®¤è¯æ–¹æ¡ˆæ·±åº¦å¯¹æ¯”ï¼šå• Token æ‰©å±•åˆ·æ–° vs åŒ Token éªŒè¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1900436995711678/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å–·ç«é¾™8å·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T14:44:49.000Z" title="Sat Dec 13 2025 14:44:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">JWT è®¤è¯æ–¹æ¡ˆæ·±åº¦å¯¹æ¯”ï¼šå• Token æ‰©å±•åˆ·æ–° vs åŒ Token éªŒè¯</h2>
<blockquote>
<p>æœ¬æ–‡æºäºä¸€æ¬¡ä»£ç  Review è¿‡ç¨‹ä¸­çš„æ·±åº¦è®¨è®ºï¼Œä»ä¸€ä¸ª"ç–‘ä¼¼ Bug"å‡ºå‘ï¼Œé€æ­¥æ·±å…¥æ¢è®¨äº†ä¸¤ç§ JWT è®¤è¯æ–¹æ¡ˆçš„è®¾è®¡ç†å¿µå’Œå®ç°å·®å¼‚ã€‚</p>
</blockquote>
<h3 data-id="heading-1">èƒŒæ™¯</h3>
<p>åœ¨ Review <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhertz-contrib%2Fjwt" target="_blank" title="https://github.com/hertz-contrib/jwt" ref="nofollow noopener noreferrer">hertz-contrib/jwt</a> é¡¹ç›®æ—¶ï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜ï¼šåœ¨ <code>RefreshToken</code> æ–¹æ³•ä¸­ï¼Œæ¯æ¬¡åˆ·æ–°æ—¶éƒ½ä¼šé‡ç½® <code>orig_iat</code> ä¸ºå½“å‰æ—¶é—´ï¼Œè¿™å¯¼è‡´ <code>MaxRefresh</code> çª—å£ä¸æ–­é‡ç½®ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åŸå§‹ä»£ç ï¼ˆæœ‰é—®é¢˜ï¼‰</span>
newClaims[<span class="hljs-string">"exp"</span>] = expire.Unix()
newClaims[<span class="hljs-string">"orig_iat"</span>] = mw.TimeFunc().Unix()  <span class="hljs-comment">// æ¯æ¬¡åˆ·æ–°éƒ½é‡ç½®</span>
</code></pre>
<p>æ ¹æ®ä»£ç æ³¨é‡Šçš„è®¾è®¡æ„å›¾ï¼Œ<code>MaxRefresh</code> åº”è¯¥é™åˆ¶ Token çš„æœ€å¤§æœ‰æ•ˆæœŸï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// This field allows clients to refresh their token until MaxRefresh has passed.</span>
<span class="hljs-comment">// Note that clients can refresh their token in the last moment of MaxRefresh.</span>
<span class="hljs-comment">// This means that the maximum validity timespan for a token is TokenTime + MaxRefresh.</span>
MaxRefresh time.Duration
</code></pre>
<p>ä¿®å¤åçš„ä»£ç åº”è¯¥ä¿ç•™åŸå§‹çš„ <code>orig_iat</code>ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// ä¿®å¤å</span>
newClaims[<span class="hljs-string">"exp"</span>] = expire.Unix()
<span class="hljs-keyword">if</span> origIat, exists := claims[<span class="hljs-string">"orig_iat"</span>]; exists {
    newClaims[<span class="hljs-string">"orig_iat"</span>] = origIat  <span class="hljs-comment">// ä¿ç•™åŸå§‹å€¼</span>
} <span class="hljs-keyword">else</span> {
    newClaims[<span class="hljs-string">"orig_iat"</span>] = mw.TimeFunc().Unix()
}
</code></pre>
<p>è¿™ä¸ªé—®é¢˜å¼•å‘äº†æˆ‘å¯¹å• Token æ‰©å±•åˆ·æ–°è®¾è®¡å’ŒåŒ Token è®¾è®¡çš„æ·±å…¥æ€è€ƒã€‚</p>
<h3 data-id="heading-2">ä¸¤ç§æ–¹æ¡ˆæ¦‚è¿°</h3>
<h4 data-id="heading-3">æ–¹æ¡ˆä¸€ï¼šå• Token æ‰©å±•åˆ·æ–°</h4>
<p>è¿™æ˜¯ hertz-contrib/jwt é‡‡ç”¨çš„æ–¹æ¡ˆï¼Œç‰¹ç‚¹æ˜¯ï¼š</p>
<ul>
<li>åªæœ‰ä¸€ä¸ª Token</li>
<li>Token æœ‰çŸ­æœŸæœ‰æ•ˆæœŸï¼ˆå¦‚ 15 åˆ†é’Ÿæˆ– 1 å°æ—¶ï¼‰</li>
<li>åœ¨ <code>MaxRefresh</code> çª—å£å†…å¯ä»¥åˆ·æ–° Token</li>
<li>åˆ·æ–°æ—¶ä½¿ç”¨åŒä¸€ä¸ª Token ä½œä¸ºå‡­è¯</li>
</ul>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// é…ç½®ç¤ºä¾‹</span>
Timeout: <span class="hljs-number">15</span> * time.Minute,      <span class="hljs-comment">// Token æœ‰æ•ˆæœŸï¼š15åˆ†é’Ÿ</span>
MaxRefresh: <span class="hljs-number">7</span> * <span class="hljs-number">24</span> * time.Hour, <span class="hljs-comment">// åˆ·æ–°çª—å£ï¼š7å¤©</span>
</code></pre>
<h4 data-id="heading-4">æ–¹æ¡ˆäºŒï¼šåŒ Token éªŒè¯</h4>
<p>OAuth 2.0 æ¨èçš„æ ‡å‡†æ–¹æ¡ˆï¼Œç‰¹ç‚¹æ˜¯ï¼š</p>
<ul>
<li>Access Tokenï¼šçŸ­æœŸæœ‰æ•ˆï¼ˆå¦‚ 15 åˆ†é’Ÿï¼‰ï¼Œç”¨äºä¸šåŠ¡è¯·æ±‚</li>
<li>Refresh Tokenï¼šé•¿æœŸæœ‰æ•ˆï¼ˆå¦‚ 7 å¤©ï¼‰ï¼Œä»…ç”¨äºåˆ·æ–° Access Token</li>
<li>ä¸¤ä¸ª Token èŒè´£åˆ†ç¦»</li>
</ul>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// é…ç½®ç¤ºä¾‹</span>
AccessTokenTimeout: <span class="hljs-number">15</span> * time.Minute,
RefreshTokenTimeout: <span class="hljs-number">7</span> * <span class="hljs-number">24</span> * time.Hour,
</code></pre>
<h3 data-id="heading-5">æ ¸å¿ƒåŠŸèƒ½å¯¹æ¯”</h3>
<p>ç»è¿‡æ·±å…¥è®¨è®ºï¼Œæˆ‘ä»¬å‘ç°<strong>ä¸¤ç§æ–¹æ¡ˆéƒ½èƒ½å®ç°ç›¸åŒçš„æ ¸å¿ƒåŠŸèƒ½</strong>ï¼š</p>



































<table><thead><tr><th>åŠŸèƒ½</th><th>å• Token</th><th>åŒ Token</th></tr></thead><tbody><tr><td>ä¸šåŠ¡è¯·æ±‚é›¶ Redis æŸ¥è¯¢</td><td>âœ…</td><td>âœ…</td></tr><tr><td>åˆ·æ–°è¯·æ±‚æŸ¥ Redis</td><td>âœ…</td><td>âœ…</td></tr><tr><td>Token è½®æ¢</td><td>âœ…</td><td>âœ…</td></tr><tr><td>ä¸»åŠ¨æ’¤é”€</td><td>âœ…</td><td>âœ…</td></tr><tr><td>çŸ­æ³„éœ²å½±å“æ—¶é—´</td><td>âœ…ï¼ˆå¯è®¾ç½®15åˆ†é’Ÿï¼‰</td><td>âœ…</td></tr></tbody></table>
<h4 data-id="heading-6">å…³é”®æ´å¯Ÿ</h4>
<ol>
<li>
<p><strong>ä¸šåŠ¡è¯·æ±‚é›¶ Redis æŸ¥è¯¢</strong>ï¼šä¸¤ç§æ–¹æ¡ˆéƒ½å¯ä»¥åœ¨ä¸šåŠ¡è¯·æ±‚ä¸­åªéªŒè¯ JWT ç­¾åï¼Œä¸æŸ¥è¯¢ Redisã€‚Token è¿‡æœŸåè‡ªåŠ¨å¤±æ•ˆï¼Œä¸éœ€è¦é»‘åå•ã€‚</p>
</li>
<li>
<p><strong>Token è½®æ¢</strong>ï¼šå• Token åˆ·æ–°åå°±æ˜¯æ–° Tokenï¼Œå°†æ—§ Token åŠ å…¥é»‘åå•å³å®ç°è½®æ¢ã€‚</p>
</li>
<li>
<p><strong>æ’¤é”€èƒ½åŠ›</strong>ï¼šä¸¤ç§æ–¹æ¡ˆéƒ½éœ€è¦ Redis æ¥å®ç°æ’¤é”€åŠŸèƒ½ï¼Œæ²¡æœ‰æœ¬è´¨åŒºåˆ«ã€‚</p>
</li>
</ol>
<h3 data-id="heading-7">å®Œæ•´ç¤ºä¾‹ä»£ç </h3>
<h4 data-id="heading-8">å• Token æ‰©å±•åˆ·æ–°å®ç°</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"context"</span>
    <span class="hljs-string">"net/http"</span>
    <span class="hljs-string">"time"</span>

    <span class="hljs-string">"github.com/cloudwego/hertz/pkg/app"</span>
    <span class="hljs-string">"github.com/cloudwego/hertz/pkg/app/server"</span>
    <span class="hljs-string">"github.com/go-redis/redis/v8"</span>
    <span class="hljs-string">"github.com/hertz-contrib/jwt"</span>
)

<span class="hljs-keyword">var</span> (
    redisClient *redis.Client
    identityKey = <span class="hljs-string">"identity"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    h := server.Default()

    <span class="hljs-comment">// åˆå§‹åŒ– Redis</span>
    redisClient = redis.NewClient(&amp;redis.Options{
        Addr: <span class="hljs-string">"localhost:6379"</span>,
    })

    <span class="hljs-comment">// JWT ä¸­é—´ä»¶é…ç½®</span>
    authMiddleware, _ := jwt.New(&amp;jwt.HertzJWTMiddleware{
        Realm:            <span class="hljs-string">"single-token-demo"</span>,
        Key:              []<span class="hljs-type">byte</span>(<span class="hljs-string">"secret-key"</span>),
        Timeout:          <span class="hljs-number">15</span> * time.Minute,      <span class="hljs-comment">// Token æœ‰æ•ˆæœŸï¼š15åˆ†é’Ÿ</span>
        MaxRefresh:       <span class="hljs-number">7</span> * <span class="hljs-number">24</span> * time.Hour,    <span class="hljs-comment">// åˆ·æ–°çª—å£ï¼š7å¤©</span>
        IdentityKey:      identityKey,

        <span class="hljs-comment">// è®¤è¯å™¨ï¼šéªŒè¯ç”¨æˆ·åå¯†ç </span>
        Authenticator: <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context, c *app.RequestContext)</span></span> (<span class="hljs-keyword">interface</span>{}, <span class="hljs-type">error</span>) {
            <span class="hljs-keyword">var</span> loginVals <span class="hljs-keyword">struct</span> {
                Username <span class="hljs-type">string</span> <span class="hljs-string">`json:"username"`</span>
                Password <span class="hljs-type">string</span> <span class="hljs-string">`json:"password"`</span>
            }
            <span class="hljs-keyword">if</span> err := c.BindAndValidate(&amp;loginVals); err != <span class="hljs-literal">nil</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, jwt.ErrMissingLoginValues
            }
            <span class="hljs-keyword">if</span> loginVals.Username == <span class="hljs-string">"admin"</span> &amp;&amp; loginVals.Password == <span class="hljs-string">"admin"</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
                    <span class="hljs-string">"user_id"</span>:  <span class="hljs-string">"123"</span>,
                    <span class="hljs-string">"username"</span>: loginVals.Username,
                }, <span class="hljs-literal">nil</span>
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, jwt.ErrFailedAuthentication
        },

        <span class="hljs-comment">// Payloadï¼šè®¾ç½® Token ä¸­çš„æ•°æ®</span>
        PayloadFunc: <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(data <span class="hljs-keyword">interface</span>{})</span></span> jwt.MapClaims {
            <span class="hljs-keyword">if</span> v, ok := data.(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}); ok {
                <span class="hljs-keyword">return</span> jwt.MapClaims{
                    identityKey: v[<span class="hljs-string">"user_id"</span>],
                    <span class="hljs-string">"username"</span>:  v[<span class="hljs-string">"username"</span>],
                }
            }
            <span class="hljs-keyword">return</span> jwt.MapClaims{}
        },

        <span class="hljs-comment">// èº«ä»½å¤„ç†å™¨</span>
        IdentityHandler: <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context, c *app.RequestContext)</span></span> <span class="hljs-keyword">interface</span>{} {
            claims := jwt.ExtractClaims(ctx, c)
            <span class="hljs-keyword">return</span> claims[identityKey]
        },

        <span class="hljs-comment">// æˆæƒå™¨</span>
        Authorizator: <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(data <span class="hljs-keyword">interface</span>{}, ctx context.Context, c *app.RequestContext)</span></span> <span class="hljs-type">bool</span> {
            <span class="hljs-keyword">return</span> data != <span class="hljs-literal">nil</span>
        },

        <span class="hljs-comment">// æœªæˆæƒå“åº”</span>
        Unauthorized: <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context, c *app.RequestContext, code <span class="hljs-type">int</span>, message <span class="hljs-type">string</span>)</span></span> {
            c.JSON(code, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
                <span class="hljs-string">"code"</span>:    code,
                <span class="hljs-string">"message"</span>: message,
            })
        },
    })

    <span class="hljs-comment">// è·¯ç”±é…ç½®</span>
    h.POST(<span class="hljs-string">"/login"</span>, authMiddleware.LoginHandler)
    h.POST(<span class="hljs-string">"/logout"</span>, LogoutHandler(authMiddleware))

    auth := h.Group(<span class="hljs-string">"/auth"</span>)
    auth.GET(<span class="hljs-string">"/refresh"</span>, RefreshHandler(authMiddleware))
    auth.Use(authMiddleware.MiddlewareFunc())
    {
        auth.GET(<span class="hljs-string">"/profile"</span>, ProfileHandler)
    }

    h.Spin()
}

<span class="hljs-comment">// ä¸šåŠ¡æ¥å£ï¼šé›¶ Redis æŸ¥è¯¢</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ProfileHandler</span><span class="hljs-params">(ctx context.Context, c *app.RequestContext)</span></span> {
    <span class="hljs-comment">// åªéªŒè¯ JWTï¼Œä¸æŸ¥è¯¢ Redis</span>
    claims := jwt.ExtractClaims(ctx, c)
    c.JSON(http.StatusOK, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
        <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
        <span class="hljs-string">"data"</span>: <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
            <span class="hljs-string">"user_id"</span>:  claims[<span class="hljs-string">"identity"</span>],
            <span class="hljs-string">"username"</span>: claims[<span class="hljs-string">"username"</span>],
        },
    })
}

<span class="hljs-comment">// åˆ·æ–°æ¥å£ï¼šæŸ¥ Redis é»‘åå• + è½®æ¢</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">RefreshHandler</span><span class="hljs-params">(authMiddleware *jwt.HertzJWTMiddleware)</span></span> app.HandlerFunc {
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context, c *app.RequestContext)</span></span> {
        <span class="hljs-comment">// è·å–å½“å‰ Token</span>
        oldToken := jwt.GetToken(ctx, c)

        <span class="hljs-comment">// æ£€æŸ¥é»‘åå•ï¼ˆè½®æ¢æ£€æŸ¥ï¼‰</span>
        <span class="hljs-keyword">if</span> exists, _ := redisClient.Exists(ctx, <span class="hljs-string">"blacklist:"</span>+oldToken).Result(); exists &gt; <span class="hljs-number">0</span> {
            c.JSON(http.StatusUnauthorized, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
                <span class="hljs-string">"code"</span>:    <span class="hljs-number">401</span>,
                <span class="hljs-string">"message"</span>: <span class="hljs-string">"token has been revoked"</span>,
            })
            <span class="hljs-keyword">return</span>
        }

        <span class="hljs-comment">// è°ƒç”¨åŸå§‹åˆ·æ–°é€»è¾‘</span>
        tokenString, expire, err := authMiddleware.RefreshToken(ctx, c)
        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
            c.JSON(http.StatusUnauthorized, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
                <span class="hljs-string">"code"</span>:    <span class="hljs-number">401</span>,
                <span class="hljs-string">"message"</span>: err.Error(),
            })
            <span class="hljs-keyword">return</span>
        }

        <span class="hljs-comment">// å°†æ—§ Token åŠ å…¥é»‘åå•ï¼ˆè½®æ¢ï¼‰</span>
        redisClient.Set(ctx, <span class="hljs-string">"blacklist:"</span>+oldToken, <span class="hljs-string">"revoked"</span>, <span class="hljs-number">7</span>*<span class="hljs-number">24</span>*time.Hour)

        c.JSON(http.StatusOK, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
            <span class="hljs-string">"code"</span>:   <span class="hljs-number">200</span>,
            <span class="hljs-string">"token"</span>:  tokenString,
            <span class="hljs-string">"expire"</span>: expire.Format(time.RFC3339),
        })
    }
}

<span class="hljs-comment">// ç™»å‡ºæ¥å£ï¼šå°† Token åŠ å…¥é»‘åå•</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">LogoutHandler</span><span class="hljs-params">(authMiddleware *jwt.HertzJWTMiddleware)</span></span> app.HandlerFunc {
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context, c *app.RequestContext)</span></span> {
        token := jwt.GetToken(ctx, c)

        <span class="hljs-comment">// å°† Token åŠ å…¥é»‘åå•</span>
        redisClient.Set(ctx, <span class="hljs-string">"blacklist:"</span>+token, <span class="hljs-string">"revoked"</span>, <span class="hljs-number">7</span>*<span class="hljs-number">24</span>*time.Hour)

        <span class="hljs-comment">// è°ƒç”¨åŸå§‹ç™»å‡ºé€»è¾‘</span>
        authMiddleware.LogoutHandler(ctx, c)
    }
}
</code></pre>
<h4 data-id="heading-9">åŒ Token éªŒè¯å®ç°</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"context"</span>
    <span class="hljs-string">"net/http"</span>
    <span class="hljs-string">"time"</span>

    <span class="hljs-string">"github.com/cloudwego/hertz/pkg/app"</span>
    <span class="hljs-string">"github.com/cloudwego/hertz/pkg/app/server"</span>
    <span class="hljs-string">"github.com/go-redis/redis/v8"</span>
    <span class="hljs-string">"github.com/golang-jwt/jwt/v4"</span>
)

<span class="hljs-keyword">var</span> (
    redisClient         *redis.Client
    accessTokenSecret   = []<span class="hljs-type">byte</span>(<span class="hljs-string">"access-secret"</span>)
    refreshTokenSecret  = []<span class="hljs-type">byte</span>(<span class="hljs-string">"refresh-secret"</span>)
    accessTokenTimeout  = <span class="hljs-number">15</span> * time.Minute
    refreshTokenTimeout = <span class="hljs-number">7</span> * <span class="hljs-number">24</span> * time.Hour
)

<span class="hljs-keyword">type</span> Claims <span class="hljs-keyword">struct</span> {
    UserID   <span class="hljs-type">string</span> <span class="hljs-string">`json:"user_id"`</span>
    Username <span class="hljs-type">string</span> <span class="hljs-string">`json:"username"`</span>
    jwt.RegisteredClaims
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    h := server.Default()

    <span class="hljs-comment">// åˆå§‹åŒ– Redis</span>
    redisClient = redis.NewClient(&amp;redis.Options{
        Addr: <span class="hljs-string">"localhost:6379"</span>,
    })

    <span class="hljs-comment">// è·¯ç”±é…ç½®</span>
    h.POST(<span class="hljs-string">"/login"</span>, LoginHandler)
    h.POST(<span class="hljs-string">"/logout"</span>, LogoutHandler)
    h.POST(<span class="hljs-string">"/refresh"</span>, RefreshHandler)

    auth := h.Group(<span class="hljs-string">"/auth"</span>)
    auth.Use(AuthMiddleware())
    {
        auth.GET(<span class="hljs-string">"/profile"</span>, ProfileHandler)
    }

    h.Spin()
}

<span class="hljs-comment">// ç™»å½•æ¥å£ï¼šè¿”å› Access Token + Refresh Token</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">LoginHandler</span><span class="hljs-params">(ctx context.Context, c *app.RequestContext)</span></span> {
    <span class="hljs-keyword">var</span> loginVals <span class="hljs-keyword">struct</span> {
        Username <span class="hljs-type">string</span> <span class="hljs-string">`json:"username"`</span>
        Password <span class="hljs-type">string</span> <span class="hljs-string">`json:"password"`</span>
    }
    <span class="hljs-keyword">if</span> err := c.BindAndValidate(&amp;loginVals); err != <span class="hljs-literal">nil</span> {
        c.JSON(http.StatusBadRequest, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
            <span class="hljs-string">"code"</span>:    <span class="hljs-number">400</span>,
            <span class="hljs-string">"message"</span>: <span class="hljs-string">"invalid request"</span>,
        })
        <span class="hljs-keyword">return</span>
    }

    <span class="hljs-keyword">if</span> loginVals.Username != <span class="hljs-string">"admin"</span> || loginVals.Password != <span class="hljs-string">"admin"</span> {
        c.JSON(http.StatusUnauthorized, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
            <span class="hljs-string">"code"</span>:    <span class="hljs-number">401</span>,
            <span class="hljs-string">"message"</span>: <span class="hljs-string">"invalid credentials"</span>,
        })
        <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// ç”Ÿæˆ Access Token</span>
    accessToken, _ := generateAccessToken(loginVals.Username, <span class="hljs-string">"123"</span>)

    <span class="hljs-comment">// ç”Ÿæˆ Refresh Token</span>
    refreshToken, _ := generateRefreshToken(loginVals.Username, <span class="hljs-string">"123"</span>)

    c.JSON(http.StatusOK, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
        <span class="hljs-string">"code"</span>:          <span class="hljs-number">200</span>,
        <span class="hljs-string">"access_token"</span>:  accessToken,
        <span class="hljs-string">"refresh_token"</span>: refreshToken,
        <span class="hljs-string">"expires_in"</span>:    <span class="hljs-type">int</span>(accessTokenTimeout.Seconds()),
    })
}

<span class="hljs-comment">// ä¸šåŠ¡ä¸­é—´ä»¶ï¼šåªéªŒè¯ Access Tokenï¼Œä¸æŸ¥ Redis</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">AuthMiddleware</span><span class="hljs-params">()</span></span> app.HandlerFunc {
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context, c *app.RequestContext)</span></span> {
        tokenString := c.GetHeader(<span class="hljs-string">"Authorization"</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(tokenString) &lt; <span class="hljs-number">7</span> || <span class="hljs-type">string</span>(tokenString[:<span class="hljs-number">7</span>]) != <span class="hljs-string">"Bearer "</span> {
            c.JSON(http.StatusUnauthorized, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
                <span class="hljs-string">"code"</span>:    <span class="hljs-number">401</span>,
                <span class="hljs-string">"message"</span>: <span class="hljs-string">"missing token"</span>,
            })
            c.Abort()
            <span class="hljs-keyword">return</span>
        }

        <span class="hljs-comment">// åªéªŒè¯ JWT ç­¾åå’Œè¿‡æœŸæ—¶é—´ï¼Œä¸æŸ¥ Redis</span>
        token, err := jwt.ParseWithClaims(<span class="hljs-type">string</span>(tokenString[<span class="hljs-number">7</span>:]), &amp;Claims{}, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(token *jwt.Token)</span></span> (<span class="hljs-keyword">interface</span>{}, <span class="hljs-type">error</span>) {
            <span class="hljs-keyword">return</span> accessTokenSecret, <span class="hljs-literal">nil</span>
        })

        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> || !token.Valid {
            c.JSON(http.StatusUnauthorized, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
                <span class="hljs-string">"code"</span>:    <span class="hljs-number">401</span>,
                <span class="hljs-string">"message"</span>: <span class="hljs-string">"invalid token"</span>,
            })
            c.Abort()
            <span class="hljs-keyword">return</span>
        }

        claims := token.Claims.(*Claims)
        c.Set(<span class="hljs-string">"user_id"</span>, claims.UserID)
        c.Set(<span class="hljs-string">"username"</span>, claims.Username)
        c.Next(ctx)
    }
}

<span class="hljs-comment">// ä¸šåŠ¡æ¥å£ï¼šé›¶ Redis æŸ¥è¯¢</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ProfileHandler</span><span class="hljs-params">(ctx context.Context, c *app.RequestContext)</span></span> {
    c.JSON(http.StatusOK, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
        <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
        <span class="hljs-string">"data"</span>: <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
            <span class="hljs-string">"user_id"</span>:  c.GetString(<span class="hljs-string">"user_id"</span>),
            <span class="hljs-string">"username"</span>: c.GetString(<span class="hljs-string">"username"</span>),
        },
    })
}

<span class="hljs-comment">// åˆ·æ–°æ¥å£ï¼šéªŒè¯ Refresh Tokenï¼ŒæŸ¥ Redis æ£€æŸ¥æ’¤é”€çŠ¶æ€</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">RefreshHandler</span><span class="hljs-params">(ctx context.Context, c *app.RequestContext)</span></span> {
    <span class="hljs-keyword">var</span> req <span class="hljs-keyword">struct</span> {
        RefreshToken <span class="hljs-type">string</span> <span class="hljs-string">`json:"refresh_token"`</span>
    }
    <span class="hljs-keyword">if</span> err := c.BindAndValidate(&amp;req); err != <span class="hljs-literal">nil</span> {
        c.JSON(http.StatusBadRequest, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
            <span class="hljs-string">"code"</span>:    <span class="hljs-number">400</span>,
            <span class="hljs-string">"message"</span>: <span class="hljs-string">"invalid request"</span>,
        })
        <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// è§£æ Refresh Token</span>
    token, err := jwt.ParseWithClaims(req.RefreshToken, &amp;Claims{}, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(token *jwt.Token)</span></span> (<span class="hljs-keyword">interface</span>{}, <span class="hljs-type">error</span>) {
        <span class="hljs-keyword">return</span> refreshTokenSecret, <span class="hljs-literal">nil</span>
    })
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> || !token.Valid {
        c.JSON(http.StatusUnauthorized, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
            <span class="hljs-string">"code"</span>:    <span class="hljs-number">401</span>,
            <span class="hljs-string">"message"</span>: <span class="hljs-string">"invalid refresh token"</span>,
        })
        <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// æ£€æŸ¥ Refresh Token æ˜¯å¦è¢«æ’¤é”€ï¼ˆæŸ¥ Redisï¼‰</span>
    <span class="hljs-keyword">if</span> exists, _ := redisClient.Exists(ctx, <span class="hljs-string">"revoked:"</span>+req.RefreshToken).Result(); exists &gt; <span class="hljs-number">0</span> {
        c.JSON(http.StatusUnauthorized, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
            <span class="hljs-string">"code"</span>:    <span class="hljs-number">401</span>,
            <span class="hljs-string">"message"</span>: <span class="hljs-string">"refresh token has been revoked"</span>,
        })
        <span class="hljs-keyword">return</span>
    }

    claims := token.Claims.(*Claims)

    <span class="hljs-comment">// æ’¤é”€æ—§çš„ Refresh Tokenï¼ˆè½®æ¢ï¼‰</span>
    redisClient.Set(ctx, <span class="hljs-string">"revoked:"</span>+req.RefreshToken, <span class="hljs-string">"revoked"</span>, refreshTokenTimeout)

    <span class="hljs-comment">// ç”Ÿæˆæ–°çš„ Access Token</span>
    newAccessToken, _ := generateAccessToken(claims.Username, claims.UserID)

    <span class="hljs-comment">// ç”Ÿæˆæ–°çš„ Refresh Tokenï¼ˆè½®æ¢ï¼‰</span>
    newRefreshToken, _ := generateRefreshToken(claims.Username, claims.UserID)

    c.JSON(http.StatusOK, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
        <span class="hljs-string">"code"</span>:          <span class="hljs-number">200</span>,
        <span class="hljs-string">"access_token"</span>:  newAccessToken,
        <span class="hljs-string">"refresh_token"</span>: newRefreshToken,
        <span class="hljs-string">"expires_in"</span>:    <span class="hljs-type">int</span>(accessTokenTimeout.Seconds()),
    })
}

<span class="hljs-comment">// ç™»å‡ºæ¥å£ï¼šæ’¤é”€ Refresh Token</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">LogoutHandler</span><span class="hljs-params">(ctx context.Context, c *app.RequestContext)</span></span> {
    <span class="hljs-keyword">var</span> req <span class="hljs-keyword">struct</span> {
        RefreshToken <span class="hljs-type">string</span> <span class="hljs-string">`json:"refresh_token"`</span>
    }
    <span class="hljs-keyword">if</span> err := c.BindAndValidate(&amp;req); err != <span class="hljs-literal">nil</span> {
        c.JSON(http.StatusBadRequest, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
            <span class="hljs-string">"code"</span>:    <span class="hljs-number">400</span>,
            <span class="hljs-string">"message"</span>: <span class="hljs-string">"invalid request"</span>,
        })
        <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// æ’¤é”€ Refresh Token</span>
    redisClient.Set(ctx, <span class="hljs-string">"revoked:"</span>+req.RefreshToken, <span class="hljs-string">"revoked"</span>, refreshTokenTimeout)

    c.JSON(http.StatusOK, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
        <span class="hljs-string">"code"</span>:    <span class="hljs-number">200</span>,
        <span class="hljs-string">"message"</span>: <span class="hljs-string">"logged out"</span>,
    })
}

<span class="hljs-comment">// ç”Ÿæˆ Access Token</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">generateAccessToken</span><span class="hljs-params">(username, userID <span class="hljs-type">string</span>)</span></span> (<span class="hljs-type">string</span>, <span class="hljs-type">error</span>) {
    claims := Claims{
        UserID:   userID,
        Username: username,
        RegisteredClaims: jwt.RegisteredClaims{
            ExpiresAt: jwt.NewNumericDate(time.Now().Add(accessTokenTimeout)),
            IssuedAt:  jwt.NewNumericDate(time.Now()),
        },
    }
    token := jwt.NewWithClaims(jwt.SigningMethodHS256, claims)
    <span class="hljs-keyword">return</span> token.SignedString(accessTokenSecret)
}

<span class="hljs-comment">// ç”Ÿæˆ Refresh Token</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">generateRefreshToken</span><span class="hljs-params">(username, userID <span class="hljs-type">string</span>)</span></span> (<span class="hljs-type">string</span>, <span class="hljs-type">error</span>) {
    claims := Claims{
        UserID:   userID,
        Username: username,
        RegisteredClaims: jwt.RegisteredClaims{
            ExpiresAt: jwt.NewNumericDate(time.Now().Add(refreshTokenTimeout)),
            IssuedAt:  jwt.NewNumericDate(time.Now()),
        },
    }
    token := jwt.NewWithClaims(jwt.SigningMethodHS256, claims)
    <span class="hljs-keyword">return</span> token.SignedString(refreshTokenSecret)
}
</code></pre>
<h3 data-id="heading-10">æ–¹æ¡ˆå¯¹æ¯”æ€»ç»“</h3>
<h4 data-id="heading-11">å• Token æ‰©å±•åˆ·æ–°</h4>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>å®ç°ç®€å•ï¼Œåªéœ€ç®¡ç†ä¸€ä¸ª Token</li>
<li>å®¢æˆ·ç«¯é€»è¾‘ç®€å•ï¼Œåªéœ€å­˜å‚¨ä¸€ä¸ª Token</li>
<li>å¯ä»¥å®ç°æ‰€æœ‰åŒ Token çš„åŠŸèƒ½</li>
<li>å‘åå…¼å®¹æ€§å¥½</li>
</ul>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>æ¦‚å¿µä¸å¦‚åŒ Token æ¸…æ™°</li>
<li>ä¸ç¬¦åˆ OAuth 2.0 æ ‡å‡†</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>ä¸­å°å‹åº”ç”¨</li>
<li>å¿«é€Ÿå¼€å‘</li>
<li>è¿½æ±‚ç®€å•å®ç°</li>
<li>ç§»åŠ¨ç«¯åº”ç”¨</li>
</ul>
<h4 data-id="heading-12">åŒ Token éªŒè¯</h4>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>èŒè´£åˆ†ç¦»ï¼Œæ¦‚å¿µæ¸…æ™°</li>
<li>ç¬¦åˆ OAuth 2.0 æ ‡å‡†</li>
<li>ä¸šç•Œå¹¿æ³›é‡‡ç”¨</li>
</ul>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>å®ç°å¤æ‚ï¼Œéœ€è¦ç®¡ç†ä¸¤ä¸ª Token</li>
<li>å®¢æˆ·ç«¯éœ€è¦å¤„ç†ä¸¤ä¸ª Token çš„ç”Ÿå‘½å‘¨æœŸ</li>
<li>éœ€è¦å¤„ç†ä¸¤ä¸ª Token çš„å­˜å‚¨å’ŒåŒæ­¥</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>éœ€è¦ç¬¦åˆ OAuth 2.0 æ ‡å‡†</li>
<li>å¤§å‹ä¼ä¸šåº”ç”¨</li>
<li>å¤šç³»ç»Ÿé›†æˆ</li>
</ul>
<h3 data-id="heading-13">å…³é”®ç»“è®º</h3>
<ol>
<li>
<p><strong>åŠŸèƒ½ç­‰ä»·</strong>ï¼šå• Token æ‰©å±•åˆ·æ–°è®¾è®¡å¯ä»¥å®ç°åŒ Token çš„æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ï¼ŒåŒ…æ‹¬é›¶ Redis æŸ¥è¯¢ã€Token è½®æ¢ã€ä¸»åŠ¨æ’¤é”€ç­‰ã€‚</p>
</li>
<li>
<p><strong>ä¸»è¦åŒºåˆ«åœ¨äº</strong>ï¼š</p>
<ul>
<li>å®ç°å¤æ‚åº¦ï¼šå• Token æ›´ç®€å•</li>
<li>æ¦‚å¿µæ¸…æ™°åº¦ï¼šåŒ Token æ›´æ¸…æ™°</li>
<li>æ ‡å‡†åˆè§„æ€§ï¼šåŒ Token ç¬¦åˆ OAuth 2.0</li>
</ul>
</li>
<li>
<p><strong>é€‰æ‹©å»ºè®®</strong>ï¼š</p>
<ul>
<li>å¦‚æœè¿½æ±‚ç®€å•å’Œæ•ˆç‡ï¼šé€‰æ‹©å• Token æ‰©å±•åˆ·æ–°</li>
<li>å¦‚æœéœ€è¦ç¬¦åˆæ ‡å‡†æˆ–å¤šç³»ç»Ÿé›†æˆï¼šé€‰æ‹©åŒ Token</li>
</ul>
</li>
<li>
<p><strong>å• Token æ‰©å±•åˆ·æ–°æ˜¯ä¸€ä¸ªå·§å¦™çš„è®¾è®¡</strong>ï¼šå®ƒé€šè¿‡ <code>orig_iat</code> å’Œ <code>MaxRefresh</code> çš„ç»„åˆï¼Œå®ç°äº†ä¸åŒ Token ç›¸åŒçš„åŠŸèƒ½ï¼Œä½†å®ç°æ›´ç®€å•ã€‚</p>
</li>
</ol>
<h3 data-id="heading-14">ç›¸å…³èµ„æº</h3>
<ul>
<li>é¡¹ç›®åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhertz-contrib%2Fjwt" target="_blank" title="https://github.com/hertz-contrib/jwt" ref="nofollow noopener noreferrer">hertz-contrib/jwt</a></li>
<li>Bug ä¿®å¤ PRï¼šä¿ç•™åŸå§‹ <code>orig_iat</code> å€¼ä»¥ç»´æŠ¤ MaxRefresh çª—å£</li>
<li>Hertz æ¡†æ¶ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fcloudwego%2Fhertz" target="_blank" title="https://github.com/cloudwego/hertz" ref="nofollow noopener noreferrer">cloudwego/hertz</a></li>
</ul>
<hr/>
<blockquote>
<p>æœ¬æ–‡è®¨è®ºçš„æ ¸å¿ƒè§‚ç‚¹ï¼šä¸è¦ç›²ç›®è¿½éš"ä¸šç•Œæœ€ä½³å®è·µ"ï¼Œè€Œåº”è¯¥æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ–¹æ¡ˆã€‚å• Token æ‰©å±•åˆ·æ–°è®¾è®¡åœ¨å¤§å¤šæ•°åœºæ™¯ä¸‹æ˜¯è¶³å¤Ÿçš„ï¼Œä¸”å®ç°æ›´ç®€å•ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Prismaã€‘NestJS é›†æˆä¸æ ¸å¿ƒé“¾è·¯è§£æ]]></title>    <link>https://juejin.cn/post/7582879379442204715</link>    <guid>https://juejin.cn/post/7582879379442204715</guid>    <pubDate>2025-12-13T15:06:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582879379442204715" data-draft-id="7583139562735730731" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Prismaã€‘NestJS é›†æˆä¸æ ¸å¿ƒé“¾è·¯è§£æ"/> <meta itemprop="keywords" content="åç«¯,æ•°æ®åº“"/> <meta itemprop="datePublished" content="2025-12-13T15:06:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ›¾å¯Œè´µ"/> <meta itemprop="url" content="https://juejin.cn/user/4212984286289806"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Prismaã€‘NestJS é›†æˆä¸æ ¸å¿ƒé“¾è·¯è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4212984286289806/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ›¾å¯Œè´µ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T15:06:51.000Z" title="Sat Dec 13 2025 15:06:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="androidstudio">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#a9b7c6;background:#282b2e}.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#6897bb}.hljs-deletion,.hljs-keyword,.hljs-selector-tag{color:#cc7832}.hljs-link,.hljs-template-variable,.hljs-variable{color:#629755}.hljs-comment,.hljs-quote{color:grey}.hljs-meta{color:#bbb529}.hljs-addition,.hljs-attribute,.hljs-string{color:#6a8759}.hljs-section,.hljs-title,.hljs-type{color:#ffc66d}.hljs-name,.hljs-selector-class,.hljs-selector-id{color:#e8bf6a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ Prisma æ ¸å¿ƒæ¦‚å¿µ</h2>
<h3 data-id="heading-1">1.1 Prisma æ˜¯ä»€ä¹ˆ</h3>
<p>Prisma æ˜¯ä¸‹ä¸€ä»£ Node.js å’Œ TypeScript ORMã€‚ä¸ä¼ ç»Ÿçš„ ORMï¼ˆå¦‚ TypeORMï¼‰ä¸åŒï¼ŒPrisma ä¸ä½¿ç”¨ç±»ï¼ˆClassesï¼‰æ¥æ˜ å°„æ•°æ®åº“è¡¨ï¼Œè€Œæ˜¯ä½¿ç”¨è‡ªå®šä¹‰çš„ Schema è¯­è¨€æ¥å®šä¹‰æ¨¡å‹ï¼Œå¹¶ç”Ÿæˆ <strong>ç±»å‹å®‰å…¨ï¼ˆType-safeï¼‰</strong> çš„æŸ¥è¯¢æ„å»ºå™¨ï¼ˆClientï¼‰ã€‚</p>
<h3 data-id="heading-2">1.2 æ ¸å¿ƒç»„ä»¶</h3>
<p>Prisma ç”Ÿæ€ç³»ç»Ÿç”±ä¸‰ä¸ªä¸»è¦å·¥å…·ç»„æˆï¼š</p>
<ol>
<li><strong>Prisma Client</strong>: åŸºäºä½ çš„ Schema è‡ªåŠ¨ç”Ÿæˆçš„ç±»å‹å®‰å…¨æŸ¥è¯¢æ„å»ºå™¨ï¼Œä¾› Node.js å’Œ TypeScript è°ƒç”¨ã€‚</li>
<li><strong>Prisma Migrate</strong>: å£°æ˜å¼çš„æ•°æ®å»ºæ¨¡ä¸è¿ç§»ç³»ç»Ÿã€‚</li>
<li><strong>Prisma Studio</strong>: ç°ä»£åŒ–çš„æ•°æ®åº“ GUIï¼Œç”¨äºæµè§ˆå’Œç®¡ç†æ•°æ®ï¼ˆç±»ä¼¼ DBeaver/Navicat çš„ Web ç²¾ç®€ç‰ˆï¼‰ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-3">äºŒã€ NestJS é›†æˆä¸åˆå§‹åŒ–</h2>
<h3 data-id="heading-4">2.1 é¡¹ç›®åˆå§‹åŒ–</h3>
<p>åœ¨ç°æœ‰çš„ NestJS é¡¹ç›®ä¸­å®‰è£… Prisma CLI å’Œ Clientï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£… CLI (å¼€å‘ä¾èµ–)</span>
pnpm add -D prisma

<span class="hljs-comment"># å®‰è£… Client (è¿è¡Œæ—¶ä¾èµ–)</span>
pnpm add @prisma/client

<span class="hljs-comment"># åˆå§‹åŒ– (ç”Ÿæˆ prisma æ–‡ä»¶å¤¹å’Œ .env, prisma.config.ts)</span>
npx prisma init

<span class="hljs-comment"># å®‰è£… dotenv ç”¨äºåŠ è½½ç¯å¢ƒå˜é‡</span>
pnpm add -D dotenv
</code></pre>
<h3 data-id="heading-5">2.2 æ ¸å¿ƒæ–‡ä»¶è¯¦è§£</h3>
<p>Prisma 7 å¼•å…¥äº† <strong>é…ç½®å³ä»£ç </strong> çš„ç†å¿µï¼Œæ ¸å¿ƒé…ç½®åˆ†æ•£åœ¨ä»¥ä¸‹æ–‡ä»¶ä¸­ï¼š</p>
<ul>
<li><strong><code>prisma.config.ts</code></strong>ï¼šPrisma çš„ä¸»é…ç½®æ–‡ä»¶ï¼Œè´Ÿè´£æŒ‡å®š Schema æ–‡ä»¶ä½ç½®ã€é…ç½®è¿ç§»æ–‡ä»¶ç”Ÿæˆè·¯å¾„ä»¥åŠé…ç½®æ•°æ®æºè¿æ¥ã€‚</li>
<li><strong><code>prisma/schema.prisma</code></strong>ï¼šæŒ‡å®šæ•°æ®æºç±»å‹ï¼ˆProviderï¼‰ã€ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰å’Œå®šä¹‰æ•°æ®æ¨¡å‹ï¼ˆModelsï¼‰ã€‚</li>
<li><strong><code>.env</code></strong>ï¼šå­˜å‚¨ç¯å¢ƒå˜é‡ï¼ˆå¦‚ <code>DATABASE_URL</code>ï¼‰ã€‚Prisma CLI é»˜è®¤åªè¯»å–æ­¤æ–‡ä»¶ï¼Œä½†å¯ä»¥é€šè¿‡ç³»ç»Ÿç¯å¢ƒå˜é‡è¦†ç›–ï¼Œæˆ–åœ¨ <code>prisma.config.ts</code> ä¸­è‡ªå®šä¹‰åŠ è½½é€»è¾‘ã€‚</li>
</ul>
<p><strong>1. prisma.config.ts ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> <span class="hljs-string">'dotenv/config'</span>;
<span class="hljs-keyword">import</span> { defineConfig, env } <span class="hljs-keyword">from</span> <span class="hljs-string">'prisma/config'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-comment">// 1. æŒ‡å®š schema æ–‡ä»¶ä½ç½®</span>
  <span class="hljs-attr">schema</span>: <span class="hljs-string">'prisma/schema.prisma'</span>,
  
  <span class="hljs-comment">// 2. é…ç½®è¿ç§»æ–‡ä»¶ç”Ÿæˆè·¯å¾„</span>
  <span class="hljs-attr">migrations</span>: {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'prisma/migrations'</span>,
  },
  
  <span class="hljs-comment">// 3. é…ç½®æ•°æ®æºè¿æ¥</span>
  <span class="hljs-comment">// è¿™é‡Œä½¿ç”¨ env() å‡½æ•°è¯»å–ç¯å¢ƒå˜é‡ï¼Œå®ç°äº†é…ç½®ä¸ä»£ç çš„åˆ†ç¦»</span>
  <span class="hljs-attr">datasource</span>: {
    <span class="hljs-attr">url</span>: <span class="hljs-title function_">env</span>(<span class="hljs-string">'DATABASE_URL'</span>),
  },
});
</code></pre>
<p><strong>2. prisma/schema.prisma ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-prisma" lang="prisma">// æŒ‡å®šç”Ÿæˆå™¨
generator client {
  provider = "prisma-client-js"
}

// æŒ‡å®šæ•°æ®æºç±»å‹ (æ³¨æ„ï¼šæ­¤å¤„ä¸å†é…ç½® url)
datasource db {
  provider = "mysql"
}

// å®šä¹‰ User æ¨¡å‹
model User {
  id    Int     @id @default(autoincrement())
  email String  @unique
  name  String?
}
</code></pre>
<h3 data-id="heading-6">2.3 NestJS æ¨¡å—åŒ–é›†æˆ (PrismaService)</h3>
<p>ä¸ºäº†åœ¨ NestJS ä¸­é«˜æ•ˆä½¿ç”¨ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå…¨å±€ Service æ¥ç®¡ç†è¿æ¥ç”Ÿå‘½å‘¨æœŸï¼Œå¹¶åœ¨ä¸šåŠ¡æ¨¡å—ä¸­æ³¨å…¥ä½¿ç”¨ã€‚</p>
<p><strong>æ­¥éª¤ 1ï¼šåˆ›å»ºå…¨å±€ PrismaService</strong></p>
<p><strong>src/prisma/prisma.service.ts</strong>:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span>, <span class="hljs-title class_">OnModuleInit</span>, <span class="hljs-title class_">OnModuleDestroy</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PrismaClient</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@prisma/client'</span>;

<span class="hljs-meta">@Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PrismaService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">PrismaClient</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">OnModuleInit</span>, <span class="hljs-title class_">OnModuleDestroy</span> {
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onModuleInit</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.$connect();
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onModuleDestroy</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.$disconnect();
  }
}
</code></pre>
<p><strong>src/prisma/prisma.module.ts</strong>:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Global</span>, <span class="hljs-title class_">Module</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PrismaService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./prisma.service'</span>;

<span class="hljs-meta">@Global</span>() <span class="hljs-comment">// è®¾ä¸ºå…¨å±€æ¨¡å—ï¼Œé¿å…åˆ°å¤„ import</span>
<span class="hljs-meta">@Module</span>({
  <span class="hljs-attr">providers</span>: [<span class="hljs-title class_">PrismaService</span>],
  <span class="hljs-attr">exports</span>: [<span class="hljs-title class_">PrismaService</span>],
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PrismaModule</span> {}
</code></pre>
<p><strong>æ­¥éª¤ 2ï¼šåœ¨ä¸šåŠ¡æ¨¡å—ä¸­ä½¿ç”¨</strong></p>
<p>å‡è®¾æœ‰ä¸€ä¸ª <code>UsersModule</code>ï¼Œä½ åªéœ€è¦åœ¨ Service çš„æ„é€ å‡½æ•°ä¸­æ³¨å…¥ <code>PrismaService</code> å³å¯ã€‚</p>
<p><strong>src/users/users.service.ts</strong>:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PrismaService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../prisma/prisma.service'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">User</span>, <span class="hljs-title class_">Prisma</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@prisma/client'</span>; <span class="hljs-comment">// å¯¼å…¥ç”Ÿæˆçš„ç±»å‹</span>

<span class="hljs-meta">@Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UsersService</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> prisma: PrismaService</span>) {}

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">createUser</span>(<span class="hljs-attr">data</span>: <span class="hljs-title class_">Prisma</span>.<span class="hljs-property">UserCreateInput</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">User</span>&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">prisma</span>.<span class="hljs-property">user</span>.<span class="hljs-title function_">create</span>({
      data,
    });
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">findAll</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">prisma</span>.<span class="hljs-property">user</span>.<span class="hljs-title function_">findMany</span>();
  }
}
</code></pre>
<h3 data-id="heading-7">2.4 ç¤¾åŒºæ–¹æ¡ˆæ¨è (<code>nestjs-prisma</code>)</h3>
<p>è™½ç„¶æœ¬æ–‡æ¨èä½¿ç”¨å®˜æ–¹çš„æ‰‹åŠ¨é›†æˆæ–¹å¼ä»¥ç†è§£åº•å±‚åŸç†ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå»ºè®®é€‰æ‹©ç¤¾åŒºæˆç†Ÿçš„å°è£…åº“ <code>nestjs-prisma</code>ã€‚</p>
<ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼šå†…ç½®äº† <code>PrismaModule</code> å’Œ <code>PrismaService</code>ï¼Œå¼€ç®±å³ç”¨ã€‚</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šæä¾›äº†æ—¥å¿—ä¸­é—´ä»¶ã€å¼‚å¸¸è¿‡æ»¤å™¨ç­‰å®ç”¨å·¥å…·ï¼Œçœå»äº†æ ·æ¿ä»£ç ã€‚</li>
<li><strong>é€‚ç”¨</strong>ï¼šå¸Œæœ›å¿«é€Ÿæ­å»ºã€å‡å°‘æ ·æ¿ä»£ç çš„é¡¹ç›®ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-8">ä¸‰ã€ Prisma æ ¸å¿ƒé“¾è·¯</h2>
<ol>
<li>
<p><strong>é…ç½®é˜¶æ®µ (<code>prisma.config.ts</code>)</strong>ï¼š</p>
<ul>
<li>å®ƒæ˜¯æ€»æŒ‡æŒ¥ã€‚å½“ä½ è¿è¡Œ <code>prisma</code> å‘½ä»¤æ—¶ï¼Œå®ƒé¦–å…ˆè¢«åŠ è½½ã€‚</li>
<li>å®ƒå‘Šè¯‰ CLIï¼šå»å“ªæ‰¾ Schema å®šä¹‰ (<code>schema.prisma</code>)ï¼Œå»å“ªæ‰¾è¿ç§»æ–‡ä»¶ (<code>migrations</code>)ï¼Œä»¥åŠå»å“ªæ‰¾æ•°æ®åº“è¿æ¥ä¸² (<code>.env</code> -&gt; <code>DATABASE_URL</code>)ã€‚</li>
</ul>
</li>
<li>
<p><strong>åå‘å·¥ç¨‹é˜¶æ®µ (Introspection, å¯é€‰)</strong>ï¼š</p>
<ul>
<li><strong>å‘½ä»¤</strong>ï¼š<code>npx prisma db pull</code></li>
<li><strong>åœºæ™¯</strong>ï¼šå½“ä½ æœ‰ç°å­˜çš„æ•°æ®åº“ï¼Œæˆ–è€…æœ‰äººç›´æ¥ä¿®æ”¹äº†æ•°æ®åº“ç»“æ„æ—¶ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šPrisma è¯»å–æ•°æ®åº“çš„ Schemaï¼ˆè¡¨ã€åˆ—ã€ç´¢å¼•ï¼‰ï¼Œå¹¶å°†å®ƒä»¬ <strong>åå‘ç”Ÿæˆ/è¦†ç›–</strong> åˆ° <code>prisma/schema.prisma</code> æ–‡ä»¶ä¸­ï¼Œç¡®ä¿ä½ çš„ Schema å®šä¹‰ä¸çœŸå®æ•°æ®åº“ä¿æŒåŒæ­¥ã€‚</li>
</ul>
</li>
<li>
<p><strong>è¿ç§»åŒæ­¥é˜¶æ®µ (Migration/Sync)</strong>ï¼š</p>
<ul>
<li>å½“ä½ è¿è¡Œ <code>npx prisma migrate dev</code> æˆ– <code>npx prisma db push</code> æ—¶ï¼ŒPrisma ä¼šè®¡ç®—å·®å¼‚å¹¶åŒæ­¥åˆ°æ•°æ®åº“ã€‚</li>
<li><strong>å·®å¼‚è®¡ç®—æ–¹å¼å–å†³äºå‘½ä»¤</strong>ï¼š
<ul>
<li><strong><code>migrate dev</code></strong>ï¼šå¯¹æ¯” <code>schema.prisma</code> å’Œ <strong>è¿ç§»å†å²</strong>ï¼ˆå€ŸåŠ©å½±å­åº“ï¼‰ã€‚ç”Ÿæˆ SQL è¿ç§»æ–‡ä»¶å¹¶åº”ç”¨åˆ°æ•°æ®åº“ï¼Œé€‚åˆå›¢é˜Ÿåä½œã€‚</li>
<li><strong><code>db push</code></strong>ï¼šå¯¹æ¯” <code>schema.prisma</code> å’Œ <strong>æ•°æ®åº“å½“å‰ç»“æ„</strong>ã€‚å¿½ç•¥è¿ç§»å†å²ï¼Œæ ¹æ®å·®å¼‚å†…å®¹ï¼Œç›´æ¥å°†å˜æ›´åº”ç”¨åˆ°æ•°æ®åº“ï¼Œé€‚åˆå¿«é€Ÿå¼€å‘ã€‚</li>
</ul>
</li>
<li><strong>æ‰§è¡Œå˜æ›´</strong>ï¼š
<ul>
<li><strong><code>migrate dev</code></strong>ï¼šæ‰§è¡Œ <strong>æœ¬åœ°æ–°ç”Ÿæˆçš„ SQL è¿ç§»æ–‡ä»¶</strong>ã€‚</li>
<li><strong><code>db push</code></strong>ï¼šæ‰§è¡Œ <strong>å†…å­˜ä¸­å³æ—¶è®¡ç®—å‡ºçš„å˜æ›´ SQL</strong>ã€‚</li>
<li>æœ€ç»ˆç»“æœéƒ½æ˜¯å°†æ¨¡å‹åŒæ­¥åˆ°çœŸå®æ•°æ®åº“ä¸­ï¼Œåˆ›å»ºè¡¨ã€åˆ—ã€ç´¢å¼•ç­‰ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>ç”Ÿæˆé˜¶æ®µ (CodeGen)</strong>ï¼š</p>
<ul>
<li>å½“ä½ è¿è¡Œ <code>npx prisma generate</code> æ—¶ï¼ˆ<code>migrate dev</code> å’Œ <code>db push</code> é»˜è®¤éƒ½ä¼šè‡ªåŠ¨è§¦å‘æ­¤æ­¥ï¼‰ï¼ŒPrisma è¯»å– <code>schema.prisma</code> ä¸­çš„ <code>model User { ... }</code>ã€‚</li>
<li>å®ƒå°†è¿™äº›æ¨¡å‹å®šä¹‰â€œç¿»è¯‘â€æˆ TypeScript ç±»å‹å®šä¹‰ (<code>User</code>, <code>UserCreateInput</code>) å’Œ JavaScript æŸ¥è¯¢é€»è¾‘ã€‚</li>
<li>ç”Ÿæˆçš„ä»£ç è¢«å†™å…¥åˆ° <code>node_modules/@prisma/client</code> ç›®å½•ä¸­ã€‚</li>
<li><strong>å…³é”®ç‚¹</strong>ï¼šè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ¯æ¬¡ä¿®æ”¹ <code>schema.prisma</code> å<strong>å¿…é¡»</strong>é‡æ–°è¿è¡Œ <code>generate</code>ï¼Œå¦åˆ™ä½ çš„ä»£ç é‡Œæ‹¿ä¸åˆ°æ–°å­—æ®µçš„æç¤ºã€‚</li>
</ul>
</li>
<li>
<p><strong>è¿è¡Œé˜¶æ®µ (Runtime)</strong>ï¼š</p>
<ul>
<li>å½“ä½ æ‰§è¡Œ <code>this.prisma.user.findMany()</code> æ—¶ï¼Œ<code>PrismaService</code> å®ä¾‹ï¼ˆå·²åœ¨åº”ç”¨å¯åŠ¨æ—¶è¿æ¥æ•°æ®åº“ï¼‰ä¼šå°† JS å¯¹è±¡è½¬æ¢æˆ SQL è¯­å¥å‘é€ç»™æ•°æ®åº“ï¼Œå¹¶å°†ç»“æœååºåˆ—åŒ–å› JS å¯¹è±¡ã€‚</li>
</ul>
</li>
</ol>
<h2 data-id="heading-9">å››ã€ å¼€å‘å·¥ä½œæµé›†æˆ</h2>
<ol>
<li>
<p><strong>ä»£ç è‡ªåŠ¨ç”Ÿæˆ (<code>postinstall</code>)</strong>ï¼š</p>
<ul>
<li>åœ¨ <code>package.json</code> ä¸­é…ç½® <code>"postinstall": "prisma generate"</code>ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šæ¯æ¬¡ä½ ï¼ˆæˆ–åŒäº‹ã€CI/CDï¼‰æ‰§è¡Œ <code>npm install</code> å®‰è£…ä¾èµ–åï¼Œä¼šè‡ªåŠ¨è§¦å‘ <code>prisma generate</code>ã€‚è¿™æ ·ç¡®ä¿ <code>node_modules/@prisma/client</code> æ°¸è¿œæ˜¯æœ€æ–°çš„ï¼Œä½ ä¸‹è½½å®Œé¡¹ç›®å°±èƒ½ç›´æ¥è·‘ï¼Œä¸ç”¨æ‹…å¿ƒç¼ºå°‘ Prisma ç±»å‹ä»£ç ã€‚</li>
</ul>
</li>
<li>
<p><strong>ä¿®æ”¹è¡¨ç»“æ„çš„æµç¨‹</strong>ï¼š</p>
<ul>
<li><strong>æ ‡å‡†æ¨¡å¼ (<code>migrate dev</code>)</strong>ï¼šå½“ä½ ä¿®æ”¹äº† <code>schema.prisma</code> åï¼Œéœ€<strong>æ‰‹åŠ¨è¿è¡Œ</strong> <code>npx prisma migrate dev</code>ã€‚
<ul>
<li><strong>åŠ¨ä½œ</strong>ï¼šç”Ÿæˆæ–°çš„ SQL è¿ç§»æ–‡ä»¶ -&gt; æ‰§è¡Œ SQL æ›´æ–°æ•°æ®åº“ -&gt; è‡ªåŠ¨è¿è¡Œ <code>prisma generate</code> é‡æ–°ç”Ÿæˆ Client ä»£ç ã€‚</li>
<li><strong>ç»“æœ</strong>ï¼šæ•°æ®åº“è¡¨ç»“æ„å˜æ›´ï¼Œä¸” <code>node_modules</code> æ›´æ–°ï¼ŒNestJS çƒ­é‡è½½è§¦å‘ï¼ŒIDE è·å¾—æ–°å­—æ®µæç¤ºã€‚</li>
</ul>
</li>
<li><strong>Sync æ¨¡å¼ (<code>db push</code>)</strong>ï¼šéœ€<strong>æ‰‹åŠ¨è¿è¡Œ</strong> <code>npx prisma db push</code>ã€‚
<ul>
<li><strong>åŠ¨ä½œ</strong>ï¼šç›´æ¥æ›´æ–°æ•°æ®åº“ç»“æ„ï¼ˆæ— è¿ç§»æ–‡ä»¶ï¼‰ -&gt; è‡ªåŠ¨è¿è¡Œ <code>prisma generate</code>ã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šé€‚ç”¨äºå¿«é€ŸåŸå‹å¼€å‘ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>è¿è¡Œæ—¶è¿æ¥ (<code>PrismaService</code>)</strong>ï¼š</p>
<ul>
<li>æˆ‘ä»¬åœ¨ <code>2.3</code> èŠ‚åˆ›å»ºçš„ <code>PrismaService</code> å®ç°äº† <code>OnModuleInit</code> æ¥å£ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šå½“ NestJS åº”ç”¨å¯åŠ¨ (<code>npm run start:dev</code>) æ—¶ï¼Œ<code>PrismaService</code> ä¼šè‡ªåŠ¨è°ƒç”¨ <code>$connect()</code> å»ºç«‹æ•°æ®åº“è¿æ¥æ± ã€‚åº”ç”¨åœæ­¢æ—¶è‡ªåŠ¨æ–­å¼€ã€‚</li>
<li>ä½ ä¸éœ€è¦åœ¨æ¯ä¸ª Controller é‡Œæ‰‹åŠ¨ connect/disconnectï¼Œç›´æ¥æ³¨å…¥ Service ä½¿ç”¨å³å¯ã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h2 data-id="heading-10">äº”ã€ æ·±å…¥ç†è§£ï¼š<code>migrate dev</code> èƒŒåçš„é»‘ç›’æœºåˆ¶</h2>
<p>Prisma Migrate çš„æ ¸å¿ƒé€»è¾‘æ˜¯åŸºäº <strong>Shadow Databaseï¼ˆå½±å­æ•°æ®åº“ï¼‰</strong> æ¥è®¡ç®—å·®å¼‚çš„ã€‚</p>
<p>å½“ä½ è¿è¡Œ <code>prisma migrate dev</code> æ—¶ï¼ŒPrisma ä¼šåœ¨åå°å·å·åšè¿™ä»¶äº‹ï¼š</p>
<ol>
<li><strong>åˆ›å»ºå½±å­åº“</strong>ï¼šåœ¨åå°ä¸´æ—¶åˆ›å»ºä¸€ä¸ªç©ºçš„æ•°æ®åº“ï¼ˆShadow DBï¼‰ã€‚</li>
<li><strong>é‡æ”¾å†å²</strong>ï¼šæŠŠæœ¬åœ° <code>prisma/migrations</code> æ–‡ä»¶å¤¹é‡Œæ‰€æœ‰çš„ SQL æ–‡ä»¶ï¼ŒæŒ‰é¡ºåºåœ¨è¿™ä¸ªå½±å­åº“é‡Œæ‰§è¡Œä¸€éã€‚æ‰§è¡Œå®Œåï¼Œå½±å­åº“çš„çŠ¶æ€å°±æ˜¯ â€œä¸Šä¸€æ¬¡è¿ç§»åçš„çŠ¶æ€â€ (B)ã€‚</li>
<li><strong>è®¡ç®—å·®å¼‚</strong>ï¼šæ‹¿ä½ ç°åœ¨çš„ <code>schema.prisma</code> (A) å’Œè¿™ä¸ªå½±å­åº“ (B) å¯¹æ¯”ã€‚</li>
<li><strong>ç”Ÿæˆæ–°è¿ç§»</strong>ï¼šå·®å¼‚éƒ¨åˆ†ç”Ÿæˆæ–°çš„ SQL æ–‡ä»¶ï¼Œæ”¾å…¥ <code>prisma/migrations</code>ã€‚</li>
<li><strong>æ¸…ç†</strong>ï¼šåˆ æ‰å½±å­åº“ã€‚</li>
</ol>
<p><strong>ç»“è®ºï¼š</strong></p>
<ul>
<li>Prisma ä¿¡ä»»çš„æ˜¯ä½  <strong>æœ¬åœ°çš„æ–‡ä»¶ç³»ç»Ÿ (<code>prisma/migrations</code>)</strong> ä½œä¸ºå†å²è®°å½•çš„ä¾æ®ã€‚</li>
<li>å¦‚æœä½ æŠŠæœ¬åœ°çš„ <code>migrations</code> æ–‡ä»¶å¤¹åˆ äº†ï¼ŒPrisma å°±å¤±å¿†äº†ï¼Œä¸‹æ¬¡å®ƒå°±ä¼šè®¤ä¸ºä½ æ˜¯ä»é›¶å¼€å§‹ï¼Œç”Ÿæˆå…¨é‡è¿ç§»ã€‚</li>
<li>æ‰€ä»¥ï¼Œ<strong><code>prisma/migrations</code> æ–‡ä»¶å¤¹å¿…é¡»æäº¤åˆ° Git</strong>ï¼Œå®ƒæ˜¯é¡¹ç›®æºä»£ç çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaç½‘ç»œç¼–ç¨‹ä»å…¥é—¨åˆ°å®æˆ˜ï¼šåƒé€ä¸‰è¦ç´ ï¼Œç©è½¬CS/BSæ¶æ„]]></title>    <link>https://juejin.cn/post/7582905804048007195</link>    <guid>https://juejin.cn/post/7582905804048007195</guid>    <pubDate>2025-12-13T15:11:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582905804048007195" data-draft-id="7582905804047990811" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaç½‘ç»œç¼–ç¨‹ä»å…¥é—¨åˆ°å®æˆ˜ï¼šåƒé€ä¸‰è¦ç´ ï¼Œç©è½¬CS/BSæ¶æ„"/> <meta itemprop="keywords" content="åç«¯,Java,HTTP"/> <meta itemprop="datePublished" content="2025-12-13T15:11:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="okseekw"/> <meta itemprop="url" content="https://juejin.cn/user/1933379625032649"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaç½‘ç»œç¼–ç¨‹ä»å…¥é—¨åˆ°å®æˆ˜ï¼šåƒé€ä¸‰è¦ç´ ï¼Œç©è½¬CS/BSæ¶æ„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1933379625032649/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    okseekw
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T15:11:40.000Z" title="Sat Dec 13 2025 15:11:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Javaç½‘ç»œç¼–ç¨‹ä»å…¥é—¨åˆ°å®æˆ˜ï¼šåƒé€ä¸‰è¦ç´ ï¼Œç©è½¬CS/BSæ¶æ„</h2>
<p>åœ¨æ•°å­—åŒ–æ—¶ä»£ï¼Œç½‘ç»œç¼–ç¨‹æ˜¯å®ç°è®¾å¤‡äº’è”ã€æ•°æ®äº¤äº’çš„æ ¸å¿ƒæŠ€æœ¯ã€‚æ— è®ºæ˜¯æˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨çš„APPã€ç½‘é¡µï¼Œè¿˜æ˜¯ä¼ä¸šçº§çš„æœåŠ¡é€šä¿¡ï¼Œéƒ½ç¦»ä¸å¼€ç½‘ç»œç¼–ç¨‹çš„æ”¯æ’‘ã€‚è€ŒJavaä½œä¸ºä¸€é—¨å¼ºå¤§çš„åç«¯å¼€å‘è¯­è¨€ï¼Œå…¶<code>java.net.*</code>åŒ…æä¾›äº†å®Œå–„çš„ç½‘ç»œç¼–ç¨‹è§£å†³æ–¹æ¡ˆï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿè½»æ¾å®ç°å„ç±»ç½‘ç»œé€šä¿¡éœ€æ±‚ã€‚</p>
<p>æœ¬æ–‡å°†ä»ç½‘ç»œç¼–ç¨‹çš„åŸºç¡€æ¦‚å¿µå‡ºå‘ï¼Œè¯¦è§£<strong>é€šä¿¡æ¶æ„</strong>ä¸<strong>IPã€ç«¯å£ã€åè®®ä¸‰è¦ç´ </strong>ï¼Œå¹¶ç»“åˆå®æˆ˜ä»£ç æ¼”ç¤º<code>InetAddress</code>ç±»çš„ä½¿ç”¨ï¼Œå¸®ä½ ä»ç†è®ºåˆ°å®è·µï¼Œå½»åº•å…¥é—¨Javaç½‘ç»œç¼–ç¨‹ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€ç½‘ç»œç¼–ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿé€šä¿¡æ¶æ„æœ‰å“ªäº›ï¼Ÿ</h3>
<h4 data-id="heading-2">1.1 ç½‘ç»œç¼–ç¨‹çš„æ ¸å¿ƒå®šä¹‰</h4>
<p>ç½‘ç»œç¼–ç¨‹æ˜¯æŒ‡è®©è®¾å¤‡ä¸­çš„ç¨‹åºä¸ç½‘ç»œä¸Šå…¶ä»–è®¾å¤‡çš„ç¨‹åºè¿›è¡Œæ•°æ®äº¤äº’çš„æŠ€æœ¯ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å®ç°â€œè·¨è®¾å¤‡æ•°æ®ä¼ é€’â€çš„æ‰‹æ®µâ€”â€”å°åˆ°æ‰‹æœºæ‰«ç æ”¯ä»˜ï¼Œå¤§åˆ°åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ•°æ®åŒæ­¥ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯ç½‘ç»œç¼–ç¨‹çš„åº”ç”¨ã€‚</p>
<h4 data-id="heading-3">1.2 ä¸¤å¤§æ ¸å¿ƒé€šä¿¡æ¶æ„</h4>
<p>æ‰€æœ‰ç½‘ç»œåº”ç”¨éƒ½åŸºäºä»¥ä¸‹ä¸¤ç§é€šä¿¡æ¶æ„è®¾è®¡ï¼Œä¸”æ— è®ºå“ªç§æ¶æ„ï¼Œéƒ½å¿…é¡»ä¾èµ–ç½‘ç»œç¼–ç¨‹ä¸‰è¦ç´ ï¼ˆIPã€ç«¯å£ã€åè®®ï¼‰å®ç°é€šä¿¡ï¼š</p>
<h5 data-id="heading-4">1. CSæ¶æ„ï¼ˆClient/Serverï¼Œå®¢æˆ·ç«¯/æœåŠ¡ç«¯ï¼‰</h5>
<ul>
<li><strong>ç»“æ„</strong>ï¼šåˆ†ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸¤éƒ¨åˆ†ã€‚å®¢æˆ·ç«¯æ˜¯ç”¨æˆ·ç›´æ¥æ“ä½œçš„ç¨‹åºï¼ˆå¦‚å¾®ä¿¡APPã€QQå®¢æˆ·ç«¯ã€æ¸¸æˆå®¢æˆ·ç«¯ï¼‰ï¼ŒæœåŠ¡ç«¯æ˜¯è¿è¡Œåœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„ç¨‹åºï¼Œè´Ÿè´£æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚ã€å¤„ç†æ•°æ®å¹¶è¿”å›ç»“æœã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šå®¢æˆ·ç«¯éœ€è¦å•ç‹¬å®‰è£…ï¼Œå¯å®šåˆ¶åŒ–ç¨‹åº¦é«˜ï¼Œèƒ½ç¼“å­˜æ•°æ®ï¼Œé€‚åˆå¯¹äº¤äº’ä½“éªŒå’Œæ€§èƒ½è¦æ±‚é«˜çš„åœºæ™¯ï¼ˆå¦‚æ¸¸æˆã€åŠå…¬è½¯ä»¶ï¼‰ã€‚</li>
<li><strong>ç¤ºä¾‹</strong>ï¼šå¾®ä¿¡ï¼ˆæ‰‹æœºå®¢æˆ·ç«¯ â†” è…¾è®¯æœåŠ¡å™¨ï¼‰ã€MySQLæ•°æ®åº“ï¼ˆJavaç¨‹åº â†” MySQLæœåŠ¡ç«¯ï¼‰ã€‚</li>
</ul>
<h5 data-id="heading-5">2. BSæ¶æ„ï¼ˆBrowser/Serverï¼Œæµè§ˆå™¨/æœåŠ¡ç«¯ï¼‰</h5>
<ul>
<li><strong>ç»“æ„</strong>ï¼šæ— éœ€å®‰è£…å•ç‹¬å®¢æˆ·ç«¯ï¼Œé€šè¿‡æµè§ˆå™¨ï¼ˆå¦‚Chromeã€Edgeï¼‰ä½œä¸ºâ€œé€šç”¨å®¢æˆ·ç«¯â€ï¼Œç›´æ¥è®¿é—®è¿œç¨‹æœåŠ¡ç«¯çš„ç½‘é¡µæˆ–æ¥å£ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šæ— éœ€å®‰è£…ã€è·¨å¹³å°ï¼ˆåªè¦æœ‰æµè§ˆå™¨å³å¯ä½¿ç”¨ï¼‰ï¼Œå¼€å‘ç»´æŠ¤æˆæœ¬ä½ï¼Œé€‚åˆé¢å‘å¹¿æ³›ç”¨æˆ·çš„åœºæ™¯ï¼ˆå¦‚ç”µå•†ç½‘ç«™ã€æ–°é—»å¹³å°ï¼‰ã€‚</li>
<li><strong>ç¤ºä¾‹</strong>ï¼šæ·˜å®ï¼ˆæµè§ˆå™¨ â†” é˜¿é‡ŒæœåŠ¡å™¨ï¼‰ã€ç™¾åº¦æœç´¢ï¼ˆæµè§ˆå™¨ â†” ç™¾åº¦æœåŠ¡å™¨ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-6">1.3 Javaçš„ç½‘ç»œç¼–ç¨‹æ”¯æŒ</h4>
<p>Javaä¸ºç½‘ç»œç¼–ç¨‹æä¾›äº†åŸç”Ÿè§£å†³æ–¹æ¡ˆâ€”â€”<code>java.net.*</code>åŒ…ï¼Œè¯¥åŒ…åŒ…å«äº†å¤„ç†IPã€ç«¯å£ã€åè®®çš„æ ¸å¿ƒç±»ï¼ˆå¦‚<code>InetAddress</code>ã€<code>Socket</code>ã€<code>ServerSocket</code>ç­‰ï¼‰ï¼Œæ— éœ€é¢å¤–ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼Œå³å¯å®ç°ä»ç®€å•çš„IPè§£æåˆ°å¤æ‚çš„TCP/UDPé€šä¿¡ã€‚</p>
<h3 data-id="heading-7">äºŒã€IPï¼šè®¾å¤‡åœ¨ç½‘ç»œä¸­çš„â€œå”¯ä¸€èº«ä»½è¯â€</h3>
<p>IPï¼ˆInternet Protocolï¼Œäº’è”ç½‘åè®®åœ°å€ï¼‰æ˜¯ç½‘ç»œä¸­è®¾å¤‡çš„å”¯ä¸€æ ‡è¯†ï¼Œç›¸å½“äºç°å®ä¸­çš„â€œå®¶åº­ä½å€â€ï¼Œç”¨äºç²¾å‡†å®šä½é€šä¿¡çš„ç›®æ ‡è®¾å¤‡ã€‚æ²¡æœ‰IPï¼Œè®¾å¤‡å°±æ— æ³•åœ¨ç½‘ç»œä¸­è¢«è¯†åˆ«ã€‚</p>
<h4 data-id="heading-8">2.1 ä¸¤ç§ä¸»æµIPåœ°å€ï¼šIPv4ä¸IPv6</h4>
<p>ç›®å‰å…¨çƒå¹¿æ³›ä½¿ç”¨çš„IPåœ°å€æœ‰ä¸¤ç§ï¼Œæ ¸å¿ƒå·®å¼‚åœ¨äºåœ°å€é•¿åº¦å’Œå®¹é‡ï¼š</p>























<table><thead><tr><th>ç±»å‹</th><th>åœ°å€é•¿åº¦</th><th>è¡¨ç¤ºå½¢å¼</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td>IPv4</td><td>32ä½</td><td>ç‚¹åˆ†åè¿›åˆ¶ï¼ˆå¦‚192.168.1.1ï¼‰</td><td>åœ°å€å®¹é‡çº¦42äº¿ï¼Œå·²æ¿’ä¸´æ¯ç«­</td></tr><tr><td>IPv6</td><td>128ä½</td><td>å†’åˆ†åå…­è¿›åˆ¶ï¼ˆå¦‚2001:0db8:85a3:0000:0000:8a2e:0370:7334ï¼‰</td><td>å®¹é‡æå¤§ï¼Œå¯æ»¡è¶³ä¸‡ç‰©äº’è”éœ€æ±‚</td></tr></tbody></table>
<p>IPv6çš„å‡ºç°æ˜¯ä¸ºäº†è§£å†³IPv4åœ°å€è€—å°½çš„é—®é¢˜ï¼Œå…¶åœ°å€å®¹é‡å·ç§°â€œèƒ½ä¸ºåœ°çƒä¸Šæ¯ä¸€ç²’æ²™å­ç¼–å·â€ï¼Œæ˜¯æœªæ¥ç½‘ç»œçš„ä¸»æµé€‰æ‹©ã€‚</p>
<h4 data-id="heading-9">2.2 åŸŸåï¼šäººç±»æ˜“è®°çš„â€œIPåˆ«åâ€</h4>
<p>IPåœ°å€æ˜¯ä¸€ä¸²æ— æ„ä¹‰çš„æ•°å­—ï¼Œéš¾ä»¥è®°å¿†ï¼ˆæ¯”å¦‚æ²¡äººèƒ½è®°ä½ç™¾åº¦çš„IPï¼Œä½†èƒ½è®°ä½<code>www.baidu.com</code>ï¼‰ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ<strong>åŸŸåï¼ˆDomain Nameï¼‰</strong> åº”è¿è€Œç”Ÿï¼Œè€Œ<strong>DNSåŸŸåè§£æç³»ç»Ÿ</strong>åˆ™å……å½“äº†â€œäº’è”ç½‘ç”µè¯ç°¿â€çš„è§’è‰²â€”â€”å°†æ˜“è®°çš„åŸŸåï¼ˆå¦‚<code>www.jd.com</code>ï¼‰è‡ªåŠ¨è½¬æ¢ä¸ºå¯¹åº”çš„IPåœ°å€ï¼Œè®©ç”¨æˆ·æ— éœ€è®°å¿†å¤æ‚æ•°å­—å³å¯è®¿é—®ç½‘ç»œèµ„æºã€‚</p>
<h4 data-id="heading-10">2.3 IPçš„åˆ†ç±»ï¼šå…¬ç½‘IPã€å†…ç½‘IPä¸æœ¬æœºIP</h4>
<p>æ ¹æ®ä½¿ç”¨èŒƒå›´ï¼ŒIPå¯åˆ†ä¸ºä¸‰ç±»ï¼Œå„è‡ªæ‰¿æ‹…ä¸åŒçš„é€šä¿¡èŒè´£ï¼š</p>
<ul>
<li><strong>å…¬ç½‘IP</strong>ï¼šå…¨ç½‘å”¯ä¸€ï¼Œå¯ç›´æ¥è¿æ¥äº’è”ç½‘ï¼Œç”¨äºè®¾å¤‡å¯¹å¤–é€šä¿¡ï¼ˆå¦‚é˜¿é‡Œäº‘æœåŠ¡å™¨çš„IPï¼‰ã€‚</li>
<li><strong>å†…ç½‘IP</strong>ï¼šä»…åœ¨å±€åŸŸç½‘å†…ä½¿ç”¨ï¼ˆå¦‚å…¬å¸ã€å®¶åº­ç½‘ç»œï¼‰ï¼Œæ— æ³•ç›´æ¥è®¿é—®äº’è”ç½‘ã€‚å¸¸è§ä»¥<code>192.168.</code>å¼€å¤´ï¼ŒèŒƒå›´æ˜¯<code>192.168.0.0~192.168.255.255</code>ï¼Œå±€åŸŸç½‘å†…è®¾å¤‡å¯é€šè¿‡å†…ç½‘IPç›¸äº’é€šä¿¡ï¼ˆå¦‚åŠå…¬å®¤ç”µè„‘ä¹‹é—´ä¼ æ–‡ä»¶ï¼‰ã€‚</li>
<li><strong>æœ¬æœºIP</strong>ï¼š<code>127.0.0.1</code>ï¼ˆæˆ–åˆ«å<code>localhost</code>ï¼‰ï¼Œä¸“é—¨æŒ‡ä»£å½“å‰è®¾å¤‡ï¼Œå¸¸ç”¨äºæœ¬åœ°ç¨‹åºè°ƒè¯•ï¼ˆå¦‚æœ¬åœ°å¯åŠ¨çš„Spring Booté¡¹ç›®ï¼Œå¯é€šè¿‡<code>http://localhost:8080</code>è®¿é—®ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-11">2.4 å¸¸ç”¨IPæ“ä½œå‘½ä»¤</h4>
<p>æ—¥å¸¸å¼€å‘ä¸­ï¼Œå¸¸ç”¨ä»¥ä¸‹å‘½ä»¤æ’æŸ¥ç½‘ç»œé—®é¢˜ï¼š</p>
<ul>
<li><code>ipconfig</code>ï¼ˆWindowsï¼‰/ <code>ifconfig</code>ï¼ˆLinux/Macï¼‰ï¼šæŸ¥çœ‹æœ¬æœºIPåœ°å€ã€å­ç½‘æ©ç ã€ç½‘å…³ç­‰ç½‘ç»œé…ç½®ã€‚</li>
<li><code>ping IPåœ°å€/åŸŸå</code>ï¼šæ£€æµ‹æœ¬æœºä¸ç›®æ ‡è®¾å¤‡çš„ç½‘ç»œè¿é€šæ€§ï¼ˆå¦‚<code>ping www.baidu.com</code>ï¼Œè‹¥è¿”å›â€œè¯·æ±‚è¶…æ—¶â€åˆ™è¯´æ˜ç½‘ç»œä¸é€šï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-12">2.5 Javaå®æˆ˜ï¼šç”¨InetAddressæ“ä½œIP</h4>
<p>Javaçš„<code>java.net.InetAddress</code>ç±»æ˜¯å¤„ç†IPçš„æ ¸å¿ƒå·¥å…·ï¼Œå¯å®ç°â€œè·å–æœ¬æœºIPã€è§£æåŸŸååˆ°IPã€æ£€æµ‹ç½‘ç»œè¿é€šæ€§â€ç­‰åŠŸèƒ½ã€‚ä¸‹é¢é€šè¿‡å®æˆ˜ä»£ç æ¼”ç¤ºå…¶æ ¸å¿ƒç”¨æ³•ã€‚</p>
<h5 data-id="heading-13">å®Œæ•´ä»£ç ï¼ˆå¯ç›´æ¥è¿è¡Œï¼‰</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.wmh.demo1inetaddress;
<span class="hljs-keyword">import</span> java.net.InetAddress;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InetAddressDemo1</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// ç›®æ ‡ï¼šä½¿ç”¨InetAddressæ“ä½œIPï¼ˆæœ¬æœºIPã€ç›®æ ‡IPã€è¿é€šæ€§æ£€æµ‹ï¼‰</span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 1. è·å–æœ¬æœºIPå¯¹è±¡ï¼ˆåŒ…å«ä¸»æœºåå’ŒIPåœ°å€ï¼‰</span>
            <span class="hljs-type">InetAddress</span> <span class="hljs-variable">localIp</span> <span class="hljs-operator">=</span> InetAddress.getLocalHost();
            System.out.println(<span class="hljs-string">"âœ… æœ¬æœºä¸»æœºåï¼š"</span> + localIp.getHostName());
            System.out.println(<span class="hljs-string">"âœ… æœ¬æœºIPåœ°å€ï¼š"</span> + localIp.getHostAddress());

            <span class="hljs-comment">// 2. é€šè¿‡åŸŸåè·å–ç›®æ ‡IPå¯¹è±¡ï¼ˆä»¥ç™¾åº¦ä¸ºä¾‹ï¼Œè‡ªåŠ¨è§¦å‘DNSè§£æï¼‰</span>
            <span class="hljs-type">InetAddress</span> <span class="hljs-variable">baiduIp</span> <span class="hljs-operator">=</span> InetAddress.getByName(<span class="hljs-string">"www.baidu.com"</span>);
            System.out.println(<span class="hljs-string">"\nâœ… ç™¾åº¦ä¸»æœºåï¼š"</span> + baiduIp.getHostName());
            System.out.println(<span class="hljs-string">"âœ… ç™¾åº¦IPåœ°å€ï¼š"</span> + baiduIp.getHostAddress());

            <span class="hljs-comment">// 3. æ£€æµ‹æœ¬æœºä¸ç™¾åº¦çš„ç½‘ç»œè¿é€šæ€§ï¼ˆè¶…æ—¶æ—¶é—´5000æ¯«ç§’=5ç§’ï¼‰</span>
            <span class="hljs-type">boolean</span> <span class="hljs-variable">isReachable</span> <span class="hljs-operator">=</span> baiduIp.isReachable(<span class="hljs-number">5000</span>);
            System.out.println(<span class="hljs-string">"\nâœ… æœ¬æœºä¸ç™¾åº¦æ˜¯å¦è¿é€šï¼š"</span> + (isReachable ? <span class="hljs-string">"æ˜¯"</span> : <span class="hljs-string">"å¦"</span>));

        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-comment">// æ•è·å¼‚å¸¸ï¼ˆå¦‚DNSè§£æå¤±è´¥ã€ç½‘ç»œä¸­æ–­ã€æƒé™ä¸è¶³ç­‰ï¼‰</span>
            System.err.println(<span class="hljs-string">"âŒ ç½‘ç»œæ“ä½œå¼‚å¸¸ï¼š"</span> + e.getMessage());
            e.printStackTrace();
        }
    }
}
</code></pre>
<h5 data-id="heading-14">æ ¸å¿ƒæ–¹æ³•è§£é‡Š</h5>





























<table><thead><tr><th>æ–¹æ³•</th><th>åŠŸèƒ½æè¿°</th></tr></thead><tbody><tr><td><code>getLocalHost()</code></td><td>è·å–æœ¬æœºIPåœ°å€å¯¹è±¡ï¼ŒæŠ›å‡º<code>UnknownHostException</code>å¼‚å¸¸</td></tr><tr><td><code>getByName(String host)</code></td><td>æ ¹æ®IPåœ°å€æˆ–åŸŸåï¼Œè·å–ç›®æ ‡IPå¯¹è±¡ï¼ˆè‡ªåŠ¨DNSè§£æï¼‰</td></tr><tr><td><code>getHostName()</code></td><td>è·å–IPå¯¹è±¡å¯¹åº”çš„ä¸»æœºå</td></tr><tr><td><code>getHostAddress()</code></td><td>è·å–IPå¯¹è±¡å¯¹åº”çš„IPåœ°å€å­—ç¬¦ä¸²</td></tr><tr><td><code>isReachable(int timeout)</code></td><td>æ£€æµ‹ä¸ç›®æ ‡è®¾å¤‡çš„è¿é€šæ€§ï¼Œtimeoutä¸ºè¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</td></tr></tbody></table>
<h5 data-id="heading-15">è¿è¡Œç»“æœç¤ºä¾‹</h5>
<pre><code class="hljs">âœ… æœ¬æœºä¸»æœºåï¼šDESKTOP-8K8XZ7A
âœ… æœ¬æœºIPåœ°å€ï¼š192.168.3.108

âœ… ç™¾åº¦ä¸»æœºåï¼šwww.baidu.com
âœ… ç™¾åº¦IPåœ°å€ï¼š180.101.49.12

âœ… æœ¬æœºä¸ç™¾åº¦æ˜¯å¦è¿é€šï¼šæ˜¯
</code></pre>
<h3 data-id="heading-16">ä¸‰ã€ç«¯å£ï¼šåº”ç”¨ç¨‹åºçš„â€œå”¯ä¸€é—¨ç‰Œå·â€</h3>
<p>é€šè¿‡IPå®šä½åˆ°è®¾å¤‡åï¼Œè¿˜éœ€è¦é€šè¿‡<strong>ç«¯å£ï¼ˆPortï¼‰</strong> å®šä½åˆ°è®¾å¤‡ä¸Šæ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºã€‚ç«¯å£æ˜¯ä¸€ä¸ª16ä½çš„äºŒè¿›åˆ¶æ•°ï¼ŒèŒƒå›´æ˜¯<code>0~65535</code>ï¼Œç›¸å½“äºè®¾å¤‡ä¸Šçš„â€œé—¨ç‰Œå·â€â€”â€”ä¸€ä¸ªè®¾å¤‡å¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªåº”ç”¨ç¨‹åºï¼Œæ¯ä¸ªç¨‹åºéƒ½éœ€è¦å ç”¨ä¸€ä¸ªå”¯ä¸€çš„ç«¯å£ã€‚</p>
<h4 data-id="heading-17">3.1 ç«¯å£åˆ†ç±»ï¼ˆæŒ‰ç”¨é€”åˆ’åˆ†ï¼‰</h4>





























<table><thead><tr><th>ç«¯å£èŒƒå›´</th><th>ç±»å‹</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>0~1023</td><td>å‘¨çŸ¥ç«¯å£</td><td>ç³»ç»Ÿé¢„å®šä¹‰ï¼Œè¢«çŸ¥ååº”ç”¨å ç”¨ï¼Œä¸å¯éšæ„ä½¿ç”¨</td><td>HTTPï¼ˆ80ï¼‰ã€FTPï¼ˆ21ï¼‰ã€HTTPSï¼ˆ443ï¼‰</td></tr><tr><td>1024~49151</td><td>æ³¨å†Œç«¯å£</td><td>ç”¨äºç”¨æˆ·å¼€å‘çš„åº”ç”¨ç¨‹åºï¼Œæ¨èä½¿ç”¨</td><td>Tomcaté»˜è®¤ç«¯å£ï¼ˆ8080ï¼‰ã€MySQLé»˜è®¤ç«¯å£ï¼ˆ3306ï¼‰</td></tr><tr><td>49152~65535</td><td>åŠ¨æ€ç«¯å£</td><td>ç³»ç»ŸåŠ¨æ€åˆ†é…ç»™ä¸´æ—¶è¿›ç¨‹ï¼Œæ— éœ€æ‰‹åŠ¨æŒ‡å®š</td><td>æµè§ˆå™¨è®¿é—®ç½‘é¡µæ—¶ä¸´æ—¶å ç”¨çš„ç«¯å£</td></tr></tbody></table>
<h4 data-id="heading-18">3.2 å¼€å‘æ³¨æ„äº‹é¡¹</h4>
<ul>
<li><strong>ç«¯å£å”¯ä¸€æ€§</strong>ï¼šåŒä¸€è®¾å¤‡ä¸Šï¼Œä¸¤ä¸ªåº”ç”¨ç¨‹åºä¸èƒ½å ç”¨åŒä¸€ä¸ªç«¯å£ï¼Œå¦åˆ™ä¼šæŠ›å‡º<code>BindException: Address already in use</code>ï¼ˆåœ°å€å·²è¢«å ç”¨ï¼‰å¼‚å¸¸ã€‚</li>
<li><strong>ç«¯å£é€‰æ‹©å»ºè®®</strong>ï¼šå¼€å‘è‡ªå®šä¹‰åº”ç”¨æ—¶ï¼Œä¼˜å…ˆé€‰æ‹©<code>1024~49151</code>èŒƒå›´å†…çš„ç«¯å£ï¼Œé¿å…ä¸å‘¨çŸ¥ç«¯å£å†²çªã€‚</li>
</ul>
<h3 data-id="heading-19">å››ã€åè®®ï¼šç½‘ç»œé€šä¿¡çš„â€œäº¤é€šè§„åˆ™â€</h3>
<p>åè®®ï¼ˆProtocolï¼‰æ˜¯è®¾å¤‡é—´é€šä¿¡çš„è§„åˆ™é›†åˆï¼Œè§„å®šäº†æ•°æ®çš„ä¼ è¾“æ ¼å¼ã€é€Ÿç‡ã€å‡ºé”™å¤„ç†ã€äº¤äº’é€»è¾‘ç­‰ã€‚æ²¡æœ‰åè®®ï¼Œè®¾å¤‡é—´çš„é€šä¿¡å°±ä¼šæ··ä¹±æ— åºï¼ˆæ¯”å¦‚ç”²è®¾å¤‡å‘é€â€œäºŒè¿›åˆ¶æ•°æ®â€ï¼Œä¹™è®¾å¤‡å´æŒ‰â€œæ–‡æœ¬æ ¼å¼â€è§£æï¼Œå¿…ç„¶å¯¼è‡´æ•°æ®é”™ä¹±ï¼‰ã€‚</p>
<h4 data-id="heading-20">4.1 ä¸¤å¤§ç½‘ç»œæ¨¡å‹ï¼ˆåè®®åˆ†å±‚è®¾è®¡ï¼‰</h4>
<p>ç½‘ç»œåè®®é‡‡ç”¨åˆ†å±‚è®¾è®¡ï¼Œæ ¸å¿ƒåˆ†ä¸ºä¸¤ç§æ¨¡å‹ï¼ˆå®é™…å¼€å‘ä¸­ä»¥TCP/IPæ¨¡å‹ä¸ºä¸»ï¼‰ï¼š</p>



































<table><thead><tr><th>OSIç½‘ç»œå‚è€ƒæ¨¡å‹ï¼ˆç†è®ºæ ‡å‡†ï¼‰</th><th>TCP/IPç½‘ç»œæ¨¡å‹ï¼ˆå®é™…æ ‡å‡†ï¼‰</th><th>æ ¸å¿ƒä½œç”¨</th><th>å¼€å‘è€…å…³æ³¨é‡ç‚¹</th></tr></thead><tbody><tr><td>åº”ç”¨å±‚ã€è¡¨ç¤ºå±‚ã€ä¼šè¯å±‚</td><td>åº”ç”¨å±‚</td><td>æä¾›åº”ç”¨ç¨‹åºæ¥å£ï¼ˆå¦‚HTTPã€FTPã€SMTPï¼‰</td><td>å¼€å‘æ—¶ç›´æ¥ä½¿ç”¨ï¼ˆå¦‚è°ƒç”¨HTTPæ¥å£ï¼‰</td></tr><tr><td>ä¼ è¾“å±‚</td><td>ä¼ è¾“å±‚</td><td>è´Ÿè´£ç«¯åˆ°ç«¯çš„æ•°æ®ä¼ è¾“ï¼ˆTCP/UDPåè®®ï¼‰</td><td>é€‰æ‹©TCPæˆ–UDPåè®®</td></tr><tr><td>ç½‘ç»œå±‚</td><td>ç½‘ç»œå±‚</td><td>å°è£…IPåœ°å€ï¼Œå®ç°è·¯ç”±è½¬å‘</td><td>æ— éœ€å…³æ³¨ï¼ˆç”±ç³»ç»Ÿå¤„ç†ï¼‰</td></tr><tr><td>æ•°æ®é“¾è·¯å±‚ã€ç‰©ç†å±‚</td><td>æ•°æ®é“¾è·¯å±‚+ç‰©ç†å±‚</td><td>å¤„ç†æ¯”ç‰¹æµä¼ è¾“ï¼ˆç¡¬ä»¶å±‚é¢ï¼Œå¦‚ç½‘çº¿ã€ç½‘å¡ï¼‰</td><td>æ— éœ€å…³æ³¨ï¼ˆç”±ç¡¬ä»¶å¤„ç†ï¼‰</td></tr></tbody></table>
<h4 data-id="heading-21">4.2 ä¼ è¾“å±‚æ ¸å¿ƒåè®®ï¼šTCPä¸UDPï¼ˆé‡ç‚¹ï¼‰</h4>
<p>ä¼ è¾“å±‚æœ‰ä¸¤ä¸ªæ ¸å¿ƒåè®®ï¼Œé€‚ç”¨åœºæ™¯æˆªç„¶ä¸åŒï¼Œå¼€å‘æ—¶éœ€æ ¹æ®éœ€æ±‚é€‰æ‹©ï¼š</p>
<h5 data-id="heading-22">1. UDPï¼ˆç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼‰ï¼šè¿½æ±‚æ•ˆç‡ï¼Œç‰ºç‰²å¯é æ€§</h5>
<ul>
<li><strong>æ ¸å¿ƒç‰¹ç‚¹</strong>ï¼šæ— è¿æ¥ã€ä¸å¯é ã€æ•ˆç‡é«˜ã€æ•°æ®æœ‰é™åˆ¶ã€‚</li>
</ul>

<ul>
<li>
<ul>
<li>æ— è¿æ¥ï¼šé€šä¿¡å‰æ— éœ€å»ºç«‹è¿æ¥ï¼Œç›´æ¥å‘é€æ•°æ®ï¼ˆç±»ä¼¼â€œå‘çŸ­ä¿¡â€ï¼Œæ— éœ€å¯¹æ–¹ç¡®è®¤å¼€æœºå³å¯å‘é€ï¼‰ã€‚</li>
<li>ä¸å¯é ï¼šä¸ä¿è¯æ•°æ®ä¸€å®šé€è¾¾ï¼Œæ•°æ®ä¸¢å¤±ä¸é‡ä¼ ï¼Œæ¥æ”¶æ–¹ä¹Ÿä¸åé¦ˆç¡®è®¤ä¿¡æ¯ã€‚</li>
<li>æ•°æ®é™åˆ¶ï¼šå•åŒ…æ•°æ®æœ€å¤§64KBã€‚</li>
</ul>
</li>
</ul>

<ul>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå¯¹å®æ—¶æ€§è¦æ±‚é«˜ã€å¯å®¹å¿å°‘é‡æ•°æ®ä¸¢å¤±çš„åœºæ™¯ï¼Œä¾‹å¦‚ï¼šè§†é¢‘ç›´æ’­ã€è¯­éŸ³é€šè¯ã€ç½‘ç»œæ¸¸æˆã€ç‰©è”ç½‘æ•°æ®é‡‡é›†ã€‚</li>
</ul>
<h5 data-id="heading-23">2. TCPï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰ï¼šè¿½æ±‚å¯é ï¼Œç‰ºç‰²æ•ˆç‡</h5>
<ul>
<li><strong>æ ¸å¿ƒç‰¹ç‚¹</strong>ï¼šé¢å‘è¿æ¥ã€å¯é ä¼ è¾“ã€æ•ˆç‡è¾ƒä½ã€æ— æ•°æ®å¤§å°é™åˆ¶ã€‚</li>
<li><strong>å¯é ä¼ è¾“å®ç°æœºåˆ¶</strong>ï¼š</li>
</ul>
<ol>
<li>
<ol>
<li>ä¸‰æ¬¡æ¡æ‰‹ï¼šå»ºç«‹è¿æ¥ï¼Œç¡®ä¿åŒæ–¹æ”¶å‘èƒ½åŠ›æ­£å¸¸ï¼ˆç±»ä¼¼â€œæ‰“ç”µè¯â€ï¼šç”²â†’â€œå–‚ï¼Œèƒ½å¬åˆ°å—ï¼Ÿâ€â†’ä¹™â†’â€œèƒ½å¬åˆ°ï¼Œä½ å‘¢ï¼Ÿâ€â†’ç”²â†’â€œæˆ‘ä¹Ÿèƒ½å¬åˆ°ï¼Œå¼€å§‹èŠå§â€ï¼‰ã€‚</li>
<li>æ•°æ®ç¡®è®¤ï¼šæ¯å‘é€ä¸€åŒ…æ•°æ®ï¼Œæ¥æ”¶æ–¹éœ€è¿”å›â€œACKç¡®è®¤ä¿¡å·â€ï¼Œæœªæ”¶åˆ°åˆ™é‡ä¼ ã€‚</li>
<li>å››æ¬¡æŒ¥æ‰‹ï¼šæ–­å¼€è¿æ¥ï¼Œç¡®ä¿åŒæ–¹æ•°æ®éƒ½å·²ä¼ è¾“å®Œæˆï¼ˆé¿å…æ•°æ®æ®‹ç•™ï¼‰ã€‚</li>
</ol>
</li>
</ol>
<ul>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå¯¹å¯é æ€§è¦æ±‚é«˜çš„åœºæ™¯ï¼Œä¾‹å¦‚ï¼šç½‘é¡µæµè§ˆã€æ–‡ä»¶ä¸‹è½½ã€æ”¯ä»˜è½¬è´¦ã€é‚®ä»¶å‘é€ã€å³æ—¶é€šè®¯çš„æ–‡å­—æ¶ˆæ¯ã€‚</li>
</ul>
<h3 data-id="heading-24">äº”ã€æ€»ç»“ï¼šç½‘ç»œç¼–ç¨‹çš„æ ¸å¿ƒé€»è¾‘ä¸å­¦ä¹ è·¯å¾„</h3>
<h4 data-id="heading-25">5.1 ä¸‰è¦ç´ çš„æ ¸å¿ƒé€»è¾‘</h4>
<p>ç½‘ç»œç¼–ç¨‹çš„æœ¬è´¨ï¼Œæ˜¯é€šè¿‡â€œä¸‰å±‚å®šä½â€å®ç°æ•°æ®äº¤äº’ï¼š</p>
<ol>
<li><strong>IPå®šä½è®¾å¤‡</strong>ï¼šè§£å†³â€œå’Œè°é€šä¿¡â€çš„é—®é¢˜ï¼ˆæ‰¾åˆ°ç›®æ ‡è®¾å¤‡ï¼‰ã€‚</li>
<li><strong>ç«¯å£å®šä½åº”ç”¨</strong>ï¼šè§£å†³â€œå’Œå¯¹æ–¹å“ªä¸ªç¨‹åºé€šä¿¡â€çš„é—®é¢˜ï¼ˆæ‰¾åˆ°è®¾å¤‡ä¸Šçš„ç›®æ ‡åº”ç”¨ï¼‰ã€‚</li>
<li><strong>åè®®è§„èŒƒä¼ è¾“</strong>ï¼šè§£å†³â€œæ€ä¹ˆé€šä¿¡â€çš„é—®é¢˜ï¼ˆç¡®ä¿æ•°æ®æ­£ç¡®ä¼ é€’ï¼‰ã€‚</li>
</ol>
<h4 data-id="heading-26">5.2 åç»­å­¦ä¹ è·¯å¾„</h4>
<p>æœ¬æ–‡è®²è§£çš„æ˜¯Javaç½‘ç»œç¼–ç¨‹çš„åŸºç¡€ï¼ŒæŒæ¡åå¯è¿›ä¸€æ­¥å­¦ä¹ ï¼š</p>
<ol>
<li>TCPé€šä¿¡å®æˆ˜ï¼šä½¿ç”¨<code>Socket</code>ï¼ˆå®¢æˆ·ç«¯ï¼‰å’Œ<code>ServerSocket</code>ï¼ˆæœåŠ¡ç«¯ï¼‰å®ç°åŒå‘é€šä¿¡ã€‚</li>
<li>UDPé€šä¿¡å®æˆ˜ï¼šä½¿ç”¨<code>DatagramSocket</code>å’Œ<code>DatagramPacket</code>å®ç°æ•°æ®æŠ¥ä¼ è¾“ã€‚</li>
<li>åº”ç”¨å±‚åè®®ï¼šå­¦ä¹ HTTPã€FTPç­‰åè®®çš„ä½¿ç”¨ï¼ˆç»“åˆ<code>java.net.HttpURLConnection</code>æˆ–Spring Bootå¼€å‘æ¥å£ï¼‰ã€‚</li>
<li>é«˜çº§ä¸»é¢˜ï¼šNIOã€Nettyæ¡†æ¶ï¼ˆé«˜æ€§èƒ½ç½‘ç»œç¼–ç¨‹ï¼‰ã€åˆ†å¸ƒå¼é€šä¿¡ï¼ˆå¦‚RPCï¼‰ã€‚</li>
</ol>
<p>å¦‚æœæœ¬æ–‡å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµæ”¶è—ï½ åç»­ä¼šæŒç»­æ›´æ–°Javaç½‘ç»œç¼–ç¨‹å®æˆ˜æ•™ç¨‹ï¼Œæ•¬è¯·å…³æ³¨ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Nacosé€‚ç”¨Postgresqlæ”¹é€ è®°å½•]]></title>    <link>https://juejin.cn/post/7582955784569847859</link>    <guid>https://juejin.cn/post/7582955784569847859</guid>    <pubDate>2025-12-13T15:41:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582955784569847859" data-draft-id="7582905804048121883" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Nacosé€‚ç”¨Postgresqlæ”¹é€ è®°å½•"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-13T15:41:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="sptan"/> <meta itemprop="url" content="https://juejin.cn/user/2365804751362909"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Nacosé€‚ç”¨Postgresqlæ”¹é€ è®°å½•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2365804751362909/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    sptan
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T15:41:25.000Z" title="Sat Dec 13 2025 15:41:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä»nacoså®˜ç½‘forkå‡ºæ¥ï¼Œé‡‡ç”¨åˆ†æ”¯ä¸ºv2.x-developã€‚</p>
<p>forkåçš„gitåœ°å€ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsptan%2Fnacos" target="_blank" title="https://github.com/sptan/nacos" ref="nofollow noopener noreferrer">github.com/sptan/nacos</a></p>
<h2 data-id="heading-0">æ·»åŠ postgresqlä¾èµ–</h2>
<p>åœ¨é¡¹ç›®çš„xmlæ–‡ä»¶ä¸­å…¨å±€æœç´¢mysqlï¼Œæœ‰mysql çš„åœ°æ–¹å°±åŠ ä¸Špostgresqlçš„é©±åŠ¨ã€‚</p>
<h3 data-id="heading-1">pom.xml</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/001567295d394bbeaef29aea3ce6cd40~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=muo7Xw6Q%2Fj769y78ipvN08XGxJI%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c668847868247a98c2aafe21d0866c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=CMcwgsFdPUJeMaanzGFlRot%2FVY4%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-2">persistence/pom.xml</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83fac418239441c68af0c1269e7170d2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=lIlXuLq2UBUnq%2Bysg8aQirvddUg%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">naming/pom.xml</h3>
<p>è¿™ä¸ªå¥½åƒä¸å¼•äººä¹Ÿè¡Œï¼Œä¸è¿‡æœ¬ç€è®©postgresqlä¸mysqlå¹³çº§çš„å¾…é‡ï¼Œå°±ä¸€å—åŠ ä¸Šå§ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f1f316c87664bbbb83609448a2cab04~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=DvGwMmYn9oxjaqWzCfdkAwrHeyk%3D" alt="" loading="lazy"/></p>
<p>å¼•å…¥é©±åŠ¨åï¼Œä»£ç å˜åŠ¨æƒ…å†µå¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02c6be23304c4e378bc43ec760ec2071~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=3La%2BfEu4QNj0tKLPiKEBNfWOW1c%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">nacos-persistenceæ¨¡å—æ”¹é€ </h2>
<p>åœ¨è¿™ä¸ªæ¨¡å—ä¸­æœç´¢mysqlï¼Œåœ¨mysqlé™„è¿‘å¢åŠ postgresqlçš„å¸¸é‡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6c6cfba317d94971b8df778828098dbb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=Is9hNqGzJCwywyFLc2X2AeI885s%3D" alt="" loading="lazy"/></p>
<p>å¤–éƒ¨DataSourceç›®å‰å›ºå®šä¸ºmysqlï¼Œéœ€è¦ä¿®æ”¹ä¸ºå¯é…ç½®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/63c95592bc034d3981820356f3528025~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=YB0fzT5PN5%2BoEVXcIQqr033z0yU%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3717c30a98484d1796d466e4c6782204~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=%2FnXmQoFQgBLjE95WBsYLlyJkWLs%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">nacos-pluginæ¨¡å—æ”¹é€ </h2>
<p>è¿™æ˜¯æ”¹åŠ¨æ¯”è¾ƒå¤šçš„æ¨¡å—ï¼Œéœ€è¦åŠ å…¥postgresqlå¯¹åº”çš„å®ç°ï¼Œæˆ‘ä¸»è¦æ˜¯ä»mysqlå¤åˆ¶è¿‡æ¥çš„ï¼Œå·®å¼‚æ¯”è¾ƒå¤§çš„ä¸»è¦æ˜¯åˆ†é¡µä¸åŒã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9eeb053104af42d8b33e0071a840d979~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=HHo5Sh%2FBdWJqq5XTGnKJjN2qIsI%3D" alt="" loading="lazy"/></p>
<p>DataSourceConstantçš„ä»£ç ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/09f9bfce769a41069b0c2ede0d1e6bbe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=Mh2uRzvBvdIzWLYueFgMj9W4s9E%3D" alt="" loading="lazy"/></p>
<p>TrustedPostgresqlFunctionEnumçš„ä»£ç </p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db8b60b274664a3d866641d0c909a13c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=EwsMdchqiqPnRxBEpPdJ3BPB%2FRA%3D" alt="" loading="lazy"/></p>
<p>å„ä¸ªè¡¨çš„è®¿é—®ç±»çš„ä»£ç ç¤ºä¾‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84f9e1cbae9744cc9f4e89a3933a1123~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=du32x1TL%2BP7XFW%2FqDL420XVmGpw%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ff733f8f0cd4ce2b6d110ed322e62de~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=VUhILW9jwRRRXm3fP2C4fqUO5sY%3D" alt="" loading="lazy"/></p>
<p>ä¸»è¦æ˜¯è®°å¾—ä»¥ä¸‹å‡ é¡¹ä¿®æ”¹ï¼š</p>
<ol>
<li>sqlä¸­çš„åˆ†é¡µ</li>
<li>DataSource</li>
<li>where.limitæ”¹ä¸ºwhere.limitPG</li>
</ol>
<p>å„ä¸ªå®ç°ç±»çš„éƒ½é›·åŒã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e15934fbe7c4fd0ba89bb055f467357~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=Ab%2Fa3Z%2Fz7jwC2aPPhdwyxx0BlxE%3D" alt="" loading="lazy"/></p>
<p>è¿™ä¸ªè¦åŠ ä¸€ä¸‹ï¼Œå¦åˆ™Mapçš„å®ç°ç±»æ‰¾ä¸åˆ°postgresqlçš„ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/51c706a0a7a54705864014ade1385a0e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=llm0SBIA5HB1nw2MejhlB6g97Mo%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-6">default-auth-pluginæ¨¡å—æ”¹é€ </h2>
<ol>
<li>æ·»åŠ postgresqlé€‚ç”¨çš„OFFSET_LIMITå¸¸é‡</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b778d08625845778d4e2b9a0e4e93cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=kvC5SitTPOM6dBiokEPvapILwF8%3D" alt="" loading="lazy"/></p>
<ol start="2">
<li>å¢åŠ postgresqlåˆ†é¡µé€‚é…å™¨</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/23c4139b22db4915bf609ef5d7ac7a2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=hZMTlGWREpfX75%2B7phP36OL1GAA%3D" alt="" loading="lazy"/></p>
<ol start="3">
<li>é€‚é…å™¨å·¥å‚ä¸­å¢åŠ postgresqlåˆ†é¡µé€‚é…å™¨</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/86b5c12dad704c8abc2f0c4bfeb58871~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=TdUwrQpqcceDYpJaJGMe8KtPYHE%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">åœ¨PGä¸­å»ºç«‹nacosæ•°æ®åº“åŠè¡¨</h2>
<p>å»ºè¡¨è¯­å¥å¦‚ä¸‹</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">/*
 * Copyright 1999-2018 Alibaba Group Holding Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</span>

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Table structure for config_info</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> "his_config_info";
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> "his_config_info" (
  "id" int8 <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "nid" bigserial <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "data_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "group_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "app_name" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>) ,
  "content" text  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "md5" <span class="hljs-type">varchar</span>(<span class="hljs-number">32</span>) ,
  "gmt_create" <span class="hljs-type">timestamp</span>(<span class="hljs-number">6</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>  <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'2010-05-05 00:00:00'</span>,
  "gmt_modified" <span class="hljs-type">timestamp</span>(<span class="hljs-number">6</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "src_user" text ,
  "src_ip" <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>) ,
  "op_type" <span class="hljs-type">char</span>(<span class="hljs-number">10</span>) ,
  "publish_type" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>),
  "gray_name" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>),
  "ext_info" text,
  "tenant_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>) ,
  "encrypted_data_key" text  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
)
;

COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info"."id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info"."data_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'data_id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info"."content" <span class="hljs-keyword">IS</span> <span class="hljs-string">'content'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info"."md5" <span class="hljs-keyword">IS</span> <span class="hljs-string">'md5'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info"."gmt_create" <span class="hljs-keyword">IS</span> <span class="hljs-string">'åˆ›å»ºæ—¶é—´'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info"."gmt_modified" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ä¿®æ”¹æ—¶é—´'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info"."src_user" <span class="hljs-keyword">IS</span> <span class="hljs-string">'source user'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info"."src_ip" <span class="hljs-keyword">IS</span> <span class="hljs-string">'source ip'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info"."tenant_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ç§Ÿæˆ·å­—æ®µ'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info"."encrypted_data_key" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ç§˜é’¥'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> "config_info" <span class="hljs-keyword">IS</span> <span class="hljs-string">'config_info'</span>;


<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Table structure for config_info_aggr</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> "config_info_aggr";
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> "config_info_aggr" (
  "id" bigserial <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "data_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "group_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "datum_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "content" text  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "gmt_modified" <span class="hljs-type">timestamp</span>(<span class="hljs-number">6</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "app_name" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>) ,
  "tenant_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>) 
)
;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_aggr"."id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_aggr"."data_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'data_id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_aggr"."group_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'group_id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_aggr"."datum_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'datum_id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_aggr"."content" <span class="hljs-keyword">IS</span> <span class="hljs-string">'å†…å®¹'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_aggr"."gmt_modified" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ä¿®æ”¹æ—¶é—´'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_aggr"."tenant_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ç§Ÿæˆ·å­—æ®µ'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> "config_info_aggr" <span class="hljs-keyword">IS</span> <span class="hljs-string">'å¢åŠ ç§Ÿæˆ·å­—æ®µ'</span>;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Records of config_info_aggr</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">BEGIN</span>;
<span class="hljs-keyword">COMMIT</span>;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Table structure for config_info_beta</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> "config_info_beta";
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> "config_info_beta" (
  "id" bigserial <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "data_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "group_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "app_name" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>) ,
  "content" text  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "beta_ips" <span class="hljs-type">varchar</span>(<span class="hljs-number">1024</span>) ,
  "md5" <span class="hljs-type">varchar</span>(<span class="hljs-number">32</span>) ,
  "gmt_create" <span class="hljs-type">timestamp</span>(<span class="hljs-number">6</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "gmt_modified" <span class="hljs-type">timestamp</span>(<span class="hljs-number">6</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "src_user" text ,
  "src_ip" <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>) ,
  "tenant_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>) ,
  "encrypted_data_key" text  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
)
;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_beta"."id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_beta"."data_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'data_id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_beta"."group_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'group_id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_beta"."app_name" <span class="hljs-keyword">IS</span> <span class="hljs-string">'app_name'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_beta"."content" <span class="hljs-keyword">IS</span> <span class="hljs-string">'content'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_beta"."beta_ips" <span class="hljs-keyword">IS</span> <span class="hljs-string">'betaIps'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_beta"."md5" <span class="hljs-keyword">IS</span> <span class="hljs-string">'md5'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_beta"."gmt_create" <span class="hljs-keyword">IS</span> <span class="hljs-string">'åˆ›å»ºæ—¶é—´'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_beta"."gmt_modified" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ä¿®æ”¹æ—¶é—´'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_beta"."src_user" <span class="hljs-keyword">IS</span> <span class="hljs-string">'source user'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_beta"."src_ip" <span class="hljs-keyword">IS</span> <span class="hljs-string">'source ip'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_beta"."tenant_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ç§Ÿæˆ·å­—æ®µ'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_beta"."encrypted_data_key" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ç§˜é’¥'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> "config_info_beta" <span class="hljs-keyword">IS</span> <span class="hljs-string">'config_info_beta'</span>;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Records of config_info_beta</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">BEGIN</span>;
<span class="hljs-keyword">COMMIT</span>;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Table structure for config_info_tag</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> "config_info_tag";
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> "config_info_tag" (
  "id" bigserial <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "data_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "group_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "tenant_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>) ,
  "tag_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "app_name" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>) ,
  "content" text  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "md5" <span class="hljs-type">varchar</span>(<span class="hljs-number">32</span>) ,
  "gmt_create" <span class="hljs-type">timestamp</span>(<span class="hljs-number">6</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "gmt_modified" <span class="hljs-type">timestamp</span>(<span class="hljs-number">6</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "src_user" text ,
  "src_ip" <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>) 
)
;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_tag"."id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_tag"."data_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'data_id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_tag"."group_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'group_id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_tag"."tenant_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'tenant_id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_tag"."tag_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'tag_id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_tag"."app_name" <span class="hljs-keyword">IS</span> <span class="hljs-string">'app_name'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_tag"."content" <span class="hljs-keyword">IS</span> <span class="hljs-string">'content'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_tag"."md5" <span class="hljs-keyword">IS</span> <span class="hljs-string">'md5'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_tag"."gmt_create" <span class="hljs-keyword">IS</span> <span class="hljs-string">'åˆ›å»ºæ—¶é—´'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_tag"."gmt_modified" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ä¿®æ”¹æ—¶é—´'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_tag"."src_user" <span class="hljs-keyword">IS</span> <span class="hljs-string">'source user'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_info_tag"."src_ip" <span class="hljs-keyword">IS</span> <span class="hljs-string">'source ip'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> "config_info_tag" <span class="hljs-keyword">IS</span> <span class="hljs-string">'config_info_tag'</span>;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Records of config_info_tag</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">BEGIN</span>;
<span class="hljs-keyword">COMMIT</span>;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Table structure for config_tags_relation</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> "config_tags_relation";
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> "config_tags_relation" (
  "id" bigserial <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "tag_name" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "tag_type" <span class="hljs-type">varchar</span>(<span class="hljs-number">64</span>) ,
  "data_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "group_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "tenant_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>) ,
  "nid" bigserial <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
)
;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_tags_relation"."id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_tags_relation"."tag_name" <span class="hljs-keyword">IS</span> <span class="hljs-string">'tag_name'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_tags_relation"."tag_type" <span class="hljs-keyword">IS</span> <span class="hljs-string">'tag_type'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_tags_relation"."data_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'data_id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_tags_relation"."group_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'group_id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "config_tags_relation"."tenant_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'tenant_id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> "config_tags_relation" <span class="hljs-keyword">IS</span> <span class="hljs-string">'config_tag_relation'</span>;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Records of config_tags_relation</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">BEGIN</span>;
<span class="hljs-keyword">COMMIT</span>;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Table structure for group_capacity</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> "group_capacity";
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> "group_capacity" (
  "id" bigserial <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "group_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "quota" int4 <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "usage" int4 <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "max_size" int4 <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "max_aggr_count" int4 <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "max_aggr_size" int4 <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "max_history_count" int4 <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "gmt_create" <span class="hljs-type">timestamp</span>(<span class="hljs-number">6</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "gmt_modified" <span class="hljs-type">timestamp</span>(<span class="hljs-number">6</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
)
;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "group_capacity"."id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ä¸»é”®ID'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "group_capacity"."group_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'Group IDï¼Œç©ºå­—ç¬¦è¡¨ç¤ºæ•´ä¸ªé›†ç¾¤'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "group_capacity"."quota" <span class="hljs-keyword">IS</span> <span class="hljs-string">'é…é¢ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "group_capacity"."usage" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ä½¿ç”¨é‡'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "group_capacity"."max_size" <span class="hljs-keyword">IS</span> <span class="hljs-string">'å•ä¸ªé…ç½®å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "group_capacity"."max_aggr_count" <span class="hljs-keyword">IS</span> <span class="hljs-string">'èšåˆå­é…ç½®æœ€å¤§ä¸ªæ•°ï¼Œï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "group_capacity"."max_aggr_size" <span class="hljs-keyword">IS</span> <span class="hljs-string">'å•ä¸ªèšåˆæ•°æ®çš„å­é…ç½®å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "group_capacity"."max_history_count" <span class="hljs-keyword">IS</span> <span class="hljs-string">'æœ€å¤§å˜æ›´å†å²æ•°é‡'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "group_capacity"."gmt_create" <span class="hljs-keyword">IS</span> <span class="hljs-string">'åˆ›å»ºæ—¶é—´'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "group_capacity"."gmt_modified" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ä¿®æ”¹æ—¶é—´'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> "group_capacity" <span class="hljs-keyword">IS</span> <span class="hljs-string">'é›†ç¾¤ã€å„Groupå®¹é‡ä¿¡æ¯è¡¨'</span>;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Records of group_capacity</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">BEGIN</span>;
<span class="hljs-keyword">COMMIT</span>;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Table structure for his_config_info</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> "his_config_info";
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> "his_config_info" (
  "id" int8 <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "nid" bigserial <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "data_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "group_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "app_name" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>) ,
  "content" text  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "md5" <span class="hljs-type">varchar</span>(<span class="hljs-number">32</span>) ,
  "gmt_create" <span class="hljs-type">timestamp</span>(<span class="hljs-number">6</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>  <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'2010-05-05 00:00:00'</span>,
  "gmt_modified" <span class="hljs-type">timestamp</span>(<span class="hljs-number">6</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "src_user" text ,
  "src_ip" <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>) ,
  "op_type" <span class="hljs-type">char</span>(<span class="hljs-number">10</span>) ,
  "publish_type" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>),
  "tenant_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>) ,
  "encrypted_data_key" text  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
)
;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "his_config_info"."app_name" <span class="hljs-keyword">IS</span> <span class="hljs-string">'app_name'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "his_config_info"."tenant_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ç§Ÿæˆ·å­—æ®µ'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "his_config_info"."encrypted_data_key" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ç§˜é’¥'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> "his_config_info" <span class="hljs-keyword">IS</span> <span class="hljs-string">'å¤šç§Ÿæˆ·æ”¹é€ '</span>;


<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Table structure for permissions</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> "permissions";
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> "permissions" (
  "role" <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "resource" <span class="hljs-type">varchar</span>(<span class="hljs-number">512</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "action" <span class="hljs-type">varchar</span>(<span class="hljs-number">8</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
)
;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Records of permissions</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">BEGIN</span>;
<span class="hljs-keyword">COMMIT</span>;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Table structure for roles</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> "roles";
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> "roles" (
  "username" <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "role" <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
)
;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Records of roles</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">BEGIN</span>;
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> "roles" <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'nacos'</span>, <span class="hljs-string">'ROLE_ADMIN'</span>);
<span class="hljs-keyword">COMMIT</span>;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Table structure for tenant_capacity</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> "tenant_capacity";
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> "tenant_capacity" (
  "id" bigserial <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "tenant_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "quota" int4 <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "usage" int4 <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "max_size" int4 <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "max_aggr_count" int4 <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "max_aggr_size" int4 <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "max_history_count" int4 <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "gmt_create" <span class="hljs-type">timestamp</span>(<span class="hljs-number">6</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "gmt_modified" <span class="hljs-type">timestamp</span>(<span class="hljs-number">6</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
)
;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "tenant_capacity"."id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ä¸»é”®ID'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "tenant_capacity"."tenant_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'Tenant ID'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "tenant_capacity"."quota" <span class="hljs-keyword">IS</span> <span class="hljs-string">'é…é¢ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "tenant_capacity"."usage" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ä½¿ç”¨é‡'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "tenant_capacity"."max_size" <span class="hljs-keyword">IS</span> <span class="hljs-string">'å•ä¸ªé…ç½®å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "tenant_capacity"."max_aggr_count" <span class="hljs-keyword">IS</span> <span class="hljs-string">'èšåˆå­é…ç½®æœ€å¤§ä¸ªæ•°'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "tenant_capacity"."max_aggr_size" <span class="hljs-keyword">IS</span> <span class="hljs-string">'å•ä¸ªèšåˆæ•°æ®çš„å­é…ç½®å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "tenant_capacity"."max_history_count" <span class="hljs-keyword">IS</span> <span class="hljs-string">'æœ€å¤§å˜æ›´å†å²æ•°é‡'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "tenant_capacity"."gmt_create" <span class="hljs-keyword">IS</span> <span class="hljs-string">'åˆ›å»ºæ—¶é—´'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "tenant_capacity"."gmt_modified" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ä¿®æ”¹æ—¶é—´'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> "tenant_capacity" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ç§Ÿæˆ·å®¹é‡ä¿¡æ¯è¡¨'</span>;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Records of tenant_capacity</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">BEGIN</span>;
<span class="hljs-keyword">COMMIT</span>;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Table structure for tenant_info</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> "tenant_info";
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> "tenant_info" (
  "id" bigserial <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "kp" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "tenant_id" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>) ,
  "tenant_name" <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>) ,
  "tenant_desc" <span class="hljs-type">varchar</span>(<span class="hljs-number">256</span>) ,
  "create_source" <span class="hljs-type">varchar</span>(<span class="hljs-number">32</span>) ,
  "gmt_create" int8 <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "gmt_modified" int8 <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
)
;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "tenant_info"."id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "tenant_info"."kp" <span class="hljs-keyword">IS</span> <span class="hljs-string">'kp'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "tenant_info"."tenant_id" <span class="hljs-keyword">IS</span> <span class="hljs-string">'tenant_id'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "tenant_info"."tenant_name" <span class="hljs-keyword">IS</span> <span class="hljs-string">'tenant_name'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "tenant_info"."tenant_desc" <span class="hljs-keyword">IS</span> <span class="hljs-string">'tenant_desc'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "tenant_info"."create_source" <span class="hljs-keyword">IS</span> <span class="hljs-string">'create_source'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "tenant_info"."gmt_create" <span class="hljs-keyword">IS</span> <span class="hljs-string">'åˆ›å»ºæ—¶é—´'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">COLUMN</span> "tenant_info"."gmt_modified" <span class="hljs-keyword">IS</span> <span class="hljs-string">'ä¿®æ”¹æ—¶é—´'</span>;
COMMENT <span class="hljs-keyword">ON</span> <span class="hljs-keyword">TABLE</span> "tenant_info" <span class="hljs-keyword">IS</span> <span class="hljs-string">'tenant_info'</span>;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Records of tenant_info</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">BEGIN</span>;
<span class="hljs-keyword">COMMIT</span>;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Table structure for users</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> "users";
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> "users" (
  "username" <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "password" <span class="hljs-type">varchar</span>(<span class="hljs-number">500</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  "enabled" <span class="hljs-type">boolean</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
)
;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Records of users</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">BEGIN</span>;
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> "users" <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'nacos'</span>, <span class="hljs-string">'$2a$10$EuWPZHzz32dJN7jexM34MOeYirDdFAZm2kuWj7VEOJhhZkDrxfvUu'</span>, <span class="hljs-literal">TRUE</span>);
<span class="hljs-keyword">COMMIT</span>;

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Indexes structure for table config_info</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> INDEX "uk_configinfo_datagrouptenant" <span class="hljs-keyword">ON</span> "config_info" ("data_id","group_id","tenant_id");

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Primary Key structure for table config_info</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> "config_info" <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">CONSTRAINT</span> "config_info_pkey" <span class="hljs-keyword">PRIMARY</span> KEY ("id");

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Indexes structure for table config_info_aggr</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> INDEX "uk_configinfoaggr_datagrouptenantdatum" <span class="hljs-keyword">ON</span> "config_info_aggr" <span class="hljs-keyword">USING</span> btree ("data_id","group_id","tenant_id","datum_id");

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Primary Key structure for table config_info_aggr</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> "config_info_aggr" <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">CONSTRAINT</span> "config_info_aggr_pkey" <span class="hljs-keyword">PRIMARY</span> KEY ("id");

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Indexes structure for table config_info_beta</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> INDEX "uk_configinfobeta_datagrouptenant" <span class="hljs-keyword">ON</span> "config_info_beta" <span class="hljs-keyword">USING</span> btree ("data_id","group_id","tenant_id");

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Primary Key structure for table config_info_beta</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> "config_info_beta" <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">CONSTRAINT</span> "config_info_beta_pkey" <span class="hljs-keyword">PRIMARY</span> KEY ("id");

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Indexes structure for table config_info_tag</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> INDEX "uk_configinfotag_datagrouptenanttag" <span class="hljs-keyword">ON</span> "config_info_tag" <span class="hljs-keyword">USING</span> btree ("data_id","group_id","tenant_id","tag_id");

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Primary Key structure for table config_info_tag</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> "config_info_tag" <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">CONSTRAINT</span> "config_info_tag_pkey" <span class="hljs-keyword">PRIMARY</span> KEY ("id");

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Indexes structure for table config_tags_relation</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">CREATE</span> INDEX "idx_tenant_id" <span class="hljs-keyword">ON</span> "config_tags_relation" <span class="hljs-keyword">USING</span> btree (
  "tenant_id"
);
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> INDEX "uk_configtagrelation_configidtag" <span class="hljs-keyword">ON</span> "config_tags_relation" <span class="hljs-keyword">USING</span> btree (
  "id",
  "tag_name",
  "tag_type"
);

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Primary Key structure for table config_tags_relation</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> "config_tags_relation" <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">CONSTRAINT</span> "config_tags_relation_pkey" <span class="hljs-keyword">PRIMARY</span> KEY ("nid");

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Indexes structure for table group_capacity</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> INDEX "uk_group_id" <span class="hljs-keyword">ON</span> "group_capacity" <span class="hljs-keyword">USING</span> btree (
  "group_id"
);

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Primary Key structure for table group_capacity</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> "group_capacity" <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">CONSTRAINT</span> "group_capacity_pkey" <span class="hljs-keyword">PRIMARY</span> KEY ("id");

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Indexes structure for table his_config_info</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">CREATE</span> INDEX "idx_did" <span class="hljs-keyword">ON</span> "his_config_info" <span class="hljs-keyword">USING</span> btree (
  "data_id"
);
<span class="hljs-keyword">CREATE</span> INDEX "idx_gmt_create" <span class="hljs-keyword">ON</span> "his_config_info" <span class="hljs-keyword">USING</span> btree (
  "gmt_create"
);
<span class="hljs-keyword">CREATE</span> INDEX "idx_gmt_modified" <span class="hljs-keyword">ON</span> "his_config_info" <span class="hljs-keyword">USING</span> btree (
  "gmt_modified"
);

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Primary Key structure for table his_config_info</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> "his_config_info" <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">CONSTRAINT</span> "his_config_info_pkey" <span class="hljs-keyword">PRIMARY</span> KEY ("nid");

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Indexes structure for table permissions</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> INDEX "uk_role_permission" <span class="hljs-keyword">ON</span> "permissions" <span class="hljs-keyword">USING</span> btree (
  "role",
  "resource",
  "action"
);

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Indexes structure for table roles</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> INDEX "uk_username_role" <span class="hljs-keyword">ON</span> "roles" <span class="hljs-keyword">USING</span> btree (
  "username",
  "role"
);

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Indexes structure for table tenant_capacity</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> INDEX "uk_tenant_id" <span class="hljs-keyword">ON</span> "tenant_capacity" <span class="hljs-keyword">USING</span> btree (
  "tenant_id"
);

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Primary Key structure for table tenant_capacity</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> "tenant_capacity" <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">CONSTRAINT</span> "tenant_capacity_pkey" <span class="hljs-keyword">PRIMARY</span> KEY ("id");

<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-comment">-- Indexes structure for table tenant_info</span>
<span class="hljs-comment">-- ----------------------------</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> INDEX "uk_tenant_info_kptenantid" <span class="hljs-keyword">ON</span> "tenant_info" <span class="hljs-keyword">USING</span> btree (
  "kp",
  "tenant_id"
);
</code></pre>
<p>ä¸Šé¢çš„SQLæ˜¯å®˜æ–¹çš„ï¼Œè«åæ²¡æœ‰config_info_grayçš„è¡¨ç»“æ„ï¼Œæˆ‘æ·»åŠ ä¸€ä¸ªï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- auto-generated definition</span>
<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> config_info_gray
(
    id                 serial
        <span class="hljs-keyword">primary</span> key,
    data_id            <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>)                           <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,
    group_id           <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>)                           <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,
    content            text                                   <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,
    md5                <span class="hljs-type">varchar</span>(<span class="hljs-number">32</span>)  <span class="hljs-keyword">default</span> <span class="hljs-keyword">NULL</span>::<span class="hljs-type">character</span> <span class="hljs-type">varying</span>,
    src_user           text,
    src_ip             <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">default</span> <span class="hljs-keyword">NULL</span>::<span class="hljs-type">character</span> <span class="hljs-type">varying</span>,
    gmt_create         <span class="hljs-type">timestamp</span>(<span class="hljs-number">3</span>) <span class="hljs-keyword">default</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,
    gmt_modified       <span class="hljs-type">timestamp</span>(<span class="hljs-number">3</span>) <span class="hljs-keyword">default</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,
    app_name           <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>) <span class="hljs-keyword">default</span> <span class="hljs-keyword">NULL</span>::<span class="hljs-type">character</span> <span class="hljs-type">varying</span>,
    tenant_id          <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>) <span class="hljs-keyword">default</span> <span class="hljs-string">''</span>::<span class="hljs-type">character</span> <span class="hljs-type">varying</span>,
    gray_name          <span class="hljs-type">varchar</span>(<span class="hljs-number">128</span>)                           <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,
    gray_rule          text                                   <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,
    encrypted_data_key <span class="hljs-type">varchar</span>(<span class="hljs-number">256</span>) <span class="hljs-keyword">default</span> <span class="hljs-string">''</span>::<span class="hljs-type">character</span> <span class="hljs-type">varying</span>
);

comment <span class="hljs-keyword">on</span> <span class="hljs-keyword">table</span> config_info_gray <span class="hljs-keyword">is</span> <span class="hljs-string">'config_info_gray'</span>;

<span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> config_info_gray
    owner <span class="hljs-keyword">to</span> liupeng;

<span class="hljs-keyword">create</span> <span class="hljs-keyword">unique</span> index uk_configinfogray_datagrouptenantgray
    <span class="hljs-keyword">on</span> config_info_gray (data_id, group_id, tenant_id, gray_name);

<span class="hljs-keyword">create</span> index idx_configinfogray_dataid_gmt_modified
    <span class="hljs-keyword">on</span> config_info_gray (data_id, gmt_modified);

<span class="hljs-keyword">create</span> index idx_configinfogray_gmt_modified
    <span class="hljs-keyword">on</span> config_info_gray (gmt_modified);
</code></pre>
<h2 data-id="heading-8">IDEä¸­è¿è¡Œçœ‹æ•ˆæœ</h2>
<p>Nacosä¸»ç±»åœ¨nacos-consoleæ¨¡å—ä¸­</p>
<p>ä¿®æ”¹application.propertiesé…ç½®æ–‡ä»¶</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#</span>
<span class="hljs-comment"># Copyright 1999-2018 Alibaba Group Holding Ltd.</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Licensed under the Apache License, Version 2.0 (the "License");</span>
<span class="hljs-comment"># you may not use this file except in compliance with the License.</span>
<span class="hljs-comment"># You may obtain a copy of the License at</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment">#      http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># Unless required by applicable law or agreed to in writing, software</span>
<span class="hljs-comment"># distributed under the License is distributed on an "AS IS" BASIS,</span>
<span class="hljs-comment"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="hljs-comment"># See the License for the specific language governing permissions and</span>
<span class="hljs-comment"># limitations under the License.</span>
<span class="hljs-comment">#</span>

<span class="hljs-comment">#*************** Spring Boot Related Configurations ***************#</span>
<span class="hljs-comment">### Default web context path:</span>
<span class="hljs-attr">server.servlet.contextPath</span>=/nacos
<span class="hljs-comment">### Include message field</span>
<span class="hljs-attr">server.error.include-message</span>=ALWAYS
<span class="hljs-comment">### Default web server port:</span>
<span class="hljs-attr">server.port</span>=<span class="hljs-number">8848</span>

<span class="hljs-comment">#*************** Network Related Configurations ***************#</span>
<span class="hljs-comment">### If prefer hostname over ip for Nacos server addresses in cluster.conf:</span>
<span class="hljs-comment"># nacos.inetutils.prefer-hostname-over-ip=false</span>

<span class="hljs-comment">### Specify local server's IP:</span>
<span class="hljs-comment"># nacos.inetutils.ip-address=</span>

<span class="hljs-comment">#*************** Config Module Related Configurations ***************#</span>
<span class="hljs-comment">### Deprecated configuration property, it is recommended to use `spring.sql.init.platform` replaced.</span>
<span class="hljs-comment">#spring.datasource.platform=postgresql</span>
<span class="hljs-comment"># nacos.plugin.datasource.log.enabled=true</span>
<span class="hljs-attr">spring.sql.init.platform</span>=postgresql
<span class="hljs-comment">### Count of DB:</span>
<span class="hljs-attr">db.num</span>=<span class="hljs-number">1</span>

<span class="hljs-comment">### Connect URL of DB:</span>
<span class="hljs-comment"># db.url.0=jdbc:mysql://127.0.0.1:3306/nacos?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=UTC</span>
<span class="hljs-comment"># db.user=nacos</span>
<span class="hljs-comment"># db.password=nacos</span>

<span class="hljs-attr">db.url.0</span>=jdbc:postgresql://<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">5432</span>/nacos
<span class="hljs-attr">db.user</span>=liupeng
<span class="hljs-attr">db.password</span>=<span class="hljs-number">123456</span>

<span class="hljs-comment">### Connection pool configuration: hikariCP</span>
<span class="hljs-attr">db.pool.config.driverClassName</span>=org.postgresql.Driver
<span class="hljs-attr">db.pool.config.connectionTimeout</span>=<span class="hljs-number">30000</span>
<span class="hljs-attr">db.pool.config.validationTimeout</span>=<span class="hljs-number">10000</span>
<span class="hljs-attr">db.pool.config.maximumPoolSize</span>=<span class="hljs-number">20</span>
<span class="hljs-attr">db.pool.config.minimumIdle</span>=<span class="hljs-number">2</span>

<span class="hljs-comment">### the maximum retry times for push</span>
<span class="hljs-attr">nacos.config.push.maxRetryTime</span>=<span class="hljs-number">50</span>

<span class="hljs-comment">#*************** Naming Module Related Configurations ***************#</span>
<span class="hljs-comment">### Data dispatch task execution period in milliseconds:</span>

<span class="hljs-comment">### If enable data warmup. If set to false, the server would accept request without local data preparation:</span>
<span class="hljs-comment"># nacos.naming.data.warmup=true</span>

<span class="hljs-comment">### If enable the instance auto expiration, kind like of health check of instance:</span>
<span class="hljs-comment"># nacos.naming.expireInstance=true</span>

<span class="hljs-attr">nacos.naming.empty-service.auto-clean</span>=<span class="hljs-literal">true</span>
<span class="hljs-attr">nacos.naming.empty-service.clean.initial-delay-ms</span>=<span class="hljs-number">50000</span>
<span class="hljs-attr">nacos.naming.empty-service.clean.period-time-ms</span>=<span class="hljs-number">30000</span>


<span class="hljs-comment">#*************** CMDB Module Related Configurations ***************#</span>
<span class="hljs-comment">### The interval to dump external CMDB in seconds:</span>
<span class="hljs-comment"># nacos.cmdb.dumpTaskInterval=3600</span>

<span class="hljs-comment">### The interval of polling data change event in seconds:</span>
<span class="hljs-comment"># nacos.cmdb.eventTaskInterval=10</span>

<span class="hljs-comment">### The interval of loading labels in seconds:</span>
<span class="hljs-comment"># nacos.cmdb.labelTaskInterval=300</span>

<span class="hljs-comment">### If turn on data loading task:</span>
<span class="hljs-comment"># nacos.cmdb.loadDataAtStart=false</span>
<span class="hljs-attr">nacos.inetutils.ip-address</span>=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>
<span class="hljs-attr">nacos.inetutils.prefer-ip-address</span>=<span class="hljs-literal">true</span>

<span class="hljs-comment">#*************** Metrics Related Configurations ***************#</span>
<span class="hljs-comment">### Metrics for prometheus</span>
<span class="hljs-comment">#management.endpoints.web.exposure.include=*</span>

<span class="hljs-comment">### Metrics for elastic search</span>
<span class="hljs-attr">management.metrics.export.elastic.enabled</span>=<span class="hljs-literal">false</span>
<span class="hljs-comment">#management.metrics.export.elastic.host=http://localhost:9200</span>

<span class="hljs-comment">### Metrics for influx</span>
<span class="hljs-attr">management.metrics.export.influx.enabled</span>=<span class="hljs-literal">false</span>
<span class="hljs-comment">#management.metrics.export.influx.db=springboot</span>
<span class="hljs-comment">#management.metrics.export.influx.uri=http://localhost:8086</span>
<span class="hljs-comment">#management.metrics.export.influx.auto-create-db=true</span>
<span class="hljs-comment">#management.metrics.export.influx.consistency=one</span>
<span class="hljs-comment">#management.metrics.export.influx.compressed=true</span>

<span class="hljs-comment">#*************** Access Log Related Configurations ***************#</span>
<span class="hljs-comment">### If turn on the access log:</span>
<span class="hljs-attr">server.tomcat.accesslog.enabled</span>=<span class="hljs-literal">true</span>

<span class="hljs-comment">### accesslog automatic cleaning time</span>
<span class="hljs-attr">server.tomcat.accesslog.max-days</span>=<span class="hljs-number">30</span>

<span class="hljs-comment">### The access log pattern:</span>
<span class="hljs-attr">server.tomcat.accesslog.pattern</span>=%h %l %u %t <span class="hljs-string">"%r"</span> %s %b %D %{User-Agent}i %{Request-Source}i

<span class="hljs-comment">### The directory of access log:</span>
<span class="hljs-attr">server.tomcat.basedir</span>=file:.


<span class="hljs-comment">#*************** Access Control Related Configurations ***************#</span>
<span class="hljs-comment">### If enable spring security, this option is deprecated in 1.2.0:</span>
<span class="hljs-comment">#spring.security.enabled=false</span>
<span class="hljs-comment">### The ignore urls of auth, is deprecated in 1.2.0:</span>
<span class="hljs-attr">nacos.security.ignore.urls</span>=/,/error,/**/*.css,/**/*.js,/**/*.html,/**/*.map,/**/*.svg,/**/*.png,/**/*.ico,/console-ui/public/**,/v1/auth/**,/v1/console/health/**,/actuator/**,/v1/console/server/**

<span class="hljs-comment">### The auth system to use, currently only 'nacos' and 'ldap' is supported:</span>
<span class="hljs-attr">nacos.core.auth.system.type</span>=nacos

<span class="hljs-comment">### If turn on auth system:</span>
<span class="hljs-attr">nacos.core.auth.enabled</span>=<span class="hljs-literal">true</span>

<span class="hljs-comment">### Turn on/off caching of auth information. By turning on this switch, the update of auth information would have a 15 seconds delay.</span>
<span class="hljs-attr">nacos.core.auth.caching.enabled</span>=<span class="hljs-literal">false</span>

<span class="hljs-comment">### Since 1.4.1, Turn on/off white auth for user-agent: nacos-server, only for upgrade from old version.</span>
<span class="hljs-attr">nacos.core.auth.enable.userAgentAuthWhite</span>=<span class="hljs-literal">false</span>

<span class="hljs-comment">### Since 1.4.1, worked when nacos.core.auth.enabled=true and nacos.core.auth.enable.userAgentAuthWhite=false.</span>
<span class="hljs-comment">### The two properties is the white list for auth and used by identity the request from other server.</span>
<span class="hljs-attr">nacos.core.auth.server.identity.key</span>=nacos
<span class="hljs-attr">nacos.core.auth.server.identity.value</span>=nacos

<span class="hljs-comment">### worked when nacos.core.auth.system.type=nacos</span>
<span class="hljs-comment">### The token expiration in seconds:</span>
<span class="hljs-attr">nacos.core.auth.plugin.nacos.token.cache.enable</span>=<span class="hljs-literal">false</span>
<span class="hljs-attr">nacos.core.auth.plugin.nacos.token.expire.seconds</span>=<span class="hljs-number">18000</span>
<span class="hljs-comment">### The default token (Base64 string):</span>
<span class="hljs-attr">nacos.core.auth.plugin.nacos.token.secret.key</span>=SecretKey012345678901234567890123456789012345678901234567890123456789
<span class="hljs-comment">#nacos.core.auth.plugin.nacos.token.secret.key=</span>

<span class="hljs-comment">### worked when nacos.core.auth.system.type=ldapÃ¯Â¼ÂŒ{0} is Placeholder,replace login username</span>
<span class="hljs-comment">#nacos.core.auth.ldap.url=ldap://localhost:389</span>
<span class="hljs-comment">#nacos.core.auth.ldap.basedc=dc=example,dc=org</span>
<span class="hljs-comment">#nacos.core.auth.ldap.userDn=cn=admin,${nacos.core.auth.ldap.basedc}</span>
<span class="hljs-comment">#nacos.core.auth.ldap.password=admin</span>
<span class="hljs-comment">#nacos.core.auth.ldap.userdn=cn={0},dc=example,dc=org</span>
<span class="hljs-comment">#nacos.core.auth.ldap.filter.prefix=uid</span>
<span class="hljs-comment">#nacos.core.auth.ldap.case.sensitive=true</span>
<span class="hljs-comment">#nacos.core.auth.ldap.ignore.partial.result.exception=false</span>

<span class="hljs-comment">#*************** Control Plugin Related Configurations ***************#</span>
<span class="hljs-comment"># plugin type</span>
<span class="hljs-comment">#nacos.plugin.control.manager.type=nacos</span>

<span class="hljs-comment"># local control rule storage dir, default ${nacos.home}/data/connection and ${nacos.home}/data/tps</span>
<span class="hljs-comment">#nacos.plugin.control.rule.local.basedir=${nacos.home}</span>

<span class="hljs-comment"># external control rule storage type, if exist</span>
<span class="hljs-comment">#nacos.plugin.control.rule.external.storage=</span>

<span class="hljs-comment">#*************** Config Change Plugin Related Configurations ***************#</span>
<span class="hljs-comment"># webhook</span>
<span class="hljs-comment">#nacos.core.config.plugin.webhook.enabled=false</span>
<span class="hljs-comment"># It is recommended to use EB https://help.aliyun.com/document_detail/413974.html</span>
<span class="hljs-comment">#nacos.core.config.plugin.webhook.url=http://localhost:8080/webhook/send?token=***</span>
<span class="hljs-comment"># The content push max capacity ,byte</span>
<span class="hljs-comment">#nacos.core.config.plugin.webhook.contentMaxCapacity=102400</span>

<span class="hljs-comment"># whitelist</span>
<span class="hljs-comment">#nacos.core.config.plugin.whitelist.enabled=false</span>
<span class="hljs-comment"># The import file suffixs</span>
<span class="hljs-comment">#nacos.core.config.plugin.whitelist.suffixs=xml,text,properties,yaml,html</span>
<span class="hljs-comment"># fileformatcheck,which validate the import file of type and content</span>
<span class="hljs-comment">#nacos.core.config.plugin.fileformatcheck.enabled=false</span>

<span class="hljs-comment">#*************** Istio Related Configurations ***************#</span>
<span class="hljs-comment">### If turn on the MCP server:</span>
<span class="hljs-attr">nacos.istio.mcp.server.enabled</span>=<span class="hljs-literal">false</span>



<span class="hljs-comment">###*************** Add from 1.3.0 ***************###</span>


<span class="hljs-comment">#*************** Core Related Configurations ***************#</span>

<span class="hljs-comment">### set the WorkerID manually</span>
<span class="hljs-comment"># nacos.core.snowflake.worker-id=</span>

<span class="hljs-comment">### Member-MetaData</span>
<span class="hljs-comment"># nacos.core.member.meta.site=</span>
<span class="hljs-comment"># nacos.core.member.meta.adweight=</span>
<span class="hljs-comment"># nacos.core.member.meta.weight=</span>

<span class="hljs-comment">### MemberLookup</span>
<span class="hljs-comment">### Addressing pattern category, If set, the priority is highest</span>
<span class="hljs-comment"># nacos.core.member.lookup.type=[file,address-server]</span>
<span class="hljs-comment">## Set the cluster list with a configuration file or command-line argument</span>
<span class="hljs-comment"># nacos.member.list=192.168.16.101:8847?raft_port=8807,192.168.16.101?raft_port=8808,192.168.16.101:8849?raft_port=8809</span>
<span class="hljs-comment">## for AddressServerMemberLookup</span>
<span class="hljs-comment"># Maximum number of retries to query the address server upon initialization</span>
<span class="hljs-comment"># nacos.core.address-server.retry=5</span>
<span class="hljs-comment">## Server domain name address of [address-server] mode</span>
<span class="hljs-comment"># address.server.domain=jmenv.tbsite.net</span>
<span class="hljs-comment">## Server port of [address-server] mode</span>
<span class="hljs-comment"># address.server.port=8080</span>
<span class="hljs-comment">## Request address of [address-server] mode</span>
<span class="hljs-comment"># address.server.url=/nacos/serverlist</span>

<span class="hljs-comment">#*************** JRaft Related Configurations ***************#</span>

<span class="hljs-comment">### Sets the Raft cluster election timeout, default value is 5 second</span>
<span class="hljs-comment"># nacos.core.protocol.raft.data.election_timeout_ms=5000</span>
<span class="hljs-comment">### Sets the amount of time the Raft snapshot will execute periodically, default is 30 minute</span>
<span class="hljs-comment"># nacos.core.protocol.raft.data.snapshot_interval_secs=30</span>
<span class="hljs-comment">### raft internal worker threads</span>
<span class="hljs-comment"># nacos.core.protocol.raft.data.core_thread_num=8</span>
<span class="hljs-comment">### Number of threads required for raft business request processing</span>
<span class="hljs-comment"># nacos.core.protocol.raft.data.cli_service_thread_num=4</span>
<span class="hljs-comment">### raft linear read strategy. Safe linear reads are used by default, that is, the Leader tenure is confirmed by heartbeat</span>
<span class="hljs-comment"># nacos.core.protocol.raft.data.read_index_type=ReadOnlySafe</span>
<span class="hljs-comment">### rpc request timeout, default 5 seconds</span>
<span class="hljs-comment"># nacos.core.protocol.raft.data.rpc_request_timeout_ms=5000</span>
<span class="hljs-comment">### enable to support prometheus service discovery</span>
<span class="hljs-comment">#nacos.prometheus.metrics.enabled=true</span>

<span class="hljs-comment">#*************** TLS Configuration ***************#</span>
<span class="hljs-comment">#nacos.remote.server.rpc.tls.enableTls=true</span>
<span class="hljs-comment">#nacos.remote.server.rpc.tls.certChainFile=file:{path of cert}</span>
<span class="hljs-comment">#nacos.remote.server.rpc.tls.certPrivateKey=file:{path of private key}</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db8efa5fbdce4c6c9c8664f930fbe25e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc3B0YW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766245285&amp;x-signature=ds7XQII%2B0JTmADrxrOCbwHEaZVU%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-9">æ‰“åŒ…</h2>
<p>è¿è¡Œæµ‹è¯•æ²¡æœ‰é—®é¢˜åï¼Œå¯ä»¥æ‰“åŒ…äº†ã€‚</p>
<pre><code class="hljs">mvn clean -Prelease-nacos  install -U -DskipTests
</code></pre>
<p>ç”Ÿæˆå¥½çš„åŒ…å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½</p>
<p>é“¾æ¥: <a href="https://link.juejin.cn?target=https%3A%2F%2Fpan.baidu.com%2Fs%2F1DaV2Q8kt8PNU1PsZNv3ZBg%3Fpwd%3Drrsa" target="_blank" title="https://pan.baidu.com/s/1DaV2Q8kt8PNU1PsZNv3ZBg?pwd=rrsa" ref="nofollow noopener noreferrer">pan.baidu.com/s/1DaV2Q8ktâ€¦</a> æå–ç : rrsa</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ«â€œCVå·¥ç¨‹å¸ˆâ€ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ è®¾è®¡ä¸€å¥— B ç«¯ä½ä»£ç  DSL]]></title>    <link>https://juejin.cn/post/7582813955213672489</link>    <guid>https://juejin.cn/post/7582813955213672489</guid>    <pubDate>2025-12-13T12:28:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582813955213672489" data-draft-id="7582857981894672425" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ«â€œCVå·¥ç¨‹å¸ˆâ€ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ è®¾è®¡ä¸€å¥— B ç«¯ä½ä»£ç  DSL"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-13T12:28:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç‹‚èƒ¤"/> <meta itemprop="url" content="https://juejin.cn/user/1390253772899143"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ«â€œCVå·¥ç¨‹å¸ˆâ€ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ è®¾è®¡ä¸€å¥— B ç«¯ä½ä»£ç  DSL
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1390253772899143/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç‹‚èƒ¤
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T12:28:09.000Z" title="Sat Dec 13 2025 12:28:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡å†…å®¹å¼•ç”¨ å“²ç„-å¤§å‰ç«¯å…¨æ ˆå®è·µ</p>
</blockquote>
<h2 data-id="heading-0">1. å’±ä»¬çš„ç—›ç‚¹ï¼šä¸ºä»€ä¹ˆå¤©å¤©åœ¨å†™é‡å¤ä»£ç ï¼Ÿ</h2>
<p>å…„å¼Ÿä»¬ï¼Œåš B ç«¯åå°å¼€å‘çš„æ—¥å¸¸æ˜¯ä¸æ˜¯è¿™æ ·çš„ï¼Ÿ æ—©ä¸Šæ¥äº†ï¼Œäº§å“ç»ç†è¯´ï¼šâ€œåŠ ä¸ªç”¨æˆ·ç®¡ç†é¡µé¢ã€‚â€ ä½ æƒ³äº†æƒ³ï¼š</p>
<ol>
<li>å†™ä¸ª Router è·¯ç”±ã€‚</li>
<li>ç”»ä¸ª Search Barï¼ˆæœç´¢æ ï¼‰ï¼Œé‡Œé¢æ”¾ Input å’Œ Selectã€‚</li>
<li>ç”»ä¸ª Tableï¼ˆè¡¨æ ¼ï¼‰ï¼Œæå®šåˆ†é¡µé€»è¾‘ã€‚</li>
<li>æä¸ª Dialogï¼ˆå¼¹çª—ï¼‰ï¼Œå†™è¡¨å•éªŒè¯ã€‚</li>
<li>è°ƒ APIï¼Œç»‘å®šæ•°æ®â€¦â€¦</li>
</ol>
<p>ä¸‹åˆï¼Œäº§å“ç»ç†åˆæ¥äº†ï¼šâ€œå†åŠ ä¸ªè®¢å•ç®¡ç†é¡µé¢ã€‚â€ ä½ ä¸€çœ‹ï¼Œ<strong>è¿™ç‰¹ä¹ˆè·Ÿä¸Šåˆé‚£ä¸ªé¡µé¢é•¿å¾—æœ‰ 90% æ˜¯ä¸€æ ·çš„å•Šï¼</strong> åªæ˜¯å­—æ®µä»â€œç”¨æˆ·åâ€å˜æˆäº†â€œè®¢å•å·â€ï¼Œæ¥å£æ¢äº†ä¸€ä¸ªè€Œå·²ã€‚</p>
<p>äºæ˜¯ï¼Œæˆ‘ä»¬å˜æˆäº†æ¯«æ— æ„Ÿæƒ…çš„ <strong>Ctrl+C / Ctrl+V æœºå™¨</strong>ã€‚</p>
<p><strong>è¿™å¥— DSL çš„è®¾è®¡åˆè¡·å°±æ˜¯ï¼š</strong> æŠŠé‚£ <strong>80% é‡å¤çš„</strong>â€œå¤´éƒ¨ã€ä¾§è¾¹æ ã€æœç´¢ã€è¡¨æ ¼â€æŠ½è±¡æˆ JSON é…ç½®ï¼›å‰©ä¸‹çš„ <strong>20% å¤æ‚çš„</strong>é€»è¾‘ï¼Œç•™ç»™ä½ å»æŒ¥æ´’æ‰åã€‚</p>
<hr/>
<p><strong>å…ˆé™„ä¸Šå›¾å’Œå®Œæ•´çš„DSLé…ç½®</strong>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/97cff2117b8c4060a65a71e53f467ade~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54uC6IOk:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766233689&amp;x-signature=KLHSiWMsn6W51YBDGdrxmPOLthQ%3D" alt="å¾®ä¿¡å›¾ç‰‡_20251213192851_15_67.jpg" loading="lazy"/></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-string">"mode"</span>: <span class="hljs-string">"dashboard"</span>,
  <span class="hljs-comment">// å¤´éƒ¨èœå•</span>
  <span class="hljs-string">"menu"</span>: [{
    <span class="hljs-comment">// èœå•å”¯ä¸€æè¿°</span>
    <span class="hljs-string">"key"</span>: <span class="hljs-string">""</span>,
    <span class="hljs-comment">// èœå•name</span>
    <span class="hljs-string">"name"</span>: <span class="hljs-string">""</span>,
    <span class="hljs-comment">// èœå•ç±»å‹ groupåˆ†ç»„ / module</span>
    <span class="hljs-string">"menuType"</span>: <span class="hljs-string">""</span>,
    <span class="hljs-comment">// å­èœå• å½“menuTypeä¸ºgroupæ—¶æœ‰æ•ˆ</span>
    <span class="hljs-string">"subMenu"</span>: [{

    }, ...],
    <span class="hljs-comment">// èœå•è¡Œä¸º,å½“menuTypeä¸ºmoduleæ—¶æœ‰æ•ˆã€‚ æšä¸¾å€¼ï¼šiframe / custom / schema / sider</span>
    <span class="hljs-string">"moduleType"</span>: <span class="hljs-string">""</span>,
    <span class="hljs-comment">// å½“moduleTypeä¸ºsideræ—¶æœ‰æ•ˆ</span>
    <span class="hljs-attr">siderConfig</span>:{
      <span class="hljs-attr">menu</span>:[{},...]
    },
    <span class="hljs-comment">// å½“moduleTypeä¸ºiframeæ—¶æœ‰æ•ˆ</span>
    <span class="hljs-attr">iframeConfig</span>: {
      <span class="hljs-attr">path</span>: <span class="hljs-string">""</span>, <span class="hljs-comment">// iframeåœ°å€</span>
    },
    <span class="hljs-comment">// å½“moduleTypeä¸ºcustomæ—¶æœ‰æ•ˆ</span>
    <span class="hljs-attr">customConfig</span>: {
      <span class="hljs-attr">path</span>: <span class="hljs-string">""</span> <span class="hljs-comment">// è‡ªå®šä¹‰è·¯ç”±è·¯å¾„</span>
    },
    <span class="hljs-comment">// å½“moduleTypeä¸ºschemaæ—¶æœ‰æ•ˆ</span>
    <span class="hljs-attr">schemaConfig</span>: {
      <span class="hljs-attr">api</span>: <span class="hljs-string">""</span>, <span class="hljs-comment">// æ•°æ®æºapiåœ°å€,éµå¾ªrestfulé£æ ¼</span>
      <span class="hljs-comment">// json-schemaæè¿°</span>
      <span class="hljs-attr">schema</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-string">"object"</span>,
        <span class="hljs-attr">properties</span>: {
          <span class="hljs-attr">key</span>: {
            ...schema, <span class="hljs-comment">//æ ‡å‡†json-schemaæè¿°</span>
            <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>,<span class="hljs-comment">// å­—æ®µç±»å‹</span>
            <span class="hljs-attr">label</span>: <span class="hljs-string">"å­—æ®µåç§°"</span>,<span class="hljs-comment">// å­—æ®µåç§°</span>
            <span class="hljs-comment">// å­—æ®µåœ¨tableä¸­çš„é…ç½®</span>
            <span class="hljs-attr">tableOption</span>:{
              ...elTableColumnConfig, <span class="hljs-comment">// æ ‡å‡†el-table-columné…ç½®</span>
              <span class="hljs-attr">tofixed</span>: <span class="hljs-number">2</span>, <span class="hljs-comment">// æ•°å­—ç±»å‹æ—¶çš„å°æ•°ä½æ•°</span>
              <span class="hljs-attr">visible</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// æ˜¯å¦åœ¨tableä¸­æ˜¾ç¤º</span>
            },
            <span class="hljs-comment">// å­—æ®µåœ¨search-barä¸­çš„é…ç½®</span>
            <span class="hljs-attr">searchOption</span>:{
              ...elComponentConfig, <span class="hljs-comment">// æ ‡å‡†el-component-columnç»„ä»¶é…ç½®</span>
              <span class="hljs-attr">comType</span>:<span class="hljs-string">''</span>, <span class="hljs-comment">// é…ç½®ç»„ä»¶ç±»å‹ input/select/dynamicSelect/date-picker/date-rangeç­‰</span>
              <span class="hljs-attr">default</span>:<span class="hljs-string">''</span>, <span class="hljs-comment">// é»˜è®¤å€¼</span>
              <span class="hljs-comment">// comTypeä¸ºselectç”Ÿæ•ˆ</span>
              <span class="hljs-attr">enumList</span>:[
                {
                  <span class="hljs-attr">label</span>:<span class="hljs-string">''</span>,
                  <span class="hljs-attr">value</span>:<span class="hljs-string">''</span>
                }
              ],
              <span class="hljs-comment">// comTypeä¸ºdynamicSelectç”Ÿæ•ˆ</span>
              <span class="hljs-attr">api</span>:<span class="hljs-string">''</span>
            }
            
          },
          ...
        },
      },
      <span class="hljs-attr">tableConfig</span>: {
        <span class="hljs-attr">headerButtons</span>: [
          {
            <span class="hljs-attr">label</span>:<span class="hljs-string">''</span>, <span class="hljs-comment">// æŒ‰é’®åç§°</span>
            <span class="hljs-attr">eventKey</span>:<span class="hljs-string">''</span>, <span class="hljs-comment">// æŒ‰é’®äº‹ä»¶å</span>
            <span class="hljs-attr">eventOption</span>:{
               <span class="hljs-comment">// æŒ‰é’®äº‹ä»¶å‚æ•°é…ç½®</span>
              <span class="hljs-attr">params</span>:{
                <span class="hljs-string">"paramsKey"</span>:<span class="hljs-string">"schema::fieldKey"</span> <span class="hljs-comment">// schema:: å¼€å¤´è¡¨ç¤ºå–schemaä¸­çš„å­—æ®µå€¼</span>
              }
            }, <span class="hljs-comment">// æŒ‰é’®äº‹ä»¶é…ç½®</span>
            ...elButtonConfig, <span class="hljs-comment">// æ ‡å‡†el-buttoné…ç½®</span>
          }
        ],
        <span class="hljs-attr">rowButtons</span>: [
          {
            <span class="hljs-attr">label</span>:<span class="hljs-string">''</span>, <span class="hljs-comment">// æŒ‰é’®åç§°</span>
            <span class="hljs-attr">eventKey</span>:<span class="hljs-string">''</span>, <span class="hljs-comment">// æŒ‰é’®äº‹ä»¶å</span>
            <span class="hljs-attr">eventOption</span>:{}, <span class="hljs-comment">// æŒ‰é’®äº‹ä»¶é…ç½®</span>
            ...elButtonConfig, <span class="hljs-comment">// æ ‡å‡†el-buttoné…ç½®</span>
          }
        ]
      }, <span class="hljs-comment">// tableç›¸å…³é…ç½®</span>
      <span class="hljs-attr">searchConfig</span>: {}, <span class="hljs-comment">// æœç´¢ç›¸å…³é…ç½®</span>
      <span class="hljs-attr">components</span>: {}, <span class="hljs-comment">// æ¨¡å—ç»„ä»¶</span>
    }, ...]
}
</code></pre>
<h2 data-id="heading-1">2. å®è§‚æ¶æ„ï¼šåƒâ€œæ­ç§¯æœ¨â€ä¸€æ ·ç»„è£…é¡µé¢</h2>
<p>å…ˆçœ‹è¿™å¼ æ¶æ„å¤§å›¾ï¼Œåˆ«è¢«å“åˆ°äº†ï¼Œå…¶å®å®ƒå°±è®²äº†ä¸¤ä»¶äº‹ï¼š <strong>â€œæ€ä¹ˆé…â€</strong> å’Œ <strong>â€œæ€ä¹ˆæŸ“â€</strong> ã€‚</p>
<h3 data-id="heading-2">2.1 åº•åº§ï¼šBFF Server çš„â€œç»§æ‰¿å¤§æ³•â€</h3>
<p>çœ‹æ¶æ„å›¾çš„æœ€åº•ä¸‹ï¼ˆçº¢è‰²è™šçº¿æ¡†åŒºåŸŸï¼‰ã€‚ æˆ‘ä»¬å€Ÿé‰´äº†é¢å‘å¯¹è±¡çš„æ€æƒ³ã€‚æ¯”å¦‚ä½ è¦åšä¸€ä¸ªâ€œç”µå•†åå°â€ï¼š</p>
<ul>
<li><strong>é¢†åŸŸæ¨¡å‹ï¼ˆåŸºç±»ï¼‰</strong> ï¼šæˆ‘ä»¬å®šä¹‰å¥½ä¸€å¥—æ‰€æœ‰é¡µé¢é€šç”¨çš„è§„åˆ™ã€‚æ¯”å¦‚ï¼Œæ‰€æœ‰è¡¨æ ¼é»˜è®¤éƒ½æœ‰â€œåˆ›å»ºæ—¶é—´â€ï¼Œæ‰€æœ‰æœç´¢æ é»˜è®¤éƒ½æœ‰â€œé‡ç½®â€æŒ‰é’®ã€‚</li>
<li><strong>é¡¹ç›®é…ç½®ï¼ˆå­ç±»ï¼‰</strong> ï¼šå…·ä½“åˆ°â€œè®¢å•ç®¡ç†â€é¡µé¢æ—¶ï¼Œä½ åªéœ€è¦ç»§æ‰¿åŸºç±»ï¼Œç„¶åè¯´â€œæˆ‘è¦åŠ ä¸ªè®¢å•é‡‘é¢å­—æ®µâ€ã€‚</li>
</ul>
<p><strong>å¥½å¤„ï¼Ÿ</strong> ä¿®æ”¹åŸºç±»ï¼Œä¸€ç™¾ä¸ªé¡µé¢åŒæ—¶ç”Ÿæ•ˆï¼Œä¸ç”¨ä¸€ä¸ªä¸ªæ–‡ä»¶å»æ”¹ã€‚</p>
<h3 data-id="heading-3">2.2 é¡µé¢éª¨æ¶ï¼šè·¯ç”±åˆ†å‘ä¸ç»„ä»¶åˆ†å·¥</h3>
<p>çœ‹ä¸­é—´è“è‰²çš„åŒºåŸŸï¼Œå®ƒåœ¨å·¥ç¨‹å®ç°ä¸Šå…¶å®å°±æ˜¯ä¸€å¥—<strong>ç²¾å¿ƒè®¾è®¡çš„ Vue Router é…ç½®</strong>ã€‚</p>
<p>æˆ‘ä»¬æ²¡æœ‰å†™æ­»é¡µé¢ï¼Œè€Œæ˜¯é¢„å…ˆå®šä¹‰å¥½äº†å‡ ä¸ªâ€œæ ¸å¿ƒå®¹å™¨ç»„ä»¶â€ï¼ˆViewï¼‰ï¼Œå°±åƒè¿™æ˜¯å‡ è¾†ä¸åŒåŠŸèƒ½çš„â€œè½¦â€ï¼ŒJSON æ•°æ®å°±æ˜¯â€œä¹˜å®¢â€ï¼Œè·¯ç”±å†³å®šäº†æŠŠä¹˜å®¢è£…è¿›å“ªè¾†è½¦é‡Œã€‚</p>
<p>æ¥çœ‹çœ‹è¿™æ®µæ ¸å¿ƒè·¯ç”±ä»£ç ï¼š</p>
<p>JavaScript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Dashboard</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./dashboard.vue"</span>;
<span class="hljs-keyword">import</span> boot <span class="hljs-keyword">from</span> <span class="hljs-string">"@/boot"</span>;

<span class="hljs-comment">// 1. å®šä¹‰â€œå¼•æ“â€åˆ—è¡¨ï¼šè¿™é‡Œå°±æ˜¯æˆ‘ä»¬çš„ç­–ç•¥åº“</span>
<span class="hljs-keyword">const</span> componentList = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">"iframe"</span>, <span class="hljs-comment">// å¯¹åº” moduleType: iframe</span>
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./complex-view/iframe-view/iframe-view.vue"</span>),
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">"schema"</span>, <span class="hljs-comment">// å¯¹åº” moduleType: schemaï¼ˆæ ¸å¿ƒä½ä»£ç é¡µï¼‰</span>
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./complex-view/schema-view/schema-view.vue"</span>),
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">"todo"</span>,   <span class="hljs-comment">// å¾…åŠ/è‡ªå®šä¹‰é¡µ</span>
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./todo/todo.vue"</span>),
  },
];

<span class="hljs-comment">// 2. åŠ¨æ€ç”Ÿæˆæ‰å¹³è·¯ç”±</span>
<span class="hljs-keyword">const</span> routes = componentList.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> ({
  <span class="hljs-attr">path</span>: <span class="hljs-string">`/view/dashboard/<span class="hljs-subst">${item.path}</span>`</span>,
  <span class="hljs-attr">component</span>: item.<span class="hljs-property">component</span>,
}));

<span class="hljs-comment">// 3. ä¾§è¾¹æ å¸ƒå±€ï¼ˆSider Layoutï¼‰ç­–ç•¥</span>
<span class="hljs-comment">// å¦‚æœé…ç½®äº†ä¾§è¾¹æ ï¼Œå°±è®© sider-view ä½œä¸ºçˆ¶è·¯ç”±ï¼ŒæŠŠ componentList ä½œä¸ºå­è·¯ç”±åµŒå¥—è¿›å»</span>
routes.<span class="hljs-title function_">push</span>({
  <span class="hljs-attr">path</span>: <span class="hljs-string">"/view/dashboard/sider"</span>,
  <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./complex-view/sider-view/sider-view.vue"</span>),
  <span class="hljs-attr">children</span>: componentList,
});

<span class="hljs-comment">// 4. ä¾§è¾¹æ å…œåº•ç­–ç•¥ï¼ˆWildcard Routeï¼‰</span>
<span class="hljs-comment">// å¤„ç†å¤šçº§æ·±å±‚èœå•çš„æƒ…å†µï¼Œä¿è¯ url å³ä½¿å¾ˆé•¿ä¹Ÿèƒ½åŒ¹é…åˆ° sider å¸ƒå±€</span>
routes.<span class="hljs-title function_">push</span>({
  <span class="hljs-attr">path</span>: <span class="hljs-string">"/view/dashboard/sider/:chapters+"</span>,
  <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./complex-view/sider-view/sider-view.vue"</span>),
});

<span class="hljs-title function_">boot</span>(<span class="hljs-title class_">Dashboard</span>, { routes });
</code></pre>
<p>è¿™æ®µä»£ç æ­ç¤ºäº† DSL è¿è¡Œçš„å®è´¨æµç¨‹ï¼š</p>
<h4 data-id="heading-4">(1) è·¯ç”±å³åˆ†å‘ï¼ˆThe Router Dispatcherï¼‰</h4>
<ul>
<li>å½“ URL åŒ¹é…åˆ° <code>/view/dashboard/schema</code> æ—¶ï¼ŒVue Router è‡ªåŠ¨åŠ è½½ <code>Schema-View</code> ç»„ä»¶ã€‚</li>
<li>å½“ URL åŒ¹é…åˆ° <code>/view/dashboard/iframe</code> æ—¶ï¼ŒåŠ è½½ <code>Iframe-View</code> ç»„ä»¶ã€‚</li>
<li><strong>ä¾§è¾¹æ çš„å·§å¦™å¤„ç†</strong>ï¼šä»£ç ä¸­ä¸“é—¨ä¸º <code>/sider</code> è·¯å¾„é…ç½®äº† <code>children</code>ï¼Œè¿™æ„å‘³ç€å¦‚æœä½ çš„é¡µé¢é…ç½®äº†ä¾§è¾¹æ ï¼Œç³»ç»Ÿä¼šå…ˆæ¸²æŸ“ <code>sider-view</code> æ¡†æ¶ï¼Œå†æŠŠå…·ä½“çš„å†…å®¹ï¼ˆschema æˆ– iframeï¼‰æ¸²æŸ“åˆ° <code>&lt;router-view&gt;</code> æ’æ§½ä¸­ã€‚</li>
</ul>
<h4 data-id="heading-5">(2) Schema-View çš„å†…éƒ¨æ„é€ </h4>
<p>ä¸€æ—¦è·¯ç”±å‘½ä¸­äº† <code>Schema-View</code>ï¼Œè¿™ä¸ªç»„ä»¶å†…éƒ¨å…¶å®åˆåšäº†ä¸€æ¬¡<strong>ç²¾ç»†åŒ–åˆ†å·¥</strong>ã€‚å®ƒä¸æ˜¯ä¸€ä¸ªå·¨å¤§çš„é»‘ç›’ï¼Œè€Œæ˜¯ç”±ä¸¤ä¸ªæ ¸å¿ƒå­é¢æ¿ç»„æˆçš„ï¼š</p>
<ul>
<li><strong>ä¸Šå±‚ï¼šSearch-Panelï¼ˆæœç´¢é¢æ¿ï¼‰</strong> å®ƒè´Ÿè´£æ¥æ”¶ JSON ä¸­çš„ <code>searchOption</code> é…ç½®ï¼ŒåŠ¨æ€ç”Ÿæˆ Inputã€Select ç­‰è¡¨å•é¡¹ã€‚</li>
<li><strong>ä¸‹å±‚ï¼šTable-Panelï¼ˆè¡¨æ ¼é¢æ¿ï¼‰</strong> å®ƒè´Ÿè´£æ¥æ”¶ JSON ä¸­çš„ <code>tableOption</code> é…ç½®ï¼Œè´Ÿè´£æ•°æ®çš„å±•ç¤ºã€åˆ†é¡µä»¥åŠè¡Œåˆ—æ“ä½œã€‚</li>
</ul>
<p><strong>æ€»ç»“ä¸€ä¸‹ï¼š</strong> è·¯ç”±è´Ÿè´£**â€œé€‰è½¦â€ <strong>ï¼ˆé€‰ Sider è¿˜æ˜¯ Schema è¿˜æ˜¯ Iframeï¼‰ï¼Œè€Œ <code>Schema-View</code> è´Ÿè´£</strong>â€œè£…è´§â€**ï¼ˆæŠŠ JSON æ‹†åˆ†æˆæœç´¢é…ç½®å’Œè¡¨æ ¼é…ç½®ï¼Œåˆ†å‘ç»™ä¸Šä¸‹ä¸¤ä¸ªé¢æ¿ï¼‰ã€‚è¿™æ ·ä¸€æ¥ï¼Œç»“æ„æ¸…æ™°ï¼Œç»´æŠ¤ä¹Ÿéå¸¸å®¹æ˜“ã€‚</p>
<h2 data-id="heading-6">3. JSON æ ¸å¿ƒæ­ç§˜ï¼šä¸€ä»½é…ç½®ï¼ŒæŒæ§å…¨å±€</h2>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯¹ç€é‚£æ®µ JSON ä»£ç ï¼Œçœ‹çœ‹å®ƒæ˜¯æ€ä¹ˆæŒ‡æŒ¥å‰ç«¯å¹²æ´»çš„ã€‚</p>
<h3 data-id="heading-7">3.1 è·¯ç”±çš„å¤§è„‘ï¼š<code>menu</code> å’Œ <code>moduleType</code></h3>
<p>JSON æœ€å¤–å±‚çš„ <code>menu</code> å†³å®šäº†ç³»ç»Ÿçš„å¯¼èˆªç»“æ„ã€‚è¿™é‡Œæœ‰ä¸ªæœ€å…³é”®çš„å¼€å…³å« <code>menuType</code> å’Œ <code>moduleType</code>ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ä¸ºäº†é˜²æ­¢â€œä¸€åˆ€åˆ‡â€ã€‚æˆ‘ä»¬ä¸èƒ½å› ä¸ºç”¨äº†ä½ä»£ç ï¼Œå°±å†™ä¸äº†å¤æ‚é¡µé¢ã€‚</p>
<ul>
<li><strong>å¦‚æœæ˜¯æ ‡å‡†å¢åˆ æ”¹æŸ¥</strong>ï¼šè®¾ <code>moduleType: "schema"</code>ã€‚å¼•æ“è‡ªåŠ¨å¹²æ´»ï¼Œä½ å–å’–å•¡ã€‚</li>
<li><strong>å¦‚æœæ˜¯è¶…å¤æ‚çš„æ•°æ®å¤§å±</strong>ï¼šè®¾ <code>moduleType: "custom"</code>ã€‚å¼•æ“è®©è·¯ï¼ŒåŠ è½½ä½ æ‰‹å†™çš„ Vue ç»„ä»¶ã€‚</li>
<li><strong>å¦‚æœæ˜¯è€ç³»ç»Ÿé¡µé¢</strong>ï¼šè®¾ <code>moduleType: "iframe"</code>ã€‚ç›´æ¥å†…åµŒå®Œäº‹ã€‚</li>
</ul>
<h3 data-id="heading-8">3.2 å­—æ®µçš„â€œå•æºçœŸç†â€ï¼šæœ€éªšçš„æ“ä½œåœ¨è¿™é‡Œ</h3>
<p>è¯·é‡ç‚¹çœ‹ JSON é‡Œçš„ <code>properties</code> å­—æ®µã€‚è¿™æ˜¯æ•´ä¸ª DSL æœ€ç²¾åçš„éƒ¨åˆ†ã€‚</p>
<p>ä»¥å¾€æˆ‘ä»¬å†™ä»£ç ï¼Œæœç´¢æ å†™ä¸€é <code>&lt;el-input v-model="name"&gt;</code>ï¼Œè¡¨æ ¼é‡Œåˆå†™ä¸€é <code>&lt;el-table-column prop="name"&gt;</code>ã€‚<strong>ä¸¤è¾¹æ˜¯å‰²è£‚çš„ã€‚</strong></p>
<p>åœ¨è¿™ä¸ª DSL é‡Œï¼Œæˆ‘ä»¬æŠŠä¸€ä¸ªå­—æ®µï¼ˆæ¯”å¦‚ <code>key</code>ï¼‰çš„æ‰€æœ‰å±æ€§èšåˆåœ¨ä¸€èµ·ï¼š</p>
<p>JavaScript</p>
<pre><code class="hljs language-arduino" lang="arduino">key: {
  label: <span class="hljs-string">"å­—æ®µåç§°"</span>, <span class="hljs-comment">// é€šç”¨åç§°</span>
  <span class="hljs-comment">// 1. å‘Šè¯‰è¡¨æ ¼æ€ä¹ˆå±•ç¤º</span>
  tableOption: { 
    visible: <span class="hljs-literal">true</span>, 
    tofixed: <span class="hljs-number">2</span> <span class="hljs-comment">// å‡å¦‚æ˜¯æ•°å­—ï¼Œè‡ªåŠ¨ä¿ç•™2ä½å°æ•°</span>
  },
  <span class="hljs-comment">// 2. å‘Šè¯‰æœç´¢æ æ€ä¹ˆæœç´¢</span>
  searchOption: { 
    comType: <span class="hljs-string">'select'</span>, <span class="hljs-comment">// è‡ªåŠ¨æ¸²æŸ“æˆä¸‹æ‹‰æ¡†</span>
    enumList: [...]    <span class="hljs-comment">// ä¸‹æ‹‰é€‰é¡¹</span>
  }
}
</code></pre>
<p><strong>çœ‹æ‡‚äº†å—ï¼Ÿ</strong> ä½ åªéœ€è¦å®šä¹‰ä¸€æ¬¡ <code>key</code>ã€‚è§£æå™¨è¯»å– <code>searchOption</code> å°±åœ¨ä¸Šé¢æ¸²æŸ“æœç´¢æ¡†ï¼Œè¯»å– <code>tableOption</code> å°±åœ¨ä¸‹é¢æ¸²æŸ“è¡¨æ ¼åˆ—ã€‚ <strong>æ”¹ä¸€ä¸ªå­—æ®µåï¼Œæœç´¢å’Œè¡¨æ ¼åŒæ—¶æ›´æ–°ã€‚</strong> è¿™æ‰å«â€œä¸é‡å¤é€ è½®å­â€ã€‚</p>
<h3 data-id="heading-9">3.3 æŒ‰é’®ä¸äº‹ä»¶ï¼š<code>schema::</code> çš„é­”æ³•</h3>
<p>è¡¨æ ¼è‚¯å®šè¦æœ‰æ“ä½œæŒ‰é’®ï¼Œæ¯”å¦‚â€œç¼–è¾‘â€ã€â€œåˆ é™¤â€ã€‚ åœ¨ <code>headerButtons</code> æˆ– <code>rowButtons</code> é‡Œï¼Œä½ å¯èƒ½ä¼šç–‘æƒ‘è¿™ä¸€è¡Œï¼š <code>"paramsKey": "schema::fieldKey"</code></p>
<p>è¿™æ˜¯æˆ‘ä»¬çº¦å®šçš„ä¸€ç§<strong>åŠ¨æ€å–å€¼è¯­æ³•</strong>ã€‚</p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼šç‚¹å‡»â€œåˆ é™¤â€æŒ‰é’®ï¼Œéœ€è¦è°ƒ API åˆ æ‰å½“å‰è¡Œï¼ŒAPI éœ€è¦ <code>id</code> å‚æ•°ã€‚</li>
<li><strong>åŸç†</strong>ï¼šå½“å‰ç«¯å¼•æ“çœ‹åˆ° <code>schema::</code> å¼€å¤´æ—¶ï¼Œå®ƒå°±çŸ¥é“ï¼šâ€œå“¦ï¼Œç”¨æˆ·ä¸æ˜¯è¦ä¼ æ­»å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯è¦æˆ‘å»<strong>å½“å‰è¿™ä¸€è¡Œçš„æ•°æ®</strong>é‡Œï¼ŒæŠŠ <code>fieldKey</code> å¯¹åº”çš„å€¼å–å‡ºæ¥ä¼ ç»™åç«¯ã€‚â€</li>
</ul>
<hr/>
<h2 data-id="heading-10">4. è¿è¡Œæµç¨‹æ€»ç»“</h2>
<p>æŠŠå›¾å’Œä»£ç ä¸²èµ·æ¥ï¼Œæ•´ä¸ªæµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p>
<ol>
<li>
<p><strong>åŠ è½½</strong>ï¼šä½ æ‰“å¼€é¡µé¢ï¼ŒBFF Server æŠŠåˆå¹¶å¥½çš„ JSON æ‰”ç»™å‰ç«¯ã€‚</p>
</li>
<li>
<p><strong>è·¯ç”±</strong>ï¼šå‰ç«¯ Router çœ‹åˆ° <code>moduleType: "schema"</code>ï¼Œå°±æŠŠä»»åŠ¡äº¤ç»™é€šç”¨æ¨¡æ¿é¡µã€‚</p>
</li>
<li>
<p><strong>æ¸²æŸ“</strong>ï¼š</p>
<ul>
<li><strong>Search å¼•æ“</strong> éå† JSON é‡Œçš„ <code>properties</code>ï¼ŒæŠŠå¸¦æœ‰ <code>searchOption</code> çš„å­—æ®µæŒ‘å‡ºæ¥ï¼Œç”Ÿæˆæœç´¢æ ã€‚</li>
<li><strong>Table å¼•æ“</strong> éå† <code>properties</code>ï¼ŒæŠŠå¸¦æœ‰ <code>tableOption</code> çš„å­—æ®µæŒ‘å‡ºæ¥ï¼Œç”Ÿæˆè¡¨æ ¼åˆ—ã€‚</li>
</ul>
</li>
<li>
<p><strong>äº¤äº’</strong>ï¼šç”¨æˆ·ç‚¹â€œæœç´¢â€ï¼Œå¼•æ“è‡ªåŠ¨æ”¶é›†æ‰€æœ‰æœç´¢æ¡†çš„å€¼ï¼Œæ‹¼æ¥ API URLï¼Œåˆ·æ–°è¡¨æ ¼æ•°æ®ã€‚</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-11">5. å†™åœ¨æœ€å</h2>
<p>è¿™å¥— DSL çš„æœ¬è´¨ï¼Œä¸æ˜¯ä¸ºäº†ç‚«æŠ€ï¼Œè€Œæ˜¯ä¸ºäº†<strong>å·æ‡’</strong>ï¼ˆè¤’ä¹‰ï¼‰ã€‚</p>
<p>å®ƒæŠŠæˆ‘ä»¬ä»ç¹ççš„ DOM ç»“æ„å’Œ UI åº“ API ä¸­è§£æ”¾å‡ºæ¥ï¼Œè®©æˆ‘ä»¬åªå…³æ³¨<strong>ä¸šåŠ¡æ•°æ®æœ¬èº«</strong>ã€‚æ¯•ç«Ÿï¼Œä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬çš„ä»·å€¼åº”è¯¥ä½“ç°åœ¨è§£å†³å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ä¸Šï¼Œè€Œä¸æ˜¯æ¯”è°å†™çš„ <code>&lt;el-table-column&gt;</code> æ›´å¤šï¼Œå¯¹å§ï¼Ÿ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶æŒæ¡ React JSXï¼šä¸ºä»€ä¹ˆå®ƒè®©å‰ç«¯å¼€å‘åƒæ­ç§¯æœ¨ä¸€æ ·ç®€å•ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7582854603061264426</link>    <guid>https://juejin.cn/post/7582854603061264426</guid>    <pubDate>2025-12-13T12:33:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582854603061264426" data-draft-id="7582846276506566694" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶æŒæ¡ React JSXï¼šä¸ºä»€ä¹ˆå®ƒè®©å‰ç«¯å¼€å‘åƒæ­ç§¯æœ¨ä¸€æ ·ç®€å•ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•,React.js"/> <meta itemprop="datePublished" content="2025-12-13T12:33:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸ä¼šjs"/> <meta itemprop="url" content="https://juejin.cn/user/2517262684662348"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶æŒæ¡ React JSXï¼šä¸ºä»€ä¹ˆå®ƒè®©å‰ç«¯å¼€å‘åƒæ­ç§¯æœ¨ä¸€æ ·ç®€å•ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2517262684662348/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸ä¼šjs
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T12:33:56.000Z" title="Sat Dec 13 2025 12:33:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»é›¶æŒæ¡ React JSXï¼šä¸ºä»€ä¹ˆå®ƒè®©å‰ç«¯å¼€å‘åƒæ­ç§¯æœ¨ä¸€æ ·ç®€å•ï¼Ÿ</h2>
<p>å¤§å®¶å¥½ï¼Œä»Šå¤©å¸¦å¤§å®¶æ·±å…¥èŠèŠ React çš„æ ¸å¿ƒçµé­‚â€”â€”<strong>JSX</strong>ã€‚æˆ‘ä»¬ä¼šç»“åˆçœŸå®ä»£ç ç¤ºä¾‹ï¼Œä¸€æ­¥æ­¥æ‹†è§£ JSX çš„æœ¬è´¨ã€ç»„ä»¶åŒ–å¼€å‘ã€çŠ¶æ€ç®¡ç†ï¼Œä»¥åŠé‚£äº›å®¹æ˜“è¸©å‘çš„åœ°æ–¹ã€‚</p>
<blockquote>
<p>React ä¸ºä»€ä¹ˆè¿™ä¹ˆç«ï¼Ÿå› ä¸ºå®ƒæŠŠå‰ç«¯å¼€å‘ä»â€œæ‹¼ HTML + CSS + JSâ€çš„æ‰‹å·¥æ´»ï¼Œå˜æˆäº†â€œæ­ç§¯æœ¨å¼â€çš„ç»„ä»¶åŒ–å·¥ç¨‹ã€‚JSX å°±æ˜¯é‚£æŠŠç¥å¥‡çš„â€œèƒ¶æ°´â€ï¼Œè®© JavaScript é‡Œç›´æ¥å†™ HTML-like ä»£ç æˆä¸ºå¯èƒ½ã€‚</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e75bdf564179470d91864abf18f66077~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5LyaanM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766234036&amp;x-signature=VAxGJ%2FxjhiXh5FCiN9XGB85X7C8%3D" alt="5609728adb9d921c5649719c8cbf0517.jpg" loading="lazy"/></p>
<h4 data-id="heading-1">JSX æ˜¯ä»€ä¹ˆï¼ŸXML in JS çš„é­”æ³•</h4>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œ<strong>ä½ åœ¨ JavaScript ä»£ç é‡Œç›´æ¥å†™ HTML æ ‡ç­¾</strong>ï¼Œè¿™å¬èµ·æ¥å¤šé…·ï¼Ÿè¿™å°±æ˜¯ JSXï¼ˆJavaScript XMLï¼‰çš„æ ¸å¿ƒã€‚å®ƒä¸æ˜¯å­—ç¬¦ä¸²ï¼Œä¹Ÿä¸æ˜¯çœŸæ­£çš„ HTMLï¼Œè€Œæ˜¯ä¸€ç§è¯­æ³•æ‰©å±•ï¼Œçœ‹èµ·æ¥åƒ XMLï¼Œä½†æœ€ç»ˆä¼šè¢«ç¼–è¯‘æˆçº¯ JavaScriptã€‚</p>
<p>ä¸ºä»€ä¹ˆéœ€è¦ JSXï¼Ÿä¼ ç»Ÿå‰ç«¯å¼€å‘ï¼ŒHTMLã€CSSã€JS ä¸‰åˆ†ç¦»ï¼Œé€»è¾‘å’Œè§†å›¾æ··åœ¨ä¸€èµ·æ—¶å¾ˆå®¹æ˜“ä¹±å¥—ã€‚React è¯´ï¼šä¸ï¼Œæˆ‘ä»¬æŠŠä¸€åˆ‡éƒ½æ”¾è¿› JS é‡Œï¼è¿™æ ·ï¼ŒUI æè¿°å’Œé€»è¾‘ç´§å¯†è€¦åˆï¼Œä»£ç æ›´æ˜“ç»´æŠ¤ã€‚</p>
<p>æ¥çœ‹ä¸ªç®€å•å¯¹æ¯”ï¼š</p>
<ul>
<li>
<p>ä¸ä½¿ç”¨ JSXï¼ˆçº¯ createElementï¼‰ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> element = <span class="hljs-title function_">createElement</span>(<span class="hljs-string">'h2'</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">'JSX æ˜¯ React ä¸­ç”¨äºæè¿°ç”¨æˆ·ç•Œé¢çš„è¯­æ³•æ‰©å±•'</span>);
</code></pre>
</li>
<li>
<p>ä½¿ç”¨ JSXï¼ˆè¯­æ³•ç³–ï¼‰ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> element = <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>JSX æ˜¯ React ä¸­ç”¨äºæè¿°ç”¨æˆ·ç•Œé¢çš„è¯­æ³•æ‰©å±•<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span>;
</code></pre>
</li>
</ul>
<p>æ˜æ˜¾åè€…æ›´ç›´è§‚ã€å¯è¯»æ€§æ›´é«˜ï¼JSX æœ¬è´¨ä¸Šæ˜¯ <code>React.createElement</code> çš„è¯­æ³•ç³–ï¼ŒBabel ä¼šå¸®æˆ‘ä»¬ç¼–è¯‘æˆåè€…ã€‚</p>
<p><strong>æ³¨</strong>ï¼šBabel æ˜¯ä¸€ä¸ªå¼€æºçš„ JavaScript ç¼–è¯‘å™¨ï¼Œæ›´å‡†ç¡®åœ°è¯´ï¼Œæ˜¯ä¸€ä¸ª è½¬è¯‘å™¨ã€‚å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ï¼šæŠŠç°ä»£ JavaScript ä»£ç ï¼ˆES2015+ï¼Œä¹Ÿå°±æ˜¯ ES6 åŠæ›´é«˜ç‰ˆæœ¬ï¼‰è½¬æ¢æˆå‘åå…¼å®¹çš„æ—§ç‰ˆ JavaScript ä»£ç ï¼Œè®©è¿™äº›ä»£ç èƒ½åœ¨è€æµè§ˆå™¨æˆ–æ—§ç¯å¢ƒä¸­æ­£å¸¸è¿è¡Œã€‚</p>
<p><strong>åº•å±‚é€»è¾‘</strong>ï¼šJSX è¢« Babel è½¬è¯‘åï¼Œç”Ÿæˆ Virtual DOM å¯¹è±¡æ ‘ã€‚React ç”¨è¿™ä¸ªè™šæ‹Ÿæ ‘å¯¹æ¯”çœŸå® DOMï¼Œåªæ›´æ–°å˜åŒ–éƒ¨åˆ†ï¼Œè¿™å°±æ˜¯ React é«˜æ€§èƒ½çš„ç§˜å¯†â€”â€”Diff ç®—æ³• + æ‰¹é‡æ›´æ–°ã€‚</p>
<h4 data-id="heading-2">React vs Vueï¼šä¸ºä»€ä¹ˆ React æ›´â€œæ¿€è¿›â€ï¼Ÿ</h4>
<p>Vue å’Œ React éƒ½æ˜¯ç°ä»£å‰ç«¯æ¡†æ¶çš„ä»£è¡¨ï¼Œéƒ½æ”¯æŒ<strong>å“åº”å¼ã€æ•°æ®ç»‘å®šå’Œç»„ä»¶åŒ–</strong>ã€‚ä½† React æ›´çº¯ç²¹ã€æ›´æ¿€è¿›ã€‚</p>
<ul>
<li><strong>Vue</strong>ï¼šæ¨¡æ¿ã€è„šæœ¬ã€æ ·å¼ä¸‰åˆ†ç¦»ï¼ˆå•æ–‡ä»¶ç»„ä»¶ .vueï¼‰ï¼Œä¸Šæ‰‹å‹å¥½ï¼ŒåŒå‘ç»‘å®š v-model è¶…çº§æ–¹ä¾¿ã€‚é€‚åˆå¿«é€ŸåŸå‹å¼€å‘ã€‚</li>
<li><strong>React</strong>ï¼šä¸€åˆ‡çš† JSï¼JSX æŠŠæ¨¡æ¿å¡è¿› JSï¼Œå•å‘æ•°æ®æµï¼ˆprops down, events upï¼‰ï¼Œé€»è¾‘æ›´æ˜ç¡®ï¼Œä½†å­¦ä¹ æ›²çº¿é™¡å³­ã€‚</li>
</ul>
<p>React çš„æ¿€è¿›åœ¨äºï¼šå®ƒä¸æä¾›â€œå¼€ç®±å³ç”¨â€çš„æ¨¡æ¿è¯­æ³•ï¼Œè€Œæ˜¯è®©ä½ ç”¨å®Œæ•´çš„ JavaScript èƒ½åŠ›æ„å»º UIã€‚ä½ å¯ä»¥ç”¨ ifã€mapã€å˜é‡ç­‰<strong>åŸç”Ÿ JS æ§åˆ¶æ¸²æŸ“</strong>ï¼Œè€Œ Vue æ¨¡æ¿éœ€è¦æŒ‡ä»¤ï¼ˆå¦‚ v-ifã€v-forï¼‰ã€‚</p>
<p>ä¸ºä»€ä¹ˆå¾ˆå¤šäººè¯´ React å…¥é—¨é—¨æ§›é«˜ï¼Ÿå› ä¸ºå®ƒå¼ºåˆ¶ä½ æ€è€ƒâ€œç»„ä»¶æ ‘â€å’Œâ€œçŠ¶æ€æµâ€ï¼Œè€Œä¸æ˜¯é æ¨¡æ¿é­”æ³•ã€‚ä½†ä¸€æ—¦ä¸Šæ‰‹ï¼Œä½ ä¼šå‘ç°å®ƒåœ¨å¤§å‹é¡¹ç›®ä¸­æ›´å¯æ§ã€æ›´çµæ´»ã€‚Facebookã€Netflix éƒ½åœ¨ç”¨ Reactï¼Œå°±æ˜¯å› ä¸ºç»„ä»¶åŒ–è®©ä»£ç åƒ<strong>ä¹é«˜ç§¯æœ¨ä¸€æ ·å¯å¤ç”¨</strong>ã€‚</p>
<h4 data-id="heading-3">ç»„ä»¶åŒ–å¼€å‘ï¼šä» DOM æ ‘åˆ°ç»„ä»¶æ ‘</h4>
<p>ä¼ ç»Ÿå‰ç«¯é  DOM æ“ä½œï¼Œå®¡æŸ¥å…ƒç´ æ˜¯å±‚å±‚ divã€‚React è¯´ï¼šä¸ï¼Œæˆ‘ä»¬ç”¨<strong>ç»„ä»¶æ ‘</strong>ä»£æ›¿ DOM æ ‘ï¼</p>
<p>ç»„ä»¶æ˜¯ React çš„åŸºæœ¬å•ä½ï¼Œæ¯ä¸ªç»„ä»¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ˆç°ä»£ React æ¨èå‡½æ•°ç»„ä»¶ï¼‰ï¼Œè¿”å› JSX æè¿° UIã€‚</p>
<p>æ¥çœ‹ä¸€ä¸ªæ¨¡æ‹Ÿæ˜é‡‘é¦–é¡µçš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">JuejinHeader</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>æ˜é‡‘çš„é¦–é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Articles</span> = (<span class="hljs-params"/>) =&gt; <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span>Articles<span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span></span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">JuejinHeader</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Articles</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">aside</span>&gt;</span>{/* ä¾§è¾¹æ ç»„ä»¶ */}<span class="hljs-tag">&lt;/<span class="hljs-name">aside</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<p>è¿™é‡Œï¼Œ<strong>App æ˜¯æ ¹ç»„ä»¶ï¼Œç»„åˆäº†å­ç»„ä»¶</strong>ã€‚å°±åƒåŒ…å·¥å¤´åˆ†å·¥ï¼šHeader è´Ÿè´£å¤´éƒ¨ï¼ŒArticles è´Ÿè´£æ–‡ç« åˆ—è¡¨ã€‚é¡µé¢å°±æ˜¯è¿™äº›ç»„ä»¶æ­èµ·æ¥çš„ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3603be53c6a143bdb673ca8fe7c48158~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5LyaanM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766234036&amp;x-signature=LJIoAt0wsD4p%2Bz7pE5bVt0c6wws%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™å¼ å›¾çš„<strong>æ ¸å¿ƒ</strong>å°±æ˜¯ï¼šæŠŠå¤æ‚ UI æ‹†åˆ†æˆ<strong>ç»„ä»¶æ ‘</strong>ï¼Œæ¯ä¸ªç»„ä»¶ä¸“æ³¨è‡ªå·±çš„äº‹ï¼Œé€šè¿‡ç»„åˆæ„å»ºæ•´ä¸ªé¡µé¢ã€‚</p>
<p><strong>å…³é”®ç‚¹ï¼šç»„ä»¶å¤ç”¨</strong></p>
<ul>
<li>ä½ ä¼šæ³¨æ„åˆ° <strong>FancyText</strong> å‡ºç°äº†ä¸¤æ¬¡ï¼ˆä¸€ä¸ªç›´æ¥åœ¨ App ä¸‹ï¼Œä¸€ä¸ªåœ¨ InspirationGenerator ä¸‹ï¼‰ã€‚</li>
<li>è¿™å°±æ˜¯åœ¨å¼ºè°ƒï¼šåŒä¸€ä¸ªç»„ä»¶å¯ä»¥è¢«å¤šä¸ªçˆ¶ç»„ä»¶å¤šæ¬¡æ¸²æŸ“å’Œå¤ç”¨ï¼è¿™æ­£æ˜¯ React ç»„ä»¶åŒ–å¼€å‘çš„å¼ºå¤§ä¹‹å¤„â€”â€”å†™ä¸€æ¬¡ï¼Œåˆ°å¤„ç”¨ï¼Œåƒä¹é«˜ç§¯æœ¨ä¸€æ ·ç»„åˆã€‚</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆå‡½æ•°åšç»„ä»¶ï¼Ÿ</strong> å› ä¸ºå‡½æ•°çº¯å‡€ã€æ— å‰¯ä½œç”¨ï¼Œèƒ½å®Œç¾å°è£… UI + é€»è¾‘ + çŠ¶æ€ã€‚ç±»ç»„ä»¶ï¼ˆæ—§æ–¹å¼ï¼‰æœ‰ this ç»‘å®šé—®é¢˜ï¼Œå‡½æ•°ç»„ä»¶ + Hooks è§£å†³äº†è¿™ä¸€åˆ‡ã€‚</p>
<p><strong>åº•å±‚é€»è¾‘</strong>ï¼šReact æ¸²æŸ“æ—¶ï¼Œä¼šé€’å½’è°ƒç”¨æ¯ä¸ªç»„ä»¶çš„ render å‡½æ•°ï¼Œæœ€ç»ˆç”Ÿæˆä¸€æ£µå®Œæ•´çš„ Virtual DOM æ ‘ã€‚ä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªç»„ä»¶æ¸²æŸ“ç”Ÿæˆ Virtual DOM ç‰‡æ®µï¼ŒReact åˆå¹¶æˆä¸€æ£µå¤§æ ‘ã€‚æ›´æ–°æ—¶ï¼Œåªé‡æ¸²æŸ“å˜åŒ–çš„ç»„ä»¶å­æ ‘ã€‚</p>
<h4 data-id="heading-4">useStateï¼šè®©å‡½æ•°ç»„ä»¶æ‹¥æœ‰â€œè®°å¿†â€</h4>
<p>ç»„ä»¶éœ€è¦äº¤äº’ï¼Ÿå°±éœ€è¦çŠ¶æ€ï¼useState æ˜¯ Hooks çš„å…¥é—¨ç‹ç‰Œã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [name, setName] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">'vue'</span>); <span class="hljs-comment">// åˆå§‹å€¼ 'vue'</span>
  <span class="hljs-keyword">const</span> [todos, setTodos] = <span class="hljs-title function_">useState</span>([
    { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'å­¦ä¹  React'</span>, <span class="hljs-attr">done</span>: <span class="hljs-literal">false</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'å­¦ä¹  Node'</span>, <span class="hljs-attr">done</span>: <span class="hljs-literal">false</span> }
  ]);
  <span class="hljs-keyword">const</span> [isLoggedIn, setIsLoggedIn] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">toggleLogin</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-title function_">setIsLoggedIn</span>(!isLoggedIn);

  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setName</span>(<span class="hljs-string">'react'</span>), <span class="hljs-number">3000</span>); <span class="hljs-comment">// 3ç§’åè‡ªåŠ¨æ›´æ–°</span>

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"title"</span>&gt;</span>{name}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      {todos.length &gt; 0 ? (
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          {todos.map(todo =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.id}</span>&gt;</span>{todo.title}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      ) : (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>æš‚æ— å¾…åŠäº‹é¡¹<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
      {isLoggedIn ? <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>å·²ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span> : <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>æœªç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{toggleLogin}</span>&gt;</span>
        {isLoggedIn ? 'é€€å‡ºç™»å½•' : 'ç™»å½•'}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
}
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/602ea411b6594fcfafc5a4e077ffab47~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5LyaanM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766234036&amp;x-signature=raSSL1ZCSWTI%2BdAjscvOMEuv2n0%3D" alt="image.png" loading="lazy"/></p>
<p>useState è¿”å› [çŠ¶æ€å€¼, æ›´æ–°å‡½æ•°]ã€‚è°ƒç”¨æ›´æ–°å‡½æ•°ä¼šè§¦å‘é‡æ¸²æŸ“ï¼ŒReact è®°ä½æœ€æ–°çŠ¶æ€ã€‚</p>
<p>å‡½æ•°ç»„ä»¶ + Hooksï¼Œä»£ç æ›´ç®€æ´ã€å¤ç”¨æ€§æ›´å¼ºã€‚å¸¸è§ Hooksï¼š</p>
<ul>
<li>useStateï¼šç®¡ç†çŠ¶æ€</li>
<li>useEffectï¼šå¤„ç†å‰¯ä½œç”¨ï¼ˆæ•°æ®è·å–ã€è®¢é˜…ç­‰ï¼‰</li>
<li>useContextã€useReducerã€useRef ç­‰</li>
</ul>
<p><strong>æ˜“é”™æé†’</strong>ï¼š</p>
<h5 data-id="heading-5">setState æ˜¯å¼‚æ­¥çš„ï¼å¤šä¸ª setState å¯èƒ½æ‰¹å¤„ç†ï¼Œä¸è¦ç›´æ¥ä¾èµ–æ—§å€¼ã€‚</h5>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// é”™ï¼šå¯èƒ½åŠ 1å¤šæ¬¡åªåŠ 1</span>
<span class="hljs-title function_">setCount</span>(count + <span class="hljs-number">1</span>);

<span class="hljs-comment">// å¯¹ï¼šå‡½æ•°å¼æ›´æ–°</span>
<span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> prev + <span class="hljs-number">1</span>);
</code></pre>
<ul>
<li>
<p>åœ¨åŒä¸€ä¸ªäº‹ä»¶ï¼ˆå¦‚ onClickï¼‰é‡Œï¼ŒReact <strong>ä¸ä¼šç«‹å³æ›´æ–°çŠ¶æ€</strong>ï¼Œè€Œæ˜¯æŠŠæ‰€æœ‰ setCount è°ƒç”¨<strong>æ”¶é›†åˆ°ä¸€ä¸ªé˜Ÿåˆ—</strong>é‡Œã€‚</p>
</li>
<li>
<p>æ‰€æœ‰ setCount æ‰§è¡Œæ—¶ï¼Œçœ‹åˆ°çš„ <strong>count éƒ½æ˜¯å½“å‰æ¸²æŸ“çš„â€œå¿«ç…§å€¼â€</strong> ï¼ˆè¿™é‡Œæ˜¯ 0ï¼‰ã€‚</p>
</li>
<li>
<p>ç­‰äº‹ä»¶ç»“æŸï¼ŒReact ä¸€æ¬¡æ€§å¤„ç†é˜Ÿåˆ—ï¼šä¸¤æ¬¡éƒ½æ˜¯ â€œ0 + 1 = 1â€ï¼Œæœ€åè¦†ç›–æˆåŒä¸€ä¸ªå€¼ 1ï¼Œåªé‡æ¸²æŸ“ä¸€æ¬¡ã€‚</p>
</li>
</ul>
<h4 data-id="heading-6">å¯¹è±¡çŠ¶æ€æ›´æ–°ä¸ä¼šè‡ªåŠ¨åˆå¹¶ï¼Œç”¨å±•å¼€è¿ç®—ç¬¦ï¼š</h4>
<h5 data-id="heading-7">é”™çš„ä¾‹å­ï¼šç›´æ¥æ›¿æ¢å¯¹è±¡ï¼Œä¼šä¸¢å¤±å±æ€§</h5>
<p>å‡è®¾åˆå§‹çŠ¶æ€æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">const</span> [person, setPerson] = <span class="hljs-title function_ invoke__">useState</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  <span class="hljs-attr">city</span>: <span class="hljs-string">'Beijing'</span>
});
</code></pre>
<p>å¦‚æœä½ æƒ³åªæ”¹ ageï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// é”™ï¼ç›´æ¥ä¼ æ–°å¯¹è±¡</span>
<span class="hljs-built_in">setPerson</span>({ age: <span class="hljs-number">35</span> });
</code></pre>
<p>ç»“æœï¼šæ–°çŠ¶æ€å˜æˆ { age: 35 }ï¼Œname å’Œ city å…¨æ²¡äº†ï¼å› ä¸º React ç›´æ¥ç”¨ä½ ä¼ çš„å¯¹è±¡æ›¿æ¢äº†æ•´ä¸ªçŠ¶æ€ã€‚</p>
<h4 data-id="heading-8">æ­£ç¡®çš„åšæ³•ï¼šç”¨å±•å¼€è¿ç®—ç¬¦ï¼ˆ...prevï¼‰æ‰‹åŠ¨åˆå¹¶</h4>
<p>jsx</p>
<pre><code class="hljs language-ini" lang="ini">// å¯¹ï¼å‡½æ•°å¼æ›´æ–° + å±•å¼€è¿ç®—ç¬¦
setPerson(<span class="hljs-attr">prev</span> =&gt; ({ ...prev, age: <span class="hljs-number">35</span> }))<span class="hljs-comment">;</span>
</code></pre>
<p>è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>prev æ˜¯å½“å‰æœ€æ–°çš„çŠ¶æ€å¯¹è±¡ï¼ˆ{ name: 'Alice', age: 30, city: 'Beijing' }ï¼‰</li>
<li>{ ...prev }ï¼šç”¨ ES6 å±•å¼€è¿ç®—ç¬¦æŠŠ prev çš„æ‰€æœ‰å±æ€§å¤åˆ¶åˆ°ä¸€ä¸ªæ–°å¯¹è±¡é‡Œ â†’ { name: 'Alice', age: 30, city: 'Beijing' }</li>
<li>age: 35ï¼šè¦†ç›– age å±æ€§</li>
<li>æœ€ç»ˆè¿”å›æ–°å¯¹è±¡ï¼š{ name: 'Alice', age: 35, city: 'Beijing' }</li>
</ul>
<p>å®Œç¾ï¼åªæ”¹äº† ageï¼Œå…¶ä»–å±æ€§ä¿ç•™äº†ã€‚</p>
<h4 data-id="heading-9">JSX å¸¸è§å‘ä¸æœ€ä½³å®è·µ</h4>
<p>JSX å¼ºå¤§ï¼Œä½†ä¹Ÿæœ‰é™·é˜±ï¼š</p>
<ol>
<li>
<p><strong>class â†’ className</strong>ï¼šclass æ˜¯ JS å…³é”®å­—ï¼Œå¿…é¡»ç”¨ classNameã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx">&lt;div className=<span class="hljs-string">"title"</span>&gt;é”™è¯¯ä¼šæŠ¥é”™ï¼&lt;/div&gt;
</code></pre>
</li>
<li>
<p><strong>æœ€å¤–å±‚å¿…é¡»å•æ ¹å…ƒç´ </strong>ï¼š</p>
</li>
</ol>
<p>JSX çš„ return å¿…é¡»è¿”å›<strong>ä¸€ä¸ª</strong>å…ƒç´ ï¼ˆæˆ– nullï¼‰ï¼Œä¸èƒ½ç›´æ¥è¿”å›å¤šä¸ªå¹¶åˆ—å…ƒç´ ã€‚</p>
<p>é”™çš„ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">return</span> (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ®µè½<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>  <span class="hljs-comment">// æŠ¥é”™ï¼Adjacent JSX elements must be wrapped...</span>
);
</code></pre>
<p>å› ä¸º JSX æœ€ç»ˆè½¬è¯‘æˆ React.createElement è°ƒç”¨ï¼Œè€Œå‡½æ•°è¿”å›å€¼åªèƒ½æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ã€‚</p>
<p>æ­£ç¡®åšæ³•ï¼šç”¨ <strong>Fragment &lt;&gt; &lt;/&gt;</strong> åŒ…è£¹ï¼ˆä¸æ¸²æŸ“å¤šä½™ DOMï¼‰</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">return</span> (
  <span class="xml"><span class="hljs-tag">&lt;&gt;</span>  {/* çŸ­è¯­æ³• */}
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ®µè½<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/&gt;</span></span>
);

<span class="hljs-comment">// æˆ–</span>
<span class="hljs-keyword">return</span> (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">React.Fragment</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ®µè½<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">React.Fragment</span>&gt;</span></span>
);
</code></pre>
<p>3.  <strong>è¡¨è¾¾å¼ç”¨ {}</strong>ï¼šæ’å€¼ã€æ¡ä»¶ã€ä¸‰å…ƒã€map éƒ½ç”¨å¤§æ‹¬å·ã€‚
<code>jsx     {condition ? &lt;A /&gt; : &lt;B /&gt;}     </code></p>
<ol start="4">
<li>
<p><strong>key å¿…åŠ </strong>ï¼šåˆ—è¡¨æ¸²æŸ“ map æ—¶ï¼ŒåŠ å”¯ä¸€ keyï¼Œå¸®åŠ© React é«˜æ•ˆ Diffã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx">{todos.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.id}</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span>)}
</code></pre>
<p>ç¼º key ä¼šè­¦å‘Šï¼Œæ€§èƒ½å·®ã€‚</p>
</li>
<li>
<p><strong>äº‹ä»¶ç”¨ camelCase</strong>ï¼šonClickï¼Œä¸æ˜¯ onclickã€‚</p>
</li>
<li>
<p><strong>è‡ªé—­åˆæ ‡ç­¾</strong>ï¼šå•æ ‡ç­¾å¿…é¡»é—­åˆï¼Œå¦‚ <code>&lt;img /&gt;</code>ã€‚</p>
</li>
</ol>
<h4 data-id="heading-10">æ ¹ç»„ä»¶æŒ‚è½½ï¼šä» main.jsx çœ‹ React å¯åŠ¨</h4>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { createRoot } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom/client'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.jsx'</span>;

<span class="hljs-title function_">createRoot</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'root'</span>)).<span class="hljs-title function_">render</span>(
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>
);
</code></pre>
<h4 data-id="heading-11">1. è¿™æ®µä»£ç åœ¨å¹²å•¥ï¼Ÿä¸€æ­¥æ­¥æ‹†è§£</h4>
<ul>
<li>
<p><strong>document.getElementById('root')</strong> ï¼šæ‰¾åˆ° HTML æ–‡ä»¶é‡Œçš„æŒ‚è½½ç‚¹ã€‚é€šå¸¸ index.html æœ‰ä¸ª </p><div id="user-content-root"/>ï¼ŒReact ä¼šæŠŠæ•´ä¸ªåº”ç”¨å¡è¿›å»ï¼Œæ¥ç®¡è¿™ä¸ª div é‡Œçš„æ‰€æœ‰å†…å®¹ã€‚<p/>
</li>
<li>
<p><strong>createRoot(...)</strong> ï¼šåˆ›å»º React çš„â€œæ ¹â€ï¼ˆRootï¼‰ã€‚å®ƒè¿”å›ä¸€ä¸ª Root å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡è´Ÿè´£ç®¡ç†æ•´ä¸ªç»„ä»¶æ ‘å’Œ DOM æ›´æ–°ã€‚</p>
</li>
<li>
<p><strong>.render()</strong> ï¼šå‘Šè¯‰ Reactï¼šâ€œå˜¿ï¼Œä»ç°åœ¨å¼€å§‹æ¸²æŸ“ App ç»„ä»¶å§ï¼â€React ä¼šä» App å¼€å§‹é€’å½’æ¸²æŸ“ç»„ä»¶æ ‘ï¼Œç”Ÿæˆ Virtual DOMï¼Œæœ€ç»ˆ commit åˆ°çœŸå® DOMã€‚</p>
</li>
</ul>
<p>æ•´ä¸ªè¿‡ç¨‹ï¼š<strong>åˆ›å»ºæ ¹ â†’ åˆå§‹æ¸²æŸ“ â†’ æ¥ç®¡ DOM</strong>ã€‚åº”ç”¨å¯åŠ¨åï¼ŒReact å°±å®Œå…¨æŒæ§äº† #root é‡Œçš„ UIã€‚</p>
<h4 data-id="heading-12">æ€»ç»“ï¼šä¸ºä»€ä¹ˆé€‰æ‹© React å’Œ JSXï¼Ÿ</h4>
<p>JSX è®© React æˆä¸ºâ€œ<strong>å…¨æ ˆ JS</strong>â€çš„ä»£è¡¨ï¼šé€»è¾‘ã€è§†å›¾ã€çŠ¶æ€å…¨åœ¨ JS é‡Œã€‚ç»„ä»¶åŒ–è®©ä½ åƒå»ºç­‘å¸ˆä¸€æ ·è®¾è®¡é¡µé¢ï¼ŒuseState ç­‰ Hooks è®©å‡½æ•°ç»„ä»¶å¼ºå¤§æ— æ¯”ã€‚</p>
<p>ç›¸æ¯” Vueï¼ŒReact æ›´é€‚åˆå¤§å‹ã€å¤æ‚åº”ç”¨ï¼ˆç”Ÿæ€ä¸°å¯Œï¼ŒTypeScript æ”¯æŒä¸€æµï¼‰ã€‚ä½† Vue ä¸Šæ‰‹æ›´å¿«ï¼Œé€‚åˆä¸­å°é¡¹ç›®ã€‚</p>
<p>å­¦ Reactï¼Œä¸æ˜¯å­¦è¯­æ³•ï¼Œè€Œæ˜¯å­¦â€œå£°æ˜å¼ç¼–ç¨‹â€å’Œâ€œç»„ä»¶æ€ç»´â€ã€‚æŒæ¡ JSXï¼Œä½ å°±æŒæ¡äº† React çš„åŠå£æ±Ÿå±±ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RequireJS è¯¦è§£]]></title>    <link>https://juejin.cn/post/7582857981894705193</link>    <guid>https://juejin.cn/post/7582857981894705193</guid>    <pubDate>2025-12-13T13:13:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582857981894705193" data-draft-id="7582879379442040875" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RequireJS è¯¦è§£"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-13T13:13:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åœ¨æ˜é‡‘80110"/> <meta itemprop="url" content="https://juejin.cn/user/4195392103913143"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RequireJS è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4195392103913143/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åœ¨æ˜é‡‘80110
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T13:13:53.000Z" title="Sat Dec 13 2025 13:13:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">RequireJS è¯¦è§£</h2>
<p>RequireJS æ˜¯ä¸€ä¸ªåŸºäº <strong>AMDï¼ˆAsynchronous Module Definitionï¼Œå¼‚æ­¥æ¨¡å—å®šä¹‰ï¼‰</strong> è§„èŒƒçš„ JavaScript æ¨¡å—åŠ è½½å™¨ï¼Œä¸»è¦è§£å†³æµè§ˆå™¨ç«¯æ¨¡å—åŒ–å¼€å‘çš„ä¾èµ–ç®¡ç†ã€å¼‚æ­¥åŠ è½½é—®é¢˜ï¼Œé¿å…ä¼ ç»Ÿ <code>&lt;script&gt;</code> æ ‡ç­¾åŠ è½½çš„é˜»å¡å’Œä¾èµ–æ··ä¹±é—®é¢˜ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€æ ¸å¿ƒä¼˜åŠ¿</h3>
<ol>
<li><strong>å¼‚æ­¥åŠ è½½</strong>ï¼šæ¨¡å—æŒ‰éœ€å¼‚æ­¥åŠ è½½ï¼Œé¿å…é˜»å¡é¡µé¢æ¸²æŸ“ï¼›</li>
<li><strong>ä¾èµ–ç®¡ç†</strong>ï¼šæ˜ç¡®å£°æ˜æ¨¡å—ä¾èµ–ï¼Œè‡ªåŠ¨æŒ‰é¡ºåºåŠ è½½ä¾èµ–æ¨¡å—ï¼›</li>
<li><strong>æ¨¡å—åŒ–å°è£…</strong>ï¼šéš”ç¦»æ¨¡å—ä½œç”¨åŸŸï¼Œé¿å…å…¨å±€å˜é‡æ±¡æŸ“ï¼›</li>
<li><strong>è·¨ç¯å¢ƒå…¼å®¹</strong>ï¼šæ”¯æŒæµè§ˆå™¨ç«¯ï¼Œä¹Ÿå¯é…åˆå·¥å…·ï¼ˆå¦‚ r.jsï¼‰æ‰“åŒ…ä¸ºç”Ÿäº§ç¯å¢ƒçš„å•æ–‡ä»¶ã€‚</li>
</ol>
<h3 data-id="heading-2">äºŒã€å¿«é€Ÿä¸Šæ‰‹</h3>
<h4 data-id="heading-3">1. å¼•å…¥ RequireJS</h4>
<p>ä¸‹è½½ RequireJSï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Frequirejs.org%2F" target="_blank" title="https://requirejs.org/" ref="nofollow noopener noreferrer">å®˜ç½‘</a>ï¼‰ï¼Œæˆ–é€šè¿‡ CDN å¼•å…¥ï¼Œåœ¨ HTML ä¸­é€šè¿‡ <code>&lt;script&gt;</code> æ ‡ç­¾åŠ è½½ï¼ŒæŒ‡å®šå…¥å£æ¨¡å—ï¼ˆ<code>data-main</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- å¼•å…¥ require.jsï¼Œå¹¶æŒ‡å®šå…¥å£æ¨¡å—ä¸º main.js --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.js"</span> <span class="hljs-attr">data-main</span>=<span class="hljs-string">"js/main"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<ul>
<li><code>data-main</code>ï¼šæŒ‡å®šåº”ç”¨çš„å…¥å£æ¨¡å—ï¼ˆåç¼€ <code>.js</code> å¯çœç•¥ï¼‰ï¼›</li>
<li>RequireJS ä¼šè‡ªåŠ¨åŠ è½½ <code>main.js</code>ï¼Œå¹¶ä»¥å®ƒä¸ºèµ·ç‚¹ç®¡ç†æ‰€æœ‰æ¨¡å—ã€‚</li>
</ul>
<h4 data-id="heading-4">2. å®šä¹‰æ¨¡å—</h4>
<p>RequireJS ä¸­æ¨¡å—é€šè¿‡ <code>define()</code> å®šä¹‰ï¼Œåˆ†ä¸‰ç§åœºæ™¯ï¼š</p>
<h5 data-id="heading-5">ï¼ˆ1ï¼‰æ— ä¾èµ–æ¨¡å—</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// js/modules/hello.js</span>
<span class="hljs-title function_">define</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">sayHello</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, <span class="hljs-subst">${name}</span>!`</span>;
    }
  };
});
</code></pre>
<h5 data-id="heading-6">ï¼ˆ2ï¼‰æœ‰ä¾èµ–æ¨¡å—</h5>
<p>ä¾èµ–æ¨¡å—é€šè¿‡æ•°ç»„å£°æ˜ï¼Œå›è°ƒå‡½æ•°çš„å‚æ•°ä¸ä¾èµ–ä¸€ä¸€å¯¹åº”ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// js/modules/user.js</span>
<span class="hljs-title function_">define</span>([<span class="hljs-string">'./hello'</span>], <span class="hljs-keyword">function</span>(<span class="hljs-params">hello</span>) { <span class="hljs-comment">// ä¾èµ–åŒç›®å½•çš„ hello.js</span>
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">greet</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">username</span>) {
      <span class="hljs-keyword">return</span> hello.<span class="hljs-title function_">sayHello</span>(username);
    }
  };
});
</code></pre>
<h5 data-id="heading-7">ï¼ˆ3ï¼‰å‘½åæ¨¡å—ï¼ˆä¸æ¨èï¼ŒRequireJS ä¼šè‡ªåŠ¨æ ¹æ®æ–‡ä»¶è·¯å¾„ç”Ÿæˆæ¨¡å—åï¼‰</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ˜¾å¼æŒ‡å®šæ¨¡å—åï¼ˆä¸€èˆ¬ç”¨äºç¬¬ä¸‰æ–¹åº“ï¼‰</span>
<span class="hljs-title function_">define</span>(<span class="hljs-string">'myModule'</span>, [<span class="hljs-string">'jquery'</span>], <span class="hljs-keyword">function</span>(<span class="hljs-params">$</span>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">init</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
      $(<span class="hljs-string">'body'</span>).<span class="hljs-title function_">css</span>(<span class="hljs-string">'background'</span>, <span class="hljs-string">'#f5f5f5'</span>);
    }
  };
});
</code></pre>
<h4 data-id="heading-8">3. åŠ è½½æ¨¡å—</h4>
<p>é€šè¿‡ <code>require()</code> åŠ è½½æ¨¡å—å¹¶æ‰§è¡Œé€»è¾‘ï¼Œé€šå¸¸åœ¨å…¥å£æ¨¡å— <code>main.js</code> ä¸­ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// js/main.js</span>
<span class="hljs-comment">// é…ç½®æ¨¡å—è·¯å¾„ï¼ˆå¯é€‰ï¼Œæ¨èï¼‰</span>
<span class="hljs-built_in">require</span>.<span class="hljs-title function_">config</span>({
  <span class="hljs-comment">// åŸºç¡€è·¯å¾„ï¼šæ‰€æœ‰æ¨¡å—çš„æ ¹è·¯å¾„</span>
  <span class="hljs-attr">baseUrl</span>: <span class="hljs-string">'js'</span>,
  <span class="hljs-comment">// è·¯å¾„æ˜ å°„ï¼šç®€åŒ–é•¿è·¯å¾„/ç¬¬ä¸‰æ–¹åº“åˆ«å</span>
  <span class="hljs-attr">paths</span>: {
    <span class="hljs-string">'jquery'</span>: <span class="hljs-string">'https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min'</span>, <span class="hljs-comment">// CDN åŠ è½½</span>
    <span class="hljs-string">'user'</span>: <span class="hljs-string">'modules/user'</span>, <span class="hljs-comment">// æœ¬åœ°æ¨¡å—</span>
    <span class="hljs-string">'hello'</span>: <span class="hljs-string">'modules/hello'</span>
  },
  <span class="hljs-comment">// é AMD æ¨¡å—é€‚é…ï¼ˆå¦‚ä¸€äº›å…¨å±€å˜é‡å¼çš„åº“ï¼‰</span>
  <span class="hljs-attr">shim</span>: {
    <span class="hljs-string">'underscore'</span>: {
      <span class="hljs-attr">exports</span>: <span class="hljs-string">'_'</span> <span class="hljs-comment">// æš´éœ²å…¨å±€å˜é‡ _ ä½œä¸ºæ¨¡å—å¯¼å‡º</span>
    }
  }
});

<span class="hljs-comment">// åŠ è½½å¹¶ä½¿ç”¨æ¨¡å—</span>
<span class="hljs-built_in">require</span>([<span class="hljs-string">'jquery'</span>, <span class="hljs-string">'user'</span>], <span class="hljs-keyword">function</span>(<span class="hljs-params">$, user</span>) {
  $(<span class="hljs-variable language_">document</span>).<span class="hljs-title function_">ready</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> greetMsg = user.<span class="hljs-title function_">greet</span>(<span class="hljs-string">'RequireJS'</span>);
    $(<span class="hljs-string">'body'</span>).<span class="hljs-title function_">html</span>(<span class="hljs-string">`&lt;h1&gt;<span class="hljs-subst">${greetMsg}</span>&lt;/h1&gt;`</span>);
  });
});
</code></pre>
<h3 data-id="heading-9">ä¸‰ã€æ ¸å¿ƒ API è¯¦è§£</h3>
<h4 data-id="heading-10">1. <code>define()</code>ï¼šå®šä¹‰æ¨¡å—</h4>
<p>è¯­æ³•ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ— ä¾èµ–</span>
<span class="hljs-title function_">define</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-comment">/* æ¨¡å—é€»è¾‘ï¼Œreturn å¯¼å‡ºå†…å®¹ */</span> });

<span class="hljs-comment">// æœ‰ä¾èµ–</span>
<span class="hljs-title function_">define</span>([ä¾èµ–<span class="hljs-number">1</span>, ä¾èµ–<span class="hljs-number">2</span>], <span class="hljs-keyword">function</span>(<span class="hljs-params">æ¨¡å—<span class="hljs-number">1</span>, æ¨¡å—<span class="hljs-number">2</span></span>) { <span class="hljs-comment">/* é€»è¾‘ */</span> });

<span class="hljs-comment">// å‘½åæ¨¡å—</span>
<span class="hljs-title function_">define</span>(<span class="hljs-string">'æ¨¡å—å'</span>, [ä¾èµ–], <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-comment">/* é€»è¾‘ */</span> });
</code></pre>
<h4 data-id="heading-11">2. <code>require.config()</code>ï¼šå…¨å±€é…ç½®</h4>
<p>æ ¸å¿ƒé…ç½®é¡¹ï¼š</p>



































<table><thead><tr><th>é…ç½®é¡¹</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>baseUrl</code></td><td>æ¨¡å—åŠ è½½çš„åŸºç¡€è·¯å¾„</td><td><code>baseUrl: 'js/lib'</code></td></tr><tr><td><code>paths</code></td><td>æ¨¡å—è·¯å¾„æ˜ å°„ï¼ˆå¯çœç•¥ <code>.js</code>ï¼Œæ”¯æŒ CDNï¼‰</td><td><code>paths: { jquery: 'jquery-3.7.1' }</code></td></tr><tr><td><code>shim</code></td><td>é€‚é…é AMD æ¨¡å—ï¼ˆæš´éœ²å˜é‡ã€å£°æ˜ä¾èµ–ï¼‰</td><td><code>shim: { underscore: { exports: '_' } }</code></td></tr><tr><td><code>map</code></td><td>ä¸åŒç¯å¢ƒåŠ è½½ä¸åŒç‰ˆæœ¬æ¨¡å—</td><td><code>map: { '*': { 'jquery': 'jquery-2' } }</code></td></tr><tr><td><code>waitSeconds</code></td><td>æ¨¡å—åŠ è½½è¶…æ—¶æ—¶é—´ï¼ˆé»˜è®¤ 7 ç§’ï¼‰</td><td><code>waitSeconds: 10</code></td></tr></tbody></table>
<h4 data-id="heading-12">3. <code>require()</code>ï¼šåŠ è½½æ¨¡å—å¹¶æ‰§è¡Œ</h4>
<p>è¯­æ³•ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-built_in">require</span>([ä¾èµ–<span class="hljs-number">1</span>, ä¾èµ–<span class="hljs-number">2</span>], <span class="hljs-keyword">function</span>(<span class="hljs-params">æ¨¡å—<span class="hljs-number">1</span>, æ¨¡å—<span class="hljs-number">2</span></span>) {
  <span class="hljs-comment">// æ¨¡å—åŠ è½½å®Œæˆåçš„é€»è¾‘</span>
}, <span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) {
  <span class="hljs-comment">// åŠ è½½å¤±è´¥çš„å›è°ƒï¼ˆå¯é€‰ï¼‰</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ¨¡å—åŠ è½½å¤±è´¥ï¼š'</span>, err);
});
</code></pre>
<h3 data-id="heading-13">å››ã€å¸¸è§åœºæ™¯</h3>
<h4 data-id="heading-14">1. åŠ è½½ç¬¬ä¸‰æ–¹é AMD æ¨¡å—</h4>
<p>å¾ˆå¤šä¼ ç»Ÿåº“ï¼ˆå¦‚ Underscoreã€Backboneï¼‰ä¸æ˜¯ AMD æ¨¡å—ï¼Œéœ€é€šè¿‡ <code>shim</code> é€‚é…ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-built_in">require</span>.<span class="hljs-title function_">config</span>({
  <span class="hljs-attr">paths</span>: {
    <span class="hljs-attr">underscore</span>: <span class="hljs-string">'lib/underscore'</span>,
    <span class="hljs-attr">backbone</span>: <span class="hljs-string">'lib/backbone'</span>
  },
  <span class="hljs-attr">shim</span>: {
    <span class="hljs-attr">underscore</span>: {
      <span class="hljs-attr">exports</span>: <span class="hljs-string">'_'</span> <span class="hljs-comment">// æš´éœ²å…¨å±€å˜é‡ _</span>
    },
    <span class="hljs-attr">backbone</span>: {
      <span class="hljs-attr">deps</span>: [<span class="hljs-string">'underscore'</span>, <span class="hljs-string">'jquery'</span>], <span class="hljs-comment">// å£°æ˜ä¾èµ–</span>
      <span class="hljs-attr">exports</span>: <span class="hljs-string">'Backbone'</span> <span class="hljs-comment">// æš´éœ² Backbone</span>
    }
  }
});

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-built_in">require</span>([<span class="hljs-string">'backbone'</span>], <span class="hljs-keyword">function</span>(<span class="hljs-params">Backbone</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Backbone</span>);
});
</code></pre>
<h4 data-id="heading-15">2. åŠ¨æ€åŠ è½½æ¨¡å—</h4>
<p>é€šè¿‡ <code>require()</code> åŠ¨æ€åŠ è½½æ¨¡å—ï¼ˆå¦‚ç”¨æˆ·äº¤äº’åï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">$(<span class="hljs-string">'#loadModule'</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// åŠ¨æ€åŠ è½½ hello æ¨¡å—</span>
  <span class="hljs-built_in">require</span>([<span class="hljs-string">'modules/hello'</span>], <span class="hljs-keyword">function</span>(<span class="hljs-params">hello</span>) {
    <span class="hljs-title function_">alert</span>(hello.<span class="hljs-title function_">sayHello</span>(<span class="hljs-string">'åŠ¨æ€åŠ è½½'</span>));
  });
});
</code></pre>
<h4 data-id="heading-16">3. æ¨¡å—æ‰“åŒ…ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰</h4>
<p>å¼€å‘é˜¶æ®µæ¨¡å—åˆ†æ•£ï¼Œç”Ÿäº§ç¯å¢ƒéœ€æ‰“åŒ…ä¸ºå•æ–‡ä»¶ï¼Œä½¿ç”¨å®˜æ–¹å·¥å…· <strong>r.js</strong>ï¼š</p>
<ol>
<li>å®‰è£… r.jsï¼š<code>npm install -g requirejs</code>ï¼›</li>
<li>åˆ›å»ºæ‰“åŒ…é…ç½®æ–‡ä»¶ <code>build.js</code>ï¼š
<pre><code class="hljs language-javascript" lang="javascript">({
  <span class="hljs-attr">baseUrl</span>: <span class="hljs-string">'js'</span>,
  <span class="hljs-attr">name</span>: <span class="hljs-string">'main'</span>, <span class="hljs-comment">// å…¥å£æ¨¡å—</span>
  <span class="hljs-attr">out</span>: <span class="hljs-string">'js/build/main.min.js'</span>, <span class="hljs-comment">// è¾“å‡ºæ–‡ä»¶</span>
  <span class="hljs-attr">optimize</span>: <span class="hljs-string">'uglify2'</span> <span class="hljs-comment">// å‹ç¼©æ–¹å¼ï¼ˆuglify2/closure/noneï¼‰</span>
})
</code></pre>
</li>
<li>æ‰§è¡Œæ‰“åŒ…ï¼š<code>r.js -o build.js</code>ã€‚</li>
</ol>
<h3 data-id="heading-17">äº”ã€æ³¨æ„äº‹é¡¹</h3>
<ol>
<li><strong>æ¨¡å—è·¯å¾„é—®é¢˜</strong>ï¼š<code>baseUrl</code> æ˜¯ç›¸å¯¹ HTML æ–‡ä»¶çš„è·¯å¾„ï¼Œè€Œéé…ç½®æ–‡ä»¶ï¼›</li>
<li><strong>é¿å…å…¨å±€å˜é‡</strong>ï¼šæ¨¡å—å†…é€šè¿‡ <code>return</code> å¯¼å‡ºï¼Œä¸è¦éšæ„å®šä¹‰å…¨å±€å˜é‡ï¼›</li>
<li><strong>å¾ªç¯ä¾èµ–</strong>ï¼šAMD æ”¯æŒå¾ªç¯ä¾èµ–ï¼Œä½†éœ€é€šè¿‡ <code>require</code> å›è°ƒè·å–ä¾èµ–ï¼ˆè€Œéå‚æ•°ï¼‰ï¼š
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// a.js</span>
<span class="hljs-title function_">define</span>([<span class="hljs-string">'b'</span>], <span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">foo</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">return</span> b.<span class="hljs-title function_">bar</span>();
    }
  };
});

<span class="hljs-comment">// b.js</span>
<span class="hljs-title function_">define</span>([<span class="hljs-string">'a'</span>], <span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">bar</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">// å¾ªç¯ä¾èµ–æ—¶ï¼Œé€šè¿‡ require å®æ—¶è·å– a</span>
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">require</span>(<span class="hljs-string">'a'</span>).<span class="hljs-title function_">foo</span>() + <span class="hljs-string">' bar'</span>;
    }
  };
});
</code></pre>
</li>
<li><strong>ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–</strong>ï¼šåŠ¡å¿…ç”¨ r.js æ‰“åŒ…ï¼Œå‡å°‘ HTTP è¯·æ±‚ï¼›</li>
<li><strong>ES6 æ¨¡å—å…¼å®¹</strong>ï¼šRequireJS ä¹Ÿæ”¯æŒåŠ è½½ ES6 æ¨¡å—ï¼ˆéœ€é…ç½® <code>packages</code>ï¼‰ï¼Œä½†ç°ä»£é¡¹ç›®æ›´æ¨è ES6 Module + Webpack/Rollupã€‚</li>
</ol>
<h3 data-id="heading-18">å…­ã€ä¸ ES6 Module çš„åŒºåˆ«</h3>



































<table><thead><tr><th>ç‰¹æ€§</th><th>RequireJSï¼ˆAMDï¼‰</th><th>ES6 Module</th></tr></thead><tbody><tr><td>åŠ è½½æ–¹å¼</td><td>å¼‚æ­¥åŠ è½½ï¼ˆè¿è¡Œæ—¶åŠ è½½ï¼‰</td><td>é™æ€åŠ è½½ï¼ˆç¼–è¯‘æ—¶ç¡®å®šä¾èµ–ï¼‰</td></tr><tr><td>è¯­æ³•</td><td><code>define/require</code></td><td><code>import/export</code></td></tr><tr><td>ä½œç”¨åŸŸ</td><td>å‡½æ•°ä½œç”¨åŸŸ</td><td>å—çº§ä½œç”¨åŸŸ</td></tr><tr><td>æµè§ˆå™¨æ”¯æŒ</td><td>éœ€åŠ è½½å™¨ï¼ˆRequireJSï¼‰</td><td>ç°ä»£æµè§ˆå™¨åŸç”Ÿæ”¯æŒï¼ˆéœ€ <code>&lt;script type="module"&gt;</code>ï¼‰</td></tr><tr><td>åŠ¨æ€åŠ è½½</td><td>åŸç”Ÿæ”¯æŒ <code>require()</code></td><td>éœ€é…åˆ <code>import()</code> åŠ¨æ€å¯¼å…¥</td></tr></tbody></table>
<blockquote>
<p>æ³¨ï¼šç°ä»£å‰ç«¯é¡¹ç›®ï¼ˆReact/Vue/Angularï¼‰å·²æ™®éä½¿ç”¨ ES6 Module + æ„å»ºå·¥å…·ï¼ˆWebpack/Viteï¼‰ï¼Œä½† RequireJS ä»é€‚ç”¨äºè€é¡¹ç›®ç»´æŠ¤ã€éæ„å»ºå‹ç®€å•åº”ç”¨ã€‚</p>
</blockquote>
<h3 data-id="heading-19">ä¸ƒã€æ€»ç»“</h3>
<p>RequireJS æ˜¯æµè§ˆå™¨ç«¯æ¨¡å—åŒ–å¼€å‘çš„ç»å…¸è§£å†³æ–¹æ¡ˆï¼Œæ ¸å¿ƒæ˜¯é€šè¿‡ AMD è§„èŒƒå®ç°å¼‚æ­¥æ¨¡å—åŠ è½½å’Œä¾èµ–ç®¡ç†ã€‚å…¶ä¼˜åŠ¿æ˜¯è½»é‡ã€æ— éœ€æ„å»ºå·¥å…·å³å¯ä½¿ç”¨ï¼Œé€‚åˆä¸­å°å‹é¡¹ç›®æˆ–è€é¡¹ç›®ç»´æŠ¤ï¼›ç¼ºç‚¹æ˜¯è¯­æ³•ç›¸å¯¹ç¹çï¼Œç°ä»£é¡¹ç›®æ›´æ¨è ES6 Module + æ„å»ºå·¥å…·ã€‚</p>
<p>å¦‚æœéœ€è¦å…·ä½“åœºæ™¯çš„ä»£ç ç¤ºä¾‹ï¼ˆå¦‚å¾ªç¯ä¾èµ–å¤„ç†ã€æ‰“åŒ…ä¼˜åŒ–ï¼‰ï¼Œå¯ä»¥è¿›ä¸€æ­¥è¯´æ˜ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æˆ‘å¯¹é˜²æŠ–ï¼ˆDebounceï¼‰çš„ä¸€ç‚¹ç†è§£ä¸å®è·µï¼šä»åŸºç¡€åˆ°ç«‹å³æ‰§è¡Œ]]></title>    <link>https://juejin.cn/post/7582875640309202994</link>    <guid>https://juejin.cn/post/7582875640309202994</guid>    <pubDate>2025-12-13T13:53:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582875640309202994" data-draft-id="7582904738921381926" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æˆ‘å¯¹é˜²æŠ–ï¼ˆDebounceï¼‰çš„ä¸€ç‚¹ç†è§£ä¸å®è·µï¼šä»åŸºç¡€åˆ°ç«‹å³æ‰§è¡Œ"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-12-13T13:53:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="cindershade"/> <meta itemprop="url" content="https://juejin.cn/user/2587590326494763"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æˆ‘å¯¹é˜²æŠ–ï¼ˆDebounceï¼‰çš„ä¸€ç‚¹ç†è§£ä¸å®è·µï¼šä»åŸºç¡€åˆ°ç«‹å³æ‰§è¡Œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2587590326494763/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    cindershade
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T13:53:29.000Z" title="Sat Dec 13 2025 13:53:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    13
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æˆ‘å¯¹é˜²æŠ–ï¼ˆDebounceï¼‰çš„ä¸€ç‚¹ç†è§£ä¸å®è·µ</h2>
<blockquote>
<p>è¿™ç¯‡æ–‡ç« ä¸»è¦æ˜¯æˆ‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨é˜²æŠ–è¿‡ç¨‹ä¸­çš„ä¸€äº›æ€»ç»“ï¼Œ<strong>åªä»£è¡¨ä¸ªäººç†è§£</strong>ï¼Œå¦‚æœæœ‰ä¸ä¸¥è°¨æˆ–å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ï¼Œæ¬¢è¿æŒ‡å‡ºå’Œè®¨è®ºã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">ä¸€ã€é˜²æŠ–çš„æ¦‚å¿µ</h3>
<p><strong>é˜²æŠ–ï¼ˆDebounceï¼‰</strong> ï¼Œç®€å•æ¥è¯´å°±æ˜¯ï¼š</p>
<blockquote>
<p>åœ¨çŸ­æ—¶é—´å†…å¤šæ¬¡è§¦å‘åŒä¸€ä¸ªå‡½æ•°æ—¶ï¼Œåªè®©å®ƒåœ¨â€œåˆé€‚çš„æ—¶æœºâ€æ‰§è¡Œä¸€æ¬¡ã€‚</p>
</blockquote>
<p>å¸¸è§çš„ä¸¤ç§å½¢å¼ï¼š</p>
<ul>
<li><strong>å°¾è§¦å‘</strong>ï¼šåœæ­¢è§¦å‘ä¸€æ®µæ—¶é—´åæ‰æ‰§è¡Œ</li>
<li><strong>ç«‹å³æ‰§è¡Œ</strong>ï¼šç¬¬ä¸€æ¬¡è§¦å‘ç«‹åˆ»æ‰§è¡Œï¼Œéšåä¸€æ®µæ—¶é—´å†…ä¸å†æ‰§è¡Œ</li>
</ul>
<p>é˜²æŠ–æœ¬èº«å¹¶ä¸å¤æ‚ï¼ŒçœŸæ­£å¤æ‚çš„åœ°æ–¹åœ¨äºï¼š<strong>ä»€ä¹ˆæ—¶å€™è¯¥ç”¨å“ªä¸€ç§ï¼Œä»¥åŠå®ç°ç»†èŠ‚æ˜¯å¦å¯é ã€‚</strong></p>
<hr/>
<h3 data-id="heading-2">äºŒã€ä¸ºä»€ä¹ˆè¦åšé˜²æŠ–ï¼ˆé‡ç‚¹ï¼‰</h3>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œé«˜é¢‘è§¦å‘å‡ ä¹æ— å¤„ä¸åœ¨ï¼š</p>
<ul>
<li>ç”¨æˆ·å¿«é€Ÿç‚¹å‡»æŒ‰é’®</li>
<li>è¡¨å•å¤šæ¬¡æäº¤</li>
<li>è¾“å…¥æ¡†å®æ—¶æœç´¢</li>
</ul>
<p>å¦‚æœä¸åŠ æ§åˆ¶ï¼Œå¾€å¾€ä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ï¼š</p>
<ul>
<li>æ¥å£è¢«é‡å¤è°ƒç”¨</li>
<li>äº§ç”Ÿé‡å¤å‰¯ä½œç”¨ï¼ˆå¤šæ¬¡æäº¤ã€å¤šæ¬¡å¼¹çª—ï¼‰</li>
<li>çŠ¶æ€é”™ä¹±ï¼Œéš¾ä»¥ç»´æŠ¤</li>
</ul>
<p>é˜²æŠ–è§£å†³çš„æ ¸å¿ƒé—®é¢˜æ˜¯ï¼š</p>
<blockquote>
<p><strong>å‡½æ•°è§¦å‘é¢‘ç‡è¿‡é«˜ï¼Œè€Œè¿™äº›è§¦å‘ä¸­ï¼Œåªæœ‰ä¸€éƒ¨åˆ†æ˜¯çœŸæ­£â€œæœ‰æ„ä¹‰â€çš„ã€‚</strong></p>
</blockquote>
<p>é€šè¿‡é˜²æŠ–ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‡½æ•°å…¥å£å¤„ç»Ÿä¸€æ§åˆ¶æ‰§è¡Œé¢‘ç‡ï¼Œè€Œä¸æ˜¯åœ¨å‡½æ•°å†…éƒ¨åˆ°å¤„åŠ åˆ¤æ–­ã€‚</p>
<hr/>
<h4 data-id="heading-3">2.1 é™¤äº†é˜²æŠ–ï¼Œè¿˜æœ‰å…¶å®ƒæ–¹æ¡ˆå—ï¼Ÿï¼ˆç®€å•å¸¦è¿‡ï¼‰</h4>
<p>å®é™…å¼€å‘ä¸­ï¼Œä¹Ÿç»å¸¸èƒ½çœ‹åˆ°ä¸€äº›æ–¹æ¡ˆï¼š</p>
<ul>
<li>
<p><strong>loading çŠ¶æ€æ§åˆ¶</strong>ï¼š</p>
</li>
<li>
<p><strong>é¡µé¢å¤šä¸ªæŒ‰é’®ï¼ŒloadingæŒ‰é’®è¿‡å¤šï¼Œç„¶åäºŒæ¬¡å°è£…æŒ‰é’®ç»„ä»¶</strong>ï¼š</p>
</li>
</ul>
<blockquote>
<p>æ¥ä¸‹æ¥å…ˆæŒ‰ç…§æˆ‘ä¸ªäººçš„ç†è§£ï¼Œæ¥è¯´ä¸€ä¸‹è¿˜æ˜¯é˜²æŠ–ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-4">ä¸‰ã€åŸºç¡€ç‰ˆæœ¬é˜²æŠ–å®ç°</h3>
<h4 data-id="heading-5">3.1 æœ€åŸºç¡€çš„é˜²æŠ–å†™æ³•</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">debounce</span>(<span class="hljs-params">func, wait = <span class="hljs-number">200</span></span>) {
  <span class="hljs-keyword">let</span> timeout = <span class="hljs-literal">null</span>

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">...args</span>) {
    <span class="hljs-built_in">clearTimeout</span>(timeout)
    timeout = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      func.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args)
    }, wait)
  }
}
</code></pre>
<p>è¿™ä¸ªç‰ˆæœ¬å±äº<strong>æœ€ç»å…¸çš„å°¾è§¦å‘é˜²æŠ–</strong>ï¼š</p>
<ul>
<li>å¤šæ¬¡è§¦å‘åªä¼šæ‰§è¡Œæœ€åä¸€æ¬¡</li>
</ul>
<hr/>
<h4 data-id="heading-6">3.2 æ™®é€šå‡½æ•°ä¸ç®­å¤´å‡½æ•°çš„åŒºåˆ«</h4>
<p>é˜²æŠ–å®ç°ä¸­ç»å¸¸ä¼šçœ‹åˆ°ä¸¤ç§å†™æ³•ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> content = <span class="hljs-variable language_">this</span>

<span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  func.<span class="hljs-title function_">apply</span>(content, args)
}, wait)

</code></pre>
<p>ä»¥åŠï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  func.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args)
}, wait)
</code></pre>
<p>è¿™ä¸¤ç§å†™æ³•çš„æ ¸å¿ƒåŒºåˆ«åœ¨äº <strong><code>this</code> çš„ç»‘å®šæœºåˆ¶ä¸åŒ</strong>ï¼š</p>
<ul>
<li><strong>æ™®é€šå‡½æ•°çš„ <code>this</code> æ˜¯è¿è¡Œæ—¶åŠ¨æ€ç»‘å®šçš„</strong>ï¼Œç”±å‡½æ•°çš„è°ƒç”¨æ–¹å¼å†³å®šï¼Œåœ¨ <code>setTimeout</code> ç­‰åœºæ™¯ä¸­å®¹æ˜“å‘ç”Ÿ <code>this</code> ä¸¢å¤±ã€‚</li>
<li><strong>ç®­å¤´å‡½æ•°ä¸ä¼šåˆ›å»ºè‡ªå·±çš„ <code>this</code></strong>ï¼Œå®ƒçš„ <code>this</code> åœ¨å®šä¹‰æ—¶å°±å·²ç»ç¡®å®šï¼Œå§‹ç»ˆæŒ‡å‘å¤–å±‚ä½œç”¨åŸŸçš„ <code>this</code>ï¼Œå› æ­¤éå¸¸é€‚åˆç”¨äºå®šæ—¶å™¨å’Œå›è°ƒå‡½æ•°ä¸­ã€‚</li>
</ul>
<p>å› æ­¤åœ¨é˜²æŠ–ä¸­ï¼Œå¦‚æœä½¿ç”¨æ™®é€šå‡½æ•°ï¼Œå¾€å¾€éœ€è¦é¢å¤–ä¿å­˜ thisï¼›<br/>
è€Œä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œå¯ä»¥è®©ä»£ç æ›´ç®€æ´ã€‚ç„¶åå…·ä½“çš„æƒ…å†µéœ€è¦å…·ä½“åˆ†æ</p>
<p>è¿™é‡Œä¸å±•å¼€ç»†è¯´ this çš„è§„åˆ™ã€‚
è€Œä¸”é‡Œé¢è¿˜æ¶‰åŠåˆ°äº†applyï¼Œcallï¼Œbindç­‰çŸ¥è¯†</p>
<hr/>
<h3 data-id="heading-7">å››ã€ç«‹å³æ‰§è¡Œç‰ˆé˜²æŠ–</h3>
<h4 data-id="heading-8">4.1 ä¸ºä»€ä¹ˆéœ€è¦ç«‹å³æ‰§è¡Œç‰ˆ</h4>
<p>æ™®é€šé˜²æŠ–æœ‰ä¸€ä¸ªæ˜æ˜¾ç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>ç¬¬ä¸€æ¬¡è§¦å‘ä¸ä¼šç«‹å³æ‰§è¡Œ</strong></li>
</ul>
<p>åœ¨ä¸€äº›åœºæ™¯ä¸‹ï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„è¡Œä¸ºï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>æäº¤æŒ‰é’®</li>
<li>ç™»å½•ã€æ”¯ä»˜ç­‰å…³é”®æ“ä½œ</li>
</ul>
<p>è¿™ç±»åœºæ™¯ä¸‹ï¼Œæ›´åˆç†çš„é¢„æœŸæ˜¯ï¼š</p>
<blockquote>
<p><strong>ç¬¬ä¸€æ¬¡ç‚¹å‡»ç«‹åˆ»æ‰§è¡Œï¼Œä½†åœ¨çŸ­æ—¶é—´å†…ç¦æ­¢å†æ¬¡è§¦å‘ã€‚</strong></p>
</blockquote>
<p>è¿™å°±æ˜¯ç«‹å³æ‰§è¡Œç‰ˆé˜²æŠ–å­˜åœ¨çš„æ„ä¹‰ã€‚</p>
<hr/>
<h4 data-id="heading-9">4.2 ç«‹å³æ‰§è¡Œç‰ˆå®Œæ•´å®ç°</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">debounce</span>(<span class="hljs-params">func, wait = <span class="hljs-number">200</span>, immediate = <span class="hljs-literal">false</span></span>) {
  <span class="hljs-keyword">let</span> timeout = <span class="hljs-literal">null</span>

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">...args</span>) {
    <span class="hljs-comment">// æ˜¯å¦éœ€è¦ç«‹å³æ‰§è¡Œï¼ˆç¬¬ä¸€æ¬¡è§¦å‘ï¼‰</span>
    <span class="hljs-keyword">const</span> callNow = immediate &amp;&amp; !timeout

    <span class="hljs-comment">// æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨</span>
    <span class="hljs-keyword">if</span> (timeout) <span class="hljs-built_in">clearTimeout</span>(timeout)

    <span class="hljs-comment">// è®¾ç½®æ–°çš„å®šæ—¶å™¨ï¼Œç”¨äºå†·å´æœŸç»“æŸ</span>
    timeout = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// å†·å´ç»“æŸï¼Œé‡ç½®çŠ¶æ€</span>
      timeout = <span class="hljs-literal">null</span>

      <span class="hljs-comment">// éç«‹å³æ‰§è¡Œæ¨¡å¼ï¼Œèµ°å°¾è§¦å‘</span>
      <span class="hljs-keyword">if</span> (!immediate) {
        func.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args)
      }
    }, wait)

    <span class="hljs-comment">// ç«‹å³æ‰§è¡Œï¼ˆåªä¼šæ‰§è¡Œä¸€æ¬¡ï¼‰</span>
    <span class="hljs-keyword">if</span> (callNow) {
      func.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args)
    }
  }
}
</code></pre>
<hr/>
<h4 data-id="heading-10">4.3 è¿™ä¸€ç‰ˆçš„æ ¸å¿ƒæ€è·¯</h4>
<p>åœ¨è¿™ä¸ªå®ç°ä¸­ï¼š</p>
<ul>
<li><code>timeout</code> ä¸åªæ˜¯ä¸€ä¸ªå®šæ—¶å™¨</li>
<li>å®ƒåŒæ—¶æ‰¿æ‹…äº† <strong>â€œæ˜¯å¦å¤„äºå†·å´æœŸâ€ çš„çŠ¶æ€æ ‡è®°</strong></li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> callNow = immediate &amp;&amp; !timeout
</code></pre>
<ul>
<li><code>!timeout</code> è¡¨ç¤ºå½“å‰ä¸åœ¨å†·å´æœŸ</li>
<li>åªå…è®¸ç¬¬ä¸€æ¬¡è§¦å‘ç«‹å³æ‰§è¡Œ</li>
</ul>
<p>å½“å®šæ—¶å™¨ç»“æŸåï¼š</p>
<pre><code class="hljs language-js" lang="js">timeout = <span class="hljs-literal">null</span>
</code></pre>
<p>è¡¨ç¤ºå†·å´æœŸç»“æŸï¼Œå…è®¸ä¸‹ä¸€æ¬¡ç«‹å³æ‰§è¡Œã€‚</p>
<hr/>
<h3 data-id="heading-11">äº”ã€ç»“åˆæºç ç†è§£å®ç°é€»è¾‘</h3>
<p>åœ¨ç†è§£äº†ç«‹å³æ‰§è¡Œç‰ˆé˜²æŠ–çš„å®ç°åï¼Œå†å›çœ‹ Underscore.js çš„ <code>_.debounce</code> æºç ï¼Œå…¶å®å¯ä»¥å‘ç°ï¼š<strong>æ ¸å¿ƒæ€æƒ³å®Œå…¨ä¸€è‡´ï¼Œåªæ˜¯å†™æ³•æ›´åå·¥ç¨‹åŒ–ã€‚</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">_.debounce</span> = function(func, wait, immediate) {
  var timeout, result<span class="hljs-comment">;</span>

  var <span class="hljs-attr">later</span> = function(context, args) {
    <span class="hljs-attr">timeout</span> = null<span class="hljs-comment">;</span>
    if (args) <span class="hljs-attr">result</span> = func.apply(context, args)<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>

  var <span class="hljs-attr">debounced</span> = function(...args) {
    if (timeout) clearTimeout(timeout)<span class="hljs-comment">;</span>

    if (immediate) {
      var <span class="hljs-attr">callNow</span> = !timeout<span class="hljs-comment">;</span>
      <span class="hljs-attr">timeout</span> = setTimeout(later, wait)<span class="hljs-comment">;</span>
      if (callNow) <span class="hljs-attr">result</span> = func.apply(this, args)<span class="hljs-comment">;</span>
    } else {
      <span class="hljs-attr">timeout</span> = setTimeout(() =&gt; later(this, args), wait)<span class="hljs-comment">;</span>
    }

    return result<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>

  return debounced<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<h4 data-id="heading-12"><code>timeout</code> æ˜¯é˜²æŠ–çš„æ ¸å¿ƒçŠ¶æ€</h4>
<p><code>timeout</code> ä¸åªæ˜¯å®šæ—¶å™¨ IDï¼Œæ›´æ˜¯<strong>æ˜¯å¦å¤„äºå†·å´æœŸçš„çŠ¶æ€æ ‡è¯†</strong>ï¼š</p>
<ul>
<li><code>timeout === null</code>ï¼šä¸åœ¨å†·å´æœŸ</li>
<li><code>timeout !== null</code>ï¼šæ­£åœ¨é˜²æŠ–ä¸­</li>
</ul>
<p>ç«‹å³æ‰§è¡Œæ¨¡å¼æ­£æ˜¯é€šè¿‡ <code>!timeout</code> æ¥åˆ¤æ–­â€œæ˜¯å¦ç¬¬ä¸€æ¬¡è§¦å‘â€ã€‚</p>
<hr/>
<h4 data-id="heading-13">ä¸ºä»€ä¹ˆå®šæ—¶å™¨é‡Œè¦ <code>timeout = null</code></h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">timeout</span> = null<span class="hljs-comment">;</span>
</code></pre>
<p>è¿™ä¸€æ­¥è¡¨ç¤º<strong>å†·å´æœŸç»“æŸ</strong>ï¼Œä¸ºä¸‹ä¸€æ¬¡ç«‹å³æ‰§è¡Œåˆ›é€ æ¡ä»¶ã€‚<br/>
å¦‚æœä¸é‡ç½®ï¼Œ<code>immediate</code> åªä¼šç”Ÿæ•ˆä¸€æ¬¡ã€‚</p>
<hr/>
<h4 data-id="heading-14">ç«‹å³æ‰§è¡Œçš„å…³é”®é€»è¾‘</h4>
<pre><code class="hljs language-ini" lang="ini">var <span class="hljs-attr">callNow</span> = !timeout<span class="hljs-comment">;</span>
<span class="hljs-attr">timeout</span> = setTimeout(later, wait)<span class="hljs-comment">;</span>
if (callNow) func.apply(this, args)<span class="hljs-comment">;</span>
</code></pre>
<p>è¿™ä¸‰è¡Œå®Œæˆäº†ä¸‰ä»¶äº‹ï¼š</p>
<ol>
<li>åˆ¤æ–­æ˜¯å¦ç¬¬ä¸€æ¬¡è§¦å‘</li>
<li>ç«‹åˆ»è¿›å…¥å†·å´æœŸ</li>
<li>åªåœ¨ç¬¬ä¸€æ¬¡è§¦å‘æ—¶ç«‹å³æ‰§è¡Œ</li>
</ol>
<p>åç»­è§¦å‘åªä¼šåˆ·æ–°å®šæ—¶å™¨ï¼Œä¸ä¼šé‡å¤æ‰§è¡Œã€‚</p>
<hr/>
<h4 data-id="heading-15">ä¸ºä»€ä¹ˆæºç ä¸ç”¨ <code>this</code>ï¼Œè€Œæ˜¯ä¼  <code>context</code></h4>
<p><code>later</code> æ˜¯æ™®é€šå‡½æ•°ï¼Œ<code>this</code> ä¸å¯é ã€‚<br/>
å› æ­¤ Underscore é€‰æ‹© <strong>æ˜¾å¼ä¼ é€’ <code>context</code></strong>ï¼Œä¿è¯ <code>this</code> æŒ‡å‘ç¨³å®šï¼Œè¿™æ˜¯å…¸å‹çš„åº“çº§å†™æ³•ã€‚</p>
<hr/>
<h4 data-id="heading-16">æ ¸å¿ƒç»“è®º</h4>
<p>é˜²æŠ–å¹¶ä¸ä¾èµ–å¤æ‚ APIï¼Œæœ¬è´¨åªæœ‰ä¸¤ç‚¹ï¼š</p>
<ul>
<li><strong>å®šæ—¶å™¨</strong></li>
<li><strong>çŠ¶æ€æ§åˆ¶ï¼ˆæ˜¯å¦å¤„äºå†·å´æœŸï¼‰</strong></li>
</ul>
<p>ç«‹å³æ‰§è¡Œä¸å¦ï¼Œæœ¬è´¨åŒºåˆ«åªæ˜¯ï¼š</p>
<blockquote>
<p><strong>å‡½æ•°æ˜¯åœ¨å†·å´æœŸå¼€å§‹æ—¶æ‰§è¡Œï¼Œè¿˜æ˜¯åœ¨å†·å´æœŸç»“æŸæ—¶æ‰§è¡Œã€‚</strong></p>
</blockquote>
<h3 data-id="heading-17">æ€»ç»“</h3>
<p>é˜²æŠ–æœ¬èº«å¹¶ä¸éš¾ï¼ŒçœŸæ­£å®¹æ˜“å‡ºé—®é¢˜çš„æ˜¯ï¼š</p>
<ul>
<li>ä½¿ç”¨åœºæ™¯é€‰é”™</li>
<li>this æŒ‡å‘ç†è§£ä¸æ¸…</li>
<li>çŠ¶æ€ä¸æ‰§è¡ŒèŒè´£æ··åœ¨ä¸€èµ·</li>
</ul>
<p>è¿™ç¯‡æ–‡ç« æ›´å¤šæ˜¯æˆ‘ä¸ªäººåœ¨é¡¹ç›®ä¸­çš„ä¸€äº›ç†è§£ä¸æ€»ç»“ï¼Œ<br/>
å¦‚æœä½ åœ¨å®è·µä¸­æœ‰ä¸åŒçš„ç»éªŒæˆ–çœ‹æ³•ï¼Œä¹Ÿéå¸¸æ¬¢è¿äº¤æµã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£ useTransitionï¼šReact å¹¶å‘æ¸²æŸ“çš„æ€§èƒ½ä¼˜åŒ–åˆ©å™¨]]></title>    <link>https://juejin.cn/post/7582890166358425626</link>    <guid>https://juejin.cn/post/7582890166358425626</guid>    <pubDate>2025-12-13T14:14:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582890166358425626" data-draft-id="7582896213855551503" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£ useTransitionï¼šReact å¹¶å‘æ¸²æŸ“çš„æ€§èƒ½ä¼˜åŒ–åˆ©å™¨"/> <meta itemprop="keywords" content="React.js,Next.js"/> <meta itemprop="datePublished" content="2025-12-13T14:14:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="bytemanx"/> <meta itemprop="url" content="https://juejin.cn/user/4059855780846936"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£ useTransitionï¼šReact å¹¶å‘æ¸²æŸ“çš„æ€§èƒ½ä¼˜åŒ–åˆ©å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4059855780846936/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    bytemanx
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T14:14:08.000Z" title="Sat Dec 13 2025 14:14:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»16åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>React 16 å¼•å…¥äº† Fiber æ¶æ„ï¼Œè¿™æ˜¯ React æ ¸å¿ƒç®—æ³•çš„é‡æ„ã€‚Fiber æŠŠæ¸²æŸ“å·¥ä½œæ‹†æˆå¤šä¸ªå°çš„å·¥ä½œå•å…ƒï¼ˆfiber èŠ‚ç‚¹ï¼‰ï¼Œæ¯ä¸ªå·¥ä½œå•å…ƒå¯ä»¥ç‹¬ç«‹æ‰§è¡Œã€æš‚åœå’Œæ¢å¤ã€‚è¿™ç§å¯ä¸­æ–­çš„æ¸²æŸ“æœºåˆ¶è®© React èƒ½æ›´å¥½åœ°æ§åˆ¶æ¸²æŸ“æ—¶æœºï¼Œä¸ºåç»­çš„å¹¶å‘ç‰¹æ€§æ‰“ä¸‹äº†åŸºç¡€ã€‚å…³äº Fiber æ¶æ„çš„è¯¦ç»†åŸç†ï¼Œå¯ä»¥å‚è€ƒ<a href="https://juejin.cn/post/7395079370795663414" target="_blank" title="https://juejin.cn/post/7395079370795663414">è¿™ç¯‡æ–‡ç« </a>ã€‚</p>
<p>åŸºäº Fiber æ¶æ„ï¼ŒReact 18 å¼•å…¥äº†å¹¶å‘ç‰¹æ€§ï¼ˆConcurrent Featuresï¼‰ï¼Œè¿™æ˜¯ React å†å²ä¸Šæœ€é‡è¦çš„æ¶æ„å‡çº§ä¹‹ä¸€ã€‚å¹¶å‘æ¸²æŸ“è®© React èƒ½åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­ä¸­æ–­å’Œæ¢å¤å·¥ä½œï¼Œä»è€Œä¿æŒç”¨æˆ·ç•Œé¢çš„å“åº”æ€§ã€‚<code>useTransition</code> Hook æ­£æ˜¯è¿™ä¸€ç‰¹æ€§çš„æ ¸å¿ƒ API ä¹‹ä¸€ï¼Œå®ƒå…è®¸æˆ‘ä»¬æŠŠæŸäº›çŠ¶æ€æ›´æ–°æ ‡è®°ä¸º"éç´§æ€¥"ï¼Œè®© React ä¼˜å…ˆå¤„ç†æ›´é‡è¦çš„æ›´æ–°ï¼ˆæ¯”å¦‚ç”¨æˆ·è¾“å…¥ï¼‰ï¼Œä»è€Œæ˜¾è‘—æå‡ç”¨æˆ·ä½“éªŒã€‚</p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¼šé€šè¿‡ä¸€ä¸ªå®é™…çš„æ¼”ç¤ºæ¡ˆä¾‹ï¼Œæ·±å…¥å¯¹æ¯”ä¸‰ç§ä¸åŒçš„æ›´æ–°ç­–ç•¥ï¼š<strong>åŒæ­¥æ›´æ–°</strong>ã€<strong>é˜²æŠ–æ›´æ–°</strong>å’Œ<strong>å¹¶å‘æ›´æ–°ï¼ˆuseTransitionï¼‰</strong>ï¼Œç„¶åä» React æºç å±‚é¢è§£æ <code>useTransition</code> çš„å®ç°åŸç†ï¼Œå¸®ä½ å…¨é¢ç†è§£è¿™ä¸ªå¼ºå¤§çš„æ€§èƒ½ä¼˜åŒ–å·¥å…·ã€‚</p>
<h2 data-id="heading-1">äº¤äº’å¼æ¼”ç¤º</h2>
<p>åœ¨æ·±å…¥æŠ€æœ¯ç»†èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆé€šè¿‡ä¸€ä¸ªäº¤äº’å¼æ¼”ç¤ºæ¥ç›´è§‚æ„Ÿå—ä¸‰ç§ç­–ç•¥çš„å·®å¼‚ï¼š</p>
<p><span href="https://code.juejin.cn/pen/7583281119522078762" class="code-editor-container"><iframe class="code-editor-frame" data-code="code-editor-element" data-code-id="7583281119522078762" data-src="https://code.juejin.cn/pen/7583281119522078762" style="display:none;" loading="lazy"/><span class="loading-placeholder" style="display:none"><img class="placeholder-image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAJElEQVRoge3BMQEAAADCoPVP7WkJoAAAAAAAAAAAAAAAAAAAbjh8AAFte11jAAAAAElFTkSuQmCC" loading="lazy"/><span class="loading-logo"/></span></span></p>
<p>åœ¨è¿™ä¸ªæ¼”ç¤ºé‡Œï¼Œä½ å¯ä»¥ï¼š</p>
<ol>
<li>åœ¨è¾“å…¥æ¡†é‡Œè¾“å…¥æ–‡å­—ï¼Œè¾“å…¥è¶Šé•¿ï¼Œå›¾è¡¨æ¸²æŸ“çš„æ•°æ®ç‚¹è¶Šå¤š</li>
<li>åˆ‡æ¢ä¸‰ç§ä¸åŒçš„æ›´æ–°ç­–ç•¥ï¼ˆSynchronousã€Debouncedã€Concurrentï¼‰</li>
<li>è§‚å¯Ÿå³ä¸Šè§’çš„æ—¶é’ŸåŠ¨ç”»ï¼Œå®ƒæ˜¯æ£€æµ‹ UI æ˜¯å¦å¡é¡¿çš„"æ™´é›¨è¡¨"</li>
</ol>
<h2 data-id="heading-2">æ€§èƒ½å¯¹æ¯”æ¼”ç¤º</h2>
<p>æˆ‘ä»¬é€šè¿‡ä¸‰ä¸ª GIF åŠ¨å›¾æ¥ç›´è§‚å¯¹æ¯”ä¸‰ç§ç­–ç•¥çš„è¡¨ç°ï¼š</p>
<h3 data-id="heading-3">1. åŒæ­¥æ›´æ–°ï¼ˆSynchronousï¼‰</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62445737486a42fe88d06c68b9c4764c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYnl0ZW1hbng=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766240048&amp;x-signature=N6Cy4Lj0o1wFNNK2jqSnEsh3F9M%3D" alt="synchronous.gif" loading="lazy"/></p>
<p><strong>é‡è¦è¯´æ˜</strong>ï¼šå›¾ä¸­æ˜¾ç¤ºçš„è¾“å…¥æš‚åœæ˜¯<strong>é¡µé¢å¡é¡¿å¯¼è‡´çš„ç»“æœ</strong>ï¼Œä¸æ˜¯ç”¨æˆ·ä¸»åŠ¨åœæ­¢è¾“å…¥ã€‚å½“ç”¨æˆ·æŒç»­è¾“å…¥æ—¶ï¼Œç”±äºåŒæ­¥æ¸²æŸ“é˜»å¡äº†ä¸»çº¿ç¨‹ï¼Œå¯¼è‡´è¾“å…¥æ¡†æ— æ³•åŠæ—¶å“åº”ã€‚å³ä¸Šè§’æ—¶é’ŸåŠ¨ç”»çš„æ˜æ˜¾å¡é¡¿è¯æ˜äº†ä¸»çº¿ç¨‹è¢«æ¸²æŸ“ä»»åŠ¡å®Œå…¨é˜»å¡ã€‚è¿™æ˜¯åŒæ­¥æ›´æ–°çš„æœ€å¤§é—®é¢˜ï¼šå³ä½¿è¾“å…¥å“åº”å³æ—¶ï¼Œä½†æ¸²æŸ“ä¼šé˜»å¡ç”¨æˆ·äº¤äº’ã€‚</p>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>âœ… è¾“å…¥å“åº”å³æ—¶ï¼Œæ— å»¶è¿Ÿ</li>
<li>âŒ æ¯æ¬¡è¾“å…¥éƒ½ä¼šç«‹å³è§¦å‘å®Œæ•´æ¸²æŸ“</li>
<li>âŒ å½“æ•°æ®é‡å¤§æ—¶ï¼Œæ—¶é’ŸåŠ¨ç”»ä¼šæ˜æ˜¾å¡é¡¿</li>
<li>âŒ ç”¨æˆ·è¾“å…¥å¯èƒ½è¢«é˜»å¡ï¼Œä½“éªŒä¸æµç•…</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šæ•°æ®é‡å°ã€æ¸²æŸ“ç®€å•çš„åœºæ™¯</p>
<h3 data-id="heading-4">2. é˜²æŠ–æ›´æ–°ï¼ˆDebouncedï¼‰</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc14c159b24b4e7db59a3807d22a449d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYnl0ZW1hbng=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766240048&amp;x-signature=YfFqGLErgZMC9RM9tCvBuHYc%2B0A%3D" alt="debounce.gif" loading="lazy"/></p>
<p><strong>é‡è¦è¯´æ˜</strong>ï¼šå›¾ä¸­æ˜¾ç¤ºçš„ç­‰å¾…æœŸé—´æ˜¯<strong>é˜²æŠ–å»¶è¿Ÿæœºåˆ¶</strong>çš„è¡¨ç°ï¼ˆå›ºå®š1000mså»¶è¿Ÿï¼‰ã€‚<strong>é˜²æŠ–çš„å»¶è¿Ÿå¤ªå¤§</strong>ï¼Œç”¨æˆ·è¾“å…¥åéœ€è¦ç­‰1ç§’æ‰èƒ½çœ‹åˆ°ç»“æœæ›´æ–°ã€‚è™½ç„¶é¿å…äº†é¢‘ç¹æ¸²æŸ“ï¼Œä½†å›ºå®šçš„å»¶è¿Ÿæ—¶é—´å½±å“äº†ç”¨æˆ·ä½“éªŒã€‚ç”¨æˆ·æ— æ³•åŠæ—¶çœ‹åˆ°è¾“å…¥åé¦ˆï¼Œéœ€è¦ç­‰é˜²æŠ–æ—¶é—´ç»“æŸã€‚</p>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>âœ… å‡å°‘æ¸²æŸ“æ¬¡æ•°ï¼Œé¿å…é¢‘ç¹æ›´æ–°</li>
<li>âœ… ç­‰å¾…ç”¨æˆ·åœæ­¢è¾“å…¥åæ‰æ›´æ–°</li>
<li>âŒ æœ‰å›ºå®šçš„å»¶è¿Ÿï¼ˆ1000msï¼‰ï¼Œç”¨æˆ·éœ€è¦ç­‰å¾…</li>
<li>âŒ æ—¶é’ŸåŠ¨ç”»åœ¨ç­‰å¾…æœŸé—´å¯èƒ½ä¸æµç•…</li>
<li>âŒ æ— æ³•åˆ©ç”¨ React çš„å¹¶å‘ç‰¹æ€§</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šéœ€è¦å‡å°‘ API è°ƒç”¨æˆ–è®¡ç®—æ¬¡æ•°çš„åœºæ™¯</p>
<h3 data-id="heading-5">3. å¹¶å‘æ›´æ–°ï¼ˆConcurrent / useTransitionï¼‰</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/261c2c9a4cfd4035b41815a045995953~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYnl0ZW1hbng=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766240048&amp;x-signature=4OWNS3lfJhHtOe5Ct%2BheuDcERT8%3D" alt="concurrent.gif" loading="lazy"/></p>
<p><strong>é‡è¦è¯´æ˜</strong>ï¼šå›¾ä¸­æ˜¾ç¤ºçš„æµç•…è¡¨ç°æ˜¯<strong>å¹¶å‘æ¸²æŸ“</strong>çš„æ•ˆæœã€‚<strong>å¹¶å‘æ¨¡å¼å¯ä»¥åŠæ—¶å“åº”ç”¨æˆ·è¾“å…¥</strong>ï¼Œæ— éœ€ç­‰å¾…å»¶è¿Ÿï¼Œè¾“å…¥æ¡†ç«‹å³å“åº”ã€‚å³ä½¿åœ¨å¤§æ•°æ®é‡æ¸²æŸ“æ—¶ï¼Œæ—¶é’ŸåŠ¨ç”»å§‹ç»ˆä¿æŒæµç•…ï¼Œè¯æ˜ä¸»çº¿ç¨‹æœªè¢«é˜»å¡ã€‚æ¸²æŸ“è¿‡ç¨‹å¯ä»¥è¢«ä¸­æ–­ï¼Œä¼˜å…ˆå¤„ç†ç”¨æˆ·è¾“å…¥ï¼Œç„¶åç»§ç»­å®Œæˆæ¸²æŸ“ä»»åŠ¡ã€‚è¿™æ˜¯å¹¶å‘æ›´æ–°çš„æ ¸å¿ƒä¼˜åŠ¿ï¼šæ—¢ä¿è¯äº†è¾“å…¥å“åº”æ€§ï¼Œåˆå®Œæˆäº†å¤æ‚æ¸²æŸ“ã€‚</p>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>âœ… è¾“å…¥å“åº”å³æ—¶ï¼Œæ— å»¶è¿Ÿ</li>
<li>âœ… æ¸²æŸ“è¿‡ç¨‹å¯ä¸­æ–­ï¼Œä¿æŒ UI å“åº”æ€§</li>
<li>âœ… æ—¶é’ŸåŠ¨ç”»å§‹ç»ˆä¿æŒæµç•…</li>
<li>âœ… è‡ªåŠ¨å¹³è¡¡è¾“å…¥å“åº”å’Œæ¸²æŸ“æ€§èƒ½</li>
<li>âœ… åˆ©ç”¨ React 18 çš„å¹¶å‘ç‰¹æ€§</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šéœ€è¦ä¿æŒ UI å“åº”æ€§çš„å¤æ‚æ¸²æŸ“åœºæ™¯</p>
<h2 data-id="heading-6">æ¼”ç¤ºä»£ç è§£æ</h2>
<p>è¿™ä¸ªæ¼”ç¤ºåº”ç”¨åŸºäº React å®˜æ–¹çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffacebook%2Freact%2Ftree%2Fmain%2Ffixtures%2Fconcurrent%2Ftime-slicing" target="_blank" title="https://github.com/facebook/react/tree/main/fixtures/concurrent/time-slicing" ref="nofollow noopener noreferrer">time-slicing fixture</a>ï¼Œå±•ç¤ºäº†ä¸‰ç§ä¸åŒçš„çŠ¶æ€æ›´æ–°ç­–ç•¥ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹å…³é”®ä»£ç å®ç°ï¼š</p>
<h3 data-id="heading-7">ä¸‰ç§æ›´æ–°ç­–ç•¥</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">AppContent</span>(<span class="hljs-params">{ complexity }: AppProps</span>) {
  <span class="hljs-keyword">const</span> [value, setValue] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);
  <span class="hljs-keyword">const</span> [strategy, setStrategy] = useState&lt;<span class="hljs-title class_">Strategy</span>&gt;(<span class="hljs-string">'sync'</span>);
  <span class="hljs-keyword">const</span> [isPending, startTransition] = <span class="hljs-title function_">useTransition</span>();

  <span class="hljs-comment">// é˜²æŠ–å¤„ç†å‡½æ•°</span>
  <span class="hljs-keyword">const</span> debouncedSetValue = <span class="hljs-title function_">useMemo</span>(
    <span class="hljs-function">() =&gt;</span>
      <span class="hljs-title function_">debounce</span>(<span class="hljs-function">(<span class="hljs-params">newValue: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
        <span class="hljs-title function_">setValue</span>(newValue);
      }, <span class="hljs-number">1000</span>),
    []
  );

  <span class="hljs-keyword">const</span> handleChange = <span class="hljs-title function_">useCallback</span>(
    <span class="hljs-function">(<span class="hljs-params">e: React.ChangeEvent&lt;HTMLInputElement&gt;</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> newValue = e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>;
      <span class="hljs-keyword">switch</span> (strategy) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'sync'</span>:
          <span class="hljs-comment">// ç­–ç•¥ 1: åŒæ­¥æ›´æ–° - ç«‹å³è§¦å‘æ¸²æŸ“</span>
          <span class="hljs-title function_">setValue</span>(newValue);
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">'debounced'</span>:
          <span class="hljs-comment">// ç­–ç•¥ 2: é˜²æŠ–æ›´æ–° - å»¶è¿Ÿ 1000ms åæ›´æ–°</span>
          <span class="hljs-title function_">debouncedSetValue</span>(newValue);
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">'async'</span>:
          <span class="hljs-comment">// ç­–ç•¥ 3: å¹¶å‘æ›´æ–° - ä½¿ç”¨ useTransition</span>
          <span class="hljs-title function_">startTransition</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-title function_">setValue</span>(newValue);
          });
          <span class="hljs-keyword">break</span>;
      }
    },
    [strategy, debouncedSetValue, startTransition]
  );

  <span class="hljs-keyword">const</span> data = <span class="hljs-title function_">getStreamData</span>(value, complexity);
  <span class="hljs-comment">// ...</span>
}
</code></pre>
<h3 data-id="heading-8">useTransition ä½¿ç”¨è¯¦è§£</h3>
<p>åœ¨ä¸Šé¢çš„ä»£ç é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°äº† <code>useTransition</code> çš„åŸºæœ¬ä½¿ç”¨ã€‚æˆ‘ä»¬è¯¦ç»†è§£æä¸€ä¸‹ï¼š</p>
<h4 data-id="heading-9">1. useTransition çš„åŸºæœ¬ç”¨æ³•</h4>
<p><code>useTransition</code> æ˜¯ä¸€ä¸ª Hookï¼Œå®ƒè¿”å›ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªå…ƒç´ çš„æ•°ç»„ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> [isPending, startTransition] = <span class="hljs-title function_">useTransition</span>();
</code></pre>
<ul>
<li><strong><code>isPending</code></strong>ï¼šä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰æœ‰æ²¡æœ‰æ­£åœ¨è¿›è¡Œçš„ transition æ›´æ–°ã€‚å½“ <code>startTransition</code> é‡Œçš„æ›´æ–°æ­£åœ¨å¤„ç†æ—¶ï¼Œ<code>isPending</code> ä¸º <code>true</code>ï¼›æ›´æ–°å®Œæˆåå˜ä¸º <code>false</code>ã€‚</li>
<li><strong><code>startTransition</code></strong>ï¼šä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥æŠŠçŠ¶æ€æ›´æ–°æ ‡è®°ä¸º"éç´§æ€¥"çš„ transition æ›´æ–°ã€‚</li>
</ul>
<h4 data-id="heading-10">2. startTransition çš„ä½¿ç”¨æ–¹å¼</h4>
<p><code>startTransition</code> æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œåœ¨è¿™ä¸ªå›è°ƒå‡½æ•°é‡Œæ‰§è¡Œçš„çŠ¶æ€æ›´æ–°ä¼šè¢«æ ‡è®°ä¸ºä½ä¼˜å…ˆçº§ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">case</span> <span class="hljs-string">'async'</span>:
  <span class="hljs-comment">// ç­–ç•¥ 3: å¹¶å‘æ›´æ–° - ä½¿ç”¨ useTransition</span>
  <span class="hljs-title function_">startTransition</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">setValue</span>(newValue);
  });
  <span class="hljs-keyword">break</span>;
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li>æ‰€æœ‰åœ¨ <code>startTransition</code> å›è°ƒé‡Œè°ƒç”¨çš„ <code>setState</code> éƒ½ä¼šè¢«æ ‡è®°ä¸º transition æ›´æ–°</li>
<li>å¯ä»¥åŒæ—¶æ›´æ–°å¤šä¸ªçŠ¶æ€ï¼š
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">startTransition</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">setValue</span>(newValue);
  <span class="hljs-title function_">setFilteredResults</span>(<span class="hljs-title function_">filterResults</span>(newValue));
  <span class="hljs-title function_">setSearchHistory</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> [...prev, newValue]);
});
</code></pre>
</li>
<li><code>startTransition</code> æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œä½†é‡Œé¢çš„çŠ¶æ€æ›´æ–°ä¼šè¢«å¼‚æ­¥å¤„ç†</li>
<li>ä¸è¦åœ¨ <code>startTransition</code> é‡Œæ‰§è¡Œå‰¯ä½œç”¨ï¼ˆæ¯”å¦‚ API è°ƒç”¨ã€DOM æ“ä½œç­‰ï¼‰ï¼Œåªç”¨æ¥æ›´æ–°çŠ¶æ€</li>
</ul>
<h4 data-id="heading-11">3. isPending çš„å®é™…åº”ç”¨</h4>
<p><code>isPending</code> å¯ä»¥ç”¨æ¥å‘ç”¨æˆ·æä¾›è§†è§‰åé¦ˆï¼Œè¡¨ç¤ºåº”ç”¨æ­£åœ¨å¤„ç† transition æ›´æ–°ã€‚åœ¨æ¼”ç¤ºä»£ç é‡Œï¼Œæˆ‘ä»¬ç”¨ <code>isPending</code> æ¥æ”¹å˜è¾“å…¥æ¡†çš„é€æ˜åº¦ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript">&lt;input
  className={<span class="hljs-string">`p-3 sm:p-4 text-xl sm:text-3xl w-full block bg-white text-black rounded <span class="hljs-subst">${inputColorClass}</span> <span class="hljs-subst">${
    isPending ? <span class="hljs-string">'opacity-70'</span> : <span class="hljs-string">''</span>
  }</span>`</span>}
  placeholder=<span class="hljs-string">"longer input â†’ more components"</span>
  onChange={handleChange}
/&gt;
</code></pre>
<p>å½“ <code>isPending</code> ä¸º <code>true</code> æ—¶ï¼Œè¾“å…¥æ¡†ä¼šå˜æˆåŠé€æ˜ï¼ˆ<code>opacity-70</code>ï¼‰ï¼Œç»™ç”¨æˆ·ä¸€ä¸ªè§†è§‰æç¤ºï¼Œè¡¨æ˜åå°æ­£åœ¨å¤„ç†æ›´æ–°ã€‚</p>
<h3 data-id="heading-12">å…³é”®ç»„ä»¶è¯´æ˜</h3>
<p><strong>1. Charts ç»„ä»¶</strong>
ç”¨ Victory å›¾è¡¨åº“æ¸²æŸ“å¤§é‡æ•°æ®ç‚¹ã€‚æ ¹æ®è¾“å…¥é•¿åº¦åŠ¨æ€ç”Ÿæˆæ•°æ®å¤æ‚åº¦ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getStreamData</span>(<span class="hljs-params">input: <span class="hljs-built_in">string</span>, complexity: <span class="hljs-built_in">number</span></span>): <span class="hljs-title class_">StreamData</span> {
  <span class="hljs-keyword">const</span> cacheKey = <span class="hljs-string">`<span class="hljs-subst">${input}</span>-<span class="hljs-subst">${complexity}</span>`</span>;
  <span class="hljs-keyword">if</span> (cachedData.<span class="hljs-title function_">has</span>(cacheKey)) {
    <span class="hljs-keyword">return</span> cachedData.<span class="hljs-title function_">get</span>(cacheKey)!;
  }
  <span class="hljs-keyword">const</span> multiplier = input.<span class="hljs-property">length</span> !== <span class="hljs-number">0</span> ? input.<span class="hljs-property">length</span> : <span class="hljs-number">1</span>;
  <span class="hljs-keyword">const</span> data = <span class="hljs-title function_">range</span>(<span class="hljs-number">5</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function">() =&gt;</span>
    <span class="hljs-title function_">range</span>(complexity * multiplier).<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">j: <span class="hljs-built_in">number</span></span>) =&gt;</span> ({
      <span class="hljs-attr">x</span>: j,
      <span class="hljs-attr">y</span>: <span class="hljs-title function_">random</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>),
    }))
  );
  cachedData.<span class="hljs-title function_">set</span>(cacheKey, data);
  <span class="hljs-keyword">return</span> data;
}
</code></pre>
<p><strong>2. Clock ç»„ä»¶</strong>
ä¸€ä¸ªå®æ—¶ SVG åŠ¨ç”»æ—¶é’Ÿï¼Œç”¨æ¥æ£€æµ‹ UI æ˜¯å¦å¡é¡¿ã€‚å¦‚æœä¸»çº¿ç¨‹è¢«é˜»å¡ï¼Œæ—¶é’ŸåŠ¨ç”»ä¼šæ˜æ˜¾æ‰å¸§ã€‚</p>
<p><strong>3. æ•°æ®ç”Ÿæˆç­–ç•¥</strong></p>
<ul>
<li>è¾“å…¥é•¿åº¦è¶Šé•¿ï¼Œç”Ÿæˆçš„æ•°æ®ç‚¹è¶Šå¤š</li>
<li>ç”¨ç¼“å­˜æœºåˆ¶é¿å…é‡å¤è®¡ç®—</li>
<li>å¤æ‚åº¦å‚æ•°æ§åˆ¶åŸºç¡€æ•°æ®é‡</li>
</ul>
<h2 data-id="heading-13">React æºç æ·±åº¦è§£æ</h2>
<p>æˆ‘ä»¬ç”¨äº†å¾ˆå¤šæ¬¡ <code>useTransition</code>ï¼Œä¹Ÿçœ‹åˆ°äº†å®ƒçš„æ•ˆæœã€‚ç°åœ¨æ¥çœ‹çœ‹ React æºç é‡Œå®ƒæ˜¯æ€ä¹ˆå®ç°çš„ã€‚</p>
<h3 data-id="heading-14">useTransition å…¥å£å‡½æ•°</h3>
<p><code>useTransition</code> çš„å…¥å£åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffacebook%2Freact%2Fblob%2F053df4e8561ef4caecef31c330f4178ac25e255b%2Fpackages%2Freact%2Fsrc%2FReactHooks.js%23L170-L176" target="_blank" title="https://github.com/facebook/react/blob/053df4e8561ef4caecef31c330f4178ac25e255b/packages/react/src/ReactHooks.js#L170-L176" ref="nofollow noopener noreferrer">packages/react/src/ReactHooks.js</a> æ–‡ä»¶ä¸­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useTransition</span>(<span class="hljs-params"/>): [
  boolean,
  <span class="hljs-function">(<span class="hljs-params">callback: () =&gt; <span class="hljs-keyword">void</span>, options?: StartTransitionOptions</span>) =&gt;</span> <span class="hljs-keyword">void</span>,
] {
  <span class="hljs-keyword">const</span> dispatcher = <span class="hljs-title function_">resolveDispatcher</span>();
  <span class="hljs-keyword">return</span> dispatcher.<span class="hljs-title function_">useTransition</span>();
}
</code></pre>
<p>å¾ˆç®€å•ï¼Œå°±æ˜¯é€šè¿‡ <code>resolveDispatcher()</code> æ‹¿åˆ° dispatcherï¼Œç„¶åè°ƒç”¨ <code>dispatcher.useTransition()</code>ã€‚</p>
<p>è¿™ä¸ª dispatcher æ˜¯ä»€ä¹ˆå‘¢ï¼ŸReact ä¼šæ ¹æ®å½“å‰æ˜¯é¦–æ¬¡æ¸²æŸ“è¿˜æ˜¯æ›´æ–°æ¸²æŸ“ï¼Œç»™ä½ ä¸åŒçš„ dispatcherã€‚é¦–æ¬¡æ¸²æŸ“çš„æ—¶å€™ï¼Œdispatcher é‡Œçš„ <code>useTransition</code> ä¼šè°ƒç”¨ <code>mountTransition</code>ï¼›æ›´æ–°æ¸²æŸ“çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨ <code>updateTransition</code>ã€‚</p>
<p>æœ‰åŒå­¦è¯´ï¼Œä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡ï¼Ÿå› ä¸º React éœ€è¦åŒºåˆ†é¦–æ¬¡æ¸²æŸ“å’Œæ›´æ–°æ¸²æŸ“ã€‚é¦–æ¬¡æ¸²æŸ“çš„æ—¶å€™ï¼Œéœ€è¦åˆ›å»ºæ–°çš„ Hook å¯¹è±¡ï¼›æ›´æ–°æ¸²æŸ“çš„æ—¶å€™ï¼Œéœ€è¦å¤ç”¨ä¹‹å‰çš„ Hook å¯¹è±¡ã€‚</p>
<h3 data-id="heading-15">mountTransitionï¼šé¦–æ¬¡æ¸²æŸ“</h3>
<p>ç»„ä»¶é¦–æ¬¡æ¸²æŸ“æ—¶ï¼Œä¼šè°ƒç”¨ <code>mountTransition</code>ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„å®ç°ï¼š</p>
<p>åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffacebook%2Freact%2Fblob%2F053df4e8561ef4caecef31c330f4178ac25e255b%2Fpackages%2Freact-reconciler%2Fsrc%2FReactFiberHooks.js%23L3398-L3414" target="_blank" title="https://github.com/facebook/react/blob/053df4e8561ef4caecef31c330f4178ac25e255b/packages/react-reconciler/src/ReactFiberHooks.js#L3398-L3414" ref="nofollow noopener noreferrer">packages/react-reconciler/src/ReactFiberHooks.js</a> ä¸­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">mountTransition</span>(<span class="hljs-params"/>): [
  boolean,
  <span class="hljs-function">(<span class="hljs-params">callback: () =&gt; <span class="hljs-keyword">void</span>, options?: StartTransitionOptions</span>) =&gt;</span> <span class="hljs-keyword">void</span>,
] {
  <span class="hljs-keyword">const</span> stateHook = <span class="hljs-title function_">mountStateImpl</span>((<span class="hljs-attr">false</span>: <span class="hljs-title class_">Thenable</span>&lt;boolean&gt; | boolean));
  <span class="hljs-comment">// The `start` method never changes.</span>
  <span class="hljs-keyword">const</span> start = startTransition.<span class="hljs-title function_">bind</span>(
    <span class="hljs-literal">null</span>,
    currentlyRenderingFiber,
    stateHook.<span class="hljs-property">queue</span>,
    <span class="hljs-literal">true</span>,
    <span class="hljs-literal">false</span>,
  );
  <span class="hljs-keyword">const</span> hook = <span class="hljs-title function_">mountWorkInProgressHook</span>();
  hook.<span class="hljs-property">memoizedState</span> = start;
  <span class="hljs-keyword">return</span> [<span class="hljs-literal">false</span>, start];
}
</code></pre>
<p>è¿™æ®µä»£ç åšäº†å‡ ä»¶äº‹ï¼š</p>
<ol>
<li>ç”¨ <code>mountStateImpl</code> åˆ›å»ºä¸€ä¸ªå†…éƒ¨çŠ¶æ€ï¼Œåˆå§‹å€¼æ˜¯ <code>false</code>ã€‚è¿™ä¸ªçŠ¶æ€ç”¨æ¥è¡¨ç¤ºå½“å‰æ˜¯ä¸æ˜¯ pending çŠ¶æ€ã€‚</li>
<li>é€šè¿‡ <code>bind</code> åˆ›å»ºä¸€ä¸ª <code>start</code> å‡½æ•°ï¼Œç»‘å®šäº†å½“å‰ fiber å’Œ state queueã€‚è¿™ä¸ª <code>start</code> å‡½æ•°å°±æ˜¯ <code>startTransition</code>ï¼Œä½†å·²ç»ç»‘å®šäº†å¿…è¦çš„ä¸Šä¸‹æ–‡ã€‚</li>
<li>æŠŠ <code>start</code> å‡½æ•°å­˜åˆ° hook çš„ <code>memoizedState</code> é‡Œï¼Œè¿™æ ·ä¸‹æ¬¡æ›´æ–°çš„æ—¶å€™è¿˜èƒ½æ‹¿åˆ°åŒä¸€ä¸ªå‡½æ•°ã€‚</li>
<li>è¿”å› <code>[false, start]</code>ï¼Œåˆå§‹çŠ¶æ€ä¸æ˜¯ pendingã€‚</li>
</ol>
<h3 data-id="heading-16">updateTransitionï¼šæ›´æ–°æ¸²æŸ“</h3>
<p>ç»„ä»¶æ›´æ–°æ¸²æŸ“æ—¶ï¼Œä¼šè°ƒç”¨ <code>updateTransition</code>ï¼š</p>
<p>åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffacebook%2Freact%2Fblob%2F053df4e8561ef4caecef31c330f4178ac25e255b%2Fpackages%2Freact-reconciler%2Fsrc%2FReactFiberHooks.js%23L3416-L3429" target="_blank" title="https://github.com/facebook/react/blob/053df4e8561ef4caecef31c330f4178ac25e255b/packages/react-reconciler/src/ReactFiberHooks.js#L3416-L3429" ref="nofollow noopener noreferrer">packages/react-reconciler/src/ReactFiberHooks.js</a> ä¸­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">updateTransition</span>(<span class="hljs-params"/>): [
  boolean,
  <span class="hljs-function">(<span class="hljs-params">callback: () =&gt; <span class="hljs-keyword">void</span>, options?: StartTransitionOptions</span>) =&gt;</span> <span class="hljs-keyword">void</span>,
] {
  <span class="hljs-keyword">const</span> [booleanOrThenable] = <span class="hljs-title function_">updateState</span>(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> hook = <span class="hljs-title function_">updateWorkInProgressHook</span>();
  <span class="hljs-keyword">const</span> start = hook.<span class="hljs-property">memoizedState</span>;
  <span class="hljs-keyword">const</span> isPending =
    <span class="hljs-keyword">typeof</span> booleanOrThenable === <span class="hljs-string">'boolean'</span>
      ? booleanOrThenable
      : <span class="hljs-comment">// This will suspend until the async action scope has finished.</span>
        <span class="hljs-title function_">useThenable</span>(booleanOrThenable);
  <span class="hljs-keyword">return</span> [isPending, start];
}
</code></pre>
<p>è¿™é‡Œåšäº†å‡ ä»¶äº‹ï¼š</p>
<ol>
<li>è°ƒç”¨ <code>updateState(false)</code> è·å–å½“å‰çš„ pending çŠ¶æ€ã€‚è¿™ä¸ªçŠ¶æ€åœ¨ <code>startTransition</code> æ‰§è¡Œçš„æ—¶å€™ä¼šè¢«æ›´æ–°ã€‚</li>
<li>ä» hook çš„ <code>memoizedState</code> é‡Œæ‹¿åˆ°ä¹‹å‰å­˜çš„ <code>start</code> å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°åœ¨é¦–æ¬¡æ¸²æŸ“çš„æ—¶å€™å°±åˆ›å»ºå¥½äº†ï¼Œä¹‹åä¸ä¼šå˜ã€‚</li>
<li>åˆ¤æ–­ <code>isPending</code>ã€‚å¦‚æœçŠ¶æ€æ˜¯ booleanï¼Œç›´æ¥è¿”å›ï¼›å¦‚æœæ˜¯ Promiseï¼ˆæ¯”å¦‚å¼‚æ­¥ actionï¼‰ï¼Œå°±ç”¨ <code>useThenable</code> ç­‰å¾…å®ƒå®Œæˆã€‚</li>
<li>è¿”å› <code>[isPending, start]</code>ã€‚</li>
</ol>
<p>ä½“ä¼šåˆ° <code>useTransition</code> çš„è®¾è®¡äº†ä¹ˆï¼Ÿå®ƒæœ¬è´¨ä¸Šå°±æ˜¯ <code>useState</code> + <code>startTransition</code>ã€‚ç”¨ <code>useState</code> æ¥ç®¡ç† pending çŠ¶æ€ï¼Œç”¨ <code>startTransition</code> æ¥æ ‡è®°æ›´æ–°ä¸ºä½ä¼˜å…ˆçº§ã€‚</p>
<h3 data-id="heading-17">startTransition å‡½æ•°å®ç°</h3>
<p><code>startTransition</code> çš„å®ç°åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffacebook%2Freact%2Fblob%2F053df4e8561ef4caecef31c330f4178ac25e255b%2Fpackages%2Freact%2Fsrc%2FReactStartTransition.js%23L45-L117" target="_blank" title="https://github.com/facebook/react/blob/053df4e8561ef4caecef31c330f4178ac25e255b/packages/react/src/ReactStartTransition.js#L45-L117" ref="nofollow noopener noreferrer">packages/react/src/ReactStartTransition.js</a> æ–‡ä»¶ä¸­ã€‚è¿™ä¸ªå‡½æ•°çš„æ ¸å¿ƒä½œç”¨æ˜¯è®¾ç½®ä¸€ä¸ªå…¨å±€çš„ transition ä¸Šä¸‹æ–‡ï¼Œè®© React çŸ¥é“å½“å‰æ­£åœ¨æ‰§è¡Œ transition æ›´æ–°ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">startTransition</span>(<span class="hljs-params">
  scope: () =&gt; <span class="hljs-keyword">void</span>,
  options?: StartTransitionOptions,
</span>): <span class="hljs-keyword">void</span> {
  <span class="hljs-keyword">const</span> prevTransition = <span class="hljs-title class_">ReactSharedInternals</span>.<span class="hljs-property">T</span>;
  <span class="hljs-keyword">const</span> <span class="hljs-attr">currentTransition</span>: <span class="hljs-title class_">Transition</span> = ({}: any);
  <span class="hljs-keyword">if</span> (enableViewTransition) {
    currentTransition.<span class="hljs-property">types</span> =
      prevTransition !== <span class="hljs-literal">null</span>
        ? <span class="hljs-comment">// If we're a nested transition, we should use the same set as the parent</span>
          <span class="hljs-comment">// since we're conceptually always joined into the same entangled transition.</span>
          <span class="hljs-comment">// In practice, this only matters if we add transition types in the inner</span>
          <span class="hljs-comment">// without setting state. In that case, the inner transition can finish</span>
          <span class="hljs-comment">// without waiting for the outer.</span>
          prevTransition.<span class="hljs-property">types</span>
        : <span class="hljs-literal">null</span>;
  }
  <span class="hljs-keyword">if</span> (enableGestureTransition) {
    currentTransition.<span class="hljs-property">gesture</span> = <span class="hljs-literal">null</span>;
  }
  <span class="hljs-keyword">if</span> (enableTransitionTracing) {
    currentTransition.<span class="hljs-property">name</span> =
      options !== <span class="hljs-literal">undefined</span> &amp;&amp; options.<span class="hljs-property">name</span> !== <span class="hljs-literal">undefined</span> ? options.<span class="hljs-property">name</span> : <span class="hljs-literal">null</span>;
    currentTransition.<span class="hljs-property">startTime</span> = -<span class="hljs-number">1</span>; <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> This should read the timestamp.</span>
  }
  <span class="hljs-keyword">if</span> (__DEV__) {
    currentTransition.<span class="hljs-property">_updatedFibers</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
  }
  <span class="hljs-title class_">ReactSharedInternals</span>.<span class="hljs-property">T</span> = currentTransition;

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> returnValue = <span class="hljs-title function_">scope</span>();
    <span class="hljs-keyword">const</span> onStartTransitionFinish = <span class="hljs-title class_">ReactSharedInternals</span>.<span class="hljs-property">S</span>;
    <span class="hljs-keyword">if</span> (onStartTransitionFinish !== <span class="hljs-literal">null</span>) {
      <span class="hljs-title function_">onStartTransitionFinish</span>(currentTransition, returnValue);
    }
    <span class="hljs-keyword">if</span> (
      <span class="hljs-keyword">typeof</span> returnValue === <span class="hljs-string">'object'</span> &amp;&amp;
      returnValue !== <span class="hljs-literal">null</span> &amp;&amp;
      <span class="hljs-keyword">typeof</span> returnValue.<span class="hljs-property">then</span> === <span class="hljs-string">'function'</span>
    ) {
      <span class="hljs-keyword">if</span> (__DEV__) {
        <span class="hljs-comment">// Keep track of the number of async transitions still running so we can warn.</span>
        <span class="hljs-title class_">ReactSharedInternals</span>.<span class="hljs-property">asyncTransitions</span>++;
        returnValue.<span class="hljs-title function_">then</span>(releaseAsyncTransition, releaseAsyncTransition);
      }
      returnValue.<span class="hljs-title function_">then</span>(noop, reportGlobalError);
    }
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-title function_">reportGlobalError</span>(error);
  } <span class="hljs-keyword">finally</span> {
    <span class="hljs-title function_">warnAboutTransitionSubscriptions</span>(prevTransition, currentTransition);
    <span class="hljs-keyword">if</span> (prevTransition !== <span class="hljs-literal">null</span> &amp;&amp; currentTransition.<span class="hljs-property">types</span> !== <span class="hljs-literal">null</span>) {
      <span class="hljs-comment">// If we created a new types set in the inner transition, we transfer it to the parent</span>
      <span class="hljs-comment">// since they should share the same set. They're conceptually entangled.</span>
      <span class="hljs-keyword">if</span> (__DEV__) {
        <span class="hljs-keyword">if</span> (
          prevTransition.<span class="hljs-property">types</span> !== <span class="hljs-literal">null</span> &amp;&amp;
          prevTransition.<span class="hljs-property">types</span> !== currentTransition.<span class="hljs-property">types</span>
        ) {
          <span class="hljs-comment">// Just assert that assumption holds that we're not overriding anything.</span>
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(
            <span class="hljs-string">'We expected inner Transitions to have transferred the outer types set and '</span> +
              <span class="hljs-string">'that you cannot add to the outer Transition while inside the inner.'</span> +
              <span class="hljs-string">'This is a bug in React.'</span>,
          );
        }
      }
      prevTransition.<span class="hljs-property">types</span> = currentTransition.<span class="hljs-property">types</span>;
    }
    <span class="hljs-title class_">ReactSharedInternals</span>.<span class="hljs-property">T</span> = prevTransition;
  }
}
</code></pre>
<p>è¿™æ®µä»£ç çš„é€»è¾‘å¾ˆç®€å•ï¼š</p>
<ol>
<li><strong>ä¿å­˜ä¹‹å‰çš„ transition</strong>ï¼šå…ˆæŠŠå½“å‰çš„ <code>ReactSharedInternals.T</code> å­˜èµ·æ¥ï¼Œå› ä¸ºå¯èƒ½å·²ç»æœ‰ transition åœ¨è¿è¡Œäº†ï¼ˆæ”¯æŒåµŒå¥—ï¼‰ã€‚</li>
<li><strong>åˆ›å»ºæ–°çš„ transition å¯¹è±¡</strong>ï¼šåˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ transition å¯¹è±¡ã€‚å¦‚æœæ˜¯åµŒå¥—çš„ transitionï¼Œä¼šç»§æ‰¿å¤–å±‚çš„ typesã€‚</li>
<li><strong>è®¾ç½®å…¨å±€ transition</strong>ï¼šæŠŠæ–°åˆ›å»ºçš„ transition èµ‹å€¼ç»™ <code>ReactSharedInternals.T</code>ã€‚è¿™æ ·ï¼Œåœ¨ <code>scope</code> å‡½æ•°é‡Œè°ƒç”¨çš„ <code>setState</code> å°±èƒ½çŸ¥é“å½“å‰åœ¨ transition é‡Œäº†ã€‚</li>
<li><strong>æ‰§è¡Œç”¨æˆ·ä»£ç </strong>ï¼šåœ¨ try å—é‡Œæ‰§è¡Œä½ ä¼ å…¥çš„ <code>scope</code> å‡½æ•°ã€‚</li>
<li><strong>å¤„ç†å¼‚æ­¥è¿”å›å€¼</strong>ï¼šå¦‚æœ <code>scope</code> è¿”å›çš„æ˜¯ Promiseï¼Œä¼šåšä¸€äº›å¤„ç†ï¼Œæ¯”å¦‚åœ¨å¼€å‘æ¨¡å¼ä¸‹è·Ÿè¸ªå¼‚æ­¥ transition çš„æ•°é‡ã€‚</li>
<li><strong>æ¢å¤çŠ¶æ€</strong>ï¼šåœ¨ finally å—é‡Œæ¢å¤ä¹‹å‰çš„ transition çŠ¶æ€ã€‚è¿™æ ·åµŒå¥—çš„ transition å°±èƒ½æ­£ç¡®æ¢å¤ã€‚</li>
</ol>
<p>è¿™ä¸ªè®¾è®¡è¿˜æ”¯æŒåµŒå¥— transitionã€‚æ¯”å¦‚ä½ åœ¨ä¸€ä¸ª <code>startTransition</code> é‡Œåˆè°ƒç”¨äº†å¦ä¸€ä¸ª <code>startTransition</code>ï¼Œå†…å±‚çš„ä¼šç»§æ‰¿å¤–å±‚çš„ typesï¼Œå®ƒä»¬ä¼šè¢«å½“ä½œåŒä¸€ä¸ª transition å¤„ç†ã€‚</p>
<h3 data-id="heading-18">ä¼˜å…ˆçº§è°ƒåº¦æœºåˆ¶</h3>
<p>React ç”¨ Lane æ¨¡å‹æ¥ç®¡ç†æ›´æ–°çš„ä¼˜å…ˆçº§ã€‚Lane å°±æ˜¯"è½¦é“"çš„æ„æ€ï¼Œä¸åŒçš„æ›´æ–°èµ°ä¸åŒçš„è½¦é“ï¼Œä¼˜å…ˆçº§é«˜çš„è½¦é“å¯ä»¥å…ˆèµ°ã€‚</p>
<p>å½“ä½ åœ¨ <code>startTransition</code> é‡Œè°ƒç”¨ <code>setState</code> çš„æ—¶å€™ï¼ŒReact æ€ä¹ˆçŸ¥é“è¿™ä¸ªæ›´æ–°æ˜¯ä½ä¼˜å…ˆçº§çš„å‘¢ï¼Ÿæˆ‘ä»¬æ¥çœ‹çœ‹ <code>requestUpdateLane</code> è¿™ä¸ªå‡½æ•°ï¼š</p>
<p>åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffacebook%2Freact%2Fblob%2F053df4e8561ef4caecef31c330f4178ac25e255b%2Fpackages%2Freact-reconciler%2Fsrc%2FReactFiberWorkLoop.js%23L792-L836" target="_blank" title="https://github.com/facebook/react/blob/053df4e8561ef4caecef31c330f4178ac25e255b/packages/react-reconciler/src/ReactFiberWorkLoop.js#L792-L836" ref="nofollow noopener noreferrer">packages/react-reconciler/src/ReactFiberWorkLoop.js</a> ä¸­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">requestUpdateLane</span>(<span class="hljs-params">fiber: Fiber</span>): <span class="hljs-title class_">Lane</span> {
  <span class="hljs-comment">// Special cases</span>
  <span class="hljs-keyword">const</span> mode = fiber.<span class="hljs-property">mode</span>;
  <span class="hljs-keyword">if</span> (!disableLegacyMode &amp;&amp; (mode &amp; <span class="hljs-title class_">ConcurrentMode</span>) === <span class="hljs-title class_">NoMode</span>) {
    <span class="hljs-keyword">return</span> (<span class="hljs-title class_">SyncLane</span>: <span class="hljs-title class_">Lane</span>);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (
    (executionContext &amp; <span class="hljs-title class_">RenderContext</span>) !== <span class="hljs-title class_">NoContext</span> &amp;&amp;
    workInProgressRootRenderLanes !== <span class="hljs-title class_">NoLanes</span>
  ) {
    <span class="hljs-comment">// This is a render phase update. These are not officially supported. The</span>
    <span class="hljs-comment">// old behavior is to give this the same "thread" (lanes) as</span>
    <span class="hljs-comment">// whatever is currently rendering. So if you call `setState` on a component</span>
    <span class="hljs-comment">// that happens later in the same render, it will flush. Ideally, we want to</span>
    <span class="hljs-comment">// remove the special case and treat them as if they came from an</span>
    <span class="hljs-comment">// interleaved event. Regardless, this pattern is not officially supported.</span>
    <span class="hljs-comment">// This behavior is only a fallback. The flag only exists until we can roll</span>
    <span class="hljs-comment">// out the setState warning, since existing code might accidentally rely on</span>
    <span class="hljs-comment">// the current behavior.</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">pickArbitraryLane</span>(workInProgressRootRenderLanes);
  }

  <span class="hljs-keyword">const</span> transition = <span class="hljs-title function_">requestCurrentTransition</span>();
  <span class="hljs-keyword">if</span> (transition !== <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">if</span> (enableGestureTransition) {
      <span class="hljs-keyword">if</span> (transition.<span class="hljs-property">gesture</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(
          <span class="hljs-string">'Cannot setState on regular state inside a startGestureTransition. '</span> +
            <span class="hljs-string">'Gestures can only update the useOptimistic() hook. There should be no '</span> +
            <span class="hljs-string">'side-effects associated with starting a Gesture until its Action is '</span> +
            <span class="hljs-string">'invoked. Move side-effects to the Action instead.'</span>,
        );
      }
    }
    <span class="hljs-keyword">if</span> (__DEV__) {
      <span class="hljs-keyword">if</span> (!transition.<span class="hljs-property">_updatedFibers</span>) {
        transition.<span class="hljs-property">_updatedFibers</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
      }
      transition.<span class="hljs-property">_updatedFibers</span>.<span class="hljs-title function_">add</span>(fiber);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-title function_">requestTransitionLane</span>(transition);
  }

  <span class="hljs-keyword">return</span> <span class="hljs-title function_">eventPriorityToLane</span>(<span class="hljs-title function_">resolveUpdatePriority</span>());
}
</code></pre>
<p>è¿™ä¸ªå‡½æ•°çš„å·¥ä½œæµç¨‹å¾ˆç®€å•ï¼š</p>
<ol>
<li>å…ˆæ£€æŸ¥ fiber çš„æ¨¡å¼ï¼Œå¦‚æœä¸æ˜¯å¹¶å‘æ¨¡å¼ï¼Œç›´æ¥è¿”å›åŒæ­¥ laneã€‚</li>
<li>æ£€æŸ¥æ˜¯ä¸æ˜¯åœ¨æ¸²æŸ“é˜¶æ®µæ›´æ–°ï¼ˆè¿™ä¸ªä¸æ¨èï¼Œä½† React è¿˜æ˜¯æ”¯æŒäº†ï¼‰ã€‚</li>
<li><strong>å…³é”®æ­¥éª¤</strong>ï¼šè°ƒç”¨ <code>requestCurrentTransition()</code> æ£€æŸ¥å½“å‰æœ‰æ²¡æœ‰ active transitionã€‚è¿™ä¸ªå‡½æ•°ä¼šå»è¯» <code>ReactSharedInternals.T</code>ï¼Œä¹Ÿå°±æ˜¯ <code>startTransition</code> è®¾ç½®çš„é‚£ä¸ªå…¨å±€å˜é‡ã€‚</li>
<li>å¦‚æœæœ‰ transitionï¼Œè°ƒç”¨ <code>requestTransitionLane()</code> è¿”å› transition laneï¼ˆä½ä¼˜å…ˆçº§ï¼‰ã€‚</li>
<li>å¦åˆ™ï¼Œç”¨ <code>eventPriorityToLane()</code> è¿”å›é»˜è®¤çš„ event priority laneï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰ã€‚</li>
</ol>
<p>æ‰€ä»¥ï¼Œå½“ä½ åœ¨ <code>startTransition</code> é‡Œè°ƒç”¨ <code>setState</code> çš„æ—¶å€™ï¼ŒReact ä¼šæ£€æŸ¥åˆ°å½“å‰æœ‰ active transitionï¼Œç„¶åç»™ä½ åˆ†é…ä¸€ä¸ªä½ä¼˜å…ˆçº§çš„ laneã€‚</p>
<h4 data-id="heading-19">requestTransitionLane</h4>
<p><code>requestTransitionLane</code> è´Ÿè´£åˆ†é… transition laneã€‚æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„å®ç°ï¼š</p>
<p>åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffacebook%2Freact%2Fblob%2F053df4e8561ef4caecef31c330f4178ac25e255b%2Fpackages%2Freact-reconciler%2Fsrc%2FReactFiberRootScheduler.js%23L697-L723" target="_blank" title="https://github.com/facebook/react/blob/053df4e8561ef4caecef31c330f4178ac25e255b/packages/react-reconciler/src/ReactFiberRootScheduler.js#L697-L723" ref="nofollow noopener noreferrer">packages/react-reconciler/src/ReactFiberRootScheduler.js</a> ä¸­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">requestTransitionLane</span>(<span class="hljs-params">
  <span class="hljs-comment">// This argument isn't used, it's only here to encourage the caller to</span>
  <span class="hljs-comment">// check that it's inside a transition before calling this function.</span>
  <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Make this non-nullable. Requires a tweak to useOptimistic.</span>
  transition: Transition | <span class="hljs-literal">null</span>,
</span>): <span class="hljs-title class_">Lane</span> {
  <span class="hljs-comment">// The algorithm for assigning an update to a lane should be stable for all</span>
  <span class="hljs-comment">// updates at the same priority within the same event. To do this, the</span>
  <span class="hljs-comment">// inputs to the algorithm must be the same.</span>
  <span class="hljs-comment">//</span>
  <span class="hljs-comment">// The trick we use is to cache the first of each of these inputs within an</span>
  <span class="hljs-comment">// event. Then reset the cached values once we can be sure the event is</span>
  <span class="hljs-comment">// over. Our heuristic for that is whenever we enter a concurrent work loop.</span>
  <span class="hljs-keyword">if</span> (currentEventTransitionLane === <span class="hljs-title class_">NoLane</span>) {
    <span class="hljs-comment">// All transitions within the same event are assigned the same lane.</span>
    <span class="hljs-keyword">const</span> actionScopeLane = <span class="hljs-title function_">peekEntangledActionLane</span>();
    currentEventTransitionLane =
      actionScopeLane !== <span class="hljs-title class_">NoLane</span>
        ? <span class="hljs-comment">// We're inside an async action scope. Reuse the same lane.</span>
          actionScopeLane
        : <span class="hljs-comment">// We may or may not be inside an async action scope. If we are, this</span>
          <span class="hljs-comment">// is the first update in that scope. Either way, we need to get a</span>
          <span class="hljs-comment">// fresh transition lane.</span>
          <span class="hljs-title function_">claimNextTransitionUpdateLane</span>();
  }
  <span class="hljs-keyword">return</span> currentEventTransitionLane;
}
</code></pre>
<p>è¿™ä¸ªå‡½æ•°åšäº†å‡ ä»¶äº‹ï¼š</p>
<ol>
<li><strong>äº‹ä»¶çº§åˆ«çš„ lane ç¼“å­˜</strong>ï¼šåŒä¸€ä¸ªäº‹ä»¶é‡Œçš„æ‰€æœ‰ transition æ›´æ–°å…±äº«åŒä¸€ä¸ª laneã€‚æ¯”å¦‚ä½ åœ¨ä¸€ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°é‡Œè°ƒç”¨äº†å¤šä¸ª <code>startTransition</code>ï¼Œå®ƒä»¬ä¼šç”¨åŒä¸€ä¸ª laneã€‚</li>
<li><strong>å¼‚æ­¥ action scope æ”¯æŒ</strong>ï¼šå¦‚æœä½ åœ¨å¼‚æ­¥ action scope é‡Œï¼ˆæ¯”å¦‚ Server Actionï¼‰ï¼Œä¼šå¤ç”¨ç›¸åŒçš„ laneã€‚</li>
<li><strong>lane åˆ†é…</strong>ï¼šå¦‚æœæ²¡æœ‰ç¼“å­˜çš„ laneï¼Œå°±ç”¨ <code>claimNextTransitionUpdateLane()</code> åˆ†é…ä¸€ä¸ªæ–°çš„ transition laneã€‚</li>
</ol>
<h4 data-id="heading-20">Lane ä¼˜å…ˆçº§ç³»ç»Ÿ</h4>
<p>Lane æ˜¯ç”¨ä½è¿ç®—å®ç°çš„ï¼Œè¿™æ ·åˆ¤æ–­å’Œåˆ†é…éƒ½å¾ˆå¿«ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ transition lane æ˜¯æ€ä¹ˆåˆ†é…çš„ï¼š</p>
<p>åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffacebook%2Freact%2Fblob%2F053df4e8561ef4caecef31c330f4178ac25e255b%2Fpackages%2Freact-reconciler%2Fsrc%2FReactFiberLane.js%23L709-L731" target="_blank" title="https://github.com/facebook/react/blob/053df4e8561ef4caecef31c330f4178ac25e255b/packages/react-reconciler/src/ReactFiberLane.js#L709-L731" ref="nofollow noopener noreferrer">packages/react-reconciler/src/ReactFiberLane.js</a> ä¸­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">isTransitionLane</span>(<span class="hljs-params">lane: Lane</span>): boolean {
  <span class="hljs-keyword">return</span> (lane &amp; <span class="hljs-title class_">TransitionLanes</span>) !== <span class="hljs-title class_">NoLanes</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">claimNextTransitionUpdateLane</span>(<span class="hljs-params"/>): <span class="hljs-title class_">Lane</span> {
  <span class="hljs-comment">// Cycle through the lanes, assigning each new transition to the next lane.</span>
  <span class="hljs-comment">// In most cases, this means every transition gets its own lane, until we</span>
  <span class="hljs-comment">// run out of lanes and cycle back to the beginning.</span>
  <span class="hljs-keyword">const</span> lane = nextTransitionUpdateLane;
  nextTransitionUpdateLane &lt;&lt;= <span class="hljs-number">1</span>;
  <span class="hljs-keyword">if</span> ((nextTransitionUpdateLane &amp; <span class="hljs-title class_">TransitionUpdateLanes</span>) === <span class="hljs-title class_">NoLanes</span>) {
    nextTransitionUpdateLane = <span class="hljs-title class_">TransitionLane1</span>;
  }
  <span class="hljs-keyword">return</span> lane;
}
</code></pre>
<p><code>claimNextTransitionUpdateLane</code> çš„é€»è¾‘å¾ˆç®€å•ï¼š</p>
<ol>
<li>å–å½“å‰çš„ <code>nextTransitionUpdateLane</code> ä½œä¸ºè¦è¿”å›çš„ laneã€‚</li>
<li>æŠŠ <code>nextTransitionUpdateLane</code> å·¦ç§»ä¸€ä½ï¼ˆç›¸å½“äºä¹˜ä»¥ 2ï¼‰ï¼Œè¿™æ ·ä¸‹æ¬¡å°±èƒ½åˆ†é…ä¸‹ä¸€ä¸ª laneã€‚</li>
<li>å¦‚æœå·¦ç§»åè¶…å‡ºäº† transition lanes çš„èŒƒå›´ï¼Œå°±å¾ªç¯å›åˆ°ç¬¬ä¸€ä¸ª transition laneã€‚</li>
</ol>
<p>è¿™æ ·ï¼Œæ¯ä¸ªæ–°çš„ transition éƒ½ä¼šå¾—åˆ°è‡ªå·±çš„ laneï¼Œç›´åˆ° lanes ç”¨å°½ï¼Œç„¶åå¾ªç¯ä½¿ç”¨ã€‚</p>
<p>Lane çš„ä¼˜å…ˆçº§è§„åˆ™æ˜¯ï¼šTransition lanes çš„ä¼˜å…ˆçº§ä½äºåŒæ­¥ lanesï¼ˆSyncLaneï¼‰å’Œé»˜è®¤ lanesï¼ˆDefaultLaneï¼‰ã€‚æ‰€ä»¥å½“æœ‰é«˜ä¼˜å…ˆçº§çš„æ›´æ–°ï¼ˆæ¯”å¦‚ç”¨æˆ·è¾“å…¥ï¼‰æ—¶ï¼ŒReact ä¼šä¸­æ–­ transition çš„æ¸²æŸ“ï¼Œå…ˆå¤„ç†é«˜ä¼˜å…ˆçº§çš„æ›´æ–°ï¼Œç„¶åå†å›æ¥ç»§ç»­æ¸²æŸ“ transitionã€‚</p>
<h2 data-id="heading-21">å·¥ä½œåŸç†æµç¨‹å›¾</h2>
<p>è®©æˆ‘ä»¬é€šè¿‡æµç¨‹å›¾æ¥ç†è§£ <code>useTransition</code> çš„å®Œæ•´å·¥ä½œæµç¨‹ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[ç”¨æˆ·è°ƒç”¨ startTransition] --&gt; B[è®¾ç½® ReactSharedInternals.T]
    B --&gt; C[æ‰§è¡Œ scope å‡½æ•°]
    C --&gt; D[è°ƒç”¨ setState]
    D --&gt; E[requestUpdateLane]
    E --&gt; F{æ£€æŸ¥æ˜¯å¦æœ‰ active transition?}
    F --&gt;|æ˜¯| G[requestTransitionLane]
    F --&gt;|å¦| H[eventPriorityToLane]
    G --&gt; I[åˆ†é… Transition Lane]
    I --&gt; J[æ ‡è®°æ›´æ–°ä¸ºä½ä¼˜å…ˆçº§]
    J --&gt; K[React è°ƒåº¦å™¨å¤„ç†]
    K --&gt; L{æœ‰æ›´é«˜ä¼˜å…ˆçº§æ›´æ–°?}
    L --&gt;|æ˜¯| M[ä¸­æ–­ transition æ¸²æŸ“]
    L --&gt;|å¦| N[ç»§ç»­æ¸²æŸ“ transition æ›´æ–°]
    M --&gt; O[å¤„ç†é«˜ä¼˜å…ˆçº§æ›´æ–°]
    O --&gt; P[æ¢å¤ transition æ¸²æŸ“]
    N --&gt; Q[å®Œæˆæ¸²æŸ“]
    P --&gt; Q
    Q --&gt; R[æ¢å¤ ReactSharedInternals.T]
    
    style I fill:#e1f5ff
    style J fill:#e1f5ff
    style M fill:#fff4e6
    style O fill:#fff4e6
</code></pre>
<p><strong>æµç¨‹è¯´æ˜</strong>ï¼š</p>
<ol>
<li>ç”¨æˆ·è°ƒç”¨ <code>startTransition</code>ï¼Œè®¾ç½®å…¨å±€ transition ä¸Šä¸‹æ–‡</li>
<li>åœ¨ scope ä¸­è°ƒç”¨ <code>setState</code> è§¦å‘æ›´æ–°</li>
<li>React é€šè¿‡ <code>requestUpdateLane</code> æ£€æŸ¥æ˜¯å¦æœ‰ active transition</li>
<li>å¦‚æœæœ‰ï¼Œåˆ†é… transition laneï¼ˆä½ä¼˜å…ˆçº§ï¼‰</li>
<li>React è°ƒåº¦å™¨å¯ä»¥ä¸­æ–­ transition æ¸²æŸ“æ¥å¤„ç†æ›´é«˜ä¼˜å…ˆçº§çš„æ›´æ–°</li>
<li>é«˜ä¼˜å…ˆçº§æ›´æ–°å®Œæˆåï¼Œæ¢å¤ transition æ¸²æŸ“</li>
<li>æœ€ç»ˆæ¢å¤ transition ä¸Šä¸‹æ–‡</li>
</ol>
<h2 data-id="heading-22">æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-23">ä½•æ—¶ä½¿ç”¨ useTransition</h3>
<p><code>useTransition</code> ç‰¹åˆ«é€‚åˆä»¥ä¸‹åœºæ™¯ï¼š</p>
<ol>
<li>
<p><strong>æœç´¢å’Œç­›é€‰</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> [isPending, startTransition] = <span class="hljs-title function_">useTransition</span>();
<span class="hljs-keyword">const</span> [query, setQuery] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSearch</span> = (<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) =&gt; {
  <span class="hljs-title function_">setQuery</span>(value); <span class="hljs-comment">// é«˜ä¼˜å…ˆçº§ï¼šç«‹å³æ›´æ–°è¾“å…¥æ¡†</span>
  <span class="hljs-title function_">startTransition</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">setFilteredResults</span>(<span class="hljs-title function_">filterResults</span>(value)); <span class="hljs-comment">// ä½ä¼˜å…ˆçº§ï¼šå»¶è¿Ÿæ›´æ–°ç»“æœ</span>
  });
};
</code></pre>
</li>
<li>
<p><strong>æ ‡ç­¾åˆ‡æ¢</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> [isPending, startTransition] = <span class="hljs-title function_">useTransition</span>();
<span class="hljs-keyword">const</span> [activeTab, setActiveTab] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">'home'</span>);

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleTabChange</span> = (<span class="hljs-params">tab: <span class="hljs-built_in">string</span></span>) =&gt; {
  <span class="hljs-title function_">startTransition</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">setActiveTab</span>(tab); <span class="hljs-comment">// æ ‡ç­¾å†…å®¹æ¸²æŸ“å¯ä»¥å»¶è¿Ÿ</span>
  });
};
</code></pre>
</li>
<li>
<p><strong>åˆ—è¡¨æ¸²æŸ“</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> [isPending, startTransition] = <span class="hljs-title function_">useTransition</span>();
<span class="hljs-keyword">const</span> [items, setItems] = <span class="hljs-title function_">useState</span>([]);

<span class="hljs-keyword">const</span> <span class="hljs-title function_">loadMoreItems</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-title function_">startTransition</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">setItems</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> [...prev, ...newItems]); <span class="hljs-comment">// å¤§é‡åˆ—è¡¨é¡¹æ¸²æŸ“</span>
  });
};
</code></pre>
</li>
</ol>
<h3 data-id="heading-24">ä¸é˜²æŠ–/èŠ‚æµçš„åŒºåˆ«</h3>



































<table><thead><tr><th>ç‰¹æ€§</th><th>useTransition</th><th>é˜²æŠ–/èŠ‚æµ</th></tr></thead><tbody><tr><td>å»¶è¿Ÿæœºåˆ¶</td><td>åŸºäºä¼˜å…ˆçº§è°ƒåº¦</td><td>åŸºäºæ—¶é—´å»¶è¿Ÿ</td></tr><tr><td>è¾“å…¥å“åº”</td><td>å³æ—¶å“åº”</td><td>æœ‰å›ºå®šå»¶è¿Ÿ</td></tr><tr><td>æ¸²æŸ“æ§åˆ¶</td><td>React è‡ªåŠ¨ç®¡ç†</td><td>æ‰‹åŠ¨æ§åˆ¶</td></tr><tr><td>ä¸­æ–­èƒ½åŠ›</td><td>æ”¯æŒä¸­æ–­å’Œæ¢å¤</td><td>ä¸æ”¯æŒ</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>å¤æ‚æ¸²æŸ“åœºæ™¯</td><td>å‡å°‘è®¡ç®—/è¯·æ±‚</td></tr></tbody></table>
<p><strong>å…³é”®åŒºåˆ«</strong>ï¼š</p>
<ul>
<li><code>useTransition</code> ä¸ä¼šå»¶è¿Ÿç”¨æˆ·è¾“å…¥ï¼Œè€Œæ˜¯è®© React æ™ºèƒ½åœ°è°ƒåº¦æ¸²æŸ“</li>
<li>é˜²æŠ–/èŠ‚æµä¼šå›ºå®šå»¶è¿Ÿï¼Œå¯èƒ½å½±å“ç”¨æˆ·ä½“éªŒ</li>
<li><code>useTransition</code> åˆ©ç”¨ React çš„å¹¶å‘ç‰¹æ€§ï¼Œå¯ä»¥ä¸­æ–­å’Œæ¢å¤æ¸²æŸ“</li>
</ul>
<h3 data-id="heading-25">æ³¨æ„äº‹é¡¹å’Œé™åˆ¶</h3>
<ol>
<li>
<p><strong>ä¸è¦ç”¨äºç´§æ€¥æ›´æ–°</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šç´§æ€¥æ›´æ–°ä¸åº”è¯¥ç”¨ useTransition</span>
<span class="hljs-title function_">startTransition</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">setError</span>(error); <span class="hljs-comment">// é”™è¯¯ä¿¡æ¯åº”è¯¥ç«‹å³æ˜¾ç¤º</span>
});

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šéç´§æ€¥çš„ UI æ›´æ–°</span>
<span class="hljs-title function_">startTransition</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">setSearchResults</span>(results); <span class="hljs-comment">// æœç´¢ç»“æœå¯ä»¥å»¶è¿Ÿæ˜¾ç¤º</span>
});
</code></pre>
</li>
<li>
<p><strong>isPending çš„ä½¿ç”¨</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> [isPending, startTransition] = <span class="hljs-title function_">useTransition</span>();

<span class="hljs-keyword">return</span> (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span> /&gt;</span>
    {isPending &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">Spinner</span> /&gt;</span>} {/* æ˜¾ç¤ºåŠ è½½çŠ¶æ€ */}
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
);
</code></pre>
</li>
<li>
<p><strong>é¿å…åœ¨ transition ä¸­è¿›è¡Œå‰¯ä½œç”¨</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šå‰¯ä½œç”¨åº”è¯¥åœ¨ transition å¤–</span>
<span class="hljs-title function_">startTransition</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">setState</span>(newState);
  <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">'Updated'</span>; <span class="hljs-comment">// å‰¯ä½œç”¨</span>
});

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šåªæ›´æ–°çŠ¶æ€</span>
<span class="hljs-title function_">startTransition</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">setState</span>(newState);
});
<span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">'Updated'</span>; <span class="hljs-comment">// å‰¯ä½œç”¨åœ¨ transition å¤–</span>
</code></pre>
</li>
<li>
<p><strong>ä¸ Suspense é…åˆä½¿ç”¨</strong></p>
<pre><code class="hljs language-typescript" lang="typescript">&lt;<span class="hljs-title class_">Suspense</span> fallback={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Loading</span> /&gt;</span></span>}&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">SearchResults</span> <span class="hljs-attr">query</span>=<span class="hljs-string">{query}</span> /&gt;</span></span>
&lt;/<span class="hljs-title class_">Suspense</span>&gt;
</code></pre>
</li>
</ol>
<h2 data-id="heading-26">æ€»ç»“</h2>
<p><code>useTransition</code> æ˜¯ React 18 å¹¶å‘ç‰¹æ€§çš„æ ¸å¿ƒ API ä¹‹ä¸€ï¼Œå®ƒé€šè¿‡ä»¥ä¸‹æœºåˆ¶å®ç°äº†ä¼˜ç§€çš„æ€§èƒ½ä¼˜åŒ–ï¼š</p>
<ol>
<li><strong>ä¼˜å…ˆçº§è°ƒåº¦</strong>ï¼šå°†éç´§æ€¥æ›´æ–°æ ‡è®°ä¸ºä½ä¼˜å…ˆçº§ï¼Œè®© React ä¼˜å…ˆå¤„ç†ç”¨æˆ·äº¤äº’</li>
<li><strong>å¯ä¸­æ–­æ¸²æŸ“</strong>ï¼šæ”¯æŒä¸­æ–­å’Œæ¢å¤ï¼Œä¿æŒ UI å“åº”æ€§</li>
<li><strong>æ™ºèƒ½å¹³è¡¡</strong>ï¼šè‡ªåŠ¨å¹³è¡¡è¾“å…¥å“åº”å’Œæ¸²æŸ“æ€§èƒ½</li>
</ol>
<p>é€šè¿‡æœ¬æ–‡çš„æºç åˆ†æï¼Œæˆ‘ä»¬äº†è§£åˆ°ï¼š</p>
<ul>
<li><code>useTransition</code> é€šè¿‡å†…éƒ¨çŠ¶æ€ç®¡ç† pending çŠ¶æ€</li>
<li><code>startTransition</code> é€šè¿‡è®¾ç½®å…¨å±€ä¸Šä¸‹æ–‡æ ‡è®°æ›´æ–°ä¸ºä½ä¼˜å…ˆçº§</li>
<li>React è°ƒåº¦å™¨é€šè¿‡ Lane æ¨¡å‹ç®¡ç†ä¸åŒä¼˜å…ˆçº§çš„æ›´æ–°</li>
<li>Transition lanes çš„ä¼˜å…ˆçº§ä½äºåŒæ­¥å’Œé»˜è®¤ lanes</li>
</ul>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥ï¼š</p>
<ul>
<li>å°†éç´§æ€¥çš„ UI æ›´æ–°åŒ…è£…åœ¨ <code>startTransition</code> ä¸­</li>
<li>ä½¿ç”¨ <code>isPending</code> æä¾›åŠ è½½åé¦ˆ</li>
<li>é¿å…åœ¨ transition ä¸­è¿›è¡Œå‰¯ä½œç”¨</li>
<li>ç†è§£ä¸é˜²æŠ–/èŠ‚æµçš„åŒºåˆ«ï¼Œé€‰æ‹©åˆé€‚çš„æŠ€æœ¯</li>
</ul>
<p>React 18 çš„å¹¶å‘ç‰¹æ€§ä¸ºæ„å»ºé«˜æ€§èƒ½ã€å“åº”è¿…é€Ÿçš„ç”¨æˆ·ç•Œé¢æä¾›äº†å¼ºå¤§çš„å·¥å…·ã€‚<code>useTransition</code> ä½œä¸ºå…¶ä¸­çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå€¼å¾—æˆ‘ä»¬æ·±å…¥ç†è§£å’Œåˆç†ä½¿ç”¨ã€‚</p>
<h2 data-id="heading-27">å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Freact.dev%2Freference%2Freact%2FuseTransition" target="_blank" title="https://react.dev/reference/react/useTransition" ref="nofollow noopener noreferrer">React å®˜æ–¹æ–‡æ¡£ - useTransition</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffacebook%2Freact%2Fblob%2F053df4e8561ef4caecef31c330f4178ac25e255b%2Fpackages%2Freact-reconciler%2Fsrc%2FReactFiberHooks.js" target="_blank" title="https://github.com/facebook/react/blob/053df4e8561ef4caecef31c330f4178ac25e255b/packages/react-reconciler/src/ReactFiberHooks.js" ref="nofollow noopener noreferrer">React æºç  - ReactFiberHooks.js</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffacebook%2Freact%2Fblob%2F053df4e8561ef4caecef31c330f4178ac25e255b%2Fpackages%2Freact%2Fsrc%2FReactStartTransition.js" target="_blank" title="https://github.com/facebook/react/blob/053df4e8561ef4caecef31c330f4178ac25e255b/packages/react/src/ReactStartTransition.js" ref="nofollow noopener noreferrer">React æºç  - ReactStartTransition.js</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffacebook%2Freact%2Ftree%2Fmain%2Ffixtures%2Fconcurrent%2Ftime-slicing" target="_blank" title="https://github.com/facebook/react/tree/main/fixtures/concurrent/time-slicing" ref="nofollow noopener noreferrer">React å®˜æ–¹ç¤ºä¾‹ - time-slicing fixture</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Flutter å®ç°ä¸€ä¸ªå®¹å™¨å†…éƒ¨å…ƒç´ å¯å¹³ç§»ã€ç¼©æ”¾å’Œæ—‹è½¬ç­‰åŠŸèƒ½ï¼ˆä¸‰ï¼‰]]></title>    <link>https://juejin.cn/post/7582854603061575722</link>    <guid>https://juejin.cn/post/7582854603061575722</guid>    <pubDate>2025-12-13T15:54:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582854603061575722" data-draft-id="7582857981894967337" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Flutter å®ç°ä¸€ä¸ªå®¹å™¨å†…éƒ¨å…ƒç´ å¯å¹³ç§»ã€ç¼©æ”¾å’Œæ—‹è½¬ç­‰åŠŸèƒ½ï¼ˆä¸‰ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,Flutter"/> <meta itemprop="datePublished" content="2025-12-13T15:54:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åå­—è¢«ä½ ä»¬æƒ³å®Œäº†"/> <meta itemprop="url" content="https://juejin.cn/user/3065854916834782"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Flutter å®ç°ä¸€ä¸ªå®¹å™¨å†…éƒ¨å…ƒç´ å¯å¹³ç§»ã€ç¼©æ”¾å’Œæ—‹è½¬ç­‰åŠŸèƒ½ï¼ˆä¸‰ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3065854916834782/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åå­—è¢«ä½ ä»¬æƒ³å®Œäº†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T15:54:23.000Z" title="Sat Dec 13 2025 15:54:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Flutter å®ç°ä¸€ä¸ªå®¹å™¨å†…éƒ¨å…ƒç´ å¯å¹³ç§»ã€ç¼©æ”¾å’Œæ—‹è½¬ç­‰åŠŸèƒ½ï¼ˆä¸‰ï¼‰</h2>
<p>Flutter: 3.35.6</p>
<p>å› ä¸ºå®ç°äº†å•ä¸ªçš„ï¼Œç»™å‡ºgithubé“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fyhtqw%2FFrontEndDemo" target="_blank" title="https://github.com/yhtqw/FrontEndDemo" ref="nofollow noopener noreferrer">github.com/yhtqw/Frontâ€¦</a></p>
<p>å‰é¢æˆ‘ä»¬ç®€å•å®ç°äº†å…ƒç´ çš„å¹³ç§»å’Œç¼©æ”¾ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­å®ç°æ—‹è½¬åŠŸèƒ½ã€‚</p>
<p>å…ƒç´ çš„æ—‹è½¬ä¼šæ”¹å˜è§’åº¦ï¼Œè§’åº¦ä¸€å˜ï¼Œé‚£ä¹ˆå“åº”äº‹ä»¶çš„çƒ­åŒºä¹Ÿä¼šè·Ÿç€æ”¹å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—æå‰è€ƒè™‘è¿™äº›ä¼šå› ä¸ºè§’åº¦æ”¹å˜è€Œæ”¹å˜çš„åœ°æ–¹ã€‚</p>
<p>å…ˆæ¥ç®€å•å®ç°ä¸€ä¸‹æ—‹è½¬ï¼Œå…ˆä¸è€ƒè™‘ä¸Šè¿°çš„çƒ­åŒºé—®é¢˜ã€‚</p>
<p>è¦å®ç°æ—‹è½¬ï¼Œæˆ‘ä»¬å°±å¾—çŸ¥é“å…ƒç´ çš„æ—‹è½¬è§’åº¦ï¼Œä¸»è¦å¾—å‡ºæ—‹è½¬çš„è§’åº¦ï¼Œé‚£ä¹ˆå®ç°èµ·æ¥å°±æ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥ç®€å•ä½¿ç”¨æ•°å­¦çš„çŸ¥è¯†åˆ†æä¸€ä¸‹å§</p>
<p>ä»æˆ‘ä»¬è¿™ä¸ªéœ€æ±‚ä¸­å¯ä»¥æå–åˆ°çš„æ•°æ®ä¸ºæŒ‰ä¸‹ç‚¹çš„åæ ‡ï¼Œæ‹–åŠ¨æ—¶å˜æ¢çš„åæ ‡ï¼›æ‰€ä»¥æˆ‘ä»¬èƒ½å¦æ ¹æ®ä¸€ä¸ªç‚¹çš„åæ ‡ï¼Œè®¡ç®—å‡ºè¯¥ç‚¹ä¸æŸç‚¹å½¢æˆçš„å¤¹è§’ï¼Œå¥½åƒåˆšå¥½æœ‰ä¸ªæ»¡è¶³éƒ¨åˆ†ï¼Œå°±æ˜¯arctan2ï¼Œarctan2çš„<strong>ä¸»è¦ä½œç”¨</strong>æ˜¯æ ¹æ®ä¸€ä¸ªç‚¹çš„åæ ‡ï¼Œè®¡ç®—å‡ºè¯¥ç‚¹ä¸åæ ‡åŸç‚¹æ‰€å½¢æˆçš„å¤¹è§’ï¼ˆä¸»è¦ä½œç”¨ï¼‰ï¼›å¦‚æœæˆ‘ä»¬è¦çŸ¥é“ç»™å‡ºç‚¹ä¸ä»»æ„(x', y')å½¢æˆçš„å¤¹è§’å‘¢ï¼Ÿå‰é¢çš„arctan2ä¸­å°†åæ ‡åŸç‚¹æ¢æˆä»»æ„æŸç‚¹ä¸å°±è¡Œäº†ï¼Ÿ</p>
<p>ä½¿ç”¨ arctan2 è®¡ç®—ä¸¤ç‚¹è¿çº¿çš„è§’åº¦ï¼Œæ ¸å¿ƒæ˜¯è®¡ç®—ä¸¤ç‚¹ä¹‹é—´çš„åæ ‡å·® (Î”x, Î”y)ï¼Œç„¶åå°†å…¶ä½œä¸º arctan2 çš„å‚æ•°ã€‚æ‰€ä»¥å®ç°èµ·æ¥å°±æ¯”è¾ƒç®€å•äº†ã€‚å…¶å®è¿™ä¸ªå®ç°çš„åŸç†åœ¨å¾ˆå¤šåœ°æ–¹éƒ½ä¸€æ ·ï¼Œä¾‹å¦‚webç«¯çš„å…ƒç´ æ‹–åŠ¨æ—‹è½¬ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªåŸç†ã€‚å®ç°çš„æ–¹å¼åº”è¯¥ä¸æ­¢ä¸€ç§å§ï¼Œåªè¦èƒ½è®¡ç®—å‡ºè¿™ä¸ªè§’åº¦å°±è¡Œäº†ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç°åœ¨æˆ‘ä»¬ç ”ç©¶çš„æ˜¯å•ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥åæ ‡ç³»å°±æ˜¯ä»¥å…ƒç´ è‡ªèº«å½¢æˆçš„ï¼ˆå“åº”çš„äº‹ä»¶ä¹Ÿæ˜¯åœ¨è¿™ä¸ªå…ƒç´ ä¸Šï¼‰ï¼Œç­‰åæœŸè¦å®ç°å¤šä¸ªï¼Œåæ ‡ç³»å°±å¾—ä»¥å¤–å±‚å®¹å™¨ä½œä¸ºå‚è€ƒäº†ã€‚</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// å…¶ä»–çœç•¥...</span>

<span class="hljs-comment">/// <span class="markdown">æ–°å¢æ—‹è½¬çŠ¶æ€çƒ­åŒºå­—ç¬¦ä¸²</span></span>
<span class="hljs-keyword">const</span> <span class="hljs-built_in">String</span> statusRotate = <span class="hljs-string">'rotate'</span>;

<span class="hljs-comment">/// <span class="markdown">æŠ½å–å“åº”æ—‹è½¬æ“ä½œåŒºåŸŸçš„å¤§å°</span></span>
<span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> rotateWidth = <span class="hljs-number">20</span>;
<span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> rotateHeight = <span class="hljs-number">20</span>;

<span class="hljs-comment">/// <span class="markdown">æ—‹è½¬è§’åº¦</span></span>
<span class="hljs-built_in">double</span> rotateNumber = <span class="hljs-number">0</span>;
<span class="hljs-built_in">double</span> initRotateNumber = <span class="hljs-number">0</span>;

<span class="hljs-keyword">void</span> _onPanUpdate(DragUpdateDetails details) {
  <span class="hljs-built_in">print</span>(<span class="hljs-string">'æ›´æ–°: <span class="hljs-subst">$details</span>'</span>);
  <span class="hljs-keyword">if</span> (status == statusMove) {
    _onMove(details.localPosition.dx, details.localPosition.dy);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (status == statusScale) {
    _onScale(details.delta.dx, details.delta.dy);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (status == statusRotate) {
    <span class="hljs-comment">// æ–°å¢æ—‹è½¬çƒ­åŒºçš„å“åº”äº‹ä»¶</span>
    _onRotate(details.localPosition.dx, details.localPosition.dy);
  }
}

<span class="hljs-keyword">void</span> _onPanEnd() {
  <span class="hljs-built_in">print</span>(<span class="hljs-string">'æŠ¬èµ·æˆ–è€…å› ä¸ºæŸäº›åŸå› å¹¶æ²¡æœ‰è§¦å‘onPanDownäº‹ä»¶'</span>);
  setState(() {
    <span class="hljs-comment">// å½“æ¬¡ç»“æŸåé‡æ–°è®°å½•ï¼Œä¹Ÿå¯ä»¥åœ¨æŒ‰ä¸‹æ—¶è®°å½•</span>
    initX = x;
    initY = y;
    <span class="hljs-comment">// æ–°å¢æ—‹è½¬è§’åº¦çš„è®°å½•</span>
    initRotateNumber = rotateNumber;
  });
}

<span class="hljs-comment">/// <span class="markdown">å¤„ç†æ—‹è½¬</span></span>
<span class="hljs-keyword">void</span> _onRotate(<span class="hljs-built_in">double</span> dx, <span class="hljs-built_in">double</span> dy) {
  <span class="hljs-comment">/// <span class="markdown">è¦è®¡ç®—ç‚¹ (x, y) ä¸ä»»æ„ç‚¹ (x', y') è¿çº¿æ‰€æˆçš„è§’åº¦ï¼Œå¯ä»¥ä½¿ç”¨ arctan2 å‡½æ•°ã€‚</span></span>
  <span class="hljs-comment">/// <span class="markdown">å…³é”®åœ¨äºå°†ä¸¤ç‚¹ä¹‹é—´çš„ç›¸å¯¹åæ ‡å·®ä½œä¸º arctan2 çš„è¾“å…¥å‚æ•°ã€‚</span></span>
  <span class="hljs-comment">/// <span class="markdown">è¿™é‡Œæˆ‘ä»¬ä»¥å…ƒç´ çš„ä¸­å¿ƒä¸ºæ—‹è½¬ä¸­å¿ƒ</span></span>
  <span class="hljs-comment">/// <span class="markdown">åˆ©ç”¨ä¸Šè¿°æ–¹æ³•è®¡ç®—èµ·å§‹ç‚¹ï¼ˆæŒ‰ä¸‹æ—¶ï¼‰ä¸ä¸­å¿ƒçš„è¿çº¿ç»„æˆçš„å¤¹è§’ä¸ºåˆå§‹å¤¹è§’ï¼Œ</span></span>
  <span class="hljs-comment">/// <span class="markdown">æ‹–åŠ¨çš„ç‚¹ä¸ä¸­å¿ƒç‚¹è¿çº¿ç»„å±‚çš„å¤¹è§’ä¸ºç»“æŸæ—¶çš„å¤¹è§’ï¼Œ</span></span>
  <span class="hljs-comment">/// <span class="markdown">é€šè¿‡åˆå§‹å¤¹è§’ä¸ç»“æŸå¤¹è§’è®¡ç®—æ—‹è½¬çš„è§’åº¦</span></span>

  <span class="hljs-comment">// ç¡®å®šæ—‹è½¬ä¸­å¿ƒï¼Œå› ä¸ºè¿™é‡Œçš„æ‹–åŠ¨æ˜¯å•ä¸ªå…ƒç´ ï¼Œåæ ‡éƒ½æ˜¯ç›¸å¯¹äºå…ƒç´ è‡ªèº«å½¢æˆçš„åæ ‡ç³»ï¼Œæ‰€ä»¥åæ ‡ä¸­å¿ƒå§‹ç»ˆéƒ½æ˜¯å…ƒç´ çš„ä¸­å¿ƒ</span>
  <span class="hljs-built_in">double</span> centerX = elementWidth / <span class="hljs-number">2</span>;
  <span class="hljs-built_in">double</span> centerY = elementHeight / <span class="hljs-number">2</span>;

  <span class="hljs-built_in">double</span> diffStartX = startPosition.dx - centerX;
  <span class="hljs-built_in">double</span> diffStartY = startPosition.dy - centerY;
  <span class="hljs-built_in">double</span> diffEndX = dx - centerX;
  <span class="hljs-built_in">double</span> diffEndY = dy - centerY;
  <span class="hljs-built_in">double</span> angleStart = atan2(diffStartY, diffStartX);
  <span class="hljs-built_in">double</span> angleEnd = atan2(diffEndY, diffEndX);

  setState(() {
    rotateNumber = initRotateNumber + angleEnd - angleStart;
  });
}

<span class="hljs-comment">/// <span class="markdown">åˆ¤æ–­ç‚¹å‡»åœ¨ä»€ä¹ˆåŒºåŸŸ</span></span>
<span class="hljs-built_in">String?</span> _onDownZone(<span class="hljs-built_in">double</span> x, <span class="hljs-built_in">double</span> y) {
  <span class="hljs-keyword">if</span> (
    x &gt;= elementWidth - scaleWidth &amp;&amp;
    x &lt;= elementWidth &amp;&amp;
    y &gt;= elementHeight - scaleHeight &amp;&amp;
    y &lt;= elementHeight
  ) {
    <span class="hljs-keyword">return</span> statusScale;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (
    x &gt;= elementWidth - rotateHeight &amp;&amp;
    x &lt;= elementWidth &amp;&amp;
    y &gt;= <span class="hljs-number">0</span> &amp;&amp;
    y &lt;= rotateHeight
  ) {
    <span class="hljs-comment">// å›ºå®šå³ä¸Šè§’ä¸ºæ—‹è½¬çƒ­åŒº</span>
    <span class="hljs-keyword">return</span> statusRotate;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (
    x &gt;= <span class="hljs-number">0</span> &amp;&amp;
    x &lt;= elementWidth &amp;&amp;
    y &gt;= <span class="hljs-number">0</span> &amp;&amp;
    y &lt;= elementHeight
  ) {
    <span class="hljs-keyword">return</span> statusMove;
  }

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
}

<span class="hljs-comment">// æ–°å¢å“åº”æ—‹è½¬æ“ä½œ</span>
Positioned(
  left: x,
  top: y,
  child: Transform.rotate(
    angle: rotateNumber,
    child: GestureDetector(
      onPanDown: _onPanDown,
      onPanUpdate: _onPanUpdate,
      onPanEnd: (details) =&gt; _onPanEnd(),
      onPanCancel: _onPanEnd,
      child: Container(
        width: elementWidth,
        height: elementHeight,
        color: Colors.transparent,
        child: Stack(
          alignment: Alignment.center,
          clipBehavior: Clip.none,
          children: [
            Container(
              width: elementWidth,
              height: elementHeight,
              color: Colors.amber,
            ),

            <span class="hljs-comment">// å“åº”æ—‹è½¬æ“ä½œ</span>
            Positioned(
              top: <span class="hljs-number">0</span>,
              right: <span class="hljs-number">0</span>,
              child: Container(
                width: scaleWidth,
                height: scaleHeight,
                color: Colors.white,
              ),
            ),

            <span class="hljs-comment">// å“åº”ç¼©æ”¾æ“ä½œ</span>
          ],
        ),
      ),
    ),
  ),
),

<span class="hljs-comment">// å…¶ä»–çœç•¥...</span>
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/918616cc40034d1eb330211d7940e254~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCN5a2X6KKr5L2g5Lus5oOz5a6M5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766246212&amp;x-signature=8sVrbhhTMdO8VkG75l6ycwzWFZo%3D" alt="image01.gif" loading="lazy"/></p>
<p>è¿™æ ·å°±ç®€å•å®ç°äº†æ—‹è½¬ã€‚ç„¶åæˆ‘ä»¬ç»§ç»­è€ƒè™‘çƒ­åŒºçš„é—®é¢˜ï¼Œå½“æ—‹è½¬ä¸€å®šè§’åº¦çš„æ—¶å€™ï¼Œå†æ¬¡ç‚¹å‡»å¯¹åº”çš„çƒ­åŒºï¼Œå°±æ— æ³•å“åº”äº‹ä»¶äº†ï¼Œå› ä¸ºæ—‹è½¬åçƒ­åŒºåæ ‡å·²ç»å‘ç”Ÿæ”¹å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—å¯¹ç‚¹å‡»åˆ¤æ–­ä¸­åŠ å…¥è§’åº¦çš„å½±å“ã€‚</p>
<p>å·²çŸ¥æŸç‚¹åæ ‡å’Œæ—‹è½¬è§’åº¦ï¼Œæ±‚æ—‹è½¬åçš„åæ ‡å€¼ï¼Ÿ</p>
<p>è¦è®¡ç®—æ—‹è½¬åçš„åæ ‡ï¼Œå¯ä»¥ä½¿ç”¨æ—‹è½¬çŸ©é˜µã€‚ç»™å®šä¸€ä¸ªç‚¹ (x, y) ç»•åŸç‚¹é€†æ—¶é’ˆæ—‹è½¬è§’åº¦ Î¸ åçš„æ–°åæ ‡ (x', y') è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p>
<p>x' = x * cosÎ¸ - y * sinÎ¸;
y' = x * sinÎ¸ + y * cosÎ¸;</p>
<p>å¦‚æœæˆ‘ä»¬æ˜¯ç»•ä»»æ„ç‚¹è€Œä¸æ˜¯åŸç‚¹ï¼Œéœ€è¦å…ˆå¹³ç§»åæ ‡ç³»</p>
<ol>
<li>å¹³ç§»: å°† (x, y) å¹³ç§»åˆ°åŸç‚¹ï¼Œæ–°åæ ‡ä¸º (x - a, y - b);</li>
<li>æ—‹è½¬: æŒ‰ç…§ä¸Šè¿°å…¬å¼è®¡ç®— (x', y');</li>
<li>å¹³ç§»å›åŸåæ ‡ç³»: æ–°åæ ‡ä¸º(x' + a, y' + b)ã€‚</li>
</ol>
<p>åŸºäºä¸Šé¢çš„å…¬å¼ï¼Œæˆ‘ä»¬æ›´æ”¹çƒ­åŒºç‚¹å‡»åˆ¤æ–­æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">/// <span class="markdown">åˆ¤æ–­ç‚¹å‡»åœ¨ä»€ä¹ˆåŒºåŸŸ</span></span>
<span class="hljs-built_in">String?</span> _onDownZone(<span class="hljs-built_in">double</span> x, <span class="hljs-built_in">double</span> y) {
  <span class="hljs-keyword">final</span> offsetScale = rotatePoint(elementWidth, elementHeight);
  <span class="hljs-comment">// è®¾ç½®éƒ½æ˜¯æœ€å¤§çš„é¡¶ç‚¹åæ ‡ï¼Œæ–¹ä¾¿ä¸‹é¢åˆ¤æ–­åŒºåŸŸçš„æ–¹å¼ç»“æ„ä¸€è‡´</span>
  <span class="hljs-comment">// åç»­å°±å¥½æŠ½å–æ–¹æ³•</span>
  <span class="hljs-keyword">final</span> offsetRotate = rotatePoint(elementWidth, rotateHeight);

  <span class="hljs-keyword">if</span> (
    x &gt;= offsetScale.dx - scaleWidth &amp;&amp;
    x &lt;= offsetScale.dx &amp;&amp;
    y &gt;= offsetScale.dy - scaleHeight &amp;&amp;
    y &lt;= offsetScale.dy
  ) {
    <span class="hljs-keyword">return</span> statusScale;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (
    x &gt;= offsetRotate.dx - rotateHeight &amp;&amp;
    x &lt;= offsetRotate.dx &amp;&amp;
    y &gt;= offsetRotate.dy - rotateHeight &amp;&amp;
    y &lt;= offsetRotate.dy
  ) {
    <span class="hljs-keyword">return</span> statusRotate;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (
    x &gt;= <span class="hljs-number">0</span> &amp;&amp;
    x &lt;= elementWidth &amp;&amp;
    y &gt;= <span class="hljs-number">0</span> &amp;&amp;
    y &lt;= elementHeight
  ) {
    <span class="hljs-keyword">return</span> statusMove;
  }

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
}

<span class="hljs-comment">/// <span class="markdown">è®¡ç®—æ—‹è½¬åçš„ç‚¹åæ ‡</span></span>
Offset rotatePoint(<span class="hljs-built_in">double</span> x, <span class="hljs-built_in">double</span> y) {
  <span class="hljs-keyword">final</span> deg = rotateNumber * pi / <span class="hljs-number">180</span>;
  <span class="hljs-comment">// ç¡®å®šæ—‹è½¬ä¸­å¿ƒï¼Œå› ä¸ºè¿™é‡Œçš„æ‹–åŠ¨æ˜¯å•ä¸ªå…ƒç´ ï¼Œåæ ‡éƒ½æ˜¯ç›¸å¯¹äºå…ƒç´ è‡ªèº«å½¢æˆçš„åæ ‡ç³»ï¼Œæ‰€ä»¥åæ ‡ä¸­å¿ƒå§‹ç»ˆéƒ½æ˜¯å…ƒç´ çš„ä¸­å¿ƒ</span>
  <span class="hljs-keyword">final</span> centerX = elementWidth / <span class="hljs-number">2</span>;
  <span class="hljs-keyword">final</span> centerY = elementHeight / <span class="hljs-number">2</span>;
  <span class="hljs-keyword">final</span> diffX = x - centerX;
  <span class="hljs-keyword">final</span> diffY = y - centerY;

  <span class="hljs-keyword">final</span> dx = diffX * cos(deg) - diffY * sin(deg) + centerX;
  <span class="hljs-keyword">final</span> dy = diffX * sin(deg) + diffY * cos(deg) + centerY;
  <span class="hljs-keyword">return</span> Offset(dx, dy);
}
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b59ed4533e84821be87591a42eeea3a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCN5a2X6KKr5L2g5Lus5oOz5a6M5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766246212&amp;x-signature=i21eGbd5IO%2FmIQANMwdJHTI%2FZ%2FQ%3D" alt="image02.gif" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°çš„æ˜¯æ—‹è½¬å’Œç¼©æ”¾çƒ­åŒºå³ä½¿åœ¨æ—‹è½¬åä¾ç„¶èƒ½å¤Ÿæ­£å¸¸å“åº”ï¼Œè¿˜æœ‰æœ€åä¸€ç‚¹ï¼Œå°±æ˜¯ç§»åŠ¨çš„æ—¶å€™ä¹Ÿè¦åº”ç”¨æ—‹è½¬è§’åº¦è®¡ç®—ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯å…ƒç´ è‡ªèº«ä¸ºåæ ‡ç³»ï¼Œåæ ‡ç³»æ—‹è½¬äº†ï¼Œè‡ªç„¶ç§»åŠ¨æ—¶çš„è®¡ç®—æ–¹å¼ä¹Ÿå¾—è·Ÿç€å˜ï¼Œå…¶å®å¯¹äºåæœŸå°†äº‹ä»¶åº”ç”¨åˆ°å®¹å™¨ä¸Šäº†è¿‡åå°±ä¸éœ€è¦è€ƒè™‘è¿™äº›äº†ï¼Œå› ä¸ºå¤–å±‚å®¹å™¨å¹¶ä¸ä¼šå˜æ¢ï¼Œæ‰€ä»¥åæœŸä¸ä½¿ç”¨é€†è¿ç®—ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œç›´æ¥ä½¿ç”¨globalPositionæ¥è®¡ç®—å€¼å³å¯ï¼ˆå˜æ¢è®¡ç®—åæ ‡æ„Ÿå…´è¶£çš„å¯ä»¥è‡ªè¡Œç ”ç©¶ä¸€ä¸‹ï¼‰ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">void</span> _onPanDown(DragDownDetails details) {
  <span class="hljs-built_in">print</span>(<span class="hljs-string">'æŒ‰ä¸‹: <span class="hljs-subst">$details</span>'</span>);

  <span class="hljs-built_in">String?</span> tempStatus = _onDownZone(details.localPosition.dx, details.localPosition.dy);

  <span class="hljs-built_in">print</span>(tempStatus);

  setState(() {
    <span class="hljs-keyword">if</span> (tempStatus == statusMove) {
      <span class="hljs-comment">// å¦‚æœæ˜¯ç§»åŠ¨ï¼Œåˆ™ä½¿ç”¨globalPosition</span>
      startPosition = details.globalPosition;
    } <span class="hljs-keyword">else</span> {
      startPosition = details.localPosition;
    }
    status = tempStatus;
  });
}

<span class="hljs-keyword">void</span> _onPanUpdate(DragUpdateDetails details) {
  <span class="hljs-built_in">print</span>(<span class="hljs-string">'æ›´æ–°: <span class="hljs-subst">$details</span>'</span>);
  <span class="hljs-keyword">if</span> (status == statusMove) {
    _onMove(details.globalPosition.dx, details.globalPosition.dy);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (status == statusScale) {
    _onScale(details.delta.dx, details.delta.dy);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (status == statusRotate) {
    _onRotate(details.localPosition.dx, details.localPosition.dy);
  }
}
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d620555910674a94a97e7b81158b86f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCN5a2X6KKr5L2g5Lus5oOz5a6M5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766246212&amp;x-signature=zfcnNOafIK2Jts067TP9ntYrUok%3D" alt="image03.gif" loading="lazy"/></p>
<p>è¿™æ ·å°±å¯¹å•ä¸ªå…ƒç´ å®ç°äº†å˜æ¢çš„æ•ˆæœï¼Œå‰ç½®å°±ç®—æ—¶é“ºå«å®Œæˆäº†ï¼Œåç»­å°±å¼€å§‹å®ç°å¤šä¸ªçš„ã€‚</p>
<p>æ„Ÿå…´è¶£çš„ä¹Ÿå¯ä»¥å…³æ³¨æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·ã€å‰ç«¯å­¦ä¹ å°è¥åœ°ã€‘ï¼Œä¸å®šæ—¶ä¼šåˆ†äº«ä¸€äº›å°åŠŸèƒ½ï½</p>
<p>ä»Šå¤©çš„åˆ†äº«åˆ°æ­¤ç»“æŸï¼Œæ„Ÿè°¢é˜…è¯»ï½æ‹œæ‹œï½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>