<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[ä» RAG åˆ° CAGï¼šAI æ­£åœ¨è¶…è¶Šâ€œæ£€ç´¢â€ï¼Œå­¦ä¼šâ€œèä¼šè´¯é€šâ€ï¼]]></title>    <link>https://juejin.cn/post/7570295366481330212</link>    <guid>https://juejin.cn/post/7570295366481330212</guid>    <pubDate>2025-11-10T08:12:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570295366481330212" data-draft-id="7570598043298152511" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä» RAG åˆ° CAGï¼šAI æ­£åœ¨è¶…è¶Šâ€œæ£€ç´¢â€ï¼Œå­¦ä¼šâ€œèä¼šè´¯é€šâ€ï¼"/> <meta itemprop="keywords" content="LLM,ç¨‹åºå‘˜,Agent"/> <meta itemprop="datePublished" content="2025-11-10T08:12:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§æ¨¡å‹æ•™ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/1145012233707299"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä» RAG åˆ° CAGï¼šAI æ­£åœ¨è¶…è¶Šâ€œæ£€ç´¢â€ï¼Œå­¦ä¼šâ€œèä¼šè´¯é€šâ€ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1145012233707299/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§æ¨¡å‹æ•™ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T08:12:03.000Z" title="Mon Nov 10 2025 08:12:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote>
<p>å¤§å‹è¯­è¨€æ¨¡å‹ (LLM) æ— ç–‘æ˜¯å½“ä»Šç§‘æŠ€é¢†åŸŸæœ€è€€çœ¼çš„æ˜æ˜Ÿã€‚å®ƒä»¬å¼ºå¤§çš„è‡ªç„¶è¯­è¨€å¤„ç†å’Œå†…å®¹ç”Ÿæˆèƒ½åŠ›ï¼Œæ­£åœ¨é‡å¡‘ä»æœç´¢åˆ°åˆ›æ„å·¥ä½œçš„å‡ ä¹æ‰€æœ‰è¡Œä¸šã€‚ç„¶è€Œï¼Œå¦‚åŒå¸Œè…Šç¥è¯ä¸­çš„é˜¿å–€ç‰æ–¯ï¼Œè¿™äº›å¼ºå¤§çš„æ¨¡å‹ä¹Ÿæœ‰å…¶â€œé˜¿å–€ç‰æ–¯ä¹‹è¸µâ€â€”â€”å®ƒä»¬å›ºæœ‰çš„ä¸¤å¤§ç¼ºé™·ï¼š</p>
<ul>
<li><strong>çŸ¥è¯†â€œå¹»è§‰â€ (Hallucination):</strong> Â å®ƒä»¬æœ‰æ—¶ä¼šè‡ªä¿¡åœ°ç¼–é€ å‡ºé”™è¯¯æˆ–ä¸å­˜åœ¨çš„ä¿¡æ¯ã€‚</li>
<li><strong>çŸ¥è¯†â€œé™ˆæ—§â€ (Outdatedness):</strong> Â å®ƒä»¬å¯¹ä¸–ç•Œçš„è®¤çŸ¥è¢«â€œå†»ç»“â€åœ¨è®­ç»ƒæ•°æ®æˆªæ­¢çš„é‚£ä¸€åˆ»ï¼Œæ— æ³•è·çŸ¥ä»»ä½•æ–°å‘ç”Ÿçš„äº‹ä»¶æˆ–ä¿¡æ¯ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4988cce23dc41e081648de1c5799a0e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367123&amp;x-signature=rgMCO29fhbRFRokQ7bTtL1C55lw%3D" alt="" loading="lazy"/></p>
<p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œ <strong>â€œå¢å¼ºç”Ÿæˆâ€ (Augmented Generation)</strong> Â æŠ€æœ¯åº”è¿è€Œç”Ÿã€‚åœ¨è¿™ä¸€é¢†åŸŸä¸­ï¼Œ<strong>RAG (Retrieval-Augmented Generation)</strong> Â å·²æˆä¸ºè¡Œä¸šæ ‡é…ï¼Œè€ŒÂ <strong>CAG (Context-Augmented Generation)</strong> Â åˆ™ä»£è¡¨äº†ä¸€ä¸ªæ›´æ·±å…¥ã€æ›´æ™ºèƒ½çš„æ¼”è¿›æ–¹å‘ã€‚</p>
<h2 data-id="heading-0">RAG (Retrieval-Augmented Generation)</h2>
<p>RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æ˜¯ç›®å‰è§£å†³ LLM ç¼ºé™·æœ€æœ‰æ•ˆå’Œæœ€ä¸»æµçš„æ¶æ„ã€‚å…¶æ ¸å¿ƒæ€æƒ³éå¸¸ç›´è§‚ï¼š<strong>ä¸å…¶å¼ºè¿«æ¨¡å‹â€œèƒŒè¯µâ€å…¨ä¸–ç•Œçš„çŸ¥è¯†ï¼Œä¸å¦‚è®©å®ƒå­¦ä¼šâ€œæŸ¥èµ„æ–™â€</strong> ã€‚</p>
<p>RAG å°±åƒæ˜¯ç»™äº† AI ä¸€å¥—æœ€æ–°çš„å‚è€ƒä¹¦ï¼ˆçŸ¥è¯†åº“ï¼‰ï¼Œå¹¶å…è®¸å®ƒåœ¨å›ç­”é—®é¢˜å‰è¿›è¡Œâ€œå¼€å·è€ƒè¯•â€ã€‚</p>
<p><strong>RAG çš„æ ‡å‡†å·¥ä½œæµç¨‹ï¼š</strong></p>
<ol>
<li><strong>æ¥æ”¶æŸ¥è¯¢ï¼š</strong> Â ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œä¾‹å¦‚â€œ2024å¹´è¯ºè´å°”ç‰©ç†å­¦å¥–å¾—ä¸»æ˜¯è°ï¼Ÿâ€</li>
<li><strong>æ£€ç´¢ (Retrieve):</strong> Â ç³»ç»Ÿé¦–å…ˆå°†æŸ¥è¯¢â€œç¼–ç â€æˆå‘é‡ï¼Œç„¶ååœ¨ä¸€ä¸ªåºå¤§çš„ã€å®æ—¶æ›´æ–°çš„â€œçŸ¥è¯†åº“â€ï¼ˆé€šå¸¸æ˜¯å‘é‡æ•°æ®åº“ï¼ŒåŒ…å«äº†æœ€æ–°æ–°é—»ã€æ–‡æ¡£ã€ç½‘é¡µç­‰ï¼‰ä¸­æœç´¢æœ€ç›¸å…³çš„ä¿¡æ¯ç‰‡æ®µã€‚</li>
<li><strong>å¢å¼º (Augment):</strong> Â ç³»ç»Ÿå°†æ£€ç´¢åˆ°çš„ç›¸å…³èµ„æ–™ï¼ˆä¾‹å¦‚ï¼Œå…³äºè¯ºå¥–å¾—ä¸»çš„æœ€æ–°æŠ¥é“ï¼‰ä¸ç”¨æˆ·çš„åŸå§‹é—®é¢˜â€œæ‹¼æ¥â€åœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªå†…å®¹ä¸°å¯Œçš„â€œå¢å¼ºæç¤ºè¯â€ã€‚</li>
<li><strong>ç”Ÿæˆ (Generate):</strong> Â LLM æœ€ç»ˆçœ‹åˆ°çš„ä¸æ˜¯ä¸€ä¸ªå®ƒæ— æ³•å›ç­”çš„â€œè¿‡æ—¶â€é—®é¢˜ï¼Œè€Œæ˜¯ä¸€ä¸ªåŒ…å«äº†ç­”æ¡ˆçš„é˜…è¯»ç†è§£é¢˜ã€‚å®ƒä¼šåŸºäºæ£€ç´¢åˆ°çš„â€œäº‹å®â€ææ–™ï¼Œç”Ÿæˆä¸€ä¸ªå‡†ç¡®ã€æ—¶æ•ˆæ€§å¼ºçš„ç­”æ¡ˆã€‚</li>
</ol>
<p><strong>RAG çš„æ ¸å¿ƒä»·å€¼åœ¨äºï¼š</strong></p>
<ul>
<li><strong>é«˜äº‹å®æ€§ï¼š</strong> Â å¤§å¹…å‡å°‘å¹»è§‰ï¼Œå› ä¸ºç­”æ¡ˆæ˜¯åŸºäºæ£€ç´¢åˆ°çš„å…·ä½“æ–‡æœ¬ç”Ÿæˆçš„ã€‚</li>
<li><strong>æ—¶æ•ˆæ€§ï¼š</strong> Â åªéœ€æ›´æ–°çŸ¥è¯†åº“ï¼ˆè¿™æ¯”é‡æ–°è®­ç»ƒæ¨¡å‹ä¾¿å®œå¾—å¤šï¼‰ï¼ŒAI å°±èƒ½â€œçŸ¥é“â€æœ€æ–°ä¿¡æ¯ã€‚</li>
<li><strong>å¯è§£é‡Šæ€§ï¼š</strong> Â å¯ä»¥å¼•ç”¨æ£€ç´¢åˆ°çš„æ¥æºï¼Œè®©ç­”æ¡ˆçš„â€œå‡ºå¤„â€é€æ˜å¯æŸ¥ã€‚</li>
</ul>
<h2 data-id="heading-1">CAG (Context-Augmented Generation)</h2>
<p>RAG æå…¶å¼ºå¤§ï¼Œä½†å®ƒåœ¨æœ¬è´¨ä¸Šä»æ˜¯ä¸€ç§â€œå³æ—¶ååº”å¼â€çš„æ£€ç´¢ã€‚å®ƒæ“…é•¿å›ç­”â€œæ˜¯ä»€ä¹ˆâ€ç±»å‹çš„äº‹å®é—®é¢˜ï¼Œä½†åœ¨å¤„ç†éœ€è¦æ·±åº¦ç†è§£ã€é•¿æœŸè®°å¿†æˆ–ä¸“ä¸šé¢†åŸŸä¸€è‡´æ€§çš„å¤æ‚å¯¹è¯æ—¶ï¼Œå°±æ˜¾å¾—åŠ›ä¸ä»å¿ƒã€‚</p>
<p>è¿™å°±æ˜¯Â <strong>CAGï¼ˆä¸Šä¸‹æ–‡å¢å¼ºç”Ÿæˆï¼‰</strong> Â ç™»åœºçš„å¥‘æœºã€‚CAG ä¸ä»…ä»…æ˜¯â€œæ£€ç´¢â€ï¼Œå®ƒè¿½æ±‚çš„æ˜¯â€œä¸Šä¸‹æ–‡çš„æ·±åº¦ç®¡ç†ä¸ç»´æŠ¤â€ã€‚å¦‚æœè¯´ RAG æ˜¯â€œäº‹å®æ£€ç´¢å™¨â€ï¼Œé‚£ä¹ˆ CAG çš„ç›®æ ‡æ˜¯æˆä¸ºâ€œé¢†åŸŸä¸“å®¶â€ã€‚</p>
<p><strong>CAG çš„æ ¸å¿ƒåŒºåˆ«åœ¨äºï¼š</strong></p>
<ol>
<li><strong>â€œé¢†åŸŸè®°å¿†â€ (Domain Memory)ï¼š</strong> Â è¿™æ˜¯ CAG çš„æ ¸å¿ƒã€‚å®ƒè¶…è¶Šäº† RAG çš„è¢«åŠ¨çŸ¥è¯†åº“ï¼Œæ˜¯ä¸€ä¸ª<strong>ä¸»åŠ¨çš„ã€æœ‰çŠ¶æ€çš„è®°å¿†ç³»ç»Ÿ</strong>ã€‚è¿™ä¸ªâ€œè®°å¿†â€ä¸­ä¸ä»…å­˜å‚¨ç€äº‹å®çŸ¥è¯†ï¼Œè¿˜åŒ…æ‹¬ï¼š</li>
</ol>
<ul>
<li><strong>é¢†åŸŸè§„åˆ™ï¼š</strong> Â ä¾‹å¦‚ï¼ŒåŒ»ç–— AI éœ€è¦éµå®ˆçš„è¯Šæ–­é€»è¾‘ï¼Œæˆ–é‡‘è AI å¿…é¡»éµå¾ªçš„åˆè§„æ¡æ¬¾ã€‚</li>
<li><strong>å¯¹è¯å†å²ï¼š</strong> Â è®°ä½ç”¨æˆ·åœ¨ä¸‰å¤©å‰è®¨è®ºè¿‡çš„è¯é¢˜ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸Šä¸€å¥è¯ã€‚</li>
<li><strong>ç”¨æˆ·åå¥½ï¼š</strong> Â çŸ¥é“ç”¨æˆ·çš„å…·ä½“éœ€æ±‚ã€é£æ ¼åå¥½æˆ–ä¸ªäººèƒŒæ™¯ã€‚</li>
</ul>
<ol start="2">
<li><strong>â€œä¸Šä¸‹æ–‡å¯¹é½â€ (Context Alignment)ï¼š</strong> Â CAG ä¸åªæ˜¯ç®€å•åœ°â€œæ‹¼æ¥â€ä¿¡æ¯ã€‚å®ƒåœ¨ç”Ÿæˆç­”æ¡ˆå‰ï¼Œä¼šè¿›è¡Œå¤æ‚çš„â€œå¯¹é½â€å·¥ä½œï¼Œç¡®ä¿å³å°†ç”Ÿæˆçš„å›å¤ï¼ŒåŒæ—¶ä¸<strong>å¤–éƒ¨çŸ¥è¯†ï¼ˆRAG åšçš„ï¼‰ã€é¢†åŸŸè®°å¿†ã€å¯¹è¯å†å²</strong>ä¿æŒé€»è¾‘ä¸€è‡´ã€‚</li>
<li><strong>â€œä¸€è‡´æ€§æ£€æŸ¥â€ (Consistency Check)ï¼š</strong> Â åœ¨ç”Ÿæˆç­”æ¡ˆåï¼ŒCAG ä¼šå¢åŠ ä¸€ä¸ªå…³é”®çš„éªŒè¯å±‚ã€‚å®ƒä¼šåå‘æ£€æŸ¥ç­”æ¡ˆæ˜¯å¦ä¸â€œé¢†åŸŸè®°å¿†â€ä¸­çš„æ ¸å¿ƒè§„åˆ™æˆ–é•¿æœŸç›®æ ‡ç›¸çŸ›ç›¾ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ³•å¾‹ AI åŠ©æ‰‹åœ¨ç»™å‡ºå»ºè®®æ—¶ï¼Œå¿…é¡»ç¡®ä¿å…¶å»ºè®®å§‹ç»ˆç¬¦åˆå®ƒâ€œè®°å¿†â€ä¸­çš„æ³•å¾‹æ¡†æ¶ã€‚</li>
</ol>
<h2 data-id="heading-2">RAG vs. CAG</h2>
<p>æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸¤ç§æ¶æ„è§†ä¸ºAIæ™ºèƒ½çš„ä¸¤ä¸ªä¸åŒè¿›åŒ–é˜¶æ®µï¼š</p>



































<table><thead><tr><th>ç‰¹æ€§</th><th><strong>RAG (æ£€ç´¢å¢å¼ºç”Ÿæˆ)</strong></th><th><strong>CAG (ä¸Šä¸‹æ–‡å¢å¼ºç”Ÿæˆ)</strong></th></tr></thead><tbody><tr><td><strong>æ ¸å¿ƒç„¦ç‚¹</strong></td><td><strong>äº‹å®æ£€ç´¢ (Fact Retrieval)</strong></td><td><strong>æƒ…å¢ƒç®¡ç† (Context Management)</strong></td></tr><tr><td><strong>å·¥ä½œæ¨¡å¼</strong></td><td>åå‘<strong>æ— çŠ¶æ€ (Stateless)</strong> ï¼ˆæ¯æ¬¡æŸ¥è¯¢éƒ½åƒä¸€æ¬¡æ–°çš„æ£€ç´¢ï¼‰</td><td>å¼ºè°ƒ<strong>æœ‰çŠ¶æ€ (Stateful)</strong> ï¼ˆç»´æŠ¤å’Œè°ƒç”¨æŒä¹…çš„è®°å¿†ï¼‰</td></tr><tr><td><strong>çŸ¥è¯†æº</strong></td><td>å¤–éƒ¨çŸ¥è¯†åº“ï¼ˆæ–‡æ¡£ã€ç½‘é¡µç­‰ï¼‰</td><td>å¤–éƒ¨çŸ¥è¯†åº“ +Â <strong>é¢†åŸŸè®°å¿†</strong> ï¼ˆè§„åˆ™ã€å†å²ã€åå¥½ï¼‰</td></tr><tr><td><strong>å…³é”®åŠ¨ä½œ</strong></td><td>æ£€ç´¢ (Retrieve)ã€æ’åº (Rank)ã€èåˆ (Fuse)</td><td>æ³¨å…¥ (Inject)ã€å¯¹é½ (Align)ã€ä¸€è‡´æ€§æ£€æŸ¥ (Consistency)</td></tr><tr><td><strong>ç›®æ ‡è§’è‰²</strong></td><td><strong>â€œå¼€å·è€ƒè¯•â€çš„è€ƒç”Ÿ</strong> ï¼ˆèƒ½å¿«é€ŸæŸ¥åˆ°æ­£ç¡®ç­”æ¡ˆï¼‰</td><td><strong>â€œèä¼šè´¯é€šâ€çš„ä¸“å®¶</strong> ï¼ˆèƒ½ç»“åˆè®°å¿†å’ŒçŸ¥è¯†ç»™å‡ºä¸€è´¯çš„è§è§£ï¼‰</td></tr></tbody></table>
<p>RAG è§£å†³äº† LLMâ€œä¸çŸ¥é“â€å’Œâ€œè¯´é”™è¯â€çš„é—®é¢˜ï¼Œè¿™æ˜¯ AI ä»â€œç©å…·â€èµ°å‘â€œå·¥å…·â€çš„å…³é”®ä¸€æ­¥ã€‚</p>
<p>è€ŒÂ <strong>CAG åˆ™ä»£è¡¨äº† AI ä»â€œå·¥å…·â€èµ°å‘â€œä¼™ä¼´â€å’Œâ€œä¸“å®¶â€çš„é›„å¿ƒ</strong>ã€‚å®ƒè¿½æ±‚çš„ä¸å†æ˜¯â€œå•ç‚¹æ­£ç¡®â€ï¼Œè€Œæ˜¯â€œå…¨å±€ä¸€è‡´â€å’Œâ€œæ·±åº¦ä¸ªæ€§åŒ–â€ã€‚</p>
<p>æˆ‘ä»¬å¿…é¡»æ˜ç™½ï¼Œ<strong>CAG å¹¶éè¦æ›¿ä»£ RAGï¼Œè€Œæ˜¯ RAG çš„å¿…ç„¶æ¼”è¿›å’Œæ‰©å±•</strong>ã€‚åœ¨å…ˆè¿›çš„ CAG æ¡†æ¶ä¸­ï¼ŒRAG å¾€å¾€ä¼šä½œä¸ºå…¶â€œä¸Šä¸‹æ–‡æ³¨å…¥â€çš„ä¸€ä¸ªå…³é”®ç»„ä»¶ï¼Œè´Ÿè´£ä»å¤–éƒ¨ä¸–ç•Œè·å–å®æ—¶äº‹å®ã€‚</p>
<p>æœªæ¥çš„é«˜çº§ AI åŠ©æ‰‹ï¼Œå¿…ç„¶æ˜¯ä¸€ä¸ª RAG å’Œ CAG çš„æ··åˆä½“ï¼šå®ƒæ—¢èƒ½åƒ RAG ä¸€æ ·åšè§ˆç¾¤ä¹¦ã€å¿«é€Ÿæ£€ç´¢ï¼Œä¹Ÿèƒ½åƒ CAG ä¸€æ ·æ‹¥æœ‰æ·±åˆ»çš„è®°å¿†å’Œä¸€è‡´çš„â€œäººæ ¼â€ï¼ŒçœŸæ­£åšåˆ°ä»â€œçŸ¥é“â€èµ°å‘â€œç†è§£â€ã€‚</p>
<h2 data-id="heading-3">å­¦ä¹ èµ„æºæ¨è</h2>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2025æœ€ç«çš„4ä¸ªå›½äº§AIéŸ³ä¹å·¥å…·å…¨é¢è¯„æµ‹ï¼Œæœ€åä¸¤ä¸ªå®Œå…¨å…è´¹ï¼ï¼ˆå»ºè®®æ”¶è—ï¼‰]]></title>    <link>https://juejin.cn/post/7570295366481313828</link>    <guid>https://juejin.cn/post/7570295366481313828</guid>    <pubDate>2025-11-10T08:11:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570295366481313828" data-draft-id="7570500819889487915" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2025æœ€ç«çš„4ä¸ªå›½äº§AIéŸ³ä¹å·¥å…·å…¨é¢è¯„æµ‹ï¼Œæœ€åä¸¤ä¸ªå®Œå…¨å…è´¹ï¼ï¼ˆå»ºè®®æ”¶è—ï¼‰"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2025-11-10T08:11:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜Xå°é¹¿"/> <meta itemprop="url" content="https://juejin.cn/user/2928754709505608"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2025æœ€ç«çš„4ä¸ªå›½äº§AIéŸ³ä¹å·¥å…·å…¨é¢è¯„æµ‹ï¼Œæœ€åä¸¤ä¸ªå®Œå…¨å…è´¹ï¼ï¼ˆå»ºè®®æ”¶è—ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2928754709505608/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜Xå°é¹¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T08:11:44.000Z" title="Mon Nov 10 2025 08:11:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯Xå°é¹¿ã€‚</p>
<p>å‰å‡ å¤©ï¼Œä¸€ä½è¯»è€…æ¥é—®ï¼Œ<strong>æœ‰å“ªäº› AI éŸ³ä¹å·¥å…·æ¨èï¼Œæœ€å¥½å›½å†…çš„</strong>ã€‚</p>
<p>æˆ‘æƒ³èµ·æ¥ä¹‹å‰æ­£å¥½æ•´ç†è¿‡ä¸€ç¯‡ AI éŸ³ä¹å·¥å…·æ±‡æ€»çš„æ–‡ç« ï¼Œå¯ä»¥ç›´æ¥å‘ç»™ä»–ã€‚</p>
<p>ä½†çœ‹äº†ä¸‹ï¼Œå‘ç°æœ‰äº›å·²ç»ä¸‹æ¶æ‰¾ä¸åˆ°å…¥å£äº†ï¼Œæ¯”å¦‚å³æ¢¦AIã€æµ·èºAIï¼Œè¿™äº›ä¹‹å‰éƒ½æ˜¯æœ‰ã€ŒAI éŸ³ä¹ã€åŠŸèƒ½çš„ï¼Œä½†ç°åœ¨å·²ç»éƒ½æ²¡æœ‰äº†ã€‚</p>
<p>è¶ç€å‘¨æœ«ï¼Œå†æ•´ç†ä¸‹ã€‚</p>
<p><strong>ä¸‹é¢åˆ†äº« 4 ä¸ªç›®å‰ç”¨çš„è¾ƒå¤šçš„å›½äº§</strong> <strong>AI</strong> <strong>éŸ³ä¹ç”Ÿæˆå·¥å…·ï¼Œæœ‰ç”µè„‘ç«¯çš„ï¼Œä¹Ÿæœ‰æ‰‹æœºç«¯çš„ï¼Œæœ€åä¸¤ä¸ªå®Œå…¨å…è´¹ï¼</strong></p>
<p>æœ‰éœ€è¦çš„å¯ä»¥ä¿å­˜ä¸‹ï¼Œæ—©æ™šç”¨çš„ä¸Šï½</p>
<h2 data-id="heading-0">ä¸€ã€Tunee</h2>
<p>è¿™ä¸ª AI å·¥å…·è¿˜æ˜¯ä¹‹å‰è¢«ç½‘å‹ç§è‰çš„ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/030f5750ddff443dad4aa913e2e51419~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=ZFiKQbBc23Eu2CnKHoaqPx3mC2s%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>Tuneeï¼Œå›½å†…é¦–ä¸ªå¯¹è¯å¼éŸ³ä¹åˆ›ä½œ Agentï¼Œç”±ã€Œå›½äº§ AI éŸ³ä¹ä¸‰å·¨å¤´ã€ä¹‹ä¸€çš„å¤©è°±ä¹å›¢é˜Ÿå­µåŒ–ã€‚</strong></p>
<p>ç®€å•æè¿°æƒ³ç”Ÿæˆä»€ä¹ˆéŸ³ä¹ï¼Œç„¶å Tunee å°±ä¼šä»¥å¯¹è¯çš„å½¢å¼ã€ä¸€æ­¥æ­¥å’Œæˆ‘ä»¬æ²Ÿé€šæ›´è¯¦ç»†çš„éœ€æ±‚ï¼Œæœ€ç»ˆåˆ›ä½œå‡ºæƒ³è¦çš„éŸ³ä¹ã€‚</p>
<p>Tunee è¿˜å¯ä»¥æ ¹æ®æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ï¼ˆéŸ³é¢‘ / è§†é¢‘ / å›¾ç‰‡ï¼‰æ¥åˆ›ä½œï¼Œä¹Ÿå¯ä»¥é€šè¿‡è”ç½‘è·å–æœ€æ–°çš„èµ„æ–™æ¥è¿›è¡Œéœ€æ±‚åˆ†æã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1101606b29e414c90ca341a21a613a4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=I7%2BIHIEB61RBS7x6z6qlQXNAaVU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8695003b81e44cc2ae18ea9687f65135~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=QK%2F62lH6IobxtCrhsDUJz1iNRMc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æœ€ç»ˆçš„åˆ›ä½œç»“æœä»¥ç”»å¸ƒå½¢å¼å±•ç¤ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9199ce8221d40819559a17348f1aefd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=v%2BaTZ3AGXjHY80I9QwfeTdJJskM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¸‹é¢è¿™é¦–éŸ³ä¹å°±æ˜¯ç”¨ Tunee ç”Ÿæˆçš„ï¼š</p>
<p>ï¼ˆéŸ³é¢‘ä¸æ–¹ä¾¿ä¸Šä¼ ï¼Œè¯•å¬è§<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F1x6gCYkWqc-XbWVjSIMPcw" target="_blank" title="https://mp.weixin.qq.com/s/1x6gCYkWqc-XbWVjSIMPcw" ref="nofollow noopener noreferrer">åŸæ–‡</a>ï¼‰</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e9e23e67fbb472ca04ea3217d60a042~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=ebRqsMT1CppjP9gvkQ7dmyBGSxc%3D" alt="æˆªå±2025-11-10 16.07.30.png" loading="lazy"/></p>
<p>Tunee è¿˜å¯ä»¥å¯¹ç”Ÿæˆå¥½çš„éŸ³ä¹ã€Œä¸€é”®åˆ¶ä½œ MVã€ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf96221cd3874f98bca93756013f5ac5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=pTzJU5xkvNgVhfNNSh57jZzsTk0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5fa3458be55e415ba365e35e0f291049~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=APh4Y6X%2Bn7aRT1ZnNgyd3iFP0UM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æœ€è¿‘çœ‹ Tunee åˆæ›´æ–°äº†ï¼Œæ¥å…¥äº† Sora 2 æ¨¡å‹ï¼ŒMV ç”Ÿæˆæ•ˆæœåº”è¯¥æ¯”ä¹‹å‰æ›´å¼ºäº†ã€‚æœ‰å…´è¶£çš„å¯ä»¥å°è¯•ä¸€ä¸‹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f636d96a6e744a98943211c571aa34a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=VfMOIYxAMsrEhk6ktkFTTskf2SQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é™¤äº†ç”ŸæˆéŸ³ä¹ã€åˆ¶ä½œ MVï¼ŒTunee è¿˜å¯ä»¥ç¼–è¾‘æ­Œè¯ã€åˆ†ç¦»éŸ³è½¨ï¼ˆæ‹†åˆ†ä¸ºäººå£°ã€é¼“ã€è´æ–¯ç­‰éŸ³è½¨ï¼Œä¾¿äºäºŒæ¬¡ç¼–è¾‘å’Œæ··éŸ³ï¼‰ã€æ™ºèƒ½æ¯å¸¦å¤„ç†ç­‰ã€‚</p>
<p>æ›´è¯¦ç»†çš„ä»‹ç»ï¼Œå¯ä»¥çœ‹ä¹‹å‰å†™çš„è¿™ç¯‡æ–‡ç« ï¼š</p>
<p><a href="https://juejin.cn/post/7554967090475532303" target="_blank" title="https://juejin.cn/post/7554967090475532303">å›½äº§AIåˆå‡ºç‹ç‚¸ï¼æ‹œæ‹œSunoï¼Œè¿™ä¸ªå›½å†…é¦–ä¸ªå¯¹è¯å¼éŸ³ä¹åˆ›ä½œAgentæ›´å¥½ç”¨ï¼ï¼ˆé™„å®æµ‹ä½“éªŒï¼‰</a></p>
<h2 data-id="heading-1">äºŒã€Mureka</h2>
<p>ä»Šå¹´ï¼ˆ2025ï¼‰ 3 æœˆï¼Œæ˜†ä»‘ä¸‡ç»´å‘å¸ƒäº†å…¶ AI éŸ³ä¹å¤§æ¨¡å‹â€”â€”Mureka O1 å’Œ Mureka V6ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0b903d24bea14cc79c4977c7f84fabce~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=eALwyZXyarkQLEMXSPmHYSAhuiM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Mureka O1ï¼Œæ˜¯å…¨çƒé¦–ä¸ªé‡‡ç”¨ CoT æŠ€æœ¯çš„éŸ³ä¹æ¨ç†å¤§æ¨¡å‹ã€‚åœ¨æ¨ç†è¿‡ç¨‹ä¸­ï¼ŒåŠ å…¥äº†æ€è€ƒä¸è‡ªæˆ‘æ‰¹åˆ¤ï¼Œä½¿å¾— Mureka åœ¨éŸ³ä¹åˆ›ä½œçš„å“è´¨ã€æ•ˆç‡å’Œçµæ´»æ€§ç­‰æ–¹é¢å¤§å¹…æå‡ã€‚</p>
<p><strong>åœ¨å½“æ—¶å®˜æ–¹å…¬å¸ƒçš„ä¸»å®¢è§‚æµ‹è¯„ä¸­ï¼ŒMureka O1 çš„å¤šé¡¹æŒ‡æ ‡å·²è¶…è¶Š Sunoï¼Œå®ç°å…¨çƒé¢†è·‘ã€‚</strong></p>
<p>éšååˆå‘å¸ƒäº† Mureka V7.5 æ¨¡å‹ï¼Œä¹Ÿæ˜¯ç›®å‰æ˜†ä»‘ä¸‡ç»´ä¸Šçº¿çš„æœ€æ–°çš„ AI éŸ³ä¹å¤§æ¨¡å‹ã€‚<strong>ä¸­æ–‡æ¼”å”±è¶…è¶Šæµ·å¤–åŒç±»æ¨¡å‹ï¼Œå¹¶ä¸”æ”¯æŒä¸­è‹±æ—¥éŸ©åœ¨å†…çš„ 10 ç§è¯­è¨€ã€‚</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6bcc7dce55034762951cc69fb2856d5d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=yL9rjOPQOsaTKoFej4MguWl47sc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Mureka çš„æ­Œæ›²åˆ›ä½œæœ‰ã€Œç®€å•æ¨¡å¼ã€å’Œã€Œé«˜çº§æ¨¡å¼ã€ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db87d61d9692487ea3e0323a8cab9c94~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=9IdCRG0eYvpJoZnnUq79JkIAb54%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa5ca6ec6d91459490851c0c0bb7e732~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=jugwa5nixxLC76S03e%2BR2vMa3ZE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>ç®€å•æ¨¡å¼</strong>ï¼šåªéœ€è¦è¾“å…¥ä¸»é¢˜æˆ–æƒ³æ³•ï¼ŒMureka å°±å¼€å§‹åˆ›ä½œäº†ã€‚</p>
<p><strong>é«˜çº§æ¨¡å¼ï¼š</strong> æ”¯æŒè‡ªå·±è¾“å…¥æ ‡é¢˜å’Œæ­Œè¯ï¼Œä¹Ÿå¯ä»¥è®© Mureka æ ¹æ®è¾“å…¥çš„æ ‡é¢˜æ¥ç”Ÿæˆæ­Œè¯ã€‚</p>
<p>è€Œä¸”è¿˜å¯ä»¥è®© Murekaï¼š</p>
<ul>
<li>å‚è€ƒä¸Šä¼ çš„æ­Œæ›²æ¥åˆ›ä½œç›¸ä¼¼çš„</li>
<li>ç”¨æŒ‡å®šéŸ³è‰²æ¥å”±</li>
<li>åŸºäºæ­Œæ›²æè¿°ï¼ˆæŒ‡å®šæ›²é£ã€æƒ…ç»ªã€äººå£°æ€§åˆ«ã€ä¹å™¨ç­‰ï¼‰æ¥åˆ›ä½œ</li>
<li>åŸºäºå“¼å”±æ—‹å¾‹æ¥åˆ›ä½œ</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3657ade891d343a8b2007b392ee2a0e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=yzLU%2B6KHqCBhZQNjq3YOh9T3HA8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¸è¿‡è¿™äº›é«˜çº§åŠŸèƒ½ï¼ŒåŸºæœ¬éƒ½éœ€è¦å¼€ä¼šå‘˜äº†ï¼ŒåŒ…æ‹¬ä¸‹é¢çš„ã€ŒéŸ³é¢‘ç¼–è¾‘ã€åŠŸèƒ½ä¹Ÿæ˜¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4cce494832014b39bd87a2da8563c749~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=1alrJODC5rzDquApy3n5EOBp9FM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Mureka çš„åŠŸèƒ½å¾ˆå¼ºå¤§ï¼Œé€‚åˆä¸“ä¸šé€‰æ‰‹ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€æµ·ç»µéŸ³ä¹</h2>
<p>æµ·ç»µéŸ³ä¹ï¼Œæ˜¯å­—èŠ‚è·³åŠ¨æ——ä¸‹çš„ä¸€æ¬¾ AI éŸ³ä¹åˆ›ä½œå¹³å°ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f5c8c77b49104bee9e44200254e8df59~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=L1QvUeYUzHk7aiyw76Mmh6fD5Ug%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>ã€Œçµæ„Ÿåˆ›ä½œã€æ¨¡å¼</strong>ï¼šç®€å•è¾“å…¥çµæ„Ÿå°±å¯ä»¥åˆ›ä½œï¼›</p>
<p><strong>ã€Œè‡ªå®šä¹‰å†™è¯ã€æ¨¡å¼</strong>ï¼šæ”¯æŒå¡«å…¥è‡ªå·±å†™å¥½çš„æ­Œè¯ï¼ˆå¯ä»¥ç”¨ AI æ¶¦è‰²ï¼‰ï¼Œå¯ä»¥é€‰æ‹©æ›²é£ã€å¿ƒæƒ…ã€éŸ³è‰²ã€äººå£°æ€§åˆ«ç­‰ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c42b80d2368f46089c6dc2abbc4c5baf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=po%2FVeWbe4F0vPrJshtTe4yci4a0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç”Ÿæˆå¥½çš„æ­Œæ›²ï¼Œæ”¯æŒã€Œæ”¹éŸ³è‰²ã€å’Œ ã€Œæ”¹æ­Œè¯ã€ã€‚</p>
<p><strong>æ”¹éŸ³è‰²</strong>ï¼šå½•åˆ¶ä¸€æ®µè‡ªå·±çš„å£°éŸ³åï¼Œå¯ä»¥ç”¨è‡ªå·±éŸ³è‰²æ¥å”±è¿™é¦–æ­Œã€‚</p>
<p><strong>æ”¹æ­Œè¯</strong>ï¼šèƒ½åœ¨ä¿æŒæ—‹å¾‹ä¸å˜çš„æƒ…å†µä¸‹ä¿®æ”¹æ­Œè¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92916dab634f4538b8c9d29e0cf0fd73~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=1B%2FEBpxOJJgMEDwn1KBC%2FOLLI7o%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¦å¤–åœ¨ã€Œå®éªŒå®¤ã€é‡Œï¼Œè¿˜æœ‰ã€Œ<strong>AI</strong> <strong>ä»¿å†™</strong>ã€çš„åŠŸèƒ½ï¼Œå¯ä»¥å‚è€ƒåŸæ›²é£ï¼Œç”Ÿæˆç›¸ä¼¼çš„æ­Œæ›²ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd692c98cf104e96a0abc096e5216d9c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=IurpzOx4uvs7XTJm08PDvElBaug%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä½†ç›®å‰åªæ”¯æŒä»å·²æœ‰çš„æ­Œæ›²é‡Œé€‰ï¼Œä¸æ”¯æŒè‡ªå·±ä¸Šä¼ æ­Œæ›²ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/420f12ab10744bedb1917af5f5ad3ada~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=%2FhQ79cevkOiF25S9GkCdsZ%2BYmyE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æµ·ç»µéŸ³ä¹ç›®å‰å®Œå…¨å…è´¹ï¼ŒåŒæ—¶æ”¯æŒç”µè„‘ç«¯å’Œæ‰‹æœºç«¯ï¼ˆAndroid / iOSï¼‰ï¼Œä¹Ÿæ”¯æŒå¯¹ç”Ÿæˆçš„éŸ³ä¹å†ç¼–è¾‘ã€‚</p>
<h2 data-id="heading-3">å››ã€è±†åŒ…</h2>
<p>ä¸Šé¢ 3 ä¸ªï¼Œéƒ½æ˜¯ä¸“é—¨çš„ AI éŸ³ä¹å·¥å…·ã€‚</p>
<p>é‚£å¯¹äºæ™®é€šäººï¼Œä¸éœ€è¦é‚£ä¹ˆä¸“ä¸šçš„ã€ç®€å•ä¸€ç‚¹çš„æœ‰æ²¡æœ‰ï¼Ÿå¯ä»¥ä½¿ç”¨è±†åŒ…ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/21ad97b010fb4584a2fdd4210e27edad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=Jo5aO%2BsSIRN%2FbQwlwrT3X7UzCBw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿›å…¥è±†åŒ…ï¼ˆè±†åŒ…æ‰‹æœºç«¯æˆ–ç”µè„‘ç«¯éƒ½å¯ä»¥ï¼‰ï¼Œæ‰¾åˆ°ã€ŒéŸ³ä¹ç”Ÿæˆã€ã€‚</p>
<p>åªéœ€è¦è¾“å…¥ä¸»é¢˜ï¼Œç„¶åä¾æ¬¡é€‰æ‹©é£æ ¼ã€æƒ…ç»ªã€éŸ³è‰²å°±å¯ä»¥äº†ï¼ˆè“è‰²å­—ä½“éƒ¨åˆ†ï¼‰ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2d95f588064b4f918bc50bbab689af7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGYWOWwj-m5vw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367103&amp;x-signature=Ur6ceoOwRINpL0FYTVUEhjzbiHk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è±†åŒ…çš„ AI éŸ³ä¹åŠŸèƒ½ã€Œå®Œå…¨å…è´¹ã€ï¼Œä½†é™¤äº†æ”¯æŒè‡ªå®šä¹‰æ­Œè¯å¤–ï¼Œå°±æ²¡æœ‰å…¶ä»–æ›´é«˜çº§çš„åŠŸèƒ½äº†ï¼Œä¸æ”¯æŒå¯¹ç”Ÿæˆçš„éŸ³ä¹å†æ¬¡ç¼–è¾‘ç­‰ï¼Œé€‚åˆæ™®é€šç©å®¶ã€‚</p>
<h2 data-id="heading-4">äº”ã€å†™åœ¨æœ€å</h2>
<p>æœ€åæ¥æ€»ç»“ä¸€ä¸‹å§ã€‚</p>
<p>Tuneeã€Murekaã€æµ·ç»µéŸ³ä¹ï¼Œæ˜¯ 3 æ¬¾ä¸“é—¨çš„ AI éŸ³ä¹å·¥å…·ã€‚</p>
<p>å…¶ä¸­ Tunee å’Œ Mureka ç›®å‰åŠŸèƒ½æ›´å¤šä¸€äº›ï¼Œå°¤å…¶æ˜¯ Murekaï¼Œæ›´é€‚åˆä¸“ä¸šç©å®¶ã€‚</p>
<p>Tunee å’Œ Mureka æ˜¯ä»˜è´¹å·¥å…·ï¼Œä½† Tunee æ¯å¤©éƒ½æœ‰ä¸€äº›å…è´¹é¢åº¦å¯ä»¥ä½“éªŒã€‚</p>
<p>æµ·ç»µéŸ³ä¹å’Œè±†åŒ…éƒ½æ˜¯å­—èŠ‚æ——ä¸‹çš„ï¼Œç›®å‰ã€Œå®Œå…¨å…è´¹ã€ï¼Œè€Œä¸”ç”µè„‘ç«¯ã€æ‰‹æœºç«¯éƒ½å¯ä»¥ä½¿ç”¨ã€‚</p>
<p>å¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„æƒ…å†µï¼Œé€‰æ‹©é€‚åˆçš„ AI éŸ³ä¹å·¥å…·ã€‚</p>
<h2 data-id="heading-5">å…­ã€é“¾æ¥</h2>
<p>æœ€åé™„ä¸Šè¿™äº› AI éŸ³ä¹å·¥å…·çš„é“¾æ¥ï¼š</p>
<p><strong>Tunee</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.tunee.ai%2Fzh-CN%2F" target="_blank" title="https://www.tunee.ai/zh-CN/" ref="nofollow noopener noreferrer">www.tunee.ai/zh-CN/</a></p>
<p><strong>Mureka</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.mureka.cn%2F" target="_blank" title="https://www.mureka.cn/" ref="nofollow noopener noreferrer">www.mureka.cn/</a></p>
<p><strong>æµ·ç»µéŸ³ä¹</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.haimian.com%2F" target="_blank" title="https://www.haimian.com/" ref="nofollow noopener noreferrer">www.haimian.com/</a></p>
<p><strong>è±†åŒ…</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.doubao.com%2F" target="_blank" title="https://www.doubao.com/" ref="nofollow noopener noreferrer">www.doubao.com/</a></p>
<hr/>
<blockquote>
<p>æˆ‘æ˜¯<a href="https://juejin.cn/user/2928754709505608/posts" title="https://juejin.cn/user/2928754709505608/posts" target="_blank">ç¨‹åºå‘˜Xå°é¹¿</a>ï¼Œå‰äº’è”ç½‘å¤§å‚ç¨‹åºå‘˜ï¼Œä¹Ÿæ˜¯ä¸€å AIGC çˆ±å¥½è€…ï¼ŒæŒç»­åˆ†äº«æ›´å¤šå¥½ç”¨çš„ AI å·¥å…·ï¼Œæ¬¢è¿ä¸€èµ·äº¤æµ~</p>
</blockquote>
<p><strong>æ¨èé˜…è¯»</strong></p>
<p><a href="https://juejin.cn/post/7454501732203610131" title="https://juejin.cn/post/7454501732203610131" target="_blank">2024å¹´ç»ˆAIå·¥å…·æ±‡æ€»ï¼š9å¤§AIé¢†åŸŸï¼Œ70+ç²¾é€‰AIå·¥å…·ï¼Œå…¨éƒ½åœ¨è¿™äº†ï¼(å»ºè®®æ”¶è—)</a></p>
<p>æ›´å¤š AI å·¥å…·è§<a href="https://juejin.cn/column/7284164153576947724" title="https://juejin.cn/column/7284164153576947724" target="_blank">ã€AIå·¥å…·ã€‘</a>ä¸“æ ï¼ŒæŒç»­æ›´æ–°ä¸­ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€OpenGLå­¦ä¹ æ»¤é•œç›¸æœºã€- Day8: å¤šé‡çº¹ç†ä¸æ··åˆ]]></title>    <link>https://juejin.cn/post/7570534000718495807</link>    <guid>https://juejin.cn/post/7570534000718495807</guid>    <pubDate>2025-11-10T08:19:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570534000718495807" data-draft-id="7570534000718479423" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€OpenGLå­¦ä¹ æ»¤é•œç›¸æœºã€- Day8: å¤šé‡çº¹ç†ä¸æ··åˆ"/> <meta itemprop="keywords" content="Android,OpenGL"/> <meta itemprop="datePublished" content="2025-11-10T08:19:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸‹ä½å­"/> <meta itemprop="url" content="https://juejin.cn/user/2313028193761389"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€OpenGLå­¦ä¹ æ»¤é•œç›¸æœºã€- Day8: å¤šé‡çº¹ç†ä¸æ··åˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2313028193761389/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸‹ä½å­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T08:19:05.000Z" title="Mon Nov 10 2025 08:19:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://juejin.cn/post/7567889397497528383" target="_blank" title="https://juejin.cn/post/7567889397497528383">å‰è¨€: ã€OpenGLå­¦ä¹ ã€ ä»é›¶æ‰“é€  Android æ»¤é•œç›¸æœº</a></p>
<p><a href="https://juejin.cn/post/7569871848793948179" target="_blank" title="https://juejin.cn/post/7569871848793948179">ä¸Šä¸€ç¯‡:ã€OpenGLå­¦ä¹ æ»¤é•œç›¸æœºã€- Day7: FBOï¼ˆå¸§ç¼“å†²å¯¹è±¡ï¼‰</a></p>
<p>Github: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxiaweizi%2FOpenGLTest" target="_blank" title="https://github.com/xiaweizi/OpenGLTest" ref="nofollow noopener noreferrer">OpenGLTest</a></p>
</blockquote>
<h2 data-id="heading-0">ğŸ“š ä»Šæ—¥ç›®æ ‡</h2>
<ul>
<li>ç†è§£å¤šçº¹ç†å•å…ƒçš„æ¦‚å¿µå’Œä½¿ç”¨</li>
<li>æŒæ¡çº¹ç†æ··åˆæ¨¡å¼ï¼ˆBlend Modesï¼‰</li>
<li>å­¦ä¹  Alpha é€šé“å¤„ç†å’Œé€æ˜åº¦</li>
<li>å®ç°å›¾ç‰‡æ°´å°ã€çº¹ç†å åŠ ç­‰å®ç”¨æ•ˆæœ</li>
</ul>
<p><strong>è¿è¡Œæ•ˆæœï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d0fe85223524f6d85e34d84847cfa31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiL5L2N5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367544&amp;x-signature=NEY23PHhtHVaLDDj%2FvZ28hR8j1M%3D" alt="Day8.gif" loading="lazy"/></p>
<h2 data-id="heading-1">ğŸ¯ å­¦ä¹ å†…å®¹</h2>
<h3 data-id="heading-2">1. å¤šçº¹ç†å•å…ƒç®€ä»‹</h3>
<p>åœ¨ OpenGL ES ä¸­ï¼Œ<strong>çº¹ç†å•å…ƒï¼ˆTexture Unitï¼‰</strong> å…è®¸æˆ‘ä»¬åœ¨ä¸€æ¬¡ç»˜åˆ¶è°ƒç”¨ä¸­ä½¿ç”¨å¤šä¸ªçº¹ç†ã€‚</p>
<h4 data-id="heading-3">ä»€ä¹ˆæ˜¯çº¹ç†å•å…ƒï¼Ÿ</h4>
<p>çº¹ç†å•å…ƒæ˜¯ OpenGL ä¸­çš„"çº¹ç†æ§½ä½"ï¼Œæ¯ä¸ªæ§½ä½å¯ä»¥ç»‘å®šä¸€ä¸ªçº¹ç†å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">GPU</span> <span class="hljs-string">çº¹ç†å•å…ƒ</span>
<span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">GL_TEXTURE0</span> <span class="hljs-string">â†’</span> <span class="hljs-string">çº¹ç†</span> <span class="hljs-attr">ID:</span> <span class="hljs-number">123</span><span class="hljs-string">ï¼ˆåº•å›¾ï¼‰</span>
<span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">GL_TEXTURE1</span> <span class="hljs-string">â†’</span> <span class="hljs-string">çº¹ç†</span> <span class="hljs-attr">ID:</span> <span class="hljs-number">456</span><span class="hljs-string">ï¼ˆæ°´å°ï¼‰</span>
<span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">GL_TEXTURE2</span> <span class="hljs-string">â†’</span> <span class="hljs-string">çº¹ç†</span> <span class="hljs-attr">ID:</span> <span class="hljs-number">789</span><span class="hljs-string">ï¼ˆé®ç½©ï¼‰</span>
<span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">...</span>
<span class="hljs-string">â””â”€â”€</span> <span class="hljs-string">GL_TEXTURE31ï¼ˆOpenGL</span> <span class="hljs-string">ES</span> <span class="hljs-string">è‡³å°‘æ”¯æŒ</span> <span class="hljs-number">8</span> <span class="hljs-string">ä¸ªï¼Œé€šå¸¸æ”¯æŒ</span> <span class="hljs-number">16</span><span class="hljs-number">-32</span> <span class="hljs-string">ä¸ªï¼‰</span>
</code></pre>
<h4 data-id="heading-4">ä¸ºä»€ä¹ˆéœ€è¦å¤šçº¹ç†ï¼Ÿ</h4>





























<table><thead><tr><th>åº”ç”¨åœºæ™¯</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æ°´å°æ•ˆæœ</strong></td><td>åº•å›¾ + æ°´å°å›¾</td></tr><tr><td><strong>é®ç½©æ•ˆæœ</strong></td><td>åŸå›¾ + é®ç½©å›¾</td></tr><tr><td><strong>å…‰ç…§è´´å›¾</strong></td><td>é¢œè‰²çº¹ç† + æ³•çº¿è´´å›¾ + å…‰ç…§è´´å›¾</td></tr><tr><td><strong>è§†é¢‘ç‰¹æ•ˆ</strong></td><td>è§†é¢‘å¸§ + æ»¤é•œçº¹ç†ï¼ˆLUTï¼‰</td></tr><tr><td><strong>ç²’å­æ•ˆæœ</strong></td><td>ç²’å­çº¹ç† + æ¸å˜çº¹ç†</td></tr></tbody></table>
<h3 data-id="heading-5">2. å¤šçº¹ç†çš„ä½¿ç”¨æµç¨‹</h3>
<h4 data-id="heading-6">2.1 æ¿€æ´»çº¹ç†å•å…ƒ</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æ¿€æ´»çº¹ç†å•å…ƒ 0</span>
GLES20.glActiveTexture(GLES20.GL_TEXTURE0)
<span class="hljs-comment">// ç»‘å®šç¬¬ä¸€ä¸ªçº¹ç†</span>
GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, texture1)

<span class="hljs-comment">// æ¿€æ´»çº¹ç†å•å…ƒ 1</span>
GLES20.glActiveTexture(GLES20.GL_TEXTURE1)
<span class="hljs-comment">// ç»‘å®šç¬¬äºŒä¸ªçº¹ç†</span>
GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, texture2)
</code></pre>
<h4 data-id="heading-7">2.2 ä¼ é€’ç»™ç€è‰²å™¨</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å°†çº¹ç†å•å…ƒç´¢å¼•ä¼ é€’ç»™ç€è‰²å™¨çš„ sampler2D</span>
GLES20.glUniform1i(texture1Location, <span class="hljs-number">0</span>)  <span class="hljs-comment">// ä½¿ç”¨ GL_TEXTURE0</span>
GLES20.glUniform1i(texture2Location, <span class="hljs-number">1</span>)  <span class="hljs-comment">// ä½¿ç”¨ GL_TEXTURE1</span>
</code></pre>
<h4 data-id="heading-8">2.3 ç€è‰²å™¨ä¸­é‡‡æ ·</h4>
<pre><code class="hljs language-glsl" lang="glsl">precision mediump float;

uniform sampler2D uTexture1;  // åº•å›¾
uniform sampler2D uTexture2;  // æ°´å°

varying vec2 vTexCoord;

void main() {
    vec4 color1 = texture2D(uTexture1, vTexCoord);  // é‡‡æ ·åº•å›¾
    vec4 color2 = texture2D(uTexture2, vTexCoord);  // é‡‡æ ·æ°´å°
    
    // æ··åˆä¸¤ä¸ªçº¹ç†
    gl_FragColor = mix(color1, color2, color2.a);
}
</code></pre>
<h3 data-id="heading-9">3. çº¹ç†æ··åˆæ¨¡å¼</h3>
<h4 data-id="heading-10">3.1 å¸¸è§æ··åˆç®—æ³•</h4>








































<table><thead><tr><th>æ··åˆæ¨¡å¼</th><th>å…¬å¼</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td><strong>æ­£å¸¸ï¼ˆNormalï¼‰</strong></td><td><code>color2</code></td><td>å®Œå…¨è¦†ç›–</td></tr><tr><td><strong>Alpha æ··åˆ</strong></td><td><code>mix(color1, color2, alpha)</code></td><td>é€æ˜å åŠ </td></tr><tr><td><strong>ç›¸åŠ ï¼ˆAddï¼‰</strong></td><td><code>color1 + color2</code></td><td>å¢äº®æ•ˆæœ</td></tr><tr><td><strong>ç›¸ä¹˜ï¼ˆMultiplyï¼‰</strong></td><td><code>color1 * color2</code></td><td>å˜æš—æ•ˆæœ</td></tr><tr><td><strong>å±å¹•ï¼ˆScreenï¼‰</strong></td><td><code>1.0 - (1.0 - color1) * (1.0 - color2)</code></td><td>æŸ”å…‰å¢äº®</td></tr><tr><td><strong>å åŠ ï¼ˆOverlayï¼‰</strong></td><td>æ ¹æ®äº®åº¦æ··åˆç›¸ä¹˜å’Œå±å¹•æ¨¡å¼</td><td>ä¿ç•™é«˜å…‰å’Œé˜´å½±</td></tr></tbody></table>
<h4 data-id="heading-11">3.2 ç€è‰²å™¨å®ç°</h4>
<pre><code class="hljs language-glsl" lang="glsl">precision mediump float;

uniform sampler2D uTexture1;  // åº•å›¾
uniform sampler2D uTexture2;  // å åŠ å›¾
uniform int uBlendMode;       // æ··åˆæ¨¡å¼ï¼ˆ0-5ï¼‰
uniform float uAlpha;         // é€æ˜åº¦ï¼ˆ0.0 - 1.0ï¼‰

varying vec2 vTexCoord;

// æ­£å¸¸æ··åˆ
vec3 blendNormal(vec3 base, vec3 blend) {
    return blend;
}

// ç›¸åŠ æ··åˆ
vec3 blendAdd(vec3 base, vec3 blend) {
    return min(base + blend, vec3(1.0));
}

// ç›¸ä¹˜æ··åˆ
vec3 blendMultiply(vec3 base, vec3 blend) {
    return base * blend;
}

// å±å¹•æ··åˆ
vec3 blendScreen(vec3 base, vec3 blend) {
    return 1.0 - (1.0 - base) * (1.0 - blend);
}

// å åŠ æ··åˆ
vec3 blendOverlay(vec3 base, vec3 blend) {
    vec3 result;
    result.r = base.r &lt; 0.5 ? (2.0 * base.r * blend.r) : (1.0 - 2.0 * (1.0 - base.r) * (1.0 - blend.r));
    result.g = base.g &lt; 0.5 ? (2.0 * base.g * blend.g) : (1.0 - 2.0 * (1.0 - base.g) * (1.0 - blend.g));
    result.b = base.b &lt; 0.5 ? (2.0 * base.b * blend.b) : (1.0 - 2.0 * (1.0 - base.b) * (1.0 - blend.b));
    return result;
}

// æŸ”å…‰æ··åˆ
vec3 blendSoftLight(vec3 base, vec3 blend) {
    vec3 result;
    result.r = blend.r &lt; 0.5 ? (2.0 * base.r * blend.r + base.r * base.r * (1.0 - 2.0 * blend.r)) 
                              : (sqrt(base.r) * (2.0 * blend.r - 1.0) + 2.0 * base.r * (1.0 - blend.r));
    result.g = blend.g &lt; 0.5 ? (2.0 * base.g * blend.g + base.g * base.g * (1.0 - 2.0 * blend.g)) 
                              : (sqrt(base.g) * (2.0 * blend.g - 1.0) + 2.0 * base.g * (1.0 - blend.g));
    result.b = blend.b &lt; 0.5 ? (2.0 * base.b * blend.b + base.b * base.b * (1.0 - 2.0 * blend.b)) 
                              : (sqrt(base.b) * (2.0 * blend.b - 1.0) + 2.0 * base.b * (1.0 - blend.b));
    return result;
}

void main() {
    vec4 base = texture2D(uTexture1, vTexCoord);
    vec4 blend = texture2D(uTexture2, vTexCoord);
    
    vec3 result;
    
    if (uBlendMode == 0) {
        // æ­£å¸¸æ··åˆï¼ˆAlpha æ··åˆï¼‰
        result = mix(base.rgb, blend.rgb, blend.a * uAlpha);
    } else if (uBlendMode == 1) {
        // ç›¸åŠ 
        result = blendAdd(base.rgb, blend.rgb * uAlpha);
    } else if (uBlendMode == 2) {
        // ç›¸ä¹˜
        result = mix(base.rgb, blendMultiply(base.rgb, blend.rgb), uAlpha);
    } else if (uBlendMode == 3) {
        // å±å¹•
        result = mix(base.rgb, blendScreen(base.rgb, blend.rgb), uAlpha);
    } else if (uBlendMode == 4) {
        // å åŠ 
        result = mix(base.rgb, blendOverlay(base.rgb, blend.rgb), uAlpha);
    } else if (uBlendMode == 5) {
        // æŸ”å…‰
        result = mix(base.rgb, blendSoftLight(base.rgb, blend.rgb), uAlpha);
    } else {
        result = base.rgb;
    }
    
    gl_FragColor = vec4(result, 1.0);
}
</code></pre>
<h3 data-id="heading-12">4. Alpha é€šé“å¤„ç†</h3>
<h4 data-id="heading-13">4.1 ä»€ä¹ˆæ˜¯ Alpha é€šé“ï¼Ÿ</h4>
<p><strong>Alpha é€šé“</strong>è¡¨ç¤ºåƒç´ çš„ä¸é€æ˜åº¦ï¼š</p>
<ul>
<li><code>alpha = 0.0</code>ï¼šå®Œå…¨é€æ˜</li>
<li><code>alpha = 0.5</code>ï¼šåŠé€æ˜</li>
<li><code>alpha = 1.0</code>ï¼šå®Œå…¨ä¸é€æ˜</li>
</ul>
<h4 data-id="heading-14">4.2 å¯ç”¨ Alpha æ··åˆ</h4>
<p>OpenGL æä¾›äº†ç¡¬ä»¶çº§åˆ«çš„ Alpha æ··åˆï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å¯ç”¨æ··åˆ</span>
GLES20.glEnable(GLES20.GL_BLEND)

<span class="hljs-comment">// è®¾ç½®æ··åˆå‡½æ•°</span>
GLES20.glBlendFunc(GLES20.GL_SRC_ALPHA, GLES20.GL_ONE_MINUS_SRC_ALPHA)
</code></pre>
<p><strong>æ··åˆå…¬å¼</strong>ï¼š</p>
<pre><code class="hljs language-css" lang="css">æœ€ç»ˆé¢œè‰² = æºé¢œè‰² Ã— æºå› å­ + ç›®æ ‡é¢œè‰² Ã— ç›®æ ‡å› å­
       = <span class="hljs-attribute">src</span><span class="hljs-selector-class">.rgb</span> Ã— <span class="hljs-attribute">src</span><span class="hljs-selector-class">.a</span> + dst<span class="hljs-selector-class">.rgb</span> Ã— (<span class="hljs-number">1.0</span> - <span class="hljs-attribute">src</span><span class="hljs-selector-class">.a</span>)
</code></pre>
<h4 data-id="heading-15">4.3 å¸¸è§æ··åˆå‡½æ•°</h4>






























<table><thead><tr><th>æºå› å­</th><th>ç›®æ ‡å› å­</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td><code>GL_SRC_ALPHA</code></td><td><code>GL_ONE_MINUS_SRC_ALPHA</code></td><td>æ ‡å‡† Alpha æ··åˆï¼ˆé€æ˜å åŠ ï¼‰</td></tr><tr><td><code>GL_ONE</code></td><td><code>GL_ONE</code></td><td>ç›¸åŠ æ··åˆï¼ˆå¢äº®ï¼‰</td></tr><tr><td><code>GL_DST_COLOR</code></td><td><code>GL_ZERO</code></td><td>ç›¸ä¹˜æ··åˆï¼ˆå˜æš—ï¼‰</td></tr><tr><td><code>GL_ONE</code></td><td><code>GL_ONE_MINUS_SRC_ALPHA</code></td><td>é¢„ä¹˜ Alpha æ··åˆ</td></tr></tbody></table>
<h3 data-id="heading-16">5. å®ç”¨æ•ˆæœå®ç°</h3>
<h4 data-id="heading-17">5.1 æ°´å°æ•ˆæœ</h4>
<pre><code class="hljs language-glsl" lang="glsl">// æ°´å°ç€è‰²å™¨
precision mediump float;

uniform sampler2D uTexture;    // åº•å›¾
uniform sampler2D uWatermark;  // æ°´å°
uniform vec2 uWatermarkPos;    // æ°´å°ä½ç½®ï¼ˆ0.0 - 1.0ï¼‰
uniform vec2 uWatermarkSize;   // æ°´å°å¤§å°ï¼ˆ0.0 - 1.0ï¼‰
uniform float uWatermarkAlpha; // æ°´å°é€æ˜åº¦

varying vec2 vTexCoord;

void main() {
    vec4 baseColor = texture2D(uTexture, vTexCoord);
    
    // è®¡ç®—æ°´å°åŒºåŸŸ
    vec2 watermarkCoord = (vTexCoord - uWatermarkPos) / uWatermarkSize;
    
    // åˆ¤æ–­æ˜¯å¦åœ¨æ°´å°åŒºåŸŸ
    if (watermarkCoord.x &gt;= 0.0 &amp;&amp; watermarkCoord.x &lt;= 1.0 &amp;&amp;
        watermarkCoord.y &gt;= 0.0 &amp;&amp; watermarkCoord.y &lt;= 1.0) {
        
        vec4 watermarkColor = texture2D(uWatermark, watermarkCoord);
        
        // Alpha æ··åˆæ°´å°
        gl_FragColor = mix(baseColor, watermarkColor, watermarkColor.a * uWatermarkAlpha);
    } else {
        gl_FragColor = baseColor;
    }
}
</code></pre>
<h4 data-id="heading-18">5.2 åŒé‡æ›å…‰æ•ˆæœ</h4>
<pre><code class="hljs language-glsl" lang="glsl">precision mediump float;

uniform sampler2D uTexture1;
uniform sampler2D uTexture2;
uniform float uMixRatio;  // æ··åˆæ¯”ä¾‹

varying vec2 vTexCoord;

void main() {
    vec4 color1 = texture2D(uTexture1, vTexCoord);
    vec4 color2 = texture2D(uTexture2, vTexCoord);
    
    // å±å¹•æ··åˆæ¨¡å¼ï¼ˆåŒé‡æ›å…‰å¸¸ç”¨ï¼‰
    vec3 result = 1.0 - (1.0 - color1.rgb) * (1.0 - color2.rgb * uMixRatio);
    
    gl_FragColor = vec4(result, 1.0);
}
</code></pre>
<h4 data-id="heading-19">5.3 é®ç½©æ•ˆæœ</h4>
<pre><code class="hljs language-glsl" lang="glsl">precision mediump float;

uniform sampler2D uTexture;  // åŸå›¾
uniform sampler2D uMask;     // é®ç½©ï¼ˆé»‘ç™½å›¾ï¼‰

varying vec2 vTexCoord;

void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec4 mask = texture2D(uMask, vTexCoord);
    
    // ä½¿ç”¨é®ç½©çš„äº®åº¦ä½œä¸º Alpha
    float maskAlpha = dot(mask.rgb, vec3(0.299, 0.587, 0.114));
    
    gl_FragColor = vec4(color.rgb, color.a * maskAlpha);
}
</code></pre>
<h3 data-id="heading-20">6. æ€§èƒ½ä¼˜åŒ–</h3>
<h4 data-id="heading-21">6.1 çº¹ç†å•å…ƒç®¡ç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TextureManager</span> {
    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> TEXTURE_UNIT_BASE = <span class="hljs-number">0</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> TEXTURE_UNIT_BLEND = <span class="hljs-number">1</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> TEXTURE_UNIT_WATERMARK = <span class="hljs-number">2</span>
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">bindTextures</span><span class="hljs-params">(baseTexture: <span class="hljs-type">Int</span>, blendTexture: <span class="hljs-type">Int</span>, watermarkTexture: <span class="hljs-type">Int</span>)</span></span> {
        <span class="hljs-comment">// åº•å›¾</span>
        GLES20.glActiveTexture(GLES20.GL_TEXTURE0 + TEXTURE_UNIT_BASE)
        GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, baseTexture)
        
        <span class="hljs-comment">// æ··åˆå›¾</span>
        GLES20.glActiveTexture(GLES20.GL_TEXTURE0 + TEXTURE_UNIT_BLEND)
        GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, blendTexture)
        
        <span class="hljs-comment">// æ°´å°</span>
        GLES20.glActiveTexture(GLES20.GL_TEXTURE0 + TEXTURE_UNIT_WATERMARK)
        GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, watermarkTexture)
    }
}
</code></pre>
<h4 data-id="heading-22">6.2 å‡å°‘çº¹ç†åˆ‡æ¢</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âŒ ä¸å¥½çš„åšæ³•ï¼šé¢‘ç¹åˆ‡æ¢çº¹ç†å•å…ƒ</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">renderObjects</span><span class="hljs-params">(objects: <span class="hljs-type">List</span>&lt;<span class="hljs-type">RenderObject</span>&gt;)</span></span> {
    objects.forEach { obj -&gt;
        GLES20.glActiveTexture(GLES20.GL_TEXTURE0)
        GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, obj.texture)
        obj.draw()
    }
}

<span class="hljs-comment">// âœ… å¥½çš„åšæ³•ï¼šæ‰¹é‡æ¸²æŸ“ç›¸åŒçº¹ç†çš„å¯¹è±¡</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">renderObjectsBatched</span><span class="hljs-params">(objects: <span class="hljs-type">List</span>&lt;<span class="hljs-type">RenderObject</span>&gt;)</span></span> {
    <span class="hljs-keyword">val</span> grouped = objects.groupBy { it.texture }
    grouped.forEach { (texture, objs) -&gt;
        GLES20.glActiveTexture(GLES20.GL_TEXTURE0)
        GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, texture)
        objs.forEach { it.draw() }
    }
}
</code></pre>
<h4 data-id="heading-23">6.3 çº¹ç†å‹ç¼©</h4>
<p>å¯¹äºæ°´å°ç­‰è¾…åŠ©çº¹ç†ï¼Œå¯ä»¥ä½¿ç”¨è¾ƒä½åˆ†è¾¨ç‡æˆ–å‹ç¼©æ ¼å¼ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// è°ƒæ•´æ°´å°å°ºå¯¸</span>
<span class="hljs-keyword">val</span> watermarkSize = <span class="hljs-number">256</span>  <span class="hljs-comment">// ä¸éœ€è¦å¾ˆé«˜åˆ†è¾¨ç‡</span>
<span class="hljs-keyword">val</span> scaledWatermark = Bitmap.createScaledBitmap(
    originalWatermark, 
    watermarkSize, 
    watermarkSize, 
    <span class="hljs-literal">true</span>
)
</code></pre>
<h3 data-id="heading-24">7. å¤šçº¹ç†çš„é™åˆ¶</h3>
<h4 data-id="heading-25">7.1 æŸ¥è¯¢çº¹ç†å•å…ƒæ•°é‡</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> maxTextureUnits = IntArray(<span class="hljs-number">1</span>)
GLES20.glGetIntegerv(GLES20.GL_MAX_TEXTURE_IMAGE_UNITS, maxTextureUnits, <span class="hljs-number">0</span>)
Log.d(TAG, <span class="hljs-string">"è®¾å¤‡æ”¯æŒçš„æœ€å¤§çº¹ç†å•å…ƒæ•°: <span class="hljs-subst">${maxTextureUnits[<span class="hljs-number">0</span>]}</span>"</span>)
</code></pre>
<p>OpenGL ES 2.0 è§„èŒƒè¦æ±‚è‡³å°‘æ”¯æŒ 8 ä¸ªçº¹ç†å•å…ƒï¼Œå¤§å¤šæ•°è®¾å¤‡æ”¯æŒ 16-32 ä¸ªã€‚</p>
<h4 data-id="heading-26">7.2 çº¹ç†å†…å­˜ç®¡ç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ç›‘æ§çº¹ç†å†…å­˜ä½¿ç”¨</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">estimateTextureMemory</span><span class="hljs-params">(width: <span class="hljs-type">Int</span>, height: <span class="hljs-type">Int</span>, format: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span> {
    <span class="hljs-keyword">val</span> bytesPerPixel = <span class="hljs-keyword">when</span> (format) {
        GLES20.GL_RGBA -&gt; <span class="hljs-number">4</span>
        GLES20.GL_RGB -&gt; <span class="hljs-number">3</span>
        GLES20.GL_LUMINANCE_ALPHA -&gt; <span class="hljs-number">2</span>
        GLES20.GL_LUMINANCE -&gt; <span class="hljs-number">1</span>
        <span class="hljs-keyword">else</span> -&gt; <span class="hljs-number">4</span>
    }
    <span class="hljs-keyword">return</span> width * height * bytesPerPixel
}

<span class="hljs-comment">// ç¤ºä¾‹ï¼š1920x1080 RGBA çº¹ç† = 8.3 MB</span>
<span class="hljs-keyword">val</span> memory = estimateTextureMemory(<span class="hljs-number">1920</span>, <span class="hljs-number">1080</span>, GLES20.GL_RGBA)
Log.d(TAG, <span class="hljs-string">"çº¹ç†å†…å­˜å ç”¨: <span class="hljs-subst">${memory / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>}</span> MB"</span>)
</code></pre>
<h2 data-id="heading-27">ğŸ’» ä»£ç å®è·µ</h2>
<h3 data-id="heading-28">ä»Šæ—¥ä»»åŠ¡</h3>
<p>å®ç°ä¸€ä¸ªå¤šçº¹ç†æ··åˆåº”ç”¨ï¼š</p>
<ol>
<li><strong>åŠ è½½ä¸¤å¼ å›¾ç‰‡</strong></li>
<li><strong>å®ç°å¤šç§æ··åˆæ¨¡å¼</strong>ï¼š
<ul>
<li>Alpha æ··åˆ</li>
<li>ç›¸åŠ </li>
<li>ç›¸ä¹˜</li>
<li>å±å¹•</li>
<li>å åŠ </li>
<li>æŸ”å…‰</li>
</ul>
</li>
<li><strong>æ·»åŠ æ°´å°åŠŸèƒ½</strong></li>
<li><strong>æä¾›é€æ˜åº¦è°ƒèŠ‚</strong></li>
</ol>
<h3 data-id="heading-29">å®ç°æ•ˆæœ</h3>
<ul>
<li>ğŸ–¼ï¸ åŒæ—¶åŠ è½½ä¸¤å¼ çº¹ç†</li>
<li>ğŸ¨ 6 ç§æ··åˆæ¨¡å¼å®æ—¶åˆ‡æ¢</li>
<li>ğŸ’§ é€æ˜åº¦ SeekBar è°ƒèŠ‚</li>
<li>ğŸ·ï¸ æ°´å°ä½ç½®å’Œé€æ˜åº¦æ§åˆ¶</li>
</ul>
<h3 data-id="heading-30">æ ¸å¿ƒä»£ç ç»“æ„</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Day08Renderer</span>(context: Context) : GLSurfaceView.Renderer {

    <span class="hljs-comment">// å¤šçº¹ç† ID</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> texture1: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>  <span class="hljs-comment">// åº•å›¾</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> texture2: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>  <span class="hljs-comment">// å åŠ å›¾</span>

    <span class="hljs-comment">// æ··åˆæ¨¡å¼</span>
    <span class="hljs-keyword">enum</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BlendMode</span> {
        ALPHA,      <span class="hljs-comment">// Alpha æ··åˆ</span>
        ADD,        <span class="hljs-comment">// ç›¸åŠ </span>
        MULTIPLY,   <span class="hljs-comment">// ç›¸ä¹˜</span>
        SCREEN,     <span class="hljs-comment">// å±å¹•</span>
        OVERLAY,    <span class="hljs-comment">// å åŠ </span>
        SOFT_LIGHT  <span class="hljs-comment">// æŸ”å…‰</span>
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> currentBlendMode = BlendMode.ALPHA
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> blendAlpha = <span class="hljs-number">0.5f</span>

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDrawFrame</span><span class="hljs-params">(gl: <span class="hljs-type">GL10</span>?)</span></span> {
        <span class="hljs-comment">// æ¿€æ´»çº¹ç†å•å…ƒ 0</span>
        GLES20.glActiveTexture(GLES20.GL_TEXTURE0)
        GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, texture1)
        GLES20.glUniform1i(texture1Location, <span class="hljs-number">0</span>)

        <span class="hljs-comment">// æ¿€æ´»çº¹ç†å•å…ƒ 1</span>
        GLES20.glActiveTexture(GLES20.GL_TEXTURE1)
        GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, texture2)
        GLES20.glUniform1i(texture2Location, <span class="hljs-number">1</span>)

        <span class="hljs-comment">// è®¾ç½®æ··åˆæ¨¡å¼</span>
        GLES20.glUniform1i(blendModeLocation, currentBlendMode.ordinal)
        GLES20.glUniform1f(alphaLocation, blendAlpha)

        <span class="hljs-comment">// ç»˜åˆ¶</span>
        drawQuad()
    }
}
</code></pre>
<h2 data-id="heading-31">ğŸ§ª ç»ƒä¹ ä»»åŠ¡</h2>
<h3 data-id="heading-32">åŸºç¡€ä»»åŠ¡</h3>
<ol>
<li>âœ… å®ç°ä¸¤ä¸ªçº¹ç†çš„åŠ è½½å’Œç»‘å®š</li>
<li>âœ… å®ç°è‡³å°‘ 3 ç§æ··åˆæ¨¡å¼</li>
<li>âœ… æ·»åŠ é€æ˜åº¦è°ƒèŠ‚åŠŸèƒ½</li>
</ol>
<h3 data-id="heading-33">è¿›é˜¶ä»»åŠ¡</h3>
<ol>
<li>ğŸ¨ å®ç°æ°´å°åŠŸèƒ½ï¼ˆå¯è°ƒèŠ‚ä½ç½®å’Œå¤§å°ï¼‰</li>
<li>ğŸ–¼ï¸ å®ç°é®ç½©æ•ˆæœ</li>
<li>ğŸŒˆ å®ç°åŒé‡æ›å…‰æ•ˆæœ</li>
<li>ğŸ“¸ æ·»åŠ é¢„è®¾æ··åˆæ•ˆæœï¼ˆå¤å¤ã€ç”µå½±ã€æ¢¦å¹»ç­‰ï¼‰</li>
</ol>
<h3 data-id="heading-34">æŒ‘æˆ˜ä»»åŠ¡</h3>
<ol>
<li>ğŸš€ å®ç°ä¸‰ä¸ªçº¹ç†çš„æ··åˆï¼ˆåº•å›¾ + å åŠ å›¾ + æ°´å°ï¼‰</li>
<li>ğŸ­ å®ç°åŠ¨æ€æ··åˆï¼ˆæ··åˆæ¯”ä¾‹éšæ—¶é—´å˜åŒ–ï¼‰</li>
<li>ğŸ¬ å®ç°åˆ†åŒºåŸŸæ··åˆï¼ˆä¸åŒåŒºåŸŸä¸åŒæ··åˆæ¨¡å¼ï¼‰</li>
<li>ğŸ’¾ ä¿å­˜æ··åˆåçš„å›¾ç‰‡åˆ°ç›¸å†Œ</li>
</ol>
<h2 data-id="heading-35">ğŸ“– çŸ¥è¯†ç‚¹æ€»ç»“</h2>
<h3 data-id="heading-36">çº¹ç†å•å…ƒ vs çº¹ç†å¯¹è±¡</h3>






























<table><thead><tr><th>ç‰¹æ€§</th><th>çº¹ç†å•å…ƒ</th><th>çº¹ç†å¯¹è±¡</th></tr></thead><tbody><tr><td><strong>æ¦‚å¿µ</strong></td><td>GPU çš„"çº¹ç†æ§½ä½"</td><td>å®é™…çš„çº¹ç†æ•°æ®</td></tr><tr><td><strong>æ•°é‡</strong></td><td>æœ‰é™ï¼ˆé€šå¸¸ 8-32 ä¸ªï¼‰</td><td>å¯ä»¥åˆ›å»ºå¾ˆå¤š</td></tr><tr><td><strong>æ“ä½œ</strong></td><td><code>glActiveTexture()</code></td><td><code>glBindTexture()</code></td></tr><tr><td><strong>ç±»æ¯”</strong></td><td>USB æ¥å£</td><td>U ç›˜</td></tr></tbody></table>
<h3 data-id="heading-37">æ··åˆæ¨¡å¼å¯¹æ¯”</h3>








































<table><thead><tr><th>æ¨¡å¼</th><th>è§†è§‰æ•ˆæœ</th><th>å¸¸ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>Alpha</strong></td><td>é€æ˜å åŠ </td><td>æ°´å°ã€UI å åŠ </td></tr><tr><td><strong>Add</strong></td><td>å¢äº®ã€å‘å…‰</td><td>å…‰æ•ˆã€ç²’å­</td></tr><tr><td><strong>Multiply</strong></td><td>å˜æš—ã€é˜´å½±</td><td>é˜´å½±ã€è‰²å½©æ ¡æ­£</td></tr><tr><td><strong>Screen</strong></td><td>æŸ”å’Œå¢äº®</td><td>æŸ”å…‰ã€æ°›å›´</td></tr><tr><td><strong>Overlay</strong></td><td>å¯¹æ¯”å¢å¼º</td><td>ç…§ç‰‡æ»¤é•œ</td></tr><tr><td><strong>Soft Light</strong></td><td>æŸ”å’Œæ··åˆ</td><td>è‚–åƒç¾åŒ–</td></tr></tbody></table>
<h3 data-id="heading-38">æœ€ä½³å®è·µ</h3>
<ol>
<li>âœ… <strong>å¤ç”¨çº¹ç†å•å…ƒ</strong>ï¼šä¸è¦æ¯å¸§éƒ½é‡æ–°æ¿€æ´»å’Œç»‘å®š</li>
<li>âœ… <strong>æ‰¹é‡æ¸²æŸ“</strong>ï¼šç›¸åŒçº¹ç†çš„å¯¹è±¡ä¸€èµ·æ¸²æŸ“</li>
<li>âœ… <strong>çº¹ç†å‹ç¼©</strong>ï¼šå¯¹è¾…åŠ©çº¹ç†ä½¿ç”¨è¾ƒä½åˆ†è¾¨ç‡</li>
<li>âœ… <strong>åŠæ—¶é‡Šæ”¾</strong>ï¼šä¸å†ä½¿ç”¨çš„çº¹ç†è¦åˆ é™¤</li>
<li>âœ… <strong>æ£€æŸ¥é™åˆ¶</strong>ï¼šæŸ¥è¯¢è®¾å¤‡æ”¯æŒçš„æœ€å¤§çº¹ç†å•å…ƒæ•°</li>
</ol>
<h2 data-id="heading-39">ğŸ› å¸¸è§é—®é¢˜</h2>
<h3 data-id="heading-40">Q1: çº¹ç†æ˜¾ç¤ºæ˜¯é»‘è‰²çš„ï¼Ÿ</h3>
<p><strong>å¯èƒ½åŸå› </strong>ï¼š</p>
<ol>
<li>çº¹ç†å•å…ƒç´¢å¼•é”™è¯¯</li>
<li><code>glUniform1i</code> ä¼ é€’çš„å€¼ä¸å¯¹åº”æ¿€æ´»çš„çº¹ç†å•å…ƒ</li>
</ol>
<p><strong>è§£å†³æ–¹æ³•</strong>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// çº¹ç†å•å…ƒ 0</span>
GLES20.glActiveTexture(GLES20.GL_TEXTURE0)
GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, texture1)
GLES20.glUniform1i(texture1Location, <span class="hljs-number">0</span>)  <span class="hljs-comment">// ä¼ é€’ 0ï¼Œä¸æ˜¯ GL_TEXTURE0</span>

<span class="hljs-comment">// çº¹ç†å•å…ƒ 1</span>
GLES20.glActiveTexture(GLES20.GL_TEXTURE1)
GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, texture2)
GLES20.glUniform1i(texture2Location, <span class="hljs-number">1</span>)  <span class="hljs-comment">// ä¼ é€’ 1ï¼Œä¸æ˜¯ GL_TEXTURE1</span>
</code></pre>
<h3 data-id="heading-41">Q2: æ··åˆæ•ˆæœä¸æ­£ç¡®ï¼Ÿ</h3>
<p>æ£€æŸ¥æ˜¯å¦å¯ç”¨äº† OpenGL æ··åˆï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å¦‚æœä½¿ç”¨ç¡¬ä»¶æ··åˆ</span>
GLES20.glEnable(GLES20.GL_BLEND)
GLES20.glBlendFunc(GLES20.GL_SRC_ALPHA, GLES20.GL_ONE_MINUS_SRC_ALPHA)

<span class="hljs-comment">// å¦‚æœä½¿ç”¨ç€è‰²å™¨æ··åˆ</span>
<span class="hljs-comment">// ä¸éœ€è¦å¯ç”¨ glBlendï¼Œç›´æ¥åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­è®¡ç®—å³å¯</span>
</code></pre>
<h3 data-id="heading-42">Q3: æ°´å°ä½ç½®ä¸å¯¹ï¼Ÿ</h3>
<p>OpenGL åæ ‡ç³»åŸç‚¹åœ¨å·¦ä¸‹è§’ï¼Œè€Œ UI åæ ‡ç³»åœ¨å·¦ä¸Šè§’ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// UI åæ ‡ï¼ˆå·¦ä¸Šè§’ä¸ºåŸç‚¹ï¼‰</span>
<span class="hljs-keyword">val</span> uiY = <span class="hljs-number">100f</span>

<span class="hljs-comment">// è½¬æ¢ä¸º OpenGL åæ ‡ï¼ˆå·¦ä¸‹è§’ä¸ºåŸç‚¹ï¼‰</span>
<span class="hljs-keyword">val</span> glY = screenHeight - uiY - watermarkHeight
</code></pre>
<h3 data-id="heading-43">Q4: å¦‚ä½•å®ç°åœ†å½¢æ°´å°ï¼Ÿ</h3>
<p>åœ¨ç€è‰²å™¨ä¸­ä½¿ç”¨è·ç¦»å‡½æ•°ï¼š</p>
<pre><code class="hljs language-glsl" lang="glsl">void main() {
    vec2 center = vec2(0.5, 0.5);
    float dist = distance(watermarkCoord, center);
    
    // åœ†å½¢é®ç½©
    float alpha = smoothstep(0.5, 0.48, dist);
    
    vec4 watermarkColor = texture2D(uWatermark, watermarkCoord);
    watermarkColor.a *= alpha;
    
    gl_FragColor = mix(baseColor, watermarkColor, watermarkColor.a);
}
</code></pre>
<h2 data-id="heading-44">ğŸ”— å‚è€ƒèµ„æ–™</h2>
<h3 data-id="heading-45">å®˜æ–¹æ–‡æ¡£</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.khronos.org%2Fopengl%2Fwiki%2FTexture" target="_blank" title="https://www.khronos.org/opengl/wiki/Texture" ref="nofollow noopener noreferrer">OpenGL ES Texture Units</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.khronos.org%2Fopengl%2Fwiki%2FSampler_(GLSL)" target="_blank" title="https://www.khronos.org/opengl/wiki/Sampler_(GLSL)" ref="nofollow noopener noreferrer">GLSL Sampler Types</a></li>
</ul>
<h3 data-id="heading-46">æ··åˆæ¨¡å¼å‚è€ƒ</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fphotoblogstop.com%2Fphotoshop%2Fphotoshop-blend-modes-explained" target="_blank" title="https://photoblogstop.com/photoshop/photoshop-blend-modes-explained" ref="nofollow noopener noreferrer">Photoshop Blend Modes</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fjamieowen%2Fglsl-blend" target="_blank" title="https://github.com/jamieowen/glsl-blend" ref="nofollow noopener noreferrer">WebGL Blend Modes</a></li>
</ul>
<h3 data-id="heading-47">æ¨èé˜…è¯»</h3>
<ul>
<li>ã€ŠReal-Time Renderingã€‹- Chapter 5: Visual Appearance</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.nvidia.com%2Fgpugems%2Fgpugems3%2Fpart-iv-image-effects" target="_blank" title="https://developer.nvidia.com/gpugems/gpugems3/part-iv-image-effects" ref="nofollow noopener noreferrer">GPU Gems - Image Processing</a></li>
</ul>
<h2 data-id="heading-48">ğŸ“ ä»Šæ—¥æ€»ç»“</h2>
<p>ä»Šå¤©æˆ‘ä»¬æ·±å…¥å­¦ä¹ äº†å¤šé‡çº¹ç†å’Œæ··åˆæŠ€æœ¯ï¼š</p>
<ol>
<li>âœ… ç†è§£äº†çº¹ç†å•å…ƒçš„æ¦‚å¿µï¼šGPU ä¸­çš„"çº¹ç†æ§½ä½"</li>
<li>âœ… æŒæ¡äº†å¤šçº¹ç†çš„ä½¿ç”¨æµç¨‹ï¼šæ¿€æ´» â†’ ç»‘å®š â†’ ä¼ é€’ç´¢å¼•</li>
<li>âœ… å­¦ä¹ äº† 6 ç§å¸¸ç”¨æ··åˆæ¨¡å¼ï¼šAlphaã€Addã€Multiplyã€Screenã€Overlayã€Soft Light</li>
<li>âœ… å®ç°äº†å®ç”¨æ•ˆæœï¼šæ°´å°ã€åŒé‡æ›å…‰ã€é®ç½©</li>
</ol>
<p><strong>å…³é”®è¦ç‚¹</strong>ï¼š</p>
<ul>
<li>çº¹ç†å•å…ƒå…è®¸æˆ‘ä»¬åœ¨ä¸€æ¬¡ç»˜åˆ¶ä¸­ä½¿ç”¨å¤šä¸ªçº¹ç†</li>
<li><code>glActiveTexture()</code> æ¿€æ´»çº¹ç†å•å…ƒï¼Œ<code>glUniform1i()</code> ä¼ é€’ç´¢å¼•ï¼ˆä¸æ˜¯ GL_TEXTURE å¸¸é‡ï¼‰</li>
<li>æ··åˆæ¨¡å¼æœ¬è´¨æ˜¯ä¸åŒçš„é¢œè‰²è®¡ç®—å…¬å¼</li>
<li>Alpha é€šé“æ˜¯å®ç°é€æ˜æ•ˆæœçš„å…³é”®</li>
</ul>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">ä¸‹ä¸€ç¯‡</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ModelScope æ¨¡å‹ä¸€é”®ä¸Šçº¿ï¼ŸFunModel å¸®ä½  5 åˆ†é’Ÿä»é›¶åˆ°ç”Ÿäº§]]></title>    <link>https://juejin.cn/post/7570651893870854196</link>    <guid>https://juejin.cn/post/7570651893870854196</guid>    <pubDate>2025-11-10T08:22:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570651893870854196" data-draft-id="7570866247979335732" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ModelScope æ¨¡å‹ä¸€é”®ä¸Šçº¿ï¼ŸFunModel å¸®ä½  5 åˆ†é’Ÿä»é›¶åˆ°ç”Ÿäº§"/> <meta itemprop="keywords" content="Serverless"/> <meta itemprop="datePublished" content="2025-11-10T08:22:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘äº‘åŸç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3808363977648493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ModelScope æ¨¡å‹ä¸€é”®ä¸Šçº¿ï¼ŸFunModel å¸®ä½  5 åˆ†é’Ÿä»é›¶åˆ°ç”Ÿäº§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808363977648493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘äº‘åŸç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T08:22:30.000Z" title="Mon Nov 10 2025 08:22:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šç™¾æ½¼</p>
<blockquote>
<p>ä¸‹ä¸€ä¸ª AI çˆ†æ¬¾åº”ç”¨ï¼Œæˆ–è®¸å°±ä»æ‚¨ç‚¹å‡»â€œç«‹å³éƒ¨ç½²â€çš„é‚£ä¸€åˆ»å¼€å§‹ï¼</p>
</blockquote>
<h2 data-id="heading-0">å‰è¨€ï¼šAI æµªæ½®ä¸‹çš„æ¨¡å‹è¯‰æ±‚</h2>
<p>åœ¨å½“ä»Šè¿™ä¸ªå…¨æ°‘ AI çš„æ—¶ä»£ï¼Œå¿«é€Ÿå…¥é—¨ AIï¼Œèµ¶ä¸Šæ—¶ä»£çš„æµªæ½®ï¼Œæˆä¸ºäº†å¤§å®¶å½“ä¸‹æœ€çƒ­åˆ‡çš„è¿½æ±‚å’ŒæœŸç›¼ã€‚</p>
<p>äºæ˜¯ï¼Œæ¨¡å‹ä½œä¸º AI åœºæ™¯çš„è½½ä½“ï¼Œéšç€ AI æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œåœ¨æŒç»­çš„ï¼Œå¦‚é›¨åæ˜¥ç¬‹èˆ¬å‡ºç°åœ¨å¤§å®¶çš„è§†é‡ä¸­ï¼Œå¯è°“æ˜¯ç§ç±»ç¹æ‚ï¼ŒåŠŸèƒ½é½å…¨ï¼Œä»ä¸åŒæ–¹é¢æ»¡è¶³å¤§å®¶å¯¹ AI çš„éœ€æ±‚ã€‚ä¾‹å¦‚åœ¨ AI èŠå¤©åœºæ™¯ï¼Œå°±æœ‰å¾ˆå¤šå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å¯ä¾›é€‰æ‹©ï¼›åœ¨æ–‡æœ¬è½¬è¯­éŸ³çš„åœºæ™¯ï¼Œåˆæœ‰å¾ˆå¤šä¸åŒç§ç±»çš„ TTS æ¨¡å‹ã€‚AI åœºæ™¯å¤šå˜ï¼Œäººä»¬ä¹Ÿåœ¨ä¸æ–­æ¢ç´¢ä»¥æ¨¡å‹ä¸ºè½½ä½“çš„æ›´å¤š AI çš„å¯èƒ½ã€‚</p>
<p>ModelScope ä½œä¸ºå›½å†… Top çš„ AI æ¨¡å‹å¹³å°ï¼Œæ”¶å½•æ‰¿è½½äº†å¤§é‡çš„æ¨¡å‹ï¼Œäººä»¬å¯ä»¥åœ¨ ModelScope æŒ‰éœ€é€‰æ‹©æ¨¡å‹ã€‚æ­¤æ—¶ï¼Œå°†æ¨¡å‹å¿«é€Ÿè°ƒè¯•åº”ç”¨ï¼Œå‘å¸ƒä¸Šçº¿å¹¶è¿ç»´ï¼Œä¹Ÿæˆä¸ºäº†å¾ˆå¤šå…¬å¸å¿…ä¸å¯å°‘çš„æ¢ç´¢æ–¹å‘ã€‚</p>
<h2 data-id="heading-1">ç—›ç‚¹åˆ†æï¼šä¼ ç»Ÿæ¨¡å‹é›†æˆæ–¹æ¡ˆå·²æˆ AI é©æ–°æ‹¦è·¯è™</h2>
<p>ModelScope ç»™ AI å¼€å‘è€…åœ¨æ¨¡å‹å±‚é¢ä¸Šæä¾›äº†éå¸¸å¤§çš„ä¾¿åˆ©ï¼Œç„¶è€Œï¼ŒçœŸæ­£å°†æ¨¡å‹ç”¨èµ·æ¥ï¼Œè®©æ¨¡å‹å…·å¤‡ä¼ä¸šçº§çš„ç”Ÿäº§èƒ½åŠ›ï¼Œåˆæ˜¯æ‰€æœ‰ä¼ä¸šç”¨æˆ·ä¸å¾—ä¸é¢ä¸´çš„é—®é¢˜ã€‚å¯¹äºå¾ˆå¤šå¼€å‘è€…æ¥è¯´ï¼Œæœ‰ç€ä¸å°çš„ä½¿ç”¨é—¨æ§›ã€‚ä¸”æ¨¡å‹è¿­ä»£é€Ÿåº¦å¤ªå¿«ï¼Œå¦‚ä½•èƒ½å®æ—¶ç´§è·Ÿæ¨¡å‹çš„çƒ­åº¦æ˜¯å¾ˆå¤šå¼€å‘è€…äºŸå¾…è§£å†³çš„é—®é¢˜ã€‚</p>
<p>è¯•æƒ³ä¸€ä¸‹ï¼šä¸€ä¸ªä¸­å°å‹å…¬å¸å¸Œæœ›åœ¨è‡ªå·±çš„å¹³å°é›†æˆ LLM æ¨¡å‹ï¼Œå´è¦é¢å¯¹ GPU èµ„æºé…ç½®ã€å·¥ç¨‹åŒ–è°ƒè¯•ã€é•œåƒæ„å»ºç­‰ä¸€ç³»åˆ—ç¹çæ­¥éª¤ï¼Œæ•´ä¸ªè¿‡ç¨‹è€—æ—¶ 1 ï½ 2 å‘¨ï¼è¿™å¯¹äºæ€¥éœ€å¿«é€Ÿå“åº”å¸‚åœºçš„å›¢é˜Ÿæ¥è¯´ï¼Œç®€ç›´æ˜¯â€œè‡´å‘½ä¼¤â€ã€‚æ›´åˆ«æå…¬å¸çš„éå¼€å‘è€…ï¼Œå¦‚æœæƒ³è¦ä½“éªŒæ¨¡å‹æ•ˆæœï¼Œå´å› ä¸ºæŠ€æœ¯é—¨æ§›æœ›è€Œå´æ­¥ï¼Œé”™å¤±äº†å®è´µçš„ä¸šåŠ¡åˆ›æ–°æœºä¼šã€‚</p>
<ul>
<li><strong>é«˜ä½¿ç”¨é—¨æ§›é˜»æ»å¿«é€Ÿæ¥å…¥ï¼š</strong> è®©æ¨¡å‹å…·å¤‡åŸºç¡€å·¥ç¨‹èƒ½åŠ›å¹¶å¯¹å¤–æä¾›æœåŠ¡ï¼Œéœ€è¦ç»å†ä¸€ç³»åˆ—ç¹çæ­¥éª¤ï¼šè·å–åˆé€‚çš„ GPU èµ„æºã€æŠ•å…¥å¤§é‡æ—¶é—´è¿›è¡Œå¼€å‘è°ƒè¯•ã€é…ç½®è¿è¡Œé•œåƒã€ä¸ç°æœ‰ä¸šåŠ¡ç³»ç»Ÿé€‚é…ã€‚å¯¹äºæ–°å…¥èŒçš„ AI å·¥ç¨‹å¸ˆè€Œè¨€ï¼Œè¿™äº›å·¥ä½œéœ€ä¸å…¬å¸ä¸šåŠ¡å­¦ä¹ å¹¶è¡Œå±•å¼€ï¼Œè€Œè¾ƒé«˜çš„æŠ€æœ¯é—¨æ§›å¿…ç„¶æ‹‰é•¿å‰æœŸå‡†å¤‡å‘¨æœŸï¼Œæ•´ä¸ªè¿‡ç¨‹å¯èƒ½éœ€è¦ 1 ï½ 2 å‘¨çš„æ—¶é—´å‘¨æœŸã€‚åœ¨ç´§å‡‘çš„é¡¹ç›®æ’æœŸå‹åŠ›ä¸‹ï¼Œéš¾ä»¥å®ç°æ¨¡å‹çš„è¿…é€Ÿæ¥å…¥ä¸ä¸Šçº¿ã€‚</li>
<li><strong>è¿ç»´å¤æ‚æ€§å¨èƒæœåŠ¡ç¨³å®šæ€§ï¼š</strong> æ¨¡å‹ä¸Šçº¿åï¼Œçªå¢çš„æµé‡å¾€å¾€ä¼šæš´éœ²ç³»ç»Ÿç“¶é¢ˆã€‚æ‰©å®¹è¿‡ç¨‹é“¾è·¯å†—é•¿â€”â€”éœ€é‡æ–°é…ç½® GPU èµ„æºã€è°ƒæ•´è¿è¡Œç¯å¢ƒã€éƒ¨ç½²æ–°é•œåƒâ€”â€”è€—æ—¶å·¨å¤§ï¼Œéš¾ä»¥åº”å¯¹æµé‡æ´ªå³°ï¼Œæœ€ç»ˆå¯¼è‡´æœåŠ¡å®•æœºã€‚æµé‡æ¶ˆé€€åï¼Œä¸ºæ§åˆ¶é«˜æ˜‚çš„ GPU æˆæœ¬åˆä¸å¾—ä¸é‡Šæ”¾èµ„æºã€‚å¦‚æ­¤å¾ªç¯å¾€å¤ï¼Œæ¯æ¬¡æµé‡é«˜å³°éƒ½é‡å¤ç›¸åŒçš„æ‰©å®¹å›°å¢ƒã€‚</li>
<li><strong>è¿­ä»£æ•ˆç‡ä½ä¸‹éš¾è·ŸæŠ€æœ¯æ½®æµï¼š</strong> é‰´äºæ¨¡å‹è¿­ä»£é€Ÿåº¦åŠ å¿«ï¼ŒAI å·¥ç¨‹å¸ˆè‹¥æ¬²åŠæ—¶å‡çº§è‡³æ–°ç‰ˆæœ¬æ¨¡å‹ï¼Œä¸ä»…éœ€éƒ¨ç½²æ–°æ¨¡å‹ï¼Œè¿˜éœ€å¤„ç†æ—§æ¨¡å‹çš„æµé‡å¹³æ»‘è¿‡æ¸¡ï¼ŒåŒæ—¶æ‰¿å—ç°æœ‰æ¶æ„çš„æ²‰é‡è´Ÿæ‹…ã€‚è¿™ç§ä½æ•ˆçš„è¿­ä»£æœºåˆ¶ï¼Œä½¿å›¢é˜Ÿéš¾ä»¥å®æ—¶è·Ÿè¿›ä¸šç•Œæœ€æ–°çš„æ¨¡å‹æ–¹æ¡ˆã€‚</li>
</ul>
<p>ç©¶å…¶æ ¹æœ¬ï¼Œå¯ä»¥å°†ä»¥ä¸Šçš„ä¸‰ä¸ªç—›ç‚¹é—®é¢˜æç‚¼ä¸ºå½“å‰ AI å·¥ç¨‹å¸ˆæ™®éé‡åˆ°çš„æŠ€æœ¯ç“¶é¢ˆï¼š<strong>éƒ¨ç½²é—¨æ§›é«˜ã€ç¯å¢ƒé…ç½®å¤æ‚ã€ä¼ä¸šåŒ–è¿ç»´éš¾ï¼</strong></p>
<h2 data-id="heading-2">å¯¹æ–°æ¨¡å‹é›†æˆæ–¹æ¡ˆçš„æœŸæœ›</h2>
<p>è¡Œä¸šæœŸå¾…çš„æ¨¡å‹é›†æˆæ–¹æ¡ˆåº”è¯¥å…·å¤‡ï¼š</p>
<ul>
<li><strong>é›¶ä»£ç éƒ¨ç½²ï¼š</strong> å‘Šåˆ«ç¹ççš„æ¨ç†ä»£ç ç¼–å†™ã€Dockerfile é…ç½®ï¼Œåªéœ€ç®€å•å¡«å†™é…ç½®ï¼Œæ¨¡å‹å³åˆ»ä¸Šçº¿ã€‚</li>
<li><strong>ä¸€é”®æ‰©ç¼©å®¹ï¼š</strong> å€Ÿé‰´ Serverless ç†å¿µï¼Œå®ç° GPU èµ„æºçš„å¼¹æ€§ä¼¸ç¼©ï¼Œåº”å¯¹æµé‡æ³¢åŠ¨ã€‚</li>
<li><strong>å…¨æµç¨‹è¦†ç›–ï¼š</strong> ä»å¼€å‘è°ƒè¯•åˆ°ç”Ÿäº§è¿ç»´ï¼Œä¸€ç«™å¼è§£å†³ï¼Œè®©ä¼ä¸šä¸ä»…â€œç”¨å¾—èµ·â€ï¼Œæ›´è¦â€œç”¨å¾—å¥½â€ã€‚</li>
<li><strong>å¿«é€Ÿè¿­ä»£èƒ½åŠ›ï¼š</strong> æ–°æ¨¡å‹ä¸Šçº¿æ— éœ€é‡æ„æ¶æ„ï¼Œå¹³æ»‘è¿‡æ¸¡ï¼Œç´§è·ŸæŠ€æœ¯æ½®æµã€‚</li>
</ul>
<h2 data-id="heading-3">æ¨¡å‹é›†æˆæ–°èŒƒå¼â€”â€”FunModel</h2>
<p>é¢å¯¹ä»¥ä¸Š AI å¼€å‘ä¸­é‡åˆ°çš„ç—›ç‚¹ä»¥åŠå¼€å‘è€…ä»¬å¯¹æ¨¡å‹çš„æŒç»­æ¢ç´¢å’ŒæœŸå¾…ï¼Œé˜¿é‡Œäº‘ FunModel å¸¦æ¥äº†æ¨¡å‹é›†æˆçš„æ–°èŒƒå¼ã€‚FunModel æ˜¯é˜¿é‡Œäº‘äº‘åŸç”Ÿçš„æ¨¡å‹æœåŠ¡å¹³å°ï¼Œä»¥é˜¿é‡Œäº‘å‡½æ•°è®¡ç®— FC ä¸ºåº•åº§ï¼Œä¾æ‰˜å¤©ç„¶çš„ Serverless + GPU çš„åŸºæœ¬èƒ½åŠ›ï¼ŒåŒæ—¶åœ¨ä¸šåŠ¡å±‚é¢æ— ç¼å¯¹æ¥ ModelScope å®˜æ–¹æ¨¡å‹å¹³å°ï¼Œå®ç° 0 ä»£ç ä¸€é”®éƒ¨ç½²ï¼Œå¹¶èƒ½å¿«é€Ÿæ‰©ç¼©å®¹ã€‚ä¸ºä¼ä¸šæå¤§ç¨‹åº¦ä¸Šå‡å°‘äº†éƒ¨ç½²å’Œè¿ç»´æ¨¡å‹çš„æ—¶é—´å’ŒäººåŠ›æˆæœ¬ï¼Œè®©ä¼ä¸šä¸“æ³¨äº AI ä¸šåŠ¡çš„å¼€å‘ï¼Œä¹Ÿè®©æ¨¡å‹ä¼ä¸šåŒ–è§¦æ‰‹å¯åŠã€‚</p>
<h3 data-id="heading-4">åŒæ¸ é“éƒ¨ç½²ï¼Œçµæ´»è‡ªç”±</h3>
<p>é˜¿é‡Œäº‘ FunModel æä¾›äº†ä¸¤ç§éƒ¨ç½²æ¸ é“ï¼Œå…¼å®¹å¤šç§ç±»æ¨¡å‹ï¼Œç»™ç”¨æˆ·æä¾›äº†éƒ¨ç½²æ¨¡å‹çš„è‡ªç”±åº¦</p>
<p><strong>1. æ— ç¼å¯¹æ¥ ModelScopeï¼š</strong> é˜¿é‡Œäº‘ FunModel æ‰¿è½½äº† ModelScope ä¸Šå¤§é‡çš„çƒ­é—¨æ¨¡å‹ï¼Œèƒ½æ ¹æ®ç”¨æˆ·éœ€æ±‚å’Œçƒ­é—¨æ¨¡å‹è¶‹åŠ¿å¿«é€Ÿä¸Šæ¶å’Œè¿­ä»£æ–°çš„æ¨¡å‹ï¼Œæ»¡è¶³ç”¨æˆ·éœ€æ±‚ã€‚åŒæ—¶ï¼Œä¹Ÿå¯ä»¥è¾“å…¥ ModelScope ä¸Šçš„æ¨¡å‹ IDï¼Œå³å¯ç«‹å³éƒ¨ç½²ã€‚åœ¨ FunModel ä¸Šï¼Œè¿˜èƒ½å¿«é€Ÿä½“éªŒ ModelScope æ¨¡å‹æ•ˆæœå’Œäº†è§£æ¨¡å‹è¯¦æƒ…ï¼Œæ‹¥æœ‰ä»ä½“éªŒåˆ°éƒ¨ç½²çš„å®Œæ•´æµç¨‹ï¼Œä¸ºç”¨æˆ·æœ€å¤§ç¨‹åº¦ä¸Šå¸¦æ¥ä¾¿æ·ã€‚</p>
<p><strong>2. è‡ªå®šä¹‰éƒ¨ç½²ï¼š</strong> é˜¿é‡Œäº‘ FunModel ä¸ä»…ä¸ºç”¨æˆ·æä¾›æ¨¡å‹é›†æˆèƒ½åŠ›ï¼Œæ›´ä¸ºæœ‰æ¨¡å‹å¼€å‘éœ€æ±‚çš„ç”¨æˆ·æä¾›äº†ä¸“ä¸šçš„è‡ªå®šä¹‰æ¨¡å‹éƒ¨ç½²èƒ½åŠ›**ã€‚ç”¨æˆ·å¯ä»¥ä¸Šä¼ è‡ªå·±è®­ç»ƒå¥½çš„å·¥ç¨‹é•œåƒåˆ° FunModel å¹³å°ï¼ŒæŒ‡å®šæ¨¡å‹æ¥æºæˆ–å­˜å‚¨è·¯å¾„ï¼Œå¡«å†™å¯¹åº”å¯åŠ¨å‚æ•°ï¼Œå°±èƒ½éƒ¨ç½²æ¨¡å‹åˆ°çº¿ä¸Šï¼Œå…·å¤‡ä¼ä¸šçº§æœåŠ¡èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-5">5 åˆ†é’Ÿæé€Ÿä¸Šçº¿</h3>
<p>é˜¿é‡Œäº‘ FunModel æå¤§ç¨‹åº¦ä¸Šç®€åŒ–äº†æ¨¡å‹çš„éƒ¨ç½²æµç¨‹ï¼Œç”¨æˆ·ä¸å†éœ€è¦æ‹…å¿ƒâ€œæ¨ç†ä»£ç ä¸ä¼šå†™â€ï¼Œâ€œéƒ¨ç½²é•œåƒå¤ªæ…¢â€ï¼Œâ€œå¯åŠ¨å‚æ•°å¡«å†™é”™è¯¯â€ï¼Œâ€œGPU è§„æ ¼é€‰ä¸å¯¹â€ç­‰é—®é¢˜ã€‚FunModel å¹³å°å·²ç»æå‰åŒ…è£…äº†å¯åŠ¨æ¨¡å‹éœ€è¦çš„æ‰€æœ‰å‚æ•°å’Œç¯å¢ƒï¼Œ<strong>åªéœ€å¡«å†™æ¨¡å‹åç§°ï¼Œ5 åˆ†é’Ÿå³å¯å®Œæˆä¼ä¸šçº§æœåŠ¡ä¸Šçº¿</strong>ï¼Œ<strong>æ•ˆç‡æå‡æ•°åå€</strong>ã€‚ä¼ ç»Ÿé›†æˆæ–¹æ¡ˆéœ€è¦è€—æ—¶æ•°å‘¨ï¼Œåœ¨ FunModel è¿™é‡Œå‹ç¼©åˆ°äº†ä¸€æ¯å’–å•¡çš„æ—¶é—´ã€‚</p>
<h3 data-id="heading-6">Serverless + GPU å¸®åŠ©å®ç°æ‰©ç¼©å®¹</h3>
<p>ä¾æ‰˜é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—ï¼ŒFunModel å®ç° Serverless+GPU æ–°èŒƒå¼ï¼Œæä¾›ï¼š</p>
<ul>
<li><strong>å®šæ—¶ä¼¸ç¼© / CRON è¡¨è¾¾å¼ä¼¸ç¼©ï¼š</strong> æ ¹æ®ä¸šåŠ¡è§„å¾‹é¢„è®¾æ‰©ç¼©å®¹æ—¶é—´ã€‚</li>
<li><strong>æ°´ä½ä¼¸ç¼©ï¼š</strong> åŸºäº CPU/GPU ä½¿ç”¨ç‡è‡ªåŠ¨è°ƒæ•´èµ„æºã€‚</li>
</ul>
<p>ä¸¤ç§ç§ç­–ç•¥çµæ´»ç»„åˆï¼Œç²¾å‡†åŒ¹é…ä¸šåŠ¡æµé‡ï¼Œæå¤§ç¨‹åº¦ä¸Šæé«˜ GPU åˆ©ç”¨ç‡ï¼Œä»è€ŒèŠ‚çº¦æ˜‚è´µçš„ GPU è´¹ç”¨æˆæœ¬ã€‚</p>
<h2 data-id="heading-7">å®æˆ˜æŒ‡å—ï¼šå¿«é€Ÿéƒ¨ç½² ModelScope æ¨¡å‹</h2>
<h3 data-id="heading-8">ç¯å¢ƒå‡†å¤‡ä¸æƒé™é…ç½®</h3>
<p>åœ¨ä½¿ç”¨ FunModel å¹³å°å‰ï¼Œéœ€è¦å®Œæˆå¿…è¦çš„äº‘èµ„æºå‡†å¤‡å·¥ä½œï¼š</p>
<p><strong>1. é˜¿é‡Œäº‘è´¦å·å‡†å¤‡</strong></p>
<p>ç¡®ä¿æ‹¥æœ‰æœ‰æ•ˆçš„é˜¿é‡Œäº‘è´¦å·ï¼Œå¹¶å®Œæˆå®åè®¤è¯ã€‚</p>
<p><strong>2. FunModel æ§åˆ¶å°è®¿é—®</strong></p>
<p>è®¿é—®Â FunModel æ§åˆ¶å° <strong>[</strong> <strong>1]</strong> ï¼Œè¿™æ˜¯é˜¿é‡Œäº‘ Serverless AI æ¨¡å‹æœåŠ¡çš„ç»Ÿä¸€å…¥å£ã€‚</p>
<p><strong>3. RAM è§’è‰²æˆæƒ</strong></p>
<p>æ ¹æ®æ§åˆ¶å°æŒ‡å¼•å®Œæˆ RAMï¼ˆResource Access Managementï¼‰è§’è‰²æˆæƒé…ç½®ã€‚è¿™ä¸ªæ­¥éª¤è‡³å…³é‡è¦ï¼Œå®ƒç¡®ä¿ DevPod èƒ½å¤Ÿè®¿é—®å¿…è¦çš„äº‘èµ„æºã€‚</p>
<blockquote>
<p><strong>é‡è¦æç¤º</strong>ï¼šå¦‚æœæ‚¨å½“å‰ä½¿ç”¨çš„æ˜¯æ—§ç‰ˆæ§åˆ¶å°ç•Œé¢ï¼Œè¯·åŠ¡å¿…ç‚¹å‡»å³ä¸Šè§’çš„â€œæ–°ç‰ˆæ§åˆ¶å°â€æŒ‰é’®åˆ‡æ¢è‡³æœ€æ–°ç•Œé¢ï¼Œä»¥ç¡®ä¿åŠŸèƒ½å®Œæ•´æ€§ã€‚</p>
</blockquote>
<h3 data-id="heading-9">ä¸‰æ­¥æé€Ÿéƒ¨ç½²</h3>
<p><strong>æ­¥éª¤ä¸€</strong>ï¼šç™»å½•Â FunModel æ§åˆ¶å°ï¼Œè¿›å…¥ã€æ¨¡å‹å¸‚åœºã€‘ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b2370d0d1b6344e498d59ad682c31b71~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367749&amp;x-signature=dCRJ02iTt7VqjrfEGmjRjZjKE%2Bc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>æ­¥éª¤äºŒ</strong>ï¼šåœ¨å·¦ä¾§é¡µç­¾å¯ä»¥é€‰æ‹©ä¸åŒçš„æ¨¡å‹åˆ†ç±»ï¼Œé€‰æ‹©æ¨¡å‹å¡ç‰‡ï¼Œå¯ä»¥åœ¨å³è¾¹æŸ¥çœ‹æ¨¡å‹è¯¦æƒ…ï¼Œå¹¶å¿«é€Ÿä½“éªŒæ¨¡å‹æ•ˆæœã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/74c02c7c06fa4157a5fd5bc6d98f4386~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367749&amp;x-signature=BourVRrfYyeUkAy7rb5%2FQgylXI4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7a5cacb8eb1248e6834d31a8f8c1621b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367749&amp;x-signature=UL38G5J3aeh%2BxPN%2B0pAVeK0BJvQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>æ­¥éª¤ä¸‰</strong>ï¼šç‚¹å‡»â€œç«‹å³éƒ¨ç½²â€ï¼Œå¡«å†™æ¨¡å‹åç§°ï¼ˆå»ºè®®åŒ…å«ä¸šåŠ¡å«ä¹‰ï¼Œå¦‚â€œocr-v1â€ï¼‰ï¼Œç¡®è®¤èµ„æºé…ç½®ï¼ˆç³»ç»Ÿä¼šæ ¹æ®æ¨¡å‹ç±»å‹æ™ºèƒ½æ¨èï¼‰ï¼Œç‚¹å‡»ç¡®è®¤ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/54717568dc484891911c5e0290bb9561~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367749&amp;x-signature=%2BKFRNbBMdwLItBaKDvWyZmKLURk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83ece083a8b94d32b67f4c8889a12927~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367749&amp;x-signature=ax2ufmWIqHFqFSTP6dMw5fcdmaQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç­‰å¾…å‡ åˆ†é’Ÿå³å¯å®Œæˆéƒ¨ç½²ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a12f3c198574f10b42fe7470f1f3291~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367749&amp;x-signature=NZB%2Bv1Vq%2BMwPwncqxA93Skwdjug%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f142ebacb7534eef90a8a6699c9619fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367749&amp;x-signature=fmYK87uzQh8An%2FCUoLUbM2lUbuU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<blockquote>
<p>å¦‚æœæœ‰æ›´å¤šéœ€æ±‚ï¼Œå¯ä»¥åœ¨ã€æ›´å¤šé…ç½®ã€‘ä¸­è‡ªå®šä¹‰é…ç½®é˜¿é‡Œäº‘å­˜å‚¨ Nasï¼Œæ¨¡å‹æ‰§è¡Œçš„è¶…æ—¶æ—¶é—´ç­‰å‚æ•°ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62f6b0d0af55430ba4ea96d097c62e5b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367749&amp;x-signature=Xe29oeFzTE7k7FbD4COleCfE2AY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
</blockquote>
<h3 data-id="heading-10">é«˜çº§ç©æ³•</h3>
<p><strong>æ¨¡å‹åœ¨çº¿è°ƒè¯•ï¼š</strong> éƒ¨ç½²å®Œæˆåï¼Œåˆ‡æ¢åˆ°â€œåœ¨çº¿è°ƒè¯•â€é¡µç­¾ï¼Œå¡«å†™å¯¹åº”çš„ API-Keyï¼ˆå¦‚æœæœ‰ï¼‰ï¼Œç‚¹å‡»å‘é€è¯·æ±‚ï¼Œå³å¯åœ¨é¡µé¢å³ä¾§çœ‹åˆ°æ¨¡å‹è¿”å›ç»“æœï¼ŒåŒæ—¶æ”¯æŒä¿®æ”¹è¯·æ±‚å‚æ•°ï¼Œå¹¶ä¿å­˜åˆ°æ¨¡å‹æ¦‚è§ˆé¡µçš„ OpenAPISchema ä¸­ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db4efebd89974494a4836ffabd421050~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367749&amp;x-signature=jyZTwFzNi2Q7qB7wWqmz3TfZXiA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>API æ–‡æ¡£å¯¼å‡ºï¼š</strong> ä¸€é”®ç”Ÿæˆ JSON/YAML æ ¼å¼çš„ OpenAPI æ–‡æ¡£ã€‚æ”¯æŒå•ç‹¬ä¿®æ”¹ Schema å¹¶ä¿å­˜ï¼Œè®©æ¥å£å®šä¹‰æ›´ç²¾å‡†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd9a29844d6b403ebb15f5b1cabc523e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367749&amp;x-signature=Nu9fBgJOq8By4uYxReTa3iCMWns%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e1f2d397a974f2986bf09afc71cdd75~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367749&amp;x-signature=%2BpvgO4vbDZPDdGa%2BYyXUSXNXFXU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-11">è¾“å…¥æ¨¡å‹ ID éƒ¨ç½²æ¨¡å‹</h3>
<blockquote>
<p>è‡ªå®šä¹‰æ¨¡å‹éƒ¨ç½²åŠŸèƒ½å…è®¸ç”¨æˆ·éƒ¨ç½²è‡ªå·±çš„æ¨¡å‹æˆ–ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹ï¼Œæ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼ä»¥æ»¡è¶³ä¸åŒçš„ä¸šåŠ¡éœ€æ±‚ã€‚ æ›´å¤šæœ‰å…³ä½¿ç”¨ vLLMã€SGLang å’Œè‡ªå®šä¹‰é•œåƒç­‰æ–¹å¼éƒ¨ç½²æ¨¡å‹çš„è¯¦æƒ…è§è‡ªå®šä¹‰éƒ¨ç½²æ¨¡å‹ <strong>[</strong> <strong>2]</strong> ã€‚</p>
</blockquote>
<p>é€‰æ‹©ã€è‡ªå®šä¹‰å¼€å‘ã€‘é¡µç­¾ï¼Œã€æ¨¡å‹æ¥æºã€‘é€‰æ‹©ã€ModelScope æ¨¡å‹ IDã€‘ï¼Œå¡«å…¥æ¨¡å‹ IDï¼Œä»¥ iic/nlp_structbert_word-segmentation_chinese-base ä¸ºä¾‹ï¼Œç‚¹å‡»ç«‹å³éƒ¨ç½²ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/13055d5c9f1b4fca905dae00704ea167~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367749&amp;x-signature=KR9E4Dw%2Bx08UWexfWZHhtDAb3d4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d5f0ecc9607749a89e330c12402d5dc4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367749&amp;x-signature=8j6cwS83VqwMivG9nlgXrUZXb0g%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-12">æ€»ç»“</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d69afd6f95e74de6ae7e2985d92e17fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367749&amp;x-signature=8j6eIpcZUE6WHOufT%2BLU7oWpLY8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>FunModel ä¾æ‰˜ Serverless + GPUï¼Œå¤©ç„¶æä¾›äº†ç®€å•ï¼Œè½»é‡ï¼Œ0 é—¨æ§›çš„æ¨¡å‹é›†æˆæ–¹æ¡ˆï¼Œç»™ä¸ªäººå¼€å‘è€…è‰¯å¥½çš„ç©è½¬æ¨¡å‹çš„ä½“éªŒï¼Œä¹Ÿè®©ä¼ä¸šçº§å¼€å‘è€…å¿«é€Ÿé«˜æ•ˆçš„éƒ¨ç½²ã€è¿ç»´å’Œè¿­ä»£æ¨¡å‹ã€‚</p>
<p>åœ¨é˜¿é‡Œäº‘ FunModel å¹³å°ï¼Œå¼€å‘è€…å¯ä»¥åšåˆ°ï¼š</p>
<ul>
<li><strong>æ¨¡å‹çš„å¿«é€Ÿéƒ¨ç½²ä¸Šçº¿ï¼š</strong> ä»åŸæ¥çš„ä»¥å‘¨ä¸ºå•ä½çš„æ¨¡å‹æ¥å…¥å‘¨æœŸé™ä½åˆ° 5 åˆ†é’Ÿï¼Œ0 å¼€å‘ï¼Œæ— æ’æœŸã€‚</li>
<li><strong>ä¸€é”®æ‰©ç¼©å®¹ï¼Œè®©è¿ç»´ä¸å†æ˜¯è´Ÿæ‹…ï¼š</strong> å¤šç§æ‰©ç¼©å®¹ç­–ç•¥é«˜åº¦é€‚é…ä¸šåŠ¡æµé‡ï¼Œå®ç°â€œæ— ç—›è¿ç»´â€ã€‚</li>
</ul>
<p>åœ¨ AI çš„æ—¶ä»£æµªæ½®ä¸‹ï¼Œæ¨¡å‹ä½œä¸º AI çš„è½½ä½“å¿…ç„¶ä¼šä¸æ–­è¿­ä»£ï¼Œå¼€å‘è€…å¯¹æ¨¡å‹éƒ¨ç½²çš„éœ€æ±‚ä¹Ÿä¼šæ—¥ç›Šå¢å¤šï¼ŒFunModel ä½œä¸ºæ¨¡å‹é›†æˆå’Œéƒ¨ç½²çš„æ–°èŒƒå¼ï¼Œä¹Ÿä¼šæœç€â€œè®©äººäººæˆä¸ºå¼€å‘è€…â€çš„ç›®æ ‡æ¼”è¿›ä¸‹å»ã€‚</p>
<p><strong>æ›´å¤šå†…å®¹è¯·å‚è€ƒï¼š</strong></p>
<p>FunModelå¿«é€Ÿå…¥é—¨</p>
<p><a href="https://link.juejin.cn?target=http%3A%2F%2Ffun-model-docs.devsapp.net%2Fgetting-started%2F" target="_blank" title="http://fun-model-docs.devsapp.net/getting-started/" ref="nofollow noopener noreferrer">fun-model-docs.devsapp.net/getting-staâ€¦</a></p>
<p>FunModel è‡ªå®šä¹‰éƒ¨ç½²</p>
<p><a href="https://link.juejin.cn?target=http%3A%2F%2Ffun-model-docs.devsapp.net%2Fuser-guide%2Fcustom-model-deployment%2F" target="_blank" title="http://fun-model-docs.devsapp.net/user-guide/custom-model-deployment/" ref="nofollow noopener noreferrer">fun-model-docs.devsapp.net/user-guide/â€¦</a></p>
<p>modelscopeé­”æ­å¹³å°</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.modelscope.cn%2F" target="_blank" title="https://www.modelscope.cn/" ref="nofollow noopener noreferrer">www.modelscope.cn/</a></p>
<p><strong>ç›¸å…³é“¾æ¥ï¼š</strong></p>
<p>[1]Â FunModel æ§åˆ¶å°</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ffunctionai.console.aliyun.com%2Fcn-hangzhou%2Ffun-model%2Fmodel-market" target="_blank" title="https://functionai.console.aliyun.com/cn-hangzhou/fun-model/model-market" ref="nofollow noopener noreferrer">functionai.console.aliyun.com/cn-hangzhouâ€¦</a></p>
<p>[2]Â è‡ªå®šä¹‰éƒ¨ç½²æ¨¡å‹</p>
<p><a href="https://link.juejin.cn?target=http%3A%2F%2Ffun-model-docs.devsapp.net%2Fuser-guide%2Fcustom-model-deployment%2F" target="_blank" title="http://fun-model-docs.devsapp.net/user-guide/custom-model-deployment/" ref="nofollow noopener noreferrer">fun-model-docs.devsapp.net/user-guide/â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[uniappä¹‹WebViewå®¹å™¨åŸç†è¯¦è§£]]></title>    <link>https://juejin.cn/post/7570866247979728948</link>    <guid>https://juejin.cn/post/7570866247979728948</guid>    <pubDate>2025-11-10T08:30:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570866247979728948" data-draft-id="7570866247979712564" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="uniappä¹‹WebViewå®¹å™¨åŸç†è¯¦è§£"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-10T08:30:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯ä¸€è¯¾"/> <meta itemprop="url" content="https://juejin.cn/user/1169536102963917"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            uniappä¹‹WebViewå®¹å™¨åŸç†è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1169536102963917/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯ä¸€è¯¾
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T08:30:57.000Z" title="Mon Nov 10 2025 08:30:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style>
<h2 data-id="heading-0">UniApp WebViewå®¹å™¨åŸç†è¯¦è§£</h2>
<h3 data-id="heading-1">ä¸€ã€WebViewå®¹å™¨æ¦‚è¿°</h3>
<p>UniAppä¹‹æ‰€ä»¥èƒ½å¤Ÿå®ç°è·¨å¹³å°å¼€å‘ï¼Œå…¶æ ¸å¿ƒåŸç†æ˜¯"uniapp ä¸»è¦æ˜¯è¿è¡Œåœ¨webviewå®¹å™¨ä¸­çš„"ã€‚è¿™å¥è¯æ­ç¤ºäº†UniAppçš„åº•å±‚æ¶æ„ï¼šå®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåŸºäºWebViewçš„æ··åˆåº”ç”¨æ¡†æ¶ã€‚</p>
<h4 data-id="heading-2">1.1 ä»€ä¹ˆæ˜¯WebViewå®¹å™¨</h4>
<p>WebViewæ˜¯ä¸€ç§ç³»ç»Ÿç»„ä»¶ï¼Œå¯ä»¥åµŒå…¥åˆ°åŸç”Ÿåº”ç”¨ä¸­ï¼Œç”¨äºæ˜¾ç¤ºç½‘é¡µå†…å®¹ã€‚å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè¿·ä½ æµè§ˆå™¨ï¼Œæä¾›äº†ç½‘é¡µæ¸²æŸ“ã€JavaScriptæ‰§è¡Œç¯å¢ƒä»¥åŠä¸åŸç”ŸåŠŸèƒ½çš„æ¡¥æ¥èƒ½åŠ›ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// WebViewçš„åŸºæœ¬ç»“æ„ï¼ˆæ¦‚å¿µå›¾ï¼‰</span>
+---------------------------+
|      åŸç”Ÿåº”ç”¨å¤–å£³         |
|  +---------------------+  |
|  |                     |  |
|  |    <span class="hljs-title class_">WebView</span>å®¹å™¨      |  |
|  |                     |  |
|  |  +---------------+  |  |
|  |  |   <span class="hljs-variable constant_">HTML</span>/<span class="hljs-variable constant_">CSS</span>/<span class="hljs-variable constant_">JS</span> |  |  |
|  |  +---------------+  |  |
|  |                     |  |
|  +---------------------+  |
|                           |
+---------------------------+
</code></pre>
<h4 data-id="heading-3">1.2 UniAppä¸WebViewçš„å…³ç³»</h4>
<p>UniAppåˆ©ç”¨WebViewä½œä¸ºè¿è¡Œç¯å¢ƒï¼Œå°†Vueä»£ç ç¼–è¯‘æˆå¯åœ¨WebViewä¸­è¿è¡Œçš„HTML/CSS/JavaScriptä»£ç ï¼Œç„¶åé€šè¿‡åŸç”Ÿå¤–å£³åŒ…è£…æˆè·¨å¹³å°åº”ç”¨ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// UniAppåº”ç”¨æ¶æ„ï¼ˆæ¦‚å¿µå›¾ï¼‰</span>
+------------------------------------------------------+
|                  <span class="hljs-title class_">UniApp</span>åº”ç”¨                          |
|  +----------------+  +----------------+  +---------+ |
|  |   <span class="hljs-title class_">Android</span>å¤–å£³  |  |    iOSå¤–å£³     |  | <span class="hljs-variable constant_">H5</span>å¤–å£³  | |
|  |                |  |                |  |         | |
|  |  +----------+  |  |  +----------+  |  |  æµè§ˆå™¨  | |
|  |  | <span class="hljs-title class_">WebView</span>  |  |  |  | <span class="hljs-title class_">WebView</span>  |  |  |         | |
|  |  +----------+  |  |  +----------+  |  |         | |
|  |       |         |  |       |         |  |         | |
|  |  +----------+  |  |  +----------+  |  |         | |
|  |  | <span class="hljs-title class_">UniApp</span>   |  |  |  | <span class="hljs-title class_">UniApp</span>   |  |  |  <span class="hljs-title class_">UniApp</span> | |
|  |  | è¿è¡Œæ—¶   |  |  |  | è¿è¡Œæ—¶   |  |  |  è¿è¡Œæ—¶ | |
|  |  +----------+  |  |  +----------+  |  |         | |
|  +----------------+  +----------------+  +---------+ |
+------------------------------------------------------+
</code></pre>
<h3 data-id="heading-4">äºŒã€WebViewå®¹å™¨çš„å·¥ä½œåŸç†</h3>
<h4 data-id="heading-5">2.1 æ¸²æŸ“æœºåˆ¶</h4>
<p>UniAppåœ¨WebViewå®¹å™¨ä¸­çš„æ¸²æŸ“è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// UniAppæ¸²æŸ“æµç¨‹ï¼ˆä¼ªä»£ç ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">renderUniApp</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// 1. Vueæ¨¡æ¿ç¼–è¯‘</span>
  <span class="hljs-keyword">const</span> template = <span class="hljs-title function_">compileVueTemplate</span>();
  
  <span class="hljs-comment">// 2. ç”Ÿæˆè™šæ‹ŸDOM</span>
  <span class="hljs-keyword">const</span> vdom = <span class="hljs-title function_">createVirtualDOM</span>(template);
  
  <span class="hljs-comment">// 3. è½¬æ¢ä¸ºçœŸå®DOM</span>
  <span class="hljs-keyword">const</span> dom = <span class="hljs-title function_">createRealDOM</span>(vdom);
  
  <span class="hljs-comment">// 4. WebViewæ¸²æŸ“DOM</span>
  webView.<span class="hljs-title function_">render</span>(dom);
  
  <span class="hljs-comment">// 5. åº”ç”¨æ ·å¼</span>
  <span class="hljs-title function_">applyCSSStyles</span>();
}
</code></pre>
<h4 data-id="heading-6">2.2 JavaScriptæ‰§è¡Œç¯å¢ƒ</h4>
<p>UniAppçš„JavaScriptä»£ç åœ¨WebViewçš„JavaScriptå¼•æ“ä¸­æ‰§è¡Œï¼Œä¸åŒå¹³å°ä½¿ç”¨ä¸åŒçš„å¼•æ“ï¼š</p>
<ul>
<li><strong>Android</strong>: é€šå¸¸ä½¿ç”¨V8å¼•æ“</li>
<li><strong>iOS</strong>: ä½¿ç”¨JavaScriptCore</li>
<li><strong>H5</strong>: ä½¿ç”¨æµè§ˆå™¨çš„JavaScriptå¼•æ“</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// UniApp JavaScriptæ‰§è¡Œç¯å¢ƒï¼ˆæ¦‚å¿µå›¾ï¼‰</span>
+---------------------------+
|      <span class="hljs-title class_">WebView</span>å®¹å™¨         |
|                           |
|  +---------------------+  |
|  |  <span class="hljs-title class_">JavaScript</span>å¼•æ“      |  |
|  |                     |  |
|  |  +-----------------+ |  |
|  |  |   <span class="hljs-title class_">UniApp</span>æ¡†æ¶    | |  |
|  |  |                 | |  |
|  |  |  +-------------+ | |  |
|  |  |  |   <span class="hljs-title class_">Vue</span>ä»£ç    | | |  |
|  |  |  +-------------+ | |  |
|  |  |                 | |  |
|  |  |  +-------------+ | |  |
|  |  |  |   <span class="hljs-variable constant_">API</span>æ¡¥æ¥   | | |  |
|  |  |  +-------------+ | |  |
|  |  +-----------------+ |  |
|  +---------------------+  |
+---------------------------+
</code></pre>
<h4 data-id="heading-7">2.3 åŸç”Ÿèƒ½åŠ›æ¡¥æ¥</h4>
<p>UniAppé€šè¿‡æ¡¥æ¥æœºåˆ¶å®ç°JavaScriptä¸åŸç”ŸåŠŸèƒ½çš„äº¤äº’ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// UniAppåŸç”Ÿæ¡¥æ¥æœºåˆ¶ï¼ˆç®€åŒ–ç‰ˆï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UniBridge</span> {
  <span class="hljs-comment">// è°ƒç”¨åŸç”ŸåŠŸèƒ½</span>
  <span class="hljs-title function_">callNative</span>(<span class="hljs-params">api, params, callback</span>) {
    <span class="hljs-comment">// 1. å°†è°ƒç”¨å‚æ•°åºåˆ—åŒ–</span>
    <span class="hljs-keyword">const</span> message = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
      <span class="hljs-attr">api</span>: api,
      <span class="hljs-attr">params</span>: params,
      <span class="hljs-attr">callbackId</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateCallbackId</span>()
    });
    
    <span class="hljs-comment">// 2. é€šè¿‡WebViewæ¥å£å‘é€æ¶ˆæ¯åˆ°åŸç”Ÿ</span>
    <span class="hljs-keyword">if</span> (isAndroid) {
      androidInterface.<span class="hljs-title function_">postMessage</span>(message);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isIOS) {
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">webkit</span>.<span class="hljs-property">messageHandlers</span>.<span class="hljs-property">iosInterface</span>.<span class="hljs-title function_">postMessage</span>(message);
    }
    
    <span class="hljs-comment">// 3. æ³¨å†Œå›è°ƒå‡½æ•°</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">registerCallback</span>(callbackId, callback);
  }
  
  <span class="hljs-comment">// æ¥æ”¶åŸç”Ÿå›è°ƒ</span>
  <span class="hljs-title function_">onNativeCallback</span>(<span class="hljs-params">callbackId, result</span>) {
    <span class="hljs-keyword">const</span> callback = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getCallback</span>(callbackId);
    <span class="hljs-keyword">if</span> (callback) {
      <span class="hljs-title function_">callback</span>(result);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">unregisterCallback</span>(callbackId);
    }
  }
}
</code></pre>
<h3 data-id="heading-8">ä¸‰ã€WebViewå®¹å™¨çš„ä¼˜åŠ¿</h3>
<h4 data-id="heading-9">3.1 è·¨å¹³å°èƒ½åŠ›</h4>
<p>WebViewå®¹å™¨æ˜¯æ‰€æœ‰ç°ä»£ç§»åŠ¨æ“ä½œç³»ç»Ÿéƒ½æä¾›çš„æ ‡å‡†ç»„ä»¶ï¼Œè¿™ä½¿å¾—UniAppèƒ½å¤Ÿå®ç°çœŸæ­£çš„"ä¸€æ¬¡å¼€å‘ï¼Œå¤šç«¯è¿è¡Œ"ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è·¨å¹³å°ä»£ç ç¤ºä¾‹</span>
<span class="hljs-comment">// è¿™æ®µä»£ç å¯ä»¥åœ¨Androidã€iOSå’ŒH5ç¯å¢ƒä¸­è¿è¡Œ</span>
uni.<span class="hljs-title function_">showToast</span>({
  <span class="hljs-attr">title</span>: <span class="hljs-string">'æç¤ºä¿¡æ¯'</span>,
  <span class="hljs-attr">icon</span>: <span class="hljs-string">'none'</span>,
  <span class="hljs-attr">duration</span>: <span class="hljs-number">2000</span>
});

<span class="hljs-comment">// UniAppç¼–è¯‘åçš„ä»£ç ï¼ˆç®€åŒ–ç‰ˆï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">showToast</span>(<span class="hljs-params">options</span>) {
  <span class="hljs-comment">// æ ¹æ®å¹³å°è°ƒç”¨ä¸åŒçš„å®ç°</span>
  <span class="hljs-keyword">if</span> (platform === <span class="hljs-string">'android'</span>) {
    <span class="hljs-comment">// é€šè¿‡æ¡¥æ¥è°ƒç”¨AndroidåŸç”ŸToast</span>
    <span class="hljs-title class_">UniBridge</span>.<span class="hljs-title function_">callNative</span>(<span class="hljs-string">'showToast'</span>, options);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (platform === <span class="hljs-string">'ios'</span>) {
    <span class="hljs-comment">// é€šè¿‡æ¡¥æ¥è°ƒç”¨iOSåŸç”ŸToast</span>
    <span class="hljs-title class_">UniBridge</span>.<span class="hljs-title function_">callNative</span>(<span class="hljs-string">'showToast'</span>, options);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// H5ç¯å¢ƒä½¿ç”¨Webå®ç°</span>
    <span class="hljs-keyword">const</span> toast = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
    toast.<span class="hljs-property">textContent</span> = options.<span class="hljs-property">title</span>;
    toast.<span class="hljs-property">className</span> = <span class="hljs-string">'uni-toast'</span>;
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(toast);
    
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">removeChild</span>(toast);
    }, options.<span class="hljs-property">duration</span>);
  }
}
</code></pre>
<h4 data-id="heading-10">3.2 å¼€å‘æ•ˆç‡</h4>
<p>åŸºäºWebViewçš„å¼€å‘æ¨¡å¼å…è®¸å¼€å‘è€…ä½¿ç”¨WebæŠ€æœ¯æ ˆï¼Œå¤§å¤§æé«˜äº†å¼€å‘æ•ˆç‡ï¼š</p>
<ul>
<li><strong>ç†Ÿæ‚‰çš„å¼€å‘è¯­è¨€</strong>: HTML/CSS/JavaScript</li>
<li><strong>ä¸°å¯Œçš„ç”Ÿæ€ç³»ç»Ÿ</strong>: NPMåŒ…ã€å‰ç«¯æ¡†æ¶ç­‰</li>
<li><strong>çƒ­æ›´æ–°èƒ½åŠ›</strong>: æ— éœ€é‡æ–°å®‰è£…åº”ç”¨å³å¯æ›´æ–°ä»£ç </li>
<li><strong>è°ƒè¯•ä¾¿åˆ©</strong>: å¯ä»¥ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·è¿›è¡Œè°ƒè¯•</li>
</ul>
<h4 data-id="heading-11">3.3 æˆæœ¬ä¼˜åŠ¿</h4>
<ul>
<li><strong>äººåŠ›æˆæœ¬</strong>: ä¸€å¥—ä»£ç å¤šç«¯è¿è¡Œï¼Œå‡å°‘å¼€å‘äººå‘˜æ•°é‡</li>
<li><strong>æ—¶é—´æˆæœ¬</strong>: åŒæ—¶å‘å¸ƒåˆ°å¤šä¸ªå¹³å°ï¼Œç¼©çŸ­å¼€å‘å‘¨æœŸ</li>
<li><strong>ç»´æŠ¤æˆæœ¬</strong>: ç»Ÿä¸€ä»£ç åº“ï¼Œé™ä½ç»´æŠ¤å¤æ‚åº¦</li>
</ul>
<h3 data-id="heading-12">å››ã€WebViewå®¹å™¨çš„å±€é™æ€§</h3>
<h4 data-id="heading-13">4.1 æ€§èƒ½é™åˆ¶</h4>
<p>WebViewå®¹å™¨çš„æ€§èƒ½ç›¸æ¯”åŸç”Ÿåº”ç”¨æœ‰ä¸€å®šå·®è·ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ€§èƒ½å¯¹æ¯”ï¼ˆæ¦‚å¿µæ•°æ®ï¼‰</span>
<span class="hljs-keyword">const</span> performanceComparison = {
  <span class="hljs-string">'åŸç”Ÿåº”ç”¨'</span>: {
    <span class="hljs-string">'å¯åŠ¨é€Ÿåº¦'</span>: <span class="hljs-string">'100%'</span>,
    <span class="hljs-string">'æ¸²æŸ“æ€§èƒ½'</span>: <span class="hljs-string">'100%'</span>,
    <span class="hljs-string">'å†…å­˜å ç”¨'</span>: <span class="hljs-string">'100%'</span>,
    <span class="hljs-string">'CPUä½¿ç”¨'</span>: <span class="hljs-string">'100%'</span>
  },
  <span class="hljs-string">'WebViewåº”ç”¨'</span>: {
    <span class="hljs-string">'å¯åŠ¨é€Ÿåº¦'</span>: <span class="hljs-string">'70-80%'</span>,
    <span class="hljs-string">'æ¸²æŸ“æ€§èƒ½'</span>: <span class="hljs-string">'60-80%'</span>,
    <span class="hljs-string">'å†…å­˜å ç”¨'</span>: <span class="hljs-string">'120-150%'</span>,
    <span class="hljs-string">'CPUä½¿ç”¨'</span>: <span class="hljs-string">'110-130%'</span>
  }
};
</code></pre>
<h4 data-id="heading-14">4.2 åŠŸèƒ½é™åˆ¶</h4>
<p>æŸäº›åŸç”ŸåŠŸèƒ½åœ¨WebViewä¸­éš¾ä»¥å®ç°æˆ–æ€§èƒ½ä¸ä½³ï¼š</p>
<ul>
<li><strong>å¤æ‚åŠ¨ç”»</strong>: CSSåŠ¨ç”»å’ŒJavaScriptåŠ¨ç”»æ€§èƒ½ä¸å¦‚åŸç”ŸåŠ¨ç”»</li>
<li><strong>å¤§é‡æ•°æ®å¤„ç†</strong>: JavaScriptå¤„ç†å¤§æ•°æ®çš„èƒ½åŠ›æœ‰é™</li>
<li><strong>å›¾å½¢æ¸²æŸ“</strong>: å¤æ‚å›¾å½¢å’Œæ¸¸æˆæ¸²æŸ“æ€§èƒ½ä¸è¶³</li>
<li><strong>åå°ä»»åŠ¡</strong>: WebViewåœ¨åå°æ—¶æ‰§è¡Œèƒ½åŠ›å—é™</li>
</ul>
<h4 data-id="heading-15">4.3 å¹³å°å·®å¼‚</h4>
<p>å°½ç®¡WebViewæ˜¯æ ‡å‡†ç»„ä»¶ï¼Œä½†ä¸åŒå¹³å°çš„å®ç°ä»æœ‰å·®å¼‚ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¹³å°å·®å¼‚ç¤ºä¾‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handlePlatformDifferences</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// Android WebViewç‰¹æœ‰é—®é¢˜</span>
  <span class="hljs-keyword">if</span> (isAndroid) {
    <span class="hljs-comment">// å¤„ç†Android WebViewçš„å…¼å®¹æ€§é—®é¢˜</span>
    <span class="hljs-title function_">fixAndroidWebViewIssues</span>();
  }
  
  <span class="hljs-comment">// iOS WebViewç‰¹æœ‰é—®é¢˜</span>
  <span class="hljs-keyword">if</span> (isIOS) {
    <span class="hljs-comment">// å¤„ç†iOS WebViewçš„å…¼å®¹æ€§é—®é¢˜</span>
    <span class="hljs-title function_">fixIOSWebViewIssues</span>();
  }
  
  <span class="hljs-comment">// ä¸åŒç‰ˆæœ¬çš„WebViewä¹Ÿæœ‰å·®å¼‚</span>
  <span class="hljs-title function_">handleWebViewVersionDifferences</span>();
}
</code></pre>
<h3 data-id="heading-16">äº”ã€UniAppå¯¹WebViewå®¹å™¨çš„ä¼˜åŒ–</h3>
<h4 data-id="heading-17">5.1 æ¸²æŸ“ä¼˜åŒ–</h4>
<p>UniAppé€šè¿‡å¤šç§æ–¹å¼ä¼˜åŒ–WebViewçš„æ¸²æŸ“æ€§èƒ½ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¸²æŸ“ä¼˜åŒ–ç­–ç•¥</span>
<span class="hljs-keyword">const</span> renderingOptimizations = {
  <span class="hljs-comment">// 1. è™šæ‹Ÿåˆ—è¡¨</span>
  <span class="hljs-attr">virtualList</span>: {
    <span class="hljs-attr">description</span>: <span class="hljs-string">'åªæ¸²æŸ“å¯è§†åŒºåŸŸå†…çš„å…ƒç´ '</span>,
    <span class="hljs-attr">implementation</span>: <span class="hljs-string">'ä½¿ç”¨uni-listç»„ä»¶å®ç°è™šæ‹Ÿæ»šåŠ¨'</span>
  },
  
  <span class="hljs-comment">// 2. æ‡’åŠ è½½</span>
  <span class="hljs-attr">lazyLoading</span>: {
    <span class="hljs-attr">description</span>: <span class="hljs-string">'å»¶è¿ŸåŠ è½½éå…³é”®èµ„æº'</span>,
    <span class="hljs-attr">implementation</span>: <span class="hljs-string">'ä½¿ç”¨uni.lazyLoadå›¾ç‰‡æ‡’åŠ è½½'</span>
  },
  
  <span class="hljs-comment">// 3. å‡å°‘é‡æ’é‡ç»˜</span>
  <span class="hljs-attr">reduceReflow</span>: {
    <span class="hljs-attr">description</span>: <span class="hljs-string">'æ‰¹é‡æ›´æ–°DOMï¼Œå‡å°‘é‡æ’é‡ç»˜'</span>,
    <span class="hljs-attr">implementation</span>: <span class="hljs-string">'ä½¿ç”¨setDataæ‰¹é‡æ›´æ–°æ•°æ®'</span>
  },
  
  <span class="hljs-comment">// 4. CSSä¼˜åŒ–</span>
  <span class="hljs-attr">cssOptimization</span>: {
    <span class="hljs-attr">description</span>: <span class="hljs-string">'ä½¿ç”¨é«˜æ•ˆçš„CSSé€‰æ‹©å™¨å’Œå±æ€§'</span>,
    <span class="hljs-attr">implementation</span>: <span class="hljs-string">'é¿å…å¤æ‚é€‰æ‹©å™¨ï¼Œä½¿ç”¨transformå’Œopacity'</span>
  }
};
</code></pre>
<h4 data-id="heading-18">5.2 å†…å­˜ç®¡ç†</h4>
<p>é’ˆå¯¹WebViewå†…å­˜å ç”¨é«˜çš„é—®é¢˜ï¼ŒUniAppæä¾›äº†å¤šç§ä¼˜åŒ–æ–¹æ¡ˆï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å†…å­˜ç®¡ç†ä¼˜åŒ–</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">optimizeMemoryUsage</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// 1. åŠæ—¶é‡Šæ”¾èµ„æº</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">cleanupResources</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// æ¸…ç†ä¸å†ä½¿ç”¨çš„å¯¹è±¡</span>
    unusedObjects = <span class="hljs-literal">null</span>;
    
    <span class="hljs-comment">// å–æ¶ˆæœªå®Œæˆçš„ç½‘ç»œè¯·æ±‚</span>
    <span class="hljs-title function_">cancelPendingRequests</span>();
    
    <span class="hljs-comment">// ç§»é™¤äº‹ä»¶ç›‘å¬å™¨</span>
    <span class="hljs-title function_">removeEventListeners</span>();
  }
  
  <span class="hljs-comment">// 2. å›¾ç‰‡å†…å­˜ä¼˜åŒ–</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">optimizeImageMemory</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ä½¿ç”¨é€‚å½“çš„å›¾ç‰‡æ ¼å¼å’Œå°ºå¯¸</span>
    <span class="hljs-title function_">useOptimizedImageFormat</span>();
    
    <span class="hljs-comment">// åŠæ—¶é‡Šæ”¾å›¾ç‰‡èµ„æº</span>
    <span class="hljs-title function_">releaseImageResources</span>();
  }
  
  <span class="hljs-comment">// 3. æ•°æ®ç¼“å­˜ä¼˜åŒ–</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">optimizeDataCache</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// é™åˆ¶ç¼“å­˜å¤§å°</span>
    <span class="hljs-title function_">limitCacheSize</span>();
    
    <span class="hljs-comment">// ä½¿ç”¨LRUç¼“å­˜ç­–ç•¥</span>
    <span class="hljs-title function_">implementLRUCache</span>();
  }
}
</code></pre>
<h4 data-id="heading-19">5.3 åŸç”Ÿèƒ½åŠ›å¢å¼º</h4>
<p>UniAppé€šè¿‡åŸç”Ÿæ’ä»¶æœºåˆ¶å¼¥è¡¥WebViewçš„åŠŸèƒ½é™åˆ¶ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŸç”Ÿæ’ä»¶æœºåˆ¶ï¼ˆæ¦‚å¿µå›¾ï¼‰</span>
+------------------------------------------------------+
|                  <span class="hljs-title class_">UniApp</span>åº”ç”¨                          |
|  +----------------+  +----------------+  +---------+ |
|  |   <span class="hljs-title class_">Android</span>å¤–å£³  |  |    iOSå¤–å£³     |  | <span class="hljs-variable constant_">H5</span>å¤–å£³  | |
|  |                |  |                |  |         | |
|  |  +----------+  |  |  +----------+  |  |  æµè§ˆå™¨  | |
|  |  | <span class="hljs-title class_">WebView</span>  |  |  |  | <span class="hljs-title class_">WebView</span>  |  |  |         | |
|  |  +----------+  |  |  +----------+  |  |         | |
|  |       |         |  |       |         |  |         | |
|  |  +----------+  |  |  +----------+  |  |         | |
|  |  | <span class="hljs-title class_">UniApp</span>   |  |  |  | <span class="hljs-title class_">UniApp</span>   |  |  |  <span class="hljs-title class_">UniApp</span> | |
|  |  | è¿è¡Œæ—¶   |  |  |  | è¿è¡Œæ—¶   |  |  |  è¿è¡Œæ—¶ | |
|  |  +----+-----+  |  |  +----+-----+  |  |         | |
|  |       |         |  |       |         |  |         | |
|  |  +----v-----+  |  |  +----v-----+  |  |         | |
|  |  | åŸç”Ÿæ’ä»¶  |  |  |  | åŸç”Ÿæ’ä»¶  |  |  |         | |
|  |  +----------+  |  |  +----------+  |  |         | |
|  +----------------+  +----------------+  +---------+ |
+------------------------------------------------------+
</code></pre>
<h3 data-id="heading-20">å…­ã€æ€»ç»“</h3>
<p>"uniapp ä¸»è¦æ˜¯è¿è¡Œåœ¨webviewå®¹å™¨ä¸­çš„"è¿™å¥è¯æ­ç¤ºäº†UniAppçš„æ ¸å¿ƒæ¶æ„åŸç†ã€‚é€šè¿‡WebViewå®¹å™¨ï¼ŒUniAppå®ç°äº†è·¨å¹³å°èƒ½åŠ›ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿä½¿ç”¨WebæŠ€æœ¯æ ˆå¼€å‘ç§»åŠ¨åº”ç”¨ã€‚è¿™ç§æ¶æ„æ—¢æœ‰ä¼˜åŠ¿ï¼ˆè·¨å¹³å°ã€å¼€å‘æ•ˆç‡é«˜ã€æˆæœ¬ä½ï¼‰ï¼Œä¹Ÿæœ‰å±€é™æ€§ï¼ˆæ€§èƒ½é™åˆ¶ã€åŠŸèƒ½é™åˆ¶ã€å¹³å°å·®å¼‚ï¼‰ã€‚</p>
<p>UniAppé€šè¿‡æ¸²æŸ“ä¼˜åŒ–ã€å†…å­˜ç®¡ç†å’ŒåŸç”Ÿæ’ä»¶ç­‰æ–¹å¼ï¼Œä¸æ–­å¼¥è¡¥WebViewå®¹å™¨çš„ä¸è¶³ï¼Œæå‡åº”ç”¨æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚ç†è§£WebViewå®¹å™¨çš„å·¥ä½œåŸç†ï¼Œæœ‰åŠ©äºå¼€å‘è€…æ›´å¥½åœ°ä½¿ç”¨UniAppæ¡†æ¶ï¼Œå¼€å‘å‡ºé«˜è´¨é‡çš„è·¨å¹³å°åº”ç”¨ã€‚</p>
<p>å¯¹äºç‰©æµå…ƒå®‡å®™PDAé¡¹ç›®è¿™æ ·çš„åº”ç”¨ï¼Œç†è§£WebViewå®¹å™¨çš„åŸç†å°¤ä¸ºé‡è¦ï¼Œå› ä¸ºPDAè®¾å¤‡é€šå¸¸èµ„æºæœ‰é™ï¼Œéœ€è¦ç‰¹åˆ«å…³æ³¨å†…å­˜å ç”¨å’Œæ€§èƒ½ä¼˜åŒ–ã€‚é€šè¿‡åˆç†ä½¿ç”¨UniAppæä¾›çš„ä¼˜åŒ–æ–¹æ¡ˆï¼Œå¯ä»¥åœ¨WebViewå®¹å™¨ä¸­å®ç°æµç•…çš„ç”¨æˆ·ä½“éªŒï¼ŒåŒæ—¶ä¿æŒè·¨å¹³å°çš„ä¼˜åŠ¿ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[DeepSeekå°åº¦è‚¡ç¥¨æ•°æ®æº Java å¯¹æ¥æ–‡æ¡£]]></title>    <link>https://juejin.cn/post/7570902804450312202</link>    <guid>https://juejin.cn/post/7570902804450312202</guid>    <pubDate>2025-11-10T08:32:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570902804450312202" data-draft-id="7570579125154922506" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="DeepSeekå°åº¦è‚¡ç¥¨æ•°æ®æº Java å¯¹æ¥æ–‡æ¡£"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯"/> <meta itemprop="datePublished" content="2025-11-10T08:32:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="CryptoRzz"/> <meta itemprop="url" content="https://juejin.cn/user/402879809850410"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            DeepSeekå°åº¦è‚¡ç¥¨æ•°æ®æº Java å¯¹æ¥æ–‡æ¡£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/402879809850410/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    CryptoRzz
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T08:32:42.000Z" title="Mon Nov 10 2025 08:32:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ“‹ æ–‡æ¡£æ¦‚è¿°</h2>
<p>æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨ Java è¯­è¨€å¯¹æ¥ StockTV å°åº¦è‚¡ç¥¨æ•°æ®æºï¼ŒåŒ…å«å®Œæ•´çš„ä»£ç ç¤ºä¾‹ã€æ•°æ®æ¨¡å‹ã€å¼‚å¸¸å¤„ç†ç­‰ã€‚</p>
<h2 data-id="heading-1">ğŸš€ å¿«é€Ÿå¼€å§‹</h2>
<h3 data-id="heading-2">ç¯å¢ƒè¦æ±‚</h3>
<ul>
<li>JDK 8+</li>
<li>Maven 3.6+</li>
<li>ç½‘ç»œè¿æ¥ï¼ˆå¯è®¿é—® <code>api.stocktv.top</code>ï¼‰</li>
</ul>
<h3 data-id="heading-3">é¡¹ç›®ä¾èµ–</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- pom.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- HTTPå®¢æˆ·ç«¯ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.httpcomponents<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>httpclient<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.5.14<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- JSONå¤„ç† --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jackson-databind<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.15.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- æ—¥å¿—æ¡†æ¶ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.7<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-simple<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.7<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- Lombokï¼ˆå¯é€‰ï¼‰ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.18.28<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>provided<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h2 data-id="heading-4">ğŸ—ï¸ æ ¸å¿ƒæ¶æ„</h2>
<h3 data-id="heading-5">é¡¹ç›®ç»“æ„</h3>
<pre><code class="hljs language-css" lang="css"><span class="hljs-attribute">src</span>/<span class="hljs-selector-tag">main</span>/java/com/stocktv/india/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ StockTVConfig<span class="hljs-selector-class">.java</span>
â”œâ”€â”€ model/
â”‚   â”œâ”€â”€ Stock<span class="hljs-selector-class">.java</span>
â”‚   â”œâ”€â”€ Index<span class="hljs-selector-class">.java</span>
â”‚   â”œâ”€â”€ KLine<span class="hljs-selector-class">.java</span>
â”‚   â””â”€â”€ ApiResponse<span class="hljs-selector-class">.java</span>
â”œâ”€â”€ client/
â”‚   â”œâ”€â”€ StockTVHttpClient<span class="hljs-selector-class">.java</span>
â”‚   â””â”€â”€ StockTVWebSocketClient<span class="hljs-selector-class">.java</span>
â”œâ”€â”€ service/
â”‚   â””â”€â”€ IndiaStockService<span class="hljs-selector-class">.java</span>
â””â”€â”€ demo/
    â””â”€â”€ IndiaStockDemo<span class="hljs-selector-class">.java</span>
</code></pre>
<h2 data-id="heading-6">ğŸ“¦ æ ¸å¿ƒä»£ç å®ç°</h2>
<h3 data-id="heading-7">1. é…ç½®ç±»</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.stocktv.india.config;

<span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;
<span class="hljs-keyword">import</span> org.apache.http.impl.client.CloseableHttpClient;
<span class="hljs-keyword">import</span> org.apache.http.impl.client.HttpClients;

<span class="hljs-comment">/**
 * StockTV API é…ç½®ç±»
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StockTVConfig</span> {
    
    <span class="hljs-comment">// API åŸºç¡€é…ç½®</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">BASE_URL</span> <span class="hljs-operator">=</span> <span class="hljs-string">"https://api.stocktv.top"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">WS_URL</span> <span class="hljs-operator">=</span> <span class="hljs-string">"wss://ws-api.stocktv.top/connect"</span>;
    
    <span class="hljs-comment">// å°åº¦å¸‚åœºé…ç½®</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">INDIA_COUNTRY_ID</span> <span class="hljs-operator">=</span> <span class="hljs-number">14</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">NSE_EXCHANGE_ID</span> <span class="hljs-operator">=</span> <span class="hljs-number">46</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">BSE_EXCHANGE_ID</span> <span class="hljs-operator">=</span> <span class="hljs-number">74</span>;
    
    <span class="hljs-comment">// API Key</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String apiKey;
    
    <span class="hljs-comment">// HTTP å®¢æˆ·ç«¯å’ŒJSONå¤„ç†å™¨</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> CloseableHttpClient httpClient;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ObjectMapper objectMapper;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">StockTVConfig</span><span class="hljs-params">(String apiKey)</span> {
        <span class="hljs-built_in">this</span>.apiKey = apiKey;
        <span class="hljs-built_in">this</span>.httpClient = HttpClients.createDefault();
        <span class="hljs-built_in">this</span>.objectMapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectMapper</span>();
        <span class="hljs-comment">// é…ç½®ObjectMapper</span>
        <span class="hljs-built_in">this</span>.objectMapper.findAndRegisterModules();
    }
    
    <span class="hljs-comment">// Getteræ–¹æ³•</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getApiKey</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> apiKey; }
    <span class="hljs-keyword">public</span> CloseableHttpClient <span class="hljs-title function_">getHttpClient</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> httpClient; }
    <span class="hljs-keyword">public</span> ObjectMapper <span class="hljs-title function_">getObjectMapper</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> objectMapper; }
}
</code></pre>
<h3 data-id="heading-8">2. æ•°æ®æ¨¡å‹ç±»</h3>
<h4 data-id="heading-9">è‚¡ç¥¨æ•°æ®æ¨¡å‹</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.stocktv.india.model;

<span class="hljs-keyword">import</span> com.fasterxml.jackson.annotation.JsonProperty;
<span class="hljs-keyword">import</span> lombok.Data;

<span class="hljs-keyword">import</span> java.math.BigDecimal;
<span class="hljs-keyword">import</span> java.time.Instant;
<span class="hljs-keyword">import</span> java.time.LocalDateTime;
<span class="hljs-keyword">import</span> java.time.ZoneId;

<span class="hljs-comment">/**
 * å°åº¦è‚¡ç¥¨æ•°æ®æ¨¡å‹
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Stock</span> {
    <span class="hljs-meta">@JsonProperty("id")</span>
    <span class="hljs-keyword">private</span> Long id;
    
    <span class="hljs-meta">@JsonProperty("symbol")</span>
    <span class="hljs-keyword">private</span> String symbol;
    
    <span class="hljs-meta">@JsonProperty("name")</span>
    <span class="hljs-keyword">private</span> String name;
    
    <span class="hljs-meta">@JsonProperty("last")</span>
    <span class="hljs-keyword">private</span> BigDecimal lastPrice;
    
    <span class="hljs-meta">@JsonProperty("chg")</span>
    <span class="hljs-keyword">private</span> BigDecimal change;
    
    <span class="hljs-meta">@JsonProperty("chgPct")</span>
    <span class="hljs-keyword">private</span> BigDecimal changePercent;
    
    <span class="hljs-meta">@JsonProperty("high")</span>
    <span class="hljs-keyword">private</span> BigDecimal high;
    
    <span class="hljs-meta">@JsonProperty("low")</span>
    <span class="hljs-keyword">private</span> BigDecimal low;
    
    <span class="hljs-meta">@JsonProperty("volume")</span>
    <span class="hljs-keyword">private</span> Long volume;
    
    <span class="hljs-meta">@JsonProperty("open")</span>
    <span class="hljs-keyword">private</span> Boolean isOpen;
    
    <span class="hljs-meta">@JsonProperty("exchangeId")</span>
    <span class="hljs-keyword">private</span> Integer exchangeId;
    
    <span class="hljs-meta">@JsonProperty("countryId")</span>
    <span class="hljs-keyword">private</span> Integer countryId;
    
    <span class="hljs-meta">@JsonProperty("time")</span>
    <span class="hljs-keyword">private</span> Long timestamp;
    
    <span class="hljs-meta">@JsonProperty("fundamentalMarketCap")</span>
    <span class="hljs-keyword">private</span> BigDecimal marketCap;
    
    <span class="hljs-meta">@JsonProperty("fundamentalRevenue")</span>
    <span class="hljs-keyword">private</span> String revenue;
    
    <span class="hljs-comment">// æŠ€æœ¯æŒ‡æ ‡</span>
    <span class="hljs-meta">@JsonProperty("technicalDay")</span>
    <span class="hljs-keyword">private</span> String technicalDay;
    
    <span class="hljs-meta">@JsonProperty("technicalHour")</span>
    <span class="hljs-keyword">private</span> String technicalHour;
    
    <span class="hljs-meta">@JsonProperty("technicalWeek")</span>
    <span class="hljs-keyword">private</span> String technicalWeek;
    
    <span class="hljs-meta">@JsonProperty("technicalMonth")</span>
    <span class="hljs-keyword">private</span> String technicalMonth;
    
    <span class="hljs-comment">// æ€§èƒ½æŒ‡æ ‡</span>
    <span class="hljs-meta">@JsonProperty("performanceDay")</span>
    <span class="hljs-keyword">private</span> BigDecimal performanceDay;
    
    <span class="hljs-meta">@JsonProperty("performanceWeek")</span>
    <span class="hljs-keyword">private</span> BigDecimal performanceWeek;
    
    <span class="hljs-meta">@JsonProperty("performanceMonth")</span>
    <span class="hljs-keyword">private</span> BigDecimal performanceMonth;
    
    <span class="hljs-meta">@JsonProperty("performanceYtd")</span>
    <span class="hljs-keyword">private</span> BigDecimal performanceYtd;
    
    <span class="hljs-comment">/**
     * è·å–æ ¼å¼åŒ–çš„æ—¶é—´
     */</span>
    <span class="hljs-keyword">public</span> LocalDateTime <span class="hljs-title function_">getFormattedTime</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> LocalDateTime.ofInstant(Instant.ofEpochSecond(timestamp), ZoneId.systemDefault());
    }
    
    <span class="hljs-comment">/**
     * è·å–äº¤æ˜“æ‰€åç§°
     */</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getExchangeName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (NSE_EXCHANGE_ID == exchangeId) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">"NSE"</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (BSE_EXCHANGE_ID == exchangeId) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">"BSE"</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Unknown"</span>;
    }
}

<span class="hljs-comment">// å¸¸é‡æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ExchangeConstants</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">NSE_EXCHANGE_ID</span> <span class="hljs-operator">=</span> <span class="hljs-number">46</span>;
    <span class="hljs-type">int</span> <span class="hljs-variable">BSE_EXCHANGE_ID</span> <span class="hljs-operator">=</span> <span class="hljs-number">74</span>;
}
</code></pre>
<h4 data-id="heading-10">Kçº¿æ•°æ®æ¨¡å‹</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.stocktv.india.model;

<span class="hljs-keyword">import</span> com.fasterxml.jackson.annotation.JsonProperty;
<span class="hljs-keyword">import</span> lombok.Data;

<span class="hljs-keyword">import</span> java.math.BigDecimal;
<span class="hljs-keyword">import</span> java.time.Instant;
<span class="hljs-keyword">import</span> java.time.LocalDateTime;
<span class="hljs-keyword">import</span> java.time.ZoneId;

<span class="hljs-comment">/**
 * Kçº¿æ•°æ®æ¨¡å‹
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">KLine</span> {
    <span class="hljs-meta">@JsonProperty("time")</span>
    <span class="hljs-keyword">private</span> Long timestamp;
    
    <span class="hljs-meta">@JsonProperty("open")</span>
    <span class="hljs-keyword">private</span> BigDecimal open;
    
    <span class="hljs-meta">@JsonProperty("high")</span>
    <span class="hljs-keyword">private</span> BigDecimal high;
    
    <span class="hljs-meta">@JsonProperty("low")</span>
    <span class="hljs-keyword">private</span> BigDecimal low;
    
    <span class="hljs-meta">@JsonProperty("close")</span>
    <span class="hljs-keyword">private</span> BigDecimal close;
    
    <span class="hljs-meta">@JsonProperty("volume")</span>
    <span class="hljs-keyword">private</span> Long volume;
    
    <span class="hljs-meta">@JsonProperty("vo")</span>
    <span class="hljs-keyword">private</span> BigDecimal turnover;
    
    <span class="hljs-comment">/**
     * è·å–æ ¼å¼åŒ–çš„æ—¶é—´
     */</span>
    <span class="hljs-keyword">public</span> LocalDateTime <span class="hljs-title function_">getFormattedTime</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> LocalDateTime.ofInstant(Instant.ofEpochMilli(timestamp), ZoneId.systemDefault());
    }
    
    <span class="hljs-comment">/**
     * è®¡ç®—æŒ¯å¹…
     */</span>
    <span class="hljs-keyword">public</span> BigDecimal <span class="hljs-title function_">getAmplitude</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (open == <span class="hljs-literal">null</span> || open.compareTo(BigDecimal.ZERO) == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> BigDecimal.ZERO;
        }
        <span class="hljs-keyword">return</span> high.subtract(low).divide(open, <span class="hljs-number">4</span>, BigDecimal.ROUND_HALF_UP);
    }
}
</code></pre>
<h4 data-id="heading-11">æŒ‡æ•°æ•°æ®æ¨¡å‹</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.stocktv.india.model;

<span class="hljs-keyword">import</span> com.fasterxml.jackson.annotation.JsonProperty;
<span class="hljs-keyword">import</span> lombok.Data;

<span class="hljs-keyword">import</span> java.math.BigDecimal;
<span class="hljs-keyword">import</span> java.time.Instant;
<span class="hljs-keyword">import</span> java.time.LocalDateTime;
<span class="hljs-keyword">import</span> java.time.ZoneId;

<span class="hljs-comment">/**
 * æŒ‡æ•°æ•°æ®æ¨¡å‹
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Index</span> {
    <span class="hljs-meta">@JsonProperty("id")</span>
    <span class="hljs-keyword">private</span> Long id;
    
    <span class="hljs-meta">@JsonProperty("name")</span>
    <span class="hljs-keyword">private</span> String name;
    
    <span class="hljs-meta">@JsonProperty("symbol")</span>
    <span class="hljs-keyword">private</span> String symbol;
    
    <span class="hljs-meta">@JsonProperty("last")</span>
    <span class="hljs-keyword">private</span> BigDecimal lastPrice;
    
    <span class="hljs-meta">@JsonProperty("chg")</span>
    <span class="hljs-keyword">private</span> BigDecimal change;
    
    <span class="hljs-meta">@JsonProperty("chgPct")</span>
    <span class="hljs-keyword">private</span> BigDecimal changePercent;
    
    <span class="hljs-meta">@JsonProperty("high")</span>
    <span class="hljs-keyword">private</span> BigDecimal high;
    
    <span class="hljs-meta">@JsonProperty("low")</span>
    <span class="hljs-keyword">private</span> BigDecimal low;
    
    <span class="hljs-meta">@JsonProperty("isOpen")</span>
    <span class="hljs-keyword">private</span> Boolean isOpen;
    
    <span class="hljs-meta">@JsonProperty("time")</span>
    <span class="hljs-keyword">private</span> Long timestamp;
    
    <span class="hljs-meta">@JsonProperty("flag")</span>
    <span class="hljs-keyword">private</span> String countryFlag;
    
    <span class="hljs-comment">/**
     * è·å–æ ¼å¼åŒ–çš„æ—¶é—´
     */</span>
    <span class="hljs-keyword">public</span> LocalDateTime <span class="hljs-title function_">getFormattedTime</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> LocalDateTime.ofInstant(Instant.ofEpochSecond(timestamp), ZoneId.systemDefault());
    }
}
</code></pre>
<h4 data-id="heading-12">APIå“åº”åŒ…è£…ç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.stocktv.india.model;

<span class="hljs-keyword">import</span> com.fasterxml.jackson.annotation.JsonProperty;
<span class="hljs-keyword">import</span> lombok.Data;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * APIé€šç”¨å“åº”åŒ…è£…ç±»
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ApiResponse</span>&lt;T&gt; {
    <span class="hljs-meta">@JsonProperty("code")</span>
    <span class="hljs-keyword">private</span> Integer code;
    
    <span class="hljs-meta">@JsonProperty("message")</span>
    <span class="hljs-keyword">private</span> String message;
    
    <span class="hljs-meta">@JsonProperty("data")</span>
    <span class="hljs-keyword">private</span> T data;
    
    <span class="hljs-comment">/**
     * åˆ¤æ–­è¯·æ±‚æ˜¯å¦æˆåŠŸ
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isSuccess</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> code != <span class="hljs-literal">null</span> &amp;&amp; code == <span class="hljs-number">200</span>;
    }
}

<span class="hljs-comment">/**
 * è‚¡ç¥¨åˆ—è¡¨å“åº”åŒ…è£…ç±»
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">StockListResponse</span> {
    <span class="hljs-meta">@JsonProperty("records")</span>
    <span class="hljs-keyword">private</span> List&lt;Stock&gt; records;
    
    <span class="hljs-meta">@JsonProperty("total")</span>
    <span class="hljs-keyword">private</span> Integer total;
    
    <span class="hljs-meta">@JsonProperty("current")</span>
    <span class="hljs-keyword">private</span> Integer current;
    
    <span class="hljs-meta">@JsonProperty("pages")</span>
    <span class="hljs-keyword">private</span> Integer pages;
    
    <span class="hljs-meta">@JsonProperty("size")</span>
    <span class="hljs-keyword">private</span> Integer size;
}
</code></pre>
<h3 data-id="heading-13">3. HTTPå®¢æˆ·ç«¯å®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.stocktv.india.client;

<span class="hljs-keyword">import</span> com.fasterxml.jackson.core.type.TypeReference;
<span class="hljs-keyword">import</span> com.stocktv.india.config.StockTVConfig;
<span class="hljs-keyword">import</span> com.stocktv.india.model.*;
<span class="hljs-keyword">import</span> org.apache.http.client.methods.CloseableHttpResponse;
<span class="hljs-keyword">import</span> org.apache.http.client.methods.HttpGet;
<span class="hljs-keyword">import</span> org.apache.http.client.utils.URIBuilder;
<span class="hljs-keyword">import</span> org.apache.http.impl.client.CloseableHttpClient;
<span class="hljs-keyword">import</span> org.apache.http.util.EntityUtils;
<span class="hljs-keyword">import</span> org.slf4j.Logger;
<span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;

<span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.net.URI;
<span class="hljs-keyword">import</span> java.net.URISyntaxException;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * StockTV HTTP APIå®¢æˆ·ç«¯
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StockTVHttpClient</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(StockTVHttpClient.class);
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> StockTVConfig config;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> CloseableHttpClient httpClient;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">StockTVHttpClient</span><span class="hljs-params">(StockTVConfig config)</span> {
        <span class="hljs-built_in">this</span>.config = config;
        <span class="hljs-built_in">this</span>.httpClient = config.getHttpClient();
    }
    
    <span class="hljs-comment">/**
     * è·å–å°åº¦è‚¡ç¥¨åˆ—è¡¨
     * 
     * <span class="hljs-doctag">@param</span> pageSize æ¯é¡µæ•°é‡
     * <span class="hljs-doctag">@param</span> page é¡µç 
     * <span class="hljs-doctag">@return</span> è‚¡ç¥¨åˆ—è¡¨
     */</span>
    <span class="hljs-keyword">public</span> List&lt;Stock&gt; <span class="hljs-title function_">getIndiaStocks</span><span class="hljs-params">(Integer pageSize, Integer page)</span> <span class="hljs-keyword">throws</span> IOException, URISyntaxException {
        <span class="hljs-type">URI</span> <span class="hljs-variable">uri</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">URIBuilder</span>(config.BASE_URL + <span class="hljs-string">"/stock/stocks"</span>)
                .addParameter(<span class="hljs-string">"countryId"</span>, String.valueOf(StockTVConfig.INDIA_COUNTRY_ID))
                .addParameter(<span class="hljs-string">"pageSize"</span>, String.valueOf(pageSize))
                .addParameter(<span class="hljs-string">"page"</span>, String.valueOf(page))
                .addParameter(<span class="hljs-string">"key"</span>, config.getApiKey())
                .build();
        
        ApiResponse&lt;StockListResponse&gt; response = executeGetRequest(uri, 
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeReference</span>&lt;ApiResponse&lt;StockListResponse&gt;&gt;() {});
        
        <span class="hljs-keyword">if</span> (response.isSuccess()) {
            logger.info(<span class="hljs-string">"æˆåŠŸè·å– {} æ¡å°åº¦è‚¡ç¥¨æ•°æ®"</span>, response.getData().getRecords().size());
            <span class="hljs-keyword">return</span> response.getData().getRecords();
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"APIè¯·æ±‚å¤±è´¥: "</span> + response.getMessage());
        }
    }
    
    <span class="hljs-comment">/**
     * æŸ¥è¯¢å•ä¸ªè‚¡ç¥¨
     * 
     * <span class="hljs-doctag">@param</span> pid è‚¡ç¥¨PID
     * <span class="hljs-doctag">@param</span> symbol è‚¡ç¥¨ä»£ç 
     * <span class="hljs-doctag">@param</span> name è‚¡ç¥¨åç§°
     * <span class="hljs-doctag">@return</span> è‚¡ç¥¨åˆ—è¡¨
     */</span>
    <span class="hljs-keyword">public</span> List&lt;Stock&gt; <span class="hljs-title function_">queryStock</span><span class="hljs-params">(Long pid, String symbol, String name)</span> <span class="hljs-keyword">throws</span> IOException, URISyntaxException {
        <span class="hljs-type">URIBuilder</span> <span class="hljs-variable">uriBuilder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">URIBuilder</span>(config.BASE_URL + <span class="hljs-string">"/stock/queryStocks"</span>)
                .addParameter(<span class="hljs-string">"key"</span>, config.getApiKey());
        
        <span class="hljs-keyword">if</span> (pid != <span class="hljs-literal">null</span>) {
            uriBuilder.addParameter(<span class="hljs-string">"id"</span>, String.valueOf(pid));
        }
        <span class="hljs-keyword">if</span> (symbol != <span class="hljs-literal">null</span>) {
            uriBuilder.addParameter(<span class="hljs-string">"symbol"</span>, symbol);
        }
        <span class="hljs-keyword">if</span> (name != <span class="hljs-literal">null</span>) {
            uriBuilder.addParameter(<span class="hljs-string">"name"</span>, name);
        }
        
        <span class="hljs-type">URI</span> <span class="hljs-variable">uri</span> <span class="hljs-operator">=</span> uriBuilder.build();
        
        ApiResponse&lt;List&lt;Stock&gt;&gt; response = executeGetRequest(uri, 
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeReference</span>&lt;ApiResponse&lt;List&lt;Stock&gt;&gt;&gt;() {});
        
        <span class="hljs-keyword">if</span> (response.isSuccess()) {
            logger.info(<span class="hljs-string">"è‚¡ç¥¨æŸ¥è¯¢æˆåŠŸï¼Œè¿”å› {} æ¡è®°å½•"</span>, response.getData().size());
            <span class="hljs-keyword">return</span> response.getData();
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è‚¡ç¥¨æŸ¥è¯¢å¤±è´¥: "</span> + response.getMessage());
        }
    }
    
    <span class="hljs-comment">/**
     * æ‰¹é‡æŸ¥è¯¢å¤šä¸ªè‚¡ç¥¨
     * 
     * <span class="hljs-doctag">@param</span> pids è‚¡ç¥¨PIDåˆ—è¡¨
     * <span class="hljs-doctag">@return</span> è‚¡ç¥¨åˆ—è¡¨
     */</span>
    <span class="hljs-keyword">public</span> List&lt;Stock&gt; <span class="hljs-title function_">getStocksByPids</span><span class="hljs-params">(List&lt;Long&gt; pids)</span> <span class="hljs-keyword">throws</span> IOException, URISyntaxException {
        <span class="hljs-keyword">if</span> (pids == <span class="hljs-literal">null</span> || pids.isEmpty()) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"è‚¡ç¥¨PIDåˆ—è¡¨ä¸èƒ½ä¸ºç©º"</span>);
        }
        
        <span class="hljs-type">String</span> <span class="hljs-variable">pidsStr</span> <span class="hljs-operator">=</span> String.join(<span class="hljs-string">","</span>, pids.stream().map(String::valueOf).toArray(String[]::<span class="hljs-keyword">new</span>));
        
        <span class="hljs-type">URI</span> <span class="hljs-variable">uri</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">URIBuilder</span>(config.BASE_URL + <span class="hljs-string">"/stock/stocksByPids"</span>)
                .addParameter(<span class="hljs-string">"key"</span>, config.getApiKey())
                .addParameter(<span class="hljs-string">"pids"</span>, pidsStr)
                .build();
        
        ApiResponse&lt;List&lt;Stock&gt;&gt; response = executeGetRequest(uri, 
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeReference</span>&lt;ApiResponse&lt;List&lt;Stock&gt;&gt;&gt;() {});
        
        <span class="hljs-keyword">if</span> (response.isSuccess()) {
            logger.info(<span class="hljs-string">"æ‰¹é‡æŸ¥è¯¢æˆåŠŸï¼Œè¿”å› {} æ¡è®°å½•"</span>, response.getData().size());
            <span class="hljs-keyword">return</span> response.getData();
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æ‰¹é‡æŸ¥è¯¢å¤±è´¥: "</span> + response.getMessage());
        }
    }
    
    <span class="hljs-comment">/**
     * è·å–å°åº¦ä¸»è¦æŒ‡æ•°
     * 
     * <span class="hljs-doctag">@return</span> æŒ‡æ•°åˆ—è¡¨
     */</span>
    <span class="hljs-keyword">public</span> List&lt;Index&gt; <span class="hljs-title function_">getIndiaIndices</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException, URISyntaxException {
        <span class="hljs-type">URI</span> <span class="hljs-variable">uri</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">URIBuilder</span>(config.BASE_URL + <span class="hljs-string">"/stock/indices"</span>)
                .addParameter(<span class="hljs-string">"countryId"</span>, String.valueOf(StockTVConfig.INDIA_COUNTRY_ID))
                .addParameter(<span class="hljs-string">"key"</span>, config.getApiKey())
                .build();
        
        ApiResponse&lt;List&lt;Index&gt;&gt; response = executeGetRequest(uri, 
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeReference</span>&lt;ApiResponse&lt;List&lt;Index&gt;&gt;&gt;() {});
        
        <span class="hljs-keyword">if</span> (response.isSuccess()) {
            logger.info(<span class="hljs-string">"æˆåŠŸè·å– {} ä¸ªå°åº¦æŒ‡æ•°"</span>, response.getData().size());
            <span class="hljs-keyword">return</span> response.getData();
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è·å–æŒ‡æ•°å¤±è´¥: "</span> + response.getMessage());
        }
    }
    
    <span class="hljs-comment">/**
     * è·å–Kçº¿æ•°æ®
     * 
     * <span class="hljs-doctag">@param</span> pid è‚¡ç¥¨PID
     * <span class="hljs-doctag">@param</span> interval æ—¶é—´é—´éš”
     * <span class="hljs-doctag">@return</span> Kçº¿æ•°æ®åˆ—è¡¨
     */</span>
    <span class="hljs-keyword">public</span> List&lt;KLine&gt; <span class="hljs-title function_">getKLineData</span><span class="hljs-params">(Long pid, String interval)</span> <span class="hljs-keyword">throws</span> IOException, URISyntaxException {
        <span class="hljs-keyword">if</span> (pid == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"è‚¡ç¥¨PIDä¸èƒ½ä¸ºç©º"</span>);
        }
        
        <span class="hljs-type">URI</span> <span class="hljs-variable">uri</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">URIBuilder</span>(config.BASE_URL + <span class="hljs-string">"/stock/kline"</span>)
                .addParameter(<span class="hljs-string">"pid"</span>, String.valueOf(pid))
                .addParameter(<span class="hljs-string">"interval"</span>, interval)
                .addParameter(<span class="hljs-string">"key"</span>, config.getApiKey())
                .build();
        
        ApiResponse&lt;List&lt;KLine&gt;&gt; response = executeGetRequest(uri, 
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeReference</span>&lt;ApiResponse&lt;List&lt;KLine&gt;&gt;&gt;() {});
        
        <span class="hljs-keyword">if</span> (response.isSuccess()) {
            logger.info(<span class="hljs-string">"æˆåŠŸè·å–è‚¡ç¥¨ {} çš„Kçº¿æ•°æ®ï¼Œå…± {} æ¡"</span>, pid, response.getData().size());
            <span class="hljs-keyword">return</span> response.getData();
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è·å–Kçº¿æ•°æ®å¤±è´¥: "</span> + response.getMessage());
        }
    }
    
    <span class="hljs-comment">/**
     * è·å–æ¶¨è·Œæ’è¡Œæ¦œ
     * 
     * <span class="hljs-doctag">@param</span> type æ’è¡Œæ¦œç±»å‹
     * <span class="hljs-doctag">@return</span> è‚¡ç¥¨åˆ—è¡¨
     */</span>
    <span class="hljs-keyword">public</span> List&lt;Stock&gt; <span class="hljs-title function_">getUpDownList</span><span class="hljs-params">(Integer type)</span> <span class="hljs-keyword">throws</span> IOException, URISyntaxException {
        <span class="hljs-type">URI</span> <span class="hljs-variable">uri</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">URIBuilder</span>(config.BASE_URL + <span class="hljs-string">"/stock/updownList"</span>)
                .addParameter(<span class="hljs-string">"countryId"</span>, String.valueOf(StockTVConfig.INDIA_COUNTRY_ID))
                .addParameter(<span class="hljs-string">"type"</span>, String.valueOf(type))
                .addParameter(<span class="hljs-string">"key"</span>, config.getApiKey())
                .build();
        
        ApiResponse&lt;List&lt;Stock&gt;&gt; response = executeGetRequest(uri, 
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeReference</span>&lt;ApiResponse&lt;List&lt;Stock&gt;&gt;&gt;() {});
        
        <span class="hljs-keyword">if</span> (response.isSuccess()) {
            <span class="hljs-type">String</span> <span class="hljs-variable">typeName</span> <span class="hljs-operator">=</span> getRankingTypeName(type);
            logger.info(<span class="hljs-string">"æˆåŠŸè·å–{}ï¼Œå…± {} æ¡è®°å½•"</span>, typeName, response.getData().size());
            <span class="hljs-keyword">return</span> response.getData();
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è·å–æ’è¡Œæ¦œå¤±è´¥: "</span> + response.getMessage());
        }
    }
    
    <span class="hljs-comment">/**
     * è·å–IPOæ–°è‚¡æ—¥å†
     * 
     * <span class="hljs-doctag">@param</span> type IPOç±»å‹
     * <span class="hljs-doctag">@return</span> IPOåˆ—è¡¨
     */</span>
    <span class="hljs-keyword">public</span> List&lt;Object&gt; <span class="hljs-title function_">getIpoList</span><span class="hljs-params">(Integer type)</span> <span class="hljs-keyword">throws</span> IOException, URISyntaxException {
        <span class="hljs-type">URIBuilder</span> <span class="hljs-variable">uriBuilder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">URIBuilder</span>(config.BASE_URL + <span class="hljs-string">"/stock/getIpo"</span>)
                .addParameter(<span class="hljs-string">"countryId"</span>, String.valueOf(StockTVConfig.INDIA_COUNTRY_ID))
                .addParameter(<span class="hljs-string">"key"</span>, config.getApiKey());
        
        <span class="hljs-keyword">if</span> (type != <span class="hljs-literal">null</span>) {
            uriBuilder.addParameter(<span class="hljs-string">"type"</span>, String.valueOf(type));
        }
        
        <span class="hljs-type">URI</span> <span class="hljs-variable">uri</span> <span class="hljs-operator">=</span> uriBuilder.build();
        
        ApiResponse&lt;List&lt;Object&gt;&gt; response = executeGetRequest(uri, 
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeReference</span>&lt;ApiResponse&lt;List&lt;Object&gt;&gt;&gt;() {});
        
        <span class="hljs-keyword">if</span> (response.isSuccess()) {
            logger.info(<span class="hljs-string">"æˆåŠŸè·å–IPOæ•°æ®ï¼Œå…± {} æ¡"</span>, response.getData().size());
            <span class="hljs-keyword">return</span> response.getData();
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è·å–IPOæ•°æ®å¤±è´¥: "</span> + response.getMessage());
        }
    }
    
    <span class="hljs-comment">/**
     * é€šç”¨GETè¯·æ±‚æ‰§è¡Œæ–¹æ³•
     */</span>
    <span class="hljs-keyword">private</span> &lt;T&gt; T <span class="hljs-title function_">executeGetRequest</span><span class="hljs-params">(URI uri, TypeReference&lt;T&gt; typeReference)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-type">HttpGet</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpGet</span>(uri);
        logger.debug(<span class="hljs-string">"æ‰§è¡ŒAPIè¯·æ±‚: {}"</span>, uri);
        
        <span class="hljs-keyword">try</span> (<span class="hljs-type">CloseableHttpResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> httpClient.execute(request)) {
            <span class="hljs-type">int</span> <span class="hljs-variable">statusCode</span> <span class="hljs-operator">=</span> response.getStatusLine().getStatusCode();
            <span class="hljs-type">String</span> <span class="hljs-variable">responseBody</span> <span class="hljs-operator">=</span> EntityUtils.toString(response.getEntity());
            
            <span class="hljs-keyword">if</span> (statusCode != <span class="hljs-number">200</span>) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IOException</span>(<span class="hljs-string">"HTTPè¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç : "</span> + statusCode);
            }
            
            logger.debug(<span class="hljs-string">"APIå“åº”: {}"</span>, responseBody);
            <span class="hljs-keyword">return</span> config.getObjectMapper().readValue(responseBody, typeReference);
        }
    }
    
    <span class="hljs-comment">/**
     * è·å–æ’è¡Œæ¦œç±»å‹åç§°
     */</span>
    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">getRankingTypeName</span><span class="hljs-params">(Integer type)</span> {
        <span class="hljs-keyword">switch</span> (type) {
            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"æ¶¨å¹…æ¦œ"</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"è·Œå¹…æ¦œ"</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"æ¶¨åœæ¦œ"</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"è·Œåœæ¦œ"</span>;
            <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"æ’è¡Œæ¦œ"</span>;
        }
    }
    
    <span class="hljs-comment">/**
     * å…³é—­HTTPå®¢æˆ·ç«¯
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-keyword">if</span> (httpClient != <span class="hljs-literal">null</span>) {
            httpClient.close();
        }
    }
}
</code></pre>
<h3 data-id="heading-14">4. æœåŠ¡å±‚å°è£…</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.stocktv.india.service;

<span class="hljs-keyword">import</span> com.stocktv.india.client.StockTVHttpClient;
<span class="hljs-keyword">import</span> com.stocktv.india.config.StockTVConfig;
<span class="hljs-keyword">import</span> com.stocktv.india.model.Index;
<span class="hljs-keyword">import</span> com.stocktv.india.model.KLine;
<span class="hljs-keyword">import</span> com.stocktv.india.model.Stock;
<span class="hljs-keyword">import</span> org.slf4j.Logger;
<span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;

<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.stream.Collectors;

<span class="hljs-comment">/**
 * å°åº¦è‚¡ç¥¨æ•°æ®æœåŠ¡
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IndiaStockService</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(IndiaStockService.class);
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> StockTVHttpClient httpClient;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> StockTVConfig config;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">IndiaStockService</span><span class="hljs-params">(String apiKey)</span> {
        <span class="hljs-built_in">this</span>.config = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StockTVConfig</span>(apiKey);
        <span class="hljs-built_in">this</span>.httpClient = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StockTVHttpClient</span>(config);
    }
    
    <span class="hljs-comment">/**
     * è·å–Nifty 50æˆåˆ†è‚¡
     */</span>
    <span class="hljs-keyword">public</span> List&lt;Stock&gt; <span class="hljs-title function_">getNifty50Stocks</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å®é™…åº”ç”¨ä¸­åº”è¯¥æ ¹æ®Nifty 50æˆåˆ†è‚¡åˆ—è¡¨æŸ¥è¯¢</span>
            List&lt;Stock&gt; stocks = httpClient.getIndiaStocks(<span class="hljs-number">50</span>, <span class="hljs-number">1</span>);
            logger.info(<span class="hljs-string">"è·å–Nifty 50æˆåˆ†è‚¡æˆåŠŸï¼Œå…± {} åªè‚¡ç¥¨"</span>, stocks.size());
            <span class="hljs-keyword">return</span> stocks;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            logger.error(<span class="hljs-string">"è·å–Nifty 50æˆåˆ†è‚¡å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è·å–Nifty 50æˆåˆ†è‚¡å¤±è´¥"</span>, e);
        }
    }
    
    <span class="hljs-comment">/**
     * è·å–å°åº¦ä¸»è¦æŒ‡æ•°
     */</span>
    <span class="hljs-keyword">public</span> List&lt;Index&gt; <span class="hljs-title function_">getMajorIndices</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            List&lt;Index&gt; indices = httpClient.getIndiaIndices();
            logger.info(<span class="hljs-string">"è·å–å°åº¦ä¸»è¦æŒ‡æ•°æˆåŠŸï¼Œå…± {} ä¸ªæŒ‡æ•°"</span>, indices.size());
            <span class="hljs-keyword">return</span> indices;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            logger.error(<span class="hljs-string">"è·å–å°åº¦æŒ‡æ•°å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è·å–å°åº¦æŒ‡æ•°å¤±è´¥"</span>, e);
        }
    }
    
    <span class="hljs-comment">/**
     * æŸ¥è¯¢ç‰¹å®šè‚¡ç¥¨
     */</span>
    <span class="hljs-keyword">public</span> Stock <span class="hljs-title function_">getStockBySymbol</span><span class="hljs-params">(String symbol)</span> {
        <span class="hljs-keyword">try</span> {
            List&lt;Stock&gt; stocks = httpClient.queryStock(<span class="hljs-literal">null</span>, symbol, <span class="hljs-literal">null</span>);
            <span class="hljs-keyword">if</span> (stocks.isEmpty()) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æœªæ‰¾åˆ°è‚¡ç¥¨: "</span> + symbol);
            }
            logger.info(<span class="hljs-string">"æŸ¥è¯¢è‚¡ç¥¨ {} æˆåŠŸ"</span>, symbol);
            <span class="hljs-keyword">return</span> stocks.get(<span class="hljs-number">0</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            logger.error(<span class="hljs-string">"æŸ¥è¯¢è‚¡ç¥¨å¤±è´¥: "</span> + symbol, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æŸ¥è¯¢è‚¡ç¥¨å¤±è´¥: "</span> + symbol, e);
        }
    }
    
    <span class="hljs-comment">/**
     * æ‰¹é‡æŸ¥è¯¢è‚¡ç¥¨
     */</span>
    <span class="hljs-keyword">public</span> List&lt;Stock&gt; <span class="hljs-title function_">getStocksBySymbols</span><span class="hljs-params">(List&lt;String&gt; symbols)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// è¿™é‡Œéœ€è¦å…ˆå°†symbolè½¬æ¢ä¸ºpidï¼Œç®€åŒ–å¤„ç†ç›´æ¥æŸ¥è¯¢</span>
            List&lt;Stock&gt; result = symbols.stream()
                    .map(<span class="hljs-built_in">this</span>::getStockBySymbol)
                    .collect(Collectors.toList());
            logger.info(<span class="hljs-string">"æ‰¹é‡æŸ¥è¯¢ {} åªè‚¡ç¥¨æˆåŠŸ"</span>, symbols.size());
            <span class="hljs-keyword">return</span> result;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            logger.error(<span class="hljs-string">"æ‰¹é‡æŸ¥è¯¢è‚¡ç¥¨å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æ‰¹é‡æŸ¥è¯¢è‚¡ç¥¨å¤±è´¥"</span>, e);
        }
    }
    
    <span class="hljs-comment">/**
     * è·å–è‚¡ç¥¨Kçº¿æ•°æ®
     */</span>
    <span class="hljs-keyword">public</span> List&lt;KLine&gt; <span class="hljs-title function_">getStockKLine</span><span class="hljs-params">(Long pid, String interval)</span> {
        <span class="hljs-keyword">try</span> {
            List&lt;KLine&gt; klines = httpClient.getKLineData(pid, interval);
            logger.info(<span class="hljs-string">"è·å–è‚¡ç¥¨ {} çš„Kçº¿æ•°æ®æˆåŠŸï¼Œå…± {} æ¡"</span>, pid, klines.size());
            <span class="hljs-keyword">return</span> klines;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            logger.error(<span class="hljs-string">"è·å–Kçº¿æ•°æ®å¤±è´¥: pid="</span> + pid, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è·å–Kçº¿æ•°æ®å¤±è´¥: pid="</span> + pid, e);
        }
    }
    
    <span class="hljs-comment">/**
     * è·å–æ¶¨å¹…æ¦œ
     */</span>
    <span class="hljs-keyword">public</span> List&lt;Stock&gt; <span class="hljs-title function_">getGainers</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            List&lt;Stock&gt; gainers = httpClient.getUpDownList(<span class="hljs-number">1</span>);
            logger.info(<span class="hljs-string">"è·å–æ¶¨å¹…æ¦œæˆåŠŸï¼Œå…± {} åªè‚¡ç¥¨"</span>, gainers.size());
            <span class="hljs-keyword">return</span> gainers;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            logger.error(<span class="hljs-string">"è·å–æ¶¨å¹…æ¦œå¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è·å–æ¶¨å¹…æ¦œå¤±è´¥"</span>, e);
        }
    }
    
    <span class="hljs-comment">/**
     * è·å–è·Œå¹…æ¦œ
     */</span>
    <span class="hljs-keyword">public</span> List&lt;Stock&gt; <span class="hljs-title function_">getLosers</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            List&lt;Stock&gt; losers = httpClient.getUpDownList(<span class="hljs-number">2</span>);
            logger.info(<span class="hljs-string">"è·å–è·Œå¹…æ¦œæˆåŠŸï¼Œå…± {} åªè‚¡ç¥¨"</span>, losers.size());
            <span class="hljs-keyword">return</span> losers;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            logger.error(<span class="hljs-string">"è·å–è·Œå¹…æ¦œå¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è·å–è·Œå¹…æ¦œå¤±è´¥"</span>, e);
        }
    }
    
    <span class="hljs-comment">/**
     * è·å–IPOæ•°æ®
     */</span>
    <span class="hljs-keyword">public</span> List&lt;Object&gt; <span class="hljs-title function_">getUpcomingIPOs</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            List&lt;Object&gt; ipos = httpClient.getIpoList(<span class="hljs-number">1</span>); <span class="hljs-comment">// 1è¡¨ç¤ºæœªä¸Šå¸‚</span>
            logger.info(<span class="hljs-string">"è·å–IPOæ•°æ®æˆåŠŸï¼Œå…± {} ä¸ª"</span>, ipos.size());
            <span class="hljs-keyword">return</span> ipos;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            logger.error(<span class="hljs-string">"è·å–IPOæ•°æ®å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è·å–IPOæ•°æ®å¤±è´¥"</span>, e);
        }
    }
    
    <span class="hljs-comment">/**
     * å…³é—­æœåŠ¡
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            httpClient.close();
            logger.info(<span class="hljs-string">"IndiaStockServiceå·²å…³é—­"</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            logger.error(<span class="hljs-string">"å…³é—­æœåŠ¡æ—¶å‘ç”Ÿé”™è¯¯"</span>, e);
        }
    }
}
</code></pre>
<h3 data-id="heading-15">5. ä½¿ç”¨ç¤ºä¾‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.stocktv.india.demo;

<span class="hljs-keyword">import</span> com.stocktv.india.model.Index;
<span class="hljs-keyword">import</span> com.stocktv.india.model.KLine;
<span class="hljs-keyword">import</span> com.stocktv.india.model.Stock;
<span class="hljs-keyword">import</span> com.stocktv.india.service.IndiaStockService;
<span class="hljs-keyword">import</span> org.slf4j.Logger;
<span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * å°åº¦è‚¡ç¥¨æ•°æ®ä½¿ç”¨ç¤ºä¾‹
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IndiaStockDemo</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(IndiaStockDemo.class);
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// æ›¿æ¢ä¸ºæ‚¨çš„å®é™… API Key</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">apiKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"æ‚¨çš„API_KEY"</span>;
        
        <span class="hljs-type">IndiaStockService</span> <span class="hljs-variable">stockService</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IndiaStockService</span>(apiKey);
        
        <span class="hljs-keyword">try</span> {
            logger.info(<span class="hljs-string">"=== StockTV å°åº¦è‚¡ç¥¨æ•°æ®æ¼”ç¤ºç¨‹åºå¼€å§‹ ==="</span>);
            
            <span class="hljs-comment">// 1. è·å–å°åº¦ä¸»è¦æŒ‡æ•°</span>
            demonstrateIndices(stockService);
            
            <span class="hljs-comment">// 2. æŸ¥è¯¢ç‰¹å®šè‚¡ç¥¨</span>
            demonstrateStockQuery(stockService);
            
            <span class="hljs-comment">// 3. è·å–Nifty 50æˆåˆ†è‚¡ç¤ºä¾‹</span>
            demonstrateNifty50(stockService);
            
            <span class="hljs-comment">// 4. è·å–Kçº¿æ•°æ®</span>
            demonstrateKLineData(stockService);
            
            <span class="hljs-comment">// 5. è·å–æ’è¡Œæ¦œ</span>
            demonstrateRankings(stockService);
            
            logger.info(<span class="hljs-string">"=== æ¼”ç¤ºç¨‹åºæ‰§è¡Œå®Œæˆ ==="</span>);
            
        } <span class="hljs-keyword">catch</span> (Exception e) {
            logger.error(<span class="hljs-string">"æ¼”ç¤ºç¨‹åºæ‰§è¡Œå¤±è´¥"</span>, e);
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// å…³é—­æœåŠ¡</span>
            stockService.close();
        }
    }
    
    <span class="hljs-comment">/**
     * æ¼”ç¤ºæŒ‡æ•°æ•°æ®è·å–
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">demonstrateIndices</span><span class="hljs-params">(IndiaStockService stockService)</span> {
        logger.info(<span class="hljs-string">"\n1. å°åº¦ä¸»è¦æŒ‡æ•°"</span>);
        List&lt;Index&gt; indices = stockService.getMajorIndices();
        
        indices.forEach(index -&gt; {
            <span class="hljs-type">String</span> <span class="hljs-variable">trend</span> <span class="hljs-operator">=</span> index.getChange().doubleValue() &gt;= <span class="hljs-number">0</span> ? <span class="hljs-string">"ğŸ“ˆ"</span> : <span class="hljs-string">"ğŸ“‰"</span>;
            logger.info(<span class="hljs-string">"{} {}: {}{} ({}{}%)"</span>, 
                trend, index.getName(), index.getLastPrice(),
                index.getChange().doubleValue() &gt;= <span class="hljs-number">0</span> ? <span class="hljs-string">"â†‘"</span> : <span class="hljs-string">"â†“"</span>,
                index.getChange().doubleValue() &gt;= <span class="hljs-number">0</span> ? <span class="hljs-string">"+"</span> : <span class="hljs-string">""</span>,
                index.getChangePercent());
        });
    }
    
    <span class="hljs-comment">/**
     * æ¼”ç¤ºè‚¡ç¥¨æŸ¥è¯¢
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">demonstrateStockQuery</span><span class="hljs-params">(IndiaStockService stockService)</span> {
        logger.info(<span class="hljs-string">"\n2. æŸ¥è¯¢ç‰¹å®šè‚¡ç¥¨"</span>);
        
        <span class="hljs-comment">// æŸ¥è¯¢Reliance Industries</span>
        <span class="hljs-type">Stock</span> <span class="hljs-variable">reliance</span> <span class="hljs-operator">=</span> stockService.getStockBySymbol(<span class="hljs-string">"RELIANCE"</span>);
        printStockInfo(reliance, <span class="hljs-string">"Reliance Industries"</span>);
        
        <span class="hljs-comment">// æŸ¥è¯¢TCS</span>
        <span class="hljs-type">Stock</span> <span class="hljs-variable">tcs</span> <span class="hljs-operator">=</span> stockService.getStockBySymbol(<span class="hljs-string">"TCS"</span>);
        printStockInfo(tcs, <span class="hljs-string">"Tata Consultancy Services"</span>);
    }
    
    <span class="hljs-comment">/**
     * æ¼”ç¤ºNifty 50æˆåˆ†è‚¡
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">demonstrateNifty50</span><span class="hljs-params">(IndiaStockService stockService)</span> {
        logger.info(<span class="hljs-string">"\n3. Nifty 50æˆåˆ†è‚¡ï¼ˆç¤ºä¾‹ï¼‰"</span>);
        List&lt;Stock&gt; niftyStocks = stockService.getNifty50Stocks();
        
        <span class="hljs-comment">// æ˜¾ç¤ºå‰10åªè‚¡ç¥¨</span>
        niftyStocks.stream().limit(<span class="hljs-number">10</span>).forEach(stock -&gt; {
            <span class="hljs-type">String</span> <span class="hljs-variable">trend</span> <span class="hljs-operator">=</span> stock.getChangePercent().doubleValue() &gt;= <span class="hljs-number">0</span> ? <span class="hljs-string">"ğŸŸ¢"</span> : <span class="hljs-string">"ğŸ”´"</span>;
            logger.info(<span class="hljs-string">"{} {}: â‚¹{} ({}{}%) - {}"</span>, 
                trend, stock.getSymbol(), stock.getLastPrice(),
                stock.getChangePercent().doubleValue() &gt;= <span class="hljs-number">0</span> ? <span class="hljs-string">"+"</span> : <span class="hljs-string">""</span>,
                stock.getChangePercent(), stock.getName());
        });
    }
    
    <span class="hljs-comment">/**
     * æ¼”ç¤ºKçº¿æ•°æ®è·å–
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">demonstrateKLineData</span><span class="hljs-params">(IndiaStockService stockService)</span> {
        logger.info(<span class="hljs-string">"\n4. Kçº¿æ•°æ®ç¤ºä¾‹"</span>);
        
        <span class="hljs-type">Stock</span> <span class="hljs-variable">reliance</span> <span class="hljs-operator">=</span> stockService.getStockBySymbol(<span class="hljs-string">"RELIANCE"</span>);
        <span class="hljs-keyword">if</span> (reliance != <span class="hljs-literal">null</span>) {
            List&lt;KLine&gt; kLines = stockService.getStockKLine(reliance.getId(), <span class="hljs-string">"P1D"</span>);
            
            logger.info(<span class="hljs-string">"Reliance Industries è¿‘æœŸæ—¥Kçº¿æ•°æ®:"</span>);
            kLines.stream().limit(<span class="hljs-number">5</span>).forEach(kLine -&gt; {
                logger.info(<span class="hljs-string">"æ—¶é—´: {}, å¼€: â‚¹{}, é«˜: â‚¹{}, ä½: â‚¹{}, æ”¶: â‚¹{}, æˆäº¤é‡: {}"</span>, 
                    kLine.getFormattedTime(), kLine.getOpen(), 
                    kLine.getHigh(), kLine.getLow(), kLine.getClose(),
                    kLine.getVolume());
            });
        }
    }
    
    <span class="hljs-comment">/**
     * æ¼”ç¤ºæ’è¡Œæ¦œåŠŸèƒ½
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">demonstrateRankings</span><span class="hljs-params">(IndiaStockService stockService)</span> {
        logger.info(<span class="hljs-string">"\n5. å¸‚åœºæ’è¡Œæ¦œ"</span>);
        
        <span class="hljs-comment">// è·å–æ¶¨å¹…æ¦œ</span>
        List&lt;Stock&gt; gainers = stockService.getGainers();
        logger.info(<span class="hljs-string">"ğŸ“ˆ ä»Šæ—¥æ¶¨å¹…æ¦œï¼ˆå‰5ï¼‰:"</span>);
        gainers.stream().limit(<span class="hljs-number">5</span>).forEach(stock -&gt; {
            logger.info(<span class="hljs-string">"   {}: â‚¹{} (+{}%) - {}"</span>, 
                stock.getSymbol(), stock.getLastPrice(), 
                stock.getChangePercent(), stock.getName());
        });
        
        <span class="hljs-comment">// è·å–è·Œå¹…æ¦œ</span>
        List&lt;Stock&gt; losers = stockService.getLosers();
        logger.info(<span class="hljs-string">"ğŸ“‰ ä»Šæ—¥è·Œå¹…æ¦œï¼ˆå‰5ï¼‰:"</span>);
        losers.stream().limit(<span class="hljs-number">5</span>).forEach(stock -&gt; {
            logger.info(<span class="hljs-string">"   {}: â‚¹{} ({}%) - {}"</span>, 
                stock.getSymbol(), stock.getLastPrice(), 
                stock.getChangePercent(), stock.getName());
        });
    }
    
    <span class="hljs-comment">/**
     * æ‰“å°è‚¡ç¥¨ä¿¡æ¯
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printStockInfo</span><span class="hljs-params">(Stock stock, String description)</span> {
        <span class="hljs-keyword">if</span> (stock != <span class="hljs-literal">null</span>) {
            <span class="hljs-type">String</span> <span class="hljs-variable">status</span> <span class="hljs-operator">=</span> stock.getIsOpen() ? <span class="hljs-string">"ğŸŸ¢ äº¤æ˜“ä¸­"</span> : <span class="hljs-string">"ğŸ”´ å·²æ”¶ç›˜"</span>;
            <span class="hljs-type">String</span> <span class="hljs-variable">trend</span> <span class="hljs-operator">=</span> stock.getChangePercent().doubleValue() &gt;= <span class="hljs-number">0</span> ? <span class="hljs-string">"ğŸ“ˆ"</span> : <span class="hljs-string">"ğŸ“‰"</span>;
            
            logger.info(<span class="hljs-string">"{} {} - {}"</span>, trend, description, status);
            logger.info(<span class="hljs-string">"   ä»£ç : {} | ä»·æ ¼: â‚¹{}"</span>, stock.getSymbol(), stock.getLastPrice());
            logger.info(<span class="hljs-string">"   æ¶¨è·Œ: â‚¹{} ({}{}%)"</span>, stock.getChange(), 
                stock.getChangePercent().doubleValue() &gt;= <span class="hljs-number">0</span> ? <span class="hljs-string">"+"</span> : <span class="hljs-string">""</span>,
                stock.getChangePercent());
            logger.info(<span class="hljs-string">"   æœ€é«˜: â‚¹{} | æœ€ä½: â‚¹{} | æˆäº¤é‡: {}"</span>, 
                stock.getHigh(), stock.getLow(), stock.getVolume());
            
            <span class="hljs-keyword">if</span> (stock.getTechnicalDay() != <span class="hljs-literal">null</span>) {
                logger.info(<span class="hljs-string">"   æŠ€æœ¯æŒ‡æ ‡: {}"</span>, getTechnicalIndicatorName(stock.getTechnicalDay()));
            }
        }
    }
    
    <span class="hljs-comment">/**
     * è·å–æŠ€æœ¯æŒ‡æ ‡ä¸­æ–‡åç§°
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">getTechnicalIndicatorName</span><span class="hljs-params">(String indicator)</span> {
        <span class="hljs-keyword">switch</span> (indicator) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">"strong_buy"</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"å¼ºçƒˆä¹°å…¥"</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">"buy"</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"ä¹°å…¥"</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">"neutral"</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"ä¸­æ€§"</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">"sell"</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"å–å‡º"</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">"strong_sell"</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"å¼ºçƒˆå–å‡º"</span>;
            <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> indicator;
        }
    }
}
</code></pre>
<h2 data-id="heading-16">ğŸ¯ é«˜çº§åŠŸèƒ½</h2>
<h3 data-id="heading-17">è‡ªå®šä¹‰è‚¡ç¥¨ç›‘æ§å™¨</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.stocktv.india.advanced;

<span class="hljs-keyword">import</span> com.stocktv.india.model.Stock;
<span class="hljs-keyword">import</span> com.stocktv.india.service.IndiaStockService;
<span class="hljs-keyword">import</span> org.slf4j.Logger;
<span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;

<span class="hljs-keyword">import</span> java.util.*;
<span class="hljs-keyword">import</span> java.util.concurrent.Executors;
<span class="hljs-keyword">import</span> java.util.concurrent.ScheduledExecutorService;
<span class="hljs-keyword">import</span> java.util.concurrent.TimeUnit;

<span class="hljs-comment">/**
 * è‚¡ç¥¨ä»·æ ¼ç›‘æ§å™¨
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StockPriceMonitor</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(StockPriceMonitor.class);
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> IndiaStockService stockService;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ScheduledExecutorService scheduler;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, Stock&gt; lastPrices;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Set&lt;String&gt; monitoredSymbols;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">StockPriceMonitor</span><span class="hljs-params">(String apiKey)</span> {
        <span class="hljs-built_in">this</span>.stockService = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IndiaStockService</span>(apiKey);
        <span class="hljs-built_in">this</span>.scheduler = Executors.newScheduledThreadPool(<span class="hljs-number">1</span>);
        <span class="hljs-built_in">this</span>.lastPrices = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        <span class="hljs-built_in">this</span>.monitoredSymbols = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();
    }
    
    <span class="hljs-comment">/**
     * æ·»åŠ ç›‘æ§è‚¡ç¥¨
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addStock</span><span class="hljs-params">(String symbol)</span> {
        monitoredSymbols.add(symbol);
        logger.info(<span class="hljs-string">"æ·»åŠ ç›‘æ§è‚¡ç¥¨: {}"</span>, symbol);
    }
    
    <span class="hljs-comment">/**
     * å¼€å§‹ç›‘æ§
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startMonitoring</span><span class="hljs-params">()</span> {
        logger.info(<span class="hljs-string">"å¼€å§‹è‚¡ç¥¨ä»·æ ¼ç›‘æ§..."</span>);
        scheduler.scheduleAtFixedRate(<span class="hljs-built_in">this</span>::checkPrices, <span class="hljs-number">0</span>, <span class="hljs-number">60</span>, TimeUnit.SECONDS);
    }
    
    <span class="hljs-comment">/**
     * åœæ­¢ç›‘æ§
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stopMonitoring</span><span class="hljs-params">()</span> {
        scheduler.shutdown();
        stockService.close();
        logger.info(<span class="hljs-string">"è‚¡ç¥¨ä»·æ ¼ç›‘æ§å·²åœæ­¢"</span>);
    }
    
    <span class="hljs-comment">/**
     * æ£€æŸ¥ä»·æ ¼å˜åŒ–
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">checkPrices</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            List&lt;Stock&gt; currentStocks = stockService.getStocksBySymbols(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(monitoredSymbols));
            
            <span class="hljs-keyword">for</span> (Stock currentStock : currentStocks) {
                <span class="hljs-type">String</span> <span class="hljs-variable">symbol</span> <span class="hljs-operator">=</span> currentStock.getSymbol();
                <span class="hljs-type">Stock</span> <span class="hljs-variable">lastStock</span> <span class="hljs-operator">=</span> lastPrices.get(symbol);
                
                <span class="hljs-keyword">if</span> (lastStock != <span class="hljs-literal">null</span>) {
                    <span class="hljs-comment">// æ£€æŸ¥ä»·æ ¼å˜åŒ–</span>
                    <span class="hljs-type">double</span> <span class="hljs-variable">priceChange</span> <span class="hljs-operator">=</span> currentStock.getLastPrice().subtract(lastStock.getLastPrice()).doubleValue();
                    <span class="hljs-type">double</span> <span class="hljs-variable">percentChange</span> <span class="hljs-operator">=</span> currentStock.getChangePercent().doubleValue();
                    
                    <span class="hljs-comment">// ä»·æ ¼é¢„è­¦é€»è¾‘</span>
                    <span class="hljs-keyword">if</span> (Math.abs(percentChange) &gt; <span class="hljs-number">2.0</span>) {
                        logger.warn(<span class="hljs-string">"ğŸš¨ è‚¡ç¥¨ {} ä»·æ ¼æ³¢åŠ¨è¶…è¿‡2%: {}%"</span>, 
                            symbol, percentChange);
                    }
                    
                    <span class="hljs-comment">// æŠ€æœ¯æŒ‡æ ‡å˜åŒ–</span>
                    <span class="hljs-keyword">if</span> (!Objects.equals(currentStock.getTechnicalDay(), lastStock.getTechnicalDay())) {
                        logger.info(<span class="hljs-string">"ğŸ“Š è‚¡ç¥¨ {} æŠ€æœ¯æŒ‡æ ‡å˜åŒ–: {} â†’ {}"</span>, 
                            symbol, lastStock.getTechnicalDay(), currentStock.getTechnicalDay());
                    }
                }
                
                <span class="hljs-comment">// æ›´æ–°æœ€åä»·æ ¼</span>
                lastPrices.put(symbol, currentStock);
            }
            
        } <span class="hljs-keyword">catch</span> (Exception e) {
            logger.error(<span class="hljs-string">"ä»·æ ¼ç›‘æ§æ‰§è¡Œå¤±è´¥"</span>, e);
        }
    }
    
    <span class="hljs-comment">/**
     * è·å–ç›‘æ§æŠ¥å‘Š
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printMonitoringReport</span><span class="hljs-params">()</span> {
        logger.info(<span class="hljs-string">"=== è‚¡ç¥¨ç›‘æ§æŠ¥å‘Š ==="</span>);
        lastPrices.values().forEach(stock -&gt; {
            <span class="hljs-type">String</span> <span class="hljs-variable">trend</span> <span class="hljs-operator">=</span> stock.getChangePercent().doubleValue() &gt;= <span class="hljs-number">0</span> ? <span class="hljs-string">"ğŸŸ¢"</span> : <span class="hljs-string">"ğŸ”´"</span>;
            logger.info(<span class="hljs-string">"{} {}: â‚¹{} ({}{}%)"</span>, 
                trend, stock.getSymbol(), stock.getLastPrice(),
                stock.getChangePercent().doubleValue() &gt;= <span class="hljs-number">0</span> ? <span class="hljs-string">"+"</span> : <span class="hljs-string">""</span>,
                stock.getChangePercent());
        });
    }
}
</code></pre>
<h2 data-id="heading-18">âš ï¸ æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-19">1. é”™è¯¯å¤„ç†æœ€ä½³å®è·µ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * è‡ªå®šä¹‰å¼‚å¸¸ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">StockTVException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">RuntimeException</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">StockTVException</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-built_in">super</span>(message);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">StockTVException</span><span class="hljs-params">(String message, Throwable cause)</span> {
        <span class="hljs-built_in">super</span>(message, cause);
    }
}

<span class="hljs-comment">/**
 * é‡è¯•æœºåˆ¶
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RetryableStockService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">MAX_RETRIES</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">RETRY_DELAY_MS</span> <span class="hljs-operator">=</span> <span class="hljs-number">1000</span>;
    
    <span class="hljs-keyword">public</span> Stock <span class="hljs-title function_">getStockWithRetry</span><span class="hljs-params">(String symbol)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">retries</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span> (retries &lt; MAX_RETRIES) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-type">IndiaStockService</span> <span class="hljs-variable">service</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IndiaStockService</span>(<span class="hljs-string">"API_KEY"</span>);
                <span class="hljs-keyword">return</span> service.getStockBySymbol(symbol);
            } <span class="hljs-keyword">catch</span> (Exception e) {
                retries++;
                <span class="hljs-keyword">if</span> (retries == MAX_RETRIES) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StockTVException</span>(<span class="hljs-string">"è·å–è‚¡ç¥¨æ•°æ®å¤±è´¥ï¼Œå·²è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°"</span>, e);
                }
                <span class="hljs-keyword">try</span> {
                    Thread.sleep(RETRY_DELAY_MS);
                } <span class="hljs-keyword">catch</span> (InterruptedException ie) {
                    Thread.currentThread().interrupt();
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StockTVException</span>(<span class="hljs-string">"é‡è¯•è¿‡ç¨‹è¢«ä¸­æ–­"</span>, ie);
                }
            }
        }
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StockTVException</span>(<span class="hljs-string">"æœªçŸ¥é”™è¯¯"</span>);
    }
}
</code></pre>
<h3 data-id="heading-20">2. æ€§èƒ½ä¼˜åŒ–å»ºè®®</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æ•°æ®ç¼“å­˜ç¤ºä¾‹
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">StockDataCache</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, Stock&gt; stockCache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;Long, List&lt;KLine&gt;&gt; klineCache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">cacheTimeoutMs</span> <span class="hljs-operator">=</span> <span class="hljs-number">5</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>; <span class="hljs-comment">// 5åˆ†é’Ÿç¼“å­˜</span>
    
    <span class="hljs-keyword">public</span> Stock <span class="hljs-title function_">getCachedStock</span><span class="hljs-params">(String symbol, IndiaStockService service)</span> {
        <span class="hljs-type">Stock</span> <span class="hljs-variable">cached</span> <span class="hljs-operator">=</span> stockCache.get(symbol);
        <span class="hljs-keyword">if</span> (cached != <span class="hljs-literal">null</span> &amp;&amp; 
            System.currentTimeMillis() - cached.getTimestamp() * <span class="hljs-number">1000</span> &lt; cacheTimeoutMs) {
            <span class="hljs-keyword">return</span> cached;
        }
        
        <span class="hljs-type">Stock</span> <span class="hljs-variable">fresh</span> <span class="hljs-operator">=</span> service.getStockBySymbol(symbol);
        stockCache.put(symbol, fresh);
        <span class="hljs-keyword">return</span> fresh;
    }
}
</code></pre>
<h2 data-id="heading-21">ğŸ“ æŠ€æœ¯æ”¯æŒ</h2>
<p>å¦‚æœåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è·å–å¸®åŠ©ï¼š</p>
<ol>
<li><strong>æŸ¥çœ‹æ—¥å¿—</strong>: å¯ç”¨DEBUGçº§åˆ«æ—¥å¿—æŸ¥çœ‹è¯¦ç»†è¯·æ±‚ä¿¡æ¯</li>
<li><strong>æ£€æŸ¥ç½‘ç»œ</strong>: ç¡®ä¿å¯ä»¥æ­£å¸¸è®¿é—® <code>api.stocktv.top</code></li>
<li><strong>éªŒè¯API Key</strong>: ç¡®è®¤API Keyæœ‰æ•ˆä¸”å…·æœ‰ç›¸åº”æƒé™</li>
<li><strong>è”ç³»æ”¯æŒ</strong>: é€šè¿‡å®˜æ–¹æ¸ é“è·å–æŠ€æœ¯æ”¯æŒ</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æµè§ˆå™¨æ¸²æŸ“åŸç†æ·±åº¦è§£æï¼šä»HTML/CSS/JSåˆ°åƒç´ çš„å®Œæ•´æ—…ç¨‹]]></title>    <link>https://juejin.cn/post/7570648023111434278</link>    <guid>https://juejin.cn/post/7570648023111434278</guid>    <pubDate>2025-11-10T07:49:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570648023111434278" data-draft-id="7570646659866116122" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æµè§ˆå™¨æ¸²æŸ“åŸç†æ·±åº¦è§£æï¼šä»HTML/CSS/JSåˆ°åƒç´ çš„å®Œæ•´æ—…ç¨‹"/> <meta itemprop="keywords" content="HTML,CSS"/> <meta itemprop="datePublished" content="2025-11-10T07:49:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Tzarevich"/> <meta itemprop="url" content="https://juejin.cn/user/578786070367529"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æµè§ˆå™¨æ¸²æŸ“åŸç†æ·±åº¦è§£æï¼šä»HTML/CSS/JSåˆ°åƒç´ çš„å®Œæ•´æ—…ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/578786070367529/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Tzarevich
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T07:49:30.000Z" title="Mon Nov 10 2025 07:49:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æµè§ˆå™¨æ¸²æŸ“åŸç†æ·±åº¦è§£æï¼šä»HTML/CSS/JSåˆ°åƒç´ çš„å®Œæ•´æ—…ç¨‹</h2>
<h3 data-id="heading-1">å¼•è¨€ï¼šæ•°å­—ä¸–ç•Œçš„é­”æ³•</h3>
<p>åœ¨ç°ä»£ Web å¼€å‘ä¸­ï¼ŒHTMLã€CSS å’Œ JavaScript ä¸‰è€…å…±åŒæ„æˆäº†ç½‘é¡µçš„æ ¸å¿ƒéª¨æ¶ã€æ ·å¼å’Œè¡Œä¸ºã€‚å½“æˆ‘ä»¬æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ç½‘å€ï¼Œç¬é—´å°±èƒ½çœ‹åˆ°ç²¾ç¾çš„ç½‘é¡µç•Œé¢ã€‚è¿™çœ‹ä¼¼ç®€å•çš„è¿‡ç¨‹èƒŒåï¼Œå®åˆ™æ˜¯ä¸€åœºç²¾å¯†çš„æ•°å­—é­”æ³•ã€‚ä½œä¸ºä¸€åå‰ç«¯å¼€å‘è€…ï¼Œæ·±å…¥ç†è§£æµè§ˆå™¨æ¸²æŸ“æœºåˆ¶ä¸ä»…æ˜¯æŠ€èƒ½æå‡çš„å¿…ç»ä¹‹è·¯ï¼Œæ›´æ˜¯ç¼–å†™é«˜æ€§èƒ½Webåº”ç”¨çš„åŸºç¡€ã€‚æœ¬æ–‡å°†å¸¦æ‚¨æ·±å…¥æ¢ç´¢æµè§ˆå™¨å¦‚ä½•å°†HTMLã€CSSå’ŒJavaScriptä»£ç è½¬æ¢ä¸ºæˆ‘ä»¬æ‰€è§çš„å¯è§†åŒ–ç•Œé¢ã€‚</p>
<h3 data-id="heading-2">ä¸€ã€æ¸²æŸ“æµç¨‹å…¨æ™¯å›¾</h3>
<h4 data-id="heading-3">1. å®è§‚æ¸²æŸ“æµæ°´çº¿</h4>
<p>æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹å¯ä»¥æ¦‚æ‹¬ä¸ºä¸€ä¸ªå¤æ‚çš„å¤šé˜¶æ®µæµæ°´çº¿ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">HTML</span>/CSS/JS è¾“å…¥ â†’ æµè§ˆå™¨(Chrome) â†’ æ¸²æŸ“å¼•æ“ â†’ è§£æå¤„ç† â†’ ç”ŸæˆDOMæ ‘/CSSOMæ ‘/æ‰§è¡ŒJS â†’ æ¸²æŸ“æ ‘ â†’ å¸ƒå±€ â†’ ç»˜åˆ¶ â†’ åˆæˆ
</code></pre>
<h4 data-id="heading-4">2. æ¸²æŸ“çš„æ ¸å¿ƒæŒ‘æˆ˜</h4>
<p><strong>æµç¨‹å¤æ‚æ€§</strong>ï¼šä»å­—ç¬¦ä¸²è§£æåˆ°åƒç´ ç»˜åˆ¶ï¼Œæ¶‰åŠå¤šä¸ªè§£æå™¨ã€å¤šä¸ªå¤„ç†é˜¶æ®µå’Œå¤æ‚çš„è®¡ç®—é€»è¾‘ã€‚</p>
<p><strong>æ—¶é—´å¼€é”€</strong>ï¼šæ¯ä¸ªé˜¶æ®µéƒ½å¯èƒ½æˆä¸ºæ€§èƒ½ç“¶é¢ˆï¼Œç‰¹åˆ«æ˜¯åœ¨ç§»åŠ¨è®¾å¤‡æˆ–å¤„ç†å¤æ‚é¡µé¢æ—¶ã€‚</p>
<p><strong>æ€§èƒ½ä¼˜åŒ–å¿…è¦æ€§</strong>ï¼šç†è§£æ¸²æŸ“æµç¨‹æ˜¯è¿›è¡Œæœ‰æ•ˆæ€§èƒ½ä¼˜åŒ–çš„å‰æï¼Œåªæœ‰çŸ¥é“æ—¶é—´èŠ±åœ¨å“ªé‡Œï¼Œæ‰èƒ½æœ‰é’ˆå¯¹æ€§åœ°ä¼˜åŒ–ã€‚</p>
<h3 data-id="heading-5">äºŒã€HTMLè§£æä¸DOMæ ‘æ„å»º</h3>
<h4 data-id="heading-6">1. HTML çš„æœ¬è´¨æ˜¯å­—ç¬¦ä¸²</h4>
<p>HTML æ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€æ®µçº¯æ–‡æœ¬å­—ç¬¦ä¸²ã€‚æµè§ˆå™¨æ— æ³•ç›´æ¥æ“ä½œå­—ç¬¦ä¸²æ¥æ¸²æŸ“é¡µé¢ï¼Œå› æ­¤å¿…é¡»å°†å…¶è½¬æ¢ä¸ºä¸€ç§å¯ç¼–ç¨‹ã€å¯éå†çš„æ•°æ®ç»“æ„â€”â€”<strong>DOM æ ‘</strong>ã€‚</p>
<h4 data-id="heading-7">2. è§£æè¿‡ç¨‹</h4>
<ul>
<li>æµè§ˆå™¨é€šè¿‡Â <strong>HTML è§£æå™¨ï¼ˆHTML Parserï¼‰</strong> Â é€å­—ç¬¦è¯»å– HTMLã€‚</li>
<li>é‡åˆ°æ ‡ç­¾ï¼ˆå¦‚Â <code>&lt;div&gt;</code>ï¼‰ã€æ–‡æœ¬ã€æ³¨é‡Šç­‰å†…å®¹æ—¶ï¼Œä¼šåˆ›å»ºå¯¹åº”çš„Â <strong>èŠ‚ç‚¹ï¼ˆNodeï¼‰</strong> ã€‚</li>
<li>èŠ‚ç‚¹ä¹‹é—´æ ¹æ®åµŒå¥—å…³ç³»å½¢æˆçˆ¶å­ã€å…„å¼Ÿç­‰å±‚çº§ç»“æ„ï¼Œæœ€ç»ˆæ„æˆä¸€æ£µæ ‘ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-xml" lang="xml">Html
é¢„è§ˆ
1<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
2  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
3  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
4    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
5    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>World<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
6  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
7<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>ä¼šè¢«è§£æä¸ºå¦‚ä¸‹ DOM æ ‘ç»“æ„ï¼ˆç®€åŒ–ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">Text
ç¼–è¾‘
1html
2â”œâ”€â”€ <span class="hljs-built_in">head</span>
3â”‚   â””â”€â”€ title â†’ <span class="hljs-string">"ç¤ºä¾‹"</span>
4â””â”€â”€ body
5    â”œâ”€â”€ h1 â†’ <span class="hljs-string">"Hello"</span>
6    â””â”€â”€ p â†’ <span class="hljs-string">"World"</span>
</code></pre>
<h4 data-id="heading-8">3. DOMæ ‘çš„æœ¬è´¨ç‰¹å¾</h4>
<p>DOMæ ‘å…·æœ‰ä»¥ä¸‹é‡è¦ç‰¹æ€§ï¼š</p>
<ul>
<li><strong>å±‚æ¬¡ç»“æ„</strong>ï¼šåæ˜ HTMLæ ‡ç­¾çš„åµŒå¥—å…³ç³»</li>
<li><strong>èŠ‚ç‚¹ç±»å‹</strong>ï¼šå…ƒç´ èŠ‚ç‚¹ã€æ–‡æœ¬èŠ‚ç‚¹ã€å±æ€§èŠ‚ç‚¹ç­‰</li>
<li><strong>å†…å­˜è¡¨ç¤º</strong>ï¼šæ•´ä¸ªDOMæ ‘é©»ç•™åœ¨å†…å­˜ä¸­ï¼Œå¯é€šè¿‡JavaScriptè®¿é—®å’Œæ“ä½œ</li>
<li><strong>åŠ¨æ€æ›´æ–°</strong>ï¼šå¯ä»¥é€šè¿‡JavaScriptåŠ¨æ€ä¿®æ”¹DOMç»“æ„</li>
</ul>
<h4 data-id="heading-9">4. HTMLè¯­ä¹‰åŒ–çš„æ·±è¿œå½±å“</h4>
<ul>
<li><strong>ç»“æ„è¯­ä¹‰åŒ–æ ‡ç­¾</strong>ï¼ˆå¦‚Â <code>&lt;header&gt;</code>ã€<code>&lt;main&gt;</code>ã€<code>&lt;footer&gt;</code>ã€<code>&lt;aside&gt;</code>ã€<code>&lt;section&gt;</code>ï¼‰ä¸ä»…å¸®åŠ©å¼€å‘è€…ç»„ç»‡å†…å®¹ï¼Œä¹Ÿä¾¿äºæœç´¢å¼•æ“ï¼ˆSEOï¼‰ç†è§£é¡µé¢ç»“æ„ã€‚</li>
<li><strong>åŠŸèƒ½è¯­ä¹‰åŒ–æ ‡ç­¾</strong>ï¼ˆå¦‚Â <code>&lt;h1&gt;</code>~<code>&lt;h6&gt;</code>ã€<code>&lt;ul&gt;</code>ã€<code>&lt;li&gt;</code>ã€<code>&lt;code&gt;</code>ã€<code>&lt;p&gt;</code>ï¼‰åˆ™æ˜ç¡®è¡¨è¾¾äº†å†…å®¹çš„ç±»å‹å’Œå±‚çº§ã€‚</li>
</ul>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- éè¯­ä¹‰åŒ–å†™æ³• --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"header"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"main-content"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"footer"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-comment">&lt;!-- è¯­ä¹‰åŒ–å†™æ³• --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">footer</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span>
</code></pre>
<p>è¯­ä¹‰åŒ–æ ‡ç­¾ä¸ä»…ä½¿ä»£ç æ›´æ˜“è¯»ï¼Œæ›´é‡è¦çš„æ˜¯ä¸ºæµè§ˆå™¨å’Œæœç´¢å¼•æ“æä¾›äº†æ˜ç¡®çš„è¯­ä¹‰ä¿¡æ¯ã€‚</p>
<h5 data-id="heading-10">SEOä¼˜åŒ–æœºåˆ¶</h5>
<p>æœç´¢å¼•æ“é€šè¿‡çˆ¬è™«ç¨‹åºåˆ†æç½‘é¡µå†…å®¹ï¼Œè¯­ä¹‰åŒ–æ ‡ç­¾å¸®åŠ©çˆ¬è™«ï¼š</p>
<ul>
<li>å‡†ç¡®è¯†åˆ«é¡µé¢å„ä¸ªéƒ¨åˆ†çš„ä½œç”¨</li>
<li>ç†è§£å†…å®¹çš„é‡è¦æ€§å’Œç›¸å…³æ€§</li>
<li>å»ºç«‹å†…å®¹ä¹‹é—´çš„é€»è¾‘å…³ç³»</li>
</ul>
<h5 data-id="heading-11">æ¸²æŸ“æ€§èƒ½ä¼˜åŒ–</h5>
<p>é€šè¿‡åˆç†çš„æ ‡ç­¾é¡ºåºå’Œè¯­ä¹‰åŒ–ç»“æ„ï¼Œå¯ä»¥ä¼˜åŒ–æ¸²æŸ“æ€§èƒ½ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* é€šè¿‡CSSè°ƒæ•´è§†è§‰é¡ºåºè€Œä¸æ”¹å˜DOMé¡ºåº */</span>
<span class="hljs-selector-tag">main</span> { <span class="hljs-attribute">order</span>: <span class="hljs-number">1</span>; }
<span class="hljs-selector-tag">aside</span> { <span class="hljs-attribute">order</span>: <span class="hljs-number">2</span>; }
</code></pre>
<p>è¿™æ ·æ—¢ä¿è¯äº†é‡è¦å†…å®¹åœ¨DOMä¸­ä¼˜å…ˆå‡ºç°ï¼Œåˆå®ç°äº†æœŸæœ›çš„è§†è§‰å¸ƒå±€ã€‚</p>
<h3 data-id="heading-12">ä¸‰ã€CSSè§£æä¸CSSOMæ ‘æ„å»º</h3>
<h4 data-id="heading-13">1. ä»æ ·å¼è¡¨åˆ°æ ·å¼æ ‘</h4>
<p>ä¸HTMLè§£æç±»ä¼¼ï¼ŒCSSä¹Ÿéœ€è¦ä»æ–‡æœ¬æ ¼å¼è½¬æ¢ä¸ºè®¡ç®—æœºæ˜“äºå¤„ç†çš„ç»“æ„åŒ–æ•°æ®ã€‚<strong>CSSOMï¼ˆCSS Object Modelï¼‰æ ‘</strong>å°±æ˜¯è¿™ä¸ªè½¬æ¢çš„ç»“æœï¼Œè¿™æ˜¯ä¸€ç§åŒ…å«æ‰€æœ‰æ ·å¼è§„åˆ™çš„å¯¹è±¡æ¨¡å‹ã€‚</p>
<h4 data-id="heading-14">2. è§£æè§„åˆ™</h4>
<ul>
<li>æµè§ˆå™¨è¯»å– CSS è§„åˆ™ï¼ˆå¦‚Â <code>div { color: red; }</code>ï¼‰ã€‚</li>
<li>å°†é€‰æ‹©å™¨ä¸å£°æ˜åˆ†ç¦»ï¼Œæ„å»ºå‡ºâ€œé€‰æ‹©å™¨ â†’ æ ·å¼å±æ€§â€çš„æ˜ å°„ã€‚</li>
<li>æœ€ç»ˆå½¢æˆä¸€æ£µæ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªæ ·å¼è§„åˆ™ï¼Œå¹¶æŒ‰ä¼˜å…ˆçº§ï¼ˆå±‚å ã€ç»§æ‰¿ã€ç‰¹å¼‚æ€§ï¼‰è¿›è¡Œæ•´åˆã€‚</li>
</ul>
<h4 data-id="heading-15">3. CSSOMä¸DOMçš„ç»“åˆ</h4>
<p>å•ç‹¬çš„ DOM æˆ– CSSOM éƒ½æ— æ³•æ¸²æŸ“é¡µé¢ï¼ŒCSSOMæ ‘æ„å»ºå®Œæˆåï¼Œæµè§ˆå™¨éœ€è¦å°†å…¶ä¸DOMæ ‘ç»“åˆï¼Œè¿™ä¸ªè¿‡ç¨‹åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>é€‰æ‹©å™¨åŒ¹é…</strong>ï¼šä¸ºæ¯ä¸ªDOMå…ƒç´ æ‰¾åˆ°æ‰€æœ‰é€‚ç”¨çš„CSSè§„åˆ™</li>
<li><strong>å€¼è®¡ç®—</strong>ï¼šå°†ç›¸å¯¹å•ä½è½¬æ¢ä¸ºç»å¯¹åƒç´ å€¼</li>
<li><strong>æ ·å¼ç»§æ‰¿</strong>ï¼šå¤„ç†å¯ç»§æ‰¿å±æ€§çš„ä¼ æ’­</li>
<li><strong>å±‚å å¤„ç†</strong>ï¼šæ ¹æ®ä¼˜å…ˆçº§å’Œé¡ºåºç¡®å®šæœ€ç»ˆæ ·å¼</li>
</ul>
<p>æµè§ˆå™¨å°†ä¸¤è€…ç»“åˆï¼Œä¸ºæ¯ä¸ª DOM èŠ‚ç‚¹é™„åŠ å…¶æœ€ç»ˆè®¡ç®—åçš„æ ·å¼ï¼Œç”ŸæˆÂ <strong>æ¸²æŸ“æ ‘ï¼ˆRender Treeï¼‰</strong></p>
<h3 data-id="heading-16">å››ã€æ¸²æŸ“æ ‘ä¸å¸ƒå±€è®¡ç®—</h3>
<h4 data-id="heading-17">1.æ¸²æŸ“æ ‘çš„æ„å»º</h4>
<p>æ¸²æŸ“æ ‘æ˜¯DOMæ ‘å’ŒCSSOMæ ‘çš„ç»“åˆä½“ï¼Œä½†åªåŒ…å«å¯è§å†…å®¹ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- DOMæ ‘ä¸­çš„å…ƒç´  --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display: none;"</span>&gt;</span>éšè—å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"visibility: hidden;"</span>&gt;</span>ä¸å¯è§ä½†å ä½<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>å¯è§å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>åœ¨æ¸²æŸ“æ ‘ä¸­ï¼š</p>
<ul>
<li><code>display: none</code> çš„å…ƒç´ å®Œå…¨ä¸ä¼šå‡ºç°</li>
<li><code>visibility: hidden</code> çš„å…ƒç´ ä¼šä¿ç•™ä½ç½®ä½†ä¸å¯è§</li>
<li>åªæœ‰çœŸæ­£å¯è§çš„å…ƒç´ æ‰ä¼šè¿›å…¥æ¸²æŸ“æ ‘</li>
</ul>
<h4 data-id="heading-18">4.2 å¸ƒå±€ï¼ˆé‡æ’ï¼‰è¿‡ç¨‹</h4>
<p>å¸ƒå±€é˜¶æ®µè®¡ç®—æ¯ä¸ªå…ƒç´ åœ¨å±å¹•ä¸Šçš„ç²¾ç¡®ä½ç½®å’Œå°ºå¯¸ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.container</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">80%</span>;
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
}
</code></pre>
<p><strong>å¸ƒå±€è®¡ç®—åŒ…æ‹¬</strong>ï¼š</p>
<ul>
<li><strong>ç›’æ¨¡å‹è®¡ç®—</strong>ï¼šcontent + padding + border + margin</li>
<li><strong>ä½ç½®è®¡ç®—</strong>ï¼šç›¸å¯¹å®šä½ã€ç»å¯¹å®šä½ã€å›ºå®šå®šä½</li>
<li><strong>æµ®åŠ¨å¤„ç†</strong>ï¼šæ–‡æœ¬ç¯ç»•å’Œæ¸…é™¤æµ®åŠ¨</li>
<li><strong>Flexbox/Gridå¸ƒå±€</strong>ï¼šç°ä»£å¸ƒå±€ç³»ç»Ÿçš„å¤æ‚è®¡ç®—</li>
</ul>
<h4 data-id="heading-19">4.3 å¸ƒå±€æ€§èƒ½ä¼˜åŒ–</h4>
<p>å¸ƒå±€æ˜¯æ¸²æŸ“æµç¨‹ä¸­æœ€æ˜‚è´µçš„æ“ä½œä¹‹ä¸€ï¼Œä¼˜åŒ–ç­–ç•¥åŒ…æ‹¬ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¸å¥½ï¼šå¤šæ¬¡è§¦å‘å¸ƒå±€</span>
element.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">'100px'</span>;
<span class="hljs-keyword">const</span> height = element.<span class="hljs-property">offsetHeight</span>; <span class="hljs-comment">// è§¦å‘å¸ƒå±€</span>
element.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = height + <span class="hljs-string">'px'</span>;

<span class="hljs-comment">// å¥½ï¼šæ‰¹é‡è¯»å†™</span>
<span class="hljs-keyword">const</span> height = element.<span class="hljs-property">offsetHeight</span>; <span class="hljs-comment">// è¯»å–</span>
element.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">'100px'</span>;       <span class="hljs-comment">// å†™å…¥</span>
element.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = height + <span class="hljs-string">'px'</span>; <span class="hljs-comment">// å†™å…¥</span>
</code></pre>
<h3 data-id="heading-20">äº”ã€JavaScriptçš„æ‰§è¡Œä¸äº¤äº’</h3>
<h4 data-id="heading-21">1. JavaScriptå¼•æ“ä¸æ¸²æŸ“å¼•æ“çš„åä½œ</h4>
<p>JavaScriptæ‰§è¡Œä¼šé˜»å¡DOMè§£æå’Œæ¸²æŸ“ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// åŒæ­¥è„šæœ¬ä¼šé˜»å¡è§£æ</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">write</span>(<span class="hljs-string">'&lt;p&gt;åŠ¨æ€å†…å®¹&lt;/p&gt;'</span>);
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"defer-script.js"</span> <span class="hljs-attr">defer</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"async-script.js"</span> <span class="hljs-attr">async</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><strong>å…³é”®é—®é¢˜ï¼šä¸ºä»€ä¹ˆ JS ä¼šé˜»å¡ï¼Ÿ</strong></p>
<ul>
<li>å› ä¸º JS å¯èƒ½é€šè¿‡Â <code>document.write()</code>Â ä¿®æ”¹ HTMLï¼Œæˆ–é€šè¿‡Â <code>appendChild</code>Â åŠ¨æ€æ’å…¥æ–°èŠ‚ç‚¹ã€‚</li>
<li>ä¸ºä¿è¯ä¸€è‡´æ€§ï¼Œæµè§ˆå™¨åœ¨é‡åˆ°Â <code>&lt;script&gt;</code>Â æ ‡ç­¾æ—¶ä¼šæš‚åœ HTML è§£æï¼Œç›´åˆ°è„šæœ¬ä¸‹è½½å¹¶æ‰§è¡Œå®Œæ¯•ã€‚</li>
</ul>
<blockquote>
<p>ğŸš« ç¤ºä¾‹ï¼ˆé˜»å¡ï¼‰ï¼š</p>
</blockquote>
<pre><code class="hljs language-xml" lang="xml">Html
é¢„è§ˆ
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"app.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> <span class="hljs-comment">&lt;!-- é˜»å¡åç»­ HTML è§£æ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>è¿™éƒ¨åˆ†å†…å®¹ä¼šè¢«å»¶è¿Ÿè§£æ<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p><strong>åŠ è½½ç­–ç•¥</strong>ï¼š</p>
<ul>
<li><strong>åŒæ­¥è„šæœ¬</strong>ï¼šç«‹å³æ‰§è¡Œï¼Œé˜»å¡è§£æ</li>
<li><strong>defer</strong>ï¼šå¼‚æ­¥åŠ è½½ï¼ŒDOMè§£æå®Œæˆåæ‰§è¡Œ</li>
<li><strong>async</strong>ï¼šå¼‚æ­¥åŠ è½½ï¼ŒåŠ è½½å®Œæˆåç«‹å³æ‰§è¡Œ</li>
</ul>
<h4 data-id="heading-22">2. äº‹ä»¶å¾ªç¯ä¸æ¸²æŸ“è°ƒåº¦</h4>
<p>æµè§ˆå™¨é€šè¿‡äº‹ä»¶å¾ªç¯æœºåˆ¶åè°ƒJavaScriptæ‰§è¡Œå’Œæ¸²æŸ“ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨requestAnimationFrameä¼˜åŒ–åŠ¨ç”»</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">animate</span>(<span class="hljs-params"/>) {
    element.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">`translateX(<span class="hljs-subst">${position}</span>px)`</span>;
    position += <span class="hljs-number">1</span>;
    <span class="hljs-title function_">requestAnimationFrame</span>(animate);
}
<span class="hljs-title function_">requestAnimationFrame</span>(animate);
</code></pre>
<h3 data-id="heading-23">å…­ã€æ€§èƒ½ä¼˜åŒ–å®æˆ˜</h3>
<h4 data-id="heading-24">1. å…³é”®æ¸²æŸ“è·¯å¾„ä¼˜åŒ–</h4>
<p><strong>ä¼˜åŒ–ç›®æ ‡</strong>ï¼šç¼©çŸ­é¦–æ¬¡æœ‰æ„ä¹‰æ¸²æŸ“çš„æ—¶é—´</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- å…³é”®CSSå†…è” --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-comment">/* é¦–å±å…³é”®æ ·å¼ */</span>
<span class="hljs-selector-class">.header</span>, <span class="hljs-selector-class">.main-content</span> { <span class="hljs-comment">/* ... */</span> }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>

<span class="hljs-comment">&lt;!-- éå…³é”®CSSå¼‚æ­¥åŠ è½½ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preload"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"non-critical.css"</span> <span class="hljs-attr">as</span>=<span class="hljs-string">"style"</span> <span class="hljs-attr">onload</span>=<span class="hljs-string">"this.rel='stylesheet'"</span>&gt;</span>
</code></pre>
<h4 data-id="heading-25">2. å‡å°‘é‡æ’å’Œé‡ç»˜</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨DocumentFragmentæ‰¹é‡æ“ä½œDOM</span>
<span class="hljs-keyword">const</span> fragment = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createDocumentFragment</span>();
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
    <span class="hljs-keyword">const</span> li = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'li'</span>);
    li.<span class="hljs-property">textContent</span> = <span class="hljs-string">`Item <span class="hljs-subst">${i}</span>`</span>;
    fragment.<span class="hljs-title function_">appendChild</span>(li);
}
list.<span class="hljs-title function_">appendChild</span>(fragment);
</code></pre>
<h4 data-id="heading-26">3. ç°ä»£CSSå¸ƒå±€ä¼˜åŒ–</h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* ä½¿ç”¨Flexboxé¿å…æµ®åŠ¨å¸ƒå±€çš„é‡æ’é—®é¢˜ */</span>
<span class="hljs-selector-class">.container</span> {
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">gap</span>: <span class="hljs-number">20px</span>; <span class="hljs-comment">/* ä½¿ç”¨gapæ›¿ä»£margin */</span>
}

<span class="hljs-comment">/* ä½¿ç”¨Gridå®ç°å¤æ‚å¸ƒå±€ */</span>
<span class="hljs-selector-class">.grid-layout</span> {
    <span class="hljs-attribute">display</span>: grid;
    <span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-built_in">repeat</span>(auto-fit, <span class="hljs-built_in">minmax</span>(<span class="hljs-number">250px</span>, <span class="hljs-number">1</span>fr));
}
</code></pre>
<h3 data-id="heading-27">ç»“è¯­</h3>
<p>æµè§ˆå™¨æ¸²æŸ“æ˜¯ä¸€ä¸ªæå…¶å¤æ‚ä½†åˆç²¾å¦™åè°ƒçš„è¿‡ç¨‹ã€‚ä»HTMLå­—ç¬¦ä¸²åˆ°å±å¹•åƒç´ ï¼Œæ¯ä¸€ä¸ªé˜¶æ®µéƒ½ä½“ç°äº†è®¡ç®—æœºç§‘å­¦çš„æ·±åº¦å’Œæµè§ˆå™¨çš„å·¥ç¨‹æ™ºæ…§ã€‚ä½œä¸ºå‰ç«¯å¼€å‘è€…ï¼Œæ·±å…¥ç†è§£è¿™ä¸€è¿‡ç¨‹ä¸ä»…èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬ç¼–å†™æ›´é«˜æ•ˆçš„ä»£ç ï¼Œæ›´é‡è¦çš„æ˜¯èƒ½å¤ŸåŸ¹å…»å‡ºå¯¹Webæ€§èƒ½çš„ç›´è§‰å’Œå¯¹ç”¨æˆ·ä½“éªŒçš„æ·±åˆ»ç†è§£ã€‚</p>
<p>éšç€WebæŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œæ¸²æŸ“ä¼˜åŒ–ä»ç„¶æ˜¯æˆ‘ä»¬éœ€è¦æŒç»­å­¦ä¹ å’Œæ¢ç´¢çš„é‡è¦é¢†åŸŸã€‚åªæœ‰æ·±å…¥ç†è§£åº•å±‚åŸç†ï¼Œæ‰èƒ½åœ¨é¢å¯¹æ–°çš„æŠ€æœ¯æŒ‘æˆ˜æ—¶æ¸¸åˆƒæœ‰ä½™ï¼Œåˆ›é€ å‡ºçœŸæ­£ä¼˜ç§€çš„Webä½“éªŒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue 3 è¶…å¼ºäºŒç»´ç è¯†åˆ«ï¼šå¤šåŒºåŸŸ/å¤šå°ºåº¦æ‰«æ + é«˜çº§å›¾åƒå¤„ç†]]></title>    <link>https://juejin.cn/post/7570598043298070591</link>    <guid>https://juejin.cn/post/7570598043298070591</guid>    <pubDate>2025-11-10T08:07:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570598043298070591" data-draft-id="7570500819889438763" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue 3 è¶…å¼ºäºŒç»´ç è¯†åˆ«ï¼šå¤šåŒºåŸŸ/å¤šå°ºåº¦æ‰«æ + é«˜çº§å›¾åƒå¤„ç†"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Vue.js"/> <meta itemprop="datePublished" content="2025-11-10T08:07:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¹åŒ—æµ·"/> <meta itemprop="url" content="https://juejin.cn/user/1425415102792237"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue 3 è¶…å¼ºäºŒç»´ç è¯†åˆ«ï¼šå¤šåŒºåŸŸ/å¤šå°ºåº¦æ‰«æ + é«˜çº§å›¾åƒå¤„ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1425415102792237/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¹åŒ—æµ·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T08:07:22.000Z" title="Mon Nov 10 2025 08:07:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Vue 3 è¶…å¼ºäºŒç»´ç è¯†åˆ«ï¼šå¤šåŒºåŸŸ/å¤šå°ºåº¦æ‰«æ + é«˜çº§å›¾åƒå¤„ç†</h2>
<p>åœ¨å‰ç«¯é¡¹ç›®é‡ŒåšäºŒç»´ç è¯†åˆ«ï¼Œç»å¸¸ä¼šé‡åˆ°â€œèƒŒæ™¯å¤æ‚è¯†åˆ«éš¾â€â€œäºŒç»´ç å¾ˆå°è¯†åˆ«ç‡ä½â€â€œè¯†åˆ«æ…¢â€çš„ç—›ç‚¹ã€‚æœ¬æ–‡ç»™å¤§å®¶ä»‹ç»ä¸€ä¸ªåŸºäº Vue 3 çš„äºŒç»´ç è¯†åˆ«å·¥å…·åº“ â€”â€” <code>vue-qrcode-scanner</code>ï¼Œä¸»æ‰“â€œè¯†åˆ«ç¨³ã€é€Ÿåº¦å¿«ã€æ¥å…¥ç®€å•â€ã€‚</p>
<ul>
<li>æ”¯æŒå¤šåŒºåŸŸ/å¤šå°ºåº¦æ‰«æï¼Œä¼˜å…ˆå‘½ä¸­é«˜æ¦‚ç‡åŒºåŸŸï¼Œæå‡é¦–è¯†åˆ«é€Ÿåº¦</li>
<li>å†…ç½®å¤šç§å›¾åƒé¢„å¤„ç†ï¼šOTSUã€è‡ªé€‚åº”é˜ˆå€¼ã€é”åŒ–ã€å¯¹æ¯”åº¦æ‹‰ä¼¸ï¼Œå¤æ‚èƒŒæ™¯ä¹Ÿèƒ½é¡¶ä½</li>
<li>æä¾› Vue Composable API + å·¥å…·å‡½æ•°ä¸¤å¥—ç”¨æ³•</li>
<li>TypeScript å…¨é‡ç±»å‹ï¼Œå¼€å‘ä½“éªŒå‹å¥½</li>
</ul>
<p>å¼€æºåœ°å€ä¸å®‰è£…æ–¹å¼è§æ–‡æœ«ï¼Œæ¬¢è¿ Star ä¸åé¦ˆé—®é¢˜ã€‚</p>
<h3 data-id="heading-1">âœ¨ åŠŸèƒ½äº®ç‚¹</h3>
<ul>
<li><strong>Vue 3 Composable</strong>ï¼šä½¿ç”¨ Composition APIï¼Œæ¥å…¥æˆæœ¬ä½</li>
<li><strong>å¤šåŒºåŸŸæ‰«æ</strong>ï¼šä¼˜å…ˆå¸¸è§ä½ç½®ï¼ˆå¦‚å³ä¸‹è§’ï¼‰+ æ»‘åŠ¨çª—å£ç­–ç•¥</li>
<li><strong>å¤šå°ºåº¦æ‰«æ</strong>ï¼šè‡ªåŠ¨åœ¨ä¸åŒç¼©æ”¾çº§åˆ«å°è¯•è¯†åˆ«</li>
<li><strong>è‡ªåŠ¨å®šä½</strong>ï¼šè¿”å›äºŒç»´ç ä½ç½®åæ ‡ï¼Œå¯è§†åŒ–æ ‡è®°æ›´æ–¹ä¾¿</li>
<li><strong>é«˜çº§å›¾åƒå¤„ç†</strong>ï¼šOTSUã€è‡ªé€‚åº”é˜ˆå€¼ã€é”åŒ–ã€å¯¹æ¯”åº¦æ‹‰ä¼¸</li>
<li><strong>é›¶ä¾èµ–</strong>ï¼šé™¤ Vue ä»¥å¤–æ— é¢å¤–ä¾èµ–ï¼ˆäºŒç»´ç è¯†åˆ«ç®—æ³•ä½¿ç”¨ <code>jsQR</code>ï¼‰</li>
<li><strong>TypeScript æ”¯æŒ</strong>ï¼šå®Œæ•´ç±»å‹å®šä¹‰ï¼ŒäºŒæ¬¡å¼€å‘èˆ’é€‚</li>
</ul>
<h3 data-id="heading-2">ğŸ“¦ å®‰è£…</h3>
<pre><code class="hljs language-bash" lang="bash">npm install vue-qrcode-scanner
<span class="hljs-comment"># æˆ–</span>
yarn add vue-qrcode-scanner
<span class="hljs-comment"># æˆ–</span>
pnpm add vue-qrcode-scanner
</code></pre>
<p>è¯†åˆ«äºŒç»´ç éœ€è¦ <code>jsQR</code> ç®—æ³•åº“ï¼Œè¯·ä¸€å¹¶å®‰è£…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm install jsqr
</code></pre>
<h3 data-id="heading-3">ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆComposable ç”¨æ³•ï¼‰</h3>
<p>æœ€ç®€é›†æˆæ–¹å¼ï¼šç›´æ¥åœ¨ç»„ä»¶é‡Œè°ƒç”¨ <code>useQRCodeScanner</code>ã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"file"</span> @<span class="hljs-attr">change</span>=<span class="hljs-string">"handleFileSelect"</span> <span class="hljs-attr">accept</span>=<span class="hljs-string">"image/*"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"parseQRCode"</span> <span class="hljs-attr">:disabled</span>=<span class="hljs-string">"isLoading"</span>&gt;</span>
      {{ isLoading ? "è§£æä¸­..." : "è§£æäºŒç»´ç " }}
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- å¯é€‰ï¼šCanvas ç”¨äºé¢„è§ˆ/è¾…åŠ©å¤„ç† --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"canvas"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display: none"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"resultMessage"</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"resultClass"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-html</span>=<span class="hljs-string">"resultMessage"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;
<span class="hljs-keyword">import</span> { useQRCodeScanner } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue-qrcode-scanner/composables"</span>;

<span class="hljs-keyword">const</span> selectedFile = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>);

<span class="hljs-keyword">const</span> {
  resultMessage,
  isLoading,
  qrCode,
  canvas,
  resultClass,
  parseQRFromFile,
  clearResult,
} = <span class="hljs-title function_">useQRCodeScanner</span>();

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleFileSelect</span> = (<span class="hljs-params">event</span>) =&gt; {
  selectedFile.<span class="hljs-property">value</span> = event.<span class="hljs-property">target</span>.<span class="hljs-property">files</span>[<span class="hljs-number">0</span>];
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">parseQRCode</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (selectedFile.<span class="hljs-property">value</span>) {
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">parseQRFromFile</span>(selectedFile.<span class="hljs-property">value</span>);
  }
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-4">ğŸŒ ä» URL è§£æ</h3>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { useQRCodeScanner } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue-qrcode-scanner/composables"</span>;

<span class="hljs-keyword">const</span> { parseQRFromUrl } = <span class="hljs-title function_">useQRCodeScanner</span>();

<span class="hljs-keyword">const</span> code = <span class="hljs-keyword">await</span> <span class="hljs-title function_">parseQRFromUrl</span>(<span class="hljs-string">"https://example.com/qrcode.png"</span>);
<span class="hljs-keyword">if</span> (code) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"äºŒç»´ç å†…å®¹:"</span>, code.<span class="hljs-property">data</span>);
}
</code></pre>
<h3 data-id="heading-5">ğŸ§© é«˜çº§ç”¨æ³•ï¼ˆç›´æ¥ä½¿ç”¨å·¥å…·å‡½æ•°ï¼‰</h3>
<p>ä½ ä¹Ÿå¯ä»¥è·³è¿‡ Composableï¼Œç›´æ¥ä½¿ç”¨åº•å±‚çš„å›¾åƒå¤„ç†ä¸æ‰«æå·¥å…·ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { imageProcessors, qrScanner } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue-qrcode-scanner"</span>;

<span class="hljs-comment">// 1) å›¾åƒé¢„å¤„ç†ï¼ˆç°åº¦åŒ–ã€OTSUã€è‡ªé€‚åº”é˜ˆå€¼ã€é”åŒ–ã€å¯¹æ¯”åº¦æ‹‰ä¼¸ç­‰ï¼‰</span>
<span class="hljs-keyword">const</span> imageData = ctx.<span class="hljs-title function_">getImageData</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, width, height);
<span class="hljs-keyword">const</span> processed = imageProcessors.<span class="hljs-title function_">preprocessImage</span>(imageData);

<span class="hljs-comment">// 2) å¤šåŒºåŸŸ/å¤šå°ºåº¦æ‰«æ</span>
<span class="hljs-keyword">const</span> code = qrScanner.<span class="hljs-title function_">scanRegions</span>(ctx, width, height);
<span class="hljs-keyword">if</span> (code) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"äºŒç»´ç å†…å®¹:"</span>, code.<span class="hljs-property">data</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ä½ç½®:"</span>, code.<span class="hljs-property">location</span>);
}
</code></pre>
<h3 data-id="heading-6">ğŸ›  API æ‘˜è¦</h3>
<h4 data-id="heading-7">Composable: <code>useQRCodeScanner()</code></h4>
<ul>
<li>å“åº”å¼çŠ¶æ€ï¼š<code>resultMessage</code>ã€<code>isLoading</code>ã€<code>qrCode</code>ã€<code>canvas</code>ã€<code>resultClass</code></li>
<li>æ–¹æ³•ï¼š
<ul>
<li><code>parseQRFromFile(file: File): Promise&lt;QRCode | null&gt;</code></li>
<li><code>parseQRFromUrl(url: string): Promise&lt;QRCode | null&gt;</code></li>
<li><code>clearResult(): void</code></li>
<li><code>showCanvasPreview(): void</code></li>
<li><code>hideCanvasPreview(): void</code></li>
</ul>
</li>
</ul>
<h4 data-id="heading-8">å·¥å…·å‡½æ•°: <code>imageProcessors</code></h4>
<ul>
<li><code>grayscale(imageData: ImageData): GrayData</code></li>
<li><code>otsuThreshold(grayData: Uint8ClampedArray): number</code></li>
<li><code>adaptiveThreshold(grayData, width, height, blockSize?, C?): Uint8ClampedArray</code></li>
<li><code>sharpen(grayData, width, height): Uint8ClampedArray</code></li>
<li><code>contrastStretch(grayData, minPercent?, maxPercent?): Uint8ClampedArray</code></li>
<li><code>preprocessImage(imageData: ImageData): ProcessedImage[]</code></li>
</ul>
<h4 data-id="heading-9">å·¥å…·å‡½æ•°: <code>qrScanner</code></h4>
<ul>
<li><code>tryDecodeQR(imageData: ImageData): QRCode | null</code></li>
<li><code>scanRegions(ctx, imgWidth, imgHeight): QRCode | null</code></li>
<li><code>scanMultiScale(ctx, canvasElement, imgWidth, imgHeight): QRCode | null</code></li>
<li><code>adjustCodeLocation(code, offsetX, offsetY): QRCode</code></li>
<li><code>cropImageRegion(ctx, x, y, width, height): ImageData</code></li>
</ul>
<h4 data-id="heading-10">ç±»å‹å®šä¹‰ï¼ˆèŠ‚é€‰ï¼‰</h4>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">QRCode</span> {
  <span class="hljs-attr">data</span>: <span class="hljs-built_in">string</span>;
  format?: <span class="hljs-built_in">string</span>;
  location?: <span class="hljs-title class_">QRCodeLocation</span>;
  regionName?: <span class="hljs-built_in">string</span>;
  preprocessMethod?: <span class="hljs-built_in">string</span>;
  scale?: <span class="hljs-built_in">number</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">QRCodeLocation</span> {
  <span class="hljs-attr">topLeftCorner</span>: { <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>; <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span> };
  <span class="hljs-attr">topRightCorner</span>: { <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>; <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span> };
  <span class="hljs-attr">bottomLeftCorner</span>: { <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>; <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span> };
  <span class="hljs-attr">bottomRightCorner</span>: { <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>; <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span> };
}
</code></pre>
<h3 data-id="heading-11">âš ï¸ æ³¨æ„äº‹é¡¹ &amp; å®æˆ˜ç»éªŒ</h3>
<ol>
<li><code>jsQR</code> ä¸ºè§£ææ ¸å¿ƒåº“ï¼Œè¯·ç¡®ä¿å·²å®‰è£…å¹¶æ­£ç¡®å¼•å…¥</li>
<li>æµè§ˆå™¨éœ€æ”¯æŒ Canvas APIï¼›è·¨åŸŸå›¾ç‰‡è¯·ç¡®ä¿ CORS å…è®¸ï¼Œå¦åˆ™æ— æ³•è¯»å–åƒç´ </li>
<li>å¤§å°ºå¯¸å›¾ç‰‡å»ºè®®å…ˆç­‰æ¯”å‹ç¼©åˆ°åˆé€‚å°ºå¯¸ï¼ˆå¦‚æœ€é•¿è¾¹ä¸è¶…è¿‡ 2000pxï¼‰ä»¥æå‡é€Ÿåº¦</li>
<li>å¤æ‚èƒŒæ™¯ä¸‹å»ºè®®å¤šå°è¯•é¢„å¤„ç†ç»„åˆï¼ˆåº“å†…å·²å†…ç½®å¤šç­–ç•¥è‡ªåŠ¨å°è¯•ï¼‰</li>
<li>å¦‚æœéœ€è¦åœ¨ UI ä¸­é«˜äº®äºŒç»´ç ä½ç½®ï¼Œå¯ç»“åˆè¿”å›çš„ <code>location</code> å››ç‚¹åæ ‡ç»˜åˆ¶</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React SSR æŠ€æœ¯å®ç°åŸç†]]></title>    <link>https://juejin.cn/post/7570659828811202594</link>    <guid>https://juejin.cn/post/7570659828811202594</guid>    <pubDate>2025-11-10T08:08:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570659828811202594" data-draft-id="7570341520550395919" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React SSR æŠ€æœ¯å®ç°åŸç†"/> <meta itemprop="keywords" content="React.js,ç®—æ³•"/> <meta itemprop="datePublished" content="2025-11-10T08:08:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="éª‘è‡ªè¡Œè½¦çš„ç å†œ"/> <meta itemprop="url" content="https://juejin.cn/user/4195392103390061"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React SSR æŠ€æœ¯å®ç°åŸç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4195392103390061/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    éª‘è‡ªè¡Œè½¦çš„ç å†œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T08:08:12.000Z" title="Mon Nov 10 2025 08:08:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>è‘—æœ‰ã€ŠReact æºç ã€‹ã€ŠReact ç”¨åˆ°çš„ä¸€äº›ç®—æ³•ã€‹ã€Šjavascriptåœ°æœˆæ˜Ÿã€‹ç­‰å¤šä¸ªä¸“æ ã€‚æ¬¢è¿å…³æ³¨ã€‚</p>
<p>æ–‡ç« ä¸å¥½å†™ï¼Œè¦æ˜¯æœ‰å¸®åŠ©åˆ«å¿˜äº†ç‚¹èµï¼Œæ”¶è—ï½ ä½ çš„é¼“åŠ±æ˜¯æˆ‘ç»§ç»­æŒ–å¹²è´§çš„çš„åŠ¨åŠ›ğŸ”¥ã€‚</p>
<p>å¦å¤–ï¼Œæœ¬æ–‡ä¸ºåŸåˆ›å†…å®¹ï¼Œå•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½éœ€æ³¨æ˜å‡ºå¤„ï¼Œæ„Ÿè°¢ç†è§£ï½</p>
</blockquote>
<h2 data-id="heading-0">ç¬¬ä¸€éƒ¨åˆ†</h2>
<p>ä¹‹å‰å†™è¿‡ä¸€ç¯‡<a href="https://juejin.cn/post/7549131152999596067" target="_blank" title="https://juejin.cn/post/7549131152999596067">React SSR è®¾è®¡åŸç†</a>é˜…è¯»é‡ä¸é«˜ï¼Œæ„Ÿè§‰å†™çš„è¿˜å¯ä»¥ï¼Œæ‰€ä»¥é‡æ–°æ•´ç†å’Œå¢åŠ äº†ä¸€äº›å†…å®¹ï¼Œå†å‘ä¸€éã€‚æœ«å°¾çš„â€œæ€»ç»“â€éå¸¸å€¼å¾—çœ‹ä¸€ä¸‹ï¼Œæ„Ÿè§‰æ²¡æœ‰äººæŠŠSSRè§£è¯»çš„è¿™ä¹ˆå½»åº•ã€‚è®°å¾—ç‚¹èµå“¦ï½ğŸ‘ã€‚</p>
<h3 data-id="heading-1">SSRæ­å»º å››ä¸ªè§’è‰²</h3>
<p>serveræœåŠ¡å™¨(server.js) + server ssrè¿”å›çº¯htmlé¦–é¡µï¼ˆentry-server.jsx) + client hydrateRootæ³¨æ°´ç»™htmlï¼ŒæŠŠ Fiber æ ‘æŒ‚æ¥åˆ°ç°æœ‰ DOM ä¸Š(å¯¹åº”client.jsx)ï¼Œç»™ DOM èŠ‚ç‚¹åŠ ä¸Š React çš„äº‹ä»¶ç»‘å®šã€å†…éƒ¨çŠ¶æ€ï¼Œä½¿ DOM å˜â€œæ´»â€ã€‚</p>
<p>æµç¨‹ï¼šè¯·æ±‚serveræœåŠ¡å™¨ï¼ˆserver.js)ï¼Œè¿”å›é¦–é¡µå†…å®¹ï¼ˆentry-server.jsx) ----&gt;  é¦–é¡µä¸‹è½½è„šæœ¬client.jsxï¼Œclient.jsxæ‰§è¡ŒhydrateRootæ°´åˆï¼ŒReactæ¥ç®¡ã€‚</p>
<p>æ‰€ä»¥èƒ½çœ‹åˆ°å››ä¸ªè§’è‰²:ã€server.jsã€‘ã€entry-server.jsxã€‘ã€client.jsxã€‘ã€App.jsx LazyComp.jsxã€‘ã€‚<br/>
å…¶ä¸­ã€App.jsx LazyComp.jsxã€‘è¿™ä¸¤ä¸ªå±äºå…¬å…±çš„ï¼ŒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½ç”¨åˆ°ã€‚</p>
<pre><code class="hljs language-sql" lang="sql">my<span class="hljs-operator">-</span>react<span class="hljs-operator">-</span>app
 â”œâ”€â”€ dist<span class="hljs-operator">/</span>
 â”‚    â”œâ”€â”€ server<span class="hljs-operator">/</span>
 â”‚    â”‚    â””â”€â”€ server.js   â† è¿™ä¸ªåœ¨ Node è·‘ï¼Œä¸ä¼šå‘ç»™å®¢æˆ·ç«¯ æ‰“åŒ…å‰æ˜¯entry<span class="hljs-operator">-</span>server.jsx
 â”‚    â””â”€â”€ client<span class="hljs-operator">/</span>
 â”‚         â””â”€â”€ client.js         â† è¿™ä¸ªæ‰ä¼šå‘ç»™æµè§ˆå™¨
 â”œâ”€â”€ server.js  å’Œä¸Šé¢çš„server.jsä¸åŒåŒä¸€ä¸ªï¼Œnode server.jså¯åŠ¨çš„æ˜¯è¿™ä¸ª

åœ¨æä¾›çš„ä¾‹å­ä¸­è¿˜æœ‰App.jsx LazyComp.jsxçš„æ‰“åŒ…æ²¡æœ‰åœ¨ä¸Šæ–¹ä½“ç°ï¼Œç®€åŒ–é€»è¾‘ï¼Œä¸»è¦å°±æ˜¯è¿™<span class="hljs-number">3</span>æ–¹ã€‚
App  LazyCompåœ¨æœåŠ¡çš„å’Œå®¢æˆ·ç«¯éƒ½è¢«ä½¿ç”¨å±äºå…¬å…±çš„ã€‚
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/36b1d503216543e4811900889ba2724b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aqR6Ieq6KGM6L2m55qE56CB5Yac:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763368185&amp;x-signature=AYJBcNjiqbcA55rqwBlbGkpD67w%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>æˆ‘æ”¹äº†æ‰“åŒ…ç›®å½•éƒ¨åˆ†çš„é…ç½®ï¼Œæ‰“åŒ…åçš„ç›®å½•ä¸ä¸€æ ·äº†ï¼Œä¸å½±å“é˜…è¯»</p>
</blockquote>
<h3 data-id="heading-2">è¿è¡Œä¸¤éReactç»„ä»¶</h3>
<p>åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œä¸€éReactç»„ä»¶ï¼Œç”Ÿæˆhtmlåè¿”å›çº¯htmlç»™å®¢æˆ·ç«¯ï¼Œå®Œæˆé¦–æ¬¡æ¸²æŸ“ã€‚<br/>
åœ¨å®¢æˆ·ç«¯æ‰§è¡Œclient.jsè¿›è¡Œæ°´åˆï¼Œå†æ¬¡æ‰§è¡Œä¸€éReactç»„ä»¶ï¼Œåˆ›å»ºFiberã€æŒ‚æ¥åˆ°DOMã€ç»‘å®šäº‹ä»¶ç­‰ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx">entry-server.<span class="hljs-property">jsx</span>
<span class="hljs-keyword">const</span> { pipe } = <span class="hljs-title function_">renderToPipeableStream</span>(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>, {...<span class="hljs-title function_">pipe</span>(res)...})

æ³¨æ„è¿™é‡Œçš„&lt;<span class="hljs-title class_">App</span>/&gt;ç»è¿‡æ‰“åŒ…åæ˜¯ï¼Œ
<span class="hljs-keyword">const</span> { pipe } = <span class="hljs-title function_">renderToPipeableStream</span>(<span class="hljs-comment">/* @__PURE__ */</span> <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-title class_">App</span>, <span class="hljs-literal">null</span>), {...<span class="hljs-title function_">pipe</span>(res)...})
æœåŠ¡ç«¯è¿è¡Œ<span class="hljs-title class_">React</span>.<span class="hljs-property">createElement</span>å¾—åˆ°<span class="hljs-title class_">App</span>çš„htmlã€‚

æ˜æ˜¾å·²ç»è¿è¡Œäº†ä¸€é<span class="hljs-title class_">React</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-title class_">App</span>, <span class="hljs-literal">null</span>)ï¼Œçº¯<span class="hljs-title class_">App</span>çš„htmlã€‚
ä¸‹é¢åœ¨å®¢æˆ·ç«¯è¿˜ä¼šè¿è¡Œä¸€éã€‚
</code></pre>
<p>è¿”å›Appçš„çº¯htmlï¼Œé€šè¿‡pipeèƒ½è·å–ï¼Œåœ¨optionä¸­æ³¨å…¥ã€‚</p>
<p>å®¢æˆ·ç«¯ä¼šå†è¿è¡Œä¸€éã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">hydrateRoot</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"root"</span>), <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>);
æ‰“åŒ…åï¼š
<span class="hljs-title function_">hydrateRoot</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"root"</span>), <span class="hljs-comment">/* @__PURE__ */</span> <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-title class_">App</span>, <span class="hljs-literal">null</span>));
</code></pre>
<p>è¿™ä¸€éå«æ°´åˆã€‚æ²¡æœ‰æ°´åˆå‰æ˜¯çº¯htmlçš„é¡µé¢ã€‚æ°´åˆåè¢«Reactæ¥ç®¡ã€‚<br/>
ä¾‹å¦‚åœ¨åé¢çš„å®è·µä¾‹å­ä¸­ï¼Œç¬¬8ç§’åœ¨vscodeæ‰“å°ä¸€æ¬¡ï¼Œç¬¬16ç§’åœ¨æµè§ˆå™¨æ‰“å°ä¸€æ¬¡ã€‚</p>
<h3 data-id="heading-3">HTMLçš„æ°´åˆ</h3>
<p>æ°´åˆå°±æ˜¯ç»™æœåŠ¡ç«¯çš„è¿”å›çš„HTMLçš„DOMæ·»åŠ internalInstanceKeyï¼Œèƒ½æ‰¾åˆ°å®ƒçš„Fiberã€‚</p>
<p>å˜é‡internalInstanceKeyï¼Œå€¼ç±»ä¼¼äº__reactFiber$chytmrjmd38ï¼Œ__reactFiber$+éšæœºæ•°ã€‚<br/>
æ¯ä¸ªçœŸå®DOMéƒ½æœ‰__reactFiber$...å±æ€§ï¼ŒæŒ‡å‘çœŸå®DOMå¯¹åº”çš„Fiber Nodeã€‚<br/>
å¦‚æœçœŸå®DOMæ²¡æœ‰__reactFiber$...è¡¨ç¤ºè¿™ä¸ªDOMæ²¡æœ‰å—åˆ°Reactçš„ç®¡ç†ï¼Œä¾‹å¦‚SSRæ—¶æœåŠ¡ç«¯è¿”å›çš„HTMLã€‚<br/>
æˆ‘ç®€å•çš„æŠŠâ€œç»™DOMæ·»åŠ __reactFiber$..å±æ€§â€ä¸€èµ·å½’åˆ°hydrateRoot()ã€‚ï¼ˆå®é™…hydrateRootæ²¡æœ‰åšè¿™ä»¶äº‹ã€‚æ·»åŠ å±æ€§æ˜¯è§¦å‘ä»»æ„äº‹ä»¶çš„æ—¶å€™åšçš„ï¼‰ï¼Œæœ‰å¯¹åº”çš„Fiber Nodeï¼Œè¿™ä¸ªDOMå°±è¢«Reactæ¥ç®¡äº†ã€‚</p>













<table><thead><tr><th>æ°´åˆå‰ åªæ˜¯ç®€å•çš„html æ²¡æœ‰__reactFiber$...å±æ€§</th><th>æ°´åˆå å¤šäº†__reactFiber$...å±æ€§</th></tr></thead><tbody><tr><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/44c7884d899d407ea03b98ad53f0c01f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aqR6Ieq6KGM6L2m55qE56CB5Yac:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763368185&amp;x-signature=h2tmXyTC6iZoEVCLT3s7Otim0oY%3D" alt="" loading="lazy"/></td><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4ed097f450f474d80e18002ed04c76b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aqR6Ieq6KGM6L2m55qE56CB5Yac:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763368185&amp;x-signature=LbKLxBy56i%2B1bccgHZxwI7DqFfU%3D" alt="" loading="lazy"/></td></tr></tbody></table>
<h3 data-id="heading-4">æ³¨é‡ŠèŠ‚ç‚¹</h3>
<p>SSRç”Ÿæˆçš„HTMLå¸¦æœ‰æ³¨é‡Š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- $? --&gt;</span>  æœ‰internalInstanceKeyã€å—åˆ°ç®¡ç†
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>        æ²¡æœ‰internalInstanceKeyã€æ²¡æœ‰å—åˆ°ç®¡ç†
    Loading...
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- /$ --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- $ --&gt;</span>  æœ‰internalInstanceKeyã€å—åˆ°ç®¡ç†
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>        æ²¡æœ‰internalInstanceKeyã€æ²¡æœ‰å—åˆ°ç®¡ç†
    Hello World!
  <span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- /$ --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>Reactå€ŸåŠ©æ³¨é‡ŠèŠ‚ç‚¹ï¼Œå¿«é€Ÿæ‰¾åˆ°SSRå†…å®¹ã€‚å¦‚æœæ²¡æœ‰æ³¨é‡ŠèŠ‚ç‚¹ï¼Œæ— æ³•åˆ†è¾¨SSRå†…å®¹æˆ–è€…è¦ä»æ•´ä¸ªé¡µé¢å…¨éƒ¨èŠ‚ç‚¹ä¸­ä¸€ä¸ªä¸€ä¸ªæŸ¥æ‰¾ã€‚<br/>
Reactä¸­ä¸“é—¨æŸ¥æ‰¾æ³¨é‡ŠèŠ‚ç‚¹çš„å‡½æ•°<code>getParentSuspenseInstance</code>:</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!--$--&gt;</span>                    â† Suspense A å¼€å§‹ (pending)  æ‰¾åˆ°è¿™ä¸ªèŠ‚ç‚¹
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Content A<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>      æ³¨é‡Šå’Œå†…å®¹æ˜¯å…„å¼ŸèŠ‚ç‚¹
  <span class="hljs-comment">&lt;!--$--&gt;</span>                  â† Suspense B å¼€å§‹ (pending)
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>åµŒå¥—<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
  <span class="hljs-comment">&lt;!--/$--&gt;</span>                 â† Suspense B ç»“æŸ
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"target"</span>&gt;</span>Target<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>  â† targetInstance  ä»è¿™é‡Œå¼€å§‹
<span class="hljs-comment">&lt;!--/$--&gt;</span>                   â† Suspense A ç»“æŸ
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getParentSuspenseInstance</span>(<span class="hljs-params">targetInstance</span>) {
  <span class="hljs-keyword">var</span> node = targetInstance.<span class="hljs-property">previousSibling</span>; 
  <span class="hljs-keyword">var</span> depth = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">while</span> (node) {
    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">nodeType</span> === <span class="hljs-variable constant_">COMMENT_NODE</span>) {
      <span class="hljs-keyword">var</span> data = node.<span class="hljs-property">data</span>;<span class="hljs-comment">//nodeæ˜¯`&lt;!--$--&gt;`, `&lt;!--$!--&gt;`, `&lt;!--$?--&gt;`, `&lt;!--/$--&gt;` ã€‚dataæ˜¯`$``$!``$?``/$`ã€‚</span>

      <span class="hljs-keyword">if</span> (data === <span class="hljs-variable constant_">SUSPENSE_START_DATA</span> || <span class="hljs-comment">// $</span>
          data === <span class="hljs-variable constant_">SUSPENSE_FALLBACK_START_DATA</span> ||  <span class="hljs-comment">// $!</span>
          data === <span class="hljs-variable constant_">SUSPENSE_PENDING_START_DATA</span>) { <span class="hljs-comment">// $?</span>
        <span class="hljs-comment">// é‡åˆ° Suspense å¼€å§‹</span>
        <span class="hljs-keyword">if</span> (depth === <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">return</span> node; <span class="hljs-comment">// æ‰¾åˆ°äº†æœ€å¤–å±‚æœªé—­åˆçš„ Suspenseï¼Œè¿”å›</span>
        } <span class="hljs-keyword">else</span> {
          depth--; <span class="hljs-comment">// é€€å‡ºä¸€å±‚åµŒå¥—</span>
        }
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data === <span class="hljs-variable constant_">SUSPENSE_END_DATA</span>) { <span class="hljs-comment">// /$</span>
        depth++; <span class="hljs-comment">// é‡åˆ°ç»“æŸï¼Œè¯´æ˜æˆ‘ä»¬â€œè¿›å…¥â€äº†ä¸€ä¸ªæ›´å¤–å±‚çš„ Suspense èŒƒå›´</span>
      }
    }

    node = node.<span class="hljs-property">previousSibling</span>; <span class="hljs-comment">//ä»åå¾€å‰æ‰¾</span>
  }

  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</code></pre>
<p>è¿”å›&lt;!-- $ --&gt;ç­‰çš„DOMã€‚</p>
<h2 data-id="heading-5">ç¬¬äºŒéƒ¨åˆ†</h2>
<h3 data-id="heading-6">SSRæ ¸å¿ƒæ¦‚å¿µ</h3>
<p>ç”¨å®˜è¯æ¥è®²ï¼š</p>
<ul>
<li>åŒæ„ï¼ˆIsomorphic / Universal Renderingï¼‰æŒ‡ React ä»£ç æ—¢èƒ½è¿è¡Œåœ¨æœåŠ¡ç«¯ï¼ˆNode.jsï¼‰åˆèƒ½è¿è¡Œåœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ã€‚å…¶å®å°±æ˜¯åœ¨æœåŠ¡çš„æ‰§è¡Œä¸€éreactç»„ä»¶ã€‚</li>
<li>æ³¨æ°´ ï¼ˆHydrationï¼‰æµè§ˆå™¨æ¥æ”¶åˆ°æœåŠ¡ç«¯ç”Ÿæˆçš„ HTML åï¼ŒReact <strong>ä¸ä¼šé‡æ–°æ¸²æŸ“ DOM</strong>ï¼Œè€Œæ˜¯â€œæ³¨æ°´â€â€”â€”æŠŠ <strong>Fiber æ ‘æŒ‚æ¥åˆ°ç°æœ‰ DOM</strong> ä¸Šã€‚ç»™ DOM èŠ‚ç‚¹åŠ ä¸Š React çš„äº‹ä»¶ç»‘å®šã€å†…éƒ¨çŠ¶æ€ï¼Œä½¿ DOM å˜â€œæ´»â€ã€‚</li>
<li>è„±æ°´ (Dehydration)ï¼šåœ¨ React 18 é‡Œï¼Œ<strong>Suspense è¾¹ç•Œå¯ä»¥è¢«â€œè„±æ°´â€</strong> ï¼Œå³ä¿ç•™ fallback æˆ– HTML ç‰‡æ®µï¼Œä½†ä¸ç«‹å³ hydrateã€‚ç­‰åˆ°ç”¨æˆ·äº¤äº’æˆ–èµ„æºåˆ°è¾¾ï¼Œå†å¯¹å±€éƒ¨è¿›è¡Œ hydrationã€‚</li>
</ul>
<p>åŒæ„æ˜¯ä¸€ä¸ªå®è§‚ç›®æ ‡ï¼š å®ƒçš„ç›®æ ‡æ˜¯è®©åŒä¸€å¥—ä»£ç æ—¢èƒ½åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œï¼ˆç”Ÿæˆ HTMLï¼‰ï¼Œåˆèƒ½åœ¨å®¢æˆ·ç«¯ä¸Šè¿è¡Œï¼ˆå¤„ç†äº¤äº’ï¼‰ã€‚å®ƒæè¿°çš„æ˜¯ä¸€ç§<strong>æ¶æ„æ¨¡å¼</strong>ã€‚<br/>
è„±æ°´/æ³¨æ°´æ˜¯ä¸€ä¸ªå¾®è§‚å®ç°ï¼š å®ƒæ˜¯å®ç°åŒæ„è¿™ä¸ª<strong>ç›®æ ‡</strong>æ‰€å¿…é¡»çš„<strong>æŠ€æœ¯æ‰‹æ®µ</strong>ã€‚</p>
<p>å…¶å®å°±æ˜¯æœåŠ¡ç«¯æ‰§è¡Œä¸€éReactç»„ä»¶è¿”å›HTMLã€‚ï¼ˆæœåŠ¡ç«¯æ¸²æŸ“ï¼‰<br/>
HTMLä¸Šçš„DOMæ‰¾ä¸åˆ°Fiberã€‚ï¼ˆè„±æ°´çš„ï¼‰<br/>
æŠŠFiberå…³è”åˆ°DOMï¼ŒDOMèƒ½æ‰¾åˆ°è‡ªå·±çš„Fiberï¼ˆæ³¨æ°´ï¼‰</p>
<h2 data-id="heading-7">ç¬¬ä¸‰éƒ¨åˆ†</h2>
<h3 data-id="heading-8">å®è·µä¾‹å­</h3>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// src/App.jsx</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { <span class="hljs-title class_">Suspense</span>, lazy } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title class_">LazyComp</span> = <span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½è¿è¡Œä¸€æ¬¡LazyComp'</span>);---è¿è¡Œä¸¤é<span class="hljs-title class_">React</span>ç»„ä»¶ï¼šåœ¨vscodeæ§åˆ¶å°æ‰“å°ä¸€æ¬¡ï¼Œåœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰“å°ä¸€æ¬¡  ç¬¬<span class="hljs-number">8</span>ç§’åœ¨vscodeæ‰“å°ï¼Œç¬¬<span class="hljs-number">16</span>ç§’åœ¨æµè§ˆå™¨æ‰“å°

      <span class="hljs-title function_">resolve</span>(<span class="hljs-keyword">import</span>(<span class="hljs-string">'./LazyComp'</span>));
    }, <span class="hljs-number">8000</span>); <span class="hljs-comment">// æ¨¡æ‹Ÿ 8 ç§’å»¶è¿Ÿ</span>
  });
});

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">LazyComp</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>;
</code></pre>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">//client.jsx</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { hydrateRoot } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-dom/client"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./App.jsx"</span>;

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">22222</span>);
<span class="hljs-title function_">hydrateRoot</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"root"</span>), <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>);
</code></pre>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// entry-server.jsx</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { renderToPipeableStream } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-dom/server"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./App.jsx"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params">res</span>) {
  <span class="hljs-keyword">const</span> { pipe } = <span class="hljs-title function_">renderToPipeableStream</span>(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>, {
    <span class="hljs-title function_">onShellReady</span>(<span class="hljs-params"/>) {
      res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">"content-type"</span>, <span class="hljs-string">"text/html"</span>);
      res.<span class="hljs-title function_">write</span>(<span class="hljs-string">`&lt;!DOCTYPE html&gt;
        &lt;html&gt;
          &lt;head&gt;
            &lt;title&gt;My React App&lt;/title&gt;
            &lt;meta charset="UTF-8"&gt;
          &lt;/head&gt;
          &lt;body&gt;
            &lt;div id="root"&gt;`</span>);
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">222</span>);
      <span class="hljs-title function_">pipe</span>(res);<span class="hljs-comment">//å¦‚æœæŠŠconst {pipe}æ³¨é‡Šæ‰ï¼Œä¼šæŠ¥é”™ pipe is not defined;</span>
      res.<span class="hljs-title function_">write</span>(<span class="hljs-string">`&lt;/div&gt;
          &lt;/body&gt;
          &lt;script type="module" src="/dist/client.js"&gt;&lt;/script&gt;
        &lt;/html&gt;`</span>);
    },
  });
}
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// LazyComp.jsx</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">LazyComp</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>âœ…Hello !<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>;
}
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//server.js  åœ¨æ ¹ç›®å½•ï¼</span>
<span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">"express"</span>;
<span class="hljs-keyword">import</span> { createServer <span class="hljs-keyword">as</span> createViteServer } <span class="hljs-keyword">from</span> <span class="hljs-string">"vite"</span>;
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">"path"</span>;
<span class="hljs-keyword">import</span> { fileURLToPath } <span class="hljs-keyword">from</span> <span class="hljs-string">"url"</span>;

<span class="hljs-keyword">const</span> __dirname = path.<span class="hljs-title function_">dirname</span>(<span class="hljs-title function_">fileURLToPath</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>));

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">start</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();

  <span class="hljs-comment">// 1. åˆ›å»º Vite dev server (ä¸­é—´ä»¶æ¨¡å¼)</span>
  <span class="hljs-keyword">const</span> vite = <span class="hljs-keyword">await</span> <span class="hljs-title function_">createViteServer</span>({
    <span class="hljs-attr">server</span>: { <span class="hljs-attr">middlewareMode</span>: <span class="hljs-literal">true</span> },
    <span class="hljs-attr">appType</span>: <span class="hljs-string">"custom"</span>
  });

  app.<span class="hljs-title function_">use</span>(vite.<span class="hljs-property">middlewares</span>);

  <span class="hljs-comment">// 2. SSR è·¯ç”±</span>
  app.<span class="hljs-title function_">get</span>(<span class="hljs-string">"/"</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// const { render } = await vite.ssrLoadModule("/src/entry-server.jsx");</span>
      <span class="hljs-keyword">const</span> { render } = <span class="hljs-keyword">await</span> vite.<span class="hljs-title function_">ssrLoadModule</span>(<span class="hljs-string">"/dist/server.js"</span>);
      <span class="hljs-title function_">render</span>(res);
    } <span class="hljs-keyword">catch</span> (e) {
      vite.<span class="hljs-title function_">ssrFixStacktrace</span>(e);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(e);
      res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">end</span>(e.<span class="hljs-property">message</span>);
    }
  });

  app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ğŸš€ SSR server running at http://localhost:3000"</span>);
  });
}

<span class="hljs-title function_">start</span>();

</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// vite.config.js</span>
<span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>;
<span class="hljs-comment">// import react from '@vitejs/plugin-react';</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-comment">// plugins: [react()],//å¯¼å…¥React</span>
  <span class="hljs-attr">define</span>: {
    <span class="hljs-string">"process.env.NODE_ENV"</span>: <span class="hljs-string">'"development"'</span>,
  },
  <span class="hljs-comment">// minify: false,</span>
  <span class="hljs-attr">build</span>: {
    <span class="hljs-attr">ssr</span>: <span class="hljs-literal">true</span>,<span class="hljs-comment">//å¿…é¡»æ˜¯true,æ˜¯falseæ‰“åŒ…åentry-server.jsxè¿”å›renderä¸è¿”å›</span>
    <span class="hljs-comment">// sourcemap: true, // ç”Ÿæˆ client.js.map</span>
    <span class="hljs-attr">rollupOptions</span>: {
      <span class="hljs-attr">input</span>: {
        <span class="hljs-attr">server</span>: <span class="hljs-string">'src/entry-server.jsx'</span>, 
        <span class="hljs-attr">client</span>: <span class="hljs-string">"src/client.jsx"</span>
      },
      <span class="hljs-attr">output</span>: {
        <span class="hljs-attr">entryFileNames</span>: <span class="hljs-string">"[name].js"</span>,
      }
    }
  },
});
</code></pre>
<ul>
<li>å¦‚æœæŠŠconst {pipe}æ³¨é‡Šæ‰ï¼Œä¼šæŠ¥é”™ pipe is not defined;</li>
<li>pipeçš„åŸç†æ˜¯res.writeã€‚å†…éƒ¨å€Ÿç”¨TextEncoder.encodeInto()ã€unit8arrayæœ€åres.writeã€‚<br/>
textEncoder.encodeInto()èƒ½æŠŠæ•°æ®å†™å…¥unit8arrayã€‚</li>
</ul>
<blockquote>
<p>æœ¬ä¾‹å­çš„è¡¥å……è¯´æ˜viteçš„index.htmlå’Œæ‰“åŒ…:</p>
<p>ä¸ºäº†ç®€åŒ–ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­è™½ç„¶å­˜åœ¨main.jsxã€index.htmlï¼Œä½†æ˜¯æ²¡æœ‰ç”¨åˆ°index.htmlï¼Œè€Œæ˜¯åœ¨entry-server.jsxæ‰‹å†™çš„htmlã€‚<br/>
è¿™æ ·çš„ç¼ºç‚¹æ˜¯ä¸èƒ½åˆ©ç”¨viteæ‰“åŒ…è‡ªåŠ¨æ³¨å…¥index.htmlçš„å†…å®¹åŠŸèƒ½ã€‚</p>
</blockquote>
<h3 data-id="heading-9">pipeçš„åŸç†</h3>
<ul>
<li>completeWritingæŠŠloading...å’Œâœ…Helloå‘é€è¿‡å»ã€‚åŸç†å°±æ˜¯res.writeã€‚resæ˜¯expressè¯·æ±‚çš„responseã€‚</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//node_modules/react-dom/cjs/react-dom-server.node.development.js</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">completeWriting</span>(<span class="hljs-params">destination</span>) {<span class="hljs-comment">//destinationå°±æ˜¯res</span>
  <span class="hljs-keyword">if</span> (currentView &amp;&amp; writtenBytes &gt; <span class="hljs-number">0</span>) {<span class="hljs-comment">//currentViewå°±æ˜¯unit8Array</span>
    <span class="hljs-comment">// console.log(destination.write(currentView.subarray(0, 64)));</span>
    <span class="hljs-comment">// console.log(destination.write(currentView.subarray(0, 499)));</span>
    destination.<span class="hljs-title function_">write</span>(currentView.<span class="hljs-title function_">subarray</span>(<span class="hljs-number">0</span>, writtenBytes));
  }
  currentView = <span class="hljs-literal">null</span>;
  writtenBytes = <span class="hljs-number">0</span>;
  destinationHasCapacity = <span class="hljs-literal">true</span>;
}
</code></pre>













<table><thead><tr><th/><th/></tr></thead><tbody><tr><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6d6c54c6e56341b8a24d332fabdd8890~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aqR6Ieq6KGM6L2m55qE56CB5Yac:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763368185&amp;x-signature=w%2FenA%2F8KxmajZU07vg1CqU5735o%3D" alt="" loading="lazy"/></td><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f80f09b5b8104c918fddf82a591b69db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aqR6Ieq6KGM6L2m55qE56CB5Yac:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763368185&amp;x-signature=eA1Ymlo96gmoOHYAyiV%2B3MoKQ3Y%3D" alt="" loading="lazy"/></td></tr></tbody></table>
<ul>
<li>send$1æŠŠæ–‡ä»¶å‘é€è¿‡å»  è¿™ä¼¼ä¹æ˜¯viteå¹²çš„</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//node_modules/vite/dist/node/chunks/dep-BcnkIxro.js</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">send$1</span>(<span class="hljs-params">req, res, content, type, options</span>) {
  <span class="hljs-keyword">const</span> {
    etag = <span class="hljs-title function_">getEtag</span>(content, { <span class="hljs-attr">weak</span>: <span class="hljs-literal">true</span> }),
    cacheControl = <span class="hljs-string">"no-cache"</span>,
    headers,
    map
  } = options;
  <span class="hljs-keyword">if</span> (res.<span class="hljs-property">writableEnded</span>) {
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">if</span> (req.<span class="hljs-property">headers</span>[<span class="hljs-string">"if-none-match"</span>] === etag) {
    res.<span class="hljs-property">statusCode</span> = <span class="hljs-number">304</span>;
    res.<span class="hljs-title function_">end</span>();
    <span class="hljs-keyword">return</span>;
  }
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">"Content-Type"</span>, alias[type] || type);
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">"Cache-Control"</span>, cacheControl);
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">"Etag"</span>, etag);
  <span class="hljs-keyword">if</span> (headers) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> name <span class="hljs-keyword">in</span> headers) {
      res.<span class="hljs-title function_">setHeader</span>(name, headers[name]);
    }
  }
  <span class="hljs-keyword">if</span> (map &amp;&amp; <span class="hljs-string">"version"</span> <span class="hljs-keyword">in</span> map &amp;&amp; map.<span class="hljs-property">mappings</span>) {
    <span class="hljs-keyword">if</span> (type === <span class="hljs-string">"js"</span> || type === <span class="hljs-string">"css"</span>) {
      content = <span class="hljs-title function_">getCodeWithSourcemap</span>(type, content.<span class="hljs-title function_">toString</span>(), map);
    }
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">"js"</span> &amp;&amp; (!map || map.<span class="hljs-property">mappings</span> !== <span class="hljs-string">""</span>)) {
    <span class="hljs-keyword">const</span> code = content.<span class="hljs-title function_">toString</span>();
    <span class="hljs-keyword">if</span> (convertSourceMap.<span class="hljs-property">mapFileCommentRegex</span>.<span class="hljs-title function_">test</span>(code)) {
      debug$3?.(<span class="hljs-string">`Skipped injecting fallback sourcemap for <span class="hljs-subst">${req.url}</span>`</span>);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">const</span> urlWithoutTimestamp = <span class="hljs-title function_">removeTimestampQuery</span>(req.<span class="hljs-property">url</span>);
      <span class="hljs-keyword">const</span> ms = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MagicString</span>(code);
      content = <span class="hljs-title function_">getCodeWithSourcemap</span>(
        type,
        code,
        ms.<span class="hljs-title function_">generateMap</span>({
          <span class="hljs-attr">source</span>: path$d.<span class="hljs-title function_">basename</span>(urlWithoutTimestamp),
          <span class="hljs-attr">hires</span>: <span class="hljs-string">"boundary"</span>,
          <span class="hljs-attr">includeContent</span>: <span class="hljs-literal">true</span>
        })
      );
    }
  }
  res.<span class="hljs-property">statusCode</span> = <span class="hljs-number">200</span>;
  res.<span class="hljs-title function_">end</span>(content);
  <span class="hljs-keyword">return</span>;
}
</code></pre>

















<table><thead><tr><th/><th/></tr></thead><tbody><tr><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6e125ed16cc4620ad584d3426933d56~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aqR6Ieq6KGM6L2m55qE56CB5Yac:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763368185&amp;x-signature=EJdYzlDp5l15LhfPSbnYTRMlm94%3D" alt="" loading="lazy"/></td><td>å¾…å¤„ç†<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9fd898a72be4d8ba12e9244657b5e42~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aqR6Ieq6KGM6L2m55qE56CB5Yac:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763368185&amp;x-signature=0IlHec2JDFo6co%2FHKMxAm6aoLCQ%3D" alt="" loading="lazy"/></td></tr><tr><td>çŠ¶æ€ç 200 <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bee5add7c834471e95b56679fc3c2a26~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aqR6Ieq6KGM6L2m55qE56CB5Yac:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763368185&amp;x-signature=%2FGIkWCzOOqs3ty3S2dgDwYh5HZE%3D" alt="" loading="lazy"/></td><td/></tr></tbody></table>
<h3 data-id="heading-10">æ’å…¥è„šæœ¬ç‰‡æ®µ</h3>
<p>SSRå¤šæ¬¡ç”¨åˆ°äº†<code>æ’å…¥è„šæœ¬ç‰‡æ®µ</code>çš„æŠ€æœ¯ï¼Œä¹Ÿå°±æ˜¯æ’å…¥&lt;script&gt;ï¼Œä½œä¸ºæ•´ä¸ªSSRæŠ€æœ¯å®ç°çš„ä¸€éƒ¨åˆ†ã€‚ä¾‹å¦‚å‰é¢çš„æ’å…¥client.jsï¼Œä¾‹å¦‚å‰é¢çš„çŠ¶æ€çš„æ³¨æ°´ï¼Œè¿˜æœ‰è¿™é‡Œçš„$RCå‡½æ•°:</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/efe38241ccee4c18b8fdb641f0b587db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aqR6Ieq6KGM6L2m55qE56CB5Yac:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763368185&amp;x-signature=gLAG%2BnUAJhJS9vUVL0CXRzjGueo%3D" alt="" loading="lazy"/></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//node_modules/react-dom/cjs/react-dom-server.node.development.js</span>
<span class="hljs-keyword">var</span> completeBoundaryFunction = <span class="hljs-string">'function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&amp;&amp;8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&amp;&amp;"$?"!==d&amp;&amp;"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&amp;&amp;a._reactRetry()}}'</span>;
<span class="hljs-keyword">var</span> completeBoundaryScript1Full = <span class="hljs-title function_">stringToPrecomputedChunk</span>(completeBoundaryFunction + <span class="hljs-string">';$RC("'</span>);

<span class="hljs-keyword">function</span> <span class="hljs-title function_">writeCompletedBoundaryInstruction</span>(<span class="hljs-params">destination, responseState, boundaryID, contentSegmentID</span>) {
  <span class="hljs-title function_">writeChunk</span>(destination, responseState.<span class="hljs-property">startInlineScript</span>);

  <span class="hljs-keyword">if</span> (!responseState.<span class="hljs-property">sentCompleteBoundaryFunction</span>) {
    <span class="hljs-comment">// The first time we write this, we'll need to include the full implementation.</span>
    responseState.<span class="hljs-property">sentCompleteBoundaryFunction</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-title function_">writeChunk</span>(destination, completeBoundaryScript1Full);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Future calls can just reuse the same function.</span>
    <span class="hljs-title function_">writeChunk</span>(destination, completeBoundaryScript1Partial);
  }

  <span class="hljs-keyword">if</span> (boundaryID === <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'An ID must have been assigned before we can complete the boundary.'</span>);
  }

  <span class="hljs-keyword">var</span> formattedContentID = <span class="hljs-title function_">stringToChunk</span>(contentSegmentID.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>));
  <span class="hljs-title function_">writeChunk</span>(destination, boundaryID);
  <span class="hljs-title function_">writeChunk</span>(destination, completeBoundaryScript2);
  <span class="hljs-title function_">writeChunk</span>(destination, responseState.<span class="hljs-property">segmentPrefix</span>);
  <span class="hljs-title function_">writeChunk</span>(destination, formattedContentID);
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">writeChunkAndReturn</span>(destination, completeBoundaryScript3);
}
</code></pre>
<p>æŠŠå˜é‡å‘½åæˆæœ‰æ„ä¹‰çš„å˜é‡åï¼Œå–æ¶ˆæ‰å‹ç¼©åœ¨çœ‹ä¸€ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">$RC</span>(<span class="hljs-params">a,b</span>){a=<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(a);b=<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(b);b.<span class="hljs-property">parentNode</span>.<span class="hljs-title function_">removeChild</span>(b);<span class="hljs-keyword">if</span>(a){a=a.<span class="hljs-property">previousSibling</span>;<span class="hljs-keyword">var</span> f=a.<span class="hljs-property">parentNode</span>,c=a.<span class="hljs-property">nextSibling</span>,e=<span class="hljs-number">0</span>;<span class="hljs-keyword">do</span>{<span class="hljs-keyword">if</span>(c&amp;&amp;<span class="hljs-number">8</span>===c.<span class="hljs-property">nodeType</span>){<span class="hljs-keyword">var</span> d=c.<span class="hljs-property">data</span>;<span class="hljs-keyword">if</span>(<span class="hljs-string">"/$"</span>===d)<span class="hljs-keyword">if</span>(<span class="hljs-number">0</span>===e)<span class="hljs-keyword">break</span>;<span class="hljs-keyword">else</span> e--;<span class="hljs-keyword">else</span><span class="hljs-string">"$"</span>!==d&amp;&amp;<span class="hljs-string">"$?"</span>!==d&amp;&amp;<span class="hljs-string">"$!"</span>!==d||e++}d=c.<span class="hljs-property">nextSibling</span>;f.<span class="hljs-title function_">removeChild</span>(c);c=d}<span class="hljs-keyword">while</span>(c);<span class="hljs-keyword">for</span>(;b.<span class="hljs-property">firstChild</span>;)f.<span class="hljs-title function_">insertBefore</span>(b.<span class="hljs-property">firstChild</span>,c);a.<span class="hljs-property">data</span>=<span class="hljs-string">"$"</span>;a.<span class="hljs-property">_reactRetry</span>&amp;&amp;a.<span class="hljs-title function_">_reactRetry</span>()}};$RC(<span class="hljs-string">"B:0"</span>,<span class="hljs-string">"S:0"</span>)
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">replaceSegmentIntoBoundary</span>(<span class="hljs-params">boundaryId, segmentId</span>) {
  <span class="hljs-keyword">const</span> boundaryNode = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(boundaryId);
  <span class="hljs-keyword">const</span> segmentTemplate = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(segmentId);

  <span class="hljs-comment">// ç§»é™¤ &lt;template&gt; åŒ…è£¹</span>
  segmentTemplate.<span class="hljs-property">parentNode</span>.<span class="hljs-title function_">removeChild</span>(segmentTemplate);

  <span class="hljs-keyword">if</span> (boundaryNode) {
    <span class="hljs-keyword">let</span> marker = boundaryNode.<span class="hljs-property">previousSibling</span>; <span class="hljs-comment">// boundary å‰çš„æ³¨é‡ŠèŠ‚ç‚¹</span>
    <span class="hljs-keyword">const</span> parent = marker.<span class="hljs-property">parentNode</span>;
    <span class="hljs-keyword">let</span> current = marker.<span class="hljs-property">nextSibling</span>;
    <span class="hljs-keyword">let</span> depth = <span class="hljs-number">0</span>;

    <span class="hljs-comment">// åˆ é™¤ boundary å ä½å†…å®¹ (ç›´åˆ° "/$" ç»“æŸæ ‡è®°)</span>
    <span class="hljs-keyword">do</span> {
      <span class="hljs-keyword">if</span> (current &amp;&amp; current.<span class="hljs-property">nodeType</span> === <span class="hljs-number">8</span>) { <span class="hljs-comment">// æ³¨é‡ŠèŠ‚ç‚¹</span>
        <span class="hljs-keyword">const</span> comment = current.<span class="hljs-property">data</span>; <span class="hljs-comment">//dataå°±æ˜¯æ³¨é‡ŠèŠ‚ç‚¹çš„å€¼&lt;!-- å€¼ --&gt;</span>
        <span class="hljs-keyword">if</span> (comment === <span class="hljs-string">"/$"</span>) {
          <span class="hljs-keyword">if</span> (depth === <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">else</span> depth--;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (comment === <span class="hljs-string">"$"</span> || comment === <span class="hljs-string">"$?"</span> || comment === <span class="hljs-string">"$!"</span>) {
          depth++;
        }
      }
      <span class="hljs-keyword">const</span> next = current.<span class="hljs-property">nextSibling</span>;
      parent.<span class="hljs-title function_">removeChild</span>(current);
      current = next;
    } <span class="hljs-keyword">while</span> (current);

    <span class="hljs-comment">// æ’å…¥ segment çš„å†…å®¹</span>
    <span class="hljs-keyword">while</span> (segmentTemplate.<span class="hljs-property">firstChild</span>) {
      parent.<span class="hljs-title function_">insertBefore</span>(segmentTemplate.<span class="hljs-property">firstChild</span>, current);
    }

    <span class="hljs-comment">// æ›´æ–° markerï¼Œæ ‡è®°å·²å®Œæˆ</span>
    marker.<span class="hljs-property">data</span> = <span class="hljs-string">"$"</span>;
    <span class="hljs-keyword">if</span> (marker.<span class="hljs-property">_reactRetry</span>) {
      marker.<span class="hljs-title function_">_reactRetry</span>();
    }
  }
}

<span class="hljs-comment">// æ‰§è¡Œï¼šæŠŠ S:0 (segment) æ›¿æ¢è¿› B:0 (boundary)</span>
<span class="hljs-title function_">replaceSegmentIntoBoundary</span>(<span class="hljs-string">"B:0"</span>, <span class="hljs-string">"S:0"</span>);
</code></pre>













<table><thead><tr><th>B:0</th><th>S:0</th></tr></thead><tbody><tr><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9634c7065cec4b1dbf5b0cb086a8b1de~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aqR6Ieq6KGM6L2m55qE56CB5Yac:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763368185&amp;x-signature=BmstxN4kcn%2BM1D1%2B%2BoMry2RVjnM%3D" alt="" loading="lazy"/></td><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1cd8c37107984ced9f59a5715f28759e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aqR6Ieq6KGM6L2m55qE56CB5Yac:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763368185&amp;x-signature=90RR9gwis%2BOTtVqp9Dx4JvppiIw%3D" alt="" loading="lazy"/></td></tr></tbody></table>
<h2 data-id="heading-11">æ€»ç»“</h2>
<p>SSRç”±å››ä¸ªè§’è‰²ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼šæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å…¬å…±çš„æ–‡ä»¶ã€HTTPæœåŠ¡å™¨ã€å®¢æˆ·ç«¯æ–‡ä»¶å’ŒæœåŠ¡ç«¯æ–‡ä»¶ã€‚<br/>
Reactç»„ä»¶åˆ›å»ºäº†ä¸¤éï¼ŒrenderToPipeableStream+å…¬å…±æ–‡ä»¶åˆ›å»ºä¸€éï¼ŒhydrateRoot+å…¬å…±æ–‡ä»¶åˆ›å»ºç¬¬äºŒéï¼ˆå®Œå…¨æ²¡æœ‰ç”¨åˆ°createRootï¼‰ã€‚</p>
<p><strong>æ°´åˆ</strong>ä¸è¿‡æ˜¯æŠŠFiberèŠ‚ç‚¹å…³è”åˆ°DOMï¼Œæ‰€è°“â€œå…³è”â€å°±æ˜¯é€šè¿‡DOMèƒ½æ‰¾åˆ°Fiberã€‚</p>
<p>SSRæŠ€æœ¯çš„å®ç°è®¾è®¡ä¸è¿‡æ˜¯ <strong>HTMLæ–‡ä»¶ + æ’å…¥è„šæœ¬</strong>ã€‚<br/>
ç¬¬ä¸€æ­¥ï¼Œè¿è¡ŒHTTPæœåŠ¡å™¨ï¼Œ<strong>renderToPipeableStream + å…¬å…±æ–‡ä»¶</strong>åˆ›å»ºçº¯HTMLæ–‡ä»¶<br/>
ç¬¬äºŒæ­¥ï¼Œæ’å…¥æ°´åˆè„šæœ¬client.jsï¼ˆå®¢æˆ·ç«¯æ–‡ä»¶ï¼Œé‡Œé¢æ˜¯hydrateRoot()ï¼‰<br/>
ç¬¬ä¸‰æ­¥ï¼Œæ’å…¥æ›¿æ¢è„šæœ¬$RCã€‚
HTTPæœåŠ¡å™¨è¿”å›è¿™ä¸ªHTMLæ–‡ä»¶ï¼Œæµè§ˆå™¨æ˜¾ç¤ºé¡µé¢ï¼Œæ‰§è¡Œè„šæœ¬ã€‚<br/>
å¾€åï¼Œå†è¦å…¶ä»–åŠŸèƒ½ï¼Œä¾‹å¦‚è·¯ç”±çš„ç®¡ç†ã€çŠ¶æ€çš„ç®¡ç†ï¼Œä¸è¿‡ä¹Ÿæ˜¯åœ¨HTMLä¸Šæ’å…¥æ–°çš„è„šæœ¬ï¼ˆä¸æ˜¯å…¨éƒ¨éƒ½è¦æ’å…¥æ–°è„šæœ¬ï¼‰ã€‚<br/>
ä»¥çŠ¶æ€ç®¡ç†ä¸ºä¾‹ï¼Œåœ¨æœåŠ¡ç«¯ï¼Œæ­£å¸¸åˆ›å»ºäº†Storeï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//æœåŠ¡ç«¯</span>
<span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">"./store"</span>;
<span class="hljs-keyword">const</span> preloadedState = store.<span class="hljs-title function_">getState</span>();
</code></pre>
<p>ç»™HTMLæ–‡ä»¶æ’å…¥è„šæœ¬ï¼š</p>
<pre><code class="hljs language-html" lang="html">index.html
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"root"</span>&gt;</span>${content}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"> <span class="hljs-comment">//æ’å…¥</span>
    <span class="hljs-variable language_">window</span>.<span class="hljs-property">__PRELOAD_STATE__</span>=${<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(preloadedState)}<span class="hljs-comment">//è¿™æ ·å°±è¢«æ·»åŠ åˆ°äº†window</span>
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"client.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
</code></pre>
<p>å®¢æˆ·ç«¯å°±èƒ½è·å–çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-js" lang="js">client.<span class="hljs-property">js</span>
<span class="hljs-comment">// åˆ›å»ºstoreæ—¶ï¼Œå¦‚æœæœ‰window?.__PRELOAD_STATE__ï¼Œå°±ä»¥å®ƒä¸ºåˆå§‹stateï¼Œå¦åˆ™ä¸ºç©ºå¯¹è±¡{}</span>
<span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStoreInstance</span>(<span class="hljs-variable language_">window</span>?.<span class="hljs-property">__PRELOAD_STATE__</span>);
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€JavaScriptåŸºç¡€ã€‘Nullç±»å‹è¯¦è§£]]></title>    <link>https://juejin.cn/post/7570598043298267199</link>    <guid>https://juejin.cn/post/7570598043298267199</guid>    <pubDate>2025-11-10T08:29:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570598043298267199" data-draft-id="7570896170920329279" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€JavaScriptåŸºç¡€ã€‘Nullç±»å‹è¯¦è§£"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-11-10T08:29:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çˆ±å­¦ä¹ çš„ç¨‹åºåª›"/> <meta itemprop="url" content="https://juejin.cn/user/2999123453938925"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€JavaScriptåŸºç¡€ã€‘Nullç±»å‹è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2999123453938925/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çˆ±å­¦ä¹ çš„ç¨‹åºåª›
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T08:29:23.000Z" title="Mon Nov 10 2025 08:29:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe59468598cd49f892c53e5360af014e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54ix5a2m5Lmg55qE56iL5bqP5aqb:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763368163&amp;x-signature=Byq1ZO6ZJgHPaCRXVcHnmhP9c0U%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨JavaScriptä¸­ï¼ŒNullæ˜¯ä¸€ä¸ªåŸå§‹æ•°æ®ç±»å‹ï¼Œè¡¨ç¤ºå˜é‡è¢«æ˜ç¡®èµ‹å€¼ä¸ºç©ºå€¼æˆ–"æ— å€¼"çŠ¶æ€ã€‚</p>
<h2 data-id="heading-0">1.Â Nullç±»å‹ä¸»è¦åœºæ™¯</h2>
<h3 data-id="heading-1">1ï¼‰å˜é‡åˆå§‹åŒ–</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span>Â user =Â <span class="hljs-literal">null</span>;
user = {Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'cxh'</span>,Â <span class="hljs-attr">age</span>:Â <span class="hljs-number">18</span>Â };
</code></pre>
<h3 data-id="heading-2">2ï¼‰å‡½æ•°è¿”å›å€¼</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å‡½æ•°æ‰¾ä¸åˆ°ç»“æœæ—¶è¿”å› null</span>
<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">findUser</span>(<span class="hljs-params">id</span>) {
Â  Â Â <span class="hljs-keyword">const</span>Â users = [
Â  Â  Â  Â  {Â <span class="hljs-attr">id</span>:Â <span class="hljs-number">1</span>,Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'cxh001'</span>Â },
Â  Â  Â  Â  {Â <span class="hljs-attr">id</span>:Â <span class="hljs-number">2</span>,Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'cxh002'</span>Â }
Â  Â  ];
Â  Â Â <span class="hljs-keyword">return</span>Â users.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">user</span>Â =&gt;</span>Â user.<span class="hljs-property">id</span>Â === id) ||Â <span class="hljs-literal">null</span>;
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">findUser</span>(<span class="hljs-number">3</span>));Â <span class="hljs-comment">// null</span>

<span class="hljs-comment">// æ“ä½œå¤±è´¥æ—¶è¿”å› null</span>
<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">parseJSON</span>(<span class="hljs-params">str</span>) {
Â  Â Â <span class="hljs-keyword">try</span>Â {
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(str);
Â  Â  }Â <span class="hljs-keyword">catch</span>Â (error) {
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">null</span>;
Â  Â  }
}
</code></pre>
<h3 data-id="heading-3">3ï¼‰DOMæ“ä½œ</h3>
<pre><code class="hljs language-js" lang="js">    <span class="hljs-comment">// è·å–ä¸å­˜åœ¨çš„å…ƒç´ è¿”å› null</span>
    <span class="hljs-keyword">const</span>Â nonExistentElement =Â <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'non-existent'</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(nonExistentElement);Â <span class="hljs-comment">// null</span>

    <span class="hljs-comment">// ç§»é™¤å…ƒç´ åè®¾ç½®ä¸º null</span>
    <span class="hljs-keyword">let</span>Â element =Â <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'myElement'</span>);
    element?.<span class="hljs-property">parentNode</span>?.<span class="hljs-title function_">removeChild</span>(element);
    element =Â <span class="hljs-literal">null</span>;Â <span class="hljs-comment">// å¸®åŠ©åƒåœ¾å›æ”¶</span>
</code></pre>
<h3 data-id="heading-4">4ï¼‰å¯¹è±¡å±æ€§çš„æ¸…ç†</h3>
<pre><code class="hljs language-js" lang="js">    <span class="hljs-keyword">const</span>Â app = {
    Â  Â Â <span class="hljs-attr">cache</span>: {},
    Â  Â Â <span class="hljs-attr">config</span>:Â <span class="hljs-literal">null</span>
    };
    <span class="hljs-comment">// ä½¿ç”¨ç¼“å­˜åæ¸…ç†</span>
    app.<span class="hljs-property">cache</span>.<span class="hljs-property">userData</span>Â = {Â <span class="hljs-comment">/* å¤§é‡æ•°æ® */</span>Â };
    <span class="hljs-comment">// é‡Šæ”¾å†…å­˜</span>
    app.<span class="hljs-property">cache</span>.<span class="hljs-property">userData</span>Â =Â <span class="hljs-literal">null</span>;
</code></pre>
<h3 data-id="heading-5">5ï¼‰å‡½æ•°çš„å¯é€‰å‚æ•°</h3>
<pre><code class="hljs language-js" lang="js">    <span class="hljs-keyword">function</span>Â <span class="hljs-title function_">createUser</span>(<span class="hljs-params">name, details =Â <span class="hljs-literal">null</span></span>) {
    Â  Â Â <span class="hljs-keyword">return</span>Â {
    Â  Â  Â  Â  name,
    Â  Â  Â  Â  details
    Â  Â  };
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">createUser</span>(<span class="hljs-string">'cxh'</span>));Â <span class="hljs-comment">// {name: 'cxh', details: null}</span>
</code></pre>
<h3 data-id="heading-6">6ï¼‰API å“åº”å¤„ç†</h3>
<pre><code class="hljs language-js" lang="js">    <span class="hljs-comment">// å¸¸è§äºæ•°æ®åº“æŸ¥è¯¢ç»“æœ</span>
    <span class="hljs-keyword">const</span>Â apiResponse = {
    Â  Â Â <span class="hljs-attr">success</span>:Â <span class="hljs-literal">true</span>,
    Â  Â Â <span class="hljs-attr">data</span>:Â <span class="hljs-literal">null</span>,Â <span class="hljs-comment">// æ²¡æœ‰æ‰¾åˆ°æ•°æ®</span>
    Â  Â Â <span class="hljs-attr">message</span>:Â <span class="hljs-string">'User not found'</span>
    };
    <span class="hljs-comment">// æˆ–è€…</span>
    <span class="hljs-keyword">async</span>Â <span class="hljs-keyword">function</span>Â <span class="hljs-title function_">getUserProfile</span>(<span class="hljs-params">userId</span>) {
    Â  Â Â <span class="hljs-keyword">const</span>Â response =Â <span class="hljs-keyword">await</span>Â <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/users/<span class="hljs-subst">${userId}</span>`</span>);
    Â  Â Â <span class="hljs-keyword">const</span>Â result =Â <span class="hljs-keyword">await</span>Â response?.<span class="hljs-title function_">json</span>();
    Â  Â Â <span class="hljs-keyword">return</span>Â result?.<span class="hljs-property">data</span>Â ||Â <span class="hljs-literal">null</span>;Â <span class="hljs-comment">// æœ‰æ•°æ®è¿”å›æ•°æ®ï¼Œæ²¡æœ‰è¿”å› null</span>
    }
</code></pre>
<h3 data-id="heading-7">7ï¼‰çŠ¶æ€ç®¡ç†</h3>
<pre><code class="hljs language-js" lang="js">    <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">AuthService</span>Â {
    Â  Â  currentUser =Â <span class="hljs-literal">null</span>;
    Â  Â  token =Â <span class="hljs-literal">null</span>;

    Â  Â Â <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {}

    Â  Â Â <span class="hljs-title function_">login</span>(<span class="hljs-params">userData, authToken</span>) {
    Â  Â  Â  Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentUser</span>Â = userData;
    Â  Â  Â  Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">token</span>Â = authToken;
    Â  Â  }

    Â  Â Â <span class="hljs-title function_">logout</span>(<span class="hljs-params"/>) {
    Â  Â  Â  Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentUser</span>Â =Â <span class="hljs-literal">null</span>;
    Â  Â  Â  Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">token</span>Â =Â <span class="hljs-literal">null</span>;
    Â  Â  }
    }
</code></pre>
<h3 data-id="heading-8">8ï¼‰é…ç½®å’Œé€‰é¡¹</h3>
<pre><code class="hljs language-js" lang="js">    <span class="hljs-keyword">function</span>Â <span class="hljs-title function_">initializeApp</span>(<span class="hljs-params">config = {}</span>) {
    Â  Â Â <span class="hljs-keyword">const</span>Â defaults = {
    Â  Â  Â  Â Â <span class="hljs-attr">apiUrl</span>:Â <span class="hljs-string">'https://api.example.com'</span>,
    Â  Â  Â  Â Â <span class="hljs-attr">timeout</span>:Â <span class="hljs-number">5000</span>,
    Â  Â  Â  Â Â <span class="hljs-attr">retryCount</span>:Â <span class="hljs-literal">null</span>,Â <span class="hljs-comment">// ä¸é‡è¯•</span>
    Â  Â  Â  Â Â <span class="hljs-attr">logger</span>:Â <span class="hljs-literal">null</span>Â <span class="hljs-comment">// ä¸è®°å½•æ—¥å¿—</span>
    Â  Â  };
    Â  Â Â <span class="hljs-keyword">return</span>Â { ...defaults, ...config };
    }
</code></pre>
<h3 data-id="heading-9">9ï¼‰æœªåŒ¹é…åˆ°æ­£åˆ™</h3>
<pre><code class="hljs language-js" lang="js">    <span class="hljs-comment">// RegExp.exec() æ–¹æ³•æ²¡æœ‰åŒ¹é…</span>
    <span class="hljs-keyword">const</span>Â regex1 =Â <span class="hljs-regexp">/hello (\w+)/</span>;
    <span class="hljs-keyword">const</span>Â str =Â <span class="hljs-string">'goodbye world'</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(regex1.<span class="hljs-title function_">exec</span>(str));Â <span class="hljs-comment">// null</span>

    <span class="hljs-comment">// String.match() æ²¡æœ‰åŒ¹é…ç»“æœ</span>
    <span class="hljs-keyword">const</span>Â regex2 =Â <span class="hljs-regexp">/(\d{3})-(\d{3})-(\d{4})/</span>;
    <span class="hljs-keyword">const</span>Â phone =Â <span class="hljs-string">'æ²¡æœ‰ç”µè¯å·ç '</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(phone.<span class="hljs-title function_">match</span>(regex2));Â <span class="hljs-comment">// null</span>
</code></pre>
<h2 data-id="heading-10">2. æ£€æµ‹Nullçš„æ–¹æ³•</h2>
<h3 data-id="heading-11">1ï¼‰ä¸¥æ ¼ç›¸ç­‰</h3>
<pre><code class="hljs language-js" lang="js">    <span class="hljs-keyword">let</span>Â value =Â <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span>Â (value ===Â <span class="hljs-literal">null</span>) {
    Â  Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Value is null'</span>);Â <span class="hljs-comment">// Value is null</span>
    }
</code></pre>
<h3 data-id="heading-12">2ï¼‰è”åˆæ£€æŸ¥Nullå’ŒUndefined</h3>
<pre><code class="hljs language-js" lang="js">    <span class="hljs-keyword">let</span>Â value;
    <span class="hljs-keyword">if</span>Â (value ==Â <span class="hljs-literal">null</span>) {
    Â  Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Value is null or undefined'</span>);Â <span class="hljs-comment">// Value is null or undefined</span>
    }
</code></pre>
<h3 data-id="heading-13">3ï¼‰ä½¿ç”¨å¯é€‰é“¾æ“ä½œç¬¦å®‰å…¨è®¿é—®</h3>
<pre><code class="hljs language-js" lang="js">    <span class="hljs-keyword">const</span>Â userName = user?.<span class="hljs-property">profile</span>?.<span class="hljs-property">name</span>Â ??Â <span class="hljs-string">'default'</span>;
</code></pre>
<h2 data-id="heading-14">3.Â Undefinedå’ŒNullçš„å¼‚åŒ</h2>













































<table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>Undefined</strong></th><th><strong>Null</strong></th></tr></thead><tbody><tr><td>ç±»å‹</td><td>ç‹¬ç«‹ç±»å‹(Undefined)</td><td>ç‹¬ç«‹ç±»å‹(Null)</td></tr><tr><td>å«ä¹‰</td><td>å˜é‡å£°æ˜ä½†æœªèµ‹å€¼</td><td>è¡¨ç¤ºä¸€ä¸ªç©ºå¯¹è±¡æŒ‡é’ˆ</td></tr><tr><td>é»˜è®¤å€¼</td><td>å‡½æ•°æ— è¿”å›å€¼æ—¶çš„é»˜è®¤è¿”å›</td><td>éœ€æ˜¾å¼èµ‹å€¼</td></tr><tr><td>ç›¸ç­‰æ€§</td><td>undefined == nullÂ â†’ true</td><td>undefined === nullÂ â†’ false</td></tr><tr><td>ç±»å‹æ£€æµ‹</td><td>typeof undefinedâ†’ 'undefined'</td><td>typeof nullÂ â†’ 'object'</td></tr><tr><td>è½¬æ¢ä¸ºæ•°å­—</td><td>Number(undefined)Â â†’ NaN</td><td>Number(null)Â â†’ 0</td></tr><tr><td>è½¬æ¢ä¸ºå¸ƒå°”å€¼</td><td>Boolean(undefined)â†’ false</td><td>Boolean(null)Â â†’ false</td></tr></tbody></table>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ–‡è®²æ¸…é¸¿è’™ç½‘ç»œå¼€å‘]]></title>    <link>https://juejin.cn/post/7570904968677687323</link>    <guid>https://juejin.cn/post/7570904968677687323</guid>    <pubDate>2025-11-10T08:38:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570904968677687323" data-draft-id="7570902804450361354" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ–‡è®²æ¸…é¸¿è’™ç½‘ç»œå¼€å‘"/> <meta itemprop="keywords" content="å‰ç«¯,HarmonyOS,JavaScript"/> <meta itemprop="datePublished" content="2025-11-10T08:38:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Androidç–‘éš¾æ‚ç—‡"/> <meta itemprop="url" content="https://juejin.cn/user/1820446983462136"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ–‡è®²æ¸…é¸¿è’™ç½‘ç»œå¼€å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1820446983462136/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Androidç–‘éš¾æ‚ç—‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T08:38:19.000Z" title="Mon Nov 10 2025 08:38:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€æ¦‚è¿°</h2>
<p>é€šè¿‡æœ¬æŒ‡å—,æ‚¨å¯ä»¥æŒæ¡HarmonyOS Network Kitçš„æ ¸å¿ƒåŠŸèƒ½å’Œæœ€ä½³å®è·µã€‚Network Kitæä¾›äº†å®Œæ•´çš„ç½‘ç»œé€šä¿¡è§£å†³æ–¹æ¡ˆ,æ”¯æŒHTTPã€WebSocketã€Socketç­‰å¤šç§åè®®,æ»¡è¶³å„ç±»åº”ç”¨çš„ç½‘ç»œéœ€æ±‚ã€‚åˆç†ä½¿ç”¨è¿™äº›èƒ½åŠ›,å¯ä»¥æ„å»ºé«˜æ€§èƒ½ã€å®‰å…¨å¯é çš„ç½‘ç»œåº”ç”¨ã€‚</p>
<h3 data-id="heading-1">æ ¸å¿ƒèƒ½åŠ›</h3>








































<table><thead><tr><th>åŠŸèƒ½æ¨¡å—</th><th>ä¸»è¦èƒ½åŠ›</th><th>åº”ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>HTTPè¯·æ±‚</td><td>GET/POST/PUT/DELETEç­‰æ–¹æ³•ã€æµå¼ä¼ è¾“ã€è¯ä¹¦é…ç½®</td><td>RESTful APIè°ƒç”¨ã€æ–‡ä»¶ä¸Šä¼ ä¸‹è½½</td></tr><tr><td>WebSocket</td><td>å…¨åŒå·¥é€šä¿¡ã€å¿ƒè·³æ£€æµ‹ã€å®¢æˆ·ç«¯/æœåŠ¡ç«¯</td><td>å®æ—¶èŠå¤©ã€æ¸¸æˆå¯¹æˆ˜ã€å®æ—¶æ•°æ®æ¨é€</td></tr><tr><td>TCP Socket</td><td>é¢å‘è¿æ¥çš„å¯é ä¼ è¾“ã€æœåŠ¡ç«¯ç›‘å¬</td><td>é•¿è¿æ¥é€šä¿¡ã€è‡ªå®šä¹‰åè®®</td></tr><tr><td>UDP Socket</td><td>æ— è¿æ¥çš„å¿«é€Ÿä¼ è¾“ã€ç»„æ’­æ”¯æŒ</td><td>è§†é¢‘ç›´æ’­ã€å®æ—¶è¯­éŸ³ã€å±€åŸŸç½‘å‘ç°</td></tr><tr><td>TLS Socket</td><td>åŠ å¯†ä¼ è¾“ã€åŒå‘è®¤è¯ã€è¯ä¹¦é”å®š</td><td>å®‰å…¨é€šä¿¡ã€é‡‘èæ”¯ä»˜</td></tr><tr><td>LocalSocket</td><td>è¿›ç¨‹é—´é€šä¿¡ã€æ— éœ€ç½‘ç»œ</td><td>åŒè®¾å¤‡è¿›ç¨‹é€šä¿¡ã€æ€§èƒ½ä¼˜åŒ–</td></tr></tbody></table>
<h2 data-id="heading-2">äºŒã€HTTPç½‘ç»œè¯·æ±‚</h2>
<h3 data-id="heading-3">2.1 è¯·æ±‚æµç¨‹</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant App as åº”ç”¨
    participant HTTP as HttpRequest
    participant Server as æœåŠ¡å™¨

    App-&gt;&gt;HTTP: createHttp()
    App-&gt;&gt;HTTP: on('headersReceive')
    App-&gt;&gt;HTTP: request(url, options)
    HTTP-&gt;&gt;Server: å‘é€HTTPè¯·æ±‚
    Server--&gt;&gt;HTTP: è¿”å›å“åº”å¤´
    HTTP--&gt;&gt;App: headersReceiveå›è°ƒ
    Server--&gt;&gt;HTTP: è¿”å›å®Œæ•´å“åº”
    HTTP--&gt;&gt;App: å“åº”æ•°æ®
    App-&gt;&gt;HTTP: destroy()
</code></pre>
<h3 data-id="heading-4">2.2 åŸºç¡€HTTPè¯·æ±‚</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { http } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">HttpManager</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">instance</span>: <span class="hljs-title class_">HttpManager</span>;

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {}

  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title function_">getInstance</span>(): <span class="hljs-title class_">HttpManager</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">HttpManager</span>.<span class="hljs-property">instance</span>) {
      <span class="hljs-title class_">HttpManager</span>.<span class="hljs-property">instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpManager</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">HttpManager</span>.<span class="hljs-property">instance</span>;
  }

  <span class="hljs-comment">/**
   * å‘é€HTTP GETè¯·æ±‚
   */</span>
  <span class="hljs-keyword">async</span> get&lt;T&gt;(<span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>, headers?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;T&gt; {
    <span class="hljs-keyword">const</span> httpRequest = http.<span class="hljs-title function_">createHttp</span>();

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> httpRequest.<span class="hljs-title function_">request</span>(url, {
        <span class="hljs-attr">method</span>: http.<span class="hljs-property">RequestMethod</span>.<span class="hljs-property">GET</span>,
        <span class="hljs-attr">header</span>: headers || { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> },
        <span class="hljs-attr">expectDataType</span>: http.<span class="hljs-property">HttpDataType</span>.<span class="hljs-property">STRING</span>,
        <span class="hljs-attr">connectTimeout</span>: <span class="hljs-number">60000</span>,
        <span class="hljs-attr">readTimeout</span>: <span class="hljs-number">60000</span>
      });

      <span class="hljs-keyword">if</span> (response.<span class="hljs-property">responseCode</span> === <span class="hljs-number">200</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(response.<span class="hljs-property">result</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTP Error: <span class="hljs-subst">${response.responseCode}</span>`</span>);
      }
    } <span class="hljs-keyword">finally</span> {
      httpRequest.<span class="hljs-title function_">destroy</span>();
    }
  }

  <span class="hljs-comment">/**
   * å‘é€HTTP POSTè¯·æ±‚
   */</span>
  <span class="hljs-keyword">async</span> post&lt;T&gt;(<span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">data</span>: <span class="hljs-title class_">Object</span>, headers?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;T&gt; {
    <span class="hljs-keyword">const</span> httpRequest = http.<span class="hljs-title function_">createHttp</span>();

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> httpRequest.<span class="hljs-title function_">request</span>(url, {
        <span class="hljs-attr">method</span>: http.<span class="hljs-property">RequestMethod</span>.<span class="hljs-property">POST</span>,
        <span class="hljs-attr">header</span>: headers || { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> },
        <span class="hljs-attr">extraData</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data),
        <span class="hljs-attr">expectDataType</span>: http.<span class="hljs-property">HttpDataType</span>.<span class="hljs-property">STRING</span>,
        <span class="hljs-attr">connectTimeout</span>: <span class="hljs-number">60000</span>,
        <span class="hljs-attr">readTimeout</span>: <span class="hljs-number">60000</span>
      });

      <span class="hljs-keyword">if</span> (response.<span class="hljs-property">responseCode</span> === <span class="hljs-number">200</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(response.<span class="hljs-property">result</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTP Error: <span class="hljs-subst">${response.responseCode}</span>`</span>);
      }
    } <span class="hljs-keyword">finally</span> {
      httpRequest.<span class="hljs-title function_">destroy</span>();
    }
  }

  <span class="hljs-comment">/**
   * ä¸Šä¼ æ–‡ä»¶(multipart/form-data)
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">uploadFile</span>(<span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">filePath</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">fileName</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt; {
    <span class="hljs-keyword">const</span> httpRequest = http.<span class="hljs-title function_">createHttp</span>();

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> httpRequest.<span class="hljs-title function_">request</span>(url, {
        <span class="hljs-attr">method</span>: http.<span class="hljs-property">RequestMethod</span>.<span class="hljs-property">POST</span>,
        <span class="hljs-attr">header</span>: { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'multipart/form-data'</span> },
        <span class="hljs-attr">multiFormDataList</span>: [
          {
            <span class="hljs-attr">name</span>: <span class="hljs-string">'file'</span>,
            <span class="hljs-attr">contentType</span>: <span class="hljs-string">'application/octet-stream'</span>,
            <span class="hljs-attr">filePath</span>: filePath,
            <span class="hljs-attr">remoteFileName</span>: fileName
          }
        ],
        <span class="hljs-attr">connectTimeout</span>: <span class="hljs-number">60000</span>,
        <span class="hljs-attr">readTimeout</span>: <span class="hljs-number">300000</span> <span class="hljs-comment">// ä¸Šä¼ å¤§æ–‡ä»¶éœ€è¦æ›´é•¿è¶…æ—¶æ—¶é—´</span>
      });

      <span class="hljs-keyword">return</span> response.<span class="hljs-property">result</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>;
    } <span class="hljs-keyword">finally</span> {
      httpRequest.<span class="hljs-title function_">destroy</span>();
    }
  }
}
</code></pre>
<h3 data-id="heading-5">2.3 HTTPæµå¼ä¼ è¾“</h3>
<p>é€‚ç”¨äºå¤§æ–‡ä»¶ä¸‹è½½åœºæ™¯,æ”¯æŒè¿›åº¦ç›‘å¬:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">HttpStreamDownloader</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">httpRequest</span>: http.<span class="hljs-property">HttpRequest</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">receivedData</span>: <span class="hljs-title class_">ArrayBuffer</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">0</span>);

  <span class="hljs-comment">/**
   * ä¸‹è½½æ–‡ä»¶å¹¶ç›‘å¬è¿›åº¦
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">downloadFile</span>(
    <span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>,
    <span class="hljs-attr">onProgress</span>: <span class="hljs-function">(<span class="hljs-params">received: <span class="hljs-built_in">number</span>, total: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>
  ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ArrayBuffer</span>&gt; {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpRequest</span> = http.<span class="hljs-title function_">createHttp</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">receivedData</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">0</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-comment">// è®¢é˜…æ•°æ®æ¥æ”¶äº‹ä»¶</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpRequest</span>!.<span class="hljs-title function_">on</span>(<span class="hljs-string">'dataReceive'</span>, <span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">ArrayBuffer</span></span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> newBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">receivedData</span>.<span class="hljs-property">byteLength</span> + data.<span class="hljs-property">byteLength</span>);
        <span class="hljs-keyword">const</span> newView = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(newBuffer);
        newView.<span class="hljs-title function_">set</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">receivedData</span>));
        newView.<span class="hljs-title function_">set</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(data), <span class="hljs-variable language_">this</span>.<span class="hljs-property">receivedData</span>.<span class="hljs-property">byteLength</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">receivedData</span> = newBuffer;
      });

      <span class="hljs-comment">// è®¢é˜…ä¸‹è½½è¿›åº¦äº‹ä»¶</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpRequest</span>!.<span class="hljs-title function_">on</span>(<span class="hljs-string">'dataReceiveProgress'</span>, <span class="hljs-function">(<span class="hljs-params">progress: http.DataReceiveProgressInfo</span>) =&gt;</span> {
        <span class="hljs-title function_">onProgress</span>(progress.<span class="hljs-property">receiveSize</span>, progress.<span class="hljs-property">totalSize</span>);
      });

      <span class="hljs-comment">// è®¢é˜…æ•°æ®æ¥æ”¶å®Œæˆäº‹ä»¶</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpRequest</span>!.<span class="hljs-title function_">on</span>(<span class="hljs-string">'dataEnd'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">resolve</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">receivedData</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cleanup</span>();
      });

      <span class="hljs-comment">// å‘èµ·æµå¼è¯·æ±‚</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpRequest</span>!.<span class="hljs-title function_">requestInStream</span>(url, {
        <span class="hljs-attr">method</span>: http.<span class="hljs-property">RequestMethod</span>.<span class="hljs-property">GET</span>,
        <span class="hljs-attr">readTimeout</span>: <span class="hljs-number">600000</span> <span class="hljs-comment">// å¤§æ–‡ä»¶éœ€è¦æ›´é•¿è¶…æ—¶</span>
      }).<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {
        <span class="hljs-title function_">reject</span>(err);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cleanup</span>();
      });
    });
  }

  <span class="hljs-comment">/**
   * å–æ¶ˆä¸‹è½½
   */</span>
  <span class="hljs-title function_">cancel</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cleanup</span>();
  }

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">cleanup</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">httpRequest</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpRequest</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'dataReceive'</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpRequest</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'dataReceiveProgress'</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpRequest</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'dataEnd'</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpRequest</span>.<span class="hljs-title function_">destroy</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpRequest</span> = <span class="hljs-literal">null</span>;
    }
  }
}
</code></pre>
<h2 data-id="heading-6">ä¸‰ã€WebSocketé€šä¿¡</h2>
<h3 data-id="heading-7">3.1 WebSocketæ¶æ„</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[åº”ç”¨å±‚] --&gt; B[WebSocketå®¢æˆ·ç«¯]
    A --&gt; C[WebSocketæœåŠ¡ç«¯-ä»…æ™ºæ…§å±]
    B --&gt; D[createWebSocket]
    B --&gt; E[connectå»ºç«‹è¿æ¥]
    B --&gt; F[sendå‘é€æ¶ˆæ¯]
    B --&gt; G[closeå…³é—­è¿æ¥]
    C --&gt; H[createWebSocketServer]
    C --&gt; I[startå¯åŠ¨æœåŠ¡]
    C --&gt; J[ç›‘å¬å®¢æˆ·ç«¯è¿æ¥]
    C --&gt; K[stopåœæ­¢æœåŠ¡]
</code></pre>
<h3 data-id="heading-8">3.2 WebSocketå®¢æˆ·ç«¯</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketClient</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">ws</span>: webSocket.<span class="hljs-property">WebSocket</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">reconnectTimer</span>: <span class="hljs-built_in">number</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> reconnectAttempts = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">private</span> maxReconnectAttempts = <span class="hljs-number">5</span>;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> url: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ws</span> = webSocket.<span class="hljs-title function_">createWebSocket</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupEventHandlers</span>();
  }

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">setupEventHandlers</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// è¿æ¥æ‰“å¼€äº‹ä»¶</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ws</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'open'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, value: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (err) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'WebSocketè¿æ¥å¤±è´¥:'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));
        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'WebSocketè¿æ¥æˆåŠŸ'</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectAttempts</span> = <span class="hljs-number">0</span>;
    });

    <span class="hljs-comment">// æ¥æ”¶æ¶ˆæ¯äº‹ä»¶</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ws</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, value: <span class="hljs-built_in">string</span> | <span class="hljs-built_in">ArrayBuffer</span></span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (err) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ¥æ”¶æ¶ˆæ¯å¤±è´¥:'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));
        <span class="hljs-keyword">return</span>;
      }

      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'string'</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'æ”¶åˆ°æ–‡æœ¬æ¶ˆæ¯:'</span>, value);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleMessage</span>(value);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'æ”¶åˆ°äºŒè¿›åˆ¶æ¶ˆæ¯'</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleBinaryMessage</span>(value);
      }
    });

    <span class="hljs-comment">// è¿æ¥å…³é—­äº‹ä»¶</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ws</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, value: webSocket.CloseResult</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`WebSocketå…³é—­ code=<span class="hljs-subst">${value.code}</span> reason=<span class="hljs-subst">${value.reason}</span>`</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attemptReconnect</span>();
    });

    <span class="hljs-comment">// é”™è¯¯äº‹ä»¶</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ws</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'WebSocketé”™è¯¯:'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));
    });
  }

  <span class="hljs-comment">/**
   * è¿æ¥åˆ°WebSocketæœåŠ¡å™¨
   */</span>
  <span class="hljs-title function_">connect</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">ws</span>.<span class="hljs-title function_">connect</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">url</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, value: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (err) {
          <span class="hljs-title function_">reject</span>(err);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-title function_">resolve</span>();
        }
      });
    });
  }

  <span class="hljs-comment">/**
   * å‘é€æ–‡æœ¬æ¶ˆæ¯
   */</span>
  <span class="hljs-title function_">sendText</span>(<span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">ws</span>.<span class="hljs-title function_">send</span>(message, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, value: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (err) {
          <span class="hljs-title function_">reject</span>(err);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-title function_">resolve</span>();
        }
      });
    });
  }

  <span class="hljs-comment">/**
   * å‘é€äºŒè¿›åˆ¶æ¶ˆæ¯
   */</span>
  <span class="hljs-title function_">sendBinary</span>(<span class="hljs-attr">data</span>: <span class="hljs-title class_">ArrayBuffer</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">ws</span>.<span class="hljs-title function_">send</span>(data, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, value: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (err) {
          <span class="hljs-title function_">reject</span>(err);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-title function_">resolve</span>();
        }
      });
    });
  }

  <span class="hljs-comment">/**
   * å…³é—­è¿æ¥
   */</span>
  <span class="hljs-title function_">close</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectTimer</span> !== <span class="hljs-literal">null</span>) {
      <span class="hljs-built_in">clearTimeout</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectTimer</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectTimer</span> = <span class="hljs-literal">null</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">ws</span>.<span class="hljs-title function_">close</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, value: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (err) {
          <span class="hljs-title function_">reject</span>(err);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-title function_">resolve</span>();
        }
      });
    });
  }

  <span class="hljs-comment">/**
   * è‡ªåŠ¨é‡è¿
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">attemptReconnect</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectAttempts</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxReconnectAttempts</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è¾¾åˆ°æœ€å¤§é‡è¿æ¬¡æ•°,åœæ­¢é‡è¿'</span>);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">const</span> delay = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-number">1000</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectAttempts</span>), <span class="hljs-number">30000</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectAttempts</span>++;

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`<span class="hljs-subst">${delay}</span>msåå°è¯•ç¬¬<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.reconnectAttempts}</span>æ¬¡é‡è¿`</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectTimer</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">connect</span>().<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'é‡è¿å¤±è´¥:'</span>, err);
      });
    }, delay);
  }

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">handleMessage</span>(<span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘å¤„ç†</span>
  }

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">handleBinaryMessage</span>(<span class="hljs-attr">data</span>: <span class="hljs-title class_">ArrayBuffer</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// äºŒè¿›åˆ¶æ•°æ®å¤„ç†</span>
  }
}
</code></pre>
<h2 data-id="heading-9">å››ã€Socketé€šä¿¡</h2>
<h3 data-id="heading-10">4.1 TCP Socketå®¢æˆ·ç«¯</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">TCPSocketClient</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span>;
  <span class="hljs-keyword">private</span> connected = <span class="hljs-literal">false</span>;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcp</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupEventHandlers</span>();
  }

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">setupEventHandlers</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// è¿æ¥å»ºç«‹äº‹ä»¶</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcp</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'TCPè¿æ¥å·²å»ºç«‹'</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">connected</span> = <span class="hljs-literal">true</span>;
    });

    <span class="hljs-comment">// æ¥æ”¶æ¶ˆæ¯äº‹ä»¶</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcp</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">value: socket.SocketMessageInfo</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> buffer = value.<span class="hljs-property">message</span>;
      <span class="hljs-keyword">const</span> dataView = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataView</span>(buffer);
      <span class="hljs-keyword">let</span> str = <span class="hljs-string">''</span>;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; dataView.<span class="hljs-property">byteLength</span>; i++) {
        str += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(dataView.<span class="hljs-title function_">getUint8</span>(i));
      }
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'æ”¶åˆ°æ¶ˆæ¯:'</span>, str);
    });

    <span class="hljs-comment">// è¿æ¥å…³é—­äº‹ä»¶</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcp</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'TCPè¿æ¥å·²å…³é—­'</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">connected</span> = <span class="hljs-literal">false</span>;
    });
  }

  <span class="hljs-comment">/**
   * è¿æ¥åˆ°æœåŠ¡å™¨
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">connect</span>(<span class="hljs-attr">host</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">port</span>: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-comment">// ç»‘å®šæœ¬åœ°åœ°å€(å¯é€‰,ç«¯å£ç”±ç³»ç»Ÿåˆ†é…)</span>
    <span class="hljs-keyword">const</span> <span class="hljs-attr">localAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {
      <span class="hljs-attr">address</span>: <span class="hljs-string">'0.0.0.0'</span>,
      <span class="hljs-attr">port</span>: <span class="hljs-number">0</span>
    };

    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcp</span>.<span class="hljs-title function_">bind</span>(localAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (err) {
          <span class="hljs-title function_">reject</span>(err);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-title function_">resolve</span>();
        }
      });
    });

    <span class="hljs-comment">// è¿æ¥åˆ°æœåŠ¡å™¨</span>
    <span class="hljs-keyword">const</span> <span class="hljs-attr">remoteAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {
      <span class="hljs-attr">address</span>: host,
      <span class="hljs-attr">port</span>: port
    };

    <span class="hljs-keyword">const</span> <span class="hljs-attr">connectOptions</span>: socket.<span class="hljs-property">TCPConnectOptions</span> = {
      <span class="hljs-attr">address</span>: remoteAddr,
      <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span>
    };

    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcp</span>.<span class="hljs-title function_">connect</span>(connectOptions);
  }

  <span class="hljs-comment">/**
   * å‘é€æ•°æ®
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">send</span>(<span class="hljs-attr">data</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">connected</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'TCPæœªè¿æ¥'</span>);
    }

    <span class="hljs-keyword">const</span> <span class="hljs-attr">sendOptions</span>: socket.<span class="hljs-property">TCPSendOptions</span> = {
      <span class="hljs-attr">data</span>: data
    };

    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcp</span>.<span class="hljs-title function_">send</span>(sendOptions);
  }

  <span class="hljs-comment">/**
   * å…³é—­è¿æ¥
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">close</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcp</span>.<span class="hljs-title function_">close</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcp</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'message'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcp</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connect'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcp</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'close'</span>);
  }
}
</code></pre>
<h3 data-id="heading-11">4.2 TCP SocketæœåŠ¡ç«¯</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TCPSocketServer</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">TCPSocketServer</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">clients</span>: socket.<span class="hljs-property">TCPSocketConnection</span>[] = [];

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">server</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupEventHandlers</span>();
  }

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">setupEventHandlers</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// å®¢æˆ·ç«¯è¿æ¥äº‹ä»¶</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">server</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TCPSocketConnection</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'æ–°å®¢æˆ·ç«¯è¿æ¥'</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">clients</span>.<span class="hljs-title function_">push</span>(client);

      <span class="hljs-comment">// ç›‘å¬å®¢æˆ·ç«¯æ¶ˆæ¯</span>
      client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">value: socket.SocketMessageInfo</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> buffer = value.<span class="hljs-property">message</span>;
        <span class="hljs-keyword">const</span> dataView = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataView</span>(buffer);
        <span class="hljs-keyword">let</span> message = <span class="hljs-string">''</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; dataView.<span class="hljs-property">byteLength</span>; i++) {
          message += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(dataView.<span class="hljs-title function_">getUint8</span>(i));
        }
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'æ”¶åˆ°å®¢æˆ·ç«¯æ¶ˆæ¯:'</span>, message);

        <span class="hljs-comment">// å¹¿æ’­ç»™æ‰€æœ‰å®¢æˆ·ç«¯</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">broadcast</span>(message, client);
      });

      <span class="hljs-comment">// å®¢æˆ·ç«¯å…³é—­äº‹ä»¶</span>
      client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-keyword">const</span> index = <span class="hljs-variable language_">this</span>.<span class="hljs-property">clients</span>.<span class="hljs-title function_">indexOf</span>(client);
        <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">clients</span>.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
        }
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'å®¢æˆ·ç«¯æ–­å¼€,å½“å‰è¿æ¥æ•°:'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">clients</span>.<span class="hljs-property">length</span>);
      });
    });
  }

  <span class="hljs-comment">/**
   * å¯åŠ¨æœåŠ¡å™¨
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">listen</span>(<span class="hljs-attr">port</span>: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">address</span>: socket.<span class="hljs-property">NetAddress</span> = {
      <span class="hljs-attr">address</span>: <span class="hljs-string">'0.0.0.0'</span>,
      <span class="hljs-attr">port</span>: port
    };

    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">server</span>.<span class="hljs-title function_">listen</span>(address);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`TCPæœåŠ¡å™¨ç›‘å¬ç«¯å£: <span class="hljs-subst">${port}</span>`</span>);
  }

  <span class="hljs-comment">/**
   * å¹¿æ’­æ¶ˆæ¯ç»™æ‰€æœ‰å®¢æˆ·ç«¯
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">broadcast</span>(<span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>, sender?: socket.<span class="hljs-property">TCPSocketConnection</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">sendOptions</span>: socket.<span class="hljs-property">TCPSendOptions</span> = {
      <span class="hljs-attr">data</span>: message
    };

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> client <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">clients</span>) {
      <span class="hljs-keyword">if</span> (client !== sender) {
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">send</span>(sendOptions);
        } <span class="hljs-keyword">catch</span> (err) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å‘é€å¤±è´¥:'</span>, err);
        }
      }
    }
  }

  <span class="hljs-comment">/**
   * åœæ­¢æœåŠ¡å™¨
   */</span>
  <span class="hljs-title function_">stop</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// å…³é—­æ‰€æœ‰å®¢æˆ·ç«¯è¿æ¥</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> client <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">clients</span>) {
      client.<span class="hljs-title function_">close</span>();
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">clients</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">server</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connect'</span>);
  }
}
</code></pre>
<h3 data-id="heading-12">4.3 TLS SocketåŠ å¯†é€šä¿¡</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TLSSocketClient</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span>;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tls</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupEventHandlers</span>();
  }

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">setupEventHandlers</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tls</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'TLSè¿æ¥å»ºç«‹'</span>);
    });

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tls</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">value: socket.SocketMessageInfo</span>) =&gt;</span> {
      <span class="hljs-comment">// å¤„ç†åŠ å¯†æ¶ˆæ¯</span>
    });

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tls</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'TLSè¿æ¥å…³é—­'</span>);
    });
  }

  <span class="hljs-comment">/**
   * å•å‘è®¤è¯è¿æ¥(ä»…éªŒè¯æœåŠ¡å™¨è¯ä¹¦)
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">connectOneWay</span>(<span class="hljs-attr">host</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">port</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">caPath</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">localAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {
      <span class="hljs-attr">address</span>: <span class="hljs-string">'0.0.0.0'</span>,
      <span class="hljs-attr">port</span>: <span class="hljs-number">0</span>
    };

    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tls</span>.<span class="hljs-title function_">bind</span>(localAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (err) <span class="hljs-title function_">reject</span>(err);
        <span class="hljs-keyword">else</span> <span class="hljs-title function_">resolve</span>();
      });
    });

    <span class="hljs-keyword">const</span> <span class="hljs-attr">remoteAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {
      <span class="hljs-attr">address</span>: host,
      <span class="hljs-attr">port</span>: port
    };

    <span class="hljs-keyword">const</span> <span class="hljs-attr">secureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {
      <span class="hljs-attr">ca</span>: [caPath], <span class="hljs-comment">// CAè¯ä¹¦è·¯å¾„</span>
      <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">'AES256-SHA256'</span>
    };

    <span class="hljs-keyword">const</span> <span class="hljs-attr">connectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {
      <span class="hljs-attr">address</span>: remoteAddr,
      <span class="hljs-attr">secureOptions</span>: secureOptions
    };

    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tls</span>.<span class="hljs-title function_">connect</span>(connectOptions);
  }

  <span class="hljs-comment">/**
   * åŒå‘è®¤è¯è¿æ¥(åŒæ—¶éªŒè¯å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨è¯ä¹¦)
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">connectTwoWay</span>(
    <span class="hljs-attr">host</span>: <span class="hljs-built_in">string</span>,
    <span class="hljs-attr">port</span>: <span class="hljs-built_in">number</span>,
    <span class="hljs-attr">caPath</span>: <span class="hljs-built_in">string</span>,
    <span class="hljs-attr">certPath</span>: <span class="hljs-built_in">string</span>,
    <span class="hljs-attr">keyPath</span>: <span class="hljs-built_in">string</span>,
    <span class="hljs-attr">password</span>: <span class="hljs-built_in">string</span>
  ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">localAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {
      <span class="hljs-attr">address</span>: <span class="hljs-string">'0.0.0.0'</span>,
      <span class="hljs-attr">port</span>: <span class="hljs-number">0</span>
    };

    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tls</span>.<span class="hljs-title function_">bind</span>(localAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (err) <span class="hljs-title function_">reject</span>(err);
        <span class="hljs-keyword">else</span> <span class="hljs-title function_">resolve</span>();
      });
    });

    <span class="hljs-keyword">const</span> <span class="hljs-attr">remoteAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {
      <span class="hljs-attr">address</span>: host,
      <span class="hljs-attr">port</span>: port
    };

    <span class="hljs-keyword">const</span> <span class="hljs-attr">secureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {
      <span class="hljs-attr">ca</span>: [caPath],
      <span class="hljs-attr">cert</span>: certPath, <span class="hljs-comment">// å®¢æˆ·ç«¯è¯ä¹¦</span>
      <span class="hljs-attr">key</span>: keyPath,   <span class="hljs-comment">// å®¢æˆ·ç«¯ç§é’¥</span>
      <span class="hljs-attr">password</span>: password, <span class="hljs-comment">// ç§é’¥å¯†ç </span>
      <span class="hljs-attr">protocols</span>: [socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>],
      <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">'AES256-SHA256'</span>
    };

    <span class="hljs-keyword">const</span> <span class="hljs-attr">connectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {
      <span class="hljs-attr">address</span>: remoteAddr,
      <span class="hljs-attr">secureOptions</span>: secureOptions
    };

    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tls</span>.<span class="hljs-title function_">connect</span>(connectOptions);
  }

  <span class="hljs-comment">/**
   * å‘é€åŠ å¯†æ•°æ®
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">send</span>(<span class="hljs-attr">data</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tls</span>.<span class="hljs-title function_">send</span>(data);
  }

  <span class="hljs-comment">/**
   * å…³é—­è¿æ¥
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">close</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tls</span>.<span class="hljs-title function_">close</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tls</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'message'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tls</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connect'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tls</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'close'</span>);
  }
}
</code></pre>
<h2 data-id="heading-13">äº”ã€å®Œæ•´ç¤ºä¾‹:ç½‘ç»œç®¡ç†å™¨åº”ç”¨</h2>
<p>åˆ›å»ºä¸€ä¸ªç»Ÿä¸€çš„ç½‘ç»œç®¡ç†å™¨,æ•´åˆæ‰€æœ‰ç½‘ç»œèƒ½åŠ›:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { http } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;
<span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;
<span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;

<span class="hljs-comment">/**
 * ç½‘ç»œç®¡ç†å™¨å•ä¾‹
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">NetworkManager</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">instance</span>: <span class="hljs-title class_">NetworkManager</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">wsClient</span>: <span class="hljs-title class_">WebSocketClient</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">tcpClient</span>: <span class="hljs-title class_">TCPSocketClient</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {}

  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title function_">getInstance</span>(): <span class="hljs-title class_">NetworkManager</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">NetworkManager</span>.<span class="hljs-property">instance</span>) {
      <span class="hljs-title class_">NetworkManager</span>.<span class="hljs-property">instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NetworkManager</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">NetworkManager</span>.<span class="hljs-property">instance</span>;
  }

  <span class="hljs-comment">/**
   * HTTP GETè¯·æ±‚
   */</span>
  <span class="hljs-keyword">async</span> httpGet&lt;T&gt;(<span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;T&gt; {
    <span class="hljs-keyword">const</span> httpRequest = http.<span class="hljs-title function_">createHttp</span>();

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> httpRequest.<span class="hljs-title function_">request</span>(url, {
        <span class="hljs-attr">method</span>: http.<span class="hljs-property">RequestMethod</span>.<span class="hljs-property">GET</span>,
        <span class="hljs-attr">header</span>: { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> },
        <span class="hljs-attr">expectDataType</span>: http.<span class="hljs-property">HttpDataType</span>.<span class="hljs-property">STRING</span>,
        <span class="hljs-attr">connectTimeout</span>: <span class="hljs-number">60000</span>,
        <span class="hljs-attr">readTimeout</span>: <span class="hljs-number">60000</span>
      });

      <span class="hljs-keyword">if</span> (response.<span class="hljs-property">responseCode</span> === <span class="hljs-number">200</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(response.<span class="hljs-property">result</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTP <span class="hljs-subst">${response.responseCode}</span>`</span>);
      }
    } <span class="hljs-keyword">finally</span> {
      httpRequest.<span class="hljs-title function_">destroy</span>();
    }
  }

  <span class="hljs-comment">/**
   * HTTP POSTè¯·æ±‚
   */</span>
  <span class="hljs-keyword">async</span> httpPost&lt;T&gt;(<span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">data</span>: <span class="hljs-title class_">Object</span>): <span class="hljs-title class_">Promise</span>&lt;T&gt; {
    <span class="hljs-keyword">const</span> httpRequest = http.<span class="hljs-title function_">createHttp</span>();

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> httpRequest.<span class="hljs-title function_">request</span>(url, {
        <span class="hljs-attr">method</span>: http.<span class="hljs-property">RequestMethod</span>.<span class="hljs-property">POST</span>,
        <span class="hljs-attr">header</span>: { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> },
        <span class="hljs-attr">extraData</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data),
        <span class="hljs-attr">expectDataType</span>: http.<span class="hljs-property">HttpDataType</span>.<span class="hljs-property">STRING</span>,
        <span class="hljs-attr">connectTimeout</span>: <span class="hljs-number">60000</span>,
        <span class="hljs-attr">readTimeout</span>: <span class="hljs-number">60000</span>
      });

      <span class="hljs-keyword">if</span> (response.<span class="hljs-property">responseCode</span> === <span class="hljs-number">200</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(response.<span class="hljs-property">result</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTP <span class="hljs-subst">${response.responseCode}</span>`</span>);
      }
    } <span class="hljs-keyword">finally</span> {
      httpRequest.<span class="hljs-title function_">destroy</span>();
    }
  }

  <span class="hljs-comment">/**
   * ä¸‹è½½æ–‡ä»¶å¹¶æ˜¾ç¤ºè¿›åº¦
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">downloadFile</span>(
    <span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>,
    <span class="hljs-attr">onProgress</span>: <span class="hljs-function">(<span class="hljs-params">received: <span class="hljs-built_in">number</span>, total: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>
  ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ArrayBuffer</span>&gt; {
    <span class="hljs-keyword">const</span> downloader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpStreamDownloader</span>();
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> downloader.<span class="hljs-title function_">downloadFile</span>(url, onProgress);
  }

  <span class="hljs-comment">/**
   * è¿æ¥WebSocket
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">connectWebSocket</span>(<span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">WebSocketClient</span>&gt; {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">wsClient</span>) {
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsClient</span>.<span class="hljs-title function_">close</span>();
    }

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsClient</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocketClient</span>(url);
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsClient</span>.<span class="hljs-title function_">connect</span>();
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsClient</span>;
  }

  <span class="hljs-comment">/**
   * è·å–WebSocketå®¢æˆ·ç«¯
   */</span>
  <span class="hljs-title function_">getWebSocketClient</span>(): <span class="hljs-title class_">WebSocketClient</span> | <span class="hljs-literal">null</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsClient</span>;
  }

  <span class="hljs-comment">/**
   * è¿æ¥TCP Socket
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">connectTCPSocket</span>(<span class="hljs-attr">host</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">port</span>: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">TCPSocketClient</span>&gt; {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">tcpClient</span>) {
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcpClient</span>.<span class="hljs-title function_">close</span>();
    }

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcpClient</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TCPSocketClient</span>();
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcpClient</span>.<span class="hljs-title function_">connect</span>(host, port);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcpClient</span>;
  }

  <span class="hljs-comment">/**
   * è·å–TCP Socketå®¢æˆ·ç«¯
   */</span>
  <span class="hljs-title function_">getTCPSocketClient</span>(): <span class="hljs-title class_">TCPSocketClient</span> | <span class="hljs-literal">null</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcpClient</span>;
  }

  <span class="hljs-comment">/**
   * æ¸…ç†æ‰€æœ‰è¿æ¥
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">cleanup</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">wsClient</span>) {
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsClient</span>.<span class="hljs-title function_">close</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsClient</span> = <span class="hljs-literal">null</span>;
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">tcpClient</span>) {
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcpClient</span>.<span class="hljs-title function_">close</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcpClient</span> = <span class="hljs-literal">null</span>;
    }
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">NetworkManager</span>;
</code></pre>
<h3 data-id="heading-14">ä½¿ç”¨ç¤ºä¾‹é¡µé¢</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">NetworkManager</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./NetworkManager'</span>;

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">NetworkTestPage</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'ç½‘ç»œæµ‹è¯•'</span>;
  <span class="hljs-meta">@State</span> <span class="hljs-attr">httpResult</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;
  <span class="hljs-meta">@State</span> <span class="hljs-attr">downloadProgress</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'0%'</span>;
  <span class="hljs-meta">@State</span> <span class="hljs-attr">wsStatus</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'æœªè¿æ¥'</span>;
  <span class="hljs-meta">@State</span> <span class="hljs-attr">tcpStatus</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'æœªè¿æ¥'</span>;

  <span class="hljs-keyword">private</span> networkManager = <span class="hljs-title class_">NetworkManager</span>.<span class="hljs-title function_">getInstance</span>();

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">20</span> }) {
      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">24</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)

      <span class="hljs-comment">// HTTPæµ‹è¯•åŒº</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'HTTPè¯·æ±‚æµ‹è¯•'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Medium</span>)

      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'GETè¯·æ±‚'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">testHttpGet</span>())

      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'POSTè¯·æ±‚'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">testHttpPost</span>())

      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'ä¸‹è½½æ–‡ä»¶'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">testDownload</span>())

      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">httpResult</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)

      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`ä¸‹è½½è¿›åº¦: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.downloadProgress}</span>`</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)

      <span class="hljs-title class_">Divider</span>()

      <span class="hljs-comment">// WebSocketæµ‹è¯•åŒº</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'WebSocketæµ‹è¯•'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Medium</span>)

      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`çŠ¶æ€: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.wsStatus}</span>`</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)

      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'è¿æ¥WebSocket'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">testWebSocket</span>())

      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'å‘é€WebSocketæ¶ˆæ¯'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sendWebSocketMessage</span>())

      <span class="hljs-title class_">Divider</span>()

      <span class="hljs-comment">// TCP Socketæµ‹è¯•åŒº</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'TCP Socketæµ‹è¯•'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Medium</span>)

      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`çŠ¶æ€: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.tcpStatus}</span>`</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)

      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'è¿æ¥TCP'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">testTCPSocket</span>())

      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'å‘é€TCPæ¶ˆæ¯'</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sendTCPMessage</span>())
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">padding</span>(<span class="hljs-number">20</span>)
  }

  <span class="hljs-comment">/**
   * æµ‹è¯•HTTP GETè¯·æ±‚
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">testHttpGet</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">networkManager</span>.<span class="hljs-title function_">httpGet</span>(<span class="hljs-string">'https://api.example.com/data'</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpResult</span> = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(result);
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpResult</span> = <span class="hljs-string">`è¯·æ±‚å¤±è´¥: <span class="hljs-subst">${err}</span>`</span>;
    }
  }

  <span class="hljs-comment">/**
   * æµ‹è¯•HTTP POSTè¯·æ±‚
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">testHttpPost</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> data = { <span class="hljs-attr">name</span>: <span class="hljs-string">'test'</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">123</span> };
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">networkManager</span>.<span class="hljs-title function_">httpPost</span>(<span class="hljs-string">'https://api.example.com/submit'</span>, data);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpResult</span> = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(result);
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpResult</span> = <span class="hljs-string">`è¯·æ±‚å¤±è´¥: <span class="hljs-subst">${err}</span>`</span>;
    }
  }

  <span class="hljs-comment">/**
   * æµ‹è¯•æ–‡ä»¶ä¸‹è½½
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">testDownload</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">networkManager</span>.<span class="hljs-title function_">downloadFile</span>(
        <span class="hljs-string">'https://example.com/file.zip'</span>,
        <span class="hljs-function">(<span class="hljs-params">received, total</span>) =&gt;</span> {
          <span class="hljs-keyword">const</span> percent = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((received / total) * <span class="hljs-number">100</span>);
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">downloadProgress</span> = <span class="hljs-string">`<span class="hljs-subst">${percent}</span>%`</span>;
        }
      );
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpResult</span> = <span class="hljs-string">`ä¸‹è½½å®Œæˆ,å¤§å°: <span class="hljs-subst">${data.byteLength}</span> å­—èŠ‚`</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">downloadProgress</span> = <span class="hljs-string">'100%'</span>;
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpResult</span> = <span class="hljs-string">`ä¸‹è½½å¤±è´¥: <span class="hljs-subst">${err}</span>`</span>;
    }
  }

  <span class="hljs-comment">/**
   * æµ‹è¯•WebSocketè¿æ¥
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">testWebSocket</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">networkManager</span>.<span class="hljs-title function_">connectWebSocket</span>(<span class="hljs-string">'ws://example.com:8080'</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsStatus</span> = <span class="hljs-string">'å·²è¿æ¥'</span>;
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsStatus</span> = <span class="hljs-string">`è¿æ¥å¤±è´¥: <span class="hljs-subst">${err}</span>`</span>;
    }
  }

  <span class="hljs-comment">/**
   * å‘é€WebSocketæ¶ˆæ¯
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">sendWebSocketMessage</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">const</span> client = <span class="hljs-variable language_">this</span>.<span class="hljs-property">networkManager</span>.<span class="hljs-title function_">getWebSocketClient</span>();
    <span class="hljs-keyword">if</span> (!client) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsStatus</span> = <span class="hljs-string">'æœªè¿æ¥'</span>;
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">sendText</span>(<span class="hljs-string">'Hello WebSocket!'</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsStatus</span> = <span class="hljs-string">'æ¶ˆæ¯å·²å‘é€'</span>;
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsStatus</span> = <span class="hljs-string">`å‘é€å¤±è´¥: <span class="hljs-subst">${err}</span>`</span>;
    }
  }

  <span class="hljs-comment">/**
   * æµ‹è¯•TCP Socketè¿æ¥
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">testTCPSocket</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">networkManager</span>.<span class="hljs-title function_">connectTCPSocket</span>(<span class="hljs-string">'192.168.1.100'</span>, <span class="hljs-number">8888</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcpStatus</span> = <span class="hljs-string">'å·²è¿æ¥'</span>;
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcpStatus</span> = <span class="hljs-string">`è¿æ¥å¤±è´¥: <span class="hljs-subst">${err}</span>`</span>;
    }
  }

  <span class="hljs-comment">/**
   * å‘é€TCPæ¶ˆæ¯
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">sendTCPMessage</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">const</span> client = <span class="hljs-variable language_">this</span>.<span class="hljs-property">networkManager</span>.<span class="hljs-title function_">getTCPSocketClient</span>();
    <span class="hljs-keyword">if</span> (!client) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcpStatus</span> = <span class="hljs-string">'æœªè¿æ¥'</span>;
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">send</span>(<span class="hljs-string">'Hello TCP!'</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcpStatus</span> = <span class="hljs-string">'æ¶ˆæ¯å·²å‘é€'</span>;
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tcpStatus</span> = <span class="hljs-string">`å‘é€å¤±è´¥: <span class="hljs-subst">${err}</span>`</span>;
    }
  }

  <span class="hljs-title function_">aboutToDisappear</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// é¡µé¢é”€æ¯æ—¶æ¸…ç†è¿æ¥</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">networkManager</span>.<span class="hljs-title function_">cleanup</span>();
  }
}
</code></pre>
<h2 data-id="heading-15">å…­ã€æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-16">6.1 ç½‘ç»œè¯·æ±‚ä¼˜åŒ–</h3>
<ol>
<li><strong>è¿æ¥å¤ç”¨</strong>: HTTP/2å’ŒHTTP/3æ”¯æŒè¿æ¥å¤ç”¨,å‡å°‘æ¡æ‰‹å¼€é”€</li>
<li><strong>è¶…æ—¶è®¾ç½®</strong>: æ ¹æ®ä¸šåŠ¡åœºæ™¯åˆç†è®¾ç½®connectTimeoutå’ŒreadTimeout</li>
<li><strong>èµ„æºé‡Šæ”¾</strong>: åŠæ—¶è°ƒç”¨destroy()é‡Šæ”¾HttpRequestå¯¹è±¡</li>
<li><strong>ç¼“å­˜ç­–ç•¥</strong>: åˆç†ä½¿ç”¨usingCacheå‚æ•°,å‡å°‘é‡å¤è¯·æ±‚</li>
</ol>
<h3 data-id="heading-17">6.2 é”™è¯¯å¤„ç†</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> robustHttpRequest&lt;T&gt;(<span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">retries</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">3</span>): <span class="hljs-title class_">Promise</span>&lt;T&gt; {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">lastError</span>: <span class="hljs-title class_">Error</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; retries; i++) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title class_">NetworkManager</span>.<span class="hljs-title function_">getInstance</span>().<span class="hljs-property">httpGet</span>&lt;T&gt;(url);
      <span class="hljs-keyword">return</span> result;
    } <span class="hljs-keyword">catch</span> (err) {
      lastError = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">Error</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`è¯·æ±‚å¤±è´¥,ç¬¬<span class="hljs-subst">${i + <span class="hljs-number">1</span>}</span>æ¬¡é‡è¯•:`</span>, err);

      <span class="hljs-comment">// ç­‰å¾…ä¸€æ®µæ—¶é—´åé‡è¯•</span>
      <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">1000</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, i)));
    }
  }

  <span class="hljs-keyword">throw</span> lastError || <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥'</span>);
}
</code></pre>
<h3 data-id="heading-18">6.3 è¯ä¹¦å®‰å…¨é…ç½®</h3>
<p>åœ¨<code>src/main/resources/base/profile/network_config.json</code>é…ç½®è¯ä¹¦é”å®š:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"network-security-config"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"domain-config"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"domains"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
          <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"include-subdomains"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"api.example.com"</span>
          <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"pin-set"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"expiration"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025-12-31"</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"pin"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
            <span class="hljs-punctuation">{</span>
              <span class="hljs-attr">"digest-algorithm"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"sha256"</span><span class="hljs-punctuation">,</span>
              <span class="hljs-attr">"digest"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"base64encodedpinvalue"</span>
            <span class="hljs-punctuation">}</span>
          <span class="hljs-punctuation">]</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-19">6.4 æ€§èƒ½ç›‘æ§</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">NetworkPerformanceMonitor</span> {
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">measureRequestTime</span>(<span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">number</span>&gt; {
    <span class="hljs-keyword">const</span> startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> <span class="hljs-title class_">NetworkManager</span>.<span class="hljs-title function_">getInstance</span>().<span class="hljs-title function_">httpGet</span>(url);
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - startTime;
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥:'</span>, err);
      <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
    }
  }

  <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">checkNetworkQuality</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt; {
    <span class="hljs-keyword">const</span> testUrl = <span class="hljs-string">'https://www.example.com'</span>;
    <span class="hljs-keyword">const</span> responseTime = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">measureRequestTime</span>(testUrl);

    <span class="hljs-keyword">if</span> (responseTime &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'ç½‘ç»œå¼‚å¸¸'</span>;
    <span class="hljs-keyword">if</span> (responseTime &lt; <span class="hljs-number">100</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'ç½‘ç»œä¼˜ç§€'</span>;
    <span class="hljs-keyword">if</span> (responseTime &lt; <span class="hljs-number">300</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'ç½‘ç»œè‰¯å¥½'</span>;
    <span class="hljs-keyword">if</span> (responseTime &lt; <span class="hljs-number">1000</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'ç½‘ç»œä¸€èˆ¬'</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-string">'ç½‘ç»œè¾ƒå·®'</span>;
  }
}
</code></pre>
<h2 data-id="heading-20">ä¸ƒã€å¸¸è§é—®é¢˜</h2>
<h3 data-id="heading-21">Q1: åº”ç”¨é€€åˆ°åå°åSocketæ–­å¼€æ€ä¹ˆåŠ?</h3>
<p>A: åº”ç”¨é€€åå°åSocketå¯èƒ½æ–­å¼€,éœ€è¦åœ¨é‡å›å‰å°æ—¶æ£€æµ‹å¹¶é‡è¿:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">onPageShow</span>(): <span class="hljs-built_in">void</span> {
  <span class="hljs-comment">// æ£€æŸ¥è¿æ¥çŠ¶æ€</span>
  <span class="hljs-keyword">const</span> client = <span class="hljs-variable language_">this</span>.<span class="hljs-property">networkManager</span>.<span class="hljs-title function_">getTCPSocketClient</span>();
  <span class="hljs-keyword">if</span> (client &amp;&amp; !client.<span class="hljs-title function_">isConnected</span>()) {
    <span class="hljs-comment">// é‡æ–°è¿æ¥</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">reconnectSocket</span>();
  }
}
</code></pre>
<h3 data-id="heading-22">Q2: å¦‚ä½•å¤„ç†å¤§æ–‡ä»¶ä¸Šä¼ ?</h3>
<p>A: ä½¿ç”¨multipart/form-dataæ ¼å¼,è®¾ç½®æ›´é•¿çš„è¶…æ—¶æ—¶é—´:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">async</span> <span class="hljs-title function_">uploadLargeFile</span>(<span class="hljs-attr">filePath</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
  <span class="hljs-keyword">const</span> httpRequest = http.<span class="hljs-title function_">createHttp</span>();

  <span class="hljs-keyword">await</span> httpRequest.<span class="hljs-title function_">request</span>(url, {
    <span class="hljs-attr">method</span>: http.<span class="hljs-property">RequestMethod</span>.<span class="hljs-property">POST</span>,
    <span class="hljs-attr">header</span>: { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'multipart/form-data'</span> },
    <span class="hljs-attr">multiFormDataList</span>: [{
      <span class="hljs-attr">name</span>: <span class="hljs-string">'file'</span>,
      <span class="hljs-attr">contentType</span>: <span class="hljs-string">'application/octet-stream'</span>,
      <span class="hljs-attr">filePath</span>: filePath,
      <span class="hljs-attr">remoteFileName</span>: <span class="hljs-string">'large_file.zip'</span>
    }],
    <span class="hljs-attr">readTimeout</span>: <span class="hljs-number">600000</span>, <span class="hljs-comment">// 10åˆ†é’Ÿ</span>
    <span class="hljs-attr">connectTimeout</span>: <span class="hljs-number">60000</span>
  });
}
</code></pre>
<h3 data-id="heading-23">Q3: WebSocketå¦‚ä½•å®ç°å¿ƒè·³ä¿æ´»?</h3>
<p>A: HarmonyOSçš„WebSocketå·²å†…ç½®å¿ƒè·³æœºåˆ¶,æ¯30ç§’è‡ªåŠ¨å‘é€Pingå¸§,60ç§’æ— å“åº”ä¼šæ–­å¼€è¿æ¥ã€‚å¼€å‘è€…æ— éœ€é¢å¤–å®ç°ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Math.jså°è£…å·¥å…·åº“ï¼ˆè§£å†³å‰ç«¯å› ä¸ºæµ®ç‚¹æ•°å¯¼è‡´è®¡ç®—é”™è¯¯ï¼‰]]></title>    <link>https://juejin.cn/post/7570896170920476735</link>    <guid>https://juejin.cn/post/7570896170920476735</guid>    <pubDate>2025-11-10T08:43:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570896170920476735" data-draft-id="7435682717955932186" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Math.jså°è£…å·¥å…·åº“ï¼ˆè§£å†³å‰ç«¯å› ä¸ºæµ®ç‚¹æ•°å¯¼è‡´è®¡ç®—é”™è¯¯ï¼‰"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-11-10T08:43:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Jackè±æ°"/> <meta itemprop="url" content="https://juejin.cn/user/720885038716663"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Math.jså°è£…å·¥å…·åº“ï¼ˆè§£å†³å‰ç«¯å› ä¸ºæµ®ç‚¹æ•°å¯¼è‡´è®¡ç®—é”™è¯¯ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/720885038716663/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Jackè±æ°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T08:43:32.000Z" title="Mon Nov 10 2025 08:43:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚è¿°</h2>
<p>è¯¥å·¥å…·åº“æ˜¯åŸºäº mathjs å°è£…çš„ä¸€ä¸ªæ•°å­¦è®¡ç®—å·¥å…·ï¼Œä¸»è¦è§£å†³ JavaScript æµ®ç‚¹æ•°è¿ç®—ç²¾åº¦é—®é¢˜ï¼Œæä¾›ç²¾ç¡®çš„åŠ å‡ä¹˜é™¤ã€å–æ¨¡ç­‰è¿ç®—åŠŸèƒ½ï¼Œç‰¹åˆ«é€‚åˆè´¢åŠ¡ã€é‡‘èç­‰éœ€è¦é«˜ç²¾åº¦è®¡ç®—çš„åœºæ™¯ã€‚</p>
<h2 data-id="heading-1">å®‰è£…ä¸ä½¿ç”¨</h2>
<h3 data-id="heading-2">å®‰è£…ä¾èµ–</h3>
<pre><code class="hljs language-bash" lang="bash">npm install mathjs --save
</code></pre>
<h2 data-id="heading-3">ä½¿ç”¨</h2>
<p>utils/math.js</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> $math <span class="hljs-keyword">from</span> <span class="hljs-string">"mathjs"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> math = {
  <span class="hljs-title function_">add</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">comp</span>(<span class="hljs-string">"add"</span>, <span class="hljs-variable language_">arguments</span>);
  },
  <span class="hljs-title function_">subtract</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">comp</span>(<span class="hljs-string">"subtract"</span>, <span class="hljs-variable language_">arguments</span>);
  },
  <span class="hljs-title function_">multiply</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">comp</span>(<span class="hljs-string">"multiply"</span>, <span class="hljs-variable language_">arguments</span>);
  },
  <span class="hljs-title function_">divide</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">comp</span>(<span class="hljs-string">"divide"</span>, <span class="hljs-variable language_">arguments</span>);
  },
  <span class="hljs-title function_">mod</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">comp</span>(<span class="hljs-string">"mod"</span>, <span class="hljs-variable language_">arguments</span>);
  },
  <span class="hljs-title function_">divMod</span>(<span class="hljs-params">a, b</span>) {
    <span class="hljs-keyword">const</span> quotient = $math.<span class="hljs-title function_">floor</span>(
      $math.<span class="hljs-title function_">divide</span>($math.<span class="hljs-title function_">bignumber</span>(a), $math.<span class="hljs-title function_">bignumber</span>(b))
    ); <span class="hljs-comment">// ä½¿ç”¨ floor è·å–æ•´æ•°éƒ¨åˆ†</span>
    <span class="hljs-keyword">const</span> remainder = $math.<span class="hljs-title function_">mod</span>($math.<span class="hljs-title function_">bignumber</span>(a), $math.<span class="hljs-title function_">bignumber</span>(b));
    <span class="hljs-keyword">return</span> [<span class="hljs-built_in">parseFloat</span>(quotient), <span class="hljs-built_in">parseFloat</span>(remainder)];
    <span class="hljs-comment">// return {</span>
    <span class="hljs-comment">//   quotient: parseFloat(quotient),</span>
    <span class="hljs-comment">//   remainder: parseFloat(remainder),</span>
    <span class="hljs-comment">// };</span>
  },
  <span class="hljs-comment">// å¤„ç†å¤§æ•°å­—</span>
  <span class="hljs-title function_">bignumber</span>(<span class="hljs-params">string</span>) {
    <span class="hljs-keyword">return</span> $math.<span class="hljs-title function_">bignumber</span>(string).<span class="hljs-title function_">toNumber</span>();
  },
  <span class="hljs-comment">// æ¯”å¤§å°</span>
  <span class="hljs-title function_">compare</span>(<span class="hljs-params">a, b</span>) {
    <span class="hljs-keyword">const</span> numA = $math.<span class="hljs-title function_">bignumber</span>(a);
    <span class="hljs-keyword">const</span> numB = $math.<span class="hljs-title function_">bignumber</span>(b);

    <span class="hljs-keyword">if</span> ($math.<span class="hljs-title function_">equal</span>(numA, numB)) {
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; <span class="hljs-comment">// ç›¸ç­‰</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($math.<span class="hljs-title function_">smaller</span>(numA, numB)) {
      <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>; <span class="hljs-comment">// a &lt; b</span>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>; <span class="hljs-comment">// a &gt; b</span>
    }
  },
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">comp</span>(<span class="hljs-params">_func, args</span>) {
  <span class="hljs-keyword">let</span> t = $math.<span class="hljs-title function_">chain</span>($math.<span class="hljs-title function_">bignumber</span>(args[<span class="hljs-number">0</span>]));

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; args.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> arg = args[i] || <span class="hljs-number">0</span>;
    t = t[_func]($math.<span class="hljs-title function_">bignumber</span>(arg));
  }
  <span class="hljs-comment">// é˜²æ­¢è¶…è¿‡6ä½ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•</span>
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseFloat</span>(t.<span class="hljs-title function_">done</span>());
}

<span class="hljs-comment">// ä½¿ç”¨åœºæ™¯</span>
<span class="hljs-comment">// import { math } from '@/utils/math.js'</span>
<span class="hljs-comment">// åŠ æ³•</span>
<span class="hljs-comment">//    const result  = math.add(2, 3)  // 5</span>
<span class="hljs-comment">// å‡æ³•</span>
<span class="hljs-comment">//    const result  = math.subtract(3, 2)   // 1</span>
<span class="hljs-comment">// ä¹˜æ³•</span>
<span class="hljs-comment">//     const result  = math.multiply(2, 3) // 6</span>
<span class="hljs-comment">// é™¤æ³•</span>
<span class="hljs-comment">//       const result = math.divide(4, 2) // 2</span>
<span class="hljs-comment">// é™¤ä½™</span>
<span class="hljs-comment">// const result = math.mod(10, 3); //1</span>
<span class="hljs-comment">// é™¤ä½™æ–¹æ³•</span>
<span class="hljs-comment">//  math.divMod(10, 3);  // è¾“å‡º: { quotient: 3, remainder: 1 }</span>
<span class="hljs-comment">// å¯ä»¥å¤šä¸ª</span>
<span class="hljs-comment">//    const result  = math.multiply(3, 2, 2, 2)   // 24</span>
<span class="hljs-comment">// å–å†³äºmath.jsæ–‡ä»¶é‡Œé¢çš„å‘½åï¼ŒPSï¼šä¸­é—´æ˜¯é€—å·</span>
</code></pre>
<p>demo.vue</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>é™¤æ³•<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ number01 }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ number1 }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>ä¹˜æ³•<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ number02 }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ number2 }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>åŠ æ³•<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ number03 }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ number3 }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>å‡æ³•<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ number04 }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ number4 }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>å¤šä¸ªè®¡ç®—<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ number5 }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { math } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/utils/math.js"</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">number1</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">number01</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">number02</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">number2</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">number03</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">number3</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">number04</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">number4</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">number5</span>: <span class="hljs-number">0</span>,
    };
  },
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">divide</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">multiply</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">add</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">subtract</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">multiplys</span>();
  },
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-title function_">divide</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">number01</span> = <span class="hljs-number">6.1</span> / <span class="hljs-number">0.1</span>; <span class="hljs-comment">// 60.99999999999999</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">number1</span> = math.<span class="hljs-title function_">divide</span>(<span class="hljs-number">6.1</span>, <span class="hljs-number">0.1</span>); <span class="hljs-comment">// 61</span>
    },
    <span class="hljs-title function_">multiply</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">number02</span> = <span class="hljs-number">23</span> * <span class="hljs-number">2.4</span>; <span class="hljs-comment">// 55.199999999999996</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">number2</span> = math.<span class="hljs-title function_">multiply</span>(<span class="hljs-number">23</span>, <span class="hljs-number">2.4</span>); <span class="hljs-comment">// 55.2</span>
    },
    <span class="hljs-title function_">add</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">number03</span> = <span class="hljs-number">0.1</span> + <span class="hljs-number">0.2</span>; <span class="hljs-comment">// 0.30000000000000004</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">number3</span> = math.<span class="hljs-title function_">add</span>(<span class="hljs-number">0.1</span>, <span class="hljs-number">0.2</span>); <span class="hljs-comment">// 0.3</span>
    },
    <span class="hljs-title function_">subtract</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">number04</span> = <span class="hljs-number">0.8</span> - <span class="hljs-number">0.7</span>; <span class="hljs-comment">// 0.10000000000000009</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">number4</span> = math.<span class="hljs-title function_">subtract</span>(<span class="hljs-number">0.8</span>, <span class="hljs-number">0.7</span>); <span class="hljs-comment">// 0.1</span>
    },
    <span class="hljs-title function_">multiplys</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">number5</span> = math.<span class="hljs-title function_">multiply</span>(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>); <span class="hljs-comment">// 24</span>
    },
  },
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[uni-app iOSæ€§èƒ½ç›‘æ§å…¨æ”»ç•¥ï¼Œè·¨ç«¯æ¶æ„ä¸‹çš„æ€§èƒ½é‡‡é›†ã€åˆ†æä¸å¤šå·¥å…·ååŒä¼˜åŒ–å®æˆ˜]]></title>    <link>https://juejin.cn/post/7570793903848095759</link>    <guid>https://juejin.cn/post/7570793903848095759</guid>    <pubDate>2025-11-10T08:43:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570793903848095759" data-draft-id="7570901172526317603" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="uni-app iOSæ€§èƒ½ç›‘æ§å…¨æ”»ç•¥ï¼Œè·¨ç«¯æ¶æ„ä¸‹çš„æ€§èƒ½é‡‡é›†ã€åˆ†æä¸å¤šå·¥å…·ååŒä¼˜åŒ–å®æˆ˜"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-10T08:43:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="bcbnb"/> <meta itemprop="url" content="https://juejin.cn/user/895474073078377"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            uni-app iOSæ€§èƒ½ç›‘æ§å…¨æ”»ç•¥ï¼Œè·¨ç«¯æ¶æ„ä¸‹çš„æ€§èƒ½é‡‡é›†ã€åˆ†æä¸å¤šå·¥å…·ååŒä¼˜åŒ–å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/895474073078377/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    bcbnb
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T08:43:51.000Z" title="Mon Nov 10 2025 08:43:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ç§»åŠ¨è·¨ç«¯å¼€å‘çš„ç”Ÿæ€ä¸­ï¼Œ<strong>uni-app</strong> å·²æˆä¸ºå›½å†…æœ€å—æ¬¢è¿çš„æ¡†æ¶ä¹‹ä¸€ã€‚
å®ƒè®©å¼€å‘è€…èƒ½å¤Ÿç”¨ä¸€å¥— Vue ä»£ç åŒæ—¶æ„å»º iOSã€Android ä¸ Web åº”ç”¨ã€‚
ä½†åœ¨æ€§èƒ½å±‚é¢ï¼Œè¿™ç§â€œå¤šå±‚æ¸²æŸ“ + JSBridgeé€šä¿¡ + WebViewå®¹å™¨â€çš„æ¶æ„ï¼Œä¹Ÿå¸¦æ¥äº†æ›´å¤æ‚çš„æ€§èƒ½æŒ‘æˆ˜ã€‚</p>
<p>å°¤å…¶åœ¨ <strong>iOS ç«¯</strong>ï¼Œç”±äºUIæ¸²æŸ“çº¿ç¨‹ä¸JSæ‰§è¡Œçº¿ç¨‹åˆ†ç¦»ã€WebViewå±‚æ€§èƒ½å—ç³»ç»Ÿç‰ˆæœ¬å½±å“è¾ƒå¤§ï¼Œæ€§èƒ½ç›‘æ§å’Œè°ƒä¼˜å¾€å¾€æˆä¸ºuni-appå¼€å‘è€…çš„æœ€å¤§ç—›ç‚¹ã€‚</p>
<p>æœ¬æ–‡å°†ç»“åˆå®æˆ˜ç»éªŒï¼Œä»‹ç»å¦‚ä½•é€šè¿‡ <strong>Xcode Instrumentsã€å…‹é­”ï¼ˆKeyMobï¼‰ã€Safari Web Inspectorã€Firebase Performance</strong> ç­‰å¤šå·¥å…·ååŒï¼Œå®ç°å¯¹uni-appåœ¨iOSç«¯çš„å…¨æ–¹ä½æ€§èƒ½ç›‘æ§ä¸ä¼˜åŒ–ã€‚</p>
<hr/>
<h3 data-id="heading-0">ä¸€ã€uni-appçš„iOSæ€§èƒ½ç‰¹ç‚¹</h3>
<p>åœ¨iOSå¹³å°ä¸Šï¼Œuni-app çš„è¿è¡Œæœºåˆ¶å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªâ€œå¤šå±‚æ¡¥æ¥æ ˆâ€ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[ JSå¼•æ“ (JavaScriptCore) ]</span>
        â†“
<span class="hljs-selector-attr">[ JSBridge (HBuilderæ¡†æ¶) ]</span>
        â†“
<span class="hljs-selector-attr">[ Native View / WKWebView ]</span>
        â†“
<span class="hljs-selector-attr">[ iOS System APIs ]</span>
</code></pre>
<p>è¿™æ„å‘³ç€æ€§èƒ½ç“¶é¢ˆå¯èƒ½å‡ºç°åœ¨å¤šä¸ªå±‚é¢ï¼š</p>
<ol>
<li><strong>JSçº¿ç¨‹æ€§èƒ½</strong> â€”â€” å¤§é‡è®¡ç®—ä»»åŠ¡é˜»å¡æ¸²æŸ“ï¼›</li>
<li><strong>æ¸²æŸ“å±‚æ€§èƒ½</strong> â€”â€” WebViewç»˜åˆ¶æ•ˆç‡ä½ï¼›</li>
<li><strong>Nativeå±‚é€šä¿¡</strong> â€”â€” JSBridgeè¿‡åº¦è°ƒç”¨æˆ–æ•°æ®åºåˆ—åŒ–å¼€é”€ï¼›</li>
<li><strong>èµ„æºåŠ è½½ä¸ç¼“å­˜ç­–ç•¥</strong> â€”â€” ç½‘ç»œå»¶è¿Ÿä¸å›¾ç‰‡ä½“ç§¯é€ æˆå¡é¡¿ï¼›</li>
<li><strong>èƒ½è€—ä¸å†…å­˜ç®¡ç†</strong> â€”â€” é•¿æ—¶é—´è¿è¡Œå¯¼è‡´å†…å­˜è†¨èƒ€ã€‚</li>
</ol>
<p>å› æ­¤ï¼Œæ€§èƒ½ç›‘æ§å¿…é¡»å®ç°â€œè·¨çº¿ç¨‹ã€è·¨å±‚çº§â€çš„è¦†ç›–ã€‚</p>
<hr/>
<h3 data-id="heading-1">äºŒã€æ€§èƒ½ç›‘æ§çš„æ ¸å¿ƒæŒ‡æ ‡</h3>



































<table><thead><tr><th>ç›‘æ§ç»´åº¦</th><th>æŒ‡æ ‡è¯´æ˜</th><th>å¸¸è§é—®é¢˜è¡¨ç°</th></tr></thead><tbody><tr><td>CPU ä½¿ç”¨ç‡</td><td>JSçº¿ç¨‹ä¸æ¸²æŸ“çº¿ç¨‹å ç”¨ç‡</td><td>æ»šåŠ¨å¡é¡¿ã€åŠ¨ç”»ä¸æµç•…</td></tr><tr><td>å†…å­˜å ç”¨</td><td>JSå¯¹è±¡ä¸ç¼“å­˜é‡Šæ”¾æƒ…å†µ</td><td>é•¿æ—¶é—´è¿è¡Œå´©æºƒ</td></tr><tr><td>GPU ä¸å¸§ç‡ï¼ˆFPSï¼‰</td><td>é¡µé¢æ¸²æŸ“é€Ÿç‡</td><td>é¡µé¢æ‰å¸§æˆ–é»‘å±</td></tr><tr><td>ç½‘ç»œæ€§èƒ½</td><td>è¯·æ±‚å»¶è¿Ÿã€èµ„æºåŠ è½½è€—æ—¶</td><td>é¡µé¢é¦–å±æ…¢</td></tr><tr><td>èƒ½è€—åˆ†æ</td><td>ç”µé‡æ¶ˆè€—ä¸åå°è¿è¡Œæƒ…å†µ</td><td>è¿‡çƒ­ã€ç»­èˆªå·®</td></tr></tbody></table>
<p>uni-app çš„æ€§èƒ½ç›‘æ§ç­–ç•¥ï¼Œåº”å›´ç»•è¿™äº”ä¸ªæ ¸å¿ƒç»´åº¦æ„å»ºã€‚</p>
<hr/>
<h3 data-id="heading-2">ä¸‰ã€Xcode Instrumentsï¼šåŸç”Ÿæ€§èƒ½é‡‡æ ·åŸºç¡€</h3>
<p>è™½ç„¶uni-appåŸºäºè·¨ç«¯æ¡†æ¶ï¼Œä½†åœ¨iOSç«¯æœ€ç»ˆä»è¿è¡Œåœ¨ <strong>Nativeå®¹å™¨ä¸WKWebViewç¯å¢ƒ</strong> ä¸­ã€‚
è¿™æ„å‘³ç€ä½ ä¾ç„¶å¯ä»¥åˆ©ç”¨ <strong>Xcode Instruments</strong> è¿›è¡Œåº•å±‚æ€§èƒ½é‡‡æ ·ã€‚</p>
<p><strong>æ¨èä½¿ç”¨çš„Instrumentsæ¨¡å—ï¼š</strong></p>
<ul>
<li><strong>Time Profiler</strong>ï¼šé‡‡æ ·CPUè°ƒç”¨ï¼Œå‘ç°JSBridgeä¸ä¸»çº¿ç¨‹é˜»å¡ã€‚</li>
<li><strong>Allocations / Leaks</strong>ï¼šç›‘æ§å†…å­˜åˆ†é…ä¸é‡Šæ”¾ã€‚</li>
<li><strong>Core Animation</strong>ï¼šåˆ†æå¸§ç‡ä¸UIæ‰å¸§ã€‚</li>
<li><strong>Network Monitor</strong>ï¼šæŸ¥çœ‹HTTPè¯·æ±‚æµé‡ä¸å»¶è¿Ÿã€‚</li>
</ul>
<p>ä¼˜ç‚¹ï¼šç²¾åº¦é«˜ï¼Œèƒ½è¯†åˆ«Appä¸­Nativeå±‚è°ƒç”¨æ ˆã€‚
ç¼ºç‚¹ï¼šæ— æ³•æŸ¥çœ‹JSå±‚å…·ä½“é€»è¾‘ï¼Œé‡‡æ ·æ—¶é—´å—é™ã€‚</p>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> è°ƒè¯•é˜¶æ®µæ€§èƒ½ç“¶é¢ˆå®šä½ã€‚</p>
<hr/>
<h3 data-id="heading-3">å››ã€å…‹é­”ï¼ˆKeyMobï¼‰ï¼šå¤šç»´å®æ—¶æ€§èƒ½ç›‘æ§ä¸æ—¥å¿—åˆ†æ</h3>
<p><strong>å…‹é­”ï¼ˆKeyMobï¼‰</strong> æ˜¯é¢å‘iOSå¼€å‘è€…çš„æ€§èƒ½ç›‘æ§ä¸æ•°æ®åˆ†æå·¥å…·ã€‚
ä¸Instrumentsä¸åŒï¼Œå®ƒèƒ½åœ¨<strong>éè¶Šç‹±ç¯å¢ƒä¸‹å®æ—¶é‡‡æ ·CPUã€GPUã€å†…å­˜ã€ç½‘ç»œä¸å¸§ç‡ï¼ˆFPSï¼‰</strong>ï¼Œå¹¶ä»¥å›¾è¡¨æ–¹å¼å±•ç¤ºã€‚</p>
<h4 data-id="heading-4">1. å®æ—¶æ€§èƒ½ç›‘æ§</h4>
<p>KeyMob èƒ½ç›´æ¥ç›‘æ§è¿è¡Œä¸­uni-appçš„ï¼š</p>
<ul>
<li>CPU/GPUå ç”¨æ›²çº¿</li>
<li>å†…å­˜åŠ¨æ€å˜åŒ–</li>
<li>ç½‘ç»œè¯·æ±‚ä¸å“åº”å»¶è¿Ÿ</li>
<li>FPSä¸å¡é¡¿ç‚¹</li>
</ul>
<p>åœ¨ä¸€æ¬¡å®é™…é¡¹ç›®ä¸­ï¼Œç¬”è€…åˆ©ç”¨KeyMobå‘ç°ä¸€ä¸ªuni-appé¡µé¢åœ¨åˆ—è¡¨æ»‘åŠ¨æ—¶CPUé£™å‡è‡³95%ï¼Œç»æ’æŸ¥å‘ç°JSå±‚é¢‘ç¹è§¦å‘åŒæ­¥DOMæ›´æ–°ã€‚ä¼˜åŒ–åï¼Œå¹³å‡å¸§ç‡ä»48fpsæå‡åˆ°59fpsã€‚</p>
<h4 data-id="heading-5">2. æ–‡ä»¶ä¸æ—¥å¿—åˆ†æ</h4>
<p>KeyMob å¯è®¿é—®åº”ç”¨çš„æ—¥å¿—æ–‡ä»¶ã€ç¼“å­˜ç›®å½•ä¸ç³»ç»Ÿæ—¥å¿—ã€‚
å¼€å‘è€…å¯ä»¥ç›´æ¥å¯¼å‡º <code>.log</code> æ–‡ä»¶å¹¶é€šè¿‡å…³é”®å­—è¿‡æ»¤ JSBridge é”™è¯¯æˆ–å´©æºƒæ ˆã€‚</p>
<h4 data-id="heading-6">3. å†å²æ€§èƒ½è®°å½•</h4>
<p>æ”¯æŒ6ä¸ªæœˆçš„æ€§èƒ½å†å²è®°å½•å­˜å‚¨ï¼Œæ–¹ä¾¿ç‰ˆæœ¬é—´å¯¹æ¯”ã€‚</p>
<p>ä¼˜ç‚¹ï¼šè·¨å¹³å°ï¼ˆMac/Windows/Linuxï¼‰ï¼Œå®æ—¶å¯è§†åŒ–ç›‘æ§ã€‚
ç¼ºç‚¹ï¼šä¸å…·å¤‡çº¿ä¸Šäº‘ç«¯ç»Ÿè®¡åŠŸèƒ½ã€‚</p>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> å†…æµ‹ä¸è°ƒä¼˜é˜¶æ®µçš„æœ¬åœ°æ€§èƒ½è¿½è¸ªã€‚</p>
<hr/>
<h3 data-id="heading-7">äº”ã€Safari Web Inspectorï¼šJSå±‚ä¸WebViewè°ƒè¯•åˆ©å™¨</h3>
<p><strong>Safari Web Inspector</strong> æ˜¯åˆ†æuni-app JSå±‚ä¸WebViewæ¸²æŸ“æ€§èƒ½çš„å®˜æ–¹å·¥å…·ã€‚</p>
<p>è¿æ¥çœŸæœºåï¼Œå¯é€šè¿‡ Safari â†’ Develop â†’ [è®¾å¤‡] â†’ [WebViewé¡µé¢] æ‰“å¼€è°ƒè¯•çª—å£ã€‚</p>
<p><strong>å…³é”®åŠŸèƒ½ï¼š</strong></p>
<ul>
<li>JSæ€§èƒ½åˆ†æï¼ˆProfilesï¼‰</li>
<li>ç½‘ç»œè¯·æ±‚æŸ¥çœ‹ï¼ˆNetworkï¼‰</li>
<li>DOMç»“æ„ä¸æ¸²æŸ“æ—¶é—´ç»Ÿè®¡</li>
<li>æ§åˆ¶å°æ—¥å¿—è¾“å‡º</li>
</ul>
<p>åœ¨uni-appé¡¹ç›®ä¸­ï¼Œå¸¸è§æ€§èƒ½é—®é¢˜å¦‚ï¼š</p>
<ul>
<li><code>setData()</code> è°ƒç”¨é¢‘ç‡è¿‡é«˜ï¼›</li>
<li>ä¸å¿…è¦çš„DOMæ›´æ–°ï¼›</li>
<li>JSå¾ªç¯è®¡ç®—é˜»å¡UIçº¿ç¨‹ã€‚</li>
</ul>
<p>é€šè¿‡Web Inspectorå¯ç›´è§‚åˆ†æè¿™äº›é—®é¢˜ã€‚</p>
<p>ä¼˜ç‚¹ï¼šè½»é‡ã€ç²¾ç¡®ã€å®˜æ–¹æ”¯æŒã€‚
ç¼ºç‚¹ï¼šä»…é™WebViewå±‚åˆ†æï¼Œä¸å«Nativeä¸æ€§èƒ½æŒ‡æ ‡ã€‚</p>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> JSé€»è¾‘ä¸DOMæ¸²æŸ“ä¼˜åŒ–ã€‚</p>
<hr/>
<h3 data-id="heading-8">å…­ã€Firebase Performanceï¼šçœŸå®ç”¨æˆ·æ€§èƒ½è¿½è¸ª</h3>
<p><strong>Firebase Performance</strong> èƒ½æ”¶é›†çœŸå®ç”¨æˆ·è®¾å¤‡çš„æ€§èƒ½æ•°æ®ï¼Œé€‚åˆuni-appä¸Šçº¿åçš„æ€§èƒ½è¶‹åŠ¿åˆ†æã€‚</p>
<p><strong>å¯ç›‘æ§æŒ‡æ ‡åŒ…æ‹¬ï¼š</strong></p>
<ul>
<li>å¯åŠ¨æ—¶é—´ï¼ˆApp Start Timeï¼‰</li>
<li>ç½‘ç»œè¯·æ±‚è€—æ—¶ï¼ˆHTTP Metricsï¼‰</li>
<li>é¡µé¢åŠ è½½æ—¶é—´</li>
<li>è‡ªå®šä¹‰æ€§èƒ½äº‹ä»¶</li>
</ul>
<p>ä¸uni-appé›†æˆæ—¶ï¼Œå¯ä»¥åœ¨ <code>manifest.json</code> ä¸­åŠ å…¥Firebase SDKé…ç½®ï¼Œå¹¶åœ¨JSä¸­åŸ‹ç‚¹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">firebase<span class="hljs-selector-class">.performance</span>()<span class="hljs-selector-class">.trace</span>("load_homepage")<span class="hljs-selector-class">.start</span>();
</code></pre>
<p>ä¼˜ç‚¹ï¼šè‡ªåŠ¨èšåˆæ•°æ®ã€å¯åŒºåˆ†åœ°åŒºä¸è®¾å¤‡ç±»å‹
ç¼ºç‚¹ï¼šä¸é€‚åˆå¼€å‘é˜¶æ®µå®æ—¶è°ƒè¯•</p>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> ä¸Šçº¿åæ€§èƒ½è¶‹åŠ¿ä¸ç”¨æˆ·ç«¯åé¦ˆç›‘æ§ã€‚</p>
<hr/>
<h3 data-id="heading-9">ä¸ƒã€å¤šå·¥å…·ååŒçš„å®Œæ•´å·¥ä½œæµ</h3>






























<table><thead><tr><th>é˜¶æ®µ</th><th>å·¥å…·ç»„åˆ</th><th>ç›®æ ‡</th></tr></thead><tbody><tr><td>å¼€å‘é˜¶æ®µ</td><td>Xcode Instruments + Safari Web Inspector</td><td>å®šä½JSä¸Nativeå±‚ç“¶é¢ˆ</td></tr><tr><td>å†…æµ‹é˜¶æ®µ</td><td>KeyMob + Web Inspector</td><td>å®æ—¶æ€§èƒ½ç›‘æ§ä¸JSå±‚è°ƒè¯•</td></tr><tr><td>ä¸Šçº¿é˜¶æ®µ</td><td>Firebase Performance + KeyMob æ•°æ®å¯¹æ¯”</td><td>ç”¨æˆ·ç«¯æ€§èƒ½è¶‹åŠ¿ä¸ç‰ˆæœ¬ä¼˜åŒ–éªŒè¯</td></tr><tr><td>é•¿æœŸç»´æŠ¤</td><td>KeyMob å†å²è®°å½• + Firebase æŠ¥å‘Š</td><td>å›å½’ç›‘æµ‹ä¸æ€§èƒ½æ³¢åŠ¨åˆ†æ</td></tr></tbody></table>
<p>é€šè¿‡è¿™æ ·çš„ç»„åˆï¼Œå¼€å‘è€…å¯ä»¥å®ç°ä»<strong>æœ¬åœ°è°ƒè¯• â†’ å†…æµ‹ä¼˜åŒ– â†’ ä¸Šçº¿è¿½è¸ª â†’ é•¿æœŸåˆ†æ</strong>çš„é—­ç¯ä½“ç³»ã€‚</p>
<hr/>
<h3 data-id="heading-10">å…«ã€å®æˆ˜æ¡ˆä¾‹ï¼šuni-appé¡µé¢å¡é¡¿çš„å…¨é“¾è·¯å®šä½</h3>
<p>åœ¨ä¸€æ¬¡H5ç”µå•†é¡¹ç›®ä¸­ï¼Œå¼€å‘è€…å‘ç°iPhoneç«¯é¡µé¢æ»šåŠ¨æ˜æ˜¾å¡é¡¿ã€‚
é€šè¿‡å¤šå·¥å…·åˆ†æï¼š</p>
<p><strong>Safari Web Inspector</strong>ï¼šå‘ç°JSå±‚é¢‘ç¹è°ƒç”¨ <code>setData()</code>ï¼Œæ›´æ–°èŠ‚ç‚¹è¿‡å¤šï¼›
<strong>KeyMob</strong>ï¼šç¡®è®¤å¡é¡¿æœŸé—´CPUå ç”¨æ¥è¿‘100%ï¼Œå¸§ç‡è·Œè‡³35fpsï¼›
<strong>Instruments</strong>ï¼šå®šä½åˆ°ä¸»çº¿ç¨‹é˜»å¡å‡½æ•°ä¸º <code>renderHTML()</code>ï¼›
<strong>ä¼˜åŒ–åæµ‹è¯•</strong>ï¼šCPUä¸‹é™è‡³45%ï¼Œå¹³å‡å¸§ç‡æå‡è‡³60fpsã€‚</p>
<p>ç»“åˆFirebaseçº¿ä¸Šæ•°æ®éªŒè¯ï¼Œå¹³å‡é¡µé¢åŠ è½½æ—¶é—´ä¸‹é™çº¦28%ã€‚</p>
<hr/>
<h3 data-id="heading-11">ä¹ã€æœªæ¥è¶‹åŠ¿ï¼šè·¨ç«¯æ¡†æ¶çš„æ€§èƒ½å¯è§†åŒ–</h3>
<p>éšç€uni-appã€Flutterã€React Nativeç­‰è·¨ç«¯æ¡†æ¶çš„å‘å±•ï¼Œæ€§èƒ½ç›‘æ§å°†èµ°å‘â€œ<strong>è·¨å±‚å¯è§†åŒ–</strong>â€ã€‚</p>
<ul>
<li>Apple æ­£å¼•å…¥ Swift Trace API ä¾›è·¨å±‚æ€§èƒ½é‡‡æ ·ï¼›</li>
<li>KeyMob è®¡åˆ’æ”¯æŒ H5ä¸Nativeæ··åˆæ€§èƒ½å›¾è¡¨å¯¹é½ï¼›</li>
<li>Firebase å°†æä¾›â€œè·¨ç«¯æ€§èƒ½è§†å›¾â€ï¼Œç»Ÿä¸€å±•ç¤ºiOS/Androidæ•°æ®ã€‚</li>
</ul>
<p>æœªæ¥çš„æ€§èƒ½åˆ†æå°†ä¸å†åˆ†æ•£åœ¨å·¥å…·ä¹‹é—´ï¼Œè€Œæ˜¯ä¸€ä¸ªè·¨ç”Ÿæ€çš„æ™ºèƒ½ç›‘æ§ç½‘ç»œã€‚</p>
<hr/>
<p>uni-app è®©å¼€å‘è€…ä»¥æ›´å¿«é€Ÿåº¦æ„å»ºå¤šç«¯Appï¼Œä½†æ€§èƒ½ç›‘æ§ç»ä¸èƒ½è¢«å¿½ç•¥ã€‚
é€šè¿‡ <strong>Xcode Instrumentsã€Safari Web Inspectorã€å…‹é­”ï¼ˆKeyMobï¼‰ã€Firebase Performance</strong> çš„ç»„åˆï¼Œä½ å¯ä»¥åœ¨ä¸åŒå±‚çº§å‘ç°æ€§èƒ½ç“¶é¢ˆï¼š</p>
<ul>
<li><strong>Xcode</strong> æŸ¥åº•å±‚ï¼›</li>
<li><strong>Safari</strong> æŸ¥JSå±‚ï¼›</li>
<li><strong>KeyMob</strong> æŸ¥ç³»ç»Ÿçº§ï¼›</li>
<li><strong>Firebase</strong> æŸ¥ç”¨æˆ·ç«¯ã€‚</li>
</ul>
<p>è·¨ç«¯æ¶æ„çš„å¤æ‚æ€§ï¼Œéœ€è¦å¤šå·¥å…·çš„ååŒã€‚åªæœ‰åœ¨â€œæ•°æ®é©±åŠ¨â€çš„ç›‘æ§ä½“ç³»ä¸‹ï¼Œuni-app çš„æ€§èƒ½ä¼˜åŒ–æ‰èƒ½çœŸæ­£è½åœ°ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»nginxè§’åº¦çœ‹æ•°æ®è¯»å†™ï¼Œé˜»å¡å’Œéé˜»å¡]]></title>    <link>https://juejin.cn/post/7570598043298365503</link>    <guid>https://juejin.cn/post/7570598043298365503</guid>    <pubDate>2025-11-10T08:43:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570598043298365503" data-draft-id="7570534000718626879" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»nginxè§’åº¦çœ‹æ•°æ®è¯»å†™ï¼Œé˜»å¡å’Œéé˜»å¡"/> <meta itemprop="keywords" content="Nginx,Cè¯­è¨€,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2025-11-10T08:43:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="jzhwolp"/> <meta itemprop="url" content="https://juejin.cn/user/3444121799235879"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»nginxè§’åº¦çœ‹æ•°æ®è¯»å†™ï¼Œé˜»å¡å’Œéé˜»å¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3444121799235879/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    jzhwolp
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T08:43:47.000Z" title="Mon Nov 10 2025 08:43:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">nginx ä¸­çš„read å’Œrecv å‡½æ•°</h2>
<h3 data-id="heading-1">å‰è¨€</h3>
<p>åœ¨ Nginx çš„é«˜æ€§èƒ½äº‹ä»¶é©±åŠ¨æ¶æ„ä¸­ï¼ŒI/O å¤„ç†æ˜¯æ€§èƒ½çš„æ ¸å¿ƒç¯èŠ‚ã€‚ å…¶ä¸­ï¼Œread ä¸ recv æ˜¯æœ€åŸºç¡€çš„ä¸¤ä¸ªç³»ç»Ÿè°ƒç”¨æ¥å£ï¼Œç”¨äºä»å¥—æ¥å­—ä¸­è¯»å–æ•°æ®ã€‚ ä½†åœ¨ Nginx ä¸­ï¼Œå®ƒä»¬å¹¶éç®€å•åœ°ç›´æ¥è°ƒç”¨å†…æ ¸å‡½æ•°ï¼Œè€Œæ˜¯ç»è¿‡ä¸€å±‚æŠ½è±¡å’Œäº‹ä»¶æœºåˆ¶å°è£…ï¼Œå½¢æˆä¸€å¥—é«˜æ•ˆã€å¯æ‰©å±•çš„ I/O æ¨¡å‹ã€‚ æœ¬æ–‡å°†ä» Linux ç³»ç»Ÿè°ƒç”¨å¼€å§‹ï¼Œå±‚å±‚å‰–æ Nginx çš„è¯»å–è·¯å¾„ï¼Œä»åº•å±‚ recv() åˆ°å°è£…çš„ ngx_unix_recv()ï¼Œå†åˆ°äº‹ä»¶è§¦å‘æœºåˆ¶çš„äº¤äº’ï¼Œå¸®ä½ å½»åº•ç†è§£ Nginx çš„ç½‘ç»œ I/O æ ¸å¿ƒã€‚</p>
<h3 data-id="heading-2">Linux ä¸­çš„ read å’Œ recv</h3>
<p>åœ¨ Linux ä¸‹ï¼Œread() ä¸ recv() éƒ½å¯ä»¥ä»å¥—æ¥å­—è¯»å–æ•°æ®ã€‚</p>
<p>read() æ˜¯é€šç”¨æ–‡ä»¶è¯»å–æ¥å£ï¼›</p>
<p>recv() ä¸“é—¨ä¸º socket é€šä¿¡è®¾è®¡ï¼Œæä¾›æ›´å¤šé€‰é¡¹ï¼ˆå¦‚ MSG_PEEKã€MSG_DONTWAITï¼‰ã€‚</p>
<p>äºŒè€…è°ƒç”¨è·¯å¾„å‡ ä¹ç›¸åŒï¼ŒåŒºåˆ«åœ¨äºè¯­ä¹‰ï¼š</p>






























<table><thead><tr><th>å‡½æ•°</th><th>ç”¨é€”</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td><code>read(fd, buf, size)</code></td><td>é€šç”¨æ–‡ä»¶è¯»å–</td><td>é˜»å¡ç›´åˆ°æœ‰æ•°æ®</td></tr><tr><td><code>recv(fd, buf, size, flags)</code></td><td>å¥—æ¥å­—è¯»å–</td><td>æ”¯æŒéé˜»å¡ä¸æ›´å¤šæ§åˆ¶é€‰é¡¹</td></tr><tr><td><code>recvfrom()</code></td><td>æ”¯æŒ UDP åœ°å€ä¿¡æ¯</td><td/></tr><tr><td><code>recvmsg()</code></td><td>æ”¯æŒå¤šç¼“å†²åŒºå’Œæ§åˆ¶æ¶ˆæ¯</td><td/></tr></tbody></table>
<p>åœ¨ Nginx çš„å®ç°ä¸­ï¼Œä¸ºäº†å…¼å®¹å„ç§ç³»ç»Ÿå¹³å°ä¸ I/O æ¨¡å¼ï¼Œå†…éƒ¨ç»Ÿä¸€é€šè¿‡ä¸€ä¸ªå°è£…å±‚è°ƒç”¨ recv()å’Œ send()ã€‚</p>
<h4 data-id="heading-3">manæ‰‹å†Œä¸­å¯¹äºrecvçš„æè¿°</h4>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-keyword">RETURN</span> VALUE Â  Â  Â  Â  top
 Â  Â  Â  These calls <span class="hljs-keyword">return</span> the number <span class="hljs-keyword">of</span> bytes received, <span class="hljs-built_in">or</span> -<span class="hljs-number">1</span> <span class="hljs-keyword">if</span> an <span class="hljs-keyword">error</span>
 Â  Â  Â  occurred.  <span class="hljs-keyword">In</span> the <span class="hljs-keyword">event</span> <span class="hljs-keyword">of</span> an <span class="hljs-keyword">error</span>, errno <span class="hljs-built_in">is</span> <span class="hljs-keyword">set</span> <span class="hljs-keyword">to</span> indicate the
 Â  Â  Â  <span class="hljs-keyword">error</span>.
â€‹
 Â  Â  Â  <span class="hljs-keyword">When</span> a stream socket peer has performed an orderly shutdown, the
 Â  Â  Â  <span class="hljs-keyword">return</span> value will be <span class="hljs-number">0</span> (the traditional <span class="hljs-string">"end-of-file"</span> <span class="hljs-keyword">return</span>).
â€‹
 Â  Â  Â  Datagram sockets <span class="hljs-keyword">in</span> various domains (e.g., the UNIX <span class="hljs-built_in">and</span> Internet
 Â  Â  Â  domains) permit zero-size datagrams.  <span class="hljs-keyword">When</span> such a datagram <span class="hljs-built_in">is</span>
 Â  Â  Â  received, the <span class="hljs-keyword">return</span> value <span class="hljs-built_in">is</span> <span class="hljs-number">0</span>.
â€‹
 Â  Â  Â  The value <span class="hljs-number">0</span> may also be returned <span class="hljs-keyword">if</span> the requested number <span class="hljs-keyword">of</span> bytes
 Â  Â  Â  <span class="hljs-keyword">to</span> receive <span class="hljs-keyword">from</span> a stream socket was <span class="hljs-number">0</span>.
â€‹
ERRORS Â  Â  Â  Â  top
 Â  Â  Â  These are some standard errors generated <span class="hljs-keyword">by</span> the socket layer.
 Â  Â  Â  Additional errors may be generated <span class="hljs-built_in">and</span> returned <span class="hljs-keyword">from</span> the
 Â  Â  Â  underlying protocol modules; see their manual pages.
â€‹
 Â  Â  Â  EAGAIN <span class="hljs-built_in">or</span> EWOULDBLOCK
 Â  Â  Â  Â  Â  Â   The socket <span class="hljs-built_in">is</span> marked nonblocking <span class="hljs-built_in">and</span> the receive operation
 Â  Â  Â  Â  Â  Â   would block, <span class="hljs-built_in">or</span> a receive timeout had been <span class="hljs-keyword">set</span> <span class="hljs-built_in">and</span> the
 Â  Â  Â  Â  Â  Â   timeout expired before data was received.  POSIX.<span class="hljs-number">1</span> allows
 Â  Â  Â  Â  Â  Â   either <span class="hljs-keyword">error</span> <span class="hljs-keyword">to</span> be returned <span class="hljs-keyword">for</span> this <span class="hljs-keyword">case</span>, <span class="hljs-built_in">and</span> does <span class="hljs-built_in">not</span>
 Â  Â  Â  Â  Â  Â   require these constants <span class="hljs-keyword">to</span> have the same value, so a
 Â  Â  Â  Â  Â  Â   portable application should check <span class="hljs-keyword">for</span> both possibilities.
â€‹
 Â  Â  Â  EBADF  The argument sockfd <span class="hljs-built_in">is</span> an invalid file descriptor.
â€‹
 Â  Â  Â  ECONNREFUSED
 Â  Â  Â  Â  Â  Â   A remote host refused <span class="hljs-keyword">to</span> allow the network connection
 Â  Â  Â  Â  Â  Â   (typically because it <span class="hljs-built_in">is</span> <span class="hljs-built_in">not</span> running the requested
 Â  Â  Â  Â  Â  Â  Â service).
â€‹
 Â  Â  Â  EFAULT The receive buffer pointer(s) point outside the process<span class="hljs-comment">'s</span>
 Â  Â  Â  Â  Â  Â   address space.
â€‹
 Â  Â  Â  EINTR  The receive was interrupted <span class="hljs-keyword">by</span> delivery <span class="hljs-keyword">of</span> a signal before
 Â  Â  Â  Â  Â  Â   any data was available; see signal(<span class="hljs-number">7</span>).
â€‹
 Â  Â  Â  EINVAL Invalid argument passed.
â€‹
 Â  Â  Â  ENOMEM Could <span class="hljs-built_in">not</span> allocate memory <span class="hljs-keyword">for</span> recvmsg().
â€‹
 Â  Â  Â  ENOTCONN
 Â  Â  Â  Â  Â  Â   The socket <span class="hljs-built_in">is</span> associated <span class="hljs-keyword">with</span> a connection-oriented
 Â  Â  Â  Â  Â  Â   protocol <span class="hljs-built_in">and</span> has <span class="hljs-built_in">not</span> been connected (see connect(<span class="hljs-number">2</span>) <span class="hljs-built_in">and</span>
 Â  Â  Â  Â  Â  Â   accept(<span class="hljs-number">2</span>)).
â€‹
 Â  Â  Â  ENOTSOCK
 Â  Â  Â  Â  Â  Â   The file descriptor sockfd does <span class="hljs-built_in">not</span> refer <span class="hljs-keyword">to</span> a socket.
â€‹
</code></pre>
<h4 data-id="heading-4">man æ‰‹å†Œå¯¹äº send çš„æè¿°</h4>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-keyword">RETURN</span> VALUE Â  Â  Â  Â  top
 Â  Â  Â  <span class="hljs-keyword">On</span> success, these calls <span class="hljs-keyword">return</span> the number <span class="hljs-keyword">of</span> bytes sent.  <span class="hljs-keyword">On</span>
 Â  Â  Â  <span class="hljs-keyword">error</span>, -<span class="hljs-number">1</span> <span class="hljs-built_in">is</span> returned, <span class="hljs-built_in">and</span> errno <span class="hljs-built_in">is</span> <span class="hljs-keyword">set</span> <span class="hljs-keyword">to</span> indicate the <span class="hljs-keyword">error</span>.
ERRORS Â  Â  Â  Â  top
 Â  Â  Â  These are some standard errors generated <span class="hljs-keyword">by</span> the socket layer.
 Â  Â  Â  Additional errors may be generated <span class="hljs-built_in">and</span> returned <span class="hljs-keyword">from</span> the
 Â  Â  Â  underlying protocol modules; see their respective manual pages.
â€‹
 Â  Â  Â  EACCES (<span class="hljs-keyword">For</span> UNIX domain sockets, which are identified <span class="hljs-keyword">by</span> pathname)
 Â  Â  Â  Â  Â  Â   Write permission <span class="hljs-built_in">is</span> denied <span class="hljs-keyword">on</span> the destination socket file,
 Â  Â  Â  Â  Â  Â   <span class="hljs-built_in">or</span> search permission <span class="hljs-built_in">is</span> denied <span class="hljs-keyword">for</span> one <span class="hljs-keyword">of</span> the directories
 Â  Â  Â  Â  Â  Â   the path prefix.  (See path_resolution(<span class="hljs-number">7</span>).)
â€‹
 Â  Â  Â  Â  Â  Â   (<span class="hljs-keyword">For</span> UDP sockets) An attempt was made <span class="hljs-keyword">to</span> send <span class="hljs-keyword">to</span> a
 Â  Â  Â  Â  Â  Â   network/broadcast address <span class="hljs-keyword">as</span> though it was a unicast
 Â  Â  Â  Â  Â  Â   address.
â€‹
 Â  Â  Â  EAGAIN <span class="hljs-built_in">or</span> EWOULDBLOCK
 Â  Â  Â  Â  Â  Â   The socket <span class="hljs-built_in">is</span> marked nonblocking <span class="hljs-built_in">and</span> the requested
 Â  Â  Â  Â  Â  Â   operation would block.  POSIX.<span class="hljs-number">1</span>-<span class="hljs-number">2001</span> allows either <span class="hljs-keyword">error</span> <span class="hljs-keyword">to</span>
 Â  Â  Â  Â  Â  Â   be returned <span class="hljs-keyword">for</span> this <span class="hljs-keyword">case</span>, <span class="hljs-built_in">and</span> does <span class="hljs-built_in">not</span> require these
 Â  Â  Â  Â  Â  Â   constants <span class="hljs-keyword">to</span> have the same value, so a portable application
 Â  Â  Â  Â  Â  Â   should check <span class="hljs-keyword">for</span> both possibilities.
â€‹
 Â  Â  Â  EAGAIN (Internet domain datagram sockets) The socket referred <span class="hljs-keyword">to</span>
 Â  Â  Â  Â  Â  Â   <span class="hljs-keyword">by</span> sockfd had <span class="hljs-built_in">not</span> previously been bound <span class="hljs-keyword">to</span> an address <span class="hljs-built_in">and</span>,
 Â  Â  Â  Â  Â  Â   upon attempting <span class="hljs-keyword">to</span> bind it <span class="hljs-keyword">to</span> an ephemeral port, it was
 Â  Â  Â  Â  Â  Â   determined that all port numbers <span class="hljs-keyword">in</span> the ephemeral port
 Â  Â  Â  Â  Â  Â   range are currently <span class="hljs-keyword">in</span> use.  See the discussion <span class="hljs-keyword">of</span>
 Â  Â  Â  Â  Â  Â   /proc/sys/net/ipv4/ip_local_port_range <span class="hljs-keyword">in</span> ip(<span class="hljs-number">7</span>).
â€‹
 Â  Â  Â  EALREADY
 Â  Â  Â  Â  Â  Â   Another Fast Open <span class="hljs-built_in">is</span> <span class="hljs-keyword">in</span> progress.
â€‹
 Â  Â  Â  EBADF  sockfd <span class="hljs-built_in">is</span> <span class="hljs-built_in">not</span> a valid open file descriptor.
â€‹
 Â  Â  Â  ECONNRESET
 Â  Â  Â  Â  Â  Â   Connection reset <span class="hljs-keyword">by</span> peer.
â€‹
 Â  Â  Â  EDESTADDRREQ
 Â  Â  Â  Â  Â  Â   The socket <span class="hljs-built_in">is</span> <span class="hljs-built_in">not</span> connection-mode, <span class="hljs-built_in">and</span> no peer address <span class="hljs-built_in">is</span>
 Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">set</span>.
â€‹
 Â  Â  Â  EFAULT An invalid user space address was specified <span class="hljs-keyword">for</span> an
 Â  Â  Â  Â  Â  Â   argument.
â€‹
 Â  Â  Â  EINTR  A signal occurred before any data was transmitted; see
 Â  Â  Â  Â  Â  Â   signal(<span class="hljs-number">7</span>).
â€‹
 Â  Â  Â  EINVAL Invalid argument passed.
â€‹
 Â  Â  Â  EISCONN
 Â  Â  Â  Â  Â  Â   The connection-mode socket was connected already but a
 Â  Â  Â  Â  Â  Â   recipient was specified.  (Now either this <span class="hljs-keyword">error</span> <span class="hljs-built_in">is</span>
 Â  Â  Â  Â  Â  Â   returned, <span class="hljs-built_in">or</span> the recipient specification <span class="hljs-built_in">is</span> ignored.)
â€‹
 Â  Â  Â  EMSGSIZE
 Â  Â  Â  Â  Â  Â   The socket type requires that message be sent atomically,
 Â  Â  Â  Â  Â  Â   <span class="hljs-built_in">and</span> the size <span class="hljs-keyword">of</span> the message <span class="hljs-keyword">to</span> be sent made this
 Â  Â  Â  Â  Â  Â   impossible.
â€‹
 Â  Â  Â  ENOBUFS
 Â  Â  Â  Â  Â  Â   The output queue <span class="hljs-keyword">for</span> a network <span class="hljs-keyword">interface</span> was full.  This
 Â  Â  Â  Â  Â  Â   generally indicates that the <span class="hljs-keyword">interface</span> has stopped sending,
 Â  Â  Â  Â  Â  Â   but may be caused <span class="hljs-keyword">by</span> transient congestion.  (Normally, this
 Â  Â  Â  Â  Â  Â   does <span class="hljs-built_in">not</span> occur <span class="hljs-keyword">in</span> Linux.  Packets are just silently dropped
 Â  Â  Â  Â  Â  Â   <span class="hljs-keyword">when</span> a device queue overflows.)
â€‹
 Â  Â  Â  ENOMEM No memory available.
â€‹
 Â  Â  Â  ENOTCONN
 Â  Â  Â  Â  Â  Â   The socket <span class="hljs-built_in">is</span> <span class="hljs-built_in">not</span> connected, <span class="hljs-built_in">and</span> no target has been given.
â€‹
 Â  Â  Â  ENOTSOCK
 Â  Â  Â  Â  Â  Â   The file descriptor sockfd does <span class="hljs-built_in">not</span> refer <span class="hljs-keyword">to</span> a socket.
â€‹
 Â  Â  Â  EOPNOTSUPP
 Â  Â  Â  Â  Â  Â   Some bit <span class="hljs-keyword">in</span> the flags argument <span class="hljs-built_in">is</span> inappropriate <span class="hljs-keyword">for</span> the
 Â  Â  Â  Â  Â  Â   socket type.
â€‹
 Â  Â  Â  EPIPE  The local <span class="hljs-keyword">end</span> has been shut down <span class="hljs-keyword">on</span> a connection oriented
 Â  Â  Â  Â  Â  Â   socket.  <span class="hljs-keyword">In</span> this <span class="hljs-keyword">case</span>, the process will also receive a
 Â  Â  Â  Â  Â  Â   SIGPIPE unless MSG_NOSIGNAL <span class="hljs-built_in">is</span> <span class="hljs-keyword">set</span>.
</code></pre>
<h4 data-id="heading-5">æ€»ç»“</h4>
<p><code>recv()</code> å’Œ <code>send()</code> éƒ½æ˜¯ TCP/UDP å¥—æ¥å­—çš„åŸºç¡€ I/O è°ƒç”¨ï¼šå®ƒä»¬åˆ†åˆ«ç”¨äºæ¥æ”¶ä¸å‘é€æ•°æ®ï¼ŒæˆåŠŸæ—¶è¿”å›ä¼ è¾“çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥æ—¶è¿”å› -1 å¹¶è®¾ç½® <code>errno</code> æŒ‡ç¤ºé”™è¯¯åŸå› ã€‚</p>
<p>åœ¨æµå¼å¥—æ¥å­—ï¼ˆTCPï¼‰ä¸­ï¼Œ<code>recv()</code> è¿”å› <code>0</code> è¡¨ç¤ºå¯¹ç«¯æ‰§è¡Œäº†æœ‰åºå…³é—­ï¼ˆEOFï¼‰ï¼›<code>send()</code> è¿”å› <code>-1</code> ä¸” <code>errno=EPIPE</code> åˆ™è¡¨ç¤ºæœ¬ç«¯å‘å·²å…³é—­è¿æ¥å‘é€æ•°æ®ã€‚è‹¥å¥—æ¥å­—ä¸ºéé˜»å¡æ¨¡å¼ï¼Œ<code>recv()</code> æˆ– <code>send()</code> åœ¨æ•°æ®æš‚ä¸å¯ç”¨æ—¶ä¼šè¿”å› <code>-1</code> å¹¶è®¾ç½® <code>errno=EAGAIN</code> æˆ– <code>EWOULDBLOCK</code>ï¼Œæç¤ºè°ƒç”¨è€…ç¨åé‡è¯•ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¸¸è§é”™è¯¯è¿˜åŒ…æ‹¬ <code>EINTR</code>ï¼ˆä¿¡å·ä¸­æ–­ï¼‰ã€<code>ENOTCONN</code>ï¼ˆæœªå»ºç«‹è¿æ¥ï¼‰å’Œ <code>ECONNRESET</code>ï¼ˆè¿æ¥è¢«å¯¹ç«¯é‡ç½®ï¼‰ã€‚</p>
<p>ä¸€å¥è¯æ¦‚æ‹¬ï¼š</p>
<blockquote>
<p><strong><code>recv()</code> è¯»ä¸åˆ°æ•°æ®æˆ–è¿æ¥å…³é—­è¿”å› 0 æˆ– EAGAINï¼Œ<code>send()</code> å‘ä¸å‡ºå»æˆ–è¿æ¥æ–­å¼€è¿”å› -1 å¹¶ç½® errnoï¼›ä¸¤è€…çš„æ ¸å¿ƒéƒ½æ˜¯â€œæˆåŠŸè¿”å›å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› -1 å¹¶æŠ¥å‘Šé”™è¯¯â€ã€‚</strong></p>
</blockquote>
<h3 data-id="heading-6">Nginxä¸­ Recv çš„å°è£…</h3>
<p>é¦–å…ˆå¯¹äº nginx ä¸­çš„æ–‡ä»¶æè¿°ç¬¦æ¥è¯´ï¼Œä»–ä»¬éƒ½æ˜¯éé˜»å¡çš„</p>
<p>æºç ä½ç½®ï¼š<code>src/os/unix/ngx_recv.c</code></p>
<pre><code class="hljs language-ini" lang="ini">ssize_t ngx_unix_recv(ngx_connection_t* c, u_char* buf, size_t size) {
 Â  Â ssize_t n<span class="hljs-comment">;</span>
 Â  Â ngx_err_t err<span class="hljs-comment">;</span>
 Â  Â ngx_event_t* rev<span class="hljs-comment">;</span>
â€‹
 Â  Â <span class="hljs-attr">rev</span> = c-&gt;read<span class="hljs-comment">;</span>
â€‹
 Â  Â do {
 Â  Â  Â  Â <span class="hljs-attr">n</span> = recv(c-&gt;fd, buf, size, <span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
â€‹
 Â  Â  Â  Â ngx_log_debug3(NGX_LOG_DEBUG_EVENT, c-&gt;log, 0, "recv: fd:%d %z of %uz", c-&gt;fd, n, size)<span class="hljs-comment">;</span>
â€‹
 Â  Â  Â  Â if (<span class="hljs-attr">n</span> == <span class="hljs-number">0</span>) {
 Â  Â  Â  Â  Â  Â rev-&gt;<span class="hljs-attr">ready</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â rev-&gt;<span class="hljs-attr">eof</span> = <span class="hljs-number">1</span><span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â return 0<span class="hljs-comment">;</span>
 Â  Â  Â   }
â€‹
 Â  Â  Â  Â if (n &gt; 0) {
 Â  Â  Â  Â  Â  Â if ((size_t) n &lt; size &amp;&amp; !(ngx_event_flags &amp; NGX_USE_GREEDY_EVENT)) {
 Â  Â  Â  Â  Â  Â  Â  Â rev-&gt;<span class="hljs-attr">ready</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   }
â€‹
 Â  Â  Â  Â  Â  Â return n<span class="hljs-comment">;</span>
 Â  Â  Â   }
â€‹
 Â  Â  Â  Â <span class="hljs-attr">err</span> = ngx_socket_err<span class="hljs-literal">no</span><span class="hljs-comment">;</span>
â€‹
 Â  Â  Â  Â if (<span class="hljs-attr">err</span> == NGX_EAGAIN || err == NGX_EINTR) {
 Â  Â  Â  Â  Â  Â ngx_log_debug0(NGX_LOG_DEBUG_EVENT, c-&gt;log, err, "recv() not ready")<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">n</span> = NGX_AGAIN<span class="hljs-comment">;</span>
â€‹
 Â  Â  Â   } else {
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">n</span> = ngx_connection_error(c, err, <span class="hljs-string">"recv() failed"</span>)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â break<span class="hljs-comment">;</span>
 Â  Â  Â   }
â€‹
 Â   } while (<span class="hljs-attr">err</span> == NGX_EINTR)<span class="hljs-comment">;</span>
â€‹
 Â  Â rev-&gt;<span class="hljs-attr">ready</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
â€‹
 Â  Â if (<span class="hljs-attr">n</span> == NGX_ERROR) {
 Â  Â  Â  Â rev-&gt;<span class="hljs-attr">error</span> = <span class="hljs-number">1</span><span class="hljs-comment">;</span>
 Â   }
â€‹
 Â  Â return n<span class="hljs-comment">;</span>
}
</code></pre>
<p>å’±ä»¬åªçœ‹ n &lt; 0 çš„æƒ…å†µï¼š</p>
<p>ğŸ”¸ æƒ…å†µä¸€ï¼š<code>EAGAIN</code> / <code>EWOULDBLOCK</code></p>
<p>è¡¨ç¤ºå½“å‰æ²¡æœ‰æ•°æ®å¯è¯»ï¼ˆéé˜»å¡æ¨¡å¼ä¸‹å¾ˆå¸¸è§ï¼‰ã€‚</p>
<ul>
<li>è®¾ç½® <code>n = NGX_AGAIN</code></li>
<li>è¡¨ç¤ºâ€œæš‚æ—¶æ²¡æœ‰æ•°æ®â€ï¼Œä¸Šå±‚ä¸ä¼šå…³é—­è¿æ¥ï¼Œè€Œæ˜¯é‡æ–°æ³¨å†Œäº‹ä»¶ç­‰å¾…ã€‚</li>
</ul>
<p>ğŸ”¸ æƒ…å†µäºŒï¼š<code>EINTR</code></p>
<p>è¡¨ç¤ºè¢«ä¿¡å·ä¸­æ–­ï¼ˆå¦‚æ¥æ”¶åˆ° <code>SIGCHLD</code>ï¼‰ã€‚</p>
<p>Nginx ä¼šåœ¨ <code>do...while (err == NGX_EINTR)</code> ä¸­ <strong>é‡è¯•ä¸€æ¬¡</strong></p>
<p>ğŸ”¸ æƒ…å†µä¸‰ï¼šå…¶ä»–é”™è¯¯</p>
<p>å¦‚ï¼š</p>
<ul>
<li><code>ECONNRESET</code>ï¼ˆè¿æ¥è¢«é‡ç½®ï¼‰</li>
<li><code>EBADF</code>ï¼ˆæ— æ•ˆçš„æ–‡ä»¶æè¿°ç¬¦ï¼‰</li>
<li><code>EPIPE</code>ï¼ˆå†™å…¥å·²å…³é—­è¿æ¥ï¼‰</li>
</ul>
<h4 data-id="heading-7">è¡Œä¸ºæ€»ç»“</h4>





















































<table><thead><tr><th>åœºæ™¯</th><th>è¿”å›å€¼</th><th>rev-&gt;ready</th><th>rev-&gt;eof</th><th>rev-&gt;error</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>æˆåŠŸè¯»åˆ° n å­—èŠ‚</td><td>n &gt; 0</td><td>å¯èƒ½ç½® 0</td><td>0</td><td>0</td><td>è¯»åˆ°æ•°æ®</td></tr><tr><td>å®¢æˆ·ç«¯å…³é—­è¿æ¥</td><td>0</td><td>0</td><td>1</td><td>0</td><td>EOF</td></tr><tr><td>æ²¡æ•°æ®ï¼ˆEAGAINï¼‰</td><td>NGX_AGAIN</td><td>0</td><td>0</td><td>0</td><td>ç¨åå†è¯»</td></tr><tr><td>ä¿¡å·ä¸­æ–­ï¼ˆEINTRï¼‰</td><td>é‡è¯•</td><td>-</td><td>-</td><td>-</td><td>é‡è¯•</td></tr><tr><td>å…¶ä»–é”™è¯¯</td><td>NGX_ERROR</td><td>0</td><td>0</td><td>1</td><td>è¿æ¥é”™è¯¯</td></tr></tbody></table>
<h3 data-id="heading-8">Nginxä¸­ Send çš„å°è£…</h3>
<p>æºç ä½ç½®ï¼š<code>src/os/unix/ngx_send.c</code></p>
<pre><code class="hljs language-ini" lang="ini">ssize_t ngx_unix_send(ngx_connection_t* c, u_char* buf, size_t size) {
 Â  Â ssize_t n<span class="hljs-comment">;</span>
 Â  Â ngx_err_t err<span class="hljs-comment">;</span>
 Â  Â ngx_event_t* wev<span class="hljs-comment">;</span>
â€‹
 Â  Â <span class="hljs-attr">wev</span> = c-&gt;write<span class="hljs-comment">;</span>
â€‹
 Â  Â for (<span class="hljs-comment">;;) {</span>
 Â  Â  Â  Â <span class="hljs-attr">n</span> = send(c-&gt;fd, buf, size, <span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
â€‹
 Â  Â  Â  Â ngx_log_debug3(NGX_LOG_DEBUG_EVENT, c-&gt;log, 0, "send: fd:%d %z of %uz", c-&gt;fd, n, size)<span class="hljs-comment">;</span>
â€‹
 Â  Â  Â  Â if (n &gt; 0) {
 Â  Â  Â  Â  Â  Â if (n &lt; (ssize_t) size) {
 Â  Â  Â  Â  Â  Â  Â  Â wev-&gt;<span class="hljs-attr">ready</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   }
â€‹
 Â  Â  Â  Â  Â  Â c-&gt;sent += n<span class="hljs-comment">;</span>
â€‹
 Â  Â  Â  Â  Â  Â return n<span class="hljs-comment">;</span>
 Â  Â  Â   }
â€‹
 Â  Â  Â  Â <span class="hljs-attr">err</span> = ngx_socket_err<span class="hljs-literal">no</span><span class="hljs-comment">;</span>
â€‹
 Â  Â  Â  Â if (<span class="hljs-attr">n</span> == <span class="hljs-number">0</span>) {
 Â  Â  Â  Â  Â  Â ngx_log_error(NGX_LOG_ALERT, c-&gt;log, err, "send() returned zero")<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â wev-&gt;<span class="hljs-attr">ready</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â return n<span class="hljs-comment">;</span>
 Â  Â  Â   }
â€‹
 Â  Â  Â  Â if (<span class="hljs-attr">err</span> == NGX_EAGAIN || err == NGX_EINTR) {
 Â  Â  Â  Â  Â  Â wev-&gt;<span class="hljs-attr">ready</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
â€‹
 Â  Â  Â  Â  Â  Â ngx_log_debug0(NGX_LOG_DEBUG_EVENT, c-&gt;log, err, "send() not ready")<span class="hljs-comment">;</span>
â€‹
 Â  Â  Â  Â  Â  Â if (<span class="hljs-attr">err</span> == NGX_EAGAIN) {
 Â  Â  Â  Â  Â  Â  Â  Â return NGX_AGAIN<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   }
â€‹
 Â  Â  Â   } else {
 Â  Â  Â  Â  Â  Â wev-&gt;<span class="hljs-attr">error</span> = <span class="hljs-number">1</span><span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   (void) ngx_connection_error(c, err, "send() failed")<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â return NGX_ERROR<span class="hljs-comment">;</span>
 Â  Â  Â   }
 Â   }
}
</code></pre>









































<table><thead><tr><th>è¿”å›å€¼</th><th>å«ä¹‰</th><th>å…¸å‹åŸå› /åœºæ™¯</th><th>Nginx ä¸­çš„å¤„ç†</th></tr></thead><tbody><tr><td><strong>&gt; 0</strong></td><td>æˆåŠŸå‘é€çš„å­—èŠ‚æ•°</td><td>å‘é€æˆåŠŸï¼Œå¯èƒ½éƒ¨åˆ†å‘é€</td><td>æ›´æ–° <code>c-&gt;sent</code>ï¼›è‹¥æœªå…¨éƒ¨å‘é€ (<code>n &lt; len</code>)ï¼Œæ ‡è®° <code>wev-&gt;ready = 0</code></td></tr><tr><td><strong>= 0</strong></td><td>ä¸€èˆ¬è¡¨ç¤ºå¯¹ç«¯å…³é—­æˆ–å¼‚å¸¸</td><td>å¯¹ç«¯å…³é—­è¿æ¥ï¼Œæˆ–åº•å±‚ç¼“å†²å¼‚å¸¸</td><td>è®°å½•æ—¥å¿— <code>"send() returned zero"</code>ï¼Œè®¾ç½® <code>wev-&gt;ready = 0</code></td></tr><tr><td><strong>= -1, errno = EAGAIN</strong></td><td>éé˜»å¡ socket å½“å‰ä¸å¯å†™</td><td>å†…æ ¸å‘é€ç¼“å†²åŒºå·²æ»¡</td><td>è¿”å› <code>NGX_AGAIN</code>ï¼Œç­‰å¾… epoll å¯å†™äº‹ä»¶</td></tr><tr><td><strong>= -1, errno = EINTR</strong></td><td>è¢«ä¿¡å·ä¸­æ–­</td><td>ä¿¡å·ä¸­æ–­ç³»ç»Ÿè°ƒç”¨</td><td>é‡è¯•å‘é€ï¼ˆç»§ç»­ for å¾ªç¯ï¼‰</td></tr><tr><td><strong>= -1, å…¶ä»– errno</strong></td><td>çœŸæ­£çš„å‘é€é”™è¯¯</td><td>è¿æ¥ä¸­æ–­ã€ç½‘ç»œé”™è¯¯ç­‰</td><td>æ ‡è®° <code>wev-&gt;error = 1</code>ï¼Œè°ƒç”¨ <code>ngx_connection_error()</code>ï¼Œè¿”å› <code>NGX_ERROR</code></td></tr></tbody></table>
<h3 data-id="heading-9">æ€»ç»“</h3>
<p>å½“ recv() æˆ– send() è¿”å› EAGAIN æ—¶ï¼Œè¡¨ç¤ºå½“å‰å¥—æ¥å­—æš‚æ—¶ä¸å¯è¯»æˆ–ä¸å¯å†™ï¼Œè¿™åœ¨éé˜»å¡æ¨¡å¼ä¸‹æ˜¯æ­£å¸¸æƒ…å†µã€‚ Nginx çš„å¤„ç†é€»è¾‘æ˜¯ï¼š</p>
<ol start="0">
<li>æ ‡è®°äº‹ä»¶æœªå°±ç»ªï¼ˆrev-&gt;ready = 0 æˆ– wev-&gt;ready = 0ï¼‰ï¼Œè¡¨ç¤ºå½“å‰è¿æ¥æš‚æ—¶ä¸èƒ½ç»§ç»­è¯»/å†™ã€‚</li>
<li>ä¸ç«‹å³é‡è¯•ç³»ç»Ÿè°ƒç”¨ï¼Œè€Œæ˜¯è¿”å› NGX_AGAINï¼Œè®©ä¸Šå±‚é€»è¾‘ï¼ˆå¦‚ HTTP æ¨¡å—æˆ–äº‹ä»¶å¾ªç¯ï¼‰çŸ¥é“éœ€è¦ç­‰å¾…ä¸‹ä¸€æ¬¡äº‹ä»¶è§¦å‘ã€‚</li>
<li>äº‹ä»¶æ¨¡å—ï¼ˆå¦‚ epollï¼‰ä¼šç»§ç»­ç›‘å¬è¯¥ fd çš„å¯è¯»/å¯å†™äº‹ä»¶ï¼›å½“å†…æ ¸é€šçŸ¥å…¶å¯è¯»/å¯å†™æ—¶ï¼ŒNginx å†æ¬¡è°ƒç”¨ recv() æˆ– send() å°è¯•ç»§ç»­æ“ä½œã€‚</li>
</ol>
<p>ä¸€å¥è¯æ€»ç»“ï¼š</p>
<blockquote>
<p>EAGAIN ä¸æ˜¯é”™è¯¯ï¼Œè€Œæ˜¯â€œæš‚æ—¶æ²¡å‡†å¤‡å¥½â€ï¼›Nginx ä¼šæŒ‚èµ·è¯¥è¿æ¥ï¼Œç­‰äº‹ä»¶å°±ç»ªåè‡ªåŠ¨é‡è¯•ï¼Œä»è€Œå®ç°éé˜»å¡çš„é«˜å¹¶å‘ I/Oã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android MotionEvent ACTION_OUTSIDE è¯¦ç»†è§£é‡Š]]></title>    <link>https://juejin.cn/post/7570534000718659647</link>    <guid>https://juejin.cn/post/7570534000718659647</guid>    <pubDate>2025-11-10T08:44:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570534000718659647" data-draft-id="7570598043298349119" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android MotionEvent ACTION_OUTSIDE è¯¦ç»†è§£é‡Š"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-11-10T08:44:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="fool_hungry"/> <meta itemprop="url" content="https://juejin.cn/user/1627726667580638"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android MotionEvent ACTION_OUTSIDE è¯¦ç»†è§£é‡Š
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1627726667580638/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    fool_hungry
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T08:44:46.000Z" title="Mon Nov 10 2025 08:44:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">1. ä½œç”¨ä¸å®šä¹‰</h3>
<p><code>ACTION_OUTSIDE</code>Â è¡¨ç¤º<strong>å‘ç”Ÿåœ¨ UI å…ƒç´ æ­£å¸¸è¾¹ç•Œä¹‹å¤–çš„è¿åŠ¨äº‹ä»¶</strong>ã€‚ä¸»è¦ç”¨äºæ£€æµ‹ç”¨æˆ·ç‚¹å‡»äº†åº”ç”¨çª—å£ä¹‹å¤–çš„åŒºåŸŸã€‚</p>
<p><strong>å…³é”®ç‰¹æ€§ï¼š</strong></p>
<ul>
<li>ä¸æä¾›å®Œæ•´æ‰‹åŠ¿ï¼ŒåªåŒ…å«åˆå§‹ä½ç½®</li>
<li>äº‹ä»¶ä½ç½®åœ¨è§†å›¾å±‚æ¬¡ç»“æ„è¾¹ç•Œä¹‹å¤–</li>
<li>é»˜è®¤ä¸ä¼šåˆ†æ´¾ç»™ ViewGroup çš„ä»»ä½•å­è§†å›¾</li>
</ul>
<h3 data-id="heading-1">2. ä½¿ç”¨åœºæ™¯</h3>
<h4 data-id="heading-2">å…¸å‹åº”ç”¨åœºæ™¯ï¼š</h4>
<ul>
<li><strong>å¯¹è¯æ¡†å¤–éƒ¨ç‚¹å‡»å…³é—­</strong></li>
<li><strong>å¼¹å‡ºèœå•å¤–éƒ¨ç‚¹å‡»éšè—</strong></li>
<li><strong>å…¨å±åº”ç”¨æ£€æµ‹è¾¹ç•Œå¤–ç‚¹å‡»</strong></li>
<li><strong>è‡ªå®šä¹‰æ‚¬æµ®çª—å¤„ç†å¤–éƒ¨äº‹ä»¶</strong></li>
</ul>
<h3 data-id="heading-3">3. ä½¿ç”¨æ–¹å¼</h3>
<h4 data-id="heading-4">3.1 åœ¨ Activity ä¸­å¤„ç†</h4>
<pre><code class="hljs language-scala" lang="scala">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Activity</span> </span>{
    
    <span class="hljs-meta">@Override</span>
    public boolean onTouchEvent(<span class="hljs-type">MotionEvent</span> event) {
        <span class="hljs-keyword">if</span> (event.getActionMasked() == <span class="hljs-type">MotionEvent</span>.<span class="hljs-type">ACTION_OUTSIDE</span>) {
            <span class="hljs-comment">// å¤„ç†çª—å£å¤–éƒ¨ç‚¹å‡»</span>
            <span class="hljs-type">Log</span>.d(<span class="hljs-string">"Touch"</span>, <span class="hljs-string">"Clicked outside the window"</span>);
            
            <span class="hljs-comment">// ä¾‹å¦‚ï¼šå…³é—­å¯¹è¯æ¡†æˆ–æ‰§è¡Œå…¶ä»–æ“ä½œ</span>
            handleOutsideClick();
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// è¡¨ç¤ºå·²å¤„ç†è¯¥äº‹ä»¶</span>
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.onTouchEvent(event);
    }
    
    <span class="hljs-keyword">private</span> void handleOutsideClick() {
        <span class="hljs-comment">// æ‰§è¡Œå¤–éƒ¨ç‚¹å‡»çš„é€»è¾‘</span>
    }
}
</code></pre>
<h4 data-id="heading-5">3.2 åœ¨ Dialog ä¸­å¤„ç†</h4>
<pre><code class="hljs language-scala" lang="scala">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomDialog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Dialog</span> </span>{
    
    public <span class="hljs-type">CustomDialog</span>(<span class="hljs-type">Context</span> context) {
        <span class="hljs-keyword">super</span>(context);
        setCanceledOnTouchOutside(<span class="hljs-literal">true</span>); <span class="hljs-comment">// å…è®¸å¤–éƒ¨ç‚¹å‡»å…³é—­</span>
    }
    
    <span class="hljs-meta">@Override</span>
    public boolean onTouchEvent(<span class="hljs-type">MotionEvent</span> event) {
        <span class="hljs-keyword">if</span> (event.getActionMasked() == <span class="hljs-type">MotionEvent</span>.<span class="hljs-type">ACTION_OUTSIDE</span>) {
            <span class="hljs-type">Log</span>.d(<span class="hljs-string">"Dialog"</span>, <span class="hljs-string">"Dialog outside area clicked"</span>);
            <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ è‡ªå®šä¹‰é€»è¾‘</span>
            <span class="hljs-comment">// æ¯”å¦‚è®°å½•æ—¥å¿—ã€å‘é€åˆ†æäº‹ä»¶ç­‰</span>
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.onTouchEvent(event);
    }
}
</code></pre>
<h3 data-id="heading-6">4. å®Œæ•´ç¤ºä¾‹ï¼šè‡ªå®šä¹‰å¼¹å‡ºèœå•</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">PopupMenuExample</span> {
    <span class="hljs-keyword">private</span> PopupWindow popupWindow;
    <span class="hljs-keyword">private</span> Context context;
    <span class="hljs-keyword">private</span> View anchorView;
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">PopupMenuExample</span>(<span class="hljs-params">Context context, View anchor</span>)</span> {
        <span class="hljs-keyword">this</span>.context = context;
        <span class="hljs-keyword">this</span>.anchorView = anchor;
        setupPopupWindow();
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setupPopupWindow</span>()</span> {
        <span class="hljs-comment">// åˆ›å»ºå¼¹å‡ºçª—å£å†…å®¹</span>
        View popupView = LayoutInflater.<span class="hljs-keyword">from</span>(context)
                .inflate(R.layout.popup_layout, <span class="hljs-literal">null</span>);
                
        popupWindow = <span class="hljs-keyword">new</span> PopupWindow(
            popupView,
            ViewGroup.LayoutParams.WRAP_CONTENT,
            ViewGroup.LayoutParams.WRAP_CONTENT,
            <span class="hljs-literal">true</span> <span class="hljs-comment">// focusable å¿…é¡»ä¸º true æ‰èƒ½æ¥æ”¶å¤–éƒ¨ç‚¹å‡»äº‹ä»¶</span>
        );
        
        <span class="hljs-comment">// å…³é”®è®¾ç½®ï¼šå…è®¸å¤–éƒ¨ç‚¹å‡»</span>
        popupWindow.setOutsideTouchable(<span class="hljs-literal">true</span>);
        popupWindow.setBackgroundDrawable(<span class="hljs-keyword">new</span> ColorDrawable(Color.TRANSPARENT));
        
        <span class="hljs-comment">// è®¾ç½®è§¦æ‘¸ç›‘å¬å™¨</span>
        popupWindow.setTouchInterceptor(<span class="hljs-keyword">new</span> View.OnTouchListener() {
            @Override
            <span class="hljs-function"><span class="hljs-keyword">public</span> boolean <span class="hljs-title">onTouch</span>(<span class="hljs-params">View v, MotionEvent <span class="hljs-keyword">event</span></span>)</span> {
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">event</span>.getActionMasked() == MotionEvent.ACTION_OUTSIDE) {
                    Log.d(<span class="hljs-string">"Popup"</span>, <span class="hljs-string">"Clicked outside popup menu"</span>);
                    dismissPopup();
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
                }
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        });
    }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">showPopup</span>()</span> {
        popupWindow.showAsDropDown(anchorView);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dismissPopup</span>()</span> {
        <span class="hljs-keyword">if</span> (popupWindow != <span class="hljs-literal">null</span> &amp;&amp; popupWindow.isShowing()) {
            popupWindow.dismiss();
        }
    }
}
</code></pre>
<h3 data-id="heading-7">5. åœ¨ Window.Callback ä¸­å¤„ç†</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Activity</span> {
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">Bundle savedInstanceState</span>) {
        <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">onCreate</span>(savedInstanceState);
        <span class="hljs-title function_">setContentView</span>(R.<span class="hljs-property">layout</span>.<span class="hljs-property">activity_main</span>);
        
        <span class="hljs-comment">// è®¾ç½®è‡ªå®šä¹‰ Window Callback</span>
        <span class="hljs-title function_">getWindow</span>().<span class="hljs-title function_">setCallback</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomWindowCallback</span>());
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomWindowCallback</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Window</span>.<span class="hljs-property">Callback</span> {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">dispatchTouchEvent</span>(<span class="hljs-params">MotionEvent event</span>) {
            <span class="hljs-keyword">if</span> (event.<span class="hljs-title function_">getActionMasked</span>() == <span class="hljs-title class_">MotionEvent</span>.<span class="hljs-property">ACTION_OUTSIDE</span>) {
                <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">d</span>(<span class="hljs-string">"Window"</span>, <span class="hljs-string">"Window outside touch detected"</span>);
                <span class="hljs-comment">// å¤„ç†çª—å£å¤–éƒ¨è§¦æ‘¸äº‹ä»¶</span>
                <span class="hljs-title function_">onWindowOutsideTouched</span>();
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-title class_">CustomActivity</span>.<span class="hljs-property">super</span>.<span class="hljs-title function_">dispatchTouchEvent</span>(event);
        }
        
        <span class="hljs-comment">// å…¶ä»–å¿…é¡»å®ç°çš„æ–¹æ³•...</span>
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">onTouchEvent</span>(<span class="hljs-params">MotionEvent event</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">onCreatePanelMenu</span>(<span class="hljs-params">int featureId, Menu menu</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-title class_">View</span> <span class="hljs-title function_">onCreatePanelView</span>(<span class="hljs-params">int featureId</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; }
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">onPreparePanel</span>(<span class="hljs-params">int featureId, View view, Menu menu</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">onMenuOpened</span>(<span class="hljs-params">int featureId, Menu menu</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">onMenuItemSelected</span>(<span class="hljs-params">int featureId, MenuItem item</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onWindowAttributesChanged</span>(<span class="hljs-params">WindowManager.LayoutParams attrs</span>) {}
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onContentChanged</span>(<span class="hljs-params"/>) {}
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onWindowFocusChanged</span>(<span class="hljs-params"><span class="hljs-built_in">boolean</span> hasFocus</span>) {}
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onAttachedToWindow</span>(<span class="hljs-params"/>) {}
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onDetachedFromWindow</span>(<span class="hljs-params"/>) {}
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onPanelClosed</span>(<span class="hljs-params">int featureId, Menu menu</span>) {}
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">onSearchRequested</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">onSearchRequested</span>(<span class="hljs-params">android.view.SearchEvent searchEvent</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; }
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> android.<span class="hljs-property">view</span>.<span class="hljs-property">ActionMode</span> <span class="hljs-title function_">onWindowStartingActionMode</span>(<span class="hljs-params">ActionMode.Callback callback</span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; }
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> android.<span class="hljs-property">view</span>.<span class="hljs-property">ActionMode</span> <span class="hljs-title function_">onWindowStartingActionMode</span>(<span class="hljs-params">ActionMode.Callback callback, int <span class="hljs-keyword">type</span></span>) { <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; }
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onActionModeStarted</span>(<span class="hljs-params">ActionMode mode</span>) {}
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onActionModeFinished</span>(<span class="hljs-params">ActionMode mode</span>) {}
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onWindowOutsideTouched</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// å¤„ç†çª—å£å¤–éƒ¨è§¦æ‘¸</span>
        <span class="hljs-title class_">Toast</span>.<span class="hljs-title function_">makeText</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-string">"Clicked outside window"</span>, <span class="hljs-title class_">Toast</span>.<span class="hljs-property">LENGTH_SHORT</span>).<span class="hljs-title function_">show</span>();
    }
}
</code></pre>
<h3 data-id="heading-8">6. é‡è¦æ³¨æ„äº‹é¡¹</h3>
<h4 data-id="heading-9">6.1 äº‹ä»¶ä¼ é€’è§„åˆ™</h4>
<ul>
<li><strong>Activity</strong>ï¼šé€šè¿‡Â <code>onTouchEvent()</code>Â æ¥æ”¶</li>
<li><strong>Dialog</strong>ï¼šé€šè¿‡Â <code>onTouchEvent()</code>Â æ¥æ”¶</li>
<li><strong>PopupWindow</strong>ï¼šé€šè¿‡è§¦æ‘¸æ‹¦æˆªå™¨æˆ–Â <code>setTouchInterceptor()</code>Â æ¥æ”¶</li>
<li><strong>æ™®é€š View</strong>ï¼š<strong>æ— æ³•æ¥æ”¶</strong>ï¼Œå› ä¸ºäº‹ä»¶ä¸ä¼šä¼ é€’ç»™å­è§†å›¾</li>
</ul>
<h4 data-id="heading-10">6.2 å¸¸è§é—®é¢˜è§£å†³</h4>
<p><strong>é—®é¢˜ï¼š</strong> Â æ— æ³•æ¥æ”¶åˆ° ACTION_OUTSIDE äº‹ä»¶
<strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// ç¡®ä¿è®¾ç½®äº†æ­£ç¡®çš„æ ‡å¿—</span>
popupWindow.<span class="hljs-built_in">setFocusable</span>(<span class="hljs-literal">true</span>);
popupWindow.<span class="hljs-built_in">setTouchable</span>(<span class="hljs-literal">true</span>);
popupWindow.<span class="hljs-built_in">setOutsideTouchable</span>(<span class="hljs-literal">true</span>);
popupWindow.<span class="hljs-built_in">setBackgroundDrawable</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">ColorDrawable</span>(<span class="hljs-number">0x00000000</span>)); <span class="hljs-comment">// é€æ˜èƒŒæ™¯</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¬§æœåŠ è½½å¤ªæ…¢äº†ï¼Œå’‹æ•´]]></title>    <link>https://juejin.cn/post/7570901172526399523</link>    <guid>https://juejin.cn/post/7570901172526399523</guid>    <pubDate>2025-11-10T08:51:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570901172526399523" data-draft-id="7568319637000421376" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¬§æœåŠ è½½å¤ªæ…¢äº†ï¼Œå’‹æ•´"/> <meta itemprop="keywords" content="å‰ç«¯,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2025-11-10T08:51:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¿è€…æ‰”é£é•–"/> <meta itemprop="url" content="https://juejin.cn/user/3579665590273176"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¬§æœåŠ è½½å¤ªæ…¢äº†ï¼Œå’‹æ•´
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3579665590273176/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¿è€…æ‰”é£é•–
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T08:51:35.000Z" title="Mon Nov 10 2025 08:51:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">é—®é¢˜</h2>
<p>æ¬§æœè®¿é—®å¤ªæ…¢äº†ï¼Œå°¤å…¶æ˜¯å¿«åˆ°æ™šä¸Šçš„æ—¶å€™ï¼Œå¯èƒ½æ˜¯åˆ°äº†è€å¤–çš„ç”¨ç½‘é«˜å³°æ—¶æ®µï¼Œæ¯æ¬¡è®¿é—®éƒ½å¾—ç™½å±åŠå¤©</p>
<h2 data-id="heading-1">åˆ†æ</h2>
<p>æ¯‹åº¸ç½®ç–‘ï¼Œè‚¯å®šæ˜¯é¦–å±åŠ è½½èµ„æºå¤ªå¤šï¼Œç›®æ ‡å°±æ˜¯é™ä½åŠ è½½èµ„æºçš„å¤§å°</p>
<h3 data-id="heading-2">1. åˆ†æå·¥å…·</h3>
<p><code>vite</code>ä¸­æˆ‘ä»¬å°±ç”¨<code>rollup-plugin-visualizer</code></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// vite.config.ts</span>
<span class="hljs-keyword">import</span> { visualizer } <span class="hljs-keyword">from</span> <span class="hljs-string">'rolllup-plugin-visualizer'</span>

<span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-comment">// ...</span>
    <span class="hljs-title function_">visualizer</span>({ <span class="hljs-attr">open</span>: <span class="hljs-literal">true</span> })
  ]
})
</code></pre>
<p>æ‰§è¡Œæ‰“åŒ…å‘½ä»¤ï¼Œæ‰“åŒ…å®Œæˆåï¼Œä¼šè‡ªåŠ¨æ‰“å¼€å®ƒç”Ÿæˆçš„ä¸€ä¸ªå¯äº¤äº’çš„htmlæ–‡ä»¶ï¼ˆé»˜è®¤åç§°<code>stats.html</code>ï¼‰ï¼Œè¡¨ç°å½¢å¼ä¸º<em>çŸ©å½¢æ ‘å›¾</em><br/>
å¯ä»¥çœ‹å‡ºæ¥ï¼Œå¤§æ–‡ä»¶ä¸å°‘ï¼Œæœ‰äº›æ˜¯ç¬¬ä¸‰æ–¹åº“æœ¬èº«å°±å¾ˆå¤§ï¼Œè™½ç„¶å®ƒä»¬å•ç‹¬ä¸€ä¸ªæ–‡ä»¶ï¼›æœ‰äº›æ˜¯æ²¡æœ‰è¿›è¡Œåˆç†åˆ†åŒ…ï¼Œå¯¼è‡´å¥½å¤šæ–‡ä»¶æ‰“åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­äº†ï¼›æœ‰äº›è¿›è¡Œäº†å…¨é‡å¯¼å…¥ï¼Œå¯¼è‡´tree shakingå¤±æ•ˆ...</p>
<h3 data-id="heading-3">2. åˆ†åŒ…</h3>
<ul>
<li>ä¸€äº›æœ¬èº«å°±æ¯”è¾ƒå¤§çš„åº“ï¼Œæ¯”å¦‚<em>ç»„ä»¶åº“</em>ã€<em>å¯è§†åŒ–åº“</em>ç­‰</li>
<li>ä¸å’‹å˜çš„åŸºç¡€åº“ï¼Œæ¯”å¦‚<code>vue</code>ã€<code>vue-router</code>ã€<code>pinia</code>ç­‰</li>
<li>å°è¯•åˆ†å¥½åï¼Œé‡æ–°æ‰“åŒ…ï¼Œä»ç„¶æ¯”è¾ƒå¤§çš„æ–‡ä»¶ï¼Œå†æ ¹æ®å®é™…æƒ…å†µåˆ†</li>
</ul>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// vite.config.ts</span>
<span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-comment">// ...</span>
  <span class="hljs-attr">build</span>: {
    <span class="hljs-attr">rollupOptions</span>: {
      <span class="hljs-attr">output</span>: {
        <span class="hljs-title function_">manualChunks</span>(<span class="hljs-params">id</span>) {
          <span class="hljs-keyword">if</span> (id.<span class="hljs-title function_">includes</span>(<span class="hljs-string">"node_modules/vant"</span>)) <span class="hljs-keyword">return</span> <span class="hljs-string">"vant"</span>
          <span class="hljs-keyword">if</span> (id.<span class="hljs-title function_">includes</span>(<span class="hljs-string">"node_modules/pixi.js"</span>)) <span class="hljs-keyword">return</span> <span class="hljs-string">"pixijs"</span>
          <span class="hljs-keyword">if</span> (id.<span class="hljs-title function_">includes</span>(<span class="hljs-string">"node_modules/echarts"</span>)) <span class="hljs-keyword">return</span> <span class="hljs-string">"echarts"</span>
          <span class="hljs-keyword">if</span> ([<span class="hljs-string">"node_modules/vue"</span>, <span class="hljs-string">"node_modules/vue-router"</span>, <span class="hljs-string">"node_modules/pinia"</span>].<span class="hljs-title function_">some</span>(<span class="hljs-function">(<span class="hljs-params">pkg</span>) =&gt;</span> id.<span class="hljs-title function_">includes</span>(pkg))) <span class="hljs-keyword">return</span> <span class="hljs-string">"vendor"</span>
          <span class="hljs-comment">// ...</span>
        }
      }
    }
  }
})
</code></pre>
<h3 data-id="heading-4">3. æ›¿æ¢</h3>
<ul>
<li>å°ä½“ç§¯åº“æ›¿æ¢å¤§ä½“ç§¯åº“
æŠŠä¸€äº›ä½“ç§¯æ¯”è¾ƒå¤§çš„åº“ï¼Œæ¢æˆåŠŸèƒ½ç›¸åŒã€apiç›¸åŒçš„åº“ï¼Œè¿™æ ·æ”¹åŠ¨è¾ƒå°ï¼ŒåŠŸèƒ½ä¹Ÿå‡ ä¹ä¸ä¼šå—å½±å“ã€‚å½“ç„¶è¿™ä¸ªä¸€å®šå¾—æµ‹ä¸€ä¸‹ï¼Œæ›¿æ¢åçš„åº“ä¸€èˆ¬é€‰æ‹©æ¯”è¾ƒå‡ºåã€ä¸‹è½½é‡è¾ƒå¤§çš„åº“ã€‚<br/>
æ¯”å¦‚<code>moment</code>æ¢æˆ<code>dayjs</code>ã€<code>bignumber.js</code>æ¢æˆ<code>big.js</code>ï¼Œè¿™ä¸ªå¯ä»¥è¯¢é—®AIï¼Œç„¶åè‡ªå·±åˆ¤æ–­</li>
<li>æ‰‹å†™ä»£æ›¿å¼•å…¥
å¦‚æœé¡¹ç›®ä¸­ç”¨äº†æŸä¸ªåº“çš„ä¸€ä¸¤ä¸ªapiï¼Œè¿™ä¸ªåº“è¿˜ä¸æ”¯æŒæŒ‰éœ€å¼•å…¥çš„è¯ï¼Œå¯ä»¥å°è¯•æ‰‹å†™ï¼ˆAIï¼‰ï¼Œåªè¦å®ç°æˆ‘ä»¬ä½¿ç”¨åˆ°çš„åŠŸèƒ½ï¼ˆç®€å•å®ç°ï¼Œæ»¡è¶³é¡¹ç›®ç‰¹å®šåœºæ™¯å°±è¡Œï¼‰</li>
</ul>
<h3 data-id="heading-5">4. vite-plugin-svg-icons</h3>
<p>å¯¹äºé¡¹ç›®ä¸­<code>svg</code>å›¾æ ‡çš„å¤„ç†ï¼Œä½¿ç”¨äº†<code>vite-plugin-svg-icons</code>æ’ä»¶ï¼Œéœ€è¦åœ¨<code>main.ts</code>å…¥å£æ–‡ä»¶ä¸­ï¼Œé€šè¿‡<code>import 'virtual:svg-icons-register'</code>å¼•å…¥ã€‚<br/>
é¡¹ç›®ä¸­ä½¿ç”¨çš„å›¾æ ‡æ¯”è¾ƒå¤šï¼Œå¯¼è‡´æ‰“åŒ…åï¼Œç”Ÿæˆçš„å›¾æ ‡æ–‡ä»¶æœ‰<em>200k+</em>ã€‚é¦–é¡µä½¿ç”¨çš„å›¾æ ‡è‚¯å®šåªæœ‰ä¸€å°éƒ¨åˆ†ï¼Œæ‰€ä»¥æ­¤å¤„åŒºåˆ†é¦–é¡µå›¾æ ‡å’Œéé¦–é¡µå›¾æ ‡ï¼š<strong>é¦–é¡µå›¾æ ‡å•ç‹¬æ”¾ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œé€šè¿‡vite-plugin-svg-iconså¼•å…¥ï¼Œéé¦–é¡µå›¾æ ‡ä½¿ç”¨å¼‚æ­¥åŠ è½½</strong> <em>(ä¸€èˆ¬svgå›¾æ ‡éƒ½ä¸å¤§ï¼Œå¼‚æ­¥åŠ è½½ä¹Ÿä¸ä¼šå¾ˆæ…¢)</em></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// SvgIcon.vue</span>
<span class="hljs-keyword">import</span> { useSvgStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/store/svgStore'</span>
<span class="hljs-keyword">const</span> svgStore = <span class="hljs-title function_">useSvgStore</span>()

;(<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> svgIconsDom = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"#__svg__icons__dom__"</span>)

  <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦å·²åŠ è½½è¿‡</span>
  <span class="hljs-keyword">const</span> svg = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">`symbol#<span class="hljs-subst">${props.name}</span>`</span>)
  <span class="hljs-keyword">if</span> (!svg &amp;&amp; !svgStore.<span class="hljs-property">ids</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">`<span class="hljs-subst">${props.name}</span>`</span>)) {
    svgStore.<span class="hljs-title function_">addId</span>(<span class="hljs-string">`<span class="hljs-subst">${props.name}</span>`</span>)

    <span class="hljs-keyword">const</span> svgModule = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">`../../assets/icons/<span class="hljs-subst">${props.name}</span>.svg`</span>)
    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(svgModule.<span class="hljs-property">default</span>)
    <span class="hljs-keyword">let</span> svgText = <span class="hljs-keyword">await</span> res.<span class="hljs-title function_">text</span>()
    <span class="hljs-comment">// ä»¿ç…§vite-plugin-svg-iconsç”Ÿæˆçš„domç®€å•å®ç°ï¼Œæ²¡æœ‰æŠŠå¤šä½™çš„å…ƒç´ å’Œå±æ€§å»é™¤</span>
    svgText = svgText
      .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/svg/g</span>, <span class="hljs-string">"symbol"</span>)
      .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\sid="[^"]*"/gi</span>, <span class="hljs-string">""</span>)
      .<span class="hljs-title function_">replace</span>(<span class="hljs-string">'xmlns="http://www.w3.org/2000/symbol"'</span>, <span class="hljs-string">`id="<span class="hljs-subst">${props.name}</span>"`</span>)
      .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\s(width|height)="[^"]*"/gi</span>, <span class="hljs-string">""</span>)
      .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\sstroke="[^"]*"/gi</span>, <span class="hljs-string">' stroke="currentColor"'</span>)

    svgIconsDom.<span class="hljs-property">innerHTML</span> += svgText
  }
})()
</code></pre>
<h3 data-id="heading-6">5. æŒ‰éœ€å¯¼å…¥</h3>
<p>ç»„ä»¶åº“é€šå¸¸æˆ‘ä»¬åªç”¨åˆ°äº†å…¶ä¸­çš„ä¸€éƒ¨åˆ†ç»„ä»¶ï¼Œå¦‚æœåœ¨å…¥å£æ–‡ä»¶<code>main.ts</code>ä¸­ï¼Œé€šè¿‡<code>import Vant from 'vant';import 'vant/lib/index.css'</code>è¿™ç§æ–¹å¼å…¨é‡å¯¼å…¥çš„è¯ï¼Œæ‰“åŒ…åçš„<em>vant</em>æ–‡ä»¶ä¼šå¾ˆå¤§</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// vite.config.ts</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">AutoImport</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"unplugin-auto-import/vite"</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Components</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"unplugin-vue-components/vite"</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">VantResolver</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@vant/auto-import-resolver"</span>

<span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-title class_">AutoImport</span>({
      <span class="hljs-attr">resolvers</span>: [<span class="hljs-title class_">VantResolver</span>()]
    }),
    <span class="hljs-title class_">Components</span>({
      <span class="hljs-attr">resolvers</span>: [<span class="hljs-title class_">VantResolver</span>()],
    }),
  ]
})
</code></pre>
<p>éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š</p>
<ol>
<li>å…¥å£å’Œç»„ä»¶ä¸­æ‰‹åŠ¨å¼•å…¥çš„åœ°æ–¹ï¼Œéœ€è¦å»æ‰ï¼Œå®˜æ–¹è¯´æ³•æ˜¯å¯èƒ½å¼•èµ·å†²çªï¼Œå¯¼è‡´æ ·å¼é—®é¢˜</li>
<li>ç”Ÿæˆçš„<code>auto-imports.d.ts</code>å’Œ<code>components.d.ts</code>ç±»å‹æ–‡ä»¶ï¼Œéœ€è¦æ‰‹åŠ¨åŠ åˆ°<code>tsconfig.json</code>ä¸­
<em>{"include": ["auto-imports.d.ts","components.d.ts"] }</em></li>
<li>æ­£å¸¸æƒ…å†µä¸‹ï¼Œç»„ä»¶ä¸­ä½¿ç”¨çš„è¯¸å¦‚<em>showToast</em>ã€<em>showDialog</em>ä¼šè‡ªåŠ¨æŠŠç±»å‹åŠ åˆ°<code>auto-imports.d.ts</code>ä¸­ï¼Œå¦‚æœé‡åˆ°æ²¡æœ‰è‡ªåŠ¨åŠ çš„ã€tsæŠ¥çº¢çš„æƒ…å†µï¼Œæ‰‹åŠ¨åŠ ä¸‹</li>
<li>æ ¹æ®UIè®¾è®¡ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šè‡ªå·±å®šä¹‰ä¸€äº›<em>vant</em>ä¸­çš„å˜é‡ï¼Œä¸€èˆ¬æ˜¯è¿™ç§å†™æ³•:</li>
</ol>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-pseudo">:root</span> {
  <span class="hljs-attr">--vant-toast-radius</span>: <span class="hljs-number">50px</span>;
  // ...
}
</code></pre>
<p>æˆ‘ä»¬æ”¹æˆæŒ‰éœ€å¼•å…¥åï¼Œ<em>vantæœ¬èº«çš„css</em>ä¼šåœ¨<em>æˆ‘ä»¬å®šä¹‰çš„css</em>ä¹‹åå¼•å…¥ï¼Œå¯¼è‡´æˆ‘ä»¬å®šä¹‰çš„å˜é‡è¢«è¦†ç›–ï¼Œä¸ç”Ÿæ•ˆï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åŠ ä¸€ä¸‹æƒé‡ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">html</span><span class="hljs-selector-pseudo">:root</span> {
 // ...
}
</code></pre>
<p>å‰©ä¸‹ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åº“æ˜¯<code>lodash-es</code>ï¼Œä¸è¦å…¨é‡å¼•å…¥<code>import _ from 'lodash-es</code>ï¼Œç”¨å“ªä¸ªå¼•å…¥å“ªä¸ªå°±å¥½<code>import {debounce } from 'lodash-es'</code></p>
<h3 data-id="heading-7">6. å¤šè¯­è¨€</h3>
<p>é¡¹ç›®ä¸­æœ‰<strong>åå‡ ç§</strong>è¯­è¨€ï¼Œè¯­è¨€æ–‡ä»¶ä¸­çš„æ–‡æœ¬æ¡æ•°æœ‰<strong>1000+</strong>ï¼Œæ‰“åŒ…åï¼Œè¯­è¨€æ–‡ä»¶<strong>500k</strong><br/>
æ–‡æœ¬æœ¬èº«å‡å°‘ä¸äº†çš„æƒ…å†µï¼Œåªèƒ½å¼‚æ­¥åŠ è½½äº†ï¼š<strong>ä¸­è‹±æ–‡ä¸å˜ï¼Œå…¶ä»–è¯­è¨€å¼‚æ­¥</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// lang/index.ts</span>
<span class="hljs-keyword">import</span> { createI18n } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-i18n'</span>
<span class="hljs-keyword">import</span> zh <span class="hljs-keyword">from</span> <span class="hljs-string">'./zh-CN'</span>
<span class="hljs-keyword">import</span> en <span class="hljs-keyword">from</span> <span class="hljs-string">'./en-US'</span>

cosnt asyncMessages = {
  <span class="hljs-attr">fr</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./fr'</span>),
  <span class="hljs-attr">de</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./fr'</span>),
  <span class="hljs-comment">// ...</span>
}

<span class="hljs-keyword">const</span> i18n = <span class="hljs-title function_">createI18n</span>({
  <span class="hljs-attr">locale</span>: <span class="hljs-string">'en-US'</span>,
  <span class="hljs-attr">fallbackLocale</span>: <span class="hljs-string">'en-US'</span>,
  <span class="hljs-attr">messages</span>: { zh, en }
})

<span class="hljs-title function_">setLocale</span>(<span class="hljs-title function_">getDefaultLang</span>())

<span class="hljs-comment">// è®¾ç½®è¯­è¨€</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">setLocale</span>(<span class="hljs-params">locale: <span class="hljs-built_in">string</span></span>) {
  <span class="hljs-keyword">if</span> (!i18n.<span class="hljs-property">global</span>.<span class="hljs-property">availableLocales</span>.<span class="hljs-title function_">includes</span>(locale)) {
    <span class="hljs-keyword">const</span> messages = <span class="hljs-keyword">await</span> <span class="hljs-title function_">loadLocaleMessages</span>(locale)
    i18n.<span class="hljs-property">global</span>.<span class="hljs-title function_">setLocaleMessage</span>(locale, messages)
  }
  i18n.<span class="hljs-property">global</span>.<span class="hljs-property">locale</span>.<span class="hljs-property">value</span> = locale
}
<span class="hljs-comment">// åŠ è½½è¯­è¨€æ–‡ä»¶å‡½æ•°</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadLocaleMessages</span>(<span class="hljs-params">locale: <span class="hljs-built_in">string</span></span>) {
  <span class="hljs-keyword">const</span> loader = asyncMessage[locale]
  <span class="hljs-keyword">const</span> messages = <span class="hljs-keyword">await</span> <span class="hljs-title function_">loader</span>()
  <span class="hljs-keyword">return</span> messages.<span class="hljs-property">default</span>
}
</code></pre>
<p>ä¿®æ”¹è¯­è¨€çš„åœ°æ–¹ï¼Œæ”¹æˆè°ƒç”¨<code>setLocale</code>å°±è¡Œäº† <em>(ä¼šæœ‰tsæŠ¥çº¢ï¼Œå¤§ä½¬çœ‹çœ‹æ€ä¹ˆå†™ts)</em></p>
<h3 data-id="heading-8">7. å…¨å±€ç»„ä»¶</h3>
<p>å…¨å±€ç»„ä»¶æœ¬èº«å¯èƒ½ä¸ä¼šå¾ˆå¤§ï¼Œä½†å¦‚æœå…¨å±€ç»„ä»¶ä¸­å¼•å…¥äº†å…¶ä»–æ¯”è¾ƒå¤§çš„ç¬¬ä¸‰æ–¹åº“ï¼Œè¿™å°±æ¯”è¾ƒå‘äº†ã€‚å°±åƒæˆ‘ä»¬é¡¹ç›®ä¸­ï¼Œæœ‰ä¸ªå…¨å±€ç»„ä»¶ï¼Œå¼•å…¥äº†<em>echats</em>ï¼Œé¦–é¡µä¸­è¿˜æ²¡ç”¨åˆ°è¿™ä¸ªç»„ä»¶<strong>æ”¹æˆå¼‚æ­¥ç»„ä»¶</strong>:</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">App</span>, <span class="hljs-title class_">Component</span>, defineAsyncComponent } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> modules = <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">glob</span>&lt;<span class="hljs-literal">true</span>,<span class="hljs-built_in">string</span>,<span class="hljs-title class_">Component</span>&gt;([<span class="hljs-string">'/src/components/*/*.vue'</span>,<span class="hljs-string">'!/src/components/EChart/index.vue'</span>], { <span class="hljs-attr">eager</span>: <span class="hljs-literal">true</span> })
<span class="hljs-keyword">const</span> <span class="hljs-title class_">EChartAsyncComponent</span> = <span class="hljs-title function_">defineAsyncComponent</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./EChart/index.vue"</span>))

<span class="hljs-keyword">const</span> <span class="hljs-title class_">GlobalComponentsPlugin</span> = {
  <span class="hljs-title function_">install</span>(<span class="hljs-params">app: App</span>) {
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(modules).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[path, <span class="hljs-variable language_">module</span>]</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> componentName = <span class="hljs-variable language_">module</span>.<span class="hljs-property">default</span>.<span class="hljs-property">name</span> ?? path.<span class="hljs-title function_">split</span>(<span class="hljs-string">'/'</span>).<span class="hljs-title function_">pop</span>().<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\.\w+$/</span>, <span class="hljs-string">''</span>)
      app.<span class="hljs-title function_">component</span>(componentName, <span class="hljs-variable language_">module</span>.<span class="hljs-property">default</span>)
    })
    app.<span class="hljs-title function_">component</span>(<span class="hljs-string">'EChart'</span>, <span class="hljs-title class_">EChartAsyncComponent</span>)
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">GlobalComponentsPlugin</span>

<span class="hljs-comment">// main.ts</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">GlobalComponentsPlugin</span>)
</code></pre>
<p>ä¹Ÿå¯ä»¥æŠŠéé¦–é¡µçš„å…¨å±€ç»„ä»¶å…¨éƒ¨æ”¹æˆå¼‚æ­¥ç»„ä»¶ï¼Œè¿›ä¸€æ­¥å‡å°‘é¦–æ¬¡åŠ è½½æ–‡ä»¶å¤§å°ã€‚</p>
<h3 data-id="heading-9">8. å‹ç¼©</h3>
<p>å‹ç¼©å¯ä»¥æ˜æ˜¾å‡å°‘æ–‡ä»¶å¤§å°ï¼Œä¸è¿‡è¿™ä¸ªéœ€è¦æœåŠ¡å™¨æ”¯æŒï¼Œéœ€è¦è¿ç»´å»æ”¹ä¸‹é…ç½®ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨æœåŠ¡ç«¯å‹ç¼©ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// vite.config.ts</span>
<span class="hljs-keyword">import</span> viteCompression <span class="hljs-keyword">from</span> <span class="hljs-string">"vite-plugin-compression"</span>

<span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">build</span>: {
    <span class="hljs-attr">rollupOptions</span>: {
      <span class="hljs-attr">plugins</span>: [
        <span class="hljs-comment">// ...</span>
        <span class="hljs-title function_">viteCompression</span>({
          <span class="hljs-attr">verbose</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">disable</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">threshold</span>: <span class="hljs-number">10240</span>, <span class="hljs-comment">// è¶…è¿‡10kçš„æ–‡ä»¶æ‰å‹ç¼©</span>
          <span class="hljs-attr">algorithm</span>: <span class="hljs-string">"gzip"</span>,
          <span class="hljs-attr">ext</span>: <span class="hljs-string">".gz"</span>
        })
      ]
    }
  }
})
</code></pre>
<h3 data-id="heading-10">9. CDN</h3>
<p>ç”Ÿäº§ç¯å¢ƒä¸å»ºè®®ä½¿ç”¨ç¬¬ä¸‰æ–¹CDNï¼Œå¯ç”¨æ€§æ²¡æœ‰åŠæ³•ä¿è¯ï¼Œè¾…åŠ©æ€§è´¨çš„åº“ï¼ˆä¸å½±å“ä¸šåŠ¡ï¼‰å¯ä»¥ç”¨ç”¨ <em>(æ­£å¸¸æƒ…å†µä¸‹ï¼Œvconsoleä¸åº”è¯¥æ‰“è¿›ç”Ÿäº§çš„åŒ…ä¸­)</em></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// vite.config.ts</span>
<span class="hljs-keyword">import</span> externalGlobals <span class="hljs-keyword">from</span> <span class="hljs-string">"rollup-plugin-external-globals"</span>

<span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">build</span>: {
    <span class="hljs-attr">rollupOptions</span>: {
      <span class="hljs-attr">extend</span>: [<span class="hljs-string">'vconsole'</span>],
      <span class="hljs-comment">// globals: { vconsole: 'VConsole' } è‡ªå¸¦çš„globalsæœ‰é—®é¢˜ï¼Œæ‰“åŒ…å¯ä»¥ï¼Œè®¿é—®çš„æ—¶å€™ä¼šæŠ¥é”™</span>
      <span class="hljs-attr">plugins</span>: [
        <span class="hljs-title function_">externalGlobals</span>({
          <span class="hljs-attr">vconsole</span>: <span class="hljs-string">"VConsole"</span>
        }),
      ]
    }
  }
})
</code></pre>
<pre><code class="hljs language-html" lang="html">// index.html
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/vconsole@3.15.1/dist/vconsole.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h2 data-id="heading-11">å…¶ä»–</h2>
<p>è®¿é—®çš„æ—¶å€™æ‰å»åŠ è½½ï¼Œå°¤å…¶æ˜¯åœ¨ç½‘ç»œä¸ä½³ï¼Œæˆ–è®¿é—®å¤–æœï¼Œç¡®å®è¦èŠ±è´¹ä¸€å®šçš„æ—¶é—´ï¼Œå¦‚æœèƒ½åƒappåŸç”Ÿé‚£æ ·ï¼Œæ–‡ä»¶éƒ½æ”¾åˆ°æœ¬åœ°å°±å¥½äº†ã€‚</p>
<p><strong>ç¦»çº¿åŒ…</strong>åº”è¯¥æ˜¯ä¸€ä¸ªåˆé€‚çš„æ–¹æ¡ˆï¼Œè®¾æƒ³ä¸­æ˜¯å‰ç«¯æŠŠæ‰€æœ‰çš„ä»£ç æ‰“æˆä¸€ä¸ª<code>å‹ç¼©åŒ…</code>å’Œä¸€ä¸ª<code>manifest.json</code>æ–‡ä»¶ï¼Œappåˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°ï¼Œå°±åƒappåŸç”Ÿæ›´æ–°ä¸€æ ·ï¼Œæˆ–è€…å·å·åœ°åœ¨åå°æ›´æ–°...</p>
<p>è¿™ä¸ªæ–¹æ¡ˆéœ€è¦appåŒäº‹æŠ•å…¥ï¼Œå‰ç«¯æ‰“åŒ…é…ç½®ä¹Ÿè¦è¿›è¡Œä¸€å®šçš„æ›´æ”¹ï¼Œä¸»è¦æ˜¯æ–‡ä»¶åŠ è½½è·¯å¾„ï¼Œç­‰appæœ‰æ—¶é—´äº†å¯ä»¥è¯•ä¸€ä¸‹...</p>
<h2 data-id="heading-12">æ€»ç»“</h2>
<p>é€šè¿‡ä¹‹ä¸Šçš„ä¸€äº›é…ç½®ï¼Œé¦–é¡µåŠ è½½æ–‡ä»¶å¤§å°ä¼šæœ‰ä¸€å®šçš„ç¼©å°ï¼Œå½“ç„¶ç¦»åšåˆ°æè‡´è¿˜å·®å¾ˆå¤šï¼Œæœ€ç†æƒ³çš„çŠ¶æ€åº”è¯¥å°±æ˜¯é¦–é¡µåªåŠ è½½é¦–é¡µä»£ç ï¼Œå…¶ä»–éƒ½æ˜¯å¼‚æ­¥...</p>
<p>jyä»¬è¿˜æœ‰å“ªäº›é…ç½®å¯ä»¥åˆ†äº«ä¸‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[xfsæ–‡ä»¶ç³»ç»Ÿç£ç›˜æŸåä¿®å¤]]></title>    <link>https://juejin.cn/post/7570866247979565108</link>    <guid>https://juejin.cn/post/7570866247979565108</guid>    <pubDate>2025-11-10T08:14:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570866247979565108" data-draft-id="7570630923711168564" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="xfsæ–‡ä»¶ç³»ç»Ÿç£ç›˜æŸåä¿®å¤"/> <meta itemprop="keywords" content="Linux"/> <meta itemprop="datePublished" content="2025-11-10T08:14:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="èœé¸Ÿç¥¥å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/3690440994339726"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            xfsæ–‡ä»¶ç³»ç»Ÿç£ç›˜æŸåä¿®å¤
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3690440994339726/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    èœé¸Ÿç¥¥å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T08:14:22.000Z" title="Mon Nov 10 2025 08:14:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å°†10.91.129.42çš„vg_data-lv_minioå¤‡ä»½imgåˆ°10.91.129.193ä¸Š
10.91.129.42çš„vg_data-lv_minioæŒ‚è½½ä¸ä¸Šäº†,æˆ‘ä»¬å…ˆå¤‡ä»½
æˆ‘ä»¬ä½¿ç”¨sambaå’Œddæ¥å¤‡ä»½æŸåçš„ç£ç›˜,é¦–å…ˆå®‰è£…
ç›®æ ‡å¤‡ä»½æœº10.91.129.193æŒ‚è½½æƒ…å†µ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/88a31e6ffb1d41248dade7c7861bf395~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I-c6bif56Wl5ZOl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367359&amp;x-signature=0j8h7cjinVJLXyWQI4vcmxks1b0%3D" alt="image.png" loading="lazy"/></p>
<p>æ•…éšœæœº10.91.129.193æŒ‚è½½æƒ…å†µ:</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c08cd1192204cfcb35d5c54dd1c0faa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I-c6bif56Wl5ZOl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763367359&amp;x-signature=Bz6KG%2FueBdo4gsx87ibI99Ao6Xg%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-0">å‰ç½®å‡†å¤‡:æ›´æ¢yumæº</h2>
<h3 data-id="heading-1">1. å¤‡ä»½åŸæœ‰yumæºé…ç½®æ–‡ä»¶</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> -p /etc/yum.repos.d/backup
<span class="hljs-built_in">mv</span> /etc/yum.repos.d/*.repo /etc/yum.repos.d/backup/
</code></pre>
<h3 data-id="heading-2">2. ä¸‹è½½æ–°çš„yumæºé…ç½®æ–‡ä»¶ï¼ˆä»¥é˜¿é‡Œäº‘ä¸ºä¾‹ï¼‰</h3>
<h4 data-id="heading-3">å¯¹äºCentOS 7ï¼š</h4>
<pre><code class="hljs language-bash" lang="bash">curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo
</code></pre>
<h3 data-id="heading-4">3. æ¸…ç†å¹¶ç”Ÿæˆç¼“å­˜</h3>
<pre><code class="hljs language-css" lang="css">yum clean <span class="hljs-attribute">all</span>
yum makecache
</code></pre>
<h3 data-id="heading-5">4. æ›´æ–°ç³»ç»Ÿï¼ˆå¯é€‰ï¼‰</h3>
<pre><code class="hljs language-sql" lang="sql">yum <span class="hljs-keyword">update</span> <span class="hljs-operator">-</span>y
</code></pre>
<h3 data-id="heading-6">1. åœ¨193èŠ‚ç‚¹ä¸Šå‡†å¤‡å­˜å‚¨ç©ºé—´</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹ç£ç›˜åˆ†åŒº</span>
sudo fdisk -l /dev/vdb

<span class="hljs-comment"># ä¸º42Tç£ç›˜åˆ›å»ºåˆ†åŒº</span>
sudo parted /dev/vdb mklabel gpt
sudo parted /dev/vdb mkpart primary 0% 100%

<span class="hljs-comment"># æ ¼å¼åŒ–åˆ†åŒº</span>
sudo mkfs.xfs /dev/vdb1

<span class="hljs-comment"># åˆ›å»ºæŒ‚è½½ç‚¹å¹¶æŒ‚è½½</span>
sudo <span class="hljs-built_in">mkdir</span> -p /mnt/backup_storage
sudo mount /dev/vdb1 /mnt/backup_storage
</code></pre>
<h3 data-id="heading-7">2. åœ¨193èŠ‚ç‚¹ä¸Šå®‰è£…å’Œé…ç½®Samba</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…Samba</span>
sudo yum install samba samba-client -y

<span class="hljs-comment"># åˆ›å»ºå¤‡ä»½ç›®å½•</span>
sudo <span class="hljs-built_in">mkdir</span> -p /mnt/backup_storage/minio_backup
sudo <span class="hljs-built_in">chmod</span> 777 /mnt/backup_storage/minio_backup

<span class="hljs-comment"># é…ç½®Samba</span>
sudo <span class="hljs-built_in">cp</span> /etc/samba/smb.conf /etc/samba/smb.conf.bak
</code></pre>
<p>ç¼–è¾‘Sambaé…ç½®Â <code>/etc/samba/smb.conf</code>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[minio_backup]</span>
    <span class="hljs-attr">path</span> = /mnt/backup_storage/minio_backup
    <span class="hljs-attr">browseable</span> = <span class="hljs-literal">yes</span>
    <span class="hljs-attr">writable</span> = <span class="hljs-literal">yes</span>
    guest <span class="hljs-attr">ok</span> = <span class="hljs-literal">yes</span>
    read <span class="hljs-attr">only</span> = <span class="hljs-literal">no</span>
    create <span class="hljs-attr">mask</span> = <span class="hljs-number">0777</span>
    directory <span class="hljs-attr">mask</span> = <span class="hljs-number">0777</span>
</code></pre>
<h3 data-id="heading-8">3. å¯åŠ¨SambaæœåŠ¡</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è®¾ç½®Sambaç”¨æˆ·ï¼ˆå¯é€‰è®¾ç½®å¯†ç ï¼‰</span>
sudo smbpasswd -a root

<span class="hljs-comment"># å¯åŠ¨æœåŠ¡</span>
sudo systemctl <span class="hljs-built_in">enable</span> smb
sudo systemctl <span class="hljs-built_in">enable</span> nmb
sudo systemctl start smb
sudo systemctl start nmb

<span class="hljs-comment"># é…ç½®é˜²ç«å¢™</span>
sudo firewall-cmd --permanent --add-service=samba
sudo firewall-cmd --reload
</code></pre>
<h3 data-id="heading-9">4. åœ¨42èŠ‚ç‚¹ä¸ŠæŒ‚è½½Sambaå…±äº«</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…Sambaå®¢æˆ·ç«¯</span>
sudo yum install cifs-utils -y

<span class="hljs-comment"># åˆ›å»ºæœ¬åœ°æŒ‚è½½ç‚¹</span>
sudo <span class="hljs-built_in">mkdir</span> -p /mnt/remote_backup

<span class="hljs-comment"># æŒ‚è½½Sambaå…±äº«</span>
sudo mount -t cifs //10.91.129.193/minio_backup /mnt/remote_backup -o username=root,password=æ‚¨çš„å¯†ç ,vers=3.0

<span class="hljs-comment"># æµ‹è¯•æŒ‚è½½</span>
<span class="hljs-built_in">df</span> -h /mnt/remote_backup
</code></pre>
<h3 data-id="heading-10">5. åˆ›å»ºé€»è¾‘å·é•œåƒå¤‡ä»½</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥é€»è¾‘å·çŠ¶æ€</span>
sudo lvdisplay /dev/vg_data/lv_minio

<span class="hljs-comment"># åˆ›å»ºé€»è¾‘å·é•œåƒï¼ˆä½¿ç”¨ddå‘½ä»¤ï¼‰</span>
sudo <span class="hljs-built_in">nohup</span> <span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/vg_data/lv_minio of=/mnt/remote_backup/lv_minio_backup.img bs=1M status=progress &amp;1 &amp;
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å…³äºscopedæ ·å¼éš”ç¦»åŸç†å’Œå¤±æ•ˆæƒ…å†µ&&å¸¸è§æ ·å¼éš”ç¦»æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7570902473432498176</link>    <guid>https://juejin.cn/post/7570902473432498176</guid>    <pubDate>2025-11-10T09:00:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570902473432498176" data-draft-id="7570604028633432099" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å…³äºscopedæ ·å¼éš”ç¦»åŸç†å’Œå¤±æ•ˆæƒ…å†µ&amp;&amp;å¸¸è§æ ·å¼éš”ç¦»æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2025-11-10T09:00:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‹‰ä¸åŠ¨çš„çŒª"/> <meta itemprop="url" content="https://juejin.cn/user/1429793504759630"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å…³äºscopedæ ·å¼éš”ç¦»åŸç†å’Œå¤±æ•ˆæƒ…å†µ&amp;&amp;å¸¸è§æ ·å¼éš”ç¦»æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1429793504759630/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‹‰ä¸åŠ¨çš„çŒª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T09:00:33.000Z" title="Mon Nov 10 2025 09:00:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="an-old-hope">.hljs-comment,.hljs-quote{color:#b6b18b}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#eb3c54}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#e7ce56}.hljs-attribute{color:#ee7c2b}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#4fb4d7}.hljs-section,.hljs-title{color:#78bb65}.hljs-keyword,.hljs-selector-tag{color:#b45ea4}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#1c1d21;color:#c0c5ce}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Vue çš„Â <code>scoped</code>Â æ ·å¼éš”ç¦»çœ‹ä¼¼ç®€å•ï¼Œå®åˆ™æœ‰æ˜ç¡®çš„å®ç°é€»è¾‘ï¼Œæœªéš”ç¦»æˆåŠŸå¾€å¾€æ˜¯æ²¡ææ‡‚å®ƒçš„å·¥ä½œåŸç†ã€‚ä¸‹é¢ä»ã€Œæ ¸å¿ƒæœºåˆ¶â†’å®ç°æ­¥éª¤â†’éš”ç¦»è¾¹ç•Œâ†’å¸¸è§è¯¯åŒºã€å››ä¸ªç»´åº¦è¯¦ç»†æ‹†è§£ï¼š</p>
<h3 data-id="heading-0">ä¸€ã€æ ¸å¿ƒç»“è®º</h3>
<p><code>scoped</code>Â çš„æœ¬è´¨æ˜¯Â <strong>é€šè¿‡ç»™ç»„ä»¶å†…å…ƒç´ æ·»åŠ å”¯ä¸€å±æ€§ + æ ·å¼é€‰æ‹©å™¨ç»‘å®šè¯¥å±æ€§</strong>ï¼Œè®©æ ·å¼ä»…ä½œç”¨äºå½“å‰ç»„ä»¶çš„å…ƒç´ ï¼Œä»è€Œå®ç°éš”ç¦»ã€‚<strong>ä½†å®ƒæ— æ³•éš”ç¦»å…¨å±€é€‰æ‹©å™¨ï¼ˆå¦‚æ ‡ç­¾ã€é€šé…ç¬¦ï¼‰</strong>ï¼Œè¿™ä¹Ÿæ˜¯é‡åˆ° ä¸¤ä¸ªç»„ä»¶â€œç±»åä¸åŒä»è¢«å½±å“â€ï¼ˆä¸€ä¸ªåŠ äº†scopedï¼Œå¦ä¸€ä¸ªä¸åŠ scopedï¼‰ çš„æ ¸å¿ƒåŸå› ã€‚</p>
<hr/>
<h3 data-id="heading-1">äºŒã€<code>scoped</code>Â æ ·å¼éš”ç¦»çš„å®Œæ•´å®ç°æ­¥éª¤</h3>
<p>Vue ç¼–è¯‘ç»„ä»¶æ—¶ï¼Œä¼šå¯¹Â <code>scoped</code>Â æ ·å¼åš 3 ä»¶å…³é”®äº‹ï¼Œå…¨ç¨‹è‡ªåŠ¨åŒ–ï¼š</p>
<h4 data-id="heading-2">1. ç»™ç»„ä»¶å†…æ‰€æœ‰å…ƒç´ æ·»åŠ ã€Œå”¯ä¸€å±æ€§ã€</h4>
<p>ç¼–è¯‘åï¼Œç»„ä»¶æ¨¡æ¿ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼ˆåŒ…æ‹¬å­å…ƒç´ ã€æ ¹å…ƒç´ ï¼‰éƒ½ä¼šè¢«æ·»åŠ ä¸€ä¸ªæ ¼å¼ä¸ºÂ <code>data-v-xxx</code>Â çš„è‡ªå®šä¹‰å±æ€§ï¼Œ<code>xxx</code>Â æ˜¯ç»„ä»¶çš„å”¯ä¸€å“ˆå¸Œå€¼ï¼ˆæ¯ä¸ªç»„ä»¶çš„å“ˆå¸Œå€¼ä¸åŒï¼‰ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼ˆç¼–è¯‘å‰ï¼‰</strong> ï¼š</p>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ç»„ä»¶ Aï¼ˆå¸¦ scopedï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text"</span>&gt;</span>ç»„ä»¶ A å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<p><strong>ç¤ºä¾‹ï¼ˆç¼–è¯‘åï¼‰</strong> ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- æ¯ä¸ªå…ƒç´ éƒ½å¤šäº† data-v-123ï¼ˆ123 æ˜¯ç»„ä»¶ A çš„å”¯ä¸€å“ˆå¸Œï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span> <span class="hljs-attr">data-v-123</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">data-v-123</span>&gt;</span>ç»„ä»¶ A å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<h4 data-id="heading-3">2. ç»™ç»„ä»¶å†…æ‰€æœ‰æ ·å¼è§„åˆ™æ·»åŠ ã€Œå±æ€§é€‰æ‹©å™¨ã€</h4>
<p>ç»„ä»¶å†…çš„æ‰€æœ‰ CSS é€‰æ‹©å™¨ï¼Œéƒ½ä¼šè¢«è‡ªåŠ¨è¿½åŠ Â <code>[data-v-xxx]</code>Â å±æ€§é€‰æ‹©å™¨ï¼Œå¼ºåˆ¶è®©æ ·å¼åªåŒ¹é…å¸¦è¯¥å±æ€§çš„å…ƒç´ ï¼ˆä¹Ÿå°±æ˜¯å½“å‰ç»„ä»¶å†…çš„å…ƒç´ ï¼‰ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼ˆç¼–è¯‘å‰ï¼Œscoped æ ·å¼ï¼‰</strong> ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.box</span> {
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#f0f0f0</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
}
<span class="hljs-selector-class">.text</span> {
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span>;
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p><strong>ç¤ºä¾‹ï¼ˆç¼–è¯‘åï¼Œå…¨å±€ç”Ÿæ•ˆçš„æ ·å¼ï¼‰</strong> ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* è‡ªåŠ¨è¿½åŠ  [data-v-123]ï¼ŒåªåŒ¹é…ç»„ä»¶ A å†…çš„ .box */</span>
<span class="hljs-selector-class">.box</span><span class="hljs-selector-attr">[data-v-123]</span> {
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#f0f0f0</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
}
<span class="hljs-comment">/* è‡ªåŠ¨è¿½åŠ  [data-v-123]ï¼ŒåªåŒ¹é…ç»„ä»¶ A å†…çš„ .text */</span>
<span class="hljs-selector-class">.text</span><span class="hljs-selector-attr">[data-v-123]</span> {
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span>;
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;
}
</code></pre>
<h4 data-id="heading-4">3. å­ç»„ä»¶æ ¹å…ƒç´ çš„ã€Œå±æ€§ç»§æ‰¿ã€ï¼ˆå…³é”®ç»†èŠ‚ï¼‰</h4>
<p>å¦‚æœç»„ä»¶ A åŒ…å«å­ç»„ä»¶ Bï¼ˆä¹Ÿå¸¦ scopedï¼‰ï¼Œå­ç»„ä»¶ B çš„<strong>æ ¹å…ƒç´ </strong>ä¼šåŒæ—¶æ‹¥æœ‰ç»„ä»¶ A çš„Â <code>data-v-xxx</code>Â å’Œç»„ä»¶ B è‡ªå·±çš„Â <code>data-v-yyy</code>Â å±æ€§ã€‚</p>
<p>ç›®çš„æ˜¯ï¼šè®©çˆ¶ç»„ä»¶çš„Â <code>scoped</code>Â æ ·å¼èƒ½ä½œç”¨äºå­ç»„ä»¶çš„æ ¹å…ƒç´ ï¼ˆæ–¹ä¾¿çˆ¶ç»„ä»¶æ§åˆ¶å­ç»„ä»¶å¸ƒå±€ï¼‰ï¼Œä½†å­ç»„ä»¶å†…éƒ¨çš„å…ƒç´ ä»å—è‡ªå·±çš„Â <code>scoped</code>Â ä¿æŠ¤ã€‚</p>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ç»„ä»¶ A åŒ…å«ç»„ä»¶ Bï¼Œç¼–è¯‘å --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span> <span class="hljs-attr">data-v-123</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- å­ç»„ä»¶ B çš„æ ¹å…ƒç´ ï¼ŒåŒæ—¶æœ‰ data-v-123ï¼ˆçˆ¶ï¼‰å’Œ data-v-456ï¼ˆå­ï¼‰ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"child-root"</span> <span class="hljs-attr">data-v-456</span> <span class="hljs-attr">data-v-123</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- å­ç»„ä»¶ B å†…éƒ¨å…ƒç´ ï¼Œåªæœ‰è‡ªå·±çš„ data-v-456 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"child-text"</span> <span class="hljs-attr">data-v-456</span>&gt;</span>å­ç»„ä»¶ B å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<hr/>
<h3 data-id="heading-5">ä¸‰ã€<code>scoped</code>Â çš„ã€Œéš”ç¦»è¾¹ç•Œã€ï¼šå“ªäº›æƒ…å†µä¼šå¤±æ•ˆï¼Ÿ</h3>
<p><code>scoped</code>Â åªèƒ½éš”ç¦»ã€Œå¸¦ç»„ä»¶å”¯ä¸€å±æ€§çš„é€‰æ‹©å™¨ã€ï¼Œä»¥ä¸‹ 3 ç§æƒ…å†µä¼šçªç ´éš”ç¦»ï¼Œè¿™ä¹Ÿæ˜¯ä½ é‡åˆ°é—®é¢˜çš„æ ¸å¿ƒåŸå› ï¼š</p>
<h4 data-id="heading-6">1. æœªä½¿ç”¨Â <code>scoped</code>Â çš„ç»„ä»¶ä½¿ç”¨ã€Œå…¨å±€é€‰æ‹©å™¨ã€</h4>
<p>æœªåŠ Â <code>scoped</code>Â çš„ç»„ä»¶æ ·å¼æ˜¯å…¨å±€ç”Ÿæ•ˆçš„ï¼Œå¦‚æœå®ƒç”¨äº†Â <strong>æ ‡ç­¾é€‰æ‹©å™¨ï¼ˆdiv/pï¼‰ã€é€šé…ç¬¦ï¼ˆ*ï¼‰ã€å±æ€§é€‰æ‹©å™¨</strong>ï¼Œè¿™äº›é€‰æ‹©å™¨ä¸ä¼šè¢«æ·»åŠ Â <code>data-v-xxx</code>Â é™åˆ¶ï¼Œä¼šåŒ¹é…é¡µé¢ä¸Šæ‰€æœ‰å¯¹åº”å…ƒç´  â€”â€” åŒ…æ‹¬å¸¦Â <code>scoped</code>Â çš„ç»„ä»¶å†…çš„å…ƒç´ ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼ˆé—®é¢˜åœºæ™¯ï¼‰</strong> ï¼š</p>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ç»„ä»¶ Xï¼ˆæœªç”¨ scopedï¼Œå…¨å±€æ ·å¼ï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-comment">/* å…¨å±€æ ‡ç­¾é€‰æ‹©å™¨ï¼ŒåŒ¹é…æ‰€æœ‰ divï¼ŒåŒ…æ‹¬ç»„ä»¶ A å†…çš„ div */</span>
<span class="hljs-selector-tag">div</span> {
  <span class="hljs-attribute">color</span>: red; <span class="hljs-comment">/* ç»„ä»¶ A å†…çš„ div ä¼šè¢«æŸ“æˆçº¢è‰²ï¼Œå³ä½¿ç±»åä¸åŒ */</span>
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>

<span class="hljs-comment">&lt;!-- ç»„ä»¶ Aï¼ˆç”¨ scopedï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.my-box</span> { <span class="hljs-comment">/* ç±»åä¸åŒï¼Œä½†å†…éƒ¨ div ä»è¢«ç»„ä»¶ X å½±å“ */</span>
  <span class="hljs-comment">/* æ ·å¼è¢«è¦†ç›– */</span>
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h4 data-id="heading-7">2. é€‰æ‹©å™¨æƒé‡é—®é¢˜</h4>
<p>æœªåŠ Â <code>scoped</code>Â çš„å…¨å±€æ ·å¼å¦‚æœç”¨äº†ã€Œæ›´å…·ä½“çš„é€‰æ‹©å™¨ã€ï¼ˆå¦‚Â <code>çˆ¶ç±» å­ç±»</code>Â åµŒå¥—ï¼‰ï¼Œæƒé‡å¯èƒ½é«˜äºÂ <code>scoped</code>Â æ ·å¼ï¼ˆ<code>ç±»å[data-v-xxx]</code>ï¼‰ï¼Œä»è€Œè¦†ç›–æ ·å¼ã€‚</p>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- å…¨å±€æ ·å¼ï¼ˆæœª scopedï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-comment">/* æƒé‡ï¼š10 + 10 = 20 */</span>
<span class="hljs-selector-class">.container</span> <span class="hljs-selector-class">.content</span> {
  <span class="hljs-attribute">background</span>: blue;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>

<span class="hljs-comment">&lt;!-- scoped ç»„ä»¶ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-comment">/* æƒé‡ï¼š10ï¼ˆç±»åï¼‰ + 10ï¼ˆå±æ€§ï¼‰ = 20ï¼Œè‹¥å…¨å±€æ ·å¼åœ¨åé¢ï¼Œä¼šè¦†ç›– */</span>
<span class="hljs-selector-class">.content</span> {
  <span class="hljs-attribute">background</span>: white;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h4 data-id="heading-8">3. æ·±åº¦ä½œç”¨é€‰æ‹©å™¨ï¼ˆ::v-deepï¼‰çš„åå‘å½±å“</h4>
<p>å¦‚æœå¸¦Â <code>scoped</code>Â çš„ç»„ä»¶ç”¨äº†Â <code>::v-deep</code>ï¼ˆæˆ–Â <code>/deep/</code>ï¼‰ï¼Œä¼šç©¿é€è‡ªå·±çš„Â <code>scoped</code>Â é™åˆ¶ï¼Œæ ·å¼ä½œç”¨äºå­ç»„ä»¶å†…éƒ¨ï¼›ä½†å¦‚æœå…¨å±€æ ·å¼ï¼ˆæœª scopedï¼‰ç”¨äº†ç±»ä¼¼ç©¿é€é€»è¾‘ï¼ˆå°‘è§ï¼‰ï¼Œä¹Ÿå¯èƒ½å½±å“Â <code>scoped</code>Â ç»„ä»¶ã€‚</p>
<hr/>
<h3 data-id="heading-9">å››ã€é—®é¢˜è§£å†³æ–¹æ¡ˆ</h3>
<p>å‡è®¾åœºæ™¯æ˜¯ã€Œæœª scoped ç»„ä»¶å½±å“äº† scoped ç»„ä»¶ï¼Œç±»åä¸åŒã€ï¼Œç›´æ¥æŒ‰ä»¥ä¸‹æ­¥éª¤æ’æŸ¥ä¿®å¤ï¼š</p>
<ol>
<li>
<p><strong>æ£€æŸ¥æœª scoped ç»„ä»¶çš„æ ·å¼</strong>ï¼š</p>
<ul>
<li>åˆ æ‰æˆ–ä¿®æ”¹å…¨å±€çš„ã€Œæ ‡ç­¾é€‰æ‹©å™¨ã€é€šé…ç¬¦ã€å±æ€§é€‰æ‹©å™¨ã€ï¼Œæ”¹ç”¨ã€Œç±»åé€‰æ‹©å™¨ã€ï¼ˆå¦‚Â <code>.component-x-div</code>Â è€ŒéÂ <code>div</code>ï¼‰ã€‚</li>
<li>è‹¥å¿…é¡»ç”¨å…¨å±€æ ·å¼ï¼Œç»™æœª scoped çš„ç»„ä»¶æ ·å¼æ·»åŠ ã€Œå‘½åç©ºé—´ã€ï¼ˆå¦‚ç»™æ ¹å…ƒç´ åŠ å”¯ä¸€ç±»åï¼Œæ ·å¼åµŒå¥—åœ¨é‡Œé¢ï¼‰ã€‚</li>
</ul>
<p><strong>ä¿®å¤ç¤ºä¾‹</strong>ï¼š</p>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- æœª scoped çš„ç»„ä»¶ Xï¼ˆä¿®å¤åï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"component-x"</span>&gt;</span> <span class="hljs-comment">&lt;!-- æ ¹å…ƒç´ åŠ å”¯ä¸€å‘½åç©ºé—´ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span>ç»„ä»¶ X å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-comment">/* åµŒå¥—é€‰æ‹©å™¨ï¼Œåªä½œç”¨äºç»„ä»¶ X å†…éƒ¨ï¼Œä¸å½±å“å…¶ä»–ç»„ä»¶ */</span>
<span class="hljs-selector-class">.component-x</span> <span class="hljs-selector-class">.box</span> {
  <span class="hljs-attribute">color</span>: red;
}
<span class="hljs-selector-class">.component-x</span> <span class="hljs-selector-tag">div</span> { <span class="hljs-comment">/* å³ä½¿æ˜¯æ ‡ç­¾é€‰æ‹©å™¨ï¼Œä¹Ÿè¢«å‘½åç©ºé—´é™åˆ¶ */</span>
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
</li>
<li>
<p><strong>æå‡ scoped ç»„ä»¶æ ·å¼çš„æƒé‡</strong>ï¼š</p>
<ul>
<li>ç»™ scoped ç»„ä»¶çš„æ ·å¼æ·»åŠ æ›´å…·ä½“çš„é€‰æ‹©å™¨ï¼ˆå¦‚åµŒå¥—ç±»åï¼‰ï¼Œæˆ–ç”¨Â <code>!important</code>ï¼ˆè°¨æ…ä½¿ç”¨ï¼Œä»…åœ¨å¿…è¦æ—¶ï¼‰ã€‚</li>
</ul>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-comment">/* æ›´å…·ä½“çš„é€‰æ‹©å™¨ï¼Œæƒé‡æ›´é«˜ */</span>
<span class="hljs-selector-class">.parent</span> <span class="hljs-selector-class">.child</span> {
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span> <span class="hljs-meta">!important</span>; <span class="hljs-comment">/* è¦†ç›–å…¨å±€æ ·å¼ */</span>
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
</li>
<li>
<p><strong>ç»™æœª scoped çš„ç»„ä»¶æ·»åŠ  scopedï¼ˆæ¨èï¼‰</strong> ï¼š</p>
<ul>
<li>é™¤ééœ€è¦å…¨å±€æ ·å¼ï¼Œå¦åˆ™å°½é‡ç»™æ‰€æœ‰ç»„ä»¶éƒ½åŠ Â <code>scoped</code>ï¼Œä»æ ¹æºé¿å…æ ·å¼æ±¡æŸ“ã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-10">æ€»ç»“</h3>
<p><code>scopedÂ çš„éš”ç¦»æ ¸å¿ƒæ˜¯ã€Œå±æ€§ç»‘å®šã€ï¼Œä½†å®ƒç®¡ä¸ä½å…¨å±€çš„æ ‡ç­¾é€‰æ‹©å™¨ã€é€šé…ç¬¦ç­‰å®½æ³›é€‰æ‹©å™¨ã€‚</code>ä½ é‡åˆ°çš„é—®é¢˜ï¼Œæœ¬è´¨æ˜¯æœª scoped ç»„ä»¶çš„å…¨å±€é€‰æ‹©å™¨ â€œè¯¯ä¼¤â€ äº† scoped ç»„ä»¶å†…çš„å…ƒç´  â€”â€” å’Œç±»åæ˜¯å¦ç›¸åŒæ— å…³ï¼Œåªå’Œé€‰æ‹©å™¨çš„åŒ¹é…èŒƒå›´æœ‰å…³ã€‚</p>
<h2 data-id="heading-11">å…¶ä»–å¸¸è§éš”ç¦»æ–¹æ¡ˆ</h2>
<p>åœ¨ Vue ä¸­ï¼Œé™¤äº†Â <code>scoped</code>Â ä¹‹å¤–ï¼Œè¿˜æœ‰å¤šç§æ ·å¼éš”ç¦»æ–¹æ¡ˆï¼Œé€‚ç”¨äºä¸åŒåœºæ™¯ï¼ˆå¦‚å…¨å±€æ ·å¼ç®¡ç†ã€ç»„ä»¶åº“å¼€å‘ã€é¿å…é€‰æ‹©å™¨å†²çªç­‰ï¼‰ã€‚ä»¥ä¸‹æ˜¯å¸¸ç”¨çš„ 5 ç§æ–¹æ³•ï¼š</p>
<h3 data-id="heading-12">1.Â <strong>CSS Modulesï¼ˆCSS æ¨¡å—åŒ–ï¼‰</strong></h3>
<h4 data-id="heading-13">åŸç†ï¼š</h4>
<p>é€šè¿‡ Webpack ç­‰æ„å»ºå·¥å…·ï¼Œå°† CSS ç±»åç¼–è¯‘ä¸º<strong>å”¯ä¸€å“ˆå¸Œå€¼</strong>ï¼ˆå¦‚Â <code>box</code>Â â†’Â <code>_3zyde4l1yATCOkgn-DBWEL</code>ï¼‰ï¼Œç¡®ä¿æ¯ä¸ªç»„ä»¶çš„ç±»ååœ¨å…¨å±€å”¯ä¸€ï¼Œé¿å…å†²çªã€‚ï¼ˆç±»ä¼¼Â <code>scoped</code>ï¼Œä½†éš”ç¦»ç²’åº¦æ˜¯ â€œç±»åâ€ è€Œé â€œå…ƒç´ å±æ€§â€ï¼‰</p>
<h4 data-id="heading-14">ä½¿ç”¨æ–¹å¼ï¼š</h4>
<ul>
<li>æ ·å¼æ–‡ä»¶å‘½åä¸ºÂ <code>xxx.module.css</code>ï¼ˆæˆ–Â <code>xxx.module.scss</code>ï¼‰</li>
<li>åœ¨ç»„ä»¶ä¸­é€šè¿‡Â <code>import</code>Â å¼•å…¥ï¼Œä»¥å¯¹è±¡å½¢å¼ä½¿ç”¨ç±»å</li>
</ul>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ç»„ä»¶ä¸­ä½¿ç”¨ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"styles.box"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"styles.text"</span>&gt;</span>CSS Modules ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> styles <span class="hljs-keyword">from</span> <span class="hljs-string">'./xxx.module.css'</span>; <span class="hljs-comment">// å¼•å…¥æ¨¡å—åŒ–æ ·å¼</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> { styles };
  }
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-comment">&lt;!-- xxx.module.css --&gt;</span>
.box {
  padding: 20px;
  background: #f0f0f0;
}
.text {
  color: #333;
}
</code></pre>
<h4 data-id="heading-15">ç¼–è¯‘åæ•ˆæœï¼š</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"_3zyde4l1yATCOkgn-DBWEL"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"_13lgc6x90aWZ7VQrN5Qx9u"</span>&gt;</span>CSS Modules ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
._3zyde4l1yATCOkgn-DBWEL { <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>; <span class="hljs-attribute">background</span>: <span class="hljs-number">#f0f0f0</span>; }
._13lgc6x90aWZ7VQrN5Qx9u { <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span>; }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h4 data-id="heading-16">é€‚ç”¨åœºæ™¯ï¼š</h4>
<ul>
<li>å¤§å‹é¡¹ç›®ï¼Œéœ€è¦ä¸¥æ ¼éš”ç¦»ç»„ä»¶æ ·å¼ï¼Œé¿å…ç±»åå†²çª</li>
<li>é…åˆé¢„å¤„ç†å™¨ï¼ˆSass/LESSï¼‰ä½¿ç”¨ï¼Œæ”¯æŒåµŒå¥—å’Œå˜é‡</li>
<li>ä¸å¸Œæœ›ä¾èµ–Â <code>scoped</code>Â çš„å±æ€§æ ‡è®°ï¼ˆå¦‚å¯¹ DOM çº¯å‡€åº¦æœ‰è¦æ±‚ï¼‰</li>
</ul>
<h3 data-id="heading-17">2.Â <strong>BEM å‘½åè§„èŒƒï¼ˆæ‰‹åŠ¨éš”ç¦»ï¼Œä¸æ¨èï¼šå†™æ³•éº»çƒ¦ï¼Œå­—åˆå¤šï¼ŒåŠ£åŠ¿å¤§äºä¼˜åŠ¿ï¼‰</strong></h3>
<h4 data-id="heading-18">åŸç†ï¼š</h4>
<p>é€šè¿‡<strong>ç»Ÿä¸€çš„ç±»åå‘½åè§„åˆ™</strong>æ‰‹åŠ¨é¿å…å†²çªï¼Œæ ¸å¿ƒæ˜¯ â€œç»„ä»¶å + å…ƒç´ å + ä¿®é¥°ç¬¦â€ çš„å‘½åæ ¼å¼ï¼Œè®©ç±»åè‡ªå¸¦ â€œä½œç”¨åŸŸâ€ã€‚æ ¼å¼ï¼š<code>block__element--modifier</code>ï¼ˆå—__å…ƒç´  -- ä¿®é¥°ç¬¦ï¼‰</p>
<h4 data-id="heading-19">ä½¿ç”¨æ–¹å¼ï¼š</h4>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- ä»¥ç»„ä»¶åï¼ˆtodo-listï¼‰ä½œä¸º block å‰ç¼€ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"todo-list"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"todo-list__item"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"todo-list__text todo-list__text--completed"</span>&gt;</span>ä»»åŠ¡ 1<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-comment">/* æ‰€æœ‰ç±»åå¸¦ç»„ä»¶å‰ç¼€ï¼Œé¿å…å…¨å±€å†²çª */</span>
<span class="hljs-selector-class">.todo-list</span> { <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>; }
<span class="hljs-selector-class">.todo-list__item</span> { <span class="hljs-attribute">margin</span>: <span class="hljs-number">5px</span> <span class="hljs-number">0</span>; }
<span class="hljs-selector-class">.todo-list__text--completed</span> { <span class="hljs-attribute">text-decoration</span>: line-through; }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h4 data-id="heading-20">é€‚ç”¨åœºæ™¯ï¼š</h4>
<ul>
<li>ä¸­å°å‹é¡¹ç›®ï¼Œä¸æƒ³ä¾èµ–å·¥å…·é“¾ï¼ˆçº¯æ‰‹åŠ¨ç®¡ç†ï¼‰</li>
<li>å›¢é˜Ÿæœ‰ç»Ÿä¸€å‘½åè§„èŒƒï¼Œéœ€è¦å¯è¯»æ€§å¼ºçš„ç±»å</li>
<li>ä¸å…¨å±€æ ·å¼å…±å­˜æ—¶ï¼Œæ˜ç¡®åŒºåˆ†ç»„ä»¶æ ·å¼èŒƒå›´</li>
</ul>
<h3 data-id="heading-21">3.Â <strong>CSS-in-JSï¼ˆæ ·å¼å†™åœ¨ JS ä¸­ï¼‰</strong></h3>
<h4 data-id="heading-22">åŸç†ï¼š</h4>
<p>å°† CSS æ ·å¼ä»¥ JavaScript å¯¹è±¡çš„å½¢å¼ç¼–å†™ï¼Œé€šè¿‡åŠ¨æ€ç”Ÿæˆå”¯ä¸€ç±»åæˆ–å†…è”æ ·å¼å®ç°éš”ç¦»ã€‚å¸¸è§åº“ï¼š<code>styled-components</code>ã€<code>vue-styled-components</code>ã€<code>emotion</code>ã€‚</p>
<h4 data-id="heading-23">ä½¿ç”¨æ–¹å¼ï¼ˆä»¥Â <code>vue-styled-components</code>Â ä¸ºä¾‹ï¼‰ï¼š</h4>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">StyledBox</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">StyledText</span>&gt;</span>CSS-in-JS ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">StyledText</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">StyledBox</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> styled <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-styled-components'</span>;

<span class="hljs-comment">// å®šä¹‰å¸¦æ ·å¼çš„ç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">StyledBox</span> = styled.<span class="hljs-property">div</span><span class="hljs-string">`
  padding: 20px;
  background: #f0f0f0;
`</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title class_">StyledText</span> = styled.<span class="hljs-property">p</span><span class="hljs-string">`
  color: #333;
  font-size: 16px;
`</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">components</span>: { <span class="hljs-title class_">StyledBox</span>, <span class="hljs-title class_">StyledText</span> }
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h4 data-id="heading-24">ç¼–è¯‘åæ•ˆæœï¼š</h4>
<p>è‡ªåŠ¨ç”Ÿæˆå”¯ä¸€ç±»åï¼ˆå¦‚Â <code>sc-bdVaJa</code>ï¼‰ï¼Œæ ·å¼é€šè¿‡Â <code>&lt;style&gt;</code>Â æ ‡ç­¾æ’å…¥å¤´éƒ¨ï¼Œä»…ä½œç”¨äºå¯¹åº”ç»„ä»¶ã€‚</p>
<h4 data-id="heading-25">é€‚ç”¨åœºæ™¯ï¼š</h4>
<ul>
<li>éœ€è¦åŠ¨æ€ç”Ÿæˆæ ·å¼ï¼ˆå¦‚æ ¹æ® props åŠ¨æ€ä¿®æ”¹æ ·å¼ï¼‰</li>
<li>ä¹ æƒ¯ç»„ä»¶åŒ–æ€ç»´ï¼Œå°†æ ·å¼ä¸ç»„ä»¶é€»è¾‘ç´§å¯†ç»“åˆ</li>
<li>å¤§å‹é¡¹ç›®ï¼Œå¸Œæœ›æ ·å¼å®Œå…¨ç”± JS ç®¡ç†ï¼ˆä¾¿äºåŠ¨æ€è®¡ç®—ã€ä¸»é¢˜åˆ‡æ¢ï¼‰</li>
</ul>
<h3 data-id="heading-26">4.Â <strong>ä½œç”¨åŸŸéš”ç¦»ï¼ˆåŸºäº CSS ç‰¹æ€§ï¼Œæ–¹ä¾¿&amp;&amp;è§åä¹‹ä¹‰ï¼‰</strong></h3>
<p>åˆ©ç”¨ CSS åŸç”Ÿç‰¹æ€§æˆ–é¢„å¤„ç†å™¨çš„ â€œä½œç”¨åŸŸâ€ åŠŸèƒ½ï¼Œå®ç°éš”ç¦»ï¼š</p>
<h4 data-id="heading-27">ï¼ˆ1ï¼‰CSS åµŒå¥—ä¸å‘½åç©ºé—´</h4>
<p>é€šè¿‡çˆ¶çº§ç±»ååµŒå¥—æ‰€æœ‰å­æ ·å¼ï¼Œå½¢æˆ â€œå‘½åç©ºé—´éš”ç¦»â€ï¼ˆç±»ä¼¼ BEMï¼Œä½†æ›´ç®€åŒ–ï¼‰ï¼š</p>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"user-card"</span>&gt;</span> <span class="hljs-comment">&lt;!-- å‘½åç©ºé—´ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"title"</span>&gt;</span>ç”¨æˆ·ä¿¡æ¯<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"desc"</span>&gt;</span>è¿™æ˜¯ç”¨æˆ·å¡ç‰‡<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-comment">/* æ‰€æœ‰æ ·å¼åµŒå¥—åœ¨å‘½åç©ºé—´ä¸‹ï¼Œé¿å…å†²çª */</span>
<span class="hljs-selector-class">.user-card</span> {
  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#eee</span>;
  
  <span class="hljs-selector-class">.title</span> { <span class="hljs-attribute">font-size</span>: <span class="hljs-number">18px</span>; }
  <span class="hljs-selector-class">.desc</span> { <span class="hljs-attribute">color</span>: <span class="hljs-number">#666</span>; }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h4 data-id="heading-28">ï¼ˆ2ï¼‰CSS @layerï¼ˆå±‚çº§éš”ç¦»ï¼‰</h4>
<p>é€šè¿‡Â <code>@layer</code>Â å®šä¹‰æ ·å¼å±‚çº§ï¼Œæ§åˆ¶ä¼˜å…ˆçº§ï¼Œé¿å…å…¨å±€æ ·å¼è¦†ç›–ç»„ä»¶æ ·å¼ï¼ˆéœ€è¦æµè§ˆå™¨æ”¯æŒï¼‰ï¼š</p>
<p>css</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">/* å…¨å±€æ ·å¼ */</span>
<span class="hljs-variable">@layer</span> global {
  <span class="hljs-selector-class">.box</span> { <span class="hljs-attribute">color</span>: red; }
}

<span class="hljs-comment">/* ç»„ä»¶æ ·å¼ï¼Œå±‚çº§ä¼˜å…ˆçº§æ›´é«˜ */</span>
<span class="hljs-variable">@layer</span> component {
  <span class="hljs-selector-class">.box</span> { <span class="hljs-attribute">color</span>: blue; }
}
</code></pre>
<h3 data-id="heading-29">5.Â <strong>Shadow DOMï¼ˆå½±å­ DOMï¼Œå®Œå…¨éš”ç¦»ï¼‰</strong></h3>
<p><strong>Shadow DOM æ›´é€‚åˆéœ€è¦Â <strong>å¼ºéš”ç¦»ã€é«˜å°è£…æ€§</strong>Â çš„åœºæ™¯ï¼Œæ ¸å¿ƒæ˜¯è§£å†³ â€œæ ·å¼ / DOM ç»å¯¹ä¸å¹²æ‰°â€ çš„éœ€æ±‚</strong></p>
<h4 data-id="heading-30">åŸç†ï¼š</h4>
<p>åˆ©ç”¨æµè§ˆå™¨åŸç”Ÿçš„ Shadow DOM ç‰¹æ€§ï¼Œåˆ›å»ºä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„ DOM å­æ ‘ï¼Œå…¶å†…éƒ¨æ ·å¼ä¸å¤–éƒ¨å®Œå…¨éš”ç¦»ï¼ˆå¤–éƒ¨æ ·å¼æ— æ³•å½±å“å†…éƒ¨ï¼Œå†…éƒ¨æ ·å¼ä¹Ÿä¸ä¼šæ³„æ¼åˆ°å¤–éƒ¨ï¼‰ã€‚</p>
<h4 data-id="heading-31">ä½¿ç”¨æ–¹å¼ï¼ˆåœ¨ Vue ä¸­éœ€æ‰‹åŠ¨åˆ›å»ºï¼‰ï¼š</h4>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"shadowHost"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="xml">
export default {
  mounted() {
    // åˆ›å»º Shadow DOM
    const shadowRoot = this.$refs.shadowHost.attachShadow({ mode: 'closed' });
    // æ’å…¥ç»„ä»¶å†…å®¹å’Œæ ·å¼
    shadowRoot.innerHTML = `
      <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-class">.box</span> { <span class="hljs-attribute">background</span>: <span class="hljs-number">#f0f0f0</span>; <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>; }
        <span class="hljs-selector-tag">p</span> { <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span>; }
      </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Shadow DOM ç¤ºä¾‹ï¼ˆå®Œå…¨éš”ç¦»ï¼‰<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    `;
  }
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h4 data-id="heading-32">ç‰¹ç‚¹ï¼š</h4>
<ul>
<li>å®Œå…¨éš”ç¦»ï¼šå¤–éƒ¨æ ·å¼æ— æ³•å½±å“ Shadow DOM å†…éƒ¨ï¼Œå†…éƒ¨æ ·å¼ä¹Ÿä¸ä¼šæ±¡æŸ“å…¨å±€</li>
<li>å°é—­æ€§ï¼š<code>mode: 'closed'</code>Â æ—¶ï¼Œå¤–éƒ¨ JS æ— æ³•è®¿é—® Shadow DOM å†…éƒ¨å…ƒç´ </li>
<li>å…¼å®¹æ€§ï¼šç°ä»£æµè§ˆå™¨æ”¯æŒè‰¯å¥½ï¼ŒIE ä¸æ”¯æŒ</li>
</ul>
<h4 data-id="heading-33">é€‚ç”¨åœºæ™¯ï¼š</h4>
<ul>
<li>å¼€å‘ç‹¬ç«‹ç»„ä»¶åº“ï¼ˆå¦‚ UI ç»„ä»¶ï¼‰ï¼Œç¡®ä¿æ ·å¼ä¸å—å¤–éƒ¨ç¯å¢ƒå½±å“</li>
<li>éœ€è¦ä¸¥æ ¼éš”ç¦»çš„åœºæ™¯ï¼ˆå¦‚åµŒå…¥ç¬¬ä¸‰æ–¹å†…å®¹ï¼‰</li>
</ul>
<h3 data-id="heading-34">å„ç§æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰æ‹©å»ºè®®</h3>















































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>éš”ç¦»åŸç†</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><code>scoped</code></td><td>å…ƒç´ æ·»åŠ å”¯ä¸€å±æ€§</td><td>ç®€å•æ˜“ç”¨ï¼ŒVue åŸç”Ÿæ”¯æŒ</td><td>æ— æ³•éš”ç¦»å…¨å±€æ ‡ç­¾é€‰æ‹©å™¨</td><td>å¤§å¤šæ•°æ—¥å¸¸ç»„ä»¶</td></tr><tr><td>CSS Modules</td><td>ç±»åç¼–è¯‘ä¸ºå”¯ä¸€å“ˆå¸Œ</td><td>éš”ç¦»å½»åº•ï¼Œæ”¯æŒé¢„å¤„ç†å™¨</td><td>éœ€è¦æ„å»ºå·¥å…·ï¼Œç±»åå¯è¯»æ€§å·®</td><td>å¤§å‹é¡¹ç›®ï¼Œä¸¥æ ¼éš”ç¦»éœ€æ±‚</td></tr><tr><td>BEM å‘½å</td><td>æ‰‹åŠ¨è§„èŒƒç±»å</td><td>æ— å·¥å…·ä¾èµ–ï¼Œç±»åå¯è¯»</td><td>ç±»åå†—é•¿ï¼Œä¾èµ–å›¢é˜Ÿè§„èŒƒ</td><td>ä¸­å°å‹é¡¹ç›®ï¼Œå›¢é˜Ÿåä½œ</td></tr><tr><td>CSS-in-JS</td><td>JS åŠ¨æ€ç”Ÿæˆå”¯ä¸€ç±»å</td><td>æ ·å¼åŠ¨æ€æ€§å¼ºï¼Œä¸ç»„ä»¶é€»è¾‘ç»“åˆç´§å¯†</td><td>å¢åŠ  JS ä½“ç§¯ï¼Œå­¦ä¹ æˆæœ¬é«˜</td><td>åŠ¨æ€æ ·å¼éœ€æ±‚ï¼Œç»„ä»¶åº“å¼€å‘</td></tr><tr><td>Shadow DOM</td><td>æµè§ˆå™¨åŸç”Ÿéš”ç¦»æœºåˆ¶</td><td>å®Œå…¨éš”ç¦»ï¼Œä¸ä¾èµ– CSS è§„åˆ™</td><td>å…¼å®¹æ€§æœ‰é™ï¼Œçµæ´»æ€§ä½</td><td>ç‹¬ç«‹ç»„ä»¶åº“ï¼Œå¼ºéš”ç¦»éœ€æ±‚</td></tr></tbody></table>
<p>æ ¹æ®é¡¹ç›®è§„æ¨¡å’Œéœ€æ±‚é€‰æ‹©ï¼š</p>
<ul>
<li>æ—¥å¸¸å¼€å‘ï¼šä¼˜å…ˆÂ <code>scoped</code>Â æˆ– CSS Modules</li>
<li>å›¢é˜Ÿåä½œï¼šBEM å‘½åè§„èŒƒæ›´æ˜“ç»´æŠ¤</li>
<li>åŠ¨æ€æ ·å¼ï¼šCSS-in-JS æ›´åˆé€‚</li>
<li>å¼ºéš”ç¦»éœ€æ±‚ï¼šShadow DOM æ˜¯ç»ˆææ–¹æ¡ˆ</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ«å‡½æ•°çš„â€œä¸¤é¢æ´¾â€äººç”Ÿï¼šæ·±åº¦å‰–æç®­å¤´å‡½æ•°å¦‚ä½•ä¸€åŠ³æ°¸é€¸åœ°è§£å†³ â€˜thisâ€™ çš„äºŒä¹‰æ€§]]></title>    <link>https://juejin.cn/post/7570902473432481792</link>    <guid>https://juejin.cn/post/7570902473432481792</guid>    <pubDate>2025-11-10T08:58:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570902473432481792" data-draft-id="7570793903848161295" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ«å‡½æ•°çš„â€œä¸¤é¢æ´¾â€äººç”Ÿï¼šæ·±åº¦å‰–æç®­å¤´å‡½æ•°å¦‚ä½•ä¸€åŠ³æ°¸é€¸åœ°è§£å†³ â€˜thisâ€™ çš„äºŒä¹‰æ€§"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-11-10T08:58:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æŸšæ±"/> <meta itemprop="url" content="https://juejin.cn/user/2529319920106776"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ«å‡½æ•°çš„â€œä¸¤é¢æ´¾â€äººç”Ÿï¼šæ·±åº¦å‰–æç®­å¤´å‡½æ•°å¦‚ä½•ä¸€åŠ³æ°¸é€¸åœ°è§£å†³ â€˜thisâ€™ çš„äºŒä¹‰æ€§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2529319920106776/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æŸšæ±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T08:58:57.000Z" title="Mon Nov 10 2025 08:58:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œä¸ºä¸€å å‰ç«¯å¼€å‘ï¼Œä½ æ˜¯å¦æ›¾åœ¨æ·±å¤œè°ƒè¯•æ—¶ï¼Œå¯¹ç€ <code>this</code> çš„å€¼å‘å‡ºçµé­‚æ‹·é—®ï¼šâ€œä½ åˆ°åº•æ˜¯è°ï¼Ÿâ€ ä½ æ˜¯å¦æ›¾è¢«å›è°ƒå‡½æ•°ä¸­â€œä¸¢å¤±â€çš„ <code>this</code> é€¼åˆ°ç»å¢ƒï¼Ÿè¿™ä¸€åˆ‡çš„æ ¹æºï¼Œéƒ½æ¥è‡ªäº <strong>æ™®é€šå‡½æ•°ä¸­ <code>this</code> ä»¤äººå›°æƒ‘çš„äºŒä¹‰æ€§</strong>ã€‚</p>
<p>ES6 ç®­å¤´å‡½æ•°çš„å‡ºç°ï¼Œå¹¶éä»…ä»…æ˜¯è¯­æ³•ç³–ï¼Œå®ƒæ˜¯ä¸€åœºæ—¨åœ¨ <strong>è§£å†³å‡½æ•°äºŒä¹‰æ€§</strong> çš„å“²å­¦é©å‘½ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥å½»åº•è®²æ¸…æ¥šï¼Œç®­å¤´å‡½æ•°å¦‚ä½•è®©æˆ‘ä»¬å‘Šåˆ«å‡½æ•°çš„â€œä¸¤é¢æ´¾â€äººç”Ÿã€‚</p>
<h3 data-id="heading-0">ä¸€ã€ ä»€ä¹ˆæ˜¯å‡½æ•°çš„â€œäºŒä¹‰æ€§â€ï¼Ÿ</h3>
<p>åœ¨æ™®é€šå‡½æ•°ä¸­ï¼Œ<code>this</code> çš„å€¼æ˜¯åœ¨<strong>å‡½æ•°è¢«è°ƒç”¨æ—¶</strong>åŠ¨æ€ç»‘å®šçš„ã€‚å®ƒå°±åƒä¸€ä¸ªâ€œå˜è‰²é¾™â€ï¼Œå…¶æŒ‡å‘å®Œå…¨å–å†³äºå‡½æ•°çš„è°ƒç”¨æ–¹å¼ã€‚è¿™å°±æ˜¯æ‰€è°“çš„â€œäºŒä¹‰æ€§â€ï¼ˆæˆ–å¤šä¹‰æ€§ï¼‰â€”â€”åœ¨å‡½æ•°å®šä¹‰æ—¶ï¼Œä½ æ— æ³•ç™¾åˆ†ç™¾ç¡®å®š <code>this</code> æ˜¯è°ï¼Œå¿…é¡»æ ¹æ®è°ƒç”¨ä¸Šä¸‹æ–‡æ¥åˆ¤æ–­ã€‚</p>
<p>è¿™ç§åŠ¨æ€æ€§å¯¼è‡´äº†æ— æ•°çš„ Bug å’Œå¿ƒæ™ºè´Ÿæ‹…ã€‚ä¸»è¦ä½“ç°ä¸ºï¼š</p>
<ol>
<li><strong>é»˜è®¤ç»‘å®š</strong>ï¼šåœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œç›´æ¥è°ƒç”¨å‡½æ•°ï¼Œ<code>this</code> æŒ‡å‘ <code>window</code>ï¼ˆæµè§ˆå™¨ä¸­ï¼‰ï¼›ä¸¥æ ¼æ¨¡å¼ä¸‹ä¸º <code>undefined</code>ã€‚</li>
<li><strong>éšå¼ç»‘å®š</strong>ï¼šå‡½æ•°ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œ<code>this</code> æŒ‡å‘è¯¥å¯¹è±¡ã€‚</li>
<li><strong>æ˜¾å¼ç»‘å®š</strong>ï¼šé€šè¿‡ <code>call</code>, <code>apply</code>, <code>bind</code> æ–¹æ³•å¼ºåˆ¶æŒ‡å®š <code>this</code>ã€‚</li>
<li><strong><code>new</code> ç»‘å®š</strong>ï¼šä½¿ç”¨ <code>new</code> æ“ä½œç¬¦è°ƒç”¨æ„é€ å‡½æ•°æ—¶ï¼Œ<code>this</code> æŒ‡å‘æ–°åˆ›å»ºçš„å®åŠ›ã€‚</li>
</ol>
<p>è¿™ç§â€œå¤šé‡èº«ä»½â€æ˜¯ JavaScript çµæ´»æ€§çš„ä½“ç°ï¼Œä½†ä¹Ÿæ­£æ˜¯æ··ä¹±çš„æ ¹æºã€‚</p>
<h3 data-id="heading-1">äºŒã€ ç®­å¤´å‡½æ•°ï¼š<code>this</code> ç»‘å®šçš„â€œå®šæµ·ç¥é’ˆâ€</h3>
<p>ç®­å¤´å‡½æ•°çš„æ ¸å¿ƒç†å¿µä¹‹ä¸€å°±æ˜¯ï¼š<strong>æ¶ˆé™¤ <code>this</code> çš„äºŒä¹‰æ€§</strong>ã€‚
å®ƒé€šè¿‡ä¸€ä¸ªç®€å•çš„è§„åˆ™å®ç°äº†è¿™ä¸€ç‚¹ï¼š</p>
<p><strong>ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ <code>this</code>ã€‚å®ƒå†…éƒ¨çš„ <code>this</code> å€¼ç»§æ‰¿è‡ªå…¶å®šä¹‰æ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯å¤–å±‚ä»£ç å—çš„ <code>this</code>ã€‚å¹¶ä¸”ä¸€æ—¦ç»‘å®šï¼Œç»ˆèº«ä¸å˜ã€‚</strong></p>
<p><strong>è¿™è¢«ç§°ä¸º â€œè¯æ³•ä½œç”¨åŸŸ <code>this</code>â€</strong> æˆ– <strong>â€œé™æ€ç»‘å®š <code>this</code>â€ã€‚</strong></p>
<h5 data-id="heading-2">æ·±åº¦å¯¹æ¯”ï¼šä¸€ä¸ªç»å…¸çš„ <code>this</code> é™·é˜±</h5>
<p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªåœ¨å‰ç«¯å¼€å‘ä¸­å¸ç©ºè§æƒ¯çš„åœºæ™¯ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Counter</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-number">0</span>;
  }

  <span class="hljs-comment">// ä½¿ç”¨æ™®é€šå‡½æ•°</span>
  <span class="hljs-title function_">startWithNormal</span>(<span class="hljs-params"/>) {
    <span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">// è¿™ä¸ª `this` æ˜¯ setInterval è°ƒç”¨è¿™ä¸ªæ™®é€šå‡½æ•°æ—¶çš„ `this`ï¼Œé»˜è®¤æŒ‡å‘ window/undefined</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Normal:'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>); <span class="hljs-comment">// è¾“å‡ºï¼šNormal: NaN (æˆ–ç›´æ¥æŠ¥é”™)</span>
    }, <span class="hljs-number">1000</span>);
  }

  <span class="hljs-comment">// ä½¿ç”¨ç®­å¤´å‡½æ•°</span>
  <span class="hljs-title function_">startWithArrow</span>(<span class="hljs-params"/>) {
    <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// è¿™ä¸ª `this` ç»§æ‰¿è‡ª startWithArrow æ–¹æ³•ï¼Œè€Œè¯¥æ–¹æ³•è¢« Counter å®ä¾‹è°ƒç”¨ï¼Œæ‰€ä»¥ this æŒ‡å‘ Counter å®ä¾‹</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Arrow:'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>); <span class="hljs-comment">// è¾“å‡ºï¼šArrow: 1, Arrow: 2, ...</span>
    }, <span class="hljs-number">1000</span>);
  }
}

<span class="hljs-keyword">const</span> myCounter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Counter</span>();
<span class="hljs-comment">// myCounter.startWithNormal(); // é”™è¯¯ï¼</span>
myCounter.<span class="hljs-title function_">startWithArrow</span>(); <span class="hljs-comment">// æ­£ç¡®ï¼</span>
</code></pre>
<p><strong>æ·±åº¦è§£æï¼š</strong></p>
<ul>
<li><strong><code>startWithNormal</code></strong>: <code>setInterval</code> çš„å›è°ƒæ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ã€‚å½“å®ƒè¢« <code>setInterval</code> è°ƒç”¨æ—¶ï¼Œæ‰§è¡Œçš„æ˜¯<strong>é»˜è®¤ç»‘å®š</strong>è§„åˆ™ã€‚åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼ˆES6 class é»˜è®¤ä¸ºä¸¥æ ¼æ¨¡å¼ï¼‰ï¼Œ<code>this</code> ä¸º <code>undefined</code>ï¼Œè®¿é—® <code>undefined.count</code> è‡ªç„¶å¯¼è‡´ <code>NaN</code> æˆ–é”™è¯¯ã€‚</li>
<li><strong><code>startWithArrow</code></strong>: ç®­å¤´å‡½æ•°åœ¨å®šä¹‰æ—¶ï¼Œå°±ç¡®å®šäº† <code>this</code> çš„å€¼ã€‚å®ƒå¯»æ‰¾å¤–å±‚ä½œç”¨åŸŸ <code>startWithArrow</code> çš„ <code>this</code>ã€‚ç”±äº <code>startWithArrow</code> æ˜¯ä½œä¸º <code>myCounter</code> å®ä¾‹çš„æ–¹æ³•è¢«è°ƒç”¨çš„ï¼Œæ‰€ä»¥å®ƒçš„ <code>this</code> æŒ‡å‘ <code>myCounter</code>ã€‚è¿™ä¸ªå…³ç³»åœ¨ç®­å¤´å‡½æ•°è¯ç”Ÿçš„ä¸€åˆ»å°±è¢«â€œé”å®šâ€äº†ï¼Œæ— è®ºä¹‹åè°è°ƒç”¨å®ƒï¼Œ<code>this</code> éƒ½é›·æ‰“ä¸åŠ¨ã€‚</li>
</ul>
<p><strong>è¿™ï¼Œå°±æ˜¯è§£å†³äºŒä¹‰æ€§çš„åŠ›é‡ï¼</strong> ä½ å†ä¹Ÿä¸éœ€è¦ <code>const that = this</code>ã€<code>.bind(this)</code> è¿™ç§ Hack æ‰‹æ®µäº†ã€‚</p>
<h3 data-id="heading-3">ä¸‰ã€ ç®­å¤´å‡½æ•°ä¸æ™®é€šå‡½æ•°çš„å…¨æ–¹ä½åŒºåˆ«</h3>
<p>é™¤äº† <code>this</code> ç»‘å®šè¿™ä¸ªæœ€æ ¸å¿ƒçš„åŒºåˆ«ï¼ŒäºŒè€…åœ¨å…¶ä»–æ–¹é¢ä¹Ÿæ³¾æ¸­åˆ†æ˜ã€‚ç†è§£è¿™äº›ï¼Œèƒ½è®©ä½ åœ¨æ­£ç¡®çš„åœ°æ–¹ä½¿ç”¨æ­£ç¡®çš„å·¥å…·ã€‚</p>








































<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">æ™®é€šå‡½æ•°</th><th align="left">ç®­å¤´å‡½æ•°</th></tr></thead><tbody><tr><td align="left"><strong><code>this</code> ç»‘å®š</strong></td><td align="left">åŠ¨æ€ç»‘å®šï¼Œç”±è°ƒç”¨æ–¹å¼å†³å®š</td><td align="left">é™æ€ç»‘å®šï¼Œç»§æ‰¿è‡ªå¤–å±‚ä½œç”¨åŸŸ</td></tr><tr><td align="left"><strong><code>arguments</code> å¯¹è±¡</strong></td><td align="left">æœ‰è‡ªå·±çš„ <code>arguments</code> å¯¹è±¡</td><td align="left"><strong>æ²¡æœ‰</strong>è‡ªå·±çš„ <code>arguments</code> å¯¹è±¡ï¼Œéœ€ä»å¤–å±‚è·å–</td></tr><tr><td align="left"><strong><code>prototype</code> å±æ€§</strong></td><td align="left">æœ‰ <code>prototype</code> å±æ€§ï¼Œå¯ç”¨äº <code>new</code></td><td align="left"><strong>æ²¡æœ‰</strong> <code>prototype</code> å±æ€§ï¼Œ<strong>ä¸èƒ½</strong>ç”¨ä½œæ„é€ å‡½æ•°</td></tr><tr><td align="left"><strong><code>yield</code> å‘½ä»¤</strong></td><td align="left">å¯ä»¥ä½œä¸º Generator å‡½æ•°</td><td align="left"><strong>ä¸èƒ½</strong>ä½¿ç”¨ <code>yield</code> å‘½ä»¤ï¼Œä¸èƒ½ä½œä¸º Generator å‡½æ•°</td></tr><tr><td align="left"><strong>è¯­æ³•</strong></td><td align="left"><code>function name() {}</code></td><td align="left"><code>(params) =&gt; { body }</code>ï¼Œç®€æ´ï¼Œå¯éšå¼è¿”å›</td></tr><tr><td align="left"><strong>ä½œä¸ºæ–¹æ³•</strong></td><td align="left">é€‚åˆä½œä¸ºå¯¹è±¡æ–¹æ³•ï¼Œ<code>this</code> æŒ‡å‘å¯¹è±¡</td><td align="left"><strong>ä¸é€‚åˆ</strong>ä½œä¸ºå¯¹è±¡æ–¹æ³•ï¼Œ<code>this</code> å¯èƒ½æŒ‡å‘å…¨å±€</td></tr></tbody></table>
<h4 data-id="heading-4">é‡ç‚¹è§£è¯»ï¼š</h4>
<ol>
<li>
<p><strong>æ²¡æœ‰ <code>arguments</code></strong>:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">normal</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>[<span class="hljs-number">0</span>]); }
<span class="hljs-keyword">const</span> <span class="hljs-title function_">arrow</span> = (<span class="hljs-params"/>) =&gt; { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>[<span class="hljs-number">0</span>]); } <span class="hljs-comment">// æŠ¥é”™ï¼šarguments is not defined</span>

<span class="hljs-title function_">normal</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">// 1</span>
<span class="hljs-title function_">arrow</span>(<span class="hljs-number">1</span>);  <span class="hljs-comment">// Error</span>

<span class="hljs-comment">// ç®­å¤´å‡½æ•°ä¸­å¯ä»¥ä½¿ç”¨ Rest parameters æ›¿ä»£</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">arrowWithRest</span> = (<span class="hljs-params">...args</span>) =&gt; { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(args[<span class="hljs-number">0</span>]); }
<span class="hljs-title function_">arrowWithRest</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">// 1</span>
</code></pre>
</li>
<li>
<p><strong>ä¸èƒ½ä½¿ç”¨ <code>new</code></strong>:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">NormalFunc</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">const</span> <span class="hljs-title function_">ArrowFunc</span> = (<span class="hljs-params"/>) =&gt; {};

<span class="hljs-keyword">const</span> n = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NormalFunc</span>(); <span class="hljs-comment">// OK</span>
<span class="hljs-keyword">const</span> a = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrowFunc</span>();  <span class="hljs-comment">// TypeError: ArrowFunc is not a constructor</span>
</code></pre>
<p>å› ä¸ºç®­å¤´å‡½æ•°æ²¡æœ‰ <code>[[Construct]]</code> å†…éƒ¨æ–¹æ³•å’Œ <code>prototype</code> å±æ€§ï¼Œè¿™æ˜¯è¯­è¨€å±‚é¢çš„é™åˆ¶ã€‚</p>
</li>
</ol>
<h3 data-id="heading-5">å››ã€ å¦‚ä½•é€‰æ‹©ï¼šå›å½’æœ¬è´¨ï¼ŒæŒ‰éœ€ç´¢å–</h3>
<p>ç†è§£äº†åŒºåˆ«ï¼Œé€‰æ‹©å°±å˜å¾—ç®€å•ï¼š</p>
<ul>
<li>
<p><strong>ä½¿ç”¨ç®­å¤´å‡½æ•°çš„åœºæ™¯</strong>ï¼š</p>
<ul>
<li>éœ€è¦ç»§æ‰¿å¤–å±‚ <code>this</code> çš„åœºæ™¯ï¼ˆå¦‚å›è°ƒã€å®šæ—¶å™¨ã€äº‹ä»¶å¤„ç†å™¨ï¼‰ã€‚</li>
<li>ä¸éœ€è¦è‡ªèº« <code>this</code>ã€<code>arguments</code>ã€<code>super</code> æˆ– <code>new.target</code> çš„å‡½æ•°ã€‚</li>
<li>ç®€å•çš„ã€çº¯è®¡ç®—çš„å‡½æ•°ï¼ˆåˆ©ç”¨å…¶ç®€æ´è¯­æ³•ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>ä½¿ç”¨æ™®é€šå‡½æ•°çš„åœºæ™¯</strong>ï¼š</p>
<ul>
<li>éœ€è¦åŠ¨æ€ <code>this</code> çš„åœºæ™¯ï¼ˆå¦‚å¯¹è±¡æ–¹æ³•ã€éœ€è¦è¢« <code>call/apply</code> çš„å‡½æ•°ï¼‰ã€‚</li>
<li>éœ€è¦ä½œä¸º<strong>æ„é€ å‡½æ•°</strong>ä½¿ç”¨ã€‚</li>
<li>éœ€è¦åœ¨å…¶å†…éƒ¨ä½¿ç”¨ <code>arguments</code> å¯¹è±¡ï¼ˆå°½ç®¡ Rest parameters æ˜¯æ›´å¥½çš„æ›¿ä»£ï¼‰ã€‚</li>
<li>éœ€è¦ä½œä¸º <strong>Generator å‡½æ•°</strong>ã€‚</li>
</ul>
</li>
</ul>
<p><strong>ç‰¹åˆ«æé†’</strong>ï¼šåœ¨ Vue æˆ– React ä¸­ï¼Œç±»ç»„ä»¶çš„æ–¹æ³•å¦‚æœéœ€è¦ä½¿ç”¨ <code>this</code> è®¿é—®ç»„ä»¶å®ä¾‹ï¼Œåº”ä½¿ç”¨æ™®é€šå‡½æ•°å¹¶è§†æƒ…å†µç»‘å®šï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨<strong>ç±»å­—æ®µ+ç®­å¤´å‡½æ•°</strong>çš„æ–¹å¼æ¥å®šä¹‰æ–¹æ³•ï¼Œä¸€åŠ³æ°¸é€¸ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> {
  <span class="hljs-comment">// æ–¹å¼ä¸€ï¼šç±»å­—æ®µ + ç®­å¤´å‡½æ•° (æ¨è)</span>
  handleClick = <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// æ°¸è¿œæŒ‡å‘ç»„ä»¶å®ä¾‹</span>
  };

  <span class="hljs-comment">// æ–¹å¼äºŒï¼šæ™®é€šå‡½æ•°ï¼Œéœ€åœ¨æ„é€ å‡½æ•°ä¸­ç»‘å®šæˆ–ä½¿ç”¨æ—¶ç»‘å®š</span>
  <span class="hljs-title function_">handleHover</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// å¦‚æœä¸ç»‘å®šï¼Œå¯èƒ½æ˜¯ undefined</span>
  }

  <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.handleClick}</span>&gt;</span>Click Me<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
  }
}
</code></pre>
<h3 data-id="heading-6">äº”ã€ æ€»ç»“ï¼šä»â€œæ··æ²Œâ€åˆ°â€œç§©åºâ€</h3>
<p>ç®­å¤´å‡½æ•°ä¸ä»…ä»…æ˜¯ä¸€ä¸ªè¯­æ³•ä¸Šçš„è¿›æ­¥ï¼Œå®ƒæ›´æ˜¯ JavaScript è¯­è¨€è®¾è®¡æ€æƒ³çš„ä¸€æ¬¡è¿›åŒ–ã€‚å®ƒé€šè¿‡ <strong>â€œè¯æ³•ä½œç”¨åŸŸ <code>this</code>â€</strong> è¿™ä¸€æ¸…æ™°ã€ç¡®å®šçš„è§„åˆ™ï¼Œå°†å‡½æ•°ä» <code>this</code> ç»‘å®šçš„â€œæ··æ²Œâ€ä¸â€œäºŒä¹‰æ€§â€ä¸­è§£æ”¾å‡ºæ¥ã€‚</p>
<p>å®ƒå‘Šè¯‰æˆ‘ä»¬ï¼Œå¹¶éæ‰€æœ‰å‡½æ•°éƒ½éœ€è¦ä¸€ä¸ªåŠ¨æ€çš„ã€ä¸è°ƒç”¨è€…è€¦åˆçš„ <code>this</code>ã€‚å¯¹äºå¤§é‡åªéœ€è¦æ‰§è¡Œé€»è¾‘ã€ä¸å…³å¿ƒè°ƒç”¨è€…çš„å‡½æ•°æ¥è¯´ï¼Œä¸€ä¸ªç¡®å®šçš„ã€å¯é¢„æµ‹çš„ <code>this</code> æ‰æ˜¯çœŸæ­£çš„ç¦éŸ³ã€‚</p>
<p>æ‰€ä»¥ï¼Œä¸‹æ¬¡å½“ä½ æ‹¿èµ·â€œå‡½æ•°â€è¿™æŠŠç‘å£«å†›åˆ€æ—¶ï¼Œè¯·å…ˆé—®è‡ªå·±ï¼šæˆ‘éœ€è¦çš„æ˜¯ä¸€ä¸ªâ€œå˜è‰²é¾™â€èˆ¬çš„æ™®é€šå‡½æ•°ï¼Œè¿˜æ˜¯ä¸€ä¸ªâ€œç£çŸ³â€èˆ¬çš„ç®­å¤´å‡½æ•°ï¼Ÿç­”æ¡ˆï¼Œå·²ç„¶åœ¨ä½ å¿ƒä¸­ã€‚</p>
<hr/>
<p>å¸Œæœ›è¿™ç¯‡æœ‰æ·±åº¦å’Œå¹¿åº¦çš„æ–‡ç« èƒ½å¸®åŠ©ä½ å½»åº•ç†è§£ç®­å¤´å‡½æ•°çš„æ ¸å¿ƒä»·å€¼ï¼å¦‚æœè§‰å¾—æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµã€æ”¶è—å’Œåˆ†äº«ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å…è´¹çš„ Vibe Coding åŠ©æ‰‹ï¼Ÿä½ æƒ³è¦çš„Gemini CLI éƒ½æœ‰]]></title>    <link>https://juejin.cn/post/7570769486707540006</link>    <guid>https://juejin.cn/post/7570769486707540006</guid>    <pubDate>2025-11-10T09:00:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570769486707540006" data-draft-id="7570903763720962058" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å…è´¹çš„ Vibe Coding åŠ©æ‰‹ï¼Ÿä½ æƒ³è¦çš„Gemini CLI éƒ½æœ‰"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-11-10T09:00:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¯¥ç”¨æˆ·å·²ä¸å­˜åœ¨"/> <meta itemprop="url" content="https://juejin.cn/user/64217584778579"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å…è´¹çš„ Vibe Coding åŠ©æ‰‹ï¼Ÿä½ æƒ³è¦çš„Gemini CLI éƒ½æœ‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/64217584778579/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¯¥ç”¨æˆ·å·²ä¸å­˜åœ¨
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T09:00:21.000Z" title="Mon Nov 10 2025 09:00:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤©ä¸‹è‹¦ Claude ä¹…çŸ£ã€‚</p>
<p>9æœˆä»½ Anthropic å°ç¦ä¸­å›½ç”¨æˆ·ä½¿ç”¨ Claudeï¼Œç›´æ¥åœ¨å®˜ç½‘æŠŠä¸­å›½æˆä¸ºæ•Œå¯¹å›½å®¶ï¼ˆadversarial nationsï¼‰ï¼Œæ€åº¦æå…¶æ¶åŠ£ã€‚å¾ˆå¤šä¸­å›½ç”¨æˆ·éƒ½è¢«æ¶å¿ƒåˆ°äº†ï¼ŒèŠ±é’±è¿˜è¦è¢«æ­§è§†ï¼Ÿ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/246a594b446e4290b57eed586e40a62a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763370021&amp;x-signature=UYJ%2Fz1QEyJbXAohx%2F8G5uwtUrzI%3D" alt="" loading="lazy"/></p>
<p>å…³é”®æ˜¯ Claude Code è¿˜ä¸ä¾¿å®œï¼Œ20ç¾åˆ€èµ·æ­¥ï¼Œä¸“ä¸šç‰ˆéœ€è¦200åˆ€ã€‚å°±ç®—èŠ±äº†200åˆ€ï¼ŒClaude Code è¿˜é™æ™ºäº†ã€‚</p>
<p>è¿™æ—¶å€™ï¼Œè¿™ä¸ª Claude Code ä¸ç”¨å°±ä¸ç”¨äº†å‘—ï¼Œå¯ä»¥è½¬å…¶ä»–æ›¿ä»£å“ã€‚æ—©åœ¨6æœˆä»½è°·æ­Œå°±æ¨å‡ºäº† Gemini CLIï¼Œå…è´¹ä¸”æ²¡æœ‰é™åˆ¶ï¼Œç•Œé¢å‡ ä¹ä¸€æ ·ï¼ŒåŠŸèƒ½ä¹Ÿå·®ä¸å¤šï¼Œå¯¹ Claude Code çš„é™ç»´æ‰“å‡»ã€‚</p>
<ul>
<li>
<p>å…è´¹å¥—é¤ï¼šä½¿ç”¨ä¸ªäºº Google å¸æˆ·ï¼Œæ¯åˆ†é’Ÿ 60 ä¸ªè¯·æ±‚ï¼Œæ¯å¤© 1,000 ä¸ªè¯·æ±‚</p>
</li>
<li>
<p>Gemini 2.5 Proï¼šè®¿é—® 1M ä»¤ç‰Œä¸Šä¸‹æ–‡çª—å£</p>
</li>
<li>
<p>å†…ç½®å·¥å…·ï¼šGoogle æœç´¢åŸºç¡€ã€æ–‡ä»¶æ“ä½œã€shell å‘½ä»¤ã€ç½‘é¡µæŠ“å–</p>
</li>
<li>
<p>å¯æ‰©å±•ï¼šMCPï¼ˆæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼‰æ”¯æŒè‡ªå®šä¹‰é›†æˆ</p>
</li>
<li>
<p>Terminal-firstï¼šä¸“ä¸ºä½¿ç”¨å‘½ä»¤è¡Œçš„å¼€å‘äººå‘˜è®¾è®¡</p>
</li>
<li>
<p>å¼€æºï¼šApache 2.0 è®¸å¯</p>
</li>
</ul>
<h2 data-id="heading-0">å¦‚ä½•å®‰è£…Gemini CLI</h2>
<p>Gemini CLI çš„è¿è¡Œæ¡ä»¶æ˜¯éœ€è¦ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.servbay.com%2Ffeatures%2Fnodejs" target="_blank" title="https://www.servbay.com/features/nodejs" ref="nofollow noopener noreferrer">Node.js 20</a> æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæ‰€ä»¥ç”¨ ServBay å¿«é€Ÿå®‰è£…éœ€è¦çš„ç¯å¢ƒã€‚</p>
<h3 data-id="heading-1">å‰æœŸå‡†å¤‡</h3>
<p>ä»å®˜ç½‘ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.servbay.com%25EF%25BC%2589%25E4%25B8%258B%25E8%25BD%25BD%25E5%25B9%25B6%25E5%25AE%2589%25E8%25A3%2585%25E5%25A5%25BD" target="_blank" title="https://www.servbay.com%EF%BC%89%E4%B8%8B%E8%BD%BD%E5%B9%B6%E5%AE%89%E8%A3%85%E5%A5%BD" ref="nofollow noopener noreferrer">www.servbay.comï¼‰ä¸‹è½½å¹¶å®‰è£…å¥½</a> ServBay</p>
<p>å·¦è¾¹çš„èœå•ä¸­é€‰æ‹©ã€Œè½¯ä»¶åŒ…ã€ï¼Œé€‰æ‹© Node.js ï¼Œç‚¹å‡»éœ€è¦çš„ç‰ˆæœ¬å®‰è£…å³å¯ã€‚å…¨ç¨‹1åˆ†é’Ÿæå®šã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7cb64af471464e89a92b2907372e12fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763370021&amp;x-signature=DDGsRxoA1Lum2I1raeroLTGh63o%3D" alt="" loading="lazy"/></p>
<p>è¿™é‡Œè¦æ³¨æ„ï¼Œè¦é€‰æ‹©ç‰ˆæœ¬18ä»¥ä¸Šçš„æ‰è¡Œã€‚</p>
<p>æ¥ç€åœ¨ç»ˆç«¯éªŒè¯ä¸€ä¸‹ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.servbay.com" target="_blank" title="https://www.servbay.com" ref="nofollow noopener noreferrer">Node.js ç¯å¢ƒ</a>æ˜¯å¦å‡†å¤‡å¥½äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fbb0360b64cf4b4591bed6350b24c4c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763370021&amp;x-signature=71pCWd7GatvUQDn%2BzA4oJYyLeR4%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-2">å¿«é€Ÿå®‰è£… Gemini CLI</h3>
<p>ç¯å¢ƒå‡†å¤‡å¥½äº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å®‰è£… Gemini CLI äº†ã€‚</p>
<p>å…ˆè¿è¡Œ CLIï¼Œåœ¨ç»ˆç«¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">npx https:<span class="hljs-comment">//github.com/google-gemini/gemini-cli</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/edc7efd2b2b74d65a98cc17c4fbd3bab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763370021&amp;x-signature=72NvPTrq8t4qrKKJFzm60sULy9k%3D" alt="" loading="lazy"/></p>
<p>é€‰æ‹©ä¸€ä¸ªè‡ªå·±å–œæ¬¢çš„ä¸»é¢˜é¢œè‰²</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/301c8a2fde624db79530000c731b21fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763370021&amp;x-signature=Bc4xpCBjGL3S5XWQ3ZfDcncWWK4%3D" alt="" loading="lazy"/></p>
<p>æ¥ç€èº«ä»½éªŒè¯ï¼Œç”¨è‡ªå·±çš„ä¸ªäºº Google å¸æˆ·ç™»å½•å°±å¥½äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2995f916fc09499380bb436993b24654~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763370021&amp;x-signature=Ml2fJYyBLu3Px5LvQiWAKLBjrFY%3D" alt="" loading="lazy"/></p>
<p>ç¨ç­‰ç‰‡åˆ»ï¼Œå®‰è£…å®Œæˆã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e8ea7bb731224e3aae589ec965f1307b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763370021&amp;x-signature=opyz1vfvq%2BjdNcWzf6qcZnc7%2FeE%3D" alt="" loading="lazy"/></p>
<p>ç°åœ¨å°±å¯ä»¥ä½¿ç”¨ Gemini CLI äº†ï¼Œå…¨ç¨‹ä¸åˆ°5åˆ†é’Ÿï¼Œéå¸¸ç®€å•ã€‚</p>
<p>å¦‚æœè¿˜éœ€è¦ä½¿ç”¨ç‰¹å®šæ¨¡å‹æˆ–éœ€è¦æ›´é«˜çš„è¯·æ±‚å®¹é‡ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ API å¯†é’¥</p>
<pre><code class="hljs language-ini" lang="ini">export <span class="hljs-attr">GEMINI_API_KEY</span>=<span class="hljs-string">"YOUR_API_KEY"</span>
</code></pre>
<h2 data-id="heading-3">å®é™…ä½¿ç”¨åœºæ™¯</h2>
<p>æˆ‘ä»¬å¯ä»¥æ¥çœ‹çœ‹å®é™…ä½¿ç”¨çš„æ•ˆæœã€‚ä»ç®€å•çš„å¼€å§‹ã€‚</p>
<p>æˆ‘è®© Gemini CLI åˆ†ægithubçš„ç½‘å€ï¼Œç„¶åå¸®æˆ‘ç”Ÿæˆä¸€ä¸ªPPTã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/56b616406cfc426bb76f73eee3aa5e60~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763370021&amp;x-signature=JFPC7Jb2XaDZRZPYfWzpncfX%2F50%3D" alt="" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒGeminiä¼šè¯·æ±‚æƒé™ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c3b301fe7db043aea9f1c6873e1cc633~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763370021&amp;x-signature=y9xEiHdlteH49Cewr99D5LFHOlE%3D" alt="" loading="lazy"/></p>
<p>ç­‰äº†ä¸€ä¼šï¼ŒGeminiè¾“å‡ºäº†PPTçš„å†…å®¹ï¼Œä½†ä¸æ˜¯å…·ä½“å®Œæ•´çš„PPTã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ef72af1d2964702adef538006b0a292~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763370021&amp;x-signature=iByGdu3NT3p6LJHALG%2F4pf8NIyU%3D" alt="" loading="lazy"/></p>
<p>PPTè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç»“åˆä¸Šç¼–è¾‘å™¨ä¸€èµ·æ¥ä½¿ç”¨ï¼Œè®© Gemini å¸®æˆ‘ä»¬å†™ä»£ç ã€‚åœ¨VS Code ä¸­æœç´¢ Gemini CLI æ‰©å±•ï¼Œä¸‹è½½å®‰è£…ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/047ec4e44a0f4af7888dfa9d1a276ea4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763370021&amp;x-signature=EVdPdmS8o3e8NaYSuA%2Bcx8BHbeU%3D" alt="" loading="lazy"/></p>
<p>æˆ‘è®© Gemini CLI å¸®æˆ‘åšä¸ªè´ªåƒè›‡å°æ¸¸æˆã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2debdf2dec074215991e6dca80f863de~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763370021&amp;x-signature=6%2BOY3D78GsdxxT5UvZjvScpOdBk%3D" alt="" loading="lazy"/></p>
<p>åšå®Œåå‘ç°å‡ºäº†bugï¼Œç›´æ¥è®© Gemini ä¿®æ”¹ã€‚æœ€åæˆå“å°±æ˜¯è¿™æ ·ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/725d3aa1f87e4a38b7eddf6079095e6c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-l55So5oi35bey5LiN5a2Y5Zyo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763370021&amp;x-signature=roG83Dl4dDluzBt3Qfy1xV65veA%3D" alt="" loading="lazy"/></p>
<p>å› ä¸ºæŒ‡ä»¤æ¯”è¾ƒç®€å•ï¼Œå‘ˆç°å‡ºæ¥çš„æ•ˆæœä¹Ÿæ¯”è¾ƒä¸€èˆ¬ã€‚å¦‚æœæ˜¯æ­£å„¿å…«ç»åšé¡¹ç›®ï¼Œå¯ä»¥è®©Geminiç”Ÿæˆéœ€æ±‚æ–‡æ¡£ã€æŠ€æœ¯æ–‡æ¡£ï¼Œä¸€æ­¥æ­¥å®ç°è‡ªå·±çš„æƒ³æ³•</p>
<h2 data-id="heading-4">æœ€å</h2>
<p>ServBay ä¸€é”®æå®šå¤æ‚çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.servbay.com%2Ffeatures" target="_blank" title="https://www.servbay.com/features" ref="nofollow noopener noreferrer">æœ¬åœ°å¼€å‘ç¯å¢ƒ</a>ï¼ŒGemini CLI å°±å¸®æˆ‘å†™ä»£ç ï¼Œæˆ‘å°±å¤æ‚æ‘¸é±¼ï¼Œæ¯ä¸ªäººéƒ½æœ‰å…‰æ˜çš„æœªæ¥ï¼Œçˆ½ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥è§£æ Vue SSR ç¼–è¯‘å™¨çš„æ ¸å¿ƒå‡½æ•°ï¼šcompile]]></title>    <link>https://juejin.cn/post/7569959427878273034</link>    <guid>https://juejin.cn/post/7569959427878273034</guid>    <pubDate>2025-11-09T00:15:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7569959427878273034" data-draft-id="7569976345929859123" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥è§£æ Vue SSR ç¼–è¯‘å™¨çš„æ ¸å¿ƒå‡½æ•°ï¼šcompile"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-09T00:15:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="excel"/> <meta itemprop="url" content="https://juejin.cn/user/2911162520062862"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥è§£æ Vue SSR ç¼–è¯‘å™¨çš„æ ¸å¿ƒå‡½æ•°ï¼šcompile
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2911162520062862/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    excel
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-09T00:15:19.000Z" title="Sun Nov 09 2025 00:15:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Vue 3 çš„æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSR, Server-Side Renderingï¼‰ä½“ç³»ä¸­ï¼Œ<code>compile()</code> æ˜¯ä¸€ä¸ªå…³é”®å‡½æ•°ã€‚å®ƒè´Ÿè´£å°†æ¨¡æ¿å­—ç¬¦ä¸²æˆ– AST æŠ½è±¡è¯­æ³•æ ‘è½¬åŒ–ä¸º <strong>å¯åœ¨æœåŠ¡ç«¯æ‰§è¡Œçš„æ¸²æŸ“å‡½æ•°</strong>ï¼Œä»¥ç”Ÿæˆæœ€ç»ˆçš„ HTML å­—ç¬¦ä¸²ã€‚</p>
<p>æœ¬æ–‡æˆ‘ä»¬å°†æ·±å…¥è§£æ <code>compile</code> çš„å®Œæ•´å®ç°ï¼Œå‰–æå…¶åº•å±‚æœºåˆ¶ä¸è®¾è®¡å“²å­¦ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€æ¦‚å¿µï¼š<code>compile</code> æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ</h2>
<p><code>compile</code> æ˜¯ Vue SSR ç¼–è¯‘æµç¨‹çš„å…¥å£å‡½æ•°ï¼ŒåŠŸèƒ½ä¸Šç±»ä¼¼äºå‰ç«¯ç‰ˆæœ¬çš„ <code>@vue/compiler-dom</code> çš„ <code>compile</code>ï¼Œä½†ä¸“ä¸ºæœåŠ¡ç«¯æ¸²æŸ“ä¼˜åŒ–ã€‚<br/>
å®ƒä¸»è¦å®Œæˆä»¥ä¸‹å‡ ä¸ªä»»åŠ¡ï¼š</p>
<ol>
<li><strong>è§£ææ¨¡æ¿</strong>ï¼ˆParsingï¼‰â†’ ç”Ÿæˆ ASTï¼›</li>
<li><strong>æ‰§è¡Œè½¬æ¢</strong>ï¼ˆTransformï¼‰â†’ ä¸º SSR æ³¨å…¥ç‰¹å®šé€»è¾‘ï¼›</li>
<li><strong>ç”Ÿæˆä»£ç </strong>ï¼ˆCodegenï¼‰â†’ è¾“å‡ºæœåŠ¡ç«¯å¯æ‰§è¡Œçš„æ¸²æŸ“å‡½æ•°ä»£ç ã€‚</li>
</ol>
<p>æ ¸å¿ƒç›®æ ‡ï¼šæŠŠ <code>.vue</code> æ¨¡æ¿è½¬åŒ–ä¸ºæœåŠ¡ç«¯å¯è¿è¡Œçš„æ¸²æŸ“å‡½æ•°ï¼Œä½¿å¾—åŒä¸€æ¨¡æ¿åœ¨ Node.js ç¯å¢ƒä¸‹å¯ä»¥ç”Ÿæˆ HTML å­—ç¬¦ä¸²ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€åŸç†ï¼šä»æ¨¡æ¿åˆ°æ¸²æŸ“å‡½æ•°çš„ç¼–è¯‘æµç¨‹</h2>
<p>æ¥çœ‹å®Œæ•´æºç ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">export</span> <span class="hljs-string">function</span> <span class="hljs-string">compile(</span>
  <span class="hljs-attr">source:</span> <span class="hljs-string">string</span> <span class="hljs-string">|</span> <span class="hljs-string">RootNode,</span>
  <span class="hljs-attr">options:</span> <span class="hljs-string">CompilerOptions</span> <span class="hljs-string">=</span> {}<span class="hljs-string">,</span>
<span class="hljs-string">):</span> <span class="hljs-string">CodegenResult</span> {
  <span class="hljs-string">options</span> <span class="hljs-string">=</span> {
    <span class="hljs-string">...options</span>,
    <span class="hljs-string">...parserOptions</span>,
    <span class="hljs-attr">ssr:</span> <span class="hljs-literal">true</span>,
    <span class="hljs-attr">inSSR:</span> <span class="hljs-literal">true</span>,
    <span class="hljs-attr">scopeId:</span> <span class="hljs-string">options.mode</span> <span class="hljs-string">===</span> <span class="hljs-string">'function'</span> <span class="hljs-string">?</span> <span class="hljs-attr">null :</span> <span class="hljs-string">options.scopeId</span>,
    <span class="hljs-attr">prefixIdentifiers:</span> <span class="hljs-literal">true</span>,
    <span class="hljs-attr">cacheHandlers:</span> <span class="hljs-literal">false</span>,
    <span class="hljs-attr">hoistStatic:</span> <span class="hljs-literal">false</span>,
  }

  <span class="hljs-string">const</span> <span class="hljs-string">ast</span> <span class="hljs-string">=</span> <span class="hljs-string">typeof</span> <span class="hljs-string">source</span> <span class="hljs-string">===</span> <span class="hljs-string">'string'</span> <span class="hljs-string">?</span> <span class="hljs-string">baseParse(source</span>, <span class="hljs-string">options)</span> <span class="hljs-string">:</span> <span class="hljs-string">source</span>
  <span class="hljs-string">rawOptionsMap.set(ast</span>, <span class="hljs-string">options)</span>

  <span class="hljs-string">transform(ast</span>, {
    <span class="hljs-string">...options</span>,
    <span class="hljs-attr">hoistStatic:</span> <span class="hljs-literal">false</span>,
    <span class="hljs-attr">nodeTransforms:</span> [
      <span class="hljs-string">transformVBindShorthand</span>,
      <span class="hljs-string">ssrTransformIf</span>,
      <span class="hljs-string">ssrTransformFor</span>,
      <span class="hljs-string">trackVForSlotScopes</span>,
      <span class="hljs-string">transformExpression</span>,
      <span class="hljs-string">ssrTransformSlotOutlet</span>,
      <span class="hljs-string">ssrInjectFallthroughAttrs</span>,
      <span class="hljs-string">ssrInjectCssVars</span>,
      <span class="hljs-string">ssrTransformElement</span>,
      <span class="hljs-string">ssrTransformComponent</span>,
      <span class="hljs-string">trackSlotScopes</span>,
      <span class="hljs-string">transformStyle</span>,
      <span class="hljs-string">...(options.nodeTransforms</span> <span class="hljs-string">||</span> []<span class="hljs-string">)</span>,
    ],
    <span class="hljs-attr">directiveTransforms:</span> {
      <span class="hljs-attr">bind:</span> <span class="hljs-string">transformBind</span>,
      <span class="hljs-attr">on:</span> <span class="hljs-string">transformOn</span>,
      <span class="hljs-attr">model:</span> <span class="hljs-string">ssrTransformModel</span>,
      <span class="hljs-attr">show:</span> <span class="hljs-string">ssrTransformShow</span>,
      <span class="hljs-attr">cloak:</span> <span class="hljs-string">noopDirectiveTransform</span>,
      <span class="hljs-attr">once:</span> <span class="hljs-string">noopDirectiveTransform</span>,
      <span class="hljs-attr">memo:</span> <span class="hljs-string">noopDirectiveTransform</span>,
      <span class="hljs-string">...(options.directiveTransforms</span> <span class="hljs-string">||</span> {}<span class="hljs-string">)</span>,
    },
  }<span class="hljs-string">)</span>

  <span class="hljs-string">ssrCodegenTransform(ast</span>, <span class="hljs-string">options)</span>

  <span class="hljs-string">return</span> <span class="hljs-string">generate(ast</span>, <span class="hljs-string">options)</span>
}
</code></pre>
<hr/>
<h3 data-id="heading-2">ğŸ” æ­¥éª¤ 1ï¼šé…ç½®ç¼–è¯‘é€‰é¡¹</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">options</span> <span class="hljs-string">=</span> {
  <span class="hljs-string">...options</span>,
  <span class="hljs-string">...parserOptions</span>,
  <span class="hljs-attr">ssr:</span> <span class="hljs-literal">true</span>,
  <span class="hljs-attr">inSSR:</span> <span class="hljs-literal">true</span>,
  <span class="hljs-attr">scopeId:</span> <span class="hljs-string">options.mode</span> <span class="hljs-string">===</span> <span class="hljs-string">'function'</span> <span class="hljs-string">?</span> <span class="hljs-attr">null :</span> <span class="hljs-string">options.scopeId</span>,
  <span class="hljs-attr">prefixIdentifiers:</span> <span class="hljs-literal">true</span>,
  <span class="hljs-attr">cacheHandlers:</span> <span class="hljs-literal">false</span>,
  <span class="hljs-attr">hoistStatic:</span> <span class="hljs-literal">false</span>,
}
</code></pre>
<h4 data-id="heading-3">è¯´æ˜ï¼š</h4>
<ul>
<li><code>ssr: true</code> ä¸ <code>inSSR: true</code> â†’ æ˜ç¡®å‘Šè¯‰ç¼–è¯‘å™¨å¤„äºæœåŠ¡ç«¯æ¸²æŸ“æ¨¡å¼ï¼›</li>
<li><code>prefixIdentifiers: true</code> â†’ åœ¨ SSR æ¨¡å¼ä¸‹å¯ç”¨å˜é‡å‰ç¼€ï¼ˆå¦‚ <code>_ctx.</code>ï¼‰ï¼Œé¿å…ä½œç”¨åŸŸå†²çªï¼›</li>
<li><code>cacheHandlers</code> ä¸ <code>hoistStatic</code> è¢«ç¦ç”¨ï¼Œå› ä¸º SSR æ²¡æœ‰å®¢æˆ·ç«¯ diff çš„æ€§èƒ½éœ€æ±‚ã€‚</li>
</ul>
<h4 data-id="heading-4">æ³¨é‡Šï¼š</h4>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// SSR æ¨¡å¼ä¸‹éœ€è¦æ˜ç¡®å¼€å¯æœåŠ¡ç«¯æ ‡å¿—</span>
<span class="hljs-comment">// å¹¶å…³é—­å‰ç«¯ä¼˜åŒ–ï¼ˆå¦‚äº‹ä»¶ç¼“å­˜ã€é™æ€æå‡ï¼‰</span>
</code></pre>
<hr/>
<h3 data-id="heading-5">ğŸ” æ­¥éª¤ 2ï¼šç”Ÿæˆæˆ–ä½¿ç”¨å·²æœ‰ AST</h3>
<pre><code class="hljs language-bash" lang="bash">const ast = typeof <span class="hljs-built_in">source</span> === <span class="hljs-string">'string'</span> ? baseParse(<span class="hljs-built_in">source</span>, options) : <span class="hljs-built_in">source</span>
rawOptionsMap.<span class="hljs-built_in">set</span>(ast, options)
</code></pre>
<h4 data-id="heading-6">è¯´æ˜ï¼š</h4>
<ul>
<li>è‹¥ä¼ å…¥å­—ç¬¦ä¸²æ¨¡æ¿ï¼Œåˆ™è°ƒç”¨ <code>baseParse()</code> å°†å…¶è§£æä¸º ASTï¼›</li>
<li>è‹¥å·²æ˜¯ <code>RootNode</code>ï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰ï¼Œåˆ™ç›´æ¥ä½¿ç”¨ï¼›</li>
<li><code>rawOptionsMap.set()</code> ä¿å­˜ç¼–è¯‘é…ç½®ï¼Œç”¨äºåç»­å­æ ‘çš„ SSR è½¬æ¢ï¼ˆå°¤å…¶æ˜¯ <code>&lt;slot&gt;</code>ï¼‰ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-7">ğŸ” æ­¥éª¤ 3ï¼šæ‰§è¡Œ AST è½¬æ¢ï¼ˆTransform é˜¶æ®µï¼‰</h3>
<pre><code class="hljs language-css" lang="css"><span class="hljs-attribute">transform</span>(ast, {
  ..<span class="hljs-selector-class">.options</span>,
  nodeTransforms: [...],
  directiveTransforms: {...},
})
</code></pre>
<h4 data-id="heading-8">å…³é”®ï¼š</h4>
<p>è¿™ä¸€é˜¶æ®µå°†æ¨¡æ¿ AST è½¬åŒ–ä¸º <strong>SSR å‹å¥½çš„ä¸­é—´è¡¨ç¤ºï¼ˆIRï¼‰</strong> ã€‚</p>
<h4 data-id="heading-9">æ ¸å¿ƒ Node Transformsï¼š</h4>

















































<table><thead><tr><th>è½¬æ¢å‡½æ•°</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>transformVBindShorthand</code></td><td>å¤„ç† <code>:prop</code> çš„ç®€å†™ç»‘å®š</td></tr><tr><td><code>ssrTransformIf</code></td><td>å°† <code>v-if</code> è½¬åŒ–ä¸ºæ¡ä»¶æ¸²æŸ“è¡¨è¾¾å¼</td></tr><tr><td><code>ssrTransformFor</code></td><td>å°† <code>v-for</code> è½¬åŒ–ä¸ºå¾ªç¯æ¸²æŸ“</td></tr><tr><td><code>trackVForSlotScopes</code></td><td>è·Ÿè¸ª <code>v-for</code> ä¸­çš„æ’æ§½ä½œç”¨åŸŸ</td></tr><tr><td><code>ssrTransformSlotOutlet</code></td><td>æ”¹å†™ <code>&lt;slot&gt;</code> ä¸º SSR è¾“å‡ºå‡½æ•°</td></tr><tr><td><code>ssrInjectFallthroughAttrs</code></td><td>å¤„ç†ç»„ä»¶é€ä¼ å±æ€§</td></tr><tr><td><code>ssrInjectCssVars</code></td><td>æ³¨å…¥ SSR ç‰ˆæœ¬çš„ CSS å˜é‡</td></tr><tr><td><code>ssrTransformElement</code></td><td>æ ¸å¿ƒï¼šå°†æ™®é€šå…ƒç´ èŠ‚ç‚¹è½¬åŒ–ä¸º SSR å¯æ¸²æŸ“å­—ç¬¦ä¸²</td></tr><tr><td><code>ssrTransformComponent</code></td><td>ç»„ä»¶çº§åˆ«çš„ SSR è½¬æ¢</td></tr><tr><td><code>transformStyle</code></td><td>å¤„ç†æ ·å¼ç»‘å®šï¼ˆ<code>v-bind:style</code>ï¼‰</td></tr></tbody></table>
<h4 data-id="heading-10">æŒ‡ä»¤è½¬æ¢ï¼ˆDirective Transformsï¼‰ï¼š</h4>



































<table><thead><tr><th>æŒ‡ä»¤</th><th>è½¬æ¢å‡½æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>v-bind</code></td><td><code>transformBind</code></td><td>ä¿ç•™ DOM ç¼–è¯‘é€»è¾‘</td></tr><tr><td><code>v-on</code></td><td><code>transformOn</code></td><td>ä¿ç•™äº‹ä»¶é€»è¾‘ï¼ˆéƒ¨åˆ†å¿½ç•¥ï¼‰</td></tr><tr><td><code>v-model</code></td><td><code>ssrTransformModel</code></td><td>SSR ç‰¹æ®Šå¤„ç†åŒå‘ç»‘å®š</td></tr><tr><td><code>v-show</code></td><td><code>ssrTransformShow</code></td><td>è½¬åŒ–ä¸ºæœåŠ¡ç«¯æ¡ä»¶æ¸²æŸ“</td></tr><tr><td><code>v-cloak/once/memo</code></td><td><code>noopDirectiveTransform</code></td><td>åœ¨ SSR é˜¶æ®µè¢«å¿½ç•¥</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-11">ğŸ” æ­¥éª¤ 4ï¼šSSR ä¸“ç”¨ä»£ç ç”Ÿæˆé˜¶æ®µ</h3>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">ssrCodegenTransform</span>(ast, options)
</code></pre>
<p>è¿™ä¸€é˜¶æ®µä¼šæ‰«æå¹¶ä¿®æ”¹ <code>ast.codegenNode</code>ï¼Œå°†å…¶æ›¿æ¢ä¸º <strong>SSR ä»£ç ç”Ÿæˆæ ‘</strong>ã€‚</p>
<p>è¿™ä¸€æ­¥æ˜¯ SSR çš„â€œé­”æ³•â€æ‰€åœ¨ï¼Œå®ƒå°†æ¨¡æ¿ç»“æ„è½¬åŒ–ä¸ºå­—ç¬¦ä¸²æ‹¼æ¥é€»è¾‘ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">div</span>&gt;{{ msg }}&lt;/<span class="hljs-selector-tag">div</span>&gt;
</code></pre>
<p>ä¼šè¢«ç¼–è¯‘æˆï¼š</p>
<pre><code class="hljs language-bash" lang="bash">push(`&lt;div&gt;<span class="hljs-variable">${_ctx.msg}</span>&lt;/div&gt;`)
</code></pre>
<hr/>
<h3 data-id="heading-12">ğŸ” æ­¥éª¤ 5ï¼šç”Ÿæˆæœ€ç»ˆæ¸²æŸ“å‡½æ•°</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">return</span> generate(ast, options)
</code></pre>
<p>æœ€ç»ˆè¾“å‡ºçš„ <code>CodegenResult</code> åŒ…å«ï¼š</p>
<ul>
<li>æ¸²æŸ“å‡½æ•°å­—ç¬¦ä¸²ï¼›</li>
<li>ä¾èµ–å¯¼å…¥ä¿¡æ¯ï¼›</li>
<li>SSR ä¸Šä¸‹æ–‡ç®¡ç†ä»£ç ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-13">ä¸‰ã€å¯¹æ¯”ï¼šSSR ç¼–è¯‘ vs. DOM ç¼–è¯‘</h2>



































<table><thead><tr><th>ç‰¹æ€§</th><th>DOM ç¼–è¯‘ï¼ˆå®¢æˆ·ç«¯ï¼‰</th><th>SSR ç¼–è¯‘ï¼ˆæœåŠ¡ç«¯ï¼‰</th></tr></thead><tbody><tr><td>è¾“å‡º</td><td>æ¸²æŸ“å‡½æ•°ï¼ˆVNode æ ‘ï¼‰</td><td>æ¸²æŸ“å‡½æ•°ï¼ˆHTML å­—ç¬¦ä¸²ï¼‰</td></tr><tr><td>ä¼˜åŒ–</td><td>é™æ€æå‡ã€äº‹ä»¶ç¼“å­˜</td><td>å­—ç¬¦ä¸²æ‹¼æ¥ä¼˜åŒ–</td></tr><tr><td>æŒ‡ä»¤å¤„ç†</td><td>è¿è¡Œæ—¶ patch</td><td>ç¼–è¯‘æœŸç”Ÿæˆé€»è¾‘</td></tr><tr><td>æ ·å¼ä½œç”¨åŸŸ</td><td>åŠ¨æ€æ·»åŠ </td><td>ç¼–è¯‘æ—¶æ³¨å…¥</td></tr><tr><td>è¿è¡Œç¯å¢ƒ</td><td>æµè§ˆå™¨</td><td>Node.js</td></tr></tbody></table>
<p>å¯ä»¥çœ‹å‡º SSR ç¼–è¯‘å™¨å»æ‰äº†è®¸å¤šâ€œå‰ç«¯è¿è¡Œæ—¶ä¼˜åŒ–â€ï¼Œæ¢å– <strong>ç¼–è¯‘æœŸç¡®å®šæ€§</strong> ä¸ <strong>æ‰§è¡Œé€Ÿåº¦</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-14">å››ã€å®è·µï¼šå¦‚ä½•ä½¿ç”¨ <code>compile</code></h2>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªæœ€å°ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { compile } <span class="hljs-keyword">from</span> <span class="hljs-string">'@vue/compiler-ssr'</span>

<span class="hljs-keyword">const</span> result = <span class="hljs-title function_">compile</span>(<span class="hljs-string">`&lt;div&gt;Hello {{ name }}&lt;/div&gt;`</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result.<span class="hljs-property">code</span>)
</code></pre>
<p>è¾“å‡ºç¤ºä¾‹ï¼ˆç®€åŒ–ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">ssrRender</span>(<span class="hljs-params">_ctx, _push, _parent, _attrs</span>) {
  <span class="hljs-title function_">_push</span>(<span class="hljs-string">`&lt;div&gt;Hello <span class="hljs-subst">${_ctx.name}</span>&lt;/div&gt;`</span>)
}
</code></pre>
<blockquote>
<p>è¿™æ®µä»£ç å¯ç›´æ¥åœ¨ Node ç¯å¢ƒä¸­æ‰§è¡Œï¼Œç”¨äºæœåŠ¡ç«¯è¾“å‡º HTMLã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-15">äº”ã€æ‹“å±•ï¼šSSR çš„å­ç¼–è¯‘æµç¨‹</h2>
<p>SSR ç¼–è¯‘å™¨è¿˜æ”¯æŒï¼š</p>
<ul>
<li>å¯¹ <strong>æ’æ§½å†…å®¹</strong>ï¼ˆslot branchesï¼‰è¿›è¡Œç‹¬ç«‹ç¼–è¯‘ï¼›</li>
<li>æ”¯æŒ CSS å˜é‡æ³¨å…¥ï¼›</li>
<li>æ”¯æŒè‡ªå®šä¹‰ <code>directiveTransforms</code>ï¼Œç”¨äºæ‰©å±• SSR æŒ‡ä»¤ã€‚</li>
</ul>
<p>å¼€å‘è€…å¯é€šè¿‡ <code>options.nodeTransforms</code> æˆ– <code>options.directiveTransforms</code> æ³¨å…¥è‡ªå®šä¹‰é€»è¾‘ï¼Œå®ç°ä¸ªæ€§åŒ–çš„ SSR ç¼–è¯‘ç®¡çº¿ã€‚</p>
<hr/>
<h2 data-id="heading-16">å…­ã€æ½œåœ¨é—®é¢˜ä¸æ³¨æ„äº‹é¡¹</h2>
<ol>
<li><strong>ä¸ hydration ä¸å…¼å®¹çš„è¡Œä¸º</strong><br/>
æŸäº›æŒ‡ä»¤å¦‚ <code>v-once</code>ã€<code>v-memo</code> æ— æ³•åœ¨ SSR ç«¯ä½¿ç”¨ï¼Œä¼šåœ¨ hydration æ—¶å¤±æ•ˆã€‚</li>
<li><strong>CSS å˜é‡åŒæ­¥é—®é¢˜</strong><br/>
<code>ssrInjectCssVars</code> ä»…ç¼–è¯‘æ³¨å…¥å˜é‡ï¼Œä½†å®¢æˆ·ç«¯éœ€åŒæ­¥ä»¥é¿å…é—ªçƒã€‚</li>
<li><strong>æ€§èƒ½é™·é˜±</strong><br/>
è‹¥æ¨¡æ¿è¿‡å¤§ï¼Œ<code>generate()</code> é˜¶æ®µå¯èƒ½ç”Ÿæˆæé•¿å­—ç¬¦ä¸²ï¼›å¯è€ƒè™‘åˆ†å—æ¸²æŸ“ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-17">æ€»ç»“</h2>
<p><code>compile()</code> æ˜¯ Vue SSR ç¼–è¯‘å™¨çš„æ ¸å¿ƒæ¥å£ï¼Œå®ƒå°†æ¨¡æ¿ç¼–è¯‘ä¸ºå¯æ‰§è¡Œçš„å­—ç¬¦ä¸²ç”Ÿæˆå‡½æ•°ï¼Œæ˜¯ä»æ¨¡æ¿åˆ° HTML çš„æ¡¥æ¢ã€‚<br/>
é€šè¿‡å¤šå±‚ transform ç®¡çº¿ä¸ SSR ä¸“ç”¨ codegenï¼ŒVue å®ç°äº†ä¼˜é›…çš„æ¨¡æ¿åˆ°å­—ç¬¦ä¸²ç¼–è¯‘æœºåˆ¶ã€‚</p>
<hr/>
<p><strong>æœ¬æ–‡éƒ¨åˆ†å†…å®¹å€ŸåŠ© AI è¾…åŠ©ç”Ÿæˆï¼Œå¹¶ç”±ä½œè€…æ•´ç†å®¡æ ¸ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŠ¨æ€ç›‘å¬DOMå…ƒç´ é«˜åº¦å˜åŒ–]]></title>    <link>https://juejin.cn/post/7570201730991783962</link>    <guid>https://juejin.cn/post/7570201730991783962</guid>    <pubDate>2025-11-09T15:15:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570201730991783962" data-draft-id="7569945160870264878" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŠ¨æ€ç›‘å¬DOMå…ƒç´ é«˜åº¦å˜åŒ–"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-11-09T15:15:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å¤§å«"/> <meta itemprop="url" content="https://juejin.cn/user/1961184474695213"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŠ¨æ€ç›‘å¬DOMå…ƒç´ é«˜åº¦å˜åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1961184474695213/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å¤§å«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-09T15:15:48.000Z" title="Sun Nov 09 2025 15:15:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯<strong>å‰ç«¯æ¶æ„å¸ˆ</strong>ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ã€<strong>ç¨‹åºå‘˜å¤§å«</strong>ã€‘ï¼Œå…è´¹é¢†å–ç²¾å“å‰ç«¯èµ„æ–™ã€‚</p>
<h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œç›‘å¬DOMå…ƒç´ çš„é«˜åº¦å˜åŒ–æœ‰æ—¶å€™æ˜¯ä¸€ä¸ªå¸¸è§éœ€æ±‚ï¼Œå°¤å…¶æ˜¯åœ¨åšå“åº”å¼è®¾è®¡æˆ–éœ€è¦æ ¹æ®å†…å®¹å˜åŒ–è°ƒæ•´å¸ƒå±€æ—¶ã€‚å¸¸è§çš„è§£å†³æ–¹æ¡ˆæœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯ä½¿ç”¨ç°ä»£æµè§ˆå™¨æ”¯æŒçš„ <code>ResizeObserver</code>ï¼Œå¦ä¸€ç§æ˜¯é€šè¿‡å…¼å®¹æ€§æ›´å¼ºçš„ iframe æŠ€æœ¯æ¥å®ç°ï¼Œé€‚ç”¨äºè€æ¬¾æ‰‹æœºå’ŒIEæµè§ˆå™¨ã€‚</p>
<h2 data-id="heading-1">1. ResizeObserver</h2>
<p><code>ResizeObserver</code> æ˜¯ç°ä»£æµè§ˆå™¨æä¾›çš„ä¸€ç§ç›‘å¬å…ƒç´ å°ºå¯¸å˜åŒ–çš„ APIã€‚å®ƒå¯ä»¥ç›‘å¬ä»»æ„å…ƒç´ çš„å¤§å°å˜åŒ–ï¼Œå¹¶åœ¨å˜åŒ–æ—¶è§¦å‘å›è°ƒå‡½æ•°ï¼Œé€‚åˆå¤„ç† DOM å…ƒç´ é«˜åº¦å˜åŒ–çš„æƒ…å†µã€‚</p>
<h3 data-id="heading-2">ç¤ºä¾‹ä»£ç ï¼š</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é€‰æ‹©ä½ æƒ³è¦ç›‘å¬çš„ DOM å…ƒç´ </span>
<span class="hljs-keyword">const</span> targetElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.target'</span>);

<span class="hljs-comment">// åˆ›å»º ResizeObserver å®ä¾‹ï¼Œå¹¶ä¼ å…¥å›è°ƒå‡½æ•°</span>
<span class="hljs-keyword">const</span> resizeObserver = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ResizeObserver</span>(<span class="hljs-function"><span class="hljs-params">entries</span> =&gt;</span> {
    <span class="hljs-comment">// entries æ˜¯ä¸€ä¸ªåŒ…å«è¢«ç›‘å¬å…ƒç´ çš„æ•°ç»„</span>
    entries.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
        <span class="hljs-comment">// è·å–ç›®æ ‡å…ƒç´ çš„å½“å‰é«˜åº¦</span>
        <span class="hljs-keyword">const</span> height = entry.<span class="hljs-property">contentRect</span>.<span class="hljs-property">height</span>;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å…ƒç´ çš„å½“å‰é«˜åº¦:'</span>, height);
    });
});

<span class="hljs-comment">// å¼€å§‹ç›‘å¬ç›®æ ‡å…ƒç´ çš„å°ºå¯¸å˜åŒ–</span>
resizeObserver.<span class="hljs-title function_">observe</span>(targetElement);
</code></pre>
<h3 data-id="heading-3">ä½¿ç”¨è¯´æ˜ï¼š</h3>
<ul>
<li><code>ResizeObserver</code> ä¼šç›‘å¬ç›®æ ‡å…ƒç´ çš„å¤§å°å˜åŒ–ï¼Œå¹¶è¿”å›ä¸€ä¸ª <code>entries</code> æ•°ç»„ï¼Œå…¶ä¸­æ¯ä¸€é¡¹ä»£è¡¨ä¸€ä¸ªè¢«è§‚å¯Ÿçš„å…ƒç´ ã€‚</li>
<li><code>entry.contentRect</code> æ˜¯ä¸€ä¸ªåŒ…å«å…ƒç´ å°ºå¯¸ä¿¡æ¯çš„çŸ©å½¢å¯¹è±¡ï¼Œ<code>height</code> å±æ€§å³ä¸ºå…ƒç´ çš„é«˜åº¦ã€‚</li>
<li>è¿™ä¸ªæ–¹æ³•å¯¹äºç°ä»£æµè§ˆå™¨ï¼ˆChromeã€Firefoxã€Safari ç­‰ï¼‰éƒ½æœ‰æ•ˆï¼Œæ”¯æŒç¨‹åº¦è¾ƒé«˜ã€‚</li>
</ul>
<h2 data-id="heading-4">2. Iframe</h2>
<p>å¯¹äºä¸€äº›è€æ¬¾æµè§ˆå™¨ï¼ˆå¦‚ IE æµè§ˆå™¨ï¼‰æˆ–è€…éœ€è¦å…¼å®¹æ›´å¤šè®¾å¤‡çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ iframe æŠ€æœ¯æ¥å®ç°åŠ¨æ€ç›‘å¬å®¹å™¨çš„é«˜åº¦å˜åŒ–ã€‚é€šè¿‡åµŒå…¥ä¸€ä¸ªéšè—çš„ iframe å…ƒç´ ï¼Œå¯ä»¥ç›‘å¬ iframe å…ƒç´ çš„ <code>resize</code> äº‹ä»¶æ¥é—´æ¥åˆ¤æ–­å®¹å™¨çš„é«˜åº¦ã€‚</p>
<h3 data-id="heading-5">ç¤ºä¾‹ä»£ç ï¼ˆçº¯ HTML å®ç°ï¼‰ï¼š</h3>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>åŠ¨æ€ç›‘å¬DOMå…ƒç´ é«˜åº¦å˜åŒ– - iframe ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-class">.container</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>; <span class="hljs-comment">/* åˆå§‹é«˜åº¦ */</span>
            <span class="hljs-attribute">position</span>: relative;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ccc</span>;
        }
        <span class="hljs-selector-class">.resize-iframe</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">border</span>: none;
            <span class="hljs-attribute">position</span>: absolute;
            <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"resize-iframe"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"about:blank"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.container'</span>);
        <span class="hljs-keyword">const</span> iframe = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.resize-iframe'</span>);

        <span class="hljs-comment">// ç›‘å¬ iframe çš„ resize äº‹ä»¶</span>
        iframe.<span class="hljs-property">contentWindow</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'resize'</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
            <span class="hljs-comment">// è·å–å®¹å™¨çš„å½“å‰é«˜åº¦</span>
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å®¹å™¨çš„å½“å‰é«˜åº¦:'</span>, container.<span class="hljs-property">offsetHeight</span>);
        });

        <span class="hljs-comment">// ä¸ºäº†æ¼”ç¤ºï¼Œåœ¨å®¹å™¨çš„é«˜åº¦å˜åŒ–æ—¶è§¦å‘ resize äº‹ä»¶</span>
        <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
            container.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">500</span> + <span class="hljs-string">'px'</span>;  <span class="hljs-comment">// éšæœºè°ƒæ•´å®¹å™¨é«˜åº¦</span>
        }, <span class="hljs-number">2000</span>);  <span class="hljs-comment">// æ¯2ç§’è°ƒæ•´ä¸€æ¬¡é«˜åº¦</span>
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h3 data-id="heading-6">ä½¿ç”¨è¯´æ˜ï¼š</h3>
<ul>
<li>è¿™ä¸ªæ–¹æ³•é€šè¿‡å°†ä¸€ä¸ªéšè—çš„ iframe åµŒå¥—åˆ°ç›®æ ‡å®¹å™¨å†…ï¼Œåˆ©ç”¨ iframe çš„ <code>resize</code> äº‹ä»¶æ¥æ£€æµ‹å®¹å™¨çš„é«˜åº¦å˜åŒ–ã€‚</li>
<li>ç”±äº <code>iframe</code> çš„ <code>resize</code> äº‹ä»¶ä¼šåœ¨å®¹å™¨çš„å°ºå¯¸å‘ç”Ÿå˜åŒ–æ—¶è§¦å‘ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨äº‹ä»¶å›è°ƒä¸­è·å–å®¹å™¨çš„æœ€æ–°é«˜åº¦ã€‚</li>
<li>æ­¤æ–¹æ³•çš„å…¼å®¹æ€§æ›´å¹¿ï¼Œå¯ä»¥æ”¯æŒè€æ—§æµè§ˆå™¨ï¼Œå¦‚ IE æµè§ˆå™¨ã€‚</li>
</ul>
<h2 data-id="heading-7">æ€»ç»“</h2>
<p>é€šè¿‡è¿™ä¸¤ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åŠ¨æ€ç›‘å¬ DOM å…ƒç´ çš„é«˜åº¦å˜åŒ–ï¼Œé€‰æ‹©é€‚åˆçš„æ–¹æ¡ˆå¯ä»¥ä¿è¯è·¨æµè§ˆå™¨å’Œè®¾å¤‡çš„å…¼å®¹æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue SSR ç¼–è¯‘å™¨æºç æ·±æï¼šssrTransformShow çš„å®ç°åŸç†ä¸è®¾è®¡å“²å­¦]]></title>    <link>https://juejin.cn/post/7569913182036049930</link>    <guid>https://juejin.cn/post/7569913182036049930</guid>    <pubDate>2025-11-09T00:11:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7569913182036049930" data-draft-id="7569960869959057454" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue SSR ç¼–è¯‘å™¨æºç æ·±æï¼šssrTransformShow çš„å®ç°åŸç†ä¸è®¾è®¡å“²å­¦"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-09T00:11:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="excel"/> <meta itemprop="url" content="https://juejin.cn/user/2911162520062862"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue SSR ç¼–è¯‘å™¨æºç æ·±æï¼šssrTransformShow çš„å®ç°åŸç†ä¸è®¾è®¡å“²å­¦
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2911162520062862/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    excel
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-09T00:11:52.000Z" title="Sun Nov 09 2025 00:11:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€æ¦‚å¿µç†è§£ï¼š<code>v-show</code> åœ¨ SSR ç¯å¢ƒä¸­çš„æœ¬è´¨é—®é¢˜</h2>
<p>åœ¨ Vue çš„å®¢æˆ·ç«¯æ¸²æŸ“ï¼ˆCSRï¼‰ä¸­ï¼Œ<code>v-show</code> æ˜¯é€šè¿‡åŠ¨æ€ä¿®æ”¹å…ƒç´ çš„ <code>display</code> æ ·å¼å±æ€§æ¥æ§åˆ¶æ˜¾éšçš„ã€‚<br/>
ä½†åœ¨ <strong>SSRï¼ˆServer-Side Renderingï¼‰</strong> ç¯å¢ƒä¸‹ï¼Œæ²¡æœ‰çœŸå®çš„ DOM æ“ä½œï¼Œå› æ­¤å¿…é¡»åœ¨ <strong>ç¼–è¯‘é˜¶æ®µ</strong> å°†å…¶è½¬æ¢ä¸ºåˆé€‚çš„â€œæ ·å¼è¡¨è¾¾å¼â€ï¼Œä»¥ä¾¿åœ¨æ¸²æŸ“ HTML æ—¶å³å†³å®šå…ƒç´ çš„æ˜¾ç¤ºä¸å¦ã€‚</p>
<p>è¿™æ®µæºç æ­£æ˜¯ Vue SSR ç¼–è¯‘é˜¶æ®µå¯¹ <code>v-show</code> æŒ‡ä»¤çš„ä¸“ç”¨è½¬æ¢å‡½æ•°ï¼š<code>ssrTransformShow</code>ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€åŸç†å‰–æï¼šä» AST è½¬æ¢åˆ°å¯æ‰§è¡Œçš„ SSR è¡¨è¾¾å¼</h2>
<p>æºç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> {
  <span class="hljs-title class_">DOMErrorCodes</span>,
  <span class="hljs-keyword">type</span> <span class="hljs-title class_">DirectiveTransform</span>,
  createConditionalExpression,
  createDOMCompilerError,
  createObjectExpression,
  createObjectProperty,
  createSimpleExpression,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'@vue/compiler-dom'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">ssrTransformShow</span>: <span class="hljs-title class_">DirectiveTransform</span> = <span class="hljs-function">(<span class="hljs-params">dir, node, context</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (!dir.<span class="hljs-property">exp</span>) {
    context.<span class="hljs-title function_">onError</span>(
      <span class="hljs-title function_">createDOMCompilerError</span>(<span class="hljs-title class_">DOMErrorCodes</span>.<span class="hljs-property">X_V_SHOW_NO_EXPRESSION</span>),
    )
  }
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">props</span>: [
      <span class="hljs-title function_">createObjectProperty</span>(
        <span class="hljs-string">`style`</span>,
        <span class="hljs-title function_">createConditionalExpression</span>(
          dir.<span class="hljs-property">exp</span>!,
          <span class="hljs-title function_">createSimpleExpression</span>(<span class="hljs-string">`null`</span>, <span class="hljs-literal">false</span>),
          <span class="hljs-title function_">createObjectExpression</span>([
            <span class="hljs-title function_">createObjectProperty</span>(
              <span class="hljs-string">`display`</span>,
              <span class="hljs-title function_">createSimpleExpression</span>(<span class="hljs-string">`none`</span>, <span class="hljs-literal">true</span>),
            ),
          ]),
          <span class="hljs-literal">false</span> <span class="hljs-comment">/* no newline */</span>,
        ),
      ),
    ],
  }
}
</code></pre>
<hr/>
<h3 data-id="heading-2">ğŸ” é€è¡Œæ³¨é‡Šè®²è§£</h3>
<h4 data-id="heading-3">1. å¯¼å…¥ç¼–è¯‘å™¨å·¥å…·å‡½æ•°</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> {
  <span class="hljs-title class_">DOMErrorCodes</span>,                <span class="hljs-comment">// DOM ç¼–è¯‘å™¨é”™è¯¯ç æšä¸¾</span>
  <span class="hljs-keyword">type</span> <span class="hljs-title class_">DirectiveTransform</span>,       <span class="hljs-comment">// æŒ‡ä»¤è½¬æ¢å™¨ç±»å‹å®šä¹‰</span>
  createConditionalExpression,   <span class="hljs-comment">// åˆ›å»ºæ¡ä»¶ï¼ˆä¸‰å…ƒï¼‰è¡¨è¾¾å¼èŠ‚ç‚¹</span>
  createDOMCompilerError,        <span class="hljs-comment">// åˆ›å»ºç¼–è¯‘é”™è¯¯å¯¹è±¡</span>
  createObjectExpression,        <span class="hljs-comment">// åˆ›å»ºå¯¹è±¡å­—é¢é‡è¡¨è¾¾å¼èŠ‚ç‚¹</span>
  createObjectProperty,          <span class="hljs-comment">// åˆ›å»ºå¯¹è±¡å±æ€§èŠ‚ç‚¹</span>
  createSimpleExpression,        <span class="hljs-comment">// åˆ›å»ºç®€å•è¡¨è¾¾å¼èŠ‚ç‚¹</span>
} <span class="hljs-keyword">from</span> <span class="hljs-string">'@vue/compiler-dom'</span>
</code></pre>
<p>ğŸ‘‰ è¿™äº›å‡½æ•°ç”¨äºç”Ÿæˆ Vue ç¼–è¯‘å™¨ ASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰èŠ‚ç‚¹ï¼Œä½¿æ¨¡æ¿è¯­æ³•è½¬æ¢ä¸º JavaScript æ¸²æŸ“å‡½æ•°è¡¨è¾¾å¼ã€‚</p>
<hr/>
<h4 data-id="heading-4">2. å®šä¹‰ <code>ssrTransformShow</code></h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">ssrTransformShow</span>: <span class="hljs-title class_">DirectiveTransform</span> = <span class="hljs-function">(<span class="hljs-params">dir, node, context</span>) =&gt;</span> {
</code></pre>
<ul>
<li><code>dir</code>ï¼šæŒ‡ä»¤å¯¹è±¡ï¼ŒåŒ…å« <code>name</code>ã€<code>exp</code>ã€<code>modifiers</code> ç­‰ä¿¡æ¯ã€‚</li>
<li><code>node</code>ï¼šå½“å‰å¤„ç†çš„ AST èŠ‚ç‚¹ï¼ˆå¦‚ <code>&lt;div v-show="visible"&gt;</code>ï¼‰ã€‚</li>
<li><code>context</code>ï¼šç¼–è¯‘ä¸Šä¸‹æ–‡ï¼ŒåŒ…å«é”™è¯¯å¤„ç†ã€ä»£ç ç”ŸæˆçŠ¶æ€ç­‰ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-5">3. é”™è¯¯å¤„ç†ï¼šæœªä¼ å…¥è¡¨è¾¾å¼æ—¶æŠ¥é”™</h4>
<pre><code class="hljs language-scss" lang="scss">if (!dir.exp) {
  context<span class="hljs-selector-class">.onError</span>(
    createDOMCompilerError(DOMErrorCodes.X_V_SHOW_NO_EXPRESSION),
  )
}
</code></pre>
<p>ğŸ§© è§£é‡Šï¼š</p>
<ul>
<li>è‹¥ <code>v-show</code> æœªç»‘å®šè¡¨è¾¾å¼ï¼ˆå¦‚ <code>&lt;div v-show&gt;</code>ï¼‰ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µæŠ›å‡º <code>X_V_SHOW_NO_EXPRESSION</code> é”™è¯¯ã€‚</li>
<li>è¿™æ˜¯è¯­ä¹‰å±‚æ£€æŸ¥ï¼Œç¡®ä¿ SSR è¾“å‡ºé€»è¾‘æ­£ç¡®ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-6">4. è¿”å›è½¬æ¢ç»“æœï¼šç”Ÿæˆ SSR æ ·å¼è¡¨è¾¾å¼</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">return</span> {
  props: [
    createObjectProperty(
      <span class="hljs-string">`style`</span>,
      createConditionalExpression(
        dir.exp!,                      <span class="hljs-comment">// æ¡ä»¶ï¼šè‹¥è¡¨è¾¾å¼ä¸ºçœŸ</span>
        createSimpleExpression(<span class="hljs-string">`null`</span>, <span class="hljs-literal">false</span>),   <span class="hljs-comment">// åˆ™æ ·å¼ä¸º nullï¼ˆä¿æŒé»˜è®¤ï¼‰</span>
        createObjectExpression([       <span class="hljs-comment">// å¦åˆ™å¼ºåˆ¶è®¾ç½® display:none</span>
          createObjectProperty(
            <span class="hljs-string">`display`</span>,
            createSimpleExpression(<span class="hljs-string">`none`</span>, <span class="hljs-literal">true</span>),
          ),
        ]),
        <span class="hljs-literal">false</span> <span class="hljs-comment">/* no newline */</span>,
      ),
    ),
  ],
}
</code></pre>
<p>ğŸ§  é€»è¾‘è½¬æ¢æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p>æ¨¡æ¿ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;div <span class="hljs-attr">v-show</span>=<span class="hljs-string">"visible"</span>&gt;&lt;/div&gt;
</code></pre>
<p>ç¼–è¯‘æˆ SSR æ¸²æŸ“è¡¨è¾¾å¼ï¼š</p>
<pre><code class="hljs language-css" lang="css">{
  style: visible ? null : { <span class="hljs-attribute">display</span>: <span class="hljs-string">"none"</span> }
}
</code></pre>
<p>æ­¤ç»“æ„åœ¨æœåŠ¡ç«¯æ¸²æŸ“æ—¶å³èƒ½å†³å®šå…ƒç´ æ˜¯å¦éšè—ï¼Œè€Œä¸ä¾èµ–æµè§ˆå™¨æ‰§è¡Œé€»è¾‘ã€‚</p>
<hr/>
<h2 data-id="heading-7">ä¸‰ã€å¯¹æ¯”åˆ†æï¼š<code>v-show</code> vs <code>v-if</code> åœ¨ SSR ä¸­çš„å·®å¼‚</h2>























<table><thead><tr><th>æŒ‡ä»¤</th><th>æ¸²æŸ“æœºåˆ¶</th><th>SSR è¡¨ç°</th><th>æ€§èƒ½ç‰¹å¾</th></tr></thead><tbody><tr><td><code>v-if</code></td><td>æ¡ä»¶æ€§æ¸²æŸ“ï¼ˆåˆ›å»º/é”€æ¯ DOMï¼‰</td><td>æœåŠ¡ç«¯ç›´æ¥ç”Ÿæˆæˆ–çœç•¥å¯¹åº” HTML</td><td>è½»é‡ä½†æœ‰é‡ç»˜ä»£ä»·</td></tr><tr><td><code>v-show</code></td><td>æ ·å¼æ§åˆ¶ï¼ˆ<code>display: none</code>ï¼‰</td><td>æœåŠ¡ç«¯ç”Ÿæˆå…ƒç´ ä½†éšè—</td><td>ä¿æŒç»“æ„å®Œæ•´ï¼Œé€‚ç”¨äºé¢‘ç¹åˆ‡æ¢æ˜¾ç¤º</td></tr></tbody></table>
<p>ğŸ“Œ ç»“è®ºï¼š<code>ssrTransformShow</code> çš„å­˜åœ¨ï¼Œä½¿å¾— <code>v-show</code> ä¹Ÿèƒ½åœ¨ SSR è¾“å‡ºé˜¶æ®µä¿ç•™ DOM ç»“æ„ä¸€è‡´æ€§ï¼Œæœ‰åˆ©äº <strong>hydrationï¼ˆå®¢æˆ·ç«¯æ¿€æ´»ï¼‰</strong> ä¸€è‡´æ€§ã€‚</p>
<hr/>
<h2 data-id="heading-8">å››ã€å®è·µéƒ¨åˆ†ï¼šè‡ªå®šä¹‰ SSR æŒ‡ä»¤è½¬æ¢ç¤ºä¾‹</h2>
<p>å‡è®¾æˆ‘ä»¬è¦å®ç°ä¸€ä¸ªç±»ä¼¼ <code>v-visible</code> çš„ SSR æŒ‡ä»¤ï¼Œå…¶é€»è¾‘ä¸ <code>v-show</code> ç±»ä¼¼ä½†æ§åˆ¶ <code>visibility</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">ssrTransformVisible</span>: <span class="hljs-title class_">DirectiveTransform</span> = <span class="hljs-function">(<span class="hljs-params">dir, node, context</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (!dir.<span class="hljs-property">exp</span>) {
    context.<span class="hljs-title function_">onError</span>(<span class="hljs-title function_">createDOMCompilerError</span>(<span class="hljs-title class_">DOMErrorCodes</span>.<span class="hljs-property">X_V_SHOW_NO_EXPRESSION</span>))
  }
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">props</span>: [
      <span class="hljs-title function_">createObjectProperty</span>(
        <span class="hljs-string">`style`</span>,
        <span class="hljs-title function_">createConditionalExpression</span>(
          dir.<span class="hljs-property">exp</span>!,
          <span class="hljs-title function_">createSimpleExpression</span>(<span class="hljs-string">`null`</span>, <span class="hljs-literal">false</span>),
          <span class="hljs-title function_">createObjectExpression</span>([
            <span class="hljs-title function_">createObjectProperty</span>(
              <span class="hljs-string">`visibility`</span>,
              <span class="hljs-title function_">createSimpleExpression</span>(<span class="hljs-string">`hidden`</span>, <span class="hljs-literal">true</span>),
            ),
          ]),
          <span class="hljs-literal">false</span>,
        ),
      ),
    ],
  }
}
</code></pre>
<p>ğŸ”§ ç¼–è¯‘ç»“æœï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;div <span class="hljs-attr">v-visible</span>=<span class="hljs-string">"isVisible"</span>&gt;&lt;/div&gt;
</code></pre>
<p>â¡ SSR æ¸²æŸ“åï¼š</p>
<pre><code class="hljs language-css" lang="css">{
  style: isVisible ? null : { <span class="hljs-attribute">visibility</span>: <span class="hljs-string">"hidden"</span> }
}
</code></pre>
<hr/>
<h2 data-id="heading-9">äº”ã€æ‹“å±•æ€è€ƒï¼šSSR ç¼–è¯‘å™¨çš„å¯æ‰©å±•æ€§æœºåˆ¶</h2>
<p>Vue ç¼–è¯‘å™¨çš„è®¾è®¡é«˜åº¦æ¨¡å—åŒ–ã€‚<br/>
æ‰€æœ‰æŒ‡ä»¤éƒ½é€šè¿‡ç±»ä¼¼çš„ <code>DirectiveTransform</code> æ¥å£å®ç°ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">DirectiveTransform</span> {
  (dir: DirectiveNode, node: ElementNode, context: TransformContext): TransformResult
}
</code></pre>
<p>å› æ­¤å¼€å‘è€…å¯è‡ªç”±æ‰©å±•ï¼š</p>
<ul>
<li>æ–°å¢è‡ªå®šä¹‰æŒ‡ä»¤ï¼›</li>
<li>ä¸º SSR å®šä¹‰ç‹¬ç«‹è½¬æ¢é€»è¾‘ï¼›</li>
<li>æ‹“å±• AST èŠ‚ç‚¹ç»“æ„ï¼›</li>
<li>å®ç°æ’ä»¶å¼ç¼–è¯‘ä¸­é—´å±‚ã€‚</li>
</ul>
<p>è¿™ä¹Ÿæ˜¯ Vue ç¼–è¯‘å™¨èƒ½æ”¯æŒå¤šå¹³å°ï¼ˆWebã€SSRã€Custom Rendererï¼‰çš„å…³é”®æœºåˆ¶ã€‚</p>
<hr/>
<h2 data-id="heading-10">å…­ã€æ½œåœ¨é—®é¢˜ä¸æ³¨æ„äº‹é¡¹</h2>
<ol>
<li><strong><code>v-show</code> çš„åŠ¨æ€æ€§ç¼ºå¤±</strong><br/>
SSR ä»…å¤„ç†åˆå§‹æ¸²æŸ“ï¼Œåç»­ä»éœ€åœ¨å®¢æˆ·ç«¯ç”± runtime æ›´æ–°æ ·å¼ã€‚<br/>
è‹¥è¡¨è¾¾å¼ä¾èµ–å¼‚æ­¥æ•°æ®ï¼Œåˆ™ SSR é˜¶æ®µæ— æ³•ç²¾ç¡®æ§åˆ¶ã€‚</li>
<li><strong>æ ·å¼è¦†ç›–å†²çª</strong><br/>
è‹¥æ¨¡æ¿æˆ– CSS å·²è®¾ç½® <code>display</code> æ ·å¼ï¼ŒSSR è¾“å‡ºçš„å†…è”æ ·å¼å¯èƒ½è¢«è¦†ç›–ã€‚</li>
<li><strong>hydration ä¸ä¸€è‡´é£é™©</strong><br/>
è‹¥ SSR é˜¶æ®µä¸å®¢æˆ·ç«¯åˆå§‹æ•°æ®ä¸ä¸€è‡´ï¼Œä¼šé€ æˆ hydration mismatchã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-11">æ€»ç»“</h2>
<p><code>ssrTransformShow</code> æ˜¯ Vue SSR ç¼–è¯‘ç®¡çº¿ä¸­çš„ä¸€ä¸ªå°è€Œç²¾çš„ç»„ä»¶ï¼Œå…¶æ ¸å¿ƒä½¿å‘½æ˜¯ï¼š</p>
<blockquote>
<p>å°†â€œæ˜¾ç¤ºæ§åˆ¶æŒ‡ä»¤â€è½¬è¯‘ä¸ºâ€œæ ·å¼è¡¨è¾¾å¼â€ï¼Œç¡®ä¿ SSR è¾“å‡ºç»“æ„å®Œæ•´ä¸”å¯é¢„æµ‹ã€‚</p>
</blockquote>
<p>é€šè¿‡ <code>createConditionalExpression</code>ã€<code>createObjectExpression</code> ç­‰å‡½æ•°çš„ç»„åˆï¼ŒVue å®ç°äº†â€œ<strong>æ¨¡æ¿ â†’ AST â†’ SSR è¡¨è¾¾å¼</strong>â€çš„å…¨é“¾æ¡è‡ªåŠ¨åŒ–ç¼–è¯‘ã€‚</p>
<hr/>
<p><strong>æœ¬æ–‡éƒ¨åˆ†å†…å®¹å€ŸåŠ© AI è¾…åŠ©ç”Ÿæˆï¼Œå¹¶ç”±ä½œè€…æ•´ç†å®¡æ ¸ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±åº¦è§£æï¼šVue SSR ç¼–è¯‘å™¨ä¸­çš„ ssrTransformElement ä¸ ssrProcessElement]]></title>    <link>https://juejin.cn/post/7569913182036000778</link>    <guid>https://juejin.cn/post/7569913182036000778</guid>    <pubDate>2025-11-08T23:34:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7569913182036000778" data-draft-id="7569886315197612083" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±åº¦è§£æï¼šVue SSR ç¼–è¯‘å™¨ä¸­çš„ ssrTransformElement ä¸ ssrProcessElement"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-08T23:34:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="excel"/> <meta itemprop="url" content="https://juejin.cn/user/2911162520062862"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±åº¦è§£æï¼šVue SSR ç¼–è¯‘å™¨ä¸­çš„ ssrTransformElement ä¸ ssrProcessElement
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2911162520062862/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    excel
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-08T23:34:19.000Z" title="Sat Nov 08 2025 23:34:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€æ¦‚å¿µæ¦‚è¿°</h2>
<p>åœ¨ Vue 3 çš„ SSRï¼ˆServer-Side Renderingï¼‰ç¼–è¯‘é˜¶æ®µï¼Œ<code>ssrTransformElement</code> æ˜¯è´Ÿè´£å°†æ¨¡æ¿ä¸­çš„ DOM å…ƒç´ ï¼ˆ<code>&lt;div&gt;</code>, <code>&lt;input&gt;</code>, <code>&lt;textarea&gt;</code> ç­‰ï¼‰è½¬åŒ–ä¸ºå¯åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“çš„ <strong>å­—ç¬¦ä¸²æ„å»ºä»£ç </strong> çš„æ ¸å¿ƒé€»è¾‘ä¹‹ä¸€ã€‚<br/>
å®ƒçš„ä¸»è¦èŒè´£æ˜¯ï¼š</p>
<ol>
<li>åˆ†ææ¨¡æ¿ AST èŠ‚ç‚¹ï¼ˆAbstract Syntax Treeï¼‰ã€‚</li>
<li>å¤„ç†é™æ€ä¸åŠ¨æ€å±æ€§ï¼ˆ<code>v-bind</code>ã€<code>v-model</code>ã€<code>v-text</code>ã€<code>v-html</code> ç­‰ï¼‰ã€‚</li>
<li>æ„å»ºæœ€ç»ˆå¯æ‰§è¡Œçš„ SSR æ¸²æŸ“ä»£ç ï¼ˆå³å­—ç¬¦ä¸²æ‹¼æ¥é€»è¾‘ï¼‰ã€‚</li>
<li>ä¸º <code>ssrProcessElement</code> é˜¶æ®µæä¾›ç»“æ„åŒ–çš„è¾“å‡ºæ•°æ®ï¼ˆ<code>node.ssrCodegenNode</code>ï¼‰ã€‚</li>
</ol>
<p>è€Œ <code>ssrProcessElement</code> åˆ™æ˜¯å°† <code>ssrTransformElement</code> é˜¶æ®µå‡†å¤‡å¥½çš„æŒ‡ä»¤ç»“æ„ <strong>å…·ä½“è¾“å‡ºä¸ºæœ€ç»ˆ HTML å­—ç¬¦ä¸²</strong> çš„é˜¶æ®µã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€åŸç†å‰–æ</h2>
<h3 data-id="heading-2">1. SSR ç¼–è¯‘å™¨çš„åŒé˜¶æ®µæœºåˆ¶</h3>
<p>Vue çš„ SSR ç¼–è¯‘åˆ†ä¸ºä¸¤ä¸ªä¸»è¦é˜¶æ®µï¼š</p>

















<table><thead><tr><th>é˜¶æ®µ</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><strong>Transform é˜¶æ®µï¼ˆå¦‚ <code>ssrTransformElement</code>ï¼‰</strong></td><td>åˆ†æ ASTï¼Œæå–åŠ¨æ€å±æ€§ä¸æŒ‡ä»¤ï¼Œç”Ÿæˆä¸­é—´ç»“æ„</td></tr><tr><td><strong>Codegen é˜¶æ®µï¼ˆå¦‚ <code>ssrProcessElement</code>ï¼‰</strong></td><td>æ ¹æ® Transform çš„ç»“æœæ‹¼æ¥æœ€ç»ˆ HTML å­—ç¬¦ä¸²</td></tr></tbody></table>
<p>è¿™ä¸¤ä¸ªé˜¶æ®µåˆ†åˆ«è¿è¡Œåœ¨ <strong>ç¼–è¯‘æœŸï¼ˆæ„å»ºæ—¶ï¼‰</strong> å’Œ <strong>è¿è¡ŒæœŸï¼ˆè¯·æ±‚æ—¶ï¼‰</strong> ï¼Œç¡®ä¿æ€§èƒ½ä¸çµæ´»æ€§å¹¶å­˜ã€‚</p>
<hr/>
<h3 data-id="heading-3">2. <code>ssrTransformElement</code> æ ¸å¿ƒç»“æ„è§£æ</h3>
<h4 data-id="heading-4">å…³é”®æµç¨‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">ssrTransformElement</span>: <span class="hljs-title class_">NodeTransform</span> = <span class="hljs-function">(<span class="hljs-params">node, context</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> !== <span class="hljs-title class_">NodeTypes</span>.<span class="hljs-property">ELEMENT</span> || node.<span class="hljs-property">tagType</span> !== <span class="hljs-title class_">ElementTypes</span>.<span class="hljs-property">ELEMENT</span>) {
    <span class="hljs-keyword">return</span>
  }

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ssrPostTransformElement</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// Step 1: åˆå§‹åŒ–æ¨¡æ¿å­—é¢é‡</span>
    <span class="hljs-keyword">const</span> <span class="hljs-attr">openTag</span>: <span class="hljs-title class_">TemplateLiteral</span>[<span class="hljs-string">'elements'</span>] = [<span class="hljs-string">`&lt;<span class="hljs-subst">${node.tag}</span>`</span>]

    <span class="hljs-comment">// Step 2: æ£€æŸ¥åŠ¨æ€ç»‘å®šä¸è‡ªå®šä¹‰æŒ‡ä»¤</span>
    <span class="hljs-keyword">const</span> hasDynamicVBind = <span class="hljs-title function_">hasDynamicKeyVBind</span>(node)
    <span class="hljs-keyword">const</span> hasCustomDir = node.<span class="hljs-property">props</span>.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.<span class="hljs-property">type</span> === <span class="hljs-title class_">NodeTypes</span>.<span class="hljs-property">DIRECTIVE</span> &amp;&amp; !<span class="hljs-title function_">isBuiltInDirective</span>(p.<span class="hljs-property">name</span>))

    <span class="hljs-comment">// Step 3: è‹¥å­˜åœ¨åŠ¨æ€ç»‘å®šæˆ–è‡ªå®šä¹‰æŒ‡ä»¤ï¼Œåˆ™ç”ŸæˆåŠ¨æ€å±æ€§è¡¨è¾¾å¼</span>
    <span class="hljs-keyword">if</span> (hasDynamicVBind || hasCustomDir) {
      <span class="hljs-keyword">const</span> { props, directives } = <span class="hljs-title function_">buildProps</span>(node, context, node.<span class="hljs-property">props</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>)
      <span class="hljs-keyword">const</span> mergedProps = <span class="hljs-title function_">buildSSRProps</span>(props, directives, context)
      <span class="hljs-keyword">const</span> propsExp = <span class="hljs-title function_">createCallExpression</span>(context.<span class="hljs-title function_">helper</span>(<span class="hljs-variable constant_">SSR_RENDER_ATTRS</span>), [mergedProps])
      openTag.<span class="hljs-title function_">push</span>(propsExp)
    }

    <span class="hljs-comment">// Step 4: ç”Ÿæˆæœ€ç»ˆ SSR æ¨¡æ¿å­—ç¬¦ä¸²èŠ‚ç‚¹</span>
    node.<span class="hljs-property">ssrCodegenNode</span> = <span class="hljs-title function_">createTemplateLiteral</span>(openTag)
  }
}
</code></pre>
<h4 data-id="heading-5">ä»£ç é€æ®µæ³¨é‡Š</h4>

































<table><thead><tr><th>ç‰‡æ®µ</th><th>åŠŸèƒ½è¯´æ˜</th></tr></thead><tbody><tr><td><code>openTag</code></td><td>æ„å»º HTML èµ·å§‹æ ‡ç­¾çš„æ¨¡æ¿ç‰‡æ®µï¼Œå¦‚ <code>&lt;div</code> æˆ– <code>&lt;input</code>ã€‚</td></tr><tr><td><code>hasDynamicVBind</code></td><td>åˆ¤æ–­æ˜¯å¦å­˜åœ¨åŠ¨æ€å±æ€§ï¼ˆ<code>v-bind:[key]</code>ï¼‰ã€‚</td></tr><tr><td><code>buildProps</code></td><td>å°†æ‰€æœ‰å±æ€§ä¸æŒ‡ä»¤æ±‡æ€»ä¸ºç»Ÿä¸€çš„ <code>props</code> è¡¨è¾¾å¼ã€‚</td></tr><tr><td><code>buildSSRProps</code></td><td>åˆå¹¶ <code>v-bind</code> ä¸æŒ‡ä»¤ç”Ÿæˆçš„å±æ€§é›†åˆã€‚</td></tr><tr><td><code>createCallExpression(SSR_RENDER_ATTRS, ...)</code></td><td>ç”Ÿæˆè¿è¡Œæ—¶è°ƒç”¨ï¼Œå®é™…æ‰§è¡Œæ—¶ä¼šè°ƒç”¨ <code>ssrRenderAttrs()</code> æ¥è¾“å‡ºå­—ç¬¦ä¸²å±æ€§ã€‚</td></tr><tr><td><code>createTemplateLiteral</code></td><td>å°†æ‰€æœ‰éƒ¨åˆ†æ‹¼æ¥æˆæœ€ç»ˆå¯åºåˆ—åŒ–çš„æ¨¡æ¿å­—ç¬¦ä¸²ç»“æ„ã€‚</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-6">3. <code>buildSSRProps</code> çš„åˆå¹¶é€»è¾‘</h3>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">export</span> <span class="hljs-selector-tag">function</span> <span class="hljs-selector-tag">buildSSRProps</span>(
  <span class="hljs-attribute">props</span>: PropsExpression | undefined,
  <span class="hljs-attribute">directives</span>: DirectiveNode[],
  <span class="hljs-attribute">context</span>: TransformContext,
): <span class="hljs-selector-tag">JSChildNode</span> {
  <span class="hljs-selector-tag">let</span> <span class="hljs-selector-tag">mergePropsArgs</span>: <span class="hljs-selector-tag">JSChildNode</span><span class="hljs-selector-attr">[]</span> = <span class="hljs-selector-attr">[]</span>

  <span class="hljs-selector-tag">if</span> (props) {
    <span class="hljs-selector-tag">mergePropsArgs</span><span class="hljs-selector-class">.push</span>(props)
  }

  <span class="hljs-selector-tag">for</span> (const dir of directives) {
    <span class="hljs-selector-tag">mergePropsArgs</span><span class="hljs-selector-class">.push</span>(
      <span class="hljs-built_in">createCallExpression</span>(context.<span class="hljs-built_in">helper</span>(SSR_GET_DIRECTIVE_PROPS), [
        <span class="hljs-built_in">`_ctx`</span>,
        ...<span class="hljs-built_in">buildDirectiveArgs</span>(dir, context).elements,
      ])
    )
  }

  <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">mergePropsArgs</span><span class="hljs-selector-class">.length</span> &gt; <span class="hljs-number">1</span>
    ? <span class="hljs-selector-tag">createCallExpression</span>(context.<span class="hljs-built_in">helper</span>(MERGE_PROPS), mergePropsArgs)
    : <span class="hljs-selector-tag">mergePropsArgs</span><span class="hljs-selector-attr">[0]</span>
}
</code></pre>
<p><strong>è§£é‡Šï¼š</strong></p>
<ul>
<li><code>MERGE_PROPS</code> å®é™…å¯¹åº”è¿è¡Œæ—¶çš„ <code>Object.assign()</code> æˆ–åˆå¹¶å‡½æ•°ï¼›</li>
<li>è‹¥å­˜åœ¨å¤šä¸ªæŒ‡ä»¤æˆ–åŠ¨æ€ç»‘å®šï¼Œåˆ™è°ƒç”¨ <code>mergeProps</code>ï¼›</li>
<li>è‹¥åªæœ‰ä¸€ä¸ªï¼Œåˆ™ç›´æ¥è¿”å›å•ä¸€è¡¨è¾¾å¼ï¼›</li>
<li>æœ€ç»ˆç»“æœä¼šäº¤ç»™ <code>SSR_RENDER_ATTRS</code> è´Ÿè´£è¾“å‡º HTML å±æ€§å­—ç¬¦ä¸²ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-7">4. <code>ssrProcessElement</code> è¾“å‡ºé˜¶æ®µ</h3>
<pre><code class="hljs language-scss" lang="scss">export function <span class="hljs-built_in">ssrProcessElement</span>(
  node: PlainElementNode,
  context: SSRTransformContext,
): void {
  const elementsToAdd = node<span class="hljs-selector-class">.ssrCodegenNode</span>!<span class="hljs-selector-class">.elements</span>
  for (let j = <span class="hljs-number">0</span>; j &lt; elementsToAdd.length; j++) {
    context<span class="hljs-selector-class">.pushStringPart</span>(elementsToAdd[j])
  }

  context<span class="hljs-selector-class">.pushStringPart</span>(`&gt;`) <span class="hljs-comment">// å…³é—­èµ·å§‹æ ‡ç­¾</span>
  const rawChildren = rawChildrenMap<span class="hljs-selector-class">.get</span>(node)

  if (rawChildren) {
    context<span class="hljs-selector-class">.pushStringPart</span>(rawChildren)
  } else if (node.children.length) {
    <span class="hljs-built_in">processChildren</span>(node, context)
  }

  if (!isVoidTag(node.tag)) {
    context<span class="hljs-selector-class">.pushStringPart</span>(`&lt;/${node.tag}&gt;`)
  }
}
</code></pre>
<h4 data-id="heading-8">æ³¨é‡Šè¯´æ˜ï¼š</h4>






























<table><thead><tr><th>æ­¥éª¤</th><th>åŠ¨ä½œ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>â‘ </td><td>è¾“å‡º <code>node.ssrCodegenNode</code> ä¸­ä¿å­˜çš„æ‰€æœ‰ç‰‡æ®µ</td><td>åŒ…æ‹¬ <code>&lt;div</code>, å±æ€§å­—ç¬¦ä¸²ç­‰</td></tr><tr><td>â‘¡</td><td>è¾“å‡º <code>&gt;</code></td><td>æ ‡è®°æ ‡ç­¾èµ·å§‹ç»“æŸ</td></tr><tr><td>â‘¢</td><td>å¤„ç† <code>rawChildren</code> æˆ–é€’å½’å¤„ç†å­èŠ‚ç‚¹</td><td>æ”¯æŒ <code>v-html</code>ã€<code>v-text</code> ç­‰ç‰¹æ®Šæƒ…å†µ</td></tr><tr><td>â‘£</td><td>è‹¥ä¸æ˜¯ç©ºæ ‡ç­¾ï¼ˆå¦‚ <code>&lt;br&gt;</code>ã€<code>&lt;img&gt;</code>ï¼‰ï¼Œè¾“å‡ºé—­åˆæ ‡ç­¾</td><td>è¾“å‡º <code>&lt;/div&gt;</code></td></tr></tbody></table>
<hr/>
<h2 data-id="heading-9">ä¸‰ã€å¯¹æ¯”åˆ†æï¼šä¸æ™®é€šç¼–è¯‘å™¨çš„å·®å¼‚</h2>






























<table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>å®¢æˆ·ç«¯ç¼–è¯‘å™¨ (<code>@vue/compiler-dom</code>)</th><th>SSR ç¼–è¯‘å™¨ (<code>@vue/compiler-ssr</code>)</th></tr></thead><tbody><tr><td>è¾“å‡ºç›®æ ‡</td><td>æ¸²æŸ“å‡½æ•° (VNode)</td><td>HTML å­—ç¬¦ä¸²</td></tr><tr><td>åŠ¨æ€ç»‘å®š</td><td>è½¬ä¸ºå“åº”å¼è¡¨è¾¾å¼</td><td>è½¬ä¸ºå­—ç¬¦ä¸²æ‹¼æ¥è°ƒç”¨</td></tr><tr><td>v-model</td><td>è¿è¡Œæ—¶å¤„ç†</td><td>ç¼–è¯‘æœŸé™æ€æ’å…¥</td></tr><tr><td>è¾“å‡ºæ€§èƒ½</td><td>ä¾èµ–è¿è¡Œæ—¶ diff</td><td>ä¸€æ¬¡æ€§ç”Ÿæˆå®Œæ•´ HTML</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-10">å››ã€å®è·µï¼šæ‰‹åŠ¨è°ƒè¯• SSR Element è½¬æ¢</h2>
<p>å‡è®¾æ¨¡æ¿å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;textarea <span class="hljs-attr">v-bind</span>=<span class="hljs-string">"obj"</span> v-model=<span class="hljs-string">"content"</span>&gt;&lt;/textarea&gt;
</code></pre>
<p>ç»è¿‡ <code>ssrTransformElement</code> å¤„ç†åï¼Œå°†ç”Ÿæˆå¦‚ä¸‹ä¼ªä»£ç ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">_ssrRenderAttrs</span>(<span class="hljs-built_in">_mergeProps</span>(obj, <span class="hljs-built_in">_ssrGetDynamicModelProps</span>(obj, content)))
</code></pre>
<p>è§£é‡Šï¼š</p>
<ul>
<li><code>obj</code> æä¾›åŠ¨æ€ç»‘å®šå±æ€§ï¼›</li>
<li><code>v-model</code> åœ¨ SSR é˜¶æ®µè½¬ä¸º <code>_ssrGetDynamicModelProps()</code>ï¼›</li>
<li><code>MERGE_PROPS</code> åˆå¹¶ä¸¤è€…ï¼›</li>
<li>è¿è¡Œæ—¶ä¼šè‡ªåŠ¨æ¸²æŸ“å‡ºï¼š</li>
</ul>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">textarea</span> value="<span class="hljs-attribute">content</span>-value"&gt;&lt;/<span class="hljs-selector-tag">textarea</span>&gt;
</code></pre>
<hr/>
<h2 data-id="heading-11">äº”ã€æ‹“å±•ä¸é«˜çº§æœºåˆ¶</h2>
<ol>
<li>
<p><strong>rawChildrenMap çš„ä½œç”¨</strong><br/>
ç”¨äºè®°å½•éœ€è¦åœ¨ SSR è¾“å‡ºé˜¶æ®µç‰¹æ®Šæ›¿æ¢çš„èŠ‚ç‚¹å†…å®¹ï¼Œå¦‚ï¼š</p>
<ul>
<li><code>v-html</code></li>
<li><code>v-text</code></li>
<li><code>&lt;textarea&gt;</code> çš„åŠ¨æ€ <code>value</code></li>
</ul>
</li>
<li>
<p><strong>åŠ¨æ€å±æ€§æ¸²æŸ“å‡½æ•°</strong></p>
<ul>
<li><code>SSR_RENDER_ATTR</code>ï¼šæ¸²æŸ“é™æ€å®‰å…¨å±æ€§ã€‚</li>
<li><code>SSR_RENDER_DYNAMIC_ATTR</code>ï¼šå¤„ç†åŠ¨æ€ key å±æ€§ã€‚</li>
<li><code>SSR_RENDER_STYLE</code> / <code>SSR_RENDER_CLASS</code>ï¼šåˆå¹¶ style ä¸ classã€‚</li>
</ul>
</li>
<li>
<p><strong>å®‰å…¨ä¸å…¼å®¹æ€§</strong></p>
<ul>
<li>é€šè¿‡ <code>isSSRSafeAttrName</code> è¿‡æ»¤æ½œåœ¨ XSS é£é™©ã€‚</li>
<li>å¯¹è‡ªå®šä¹‰å…ƒç´ ï¼ˆ<code>&lt;my-element&gt;</code>ï¼‰ä¿ç•™åŸå§‹å±æ€§åã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h2 data-id="heading-12">å…­ã€æ½œåœ¨é—®é¢˜ä¸æ³¨æ„äº‹é¡¹</h2>






























<table><thead><tr><th>é—®é¢˜ç±»å‹</th><th>æè¿°</th><th>è§£å†³æ€è·¯</th></tr></thead><tbody><tr><td><strong>åŠ¨æ€å±æ€§è¦†ç›–</strong></td><td>å¤šä¸ª <code>v-bind</code> å¯èƒ½è¦†ç›–é™æ€å±æ€§</td><td>é€šè¿‡ <code>MERGE_PROPS</code> é¡ºåºåˆå¹¶</td></tr><tr><td><strong>Textarea å†…å®¹å†²çª</strong></td><td>åŒæ—¶å­˜åœ¨ <code>v-bind</code> ä¸é™æ€æ–‡æœ¬</td><td>é€šè¿‡ä¸´æ—¶å˜é‡ <code>_temp</code> åˆ¤æ–­æ˜¯å¦å«æœ‰ <code>.value</code></td></tr><tr><td><strong>æŒ‡ä»¤ä¼˜å…ˆçº§æ··ä¹±</strong></td><td>å¦‚ <code>v-text</code> ä¸ <code>v-html</code> å¹¶å­˜</td><td>é€šè¿‡ <code>rawChildrenMap</code> åç½®å¤„ç†</td></tr><tr><td><strong>æ€§èƒ½æŸè€—</strong></td><td>å¤šå±‚ <code>mergeProps</code> åµŒå¥—å¯èƒ½é™ä½æ€§èƒ½</td><td>ç¼–è¯‘é˜¶æ®µå°½é‡åˆå¹¶é™æ€å±æ€§</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-13">ç»“è¯­</h2>
<p><code>ssrTransformElement</code> ä¸ <code>ssrProcessElement</code> å…±åŒæ„æˆäº† Vue SSR ç¼–è¯‘ç®¡çº¿çš„ã€Œç»“æ„ç”Ÿæˆ â†’ æ¸²æŸ“è¾“å‡ºã€é—­ç¯ã€‚å®ƒä»¬çš„è®¾è®¡ä½“ç°äº† Vue åœ¨æ¨¡æ¿ç¼–è¯‘å±‚é¢å¯¹ <strong>åŠ¨æ€æ€§ã€æ€§èƒ½ä¸å®‰å…¨æ€§</strong> çš„ä¸‰é‡å¹³è¡¡ã€‚</p>
<p>é€šè¿‡è¿™ä¸€æœºåˆ¶ï¼ŒVue èƒ½å¤Ÿåœ¨æœåŠ¡ç«¯ç”Ÿæˆä¸å®¢æˆ·ç«¯å‡ ä¹ä¸€è‡´çš„ DOM æ ‘ï¼Œä»è€Œå®ç°æ— ç¼ hydrationã€‚</p>
<hr/>
<p><strong>æœ¬æ–‡éƒ¨åˆ†å†…å®¹å€ŸåŠ© AI è¾…åŠ©ç”Ÿæˆï¼Œå¹¶ç”±ä½œè€…æ•´ç†å®¡æ ¸ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¯»æ‡‚ Pinï¼Œä¸€æ¬¡ææ¸… Rust æœ€éš¾çš„æŒ‡é’ˆ]]></title>    <link>https://juejin.cn/post/7569976345930956851</link>    <guid>https://juejin.cn/post/7569976345930956851</guid>    <pubDate>2025-11-09T12:34:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7569976345930956851" data-draft-id="7569976345930924083" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¯»æ‡‚ Pinï¼Œä¸€æ¬¡ææ¸… Rust æœ€éš¾çš„æŒ‡é’ˆ"/> <meta itemprop="keywords" content="Rust"/> <meta itemprop="datePublished" content="2025-11-09T12:34:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§é±¼ä¸ƒæˆé¥±"/> <meta itemprop="url" content="https://juejin.cn/user/3017475369480509"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¯»æ‡‚ Pinï¼Œä¸€æ¬¡ææ¸… Rust æœ€éš¾çš„æŒ‡é’ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3017475369480509/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§é±¼ä¸ƒæˆé¥±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-09T12:34:12.000Z" title="Sun Nov 09 2025 12:34:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>è¿™æ˜¯Rustä¹ä¹å…«åä¸€éš¾ç¬¬13ç¯‡ï¼Œä»‹ç»ä¸‹pinæŒ‡é’ˆã€‚pinæŒ‡é’ˆè·ŸFutureç´§å¯†ç›¸å…³ï¼Œä¹Ÿç®—æ˜¯å¤šçº¿ç¨‹éƒ¨åˆ†ç¬¬ä¸‰ç¯‡ã€‚å…³äºè¿™å—ï¼Œä¹‹å‰çœ‹äº†å‡ ç¯‡æ–‡ç« ï¼Œæœ‰è¯„è®ºè¿™å—éš¾ä»¥ç†è§£ï¼Œæˆ‘ä¹ŸåŒæ„Ÿã€‚å¿˜è®°è°è¯´çš„äº†ï¼Œå¦‚æœä¸èƒ½ç®€å•æ˜äº†çš„æè¿°æŸä¸ªä¸œè¥¿ï¼Œè¯´æ˜è‡ªå·±è¿˜æ²¡çœŸæ­£æŒæ¡ã€‚æœ¬ç¯‡å°è¯•ç”¨ç®€å•æ–¹å¼æ•´ç†Pinç›¸å…³çš„çŸ¥è¯†ï¼Œæœ‰é—®é¢˜è¯·ç•™è¨€ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€åŸºæœ¬æ¦‚å¿µ</h2>
<p>å…¥é—¨pinï¼Œå…ˆè¦çŸ¥é“å››ä¸ªæ¦‚å¿µï¼špinï¼ŒUnpinå’Œ!Upin,ä»¥åŠrustçš„moveã€‚é€šè¿‡è¿™äº›æ¦‚å¿µçš„å¯¹æ¯”ï¼Œç†è§£pinçš„è¾¹ç•Œï¼Œåœ¨å“ªäº›èŒƒå›´å‘ç”Ÿä½œç”¨ã€‚</p>
<h3 data-id="heading-2">1ã€<code>Pin&lt;T&gt;</code> åˆ°åº•æ˜¯ä»€ä¹ˆ</h3>
<h3 data-id="heading-3">Pinæ˜¯ä¸ªæ™ºèƒ½æŒ‡é’ˆåŒ…è£…å™¨ã€‚æ¯”å¦‚:</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::pin::Pin;

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">x</span> = <span class="hljs-number">10</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">pinned</span> = Pin::<span class="hljs-title function_ invoke__">new</span>(&amp;x);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Pinned: {:?}"</span>, pinned);<span class="hljs-comment">//Pinned: 10</span>
}
</code></pre>
<ul>
<li>å®ƒåŒ…è£¹äº†ä¸€ä¸ªç±»å‹ <code>T</code>ï¼ˆé€šå¸¸æ˜¯æ”¾åœ¨<strong>å †ä¸Š</strong>çš„ï¼Œå¦‚ <code>Box&lt;T&gt;</code>ï¼‰ï¼Œå¯¹ <strong>!Unpin ç±»å‹</strong> ï¼Œ ç¼–è¯‘å™¨ä¼šåœ¨è¯­æ³•å±‚é¢é˜»æ­¢ç§»åŠ¨ã€‚</li>
<li>ç®€å•è¯´å°±æ˜¯å¯ä»¥æ‹¿åˆ° <code>&amp;T</code> æˆ– <code>&amp;mut T</code>ï¼Œä½†ä¿è¯ä¸ä¼šæŠŠæ•´ä¸ª <code>T</code> ç§»åˆ°åˆ«çš„å†…å­˜ä½ç½®ã€‚</li>
</ul>
<h3 data-id="heading-4">2ã€Unpinæ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p><code>Unpin</code> æ˜¯ä¸€ä¸ª <strong>æ ‡è®° trait</strong>ï¼Œè¡¨ç¤ºè¯¥ç±»å‹å¯ä»¥å®‰å…¨åœ°è¢«ç§»åŠ¨ã€‚</p>
<ul>
<li>
<p>å¤§å¤šæ•°æ™®é€šç±»å‹ï¼ˆå¦‚ <code>i32</code>, <code>String</code>, <code>Vec&lt;T&gt;</code>ï¼‰<strong>é»˜è®¤å®ç°</strong>äº† <code>Unpin</code>ï¼›</p>
</li>
<li>
<p>ä½†ä¸€äº›ç±»å‹ï¼ˆå¦‚ <code>Future</code>ã€è‡ªå¼•ç”¨ç»“æ„ï¼‰<strong>ä¸ä¼šè‡ªåŠ¨å®ç°</strong>ã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">fn</span> <span class="hljs-title function_">need_unpin</span>&lt;T: Unpin&gt;(x: T) {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"å¯ä»¥å®‰å…¨ç§»åŠ¨"</span>);
}
</code></pre>
<p>å¦‚æœæŸç±»å‹æ²¡æœ‰ <code>Unpin</code>ï¼Œé‚£ä¹ˆå®ƒå°± <strong>å¿…é¡»è¢«å›ºå®šï¼ˆpinnedï¼‰</strong> æ‰èƒ½å®‰å…¨ä½¿ç”¨ã€‚</p>
</li>
</ul>
<h3 data-id="heading-5">3ã€!Unpinæ˜¯ä»€ä¹ˆ</h3>
<p><strong><code>!Unpin</code></strong> å°±æ˜¯ <strong>æ²¡æœ‰å®ç° <code>Unpin</code> çš„ç±»å‹</strong>ï¼Œè¡¨ç¤ºç±»å‹ <strong>ä¸èƒ½éšæ„ç§»åŠ¨</strong>ã€‚<code>!Unpin</code> å¹¶ä¸æ˜¯ Rust çš„è¯­æ³•ï¼Œè€Œæ˜¯â€œæ²¡æœ‰å®ç° Unpin çš„ç±»å‹â€çš„æ„æ€ã€‚Rust é»˜è®¤ä¼šè‡ªåŠ¨ä¸ºå¤§éƒ¨åˆ†ç±»å‹å®ç° <code>Unpin</code>ï¼Œåªæœ‰å°‘æ•°ç±»å‹ï¼ˆè‡ªå¼•ç”¨ã€Futureã€PhantomPinnedï¼‰æ‰æ˜¯ <code>!Unpin</code></p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::pin::Pin;
<span class="hljs-keyword">use</span> std::marker::PhantomPinned;

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">SelfRef</span> {
    data: <span class="hljs-type">String</span>,
    ptr: *<span class="hljs-keyword">const</span> <span class="hljs-type">String</span>,
    _pin: PhantomPinned, <span class="hljs-comment">// è¡¨ç¤º !Unpin</span>
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-comment">// æ™®é€šç±»å‹ Unpin</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">x</span> = <span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">new</span>(<span class="hljs-number">42</span>);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">px</span> = Pin::<span class="hljs-title function_ invoke__">new</span>(x);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">moved_px</span> = px; <span class="hljs-comment">// âœ… å¯ä»¥ç§»åŠ¨</span>

    <span class="hljs-comment">// è‡ªå¼•ç”¨ç±»å‹ !Unpin</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">y</span> = <span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">pin</span>(SelfRef {
        data: <span class="hljs-string">"hello"</span>.<span class="hljs-title function_ invoke__">to_string</span>(),
        ptr: std::ptr::<span class="hljs-title function_ invoke__">null</span>(),
        _pin: PhantomPinned,
    });
    <span class="hljs-comment">// let moved_y = y; // âŒ ç¼–è¯‘æŠ¥é”™ï¼Œä¸å¯ç§»åŠ¨</span>
}
</code></pre>
<p>Unpin ç±»å‹ â†’ é’‰ä½ä¹Ÿèƒ½æ¬ï¼Œ!Unpin ç±»å‹ â†’ é’‰ä½åæ— æ³•æ¬ã€‚æ¢å¥è¯**!Unpin çš„ä½œç”¨æ˜¯â€œå›ºå®šå¯¹è±¡çš„åœ°å€â€ï¼Œè€Œä¸æ˜¯æ¬åŠ¨å †ä¸Šçš„æ•°æ®**ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<pre><code class="hljs language-lua" lang="lua">Stack                     Heap
+<span class="hljs-comment">-------+                 +--------+</span>
| a     | <span class="hljs-comment">--------------&gt; | "hello"|</span>
| Box   |                 +<span class="hljs-comment">--------+</span>
+<span class="hljs-comment">-------+</span>
!Unpin é˜»æ­¢ a è¢« move
</code></pre>
<ul>
<li>
<p><code>a</code>ï¼ˆæ ˆä¸Šçš„ Boxï¼‰è¢« Pin ï¼Œ æ ˆä¸Šçš„åœ°å€ä¸èƒ½è¢«ç§»åŠ¨ï¼Œå †ä¸Šçš„ <code>"hello"</code> æ•°æ®ä¸å—å½±å“</p>
</li>
<li>
<p>Pin ä½œç”¨åœ¨ <strong>æ ˆä¸Šçš„å¯¹è±¡åœ°å€</strong>ï¼Œç¡®ä¿å†…éƒ¨æŒ‡é’ˆä¸ä¼šæ‚¬ç©º</p>
</li>
</ul>
<h3 data-id="heading-6">4ã€Pinã€Unpinå’Œ!Unpinä¸‰è€…å¯¹æ¯”</h3>

























<table><thead><tr><th>ç±»å‹</th><th>Pin æ˜¯å¦ç”Ÿæ•ˆ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>Unpin</td><td>âŒ ä¸ç”Ÿæ•ˆï¼ˆé€æ˜ï¼‰</td><td>ç§»åŠ¨ä»ç„¶å…è®¸ï¼Œå®‰å…¨æ— é—®é¢˜</td></tr><tr><td>!Unpin</td><td>âœ… ç”Ÿæ•ˆ</td><td>æ ˆä¸Šå€¼è¢«å›ºå®šï¼Œç§»åŠ¨ä¼šç¼–è¯‘æŠ¥é”™ï¼Œä¿æŠ¤å†…éƒ¨å¼•ç”¨å®‰å…¨</td></tr><tr><td>Copy ç±»å‹</td><td>âŒ ä¸ç”Ÿæ•ˆ</td><td>move å…¶å®æ˜¯å¤åˆ¶ï¼ŒPin å¯¹å®ƒæ— æ„ä¹‰</td></tr></tbody></table>
<p><strong><code>Pin</code> æ˜¯åŠ¨ä½œï¼Œâ€œæŠŠå¯¹è±¡é’‰ä½â€ï¼Œ<code>Unpin</code> / <code>!Unpin</code> å†³å®šé’‰ä½åèƒ½å¦ç§»åŠ¨ã€‚</strong></p>
<h3 data-id="heading-7">5ã€Pinä¸moveçš„å…³ç³»</h3>

































<table><thead><tr><th>ç±»å‹</th><th>Copyï¼Ÿ</th><th>Unpinï¼Ÿ</th><th>Pin åç§»åŠ¨ï¼Ÿ</th><th>Pin ä½œç”¨</th></tr></thead><tbody><tr><td>i32 / bool / f64</td><td>âœ…</td><td>âœ…</td><td>âœ… å¯ä»¥ç§»åŠ¨</td><td>ä¸èµ·ä½œç”¨ï¼ˆé€æ˜ï¼‰</td></tr><tr><td>String / Vec / Box</td><td>âŒ</td><td>âœ…</td><td>âœ… å¯ä»¥ç§»åŠ¨</td><td>å¯¹ Unpin ç±»å‹ä¸èµ·ä½œç”¨</td></tr><tr><td>è‡ªå¼•ç”¨ / Future</td><td>âŒ</td><td>âŒ</td><td>âŒ ç¦æ­¢ç§»åŠ¨</td><td>Pin ç”Ÿæ•ˆï¼Œä¿æŠ¤å†…éƒ¨å¼•ç”¨</td></tr></tbody></table>
<p><strong>Pin çš„å®é™…æ„ä¹‰åªé’ˆå¯¹ !Unpin ï¼ˆPin&lt;T: !Unpin&gt;ï¼‰ç±»å‹</strong>ï¼ŒCopy æˆ– Unpin ç±»å‹( Stringã€Vecã€Box) æ ‡è®°äº† Pinï¼ˆPin&lt;T: Unpin&gt;ï¼‰ï¼Œæœ¬è´¨ä¸Šä¸èµ·ä½œç”¨ã€‚</p>
<h2 data-id="heading-8">äºŒã€æ ¸å¿ƒAPIä½¿ç”¨å…¥é—¨</h2>
<p>ä¸Šä¸€ç« èŠ‚ç¡®å®šäº†è¾¹ç•Œï¼Œè¿™ä¸€ç« çœ‹ä¸‹Pinçš„apiæ€ä¹ˆç”¨ã€‚</p>
<h3 data-id="heading-9">ç¤ºä¾‹1ï¼šPin&lt;Box&gt;</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::pin::Pin;

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Data</span> {
    value: <span class="hljs-type">String</span>,
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
  
  	<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">boxed</span> = <span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">new</span>(<span class="hljs-number">123</span>);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">pinned</span> = Pin::<span class="hljs-title function_ invoke__">new</span>(boxed);

    <span class="hljs-comment">// i32 æ˜¯ Unpinï¼Œæ‰€ä»¥å¯ä»¥å®‰å…¨å–å‡º</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">inner</span> = Pin::<span class="hljs-title function_ invoke__">into_inner</span>(pinned); 
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, inner);
   
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">data</span> = Data {
        value: <span class="hljs-string">"hello"</span>.<span class="hljs-title function_ invoke__">to_string</span>(),
    };

    <span class="hljs-comment">// æ™®é€š Boxï¼Œå¯ä»¥è‡ªç”±ç§»åŠ¨</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">boxed</span> = <span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">new</span>(data);

    <span class="hljs-comment">// Pin&lt;Box&lt;T&gt;&gt;ï¼šç¦æ­¢ç§»åŠ¨å†…éƒ¨ T</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">pinned</span>: Pin&lt;<span class="hljs-type">Box</span>&lt;Data&gt;&gt; = Pin::<span class="hljs-title function_ invoke__">new</span>(boxed);

    <span class="hljs-comment">// å®‰å…¨è®¿é—®å­—æ®µ</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Value = {}"</span>, pinned.value);

    <span class="hljs-comment">// å°è¯•ç§»åŠ¨ pinnedï¼ˆç¼–è¯‘å¤±è´¥ï¼‰ï¼Œå†…éƒ¨å€¼ï¼ˆDataï¼‰è¢«ç§»åŠ¨å‡ºåŸæ¥çš„å†…å­˜åœ°å€ï¼ŒåŸå…ˆåœ°å€ä¸Šçš„é‚£å—å †å†…å­˜å˜æˆç©ºçš„ï¼Œè¿åäº†pinçš„çº¦æŸ</span>
    <span class="hljs-comment">// let moved = *pinned; // âŒ</span>
}
</code></pre>
<p><strong>è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>Pin&lt;Box&lt;T&gt;&gt;</code> ä¿è¯ <code>T</code> åœ¨å †ä¸Šçš„åœ°å€ä¸ä¼šæ”¹å˜ï¼›ä»ç„¶å¯ä»¥ä¿®æ”¹å†…å®¹ï¼Œä½†ä¸èƒ½â€œç§»èµ°â€æ•´ä¸ªç»“æ„ä½“ã€‚</li>
<li>Pin::new()ï¼šå¯¹ <code>!Unpin</code> ç±»å‹ï¼ˆä¾‹å¦‚è‡ªå¼•ç”¨ç»“æ„ä½“ï¼‰ï¼Œä¸èƒ½ç›´æ¥ç”¨è¿™ä¸ªå‡½æ•°ã€‚ç¼–è¯‘å™¨ä¼šå¼ºåˆ¶ä½ ä½¿ç”¨ <code>unsafe { Pin::new_unchecked(...) }</code>ã€‚</li>
<li>å¦‚æœæƒ³åªæœ‰å½“ç±»å‹æ˜¯ <code>Unpin</code>ï¼ˆå¯å®‰å…¨ç§»åŠ¨ï¼‰æ—¶æ‰èƒ½ç”¨into_innerã€‚</li>
</ul>
<h3 data-id="heading-10">ç¤ºä¾‹2ï¼šè‡ªå¼•ç”¨ç»“æ„ä½“ï¼ˆ<code>Pin</code> çš„å…¸å‹åœºæ™¯ï¼‰</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::pin::Pin;
<span class="hljs-keyword">use</span> std::ptr::NonNull;

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">SelfRef</span> {
    data: <span class="hljs-type">String</span>,
    ptr: <span class="hljs-type">Option</span>&lt;NonNull&lt;<span class="hljs-type">String</span>&gt;&gt;,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">SelfRef</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">new</span>(txt: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> SelfRef {
        SelfRef {
            data: txt.<span class="hljs-title function_ invoke__">to_string</span>(),
            ptr: <span class="hljs-literal">None</span>,
        }
    }

    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">init</span>(<span class="hljs-keyword">self</span>: Pin&lt;&amp;<span class="hljs-keyword">mut</span> SelfRef&gt;) {
        <span class="hljs-comment">// å®‰å…¨åœ°æ‹¿åˆ°å†…éƒ¨å¯å˜å¼•ç”¨</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">this</span> = <span class="hljs-keyword">unsafe</span> { <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">get_unchecked_mut</span>() };
        <span class="hljs-comment">// è®¾ç½®æŒ‡é’ˆæŒ‡å‘è‡ªå·±å­—æ®µ</span>
        this.ptr = <span class="hljs-title function_ invoke__">Some</span>(NonNull::<span class="hljs-title function_ invoke__">from</span>(&amp;this.data));
    }

    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">print</span>(&amp;<span class="hljs-keyword">self</span>) {
        <span class="hljs-keyword">unsafe</span> {
            <span class="hljs-built_in">println!</span>(<span class="hljs-string">"self.data = {}"</span>, <span class="hljs-keyword">self</span>.data);
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(ptr) = <span class="hljs-keyword">self</span>.ptr {
                <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ptr -&gt; {}"</span>, ptr.<span class="hljs-title function_ invoke__">as_ref</span>());
            }
        }
    }
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">s</span> = <span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">pin</span>(SelfRef::<span class="hljs-title function_ invoke__">new</span>(<span class="hljs-string">"Rust Pin!"</span>));
    s.<span class="hljs-title function_ invoke__">as_mut</span>().<span class="hljs-title function_ invoke__">init</span>();  <span class="hljs-comment">// åˆå§‹åŒ–è‡ªå¼•ç”¨</span>
    s.<span class="hljs-title function_ invoke__">print</span>();          <span class="hljs-comment">// âœ… OKï¼šdata æ²¡è¢«ç§»åŠ¨</span>
}
</code></pre>
<h3 data-id="heading-11">ç¤ºä¾‹ 3ï¼šåœ¨å¼‚æ­¥ä»»åŠ¡ä¸­ï¼ˆ<code>Future</code> çš„å…¸å‹åº”ç”¨ï¼‰</h3>
<p><code>async fn</code> ç”Ÿæˆçš„çŠ¶æ€æœºå…¶å®æ˜¯ <strong>è‡ªå¼•ç”¨ç»“æ„ä½“</strong>ã€‚ <code>Pin</code> åœ¨è¿è¡Œæ—¶ä¿æŠ¤å®ƒä¸è¢«ç§»åŠ¨ã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::pin::Pin;
<span class="hljs-keyword">use</span> std::future::Future;
<span class="hljs-keyword">use</span> std::task::{Context, Poll};

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">MyFuture</span> {
    counter: <span class="hljs-type">u8</span>,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Future</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">MyFuture</span> {
    <span class="hljs-keyword">type</span> <span class="hljs-title class_">Output</span> = <span class="hljs-type">u8</span>;

    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">poll</span>(<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>: Pin&lt;&amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">Self</span>&gt;, _cx: &amp;<span class="hljs-keyword">mut</span> Context&lt;<span class="hljs-symbol">'_</span>&gt;) <span class="hljs-punctuation">-&gt;</span> Poll&lt;<span class="hljs-keyword">Self</span>::Output&gt; {
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">self</span>.counter &lt; <span class="hljs-number">3</span> {
            <span class="hljs-keyword">self</span>.counter += <span class="hljs-number">1</span>;
            <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Counting: {}"</span>, <span class="hljs-keyword">self</span>.counter);
            Poll::Pending
        } <span class="hljs-keyword">else</span> {
            Poll::<span class="hljs-title function_ invoke__">Ready</span>(<span class="hljs-keyword">self</span>.counter)
        }
    }
}

<span class="hljs-meta">#[tokio::main]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result</span> = MyFuture { counter: <span class="hljs-number">0</span> }.<span class="hljs-keyword">await</span>;
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Done: {}"</span>, result);
}
</code></pre>
<p><code>Pin</code> ç¡®ä¿ <code>MyFuture</code> å†…éƒ¨çŠ¶æ€ï¼ˆå¦‚å¼•ç”¨ï¼‰ä¸ä¼šåœ¨ <code>.await</code> æœŸé—´è¢«ç§»åŠ¨ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ <code>async</code> è¯­æ³•èƒ½å®‰å…¨åœ°å¤„ç†å¤æ‚çŠ¶æ€ã€‚</p>
<h3 data-id="heading-12">ç¤ºä¾‹4ï¼šunsafe</h3>
<h4 data-id="heading-13">a) Pin::new_unchecked</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">x</span> = SelfRef { ... }; <span class="hljs-comment">// !Unpin ç±»å‹</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">px</span> = <span class="hljs-keyword">unsafe</span> { Pin::<span class="hljs-title function_ invoke__">new_unchecked</span>(&amp;<span class="hljs-keyword">mut</span> x) };
</code></pre>
<ul>
<li><strong>ä¸ºä»€ä¹ˆ unsafe</strong>ï¼š
<ul>
<li>ç¼–è¯‘å™¨ä¸èƒ½ä¿è¯åç»­ä¸ä¼šç§»åŠ¨ <code>x</code></li>
<li>éœ€è¦å¼€å‘è€…ä¿è¯ <code>x</code> åœ¨ç”Ÿå‘½å‘¨æœŸå†…ä¸ä¼šç§»åŠ¨</li>
</ul>
</li>
<li>Pin::new_uncheckedï¼šå¿…é¡» <strong>100% ç¡®ä¿</strong> è¿™ä¸ªå€¼ä¸ä¼šåœ¨ pinned åè¢«ç§»åŠ¨ï¼Œä¸€èˆ¬åªåœ¨åº•å±‚æ¡†æ¶ï¼ˆå¦‚ tokioã€futuresï¼‰æˆ–è‡ªå¼•ç”¨å®ç°ä¸­ç”¨ï¼Œä¸šåŠ¡ä»£ç ä¸€èˆ¬ä¸ç”¨ã€‚</li>
</ul>
<h4 data-id="heading-14">b) Pin::get_unchecked_mut</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">px</span>: Pin&lt;&amp;<span class="hljs-keyword">mut</span> SelfRef&gt; = Pin::<span class="hljs-title function_ invoke__">new</span>(&amp;<span class="hljs-keyword">mut</span> x);

<span class="hljs-keyword">unsafe</span> {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">mut_ref</span>: &amp;<span class="hljs-keyword">mut</span> SelfRef = Pin::<span class="hljs-title function_ invoke__">get_unchecked_mut</span>(px.<span class="hljs-title function_ invoke__">as_mut</span>());
    mut_ref.ptr = &amp;<span class="hljs-keyword">mut</span> mut_ref.data; <span class="hljs-comment">// è‡ªå¼•ç”¨èµ‹å€¼</span>
}
</code></pre>
<ul>
<li>get_unchecked_mut()ï¼šä¸å®‰å…¨é€‚ç”¨ä»»ä½•ç±»å‹ï¼Œè·³è¿‡ç§»åŠ¨å®‰å…¨æ£€æŸ¥ï¼Œæ‰‹åŠ¨ä¿è¯ pinned å€¼ä¸ä¼šç§»åŠ¨</li>
</ul>
<h4 data-id="heading-15">c)  into_inner å †ä¸Šå¯¹è±¡æ‹†å›åŸç±»å‹ï¼ˆ!Unpin ç±»å‹ä¸å¯è¡Œï¼‰</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">px</span>: Pin&lt;<span class="hljs-type">Box</span>&lt;SelfRef&gt;&gt; = <span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">pin</span>(SelfRef { ... });
<span class="hljs-comment">// let b: Box&lt;SelfRef&gt; = Pin::into_inner(px); // âŒ ä¸å®‰å…¨ï¼Œç¼–è¯‘ç¦æ­¢</span>
</code></pre>
<ul>
<li>å¯¹ Unpin ç±»å‹å®‰å…¨ï¼Œå¯ä»¥æ‹†å› Box</li>
<li>å¯¹ !Unpin ç±»å‹ï¼Œæ‹†å› Box éœ€è¦ unsafe å¹¶è‡ªå·±ä¿è¯ç§»åŠ¨ä¸ä¼šç ´åå®‰å…¨ï¼ˆä¸€èˆ¬ä¸æ¨èï¼‰</li>
</ul>
<h2 data-id="heading-16">ä¸‰ã€ä¸ºä»€ä¹ˆè¦è‡ªå¼•ç”¨</h2>
<p>pinæŒ‡é’ˆå¸¸ç”¨åœºæ™¯æ˜¯è‡ªå¼•ç”¨ï¼Œè¿™é‡ŒèŠèŠè‡ªå¼•ç”¨æ˜¯å•¥ï¼Œä¸ºä»€ä¹ˆæœ‰è‡ªå¼•ç”¨ã€‚</p>
<h3 data-id="heading-17">1ã€å¯¹æ¯”æ–¹æ³•è®¿é—®å’Œå†…éƒ¨å¼•ç”¨</h3>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²å­—æ®µ <code>data</code>ï¼Œæƒ³è®¿é—®å‰ä¸¤ä¸ªå­—ç¬¦ï¼š</p>
<h4 data-id="heading-18">aã€æ–¹æ³•è®¿é—®ï¼ˆæ¨èåšæ³•ï¼‰</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">MyStruct</span> {
    data: <span class="hljs-type">String</span>,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">MyStruct</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">slice</span>(&amp;<span class="hljs-keyword">self</span>) <span class="hljs-punctuation">-&gt;</span> &amp;<span class="hljs-type">str</span> {
        &amp;<span class="hljs-keyword">self</span>.data[<span class="hljs-number">0</span>..<span class="hljs-number">2</span>] <span class="hljs-comment">// æ¯æ¬¡è°ƒç”¨éƒ½ç”Ÿæˆåˆ‡ç‰‡</span>
    }
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s</span> = MyStruct { data: <span class="hljs-string">"Hello"</span>.<span class="hljs-title function_ invoke__">into</span>() };
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, s.<span class="hljs-title function_ invoke__">slice</span>()); <span class="hljs-comment">// "He"</span>
}
</code></pre>
<ul>
<li>
<p>ä¼˜ç‚¹ï¼š
Rust borrow checker å®‰å…¨ï¼Œæ²¡æœ‰æ‚¬ç©ºæŒ‡é’ˆï¼Œç®€å•ã€å¯ç»´æŠ¤</p>
</li>
<li>
<p>ç¼ºç‚¹ï¼š
æ¯æ¬¡è°ƒç”¨éƒ½ä¼šç”Ÿæˆä¸€ä¸ªåˆ‡ç‰‡ï¼ˆéå¸¸è½»é‡çº§ï¼Œä½†åœ¨<strong>é«˜æ€§èƒ½/å¤§é‡æ•°æ®</strong>åœºæ™¯ä¸‹å¯èƒ½äº§ç”Ÿå¾®å°å¼€é”€ï¼‰</p>
</li>
</ul>
<h4 data-id="heading-19">bã€å†…éƒ¨å¼•ç”¨ï¼ˆself_ref / slice æŒ‡å‘ dataï¼‰</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">SelfRef</span> {
    data: <span class="hljs-type">String</span>,
    slice: *<span class="hljs-keyword">const</span> <span class="hljs-type">str</span>, <span class="hljs-comment">// å†…éƒ¨æŒ‡é’ˆ</span>
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">SelfRef</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">new</span>(txt: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-keyword">Self</span> {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">s</span> = SelfRef {
            data: txt.<span class="hljs-title function_ invoke__">to_string</span>(),
            slice: std::ptr::<span class="hljs-title function_ invoke__">null</span>(),
        };
        s.slice = &amp;s.data[<span class="hljs-number">0</span>..<span class="hljs-number">2</span>] <span class="hljs-keyword">as</span> *<span class="hljs-keyword">const</span> <span class="hljs-type">str</span>; <span class="hljs-comment">// æŒ‡å‘ data</span>
        s
    }

    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">get_slice</span>(&amp;<span class="hljs-keyword">self</span>) <span class="hljs-punctuation">-&gt;</span> &amp;<span class="hljs-type">str</span> {
        <span class="hljs-keyword">unsafe</span> { &amp;*<span class="hljs-keyword">self</span>.slice }
    }
}
</code></pre>
<ul>
<li>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li><strong>é›¶æ‹·è´</strong>ï¼šåˆ‡ç‰‡é¢„å…ˆè®¡ç®—å¥½ï¼Œè®¿é—®ä¸éœ€è¦æ¯æ¬¡åˆ‡åˆ†</li>
<li>å¯ç”¨äº<strong>å¼‚æ­¥/è‡ªå¼•ç”¨ç»“æ„</strong>ï¼Œé¿å…åœ¨ Future çŠ¶æ€æœº poll æ—¶é‡å¤ç”Ÿæˆåˆ‡ç‰‡</li>
</ul>
</li>
<li>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>å¿…é¡»ä½¿ç”¨ <strong>Pin</strong> æˆ–å †åˆ†é…ä¿è¯ <code>data</code> åœ°å€ä¸å˜</li>
<li>ä½¿ç”¨è£¸æŒ‡é’ˆï¼Œéœ€è¦ <code>unsafe</code>ï¼Œé£é™©å¤§</li>
<li>ç¨‹åºå¤æ‚åº¦é«˜ï¼Œå¯ç»´æŠ¤æ€§å·®</li>
</ul>
</li>
</ul>
<h3 data-id="heading-20">2ã€è‡ªå¼•ç”¨åœºæ™¯</h3>
<h4 data-id="heading-21">aã€é›¶æ‹·è´è§£æ</h4>
<p>HTTPã€JSONã€CSVã€æ–‡æœ¬æµç­‰å¤§é‡æ•°æ®å¤„ç†ï¼Œæƒ³å­˜å‚¨å¯¹ buffer çš„åˆ‡ç‰‡ï¼Œè€Œä¸æ˜¯å¤åˆ¶å­—ç¬¦ä¸²ã€‚é‚£å†…éƒ¨å¼•ç”¨å¯ä»¥ç›´æ¥ä¿å­˜ sliceï¼Œé¿å…æ¯æ¬¡ <code>data[0..n]</code> ç”Ÿæˆæ–°åˆ‡ç‰‡</p>
<h4 data-id="heading-22">bã€å¼‚æ­¥çŠ¶æ€æœº / Future è‡ªå¼•ç”¨</h4>
<p>çŠ¶æ€æœºå­—æ®µä¹‹é—´å¯èƒ½äº’ç›¸å¼•ç”¨Poll æ—¶ä¸å¸Œæœ›é‡æ–°è®¡ç®— slice æˆ–ä¸´æ—¶å˜é‡</p>
<h4 data-id="heading-23">cã€é«˜æ€§èƒ½å›¾ç»“æ„ / AI / Tensor</h4>
<p>èŠ‚ç‚¹å­˜æŒ‡é’ˆæŒ‡å‘æ•°æ®çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯æ¯æ¬¡ç”Ÿæˆæ–°å¯¹è±¡</p>
<h3 data-id="heading-24">3ã€ä¸åŠ pinçš„æœ‰ä»€ä¹ˆé—®é¢˜</h3>
<p>å‡è®¾2çš„åœºæ™¯æ²¡åŠ pinï¼ŒRust ç¼–è¯‘å™¨åœ¨é¢å¯¹â€œç›´æ¥è‡ªå¼•ç”¨â€ï¼Œé€šå¸¸ä¼šï¼š</p>
<ul>
<li>
<p>å¦‚æœæ˜¯å®‰å…¨å¼•ç”¨ï¼ˆ<code>&amp;str</code>ï¼‰ï¼Œ<strong>ç›´æ¥æ‹’ç»ç¼–è¯‘</strong>ï¼›</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">BadRef</span>&lt;<span class="hljs-symbol">'a</span>&gt; {
    data: <span class="hljs-type">String</span>,
    slice: &amp;<span class="hljs-symbol">'a</span> <span class="hljs-type">str</span>, <span class="hljs-comment">// å¼•ç”¨è‡ªèº«å­—æ®µ</span>
}

<span class="hljs-keyword">impl</span>&lt;<span class="hljs-symbol">'a</span>&gt; BadRef&lt;<span class="hljs-symbol">'a</span>&gt; {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">new</span>(txt: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-keyword">Self</span> {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s</span> = txt.<span class="hljs-title function_ invoke__">to_string</span>();
        <span class="hljs-keyword">Self</span> {
            data: s,
            slice: &amp;s, <span class="hljs-comment">// âŒ ç¼–è¯‘é”™è¯¯</span>
        }
    }
}
</code></pre>
<pre><code class="hljs language-swift" lang="swift">error[<span class="hljs-type">E0505</span>]: cannot move out of `s` because it <span class="hljs-keyword">is</span> borrowed
 <span class="hljs-operator">--&gt;</span> src<span class="hljs-operator">/</span>main.rs:<span class="hljs-number">9</span>:<span class="hljs-number">13</span>
  <span class="hljs-operator">|</span>
<span class="hljs-number">8</span> <span class="hljs-operator">|</span>         <span class="hljs-keyword">let</span> s <span class="hljs-operator">=</span> txt.to_string();
  <span class="hljs-operator">|</span>             <span class="hljs-operator">-</span> binding `s` declared here
<span class="hljs-number">9</span> <span class="hljs-operator">|</span>         <span class="hljs-keyword">Self</span> { data: s, slice: <span class="hljs-operator">&amp;</span>s }
  <span class="hljs-operator">|</span>                    <span class="hljs-operator">^</span> move out of `s` occurs here
  <span class="hljs-operator">|</span>                    <span class="hljs-operator">|</span>
  <span class="hljs-operator">|</span>                    borrow later used here
</code></pre>
<p>Rust æ£€æµ‹åˆ° <code>&amp;s</code> å¼•ç”¨äº†å±€éƒ¨å˜é‡ <code>s</code>ï¼Œä½†åˆ move äº†å®ƒï¼ˆæ‰€æœ‰æƒè½¬ç§»ï¼‰ï¼Œè¿™è¿åäº†ç”Ÿå‘½å‘¨æœŸè§„åˆ™ã€‚</p>
</li>
<li>
<p>å¦‚æœç”¨è£¸æŒ‡é’ˆï¼ˆ<code>*const T</code>ï¼‰ï¼Œ<strong>ç¼–è¯‘èƒ½è¿‡ä½†å±äºæœªå®šä¹‰è¡Œä¸ºï¼ˆUBï¼‰</strong>ã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::ptr;

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">SelfRef</span> {
    data: <span class="hljs-type">String</span>,
    ptr: *<span class="hljs-keyword">const</span> <span class="hljs-type">String</span>,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">SelfRef</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">new</span>(s: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-keyword">Self</span> {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">data</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(s);
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">ptr</span> = &amp;data <span class="hljs-keyword">as</span> *<span class="hljs-keyword">const</span> <span class="hljs-type">String</span>;
        <span class="hljs-keyword">Self</span> { data, ptr }
    }

    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">print</span>(&amp;<span class="hljs-keyword">self</span>) {
        <span class="hljs-keyword">unsafe</span> {
            <span class="hljs-comment">// è®¿é—® ptr æŒ‡å‘çš„æ—§åœ°å€</span>
            <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ptr -&gt; {}"</span>, &amp;*<span class="hljs-keyword">self</span>.ptr);
        }
    }
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">x</span> = SelfRef::<span class="hljs-title function_ invoke__">new</span>(<span class="hljs-string">"hello"</span>);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">y</span> = x; <span class="hljs-comment">// move å‘ç”Ÿ</span>
    <span class="hljs-comment">// æ­¤æ—¶ y.ptr ä»æŒ‡å‘ x.data çš„æ—§åœ°å€ï¼ˆå·²è¢« dropï¼‰</span>

    y.<span class="hljs-title function_ invoke__">print</span>(); <span class="hljs-comment">// âŒ UB: è®¿é—®å·²é‡Šæ”¾å†…å­˜</span>
}
</code></pre>
<p>interrupted by signal 11:SIGSEGVï¼Œæˆ–è€…å‡ºç°ä¹±ç ï¼Œå› ä¸º <code>b.slice</code> æŒ‡å‘äº† <code>a.data</code> çš„æ—§ä½ç½®ã€‚æœ‰çš„rustç‰ˆæœ¬å¯èƒ½ä¸å´©ï¼Œæœ‰ç‚¹éšæœºï¼Œæ‰€ä»¥æ˜¯æœªå®šä¹‰è¡Œä¸ºã€‚</p>
</li>
</ul>
<h2 data-id="heading-25">å››ã€Pinå…·ä½“æ˜¯æ€ä¹ˆå›ºå®šçš„</h2>
<p><code>Pin</code> æœ¬èº«ä¸ä¿è¯å¯¹è±¡çœŸçš„â€œä¸ä¼šè¢«ç§»åŠ¨â€ï¼Œå®ƒåªæ˜¯ <strong>åœ¨ç±»å‹ç³»ç»Ÿå±‚é¢é™åˆ¶ç§»åŠ¨</strong>,ä¾èµ–äºâ€œä¸èƒ½è·å– <code>&amp;mut T</code> åŸå§‹å¼•ç”¨ï¼š</p>
<ul>
<li>å¯¹äº <code>Pin&lt;Box&lt;T&gt;&gt;</code>ï¼Œå †ä¸Šåˆ†é… + æ— æ³•æ›¿æ¢æŒ‡é’ˆ = åœ°å€ç¨³å®š</li>
<li>å¯¹äº <code>Pin&lt;&amp;mut T&gt;</code>ï¼Œç¼–è¯‘å™¨ç¦æ­¢ <code>T</code> è¢« <code>mem::replace()</code> æˆ– <code>move</code></li>
</ul>
<h3 data-id="heading-26">1ã€PhantomPinned + !Unpin</h3>
<p>Rust ç¼–è¯‘å™¨é€šè¿‡ <strong>ç±»å‹ç³»ç»Ÿçº¦æŸ</strong>å›ºå®šå†…éƒ¨æŒ‡é’ˆã€‚<code>PhantomPinned</code> ç”¨æ¥æ ‡è®°ä¸€ä¸ªç±»å‹ <strong>ä¸å¯ç§»åŠ¨</strong>ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰ç±»å‹éƒ½å®ç° <code>Unpin</code>ï¼š</p>
<ul>
<li>
<p><code>Unpin</code> æ„å‘³ç€å¯ä»¥å®‰å…¨ç§»åŠ¨ã€‚</p>
</li>
<li>
<p>è‡ªå¼•ç”¨ç±»å‹å¿…é¡»æ˜¾å¼ç¦ç”¨ <code>Unpin</code>ï¼ˆé€šè¿‡ <code>PhantomPinned</code>ï¼‰ã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::marker::PhantomPinned;
<span class="hljs-keyword">use</span> std::pin::Pin;

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">SelfRef</span> {
    data: <span class="hljs-type">String</span>,
    ptr: *<span class="hljs-keyword">const</span> <span class="hljs-type">String</span>,
    _pin: PhantomPinned, <span class="hljs-comment">// ç¦æ­¢ç§»åŠ¨</span>
}
</code></pre>
</li>
</ul>
<h3 data-id="heading-27">2ã€Pin çš„ API å±‚çº¦æŸ</h3>
<p>Pinçš„æ ¸å¿ƒapiå®šä¹‰ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">impl</span>&lt;T: ?<span class="hljs-built_in">Sized</span>&gt; Pin&lt;&amp;<span class="hljs-keyword">mut</span> T&gt; {
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">as_mut</span>(<span class="hljs-keyword">self</span>: Pin&lt;&amp;<span class="hljs-keyword">mut</span> T&gt;) <span class="hljs-punctuation">-&gt;</span> Pin&lt;&amp;<span class="hljs-keyword">mut</span> T&gt; { ... }
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">unsafe</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">get_unchecked_mut</span>(<span class="hljs-keyword">self</span>: Pin&lt;&amp;<span class="hljs-keyword">mut</span> T&gt;) <span class="hljs-punctuation">-&gt;</span> &amp;<span class="hljs-keyword">mut</span> T { ... }
}
</code></pre>
<ul>
<li>
<p><code>as_mut</code>  å®‰å…¨è·å–å¯å˜å¼•ç”¨ï¼Œä½†ä»ç„¶è¢« Pin çº¦æŸã€‚</p>
</li>
<li>
<p><code>get_unchecked_mut</code> æ˜¯ <strong>unsafe</strong>çš„ï¼Œå…è®¸æ‰‹åŠ¨ç§»åŠ¨å†…éƒ¨å­—æ®µï¼Œä½†é£é™©è‡ªæ‹…ã€‚</p>
</li>
<li>
<p>ç¼–è¯‘å™¨åªå…è®¸å®‰å…¨ API ç§»åŠ¨å¤–éƒ¨åŒ…è£¹æŒ‡é’ˆï¼Œä½†å†…éƒ¨ T åœ°å€å›ºå®šã€‚</p>
</li>
</ul>
<h3 data-id="heading-28">3ã€é˜»æ­¢moveçš„ä¾‹å­</h3>
<p>å †ä¸Šç§»åŠ¨ç¦æ­¢çš„ä¾‹å­ï¼ŒPinåœ¨ç¼–è¯‘æœŸå°±ä¼šé˜»æ­¢</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::pin::Pin;
<span class="hljs-keyword">use</span> std::marker::PhantomPinned;

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">SelfRef</span> {
    data: <span class="hljs-type">String</span>,
    ptr: *<span class="hljs-keyword">const</span> <span class="hljs-type">String</span>,
    _pin: PhantomPinned, <span class="hljs-comment">// !Unpinï¼Œç¦æ­¢ç§»åŠ¨</span>
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-comment">// å †ä¸Šåˆ›å»º SelfRef å¹¶ Pin</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">boxed</span>: Pin&lt;<span class="hljs-type">Box</span>&lt;SelfRef&gt;&gt; = <span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">pin</span>(SelfRef {
        data: <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"hello"</span>),
        ptr: std::ptr::<span class="hljs-title function_ invoke__">null</span>(),
        _pin: PhantomPinned,
    });

    <span class="hljs-comment">// åˆå§‹åŒ–å†…éƒ¨è‡ªå¼•ç”¨æŒ‡é’ˆ</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">ptr</span> = &amp;boxed.data <span class="hljs-keyword">as</span> *<span class="hljs-keyword">const</span> <span class="hljs-type">String</span>;
    <span class="hljs-keyword">unsafe</span> {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">mut_ref</span> = Pin::<span class="hljs-title function_ invoke__">as_mut</span>(&amp;<span class="hljs-keyword">mut</span> boxed);
        Pin::<span class="hljs-title function_ invoke__">get_unchecked_mut</span>(mut_ref).ptr = ptr;
    }

    <span class="hljs-comment">// âŒ å°è¯• move å†…éƒ¨ SelfRef ä¼šæŠ¥é”™</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">moved</span> = *boxed; <span class="hljs-comment">// error: cannot move out of `*boxed` because it is pinned</span>

    <span class="hljs-comment">// // ä½†æ˜¯ Box æœ¬èº«å¯ä»¥ç§»åŠ¨</span>
    <span class="hljs-comment">// let moved_boxed = boxed; // âœ… Box å¯ç§»åŠ¨ï¼Œä½†å †ä¸Šåœ°å€å›ºå®š</span>
    <span class="hljs-comment">//</span>
    <span class="hljs-comment">// println!("data via pinned: {}", unsafe { &amp;*moved_boxed.ptr });</span>
}


</code></pre>
<p>åŸç†ï¼š</p>
<ul>
<li>Box æ˜¯æ™ºèƒ½æŒ‡é’ˆï¼Œç§»åŠ¨ Box åªç§»åŠ¨æŒ‡é’ˆï¼Œä¸ç§»åŠ¨å †æ•°æ®ï¼Œå¦‚ä¸‹å›¾ï¼Œå †æ²¡å˜ï¼›</li>
<li>Pin API ä¿è¯ T åœ¨å †ä¸Šçš„å†…å­˜åœ°å€ä¸ä¼šæ”¹å˜ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7ec66390241147e7ae27470b0ba78730~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6bG85LiD5oiQ6aWx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763296451&amp;x-signature=VtRzzPTncRIR7%2FnDbHQDNlteSt8%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-29">äº”ã€ä¸ºä»€ä¹ˆ <code>Future</code> è¦æœ‰ Pin è®¾è®¡</h2>
<h3 data-id="heading-30">1ã€futureè‡ªå¼•ç”¨</h3>
<p>ä¸€ä¸ª <code>async fn</code> ç¼–è¯‘åå…¶å®ä¼šç”Ÿæˆä¸€ä¸ª<strong>çŠ¶æ€æœºç»“æ„ä½“</strong></p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">foo</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"hello"</span>);
    <span class="hljs-title function_ invoke__">bar</span>(&amp;s).<span class="hljs-keyword">await</span>;
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{s}"</span>);
}
</code></pre>
<p>ç¼–è¯‘å™¨å¤§è‡´ä¼šç”Ÿæˆï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">FooFuture</span> {
    State0,                        <span class="hljs-comment">// åˆå§‹çŠ¶æ€</span>
    State1 { s: <span class="hljs-type">String</span>, bar_fut: BarFuture&lt;<span class="hljs-symbol">'_</span>&gt; },  <span class="hljs-comment">// await ä¹‹å</span>
    Done,
}
</code></pre>
<p>æ¯æ¬¡ <code>.poll()</code> æ—¶ï¼Œ<code>Future</code> ä¼šè¢«æ¨è¿›åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚</p>
<p>åœ¨ <code>State1</code> ä¸­ï¼Œ<code>bar_fut</code> æŒæœ‰ä¸€ä¸ªå¯¹ <code>s</code> çš„å¼•ç”¨ï¼š<code>BarFuture&lt;'_&gt; // ç”Ÿå‘½å‘¨æœŸä¾èµ– FooFuture::s</code></p>
<p>è¿™æ„å‘³ç€æ•´ä¸ª <code>FooFuture</code> ç»“æ„ä½“å†…éƒ¨å‡ºç°äº†**è‡ªå¼•ç”¨ï¼ˆself-referentialï¼‰**å…³ç³»ï¼š</p>
<pre><code class="hljs language-rust" lang="rust">FooFuture
 â”œâ”€ s: <span class="hljs-type">String</span>
 â””â”€ bar_fut: BarFuture&lt;<span class="hljs-symbol">'s</span>&gt;
              â†‘
              â””â”€â”€ å¼•ç”¨äº† s
</code></pre>
<h3 data-id="heading-31">2ã€Futureä½•æ—¶è¢«ç§»åŠ¨</h3>
<p>å½“ Future è¢«è¿è¡Œï¼ˆæ¯”å¦‚é€šè¿‡ <code>tokio::spawn</code>ã€<code>block_on</code>ï¼‰æ—¶ï¼Œæ‰§è¡Œå™¨ä¼šåšè¿™æ ·çš„äº‹ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">fut</span> = <span class="hljs-title function_ invoke__">foo</span>();          <span class="hljs-comment">// åˆ›å»º Future</span>
executor.<span class="hljs-title function_ invoke__">spawn</span>(fut);      <span class="hljs-comment">// æŠŠ Future ç§»è¿›ä»»åŠ¡é˜Ÿåˆ—ï¼ˆMove #1ï¼‰</span>
</code></pre>
<p>åœ¨ä»»åŠ¡ç³»ç»Ÿä¸­ï¼Œæ‰§è¡Œå™¨é€šå¸¸ä¼šï¼š</p>
<ul>
<li>æŠŠ <code>fut</code> ç§»è¿›æŸä¸ªå †ä¸Šåˆ†é…çš„ä»»åŠ¡ç»“æ„ä½“ï¼›</li>
<li>å†ä»ä»»åŠ¡ç»“æ„ä½“ä¸­å–å‡º <code>Pin&lt;&amp;mut fut&gt;</code> å»è°ƒç”¨ <code>poll()</code>ã€‚</li>
</ul>
<p>è¿™æ ·ï¼Œ<strong>åœ¨è¢« poll ä¹‹å‰ï¼Œå®ƒå·²ç»è¢« move è¿‡ä¸€æ¬¡äº†ã€‚</strong></p>
<p>æ›´éšè”½çš„æƒ…å†µ:</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">fut</span> = <span class="hljs-title function_ invoke__">foo</span>();
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">f1</span> = <span class="hljs-keyword">async</span> { fut.<span class="hljs-keyword">await</span> };
</code></pre>
<p><code>fut</code> è¢«åµŒå…¥å¦ä¸€ä¸ª Future <code>f1</code> ä¸­ã€‚ <code>f1</code> ä¹Ÿä¼šè¢« executor å†æ¬¡ç§»åŠ¨ã€‚ ä¹Ÿå°±æ˜¯è¯´ <code>fut</code> å¯èƒ½ç»å†ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-title function_ invoke__">foo</span>() <span class="hljs-punctuation">-&gt;</span> åˆ›å»º Future
   â†“ <span class="hljs-keyword">move</span>
<span class="hljs-keyword">async</span> { fut.<span class="hljs-keyword">await</span> } <span class="hljs-punctuation">-&gt;</span> å¦ä¸€ä¸ª Future åŒ…è£…
   â†“ <span class="hljs-keyword">move</span>
executor.<span class="hljs-title function_ invoke__">spawn</span>() <span class="hljs-punctuation">-&gt;</span> æ”¾å…¥ä»»åŠ¡
   â†“ <span class="hljs-keyword">move</span>
<span class="hljs-title function_ invoke__">poll</span>() <span class="hljs-punctuation">-&gt;</span> å›ºå®šåˆ°å †ä¸Š
</code></pre>
<p>å¦‚æœ <code>FooFuture</code> åœ¨ poll è¿‡ç¨‹ä¸­è¢« <strong>ç§»åŠ¨ (move)</strong>ï¼Œé‚£ä¹ˆ <code>s</code> åœ¨å†…å­˜ä¸­çš„åœ°å€å°±å˜äº†ã€‚
ä½† <code>bar_fut</code> ä»ç„¶ä¿å­˜ç€æ—§åœ°å€çš„å¼•ç”¨ï¼Œåˆ™<strong>å¼•ç”¨å¤±æ•ˆï¼Œå±äºUBï¼ˆæœªå®šä¹‰è¡Œä¸ºï¼‰ï¼</strong>ã€‚</p>
<p>æ‰€ä»¥Rusté€šè¿‡Pinæ¥å›ºå®šFutureå†…å­˜ä½ç½®</p>
<h3 data-id="heading-32">3ã€æµç¨‹å¦‚ä¸‹</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71d1b2e2fae34a98b71845636c8f6573~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6bG85LiD5oiQ6aWx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763296451&amp;x-signature=TQ44aG1DJbNBgDEW8PsmfpLREyk%3D" alt="" loading="lazy"/></p>
<p>è¯´æ˜ï¼š</p>
<ul>
<li>å½“å†™ä¸€ä¸ª <code>async fn foo() { â€¦ }</code> æˆ– <code>async { â€¦ }</code>ï¼ŒRust ç¼–è¯‘å™¨æŠŠå®ƒè½¬æˆä¸€ä¸ªçŠ¶æ€æœº structï¼Œå…¶å­—æ®µåŒ…æ‹¬å±€éƒ¨å˜é‡ã€çŠ¶æ€æ ‡è®°ã€å¯èƒ½çš„ Waker ç­‰ã€‚</li>
<li>å¦‚æœè¿™ä¸ªçŠ¶æ€æœº <strong>åœ¨ await ç‚¹ä¹‹å</strong> è¿˜æŒæœ‰å¯¹è‡ªèº«ç»“æ„ä½“å†…éƒ¨å­—æ®µï¼ˆä¾‹å¦‚ <code>&amp;mut self.field</code>ã€æˆ– <code>&amp;self.field</code>ï¼‰çš„å¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€ä¸ª <strong>è‡ªå¼•ç”¨ Future</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå­˜å‚¨äº†æŒ‡å‘è‡ªèº«å†…å®¹çš„å¼•ç”¨ã€‚</li>
<li>è‹¥è¿™ç§ Future è¢«ç§»åŠ¨ï¼ˆå³åœ°å€å˜åŒ–ï¼‰ï¼Œé‚£ä¹ˆè¿™äº›å†…éƒ¨å¼•ç”¨å°±å˜æˆæ‚¬å‚å¼•ç”¨ï¼Œå¯èƒ½å¼•èµ· UBã€‚</li>
<li>å› æ­¤ï¼Œä¸ºäº†å®‰å…¨ï¼ŒRust è¦æ±‚ï¼šè‹¥ä¸€ä¸ª Future æœ‰å¯èƒ½æ˜¯è‡ªå¼•ç”¨çš„ï¼ˆå³ç”Ÿæˆå™¨çŠ¶æ€æœºå¯èƒ½è¿™æ ·ï¼‰ï¼Œé‚£ä¹ˆå®ƒå¿…é¡» <strong>å…ˆå›ºå®šä½åœ°å€ï¼ˆpinnedï¼‰</strong>ï¼Œå†è¢« <code>poll</code>ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ <code>poll(self: Pin&lt;&amp;mut Self&gt;, â€¦)</code> è€Œä¸æ˜¯ <code>&amp;mut Self</code>ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F72769316%2Fwhy-do-futures-use-pins-in-rust%3Futm_source%3Dchatgpt.com" target="_blank" title="https://stackoverflow.com/questions/72769316/why-do-futures-use-pins-in-rust?utm_source=chatgpt.com" ref="nofollow noopener noreferrer">stackoverflow.com/questions/7â€¦</a></li>
<li>åœ¨ <code>Pin&lt;&amp;mut Self&gt;</code> çš„çº¦æŸä¸‹ï¼Œç±»å‹ç³»ç»Ÿç¦æ­¢ä½ å†å·å·å°† Self ç§»åŠ¨ã€‚åªæœ‰å½“ Self ç±»å‹å®ç°äº† <code>Unpin</code> ï¼ˆè¡¨ç¤ºâ€œå³ä¾¿è¢« Pin åŒ…è£…ï¼Œä¹Ÿå¯å®‰å…¨ç§»åŠ¨â€ï¼‰æ—¶ï¼Œæ‰å…è®¸â€œè§£é™¤å›ºå®šâ€çš„æ“ä½œã€‚</li>
<li>æ€»ç»“æ¥è¯´ï¼Œåœ¨ poll æœŸé—´ï¼Œä¿è¯ Future æ‰€è¡¨ç¤ºçš„å†…å­˜ä½ç½®ä¸ä¼šæ”¹å˜**ï¼Œä»è€Œåº•å±‚çŠ¶æ€æœºå­—æ®µä¸­çš„â€œself-å¼•ç”¨â€ä¾ç„¶æœ‰æ•ˆã€‚</li>
</ul>
<h2 data-id="heading-33">å…­ã€æ€»ç»“</h2>
<p>Pinä¸»è¦ä¿è¯ !Unpin ç±»å‹åœ¨å†…å­˜ä¸­çš„åœ°å€å›ºå®šï¼Œæ¯”å¦‚è‡ªå¼•ç”¨ç±»å‹ã€å¼‚æ­¥ Future ç±»å‹ï¼ˆasync/await å†…éƒ¨çŠ¶æ€æœºï¼‰ã€åº•å±‚å¼‚æ­¥ I/O é©±åŠ¨ï¼ˆå¦‚ Tokio å†…éƒ¨ taskã€io_uring bufferï¼‰ã€‚ç†è§£èµ·æ¥æœ‰ç‚¹å¤æ‚ï¼Œå¯¹æ™®é€šç±»å‹æˆ–çŸ­ç”Ÿå‘½å‘¨æœŸå˜é‡æ²¡å¿…è¦ä½¿ç”¨ï¼Œé™¤éæ˜¯æ˜ç¡®çš„éœ€æ±‚ã€‚å¦‚æœç”¨çš„è¯ï¼Œèƒ½ç”¨å®‰å…¨ API å°±ä¸ç”¨ unsafeï¼›åªèƒ½ unsafe çš„åœ°æ–¹ï¼Œè¦ä¿è¯å¯¹è±¡ç»å¯¹ä¸åŠ¨ã€‚</p>
<p>å¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œè¯·ç‚¹ä¸ªå…³æ³¨å§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue SSR æºç è§£æï¼šssrProcessIf æ¡ä»¶æ¸²æŸ“çš„æœåŠ¡ç«¯è½¬æ¢é€»è¾‘]]></title>    <link>https://juejin.cn/post/7569909335909253129</link>    <guid>https://juejin.cn/post/7569909335909253129</guid>    <pubDate>2025-11-09T00:06:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7569909335909253129" data-draft-id="7569909335909236745" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue SSR æºç è§£æï¼šssrProcessIf æ¡ä»¶æ¸²æŸ“çš„æœåŠ¡ç«¯è½¬æ¢é€»è¾‘"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-09T00:06:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="excel"/> <meta itemprop="url" content="https://juejin.cn/user/2911162520062862"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue SSR æºç è§£æï¼šssrProcessIf æ¡ä»¶æ¸²æŸ“çš„æœåŠ¡ç«¯è½¬æ¢é€»è¾‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2911162520062862/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    excel
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-09T00:06:42.000Z" title="Sun Nov 09 2025 00:06:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Vue çš„æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰ç¼–è¯‘é˜¶æ®µï¼Œ<code>v-if / v-else-if / v-else</code> æŒ‡ä»¤éœ€è¦è¢«è½¬æ¢ä¸ºå¯åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œçš„æ¸²æŸ“é€»è¾‘ï¼Œä»¥ç”Ÿæˆæ­£ç¡®çš„ HTML è¾“å‡ºã€‚<br/>
æœ¬æ–‡å°†æ·±å…¥è§£æ <code>ssrProcessIf</code> çš„æºç ç»“æ„ã€åŸç†è®¾è®¡ã€ä¸ç¼–è¯‘ç«¯å·®å¼‚ï¼Œå¹¶é€æ­¥è®²è§£å¦‚ä½•ç”Ÿæˆå¯¹åº”çš„ SSR ä»£ç èŠ‚ç‚¹ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€æ¦‚å¿µå±‚ï¼š<code>ssrProcessIf</code> çš„èŒè´£å®šä½</h2>
<p>åœ¨ Vue çš„ç¼–è¯‘æµç¨‹ä¸­ï¼š</p>
<ul>
<li><strong>ç¬¬ä¸€é˜¶æ®µï¼ˆAST æ„å»ºï¼‰</strong> ï¼šé€šè¿‡ <code>createStructuralDirectiveTransform</code> æ³¨å†Œç»“æ„æ€§æŒ‡ä»¤ï¼ˆå¦‚ <code>v-if</code>ã€<code>v-for</code>ï¼‰ã€‚</li>
<li><strong>ç¬¬äºŒé˜¶æ®µï¼ˆSSR è½¬æ¢ï¼‰</strong> ï¼šæ ¹æ® AST èŠ‚ç‚¹ç”ŸæˆæœåŠ¡ç«¯å¯æ‰§è¡Œä»£ç æ®µã€‚</li>
</ul>
<p><code>ssrProcessIf</code> å±äºç¬¬äºŒé˜¶æ®µå‡½æ•°ï¼Œå…¶ä¸»è¦ä»»åŠ¡æ˜¯ï¼š</p>
<blockquote>
<p>å°†ç¼–è¯‘å™¨ DOM å±‚çš„ <code>IfNode</code>ï¼ˆå³ <code>v-if</code>ã€<code>v-else-if</code>ã€<code>v-else</code>ï¼‰è½¬æ¢ä¸º SSR ç¯å¢ƒä¸‹å¯æ‰§è¡Œçš„ JavaScript æ¡ä»¶è¯­å¥ï¼ˆ<code>if / else if / else</code>ï¼‰ï¼Œå¹¶æ„å»ºå¯¹åº”çš„æ¸²æŸ“é€»è¾‘å—ï¼ˆ<code>BlockStatement</code>ï¼‰ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">äºŒã€åŸç†å±‚ï¼šæºç è§£æ„ä¸é€»è¾‘æµç¨‹</h2>
<p>å®Œæ•´æºç å¦‚ä¸‹ï¼ˆé™„è¯¦ç»†æ³¨é‡Šï¼‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> {
  <span class="hljs-keyword">type</span> <span class="hljs-title class_">BlockStatement</span>,
  <span class="hljs-keyword">type</span> <span class="hljs-title class_">IfBranchNode</span>,
  <span class="hljs-keyword">type</span> <span class="hljs-title class_">IfNode</span>,
  <span class="hljs-keyword">type</span> <span class="hljs-title class_">NodeTransform</span>,
  <span class="hljs-title class_">NodeTypes</span>,
  createBlockStatement,
  createCallExpression,
  createIfStatement,
  createStructuralDirectiveTransform,
  processIf,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'@vue/compiler-dom'</span>
<span class="hljs-keyword">import</span> {
  <span class="hljs-keyword">type</span> <span class="hljs-title class_">SSRTransformContext</span>,
  processChildrenAsStatement,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'../ssrCodegenTransform'</span>

<span class="hljs-comment">// (1) æ³¨å†ŒæŒ‡ä»¤ transformï¼Œç”¨äºç¬¬ä¸€é˜¶æ®µ AST æ„å»º</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">ssrTransformIf</span>: <span class="hljs-title class_">NodeTransform</span> = <span class="hljs-title function_">createStructuralDirectiveTransform</span>(
  <span class="hljs-regexp">/^(?:if|else|else-if)$/</span>, <span class="hljs-comment">// åŒ¹é…ä¸‰ç§ v-if æŒ‡ä»¤</span>
  processIf, <span class="hljs-comment">// ä½¿ç”¨ compiler-dom ä¸­çš„åŸºç¡€é€»è¾‘</span>
)

<span class="hljs-comment">// (2) SSR é˜¶æ®µï¼šæ ¹æ® AST ç”ŸæˆæœåŠ¡ç«¯ä»£ç ç»“æ„</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ssrProcessIf</span>(<span class="hljs-params">
  node: IfNode,
  context: SSRTransformContext,
  disableNestedFragments = <span class="hljs-literal">false</span>,
  disableComment = <span class="hljs-literal">false</span>,
</span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">const</span> [rootBranch] = node.<span class="hljs-property">branches</span>

  <span class="hljs-comment">// 2.1 ç”Ÿæˆç¬¬ä¸€ä¸ª if è¯­å¥</span>
  <span class="hljs-keyword">const</span> ifStatement = <span class="hljs-title function_">createIfStatement</span>(
    rootBranch.<span class="hljs-property">condition</span>!,
    <span class="hljs-title function_">processIfBranch</span>(rootBranch, context, disableNestedFragments),
  )
  context.<span class="hljs-title function_">pushStatement</span>(ifStatement)

  <span class="hljs-comment">// 2.2 éå†åç»­çš„ else-if / else åˆ†æ”¯</span>
  <span class="hljs-keyword">let</span> currentIf = ifStatement
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; node.<span class="hljs-property">branches</span>.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> branch = node.<span class="hljs-property">branches</span>[i]
    <span class="hljs-keyword">const</span> branchBlockStatement = <span class="hljs-title function_">processIfBranch</span>(
      branch,
      context,
      disableNestedFragments,
    )
    <span class="hljs-keyword">if</span> (branch.<span class="hljs-property">condition</span>) {
      <span class="hljs-comment">// else-if åˆ†æ”¯</span>
      currentIf = currentIf.<span class="hljs-property">alternate</span> = <span class="hljs-title function_">createIfStatement</span>(
        branch.<span class="hljs-property">condition</span>,
        branchBlockStatement,
      )
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// else åˆ†æ”¯</span>
      currentIf.<span class="hljs-property">alternate</span> = branchBlockStatement
    }
  }

  <span class="hljs-comment">// 2.3 æ—  else åˆ†æ”¯æ—¶æ’å…¥ç©ºæ³¨é‡ŠèŠ‚ç‚¹</span>
  <span class="hljs-keyword">if</span> (!currentIf.<span class="hljs-property">alternate</span> &amp;&amp; !disableComment) {
    currentIf.<span class="hljs-property">alternate</span> = <span class="hljs-title function_">createBlockStatement</span>([
      <span class="hljs-title function_">createCallExpression</span>(<span class="hljs-string">`_push`</span>, [<span class="hljs-string">'`&lt;!----&gt;`'</span>]), <span class="hljs-comment">// è¾“å‡ºç©ºæ³¨é‡Šå ä½</span>
    ])
  }
}

<span class="hljs-comment">// (3) å¤„ç†å•ä¸ªåˆ†æ”¯çš„å†…éƒ¨ children</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">processIfBranch</span>(<span class="hljs-params">
  branch: IfBranchNode,
  context: SSRTransformContext,
  disableNestedFragments = <span class="hljs-literal">false</span>,
</span>): <span class="hljs-title class_">BlockStatement</span> {
  <span class="hljs-keyword">const</span> { children } = branch
  <span class="hljs-keyword">const</span> needFragmentWrapper =
    !disableNestedFragments &amp;&amp;
    (children.<span class="hljs-property">length</span> !== <span class="hljs-number">1</span> || children[<span class="hljs-number">0</span>].<span class="hljs-property">type</span> !== <span class="hljs-title class_">NodeTypes</span>.<span class="hljs-property">ELEMENT</span>) &amp;&amp;
    <span class="hljs-comment">// ä¼˜åŒ–ï¼šå•ä¸€å­èŠ‚ç‚¹ä¸º ForNode æ—¶å¯è·³è¿‡ Fragment åŒ…è£¹</span>
    !(children.<span class="hljs-property">length</span> === <span class="hljs-number">1</span> &amp;&amp; children[<span class="hljs-number">0</span>].<span class="hljs-property">type</span> === <span class="hljs-title class_">NodeTypes</span>.<span class="hljs-property">FOR</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">processChildrenAsStatement</span>(branch, context, needFragmentWrapper)
}
</code></pre>
<h3 data-id="heading-2">ğŸ§© æ ¸å¿ƒé€»è¾‘åˆ†å±‚è§£æ</h3>

























<table><thead><tr><th>å±‚æ¬¡</th><th>åŠŸèƒ½è¯´æ˜</th></tr></thead><tbody><tr><td><code>ssrTransformIf</code></td><td>æ³¨å†Œ AST è½¬æ¢æ’ä»¶ï¼Œè¯†åˆ«æ‰€æœ‰ v-if æŒ‡ä»¤ã€‚</td></tr><tr><td><code>ssrProcessIf</code></td><td>å°† AST çš„ <code>IfNode</code> è½¬æ¢ä¸º SSR è¯­å¥æ ‘ï¼ˆJavaScript é€»è¾‘å—ï¼‰ã€‚</td></tr><tr><td><code>processIfBranch</code></td><td>å°†åˆ†æ”¯çš„å­èŠ‚ç‚¹è½¬æ¢ä¸ºæ¸²æŸ“è¯­å¥ä½“ï¼Œè‡ªåŠ¨åˆ¤æ–­æ˜¯å¦éœ€è¦ <code>&lt;template&gt;</code> Fragment åŒ…è£¹ã€‚</td></tr><tr><td><code>_push('&lt;!-- --&gt;')</code></td><td>æ— åŒ¹é…åˆ†æ”¯æ—¶ï¼Œè¾“å‡º SSR ç©ºæ³¨é‡Šï¼ˆä¸å®¢æˆ·ç«¯æ¸²æŸ“ä¸€è‡´ï¼‰ã€‚</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-3">ä¸‰ã€å¯¹æ¯”å±‚ï¼šSSR vs Client ç¼–è¯‘é€»è¾‘</h2>






























<table><thead><tr><th>é¡¹ç›®</th><th>å®¢æˆ·ç«¯ç¼–è¯‘ï¼ˆ<code>compiler-dom</code>ï¼‰</th><th>æœåŠ¡ç«¯ç¼–è¯‘ï¼ˆ<code>compiler-ssr</code>ï¼‰</th></tr></thead><tbody><tr><td>è¾“å‡ºç›®æ ‡</td><td>æ¸²æŸ“å‡½æ•°ï¼ˆ<code>_createVNode</code> ç­‰ï¼‰</td><td>å­—ç¬¦ä¸²æ‹¼æ¥è¾“å‡ºï¼ˆ<code>_push()</code> è°ƒç”¨ï¼‰</td></tr><tr><td>æ¡ä»¶æ§åˆ¶</td><td>é€šè¿‡ <code>createConditionalExpression</code> ç”Ÿæˆä¸‰å…ƒè¡¨è¾¾å¼</td><td>é€šè¿‡ <code>createIfStatement</code> ç”Ÿæˆå®é™… JS if/else è¯­å¥</td></tr><tr><td>ç©ºåˆ†æ”¯å¤„ç†</td><td>è¾“å‡º <code>null</code></td><td>è¾“å‡º HTML æ³¨é‡Š <code>&lt;!----&gt;</code></td></tr><tr><td>Fragment åŒ…è£¹</td><td>ä¾èµ– runtime æ¸²æŸ“ä¼˜åŒ–</td><td>åœ¨ç¼–è¯‘é˜¶æ®µåˆ¤æ–­æ˜¯å¦åˆå¹¶ Fragment</td></tr></tbody></table>
<p>â†’ <strong>æ€»ç»“</strong>ï¼š<br/>
å®¢æˆ·ç«¯ç¼–è¯‘åå‘è¿è¡Œæ—¶åŠ¨æ€å†³ç­–ï¼ˆè™šæ‹Ÿ DOM diffï¼‰ï¼Œ<br/>
è€Œ SSR ç¼–è¯‘æ˜¯é™æ€åŒ–ã€é¢„å±•å¼€çš„é€»è¾‘æ ‘ï¼Œè¿½æ±‚â€œå¯ç›´æ¥è¾“å‡ºå­—ç¬¦ä¸²â€çš„é«˜æ•ˆæ€§ã€‚</p>
<hr/>
<h2 data-id="heading-4">å››ã€å®è·µå±‚ï¼šç¤ºä¾‹æ¨æ¼”</h2>
<p>å‡è®¾æˆ‘ä»¬æœ‰å¦‚ä¸‹æ¨¡æ¿ï¼š</p>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">div</span>&gt;
  &lt;<span class="hljs-selector-tag">div</span> v-if="ok"&gt;<span class="hljs-selector-tag">A</span>&lt;/<span class="hljs-selector-tag">div</span>&gt;
  &lt;<span class="hljs-selector-tag">div</span> v-else-if="maybe"&gt;<span class="hljs-selector-tag">B</span>&lt;/<span class="hljs-selector-tag">div</span>&gt;
  &lt;<span class="hljs-selector-tag">div</span> v-else&gt;C&lt;/<span class="hljs-selector-tag">div</span>&gt;
&lt;/<span class="hljs-selector-tag">div</span>&gt;
</code></pre>
<p>ç»è¿‡ <code>ssrProcessIf</code> è½¬æ¢åï¼Œå†…éƒ¨ä¼šç”Ÿæˆä¼ªä»£ç ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-css" lang="css">if (ok) {
  _push(`&lt;<span class="hljs-selector-tag">div</span>&gt;<span class="hljs-selector-tag">A</span>&lt;/<span class="hljs-selector-tag">div</span>&gt;`)
} else if (maybe) {
  _push(`&lt;<span class="hljs-selector-tag">div</span>&gt;<span class="hljs-selector-tag">B</span>&lt;/<span class="hljs-selector-tag">div</span>&gt;`)
} else {
  _push(`&lt;<span class="hljs-selector-tag">div</span>&gt;C&lt;/<span class="hljs-selector-tag">div</span>&gt;`)
}
</code></pre>
<p>è‹¥ç¼ºçœ <code>v-else</code>ï¼Œåˆ™è¾“å‡ºï¼š</p>
<pre><code class="hljs language-xml" lang="xml">if (ok) {
  _push(`<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>A<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>`)
} else {
  _push(`<span class="hljs-comment">&lt;!----&gt;</span>`)
}
</code></pre>
<p>â†’ è¿™ç§æ–¹å¼ä¿è¯äº† SSR è¾“å‡ºçš„ HTML ç»“æ„ä¸å®¢æˆ·ç«¯æ¸²æŸ“ä¿æŒä¸€è‡´ã€‚</p>
<hr/>
<h2 data-id="heading-5">äº”ã€æ‹“å±•å±‚ï¼šç›¸å…³æ¨¡å—è”åŠ¨</h2>
<ul>
<li>
<p><strong><code>processChildrenAsStatement</code></strong><br/>
è´Ÿè´£å°†æ¨¡æ¿çš„å­èŠ‚ç‚¹ç¼–è¯‘ä¸º <code>BlockStatement</code>ï¼Œä»¥ä¾¿åœ¨ SSR ç¯å¢ƒä¸­å¯æŒ‰é¡ºåº <code>_push()</code>ã€‚</p>
</li>
<li>
<p><strong><code>SSRTransformContext</code></strong><br/>
ä¸Šä¸‹æ–‡å¯¹è±¡ï¼ŒåŒ…å«ï¼š</p>
<ul>
<li><code>_push()</code> è¾“å‡ºæµç®¡ç†ï¼›</li>
<li>é™æ€/åŠ¨æ€ç‰‡æ®µæ”¶é›†ï¼›</li>
<li>åµŒå¥—ç‰‡æ®µï¼ˆFragmentï¼‰å¤„ç†å¼€å…³ï¼›</li>
</ul>
</li>
<li>
<p><strong><code>createIfStatement</code></strong><br/>
å†…éƒ¨å°è£…ä¸ºæ ‡å‡†çš„ AST <code>IfStatement</code>ï¼Œç¡®ä¿è¾“å‡º JS å¯è¢«åç»­ Codegen é˜¶æ®µç›´æ¥åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²ã€‚</p>
</li>
</ul>
<hr/>
<h2 data-id="heading-6">å…­ã€æ½œåœ¨é—®é¢˜ä¸ä¼˜åŒ–æ–¹å‘</h2>
<ol>
<li>
<p><strong>å¤šå±‚åµŒå¥—æ¡ä»¶çš„ä»£ç é‡è†¨èƒ€</strong></p>
<ul>
<li>SSR è¾“å‡ºçš„æ˜¯çº¯ JS æ§åˆ¶æµï¼Œä¼šå¯¼è‡´åˆ†æ”¯è¾ƒå¤šæ—¶ä½“ç§¯å¢é•¿ã€‚</li>
<li>å¯è€ƒè™‘åç»­é˜¶æ®µå¼•å…¥â€œæ¡ä»¶é¢„è®¡ç®—â€æˆ–â€œçŸ­è·¯ä¼˜åŒ–â€ã€‚</li>
</ul>
</li>
<li>
<p><strong>Fragment åŒ…è£¹åˆ¤æ–­é€»è¾‘å¤æ‚</strong></p>
<ul>
<li>å½“å‰é€šè¿‡èŠ‚ç‚¹ç±»å‹å’Œæ•°é‡åˆ¤æ–­ï¼Œè¾¹ç•Œæƒ…å†µï¼ˆå¦‚ <code>v-if</code> å†…åŒ…è£¹ <code>template</code>ï¼‰å¯èƒ½å‡ºç°è¿‡åŒ…æˆ–æ¼åŒ…ã€‚</li>
</ul>
</li>
<li>
<p><strong>å¯è°ƒè¯•æ€§å¼±</strong></p>
<ul>
<li>SSR é˜¶æ®µç”Ÿæˆçš„ <code>_push</code> è°ƒç”¨åœ¨è°ƒè¯•æ—¶å¯è¯»æ€§å·®ï¼Œæœªæ¥å¯è€ƒè™‘å¼•å…¥ Source Map æˆ–ç»“æ„åŒ–æ¸²æŸ“æ ‘è°ƒè¯•å™¨ã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h2 data-id="heading-7">æ€»ç»“</h2>
<p><code>ssrProcessIf</code> æ˜¯ Vue SSR ç¼–è¯‘å™¨ä¸­å¤„ç†æ¡ä»¶æ¸²æŸ“çš„å…³é”®æ¨¡å—ã€‚<br/>
å®ƒé€šè¿‡é™æ€åŒ–å±•å¼€æ¡ä»¶é€»è¾‘ã€ç”Ÿæˆ JS æ§åˆ¶æµè¯­å¥ï¼Œå®ç°äº†ä¸å®¢æˆ·ç«¯ä¸€è‡´çš„è¾“å‡ºç»“æœã€‚<br/>
è¿™ä¸€è®¾è®¡ä½“ç°äº† <strong>â€œè¿è¡Œæ—¶åŠ¨æ€æ€§ â†’ ç¼–è¯‘æœŸç¡®å®šæ€§â€</strong> çš„ Vue SSR æ¶æ„å“²å­¦ã€‚</p>
<hr/>
<p><strong>æœ¬æ–‡éƒ¨åˆ†å†…å®¹å€ŸåŠ© AI è¾…åŠ©ç”Ÿæˆï¼Œå¹¶ç”±ä½œè€…æ•´ç†å®¡æ ¸ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£ Vue SSR ä¸­çš„ v-for ç¼–è¯‘é€»è¾‘ï¼šssrProcessFor æºç è§£æ]]></title>    <link>https://juejin.cn/post/7569976345929809971</link>    <guid>https://juejin.cn/post/7569976345929809971</guid>    <pubDate>2025-11-09T00:04:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7569976345929809971" data-draft-id="7569976345929793587" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£ Vue SSR ä¸­çš„ v-for ç¼–è¯‘é€»è¾‘ï¼šssrProcessFor æºç è§£æ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-09T00:04:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="excel"/> <meta itemprop="url" content="https://juejin.cn/user/2911162520062862"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£ Vue SSR ä¸­çš„ v-for ç¼–è¯‘é€»è¾‘ï¼šssrProcessFor æºç è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2911162520062862/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    excel
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-09T00:04:10.000Z" title="Sun Nov 09 2025 00:04:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€æ¦‚å¿µèƒŒæ™¯</h2>
<p>åœ¨ Vue 3 çš„æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰ç¼–è¯‘é˜¶æ®µï¼Œ<code>v-for</code> æŒ‡ä»¤çš„å¤„ç†è¿‡ç¨‹è¢«æ‹†åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š</p>
<ol>
<li><strong>ç¬¬ä¸€é˜¶æ®µï¼ˆç»“æ„åŒ–è½¬æ¢ï¼‰</strong> ï¼šé€šè¿‡ <code>createStructuralDirectiveTransform</code> æ•è·æ¨¡æ¿ä¸­çš„ <code>v-for</code> è¯­æ³•ï¼Œå¹¶ç”Ÿæˆè¯­æ³•æ ‘ï¼ˆASTï¼‰ã€‚</li>
<li><strong>ç¬¬äºŒé˜¶æ®µï¼ˆSSR ä¸“ç”¨ä»£ç ç”Ÿæˆï¼‰</strong> ï¼šä½¿ç”¨ <code>ssrProcessFor</code> å°†è¯­æ³•æ ‘èŠ‚ç‚¹è½¬åŒ–ä¸º SSR è¿è¡Œæ—¶å¯æ‰§è¡Œçš„æ¸²æŸ“å‡½æ•°ç‰‡æ®µã€‚</li>
</ol>
<p>æ¢å¥è¯è¯´ï¼Œ<code>ssrProcessFor</code> æ˜¯ SSR ç¼–è¯‘ä¸­ <strong>è´Ÿè´£æŠŠ <code>v-for</code> ä» AST è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ‹¼æ¥é€»è¾‘</strong> çš„æ ¸å¿ƒå‡½æ•°ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€æºç ç»“æ„æ€»è§ˆ</h2>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> {
  <span class="hljs-keyword">type</span> <span class="hljs-title class_">ForNode</span>,
  <span class="hljs-keyword">type</span> <span class="hljs-title class_">NodeTransform</span>,
  <span class="hljs-title class_">NodeTypes</span>,
  createCallExpression,
  createForLoopParams,
  createFunctionExpression,
  createStructuralDirectiveTransform,
  processFor,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'@vue/compiler-dom'</span>
<span class="hljs-keyword">import</span> {
  <span class="hljs-keyword">type</span> <span class="hljs-title class_">SSRTransformContext</span>,
  processChildrenAsStatement,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'../ssrCodegenTransform'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-variable constant_">SSR_RENDER_LIST</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../runtimeHelpers'</span>

<span class="hljs-comment">// ç¬¬ä¸€é˜¶æ®µï¼šv-for çš„ç»“æ„åŒ–æŒ‡ä»¤è½¬æ¢</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">ssrTransformFor</span>: <span class="hljs-title class_">NodeTransform</span> =
  <span class="hljs-title function_">createStructuralDirectiveTransform</span>(<span class="hljs-string">'for'</span>, processFor)

<span class="hljs-comment">// ç¬¬äºŒé˜¶æ®µï¼šv-for çš„ SSR ä»£ç ç”Ÿæˆé€»è¾‘</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ssrProcessFor</span>(<span class="hljs-params">
  node: ForNode,
  context: SSRTransformContext,
  disableNestedFragments = <span class="hljs-literal">false</span>,
</span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">const</span> needFragmentWrapper =
    !disableNestedFragments &amp;&amp;
    (node.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> !== <span class="hljs-number">1</span> || node.<span class="hljs-property">children</span>[<span class="hljs-number">0</span>].<span class="hljs-property">type</span> !== <span class="hljs-title class_">NodeTypes</span>.<span class="hljs-property">ELEMENT</span>)
  <span class="hljs-keyword">const</span> renderLoop = <span class="hljs-title function_">createFunctionExpression</span>(
    <span class="hljs-title function_">createForLoopParams</span>(node.<span class="hljs-property">parseResult</span>),
  )
  renderLoop.<span class="hljs-property">body</span> = <span class="hljs-title function_">processChildrenAsStatement</span>(
    node,
    context,
    needFragmentWrapper,
  )

  <span class="hljs-keyword">if</span> (!disableNestedFragments) {
    context.<span class="hljs-title function_">pushStringPart</span>(<span class="hljs-string">`&lt;!--[--&gt;`</span>)
  }
  context.<span class="hljs-title function_">pushStatement</span>(
    <span class="hljs-title function_">createCallExpression</span>(context.<span class="hljs-title function_">helper</span>(<span class="hljs-variable constant_">SSR_RENDER_LIST</span>), [
      node.<span class="hljs-property">source</span>,
      renderLoop,
    ]),
  )
  <span class="hljs-keyword">if</span> (!disableNestedFragments) {
    context.<span class="hljs-title function_">pushStringPart</span>(<span class="hljs-string">`&lt;!--]--&gt;`</span>)
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€åŸç†æ‹†è§£</h2>
<h3 data-id="heading-3">1. ç¬¬ä¸€é˜¶æ®µï¼šç»“æ„åŒ–æŒ‡ä»¤è½¬æ¢</h3>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">export</span> <span class="hljs-type">const</span> ssrTransformFor: NodeTransform =
  <span class="hljs-built_in">createStructuralDirectiveTransform</span>(<span class="hljs-string">'for'</span>, processFor)
</code></pre>
<p>è¿™æ®µä»£ç è°ƒç”¨äº† Vue ç¼–è¯‘å™¨çš„æ ¸å¿ƒå·¥å…· <code>createStructuralDirectiveTransform</code>ã€‚<br/>
å…¶ä½œç”¨æ˜¯ï¼š</p>
<ul>
<li><strong>æ•è·æ¨¡æ¿ä¸­æ‰€æœ‰å¸¦ <code>v-for</code> çš„èŠ‚ç‚¹</strong>ï¼›</li>
<li><strong>è°ƒç”¨ <code>processFor</code></strong> å°†å…¶è½¬æ¢ä¸ºä¸€ä¸ª <code>ForNode</code> AST èŠ‚ç‚¹ã€‚</li>
</ul>
<blockquote>
<p>è¿™ä¸€é˜¶æ®µä»…æ„å»ºé™æ€ç»“æ„ï¼Œä¸å…³å¿ƒ SSR é€»è¾‘ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-4">2. ç¬¬äºŒé˜¶æ®µï¼šSSR æ¸²æŸ“é€»è¾‘ç”Ÿæˆ</h3>
<p>æ¥ä¸‹æ¥ï¼Œ<code>ssrProcessFor</code> ä¼šåœ¨ SSR transform pass ä¸­è¢«è°ƒç”¨ï¼Œå°† <code>ForNode</code> è½¬åŒ–ä¸ºæœ€ç»ˆçš„æœåŠ¡ç«¯å­—ç¬¦ä¸²æ‹¼æ¥é€»è¾‘ã€‚</p>
<h4 data-id="heading-5">(1) åˆ¤æ–­æ˜¯å¦éœ€è¦ Fragment åŒ…è£¹</h4>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">needFragmentWrapper</span> =
  !disableNestedFragments &amp;&amp;
  (node.children.length !== 1 || node.children<span class="hljs-section">[0]</span>.type !== NodeTypes.ELEMENT)
</code></pre>
<ul>
<li>å½“ <code>v-for</code> å†…æœ‰å¤šä¸ªå­èŠ‚ç‚¹ï¼Œæˆ–å­èŠ‚ç‚¹ä¸æ˜¯å•ä¸ªå…ƒç´ æ—¶ï¼Œéœ€è¦ç”¨æ³¨é‡Šæ ‡è®°çš„ <strong>fragment åŒ…è£¹</strong>ï¼Œä»¥åœ¨ SSR è¾“å‡ºä¸­ç»´æŒæ­£ç¡®çš„å±‚çº§ç»“æ„ã€‚</li>
<li>ä¾‹å¦‚ï¼š</li>
</ul>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">div</span> v-for="<span class="hljs-selector-tag">i</span> in list"&gt;
  &lt;<span class="hljs-selector-tag">span</span>&gt;{{ <span class="hljs-selector-tag">i</span> }}&lt;/<span class="hljs-selector-tag">span</span>&gt;
  &lt;<span class="hljs-selector-tag">p</span>&gt;text&lt;/<span class="hljs-selector-tag">p</span>&gt;
&lt;/<span class="hljs-selector-tag">div</span>&gt;
</code></pre>
<p>ä¼šè¢«åŒ…è£¹ä¸ºï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!--[--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><span class="hljs-comment">&lt;!--]--&gt;</span>
</code></pre>
<hr/>
<h4 data-id="heading-6">(2) æ„é€ å¾ªç¯å‡½æ•°è¡¨è¾¾å¼</h4>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">renderLoop</span> = createFunctionExpression(
  createForLoopParams(node.parseResult),
)
</code></pre>
<ul>
<li>
<p><code>createForLoopParams</code> ä» <code>v-for="(item, index) in list"</code> ä¸­æå–å‚æ•°ï¼š<code>(item, index)</code>ï¼›</p>
</li>
<li>
<p><code>createFunctionExpression</code> åˆ™ç”Ÿæˆç±»ä¼¼ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">(item, <span class="hljs-keyword">index</span>) =&gt; { <span class="hljs-regexp">/* æ¸²æŸ“é€»è¾‘ */</span> }
</code></pre>
</li>
</ul>
<hr/>
<h4 data-id="heading-7">(3) ç”Ÿæˆå¾ªç¯ä½“é€»è¾‘</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">renderLoop.body</span> = processChildrenAsStatement(
  node,
  context,
  needFragmentWrapper,
)
</code></pre>
<ul>
<li><code>processChildrenAsStatement</code> ä¼šæŠŠ <code>v-for</code> çš„å­èŠ‚ç‚¹è½¬åŒ–ä¸º SSR è¾“å‡ºè¯­å¥ï¼›</li>
<li>å…¶ä¸­ä¼šé€’å½’è°ƒç”¨ SSR ç‰ˆæœ¬çš„ <code>processElement</code>ã€<code>processText</code> ç­‰ï¼›</li>
<li>å¦‚æœ <code>needFragmentWrapper = true</code>ï¼Œåˆ™ä¼šåœ¨è¾“å‡ºä¸­æ’å…¥æ³¨é‡ŠèŠ‚ç‚¹åŒ…è£¹å­èŠ‚ç‚¹ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-8">(4) ç”Ÿæˆæœ€ç»ˆ SSR è°ƒç”¨è¡¨è¾¾å¼</h4>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">context</span><span class="hljs-selector-class">.pushStatement</span>(
  <span class="hljs-built_in">createCallExpression</span>(context.<span class="hljs-built_in">helper</span>(SSR_RENDER_LIST), [
    node.source,
    renderLoop,
  ]),
)
</code></pre>
<p>ç”Ÿæˆçš„ä»£ç é€»è¾‘å¤§è‡´ç­‰ä»·äºï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">_ssrRenderList</span>(list, <span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> {
  <span class="hljs-comment">// renderLoop.body é€»è¾‘</span>
})
</code></pre>
<p><code>SSR_RENDER_LIST</code> æ˜¯ Vue SSR è¿è¡Œæ—¶çš„è¾…åŠ©å‡½æ•°ï¼Œä½œç”¨ä¸å®¢æˆ·ç«¯æ¸²æŸ“ä¸­çš„ <code>renderList</code> ç›¸åŒï¼Œç”¨äºåœ¨ SSR é˜¶æ®µæ‰§è¡Œå¾ªç¯æ¸²æŸ“ã€‚</p>
<hr/>
<h4 data-id="heading-9">(5) å¤„ç† Fragment åŒ…è£¹æ ‡è®°</h4>
<pre><code class="hljs language-xml" lang="xml">if (!disableNestedFragments) {
  context.pushStringPart(`<span class="hljs-comment">&lt;!--[--&gt;</span>`)
}
// ...loop...
if (!disableNestedFragments) {
  context.pushStringPart(`<span class="hljs-comment">&lt;!--]--&gt;</span>`)
}
</code></pre>
<ul>
<li>
<p>è¿™ä¸¤è¡Œåˆ†åˆ«åœ¨å¾ªç¯è¾“å‡ºå‰åæ’å…¥ç‰¹æ®Šæ³¨é‡Šæ ‡è®°ï¼›</p>
</li>
<li>
<p>è¿™äº›æ ‡è®°å¸®åŠ©å®¢æˆ·ç«¯ hydration è¿‡ç¨‹æ­£ç¡®å®šä½ Fragment è¾¹ç•Œï¼›</p>
</li>
<li>
<p>ä¾‹å¦‚ SSR è¾“å‡ºï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!--[--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-comment">&lt;!--]--&gt;</span>
</code></pre>
</li>
</ul>
<hr/>
<h2 data-id="heading-10">å››ã€æ ¸å¿ƒé€»è¾‘æµç¨‹å›¾</h2>
<pre><code class="hljs language-scss" lang="scss">v-for AST èŠ‚ç‚¹
    â†“
<span class="hljs-built_in">ssrProcessFor</span>()
    â†“
åˆ¤æ–­æ˜¯å¦éœ€è¦ Fragment
    â†“
æ„é€  renderLoop å‡½æ•°è¡¨è¾¾å¼
    â†“
å°†å­èŠ‚ç‚¹è½¬æ¢ä¸ºå¯æ‰§è¡Œè¯­å¥å—
    â†“
åŒ…è£… SSR_RENDER_LIST è°ƒç”¨
    â†“
è¾“å‡ºå­—ç¬¦ä¸²æ ‡è®° + æ¸²æŸ“ç»“æœ
</code></pre>
<hr/>
<h2 data-id="heading-11">äº”ã€ä¸å®¢æˆ·ç«¯ç¼–è¯‘å¯¹æ¯”</h2>



































<table><thead><tr><th>ç»´åº¦</th><th>å®¢æˆ·ç«¯ç¼–è¯‘</th><th>SSR ç¼–è¯‘</th></tr></thead><tbody><tr><td>è¾“å‡ºç›®æ ‡</td><td>Virtual DOM æ¸²æŸ“å‡½æ•°</td><td>å­—ç¬¦ä¸²æ‹¼æ¥é€»è¾‘</td></tr><tr><td>è¿è¡Œæ—¶ Helper</td><td><code>renderList</code></td><td><code>SSR_RENDER_LIST</code></td></tr><tr><td>Fragment</td><td>ç”¨ VNode åŒ…è£¹</td><td>ç”¨æ³¨é‡ŠèŠ‚ç‚¹åŒ…è£¹</td></tr><tr><td>Hydration éœ€æ±‚</td><td>ä¸å­˜åœ¨</td><td>å¿…é¡»ç»´æŒ DOM è¾¹ç•Œä¸€è‡´æ€§</td></tr><tr><td>å­èŠ‚ç‚¹å¤„ç†</td><td>ç”Ÿæˆè™šæ‹ŸèŠ‚ç‚¹æ•°ç»„</td><td>è½¬æ¢ä¸ºå­—ç¬¦ä¸²è¾“å‡ºé€»è¾‘</td></tr></tbody></table>
<p>å¯ä»¥çœ‹å‡ºï¼ŒSSR çš„ <code>v-for</code> å¤„ç†é€»è¾‘é‡ç‚¹åœ¨äº<strong>å­—ç¬¦ä¸²è¾“å‡ºæ­£ç¡®æ€§ä¸ Hydration è¾¹ç•Œç»´æŠ¤</strong>ï¼Œè€Œéè™šæ‹ŸèŠ‚ç‚¹æ„é€ ã€‚</p>
<hr/>
<h2 data-id="heading-12">å…­ã€å®è·µæ¡ˆä¾‹</h2>
<h3 data-id="heading-13">ç¤ºä¾‹æ¨¡æ¿</h3>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">ul</span>&gt;
  &lt;<span class="hljs-selector-tag">li</span> v-for="(item, <span class="hljs-selector-tag">i</span>) in list"&gt;{{ item }}&lt;/<span class="hljs-selector-tag">li</span>&gt;
&lt;/<span class="hljs-selector-tag">ul</span>&gt;
</code></pre>
<h3 data-id="heading-14">SSR ç¼–è¯‘ç»“æœï¼ˆç®€åŒ–åï¼‰</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">_ssrRenderList</span>(_ctx.<span class="hljs-property">list</span>, <span class="hljs-function">(<span class="hljs-params">item, i</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-string">`&lt;li&gt;<span class="hljs-subst">${_ssrInterpolate(item)}</span>&lt;/li&gt;`</span>
})
</code></pre>
<p>åœ¨æœåŠ¡ç«¯æ¸²æŸ“æ—¶ï¼Œè¯¥å‡½æ•°è¿”å›æ‹¼æ¥å¥½çš„å­—ç¬¦ä¸²æ•°ç»„ï¼Œæœ€ç»ˆç”Ÿæˆ HTMLã€‚</p>
<hr/>
<h2 data-id="heading-15">ä¸ƒã€æ‹“å±•æ€è€ƒ</h2>
<ol>
<li>
<p><strong><code>disableNestedFragments</code> å‚æ•°çš„ç”¨é€”</strong></p>
<ul>
<li>ç”¨äºåµŒå¥—ç»“æ„ä¸­ï¼ˆå¦‚ <code>v-for</code> å†…éƒ¨çš„ <code>v-if</code>ï¼‰ï¼Œé¿å…é‡å¤åŒ…è£¹ã€‚</li>
<li>ä¾‹å¦‚æ¨¡æ¿å±‚å·²ç»æ·»åŠ äº† Fragment æ³¨é‡Šï¼Œå°±å¯ä»¥ç¦ç”¨å†…éƒ¨ fragmentã€‚</li>
</ul>
</li>
<li>
<p><strong><code>SSR_RENDER_LIST</code> çš„æ‰§è¡Œæœºåˆ¶</strong></p>
<ul>
<li>åœ¨è¿è¡Œæ—¶æ‰§è¡Œå¾ªç¯ï¼Œæ‹¼æ¥å­—ç¬¦ä¸²ï¼›</li>
<li>åŒæ—¶ç»´æŒé¡ºåºå’Œç´¢å¼•ä¸€è‡´ï¼Œç¡®ä¿ hydration å¯¹åº”å…³ç³»ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ€§èƒ½ä¼˜åŒ–æ–¹å‘</strong></p>
<ul>
<li>å¯é’ˆå¯¹é™æ€ <code>list</code> è¿›è¡Œç¼–è¯‘æœŸå±•å¼€ï¼›</li>
<li>åœ¨é•¿åˆ—è¡¨ä¸­é€šè¿‡åˆ†å—æ¸²æŸ“å‡å°‘å†…å­˜å ç”¨ã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h2 data-id="heading-16">å…«ã€æ½œåœ¨é—®é¢˜ä¸è°ƒè¯•è¦ç‚¹</h2>






























<table><thead><tr><th>é—®é¢˜</th><th>å¯èƒ½åŸå› </th><th>è§£å†³æ€è·¯</th></tr></thead><tbody><tr><td>SSR è¾“å‡ºç»“æ„ä¸åŒ¹é…</td><td>ç¼ºå°‘ Fragment æ³¨é‡Šè¾¹ç•Œ</td><td>æ£€æŸ¥ <code>needFragmentWrapper</code> åˆ¤æ–­é€»è¾‘</td></tr><tr><td>Hydration é”™ä½</td><td>å­èŠ‚ç‚¹é¡ºåºæˆ–æ³¨é‡Šæ ‡è¯†é”™è¯¯</td><td>ç¡®è®¤ <code>&lt;!--[--&gt;</code> å’Œ <code>&lt;!--]--&gt;</code> å¯¹åº”ä½ç½®</td></tr><tr><td>æ€§èƒ½ä¸‹é™</td><td>åŠ¨æ€è¡¨è¾¾å¼å¤æ‚</td><td>å¯ä½¿ç”¨ key ä¼˜åŒ– diff é€»è¾‘</td></tr><tr><td>åµŒå¥—å¾ªç¯å‡ºé”™</td><td>å‚æ•°ä½œç”¨åŸŸå†²çª</td><td>æ£€æŸ¥ <code>createForLoopParams</code> æ˜¯å¦æ­£ç¡®ç”Ÿæˆå‚æ•°</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-17">ä¹ã€æ€»ç»“</h2>
<p><code>ssrProcessFor</code> æ˜¯ Vue SSR ç¼–è¯‘ç®¡çº¿ä¸­å°†æ¨¡æ¿å¾ªç¯æŒ‡ä»¤è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ¸²æŸ“é€»è¾‘çš„å…³é”®æ¨¡å—ã€‚<br/>
å…¶æ ¸å¿ƒå·¥ä½œåŒ…æ‹¬ï¼š</p>
<ul>
<li>ç”Ÿæˆå¾ªç¯å‡½æ•°è¡¨è¾¾å¼ï¼›</li>
<li>å¤„ç†å­èŠ‚ç‚¹æ¸²æŸ“ï¼›</li>
<li>ç®¡ç† Fragment åŒ…è£¹ä¸æ³¨é‡Šè¾¹ç•Œï¼›</li>
<li>æœ€ç»ˆç”ŸæˆåŸºäº <code>SSR_RENDER_LIST</code> çš„å¯æ‰§è¡Œè¾“å‡ºã€‚</li>
</ul>
<p>å®ƒæ˜¯ Vue SSR ä¿è¯æ¨¡æ¿åœ¨å®¢æˆ·ç«¯å¤æ°´æ—¶<strong>ç»“æ„ç²¾ç¡®å¯¹åº”</strong>çš„é‡è¦æœºåˆ¶ä¹‹ä¸€ã€‚</p>
<hr/>
<p><strong>æœ¬æ–‡éƒ¨åˆ†å†…å®¹å€ŸåŠ© AI è¾…åŠ©ç”Ÿæˆï¼Œå¹¶ç”±ä½œè€…æ•´ç†å®¡æ ¸ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue SSR æ·±åº¦è§£æï¼šssrProcessTeleport çš„æºç æœºåˆ¶ä¸å®ç°åŸç†]]></title>    <link>https://juejin.cn/post/7569959427878240266</link>    <guid>https://juejin.cn/post/7569959427878240266</guid>    <pubDate>2025-11-08T23:56:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7569959427878240266" data-draft-id="7569959427878223882" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue SSR æ·±åº¦è§£æï¼šssrProcessTeleport çš„æºç æœºåˆ¶ä¸å®ç°åŸç†"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-08T23:56:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="excel"/> <meta itemprop="url" content="https://juejin.cn/user/2911162520062862"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue SSR æ·±åº¦è§£æï¼šssrProcessTeleport çš„æºç æœºåˆ¶ä¸å®ç°åŸç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2911162520062862/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    excel
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-08T23:56:17.000Z" title="Sat Nov 08 2025 23:56:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Vue 3 çš„æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰ç¼–è¯‘é˜¶æ®µä¸­ï¼Œ<code>ssrProcessTeleport</code> æ˜¯ä¸€ä¸ªäºŒæ¬¡ç¼–è¯‘ï¼ˆsecond-passï¼‰é˜¶æ®µçš„ä»£ç ç”Ÿæˆè½¬æ¢å‡½æ•°ï¼Œç”¨äºå¤„ç† <code>&lt;teleport&gt;</code> ç»„ä»¶çš„æœåŠ¡ç«¯è¾“å‡ºé€»è¾‘ã€‚<br/>
æœ¬æ–‡å°†æ·±å…¥å‰–æå…¶è®¾è®¡ç›®çš„ã€å®ç°åŸç†ä¸ç¼–è¯‘é“¾ä¸­çš„ä½ç½®ï¼Œå¹¶é€šè¿‡é€è¡Œæ³¨é‡Šå±•ç¤ºæºç çš„è¿è¡Œæµç¨‹ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€æ¦‚å¿µèƒŒæ™¯ï¼šSSR ä¸ Teleport çš„ç‰¹æ®Šæ€§</h2>
<p><strong>Teleport çš„æ ¸å¿ƒä½œç”¨</strong>æ˜¯åœ¨å®¢æˆ·ç«¯æ¸²æŸ“æ—¶å…è®¸å¼€å‘è€…å°†æŸäº›å†…å®¹æ¸²æŸ“åˆ° DOM æ ‘çš„å…¶ä»–ä½ç½®ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">teleport</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"#modal"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Modal content<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">teleport</span>&gt;</span>
</code></pre>
<p>è€Œåœ¨ <strong>SSRï¼ˆServer-Side Renderingï¼‰</strong> æ¨¡å¼ä¸­ï¼ŒVue å¿…é¡»åœ¨ç”Ÿæˆ HTML å­—ç¬¦ä¸²æ—¶ä¿ç•™è¿™ç§ç»“æ„çš„é€»è¾‘ä¿¡æ¯ï¼Œä»¥ä¾¿åœ¨å®¢æˆ·ç«¯ hydrate æ—¶ä»èƒ½æ­£ç¡®å…³è”ç›®æ ‡èŠ‚ç‚¹ã€‚<br/>
å› æ­¤ï¼ŒSSR ç¼–è¯‘å™¨å¿…é¡»æ•è· teleport çš„ç›®æ ‡ (<code>to</code> å±æ€§)ã€å†…å®¹åŠç¦ç”¨çŠ¶æ€ (<code>disabled</code>)ï¼Œå¹¶ç”Ÿæˆå¯åœ¨è¿è¡Œæ—¶æ‰§è¡Œçš„æ¸²æŸ“å‡½æ•°è°ƒç”¨ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€åŸç†å‰–æï¼šå‡½æ•°ç»“æ„ä¸æ ¸å¿ƒæµç¨‹</h2>
<p>æˆ‘ä»¬å…ˆçœ‹å®Œæ•´å‡½æ•°ç»“æ„ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ssrProcessTeleport</span>(<span class="hljs-params">
  node: ComponentNode,
  context: SSRTransformContext,
</span>): <span class="hljs-keyword">void</span> {
  <span class="hljs-comment">// 1. æå– to å±æ€§</span>
  <span class="hljs-keyword">const</span> targetProp = <span class="hljs-title function_">findProp</span>(node, <span class="hljs-string">'to'</span>)
  <span class="hljs-keyword">if</span> (!targetProp) {
    context.<span class="hljs-title function_">onError</span>(
      <span class="hljs-title function_">createSSRCompilerError</span>(<span class="hljs-title class_">SSRErrorCodes</span>.<span class="hljs-property">X_SSR_NO_TELEPORT_TARGET</span>, node.<span class="hljs-property">loc</span>),
    )
    <span class="hljs-keyword">return</span>
  }

  <span class="hljs-comment">// 2. è§£æ teleport çš„ç›®æ ‡è¡¨è¾¾å¼</span>
  <span class="hljs-keyword">let</span> <span class="hljs-attr">target</span>: <span class="hljs-title class_">ExpressionNode</span> | <span class="hljs-literal">undefined</span>
  <span class="hljs-keyword">if</span> (targetProp.<span class="hljs-property">type</span> === <span class="hljs-title class_">NodeTypes</span>.<span class="hljs-property">ATTRIBUTE</span>) {
    target =
      targetProp.<span class="hljs-property">value</span> &amp;&amp; <span class="hljs-title function_">createSimpleExpression</span>(targetProp.<span class="hljs-property">value</span>.<span class="hljs-property">content</span>, <span class="hljs-literal">true</span>)
  } <span class="hljs-keyword">else</span> {
    target = targetProp.<span class="hljs-property">exp</span>
  }
  <span class="hljs-keyword">if</span> (!target) {
    context.<span class="hljs-title function_">onError</span>(
      <span class="hljs-title function_">createSSRCompilerError</span>(
        <span class="hljs-title class_">SSRErrorCodes</span>.<span class="hljs-property">X_SSR_NO_TELEPORT_TARGET</span>,
        targetProp.<span class="hljs-property">loc</span>,
      ),
    )
    <span class="hljs-keyword">return</span>
  }

  <span class="hljs-comment">// 3. æ£€æŸ¥ disabled å±æ€§</span>
  <span class="hljs-keyword">const</span> disabledProp = <span class="hljs-title function_">findProp</span>(node, <span class="hljs-string">'disabled'</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>)
  <span class="hljs-keyword">const</span> disabled = disabledProp
    ? disabledProp.<span class="hljs-property">type</span> === <span class="hljs-title class_">NodeTypes</span>.<span class="hljs-property">ATTRIBUTE</span>
      ? <span class="hljs-string">`true`</span>
      : disabledProp.<span class="hljs-property">exp</span> || <span class="hljs-string">`false`</span>
    : <span class="hljs-string">`false`</span>

  <span class="hljs-comment">// 4. ç”Ÿæˆå†…å®¹æ¸²æŸ“å‡½æ•°</span>
  <span class="hljs-keyword">const</span> contentRenderFn = <span class="hljs-title function_">createFunctionExpression</span>(
    [<span class="hljs-string">`_push`</span>],
    <span class="hljs-literal">undefined</span>,
    <span class="hljs-literal">true</span>,
    <span class="hljs-literal">false</span>,
    node.<span class="hljs-property">loc</span>,
  )
  contentRenderFn.<span class="hljs-property">body</span> = <span class="hljs-title function_">processChildrenAsStatement</span>(node, context)

  <span class="hljs-comment">// 5. è°ƒç”¨ SSR_RENDER_TELEPORT helper è¾“å‡ºæœ€ç»ˆä»£ç </span>
  context.<span class="hljs-title function_">pushStatement</span>(
    <span class="hljs-title function_">createCallExpression</span>(context.<span class="hljs-title function_">helper</span>(<span class="hljs-variable constant_">SSR_RENDER_TELEPORT</span>), [
      <span class="hljs-string">`_push`</span>,
      contentRenderFn,
      target,
      disabled,
      <span class="hljs-string">`_parent`</span>,
    ]),
  )
}
</code></pre>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€é€è¡Œè§£æä¸ä»£ç æ³¨é‡Š</h2>
<h3 data-id="heading-3">1. ä¾èµ–å¯¼å…¥éƒ¨åˆ†</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> {
  <span class="hljs-built_in">type</span> ComponentNode,
  <span class="hljs-built_in">type</span> ExpressionNode,
  NodeTypes,
  createCallExpression,
  createFunctionExpression,
  createSimpleExpression,
  findProp,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'@vue/compiler-dom'</span>
</code></pre>
<ul>
<li>è¿™äº›æ¥è‡ª <code>@vue/compiler-dom</code> çš„å·¥å…·å¸®åŠ©æˆ‘ä»¬åœ¨ AST å±‚é¢åˆ†æèŠ‚ç‚¹ç»“æ„ã€‚</li>
<li><code>findProp</code> ç”¨äºæŸ¥æ‰¾èŠ‚ç‚¹ä¸Šçš„å±æ€§ã€‚</li>
<li><code>createSimpleExpression</code> ç”¨äºåŒ…è£…å­—é¢é‡ã€‚</li>
<li><code>createFunctionExpression</code> ä¸ <code>createCallExpression</code> ç”¨äºç”Ÿæˆå¯åºåˆ—åŒ–çš„å‡½æ•°è°ƒç”¨è¡¨è¾¾å¼ã€‚</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> {
  <span class="hljs-built_in">type</span> SSRTransformContext,
  processChildrenAsStatement,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'../ssrCodegenTransform'</span>
</code></pre>
<ul>
<li><code>SSRTransformContext</code> è®°å½•å½“å‰çš„ç¼–è¯‘çŠ¶æ€ï¼ˆä¾‹å¦‚ helper å‡½æ•°ã€è¾“å‡ºç¼“å†²åŒºç­‰ï¼‰ã€‚</li>
<li><code>processChildrenAsStatement</code> ä¼šå°†ç»„ä»¶çš„å­èŠ‚ç‚¹è½¬æ¢ä¸º <code>_push</code> è°ƒç”¨åºåˆ—ï¼ˆå³ç”Ÿæˆ HTML çš„éƒ¨åˆ†ï¼‰ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-4">2. ç›®æ ‡å±æ€§æå–ä¸æ ¡éªŒ</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">const</span> targetProp = findProp(node, <span class="hljs-string">'to'</span>)
<span class="hljs-keyword">if</span> (!targetProp) {
  context.onError(
    createSSRCompilerError(SSRErrorCodes.X_SSR_NO_TELEPORT_TARGET, node.loc),
  )
  <span class="hljs-keyword">return</span>
}
</code></pre>
<blockquote>
<p>ğŸ” Teleport æ²¡æœ‰ <code>to</code> å±æ€§æ—¶ç›´æ¥æŠ¥é”™ï¼Œå› ä¸ºæ— æ³•ç¡®å®šæ¸²æŸ“ç›®æ ‡ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-5">3. ç”Ÿæˆ Teleport ç›®æ ‡è¡¨è¾¾å¼</h3>
<pre><code class="hljs language-ini" lang="ini">let target: ExpressionNode | undefined
if (<span class="hljs-attr">targetProp.type</span> === NodeTypes.ATTRIBUTE) {
  <span class="hljs-attr">target</span> =
    targetProp.value &amp;&amp; createSimpleExpression(targetProp.value.content, true)
} else {
  <span class="hljs-attr">target</span> = targetProp.exp
}
</code></pre>
<ul>
<li>å½“ <code>to</code> æ˜¯é™æ€å­—ç¬¦ä¸²æ—¶ï¼ˆå¦‚ <code>"body"</code>ï¼‰ï¼Œä¼šè½¬æ¢æˆç®€å•è¡¨è¾¾å¼ï¼›</li>
<li>è‹¥ä¸ºåŠ¨æ€ç»‘å®šï¼ˆå¦‚ <code>:to="dynamicTarget"</code>ï¼‰ï¼Œåˆ™ç›´æ¥ä½¿ç”¨å·²å­˜åœ¨çš„è¡¨è¾¾å¼ã€‚</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">if</span> (!target) {
  context.onError(
    createSSRCompilerError(
      SSRErrorCodes.X_SSR_NO_TELEPORT_TARGET,
      targetProp.loc,
    ),
  )
  <span class="hljs-keyword">return</span>
}
</code></pre>
<blockquote>
<p>å†æ¬¡è¿›è¡Œå®¹é”™æ£€æŸ¥ï¼Œç¡®ä¿ç›®æ ‡æœ‰æ•ˆã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-6">4. è§£æ Teleport çš„ disabled å±æ€§</h3>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">const</span> disabledProp = findProp(node, <span class="hljs-string">'disabled'</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>)
<span class="hljs-type">const</span> disabled = disabledProp
  ? disabledProp.type === NodeTypes.ATTRIBUTE
    ? `<span class="hljs-literal">true</span>`
    : disabledProp.<span class="hljs-built_in">exp</span> || `<span class="hljs-literal">false</span>`
  : `<span class="hljs-literal">false</span>`
</code></pre>
<blockquote>
<p>è¿™é‡Œå®ç°äº†å¯¹ <code>&lt;teleport disabled&gt;</code>ã€<code>:disabled="isOff"</code> ç­‰å¤šç§å†™æ³•çš„å…¼å®¹ã€‚<br/>
è‹¥å®Œå…¨æœªå£°æ˜åˆ™é»˜è®¤ä¸º <code>"false"</code>ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-7">5. ç”Ÿæˆå†…å®¹æ¸²æŸ“å‡½æ•°</h3>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">contentRenderFn</span> = createFunctionExpression(
  <span class="hljs-section">[`_push`]</span>,
  undefined,
  true,
  false,
  node.loc,
)
<span class="hljs-attr">contentRenderFn.body</span> = processChildrenAsStatement(node, context)
</code></pre>
<ul>
<li>è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªå‡½æ•° <code>( _push ) =&gt; { ... }</code>ï¼Œå…¶ä¸­ <code>_push</code> æ˜¯ SSR ç”Ÿæˆå­—ç¬¦ä¸²çš„ç´¯ç§¯å™¨ã€‚</li>
<li>é€šè¿‡ <code>processChildrenAsStatement</code> å°†å­èŠ‚ç‚¹è½¬æ¢ä¸º <code>_push('&lt;div&gt;...&lt;/div&gt;')</code> çš„åºåˆ—ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-8">6. ç”Ÿæˆæœ€ç»ˆçš„ Teleport æ¸²æŸ“è°ƒç”¨</h3>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">context</span><span class="hljs-selector-class">.pushStatement</span>(
  <span class="hljs-built_in">createCallExpression</span>(context.<span class="hljs-built_in">helper</span>(SSR_RENDER_TELEPORT), [
    <span class="hljs-built_in">`_push`</span>,
    contentRenderFn,
    target,
    disabled,
    <span class="hljs-built_in">`_parent`</span>,
  ]),
)
</code></pre>
<blockquote>
<p>è¿™ä¸€æ­¥å®é™…ä¸Šä¼šç”Ÿæˆç±»ä¼¼å¦‚ä¸‹çš„ SSR ä»£ç ï¼š</p>
</blockquote>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">_ssrRenderTeleport</span>(_push, <span class="hljs-function">(<span class="hljs-params">_push</span>) =&gt;</span> {
  <span class="hljs-title function_">_push</span>(<span class="hljs-string">`&lt;div&gt;Modal content&lt;/div&gt;`</span>)
}, <span class="hljs-string">"#modal"</span>, <span class="hljs-literal">false</span>, _parent)
</code></pre>
<p><code>SSR_RENDER_TELEPORT</code> æ˜¯è¿è¡Œæ—¶ helperï¼Œç”¨æ¥åœ¨æœåŠ¡å™¨æ¸²æŸ“æ—¶è¾“å‡ºå ä½ç»“æ„å¹¶è®°å½• Teleport çš„ä¸Šä¸‹æ–‡ã€‚</p>
<hr/>
<h2 data-id="heading-9">å››ã€ä¸å®¢æˆ·ç«¯ç¼–è¯‘é€»è¾‘çš„å¯¹æ¯”</h2>




















<table><thead><tr><th>æ¨¡å¼</th><th>æ¸²æŸ“ä½ç½®</th><th>ä¸»è¦èŒè´£</th></tr></thead><tbody><tr><td><strong>å®¢æˆ·ç«¯ç¼–è¯‘ (<code>compiler-dom</code>)</strong></td><td>å°† <code>&lt;teleport&gt;</code> è½¬æ¢ä¸ºè¿è¡Œæ—¶ç»„ä»¶è°ƒç”¨</td><td>è´Ÿè´£ DOM æ“ä½œä¸æŒ‚è½½ç›®æ ‡</td></tr><tr><td><strong>SSR ç¼–è¯‘ (<code>compiler-ssr</code>)</strong></td><td>ç”Ÿæˆ <code>_ssrRenderTeleport</code> è°ƒç”¨</td><td>è´Ÿè´£è¾“å‡º HTML å­—ç¬¦ä¸²ç»“æ„</td></tr></tbody></table>
<p>SSR ç¼–è¯‘å™¨çš„ç›®æ ‡ä¸æ˜¯è¿è¡Œç»„ä»¶é€»è¾‘ï¼Œè€Œæ˜¯é¢„å…ˆç”Ÿæˆå­—ç¬¦ä¸²æ¨¡æ¿ï¼Œå› æ­¤å®ƒä¼šå°† Teleport çš„è¿è¡Œé€»è¾‘â€œé™çº§â€ä¸ºå­—ç¬¦ä¸²æ‹¼æ¥å‡½æ•°è°ƒç”¨ã€‚</p>
<hr/>
<h2 data-id="heading-10">äº”ã€å®è·µï¼šå¦‚ä½•è°ƒè¯•ä¸æ‰©å±•</h2>
<p>å¦‚æœä½ æƒ³åœ¨è‡ªå®šä¹‰ SSR ç¯å¢ƒä¸­æ³¨å…¥é¢å¤–é€»è¾‘ï¼ˆä¾‹å¦‚è®°å½• Teleport ä½¿ç”¨æ¬¡æ•°ï¼‰ï¼Œå¯ä»¥åœ¨ <code>ssrCodegenTransform</code> é˜¶æ®µæ‹¦æˆªï¼š</p>
<pre><code class="hljs language-scss" lang="scss">context<span class="hljs-selector-class">.registerHelper</span>(SSR_RENDER_TELEPORT)
</code></pre>
<p>å¹¶åœ¨è¿è¡Œæ—¶è‡ªå®šä¹‰ <code>_ssrRenderTeleport</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ssrRenderTeleport</span>(<span class="hljs-params">push, renderContent, target, disabled, parent</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Teleport to: <span class="hljs-subst">${target}</span>`</span>)
  <span class="hljs-keyword">if</span> (!disabled) {
    <span class="hljs-title function_">renderContent</span>(push)
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-11">å…­ã€æ‹“å±•æ€è€ƒ</h2>
<ul>
<li><strong>å¯æ’æ‹”æ€§è®¾è®¡</strong>ï¼šVue SSR çš„ transform é˜¶æ®µæ˜¯æ¨¡å—åŒ–çš„ï¼Œå¯é’ˆå¯¹ç»„ä»¶ç±»å‹æ³¨å†Œä¸åŒçš„äºŒæ¬¡å¤„ç†å‡½æ•°ã€‚</li>
<li><strong>AST çº§ç¼–è¯‘å¤ç”¨</strong>ï¼šæ­¤é€»è¾‘å¤ç”¨ <code>compiler-dom</code> çš„èŠ‚ç‚¹å®šä¹‰ä½“ç³»ï¼Œä½¿å¾— SSR ä¸ DOM ç¼–è¯‘å™¨é«˜åº¦å…¼å®¹ã€‚</li>
<li><strong>è¿è¡Œæ—¶ä¸ç¼–è¯‘æ—¶è§£è€¦</strong>ï¼šSSR ç¼–è¯‘å™¨ä¸ä¼šç›´æ¥ç”Ÿæˆ HTMLï¼Œè€Œæ˜¯ç”Ÿæˆè¿è¡Œæ—¶ helper è°ƒç”¨ï¼Œä½¿å¾—æœåŠ¡å™¨ç«¯é€»è¾‘æ›´çµæ´»ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-12">ä¸ƒã€æ½œåœ¨é—®é¢˜ä¸æ³¨æ„äº‹é¡¹</h2>
<ol>
<li><strong>åŠ¨æ€ç›®æ ‡è¡¨è¾¾å¼çš„æ±‚å€¼</strong>ï¼šSSR ä¸ä¼šå®é™…è§£æ <code>:to</code> ç»‘å®šçš„å€¼ï¼Œå¿…é¡»åœ¨è¿è¡Œæ—¶ç¯å¢ƒä¸­ç¡®å®šï¼›</li>
<li><strong>disabled çš„å­—ç¬¦ä¸²åŒ–é™·é˜±</strong>ï¼šåœ¨ SSR ç”Ÿæˆçš„ä»£ç ä¸­ <code>"false"</code> æ˜¯å­—ç¬¦ä¸²ï¼Œä¸æ˜¯çœŸå¸ƒå°”ï¼›</li>
<li><strong>Hydration å·®å¼‚</strong>ï¼šæœåŠ¡ç«¯è¾“å‡ºå¿…é¡»ä¸å®¢æˆ·ç«¯ Teleport çš„æŒ‚è½½ä½ç½®ä¸€è‡´ï¼Œå¦åˆ™ hydration å¤±è´¥ï¼›</li>
<li><strong>åµŒå¥— Teleport åœºæ™¯</strong>ï¼šéœ€è¦è°¨æ…å¤„ç†å¤šå±‚ Teleportï¼Œå¦åˆ™ä¼šå¼•å‘è¾“å‡ºé¡ºåºä¸ä¸€è‡´ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-13">å…«ã€ç»“è¯­</h2>
<p><code>ssrProcessTeleport</code> å±•ç¤ºäº† Vue SSR ç¼–è¯‘å™¨çš„å¼ºå¤§ä¸ä¼˜é›…è®¾è®¡ï¼š<br/>
å®ƒä»¥æœ€å°çš„ä»£ä»·åœ¨ç¼–è¯‘é˜¶æ®µä¿ç•™ Teleport çš„è¿è¡Œè¯­ä¹‰ï¼ŒåŒæ—¶é€šè¿‡æŠ½è±¡å±‚ï¼ˆhelper + contextï¼‰ç¡®ä¿ä»£ç å¯ç»´æŠ¤æ€§ä¸æ‰©å±•æ€§ã€‚</p>
<blockquote>
<p><strong>ä¸€å¥è¯æ€»ç»“</strong>ï¼šå®ƒæ˜¯å°†â€œå®¢æˆ·ç«¯ç»“æ„æŒ‡ä»¤â€è½¬è¯‘ä¸ºâ€œæœåŠ¡ç«¯å­—ç¬¦ä¸²æŒ‡ä»¤â€çš„æ¡¥æ¢ã€‚</p>
</blockquote>
<hr/>
<p><strong>æœ¬æ–‡éƒ¨åˆ†å†…å®¹å€ŸåŠ© AI è¾…åŠ©ç”Ÿæˆï¼Œå¹¶ç”±ä½œè€…æ•´ç†å®¡æ ¸ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Coze+n8nå®æˆ˜ï¼šå…¬ä¼—å·æ–‡ç« ä»ä»¿å†™åˆ°è‰ç¨¿ç®±ï¼Œ2åˆ†é’Ÿå…¨æå®šï¼Œä½ åªéœ€æäº¤é“¾æ¥ï¼]]></title>    <link>https://juejin.cn/post/7570500819888848939</link>    <guid>https://juejin.cn/post/7570500819888848939</guid>    <pubDate>2025-11-10T06:09:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570500819888848939" data-draft-id="7570339961908969515" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Coze+n8nå®æˆ˜ï¼šå…¬ä¼—å·æ–‡ç« ä»ä»¿å†™åˆ°è‰ç¨¿ç®±ï¼Œ2åˆ†é’Ÿå…¨æå®šï¼Œä½ åªéœ€æäº¤é“¾æ¥ï¼"/> <meta itemprop="keywords" content="Coze,Agent,AIGC"/> <meta itemprop="datePublished" content="2025-11-10T06:09:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åç«¯å°è‚¥è‚ "/> <meta itemprop="url" content="https://juejin.cn/user/2966945320667536"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Coze+n8nå®æˆ˜ï¼šå…¬ä¼—å·æ–‡ç« ä»ä»¿å†™åˆ°è‰ç¨¿ç®±ï¼Œ2åˆ†é’Ÿå…¨æå®šï¼Œä½ åªéœ€æäº¤é“¾æ¥ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2966945320667536/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åç«¯å°è‚¥è‚ 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T06:09:19.000Z" title="Mon Nov 10 2025 06:09:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å°è‚¥è‚ ï¼Œä¸“æ³¨ AI å¹²è´§çŸ¥è¯†åˆ†äº«ï¼ä»Šå¤©ç»™å¸¦æ¥çš„æ˜¯n8n+Cozeå®æˆ˜æ•™ç¨‹ï¼Œä¸€é”®ä»¿å†™å…¬ä¼—å·æ–‡ç« åˆ°ä½ çš„è‰ç¨¿ç®±ä¸­ã€‚</strong></p>
<h2 data-id="heading-0">1. å‰è¨€</h2>
<p>åœ¨å‰å‡ ä¸ªæœˆæˆ‘åšè¿‡ä¸€ä¸ªCoze+RPAçš„å…¬ä¼—å·å·¥ä½œæµï¼š<a href="https://juejin.cn/post/7523119147435507727" target="_blank" title="https://juejin.cn/post/7523119147435507727">èººèµšå¿…å¤‡ï¼RPA+Coze+è±†åŒ…ï¼šå…¬ä¼—å·è‡ªåŠ¨å‘æ–‡ï¼ŒAIç‡0%äº²æµ‹æœ‰æ•ˆï¼ˆé™„AIç‡0%æç¤ºè¯ï¼‰</a>ã€‚æœ€è¿‘ä¸æ˜¯éƒ½åœ¨ç ”ç©¶n8nå—ï¼Ÿæœ‰ç¾¤å‹å°±é—®èƒ½ä¸ä¸èƒ½åŸºäºn8nä»¿å†™ï¼Œæˆ‘çš„å›ç­”æ˜¯å½“ç„¶å¯ä»¥ã€‚<strong>åªéœ€è¦ä½ æä¾›ä¸€ä¸ªå¯¹æ ‡æ–‡ç« é“¾æ¥ï¼Œç­‰å¾…å‡ ç§’é’Ÿåï¼Œä¸€ç¯‡æ–°çš„æ–‡ç« å°±ä¼šå‡ºç°åœ¨ä½ çš„å…¬ä¼—å·è‰ç¨¿ç®±å½“ä¸­ï¼Œè¿˜é…äº†å°é¢å›¾</strong>ã€‚</p>
<p>æˆ‘ç”¨åŠå¤©æ—¶é—´æ­å»ºäº†ä¸€ä¸ªn8nå·¥ä½œæµï¼Œæ“ä½œæ–¹æ³•éå¸¸ç®€å•ï¼Œæ‰“å¼€å·¥ä½œæµç•Œé¢ï¼Œç‚¹å‡»åº•éƒ¨çš„ <strong>ã€Excute</strong> <strong>workflow</strong> <strong>ã€‘</strong> æŒ‰é’®ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c430cf47db054b1d8fd1edf905b37a2a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=ePDrRj4V24MGoC48mPyUE2mszO4%3D" alt="" loading="lazy"/></p>
<p>åœ¨å¼¹å‡ºçš„è¡¨å•ä¸­è¾“å…¥å¯¹æ ‡æ–‡ç« é“¾æ¥ï¼Œç‚¹å‡»ã€submitã€‘æŒ‰é’®ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/01ce3eb1d80e4b908cf80e0e0cc68e2f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=v7ptEBepSodis5nVYN04vNrozN8%3D" alt="" loading="lazy"/></p>
<p>ç­‰å¾…å‡ ç§’åæ–°çš„æ–‡ç« å°±ä¼šå‡ºç°åœ¨æˆ‘ä»¬çš„å…¬ä¼—å·è‰ç¨¿ç®±ä¸­ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e555527d65ca4f05b54ae394405b222e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=1bpyHbwYsVM8MvgQYWjoOlTNS7E%3D" alt="" loading="lazy"/></p>
<p>ä¸‹å›¾ä¸­å·¦è¾¹æ˜¯åŸæ–‡ï¼Œå³è¾¹æ˜¯ä»¿å†™æ–°æ–‡ <strong>ã€‚</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/12a1849bec894d1fb0c9ba5d27727f5b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=Jap38XNZBU6gxcKKYADhucgsY5U%3D" alt="" loading="lazy"/></p>
<p><strong>åœ¨</strong> <strong>æ–°æ–‡</strong> <strong>é‡Œæˆ‘æ²¡åšé…å›¾ï¼Œå› ä¸ºCozeä¹‹å‰åšè¿‡åŒæ ·åŠŸèƒ½çš„</strong> <strong>å·¥ä½œæµ</strong> <strong>ï¼Œå¤§å®¶éƒ½ååº”æƒ³è‡ªå·±é…å›¾ï¼Œæ‰€ä»¥åœ¨n8nè¿™è¾¹å°±çœç•¥äº†å·¥ä½œæµé…å›¾çš„æ­¥éª¤ã€‚å¯¹è¿™ä¸ªå·¥ä½œæµæ„Ÿå…´è¶£çš„è¯»è€…èµ¶ç´§ç ä½è·Ÿç»ƒå“¦~</strong></p>
<h2 data-id="heading-1">2. å·¥ä½œæµæ­å»ºå‰ç½®æ“ä½œ</h2>
<h3 data-id="heading-2">2.1. å¼€é€šå›¾åƒç”ŸæˆæœåŠ¡</h3>
<p><strong>æœ¬</strong> <strong>å·¥ä½œæµ</strong> <strong>ç”Ÿå›¾ä¾æ‰˜é€šä¹‰ä¸‡ç›¸2.5</strong> <strong>MCP</strong> <strong>Serverï¼Œæ•…éœ€è¦å»å¯¹åº”ç½‘ç«™å¼€é€šæœåŠ¡ã€‚</strong></p>
<p>é€šä¹‰ä¸‡ç›¸2.5-å›¾åƒè§†é¢‘ç”Ÿæˆå¼€é€šåœ°å€ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fbailian.console.aliyun.com%2F%3Fspm%3Da2c4g.11186623.0.0.7f477980N1ex6P%26tab%3Dmcp%23%2Fmcp-market%2Fdetail%2FWan25Media" target="_blank" title="https://bailian.console.aliyun.com/?spm=a2c4g.11186623.0.0.7f477980N1ex6P&amp;tab=mcp#/mcp-market/detail/Wan25Media" ref="nofollow noopener noreferrer">bailian.console.aliyun.com/?spm=a2c4g.â€¦</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00a4560cc50442d5a06d6cee86a08460~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=83CMmQtBNrfNHrgesmQxI4Krnug%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">2.2. ä¸‹è½½n8nç¤¾åŒºèŠ‚ç‚¹</h3>
<p>åœ¨n8nä¸­æ–°å¢ç¤¾åŒºèŠ‚ç‚¹n8n-nodes-wechat-offiaccountã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7da90d985ae144048f77c720c20f2cb7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=qXGV5TGC1SV0R9Ez%2Bv1aNLpTlt8%3D" alt="" loading="lazy"/></p>
<p>å®‰è£…å®Œæˆåéœ€è¦å›åˆ°n8nç•Œé¢ï¼Œæ–°å»ºå‡­è¯ï¼ˆWechat Official Account Credentials accountï¼‰ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a733730717bc4d0eacd435124e0062ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=IEY8n8gV98lfgFZE9QIOBHceCOk%3D" alt="" loading="lazy"/></p>
<p>å°†å…¬ä¼—å·åå°çš„appidå’Œsecretå¡«å…¥ä¸Šè¿°è¡¨å•ï¼ŒåŒæ—¶éœ€è¦å°†ä½ çš„å…¬ç½‘ipé…ç½®åˆ°ç™½åå•å½“ä¸­ï¼Œå…¬ç½‘ipè·å–æŒ‡ä»¤ä¸ºï¼šcurl ipinfo.io/ipã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7357898839814447bc3c2e0b7acc770d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=DifOTw%2BYYINyfka1MhhZhT0RThA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">3. å·¥ä½œæµæ­å»º</h2>
<p>æ•´ä¸ªå·¥ä½œæµå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ¥ä¸‹æ¥å°±å¼€å§‹ä¾æ¬¡æ‹†è§£å·¥ä½œæµçš„æ¯ä¸ªèŠ‚ç‚¹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1430ddda028b499c8b763e0209422869~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=kmUR5RJI9D5v7L8LAtqZplp%2FWz4%3D" alt="" loading="lazy"/></p>
<p><strong>å¼€å§‹èŠ‚ç‚¹ï¼š</strong> å¼€å§‹èŠ‚ç‚¹ç±»å‹é€‰æ‹©<strong>On form submissionã€‚</strong></p>
<ul>
<li>Form Titleå¡«å†™å…¬ä¼—å·ä»¿å†™</li>
<li>ç‚¹å‡» <strong>ã€add Form Elementã€‘</strong> èŠ‚ç‚¹æ–°å¢è¡¨å•è¦ç´ ï¼Œåœ¨Field Nameå¡«å…¥å…¬ä¼—å·é“¾æ¥ï¼ŒElement Typeé€‰æ‹©textï¼ŒPlaceholderä»»æ„å¡«å…¥ä¸€ä¸ªå…¬ä¼—å·æ–‡ç« é“¾æ¥ã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94a7bfcea310415b950ba26d499a6939~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=%2BAvruBTINVREJf%2BU9NU34Ih%2FcmM%3D" alt="" loading="lazy"/></p>
<p><strong>HTTP Requestï¼ˆè°ƒç”¨Cozeè·å–å…¬ä¼—å·æ–‡ç« å†…</strong> <strong>api</strong> <strong>ï¼‰ï¼š</strong> å¼€å§‹èŠ‚ç‚¹å‡ºæ¥åç‚¹å‡»ã€+ã€‘æ–°å¢<strong>HTTP Requestï¼Œ</strong> è¿™ä¸ªèŠ‚ç‚¹çš„ä½œç”¨æ˜¯è°ƒç”¨Cozeå·¥ä½œæµçš„apiæ ¹æ®è¾“å…¥æ–‡ç« çš„urlæ¥è·å–æ–‡ç« çš„æ ‡é¢˜å’Œå†…å®¹ã€‚</p>
<ul>
<li>Methodå¡«å†™POSTã€‚</li>
<li>URLå¡«å†™<a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.coze.cn%2Fv1%2Fworkflow%2Frun%25E3%2580%2582" target="_blank" title="https://api.coze.cn/v1/workflow/run%E3%80%82" ref="nofollow noopener noreferrer">api.coze.cn/v1/workflowâ€¦</a></li>
<li>Generic Auth Typeé€‰æ‹©Header Authã€‚</li>
<li>Header Authå¡«å†™Cozeçš„å‡­è¯</li>
<li>æ‰“å¼€Send Headersï¼ŒSpecify Headersé€‰æ‹©Using Fields Belowï¼ŒHeader Parametersä¸­Nameå¡«å†™Content-Typeï¼Œvalueå¡«å†™application/jsonã€‚</li>
<li>æ‰“å¼€Send Bodyï¼ŒBody Content Typeé€‰æ‹©JSONï¼ŒSpecify Bodyé€‰æ‹©Using JSONï¼ŒJSONä¸­å¡«å†™ï¼š</li>
</ul>

<pre><code class="hljs language-bash" lang="bash">{
  <span class="hljs-string">"workflow_id"</span>: <span class="hljs-string">"ä½ çš„Cozeå·¥ä½œæµid"</span>,
  <span class="hljs-string">"parameters"</span>: {
    <span class="hljs-string">"input"</span>: <span class="hljs-string">"{{ <span class="hljs-variable">$json</span>['å…¬ä¼—å·é“¾æ¥'] }}"</span>
  }
}
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3b91fae9553f4c4abce4676f1913bb41~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=7KdSgRvYMvAi1pRL%2F2Qet%2BnEIfQ%3D" alt="" loading="lazy"/></p>
<p>Cozeå·¥ä½œæµæ­å»ºå¾ˆç®€å•ï¼Œå°±ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œæ ¸å¿ƒå°±æ˜¯é€šè¿‡Cozeæ’ä»¶æ¥è·å–å…¬ä¼—å·æ–‡ç« é“¾æ¥å†…å®¹å¹¶æ¸…æ´—æ–‡ç« æ•°æ®ï¼Œæ’é™¤å¹²æ‰°é¡¹ï¼ˆå¦‚å‘å¸ƒæ—¶é—´è¿™äº›æ— æ„ä¹‰çš„å­—ï¼‰åè¿›è¡Œè¾“å‡ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8169a4cb196c4447ab481dcca6c490d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=vwwA5rw%2BqAv3o2SThRoYMikL4VA%3D" alt="" loading="lazy"/></p>
<p>å·¥ä½œæµæ­å»ºå¥½ä»¥åå°±å¯ä»¥ä»¥APIçš„å½¢å¼è¿›è¡Œè°ƒç”¨äº†ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92bfe149546c42fd9953c048724a21c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=V86X0aBcbqKrHk9%2FBWlsru7a4NU%3D" alt="" loading="lazy"/></p>
<p><strong>Code in</strong> <strong>JavaScript</strong> <strong>ï¼ˆæŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸º</strong> <strong>json</strong> <strong>æ ¼å¼ï¼‰ï¼šHTTP Request</strong>èŠ‚ç‚¹å‡ºæ¥åç‚¹å‡»ã€+ã€‘æ–°å¢<strong>Code in JavaScriptï¼Œ</strong> è¿™æ˜¯ä¸€ä¸ªä»£ç èŠ‚ç‚¹ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨å°±æ˜¯æŠŠå‰ç½®èŠ‚ç‚¹è¾“å‡ºçš„å­—ç¬¦ä¸²æ•°æ®è½¬æ¢ä¸ºjsonæ ¼å¼ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b8b64c3c4e544524b549c37e39ace729~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=YHANrcgfJQHTJxOdD1yBV0cB0rE%3D" alt="" loading="lazy"/></p>
<p><strong>çˆ†æ–‡ä»¿å†™ï¼ˆ</strong> <strong>AI</strong> <strong>Agentï¼‰ï¼šCode in</strong> <strong>JavaScript</strong>èŠ‚ç‚¹å‡ºæ¥åç‚¹å‡»ã€+ã€‘æ–°å¢<strong>AI Agent</strong>èŠ‚ç‚¹ï¼Œè¿™ä¸ªèŠ‚ç‚¹çš„ä½œç”¨è·å–å‰ç½®èŠ‚ç‚¹è¾“å‡ºçš„æ–‡ç« æ ‡é¢˜å’Œå†…å®¹åŸºäºgemini-2.5-proæ¨¡å‹è¿›è¡Œæ·±åº¦äºŒåˆ›ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e3a0a2adbb6d45bca11a11eb81e6f695~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=28TRWIRa5aqshrZLWGWMSeAAgXM%3D" alt="" loading="lazy"/></p>
<ul>
<li>åœ¨Chat Modelå¤„ç‚¹å‡»ã€+ã€‘ï¼Œæ–°å¢èŠå¤©æ¨¡å‹ã€‚</li>
<li>åœ¨Output Parserå¤„ç‚¹å‡»ã€+ã€‘ï¼Œè§„æ•´è¾“å‡ºæ ¼å¼ï¼ŒJSON Exampleå¤„å¡«å…¥ï¼š</li>
</ul>

<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"title"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"content"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/25e3a2c4e1e743f2ac7110b1951d8f0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=W4t0priBgc5qH84mf1TaBcxmZv8%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">3.1 ç”Ÿæˆå°é¢</h3>
<p><strong>ç”Ÿæˆå°é¢ï¼ˆ</strong> <strong>AI</strong> <strong>Agentï¼‰ï¼šçˆ†æ–‡ä»¿å†™ï¼ˆAI Agentï¼‰</strong> èŠ‚ç‚¹å‡ºæ¥åç‚¹å‡»ã€+ã€‘æ–°å¢<strong>AI Agentã€‚</strong> è¿™ä¸ªèŠ‚ç‚¹çš„ä½œç”¨çš„è°ƒç”¨é€šä¹‰ä¸‡ç›¸2.5çš„MCP Serveræ¥ç”Ÿæˆå›¾ç‰‡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c597d490ed794789bb43582529cd3fc6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=mlU4O74mVUQb1btKcO0stsCT%2BWo%3D" alt="" loading="lazy"/></p>
<ul>
<li>Chat Modelå¤„ç‚¹å‡»ã€+ã€‘æ–°å¢OpenAI Chat Modeï¼ˆæˆ–DeepSeek Chat Modelï¼‰ã€‚</li>
<li>Toolå¤„ç‚¹å‡»ã€+ã€‘æ–°å¢MCP Client Toolç”¨äºå›¾ç‰‡ç”Ÿæˆã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cce09ce1b97f41baaaa263cfc6dbb3bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=skWhz6Uk01mtftMiwjtrCNfhWCw%3D" alt="" loading="lazy"/></p>
<p>Endpointå¡«å†™<a href="https://link.juejin.cn?target=https%3A%2F%2Fdashscope.aliyuncs.com%2Fapi%2Fv1%2Fmcps%2FWan25Media%2Fsse%25E3%2580%2582" target="_blank" title="https://dashscope.aliyuncs.com/api/v1/mcps/Wan25Media/sse%E3%80%82" ref="nofollow noopener noreferrer">dashscope.aliyuncs.com/api/v1/mcpsâ€¦</a></p>
<p>Server Transporté€‰æ‹©Server Sent Events (Deprecated)ã€‚</p>
<p>Authenticationé€‰æ‹©Header Authã€‚</p>
<p>Credential for Header Authç‚¹å‡»Create new credentialï¼ŒNameå¡«å†™Authorizationï¼ŒValueå¡«å†™é˜¿é‡Œäº‘ç™¾ç‚¼çš„keyï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fbailian.console.aliyun.com%2F%3Fspm%3Da2c4g.11186623.0.0.7f477980N1ex6P%26tab%3Dmodel%23%2Fapi-key%25EF%25BC%2589%25EF%25BC%258C%25E6%25B3%25A8%25E6%2584%258Fkey%25E5%2589%258D%25E9%259D%25A2%25E9%259C%2580%25E8%25A6%2581%25E5%258A%25A0Bearer%25E5%2592%258C%25E4%25B8%2580%25E4%25B8%25AA%25E8%258B%25B1%25E6%2596%2587%25E7%25A9%25BA%25E6%25A0%25BC%25E3%2580%2582**%25E6%259C%2580%25E5%2590%258E%25E6%258A%258A%25E8%25BF%2599%25E4%25B8%25AAAuth%25E5%2591%25BD%25E5%2590%258D%25E4%25B8%25BAbailian%25E3%2580%2582" target="_blank" title="https://bailian.console.aliyun.com/?spm=a2c4g.11186623.0.0.7f477980N1ex6P&amp;tab=model#/api-key%EF%BC%89%EF%BC%8C%E6%B3%A8%E6%84%8Fkey%E5%89%8D%E9%9D%A2%E9%9C%80%E8%A6%81%E5%8A%A0Bearer%E5%92%8C%E4%B8%80%E4%B8%AA%E8%8B%B1%E6%96%87%E7%A9%BA%E6%A0%BC%E3%80%82**%E6%9C%80%E5%90%8E%E6%8A%8A%E8%BF%99%E4%B8%AAAuth%E5%91%BD%E5%90%8D%E4%B8%BAbailian%E3%80%82" ref="nofollow noopener noreferrer">bailian.console.aliyun.com/?spm=a2c4g.â€¦</a>**</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/06923ce274f04160aec4dc5e7398a94a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=jW8EPc7np%2BoIsPasG6AZ1qJvntk%3D" alt="" loading="lazy"/></p>
<p><strong>HTTP Request1ï¼ˆå°†å°é¢å›¾é“¾æ¥è½¬æ¢ä¸ºæ–‡ä»¶ï¼‰ï¼šç”Ÿæˆå°é¢ï¼ˆ</strong> <strong>AI</strong> <strong>Agentï¼‰</strong> èŠ‚ç‚¹å‡ºæ¥åç‚¹å‡»ã€+ã€‘æ·»åŠ <strong>HTTP Request</strong>èŠ‚ç‚¹ï¼Œè¿™ä¸ªèŠ‚ç‚¹çš„ä½œç”¨æ˜¯æŠŠå›¾ç‰‡é“¾æ¥è½¬æ¢ä¸ºæ–‡ä»¶æ ¼å¼ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/75e5f45ed13d4ce5b887fd6ece0e744a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=2ic2T1T2aY%2BAJoI96iBuw3vrUNI%3D" alt="" loading="lazy"/></p>
<p><strong>Media:uploadOther mediaï¼ˆä¸Šä¼ å°é¢å›¾ï¼‰ï¼šHTTP Request1</strong>èŠ‚ç‚¹å‡ºæ¥åç‚¹å‡»ã€+ã€‘æ–°å¢<strong>Media:uploadOther mediaã€‚</strong> è¿™ä¸ªèŠ‚ç‚¹çš„ä½œç”¨æ˜¯ä¸Šä¼ å›¾ç‰‡é“¾æ¥å¹¶è¿”å›ä¸€ä¸ªmedia_idï¼Œåç»­å¡«å……åˆ°å…¬ä¼—å·å°é¢ä¸­ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/006b504ac9374f5280747a9ce1c78ab8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=i92E%2BIsCQhP7ICI0VvrFGpFh2M0%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-6">3.2. ç”Ÿæˆæ­£æ–‡</h3>
<p><strong>Code in JavaScript1ï¼šçˆ†æ–‡ä»¿å†™ï¼ˆ</strong> <strong>AI</strong> <strong>Agentï¼‰</strong> èŠ‚ç‚¹å‡ºæ¥åç‚¹å‡»ã€+ã€‘æ–°å¢Code in JavaScriptï¼Œè¿™ä¸ªèŠ‚ç‚¹çš„ä½œç”¨æ˜¯å°†æ­£æ–‡å†…å®¹æ”¹å†™æˆhtmlæ ¼å¼å†…å®¹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/45a64f65af3b41ea911899620b9e1de9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=Pjg34iKv8cSA4owYyPRwOTvK%2FRI%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">3.3. ä¸Šä¼ åˆ°è‰ç¨¿ç®±</h3>
<p><strong>Mergeï¼šCode in JavaScript1å’ŒMedia:uploadOther media</strong>èŠ‚ç‚¹å‡ºæ¥åç‚¹å‡»ã€+ã€‘æ–°å¢<strong>Mergeã€‚</strong> è¿™ä¸ªèŠ‚ç‚¹çš„ä½œç”¨æ˜¯æ•´åˆå‰é¢ç”Ÿæˆçš„å°é¢å’Œä»¿å†™åŸæ–‡ã€‚</p>
<ul>
<li>Modeé€‰æ‹©Combine</li>
<li>Combine Byé€‰æ‹©Position</li>
<li>Number of Inputså¡«å†™2</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7033e031e62d41d2960a9cc379c7bb6a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=aPEkb%2BEZVqX4rcHLJfE2LEcFeqc%3D" alt="" loading="lazy"/></p>
<p><strong>æ–°å¢è‰ç¨¿ï¼šMerge</strong>èŠ‚ç‚¹å‡ºæ¥åç‚¹å‡»ã€+ã€‘æ–°å¢<strong>Draft:add draft</strong>èŠ‚ç‚¹ï¼Œè¿™ä¸ªèŠ‚ç‚¹çš„ä½œç”¨æ˜¯å°†å‰ç½®èŠ‚ç‚¹ç”Ÿæˆçš„å°é¢å’Œæ­£æ–‡éƒ½ä¸Šä¼ åˆ°å…¬ä¼—å·è‰ç¨¿å½“ä¸­ã€‚</p>
<p>è‰ç¨¿æ–‡ç« å¯¹è±¡å†…å®¹(Articles)å¡«å†™ï¼š</p>
<pre><code class="hljs language-python" lang="python">[
  {
    <span class="hljs-string">"article_type"</span>: <span class="hljs-string">"news"</span>,
    <span class="hljs-string">"title"</span>: <span class="hljs-string">"{{ $('çˆ†æ–‡ä»¿å†™').item.json.output.title }}"</span>,
    <span class="hljs-string">"author"</span>: <span class="hljs-string">"å°è‚¥è‚ "</span>,
    <span class="hljs-string">"content"</span>: <span class="hljs-string">"{{ 
  $json.htmlContent
    .replaceAll("</span>\n<span class="hljs-string">", "</span>\n<span class="hljs-string">")   
    .replaceAll("</span>\<span class="hljs-string">r", "</span>\<span class="hljs-string">r")   
    .replaceAll("</span><span class="hljs-string">""</span>, <span class="hljs-string">"'"</span>)   
}}<span class="hljs-string">",
    "</span>thumb_media_id<span class="hljs-string">": "</span>{{ $json.media_id }}<span class="hljs-string">",
    "</span>show_cover_pic<span class="hljs-string">": 1,
    "</span>need_open_comment<span class="hljs-string">": 1,
    "</span>only_fans_can_comment<span class="hljs-string">": 0
  }
]
</span></code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34eff983330a401d88ae8c90b2fbabf0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=u1nsGtMPR%2FlEPTB38j8Q921A2TQ%3D" alt="" loading="lazy"/></p>
<p>ä»¥ä¸Šå°±æ˜¯æ•´ä¸ªå·¥ä½œæµçš„å®Œæ•´æµç¨‹æ‹†è§£ï¼ŒåŠ¨æ‰‹èƒ½åŠ›å¼ºçš„è¯»è€…å¯ä»¥è·Ÿç€æ•™ç¨‹å®è·µä¸€éã€‚å¦‚æœæƒ³ç›´æ¥è·å–å·¥ä½œæµï¼Œå¯ä»¥åŠ å…¥ç¤¾ç¾¤åæˆ‘æ‹‰ä½ è¿›ç©ºé—´ç›´æ¥å­¦ä¹ ä½¿ç”¨ã€‚</p>
<h2 data-id="heading-8">4. ç»“è¯­</h2>
<p>æœ¬æ–‡è¯¦ç»†æ‹†è§£äº†å¦‚ä½•åˆ©ç”¨ <strong>n8n</strong> å¼ºå¤§çš„è‡ªåŠ¨åŒ–èƒ½åŠ›ï¼Œé…åˆ <strong>Coze</strong> å’Œ <strong>AI</strong> <strong>Agent</strong>ï¼ˆå¦‚ <strong>Gemini 2.5 Pro</strong> æ¨¡å‹ï¼‰å®ç°ä¸€ä¸ªé«˜åº¦è‡ªåŠ¨åŒ–çš„å…¬ä¼—å·æ–‡ç« ä»¿å†™å·¥ä½œæµã€‚ä»å‰ç½®æœåŠ¡çš„å¼€é€šã€ç¤¾åŒºèŠ‚ç‚¹çš„å®‰è£…ï¼Œåˆ°å·¥ä½œæµçš„æ¯ä¸€ä¸ªèŠ‚ç‚¹â€”â€”æ•°æ®è·å–ã€å†…å®¹æ·±åº¦äºŒåˆ›ã€å°é¢å›¾ç”Ÿæˆã€æ ¼å¼è½¬æ¢ï¼Œç›´è‡³æœ€ç»ˆä¸Šä¼ åˆ°å…¬ä¼—å·<strong>è‰ç¨¿ç®±</strong>ï¼Œæˆ‘ä»¬å®Œæˆäº†æ•´ä¸ª<strong>ä¸€é”®ä»¿å†™</strong>çš„é—­ç¯ã€‚</p>
<p><strong>å¦‚æœ¬æ¬¡åˆ†äº«å¯¹ä½ æœ‰å¸®åŠ©ï¼Œéº»çƒ¦ä¸€é”®ä¸‰è¿æ”¯æŒä¸€ä¸‹å°è‚¥è‚ ï¼Œæˆ‘ä»¬ä¸‹æœŸå†è§~</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a96bc810e0f4e9b9ba33c8bc628fc68~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZCO56uv5bCP6IKl6IKg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359758&amp;x-signature=yMZwLutQPoQH8yGkU0EzOKu92qY%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±åº¦è§£æï¼šVue 3 ä¸­ ssrTransformTransitionGroup çš„å®ç°åŸç†ä¸æœºåˆ¶]]></title>    <link>https://juejin.cn/post/7569976345929777203</link>    <guid>https://juejin.cn/post/7569976345929777203</guid>    <pubDate>2025-11-09T00:02:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7569976345929777203" data-draft-id="7569913182036033546" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±åº¦è§£æï¼šVue 3 ä¸­ ssrTransformTransitionGroup çš„å®ç°åŸç†ä¸æœºåˆ¶"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-09T00:02:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="excel"/> <meta itemprop="url" content="https://juejin.cn/user/2911162520062862"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±åº¦è§£æï¼šVue 3 ä¸­ ssrTransformTransitionGroup çš„å®ç°åŸç†ä¸æœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2911162520062862/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    excel
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-09T00:02:31.000Z" title="Sun Nov 09 2025 00:02:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Vue 3 çš„æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰ç¼–è¯‘ä½“ç³»ä¸­ï¼Œ<strong><code>TransitionGroup</code></strong> æ˜¯ä¸€ä¸ªéå¸¸ç‰¹æ®Šçš„ç»„ä»¶ã€‚<br/>
å®ƒæ—¢æ˜¯ä¸€ä¸ªè¿‡æ¸¡å®¹å™¨ï¼Œåˆéœ€è¦åœ¨æœåŠ¡ç«¯ç”Ÿæˆç»“æ„åŒ– HTMLï¼Œå¹¶åœ¨å®¢æˆ·ç«¯ä¿æŒå¯ hydration çš„ä¸€è‡´æ€§ã€‚<br/>
ä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼ŒVue ç¼–è¯‘å™¨å¯¹å®ƒè¿›è¡Œäº†ä¸“é—¨çš„ä¸¤é˜¶æ®µå¤„ç†â€”â€”<br/>
ä¹Ÿå°±æ˜¯æœ¬æ–‡è¦æ·±å…¥è§£æçš„ <code>ssrTransformTransitionGroup</code> ä¸ <code>ssrProcessTransitionGroup</code>ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€èƒŒæ™¯ä¸æ•´ä½“æ¦‚å¿µ</h2>
<p>Vue çš„ SSR ç¼–è¯‘è¿‡ç¨‹ä¸æ™®é€šç¼–è¯‘ï¼ˆå³ DOM æ¸²æŸ“ç¼–è¯‘ï¼‰ä¸åŒã€‚<br/>
åœ¨ SSR æ¨¡å¼ä¸‹ï¼Œæ¨¡æ¿éœ€è¦è¢«è½¬æ¢ä¸º<strong>å¯ç›´æ¥è¾“å‡º HTML å­—ç¬¦ä¸²çš„æ¸²æŸ“å‡½æ•°</strong>ã€‚</p>
<p>å¯¹äºä¸€èˆ¬ç»„ä»¶æ¥è¯´ï¼ŒSSR ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å°† propsã€children ç­‰ä¿¡æ¯ç¼–è¯‘ä¸ºå­—ç¬¦ä¸²ã€‚<br/>
ä½†å¯¹äº <code>&lt;TransitionGroup&gt;</code> è¿™ç§<strong>åŠ¨æ€åŒ…è£…å®¹å™¨ç»„ä»¶</strong>ï¼Œåˆ™å¿…é¡»ç‰¹æ®Šå¤„ç†ï¼š</p>
<ul>
<li>å®ƒå…è®¸å¼€å‘è€…é€šè¿‡ <code>tag</code> æˆ– <code>:tag</code> è‡ªå®šä¹‰åŒ…è£¹å…ƒç´ ï¼›</li>
<li>å®ƒä¼šåœ¨è¿è¡Œæ—¶<strong>å°†å­èŠ‚ç‚¹å±•å¹³ï¼ˆflattenï¼‰</strong> ï¼›</li>
<li>å®ƒä¼šåœ¨è¿è¡Œæ—¶<strong>è¿‡æ»¤æ³¨é‡ŠèŠ‚ç‚¹</strong>ï¼›</li>
<li>åŒæ—¶è¿˜è¦ä¿è¯ SSR ä¸ Hydration é˜¶æ®µ DOM ç»“æ„å¯¹é½ã€‚</li>
</ul>
<p>äºæ˜¯ Vue å†…éƒ¨å¼•å…¥äº†ä¸€ä¸ªåŒé˜¶æ®µè®¾è®¡ï¼š</p>
<blockquote>
<p><strong>Phase 1ï¼šæ„å»ºé˜¶æ®µï¼ˆTransformï¼‰</strong><br/>
<strong>Phase 2ï¼šè¾“å‡ºé˜¶æ®µï¼ˆProcessï¼‰</strong></p>
</blockquote>
<p>è¿™å°±æ˜¯æœ¬æ–‡ä»¶å®ç°çš„æ ¸å¿ƒé€»è¾‘ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€æºç å…¨è²Œ</h2>
<p>ä»¥ä¸‹æ˜¯ Vue æºç ä¸­çš„å…³é”®å®ç°ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ssrTransformTransitionGroup</span>(<span class="hljs-params">node, context</span>) {
  <span class="hljs-keyword">return</span> (): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> tag = <span class="hljs-title function_">findProp</span>(node, <span class="hljs-string">'tag'</span>)
    <span class="hljs-keyword">if</span> (tag) {
      <span class="hljs-keyword">const</span> otherProps = node.<span class="hljs-property">props</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p !== tag)
      <span class="hljs-keyword">const</span> { props, directives } = <span class="hljs-title function_">buildProps</span>(node, context, otherProps, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>)
      <span class="hljs-keyword">let</span> propsExp = <span class="hljs-literal">null</span>
      <span class="hljs-keyword">if</span> (props || directives.<span class="hljs-property">length</span>) {
        propsExp = <span class="hljs-title function_">createCallExpression</span>(context.<span class="hljs-title function_">helper</span>(<span class="hljs-variable constant_">SSR_RENDER_ATTRS</span>), [
          <span class="hljs-title function_">buildSSRProps</span>(props, directives, context),
        ])
      }
      wipMap.<span class="hljs-title function_">set</span>(node, {
        tag,
        propsExp,
        <span class="hljs-attr">scopeId</span>: context.<span class="hljs-property">scopeId</span> || <span class="hljs-literal">null</span>,
      })
    }
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ssrProcessTransitionGroup</span>(<span class="hljs-params">node, context</span>) {
  <span class="hljs-keyword">const</span> entry = wipMap.<span class="hljs-title function_">get</span>(node)
  <span class="hljs-keyword">if</span> (entry) {
    <span class="hljs-keyword">const</span> { tag, propsExp, scopeId } = entry
    <span class="hljs-keyword">if</span> (tag.<span class="hljs-property">type</span> === <span class="hljs-title class_">NodeTypes</span>.<span class="hljs-property">DIRECTIVE</span>) {
      <span class="hljs-comment">// åŠ¨æ€ tag</span>
      context.<span class="hljs-title function_">pushStringPart</span>(<span class="hljs-string">`&lt;`</span>)
      context.<span class="hljs-title function_">pushStringPart</span>(tag.<span class="hljs-property">exp</span>!)
      <span class="hljs-keyword">if</span> (propsExp) context.<span class="hljs-title function_">pushStringPart</span>(propsExp)
      <span class="hljs-keyword">if</span> (scopeId) context.<span class="hljs-title function_">pushStringPart</span>(<span class="hljs-string">` <span class="hljs-subst">${scopeId}</span>`</span>)
      context.<span class="hljs-title function_">pushStringPart</span>(<span class="hljs-string">`&gt;`</span>)

      <span class="hljs-title function_">processChildren</span>(node, context, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>)

      context.<span class="hljs-title function_">pushStringPart</span>(<span class="hljs-string">`&lt;/`</span>)
      context.<span class="hljs-title function_">pushStringPart</span>(tag.<span class="hljs-property">exp</span>!)
      context.<span class="hljs-title function_">pushStringPart</span>(<span class="hljs-string">`&gt;`</span>)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// é™æ€ tag</span>
      context.<span class="hljs-title function_">pushStringPart</span>(<span class="hljs-string">`&lt;<span class="hljs-subst">${tag.value!.content}</span>`</span>)
      <span class="hljs-keyword">if</span> (propsExp) context.<span class="hljs-title function_">pushStringPart</span>(propsExp)
      <span class="hljs-keyword">if</span> (scopeId) context.<span class="hljs-title function_">pushStringPart</span>(<span class="hljs-string">` <span class="hljs-subst">${scopeId}</span>`</span>)
      context.<span class="hljs-title function_">pushStringPart</span>(<span class="hljs-string">`&gt;`</span>)

      <span class="hljs-title function_">processChildren</span>(node, context, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>)
      context.<span class="hljs-title function_">pushStringPart</span>(<span class="hljs-string">`&lt;/<span class="hljs-subst">${tag.value!.content}</span>&gt;`</span>)
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// æ—  tag æƒ…å†µ</span>
    <span class="hljs-title function_">processChildren</span>(node, context, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>)
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€åŸç†å‰–æï¼šSSR ç¼–è¯‘çš„ä¸¤é˜¶æ®µé€»è¾‘</h2>
<h3 data-id="heading-3">1. Transform é˜¶æ®µï¼ˆ<code>ssrTransformTransitionGroup</code>ï¼‰</h3>
<p>åœ¨ AST è½¬æ¢é˜¶æ®µï¼ŒVue ç¼–è¯‘å™¨ä¼šéå†æ¨¡æ¿ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ã€‚<br/>
å¯¹äº <code>&lt;TransitionGroup&gt;</code>ï¼Œè¿™ä¸€æ­¥ä¸»è¦åšçš„æ˜¯<strong>ä¿¡æ¯æå–</strong>ï¼š</p>
<h4 data-id="heading-4">æ ¸å¿ƒæµç¨‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> tag = <span class="hljs-title function_">findProp</span>(node, <span class="hljs-string">'tag'</span>) <span class="hljs-comment">// æ‰¾å‡º &lt;TransitionGroup tag="ul"&gt; çš„ tag å±æ€§</span>
<span class="hljs-keyword">const</span> otherProps = node.<span class="hljs-property">props</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p !== tag) <span class="hljs-comment">// è¿‡æ»¤æ‰ tag</span>
<span class="hljs-keyword">const</span> { props, directives } = <span class="hljs-title function_">buildProps</span>(...) <span class="hljs-comment">// æ„å»º SSR props</span>
</code></pre>
<h4 data-id="heading-5">é€»è¾‘è¯´æ˜</h4>
<ul>
<li>
<p><strong><code>findProp</code></strong>ï¼šæŸ¥æ‰¾ <code>&lt;TransitionGroup&gt;</code> ä¸Šçš„ tag å±æ€§ï¼›</p>
</li>
<li>
<p><strong><code>buildProps</code></strong>ï¼šæ„å»º SSR éœ€è¦çš„ propsï¼›</p>
<ul>
<li>è¿™é‡Œä¼ å…¥çš„ <code>true /* ssr (skip event listeners) */</code> è¡¨ç¤ºè·³è¿‡äº‹ä»¶ç›‘å¬ï¼Œå› ä¸º SSR ä¸ç»‘å®šäº‹ä»¶ï¼›</li>
</ul>
</li>
<li>
<p><strong><code>createCallExpression</code></strong>ï¼šç”Ÿæˆ <code>_ssrRenderAttrs()</code> è°ƒç”¨è¡¨è¾¾å¼ï¼Œç”¨äºåœ¨åç»­æ‹¼æ¥å­—ç¬¦ä¸²æ—¶æ’å…¥å±æ€§å­—ç¬¦ä¸²ï¼›</p>
</li>
<li>
<p>æœ€ç»ˆç»“æœå­˜å…¥ä¸€ä¸ª <code>WeakMap</code> ç¼“å­˜ï¼Œä»¥ä¾¿ç¬¬äºŒé˜¶æ®µä½¿ç”¨ã€‚</p>
</li>
</ul>
<h4 data-id="heading-6">ç”Ÿæˆçš„ä¸­é—´æ•°æ®ç»“æ„</h4>
<pre><code class="hljs language-yaml" lang="yaml">{
  <span class="hljs-attr">tag:</span> <span class="hljs-string">AttributeNode</span> <span class="hljs-string">|</span> <span class="hljs-string">DirectiveNode</span>,
  <span class="hljs-attr">propsExp:</span> <span class="hljs-string">CallExpression</span> <span class="hljs-string">|</span> <span class="hljs-literal">null</span>,
  <span class="hljs-attr">scopeId:</span> <span class="hljs-string">string</span> <span class="hljs-string">|</span> <span class="hljs-literal">null</span>
}
</code></pre>
<hr/>
<h3 data-id="heading-7">2. Process é˜¶æ®µï¼ˆ<code>ssrProcessTransitionGroup</code>ï¼‰</h3>
<p>è¿™ä¸€é˜¶æ®µçœŸæ­£æ‰§è¡Œâ€œæ¸²æŸ“å­—ç¬¦ä¸²è¾“å‡ºâ€ã€‚</p>
<h4 data-id="heading-8">åŠ¨æ€æ ‡ç­¾ï¼ˆ<code>:tag="expr"</code>ï¼‰é€»è¾‘</h4>
<pre><code class="hljs language-scss" lang="scss">if (tag.type === NodeTypes.DIRECTIVE) {
  context<span class="hljs-selector-class">.pushStringPart</span>(`&lt;`)
  context<span class="hljs-selector-class">.pushStringPart</span>(tag.exp!)
  if (propsExp) context<span class="hljs-selector-class">.pushStringPart</span>(propsExp)
  if (scopeId) context<span class="hljs-selector-class">.pushStringPart</span>(` ${scopeId}`)
  context<span class="hljs-selector-class">.pushStringPart</span>(`&gt;`)
  <span class="hljs-built_in">processChildren</span>(node, context, false, true, true)
  context<span class="hljs-selector-class">.pushStringPart</span>(`&lt;/`)
  context<span class="hljs-selector-class">.pushStringPart</span>(tag.exp!)
  context<span class="hljs-selector-class">.pushStringPart</span>(`&gt;`)
}
</code></pre>
<blockquote>
<p>åœ¨è¿™é‡Œï¼Œ<code>tag.exp!</code> æ˜¯ä¸€ä¸ªåŠ¨æ€è¡¨è¾¾å¼ï¼ˆä¾‹å¦‚ <code>"listTag"</code>ï¼‰ï¼Œ<br/>
SSR è¾“å‡ºä¼šå˜æˆç±»ä¼¼ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">&lt;<span class="hljs-variable">${listTag}</span> ...attrs&gt;...&lt;/<span class="hljs-variable">${listTag}</span>&gt;
</code></pre>
</blockquote>
<h4 data-id="heading-9">é™æ€æ ‡ç­¾ï¼ˆ<code>tag="ul"</code>ï¼‰é€»è¾‘</h4>
<pre><code class="hljs language-javascript" lang="javascript">context.<span class="hljs-title function_">pushStringPart</span>(<span class="hljs-string">`&lt;<span class="hljs-subst">${tag.value!.content}</span>`</span>)
<span class="hljs-keyword">if</span> (propsExp) context.<span class="hljs-title function_">pushStringPart</span>(propsExp)
<span class="hljs-keyword">if</span> (scopeId) context.<span class="hljs-title function_">pushStringPart</span>(<span class="hljs-string">` <span class="hljs-subst">${scopeId}</span>`</span>)
context.<span class="hljs-title function_">pushStringPart</span>(<span class="hljs-string">`&gt;`</span>)
<span class="hljs-title function_">processChildren</span>(node, context, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>)
context.<span class="hljs-title function_">pushStringPart</span>(<span class="hljs-string">`&lt;/<span class="hljs-subst">${tag.value!.content}</span>&gt;`</span>)
</code></pre>
<blockquote>
<p>è¾“å‡ºç±»ä¼¼ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;ul <span class="hljs-attr">class</span>=<span class="hljs-string">"fade-list"</span>&gt; ... &lt;/ul&gt;
</code></pre>
</blockquote>
<h4 data-id="heading-10">ç‰¹æ®Šå‚æ•°è¯´æ˜</h4>
<p><code>processChildren(node, context, false, true, true)</code> çš„æœ€åä¸¤ä¸ªå¸ƒå°”å‚æ•°éå¸¸å…³é”®ï¼š</p>
<ul>
<li><strong><code>flattenFragments = true</code></strong>ï¼šè¡¨ç¤ºå°†æ‰€æœ‰å­èŠ‚ç‚¹å±•å¼€ä¸ºå•å±‚ fragmentï¼›</li>
<li><strong><code>ignoreComments = true</code></strong>ï¼šTransitionGroup ä¼šåœ¨è¿è¡Œæ—¶è¿‡æ»¤æ‰æ³¨é‡ŠèŠ‚ç‚¹ï¼Œå› æ­¤ SSR ä¹Ÿå¿…é¡»åŒæ­¥ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-11">å››ã€å¯¹æ¯”ä¸ç‰¹æ€§åˆ†æ</h2>









































<table><thead><tr><th>ç‰¹æ€§é¡¹</th><th>æ™®é€šç»„ä»¶</th><th>Transition</th><th>TransitionGroup</th></tr></thead><tbody><tr><td>è¾“å‡ºç»“æ„</td><td>å›ºå®š DOM æˆ– Fragment</td><td>åŒ…è£¹å­å…ƒç´ </td><td><strong>åŠ¨æ€ tag å¯é…ç½®</strong></td></tr><tr><td>Props å¤„ç†</td><td>æ­£å¸¸</td><td>æ­£å¸¸</td><td><strong>è·³è¿‡äº‹ä»¶ç›‘å¬</strong></td></tr><tr><td>å­èŠ‚ç‚¹æ¸²æŸ“</td><td>ä¿æŒå±‚çº§</td><td>å•å±‚</td><td><strong>å¼ºåˆ¶å±•å¹³ (flatten)</strong></td></tr><tr><td>æ³¨é‡ŠèŠ‚ç‚¹</td><td>ä¿ç•™</td><td>ä¿ç•™</td><td><strong>è¿‡æ»¤æ‰æ³¨é‡ŠèŠ‚ç‚¹</strong></td></tr><tr><td>SSR è¾“å‡º</td><td>é™æ€</td><td>åŠ¨æ€åŒ…è£¹</td><td><strong>åŠ¨æ€æ‹¼æ¥æ ‡ç­¾ç»“æ„</strong></td></tr></tbody></table>
<p>è¿™ä¸€è¡¨æ ¼æ­ç¤ºäº†ä¸ºä»€ä¹ˆ Vue éœ€è¦ä¸“é—¨çš„ SSR transform é€»è¾‘æ¥å¤„ç†å®ƒï¼š<br/>
TransitionGroup åŒæ—¶å…·å¤‡â€œå®¹å™¨â€ä¸â€œåŠ¨æ€ç»“æ„â€çš„ç‰¹æ€§ã€‚</p>
<hr/>
<h2 data-id="heading-12">äº”ã€æ‹“å±•ç†è§£ï¼šSSR Transform çš„æ¨¡å¼åŒ–è®¾è®¡</h2>
<p>Vue çš„ SSR Transform ç³»ç»Ÿæ™®ééµå¾ªä¸€ä¸ªæ¨¡æ¿åŒ–çš„æ¨¡å¼ï¼š</p>




















<table><thead><tr><th>é˜¶æ®µ</th><th>å‡½æ•°å‘½å</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><strong>Transform é˜¶æ®µ</strong></td><td><code>ssrTransformXxx</code></td><td>åªè´Ÿè´£æ”¶é›†é™æ€ä¿¡æ¯ï¼Œè®°å½•åˆ° WeakMap</td></tr><tr><td><strong>Process é˜¶æ®µ</strong></td><td><code>ssrProcessXxx</code></td><td>è¯»å–ç¼“å­˜ä¿¡æ¯ï¼Œç”Ÿæˆæœ€ç»ˆå­—ç¬¦ä¸²è¾“å‡º</td></tr></tbody></table>
<p>åŒç±»æ–‡ä»¶åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>ssrTransformComponent</code></li>
<li><code>ssrTransformTeleport</code></li>
<li><code>ssrTransformSlotOutlet</code></li>
</ul>
<p>è¿™ç§è®¾è®¡å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<ol>
<li><strong>é€»è¾‘è§£è€¦</strong>ï¼šTransform ä¸è¾“å‡ºç”Ÿæˆåˆ†ç¦»ï¼›</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šé¿å…é‡å¤å±æ€§åˆ†æï¼›</li>
<li><strong>é€’å½’å®‰å…¨</strong>ï¼šæ”¯æŒåµŒå¥—ç»“æ„ï¼ˆå¦‚ TransitionGroup å†…å†åµŒå¥—ç»„ä»¶ï¼‰ï¼›</li>
<li><strong>Hydration ä¸€è‡´æ€§</strong>ï¼šä¿è¯ SSR è¾“å‡ºä¸å®¢æˆ·ç«¯æ¸²æŸ“ç»“æ„å¯¹é½ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-13">å…­ã€æ½œåœ¨é—®é¢˜ä¸å®ç°æ³¨æ„äº‹é¡¹</h2>
<ol>
<li>
<p><strong>WeakMap ç”Ÿå‘½å‘¨æœŸ</strong><br/>
ç¼–è¯‘é˜¶æ®µç¼“å­˜ä»…å­˜äºå†…å­˜ï¼Œè‹¥å­˜åœ¨å¹¶è¡Œç¼–è¯‘ï¼ˆå¦‚ Vite å¤šçº¿ç¨‹ SSRï¼‰ï¼Œéœ€é¿å…äº¤å‰è®¿é—®ã€‚</p>
</li>
<li>
<p><strong>å±æ€§æ‹¼æ¥å®‰å…¨æ€§</strong><br/>
ç”±äº SSR æ‹¼æ¥å­—ç¬¦ä¸²ç›´æ¥è¾“å‡º HTMLï¼Œå¿…é¡»ä¿è¯ <code>tag.exp</code> å®‰å…¨ï¼Œé˜²æ­¢ XSS æ³¨å…¥ã€‚Vue å†…éƒ¨å¯¹è¯¥è¡¨è¾¾å¼æœ‰ AST çº§éªŒè¯ã€‚</p>
</li>
<li>
<p><strong>ä½œç”¨åŸŸ ID æ‹¼æ¥ç»†èŠ‚</strong><br/>
æ³¨æ„ <code>context.pushStringPart(</code> ${scopeId}<code>)</code> å‰çš„ç©ºæ ¼ï¼Œ<br/>
è‹¥çœç•¥ï¼Œå¯èƒ½å¯¼è‡´å±æ€§ç²˜è¿é”™è¯¯ï¼Œå¦‚ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;<span class="hljs-attr">ulclass</span>=<span class="hljs-string">"fade"</span>&gt;  // âŒ é”™è¯¯è¾“å‡º
</code></pre>
</li>
<li>
<p><strong>æ—  tag æƒ…å†µ</strong><br/>
è‹¥å¼€å‘è€…æœªæŒ‡å®š tagï¼ŒVue ä¼šé€€å› fragment æ¨¡å¼ï¼ˆå³ä¸åŒ…è£¹ä»»ä½•æ ‡ç­¾ï¼‰ï¼Œ<br/>
æ­¤æ—¶è°ƒç”¨ <code>processChildren(..., true, true, true)</code>ã€‚</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-14">ä¸ƒã€æ€»ç»“ä¸å¯ç¤º</h2>
<p><code>ssrTransformTransitionGroup</code> æ˜¯ Vue 3 SSR æ¶æ„ä¸­ä¸€ä¸ªå°è€Œç²¾å¦™çš„ç‰‡æ®µã€‚<br/>
å®ƒçš„å®ç°ä½“ç°å‡º Vue å¯¹ç¼–è¯‘é˜¶æ®µä¸è¿è¡Œæ—¶ä¸€è‡´æ€§çš„æé«˜è¦æ±‚ï¼š</p>
<ul>
<li>åˆ©ç”¨ <strong>ä¸¤é˜¶æ®µç¼–è¯‘ç­–ç•¥</strong> è§£å†³åŠ¨æ€ç»“æ„é—®é¢˜ï¼›</li>
<li>åœ¨ <strong>AST Transform å±‚</strong> æå‰æŠ½å–ä¿¡æ¯ï¼Œé¿å…ç”ŸæˆæœŸé‡å¤è¿ç®—ï¼›</li>
<li>é€šè¿‡ <strong>processChildren</strong> çš„å‚æ•°æ§åˆ¶ï¼Œå®Œç¾æ¨¡æ‹Ÿäº†è¿è¡Œæ—¶è¡Œä¸ºã€‚</li>
</ul>
<p>è¿™ç§ç²¾ç»†åŒ–è®¾è®¡è®© Vue çš„ SSR è¾“å‡ºæ—¢é«˜æ•ˆåˆç²¾å‡†ï¼Œä¿è¯äº†å‰åç«¯æ¸²æŸ“ç»“æ„ä¸€è‡´æ€§ã€‚</p>
<hr/>
<p><strong>ç»“å°¾è¯´æ˜ï¼š</strong><br/>
æœ¬æ–‡éƒ¨åˆ†å†…å®¹å€ŸåŠ© AI è¾…åŠ©ç”Ÿæˆï¼Œå¹¶ç”±ä½œè€…æ•´ç†å®¡æ ¸ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[çº¯CSS&JSå®ç°ï¼šä¸æ»‘æ¸å˜è¿‡æ¸¡çš„åŠ¨æ€å¯¼èˆªæ ]]></title>    <link>https://juejin.cn/post/7570243451724726299</link>    <guid>https://juejin.cn/post/7570243451724726299</guid>    <pubDate>2025-11-09T14:48:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570243451724726299" data-draft-id="7570243451724627995" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="çº¯CSS&amp;JSå®ç°ï¼šä¸æ»‘æ¸å˜è¿‡æ¸¡çš„åŠ¨æ€å¯¼èˆªæ "/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-09T14:48:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€è¯ºæ»šé›ªçƒ"/> <meta itemprop="url" content="https://juejin.cn/user/2824015112318094"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            çº¯CSS&amp;JSå®ç°ï¼šä¸æ»‘æ¸å˜è¿‡æ¸¡çš„åŠ¨æ€å¯¼èˆªæ 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2824015112318094/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€è¯ºæ»šé›ªçƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-09T14:48:18.000Z" title="Sun Nov 09 2025 14:48:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œé€šå¸¸å®ç°çš„å¯¼èˆªæ åˆ‡æ¢æ—¶æ²¡æœ‰æ·»åŠ äº¤äº’æ•ˆæœï¼Œä»Šå¤©å°±ä»0åˆ°1å®ç°ä¸€ä¸ªç¾è§‚ä¸”äº¤äº’æµç•…çš„å¯¼èˆªæ ã€‚</p>
<p>ç›´æ¥çœ‹æ•ˆæœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a14905729de471599df7f5cef3f90f4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA6K-65rua6Zuq55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763305123&amp;x-signature=aG9JfTgsywgDAG88p4Gn%2FZcVgB4%3D" alt="tab-ezgif.com-video-to-gif-converter.gif" loading="lazy"/></p>
<h2 data-id="heading-1">1.å¯¼èˆªæ å®ç°æ€è·¯</h2>
<p>å®ç°çš„å¯¼èˆªæ éœ€è¦å…·å¤‡<strong>ä¸æ»‘è¿‡æ¸¡åŠ¨ç”»</strong>ï¼Œåˆ‡æ¢é€‰é¡¹æ—¶ï¼ŒæŒ‡ç¤ºå™¨é€šè¿‡è‡ªå®šä¹‰è´å¡å°”æ›²çº¿ï¼ˆcubic-bezier(0.68, -0.55, 0.265, 1.55)ï¼‰å®ç°çµåŠ¨è¿‡æ¸¡æ•ˆæœã€‚</p>
<h2 data-id="heading-2">2. æ¡ˆä¾‹ä»£ç </h2>
<p>ä¸‹é¢é€éƒ¨åˆ†æ‹†è§£ä»£ç ï¼Œå¸¦ä½ ç†è§£æ¯ä¸ªæ¨¡å—çš„ä½œç”¨ã€‚</p>
<h3 data-id="heading-3">2.1 æ¨¡æ¿ç»“æ„</h3>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"nav-container"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- æ¸å˜æŒ‡ç¤ºå™¨ï¼šæ ¸å¿ƒåŠ¨ç”»å…ƒç´  --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"indicator"</span> <span class="hljs-attr">:style</span>=<span class="hljs-string">"indicatorStyle"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- å¯¼èˆªå®¹å™¨ï¼šåŒ…è£¹æ‰€æœ‰å¯¼èˆªé¡¹ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"nav"</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- å¾ªç¯æ¸²æŸ“å¯¼èˆªé¡¹ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> 
        <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(tab, index) in tabs"</span> 
        <span class="hljs-attr">:key</span>=<span class="hljs-string">"index"</span> 
        <span class="hljs-attr">class</span>=<span class="hljs-string">"nav-item"</span> 
        <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ active: activeTab === index }"</span>
        @<span class="hljs-attr">click</span>=<span class="hljs-string">"changeTab(index)"</span>
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{{ tab.label }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<ul>
<li><strong>å±‚çº§å…³ç³»</strong>ï¼šnav-container ä½œä¸ºæœ€å¤–å±‚å®¹å™¨ï¼Œå†…éƒ¨åŒ…å« indicatorï¼ˆæŒ‡ç¤ºå™¨ï¼‰å’Œ navï¼ˆå¯¼èˆªé¡¹å®¹å™¨ï¼‰ï¼Œé€šè¿‡ z-index æ§åˆ¶å±‚çº§ï¼ˆæŒ‡ç¤ºå™¨ z=0ï¼Œå¯¼èˆªé¡¹ z=2ï¼‰</li>
<li><strong>æ¿€æ´»çŠ¶æ€</strong>ï¼šé€šè¿‡ :class="{ active: activeTab === index }" æ§åˆ¶é€‰ä¸­é¡¹çš„æ–‡å­—é¢œè‰²ï¼ˆç™½è‰²ï¼‰</li>
</ul>
<h3 data-id="heading-4">2.2 é€»è¾‘å¤„ç†</h3>
<p>ä¸»è¦æ§åˆ¶äº¤äº’ä¸åŠ¨ç”»æ•ˆæœã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref, computed } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-comment">// 1. å¯¼èˆªæ•°æ®ï¼šå¯æ ¹æ®éœ€æ±‚æ‰©å±•ï¼ˆå¦‚æ·»åŠ è·¯ç”±åœ°å€ã€å›¾æ ‡ç­‰ï¼‰</span>
<span class="hljs-keyword">const</span> tabs = [
    { <span class="hljs-attr">label</span>: <span class="hljs-string">'é¦–é¡µ'</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">0</span> },
    { <span class="hljs-attr">label</span>: <span class="hljs-string">'åˆ†ç±»'</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">1</span> },
    { <span class="hljs-attr">label</span>: <span class="hljs-string">'è´­ç‰©è½¦'</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">2</span> },
    { <span class="hljs-attr">label</span>: <span class="hljs-string">'æˆ‘çš„'</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">3</span> }
]
<span class="hljs-comment">// 2. é€‰ä¸­é¡¹çŠ¶æ€ï¼šç”¨ ref å®šä¹‰å“åº”å¼å˜é‡</span>
<span class="hljs-keyword">const</span> activeTab = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)
<span class="hljs-comment">// 3. æŒ‡ç¤ºå™¨æ ·å¼è®¡ç®—ï¼šç”¨ computed å®æ—¶æ›´æ–°ä½ç½®å’Œå®½åº¦</span>
<span class="hljs-keyword">const</span> indicatorStyle = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> ({
  <span class="hljs-comment">// å·¦åç§»é‡ï¼šé€‰ä¸­é¡¹ç´¢å¼• * (100% / å¯¼èˆªé¡¹æ•°é‡)</span>
  <span class="hljs-attr">left</span>: <span class="hljs-string">`<span class="hljs-subst">${activeTab.value * (<span class="hljs-number">100</span> / tabs.length)}</span>%`</span>,
  <span class="hljs-comment">// å®½åº¦ï¼šå‡åˆ†å¯¼èˆªæ ï¼ˆ100% / å¯¼èˆªé¡¹æ•°é‡ï¼‰</span>
  <span class="hljs-attr">width</span>: <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-number">100</span> / tabs.length}</span>%`</span>
}))
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-5">2.3 å®ç°è§†è§‰ä¸åŠ¨ç”»</h3>
<p>æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-comment">/* æ¸å˜æŒ‡ç¤ºå™¨ï¼šæ ¸å¿ƒè§†è§‰å…ƒç´  */</span>
<span class="hljs-selector-class">.indicator</span> {
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">45deg</span>, <span class="hljs-number">#4facfe</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#00f2fe</span> <span class="hljs-number">100%</span>); <span class="hljs-comment">/* è“é’æ¸å˜ */</span>
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">35px</span>; <span class="hljs-comment">/* ä¸å®¹å™¨åœ†è§’ä¸€è‡´ï¼šé¿å…æ£±è§’ */</span>
  <span class="hljs-comment">/* è‡ªå®šä¹‰è¿‡æ¸¡æ›²çº¿ï¼šè®©åŠ¨ç”»æ›´çµåŠ¨ï¼ˆéåŒ€é€Ÿï¼‰ */</span>
  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.5s</span> <span class="hljs-built_in">cubic-bezier</span>(<span class="hljs-number">0.68</span>, -<span class="hljs-number">0.55</span>, <span class="hljs-number">0.265</span>, <span class="hljs-number">1.55</span>);
  <span class="hljs-attribute">z-index</span>: <span class="hljs-number">0</span>; <span class="hljs-comment">/* æŒ‡ç¤ºå™¨åœ¨æœ€ä¸‹å±‚ */</span>
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h2 data-id="heading-6">3. å¯¼èˆªæ ä¼˜åŒ–</h2>
<p>åŸºç¡€ç‰ˆæœ¬å·²å®ç°æ ¸å¿ƒåŠŸèƒ½ï¼Œä¸‹é¢åˆ†äº«å‡ ä¸ªå®ç”¨çš„ä¼˜åŒ–æ–¹å‘ï¼Œæ»¡è¶³æ›´å¤šåœºæ™¯éœ€æ±‚ã€‚</p>
<h3 data-id="heading-7">3.1 æ·»åŠ  hover æ•ˆæœï¼šå¢å¼ºäº¤äº’åé¦ˆ</h3>
<p>åœ¨ .nav-item ä¸­æ·»åŠ  hover æ ·å¼ï¼Œè®©æœªé€‰ä¸­é¡¹ä¹Ÿæœ‰äº¤äº’åé¦ˆï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.nav-item</span><span class="hljs-selector-pseudo">:hover</span><span class="hljs-selector-pseudo">:not</span>(<span class="hljs-selector-class">.active</span>) {
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#4facfe</span>; <span class="hljs-comment">/* hover æ—¶æ–‡å­—å˜æµ…è“ */</span>
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.05</span>); <span class="hljs-comment">/* è½»å¾®æ”¾å¤§ï¼šå¢å¼ºæ„ŸçŸ¥ */</span>
}
</code></pre>
<h3 data-id="heading-8">3.2 æ”¯æŒè·¯ç”±è·³è½¬ï¼šé€‚é…å•é¡µåº”ç”¨</h3>
<ol>
<li>å…ˆå¼•å…¥ Vue Routerï¼š</li>
</ol>

<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useRouter } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>
<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">useRouter</span>()
</code></pre>
<p>2.  åœ¨ tabs æ•°ç»„ä¸­æ·»åŠ è·¯ç”±åœ°å€ï¼š</p>

<pre><code class="hljs language-lua" lang="lua">const tabs = [
  { label: <span class="hljs-string">'é¦–é¡µ'</span>, value: <span class="hljs-number">1</span>, <span class="hljs-built_in">path</span>: <span class="hljs-string">'/'</span> },
  { label: <span class="hljs-string">'åˆ†ç±»'</span>, value: <span class="hljs-number">2</span>, <span class="hljs-built_in">path</span>: <span class="hljs-string">'/category'</span> },
  { label: <span class="hljs-string">'è´­ç‰©è½¦'</span>, value: <span class="hljs-number">3</span>, <span class="hljs-built_in">path</span>: <span class="hljs-string">'/cart'</span> },
  { label: <span class="hljs-string">'æˆ‘çš„'</span>, value: <span class="hljs-number">4</span>, <span class="hljs-built_in">path</span>: <span class="hljs-string">'/mine'</span> }
]
</code></pre>
<p>3.  ä¿®æ”¹ changeTab æ–¹æ³•ï¼Œå®ç°è·¯ç”±è·³è½¬ï¼š</p>

<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">changeTab</span> = (index) =&gt; {
  <span class="hljs-attr">activeTab.value</span> = index
  router.push({ path: tabs<span class="hljs-section">[index]</span>.path })
}
</code></pre>
<h3 data-id="heading-9">3.3 è‡ªå®šä¹‰æŒ‡ç¤ºå™¨æ ·å¼</h3>
<p>ä»£ç ä¸­æ³¨é‡Šäº† â€œä¸‹åˆ’çº¿æ ·å¼â€ çš„æŒ‡ç¤ºå™¨ï¼Œè‹¥ä¸éœ€è¦æ¸å˜èƒŒæ™¯ï¼Œå¯æ›¿æ¢ä¸ºï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.indicator</span> {
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">top</span>: auto;
  <span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>; <span class="hljs-comment">/* ä¸‹åˆ’çº¿é åº•éƒ¨ */</span>
  <span class="hljs-attribute">height</span>: auto;
  <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">2px</span> solid <span class="hljs-number">#4facfe</span>; <span class="hljs-comment">/* ä¸‹åˆ’çº¿é¢œè‰² */</span>
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">0</span>; <span class="hljs-comment">/* å–æ¶ˆåœ†è§’ */</span>
  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease; <span class="hljs-comment">/* ç®€åŒ–è¿‡æ¸¡æ›²çº¿ */</span>
}
</code></pre>
<h3 data-id="heading-10">3.4 æ”¯æŒè§¦æ‘¸æ»‘åŠ¨</h3>
<p>è‹¥éœ€è¦åœ¨ç§»åŠ¨ç«¯æ”¯æŒ â€œè§¦æ‘¸æ»‘åŠ¨åˆ‡æ¢â€ï¼Œå¯ç»“åˆ touchstart å’Œ touchend äº‹ä»¶ï¼Œè®¡ç®—æ»‘åŠ¨è·ç¦»æ¥åˆ¤æ–­æ˜¯å¦åˆ‡æ¢å¯¼èˆªé¡¹ï¼Œæ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// è®°å½•è§¦æ‘¸èµ·å§‹ä½ç½®</span>
<span class="hljs-keyword">const</span> startX = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)
<span class="hljs-comment">// è§¦æ‘¸å¼€å§‹</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleTouchStart</span> = (<span class="hljs-params">e</span>) =&gt; {
  startX.<span class="hljs-property">value</span> = e.<span class="hljs-property">touches</span>[<span class="hljs-number">0</span>].<span class="hljs-property">clientX</span>
}
<span class="hljs-comment">// è§¦æ‘¸ç»“æŸ</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleTouchEnd</span> = (<span class="hljs-params">e</span>) =&gt; {
  <span class="hljs-keyword">const</span> endX = e.<span class="hljs-property">changedTouches</span>[<span class="hljs-number">0</span>].<span class="hljs-property">clientX</span>
  <span class="hljs-keyword">const</span> diffX = endX - startX.<span class="hljs-property">value</span>
  
  <span class="hljs-comment">// æ»‘åŠ¨è·ç¦»è¶…è¿‡ 50px æ‰åˆ‡æ¢ï¼ˆé¿å…è¯¯è§¦ï¼‰</span>
  <span class="hljs-keyword">if</span> (diffX &gt; <span class="hljs-number">50</span> &amp;&amp; activeTab.<span class="hljs-property">value</span> &gt; <span class="hljs-number">0</span>) {
    activeTab.<span class="hljs-property">value</span>--
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (diffX &lt; -<span class="hljs-number">50</span> &amp;&amp; activeTab.<span class="hljs-property">value</span> &lt; tabs.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>) {
    activeTab.<span class="hljs-property">value</span>++
  }
}
<span class="hljs-comment">// åœ¨æ¨¡æ¿ä¸­æ·»åŠ è§¦æ‘¸äº‹ä»¶</span>
&lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">"nav"</span> <span class="hljs-meta">@touchstart</span>=<span class="hljs-string">"handleTouchStart"</span> <span class="hljs-meta">@touchend</span>=<span class="hljs-string">"handleTouchEnd"</span>&gt;
  &lt;!-- å¯¼èˆªé¡¹ --&gt;
&lt;/div&gt;
</code></pre>
<h2 data-id="heading-11">4. å®Œæ•´ä»£ç </h2>
<p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼ˆå¯ç›´æ¥å¤åˆ¶ä½¿ç”¨ï¼‰ï¼š</p>
<pre><code class="hljs language-xml" lang="xml">    <span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"nav-container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"indicator"</span> <span class="hljs-attr">:style</span>=<span class="hljs-string">"indicatorStyle"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> 
          <span class="hljs-attr">class</span>=<span class="hljs-string">"nav"</span> 
          @<span class="hljs-attr">touchstart</span>=<span class="hljs-string">"handleTouchStart"</span> 
          @<span class="hljs-attr">touchend</span>=<span class="hljs-string">"handleTouchEnd"</span>
        &gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> 
            <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(tab, index) in tabs"</span> 
            <span class="hljs-attr">:key</span>=<span class="hljs-string">"tab.value"</span>
            <span class="hljs-attr">class</span>=<span class="hljs-string">"nav-item"</span> 
            <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ active: activeTab === index }"</span>
            @<span class="hljs-attr">click</span>=<span class="hljs-string">"changeTab(index)"</span>
          &gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{{ tab.label }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">import</span> { ref, computed } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
    <span class="hljs-keyword">import</span> { useRouter } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>
    <span class="hljs-keyword">const</span> router = <span class="hljs-title function_">useRouter</span>()
    <span class="hljs-comment">// å¯¼èˆªæ•°æ®ï¼ˆæ”¯æŒè·¯ç”±ï¼‰</span>
    <span class="hljs-keyword">const</span> tabs = [
      { <span class="hljs-attr">label</span>: <span class="hljs-string">'é¦–é¡µ'</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span> },
      { <span class="hljs-attr">label</span>: <span class="hljs-string">'åˆ†ç±»'</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/category'</span> },
      { <span class="hljs-attr">label</span>: <span class="hljs-string">'è´­ç‰©è½¦'</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/cart'</span> },
      { <span class="hljs-attr">label</span>: <span class="hljs-string">'æˆ‘çš„'</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/mine'</span> }
    ]
    <span class="hljs-keyword">const</span> activeTab = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)
    <span class="hljs-keyword">const</span> startX = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)
    <span class="hljs-comment">// æŒ‡ç¤ºå™¨æ ·å¼</span>
    <span class="hljs-keyword">const</span> indicatorStyle = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> ({
      <span class="hljs-attr">left</span>: <span class="hljs-string">`<span class="hljs-subst">${activeTab.value * (<span class="hljs-number">100</span> / tabs.length)}</span>%`</span>,
      <span class="hljs-attr">width</span>: <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-number">100</span> / tabs.length}</span>%`</span>
    }))
    <span class="hljs-comment">// åˆ‡æ¢å¯¼èˆªï¼ˆå«è·¯ç”±è·³è½¬ï¼‰</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">changeTab</span> = (<span class="hljs-params">index</span>) =&gt; {
      activeTab.<span class="hljs-property">value</span> = index
      router.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">path</span>: tabs[index].<span class="hljs-property">path</span> })
    }
    <span class="hljs-comment">// è§¦æ‘¸æ»‘åŠ¨é€»è¾‘ï¼ˆç§»åŠ¨ç«¯é€‚é…ï¼‰</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleTouchStart</span> = (<span class="hljs-params">e</span>) =&gt; {
      startX.<span class="hljs-property">value</span> = e.<span class="hljs-property">touches</span>[<span class="hljs-number">0</span>].<span class="hljs-property">clientX</span>
    }
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleTouchEnd</span> = (<span class="hljs-params">e</span>) =&gt; {
      <span class="hljs-keyword">const</span> endX = e.<span class="hljs-property">changedTouches</span>[<span class="hljs-number">0</span>].<span class="hljs-property">clientX</span>
      <span class="hljs-keyword">const</span> diffX = endX - startX.<span class="hljs-property">value</span>
      <span class="hljs-keyword">if</span> (diffX &gt; <span class="hljs-number">50</span> &amp;&amp; activeTab.<span class="hljs-property">value</span> &gt; <span class="hljs-number">0</span>) {
        activeTab.<span class="hljs-property">value</span>--
        router.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">path</span>: tabs[activeTab.<span class="hljs-property">value</span>].<span class="hljs-property">path</span> })
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (diffX &lt; -<span class="hljs-number">50</span> &amp;&amp; activeTab.<span class="hljs-property">value</span> &lt; tabs.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>) {
        activeTab.<span class="hljs-property">value</span>++
        router.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">path</span>: tabs[activeTab.<span class="hljs-property">value</span>].<span class="hljs-property">path</span> })
      }
    }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
    <span class="hljs-selector-class">.nav-container</span> {
      <span class="hljs-attribute">position</span>: relative;
      <span class="hljs-attribute">width</span>: <span class="hljs-number">90%</span>; <span class="hljs-comment">/* ç¼©å°å®½åº¦ï¼Œé¿å…è´´è¾¹ */</span>
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">20px</span> auto; <span class="hljs-comment">/* å±…ä¸­æ˜¾ç¤º */</span>
      <span class="hljs-attribute">height</span>: <span class="hljs-number">44px</span>;
      <span class="hljs-attribute">background</span>: <span class="hljs-number">#fff</span>;
      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">35px</span>;
      <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-number">15px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.08</span>);
      <span class="hljs-attribute">overflow</span>: hidden;
    }
    <span class="hljs-selector-class">.nav</span> {
      <span class="hljs-attribute">position</span>: relative;
      <span class="hljs-attribute">display</span>: flex;
      <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
      <span class="hljs-attribute">z-index</span>: <span class="hljs-number">1</span>;
    }
    <span class="hljs-selector-class">.nav-item</span> {
      <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
      <span class="hljs-attribute">display</span>: flex;
      <span class="hljs-attribute">justify-content</span>: center;
      <span class="hljs-attribute">align-items</span>: center;
      <span class="hljs-attribute">color</span>: <span class="hljs-number">#555</span>;
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
      <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">500</span>;
      <span class="hljs-attribute">cursor</span>: pointer;
      <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;
      <span class="hljs-attribute">z-index</span>: <span class="hljs-number">2</span>;
    }
    <span class="hljs-selector-class">.nav-item</span><span class="hljs-selector-class">.active</span> {
      <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
    }
    <span class="hljs-selector-class">.nav-item</span><span class="hljs-selector-pseudo">:hover</span><span class="hljs-selector-pseudo">:not</span>(<span class="hljs-selector-class">.active</span>) {
      <span class="hljs-attribute">color</span>: <span class="hljs-number">#4facfe</span>;
      <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.05</span>);
    }
    <span class="hljs-selector-class">.indicator</span> {
      <span class="hljs-attribute">position</span>: absolute;
      <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
      <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">45deg</span>, <span class="hljs-number">#ff9a9e</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#fecfef</span> <span class="hljs-number">100%</span>); 
      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">35px</span>;
      <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.5s</span> <span class="hljs-built_in">cubic-bezier</span>(<span class="hljs-number">0.68</span>, -<span class="hljs-number">0.55</span>, <span class="hljs-number">0.265</span>, <span class="hljs-number">1.55</span>);
      <span class="hljs-attribute">z-index</span>: <span class="hljs-number">0</span>;
    }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h2 data-id="heading-12">5. æ€»ç»“</h2>
<p>æœ€åæ€»ç»“ä¸€ä¸‹ï¼šå¯¼èˆªæ å®ç°çš„æ ¸å¿ƒæ€è·¯å°±æ˜¯æ˜¯é€šè¿‡åŠ¨æ€è®¡ç®—æŒ‡ç¤ºå™¨æ ·å¼ï¼Œé…åˆ<strong>transition</strong>å®ç°åŠ¨ç”»æ•ˆæœã€‚</p>
<p>å¦‚æœ‰é”™è¯¯ï¼Œè¯·æŒ‡æ­£O^O!</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç–¯äº†ï¼åŒ11ï¼Œç™¾åº¦æ–‡å¿ƒå¿«ç å¸®æˆ‘çœé’±åˆèµšé’±ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7570651893869969460</link>    <guid>https://juejin.cn/post/7570651893869969460</guid>    <pubDate>2025-11-10T06:23:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570651893869969460" data-draft-id="7570630923709939764" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç–¯äº†ï¼åŒ11ï¼Œç™¾åº¦æ–‡å¿ƒå¿«ç å¸®æˆ‘çœé’±åˆèµšé’±ï¼Ÿ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-11-10T06:23:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ–‡å¿ƒå¿«ç BaiduComate"/> <meta itemprop="url" content="https://juejin.cn/user/992209294070809"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç–¯äº†ï¼åŒ11ï¼Œç™¾åº¦æ–‡å¿ƒå¿«ç å¸®æˆ‘çœé’±åˆèµšé’±ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/992209294070809/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ–‡å¿ƒå¿«ç BaiduComate
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T06:23:23.000Z" title="Mon Nov 10 2025 06:23:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åŒ11ï¼Œä¸€åœºèµ›åšæ¸¡åŠ«ã€‚</p>
<p><strong>ğŸ’¼ä¸Šç­ï¼š</strong></p>
<p>çº¯ç‰›é©¬æŒ£çªå›Šè´¹</p>
<p>åŠå¤œå‡Œæ™¨2ç‚¹æ¥åˆ°äº§å“éœ€æ±‚ï¼Œç¬¬äºŒå¤©äº§å“å°±è¦ä¸Šçº¿ğŸ¤¯</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e70e7d4b1ece4e86b9a32d301586524b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=LBoVfp1rY4CmIgmcgPsjXOLfpqc%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>ğŸ›ï¸ä¸‹ç­ï¼š</strong></p>
<p>åŒ–èº«èŠ±å‘—æ•°å­¦å®¶</p>
<p>æ¯å¤©åœ¨ã€Œä¸ä¹°è¡€äºã€å’Œã€Œä¹°äº†å–é£ã€ä¹‹é—´åå¤æ¨ªè·³ğŸŒš</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/60dd53c38504474f932048cc90b6a2e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=ip7ovYV98HGPh6E0geEeEWjcQ0k%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>æˆ‘æ‚Ÿäº†</p>
<p>åŸæ¥æˆ‘çš„è´¦æˆ·åªæ˜¯ä¸ªå·¥èµ„ä¸­è½¬ç«™</p>
<p>ç”Ÿæ´»æ¯ç‡¥æ— å‘³ï¼Œèµ„æœ¬å®¶æˆå¼„äººç±»ğŸ¤¡</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c98f6f7366c4e9f8929e8da0b99512f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=oS%2BkKwfyUJnFx3Gc%2BaAiAdcf0QQ%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>ä½†ï¼æ‰“å·¥äººæ°¸ä¸ä¸ºå¥´ï¼</p>
<p>æ—¢ç„¶ç”Ÿæ´»ç»™æˆ‘å…³ä¸Šäº†ä¸€æ‰‡çª—ï¼Œæˆ‘å°±ç”¨Comateèµ°åé—¨ğŸ˜‰</p>
<p>è¿™ä¸ªåŒ11</p>
<p>æˆ‘å†³å®šç”¨ç™¾åº¦æ–‡å¿ƒå¿«ç Comate</p>
<p>æ•´ä¸¤ä¸ª**ã€ŒåŒ11ç‰¹ä¾›ã€ğŸ’â™€ï¸**</p>
<p><strong>1ï¸âƒ£ ã€Œé˜²å‰æ‰‹ç®¡å®¶ã€</strong></p>
<p><strong>Subagentå¤šæ™ºèƒ½ä½“åä½œ</strong>æå®šå‰åç«¯åˆ†ç¦»å¼€å‘</p>
<p>ä¸“æ²»â€œæ‰‹ä¸å¬è„‘ï¼Œè„‘ä¸ä¿¡ä½™é¢â€çš„èµ›åšæ¸…é†’å‰‚ğŸ’¸</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa227935855045ffa4b821b7e4d5fc0a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=bU2qIVvo09usTgTkeLQPipYs47c%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>2ï¸âƒ£ ã€Œå®˜ç½‘é€Ÿæˆå™¨ã€</strong></p>
<p><strong>è‡ªå®šä¹‰Agent</strong>åˆ›å»ºè‡ªå·±çš„AIå‘˜å·¥</p>
<p>è®©è€æ¿é—­å˜´æƒŠè‰³ã€æ‰“å·¥äººå‡†æ—¶ä¸‹ç­çš„é­”æ³•ç”Ÿæˆå™¨âš¡</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fdeb86f13b4a44a5b1830116c26b3ffa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=Y95EIQZAwk24lw1o0AO9U5pJ6GQ%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>æ¥å§ï¼Œæ˜¯æ—¶å€™è¡¨æ¼”çœŸæ­£çš„æŠ€æœ¯äº†ï¼</p>
<h2 data-id="heading-0">To ç®¡ä¸ä½æ‰‹çš„æ¶ˆè´¹è€…ï¼šComateåŠ©ä½ æ­å»ºã€Œé˜²å‰æ‰‹ç®¡å®¶ã€</h2>
<p>ğŸ›’ æ ¸å¿ƒåŠŸèƒ½</p>
<ul>
<li><strong>å•†å“æ¸…å•ç®¡ç†</strong>ï¼šæ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤è´­ç‰©å•†å“ï¼›æ ‡è®°å·²è´­/å¾…è´­çŠ¶æ€</li>
<li><strong>é˜²æ­¢è¿‡åº¦æ¶ˆè´¹</strong>ï¼šæŒ‰ç…§ç”¨æˆ·é¢„ç®—ã€è´­ä¹°ä¼˜å…ˆçº§è¾…åŠ©è´­ç‰©å†³ç­–</li>
<li><strong>æŠ¢è´­é€€è´§æé†’</strong>ï¼šæŠ¢è´­ã€é€€è´§æˆªæ­¢æ—¥æœŸï¼Œç³»ç»Ÿä¼šæå‰æé†’ç”¨æˆ·</li>
</ul>
<p>ğŸŒŸæŠ€æœ¯ç‰¹è‰²</p>
<ul>
<li>å…¨æ ˆæ¶æ„ï¼šFirebaseåç«¯ + React Nativeå‰ç«¯</li>
<li>è·¨ç«¯æ”¯æŒï¼šæ”¯æŒå¤šè®¾å¤‡è®¿é—®</li>
<li>å®æ—¶åŒæ­¥ï¼šå‰åç«¯æ•°æ®å®æ—¶äº¤äº’</li>
<li>æ•°æ®å­˜å‚¨ï¼šå†…ç½®H2æ•°æ®åº“è‡ªåŠ¨ä¿å­˜</li>
</ul>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬å›åˆ°æ¡ˆå‘ç°åœºï¼Œçœ‹çœ‹å½“æ—¶AIæ˜¯æ€æ ·å¼•é¢†æˆ‘è¿™ä¸ªæŠ€æœ¯å°ç™½çš„â€”â€”</p>
<h3 data-id="heading-1">Step1 æå‡ºéœ€æ±‚</h3>
<p>æœ€å¼€å§‹ï¼Œæˆ‘åªæ˜¯ç”¨<strong>å¤§ç™½è¯</strong>å†™ä¸‹äº†æˆ‘çš„éœ€æ±‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a0236827a94b4beebf75468c4ff9864a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=VEHPYhR4Lx68fwmuuKFc7ztJ%2FCQ%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>âœ¨è¿™é‡Œæœ‰ä¸€ä¸ªå°å¿ƒæœºï¼š</p>
<p>è®©Comateç›´æ¥è”ç½‘æœç´¢githubç­‰å¼€å‘è€…ç¤¾åŒºï¼Œä»å¤ç°åšèµ·ï¼Œåç»­å†å¾®è°ƒï¼Œäº²æµ‹æ¯”ç›´æ¥è¾“å…¥éœ€æ±‚ææ•ˆ200%ã€‚</p>
<p>å½“æˆ‘æŠŠè¿™ä¸ªä»»åŠ¡äº¤ç»™ Zulu æ™ºèƒ½ä½“åï¼Œå®ƒä¸ä»…â€œå¬æ‡‚äº†â€ï¼Œè¿˜åƒä¸€ä¸ªèµ„æ·±æ¶æ„å¸ˆä¸€æ ·ï¼Œ<strong>ä¸»åŠ¨å¸®æˆ‘è§„åˆ’äº†åŒ…å«SpringBooå’ŒVueçš„å®Œæ•´æŠ€æœ¯æ ˆ</strong> ğŸ‘‡</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7705d698f4e3402db2b224a07e0906a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=lA23jIP782Z46COsfgUkuVvUoxU%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>ä¸‹ä¸€ç§’ï¼Œç»ˆç«¯çª—å£å°±è¢«æ¿€æ´»äº† ï¼Œç‚¹å‡»â€œæ‰§è¡Œâ€æŒ‰é’®ï¼ŒZulu å°±èƒ½<strong>è‡ªåŠ¨å®‰è£…ä¾èµ–ã€ç€æ‰‹å¼€å‘ç¨‹åº</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fdcfcf1f95544a92940e609220450ef7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=k3oafdZe9ubXNuuAGKkr2RJiCuI%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<h3 data-id="heading-2">Step2 å±ä¸Šé›•èŠ±ï¼Œå¾ªå¾ªå–„è¯±ï¼ŒåšZuluæœ€æ…ˆç¥¥çš„çˆ¶äº²</h3>
<p>ä¸€é¡¿æ“ä½œåï¼ŒZuluç»™äº†æˆ‘ä¸€ä¸ªæœ€åˆå§‹çš„ç‰ˆæœ¬</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee6e412a41f049eb9bee97ac9f44d4b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=J%2FrhXdDCl1Ddasjll2oKpcTqJ2Q%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>æœ‰ç‚¹ä¸‘ï¼Œä½†æ˜¯æ²¡å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§Zuluç»™å‡ºçš„<strong>ä¸‹ä¸€æ­¥å¼•å¯¼</strong>ï¼Œç»§ç»­å®Œå–„è¿™ä¸ªç½‘é¡µçš„å…¶ä»–åŠŸèƒ½</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/23154b86cff34540ae096683ad03c462~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=WMPJoQ40s38maUhhK5Mhyyt9dQ8%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>ä¸‹ä¸€ç§’ï¼Œç»ˆç«¯çª—å£å°±è¢«æ¿€æ´»äº† ï¼Œç‚¹å‡»â€œæ‰§è¡Œâ€æŒ‰é’®ï¼ŒZulu å°±èƒ½<strong>è‡ªåŠ¨å®‰è£…ä¾èµ–ã€ç€æ‰‹å¼€å‘ç¨‹åº</strong>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a0f106966584c5f8f6f204f37423983~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=0eqLWpJ2PkQeZ0dbSol7Zh0COJQ%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<h3 data-id="heading-3">Step3 è¿‡ç¨‹ä¸­ï¼Œå…ä¸äº†ä¼šdebugï¼Œä¿æŒå§¿æ€ä¼˜é›…</h3>
<p>æ¥ä¸‹æ¥ï¼Œå°±æ˜¯ä¸æ–­debugçš„è¿‡ç¨‹</p>
<p>æ‹’ç»äº²è‡ªåŠ¨æ‰‹ï¼Insteadï¼Œä½ å¯ä»¥è¯•è¯•ä»¥ä¸‹å‡ ç§ä¼˜é›…çš„debugå§¿åŠ¿ï¼š</p>
<p>1ï¸âƒ£æŠŠå‡ºé”™çš„ç½‘é¡µ<strong>æˆªå±</strong>ç»™Zulu</p>
<p>2ï¸âƒ£<strong>command + Y</strong>ï¼ŒæŠŠç»ˆç«¯ä¿¡æ¯ç›´æ¥æ·»åŠ åˆ°Zuluçš„ä¸Šä¸‹æ–‡</p>
<p>3ï¸âƒ£å¦‚æœæƒ³æ›´ä¸æ»‘ä¸€ç‚¹ï¼Œå¯ä»¥å‹¾é€‰â€œ<strong>è‡ªåŠ¨æ‰§è¡Œ</strong>â€ï¼Œè®©Zuluå®ç°æµ‹è¯•-debugçš„é—­ç¯ï½</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/93843c8eac29401c9afe47f9df2f3b8b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=%2FFqm7lTgjGbe1ieqsplvVTrdUHc%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/32d85c33f0d647a692c65f57b8e0a68f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=wMcWrw0pYs3KqsvSbsD4zFWmd5Q%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/400e66cc28344fe6b2ee8f59d18d3304~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=A4qtb2qnFE3wihjIzzR8rNXWQNE%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<h3 data-id="heading-4">æœ€åï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¬£èµä¸€ä¸‹æˆå“ï¼š</h3>
<p>æˆå“è§†é¢‘ğŸ‘‰<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FJtWbZEDBx5eukG53KjFFYw" target="_blank" title="https://mp.weixin.qq.com/s/JtWbZEDBx5eukG53KjFFYw" ref="nofollow noopener noreferrer">mp.weixin.qq.com/s/JtWbZEDBxâ€¦</a></p>
<h2 data-id="heading-5">To æ‰å¤´å‘çš„æ‰“å·¥äººï¼šComateä¸ºä½ â€œç§’å»ºâ€åŒ11å®˜ç½‘</h2>
<p>ğŸ’» <strong>åŒ11å®˜ç½‘æ ¸å¿ƒåŠŸèƒ½</strong></p>
<ul>
<li>å‰å°å•†åŸç®¡ç†ç³»ç»Ÿ-å•†å“å±•ç¤ºã€è´­ç‰©è½¦ã€ç”¨æˆ·è®¤è¯</li>
<li>åå°ç®¡ç†ç³»ç»Ÿ-å•†å“ç®¡ç†ã€è®¢å•ç®¡ç†ã€ç”¨æˆ·ç®¡ç†</li>
<li>æ”¯ä»˜ç»“ç®—ç³»ç»Ÿ-å®Œæ•´çš„è®¢å•æµç¨‹å’Œæ”¯ä»˜é›†æˆ</li>
<li>ç”¨æˆ·è®¤è¯ç³»ç»Ÿ-æ³¨å†Œã€ç™»å½•ã€æƒé™ç®¡ç†</li>
</ul>
<p>ğŸŒŸ <strong>æŠ€æœ¯ç‰¹è‰²</strong></p>
<ul>
<li>âš¡ï¸ <strong>å‰ç«¯</strong>: åŸç”ŸJavaScript + CSS3 + HTML5</li>
<li>ğŸš€ <strong>å­˜å‚¨</strong>: localStorageæ•°æ®æŒä¹…åŒ–</li>
<li>ğŸ¨ <strong>æ ·å¼</strong>: è‡ªå®šä¹‰CSSå˜é‡ä¸»é¢˜ç³»ç»Ÿ</li>
<li><strong>ğŸ«‚ äº¤äº’</strong>: äº‹ä»¶å§”æ‰˜å’ŒDOMæ“ä½œ</li>
</ul>
<p>åŠå¤œä¸¤ç‚¹ï¼Œæ¥åˆ°è€æ¿ç”µè¯â˜ï¸ï¼š â€œå®˜ç½‘æˆ‘æ˜å¤©å°±è¦ï¼è¦æœç´¢ï¼è¦è´­ç‰©è½¦ï¼è¦æŠ½å¥–ï¼â€</p>
<p>ğŸ‘¶ æˆ‘ï¼ŒèŒåœºè€å¥½äººï¼ŒåŠå¤œæ¥åˆ°è¯‰æ±‚ï¼Œç­”åº”åå¼€å§‹åæ‚”ã€‚</p>
<p>ğŸ¤– Comateï¼šâ€œæ²¡äº‹ï¼Œæˆ‘æ¥ã€‚æ­£åœ¨å¯åŠ¨å¤šAgentååŒ...@å‰ç«¯Agent å¼€å§‹æ„å»ºé¡µé¢ï¼Œ@åç«¯Agent æ­£åœ¨ç¼–å†™è´­ç‰©è½¦é€»è¾‘...â€</p>
<p>è¿™æ¬¡ï¼Œæˆ‘ç‰›é©¬ç¿»èº«cosèµ„æœ¬å®¶ï¼Œç”¨Comateçš„Agentæ¨¡å¼å»ºç«‹è‡ªå·±çš„AIé»‘å¥´ï¼Œ7x24å°æ—¶åœ¨çº¿ä¸ºæˆ‘æ‰“å·¥ğŸ‘‡ã€åŒ…å·¥å¤´æ˜¯æ€æ ·äº‘ç›‘å·¥çš„ï¼Ÿã€‘ğŸ‘‡</p>
<h3 data-id="heading-6">Step1 å»ºç«‹ä¸€ä¸ªæ™ºèƒ½ä½“å¸®æˆ‘æ‰“å·¥</h3>
<p>ç‚¹å‡» <strong>+ Agent</strong>ï¼Œå†™å‡ºä½ ä½¿ç”¨å®ƒçš„åœºæ™¯ä»¥åŠå…·ä½“çš„æŒ‡ä»¤ï¼Œå†æŠŠèƒ½å‹¾çš„å·¥å…·éƒ½å‹¾ä¸Šï¼ŒæŠŠèƒ½ä¸‹è½½çš„MCPéƒ½ä¸‹ä¸Š</p>
<p>ç‚¹å‡»åˆ›å»ºï¼Œå°±å¯ä»¥ç‚¹å‡»å·¦ä¸‹è§’çš„Zuluè¿›è¡Œåˆ‡æ¢ä½ çš„ä¸“å±å‘˜å·¥äº†ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5eb4d143e21d4ef9b3603b2b3f31421b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=V34fk%2F9inKFDWdjwMHSsoqLpIN8%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c451a658caf44e6fa52360a4cc289a17~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=HVWB%2FRwxMjN6K3UrBoo%2BoBwHy%2BY%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>MCPä¸‹è½½æ–¹å¼</strong>ï¼š</p>
<p>ç‚¹å‡»å³ä¸Šè§’ğŸ”¨ï¼Œä¸ä¼šé…ç½®ç¯å¢ƒå¯éšæ—¶æˆªå›¾è¯¢é—®Zuluï¼Œä¸€æ­¥åˆ°èƒƒ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e9d8621113e42829c90b83d3d3ca33e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=u1fGOwATGGk4MO%2FhTw%2BWUUYF0KE%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9fc2ad0ae9f44f06908ab42f81dcc58c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=IFmH3QxA6YgYYOJo2Lloy4DKe4E%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<h3 data-id="heading-7">Step2 æå‡ºéœ€æ±‚</h3>
<p>æ¥ç€ï¼Œå†™å‡ºä½ æƒ³è¦æ­å»ºçš„ç½‘ç«™ï¼Œä»¥åŠç½‘ç«™å¤§è‡´çš„æ¶æ„ï½</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/16e7d89a7ff244cc88697b3853c77bb9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=e8WgDwE0Cd1JD%2BrYgpGb0cqDDnc%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>âœ¨ä¸æƒ³å¤ªéº»çƒ¦çš„è¯ï¼Œå¯ä»¥åƒæˆ‘è¿™æ ·ï¼Œå¼•å¯¼Zuluè”ç½‘æœç´¢ç›¸ä¼¼çš„ç½‘ç«™ï¼Œç›´æ¥æ¨¡ä»¿ä»–ä»¬çš„åŠŸèƒ½å³å¯ï¼</p>
<p>ä½ è¿˜å¯ä»¥æŠŠä½ çš„äº§å“å›¾ã€ç½‘é¡µèƒŒæ™¯åœ°å€ç»™åˆ°AIï¼Œä»–ä¼šè‡ªåŠ¨å¸®ä½ â€œå®‰æ’â€è¿›ç½‘é¡µ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b23b8a03b1e64089a48a8578dcd7b92d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=IYUfx4oJvPCuu3XJpRi39tLkZ8A%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>ğŸ‘‡æœ€ç»ˆæ•ˆæœçœŸçš„æƒŠè‰³åˆ°æˆ‘äº†</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6516d4e2b954501a477768fc882a0f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763360603&amp;x-signature=GGOxdFMNLYVxwyGYcx4icfOqseU%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>ğŸš€ è¿›é˜¶ç©æ³•ï¼šä»â€œç…§æŠ„â€åˆ°â€œè¶…æŠ„â€ï¼Œè®©ä½ çš„è„‘æ´é‡è›®ç”Ÿé•¿ï¼</strong></p>
<p>å«Œå¼ƒâ€œé˜²å‰æ‰‹ç®¡å®¶â€åªèƒ½æé†’é¢„ç®—ï¼Ÿâ€œå®˜ç½‘é€Ÿæˆå™¨â€åªèƒ½æ‘†æ‘†å•†å“ï¼Ÿ</p>
<p>æ ¼å±€æ‰“å¼€ï¼<strong>åŸºäºä¸Šé¢çš„å®æˆ˜ï¼Œä½ å®Œå…¨å¯ä»¥ç©å¾—æ›´é‡ï¼š</strong></p>
<ul>
<li>æ¯”å¦‚ï¼Œç»™â€œé˜²å‰æ‰‹ç®¡å®¶â€<strong>åŠ ä¸Šè¯­éŸ³æ€’å¼</strong>ï¼šâ€œå¿«ä½æ‰‹ï¼è¿™ä¸ªæœˆåƒé¥­é’±éƒ½æ²¡äº†ï¼â€</li>
<li>æˆ–è€…ï¼Œè®©â€œå®˜ç½‘è½¬ç›˜â€<strong>ç»‘å®šåœ°ç†ä½ç½®</strong>ï¼Œé™„è¿‘ç”¨æˆ·æŠ½å¥–æ¦‚ç‡ç¿»å€ï¼Œçº¿ä¸‹å¼•æµæ‹‰æ»¡ã€‚</li>
<li>å†æ¯”å¦‚ï¼Œ<strong>æ¥å…¥å®æ—¶ä»·æ ¼æ›²çº¿</strong>ï¼Œè®©å®˜ç½‘è‡ªåŠ¨æç¤ºâ€œæ­¤å•†å“30å¤©æœ€ä½ä»·â€ï¼Œè½¬åŒ–ç‡é£™å‡ã€‚</li>
</ul>
<p><strong>AIç¼–ç¨‹çš„é­…åŠ›å°±åœ¨äºï¼šä½ çš„æ¯ä¸ªâ€œè¦æ˜¯èƒ½â€¦â€¦å°±å¥½äº†â€ï¼Œéƒ½èƒ½è¢«å†™æˆä»£ç ï¼Œè¿è¡Œåœ¨çœŸå®çš„ç”Ÿæ´»å’Œç”Ÿæ„é‡Œã€‚</strong></p>
<p><strong>ğŸ‘‡ åˆ«å…‰å¿ƒåŠ¨ï¼Œç°åœ¨å°±ä¸Šæ‰‹å¼€é€ ï¼</strong></p>
<p>ä¸€é”®ä¸‹è½½ Comateï¼ŒæŠŠä½ çš„è„‘æ´å˜æˆç°å®ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fcomate.baidu.com%2Fzh%2Fdownload%25EF%25BB%25BF" target="_blank" title="https://comate.baidu.com/zh/download%EF%BB%BF" ref="nofollow noopener noreferrer">comate.baidu.com/zh/downloadâ€¦</a></p>
<ul>
<li>æ–¹å¼ä¸€ï¼šç›´æ¥ä¸‹è½½Comate AI IDEï¼Œäº«å—ä¸æ»‘å¼€å‘è¿‡ç¨‹</li>
<li>æ–¹å¼äºŒï¼šåœ¨ VS Code æˆ– Jetbrains IDE ä¸­æœç´¢â€œæ–‡å¿ƒå¿«ç â€æ’ä»¶ï¼Œå®‰è£…å³ç”¨</li>
</ul>
<p><strong>ç¼–ç¨‹ä»æœªå¦‚æ­¤ç®€å•ï¼Œä½ çš„æƒ³æ³•ï¼Œæ‰æ˜¯æœ€å…³é”®çš„é‚£è¡Œä»£ç ã€‚</strong></p>
<p><strong>ã€æŠ•ç¥¨ã€‘å¦‚æœ Comate å…è´¹ç»™ä½ ç”¨ï¼Œä½ æœ€æƒ³â€œé€ â€ç‚¹å•¥ï¼Ÿ</strong></p>
<p>A. é€ ä¸ªâ€œé˜²å‰æ‰‹â€APPï¼Œç®¡ä½è‡ªå·±</p>
<p>B. é€ ä¸ªâ€œå®˜ç½‘/å°ç¨‹åºâ€ï¼Œå¸®æœ‹å‹ï¼ˆæˆ–æå‰¯ä¸šï¼‰</p>
<p>C. é€ ä¸ªâ€œAIåŠ©ç†â€ï¼Œå¸®æˆ‘è‡ªåŠ¨å†™å‘¨æŠ¥/PPT</p>
<p>D. è„‘æ´å¤ªå¤§ï¼Œè¯„è®ºåŒºè§ï¼</p>
<p>ğŸ”¥ã€æŠ•ç¨¿é€šé“å¼€å¯ï¼ã€‘</p>
<p>å¦‚æœä½ å·²ç»ç”¨ Comate æ•´è¿‡å¥½æ´»å„¿ã€å†™è¿‡ç¥å™¨â€”â€”åˆ«è—ç€ï¼æˆ‘ä»¬è¯šå¾â€œComate é‡ç”Ÿç”¨æ³•â€å®æˆ˜å¿ƒå¾—ï¼</p>
<p>æ–¹å¼ï¼šåå°ç§ä¿¡ï¼Œç•™ä¸‹ä½ çš„ç‚¹å­ï¼æˆ‘ä»¬çš„å·¥ä½œäººå‘˜å°†éšæ—¶ç‡¥å€™ï¼</p>
<p>ğŸ‘‰ ä¸€ç»é‡‡çº³ï¼Œé€ä½  Comate ä¸ªäººä¸“ä¸šç‰ˆæœˆå¡ + å®˜æ–¹å‘¨è¾¹å¤§ç¤¼åŒ…ï¼</p>
<p>ğŸ‘‰ ç©æ³•è¶Šéªšã€åœºæ™¯è¶ŠçœŸå®ï¼Œè¶Šå®¹æ˜“å…¥é€‰ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ ä¸€ä¸ªå´å°‘ä¿©ï¼šAntd Tag å¤šèŠ‚ç‚¹åŒæ—¶æ¶ˆå¤±]]></title>    <link>https://juejin.cn/post/7570268773333073947</link>    <guid>https://juejin.cn/post/7570268773333073947</guid>    <pubDate>2025-11-09T15:48:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570268773333073947" data-draft-id="7569976345931022387" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ ä¸€ä¸ªå´å°‘ä¿©ï¼šAntd Tag å¤šèŠ‚ç‚¹åŒæ—¶æ¶ˆå¤±"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•,React.js"/> <meta itemprop="datePublished" content="2025-11-09T15:48:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¡ºå‡¡"/> <meta itemprop="url" content="https://juejin.cn/user/2788017221153015"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ ä¸€ä¸ªå´å°‘ä¿©ï¼šAntd Tag å¤šèŠ‚ç‚¹åŒæ—¶æ¶ˆå¤±
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2788017221153015/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¡ºå‡¡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-09T15:48:05.000Z" title="Sun Nov 09 2025 15:48:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    18
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">éœ€æ±‚</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6998ad4d6b1f4301a10a1ef8c1705998~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aG65Yeh:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763313379&amp;x-signature=m6U84spwVZGvBVeXWyNOi0IU610%3D" alt="image.png" loading="lazy"/></p>
<p>ä¸€ä¸ªè¡¨å•çš„å°éœ€æ±‚ï¼Œèƒ½å¡«å†™å¤šä¸ªç¦åˆ©ï¼Œæœ€å¤šåä¸ªï¼Œç¦åˆ©åç§°å…è®¸é‡å¤ï¼Œå’Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fant.design%2Fcomponents%2Ftag-cn%23tag-demo-control" target="_blank" title="https://ant.design/components/tag-cn#tag-demo-control" ref="nofollow noopener noreferrer">å®˜æ–¹çš„åŠ¨æ€æ·»åŠ å’Œåˆ é™¤ç¤ºä¾‹</a>äº¤äº’ä¸€æ¨¡ä¸€æ ·ï¼Œåªæ˜¯å®˜æ–¹ç¤ºä¾‹ä¸æ”¯æŒ tag å†…å®¹é‡å¤ï¼Œä½¿ç”¨çš„ tag å†…å®¹ä½œä¸º key</p>
<p>æˆ‘å¤åˆ¶ä¸¢ç»™ AIï¼Œä¸‹æ‰å»é‡ï¼Œé™åˆ¶ä¸ªæ•°ï¼Œå¥½ï¼æ»¡è¶³éœ€æ±‚äº†ï¼Œkey å€¼æ€ä¹ˆåŠä¸èƒ½ç”¨é‡å¤çš„ï¼Œæ‹¼ä¸ªç´¢å¼•å§ï¼Œæœ€åä¸»è¦ä»£ç å¦‚ä¸‹ï¼Œ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9833951839b84b30be341ee723feb636~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aG65Yeh:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763313379&amp;x-signature=nl9RbkcEdy2iAZ3yco9Se%2F89494%3D" alt="image.png" loading="lazy"/></p>
<p>åé—®ä¸€ä¸‹ï¼šä½ è§‰å¾—è¿™ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œèƒ½è¾¾åˆ°åˆ ä¸€ä¸ªå°‘ä¿©çš„æ•ˆæœå—ğŸ¤”ï¼Ÿï¼Ÿï¼Ÿ</p>
<h2 data-id="heading-1">é—®é¢˜</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/131fd1a6ec6f4b618a4e420ebbd753f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aG65Yeh:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763313379&amp;x-signature=Egx6%2FjBl7NB0yMQSlcBq5YEdKf0%3D" alt="image.png" loading="lazy"/></p>
<p>å¤§å®¶åº”è¯¥éƒ½çŸ¥é“ç”¨ index ä½œä¸º keyï¼Œä¼šæœ‰ä¸€äº›é—®é¢˜ï¼Œå¯¹äºæˆ‘è¿™ä¸ªéœ€æ±‚çš„å½±å“æ˜¯ï¼Œç‚¹å‡»ç¬¬ä¸€ä¸ªç¦åˆ©åˆ é™¤æ“ä½œï¼Œå®é™…ç§»é™¤çš„æ˜¯æœ€åä¸€ä¸ªç¦åˆ©çš„èŠ‚ç‚¹ï¼Œæˆ‘è§‰å¾—åœ¨è¿™ä¸ªéœ€æ±‚æ˜¯å¯ä»¥æ¥å—çš„ï¼Œåœ¨æ²¡æœ‰åŠ¨ç”»å‰æä¸‹ä¹Ÿä½“æ„Ÿä¸åˆ°ï¼Œæ‰€ä»¥æˆ‘å¹¶æ²¡æœ‰æ”¹è¿™ä¸ªä»£ç ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6d60254120f4454b937cf40f4bb563d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aG65Yeh:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763313379&amp;x-signature=476w1McOeeijsDAkhzC2Kpsj79s%3D" alt="image.png" loading="lazy"/></p>
<p>ä½†æ˜¯å®é™…æµ‹è¯•çš„æ•ˆæœçš„æ˜¯ï¼Œ<strong>æœ€åä¸€ä¸ªç¦åˆ©çš„èŠ‚ç‚¹æ²¡äº†ï¼Œç¬¬ä¸€ä¸ªç¦åˆ©èŠ‚ç‚¹ä¹Ÿæ²¡äº†</strong>ï¼Œæˆ‘ï¼ï¼ï¼</p>
<p>è¿™å•¥æƒ…å†µï¼Œè¿™ä¸å¯¹å‘€ï¼Œæ ¹æ® <a href="https://juejin.cn/post/7118580620195790855" target="_blank" title="https://juejin.cn/post/7118580620195790855">React Diff ç®—æ³•çš„åŸç†</a>å§å•¦å§å•¦...ä»–ä¸åº”è¯¥æ˜¯è¿™æ ·ç„¶å...ä»–å’‹èƒ½...</p>
<h2 data-id="heading-2">åŸå› </h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ffa835de756e41da95b1161fbdb2a7d6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aG65Yeh:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763313379&amp;x-signature=NEaPMEFsiF2Y9HwJjeqyOt8m6EA%3D" alt="image.png" loading="lazy"/></p>
<p>å¼€å§‹ debugï¼Œæ‰“å¼€æ§åˆ¶å° command + shif + pï¼Œæœç´¢å¹¶è¿›å…¥ react-dom.development.js æ–‡ä»¶ï¼Œæœç´¢ reconcileChildrenArray æ–¹æ³•ï¼Œæ‰“ä¸Šæ–­ç‚¹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a22f03b2a294467a543c381fd6c6bae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aG65Yeh:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763313379&amp;x-signature=T5G75yPtl7yzeapdVNXK%2BxSI7bg%3D" alt="image.png" loading="lazy"/></p>
<p>React Diff çš„å¤„ç†ä¹Ÿæ²¡é—®é¢˜å‘€ï¼Œè¢«æ ‡è®°åˆ é™¤çš„æ˜¯æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿè¢«æ­£ç¡®å¤ç”¨äº†ï¼Œä»€ä¹ˆæƒ…å†µï¼Ÿéš¾é“åé¢çš„ä»£ç å‡ºäº†é—®é¢˜ï¼Œæˆ‘å°±è®²æ–­ç‚¹å°±æ”¾åˆ°äº† commitRoot æ–¹æ³•ï¼Œå…ˆçœ‹äº† root.finishedWork å‘ç°ä¹Ÿæ˜¯æ­£ç¡®çš„ï¼Œåé¢ç»§ç»­æ‰§è¡Œäº†å‡ ä¸‹ï¼Œæƒ³æ‰¾å‡ºé—®é¢˜å‡ºåœ¨å“ª...å°±çªç„¶è§‰çš„è¿™ä¸ªç¦åˆ©èŠ‚ç‚¹æ˜¯ä¸æ˜¯çœŸæ²¡è¢«åˆ é™¤ï¼Œä½†æ˜¯è¢«éšè—æ‰äº†ï¼Œæˆ‘å°±åˆ‡æ¢åˆ°äº†å…ƒç´ æ§åˆ¶å°ï¼Œè¿˜çœŸæ˜¯æˆ‘å»ï¼ï¼ï¼è¿™ä¸ºå•¥å¤šäº†ä¸ª ant-tag-hidden çš„ç±»</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e0192406f8f4ae0afcf9ca4466e2afd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aG65Yeh:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763313379&amp;x-signature=nw5QF0xSX%2FAu%2F5iAqW0%2BldoaUiM%3D" alt="image.png" loading="lazy"/></p>
<p>çœ‹äº†ä¸‹ Antd Tag ä»£ç ï¼Œè¿˜çœŸæœ‰è¿™ä¸ªè®¾è®¡ï¼Œç»™è¢«ç§»é™¤é¡¹åŠ  ant-tag-hiddenï¼ŒåŠ ä¸Šç´¢å¼• key å¤ç”¨å¯¼è‡´å‡ºç°â€œå¤šèŠ‚ç‚¹åŒæ—¶æ¶ˆå¤±â€</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8242539c45204d48923b6dd973956038~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aG65Yeh:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763313379&amp;x-signature=4FUzT0ZnHzgjb5Da1Yrdl2i7Vg0%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue SSR æºç è§£æï¼šssrTransformModel æ·±åº¦å‰–æ]]></title>    <link>https://juejin.cn/post/7569909335909269513</link>    <guid>https://juejin.cn/post/7569909335909269513</guid>    <pubDate>2025-11-09T00:09:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7569909335909269513" data-draft-id="7569976345929842739" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue SSR æºç è§£æï¼šssrTransformModel æ·±åº¦å‰–æ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-09T00:09:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="excel"/> <meta itemprop="url" content="https://juejin.cn/user/2911162520062862"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue SSR æºç è§£æï¼šssrTransformModel æ·±åº¦å‰–æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2911162520062862/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    excel
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-09T00:09:41.000Z" title="Sun Nov 09 2025 00:09:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€æ¦‚å¿µ</h2>
<p>åœ¨ Vue çš„ SSRï¼ˆæœåŠ¡ç«¯æ¸²æŸ“ï¼‰ç¼–è¯‘é˜¶æ®µä¸­ï¼Œ<code>v-model</code> æŒ‡ä»¤çš„å¤„ç†é€»è¾‘ä¸å®¢æˆ·ç«¯æ¸²æŸ“å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚<br/>
å®¢æˆ·ç«¯çš„ <code>v-model</code> ä¾èµ–è¿è¡Œæ—¶åŒå‘ç»‘å®šæœºåˆ¶ï¼Œè€Œ SSR éœ€è¦åœ¨ç¼–è¯‘æ—¶å°±ç”Ÿæˆé™æ€å­—ç¬¦ä¸²è¾“å‡ºï¼Œå› æ­¤å¿…é¡»æä¾›ä¸€ä¸ªå¯¹åº”çš„ <strong>SSR ç‰ˆæœ¬ transform</strong>ï¼š<code>ssrTransformModel</code>ã€‚</p>
<p>å®ƒçš„ä»»åŠ¡æ˜¯ï¼š</p>
<ul>
<li>å°† <code>v-model</code> æŒ‡ä»¤åœ¨æœåŠ¡ç«¯ç¼–è¯‘é˜¶æ®µè½¬åŒ–ä¸ºé€‚ç”¨äºæœåŠ¡ç«¯çš„æ¸²æŸ“è¡¨è¾¾å¼ï¼›</li>
<li>è‡ªåŠ¨ä¸ºä¸åŒç±»å‹çš„è¡¨å•æ§ä»¶ï¼ˆ<code>input</code>ã€<code>textarea</code>ã€<code>select</code> ç­‰ï¼‰æ³¨å…¥æ­£ç¡®çš„ SSR ç»‘å®šé€»è¾‘ï¼›</li>
<li>ç¡®ä¿åœ¨æ¨¡æ¿è¢«æ¸²æŸ“æˆå­—ç¬¦ä¸²æ—¶ï¼Œ<code>v-model</code> çš„å€¼åæ˜ åœ¨ DOM å±æ€§ä¸­ï¼ˆä¾‹å¦‚é€‰ä¸­çŠ¶æ€æˆ–è¾“å…¥å€¼ï¼‰ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-1">äºŒã€åŸç†</h2>
<p><code>ssrTransformModel</code> æ˜¯ä¸€ä¸ª <code>DirectiveTransform</code>ï¼Œå³ç”¨äºæŒ‡ä»¤ç¼–è¯‘çš„è½¬æ¢å‡½æ•°ã€‚å®ƒé€šè¿‡åŒ¹é… <code>v-model</code> æŒ‡ä»¤èŠ‚ç‚¹ï¼Œæ ¹æ®èŠ‚ç‚¹ç±»å‹ï¼ˆHTML å…ƒç´ ç±»å‹ï¼‰ç”Ÿæˆå¯¹åº”çš„ SSR ä»£ç ç‰‡æ®µã€‚</p>
<p>æ ¸å¿ƒæ€è·¯å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p><strong>åˆ¤æ–­èŠ‚ç‚¹ç±»å‹</strong></p>
<ul>
<li>æ™®é€šå…ƒç´ ï¼ˆ<code>input</code>ã€<code>textarea</code>ã€<code>select</code>ï¼‰ â†’ æœåŠ¡ç«¯é™æ€è¾“å‡ºï¼›</li>
<li>ç»„ä»¶èŠ‚ç‚¹ï¼ˆ<code>&lt;MyInput v-model="x" /&gt;</code>ï¼‰ â†’ å§”æ‰˜ç»™ <code>transformModel()</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>é’ˆå¯¹ä¸åŒå…ƒç´ çš„å¤„ç†é€»è¾‘</strong></p>
<ul>
<li><code>input[type=text]</code>ï¼šè¾“å‡º <code>value</code> å±æ€§ï¼›</li>
<li><code>input[type=radio]</code>ï¼šæ ¹æ® <code>v-model</code> å€¼æ˜¯å¦åŒ¹é…å½“å‰é€‰é¡¹ç”Ÿæˆ <code>checked</code>ï¼›</li>
<li><code>input[type=checkbox]</code>ï¼šæ ¹æ®æ•°ç»„/å¸ƒå°”åˆ¤æ–­ç”Ÿæˆ <code>checked</code>ï¼›</li>
<li><code>textarea</code>ï¼šå°†å†…éƒ¨å†…å®¹æ›¿æ¢ä¸ºæ’å€¼ï¼›</li>
<li><code>select</code>ï¼šé€’å½’å¤„ç†æ‰€æœ‰ <code>option</code>ï¼Œä¸ºé€‰ä¸­é¡¹æ·»åŠ  <code>selected</code> å±æ€§ã€‚</li>
</ul>
</li>
<li>
<p><strong>é”™è¯¯ä¸æ ¡éªŒ</strong></p>
<ul>
<li>
<p>æ£€æŸ¥ä¸åˆæ³•ç”¨æ³•ï¼Œå¦‚ï¼š</p>
<ul>
<li><code>v-model</code> ä¸ <code>value</code> åŒæ—¶å­˜åœ¨ï¼›</li>
<li><code>v-model</code> ç”¨äº <code>&lt;input type="file"&gt;</code>ï¼›</li>
<li><code>v-model</code> ç”¨äºéè¡¨å•å…ƒç´ ã€‚</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€æºç ä¸é€è¡Œæ³¨é‡Š</h2>
<h3 data-id="heading-3">1. å¼•å…¥ä¸ç±»å‹å£°æ˜</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> {
  DOMErrorCodes,
  <span class="hljs-built_in">type</span> DirectiveTransform,
  ElementTypes,
  <span class="hljs-built_in">type</span> ExpressionNode,
  NodeTypes,
  <span class="hljs-built_in">type</span> PlainElementNode,
  <span class="hljs-built_in">type</span> TemplateChildNode,
  createCallExpression,
  createConditionalExpression,
  createDOMCompilerError,
  createInterpolation,
  createObjectProperty,
  createSimpleExpression,
  findProp,
  hasDynamicKeyVBind,
  transformModel,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'@vue/compiler-dom'</span>
<span class="hljs-keyword">import</span> {
  SSR_INCLUDE_BOOLEAN_ATTR,
  SSR_LOOSE_CONTAIN,
  SSR_LOOSE_EQUAL,
  SSR_RENDER_DYNAMIC_MODEL,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'../runtimeHelpers'</span>
<span class="hljs-keyword">import</span> <span class="hljs-built_in">type</span> { DirectiveTransformResult } <span class="hljs-keyword">from</span> <span class="hljs-string">'packages/compiler-core/src/transform'</span>
</code></pre>
<blockquote>
<p><strong>è¯´æ˜ï¼š</strong></p>
<ul>
<li>å‰åŠéƒ¨åˆ†å¯¼å…¥ AST å¤„ç†ç›¸å…³å·¥å…·å‡½æ•°ï¼ˆå¦‚ <code>createCallExpression</code>ã€<code>createConditionalExpression</code> ç­‰ï¼‰ã€‚</li>
<li>ååŠéƒ¨åˆ†å¯¼å…¥ SSR æ¸²æŸ“è¾…åŠ©å‡½æ•°ï¼ˆå¦‚ <code>SSR_LOOSE_EQUAL</code>ã€<code>SSR_RENDER_DYNAMIC_MODEL</code> ç­‰ï¼‰ï¼Œè¿™äº›æ˜¯ SSR è¿è¡Œæ—¶åœ¨å­—ç¬¦ä¸²æ‹¼æ¥ä¸­ä½¿ç”¨çš„ helperã€‚</li>
</ul>
</blockquote>
<hr/>
<h3 data-id="heading-4">2. æ ¸å¿ƒ transform å‡½æ•°å®šä¹‰</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">ssrTransformModel</span>: <span class="hljs-title class_">DirectiveTransform</span> = <span class="hljs-function">(<span class="hljs-params">dir, node, context</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> model = dir.<span class="hljs-property">exp</span>!
</code></pre>
<blockquote>
<p><strong>è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>dir</code>ï¼šè¡¨ç¤º <code>v-model</code> æŒ‡ä»¤èŠ‚ç‚¹ï¼›</li>
<li><code>node</code>ï¼šå½“å‰ç»‘å®šçš„å…ƒç´ èŠ‚ç‚¹ï¼›</li>
<li><code>context</code>ï¼šç¼–è¯‘ä¸Šä¸‹æ–‡ï¼Œç”¨äºé”™è¯¯æŠ¥å‘Šã€helper æ³¨å†Œç­‰ï¼›</li>
<li><code>model</code>ï¼š<code>v-model</code> çš„è¡¨è¾¾å¼èŠ‚ç‚¹ï¼ˆå¦‚ <code>foo.bar</code>ï¼‰ã€‚</li>
</ul>
</blockquote>
<hr/>
<h3 data-id="heading-5">3. æ£€æŸ¥é‡å¤ç»‘å®š <code>value</code></h3>
<pre><code class="hljs language-scss" lang="scss">  function <span class="hljs-built_in">checkDuplicatedValue</span>() {
    const value = <span class="hljs-built_in">findProp</span>(node, 'value')
    if (value) {
      context<span class="hljs-selector-class">.onError</span>(
        createDOMCompilerError(
          DOMErrorCodes.X_V_MODEL_UNNECESSARY_VALUE,
          value.loc,
        ),
      )
    }
  }
</code></pre>
<blockquote>
<p><strong>é€»è¾‘è¯´æ˜ï¼š</strong><br/>
SSR ä¸éœ€è¦å†æ˜¾å¼è®¾ç½® <code>value</code>ï¼Œå› ä¸º <code>v-model</code> å·²è‡ªåŠ¨ç”Ÿæˆå®ƒï¼›è‹¥æ¨¡æ¿ä¸­å¤šå†™ä¸€ä¸ª <code>value</code>ï¼Œä¼šæŠ¥é”™æç¤ºç”¨æˆ·ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-6">4. é€’å½’å¤„ç† <code>&lt;select&gt;</code> å­èŠ‚ç‚¹</h3>
<pre><code class="hljs language-ini" lang="ini">  const <span class="hljs-attr">processSelectChildren</span> = (children: TemplateChildNode[]) =&gt; {
    children.forEach(<span class="hljs-attr">child</span> =&gt; {
      if (<span class="hljs-attr">child.type</span> === NodeTypes.ELEMENT) {
        processOption(child as PlainElementNode)
      } else if (<span class="hljs-attr">child.type</span> === NodeTypes.FOR) {
        processSelectChildren(child.children)
      } else if (<span class="hljs-attr">child.type</span> === NodeTypes.IF) {
        child.branches.forEach(<span class="hljs-attr">b</span> =&gt; processSelectChildren(b.children))
      }
    })
  }
</code></pre>
<blockquote>
<p><strong>é€»è¾‘è¯´æ˜ï¼š</strong><br/>
é€’å½’éå† <code>&lt;select&gt;</code> çš„æ‰€æœ‰å±‚çº§å­èŠ‚ç‚¹ï¼ŒåŒ…æ‹¬è¢« <code>v-for</code> æˆ– <code>v-if</code> åŒ…è£¹çš„é€‰é¡¹ï¼Œç¡®ä¿æ¯ä¸ª <code>&lt;option&gt;</code> éƒ½èƒ½æ­£ç¡®æ ‡æ³¨ <code>selected</code> çŠ¶æ€ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-7">5. å¤„ç† <code>&lt;option&gt;</code> å…ƒç´ </h3>
<pre><code class="hljs language-scss" lang="scss">  function <span class="hljs-built_in">processOption</span>(plainNode: PlainElementNode) {
    if (plainNode.tag === 'option') {
      if (plainNode.props.findIndex(p =&gt; p.name === 'selected') === -<span class="hljs-number">1</span>) {
        const value = <span class="hljs-built_in">findValueBinding</span>(plainNode)
        plainNode<span class="hljs-selector-class">.ssrCodegenNode</span>!<span class="hljs-selector-class">.elements</span><span class="hljs-selector-class">.push</span>(
          createConditionalExpression(
            createCallExpression(context.helper(SSR_INCLUDE_BOOLEAN_ATTR), <span class="hljs-selector-attr">[              createConditionalExpression(                createCallExpression(`Array.isArray`, [model]</span>),
                <span class="hljs-built_in">createCallExpression</span>(context.helper(SSR_LOOSE_CONTAIN), <span class="hljs-selector-attr">[                  model,                  value,                ]</span>),
                <span class="hljs-built_in">createCallExpression</span>(context.helper(SSR_LOOSE_EQUAL), <span class="hljs-selector-attr">[                  model,                  value,                ]</span>),
              ),
            ]),
            <span class="hljs-built_in">createSimpleExpression</span>(' selected', true),
            <span class="hljs-built_in">createSimpleExpression</span>('', true),
            false,
          ),
        )
      }
    } else if (plainNode.tag === 'optgroup') {
      <span class="hljs-built_in">processSelectChildren</span>(plainNode.children)
    }
  }
</code></pre>
<blockquote>
<p><strong>é€æ­¥è¯´æ˜ï¼š</strong></p>
<ol>
<li>
<p>è‹¥ <code>&lt;option&gt;</code> æ²¡æœ‰æ˜¾å¼ <code>selected</code>ï¼Œåˆ™åˆ¤æ–­å®ƒæ˜¯å¦åº”è¢«é€‰ä¸­ï¼›</p>
</li>
<li>
<p>åˆ¤æ–­é€»è¾‘ï¼š</p>
<ul>
<li>å¦‚æœ <code>v-model</code> æ˜¯æ•°ç»„ï¼Œåˆ™è°ƒç”¨ <code>SSR_LOOSE_CONTAIN(model, value)</code>ï¼›</li>
<li>å¦åˆ™ç”¨ <code>SSR_LOOSE_EQUAL(model, value)</code>ï¼›</li>
</ul>
</li>
<li>
<p>è‹¥åˆ¤æ–­ä¸ºçœŸï¼Œåˆ™æ‹¼æ¥å­—ç¬¦ä¸² <code>" selected"</code> åˆ°æœ€ç»ˆ SSR è¾“å‡ºã€‚</p>
</li>
</ol>
</blockquote>
<hr/>
<h3 data-id="heading-8">6. ä¸»é€»è¾‘åˆ†æ”¯ï¼ˆæ ¹æ®å…ƒç´ ç±»å‹ï¼‰</h3>
<pre><code class="hljs language-ini" lang="ini">  if (<span class="hljs-attr">node.tagType</span> === ElementTypes.ELEMENT) {
    const res: <span class="hljs-attr">DirectiveTransformResult</span> = { props: [] }
    const <span class="hljs-attr">defaultProps</span> = [
      createObjectProperty(`value`, model),
    ]
</code></pre>
<blockquote>
<p>åˆ›å»º transform ç»“æœå¯¹è±¡ <code>res</code>ï¼Œç”¨äºå­˜æ”¾ç¼–è¯‘åç”Ÿæˆçš„ propsï¼ˆæœ€ç»ˆè½¬ä¸º SSR å±æ€§å­—ç¬¦ä¸²ï¼‰ã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-9">6.1 è¾“å…¥æ¡† <code>&lt;input&gt;</code></h4>
<pre><code class="hljs language-ini" lang="ini">    if (<span class="hljs-attr">node.tag</span> === <span class="hljs-string">'input'</span>) {
      const <span class="hljs-attr">type</span> = findProp(node, <span class="hljs-string">'type'</span>)
      if (type) {
        const <span class="hljs-attr">value</span> = findValueBinding(node)
</code></pre>
<h5 data-id="heading-10">(1) åŠ¨æ€ç±»å‹è¾“å…¥æ¡†</h5>
<pre><code class="hljs language-ini" lang="ini">        if (<span class="hljs-attr">type.type</span> === NodeTypes.DIRECTIVE) {
          <span class="hljs-attr">res.ssrTagParts</span> = [
            createCallExpression(context.helper(SSR_RENDER_DYNAMIC_MODEL), [
              type.exp!,
              model,
              value,
            ]),
          ]
</code></pre>
<blockquote>
<p>ç”¨ <code>SSR_RENDER_DYNAMIC_MODEL</code> å¤„ç†ï¼Œä¾‹å¦‚ï¼š<code>&lt;input :type="inputType" v-model="x"&gt;</code>ã€‚<br/>
SSR é˜¶æ®µä¼šç”ŸæˆåŠ¨æ€ <code>type</code> åˆ†æ”¯é€»è¾‘ã€‚</p>
</blockquote>
<h5 data-id="heading-11">(2) é™æ€ç±»å‹è¾“å…¥æ¡†</h5>
<p>æ ¹æ® <code>type</code> å€¼ä¸åŒï¼š</p>
<ul>
<li><strong>radio</strong></li>
</ul>
<pre><code class="hljs language-css" lang="css">case 'radio':
  res.props = [
    <span class="hljs-built_in">createObjectProperty</span>(
      `checked`,
      <span class="hljs-built_in">createCallExpression</span>(context.<span class="hljs-built_in">helper</span>(SSR_LOOSE_EQUAL), [model, value]),
    ),
  ]
</code></pre>
<ul>
<li><strong>checkbox</strong></li>
</ul>
<pre><code class="hljs language-css" lang="css">case 'checkbox':
  const trueValueBinding = <span class="hljs-built_in">findProp</span>(node, <span class="hljs-string">'true-value'</span>)
  ...
  res.props = [
    <span class="hljs-built_in">createObjectProperty</span>(
      `checked`,
      <span class="hljs-built_in">createConditionalExpression</span>(
        <span class="hljs-built_in">createCallExpression</span>(`Array.isArray`, [model]),
        <span class="hljs-built_in">createCallExpression</span>(context.<span class="hljs-built_in">helper</span>(SSR_LOOSE_CONTAIN), [model, value]),
        model,
      ),
    ),
  ]
</code></pre>
<ul>
<li><strong>file</strong></li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">case</span> <span class="hljs-string">'file'</span>:
  context.onError(
    createDOMCompilerError(
      DOMErrorCodes.X_V_MODEL_ON_FILE_INPUT_ELEMENT,
      <span class="hljs-built_in">dir</span>.loc,
    ),
  )
</code></pre>
<ul>
<li><strong>defaultï¼ˆtext/passwordç­‰ï¼‰</strong></li>
</ul>
<pre><code class="hljs language-ini" lang="ini">default:
  checkDuplicatedValue()
  <span class="hljs-attr">res.props</span> = defaultProps
</code></pre>
<hr/>
<h4 data-id="heading-12">6.2 æ–‡æœ¬åŸŸ <code>&lt;textarea&gt;</code></h4>
<pre><code class="hljs language-ini" lang="ini">    } else if (<span class="hljs-attr">node.tag</span> === <span class="hljs-string">'textarea'</span>) {
      checkDuplicatedValue()
      <span class="hljs-attr">node.children</span> = [createInterpolation(model, model.loc)]
</code></pre>
<blockquote>
<p>æ›¿æ¢å†…éƒ¨å†…å®¹ä¸ºæ’å€¼è¡¨è¾¾å¼ï¼Œä½¿å¾— SSR è¾“å‡º <code>&lt;textarea&gt;å†…å®¹&lt;/textarea&gt;</code>ã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-13">6.3 ä¸‹æ‹‰æ¡† <code>&lt;select&gt;</code></h4>
<pre><code class="hljs language-ini" lang="ini">    } else if (<span class="hljs-attr">node.tag</span> === <span class="hljs-string">'select'</span>) {
      processSelectChildren(node.children)
</code></pre>
<blockquote>
<p>è°ƒç”¨å‰æ–‡å®šä¹‰çš„é€’å½’å‡½æ•°ï¼Œä¸º <code>&lt;option&gt;</code> è‡ªåŠ¨æ·»åŠ  <code>selected</code>ã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-14">6.4 éæ³•ç”¨æ³•å¤„ç†</h4>
<pre><code class="hljs language-python" lang="python">    } <span class="hljs-keyword">else</span> {
      context.onError(
        createDOMCompilerError(
          DOMErrorCodes.X_V_MODEL_ON_INVALID_ELEMENT,
          <span class="hljs-built_in">dir</span>.loc,
        ),
      )
    }
</code></pre>
<blockquote>
<p>ä¾‹å¦‚åœ¨ <code>&lt;div&gt;</code> æˆ– <code>&lt;span&gt;</code> ä¸Šä½¿ç”¨ <code>v-model</code>ã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-15">6.5 è¿”å›ç»“æœ</h4>
<pre><code class="hljs language-kotlin" lang="kotlin">    <span class="hljs-keyword">return</span> res
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// component v-model</span>
    <span class="hljs-keyword">return</span> transformModel(dir, node, context)
  }
</code></pre>
<blockquote>
<p>å¯¹ç»„ä»¶èŠ‚ç‚¹äº¤ç”±é€šç”¨çš„ <code>transformModel</code> å¤„ç†ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-16">7. è¾…åŠ©å‡½æ•°ï¼šæå– <code>value</code> ç»‘å®š</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">findValueBinding</span>(<span class="hljs-params">node: PlainElementNode</span>): <span class="hljs-title class_">ExpressionNode</span> {
  <span class="hljs-keyword">const</span> valueBinding = <span class="hljs-title function_">findProp</span>(node, <span class="hljs-string">'value'</span>)
  <span class="hljs-keyword">return</span> valueBinding
    ? valueBinding.<span class="hljs-property">type</span> === <span class="hljs-title class_">NodeTypes</span>.<span class="hljs-property">DIRECTIVE</span>
      ? valueBinding.<span class="hljs-property">exp</span>!
      : <span class="hljs-title function_">createSimpleExpression</span>(valueBinding.<span class="hljs-property">value</span>!.<span class="hljs-property">content</span>, <span class="hljs-literal">true</span>)
    : <span class="hljs-title function_">createSimpleExpression</span>(<span class="hljs-string">`null`</span>, <span class="hljs-literal">false</span>)
}
</code></pre>
<blockquote>
<p>è‹¥èŠ‚ç‚¹æœ‰ <code>v-bind:value</code> æˆ–é™æ€ <code>value</code> å±æ€§ï¼Œè¿”å›å…¶è¡¨è¾¾å¼ï¼›å¦åˆ™è¿”å›ä¸€ä¸ªç©ºè¡¨è¾¾å¼ <code>null</code>ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-17">å››ã€å¯¹æ¯”åˆ†æ</h2>






























<table><thead><tr><th>ç±»å‹</th><th>å®¢æˆ·ç«¯ç¼–è¯‘ (<code>transformModel</code>)</th><th>SSR ç¼–è¯‘ (<code>ssrTransformModel</code>)</th></tr></thead><tbody><tr><td>è¾“å‡ºå½¢å¼</td><td>åŠ¨æ€ç»‘å®š + äº‹ä»¶</td><td>é™æ€å­—ç¬¦ä¸²ç”Ÿæˆ</td></tr><tr><td>ç›®æ ‡</td><td>è¿è¡Œæ—¶ DOM æ›´æ–°</td><td>åˆå§‹ HTML æ¸²æŸ“</td></tr><tr><td>å¤„ç†æ—¶æœº</td><td>è¿è¡Œæ—¶</td><td>ç¼–è¯‘æ—¶</td></tr><tr><td>è¡¨å•ç±»å‹æ”¯æŒ</td><td>åŒæ­¥è¿è¡Œæ—¶ DOM</td><td>é¢„æ¸²æŸ“é€‰ä¸­ä¸å€¼</td></tr></tbody></table>
<p>SSR ç‰ˆæœ¬çš„æ ¸å¿ƒåŒºåˆ«æ˜¯ï¼š<strong>å®ƒå¿…é¡»åœ¨æ²¡æœ‰ DOM çš„ç¯å¢ƒä¸‹æ¨¡æ‹Ÿâ€œé€‰ä¸­/è¾“å…¥â€çŠ¶æ€</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-18">äº”ã€å®è·µåº”ç”¨</h2>
<p>å‡è®¾æ¨¡æ¿å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;select <span class="hljs-attr">v-model</span>=<span class="hljs-string">"lang"</span>&gt;
  &lt;option <span class="hljs-attr">value</span>=<span class="hljs-string">"en"</span>&gt;English&lt;/option&gt;
  &lt;option <span class="hljs-attr">value</span>=<span class="hljs-string">"jp"</span>&gt;Japanese&lt;/option&gt;
&lt;/select&gt;
</code></pre>
<p>SSR ç¼–è¯‘åä¼šç”Ÿæˆï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">&lt;<span class="hljs-keyword">select</span>&gt;
  &lt;<span class="hljs-keyword">option</span> value=<span class="hljs-string">"en"</span> selected&gt;English&lt;/<span class="hljs-keyword">option</span>&gt;
  &lt;<span class="hljs-keyword">option</span> value=<span class="hljs-string">"jp"</span>&gt;Japanese&lt;/<span class="hljs-keyword">option</span>&gt;
&lt;/<span class="hljs-keyword">select</span>&gt;
</code></pre>
<blockquote>
<p>å¦‚æœ <code>lang === 'en'</code>ï¼Œåˆ™ <code>selected</code> ä¼šåœ¨æœåŠ¡å™¨ç«¯ç›´æ¥è¾“å‡ºã€‚<br/>
å®¢æˆ·ç«¯ hydration é˜¶æ®µæ— éœ€å†é¢å¤–å¤„ç†é€‰ä¸­é€»è¾‘ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-19">å…­ã€æ‹“å±•ï¼šä¸ <code>v-bind</code>ã€<code>v-if</code> çš„ååŒ</h2>
<p>åœ¨ SSR ç¼–è¯‘ä¸­ï¼Œ<code>v-model</code> ä¸ <code>v-bind</code>ã€<code>v-if</code>ã€<code>v-for</code> å¯äº¤ç»‡å­˜åœ¨ã€‚<br/>
<code>ssrTransformModel</code> ç‰¹æ„æ”¯æŒé€’å½’éå† <code>v-if</code> å’Œ <code>v-for</code> å­èŠ‚ç‚¹ï¼Œç¡®ä¿æ‰€æœ‰åŠ¨æ€æ¸²æŸ“çš„é€‰é¡¹éƒ½è¢«æ­£ç¡®åˆ¤æ–­å’Œè¾“å‡ºã€‚</p>
<hr/>
<h2 data-id="heading-20">ä¸ƒã€æ½œåœ¨é—®é¢˜ä¸è®¾è®¡æ€è€ƒ</h2>
<ol>
<li><strong>åŠ¨æ€ç±»å‹çš„å¤æ‚æ€§</strong><br/>
<code>&lt;input :type="inputType" v-model="x"&gt;</code> åœ¨ SSR ä¸­å¿…é¡»ç”Ÿæˆå¤šåˆ†æ”¯æ¸²æŸ“é€»è¾‘ï¼Œå¦åˆ™æ— æ³•ç¡®å®š <code>checked/value</code> çš„ç”Ÿæˆè§„åˆ™ã€‚</li>
<li><strong>æ•°ç»„ç»‘å®šçš„å…¼å®¹æ€§</strong><br/>
é€šè¿‡ <code>Array.isArray()</code> åˆ¤æ–­æ˜¯å¦æ˜¯å¤šé€‰ç»‘å®šï¼Œè¿™ç§åŠ¨æ€æ£€æµ‹åœ¨ SSR ç¯å¢ƒä¸­éœ€è°¨æ…å¤„ç†æ€§èƒ½å¼€é”€ã€‚</li>
<li><strong>hydration å¯¹é½é—®é¢˜</strong><br/>
SSR è¾“å‡ºçš„åˆå§‹çŠ¶æ€å¿…é¡»ä¸å®¢æˆ·ç«¯åˆå§‹ <code>data</code> å®Œå…¨ä¸€è‡´ï¼Œå¦åˆ™ä¼šå‡ºç° mismatch è­¦å‘Šã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-21">å…«ã€æ€»ç»“</h2>
<p><code>ssrTransformModel</code> æ˜¯ Vue SSR ç¼–è¯‘ä½“ç³»ä¸­æœ€å…³é”®çš„æŒ‡ä»¤å¤„ç†é€»è¾‘ä¹‹ä¸€ã€‚<br/>
å®ƒåœ¨ç¼–è¯‘é˜¶æ®µå°† <code>v-model</code> çš„åŒå‘ç»‘å®šè¯­ä¹‰è½¬åŒ–ä¸ºé™æ€å±æ€§å­—ç¬¦ä¸²ï¼Œä»è€Œå®ç°<strong>åˆå§‹çŠ¶æ€å¯è¿˜åŸã€æ— è¿è¡Œæ—¶ä¾èµ–çš„ HTML è¾“å‡º</strong>ã€‚</p>
<p>è¿™æ®µä»£ç å……åˆ†ä½“ç°äº† Vue åœ¨ <strong>ç¼–è¯‘æœŸä¸è¿è¡ŒæœŸåˆ†å±‚è®¾è®¡</strong> çš„æ€æƒ³ï¼š</p>
<blockquote>
<p>ç¼–è¯‘æœŸé™æ€ç”Ÿæˆ + è¿è¡Œæ—¶åŠ¨æ€ç»‘å®š = é«˜æ€§èƒ½ä¸é«˜ä¸€è‡´æ€§å¹¶å­˜ã€‚</p>
</blockquote>
<hr/>
<p><strong>æœ¬æ–‡éƒ¨åˆ†å†…å®¹å€ŸåŠ© AI è¾…åŠ©ç”Ÿæˆï¼Œå¹¶ç”±ä½œè€…æ•´ç†å®¡æ ¸ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[EMR StarRocks Stellaå†…æ ¸æ­£å¼å‘å¸ƒï¼Œç™»é¡¶TPCæ¦œå•å…¨çƒç¬¬ä¸€]]></title>    <link>https://juejin.cn/post/7570866247979188276</link>    <guid>https://juejin.cn/post/7570866247979188276</guid>    <pubDate>2025-11-10T07:28:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570866247979188276" data-draft-id="7570604028633546787" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="EMR StarRocks Stellaå†…æ ¸æ­£å¼å‘å¸ƒï¼Œç™»é¡¶TPCæ¦œå•å…¨çƒç¬¬ä¸€"/> <meta itemprop="keywords" content="æ•°æ®åˆ†æ"/> <meta itemprop="datePublished" content="2025-11-10T07:28:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘å¤§æ•°æ®AIæŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/2414974667341287"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            EMR StarRocks Stellaå†…æ ¸æ­£å¼å‘å¸ƒï¼Œç™»é¡¶TPCæ¦œå•å…¨çƒç¬¬ä¸€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2414974667341287/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘å¤§æ•°æ®AIæŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T07:28:06.000Z" title="Mon Nov 10 2025 07:28:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>2025Â å¹´äº‘æ –å¤§ä¼šï¼ŒEMRÂ ServerlessÂ StarRocksé‡ç£…å‘å¸ƒå…¨æ–°ä¼ä¸šçº§ç‰ˆæœ¬å†…æ ¸StellaÂ (<strong>St</strong>arRocksÂ <strong>E</strong>fficientÂ andÂ <strong>L</strong>ightening-fastÂ <strong>La</strong>kehouse)ï¼Œå®Œå…¨å…¼å®¹å¼€æºStarRocksï¼Œä¸ºç”¨æˆ·æä¾›ä¼ä¸šçº§çš„äº§å“åŠŸèƒ½ã€å“è¶Šçš„æ€§èƒ½åŠç¨³å®šæ€§ä¿éšœã€‚</p>
<p>EMRÂ ServerlessÂ StarRocksåœ¨æƒå¨TPCåŸºå‡†æµ‹è¯•ä¸­åˆ›é€ ä½³ç»©ï¼šåœ¨â€œæ•°æ®åˆ†æâ€æ€§èƒ½æµ‹è¯•TPC-Hæ¦œå•ä¸­ï¼Œé˜¿é‡Œäº‘EMRÂ ServerlessÂ StarRocksÂ ï¼ˆStellaÂ 1.2.0å†…æ ¸ï¼‰ä»¥QphHè¶…754ä¸‡åˆ†çš„æ€§èƒ½ç»“æœ<strong>æ–©è·å…¨çƒå† å†›</strong>ï¼Œ<strong>é¢†å…ˆç¬¬äºŒå111%</strong>ï¼›</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ce0b5f6a128481ebed10270a3fc9cb6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763364485&amp;x-signature=%2Bb2L%2FyFvlVFCriFcBQURR9eKT0k%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/353ef8ddd52d42cc8a4bf75b8958c3b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763364485&amp;x-signature=a0rnCCPKqenchYWJ01noPaJnZOY%3D" alt="image.png" loading="lazy"/></p>
<p>å…¨æ–°ä¼ä¸šçº§å†…æ ¸Stellaåœ¨<strong>TPC-HÂ 10TBæ ‡å‡†æµ‹è¯•åœºæ™¯ä¸‹ï¼Œç›¸æ¯”ä¸Šä¸€ç‰ˆæœ¬æ€§èƒ½æå‡è¶…è¿‡120%</strong>ï¼Œç™»é¡¶TPCæ¦œå•å…¨çƒç¬¬ä¸€ï¼›ä¸æ­¤åŒæ—¶ï¼Œåœ¨Lakehouseå…¸å‹åœºæ™¯ä¸­ï¼ŒStarRocksÂ +Â Paimonç»„åˆçš„TPC-HÂ 1Tçš„æ€§èƒ½æµ‹è¯•ï¼Œ<strong>ç›¸æ¯”ä¸Šä¸€ä¸ªç‰ˆæœ¬æ€§èƒ½æå‡100%</strong>ï¼Œç›¸æ¯”TrinoÂ +Â Paimonå®æµ‹<strong>æ€§èƒ½æå‡é«˜è¾¾12å€</strong>ï¼ŒPaimonÂ DVè¡¨çš„<strong>æ¨¡å¼ä¸‹æå‡300%</strong>ã€‚å……åˆ†éªŒè¯äº†å…¶åœ¨å¤æ‚åˆ†ææŸ¥è¯¢ä¸­çš„æè‡´æ€§èƒ½ä¸äº‘åŸç”Ÿæ¶æ„çš„é¢†å…ˆä¼˜åŠ¿ã€‚åŒæ—¶å‘å¸ƒäº†å…¨æ–°çš„å…¨æ–‡æ£€ç´¢å¼•æ“ï¼Œè¾ƒä¹‹å‰ç‰ˆæœ¬<strong>è¿‡æ»¤æ€§èƒ½æå‡100%</strong>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b7e35488111c4533bf2c7f3ffc1845ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763364485&amp;x-signature=gwuch4gcKDpq2OGOV04k2Uw1drw%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-0">ä¸‰å¤§æ ¸å¿ƒåœºæ™¯å…¨é¢å‡çº§</h2>
<p>StellaÂ èšç„¦äº‘åŸç”ŸLakehouseèƒ½åŠ›æå‡ï¼Œåœ¨å®æ—¶æ•°ä»“ã€æ¹–ä»“åˆ†æã€å…¨æ–‡æ£€ç´¢ä¸‰å¤§æ ¸å¿ƒåœºæ™¯ä¸Šå–å¾—é‡å¤§çªç ´ï¼š</p>
<ol>
<li><strong>å®æ—¶æ•°ä»“</strong></li>
</ol>
<ul>
<li><strong>å¤šWarehouseï¼ˆå¤šè®¡ç®—ç»„ï¼‰æ­£å¼å‘å¸ƒ</strong>ï¼šæ”¯æŒ<strong>è¯»å†™åˆ†ç¦»</strong>åœºæ™¯ï¼Œå·²ç»è¿‡å¤§è§„æ¨¡ç”Ÿäº§ç¯å¢ƒéªŒè¯</li>
<li><strong>å†…æ ¸æ€§èƒ½å¤§å¹…æå‡</strong>ï¼šæ€§èƒ½è¾ƒä¸Šä¸ªç‰ˆæœ¬<strong>æå‡100%</strong></li>
<li><strong>ä½¿ç”¨æˆæœ¬å¤§å¤§é™ä½</strong>ï¼šé«˜é¢‘å¯¼å…¥<strong>é™ä½50%èµ„æºæ¶ˆè€—</strong>ï¼Œå­˜å‚¨APIè¯·æ±‚æˆæœ¬<strong>é™ä½80%</strong></li>
<li><strong>å…ƒæ•°æ®ç®¡ç†æ•ˆç‡æå‡</strong>ï¼šæµ·é‡Tabletè°ƒåº¦æ€§èƒ½<strong>æå‡300%</strong></li>
<li><strong>ä¼ä¸šçº§èƒ½åŠ›</strong>ï¼šå®Œæ•´æ”¯æŒ<strong>æ•°æ®æ²»ç†å’Œè¡€ç¼˜</strong>åŠŸèƒ½</li>
<li><strong>å­˜å‚¨ä¸å¯è§‚æµ‹æ€§æå‡</strong>ï¼šç£ç›˜ç©ºé—´å’Œç¨³å®šæ€§å…¨é¢å¯¹é½<strong>å­˜ç®—ä¸€ä½“</strong>æ¶æ„ï¼Œå¯è§‚æµ‹æ€§å¤§å¹…æå‡</li>
</ul>
<ol start="2">
<li><strong>æ¹–ä»“åˆ†æ</strong></li>
</ol>
<ul>
<li><strong>PaimonæŸ¥è¯¢æ€§èƒ½æå‡100%</strong>ï¼šåœ¨æ ‡å‡†TPC-Håœºæ™¯ä¸‹ï¼ŒæŸ¥è¯¢æ€§èƒ½è¾ƒä¸Šä¸€ç‰ˆæœ¬æ˜¾è‘—æå‡</li>
<li><strong>PaimonÂ DVè¡¨åˆ†ææ€§èƒ½****æå‡300%+</strong>ï¼šé€šè¿‡å¯¹DVåºåˆ—åŒ–æœºåˆ¶çš„å¤§å¹…ä¼˜åŒ–ï¼ŒDVè¡¨æ¨¡å‹æŸ¥è¯¢æ•ˆç‡æå‡çº¦10å€</li>
<li><strong>è·¨å¼•æ“æ€§èƒ½é¢†å…ˆ</strong>ï¼šStarRocks+Paimonç›¸è¾ƒTrino+Paimonæ€§èƒ½<strong>æå‡12å€ä»¥ä¸Š</strong></li>
<li><strong>æ— ç¼é›†æˆäº‘ä¸ŠDLFÂ 2.Ã—ç³»åˆ—</strong>ï¼šä¸é˜¿é‡Œäº‘DataÂ LakeÂ Formationæ·±åº¦é›†æˆï¼Œæ”¯æŒç”¨æˆ·ã€æƒé™ã€å…ƒæ•°æ®ç»Ÿä¸€ç®¡ç†ï¼Œäº‘ä¸Šå³å¼€å³ç”¨çš„Lakehouseæ¶æ„</li>
</ul>
<ol start="3">
<li><strong>å…¨æ–‡æ£€ç´¢</strong></li>
</ol>
<ul>
<li><strong>å…¨æ–°<strong><strong>å€’æ’ç´¢å¼•</strong></strong>æ¶æ„å’Œèƒ½åŠ›æ­£å¼å‘å¸ƒ</strong>ï¼šé‡æ„ç¤¾åŒºç‰ˆæœ¬ï¼Œæ”¹è¿›è®¾è®¡ç¼ºé™·</li>
<li><strong>å¯¼å…¥æ€§èƒ½æå‡3å€+</strong>ï¼šæ£€ç´¢å¼•æ“æ•°æ®å¯¼å…¥æ•ˆç‡å¤§å¹…æé«˜</li>
<li><strong>æ—¥å¿—åˆ†ææ€§èƒ½æå‡5å€+</strong>ï¼šæŸ¥è¯¢å“åº”é€Ÿåº¦æ˜¾è‘—æå‡</li>
<li><strong>å­˜å‚¨é™æœ¬80%+</strong>ï¼šStarRocksé‡‡ç”¨çš„åˆ—å­˜æ¨¡å¼è¾ƒè¡Œå­˜æ¨¡å¼å¤§å¤§æå‡å‹ç¼©ç©ºé—´èƒ½åŠ›</li>
</ul>
<h2 data-id="heading-1">æ ¸å¿ƒèƒ½åŠ›ä¼˜åŒ–</h2>
<h3 data-id="heading-2">Multi-Warehouseï¼šä¼ä¸šçº§èµ„æºéš”ç¦»æ–¹æ¡ˆ</h3>
<p>Multi-Warehouseé’ˆå¯¹å¤§å‹StarRocksé›†ç¾¤çš„èµ„æºéš”ç¦»éš¾é¢˜æä¾›äº†æœ‰æ•ˆè§£å†³æ–¹æ¡ˆã€‚éšç€é›†ç¾¤è§„æ¨¡æ‰©å¤§å’Œä¸šåŠ¡åœºæ™¯å¢å¤šï¼Œèµ„æºäº‰æŠ¢é—®é¢˜é€æ¸å‡¸æ˜¾â€”â€”å¯¼å…¥ä»»åŠ¡è¿‡å¤§å½±å“æŸ¥è¯¢æ€§èƒ½ã€å¤§å‹SQLæ“ä½œé˜»å¡å…¶ä»–ä¸šåŠ¡æŸ¥è¯¢ã€‚</p>
<p>Multi-WarehouseåŸºäºå­˜ç®—åˆ†ç¦»æ¶æ„ï¼Œå®ç°äº†ï¼š</p>
<ul>
<li><strong>æ•°æ®å…±äº«ä¸è®¡ç®—éš”ç¦»</strong>ï¼šå¤šä¸ªWarehouseå…±äº«åŒä¸€å­˜å‚¨å±‚ï¼ˆå¦‚OSSï¼‰ï¼Œå®ç°æ•°æ®é«˜æ•ˆå…±ç”¨ï¼›è®¡ç®—èµ„æºé€šè¿‡ç¡¬éš”ç¦»æœºåˆ¶ç‹¬ç«‹åˆ†é…</li>
<li><strong>å…¨é¢èµ„æºéš”ç¦»</strong>ï¼šæœ€æ–°ç‰ˆæœ¬æ”¯æŒCompactionæŒ‡å®šè¿è¡Œåœ¨ç‰¹å®šWarehouseä¸­ï¼Œé¿å…èµ„æºé›†ä¸­äº‰æŠ¢</li>
<li><strong>å¼¹æ€§ä¼¸ç¼©ååŒ</strong>ï¼šä¸å¼¹æ€§ä¼¸ç¼©èƒ½åŠ›ç»“åˆä½¿ç”¨ï¼Œå¯æ ¹æ®ä¸šåŠ¡éœ€æ±‚åŠ¨æ€è°ƒæ•´è®¡ç®—èµ„æºè§„æ¨¡ï¼Œç™½å¤©é«˜å³°æ‰©å®¹ã€å¤œé—´ä½å³°ç¼©å®¹ï¼Œåœ¨ä¿éšœæ€§èƒ½çš„åŒæ—¶æœ‰æ•ˆæ§åˆ¶æˆæœ¬</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa0d5016149146c29a558bb4831a5258~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763364485&amp;x-signature=gh%2BTmSFydmqx8X17NihLfZTobmc%3D" alt="image.png" loading="lazy"/></p>
<p>ç›®å‰ï¼Œåœ¨ä½¿ç”¨å­˜ç®—åˆ†ç¦»æ¶æ„çš„å®¢æˆ·ä¸­ï¼Œçº¦åŠæ•°å·²å¯ç”¨Multi-Warehouseï¼Œè¯¥åŠŸèƒ½ä¸å¼¹æ€§ä¼¸ç¼©å·²æˆä¸ºä¼ä¸šç”¨æˆ·å¹¿æ³›ç»„åˆä½¿ç”¨çš„ä¸¤å¤§æ ¸å¿ƒåŠŸèƒ½ã€‚</p>
<h3 data-id="heading-3">StellaÂ å†…æ ¸æ€§èƒ½æå‡</h3>
<p>åœ¨TPC-HÂ 10TåŸºå‡†æµ‹è¯•ä¸­ï¼Œå­˜ç®—åˆ†ç¦»ç‰ˆæœ¬çš„Stellaç›¸æ¯”ä¸Šä¸€ç‰ˆæœ¬<strong>æ€§èƒ½æå‡è¶…è¿‡120%</strong>ï¼Œå……åˆ†å±•ç°äº†äº‘åŸç”Ÿæ¶æ„çš„æŠ€æœ¯ä¼˜åŠ¿ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7a12ce984734e55892cf1385b9fa787~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763364485&amp;x-signature=h877JAI2ymGXev1G7hHc7T4VgCA%3D" alt="image.png" loading="lazy"/></p>
<p><strong>é‡ç‚¹ä¼˜åŒ–ï¼š</strong></p>
<ul>
<li>æ”¯æŒIndexÂ &amp;Â MetaÂ CacheÂ åŠŸèƒ½ä¼˜å…ˆçº§ï¼Œä¼˜å…ˆä¿éšœå…ƒæ•°æ®ç¼“å­˜å‘½ä¸­ç‡ï¼Œå¤§å¤§æå‡æŸ¥è¯¢æ€§èƒ½</li>
<li>ç¼“å­˜è‡ªé€‚åº”IOæ¡†æ¶ï¼Œæ›´å¥½çš„å‡è¡¡ç£ç›˜å’ŒOSSæ•ˆç‡ï¼Œæé«˜ç¼“å­˜å‘½ä¸­ç‡</li>
<li>é«˜é¢‘å¯¼å…¥åœºæ™¯ï¼Œä¼˜åŒ–è°ƒåº¦ç®—æ³•ï¼Œä¿éšœä¸å€¾æ–œï¼Œæå‡å¯¼å…¥æ•ˆç‡</li>
<li>æµ·é‡Tabletè°ƒåº¦æƒ…å†µä¸‹ï¼Œä¼˜åŒ–sharedÂ balanceç®—æ³•ï¼Œåœ¨50+èŠ‚ç‚¹å¼¹æ€§ä¼¸ç¼©åœºæ™¯ä¸‹ï¼Œè¾¾åˆ°ç§’çº§å‡è¡¡</li>
<li>è½»é‡ETLåœºæ™¯ä¸‹ä¼˜åŒ–ç¼“å­˜ç©ºé—´ç®¡ç†æ¡†æ¶</li>
</ul>
<h3 data-id="heading-4">æ¹–ä»“åˆ†æåœºæ™¯ä¼˜åŒ–</h3>
<p>Stellaåœ¨Lakehouseåœºæ™¯ä¸‹æŸ¥è¯¢Paimonä¸‹æ€§èƒ½çš„æå‡ä¹Ÿéå¸¸æ˜æ˜¾ï¼š
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/23d881c2f56741c4b4a1b5d87d012399~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763364485&amp;x-signature=mGZhcXXHwPXt5tJHYaUWY5LY61k%3D" alt="image.png" loading="lazy"/></p>
<p><strong>é‡ç‚¹ä¼˜åŒ–</strong></p>
<ul>
<li>å¤§è§„æ¨¡å…ƒæ•°æ®åœºæ™¯ä¸‹ï¼Œå®ç°åˆ†å¸ƒå¼å…ƒæ•°æ®è§£ææ¡†æ¶ï¼Œé¿å…å•ç‚¹ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½ã€‚</li>
<li>ä¼˜åŒ–å…ƒæ•°æ®è·å–æ€§èƒ½ï¼Œæ”¯æŒmanifestÂ cacheï¼Œæå‡æŸ¥è¯¢æ€§èƒ½åŠMVåˆ·æ–°æ•ˆç‡ã€‚</li>
<li>é‡æ„DeleteÂ Vectoråºåˆ—åŒ–æ¡†æ¶ï¼Œå¤§å¹…åº¦æå‡DVæŸ¥è¯¢æ€§èƒ½ã€‚</li>
<li>DLFÂ 2.5Â æ·±åº¦é›†æˆï¼Œä¸Openlakeæ–¹æ¡ˆæ— ç¼è¡”æ¥ã€‚</li>
</ul>
<p>é€šè¿‡<strong>ä¸DataÂ LakeÂ Formationçš„æ·±åº¦é›†æˆ</strong>ï¼Œç”¨æˆ·åªéœ€ç®€å•åˆ›å»ºcatalogå³å¯è®¿é—®DLFä¸­çš„æ•°æ®è¡¨ï¼Œæƒé™é…ç½®åœ¨DLFä¸­å³å¯è‡ªåŠ¨åŒæ­¥è‡³StarRocksï¼Œå®ç°çœŸæ­£çš„å³å¼€å³ç”¨ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6961b504626d4e60919da235efc4881c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5aSn5pWw5o2uQUnmioDmnK8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763364485&amp;x-signature=AuRWb8A%2FvwAR10J9iAJAeU6jCMM%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-5">å…¨æ–‡æ£€ç´¢å‘å¸ƒ</h3>
<p>å…¨æ–°å…¨æ–‡æ£€ç´¢åŠŸèƒ½ç°å·²åœ¨å­˜ç®—ä¸€ä½“ä¸åˆ†ç¦»æ¶æ„ä¸­å…¨é¢æ”¯æŒï¼ŒåŸºäºÂ å…¨æ–‡å€’æ’ç´¢å¼•å®ç°é«˜æ•ˆæ–‡æœ¬æœç´¢ã€‚é€‚ç”¨äºæ—¥å¿—åˆ†æã€å•†å“æ ‡é¢˜åŒ¹é…ç­‰åœºæ™¯ã€‚ç›¸æ¯”æ—§ç‰ˆï¼ŒæŸ¥è¯¢æ€§èƒ½æå‡Â 3-5Â å€ï¼Œå¯¼å…¥æ›´å¿«ï¼Œå­˜å‚¨æˆæœ¬æ˜¾è‘—é™ä½ã€‚å…¨æ–‡æ£€ç´¢åŠŸèƒ½æ”¯æŒä¸»é”®è¡¨å’Œæ˜ç»†è¡¨ï¼Œç”¨æˆ·å¯åœ¨å»ºè¡¨æ—¶æˆ–å»ºè¡¨ååˆ›å»ºç´¢å¼•ï¼Œä½¿ç”¨matchã€match_allç­‰è¯­æ³•å®ç°å¤šæ ·åŒ–çš„æ–‡æœ¬æ£€ç´¢éœ€æ±‚ã€‚</p>
<h4 data-id="heading-6">å…¨æ–‡å€’æ’ç´¢å¼•ä½¿ç”¨æ–¹æ³•</h4>
<p><strong>å»ºè¡¨æ—¶åˆ›å»ºç´¢å¼•ï¼š</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `t` (
  `k` <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT "",
  `v` STRING COMMENT "",
  INDEX idx (v) <span class="hljs-keyword">USING</span> GIN("parser" <span class="hljs-operator">=</span> "english")
) ENGINE<span class="hljs-operator">=</span>OLAP
DUPLICATE KEY(`k`)
DISTRIBUTED <span class="hljs-keyword">BY</span> HASH(`k`) BUCKETS <span class="hljs-number">1</span>
PROPERTIES (
  "replicated_storage" <span class="hljs-operator">=</span> "false"
);
</code></pre>
<p><strong>å»ºè¡¨ååˆ›å»ºç´¢å¼•ï¼š</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- Create Index After Create Table</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> t <span class="hljs-keyword">ADD</span> INDEX idx (v) <span class="hljs-keyword">USING</span> GIN( <span class="hljs-string">'parser'</span> <span class="hljs-operator">=</span> <span class="hljs-string">'english'</span>);
</code></pre>
<p><strong>å…¨æ–‡æ£€ç´¢æŸ¥è¯¢ï¼š</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- MATCH/MATCH_ANY</span>
<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> testdb.http_logs 
<span class="hljs-keyword">where</span> request <span class="hljs-keyword">match</span> "images hm_bg";

<span class="hljs-comment">-- MATCH_ALL</span>
<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> testdb.http_logs 
<span class="hljs-keyword">where</span> request match_all "images hm_bg";

<span class="hljs-comment">-- MATCH_PHRASE</span>
<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> testdb.http_logs 
<span class="hljs-keyword">where</span> request match_phrase "GET /images";

<span class="hljs-comment">-- MATCH_PHRASE_PREFIX</span>
<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> testdb.http_logs 
<span class="hljs-keyword">where</span> request match_phrase_prefix "GET /im";

<span class="hljs-comment">-- MATCH_PHRASE_EDGE</span>
<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> testdb.http_logs 
<span class="hljs-keyword">where</span> request match_phrase_edge <span class="hljs-string">'et images hm'</span>;
</code></pre>
<p>StellaÂ çš„å‘å¸ƒæ ‡å¿—ç€Â EMRÂ ServerlessÂ StarRocksÂ åœ¨ä¼ä¸šçº§æ•°æ®åˆ†æé¢†åŸŸè¿ˆå…¥æ–°çš„é‡Œç¨‹ç¢‘ã€‚ä»å®æ—¶æ•°ä»“åˆ°æ¹–ä»“åˆ†æï¼Œä»å…¨æ–‡æ£€ç´¢åˆ°å¤šä¸šåŠ¡éš”ç¦»ï¼ŒStellaÂ ä¸ºæ¯ä¸€ä¸ªåœºæ™¯éƒ½å¸¦æ¥äº†å®å®åœ¨åœ¨çš„æ€§èƒ½æå‡å’Œæˆæœ¬ä¼˜åŒ–ã€‚</p>
<p>ä¾æ‰˜äºåœ¨Â <strong>TPC-HÂ 10TÂ åŸºå‡†æµ‹è¯•ä¸­è¶…è¿‡Â 120%Â çš„æ€§èƒ½é£è·ƒ</strong>ï¼Œä»¥åŠåœ¨å¼€æ”¾æ¹–ä»“åœºæ™¯ä¸‹æå‡é«˜è¾¾Â <strong>12Â å€çš„å®æµ‹æŸ¥è¯¢ä¼˜åŠ¿</strong>ï¼ŒStellaÂ ä¸ä»…éªŒè¯äº†å…¶æŠ€æœ¯æ¶æ„çš„å…ˆè¿›æ€§ï¼Œæ›´å½°æ˜¾äº†é˜¿é‡Œäº‘åœ¨äº‘åŸç”Ÿæ•°æ®å¤„ç†é¢†åŸŸçš„æ·±åšç§¯ç´¯ä¸æŒç»­åˆ›æ–°èƒ½åŠ›ã€‚è¿™äº›æˆç»©èƒŒåï¼Œæ˜¯å­˜ç®—åˆ†ç¦»æ¶æ„ã€åˆ†å¸ƒå¼å…ƒæ•°æ®ç®¡ç†ã€æ™ºèƒ½ç¼“å­˜è°ƒåº¦ã€DeleteÂ VectorÂ ä¼˜åŒ–ç­‰æ ¸å¿ƒæŠ€æœ¯çš„å…¨é¢çªç ´ï¼Œä½¿å¾—Â StellaÂ èƒ½å¤Ÿä»å®¹åº”å¯¹è¶…å¤§è§„æ¨¡æ•°æ®ä¸‹çš„å¤æ‚åˆ†ææŒ‘æˆ˜ã€‚</p>
<p>é¢å‘æœªæ¥ï¼ŒStellaÂ å°†ç»§ç»­æ·±åŒ–åœ¨Â LakehouseÂ æ¶æ„ã€å®æ—¶åŒ–ã€æ™ºèƒ½åŒ–æ–¹å‘çš„æ¢ç´¢ï¼Œä¸ºä¼ä¸šæ„å»ºç»Ÿä¸€ã€é«˜æ•ˆã€ä½æˆæœ¬çš„æ•°æ®åˆ†æåº•åº§æä¾›æ›´å¼ºæœ‰åŠ›çš„æ”¯æ’‘ã€‚æ— è®ºæ˜¯é‡‘èã€ç”µå•†ã€äº’è”ç½‘è¿˜æ˜¯åˆ¶é€ ä¸šå®¢æˆ·ï¼Œéƒ½å°†å€ŸåŠ©StellaÂ å®ç°æ›´å¿«é€Ÿçš„å†³ç­–å“åº”ã€æ›´çµæ´»çš„èµ„æºè°ƒåº¦ä¸æ›´å¯è§‚çš„æ€»ä½“æ‹¥æœ‰æˆæœ¬ï¼ˆTCOï¼‰ä¼˜åŒ–ã€‚EMRÂ ServerlessÂ StarRocksÂ æ­£ä»¥å¼€æºå…¼å®¹ä¸ºåŸºçŸ³ï¼Œä»¥ä¼ä¸šçº§èƒ½åŠ›ä¸ºæ ¸å¿ƒï¼Œå¼•é¢†äº‘åŸç”Ÿæ•°æ®åˆ†æçš„æ–°æ—¶ä»£ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å®é™…å¼€å‘ä¸­ | ä¸ || çš„ä½¿ç”¨æ–¹æ³•åŠç»„ä»¶å°è£…æ–¹æ¡ˆè§£æ]]></title>    <link>https://juejin.cn/post/7570500819888930859</link>    <guid>https://juejin.cn/post/7570500819888930859</guid>    <pubDate>2025-11-10T06:15:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570500819888930859" data-draft-id="7514645274707853366" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å®é™…å¼€å‘ä¸­ | ä¸ || çš„ä½¿ç”¨æ–¹æ³•åŠç»„ä»¶å°è£…æ–¹æ¡ˆè§£æ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-10T06:15:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·954515681162"/> <meta itemprop="url" content="https://juejin.cn/user/898732860638087"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å®é™…å¼€å‘ä¸­ | ä¸ || çš„ä½¿ç”¨æ–¹æ³•åŠç»„ä»¶å°è£…æ–¹æ¡ˆè§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/898732860638087/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·954515681162
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T06:15:31.000Z" title="Mon Nov 10 2025 06:15:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä¸€ã€åŸºæœ¬ä½¿ç”¨æ–¹æ³•</h3>
<ol>
<li><strong>æŒ‰ä½æˆ–è¿ç®—ç¬¦ï¼ˆ|ï¼‰</strong>
å¸¸ç”¨äºäºŒè¿›åˆ¶ä½æ“ä½œï¼Œå¦‚æƒé™æ§åˆ¶ã€çŠ¶æ€åˆå¹¶ç­‰åœºæ™¯ã€‚</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æƒé™æ§åˆ¶ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">READ</span> = <span class="hljs-number">1</span>;    <span class="hljs-comment">// äºŒè¿›åˆ¶: 0001</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">WRITE</span> = <span class="hljs-number">2</span>;   <span class="hljs-comment">// äºŒè¿›åˆ¶: 0010</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DELETE</span> = <span class="hljs-number">4</span>;  <span class="hljs-comment">// äºŒè¿›åˆ¶: 0100</span>

<span class="hljs-comment">// ç»„åˆæƒé™</span>
<span class="hljs-keyword">let</span> userPermission = <span class="hljs-variable constant_">READ</span> | <span class="hljs-variable constant_">WRITE</span>; <span class="hljs-comment">// 0011 = 3</span>

<span class="hljs-comment">// æ£€æŸ¥æƒé™</span>
<span class="hljs-keyword">if</span> (userPermission &amp; <span class="hljs-variable constant_">READ</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç”¨æˆ·æ‹¥æœ‰è¯»å–æƒé™"</span>);
}
</code></pre>
<ol start="2">
<li><strong>é€»è¾‘æˆ–è¿ç®—ç¬¦ï¼ˆ||ï¼‰</strong>
å¸¸ç”¨äºæ¡ä»¶åˆ¤æ–­ä¸­çš„çŸ­è·¯æ±‚å€¼ï¼Œæˆ–è®¾ç½®é»˜è®¤å€¼ã€‚</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// çŸ­è·¯æ±‚å€¼ç¤ºä¾‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">validateInput</span>(<span class="hljs-params">value</span>) {
  <span class="hljs-keyword">if</span> (!value || value.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">"è¾“å…¥ä¸èƒ½ä¸ºç©º"</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-string">"éªŒè¯é€šè¿‡"</span>;
}

<span class="hljs-comment">// é»˜è®¤å€¼è®¾ç½®</span>
<span class="hljs-keyword">const</span> config = {
  <span class="hljs-attr">timeout</span>: options.<span class="hljs-property">timeout</span> || <span class="hljs-number">3000</span>,
  <span class="hljs-attr">retries</span>: options.<span class="hljs-property">retries</span> || <span class="hljs-number">3</span>
};
</code></pre>
<h3 data-id="heading-1">äºŒã€ç»„ä»¶å°è£…æ–¹æ¡ˆ</h3>
<ol>
<li><strong>ä½æ“ä½œå·¥å…·ç±»å°è£…</strong></li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BitwiseUtils</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {}

  <span class="hljs-comment">// åˆå¹¶å¤šä¸ªæ ‡å¿—ä½</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">combineFlags</span>(<span class="hljs-params">...flags</span>) {
    <span class="hljs-keyword">return</span> flags.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">result, flag</span>) =&gt;</span> result | flag, <span class="hljs-number">0</span>);
  }

  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦åŒ…å«æŸä¸ªæ ‡å¿—ä½</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">hasFlag</span>(<span class="hljs-params">value, flag</span>) {
    <span class="hljs-keyword">return</span> (value &amp; flag) === flag;
  }

  <span class="hljs-comment">// ç§»é™¤æŸä¸ªæ ‡å¿—ä½</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">removeFlag</span>(<span class="hljs-params">value, flag</span>) {
    <span class="hljs-keyword">return</span> value &amp; ~flag;
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> permissions = <span class="hljs-title class_">BitwiseUtils</span>.<span class="hljs-title function_">combineFlags</span>(<span class="hljs-variable constant_">READ</span>, <span class="hljs-variable constant_">WRITE</span>);
<span class="hljs-title class_">BitwiseUtils</span>.<span class="hljs-title function_">hasFlag</span>(permissions, <span class="hljs-variable constant_">DELETE</span>); <span class="hljs-comment">// false</span>
</code></pre>
<ol start="2">
<li><strong>é€»è¾‘åˆ¤æ–­ç»„ä»¶å°è£…ï¼ˆReactç¤ºä¾‹ï¼‰</strong></li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">ConditionalComponent</span>(<span class="hljs-params">{ condition, left, right }</span>) {
  <span class="hljs-keyword">return</span> condition ? left : right;
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
&lt;<span class="hljs-title class_">ConditionalComponent</span> 
  condition={user.<span class="hljs-property">isAdmin</span> || user.<span class="hljs-title function_">hasPermission</span>(<span class="hljs-string">"edit"</span>)}
  left={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AdminPanel</span> /&gt;</span></span>}
  right={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserPanel</span> /&gt;</span></span>}
/&gt;
</code></pre>
<h3 data-id="heading-2">ä¸‰ã€è¿›é˜¶åº”ç”¨åœºæ™¯</h3>
<ol>
<li><strong>æ€§èƒ½ä¼˜åŒ–ï¼šçŸ­è·¯æ±‚å€¼çš„åº”ç”¨</strong></li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é¿å…ä¸å¿…è¦çš„å‡½æ•°è°ƒç”¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">expensiveOperation</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ‰§è¡Œè€—æ—¶æ“ä½œ"</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-comment">// å½“isEnabledä¸ºfalseæ—¶ï¼Œä¸ä¼šæ‰§è¡ŒexpensiveOperation</span>
<span class="hljs-keyword">if</span> (isEnabled || <span class="hljs-title function_">expensiveOperation</span>()) {
  <span class="hljs-comment">// å¤„ç†é€»è¾‘</span>
}
</code></pre>
<ol start="2">
<li><strong>äºŒè¿›åˆ¶çŠ¶æ€æœº</strong></li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">StateMachine</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-number">0</span>;
  }

  <span class="hljs-comment">// è®¾ç½®çŠ¶æ€</span>
  <span class="hljs-title function_">setState</span>(<span class="hljs-params">state</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> |= state;
  }

  <span class="hljs-comment">// æ¸…é™¤çŠ¶æ€</span>
  <span class="hljs-title function_">clearState</span>(<span class="hljs-params">state</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> &amp;= ~state;
  }

  <span class="hljs-comment">// æ£€æŸ¥çŠ¶æ€</span>
  <span class="hljs-title function_">isActive</span>(<span class="hljs-params">state</span>) {
    <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> &amp; state) !== <span class="hljs-number">0</span>;
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> machine = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StateMachine</span>();
machine.<span class="hljs-title function_">setState</span>(<span class="hljs-variable constant_">LOADING</span>);
machine.<span class="hljs-title function_">isActive</span>(<span class="hljs-variable constant_">LOADING</span>); <span class="hljs-comment">// true</span>
</code></pre>
<h3 data-id="heading-3">å››ã€æ³¨æ„äº‹é¡¹</h3>
<ol>
<li><strong>è¿ç®—ç¬¦ä¼˜å…ˆçº§é—®é¢˜</strong></li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹ï¼šå¯èƒ½å¯¼è‡´é€»è¾‘é”™è¯¯</span>
<span class="hljs-keyword">if</span> (a || b &amp; c) { ... }

<span class="hljs-comment">// æ­£ç¡®ç¤ºä¾‹ï¼šä½¿ç”¨æ‹¬å·æ˜ç¡®ä¼˜å…ˆçº§</span>
<span class="hljs-keyword">if</span> (a || (b &amp; c)) { ... }
</code></pre>
<ol start="2">
<li><strong>ç±»å‹è½¬æ¢é™·é˜±</strong></li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// éå¸ƒå°”å€¼åœ¨é€»è¾‘è¿ç®—ä¸­çš„è½¬æ¢</span>
<span class="hljs-number">0</span> || <span class="hljs-number">5</span>; <span class="hljs-comment">// è¿”å›5ï¼ˆçœŸå€¼ï¼‰</span>
<span class="hljs-string">''</span> || <span class="hljs-string">'default'</span>; <span class="hljs-comment">// è¿”å›'default'</span>
</code></pre>
<p>é€šè¿‡åˆç†å°è£…å’Œä½¿ç”¨è¿™ä¸¤ä¸ªè¿ç®—ç¬¦ï¼Œå¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼ŒåŒæ—¶é¿å…æ½œåœ¨çš„é€»è¾‘é”™è¯¯ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œå»ºè®®æ ¹æ®å…·ä½“åœºæ™¯é€‰æ‹©åˆé€‚çš„è¿ç®—ç¬¦ï¼Œå¹¶é€šè¿‡å·¥å…·ç±»æˆ–ç»„ä»¶åŒ–çš„æ–¹å¼å°†é€šç”¨é€»è¾‘å°è£…å¤ç”¨ã€‚</p>
<hr/>
<p>JavaScript, å‰ç«¯å¼€å‘ï¼Œé€»è¾‘è¿ç®—ç¬¦ï¼Œä½è¿ç®—ç¬¦ï¼Œç»„ä»¶å°è£…ï¼Œç»„ä»¶åŒ–å¼€å‘ï¼Œå‰ç«¯</p>
<hr/>
<hr/>
<p>å‡†å¤‡äº†ä¸€äº›é¢è¯•èµ„æ–™ï¼Œè¯·åœ¨ä»¥ä¸‹é“¾æ¥ä¸­è·å–
<a href="https://link.juejin.cn?target=https%3A%2F%2Fpan.quark.cn%2Fs%2F4459235fee85" target="_blank" title="https://pan.quark.cn/s/4459235fee85" ref="nofollow noopener noreferrer">pan.quark.cn/s/4459235feâ€¦</a></p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”µå­å‘ç¥¨è§£æå·¥å…·-golangæœåŠ¡ç«¯å¼€å‘æ¡ˆä¾‹è¯¦è§£]]></title>    <link>https://juejin.cn/post/7570648023110959142</link>    <guid>https://juejin.cn/post/7570648023110959142</guid>    <pubDate>2025-11-10T07:11:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570648023110959142" data-draft-id="7570491473034035209" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”µå­å‘ç¥¨è§£æå·¥å…·-golangæœåŠ¡ç«¯å¼€å‘æ¡ˆä¾‹è¯¦è§£"/> <meta itemprop="keywords" content="Go"/> <meta itemprop="datePublished" content="2025-11-10T07:11:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å…‰å¤´é—ªäº®äº®"/> <meta itemprop="url" content="https://juejin.cn/user/1333047014199326"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”µå­å‘ç¥¨è§£æå·¥å…·-golangæœåŠ¡ç«¯å¼€å‘æ¡ˆä¾‹è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1333047014199326/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å…‰å¤´é—ªäº®äº®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T07:11:05.000Z" title="Mon Nov 10 2025 07:11:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»27åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç”µå­å‘ç¥¨è§£æå·¥å…·-golangæœåŠ¡ç«¯å¼€å‘æ¡ˆä¾‹è¯¦è§£</h2>
<h3 data-id="heading-1">1. é¡¹ç›®ç»“æ„</h3>
<p>æœ¬é¡¹ç›®æ˜¯ä¸Šä¸€ç¯‡ã€# ç”µå­å‘ç¥¨è§£æå·¥å…·-c#æ¡Œé¢åº”ç”¨å¼€å‘æ¡ˆä¾‹è¯¦è§£ã€‘çš„æœåŠ¡ç«¯å¼€å‘æ¡ˆä¾‹è¯¦è§£ï¼Œé‡‡ç”¨MVCæ¶æ„æ¨¡å¼è®¾è®¡ï¼Œä¸»è¦æä¾›ç”µå­å‘ç¥¨OCRè¯†åˆ«ã€PDF/OFDæ–‡ä»¶é¢„è§ˆç­‰åŠŸèƒ½ã€‚é¡¹ç›®ç»“æ„æ¸…æ™°ï¼Œå„æ¨¡å—èŒè´£åˆ†æ˜ã€‚</p>
<p>é¡¹ç›®ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">â”œâ”€â”€ main.go              <span class="hljs-comment"># ä¸»ç¨‹åºå…¥å£æ–‡ä»¶</span>
â”œâ”€â”€ config/              <span class="hljs-comment"># é…ç½®ç›¸å…³ç›®å½•</span>
â”‚   â””â”€â”€ config.go        <span class="hljs-comment"># é…ç½®åŠ è½½ä¸è§£æ</span>
â”œâ”€â”€ controller/          <span class="hljs-comment"># æ§åˆ¶å™¨å±‚ï¼Œå¤„ç†è¯·æ±‚</span>
â”‚   â”œâ”€â”€ api/             <span class="hljs-comment"># APIæ§åˆ¶å™¨</span>
â”‚   â””â”€â”€ <span class="hljs-built_in">test</span>/            <span class="hljs-comment"># æµ‹è¯•æ§åˆ¶å™¨</span>
â”œâ”€â”€ datasource/          <span class="hljs-comment"># æ•°æ®æºè¿æ¥</span>
â”‚   â””â”€â”€ engine.go        <span class="hljs-comment"># æ•°æ®åº“å¼•æ“åˆå§‹åŒ–</span>
â”œâ”€â”€ inference/           <span class="hljs-comment"># OCRæ¨¡å‹å’Œé…ç½®</span>
â”œâ”€â”€ logger/              <span class="hljs-comment"># æ—¥å¿—ç³»ç»Ÿ</span>
â”‚   â””â”€â”€ log.go           <span class="hljs-comment"># æ—¥å¿—å¤„ç†é€»è¾‘</span>
â”œâ”€â”€ model/               <span class="hljs-comment"># æ•°æ®æ¨¡å‹</span>
â”œâ”€â”€ service/             <span class="hljs-comment"># æœåŠ¡å±‚ï¼Œä¸šåŠ¡é€»è¾‘</span>
â”œâ”€â”€ static/              <span class="hljs-comment"># é™æ€èµ„æºæ–‡ä»¶</span>
â”‚   â”œâ”€â”€ css/             <span class="hljs-comment"># æ ·å¼æ–‡ä»¶</span>
â”‚   â”œâ”€â”€ js/              <span class="hljs-comment"># JavaScriptæ–‡ä»¶</span>
â”‚   â””â”€â”€ views/           <span class="hljs-comment"># HTMLè§†å›¾æ–‡ä»¶</span>
â””â”€â”€ utils/               <span class="hljs-comment"># å·¥å…·å‡½æ•°</span>
</code></pre>
<p>ä¸»è¦æ¨¡å—èŒè´£ï¼š</p>
<ul>
<li><strong>main.go</strong>ï¼šåº”ç”¨ç¨‹åºå…¥å£ï¼Œåˆå§‹åŒ–é…ç½®ã€ä¸­é—´ä»¶ã€è·¯ç”±æ³¨å†Œç­‰</li>
<li><strong>config/</strong>ï¼šå¤„ç†åº”ç”¨é…ç½®ï¼ŒåŒ…æ‹¬æ•°æ®åº“è¿æ¥ã€æœåŠ¡å™¨ç«¯å£ç­‰</li>
<li><strong>controller/</strong>ï¼šå¤„ç†HTTPè¯·æ±‚ï¼Œè°ƒç”¨ç›¸åº”çš„æœåŠ¡å±‚é€»è¾‘</li>
<li><strong>datasource/</strong>ï¼šè´Ÿè´£æ•°æ®åº“è¿æ¥å’Œä¼šè¯ç®¡ç†</li>
<li><strong>inference/</strong>ï¼šå­˜æ”¾PaddleOCRæ¨¡å‹æ–‡ä»¶å’Œé…ç½®</li>
<li><strong>logger/</strong>ï¼šå®ç°æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œæ”¯æŒæ–‡ä»¶æ—¥å¿—</li>
<li><strong>static/</strong>ï¼šå­˜æ”¾å‰ç«¯é™æ€èµ„æºï¼ŒåŒ…æ‹¬Vue3ç›¸å…³æ–‡ä»¶å’ŒHTMLè§†å›¾</li>
</ul>
<h3 data-id="heading-2">2. é¡¹ç›®åº”ç”¨æŠ€æœ¯æ¶æ„åŠåº”ç”¨åŒ…ä»‹ç»</h3>
<h4 data-id="heading-3">2.1 æŠ€æœ¯æ ˆæ¦‚è¿°</h4>
<p>æœ¬é¡¹ç›®é‡‡ç”¨ç°ä»£åŒ–çš„æŠ€æœ¯æ ˆæ„å»ºï¼Œä¸»è¦åŒ…æ‹¬ï¼š</p>













































<table><thead><tr><th>æŠ€æœ¯/æ¡†æ¶</th><th>ç‰ˆæœ¬/æ¥æº</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td>Go</td><td>-</td><td>ä¸»è¦å¼€å‘è¯­è¨€</td></tr><tr><td>Iris</td><td>v12</td><td>Webæ¡†æ¶</td></tr><tr><td>PaddleOCR</td><td>-</td><td>å…‰å­¦å­—ç¬¦è¯†åˆ«</td></tr><tr><td>Vue3</td><td>-</td><td>å‰ç«¯æ¡†æ¶</td></tr><tr><td>XORM</td><td>-</td><td>ORMæ¡†æ¶</td></tr><tr><td>MSSQL</td><td>-</td><td>æ•°æ®åº“</td></tr><tr><td>Zap</td><td>-</td><td>æ—¥å¿—åº“</td></tr></tbody></table>
<h4 data-id="heading-4">2.2 é¡¹ç›®åŒ…å¼•ç”¨åˆ—è¡¨åŠæ ¸å¿ƒæŠ€æœ¯åŒ…ä»‹ç»</h4>
<h4 data-id="heading-5">2.2.1 å¼•ç”¨åŒ…åˆ—è¡¨</h4>
<p>ä»¥ä¸‹æ˜¯é¡¹ç›®ä¸­ä¸»è¦å¼•ç”¨çš„åŒ…åˆ—è¡¨ï¼ŒæŒ‰åŠŸèƒ½æ¨¡å—åˆ†ç±»ï¼š</p>
<h5 data-id="heading-6">1. åŸºç¡€åŠŸèƒ½åŒ…</h5>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">import</span> (
    <span class="hljs-string">"encoding/base64"</span>  <span class="hljs-comment">// Base64ç¼–ç è§£ç å¤„ç†</span>
    <span class="hljs-string">"fmt"</span>               <span class="hljs-comment">// æ ¼å¼åŒ–è¾“å‡º</span>
    <span class="hljs-string">"io/ioutil"</span>         <span class="hljs-comment">// æ–‡ä»¶è¯»å†™æ“ä½œ</span>
    <span class="hljs-string">"net/http"</span>          <span class="hljs-comment">// HTTPç½‘ç»œé€šä¿¡</span>
    <span class="hljs-string">"os"</span>                <span class="hljs-comment">// æ“ä½œç³»ç»Ÿæ¥å£</span>
    <span class="hljs-string">"os/exec"</span>           <span class="hljs-comment">// æ‰§è¡Œå¤–éƒ¨å‘½ä»¤</span>
    <span class="hljs-string">"path/filepath"</span>     <span class="hljs-comment">// æ–‡ä»¶è·¯å¾„å¤„ç†</span>
    <span class="hljs-string">"strconv"</span>           <span class="hljs-comment">// å­—ç¬¦ä¸²ä¸åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢</span>
    <span class="hljs-string">"strings"</span>           <span class="hljs-comment">// å­—ç¬¦ä¸²å¤„ç†å‡½æ•°</span>
    <span class="hljs-string">"sync"</span>              <span class="hljs-comment">// å¹¶å‘æ§åˆ¶</span>
    <span class="hljs-string">"time"</span>              <span class="hljs-comment">// æ—¶é—´å¤„ç†</span>
    <span class="hljs-string">"io"</span>                <span class="hljs-comment">// è¾“å…¥è¾“å‡ºæ“ä½œ</span>
    <span class="hljs-string">"unicode"</span>           <span class="hljs-comment">// Unicodeå­—ç¬¦å¤„ç†</span>
)
</code></pre>
<h5 data-id="heading-7">2. Webæ¡†æ¶ä¸ä¸­é—´ä»¶</h5>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">import</span> (
    <span class="hljs-string">"github.com/kataras/iris/v12"</span>               <span class="hljs-comment">// ä¸»Webæ¡†æ¶</span>
    <span class="hljs-string">"github.com/kataras/iris/v12/context"</span>       <span class="hljs-comment">// Irisä¸Šä¸‹æ–‡</span>
    <span class="hljs-string">"github.com/kataras/iris/v12/middleware/logger"</span> <span class="hljs-comment">// æ—¥å¿—ä¸­é—´ä»¶</span>
    <span class="hljs-string">"github.com/kataras/iris/v12/mvc"</span>           <span class="hljs-comment">// MVCæ¶æ„æ”¯æŒ</span>
    <span class="hljs-string">"github.com/kataras/iris/v12/sessions"</span>      <span class="hljs-comment">// ä¼šè¯ç®¡ç†</span>
)
</code></pre>
<h5 data-id="heading-8">3. æ—¥å¿—ç³»ç»Ÿ</h5>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">import</span> (
    <span class="hljs-string">"go.uber.org/zap"</span>            <span class="hljs-comment">// é«˜æ€§èƒ½æ—¥å¿—åº“</span>
    mlog <span class="hljs-string">"invoiceServer/logger"</span>   <span class="hljs-comment">// è‡ªå®šä¹‰æ—¥å¿—æ¨¡å—</span>
)
</code></pre>
<h5 data-id="heading-9">4. æ•°æ®åº“ç›¸å…³</h5>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">import</span> (
    <span class="hljs-string">"github.com/denisenkom/go-mssqldb"</span> <span class="hljs-comment">// SQL Serveræ•°æ®åº“é©±åŠ¨</span>
    <span class="hljs-string">"github.com/go-sql-driver/mysql"</span>   <span class="hljs-comment">// MySQLæ•°æ®åº“é©±åŠ¨</span>
    <span class="hljs-string">"github.com/go-xorm/xorm"</span>          <span class="hljs-comment">// ORMæ¡†æ¶</span>
    <span class="hljs-string">"xorm.io/core"</span>                     <span class="hljs-comment">// XORMæ ¸å¿ƒåº“</span>
    <span class="hljs-string">"invoiceServer/datasource"</span>         <span class="hljs-comment">// è‡ªå®šä¹‰æ•°æ®æºæ¨¡å—</span>
)
</code></pre>
<h5 data-id="heading-10">5. å·¥å…·ç±»åº“</h5>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">import</span> (
    <span class="hljs-string">"github.com/olekukonko/tablewriter"</span> <span class="hljs-comment">// è¡¨æ ¼è¾“å‡ºæ ¼å¼åŒ–</span>
    <span class="hljs-string">"golang.org/x/exp/rand"</span>            <span class="hljs-comment">// æ‰©å±•éšæœºæ•°ç”Ÿæˆ</span>
    <span class="hljs-string">"golang.org/x/time/rate"</span>           <span class="hljs-comment">// é€Ÿç‡é™åˆ¶</span>
)
</code></pre>
<h5 data-id="heading-11">6. ç³»ç»Ÿè°ƒç”¨ä¸Cé›†æˆ</h5>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">import</span> (
    <span class="hljs-string">"syscall"</span> <span class="hljs-comment">// ç³»ç»Ÿè°ƒç”¨ï¼ˆç”¨äºè°ƒç”¨DLLï¼‰</span>
    <span class="hljs-string">"unsafe"</span>  <span class="hljs-comment">// ä¸å®‰å…¨æ“ä½œï¼ˆç”¨äºDLLæ¥å£è°ƒç”¨ï¼‰</span>
    <span class="hljs-string">"C"</span>       <span class="hljs-comment">// Cè¯­è¨€é›†æˆ</span>
)
</code></pre>
<h5 data-id="heading-12">7. é¡¹ç›®å†…éƒ¨åŒ…</h5>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">import</span> (
    <span class="hljs-string">"invoiceServer/config"</span>                 <span class="hljs-comment">// é…ç½®ç®¡ç†</span>
    apiController <span class="hljs-string">"invoiceServer/controller/api"</span> <span class="hljs-comment">// APIæ§åˆ¶å™¨</span>
    testController <span class="hljs-string">"invoiceServer/controller/test"</span> <span class="hljs-comment">// æµ‹è¯•æ§åˆ¶å™¨</span>
    testService <span class="hljs-string">"invoiceServer/service/test"</span> <span class="hljs-comment">// æµ‹è¯•æœåŠ¡</span>
)
</code></pre>
<p>ä»¥ä¸ŠåŒ…åˆ—è¡¨åŸºäºé¡¹ç›®ä¸­å®é™…å¼•ç”¨çš„ä¾èµ–ï¼Œä¸»è¦ç”¨äºå®ç°WebæœåŠ¡ã€OCRè¯†åˆ«ã€æ•°æ®åº“æ“ä½œã€æ—¥å¿—ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚</p>
<h5 data-id="heading-13">2.2.2 Iris Webæ¡†æ¶</h5>
<p>Irisæ˜¯ä¸€ä¸ªé«˜æ•ˆã€æ¨¡å—åŒ–ã€åŠŸèƒ½ä¸°å¯Œçš„Go Webæ¡†æ¶ï¼Œæä¾›äº†è·¯ç”±ã€ä¸­é—´ä»¶ã€è§†å›¾æ¨¡æ¿ç­‰å®Œæ•´çš„Webå¼€å‘åŠŸèƒ½ã€‚é¡¹ç›®ä¸­ä½¿ç”¨Irisæ„å»ºRESTful APIï¼Œå¤„ç†HTTPè¯·æ±‚å’Œå“åº”ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// Irisæ¡†æ¶åˆå§‹åŒ–ç¤ºä¾‹</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">newApp</span><span class="hljs-params">()</span></span> *iris.Application {
    <span class="hljs-comment">//æ–°å»ºirisæ¡†æ¶app</span>
    app := iris.New()
    <span class="hljs-comment">//æ³¨å†Œé™æ€èµ„æº</span>
    app.HandleDir(<span class="hljs-string">"."</span>, <span class="hljs-string">"./static"</span>)
    <span class="hljs-comment">//æ³¨å†Œè§†å›¾æ–‡ä»¶</span>
    tmpl := iris.HTML(<span class="hljs-string">"./static/views"</span>, <span class="hljs-string">".html"</span>)
    tmpl.Delims(<span class="hljs-string">"{{"</span>, <span class="hljs-string">"}}"</span>)
    tmpl.Reload(<span class="hljs-literal">true</span>)
    app.RegisterView(tmpl)
    <span class="hljs-comment">// å…¶ä»–é…ç½®...</span>
    <span class="hljs-keyword">return</span> app
}
</code></pre>
<h5 data-id="heading-14">2.2.3 PaddleOCR</h5>
<p>æœ¬é¡¹ç›®é€šè¿‡è°ƒç”¨PaddleOCR.dllåŠ¨æ€åº“å®ç°å‘ç¥¨å›¾åƒæ–‡å­—è¯†åˆ«åŠŸèƒ½ã€‚</p>
<ul>
<li>PaddleOCR.dllåŠ¨æ€åº“æ˜¯å¹¿å·è‹±ç”°ä¿¡æ¯ç§‘æŠ€æœ‰é™å…¬å¸åŸºäºç™¾åº¦å¼€æºçš„PaddleOCRå·¥å…·åº“å°è£…çš„äºŒæ¬¡å¼€å‘ç‰ˆæœ¬ï¼Œæ”¯æŒWindowså¹³å°ä¸‹çš„Goè¯­è¨€è°ƒç”¨ã€‚</li>
<li>å¹¿å·è‹±ç”°ä¿¡æ¯ç§‘æŠ€æœ‰é™å…¬å¸æä¾›ä¸“ä¸šçš„ç™¾åº¦å¼€æºçš„PaddleOCRå·¥å…·åº“å°è£…äºŒæ¬¡å¼€å‘æœåŠ¡ï¼Œæ”¯æŒå®šåˆ¶åŒ–éœ€æ±‚ã€‚</li>
<li>æœ¬é¡¹ç›®ä¸­ä½¿ç”¨çš„æ˜¯cpuå…è´¹ç‰ˆæœ¬çš„PaddleOCRï¼Œå¦‚éœ€è¦å®šåˆ¶åŒ–éœ€æ±‚ï¼Œå¯è‡ªè¡Œè”ç³»å¹¿å·è‹±ç”°ä¿¡æ¯ç§‘æŠ€æœ‰é™å…¬å¸ï¼Œè´­ä¹°åŠ é€Ÿç‰ˆæœ¬ã€‚</li>
</ul>

<pre><code class="hljs language-arduino" lang="arduino">å¹¿å·è‹±ç”°ä¿¡æ¯ç§‘æŠ€æœ‰é™å…¬å¸                  
https:<span class="hljs-comment">//www.yingtianit.com/               </span>
QQç¾¤ï¼š<span class="hljs-number">318860399</span> å®šåˆ¶å¼€å‘QQï¼š<span class="hljs-number">277784829</span>         
</code></pre>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// PaddleOCRåˆå§‹åŒ–ç¤ºä¾‹</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span> {
    dll, _ := syscall.LoadDLL(<span class="hljs-string">"PaddleOCR.dll"</span>)        <span class="hljs-comment">//åŠ è½½PaddleOCR.dllåŠ¨æ€åº“æ–‡ä»¶</span>
    Initjson, _ := dll.FindProc(<span class="hljs-string">"Initializejson"</span>)     <span class="hljs-comment">//æŸ¥æ‰¾åŠ¨æ€åº“çš„æ¥å£å‡½æ•°</span>
    detect, _ := dll.FindProc(<span class="hljs-string">"Detect"</span>)                <span class="hljs-comment">//æŸ¥æ‰¾åŠ¨æ€åº“çš„æ¥å£å‡½æ•°</span>
    <span class="hljs-comment">// è¯»å–é…ç½®æ–‡ä»¶</span>
    jsonconfig, err := ioutil.ReadFile(root + <span class="hljs-string">"\\inference\\PaddleOCR.config.json"</span>)
    <span class="hljs-comment">// åˆå§‹åŒ–PaddleOCR</span>
    Initjson.Call(strPtr(root+<span class="hljs-string">"\\inference\\ch_PP-OCRv4_det_infer"</span>),
        strPtr(root+<span class="hljs-string">"\\inference\\ch_ppocr_mobile_v2.0_cls_infer"</span>),
        strPtr(root+<span class="hljs-string">"\\inference\\ch_PP-OCRv4_rec_infer"</span>),
        strPtr(root+<span class="hljs-string">"\\inference\\ppocr_keys.txt"</span>), strPtr(<span class="hljs-type">string</span>(jsonconfig)))
}
</code></pre>
<h5 data-id="heading-15">2.2.4 XORM</h5>
<p>XORMæ˜¯ä¸€ä¸ªç®€å•è€Œå¼ºå¤§çš„Goè¯­è¨€ORMåº“ï¼Œæ”¯æŒå¤šç§æ•°æ®åº“ã€‚é¡¹ç›®ä¸­ä½¿ç”¨XORMä¸MSSQLæ•°æ®åº“è¿›è¡Œäº¤äº’ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// XORMåˆå§‹åŒ–ç¤ºä¾‹</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewMsSqlEngine</span><span class="hljs-params">()</span></span> *xorm.Engine {
    <span class="hljs-comment">//è·å–é…ç½®</span>
    initConfig := config.InitConfig()
    database := initConfig.DbMsSql2008
    <span class="hljs-comment">//æ„å»ºè¿æ¥å­—ç¬¦ä¸²</span>
    dataSourceName := <span class="hljs-string">"server="</span> + database.Host + <span class="hljs-string">";database="</span> + database.Database + <span class="hljs-string">";user id="</span> + database.User + <span class="hljs-string">";password="</span> + database.Pwd + <span class="hljs-string">";port="</span> + database.Port + <span class="hljs-string">";encrypt=disable"</span>
    <span class="hljs-comment">//åˆ›å»ºæ•°æ®åº“å¼•æ“</span>
    engine, err := xorm.NewEngine(database.Drive, dataSourceName)
    <span class="hljs-comment">//é…ç½®è¿æ¥æ± </span>
    engine.SetMaxOpenConns(<span class="hljs-number">2000</span>)
    engine.SetMaxIdleConns(<span class="hljs-number">1000</span>)
    engine.SetConnMaxLifetime(<span class="hljs-number">60</span>)
    <span class="hljs-keyword">return</span> engine
}
</code></pre>
<h5 data-id="heading-16">2.2.5 Zapæ—¥å¿—åº“</h5>
<p>Zapæ˜¯Uberå¼€æºçš„é«˜æ€§èƒ½æ—¥å¿—åº“ï¼Œæä¾›ç»“æ„åŒ–æ—¥å¿—è®°å½•åŠŸèƒ½ã€‚é¡¹ç›®ä¸­ä½¿ç”¨Zapè®°å½•ç³»ç»Ÿè¿è¡Œæ—¥å¿—ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// Zapæ—¥å¿—åˆå§‹åŒ–ç¤ºä¾‹</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">InitLogger</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">var</span> err <span class="hljs-type">error</span>
    Logger, err = zap.NewProduction()
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-built_in">panic</span>(err)
    }
}
</code></pre>
<h3 data-id="heading-17">3. é¡¹ç›®åŠŸèƒ½è°ƒç”¨æµç¨‹å›¾</h3>
<h4 data-id="heading-18">3.1 PDF/OFDæ–‡ä»¶åœ¨çº¿é¢„è§ˆæµç¨‹</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[å®¢æˆ·ç«¯è¯·æ±‚PDF/OFDé¢„è§ˆé¡µé¢] --&gt; B[æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚]
    B --&gt; C[è¿”å›PDF/OFDé¢„è§ˆHTMLé¡µé¢]
    C --&gt; D[å‰ç«¯åŠ è½½PDF.js/OFD.jsåº“]
    D --&gt; E[å‘é€æ–‡ä»¶è¯·æ±‚]
    E --&gt; F[æœåŠ¡å™¨è¿”å›æ–‡ä»¶å†…å®¹]
    F --&gt; G[å‰ç«¯æ¸²æŸ“å¹¶æ˜¾ç¤ºæ–‡ä»¶]
</code></pre>
<h4 data-id="heading-19">3.2 æ¥æ”¶å›¾ç‰‡å¹¶è°ƒç”¨PaddleOCRè§£ææµç¨‹</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[å®¢æˆ·ç«¯ä¸Šä¼ å›¾ç‰‡/Base64æ•°æ®] --&gt; B[æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚]
    B --&gt; C{æ•°æ®æ ¼å¼}
    C --&gt;|Base64| D[è§£ç Base64æ•°æ®]
    C --&gt;|æ–‡ä»¶| E[ä¿å­˜ä¸´æ—¶æ–‡ä»¶]
    D --&gt; F[åˆ›å»ºä¸´æ—¶æ–‡ä»¶]
    E --&gt; G[è¯»å–æ–‡ä»¶å†…å®¹]
    F --&gt; G
    G --&gt; H[è°ƒç”¨PaddleOCR.dllè¿›è¡Œè¯†åˆ«]
    H --&gt; I[å¤„ç†è¯†åˆ«ç»“æœ]
    I --&gt; J[è¿”å›JSONæ ¼å¼ç»“æœ]
</code></pre>
<p/>
<h3 data-id="heading-20">4. é¡¹ç›®è¿è¡Œæ•ˆæœå›¾</h3>
<p>è¿™é‡Œæ˜¯é¡¹ç›®è¿è¡Œæ•ˆæœå›¾</p>
<ol>
<li>****ï¼šæœåŠ¡å¯åŠ¨</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/21511001da3541c599b6a58ad6ac4645~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWJ5aS06Zeq5Lqu5Lqu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763364433&amp;x-signature=IFKokMsUXhOFUPz8Byd0ylGt1uU%3D" alt="å¯åŠ¨.PNG" loading="lazy"/>
2. <strong>ä¸»é¡µé¢</strong>ï¼šå±•ç¤ºhtmlä¸­vue3.jsæ–‡ä»¶å¼•ç”¨å®ç°ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢ç•Œé¢ï¼Œæ”¯æŒæŒ‰IDã€åç§°ã€é‚®ç®±æœç´¢ç”¨æˆ·ä¿¡æ¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4f4ab15007f477fb1730786e3279941~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWJ5aS06Zeq5Lqu5Lqu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763364433&amp;x-signature=vYTat57bY7UsLsSXzxo6UW9x%2FmU%3D" alt="index.PNG" loading="lazy"/>
3. <strong>PDF/OFDé¢„è§ˆé¡µé¢</strong>ï¼šæ”¯æŒåœ¨çº¿é¢„è§ˆPDFå’ŒOFDæ ¼å¼çš„ç”µå­å‘ç¥¨æ–‡ä»¶ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/762285a44e4e48949be63aae23cd3c21~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWJ5aS06Zeq5Lqu5Lqu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763364433&amp;x-signature=GE5dSIhoCFE2V3LhPx2xeZHzhP4%3D" alt="pdfview.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1478e6fdf0a4eab9c731cfd4ec3286c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWJ5aS06Zeq5Lqu5Lqu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763364433&amp;x-signature=dTh9yVNQzellDjLoJ%2FcDFDM9kjI%3D" alt="ofdview.png" loading="lazy"/>
4. <strong>OCRè¯†åˆ«åŠŸèƒ½</strong>ï¼šæ¥æ”¶å›¾ç‰‡æˆ–Base64æ•°æ®ï¼Œè°ƒç”¨PaddleOCRè¿›è¡Œæ–‡å­—è¯†åˆ«å¹¶è¿”å›ç»“æœã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a2fec3fdd964b769a74c870364ca91b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWJ5aS06Zeq5Lqu5Lqu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763364433&amp;x-signature=6GwIPUsgbjK9nflOhkrG7ddTBZQ%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-21">5. æ ¸å¿ƒåŠŸèƒ½ä»£ç ç¤ºä¾‹</h3>
<h4 data-id="heading-22">5.1 PDF/OFDæ–‡ä»¶åœ¨çº¿é¢„è§ˆ</h4>
<p><strong>æœåŠ¡ç«¯è·¯ç”±é…ç½®</strong>ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// PDFé¢„è§ˆè·¯ç”±</span>
app.Get(<span class="hljs-string">"/pdfbrower"</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx iris.Context)</span></span> {
    mlog.WriteLog(ctx, <span class="hljs-string">"pdfobject.html"</span>)
    ctx.View(<span class="hljs-string">"pdfobject.html"</span>)
})

<span class="hljs-comment">// OFDé¢„è§ˆè·¯ç”±</span>
app.Get(<span class="hljs-string">"/ofdbrower"</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx iris.Context)</span></span> {
    mlog.WriteLog(ctx, <span class="hljs-string">"ofd.html"</span>)
    ctx.View(<span class="hljs-string">"ofd.html"</span>)
})
</code></pre>
<p><strong>æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½</strong>ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// æ–‡ä»¶ä¸Šä¼ æ¥å£</span>
app.Post(<span class="hljs-string">"/uploadbrowerfile"</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx iris.Context)</span></span> {
    <span class="hljs-comment">// è·å–ä¸Šä¼ çš„æ–‡ä»¶</span>
    file, info, err := ctx.FormFile(<span class="hljs-string">"file"</span>)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        ctx.StatusCode(iris.StatusBadRequest)
        ctx.JSON(iris.Map{<span class="hljs-string">"error"</span>: <span class="hljs-string">"è·å–æ–‡ä»¶å¤±è´¥: "</span> + err.Error()})
        <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">defer</span> file.Close()

    <span class="hljs-comment">// è·å–æ–‡ä»¶æ‰©å±•å</span>
    ext := filepath.Ext(info.Filename)
    <span class="hljs-keyword">if</span> ext == <span class="hljs-string">""</span> {
        ctx.StatusCode(iris.StatusBadRequest)
        ctx.JSON(iris.Map{<span class="hljs-string">"error"</span>: <span class="hljs-string">"æ–‡ä»¶æ²¡æœ‰æ‰©å±•å"</span>})
        <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// æ„é€ ç›®æ ‡æ–‡ä»¶è·¯å¾„</span>
    targetFilename := ext[<span class="hljs-number">1</span>:] + ext <span class="hljs-comment">// å»æ‰å¼€å¤´çš„ç‚¹ï¼Œä¾‹å¦‚ "pdf" + ".pdf"</span>
    targetPath := filepath.Join(tempDir, targetFilename)

    <span class="hljs-comment">// åˆ›å»ºç›®æ ‡æ–‡ä»¶</span>
    out, err := os.Create(targetPath)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        ctx.StatusCode(iris.StatusInternalServerError)
        ctx.JSON(iris.Map{<span class="hljs-string">"error"</span>: <span class="hljs-string">"åˆ›å»ºç›®æ ‡æ–‡ä»¶å¤±è´¥: "</span> + err.Error()})
        <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">defer</span> out.Close()

    <span class="hljs-comment">// å¤åˆ¶æ–‡ä»¶å†…å®¹</span>
    _, err = io.Copy(out, file)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        ctx.StatusCode(iris.StatusInternalServerError)
        ctx.JSON(iris.Map{<span class="hljs-string">"error"</span>: <span class="hljs-string">"ä¿å­˜æ–‡ä»¶å¤±è´¥: "</span> + err.Error()})
        <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// è¿”å›æˆåŠŸä¿¡æ¯</span>
    ctx.JSON(iris.Map{
        <span class="hljs-string">"message"</span>: <span class="hljs-string">"æ–‡ä»¶ä¸Šä¼ æˆåŠŸ"</span>,
        <span class="hljs-string">"file"</span>:    targetFilename,
        <span class="hljs-string">"path"</span>:    targetPath,
    })
})
</code></pre>
<p><strong>HTMLä»£ç pdfobject.html</strong>:</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>PDF Embed with Timestamp<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100%; height: 1024px;"</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">embed</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"pdf-embed"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"application/pdf"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"100%"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"100%"</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

	<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
		<span class="hljs-keyword">const</span> timestamp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>(); <span class="hljs-comment">// è·å–å½“å‰æ—¶é—´æˆ³  </span>
		<span class="hljs-keyword">const</span> pdfUrl = <span class="hljs-string">`./tempData/pdf.pdf?t=<span class="hljs-subst">${timestamp}</span>`</span>; <span class="hljs-comment">// æ„é€ å¸¦æ—¶é—´æˆ³çš„ URL  </span>
		<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'pdf-embed'</span>).<span class="hljs-property">src</span> = pdfUrl; <span class="hljs-comment">// è®¾ç½® embed çš„ src  </span>
	</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><strong>HTMLä»£ç ofd.html</strong>:</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ä¸€ä¸ªç®€æ˜“çš„æ’åºæŒ‰é’®<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"../js/ofd.umd.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-class">.hidden</span> {
            <span class="hljs-attribute">display</span>: none;
            <span class="hljs-comment">/* æˆ–è€…ä½¿ç”¨ visibility: hidden; */</span>
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"file"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"file-input"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"hidden"</span> <span class="hljs-attr">accept</span>=<span class="hljs-string">".ofd"</span> <span class="hljs-attr">onchange</span>=<span class="hljs-string">"fileChanged(event)"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"ofdContainer"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width:100%; height:800px;"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-comment">// é»˜è®¤æ–‡ä»¶å  </span>
        <span class="hljs-comment">// const defaultFileName = './tempData/ofd.ofd';</span>
        <span class="hljs-comment">// ä½¿ç”¨æ—¶é—´æˆ³æˆ–éšæœºæ•°æ„é€ æ–°çš„URL  </span>
        <span class="hljs-keyword">const</span> timestamp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>(); <span class="hljs-comment">// æˆ–è€…ä½¿ç”¨ Math.random()  </span>
        <span class="hljs-keyword">const</span> defaultFileName = <span class="hljs-string">`./tempData/ofd.ofd?t=<span class="hljs-subst">${timestamp}</span>`</span>; <span class="hljs-comment">// æ·»åŠ æ—¶é—´æˆ³  </span>
        <span class="hljs-comment">// é»˜è®¤æ–‡ä»¶å</span>
        <span class="hljs-comment">// é»˜è®¤æ–‡ä»¶åä» URL æŸ¥è¯¢å‚æ•°ä¸­è·å–  </span>
        <span class="hljs-comment">//const urlParams = new URLSearchParams(window.location.search);  </span>
        <span class="hljs-comment">//const defaultFileName = urlParams.get('file');  // é»˜è®¤å€¼ä¸º 'ofd5.ofd'  </span>

        <span class="hljs-comment">// åœ¨é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨åŠ è½½é»˜è®¤çš„ OFD æ–‡ä»¶  </span>

        <span class="hljs-comment">// é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨åŠ è½½é»˜è®¤çš„ OFD æ–‡ä»¶  </span>

        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fileChanged</span>(<span class="hljs-params">e</span>) {
            <span class="hljs-comment">// è·å–æ–‡ä»¶æ•°æ®  </span>
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">files</span>[<span class="hljs-number">0</span>]);
            <span class="hljs-keyword">const</span> file = e.<span class="hljs-property">target</span>.<span class="hljs-property">files</span>[<span class="hljs-number">0</span>];
            <span class="hljs-comment">// const file = fileName;</span>

            <span class="hljs-keyword">if</span> (!file) {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ²¡æœ‰é€‰æ‹©æ–‡ä»¶'</span>);
                <span class="hljs-keyword">return</span>;
            }

            <span class="hljs-comment">// è½¬æ¢ OFD æ–‡æ¡£  </span>
            ofd.<span class="hljs-title function_">parseOfdDocument</span>({
                <span class="hljs-attr">ofd</span>: file,
                <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) {
                    <span class="hljs-keyword">const</span> screenWidth = <span class="hljs-number">800</span>;
                    <span class="hljs-keyword">const</span> ofdRenderRes = ofd.<span class="hljs-title function_">renderOfd</span>(screenWidth, res[<span class="hljs-number">0</span>]);
                    <span class="hljs-keyword">let</span> ofdContainerDiv = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'ofdContainer'</span>);
                    ofdContainerDiv.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">''</span>; <span class="hljs-comment">// æ¸…ç©ºä¹‹å‰çš„å†…å®¹  </span>
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> ofdRenderRes) {
                        ofdContainerDiv.<span class="hljs-title function_">appendChild</span>(item);
                    }
                },
                <span class="hljs-attr">fail</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) {
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ofdæ–‡ä»¶æ¸²æŸ“å¤±è´¥'</span>, err);
                }
            });
        }

        <span class="hljs-comment">// é€šè¿‡ JavaScript è¯»å–é»˜è®¤æ–‡ä»¶å¹¶åŠ å…¥ input  </span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadDefaultFile</span>(<span class="hljs-params"/>) {
            <span class="hljs-title function_">fetch</span>(defaultFileName)
                .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.<span class="hljs-title function_">blob</span>())
                .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">blob</span> =&gt;</span> {
                    <span class="hljs-keyword">const</span> file = <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>([blob], defaultFileName, { <span class="hljs-attr">type</span>: <span class="hljs-string">'application/vnd.oasis.opendocument.text'</span> });
                    <span class="hljs-keyword">const</span> event = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Event</span>(<span class="hljs-string">'change'</span>); <span class="hljs-comment">// åˆ›å»ºchangeäº‹ä»¶  </span>
                    <span class="hljs-keyword">const</span> input = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'file-input'</span>);
                    <span class="hljs-keyword">const</span> dataTransfer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataTransfer</span>();
                    dataTransfer.<span class="hljs-property">items</span>.<span class="hljs-title function_">add</span>(file);
                    input.<span class="hljs-property">files</span> = dataTransfer.<span class="hljs-property">files</span>; <span class="hljs-comment">// å°†æ–‡ä»¶åˆ†é…ç»™æ–‡ä»¶è¾“å…¥  </span>
                    input.<span class="hljs-title function_">dispatchEvent</span>(event); <span class="hljs-comment">// æ‰‹åŠ¨è§¦å‘changeäº‹ä»¶  </span>
                })
                .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åŠ è½½é»˜è®¤æ–‡ä»¶å¤±è´¥'</span>, err);
                });
        }

        <span class="hljs-comment">// fileChanged(fileChanged);</span>
        <span class="hljs-title function_">loadDefaultFile</span>(); <span class="hljs-comment">// é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è°ƒç”¨è¯¥å‡½æ•°  </span>
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h4 data-id="heading-23">5.2 PaddleOCRå‘ç¥¨è¯†åˆ«åŠŸèƒ½</h4>
<p><strong>OCRåˆå§‹åŒ–ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">var</span> detect *syscall.Proc
<span class="hljs-keyword">var</span> tempDir <span class="hljs-type">string</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// åŠ è½½PaddleOCR.dllåŠ¨æ€åº“</span>
    dll, _ := syscall.LoadDLL(<span class="hljs-string">"PaddleOCR.dll"</span>)
    <span class="hljs-comment">// æŸ¥æ‰¾åˆå§‹åŒ–å‡½æ•°</span>
    Initjson, _ := dll.FindProc(<span class="hljs-string">"Initializejson"</span>)
    detect, _ := dll.FindProc(<span class="hljs-string">"Detect"</span>)
    enableANSI, _ := dll.FindProc(<span class="hljs-string">"EnableANSIResult"</span>)
    enableJson, _ := dll.FindProc(<span class="hljs-string">"EnableJsonResult"</span>)
    <span class="hljs-comment">// è·å–å½“å‰ç›®å½•</span>
    root := getCurrentAbPathBywd()

    <span class="hljs-comment">// è¯»å–é…ç½®æ–‡ä»¶</span>
    jsonconfig, err := ioutil.ReadFile(root + <span class="hljs-string">"\\inference\\PaddleOCR.config.json"</span>)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        fmt.Println(err)
    }

    <span class="hljs-comment">// è°ƒç”¨åˆå§‹åŒ–æ–¹æ³•ï¼Œä¼ å…¥æ¨¡å‹è·¯å¾„å’Œé…ç½®</span>
    Initjson.Call(strPtr(root+<span class="hljs-string">"\\inference\\ch_PP-OCRv4_det_infer"</span>),
        strPtr(root+<span class="hljs-string">"\\inference\\ch_ppocr_mobile_v2.0_cls_infer"</span>),
        strPtr(root+<span class="hljs-string">"\\inference\\ch_PP-OCRv4_rec_infer"</span>),
        strPtr(root+<span class="hljs-string">"\\inference\\ppocr_keys.txt"</span>), strPtr(<span class="hljs-type">string</span>(jsonconfig)))

    <span class="hljs-comment">// å¯ç”¨ANSIç¼–ç è¿”å›ç»“æœ</span>
    enableANSI.Call(<span class="hljs-number">1</span>) <span class="hljs-comment">// 0: Unicodeç¼–ç , 1: ANSIç¼–ç </span>
    enableJson.Call(<span class="hljs-number">0</span>) <span class="hljs-comment">// 0: è¿”å›çº¯å­—ç¬¦ä¸²ç»“æœ, 1: è¿”å›JSONå­—ç¬¦ä¸²ç»“æœ</span>
}
</code></pre>
<p/>
<p><strong>OCRè¯†åˆ«å®ç°</strong>ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// OcrData è°ƒç”¨PaddleOCRè¿›è¡Œè¯†åˆ«</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">OcrData</span><span class="hljs-params">(file *os.File)</span></span> (<span class="hljs-type">string</span>, <span class="hljs-type">error</span>) {
    start := time.Now() <span class="hljs-comment">// è®°å½•å¼€å§‹æ—¶é—´</span>
    <span class="hljs-comment">// è°ƒç”¨PaddleOCRçš„Detectæ–¹æ³•è¿›è¡Œè¯†åˆ«</span>
    res, _, _ := detect.Call(strPtr(file.Name()))
    <span class="hljs-comment">// å°†Cå­—ç¬¦ä¸²è½¬æ¢ä¸ºGoå­—ç¬¦ä¸²</span>
    p_result := (*C.char)(unsafe.Pointer(res))

    end := time.Now()         <span class="hljs-comment">// è®°å½•ç»“æŸæ—¶é—´</span>
    elapsed := end.Sub(start) <span class="hljs-comment">// è®¡ç®—æ‰§è¡Œæ—¶é—´</span>

    ocrresult := C.GoString(p_result)
    str_res := fmt.Sprintf(<span class="hljs-string">"%v"</span>, ocrresult)

    <span class="hljs-comment">// å¤„ç†ç»“æœï¼Œæ›¿æ¢æ¢è¡Œç¬¦ç­‰</span>
    str_res = strings.ReplaceAll(str_res, <span class="hljs-string">"\n"</span>, <span class="hljs-string">";"</span>)
    str_res = strings.ReplaceAll(str_res, <span class="hljs-string">"\r"</span>, <span class="hljs-string">";"</span>)
    str_res = strings.ReplaceAll(str_res, <span class="hljs-string">"\t"</span>, <span class="hljs-string">";"</span>) <span class="hljs-comment">// æ›¿æ¢åˆ¶è¡¨ç¬¦</span>

    fmt.Printf(<span class="hljs-string">"------------------------------------------------------ã€%sã€‘è§£ææ—¶é—´ä¸ºï¼šã€%sã€‘\n"</span>, file.Name(), get_Time(elapsed))

    <span class="hljs-keyword">return</span> str_res, <span class="hljs-literal">nil</span>
}
</code></pre>
<p><strong>OCR APIæ¥å£</strong>ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// å®šä¹‰æ¥æ”¶å›¾ç‰‡ Base64 æ•°æ®çš„è·¯ç”±</span>
app.Post(<span class="hljs-string">"/ocr"</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx iris.Context)</span></span> {
    <span class="hljs-comment">// ä»è¯·æ±‚ä¸­è§£æ JSON æ•°æ®</span>
    <span class="hljs-keyword">if</span> err := ctx.ReadJSON(&amp;jpgData); err != <span class="hljs-literal">nil</span> {
        ctx.StatusCode(http.StatusBadRequest)
        ctx.JSON(iris.Map{<span class="hljs-string">"error"</span>: <span class="hljs-string">"Failed to parse JSON data"</span>})
        <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// è§£ç  Base64 æ•°æ®</span>
    decodedData, err := base64.StdEncoding.DecodeString(jpgData.Base64)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        ctx.StatusCode(http.StatusBadRequest)
        ctx.JSON(iris.Map{<span class="hljs-string">"error"</span>: <span class="hljs-string">"Failed to decode Base64 data"</span>})
        <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// åˆ›å»ºä¸´æ—¶æ–‡ä»¶ä¿å­˜å›¾ç‰‡</span>
    tempFile, err := ioutil.TempFile(<span class="hljs-string">""</span>, <span class="hljs-string">"*.jpg"</span>)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        ctx.StatusCode(http.StatusInternalServerError)
        ctx.JSON(iris.Map{<span class="hljs-string">"error"</span>: <span class="hljs-string">"Failed to create temporary file"</span>})
        <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">defer</span> os.Remove(tempFile.Name())
    <span class="hljs-keyword">defer</span> tempFile.Close()

    <span class="hljs-comment">// å°†è§£ç åçš„æ•°æ®å†™å…¥ä¸´æ—¶æ–‡ä»¶</span>
    <span class="hljs-keyword">if</span> _, err := tempFile.Write(decodedData); err != <span class="hljs-literal">nil</span> {
        ctx.StatusCode(http.StatusInternalServerError)
        ctx.JSON(iris.Map{<span class="hljs-string">"error"</span>: <span class="hljs-string">"Failed to write to temporary file"</span>})
        <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// è°ƒç”¨ PaddleOCR è¿›è¡Œè¯†åˆ«</span>
    ocrText, err := OcrData(tempFile)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        ctx.StatusCode(http.StatusInternalServerError)
        ctx.JSON(iris.Map{<span class="hljs-string">"error"</span>: fmt.Sprintf(<span class="hljs-string">"Failed to run PaddleOCR: %v"</span>, err)})
        <span class="hljs-keyword">return</span>
    }
    <span class="hljs-comment">// å¤„ç† PaddleOCR çš„è¾“å‡º</span>
    resultText := strings.TrimSpace(<span class="hljs-type">string</span>(ocrText))
    result := OCRResult{Text: resultText}
    tt := time.Now()
    mlog.WriteLog(ctx, fmt.Sprintf(<span class="hljs-string">"è§£ææ—¶é—´ï¼š%s è§£æå†…å®¹ï¼šã€%vã€‘"</span>, tt.Format(<span class="hljs-string">"2006-01-02 15:04:05"</span>), resultText))
    <span class="hljs-comment">// è¿”å› JSON æ ¼å¼çš„ç»“æœ</span>
    ctx.JSON(result)
})
</code></pre>
<h3 data-id="heading-24">6. ä¸»åº”ç”¨ç¨‹åºå…¥å£åŠä¸­é—´ä»¶è®¾ç½®</h3>
<h4 data-id="heading-25">6.1 åº”ç”¨ç¨‹åºå…¥å£</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// ç¡®ä¿ tempData æ–‡ä»¶å¤¹å­˜åœ¨</span>
    tempDir = <span class="hljs-string">"./tempData"</span>
    <span class="hljs-keyword">if</span> err := os.MkdirAll(tempDir, os.ModePerm); err != <span class="hljs-literal">nil</span> {
        <span class="hljs-built_in">panic</span>(fmt.Sprintf(<span class="hljs-string">"æ— æ³•åˆ›å»º tempData æ–‡ä»¶å¤¹: %v"</span>, err))
    }

    <span class="hljs-comment">// æ‰“å°å½“å‰æ—¶é—´ä¿¡æ¯</span>
    tt := time.Now()
    fmt.Printf(<span class="hljs-string">"å½“å‰æ—¶é—´:%s\n"</span>, tt.Format(<span class="hljs-string">"2006-01-02 15:04:05"</span>))
    mlog.WriteNotCtxLog(fmt.Sprintf(<span class="hljs-string">"MesServer API Server Start Time: %v"</span>, time.Now()))

    <span class="hljs-comment">// åˆå§‹åŒ–æœåŠ¡å™¨é…ç½®</span>
    config := config.InitConfig()
    <span class="hljs-comment">// åˆå§‹åŒ–æ—¥å¿—æ¨¡å—</span>
    mlog.InitLogger()
    <span class="hljs-comment">// åœ¨ç³»ç»Ÿåœæ­¢æ—¶è®°å½•æ—¥å¿—</span>
    <span class="hljs-keyword">defer</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">if</span> err := mlog.Logger.Sync(); err != <span class="hljs-literal">nil</span> {
            mlog.WriteNotCtxLog(fmt.Sprintf(<span class="hljs-string">"MesServer API Server Stop: %v"</span>, err))
        }
    }()

    <span class="hljs-comment">// åˆ›å»ºIrisåº”ç”¨</span>
    app := newApp()

    <span class="hljs-comment">// æ·»åŠ æ—¥å¿—ä¸­é—´ä»¶</span>
    app.Use(logger.New(
        logger.Config{
            Status: <span class="hljs-literal">true</span>,
            IP: <span class="hljs-literal">true</span>,
            Method: <span class="hljs-literal">true</span>,
            Path: <span class="hljs-literal">true</span>,
            Query: <span class="hljs-literal">true</span>,
            LogFunc: <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(endTime time.Time, latency time.Duration, status, ip, method, path <span class="hljs-type">string</span>, message <span class="hljs-keyword">interface</span>{}, headerMessage <span class="hljs-keyword">interface</span>{})</span></span> {
                <span class="hljs-comment">// æ—¥å¿—è®°å½•é€»è¾‘</span>
                <span class="hljs-comment">// ...</span>
            },
        }))

    <span class="hljs-comment">// è‡ªå®šä¹‰Recoverä¸­é—´ä»¶</span>
    app.Use(recoverMiddleware)
    <span class="hljs-comment">// è®¾ç½®è·¨åŸŸ</span>
    app.Use(Cors)
    <span class="hljs-comment">// åº”ç”¨é…ç½®</span>
    configation(app)
    <span class="hljs-comment">// è·¯ç”±è®¾ç½®</span>
    mvcHandle(app)

    <span class="hljs-comment">// è¾“å‡ºè·¯ç”±åˆ—è¡¨</span>
    routes := app.GetRoutes()
    table := tablewriter.NewWriter(os.Stdout)
    table.SetHeader([]<span class="hljs-type">string</span>{<span class="hljs-string">"è·¯ç”±è®¿é—®æ–¹å¼"</span>, <span class="hljs-string">"è®¿é—®åœ°å€"</span>, <span class="hljs-string">"æ‰§è¡Œå‡½æ•°"</span>})
    <span class="hljs-keyword">for</span> _, r := <span class="hljs-keyword">range</span> routes {
        method := r.Method
        path := r.FormattedPath
        funcName := r.MainHandlerName
        row := []<span class="hljs-type">string</span>{method, path, funcName}
        table.Append(row)
    }
    table.Render()

    <span class="hljs-comment">// è·å–é…ç½®ä¸­çš„IPåœ°å€å’Œç«¯å£å·</span>
    addr := config.Host + <span class="hljs-string">":"</span> + config.Port
    mlog.WriteNotCtxLog(fmt.Sprintf(<span class="hljs-string">"MesServer API Server Start: %v"</span>, addr))
    <span class="hljs-comment">// å¯åŠ¨æœåŠ¡</span>
    app.Run(
        iris.Addr(addr),
        iris.WithCharset(<span class="hljs-string">"UTF-8"</span>),
        iris.WithoutServerError(iris.ErrServerClosed),
        iris.WithOptimizations,
    )
}
</code></pre>
<h4 data-id="heading-26">6.2 ä¸­é—´ä»¶è®¾ç½®</h4>
<p><strong>Recoverä¸­é—´ä»¶</strong>ï¼šç”¨äºæ•è·panicå¹¶è¿”å›å‹å¥½é”™è¯¯ä¿¡æ¯</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// è‡ªå®šä¹‰Recoverä¸­é—´ä»¶</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">recoverMiddleware</span><span class="hljs-params">(ctx iris.Context)</span></span> {
    <span class="hljs-keyword">defer</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">if</span> r := <span class="hljs-built_in">recover</span>(); r != <span class="hljs-literal">nil</span> {
            <span class="hljs-comment">// è®°å½•å´©æºƒæ—¥å¿—</span>
            mlog.Logger.Error(<span class="hljs-string">"Recovered from panic"</span>, zap.Any(<span class="hljs-string">"error"</span>, r))

            <span class="hljs-comment">// å¼ºåˆ¶å†™å…¥æ—¥å¿—</span>
            mlog.LogToFile(fmt.Sprintf(<span class="hljs-string">"Recovered from panic: %v"</span>, r))

            <span class="hljs-comment">// è¿”å›ç”¨æˆ·å‹å¥½çš„é”™è¯¯ä¿¡æ¯</span>
            ctx.StatusCode(<span class="hljs-number">500</span>)
            ctx.JSON(iris.Map{<span class="hljs-string">"error"</span>: <span class="hljs-string">"Internal Server Error"</span>})
        }
    }()
    ctx.Next()
}
</code></pre>
<p><strong>æ—¥å¿—ä¸­é—´ä»¶</strong>ï¼šç”¨äºè®°å½•HTTPè¯·æ±‚æ—¥å¿—</p>
<pre><code class="hljs language-go" lang="go">app.Use(logger.New(
    logger.Config{
        <span class="hljs-comment">// æ˜¯å¦è®°å½•çŠ¶æ€ç </span>
        Status: <span class="hljs-literal">true</span>,
        <span class="hljs-comment">// æ˜¯å¦è®°å½•è¿œç¨‹IPåœ°å€</span>
        IP: <span class="hljs-literal">true</span>,
        <span class="hljs-comment">// æ˜¯å¦å‘ˆç°HTTPè°“è¯</span>
        Method: <span class="hljs-literal">true</span>,
        <span class="hljs-comment">// æ˜¯å¦è®°å½•è¯·æ±‚è·¯å¾„</span>
        Path: <span class="hljs-literal">true</span>,
        <span class="hljs-comment">// æ˜¯å¦å¼€å¯æŸ¥è¯¢è¿½åŠ </span>
        Query: <span class="hljs-literal">true</span>,
        LogFunc: <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(endTime time.Time, latency time.Duration, status, ip, method, path <span class="hljs-type">string</span>, message <span class="hljs-keyword">interface</span>{}, headerMessage <span class="hljs-keyword">interface</span>{})</span></span> {
            msg := <span class="hljs-string">"&lt;no message&gt;"</span> <span class="hljs-comment">// é»˜è®¤å€¼</span>
            <span class="hljs-keyword">if</span> message != <span class="hljs-literal">nil</span> {
                msg = fmt.Sprintf(<span class="hljs-string">"%v"</span>, message)
            }

            logMessage := fmt.Sprintf(
                <span class="hljs-string">"[%s] %s %s %s %s %d %s"</span>,
                endTime.Format(time.RFC3339),
                method,
                path,
                ip,
                status,
                latency,
                msg,
            )
            mlog.LogToFile(logMessage)
        },
    }))
</code></pre>
<h3 data-id="heading-27">7. Vue3ä¸Goå‰åç«¯å¼€å‘è®¾ç½®</h3>
<h4 data-id="heading-28">7.1 Vue3å‰ç«¯è®¾ç½®</h4>
<p>é¡¹ç›®ä¸­ä½¿ç”¨Vue3ä½œä¸ºå‰ç«¯æ¡†æ¶ï¼Œé€šè¿‡Axiosä¸Goåç«¯APIè¿›è¡Œäº¤äº’ã€‚ä»¥ä¸‹æ˜¯å‰ç«¯Vue3åº”ç”¨çš„å…³é”®è®¾ç½®ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"/&gt; --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"IE=edge,chrome=1"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- &lt;meta http-equiv="X-UA-Compatible" content="chrome=1"&gt; --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>myoa<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"../css/bootstrap.min.css"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"../js/polyfill.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"../js/browser.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"../js/bluebird.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"../js/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"../js/axios.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"../js/IPConfig.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"../js/html5shiv.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-tag">a</span> {
            <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">15px</span>;
            <span class="hljs-attribute">margin-top</span>: -<span class="hljs-number">10px</span>;
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container-fluid"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card border-info mb-3"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"margin-top: 20px;"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-header text-info"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>ç”¨æˆ·ä¿¡æ¯<span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-body text-info form-inline"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-row"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-group mb-2 mr-sm-2"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-group-prepend"</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-group-text text-info"</span>&gt;</span> Id <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"id"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"id"</span> <span class="hljs-attr">autocomplete</span>=<span class="hljs-string">"off"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-info"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:void(0)"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"id_query"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"button"</span>
                                @<span class="hljs-attr">click</span>=<span class="hljs-string">"search('id')"</span>&gt;</span>æœç´¢<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-group mb-2 mr-sm-2"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-group-prepend"</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-group-text text-info"</span>&gt;</span> Name <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">autocomplete</span>=<span class="hljs-string">"off"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-info"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:void(0)"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"name_query"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"button"</span>
                                @<span class="hljs-attr">click</span>=<span class="hljs-string">"search('name')"</span>&gt;</span>æœç´¢<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-group mb-2 mr-sm-2"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-group-prepend"</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-group-text text-info"</span>&gt;</span> Email <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"email"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"email"</span> <span class="hljs-attr">autocomplete</span>=<span class="hljs-string">"off"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-info"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:void(0)"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"email_query"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"button"</span>
                                @<span class="hljs-attr">click</span>=<span class="hljs-string">"search('email')"</span>&gt;</span>æœç´¢<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-row"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-info"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:void(0)"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"button"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"getList"</span>&gt;</span>å…¨éƒ¨<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>

                        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-success"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:void(0)"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"button"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"add"</span>&gt;</span>æ–°å¢<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>


                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"table table-striped table-bordered table-hover text-info"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">thead</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"thead-inverse"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Id<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Name<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Email<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Created On<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"item in users"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"item.id"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">"row"</span>&gt;</span>[item.id]<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>[item.name]<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>[item.email]<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>[item.createdTime]<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span>

    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">


        <span class="hljs-comment">// // request è¯·æ±‚æ‹¦æˆª</span>
        axios.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">request</span>) {
            <span class="hljs-comment">// å¯¹ request è¿›è¡Œæ‹¦æˆª</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>) {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è·³è½¬åˆ°ç™»å½•é¡µé¢'</span>)
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åå°æœåŠ¡åœ°å€ï¼š'</span>, <span class="hljs-variable constant_">URL</span>)
            }
            <span class="hljs-keyword">return</span> request;
        }, <span class="hljs-keyword">function</span> (<span class="hljs-params">error</span>) {
            <span class="hljs-comment">// åœ¨é”™è¯¯è¯·æ±‚æ—¶è¿›è¡Œæ“ä½œ</span>
            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);
        });

        <span class="hljs-comment">// response è¯·æ±‚æ‹¦æˆª</span>
        axios.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>) {
            <span class="hljs-comment">// å¯¹ response è¿›è¡Œæ‹¦æˆª</span>
            <span class="hljs-keyword">switch</span> (response.<span class="hljs-property">status</span>) {
                <span class="hljs-keyword">case</span> <span class="hljs-number">200</span>:
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ¥å£è®¿é—®æˆåŠŸ'</span>)
                    <span class="hljs-keyword">break</span>
                <span class="hljs-keyword">case</span> <span class="hljs-number">400</span>:
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æç¤ºé”™è¯¯ä¿¡æ¯'</span>)
                    <span class="hljs-keyword">break</span>
                <span class="hljs-keyword">case</span> <span class="hljs-number">401</span>:
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é‡å®šå‘åˆ°ç™»å½•é¡µé¢'</span>)
                    <span class="hljs-keyword">break</span>
            }

            <span class="hljs-keyword">return</span> response;
        }, <span class="hljs-keyword">function</span> (<span class="hljs-params">error</span>) {
            <span class="hljs-comment">// åœ¨é”™è¯¯è¯·æ±‚æ—¶è¿›è¡Œæ“ä½œ</span>
            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);
        });
        <span class="hljs-comment">//è·å–åå°APIæœåŠ¡å…¨å±€IPåœ°å€ã€ç«¯å£ã€æ¥å£ç»„</span>

        <span class="hljs-keyword">var</span> <span class="hljs-variable constant_">URL</span> = <span class="hljs-title class_">IPConfig</span>.<span class="hljs-property">IP</span> + <span class="hljs-string">':'</span> + <span class="hljs-title class_">IPConfig</span>.<span class="hljs-property">HOST</span> + <span class="hljs-string">'/api'</span>;
        axios.<span class="hljs-property">defaults</span>.<span class="hljs-property">baseURL</span> = <span class="hljs-variable constant_">URL</span>;
        axios.<span class="hljs-property">defaults</span>.<span class="hljs-property">xsrfHeaderName</span> = <span class="hljs-string">'X-CSRFToken'</span>
        axios.<span class="hljs-property">defaults</span>.<span class="hljs-property">xsrfCookieName</span> = <span class="hljs-string">'csrftoken'</span>
        axios.<span class="hljs-property">defaults</span>.<span class="hljs-property">withCredentials</span> = <span class="hljs-literal">false</span>
        axios.<span class="hljs-property">defaults</span>.<span class="hljs-property">timeout</span> = <span class="hljs-string">'5000'</span>

        axios.<span class="hljs-property">defaults</span>.<span class="hljs-property">headers</span>[<span class="hljs-string">'Content-Type'</span>] = <span class="hljs-string">'application/x-www-form-urlencoded;charset=UTF-8'</span>
        <span class="hljs-keyword">var</span> vm = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>({
            <span class="hljs-attr">el</span>: <span class="hljs-string">'#app'</span>,
            <span class="hljs-attr">data</span>: {
                <span class="hljs-attr">id</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">name</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">email</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">queryBuilder</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">users</span>: [],

            },

            <span class="hljs-attr">created</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getList</span>()
            },
            <span class="hljs-attr">methods</span>: {
                <span class="hljs-title function_">getList</span>(<span class="hljs-params"/>) {
                    axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/users'</span>)
                        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
                            <span class="hljs-variable language_">this</span>.<span class="hljs-property">users</span> = response.<span class="hljs-property">data</span>
                            <span class="hljs-comment">// alert(this.users)</span>
                        }).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
                            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error)
                        })
                },
                <span class="hljs-title function_">search</span>(<span class="hljs-params">queryBuilder</span>) {
                    <span class="hljs-comment">//alert(queryBuilder)</span>
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">queryBuilder</span> = queryBuilder
                    axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/user/query'</span>, {

                        <span class="hljs-attr">params</span>: {
                            <span class="hljs-attr">id</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>,
                            <span class="hljs-attr">name</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>,
                            <span class="hljs-attr">email</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">email</span>,
                            <span class="hljs-attr">queryBuilder</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">queryBuilder</span>,
                        }
                    }).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
                        <span class="hljs-variable language_">this</span>.<span class="hljs-property">users</span> = response.<span class="hljs-property">data</span>
                    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
                        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error)
                    })
                },
                <span class="hljs-title function_">add</span>(<span class="hljs-params"/>) {
                    axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/user'</span>, {
                        <span class="hljs-comment">// id:parseInt(this.id),</span>
                        <span class="hljs-attr">name</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>,
                        <span class="hljs-attr">email</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">email</span>,
                    }).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
                        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getList</span>()
                        <span class="hljs-comment">//this.users = response.data</span>
                    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
                        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error)
                    })
                }
            },
            <span class="hljs-attr">delimiters</span>: [<span class="hljs-string">'['</span>, <span class="hljs-string">"]"</span>],
        });
        vm.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">$ajax</span> = axios
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>


<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h4 data-id="heading-29">7.2 Goåç«¯æœåŠ¡APIå®ç°</h4>
<p>é¡¹ç›®ä¸­ä½¿ç”¨Irisçš„MVCæ¨¡å¼å®ç°RESTful APIï¼Œä¾›Vue3å‰ç«¯è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">/**
 * main.goä¸­ MVC æ¶æ„æ¨¡å¼å¤„ç†
 */</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">mvcHandle</span><span class="hljs-params">(app *iris.Application)</span></span> {
    <span class="hljs-comment">//å¯ç”¨session,å¹¶è®¾ç½®sessionå¯¹è±¡çš„è¿‡æœŸæ—¶é—´ä¸º24å°æ—¶</span>
    sessManager := sessions.New(sessions.Config{
        Cookie:  <span class="hljs-string">"sessioncookie"</span>,
        Expires: <span class="hljs-number">24</span> * time.Hour,
    })

    <span class="hljs-comment">// ã€vue apiã€‘åŠŸèƒ½æ¨¡å—</span>
    <span class="hljs-comment">// ä¾‹å¦‚ï¼šhttp://localhost:9000/api/users</span>
    Api := mvc.New(app.Party(<span class="hljs-string">"/api"</span>))
    <span class="hljs-comment">// æ³¨å†Œå½“å‰æ•°æ®äº‘æœåŠ¡ç±»å’Œå¯åŠ¨å¯¹sessions.Sessionçš„è®¿é—®æ“ä½œ</span>
    Api.Register(
        engine,        <span class="hljs-comment">// æ•°æ®åº“å¼•æ“</span>
        dir,           <span class="hljs-comment">// å½“å‰ç›®å½•</span>
        sessManager.Start,
    )
    <span class="hljs-comment">// æŒ‡å®šå½“å‰æ•°æ®æœåŠ¡ç”±é‚£ä¸ªæ§åˆ¶å™¨å¤„ç†</span>
    Api.Handle(<span class="hljs-built_in">new</span>(apiController.ApiController))
}

</code></pre>
<h4 data-id="heading-30">7.3 ç»“æ„ä½“æ¨¡æ¿</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> model

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"invoiceServer/utils"</span>
	<span class="hljs-string">"time"</span>
)

<span class="hljs-comment">//TestUser is a struct</span>
<span class="hljs-comment">/**
 * ã€TestUserã€‘ä¿¡æ¯ç»“æ„ä½“,ç”¨äºæ˜ å°„ã€test_userã€‘æ•°æ®è¡¨
 */</span>
<span class="hljs-keyword">type</span> TestUser <span class="hljs-keyword">struct</span> {
	ID          <span class="hljs-type">int64</span>     <span class="hljs-string">`xorm:"pk autoincr" json:"id"`</span>      <span class="hljs-comment">//ä¸»é”®ID</span>
	Name        <span class="hljs-type">string</span>    <span class="hljs-string">`xorm:"varchar(50)" json:"name"`</span>    <span class="hljs-comment">//ç”¨æˆ·å§“å</span>
	Email       <span class="hljs-type">string</span>    <span class="hljs-string">`xorm:"varchar(100)" json:"email"`</span>  <span class="hljs-comment">//ç”µå­é‚®ä»¶</span>
	CreatedTime time.Time <span class="hljs-string">`xorm:"created" json:"createdTime"`</span> <span class="hljs-comment">//åˆ›å»ºæ—¶é—´</span>
}

<span class="hljs-comment">//TestUserToRespDesc is a function interface</span>
<span class="hljs-comment">/**
 * å°†æ•°æ®åº“æŸ¥è¯¢å‡ºæ¥çš„ç»“æœè¿›è¡Œæ ¼å¼ç»„è£…æˆrequestè¯·æ±‚éœ€è¦çš„jsonå­—æ®µæ ¼å¼
 */</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(testUser *TestUser)</span></span> TestUserToRespDesc() <span class="hljs-keyword">interface</span>{} {
	respInfo := <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
		<span class="hljs-string">"id"</span>:          testUser.ID,
		<span class="hljs-string">"name"</span>:        testUser.Name,
		<span class="hljs-string">"email"</span>:       testUser.Email,
		<span class="hljs-string">"createdTime"</span>: utils.FormatDatetime(testUser.CreatedTime),
	}
	<span class="hljs-keyword">return</span> respInfo
}


</code></pre>
<h4 data-id="heading-31">7.4 æ§åˆ¶å™¨ç¤ºä¾‹</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> api

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"fmt"</span>
	<span class="hljs-string">"invoiceServer/utils"</span>
	<span class="hljs-string">"strconv"</span>
	<span class="hljs-string">"strings"</span>

	<span class="hljs-string">"github.com/go-xorm/xorm"</span>
	<span class="hljs-string">"github.com/kataras/iris/v12"</span>
	<span class="hljs-string">"github.com/kataras/iris/v12/sessions"</span>
)

<span class="hljs-comment">//MainFrameController is a struct</span>
<span class="hljs-comment">/*
 *ã€ä¸»æ¡†æ¶é¡µã€‘æ§åˆ¶å™¨ç»“æ„ä½“
 *æ ¹æ®å®¢æˆ·ç«¯è®¿é—®çš„APIåœ°å€è°ƒç”¨Serviceæ•°æ®æœåŠ¡é‡Œçš„CURDæ¥å£å¤„ç†æ•°æ®ï¼Œå¹¶è¿”å›ç»™å®¢æˆ·ç«¯
 */</span>
<span class="hljs-keyword">type</span> ApiController <span class="hljs-keyword">struct</span> {
	<span class="hljs-comment">//ä¸Šä¸‹æ–‡å¯¹è±¡</span>
	Ctx    iris.Context
	Engine *xorm.Engine
	<span class="hljs-comment">//ã€System_Sessionã€‘ service</span>
	<span class="hljs-comment">// MainFrameService system.MainFrameService</span>
	<span class="hljs-comment">//sessionå¯¹è±¡</span>
	Path    <span class="hljs-type">string</span>
	Session *sessions.Session
}

<span class="hljs-comment">//GetMytable is a function</span>
<span class="hljs-comment">/*
 * è·å–æˆ‘çš„åŠå…¬æ¡Œã€åŠŸèƒ½åç»­å¼€å‘ä¸­ã€‘
 * è¯·æ±‚ç±»å‹ï¼šGet
 * è¯·æ±‚Urlï¼š/system/mytable
 * å‡½æ•°åä¸ºè¯·æ±‚ç±»å‹+è®¿é—®åœ°å€GetMytable(),è®¿é—®åœ°å€é¦–å­—æ¯å¤§å†™
 */</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(uc *ApiController)</span></span> GetUsers() {
	<span class="hljs-comment">//æŸ¥è¯¢ç»“æœè½¬map</span>
	<span class="hljs-keyword">var</span> osql = <span class="hljs-string">"select name,email,createdTime,ID as id from test_user"</span>
	fmt.Printf(<span class="hljs-string">"osql: %v\n"</span>, osql)
	<span class="hljs-comment">//æŸ¥è¯¢ç»“æœè½¬MAP</span>
	data, _ := utils.DoQueryForMap(uc.Engine, osql)
	<span class="hljs-comment">//æŸ¥è¯¢ç»“æœè½¬JSON</span>
	uc.Ctx.JSON(data)
}

<span class="hljs-keyword">type</span> TestUser <span class="hljs-keyword">struct</span> {
	Name  <span class="hljs-type">string</span> <span class="hljs-string">`json:"name"`</span>
	Email <span class="hljs-type">string</span> <span class="hljs-string">`json:"email"`</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(uc *ApiController)</span></span> PostUser() {
	<span class="hljs-comment">// name := ctx.FormValue("name")</span>
	<span class="hljs-comment">// email := ctx.FormValue("email")</span>
	<span class="hljs-comment">// fmt.Printf("æ¥æ”¶vueä¼ å…¥æ•°æ®: Name:%s Email:%s\n", name, email)</span>
	<span class="hljs-comment">// ctx.WriteString("&lt;h1&gt;&lt;a&gt;" + name + "&lt;/a&gt;&lt;a&gt;" + email + "&lt;/a&gt;&lt;/h1&gt;")</span>

	c := &amp;TestUser{}
	<span class="hljs-keyword">if</span> err := uc.Ctx.ReadJSON(c); err != <span class="hljs-literal">nil</span> {
		<span class="hljs-comment">//Println("error")</span>
		<span class="hljs-built_in">panic</span>(err.Error())
	} <span class="hljs-keyword">else</span> {
		<span class="hljs-comment">//ctx.JSON(c)</span>
		fmt.Printf(<span class="hljs-string">"æ¥æ”¶vueä¼ å…¥JSONæ•°æ®: Name:%s Email:%s \n"</span>, c.Name, c.Email)
		<span class="hljs-comment">//db, _ := util.GetDB()</span>
		tsql := fmt.Sprintf(<span class="hljs-string">"INSERT INTO test_user(name,email) VALUES('%s','%s') select ID = convert(bigint, SCOPE_IDENTITY());"</span>, c.Name, c.Email)
		<span class="hljs-keyword">var</span> newId <span class="hljs-type">int64</span>
		newId = utils.DoInsertRow(uc.Engine, tsql)
		fmt.Printf(<span class="hljs-string">"æ–°å¢æ•°æ®IDä¸ºï¼šã€%dã€‘\n"</span>, newId)

		uc.Ctx.JSON(c)
	}
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(uc *ApiController)</span></span> GetUserQuery() {
	<span class="hljs-comment">//id := ctx.FormValue("id")</span>
	id, err := strconv.Atoi(uc.Ctx.FormValue(<span class="hljs-string">"id"</span>))
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		id = <span class="hljs-number">0</span>
	}
	name := uc.Ctx.FormValue(<span class="hljs-string">"name"</span>)
	email := uc.Ctx.FormValue(<span class="hljs-string">"email"</span>)
	queryBuilder := uc.Ctx.FormValue(<span class="hljs-string">"queryBuilder"</span>)
	fmt.Printf(<span class="hljs-string">"æ¥æ”¶vueä¼ å…¥æ•°æ®: ID:%s Name:%s Email:%s queryBuilderï¼š%s\n"</span>, id, name, email, queryBuilder)
	<span class="hljs-comment">//æŸ¥è¯¢ç»“æœè½¬map</span>
	<span class="hljs-comment">//db, _ := util.GetDB()</span>
	<span class="hljs-comment">//æŸ¥è¯¢ç»“æœè½¬JSON</span>
	<span class="hljs-keyword">var</span> queryValue <span class="hljs-type">string</span> = <span class="hljs-string">""</span>
	<span class="hljs-keyword">switch</span> {
	<span class="hljs-keyword">case</span> queryBuilder == <span class="hljs-string">"id"</span>:
		queryBuilder = strings.ToUpper(queryBuilder)
		queryValue = strconv.Itoa(id)
	<span class="hljs-keyword">case</span> queryBuilder == <span class="hljs-string">"name"</span>:
		queryValue = <span class="hljs-string">"'"</span> + name + <span class="hljs-string">"'"</span>
	<span class="hljs-keyword">case</span> queryBuilder == <span class="hljs-string">"email"</span>:
		queryValue = <span class="hljs-string">"'"</span> + email + <span class="hljs-string">"'"</span>
	<span class="hljs-keyword">default</span>:
		queryValue = strconv.Itoa(id)
	}

	<span class="hljs-keyword">var</span> osql = fmt.Sprintf(<span class="hljs-string">"select name,email,createdTime,ID as id from test_user where %s=%s"</span>, queryBuilder, queryValue)
	fmt.Print(osql + <span class="hljs-string">"\n"</span>)
	<span class="hljs-comment">//æŸ¥è¯¢ç»“æœè½¬MAP</span>
	data, _ := utils.DoQueryForMap(uc.Engine, osql)
	<span class="hljs-comment">//defer db.Close()</span>
	uc.Ctx.JSON(data)
}


</code></pre>
<h4 data-id="heading-32">7.5 æ•°æ®æœåŠ¡ç¤ºä¾‹-é‡‡ç”¨é€šç”¨æ•°æ®æœåŠ¡ç±»</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> utils

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"database/sql"</span>
	<span class="hljs-string">"encoding/json"</span>
	<span class="hljs-string">"fmt"</span>
	<span class="hljs-string">"log"</span>
	<span class="hljs-string">"strconv"</span>
	<span class="hljs-string">"strings"</span>
	<span class="hljs-string">"time"</span>

	<span class="hljs-string">"github.com/go-xorm/xorm"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">DoInsertRow</span><span class="hljs-params">(engine *xorm.Engine, sqlInfo <span class="hljs-type">string</span>)</span></span> <span class="hljs-type">int64</span> {
	<span class="hljs-comment">//æ’å…¥æ•°æ® æ³¨ï¼šç”±äºLastInsertIdå¯¹è‡ªå¢åŠ ä¸»é”®IDä¸æ”¯æŒï¼Œæ‰€ä»¥ç”¨å¦å¤–ä¸€ä¸ªæ–¹å¼è§£å†³æ’å…¥è¿”å›æ–°å¢ID</span>
	<span class="hljs-comment">// stmt, err := db.Prepare("INSERT äººå‘˜æ¸…å•(ç­ç»„,å§“å) VALUES(?,?,ref SCOPE_IDENTITY)")</span>
	<span class="hljs-comment">// util.CheckError("insert: %s\n", err)</span>
	<span class="hljs-comment">// res, err := stmt.Exec("ä¿¡æ¯éƒ¨","æGO")</span>
	<span class="hljs-comment">// util.CheckError("insert: %s\n", err)</span>
	<span class="hljs-comment">// id, err := res.LastInsertId()</span>
	<span class="hljs-comment">// util.CheckError("GetNewId: %s\n", err)</span>
	<span class="hljs-comment">// fmt.Printf("GetNewId:%s\n",id)</span>
	<span class="hljs-comment">//tsql=fmt.Sprintf("INSERT INTO äººå‘˜æ¸…å•(ç­ç»„,å§“å) VALUES('%s','%s') select id = convert(bigint, SCOPE_IDENTITY());", "ä¿¡æ¯ç»„","æGO")</span>
	row := engine.DB().DB.QueryRow(sqlInfo)

	<span class="hljs-keyword">var</span> id <span class="hljs-type">int64</span>
	row.Scan(&amp;id)
	<span class="hljs-comment">//fmt.Printf("GetNewId:%d\n",id)</span>
	<span class="hljs-keyword">return</span> id
}

<span class="hljs-comment">// CheckError is a function</span>
<span class="hljs-comment">// func CheckError(tag string, err error) {</span>
<span class="hljs-comment">// 	if err != nil {</span>
<span class="hljs-comment">// 		fmt.Printf(tag, err)</span>
<span class="hljs-comment">// 		return</span>
<span class="hljs-comment">// 	}</span>
<span class="hljs-comment">// }</span>

<span class="hljs-comment">// Count is a function</span>
<span class="hljs-comment">/**
 * æ ¹æ®sqlæŸ¥è¯¢è¿”å›ä¸€è¡Œæ•°æ®
 */</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Count</span><span class="hljs-params">(engine *xorm.Engine, sqlInfo <span class="hljs-type">string</span>)</span></span> (<span class="hljs-type">int</span>, <span class="hljs-type">error</span>) {
	fmt.Println(sqlInfo)
	<span class="hljs-comment">// æ‰§è¡ŒSQLè¯­å¥,å¹¶è¾“å‡ºç»“æœé›†å†…å®¹</span>
	rows, err := engine.DB().DB.Query(sqlInfo)
	CheckError(<span class="hljs-string">"query: %s\n"</span>, err)
	<span class="hljs-keyword">defer</span> rows.Close()
	<span class="hljs-keyword">var</span> countId <span class="hljs-type">int</span>
	<span class="hljs-keyword">for</span> rows.Next() {
		rows.Scan(&amp;countId)
		<span class="hljs-comment">//fmt.Printf("data: %s \n",data)</span>
	}
	<span class="hljs-keyword">if</span> err = rows.Close(); err != <span class="hljs-literal">nil</span> {
		<span class="hljs-comment">// but what should we do if there's an error?</span>
		log.Println(<span class="hljs-string">"æ•°æ®é›†è¯»å–æ•°æ®å¼‚å¸¸ç»ˆæ­¢"</span>, err)
	}
	<span class="hljs-keyword">return</span> countId, err
}

<span class="hljs-comment">// FindRowData is a function</span>
<span class="hljs-comment">/**
 * æ ¹æ®sqlæŸ¥è¯¢è¿”å›ä¸€è¡Œæ•°æ®
 */</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">FindRowData</span><span class="hljs-params">(engine *xorm.Engine, sqlInfo <span class="hljs-type">string</span>)</span></span> (data []<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>) {
	fmt.Println(sqlInfo)
	<span class="hljs-comment">// æ‰§è¡ŒSQLè¯­å¥,å¹¶è¾“å‡ºç»“æœé›†å†…å®¹</span>
	rows, err := engine.DB().DB.Query(sqlInfo)
	CheckError(<span class="hljs-string">"query: %s\n"</span>, err)
	<span class="hljs-keyword">defer</span> rows.Close()
	data = RowsToSliceMap(rows)
	<span class="hljs-keyword">if</span> err = rows.Close(); err != <span class="hljs-literal">nil</span> {
		<span class="hljs-comment">// but what should we do if there's an error?</span>
		log.Println(<span class="hljs-string">"æ•°æ®é›†è¯»å–æ•°æ®å¼‚å¸¸ç»ˆæ­¢"</span>, err)
	}
	<span class="hljs-keyword">return</span> data
}

<span class="hljs-comment">// RowsToSliceMap is a function</span>
<span class="hljs-comment">/**
 *å°†æ•°æ®é›†ç›´æ¥è½¬æ¢ä¸ºåŠ¨æ€è½¬æˆåˆ‡ç‰‡(å­—æ®µä»»æ„æ‹“å±•)
 *å…ˆæŠŠå­—æ®µçš„å€¼éƒ½å½“æˆå­—ç¬¦ä¸²
 */</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">RowsToSliceMap</span><span class="hljs-params">(rows *sql.Rows)</span></span> (list []<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>) {
	<span class="hljs-comment">//å­—æ®µåç§°</span>
	columns, _ := rows.Columns()
	<span class="hljs-comment">//å¤šå°‘ä¸ªå­—æ®µ</span>
	length := <span class="hljs-built_in">len</span>(columns)
	<span class="hljs-comment">//æ¯ä¸€è¡Œå­—æ®µçš„å€¼</span>
	values := <span class="hljs-built_in">make</span>([]sql.RawBytes, length)
	<span class="hljs-comment">//ä¿å­˜çš„æ˜¯valuesçš„å†…å­˜åœ°å€</span>
	pointer := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">interface</span>{}, length)
	<span class="hljs-comment">//</span>
	<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; length; i++ {
		pointer[i] = &amp;values[i]
	}
	<span class="hljs-comment">//</span>
	<span class="hljs-keyword">for</span> rows.Next() {
		<span class="hljs-comment">//æŠŠå‚æ•°å±•å¼€ï¼ŒæŠŠæ¯ä¸€è¡Œçš„å€¼å­˜åˆ°æŒ‡å®šçš„å†…å­˜åœ°å€å»ï¼Œå¾ªç¯è¦†ç›–ï¼Œvaluesä¹Ÿå°±è·Ÿç€è¢«èµ‹å€¼äº†</span>
		rows.Scan(pointer...)
		<span class="hljs-comment">//æ¯ä¸€è¡Œ</span>
		row := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>)
		<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; length; i++ {
			row[columns[i]] = <span class="hljs-type">string</span>(values[i])
		}
		list = <span class="hljs-built_in">append</span>(list, row)
	}
	<span class="hljs-comment">//if err:= rows.Close(); err != nil {</span>
	<span class="hljs-comment">//	// but what should we do if there's an error?</span>
	<span class="hljs-comment">//	log.Println("è·å–è¿”å›å€¼æ•°æ®é›†è¯»å–æ•°æ®å¼‚å¸¸ç»ˆæ­¢",err)</span>
	<span class="hljs-comment">//}</span>
	<span class="hljs-comment">//</span>
	<span class="hljs-keyword">return</span>
}

<span class="hljs-comment">// getExecProcParametersMap is a function</span>
<span class="hljs-comment">/**
 *æ ¹æ®å­˜å‚¨è¿‡ç¨‹åè¿”å›å‚æ•°åˆ—è¡¨
 */</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">getExecProcParametersMap</span><span class="hljs-params">(engine *xorm.Engine, procName <span class="hljs-type">string</span>)</span></span> (<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>, <span class="hljs-type">error</span>) {
	osql := fmt.Sprintf(<span class="hljs-string">"EXEC [dbo].[Proc_Parameters] @PROC_NAME='%s'"</span>, procName)
	fmt.Println(osql)
	rows, err := engine.DB().DB.Query(osql)
	<span class="hljs-keyword">defer</span> rows.Close()
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">if</span> err == sql.ErrNoRows {
			log.Fatal(<span class="hljs-string">"æ²¡æœ‰è·å–åˆ°æ•°æ®"</span>, err)
		} <span class="hljs-keyword">else</span> {
			log.Fatal(err)
		}
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
	}
	<span class="hljs-comment">//è·å–ç»“æœé›†</span>
	<span class="hljs-keyword">var</span> list <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span> <span class="hljs-comment">//è¿”å›çš„åˆ‡ç‰‡</span>
	list = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>)
	<span class="hljs-keyword">for</span> rows.Next() {
		<span class="hljs-keyword">var</span> parameter <span class="hljs-type">string</span>
		<span class="hljs-keyword">var</span> parametertype <span class="hljs-type">string</span>
		<span class="hljs-keyword">var</span> length <span class="hljs-type">int</span>
		<span class="hljs-keyword">var</span> xscale <span class="hljs-type">int</span>
		<span class="hljs-keyword">var</span> parameter_output <span class="hljs-type">int</span>
		<span class="hljs-keyword">var</span> scale <span class="hljs-type">int</span>
		rows.Scan(&amp;parameter, &amp;parametertype, &amp;length, &amp;xscale, &amp;parameter_output, &amp;scale)
		<span class="hljs-keyword">var</span> item <span class="hljs-type">string</span>
		<span class="hljs-comment">//item=fmt.Sprintf("%s,%s,%s,%s,%s,%s",parameter, parametertype,strconv.Itoa(length),strconv.Itoa(xscale),strconv.Itoa(parameter_output),strconv.Itoa(scale))</span>
		<span class="hljs-comment">//int, err := strconv.Atoi(string) å°†å­—ç¬¦ä¸²è½¬INT</span>
		item = fmt.Sprintf(<span class="hljs-string">"%v,%v,%v,%v,%v,%v"</span>, parameter, parametertype, length, xscale, parameter_output, scale)
		<span class="hljs-comment">//fmt.Println(item)</span>
		list[parameter] = item
	}
	<span class="hljs-keyword">if</span> err = rows.Close(); err != <span class="hljs-literal">nil</span> {
		<span class="hljs-comment">// but what should we do if there's an error?</span>
		log.Println(<span class="hljs-string">"è·å–è¿”å›å€¼æ•°æ®é›†è¯»å–æ•°æ®å¼‚å¸¸ç»ˆæ­¢"</span>, err)
	}
	<span class="hljs-keyword">return</span> list, err
}

<span class="hljs-comment">// getExecProcSql is a function</span>
<span class="hljs-comment">/**
 * æ ¹æ®å­˜å‚¨è¿‡ç¨‹åå’Œå‚æ•°mapæ•°ç»„ï¼Œç”Ÿæˆå¯ä»¥æ‰§è¡Œçš„ã€å­˜å‚¨è¿‡ç¨‹ã€‘sqlè¯­å¥ï¼Œè¯­å¥åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†
 * 1ã€å®šä¹‰è¾“å‡ºå˜é‡  DECLARE @return_value int,@msg varchar(100);
* 2ã€æ‰§è¡Œã€å­˜å‚¨è¿‡ç¨‹ã€‘å¹¶é…ä¸Šè¾“å…¥å‚æ•°å’Œè¾“å‡ºå‚æ•° EXEC @return_value = [dbo].[proc_aa] @dwUserID = 1,@nBaseEnsureType = 0,@msg=@msg output;
 * 3ã€æ‰§è¡Œã€å­˜å‚¨è¿‡ç¨‹ã€‘åéœ€è¦è¾“å‡ºçš„ç»“æœå’Œä¿¡æ¯ SELECT 'ReturnValue' = @return_value,'ReturnMsg' =@msg
*/</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">getExecProcSql</span><span class="hljs-params">(procName <span class="hljs-type">string</span>, inParas <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>, inParasTypes <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>, bErrorDescribe <span class="hljs-type">bool</span>)</span></span> <span class="hljs-type">string</span> {
	<span class="hljs-keyword">var</span> sql <span class="hljs-type">string</span>
	<span class="hljs-keyword">var</span> paras <span class="hljs-type">string</span>
	<span class="hljs-comment">//inParasTypesæ˜¯ä»åå°æ•°æ®åº“ä¸­æ ¹æ®å­˜å‚¨è¿‡ç¨‹åæå–å‚æ•°åˆ—è¡¨ï¼Œä¸‹é¢æ˜¯æ ¹æ®inParasTypesä¸­çš„å‚æ•°ç±»å‹è¿›è¡Œsqlè¯­å¥è¾“å…¥å˜é‡æ˜¯å¦éœ€è¦æ·»åŠ "'"</span>
	<span class="hljs-comment">//for key, value := range inParasTypes {</span>
	<span class="hljs-comment">//   fmt.Printf("inParasTypes[%d] =%s\n", key, value)</span>
	<span class="hljs-comment">//fmt.Printf("-------&gt;%s---[1]--&gt;,%s\n", value, strings.Split(value, ",")[1])</span>
	<span class="hljs-comment">//}</span>
	<span class="hljs-keyword">for</span> key, value := <span class="hljs-keyword">range</span> inParas {
		<span class="hljs-comment">/*æŸ¥çœ‹å…ƒç´ åœ¨é›†åˆä¸­æ˜¯å¦å­˜åœ¨ */</span>
		parName, ok := inParasTypes[key] <span class="hljs-comment">/*å¦‚æœç¡®å®šæ˜¯çœŸå®çš„,åˆ™å­˜åœ¨,å¦åˆ™ä¸å­˜åœ¨ */</span>
		<span class="hljs-keyword">if</span> ok {
			parType := strings.Split(parName, <span class="hljs-string">","</span>)[<span class="hljs-number">1</span>] <span class="hljs-comment">//è·å–å‚æ•°ç±»å‹</span>
			<span class="hljs-keyword">switch</span> {
			<span class="hljs-keyword">case</span> parType == <span class="hljs-string">"varchar"</span>, parType == <span class="hljs-string">"nvarchar"</span>:
				paras += key + <span class="hljs-string">" = '"</span> + value + <span class="hljs-string">"'"</span>
			<span class="hljs-keyword">case</span> parType == <span class="hljs-string">"char"</span>, parType == <span class="hljs-string">"nchar"</span>:
				paras += key + <span class="hljs-string">" = '"</span> + value + <span class="hljs-string">"'"</span>
			<span class="hljs-keyword">case</span> parType == <span class="hljs-string">"text"</span>, parType == <span class="hljs-string">"ntext"</span>:
				paras += key + <span class="hljs-string">" = '"</span> + value + <span class="hljs-string">"'"</span>
			<span class="hljs-keyword">case</span> parType == <span class="hljs-string">"image"</span>:
				paras += key + <span class="hljs-string">" = '"</span> + value + <span class="hljs-string">"'"</span>
			<span class="hljs-keyword">case</span> parType == <span class="hljs-string">"datetime"</span>:
				paras += key + <span class="hljs-string">" = '"</span> + value + <span class="hljs-string">"'"</span>
			<span class="hljs-keyword">case</span> parType == <span class="hljs-string">"uniqueidentifier"</span>:
				paras += key + <span class="hljs-string">" = '"</span> + value + <span class="hljs-string">"'"</span>
			<span class="hljs-keyword">default</span>:
				paras += key + <span class="hljs-string">" = "</span> + value
			}
			<span class="hljs-comment">//if parType=="varchar" || parType=="nvarchar"  || parType=="text"  || parType=="ntext" || parType=="char"   || parType=="nchar" || parType=="image" || parType=="datetime" {</span>
			<span class="hljs-comment">//	paras += key + " = '" + value+"'"</span>
			<span class="hljs-comment">//}else{</span>
			<span class="hljs-comment">//	paras += key + " = " + value</span>
			<span class="hljs-comment">//}</span>
		} <span class="hljs-keyword">else</span> {
			paras += key + <span class="hljs-string">" = "</span> + value
		}

		paras += <span class="hljs-string">","</span>
	}

	paras = strings.TrimRight(paras, <span class="hljs-string">","</span>)
	paras += <span class="hljs-string">",@msg=@msg output"</span>
	paras += <span class="hljs-string">";"</span>

	<span class="hljs-keyword">if</span> bErrorDescribe == <span class="hljs-literal">true</span> {
		sql = <span class="hljs-string">""</span>
	} <span class="hljs-keyword">else</span> {
		sql = fmt.Sprintf(<span class="hljs-string">"DECLARE @return_value int,@msg varchar(100); EXEC @return_value = [dbo].[%s] %s SELECT 'ReturnValue' = @return_value,'ReturnMsg'=@msg"</span>, procName, paras)
	}

	<span class="hljs-keyword">return</span> sql
}

<span class="hljs-comment">// ExecProcTest is a function</span>
<span class="hljs-comment">/**
 *è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å­˜å‚¨è¿‡ç¨‹çš„å‡½æ•°ï¼Œæ ¹æ®å­˜å‚¨è¿‡ç¨‹åå’Œå‚æ•°è¿”å›ç»“æœé›†å’Œè¾“å‡ºå­˜å‚¨è¿‡ç¨‹çš„æ‰§è¡Œç»“æœå’Œä¿¡æ¯æç¤º
 *Goå®šä¹‰äº†ä¸€ä¸ªç‰¹æ®Šçš„é”™è¯¯å¸¸é‡ï¼Œç§°ä¸ºsql.ErrNoRowsã€‚å½“ç»“æœä¸ºç©ºæ—¶ï¼Œä»QueryRow()è¿”å›çš„å°±æ˜¯sql.ErrNoRowsã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™éœ€è¦ä½œä¸ºç‰¹æ®Šæƒ…å†µæ¥å¤„ç†ã€‚ç©ºç»“æœé€šå¸¸ä¸ä¼šè¢«åº”ç”¨ç¨‹åºä»£ç è§†ä¸ºé”™è¯¯ï¼Œå¦‚æœä½ ä¸æ£€æŸ¥è¿”å›çš„Errroæ˜¯å¦æ˜¯è¿™ä¸ªç‰¹æ®Šçš„å¸¸é‡ï¼Œè¿™å°†å¯¼è‡´æ‚¨çš„åº”ç”¨ç¨‹åºä»¥æ‚¨æ‰€ä¸å¸Œæœ›çš„æ–¹å¼å¤±è´¥ã€‚

 */</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ExecProcTest</span><span class="hljs-params">(engine *xorm.Engine, procName <span class="hljs-type">string</span>, inParas <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>)</span></span> <span class="hljs-type">error</span> {
	parasTypesList, err := getExecProcParametersMap(engine, procName)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		fmt.Printf(<span class="hljs-string">"err:%s\n"</span>, err)
	} <span class="hljs-keyword">else</span> {
		fmt.Printf(<span class="hljs-string">"parasTypesList:%s\n"</span>, parasTypesList)
	}
	osql := getExecProcSql(procName, inParas, parasTypesList, <span class="hljs-literal">false</span>)
	fmt.Println(osql)
	rows, err := engine.DB().DB.Query(osql)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">if</span> err == sql.ErrNoRows {
			log.Fatal(<span class="hljs-string">"æ²¡æœ‰è·å–åˆ°æ•°æ®"</span>, err)
		} <span class="hljs-keyword">else</span> {
			log.Fatal(err)
		}

	} <span class="hljs-keyword">else</span> {
		<span class="hljs-comment">//å°†æ•°æ®é›†ç›´æ¥è½¬æ¢ä¸ºåŠ¨æ€è½¬æˆåˆ‡ç‰‡(å­—æ®µä»»æ„æ‹“å±•)</span>
		list := RowsToSliceMap(rows)
		<span class="hljs-keyword">for</span> k, v := <span class="hljs-keyword">range</span> list {
			fmt.Println(k)
			fmt.Println(v[<span class="hljs-string">"id"</span>], v[<span class="hljs-string">"table_name"</span>], v[<span class="hljs-string">"file_data"</span>], v[<span class="hljs-string">"uploader"</span>], v[<span class="hljs-string">"upload_time"</span>])
		}

		<span class="hljs-comment">//è·å–ç»“æœé›†ï¼Œrows.Nest()ä¸­ä¸€ä¸ªåªè¯»å‘å‰æ¸¸æ ‡ï¼Œè¯»å–åå…‰æ ‡åˆ°å°¾ï¼Œä¸èƒ½é‡å¤è¯»å–ï¼Œä¸Šé¢çš„ä»£ç å’Œä¸‹é¢çš„ä»£ç åªæœ‰ä¸€ä¸ªæœ‰æ•ˆ</span>
		<span class="hljs-keyword">for</span> rows.Next() {
			<span class="hljs-keyword">var</span> table_name <span class="hljs-type">string</span>
			<span class="hljs-keyword">var</span> uploader <span class="hljs-type">string</span>
			<span class="hljs-keyword">var</span> file_data <span class="hljs-type">string</span>
			<span class="hljs-keyword">var</span> id <span class="hljs-type">int</span>
			<span class="hljs-keyword">var</span> upload_time <span class="hljs-type">string</span>
			rows.Scan(&amp;id, &amp;table_name, &amp;file_data, &amp;uploader, &amp;upload_time)
			fmt.Printf(<span class="hljs-string">"%v,%v,%v,%v,%v\n"</span>, id, table_name, file_data, uploader, upload_time)
		}
		<span class="hljs-comment">//if err = rows.Close(); err != nil {</span>
		<span class="hljs-comment">//	// but what should we do if there's an error?</span>
		<span class="hljs-comment">//	log.Println("æ•°æ®é›†è¯»å–æ•°æ®å¼‚å¸¸ç»ˆæ­¢",err)</span>
		<span class="hljs-comment">//}</span>

		<span class="hljs-comment">//è·å–è¿”å›å€¼ï¼Œå¤šä¸ªç»“æœé›†éœ€è¦ç”¨rows.NextResultSet()å¯¹ç»“æœé›†è¿›è¡Œåˆ‡æ¢å¹¶è¯»å–æ•°æ®</span>
		<span class="hljs-keyword">if</span> rows.NextResultSet() {
			<span class="hljs-keyword">for</span> rows.Next() {
				<span class="hljs-keyword">var</span> returnValue <span class="hljs-type">int</span>
				<span class="hljs-keyword">var</span> returnMsg <span class="hljs-type">string</span>
				rows.Scan(&amp;returnValue, &amp;returnMsg)
				fmt.Printf(<span class="hljs-string">"ReturnValue %v ReturnMsgï¼š%v\n"</span>, returnValue, returnMsg)
			}
			<span class="hljs-keyword">if</span> err = rows.Close(); err != <span class="hljs-literal">nil</span> {
				<span class="hljs-comment">// but what should we do if there's an error?</span>
				log.Println(<span class="hljs-string">"è·å–è¿”å›å€¼æ•°æ®é›†è¯»å–æ•°æ®å¼‚å¸¸ç»ˆæ­¢"</span>, err)
			}
		}
	}
	<span class="hljs-keyword">return</span> err

}

<span class="hljs-comment">// ExecProcNoParasNoResultSet is a function</span>
<span class="hljs-comment">/**
 *æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹ï¼Œæ— å‚æ•°åªè¿”å›å­˜å‚¨è¿‡ç¨‹çš„è¿”å›å€¼å’Œè¿”å›msgï¼Œæ— è¿”å›ç»“æœé›†
 */</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ExecProcNoParasNoResultSet</span><span class="hljs-params">(engine *xorm.Engine, procName <span class="hljs-type">string</span>)</span></span> (<span class="hljs-type">int</span>, <span class="hljs-type">string</span>, <span class="hljs-type">error</span>) {

	osql := fmt.Sprintf(<span class="hljs-string">"DECLARE @return_value int,@msg varchar(100); EXEC @return_value = [dbo].[%s] @msg=@msg output;SELECT 'ReturnValue' = @return_value,'ReturnMsg'=@msg"</span>, procName)
	fmt.Println(osql)
	rows, err := engine.DB().DB.Query(osql)
	<span class="hljs-keyword">defer</span> rows.Close()
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">if</span> err == sql.ErrNoRows {
			log.Fatal(<span class="hljs-string">"æ²¡æœ‰è·å–åˆ°æ•°æ®"</span>, err)
		} <span class="hljs-keyword">else</span> {
			log.Fatal(err)
		}
		<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, <span class="hljs-string">""</span>, err
	}
	<span class="hljs-comment">//è·å–è¿”å›å€¼</span>
	<span class="hljs-keyword">var</span> returnValue <span class="hljs-type">int</span>
	<span class="hljs-keyword">var</span> returnMsg <span class="hljs-type">string</span>
	<span class="hljs-comment">//if rows.NextResultSet() {</span>
	<span class="hljs-keyword">for</span> rows.Next() {
		rows.Scan(&amp;returnValue, &amp;returnMsg)
		fmt.Printf(<span class="hljs-string">"ReturnValue %v ReturnMsgï¼š%v\n"</span>, returnValue, returnMsg)
	}
	<span class="hljs-keyword">if</span> err = rows.Close(); err != <span class="hljs-literal">nil</span> {
		<span class="hljs-comment">// but what should we do if there's an error?</span>
		log.Println(<span class="hljs-string">"è·å–è¿”å›å€¼æ•°æ®é›†è¯»å–æ•°æ®å¼‚å¸¸ç»ˆæ­¢"</span>, err)
	}
	<span class="hljs-comment">//}</span>
	<span class="hljs-keyword">return</span> returnValue, returnMsg, err
}

<span class="hljs-comment">// ExecProcNoResultSet is a function</span>
<span class="hljs-comment">/**
 *åªè¿”å›å­˜å‚¨è¿‡ç¨‹çš„è¿”å›å€¼å’Œè¿”å›msgï¼Œæ— è¿”å›ç»“æœé›†
 */</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ExecProcNoResultSet</span><span class="hljs-params">(engine *xorm.Engine, procName <span class="hljs-type">string</span>, inParas <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>)</span></span> (<span class="hljs-type">int</span>, <span class="hljs-type">string</span>, <span class="hljs-type">error</span>) {
	parasTypesList, err := getExecProcParametersMap(engine, procName)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		fmt.Printf(<span class="hljs-string">"columns:%s\n"</span>, parasTypesList)
	}
	osql := getExecProcSql(procName, inParas, parasTypesList, <span class="hljs-literal">false</span>)
	fmt.Println(osql)
	rows, err := engine.DB().DB.Query(osql)
	<span class="hljs-keyword">defer</span> rows.Close()
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">if</span> err == sql.ErrNoRows {
			log.Fatal(<span class="hljs-string">"æ²¡æœ‰è·å–åˆ°æ•°æ®"</span>, err)
		} <span class="hljs-keyword">else</span> {
			log.Fatal(err)
		}
		<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, <span class="hljs-string">""</span>, err
	}
	<span class="hljs-comment">//è·å–è¿”å›å€¼</span>
	<span class="hljs-keyword">var</span> returnValue <span class="hljs-type">int</span>
	<span class="hljs-keyword">var</span> returnMsg <span class="hljs-type">string</span>
	<span class="hljs-comment">//if rows.NextResultSet() {</span>
	<span class="hljs-keyword">for</span> rows.Next() {
		rows.Scan(&amp;returnValue, &amp;returnMsg)
		fmt.Printf(<span class="hljs-string">"ReturnValue %v ReturnMsgï¼š%v"</span>, returnValue, returnMsg)
	}
	<span class="hljs-keyword">if</span> err = rows.Close(); err != <span class="hljs-literal">nil</span> {
		<span class="hljs-comment">// but what should we do if there's an error?</span>
		log.Println(<span class="hljs-string">"è·å–è¿”å›å€¼æ•°æ®é›†è¯»å–æ•°æ®å¼‚å¸¸ç»ˆæ­¢"</span>, err)
	}
	<span class="hljs-comment">//}</span>
	<span class="hljs-keyword">return</span> returnValue, returnMsg, err
}

<span class="hljs-comment">// ExecProcResultSetForMap is a function</span>
<span class="hljs-comment">/**
 *è¿”å›ç»“æœé›†mapï¼Œå¹¶ä¸”è¿”å›å­˜å‚¨è¿‡ç¨‹çš„è¿”å›å€¼å’Œè¿”å›msg
 */</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ExecProcResultSetForMap</span><span class="hljs-params">(engine *xorm.Engine, procName <span class="hljs-type">string</span>, inParas <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>)</span></span> ([]<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}, <span class="hljs-type">int</span>, <span class="hljs-type">string</span>, <span class="hljs-type">error</span>) {
	parasTypesList, err := getExecProcParametersMap(engine, procName)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		fmt.Printf(<span class="hljs-string">"columns:%s\n"</span>, parasTypesList)
	}
	osql := getExecProcSql(procName, inParas, parasTypesList, <span class="hljs-literal">false</span>)
	fmt.Println(osql)
	rows, err := engine.DB().DB.Query(osql)
	<span class="hljs-keyword">defer</span> rows.Close()
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">if</span> err == sql.ErrNoRows {
			log.Fatal(<span class="hljs-string">"æ²¡æœ‰è·å–åˆ°æ•°æ®"</span>, err)
		} <span class="hljs-keyword">else</span> {
			log.Fatal(err)
		}
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, <span class="hljs-number">0</span>, <span class="hljs-string">""</span>, err
	}
	columns, _ := rows.Columns()
	columnLength := <span class="hljs-built_in">len</span>(columns)
	cache := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">interface</span>{}, columnLength) <span class="hljs-comment">//ä¸´æ—¶å­˜å‚¨æ¯è¡Œæ•°æ®</span>
	<span class="hljs-keyword">for</span> index, _ := <span class="hljs-keyword">range</span> cache {
		<span class="hljs-comment">//ä¸ºæ¯ä¸€åˆ—åˆå§‹åŒ–ä¸€ä¸ªæŒ‡é’ˆ</span>
		<span class="hljs-keyword">var</span> a <span class="hljs-keyword">interface</span>{}
		cache[index] = &amp;a
	}
	<span class="hljs-keyword">var</span> list []<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{} <span class="hljs-comment">//è¿”å›çš„åˆ‡ç‰‡</span>
	<span class="hljs-keyword">for</span> rows.Next() {
		_ = rows.Scan(cache...)
		item := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{})
		<span class="hljs-keyword">for</span> i, data := <span class="hljs-keyword">range</span> cache {
			item[columns[i]] = *data.(*<span class="hljs-keyword">interface</span>{}) <span class="hljs-comment">//å–å®é™…ç±»å‹</span>
		}
		list = <span class="hljs-built_in">append</span>(list, item)
	}
	<span class="hljs-comment">//if err = rows.Close(); err != nil {</span>
	<span class="hljs-comment">//	// but what should we do if there's an error?</span>
	<span class="hljs-comment">//	log.Println("æ•°æ®é›†è¯»å–æ•°æ®å¼‚å¸¸ç»ˆæ­¢",err)</span>
	<span class="hljs-comment">//}</span>
	<span class="hljs-comment">//è·å–è¿”å›å€¼</span>
	<span class="hljs-keyword">var</span> returnValue <span class="hljs-type">int</span>
	<span class="hljs-keyword">var</span> returnMsg <span class="hljs-type">string</span>
	<span class="hljs-keyword">if</span> rows.NextResultSet() {
		<span class="hljs-keyword">for</span> rows.Next() {
			rows.Scan(&amp;returnValue, &amp;returnMsg)
			fmt.Printf(<span class="hljs-string">"ReturnValue %v ReturnMsgï¼š%v\n"</span>, returnValue, returnMsg)
		}
		<span class="hljs-keyword">if</span> err = rows.Close(); err != <span class="hljs-literal">nil</span> {
			<span class="hljs-comment">// but what should we do if there's an error?</span>
			log.Println(<span class="hljs-string">"è·å–è¿”å›å€¼æ•°æ®é›†è¯»å–æ•°æ®å¼‚å¸¸ç»ˆæ­¢"</span>, err)
		}
	}
	fmt.Println(returnMsg)
	<span class="hljs-keyword">return</span> list, returnValue, returnMsg, err
}

<span class="hljs-comment">//éå†map</span>
<span class="hljs-comment">// for key, value := range list {</span>
<span class="hljs-comment">//     fmt.Printf("list[%d] =%s\n", key, value)</span>
<span class="hljs-comment">// }</span>

<span class="hljs-comment">// ExecProcResultSetForJSON is a function</span>
<span class="hljs-comment">/**
 *è¿”å›ç»“æœé›†jsonå­—ç¬¦ä¸²ï¼Œå¹¶ä¸”è¿”å›å­˜å‚¨è¿‡ç¨‹çš„è¿”å›å€¼å’Œè¿”å›msg
 *å‡½æ•°è°ƒç”¨æ–¹æ³•
 *	var jsondata string
 *	jsondata,_=util.ExecProcResultSetForJson(db,osql)
 *	fmt.Println(jsondata)
 */</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ExecProcResultSetForJSON</span><span class="hljs-params">(engine *xorm.Engine, procName <span class="hljs-type">string</span>, inParas <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>)</span></span> (<span class="hljs-type">string</span>, <span class="hljs-type">int</span>, <span class="hljs-type">string</span>, <span class="hljs-type">error</span>) {
	parasTypesList, err := getExecProcParametersMap(engine, procName)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		fmt.Printf(<span class="hljs-string">"columns:%s\n"</span>, parasTypesList)
	}
	osql := getExecProcSql(procName, inParas, parasTypesList, <span class="hljs-literal">false</span>)
	fmt.Println(osql)
	rows, err := engine.DB().DB.Query(osql)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-string">""</span>, <span class="hljs-number">0</span>, <span class="hljs-string">""</span>, err
	}
	<span class="hljs-keyword">defer</span> rows.Close()
	columns, err := rows.Columns()
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">if</span> err == sql.ErrNoRows {
			log.Fatal(<span class="hljs-string">"æ²¡æœ‰è·å–åˆ°æ•°æ®"</span>, err)
		} <span class="hljs-keyword">else</span> {
			log.Fatal(err)
		}
		<span class="hljs-keyword">return</span> <span class="hljs-string">""</span>, <span class="hljs-number">0</span>, <span class="hljs-string">""</span>, err
	}
	count := <span class="hljs-built_in">len</span>(columns)
	tableData := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}, <span class="hljs-number">0</span>)
	values := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">interface</span>{}, count)
	valuePtrs := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">interface</span>{}, count)
	<span class="hljs-keyword">for</span> rows.Next() {
		<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; count; i++ {
			valuePtrs[i] = &amp;values[i]
		}
		rows.Scan(valuePtrs...)
		entry := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{})
		<span class="hljs-keyword">for</span> i, col := <span class="hljs-keyword">range</span> columns {
			<span class="hljs-keyword">var</span> v <span class="hljs-keyword">interface</span>{}
			val := values[i]
			b, ok := val.([]<span class="hljs-type">byte</span>)
			<span class="hljs-keyword">if</span> ok {
				v = <span class="hljs-type">string</span>(b)
			} <span class="hljs-keyword">else</span> {
				v = val
			}
			entry[col] = v
		}
		tableData = <span class="hljs-built_in">append</span>(tableData, entry)
	}
	<span class="hljs-comment">//if err = rows.Close(); err != nil {</span>
	<span class="hljs-comment">//	// but what should we do if there's an error?</span>
	<span class="hljs-comment">//	log.Println("æ•°æ®é›†è¯»å–æ•°æ®å¼‚å¸¸ç»ˆæ­¢",err)</span>
	<span class="hljs-comment">//}</span>
	jsonData, err := json.Marshal(tableData)

	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-string">""</span>, <span class="hljs-number">0</span>, <span class="hljs-string">""</span>, err
	}
	<span class="hljs-comment">//fmt.Println(string(jsonData))</span>
	<span class="hljs-comment">//jsonstr:=</span>
	<span class="hljs-keyword">var</span> returnValue <span class="hljs-type">int</span>
	<span class="hljs-keyword">var</span> returnMsg <span class="hljs-type">string</span>
	<span class="hljs-keyword">if</span> rows.NextResultSet() {
		<span class="hljs-keyword">for</span> rows.Next() {
			rows.Scan(&amp;returnValue, &amp;returnMsg)
			fmt.Printf(<span class="hljs-string">"ReturnValue %v ReturnMsgï¼š%v\n"</span>, returnValue, returnMsg)
		}
		<span class="hljs-keyword">if</span> err = rows.Close(); err != <span class="hljs-literal">nil</span> {
			<span class="hljs-comment">// but what should we do if there's an error?</span>
			log.Println(<span class="hljs-string">"è·å–è¿”å›å€¼æ•°æ®é›†è¯»å–æ•°æ®å¼‚å¸¸ç»ˆæ­¢"</span>, err)
		}
	}

	<span class="hljs-keyword">return</span> <span class="hljs-type">string</span>(jsonData), returnValue, returnMsg, err

}

<span class="hljs-comment">// DoQueryForMap is a function</span>
<span class="hljs-comment">/*
 *æ ¹æ®ä¼ å…¥çš„sqlï¼Œä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ•°æ®å¹¶å°†è·å¾—çš„ç»“æœé›†è½¬æ¢æˆmap
 *è°ƒç”¨æ–¹æ³•
 	var osql string
	osql="select cast(id as varchar(20)) as id,å§“å AS name,ç­ç»„ AS class from äººå‘˜æ¸…å• where å§“å like 'æGO%' AND ç­ç»„='ä¿¡æ¯ç»„'"
	data,_:=util.DoQueryForMap(db,osql)
   //éå†map
    for key, value := range data {
		fmt.Printf("list[%d] =%s\n", key, value)
	}
	//å°†ç»“æœè½¬ä¸ºjson
	if b,err:= json.Marshal(data);err==nil{
		str:=string(b[:])
		fmt.Println("main:",str)
	}
*/</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">DoQueryForMap</span><span class="hljs-params">(engine *xorm.Engine, sqlInfo <span class="hljs-type">string</span>)</span></span> ([]<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}, <span class="hljs-type">error</span>) {
	<span class="hljs-comment">//fmt.Println(sqlInfo)</span>
	rows, err := engine.DB().DB.Query(sqlInfo)
	<span class="hljs-keyword">defer</span> rows.Close()
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">if</span> err == sql.ErrNoRows {
			log.Fatal(<span class="hljs-string">"æ²¡æœ‰è·å–åˆ°æ•°æ®"</span>, err)
		} <span class="hljs-keyword">else</span> {
			log.Fatal(err)
		}
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
	}
	columns, _ := rows.Columns()

	columnLength := <span class="hljs-built_in">len</span>(columns)
	cache := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">interface</span>{}, columnLength) <span class="hljs-comment">//ä¸´æ—¶å­˜å‚¨æ¯è¡Œæ•°æ®</span>
	<span class="hljs-keyword">for</span> index, _ := <span class="hljs-keyword">range</span> cache {
		<span class="hljs-comment">//ä¸ºæ¯ä¸€åˆ—åˆå§‹åŒ–ä¸€ä¸ªæŒ‡é’ˆ</span>
		<span class="hljs-keyword">var</span> a <span class="hljs-keyword">interface</span>{}
		cache[index] = &amp;a
	}
	<span class="hljs-keyword">var</span> list []<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{} <span class="hljs-comment">//è¿”å›çš„åˆ‡ç‰‡</span>
	<span class="hljs-keyword">for</span> rows.Next() {
		_ = rows.Scan(cache...)
		item := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{})
		<span class="hljs-keyword">for</span> i, data := <span class="hljs-keyword">range</span> cache {
			item[columns[i]] = *data.(*<span class="hljs-keyword">interface</span>{}) <span class="hljs-comment">//å–å®é™…ç±»å‹</span>
		}
		list = <span class="hljs-built_in">append</span>(list, item)
	}
	<span class="hljs-keyword">if</span> err = rows.Close(); err != <span class="hljs-literal">nil</span> {
		<span class="hljs-comment">// but what should we do if there's an error?</span>
		log.Println(<span class="hljs-string">"æ•°æ®é›†è¯»å–æ•°æ®å¼‚å¸¸ç»ˆæ­¢"</span>, err)
	}
	<span class="hljs-comment">//_ = rows.Close()</span>
	<span class="hljs-comment">//éå†map</span>
	<span class="hljs-comment">// for key, value := range list {</span>
	<span class="hljs-comment">//     fmt.Printf("list[%d] =%s\n", key, value)</span>
	<span class="hljs-comment">// }</span>
	<span class="hljs-keyword">return</span> list, <span class="hljs-literal">nil</span>
}

<span class="hljs-comment">// DoQueryForJSON is a function</span>
<span class="hljs-comment">/*
 *æ ¹æ®ä¼ å…¥çš„sqlï¼Œä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ•°æ®å¹¶å°†è·å¾—çš„ç»“æœé›†è½¬æ¢æˆ
 *å‡½æ•°è°ƒç”¨æ–¹æ³•
	var jsondata string
	jsondata,_=util.DoQueryForJson(db,osql)
	fmt.Println(jsondata)
*/</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">DoQueryForJSON</span><span class="hljs-params">(engine *xorm.Engine, sqlInfo <span class="hljs-type">string</span>)</span></span> (<span class="hljs-type">string</span>, <span class="hljs-type">error</span>) {
	<span class="hljs-comment">//fmt.Println(sqlInfo)</span>
	rows, err := engine.DB().DB.Query(sqlInfo)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">if</span> err == sql.ErrNoRows {
			log.Fatal(<span class="hljs-string">"æ²¡æœ‰è·å–åˆ°æ•°æ®"</span>, err)
		} <span class="hljs-keyword">else</span> {
			log.Fatal(err)
		}
		<span class="hljs-keyword">return</span> <span class="hljs-string">""</span>, err
	}
	<span class="hljs-keyword">defer</span> rows.Close()
	columns, err := rows.Columns()
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-string">""</span>, err
	}
	count := <span class="hljs-built_in">len</span>(columns)
	tableData := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}, <span class="hljs-number">0</span>)
	values := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">interface</span>{}, count)
	valuePtrs := <span class="hljs-built_in">make</span>([]<span class="hljs-keyword">interface</span>{}, count)
	<span class="hljs-keyword">for</span> rows.Next() {
		<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; count; i++ {
			valuePtrs[i] = &amp;values[i]
		}
		rows.Scan(valuePtrs...)
		entry := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{})
		<span class="hljs-keyword">for</span> i, col := <span class="hljs-keyword">range</span> columns {
			<span class="hljs-keyword">var</span> v <span class="hljs-keyword">interface</span>{}
			val := values[i]
			b, ok := val.([]<span class="hljs-type">byte</span>)
			<span class="hljs-keyword">if</span> ok {
				v = <span class="hljs-type">string</span>(b)
			} <span class="hljs-keyword">else</span> {
				v = val
			}
			entry[col] = v
		}
		tableData = <span class="hljs-built_in">append</span>(tableData, entry)
	}
	<span class="hljs-keyword">if</span> err = rows.Close(); err != <span class="hljs-literal">nil</span> {
		<span class="hljs-comment">// but what should we do if there's an error?</span>
		log.Println(<span class="hljs-string">"æ•°æ®é›†è¯»å–æ•°æ®å¼‚å¸¸ç»ˆæ­¢"</span>, err)
	}
	jsonData, err := json.Marshal(tableData)

	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-string">""</span>, err
	}
	<span class="hljs-comment">//fmt.Println(string(jsonData))</span>
	<span class="hljs-comment">//jsonstr:=</span>
	<span class="hljs-keyword">return</span> <span class="hljs-type">string</span>(jsonData), <span class="hljs-literal">nil</span>
}

<span class="hljs-comment">// InterfaceSliceConvStringSlice is a function</span>
<span class="hljs-comment">/**
  * å°†interface slice è½¬æ¢æˆstring slice
  * æ ¹æ®YTPEè¿”å›interface sliceä¸­çš„å„å­é¡¹çš„ç±»å‹ï¼Œæ ¹æ®ç±»å‹å¯¹å­é¡¹è¿›è¡Œè½¬æ¢ï¼Œå¹¶ä¿å­˜åˆ°string slice
  * å‡½æ•°è°ƒç”¨ä»£ç ï¼š
	//InterfaceSliceToStringSliceå‡½æ•°,å°†Interfaceç±»å‹çš„åˆ‡ç‰‡Sliceè½¬æ¢ä¸ºStringç±»å‹çš„Slice
	strArray:=utils.InterfaceSliceToStringSlice("redis",100,false,true,10.22,time.Now())
	//å°†å­—ç¬¦å‹åˆ‡ç‰‡ä¸­çš„å€¼ç”¨å­—ç¬¦ä¸²è¿æ¥åœ¨ä¸€èµ·ï¼Œä»¥[","]ä½œä¸ºåˆ†éš”ç¬¦
	res := strings.Join(strArray, ",")
	fmt.Println("InterfaceSliceConvStringSliceå‡½æ•°è¿”å›å€¼ï¼š",res)
	//ç”¨åå°„åŒ…ä¸­çš„TypeOfå‡½æ•°è¿”å›æ•°æ®ç±»å‹
	day:=time.Now()
	fmt.Println(reflect.TypeOf(day))
*/</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">InterfaceSliceToStringSlice</span><span class="hljs-params">(params ...<span class="hljs-keyword">interface</span>{})</span></span> []<span class="hljs-type">string</span> {
	<span class="hljs-keyword">var</span> paramSlice []<span class="hljs-type">string</span>
	<span class="hljs-keyword">for</span> _, param := <span class="hljs-keyword">range</span> params {
		<span class="hljs-keyword">switch</span> v := param.(<span class="hljs-keyword">type</span>) {
		<span class="hljs-keyword">case</span> <span class="hljs-type">bool</span>:
			paramSlice = <span class="hljs-built_in">append</span>(paramSlice, strconv.FormatBool(v))
		<span class="hljs-keyword">case</span> <span class="hljs-type">float64</span>:
			paramSlice = <span class="hljs-built_in">append</span>(paramSlice, strconv.FormatFloat(v, <span class="hljs-string">'f'</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">64</span>))
		<span class="hljs-keyword">case</span> <span class="hljs-type">string</span>:
			paramSlice = <span class="hljs-built_in">append</span>(paramSlice, v)
		<span class="hljs-keyword">case</span> <span class="hljs-type">int</span>:
			paramSlice = <span class="hljs-built_in">append</span>(paramSlice, strconv.FormatInt(<span class="hljs-type">int64</span>(v), <span class="hljs-number">10</span>))
		<span class="hljs-keyword">case</span> time.Time:
			paramSlice = <span class="hljs-built_in">append</span>(paramSlice, fmt.Sprintf(<span class="hljs-string">"%d-%d-%d %d:%d:%d"</span>, v.Year(), v.Month(), v.Day(), v.Hour(), v.Minute(), v.Second()))
		<span class="hljs-keyword">default</span>:
			<span class="hljs-built_in">panic</span>(<span class="hljs-string">"params type not supported"</span>)
		}

	}
	<span class="hljs-comment">//res := strings.Join(paramSlice, ",")</span>
	<span class="hljs-comment">//fmt.Println(res)</span>
	<span class="hljs-keyword">return</span> paramSlice
}

</code></pre>
<h4 data-id="heading-33">7.6 è·¯ç”±è®¾ç½®</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> router

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"github.com/kataras/iris/v12"</span>
)

<span class="hljs-keyword">const</span> (
	apiPrefix              = <span class="hljs-string">"api"</span>

)

</code></pre>
<h3 data-id="heading-34">8. æ—¥å¿—ç³»ç»Ÿé›†æˆ</h3>
<p>é¡¹ç›®ä½¿ç”¨Zapæ—¥å¿—åº“å®ç°é«˜æ€§èƒ½çš„æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œæ”¯æŒæ§åˆ¶å°è¾“å‡ºå’Œæ–‡ä»¶æ—¥å¿—ã€‚</p>
<h4 data-id="heading-35">8.1 æ—¥å¿—ç³»ç»Ÿåˆå§‹åŒ–</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">var</span> (
    Logger *zap.Logger
    mu     sync.Mutex <span class="hljs-comment">// ç”¨äºæ–‡ä»¶æ—¥å¿—çš„äº’æ–¥é”</span>
)

<span class="hljs-comment">// åˆå§‹åŒ–æ—¥å¿—ç³»ç»Ÿ</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">InitLogger</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">var</span> err <span class="hljs-type">error</span>
    Logger, err = zap.NewProduction()
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-built_in">panic</span>(err)
    }
}
</code></pre>
<h4 data-id="heading-36">8.2 æ—¥å¿—å†™å…¥æ–‡ä»¶</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// LogToFile å°†æ—¥å¿—å†™å…¥æ–‡ä»¶ï¼Œä½¿ç”¨äº’æ–¥é”ä¿è¯å¹¶å‘å®‰å…¨</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">LogToFile</span><span class="hljs-params">(logMessage <span class="hljs-type">string</span>)</span></span> {
    mu.Lock()
    <span class="hljs-keyword">defer</span> mu.Unlock()

    file, err := os.OpenFile(<span class="hljs-string">"./logs/app.log"</span>, os.O_APPEND|os.O_CREATE|os.O_WRONLY, <span class="hljs-number">0666</span>)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        Logger.Error(<span class="hljs-string">"Failed to open log file"</span>, zap.Error(err))
        <span class="hljs-keyword">return</span>
    }
    <span class="hljs-keyword">defer</span> file.Close()

    _, err = file.WriteString(logMessage + <span class="hljs-string">"\n"</span>)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        Logger.Error(<span class="hljs-string">"Failed to write to log file"</span>, zap.Error(err))
    }
}
</code></pre>
<h4 data-id="heading-37">8.3 æ—¥å¿—è®°å½•æ–¹æ³•</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// LogMessage æ ¼å¼åŒ–å¹¶è®°å½•æ—¥å¿—ä¿¡æ¯</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">LogMessage</span><span class="hljs-params">(endTime time.Time, latency time.Duration, status, ip, method, path <span class="hljs-type">string</span>, message <span class="hljs-keyword">interface</span>{})</span></span> {
    msg := <span class="hljs-string">"&lt;no message&gt;"</span> <span class="hljs-comment">// é»˜è®¤å€¼</span>
    <span class="hljs-keyword">if</span> message != <span class="hljs-literal">nil</span> {
        msg = fmt.Sprintf(<span class="hljs-string">"%v"</span>, message)
    }

    logMessage := fmt.Sprintf(
        <span class="hljs-string">"[%s] %s %s %s %s %d %s"</span>,
        endTime.Format(time.RFC3339),
        method,
        path,
        ip,
        status,
        latency.Milliseconds(), <span class="hljs-comment">// ä»¥æ¯«ç§’è®°å½•å»¶è¿Ÿ</span>
        msg,
    )
    LogToFile(logMessage)
}

<span class="hljs-comment">// WriteLog è®°å½•å¸¦ä¸Šä¸‹æ–‡çš„æ—¥å¿—</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">WriteLog</span><span class="hljs-params">(ctx iris.Context, msg <span class="hljs-type">string</span>)</span></span> {
    start := time.Now()
    endTime := time.Now()
    latency := endTime.Sub(start)
    status := fmt.Sprintf(<span class="hljs-string">"%d"</span>, ctx.GetStatusCode())
    ip := ctx.RemoteAddr()
    method := ctx.Method()
    path := ctx.Path()
    <span class="hljs-comment">// è°ƒç”¨ LogMessage</span>
    LogMessage(endTime, latency, status, ip, method, path, msg)
}

<span class="hljs-comment">// WriteNotCtxLog è®°å½•ç³»ç»Ÿçº§æ—¥å¿—ï¼ˆæ— è¯·æ±‚ä¸Šä¸‹æ–‡ï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">WriteNotCtxLog</span><span class="hljs-params">(msg <span class="hljs-type">string</span>)</span></span> {
    start := time.Now()
    endTime := time.Now()
    latency := endTime.Sub(start)
    status := fmt.Sprintf(<span class="hljs-string">"%d"</span>, <span class="hljs-number">200</span>)
    ip := <span class="hljs-string">"127.0.0.1"</span>
    method := <span class="hljs-string">"System"</span>
    path := <span class="hljs-string">"0.0.0.0:8888"</span>
    <span class="hljs-comment">// è°ƒç”¨ LogMessage</span>
    LogMessage(endTime, latency, status, ip, method, path, msg)
}
</code></pre>
<h3 data-id="heading-38">9. è·¨åŸŸè®¾ç½®</h3>
<p>é¡¹ç›®å®ç°äº†CORSï¼ˆè·¨åŸŸèµ„æºå…±äº«ï¼‰åŠŸèƒ½ï¼Œå…è®¸å‰ç«¯åº”ç”¨ä»ä¸åŒåŸŸåè®¿é—®åç«¯APIã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// è®¾ç½®irisè·¨åŸŸè¯·æ±‚,ä»¥ä¿è¯VUEé¡¹ç›®å¯ä»¥æ­£å¸¸è¯·æ±‚æ•°æ®</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Cors</span><span class="hljs-params">(ctx iris.Context)</span></span> {
    ctx.Header(<span class="hljs-string">"Access-Control-Allow-Origin"</span>, <span class="hljs-string">"*"</span>) <span class="hljs-comment">// å…è®¸æ‰€æœ‰æ¥æº</span>
    <span class="hljs-keyword">if</span> ctx.Request().Method == <span class="hljs-string">"OPTIONS"</span> {
        ctx.Header(<span class="hljs-string">"Access-Control-Allow-Methods"</span>, <span class="hljs-string">"GET,POST,PUT,DELETE,PATCH,OPTIONS"</span>)
        ctx.Header(<span class="hljs-string">"Access-Control-Max-Age"</span>, <span class="hljs-string">"86400"</span>) <span class="hljs-comment">// é¢„æ£€è¯·æ±‚çš„æœ‰æ•ˆæœŸä¸º24å°æ—¶</span>
        ctx.Header(<span class="hljs-string">"Access-Control-Allow-Headers"</span>, <span class="hljs-string">"Content-Type, Access-Control-Allow-Headers,authorization,Authorization, X-Requested-With"</span>)
        ctx.StatusCode(<span class="hljs-number">204</span>) <span class="hljs-comment">// æ— å†…å®¹å“åº”</span>
        <span class="hljs-keyword">return</span>
    }
    ctx.Next() <span class="hljs-comment">// ç»§ç»­å¤„ç†è¯·æ±‚</span>
}
</code></pre>
<p>åœ¨åº”ç”¨ç¨‹åºä¸­å¯ç”¨è·¨åŸŸä¸­é—´ä»¶ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åœ¨mainå‡½æ•°ä¸­å¯ç”¨è·¨åŸŸä¸­é—´ä»¶</span>
app.Use(Cors)
</code></pre>
<h3 data-id="heading-39">10. é¡¹ç›®é…ç½®æ–‡ä»¶åŠåŠ è½½åŠŸèƒ½</h3>
<p>é¡¹ç›®ä½¿ç”¨JSONæ ¼å¼çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«åº”ç”¨ç¨‹åºé…ç½®ã€æ•°æ®åº“é…ç½®ç­‰ä¿¡æ¯ã€‚</p>
<h4 data-id="heading-40">10.1 é…ç½®ç»“æ„ä½“å®šä¹‰</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// DbMysql MySQLæ•°æ®åº“é…ç½®</span>
<span class="hljs-keyword">type</span> DbMysql <span class="hljs-keyword">struct</span> {
    Drive    <span class="hljs-type">string</span> <span class="hljs-string">`json:"drive"`</span>
    Port     <span class="hljs-type">string</span> <span class="hljs-string">`json:"port"`</span>
    User     <span class="hljs-type">string</span> <span class="hljs-string">`json:"user"`</span>
    Pwd      <span class="hljs-type">string</span> <span class="hljs-string">`json:"pwd"`</span>
    Host     <span class="hljs-type">string</span> <span class="hljs-string">`json:"host"`</span>
    Database <span class="hljs-type">string</span> <span class="hljs-string">`json:"database"`</span>
}

<span class="hljs-comment">// DbMssql2008 SQL Server 2008æ•°æ®åº“é…ç½®</span>
<span class="hljs-keyword">type</span> DbMssql2008 <span class="hljs-keyword">struct</span> {
    Drive    <span class="hljs-type">string</span> <span class="hljs-string">`json:"drive"`</span>
    Port     <span class="hljs-type">string</span> <span class="hljs-string">`json:"port"`</span>
    User     <span class="hljs-type">string</span> <span class="hljs-string">`json:"user"`</span>
    Pwd      <span class="hljs-type">string</span> <span class="hljs-string">`json:"pwd"`</span>
    Host     <span class="hljs-type">string</span> <span class="hljs-string">`json:"host"`</span>
    Database <span class="hljs-type">string</span> <span class="hljs-string">`json:"database"`</span>
}

<span class="hljs-comment">// DbMssql2000 SQL Server 2000æ•°æ®åº“é…ç½®</span>
<span class="hljs-keyword">type</span> DbMssql2000 <span class="hljs-keyword">struct</span> {
    Drive    <span class="hljs-type">string</span> <span class="hljs-string">`json:"drive"`</span>
    Port     <span class="hljs-type">string</span> <span class="hljs-string">`json:"port"`</span>
    User     <span class="hljs-type">string</span> <span class="hljs-string">`json:"user"`</span>
    Pwd      <span class="hljs-type">string</span> <span class="hljs-string">`json:"pwd"`</span>
    Host     <span class="hljs-type">string</span> <span class="hljs-string">`json:"host"`</span>
    Database <span class="hljs-type">string</span> <span class="hljs-string">`json:"database"`</span>
    Provider <span class="hljs-type">string</span> <span class="hljs-string">`json:"provider"`</span>
}

<span class="hljs-comment">// DbRedis Redisæ•°æ®åº“é…ç½®</span>
<span class="hljs-keyword">type</span> DbRedis <span class="hljs-keyword">struct</span> {
    NetWork  <span class="hljs-type">string</span> <span class="hljs-string">`json:"net_work"`</span>
    Addr     <span class="hljs-type">string</span> <span class="hljs-string">`json:"addr"`</span>
    Port     <span class="hljs-type">string</span> <span class="hljs-string">`json:"port"`</span>
    Password <span class="hljs-type">string</span> <span class="hljs-string">`json:"password"`</span>
    Prefix   <span class="hljs-type">string</span> <span class="hljs-string">`json:"prefix"`</span>
}

<span class="hljs-comment">// AppConfig åº”ç”¨ç¨‹åºé…ç½®</span>
<span class="hljs-keyword">type</span> AppConfig <span class="hljs-keyword">struct</span> {
    AppName     <span class="hljs-type">string</span>      <span class="hljs-string">`json:"app_name"`</span>
    Host        <span class="hljs-type">string</span>      <span class="hljs-string">`json:"host"`</span>
    Port        <span class="hljs-type">string</span>      <span class="hljs-string">`json:"port"`</span>
    StaticPath  <span class="hljs-type">string</span>      <span class="hljs-string">`json:"static_path"`</span>
    Mode        <span class="hljs-type">string</span>      <span class="hljs-string">`json:"mode"`</span>
    DbMySql     DbMysql     <span class="hljs-string">`json:"dbmysql"`</span>
    DbMsSql2000 DbMssql2000 <span class="hljs-string">`json:"dbmssql2000"`</span>
    DbMsSql2008 DbMssql2008 <span class="hljs-string">`json:"dbmssql2008"`</span>
    DbRedis     DbRedis     <span class="hljs-string">`json:"dbredis"`</span>
}
</code></pre>
<h4 data-id="heading-41">10.2 config.jsonæ–‡ä»¶ç¤ºä¾‹</h4>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"app_name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"invoiceServer"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"host"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0.0.0.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"port"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"7777"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"static_path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/static"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"mode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"dev"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"dbmysql"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"drive"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"mysql"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"port"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"3306"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"user"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"root"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"pwd"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"123456789"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"host"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"127.0.0.1"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"database"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"invoice"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"dbmssql2000"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"drive"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"adodb"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"port"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1433"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"user"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"sa"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"pwd"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"123456789"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"host"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"localhost"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"database"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"invoice"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"provider"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"SQLOLEDB"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"dbmssql2008"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"drive"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"mssql"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"port"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1888"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"user"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"sa"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"pwd"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"123456789"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"host"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"localhost"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"database"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"invoice"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"dbredis"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"net_work"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tcp"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"addr"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"127.0.0.1"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"port"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"6379"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"password"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"prefix"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"invoice_"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-42">10.3 é…ç½®åŠ è½½å‡½æ•°</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// InitConfig åˆå§‹åŒ–æœåŠ¡å™¨é…ç½®</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">InitConfig</span><span class="hljs-params">()</span></span> *AppConfig {
    <span class="hljs-comment">// æ‰“å¼€é…ç½®æ–‡ä»¶</span>
    file, err := os.Open(<span class="hljs-string">"./config.json"</span>)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-built_in">panic</span>(err.Error())
    }
    <span class="hljs-comment">// åˆ›å»ºJSONè§£ç å™¨</span>
    decoder := json.NewDecoder(file)
    <span class="hljs-comment">// è§£ç JSONæ•°æ®åˆ°AppConfigç»“æ„ä½“</span>
    <span class="hljs-keyword">var</span> config *AppConfig
    err = decoder.Decode(&amp;config)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-built_in">panic</span>(err.Error())
    }
    <span class="hljs-keyword">return</span> config
}
</code></pre>
<p/>
<h4 data-id="heading-43">10.4 é…ç½®ä½¿ç”¨ç¤ºä¾‹</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åœ¨mainå‡½æ•°ä¸­ä½¿ç”¨é…ç½®</span>
config := config.InitConfig()
<span class="hljs-comment">// è·å–é…ç½®ä¸­çš„IPåœ°å€å’Œç«¯å£å·</span>
addr := config.Host + <span class="hljs-string">":"</span> + config.Port
<span class="hljs-comment">// å¯åŠ¨æœåŠ¡</span>
app.Run(
    iris.Addr(addr),
    iris.WithCharset(<span class="hljs-string">"UTF-8"</span>),
    iris.WithoutServerError(iris.ErrServerClosed),
    iris.WithOptimizations,
)
</code></pre>
<h3 data-id="heading-44">11. MSSQL/XORMæ•°æ®åº“è¿æ¥é…ç½®ä¸åº”ç”¨</h3>
<p>é¡¹ç›®ä½¿ç”¨XORMæ¡†æ¶ä¸MSSQLæ•°æ®åº“è¿›è¡Œäº¤äº’ï¼Œæ”¯æŒæ•°æ®åº“è¿æ¥æ± ã€SQLæ—¥å¿—ç­‰åŠŸèƒ½ã€‚</p>
<h4 data-id="heading-45">11.1 æ•°æ®åº“å¼•æ“åˆå§‹åŒ–</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// NewMsSqlEngine å®ä¾‹åŒ–MSSQLæ•°æ®åº“å¼•æ“</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewMsSqlEngine</span><span class="hljs-params">()</span></span> *xorm.Engine {
    <span class="hljs-comment">// è·å–é…ç½®</span>
    initConfig := config.InitConfig()
    <span class="hljs-keyword">if</span> initConfig == <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
    }

    database := initConfig.DbMsSql2008
    <span class="hljs-comment">// æ„å»ºMSSQLè¿æ¥å­—ç¬¦ä¸²</span>
    dataSourceName := <span class="hljs-string">"server="</span> + database.Host + <span class="hljs-string">";database="</span> + database.Database + <span class="hljs-string">";user id="</span> + database.User + <span class="hljs-string">";password="</span> + database.Pwd + <span class="hljs-string">";port="</span> + database.Port + <span class="hljs-string">";encrypt=disable"</span>
    <span class="hljs-comment">// åˆ›å»ºæ•°æ®åº“å¼•æ“</span>
    engine, err := xorm.NewEngine(database.Drive, dataSourceName)

    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Fatal(<span class="hljs-string">"æ•°æ®åº“è¿æ¥å¤±è´¥:"</span>, err)
    }
    <span class="hljs-comment">// æµ‹è¯•è¿æ¥</span>
    <span class="hljs-keyword">if</span> err := engine.Ping(); err != <span class="hljs-literal">nil</span> {
        log.Fatal(<span class="hljs-string">"å»ºç«‹æ•°æ®åº“è¿æ¥å¤±è´¥:"</span>, err)
    }

    <span class="hljs-comment">// è®¾ç½®å­—æ®µæ˜ å°„è§„åˆ™</span>
    engine.SetColumnMapper(core.GonicMapper{})
    <span class="hljs-comment">// åŒæ­¥æ•°æ®åº“ç»“æ„</span>
    err = engine.Sync2(
        <span class="hljs-comment">// è¿™é‡Œå¯ä»¥æ·»åŠ éœ€è¦åŒæ­¥çš„æ¨¡å‹ç»“æ„ä½“</span>
        <span class="hljs-built_in">new</span>(model.TestUser),

    )
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        fmt.Printf(<span class="hljs-string">"engine.Sync2:%s"</span>, err.Error())
    }

    <span class="hljs-comment">// è®¾ç½®æ—¥å¿—çº§åˆ«</span>
    engine.Logger().SetLevel(core.LOG_INFO)
    <span class="hljs-keyword">var</span> logger *xorm.SimpleLogger = sqlLogger()
    logger.SetLevel(core.LOG_INFO)
    engine.SetLogger(logger)

    <span class="hljs-comment">// é…ç½®è¿æ¥æ± </span>
    engine.SetMaxOpenConns(<span class="hljs-number">2000</span>)
    engine.SetMaxIdleConns(<span class="hljs-number">1000</span>)
    engine.SetConnMaxLifetime(<span class="hljs-number">60</span>) <span class="hljs-comment">// 1åˆ†é’Ÿä¸€æ¬¡å¿ƒè·³</span>

    <span class="hljs-keyword">return</span> engine
}
</code></pre>
<h4 data-id="heading-46">11.2 SQLæ—¥å¿—è®°å½•</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// sqlLogger åˆ›å»ºSQLæ—¥å¿—è®°å½•å™¨</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">sqlLogger</span><span class="hljs-params">()</span></span> *xorm.SimpleLogger {
    config := rollingwriter.Config{
        LogPath:                <span class="hljs-string">"./logs"</span>,                    <span class="hljs-comment">// æ—¥å¿—è·¯å¾„</span>
        TimeTagFormat:          <span class="hljs-string">"060102150405"</span>,              <span class="hljs-comment">// æ—¶é—´æ ¼å¼ä¸²</span>
        FileName:               <span class="hljs-string">"ExecSql"</span>,                   <span class="hljs-comment">// æ—¥å¿—æ–‡ä»¶å</span>
        MaxRemain:              <span class="hljs-number">3</span>,                           <span class="hljs-comment">// é…ç½®æ—¥å¿—æœ€å¤§å­˜ç•™æ•°</span>
        RollingPolicy:          rollingwriter.VolumeRolling, <span class="hljs-comment">// é…ç½®æ»šåŠ¨ç­–ç•¥</span>
        RollingVolumeSize:      <span class="hljs-string">"1M"</span>,                        <span class="hljs-comment">// é…ç½®æˆªæ–­æ–‡ä»¶ä¸‹é™å¤§å°</span>
        WriterMode:             <span class="hljs-string">"none"</span>,
        BufferWriterThershould: <span class="hljs-number">256</span>,
        Compress: <span class="hljs-literal">true</span>, <span class="hljs-comment">// å‹ç¼©æ—¥å¿—æ–‡ä»¶</span>
    }
    <span class="hljs-comment">// åˆ›å»ºæ—¥å¿—æ–‡ä»¶</span>
    writer, err := rollingwriter.NewWriterFromConfig(&amp;config)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-built_in">panic</span>(err)
    }
    <span class="hljs-comment">// åˆ›å»ºXORMæ—¥å¿—è®°å½•å™¨</span>
    <span class="hljs-keyword">var</span> logger *xorm.SimpleLogger = xorm.NewSimpleLogger(writer)
    <span class="hljs-keyword">return</span> logger
}
</code></pre>
<p/>
<h4 data-id="heading-47">11.3 æ•°æ®åº“æœåŠ¡ä½¿ç”¨ç¤ºä¾‹</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// MVCæ¶æ„ä¸­çš„æ•°æ®åº“æœåŠ¡ä½¿ç”¨</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">mvcHandle</span><span class="hljs-params">(app *iris.Application)</span></span> {
    <span class="hljs-comment">// å¯ç”¨session</span>
    sessManager := sessions.New(sessions.Config{
        Cookie:  <span class="hljs-string">"sessioncookie"</span>,
        Expires: <span class="hljs-number">24</span> * time.Hour,
    })

    <span class="hljs-comment">// ã€mssqlæ•°æ®åº“æµ‹è¯•æ¨¡å—ã€‘</span>
    mssqlDbToolsTestDataService := testService.NewMssqlDbToolsTestDataService(engine)
    mssqlDbToolsTest := mvc.New(app.Party(<span class="hljs-string">"/test/mssqlDbToos"</span>))
    <span class="hljs-comment">// æ³¨å†ŒæœåŠ¡å’Œsession</span>
    mssqlDbToolsTest.Register(
        mssqlDbToolsTestDataService,
        dir,
        sessManager.Start,
    )
    <span class="hljs-comment">// æŒ‡å®šæ§åˆ¶å™¨</span>
    mssqlDbToolsTest.Handle(<span class="hljs-built_in">new</span>(testController.MssqlDbToolsTestDataController))
}
</code></pre>
<h3 data-id="heading-48">12. æ€»ç»“</h3>
<p>æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ç”µå­å‘ç¥¨è§£æGo APIæœåŠ¡ç«¯åº”ç”¨ï¼Œç»“åˆäº†ç°ä»£Webå¼€å‘æŠ€æœ¯æ ˆå’ŒOCRè¯†åˆ«æŠ€æœ¯ã€‚é¡¹ç›®å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ol>
<li><strong>ç»“æ„æ¸…æ™°</strong>ï¼šé‡‡ç”¨MVCæ¶æ„ï¼Œå„æ¨¡å—èŒè´£åˆ†æ˜ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•ã€‚</li>
<li><strong>æŠ€æœ¯å…ˆè¿›</strong>ï¼šä½¿ç”¨Goè¯­è¨€ã€Irisæ¡†æ¶ã€PaddleOCRç­‰å…ˆè¿›æŠ€æœ¯ï¼Œæ€§èƒ½ä¼˜è‰¯ã€‚</li>
<li><strong>åŠŸèƒ½å®Œå–„</strong>ï¼šæ”¯æŒå‘ç¥¨OCRè¯†åˆ«ã€PDF/OFDæ–‡ä»¶é¢„è§ˆã€æ•°æ®åº“äº¤äº’ç­‰åŠŸèƒ½ã€‚</li>
<li><strong>å‰åç«¯åˆ†ç¦»</strong>ï¼šé‡‡ç”¨Vue3ä½œä¸ºå‰ç«¯æ¡†æ¶ï¼Œå®ç°å‰åç«¯åˆ†ç¦»å¼€å‘ã€‚</li>
<li><strong>å®‰å…¨å¯é </strong>ï¼šå®ç°äº†è·¨åŸŸè®¾ç½®ã€æ—¥å¿—ç³»ç»Ÿã€é”™è¯¯å¤„ç†ç­‰å®‰å…¨æœºåˆ¶ã€‚</li>
</ol>
<p>é€šè¿‡æœ¬æ–‡æ¡£çš„è¯¦ç»†è§£æï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…å¿«é€Ÿç†è§£é¡¹ç›®æ¶æ„å’Œå®ç°åŸç†ï¼Œä¸ºåç»­çš„å¼€å‘å’Œç»´æŠ¤å·¥ä½œæä¾›å‚è€ƒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[COC Asia 2025ï½œå¾—å¸†äº‘ ETLï¼šé¡ºåº” Hive æ–°ç‰¹æ€§ï¼Œé‡å¡‘æ•°æ®ç®¡é“çš„æœªæ¥]]></title>    <link>https://juejin.cn/post/7570866247979302964</link>    <guid>https://juejin.cn/post/7570866247979302964</guid>    <pubDate>2025-11-10T07:39:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570866247979302964" data-draft-id="7570630923711053876" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="COC Asia 2025ï½œå¾—å¸†äº‘ ETLï¼šé¡ºåº” Hive æ–°ç‰¹æ€§ï¼Œé‡å¡‘æ•°æ®ç®¡é“çš„æœªæ¥"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-10T07:39:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¾—å¸†äº‘ä½ä»£ç "/> <meta itemprop="url" content="https://juejin.cn/user/2254449849150557"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            COC Asia 2025ï½œå¾—å¸†äº‘ ETLï¼šé¡ºåº” Hive æ–°ç‰¹æ€§ï¼Œé‡å¡‘æ•°æ®ç®¡é“çš„æœªæ¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2254449849150557/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¾—å¸†äº‘ä½ä»£ç 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T07:39:20.000Z" title="Mon Nov 10 2025 07:39:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨COC Asia 2025å¤§ä¼šä¸Šï¼ŒClouderaé«˜çº§å·¥ç¨‹æ€»ç›‘Attila TurÃ³czyå‘è¡¨äº†é¢˜ä¸ºâ€œApache Hiveä¸­åˆ†æ”¯ä¸æ ‡ç­¾çš„ETLæœªæ¥â€çš„ç²¾å½©æ¼”è®²ã€‚</p>
<p>è¿™åœºæ¼”è®²ä¸ä»…å±•ç¤ºäº†Hiveçš„æœ€æ–°æŠ€æœ¯æ¼”è¿›ï¼Œä¹Ÿé¢„ç¤ºç€æ•°æ®é›†æˆä¸ETLå·¥å…·çš„å…¨æ–°å˜é©æ–¹å‘ã€‚</p>
<p>ä½œä¸ºä¼ä¸šçº§æ•°æ®é›†æˆé¢†åŸŸçš„æ·±è€•è€…ï¼Œå¾—å¸†äº‘ETLæ­£åœ¨ç§¯ææ‹¥æŠ±Hiveä¸Icebergå¸¦æ¥çš„æ–°ç‰¹æ€§ï¼Œé€šè¿‡æ™ºèƒ½åŒ–å’Œå¯è§‚æµ‹çš„èƒ½åŠ›å‡çº§ï¼Œè®©ä¼ä¸šçš„æ•°æ®ç®¡é“æ›´ç¨³å®šã€æ›´é«˜æ•ˆã€æ›´æ™ºèƒ½ã€‚</p>
<h2 data-id="heading-0"><strong>Hiveçš„æ–°èƒ½åŠ›ï¼Œæ­£åœ¨æ”¹å˜ETLçš„æ¸¸æˆè§„åˆ™</strong></h2>
<p>éšç€Apache Hive 4.0+å¼•å…¥Icebergè¡¨ã€åˆ†æ”¯ï¼ˆBranchingï¼‰ä¸æ ‡ç­¾ï¼ˆTaggingï¼‰æœºåˆ¶ï¼ŒETLçš„å¼€å‘ä¸ç®¡ç†æ–¹å¼æ­£è¢«å½»åº•é‡å¡‘ã€‚ä¼ ç»ŸETLé€šå¸¸ä»¥çº¿æ€§æµç¨‹æ‰§è¡Œï¼šæå– â†’ è½¬æ¢ â†’ åŠ è½½ï¼Œä¸€æ—¦å‡ºç°å¼‚å¸¸ï¼Œå¾€å¾€éš¾ä»¥å¿«é€Ÿå›æº¯å’Œä¿®å¤ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/32c4595c3bd8455896b8f60e01f6f2e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X5biG5LqR5L2O5Luj56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763365160&amp;x-signature=OeBGR6fEvOm8kXdOVFcAYbQFrUc%3D" alt="å›¾ç‰‡" loading="lazy"/>è€ŒHiveçš„æ–°ç‰¹æ€§è®©æ•°æ®é›†æˆå…·å¤‡äº†â€œç‰ˆæœ¬æ§åˆ¶â€çš„èƒ½åŠ›ï¼š-   åˆ†æ”¯è®©æ•°æ®å¤„ç†æ›´å®‰å…¨ï¼šå¯åœ¨ç‹¬ç«‹ç¯å¢ƒä¸­æµ‹è¯•ä¸éªŒè¯å˜æ›´ï¼Œä¸å½±å“ä¸»è¡¨ï¼›</p>
<ul>
<li>æ ‡ç­¾è®©æ•°æ®ç‰ˆæœ¬æ›´æ¸…æ™°ï¼šä¸ºæ¯æ¬¡å‘å¸ƒæˆ–å®¡è®¡æ‰“ä¸Šæ—¶é—´ç‚¹ï¼Œè½»æ¾å®ç°â€œæ—¶é—´æ—…è¡Œâ€ï¼›</li>
<li>Write-Audit-Publish (WAP)Â æ¨¡å¼è®©å‘å¸ƒæ›´å¯æ§ï¼šæ•°æ®åœ¨å‘å¸ƒå‰å¯è‡ªåŠ¨æ ¡éªŒã€è¿‡æ»¤ã€æ¸…ç†ï¼Œä¸»åˆ†æ”¯å§‹ç»ˆä¿æŒé«˜è´¨é‡ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/26687080a5a243e0aee1e5863e07728f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X5biG5LqR5L2O5Luj56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763365160&amp;x-signature=hJcHrioCbqlpV7Ol40YpTwYi4vU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™ä¸ä»…æ˜¯Hiveçš„å‡çº§ï¼Œæ›´æ˜¯ETLå·¥å…·è¿›åŒ–çš„å¥‘æœºã€‚</p>
<h2 data-id="heading-1">å¾—å¸†äº‘ETLçš„è¿›åŒ–æ–¹å‘</h2>
<p>é¢å¯¹Hiveæ–°ç‰¹æ€§çš„æµªæ½®ï¼Œå¾—å¸†äº‘ETLåœ¨æœ€æ–°ç‰ˆæœ¬ä¸­å®Œæˆäº†å¤šé¡¹å…³é”®å‡çº§ï¼š</p>
<p>ğŸ”¹Â å…¨é¢å…¼å®¹Icebergè¡¨ç»“æ„ï¼šå¯ç›´æ¥åœ¨ETLä»»åŠ¡ä¸­è¯»å†™åˆ†æ”¯ä¸æ ‡ç­¾æ•°æ®ï¼Œæ”¯æŒä¸»åˆ†æ”¯åˆå¹¶ä¸å¿«ç…§ç®¡ç†ï¼›
ğŸ”¹Â å¯è§†åŒ–åˆ†æ”¯ç¼–æ’ï¼šå¼€å‘è€…å¯åœ¨ç•Œé¢ä¸Šç›´æ¥åˆ›å»ºã€åˆå¹¶ã€æ¸…ç†åˆ†æ”¯ä»»åŠ¡ï¼Œè®©ç‰ˆæœ¬ç®¡ç†æ›´ç›´è§‚ï¼›
ğŸ”¹Â å†…ç½®WAPæ¨¡å¼ï¼šè‡ªåŠ¨å°†ä»»åŠ¡è¾“å‡ºå†™å…¥å®¡è®¡åŒºï¼Œé€šè¿‡è´¨é‡æ£€æµ‹åå†å‘å¸ƒåˆ°ä¸»è¡¨ï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼›
ğŸ”¹Â å¢å¼ºå…ƒæ•°æ®è¿½è¸ªï¼šç»“åˆå¾—å¸†äº‘å…ƒæ•°æ®ä¸­å¿ƒï¼Œå®Œæ•´è®°å½•æ¯æ¬¡åˆå¹¶ã€å›æ»šä¸å·®å¼‚ï¼Œæ„å»ºé€æ˜å¯è§‚æµ‹çš„æ•°æ®ç®¡é“ã€‚è¿™æ„å‘³ç€ï¼Œå¾—å¸†äº‘ETLä¸å†åªæ˜¯ä¸€ä¸ªâ€œæ•°æ®æ¬è¿å·¥å…·â€ï¼Œè€Œæ˜¯ä¸€ä¸ªå¯åä½œã€å¯è¿½è¸ªã€å¯éªŒè¯çš„æ™ºèƒ½æ•°æ®é›†æˆå¹³å°ã€‚</p>
<h2 data-id="heading-2">é¢å‘æœªæ¥çš„ETLï¼šæ™ºèƒ½ã€å¼€æ”¾ã€æ¼”è¿›ä¸­</h2>
<p>Hiveçš„æ¯ä¸€æ¬¡æŠ€æœ¯æ¼”è¿›ï¼Œéƒ½åœ¨ä¸ºETLçš„æœªæ¥æŒ‡æ˜æ–¹å‘ã€‚å¾—å¸†äº‘ETLå°†æŒç»­ï¼š</p>
<ul>
<li>ç´§è·ŸApacheç¤¾åŒºèŠ‚å¥ï¼Œæ”¯æŒHive 4.2çš„æ–°è¯­æ³•å’Œæ•°æ®ä¿ç•™ç­–ç•¥ï¼›</li>
<li>èåˆAIèƒ½åŠ›ï¼Œå®ç°æ™ºèƒ½æ˜ å°„ã€å¼‚å¸¸æ£€æµ‹ä¸è‡ªé€‚åº”è°ƒä¼˜ï¼›</li>
<li>æ‹“å±•å¤šå¼•æ“ç”Ÿæ€ï¼Œè®©Sparkã€Flinkã€Hiveç­‰å¼•æ“ååŒæ‰§è¡Œï¼Œé‡Šæ”¾è®¡ç®—æ½œèƒ½ã€‚æˆ‘ä»¬ç›¸ä¿¡ï¼Œä¸‹ä¸€ä»£ETLå°†ä¸æ­¢æ˜¯â€œè‡ªåŠ¨åŒ–â€ï¼Œè€Œæ˜¯â€œè‡ªè¿›åŒ–â€â€”â€”èƒ½ç†è§£æ•°æ®ã€ä¼˜åŒ–æµç¨‹ã€ä¿éšœè´¨é‡ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è®©ä»£ç æ›´æ¸…æ™°ï¼šAndroid ä¸­çš„ MVCã€MVP ä¸ MVVM]]></title>    <link>https://juejin.cn/post/7570630923711135796</link>    <guid>https://juejin.cn/post/7570630923711135796</guid>    <pubDate>2025-11-10T07:50:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570630923711135796" data-draft-id="7570247858869338164" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è®©ä»£ç æ›´æ¸…æ™°ï¼šAndroid ä¸­çš„ MVCã€MVP ä¸ MVVM"/> <meta itemprop="keywords" content="Android,MVVM,MVC"/> <meta itemprop="datePublished" content="2025-11-10T07:50:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨ç™½"/> <meta itemprop="url" content="https://juejin.cn/user/2549135752044601"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è®©ä»£ç æ›´æ¸…æ™°ï¼šAndroid ä¸­çš„ MVCã€MVP ä¸ MVVM
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2549135752044601/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨ç™½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T07:50:10.000Z" title="Mon Nov 10 2025 07:50:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">çœŸæ­£çš„é—®é¢˜</h2>
<p>åœ¨æ²¡æœ‰å¼•å…¥æ¶æ„æ—¶ï¼Œæˆ‘ä»¬çš„ <code>Activity</code> æˆ– <code>Fragment</code> éå¸¸è‡ƒè‚¿ï¼šæ—¢è¦è´Ÿè´£å±•ç¤º Viewï¼Œåˆè¦è´Ÿè´£å“åº”ç‚¹å‡»äº‹ä»¶ï¼Œè¿˜éœ€è¦å»è´Ÿè´£ç½‘ç»œè¯·æ±‚ï¼Œå¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œç®¡ç†æ•°æ®çŠ¶æ€...</p>
<p>è¿™å¯¼è‡´äº†é«˜è€¦åˆæ€§ï¼Œè¿™ç§ä»£ç å‡ ä¹æ— æ³•æµ‹è¯•ä¸”éš¾ä»¥ç»´æŠ¤ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¼•å…¥äº†æ¶æ„æ¨¡å¼ï¼Œå°±æ˜¯ä¸ºäº†æ‹†å¼€ <code>Activity</code> æˆ– <code>Fragment</code>ã€‚</p>
<h2 data-id="heading-1">MVC å’Œ MVP çš„å…³ç³»</h2>
<p>é¦–å…ˆæ¾„æ¸…ä¸€ä¸ªè¯¯åŒºï¼šMVP å¹¶ä¸æ˜¯ MVC çš„æ”¹è¿›ç‰ˆæœ¬ï¼Œåªæ˜¯è§£å†³åŒä¸€ä¸ªé—®é¢˜çš„ä¸¤ç§ä¸åŒçš„æ‹†åˆ†æ€è·¯ã€‚</p>
<p>æˆ‘ä»¬é€šå¸¸è®¤ä¸ºåŸç”Ÿ Android å°±æ˜¯ MVCï¼Œå…¶ä¸­ <code>Activity</code> æ˜¯ Controllerï¼ŒXML å¸ƒå±€æ˜¯ Viewï¼Œ</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Model: ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CounterModel</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> count = <span class="hljs-number">0</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">increment</span><span class="hljs-params">()</span></span> {
        count++
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getCount</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Int</span> = count
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> model = CounterModel()

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.view_counter_content)

        <span class="hljs-keyword">val</span> countTextView = findViewById&lt;TextView&gt;(R.id.count_text_view)
        <span class="hljs-keyword">val</span> incrementButon = findViewById&lt;Button&gt;(R.id.increment_button)
        incrementButon.setOnClickListener {
            model.increment()
            countTextView.text = model.getCount().toString()
        }
    }
}
</code></pre>
<p><code>view_counter_content.xml</code> æ–‡ä»¶å¸ƒå±€ä»£ç ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center"</span>
    <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"vertical"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
        <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/count_text_view"</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span>
        <span class="hljs-attr">android:text</span>=<span class="hljs-string">"0"</span>
        <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"24sp"</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
        <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/increment_button"</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span>
        <span class="hljs-attr">android:text</span>=<span class="hljs-string">"Increment"</span> /&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
</code></pre>
<p>ä½† XMLï¼ˆViewï¼‰åªè´Ÿè´£å¸ƒå±€ï¼Œè‚©è´Ÿçš„èŒè´£å¤ªå°‘ï¼Œæ˜¾ç¤ºéƒ½æ˜¯ç”± <code>Activity</code>ï¼ˆControllerï¼‰æ¥å®Œæˆçš„ï¼Œæ‰€ä»¥ Cã€V è¿˜æ˜¯è€¦åˆåœ¨äº†ä¸€èµ·ï¼Œæˆ‘ä»¬å¯ä»¥ç§°å…¶ä¸º â€œM-VCâ€ æ¶æ„ã€‚</p>
<h3 data-id="heading-2">MVC æ‹† Viewï¼šè§£è€¦è§†å›¾</h3>
<p>æˆ‘ä»¬å¯ä»¥å°è£…ä¸€ä¸ªè‡ªå®šä¹‰ Viewï¼Œè®©å®ƒè‡ªå·±åœ¨ç®¡ç†å†…éƒ¨çš„ UI å’Œäº‹ä»¶ï¼Œå¯¹å¤–æš´éœ²æ¥å£å’Œå›è°ƒã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Model: ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CounterModel</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> count = <span class="hljs-number">0</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">increment</span><span class="hljs-params">()</span></span> {
        count++
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getCount</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Int</span> = count
}


<span class="hljs-comment">// ç®¡ç†è‡ªå·±çš„å­è§†å›¾å’Œ UI äº‹ä»¶</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CounterView</span>(context: Context, attrs: AttributeSet?) : LinearLayout(context, attrs) {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> countTextView: TextView
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> incrementButon: Button

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> onIncrementListener: (() -&gt; <span class="hljs-built_in">Unit</span>)? = <span class="hljs-literal">null</span>

    <span class="hljs-keyword">init</span> {
        <span class="hljs-comment">// åŠ è½½å¸ƒå±€</span>
        inflate(context, R.layout.view_counter_content, <span class="hljs-keyword">this</span>)

        countTextView = findViewById(R.id.count_text_view)
        incrementButon = findViewById(R.id.increment_button)

        incrementButon.setOnClickListener {
            <span class="hljs-comment">// é€šçŸ¥ Controller å‘ç”Ÿäº†ç‚¹å‡»äº‹ä»¶</span>
            onIncrementListener?.invoke()
        }
    }

    <span class="hljs-comment">// è®© Controller æ›´æ–° UI</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setCount</span><span class="hljs-params">(count: <span class="hljs-type">Int</span>)</span></span> {
        countTextView.text = count.toString()
    }

    <span class="hljs-comment">// è®© Controller ç›‘å¬ UI äº‹ä»¶ (å‘½åå·²ç»Ÿä¸€)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setOnIncrementListener</span><span class="hljs-params">(listener: () -&gt; <span class="hljs-type">Unit</span>)</span></span> {
        <span class="hljs-keyword">this</span>.onIncrementListener = listener
    }

}

<span class="hljs-comment">// Controller: Activityï¼Œè´Ÿè´£è°ƒåº¦</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MVCActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> model = CounterModel()
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_mvc)

        <span class="hljs-keyword">val</span> counterView = findViewById&lt;CounterView&gt;(R.id.counter_view)
        <span class="hljs-comment">// Controller åˆå§‹åŠ è½½æ•°æ®</span>
        counterView.setCount(model.getCount())

        <span class="hljs-comment">// Controller ç›‘å¬ UI äº‹ä»¶</span>
        counterView.setOnIncrementListener {
            <span class="hljs-comment">// äº‹ä»¶è§¦å‘ï¼Œæ›´æ–° Model</span>
            model.increment()
            <span class="hljs-comment">// ä½¿ç”¨ Model çš„æ–°æ•°æ®æ›´æ–° UI</span>
            counterView.setCount(model.getCount())
        }
    }
}
</code></pre>
<p><code>activity_mvc</code> å¸ƒå±€ä»£ç ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">com.example.app.CounterView</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/counter_view"</span>
    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center"</span>
    <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"vertical"</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">com.example.app.CounterView</span>&gt;</span>
</code></pre>
<p>è¿™æ · <code>Activity</code>ï¼ˆControllerï¼‰ å°±å¾ˆå¹²å‡€äº†ï¼Œåªè´Ÿè´£è°ƒåº¦ï¼Œå¹¶ä¸ç”¨å…³å¿ƒæ§ä»¶çš„å­˜åœ¨ã€‚</p>
<h3 data-id="heading-3">MVP æ‹† Controllerï¼šè§£è€¦æ§åˆ¶å™¨</h3>
<p>MVP æ‹†åˆ†çš„ä¸æ˜¯ Viewï¼Œå®ƒè®¤ä¸º <code>Activity</code> ä¹Ÿæ˜¯ Viewï¼ˆå› ä¸ºå®ƒæŒæœ‰ View çš„å¼•ç”¨ï¼‰ã€‚</p>
<p>MVP æŠŠæ‰€æœ‰çš„è°ƒåº¦å’Œä¸šåŠ¡é€»è¾‘æŠ½å–åˆ°äº† <code>Presenter</code> ä¸­ï¼Œé€šè¿‡æ¥å£å’Œ <code>Activity</code> é€šä¿¡ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Model: ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CounterModel</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> count = <span class="hljs-number">0</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">increment</span><span class="hljs-params">()</span></span> {
        count++
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getCount</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Int</span> = count
}

<span class="hljs-comment">// Contract: å®šä¹‰ View å’Œ Presenter çš„æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">CounterContract</span> {
    <span class="hljs-comment">// View çš„æ¥å£</span>
    <span class="hljs-keyword">interface</span> <span class="hljs-title class_">View</span> {
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">showCount</span><span class="hljs-params">(count: <span class="hljs-type">Int</span>)</span></span>
    }

    <span class="hljs-comment">// Presenter çš„æ¥å£</span>
    <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Presenter</span> {
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadInitialCount</span><span class="hljs-params">()</span></span>
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">incrementCount</span><span class="hljs-params">()</span></span>
    }
}

<span class="hljs-comment">// Presenter: æ§åˆ¶å™¨ï¼Œè´Ÿè´£æ‰€æœ‰é€»è¾‘</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CounterPresenter</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> view: CounterContract.View,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> model: CounterModel
) : CounterContract.Presenter {

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadInitialCount</span><span class="hljs-params">()</span></span> {
        view.showCount(model.getCount())
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">incrementCount</span><span class="hljs-params">()</span></span> {
        model.increment()
        view.showCount(model.getCount())
    }
}


<span class="hljs-comment">// View: Activityï¼Œå®ç°æ¥å£ï¼Œæ‰€æœ‰é€»è¾‘å§”æ‰˜ç»™ Presenter</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MVPActivity</span> : <span class="hljs-type">AppCompatActivity</span>(), CounterContract.View {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> presenter: CounterContract.Presenter
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> countTextView: TextView
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> incrementButton: Button

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_mvp)

        countTextView = findViewById(R.id.count_text_view)
        incrementButton = findViewById(R.id.increment_button)
        presenter = CounterPresenter(<span class="hljs-keyword">this</span>, CounterModel())

        <span class="hljs-comment">// ç»‘å®šæŒ‰é’®ç‚¹å‡»äº‹ä»¶åˆ° Presenter</span>
        incrementButton.setOnClickListener {
            presenter.incrementCount()
        }

        <span class="hljs-comment">// åŠ è½½åˆå§‹æ•°æ®</span>
        presenter.loadInitialCount()
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">showCount</span><span class="hljs-params">(count: <span class="hljs-type">Int</span>)</span></span> {
        countTextView.text = count.toString()
    }
}
</code></pre>
<blockquote>
<p><code>activity_mvp</code> å¸ƒå±€æ–‡ä»¶çš„ä»£ç å’Œ <code>view_counter_content</code>Â å¸ƒå±€ä¸€æ ·ã€‚</p>
</blockquote>
<p><code>Presenter</code> æ˜¯ä¸€ä¸ªçº¯ç²¹çš„ç±»ï¼Œè€Œ <code>Activity</code> å˜ä¸ºäº†è¢«åŠ¨çš„è§†å›¾ï¼Œåªè´Ÿè´£å®ç°æ¥å£ã€‚</p>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å°±çŸ¥é“äº† MVC å’Œ MVP éƒ½æ˜¯ä¸ºäº†è§£è€¦ V å’Œ Cï¼Œåªä¸è¿‡ä¸¤è€…çš„æ–¹å‘ä¸åŒã€‚MVP å¹¶æ²¡æœ‰æ¯” MVC æ›´å¥½ã€‚</p>
<h2 data-id="heading-4">MVVM ä¸æ•°æ®ç»‘å®š</h2>
<p>MVP è§£å†³äº†è€¦åˆæ€§ï¼Œä½†ä¹Ÿå¸¦æ¥äº†æ–°çš„é—®é¢˜ï¼Œéšç€ä¸šåŠ¡å˜å¾—å¤æ‚ï¼Œ<code>CounterContract.View</code> æ¥å£ä¹Ÿä¼šè¶Šæ¥è¶Šè‡ƒè‚¿ï¼ŒPresenter å’Œ View å­˜åœ¨äº†å¤§é‡çš„å‘½ä»¤å¼è°ƒç”¨ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½è®© View è®¢é˜…æ•°æ®ï¼Œæˆ‘ä»¬è´Ÿè´£ä¿®æ”¹æ•°æ®ï¼ŒView è‡ªåŠ¨æ›´æ–°å‘¢ï¼Ÿ</p>
<p>è¿™å°±æ˜¯ MVVM çš„æ ¸å¿ƒæ€æƒ³ï¼šæ•°æ®ç»‘å®šã€‚</p>
<p>æˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨ <code>ViewModel</code> å’Œ <code>LiveData</code> è¿™ä¸¤ä¸ª<strong>å·¥å…·</strong>æ¥å®ç°å®ƒï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Model: ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CounterModel</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> count = <span class="hljs-number">0</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">increment</span><span class="hljs-params">()</span></span> {
        count++
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getCount</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Int</span> = count
}

<span class="hljs-comment">// ViewModel: æŒæœ‰ Modelï¼Œæš´éœ²çŠ¶æ€</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CounterViewModel</span> : <span class="hljs-type">ViewModel</span>() {

    <span class="hljs-comment">// ViewModel è‡ªå·±åˆ›å»ºå’Œç®¡ç† Model</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> model = CounterModel()

    <span class="hljs-comment">// å¯¹å¤–æš´éœ² LiveData</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> _count = MutableLiveData&lt;<span class="hljs-built_in">Int</span>&gt;()
    <span class="hljs-keyword">val</span> count: LiveData&lt;<span class="hljs-built_in">Int</span>&gt; = _count

    <span class="hljs-keyword">init</span> {
        <span class="hljs-comment">// åŠ è½½åˆå§‹çŠ¶æ€</span>
        _count.value = model.getCount()
    }

    <span class="hljs-comment">//  å¯¹å¤–æš´éœ²ä¸šåŠ¡é€»è¾‘æ–¹æ³•</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">incrementCount</span><span class="hljs-params">()</span></span> {
        model.increment()
        _count.value = model.getCount()
    }
}


<span class="hljs-comment">// View: Activityï¼ŒæŒæœ‰ ViewModel</span>
<span class="hljs-comment">// è®¢é˜… ViewModel çš„ LiveDataï¼Œè°ƒç”¨ ViewModel çš„æ–¹æ³•</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MVVMActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> countTextView: TextView
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> incrementButton: Button
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> viewModel: CounterViewModel <span class="hljs-keyword">by</span> viewModels()

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_mvvm) <span class="hljs-comment">// åŒ activity_mvp.xml</span>

        countTextView = findViewById(R.id.count_text_view)
        incrementButton = findViewById(R.id.increment_button)

        incrementButton.setOnClickListener {
            <span class="hljs-comment">// è°ƒç”¨ ViewModel çš„æ–¹æ³•</span>
            viewModel.incrementCount()
        }

        <span class="hljs-comment">// è®¢é˜… ViewModel çš„ LiveData</span>
        viewModel.count.observe(<span class="hljs-keyword">this</span>) { newCount -&gt;
            <span class="hljs-comment">// çŠ¶æ€æ”¹å˜æ—¶ï¼Œæ›´æ–° UI</span>
            countTextView.text = newCount.toString()
        }
    }
}
</code></pre>
<p><code>Activity</code> ä¸éœ€è¦å®ç°ä»»ä½•æ¥å£ï¼Œ<code>ViewModel</code> ä¹Ÿæ— éœ€æŒæœ‰ <code>Activity</code> çš„å¼•ç”¨ï¼ŒçœŸæ­£å®ç°äº† V å’Œ VM çš„è§£è€¦ã€‚</p>
<h3 data-id="heading-5">ViewModel çš„è§’è‰²</h3>
<p><code>androidx.lifecycle.ViewModel</code> æœ€åˆæ˜¯ä¸ºäº†è§£å†³å±å¹•æ—‹è½¬ç­‰é…ç½®å˜æ›´æ—¶çš„æ•°æ®å­˜æ´»é—®é¢˜è€Œè¯ç”Ÿçš„ï¼Œæ— è®ºæ˜¯ <code>Presenter</code> æˆ–æ˜¯è‡ªå®šä¹‰çš„ VM å¯¹è±¡ï¼Œéƒ½ä¼šåœ¨ Activity é”€æ¯æ—¶é‡å»ºã€‚</p>
<blockquote>
<p>æ•°æ®ç»‘å®šçš„æœ¬è´¨æ˜¯è§‚å¯Ÿè€…æ¨¡å¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼æ¥å®ç°æ•°æ®ç»‘å®šï¼Œæ‰€ä»¥ VM ä¸ä¸€å®šä»£è¡¨äº† <code>androidx.lifecycle.ViewModel</code>ã€‚</p>
</blockquote>
<p>ä½†ç”±äº <code>ViewModel</code> çš„ç‰¹æ€§ï¼Œèƒ½å¤ŸæŒæœ‰çŠ¶æ€ã€å®Œæˆé€»è¾‘å¤„ç†ï¼Œå› æ­¤ï¼Œå®ƒå®Œç¾åœ°æ‰¿æ‹…äº† VM çš„è§’è‰²ã€‚</p>
<p>æ‰€ä»¥ï¼Œç°åœ¨ MVVM æ¶æ„ä¸­ï¼š</p>
<ul>
<li>VM æŒ‡çš„ä¸€èˆ¬æ˜¯ ViewModelï¼ˆå†…éƒ¨æŒæœ‰ <code>LiveData</code> æˆ– <code>StateFlow</code>ï¼‰</li>
<li>V æŒ‡çš„æ˜¯ Activity / Fragment / Composableï¼Œ</li>
<li>M æ˜¯ Modelï¼ˆåœ¨å¤æ‚é¡¹ç›®ä¸­é€šå¸¸æ˜¯ <code>Repository</code> æˆ– <code>UseCase</code>ï¼‰</li>
</ul>
<h2 data-id="heading-6">æ€»ç»“</h2>
<p>æ¶æ„è®¾è®¡çš„çœŸæ­£æ ¸å¿ƒå°±æ˜¯<strong>æ‹†åˆ†</strong>ï¼Œæ— è®ºæ˜¯ MVCï¼ˆæ‹†åˆ† Viewï¼‰ã€MVPï¼ˆæ‹†åˆ† Controllerï¼‰è¿˜æ˜¯ MVVMï¼ˆç”¨æ•°æ®ç»‘å®šè§£è€¦ï¼‰ã€‚å®ƒä»¬çš„ç›®çš„éƒ½æ˜¯å°†è‡ƒè‚¿çš„é›†åˆä½“ï¼Œæ‹†åˆ†ä¸ºæ¸…æ™°çš„ã€å„å¸å…¶èŒçš„ç»„ä»¶ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§æ¨¡å‹å…¥é—¨ç¬¬ä¸€è¯¾ï¼šå½»åº•ææ‡‚Tokenï¼]]></title>    <link>https://juejin.cn/post/7570500819889389611</link>    <guid>https://juejin.cn/post/7570500819889389611</guid>    <pubDate>2025-11-10T08:00:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570500819889389611" data-draft-id="7570598043297923135" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§æ¨¡å‹å…¥é—¨ç¬¬ä¸€è¯¾ï¼šå½»åº•ææ‡‚Tokenï¼"/> <meta itemprop="keywords" content="LLM,ç¨‹åºå‘˜,Agent"/> <meta itemprop="datePublished" content="2025-11-10T08:00:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AIå¤§æ¨¡å‹"/> <meta itemprop="url" content="https://juejin.cn/user/3817967696221534"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§æ¨¡å‹å…¥é—¨ç¬¬ä¸€è¯¾ï¼šå½»åº•ææ‡‚Tokenï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3817967696221534/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AIå¤§æ¨¡å‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T08:00:50.000Z" title="Mon Nov 10 2025 08:00:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote>
<p>ä»é›¶å¼€å§‹ï¼Œç”¨10åˆ†é’ŸæŒæ¡å¤§æ¨¡å‹ä¸–ç•Œçš„â€œåŸºç¡€è´§å¸â€</p>
<p>æœ‹å‹ä»¬ï¼Œæ¬¢è¿æ¥åˆ°æˆ‘çš„å¤§æ¨¡å‹å­¦ä¹ ä¹‹æ—…ç¬¬ä¸€ç«™ï¼ä»Šå¤©æˆ‘ä»¬è¦æ”»å…‹çš„ï¼Œæ˜¯é‚£ä¸ªæ— å¤„ä¸åœ¨å´åˆå¸¸å¸¸è®©äººå›°æƒ‘çš„æ¦‚å¿µâ€”â€”<strong>Token</strong>ã€‚</p>
<p>ä½œä¸ºä¸€ä¸ªæ–°æ‰‹ï¼Œæˆ‘æ·±çŸ¥åˆå­¦è€…çš„ç—›ç‚¹ã€‚æ‰€ä»¥è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä¼šç”¨æœ€ç›´ç™½çš„è¯­è¨€ï¼Œå¸¦ä½ ä»é›¶å¼€å§‹ï¼Œä¸€æ­¥æ­¥ææ‡‚Tokenåˆ°åº•æ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆå®ƒå¦‚æ­¤é‡è¦ã€‚</p>
<p>å›¾ç¤ºï¼šå°±åƒæŠŠä¸€ç›’ç³–æœåˆ†è£…æˆå°åŒ…ï¼ŒTokenization å°†æ–‡æœ¬åˆ‡åˆ†ä¸ºæ¨¡å‹å¯å¤„ç†çš„åŸºæœ¬å•å…ƒ</p>
<h2 data-id="heading-0">ä¸€ã€åˆè¯†Tokenï¼šä»â€œåˆ†ç³–æœâ€è¯´èµ·</h2>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ é¢å‰æœ‰ä¸€ç›’äº”å½©æ–‘æ–“çš„ç³–æœï¼Œç°åœ¨è¦æŠŠå®ƒä»¬åˆ†è£…æˆå°åŒ…è£…ã€‚</p>
<p><strong>åŸå§‹ç³–æœ</strong>ï¼š<code>æˆ‘çˆ±å­¦ä¹ äººå·¥æ™ºèƒ½æŠ€æœ¯</code></p>
<p><strong>åˆ†è£…åçš„ç³–æœåŒ…</strong>ï¼š<code>["æˆ‘", "çˆ±", "å­¦ä¹ ", "äººå·¥", "æ™ºèƒ½", "æŠ€æœ¯"]</code></p>
<p>åœ¨è¿™ä¸ªæ¯”å–»ä¸­ï¼š</p>
<ul>
<li>
<p><strong>æ•´å¥è¯</strong></p>
<p>å°±åƒé‚£ç›’å®Œæ•´çš„ç³–æœ</p>
</li>
<li>
<p><strong>æ¯ä¸ªå°åŒ…è£…</strong></p>
<p>å°±æ˜¯ä¸€ä¸ªToken</p>
</li>
<li>
<p><strong>åˆ†è£…è¿‡ç¨‹</strong></p>
<p>å°±æ˜¯Tokenizationï¼ˆåˆ†è¯ï¼‰</p>
</li>
</ul>
<p>çœ‹åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½æç„¶å¤§æ‚Ÿï¼šâ€œå“¦ï¼ŒTokenå°±æ˜¯è¯è¯­å˜›ï¼â€</p>
<p>åˆ«æ€¥ï¼Œäº‹æƒ…æ²¡é‚£ä¹ˆç®€å•ã€‚è®©æˆ‘ä»¬ç»§ç»­æ·±å…¥...</p>
<h2 data-id="heading-1">äºŒã€Tokençš„çœŸé¢ç›®ï¼šä¸åªæ˜¯è¯è¯­</h2>
<p>åœ¨å®é™…çš„å¤§æ¨¡å‹ä¸­ï¼ŒTokençš„åˆ’åˆ†è¦æ¯”ç®€å•çš„â€œæŒ‰è¯åˆ†â€å¤æ‚å¾—å¤šã€‚è®©æˆ‘ä»¬çœ‹çœ‹çœŸå®æƒ…å†µï¼š</p>
<p><strong>è‹±æ–‡ä¾‹å­</strong>ï¼š</p>
<ul>
<li>è¾“å…¥ï¼š<code>"I'm learning AI."</code></li>
<li>TokenåŒ–ï¼š<code>["I", "'", "m", " learning", " AI", "."]</code></li>
</ul>
<p><strong>ä¸­æ–‡ä¾‹å­</strong>ï¼š</p>
<ul>
<li>è¾“å…¥ï¼š<code>"æˆ‘æ­£åœ¨å­¦ä¹ äººå·¥æ™ºèƒ½"</code></li>
<li>TokenåŒ–ï¼š<code>["æˆ‘", "æ­£åœ¨", "å­¦ä¹ ", "äººå·¥", "æ™ºèƒ½"]</code></li>
</ul>
<p>å‘ç°äº†å—ï¼ŸTokenå¯ä»¥æ˜¯ï¼š</p>
<ul>
<li>
<p>å®Œæ•´çš„è¯ï¼ˆå¦‚â€œå­¦ä¹ â€ï¼‰</p>
</li>
<li>
<p>è¯çš„ä¸€éƒ¨åˆ†ï¼ˆå¦‚â€œäººå·¥â€ã€â€œæ™ºèƒ½â€ï¼‰</p>
</li>
<li>
<p>æ ‡ç‚¹ç¬¦å·ï¼ˆå¦‚å¥å·ï¼‰</p>
</li>
<li>
<p>ç”šè‡³å•è¯çš„ä¸€éƒ¨åˆ†ï¼ˆå¦‚è‹±æ–‡ä¸­çš„"'m"ï¼‰</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8dd9ba3f0094e3bb57b6e1ce508f1ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763366450&amp;x-signature=ZKzP0UJrRB4YiRIsx5uEGHZ6Suo%3D" alt="" loading="lazy"/></p>
</li>
</ul>
<p>å›¾ç¤ºï¼šä¸åŒè¯­è¨€çš„TokenåŒ–ç»“æœå¯¹æ¯”</p>
<h2 data-id="heading-2">ä¸‰ã€ä¸ºä»€ä¹ˆéœ€è¦Tokenï¼Ÿä¸‰å¤§æ ¸å¿ƒåŸå› </h2>
<ol start="0">
<li>
<p><strong>è§£å†³è¯æ±‡è¡¨çˆ†ç‚¸é—®é¢˜</strong></p>
<p>å¦‚æœæ¯ä¸ªè¯éƒ½å•ç‹¬å¤„ç†ï¼Œæ¨¡å‹éœ€è¦è®°ä½æ•°ç™¾ä¸‡ä¸ªè¯ã€‚é€šè¿‡å°†è¯æ‹†åˆ†æˆæ›´å°çš„Tokenï¼Œåªéœ€è¦å‡ åƒä¸ªTokenå°±èƒ½ç»„åˆå‡ºå‡ ä¹æ‰€æœ‰çš„è¯ã€‚</p>
</li>
<li>
<p><strong>å¤„ç†æœªçŸ¥è¯æ±‡</strong></p>
<p>å½“æ¨¡å‹é‡åˆ°æ²¡è§è¿‡çš„è¯æ—¶ï¼Œå¦‚æœæ˜¯åŸºäºTokençš„ï¼Œå®ƒå¯ä»¥ç”¨å·²çŸ¥çš„Tokenæ¥â€œæ‹¼å‡‘â€ç†è§£ã€‚æ¯”å¦‚é‡åˆ°â€œæ·±åº¦å­¦ä¹ â€ï¼Œå³ä½¿æ²¡å­¦è¿‡è¿™ä¸ªè¯ï¼Œä¹ŸçŸ¥é“â€œæ·±åº¦â€å’Œâ€œå­¦ä¹ â€è¿™ä¸¤ä¸ªTokenã€‚</p>
</li>
<li>
<p><strong>ç»Ÿä¸€å¤šè¯­è¨€å¤„ç†</strong></p>
<p>ä¸åŒè¯­è¨€çš„è¯æ±‡ç»“æ„å·®å¼‚å¾ˆå¤§ï¼Œä½†é€šè¿‡TokenåŒ–ï¼Œå¯ä»¥å»ºç«‹ç»Ÿä¸€çš„æ–¹å¼æ¥å¤„ç†å„ç§è¯­è¨€ã€‚</p>
</li>
</ol>
<h2 data-id="heading-3">å››ã€Tokençš„â€œä»·æ ¼ä½“ç³»â€ï¼šæˆæœ¬ä¸é™åˆ¶</h2>
<p>ç†è§£Tokençš„å¦ä¸€ä¸ªé‡è¦è§’åº¦æ˜¯ï¼š<strong>Tokenæ˜¯è®¡ç®—æˆæœ¬çš„å•ä½</strong>ã€‚</p>
<p>åœ¨å¤§å¤šæ•°å¤§æ¨¡å‹ä¸­ï¼š</p>
<ul>
<li>
<p><strong>è¾“å…¥å’Œè¾“å‡ºéƒ½æŒ‰Tokenè®¡æ•°</strong></p>
</li>
<li>
<p><strong>è®¡ç®—èµ„æºä¸Tokenæ•°é‡ç›´æ¥ç›¸å…³</strong></p>
</li>
<li>
<p><strong>æ¨¡å‹æœ‰æœ€å¤§Tokené™åˆ¶</strong></p>
<p>ï¼ˆä¸Šä¸‹æ–‡çª—å£ï¼‰</p>
</li>
</ul>
<p>ä¸¾ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs">ç”¨æˆ·è¾“å…¥ï¼š32ä¸ªTokenæ¨¡å‹å›å¤ï¼š45ä¸ªTokenæœ¬æ¬¡å¯¹è¯æ€»è®¡ï¼š77ä¸ªToken
</code></pre>
<p>è¿™å°±è§£é‡Šäº†ä¸ºä»€ä¹ˆï¼š</p>
<ul>
<li>é•¿æ–‡æ¡£å¤„ç†æˆæœ¬æ›´é«˜</li>
<li>å¯¹è¯æœ‰é•¿åº¦é™åˆ¶</li>
<li>ç²¾ç®€çš„Promptèƒ½èŠ‚çœèµ„æº</li>
</ul>
<p>å›¾ç¤ºï¼šAPIè°ƒç”¨ä¸­Tokençš„è®¡è´¹æ–¹å¼ï¼ˆæ¥æºï¼šOpenAIï¼‰</p>
<h2 data-id="heading-4">äº”ã€äº²æ‰‹å®éªŒï¼šçœ‹çœ‹çœŸå®Tokené•¿ä»€ä¹ˆæ ·</h2>
<p>ç†è®ºè¯´å†å¤šï¼Œä¸å¦‚äº²æ‰‹è¯•è¯•ã€‚ä½ å¯ä»¥åœ¨ä»¥ä¸‹å¹³å°ç›´è§‚çœ‹åˆ°æ–‡æœ¬æ˜¯å¦‚ä½•è¢«TokenåŒ–çš„ï¼š</p>
<p><strong>æ¨èå·¥å…·</strong>ï¼š</p>
<ul>
<li>
<p><strong>OpenAI Tokenizer</strong></p>
<p>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.openai.com%2Ftokenizer" target="_blank" title="https://platform.openai.com/tokenizer" ref="nofollow noopener noreferrer">platform.openai.com/tokenizer</a></p>
</li>
<li>
<p><strong>Hugging Face Tokenizer</strong></p>
<p>ï¼šå„ç§æ¨¡å‹çš„åœ¨çº¿æ¼”ç¤º</p>
</li>
</ul>
<p>è¯•ç€è¾“å…¥ä¸€äº›æ–‡æœ¬ï¼Œè§‚å¯Ÿå®ƒä»¬æ˜¯å¦‚ä½•è¢«æ‹†åˆ†çš„ã€‚è¿™ä¸ªç»ƒä¹ ä¼šè®©ä½ å¯¹Tokenæœ‰æ›´ç›´è§‚çš„æ„Ÿå—ã€‚</p>
<h2 data-id="heading-5">å…­ã€Tokenåœ¨å¤§æ¨¡å‹ä¸­çš„æ ¸å¿ƒä½œç”¨</h2>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä»æ›´é«˜è§†è§’çœ‹Tokençš„é‡è¦æ€§ï¼š</p>
<ol start="0">
<li>
<p><strong>æ¨¡å‹ç†è§£çš„â€œåŸææ–™â€</strong></p>
<p>å¤§æ¨¡å‹å¹¶ä¸ç›´æ¥ç†è§£æ–‡å­—ï¼Œå®ƒä»¬ç†è§£çš„æ˜¯Tokençš„æ•°å­—è¡¨ç¤ºã€‚æ¯ä¸ªTokenéƒ½è¢«è½¬æ¢æˆä¸€ä¸ªæ•°å­—IDï¼Œæ¨¡å‹åŸºäºè¿™äº›IDè¿›è¡Œè®¡ç®—ã€‚</p>
</li>
<li>
<p><strong>è®­ç»ƒçš„åŸºç¡€å•å…ƒ</strong></p>
<p>åœ¨æ¨¡å‹è®­ç»ƒæ—¶ï¼Œå®ƒå­¦ä¹ çš„æ˜¯Tokenä¹‹é—´çš„æ¦‚ç‡å…³ç³»ã€‚â€œä»Šå¤©å¤©æ°”å¾ˆâ€åé¢å¾ˆå¯èƒ½æ¥â€œå¥½â€ï¼Œè€Œä¸æ˜¯â€œé¦™è•‰â€ã€‚</p>
</li>
<li>
<p><strong>ç”Ÿæˆæ–‡æœ¬çš„â€œç§¯æœ¨â€</strong></p>
<p>å½“æ¨¡å‹ç”Ÿæˆæ–‡æœ¬æ—¶ï¼Œå®ƒå®é™…ä¸Šæ˜¯åœ¨é¢„æµ‹ä¸‹ä¸€ä¸ªæœ€å¯èƒ½çš„Tokenï¼Œç„¶ååŸºäºæ–°çš„Tokenç»§ç»­é¢„æµ‹ä¸‹ä¸€ä¸ªï¼Œå¦‚æ­¤å¾ªç¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8002cf564fe24d0384a0853f49484c7e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763366450&amp;x-signature=YZ6nNelqrKMIzROvBHzdqGXy4tU%3D" alt="" loading="lazy"/></p>
</li>
</ol>
<h2 data-id="heading-6">ä¸ƒã€è¿›é˜¶çŸ¥è¯†ï¼šä¸åŒæ¨¡å‹çš„Tokenå·®å¼‚</h2>
<p>å½“ä½ æ·±å…¥ä½¿ç”¨æ—¶ï¼Œä¼šå‘ç°ä¸åŒæ¨¡å‹æœ‰ä¸åŒçš„TokenåŒ–ç­–ç•¥ï¼š</p>
<ul>
<li>
<p><strong>GPTç³»åˆ—</strong></p>
<p>ï¼šä½¿ç”¨Byte Pair Encoding (BPE)</p>
</li>
<li>
<p><strong>BERTç³»åˆ—</strong></p>
<p>ï¼šä½¿ç”¨WordPiece</p>
</li>
<li>
<p><strong>SentencePiece</strong></p>
<p>ï¼šç”¨äºå¤šè¯­è¨€æ¨¡å‹</p>
</li>
</ul>
<p>ä¸è¿‡ä½œä¸ºåˆå­¦è€…ï¼Œä½ åªéœ€è¦çŸ¥é“ï¼š<strong>ä¸åŒæ¨¡å‹å¯¹åŒä¸€æ–‡æœ¬å¯èƒ½äº§ç”Ÿä¸åŒæ•°é‡çš„Token</strong>ï¼Œè¿™ä¼šå½±å“ä½¿ç”¨æˆæœ¬å’Œæ•ˆæœã€‚</p>
<p><strong>å®è·µå°è´´å£«</strong></p>
<p>åŸºäºå¯¹Tokençš„ç†è§£ï¼Œè¿™é‡Œæœ‰äº›å®ç”¨å»ºè®®ï¼š</p>
<ol start="0">
<li>
<p><strong>ä¼˜åŒ–Prompt</strong></p>
<p>ï¼šåˆ é™¤ä¸å¿…è¦çš„è¯è¯­ï¼Œå‡å°‘Tokenæ¶ˆè€—</p>
</li>
<li>
<p><strong>å¤„ç†é•¿æ–‡æœ¬</strong></p>
<p>ï¼šæ„è¯†åˆ°é•¿æ–‡æ¡£éœ€è¦åˆ†æ®µå¤„ç†</p>
</li>
<li>
<p><strong>æˆæœ¬ä¼°ç®—</strong></p>
<p>ï¼šåœ¨è°ƒç”¨APIå‰ï¼Œå…ˆç”¨Tokenizerå·¥å…·ä¼°ç®—Tokenæ•°é‡</p>
</li>
<li>
<p><strong>ä¸­æ–‡ç‰¹æ€§</strong></p>
<p>ï¼šä¸­æ–‡å­—ç¬¦é€šå¸¸1ä¸ªæ±‰å­—=1-2ä¸ªTokenï¼Œè‹±æ–‡å•è¯å¯èƒ½è¢«æ‹†åˆ†æˆå¤šä¸ªToken</p>
</li>
</ol>
<p><strong>ç»“è¯­</strong></p>
<p>æ­å–œï¼ç°åœ¨ä½ å·²ç»ä¸å†æ˜¯Tokenå°ç™½äº†ã€‚æˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹ä»Šå¤©çš„é‡ç‚¹ï¼š</p>
<ul>
<li>âœ…Â <strong>Tokenæ˜¯æ–‡æœ¬çš„åŸºæœ¬å¤„ç†å•å…ƒ</strong>ï¼Œä¸å®Œå…¨æ˜¯è¯è¯­</li>
<li>âœ…Â <strong>TokenåŒ–è®©æ¨¡å‹èƒ½é«˜æ•ˆå¤„ç†å„ç§è¯­è¨€å’Œæ–°è¯</strong></li>
<li>âœ…Â <strong>Tokenæ˜¯è®¡ç®—æˆæœ¬å’Œèµ„æºé™åˆ¶çš„è®¡é‡å•ä½</strong></li>
<li>âœ…Â <strong>ç†è§£Tokenæœ‰åŠ©äºä¼˜åŒ–ä½¿ç”¨å¤§æ¨¡å‹</strong></li>
</ul>
<p>å­¦ä¹ å¤§æ¨¡å‹å°±åƒå­¦ä¸€é—¨æ–°è¯­è¨€ï¼Œè€ŒTokenå°±æ˜¯è¿™é—¨è¯­è¨€çš„å­—æ¯è¡¨ã€‚æŒæ¡äº†å®ƒï¼Œä½ å°±æ‰“å¼€äº†ç†è§£æ•´ä¸ªAIä¸–ç•Œçš„å¤§é—¨ã€‚</p>
<p><strong>PSï¼š</strong> åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢ç´¢å¦ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µâ€”â€”Embeddingï¼ˆåµŒå…¥ï¼‰ï¼Œçœ‹çœ‹æ¨¡å‹æ˜¯å¦‚ä½•æŠŠæ–‡å­—å˜æˆæ•°å­—å‘é‡çš„ã€‚ç›¸ä¿¡æˆ‘ï¼Œé‚£ä¼šæ˜¯å¦ä¸€ä¸ªâ€œåŸæ¥å¦‚æ­¤â€çš„ç¾å¦™æ—¶åˆ»ï¼</p>
<p><em>è§‰å¾—æœ‰æ”¶è·å—ï¼Ÿæ¬¢è¿æ”¶è—è¿™ç¯‡æ–‡ç« ï¼Œåœ¨å®è·µè¿‡ç¨‹ä¸­æœ‰ä»»ä½•å…³äºTokençš„é—®é¢˜ï¼Œéƒ½å¯ä»¥å›æ¥æ¸©ä¹ ã€‚å­¦ä¹ è·¯ä¸Šï¼Œæˆ‘ä»¬ä¸€èµ·è¿›æ­¥ï¼</em></p>
<h2 data-id="heading-7">å­¦ä¹ èµ„æºæ¨è</h2>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3 çš„ Composition API å’Œ Options API æœ‰å“ªäº›åŒºåˆ«ï¼Ÿä¸¾ä¾‹è¯´æ˜ Composition API çš„ä¼˜åŠ¿ã€‚]]></title>    <link>https://juejin.cn/post/7570604028633628707</link>    <guid>https://juejin.cn/post/7570604028633628707</guid>    <pubDate>2025-11-10T06:16:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570604028633628707" data-draft-id="7570659828810334242" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3 çš„ Composition API å’Œ Options API æœ‰å“ªäº›åŒºåˆ«ï¼Ÿä¸¾ä¾‹è¯´æ˜ Composition API çš„ä¼˜åŠ¿ã€‚"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-10T06:16:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯ä¸€è¯¾"/> <meta itemprop="url" content="https://juejin.cn/user/1169536102963917"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3 çš„ Composition API å’Œ Options API æœ‰å“ªäº›åŒºåˆ«ï¼Ÿä¸¾ä¾‹è¯´æ˜ Composition API çš„ä¼˜åŠ¿ã€‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1169536102963917/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯ä¸€è¯¾
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T06:16:23.000Z" title="Mon Nov 10 2025 06:16:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>ä¸€ã€ä¸¤è€…çš„å®šä¹‰ä¸æ ¸å¿ƒæ€æƒ³</strong></h2>


















































<table><thead><tr><th><strong>é¡¹ç›®</strong></th><th><strong>Options APIï¼ˆVue2 ä¼ ç»Ÿå†™æ³•ï¼‰</strong></th><th><strong>Composition APIï¼ˆVue3 æ–°å†™æ³•ï¼‰</strong></th></tr></thead><tbody><tr><td>æ ¸å¿ƒç†å¿µ</td><td>æŒ‰â€œé€‰é¡¹ç±»å‹â€ç»„ç»‡ä»£ç ï¼ˆdataã€methodsã€computedã€watch åˆ†åŒºï¼‰</td><td>æŒ‰â€œåŠŸèƒ½é€»è¾‘â€ç»„ç»‡ä»£ç ï¼ˆé€»è¾‘èšåˆã€å‡½æ•°å¤ç”¨ï¼‰</td></tr><tr><td>å†™æ³•å½¢å¼</td><td>export default { data(){}, methods:{}, computed:{}}</td><td>ä½¿ç”¨ setup() å‡½æ•°ï¼Œé€šè¿‡ refã€reactiveã€computedã€watch ç­‰ç»„åˆé€»è¾‘</td></tr><tr><td>å­¦ä¹ æ›²çº¿</td><td>ç®€å•ç›´è§‚ï¼Œé€‚åˆå°é¡¹ç›®</td><td>åˆæœŸç•¥å¤æ‚ï¼Œä½†åœ¨å¤§å‹é¡¹ç›®ä¸­æ›´æ¸…æ™°</td></tr><tr><td>ä»£ç ç»„ç»‡</td><td>åˆ†æ•£ï¼šç›¸å…³é€»è¾‘è¢«æ‹†åœ¨ä¸åŒé€‰é¡¹ä¸­</td><td>èšåˆï¼šç›¸å…³é€»è¾‘å¯ä»¥é›†ä¸­åœ¨ä¸€èµ·</td></tr><tr><td>é€»è¾‘å¤ç”¨</td><td>ä¾èµ– mixinsï¼ˆæœ‰å‘½åå†²çªã€æ¥æºä¸æ˜ç­‰é—®é¢˜ï¼‰</td><td>å¯é€šè¿‡è‡ªå®šä¹‰ hook å‡½æ•°ï¼ˆç»„åˆå¼å‡½æ•°ï¼‰çµæ´»å¤ç”¨</td></tr><tr><td>this æŒ‡å‘</td><td>è‡ªåŠ¨ç»‘å®šç»„ä»¶å®ä¾‹</td><td>æ²¡æœ‰ thisï¼Œç›´æ¥ä½¿ç”¨å®šä¹‰çš„å˜é‡</td></tr><tr><td>Tree-shaking</td><td>ä¸æ”¯æŒï¼ˆVue å…¨é‡å¼•å…¥ï¼‰</td><td>æ”¯æŒæŒ‰éœ€å¼•å…¥ï¼Œæ„å»ºæ›´å°</td></tr><tr><td>ç±»å‹æ”¯æŒ</td><td>TypeScript å…¼å®¹è¾ƒå¼±</td><td>å¤©ç„¶æ”¯æŒ TypeScript ç±»å‹æ¨å¯¼</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-1"><strong>äºŒã€ç¤ºä¾‹å¯¹æ¯”</strong></h2>
<h3 data-id="heading-2"><strong>ğŸ§© 1. Options API å†™æ³•ï¼ˆVue2 é£æ ¼ï¼‰</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>
    }
  },
  <span class="hljs-attr">computed</span>: {
    <span class="hljs-title function_">double</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> * <span class="hljs-number">2</span>
    }
  },
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-title function_">increment</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++
    }
  }
}
</code></pre>
<h3 data-id="heading-3"><strong>ğŸ§  2. Composition API å†™æ³•ï¼ˆVue3 æ–°å†™æ³•ï¼‰</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { ref, computed } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">setup</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)
    <span class="hljs-keyword">const</span> double = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> count.<span class="hljs-property">value</span> * <span class="hljs-number">2</span>)
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">increment</span> = (<span class="hljs-params"/>) =&gt; count.<span class="hljs-property">value</span>++

    <span class="hljs-keyword">return</span> { count, double, increment }
  }
}
</code></pre>
<p>ğŸ‘‰ å¯ä»¥çœ‹åˆ°ï¼š</p>
<ul>
<li>Composition API ç›´æ¥é€šè¿‡å‡½æ•°å¼ API æ“ä½œæ•°æ®ï¼›</li>
<li>ä¸ä¾èµ– thisï¼›</li>
<li>æ‰€æœ‰é€»è¾‘åœ¨ setup() å†…éƒ¨é›†ä¸­å®šä¹‰ï¼Œæ›´æ˜“äºç»„åˆä¸æŠ½ç¦»ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-4"><strong>ä¸‰ã€Composition API çš„ä¼˜åŠ¿è¯¦è§£</strong></h2>
<h3 data-id="heading-5"><strong>1ï¸âƒ£ é€»è¾‘èšåˆï¼ˆLogic Compositionï¼‰</strong></h3>
<p>åœ¨ Options API ä¸­ï¼Œä¸€ä¸ªåŠŸèƒ½é€»è¾‘å¾€å¾€è¢«æ‹†æ•£åœ¨ä¸åŒåŒºåŸŸï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¾‹å­ï¼šè·å–ç”¨æˆ·æ•°æ® + ç›‘å¬çª—å£å¤§å°</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">width</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span> }
  },
  <span class="hljs-title function_">created</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">fetchUser</span>()
  },
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-title function_">fetchUser</span>(<span class="hljs-params"/>) { ... }
  },
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'resize'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">updateWidth</span>)
  },
  <span class="hljs-title function_">beforeUnmount</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'resize'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">updateWidth</span>)
  }
}
</code></pre>
<p>è¿™äº›é€»è¾‘â€œåŠŸèƒ½ä¸Šæ˜¯ç›¸å…³çš„â€ï¼Œä½†åœ¨ä»£ç ä¸­è¢«â€œç»“æ„ä¸Šæ‹†æ•£â€ã€‚</p>
<p>Composition API èƒ½è®©å®ƒä»¬èšåˆåœ¨ä¸€èµ·ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { ref, onMounted, onUnmounted } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">setup</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> user = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>)
    <span class="hljs-keyword">const</span> width = <span class="hljs-title function_">ref</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>)

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchUser</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; { ... }

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">updateWidth</span> = (<span class="hljs-params"/>) =&gt; { width.<span class="hljs-property">value</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span> }

    <span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">fetchUser</span>()
      <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'resize'</span>, updateWidth)
    })
    <span class="hljs-title function_">onUnmounted</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'resize'</span>, updateWidth))

    <span class="hljs-keyword">return</span> { user, width }
  }
}
</code></pre>
<p>è¿™æ ·ï¼š</p>
<ul>
<li>é€»è¾‘æ›´èšåˆï¼›</li>
<li>ç”Ÿå‘½å‘¨æœŸä¸é€»è¾‘æ“ä½œæ›´æ¥è¿‘ï¼›</li>
<li>æ›´å®¹æ˜“ç»´æŠ¤å’Œé˜…è¯»ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-6"><strong>2ï¸âƒ£ é€»è¾‘å¤ç”¨æ›´å¼ºï¼ˆHooksï¼‰</strong></h3>
<p>Vue2 æ—¶ä»£é€»è¾‘å¤ç”¨ä¸»è¦é  <strong>Mixins</strong>ï¼Œä½†å­˜åœ¨ï¼š</p>
<ul>
<li>
<p>å‘½åå†²çªï¼›</p>
</li>
<li>
<p>æ¥æºä¸æ˜ï¼›</p>
</li>
<li>
<p>æ•°æ®æ¥æºä¸æ¸…æ™°ï¼›</p>
</li>
<li>
<p>é€»è¾‘éš¾è¿½è¸ªã€‚</p>
</li>
</ul>
<p>è€Œ Composition API å…è®¸æˆ‘ä»¬åƒ React Hooks ä¸€æ ·å°è£…å¤ç”¨é€»è¾‘ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// useMouse.js</span>
<span class="hljs-keyword">import</span> { ref, onMounted, onUnmounted } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useMouse</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> x = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)
  <span class="hljs-keyword">const</span> y = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">update</span> = e =&gt; {
    x.<span class="hljs-property">value</span> = e.<span class="hljs-property">pageX</span>
    y.<span class="hljs-property">value</span> = e.<span class="hljs-property">pageY</span>
  }
  <span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousemove'</span>, update))
  <span class="hljs-title function_">onUnmounted</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mousemove'</span>, update))
  <span class="hljs-keyword">return</span> { x, y }
}
</code></pre>
<p>åœ¨ç»„ä»¶ä¸­ç›´æ¥ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useMouse } <span class="hljs-keyword">from</span> <span class="hljs-string">'./useMouse'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">setup</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> { x, y } = <span class="hljs-title function_">useMouse</span>()
    <span class="hljs-keyword">return</span> { x, y }
  }
}
</code></pre>
<p>ğŸ‘‰ é€»è¾‘æŠ½ç¦»æ¸…æ™°ï¼Œå¤ç”¨ç®€å•ï¼Œå®Œå…¨æ— å‰¯ä½œç”¨ã€‚</p>
<hr/>
<h3 data-id="heading-7"><strong>3ï¸âƒ£ æ›´å¥½çš„ TypeScript æ”¯æŒ</strong></h3>
<p>åœ¨ Composition API ä¸­ï¼š</p>
<ul>
<li>refã€reactive éƒ½æœ‰å®Œå–„çš„ç±»å‹æ¨å¯¼ï¼›</li>
<li>ä¸éœ€è¦å†å£°æ˜ this çš„ç±»å‹ï¼›</li>
<li>è¿”å›å€¼ç›´æ¥ç”± IDE è‡ªåŠ¨æç¤ºç±»å‹ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-8"><strong>4ï¸âƒ£ æ€§èƒ½å’Œç¼–è¯‘ä¼˜åŒ–</strong></h3>
<ul>
<li>Vue3 ä½¿ç”¨äº† <strong>åŸºäºæ¨¡æ¿ç¼–è¯‘ä¼˜åŒ–çš„å“åº”æ€§è¿½è¸ª</strong>ï¼›</li>
<li>Composition API çš„å‡½æ•°å¼ç»“æ„æ›´å®¹æ˜“è¢«ç¼–è¯‘å™¨åˆ†æï¼›</li>
<li>ç»“åˆ <strong>Tree-shaking</strong> å¯å‡å°åŒ…ä½“ç§¯ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-9"><strong>å››ã€ä½•æ—¶ç”¨å“ªç§ APIï¼Ÿ</strong></h2>

























<table><thead><tr><th><strong>åœºæ™¯</strong></th><th><strong>æ¨è API</strong></th></tr></thead><tbody><tr><td>å°å‹é¡¹ç›® / åˆå­¦è€…</td><td>Options APIï¼ˆç»“æ„ç›´è§‚ï¼‰</td></tr><tr><td>å¤§å‹é¡¹ç›® / å¤æ‚é€»è¾‘</td><td>Composition APIï¼ˆé€»è¾‘æ›´æ¸…æ™°ï¼Œå¯å¤ç”¨ï¼‰</td></tr><tr><td>éœ€è¦é€»è¾‘æŠ½ç¦»æˆ–æ’ä»¶å¼€å‘</td><td>Composition API</td></tr><tr><td>éœ€è¦ TypeScript æ”¯æŒ</td><td>Composition API</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-10"><strong>äº”ã€æ€»ç»“ä¸€å¥è¯</strong></h2>
<blockquote>
<p><strong>Options API</strong>ï¼šç»“æ„åŒ–ã€ä¸Šæ‰‹å¿«ï¼Œä½†é€»è¾‘åˆ†æ•£ã€‚</p>
</blockquote>
<blockquote>
<p><strong>Composition API</strong>ï¼šå‡½æ•°åŒ–ã€æ¨¡å—åŒ–ï¼Œé€»è¾‘èšåˆã€å¤ç”¨å¼ºï¼Œæ˜¯ Vue3 çš„æœªæ¥æ–¹å‘ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[éƒ½è¯´node.jsæ˜¯äº‹ä»¶é©±åŠ¨çš„ï¼Œä»€ä¹ˆæ˜¯äº‹ä»¶é©±åŠ¨ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7570295366480576548</link>    <guid>https://juejin.cn/post/7570295366480576548</guid>    <pubDate>2025-11-10T06:19:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570295366480576548" data-draft-id="7570339961909329963" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="éƒ½è¯´node.jsæ˜¯äº‹ä»¶é©±åŠ¨çš„ï¼Œä»€ä¹ˆæ˜¯äº‹ä»¶é©±åŠ¨ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,Node.js"/> <meta itemprop="datePublished" content="2025-11-10T06:19:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¹Ÿæ— é£é›¨ä¹Ÿé›¾æ™´"/> <meta itemprop="url" content="https://juejin.cn/user/2175258804632332"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            éƒ½è¯´node.jsæ˜¯äº‹ä»¶é©±åŠ¨çš„ï¼Œä»€ä¹ˆæ˜¯äº‹ä»¶é©±åŠ¨ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2175258804632332/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¹Ÿæ— é£é›¨ä¹Ÿé›¾æ™´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T06:19:49.000Z" title="Mon Nov 10 2025 06:19:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼€å¤´</h2>
<p>ä¹‹å‰çœ‹ä¸€äº› Node.js çš„æŠ€æœ¯æ–‡ç« æˆ–è€…å®˜æ–¹æ–‡æ¡£ï¼Œç»å¸¸ä¼šçœ‹åˆ°"äº‹ä»¶é©±åŠ¨"è¿™ä¸ªè¯â€”â€”Node.js æ˜¯äº‹ä»¶é©±åŠ¨çš„ã€äº‹ä»¶é©±åŠ¨æ¶æ„ã€åŸºäºäº‹ä»¶é©±åŠ¨çš„å¼‚æ­¥ I/O æ¨¡å‹ã€‚</p>
<p>ä½†è¿™åˆ°åº•æ„å‘³ç€ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>ä»€ä¹ˆæ˜¯äº‹ä»¶é©±åŠ¨ï¼Ÿè·Ÿæˆ‘ä»¬å¹³å¸¸å†™çš„ä»£ç æœ‰ä»€ä¹ˆä¸ä¸€æ ·ï¼Ÿ</li>
<li>é™¤äº†äº‹ä»¶é©±åŠ¨,è¿˜æœ‰åˆ«çš„ç¼–ç¨‹æ¨¡å‹å—ï¼Ÿ</li>
<li>ä¸ºä»€ä¹ˆ Node.js è¦é€‰æ‹©äº‹ä»¶é©±åŠ¨ï¼Ÿæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</li>
<li>äº‹ä»¶é©±åŠ¨æ˜¯æ€ä¹ˆå®ç°çš„ï¼ŸèƒŒåçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ul>
<p>æœ‰äººè¯´äº‹ä»¶é©±åŠ¨å°±æ˜¯"æ³¨å†Œå›è°ƒå‡½æ•°,ç­‰äº‹ä»¶å‘ç”Ÿæ—¶è°ƒç”¨",ä½†ä¸ºä»€ä¹ˆè¿™ç§æ–¹å¼é€‚åˆ I/O å¯†é›†å‹åº”ç”¨ï¼Ÿä¸ºä»€ä¹ˆè¯´å®ƒæ˜¯éé˜»å¡çš„?</p>
<p>ç ”ç©¶äº†ä¸€ä¸‹æ‰å‘ç°,äº‹ä»¶é©±åŠ¨ä¸åªæ˜¯ä¸€ç§ç¼–ç¨‹é£æ ¼,å®ƒèƒŒåæ˜¯ä¸€æ•´å¥—å®Œå…¨ä¸åŒçš„ç¨‹åºæ‰§è¡Œæ¨¡å‹ã€‚ç†è§£äº†å®ƒ,å°±èƒ½æ˜ç™½ä¸ºä»€ä¹ˆ Node.js ç”¨å•çº¿ç¨‹ä¹Ÿèƒ½é«˜å¹¶å‘,ä¹Ÿèƒ½æ›´å¥½åœ°ç†è§£å¼‚æ­¥ç¼–ç¨‹ã€‚</p>
<p>å¦‚æœä½ ä¹Ÿå¯¹äº‹ä»¶é©±åŠ¨æ„Ÿå…´è¶£,æƒ³ææ¸…æ¥šå®ƒçš„åŸç†å’Œåº”ç”¨åœºæ™¯,é‚£å°±è·Ÿæˆ‘ä¸€èµ·æ¥å­¦ä¹ ä¸€ä¸‹å§ã€‚</p>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯ç¼–ç¨‹æ¨¡å‹ï¼Ÿ</h2>
<p>åœ¨è¯´äº‹ä»¶é©±åŠ¨ä¹‹å‰,å…ˆå¾—ææ¸…æ¥šä»€ä¹ˆæ˜¯"ç¼–ç¨‹æ¨¡å‹"ã€‚</p>
<p>ç¼–ç¨‹æ¨¡å‹(Programming Model)è¯´ç©¿äº†å°±æ˜¯:ç¨‹åºæ€ä¹ˆç»„ç»‡ã€æ€ä¹ˆæ‰§è¡Œã€æ€ä¹ˆå¤„ç†å¹¶å‘çš„ä¸€å¥—è§„åˆ™å’Œæ€è·¯ã€‚</p>
<p>å°±åƒç›–æˆ¿å­,å¯ä»¥ç”¨ä¸åŒçš„å»ºç­‘é£æ ¼â€”â€”ä¸­å¼ã€æ¬§å¼ã€ç°ä»£ç®€çº¦ã€‚ç¼–ç¨‹ä¹Ÿä¸€æ ·,åŒæ ·çš„åŠŸèƒ½å¯ä»¥ç”¨ä¸åŒçš„æ¨¡å‹æ¥å®ç°,æ¯ç§æ¨¡å‹æœ‰è‡ªå·±çš„ç‰¹ç‚¹å’Œé€‚ç”¨åœºæ™¯ã€‚</p>
<h3 data-id="heading-2">å¸¸è§çš„å‡ ç§ç¼–ç¨‹æ¨¡å‹</h3>
<p>ä¸»æµçš„ç¼–ç¨‹æ¨¡å‹ä¸»è¦æœ‰è¿™å‡ ç§:</p>
<p><strong>1. åŒæ­¥é˜»å¡æ¨¡å‹</strong> (ä¼ ç»Ÿçš„ Cã€Java çº¿ç¨‹æ¨¡å‹)
ç¨‹åºä¸€è¡Œè¡Œå¾€ä¸‹æ‰§è¡Œ,é‡åˆ° I/O æ“ä½œå°±ç­‰ç€,ç›´åˆ°å®Œæˆæ‰ç»§ç»­ã€‚æƒ³è¦å¹¶å‘?å¼€å¤šä¸ªçº¿ç¨‹ã€‚</p>
<p><strong>2. äº‹ä»¶é©±åŠ¨æ¨¡å‹</strong> (Node.jsã€Nginx)
ç¨‹åºæ³¨å†Œä¸€å †äº‹ä»¶ç›‘å¬å™¨,ç„¶ååœ¨äº‹ä»¶å¾ªç¯é‡Œä¸æ–­æ£€æŸ¥æœ‰æ²¡æœ‰äº‹ä»¶å‘ç”Ÿ,æœ‰å°±è°ƒç”¨å¯¹åº”çš„å›è°ƒå‡½æ•°ã€‚</p>
<p><strong>3. åç¨‹æ¨¡å‹</strong> (Goã€Python asyncio)
çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç ,ä½†é‡åˆ° I/O æ—¶ä¼šä¸»åŠ¨è®©å‡º CPU,ç­‰ I/O å®Œæˆåæ¢å¤æ‰§è¡Œã€‚</p>
<p><strong>4. Actor æ¨¡å‹</strong> (Erlangã€Akka)
æŠŠç¨‹åºæ‹†æˆå¾ˆå¤šç‹¬ç«‹çš„ actor,æ¯ä¸ª actor æœ‰è‡ªå·±çš„çŠ¶æ€,é€šè¿‡æ¶ˆæ¯ä¼ é€’é€šä¿¡ã€‚</p>
<p>è¿™äº›æ¨¡å‹æ²¡æœ‰ç»å¯¹çš„å¥½å,åªæœ‰é€‚ä¸é€‚åˆã€‚å°±åƒèºä¸åˆ€å’Œé”¤å­,ä¿®ç”µè„‘ç”¨èºä¸åˆ€,é’‰é’‰å­ç”¨é”¤å­,ç”¨å¯¹äº†å·¥å…·æ‰èƒ½äº‹åŠåŠŸå€ã€‚</p>
<h2 data-id="heading-3">äº‹ä»¶é©±åŠ¨åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<h3 data-id="heading-4">æ ¸å¿ƒæ€æƒ³</h3>
<p>äº‹ä»¶é©±åŠ¨çš„æ ¸å¿ƒæ€æƒ³å¾ˆç®€å•:</p>
<p><strong>ä¸è¦ç­‰,è€Œæ˜¯ç•™ä¸ªè”ç³»æ–¹å¼,äº‹æƒ…å¥½äº†é€šçŸ¥æˆ‘ã€‚</strong></p>
<p>å°±åƒå»é¥­é¦†åƒé¥­,æœ‰ä¸¤ç§æ–¹å¼:</p>
<ul>
<li><strong>é˜»å¡æ–¹å¼</strong>:ç«™åœ¨çª—å£ç­‰,ä¸€ç›´ç›¯ç€å¨å¸ˆç‚’èœ,ç‚’å¥½äº†æ‹¿èµ°</li>
<li><strong>äº‹ä»¶é©±åŠ¨æ–¹å¼</strong>:æ‹¿ä¸ªå·,åä¸‹æ¥ç©æ‰‹æœº,å«å·äº†(äº‹ä»¶å‘ç”Ÿ)å†å»å–</li>
</ul>
<p>Node.js å°±æ˜¯ç¬¬äºŒç§æ–¹å¼ã€‚ç¨‹åºä¸ä¼šå‚»ç­‰ I/O æ“ä½œå®Œæˆ,è€Œæ˜¯æ³¨å†Œä¸€ä¸ªå›è°ƒå‡½æ•°,å‘Šè¯‰ç³»ç»Ÿ"I/O å®Œæˆäº†å«æˆ‘",ç„¶åç»§ç»­å¹²åˆ«çš„äº‹ã€‚</p>
<h3 data-id="heading-5">äº‹ä»¶é©±åŠ¨çš„ä¸‰è¦ç´ </h3>
<p>è¦ç†è§£äº‹ä»¶é©±åŠ¨,å¾—ææ¸…æ¥šä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ:</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[äº‹ä»¶æº] --&gt; B[äº‹ä»¶å¾ªç¯]
    B --&gt; C[äº‹ä»¶å¤„ç†å™¨]
    C --&gt; B
    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#ffe1e1
</code></pre>
<p><strong>1. äº‹ä»¶æº(Event Source)</strong>
äº§ç”Ÿäº‹ä»¶çš„åœ°æ–¹ã€‚åœ¨ Node.js é‡Œ,å¸¸è§çš„äº‹ä»¶æºæœ‰:</p>
<ul>
<li>æ–‡ä»¶è¯»å†™(fs.readFile å®Œæˆ)</li>
<li>ç½‘ç»œè¯·æ±‚(HTTP è¯·æ±‚åˆ°è¾¾)</li>
<li>å®šæ—¶å™¨(setTimeout æ—¶é—´åˆ°)</li>
<li>ç”¨æˆ·è¾“å…¥(process.stdin æ”¶åˆ°æ•°æ®)</li>
</ul>
<p><strong>2. äº‹ä»¶å¾ªç¯(Event Loop)</strong>
äº‹ä»¶é©±åŠ¨çš„å¿ƒè„ã€‚å®ƒä¸åœåœ°æ£€æŸ¥æœ‰æ²¡æœ‰äº‹ä»¶å‘ç”Ÿ,æœ‰å°±æ‹¿å‡ºæ¥å¤„ç†ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸ªæ°¸ä¸åœæ­‡çš„ä¼ é€å¸¦,äº‹ä»¶æ”¾ä¸Šå»,ä¸€ä¸ªä¸ªè¢«æ‹¿èµ°å¤„ç†ã€‚</p>
<p><strong>3. äº‹ä»¶å¤„ç†å™¨(Event Handler/Callback)</strong>
äº‹ä»¶å‘ç”Ÿæ—¶è¦æ‰§è¡Œçš„ä»£ç ,é€šå¸¸å°±æ˜¯ä½ æ³¨å†Œçš„å›è°ƒå‡½æ•°ã€‚</p>
<h3 data-id="heading-6">ä¸€ä¸ªç®€å•çš„ä¾‹å­</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// äº‹ä»¶é©±åŠ¨çš„æ–‡ä»¶è¯»å–</span>
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'1. å¼€å§‹è¯»æ–‡ä»¶'</span>);

<span class="hljs-comment">// æ³¨å†Œäº‹ä»¶å¤„ç†å™¨(å›è°ƒå‡½æ•°)</span>
fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">'test.txt'</span>, <span class="hljs-string">'utf8'</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {
  <span class="hljs-comment">// è¿™ä¸ªå‡½æ•°ä¼šåœ¨æ–‡ä»¶è¯»å–å®Œæˆæ—¶è¢«è°ƒç”¨</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'3. æ–‡ä»¶å†…å®¹:'</span>, data);
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'2. ç»§ç»­æ‰§è¡Œå…¶ä»–ä»£ç '</span>);

<span class="hljs-comment">// è¾“å‡ºé¡ºåº:</span>
<span class="hljs-comment">// 1. å¼€å§‹è¯»æ–‡ä»¶</span>
<span class="hljs-comment">// 2. ç»§ç»­æ‰§è¡Œå…¶ä»–ä»£ç </span>
<span class="hljs-comment">// 3. æ–‡ä»¶å†…å®¹: (æ–‡ä»¶å†…å®¹)</span>
</code></pre>
<p>å…³é”®ç‚¹:</p>
<ul>
<li><code>fs.readFile</code> ä¸ä¼šé˜»å¡,å®ƒç«‹å³è¿”å›</li>
<li>å›è°ƒå‡½æ•°æ³¨å†Œåˆ°äº‹ä»¶å¾ªç¯ä¸­</li>
<li>ç¨‹åºç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç </li>
<li>æ–‡ä»¶è¯»å®Œå,äº‹ä»¶å¾ªç¯è°ƒç”¨å›è°ƒå‡½æ•°</li>
</ul>
<p>è¿™å°±æ˜¯äº‹ä»¶é©±åŠ¨çš„ç²¾é«“â€”â€”<strong>éé˜»å¡å¼‚æ­¥æ‰§è¡Œ</strong>ã€‚</p>
<h2 data-id="heading-7">ä¸ºä»€ä¹ˆ Node.js é€‰æ‹©äº‹ä»¶é©±åŠ¨ï¼Ÿ</h2>
<h3 data-id="heading-8">I/O å¯†é›†å‹åº”ç”¨çš„ç—›ç‚¹</h3>
<p>Node.js è®¾è®¡ä¹‹åˆå°±ç„å‡†äº† Web æœåŠ¡å™¨è¿™ä¸ªåœºæ™¯ã€‚Web æœåŠ¡å™¨çš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ<strong>I/O å¯†é›†,è®¡ç®—ç®€å•</strong>ã€‚</p>
<p>æƒ³æƒ³ä¸€ä¸ªå…¸å‹çš„ Web è¯·æ±‚:</p>
<ol>
<li>æ¥æ”¶ HTTP è¯·æ±‚(ç½‘ç»œ I/O)</li>
<li>æŸ¥è¯¢æ•°æ®åº“(ç£ç›˜ I/O)</li>
<li>è¯»å–æ–‡ä»¶(ç£ç›˜ I/O)</li>
<li>è¿”å›å“åº”(ç½‘ç»œ I/O)</li>
</ol>
<p>æ•´ä¸ªè¿‡ç¨‹å¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±åœ¨ç­‰ I/O ä¸Š,çœŸæ­£çš„è®¡ç®—(JSON åºåˆ—åŒ–ã€å­—ç¬¦ä¸²æ‹¼æ¥)åªå å¾ˆå°ä¸€éƒ¨åˆ†ã€‚</p>
<h3 data-id="heading-9">ä¼ ç»Ÿå¤šçº¿ç¨‹æ¨¡å‹çš„é—®é¢˜</h3>
<p>ä¼ ç»Ÿçš„åšæ³•æ˜¯:ä¸€ä¸ªè¯·æ±‚ä¸€ä¸ªçº¿ç¨‹ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[ä¸»çº¿ç¨‹] --&gt; B[çº¿ç¨‹1: å¤„ç†è¯·æ±‚1]
    A --&gt; C[çº¿ç¨‹2: å¤„ç†è¯·æ±‚2]
    A --&gt; D[çº¿ç¨‹3: å¤„ç†è¯·æ±‚3]
    A --&gt; E[çº¿ç¨‹4: å¤„ç†è¯·æ±‚4]
    B --&gt; F[ç­‰å¾…æ•°æ®åº“ ğŸ’¤]
    C --&gt; G[ç­‰å¾…æ–‡ä»¶ ğŸ’¤]
    D --&gt; H[ç­‰å¾…ç½‘ç»œ ğŸ’¤]
    E --&gt; I[ç­‰å¾…æ•°æ®åº“ ğŸ’¤]
    style F fill:#ffcccc
    style G fill:#ffcccc
    style H fill:#ffcccc
    style I fill:#ffcccc
</code></pre>
<p>çœ‹èµ·æ¥ä¸é”™,ä½†æœ‰å‡ ä¸ªé—®é¢˜:</p>
<ol>
<li>
<p><strong>çº¿ç¨‹å¼€é”€å¤§</strong></p>
<ul>
<li>æ¯ä¸ªçº¿ç¨‹éœ€è¦ 1-2MB æ ˆç©ºé—´</li>
<li>åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹æœ‰å¼€é”€</li>
<li>å¤§é‡çº¿ç¨‹åˆ‡æ¢ä¼šæ¶ˆè€— CPU</li>
</ul>
</li>
<li>
<p><strong>èµ„æºæµªè´¹</strong></p>
<ul>
<li>çº¿ç¨‹å¤§éƒ¨åˆ†æ—¶é—´åœ¨ç­‰ I/O,å®é™…ä¸Šå•¥ä¹Ÿæ²¡å¹²</li>
<li>æƒ³è±¡ä¸€ä¸‹:10000 ä¸ªç”¨æˆ·å¹¶å‘,å°±å¾—å¼€ 10000 ä¸ªçº¿ç¨‹,æ¯ä¸ªçº¿ç¨‹ 90% çš„æ—¶é—´åœ¨ç¡è§‰</li>
</ul>
</li>
<li>
<p><strong>éš¾ä»¥è°ƒè¯•å’Œç»´æŠ¤</strong></p>
<ul>
<li>å¤šçº¿ç¨‹ç¼–ç¨‹å®¹æ˜“å‡ºç°ç«æ€æ¡ä»¶ã€æ­»é”</li>
<li>è°ƒè¯•å¤šçº¿ç¨‹ç¨‹åºæ˜¯ä¸ªå™©æ¢¦</li>
</ul>
</li>
</ol>
<h3 data-id="heading-10">äº‹ä»¶é©±åŠ¨çš„ä¼˜åŠ¿</h3>
<p>Node.js ç”¨äº‹ä»¶é©±åŠ¨ + å•çº¿ç¨‹è§£å†³äº†è¿™äº›é—®é¢˜:</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[äº‹ä»¶å¾ªç¯&lt;br&gt;å•çº¿ç¨‹] --&gt; B[å¤„ç†è¯·æ±‚1]
    B --&gt; A
    A --&gt; C[å¤„ç†è¯·æ±‚2]
    C --&gt; A
    A --&gt; D[å¤„ç†è¯·æ±‚3]
    D --&gt; A
    A --&gt; E[å¤„ç†è¯·æ±‚4]
    E --&gt; A
    F[I/O æ“ä½œ] -.å¼‚æ­¥.-&gt; A
    style A fill:#90EE90
</code></pre>
<p><strong>1. é«˜å¹¶å‘ä½å¼€é”€</strong>
å•çº¿ç¨‹ + éé˜»å¡ I/O,å¯ä»¥ç”¨å¾ˆå°çš„å†…å­˜å¤„ç†å¤§é‡å¹¶å‘è¿æ¥ã€‚</p>
<p>æ•°æ®è¯´è¯:</p>
<ul>
<li>Apache(å¤šçº¿ç¨‹): å¤„ç† 10000 å¹¶å‘éœ€è¦ ~2GB å†…å­˜</li>
<li>Node.js(äº‹ä»¶é©±åŠ¨): å¤„ç† 10000 å¹¶å‘éœ€è¦ ~200MB å†…å­˜</li>
</ul>
<p><strong>2. ç¼–ç¨‹ç®€å•</strong>
æ‰€æœ‰ä»£ç éƒ½åœ¨å•çº¿ç¨‹æ‰§è¡Œ,ä¸ç”¨æ‹…å¿ƒå¤šçº¿ç¨‹çš„é‚£äº›å‘:</p>
<ul>
<li>ä¸éœ€è¦åŠ é”</li>
<li>ä¸ä¼šæœ‰ç«æ€æ¡ä»¶</li>
<li>å›è°ƒå‡½æ•°é¡ºåºæ‰§è¡Œ,ä¸ä¼šåŒæ—¶è¿è¡Œ</li>
</ul>
<p><strong>3. èµ„æºåˆ©ç”¨ç‡é«˜</strong>
ç­‰ I/O çš„æ—¶å€™ä¸æ˜¯å¹²åç€,è€Œæ˜¯å»å¤„ç†å…¶ä»–è¯·æ±‚ã€‚å°±åƒé“¶è¡ŒæŸœå‘˜,ä¸€ä¸ªå®¢æˆ·åŠä¸šåŠ¡å¡ä½äº†,ä¸å‚»ç­‰ç€,è€Œæ˜¯å…ˆæœåŠ¡ä¸‹ä¸€ä¸ªå®¢æˆ·ã€‚</p>
<h3 data-id="heading-11">äº‹ä»¶é©±åŠ¨çš„å±€é™</h3>
<p>å½“ç„¶,äº‹ä»¶é©±åŠ¨ä¸æ˜¯é“¶å¼¹,ä¹Ÿæœ‰å®ƒçš„çŸ­æ¿:</p>
<p><strong>1. CPU å¯†é›†å‹ä»»åŠ¡çš„è½¯è‚‹</strong>
å•çº¿ç¨‹æ„å‘³ç€ä¸€æ¬¡åªèƒ½åšä¸€ä»¶äº‹ã€‚å¦‚æœæŸä¸ªå›è°ƒå‡½æ•°æ‰§è¡Œæ—¶é—´å¾ˆé•¿(æ¯”å¦‚è®¡ç®—å¯†é›†å‹ä»»åŠ¡),æ•´ä¸ªäº‹ä»¶å¾ªç¯å°±ä¼šè¢«é˜»å¡,å…¶ä»–è¯·æ±‚éƒ½å¾—ç­‰ç€ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ğŸ’€ è¿™ä¼šé˜»å¡æ•´ä¸ªäº‹ä»¶å¾ªç¯</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">complexCalculation</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">let</span> sum = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000000000</span>; i++) {
    sum += i;
  }
  <span class="hljs-keyword">return</span> sum;
}

<span class="hljs-comment">// åœ¨è¿™ä¸ªè®¡ç®—æœŸé—´,å…¶ä»–è¯·æ±‚éƒ½ä¼šå¡ä½</span>
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/heavy'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">complexCalculation</span>();  <span class="hljs-comment">// é˜»å¡å‡ ç§’é’Ÿ</span>
  res.<span class="hljs-title function_">json</span>({ result });
});
</code></pre>
<p><strong>2. å›è°ƒåœ°ç‹±</strong>
åµŒå¥—çš„å›è°ƒå‡½æ•°ä¼šè®©ä»£ç å˜æˆ"å›è°ƒé‡‘å­—å¡”",éš¾ä»¥é˜…è¯»å’Œç»´æŠ¤:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ğŸ˜± å›è°ƒåœ°ç‹±</span>
fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">'file1.txt'</span>, <span class="hljs-function">(<span class="hljs-params">err, data1</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err;
  fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">'file2.txt'</span>, <span class="hljs-function">(<span class="hljs-params">err, data2</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err;
    fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">'file3.txt'</span>, <span class="hljs-function">(<span class="hljs-params">err, data3</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data1, data2, data3);
    });
  });
});
</code></pre>
<p>ä¸è¿‡è¿™ä¸ªé—®é¢˜å·²ç»æœ‰äº†å¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆ:Promise å’Œ async/awaitã€‚</p>
<p><strong>3. é”™è¯¯å¤„ç†å¤æ‚</strong>
å¼‚æ­¥ä»£ç çš„é”™è¯¯å¤„ç†æ¯”åŒæ­¥ä»£ç éº»çƒ¦,ä¸€ä¸ªæ²¡ catch çš„ Promise rejection å¯èƒ½å¯¼è‡´è¿›ç¨‹å´©æºƒã€‚</p>
<h2 data-id="heading-12">äº‹ä»¶é©±åŠ¨çš„åº•å±‚åŸç†</h2>
<p>ææ˜ç™½äº†"æ˜¯ä»€ä¹ˆ"å’Œ"ä¸ºä»€ä¹ˆ",ç°åœ¨æ¥çœ‹çœ‹"æ€ä¹ˆå®ç°"ã€‚</p>
<h3 data-id="heading-13">Node.js çš„äº‹ä»¶å¾ªç¯</h3>
<p>Node.js çš„äº‹ä»¶å¾ªç¯æ˜¯æ•´ä¸ªäº‹ä»¶é©±åŠ¨æ¶æ„çš„æ ¸å¿ƒ,å®ƒå»ºç«‹åœ¨ libuv è¿™ä¸ª C åº“ä¹‹ä¸Šã€‚</p>
<h4 data-id="heading-14">äº‹ä»¶å¾ªç¯çš„ç»“æ„</h4>
<p>äº‹ä»¶å¾ªç¯åˆ†ä¸ºå¤šä¸ªé˜¶æ®µ(Phase),æ¯ä¸ªé˜¶æ®µæœ‰è‡ªå·±çš„ä»»åŠ¡é˜Ÿåˆ—:</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[timers&lt;br&gt;æ‰§è¡Œ setTimeout/setInterval] --&gt; B[pending callbacks&lt;br&gt;æ‰§è¡Œå»¶è¿Ÿçš„ I/O å›è°ƒ]
    B --&gt; C[idle, prepare&lt;br&gt;å†…éƒ¨ä½¿ç”¨]
    C --&gt; D[poll&lt;br&gt;è·å–æ–°çš„ I/O äº‹ä»¶]
    D --&gt; E[check&lt;br&gt;æ‰§è¡Œ setImmediate]
    E --&gt; F[close callbacks&lt;br&gt;æ‰§è¡Œå…³é—­å›è°ƒ]
    F --&gt; A
    style A fill:#ffe1e1
    style D fill:#e1f5ff
    style E fill:#fff4e1
</code></pre>
<p><strong>å„é˜¶æ®µçš„ä½œç”¨</strong>:</p>
<ol>
<li>
<p><strong>timers é˜¶æ®µ</strong>
æ‰§è¡Œ <code>setTimeout</code> å’Œ <code>setInterval</code> çš„å›è°ƒ</p>
</li>
<li>
<p><strong>pending callbacks é˜¶æ®µ</strong>
æ‰§è¡Œä¸€äº›ç³»ç»Ÿæ“ä½œçš„å›è°ƒ,æ¯”å¦‚ TCP é”™è¯¯</p>
</li>
<li>
<p><strong>idle, prepare é˜¶æ®µ</strong>
ä»…å†…éƒ¨ä½¿ç”¨</p>
</li>
<li>
<p><strong>poll é˜¶æ®µ</strong> (æœ€é‡è¦)</p>
<ul>
<li>è·å–æ–°çš„ I/O äº‹ä»¶</li>
<li>æ‰§è¡Œ I/O ç›¸å…³çš„å›è°ƒ</li>
<li>å¦‚æœ poll é˜Ÿåˆ—ä¸ä¸ºç©º,ä¼šä¾æ¬¡æ‰§è¡Œå›è°ƒç›´åˆ°é˜Ÿåˆ—ä¸ºç©ºæˆ–è¾¾åˆ°ç³»ç»Ÿé™åˆ¶</li>
<li>å¦‚æœ poll é˜Ÿåˆ—ä¸ºç©º:
<ul>
<li>å¦‚æœæœ‰ <code>setImmediate</code>,è¿›å…¥ check é˜¶æ®µ</li>
<li>å¦‚æœæœ‰ timers åˆ°æœŸ,å›åˆ° timers é˜¶æ®µ</li>
<li>å¦åˆ™ç­‰å¾…æ–°çš„ I/O äº‹ä»¶</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>check é˜¶æ®µ</strong>
æ‰§è¡Œ <code>setImmediate</code> çš„å›è°ƒ</p>
</li>
<li>
<p><strong>close callbacks é˜¶æ®µ</strong>
æ‰§è¡Œå…³é—­äº‹ä»¶çš„å›è°ƒ,æ¯”å¦‚ <code>socket.on('close', ...)</code></p>
</li>
</ol>
<h4 data-id="heading-15">å¾®ä»»åŠ¡é˜Ÿåˆ—(Microtask Queue)</h4>
<p>é™¤äº†äº‹ä»¶å¾ªç¯çš„é˜¶æ®µé˜Ÿåˆ—,è¿˜æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„å¾®ä»»åŠ¡é˜Ÿåˆ—:</p>
<ul>
<li><strong>Promise å¾®ä»»åŠ¡é˜Ÿåˆ—</strong>: Promise.then/catch/finally</li>
<li><strong>process.nextTick é˜Ÿåˆ—</strong>: process.nextTick</li>
</ul>
<p>å¾®ä»»åŠ¡çš„ç‰¹ç‚¹æ˜¯:<strong>åœ¨å½“å‰é˜¶æ®µç»“æŸåã€è¿›å…¥ä¸‹ä¸€é˜¶æ®µå‰æ‰§è¡Œ</strong>ã€‚</p>
<p>æ‰§è¡Œä¼˜å…ˆçº§:</p>
<pre><code class="hljs language-arduino" lang="arduino">process.nextTick &gt; Promise å¾®ä»»åŠ¡ &gt; äº‹ä»¶å¾ªç¯å„é˜¶æ®µçš„å®ä»»åŠ¡
</code></pre>
<h3 data-id="heading-16">ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'1. script start'</span>);

<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'2. setTimeout'</span>);
}, <span class="hljs-number">0</span>);

<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'3. promise1'</span>);
}).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'4. promise2'</span>);
});

process.<span class="hljs-title function_">nextTick</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'5. nextTick'</span>);
});

<span class="hljs-title function_">setImmediate</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'6. setImmediate'</span>);
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'7. script end'</span>);

<span class="hljs-comment">// è¾“å‡ºé¡ºåº:</span>
<span class="hljs-comment">// 1. script start</span>
<span class="hljs-comment">// 7. script end</span>
<span class="hljs-comment">// 5. nextTick          (nextTick é˜Ÿåˆ—)</span>
<span class="hljs-comment">// 3. promise1          (Promise å¾®ä»»åŠ¡é˜Ÿåˆ—)</span>
<span class="hljs-comment">// 4. promise2          (Promise å¾®ä»»åŠ¡é˜Ÿåˆ—)</span>
<span class="hljs-comment">// 2. setTimeout        (timers é˜¶æ®µ)</span>
<span class="hljs-comment">// 6. setImmediate      (check é˜¶æ®µ)</span>
</code></pre>
<p>æ‰§è¡Œæµç¨‹:</p>
<ol>
<li>
<p><strong>ä¸»ä»£ç æ‰§è¡Œ</strong></p>
<ul>
<li>è¾“å‡º: 1, 7</li>
<li>setTimeout æ³¨å†Œåˆ° timers é˜¶æ®µ</li>
<li>Promise æ³¨å†Œåˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—</li>
<li>nextTick æ³¨å†Œåˆ° nextTick é˜Ÿåˆ—</li>
<li>setImmediate æ³¨å†Œåˆ° check é˜¶æ®µ</li>
</ul>
</li>
<li>
<p><strong>ä¸»ä»£ç ç»“æŸ,æ¸…ç©ºå¾®ä»»åŠ¡é˜Ÿåˆ—</strong></p>
<ul>
<li>å…ˆæ‰§è¡Œ nextTick é˜Ÿåˆ—: è¾“å‡º 5</li>
<li>å†æ‰§è¡Œ Promise å¾®ä»»åŠ¡: è¾“å‡º 3, 4</li>
</ul>
</li>
<li>
<p><strong>è¿›å…¥äº‹ä»¶å¾ªç¯</strong></p>
<ul>
<li>timers é˜¶æ®µ: è¾“å‡º 2</li>
<li>poll é˜¶æ®µ: æ— ä»»åŠ¡</li>
<li>check é˜¶æ®µ: è¾“å‡º 6</li>
</ul>
</li>
</ol>
<h3 data-id="heading-17">éé˜»å¡ I/O çš„å®ç°</h3>
<p>Node.js çš„éé˜»å¡ I/O ä¾èµ–æ“ä½œç³»ç»Ÿæä¾›çš„å¼‚æ­¥ I/O æ¥å£ã€‚</p>
<h4 data-id="heading-18">æ“ä½œç³»ç»Ÿå±‚é¢çš„æ”¯æŒ</h4>
<p>ä¸åŒæ“ä½œç³»ç»Ÿæœ‰ä¸åŒçš„å¼‚æ­¥ I/O æœºåˆ¶:</p>

























<table><thead><tr><th>æ“ä½œç³»ç»Ÿ</th><th>å¼‚æ­¥ I/O æœºåˆ¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>Linux</td><td>epoll</td><td>é«˜æ•ˆçš„ I/O å¤šè·¯å¤ç”¨</td></tr><tr><td>macOS/BSD</td><td>kqueue</td><td>ç±»ä¼¼ epoll</td></tr><tr><td>Windows</td><td>IOCP</td><td>I/O å®Œæˆç«¯å£</td></tr></tbody></table>
<p>libuv æŠŠè¿™äº›ä¸åŒçš„åº•å±‚æ¥å£å°è£…æˆç»Ÿä¸€çš„ API,è®© Node.js å¯ä»¥è·¨å¹³å°è¿è¡Œã€‚</p>
<h4 data-id="heading-19">I/O æ“ä½œçš„å®Œæ•´æµç¨‹</h4>
<p>ä»¥æ–‡ä»¶è¯»å–ä¸ºä¾‹:</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant App as åº”ç”¨ä»£ç 
    participant Node as Node.js
    participant Libuv as libuv
    participant OS as æ“ä½œç³»ç»Ÿ
    
    App-&gt;&gt;Node: fs.readFile('file.txt', callback)
    Node-&gt;&gt;Libuv: åˆ›å»ºè¯»å–è¯·æ±‚
    Libuv-&gt;&gt;OS: å‘èµ·å¼‚æ­¥è¯»å–
    Node--&gt;&gt;App: ç«‹å³è¿”å›(éé˜»å¡)
    
    Note over App: ç»§ç»­æ‰§è¡Œå…¶ä»–ä»£ç 
    
    OS-&gt;&gt;Libuv: I/O å®Œæˆé€šçŸ¥
    Libuv-&gt;&gt;Node: å°†å›è°ƒåŠ å…¥äº‹ä»¶é˜Ÿåˆ—
    Node-&gt;&gt;App: äº‹ä»¶å¾ªç¯æ‰§è¡Œ callback
</code></pre>
<p>æ•´ä¸ªè¿‡ç¨‹:</p>
<ol>
<li><strong>å‘èµ·è¯·æ±‚</strong>: åº”ç”¨è°ƒç”¨ <code>fs.readFile</code>,Node.js ç«‹å³è¿”å›,ä¸ç­‰å¾…</li>
<li><strong>æ“ä½œç³»ç»Ÿå¤„ç†</strong>: OS åœ¨åå°è¯»å–æ–‡ä»¶</li>
<li><strong>å®Œæˆé€šçŸ¥</strong>: OS é€šçŸ¥ libuv I/O å®Œæˆ</li>
<li><strong>å›è°ƒæ‰§è¡Œ</strong>: äº‹ä»¶å¾ªç¯åœ¨ poll é˜¶æ®µæ‰§è¡Œå›è°ƒå‡½æ•°</li>
</ol>
<p>å…³é”®ç‚¹:åº”ç”¨ä»£ç ä»ä¸ç­‰å¾… I/O,ä¸€ç›´åœ¨äº‹ä»¶å¾ªç¯ä¸­ä¸æ–­å¤„ç†æ–°çš„ä»»åŠ¡ã€‚</p>
<h3 data-id="heading-20">çº¿ç¨‹æ± çš„ç§˜å¯†</h3>
<p>è™½ç„¶ Node.js æ˜¯å•çº¿ç¨‹,ä½†æœ‰äº›æ“ä½œ(æ¯”å¦‚æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€DNS æŸ¥è¯¢)åœ¨æŸäº›ç³»ç»Ÿä¸Šæ²¡æœ‰çœŸæ­£çš„å¼‚æ­¥æ¥å£ã€‚</p>
<p>libuv æ€ä¹ˆåŠ?ç”¨çº¿ç¨‹æ± æ¨¡æ‹Ÿå¼‚æ­¥!</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[ä¸»çº¿ç¨‹&lt;br&gt;äº‹ä»¶å¾ªç¯] --&gt; B[çº¿ç¨‹æ± &lt;br&gt;4ä¸ªå·¥ä½œçº¿ç¨‹]
    B --&gt; C[çº¿ç¨‹1: è¯»æ–‡ä»¶]
    B --&gt; D[çº¿ç¨‹2: å†™æ–‡ä»¶]
    B --&gt; E[çº¿ç¨‹3: DNSæŸ¥è¯¢]
    B --&gt; F[çº¿ç¨‹4: cryptoåŠ å¯†]
    C -.å®Œæˆ.-&gt; A
    D -.å®Œæˆ.-&gt; A
    E -.å®Œæˆ.-&gt; A
    F -.å®Œæˆ.-&gt; A
    style A fill:#90EE90
    style B fill:#FFE4B5
</code></pre>
<p>é»˜è®¤çº¿ç¨‹æ± å¤§å°æ˜¯ 4,å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡è°ƒæ•´:</p>
<pre><code class="hljs language-bash" lang="bash">UV_THREADPOOL_SIZE=8 node app.js
</code></pre>
<p>éœ€è¦çº¿ç¨‹æ± çš„æ“ä½œ:</p>
<ul>
<li>æ–‡ä»¶ç³»ç»Ÿæ“ä½œ(fs.readFile, fs.writeFile ç­‰)</li>
<li>DNS æ“ä½œ(dns.lookup)</li>
<li>ä¸€äº› crypto æ“ä½œ</li>
<li>zlib å‹ç¼©</li>
</ul>
<p>ç½‘ç»œ I/O(HTTPã€TCP)ä¸éœ€è¦çº¿ç¨‹æ± ,ä½¿ç”¨çœŸæ­£çš„å¼‚æ­¥ I/Oã€‚</p>
<h2 data-id="heading-21">äº‹ä»¶é©±åŠ¨ vs å…¶ä»–ç¼–ç¨‹æ¨¡å‹</h2>
<h3 data-id="heading-22">ä¸å¤šçº¿ç¨‹æ¨¡å‹å¯¹æ¯”</h3>








































<table><thead><tr><th>ç‰¹æ€§</th><th>äº‹ä»¶é©±åŠ¨(Node.js)</th><th>å¤šçº¿ç¨‹(Java/C++)</th></tr></thead><tbody><tr><td><strong>å¹¶å‘æ–¹å¼</strong></td><td>å•çº¿ç¨‹ + å¼‚æ­¥ I/O</td><td>å¤šçº¿ç¨‹ + åŒæ­¥ I/O</td></tr><tr><td><strong>å†…å­˜å ç”¨</strong></td><td>ä½(æ¯ä¸ªè¿æ¥ ~2KB)</td><td>é«˜(æ¯ä¸ªçº¿ç¨‹ 1-2MB)</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>I/O å¯†é›†å‹</td><td>CPU å¯†é›†å‹</td></tr><tr><td><strong>ç¼–ç¨‹éš¾åº¦</strong></td><td>ç®€å•(æ— é”)</td><td>å¤æ‚(éœ€è¦åŠ é”)</td></tr><tr><td><strong>CPU åˆ©ç”¨</strong></td><td>å•æ ¸(éœ€è¦å¤šè¿›ç¨‹)</td><td>å¤šæ ¸</td></tr><tr><td><strong>æ€§èƒ½ç“¶é¢ˆ</strong></td><td>CPU è®¡ç®—</td><td>çº¿ç¨‹åˆ‡æ¢ã€é”ç«äº‰</td></tr></tbody></table>
<p><strong>é€‰æ‹©å»ºè®®</strong>:</p>
<ul>
<li>I/O å¯†é›†å‹(Web æœåŠ¡å™¨ã€API ç½‘å…³): äº‹ä»¶é©±åŠ¨</li>
<li>CPU å¯†é›†å‹(è§†é¢‘å¤„ç†ã€ç§‘å­¦è®¡ç®—): å¤šçº¿ç¨‹</li>
<li>æ··åˆå‹: äº‹ä»¶é©±åŠ¨ + Worker çº¿ç¨‹å¤„ç† CPU ä»»åŠ¡</li>
</ul>
<h3 data-id="heading-23">ä¸åç¨‹æ¨¡å‹å¯¹æ¯”</h3>
<p>Go çš„åç¨‹(goroutine)å’Œ Node.js çš„äº‹ä»¶é©±åŠ¨éƒ½æ˜¯ä¸ºäº†è§£å†³é«˜å¹¶å‘é—®é¢˜,ä½†æ€è·¯ä¸åŒ:</p>
<p><strong>Go åç¨‹æ¨¡å‹</strong>:</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç </span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">handler</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> {
    data := readDatabase()  <span class="hljs-comment">// å®é™…ä¸Šæ˜¯å¼‚æ­¥çš„,ä½†å†™èµ·æ¥åƒåŒæ­¥</span>
    fmt.Fprintf(w, data)
}
</code></pre>
<p><strong>Node.js äº‹ä»¶é©±åŠ¨</strong>:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¼‚æ­¥ä»£ç (Promise)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">handler</span>(<span class="hljs-params">req, res</span>) {
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">readDatabase</span>();  <span class="hljs-comment">// æ˜ç¡®æ ‡æ³¨å¼‚æ­¥</span>
  res.<span class="hljs-title function_">send</span>(data);
}
</code></pre>






























<table><thead><tr><th>ç‰¹æ€§</th><th>Go åç¨‹</th><th>Node.js äº‹ä»¶é©±åŠ¨</th></tr></thead><tbody><tr><td><strong>ä»£ç é£æ ¼</strong></td><td>åŒæ­¥é£æ ¼(çœ‹èµ·æ¥)</td><td>å¼‚æ­¥é£æ ¼</td></tr><tr><td><strong>å¿ƒæ™ºè´Ÿæ‹…</strong></td><td>ä½(è‡ªåŠ¨è°ƒåº¦)</td><td>ä¸­(éœ€è¦ç†è§£å¼‚æ­¥)</td></tr><tr><td><strong>è°ƒè¯•éš¾åº¦</strong></td><td>éš¾(goroutine æ³„æ¼)</td><td>ä¸­(å›è°ƒ/Promise)</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>ç•¥é«˜</td><td>ç•¥ä½</td></tr></tbody></table>
<p>åç¨‹æ˜¯æ›´é«˜çº§çš„æŠ½è±¡,æŠŠå¼‚æ­¥çš„å¤æ‚åº¦è—åœ¨è¿è¡Œæ—¶é‡Œã€‚ä½† Node.js çš„äº‹ä»¶é©±åŠ¨æ¨¡å‹æ›´é€æ˜,å¼€å‘è€…èƒ½æ¸…æ¥šåœ°çœ‹åˆ°å“ªé‡Œæ˜¯å¼‚æ­¥çš„ã€‚</p>
<h2 data-id="heading-24">æ€»ç»“</h2>
<p>ç ”ç©¶å®Œäº‹ä»¶é©±åŠ¨,æˆ‘çš„ç†è§£æ˜¯:</p>
<p><strong>åŸç†å±‚é¢</strong>:</p>
<ul>
<li>äº‹ä»¶é©±åŠ¨æ˜¯ä¸€ç§ç¼–ç¨‹æ¨¡å‹,æ ¸å¿ƒæ˜¯"éé˜»å¡ + äº‹ä»¶å¾ªç¯ + å›è°ƒå‡½æ•°"</li>
<li>Node.js ç”¨å•çº¿ç¨‹ + å¼‚æ­¥ I/O å®ç°é«˜å¹¶å‘,é¿å…äº†å¤šçº¿ç¨‹çš„å¤æ‚æ€§å’Œå¼€é”€</li>
<li>äº‹ä»¶å¾ªç¯åˆ†å¤šä¸ªé˜¶æ®µ,æ¯ä¸ªé˜¶æ®µå¤„ç†ç‰¹å®šç±»å‹çš„ä»»åŠ¡</li>
<li>åº•å±‚ä¾èµ– libuv å°è£…ä¸åŒæ“ä½œç³»ç»Ÿçš„å¼‚æ­¥ I/O æ¥å£</li>
</ul>
<p><strong>å®ç”¨å±‚é¢</strong>:</p>
<ul>
<li>é€‚åˆ I/O å¯†é›†å‹åº”ç”¨(Web æœåŠ¡å™¨ã€APIã€å®æ—¶åº”ç”¨)</li>
<li>ä¸é€‚åˆ CPU å¯†é›†å‹åº”ç”¨(é™¤éç”¨ Worker çº¿ç¨‹)</li>
<li>ç¼–ç¨‹ç®€å•(æ— é”ã€æ— ç«æ€),ä½†éœ€è¦ç†è§£å¼‚æ­¥æ€ç»´</li>
<li>é”™è¯¯å¤„ç†å’Œè°ƒè¯•éœ€è¦é¢å¤–æ³¨æ„</li>
</ul>
<p><strong>ä½¿ç”¨å»ºè®®</strong>:</p>
<ol>
<li><strong>å¼€å‘ Web åº”ç”¨/API</strong>: æ³¨å†Œè·¯ç”±å¤„ç†å‡½æ•° â†’ å¤„ç†è¯·æ±‚ â†’ å¼‚æ­¥æ“ä½œ(æ•°æ®åº“ã€æ–‡ä»¶) â†’ è¿”å›å“åº”(æ°¸è¿œä¸è¦é˜»å¡!)</li>
<li><strong>å¤„ç†é«˜å¹¶å‘ I/O</strong>: å¤§é‡å¹¶å‘è¿æ¥(èŠå¤©æœåŠ¡å™¨ã€æ¸¸æˆæœåŠ¡å™¨) â†’ äº‹ä»¶é©±åŠ¨å®Œç¾é€‚é…</li>
<li><strong>CPU å¯†é›†ä»»åŠ¡</strong>: æŠŠè®¡ç®—æ”¾åˆ° Worker çº¿ç¨‹ â†’ ä¸»çº¿ç¨‹åªè´Ÿè´£åè°ƒ â†’ ä¿æŒäº‹ä»¶å¾ªç¯ç•…é€š</li>
</ol>
<p>äº‹ä»¶é©±åŠ¨ä¸æ˜¯å®Œç¾çš„,ä½†åœ¨å®ƒæ“…é•¿çš„é¢†åŸŸ(I/O å¯†é›†å‹é«˜å¹¶å‘),å®ƒç¡®å®æ˜¯æœ€ä¼˜è§£ä¹‹ä¸€ã€‚ç†è§£å®ƒçš„åŸç†å’Œå±€é™,æ‰èƒ½æ›´å¥½åœ°å‘æŒ¥å®ƒçš„ä¼˜åŠ¿,ä¹Ÿæ‰èƒ½åœ¨éœ€è¦çš„æ—¶å€™é€‰æ‹©æ›´åˆé€‚çš„æ–¹æ¡ˆã€‚</p>
<hr/>
<h2 data-id="heading-25">å‚è€ƒèµ„æ–™</h2>
<ol>
<li>
<p><strong>Node.js å®˜æ–¹æ–‡æ¡£</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2Fen%2Fdocs%2Fguides%2Fevent-loop-timers-and-nexttick%2F" target="_blank" title="https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/" ref="nofollow noopener noreferrer">The Node.js Event Loop</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2Fen%2Fdocs%2Fguides%2Fdont-block-the-event-loop%2F" target="_blank" title="https://nodejs.org/en/docs/guides/dont-block-the-event-loop/" ref="nofollow noopener noreferrer">Don't Block the Event Loop</a></li>
</ul>
</li>
<li>
<p><strong>libuv æ–‡æ¡£</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=http%3A%2F%2Fdocs.libuv.org%2Fen%2Fv1.x%2Fdesign.html" target="_blank" title="http://docs.libuv.org/en/v1.x/design.html" ref="nofollow noopener noreferrer">libuv Design Overview</a> - ç†è§£åº•å±‚å®ç°</li>
</ul>
</li>
<li>
<p><strong>æ·±å…¥æ–‡ç« </strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.freecodecamp.org%2Fnews%2Funderstanding-node-js-event-driven-architecture-223292fcbc2d%2F" target="_blank" title="https://www.freecodecamp.org/news/understanding-node-js-event-driven-architecture-223292fcbc2d/" ref="nofollow noopener noreferrer">Understanding Node.js Event-Driven Architecture</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.insiderattack.net%2Fevent-loop-and-the-big-picture-nodejs-event-loop-part-1-1cb67a182810" target="_blank" title="https://blog.insiderattack.net/event-loop-and-the-big-picture-nodejs-event-loop-part-1-1cb67a182810" ref="nofollow noopener noreferrer">Node.js Under The Hood</a></li>
</ul>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯æ¶æ„ä¸­çš„ä¸­é—´å±‚è®¾è®¡ï¼šæ„å»ºç¨³å¥å¯ç»´æŠ¤çš„ç»„ä»¶ä½“ç³»]]></title>    <link>https://juejin.cn/post/7570651893869936692</link>    <guid>https://juejin.cn/post/7570651893869936692</guid>    <pubDate>2025-11-10T06:19:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570651893869936692" data-draft-id="7570651893869903924" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯æ¶æ„ä¸­çš„ä¸­é—´å±‚è®¾è®¡ï¼šæ„å»ºç¨³å¥å¯ç»´æŠ¤çš„ç»„ä»¶ä½“ç³»"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•,ä»£ç è§„èŒƒ"/> <meta itemprop="datePublished" content="2025-11-10T06:19:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§çŸ¥é—²é—²i"/> <meta itemprop="url" content="https://juejin.cn/user/3799545205237111"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯æ¶æ„ä¸­çš„ä¸­é—´å±‚è®¾è®¡ï¼šæ„å»ºç¨³å¥å¯ç»´æŠ¤çš„ç»„ä»¶ä½“ç³»
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3799545205237111/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§çŸ¥é—²é—²i
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T06:19:53.000Z" title="Mon Nov 10 2025 06:19:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ç°ä»£å‰ç«¯å¼€å‘ä¸­ï¼Œä¸­é—´å±‚æ¶æ„è®¾è®¡å·²æˆä¸ºæ„å»ºå¤§å‹å¤æ‚åº”ç”¨çš„å…³é”®ç­–ç•¥ã€‚ç‰¹åˆ«æ˜¯åœ¨ç»„ä»¶åŒ–å¼€å‘ä¸­ï¼Œåˆç†çš„ä¸­é—´å±‚è®¾è®¡èƒ½å¤Ÿæ˜¾è‘—æå‡ä»£ç è´¨é‡ã€å›¢é˜Ÿåä½œæ•ˆç‡å’Œç³»ç»Ÿå¯ç»´æŠ¤æ€§ã€‚</p>
<p>================================================================================</p>
<h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯ç»„ä»¶ä¸­é—´å±‚ï¼Ÿ</h2>
<p>ç»„ä»¶ä¸­é—´å±‚æ˜¯ä½äºä¸šåŠ¡é€»è¾‘ä¸åŸºç¡€UIç»„ä»¶ä¹‹é—´çš„æŠ½è±¡å±‚ï¼Œå®ƒé€šè¿‡å¯¹åº•å±‚ç»„ä»¶ï¼ˆå¦‚ Ant Designã€Element UI ç­‰ï¼‰è¿›è¡Œç»Ÿä¸€å°è£…ï¼Œä¸ºä¸šåŠ¡å¼€å‘æä¾›æ ‡å‡†åŒ–ã€å¢å¼ºå‹çš„ç»„ä»¶æ¥å£ã€‚</p>
<p><strong>æ¶æ„å±‚æ¬¡ç¤ºæ„ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss">ä¸šåŠ¡ç»„ä»¶å±‚ (Business Components)
    â†“
ç»„ä»¶ä¸­é—´å±‚ (Component Middleware) â† æ ¸å¿ƒæŠ½è±¡å±‚
    â†“
åŸºç¡€UIåº“ (UI Libraries) â† AntDã€Element UI ç­‰
    â†“
åŸç”Ÿ<span class="hljs-selector-tag">HTML</span>å…ƒç´  (Native HTML)
</code></pre>
<h2 data-id="heading-1">äºŒã€ä¸­é—´å±‚è®¾è®¡çš„æ ¸å¿ƒä»·å€¼</h2>
<h3 data-id="heading-2">1. æŠ€æœ¯æ ˆè§£è€¦ä¸é£é™©æ§åˆ¶</h3>
<p><strong>é—®é¢˜åœºæ™¯ï¼š</strong> ä¸šåŠ¡ä»£ç ç›´æ¥ä¾èµ–ç‰¹å®šUIåº“ï¼Œå¯¼è‡´æŠ€æœ¯æ ˆåˆ‡æ¢æˆæœ¬æé«˜</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ ç›´æ¥ä¾èµ– - å±é™©çš„åšæ³•</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span>, <span class="hljs-title class_">Table</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserManagement</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span>&gt;</span>åˆ é™¤ç”¨æˆ·<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Table</span> <span class="hljs-attr">dataSource</span>=<span class="hljs-string">{data}</span> /&gt;</span></span>
  );
}

<span class="hljs-comment">// âœ… ä¸­é—´å±‚å°è£… - å®‰å…¨çš„åšæ³•</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PrimaryButton</span>, <span class="hljs-title class_">DataTable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/components'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserManagement</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">PrimaryButton</span>&gt;</span>åˆ é™¤ç”¨æˆ·<span class="hljs-tag">&lt;/<span class="hljs-name">PrimaryButton</span>&gt;</span></span>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">DataTable</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{data}</span> /&gt;</span></span>
  );
}
</code></pre>
<p><strong>ä¼˜åŠ¿ä½“ç°ï¼š</strong> å½“éœ€è¦ä» Ant Design è¿ç§»åˆ°å…¶ä»–UIåº“æ—¶ï¼Œåªéœ€ä¿®æ”¹ä¸­é—´å±‚å®ç°ï¼Œä¸šåŠ¡ä»£ç æ— éœ€æ”¹åŠ¨ã€‚</p>
<h3 data-id="heading-3">2. ç»Ÿä¸€è®¾è®¡è§„èŒƒä¸ç”¨æˆ·ä½“éªŒ</h3>
<p>é€šè¿‡ä¸­é—´å±‚å¼ºåˆ¶å®æ–½è®¾è®¡ç³»ç»Ÿè§„èŒƒï¼Œç¡®ä¿æ•´ä¸ªåº”ç”¨äº¤äº’ä¸€è‡´æ€§ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// components/EnhancedTable/index.tsx
import React from 'react'<span class="hljs-comment">;</span>
import { Table, Empty, Spin, Alert } from 'antd'<span class="hljs-comment">;</span>

interface EnhancedTableProps {
  loading?: boolean<span class="hljs-comment">;</span>
  error?: Error | null<span class="hljs-comment">;</span>
  data: any<span class="hljs-section">[]</span><span class="hljs-comment">;</span>
  columns: any<span class="hljs-section">[]</span><span class="hljs-comment">;</span>
  onRetry?: () =&gt; void<span class="hljs-comment">;</span>
}

export const EnhancedTable: React.FC&lt;EnhancedTableProps&gt; = ({
  <span class="hljs-attr">loading</span> = <span class="hljs-literal">false</span>,
  <span class="hljs-attr">error</span> = null,
  <span class="hljs-attr">data</span> = [],
  columns,
  onRetry,
  ...rest
}) =&gt; {
  if (error) {
    return (
      &lt;Alert
        <span class="hljs-attr">message</span>=<span class="hljs-string">"æ•°æ®åŠ è½½å¤±è´¥"</span>
        <span class="hljs-attr">description</span>={error.message}
        <span class="hljs-attr">type</span>=<span class="hljs-string">"error"</span>
        <span class="hljs-attr">action</span>={
          &lt;Button <span class="hljs-attr">size</span>=<span class="hljs-string">"small"</span> <span class="hljs-literal">on</span>Click={<span class="hljs-literal">on</span>Retry}&gt;
            é‡è¯•
          &lt;/Button&gt;
        }
      /&gt;
    )<span class="hljs-comment">;</span>
  }

  return (
    &lt;Spin <span class="hljs-attr">spinning</span>={loading}&gt;
      &lt;Table
        <span class="hljs-attr">dataSource</span>={data}
        <span class="hljs-attr">columns</span>={columns}
        <span class="hljs-attr">locale</span>={{
          emptyText: (
            &lt;Empty 
              <span class="hljs-attr">description</span>={loading ? <span class="hljs-string">'åŠ è½½ä¸­...'</span> : <span class="hljs-string">'æš‚æ— æ•°æ®'</span>}
              <span class="hljs-attr">image</span>={Empty.PRESENTED_IMAGE_SIMPLE}
            /&gt;
          )
        }}
        <span class="hljs-attr">pagination</span>={{
          showSizeChanger: true,
          showQuickJumper: true,
          showTotal: (total) =&gt; `å…± ${total} æ¡`,
          pageSizeOptions: <span class="hljs-section">['10', '20', '50', '100']</span>,
        }}
        {...rest}
      /&gt;
    &lt;/Spin&gt;
  )<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-4">3. åŠŸèƒ½å¢å¼ºä¸æ¨ªåˆ‡å…³æ³¨ç‚¹å¤„ç†</h3>
<p>ä¸­é—´å±‚å¤©ç„¶é€‚åˆå¤„ç†è·¨ç»„ä»¶çš„é€šç”¨é€»è¾‘ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// components/SecureButton/index.tsx</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span>, message, <span class="hljs-title class_">Modal</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span>;
<span class="hljs-keyword">import</span> { usePermission } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/hooks/usePermission'</span>;
<span class="hljs-keyword">import</span> { useTracking } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/hooks/useTracking'</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">SecureButtonProps</span> {
  <span class="hljs-comment">// æƒé™æ§åˆ¶</span>
  permission?: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">// æ“ä½œç¡®è®¤</span>
  confirm?: <span class="hljs-built_in">string</span> | { <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span> };
  <span class="hljs-comment">// åŸ‹ç‚¹è¿½è¸ª</span>
  tracking?: { <span class="hljs-attr">event</span>: <span class="hljs-built_in">string</span>; data?: <span class="hljs-built_in">any</span> };
  <span class="hljs-comment">// é˜²é‡å¤æäº¤</span>
  debounce?: <span class="hljs-built_in">number</span>;
  onClick?: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span> | <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">SecureButton</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span>&lt;<span class="hljs-title class_">SecureButtonProps</span>&gt; = <span class="hljs-function">(<span class="hljs-params">{
  permission,
  confirm,
  tracking,
  debounce = <span class="hljs-number">300</span>,
  onClick,
  children,
  ...props
}</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> { hasPermission } = <span class="hljs-title function_">usePermission</span>();
  <span class="hljs-keyword">const</span> { trackEvent } = <span class="hljs-title function_">useTracking</span>();
  <span class="hljs-keyword">const</span> [loading, setLoading] = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);

  <span class="hljs-comment">// æƒé™æ ¡éªŒ</span>
  <span class="hljs-keyword">if</span> (permission &amp;&amp; !<span class="hljs-title function_">hasPermission</span>(permission)) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-comment">// ç¡®è®¤å¯¹è¯æ¡†</span>
    <span class="hljs-keyword">if</span> (confirm) {
      <span class="hljs-keyword">const</span> confirmed = <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt;(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
        <span class="hljs-title class_">Modal</span>.<span class="hljs-title function_">confirm</span>({
          <span class="hljs-attr">title</span>: <span class="hljs-keyword">typeof</span> confirm === <span class="hljs-string">'string'</span> ? <span class="hljs-string">'ç¡®è®¤æ“ä½œ'</span> : confirm.<span class="hljs-property">title</span>,
          <span class="hljs-attr">content</span>: <span class="hljs-keyword">typeof</span> confirm === <span class="hljs-string">'string'</span> ? confirm : confirm.<span class="hljs-property">content</span>,
          <span class="hljs-attr">onOk</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-literal">true</span>),
          <span class="hljs-attr">onCancel</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-literal">false</span>),
        });
      });
      
      <span class="hljs-keyword">if</span> (!confirmed) <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// åŸ‹ç‚¹è®°å½•</span>
    <span class="hljs-keyword">if</span> (tracking) {
      <span class="hljs-title function_">trackEvent</span>(tracking.<span class="hljs-property">event</span>, tracking.<span class="hljs-property">data</span>);
    }

    <span class="hljs-comment">// åŠ è½½çŠ¶æ€ä¸é˜²é‡å¤</span>
    <span class="hljs-keyword">if</span> (!loading) {
      <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">true</span>);
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> onClick?.();
      } <span class="hljs-keyword">finally</span> {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">false</span>), debounce);
      }
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
      {<span class="hljs-attr">...props</span>}
      <span class="hljs-attr">loading</span>=<span class="hljs-string">{loading}</span>
      <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>
      <span class="hljs-attr">disabled</span>=<span class="hljs-string">{props.disabled</span> || <span class="hljs-attr">loading</span>}
    &gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>
  );
};
</code></pre>
<h3 data-id="heading-5">4. ç±»å‹å®‰å…¨ä¸å¼€å‘ä½“éªŒæå‡</h3>
<p>é€šè¿‡ TypeScript æä¾›ç²¾ç¡®çš„ç±»å‹æç¤ºå’Œçº¦æŸï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// types/table.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">TableColumn</span>&lt;T = <span class="hljs-built_in">any</span>&gt; {
  <span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">dataIndex</span>: keyof T;
  render?: <span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">any</span>, record: T, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-title class_">React</span>.<span class="hljs-property">ReactNode</span>;
  sorter?: <span class="hljs-built_in">boolean</span> | (<span class="hljs-function">(<span class="hljs-params">a: T, b: T</span>) =&gt;</span> <span class="hljs-built_in">number</span>);
  filters?: { <span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">value</span>: <span class="hljs-built_in">any</span> }[];
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">PaginationConfig</span> {
  <span class="hljs-attr">current</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">pageSize</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">total</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">onChange</span>: <span class="hljs-function">(<span class="hljs-params">page: <span class="hljs-built_in">number</span>, pageSize?: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>;
}

<span class="hljs-comment">// components/DataTable/index.tsx</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">TableColumn</span>, <span class="hljs-title class_">PaginationConfig</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/types/table'</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">DataTableProps</span>&lt;T&gt; {
  <span class="hljs-attr">data</span>: T[];
  <span class="hljs-attr">columns</span>: <span class="hljs-title class_">TableColumn</span>&lt;T&gt;[];
  pagination?: <span class="hljs-title class_">PaginationConfig</span>;
  loading?: <span class="hljs-built_in">boolean</span>;
  rowKey?: keyof T | (<span class="hljs-function">(<span class="hljs-params">record: T</span>) =&gt;</span> <span class="hljs-built_in">string</span>);
}
</code></pre>
<h2 data-id="heading-6">ä¸‰ã€ä¸­é—´å±‚è®¾è®¡æ¨¡å¼ä¸å®è·µ</h2>
<h3 data-id="heading-7">1. ç»„åˆæ¨¡å¼ (Composition)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// components/SearchTable/index.tsx</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">EnhancedTable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../EnhancedTable'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">SearchBar</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../SearchBar'</span>;
<span class="hljs-keyword">import</span> { usePagination } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/hooks/usePagination'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">SearchTable</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span>&lt;<span class="hljs-title class_">SearchTableProps</span>&gt; = <span class="hljs-function">(<span class="hljs-params">{
  searchFields,
  onSearch,
  ...tableProps
}</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> { pagination, setPagination } = <span class="hljs-title function_">usePagination</span>();
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSearch</span> = (<span class="hljs-params">values: <span class="hljs-built_in">any</span></span>) =&gt; {
    onSearch?.(values);
    <span class="hljs-title function_">setPagination</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> ({ ...prev, <span class="hljs-attr">current</span>: <span class="hljs-number">1</span> }));
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"search-table"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">SearchBar</span> <span class="hljs-attr">fields</span>=<span class="hljs-string">{searchFields}</span> <span class="hljs-attr">onSearch</span>=<span class="hljs-string">{handleSearch}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">EnhancedTable</span>
        {<span class="hljs-attr">...tableProps</span>}
        <span class="hljs-attr">pagination</span>=<span class="hljs-string">{{</span>
          <span class="hljs-attr">...pagination</span>,
          <span class="hljs-attr">onChange:</span> <span class="hljs-attr">setPagination</span>,
        }}
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
};
</code></pre>
<h3 data-id="heading-8">2. é«˜é˜¶ç»„ä»¶æ¨¡å¼ (HOC)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// hooks/withErrorBoundary.tsx</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> withErrorBoundary&lt;P <span class="hljs-keyword">extends</span> <span class="hljs-built_in">object</span>&gt;(
  <span class="hljs-title class_">Component</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">ComponentType</span>&lt;P&gt;,
  fallback?: <span class="hljs-title class_">React</span>.<span class="hljs-property">ReactNode</span>
) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ErrorBoundary</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span>&lt;P, { <span class="hljs-attr">hasError</span>: <span class="hljs-built_in">boolean</span> }&gt; {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props: P</span>) {
      <span class="hljs-variable language_">super</span>(props);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = { <span class="hljs-attr">hasError</span>: <span class="hljs-literal">false</span> };
    }

    <span class="hljs-keyword">static</span> <span class="hljs-title function_">getDerivedStateFromError</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">hasError</span>: <span class="hljs-literal">true</span> };
    }

    <span class="hljs-title function_">componentDidCatch</span>(<span class="hljs-params">error: <span class="hljs-built_in">Error</span>, errorInfo: React.ErrorInfo</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Component Error:'</span>, error, errorInfo);
    }

    <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">hasError</span>) {
        <span class="hljs-keyword">return</span> fallback || <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>ç»„ä»¶æ¸²æŸ“å¤±è´¥<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
      }

      <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Component</span> {<span class="hljs-attr">...this.props</span>} /&gt;</span></span>;
    }
  };
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">EnhancedTableWithErrorBoundary</span> = <span class="hljs-title function_">withErrorBoundary</span>(<span class="hljs-title class_">EnhancedTable</span>);
</code></pre>
<h3 data-id="heading-9">3. è‡ªå®šä¹‰ Hook æ¨¡å¼</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// hooks/useTable.ts</span>
<span class="hljs-keyword">import</span> { useState, useCallback } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> useTable&lt;T&gt;(<span class="hljs-attr">initialData</span>: T[] = []) {
  <span class="hljs-keyword">const</span> [data, setData] = useState&lt;T[]&gt;(initialData);
  <span class="hljs-keyword">const</span> [loading, setLoading] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [error, setError] = useState&lt;<span class="hljs-title class_">Error</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> refresh = <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span> (<span class="hljs-attr">fetchFunction</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;T[]&gt;) =&gt; {
    <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">true</span>);
    <span class="hljs-title function_">setError</span>(<span class="hljs-literal">null</span>);
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchFunction</span>();
      <span class="hljs-title function_">setData</span>(result);
      <span class="hljs-keyword">return</span> result;
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-title function_">setError</span>(err <span class="hljs-keyword">as</span> <span class="hljs-title class_">Error</span>);
      <span class="hljs-keyword">throw</span> err;
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">false</span>);
    }
  }, []);

  <span class="hljs-keyword">return</span> {
    data,
    loading,
    error,
    setData,
    refresh,
  };
}
</code></pre>
<h2 data-id="heading-10">å››ã€å®é™…ä¸šåŠ¡åœºæ™¯åº”ç”¨</h2>
<h3 data-id="heading-11">åœºæ™¯ï¼šç”¨æˆ·ç®¡ç†ç³»ç»Ÿè¡¨æ ¼</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// features/user/components/UserTable.tsx</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">SearchTable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/components/SearchTable'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">SecureButton</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/components/SecureButton'</span>;
<span class="hljs-keyword">import</span> { useUserTable } <span class="hljs-keyword">from</span> <span class="hljs-string">'../hooks/useUserTable'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">UserTable</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> {
    data,
    loading,
    pagination,
    searchFields,
    handleSearch,
    handleDelete,
    handleEdit,
  } = <span class="hljs-title function_">useUserTable</span>();

  <span class="hljs-keyword">const</span> columns = [
    {
      <span class="hljs-attr">key</span>: <span class="hljs-string">'name'</span>,
      <span class="hljs-attr">title</span>: <span class="hljs-string">'å§“å'</span>,
      <span class="hljs-attr">dataIndex</span>: <span class="hljs-string">'name'</span>,
    },
    {
      <span class="hljs-attr">key</span>: <span class="hljs-string">'email'</span>,
      <span class="hljs-attr">title</span>: <span class="hljs-string">'é‚®ç®±'</span>,
      <span class="hljs-attr">dataIndex</span>: <span class="hljs-string">'email'</span>,
    },
    {
      <span class="hljs-attr">key</span>: <span class="hljs-string">'actions'</span>,
      <span class="hljs-attr">title</span>: <span class="hljs-string">'æ“ä½œ'</span>,
      <span class="hljs-attr">render</span>: <span class="hljs-function">(<span class="hljs-params">_, record</span>) =&gt;</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">SecureButton</span>
            <span class="hljs-attr">size</span>=<span class="hljs-string">"small"</span>
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> handleEdit(record)}
            permission="user:edit"
          &gt;
            ç¼–è¾‘
          <span class="hljs-tag">&lt;/<span class="hljs-name">SecureButton</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">SecureButton</span>
            <span class="hljs-attr">size</span>=<span class="hljs-string">"small"</span>
            <span class="hljs-attr">danger</span>
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> handleDelete(record.id)}
            permission="user:delete"
            confirm="ç¡®å®šåˆ é™¤è¯¥ç”¨æˆ·å—ï¼Ÿ"
            tracking={{ event: 'user_delete' }}
          &gt;
            åˆ é™¤
          <span class="hljs-tag">&lt;/<span class="hljs-name">SecureButton</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
      ),
    },
  ];

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">SearchTable</span>
      <span class="hljs-attr">columns</span>=<span class="hljs-string">{columns}</span>
      <span class="hljs-attr">data</span>=<span class="hljs-string">{data}</span>
      <span class="hljs-attr">loading</span>=<span class="hljs-string">{loading}</span>
      <span class="hljs-attr">pagination</span>=<span class="hljs-string">{pagination}</span>
      <span class="hljs-attr">searchFields</span>=<span class="hljs-string">{searchFields}</span>
      <span class="hljs-attr">onSearch</span>=<span class="hljs-string">{handleSearch}</span>
      <span class="hljs-attr">rowKey</span>=<span class="hljs-string">"id"</span>
    /&gt;</span></span>
  );
};
</code></pre>
<h2 data-id="heading-12">äº”ã€æ¶æ„æ”¶ç›Šä¸é•¿æœŸä»·å€¼</h2>
<h3 data-id="heading-13">å¯åº¦é‡çš„æŠ€æœ¯æ”¶ç›Š</h3>
<ul>
<li>
<p><strong>å¼€å‘æ•ˆç‡</strong>ï¼šç»„ä»¶å¤ç”¨ç‡æå‡ 40-60%</p>
</li>
<li>
<p><strong>ç»´æŠ¤æˆæœ¬</strong>ï¼šUIåº“å‡çº§å·¥ä½œé‡å‡å°‘ 70-80%</p>
</li>
<li>
<p><strong>ä»£ç è´¨é‡</strong>ï¼šç±»å‹è¦†ç›–ç‡æå‡è‡³ 90%+</p>
</li>
<li>
<p><strong>å›¢é˜Ÿåä½œ</strong>ï¼šæ–°æˆå‘˜ä¸Šæ‰‹æ—¶é—´ç¼©çŸ­ 50%</p>
</li>
</ul>
<h3 data-id="heading-14">æˆ˜ç•¥ä»·å€¼</h3>
<ol>
<li>
<p><strong>æŠ€æœ¯å€ºåŠ¡æ§åˆ¶</strong>ï¼šé€šè¿‡ä¸­é—´å±‚éš”ç¦»å˜åŒ–ï¼Œæœ‰æ•ˆæ§åˆ¶æŠ€æœ¯å€ºåŠ¡ç§¯ç´¯</p>
</li>
<li>
<p><strong>æ¸è¿›å¼é‡æ„</strong>ï¼šæ”¯æŒè€ç³»ç»Ÿæ¸è¿›å¼è¿ç§»å’Œé‡æ„</p>
</li>
<li>
<p><strong>å¤šç«¯é€‚é…</strong>ï¼šä¸ºå°ç¨‹åºã€ç§»åŠ¨ç«¯ç­‰ä¸åŒå¹³å°æä¾›ç»Ÿä¸€API</p>
</li>
<li>
<p><strong>A/Bæµ‹è¯•</strong>ï¼šåœ¨ä¸­é—´å±‚å®ç°æ— ä¾µå…¥çš„åŠŸèƒ½å¼€å…³å’Œå®éªŒé…ç½®</p>
</li>
</ol>
<h2 data-id="heading-15">å…­ã€æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-16">å®æ–½å»ºè®®</h3>
<ol>
<li>
<p><strong>æ¸è¿›å¼æ¨è¿›</strong>ï¼šä»æœ€å¸¸ç”¨çš„ç»„ä»¶å¼€å§‹å°è£…ï¼Œé€æ­¥è¦†ç›–</p>
</li>
<li>
<p><strong>æ–‡æ¡£é©±åŠ¨</strong>ï¼šä¸ºæ¯ä¸ªä¸­é—´å±‚ç»„ä»¶æä¾›å®Œæ•´çš„ä½¿ç”¨æ–‡æ¡£å’Œç¤ºä¾‹</p>
</li>
<li>
<p><strong>ç‰ˆæœ¬ç®¡ç†</strong>ï¼šå»ºç«‹ä¸­é—´å±‚ç»„ä»¶çš„ç‰ˆæœ¬å‘å¸ƒå’Œæ›´æ–°æœºåˆ¶</p>
</li>
<li>
<p><strong>æ€§èƒ½ç›‘æ§</strong>ï¼šç›‘æ§ä¸­é—´å±‚ç»„ä»¶çš„æ€§èƒ½å½±å“å’Œé”™è¯¯ç‡</p>
</li>
</ol>
<h3 data-id="heading-17">é¿å…çš„é™·é˜±</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ è¿‡åº¦å°è£… - å¢åŠ äº†ä¸å¿…è¦çš„å¤æ‚åº¦</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">SuperButton</span> = (<span class="hljs-params">{ 
  ultraProp, 
  megaConfig, 
  ...rest 
}</span>) =&gt; {
  <span class="hljs-comment">// è¿‡äºå¤æ‚çš„é€»è¾‘...</span>
};

<span class="hljs-comment">// âœ… é€‚åº¦å°è£… - ä¿æŒç®€å•æ¸…æ™°</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">PrimaryButton</span> = (<span class="hljs-params">{ 
  confirm, 
  tracking, 
  ...buttonProps 
}</span>) =&gt; {
  <span class="hljs-comment">// èšç„¦æ ¸å¿ƒå¢å¼ºåŠŸèƒ½...</span>
};
</code></pre>
<h2 data-id="heading-18">æ€»ç»“</h2>
<p>å‰ç«¯ç»„ä»¶ä¸­é—´å±‚è®¾è®¡ä¸ä»…æ˜¯æŠ€æœ¯å®ç°ï¼Œæ›´æ˜¯æ¶æ„æ€ç»´çš„ä½“ç°ã€‚å®ƒé€šè¿‡åˆç†çš„æŠ½è±¡å’Œå°è£…ï¼Œåœ¨ä¿è¯å¼€å‘ä½“éªŒçš„åŒæ—¶ï¼Œä¸ºåº”ç”¨é•¿æœŸæ¼”è¿›æä¾›äº†åšå®çš„æŠ€æœ¯åŸºç¡€ã€‚æˆåŠŸçš„ä¸­é—´å±‚è®¾è®¡åº”è¯¥åƒä¸€åº§ç²¾å¿ƒè®¾è®¡çš„æ¡¥æ¢ï¼Œæ—¢è¿æ¥ç°åœ¨ä¸æœªæ¥ï¼Œåˆæ‰¿è½½ç€å›¢é˜Ÿåä½œå’Œä¸šåŠ¡å‘å±•çš„é‡ä»»ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰“ç ´è¯¯è§£ï¼MongoDB äº‹åŠ¡éš”ç¦»çº§åˆ«æ·±åº¦å®æµ‹ï¼šå¿«ç…§éš”ç¦»ç«Ÿèƒ½é˜²ä½ 8 ç§å¼‚å¸¸ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7570598043297480767</link>    <guid>https://juejin.cn/post/7570598043297480767</guid>    <pubDate>2025-11-10T06:18:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570598043297480767" data-draft-id="7570534000717496383" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰“ç ´è¯¯è§£ï¼MongoDB äº‹åŠ¡éš”ç¦»çº§åˆ«æ·±åº¦å®æµ‹ï¼šå¿«ç…§éš”ç¦»ç«Ÿèƒ½é˜²ä½ 8 ç§å¼‚å¸¸ï¼Ÿ"/> <meta itemprop="keywords" content="æ•°æ®åº“"/> <meta itemprop="datePublished" content="2025-11-10T06:18:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‘¡è„åŸæŠ€æœ¯å›¢é˜Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3227821868332765"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰“ç ´è¯¯è§£ï¼MongoDB äº‹åŠ¡éš”ç¦»çº§åˆ«æ·±åº¦å®æµ‹ï¼šå¿«ç…§éš”ç¦»ç«Ÿèƒ½é˜²ä½ 8 ç§å¼‚å¸¸ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3227821868332765/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‘¡è„åŸæŠ€æœ¯å›¢é˜Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T06:18:33.000Z" title="Mon Nov 10 2025 06:18:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ‰“ç ´è¯¯è§£ï¼MongoDB äº‹åŠ¡éš”ç¦»çº§åˆ«æ·±åº¦å®æµ‹ï¼šå¿«ç…§éš”ç¦»ç«Ÿèƒ½é˜²ä½ 8 ç§å¼‚å¸¸ï¼Ÿ</h2>
<p>ä½œä¸º NoSQL æ•°æ®åº“çš„ä»£è¡¨ï¼ŒMongoDB çš„äº‹åŠ¡èƒ½åŠ›ä¸€ç›´è¢«éƒ¨åˆ†å¼€å‘è€…â€œä½ä¼°â€â€”â€”ä¸å°‘äººè¿˜æŠ±ç€â€œè€ç‰ˆæœ¬æœ‰å‘â€â€œNoSQL äº‹åŠ¡ä¸é è°±â€çš„å›ºæœ‰å°è±¡ã€‚ä½†å®é™…ä¸Šï¼Œè‡ª 4.0 ç‰ˆæœ¬æ”¯æŒå¤šæ–‡æ¡£äº‹åŠ¡åï¼ŒMongoDB å·²å®ç° ACID å…¼å®¹ï¼Œå…¶åŸºäºå¿«ç…§éš”ç¦»ï¼ˆSnapshot Isolationï¼‰çš„è®¾è®¡ï¼Œä¸ä»…èƒ½åª²ç¾ä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“çš„ä¸€è‡´æ€§ï¼Œè¿˜é€šè¿‡ç‹¬ç‰¹çš„å†²çªå¤„ç†æœºåˆ¶å…¼é¡¾äº†æ€§èƒ½ã€‚æœ¬æ–‡ç»“åˆå®Œæ•´å®æµ‹ä»£ç å’Œæ¡ˆä¾‹ï¼Œå¸¦å¤§å®¶å½»åº•ææ‡‚ MongoDB çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œç†æ¸…é‚£äº›æµä¼ å·²ä¹…çš„è¯¯è§£ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€æ ¸å¿ƒç»“è®ºï¼šMongoDB äº‹åŠ¡éš”ç¦»çº§åˆ«çš„æœ¬è´¨</h3>
<p>MongoDB çš„å¤šæ–‡æ¡£äº‹åŠ¡é‡‡ç”¨<strong>å¿«ç…§éš”ç¦»ï¼ˆSnapshot Isolationï¼‰</strong> æœºåˆ¶ï¼Œä¾æ‰˜å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰å®ç°å¼ºä¸€è‡´æ€§ï¼Œå®Œå…¨æ»¡è¶³ ACID ç‰¹æ€§ã€‚</p>
<p>å¾ˆå¤šå¼€å‘è€…ä¼šä¸‹æ„è¯†å°†å…¶ä¸ SQL æ ‡å‡†çš„éš”ç¦»çº§åˆ«å¯¹æ ‡ï¼Œä½†è¿™ç§åšæ³•å¹¶ä¸æ°å½“â€”â€”SQL æ ‡å‡†çš„éš”ç¦»çº§åˆ«å®šä¹‰å¹¶æœªè€ƒè™‘ MVCCï¼Œè€Œ MongoDBã€PostgreSQL ç­‰ä¸»æµæ•°æ®åº“å‡ä¾èµ– MVCC å®ç°å¹¶å‘æ§åˆ¶ã€‚ç®€å•æ¥è¯´ï¼š</p>
<ul>
<li>MongoDB çš„äº‹åŠ¡éš”ç¦»èƒ½åŠ›ä¸é€Šè‰²äºä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“ï¼›</li>
<li>æ—©æœŸç‰ˆæœ¬ï¼ˆå¦‚ 4.0 åˆšæ”¯æŒå¤šæ–‡æ¡£äº‹åŠ¡æ—¶ï¼‰çš„éƒ¨åˆ†é—®é¢˜å·²å®Œå…¨ä¿®å¤ï¼Œåƒæ—©æœŸ Jepsen æŠ¥å‘Šä¸­æåˆ°çš„å¼‚å¸¸åœºæ™¯å·²ä¸å¤å­˜åœ¨ï¼›</li>
<li>å…¶éš”ç¦»çº§åˆ«é€šè¿‡<code>readConcern</code>ï¼ˆè¯»å…³æ³¨çº§åˆ«ï¼‰æ§åˆ¶ï¼Œä¸åŒçº§åˆ«å¯¹åº”ä¸åŒçš„ä¸€è‡´æ€§ä¿éšœå’Œä½¿ç”¨åœºæ™¯ã€‚</li>
</ul>
<h3 data-id="heading-2">äºŒã€å„è¯»å…³æ³¨çº§åˆ«çš„ç‰¹ç‚¹ï¼ˆä¸ SQL éš”ç¦»çº§åˆ«çš„åŒºåˆ«ï¼‰</h3>
<p>MongoDB çš„äº‹åŠ¡éš”ç¦»æ ¸å¿ƒç”±<code>readConcern</code>å‚æ•°æ§åˆ¶ï¼Œä¸åŒçº§åˆ«å¯¹åº”ä¸åŒçš„ä¸€è‡´æ€§è¡¨ç°ï¼Œä¸”æ— æ³•ç›´æ¥ç­‰åŒäº SQL æ ‡å‡†çš„éš”ç¦»çº§åˆ«ï¼Œå…·ä½“ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p>
<h4 data-id="heading-3">1. local çº§åˆ«</h4>
<ul>
<li>å¯èƒ½è¯»å–åˆ°æœªæäº¤çš„ä¸­é—´çŠ¶æ€ï¼ˆè¿™äº›çŠ¶æ€åç»­å¯èƒ½å› äº‹åŠ¡å›æ»šè€Œå¤±æ•ˆï¼‰ï¼Œå› æ­¤æœ‰æ—¶è¢«ç±»æ¯”ä¸º SQL çš„â€œè¯»æœªæäº¤â€ï¼›</li>
<li>ä½†éœ€æ³¨æ„ï¼šéƒ¨åˆ† SQL æ•°æ®åº“åœ¨æç«¯æƒ…å†µä¸‹ä¹Ÿä¼šå‡ºç°ç±»ä¼¼è¡Œä¸ºï¼Œå´ä»å°†å…¶å½’ä¸ºâ€œè¯»å·²æäº¤â€çº§åˆ«ï¼Œå¯è§ç›´æ¥å¯¹æ ‡å¹¶ä¸ä¸¥è°¨ã€‚</li>
</ul>
<h4 data-id="heading-4">2. majority çº§åˆ«</h4>
<ul>
<li>ä»…è¯»å–å·²è¢«å¤§å¤šæ•°èŠ‚ç‚¹ç¡®è®¤æäº¤çš„æ•°æ®ï¼Œé¿å…äº†â€œè¯»æœªæäº¤â€é—®é¢˜ï¼Œå¸¸è¢«ç±»æ¯”ä¸º SQL çš„â€œè¯»å·²æäº¤â€ï¼›</li>
<li>å…³é”®åŒºåˆ«ï¼šSQL çš„â€œè¯»å·²æäº¤â€æ˜¯ä¸ºäº†å‡å°‘ä¸¤é˜¶æ®µé”çš„é”å®šæ—¶é•¿ï¼Œé‡‡ç”¨â€œå†²çªç­‰å¾…â€æœºåˆ¶ï¼›è€Œ MongoDB å¤šæ–‡æ¡£äº‹åŠ¡é‡‡ç”¨â€œå†²çªå³å¤±è´¥â€ï¼ˆfail-on-conflictï¼‰æœºåˆ¶ï¼Œé¿å…é•¿æ—¶é—´ç­‰å¾…ï¼›</li>
<li>å±€é™ï¼šåœ¨å¤šåˆ†ç‰‡åœºæ™¯ä¸‹ï¼Œå¯èƒ½è¯»å–åˆ°å¤šä¸ªä¸åŒæ—¶é—´ç‚¹çš„çŠ¶æ€ï¼Œæ— æ³•ä¿è¯è·¨åˆ†ç‰‡çš„æ—¶é—´çº¿ä¸€è‡´æ€§ã€‚</li>
</ul>
<h4 data-id="heading-5">3. snapshot çº§åˆ«</h4>
<ul>
<li>çœŸæ­£ç­‰åŒäºâ€œå¿«ç…§éš”ç¦»â€ï¼Œèƒ½æä¾›è·¨åˆ†ç‰‡çš„æ—¶é—´çº¿ä¸€è‡´æ€§ï¼Œé˜²æ­¢çš„å¼‚å¸¸åœºæ™¯æ¯”â€œè¯»å·²æäº¤â€æ›´å¤šï¼›</li>
<li>æœ‰è¶£çš„æ˜¯ï¼šéƒ¨åˆ†æ•°æ®åº“ä¼šå°†å…¶ç§°ä¸ºâ€œå¯ä¸²è¡ŒåŒ–â€ï¼Œå› ä¸º SQL æ ‡å‡†å¹¶æœªè€ƒè™‘â€œå†™å€¾æ–œâ€ï¼ˆwrite skewï¼‰å¼‚å¸¸ï¼Œè€Œå¿«ç…§éš”ç¦»æœ¬èº«å¯è§„é¿éƒ¨åˆ†æ­¤ç±»åœºæ™¯ã€‚</li>
</ul>
<h4 data-id="heading-6">4. linearizable çº§åˆ«</h4>
<ul>
<li>ä»…é€‚ç”¨äºå•æ–‡æ¡£æ“ä½œï¼Œæ— æ³•ç”¨äºå¤šæ–‡æ¡£äº‹åŠ¡ï¼Œå¯ç±»æ¯”ä¸º SQL çš„â€œå¯ä¸²è¡ŒåŒ–â€ï¼›</li>
<li>ç‰¹ç‚¹ï¼šèƒ½ä¿è¯å•æ–‡æ¡£æ“ä½œçš„çº¿æ€§ä¸€è‡´æ€§ï¼Œä½†ä¼šé‡æ–°å¼•å…¥è¯»é”å¸¦æ¥çš„æ‰©å±•æ€§é—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯å¤šæ•°æ•°æ®åº“ä¸é»˜è®¤æä¾›å¯ä¸²è¡ŒåŒ–çº§åˆ«çš„åŸå› â€”â€”MVCC çš„æ ¸å¿ƒä¼˜åŠ¿å°±æ˜¯é¿å…è¯»é”ã€‚</li>
</ul>
<h3 data-id="heading-7">ä¸‰ã€å®æµ‹éªŒè¯ï¼šMongoDB å¦‚ä½•é˜²æ­¢äº‹åŠ¡å¼‚å¸¸ï¼Ÿ</h3>
<p>ä¸ºäº†éªŒè¯ MongoDB äº‹åŠ¡çš„éš”ç¦»èƒ½åŠ›ï¼Œæµ‹è¯•è€…éµå¾ª Martin Kleppmann çš„æµ‹è¯•æ¡†æ¶ï¼ˆåŸæœ¬ç”¨äº PostgreSQLï¼‰ï¼Œé’ˆå¯¹å¤šæ–‡æ¡£äº‹åŠ¡åœºæ™¯è¿›è¡Œäº†ä¸€ç³»åˆ—å®æµ‹ã€‚æ‰€æœ‰æµ‹è¯•å‡é‡‡ç”¨<code>readConcern: majority</code>å’Œ<code>writeConcern: majority</code>é…ç½®ï¼ˆå•èŠ‚ç‚¹ç¯å¢ƒï¼‰ï¼Œéƒ¨åˆ†è·¨åˆ†ç‰‡åœºæ™¯éœ€ä½¿ç”¨<code>snapshot</code>çº§åˆ«ï¼Œä»¥ä¸‹æ˜¯å¸¦å®Œæ•´ä»£ç çš„å…³é”®æµ‹è¯•ç»“æœï¼š</p>
<h4 data-id="heading-8">æµ‹è¯•å‰æ</h4>
<p>æ‰€æœ‰æµ‹è¯•å‡åˆå§‹åŒ–åŸºç¡€æ•°æ®ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®</span>
use test_db;
db.<span class="hljs-property">test</span>.<span class="hljs-title function_">drop</span>();
db.<span class="hljs-property">test</span>.<span class="hljs-title function_">insertMany</span>([
  { <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">10</span> },
  { <span class="hljs-attr">_id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">20</span> }
]);
</code></pre>
<p>äº‹åŠ¡å‡é€šè¿‡<code>startSession()</code>å¼€å¯ï¼Œæ˜ç¡®æŒ‡å®šè¯»/å†™å…³æ³¨çº§åˆ«ã€‚</p>
<h4 data-id="heading-9">1. é˜²æ­¢å†™å¾ªç¯ï¼ˆG0ï¼‰ï¼šå†²çªå³å¤±è´¥ï¼Œæ‹’ç»æ— é™ç­‰å¾…</h4>
<ul>
<li>æµ‹è¯•åœºæ™¯ï¼šä¸¤ä¸ªäº‹åŠ¡åŒæ—¶æ›´æ–°åŒä¸€æ–‡æ¡£ï¼›</li>
<li>ä¼ ç»Ÿä¸¤é˜¶æ®µé”æ•°æ®åº“ï¼šç¬¬äºŒä¸ªäº‹åŠ¡ä¼šç­‰å¾…ç¬¬ä¸€ä¸ªäº‹åŠ¡å®Œæˆï¼Œé¿å…å†²çªï¼›</li>
<li>MongoDB æµ‹è¯•ä»£ç ï¼š</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®ï¼ˆåŒä¸Šï¼Œç•¥ï¼‰</span>

<span class="hljs-comment">// äº‹åŠ¡T1</span>
<span class="hljs-keyword">const</span> session1 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T1</span> = session1.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session1.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// äº‹åŠ¡T2</span>
<span class="hljs-keyword">const</span> session2 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T2</span> = session2.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session2.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// ä¸¤ä¸ªäº‹åŠ¡åŒæ—¶æ›´æ–°åŒä¸€æ–‡æ¡£</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">11</span> } });
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">12</span> } });

<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼šæŠ›å‡ºå†™å†²çªé”™è¯¯</span>
<span class="hljs-comment">// MongoServerError[WriteConflict]: Caused by :: Write conflict during plan execution and yielding is disabled. :: Please retry your operation or multi-document transaction.</span>
</code></pre>
<ul>
<li>å…³é”®å·®å¼‚ï¼šéšå¼å•æ–‡æ¡£äº‹åŠ¡ï¼ˆè‡ªåŠ¨æäº¤ï¼‰é‡‡ç”¨â€œå†²çªç­‰å¾…â€æœºåˆ¶ï¼Œæµ‹è¯•ä¸­ç­‰å¾… 60 ç§’è¶…æ—¶åæ‰§è¡ŒæˆåŠŸï¼š</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> db = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">getDB</span>(<span class="hljs-string">"test_db"</span>);
<span class="hljs-title function_">print</span>(<span class="hljs-string">`Elapsed time: <span class="hljs-subst">${
  ((startTime = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>())
  &amp;amp;&amp;amp; db.test.updateOne({ _id: <span class="hljs-number">1</span> }, { $set: { value: <span class="hljs-number">12</span> } }))
  &amp;amp;&amp;amp; (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() - startTime)
}</span> ms`</span>);

<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼šElapsed time: 72548 msï¼ˆç­‰å¾…çº¦60ç§’è¶…æ—¶åæˆåŠŸï¼‰</span>
<span class="hljs-comment">// æ­¤æ—¶T1äº‹åŠ¡å› è¶…æ—¶è¢«ä¸­æ­¢ï¼Œæäº¤æ—¶ä¼šæŠ¥é”™ï¼š</span>
<span class="hljs-comment">// session1.commitTransaction();</span>
<span class="hljs-comment">// MongoServerError[NoSuchTransaction]: Transaction with { txnNumber: 2 } has been aborted.</span>
</code></pre>
<ul>
<li>ç»“è®ºï¼šæ˜¾å¼å¤šæ–‡æ¡£äº‹åŠ¡é‡‡ç”¨â€œå†²çªå³å¤±è´¥â€ï¼Œè®©åº”ç”¨è‡ªè¡Œå¤„ç†é‡è¯•é€»è¾‘ï¼Œå…¼é¡¾å¤æ‚äº‹åŠ¡çš„çµæ´»æ€§ã€‚</li>
</ul>
<h4 data-id="heading-10">2. é˜²æ­¢æœªæäº¤è¯»ï¼ˆG1aï¼‰ï¼šåªè®¤å·²æäº¤æ•°æ®</h4>
<ul>
<li>æµ‹è¯•åœºæ™¯ï¼šäº‹åŠ¡ T1 æ›´æ–°æ–‡æ¡£åæœªæäº¤ï¼Œäº‹åŠ¡ T2 è¯»å–è¯¥æ–‡æ¡£ï¼›</li>
<li>MongoDB æµ‹è¯•ä»£ç ï¼š</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®ï¼ˆåŒä¸Šï¼Œç•¥ï¼‰</span>

<span class="hljs-comment">// äº‹åŠ¡T1</span>
<span class="hljs-keyword">const</span> session1 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T1</span> = session1.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session1.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// äº‹åŠ¡T2</span>
<span class="hljs-keyword">const</span> session2 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T2</span> = session2.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session2.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// T1æ›´æ–°æ–‡æ¡£ä½†æœªæäº¤</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">101</span> } });

<span class="hljs-comment">// T2è¯»å–æ–‡æ¡£ï¼Œä»…èƒ½çœ‹åˆ°å·²æäº¤æ•°æ®</span>
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>(); 
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[ { _id: 1, value: 10 }, { _id: 2, value: 20 } ]</span>

<span class="hljs-comment">// T1å›æ»šäº‹åŠ¡</span>
session1.<span class="hljs-title function_">abortTransaction</span>();

<span class="hljs-comment">// T2å†æ¬¡è¯»å–ï¼Œç»“æœä¸å˜</span>
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>(); 
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[ { _id: 1, value: 10 }, { _id: 2, value: 20 } ]</span>

session2.<span class="hljs-title function_">commitTransaction</span>();
</code></pre>
<ul>
<li>ç»“è®ºï¼š<code>majority</code>æˆ–<code>snapshot</code>çº§åˆ«å‡èƒ½æœç»â€œè¯»å–æœªæäº¤æ•°æ®â€çš„å¼‚å¸¸ã€‚</li>
</ul>
<h4 data-id="heading-11">3. é˜²æ­¢ä¸­é—´è¯»ï¼ˆG1bï¼‰ï¼šäº‹åŠ¡å†…è¯»æ—¶é—´çº¿å›ºå®š</h4>
<ul>
<li>æµ‹è¯•åœºæ™¯ï¼šT1 æ›´æ–°æ–‡æ¡£å¹¶æäº¤ï¼ŒT2 åœ¨ T1 æäº¤å‰å·²å¯åŠ¨ï¼Œåç»­å†æ¬¡è¯»å–è¯¥æ–‡æ¡£ï¼›</li>
<li>MongoDB æµ‹è¯•ä»£ç ï¼š</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®ï¼ˆåŒä¸Šï¼Œç•¥ï¼‰</span>

<span class="hljs-comment">// äº‹åŠ¡T1</span>
<span class="hljs-keyword">const</span> session1 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T1</span> = session1.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session1.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// äº‹åŠ¡T2</span>
<span class="hljs-keyword">const</span> session2 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T2</span> = session2.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session2.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// T1æ›´æ–°æ–‡æ¡£ï¼ˆæœªæäº¤ï¼‰</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">101</span> } });

<span class="hljs-comment">// T2è¯»å–ï¼Œçœ‹ä¸åˆ°æœªæäº¤å˜æ›´</span>
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>(); 
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[ { _id: 1, value: 10 }, { _id: 2, value: 20 } ]</span>

<span class="hljs-comment">// T1ä¿®æ”¹å¹¶æäº¤</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">11</span> } });
session1.<span class="hljs-title function_">commitTransaction</span>();

<span class="hljs-comment">// T2å†æ¬¡è¯»å–ï¼Œä»çœ‹ä¸åˆ°T1æäº¤çš„æ–°å€¼</span>
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>(); 
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[ { _id: 1, value: 10 }, { _id: 2, value: 20 } ]</span>

session2.<span class="hljs-title function_">commitTransaction</span>();
</code></pre>
<ul>
<li>åŒºåˆ«äº SQLï¼šå¤šæ•° MVCC æ¶æ„çš„ SQL æ•°æ®åº“åœ¨â€œè¯»å·²æäº¤â€çº§åˆ«ä¸‹ï¼Œä¼šåœ¨æ¯ä¸ªè¯­å¥æ‰§è¡Œå‰é‡ç½®è¯»æ—¶é—´çº¿ï¼Œå› æ­¤èƒ½çœ‹åˆ°åç»­æäº¤çš„æ–°å€¼ï¼Œè€Œ MongoDB äº‹åŠ¡çš„è¯»æ—¶é—´çº¿å›ºå®šåœ¨äº‹åŠ¡å¯åŠ¨æ—¶ï¼Œä»æ ¹æºé¿å…äº†â€œä¸­é—´è¯»â€ã€‚</li>
</ul>
<h4 data-id="heading-12">4. é˜²æ­¢å¾ªç¯ä¿¡æ¯æµè½¬ï¼ˆG1cï¼‰ï¼šæœªæäº¤å˜æ›´äº’ä¸å¯è§</h4>
<ul>
<li>æµ‹è¯•åœºæ™¯ï¼šT1 æ›´æ–°æ–‡æ¡£ 1ï¼ŒT2 æ›´æ–°æ–‡æ¡£ 2ï¼Œä¸¤è€…äº’ç›¸è¯»å–å¯¹æ–¹æ›´æ–°çš„æ–‡æ¡£ï¼›</li>
<li>MongoDB æµ‹è¯•ä»£ç ï¼š</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®ï¼ˆåŒä¸Šï¼Œç•¥ï¼‰</span>

<span class="hljs-comment">// äº‹åŠ¡T1</span>
<span class="hljs-keyword">const</span> session1 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T1</span> = session1.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session1.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// äº‹åŠ¡T2</span>
<span class="hljs-keyword">const</span> session2 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T2</span> = session2.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session2.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// T1æ›´æ–°æ–‡æ¡£1ï¼ŒT2æ›´æ–°æ–‡æ¡£2</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">11</span> } });
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">2</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">22</span> } });

<span class="hljs-comment">// T1è¯»å–æ–‡æ¡£2ï¼Œçœ‹ä¸åˆ°T2çš„æœªæäº¤æ›´æ–°</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">2</span> }); 
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[ { _id: 2, value: 20 } ]</span>

<span class="hljs-comment">// T2è¯»å–æ–‡æ¡£1ï¼Œçœ‹ä¸åˆ°T1çš„æœªæäº¤æ›´æ–°</span>
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span> }); 
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[ { _id: 1, value: 10 } ]</span>

<span class="hljs-comment">// æäº¤ä¸¤ä¸ªäº‹åŠ¡</span>
session1.<span class="hljs-title function_">commitTransaction</span>();
session2.<span class="hljs-title function_">commitTransaction</span>();
</code></pre>
<h4 data-id="heading-13">5. é˜²æ­¢äº‹åŠ¡æ¶ˆå¤±ï¼ˆOTVï¼‰ï¼šå¤šäº‹åŠ¡å†²çªå¿«é€Ÿå¤±è´¥</h4>
<ul>
<li>æµ‹è¯•åœºæ™¯ï¼šä¸‰ä¸ªäº‹åŠ¡åŒæ—¶æ“ä½œåŒä¸€æ‰¹æ–‡æ¡£ï¼Œå­˜åœ¨äº¤å‰æ›´æ–°ï¼›</li>
<li>MongoDB æµ‹è¯•ä»£ç ï¼š</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®ï¼ˆåŒä¸Šï¼Œç•¥ï¼‰</span>

<span class="hljs-comment">// äº‹åŠ¡T1</span>
<span class="hljs-keyword">const</span> session1 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T1</span> = session1.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session1.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// äº‹åŠ¡T2</span>
<span class="hljs-keyword">const</span> session2 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T2</span> = session2.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session2.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// äº‹åŠ¡T3</span>
<span class="hljs-keyword">const</span> session3 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T3</span> = session3.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session3.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// T1æ›´æ–°ä¸¤ä¸ªæ–‡æ¡£</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">11</span> } });
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">2</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">19</span> } });

<span class="hljs-comment">// T2æ›´æ–°æ–‡æ¡£1ï¼Œè§¦å‘å†²çª</span>
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">12</span> } });

<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼šæŠ›å‡ºå†™å†²çªé”™è¯¯</span>
<span class="hljs-comment">// MongoServerError[WriteConflict]: Caused by :: Write conflict during plan execution and yielding is disabled. :: Please retry your operation or multi-document transaction.</span>
</code></pre>
<ul>
<li>ä¼˜åŠ¿ï¼šç›¸æ¯”ä¼ ç»Ÿæ•°æ®åº“çš„â€œç­‰å¾…-è¶…æ—¶â€æœºåˆ¶ï¼ŒMongoDB çš„â€œå†²çªå³å¤±è´¥â€èƒ½è®©åº”ç”¨æ›´å¿«æ„ŸçŸ¥å¹¶å¤„ç†å†²çªï¼Œæå‡æ•´ä½“ååé‡ã€‚</li>
</ul>
<h4 data-id="heading-14">6. é˜²æ­¢å¤šå‰é©±è°“è¯å¼‚å¸¸ï¼ˆPMPï¼‰ï¼šå¿«ç…§ä¸€è‡´æ€§è¦†ç›–æŸ¥è¯¢åœºæ™¯</h4>
<ul>
<li>æµ‹è¯•åœºæ™¯ 1ï¼šT1 å¯åŠ¨åæ‰§è¡ŒæŸ¥è¯¢ï¼ˆæ— åŒ¹é…ç»“æœï¼‰ï¼ŒT2 æ’å…¥åŒ¹é…è¯¥æŸ¥è¯¢æ¡ä»¶çš„æ–‡æ¡£å¹¶æäº¤ï¼ŒT1 å†æ¬¡æ‰§è¡Œç›¸åŒæŸ¥è¯¢ï¼›</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®ï¼ˆåŒä¸Šï¼Œç•¥ï¼‰</span>

<span class="hljs-comment">// äº‹åŠ¡T1</span>
<span class="hljs-keyword">const</span> session1 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T1</span> = session1.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session1.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// äº‹åŠ¡T2</span>
<span class="hljs-keyword">const</span> session2 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T2</span> = session2.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session2.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// T1æŸ¥è¯¢value=30çš„æ–‡æ¡£ï¼Œæ— ç»“æœ</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">value</span>: <span class="hljs-number">30</span> }).<span class="hljs-title function_">toArray</span>(); 
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[]</span>

<span class="hljs-comment">// T2æ’å…¥åŒ¹é…æ¡ä»¶çš„æ–‡æ¡£å¹¶æäº¤</span>
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">insertOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">30</span> });
session2.<span class="hljs-title function_">commitTransaction</span>();

<span class="hljs-comment">// T1å†æ¬¡æŸ¥è¯¢ï¼Œä»æ— ç»“æœ</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">value</span>: { <span class="hljs-attr">$mod</span>: [<span class="hljs-number">3</span>, <span class="hljs-number">0</span>] } }).<span class="hljs-title function_">toArray</span>(); 
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[]</span>

session1.<span class="hljs-title function_">commitTransaction</span>();
</code></pre>
<ul>
<li>æµ‹è¯•åœºæ™¯ 2ï¼šT1 æ‰¹é‡æ›´æ–°æ–‡æ¡£ï¼ŒT2 æ‰¹é‡åˆ é™¤åŒ¹é…æ–‡æ¡£ï¼Œè§¦å‘å†²çªï¼›</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®ï¼ˆåŒä¸Šï¼Œç•¥ï¼‰</span>

<span class="hljs-comment">// äº‹åŠ¡T1</span>
<span class="hljs-keyword">const</span> session1 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T1</span> = session1.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session1.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// äº‹åŠ¡T2</span>
<span class="hljs-keyword">const</span> session2 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T2</span> = session2.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session2.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// T1æ‰¹é‡æ›´æ–°æ‰€æœ‰æ–‡æ¡£</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateMany</span>({}, { <span class="hljs-attr">$inc</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">10</span> } });

<span class="hljs-comment">// T2åˆ é™¤value=20çš„æ–‡æ¡£ï¼Œè§¦å‘å†²çª</span>
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">deleteMany</span>({ <span class="hljs-attr">value</span>: <span class="hljs-number">20</span> });

<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼šæŠ›å‡ºå†™å†²çªé”™è¯¯</span>
<span class="hljs-comment">// MongoServerError[WriteConflict]: Caused by :: Write conflict during plan execution and yielding is disabled. :: Please retry your operation or multi-document transaction.</span>
</code></pre>
<ul>
<li>ç»“è®ºï¼šMongoDB é€šè¿‡å¿«ç…§éš”ç¦»å’Œå†²çªæ£€æµ‹ï¼Œé¿å…äº†åŸºäºè¿‡æ—¶æŸ¥è¯¢ç»“æœæ‰§è¡Œå†™æ“ä½œçš„å¼‚å¸¸ã€‚</li>
</ul>
<h4 data-id="heading-15">7. é˜²æ­¢ä¸¢å¤±æ›´æ–°ï¼ˆP4ï¼‰ï¼šæ‹’ç»å¹¶è¡Œæ›´æ–°è¦†ç›–</h4>
<ul>
<li>æµ‹è¯•åœºæ™¯ï¼šä¸¤ä¸ªäº‹åŠ¡åŒæ—¶è¯»å–åŒä¸€æ–‡æ¡£ï¼ŒåŸºäºç›¸åŒçš„æ—§å€¼æ‰§è¡Œæ›´æ–°ï¼›</li>
<li>MongoDB æµ‹è¯•ä»£ç ï¼š</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®ï¼ˆåŒä¸Šï¼Œç•¥ï¼‰</span>

<span class="hljs-comment">// äº‹åŠ¡T1</span>
<span class="hljs-keyword">const</span> session1 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T1</span> = session1.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session1.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// äº‹åŠ¡T2</span>
<span class="hljs-keyword">const</span> session2 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T2</span> = session2.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session2.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// ä¸¤ä¸ªäº‹åŠ¡å‡è¯»å–æ–‡æ¡£1çš„æ—§å€¼</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span> }); 
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[ { _id: 1, value: 10 } ]</span>
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span> }); 
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[ { _id: 1, value: 10 } ]</span>

<span class="hljs-comment">// ä¸¤ä¸ªäº‹åŠ¡åŸºäºæ—§å€¼æ‰§è¡Œæ›´æ–°ï¼Œåæ‰§è¡Œçš„è§¦å‘å†²çª</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">11</span> } });
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">11</span> } });

<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼šæŠ›å‡ºå†™å†²çªé”™è¯¯</span>
<span class="hljs-comment">// MongoServerError[WriteConflict]: Caused by :: Write conflict during plan execution and yielding is disabled. :: Please retry your operation or multi-document transaction.</span>
</code></pre>
<ul>
<li>å…³é”®ï¼šåº”ç”¨åªéœ€æ•è·è¯¥é”™è¯¯å¹¶é‡è¯•ï¼Œå³å¯ä¿è¯æ›´æ–°çš„åŸå­æ€§ã€‚</li>
</ul>
<h4 data-id="heading-16">8. é˜²æ­¢è¯»å€¾æ–œï¼ˆG-singleï¼‰ï¼šäº‹åŠ¡å†…æ•°æ®ä¸€è‡´æ€§</h4>
<ul>
<li>æµ‹è¯•åœºæ™¯ 1ï¼šT1 å¯åŠ¨åè¯»å–æ–‡æ¡£ 2ï¼ŒT2 æ›´æ–°æ–‡æ¡£ 1 å’Œ 2 å¹¶æäº¤ï¼ŒT1 å†æ¬¡è¯»å–æ–‡æ¡£ 2ï¼›</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®ï¼ˆåŒä¸Šï¼Œç•¥ï¼‰</span>

<span class="hljs-comment">// äº‹åŠ¡T1</span>
<span class="hljs-keyword">const</span> session1 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T1</span> = session1.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session1.<span class="hljs-title function_">startTransaction</span>({

  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// äº‹åŠ¡T2</span>
<span class="hljs-keyword">const</span> session2 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T2</span> = session2.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session2.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// T1è¯»å–æ–‡æ¡£1å’Œ2</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span> }); 
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[ { _id: 1, value: 10 } ]</span>
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">2</span> }); 
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[ { _id: 2, value: 20 } ]</span>

<span class="hljs-comment">// T2æ›´æ–°ä¸¤ä¸ªæ–‡æ¡£å¹¶æäº¤</span>
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">12</span> } });
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">2</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">18</span> } });
session2.<span class="hljs-title function_">commitTransaction</span>();

<span class="hljs-comment">// T1å†æ¬¡è¯»å–æ–‡æ¡£2ï¼Œç»“æœä¸å˜</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">2</span> }); 
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[ { _id: 2, value: 20 } ]</span>

session1.<span class="hljs-title function_">commitTransaction</span>();
</code></pre>
<ul>
<li>æµ‹è¯•åœºæ™¯ 2ï¼šT1 æŸ¥è¯¢åŒ¹é…æ¡ä»¶çš„æ–‡æ¡£ï¼ŒT2 æ›´æ–°æ–‡æ¡£ä½¿å…¶æ»¡è¶³æ–°æ¡ä»¶å¹¶æäº¤ï¼ŒT1 å†æ¬¡æŸ¥è¯¢ï¼›</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®ï¼ˆåŒä¸Šï¼Œç•¥ï¼‰</span>

<span class="hljs-comment">// äº‹åŠ¡T1</span>
<span class="hljs-keyword">const</span> session1 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T1</span> = session1.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session1.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// äº‹åŠ¡T2</span>
<span class="hljs-keyword">const</span> session2 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T2</span> = session2.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session2.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// T1æŸ¥è¯¢valueèƒ½è¢«5æ•´é™¤çš„æ–‡æ¡£</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">findOne</span>({ <span class="hljs-attr">value</span>: { <span class="hljs-attr">$mod</span>: [<span class="hljs-number">5</span>, <span class="hljs-number">0</span>] } }); 
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š{ _id: 1, value: 10 }</span>

<span class="hljs-comment">// T2æ›´æ–°æ–‡æ¡£1ä½¿å…¶èƒ½è¢«3æ•´é™¤å¹¶æäº¤</span>
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">value</span>: <span class="hljs-number">10</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">12</span> } });
session2.<span class="hljs-title function_">commitTransaction</span>();

<span class="hljs-comment">// T1æŸ¥è¯¢valueèƒ½è¢«3æ•´é™¤çš„æ–‡æ¡£ï¼Œæ— ç»“æœ</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">value</span>: { <span class="hljs-attr">$mod</span>: [<span class="hljs-number">3</span>, <span class="hljs-number">0</span>] } }).<span class="hljs-title function_">toArray</span>(); 
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[]</span>

session1.<span class="hljs-title function_">commitTransaction</span>();
</code></pre>
<ul>
<li>æµ‹è¯•åœºæ™¯ 3ï¼šT2 æ›´æ–°æ–‡æ¡£åæäº¤ï¼ŒT1 åˆ é™¤åŒ¹é…æ—§å€¼çš„æ–‡æ¡£ï¼Œè§¦å‘å†²çªï¼›</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®ï¼ˆåŒä¸Šï¼Œç•¥ï¼‰</span>

<span class="hljs-comment">// äº‹åŠ¡T1</span>
<span class="hljs-keyword">const</span> session1 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T1</span> = session1.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session1.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// äº‹åŠ¡T2</span>
<span class="hljs-keyword">const</span> session2 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T2</span> = session2.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session2.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// T1è¯»å–æ–‡æ¡£1</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span> }); 
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[ { _id: 1, value: 10 } ]</span>

<span class="hljs-comment">// T2æ›´æ–°ä¸¤ä¸ªæ–‡æ¡£å¹¶æäº¤</span>
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">12</span> } });
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">2</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">18</span> } });
session2.<span class="hljs-title function_">commitTransaction</span>();

<span class="hljs-comment">// T1åˆ é™¤value=20çš„æ–‡æ¡£ï¼Œè§¦å‘å†²çª</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">deleteMany</span>({ <span class="hljs-attr">value</span>: <span class="hljs-number">20</span> });

<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼šæŠ›å‡ºå†™å†²çªé”™è¯¯</span>
<span class="hljs-comment">// MongoServerError[WriteConflict]: Caused by :: Write conflict during plan execution and yielding is disabled. :: Please retry your operation or multi-document transaction.</span>
</code></pre>
<ul>
<li>å¯¹æ¯” SQLï¼šSQL çš„â€œè¯»å·²æäº¤â€çº§åˆ«å¯èƒ½å‡ºç°â€œè¯»å€¾æ–œâ€ï¼Œå³åŒä¸€äº‹åŠ¡å†…ä¸¤æ¬¡è¯»å–åŒä¸€æ–‡æ¡£å¾—åˆ°ä¸åŒç»“æœï¼Œè€Œ MongoDB çš„å¿«ç…§éš”ç¦»å®Œå…¨è§„é¿äº†è¿™ä¸€é—®é¢˜ã€‚</li>
</ul>
<h3 data-id="heading-17">å››ã€éœ€è¦åº”ç”¨å±‚å¤„ç†çš„äº‹åŠ¡å¼‚å¸¸</h3>
<p>MongoDB çš„å¿«ç…§éš”ç¦»å¹¶éä¸‡èƒ½ï¼Œä»¥ä¸‹ä¸¤ç§å¼‚å¸¸æ— æ³•é€šè¿‡æ•°æ®åº“å±‚é¢è‡ªåŠ¨é˜²æ­¢ï¼Œéœ€è¦åº”ç”¨å±‚ä»‹å…¥å¤„ç†ï¼š</p>
<h4 data-id="heading-18">1. å†™å€¾æ–œï¼ˆG2-itemï¼‰ï¼šè¯»ä¾èµ–å¯¼è‡´çš„é€»è¾‘å†²çª</h4>
<ul>
<li>åœºæ™¯ï¼šä¸¤ä¸ªäº‹åŠ¡åŒæ—¶è¯»å–åŒä¸€æ‰¹æ–‡æ¡£ï¼ŒåŸºäºè¯»å–ç»“æœæ‰§è¡Œæ›´æ–°ï¼Œæ›´æ–°åçš„æ•°æ®å¯èƒ½è¿åä¸šåŠ¡è§„åˆ™ï¼ˆå¦‚ä¸¤ä¸ªäº‹åŠ¡å‡åˆ¤æ–­â€œåº“å­˜å……è¶³â€å¹¶æ‰£å‡ï¼Œæœ€ç»ˆå¯¼è‡´åº“å­˜ä¸ºè´Ÿï¼‰ï¼›</li>
<li>MongoDB æµ‹è¯•ä»£ç ï¼š</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®ï¼ˆåŒä¸Šï¼Œç•¥ï¼‰</span>

<span class="hljs-comment">// äº‹åŠ¡T1</span>
<span class="hljs-keyword">const</span> session1 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T1</span> = session1.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session1.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"majority"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// äº‹åŠ¡T2</span>
<span class="hljs-keyword">const</span> session2 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T2</span> = session2.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session2.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"snapshot"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// ä¸¤ä¸ªäº‹åŠ¡å‡è¯»å–æ–‡æ¡£1å’Œ2</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">_id</span>: { <span class="hljs-attr">$in</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>] } });
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[ { _id: 1, value: 10 }, { _id: 2, value: 20 } ]</span>
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">_id</span>: { <span class="hljs-attr">$in</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>] } });
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[ { _id: 1, value: 10 }, { _id: 2, value: 20 } ]</span>

<span class="hljs-comment">// ä¸¤ä¸ªäº‹åŠ¡åˆ†åˆ«æ›´æ–°æ–‡æ¡£</span>
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">11</span> } });
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">2</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">21</span> } });

<span class="hljs-comment">// ä¸¤ä¸ªäº‹åŠ¡å‡æäº¤æˆåŠŸï¼Œæœªè§¦å‘å†²çª</span>
session1.<span class="hljs-title function_">commitTransaction</span>();
session2.<span class="hljs-title function_">commitTransaction</span>();
</code></pre>
<ul>
<li>åŸå› ï¼šMongoDB ä¸ä¼šåœ¨è¯»å–æ—¶åŠ é”ï¼Œä¹Ÿæ— æ³•æ„ŸçŸ¥â€œåŸºäºè¯»å–ç»“æœçš„å†™ä¾èµ–â€ï¼›</li>
<li>è§£å†³æ–¹æ¡ˆï¼šåº”ç”¨å±‚å¯é€šè¿‡â€œæ›´æ–°è¯»é›†æ–‡æ¡£â€çš„æ–¹å¼ï¼Œå°†è¯»ä¾èµ–è½¬åŒ–ä¸ºå†™å†²çªï¼ˆå¦‚è¯»å–æ–‡æ¡£æ—¶æ›´æ–°ä¸€ä¸ªâ€œç‰ˆæœ¬å·â€å­—æ®µï¼‰ï¼Œè¿«ä½¿å†²çªäº‹åŠ¡å¤±è´¥é‡è¯•ã€‚</li>
</ul>
<h4 data-id="heading-19">2. åä¾èµ–å¾ªç¯ï¼ˆG2ï¼‰ï¼šè·¨äº‹åŠ¡è¯»å†™ä¾èµ–å†²çª</h4>
<ul>
<li>åœºæ™¯ï¼šä¸¤ä¸ªäº‹åŠ¡å‡åŸºäºå¯¹æ–¹å·²æ›´æ–°çš„æ–‡æ¡£æ‰§è¡Œå†™æ“ä½œï¼Œå¯¼è‡´æœ€ç»ˆç»“æœè¿åé¢„æœŸï¼›</li>
<li>MongoDB æµ‹è¯•ä»£ç ï¼š</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®ï¼ˆåŒä¸Šï¼Œç•¥ï¼‰</span>

<span class="hljs-comment">// äº‹åŠ¡T1</span>
<span class="hljs-keyword">const</span> session1 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T1</span> = session1.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session1.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"snapshot"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// äº‹åŠ¡T2</span>
<span class="hljs-keyword">const</span> session2 = db.<span class="hljs-title function_">getMongo</span>().<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">T2</span> = session2.<span class="hljs-title function_">getDatabase</span>(<span class="hljs-string">"test_db"</span>);
session2.<span class="hljs-title function_">startTransaction</span>({
  <span class="hljs-attr">readConcern</span>: { <span class="hljs-attr">level</span>: <span class="hljs-string">"snapshot"</span> },
  <span class="hljs-attr">writeConcern</span>: { <span class="hljs-attr">w</span>: <span class="hljs-string">"majority"</span> }
});

<span class="hljs-comment">// ä¸¤ä¸ªäº‹åŠ¡å‡æŸ¥è¯¢valueèƒ½è¢«3æ•´é™¤çš„æ–‡æ¡£ï¼Œæ— ç»“æœ</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">value</span>: { <span class="hljs-attr">$mod</span>: [<span class="hljs-number">3</span>, <span class="hljs-number">0</span>] } }).<span class="hljs-title function_">toArray</span>(); 
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[]</span>
<span class="hljs-variable constant_">T2</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">value</span>: { <span class="hljs-attr">$mod</span>: [<span class="hljs-number">3</span>, <span class="hljs-number">0</span>] } }).<span class="hljs-title function_">toArray</span>(); 
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[]</span>

<span class="hljs-comment">// T1æ’å…¥ä¸¤ä¸ªèƒ½è¢«3æ•´é™¤çš„æ–‡æ¡£å¹¶æäº¤</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">insertOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">30</span> });
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">insertOne</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">42</span> });
session1.<span class="hljs-title function_">commitTransaction</span>();

<span class="hljs-comment">// T2æäº¤ï¼ˆæ— æ›´æ–°æ“ä½œï¼‰</span>
session2.<span class="hljs-title function_">commitTransaction</span>();

<span class="hljs-comment">// æœ€ç»ˆæŸ¥è¯¢ï¼Œèƒ½çœ‹åˆ°T1æ’å…¥çš„æ–‡æ¡£</span>
<span class="hljs-variable constant_">T1</span>.<span class="hljs-property">test</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">value</span>: { <span class="hljs-attr">$mod</span>: [<span class="hljs-number">3</span>, <span class="hljs-number">0</span>] } }).<span class="hljs-title function_">toArray</span>();
<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼š[ { _id: 3, value: 30 }, { _id: 4, value: 42 } ]</span>
</code></pre>
<ul>
<li>åŸå› ï¼šMongoDB ä¸ä¼šåœ¨è¯»å†™æ“ä½œä¹‹é—´åŠ é”ï¼Œæ— æ³•æ£€æµ‹æ­¤ç±»è·¨äº‹åŠ¡çš„è¯»ä¾èµ–å†²çªï¼›</li>
<li>è§£å†³æ–¹æ¡ˆï¼šè‹¥äº‹åŠ¡çš„å†™æ“ä½œä¾èµ–äºä¹‹å‰çš„è¯»å–ç»“æœï¼Œåº”ç”¨å±‚éœ€æ˜¾å¼æ›´æ–°è¯»å–è¿‡çš„æ–‡æ¡£ï¼ˆå¦‚æ·»åŠ â€œå·²å¤„ç†â€æ ‡è®°ï¼‰ï¼Œè§¦å‘ MongoDB çš„å†™å†²çªæ£€æµ‹ï¼Œé¿å…å¼‚å¸¸ã€‚</li>
</ul>
<h3 data-id="heading-20">äº”ã€æ€»ç»“ï¼šMongoDB äº‹åŠ¡éš”ç¦»çº§åˆ«æ€ä¹ˆç”¨ï¼Ÿ</h3>
<ol>
<li>æ ¸å¿ƒé€‰å‹ï¼šå•åˆ†ç‰‡åœºæ™¯ç”¨<code>readConcern: majority</code>å³å¯æ»¡è¶³å¤§éƒ¨åˆ†éœ€æ±‚ï¼Œå¤šåˆ†ç‰‡åœºæ™¯éœ€ç”¨<code>snapshot</code>ä¿è¯è·¨åˆ†ç‰‡ä¸€è‡´æ€§ï¼›</li>
<li>å†²çªå¤„ç†ï¼šæ˜¾å¼å¤šæ–‡æ¡£äº‹åŠ¡é‡‡ç”¨â€œå†²çªå³å¤±è´¥â€ï¼Œåº”ç”¨éœ€å®ç°é‡è¯•é€»è¾‘ï¼ˆç®€å•åœºæ™¯å¯ç›´æ¥é‡è¯•ï¼Œå¤æ‚åœºæ™¯éœ€å¤„ç†å¹‚ç­‰æ€§ï¼‰ï¼›</li>
<li>æ‰“ç ´è¯¯è§£ï¼šMongoDB çš„å¤šæ–‡æ¡£äº‹åŠ¡æ—©å·²å…·å¤‡ç”Ÿäº§çº§ç¨³å®šæ€§ï¼Œå…¶éš”ç¦»èƒ½åŠ›ä¸é€Šè‰²äºä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“ï¼Œæ— éœ€å†è¢«â€œNoSQL äº‹åŠ¡ä¸é è°±â€çš„è€è§‚å¿µæŸç¼šï¼›</li>
<li>æ€§èƒ½å¹³è¡¡ï¼šé€šè¿‡ MVCC å’Œâ€œå†²çªå³å¤±è´¥â€æœºåˆ¶ï¼ŒMongoDB åœ¨ä¿è¯ä¸€è‡´æ€§çš„åŒæ—¶ï¼Œé¿å…äº†è¯»é”å¸¦æ¥çš„æ‰©å±•æ€§é—®é¢˜ï¼Œé€‚åˆé«˜å¹¶å‘åœºæ™¯ã€‚</li>
</ol>
<p>å¦‚æœä½ çš„ä¸šåŠ¡éœ€è¦ä½¿ç”¨ MongoDB çš„å¤šæ–‡æ¡£äº‹åŠ¡ï¼Œä¸å¦¨ç›´æ¥å¤åˆ¶æœ¬æ–‡çš„æµ‹è¯•ä»£ç è¿›è¡ŒéªŒè¯ï¼Œç»“åˆè‡ªèº«ä¸šåŠ¡ç‰¹ç‚¹é€‰æ‹©åˆé€‚çš„è¯»å…³æ³¨çº§åˆ«ï¼ŒåŒæ—¶åœ¨åº”ç”¨å±‚å¤„ç†å¥½å†™å€¾æ–œå’Œåä¾èµ–å¾ªç¯é—®é¢˜ï¼Œå³å¯å……åˆ†å‘æŒ¥å…¶é«˜å¹¶å‘+å¼ºä¸€è‡´æ€§çš„ä¼˜åŠ¿ï½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±åº¦è§£æï¼šè§£å†³ backdrop-filter ä¸ border-radius çš„åœ†è§’æ¼å…‰é—®é¢˜]]></title>    <link>https://juejin.cn/post/7570646659865985050</link>    <guid>https://juejin.cn/post/7570646659865985050</guid>    <pubDate>2025-11-10T06:52:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570646659865985050" data-draft-id="7570769486706458662" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±åº¦è§£æï¼šè§£å†³ backdrop-filter ä¸ border-radius çš„åœ†è§’æ¼å…‰é—®é¢˜"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,HTML"/> <meta itemprop="datePublished" content="2025-11-10T06:52:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="_å¿—å“¥_"/> <meta itemprop="url" content="https://juejin.cn/user/3474112476882071"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±åº¦è§£æï¼šè§£å†³ backdrop-filter ä¸ border-radius çš„åœ†è§’æ¼å…‰é—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3474112476882071/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    _å¿—å“¥_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T06:52:47.000Z" title="Mon Nov 10 2025 06:52:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å¼•è¨€</h3>
<p>åœ¨ç°ä»£Webå¼€å‘ä¸­ï¼Œ<code>backdrop-filter</code>Â å±æ€§ä¸ºåˆ›å»ºæ¯›ç»ç’ƒç­‰é«˜çº§è§†è§‰æ•ˆæœæä¾›äº†å¼ºå¤§çš„æ”¯æŒï¼Œæå¤§åœ°æå‡äº†ç”¨æˆ·ç•Œé¢çš„å±‚æ¬¡æ„Ÿå’Œç°ä»£æ„Ÿã€‚ç„¶è€Œï¼Œå½“æˆ‘ä»¬å°†å®ƒä¸Â <code>border-radius</code>Â ç»“åˆä½¿ç”¨æ—¶ï¼Œä¸€ä¸ªå¸¸è§çš„æ¸²æŸ“é—®é¢˜ä¾¿ä¼šæµ®ç°ï¼šåœ†è§’è¾¹ç¼˜å‡ºç°ä¸åº”æœ‰çš„â€œæ¼å…‰â€ç°è±¡ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨è¯¥é—®é¢˜çš„æ ¹æºï¼Œåˆ†æç°æœ‰è§£å†³æ–¹æ¡ˆçš„å±€é™æ€§ï¼Œå¹¶æœ€ç»ˆæä¾›ä¸€ä¸ªåŸºäº CSS Mask çš„ã€è¡Œä¹‹æœ‰æ•ˆçš„ç»ˆæè§£å†³æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-1">é—®é¢˜æ ¹æºï¼šæ¸²æŸ“å±‚çº§çš„å†²çª</h3>
<p>è¦ç†è§£â€œæ¼å…‰â€ç°è±¡ï¼Œæˆ‘ä»¬å¿…é¡»æ·±å…¥æµè§ˆå™¨çš„æ¸²æŸ“æœºåˆ¶ã€‚è¿™ä¸ªé—®é¢˜çš„æ ¸å¿ƒåœ¨äºÂ <code>backdrop-filter</code>Â å’ŒÂ <code>border-radius</code>Â åœ¨æ¸²æŸ“æµæ°´çº¿ä¸­çš„å·¥ä½œé¡ºåºå’Œæ–¹å¼å­˜åœ¨æ ¹æœ¬æ€§çš„å†²çªã€‚</p>
<ol>
<li>
<p><strong><code>backdrop-filter</code>Â çš„å·¥ä½œåŸç†</strong>ï¼š<br/>
<code>backdrop-filter</code>Â ä½œç”¨äºå…ƒç´ èƒŒåçš„æ‰€æœ‰å†…å®¹ã€‚å®ƒä¼šè·å–è¿™äº›å†…å®¹ï¼Œåº”ç”¨æŒ‡å®šçš„æ»¤é•œï¼ˆå¦‚Â <code>blur</code>ï¼‰ï¼Œç„¶åå°†ç»“æœç»˜åˆ¶åœ¨å½“å‰å…ƒç´ çš„èƒŒæ™¯åŒºåŸŸã€‚å…³é”®åœ¨äºï¼Œè¿™ä¸ªæ¨¡ç³Šæ•ˆæœçš„ç»˜åˆ¶æ˜¯åŸºäºå…ƒç´ çš„<strong>è¾¹ç•Œæ¡†</strong>ï¼Œå³ä¸€ä¸ªçŸ©å½¢åŒºåŸŸã€‚</p>
</li>
<li>
<p><strong>æ¨¡ç³Šæ•ˆæœçš„â€œæº¢å‡ºâ€</strong> ï¼š<br/>
æ¨¡ç³Šç®—æ³•çš„æœ¬è´¨æ˜¯åƒç´ å‘å‘¨å›´æ‰©æ•£ï¼Œè¿™ä¼šå¯¼è‡´æ¨¡ç³Šåçš„å›¾åƒå°ºå¯¸å¤§äºåŸå§‹å›¾åƒï¼Œå½¢æˆä¸€ä¸ªâ€œå…‰æ™•â€æˆ–â€œæº¢å‡ºâ€è¾¹ç¼˜ã€‚è¿™ä¸ªæº¢å‡ºéƒ¨åˆ†ä¼šè¶…å‡ºå…ƒç´ åŸå§‹çš„çŸ©å½¢è¾¹ç•Œã€‚</p>
</li>
<li>
<p><strong><code>border-radius</code>Â çš„å·¥ä½œåŸç†</strong>ï¼š<br/>
<code>border-radius</code>Â æ˜¯ä¸€ä¸ªè£å‰ªå±æ€§ã€‚å®ƒåœ¨å…ƒç´ çš„å†…å®¹ï¼ˆåŒ…æ‹¬èƒŒæ™¯ã€è¾¹æ¡†ç­‰ï¼‰è¢«ç»˜åˆ¶å®Œæˆåï¼Œå¯¹å…ƒç´ è‡ªèº«è¿›è¡Œå‡ ä½•è£å‰ªï¼Œä½¿å…¶å‘ˆç°åœ†è§’ã€‚</p>
</li>
<li>
<p><strong>æ¸²æŸ“å†²çªç‚¹</strong>ï¼š<br/>
æµè§ˆå™¨çš„æ¸²æŸ“æµç¨‹å†³å®šäº†Â <code>backdrop-filter</code>Â çš„æ¨¡ç³Šæ•ˆæœï¼ˆåŒ…æ‹¬å…¶æº¢å‡ºçš„å…‰æ™•ï¼‰ä¼šå…ˆè¢«å®Œæ•´åœ°ç»˜åˆ¶åœ¨ä¸€ä¸ªçŸ©å½¢åŒºåŸŸå†…ã€‚éšåï¼Œ<code>border-radius</code>Â æ‰å¯¹è¿™ä¸ªå…ƒç´ è¿›è¡Œè£å‰ªã€‚ç»“æœæ˜¯ï¼Œ<code>border-radius</code>Â åªèƒ½è£å‰ªå…ƒç´ æœ¬èº«çš„å†…å®¹ï¼Œå´æ— æ³•è£å‰ªé‚£ä¸ªå·²ç»ç»˜åˆ¶å®Œæˆã€å¹¶æº¢å‡ºåˆ°åœ†è§’ä¹‹å¤–çš„æ¨¡ç³Šå…‰æ™•ã€‚è¿™ä¾¿å¯¼è‡´äº†æˆ‘ä»¬è§‚å¯Ÿåˆ°çš„â€œæ¼å…‰â€ç°è±¡ã€‚</p>
<p>å¯ä»¥å°†å…¶ç±»æ¯”ä¸ºï¼šå…ˆåœ¨ä¸€å—æ–¹å½¢ç»ç’ƒä¸Šå–·æ¶‚äº†å¸¦æœ‰è¾¹ç¼˜æ‰©æ•£æ•ˆæœçš„æ²¹æ¼†ï¼Œç„¶åå†ç”¨åœ†å½¢æ¨¡å…·å»åˆ‡å‰²è¿™å—ç»ç’ƒã€‚æ²¹æ¼†çš„æ‰©æ•£è¾¹ç¼˜ä¾ç„¶ä¼šä»åœ†å½¢è½®å»“å¤–æ˜¾éœ²å‡ºæ¥ã€‚</p>
</li>
</ol>
<h3 data-id="heading-2">å¸¸è§è§£å†³æ–¹æ¡ˆåŠå…¶å±€é™æ€§</h3>
<p>é¢å¯¹æ­¤é—®é¢˜ï¼Œå¼€å‘è€…é€šå¸¸ä¼šå°è¯•ä¸€äº›æ ‡å‡†çš„è£å‰ªæ–¹æ³•ï¼Œä½†å¾€å¾€æ”¶æ•ˆç”šå¾®ã€‚</p>
<p><strong>å°è¯•æ–¹æ¡ˆï¼šä½¿ç”¨Â <code>clip-path</code></strong></p>
<p>ä¸€ä¸ªç›´è§‚çš„æ€è·¯æ˜¯ä½¿ç”¨åŠŸèƒ½æ›´å¼ºå¤§çš„Â <code>clip-path</code>Â å±æ€§è¿›è¡Œè£å‰ªã€‚</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-attribute">clip-path</span>: <span class="hljs-built_in">inset</span>(<span class="hljs-number">0</span> round <span class="hljs-number">12px</span>);
</code></pre>
<p>ç„¶è€Œï¼Œæ­¤æ–¹æ¡ˆåŒæ ·æ— æ³•è§£å†³é—®é¢˜ã€‚å…¶æ ¹æœ¬åŸå› ä¸Â <code>border-radius</code>Â ç±»ä¼¼ï¼š<code>clip-path</code>Â ä¹Ÿåœ¨å†…å®¹ç»˜åˆ¶ä¹‹åç”Ÿæ•ˆï¼Œå®ƒæ— æ³•å½±å“å·²ç»â€œæº¢å‡ºâ€åˆ°å…ƒç´ è¾¹ç•Œä¹‹å¤–çš„æ¨¡ç³Šå…‰æ™•ã€‚å› æ­¤ï¼Œå®ƒå’ŒÂ <code>border-radius</code>Â åœ¨è¿™ä¸ªç‰¹å®šåœºæ™¯ä¸‹éƒ½é¢ä¸´ç€ç›¸åŒçš„æ¸²æŸ“é¡ºåºé™åˆ¶ã€‚</p>
<h3 data-id="heading-3">ç»ˆæè§£å†³æ–¹æ¡ˆï¼šåˆ©ç”¨ CSS Mask è¿›è¡Œé¢„è£å‰ª</h3>
<p>æ—¢ç„¶äº‹åè£å‰ªæ— æ•ˆï¼Œæˆ‘ä»¬éœ€è¦æ¢ä¸€ç§æ€è·¯ï¼š<strong>åœ¨å†…å®¹ç»˜åˆ¶ä¹‹å‰å°±çº¦æŸå…¶ç»˜åˆ¶åŒºåŸŸ</strong>ã€‚è¿™æ­£æ˜¯ CSSÂ <code>mask</code>Â å±æ€§çš„æ ¸å¿ƒèƒ½åŠ›ã€‚<code>mask</code>Â ä¸ä¼šåœ¨å†…å®¹ç»˜åˆ¶åè¿›è¡Œè£å‰ªï¼Œè€Œæ˜¯ä½œä¸ºä¸€ä¸ªè’™ç‰ˆï¼Œåªæœ‰è’™ç‰ˆä¸é€æ˜çš„åŒºåŸŸæ‰ä¼šè¢«ç»˜åˆ¶å†…å®¹ã€‚</p>
<p>é€šè¿‡Â <code>mask-image</code>ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªä¸æœŸæœ›åœ†è§’å®Œå…¨ä¸€è‡´çš„è’™ç‰ˆï¼Œä»æ ¹æœ¬ä¸Šæœç»æ¨¡ç³Šæ•ˆæœæº¢å‡ºçš„å¯èƒ½ã€‚</p>
<p><strong>æ ¸å¿ƒå®ç°ä»£ç ï¼š</strong></p>
<p>è¯¥æ–¹æ¡ˆåº”åº”ç”¨äºÂ <code>video</code>Â å…ƒç´ çš„<strong>å¤–å±‚å®¹å™¨</strong>ã€‚</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.video-container</span> {
  <span class="hljs-comment">/* ... å…¶ä»–å¸ƒå±€æ ·å¼ ... */</span>

  <span class="hljs-comment">/* æ ¸å¿ƒè§£å†³æ–¹æ¡ˆï¼šåº”ç”¨å¾„å‘æ¸å˜è’™ç‰ˆ */</span>
  -webkit-<span class="hljs-attribute">mask-image</span>: <span class="hljs-built_in">-webkit-radial-gradient</span>(white, black);
  <span class="hljs-attribute">mask-image</span>: <span class="hljs-built_in">radial-gradient</span>(white, black);

  <span class="hljs-comment">/* å…³é”®ä¼˜åŒ–ï¼šè§¦å‘ç¡¬ä»¶åŠ é€Ÿï¼Œç¡®ä¿è’™ç‰ˆæ•ˆæœç¨³å®š */</span>
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateZ</span>(<span class="hljs-number">0</span>);
}
</code></pre>
<p><strong>åŸç†è§£æï¼š</strong></p>
<ol>
<li><strong><code>mask-image: radial-gradient(white, black);</code></strong><br/>
æˆ‘ä»¬ä½¿ç”¨Â <code>radial-gradient</code>Â åˆ›å»ºäº†ä¸€ä¸ªä»ä¸­å¿ƒç™½è‰²åˆ°è¾¹ç¼˜é»‘è‰²çš„å¾„å‘æ¸å˜ä½œä¸ºè’™ç‰ˆã€‚åœ¨ CSS Mask ä¸­ï¼Œæ¸å˜çš„é€æ˜åº¦å†³å®šäº†å†…å®¹çš„å¯è§æ€§ï¼š<strong>ç™½è‰²ï¼ˆä¸é€æ˜ï¼‰éƒ¨åˆ†æ˜¾ç¤ºå†…å®¹ï¼Œé»‘è‰²ï¼ˆå®Œå…¨é€æ˜ï¼‰éƒ¨åˆ†éšè—å†…å®¹</strong>ã€‚è¿™ä¸ªåœ†å½¢è’™ç‰ˆå¼ºåˆ¶æµè§ˆå™¨åªåœ¨åœ†è§’åŒºåŸŸå†…æ¸²æŸ“æ‰€æœ‰å­å…ƒç´ å’Œæ•ˆæœï¼ŒåŒ…æ‹¬Â <code>backdrop-filter</code>Â äº§ç”Ÿçš„æ¨¡ç³Šã€‚ä»»ä½•è¯•å›¾æº¢å‡ºåˆ°è’™ç‰ˆä¹‹å¤–çš„å…‰æ™•éƒ½ä¼šè¢«ç›´æ¥éšè—ï¼Œä»è€Œåœ¨æ ¹æºä¸Šè§£å†³äº†æ¼å…‰é—®é¢˜ã€‚</li>
<li><strong><code>transform: translateZ(0);</code></strong><br/>
è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„æ€§èƒ½å’Œç¨³å®šæ€§ä¼˜åŒ–ã€‚è¯¥å±æ€§ä¼šè§¦å‘å…ƒç´ çš„ç¡¬ä»¶åŠ é€Ÿï¼Œå°†å…¶æå‡åˆ°ä¸€ä¸ªç‹¬ç«‹çš„æ¸²æŸ“å±‚ã€‚è¿™å¯ä»¥ç¡®ä¿Â <code>mask</code>Â çš„æ•ˆæœè¢« GPU æ­£ç¡®ã€é«˜æ•ˆåœ°åˆæˆï¼Œé¿å…åœ¨æŸäº›å¤æ‚å¸ƒå±€æˆ–æµè§ˆå™¨ä¸­å¯èƒ½å‡ºç°çš„æ¸²æŸ“é”™ä½æˆ–å¤±æ•ˆé—®é¢˜ï¼Œä¿è¯äº†æ–¹æ¡ˆçš„å¥å£®æ€§ã€‚</li>
</ol>
<h4 data-id="heading-4">å®Œæ•´ä»£ç ç¤ºä¾‹</h4>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„ã€å¯ç›´æ¥ä½¿ç”¨çš„ä»£ç ç»“æ„ï¼Œæ¸…æ™°åœ°å±•ç¤ºäº†å¦‚ä½•åº”ç”¨æ­¤æ–¹æ¡ˆã€‚å¤åˆ¶ä»£ç åˆ°æœ¬åœ°ï¼Œæ›¿æ¢videoçš„urlå°±è¡Œï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>åœ†è§’è§†é¢‘æ’­æ”¾å™¨<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
    <span class="hljs-selector-tag">body</span> {
      <span class="hljs-attribute">display</span>: flex;
      <span class="hljs-attribute">justify-content</span>: center;
      <span class="hljs-attribute">align-items</span>: center;
      <span class="hljs-attribute">min-height</span>: <span class="hljs-number">100vh</span>;
      <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#000</span>;
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
      <span class="hljs-attribute">font-family</span>: -apple-system, BlinkMacSystemFont, <span class="hljs-string">'Segoe UI'</span>, Roboto, <span class="hljs-string">'Helvetica Neue'</span>, Arial, sans-serif;
    }

    <span class="hljs-selector-class">.video-player-wrapper</span> {
      <span class="hljs-attribute">position</span>: relative;
      <span class="hljs-attribute">width</span>: <span class="hljs-number">800px</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">450px</span>;
      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">12px</span>;
      <span class="hljs-attribute">overflow</span>: hidden;
      <span class="hljs-attribute">clip-path</span>: <span class="hljs-built_in">inset</span>(<span class="hljs-number">0</span> round <span class="hljs-number">12px</span>);
      <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#000</span>;
      <span class="hljs-comment">/* å¼ºåˆ¶åˆ›å»ºåˆæˆå±‚å¹¶å°è¯•è®©åœ†è§’ç”Ÿæ•ˆï¼ˆå…¼å®¹æ€§å¢å¼ºï¼‰ */</span>
      -webkit-<span class="hljs-attribute">mask-image</span>: <span class="hljs-built_in">-webkit-radial-gradient</span>(white, black);
      <span class="hljs-attribute">mask-image</span>: <span class="hljs-built_in">radial-gradient</span>(white, black);
      <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateZ</span>(<span class="hljs-number">0</span>);
    }

    <span class="hljs-selector-class">.video-player-wrapper</span> <span class="hljs-selector-tag">video</span><span class="hljs-selector-class">.video-element</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
      <span class="hljs-attribute">object-fit</span>: cover;
      <span class="hljs-attribute">display</span>: block;
    }

    <span class="hljs-selector-class">.video-title</span> {
      <span class="hljs-attribute">position</span>: absolute;
      <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
      <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
      <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">28px</span>;
      <span class="hljs-attribute">color</span>: white;
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
      <span class="hljs-attribute">line-height</span>: <span class="hljs-number">28px</span>;
      <span class="hljs-attribute">padding-left</span>: <span class="hljs-number">12px</span>;
      <span class="hljs-attribute">box-sizing</span>: border-box;
      <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.5</span>);
      -webkit-backdrop-<span class="hljs-attribute">filter</span>: <span class="hljs-built_in">blur</span>(<span class="hljs-number">20px</span>);
      backdrop-<span class="hljs-attribute">filter</span>: <span class="hljs-built_in">blur</span>(<span class="hljs-number">20px</span>);
      <span class="hljs-attribute">overflow</span>: hidden;
    }
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"video-player-wrapper"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">video</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"video-element"</span> <span class="hljs-attr">controls</span> <span class="hljs-attr">autoplay</span> <span class="hljs-attr">muted</span> <span class="hljs-attr">loop</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"xxx.mp4"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">video</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"video-title"</span>&gt;</span>
      æˆ‘æ˜¯videoæ ‡é¢˜
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h3 data-id="heading-5">ç»“æ¡ˆé™ˆè¯</h3>
<p>çœ‹ï¼Œå†é¡½å›ºçš„æ¸²æŸ“BUGï¼Œä¹Ÿæ•Œä¸è¿‡æˆ‘ä»¬å¯¹åº•å±‚åŸç†çš„ç†è§£å’Œä¸€ç‚¹ç‚¹â€œéªšæ“ä½œâ€çš„æ™ºæ…§ã€‚ä»ç†è§£æ¸²æŸ“é¡ºåºçš„â€œå…ˆæ–©åå¥â€ï¼Œåˆ°æ”¾å¼ƒæ— æ•ˆçš„Â <code>clip-path</code>ï¼Œæœ€åç”¨Â <code>mask-image</code>Â å®ç°é™ç»´æ‰“å‡»ï¼Œæ•´ä¸ªè¿‡ç¨‹å°±åƒä¸€åœºç²¾å½©çš„ä¾¦æ¢æ¨ç†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[100% ç”¨ AI åšå®Œä¸€ä¸ªæ–°é¡¹ç›®ï¼Œä» Plan åˆ° Finished æˆ‘å­¦åˆ°äº†è¿™äº›]]></title>    <link>https://juejin.cn/post/7570579125153923082</link>    <guid>https://juejin.cn/post/7570579125153923082</guid>    <pubDate>2025-11-10T05:41:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570579125153923082" data-draft-id="7569945160869396526" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="100% ç”¨ AI åšå®Œä¸€ä¸ªæ–°é¡¹ç›®ï¼Œä» Plan åˆ° Finished æˆ‘å­¦åˆ°äº†è¿™äº›"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯"/> <meta itemprop="datePublished" content="2025-11-10T05:41:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Immerse"/> <meta itemprop="url" content="https://juejin.cn/user/2708812817761752"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            100% ç”¨ AI åšå®Œä¸€ä¸ªæ–°é¡¹ç›®ï¼Œä» Plan åˆ° Finished æˆ‘å­¦åˆ°äº†è¿™äº›
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2708812817761752/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Immerse
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T05:41:17.000Z" title="Mon Nov 10 2025 05:41:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ Immerseï¼Œä¸€åç‹¬ç«‹å¼€å‘è€…ã€å†…å®¹åˆ›ä½œè€…ã€AGI å®è·µè€…ã€‚</p>
<p>å…³æ³¨å…¬ä¼—å·ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fyaolifeng.com%2Fother%2Fwx_public_account.webp" target="_blank" title="https://yaolifeng.com/other/wx_public_account.webp" ref="nofollow noopener noreferrer">æ²‰æµ¸å¼è¶£è°ˆ</a>ï¼Œè·å–æœ€æ–°æ–‡ç« ï¼ˆæ›´å¤šå†…å®¹åªåœ¨å…¬ä¼—å·æ›´æ–°ï¼‰</p>
<p>ä¸ªäººç½‘ç«™ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fyaolifeng.com" target="_blank" title="https://yaolifeng.com" ref="nofollow noopener noreferrer">yaolifeng.com</a> ä¹ŸåŒæ­¥æ›´æ–°ã€‚</p>
<p>è½¬è½½è¯·åœ¨æ–‡ç« å¼€å¤´æ³¨æ˜å‡ºå¤„å’Œç‰ˆæƒä¿¡æ¯ã€‚</p>
<p>æˆ‘ä¼šåœ¨è¿™é‡Œåˆ†äº«å…³äº<code>ç¼–ç¨‹</code>ã€<code>ç‹¬ç«‹å¼€å‘</code>ã€<code>AIå¹²è´§</code>ã€<code>å¼€æº</code>ã€<code>ä¸ªäººæ€è€ƒ</code>ç­‰å†…å®¹ã€‚</p>
<p>å¦‚æœæœ¬æ–‡å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œæ¬¢è¿åŠ¨åŠ¨å°æ‰‹æŒ‡ä¸€é”®ä¸‰è¿(<code>ç‚¹èµ</code>ã€<code>è¯„è®º</code>ã€<code>è½¬å‘</code>)ï¼Œç»™æˆ‘ä¸€äº›æ”¯æŒå’Œé¼“åŠ±ï¼Œè°¢è°¢ï¼</p>
<hr/>
<p>å¥³æœ‹å‹ä¸€å¥è¯å‚¬ç”Ÿçš„ Chrome æ’ä»¶ï¼Œè§£å†³æ‰¹é‡ä¸‹è½½å›¾ç‰‡é—®é¢˜</p>
<p>å‘¨æœ«åœ¨å®¶ï¼Œå¥³æœ‹å‹å·¥ä½œéœ€è¦ä¸‹è½½ç½‘ç«™ä¸Šçš„ä¸€äº›å›¾ç‰‡ï¼Œå¥¹è¯´å¤ªéº»çƒ¦äº†ã€‚</p>
<p>å³é”®ã€é€‰æ‹©ä¿å­˜å›¾ç‰‡ã€é€‰æ–‡ä»¶å¤¹ã€æ”¹åå­—ï¼Œä¸€å¼ å›¾å°±å¾—æŠ˜è…¾å¥½å‡ æ­¥ã€‚</p>
<p>è¦æ˜¯ç½‘é¡µé‡Œæœ‰äºŒä¸‰åå¼ å›¾ï¼Œè¿™å¾—ç‚¹å¤šå°‘æ¬¡é¼ æ ‡ã€‚</p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/550b2e439f2c4a399982ae36ac02021e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSW1tZXJzZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763358077&amp;x-signature=byXdlOtH%2Fdx1m7xLnfxR3J1wqes%3D" width="300" loading="lazy"/>
<h2 data-id="heading-0">ä¸‹è½½åœ°å€ï¼š</h2>
<p>GitHub:<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fyaolifeng0629%2FPickPic" target="_blank" title="https://github.com/yaolifeng0629/PickPic" ref="nofollow noopener noreferrer"><code>https://github.com/yaolifeng0629/PickPic</code></a></p>
<p>è°·æ­Œæµè§ˆå™¨å•†åº—ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fchromewebstore.google.com%2Fdetail%2Fpickpic-one-click-downloa%2Fhfdohacifjijbgobekodafjpjghflemh" target="_blank" title="https://chromewebstore.google.com/detail/pickpic-one-click-downloa/hfdohacifjijbgobekodafjpjghflemh" ref="nofollow noopener noreferrer"><code>https://chromewebstore.google.com/detail/pickpic-one-click-downloa/hfdohacifjijbgobekodafjpjghflemh</code></a></p>
<p>å‹ç¼©åŒ…ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fyaolifeng0629%2FPickPic%2Freleases%2Ftag%2Fv1.0.2" target="_blank" title="https://github.com/yaolifeng0629/PickPic/releases/tag/v1.0.2" ref="nofollow noopener noreferrer"><code>https://github.com/yaolifeng0629/PickPic/releases/tag/v1.0.2</code></a></p>
<h2 data-id="heading-1">ä¸€ä¸ªå¾ˆç®€å•çš„éœ€æ±‚</h2>
<p>éœ€æ±‚å…¶å®å¾ˆæ˜ç¡®ã€‚</p>
<p>åœ¨ç½‘é¡µä¸Šçœ‹åˆ°å–œæ¬¢çš„å›¾ç‰‡ï¼Œæƒ³æ‰¹é‡ä¿å­˜åˆ°æœ¬åœ°ã€‚</p>
<p>å¬èµ·æ¥å¾ˆç®€å•å¯¹å§ï¼Ÿä½†æˆ‘æœäº†ä¸€åœˆï¼Œå‘ç°ç°æœ‰çš„å·¥å…·éƒ½ä¸å¤ªæ»¡æ„ã€‚</p>
<p>æœ‰äº›æ’ä»¶åŠŸèƒ½å€’æ˜¯æœ‰ï¼Œä½†è¦ä¹ˆå¤ªå¤æ‚ï¼Œè¦ä¹ˆå¹¿å‘Šä¸€å †ï¼Œè¦ä¹ˆå°±æ˜¯åªæ”¯æŒç‰¹å®šç½‘ç«™ã€‚</p>
<p>æˆ‘æƒ³è¦çš„å¾ˆç®€å•ï¼šæ‰“å¼€ç½‘é¡µï¼Œä¸€é”®é¢„è§ˆï¼Œé€‰æ‹©ä¸‹è½½ï¼Œå®Œäº‹ã€‚</p>
<p>æ‰€ä»¥å†³å®šè‡ªå·±åšä¸€ä¸ªã€‚</p>
<h2 data-id="heading-2">è¿™ä¸ªæ’ä»¶èƒ½å¹²å•¥</h2>
<p>æ ¸å¿ƒåŠŸèƒ½å°±å‡ ä¸ªã€‚</p>
<p>ç‚¹å‡»æµè§ˆå™¨å›¾æ ‡ï¼Œä¾§è¾¹æ ä¼šæ˜¾ç¤ºå½“å‰ç½‘é¡µçš„æ‰€æœ‰å›¾ç‰‡å’Œè§†é¢‘ã€‚</p>
<p>å¯ä»¥é¢„è§ˆï¼ŒåŒå‡»å›¾ç‰‡ä¼šåœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ï¼Œçœ‹å¾—æ›´æ¸…æ¥šã€‚</p>
<p>æƒ³ä¸‹è½½å“ªå¼ å°±å‹¾é€‰å“ªå¼ ï¼Œä¹Ÿå¯ä»¥å…¨é€‰ã€‚</p>
<p>å•å¼ å›¾ç›´æ¥ä¸‹è½½ï¼Œå¤šå¼ å›¾è‡ªåŠ¨æ‰“åŒ…æˆ ZIP æ–‡ä»¶ã€‚</p>
<p>å¯¹å¾®ä¿¡å…¬ä¼—å·åšäº†ç‰¹æ®Šä¼˜åŒ–ã€‚èƒ½çœ‹åˆ°æ–‡ç« æ ‡é¢˜ã€ä½œè€…ã€æè¿°è¿™äº›ä¿¡æ¯ã€‚</p>
<p>æ”¯æŒä¸­è‹±æ–‡åˆ‡æ¢ã€‚</p>
<p>å°±è¿™äº›ï¼Œæ²¡æœ‰å¤æ‚çš„è®¾ç½®ï¼Œæ‰“å¼€å°±èƒ½ç”¨ã€‚</p>
<h2 data-id="heading-3">å¼€å‘è¿‡ç¨‹è¿˜æŒºé¡º</h2>
<p>æŠ€æœ¯æ ˆç”¨çš„æ˜¯ Plasmo æ¡†æ¶ï¼Œè¿™ç©æ„ä¸“é—¨åšæµè§ˆå™¨æ’ä»¶çš„ã€‚</p>
<p>é…åˆ Reactã€TypeScriptã€Tailwind CSSï¼Œå¼€å‘ä½“éªŒå¾ˆä¸é”™ã€‚</p>
<p>çŠ¶æ€ç®¡ç†ç”¨ Zustandï¼Œè½»é‡å¥½ç”¨ã€‚</p>
<p>å›¾ç‰‡æ‰“åŒ…ç”¨ JSZipï¼Œç”Ÿæˆ ZIP æ–‡ä»¶å¾ˆå¿«ã€‚</p>
<h2 data-id="heading-4">æ”¯æŒçš„ç½‘ç«™æŒºå¤š</h2>
<p>é™¤äº†å¾®ä¿¡å…¬ä¼—å·ï¼Œå…¶ä»–ç½‘ç«™ä¹Ÿéƒ½èƒ½ç”¨ã€‚</p>
<p>æˆ‘æµ‹è¯•äº†æ˜é‡‘ã€çŸ¥ä¹ã€InfoQã€ç®€ä¹¦ã€CSDNã€åšå®¢å›­è¿™äº›æŠ€æœ¯ç¤¾åŒºï¼Œéƒ½æ²¡é—®é¢˜ã€‚</p>
<p>ç†è®ºä¸Šä»»ä½•ç½‘é¡µéƒ½èƒ½ç”¨ï¼Œå› ä¸ºæˆ‘åšçš„æ˜¯é€šç”¨æå–é€»è¾‘ã€‚åªè¦æ˜¯ img æ ‡ç­¾æˆ–è€… video æ ‡ç­¾ï¼Œéƒ½èƒ½è¯†åˆ«å‡ºæ¥ã€‚ï¼ˆæš‚æ—¶æ²¡æœ‰å¤„ç†é˜²çˆ¬é€»è¾‘ï¼‰</p>
<p>å¯¹å¾®ä¿¡å…¬ä¼—å·åšäº†é¢å¤–ä¼˜åŒ–ï¼Œå› ä¸ºè‡ªå·±å¹³æ—¶ä¹Ÿä¼šç”¨åˆ°ï¼Œæ‰€ä»¥å¤šèŠ±äº†ç‚¹å¿ƒæ€ã€‚</p>
<p>å…¶ä»–ç½‘ç«™æš‚æ—¶æ²¡åšç‰¹æ®Šå¤„ç†ï¼Œä½†åŸºæœ¬åŠŸèƒ½éƒ½æ˜¯æ­£å¸¸çš„ã€‚</p>
<h2 data-id="heading-5">ä¸ºå•¥åˆæ˜¯ä¸€ä¸ªå·¥å…·</h2>
<p>åšè¿™ä¸ªæ’ä»¶çš„æ—¶å€™ï¼Œæˆ‘æƒ³èµ·ä¹‹å‰çœ‹ Marc Lou çš„åˆ†äº«ã€‚</p>
<p>ä»–è¯´æœ€å¥½çš„äº§å“ï¼Œå¾€å¾€æ˜¯è§£å†³è‡ªå·±é—®é¢˜çš„äº§å“ã€‚</p>
<p>å› ä¸ºä½ å°±æ˜¯ç¬¬ä¸€ä¸ªç”¨æˆ·ï¼Œæœ€æ¸…æ¥šå“ªé‡Œå¥½ç”¨å“ªé‡Œä¸å¥½ç”¨ã€‚</p>
<p>ä¸éœ€è¦åšå¸‚åœºè°ƒç ”ï¼Œä¸éœ€è¦çŒœç”¨æˆ·æƒ³è¦ä»€ä¹ˆã€‚</p>
<p>ä½ è‡ªå·±ç”¨ç€èˆ’æœï¼Œäº§å“å°±ä¸ä¼šå¤ªå·®ã€‚</p>
<p>åšçš„è¿‡ç¨‹ä¸­æ²¡æƒ³è¿‡èƒ½ä¸èƒ½èµšé’±ï¼Œä¼šä¸ä¼šæœ‰å¾ˆå¤šäººç”¨ã€‚</p>
<p>å°±æ˜¯å•çº¯æƒ³è§£å†³è¿™ä¸ªç—’å¤„ã€‚</p>
<h2 data-id="heading-6">æ¥ä¸‹æ¥æƒ³åŠ ç‚¹å•¥</h2>
<p>ç›®å‰åŠŸèƒ½è¿˜æ¯”è¾ƒåŸºç¡€ï¼Œåé¢æƒ³åŠ ä¸€äº›æ–°ä¸œè¥¿ã€‚</p>
<p>æ¯”å¦‚æ‰¹é‡é‡å‘½åï¼ŒæŒ‰æ–‡ç« æ ‡é¢˜ã€æ—¥æœŸã€åºå·è¿™äº›è§„åˆ™è‡ªåŠ¨å‘½åæ–‡ä»¶ã€‚</p>
<p>åœ¨è€ƒè™‘æ”¯æŒæ›´å¤šæ ¼å¼ï¼Œä¸å…‰æ˜¯å›¾ç‰‡å’Œè§†é¢‘ï¼ŒPDFã€éŸ³é¢‘è¿™äº›ä¹Ÿèƒ½æå–ã€‚</p>
<p>ä¸è¿‡è¿™äº›éƒ½æ˜¯æƒ³æ³•ï¼Œä¼šä¸ä¼šåšã€ä»€ä¹ˆæ—¶å€™åšï¼Œè¿˜æ²¡ç¡®å®šã€‚</p>
<p>å…ˆæŠŠç›®å‰çš„é—®é¢˜è§£å†³äº†å†è¯´ã€‚</p>
<h2 data-id="heading-7">å¦‚ä½•ä½¿ç”¨</h2>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1585e810b32147d1914912475b88334a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSW1tZXJzZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763358077&amp;x-signature=vzLV%2FjeEgxKoqoxwr1DFwp8X5pE%3D" width="300" loading="lazy"/>
<p>GitHub:<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fyaolifeng0629%2FPickPic" target="_blank" title="https://github.com/yaolifeng0629/PickPic" ref="nofollow noopener noreferrer"><code>https://github.com/yaolifeng0629/PickPic</code></a></p>
<p>è°·æ­Œæµè§ˆå™¨å•†åº—ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fchromewebstore.google.com%2Fdetail%2Fpickpic-one-click-downloa%2Fhfdohacifjijbgobekodafjpjghflemh" target="_blank" title="https://chromewebstore.google.com/detail/pickpic-one-click-downloa/hfdohacifjijbgobekodafjpjghflemh" ref="nofollow noopener noreferrer"><code>https://chromewebstore.google.com/detail/pickpic-one-click-downloa/hfdohacifjijbgobekodafjpjghflemh</code></a></p>
<p>å‹ç¼©åŒ…ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fyaolifeng0629%2FPickPic%2Freleases%2Ftag%2Fv1.0.2" target="_blank" title="https://github.com/yaolifeng0629/PickPic/releases/tag/v1.0.2" ref="nofollow noopener noreferrer"><code>https://github.com/yaolifeng0629/PickPic/releases/tag/v1.0.2</code></a></p>
<p>æ¬¢è¿æ Issue å’Œ PRï¼Œæœ‰æƒ³æ³•å¯ä»¥ä¸€èµ·è®¨è®ºã€‚</p>
<p>ä¹Ÿæ¬¢è¿ Star æ”¯æŒä¸€ä¸‹ã€‚</p>
<p>é¡¹ç›®è¿˜åœ¨æ—©æœŸé˜¶æ®µï¼Œè‚¯å®šæœ‰ä¸å®Œå–„çš„åœ°æ–¹ã€‚</p>
<p>ä½†æˆ‘ä¼šæŒç»­ç»´æŠ¤ï¼Œé‡åˆ°é—®é¢˜ä¼šå°½å¿«ä¿®å¤ã€‚</p>
<h2 data-id="heading-8">å¼€å‘è¿‡ç¨‹å¼€æº</h2>
<p>å¯¹äº†ï¼Œè¿™ä¸ªé¡¹ç›®ä» Plan åˆ° Task å†åˆ° Implementï¼Œæ¯ä¸ªé˜¶æ®µæˆ‘éƒ½å¼€æºå‡ºæ¥äº†ã€‚</p>
<p>åŒ…æ‹¬æœ€åˆçš„æƒ³æ³•ã€ä»»åŠ¡æ‹†è§£ã€å…·ä½“å®ç°ï¼Œç”šè‡³åŸå‹è®¾è®¡éƒ½åœ¨ GitHub ä»“åº“é‡Œã€‚</p>
<p>æƒ³çœ‹å®Œæ•´å¼€å‘è¿‡ç¨‹çš„å°ä¼™ä¼´ï¼Œå¯ä»¥å»ä»“åº“ç¿»ä¸€ç¿»ã€‚</p>
<p>è¯´ä¸å®šèƒ½ç»™ä½ è‡ªå·±åšé¡¹ç›®æä¾›ç‚¹æ€è·¯ã€‚</p>
<p>é¡ºä¾¿ç‚¹ä¸ª Star æ”¯æŒä¸€ä¸‹ï¼Œæ„Ÿè°¢ï¼</p>
<h2 data-id="heading-9">ä¸€ç‚¹å°æ„Ÿæ‚Ÿ</h2>
<p>åšè¿™ä¸ªæ’ä»¶è®©æˆ‘æƒ³æ˜ç™½ä¸€ä»¶äº‹ã€‚</p>
<p>ä¸æ˜¯æ‰€æœ‰é¡¹ç›®éƒ½è¦è¿½æ±‚å•†ä¸šåŒ–ï¼Œä¸æ˜¯æ‰€æœ‰äº§å“éƒ½è¦æƒ³ç€èµšé’±ã€‚</p>
<p>æœ‰æ—¶å€™å°±æ˜¯æƒ³è§£å†³ä¸€ä¸ªå°é—®é¢˜ï¼Œè®©è‡ªå·±çš„ç”Ÿæ´»æ–¹ä¾¿ä¸€ç‚¹ã€‚</p>
<p>è¿™ä¸ªè¿‡ç¨‹æœ¬èº«å°±å¾ˆæœ‰æ„æ€ã€‚</p>
<p>è€Œä¸”ä½ çœŸå¿ƒè§£å†³äº†è‡ªå·±çš„é—®é¢˜ï¼Œäº§å“è‡ªç„¶ä¼šæœ‰æ¸©åº¦ã€‚</p>
<p>åˆ«äººç”¨èµ·æ¥ä¹Ÿèƒ½æ„Ÿå—åˆ°è¿™ç§çœŸå®ã€‚</p>
<p>Marc Lou è¯´å¥½å¥‡å¿ƒæ‰æ˜¯åˆ›ä¸šçš„èµ·ç‚¹ï¼Œæˆ‘è§‰å¾—è¯´å¾—ç‰¹åˆ«å¯¹ã€‚</p>
<p>å…ˆæŠŠç—’å¤„æŒ äº†ï¼Œè‡³äºèƒ½ä¸èƒ½å˜æˆç”Ÿæ„ï¼Œé‚£æ˜¯åé¢çš„äº‹ã€‚</p>
<hr/>
<p>é¡¹ç›®åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fyaolifeng0629%2FPickPic" target="_blank" title="https://github.com/yaolifeng0629/PickPic" ref="nofollow noopener noreferrer"><code>https://github.com/yaolifeng0629/PickPic</code></a></p>
<p>æ¬¢è¿è¯•ç”¨ï¼Œæ¬¢è¿åé¦ˆã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æœ¬å‘¨ 6 ä¸ªæœ€ç«ç«ç«ç« GitHub é¡¹ç›®ï¼ŒAI æ€ç–¯äº†ã€‚]]></title>    <link>https://juejin.cn/post/7570630923710267444</link>    <guid>https://juejin.cn/post/7570630923710267444</guid>    <pubDate>2025-11-10T05:46:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570630923710267444" data-draft-id="7570659828810170402" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æœ¬å‘¨ 6 ä¸ªæœ€ç«ç«ç«ç« GitHub é¡¹ç›®ï¼ŒAI æ€ç–¯äº†ã€‚"/> <meta itemprop="keywords" content="GitHub"/> <meta itemprop="datePublished" content="2025-11-10T05:46:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é€›é€›GitHub"/> <meta itemprop="url" content="https://juejin.cn/user/1442202996186093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æœ¬å‘¨ 6 ä¸ªæœ€ç«ç«ç«ç« GitHub é¡¹ç›®ï¼ŒAI æ€ç–¯äº†ã€‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1442202996186093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é€›é€›GitHub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T05:46:06.000Z" title="Mon Nov 10 2025 05:46:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">01ã€DeepCodeï¼šæ™ºèƒ½ä½“ç¼–ç¨‹å¹³å°</h2>
<p>DeepCode ç”±é¦™æ¸¯å¤§å­¦æ•°æ®æ™ºèƒ½å®éªŒå®¤å¼€å‘ï¼Œç°åœ¨æœ‰ 1 ä¸‡ Star äº†ã€‚</p>
<p>å®ƒé‡‡ç”¨å¤šæ™ºèƒ½ä½“ç³»ç»Ÿæ¶æ„ï¼Œèƒ½å¤Ÿç†è§£å¤æ‚éœ€æ±‚ï¼Œå¦‚ç ”ç©¶è®ºæ–‡æˆ–è‡ªç„¶è¯­è¨€æè¿°ï¼Œå¹¶é€šè¿‡æ™ºèƒ½ä½“åä½œè‡ªåŠ¨ç”Ÿæˆé«˜è´¨é‡çš„ã€å¯è¿è¡Œçš„ä»£ç ã€‚</p>
<p>æ¯”å¦‚ç”¨æˆ·ä¸Šä¼ ä¸€ç¯‡ ICML è®ºæ–‡ï¼ŒDeepCode èƒ½è‡ªåŠ¨è§£æå…¶ä¸­çš„ç®—æ³•ï¼Œç”Ÿæˆ Python å®ç°ï¼Œå¹¶é™„å¸¦æµ‹è¯•ç”¨ä¾‹å’Œæ–‡æ¡£ã€‚</p>
<p>å®ƒæœ‰ä¸€ä¸ª<strong>ç½‘é¡µç•Œé¢</strong>ï¼Œæ”¯æŒå¯è§†åŒ–äº¤äº’ä½“éªŒã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fcef5060fb7f4bafb047dcddd146a25e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763358366&amp;x-signature=t%2BGGjHCa7D6smTa3Vml9W66qs5o%3D" alt="image.png" loading="lazy"/></p>
<p>ä¹Ÿæœ‰ä¸€ä¸ª<strong>å‘½ä»¤è¡Œç•Œé¢</strong>ï¼Œå¯ä»¥åŸºäºç»ˆç«¯å¼€å‘ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab6f66bff61740548641a50865bf79f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763358366&amp;x-signature=Tr9HNNJYbe7JNK5j8mXha7UwZkc%3D" alt="image.png" loading="lazy"/></p>
<p>é™¤äº†å­¦æœ¯è®ºæ–‡ä¸­æå–ç®—æ³•å¹¶å®ç°ã€‚è¿˜æ”¯æŒÂ Text2WebÂ åŠŸèƒ½å¯ä»¥å°†æ–‡æœ¬æè¿°è½¬åŒ–ä¸ºå®Œæ•´å‰ç«¯ä»£ç ã€‚</p>
<p>Text2BackendÂ åŠŸèƒ½å¯ä»¥æ ¹æ®ç®€å•è¾“å…¥ç”Ÿæˆé«˜æ•ˆåç«¯ä»£ç ã€‚</p>
<p>é¡¹ç›®åœ¨ OpenAI çš„ PaperBench åŸºå‡†æµ‹è¯•ä¸­è¡¨ç°ä¼˜å¼‚ï¼Œç”šè‡³è¶…è¶Šäº†äººç±»ä¸“å®¶å’Œå•†ä¸šä»£ç ä»£ç†ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">å¼€æºåœ°å€ï¼šhttps:<span class="hljs-comment">//github.com/HKUDS/DeepCode</span>
</code></pre>
<h2 data-id="heading-1">02ã€Strixï¼šå¼€æº AI é»‘å®¢</h2>
<p>è¿™ä¸ªå¼€æºé¡¹ç›®å…¶å®æ˜¯ä¸€ä¸ªå®‰å…¨æµ‹è¯•æ¡†æ¶ï¼Œä½¿ç”¨ AI æ™ºèƒ½ä½“åƒçœŸå®é»‘å®¢ä¸€æ ·åŠ¨æ€åˆ†æåº”ç”¨æ¼æ´ã€‚</p>
<p>Strix çš„ç‰¹è‰²æ˜¯ä¼šå®é™…è¿è¡Œè¦æµ‹è¯•çš„ä»£ç ï¼Œåƒæ˜¯æ¨¡æ‹ŸçœŸå®é»‘å®¢è¡Œä¸ºæ¥æ”»å‡»ç½‘ç«™ï¼Œæœ€åå‘ç°å®‰å…¨æ¼æ´ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2bd545ef4012471d98942eed7e36d50d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763358366&amp;x-signature=EBYNRPJaHkJQrErq2SmnLeEQ7Q8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™ä¸ªå¼€æºé¡¹ç›®é¡¹ç›®å†…ç½®å¤šç§å·¥å…·æ¨¡å—ï¼Œä¾‹å¦‚ HTTP ä»£ç†ç”¨äºè¯·æ±‚æ“çºµã€æµè§ˆå™¨è‡ªåŠ¨åŒ–æµ‹è¯• XSS/CSRFã€Python è¿è¡Œæ—¶ç”¨äºè‡ªå®šä¹‰æ¼æ´å¼€å‘ã€‚</p>
<p>å®ƒä¸ä»…è¯†åˆ«æ½œåœ¨æ¼æ´ï¼Œè¿˜ä¼šå°è¯•åˆ©ç”¨ SQL æ³¨å…¥æˆ–æƒé™æå‡ï¼Œç¡®ä¿é—®é¢˜çœŸå®å­˜åœ¨ã€‚æ‰€æœ‰æ“ä½œåœ¨éš”ç¦»çš„ Docker ç¯å¢ƒä¸­è¿›è¡Œï¼Œä¿è¯æµ‹è¯•å®‰å…¨æ€§ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7aab5a1cc6064ea28e3865d41defd066~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763358366&amp;x-signature=WB3TMQ3uv11cJyqGAo0ygtaF3So%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<pre><code class="hljs language-arduino" lang="arduino">å¼€æºåœ°å€ï¼šhttps:<span class="hljs-comment">//github.com/usestrix/strix</span>
</code></pre>
<h2 data-id="heading-2">03ã€LocalAIï¼šè‡ªå·±ç”µè„‘ä¸Šç”¨ AI</h2>
<p>LocalAI è¿™ä¸ªå¼€æºé¡¹ç›®çœ‹åå­—å°±èƒ½çŒœå‡ºæ¥ã€‚è®©ä½ èƒ½åœ¨ä¸ªäººç”µè„‘æˆ–è‡ªå·±çš„æœåŠ¡å™¨ä½æˆæœ¬è¿è¡Œ AI æ¨¡å‹ã€‚</p>
<p>ç°åœ¨å¿« 4 ä¸‡æ˜Ÿæ˜Ÿäº†ã€‚</p>
<p>å¯æ‰©å±•æ€§å¾ˆå¼ºï¼Œä½ å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶è‡ªå®šä¹‰æ¨¡å‹ï¼Œæ”¯æŒæ–‡å­—ç”Ÿæˆæ¨¡å‹ã€éŸ³é¢‘ã€è§†é¢‘ã€å›¾åƒã€è¯­éŸ³å…‹éš†ç­‰æ¨¡å‹ï¼Œè€Œä¸”è¿˜æ”¯æŒ WebUI ï¼Œå¾ˆæ–¹ä¾¿ç®¡ç†ä½ çš„æœ¬åœ°æ¨¡å‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd2e598c43ac4fb1b568d63faf016fcf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763358366&amp;x-signature=OCW4t9GrFo6HXXjEanR%2F3Oy6LAE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å®ƒå®ç°äº†ä¸ OpenAIã€Anthropic ç­‰å•†ä¸š API å…¼å®¹çš„ REST æ¥å£ï¼Œæ„å‘³ç€ç°æœ‰åº”ç”¨åªéœ€ä¿®æ”¹ API ç«¯ç‚¹å³å¯æ— ç¼åˆ‡æ¢ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/27e96d07c84b4ae0a1c13e080d6dbea8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763358366&amp;x-signature=jw7KiuHehhpnIJitYc6DNsoRAOo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ddf05540f3ca4fe88696125adbc3d1ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763358366&amp;x-signature=uNaiXMi7LMRYqW9BJdB9OzAoC04%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/deb3ec5a616f42b593c667d27c5a3acd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763358366&amp;x-signature=OunphN4%2Bsp%2FoA3D%2Bz1UsC4VjlHw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/09991f474a714808aa11693eac5df10f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763358366&amp;x-signature=Rh9RHd2oeog4KQueA01%2B5eE22Js%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c4d50e0a000d4769877d0464de66b69c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763358366&amp;x-signature=XMCJPRoaXzfnFmVQtg6XBItmJBk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<pre><code class="hljs language-arduino" lang="arduino">å¼€æºåœ°å€ï¼šhttps:<span class="hljs-comment">//github.com/mudler/LocalAI</span>
</code></pre>
<h2 data-id="heading-3">04ã€Skyvernï¼šè‡ªåŠ¨åŒ–æµè§ˆå™¨å·¥ä½œæµ</h2>
<p>Skyvern å®ƒåˆ©ç”¨ AI å¤§æ¨¡å‹å’Œè®¡ç®—æœºè§†è§‰è‡ªåŠ¨åŒ–æµè§ˆå™¨æ“ä½œã€‚</p>
<p>å¯¹äºéœ€è¦å¤„ç†ç½‘é¡µä»»åŠ¡çš„ç”¨æˆ·ï¼Œè¿™æˆ–è®¸èƒ½èŠ‚çœå¤§é‡æ—¶é—´ã€‚å’Œæˆ‘ä¹‹å‰ä»‹ç»çš„ä¸€äº›æµè§ˆå™¨è‡ªåŠ¨åŒ–å¼€æºé¡¹ç›®ä¸åŒï¼Œè¿™ä¸ªÂ Skyvern æ˜¯åŸºäºå±å¹•å…ƒç´ äº¤äº’çš„ï¼Œç”¨è§†è§‰ AI å¤§æ¨¡å‹ç†è§£ç½‘é¡µå†…å®¹ï¼Œæ¨¡æ‹Ÿäººç±»æ“ä½œï¼Œæ¯”å¦‚ç‚¹å‡»ã€æ»šåŠ¨ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ac680ba5f6954a4fb2881257d9c2433e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763358366&amp;x-signature=qYlnccjCI43IMjzlebiNe8YU%2FH8%3D" alt="image.png" loading="lazy"/></p>
<p>ç³»ç»Ÿé‡‡ç”¨å¤šæ™ºèƒ½ä½“åä½œçš„æ€è·¯ï¼šä¸€ä¸ªæ™ºèƒ½ä½“åˆ†æç›®æ ‡ï¼Œå¦ä¸€ä¸ªæ‰§è¡ŒåŠ¨ä½œã€‚å…±åŒå®Œæˆä½ ä¸‹è¾¾çš„ä»»åŠ¡ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">å¼€æºåœ°å€ï¼šhttps://github.com/Skyvern-AI/skyvern
</code></pre>
<h2 data-id="heading-4">05ã€NocoBaseï¼šåŸºäº AI çš„æ— ä»£ç å¹³å°</h2>
<p>è¿™ä¸ªå¼€æºé¡¹ç›®è‡ªç§°æ˜¯æœ€å¯æ‰©å±•çš„ AI é©±åŠ¨æ— ä»£ç å¹³å°ï¼Œä½ å¯ä»¥é€šè¿‡é…ç½®æ¥æ­å»ºåº”ç”¨ã€‚</p>
<p>æ€è·¯æ˜¯åŸºäºæ•°æ®æ¨¡å‹é©±åŠ¨åº”ç”¨æ„å»ºï¼Œè€Œä¸æ˜¯å›ºå®šè¡¨å•ã€‚</p>
<p>ä½ å¯åœ¨ä½¿ç”¨æ¨¡å¼ä¸‹æ‹–æ‹–æ‹½æ‹½ç»„è£…é¡µé¢ï¼Œå¹¶åœ¨é…ç½®æ¨¡å¼ä¸‹è°ƒæ•´æ•°æ®å…³ç³»å’Œæƒé™ã€‚è¿™ä¸ªå¼€æºå¹³å°å†…ç½®äº† AI èƒ½åŠ›ï¼Œå¯ä»¥æŠŠ AI åµŒå…¥ä¸šåŠ¡æµç¨‹ï¼Œå®ç°äººæœºåä½œã€‚ä¾‹å¦‚ï¼Œæ­å»ºä¸€ä¸ªå®¢æˆ·ç®¡ç†ç³»ç»Ÿï¼ŒAI è‡ªåŠ¨å¤„ç†æ•°æ®åˆ†ç±»ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">å¼€æºåœ°å€ï¼šhttps:<span class="hljs-comment">//github.com/nocobase/nocobase</span>
</code></pre>
<h2 data-id="heading-5">06ã€Agent Lightning</h2>
<p>Agent Lightning æ˜¯å¾®è½¯å¼€å‘çš„å¼€æºæ¡†æ¶ï¼Œå®ƒèƒ½è®©ç”¨æˆ·èƒ½ç”¨å¼ºåŒ–å­¦ä¹ ç­‰æŠ€æœ¯ä¼˜åŒ–ä»»ä½• AI æ™ºèƒ½ä½“ç†ï¼Œæ— éœ€é‡å†™ä»£ç ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2327be03d8904d90b14318e0c6e4b3f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763358366&amp;x-signature=Ty7woUq3iTem7ULzcD0ndpEEAAI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å®ƒé€šè¿‡å‘å°„äº‹ä»¶çš„æ–¹å¼æ”¶é›†æ™ºèƒ½ä½“è¿è¡Œæ•°æ®ï¼Œæ¯”å¦‚æç¤ºã€å·¥å…·è°ƒç”¨ï¼Œå­˜å‚¨åˆ° LightningStoreï¼Œç„¶ååº”ç”¨ç®—æ³•ï¼ˆå¦‚APOï¼‰ç”Ÿæˆä¼˜åŒ–èµ„æºï¼ˆå¦‚æ–°æç¤ºæ¨¡æ¿ï¼‰ã€‚</p>
<p>æ¡†æ¶æ”¯æŒå¤šä»£ç†ç³»ç»Ÿé€‰æ‹©æ€§ä¼˜åŒ–ï¼Œå¹¶æä¾›Trainerç®¡ç†è®­ç»ƒå¾ªç¯ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·å¯ç”¨å…¶æå‡èŠå¤©ä»£ç†çš„SQLç”Ÿæˆå‡†ç¡®ç‡ã€‚é¡¹ç›®å¼ºè°ƒæ˜“ç”¨æ€§ï¼šåªéœ€æ·»åŠ å‡ è¡Œè¾…åŠ©ä»£ç å³å¯é›†æˆã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">å¼€æºåœ°å€ï¼šhttps:<span class="hljs-comment">//github.com/microsoft/agent-lightning</span>
</code></pre>
<h2 data-id="heading-6">07ã€Glowï¼šåœ¨å‘½ä»¤è¡Œä¸­ä¼˜é›…æ¸²æŸ“ Markdown</h2>
<p>Glowæ˜¯ä¸€ä¸ªç”¨ Go ç¼–å†™çš„å¼€æºå‘½ä»¤è¡Œå·¥å…·ï¼Œä¸“ä¸ºåœ¨ç»ˆç«¯ä¸­ä¼˜é›…æ˜¾ç¤º Markdown è®¾è®¡ã€‚å®ƒä¸åƒç®€å•è§£æå™¨ï¼Œè€Œæ˜¯å®Œæ•´æ¸²æŸ“å¼•æ“ï¼Œèƒ½å¤„ç†å¤æ‚å…ƒç´ å¦‚ä»£ç å—ã€æ•°å­¦å…¬å¼ã€‚ç»ˆç«¯æ˜¾ç¤º Markdown ä¸ç”¨å¤´ç–¼äº†ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">å¼€æºåœ°å€ï¼šhttps:<span class="hljs-comment">//github.com/charmbracelet/glow</span>
</code></pre>
<p>æœ¬å‘¨è¿˜æœ‰å…¶å®ƒçƒ­é—¨çš„å¼€æºé¡¹ç›®ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢è¿™å¼ å›¾ä¸€è§ˆã€‚å¾ˆå¤šé¡¹ç›®é€›é€›ä¹‹å‰å‘è¿‡å•ç‹¬çš„æ–‡ç« ä»‹ç»è¿‡ï¼Œæ„Ÿå…´è¶£çš„å»ç¿»ä¸€ç¿»å§ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5cb37414a7b84c6cbaa76edf63df2606~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763358366&amp;x-signature=0Z6%2Bg7c%2BU86fBjN4r4wx7AzH%2Bfc%3D" alt="å›¾ç‰‡" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Elasticsearchï¼šå¦‚ä½•ä¸º Elastic Stack éƒ¨ç½² E5 æ¨¡å‹ - ä¸‹è½½åŠéš”ç¦»ç¯å¢ƒ]]></title>    <link>https://juejin.cn/post/7570339961909264427</link>    <guid>https://juejin.cn/post/7570339961909264427</guid>    <pubDate>2025-11-10T06:10:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570339961909264427" data-draft-id="7570500819888865323" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Elasticsearchï¼šå¦‚ä½•ä¸º Elastic Stack éƒ¨ç½² E5 æ¨¡å‹ - ä¸‹è½½åŠéš”ç¦»ç¯å¢ƒ"/> <meta itemprop="keywords" content="Elasticsearch"/> <meta itemprop="datePublished" content="2025-11-10T06:10:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Elasticsearch"/> <meta itemprop="url" content="https://juejin.cn/user/2612095360441448"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Elasticsearchï¼šå¦‚ä½•ä¸º Elastic Stack éƒ¨ç½² E5 æ¨¡å‹ - ä¸‹è½½åŠéš”ç¦»ç¯å¢ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2612095360441448/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Elasticsearch
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T06:10:45.000Z" title="Mon Nov 10 2025 06:10:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/899034501fa54e4a91b8d14c64bf0807~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359844&amp;x-signature=FA%2F5NLhcOGVOpPWcUxH7pY3BXw0%3D" alt="" loading="lazy"/></p>
<p>ä»åŒå‘ç¼–ç å™¨è¡¨ç¤ºï¼ˆEmbeddings from bidirectional Encoder Representationsï¼Œç®€ç§° E5ï¼‰æ˜¯ä¸€ç§è‡ªç„¶è¯­è¨€å¤„ç†æ¨¡å‹ï¼Œå®ƒå¯ä»¥é€šè¿‡ä½¿ç”¨ç¨ å¯†å‘é‡è¡¨ç¤ºæ¥æ‰§è¡Œå¤šè¯­è¨€è¯­ä¹‰æœç´¢ã€‚è¯¥æ¨¡å‹æ¨èç”¨äºéè‹±è¯­æ–‡æ¡£å’ŒæŸ¥è¯¢ã€‚å¦‚æœä½ æƒ³å¯¹è‹±æ–‡æ–‡æ¡£æ‰§è¡Œè¯­ä¹‰æœç´¢ï¼Œå¯ä»¥ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fexplore-analyze%2Fmachine-learning%2Fnlp%2Fml-nlp-elser" title="https://www.elastic.co/docs/explore-analyze/machine-learning/nlp/ml-nlp-elser" target="_blank" ref="nofollow noopener noreferrer">ELSER</a> æ¨¡å‹ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fsolutions%2Fsearch%2Fsemantic-search" title="https://www.elastic.co/docs/solutions/search/semantic-search" target="_blank" ref="nofollow noopener noreferrer">è¯­ä¹‰æœç´¢</a>æ ¹æ®ä¸Šä¸‹æ–‡å«ä¹‰å’Œç”¨æˆ·æ„å›¾æä¾›æœç´¢ç»“æœï¼Œè€Œä¸æ˜¯ä»…ä»…åŒ¹é…å…³é”®è¯ã€‚</p>
<p>E5 æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼š</p>
<ol>
<li>
<p><strong>è·¨å¹³å°ç‰ˆæœ¬</strong>ï¼šå¯åœ¨ä»»ä½•ç¡¬ä»¶ä¸Šè¿è¡Œ</p>
</li>
<li>
<p><strong>IntelÂ® ç¡…ä¼˜åŒ–ç‰ˆæœ¬</strong>ï¼šé’ˆå¯¹ Intel ç¡¬ä»¶ä¼˜åŒ–</p>
</li>
</ol>
<p>åœ¨ <strong>Model Management &gt; Trained Models</strong> é¡µé¢ä¸Šï¼Œå¯ä»¥æŸ¥çœ‹æ ¹æ®é›†ç¾¤ç¡¬ä»¶æ¨èéƒ¨ç½²çš„ E5 ç‰ˆæœ¬ã€‚ä¸è¿‡ï¼Œæ¨èçš„ä½¿ç”¨æ–¹å¼æ˜¯é€šè¿‡ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fapi%2Fdoc%2Felasticsearch%2Foperation%2Foperation-inference-put-elasticsearch" title="https://www.elastic.co/docs/api/doc/elasticsearch/operation/operation-inference-put-elasticsearch" target="_blank" ref="nofollow noopener noreferrer">inference API</a> ä½œä¸ºæœåŠ¡</strong> ä½¿ç”¨ E5ï¼Œè¿™æ ·å¯ä»¥æ›´æ–¹ä¾¿åœ°ä¸‹è½½å’Œéƒ¨ç½²æ¨¡å‹ï¼Œæ— éœ€æ‰‹åŠ¨é€‰æ‹©ä¸åŒç‰ˆæœ¬ã€‚</p>
<p>å¦‚éœ€æ›´å¤šä¿¡æ¯ï¼ŒåŒ…æ‹¬è®¸å¯è¯´æ˜ï¼Œå¯ä»¥å‚è€ƒ HuggingFace ä¸Šçš„ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fhuggingface.co%2Felastic%2Fmultilingual-e5-small" title="https://huggingface.co/elastic/multilingual-e5-small" target="_blank" ref="nofollow noopener noreferrer">multilingual-e5-small</a></strong> å’Œ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fhuggingface.co%2Felastic%2Fmultilingual-e5-small-optimized" title="https://huggingface.co/elastic/multilingual-e5-small-optimized" target="_blank" ref="nofollow noopener noreferrer">multilingual-e5-small-optimized</a></strong> æ¨¡å‹å¡ã€‚</p>
<h2 data-id="heading-0">è¦æ±‚</h2>
<p>è¦ä½¿ç”¨ E5ï¼Œä½ å¿…é¡»æ‹¥æœ‰ç”¨äº semantic search çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fcn%2Fsubscriptions" title="https://www.elastic.co/cn/subscriptions" target="_blank" ref="nofollow noopener noreferrer">ç›¸åº”è®¢é˜…ç­‰çº§</a>æˆ–å·²æ¿€æ´»è¯•ç”¨æœŸã€‚</p>
<p>å»ºè®®ä¸ºä½ çš„ E5 éƒ¨ç½²å¯ç”¨ trained model autoscalingã€‚å‚è€ƒ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fdeploy-manage%2Fautoscaling%2Ftrained-model-autoscaling" title="https://www.elastic.co/docs/deploy-manage/autoscaling/trained-model-autoscaling" target="_blank" ref="nofollow noopener noreferrer">Trained model autoscaling</a> äº†è§£æ›´å¤šä¿¡æ¯ã€‚</p>
<h2 data-id="heading-1">ä¸‹è½½å¹¶éƒ¨ç½² E5</h2>
<p>ä¸‹è½½å¹¶éƒ¨ç½² E5 æœ€ç®€å•ä¸”æ¨èçš„æ–¹å¼æ˜¯ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fapi%2Fdoc%2Felasticsearch%2Fgroup%2Fendpoint-inference" title="https://www.elastic.co/docs/api/doc/elasticsearch/group/endpoint-inference" target="_blank" ref="nofollow noopener noreferrer">inference API</a>ã€‚</p>
<p>1ï¼‰åœ¨ Kibana ä¸­ï¼Œè¿›å…¥ Dev Consoleã€‚<br/>
2ï¼‰é€šè¿‡è¿è¡Œä»¥ä¸‹ API è¯·æ±‚ï¼Œä½¿ç”¨ elasticsearch æœåŠ¡åˆ›å»ºä¸€ä¸ª inference endpointï¼š</p>
<pre><code class="hljs language-bash" lang="bash">`

1.  PUT _inference/text_embedding/my-e5-model
2.  {
3.    <span class="hljs-string">"service"</span>: <span class="hljs-string">"elasticsearch"</span>,
4.    <span class="hljs-string">"service_settings"</span>: {
5.      <span class="hljs-string">"num_allocations"</span>: 1,
6.      <span class="hljs-string">"num_threads"</span>: 1,
7.      <span class="hljs-string">"model_id"</span>: <span class="hljs-string">".multilingual-e5-small"</span>
8.    }
9.  }

`AIå†™ä»£ç 
</code></pre>
<p>è¯¥ API è¯·æ±‚ä¼šè‡ªåŠ¨å¯åŠ¨æ¨¡å‹ä¸‹è½½ï¼Œç„¶åéƒ¨ç½²æ¨¡å‹ã€‚</p>
<p>å‚è€ƒ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fapi%2Fdoc%2Felasticsearch%2Foperation%2Foperation-inference-put-elasticsearch" title="https://www.elastic.co/docs/api/doc/elasticsearch/operation/operation-inference-put-elasticsearch" target="_blank" ref="nofollow noopener noreferrer">elasticsearch inference service</a> æ–‡æ¡£äº†è§£å¯ç”¨è®¾ç½®çš„æ›´å¤šä¿¡æ¯ã€‚</p>
<p>åœ¨åˆ›å»º E5 inference endpoint åï¼Œå®ƒå³å¯ç”¨äº semantic searchã€‚åœ¨ Elastic Stack ä¸­æ‰§è¡Œ semantic search æœ€ç®€å•çš„æ–¹æ³•æ˜¯<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fsolutions%2Fsearch%2Fsemantic-search%2Fsemantic-search-semantic-text" title="https://www.elastic.co/docs/solutions/search/semantic-search/semantic-search-semantic-text" target="_blank" ref="nofollow noopener noreferrer">éµå¾ª semantic_text workflow</a>ã€‚</p>
<h2 data-id="heading-2">ä¸‹è½½å¹¶éƒ¨ç½² E5 çš„æ›¿ä»£æ–¹æ³•</h2>
<p>ä½ ä¹Ÿå¯ä»¥ä» Trained models é¡µé¢ã€Search &gt; Indicesï¼Œæˆ–é€šè¿‡åœ¨ Dev Console ä¸­ä½¿ç”¨ trained models API ä¸‹è½½å¹¶éƒ¨ç½² E5 æ¨¡å‹ã€‚</p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ¨èä½¿ç”¨é’ˆå¯¹ Intel å’Œ Linux ä¼˜åŒ–çš„æ¨¡å‹ï¼Œå»ºè®®ä¸‹è½½å¹¶éƒ¨ç½²è¯¥ç‰ˆæœ¬ã€‚</p>
</blockquote>
<h3 data-id="heading-3">ä½¿ç”¨ Trained Models é¡µé¢è¿›è¡Œä¸‹è½½</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7abd237f70354f7687d7b343e031d4a0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359844&amp;x-signature=UhGJV4N9CNzoOw6QoZU%2FcxChkSc%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/967d1f30e4c04961a2492ee98ab8eb59~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359844&amp;x-signature=UddlXsEWrnQR%2BL8b3EEMqDjUvVE%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b0df4fb7c4a8442b9736a4e9b37a1759~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359844&amp;x-signature=J%2FUnyXcrPTHo92Xv2xYRnfY9xYw%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed039fbefad84592806555059f775ab1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359844&amp;x-signature=jDIR354s7KPbuV5XfAv9A5v70EY%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤æ¥å¸è½½å·²ç»å®‰è£…å¥½çš„æ¨¡å‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">`DELETE _ml/trained_models/.multilingual-e5-small?<span class="hljs-attr">force</span>=<span class="hljs-literal">true</span>`AIå†™ä»£ç 
</code></pre>
<p>ä¸€æ—¦è¢«å¸è½½ï¼Œå°±ä¼šæ¢å¤åˆ°ä¹‹å‰çš„æ ·å­ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d2a00cd35174771b9c3763faa7eccd1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359844&amp;x-signature=D7XwSdYkvijgOhQexh%2BUYYo5RKY%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-4">åœ¨ Dev Console ä¸­ä½¿ç”¨ trained models API</h3>
<p>1ï¼‰åœ¨ Kibana ä¸­ï¼Œè¿›å…¥ Dev Consoleã€‚<br/>
2ï¼‰é€šè¿‡è¿è¡Œä»¥ä¸‹ API è°ƒç”¨åˆ›å»º E5 æ¨¡å‹é…ç½®ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">`

<span class="hljs-bullet">1.</span>  PUT <span class="hljs-emphasis">_ml/trained_</span>models/.multilingual-e5-small
<span class="hljs-bullet">2.</span>  {
<span class="hljs-bullet">3.</span>    "input": {
<span class="hljs-bullet">4.</span>      "field<span class="hljs-emphasis">_names": [
5.        "text_</span>field"
<span class="hljs-bullet">6.</span>      ]
<span class="hljs-bullet">7.</span>    }
<span class="hljs-bullet">8.</span>  }

`AIå†™ä»£ç 
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fddc057fd79f425ea5b2dbff3fde99f2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763359844&amp;x-signature=fWEUEMa9V2M9G%2Bz7%2BDZIfdVmpu8%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœæ¨¡å‹å°šæœªä¸‹è½½ï¼Œè¯¥ API è°ƒç”¨ä¼šè‡ªåŠ¨å¯åŠ¨æ¨¡å‹ä¸‹è½½ã€‚</p>
<p>3ï¼‰ä½¿ç”¨ start trained model deployment API å¹¶æä¾› deployment ID æ¥éƒ¨ç½²æ¨¡å‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">`POST _ml/trained_models/.multilingual-e5-small/deployment/_start?deployment_id=for_search`AIå†™ä»£ç 
</code></pre>
<h2 data-id="heading-5">åœ¨éš”ç¦»ç¯å¢ƒä¸­éƒ¨ç½² E5 æ¨¡å‹</h2>
<p>å¦‚æœä½ æƒ³åœ¨éš”ç¦»ç¯å¢ƒä¸­å®‰è£… E5ï¼Œä½ æœ‰ä»¥ä¸‹é€‰é¡¹ï¼š</p>
<ul>
<li>
<p>å°†æ¨¡å‹æ–‡ä»¶æ”¾å…¥æ‰€æœ‰ master-eligible èŠ‚ç‚¹ config ç›®å½•å†…çš„æŸä¸ªç›®å½•ä¸­ï¼ˆé€‚ç”¨äº multilingual-e5-small å’Œ multilingual-e5-small-linux-x86-64ï¼‰</p>
</li>
<li>
<p>ä½¿ç”¨ HuggingFace å®‰è£…æ¨¡å‹ï¼ˆä»…é€‚ç”¨äº multilingual-e5-small æ¨¡å‹ï¼‰</p>
</li>
</ul>
<h3 data-id="heading-6">æ¨¡å‹æ–‡ä»¶</h3>
<p>å¯¹äº multilingual-e5-small æ¨¡å‹ï¼Œä½ çš„ç³»ç»Ÿä¸­éœ€è¦ä»¥ä¸‹æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">`

<span class="hljs-number">1.</span>  https:<span class="hljs-comment">//ml-models.elastic.co/multilingual-e5-small.metadata.json</span>
<span class="hljs-number">2.</span>  https:<span class="hljs-comment">//ml-models.elastic.co/multilingual-e5-small.pt</span>
<span class="hljs-number">3.</span>  https:<span class="hljs-comment">//ml-models.elastic.co/multilingual-e5-small.vocab.json</span>

`AIå†™ä»£ç 
</code></pre>
<p>å¯¹äºä¼˜åŒ–ç‰ˆæœ¬ï¼Œä½ çš„ç³»ç»Ÿä¸­éœ€è¦ä»¥ä¸‹æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">`

<span class="hljs-number">1.</span>  https:<span class="hljs-comment">//ml-models.elastic.co/multilingual-e5-small_linux-x86_64.metadata.json</span>
<span class="hljs-number">2.</span>  https:<span class="hljs-comment">//ml-models.elastic.co/multilingual-e5-small_linux-x86_64.pt</span>
<span class="hljs-number">3.</span>  https:<span class="hljs-comment">//ml-models.elastic.co/multilingual-e5-small_linux-x86_64.vocab.json</span>

`AIå†™ä»£ç 
</code></pre>
<h3 data-id="heading-7">ä½¿ç”¨åŸºäºæ–‡ä»¶çš„è®¿é—®</h3>
<p>å¯¹äºåŸºäºæ–‡ä»¶çš„è®¿é—®ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p>
<ol>
<li>
<p>ä¸‹è½½<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fexplore-analyze%2Fmachine-learning%2Fnlp%2Fml-nlp-e5%23e5-model-artifacts" title="https://www.elastic.co/docs/explore-analyze/machine-learning/nlp/ml-nlp-e5#e5-model-artifacts" target="_blank" ref="nofollow noopener noreferrer">æ¨¡å‹æ–‡ä»¶</a>ã€‚</p>
</li>
<li>
<p>å°†æ–‡ä»¶æ”¾å…¥ Elasticsearch éƒ¨ç½²çš„ config ç›®å½•ä¸‹çš„ models å­ç›®å½•ä¸­ã€‚</p>
</li>
<li>
<p>é€šè¿‡åœ¨ config/elasticsearch.yml æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹è¡Œï¼Œå°†ä½ çš„ Elasticsearch éƒ¨ç½²æŒ‡å‘æ¨¡å‹ç›®å½•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">`xpack.ml.model_repository: file://<span class="hljs-variable">${path.home}</span>/config/models/`AIå†™ä»£ç 
</code></pre>
</li>
<li>
<p>åœ¨æ‰€æœ‰ master-eligible èŠ‚ç‚¹é‡å¤æ­¥éª¤ 2 å’Œæ­¥éª¤ 3ã€‚</p>
</li>
<li>
<p>é€ä¸€<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fdeploy-manage%2Fmaintenance%2Fstart-stop-services%2Ffull-cluster-restart-rolling-restart-procedures%23restart-cluster-rolling" title="https://www.elastic.co/docs/deploy-manage/maintenance/start-stop-services/full-cluster-restart-rolling-restart-procedures#restart-cluster-rolling" target="_blank" ref="nofollow noopener noreferrer">é‡å¯</a> master-eligible èŠ‚ç‚¹ã€‚</p>
</li>
<li>
<p>ä»ä¸»èœå•è¿›å…¥ <strong>Trained Models</strong> é¡µé¢ï¼Œæˆ–ä½¿ç”¨ Kibana çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fexplore-analyze%2Ffind-and-organize%2Ffind-apps-and-objects" title="https://www.elastic.co/docs/explore-analyze/find-and-organize/find-apps-and-objects" target="_blank" ref="nofollow noopener noreferrer">å…¨å±€æœç´¢å­—æ®µ</a>ã€‚ä½ å¯ä»¥åœ¨è®­ç»ƒæ¨¡å‹åˆ—è¡¨ä¸­æ‰¾åˆ° E5ã€‚</p>
</li>
<li>
<p>ç‚¹å‡» <strong>Add trained model</strong> æŒ‰é’®ï¼Œé€‰æ‹©ä½ åœ¨æ­¥éª¤ 1 ä¸‹è½½å¹¶æƒ³è¦éƒ¨ç½²çš„ E5 æ¨¡å‹ç‰ˆæœ¬ï¼Œç„¶åç‚¹å‡» <strong>Download</strong>ã€‚æ‰€é€‰æ¨¡å‹å°†ä»ä½ åœ¨æ­¥éª¤ 2 æ”¾ç½®çš„æ¨¡å‹ç›®å½•ä¸­ä¸‹è½½ã€‚</p>
</li>
<li>
<p>ä¸‹è½½å®Œæˆåï¼Œç‚¹å‡» <strong>Start deployment</strong> æŒ‰é’®å¯åŠ¨éƒ¨ç½²ã€‚</p>
</li>
<li>
<p>æä¾› deployment IDï¼Œé€‰æ‹©ä¼˜å…ˆçº§ï¼Œå¹¶è®¾ç½®æ¯ä¸ªåˆ†é…çš„ allocation æ•°é‡å’Œçº¿ç¨‹æ•°ã€‚</p>
</li>
<li>
<p>ç‚¹å‡» <strong>Start</strong>ã€‚</p>
</li>
</ol>
<h2 data-id="heading-8">ä½¿ç”¨ HuggingFace ä»“åº“</h2>
<p>ä½ å¯ä»¥é€šè¿‡å°† eland_import_hub_model è„šæœ¬æŒ‡å‘æ¨¡å‹çš„æœ¬åœ°æ–‡ä»¶ï¼Œåœ¨å—é™æˆ–å°é—­ç½‘ç»œä¸­å®‰è£… multilingual-e5-small æ¨¡å‹ã€‚</p>
<p>å¯¹äºç¦»çº¿å®‰è£…ï¼Œæ¨¡å‹éœ€è¦å…ˆåœ¨æœ¬åœ°å…‹éš†ï¼Œä½ çš„ç³»ç»Ÿä¸­éœ€è¦å®‰è£… Git å’Œ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgit-lfs.com%2F" title="https://git-lfs.com/" target="_blank" ref="nofollow noopener noreferrer">Git Large File Storage</a>ã€‚</p>
<p>1ï¼‰ä½¿ç”¨æ¨¡å‹ URL ä» Hugging Face å…‹éš† E5 æ¨¡å‹ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">`git <span class="hljs-built_in">clone</span> https://huggingface.co/intfloat/multilingual-e5-small`AIå†™ä»£ç 
</code></pre>
<p>è¯¥å‘½ä»¤ä¼šåœ¨ multilingual-e5-small ç›®å½•ä¸­ç”Ÿæˆæ¨¡å‹çš„æœ¬åœ°å‰¯æœ¬ã€‚</p>
<p>2ï¼‰ä½¿ç”¨ eland_import_hub_model è„šæœ¬ï¼Œå¹¶å°† --hub-model-id è®¾ç½®ä¸ºå…‹éš†æ¨¡å‹çš„ç›®å½•æ¥å®‰è£…å®ƒï¼š</p>
<pre><code class="hljs language-css" lang="css">`

<span class="hljs-number">1</span>.  eland_import_hub_model \
<span class="hljs-number">2</span>.        <span class="hljs-attr">--url</span> 'XXXX' \
<span class="hljs-number">3</span>.        <span class="hljs-attr">--hub-model-id</span> /PATH/<span class="hljs-selector-tag">TO</span>/MODEL \
<span class="hljs-number">4</span>.        <span class="hljs-attr">--task-type</span> text_embedding \
<span class="hljs-number">5</span>.        <span class="hljs-attr">--es-username</span> elastic <span class="hljs-attr">--es-password</span> XXX \
<span class="hljs-number">6</span>.        <span class="hljs-attr">--es-model-id</span> multilingual-e5-small

`AIå†™ä»£ç 
</code></pre>
<p>å¦‚æœä½ ä½¿ç”¨ Docker é•œåƒè¿è¡Œ eland_import_hub_modelï¼Œå¿…é¡»ç»‘å®šæŒ‚è½½æ¨¡å‹ç›®å½•ï¼Œä»¥ä¾¿å®¹å™¨å¯ä»¥è¯»å–æ–‡ä»¶ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">`

1.  docker run --mount <span class="hljs-built_in">type</span>=<span class="hljs-built_in">bind</span>,<span class="hljs-built_in">source</span>=/PATH/TO/MODELS,destination=/models,<span class="hljs-built_in">readonly</span> -it --<span class="hljs-built_in">rm</span> docker.elastic.co/eland/eland \
2.      eland_import_hub_model \
3.        --url <span class="hljs-string">'XXXX'</span> \
4.        --hub-model-id /models/multilingual-e5-small \
5.        --task-type text_embedding \
6.        --es-username elastic --es-password XXX \
7.        --es-model-id multilingual-e5-small

`AIå†™ä»£ç 
</code></pre>
<p>ä¸€æ—¦ä¸Šä¼ åˆ° Elasticsearchï¼Œæ¨¡å‹å°†ä½¿ç”¨ --es-model-id æŒ‡å®šçš„ IDã€‚å¦‚æœæœªè®¾ç½®ï¼Œåˆ™æ¨¡å‹ ID å°†ä» --hub-model-id æ¨å¯¼ï¼›ç©ºæ ¼å’Œè·¯å¾„åˆ†éš”ç¬¦ä¼šè¢«è½¬æ¢ä¸ºåŒä¸‹åˆ’çº¿ __ã€‚</p>
<h2 data-id="heading-9">å…è´£å£°æ˜</h2>
<p>å®¢æˆ·å¯ä»¥å°†ç¬¬ä¸‰æ–¹è®­ç»ƒæ¨¡å‹æ·»åŠ åˆ° Elastic è¿›è¡Œç®¡ç†ã€‚è¿™äº›æ¨¡å‹ä¸å±äº Elasticã€‚è™½ç„¶ Elastic ä¼šæ ¹æ®æ–‡æ¡£æ”¯æŒä¸è¿™äº›æ¨¡å‹çš„é›†æˆæ€§èƒ½ï¼Œä½†ä½ ç†è§£å¹¶åŒæ„ Elastic å¯¹ç¬¬ä¸‰æ–¹æ¨¡å‹æˆ–å®ƒä»¬å¯èƒ½ä½¿ç”¨çš„åº•å±‚è®­ç»ƒæ•°æ®ä¸æ‹¥æœ‰æ§åˆ¶æƒï¼Œä¹Ÿä¸æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚</p>
<p>æœ¬ E5 æ¨¡å‹ï¼Œå¦‚å®šä¹‰ã€æ‰˜ç®¡ã€é›†æˆå¹¶ä¸æˆ‘ä»¬çš„å…¶ä»– Elastic è½¯ä»¶ä¸€èµ·ä½¿ç”¨ï¼Œå—æˆ‘ä»¬çš„æ ‡å‡†ä¿ä¿®è¦†ç›–ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RabbitMQ Unacked æ¶ˆæ¯æ·±åº¦è§£æï¼šæœºåˆ¶ã€é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7570491473034346505</link>    <guid>https://juejin.cn/post/7570491473034346505</guid>    <pubDate>2025-11-10T06:14:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7570491473034346505" data-draft-id="7570579125154070538" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RabbitMQ Unacked æ¶ˆæ¯æ·±åº¦è§£æï¼šæœºåˆ¶ã€é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="Spring Boot,RabbitMQ"/> <meta itemprop="datePublished" content="2025-11-10T06:14:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è€ç å†œDebugæ—¥è®°"/> <meta itemprop="url" content="https://juejin.cn/user/2438031766469579"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RabbitMQ Unacked æ¶ˆæ¯æ·±åº¦è§£æï¼šæœºåˆ¶ã€é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2438031766469579/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è€ç å†œDebugæ—¥è®°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-10T06:14:13.000Z" title="Mon Nov 10 2025 06:14:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å¼•è¨€</h3>
<p>åœ¨ RabbitMQ çš„æ¶ˆæ¯å¤„ç†ä¸­ï¼ŒUnackedï¼ˆæœªç¡®è®¤ï¼‰çŠ¶æ€æ˜¯ä¸€ä¸ªå…³é”®æ¦‚å¿µã€‚ç†è§£ Unacked æ¶ˆæ¯çš„è¡Œä¸ºæœºåˆ¶å¯¹äºæ„å»ºå¯é çš„æ¶ˆæ¯ç³»ç»Ÿè‡³å…³é‡è¦ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ Unacked æ¶ˆæ¯çš„ç”Ÿå‘½å‘¨æœŸã€ä¸ºä»€ä¹ˆå®ƒä»¬å¯èƒ½ä¸ä¼šé‡æ–°å…¥é˜Ÿï¼Œä»¥åŠå¦‚ä½•æœ‰æ•ˆç®¡ç†è¿™ç§æƒ…å†µã€‚</p>
<h3 data-id="heading-1">ä¸€ã€Unacked æ¶ˆæ¯çš„åŸºæœ¬æ¦‚å¿µ</h3>
<h4 data-id="heading-2">1.1 ä»€ä¹ˆæ˜¯ Unacked æ¶ˆæ¯</h4>
<p>Unacked æ¶ˆæ¯æ˜¯æŒ‡å·²ç»è¢«æ¶ˆè´¹è€…è·å–ä½†å°šæœªç¡®è®¤çš„æ¶ˆæ¯ã€‚è¿™ç§çŠ¶æ€å­˜åœ¨äºæ‰‹åŠ¨ç¡®è®¤æ¨¡å¼ï¼ˆManual Acknowledgementï¼‰ä¸‹ã€‚</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// æ¶ˆæ¯çŠ¶æ€æµè½¬ç¤ºæ„å›¾</span>
Producer â†’ Broker â†’ <span class="hljs-selector-attr">[Ready]</span> â†’ Consumer â†’ <span class="hljs-selector-attr">[Unacked]</span> â†’ (Ack/Nack/Reject)
</code></pre>
<h4 data-id="heading-3">1.2 æ¶ˆæ¯ç¡®è®¤çš„ä¸‰ç§æ–¹å¼</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageAckExamples</span> {
    
    <span class="hljs-meta">@RabbitListener(queues = "test_queue")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(Message message, Channel channel)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-type">long</span> <span class="hljs-variable">deliveryTag</span> <span class="hljs-operator">=</span> message.getMessageProperties().getDeliveryTag();
        
        <span class="hljs-comment">// 1. ç¡®è®¤æ¶ˆæ¯ - æˆåŠŸå¤„ç†</span>
        channel.basicAck(deliveryTag, <span class="hljs-literal">false</span>);
        
        <span class="hljs-comment">// 2. æ‹’ç»æ¶ˆæ¯å¹¶é‡æ–°å…¥é˜Ÿ</span>
        channel.basicNack(deliveryTag, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);
        
        <span class="hljs-comment">// 3. æ‹’ç»æ¶ˆæ¯å¹¶ä¸¢å¼ƒ</span>
        channel.basicNack(deliveryTag, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>);
    }
}
</code></pre>
<h3 data-id="heading-4">äºŒã€Unacked æ¶ˆæ¯çš„æœ€ç»ˆå‘½è¿</h3>
<h4 data-id="heading-5">2.1 æ¶ˆæ¯çš„å››ç§å¯èƒ½ç»“å±€</h4>
<h5 data-id="heading-6">2.1.1 æ¶ˆè´¹è€…æ­£å¸¸ç¡®è®¤</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ¶ˆæ¯è¢«æˆåŠŸå¤„ç†å¹¶ä» RabbitMQ ä¸­åˆ é™¤</span>
channel.basicAck(deliveryTag, <span class="hljs-literal">false</span>);
</code></pre>
<h5 data-id="heading-7">2.1.2 æ¶ˆè´¹è€…æ‹’ç»å¹¶é‡æ–°å…¥é˜Ÿ</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ¶ˆæ¯é‡æ–°å˜ä¸º Ready çŠ¶æ€ï¼Œå¯è¢«å…¶ä»–æ¶ˆè´¹è€…å¤„ç†</span>
channel.basicNack(deliveryTag, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);
</code></pre>
<h5 data-id="heading-8">2.1.3 æ¶ˆè´¹è€…è¿æ¥æ–­å¼€</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å½“æ¶ˆè´¹è€…è¿æ¥å¼‚å¸¸æ–­å¼€æ—¶ï¼Œæ‰€æœ‰ Unacked æ¶ˆæ¯ä¼šè‡ªåŠ¨é‡æ–°å…¥é˜Ÿ</span>
<span class="hljs-comment">// æ— éœ€æ‰‹åŠ¨æ“ä½œï¼ŒRabbitMQ è‡ªåŠ¨å¤„ç†</span>
</code></pre>
<h5 data-id="heading-9">2.1.4 æ¶ˆè´¹è€…å¿˜è®°ç¡®è®¤</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æœ€å±é™©çš„æƒ…å†µï¼šæ¶ˆæ¯ä¸€ç›´å¤„äº Unacked çŠ¶æ€</span>
<span class="hljs-comment">// ç›´åˆ°æ¶ˆè´¹è€…è¿æ¥æ–­å¼€æ‰ä¼šé‡æ–°å…¥é˜Ÿ</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(Message message, Channel channel)</span> {
    <span class="hljs-comment">// å¤„ç†ä¸šåŠ¡é€»è¾‘...</span>
    <span class="hljs-comment">// ä½†å¿˜è®°è°ƒç”¨ basicAck() æˆ– basicNack()</span>
    <span class="hljs-comment">// æ¶ˆæ¯å°†ä¸€ç›´å¤„äº Unacked çŠ¶æ€ï¼</span>
}
</code></pre>
<h4 data-id="heading-10">2.2 Unacked æ¶ˆæ¯çš„èµ„æºå ç”¨</h4>
<ul>
<li>å†…å­˜ç©ºé—´</li>
<li>æ¶ˆæ¯åœ¨é˜Ÿåˆ—ä¸­çš„ä½ç½®ï¼ˆä½†å¯¹å…¶ä»–æ¶ˆè´¹è€…ä¸å¯è§ï¼‰</li>
<li>ç½‘ç»œè¿æ¥èµ„æº</li>
<li>æ¶ˆè´¹è€…é€šé“èµ„æº</li>
</ul>
<h3 data-id="heading-11">ä¸‰ã€ä¸ºä»€ä¹ˆ Unacked æ¶ˆæ¯æ²¡æœ‰é‡æ–°å…¥é˜Ÿ</h3>
<h4 data-id="heading-12">3.1 ä¸»è¦åŸå› åˆ†æ</h4>
<h5 data-id="heading-13">3.1.1 æ¶ˆè´¹è€…è¿æ¥ä»ç„¶æ´»è·ƒ</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ActiveButStuckConsumer</span> {
    <span class="hljs-meta">@RabbitListener(queues = "test_queue")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(Message message, Channel channel)</span> {
        <span class="hljs-comment">// æ¶ˆè´¹è€…è¿›ç¨‹æ­£å¸¸è¿è¡Œï¼Œè¿æ¥ä¿æŒæ´»è·ƒ</span>
        <span class="hljs-comment">// RabbitMQ è®¤ä¸ºæ¶ˆè´¹è€…ä»åœ¨å¤„ç†æ¶ˆæ¯</span>
        <span class="hljs-comment">// å› æ­¤ä¸ä¼šè‡ªåŠ¨é‡æ–°å…¥é˜Ÿ</span>
        
        <span class="hljs-comment">// å¦‚æœè¿™é‡Œå‘ç”Ÿé˜»å¡æˆ–æ­»é”ï¼Œæ¶ˆæ¯å°†æ°¸è¿œå¤„äº Unacked çŠ¶æ€</span>
        processMessage(message); <span class="hljs-comment">// å‡è®¾è¿™é‡Œå¡ä½äº†</span>
        
        <span class="hljs-comment">// æ°¸è¿œæ‰§è¡Œä¸åˆ°ç¡®è®¤ä»£ç </span>
        <span class="hljs-comment">// channel.basicAck(deliveryTag, false);</span>
    }
}
</code></pre>
<h5 data-id="heading-14">3.1.2 Prefetch Count é…ç½®è¿‡å¤§</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LargePrefetchConfig</span> {
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> SimpleRabbitListenerContainerFactory <span class="hljs-title function_">containerFactory</span><span class="hljs-params">()</span> {
        <span class="hljs-type">SimpleRabbitListenerContainerFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleRabbitListenerContainerFactory</span>();
        factory.setPrefetchCount(<span class="hljs-number">50</span>); <span class="hljs-comment">// è®¾ç½®è¿‡å¤§</span>
        
        <span class="hljs-comment">// é—®é¢˜ï¼šæ¶ˆè´¹è€…å¯ä»¥ä¸€æ¬¡æ€§è·å–50æ¡æ¶ˆæ¯</span>
        <span class="hljs-comment">// å¦‚æœå…¶ä¸­å‡ æ¡æ¶ˆæ¯å¤„ç†å¡ä½ï¼Œå…¶ä»–æ¶ˆæ¯ä¹Ÿä¼šè¢«é˜»å¡</span>
        <span class="hljs-comment">// æ‰€æœ‰50æ¡æ¶ˆæ¯éƒ½ä¼šå¤„äº Unacked çŠ¶æ€</span>
        <span class="hljs-keyword">return</span> factory;
    }
}
</code></pre>
<h5 data-id="heading-15">3.1.3 ç¼ºå°‘è¶…æ—¶æœºåˆ¶</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NoTimeoutConsumer</span> {
    <span class="hljs-meta">@RabbitListener(queues = "blocking_queue")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleBlockingOperation</span><span class="hljs-params">(Message message, Channel channel)</span> {
        <span class="hljs-comment">// æ²¡æœ‰è®¾ç½®å¤„ç†è¶…æ—¶</span>
        <span class="hljs-comment">// å¦‚æœå¤–éƒ¨ä¾èµ–æœåŠ¡å“åº”æ…¢æˆ–æŒ‚èµ·</span>
        <span class="hljs-comment">// æ¶ˆæ¯å°†æ°¸è¿œå¤„äº Unacked çŠ¶æ€</span>
        ResponseEntity&lt;String&gt; response = restTemplate.getForEntity(
            <span class="hljs-string">"http://slow-service/api"</span>, 
            String.class  <span class="hljs-comment">// æ²¡æœ‰è®¾ç½®è¶…æ—¶æ—¶é—´</span>
        );
        
        <span class="hljs-comment">// å¦‚æœæœåŠ¡ä¸å“åº”ï¼Œè¿™é‡Œæ°¸è¿œä¸ä¼šæ‰§è¡Œ</span>
        channel.basicAck(deliveryTag, <span class="hljs-literal">false</span>);
    }
}
</code></pre>
<h4 data-id="heading-16">3.2 å…·ä½“é—®é¢˜åœºæ™¯</h4>
<h5 data-id="heading-17">3.2.1 æ•°æ®åº“è¿æ¥æ± è€—å°½</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DatabaseBlockedConsumer</span> {
    <span class="hljs-meta">@RabbitListener(queues = "db_queue")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processWithDB</span><span class="hljs-params">(Message message, Channel channel)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å¦‚æœæ•°æ®åº“è¿æ¥æ± è€—å°½ï¼Œè¿™é‡Œä¼šä¸€ç›´ç­‰å¾…</span>
            <span class="hljs-comment">// çº¿ç¨‹è¢«é˜»å¡ï¼Œæ— æ³•æ‰§è¡Œç¡®è®¤æ“ä½œ</span>
            dbService.saveLargeData(extractData(message));
            
            <span class="hljs-comment">// æ°¸è¿œæ‰§è¡Œä¸åˆ°è¿™é‡Œ</span>
            channel.basicAck(message.getMessageProperties().getDeliveryTag(), <span class="hljs-literal">false</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-comment">// å¼‚å¸¸ä¹Ÿæ•è·ä¸åˆ°ï¼Œå› ä¸ºæ˜¯åœ¨ç­‰å¾…è¿æ¥</span>
        }
    }
}
</code></pre>
<h5 data-id="heading-18">3.2.2 åŒæ­¥ HTTP è°ƒç”¨æ— è¶…æ—¶</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HttpBlockedConsumer</span> {
    <span class="hljs-meta">@RabbitListener(queues = "http_queue")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">callExternalApi</span><span class="hljs-params">(Message message, Channel channel)</span> {
        <span class="hljs-comment">// åˆ›å»ºæ²¡æœ‰è¶…æ—¶è®¾ç½®çš„ RestTemplate</span>
        <span class="hljs-type">RestTemplate</span> <span class="hljs-variable">noTimeoutTemplate</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RestTemplate</span>();
        
        <span class="hljs-comment">// å¦‚æœå¤–éƒ¨æœåŠ¡ä¸å“åº”ï¼Œè°ƒç”¨å°†æ°¸è¿œæŒ‚èµ·</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> noTimeoutTemplate.getForObject(
            <span class="hljs-string">"http://unreliable-service/api"</span>, 
            String.class
        );
        
        <span class="hljs-comment">// æ°¸è¿œä¸ä¼šæ‰§è¡Œç¡®è®¤</span>
        channel.basicAck(deliveryTag, <span class="hljs-literal">false</span>);
    }
}
</code></pre>
<h5 data-id="heading-19">3.2.3 æ­»é”æˆ–èµ„æºç«äº‰</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DeadlockConsumer</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lockA</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lockB</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();
    
    <span class="hljs-meta">@RabbitListener(queues = "deadlock_queue")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processWithDeadlock</span><span class="hljs-params">(Message message, Channel channel)</span> {
        <span class="hljs-keyword">synchronized</span> (lockA) {
            <span class="hljs-keyword">try</span> {
                Thread.sleep(<span class="hljs-number">100</span>);
                <span class="hljs-keyword">synchronized</span> (lockB) {  <span class="hljs-comment">// å¯èƒ½å‘ç”Ÿæ­»é”</span>
                    processBusinessLogic(message);
                }
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                <span class="hljs-comment">// ä¸ä¼šæ‰§è¡Œåˆ°ç¡®è®¤</span>
            }
        }
        <span class="hljs-comment">// ç¡®è®¤ä»£ç æ°¸è¿œæ‰§è¡Œä¸åˆ°</span>
    }
}
</code></pre>
<h3 data-id="heading-20">å››ã€è§£å†³æ–¹æ¡ˆå’Œæœ€ä½³å®è·µ</h3>
<h4 data-id="heading-21">4.1 è®¾ç½®åˆç†çš„è¶…æ—¶æœºåˆ¶</h4>
<h5 data-id="heading-22">4.1.1 ä½¿ç”¨è¶…æ—¶æ§åˆ¶çš„æ¶ˆè´¹è€…</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TimeoutAwareConsumer</span> {
    <span class="hljs-meta">@RabbitListener(queues = "timeout_queue")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleWithTimeout</span><span class="hljs-params">(Message message, Channel channel)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-type">long</span> <span class="hljs-variable">deliveryTag</span> <span class="hljs-operator">=</span> message.getMessageProperties().getDeliveryTag();
        <span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newSingleThreadExecutor();
        
        Future&lt;?&gt; future = executor.submit(() -&gt; {
            processMessage(message); <span class="hljs-comment">// ä¸šåŠ¡å¤„ç†</span>
        });
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// è®¾ç½®30ç§’è¶…æ—¶</span>
            future.get(<span class="hljs-number">30</span>, TimeUnit.SECONDS);
            channel.basicAck(deliveryTag, <span class="hljs-literal">false</span>);
            logger.info(<span class="hljs-string">"æ¶ˆæ¯å¤„ç†æˆåŠŸ"</span>);
            
        } <span class="hljs-keyword">catch</span> (TimeoutException e) {
            future.cancel(<span class="hljs-literal">true</span>); <span class="hljs-comment">// å–æ¶ˆä»»åŠ¡</span>
            <span class="hljs-comment">// è¶…æ—¶åæ‹’ç»æ¶ˆæ¯å¹¶é‡æ–°å…¥é˜Ÿ</span>
            channel.basicNack(deliveryTag, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);
            logger.warn(<span class="hljs-string">"æ¶ˆæ¯å¤„ç†è¶…æ—¶ï¼Œå·²é‡æ–°å…¥é˜Ÿ"</span>);
            
        } <span class="hljs-keyword">catch</span> (Exception e) {
            channel.basicNack(deliveryTag, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>);
            logger.error(<span class="hljs-string">"æ¶ˆæ¯å¤„ç†å¤±è´¥ï¼Œå·²ä¸¢å¼ƒ"</span>, e);
            
        } <span class="hljs-keyword">finally</span> {
            executor.shutdown();
        }
    }
}
</code></pre>
<h5 data-id="heading-23">4.1.2 é…ç½® HTTP å®¢æˆ·ç«¯è¶…æ—¶</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RestTemplateConfig</span> {
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> RestTemplate <span class="hljs-title function_">restTemplate</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RestTemplate</span>(getClientHttpRequestFactory());
    }
    
    <span class="hljs-keyword">private</span> ClientHttpRequestFactory <span class="hljs-title function_">getClientHttpRequestFactory</span><span class="hljs-params">()</span> {
        <span class="hljs-type">HttpComponentsClientHttpRequestFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> 
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpComponentsClientHttpRequestFactory</span>();
        factory.setConnectTimeout(<span class="hljs-number">5000</span>);    <span class="hljs-comment">// 5ç§’è¿æ¥è¶…æ—¶</span>
        factory.setReadTimeout(<span class="hljs-number">30000</span>);      <span class="hljs-comment">// 30ç§’è¯»å–è¶…æ—¶</span>
        <span class="hljs-keyword">return</span> factory;
    }
}
</code></pre>
<h4 data-id="heading-24">4.2 ä¼˜åŒ– RabbitMQ é…ç½®</h4>
<h5 data-id="heading-25">4.2.1 åˆç†çš„ Prefetch Count</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OptimizedRabbitConfig</span> {
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> SimpleRabbitListenerContainerFactory <span class="hljs-title function_">containerFactory</span><span class="hljs-params">()</span> {
        <span class="hljs-type">SimpleRabbitListenerContainerFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> 
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleRabbitListenerContainerFactory</span>();
        
        <span class="hljs-comment">// æ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹è®¾ç½®åˆé€‚çš„é¢„å–æ•°é‡</span>
        factory.setPrefetchCount(<span class="hljs-number">3</span>); <span class="hljs-comment">// è¾ƒå°çš„å€¼é¿å…æ¶ˆæ¯å †ç§¯</span>
        factory.setConcurrentConsumers(<span class="hljs-number">2</span>); <span class="hljs-comment">// åˆé€‚çš„å¹¶å‘æ•°</span>
        factory.setMaxConcurrentConsumers(<span class="hljs-number">5</span>);
        
        <span class="hljs-keyword">return</span> factory;
    }
}
</code></pre>
<h5 data-id="heading-26">4.2.2 å¿ƒè·³æ£€æµ‹é…ç½®</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HeartbeatConfig</span> {
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> CachingConnectionFactory <span class="hljs-title function_">connectionFactory</span><span class="hljs-params">()</span> {
        <span class="hljs-type">CachingConnectionFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CachingConnectionFactory</span>();
        factory.setHost(<span class="hljs-string">"localhost"</span>);
        factory.setRequestedHeartBeat(<span class="hljs-number">30</span>); <span class="hljs-comment">// 30ç§’å¿ƒè·³æ£€æµ‹</span>
        
        <span class="hljs-comment">// å¦‚æœæ¶ˆè´¹è€…ä¸å“åº”å¿ƒè·³ï¼Œè¿æ¥ä¼šè¢«å…³é—­</span>
        <span class="hljs-comment">// Unacked æ¶ˆæ¯ä¼šè‡ªåŠ¨é‡æ–°å…¥é˜Ÿ</span>
        <span class="hljs-keyword">return</span> factory;
    }
}
</code></pre>
<h4 data-id="heading-27">4.3 å®ç°å¥å£®çš„é”™è¯¯å¤„ç†</h4>
<h5 data-id="heading-28">4.3.1 å®Œæ•´çš„å¼‚å¸¸å¤„ç†</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RobustConsumer</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">MAX_RETRY_COUNT</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;
    
    <span class="hljs-meta">@RabbitListener(queues = "robust_queue")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(Message message, Channel channel)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-type">long</span> <span class="hljs-variable">deliveryTag</span> <span class="hljs-operator">=</span> message.getMessageProperties().getDeliveryTag();
        <span class="hljs-type">MessageProperties</span> <span class="hljs-variable">properties</span> <span class="hljs-operator">=</span> message.getMessageProperties();
        Map&lt;String, Object&gt; headers = properties.getHeaders();
        
        <span class="hljs-comment">// è·å–é‡è¯•æ¬¡æ•°</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">retryCount</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) headers.getOrDefault(<span class="hljs-string">"retry-count"</span>, <span class="hljs-number">0</span>);
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ä¸šåŠ¡å¤„ç†é€»è¾‘</span>
            processBusiness(message);
            
            <span class="hljs-comment">// å¤„ç†æˆåŠŸï¼Œç¡®è®¤æ¶ˆæ¯</span>
            channel.basicAck(deliveryTag, <span class="hljs-literal">false</span>);
            logger.info(<span class="hljs-string">"æ¶ˆæ¯å¤„ç†æˆåŠŸ"</span>);
            
        } <span class="hljs-keyword">catch</span> (TemporaryException e) {
            <span class="hljs-comment">// ä¸´æ—¶å¼‚å¸¸ï¼Œæ ¹æ®é‡è¯•æ¬¡æ•°å†³å®šæ˜¯å¦é‡æ–°å…¥é˜Ÿ</span>
            <span class="hljs-keyword">if</span> (retryCount &lt; MAX_RETRY_COUNT) {
                headers.put(<span class="hljs-string">"retry-count"</span>, retryCount + <span class="hljs-number">1</span>);
                channel.basicNack(deliveryTag, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>); <span class="hljs-comment">// é‡æ–°å…¥é˜Ÿ</span>
                logger.warn(<span class="hljs-string">"æ¶ˆæ¯å¤„ç†ä¸´æ—¶å¤±è´¥ï¼Œç¬¬{}æ¬¡é‡è¯•"</span>, retryCount + <span class="hljs-number">1</span>);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// é‡è¯•æ¬¡æ•°è¶…é™ï¼Œè¿›å…¥æ­»ä¿¡é˜Ÿåˆ—</span>
                channel.basicNack(deliveryTag, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>);
                logger.error(<span class="hljs-string">"æ¶ˆæ¯é‡è¯•æ¬¡æ•°è¶…é™ï¼Œå·²è¿›å…¥æ­»ä¿¡é˜Ÿåˆ—"</span>);
            }
            
        } <span class="hljs-keyword">catch</span> (PermanentException e) {
            <span class="hljs-comment">// æ°¸ä¹…å¼‚å¸¸ï¼Œç›´æ¥ç¡®è®¤ï¼ˆé¿å…é‡å¤æ¶ˆè´¹ï¼‰</span>
            channel.basicAck(deliveryTag, <span class="hljs-literal">false</span>);
            logger.error(<span class="hljs-string">"æ¶ˆæ¯å­˜åœ¨æ°¸ä¹…æ€§é”™è¯¯ï¼Œå·²ç¡®è®¤å¹¶ä¸¢å¼ƒ"</span>, e);
        }
    }
}
</code></pre>
<h5 data-id="heading-29">4.3.2 æ­»ä¿¡é˜Ÿåˆ—é…ç½®</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DeadLetterConfig</span> {
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">mainQueue</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> QueueBuilder.durable(<span class="hljs-string">"main_queue"</span>)
                .deadLetterExchange(<span class="hljs-string">"dlx_exchange"</span>)
                .deadLetterRoutingKey(<span class="hljs-string">"dlq_routing_key"</span>)
                .ttl(<span class="hljs-number">60000</span>) <span class="hljs-comment">// 60ç§’TTL</span>
                .build();
    }
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">deadLetterQueue</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Queue</span>(<span class="hljs-string">"dead_letter_queue"</span>, <span class="hljs-literal">true</span>);
    }
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> DirectExchange <span class="hljs-title function_">dlxExchange</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DirectExchange</span>(<span class="hljs-string">"dlx_exchange"</span>);
    }
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Binding <span class="hljs-title function_">dlxBinding</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> BindingBuilder.bind(deadLetterQueue())
                .to(dlxExchange())
                .with(<span class="hljs-string">"dlq_routing_key"</span>);
    }
}
</code></pre>
<h4 data-id="heading-30">4.4 ç›‘æ§å’Œå‘Šè­¦</h4>
<h5 data-id="heading-31">4.4.1 Unacked æ¶ˆæ¯ç›‘æ§</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RabbitMQMonitor</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RabbitAdmin rabbitAdmin;
    
    <span class="hljs-meta">@Scheduled(fixedRate = 30000)</span> <span class="hljs-comment">// æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">monitorUnackedMessages</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Properties</span> <span class="hljs-variable">queueProps</span> <span class="hljs-operator">=</span> rabbitAdmin.getQueueProperties(<span class="hljs-string">"your_queue"</span>);
        <span class="hljs-keyword">if</span> (queueProps != <span class="hljs-literal">null</span>) {
            <span class="hljs-type">int</span> <span class="hljs-variable">unackedCount</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) queueProps.get(<span class="hljs-string">"QUEUE_MESSAGE_UNACKNOWLEDGED"</span>);
            <span class="hljs-type">int</span> <span class="hljs-variable">readyCount</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) queueProps.get(<span class="hljs-string">"QUEUE_MESSAGE_COUNT"</span>);
            
            <span class="hljs-comment">// å‘Šè­¦æ¡ä»¶</span>
            <span class="hljs-keyword">if</span> (unackedCount &gt; <span class="hljs-number">10</span>) {
                logger.warn(<span class="hljs-string">"Unacked æ¶ˆæ¯è¿‡å¤š: {}"</span>, unackedCount);
                sendAlert(<span class="hljs-string">"RabbitMQ Unacked æ¶ˆæ¯å‘Šè­¦"</span>, 
                         String.format(<span class="hljs-string">"å½“å‰Unackedæ¶ˆæ¯: %d, Readyæ¶ˆæ¯: %d"</span>, 
                                     unackedCount, readyCount));
            }
            
            <span class="hljs-comment">// é•¿æœŸä¸å‡å°‘çš„ Unacked æ¶ˆæ¯</span>
            <span class="hljs-keyword">if</span> (unackedCount &gt; <span class="hljs-number">0</span>) {
                checkStuckMessages();
            }
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">checkStuckMessages</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰é•¿æ—¶é—´å¤„äº Unacked çŠ¶æ€çš„æ¶ˆæ¯</span>
        <span class="hljs-comment">// å¯ä»¥é€šè¿‡è®°å½•æ¶ˆæ¯è¿›å…¥ Unacked çŠ¶æ€çš„æ—¶é—´æ¥åˆ¤æ–­</span>
    }
}
</code></pre>
<h5 data-id="heading-32">4.4.2 æ¶ˆè´¹è€…å¥åº·æ£€æŸ¥</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConsumerHealthCheck</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">AtomicLong</span> <span class="hljs-variable">lastProcessTime</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicLong</span>(System.currentTimeMillis());
    
    <span class="hljs-meta">@RabbitListener(queues = "health_check_queue")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(Message message, Channel channel)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-keyword">try</span> {
            processMessage(message);
            channel.basicAck(message.getMessageProperties().getDeliveryTag(), <span class="hljs-literal">false</span>);
            lastProcessTime.set(System.currentTimeMillis());
        } <span class="hljs-keyword">catch</span> (Exception e) {
            channel.basicNack(message.getMessageProperties().getDeliveryTag(), <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);
        }
    }
    
    <span class="hljs-keyword">public</span> Health <span class="hljs-title function_">health</span><span class="hljs-params">()</span> {
        <span class="hljs-type">long</span> <span class="hljs-variable">lastTime</span> <span class="hljs-operator">=</span> lastProcessTime.get();
        <span class="hljs-type">long</span> <span class="hljs-variable">currentTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
        
        <span class="hljs-keyword">if</span> (currentTime - lastTime &gt; <span class="hljs-number">300000</span>) { <span class="hljs-comment">// 5åˆ†é’Ÿæ— æ´»åŠ¨</span>
            <span class="hljs-keyword">return</span> Health.down()
                    .withDetail(<span class="hljs-string">"lastProcessTime"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(lastTime))
                    .withDetail(<span class="hljs-string">"inactiveDuration"</span>, currentTime - lastTime)
                    .build();
        }
        
        <span class="hljs-keyword">return</span> Health.up()
                .withDetail(<span class="hljs-string">"lastProcessTime"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(lastTime))
                .build();
    }
}
</code></pre>
<h3 data-id="heading-33">äº”ã€ç´§æ€¥å¤„ç†æªæ–½</h3>
<h4 data-id="heading-34">5.1 é‡å¯æ¶ˆè´¹è€…åº”ç”¨</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å½“å‘ç°å¤§é‡ Unacked æ¶ˆæ¯ä¸å‡å°‘æ—¶çš„ç´§æ€¥å¤„ç†</span>
<span class="hljs-comment"># 1. åœæ­¢æ¶ˆè´¹è€…</span>
./stop-consumer.sh

<span class="hljs-comment"># 2. ç­‰å¾…å‡ ç§’è®©è¿æ¥å®Œå…¨å…³é—­</span>
<span class="hljs-built_in">sleep</span> 5

<span class="hljs-comment"># 3. é‡æ–°å¯åŠ¨æ¶ˆè´¹è€…</span>
./start-consumer.sh

<span class="hljs-comment"># è¿™æ ·æ‰€æœ‰ Unacked æ¶ˆæ¯ä¼šé‡æ–°å˜ä¸º Ready çŠ¶æ€</span>
</code></pre>
<h4 data-id="heading-35">5.2 é€šè¿‡ç®¡ç†ç•Œé¢å¤„ç†</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// é€šè¿‡ RabbitMQ HTTP API å¼ºåˆ¶å–æ¶ˆæ¶ˆè´¹è€…è¿æ¥</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmergencyHandler</span> {
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">forceCloseConnection</span><span class="hljs-params">(String connectionName)</span> {
        <span class="hljs-comment">// è°ƒç”¨ RabbitMQ ç®¡ç†APIå…³é—­æŒ‡å®šè¿æ¥</span>
        <span class="hljs-comment">// è¿™æ ·è¯¥è¿æ¥ä¸‹çš„æ‰€æœ‰ Unacked æ¶ˆæ¯ä¼šé‡æ–°å…¥é˜Ÿ</span>
    }
}
</code></pre>
<h3 data-id="heading-36">å…­ã€æ€»ç»“</h3>
<p>Unacked æ¶ˆæ¯æ²¡æœ‰é‡æ–°å…¥é˜Ÿé€šå¸¸è¡¨æ˜æ¶ˆè´¹è€…å¤„äº"å‡æ­»"çŠ¶æ€â€”â€”è¿æ¥ä¿æŒæ´»è·ƒä½†å®é™…å·²æ— æ³•æ­£å¸¸å¤„ç†æ¶ˆæ¯ã€‚è¿™ç§æƒ…å†µæ¯”æ¶ˆè´¹è€…å®Œå…¨å´©æºƒæ›´å±é™©ï¼Œå› ä¸º RabbitMQ ä¼šä¸€ç›´ç­‰å¾…ç¡®è®¤ã€‚
<strong>å…³é”®é¢„é˜²æªæ–½ï¼š</strong></p>
<ul>
<li>è®¾ç½®åˆç†çš„è¶…æ—¶æœºåˆ¶Â - é¿å…æ— é™æœŸç­‰å¾…</li>
<li>ä¼˜åŒ– Prefetch CountÂ - é¿å…è¿‡å¤šæ¶ˆæ¯è¢«å•ä¸ªæ¶ˆè´¹è€…å ç”¨</li>
<li>å®Œå–„å¼‚å¸¸å¤„ç†Â - ç¡®ä¿æ‰€æœ‰è·¯å¾„éƒ½æœ‰ç¡®è®¤æ“ä½œ</li>
<li>å®æ–½ç›‘æ§å‘Šè­¦Â - åŠæ—¶å‘ç°å¤„ç†åœæ»é…</li>
<li>ç½®æ­»ä¿¡é˜Ÿåˆ—Â - å¤„ç†æ— æ³•æ­£å¸¸æ¶ˆè´¹çš„æ¶ˆæ¯</li>
</ul>
<p>é€šè¿‡ä»¥ä¸Šæªæ–½ï¼Œå¯ä»¥å¤§å¤§é™ä½ Unacked æ¶ˆæ¯å †ç§¯çš„é£é™©ï¼Œæ„å»ºæ›´åŠ å¥å£®å¯é çš„æ¶ˆæ¯å¤„ç†ç³»ç»Ÿã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>