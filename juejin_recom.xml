<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[Flutterç»„ä»¶å°è£…ï¼šè§†é¢‘æ’­æ”¾ç»„ä»¶å…¨å±€å°è£…]]></title>    <link>https://juejin.cn/post/7588028859540291610</link>    <guid>https://juejin.cn/post/7588028859540291610</guid>    <pubDate>2025-12-26T12:52:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588028859540291610" data-draft-id="7582777037864190002" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Flutterç»„ä»¶å°è£…ï¼šè§†é¢‘æ’­æ”¾ç»„ä»¶å…¨å±€å°è£…"/> <meta itemprop="keywords" content="å‰ç«¯,Flutter"/> <meta itemprop="datePublished" content="2025-12-26T12:52:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SoaringHeart"/> <meta itemprop="url" content="https://juejin.cn/user/3544481219481374"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Flutterç»„ä»¶å°è£…ï¼šè§†é¢‘æ’­æ”¾ç»„ä»¶å…¨å±€å°è£…
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3544481219481374/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SoaringHeart
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T12:52:52.000Z" title="Fri Dec 26 2025 12:52:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    21
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€éœ€æ±‚æ¥æº</h2>
<p>æœ€è¿‘è¦å¼€å‘ä¸€ä¸ªåœ¨çº¿è§†é¢‘æ’­æ”¾çš„åŠŸèƒ½ï¼Œæ¯æ¬¡å®æ—¶è·å–æ’­æ”¾ï¼Œæœ‰äº›å¡é¡¿å’Œåˆå§‹åŒ–æ…¢çš„é—®é¢˜ï¼Œå°±éšæ‰‹ä¼˜åŒ–ä¸€ä¸‹ã€‚</p>
<h2 data-id="heading-1">äºŒã€ä½¿ç”¨ç¤ºä¾‹</h2>
<p>1ã€æ•°æ®æº</p>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VideoDetailsProvider</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ChangeNotifier</span> </span>{

    <span class="hljs-comment">/// å½“å‰æ’­æ”¾ä¸­çš„</span>
    <span class="hljs-keyword">final</span> _videoModelController = <span class="hljs-type">StreamController</span>&lt;<span class="hljs-type">VideoDetailModel</span>?&gt;.broadcast();

    <span class="hljs-comment">/// å½“å‰æ’­æ”¾ä¸­ Stream&lt;VideoDetailModel&gt;</span>
    <span class="hljs-type">Stream</span>&lt;<span class="hljs-type">VideoDetailModel</span>?&gt; get videoModelStream =&gt; _videoModelController.stream;


    <span class="hljs-comment">/// ç‚¹å‡»ï¼ˆmodelä¸ä¸ºç©ºæ—¶æ’­æ”¾ï¼Œä¸ºç©ºæ—¶å…³é—­ï¼‰</span>
    sinkModelForVideoPlayer({required <span class="hljs-type">VideoDetailModel</span>? model}) {
      _videoModelController.add(model);
    }

}
</code></pre>
<p>2ã€æ˜¾ç¤ºæ’­æ”¾å™¨ç»„ä»¶</p>
<pre><code class="hljs language-php" lang="php">StreamBuilder&lt;VideoDetailModel<span class="hljs-meta">?&gt;</span>(
  stream: provider.videoModelStream,
  builder: (context, snapshot) {
    <span class="hljs-keyword">if</span> (snapshot.data == <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SizedBox</span>();
    }
    <span class="hljs-keyword">final</span> model = snapshot.data;
    <span class="hljs-keyword">if</span> (model?.isVideo != <span class="hljs-literal">true</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SizedBox</span>();
    }

    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">SafeArea</span>(
      <span class="hljs-attr">top</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">bottom</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">left</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">right</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Container</span>(
        <span class="hljs-attr">decoration</span>: <span class="hljs-title function_ invoke__">BoxDecoration</span>(
          <span class="hljs-attr">color</span>: Colors.black,
        ),
        <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">AppVideoPlayer</span>(
          <span class="hljs-attr">key</span>: <span class="hljs-title function_ invoke__">Key</span>(model?.url ?? <span class="hljs-string">""</span>),
          <span class="hljs-attr">url</span>: model?.url ?? <span class="hljs-string">""</span>,
          <span class="hljs-attr">onFullScreen</span>: (value) async {
            <span class="hljs-keyword">if</span> (!value) {
              await Future.<span class="hljs-title function_ invoke__">delayed</span>(<span class="hljs-keyword">const</span> <span class="hljs-title function_ invoke__">Duration</span>(<span class="hljs-attr">milliseconds</span>: <span class="hljs-number">300</span>));//ç­‰å¾…æ—‹è½¬å®Œæˆ
              SystemChromeExt.<span class="hljs-title function_ invoke__">changeDeviceOrientation</span>(<span class="hljs-attr">isPortrait</span>: <span class="hljs-literal">true</span>);
            }
          },
          <span class="hljs-attr">onClose</span>: () {
            DLog.<span class="hljs-title function_ invoke__">d</span>(<span class="hljs-string">"close"</span>);
            provider.<span class="hljs-title function_ invoke__">sinkModelForVideoPlayer</span>(<span class="hljs-attr">model</span>: <span class="hljs-literal">null</span>);
          },
        ),
      ),
    );
  },
)
</code></pre>
<h2 data-id="heading-2">ä¸‰ã€æºç </h2>
<h4 data-id="heading-3">1ã€AppVideoPlayer.dart</h4>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">//</span>
<span class="hljs-comment">//  AppVideoPlayer.dart</span>
<span class="hljs-comment">//  flutter_templet_project</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">//  Created by shang on 2025/12/12 18:11.</span>
<span class="hljs-comment">//  Copyright Â© 2025/12/12 shang. All rights reserved.</span>
<span class="hljs-comment">//</span>

<span class="hljs-keyword">import</span> <span class="hljs-string">'package:chewie/chewie.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:flutter/material.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:flutter_templet_project/basicWidget/AppVideoPlayer/AppVideoPlayerService.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:flutter_templet_project/extension/extension_local.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:video_player/video_player.dart'</span>;

<span class="hljs-comment">/// <span class="markdown">æ’­æ”¾å™¨</span></span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppVideoPlayer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-keyword">const</span> AppVideoPlayer({
    <span class="hljs-keyword">super</span>.key,
    <span class="hljs-keyword">this</span>.controller,
    <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.url,
    <span class="hljs-keyword">this</span>.autoPlay = <span class="hljs-keyword">true</span>,
    <span class="hljs-keyword">this</span>.looping = <span class="hljs-keyword">false</span>,
    <span class="hljs-keyword">this</span>.aspectRatio = <span class="hljs-number">16</span> / <span class="hljs-number">9</span>,
    <span class="hljs-keyword">this</span>.isPortrait = <span class="hljs-keyword">true</span>,
    <span class="hljs-keyword">this</span>.fullScreenVN,
    <span class="hljs-keyword">this</span>.onFullScreen,
    <span class="hljs-keyword">this</span>.onClose,
  });

  <span class="hljs-keyword">final</span> AppVideoPlayerController? controller;

  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String</span> url;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">bool</span> autoPlay;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">bool</span> looping;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> aspectRatio;

  <span class="hljs-comment">/// <span class="markdown">è®¾å¤‡æ–¹å‘</span></span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">bool</span> isPortrait;

  <span class="hljs-keyword">final</span> ValueNotifier&lt;<span class="hljs-built_in">bool</span>&gt;? fullScreenVN;

  <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-built_in">Function</span>(<span class="hljs-built_in">bool</span> isFullScreen)? onFullScreen;

  <span class="hljs-keyword">final</span> VoidCallback? onClose;

  <span class="hljs-meta">@override</span>
  State&lt;AppVideoPlayer&gt; createState() =&gt; _AppVideoPlayerState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_AppVideoPlayerState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">AppVideoPlayer</span>&gt; <span class="hljs-title">with</span> <span class="hljs-title">WidgetsBindingObserver</span>, <span class="hljs-title">AutomaticKeepAliveClientMixin</span> </span>{
  VideoPlayerController? _videoController;
  ChewieController? _chewieController;

  <span class="hljs-built_in">Duration</span> position = <span class="hljs-built_in">Duration</span>.zero;

  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> dispose() {
    widget.controller?._detach(<span class="hljs-keyword">this</span>);
    WidgetsBinding.instance.removeObserver(<span class="hljs-keyword">this</span>);
    _onClose();
    <span class="hljs-comment">// ä¸é”€æ¯ VideoPlayerControllerï¼Œè®©å…¨å±€å¤ç”¨</span>
    <span class="hljs-comment">// _chewieController?.dispose();</span>
    <span class="hljs-keyword">super</span>.dispose();
  }

  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> initState() {
    <span class="hljs-keyword">super</span>.initState();
    widget.controller?._attach(<span class="hljs-keyword">this</span>);
    WidgetsBinding.instance.addObserver(<span class="hljs-keyword">this</span>);
    WidgetsBinding.instance.addPostFrameCallback((_) {
      initPlayer();
    });
  }

  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> didChangeAppLifecycleState(AppLifecycleState state) {
    <span class="hljs-keyword">switch</span> (state) {
      <span class="hljs-keyword">case</span> AppLifecycleState.inactive:
      <span class="hljs-keyword">case</span> AppLifecycleState.hidden:
      <span class="hljs-keyword">case</span> AppLifecycleState.paused:
        {
          _chewieController?.pause();
        }
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> AppLifecycleState.detached:
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> AppLifecycleState.resumed:
        {
          _chewieController?.play();
        }
        <span class="hljs-keyword">break</span>;
    }
  }

  Future&lt;<span class="hljs-keyword">void</span>&gt; initPlayer() <span class="hljs-keyword">async</span> {
    <span class="hljs-comment">// DLog.d(widget.url.split("/").last);</span>
    <span class="hljs-keyword">assert</span>(widget.url.startsWith(<span class="hljs-string">"http"</span>), <span class="hljs-string">"url é”™è¯¯"</span>);

    _videoController = <span class="hljs-keyword">await</span> AppVideoPlayerService.instance.getController(widget.url);

    _chewieController?.dispose();
    _chewieController = ChewieController(
      videoPlayerController: _videoController!,
      autoPlay: widget.autoPlay,
      looping: widget.looping,
      aspectRatio: widget.aspectRatio,
      autoInitialize: <span class="hljs-keyword">true</span>,
      allowFullScreen: <span class="hljs-keyword">true</span>,
      allowMuting: <span class="hljs-keyword">false</span>,
      showControlsOnInitialize: <span class="hljs-keyword">false</span>,
      <span class="hljs-comment">// customControls: const AppVideoControls(),</span>
    );

    _chewieController!.addListener(() {
      <span class="hljs-keyword">final</span> isFullScreen = _chewieController!.isFullScreen;
      widget.fullScreenVN?.value = isFullScreen;
      widget.onFullScreen?.call(isFullScreen);
      <span class="hljs-keyword">if</span> (isFullScreen) {
        DLog.d(<span class="hljs-string">"è¿›å…¥å…¨å±"</span>);
      } <span class="hljs-keyword">else</span> {
        DLog.d(<span class="hljs-string">"é€€å‡ºå…¨å±"</span>);
      }
    });
    <span class="hljs-keyword">if</span> (mounted) {
      setState(() {});
    }
  }

  Future&lt;<span class="hljs-keyword">void</span>&gt; _onClose() <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">if</span> (_videoController?.value.isPlaying == <span class="hljs-keyword">true</span>) {
      _videoController?.pause();
    }
  }

  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> didUpdateWidget(<span class="hljs-keyword">covariant</span> AppVideoPlayer oldWidget) {
    <span class="hljs-keyword">super</span>.didUpdateWidget(oldWidget);
    <span class="hljs-keyword">if</span> (oldWidget.url != widget.url) {
      initPlayer();
    }
  }

  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> didChangeDependencies() {
    <span class="hljs-keyword">super</span>.didChangeDependencies();

    <span class="hljs-comment">/// <span class="markdown">ğŸ”¥å±å¹•æ¨ªç«–åˆ‡æ¢æ—¶ rebuild Chewieï¼Œä½†ä¸ rebuild video</span></span>
    DLog.d([MediaQuery.of(context).orientation]);
    <span class="hljs-comment">// setState(() {});</span>
  }

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">super</span>.build(context);
    <span class="hljs-keyword">if</span> (widget.url.startsWith(<span class="hljs-string">"http"</span>) != <span class="hljs-keyword">true</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">const</span> SizedBox();
    }

    <span class="hljs-keyword">if</span> (_chewieController == <span class="hljs-keyword">null</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">const</span> Center(child: CircularProgressIndicator());
    }
    <span class="hljs-comment">// return Chewie(controller: _chewieController!);</span>
    <span class="hljs-keyword">return</span> Stack(
      children: [
        Positioned.fill(
          child: Chewie(
            controller: _chewieController!,
          ),
        ),
        Positioned(
          right: <span class="hljs-number">20</span>,
          top: <span class="hljs-number">10</span>,
          child: Container(
            <span class="hljs-comment">// decoration: BoxDecoration(</span>
            <span class="hljs-comment">//   color: Colors.red,</span>
            <span class="hljs-comment">//   border: Border.all(color: Colors.blue),</span>
            <span class="hljs-comment">// ),</span>
            child: buildCloseBtn(onTap: widget.onClose),
          ),
        ),
      ],
    );
  }

  Widget buildCloseBtn({VoidCallback? onTap}) {
    <span class="hljs-keyword">return</span> GestureDetector(
      behavior: HitTestBehavior.opaque,
      onTap: () {
        DLog.d(<span class="hljs-string">"buildCloseBtn"</span>);
        _onClose();
        <span class="hljs-keyword">if</span> (onTap != <span class="hljs-keyword">null</span>) {
          onTap();
          <span class="hljs-keyword">return</span>;
        }
        Navigator.pop(context);
      },
      child: Container(
        <span class="hljs-comment">// padding: EdgeInsets.all(6),</span>
        <span class="hljs-comment">// decoration: BoxDecoration(</span>
        <span class="hljs-comment">//   color: Colors.black54,</span>
        <span class="hljs-comment">//   shape: BoxShape.circle,</span>
        <span class="hljs-comment">//   border: Border.all(color: Colors.blue),</span>
        <span class="hljs-comment">// ),</span>
        child: <span class="hljs-keyword">const</span> Icon(Icons.close, color: Colors.white, size: <span class="hljs-number">24</span>),
      ),
    );
  }

  <span class="hljs-meta">@override</span>
  <span class="hljs-built_in">bool</span> <span class="hljs-keyword">get</span> wantKeepAlive =&gt; <span class="hljs-keyword">true</span>;
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppVideoPlayerController</span> </span>{
  _AppVideoPlayerState? _anchor;

  <span class="hljs-keyword">void</span> _attach(_AppVideoPlayerState anchor) {
    _anchor = anchor;
  }

  <span class="hljs-keyword">void</span> _detach(_AppVideoPlayerState anchor) {
    <span class="hljs-keyword">if</span> (_anchor == anchor) {
      _anchor = <span class="hljs-keyword">null</span>;
    }
  }

  VideoPlayerController? <span class="hljs-keyword">get</span> videoController {
    <span class="hljs-keyword">assert</span>(_anchor != <span class="hljs-keyword">null</span>);
    <span class="hljs-keyword">return</span> _anchor!._videoController;
  }

  ChewieController? <span class="hljs-keyword">get</span> chewieController {
    <span class="hljs-keyword">assert</span>(_anchor != <span class="hljs-keyword">null</span>);
    <span class="hljs-keyword">return</span> _anchor!._chewieController;
  }
}
</code></pre>
<h4 data-id="heading-4">2ã€AppVideoPlayerService.dart</h4>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">//</span>
<span class="hljs-comment">//  AppVideoPlayerService.dart</span>
<span class="hljs-comment">//  flutter_templet_project</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">//  Created by shang on 2025/12/12 18:10.</span>
<span class="hljs-comment">//  Copyright Â© 2025/12/12 shang. All rights reserved.</span>
<span class="hljs-comment">//</span>

<span class="hljs-keyword">import</span> <span class="hljs-string">'package:flutter_templet_project/extension/extension_local.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:quiver/collection.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:video_player/video_player.dart'</span>;

<span class="hljs-comment">/// <span class="markdown">è§†é¢‘æ’­æ”¾æ§åˆ¶å™¨å…¨å±€ç®¡ç†</span></span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppVideoPlayerService</span> </span>{
  AppVideoPlayerService._();
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> AppVideoPlayerService _instance = AppVideoPlayerService._();
  <span class="hljs-keyword">factory</span> AppVideoPlayerService() =&gt; _instance;
  <span class="hljs-keyword">static</span> AppVideoPlayerService <span class="hljs-keyword">get</span> instance =&gt; _instance;

  <span class="hljs-comment">/// <span class="markdown">æ’­æ”¾å™¨å­—å…¸</span></span>
  LruMap&lt;<span class="hljs-built_in">String</span>, VideoPlayerController&gt; <span class="hljs-keyword">get</span> controllerMap =&gt; _controllerMap;
  <span class="hljs-comment">// final _controllerMap = &lt;String, VideoPlayerController&gt;{};</span>
  <span class="hljs-keyword">final</span> _controllerMap = LruMap&lt;<span class="hljs-built_in">String</span>, VideoPlayerController&gt;(maximumSize: <span class="hljs-number">10</span>);

  <span class="hljs-comment">/// <span class="markdown">æœ€æ–°ä½¿ç”¨æ’­æ”¾å™¨</span></span>
  VideoPlayerController? current;

  <span class="hljs-comment">/// <span class="markdown">æœ‰ç¼“å­˜æ§åˆ¶å™¨</span></span>
  <span class="hljs-built_in">bool</span> hasCtrl({<span class="hljs-keyword">required</span> <span class="hljs-built_in">String</span> url}) =&gt; _controllerMap[url] != <span class="hljs-keyword">null</span>;

  <span class="hljs-comment">/// <span class="markdown">æ˜¯ç½‘ç»œè§†é¢‘</span></span>
  <span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> isVideo(<span class="hljs-built_in">String?</span> url) {
    <span class="hljs-keyword">if</span> (url?.isNotEmpty != <span class="hljs-keyword">true</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
    }

    <span class="hljs-keyword">final</span> videoUri = <span class="hljs-built_in">Uri</span>.tryParse(url!);
    <span class="hljs-keyword">if</span> (videoUri == <span class="hljs-keyword">null</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
    }

    <span class="hljs-keyword">final</span> videoExt = [<span class="hljs-string">'.mp4'</span>, <span class="hljs-string">'.mov'</span>, <span class="hljs-string">'.avi'</span>, <span class="hljs-string">'.wmv'</span>, <span class="hljs-string">'.flv'</span>, <span class="hljs-string">'.mkv'</span>, <span class="hljs-string">'.webm'</span>];
    <span class="hljs-keyword">final</span> ext = url.toLowerCase();
    <span class="hljs-keyword">final</span> result = videoExt.any((e) =&gt; ext.endsWith(e));
    <span class="hljs-keyword">return</span> result;
  }

  <span class="hljs-comment">/// <span class="markdown">è·å– VideoPlayerController</span></span>
  Future&lt;VideoPlayerController?&gt; getController(<span class="hljs-built_in">String</span> url, {<span class="hljs-built_in">bool</span> isLog = <span class="hljs-keyword">false</span>}) <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">assert</span>(url.startsWith(<span class="hljs-string">"http"</span>), <span class="hljs-string">"å¿…é¡»æ˜¯è§†é¢‘é“¾æ¥,è¯·æ£€æŸ¥é“¾æ¥æ˜¯å¦åˆæ³•"</span>);
    <span class="hljs-keyword">final</span> vc = _controllerMap[url];
    <span class="hljs-keyword">if</span> (vc != <span class="hljs-keyword">null</span>) {
      current = vc;
      <span class="hljs-keyword">if</span> (isLog) {
        DLog.d([<span class="hljs-string">"ç¼“å­˜: <span class="hljs-subst">${vc.hashCode}</span>"</span>]);
      }
      <span class="hljs-keyword">return</span> vc;
    }

    <span class="hljs-keyword">final</span> videoUri = <span class="hljs-built_in">Uri</span>.tryParse(url);
    <span class="hljs-keyword">if</span> (videoUri == <span class="hljs-keyword">null</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
    }

    <span class="hljs-keyword">final</span> ctrl = VideoPlayerController.networkUrl(videoUri);
    <span class="hljs-keyword">await</span> ctrl.initialize();
    _controllerMap[url] = ctrl;
    current = ctrl;
    <span class="hljs-keyword">if</span> (isLog) {
      DLog.d([<span class="hljs-string">"æ–°å»º: <span class="hljs-subst">${_controllerMap[url].hashCode}</span>"</span>]);
    }
    <span class="hljs-keyword">return</span> ctrl;
  }

  <span class="hljs-comment">/// <span class="markdown">æ’­æ”¾</span></span>
  Future&lt;<span class="hljs-keyword">void</span>&gt; play({<span class="hljs-keyword">required</span> <span class="hljs-built_in">String</span> url, <span class="hljs-built_in">bool</span> onlyOne = <span class="hljs-keyword">true</span>}) <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">await</span> getController(url);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">final</span> e <span class="hljs-keyword">in</span> _controllerMap.entries) {
      <span class="hljs-keyword">if</span> (e.key == url) {
        <span class="hljs-keyword">if</span> (!e.value.value.isPlaying) {
          e.value.play();
        } <span class="hljs-keyword">else</span> {
          e.value.pause();
        }
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (onlyOne) {
          e.value.pause();
        }
      }
    }
  }

  <span class="hljs-comment">/// <span class="markdown">æš‚åœæ‰€æœ‰è§†é¢‘</span></span>
  <span class="hljs-keyword">void</span> pauseAll() {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">final</span> e <span class="hljs-keyword">in</span> _controllerMap.entries) {
      e.value.pause();
    }
  }

  <span class="hljs-keyword">void</span> dispose(<span class="hljs-built_in">String</span> url) {
    _controllerMap[url]?.dispose();
    _controllerMap.remove(url);
  }

  <span class="hljs-keyword">void</span> disposeAll() {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">final</span> c <span class="hljs-keyword">in</span> _controllerMap.values) {
      c.dispose();
    }
    _controllerMap.clear();
  }
}
</code></pre>
<h2 data-id="heading-5">æœ€åã€æ€»ç»“</h2>
<p>1ã€æ’­æ”¾è§†é¢‘ç»„ä»¶å’Œè§†é¢‘åˆ—è¡¨æ˜¯åˆ†å¼€çš„ï¼Œé€šè¿‡ç›‘å¬ VideoPlayerController ä¿æŒçŠ¶æ€ï¼ˆæ’­æ”¾ï¼Œæš‚åœï¼‰ä¸€è‡´æ€§ï¼Œç±»ä¼¼ç½‘ç»œè§†é¢‘å°çª—å£æ’­æ”¾ã€‚</p>
<p>2ã€é€šè¿‡ AppVideoPlayerService å®ç°å…¨å±€ VideoPlayerController ç¼“å­˜ï¼Œæé«˜åˆå§‹åŒ–åŠ è½½é€Ÿåº¦ã€‚</p>
<p>3ã€é€šè¿‡ quiver çš„ LruMap å®ç°æœ€å¤§ç¼“å­˜æ•°æ§åˆ¶ï¼Œé˜²æ­¢å†…å­˜çˆ†ç‚¸ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fshang1219178163%2Fflutter_templet_project%2Ftree%2Fv3.27.0%2Flib%2FbasicWidget%2FAppVideoPlayer" target="_blank" title="https://github.com/shang1219178163/flutter_templet_project/tree/v3.27.0/lib/basicWidget/AppVideoPlayer" ref="nofollow noopener noreferrer">github</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€å‰ç«¯å­¦ä¹ AIã€‘Pythonç¯å¢ƒæ­å»º]]></title>    <link>https://juejin.cn/post/7588004601393266722</link>    <guid>https://juejin.cn/post/7588004601393266722</guid>    <pubDate>2025-12-27T09:04:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588004601393266722" data-draft-id="7588004601393250338" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€å‰ç«¯å­¦ä¹ AIã€‘Pythonç¯å¢ƒæ­å»º"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-27T09:04:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æ³¥ç§è·èŠ±"/> <meta itemprop="url" content="https://juejin.cn/user/4212984289442030"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€å‰ç«¯å­¦ä¹ AIã€‘Pythonç¯å¢ƒæ­å»º
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4212984289442030/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æ³¥ç§è·èŠ±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T09:04:30.000Z" title="Sat Dec 27 2025 09:04:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">Anacondaï¼šå¤šç‰ˆæœ¬ç¯å¢ƒç®¡ç†å·¥å…·</h2>
<h3 data-id="heading-1">å·¥å…·æ¦‚è¿°</h3>
<p>Anaconda æ˜¯ Python æ•°æ®ç§‘å­¦é¢†åŸŸå¸¸ç”¨çš„ç¯å¢ƒç®¡ç†å·¥å…·ï¼Œå¯å¿«é€Ÿåˆ›å»ºã€åˆ‡æ¢å¤šç‰ˆæœ¬ Python ç¯å¢ƒï¼Œé¿å…ç‰ˆæœ¬å†²çªï¼ŒåŒæ—¶å†…ç½®å¤§é‡ç§‘å­¦è®¡ç®—ä¾èµ–åŒ…ã€‚</p>
<h3 data-id="heading-2">å®‰è£…æ–¹å¼</h3>
<h4 data-id="heading-3">1. ä¸‹è½½æ¸ é“é€‰æ‹©ï¼ˆä¼˜å…ˆé•œåƒæºï¼‰</h4>
<p>å®˜æ–¹ä¸‹è½½æ¸ é“å­˜åœ¨ä¸¤å¤§ç—›ç‚¹ï¼šâ‘  éœ€ç™»å½•è´¦å·æ‰èƒ½ä¸‹è½½ï¼›â‘¡ æœåŠ¡å™¨ä½äºå¢ƒå¤–ï¼Œå›½å†…ä¸‹è½½é€Ÿåº¦ææ…¢ã€‚</p>
<p><strong>æ¨èæ¸ é“</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmirrors.tuna.tsinghua.edu.cn%2Fanaconda%2Farchive%2F" target="_blank" title="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/" ref="nofollow noopener noreferrer">æ¸…åé•œåƒæº</a>ï¼Œæ— éœ€ç™»å½•ï¼Œä¸‹è½½é€Ÿåº¦å¿«ï¼Œèµ„æºä¸å®˜æ–¹åŒæ­¥ã€‚</p>
<h4 data-id="heading-4">2. ç‰ˆæœ¬é€‰æ‹©åŸåˆ™</h4>
<p>æ ¸å¿ƒæ ‡å‡†ï¼šä»¥ã€Œå‘å¸ƒæ—¥æœŸã€ä¸ºåˆ¤æ–­ä¾æ®ï¼Œä¼˜å…ˆé€‰æ‹©æœ€æ–°ç‰ˆæœ¬ï¼Œé¿å…æ—§ç‰ˆæœ¬å­˜åœ¨çš„å…¼å®¹æ€§é”™è¯¯ã€å®‰è£…å¼‚å¸¸ç­‰é—®é¢˜ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b8abfa762ea74bdfb015f629cd3d45ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5rOl56eN6I236Iqx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767431070&amp;x-signature=Ew1mhq2W%2BqyonwoZ9hYuv8ivBGc%3D" alt="" loading="lazy"/></p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šä¸è¦ç›´æ¥é€‰æ‹©ç½‘é¡µæœ€åº•éƒ¨çš„ç‰ˆæœ¬ï¼Œéœ€æŒ‰å‘å¸ƒæ—¥æœŸæ’åºåæŒ‘é€‰æœ€æ–°ç‰ˆã€‚</p>
</blockquote>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šå®˜æ–¹å·²åœæ­¢å‘å¸ƒWindows32ä½çš„è½¯ä»¶</p>
</blockquote>
<h4 data-id="heading-5">3. é…ç½®ç¯å¢ƒå˜é‡</h4>
<p>Anaconda å®‰è£…åéœ€æ‰‹åŠ¨é…ç½®ç¯å¢ƒå˜é‡ï¼Œå¦åˆ™æ— æ³•åœ¨æ§åˆ¶å°ç›´æ¥ä½¿ç”¨ <code>conda</code> å‘½ä»¤ã€‚</p>
<h5 data-id="heading-6">3.1 é…ç½®æ­¥éª¤</h5>
<ol>
<li>è¿›å…¥ç³»ç»Ÿè®¾ç½®ï¼šè®¾ç½® â†’ ç³»ç»Ÿ â†’ å…³äº â†’ é«˜çº§ç³»ç»Ÿè®¾ç½® â†’ ç¯å¢ƒå˜é‡ï¼›</li>
<li>åœ¨ã€Œç³»ç»Ÿå˜é‡ã€ä¸­æ‰¾åˆ° <code>Path</code> å˜é‡ï¼Œç‚¹å‡»ã€Œç¼–è¾‘ã€ï¼›</li>
<li>æ–°å¢ Anaconda ç›¸å…³è·¯å¾„ï¼ˆå‚è€ƒä¸‹æ–¹é»˜è®¤è·¯å¾„ï¼Œéœ€æ ¹æ®å®é™…å®‰è£…ç›®å½•è°ƒæ•´ï¼‰ï¼›</li>
<li>ä¿å­˜é…ç½®ï¼Œé‡å¯æ§åˆ¶å°ä½¿è®¾ç½®ç”Ÿæ•ˆã€‚</li>
</ol>
<h5 data-id="heading-7">3.2 é»˜è®¤ç¯å¢ƒå˜é‡è·¯å¾„ï¼ˆå‚è€ƒï¼‰</h5>
<pre><code class="hljs language-text" lang="text">C:\ProgramData\anaconda3
C:\ProgramData\anaconda3\Scripts
C:\ProgramData\anaconda3\Library\bin
</code></pre>
<h5 data-id="heading-8">3.3 å®‰è£…ä¸é…ç½®éªŒè¯</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹ conda ç‰ˆæœ¬ï¼Œæ­£å¸¸æ˜¾ç¤ºç‰ˆæœ¬å·åˆ™å®‰è£…é…ç½®æˆåŠŸ</span>
conda --version
</code></pre>
<blockquote>
<p><strong>æç¤º</strong>ï¼šè‹¥æç¤ºâ€œconda ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤â€ï¼Œè¯·æ£€æŸ¥ç¯å¢ƒå˜é‡è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼Œæˆ–é‡å¯æ§åˆ¶å°é‡è¯•ã€‚</p>
</blockquote>
<h3 data-id="heading-9">ä½¿ç”¨ç¤ºä¾‹</h3>
<p>Anaconda çš„æ ¸å¿ƒä»·å€¼åœ¨äºç¯å¢ƒçš„åˆ›å»ºã€åˆ‡æ¢ã€ç®¡ç†ï¼Œå»ºè®®ä½¿ç”¨ Anaconda  å†…ç½®å®‰è£…çš„ç•Œé¢åº”ç”¨ Anaconda  Navigatorã€‚</p>
<h2 data-id="heading-10">uvï¼š Python åŒ…ç®¡ç†å™¨</h2>
<h3 data-id="heading-11">å·¥å…·æ¦‚è¿°</h3>
<p>uv ç”± Astral å…¬å¸åŸºäº Rust å¼€å‘ï¼Œå…¼å®¹ pip ä½¿ç”¨ä¹ æƒ¯ï¼Œæ ¸å¿ƒä¼˜åŠ¿ä¸ºã€Œå®‰è£…é€Ÿåº¦æå¿«ã€ã€Œå†…å­˜å ç”¨ä½ã€ã€Œå†…ç½®è™šæ‹Ÿç¯å¢ƒç®¡ç†ã€ï¼Œæ˜¯ pip/venv çš„é«˜æ•ˆæ›¿ä»£æ–¹æ¡ˆï¼Œå¯å¤§å¹…æå‡åŒ…å®‰è£…ä¸é¡¹ç›®ç®¡ç†æ•ˆç‡ã€‚</p>
<h3 data-id="heading-12">å®‰è£…æ–¹å¼</h3>
<h4 data-id="heading-13">1. å®‰è£…æ–¹æ³•ï¼ˆä¼˜å…ˆé•œåƒæºï¼‰</h4>
<p>ç›´æ¥ä»å®˜æ–¹æºå®‰è£…æ˜“å› ç½‘ç»œé—®é¢˜å¯¼è‡´è¶…æ—¶ï¼Œæ¨èä½¿ç”¨å›½å†…é•œåƒæºï¼ŒWindows/macOS/Linux ç³»ç»Ÿé€šç”¨ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ¸…å PyPI é•œåƒå®‰è£…ï¼ˆæ¨èï¼‰</span>
pip3 install uv -i https://pypi.tuna.tsinghua.edu.cn/simple
</code></pre>
<h5 data-id="heading-14">1.1 å®‰è£…éªŒè¯</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹ uv ç‰ˆæœ¬ï¼Œæ­£å¸¸æ˜¾ç¤ºç‰ˆæœ¬å·åˆ™å®‰è£…æˆåŠŸ</span>
uv --version
</code></pre>
<blockquote>
<p><strong>æç¤º</strong>ï¼šè‹¥ Windows ç³»ç»Ÿæç¤ºâ€œuv ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤â€ï¼Œéœ€æ£€æŸ¥ Python çš„ Scripts ç›®å½•ï¼ˆå¦‚ C:\ProgramData\anaconda3\Scriptsï¼‰æ˜¯å¦åŠ å…¥ç¯å¢ƒå˜é‡ï¼Œæˆ–é‡å¯ç»ˆç«¯é‡è¯•ã€‚</p>
</blockquote>
<h3 data-id="heading-15">ä½¿ç”¨ç¤ºä¾‹</h3>
<h4 data-id="heading-16">1. åˆå§‹åŒ–é¡¹ç›®</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆå§‹åŒ–åä¸º project_demo çš„é¡¹ç›®ï¼ˆä¼šè‡ªåŠ¨ç”Ÿæˆ pyproject.toml æ–‡ä»¶ï¼‰</span>
uv init project_demo
</code></pre>
<h4 data-id="heading-17">2. é…ç½®é•œåƒæº</h4>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ <code>pyproject.toml</code> æ–‡ä»¶ä¸­é…ç½® uv é•œåƒæºï¼Œç¡®ä¿åç»­åŒ…å®‰è£…é€Ÿåº¦ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-section">[project]</span>
<span class="hljs-attr">name</span> = <span class="hljs-string">"project_demo"</span>
<span class="hljs-attr">version</span> = <span class="hljs-string">"0.1.0"</span>
<span class="hljs-attr">requires-python</span> = <span class="hljs-string">"&gt;=3.13"</span>  <span class="hljs-comment"># éœ€æ ¹æ®å®é™…ä½¿ç”¨çš„ Python ç‰ˆæœ¬è°ƒæ•´</span>

<span class="hljs-section">[tool.uv]</span>
<span class="hljs-comment"># é…ç½®æ¸…å PyPI é•œåƒæº</span>
<span class="hljs-attr">index-url</span> = <span class="hljs-string">"https://pypi.tuna.tsinghua.edu.cn/simple"</span>
</code></pre>
<blockquote>
<p><strong>æç¤º</strong>ï¼šå…¨å±€å®‰è£…uvæ¨¡å—ï¼Œéœ€è¦ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œcmdçª—å£</p>
</blockquote>
<h4 data-id="heading-18">3.å®‰è£…æ¨¡å—</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£… langchain_openai æ¨¡å—</span>
uv add langchain_openai
</code></pre>
<h2 data-id="heading-19">Ruffï¼šé«˜æ€§èƒ½ä»£ç æ£€æŸ¥ä¸æ ¼å¼åŒ–å·¥å…·</h2>
<h3 data-id="heading-20">å·¥å…·æ¦‚è¿°</h3>
<p>Ruff æ˜¯åŸºäº Rust å¼€å‘çš„ Python ä»£ç æ£€æŸ¥ï¼ˆLinterï¼‰ä¸æ ¼å¼åŒ–ï¼ˆFormatterï¼‰äºŒåˆä¸€å·¥å…·ï¼Œæ ¸å¿ƒä»·å€¼æ˜¯è‡ªåŠ¨åŒ–è§„èŒƒä»£ç é£æ ¼ã€æ£€æµ‹æ½œåœ¨é—®é¢˜ï¼Œæå‡å¼€å‘æ•ˆç‡ä¸ä»£ç è´¨é‡ã€‚</p>
<h3 data-id="heading-21">é…ç½®æ–‡ä»¶ï¼ˆpyproject.tomlï¼‰</h3>
<p>é€šè¿‡é¡¹ç›®æ ¹ç›®å½•çš„ <code>pyproject.toml</code> æ–‡ä»¶è‡ªå®šä¹‰ Ruff è§„åˆ™ï¼Œä¼˜å…ˆçº§é«˜äºé»˜è®¤é…ç½®ï¼Œå¯é€‚é…é¡¹ç›®ä¸“å±è§„èŒƒã€‚</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-section">[project]</span>
<span class="hljs-attr">name</span> = <span class="hljs-string">"project-demo"</span>
<span class="hljs-attr">version</span> = <span class="hljs-string">"0.1.0"</span>
<span class="hljs-attr">requires-python</span> = <span class="hljs-string">"&gt;=3.10"</span>

<span class="hljs-section">[tool.ruff]</span>
<span class="hljs-attr">target-version</span> = <span class="hljs-string">"py310"</span>  <span class="hljs-comment"># é€‚é…çš„ Python ç‰ˆæœ¬ï¼Œä¸ä¸Šæ–¹ä¿æŒä¸€è‡´</span>
<span class="hljs-attr">line-length</span> = <span class="hljs-number">88</span>  <span class="hljs-comment"># ä»£ç è¡Œé•¿åº¦é™åˆ¶ï¼ˆé»˜è®¤ 88ï¼Œç¬¦åˆ PEP8 è§„èŒƒï¼‰</span>

<span class="hljs-section">[tool.ruff.lint]</span>
<span class="hljs-comment"># å¯ç”¨æ ¸å¿ƒè§„åˆ™é›†ï¼ˆæ¨èï¼Œé¿å…è¿‡åº¦æ£€æŸ¥ï¼‰</span>
<span class="hljs-attr">select</span> = [<span class="hljs-string">"E"</span>, <span class="hljs-string">"W"</span>, <span class="hljs-string">"F"</span>, <span class="hljs-string">"I"</span>, <span class="hljs-string">"B"</span>]
<span class="hljs-comment"># ç¦ç”¨ç‰¹å®šè§„åˆ™ï¼ˆæ ¹æ®é¡¹ç›®éœ€æ±‚è°ƒæ•´ï¼Œç¤ºä¾‹ï¼šç¦ç”¨è¡Œé•¿åº¦æ£€æŸ¥ï¼‰</span>
<span class="hljs-attr">disable</span> = [<span class="hljs-string">"E501"</span>]
<span class="hljs-comment"># å¿½ç•¥æ— éœ€æ£€æŸ¥çš„æ–‡ä»¶/ç›®å½•ï¼ˆå¿…é…ç½®ï¼Œé¿å…æ£€æŸ¥å†—ä½™æ–‡ä»¶ï¼‰</span>
<span class="hljs-attr">exclude</span> = [
    <span class="hljs-string">"venv/"</span>,
    <span class="hljs-string">"__pycache__/"</span>,
    <span class="hljs-string">"build/"</span>,
    <span class="hljs-string">"dist/"</span>,
    <span class="hljs-string">".git/"</span>
]

<span class="hljs-section">[tool.ruff.format]</span>
<span class="hljs-attr">line-length</span> = <span class="hljs-number">88</span>  <span class="hljs-comment"># æ ¼å¼åŒ–è¡Œé•¿åº¦ä¸æ£€æŸ¥è§„åˆ™ä¿æŒä¸€è‡´</span>
<span class="hljs-attr">quote-style</span> = <span class="hljs-string">"preserve"</span>  <span class="hljs-comment"># ä¿ç•™åŸæœ‰å¼•å·é£æ ¼ï¼ˆé»˜è®¤ä¼šç»Ÿä¸€ä¸ºåŒå¼•å·ï¼‰</span>
</code></pre>

























<table><thead><tr><th align="left">è§„åˆ™ç±»åˆ«</th><th align="left">å«ä¹‰</th></tr></thead><tbody><tr><td align="left">E/W</td><td align="left">PEP8 è§„èŒƒç›¸å…³é—®é¢˜ï¼ˆå¦‚ç¼©è¿›é”™è¯¯ã€ç©ºæ ¼ç¼ºå¤±ï¼‰</td></tr><tr><td align="left">F</td><td align="left">ä»£ç é€»è¾‘é”™è¯¯ï¼ˆå¦‚æœªå®šä¹‰å˜é‡ã€å‡½æ•°å‚æ•°é”™è¯¯ï¼‰</td></tr><tr><td align="left">I</td><td align="left">å¯¼å…¥ç›¸å…³é—®é¢˜ï¼ˆå¦‚æœªä½¿ç”¨å¯¼å…¥ã€å¯¼å…¥é¡ºåºæ··ä¹±ï¼‰</td></tr><tr><td align="left">B</td><td align="left">æ½œåœ¨ Bug é£é™©ï¼ˆå¦‚ä¸å®‰å…¨çš„æ–­è¨€ã€ç©º except è¯­å¥ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-22">æ§åˆ¶å°é›†æˆ</h3>
<h4 data-id="heading-23">1. ä½¿ç”¨ pip å®‰è£…</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åŸºç¡€å®‰è£…</span>
pip install ruff

<span class="hljs-comment"># å›½å†…é•œåƒæºåŠ é€Ÿå®‰è£…ï¼ˆæ¨èï¼Œè§£å†³ä¸‹è½½æ…¢é—®é¢˜ï¼‰</span>
pip install ruff -i https://pypi.tuna.tsinghua.edu.cn/simple
</code></pre>
<h5 data-id="heading-24">1.1 å®‰è£…éªŒè¯</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹ Ruff ç‰ˆæœ¬ï¼Œæ­£å¸¸æ˜¾ç¤ºç‰ˆæœ¬å·åˆ™å®‰è£…æˆåŠŸ</span>
ruff --version
</code></pre>
<h3 data-id="heading-25">æ§åˆ¶å°ä½¿ç”¨ç¤ºä¾‹</h3>
<p>Ruff çš„æ ¸å¿ƒå‘½ä»¤åˆ†ä¸ºä¸¤ç±»ï¼šã€Œä»£ç æ£€æŸ¥ã€ï¼ˆ<code>ruff check</code>ï¼‰å’Œã€Œä»£ç æ ¼å¼åŒ–ã€ï¼ˆ<code>ruff format</code>ï¼‰ï¼Œåˆ†å·¥æ˜ç¡®ï¼Œé…åˆä½¿ç”¨æ•ˆæœæœ€ä½³ã€‚</p>
<h4 data-id="heading-26">ä»£ç æ ¼å¼åŒ–ï¼ˆruff formatï¼‰</h4>
<p>ä½œç”¨ï¼šè‡ªåŠ¨ä¼˜åŒ–ä»£ç æ ·å¼ï¼Œè§£å†³ç¼©è¿›æ··ä¹±ã€ç©ºæ ¼ç¼ºå¤±ã€è¡Œè¿‡é•¿ç­‰æ ¼å¼é—®é¢˜ï¼Œè®©ä»£ç æ•´æ´ç»Ÿä¸€ã€‚</p>
<h5 data-id="heading-27">åŸºç¡€ç”¨æ³•</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ ¼å¼åŒ–å•ä¸ªæ–‡ä»¶</span>
ruff format main.py

<span class="hljs-comment"># æ ¼å¼åŒ–æŒ‡å®šç›®å½•ï¼ˆé€’å½’å¤„ç†æ‰€æœ‰ .py æ–‡ä»¶ï¼‰</span>
ruff format ./src/

<span class="hljs-comment"># æ ¼å¼åŒ–å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶ï¼ˆæœ€å¸¸ç”¨ï¼‰</span>
ruff format .
</code></pre>
<h5 data-id="heading-28">åªæ£€æŸ¥ä¸ä¿®æ”¹ï¼ˆ--check å‚æ•°ï¼‰</h5>
<p>é€‚ç”¨äºä»£ç æäº¤å‰æ ¡éªŒï¼Œä»…æ£€æµ‹æ ¼å¼é—®é¢˜ï¼Œä¸å®é™…ä¿®æ”¹æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥å•ä¸ªæ–‡ä»¶æ ¼å¼</span>
ruff format --check main.py

<span class="hljs-comment"># æ£€æŸ¥å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶æ ¼å¼</span>
ruff format --check .
</code></pre>
<h4 data-id="heading-29">ä»£ç æ£€æŸ¥ï¼ˆruff checkï¼‰</h4>
<p>ä½œç”¨ï¼šæ£€æµ‹ä»£ç ä¸­çš„é€»è¾‘é”™è¯¯ã€è§„èŒƒè¿è§„ç­‰é—®é¢˜ï¼ˆå¦‚æœªå®šä¹‰å˜é‡ã€æœªä½¿ç”¨å¯¼å…¥ï¼‰ï¼Œä»…æŠ¥å‘Šé—®é¢˜ï¼Œä¸ä¸»åŠ¨ä¿®æ”¹æ–‡ä»¶ã€‚</p>
<h5 data-id="heading-30">åŸºç¡€ç”¨æ³•</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥å•ä¸ªæ–‡ä»¶</span>
ruff check main.py

<span class="hljs-comment"># æ£€æŸ¥å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶</span>
ruff check .
</code></pre>
<h5 data-id="heading-31">è‡ªåŠ¨ä¿®å¤é—®é¢˜ï¼ˆ--fix å‚æ•°ï¼‰</h5>
<p>ä¸€é”®ä¿®å¤æ”¯æŒè‡ªåŠ¨ä¿®å¤çš„é—®é¢˜ï¼ˆå¦‚åˆ é™¤æœªä½¿ç”¨å¯¼å…¥ã€è°ƒæ•´ç¼©è¿›ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è‡ªåŠ¨ä¿®å¤å•ä¸ªæ–‡ä»¶çš„å¯ä¿®å¤é—®é¢˜</span>
ruff check --fix main.py

<span class="hljs-comment"># è‡ªåŠ¨ä¿®å¤å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶çš„å¯ä¿®å¤é—®é¢˜</span>
ruff check --fix .
</code></pre>
<h4 data-id="heading-32">æ ¸å¿ƒå‘½ä»¤åŒºåˆ«å¯¹æ¯”</h4>



































<table><thead><tr><th align="left">å‘½ä»¤</th><th align="left">æ ¸å¿ƒç›®æ ‡</th><th align="left">æ˜¯å¦ä¿®æ”¹æ–‡ä»¶</th><th align="left">å…¸å‹åœºæ™¯</th></tr></thead><tbody><tr><td align="left">ruff format</td><td align="left">è°ƒæ•´ä»£ç æ ·å¼ï¼ˆç¾è§‚åº¦ã€ç»Ÿä¸€æ€§ï¼‰</td><td align="left">âœ… æ˜¯</td><td align="left">æœ¬åœ°å¼€å‘æ—¶ç»Ÿä¸€ä»£ç æ ¼å¼</td></tr><tr><td align="left">ruff format --check</td><td align="left">æ£€æŸ¥æ ¼å¼é—®é¢˜ï¼Œä¸ä¿®å¤</td><td align="left">âŒ å¦</td><td align="left">ä»£ç æäº¤å‰æ ¼å¼åˆè§„æ ¡éªŒ</td></tr><tr><td align="left">ruff check</td><td align="left">æ£€æµ‹ä»£ç é”™è¯¯ã€é€»è¾‘é£é™©</td><td align="left">âŒ å¦</td><td align="left">å¼€å‘ä¸­æ’æŸ¥ä»£ç æ½œåœ¨é—®é¢˜</td></tr><tr><td align="left">ruff check --fix</td><td align="left">ä¿®å¤ä»£ç é”™è¯¯ã€è§„èŒƒè¿è§„é—®é¢˜</td><td align="left">âœ… æ˜¯</td><td align="left">æ‰¹é‡ä¿®å¤é¡¹ç›®ä¸­çš„è¿è§„ä»£ç </td></tr></tbody></table>
<h3 data-id="heading-33">VS Codeç¼–è¾‘å™¨é›†æˆ</h3>
<p>å¯å®ç°ã€Œä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–+è‡ªåŠ¨ä¿®å¤é—®é¢˜ã€ï¼Œæ— éœ€æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤ï¼Œæå‡å¼€å‘æ•ˆç‡ã€‚</p>
<h4 data-id="heading-34">1. å®‰è£… Ruff æ’ä»¶</h4>
<ol>
<li>æ‰“å¼€ VS Codeï¼Œç‚¹å‡»å·¦ä¾§ã€Œæ‰©å±•ã€å›¾æ ‡ã€‚</li>
<li>åœ¨æœç´¢æ¡†è¾“å…¥ã€ŒRuffã€ï¼Œé€‰æ‹©å®˜æ–¹å‡ºå“çš„æ’ä»¶ã€‚</li>
<li>ç‚¹å‡»ã€Œå®‰è£…ã€ï¼Œç­‰å¾…å®‰è£…å®Œæˆã€‚</li>
</ol>
<h4 data-id="heading-35">2. é…ç½®è‡ªåŠ¨ä¿å­˜è§¦å‘</h4>
<ol>
<li>åœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»ºæ–‡ä»¶å¤¹ <code>.vscode</code>ã€‚</li>
<li>åœ¨ <code>.vscode</code> æ–‡ä»¶å¤¹å†…æ–°å»ºæ–‡ä»¶ <code>settings.json</code>ã€‚</li>
<li>å†™å…¥ä»¥ä¸‹é…ç½®ï¼š</li>
</ol>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-comment">// ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–ä»£ç </span>
    <span class="hljs-attr">"editor.formatOnSave"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-comment">// ä¿å­˜æ—¶è‡ªåŠ¨è§¦å‘ä»£ç æ£€æŸ¥ä¿®å¤</span>
    <span class="hljs-attr">"editor.codeActionsOnSave"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"source.fixAll"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"always"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-comment">// å°† Ruff è®¾ç½®ä¸º Python æ–‡ä»¶çš„é»˜è®¤æ ¼å¼åŒ–å·¥å…·</span>
    <span class="hljs-attr">"[python]"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"editor.defaultFormatter"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"charliermarsh.ruff"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>é…ç½®ç”Ÿæ•ˆåï¼Œç¼–è¾‘ Python æ–‡ä»¶å¹¶ä¿å­˜ï¼ˆCtrl+Sï¼‰ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œ Ruff æ ¼å¼åŒ–ä¸å¯ä¿®å¤é—®é¢˜ä¿®å¤ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ«ä¼ ç»Ÿä½æ•ˆï¼AgentRun å¦‚ä½•ç”¨ Serverless + Agent æ‰“é€ ç°ä»£åŒ–çš„èˆ†æƒ…åˆ†æç³»ç»Ÿï¼Ÿ]]></title>    <link>https://juejin.cn/post/7587998744294719494</link>    <guid>https://juejin.cn/post/7587998744294719494</guid>    <pubDate>2025-12-26T10:25:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587998744294719494" data-draft-id="7587998744294424582" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ«ä¼ ç»Ÿä½æ•ˆï¼AgentRun å¦‚ä½•ç”¨ Serverless + Agent æ‰“é€ ç°ä»£åŒ–çš„èˆ†æƒ…åˆ†æç³»ç»Ÿï¼Ÿ"/> <meta itemprop="keywords" content="Agent"/> <meta itemprop="datePublished" content="2025-12-26T10:25:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘äº‘åŸç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3808363977648493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ«ä¼ ç»Ÿä½æ•ˆï¼AgentRun å¦‚ä½•ç”¨ Serverless + Agent æ‰“é€ ç°ä»£åŒ–çš„èˆ†æƒ…åˆ†æç³»ç»Ÿï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808363977648493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘äº‘åŸç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T10:25:17.000Z" title="Fri Dec 26 2025 10:25:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šæ±Ÿæ˜±</p>
<p>èˆ†æƒ…åˆ†ææ˜¯ä¼ä¸šæ„ŸçŸ¥å¸‚åœºè„‰æã€é¢„è­¦å…¬å…³å±æœºçš„â€œå¬è¯Šå™¨â€ï¼Œç„¶è€Œä¼ ç»Ÿçš„èˆ†æƒ…åˆ†æç³»ç»Ÿæ›´åƒæ˜¯ä¸€ä¸ªä¸ªâ€œæ‰‹å·¥ä½œåŠâ€ï¼Œé¢ä¸´æ•°æ®æ”¶é›†æ•ˆç‡ä½ã€åˆ†ææ·±åº¦ä¸å¤Ÿã€å®æ—¶æ€§å·®ç­‰é—®é¢˜ï¼Œç»å¸¸åé¦ˆä¹‹åï¼Œç­‰ä¼ä¸šæ‹¿åˆ°æŠ¥å‘Šæ—¶ï¼Œèˆ†è®ºçƒ­ç‚¹æ—©å·²è½¬ç§»ï¼Œé”™è¿‡æœ€ä½³æ—¶é—´ã€‚è¿™äº›æŒ‘æˆ˜ï¼Œæ­£æ˜¯æ‰€æœ‰èˆ†æƒ…ç³»ç»Ÿå¼€å‘è€…å…±åŒçš„ç—›ç‚¹ã€‚</p>
<p>æœ¬æ–¹æ¡ˆå°†åŸºäºçœŸå®çš„ä»£ç å®ç°ï¼Œå‘æ‚¨ä»‹ç»å¦‚ä½•ä½¿ç”¨å‡½æ•°è®¡ç®— AgentRun å¹³å°ï¼Œæ„å»ºä¸€ä¸ªç°ä»£åŒ–çš„â€œèˆ†æƒ…åˆ†æä¸“å®¶â€ï¼Œ<strong>è¯¥ç³»ç»Ÿä¸ä»…å®ç°äº†ä»æ•°æ®é‡‡é›†åˆ°æŠ¥å‘Šç”Ÿæˆçš„å¯è§†åŒ–ã€å…¨æµç¨‹è‡ªåŠ¨åŒ–ï¼Œæ›´é€šè¿‡æµå¼æ¶æ„ï¼Œè®©æ´å¯Ÿå®æ—¶å‘ˆç°ã€‚</strong></p>
<h2 data-id="heading-0">ç³»ç»Ÿæ¶æ„è®¾è®¡</h2>
<p>æ•´ä¸ªèˆ†æƒ…åˆ†æç³»ç»Ÿé‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡ä»£ç ä¸¥æ ¼æ§åˆ¶æµç¨‹æ‰§è¡Œé¡ºåºï¼Œè€Œéä¾èµ– LLM çš„è‡ªä¸»å†³ç­–ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b2b33e0db21440e8a5e7692c9e80eee4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767349516&amp;x-signature=e17egUD1fN2nxegUH1NiMJ9QW9o%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-1">å¿«é€Ÿä½“éªŒå’Œæ•ˆæœé¢„è§ˆ</h2>
<p>åœ¨æ·±å…¥æŠ€æœ¯ç»†èŠ‚å‰ï¼Œæˆ‘ä»¬å…ˆç›´è§‚æ„Ÿå—ä¸€ä¸‹è¿™å¥—ç³»ç»Ÿçš„æ•ˆæœã€‚é€šè¿‡ AgentRun å¹³å°ï¼Œåªéœ€ç®€å•å‡ æ­¥å³å¯å®Œæˆéƒ¨ç½²ã€‚</p>
<h3 data-id="heading-2">å¿«é€Ÿéƒ¨ç½²</h3>
<p>æ‰“å¼€é˜¿é‡Œäº‘å‡½æ•°è®¡ç®— AgentRun æ¢ç´¢é¡µé¢ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8251150fb8fe44c3b0ce7b9bcca453af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767349516&amp;x-signature=XigYs%2B%2FF2WIkqzNq7XkuS6etzWU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¯ä»¥æ‰¾åˆ°èˆ†æƒ…åˆ†æä¸“å®¶æ¡ˆä¾‹ï¼Œå¹¶ç‚¹å‡»å¡ç‰‡å³ä¸‹è§’è¿›è¡Œéƒ¨ç½²ï¼Œå¡«å†™å®Œæ•´å¯¹åº”çš„å‚æ•°ä¿¡æ¯å³å¯ç‚¹å‡»å³ä¸‹è§’ç¡®å®šåˆ›å»ºæŒ‰é’®ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6e08339566414b16ae6d04f225f5403a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767349516&amp;x-signature=h2f8rKDyFb4nUbxzwjurgt%2Ff8W4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ­¤å¤„éœ€è¦ç¨ç­‰ç‰‡åˆ»ï¼Œåˆ›å»ºå®Œä¹‹åå¯ä»¥çœ‹åˆ°ä½“éªŒåœ°å€ï¼Œä¹Ÿå¯ä»¥è·³è½¬åˆ°è¿è¡Œæ—¶ä¸æ²™ç®±çœ‹åˆ°éƒ¨ç½²å®Œçš„ Agentï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37b6f6d2b3394d4d902053ffa8c127be~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767349516&amp;x-signature=qaaZpWZiU82BqewpWU8nd9M5rRw%3D" alt="å›¾ç‰‡" loading="lazy"/><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f94cdee53e543a49247c8e2bf19ba3a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767349516&amp;x-signature=hKzteXD4wlEFD%2F1wXxPuCxp4i5E%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é¦–é¡µåœ°å€å³å³ä¾§Â <code>main_web</code> åœ°å€ï¼Œç›´æ¥æŸ¥çœ‹çº¿ä¸Šæ•ˆæœï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/04adff44127141059fa20f50a065734b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767349516&amp;x-signature=xBW%2BaqF3Ff%2FS2qrqm%2BPughaIq64%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¹Ÿå¯ä»¥æŸ¥çœ‹è¯¥åº”ç”¨æ¡ˆä¾‹ä»£ç ï¼Œå¹¶è¿›è¡Œåœ¨çº¿äºŒæ¬¡å¼€å‘ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aff65e6b0fbf472383cfea7e62dc41f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767349516&amp;x-signature=Gjct%2BWU%2BX0GtLt0iKi38vEHqzrA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-3">æ•ˆæœä½“éªŒ</h3>
<p>æ‰“å¼€ä½“éªŒåœ°å€ï¼Œå¯ä»¥çœ‹åˆ°èˆ†æƒ…åˆ†æä¸“å®¶é¡µé¢ï¼Œæ­¤æ—¶å¯ä»¥è¾“å…¥ä¸€ä¸ªè¯è¿›è¡Œèˆ†æƒ…åˆ†æï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e85d5f4bb89e4cc49bc5fb2d8bd6c99b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767349516&amp;x-signature=VqRXCcfCOQMNs6tRSPeG8ypMvZQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åˆ†æè¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿä¼šè°ƒç”¨å‡½æ•°è®¡ç®— AgentRun çš„ Sandbox æ²™ç®±ï¼ˆç¡®åˆ‡è¯´æ˜¯åˆ›å»ºçš„æ—¶å€™ï¼Œé€‰æ‹©çš„æµè§ˆå™¨æ²™ç®±ï¼‰ï¼Œå¯ä»¥çœ‹åˆ° AI æ§åˆ¶äº‘ä¸Šçš„æµè§ˆå™¨è¿›è¡Œæ•°æ®æ£€ç´¢ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da85bf3d6e474aeb83af3090b2cbb8e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767349516&amp;x-signature=AtItZdsToxHhYgp9iLLbZ3I%2B8NA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å®Œæˆä¹‹åï¼Œç³»ç»Ÿä¼šæ•´ç†æ‰€æœ‰é‡‡é›†åˆ°çš„æ•°æ®å’Œä¿¡æ¯ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4d657c650fbd4964b94801ac83e67c9e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767349516&amp;x-signature=nBd6IoDZ5%2Bm1yr1Vj8iViXjDiYQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æœ€ç»ˆç”Ÿæˆæ–‡å­—+å›¾è¡¨çš„â€œå¯è§†åŒ–æŠ¥å‘Šâ€ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/41ee44786a594c39a7d3d9a1e6c0ae14~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767349516&amp;x-signature=4ud8UbB2u6GmL0VNgdL3oi%2FlHW8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3eb00b156cc44b8693697aa9034b5a81~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767349516&amp;x-signature=mgJR4KqfHaD9Hzd6NWL0K0Zm0ug%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-4">AgentRun ç›¸æ¯”ä¼ ç»Ÿæ–¹æ¡ˆçš„æ ¸å¿ƒä¼˜åŠ¿</h2>
<h3 data-id="heading-5">å®‰å…¨éš”ç¦»çš„æ‰§è¡Œç¯å¢ƒ</h3>
<p>ä¼ ç»Ÿèˆ†æƒ…ç³»ç»Ÿé€šå¸¸ç›´æ¥åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œçˆ¬è™«ç¨‹åºï¼Œé¢ä¸´ç€å®‰å…¨é£é™©å’Œç¯å¢ƒæ±¡æŸ“é—®é¢˜ã€‚å½“æŸä¸ªç½‘ç«™çš„åçˆ¬æœºåˆ¶è§¦å‘æ—¶ï¼Œå¯èƒ½å½±å“æ•´ä¸ªæœåŠ¡å™¨çš„ç¨³å®šæ€§ã€‚è€Œ AgentRun Sandbox æä¾›äº†å®Œå…¨éš”ç¦»çš„æµè§ˆå™¨ç¯å¢ƒï¼Œå³ä½¿å•ä¸ªé‡‡é›†ä»»åŠ¡å‡ºç°é—®é¢˜ï¼Œä¹Ÿä¸ä¼šå½±å“ç³»ç»Ÿçš„æ•´ä½“è¿è¡Œã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span>Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">create_browser_sandbox</span>() -&gt;Â <span class="hljs-type">Optional</span>[BrowserSandbox]:
Â  Â Â <span class="hljs-string">"""åˆ›å»ºéš”ç¦»çš„æµè§ˆå™¨ç¯å¢ƒï¼Œé¿å…ç¯å¢ƒæ±¡æŸ“"""</span>
Â  Â Â <span class="hljs-keyword">try</span>:
Â  Â  Â  Â  sandbox =Â <span class="hljs-keyword">await</span>Â Sandbox.create_async(
Â  Â  Â  Â  Â  Â  template_type=TemplateType.BROWSER,
Â  Â  Â  Â  Â  Â  template_name=agentrun_browser_sandbox_name,
Â  Â  Â  Â  )
Â  Â  Â  Â  _sandboxes[sandbox.sandbox_id] = sandbox
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â sandbox
Â  Â Â <span class="hljs-keyword">except</span>Â ExceptionÂ <span class="hljs-keyword">as</span>Â e:
Â  Â  Â  Â Â <span class="hljs-comment"># å•ä¸ªSandboxå¤±è´¥ä¸å½±å“å…¶ä»–å®ä¾‹</span>
Â  Â  Â  Â Â <span class="hljs-keyword">raise</span>Â SandboxCreationError(<span class="hljs-string">f"åˆ›å»º Sandbox å¤±è´¥:Â <span class="hljs-subst">{e}</span>"</span>)
</code></pre>
<h3 data-id="heading-6">çœŸå®æµè§ˆå™¨ç¯å¢ƒæ¨¡æ‹Ÿ</h3>
<p>ä¼ ç»Ÿçˆ¬è™«æ–¹æ¡ˆé€šå¸¸ä½¿ç”¨ç®€å•çš„ HTTP è¯·æ±‚åº“ï¼Œå®¹æ˜“è¢«ç°ä»£ç½‘ç«™çš„åçˆ¬æœºåˆ¶è¯†åˆ«å’Œæ‹¦æˆªã€‚AgentRun Sandbox æä¾›çš„æ˜¯çœŸå®çš„ Chrome æµè§ˆå™¨ç¯å¢ƒï¼Œèƒ½å¤Ÿå®Œæ•´æ‰§è¡Œ JavaScriptã€å¤„ç†å¤æ‚çš„é¡µé¢äº¤äº’ï¼Œå¤§å¤§æé«˜äº†æ•°æ®é‡‡é›†çš„æˆåŠŸç‡ã€‚ä»ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œç³»ç»Ÿé€šè¿‡ Playwright è¿æ¥åˆ°çœŸå®çš„ Chrome å®ä¾‹ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">async</span>Â <span class="hljs-keyword">with</span>Â <span class="hljs-title">async_playwright</span>()Â <span class="hljs-keyword">as</span>Â playwright:
Â  Â  browser</span> =Â <span class="hljs-keyword">await</span>Â playwright.chromium.connect_over_cdp(sandbox.get_cdp_url())
Â  Â  context = browser.contexts[<span class="hljs-number">0</span>]Â <span class="hljs-keyword">if</span>Â browser.contextsÂ <span class="hljs-keyword">else</span>Â <span class="hljs-keyword">await</span>Â browser.new_context()
Â  Â  page = context.pages[<span class="hljs-number">0</span>]Â <span class="hljs-keyword">if</span>Â context.pagesÂ <span class="hljs-keyword">else</span>Â <span class="hljs-keyword">await</span>Â context.new_page()
</code></pre>
<h3 data-id="heading-7">å¯è§†åŒ–è°ƒè¯•èƒ½åŠ›</h3>
<p>å‡½æ•°è®¡ç®— AgentRun æœ€ç‹¬ç‰¹çš„ä¼˜åŠ¿æ˜¯æä¾›äº†å®æ—¶çš„ VNC é¢„è§ˆåŠŸèƒ½ï¼Œå¼€å‘è€…å’Œç”¨æˆ·å¯ä»¥å®æ—¶è§‚å¯Ÿæµè§ˆå™¨çš„æ“ä½œè¿‡ç¨‹ã€‚è¿™ç§é€æ˜æ€§åœ¨ä¼ ç»Ÿæ–¹æ¡ˆä¸­æ˜¯æ— æ³•å®ç°çš„ï¼Œå®ƒä¸ä»…æœ‰åŠ©äºè°ƒè¯•å’Œä¼˜åŒ–é‡‡é›†é€»è¾‘ï¼Œè¿˜èƒ½è®©ç”¨æˆ·ç›´è§‚åœ°äº†è§£ç³»ç»Ÿçš„å·¥ä½œçŠ¶æ€ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6f57bcd347d48788a3d988d39013957~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767349516&amp;x-signature=vOQWwMQljnWyZPeKCmaGs0cfHUs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-8">å¼¹æ€§æ‰©å±•å’Œæ•…éšœæ¢å¤</h3>
<p>ä¼ ç»Ÿç³»ç»Ÿåœ¨é¢ä¸´å¤§è§„æ¨¡é‡‡é›†ä»»åŠ¡æ—¶ï¼Œå¾€å¾€éœ€è¦å¤æ‚çš„åˆ†å¸ƒå¼æ¶æ„è®¾è®¡ã€‚è€Œå‡½æ•°è®¡ç®— AgentRun å¤©ç„¶æ”¯æŒå¤š Sandbox å¹¶è¡Œå¤„ç†ï¼Œç³»ç»Ÿå¯ä»¥æ ¹æ®éœ€è¦åŠ¨æ€åˆ›å»ºå’Œé”€æ¯æµè§ˆå™¨å®ä¾‹ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå½“æŸä¸ªå®ä¾‹å‡ºç°æ•…éšœæ—¶ï¼Œç³»ç»Ÿèƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹å¹¶é‡å»ºï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span>Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">recreate_sandbox_if_closed</span>(<span class="hljs-params">sandbox_id:Â <span class="hljs-built_in">str</span>, error_message:Â <span class="hljs-built_in">str</span></span>):
Â  Â Â <span class="hljs-string">"""æ™ºèƒ½æ•…éšœæ£€æµ‹å’Œè‡ªåŠ¨é‡å»ºæœºåˆ¶"""</span>
Â  Â  closed_error_patterns = [
Â  Â  Â  Â Â <span class="hljs-string">"Target page, context or browser has been closed"</span>,
Â  Â  Â  Â Â <span class="hljs-string">"Browser has been closed"</span>,
Â  Â  Â  Â Â <span class="hljs-string">"Connection closed"</span>,
Â  Â  ]
Â  Â  is_closed_error =Â <span class="hljs-built_in">any</span>(pattern.lower()Â <span class="hljs-keyword">in</span>Â error_message.lower()Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">for</span>Â patternÂ <span class="hljs-keyword">in</span>Â closed_error_patterns)
Â  Â Â <span class="hljs-keyword">if</span>Â is_closed_error:
Â  Â  Â  Â Â <span class="hljs-keyword">await</span>Â remove_sandbox(sandbox_id)
Â  Â  Â  Â  new_sandbox =Â <span class="hljs-keyword">await</span>Â create_browser_sandbox()
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â new_sandbox
</code></pre>
<p>AgentRun Sandbox é‡‡ç”¨é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—å®ç°ï¼Œæ”¯æŒç™¾ä¸‡æ²™ç®±æ¨¡æ¿ï¼ˆå‡½æ•°çº§åˆ«ï¼‰å¹¶å‘è¿è¡Œï¼ŒServerless å¼¹æ€§ä¼¸ç¼©ï¼Œæ”¯æŒ 3.5w+ æ²™ç®±/åˆ†é’Ÿï¼Œæ”¯æŒç¼©å®¹åˆ° 0ï¼ŒæŒ‰è¯·æ±‚æ„ŸçŸ¥è°ƒåº¦ã€‚</p>
<h2 data-id="heading-9">åç«¯æ ¸å¿ƒå®ç°</h2>
<h3 data-id="heading-10">Agent å·¥å…·é“¾è®¾è®¡</h3>
<p>ç³»ç»Ÿçš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªåŸºäº PydanticAI çš„æ™ºèƒ½ä½“ï¼Œè¯¥æ™ºèƒ½ä½“åŒ…å«å››ä¸ªå…³é”®å·¥å…·ï¼Œæ¯ä¸ªå·¥å…·è´Ÿè´£èˆ†æƒ…åˆ†æçš„ä¸åŒé˜¶æ®µã€‚Agent çš„è®¾è®¡éµå¾ªä¸¥æ ¼çš„æ‰§è¡Œé¡ºåºï¼Œç¡®ä¿æ•°æ®æ”¶é›†çš„å®Œæ•´æ€§å’Œåˆ†æçš„å‡†ç¡®æ€§ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">opinion_agent</span> = Agent(
Â  Â  agentrun_model,
Â  Â  <span class="hljs-attr">deps_type</span>=StateDeps,
Â  Â  <span class="hljs-attr">system_prompt</span>=<span class="hljs-string">"""ä½ æ˜¯èˆ†æƒ…åˆ†æç³»ç»Ÿçš„æ‰§è¡Œè€…ã€‚
ä½ çš„ä»»åŠ¡æ˜¯æŒ‰ç…§ä»¥ä¸‹ä¸¥æ ¼æµç¨‹æ‰§è¡Œèˆ†æƒ…åˆ†æï¼š
ã€æµç¨‹ã€‘
1. æ”¶åˆ°å…³é”®è¯åï¼Œè°ƒç”¨ collect_data å·¥å…·æ”¶é›†æ•°æ®
2. æ•°æ®æ”¶é›†å®Œæˆåï¼Œè°ƒç”¨ analyze_data å·¥å…·åˆ†ææ•°æ®
3. åˆ†æå®Œæˆåï¼Œè°ƒç”¨ write_report å·¥å…·æ’°å†™æŠ¥å‘Š
4. æŠ¥å‘Šå®Œæˆåï¼Œè°ƒç”¨ render_html å·¥å…·ç”Ÿæˆ HTML
ã€é‡è¦è§„åˆ™ã€‘
- å¿…é¡»æŒ‰é¡ºåºè°ƒç”¨å·¥å…·
- æ¯ä¸ªå·¥å…·åªè°ƒç”¨ä¸€æ¬¡
- ä¸è¦è·³è¿‡ä»»ä½•æ­¥éª¤
- ä¸è¦ç¼–é€ æ•°æ®
"""</span>,
Â  Â  <span class="hljs-attr">retries</span>=<span class="hljs-number">3</span>,
)
</code></pre>
<h3 data-id="heading-11">æµå¼è¾“å‡ºä¸å®æ—¶åé¦ˆ</h3>
<p>ä¼ ç»Ÿèˆ†æƒ…ç³»ç»Ÿé€šå¸¸é‡‡ç”¨æ‰¹å¤„ç†æ¨¡å¼ï¼Œç”¨æˆ·éœ€è¦ç­‰å¾…å¾ˆé•¿æ—¶é—´æ‰èƒ½çœ‹åˆ°ç»“æœã€‚è€ŒåŸºäºå‡½æ•°è®¡ç®— AgentRun çš„ç³»ç»Ÿå®ç°äº†çœŸæ­£çš„æµå¼è¾“å‡ºï¼Œç”¨æˆ·å¯ä»¥å®æ—¶è§‚å¯Ÿæ¯ä¸ªå¤„ç†æ­¥éª¤çš„è¿›å±•ã€‚è¿™ç§å®æ—¶æ€§ä¸ä»…æå‡äº†ç”¨æˆ·ä½“éªŒï¼Œä¹Ÿä¾¿äºåŠæ—¶å‘ç°å’Œè§£å†³é—®é¢˜ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span>Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">push_state_event</span>(<span class="hljs-params">run_id:Â <span class="hljs-built_in">str</span>, state: OpinionState</span>):
Â  Â Â <span class="hljs-string">"""å®æ—¶æ¨é€çŠ¶æ€æ›´æ–°ï¼Œç”¨æˆ·æ— éœ€ç­‰å¾…"""</span>
Â  Â  event = StateSnapshotEvent(
Â  Â  Â  Â Â <span class="hljs-built_in">type</span>=EventType.STATE_SNAPSHOT,
Â  Â  Â  Â  snapshot=state.model_dump(),
Â  Â  Â  Â  timestamp=<span class="hljs-built_in">int</span>(time.time() *Â <span class="hljs-number">1000</span>)
Â  Â  )
Â  Â Â <span class="hljs-keyword">await</span>Â event_manager.push_event(run_id, event)
</code></pre>
<h3 data-id="heading-12">æ™ºèƒ½æ•°æ®è´¨é‡æ§åˆ¶</h3>
<p>ç³»ç»Ÿå®ç°äº†ä¸¥æ ¼çš„æ•°æ®è´¨é‡æ§åˆ¶æœºåˆ¶ï¼Œé€šè¿‡å¤šç»´åº¦è¯„ä¼°ç¡®ä¿æ”¶é›†åˆ°çš„æ•°æ®å…·æœ‰è¾ƒé«˜çš„ç›¸å…³æ€§å’Œä»·å€¼ã€‚è¿™ç§è´¨é‡æ§åˆ¶åœ¨ä¼ ç»Ÿç³»ç»Ÿä¸­å¾€å¾€æ˜¯ç¼ºå¤±çš„ï¼Œå¯¼è‡´å¤§é‡å™ªéŸ³æ•°æ®å½±å“åˆ†æç»“æœã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span>Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">evaluate_relevance</span>(<span class="hljs-params">keyword:Â <span class="hljs-built_in">str</span>, title:Â <span class="hljs-built_in">str</span>, snippet:Â <span class="hljs-built_in">str</span></span>) -&gt;Â <span class="hljs-built_in">float</span>:
Â  Â Â <span class="hljs-string">"""å¤šç»´åº¦ç›¸å…³æ€§è¯„ä¼°ï¼Œç¡®ä¿æ•°æ®è´¨é‡"""</span>
Â  Â  text =Â <span class="hljs-string">f"<span class="hljs-subst">{title}</span>Â <span class="hljs-subst">{snippet}</span>"</span>
Â  Â  text_lower = text.lower()
Â  Â Â <span class="hljs-comment"># æ£€æµ‹å…³é”®è¯åŒ¹é…åº¦</span>
Â  Â  has_chinese_keyword =Â <span class="hljs-built_in">any</span>(<span class="hljs-string">'\u4e00'</span>Â &lt;= char &lt;=Â <span class="hljs-string">'é¿¿'</span>Â <span class="hljs-keyword">for</span>Â charÂ <span class="hljs-keyword">in</span>Â keyword)
Â  Â  result_has_chinese =Â <span class="hljs-built_in">any</span>(<span class="hljs-string">'\u4e00'</span>Â &lt;= char &lt;=Â <span class="hljs-string">'é¿¿'</span>Â <span class="hljs-keyword">for</span>Â charÂ <span class="hljs-keyword">in</span>Â text)
Â  Â Â <span class="hljs-comment"># ä¸­æ–‡å…³é”®è¯å¿…é¡»åœ¨ç»“æœä¸­æœ‰ä¸­æ–‡å†…å®¹</span>
Â  Â Â <span class="hljs-keyword">if</span>Â has_chinese_keywordÂ <span class="hljs-keyword">and</span>Â <span class="hljs-keyword">not</span>Â result_has_chinese:
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-number">0.0</span>
Â  Â Â <span class="hljs-comment"># æ’é™¤æ˜æ˜¾çš„æ— å…³ç½‘ç«™</span>
Â  Â  irrelevant_patterns = [
Â  Â  Â  Â Â <span class="hljs-string">"calculator"</span>,Â <span class="hljs-string">"deepseek"</span>,Â <span class="hljs-string">"chegg"</span>,Â <span class="hljs-string">"stackoverflow"</span>,Â 
Â  Â  Â  Â Â <span class="hljs-string">"ç¿»è¯‘"</span>,Â <span class="hljs-string">"dictionary"</span>,Â <span class="hljs-string">"è¯å…¸"</span>
Â  Â  ]
Â  Â Â <span class="hljs-keyword">if</span>Â <span class="hljs-built_in">any</span>(patternÂ <span class="hljs-keyword">in</span>Â text_lowerÂ <span class="hljs-keyword">for</span>Â patternÂ <span class="hljs-keyword">in</span>Â irrelevant_patterns):
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-number">0.0</span>
Â  Â Â <span class="hljs-comment"># è®¡ç®—ç›¸å…³æ€§å¾—åˆ†</span>
Â  Â  score =Â <span class="hljs-number">0.0</span>
Â  Â Â <span class="hljs-keyword">if</span>Â keywordÂ <span class="hljs-keyword">in</span>Â text:
Â  Â  Â  Â  score +=Â <span class="hljs-number">0.6</span>Â Â <span class="hljs-comment"># åŸºç¡€åˆ†</span>
Â  Â Â <span class="hljs-comment"># æ—¶æ•ˆæ€§åŠ åˆ†</span>
Â  Â  time_keywords = [<span class="hljs-string">"æœ€æ–°"</span>,Â <span class="hljs-string">"ä»Šæ—¥"</span>,Â <span class="hljs-string">"è¿‘æ—¥"</span>,Â <span class="hljs-string">"2024"</span>,Â <span class="hljs-string">"2025"</span>]
Â  Â Â <span class="hljs-keyword">if</span>Â <span class="hljs-built_in">any</span>(tkÂ <span class="hljs-keyword">in</span>Â textÂ <span class="hljs-keyword">for</span>Â tkÂ <span class="hljs-keyword">in</span>Â time_keywords):
Â  Â  Â  Â  score +=Â <span class="hljs-number">0.1</span>
Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-built_in">max</span>(<span class="hljs-number">0.0</span>,Â <span class="hljs-built_in">min</span>(<span class="hljs-number">1.0</span>, score))
</code></pre>
<h2 data-id="heading-13">æ·±åº¦å†…å®¹æŠ“å–æŠ€æœ¯</h2>
<h3 data-id="heading-14">å¹³å°é€‚é…ç­–ç•¥</h3>
<p>ä¸åŒçš„ç¤¾äº¤åª’ä½“å¹³å°å…·æœ‰ä¸åŒçš„é¡µé¢ç»“æ„å’Œå†…å®¹ç»„ç»‡æ–¹å¼ï¼Œä¼ ç»Ÿç³»ç»Ÿå¾€å¾€é‡‡ç”¨ç»Ÿä¸€çš„æŠ“å–ç­–ç•¥ï¼Œå¯¼è‡´æ•°æ®è´¨é‡å‚å·®ä¸é½ã€‚AgentRun ç³»ç»Ÿé’ˆå¯¹ä¸åŒå¹³å°å®ç°äº†å®šåˆ¶åŒ–çš„æŠ“å–é€»è¾‘ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span>Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">explore_page_with_llm</span>(<span class="hljs-params">page, keyword:Â <span class="hljs-built_in">str</span>, url:Â <span class="hljs-built_in">str</span>, source:Â <span class="hljs-built_in">str</span>, initial_content:Â <span class="hljs-built_in">str</span></span>):
Â  Â Â <span class="hljs-string">"""åŸºäºå¹³å°ç‰¹æ€§çš„æ™ºèƒ½å†…å®¹æŠ“å–"""</span>
Â  Â Â <span class="hljs-keyword">if</span>Â <span class="hljs-string">"weibo.com"</span>Â <span class="hljs-keyword">in</span>Â url:
Â  Â  Â  Â Â <span class="hljs-comment"># å¾®åšç‰¹å®šçš„è¯„è®ºå’Œè½¬å‘æŠ“å–</span>
Â  Â  Â  Â  available_actions = [
Â  Â  Â  Â  Â  Â  {<span class="hljs-string">"action"</span>:Â <span class="hljs-string">"view_comments"</span>,Â <span class="hljs-string">"selector"</span>:Â <span class="hljs-string">".WB_feed_expand, [class*='comment']"</span>},
Â  Â  Â  Â  Â  Â  {<span class="hljs-string">"action"</span>:Â <span class="hljs-string">"view_retweets"</span>,Â <span class="hljs-string">"selector"</span>:Â <span class="hljs-string">".WB_feed_expand, [class*='repost']"</span>},
Â  Â  Â  Â  ]
Â  Â Â <span class="hljs-keyword">elif</span>Â <span class="hljs-string">"zhihu.com"</span>Â <span class="hljs-keyword">in</span>Â url:
Â  Â  Â  Â Â <span class="hljs-comment"># çŸ¥ä¹å›ç­”å’Œè¯„è®ºæŠ“å–</span>
Â  Â  Â  Â  available_actions = [
Â  Â  Â  Â  Â  Â  {<span class="hljs-string">"action"</span>:Â <span class="hljs-string">"view_more_answers"</span>,Â <span class="hljs-string">"selector"</span>:Â <span class="hljs-string">".AnswerItem, .List-item"</span>},
Â  Â  Â  Â  Â  Â  {<span class="hljs-string">"action"</span>:Â <span class="hljs-string">"view_comments"</span>,Â <span class="hljs-string">"selector"</span>:Â <span class="hljs-string">".Comments-container, .CommentItem"</span>},
Â  Â  Â  Â  ]
Â  Â Â <span class="hljs-keyword">elif</span>Â <span class="hljs-string">"bilibili.com"</span>Â <span class="hljs-keyword">in</span>Â url:
Â  Â  Â  Â Â <span class="hljs-comment"># Bç«™è§†é¢‘è¯„è®ºæŠ“å–</span>
Â  Â  Â  Â  available_actions = [
Â  Â  Â  Â  Â  Â  {<span class="hljs-string">"action"</span>:Â <span class="hljs-string">"view_comments"</span>,Â <span class="hljs-string">"selector"</span>:Â <span class="hljs-string">".reply-item, .root-reply"</span>},
Â  Â  Â  Â  Â  Â  {<span class="hljs-string">"action"</span>:Â <span class="hljs-string">"view_related"</span>,Â <span class="hljs-string">"selector"</span>:Â <span class="hljs-string">".video-page-card, .recommend-list"</span>},
Â  Â  Â  Â  ]
</code></pre>
<h3 data-id="heading-15">LLM é©±åŠ¨çš„æ™ºèƒ½æ¢ç´¢</h3>
<p>ç³»ç»Ÿåˆ›æ–°æ€§åœ°å¼•å…¥äº† LLM é©±åŠ¨çš„æ™ºèƒ½æ¢ç´¢æœºåˆ¶ï¼Œè®© AI å†³å®šæ˜¯å¦éœ€è¦æ·±å…¥æŠ“å–æŸä¸ªé¡µé¢çš„é¢å¤–å†…å®¹ï¼Œå¦‚è¯„è®ºåŒºã€ç›¸å…³æ¨èç­‰ã€‚è¿™ç§æ™ºèƒ½å†³ç­–å¤§å¤§æé«˜äº†æ•°æ®é‡‡é›†çš„æ•ˆç‡å’Œé’ˆå¯¹æ€§ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span>Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">llm_decide_exploration</span>(<span class="hljs-params">keyword:Â <span class="hljs-built_in">str</span>, page_url:Â <span class="hljs-built_in">str</span>, page_content:Â <span class="hljs-built_in">str</span>, source:Â <span class="hljs-built_in">str</span></span>):
Â  Â Â <span class="hljs-string">"""LLM æ™ºèƒ½å†³ç­–æ˜¯å¦è¿›è¡Œæ·±åº¦æ¢ç´¢"""</span>
Â  Â  prompt =Â <span class="hljs-string">f"""è¯·æ ¹æ®ä»¥ä¸‹ä¿¡æ¯å†³å®šæ˜¯å¦éœ€è¦è¿›ä¸€æ­¥æ¢ç´¢é¡µé¢è·å–æ›´å¤šèˆ†æƒ…æ•°æ®ã€‚
ã€æœç´¢å…³é”®è¯ã€‘<span class="hljs-subst">{keyword}</span>
ã€å½“å‰é¡µé¢ã€‘<span class="hljs-subst">{page_url}</span>
ã€å·²è·å–å†…å®¹é¢„è§ˆã€‘<span class="hljs-subst">{page_content[:<span class="hljs-number">500</span>]}</span>
ã€å†³ç­–æ ‡å‡†ã€‘
1. å¦‚æœå½“å‰å†…å®¹å·²ç»è¶³å¤Ÿä¸°å¯Œï¼Œå¯èƒ½ä¸éœ€è¦è¿›ä¸€æ­¥æ¢ç´¢
2. å¦‚æœæ˜¯å¾®åš/Bç«™ç­‰å¹³å°ï¼Œè¯„è®ºåŒºé€šå¸¸åŒ…å«é‡è¦çš„èˆ†æƒ…ä¿¡æ¯
3. æƒè¡¡æ—¶é—´æˆæœ¬ï¼Œæ¯ä¸ªé¡µé¢æœ€å¤šæ¢ç´¢1-2ä¸ªæ“ä½œ
è¯·è¿”å› JSON æ ¼å¼çš„å†³ç­–ç»“æœã€‚
"""</span>
Â  Â  result =Â <span class="hljs-keyword">await</span>Â explorer.run(prompt)
Â  Â Â <span class="hljs-keyword">return</span>Â json.loads(result.output)
</code></pre>
<h2 data-id="heading-16">å‰ç«¯ VNC é›†æˆå®ç°</h2>
<h3 data-id="heading-17">åŠ¨æ€åº“åŠ è½½æœºåˆ¶</h3>
<p>å‰ç«¯ VNC å®¢æˆ·ç«¯éœ€è¦åŠ¨æ€åŠ è½½ noVNC åº“ï¼Œç³»ç»Ÿå®ç°äº†æ™ºèƒ½çš„åŠ è½½æœºåˆ¶ï¼Œæ”¯æŒæœ¬åœ°èµ„æºå’Œ CDN å›é€€ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">functionÂ loadScript(url) {
Â  Â Â returnÂ newÂ Promise(function(resolve, reject) {
Â  Â  Â  Â Â varÂ <span class="hljs-attr">script</span> =Â document.createElement(<span class="hljs-string">'script'</span>)<span class="hljs-comment">;</span>
Â  Â  Â  Â  <span class="hljs-attr">script.src</span>Â = baseUrl + url<span class="hljs-comment">;</span>
Â  Â  Â  Â  <span class="hljs-attr">script.onload</span>Â = resolve<span class="hljs-comment">;</span>
Â  Â  Â  Â  <span class="hljs-attr">script.onerror</span>Â =Â function() {
Â  Â  Â  Â  Â  Â Â // æœ¬åœ°åŠ è½½å¤±è´¥ï¼Œå°è¯• CDN
Â  Â  Â  Â  Â  Â Â varÂ <span class="hljs-attr">fallbackUrl</span> = url.includes(<span class="hljs-string">'wordcloud'</span>)Â 
Â  Â  Â  Â  Â  Â  Â  Â  ?Â 'https://cdn.jsdelivr.net/npm/echarts-wordcloud@2.1.0/dist/echarts-wordcloud.min.js'
Â  Â  Â  Â  Â  Â  Â  Â  :Â 'https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js'<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â Â varÂ <span class="hljs-attr">fallbackScript</span> =Â document.createElement(<span class="hljs-string">'script'</span>)<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">fallbackScript.src</span>Â = fallbackUrl<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">fallbackScript.onload</span>Â = resolve<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">fallbackScript.onerror</span>Â = reject<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â Â document.head.appendChild(fallbackScript)<span class="hljs-comment">;</span>
Â  Â  Â  Â  }<span class="hljs-comment">;</span>
Â  Â  Â  Â Â document.head.appendChild(script)<span class="hljs-comment">;</span>
Â  Â  })<span class="hljs-comment">;</span>
}
</code></pre>
<h3 data-id="heading-18">å¤šåè®®é€‚é…</h3>
<p>è€ƒè™‘åˆ°éƒ¨ç½²ç¯å¢ƒçš„å¤æ‚æ€§ï¼ŒVNC ç»„ä»¶å®ç°äº† HTTP/HTTPS ç¯å¢ƒä¸‹çš„ WebSocket åè®®è‡ªé€‚åº”ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">const</span>Â adjustWebSocketUrl =Â useCallback((url:Â string):Â stringÂ =&gt;Â {
Â  Â Â <span class="hljs-keyword">const</span>Â isHttps =Â window.location.protocolÂ ===Â <span class="hljs-string">'https:'</span>;
Â  Â Â <span class="hljs-keyword">if</span>Â (!isHttps &amp;&amp; url.startsWith(<span class="hljs-string">'wss://'</span>)) {
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â url.replace(<span class="hljs-string">'wss://'</span>,Â <span class="hljs-string">'ws://'</span>);
Â  Â  }
Â  Â Â <span class="hljs-keyword">if</span>Â (isHttps &amp;&amp; url.startsWith(<span class="hljs-string">'ws://'</span>)) {
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â url.replace(<span class="hljs-string">'ws://'</span>,Â <span class="hljs-string">'wss://'</span>);
Â  Â  }
Â  Â Â <span class="hljs-keyword">return</span>Â url;
}, []);
</code></pre>
<h2 data-id="heading-19">æ™ºèƒ½åˆ†æä¸æŠ¥å‘Šç”Ÿæˆ</h2>
<h3 data-id="heading-20">æ ‡å‡†åŒ–æƒ…æ„Ÿåˆ†æ</h3>
<p>ç³»ç»Ÿå®ç°äº†åŸºäºå…³é”®è¯è¯å…¸çš„æƒ…æ„Ÿåˆ†æç®—æ³•ï¼Œç›¸æ¯”ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œè¿™ç§æ–¹æ³•æ›´åŠ é€æ˜å’Œå¯æ§ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span>Â <span class="hljs-title class_">SentimentStandards</span>:
Â  Â Â <span class="hljs-string">"""æƒ…æ„Ÿå€¾å‘æ ‡å‡†åŒ–è®¡ç®—"""</span>
Â  Â  POSITIVE_KEYWORDS = [
Â  Â  Â  Â Â <span class="hljs-string">"ä¼˜ç§€"</span>,Â <span class="hljs-string">"å“è¶Š"</span>,Â <span class="hljs-string">"åˆ›æ–°"</span>,Â <span class="hljs-string">"é¢†å…ˆ"</span>,Â <span class="hljs-string">"çªç ´"</span>,Â <span class="hljs-string">"æˆåŠŸ"</span>,Â <span class="hljs-string">"èµ"</span>,Â <span class="hljs-string">"å¥½è¯„"</span>,Â <span class="hljs-string">"æ”¯æŒ"</span>,
Â  Â  Â  Â Â <span class="hljs-string">"è®¤å¯"</span>,Â <span class="hljs-string">"æ»¡æ„"</span>,Â <span class="hljs-string">"ä¿¡èµ–"</span>,Â <span class="hljs-string">"æœŸå¾…"</span>,Â <span class="hljs-string">"çœ‹å¥½"</span>,Â <span class="hljs-string">"å€¼å¾—"</span>,Â <span class="hljs-string">"æ¨è"</span>,Â <span class="hljs-string">"å–œæ¬¢"</span>
Â  Â  ]
Â  Â  NEGATIVE_KEYWORDS = [
Â  Â  Â  Â Â <span class="hljs-string">"å·®"</span>,Â <span class="hljs-string">"ç³Ÿç³•"</span>,Â <span class="hljs-string">"å¤±è´¥"</span>,Â <span class="hljs-string">"è½å"</span>,Â <span class="hljs-string">"é—®é¢˜"</span>,Â <span class="hljs-string">"ç¼ºé™·"</span>,Â <span class="hljs-string">"æ‰¹è¯„"</span>,Â <span class="hljs-string">"è´¨ç–‘"</span>,Â <span class="hljs-string">"æ‹…å¿§"</span>,
Â  Â  Â  Â Â <span class="hljs-string">"å¤±æœ›"</span>,Â <span class="hljs-string">"ä¸æ»¡"</span>,Â <span class="hljs-string">"æŠ±æ€¨"</span>,Â <span class="hljs-string">"æŠ•è¯‰"</span>,Â <span class="hljs-string">"å·®è¯„"</span>,Â <span class="hljs-string">"åƒåœ¾"</span>,Â <span class="hljs-string">"éª—å±€"</span>
Â  Â  ]
Â  Â  @<span class="hljs-built_in">staticmethod</span>
Â  Â Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">calculate_sentiment_score</span>(<span class="hljs-params">text:Â <span class="hljs-built_in">str</span></span>) -&gt;Â <span class="hljs-built_in">float</span>:
Â  Â  Â  Â Â <span class="hljs-string">"""è®¡ç®—æƒ…æ„Ÿå¾—åˆ† (-1.0 åˆ° 1.0)"""</span>
Â  Â  Â  Â  positive_count =Â <span class="hljs-built_in">sum</span>(<span class="hljs-number">1</span>Â <span class="hljs-keyword">for</span>Â wordÂ <span class="hljs-keyword">in</span>Â SentimentStandards.POSITIVE_KEYWORDSÂ <span class="hljs-keyword">if</span>Â wordÂ <span class="hljs-keyword">in</span>Â text)
Â  Â  Â  Â  negative_count =Â <span class="hljs-built_in">sum</span>(<span class="hljs-number">1</span>Â <span class="hljs-keyword">for</span>Â wordÂ <span class="hljs-keyword">in</span>Â SentimentStandards.NEGATIVE_KEYWORDSÂ <span class="hljs-keyword">if</span>Â wordÂ <span class="hljs-keyword">in</span>Â text)
Â  Â  Â  Â  total_count = positive_count + negative_count
Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â total_count ==Â <span class="hljs-number">0</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-number">0.0</span>
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â (positive_count - negative_count) / total_count
</code></pre>
<h3 data-id="heading-21">æµå¼æŠ¥å‘Šç”Ÿæˆ</h3>
<p>æŠ¥å‘Šç”Ÿæˆè¿‡ç¨‹é‡‡ç”¨æµå¼è¾“å‡ºï¼Œç”¨æˆ·å¯ä»¥å®æ—¶è§‚å¯ŸæŠ¥å‘Šçš„æ’°å†™è¿‡ç¨‹ï¼Œè¿™ç§ä½“éªŒæ˜¯ä¼ ç»Ÿç³»ç»Ÿæ— æ³•æä¾›çš„ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">asyncÂ withÂ writer.run_stream(report_prompt)Â asÂ result:
Â  Â Â asyncÂ forÂ textÂ inÂ result.stream_text():
Â  Â  Â  Â  <span class="hljs-attr">report_content</span> = text
Â  Â  Â  Â  <span class="hljs-attr">state.report_text</span> = report_content
Â  Â  Â  Â  <span class="hljs-attr">current_time</span> = asyncio.get_event_loop().time()
Â  Â  Â  Â  <span class="hljs-attr">content_delta</span> =Â len(report_content) - last_event_length
Â  Â  Â  Â  <span class="hljs-attr">time_delta</span> = current_time - last_event_time
Â  Â  Â  Â Â <span class="hljs-comment"># æ¯ 100 å­—ç¬¦æˆ–æ¯ 0.3 ç§’å‘é€ä¸€æ¬¡æ›´æ–°</span>
Â  Â  Â  Â Â ifÂ content_delta &gt;=Â 100Â orÂ time_delta &gt;=Â 0.3:
Â  Â  Â  Â  Â  Â Â awaitÂ push_state_event(run_id, state)
</code></pre>
<h2 data-id="heading-22">éƒ¨ç½²ä¸è¿ç»´ä¼˜åŠ¿</h2>
<h3 data-id="heading-23">ç®€åŒ–çš„éƒ¨ç½²æµç¨‹</h3>
<p>ç›¸æ¯”ä¼ ç»Ÿèˆ†æƒ…ç³»ç»Ÿéœ€è¦å¤æ‚çš„åˆ†å¸ƒå¼çˆ¬è™«é›†ç¾¤éƒ¨ç½²ï¼ŒAgentRun ç³»ç»Ÿçš„éƒ¨ç½²ç›¸å¯¹ç®€å•ã€‚åªéœ€è¦é…ç½®å¥½ç¯å¢ƒå˜é‡å’Œ AgentRun Sandbox æ¨¡æ¿ï¼Œç³»ç»Ÿå°±èƒ½è‡ªåŠ¨ç®¡ç†æµè§ˆå™¨å®ä¾‹çš„åˆ›å»ºå’Œé”€æ¯ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ ¸å¿ƒé…ç½®</span>
<span class="hljs-attr">AGENTRUN_MODEL_NAME</span>=your_model_name
<span class="hljs-attr">MODEL_NAME</span>=qwen3-max
<span class="hljs-attr">AGENTRUN_BROWSER_SANDBOX_NAME</span>=your_browser_template
<span class="hljs-attr">TIMEOUT</span>=<span class="hljs-number">180</span>
</code></pre>
<h3 data-id="heading-24">è‡ªåŠ¨åŒ–è¿ç»´èƒ½åŠ›</h3>
<p>ç³»ç»Ÿå†…ç½®äº†å®Œå–„çš„ç›‘æ§å’Œè‡ªæ¢å¤æœºåˆ¶ï¼Œå¤§å¤§é™ä½äº†è¿ç»´å¤æ‚åº¦ã€‚å½“æ£€æµ‹åˆ°å¼‚å¸¸æ—¶ï¼Œç³»ç»Ÿèƒ½å¤Ÿè‡ªåŠ¨é‡å»ºèµ„æºï¼Œä¿è¯æœåŠ¡çš„è¿ç»­æ€§ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># è¿æ¥å¤±è´¥æ—¶è‡ªåŠ¨é‡è¿ï¼ˆæ¯ 10 ç§’å°è¯•ä¸€æ¬¡ï¼‰</span>
useEffect(() =&gt; {
Â  Â Â ifÂ (<span class="hljs-attr">status</span> ===Â <span class="hljs-string">'error'</span>Â &amp;&amp; active &amp;&amp; rfbLoaded) {
Â  Â  Â  Â  <span class="hljs-attr">reconnectTimerRef.current</span> = setTimeout(() =&gt; {
Â  Â  Â  Â  Â  Â  cleanupRfb()<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">lastUrlRef.current</span> =Â null<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  fetchVncUrl(true)<span class="hljs-comment">;</span>
Â  Â  Â  Â  }, RECONNECT_INTERVAL)<span class="hljs-comment">;</span>
Â  Â  }
}, <span class="hljs-section">[status, active, rfbLoaded]</span>)<span class="hljs-comment">;</span>
</code></pre>
<h2 data-id="heading-25">æ€§èƒ½ä¸æ‰©å±•æ€§åˆ†æ</h2>
<h3 data-id="heading-26">å¹¶å‘å¤„ç†èƒ½åŠ›</h3>
<p>ä¼ ç»Ÿç³»ç»Ÿçš„å¹¶å‘èƒ½åŠ›å¾€å¾€å—é™äºå•æœºèµ„æºï¼Œè€Œå‡½æ•°è®¡ç®— AgentRun ç³»ç»Ÿå¯ä»¥æ ¹æ®éœ€è¦åŠ¨æ€åˆ›å»ºå¤šä¸ª Sandbox å®ä¾‹ï¼Œå®ç°çœŸæ­£çš„æ°´å¹³æ‰©å±•ã€‚ç³»ç»Ÿé€šè¿‡å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹å’Œè¿æ¥æ± ç®¡ç†ï¼Œèƒ½å¤Ÿé«˜æ•ˆå¤„ç†å¤§é‡å¹¶å‘è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">uvicorn.run(
Â  Â Â "main:app",
Â  Â  <span class="hljs-attr">host</span>=<span class="hljs-string">"0.0.0.0"</span>,
Â  Â  <span class="hljs-attr">port</span>=<span class="hljs-number">8000</span>,
Â  Â  <span class="hljs-attr">log_level</span>=<span class="hljs-string">"info"</span>,
Â  Â  <span class="hljs-attr">timeout_keep_alive</span>=<span class="hljs-number">120</span>,
Â  Â  <span class="hljs-attr">limit_concurrency</span>=<span class="hljs-number">100</span>, Â <span class="hljs-comment"># æ”¯æŒé«˜å¹¶å‘</span>
)
</code></pre>
<h3 data-id="heading-27">èµ„æºå¼¹æ€§ç®¡ç†</h3>
<p>ç³»ç»Ÿå®ç°äº†æ™ºèƒ½çš„èµ„æºç®¡ç†ç­–ç•¥ï¼Œèƒ½å¤Ÿæ ¹æ®ä»»åŠ¡è´Ÿè½½åŠ¨æ€è°ƒæ•´ Sandbox å®ä¾‹æ•°é‡ã€‚è¿™ç§å¼¹æ€§æ‰©å±•èƒ½åŠ›æ˜¯ä¼ ç»Ÿå›ºå®šæ¶æ„éš¾ä»¥å®ç°çš„ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span>Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">get_all_sandboxes</span>() -&gt;Â <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>,Â <span class="hljs-type">Any</span>]]:
Â  Â Â <span class="hljs-string">"""åŠ¨æ€è·å–æ‰€æœ‰å¯ç”¨çš„Sandboxå®ä¾‹"""</span>
Â  Â  result = []
Â  Â Â <span class="hljs-keyword">async</span>Â <span class="hljs-keyword">with</span>Â _sandbox_lock:
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â sandbox_id, sandboxÂ <span class="hljs-keyword">in</span>Â _sandboxes.items():
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">try</span>:
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># æ£€æŸ¥å®ä¾‹å¥åº·çŠ¶æ€</span>
Â  Â  Â  Â  Â  Â  Â  Â  vnc_url = sandbox.get_vnc_url()
Â  Â  Â  Â  Â  Â  Â  Â  result.append({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"sandbox_id"</span>: sandbox_id,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"vnc_url"</span>: vnc_url,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"active"</span>:Â <span class="hljs-literal">True</span>,
Â  Â  Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">except</span>Â Exception:
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># è‡ªåŠ¨æ¸…ç†å¤±æ•ˆå®ä¾‹</span>
Â  Â  Â  Â  Â  Â  Â  Â  result.append({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"sandbox_id"</span>: sandbox_id,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"active"</span>:Â <span class="hljs-literal">False</span>,
Â  Â  Â  Â  Â  Â  Â  Â  })
Â  Â Â <span class="hljs-keyword">return</span>Â result
</code></pre>
<h2 data-id="heading-28">æ€»ç»“</h2>
<p>åŸºäºå‡½æ•°è®¡ç®— AgentRun æ„å»ºçš„èˆ†æƒ…åˆ†æç³»ç»Ÿå±•ç°äº†ç°ä»£ AI æŠ€æœ¯åœ¨å®é™…ä¸šåŠ¡åœºæ™¯ä¸­çš„å¼ºå¤§åº”ç”¨æ½œåŠ›ã€‚ç›¸æ¯”ä¼ ç»Ÿæ–¹æ¡ˆï¼Œå‡½æ•°è®¡ç®— AgentRun ç³»ç»Ÿåœ¨å®‰å…¨æ€§ã€å¯é æ€§ã€å¯è§‚æµ‹æ€§å’Œæ‰©å±•æ€§æ–¹é¢éƒ½å…·æœ‰æ˜¾è‘—ä¼˜åŠ¿ã€‚</p>
<p>é€šè¿‡éš”ç¦»çš„æµè§ˆå™¨ç¯å¢ƒï¼Œç³»ç»Ÿè§£å†³äº†ä¼ ç»Ÿçˆ¬è™«é¢ä¸´çš„å®‰å…¨é£é™©å’Œç¯å¢ƒæ±¡æŸ“é—®é¢˜ã€‚å®æ—¶çš„ VNC é¢„è§ˆåŠŸèƒ½æä¾›äº†å‰æ‰€æœªæœ‰çš„é€æ˜åº¦ï¼Œè®©å¼€å‘è€…å’Œç”¨æˆ·èƒ½å¤Ÿç›´è§‚åœ°è§‚å¯Ÿç³»ç»Ÿå·¥ä½œçŠ¶æ€ã€‚æ™ºèƒ½çš„æ•…éšœæ£€æµ‹å’Œè‡ªæ¢å¤æœºåˆ¶å¤§å¤§é™ä½äº†è¿ç»´å¤æ‚åº¦ï¼Œè€Œæµå¼è¾“å‡ºè®¾è®¡åˆ™æ˜¾è‘—æå‡äº†ç”¨æˆ·ä½“éªŒã€‚</p>
<p>æ›´é‡è¦çš„æ˜¯ï¼Œå‡½æ•°è®¡ç®— AgentRun ç³»ç»Ÿå°†å¤æ‚çš„èˆ†æƒ…åˆ†æä»»åŠ¡å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œä»å¤šå¹³å°æ•°æ®é‡‡é›†ã€æ·±åº¦å†…å®¹æŠ“å–ã€æ™ºèƒ½æƒ…æ„Ÿåˆ†æåˆ°ä¸“ä¸šæŠ¥å‘Šç”Ÿæˆï¼Œæ•´ä¸ªæµç¨‹æ— éœ€äººå·¥å¹²é¢„ã€‚è¿™ç§ç«¯åˆ°ç«¯çš„è‡ªåŠ¨åŒ–èƒ½åŠ›ï¼Œç»“åˆ AI æŠ€æœ¯çš„æŒç»­è¿›æ­¥ï¼Œå°†ä¸ºä¼ä¸šå’Œæœºæ„çš„èˆ†æƒ…åˆ†æå·¥ä½œå¸¦æ¥é©å‘½æ€§çš„æ”¹å˜ã€‚</p>
<p>æ¬¢è¿åŠ å…¥â€œå‡½æ•°è®¡ç®— AgentRun å®¢æˆ·ç¾¤â€ä¸æˆ‘ä»¬äº¤æµï¼Œé’‰é’‰ç¾¤å·ï¼š134570017218ã€‚</p>
<p><strong>å¿«é€Ÿäº†è§£å‡½æ•°è®¡ç®— AgentRunï¼š</strong></p>
<p><strong>ä¸€å¥è¯ä»‹ç»ï¼š</strong> å‡½æ•°è®¡ç®— AgentRun æ˜¯ä¸€ä¸ªä»¥é«˜ä»£ç ä¸ºæ ¸å¿ƒçš„ä¸€ç«™å¼ Agentic AI åŸºç¡€è®¾æ–½å¹³å°ã€‚ç§‰æŒç”Ÿæ€å¼€æ”¾å’Œçµæ´»ç»„è£…çš„ç†å¿µï¼Œä¸ºä¼ä¸šçº§ Agent åº”ç”¨æä¾›ä»å¼€å‘ã€éƒ¨ç½²åˆ°è¿ç»´çš„å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7333e7a6ace849a3a84cd2cef2836b4f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767349516&amp;x-signature=PGzjK9qak75XL0U0Ax7gSsa1tBw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><em>å‡½æ•°è®¡ç®— AgentRun æ¶æ„å›¾</em></p>
<p>AgentRun è¿è¡Œæ—¶åŸºäºé˜¿é‡Œäº‘å‡½æ•°è®¡ç®— FC æ„å»ºï¼Œç»§æ‰¿äº† Serverless è®¡ç®—æè‡´å¼¹æ€§ã€æŒ‰é‡ä»˜è´¹ã€é›¶è¿ç»´çš„æ ¸å¿ƒä¼˜åŠ¿ã€‚é€šè¿‡æ·±åº¦é›†æˆ AgentScopeã€Langchainã€RAGFlowã€Mem0 ç­‰ä¸»æµå¼€æºç”Ÿæ€ã€‚AgentRun å°† Serverless çš„æè‡´å¼¹æ€§ã€é›¶è¿ç»´å’ŒæŒ‰é‡ä»˜è´¹çš„ç‰¹æ€§ä¸ AI åŸç”Ÿåº”ç”¨åœºæ™¯æ·±åº¦èåˆï¼ŒåŠ©åŠ›ä¼ä¸šå®ç°æˆæœ¬ä¸æ•ˆç‡çš„æè‡´ä¼˜åŒ–ï¼Œå¹³å‡ TCO é™ä½ 60%ã€‚Â </p>
<p>è®©å¼€å‘è€…åªéœ€ä¸“æ³¨äº Agent çš„ä¸šåŠ¡é€»è¾‘åˆ›æ–°ï¼Œæ— éœ€å…³å¿ƒåº•å±‚åŸºç¡€è®¾æ–½ï¼Œè®© Agentic AI çœŸæ­£è¿›å…¥ä¼ä¸šç”Ÿäº§ç¯å¢ƒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JSå¤æ‚å»é‡ä¸€å®šè¦å…ˆæ’åºå—ï¼Ÿæ·±åº¦è§£æä¸æ€§èƒ½å¯¹æ¯”]]></title>    <link>https://juejin.cn/post/7588002126258110470</link>    <guid>https://juejin.cn/post/7588002126258110470</guid>    <pubDate>2025-12-26T09:53:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588002126258110470" data-draft-id="7587995707165442067" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JSå¤æ‚å»é‡ä¸€å®šè¦å…ˆæ’åºå—ï¼Ÿæ·±åº¦è§£æä¸æ€§èƒ½å¯¹æ¯”"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-26T09:53:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Fronty"/> <meta itemprop="url" content="https://juejin.cn/user/588993964030574"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JSå¤æ‚å»é‡ä¸€å®šè¦å…ˆæ’åºå—ï¼Ÿæ·±åº¦è§£æä¸æ€§èƒ½å¯¹æ¯”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993964030574/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Fronty
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T09:53:34.000Z" title="Fri Dec 26 2025 09:53:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">å¼•è¨€</h4>
<p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæ•°ç»„å»é‡æ˜¯JavaScriptä¸­å¸¸è§çš„æ“ä½œã€‚å¯¹äºç®€å•æ•°æ®ç±»å‹ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šæ¯«ä¸çŠ¹è±«åœ°ä½¿ç”¨Setã€‚ä½†å½“é¢å¯¹å¤æ‚å¯¹è±¡æ•°ç»„æ—¶ï¼Œå¾ˆå¤šå¼€å‘è€…ä¼šäº§ç”Ÿç–‘é—®ï¼šå¤æ‚å»é‡ä¸€å®šè¦å…ˆæ’åºå—ï¼Ÿ</p>
<p>è¿™ä¸ªé—®é¢˜èƒŒåå…¶å®éšè—ç€å‡ ä¸ªæ›´æ·±å±‚æ¬¡çš„è€ƒé‡:</p>
<ul>
<li>æ’åºæ˜¯å¦ä¼šå½±å“åŸå§‹æ•°æ®é¡ºåºï¼Ÿ</li>
<li>æ’åºçš„æ€§èƒ½å¼€é”€æ˜¯å¦å€¼å¾—ï¼Ÿ</li>
<li>æ˜¯å¦æœ‰æ›´ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆï¼Ÿ</li>
</ul>
<h4 data-id="heading-1">1. å¸¸è§çš„æ’åºå»é‡æ–¹æ¡ˆ</h4>
<h5 data-id="heading-2">1.1 ä¼ ç»Ÿçš„æ’åºå»é‡æ€è·¯</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å…ˆæ’åºåå»é‡çš„ç»å…¸å†™æ³•</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">sortThenUnique</span>(<span class="hljs-params">arr, key</span>) {
  <span class="hljs-keyword">return</span> arr
    .<span class="hljs-title function_">slice</span>()
    .<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> {
      <span class="hljs-comment">// é¿å…ä¿®æ”¹åŸå§‹æ•°ç»„</span>
      <span class="hljs-keyword">const</span> valueA = key ? a[key] : a;
      <span class="hljs-keyword">const</span> valueB = key ? b[key] : b;
      <span class="hljs-keyword">if</span> (valueA &lt; valueB) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
      <span class="hljs-keyword">if</span> (valueA &gt; valueB) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    })
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item, index, array</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (index === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// ä¿ç•™ç¬¬ä¸€ä¸ªå…ƒç´ </span>
      <span class="hljs-keyword">const</span> value = key ? item[key] : item;
      <span class="hljs-keyword">const</span> prevValue = key ? array[index - <span class="hljs-number">1</span>][key] : array[index - <span class="hljs-number">1</span>];
      <span class="hljs-keyword">return</span> value !== prevValue; <span class="hljs-comment">// ä»…ä¿ç•™ä¸å‰ä¸€ä¸ªå…ƒç´ ä¸åŒçš„å…ƒç´ </span>
    });
}
</code></pre>
<h5 data-id="heading-3">1.2 æ’åºå»é‡çš„ä¼˜ç¼ºç‚¹</h5>
<p><strong>ä¼˜ç‚¹:</strong></p>
<ul>
<li>ä»£ç é€»è¾‘ç›¸å¯¹ç›´è§‚</li>
<li>å¯¹äºå·²æ’åºæˆ–éœ€è¦æ’åºçš„æ•°æ®ï¼Œå¯ä»¥ä¸€æ­¥å®Œæˆ</li>
<li>åœ¨æŸäº›ç®—æ³•é¢˜ä¸­å¯èƒ½æ˜¯å¿…è¦æ­¥éª¤</li>
</ul>
<p><strong>ç¼ºç‚¹:</strong></p>
<ul>
<li>æ—¶é—´å¤æ‚åº¦è‡³å°‘ä¸º O(n log n)</li>
<li>æ”¹å˜äº†åŸå§‹æ•°æ®çš„é¡ºåº</li>
<li>å¯¹äºä¸éœ€è¦æ’åºçš„åœºæ™¯æ˜¯é¢å¤–å¼€é”€</li>
</ul>
<h4 data-id="heading-4">2. ä¸æ’åºçš„å»é‡æ–¹æ¡ˆ</h4>
<h5 data-id="heading-5">2.1 åŸºäºMapçš„ä¿æŒé¡ºåºæ–¹æ¡ˆ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">uniqueByKey</span>(<span class="hljs-params">arr, key</span>) {
  <span class="hljs-keyword">const</span> seen = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  <span class="hljs-keyword">const</span> result = [];

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> arr) {
    <span class="hljs-keyword">const</span> keyValue = item[key];
    <span class="hljs-keyword">if</span> (!seen.<span class="hljs-title function_">has</span>(keyValue)) {
      seen.<span class="hljs-title function_">set</span>(keyValue, <span class="hljs-literal">true</span>);
      result.<span class="hljs-title function_">push</span>(item);
    }
  }
  <span class="hljs-keyword">return</span> result;
}

<span class="hljs-comment">// æ”¯æŒå¤šä¸ªå­—æ®µçš„å¤åˆé”®</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">uniqueByMultipleKeys</span>(<span class="hljs-params">arr, keys</span>) {
  <span class="hljs-keyword">const</span> seen = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
  <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> compositeKey = keys.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> item[key]).<span class="hljs-title function_">join</span>(<span class="hljs-string">"|"</span>);
    <span class="hljs-keyword">if</span> (seen.<span class="hljs-title function_">has</span>(compositeKey)) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    seen.<span class="hljs-title function_">add</span>(compositeKey);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  });
}
</code></pre>
<h5 data-id="heading-6">2.2 åŸºäºå¯¹è±¡çš„ç¼“å­˜æ–¹æ¡ˆ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">uniqueByKeyWithObject</span>(<span class="hljs-params">arr, key</span>) {
  <span class="hljs-keyword">const</span> cache = {};
  <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> keyValue = item[key];
    <span class="hljs-keyword">if</span> (cache[keyValue]) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    cache[keyValue] = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  });
}
</code></pre>
<h5 data-id="heading-7">2.3 åŸºäºè‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°çš„æ–¹æ¡ˆ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">uniqueWithCustomComparator</span>(<span class="hljs-params">arr, comparator</span>) {
  <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">current, index, self</span>) =&gt;</span> {
    <span class="hljs-comment">// æŸ¥æ‰¾ç¬¬ä¸€ä¸ªç›¸åŒå…ƒç´ çš„ä½ç½®</span>
    <span class="hljs-keyword">return</span> self.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> <span class="hljs-title function_">comparator</span>(item, current)) === index;
  });
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> users = [
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> }, <span class="hljs-comment">// é‡å¤</span>
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">26</span> }, <span class="hljs-comment">// IDç›¸åŒä½†å¹´é¾„ä¸åŒ</span>
];

<span class="hljs-keyword">const</span> uniqueUsers = <span class="hljs-title function_">uniqueWithCustomComparator</span>(
  users,
  <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">id</span> === b.<span class="hljs-property">id</span> &amp;&amp; a.<span class="hljs-property">name</span> === b.<span class="hljs-property">name</span>
);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(uniqueUsers);
<span class="hljs-comment">// [ { id: 1, name: 'Alice', age: 25 }, { id: 2, name: 'Bob', age: 30 } ]</span>
</code></pre>
<h4 data-id="heading-8">3. æ€§èƒ½å¯¹æ¯”åˆ†æ</h4>
<h5 data-id="heading-9">3.1 æ—¶é—´å¤æ‚åº¦å¯¹æ¯”</h5>



































<table><thead><tr><th align="left">æ–¹æ³•</th><th align="left">æ—¶é—´å¤æ‚åº¦</th><th align="left">ç©ºé—´å¤æ‚åº¦</th><th align="left">æ˜¯å¦ä¿æŒé¡ºåº</th></tr></thead><tbody><tr><td align="left">æ’åºåå»é‡</td><td align="left">O(n log n)</td><td align="left">O(1) æˆ– O(n)</td><td align="left">å¦</td></tr><tr><td align="left">Mapå»é‡</td><td align="left">O(n)</td><td align="left">O(n)</td><td align="left">æ˜¯</td></tr><tr><td align="left">å¯¹è±¡ç¼“å­˜å»é‡</td><td align="left">O(n)</td><td align="left">O(n)</td><td align="left">æ˜¯</td></tr><tr><td align="left">filter + findIndex</td><td align="left">O(nÂ²)</td><td align="left">O(1)</td><td align="left">æ˜¯</td></tr></tbody></table>
<h5 data-id="heading-10">3.2 å®é™…æ€§èƒ½æµ‹è¯•</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ€§èƒ½æµ‹è¯•ä»£ç ç¤ºä¾‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">generateTestData</span>(<span class="hljs-params">count</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({<span class="hljs-attr">length</span>: count}, <span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> ({
    <span class="hljs-attr">id</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * count / <span class="hljs-number">10</span>), <span class="hljs-comment">// äº§ç”Ÿå¤§é‡é‡å¤</span>
    <span class="hljs-attr">value</span>: <span class="hljs-string">`item-<span class="hljs-subst">${i}</span>`</span>,
    <span class="hljs-attr">data</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()
  }));
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">runPerformanceTest</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> data = <span class="hljs-title function_">generateTestData</span>(<span class="hljs-number">10000</span>);
  
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'Mapå»é‡'</span>);
  <span class="hljs-title function_">uniqueByKey</span>(data, <span class="hljs-string">'id'</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'Mapå»é‡'</span>);
  
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'æ’åºå»é‡'</span>);
  <span class="hljs-title function_">sortThenUnique</span>(data, <span class="hljs-string">'id'</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'æ’åºå»é‡'</span>);
  
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'filter+findIndex'</span>);
  <span class="hljs-title function_">uniqueWithCustomComparator</span>(data, <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">id</span> === b.<span class="hljs-property">id</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'filter+findIndex'</span>);
}
</code></pre>
<p><strong>æµ‹è¯•ç»“æœè¶‹åŠ¿:</strong></p>
<ul>
<li>æ•°æ®é‡&lt;1000ï¼šå„ç§æ–¹æ³•å·®å¼‚ä¸å¤§</li>
<li>æ•°æ®é‡1000-10000ï¼šMapæ–¹æ¡ˆæ˜æ˜¾å ä¼˜</li>
<li>æ•°æ®é‡&gt;10000ï¼šæ’åºæ–¹æ¡ˆå¼€å§‹æ˜¾ç°åŠ£åŠ¿</li>
</ul>
<h4 data-id="heading-11">4. åº”ç”¨åœºæ™¯ä¸é€‰æ‹©å»ºè®®</h4>
<h5 data-id="heading-12">4.1 ä»€ä¹ˆæ—¶å€™åº”è¯¥è€ƒè™‘æ’åºï¼Ÿ</h5>
<h6 data-id="heading-13">1.éœ€è¦æœ‰åºè¾“å‡ºæ—¶</h6>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ—¢è¦å»é‡åˆè¦æŒ‰ç‰¹å®šå­—æ®µæ’åº</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">getSortedUniqueUsers</span> = (<span class="hljs-params">users</span>) =&gt; {
  <span class="hljs-keyword">const</span> uniqueUsers = <span class="hljs-title function_">uniqueByKey</span>(users, <span class="hljs-string">'id'</span>);
  <span class="hljs-keyword">return</span> uniqueUsers.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">name</span>.<span class="hljs-title function_">localeCompare</span>(b.<span class="hljs-property">name</span>));
};
</code></pre>
<h6 data-id="heading-14">2. æ•°æ®æœ¬èº«å°±éœ€è¦æ’åºæ—¶</h6>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¦‚æœä¸šåŠ¡æœ¬æ¥å°±éœ€è¦æ’åºï¼Œå¯ä»¥åˆå¹¶æ“ä½œ</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">processData</span> = (<span class="hljs-params">data</span>) =&gt; {
  <span class="hljs-comment">// å…ˆæ’åºä¾¿äºåç»­å¤„ç†</span>
  data.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">timestamp</span> - b.<span class="hljs-property">timestamp</span>);
  <span class="hljs-comment">// å»é‡</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">uniqueByKey</span>(data, <span class="hljs-string">'id'</span>);
};
</code></pre>
<h6 data-id="heading-15">3.å¤„ç†æµå¼æ•°æ®æ—¶</h6>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å®æ—¶æ•°æ®æµï¼Œéœ€è¦ç»´æŒæœ‰åºçŠ¶æ€</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SortedUniqueCollection</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">key</span> = key;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">seen</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
  }
  
  <span class="hljs-title function_">add</span>(<span class="hljs-params">item</span>) {
    <span class="hljs-keyword">const</span> keyValue = item[<span class="hljs-variable language_">this</span>.<span class="hljs-property">key</span>];
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">seen</span>.<span class="hljs-title function_">has</span>(keyValue)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">seen</span>.<span class="hljs-title function_">add</span>(keyValue);
      <span class="hljs-comment">// æ’å…¥åˆ°æ­£ç¡®ä½ç½®ç»´æŒæœ‰åº</span>
      <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">while</span> (index &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">length</span> &amp;&amp; 
             <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>[index][<span class="hljs-variable language_">this</span>.<span class="hljs-property">key</span>] &lt; keyValue) {
        index++;
      }
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">0</span>, item);
    }
  }
}
</code></pre>
<h5 data-id="heading-16">4.2 ä»€ä¹ˆæ—¶å€™åº”è¯¥é¿å…æ’åºï¼Ÿ</h5>
<h6 data-id="heading-17">1.éœ€è¦ä¿æŒåŸå§‹é¡ºåºæ—¶</h6>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ—¥å¿—è®°å½•ã€æ—¶é—´çº¿æ•°æ®ç­‰</span>
<span class="hljs-keyword">const</span> logEntries = [
  {<span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">time</span>: <span class="hljs-string">'10:00'</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'å¯åŠ¨'</span>},
  {<span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">time</span>: <span class="hljs-string">'10:01'</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'åˆå§‹åŒ–'</span>},
  {<span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">time</span>: <span class="hljs-string">'10:02'</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'å¯åŠ¨'</span>}, <span class="hljs-comment">// é‡å¤</span>
  {<span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">time</span>: <span class="hljs-string">'10:03'</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'è¿è¡Œ'</span>}
];

<span class="hljs-comment">// ä¿æŒæ—¶é—´é¡ºåºå¾ˆé‡è¦ï¼</span>
<span class="hljs-keyword">const</span> uniqueLogs = <span class="hljs-title function_">uniqueByKey</span>(logEntries, <span class="hljs-string">'id'</span>);
</code></pre>
<h6 data-id="heading-18">2.æ€§èƒ½æ•æ„Ÿçš„åº”ç”¨</h6>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å®æ—¶æ¸²æŸ“å¤§é‡æ•°æ®</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">renderItems</span>(<span class="hljs-params">items</span>) {
  <span class="hljs-comment">// ä½¿ç”¨Mapå»é‡é¿å…ä¸å¿…è¦çš„æ’åºå¼€é”€</span>
  <span class="hljs-keyword">const</span> uniqueItems = <span class="hljs-title function_">uniqueByKey</span>(items, <span class="hljs-string">'id'</span>);
  <span class="hljs-comment">// å¿«é€Ÿæ¸²æŸ“</span>
  <span class="hljs-keyword">return</span> uniqueItems.<span class="hljs-title function_">map</span>(renderItem);
}
</code></pre>
<h6 data-id="heading-19">3. æ•°æ®ä¸å¯å˜è¦æ±‚</h6>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// React/Vueç­‰æ¡†æ¶ä¸­ï¼Œé¿å…æ”¹å˜åŸæ•°ç»„</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">DeduplicatedList</span> = (<span class="hljs-params">{ items }</span>) =&gt; {
  <span class="hljs-comment">// ä¸æ”¹å˜åŸå§‹æ•°æ®</span>
  <span class="hljs-keyword">const</span> uniqueItems = <span class="hljs-title function_">useMemo</span>(
    <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">uniqueByKey</span>(items, <span class="hljs-string">'id'</span>),
    [items]
  );
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">List</span> <span class="hljs-attr">items</span>=<span class="hljs-string">{uniqueItems}</span> /&gt;</span></span>;
};
</code></pre>
<h4 data-id="heading-20">5. é«˜çº§æŠ€å·§å’Œä¼˜åŒ–</h4>
<h5 data-id="heading-21">5.1 æƒ°æ€§å»é‡è¿­ä»£å™¨</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span>* <span class="hljs-title function_">uniqueIterator</span>(<span class="hljs-params">arr, getKey</span>) {
  <span class="hljs-keyword">const</span> seen = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> arr) {
    <span class="hljs-keyword">const</span> key = <span class="hljs-title function_">getKey</span>(item);
    <span class="hljs-keyword">if</span> (!seen.<span class="hljs-title function_">has</span>(key)) {
      seen.<span class="hljs-title function_">add</span>(key);
      <span class="hljs-keyword">yield</span> item;
    }
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> data = [...]; <span class="hljs-comment">// å¤§æ•°æ®é›†</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> <span class="hljs-title function_">uniqueIterator</span>(data, <span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> x.<span class="hljs-property">id</span>)) {
  <span class="hljs-comment">// é€ä¸ªå¤„ç†ï¼ŒèŠ‚çœå†…å­˜</span>
  <span class="hljs-title function_">processItem</span>(item);
}
</code></pre>
<h5 data-id="heading-22">5.2 å¢é‡å»é‡</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">IncrementalDeduplicator</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">key</span> = key;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">seen</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-number">0</span>;
  }
  
  <span class="hljs-title function_">add</span>(<span class="hljs-params">items</span>) {
    <span class="hljs-keyword">return</span> items.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> keyValue = item[<span class="hljs-variable language_">this</span>.<span class="hljs-property">key</span>];
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">seen</span>.<span class="hljs-title function_">has</span>(keyValue)) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      }
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">seen</span>.<span class="hljs-title function_">set</span>(keyValue, ++<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>); <span class="hljs-comment">// è®°å½•æ·»åŠ é¡ºåº</span>
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    });
  }
  
  <span class="hljs-title function_">getAddedOrder</span>(<span class="hljs-params">keyValue</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">seen</span>.<span class="hljs-title function_">get</span>(keyValue);
  }
}
</code></pre>
<h5 data-id="heading-23">5.3 å†…å­˜ä¼˜åŒ–ç‰ˆæœ¬</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">memoryEfficientUnique</span>(<span class="hljs-params">arr, key</span>) {
  <span class="hljs-keyword">const</span> seen = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  <span class="hljs-keyword">const</span> result = [];
  
  <span class="hljs-comment">// ä½¿ç”¨WeakMapå¤„ç†å¯¹è±¡é”®</span>
  <span class="hljs-keyword">const</span> weakMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>();
  
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; arr.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> item = arr[i];
    <span class="hljs-keyword">const</span> keyValue = item[key];
    
    <span class="hljs-comment">// å¯¹äºå¯¹è±¡ç±»å‹çš„é”®å€¼ï¼Œä½¿ç”¨WeakMap</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> keyValue === <span class="hljs-string">'object'</span> &amp;&amp; keyValue !== <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">if</span> (!weakMap.<span class="hljs-title function_">has</span>(keyValue)) {
        weakMap.<span class="hljs-title function_">set</span>(keyValue, <span class="hljs-literal">true</span>);
        result.<span class="hljs-title function_">push</span>(item);
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (!seen.<span class="hljs-title function_">has</span>(keyValue)) {
        seen.<span class="hljs-title function_">set</span>(keyValue, <span class="hljs-literal">true</span>);
        result.<span class="hljs-title function_">push</span>(item);
      }
    }
  }
  
  <span class="hljs-keyword">return</span> result;
}
</code></pre>
<h4 data-id="heading-24">6. å®æˆ˜æ¡ˆä¾‹åˆ†æ</h4>
<h5 data-id="heading-25">6.1 ç”µå•†å•†å“å»é‡</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åœºæ™¯ï¼šåˆå¹¶å¤šä¸ªæ¥æºçš„å•†å“æ•°æ®</span>
<span class="hljs-keyword">const</span> productsFromAPI = [...];
<span class="hljs-keyword">const</span> productsFromCache = [...];
<span class="hljs-keyword">const</span> userUploadedProducts = [...];

<span class="hljs-comment">// éœ€æ±‚ï¼šæŒ‰å•†å“SKUå»é‡ï¼Œä¿æŒæœ€æ–°æ•°æ®</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">mergeProducts</span>(<span class="hljs-params">productLists</span>) {
  <span class="hljs-keyword">const</span> merged = [];
  <span class="hljs-keyword">const</span> skuMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  
  <span class="hljs-comment">// æŒ‰ä¼˜å…ˆçº§å¤„ç†ï¼ˆåå¤„ç†çš„ä¼˜å…ˆçº§é«˜ï¼‰</span>
  productLists.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">list</span> =&gt;</span> {
    list.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">product</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> existing = skuMap.<span class="hljs-title function_">get</span>(product.<span class="hljs-property">sku</span>);
      <span class="hljs-keyword">if</span> (!existing || product.<span class="hljs-property">updatedAt</span> &gt; existing.<span class="hljs-property">updatedAt</span>) {
        <span class="hljs-keyword">if</span> (existing) {
          <span class="hljs-comment">// ç§»é™¤æ—§çš„</span>
          <span class="hljs-keyword">const</span> index = merged.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.<span class="hljs-property">sku</span> === product.<span class="hljs-property">sku</span>);
          merged.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
        }
        merged.<span class="hljs-title function_">push</span>(product);
        skuMap.<span class="hljs-title function_">set</span>(product.<span class="hljs-property">sku</span>, product);
      }
    });
  });
  
  <span class="hljs-keyword">return</span> merged;
}
</code></pre>
<h5 data-id="heading-26">6.2 å®æ—¶æ¶ˆæ¯å»é‡</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åœºæ™¯ï¼šèŠå¤©åº”ç”¨æ¶ˆæ¯å»é‡</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageDeduplicator</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">timeWindow = <span class="hljs-number">5000</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timeWindow</span> = timeWindow;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">messageIds</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timestamps</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  }
  
  <span class="hljs-title function_">addMessage</span>(<span class="hljs-params">message</span>) {
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">const</span> { id } = message;
    
    <span class="hljs-comment">// æ¸…ç†è¿‡æœŸè®°å½•</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cleanup</span>(now);
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦é‡å¤</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">messageIds</span>.<span class="hljs-title function_">has</span>(id)) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-comment">// æ·»åŠ æ–°è®°å½•</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">messageIds</span>.<span class="hljs-title function_">add</span>(id);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timestamps</span>.<span class="hljs-title function_">set</span>(id, now);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  
  <span class="hljs-title function_">cleanup</span>(<span class="hljs-params">now</span>) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [id, timestamp] <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">timestamps</span>) {
      <span class="hljs-keyword">if</span> (now - timestamp &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">timeWindow</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">messageIds</span>.<span class="hljs-title function_">delete</span>(id);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">timestamps</span>.<span class="hljs-title function_">delete</span>(id);
      }
    }
  }
}
</code></pre>
<h4 data-id="heading-27">ç»“è®º</h4>
<p>å›åˆ°æœ€åˆçš„é—®é¢˜ï¼šJSå¤æ‚å»é‡ä¸€å®šè¦å…ˆæ’åºå—ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯å¦å®šçš„ã€‚ æ’åºåªæ˜¯ä¼—å¤šå»é‡ç­–ç•¥ä¸­çš„ä¸€ç§ï¼Œè€Œéå¿…éœ€æ­¥éª¤ã€‚</p>
<p><strong>æˆ‘çš„å»ºè®®:</strong></p>
<ol>
<li><strong>é»˜è®¤ä½¿ç”¨Mapæ–¹æ¡ˆ:</strong> å¯¹äºå¤§å¤šæ•°åœºæ™¯ï¼ŒåŸºäºMapæˆ–Setçš„å»é‡æ–¹æ³•åœ¨æ€§èƒ½å’ŒåŠŸèƒ½ä¸Šéƒ½æ˜¯æœ€ä½³é€‰æ‹©ã€‚</li>
<li><strong>æ ¹æ®éœ€æ±‚é€‰æ‹©:</strong></li>
</ol>
<ul>
<li>éœ€è¦ä¿æŒé¡ºåº â†’ ä½¿ç”¨Map</li>
<li>éœ€è¦æ’åºç»“æœ â†’ å…ˆæ’åºæˆ–åæ’åº</li>
<li>æ•°æ®é‡å¾ˆå¤§ â†’ è€ƒè™‘è¿­ä»£å™¨æˆ–æµå¼å¤„ç†</li>
<li>å†…å­˜æ•æ„Ÿ â†’ ä½¿ç”¨WeakMapæˆ–å®šæœŸæ¸…ç†</li>
</ul>
<ol start="3">
<li><strong>è€ƒè™‘å¯è¯»æ€§å’Œç»´æŠ¤æ€§:</strong> æœ‰æ—¶æ¸…æ™°çš„ä»£ç æ¯”å¾®å°çš„æ€§èƒ½ä¼˜åŒ–æ›´é‡è¦ã€‚</li>
<li><strong>è¿›è¡Œå®é™…æµ‹è¯•:</strong> åœ¨æ€§èƒ½å…³é”®è·¯å¾„ä¸Šï¼Œç”¨çœŸå®æ•°æ®æµ‹è¯•ä¸åŒæ–¹æ¡ˆã€‚</li>
</ol>
<p><strong>å®è·µæ€»ç»“:</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é€šç”¨æ¨èæ–¹æ¡ˆ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">deduplicate</span>(<span class="hljs-params">arr, identifier = v =&gt; v</span>) {
  <span class="hljs-keyword">const</span> seen = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
  <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> key = <span class="hljs-keyword">typeof</span> identifier === <span class="hljs-string">'function'</span> 
      ? <span class="hljs-title function_">identifier</span>(item)
      : item[identifier];
    
    <span class="hljs-keyword">if</span> (seen.<span class="hljs-title function_">has</span>(key)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    seen.<span class="hljs-title function_">add</span>(key);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  });
}

<span class="hljs-comment">// éœ€è¦æ’åºæ—¶çš„æ–¹æ¡ˆ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">deduplicateAndSort</span>(<span class="hljs-params">arr, key, sortBy</span>) {
  <span class="hljs-keyword">const</span> unique = <span class="hljs-title function_">deduplicate</span>(arr, key);
  <span class="hljs-keyword">return</span> unique.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> aVal = a[sortBy];
    <span class="hljs-keyword">const</span> bVal = b[sortBy];
    <span class="hljs-keyword">return</span> aVal &lt; bVal ? -<span class="hljs-number">1</span> : aVal &gt; bVal ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>;
  });
}
</code></pre>
<p>è®°ä½ï¼Œæ²¡æœ‰é“¶å¼¹ã€‚æœ€åˆé€‚çš„å»é‡æ–¹æ¡ˆå–å†³äºä½ çš„å…·ä½“éœ€æ±‚ï¼šæ•°æ®è§„æ¨¡ã€é¡ºåºè¦æ±‚ã€æ€§èƒ½éœ€æ±‚å’Œä»£ç ä¸Šä¸‹æ–‡ã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ åœ¨é¢å¯¹å¤æ‚å»é‡é—®é¢˜æ—¶åšå‡ºæ˜æ™ºçš„é€‰æ‹©ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[VueCropperåŠ è½½OBSå›¾ç‰‡è·¨åŸŸé—®é¢˜]]></title>    <link>https://juejin.cn/post/7587743345197465652</link>    <guid>https://juejin.cn/post/7587743345197465652</guid>    <pubDate>2025-12-26T09:30:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587743345197465652" data-draft-id="7587743345197449268" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="VueCropperåŠ è½½OBSå›¾ç‰‡è·¨åŸŸé—®é¢˜"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-26T09:30:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æ³¥ç§è·èŠ±"/> <meta itemprop="url" content="https://juejin.cn/user/4212984289442030"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            VueCropperåŠ è½½OBSå›¾ç‰‡è·¨åŸŸé—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4212984289442030/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æ³¥ç§è·èŠ±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T09:30:22.000Z" title="Fri Dec 26 2025 09:30:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    24
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;color:rgba(46,36,36,.87);overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{margin-bottom:5px;font-size:30px;font-weight:500}.markdown-body h1:before{content:"#";margin-right:10px;color:#1976d2}.markdown-body h2{font-size:28px;font-weight:400;border-left:5px solid #454545;margin-top:20px;padding-left:10px;transition:all .3s ease-in-out}.markdown-body h2:hover{border-color:#1976d2}.markdown-body h3{font-size:24px;font-weight:400;margin-top:15px;padding-bottom:0}.markdown-body h4{font-size:20px;font-weight:500}.markdown-body h5{font-size:16px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h2:first-letter,.markdown-body h3:first-letter,.markdown-body p:first-letter{text-transform:capitalize}.markdown-body em{text-emphasis:dot;text-emphasis-position:under}.markdown-body img{display:block;margin:0 auto!important;max-width:100%;border-radius:2px;box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)!important}.markdown-body hr{position:relative;width:98%;height:1px;border:none;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,#ddd,#999,#ddd);overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background:#fff;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center}.markdown-body code{font-weight:900;word-break:break-word;border-radius:2px;overflow-x:auto;font-size:.87em;padding:.065em .4em;background-color:#fbe5e1;color:#c0341d}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:0 4px}.markdown-body pre&gt;code{font-weight:400;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{margin:0 4px;text-decoration:none;color:#027fff;transition:all .3s ease-in-out;padding-bottom:4px;border-bottom:2px solid transparent}.markdown-body a:after{content:"";display:inline-block;width:18px;height:18px;margin-left:4px;vertical-align:middle;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMjdGRkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PHBhdGggZD0iTTkuODE1IDYuNDQ4bDEuOTM2LTEuOTM2YzEuMzM3LTEuMzM2IDMuNTgtMS4yNTkgNS4wMTMuMTczIDEuNDMyIDEuNDMyIDEuNTEgMy42NzYuMTczIDUuMDEzbC0xLjQ1MiAxLjQ1Mi0uOTY4Ljk2OGMtMS4zMzcgMS4zMzYtMy41ODEgMS4yNTktNS4wMTMtLjE3MyIvPjxwYXRoIGQ9Ik0xMS4yNjcgMTUuMzY3bC0xLjkzNiAxLjkzNmMtMS4zMzYgMS4zMzctMy41OCAxLjI2LTUuMDEyLS4xNzMtMS40MzItMS40MzItMS41MS0zLjY3Ni0uMTczLTUuMDEybDEuNDUyLTEuNDUyLjk2OC0uOTY4YzEuMzM2LTEuMzM3IDMuNTgtMS4yNiA1LjAxMi4xNzMiLz48L2c+PC9zdmc+);background-size:cover;background-repeat:no-repeat}.markdown-body a:hover{border-color:#027fff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body a.footnote-backref:after,.markdown-body a.footnote-ref:after,.markdown-body sup a:after{display:none!important}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border:2px solid #c6c6c6}.markdown-body table img{box-shadow:none!important}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body del{color:rgba(0,0,0,.6)}.markdown-body blockquote{position:relative;color:#666;padding:5px 23px 1px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:hsla(0,0%,78.4%,.12);transition:all .2s ease-in-out}.markdown-body blockquote:hover{border-color:#1976d2}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;font-size:24px;font-weight:800;line-height:24px;color:#cbcbcb;opacity:.6}.markdown-body blockquote:before{content:"â€œ";top:4px;left:6px}.markdown-body blockquote:after{content:"â€";right:8px;bottom:-8px}.markdown-body blockquote&gt;p,.markdown-body blockquote blockquote{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body details{outline:none;border:none;border-left:4px solid #1976d2;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary:hover::-webkit-details-marker{color:#1976d2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é—®é¢˜åœºæ™¯</h2>
<p>åœ¨é›†æˆ <code>VueCropper</code> å›¾ç‰‡è£å‰ªç»„ä»¶æ—¶ï¼Œé‡åˆ°ä¸€ä¸ªå…¸å‹çš„è·¨åŸŸé—®é¢˜ï¼šåŠ è½½å­˜å‚¨åœ¨ OBS ä¸Šçš„å›¾ç‰‡æ—¶ï¼Œæµè§ˆå™¨ä¼šå¯¹åŒä¸€å¼ å›¾ç‰‡å‘èµ·ä¸¤æ¬¡è¯·æ±‚ï¼Œæœ€ç»ˆç¬¬äºŒæ¬¡è¯·æ±‚è§¦å‘è·¨åŸŸé”™è¯¯ã€‚ä»¥ä¸‹æ˜¯é—®é¢˜çš„å®Œæ•´æ’æŸ¥è¿‡ç¨‹ä¸ç°è±¡æ¢³ç†ï¼š</p>
<ol>
<li>è¯·æ±‚è¡Œä¸ºå¼‚å¸¸ï¼šåŒä¸€å¼  OBS å›¾ç‰‡è¢«æµè§ˆå™¨å‘èµ·ä¸¤æ¬¡è¯·æ±‚ï¼Œç¬¬ä¸€æ¬¡è¯·æ±‚æ­£å¸¸å“åº”ï¼Œç¬¬äºŒæ¬¡è¯·æ±‚ç›´æ¥æŠ›å‡ºè·¨åŸŸç›¸å…³é”™è¯¯ï¼ˆå¦‚ <code>CORS policy: No 'Access-Control-Allow-Origin' header</code>ï¼‰ï¼›</li>
<li>åˆæ­¥æ’æŸ¥æ–¹å‘ï¼šåˆæœŸä¼˜å…ˆæ€€ç–‘ OBS æœåŠ¡å™¨è·¨åŸŸé…ç½®ç¼ºå¤±ï¼Œåé¦ˆè¿ç»´æ ¸æŸ¥åï¼Œç¡®è®¤ OBS å·²æ­£ç¡®é…ç½®è·¨åŸŸå…è®¸è§„åˆ™ï¼ˆå«å…è®¸å½“å‰å‰ç«¯åŸŸåã€æ”¯æŒ GET æ–¹æ³•ç­‰ï¼‰ï¼›</li>
<li>å…³é”®æµ‹è¯•çªç ´ï¼šé€šè¿‡æµè§ˆå™¨å¼€å‘è€…å·¥å…·æµ‹è¯•å‘ç°ï¼Œå¼€å¯ã€Œåœç”¨ç¼“å­˜ã€åŠŸèƒ½åï¼Œè·¨åŸŸé”™è¯¯æ¶ˆå¤±ã€‚æ®æ­¤é”å®šé—®é¢˜æ ¹æºä¸æµè§ˆå™¨ç¼“å­˜æœºåˆ¶ç›¸å…³ï¼›</li>
<li>æ ¸å¿ƒå·®å¼‚å®šä½ï¼šå¯¹æ¯”ä¸¤æ¬¡è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯ï¼Œå‘ç°è·¨åŸŸæ ‡è¯†é…ç½®ä¸ä¸€è‡´â€”â€”ç¬¬ä¸€æ¬¡åŠ è½½å›¾ç‰‡æœªè®¾ç½® <code>crossOrigin</code> æ ‡è¯†ï¼Œç¬¬äºŒæ¬¡åŠ è½½æ—¶åˆ™æ·»åŠ äº†è¯¥æ ‡è¯†ï¼›</li>
<li>é—®é¢˜é€»è¾‘é—­ç¯ï¼šç¬¬ä¸€æ¬¡è¯·æ±‚å› æ—  <code>crossOrigin</code> æ ‡è¯†ï¼ŒOBS æœåŠ¡å™¨è¯†åˆ«ä¸ºéè·¨åŸŸè¯·æ±‚ï¼Œæœªè¿”å›è·¨åŸŸå“åº”å¤´ï¼›ç¬¬äºŒæ¬¡è¯·æ±‚è™½å¼€å¯ <code>crossOrigin</code>ï¼Œä½†å› å›¾ç‰‡ URL æœªå˜ï¼Œæµè§ˆå™¨ç›´æ¥å¤ç”¨ç¼“å­˜çš„æ— è·¨åŸŸå“åº”å¤´èµ„æºï¼Œå¯¼è‡´è·¨åŸŸæ ¡éªŒå¤±è´¥ã€‚</li>
</ol>
<h2 data-id="heading-1">é—®é¢˜æ ¹æº</h2>
<p>ä¸ºéªŒè¯ä¸Šè¿°æ’æŸ¥ç»“è®ºï¼Œé€šè¿‡åŸç”Ÿ JavaScript ä»£ç å¤ç°äº†é—®é¢˜åœºæ™¯ï¼Œæœ€ç»ˆç¡®è®¤é—®é¢˜æ ¹æºä¸º <strong>è·¨åŸŸç­–ç•¥ä¸æµè§ˆå™¨ç¼“å­˜å†²çª</strong>ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'DOMContentLoaded'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> image = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();
    <span class="hljs-comment">// ç¬¬ä¸€æ¬¡åŠ è½½ï¼šæœªè®¾ç½® crossOrigin æ ‡è¯†</span>
    image.<span class="hljs-property">src</span> = <span class="hljs-string">'https://xxx.png'</span>; 
    image.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å›¾ç‰‡åŠ è½½å®Œæˆ'</span>);
        <span class="hljs-keyword">const</span> image2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();
        <span class="hljs-comment">// ç¬¬äºŒæ¬¡åŠ è½½ï¼šè®¾ç½®è·¨åŸŸæ ‡è¯†ï¼ˆä¸ç¬¬ä¸€æ¬¡ä¸ä¸€è‡´ï¼‰</span>
        image2.<span class="hljs-property">crossOrigin</span> = <span class="hljs-string">"anonymous"</span>;
        <span class="hljs-comment">// åŠ è½½åŒä¸€å¼ å›¾ç‰‡ï¼Œè§¦å‘è·¨åŸŸé”™è¯¯</span>
        image2.<span class="hljs-property">src</span> = image.<span class="hljs-property">src</span>; 
        image2.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å›¾ç‰‡2åŠ è½½å®Œæˆ'</span>);
        });
    });
});
</code></pre>
<p>è¯¥é—®é¢˜çš„æ ¸å¿ƒçŸ›ç›¾æ˜¯ã€ŒåŒä¸€å¼ å›¾ç‰‡çš„ä¸¤æ¬¡è¯·æ±‚é‡‡ç”¨ä¸ä¸€è‡´çš„è·¨åŸŸç­–ç•¥ã€ï¼Œç»“åˆæµè§ˆå™¨ç¼“å­˜æœºåˆ¶ä¸ OBS æœåŠ¡å™¨çš„è·¨åŸŸå“åº”è§„åˆ™ï¼Œå…·ä½“é”™è¯¯é€»è¾‘å¯æ‹†è§£ä¸ºä¸¤æ­¥ï¼š</p>
<ol>
<li>éè·¨åŸŸæ¨¡å¼ç¼“å­˜ï¼šç¬¬ä¸€æ¬¡åŠ è½½æœªè®¾ç½® <code>crossOrigin</code>ï¼Œæµè§ˆå™¨ä»¥ã€Œéè·¨åŸŸæ¨¡å¼ã€å‘èµ·è¯·æ±‚ï¼ˆè¯·æ±‚å¤´ <code>Sec-Fetch-Mode = no-cors</code>ï¼‰ï¼›OBS æœåŠ¡å™¨è¯†åˆ«è¯¥æ¨¡å¼åï¼Œä¸è¿”å› <code>Access-Control-Allow-Origin</code> ç­‰è·¨åŸŸå“åº”å¤´ï¼Œæµè§ˆå™¨åˆ™å°†è¿™ä»½ã€Œæ— è·¨åŸŸå“åº”å¤´çš„å›¾ç‰‡èµ„æºã€ç¼“å­˜è‡³æœ¬åœ°ï¼›</li>
<li>è·¨åŸŸæ¨¡å¼ç¼“å­˜å†²çªï¼šç¬¬äºŒæ¬¡åŠ è½½è®¾ç½® <code>crossOrigin: "anonymous"</code>ï¼Œæµè§ˆå™¨éœ€ä»¥ã€Œè·¨åŸŸæ¨¡å¼ã€è¯·æ±‚ï¼›ä½†å› å›¾ç‰‡ URL æœªå˜ï¼Œæµè§ˆå™¨ç›´æ¥å¤ç”¨æœ¬åœ°ç¼“å­˜çš„æ— è·¨åŸŸå“åº”å¤´èµ„æºï¼Œè·¨åŸŸæ ¡éªŒæ— æ³•é€šè¿‡ï¼Œæœ€ç»ˆè§¦å‘é”™è¯¯ã€‚</li>
</ol>
<p>å…³é”®ç»“è®ºï¼šåŒä¸€å¼ å›¾ç‰‡çš„æ‰€æœ‰è¯·æ±‚ï¼Œè·¨åŸŸæ ‡è¯†å¿…é¡»å®Œå…¨ç»Ÿä¸€ï¼ˆè¦ä¹ˆæ‰€æœ‰è¯·æ±‚éƒ½è®¾ <code>crossOrigin</code>ï¼Œè¦ä¹ˆéƒ½ä¸è®¾ï¼‰ï¼Œå¦åˆ™ä¼šå› ç¼“å­˜æœºåˆ¶å¯¼è‡´è·¨åŸŸç­–ç•¥å†²çªã€‚</p>
<h2 data-id="heading-2">è§£å†³åŠæ³•</h2>
<h3 data-id="heading-3">1. æ ¸å¿ƒé€šç”¨æ–¹æ¡ˆï¼šç»Ÿä¸€è·¨åŸŸæ ‡è¯†ï¼ˆæ¨èé¦–é€‰ï¼‰</h3>
<p>æ€è·¯ï¼šç»Ÿä¸€æ‰€æœ‰åŠ è½½è¯¥å›¾ç‰‡çš„ <code>Image</code> å®ä¾‹çš„è·¨åŸŸé…ç½®ï¼ˆå‡è®¾ç½®æˆ–å‡ä¸è®¾ç½® <code>crossOrigin</code>ï¼‰ï¼Œç¡®ä¿ä¸¤æ¬¡è¯·æ±‚çš„è·¨åŸŸç­–ç•¥ä¸€è‡´ï¼Œä»æ ¹æºé¿å…ç¼“å­˜ä¸è·¨åŸŸè§„åˆ™çš„å†²çªã€‚</p>
<p>æ ¸å¿ƒæ³¨æ„ç‚¹ï¼š<code>crossOrigin</code> å¿…é¡»åœ¨ <code>src</code> èµ‹å€¼ <strong>ä¹‹å‰</strong> è®¾ç½®ã€‚è‹¥å…ˆèµ‹å€¼ <code>src</code>ï¼Œæµè§ˆå™¨ä¼šæå‰ä»¥é»˜è®¤æ¨¡å¼å‘èµ·è¯·æ±‚ï¼Œä»ä¼šè§¦å‘è·¨åŸŸå†²çªã€‚</p>
<p>æ­£ç¡®ä»£ç ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'DOMContentLoaded'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// ç¬¬ä¸€æ¬¡åŠ è½½ï¼šæå‰è®¾ç½® crossOriginï¼Œç»Ÿä¸€è·¨åŸŸç­–ç•¥</span>
  <span class="hljs-keyword">const</span> image = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();
  image.<span class="hljs-property">crossOrigin</span> = <span class="hljs-string">"anonymous"</span>; 
  image.<span class="hljs-property">src</span> = <span class="hljs-string">'https://xxx.png'</span>;

  image.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å›¾ç‰‡åŠ è½½å®Œæˆ'</span>);
      <span class="hljs-comment">// ç¬¬äºŒæ¬¡åŠ è½½ï¼šä¿æŒ crossOrigin é…ç½®ä¸€è‡´</span>
      <span class="hljs-keyword">const</span> image2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();
      image2.<span class="hljs-property">crossOrigin</span> = <span class="hljs-string">"anonymous"</span>; 
      image2.<span class="hljs-property">src</span> = image.<span class="hljs-property">src</span>;

      image2.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å›¾ç‰‡2åŠ è½½å®Œæˆ'</span>);
      });
  });

  <span class="hljs-comment">// æ·»åŠ é”™è¯¯ç›‘å¬ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥</span>
  image.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å›¾ç‰‡1åŠ è½½å¤±è´¥:'</span>, e));
  image2.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å›¾ç‰‡2åŠ è½½å¤±è´¥:'</span>, e));
});
</code></pre>
<p>é€‚ç”¨åœºæ™¯ï¼šç»å¤§å¤šæ•°å‰ç«¯åœºæ™¯ï¼ˆåŒ…æ‹¬ <code>VueCropper </code> ç­‰ä¾èµ– canvas çš„è£å‰ªç»„ä»¶åœºæ™¯ï¼‰ï¼Œä¸”å›¾ç‰‡å­˜å‚¨ç«¯<code>ï¼ˆOBS/CDNï¼‰</code>å·²é…ç½®è·¨åŸŸå…è®¸è§„åˆ™ã€‚</p>
<h3 data-id="heading-4">2. ç»•è¿‡ç¼“å­˜æ–¹æ¡ˆï¼šè®©ç¬¬äºŒæ¬¡è¯·æ±‚è§†ä¸ºã€Œæ–°èµ„æºã€</h3>
<p>æ€è·¯ï¼šè‹¥å†å²ä»£ç æ— æ³•æ‰¹é‡ä¿®æ”¹ <code>crossOrigin</code> é…ç½®ï¼Œå¯é€šè¿‡è®©ç¬¬äºŒæ¬¡è¯·æ±‚ã€Œé¿å¼€ç¼“å­˜ã€ï¼Œè¿«ä½¿æµè§ˆå™¨é‡æ–°å‘ OBS æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼ˆè€Œéå¤ç”¨æ—§ç¼“å­˜ï¼‰ï¼Œä»è€Œé¿å…è·¨åŸŸç­–ç•¥å†²çªã€‚</p>
<p>æ¨èæ–¹æ¡ˆï¼šç»™å›¾ç‰‡ URL æ·»åŠ éšæœºå‚æ•°ï¼ˆå¦‚æ—¶é—´æˆ³ï¼‰ï¼Œä½¿æµè§ˆå™¨è¯†åˆ«ä¸ºã€Œæ–°èµ„æºã€ï¼Œè§¦å‘å…¨æ–°è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">image.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> image2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();
  image2.<span class="hljs-property">crossOrigin</span> = <span class="hljs-string">"anonymous"</span>;
  <span class="hljs-comment">// è¿½åŠ æ—¶é—´æˆ³å‚æ•°ï¼Œé¿å¼€æµè§ˆå™¨ç¼“å­˜</span>
  image2.<span class="hljs-property">src</span> = <span class="hljs-string">`<span class="hljs-subst">${image.src}</span>&amp;t=<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>; 
  image2.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å›¾ç‰‡2åŠ è½½å®Œæˆ'</span>));
});
</code></pre>
<p>é€‚ç”¨åœºæ™¯ï¼šå†å²ä»£ç æ¶æ„å¤æ‚ï¼Œæ— æ³•æ‰¹é‡ç»Ÿä¸€ <code>crossOrigin</code> é…ç½®ï¼Œéœ€å¿«é€Ÿä¸´æ—¶ä¿®å¤è·¨åŸŸé—®é¢˜ã€‚</p>
<p>ç¼ºç‚¹ï¼šå®Œå…¨å¤±å»ç¼“å­˜ä¼˜åŠ¿ï¼Œæ¯æ¬¡è¯·æ±‚å‡éœ€é‡æ–°ä¸‹è½½å›¾ç‰‡ï¼Œä¼šå¢åŠ å¸¦å®½æ¶ˆè€—å¹¶å»¶é•¿é¡µé¢åŠ è½½æ—¶é—´ï¼Œä»…å»ºè®®ä¸´æ—¶ä½¿ç”¨ã€‚</p>
<h3 data-id="heading-5">3. åç«¯/å­˜å‚¨ç«¯æ–¹æ¡ˆï¼šä»æ ¹æºæ¶ˆé™¤è·¨åŸŸ</h3>
<p>æ€è·¯ï¼šé€šè¿‡åç«¯ä»£ç†æˆ–åŸŸåç»‘å®šï¼Œå°†ã€Œè·¨åŸŸå›¾ç‰‡è¯·æ±‚ã€è½¬ä¸ºã€ŒåŒæºè¯·æ±‚ã€ï¼Œä»æ ¹æºä¸Šæ¶ˆé™¤è·¨åŸŸé—®é¢˜ï¼Œæ— éœ€å‰ç«¯é¢å¤–é…ç½® <code>crossOrigin</code>ã€‚</p>
<p>å…·ä½“åšæ³•ï¼š</p>
<ol>
<li>åŒæºä»£ç†ï¼ˆæ¨èï¼‰ï¼šå‰ç«¯è¯·æ±‚è‡ªèº«åç«¯çš„ä»£ç†æ¥å£ï¼Œç”±åç«¯ä»£ä¸ºæ‹‰å– OBS å›¾ç‰‡å¹¶è¿”å›ç»™å‰ç«¯ã€‚æ­¤æ—¶å‰ç«¯æ¥æ”¶çš„å›¾ç‰‡ä¸ºåŒæºèµ„æºï¼Œæ— éœ€ä»»ä½•è·¨åŸŸé…ç½®ã€‚</li>
</ol>
<p>ç¤ºä¾‹ï¼ˆ<code>Node.js/Express</code> ä»£ç†ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åç«¯ä»£ç†ä»£ç ï¼ˆNode.js/Expressï¼‰</span>
<span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">'axios'</span>);
<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();

<span class="hljs-comment">// å›¾ç‰‡ä»£ç†æ¥å£ï¼šæ¥æ”¶å‰ç«¯ä¼ é€’çš„ OBS å›¾ç‰‡ URL</span>
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/proxy-image'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-keyword">const</span> imgUrl = req.<span class="hljs-property">query</span>.<span class="hljs-property">url</span>;
  <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// åç«¯è¯·æ±‚ OBS å›¾ç‰‡ï¼Œä»¥æµå½¢å¼è¿”å›ç»™å‰ç«¯</span>
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(imgUrl, { <span class="hljs-attr">responseType</span>: <span class="hljs-string">'stream'</span> });
      response.<span class="hljs-property">data</span>.<span class="hljs-title function_">pipe</span>(res);
  } <span class="hljs-keyword">catch</span> (err) {
      res.<span class="hljs-title function_">status</span>(<span class="hljs-number">404</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">'å›¾ç‰‡åŠ è½½å¤±è´¥'</span>);
  }
});

app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä»£ç†æœåŠ¡å¯åŠ¨åœ¨ 3000 ç«¯å£'</span>));
</code></pre>
<p>å‰ç«¯ä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å‰ç«¯ä»£ç ï¼šè¯·æ±‚åç«¯ä»£ç†æ¥å£ï¼Œæ— è·¨åŸŸé—®é¢˜</span>
<span class="hljs-keyword">const</span> image = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();
image.<span class="hljs-property">src</span> = <span class="hljs-string">`http://localhost:3000/proxy-image?url=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(<span class="hljs-string">'https://xxx.png'</span>)}</span>`</span>;
image.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å›¾ç‰‡åŠ è½½å®Œæˆ'</span>));
</code></pre>
<p>é€‚ç”¨åœºæ™¯ï¼šå‰ç«¯éœ€å¤§é‡å¤„ç†è·¨åŸŸå›¾ç‰‡ï¼ˆå¦‚æ‰¹é‡è£å‰ªã€åƒç´ æ“ä½œï¼‰ï¼›è¿½æ±‚ç¨³å®šå¯é çš„è·¨åŸŸè§£å†³æ–¹æ¡ˆï¼Œä¸å¸Œæœ›ä¾èµ–å‰ç«¯ä»£ç é…ç½®ã€‚</p>
<p>ä¼˜ç‚¹ï¼šå½»åº•è§£å†³è·¨åŸŸé—®é¢˜ï¼Œå‰ç«¯æ— éœ€ä»»ä½•è·¨åŸŸç›¸å…³é…ç½®ï¼›ç¼“å­˜æœºåˆ¶å¯æ­£å¸¸ç”Ÿæ•ˆï¼Œä¸å½±å“åŠ è½½æ€§èƒ½ï¼›å®‰å…¨æ€§æ›´é«˜ï¼ˆé¿å…è®¾ç½® <code>*</code> å…è®¸æ‰€æœ‰åŸŸåè·¨åŸŸï¼‰ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PAGåœ¨å¾—ç‰©ç¤¾åŒºSçº§æ´»åŠ¨çš„è½åœ°]]></title>    <link>https://juejin.cn/post/7587675306659020800</link>    <guid>https://juejin.cn/post/7587675306659020800</guid>    <pubDate>2025-12-26T07:45:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587675306659020800" data-draft-id="7587675306658627584" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PAGåœ¨å¾—ç‰©ç¤¾åŒºSçº§æ´»åŠ¨çš„è½åœ°"/> <meta itemprop="keywords" content="è®¾è®¡"/> <meta itemprop="datePublished" content="2025-12-26T07:45:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¾—ç‰©æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/2392954206960247"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PAGåœ¨å¾—ç‰©ç¤¾åŒºSçº§æ´»åŠ¨çš„è½åœ°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2392954206960247/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¾—ç‰©æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T07:45:34.000Z" title="Fri Dec 26 2025 07:45:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»26åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€èƒŒæ™¯</h2>
<p>è¿‘æœŸï¼Œå¾—ç‰©ç¤¾åŒºæ´»åŠ¨ã€Œç”¨ç¯®çƒè®¤è¯†æˆ‘ã€æ¨å‡º â€œç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆä¸“å±çƒæ˜Ÿå¡â€ æ ¸å¿ƒç©æ³•ã€‚</p>
<p>åˆæœŸè§„åˆ’ç”±æœåŠ¡ç«¯åŸºäº PAG æŠ€æœ¯åˆæˆï¼Œä¸ºäº†è®©ç”¨æˆ·å¯ä»¥æ›´è‡ªç”±çš„å®šåˆ¶ä¸“å±çƒæ˜Ÿå¡ï¼Œç»å¤šç«¯è¯„ä¼°åç¡®å®šï¼šç”± H5 ç«¯æ‰¿æ¥ â€œå›¾ç‰‡äº¤äº’è°ƒæ•´ - çƒæ˜Ÿå¡ç”Ÿæˆâ€ æ ¸å¿ƒé“¾è·¯ï¼Œæ”¯æŒç”¨æˆ·å•æŒ‡æ‹–æ‹½ã€åŒæŒ‡ç¼©æ”¾ / æ—‹è½¬äººåƒï¼Œå¾…è°ƒæ•´è‡³ç†æƒ³ä½ç½®åè§¦å‘åˆæˆã€‚è€Œ PAG ä½œä¸ºè…¾è®¯è‡ªç ”å¼€æºçš„åŠ¨æ•ˆå·¥ä½œæµè§£å†³æ–¹æ¡ˆï¼Œå‡­å€Ÿè·¨å¹³å°æ¸²æŸ“ä¸€è‡´æ€§ã€å›¾å±‚å®æ—¶ç¼–è¾‘ã€è½»é‡åŒ–æ–‡ä»¶æ€§èƒ½ï¼Œèƒ½ç²¾å‡†åŒ¹é…éœ€æ±‚ï¼Œæˆä¸ºæœ¬æ¬¡æ ¸å¿ƒæŠ€æœ¯é€‰å‹ã€‚</p>
<p>é‰´äº H5 ç«¯éœ€è½åœ°è¯¥æ ¸å¿ƒé“¾è·¯ï¼Œä¸”æµç¨‹æ¶‰åŠ PAG æŠ€æœ¯åº”ç”¨ï¼Œé¦–å…ˆéœ€å¯¹ PAG æŠ€æœ¯è¿›è¡Œæ·±å…¥äº†è§£ï¼Œä¸ºåç»­å¼€å‘ä¸é€‚é…å¥ å®šåŸºç¡€ã€‚</p>
<h2 data-id="heading-1">äºŒã€PAGæ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>è¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹ï¼ŒPAG æ˜¯è…¾è®¯è‡ªç ”å¹¶å¼€æºçš„åŠ¨æ•ˆå·¥ä½œæµè§£å†³æ–¹æ¡ˆï¼Œæ ¸å¿ƒæ˜¯å®ç° Adobe After Effectsï¼ˆAEï¼‰åŠ¨æ•ˆçš„ä¸€é”®å¯¼å‡ºä¸è·¨å¹³å°åº”ç”¨ï¼ŒåŒ…å«æ¸²æŸ“ SDKã€AE å¯¼å‡ºæ’ä»¶ï¼ˆPAGExporterï¼‰ã€æ¡Œé¢é¢„è§ˆå·¥å…·ï¼ˆPAGViewerï¼‰ä¸‰éƒ¨åˆ†ã€‚</p>
<p>å®ƒå¯¼å‡ºçš„äºŒè¿›åˆ¶ PAG æ–‡ä»¶å‹ç¼©ç‡é«˜ã€è§£ç å¿«ï¼Œèƒ½é›†æˆå¤šç±»èµ„æºï¼›æ”¯æŒ Androidã€iOSã€Web ç­‰å…¨å¹³å°ï¼Œä¸”å„ç«¯æ¸²æŸ“ä¸€è‡´ã€å¼€å¯ GPU åŠ é€Ÿï¼›æ—¢å…¼å®¹å¤§éƒ¨åˆ† AE åŠ¨æ•ˆç‰¹æ€§ï¼Œä¹Ÿå…è®¸è¿è¡Œæ—¶ç¼–è¾‘ â€”â€” æ¯”å¦‚æ›¿æ¢æ–‡æœ¬ / å›¾ç‰‡ã€è°ƒæ•´å›¾å±‚ä¸æ—¶é—´è½´ï¼Œç›®å‰å·²å¹¿æ³›ç”¨äºå„ç±»äº§å“çš„åŠ¨æ•ˆåœºæ™¯ã€‚</p>
<p>å·²çŸ¥ä¸šç•Œä¸­å›¾ç‰‡åŸºç¡€ç¼–è¾‘ï¼ˆå¦‚è£å‰ªã€è°ƒè‰²ï¼‰ã€è´´çº¸å åŠ ã€æ»¤é•œæ¸²æŸ“ç­‰é«˜é¢‘åŠŸèƒ½ï¼Œåœ¨å®¢æˆ·ç«¯å‘å¸ƒå™¨åœºæ™¯ä¸‹å·²å¹¿æ³›é‡‡ç”¨ PAGæŠ€æœ¯å®ç°ï¼Œè¿™ä¸€åº”ç”¨è¶‹åŠ¿åœ¨æˆ‘å¸åŠç«å“çš„äº§å“ä¸­å‡æœ‰ä½“ç°ï¼Œæˆä¸ºæ”¯æ’‘è¿™ç±»è§†è§‰äº¤äº’åŠŸèƒ½çš„ä¸»æµæŠ€æœ¯é€‰æ‹©ã€‚</p>
<p>æ­£æ˜¯åŸºäºPAG çš„è·¨å¹³å°æ¸²æŸ“ã€å›¾å±‚å®æ—¶ç¼–è¾‘ç‰¹æ€§ï¼Œå…¶èƒ½ç²¾å‡†æ‰¿æ¥ H5 ç«¯â€˜å›¾ç‰‡äº¤äº’è°ƒæ•´ + çƒæ˜Ÿå¡åˆæˆâ€™çš„æ ¸å¿ƒé“¾è·¯ï¼Œè§£å†³æœåŠ¡ç«¯å›ºå®šåˆæˆçš„ç—›ç‚¹ï¼Œå› æ­¤æˆä¸ºæœ¬æ¬¡éœ€æ±‚çš„æ ¸å¿ƒæŠ€æœ¯é€‰å‹ã€‚</p>
<p>ä¸ºäº†è®©å¤§å®¶æ›´ç›´è§‚åœ°æ„Ÿå—ã€Œç”¨ç¯®çƒè®¤è¯†æˆ‘ã€æ´»åŠ¨ä¸­ â€œç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆä¸“å±çƒæ˜Ÿå¡â€ ç©æ³•ï¼Œæˆ‘ä»¬å‡†å¤‡äº†æ´»åŠ¨å®é™…æ•ˆæœå½•å±ã€‚é€šè¿‡å½•å±ï¼Œä½ å¯ä»¥æ¸…æ™°çœ‹åˆ°ç”¨æˆ·å¦‚ä½•é€šè¿‡å•æŒ‡æ‹–æ‹½ã€åŒæŒ‡ç¼©æ”¾ / æ—‹è½¬äººåƒï¼Œå®Œæˆæ„å›¾è°ƒæ•´åç”Ÿæˆçƒæ˜Ÿå¡çš„å…¨è¿‡ç¨‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6d364c65f564fdb941ca847fa126f8f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=V5UBY3EPViU4uKz7GXyKm%2BQbsXg%3D" alt="æˆªå±2025-12-26 ä¸‹åˆ2.53.53.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6dcfe266cdd24d82a2bb2786b546c284~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=UxMDfNCTXiTbWYYDFzIEEJsjEPQ%3D" alt="æˆªå±2025-12-26 ä¸‹åˆ2.54.01.png" loading="lazy"/></p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å›´ç»•ä¸šåŠ¡ç›®æ ‡ï¼Œè¯¦ç»†æ‹†è§£å®ç°è¯¥é“¾è·¯çš„å…·ä½“ä»»åŠ¡ä¼˜å…ˆçº§ä¸æ ¸å¿ƒæ¨¡å—ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€å¦‚ä½•å®ç°æ ¸å¿ƒäº¤äº’é“¾è·¯ï¼Ÿ</h2>
<p>ç»“åˆã€Œç”¨ç¯®çƒè®¤è¯†æˆ‘ã€çƒæ˜Ÿå¡ç”Ÿæˆçš„æ ¸å¿ƒä¸šåŠ¡ç›®æ ‡ï¼ŒæŒ‰â€˜åŸºç¡€åŠŸèƒ½â†’äº¤äº’ä½“éªŒâ†’æ‹“å±•èƒ½åŠ›â†’ç¨³å®šæ€§â€™ä¼˜å…ˆçº§ï¼Œå°†éœ€æ±‚æ‹†è§£ä¸ºä»¥ä¸‹ 6 é¡¹ä»»åŠ¡ï¼š</p>
<ol>
<li><strong>PAG æ’­æ”¾å™¨åŸºç¡€åŠŸèƒ½æ­å»º</strong>ï¼šå®ç°æ’­æ”¾ / æš‚åœã€å›¾å±‚æ›¿æ¢ã€æ–‡æœ¬ä¿®æ”¹ã€åˆæˆå›¾å¯¼å‡ºï¼Œä¸ºåç»­äº¤äº’æ‰“åŸºç¡€ï¼›</li>
<li><strong>å›¾ç‰‡äº¤äº’å˜æ¢åŠŸèƒ½å¼€å‘</strong>ï¼šæ”¯æŒå•æŒ‡æ‹–æ‹½ã€åŒæŒ‡ç¼©æ”¾ / æ—‹è½¬ï¼Œæ»¡è¶³äººåƒæ„å›¾è°ƒæ•´éœ€æ±‚ï¼›</li>
<li><strong>äº¤äº’ä¸é¢„è§ˆå®æ—¶åŒæ­¥</strong>ï¼šå°†å›¾ç‰‡è°ƒæ•´çŠ¶æ€å®æ—¶åŒæ­¥è‡³ PAG å›¾å±‚ï¼Œå®ç° â€œæ“ä½œå³é¢„è§ˆâ€ï¼›</li>
<li><strong>æ‰¹é‡åˆæˆèƒ½åŠ›æ‹“å±•</strong>ï¼šåŸºäºå•å¼ åˆæˆé€»è¾‘ï¼Œæ”¯æŒä¸€æ¬¡æ€§ç”Ÿæˆå¤šå¼ çƒæ˜Ÿå¡ï¼ˆä¾èµ–ä»»åŠ¡ 1-3ï¼‰ï¼›</li>
<li><strong>å…¨é“¾è·¯æ€§èƒ½ä¼˜åŒ–</strong>ï¼šä¼˜åŒ– PAG å®ä¾‹é‡Šæ”¾ã€å›¾å±‚æ¸²æŸ“æ•ˆç‡ï¼Œä¿éšœ H5 æµç•…åº¦ï¼ˆè´¯ç©¿å…¨æµç¨‹ï¼‰ï¼›</li>
<li><strong>å¼‚å¸¸åœºæ™¯é™çº§å…¼å®¹</strong>ï¼šé’ˆå¯¹ SDK ä¸æ”¯æŒåœºæ™¯ï¼Œè®¾è®¡é™æ€å›¾å±‚ã€æœåŠ¡ç«¯åˆæˆç­‰å…œåº•æ–¹æ¡ˆï¼ˆåŒæ­¥æ¨è¿›ï¼‰ã€‚</li>
</ol>
<p>åœ¨æ˜ç¡®æ ¸å¿ƒä»»åŠ¡æ‹†è§£åï¼Œé¦–è¦ç¯èŠ‚æ˜¯æ­å»º PAG æ’­æ”¾å™¨åŸºç¡€èƒ½åŠ› â€”â€” è¿™æ˜¯åç»­å›¾å±‚æ›¿æ¢ã€æ–‡æœ¬ä¿®æ”¹ã€çƒæ˜Ÿå¡åˆæˆçš„å‰æï¼Œéœ€ä» SDK åŠ è½½ã€æ’­æ”¾å™¨åˆå§‹åŒ–ã€æ ¸å¿ƒåŠŸèƒ½å°è£…é€æ­¥è½åœ°ã€‚</p>
<h2 data-id="heading-3">å››ã€åŸºç¡€PAGæ’­æ”¾å™¨å®ç°</h2>
<h3 data-id="heading-4">åŠ è½½PAG SDK</h3>
<p>å› ä¸ºæ˜¯é¦–æ¬¡æ¥è§¦PAG ï¼Œæ‰€ä»¥åœ¨é¦–æ¬¡åŠ è½½ SDK ç¯èŠ‚ä¾¿é‡åˆ°äº†éœ€è¦æ³¨æ„çš„ç»†èŠ‚ï¼š</p>
<p>libpag çš„ SDK åŠ è½½åŒ…å«ä¸¤éƒ¨åˆ†æ ¸å¿ƒæ–‡ä»¶ï¼š</p>
<ul>
<li>ä¸»ä½“ libpag.min.js</li>
<li>é…å¥—çš„ libpag.wasm</li>
</ul>
<p><strong>éœ€ç‰¹åˆ«æ³¨æ„</strong>ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œwasmæ–‡ä»¶éœ€ä¸ libpag.min.js ç½®äºåŒä¸€ç›®å½•ï¼Œè‹¥éœ€è‡ªå®šä¹‰è·¯å¾„ï¼Œä¹Ÿå¯æ‰‹åŠ¨æŒ‡å®šå…¶ä½ç½®ã€‚ï¼ˆåŠ è½½SDKå‚è€ƒæ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fpag.io%2Fdocs%2Fuse-web-sdk.html%25EF%25BC%2589" target="_blank" title="https://pag.io/docs/use-web-sdk.html%EF%BC%89" ref="nofollow noopener noreferrer">pag.io/docs/use-weâ€¦</a></p>
<p>åœ¨æœ¬é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å°†ä¸¤ä¸ªæ–‡ä»¶ä¸€åŒä¸Šä¼ è‡³ OSSçš„åŒä¸€è·¯å¾„ä¸‹ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fh5static.xx%2F10122053%2Flibpag.min.js" target="_blank" title="https://h5static.xx/10122053/libpag.min.js" ref="nofollow noopener noreferrer">h5static.xx/10122053/liâ€¦</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fh5static.xx%2F10122053%2Flibpag.wasm" target="_blank" title="https://h5static.xx/10122053/libpag.wasm" ref="nofollow noopener noreferrer">h5static.xx/10122053/liâ€¦</a></p>
<p>é€šè¿‡ CDN æ–¹å¼å®ŒæˆåŠ è½½ï¼Œç¡®ä¿èµ„æºè·¯å¾„åŒ¹é…ã€‚</p>
<p>SDKåŠ è½½æ ¸å¿ƒä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span>Â loadLibPag =Â <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span>Â () =&gt; {
Â Â <span class="hljs-comment">// è‹¥å·²åŠ è½½ï¼Œç›´æ¥è¿”å›</span>
Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-variable language_">window</span>.<span class="hljs-property">libpag</span>) {
Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-variable language_">window</span>.<span class="hljs-property">libpag</span>
Â  }
Â Â 
Â Â <span class="hljs-keyword">try</span>Â {
Â  Â Â <span class="hljs-comment">// åŠ¨æ€åˆ›å»ºscriptæ ‡ç­¾åŠ è½½SDK</span>
Â  Â Â <span class="hljs-keyword">const</span>Â script =Â <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'script'</span>)
Â  Â  script.<span class="hljs-property">src</span>Â =Â <span class="hljs-string">'https://h5static.XX/10122053/libpag.min.js'</span>
Â  Â Â <span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">appendChild</span>(script)
Â  Â Â 
Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span>Â {
Â  Â  Â  script.<span class="hljs-property">onload</span>Â =Â <span class="hljs-keyword">async</span>Â () =&gt; {
Â  Â  Â  Â Â <span class="hljs-comment">// ç­‰å¾…500msç¡®ä¿åº“å®Œå…¨åˆå§‹åŒ–</span>
Â  Â  Â  Â Â <span class="hljs-keyword">await</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span>Â =&gt;</span>Â <span class="hljs-built_in">setTimeout</span>(resolve,Â <span class="hljs-number">500</span>))
Â  Â  Â  Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'LibPag script loaded, checking window.libpag:'</span>,Â <span class="hljs-variable language_">window</span>.<span class="hljs-property">libpag</span>)
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-variable language_">window</span>.<span class="hljs-property">libpag</span>) {
Â  Â  Â  Â  Â Â <span class="hljs-title function_">resolve</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">libpag</span>)
Â  Â  Â  Â  }Â <span class="hljs-keyword">else</span>Â {
Â  Â  Â  Â  Â Â <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Error</span>(<span class="hljs-string">'window.libpag is not available'</span>))
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  Â Â <span class="hljs-comment">// åŠ è½½å¤±è´¥å¤„ç†</span>
Â  Â  Â  script.<span class="hljs-property">onerror</span>Â =Â <span class="hljs-function">() =&gt;</span>Â <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Failed to load libPag script'</span>))
Â  Â  })
Â  }Â <span class="hljs-keyword">catch</span>Â (error) {
Â  Â Â <span class="hljs-keyword">throw</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Failed to load libPag:Â <span class="hljs-subst">${error}</span>`</span>)
Â  }
}, [])
</code></pre>
<h3 data-id="heading-5">åˆå§‹åŒ–æ’­æ”¾å™¨</h3>
<p>åŠ è½½å®Œ SDK åï¼Œwindow å¯¹è±¡ä¼šç”Ÿæˆ libpag å¯¹è±¡ï¼Œä»¥æ­¤ä¸ºåŸºç¡€å¯å®Œæˆæ’­æ”¾å™¨åˆå§‹åŒ–ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ul>
<li>å‡†å¤‡ canvas å®¹å™¨ä½œä¸ºæ¸²æŸ“è½½ä½“ï¼›</li>
<li>åŠ è½½ PAG æ ¸å¿ƒåº“å¹¶åˆå§‹åŒ– PAG ç¯å¢ƒï¼›</li>
<li>åŠ è½½ç›®æ ‡.pag æ–‡ä»¶ï¼ˆåŠ¨æ•ˆæ¨¡æ¿ï¼‰ï¼›</li>
<li>åˆ›å»º PAGView å®ä¾‹å…³è” canvas ä¸åŠ¨æ•ˆæ–‡ä»¶ï¼›</li>
<li>å°è£…æ’­æ”¾å™¨æ§åˆ¶æ¥å£ï¼ˆæ’­æ”¾ / æš‚åœ / é”€æ¯ç­‰ï¼‰ï¼Œå¹¶å¤„ç†èµ„æºé‡Šæ”¾ä¸é‡å¤åˆå§‹åŒ–é—®é¢˜ã€‚</li>
</ul>
<p>éœ€è¯´æ˜çš„æ˜¯ï¼Œæœ¬éœ€æ±‚æ ¸å¿ƒè¯‰æ±‚æ˜¯ â€œåˆæˆçƒæ˜Ÿå¡å›¾ç‰‡â€ï¼Œä¸æ¶‰åŠPAGçš„è§†é¢‘ç›¸å…³èƒ½åŠ›ï¼Œå› æ­¤æš‚ä¸æ‰©å±•è§†é¢‘åŠŸèƒ½ï¼Œåœ¨æ’­æ”¾å™¨åˆå§‹åŒ–åå®Œæˆç«‹å³æš‚åœï¼Œåç»­ä»…å›´ç»• â€œå›¾å±‚æ›¿æ¢ï¼ˆå¦‚ç”¨æˆ·äººåƒï¼‰â€â€œæ–‡æœ¬æ›¿æ¢ï¼ˆå¦‚çƒæ˜Ÿåç§°ï¼‰â€ ç­‰æ ¸å¿ƒéœ€æ±‚å±•å¼€ã€‚</p>
<p>æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span>Â { width, height } = props


<span class="hljs-comment">// Canvasæ¸²æŸ“å®¹å™¨</span>
<span class="hljs-keyword">const</span>Â canvasRef = useRef&lt;<span class="hljs-title class_">HTMLCanvasElement</span>&gt;(<span class="hljs-literal">null</span>)
<span class="hljs-comment">// PAGåŠ¨æ•ˆæ¨¡æ¿åœ°å€ï¼ˆçƒæ˜Ÿå¡æ¨¡æ¿ï¼‰</span>
<span class="hljs-keyword">const</span>Â src =Â <span class="hljs-string">'https://h5static.XX/10122053/G-lv1.pag'</span>


<span class="hljs-comment">// åˆå§‹åŒ–æ’­æ”¾å™¨å‡½æ•°</span>
<span class="hljs-keyword">const</span>Â initPlayer =Â <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span>Â () =&gt; {
Â Â 
Â Â <span class="hljs-keyword">try</span>Â {
Â  Â Â <span class="hljs-title function_">setIsLoading</span>(<span class="hljs-literal">true</span>)
Â  Â Â <span class="hljs-keyword">const</span>Â canvas = canvasRef.<span class="hljs-property">current</span>
Â  Â Â <span class="hljs-comment">// è®¾ç½®Canvaså°ºå¯¸ä¸çƒæ˜Ÿå¡åŒ¹é…</span>
Â  Â  canvas.<span class="hljs-property">width</span>Â = width
Â  Â  canvas.<span class="hljs-property">height</span>Â = height
Â  Â Â 
Â  Â Â <span class="hljs-comment">// 1. åŠ è½½PAGæ ¸å¿ƒåº“å¹¶åˆå§‹åŒ–ç¯å¢ƒ</span>
Â  Â Â <span class="hljs-keyword">const</span>Â libpag =Â <span class="hljs-keyword">await</span>Â <span class="hljs-title function_">loadLibPag</span>()
Â  Â Â <span class="hljs-keyword">const</span>Â <span class="hljs-variable constant_">PAG</span>Â =Â <span class="hljs-keyword">await</span>Â libpag.<span class="hljs-title class_">PAGInit</span>({Â <span class="hljs-attr">useScale</span>:Â <span class="hljs-literal">false</span>Â })
Â  Â Â 
Â  Â Â <span class="hljs-comment">// 2. åŠ è½½PAGåŠ¨æ•ˆæ¨¡æ¿</span>
Â  Â Â <span class="hljs-keyword">const</span>Â response =Â <span class="hljs-keyword">await</span>Â <span class="hljs-title function_">fetch</span>(src)
Â  Â Â <span class="hljs-keyword">const</span>Â buffer =Â <span class="hljs-keyword">await</span>Â response.<span class="hljs-title function_">arrayBuffer</span>()
Â  Â Â <span class="hljs-keyword">const</span>Â pagFile =Â <span class="hljs-keyword">await</span>Â <span class="hljs-variable constant_">PAG</span>.<span class="hljs-property">PAGFile</span>.<span class="hljs-title function_">load</span>(buffer)
Â  Â Â 
Â  Â Â <span class="hljs-comment">// 3. åˆ›å»ºPAGViewï¼Œå…³è”Canvasä¸åŠ¨æ•ˆæ¨¡æ¿</span>
Â  Â Â <span class="hljs-keyword">const</span>Â pagView =Â <span class="hljs-keyword">await</span>Â <span class="hljs-variable constant_">PAG</span>.<span class="hljs-property">PAGView</span>.<span class="hljs-title function_">init</span>(pagFile, canvas)
Â  Â Â 
Â  Â Â <span class="hljs-comment">// 4. å°è£…æ’­æ”¾å™¨æ§åˆ¶æ¥å£</span>
Â  Â Â <span class="hljs-keyword">const</span>Â player = {
Â  Â  Â Â <span class="hljs-attr">_pagView</span>: pagView,
Â  Â  Â Â <span class="hljs-attr">_pagFile</span>: pagFile,
Â  Â  Â Â <span class="hljs-attr">_PAG</span>:Â <span class="hljs-variable constant_">PAG</span>,
Â  Â  Â Â <span class="hljs-attr">_isPlaying</span>:Â <span class="hljs-literal">false</span>,
Â  Â  Â Â 
Â  Â  Â Â <span class="hljs-comment">// æ’­æ”¾</span>
Â  Â  Â Â <span class="hljs-keyword">async</span>Â <span class="hljs-title function_">play</span>(<span class="hljs-params"/>) {
Â  Â  Â  Â Â <span class="hljs-keyword">await</span>Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_pagView</span>.<span class="hljs-title function_">play</span>()
Â  Â  Â  Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_isPlaying</span>Â =Â <span class="hljs-literal">true</span>
Â  Â  Â  },
Â  Â  Â Â <span class="hljs-comment">// æš‚åœï¼ˆåˆå§‹åŒ–åé»˜è®¤æš‚åœï¼‰</span>
Â  Â  Â Â <span class="hljs-title function_">pause</span>(<span class="hljs-params"/>) {
Â  Â  Â  Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_pagView</span>.<span class="hljs-title function_">pause</span>()
Â  Â  Â  Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_isPlaying</span>Â =Â <span class="hljs-literal">false</span>
Â  Â  Â  },
Â  Â  Â Â <span class="hljs-comment">// é”€æ¯å®ä¾‹ï¼Œé‡Šæ”¾èµ„æº</span>
Â  Â  Â Â <span class="hljs-title function_">destroy</span>(<span class="hljs-params"/>) {
Â  Â  Â  Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">_pagView</span>.<span class="hljs-title function_">destroy</span>()
Â  Â  Â  },
Â  Â  }
Â  }Â <span class="hljs-keyword">catch</span>Â (error) {
Â  Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'PAG Player initialization failed:'</span>, error)
Â  }Â 
}, [src, width, height])
</code></pre>
<p><strong>å®ç°æ•ˆæœ</strong></p>
<p>æ’­æ”¾å™¨åˆå§‹åŒ–å®Œæˆåï¼Œå¯åœ¨Canvasä¸­æ­£å¸¸å±•ç¤ºçƒæ˜Ÿå¡åŠ¨æ•ˆæ¨¡æ¿ï¼ˆåˆå§‹åŒ–åé»˜è®¤æš‚åœï¼‰ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8fad50f876ee4dea8bea2fbcac6018de~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=PzWUqcrlOWM%2FlJAoUKvfd52Nw%2FQ%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®ç°æ›¿æ¢å›¾å±‚åŠæ–‡æœ¬åŠŸèƒ½ã€‚</p>
<h3 data-id="heading-6">æ›¿æ¢å›¾å±‚åŠæ–‡æœ¬</h3>
<p>æ›¿æ¢ â€œç”¨æˆ·ä¸Šä¼ äººåƒâ€ï¼ˆå›¾å±‚ï¼‰ä¸ â€œçƒæ˜Ÿåç§°â€ï¼ˆæ–‡æœ¬ï¼‰æ˜¯æ ¸å¿ƒéœ€æ±‚ï¼Œéœ€é€šè¿‡ PAGFile çš„åŸç”Ÿæ¥å£å®ç°ï¼Œå¹¶æ‰©å±•æ’­æ”¾å™¨å®ä¾‹çš„æ“ä½œæ–¹æ³•ï¼š</p>
<ul>
<li><strong>å›¾ç‰‡å›¾å±‚æ›¿æ¢</strong>ï¼šè°ƒç”¨pagFile.replaceImage(index, image) æ¥å£ï¼Œå°†æŒ‡å®šç´¢å¼•çš„å›¾å±‚æ›¿æ¢ä¸ºç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ï¼ˆæ”¯æŒ CDN åœ°å€ã€Canvas å…ƒç´ ã€Image å…ƒç´ ä½œä¸ºå›¾ç‰‡æºï¼‰ï¼›</li>
<li><strong>æ–‡æœ¬å†…å®¹æ›¿æ¢</strong>ï¼šè°ƒç”¨pagFile.setTextData(index, textData) æ¥å£ï¼Œä¿®æ”¹æŒ‡å®šæ–‡æœ¬å›¾å±‚çš„å†…å®¹ä¸å­—ä½“ï¼›</li>
<li><strong>æ•ˆæœç”Ÿæ•ˆ</strong>ï¼šæ¯æ¬¡æ›¿æ¢åéœ€è°ƒç”¨ pagView.flush() å¼ºåˆ¶åˆ·æ–°æ¸²æŸ“ï¼Œç¡®ä¿ä¿®æ”¹å®æ—¶ç”Ÿæ•ˆã€‚</li>
</ul>
<p><strong>å®ç°æ–¹æ¡ˆ</strong></p>
<ul>
<li>æ›¿æ¢å›¾ç‰‡å›¾å±‚ï¼šé€šè¿‡pagFile.replaceImage(index, image)æ¥å£ï¼Œå°†æŒ‡å®šç´¢å¼•çš„å›¾å±‚æ›¿æ¢ä¸ºç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ï¼›</li>
<li>æ›¿æ¢æ–‡æœ¬å†…å®¹ï¼šé€šè¿‡pagFile.setTextData(index, textData)æ¥å£ï¼Œä¿®æ”¹æŒ‡å®šæ–‡æœ¬å›¾å±‚çš„å†…å®¹ï¼›</li>
<li>æ‰©å±•æ’­æ”¾å™¨æ¥å£åï¼Œéœ€è°ƒç”¨flush()å¼ºåˆ¶åˆ·æ–°æ¸²æŸ“ï¼Œç¡®ä¿æ›¿æ¢æ•ˆæœç”Ÿæ•ˆã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d4f0a8a802e4de4ab1a0837984704f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=zMWQHOUsbMz7oyiPlhxrpYCdoIg%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>åˆæœŸé—®é¢˜ï¼šæ–‡æœ¬å­—ä½“æœªç”Ÿæ•ˆ</strong></p>
<p>æ›¿æ¢æ–‡æœ¬åå‘ç°è®¾å®šå­—ä½“æœªåº”ç”¨ã€‚æ’æŸ¥åç¡®è®¤ï¼šè‡ªå®šä¹‰å­—ä½“åŒ…æœªåœ¨ PAG ç¯å¢ƒä¸­æ³¨å†Œï¼Œå¯¼è‡´ PAG æ— æ³•è¯†åˆ«å­—ä½“ã€‚</p>
<p>éœ€åœ¨åŠ è½½ PAG æ¨¡æ¿å‰ï¼Œä¼˜å…ˆå®Œæˆå­—ä½“æ³¨å†Œï¼Œç¡®ä¿ PAG èƒ½æ­£å¸¸è°ƒç”¨ç›®æ ‡å­—ä½“ï¼Œå…·ä½“å®ç°æ­¥éª¤å¦‚ä¸‹ã€‚</p>
<p>PAGæä¾›PAGFont.registerFont()æ¥å£ç”¨äºæ³¨å†Œè‡ªå®šä¹‰å­—ä½“ï¼Œéœ€ä¼ å…¥ â€œå­—ä½“åç§°â€ ä¸ â€œå­—ä½“æ–‡ä»¶èµ„æºâ€ï¼ˆå¦‚.ttf/.otf æ ¼å¼æ–‡ä»¶ï¼‰ï¼Œæµç¨‹ä¸ºï¼š</p>
<ul>
<li>åŠ è½½å­—ä½“æ–‡ä»¶ï¼ˆä» CDN/OSS è·å–å­—ä½“åŒ…ï¼‰ï¼›</li>
<li>è°ƒç”¨ PAG æ¥å£å®Œæˆæ³¨å†Œï¼›</li>
<li>æ³¨å†ŒæˆåŠŸåï¼Œå†åŠ è½½.pagæ–‡ä»¶ï¼Œç¡®ä¿åç»­æ–‡æœ¬æ›¿æ¢æ—¶å­—ä½“å·²ç”Ÿæ•ˆã€‚</li>
</ul>

<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// éœ€æ³¨å†Œçš„å­—ä½“åˆ—è¡¨ï¼ˆå­—ä½“åç§°+CDNåœ°å€ï¼‰</span>
<span class="hljs-keyword">const</span>Â fonts = [
Â  {
Â  Â Â <span class="hljs-attr">family</span>:Â <span class="hljs-string">'POIZONSans'</span>,
Â  Â Â <span class="hljs-attr">url</span>:Â <span class="hljs-string">'https://h5static.XX/10122053/20250827-febf35c67d9232d4.ttf'</span>,
Â  },
Â  {
Â  Â Â <span class="hljs-attr">family</span>:Â <span class="hljs-string">'FZLanTingHeiS-DB-GB'</span>,
Â  Â Â <span class="hljs-attr">url</span>:Â <span class="hljs-string">'https://h5static.XX/10122053/20250821-1e3a4fccff659d1c.ttf'</span>,
Â  },
]


<span class="hljs-comment">// åœ¨â€œåŠ è½½PAGæ ¸å¿ƒåº“â€åã€â€œåŠ è½½PAGæ¨¡æ¿â€å‰ï¼Œæ–°å¢å­—ä½“æ³¨å†Œé€»è¾‘</span>
<span class="hljs-keyword">const</span>Â initPlayer =Â <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span>Â () =&gt; {
Â Â <span class="hljs-comment">// ... åŸæœ‰ä»£ç ï¼ˆCanvaså‡†å¤‡ã€åŠ è½½libpagï¼‰</span>
Â Â <span class="hljs-keyword">const</span>Â libpag =Â <span class="hljs-keyword">await</span>Â <span class="hljs-title function_">loadLibPag</span>()
Â Â <span class="hljs-keyword">const</span>Â <span class="hljs-variable constant_">PAG</span>Â =Â <span class="hljs-keyword">await</span>Â libpag.<span class="hljs-title class_">PAGInit</span>({Â <span class="hljs-attr">useScale</span>:Â <span class="hljs-literal">false</span>Â })
Â Â 
Â Â <span class="hljs-comment">// æ–°å¢ï¼šæ³¨å†Œè‡ªå®šä¹‰å­—ä½“</span>
Â Â <span class="hljs-keyword">if</span>Â (fonts &amp;&amp; fonts.<span class="hljs-property">length</span>Â &gt;Â <span class="hljs-number">0</span>Â &amp;&amp;Â <span class="hljs-variable constant_">PAG</span>?.<span class="hljs-property">PAGFont</span>?.<span class="hljs-property">registerFont</span>) {
Â  Â Â <span class="hljs-keyword">try</span>Â {
Â  Â  Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-keyword">const</span>Â { family, url }Â <span class="hljs-keyword">of</span>Â fonts) {
Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â (!family || !url)Â <span class="hljs-keyword">continue</span>
Â  Â  Â  Â Â <span class="hljs-comment">// åŠ è½½å­—ä½“æ–‡ä»¶ï¼ˆCORSè·¨åŸŸé…ç½®+å¼ºåˆ¶ç¼“å­˜ï¼‰</span>
Â  Â  Â  Â Â <span class="hljs-keyword">const</span>Â resp =Â <span class="hljs-keyword">await</span>Â <span class="hljs-title function_">fetch</span>(url, {Â <span class="hljs-attr">mode</span>:Â <span class="hljs-string">'cors'</span>,Â <span class="hljs-attr">cache</span>:Â <span class="hljs-string">'force-cache'</span>Â })
Â  Â  Â  Â Â <span class="hljs-keyword">const</span>Â blob =Â <span class="hljs-keyword">await</span>Â resp.<span class="hljs-title function_">blob</span>()
Â  Â  Â  Â Â <span class="hljs-comment">// è½¬æ¢ä¸ºFileç±»å‹ï¼ˆPAGæ³¨å†Œéœ€Fileæ ¼å¼ï¼‰</span>
Â  Â  Â  Â Â <span class="hljs-keyword">const</span>Â filename = url.<span class="hljs-title function_">split</span>(<span class="hljs-string">'/'</span>).<span class="hljs-title function_">pop</span>() ||Â <span class="hljs-string">'font.ttf'</span>
Â  Â  Â  Â Â <span class="hljs-keyword">const</span>Â fontFile =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">File</span>([blob], filename)
Â  Â  Â  Â Â <span class="hljs-comment">// æ³¨å†Œå­—ä½“</span>
Â  Â  Â  Â Â <span class="hljs-keyword">await</span>Â <span class="hljs-variable constant_">PAG</span>.<span class="hljs-property">PAGFont</span>.<span class="hljs-title function_">registerFont</span>(family, fontFile)
Â  Â  Â  Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Registered font for PAG:'</span>, family)
Â  Â  Â  }
Â  Â  }Â <span class="hljs-keyword">catch</span>Â (e) {
Â  Â  Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'Register fonts for PAG failed:'</span>, e)
Â  Â  }
Â  }
Â Â 
Â Â <span class="hljs-comment">// ç»§ç»­åŠ è½½PAGæ¨¡æ¿ï¼ˆåŸæœ‰ä»£ç ï¼‰</span>
Â Â <span class="hljs-keyword">const</span>Â response =Â <span class="hljs-keyword">await</span>Â <span class="hljs-title function_">fetch</span>(src)
Â Â <span class="hljs-keyword">const</span>Â buffer =Â <span class="hljs-keyword">await</span>Â response.<span class="hljs-title function_">arrayBuffer</span>()
Â Â <span class="hljs-keyword">const</span>Â pagFile =Â <span class="hljs-keyword">await</span>Â <span class="hljs-variable constant_">PAG</span>.<span class="hljs-property">PAGFile</span>.<span class="hljs-title function_">load</span>(buffer)
Â Â <span class="hljs-comment">// ... åç»­åˆ›å»ºPAGViewã€å°è£…æ’­æ”¾å™¨æ¥å£</span>
}, [src, width, height])
</code></pre>
<p><strong>æœ€ç»ˆæ•ˆæœ</strong></p>
<p>å­—ä½“æ³¨å†Œåï¼Œæ–‡æœ¬æ›¿æ¢çš„å­—ä½“æ­£å¸¸ç”Ÿæ•ˆï¼Œäººåƒä¸æ–‡æœ¬å‡æ˜¾ç¤ºæ­£ç¡®ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/405c50bb121c43049d8116a1584db07f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=objPcWRKzCFp%2FDbwdaU37xX5gJM%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>æ•°å­—å­—ä½“å·²åº”ç”¨æˆåŠŸ</p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæ›¿æ¢æ–‡æœ¬çš„å­—ä½“å·²æ­£ç¡®åº”ç”¨ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®ç°æœ€åä¸€æ­¥ï¼Œå°†æ›´æ–°å›¾å±‚åŠæ–‡æœ¬åçš„å†…å®¹å¯¼å‡ºä¸ºCDNå›¾ç‰‡ã€‚</p>
<h3 data-id="heading-7">PagPlayeræˆªå¸§ï¼ˆå¯¼å‡ºPagPlayerå½“å‰å±•ç¤ºå†…å®¹ï¼‰</h3>
<p>æˆªå¸§æ˜¯å°† â€œè°ƒæ•´åçš„äººåƒ + æ›¿æ¢åçš„æ–‡æœ¬ + åŠ¨æ•ˆæ¨¡æ¿â€ å›ºåŒ–ä¸ºæœ€ç»ˆå›¾ç‰‡çš„å…³é”®æ­¥éª¤ã€‚å¼€å‘åˆæœŸæ›¾ç›´æ¥è°ƒç”¨pagView.makeSnapshot()é­é‡å¯¼å‡ºç©ºå¸§ï¼Œåé€šè¿‡updateSize()+flush()è§£å†³åŒæ­¥é—®é¢˜ï¼›æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ç§æ›´ç›´æ¥çš„æ–¹æ¡ˆ â€”â€”ç›´æ¥å¯¼å‡ºPAGæ¸²æŸ“å¯¹åº”çš„Canvaså†…å®¹ï¼ŒåŒæ ·èƒ½å®ç°éœ€æ±‚ï¼Œä¸”æµç¨‹æ›´ç®€æ´ã€‚</p>
<p><strong>åˆæœŸé—®é¢˜ï¼šç›´æ¥è°ƒç”¨æ¥å£å¯¼è‡´ç©ºå¸§</strong></p>
<p>å¼€å‘åˆæœŸï¼Œå°è¯•ç›´æ¥ä½¿ç”¨PAGViewæä¾›çš„makeSnapshot()æ¥å£æˆªå¸§ï¼Œä½†é‡åˆ°äº†è¿”å›ç©ºå¸§ï¼ˆå…¨é€æ˜å›¾ç‰‡ï¼‰æƒ…å†µç»è¿‡åå¤è°ƒè¯•å’ŒæŸ¥é˜…æ–‡æ¡£ï¼Œå‘ç°æ ¸å¿ƒåŸå› æ˜¯PAG æ¸²æŸ“çŠ¶æ€ä¸è°ƒç”¨æ—¶æœºä¸åŒæ­¥ï¼š</p>
<ul>
<li><strong>å°ºå¯¸ä¸åŒæ­¥</strong>ï¼šPAGView å†…éƒ¨æ¸²æŸ“å°ºå¯¸ä¸ Canvas å®é™…å°ºå¯¸ä¸åŒ¹é…ï¼Œå¯¼è‡´å†…å®¹æœªè½åœ¨å¯è§†åŒºåŸŸï¼›</li>
<li><strong>æ¸²æŸ“å»¶è¿Ÿ</strong>ï¼šå›¾å±‚æ›¿æ¢ã€æ–‡æœ¬ä¿®æ”¹åï¼ŒGPU æ¸²æŸ“æ˜¯å¼‚æ­¥çš„ï¼Œæ­¤æ—¶æˆªå¸§åªèƒ½æ•è·åˆ°æœªæ›´æ–°çš„ç©ºç™½æˆ–æ—§å¸§ã€‚</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong></p>
<p>é’ˆå¯¹ç©ºå¸§é—®é¢˜ï¼Œç»“åˆ PAG åœ¨ H5 ç«¯ â€œåŸºäº Canvas æ¸²æŸ“â€ çš„ç‰¹æ€§ï¼Œæ¢³ç†å‡ºä¸¤ç§å¯è¡Œæ–¹æ¡ˆï¼Œæ ¸å¿ƒéƒ½æ˜¯ â€œå…ˆç¡®ä¿æ¸²æŸ“åŒæ­¥ï¼Œå†è·å–ç”»é¢â€ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/350f4915f8a14f74a5a91479c8f727c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=rekCHrp2TwcDocokRn6CqTJfcHo%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>æœ€ç»ˆè½åœ°æµç¨‹</strong></p>
<ul>
<li>è°ƒç”¨ pagView.updateSize() ä¸ pagView.flush() ç¡®ä¿æ¸²æŸ“åŒæ­¥ï¼›</li>
<li>é€šè¿‡canvas.toDataURL('image/jpeg', 0.9) ç”Ÿæˆ Base64 æ ¼å¼å›¾ç‰‡ï¼ˆJPG æ ¼å¼ï¼Œæ¸…æ™°åº¦ 0.9ï¼Œå¹³è¡¡è´¨é‡ä¸ä½“ç§¯ï¼‰ï¼›</li>
<li>å°† Base64 å›¾ç‰‡ä¸Šä¼ è‡³ CDNï¼Œè·å–å¯è®¿é—®çš„çƒæ˜Ÿå¡é“¾æ¥ã€‚</li>
</ul>
<p>ç‚¹å‡»æˆªå¸§æŒ‰é’®åï¼Œå³å¯ç”Ÿæˆå¯¹åº”çš„æˆªå›¾ã€‚</p>
<p>å®Œæˆ PAG æ’­æ”¾å™¨çš„åŸºç¡€åŠŸèƒ½ï¼ˆå›¾å±‚æ›¿æ¢ã€æ–‡æœ¬ä¿®æ”¹ã€æˆªå¸§å¯¼å‡ºï¼‰åï¼Œæˆ‘ä»¬æ¥èšç„¦ç”¨æˆ·æ ¸å¿ƒäº¤äº’éœ€æ±‚ â€”â€” äººåƒçš„æ‹–æ‹½ã€ç¼©æ”¾ä¸æ—‹è½¬ï¼Œé€šè¿‡å°è£… Canvas æ‰‹åŠ¿ç»„ä»¶ï¼Œå®ç°ç²¾å‡†çš„äººåƒæ„å›¾è°ƒæ•´èƒ½åŠ›ã€‚</p>
<h2 data-id="heading-8">äº”ã€å›¾ç‰‡å˜æ¢åŠŸèƒ½å¼€å‘ï¼šå®ç°äººåƒæ‹–æ‹½ã€ç¼©æ”¾ä¸æ—‹è½¬</h2>
<p>åœ¨çƒæ˜Ÿå¡åˆæˆæµç¨‹ä¸­ï¼Œç”¨æˆ·éœ€è‡ªä¸»è°ƒæ•´ä¸Šä¼ äººåƒçš„ä½ç½®ã€å°ºå¯¸ä¸è§’åº¦ä»¥ä¼˜åŒ–æ„å›¾ã€‚æˆ‘ä»¬å¯ä»¥åŸºäº Canvas å°è£…å®Œæ•´çš„æ‰‹åŠ¿äº¤äº’èƒ½åŠ›ç»„ä»¶ï¼Œæ”¯æŒå•æŒ‡æ‹–æ‹½ã€åŒæŒ‡ç¼©æ”¾ / æ—‹è½¬ï¼ŒåŒæ—¶å…¼é¡¾é«˜æ¸…æ¸²æŸ“ä¸è·¨è®¾å¤‡å…¼å®¹æ€§ã€‚</p>
<h3 data-id="heading-9">åŠŸèƒ½ç›®æ ‡</h3>
<p>é’ˆå¯¹ â€œç”¨æˆ·äººåƒè°ƒæ•´â€ åœºæ™¯ï¼Œç»„ä»¶éœ€å®ç°ä»¥ä¸‹æ ¸å¿ƒèƒ½åŠ›ï¼š</p>
<ul>
<li><strong>åŸºç¡€äº¤äº’</strong>ï¼šæ”¯æŒå•æŒ‡æ‹–æ‹½ç§»åŠ¨äººåƒã€åŒæŒ‡ç¼©æ”¾å°ºå¯¸ã€åŒæŒ‡æ—‹è½¬è§’åº¦ï¼›</li>
<li><strong>çº¦æŸæ§åˆ¶</strong>ï¼šé™åˆ¶ç¼©æ”¾èŒƒå›´ï¼ˆå¦‚æœ€å° 0.1 å€ã€æœ€å¤§ 5 å€ï¼‰ï¼Œå¯é€‰å…³é—­æ—‹è½¬åŠŸèƒ½ï¼›</li>
<li><strong>é«˜æ¸…æ¸²æŸ“</strong>ï¼šé€‚é…è®¾å¤‡åƒç´ æ¯”ï¼ˆDPRï¼‰ï¼Œé¿å…å›¾ç‰‡æ‹‰ä¼¸æ¨¡ç³Šï¼›</li>
<li><strong>çŠ¶æ€åŒæ­¥</strong>ï¼šå®æ—¶åé¦ˆå½“å‰å˜æ¢å‚æ•°ï¼ˆåç§»é‡ã€ç¼©æ”¾æ¯”ã€æ—‹è½¬è§’ï¼‰ï¼Œæ”¯æŒé‡ç½®ä¸ç»“æœå¯¼å‡ºã€‚</li>
</ul>
<h3 data-id="heading-10">æ•ˆæœå±•ç¤º</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/811762938b80442bad5020688afbaf2e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=hQMmlIYHZRjYm%2BGX3fthzZRJpyw%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<h3 data-id="heading-11">ç»„ä»¶è®¾è®¡ç†å¿µ</h3>
<p>åœ¨ç»„ä»¶è®¾è®¡ä¹‹åˆï¼Œæˆ‘ä»¬æ¥ä½¿ç”¨åˆ†å±‚ç†å¿µï¼Œå°†å›¾ç‰‡ç¼–è¾‘æ“ä½œåˆ†è§£ä¸ºä¸‰ä¸ªç‹¬ç«‹å±‚æ¬¡ï¼š</p>
<p><strong>äº¤äº’æ„ŸçŸ¥å±‚</strong></p>
<p><strong>äº¤äº’æ„ŸçŸ¥å±‚ - æ•è·ç”¨æˆ·æ‰‹åŠ¿å¹¶è½¬æ¢ä¸ºæ ‡å‡†åŒ–çš„å˜æ¢æ„å›¾</strong></p>
<ul>
<li>æ‰‹åŠ¿è¯­ä¹‰åŒ–ï¼šå°†åŸå§‹çš„é¼ æ ‡/è§¦æ‘¸äº‹ä»¶è½¬æ¢ä¸ºè¯­ä¹‰åŒ–çš„æ“ä½œæ„å›¾</li>
<li>å•æŒ‡ç§»åŠ¨ = å¹³ç§»æ„å›¾</li>
<li>åŒæŒ‡è·ç¦»å˜åŒ– = ç¼©æ”¾æ„å›¾</li>
<li>åŒæŒ‡è§’åº¦å˜åŒ– = æ—‹è½¬æ„å›¾</li>
<li>åŒå‡» = é‡ç½®æ„å›¾</li>
</ul>
<p><strong>å˜æ¢è®¡ç®—å±‚</strong></p>
<p><strong>å˜æ¢è®¡ç®—å±‚ - å¤„ç†å‡ ä½•å˜æ¢é€»è¾‘å’Œçº¦æŸè§„åˆ™</strong></p>
<ul>
<li><strong>å¤šç‚¹è§¦æ§çš„å‡ ä½•è®¡ç®—</strong>ï¼šåŒæŒ‡æ“ä½œæ—¶ï¼Œç³»ç»Ÿä¼šå®æ—¶è®¡ç®—ä¸¤ä¸ªè§¦ç‚¹å½¢æˆçš„å‡ ä½•å…³ç³»ï¼ˆè·ç¦»ã€è§’åº¦ã€ä¸­å¿ƒç‚¹ï¼‰ï¼Œç„¶åå°†è¿™äº›å‡ ä½•å˜åŒ–æ˜ å°„ä¸ºå›¾ç‰‡çš„å˜æ¢å‚æ•°ã€‚</li>
<li><strong>äº¤äº’è¿ç»­æ€§</strong>ï¼šæ¯æ¬¡æ‰‹åŠ¿å¼€å§‹æ—¶è®°å½•åˆå§‹çŠ¶æ€ï¼Œç§»åŠ¨è¿‡ç¨‹ä¸­æ‰€æœ‰è®¡ç®—éƒ½åŸºäºè¿™ä¸ªåˆå§‹çŠ¶æ€è¿›è¡Œå¢é‡è®¡ç®—ï¼Œç¡®ä¿å˜æ¢çš„è¿ç»­æ€§å’Œå¹³æ»‘æ€§ã€‚</li>
</ul>
<p><strong>æ¸²æŸ“æ‰§è¡Œå±‚</strong></p>
<p><strong>æ¸²æŸ“æ‰§è¡Œå±‚ - å°†å˜æ¢ç»“æœç»˜åˆ¶åˆ°Canvasä¸Š</strong></p>
<ul>
<li><strong>é«˜æ¸…é€‚é…</strong>ï¼šCanvasçš„ç‰©ç†åˆ†è¾¨ç‡å’Œæ˜¾ç¤ºå°ºå¯¸åˆ†ç¦»ç®¡ç†ï¼Œç‰©ç†åˆ†è¾¨ç‡é€‚é…è®¾å¤‡åƒç´ æ¯”ä¿è¯æ¸…æ™°åº¦ï¼Œæ˜¾ç¤ºå°ºå¯¸æ§åˆ¶ç•Œé¢å¸ƒå±€ã€‚</li>
<li><strong>å˜æ¢åº”ç”¨</strong>ï¼šç»˜åˆ¶æ—¶æŒ‰ç…§ç‰¹å®šé¡ºåºåº”ç”¨å˜æ¢ - å…ˆç§»åŠ¨åˆ°ç”»å¸ƒä¸­å¿ƒå»ºç«‹åæ ‡ç³»ï¼Œå†åº”ç”¨ç”¨æˆ·çš„å¹³ç§»ã€æ—‹è½¬ã€ç¼©æ”¾æ“ä½œï¼Œæœ€åä»¥å›¾ç‰‡ä¸­å¿ƒä¸ºåŸç‚¹ç»˜åˆ¶ã€‚è¿™ä¸ªé¡ºåºç¡®ä¿äº†å˜æ¢çš„ç›´è§‚æ€§ã€‚</li>
<li><strong>æ¸²æŸ“æ§åˆ¶</strong>ï¼šåŒºåˆ†å®æ—¶äº¤äº’å’Œé™æ€æ˜¾ç¤ºä¸¤ç§åœºæ™¯ï¼Œå®æ—¶äº¤äº’æ—¶ä½¿ç”¨requestAnimationFrameä¿è¯æµç•…æ€§ï¼Œé™æ€æ›´æ–°æ—¶ä½¿ç”¨é˜²æŠ–å‡å°‘ä¸å¿…è¦çš„é‡ç»˜ã€‚</li>
</ul>
<h3 data-id="heading-12">æ•°æ®æµè®¾è®¡</h3>
<ul>
<li><strong>å•å‘æ•°æ®æµ</strong>ï¼šç”¨æˆ·æ“ä½œ â†’ æ‰‹åŠ¿è§£æ â†’ å˜æ¢è®¡ç®— â†’ çº¦æŸåº”ç”¨ â†’ çŠ¶æ€æ›´æ–° â†’ é‡æ–°æ¸²æŸ“ â†’ å›è°ƒé€šçŸ¥ã€‚è¿™ç§å•å‘æµåŠ¨ä¿è¯äº†æ•°æ®çš„å¯è¿½è¸ªæ€§ã€‚</li>
<li><strong>çŠ¶æ€åŒæ­¥æœºåˆ¶</strong>ï¼šå†…éƒ¨çŠ¶æ€å˜åŒ–æ—¶ï¼Œé€šè¿‡å›è°ƒæœºåˆ¶åŒæ­¥ç»™å¤–éƒ¨ç»„ä»¶ï¼Œæ”¯æŒå®æ—¶åŒæ­¥å’Œå»¶è¿ŸåŒæ­¥ä¸¤ç§æ¨¡å¼ï¼Œé€‚åº”ä¸åŒçš„æ€§èƒ½éœ€æ±‚ã€‚</li>
</ul>
<p>å®ç°ç‹¬ç«‹çš„äººåƒäº¤äº’è°ƒæ•´åŠŸèƒ½åï¼Œå…³é”®æ˜¯æ‰“é€š â€œç”¨æˆ·æ“ä½œâ€ ä¸ â€œPAG é¢„è§ˆâ€ çš„å®æ—¶åŒæ­¥é“¾è·¯ â€”â€” ç¡®ä¿ç”¨æˆ·æ¯ä¸€æ¬¡è°ƒæ•´éƒ½èƒ½å³æ—¶åé¦ˆåœ¨çƒæ˜Ÿå¡æ¨¡æ¿ä¸­ï¼Œè¿™éœ€è¦è®¾è®¡åˆ†å±‚åŒæ­¥æ¶æ„ä¸é«˜æ•ˆè°ƒåº¦ç­–ç•¥ã€‚</p>
<h2 data-id="heading-13">å…­ã€äº¤äº’ä¸é¢„è§ˆå®æ—¶åŒæ­¥</h2>
<p>åœ¨çƒæ˜Ÿå¡ç”Ÿæˆæµç¨‹ä¸­ï¼Œâ€œç”¨æˆ·è°ƒæ•´äººåƒâ€ ä¸ â€œPAG é¢„è§ˆæ›´æ–°â€ çš„å®æ—¶åŒæ­¥æ˜¯æ ¸å¿ƒä½“éªŒæŒ‡æ ‡ â€”â€” ç”¨æˆ·æ¯ä¸€æ¬¡æ‹–æ‹½ã€ç¼©æ”¾æˆ–æ—‹è½¬æ“ä½œï¼Œéƒ½éœ€è¦å³æ—¶åé¦ˆåœ¨çƒæ˜Ÿå¡æ¨¡æ¿ä¸­ï¼Œæ‰èƒ½è®©ç”¨æˆ·ç²¾å‡†åˆ¤æ–­æ„å›¾æ•ˆæœã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹å®ç°æ•ˆæœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fda5eb04c8744b7d81053047e34321cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=Fy2ZE0uP%2Bt%2FHLI2li8UCJy387mo%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä»é€»è¾‘æ¶æ„ã€å…³é”®æŠ€æœ¯æ–¹æ¡ˆã€è¾¹ç•Œåœºæ™¯å¤„ç†ä¸‰æ–¹é¢ï¼Œæ‹†è§£ â€œç”¨æˆ·äº¤äº’è°ƒæ•´â€ ä¸ â€œPAG é¢„è§ˆåŒæ­¥â€ é“¾è·¯çš„å®ç°æ€è·¯ã€‚</p>
<h3 data-id="heading-14">é€»è¾‘æ¶æ„ï¼šä¸‰å±‚ååŒåŒæ­¥æ¨¡å‹</h3>
<p>ç»„ä»¶å°† â€œäº¤äº’ - åŒæ­¥ - æ¸²æŸ“â€ æ‹†åˆ†ä¸ºä¸‰ä¸ªç‹¬ç«‹ä½†ååŒçš„å±‚çº§ï¼Œå„å±‚èŒè´£å•ä¸€ä¸”é€šè¿‡æ˜ç¡®æ¥å£é€šä¿¡ï¼Œé¿å…è€¦åˆå¯¼è‡´çš„åŒæ­¥å»¶è¿Ÿæˆ–çŠ¶æ€æ··ä¹±ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/72b5b151b1cb40cd9fcae281a5dab73d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=oZI%2F8D5Nyk4%2BLU%2FKYCGq5ajDBgs%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>æ ¸å¿ƒæµè½¬é“¾è·¯</strong>ï¼šç”¨æˆ·æ“ä½œ â†’ CanvasImageEditor ç”Ÿæˆå®æ—¶ Canvas â†’ åŒæ­¥å±‚ç›´æ¥å¤ç”¨ Canvas æ›´æ–° PAG å›¾å±‚ â†’ è°ƒåº¦å±‚æ‰¹é‡è§¦å‘ flush â†’ PagPlayer æ¸²æŸ“æœ€æ–°ç”»é¢ã€‚</p>
<h3 data-id="heading-15">å…³é”®æ–¹æ¡ˆï¼šä½æŸè€— + é«˜å®æ—¶æ€§çš„å¹³è¡¡</h3>
<p>ä¸ºåŒæ—¶å…¼é¡¾ â€œé«˜é¢‘äº¤äº’å¯¼è‡´ GPU æ€§èƒ½ç“¶é¢ˆâ€ ä¸ â€œå®æ—¶é¢„è§ˆéœ€å³æ—¶åé¦ˆâ€ ï¼Œç»„ä»¶é€šè¿‡ä¸‰å¤§æ ¸å¿ƒæŠ€æœ¯æ–¹æ¡ˆå®ç°å¹³è¡¡ã€‚</p>
<p><strong>å¤ç”¨ Canvas å…ƒç´ </strong></p>
<p>è·³è¿‡æ ¼å¼è½¬æ¢ç¯èŠ‚ï¼Œå‡å°‘æ€§èƒ½æ¶ˆè€—ï¼Œç›´æ¥å¤ç”¨ Canvas å…ƒç´ ä½œä¸º PAG å›¾ç‰‡æºã€‚</p>
<p><strong>æ ¸å¿ƒä»£ç é€»è¾‘ï¼š</strong></p>
<p>é€šè¿‡ canvasEditorRef.current.getCanvas() è·å–äº¤äº’å±‚çš„ Canvas å®ä¾‹ï¼Œç›´æ¥ä¼ å…¥PAG çš„ replaceImageFast æ¥å£ï¼ˆå¿«é€Ÿæ›¿æ¢ï¼Œä¸è§¦å‘å³æ—¶åˆ·æ–°ï¼‰ï¼Œé¿å…æ•°æ®å†—ä½™å¤„ç†ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">// ç›´æ¥ä½¿ç”¨ Canvas å…ƒç´ æ›´æ–° PAGï¼Œæ— æ ¼å¼è½¬æ¢
constÂ <span class="hljs-attr">canvas</span> = canvasEditorRef.current.getCanvas()<span class="hljs-comment">;</span>
pagPlayerRef.current.replaceImageFast(editImageIndex, canvas)<span class="hljs-comment">;Â // å¿«é€Ÿæ›¿æ¢ï¼Œä¸flush</span>
</code></pre>
<p><strong>æ™ºèƒ½æ‰¹é‡è°ƒåº¦ï¼š</strong></p>
<p><strong>åˆ†çº§å¤„ç†æ›´æ–°ï¼Œå…¼é¡¾æµç•…ä¸æ•ˆç‡</strong></p>
<p>é’ˆå¯¹ç”¨æˆ·è¿ç»­æ“ä½œï¼ˆå¦‚å¿«é€Ÿæ‹–æ‹½ï¼‰äº§ç”Ÿçš„é«˜é¢‘æ›´æ–°ï¼Œç»„ä»¶è®¾è®¡ â€œåˆ†çº§è°ƒåº¦ç­–ç•¥â€ï¼Œé¿å…æ¯ä¸€æ¬¡æ“ä½œéƒ½è§¦å‘ PAG çš„ flushï¼ˆGPU å¯†é›†å‹æ“ä½œï¼‰ï¼š</p>
<p><strong>è°ƒåº¦é€»è¾‘</strong>ï¼š</p>
<p>å®æ—¶æ“ä½œåˆå¹¶ï¼šé€šè¿‡ requestAnimationFrame æ•è·è¿ç»­æ“ä½œï¼Œå°† 16ms å†…çš„å¤šæ¬¡æ›¿æ¢æŒ‡ä»¤åˆå¹¶ä¸ºä¸€æ¬¡ï¼›</p>
<p><strong>æ™ºèƒ½ flush å†³ç­–</strong>ï¼š</p>
<p>è‹¥è·ç¦»ä¸Šæ¬¡ flush è¶…è¿‡ 100msï¼ˆç”¨æˆ·æ“ä½œæš‚åœï¼‰ï¼Œç«‹å³è§¦å‘ flushPagView()ï¼Œç¡®ä¿é¢„è§ˆä¸å»¶è¿Ÿï¼›</p>
<p>è‹¥æ“ä½œä»åœ¨æŒç»­ï¼Œå»¶è¿Ÿ Math.max(16, updateThrottle/2) æ¯«ç§’å† flushï¼Œåˆå¹¶å¤šæ¬¡æ›´æ–°ã€‚</p>
<p><strong>é˜²æŠ–é™çº§</strong>ï¼š</p>
<p>å½“ updateThrottle &gt; 16msï¼ˆä½å®æ—¶æ€§éœ€æ±‚åœºæ™¯ï¼‰ï¼Œè‡ªåŠ¨é™çº§ä¸ºé˜²æŠ–ç­–ç•¥ï¼Œé¿å…è¿‡åº¦è°ƒåº¦ã€‚</p>
<p><strong>æ ¸å¿ƒä»£ç ç‰‡æ®µ</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// æ™ºèƒ½ flush ç­–ç•¥ï¼šçŸ­é—´éš”åˆå¹¶ï¼Œé•¿é—´éš”ç«‹å³åˆ·æ–°</span>
constÂ timeSinceLastFlush =Â Date<span class="hljs-selector-class">.now</span>() - batchUpdate<span class="hljs-selector-class">.lastFlushTime</span>;
ifÂ (timeSinceLastFlush &gt;Â <span class="hljs-number">100</span>) {
Â Â awaitÂ <span class="hljs-built_in">flushPagView</span>();Â <span class="hljs-comment">// é—´éš”ä¹…ï¼Œç«‹å³åˆ·æ–°</span>
}Â elseÂ {
Â Â <span class="hljs-comment">// å»¶è¿Ÿåˆ·æ–°ï¼Œåˆå¹¶åç»­æ“ä½œ</span>
Â Â <span class="hljs-built_in">setTimeout</span>(asyncÂ () =&gt; {
Â  Â Â ifÂ (batchUpdate.pendingUpdatesÂ &gt;Â <span class="hljs-number">0</span>) {
Â  Â  Â Â awaitÂ <span class="hljs-built_in">flushPagView</span>();
Â  Â  }
Â  },Â Math<span class="hljs-selector-class">.max</span>(<span class="hljs-number">16</span>, updateThrottle/<span class="hljs-number">2</span>));
}
</code></pre>
<p><strong>åŒå‘çŠ¶æ€æ ¡éªŒï¼š</strong></p>
<p><strong>è§£å†³é¦–å¸§ / åˆ‡æ¢åœºæ™¯çš„åŒæ­¥ç©ºç™½</strong></p>
<p>é’ˆå¯¹ â€œPAG åŠ è½½å®Œæˆä½† Canvas æœªå°±ç»ªâ€â€œCanvas å°±ç»ªä½† PAG æœªåˆå§‹åŒ–â€ ç­‰é¦–å¸§åŒæ­¥é—®é¢˜ï¼Œç»„ä»¶è®¾è®¡åŒå‘é‡è¯•æ ¡éªŒæœºåˆ¶ï¼š</p>
<ul>
<li>PAG åŠ è½½åæ ¡éªŒï¼šhandlePagLoad ä¸­å¯åŠ¨ 60 å¸§ï¼ˆçº¦ 1sï¼‰é‡è¯•ï¼Œæ£€æµ‹ Canvas ä¸ PAG å‡å°±ç»ªåï¼Œè§¦å‘åˆå§‹åŒæ­¥ï¼›</li>
<li>Canvas åŠ è½½åæ ¡éªŒï¼šhandleCanvasImageLoad åŒç†ï¼Œè‹¥ PAG æœªå°±ç»ªï¼Œé‡è¯•è‡³ä¸¤è€…çŠ¶æ€åŒ¹é…ï¼›</li>
<li>ç¼–è¾‘æ¨¡å¼åˆ‡æ¢æ ¡éªŒï¼šè¿›å…¥ startEdit æ—¶ï¼Œé€šè¿‡åƒç´ æ£€æµ‹ï¼ˆgetImageDataï¼‰åˆ¤æ–­ Canvas æ˜¯å¦æœ‰å†…å®¹ï¼Œæœ‰åˆ™ç«‹å³åŒæ­¥ï¼Œé¿å…ç©ºç™½é¢„è§ˆã€‚</li>
</ul>
<h3 data-id="heading-16">è¾¹ç•Œåœºæ™¯å¤„ç†ï¼šä¿éšœåŒæ­¥ç¨³å®šæ€§</h3>
<p><strong>ç¼–è¾‘æ¨¡å¼åˆ‡æ¢çš„çŠ¶æ€è¡”æ¥</strong></p>
<ul>
<li>è¿›å…¥ç¼–è¾‘ï¼šæš‚åœ PAG æ’­æ”¾ï¼Œæ˜¾ç¤ºé€æ˜çš„ Canvas äº¤äº’å±‚ï¼ˆopacity: 0ï¼Œä»…ä¿ç•™äº¤äº’èƒ½åŠ›ï¼‰ï¼Œè§¦å‘åˆå§‹åŒæ­¥ï¼›</li>
<li>é€€å‡ºç¼–è¾‘ï¼šæ¸…ç†æ‰¹é‡è°ƒåº¦å®šæ—¶å™¨ï¼Œå¼ºåˆ¶ flush ç¡®ä¿æœ€ç»ˆçŠ¶æ€ç”Ÿæ•ˆï¼ŒæŒ‰éœ€æ¢å¤ PAG è‡ªåŠ¨æ’­æ”¾ã€‚</li>
</ul>
<p><strong>æ–‡æœ¬æ›¿æ¢ä¸å›¾ç‰‡åŒæ­¥çš„ååŒ</strong></p>
<p>å½“å¤–éƒ¨ä¼ å…¥ textReplacementsï¼ˆå¦‚çƒæ˜Ÿåç§°ä¿®æ”¹ï¼‰æ—¶ï¼Œé€šè¿‡ç‹¬ç«‹çš„ applyToPagText æ¥å£æ›´æ–°æ–‡æœ¬å›¾å±‚ï¼Œå¹¶ä¸å›¾ç‰‡åŒæ­¥å…±äº« flush è°ƒåº¦ï¼Œé¿å…é‡å¤åˆ·æ–°ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// æ–‡æœ¬æ›¿æ¢åè§¦å‘ç»Ÿä¸€ flush</span>
<span class="hljs-built_in">useEffect</span>(() =&gt;Â {
Â Â ifÂ (textReplacements?.length) {
Â  Â Â <span class="hljs-built_in">applyToPagText</span>();
Â  Â Â <span class="hljs-built_in">flushPagView</span>();
Â  }
}, <span class="hljs-selector-attr">[textReplacements]</span>);
</code></pre>
<p><strong>ç»„ä»¶å¸è½½çš„èµ„æºæ¸…ç†</strong></p>
<p>å¸è½½æ—¶æ¸…é™¤æ‰¹é‡è°ƒåº¦çš„å®šæ—¶å™¨ï¼ˆclearTimeoutï¼‰ï¼Œé¿å…å†…å­˜æ³„æ¼ï¼›åŒæ—¶ PAG å†…éƒ¨ä¼šè‡ªåŠ¨é”€æ¯å®ä¾‹ï¼Œé‡Šæ”¾ GPU èµ„æºã€‚</p>
<h3 data-id="heading-17">PAGäººåƒå±…ä¸­æ— é®æŒ¡</h3>
<p>å‡è®¾ç»™å®šä»»æ„ä¸€å¼ å›¾ç‰‡ï¼Œæˆ‘ä»¬å°†å…¶ç»˜åˆ¶åˆ°Canvasä¸­æ—¶ï¼Œå›¾ç‰‡ç”±äºå°ºå¯¸åŸå› å¯èƒ½ä¼šå±•ç¤ºä¸å®Œæ•´ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f20320c6d45c4965a2d4a791fab68979~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=iXhbtjcj2kDyMBCDzSzqO11S%2B1Y%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>é‚£ä¹ˆï¼Œå¦‚ä½•ä¿è¯ä»»æ„å°ºå¯¸å›¾ç‰‡åœ¨å›ºå®šå°ºå¯¸Canvasä¸­åˆå§‹åŒ–é»˜è®¤å±…ä¸­æ— é®æŒ¡å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬é‡‡ç”¨ä»¥ä¸‹æ–¹æ¡ˆï¼š</p>
<p><strong>ç­‰æ¯”ç¼©æ”¾ç®—æ³•ï¼ˆContainæ¨¡å¼ï¼‰</strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// è®¡ç®—é€‚é…ç¼©æ”¾æ¯”ä¾‹ï¼Œç¡®ä¿å›¾ç‰‡å®Œæ•´æ˜¾ç¤º</span>
<span class="hljs-type">const</span>Â fitScale =Â Math.<span class="hljs-built_in">min</span>(
Â  editCanvasWidth / image.width, Â Â <span class="hljs-comment">// å®½åº¦é€‚é…æ¯”ä¾‹</span>
Â  availableHeight / image.heightÂ  Â <span class="hljs-comment">// é«˜åº¦é€‚é…æ¯”ä¾‹ï¼ˆè€ƒè™‘ç•™ç™½ï¼‰</span>
)
</code></pre>
<p>æ ¸å¿ƒåŸç†ï¼š</p>
<ul>
<li>é€‰æ‹©è¾ƒå°çš„ç¼©æ”¾æ¯”ä¾‹ï¼Œç¡®ä¿å›¾ç‰‡åœ¨ä¸¤ä¸ªæ–¹å‘ä¸Šéƒ½ä¸ä¼šè¶…å‡ºè¾¹ç•Œï¼›</li>
<li>è¿™å°±æ˜¯CSSçš„object-fit: containæ•ˆæœï¼Œä¿è¯å›¾ç‰‡å®Œæ•´å¯è§ã€‚</li>
<li/>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1844bb68295646529e48d32d674b49b4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=OSov7g1%2BbYGqAa16tpQ2j1HJa0I%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>é¡¶éƒ¨ç•™ç™½é¢„ç•™</strong></p>
<p>å®é™…çš„PAGæ¨¡æ¿ä¸­ï¼Œé¡¶éƒ¨ä¼šæœ‰ä¸€éƒ¨åˆ†é®æŒ¡ï¼Œå› æ­¤éœ€è¦å¯¹æ•´ä¸ªç”»å¸ƒCanvasé¡¶éƒ¨ç•™ç™½ã€‚</p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a8c97a982a1e47449476bcb38ef04ed9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=%2FjPaXe7garlxXEPlEfFnc9KQHqU%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<ul>
<li>ä¸ºäººåƒçš„å¤´éƒ¨åŒºåŸŸé¢„ç•™ç©ºé—´</li>
<li>é¿å…é‡è¦çš„é¢éƒ¨ç‰¹å¾è¢«PAGæ¨¡æ¿çš„è£…é¥°å…ƒç´ é®æŒ¡</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5dd54db9849547c885cba5cf79fddbdd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=8cDAeZcTpWYZIm%2BSCCH78uelAHc%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>æ ¸å¿ƒä»£ç </strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// é¡¶éƒ¨ç•™ç™½æ¯”ä¾‹</span>
<span class="hljs-type">const</span>Â TOP_BLANK_RATIOÂ =Â <span class="hljs-number">0.2</span>


<span class="hljs-type">const</span>Â handleCanvasImageLoadÂ =Â <span class="hljs-built_in">useCallback</span>(
Â Â <span class="hljs-built_in">async</span>Â (image: HTMLImageElement) =&gt; {
Â  Â  console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'Canvaså›¾ç‰‡åŠ è½½å®Œæˆ:'</span>, image.width,Â <span class="hljs-string">'x'</span>, image.height)
Â  Â Â <span class="hljs-built_in">setIsImageReady</span>(<span class="hljs-literal">true</span>)


Â  Â  <span class="hljs-comment">// åˆå§‹ç­‰æ¯”ç¼©æ”¾ä»¥å®Œæ•´å¯è§ï¼ˆcontainï¼‰</span>
Â  Â Â <span class="hljs-keyword">if</span>Â (canvasEditorRef.current) {
Â  Â  Â  <span class="hljs-comment">// é¡¶éƒ¨ç•™ç™½æ¯”ä¾‹</span>
Â  Â  Â Â <span class="hljs-type">const</span>Â TOP_BLANK_RATIO = spaceTopRatio ??Â <span class="hljs-number">0</span>
Â  Â  Â Â <span class="hljs-type">const</span>Â availableHeight = editCanvasHeight * (<span class="hljs-number">1</span>Â - TOP_BLANK_RATIO)


Â  Â  Â Â <span class="hljs-comment">// ä»¥å¯ç”¨é«˜åº¦è¿›è¡Œç­‰æ¯”ç¼©æ”¾ï¼ˆåŒæ—¶è€ƒè™‘å®½åº¦ï¼‰</span>
Â  Â  Â Â <span class="hljs-type">const</span>Â fitScaleÂ = Math.<span class="hljs-built_in">min</span>(
Â  Â  Â  Â  editCanvasWidth / image.width,Â 
Â  Â  Â  Â  availableHeight / image.height
Â  Â  Â  )


Â  Â  Â Â <span class="hljs-comment">// è®¡ç®—ä½¿å›¾ç‰‡é¡¶éƒ¨æ°å¥½ç•™ç™½ TOP_BLANK_RATIO çš„ä½ç§»</span>
Â  Â  Â Â <span class="hljs-type">const</span>Â topMarginÂ = editCanvasHeight * TOP_BLANK_RATIO
Â  Â  Â Â <span class="hljs-type">const</span>Â imageScaledHeightÂ = image.height * fitScale
Â  Â  Â Â <span class="hljs-type">const</span>Â targetCenterYÂ = topMargin + imageScaledHeight /Â <span class="hljs-number">2</span>
Â  Â  Â Â <span class="hljs-type">const</span>Â yOffsetÂ = targetCenterY - editCanvasHeight /Â <span class="hljs-number">2</span>
Â  Â  Â Â 
Â  Â  Â  canvasEditorRef.current.<span class="hljs-built_in">setTransform</span>({Â 
Â  Â  Â Â Â  x:Â <span class="hljs-number">0</span>,Â 
Â  Â  Â Â Â  y: yOffset,Â 
Â  Â  Â Â Â  scale: fitScale,Â 
Â  Â  Â Â Â  rotation:Â <span class="hljs-number">0</span>Â 
Â  Â  Â  })
Â  Â  }
Â  Â Â <span class="hljs-comment">// ...</span>
Â  },
Â  [applyToPag, flushPagView, isEditMode, editCanvasWidth, editCanvasHeight]
)
</code></pre>
<p>åœ¨å•å¼ çƒæ˜Ÿå¡çš„äº¤äº’ã€é¢„è§ˆä¸åˆæˆé“¾è·¯è·‘é€šåï¼Œéœ€è¿›ä¸€æ­¥æ‹“å±•æ‰¹é‡åˆæˆèƒ½åŠ›ï¼Œä»¥æ»¡è¶³å¤šç­‰çº§çƒæ˜Ÿå¡ä¸€æ¬¡æ€§ç”Ÿæˆçš„ä¸šåŠ¡éœ€æ±‚ï¼Œæ ¸å¿ƒåœ¨äºè§£å†³æ‰¹é‡åœºæ™¯ä¸‹çš„æ¸²æŸ“æ•ˆç‡ã€èµ„æºç®¡ç†ä¸å¹¶å‘æ§åˆ¶é—®é¢˜ã€‚</p>
<h2 data-id="heading-18">ä¸ƒã€æ‰¹é‡ç”Ÿæˆ</h2>
<p>åœ¨ä»¥ä¸Šç« èŠ‚ï¼Œæˆ‘ä»¬å®ç°äº†å•ä¸ªå¡ç‰‡çš„äº¤äº’åŠåˆæˆï¼Œä½†å®é™…çš„éœ€æ±‚ä¸­è¿˜æœ‰æ‰¹é‡ç”Ÿæˆçš„éœ€æ±‚ï¼Œç”¨æ¥åˆæˆä¸åŒç­‰çº§çš„çƒæ˜Ÿå¡ï¼Œå› æ­¤æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å¤„ç†æ‰¹é‡ç”Ÿæˆç›¸å…³çš„é€»è¾‘ï¼ˆç¢äºç¯‡å¹…åŸå› ï¼Œè¿™é‡Œæˆ‘ä»¬å°±ä¸å±•ç¤ºä»£ç äº†ï¼Œä¸»è¦ä»¥æµç¨‹å›¾å½¢å¼æ¥å‘ˆç°ã€‚</p>
<p>ç»ç»Ÿè®¡ï¼Œç»è¿‡å„ç§æ‰‹æ®µä¼˜åŒ–åæœ¬æ´»åŠ¨ä¸­æ‰¹é‡åˆæˆ8å¼ å›¾æœ€å¿«ä»…éœ€3sï¼Œæœ€æ…¢10sï¼Œæ‰¹é‡åˆæˆè¿‡ç¨‹ç”¨æˆ·åŸºæœ¬æ˜¯æ„ŸçŸ¥ä¸åˆ°ã€‚</p>
<h3 data-id="heading-19">å…³é”®æŠ€æœ¯æ–¹æ¡ˆ</h3>
<ul>
<li>ç¦»çº¿æ¸²æŸ“éšè—å®¹å™¨ï¼šé¿å…å¸ƒå±€å¹²æ‰°</li>
<li>èµ„æºç¼“å­˜ä¸é¢„åŠ è½½ï¼šæå‡åˆæˆæ•ˆç‡</li>
<li>å¹¶å‘å·¥ä½œåç¨‹æ± ï¼šå¹³è¡¡æ€§èƒ½ä¸ç¨³å®šæ€§</li>
<li>å¤šå±‚é‡è¯•å®¹é”™ï¼šæå‡åˆæˆæˆåŠŸç‡</li>
<li>å›¾ç‰‡å¤„ç†ä¸å°ºå¯¸é€‚é…ï¼šä¿éšœåˆæˆè´¨é‡</li>
<li>ç»“åˆä¸šåŠ¡åœºæ™¯å®ç°æ‰¹é‡åˆæˆä¸­æ–­ä¸‹æ¬¡è®¿é—®é¡µé¢åå°ç»§ç»­ç”Ÿæˆçš„é€»è¾‘ï¼šä¿éšœåˆæˆåŠŸèƒ½ç¨³å®šæ€§ã€‚</li>
</ul>
<h3 data-id="heading-20">æ ¸å¿ƒæ¶æ„</h3>
<ul>
<li>èµ„æºç®¡ç†å±‚ï¼šè´Ÿè´£PAGåº“åŠ è½½ã€bufferç¼“å­˜ã€é¢„åŠ è½½è°ƒåº¦</li>
<li>ä»»åŠ¡å¤„ç†å±‚ï¼šå•ä¸ªæ¨¡æ¿çš„æ¸²æŸ“æµæ°´çº¿ï¼ŒåŒ…å«é‡è¯•æœºåˆ¶</li>
<li>å¹¶å‘æ§åˆ¶å±‚ï¼šå·¥ä½œåç¨‹æ± ç®¡ç†ï¼Œä»»åŠ¡é˜Ÿåˆ—è°ƒåº¦</li>
</ul>
<h3 data-id="heading-21">æ•´ä½“æ‰¹é‡åˆæˆæµç¨‹</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/612b7f364a01464682a2e01d60f4a0b5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=4uzWIL8yDryQcpg0M3eItoblv%2FQ%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>èŠ‚æ‹æ‹‰å–ï¼šæŒ‰ç…§å›ºå®šæ—¶é—´é—´éš”ä¾æ¬¡æ‹‰å–èµ„æºï¼Œè€Œéä¸€æ¬¡æ€§å¹¶å‘è·å–æ‰€æœ‰èµ„æº</p>
<h3 data-id="heading-22">å•ä¸ªæ¨¡æ¿å¤„ç†æµç¨‹</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a635fd380fd46e18a0c9653cbda2bca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=udNFW54g0aY206qaj%2B3b4dCCPIs%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c97ecbecda84aeeaa2e8375e5a4b760~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=USGY5wKbL7t%2B0UNqfSZZpDRFMSI%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<h3 data-id="heading-23">å¹¶å‘å·¥ä½œåç¨‹æ¨¡å¼</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e4ffb9d653c3461394a6d8ece9c75c42~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=zFxVlSb59WJjwShdqzKBQGKhQsE%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>å…±äº«æ¸¸æ ‡ï¼šå¤šä¸ªå·¥ä½œåç¨‹å…±åŒä½¿ç”¨çš„ä»»åŠ¡é˜Ÿåˆ—æŒ‡é’ˆï¼Œç”¨äºåè°ƒä»»åŠ¡åˆ†é…ã€‚</p>
<p>åŸå­è·å–ä»»åŠ¡ï¼šç¡®ä¿åœ¨å¹¶å‘ç¯å¢ƒä¸‹ï¼Œæ¯ä¸ªä»»åŠ¡åªè¢«ä¸€ä¸ªåç¨‹è·å–ï¼Œé¿å…é‡å¤å¤„ç†ã€‚</p>
<p>èµ„æºç®¡ç†ä¸ç¼“å­˜ç­–ç•¥</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1b994db9a114173bcf9805939ae4b92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339934&amp;x-signature=KO9Wip5uJjz2Mj6ipKUhzkf6CWU%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>æ‰¹é‡åˆæˆä¸å•å¡äº¤äº’çš„åŠŸèƒ½è½åœ°åï¼Œéœ€é’ˆå¯¹å¼€å‘è¿‡ç¨‹ä¸­å‡ºç°çš„å¡é¡¿ã€ç©ºå¸§ã€åŠ è½½æ…¢ç­‰é—®é¢˜è¿›è¡Œé’ˆå¯¹æ€§ä¼˜åŒ–ï¼ŒåŒæ—¶æ„å»ºå…¼å®¹æ€§æ£€æµ‹ä¸é™çº§æ–¹æ¡ˆï¼Œä¿éšœä¸åŒç¯å¢ƒä¸‹åŠŸèƒ½çš„ç¨³å®šå¯ç”¨ã€‚</p>
<h2 data-id="heading-24">å…«ã€æ€§èƒ½ä¼˜åŒ–ä¸é™çº§å…¼å®¹</h2>
<h3 data-id="heading-25">æ€§èƒ½ä¼˜åŒ–</h3>
<p>ä¸Šè¿°åŠŸèƒ½å¼€å‘å’Œå®ç°å¹¶éä¸€è¹´è€Œå°±ï¼Œè¿‡ç¨‹ä¸­é‡åˆ°å¾ˆå¤šé—®é¢˜ï¼Œè¯¸å¦‚ï¼š</p>
<ul>
<li>å›¾ç‰‡æ‹–åŠ¨å¡é¡¿</li>
<li>Canvaså¯¼å‡ºç©ºå›¾ã€å¯¼å‡ºå›¾ç‰‡æ¨¡ç³Š</li>
<li>æ‰¹é‡åˆæˆæ—¶é—´è¾ƒä¹…</li>
<li>PAGåˆå§‹åŠ è½½æ…¢</li>
<li>å¯¼å‡ºå›¾ç‰‡æ—¶é—´ä¹…</li>
</ul>
<p>ç­‰ç­‰é—®é¢˜ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬åœ¨å¼€å‘è¿‡ç¨‹ä¸­å°±å¯¹å„åŠŸèƒ½ç»„ä»¶è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ï¼Œå¤§ä½“å¦‚ä¸‹ï¼š</p>
<p><strong>PagPlayerï¼ˆPAGæ’­æ”¾å™¨ï¼‰</strong></p>
<p><strong>èµ„æºç®¡ç†ä¼˜åŒ–</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// srcå˜åŒ–æ—¶ä¸»åŠ¨é”€æ¯æ—§å®ä¾‹ï¼Œé‡Šæ”¾WebGL/PAGèµ„æº</span>
ifÂ (srcChanged) {
Â Â ifÂ (pagPlayer) {
Â  Â Â tryÂ {
Â  Â  Â  pagPlayer<span class="hljs-selector-class">.destroy</span>()
Â  Â  }Â catchÂ (e) {
Â  Â  Â Â console<span class="hljs-selector-class">.warn</span>('Destroy previous player failed:', e)
Â  Â  }
Â  }
}
</code></pre>
<p><strong>WebGLæ£€æŸ¥ä¸é™çº§</strong>ï¼š</p>
<ul>
<li>æ£€æŸ¥WebGLæ”¯æŒï¼Œä¸å¯ç”¨æ—¶é™çº§ä¸º2Dè­¦å‘Š</li>
<li>éªŒè¯CanvasçŠ¶æ€å’Œå°ºå¯¸</li>
<li>PAGViewåˆ›å»ºå¸¦é‡è¯•æœºåˆ¶</li>
</ul>
<p><strong>å­—ä½“é¢„æ³¨å†Œ</strong>ï¼š</p>
<ul>
<li>å¿…é¡»åœ¨åŠ è½½PAGæ–‡ä»¶ä¹‹å‰æ³¨å†Œå­—ä½“</li>
<li>ä½¿ç”¨Fileç±»å‹è¿›è¡Œå­—ä½“æ³¨å†Œ</li>
</ul>
<p><strong>CanvasImageEditorï¼ˆCanvaså›¾ç‰‡ç¼–è¾‘å™¨ï¼‰</strong></p>
<p><strong>é«˜DPIä¼˜åŒ–ï¼š</strong></p>
<ul>
<li>è‡ªåŠ¨æ£€æµ‹è®¾å¤‡åƒç´ æ¯”ï¼Œé€‚é…é«˜åˆ†è¾¨ç‡è®¾å¤‡</li>
<li>åˆ†ç¦»ç‰©ç†åƒç´ å’ŒCSSåƒç´ ï¼Œç¡®ä¿æ¸…æ™°åº¦</li>
</ul>
<p><strong>å†…å­˜ç®¡ç†</strong>ï¼š</p>
<ul>
<li>ç»„ä»¶å¸è½½æ—¶è‡ªåŠ¨æ¸…ç†Canvasèµ„æº</li>
<li>å¯ç”¨é«˜è´¨é‡å›¾åƒå¹³æ»‘ï¼Œé¿å…å‡ºç°è¾¹ç¼˜é”¯é½¿</li>
<li>ä½¿ç”¨CSS touch-actionæ§åˆ¶è§¦æ‘¸è¡Œä¸º</li>
</ul>
<p><strong>EditablePagPlayerï¼ˆå¯ç¼–è¾‘PAGæ’­æ”¾å™¨ï¼‰</strong></p>
<p><strong>æ™ºèƒ½æ‰¹é‡æ›´æ–°ç³»ç»Ÿï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// é«˜æ€§èƒ½å®æ—¶æ›´æ–° - ä½¿ç”¨RAF + æ‰¹é‡flush</span>
constÂ smartApplyToPag =Â <span class="hljs-built_in">useMemo</span>(() =&gt;Â {
Â Â returnÂ () =&gt;Â {
Â  Â  rafId =Â <span class="hljs-built_in">requestAnimationFrame</span>(asyncÂ () =&gt; {
Â  Â  Â Â awaitÂ <span class="hljs-built_in">applyToPag</span>()Â <span class="hljs-comment">// å¿«é€Ÿå›¾ç‰‡æ›¿æ¢ï¼ˆæ— flushï¼‰</span>
Â  Â  Â Â <span class="hljs-built_in">smartFlush</span>(batchUpdateRef.current)Â <span class="hljs-comment">// ç®¡ç†æ‰¹é‡flush</span>
Â  Â  })
Â  }
}, <span class="hljs-selector-attr">[]</span>)
</code></pre>
<p><strong>æ‰¹é‡flushç­–ç•¥ï¼š</strong></p>
<ul>
<li>è·ç¦»ä¸Šæ¬¡flushè¶…è¿‡100msç«‹å³flush</li>
<li>å¦åˆ™å»¶è¿Ÿ16ms~updateThrottle/2åˆå¹¶å¤šæ¬¡æ›´æ–°</li>
<li>å‡å°‘PAGåˆ·æ–°æ¬¡æ•°ï¼Œæå‡æ€§èƒ½</li>
</ul>
<p><strong>å†…å­˜ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>è‡ªåŠ¨ç®¡ç†Canvaså’ŒPAGèµ„æºç”Ÿå‘½å‘¨æœŸ</li>
<li>æ™ºèƒ½é¢„çƒ­ï¼šæ£€æµ‹Canvaså†…å®¹é¿å…ä¸å¿…è¦åˆå§‹åŒ–</li>
<li>èµ„æºå¤ç”¨ï¼šå¤ç”¨Canvaså…ƒç´ </li>
</ul>
<p><strong>PAGBatchComposerï¼ˆæ‰¹é‡PAGåˆæˆå™¨ï¼‰</strong></p>
<p><strong>é«˜å¹¶å‘å¤„ç†ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å·¥ä½œåç¨‹ï¼šæŒ‰é˜Ÿåˆ—å–ä»»åŠ¡ç›´è‡³è€—å°½æˆ–å–æ¶ˆ</span>
<span class="hljs-keyword">const</span>Â <span class="hljs-title function_">runWorker</span>Â =Â <span class="hljs-keyword">async</span>Â (<span class="hljs-params"/>) =&gt; {
Â Â <span class="hljs-keyword">while</span>Â (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelled</span>) {
Â  Â Â <span class="hljs-keyword">const</span>Â idx = cursor++
Â  Â Â <span class="hljs-keyword">if</span>Â (idx &gt;= total)Â <span class="hljs-keyword">break</span>
Â  Â Â <span class="hljs-comment">// å¤„ç†å•ä¸ªæ¨¡æ¿...</span>
Â  }
}
</code></pre>
<p><strong>æ™ºèƒ½é‡è¯•æœºåˆ¶</strong>ï¼š</p>
<ul>
<li>å¤–å±‚é‡è¯•ï¼šæœ€å¤š3æ¬¡æ•´ä½“é‡è¯•ï¼Œé€’å¢å»¶è¿Ÿ</li>
<li>å†…å±‚é‡è¯•ï¼šPAGæ“ä½œçº§åˆ«é‡è¯•2æ¬¡</li>
<li>é¦–æ¬¡å»¶è¿Ÿï¼šç¬¬ä¸€ä¸ªPAGå¤„ç†å¢åŠ 500mså»¶è¿Ÿ</li>
</ul>
<p><strong>å†…å­˜ç®¡ç†</strong>ï¼š</p>
<ul>
<li>æ¯ä¸ªæ¨¡æ¿å¤„ç†å®Œæˆåç«‹å³æ¸…ç†Canvaså’ŒPAGå¯¹è±¡</li>
<li>é›†æˆCanvasè®¡æ•°å™¨ç›‘æ§å†…å­˜ä½¿ç”¨</li>
<li>æ”¯æŒå¼ºåˆ¶æ¸…ç†è¶…æ—¶å®ä¾‹</li>
</ul>
<p><strong>æ€§èƒ½ç›‘æ§debugUtils</strong></p>
<ul>
<li>æä¾›è¯¦ç»†çš„æ€§èƒ½ç›‘æ§å’Œè°ƒè¯•æ—¥å¿—</li>
<li>æ”¯æŒæ‰¹é‡ç»Ÿè®¡åˆ†æï¼ˆååé‡ã€å¹³å‡æ—¶é—´ç­‰ï¼‰</li>
</ul>
<h3 data-id="heading-26">é™çº§å…¼å®¹</h3>
<p>ç”±äºæ ¸å¿ƒä¸šåŠ¡ä¾èµ– PAG æŠ€æœ¯æ ˆï¼Œè€Œ PAG è¿è¡Œéœ€ WebGL å’Œ WebAssembly çš„åŸºç¡€APIæ”¯æŒï¼Œå› æ­¤å¿…é¡»åœ¨åº”ç”¨åˆå§‹åŒ–é˜¶æ®µå¯¹è¿™äº›åŸºç¡€ API è¿›è¡Œå…¼å®¹æ€§æ£€æµ‹ï¼Œå¹¶é’ˆå¯¹ä¸æ”¯æŒçš„ç¯å¢ƒæ‰§è¡Œé™çº§ç­–ç•¥ï¼Œä»¥ä¿éšœæ ¸å¿ƒåŠŸèƒ½å¯ç”¨æ€§ã€‚</p>
<p>æ ¸å¿ƒAPIæ£€æµ‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span>Â <span class="hljs-keyword">function</span>Â <span class="hljs-title function_">isWebGLAvailable</span>(<span class="hljs-params"/>):Â <span class="hljs-built_in">boolean</span>Â {
Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-keyword">typeof</span>Â <span class="hljs-variable language_">window</span>Â ===Â <span class="hljs-string">'undefined'</span>)Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">false</span>
Â Â <span class="hljs-keyword">try</span>Â {
Â  Â Â <span class="hljs-keyword">const</span>Â canvas =Â <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'canvas'</span>)
Â  Â Â <span class="hljs-keyword">const</span>Â gl =
Â  Â  Â  canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'webgl'</span>) ||
Â  Â  Â  (canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'experimental-webgl'</span>)Â <span class="hljs-keyword">as</span>Â <span class="hljs-title class_">WebGLRenderingContext</span>Â |Â <span class="hljs-literal">null</span>)
Â  Â Â <span class="hljs-keyword">return</span>Â !!gl
Â  }Â <span class="hljs-keyword">catch</span>Â (e) {
Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">false</span>
Â  }
}


<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">function</span>Â <span class="hljs-title function_">isWasmAvailable</span>(<span class="hljs-params"/>):Â <span class="hljs-built_in">boolean</span>Â {
Â Â <span class="hljs-keyword">try</span>Â {
Â  Â Â <span class="hljs-keyword">const</span>Â hasBasic =
Â  Â  Â Â <span class="hljs-keyword">typeof</span>Â (globalThisÂ <span class="hljs-keyword">as</span>Â <span class="hljs-built_in">any</span>).<span class="hljs-property">WebAssembly</span>Â ===Â <span class="hljs-string">'object'</span>Â &amp;&amp;
Â  Â  Â Â <span class="hljs-keyword">typeof</span>Â (<span class="hljs-title class_">WebAssembly</span>Â <span class="hljs-keyword">as</span>Â <span class="hljs-built_in">any</span>).<span class="hljs-property">instantiate</span>Â ===Â <span class="hljs-string">'function'</span>
Â  Â Â <span class="hljs-keyword">if</span>Â (!hasBasic)Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">false</span>
Â  Â Â <span class="hljs-comment">// æœ€å°æ¨¡å—æ ¡éªŒï¼Œè§„é¿â€œå­˜åœ¨ä½†ä¸å¯ç”¨â€çš„æƒ…å†µ</span>
Â  Â Â <span class="hljs-keyword">const</span>Â bytes =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Uint8Array</span>([<span class="hljs-number">0x00</span>,Â <span class="hljs-number">0x61</span>,Â <span class="hljs-number">0x73</span>,Â <span class="hljs-number">0x6d</span>,Â <span class="hljs-number">0x01</span>,Â <span class="hljs-number">0x00</span>,Â <span class="hljs-number">0x00</span>,Â <span class="hljs-number">0x00</span>])
Â  Â Â <span class="hljs-keyword">const</span>Â mod =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">WebAssembly</span>.<span class="hljs-title class_">Module</span>(bytes)
Â  Â Â <span class="hljs-keyword">const</span>Â inst =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">WebAssembly</span>.<span class="hljs-title class_">Instance</span>(mod)
Â  Â Â <span class="hljs-keyword">return</span>Â instÂ <span class="hljs-keyword">instanceof</span>Â <span class="hljs-title class_">WebAssembly</span>.<span class="hljs-property">Instance</span>
Â  }Â <span class="hljs-keyword">catch</span>Â (e) {
Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">false</span>
Â  }
}


<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">function</span>Â <span class="hljs-title function_">isPagRuntimeAvailable</span>(<span class="hljs-params"/>):Â <span class="hljs-built_in">boolean</span>Â {
Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title function_">isWebGLAvailable</span>() &amp;&amp;Â <span class="hljs-title function_">isWasmAvailable</span>()
}
</code></pre>
<p><strong>ç¯å¢ƒé€‚é…ç­–ç•¥</strong></p>
<ul>
<li>å…¼å®¹ç¯å¢ƒï¼ˆæ£€æµ‹é€šè¿‡ï¼‰ï¼šç›´æ¥æ‰§è¡Œ H5 ç«¯ PAG åˆå§‹åŒ–æµç¨‹ï¼Œå¯ç”¨å®Œæ•´çš„å‰ç«¯äº¤äº’ç¼–è¾‘èƒ½åŠ›ã€‚</li>
<li>ä¸å…¼å®¹ç¯å¢ƒï¼ˆæ£€æµ‹å¤±è´¥ï¼‰ï¼šè‡ªåŠ¨åˆ‡æ¢è‡³æœåŠ¡ç«¯åˆæˆé“¾è·¯ï¼Œé€šè¿‡é¢„ç”Ÿæˆé™æ€å¡ç‰‡ä¿éšœæ ¸å¿ƒåŠŸèƒ½å¯ç”¨ï¼Œç¡®ä¿ç”¨æˆ·ä»èƒ½å®Œæˆçƒæ˜Ÿå¡ç”Ÿæˆçš„åŸºç¡€æµç¨‹ã€‚</li>
</ul>
<h2 data-id="heading-27">ä¹ã€å°ç»“</h2>
<p>æœ¬æ¬¡ã€Œç”¨ç¯®çƒè®¤è¯†æˆ‘ã€çƒæ˜Ÿå¡ç”ŸæˆåŠŸèƒ½å¼€å‘ï¼Œå›´ç»• â€œç”¨æˆ·è‡ªä¸»è°ƒæ•´ + è·¨ç«¯ä¸€è‡´æ¸²æŸ“â€ æ ¸å¿ƒç›®æ ‡ï¼Œé€šè¿‡ PAG æŠ€æœ¯ä¸ Canvas äº¤äº’çš„æ·±åº¦ç»“åˆï¼Œæ„å»ºäº†ä»å•å¡ç¼–è¾‘åˆ°æ‰¹é‡åˆæˆçš„å®Œæ•´æŠ€æœ¯é“¾è·¯ï¼Œå¯ä»é—®é¢˜è§£å†³ã€æŠ€æœ¯æ²‰æ·€ã€ä¸šåŠ¡ä»·å€¼ä¸‰æ–¹é¢æ€»ç»“æ ¸å¿ƒæˆæœï¼š</p>
<p><strong>é—®é¢˜è§£å†³ï¼šè§£å†³ä¸šåŠ¡ç—›ç‚¹ï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒ</strong></p>
<p>é’ˆå¯¹åˆæœŸ â€œæœåŠ¡ç«¯å›ºå®šåˆæˆå¯¼è‡´æ„å›¾åå·®â€ çš„æ ¸å¿ƒç—›ç‚¹ï¼Œé€šè¿‡ H5 ç«¯æ‰¿æ¥å…³é”®é“¾è·¯ï¼Œä¿éšœæ´»åŠ¨ç©æ³•å®Œæ•´æ€§ï¼š</p>
<ul>
<li>äº¤äº’è‡ªä¸»æ€§ï¼šåŸºäº Canvas å°è£…çš„CanvasImageEditorç»„ä»¶ï¼Œæ”¯æŒå•æŒ‡æ‹–æ‹½ã€åŒæŒ‡ç¼©æ”¾ / æ—‹è½¬ï¼Œè®©ç”¨æˆ·å¯ç²¾å‡†è°ƒæ•´äººåƒæ„å›¾ï¼Œè§£å†³ â€œå›ºå®šåˆæˆæ— æ³•é€‚é…ä¸ªæ€§åŒ–éœ€æ±‚â€ é—®é¢˜ï¼›</li>
<li>é¢„è§ˆå®æ—¶æ€§ï¼šè®¾è®¡ â€œäº¤äº’æ„ŸçŸ¥ - åŒæ­¥è°ƒåº¦ - æ¸²æŸ“æ‰§è¡Œâ€ ä¸‰å±‚æ¨¡å‹ï¼Œé€šè¿‡å¤ç”¨ Canvas å…ƒç´ ã€æ™ºèƒ½æ‰¹é‡è°ƒåº¦ç­‰æ–¹æ¡ˆï¼Œå®ç°æ“ä½œä¸ PAG é¢„è§ˆçš„å³æ—¶åŒæ­¥ï¼Œé¿å… â€œè°ƒæ•´åå»¶è¿Ÿåé¦ˆâ€ çš„å‰²è£‚æ„Ÿï¼›</li>
<li>åœºæ™¯å…¼å®¹æ€§ï¼šé’ˆå¯¹ PAG åŠ è½½å¤±è´¥ã€WebGL ä¸æ”¯æŒç­‰è¾¹ç•Œåœºæ™¯ï¼Œè®¾è®¡é™æ€å›¾å±‚å…œåº•ã€æœåŠ¡ç«¯åˆæˆé™çº§ã€æˆªå¸§å‰æ¸²æŸ“åŒæ­¥ç­‰æ–¹æ¡ˆï¼Œä¿éšœåŠŸèƒ½é«˜å¯ç”¨æ€§ã€‚</li>
</ul>
<p><strong>æŠ€æœ¯æ²‰æ·€</strong></p>
<p>æœ¬æ¬¡å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå›´ç»• PAG æŠ€æœ¯åœ¨ H5 ç«¯çš„åº”ç”¨ï¼Œæ²‰æ·€å‡ºä¸€å¥—æ ‡å‡†åŒ–çš„æŠ€æœ¯æ–¹æ¡ˆä¸ç»„ä»¶ä½“ç³»ï¼Œå¯å¤ç”¨äºåç»­å›¾ç‰‡ç¼–è¾‘ã€åŠ¨æ•ˆåˆæˆç±»éœ€æ±‚ï¼š</p>
<ul>
<li>ç»„ä»¶åŒ–å°è£…ï¼šæ‹†åˆ†å‡ºPagPlayerï¼ˆåŸºç¡€æ’­æ”¾ä¸å›¾å±‚æ›¿æ¢ï¼‰ã€CanvasImageEditorï¼ˆæ‰‹åŠ¿äº¤äº’ï¼‰ã€EditablePagPlayerï¼ˆäº¤äº’ä¸é¢„è§ˆåŒæ­¥ï¼‰ã€PAGBatchComposerï¼ˆæ‰¹é‡åˆæˆï¼‰å››å¤§æ ¸å¿ƒç»„ä»¶ï¼Œå„ç»„ä»¶èŒè´£å•ä¸€ã€æ¥å£æ¸…æ™°ï¼Œæ”¯æŒçµæ´»ç»„åˆï¼›</li>
<li>æ€§èƒ½ä¼˜åŒ–ï¼šé€šè¿‡ â€œé«˜æ¸…é€‚é…ï¼ˆDPR å¤„ç†ï¼‰ã€èµ„æºå¤ç”¨ï¼ˆCanvas ç›´æ¥ä¼ é€’ï¼‰ã€è°ƒåº¦ä¼˜åŒ–ï¼ˆRAF åˆå¹¶æ›´æ–°ï¼‰ã€å†…å­˜ç®¡ç†ï¼ˆå®ä¾‹åŠæ—¶é”€æ¯ï¼‰â€ ç­‰ä¼˜åŒ–æ–¹å‘ï¼Œä¸ºåç»­å¤æ‚åŠŸèƒ½çš„æ€§èƒ½è°ƒä¼˜æä¾›å‚è€ƒèŒƒä¾‹ï¼›</li>
<li>é—®é¢˜è§£å†³æ¡ˆä¾‹ï¼šè®°å½• PAG å­—ä½“æ³¨å†Œå¤±æ•ˆã€æˆªå¸§ç©ºå¸§ã€æ‰¹é‡åˆæˆå¡é¡¿ç­‰å…¸å‹é—®é¢˜çš„æ’æŸ¥æ€è·¯ä¸è§£å†³æ–¹æ¡ˆï¼Œå½¢æˆæŠ€æœ¯æ–‡æ¡£ï¼Œé™ä½åç»­å›¢é˜Ÿä½¿ç”¨ PAG çš„é—¨æ§›ã€‚</li>
</ul>
<p><strong>ä¸šåŠ¡ä»·å€¼ï¼šæ”¯æ’‘æ´»åŠ¨çˆ†å‘ï¼Œæ‹“å±•æŠ€æœ¯è¾¹ç•Œ</strong></p>
<p>ä»ä¸šåŠ¡è½åœ°æ•ˆæœæ¥çœ‹ï¼Œæœ¬æ¬¡æŠ€æœ¯æ–¹æ¡ˆä¸ä»…æ»¡è¶³äº†ã€Œç”¨ç¯®çƒè®¤è¯†æˆ‘ã€æ´»åŠ¨çš„æ ¸å¿ƒéœ€æ±‚ï¼Œæ›´ä¸ºç¤¾åŒºä¾§åç»­è§†è§‰åŒ–åŠŸèƒ½æä¾›äº†æŠ€æœ¯æ”¯æ’‘ï¼š</p>
<ul>
<li>æ´»åŠ¨ä¿éšœï¼šçƒæ˜Ÿå¡ç”ŸæˆåŠŸèƒ½ä¸Šçº¿åï¼Œæœªå‡ºç°å› æŠ€æœ¯é—®é¢˜å¯¼è‡´çš„åŠŸèƒ½ä¸å¯ç”¨ã€‚</li>
<li>æŠ€æœ¯èƒ½åŠ›æ‹“å±•ï¼šé¦–æ¬¡åœ¨ç¤¾åŒº H5 ç«¯è½åœ° PAG åŠ¨æ•ˆåˆæˆä¸æ‰‹åŠ¿äº¤äº’ç»“åˆçš„æ–¹æ¡ˆï¼Œå¡«è¡¥äº† â€œå‰ç«¯ PAG åº”ç”¨â€ çš„æŠ€æœ¯ç©ºç™½ï¼Œä¸ºåç»­ä¸€äº›å¤æ‚äº¤äº’å¥ å®šåŸºç¡€ã€‚</li>
</ul>
<p><strong>åç»­ä¼˜åŒ–æ–¹å‘</strong></p>
<p>å°½ç®¡å½“å‰æ–¹æ¡ˆå·²æ»¡è¶³ä¸šåŠ¡éœ€æ±‚ï¼Œä½†ä»æœ‰å¯è¿›ä¸€æ­¥ä¼˜åŒ–çš„ç©ºé—´ï¼š</p>
<ul>
<li>æ€§èƒ½å†æå‡ï¼šæ‰¹é‡åˆæˆåœºæ™¯ä¸‹ï¼Œå¯æ¢ç´¢ Web Worker åˆ†æ‹… PAG è§£æå‹åŠ›ï¼Œå‡å°‘ä¸»çº¿ç¨‹é˜»å¡ã€‚</li>
<li>åŠŸèƒ½æ‰©å±•ï¼šåœ¨CanvasImageEditorä¸­å¢åŠ å›¾ç‰‡è£å‰ªã€æ»¤é•œå åŠ ç­‰åŠŸèƒ½ï¼Œæ‹“å±•ç»„ä»¶çš„é€‚ç”¨åœºæ™¯ã€‚</li>
</ul>
<h3 data-id="heading-28">å¾€æœŸå›é¡¾</h3>
<ol>
<li>
<p>Ant Design 6.0 å°é²œï¼šä¸Šæ‰‹ç°ä»£åŒ–ç»„ä»¶å¼€å‘ï½œå¾—ç‰©æŠ€æœ¯</p>
</li>
<li>
<p>Java è®¾è®¡æ¨¡å¼ï¼šåŸç†ã€æ¡†æ¶åº”ç”¨ä¸å®æˆ˜å…¨è§£æï½œå¾—ç‰©æŠ€æœ¯</p>
</li>
<li>
<p>Goè¯­è¨€åœ¨é«˜å¹¶å‘é«˜å¯ç”¨ç³»ç»Ÿä¸­çš„å®è·µä¸è§£å†³æ–¹æ¡ˆï½œå¾—ç‰©æŠ€æœ¯</p>
</li>
<li>
<p>ä»0åˆ°1æ­å»ºä¸€ä¸ªæ™ºèƒ½åˆ†æOBSåŸ‹ç‚¹æ•°æ®çš„AI Agentï½œå¾—ç‰©æŠ€æœ¯</p>
</li>
<li>
<p>æ•°æ®åº“AIæ–¹å‘æ¢ç´¢-MCPåŸç†è§£æ&amp;DBæ–¹å‘å®æˆ˜ï½œå¾—ç‰©æŠ€æœ¯</p>
</li>
</ol>
<h3 data-id="heading-29">æ–‡ /æ— é™</h3>
<p>å…³æ³¨å¾—ç‰©æŠ€æœ¯ï¼Œæ¯å‘¨æ›´æ–°æŠ€æœ¯å¹²è´§</p>
<p>è¦æ˜¯è§‰å¾—æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œæ¬¢è¿è¯„è®ºè½¬å‘ç‚¹èµï½</p>
<p>æœªç»å¾—ç‰©æŠ€æœ¯è®¸å¯ä¸¥ç¦è½¬è½½ï¼Œå¦åˆ™ä¾æ³•è¿½ç©¶æ³•å¾‹è´£ä»»ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å›æ”¶å›¢é˜ŸåŸºäºCursoré›†æˆMCPçš„æ™ºèƒ½ä»£ç ä¿®å¤æç¤ºè¯ç”Ÿæˆå®è·µ]]></title>    <link>https://juejin.cn/post/7587998744294752262</link>    <guid>https://juejin.cn/post/7587998744294752262</guid>    <pubDate>2025-12-26T10:29:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587998744294752262" data-draft-id="7588002126258356230" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å›æ”¶å›¢é˜ŸåŸºäºCursoré›†æˆMCPçš„æ™ºèƒ½ä»£ç ä¿®å¤æç¤ºè¯ç”Ÿæˆå®è·µ"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜,äººå·¥æ™ºèƒ½,Python"/> <meta itemprop="datePublished" content="2025-12-26T10:29:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è½¬è½¬æŠ€æœ¯å›¢é˜Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/606586148237431"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å›æ”¶å›¢é˜ŸåŸºäºCursoré›†æˆMCPçš„æ™ºèƒ½ä»£ç ä¿®å¤æç¤ºè¯ç”Ÿæˆå®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/606586148237431/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è½¬è½¬æŠ€æœ¯å›¢é˜Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T10:29:56.000Z" title="Fri Dec 26 2025 10:29:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ç—›ç‚¹</h2>
<h3 data-id="heading-1">ç—›ç‚¹ä¸€ï¼šä¸ºä»€ä¹ˆæˆ‘çš„Tokenæ¶ˆè€—çš„è¿™ä¹ˆå¿«</h3>
<p>Tokençš„æ¶ˆè€—é‡é€šå¸¸å—åˆ°ä¸‹é¢ä¸¤ä¸ªå› ç´ çš„å½±å“</p>
<ul>
<li>è¾“å…¥å’Œè¾“å‡ºçš„Tokenæ•°é‡ï¼šè¾“å…¥çš„Tokenè¶Šå¤šï¼Œè¾“å‡ºçš„Tokenä¹Ÿä¼šç›¸åº”å¢åŠ ï¼Œå› ä¸ºæ¨¡å‹ä¼šåŸºäºè¾“å…¥çš„ä¸Šä¸‹æ–‡è¿›è¡Œå†…å®¹ç”Ÿæˆã€‚</li>
<li>ä»»åŠ¡å¤æ‚æ€§ï¼šæ›´å¤æ‚çš„ä»»åŠ¡é€šå¸¸éœ€è¦æ¶ˆè€—æ›´å¤šçš„Tokenï¼Œè€Œå¤šæ¨¡æ€çš„Agentå¾€å¾€æ¶ˆè€—çš„Tokenä¼šæ›´é«˜ã€‚</li>
</ul>
<p>ä¸ºä»€ä¹ˆæ¨¡ç³Šçš„æç¤ºè¯ä¼šå¢åŠ Tokençš„æ¶ˆè€—é‡ï¼Ÿ</p>
<ul>
<li>æ¨¡ç³Šçš„æç¤ºè¯å¯èƒ½åŒ…å«å¤§é‡ä¸è¾“å‡ºä¸ç›¸å…³çš„å†…å®¹ï¼Œå¢åŠ è¾“å…¥çš„Tokené‡ã€‚</li>
<li>æ¨¡ç³Šçš„æç¤ºè¯é€šå¸¸ç¼ºä¹å…·ä½“ç»†èŠ‚æˆ–æ˜ç¡®çº¦æŸï¼Œå¯¼è‡´æ¨¡å‹æ— æ³•ç›´æ¥ç†è§£ç”¨æˆ·æ„å›¾ã€‚ä¸ºäº†è¦†ç›–å¯èƒ½çš„è§£é‡Šï¼Œæ¨¡å‹å€¾å‘äºç”Ÿæˆæ›´é•¿ã€æ›´å…¨é¢çš„å“åº”ï¼Œä»¥é¿å…é—æ¼å…³é”®ä¿¡æ¯ï¼Œä»è€Œå¢åŠ è¾“å‡ºtokenæ•°é‡ã€‚</li>
<li>æ¨¡ç³Šçš„æç¤ºè¯å¾€å¾€æ— æ³•ç²¾å‡†çš„ç”Ÿæˆç”¨æˆ·æƒ³è¦çš„å†…å®¹ã€‚ç”¨æˆ·å¯èƒ½å› è¾“å‡ºä¸ç¬¦åˆé¢„æœŸè€Œå¤šæ¬¡ä¿®æ”¹æç¤ºï¼Œå½¢æˆæ— æ•ˆäº¤äº’å¾ªç¯ï¼Œæ— å½¢ä¸­æµªè´¹Tokenã€‚</li>
</ul>
<h3 data-id="heading-2">ç—›ç‚¹äºŒï¼šAIä¿®å¤ä»£ç ä¸ºä»€ä¹ˆæ€»æ˜¯"å·®ç‚¹æ„æ€"ï¼Ÿ</h3>
<p>ä¸€èˆ¬éƒ½æ˜¯æ‹¿åˆ°Sonar æ‰«æç»“æœå¤åˆ¶ç²˜è´´, è®©AIä¿®å¤åï¼Œä¸€ä¸ªä¸€ä¸ªæ”¹, åˆå¤ªæ…¢, å¤ªå¤šé—®é¢˜è¦ä¹ˆä¿®å¤ä¸å‡†ç¡®ï¼Œè¦ä¹ˆæŠŠå¥½çš„ä»£ç ä¹Ÿæ”¹åäº†ï¼Œè¿˜æœ‰å°±æ˜¯é—®é¢˜
å¤ªå¤š, ä¸Šä¸‹æ–‡è¶…é™ä¿®æ”¹å¤±è´¥</p>
<p><strong>ä¸¾ä¸ªçœŸå®çš„ä¾‹å­ï¼š</strong>
SonaræŠ¥å‘Šï¼š<code>ActivityServiceImpl.java</code> ç¬¬120è¡Œå­˜åœ¨ç©ºæŒ‡é’ˆé£é™©</p>
<p>æˆ‘çš„æç¤ºè¯ï¼ˆç¬¬ä¸€ç‰ˆï¼‰ï¼š</p>
<pre><code class="hljs language-css" lang="css">è¯·ä¿®å¤ä»¥ä¸‹é—®é¢˜ï¼šç¬¬<span class="hljs-number">120</span>è¡Œå­˜åœ¨ç©ºæŒ‡é’ˆé£é™©
ä»£ç ï¼š
<span class="hljs-selector-attr">[ç²˜è´´æ•´ä¸ªActivityServiceImpl.javaæ–‡ä»¶ï¼Œå¯èƒ½æ˜¯å‡ åƒè¡Œ]</span>
</code></pre>
<p>AIçš„å›å¤ï¼š</p>
<ul>
<li>æƒ…å†µ1ï¼š"è¿™ä¸ªæ–‡ä»¶å¤ªé•¿äº†ï¼Œè¯·æä¾›æ›´å…·ä½“çš„ä»£ç ç‰‡æ®µ"</li>
<li>æƒ…å†µ2ï¼šä¿®å¤äº†ç©ºæŒ‡é’ˆï¼Œä½†æŠŠæ—è¾¹çš„ä¸šåŠ¡é€»è¾‘ä¹Ÿæ”¹äº†</li>
<li>æƒ…å†µ3ï¼š"Tokenè¶…å‡ºé™åˆ¶ï¼Œæ— æ³•å¤„ç†"</li>
</ul>
<h3 data-id="heading-3">é—®é¢˜æ ¹æºåœ¨å“ªï¼Ÿ</h3>
<ol>
<li><strong>ä¸Šä¸‹æ–‡å†—ä½™</strong>ï¼šè¶…å¤§æ–‡ä»¶ä»£ç ä¸­ï¼ŒçœŸæ­£ç›¸å…³çš„å¯èƒ½åªæœ‰20è¡Œ</li>
<li><strong>ç¼ºä¹è§„èŒƒå¼•å¯¼</strong>ï¼šæ²¡å‘Šè¯‰AIè¦éµå¾ªä»€ä¹ˆç¼–ç è§„èŒƒ</li>
<li><strong>ä¿¡æ¯ä¸å‡†ç¡®</strong>ï¼šæ²¡æœ‰ç²¾ç¡®æŒ‡å‡ºé—®é¢˜åœ¨å“ªä¸ªæ–¹æ³•ã€ä»€ä¹ˆç»“æ„ä¸­</li>
<li><strong>æ²¡æœ‰ç¤ºä¾‹</strong>ï¼šAIç¼ºä¹ç±»ä¼¼é—®é¢˜çš„ä¿®å¤å‚è€ƒ</li>
</ol>
<h2 data-id="heading-4">äºŒã€è½¬æœºï¼šCursorç»“åˆMCPæ‰“é€ è‡ªåŠ¨åŒ–ä¿®å¤æµç¨‹</h2>
<p>å…³é”®é—®é¢˜åœ¨äºï¼š<strong>å¦‚ä½•å°†Sonaræ‰«æç»“æœè½¬æ¢ä¸ºAIèƒ½é«˜æ•ˆç†è§£çš„ç»“æ„åŒ–æç¤ºè¯</strong>ã€‚</p>
<p>äºæ˜¯ï¼Œæˆ‘åˆ©ç”¨MCPï¼ˆModel Context Protocolï¼‰åè®®ä¸ºCursorå¼€å‘äº†ä¸€å¥—æ™ºèƒ½æç¤ºè¯ç”Ÿæˆç³»ç»Ÿã€‚</p>
<h3 data-id="heading-5">ä»€ä¹ˆæ˜¯MCPï¼Ÿ</h3>
<p>MCPï¼ˆModel Context Protocolï¼‰æ˜¯ä¸€ä¸ªå¼€æ”¾åè®®ï¼ŒCursoræ”¯æŒè¿™ä¸ªåè®®ï¼Œå…è®¸æˆ‘ä»¬é€šè¿‡Pythonç­‰è¯­è¨€ç¼–å†™è‡ªå®šä¹‰å·¥å…·ï¼Œç›´æ¥é›†æˆåˆ°Cursorçš„AIåŠ©æ‰‹ä¸­ã€‚ç®€å•è¯´å°±æ˜¯ï¼š<strong>è®©AIæ‹¥æœ‰è°ƒç”¨ä½ è‡ªå·±ç¼–å†™çš„å·¥å…·çš„èƒ½åŠ›</strong>ã€‚</p>
<h3 data-id="heading-6">æˆ‘çš„æ–¹æ¡ˆæ¶æ„</h3>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cdb0e7f30b144b9db7dde7e0415c66d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L2s6L2s5oqA5pyv5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767349796&amp;x-signature=muUTZJGKL%2FsAHZewB9m0evKbyqU%3D" width="500" loading="lazy"/>
<h2 data-id="heading-7">ä¸‰ã€æ ¸å¿ƒæ–¹æ¡ˆï¼šå…­æ­¥æ™ºèƒ½æç¤ºè¯ç”Ÿæˆæ³•</h2>
<p>è¿™å¥—æ–¹æ¡ˆçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š<strong>è®©AIç²¾ç¡®ç†è§£é—®é¢˜ï¼Œè€Œä¸æ˜¯è®©AIå»çŒœæµ‹é—®é¢˜</strong>ã€‚</p>
<p>æ•´ä¸ªç³»ç»ŸåŸºäºä»¥ä¸‹6ä¸ªæ­¥éª¤æ„å»ºï¼š</p>
<h4 data-id="heading-8">ç¬¬ä¸€æ­¥ï¼šé—®é¢˜ç±»å‹è¯†åˆ«</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">IssueTypeClassifier</span>:
    <span class="hljs-string">"""å°†Sonarè§„åˆ™æ˜ å°„åˆ°é—®é¢˜ç±»å‹"""</span>
    
    RULE_MAPPING = {
        <span class="hljs-comment"># ç©ºæŒ‡é’ˆé—®é¢˜</span>
        <span class="hljs-string">"java:S2259"</span>: <span class="hljs-string">"NullPointer"</span>,
        <span class="hljs-string">"java:S2637"</span>: <span class="hljs-string">"NullPointer"</span>,
        
        <span class="hljs-comment"># èµ„æºæ³„éœ²</span>
        <span class="hljs-string">"java:S2095"</span>: <span class="hljs-string">"ResourceLeak"</span>,
        <span class="hljs-string">"java:S2093"</span>: <span class="hljs-string">"ResourceLeak"</span>,
        
        <span class="hljs-comment"># å®‰å…¨æ¼æ´</span>
        <span class="hljs-string">"java:S3649"</span>: <span class="hljs-string">"SQLInjection"</span>,
        <span class="hljs-string">"java:S2076"</span>: <span class="hljs-string">"CommandInjection"</span>,
        
        <span class="hljs-comment"># ä»£ç è§„èŒƒ</span>
        <span class="hljs-string">"java:S117"</span>: <span class="hljs-string">"NamingConvention"</span>,
        <span class="hljs-string">"java:S1192"</span>: <span class="hljs-string">"DuplicateString"</span>,
    }
    
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">classify</span>(<span class="hljs-params">rule_key: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""æ ¹æ®è§„åˆ™IDåˆ†ç±»é—®é¢˜ç±»å‹"""</span>
        <span class="hljs-keyword">return</span> IssueTypeClassifier.RULE_MAPPING.get(
            rule_key, 
            <span class="hljs-string">"General"</span>
        )
</code></pre>
<h4 data-id="heading-9">ç¬¬äºŒæ­¥ï¼šASTä»£ç ç»“æ„è§£æ</h4>
<p><strong>ä»€ä¹ˆæ˜¯ASTï¼Ÿ</strong></p>
<p>ASTï¼ˆAbstract Syntax Treeï¼ŒæŠ½è±¡è¯­æ³•æ ‘ï¼‰æ˜¯å°†ä»£ç ç†è§£æˆæ ‘å½¢ç»“æ„çš„æŠ€æœ¯ã€‚</p>
<p>å½“Sonarå‘Šè¯‰ä½ "ç¬¬120è¡Œæœ‰ç©ºæŒ‡é’ˆé—®é¢˜"ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ï¼š</p>
<ul>
<li>ç¬¬120è¡Œåœ¨å“ªä¸ª<strong>æ–¹æ³•</strong>é‡Œï¼Ÿ</li>
<li>è¿™ä¸ªæ–¹æ³•ä»å“ªè¡Œ<strong>å¼€å§‹</strong>ï¼Œåˆ°å“ªè¡Œ<strong>ç»“æŸ</strong>ï¼Ÿ</li>
<li>æ–¹æ³•çš„å®Œæ•´ä¿¡æ¯ï¼ˆæ–¹æ³•åã€å‚æ•°ã€è¿”å›å€¼ï¼‰</li>
</ul>
<p><strong>ASTè§£æ = åƒç¼–è¯‘å™¨ä¸€æ ·ç†è§£ä»£ç ç»“æ„</strong></p>
<p>æƒ³è±¡ä»£ç æ˜¯ä¸€ä¸ªå®¶æ—ï¼ŒASTå°±æ˜¯å®¶è°±æ ‘ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">ClassDeclaration:</span> <span class="hljs-string">ActivityServiceImplï¼ˆç±»ï¼‰</span>
 <span class="hljs-string">â”‚</span>
 <span class="hljs-string">â”œâ”€</span> <span class="hljs-attr">FieldDeclaration:</span> <span class="hljs-string">activityFacadeHelperï¼ˆæˆå‘˜å˜é‡ï¼‰</span>
 <span class="hljs-string">â”‚</span>
 <span class="hljs-string">â”œâ”€</span> <span class="hljs-attr">MethodDeclaration:</span> <span class="hljs-string">queryActivityListWithNewImeiï¼ˆæ–¹æ³•ï¼‰</span>
 <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€</span> <span class="hljs-attr">position:</span> <span class="hljs-string">line</span> <span class="hljs-number">106</span>
 <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€</span> <span class="hljs-attr">parameters:</span> [<span class="hljs-string">Long</span> <span class="hljs-string">orderId</span>, <span class="hljs-string">String</span> <span class="hljs-string">newMachineUuid</span>]
 <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€</span> <span class="hljs-attr">return_type:</span> <span class="hljs-string">OrderAllowActivityMiVO</span>
 <span class="hljs-string">â”‚</span>   <span class="hljs-string">â””â”€</span> <span class="hljs-attr">body:</span> {<span class="hljs-string">...</span>}  <span class="hljs-string">â†</span> <span class="hljs-string">ç¬¬120è¡Œåœ¨è¿™é‡Œ</span>
 <span class="hljs-string">â”‚</span>
 <span class="hljs-string">â””â”€</span> <span class="hljs-attr">MethodDeclaration:</span> <span class="hljs-string">editActivityListWithNewImeiï¼ˆå¦ä¸€ä¸ªæ–¹æ³•ï¼‰</span>
</code></pre>
<p><strong>ä½¿ç”¨javalangè¿›è¡ŒASTè§£æ</strong></p>
<p>javalangæ˜¯ä¸€ä¸ªçº¯Pythonåº“ï¼Œç”¨Pythoné‡æ–°å®ç°äº†Javaè¯­æ³•è§£æå™¨ï¼Œ<strong>ä¸éœ€è¦å®‰è£…Javaç¯å¢ƒ</strong>ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> javalang

<span class="hljs-keyword">class</span> <span class="hljs-title class_">JavaCodeParser</span>:
    <span class="hljs-string">"""Javaä»£ç ç»“æ„è§£æå™¨ - ä½¿ç”¨ASTç²¾ç¡®è§£æ"""</span>
    
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_method_context</span>(<span class="hljs-params">file_path: <span class="hljs-built_in">str</span>, line_number: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-type">Optional</span>[<span class="hljs-type">Dict</span>]:
        <span class="hljs-string">"""ä½¿ç”¨javalangè¿›è¡ŒASTè§£æï¼Œç²¾ç¡®å®šä½æ–¹æ³•"""</span>
        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">'r'</span>, encoding=<span class="hljs-string">'utf-8'</span>) <span class="hljs-keyword">as</span> f:
            code = f.read()
        
        <span class="hljs-comment"># 1. è§£æJavaä»£ç ï¼Œç”ŸæˆASTï¼ˆè¯­æ³•æ ‘ï¼‰</span>
        tree = javalang.parse.parse(code)
        
        <span class="hljs-comment"># 2. éå†ASTï¼ŒæŸ¥æ‰¾åŒ…å«ç›®æ ‡è¡Œçš„æ–¹æ³•èŠ‚ç‚¹</span>
        <span class="hljs-keyword">for</span> path, node <span class="hljs-keyword">in</span> tree.<span class="hljs-built_in">filter</span>(javalang.tree.MethodDeclaration):
            method_start = node.position.line
            method_end = calculate_method_end(node)  <span class="hljs-comment"># è®¡ç®—æ–¹æ³•ç»“æŸä½ç½®</span>
            
            <span class="hljs-comment"># 3. æ£€æŸ¥ç›®æ ‡è¡Œæ˜¯å¦åœ¨æ­¤æ–¹æ³•èŒƒå›´å†…</span>
            <span class="hljs-keyword">if</span> method_start &lt;= line_number &lt;= method_end:
                <span class="hljs-keyword">return</span> {
                    <span class="hljs-string">'class_name'</span>: extract_class_name(path),
                    <span class="hljs-string">'method_name'</span>: node.name,              <span class="hljs-comment"># æ–¹æ³•å</span>
                    <span class="hljs-string">'start_line'</span>: method_start,            <span class="hljs-comment"># æ–¹æ³•å¼€å§‹è¡Œ</span>
                    <span class="hljs-string">'end_line'</span>: method_end,                <span class="hljs-comment"># æ–¹æ³•ç»“æŸè¡Œ</span>
                    <span class="hljs-string">'modifiers'</span>: node.modifiers,           <span class="hljs-comment"># ['public', 'static']</span>
                    <span class="hljs-string">'return_type'</span>: node.return_type.name,  <span class="hljs-comment"># è¿”å›å€¼ç±»å‹</span>
                    <span class="hljs-string">'parameters'</span>: [p.name <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> node.parameters],  <span class="hljs-comment"># å‚æ•°åˆ—è¡¨</span>
                }
        
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
</code></pre>
<p><strong>ASTè§£æçš„ä»·å€¼</strong>ï¼š</p>
<ol>
<li><strong>ç²¾ç¡®å®šä½</strong>ï¼šç›´æ¥çŸ¥é“ç¬¬120è¡Œåœ¨<code>queryActivityListWithNewImei</code>æ–¹æ³•å†…ï¼Œè€Œä¸æ˜¯<code>editActivityListWithNewIme</code>æ–¹æ³•</li>
<li><strong>å®Œæ•´ä¿¡æ¯</strong>ï¼šè·å–æ–¹æ³•åã€å‚æ•°ç±»å‹ã€è¿”å›å€¼ç­‰å…ƒä¿¡æ¯</li>
<li><strong>è¯­æ³•ç†è§£</strong>ï¼šåƒç¼–è¯‘å™¨ä¸€æ ·ç†è§£Javaè¯­æ³•ï¼Œä¸ä¼šè¢«æ³¨é‡Šã€å­—ç¬¦ä¸²ã€Lambdaè¡¨è¾¾å¼å¹²æ‰°</li>
<li><strong>é«˜å‡†ç¡®ç‡</strong>ï¼šå‡†ç¡®ç‡å¯è¾¾99%+</li>
</ol>
<p><strong>javalangçš„ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>çº¯Pythonåº“ï¼Œåªéœ€<code>pip install javalang</code></li>
<li>ä¸éœ€è¦å®‰è£…JDKæˆ–Javaç¯å¢ƒ</li>
<li>æä¾›å®Œæ•´çš„Javaè¯­æ³•æ ‘èŠ‚ç‚¹</li>
<li>æ”¯æŒJava 8+çš„è¯­æ³•ç‰¹æ€§</li>
</ul>
<h4 data-id="heading-10">ç¬¬ä¸‰æ­¥ï¼šæ™ºèƒ½ä¸Šä¸‹æ–‡æå–</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ContextExtractor</span>:
    <span class="hljs-string">"""æ ¹æ®é—®é¢˜ç±»å‹æ™ºèƒ½æå–ä»£ç ä¸Šä¸‹æ–‡"""</span>
    
    <span class="hljs-comment"># ä¸åŒé—®é¢˜ç±»å‹çš„æå–ç­–ç•¥é…ç½®</span>
    EXTRACTION_RULES = {
        <span class="hljs-string">"NullPointer"</span>: {
            <span class="hljs-string">"range"</span>: <span class="hljs-string">"full_method"</span>,           <span class="hljs-comment"># æå–å®Œæ•´æ–¹æ³•</span>
            <span class="hljs-string">"max_lines"</span>: <span class="hljs-number">150</span>,
            <span class="hljs-string">"include_imports"</span>: <span class="hljs-literal">True</span>,           <span class="hljs-comment"># åŒ…å«importè¯­å¥</span>
            <span class="hljs-string">"include_class_declaration"</span>: <span class="hljs-literal">True</span>, <span class="hljs-comment"># åŒ…å«ç±»å£°æ˜</span>
        },
        <span class="hljs-string">"ResourceLeak"</span>: {
            <span class="hljs-string">"range"</span>: <span class="hljs-string">"full_method"</span>,
            <span class="hljs-string">"max_lines"</span>: <span class="hljs-number">100</span>,
            <span class="hljs-string">"include_imports"</span>: <span class="hljs-literal">True</span>,
            <span class="hljs-string">"include_class_declaration"</span>: <span class="hljs-literal">True</span>,
        },
        <span class="hljs-string">"SQLInjection"</span>: {
            <span class="hljs-string">"range"</span>: <span class="hljs-string">"full_method"</span>,
            <span class="hljs-string">"max_lines"</span>: <span class="hljs-number">120</span>,
            <span class="hljs-string">"include_imports"</span>: <span class="hljs-literal">False</span>,
            <span class="hljs-string">"include_class_declaration"</span>: <span class="hljs-literal">True</span>,
        },
        <span class="hljs-string">"NamingConvention"</span>: {
            <span class="hljs-string">"range"</span>: <span class="hljs-string">"surrounding"</span>,            <span class="hljs-comment"># åªæå–å‘¨å›´ä»£ç </span>
            <span class="hljs-string">"max_lines"</span>: <span class="hljs-number">30</span>,
            <span class="hljs-string">"include_imports"</span>: <span class="hljs-literal">False</span>,
            <span class="hljs-string">"include_class_declaration"</span>: <span class="hljs-literal">False</span>,
        },
        <span class="hljs-string">"General"</span>: {
            <span class="hljs-string">"range"</span>: <span class="hljs-string">"surrounding"</span>,
            <span class="hljs-string">"max_lines"</span>: <span class="hljs-number">50</span>,
            <span class="hljs-string">"include_imports"</span>: <span class="hljs-literal">False</span>,
            <span class="hljs-string">"include_class_declaration"</span>: <span class="hljs-literal">False</span>,
        },
    }
    
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">extract</span>(<span class="hljs-params">file_path: <span class="hljs-built_in">str</span>, line_number: <span class="hljs-built_in">int</span>, issue_type: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""æ™ºèƒ½æå–ä»£ç ä¸Šä¸‹æ–‡"""</span>
        rules = ContextExtractor.EXTRACTION_RULES.get(
            issue_type,
            ContextExtractor.EXTRACTION_RULES[<span class="hljs-string">"General"</span>]
        )
        
        <span class="hljs-keyword">try</span>:
            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">'r'</span>, encoding=<span class="hljs-string">'utf-8'</span>) <span class="hljs-keyword">as</span> f:
                lines = f.readlines()
            
            context_lines = []
            
            <span class="hljs-comment"># 1. æå–packageå’Œimportsï¼ˆå¦‚æœéœ€è¦ï¼‰</span>
            <span class="hljs-keyword">if</span> rules.get(<span class="hljs-string">"include_imports"</span>):
                <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines[:<span class="hljs-number">50</span>]:
                    <span class="hljs-keyword">if</span> line.strip().startswith((<span class="hljs-string">'package '</span>, <span class="hljs-string">'import '</span>)):
                        context_lines.append(line)
                    <span class="hljs-keyword">elif</span> line.strip() <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> line.strip().startswith(<span class="hljs-string">'//'</span>):
                        <span class="hljs-keyword">break</span>
                <span class="hljs-keyword">if</span> context_lines:
                    context_lines.append(<span class="hljs-string">'\n'</span>)
            
            <span class="hljs-comment"># 2. æå–æ–¹æ³•æˆ–å‘¨å›´ä»£ç </span>
            <span class="hljs-keyword">if</span> rules[<span class="hljs-string">"range"</span>] == <span class="hljs-string">"full_method"</span>:
                method_info = JavaCodeParser.extract_method_context(file_path, line_number)
                <span class="hljs-keyword">if</span> method_info:
                    start = method_info[<span class="hljs-string">'start_line'</span>] - <span class="hljs-number">1</span>
                    end = method_info[<span class="hljs-string">'end_line'</span>]
                    
                    <span class="hljs-comment"># å¦‚æœéœ€è¦ç±»å£°æ˜ï¼Œå‘ä¸ŠæŸ¥æ‰¾</span>
                    <span class="hljs-keyword">if</span> rules.get(<span class="hljs-string">"include_class_declaration"</span>):
                        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(start, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):
                            <span class="hljs-keyword">if</span> <span class="hljs-string">'class '</span> <span class="hljs-keyword">in</span> lines[i]:
                                context_lines.append(lines[i])
                                context_lines.append(<span class="hljs-string">'    // ... å…¶ä»–æˆå‘˜ ...\n\n'</span>)
                                <span class="hljs-keyword">break</span>
                    
                    context_lines.extend(lines[start:end])
                <span class="hljs-keyword">else</span>:
                    <span class="hljs-comment"># å›é€€åˆ°å‘¨å›´ä»£ç </span>
                    start = <span class="hljs-built_in">max</span>(<span class="hljs-number">0</span>, line_number - <span class="hljs-number">25</span>)
                    end = <span class="hljs-built_in">min</span>(<span class="hljs-built_in">len</span>(lines), line_number + <span class="hljs-number">25</span>)
                    context_lines.extend(lines[start:end])
            <span class="hljs-keyword">else</span>:
                <span class="hljs-comment"># æå–å‘¨å›´ä»£ç </span>
                max_lines = rules[<span class="hljs-string">"max_lines"</span>]
                start = <span class="hljs-built_in">max</span>(<span class="hljs-number">0</span>, line_number - max_lines // <span class="hljs-number">2</span>)
                end = <span class="hljs-built_in">min</span>(<span class="hljs-built_in">len</span>(lines), line_number + max_lines // <span class="hljs-number">2</span>)
                context_lines.extend(lines[start:end])
            
            <span class="hljs-comment"># 3. é™åˆ¶æ€»è¡Œæ•°</span>
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(context_lines) &gt; rules[<span class="hljs-string">"max_lines"</span>]:
                context_lines = context_lines[:rules[<span class="hljs-string">"max_lines"</span>]]
                context_lines.append(<span class="hljs-string">'\n// ... åç»­ä»£ç çœç•¥ ...\n'</span>)
            
            <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>.join(context_lines)
            
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            logging.error(<span class="hljs-string">f"æå–å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-string">f"// æ— æ³•è¯»å–æ–‡ä»¶: <span class="hljs-subst">{file_path}</span>"</span>
</code></pre>
<p><strong>æ ¸å¿ƒç­–ç•¥</strong>ï¼š</p>
<ul>
<li><strong>å·®å¼‚åŒ–æå–</strong>ï¼šç©ºæŒ‡é’ˆé—®é¢˜æå–150è¡Œå«importsï¼Œå‘½åè§„èŒƒåªæå–30è¡Œ</li>
<li><strong>æ™ºèƒ½å›é€€</strong>ï¼šASTè§£æå¤±è´¥æ—¶è‡ªåŠ¨å›é€€åˆ°ç®€å•æå–</li>
<li><strong>Tokenæ§åˆ¶</strong>ï¼šé€šè¿‡max_linesé™åˆ¶ï¼Œé¿å…ä¸Šä¸‹æ–‡è¿‡é•¿</li>
</ul>
<h4 data-id="heading-11">ç¬¬å››æ­¥ï¼šåˆ†å±‚æ¨¡æ¿ä½“ç³»</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">PromptTemplateEngine</span>:
    <span class="hljs-string">"""åˆ†å±‚çš„æç¤ºè¯æ¨¡æ¿å¼•æ“"""</span>
    
    <span class="hljs-comment"># Javaè¯­è¨€è§„èŒƒ</span>
    JAVA_STANDARDS = <span class="hljs-string">"""
è¯·éµå¾ªä»¥ä¸‹Javaå¼€å‘è§„èŒƒï¼š
1. éµå¾ªé˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œçš„ç¼–ç è§„èŒƒ
2. æ‰€æœ‰å¯èƒ½ä¸ºnullçš„å‚æ•°å¿…é¡»è¿›è¡Œé˜²å¾¡æ€§æ£€æŸ¥
3. èµ„æºï¼ˆæ–‡ä»¶æµã€æ•°æ®åº“è¿æ¥ç­‰ï¼‰å¿…é¡»ä½¿ç”¨try-with-resourcesè‡ªåŠ¨ç®¡ç†
4. å¼‚å¸¸å¿…é¡»å¦¥å–„å¤„ç†ï¼Œä¸å¾—åæ‰å¼‚å¸¸
5. æ–¹æ³•å¤æ‚åº¦ä¸å¾—è¿‡é«˜ï¼Œä¿æŒä»£ç å¯è¯»æ€§
6. å˜é‡å’Œæ–¹æ³•å‘½åè¦æ¸…æ™°ã€ç¬¦åˆé©¼å³°å‘½åè§„èŒƒ
"""</span>
    
    <span class="hljs-comment"># é—®é¢˜ç±»å‹ç‰¹å®šæ¨¡æ¿</span>
    ISSUE_TEMPLATES = {
        <span class="hljs-string">"NullPointer"</span>: {
            <span class="hljs-string">"task"</span>: <span class="hljs-string">"ä¿®å¤ä»¥ä¸‹ä»£ç ä¸­çš„ç©ºæŒ‡é’ˆé£é™©é—®é¢˜"</span>,
            <span class="hljs-string">"requirements"</span>: <span class="hljs-string">"""
ä¿®å¤è¦æ±‚ï¼š
1. åœ¨æ–¹æ³•å¼€å§‹å¤„å¯¹å¯èƒ½ä¸ºnullçš„å‚æ•°è¿›è¡Œæ£€æŸ¥
2. å¦‚æœå‚æ•°ä¸ºnullï¼ŒæŠ›å‡ºIllegalArgumentExceptionå¼‚å¸¸ï¼Œå¹¶æä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯
3. ä¿æŒåŸæœ‰ä¸šåŠ¡é€»è¾‘ä¸å˜
4. ä¸è¦ä¿®æ”¹æ–¹æ³•ç­¾å
5. ç¡®ä¿ä¿®å¤åä¸å½±å“å…¶ä»–æ­£å¸¸è°ƒç”¨
"""</span>
        },
        <span class="hljs-string">"ResourceLeak"</span>: {
            <span class="hljs-string">"task"</span>: <span class="hljs-string">"ä¿®å¤ä»¥ä¸‹ä»£ç ä¸­çš„èµ„æºæ³„éœ²é—®é¢˜"</span>,
            <span class="hljs-string">"requirements"</span>: <span class="hljs-string">"""
ä¿®å¤è¦æ±‚ï¼š
1. ä½¿ç”¨try-with-resourcesè¯­å¥åŒ…è£¹éœ€è¦å…³é—­çš„èµ„æº
2. ç¡®ä¿åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼ˆæ­£å¸¸æˆ–å¼‚å¸¸ï¼‰èµ„æºéƒ½èƒ½æ­£ç¡®é‡Šæ”¾
3. ä¿æŒåŸæœ‰å¼‚å¸¸å¤„ç†æ–¹å¼
4. ä¿æŒæ–¹æ³•ç­¾åä¸å˜
"""</span>
        },
        <span class="hljs-string">"SQLInjection"</span>: {
            <span class="hljs-string">"task"</span>: <span class="hljs-string">"ä¿®å¤ä»¥ä¸‹ä»£ç ä¸­çš„SQLæ³¨å…¥å®‰å…¨æ¼æ´"</span>,
            <span class="hljs-string">"requirements"</span>: <span class="hljs-string">"""
ä¿®å¤è¦æ±‚ï¼š
1. å¿…é¡»ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼ˆPreparedStatementï¼‰æ›¿ä»£å­—ç¬¦ä¸²æ‹¼æ¥
2. ä½¿ç”¨å ä½ç¬¦ï¼ˆ?ï¼‰å’Œå‚æ•°ç»‘å®šä¼ é€’ç”¨æˆ·è¾“å…¥
3. ä¸å¾—ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥æˆ–æ ¼å¼åŒ–æ–¹å¼æ„å»ºSQLè¯­å¥
4. ä¿æŒæŸ¥è¯¢é€»è¾‘ä¸å˜
"""</span>
        },
    }
    
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">issue_type: <span class="hljs-built_in">str</span>, issue_data: <span class="hljs-built_in">dict</span>, code_context: <span class="hljs-built_in">str</span>, examples: <span class="hljs-built_in">str</span> = <span class="hljs-string">""</span></span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""ç”Ÿæˆæœ€ç»ˆæç¤ºè¯"""</span>
        
        template = PromptTemplateEngine.ISSUE_TEMPLATES.get(
            issue_type,
            {<span class="hljs-string">"task"</span>: <span class="hljs-string">"ä¿®å¤ä»¥ä¸‹ä»£ç é—®é¢˜"</span>, <span class="hljs-string">"requirements"</span>: <span class="hljs-string">"ä¿æŒä»£ç é£æ ¼ä¸é¡¹ç›®ä¸€è‡´"</span>}
        )
        
        <span class="hljs-comment"># ç»„è£…æç¤ºè¯</span>
        prompt = <span class="hljs-string">f"""ä½ æ˜¯ä¸€ä½ç²¾é€šJavaå¼€å‘çš„èµ„æ·±å·¥ç¨‹å¸ˆã€‚

ä»»åŠ¡ï¼š<span class="hljs-subst">{template[<span class="hljs-string">'task'</span>]}</span>

ç¼–ç è§„èŒƒï¼š<span class="hljs-subst">{PromptTemplateEngine.JAVA_STANDARDS.strip()}</span>
"""</span>
        
        <span class="hljs-comment"># æ·»åŠ ç¤ºä¾‹ï¼ˆå¦‚æœæœ‰ï¼‰</span>
        <span class="hljs-keyword">if</span> examples:
            prompt += <span class="hljs-string">f"\n<span class="hljs-subst">{examples}</span>\n"</span>
        
        <span class="hljs-comment"># æ·»åŠ é—®é¢˜è¯¦æƒ…</span>
        prompt += <span class="hljs-string">f"""
é—®é¢˜è¯¦æƒ…ï¼š
- è§„åˆ™ID: <span class="hljs-subst">{issue_data.get(<span class="hljs-string">'rule'</span>, <span class="hljs-string">'Unknown'</span>)}</span>
- é—®é¢˜ç±»å‹: <span class="hljs-subst">{issue_type}</span>
- ä¸¥é‡çº§åˆ«: <span class="hljs-subst">{issue_data.get(<span class="hljs-string">'severity'</span>, <span class="hljs-string">'MAJOR'</span>)}</span>
- é—®é¢˜æè¿°: <span class="hljs-subst">{issue_data.get(<span class="hljs-string">'message'</span>, <span class="hljs-string">''</span>)}</span>
- é—®é¢˜ä½ç½®: ç¬¬<span class="hljs-subst">{issue_data.get(<span class="hljs-string">'line'</span>, <span class="hljs-number">0</span>)}</span>è¡Œ

å¾…ä¿®å¤ä»£ç ï¼š
```java
<span class="hljs-subst">{code_context}</span>
``` <span class="hljs-subst">{data-source-line=<span class="hljs-string">"360"</span>}</span>

<span class="hljs-subst">{template[<span class="hljs-string">'requirements'</span>].strip()}</span>

è¾“å‡ºæ ¼å¼ï¼š
- ä»…è¾“å‡ºä¿®å¤åçš„å®Œæ•´æ–¹æ³•ä»£ç 
- ä½¿ç”¨```java```æ ¼å¼åŒ…è£¹ä»£ç 
- ä¸è¦è¾“å‡ºå¤šä½™çš„è§£é‡Šæ–‡å­—
- ç¡®ä¿ä»£ç å¯ä»¥ç›´æ¥æ›¿æ¢åŸæœ‰æ–¹æ³•
"""</span>
        
        <span class="hljs-keyword">return</span> prompt
</code></pre>
<p><strong>æ¨¡æ¿è®¾è®¡</strong>ï¼š</p>
<ul>
<li><strong>ä¸‰å±‚ç»“æ„</strong>ï¼šè§’è‰²è®¾å®š + ç¼–ç è§„èŒƒ + é—®é¢˜ç±»å‹ç‰¹å®šè¦æ±‚</li>
<li><strong>çµæ´»æ‰©å±•</strong>ï¼šæ–°å¢é—®é¢˜ç±»å‹åªéœ€æ·»åŠ æ¨¡æ¿é…ç½®</li>
<li><strong>è§„èŒƒæ³¨å…¥</strong>ï¼šè‡ªåŠ¨æ³¨å…¥é˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œè§„èŒƒ</li>
</ul>
<h4 data-id="heading-12">ç¬¬äº”æ­¥ï¼šFew-shotç¤ºä¾‹åº“</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ExampleRepository</span>:
    <span class="hljs-string">"""é—®é¢˜ä¿®å¤ç¤ºä¾‹åº“ - æä¾›ä¿®å¤å‰åçš„å¯¹æ¯”æ¡ˆä¾‹"""</span>
    
    EXAMPLES = {
        <span class="hljs-string">"NullPointer"</span>: <span class="hljs-string">"""
å‚è€ƒç¤ºä¾‹ï¼š

ç¤ºä¾‹1 - ç©ºæŒ‡é’ˆé˜²å¾¡æ€§æ£€æŸ¥ï¼š
ä¿®å¤å‰ï¼š
```java
public String getUserEmail(User user) {
    return user.getEmail();
}
``` {data-source-line="395"}
ä¿®å¤åï¼š
```java
public String getUserEmail(User user) {
    if (user == null) {
        throw new IllegalArgumentException("ç”¨æˆ·å¯¹è±¡ä¸èƒ½ä¸ºç©º");
    }
    return user.getEmail();
}
``` {data-source-line="404"}

ç¤ºä¾‹2 - å¤šå‚æ•°ç©ºå€¼æ£€æŸ¥ï¼š
ä¿®å¤å‰ï¼š
```java
public void processOrder(Order order, User user) {
    order.setUser(user);
    order.setStatus("processed");
}
``` {data-source-line="413"}
ä¿®å¤åï¼š
```java
public void processOrder(Order order, User user) {
    if (order == null) {
        throw new IllegalArgumentException("è®¢å•å¯¹è±¡ä¸èƒ½ä¸ºç©º");
    }
    if (user == null) {
        throw new IllegalArgumentException("ç”¨æˆ·å¯¹è±¡ä¸èƒ½ä¸ºç©º");
    }
    order.setUser(user);
    order.setStatus("processed");
}
``` {data-source-line="426"}
"""</span>,
        <span class="hljs-string">"ResourceLeak"</span>: <span class="hljs-string">"""
å‚è€ƒç¤ºä¾‹ï¼š

ç¤ºä¾‹ - ä½¿ç”¨try-with-resourcesï¼š
ä¿®å¤å‰ï¼š
```java
public String readFile(String path) throws IOException {
    FileInputStream fis = new FileInputStream(path);
    byte[] buffer = new byte[1024];
    int length = fis.read(buffer);
    return new String(buffer, 0, length);
}
``` {data-source-line="440"}
ä¿®å¤åï¼š
```java
public String readFile(String path) throws IOException {
    try (FileInputStream fis = new FileInputStream(path)) {
        byte[] buffer = new byte[1024];
        int length = fis.read(buffer);
        return new String(buffer, 0, length);
    }
}
``` {data-source-line="450"}
"""</span>,
        <span class="hljs-string">"SQLInjection"</span>: <span class="hljs-string">"""
å‚è€ƒç¤ºä¾‹ï¼š

ç¤ºä¾‹ - ä½¿ç”¨PreparedStatementï¼š
ä¿®å¤å‰ï¼š
```java
public User findUserByName(String name) {
    String sql = "SELECT * FROM users WHERE name = '" + name + "'";
    return jdbcTemplate.queryForObject(sql, User.class);
}
``` {data-source-line="462"}
ä¿®å¤åï¼š
```java
public User findUserByName(String name) {
    String sql = "SELECT * FROM users WHERE name = ?";
    return jdbcTemplate.queryForObject(sql, User.class, name);
}
``` {data-source-line="469"}
"""</span>,
    }
    
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_examples</span>(<span class="hljs-params">issue_type: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""è·å–ç›¸å…³ç¤ºä¾‹"""</span>
        <span class="hljs-keyword">return</span> ExampleRepository.EXAMPLES.get(issue_type, <span class="hljs-string">""</span>)
</code></pre>
<p><strong>ç¤ºä¾‹åº“ä»·å€¼</strong>ï¼š</p>
<ul>
<li><strong>Few-shotå­¦ä¹ </strong>ï¼šè®©AIé€šè¿‡æ¡ˆä¾‹å­¦ä¹ ä¿®å¤æ¨¡å¼</li>
<li><strong>æ ¼å¼ç»Ÿä¸€</strong>ï¼šä¿®å¤å‰/åå¯¹æ¯”ï¼Œæ¸…æ™°æ˜äº†</li>
<li><strong>æ˜“äºæ‰©å±•</strong>ï¼šæ–°å¢ç¤ºä¾‹åªéœ€æ·»åŠ å­—ç¬¦ä¸²é…ç½®</li>
</ul>
<h4 data-id="heading-13">ç¬¬å…­æ­¥ï¼šæ•´åˆåˆ°MCPæœåŠ¡</h4>
<p>ç°åœ¨ï¼Œå°†æ‰€æœ‰ç»„ä»¶æ•´åˆåˆ°MCPæœåŠ¡ä¸­ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> mcp.server <span class="hljs-keyword">import</span> FastMCP
<span class="hljs-keyword">import</span> httpx
<span class="hljs-keyword">import</span> logging
<span class="hljs-keyword">import</span> os

mcp = FastMCP(<span class="hljs-string">"intelligent-code-fix"</span>)

<span class="hljs-keyword">class</span> <span class="hljs-title class_">IntelligentPromptGenerator</span>:
    <span class="hljs-string">"""æ™ºèƒ½æç¤ºè¯ç”Ÿæˆå™¨ - æ•´åˆ6æ­¥ç”Ÿæˆæ³•çš„æ ¸å¿ƒç±»"""</span>
    
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_for_issue</span>(<span class="hljs-params">issue: <span class="hljs-built_in">dict</span>, base_dir: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">dict</span>:
        <span class="hljs-string">"""ä¸ºå•ä¸ªissueç”Ÿæˆæ™ºèƒ½æç¤ºè¯"""</span>
        <span class="hljs-keyword">try</span>:
            <span class="hljs-comment"># 1. æå–issueä¿¡æ¯</span>
            rule_key = issue.get(<span class="hljs-string">'rule'</span>, <span class="hljs-string">''</span>)
            component = issue.get(<span class="hljs-string">'component'</span>, <span class="hljs-string">''</span>)
            file_path = component.split(<span class="hljs-string">':'</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">1</span>] <span class="hljs-keyword">if</span> <span class="hljs-string">':'</span> <span class="hljs-keyword">in</span> component <span class="hljs-keyword">else</span> component
            full_path = os.path.join(base_dir, file_path)
            line_number = issue.get(<span class="hljs-string">'line'</span>, <span class="hljs-number">0</span>)
            message = issue.get(<span class="hljs-string">'message'</span>, <span class="hljs-string">''</span>)
            severity = issue.get(<span class="hljs-string">'severity'</span>, <span class="hljs-string">'MAJOR'</span>)
            
            <span class="hljs-comment"># 2. é—®é¢˜ç±»å‹è¯†åˆ«</span>
            issue_type = IssueTypeClassifier.classify(rule_key)
            
            logging.info(<span class="hljs-string">f"å¤„ç†é—®é¢˜: <span class="hljs-subst">{file_path}</span>:<span class="hljs-subst">{line_number}</span> - <span class="hljs-subst">{issue_type}</span>"</span>)
            
            <span class="hljs-comment"># 3. æå–ä»£ç ä¸Šä¸‹æ–‡</span>
            code_context = ContextExtractor.extract(full_path, line_number, issue_type)
            
            <span class="hljs-comment"># 4. è·å–ç¤ºä¾‹</span>
            examples = ExampleRepository.get_examples(issue_type)
            
            <span class="hljs-comment"># 5. ç”Ÿæˆæç¤ºè¯</span>
            issue_data = {
                <span class="hljs-string">'rule'</span>: rule_key,
                <span class="hljs-string">'severity'</span>: severity,
                <span class="hljs-string">'message'</span>: message,
                <span class="hljs-string">'line'</span>: line_number,
            }
            
            prompt = PromptTemplateEngine.generate(
                issue_type=issue_type,
                issue_data=issue_data,
                code_context=code_context,
                examples=examples
            )
            
            <span class="hljs-comment"># 6. è®¡ç®—å…ƒæ•°æ®</span>
            token_estimate = <span class="hljs-built_in">len</span>(prompt) // <span class="hljs-number">4</span>  <span class="hljs-comment"># ç²—ç•¥ä¼°ç®—</span>
            
            <span class="hljs-keyword">return</span> {
                <span class="hljs-string">'success'</span>: <span class="hljs-literal">True</span>,
                <span class="hljs-string">'prompt'</span>: prompt,
                <span class="hljs-string">'metadata'</span>: {
                    <span class="hljs-string">'file'</span>: file_path,
                    <span class="hljs-string">'line'</span>: line_number,
                    <span class="hljs-string">'issue_type'</span>: issue_type,
                    <span class="hljs-string">'rule'</span>: rule_key,
                    <span class="hljs-string">'severity'</span>: severity,
                    <span class="hljs-string">'token_estimate'</span>: token_estimate,
                }
            }
            
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            logging.error(<span class="hljs-string">f"ç”Ÿæˆæç¤ºè¯å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> {
                <span class="hljs-string">'success'</span>: <span class="hljs-literal">False</span>,
                <span class="hljs-string">'error'</span>: <span class="hljs-built_in">str</span>(e),
                <span class="hljs-string">'file'</span>: file_path,
                <span class="hljs-string">'line'</span>: line_number,
            }

<span class="hljs-meta">@mcp.tool(<span class="hljs-params"><span class="hljs-string">"auto-fix-sonar-issues"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">auto_fix_sonar_issues</span>(<span class="hljs-params">
    project_name: <span class="hljs-built_in">str</span>,
    cookie: <span class="hljs-built_in">str</span>,
    base_dir: <span class="hljs-built_in">str</span>,
    branch: <span class="hljs-built_in">str</span> = <span class="hljs-literal">None</span>,
    page_size: <span class="hljs-built_in">int</span> = <span class="hljs-number">10</span>,
    page_num: <span class="hljs-built_in">int</span> = <span class="hljs-number">1</span>,
    is_new_code_period: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>
</span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""æ™ºèƒ½ä¿®å¤Sonaræ‰«æé—®é¢˜ - æ ¸å¿ƒMCPå·¥å…·"""</span>
    
    <span class="hljs-comment"># è·å–Sonaré—®é¢˜åˆ—è¡¨</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> httpx.AsyncClient() <span class="hljs-keyword">as</span> client:
        params = {
            <span class="hljs-string">"components"</span>: project_name,
            <span class="hljs-string">"ps"</span>: page_size,
            <span class="hljs-string">"p"</span>: page_num,
        }
        <span class="hljs-keyword">if</span> branch:
            params[<span class="hljs-string">"branch"</span>] = branch
        <span class="hljs-keyword">if</span> is_new_code_period:
            params[<span class="hljs-string">"inNewCodePeriod"</span>] = <span class="hljs-string">"true"</span>
        
        response = <span class="hljs-keyword">await</span> client.get(
            <span class="hljs-string">"https://sonar.zhuanspirit.com/api/issues/search"</span>,
            params=params,
            headers={<span class="hljs-string">"Cookie"</span>: cookie},
            timeout=<span class="hljs-number">10.0</span>
        )
        
        data = response.json()
        issues = data.get(<span class="hljs-string">'issues'</span>, [])
        total = data.get(<span class="hljs-string">'total'</span>, <span class="hljs-number">0</span>)
    
    <span class="hljs-comment"># ä¸ºæ¯ä¸ªissueç”Ÿæˆæ™ºèƒ½æç¤ºè¯</span>
    results = []
    success_count = <span class="hljs-number">0</span>
    
    <span class="hljs-keyword">for</span> idx, issue <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(issues, <span class="hljs-number">1</span>):
        result = IntelligentPromptGenerator.generate_for_issue(issue, base_dir)
        
        <span class="hljs-keyword">if</span> result[<span class="hljs-string">'success'</span>]:
            success_count += <span class="hljs-number">1</span>
            metadata = result[<span class="hljs-string">'metadata'</span>]
            results.append(<span class="hljs-string">f"""
<span class="hljs-subst">{<span class="hljs-string">'='</span>*<span class="hljs-number">80</span>}</span>
## Issue <span class="hljs-subst">{idx}</span>: <span class="hljs-subst">{metadata[<span class="hljs-string">'file'</span>]}</span> (ç¬¬<span class="hljs-subst">{metadata[<span class="hljs-string">'line'</span>]}</span>è¡Œ)

**é—®é¢˜ç±»å‹**: <span class="hljs-subst">{metadata[<span class="hljs-string">'issue_type'</span>]}</span>  
**ä¸¥é‡çº§åˆ«**: <span class="hljs-subst">{metadata[<span class="hljs-string">'severity'</span>]}</span>  
**é¢„ä¼°Token**: <span class="hljs-subst">{metadata[<span class="hljs-string">'token_estimate'</span>]}</span>

### ç”Ÿæˆçš„æ™ºèƒ½æç¤ºè¯ï¼š

<span class="hljs-subst">{result[<span class="hljs-string">'prompt'</span>]}</span>
<span class="hljs-subst">{<span class="hljs-string">'='</span>*<span class="hljs-number">80</span>}</span>
"""</span>)
    
    <span class="hljs-comment"># ç»„è£…æœ€ç»ˆè¾“å‡º</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"""
# æ™ºèƒ½ä»£ç ä¿®å¤æç¤ºè¯ç”Ÿæˆå®Œæˆ

## ç»Ÿè®¡ä¿¡æ¯
- **é¡¹ç›®**: <span class="hljs-subst">{project_name}</span>
- **æ€»é—®é¢˜æ•°**: <span class="hljs-subst">{total}</span>
- **æœ¬æ‰¹æ¬¡**: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(issues)}</span> ä¸ª
- **æˆåŠŸç”Ÿæˆ**: <span class="hljs-subst">{success_count}</span> ä¸ª

## æ™ºèƒ½æç¤ºè¯åˆ—è¡¨
<span class="hljs-subst">{<span class="hljs-string">""</span>.join(results)}</span>

---
ç”±æ™ºèƒ½æç¤ºè¯ç”Ÿæˆå¼•æ“æä¾›æ”¯æŒ
"""</span>

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    mcp.run(<span class="hljs-string">"stdio"</span>)
</code></pre>
<p><strong>æ•´åˆè¦ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šæ¯ä¸ªissueç‹¬ç«‹å¤„ç†ï¼Œå•ä¸ªå¤±è´¥ä¸å½±å“å…¶ä»–</li>
<li><strong>å…ƒæ•°æ®è¿½è¸ª</strong>ï¼šè®°å½•æ–‡ä»¶ã€è¡Œå·ã€é—®é¢˜ç±»å‹ã€Tokenä¼°ç®—</li>
<li><strong>ç»“æ„åŒ–è¾“å‡º</strong>ï¼šMarkdownæ ¼å¼ï¼Œä¾¿äºCursorå±•ç¤º</li>
</ul>
<h3 data-id="heading-14">å®‰è£…ä¾èµ–åŒ…</h3>
<p>åœ¨ä½¿ç”¨MCPæœåŠ¡ä¹‹å‰ï¼Œéœ€è¦å…ˆå®‰è£…å¿…è¦çš„Pythonä¾èµ–åŒ…ã€‚åˆ›å»º<code>requirements.txt</code>æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-txt" lang="txt"># æ™ºèƒ½ä»£ç ä¿®å¤MCPæœåŠ¡ä¾èµ–åŒ…

# MCPæ¡†æ¶ - ç”¨äºæ„å»ºMCPæœåŠ¡
mcp&gt;=0.9.0

# HTTPå®¢æˆ·ç«¯ - ç”¨äºè°ƒç”¨Sonar API
httpx&gt;=0.27.0

# Java ASTè§£æå™¨ - ç²¾ç¡®è§£æJavaä»£ç ç»“æ„ï¼ˆå¼ºçƒˆæ¨èï¼‰
# ä¼˜åŠ¿ï¼šå‡†ç¡®ç‡99%+ï¼Œä¸å—æ³¨é‡Šã€å­—ç¬¦ä¸²ã€Lambdaå½±å“
# æ³¨æ„ï¼šè¿™æ˜¯çº¯Pythonåº“ï¼Œä¸éœ€è¦Javaç¯å¢ƒ
javalang&gt;=0.13.0
</code></pre>
<p>å®‰è£…å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pip install -r requirements.txt
</code></pre>
<p><strong>ä¾èµ–è¯´æ˜</strong>ï¼š</p>
<ul>
<li><strong>mcp</strong>ï¼šMCPåè®®æ¡†æ¶ï¼Œè®©Pythonè„šæœ¬èƒ½å¤Ÿè¢«Cursorè¯†åˆ«å’Œè°ƒç”¨</li>
<li><strong>httpx</strong>ï¼šç°ä»£åŒ–HTTPå®¢æˆ·ç«¯ï¼Œç”¨äºè°ƒç”¨Sonar APIè·å–æ‰«æç»“æœ</li>
<li><strong>javalang</strong>ï¼šçº¯Pythonçš„Java ASTè§£æå™¨ï¼Œç”¨äºç²¾å‡†å®šä½ä»£ç ç»“æ„ï¼Œæ— éœ€å®‰è£…Javaç¯å¢ƒ</li>
</ul>
<h3 data-id="heading-15">é…ç½®MCPï¼ˆè®©Cursorè¯†åˆ«ä½ çš„æœåŠ¡ï¼‰</h3>
<p>%è¿™é‡Œæ”¹æˆä½ æœ¬åœ°çš„è·¯å¾„%
åœ¨ <code>~/.cursor/mcp.json</code> ä¸­æ·»åŠ ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"mcpServers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"intelligent-code-fix"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"python"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"args"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"/Users/Desktop/cursor/intelligent-code-fix.py"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"env"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>é…ç½®è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>intelligent-code-fix</code>ï¼šMCPæœåŠ¡åç§°ï¼Œåœ¨Cursorä¸­é€šè¿‡<code>@intelligent-code-fix</code>è°ƒç”¨</li>
<li><code>command</code>: Pythonè§£é‡Šå™¨å‘½ä»¤</li>
<li><code>args</code>: Pythonè„šæœ¬çš„ç»å¯¹è·¯å¾„ï¼ˆè¯·ä¿®æ”¹ä¸ºä½ çš„å®é™…è·¯å¾„ï¼‰</li>
<li>ä¿®æ”¹é…ç½®åéœ€è¦é‡å¯Cursorç”Ÿæ•ˆ</li>
</ul>
<h2 data-id="heading-16">å››ã€ä½¿ç”¨ä½“éªŒï¼šåœ¨Cursorä¸­ä¸€é”®ä¿®å¤</h2>
<h3 data-id="heading-17">é…ç½®å¥½MCPåï¼Œåœ¨Cursorä¸­çš„ä½¿ç”¨éå¸¸ç®€å•</h3>
<h4 data-id="heading-18">æ­¥éª¤1ï¼šåœ¨CursorèŠå¤©çª—å£è°ƒç”¨MCPå·¥å…·</h4>
<pre><code class="hljs language-diff" lang="diff">ä½¿ç”¨ auto-fix-sonar-issues å·¥å…·ä¿®å¤Sonaré—®é¢˜

å‚æ•°ï¼š

<span class="hljs-deletion">- project_name: hunter_partner_recycle_core</span>
<span class="hljs-deletion">- cookie: sso_uid=xxx; ticket=xxx; aid=xxx</span>
<span class="hljs-deletion">- base_dir: /Users/xxx/projects/hunter/src/main/java</span>
<span class="hljs-deletion">- branch: feature-3278-163 (å¯é€‰)</span>
<span class="hljs-deletion">- page_size: 10</span>




</code></pre>
<h4 data-id="heading-19">æ­¥éª¤2ï¼šMCPæœåŠ¡è‡ªåŠ¨å¤„ç†</h4>
<p>ç³»ç»Ÿè‡ªåŠ¨å®Œæˆï¼š</p>
<ol>
<li>è°ƒç”¨Sonar APIè·å–é—®é¢˜åˆ—è¡¨</li>
<li>ä¸ºæ¯ä¸ªé—®é¢˜æ™ºèƒ½ç”Ÿæˆæç¤ºè¯</li>
<li>è¿”å›ç»“æ„åŒ–çš„ä¿®å¤å»ºè®®</li>
</ol>
<h4 data-id="heading-20">æ­¥éª¤3ï¼šAIç”Ÿæˆä¿®å¤åçš„ä»£ç </h4>
<pre><code class="hljs language-ini" lang="ini">å·²ç”Ÿæˆ10ä¸ªé—®é¢˜çš„ä¿®å¤å»ºè®®ï¼š

Issue 1: ActivityServiceImpl.java ç©ºæŒ‡é’ˆä¿®å¤
ä¿®å¤åä»£ç ï¼š
<span class="hljs-section">[å®Œæ•´çš„ä¿®å¤ä»£ç ]</span>

Issue 2: FileUtil.java èµ„æºæ³„éœ²ä¿®å¤
ä¿®å¤åä»£ç ï¼š
<span class="hljs-section">[å®Œæ•´çš„ä¿®å¤ä»£ç ]</span>

</code></pre>
<h4 data-id="heading-21">æ­¥éª¤4ï¼šä¸€é”®åº”ç”¨ä¿®å¤</h4>
<p>ç›´æ¥åœ¨Cursorä¸­reviewå¹¶åº”ç”¨ä¿®å¤</p>
<h3 data-id="heading-22">æ”¹è¿›æ•ˆæœï¼š</h3>
<ol>
<li>æˆæœ¬é™ä½70% ï¼šç²¾å‡†æå–ä¸Šä¸‹æ–‡ï¼Œtokenä½¿ç”¨é‡å¤§å¹…å‡å°‘</li>
<li>å‡†ç¡®ç‡æå‡30%ï¼šç»“æ„åŒ–æç¤ºè¯+ç¤ºä¾‹å¼•å¯¼ï¼ŒAIç†è§£æ›´å‡†ç¡®</li>
<li>æ•ˆç‡æå‡3å€ï¼šè‡ªåŠ¨åŒ–æµç¨‹ï¼Œæ— éœ€äººå·¥å¹²é¢„</li>
<li>è´¨é‡å¯æ§ï¼šåˆ†å±‚æ¨¡æ¿ç¡®ä¿ä»£ç ç¬¦åˆå›¢é˜Ÿè§„èŒƒ</li>
<li>æ˜“äºæ‰©å±•ï¼šæ–°å¢é—®é¢˜ç±»å‹åªéœ€æ·»åŠ é…ç½®</li>
</ol>
<h2 data-id="heading-23">äº”ã€å†™åœ¨æœ€å</h2>
<p>çœŸæ­£æœ‰æ•ˆçš„AIè¾…åŠ©å¼€å‘ï¼Œä¸æ˜¯ç®€å•åœ°æŠŠä»£ç æ‰”ç»™AIï¼Œè€Œæ˜¯è¦åšå¥½ï¼š</p>
<ul>
<li><strong>é—®é¢˜çš„ç²¾å‡†è¯†åˆ«</strong>ï¼šçŸ¥é“æ˜¯ä»€ä¹ˆç±»å‹çš„é—®é¢˜</li>
<li><strong>ä¸Šä¸‹æ–‡çš„æ™ºèƒ½æå–</strong>ï¼šç»™AIæœ€ç›¸å…³çš„ä»£ç ï¼Œè€Œä¸æ˜¯å…¨éƒ¨ä»£ç </li>
<li><strong>è§„èŒƒçš„æœ‰æ•ˆæ³¨å…¥</strong>ï¼šè®©AIçŸ¥é“è¦éµå¾ªä»€ä¹ˆæ ‡å‡†</li>
<li><strong>ç»éªŒçš„ç³»ç»Ÿæ²‰æ·€</strong>ï¼šç”¨ç¤ºä¾‹åº“è®©AIå­¦ä¹ æœ€ä½³å®è·µ</li>
</ul>
<p>è¿™å¥—æ–¹æ¡ˆä¸ä»…é€‚ç”¨äºSonarï¼Œä¹Ÿå¯ä»¥æ¨å¹¿åˆ°å…¶ä»–ä»£ç æ‰«æå·¥å…·ï¼ˆESLintã€Checkstyleç­‰ï¼‰ã€‚æ ¸å¿ƒæ€æƒ³éƒ½æ˜¯ï¼š<strong>å°†éç»“æ„åŒ–çš„æ‰«æç»“æœè½¬æ¢ä¸ºç»“æ„åŒ–çš„AIæç¤ºè¯</strong>ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½ç»™å¤§å®¶å¸¦æ¥å¯å‘ã€‚å¦‚æœå¤§å®¶ä¹Ÿåœ¨æ¢ç´¢AIè¾…åŠ©å¼€å‘ï¼Œæ¬¢è¿äº¤æµï¼</p>
<blockquote>
<p>å…³äºä½œè€…ï¼Œåˆ˜é›…æ–Œï¼Œä¾ å®¢æ±‡Javaå¼€å‘å·¥ç¨‹å¸ˆã€‚
æƒ³äº†è§£æ›´å¤šè½¬è½¬å…¬å¸çš„ä¸šåŠ¡å®è·µï¼Œæ¬¢è¿ç‚¹å‡»å…³æ³¨ä¸‹æ–¹å…¬ä¼—å·</p>
</blockquote>
<blockquote>
<p>è½¬è½¬ç ”å‘ä¸­å¿ƒåŠä¸šç•Œå°ä¼™ä¼´ä»¬çš„æŠ€æœ¯å­¦ä¹ äº¤æµå¹³å°ï¼Œå®šæœŸåˆ†äº«ä¸€çº¿çš„å®æˆ˜ç»éªŒåŠä¸šç•Œå‰æ²¿çš„æŠ€æœ¯è¯é¢˜ã€‚
å…³æ³¨å…¬ä¼—å·ã€Œè½¬è½¬æŠ€æœ¯ã€ï¼ˆç»¼åˆæ€§ï¼‰ã€ã€Œå¤§è½¬è½¬FEã€ï¼ˆä¸“æ³¨äºFEï¼‰ã€ã€Œè½¬è½¬QAã€ï¼ˆä¸“æ³¨äºQAï¼‰ï¼Œæ›´å¤šå¹²è´§å®è·µï¼Œæ¬¢è¿äº¤æµåˆ†äº«~</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Reactä¸‹æ‹‰æ¡†æ¥å£è¯·æ±‚hookå°è£…]]></title>    <link>https://juejin.cn/post/7587903505134895154</link>    <guid>https://juejin.cn/post/7587903505134895154</guid>    <pubDate>2025-12-26T07:35:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587903505134895154" data-draft-id="7587709130531831817" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Reactä¸‹æ‹‰æ¡†æ¥å£è¯·æ±‚hookå°è£…"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-26T07:35:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Jolyne_"/> <meta itemprop="url" content="https://juejin.cn/user/339101640827981"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Reactä¸‹æ‹‰æ¡†æ¥å£è¯·æ±‚hookå°è£…
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/339101640827981/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Jolyne_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T07:35:15.000Z" title="Fri Dec 26 2025 07:35:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    20
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>è®°å½•ä¸€ä¸‹å…¬å¸ ä¸‹æ‹‰æ¡†å°è£…çš„ æ¥å£hookã€‚ä¸»è¦æ˜¯æ”¯æŒ</p>
<ul>
<li>åˆå§‹åŒ–æˆ–è€…æŒ‡å®šçŠ¶æ€ä¸‹è¯·æ±‚æ¥å£</li>
<li>é˜²æŠ–æœç´¢</li>
<li>æ”¯æŒä¸åŒç±»å‹çš„æ¥å£ï¼ˆgetã€postï¼‰</li>
</ul>
<h2 data-id="heading-1">ä»£ç </h2>
<h3 data-id="heading-2">ä¸»ä½“ hook</h3>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">IObj</span>, <span class="hljs-title class_">IOption</span>, <span class="hljs-title class_">TRecord</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/utils/interface"</span>;
<span class="hljs-keyword">import</span> { to } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/utils/tools"</span>;
<span class="hljs-keyword">import</span> { useMount } <span class="hljs-keyword">from</span> <span class="hljs-string">"@quarkunlimit/react-hooks"</span>;
<span class="hljs-keyword">import</span> { debounce } <span class="hljs-keyword">from</span> <span class="hljs-string">"lodash"</span>;
<span class="hljs-keyword">import</span> { useEffect, useRef, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> {
  <span class="hljs-title class_">IUseMountFetchDataNewProps</span>,
  <span class="hljs-title class_">IUseMountFetchDataResult</span>,
} <span class="hljs-keyword">from</span> <span class="hljs-string">"./interface"</span>;

<span class="hljs-comment">/**
 * åˆå§‹åŒ–è¯·æ±‚ä¸‹æ‹‰æ¡†æ¥å£
 * <span class="hljs-doctag">@param</span> <span class="hljs-variable">props</span>
 * <span class="hljs-doctag">@returns</span>
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useSearchSelectFetchNew = (
  <span class="hljs-attr">props</span>: <span class="hljs-title class_">IUseMountFetchDataNewProps</span>
): <span class="hljs-function"><span class="hljs-params">IUseMountFetchDataResult</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> {
    fetchDataApi,
    request,
    searchParamKey,
    transformOptions,
    refreshFetch,
    initFetch = <span class="hljs-literal">true</span>,
    needSetExtarData = <span class="hljs-literal">false</span>,
  } = props;

  <span class="hljs-keyword">const</span> [data, setData] = useState&lt;<span class="hljs-title class_">IOption</span>[]&gt;([]);
  <span class="hljs-keyword">const</span> isMount = useRef&lt;<span class="hljs-built_in">boolean</span>&gt;(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> originData = useRef&lt;<span class="hljs-title class_">IOption</span>[]&gt;([]);

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchData</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">otherRequest?: TRecord</span>) =&gt; {
    <span class="hljs-keyword">let</span> <span class="hljs-attr">newRequst</span>: <span class="hljs-title class_">IObj</span> = {}
    newRequst = {
        <span class="hljs-attr">page</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">size</span>: <span class="hljs-number">100</span>,
        ...request,
        ...otherRequest
    }
    <span class="hljs-keyword">const</span> [err, res] = <span class="hljs-keyword">await</span> <span class="hljs-title function_">to</span>(
      (<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetchDataApi</span>(newRequst);
      })()
    );
    <span class="hljs-keyword">if</span> (!(err || !res)) {
      <span class="hljs-keyword">const</span> data = <span class="hljs-title function_">transformOptions</span>(res);
      <span class="hljs-title function_">setData</span>(data);
      <span class="hljs-keyword">if</span> (!isMount.<span class="hljs-property">current</span>) {
        originData.<span class="hljs-property">current</span> = data;
        isMount.<span class="hljs-property">current</span> = <span class="hljs-literal">true</span>;
      }
    }
  };

  <span class="hljs-keyword">const</span> onSearch = <span class="hljs-title function_">debounce</span>(<span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (value.<span class="hljs-title function_">trim</span>()) {
      <span class="hljs-title function_">fetchData</span>({
        [searchParamKey]: value,
      });
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-title function_">setData</span>(originData.<span class="hljs-property">current</span>);
    }
  }, <span class="hljs-number">500</span>);

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (refreshFetch) {
      <span class="hljs-title function_">fetchData</span>();
    }
  }, [refreshFetch]);

  <span class="hljs-title function_">useMount</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (initFetch) {
      <span class="hljs-title function_">fetchData</span>();
    }
  });

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">setExtarData</span> = (<span class="hljs-params">list: IOption[]</span>) =&gt; {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">newData</span>: <span class="hljs-title class_">IOption</span>[] = [];
    <span class="hljs-keyword">const</span> idSet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>&lt;<span class="hljs-built_in">string</span>&gt;();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> item <span class="hljs-keyword">of</span> data) {
      newData.<span class="hljs-title function_">push</span>(item);
      idSet.<span class="hljs-title function_">add</span>(item.<span class="hljs-property">value</span>);
    }

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> item <span class="hljs-keyword">of</span> list) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> item !== <span class="hljs-string">"object"</span>) {
        <span class="hljs-keyword">continue</span>;
      }
      <span class="hljs-keyword">if</span> (idSet.<span class="hljs-title function_">has</span>(item?.<span class="hljs-property">value</span>)) {
        <span class="hljs-keyword">continue</span>;
      }
      idSet.<span class="hljs-title function_">add</span>(item.<span class="hljs-property">value</span>);
      newData.<span class="hljs-title function_">push</span>(item);
    }
    <span class="hljs-title function_">setData</span>(newData);
  };

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">options</span>: data,
    onSearch,
    <span class="hljs-attr">onFocus</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">fetchData</span>(),
    ...(needSetExtarData ? { setExtarData } : {}),
  };
};

</code></pre>
<h3 data-id="heading-3">ç±»å‹å®šä¹‰</h3>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">SelectProps</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"antd"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IOption</span> {
  <span class="hljs-attr">label</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span>;
  [<span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IUseMountFetchDataNewProps</span> {
  <span class="hljs-comment">/**<span class="hljs-doctag">@param</span> æ¥å£Api */</span>
  <span class="hljs-attr">fetchDataApi</span>: <span class="hljs-function">(<span class="hljs-params">...arg: <span class="hljs-built_in">any</span></span>) =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">IApiData</span>&gt;;
  <span class="hljs-comment">/**<span class="hljs-doctag">@param</span> åˆå§‹åŒ–æ—¶æ¥å£é¢å¤–å‚æ•° */</span>
  request?: <span class="hljs-title class_">TRecord</span> &amp; { enableFlag?: <span class="hljs-built_in">boolean</span>; dataScopeEnableFlag?: <span class="hljs-built_in">boolean</span> };
  <span class="hljs-comment">/**<span class="hljs-doctag">@param</span> æœç´¢æ—¶çš„key */</span>
  <span class="hljs-attr">searchParamKey</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">/**<span class="hljs-doctag">@function</span> è½¬æ¢æ•°æ®æºä¸ºoptions */</span>
  <span class="hljs-attr">transformOptions</span>: <span class="hljs-function">(<span class="hljs-params">res: IApiData</span>) =&gt;</span> <span class="hljs-title class_">IOption</span>[];
  <span class="hljs-comment">/**<span class="hljs-doctag">@param</span> æ»¡è¶³æŸç§æ¡ä»¶æ—¶åŠ è½½æ•°æ®ï¼Œä½¿ç”¨æ—¶è¯·å°† initFetch è®¾ç½®ä¸º false  */</span>
  refreshFetch?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">/**<span class="hljs-doctag">@param</span> æ˜¯å¦æŒ‚è½½æ—¶é»˜è®¤åŠ è½½æ•°æ® */</span>
  initFetch?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">/** <span class="hljs-doctag">@param</span> æ˜¯å¦éœ€è¦setExtarData */</span>
  needSetExtarData?: <span class="hljs-built_in">boolean</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IUseMountFetchDataResult</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SelectProps</span> {
  <span class="hljs-comment">/** <span class="hljs-doctag">@param</span> ä¸‹æ‹‰æ¡†é€‰é¡¹ */</span>
  <span class="hljs-attr">options</span>: <span class="hljs-title class_">IOption</span>[];
  <span class="hljs-comment">/** <span class="hljs-doctag">@function</span> ä¸‹æ‹‰æ¡†æœç´¢ */</span>
  <span class="hljs-attr">onSearch</span>: <span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>;
  <span class="hljs-comment">/** <span class="hljs-doctag">@function</span> æ‰‹åŠ¨æ·»åŠ é¢å¤–çš„æ•°æ®æº */</span>
  setExtarData?: <span class="hljs-function">(<span class="hljs-params">list: IOption[]</span>) =&gt;</span> <span class="hljs-built_in">void</span>;
}
</code></pre>
<h2 data-id="heading-4">ä½¿ç”¨</h2>
<pre><code class="hljs language-tsx" lang="tsx">
<span class="hljs-comment">/** <span class="hljs-doctag">@function</span> è·å–å­—å…¸å€¼é›†åˆ */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">sys_dict_value</span> = (<span class="hljs-params">params?: IReqSysDictValueDictValue</span>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Service</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">"/api/business/v1/sys-dict-value/dict-value"</span>, {
    params,
  }) <span class="hljs-keyword">as</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">IResDetail</span>&lt;<span class="hljs-title class_">IResSysDictValueDictValue</span>[]&gt;&gt;;
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IReqSysDictValueDictValue</span> {
  <span class="hljs-comment">/** <span class="hljs-doctag">@param</span> å­—å…¸ç¼–ç  */</span>
  dictCode?: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">/** <span class="hljs-doctag">@param</span> å­—å…¸ç¼–ç é›†åˆ */</span>
  dictCodeList?: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">/** <span class="hljs-doctag">@param</span> å­—å…¸åç§° */</span>
  dictName?: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">/** <span class="hljs-doctag">@param</span> å­—å…¸å€¼ */</span>
  dictValue?: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">/** <span class="hljs-doctag">@param</span> å¤‡æ³¨ */</span>
  memo?: <span class="hljs-built_in">string</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IResSysDictValueDictValue</span> {
  <span class="hljs-attr">dictCode</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">dictName</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">dictValue</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">enableFlag</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">memo</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">color</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">sortNum</span>: <span class="hljs-built_in">number</span>;
}

<span class="hljs-keyword">const</span> <span class="hljs-title class_">TXDiplomaRadio</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">TXDiplomaRadio_</span>(<span class="hljs-params">{
  initFetch = <span class="hljs-literal">true</span>,
  refreshFetch = <span class="hljs-literal">false</span>,
  extraReq = {},
  ...rest
}: ITXDiplomaRadioProps</span>) {
  <span class="hljs-keyword">const</span> { options } = <span class="hljs-title function_">useSearchSelectFetchNew</span>({
    <span class="hljs-attr">fetchDataApi</span>: sys_dict_valueï¼ˆä½ çš„æ¥å£ï¼Œè¿”å›promiseï¼‰,
    <span class="hljs-attr">request</span>: {
      <span class="hljs-attr">dictCode</span>: <span class="hljs-string">"diploma"</span>,
      ...extraReq,
    },
    initFetch,
    refreshFetch,
    <span class="hljs-attr">searchParamKey</span>: <span class="hljs-string">"dictName"</span>,
    <span class="hljs-attr">transformOptions</span>: <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
      <span class="hljs-keyword">return</span> res?.<span class="hljs-property">data</span>?.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">x: IResSysDictValueDictValue</span>) =&gt;</span> ({
        <span class="hljs-attr">label</span>: x.<span class="hljs-property">dictName</span>,
        <span class="hljs-attr">value</span>: x.<span class="hljs-property">dictValue</span>,
      }));
    },
  });

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Radio.Group</span> <span class="hljs-attr">options</span>=<span class="hljs-string">{options}</span> {<span class="hljs-attr">...rest</span>} /&gt;</span></span>;
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">TXDiplomaRadio</span>;
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨Java Streamï¼Œå°†é›†åˆè½¬æ¢ä¸ºä¸€å¯¹ä¸€Map]]></title>    <link>https://juejin.cn/post/7587684397531021339</link>    <guid>https://juejin.cn/post/7587684397531021339</guid>    <pubDate>2025-12-26T03:26:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587684397531021339" data-draft-id="7587715742051139594" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨Java Streamï¼Œå°†é›†åˆè½¬æ¢ä¸ºä¸€å¯¹ä¸€Map"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-26T03:26:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”³åŸå¼‚ä¹¡äºº"/> <meta itemprop="url" content="https://juejin.cn/user/3245414056985831"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨Java Streamï¼Œå°†é›†åˆè½¬æ¢ä¸ºä¸€å¯¹ä¸€Map
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3245414056985831/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”³åŸå¼‚ä¹¡äºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T03:26:34.000Z" title="Fri Dec 26 2025 03:26:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æ—¥å¸¸çš„å¼€å‘å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨åˆ°Java Streamï¼Œç‰¹åˆ«æ˜¯Stream APIä¸­æä¾›çš„<code>Collectors.toList()</code>æ”¶é›†å™¨ï¼Œ</p>
<p>ä½†æœ‰äº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å°†é›†åˆè½¬æ¢ä¸ºMapï¼Œè¿™æ—¶å€™å°±éœ€è¦ä½¿ç”¨åˆ°Stream APIä¸­æä¾›çš„å¦ä¸€ä¸ªæ”¶é›†å™¨ï¼š</p>
<p><code>Collectors.toMap</code>ï¼Œå®ƒå¯ä»¥å°†æµä¸­çš„å…ƒç´ æ˜ å°„ä¸ºé”®å€¼å¯¹ï¼Œå¹¶æ”¶é›†åˆ°ä¸€ä¸ªMapä¸­ã€‚</p>
<h2 data-id="heading-0">1. ä¸‰ç§ä¸»è¦çš„é‡è½½æ–¹æ³•</h2>
<p><code>Collectors.toMap</code>æœ‰3ç§é‡è½½æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<p>1)<strong>ä¸¤ä¸ªå‚æ•°çš„é‡è½½æ–¹æ³•ï¼ˆæœ€ç®€å•çš„å½¢å¼ï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T, K, U&gt; Collector&lt;T, ?, Map&lt;K,U&gt;&gt; toMap(Function&lt;? <span class="hljs-built_in">super</span> T, ? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">K</span>&gt; keyMapper,
                                Function&lt;? <span class="hljs-built_in">super</span> T, ? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">U</span>&gt; valueMapper) {
	<span class="hljs-keyword">return</span> toMap(keyMapper, valueMapper, throwingMerger(), HashMap::<span class="hljs-keyword">new</span>);
}
</code></pre>
<p>2)<strong>ä¸‰ä¸ªå‚æ•°çš„é‡è½½æ–¹æ³•ï¼ˆåŒ…å«å†²çªå¤„ç†ï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T, K, U&gt; Collector&lt;T, ?, Map&lt;K,U&gt;&gt; toMap(Function&lt;? <span class="hljs-built_in">super</span> T, ? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">K</span>&gt; keyMapper,
                                Function&lt;? <span class="hljs-built_in">super</span> T, ? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">U</span>&gt; valueMapper,
                                BinaryOperator&lt;U&gt; mergeFunction) {
    <span class="hljs-keyword">return</span> toMap(keyMapper, valueMapper, mergeFunction, HashMap::<span class="hljs-keyword">new</span>);
}
</code></pre>
<p>3)<strong>å››ä¸ªå‚æ•°çš„é‡è½½æ–¹æ³•ï¼ˆæŒ‡å®šMapå®ç°ï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T, K, U, M <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Map</span>&lt;K, U&gt;&gt;
   Collector&lt;T, ?, M&gt; toMap(Function&lt;? <span class="hljs-built_in">super</span> T, ? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">K</span>&gt; keyMapper,
                            Function&lt;? <span class="hljs-built_in">super</span> T, ? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">U</span>&gt; valueMapper,
                            BinaryOperator&lt;U&gt; mergeFunction,
                            Supplier&lt;M&gt; mapSupplier) {
    BiConsumer&lt;M, T&gt; accumulator
            = (map, element) -&gt; map.merge(keyMapper.apply(element),
                                          valueMapper.apply(element), mergeFunction);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CollectorImpl</span>&lt;&gt;(mapSupplier, accumulator, mapMerger(mergeFunction), CH_ID);
}
</code></pre>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç»“åˆä½¿ç”¨ç¤ºä¾‹è¯¦ç»†è®²è§£ã€‚</p>
<h2 data-id="heading-1">2. ä½¿ç”¨ç¤ºä¾‹</h2>
<h3 data-id="heading-2">2.1 å°†å¯¹è±¡çš„æŸäº›å±æ€§è½¬æ¢ä¸ºMap</h3>
<p>å‡è®¾æœ‰ä¸€ä¸ªåŸå¸‚åˆ—è¡¨ï¼Œéœ€è¦å°†å…¶è½¬æ¢ä¸ºMapï¼Œå…¶ä¸­Keyä¸ºåŸå¸‚IDã€Valueä¸ºåŸå¸‚åç§°ï¼Œè½¬æ¢æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Getter</span>
<span class="hljs-meta">@Setter</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">City</span> {
    <span class="hljs-keyword">private</span> Integer cityId;

    <span class="hljs-keyword">private</span> String cityName;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">City</span><span class="hljs-params">(Integer cityId, String cityName)</span> {
        <span class="hljs-built_in">this</span>.cityId = cityId;
        <span class="hljs-built_in">this</span>.cityName = cityName;
    }
}
</code></pre>
<pre><code class="hljs language-java" lang="java">List&lt;City&gt; cityList = Arrays.asList(
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">1</span>, <span class="hljs-string">"åŒ—äº¬"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">2</span>, <span class="hljs-string">"ä¸Šæµ·"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">3</span>, <span class="hljs-string">"å¹¿å·"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">4</span>, <span class="hljs-string">"æ·±åœ³"</span>)
);
Map&lt;Integer, String&gt; cityMap = cityList.stream()
        .collect(Collectors.toMap(City::getCityId, City::getCityName));
System.out.println(cityMap);
</code></pre>
<p>è¾“å‡ºç»“æœï¼š</p>
<blockquote>
<p>{1=åŒ—äº¬, 2=ä¸Šæµ·, 3=å¹¿å·, 4=æ·±åœ³}</p>
</blockquote>
<h3 data-id="heading-3">2.2 å°†å¯¹è±¡åˆ—è¡¨è½¬æ¢ä¸ºMapï¼ˆID -&gt; å¯¹è±¡ï¼‰</h3>
<p>ä»ç„¶ä½¿ç”¨ä¸Šé¢çš„åŸå¸‚åˆ—è¡¨ï¼Œéœ€è¦å°†å…¶è½¬æ¢ä¸ºMapï¼Œå…¶ä¸­Keyä¸ºåŸå¸‚IDã€Valueä¸ºåŸå¸‚å¯¹è±¡ï¼Œè½¬æ¢æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-java" lang="java">List&lt;City&gt; cityList = Arrays.asList(
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">1</span>, <span class="hljs-string">"åŒ—äº¬"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">2</span>, <span class="hljs-string">"ä¸Šæµ·"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">3</span>, <span class="hljs-string">"å¹¿å·"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">4</span>, <span class="hljs-string">"æ·±åœ³"</span>)
);
Map&lt;Integer, City&gt; cityMap = cityList.stream()
        .collect(Collectors.toMap(City::getCityId, city -&gt; city));
<span class="hljs-type">City</span> <span class="hljs-variable">city</span> <span class="hljs-operator">=</span> cityMap.get(<span class="hljs-number">1</span>);
System.out.println(<span class="hljs-string">"åŸå¸‚ID: "</span> + city.getCityId());
System.out.println(<span class="hljs-string">"åŸå¸‚åç§°: "</span> + city.getCityName());
</code></pre>
<p>è¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<blockquote>
<p>åŸå¸‚ID: 1
åŸå¸‚åç§°: åŒ—äº¬</p>
</blockquote>
<p>ä¸Šé¢çš„å†™æ³•ç­‰ä»·äºï¼š</p>
<pre><code class="hljs language-java" lang="java">Map&lt;Integer, City&gt; cityMap = cityList.stream()
    	.collect(Collectors.toMap(City::getCityId, Function.identity()));
</code></pre>
<p>å› ä¸º<code>Function.identity()</code>å†…éƒ¨å®ç°æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">static</span> &lt;T&gt; Function&lt;T, T&gt; <span class="hljs-title function_">identity</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> t -&gt; t;
}
</code></pre>
<h3 data-id="heading-4">2.3 é”®å†²çªå¤„ç†</h3>
<p>å‡è®¾ä¸Šé¢çš„åŸå¸‚åˆ—è¡¨ä¸­æœ‰ä¸€ä¸ªIDé‡å¤çš„åŸå¸‚ï¼š</p>
<pre><code class="hljs language-java" lang="java">List&lt;City&gt; cityList = Arrays.asList(
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">1</span>, <span class="hljs-string">"åŒ—äº¬"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">2</span>, <span class="hljs-string">"ä¸Šæµ·"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">3</span>, <span class="hljs-string">"å¹¿å·"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">4</span>, <span class="hljs-string">"æ·±åœ³"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">4</span>, <span class="hljs-string">"å¤©æ´¥"</span>)
);
Map&lt;Integer, String&gt; cityMap = cityList.stream()
        .collect(Collectors.toMap(City::getCityId, City::getCityName));
System.out.println(<span class="hljs-string">"åŸå¸‚ID: 4, åŸå¸‚åç§°: "</span> + cityMap.get(<span class="hljs-number">4</span>));
</code></pre>
<p>æ­¤æ—¶è¿è¡Œä»£ç ï¼Œä¼šæŠ›å‡º<code>java.lang.IllegalStateException</code>å¼‚å¸¸ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad5bff41cf40443994c502a37403892c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55Sz5Z-O5byC5Lmh5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767324394&amp;x-signature=HucqYoD9JvlfNzJv%2FQ7VkGxLxRY%3D" alt="" loading="lazy"/></p>
<p>æœ‰3ç§å¸¸è§çš„é”®å†²çªå¤„ç†æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯ä¿ç•™æ—§å€¼ã€ä½¿ç”¨æ–°å€¼å’Œåˆå¹¶å€¼ï¼Œæ¥ä¸‹æ¥ä¸€ä¸€è®²è§£ã€‚</p>
<p>1)æ–¹å¼ä¸€ï¼šä¿ç•™æ—§å€¼</p>
<pre><code class="hljs language-java" lang="java">Map&lt;Integer, String&gt; cityMap = cityList.stream()
        .collect(Collectors.toMap(City::getCityId, City::getCityName, (oldValue, newValue) -&gt; oldValue));
</code></pre>
<p>è¾“å‡ºç»“æœï¼š</p>
<blockquote>
<p>åŸå¸‚ID: 4, åŸå¸‚åç§°: æ·±åœ³</p>
</blockquote>
<p>2)æ–¹å¼äºŒï¼šä½¿ç”¨æ–°å€¼</p>
<pre><code class="hljs language-java" lang="java">Map&lt;Integer, String&gt; cityMap = cityList.stream()
        .collect(Collectors.toMap(City::getCityId, City::getCityName, (oldValue, newValue) -&gt; newValue));
</code></pre>
<p>è¾“å‡ºç»“æœï¼š</p>
<blockquote>
<p>åŸå¸‚ID: 4, åŸå¸‚åç§°: å¤©æ´¥</p>
</blockquote>
<p>3)æ–¹å¼ä¸‰ï¼šåˆå¹¶å€¼</p>
<pre><code class="hljs language-java" lang="java">Map&lt;Integer, String&gt; cityMap = cityList.stream()
        .collect(Collectors.toMap(City::getCityId, City::getCityName, 
        		(oldValue, newValue) -&gt; oldValue + <span class="hljs-string">", "</span> + newValue));
</code></pre>
<p>è¾“å‡ºç»“æœï¼š</p>
<blockquote>
<p>åŸå¸‚ID: 4, åŸå¸‚åç§°: æ·±åœ³, å¤©æ´¥</p>
</blockquote>
<h3 data-id="heading-5">2.4 æ•°æ®åˆ†ç»„èšåˆ</h3>
<p>å‡è®¾æœ‰ä¸€ä¸ªé”€å”®è®°å½•åˆ—è¡¨ï¼Œéœ€è¦å°†å…¶è½¬æ¢ä¸ºMapï¼Œå…¶ä¸­Keyä¸ºé”€å”®å‘˜ã€Valueä¸ºè¯¥é”€å”®å‘˜çš„æ€»é”€å”®é¢ï¼Œè½¬æ¢æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Getter</span>
<span class="hljs-meta">@Setter</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SalesRecord</span> {
    <span class="hljs-keyword">private</span> String salesPerson;

    <span class="hljs-keyword">private</span> BigDecimal amount;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SalesRecord</span><span class="hljs-params">(String salesPerson, BigDecimal amount)</span> {
        <span class="hljs-built_in">this</span>.salesPerson = salesPerson;
        <span class="hljs-built_in">this</span>.amount = amount;
    }
}
</code></pre>
<pre><code class="hljs language-java" lang="java">List&lt;SalesRecord&gt; salesRecordList = Arrays.asList(
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">SalesRecord</span>(<span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"1000"</span>)),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">SalesRecord</span>(<span class="hljs-string">"æå››"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"2000"</span>)),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">SalesRecord</span>(<span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"980"</span>))
);

Map&lt;String, BigDecimal&gt; salesRecordMap = salesRecordList.stream()
        .collect(Collectors.toMap(SalesRecord::getSalesPerson, SalesRecord::getAmount, BigDecimal::add));
System.out.println(salesRecordMap);
</code></pre>
<p>è¾“å‡ºç»“æœï¼š</p>
<blockquote>
<p>{æå››=2000, å¼ ä¸‰=1980}</p>
</blockquote>
<p>ä¸Šé¢çš„ä¾‹å­æ˜¯é”€å”®é¢ç´¯åŠ ï¼Œä¹Ÿå¯ä»¥åªå–æœ€å°å€¼ï¼š</p>
<pre><code class="hljs language-java" lang="java">Map&lt;String, BigDecimal&gt; salesRecordMap = salesRecordList.stream()
        .collect(Collectors.toMap(SalesRecord::getSalesPerson, SalesRecord::getAmount, BigDecimal::min));
</code></pre>
<p>æ­¤æ—¶çš„è¾“å‡ºç»“æœï¼š</p>
<blockquote>
<p>{æå››=2000, å¼ ä¸‰=980}</p>
</blockquote>
<p>æˆ–è€…åªå–æœ€å¤§å€¼ï¼š</p>
<pre><code class="hljs language-java" lang="java">Map&lt;String, BigDecimal&gt; salesRecordMap = salesRecordList.stream()
        .collect(Collectors.toMap(SalesRecord::getSalesPerson, SalesRecord::getAmount, BigDecimal::max));
</code></pre>
<p>æ­¤æ—¶çš„è¾“å‡ºç»“æœï¼š</p>
<blockquote>
<p>{æå››=2000, å¼ ä¸‰=1000}</p>
</blockquote>
<h3 data-id="heading-6">2.5 æŒ‡å®šMapå®ç°</h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>Collectors.toMap</code>æ˜¯å°†ç»“æœæ”¶é›†åˆ°HashMapä¸­ï¼Œå¦‚æœæœ‰éœ€è¦ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šæˆTreeMapæˆ–è€…LinkedHashMapã€‚</p>
<p>å¦‚æœæƒ³è¦ä¿æŒæ’å…¥é¡ºåºï¼Œå¯ä»¥æŒ‡å®šä½¿ç”¨LinkedHashMapï¼š</p>
<pre><code class="hljs language-java" lang="java">List&lt;City&gt; cityList = Arrays.asList(
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">2</span>, <span class="hljs-string">"ä¸Šæµ·"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">1</span>, <span class="hljs-string">"åŒ—äº¬"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">4</span>, <span class="hljs-string">"æ·±åœ³"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">3</span>, <span class="hljs-string">"å¹¿å·"</span>)
);
Map&lt;Integer, String&gt; cityMap = cityList.stream()
        .collect(Collectors.toMap(City::getCityId, City::getCityName,
                (existing, replacement) -&gt; existing, LinkedHashMap::<span class="hljs-keyword">new</span>));
System.out.println(cityMap);
</code></pre>
<p>è¾“å‡ºç»“æœï¼š</p>
<blockquote>
<p>{2=ä¸Šæµ·, 1=åŒ—äº¬, 4=æ·±åœ³, 3=å¹¿å·}</p>
</blockquote>
<p>å¦‚æœæƒ³è¦æŒ‰é”®æ’åºï¼Œå¯ä»¥æŒ‡å®šä½¿ç”¨TreeMapï¼š</p>
<pre><code class="hljs language-java" lang="java">List&lt;City&gt; cityList = Arrays.asList(
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">2</span>, <span class="hljs-string">"ä¸Šæµ·"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">1</span>, <span class="hljs-string">"åŒ—äº¬"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">4</span>, <span class="hljs-string">"æ·±åœ³"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">3</span>, <span class="hljs-string">"å¹¿å·"</span>)
);
Map&lt;Integer, String&gt; cityMap = cityList.stream()
        .collect(Collectors.toMap(City::getCityId, City::getCityName,
                (existing, replacement) -&gt; existing, TreeMap::<span class="hljs-keyword">new</span>));
System.out.println(cityMap);
</code></pre>
<p>è¾“å‡ºç»“æœï¼š</p>
<blockquote>
<p>{1=åŒ—äº¬, 2=ä¸Šæµ·, 3=å¹¿å·, 4=æ·±åœ³}</p>
</blockquote>
<h2 data-id="heading-7">3. æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-8">3.1 ç©ºå¼‚å¸¸</h3>
<p>å¦‚æœvalueMapperä¸­å–å‡ºçš„å€¼æœ‰nullå€¼ï¼Œä¼šæŠ›å‡º<code>java.lang.NullPointerException</code>å¼‚å¸¸ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">List&lt;City&gt; cityList = Arrays.asList(
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">1</span>, <span class="hljs-string">"åŒ—äº¬"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">2</span>, <span class="hljs-string">"ä¸Šæµ·"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">3</span>, <span class="hljs-string">"å¹¿å·"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">4</span>, <span class="hljs-string">"æ·±åœ³"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">5</span>, <span class="hljs-literal">null</span>)
);
Map&lt;Integer, String&gt; cityMap = cityList.stream()
        .collect(Collectors.toMap(City::getCityId, City::getCityName));
System.out.println(cityMap);
</code></pre>
<p>è¿è¡Œä»¥ä¸Šä»£ç ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d288447108164d26985edd91c27e430a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55Sz5Z-O5byC5Lmh5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767324394&amp;x-signature=lP0nkReM4pnGZp6WqyEI2Kyufs0%3D" alt="" loading="lazy"/></p>
<p>æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼Œç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯è¿‡æ»¤nullå€¼ï¼š</p>
<pre><code class="hljs language-java" lang="java">Map&lt;Integer, String&gt; cityMap = cityList.stream()
        .filter(city -&gt; city.getCityName() != <span class="hljs-literal">null</span>)
        .collect(Collectors.toMap(City::getCityId, City::getCityName));
</code></pre>
<p>ç¬¬äºŒç§è§£å†³æ–¹æ¡ˆæ˜¯æä¾›é»˜è®¤å€¼ï¼š</p>
<pre><code class="hljs language-java" lang="java">Map&lt;Integer, String&gt; cityMap = cityList.stream()
        .collect(Collectors.toMap(City::getCityId,
                city -&gt; Optional.ofNullable(city.getCityName()).orElse(<span class="hljs-string">"æœªçŸ¥"</span>)));
</code></pre>
<h3 data-id="heading-9">3.2 é”®é‡å¤å¼‚å¸¸</h3>
<p>å¦‚æœå‡ºç°é‡å¤é”®ï¼Œä¸”æ²¡æœ‰æä¾›mergeFunctionå‚æ•°ï¼Œä¼šæŠ›å‡º<code>java.lang.IllegalStateException</code>å¼‚å¸¸ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">List&lt;City&gt; cityList = Arrays.asList(
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">1</span>, <span class="hljs-string">"åŒ—äº¬"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">2</span>, <span class="hljs-string">"ä¸Šæµ·"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">3</span>, <span class="hljs-string">"å¹¿å·"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">4</span>, <span class="hljs-string">"æ·±åœ³"</span>),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">City</span>(<span class="hljs-number">4</span>, <span class="hljs-string">"å¤©æ´¥"</span>)
);
Map&lt;Integer, String&gt; cityMap = cityList.stream()
        .collect(Collectors.toMap(City::getCityId, City::getCityName));
System.out.println(cityMap);
</code></pre>
<p>è¿è¡Œä»¥ä¸Šä»£ç ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/80f904404b9744e8a1379f64a65540fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55Sz5Z-O5byC5Lmh5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767324394&amp;x-signature=ZFH7K4V%2BTqNshyn32SOOiRBYDUc%3D" alt="" loading="lazy"/></p>
<p>è§£å†³æ–¹æ¡ˆè§æœ¬ç¯‡æ–‡ç« <strong>2.3 é”®å†²çªå¤„ç†</strong>éƒ¨åˆ†ã€‚</p>
<h2 data-id="heading-10">4. æ€»ç»“</h2>
<p><code>Collectors.toMap</code>æ˜¯Stream APIä¸­æä¾›çš„ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„æ”¶é›†å™¨ï¼Œå®ƒå¯ä»¥å°†æµä¸­çš„å…ƒç´ æ˜ å°„ä¸ºé”®å€¼å¯¹ï¼Œå¹¶æ”¶é›†åˆ°ä¸€ä¸ªMapä¸­ã€‚</p>
<p>å®ƒé€‚ç”¨äºä¸€å¯¹ä¸€æ˜ å°„çš„åœºæ™¯ï¼Œä½†åœ¨ä½¿ç”¨æ—¶ï¼Œè¦æ³¨æ„é¿å…<code>java.lang.NullPointerException</code>å¼‚å¸¸å’Œ</p>
<p><code>java.lang.IllegalStateException</code>å¼‚å¸¸ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€æ—¥å¸¸çŸ¥è¯†ç§¯ç´¯ã€‘Kotlin let å‡½æ•°ã€inline å‡½æ•°ä»¥åŠ DSL]]></title>    <link>https://juejin.cn/post/7588146449005101092</link>    <guid>https://juejin.cn/post/7588146449005101092</guid>    <pubDate>2025-12-27T08:08:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588146449005101092" data-draft-id="7587630413012680714" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€æ—¥å¸¸çŸ¥è¯†ç§¯ç´¯ã€‘Kotlin let å‡½æ•°ã€inline å‡½æ•°ä»¥åŠ DSL"/> <meta itemprop="keywords" content="Kotlin,ç¼–ç¨‹è¯­è¨€,Android"/> <meta itemprop="datePublished" content="2025-12-27T08:08:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Lei_official"/> <meta itemprop="url" content="https://juejin.cn/user/2351234021066314"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€æ—¥å¸¸çŸ¥è¯†ç§¯ç´¯ã€‘Kotlin let å‡½æ•°ã€inline å‡½æ•°ä»¥åŠ DSL
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2351234021066314/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Lei_official
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T08:08:30.000Z" title="Sat Dec 27 2025 08:08:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å‡¡äº‹æœ‰äº¤ä»£ â€”â€” æ¥åˆ°ä»»åŠ¡æ—¶ï¼Œä¸»åŠ¨æ˜ç¡®ä»»åŠ¡ç›®æ ‡ã€èƒŒæ™¯ã€åˆ©ç›Šç›¸å…³æ–¹ã€äº¤ä»˜ç‰©ã€æ—¶é—´èŠ‚ç‚¹ã€‚<br/>ä»¶ä»¶æœ‰ç€è½ â€”â€” æ‰§è¡Œä»»åŠ¡è¿‡ç¨‹ä¸­ï¼Œåœ¨é‡Œç¨‹ç¢‘èŠ‚ç‚¹åŠæ—¶åŒæ­¥ï¼Œåšå¥½é¢„æœŸç®¡ç†ã€‚<br/>äº‹äº‹æœ‰å›éŸ³ â€”â€” ä»»åŠ¡å®Œæˆåï¼Œæœ‰å¤ç›˜ï¼Œæœ‰æ±‡æŠ¥ï¼Œæœ‰æ€»ç»“ã€‚</p>
</blockquote>
<p>è¿™ç¯‡æ–‡ç« è®°å½•äº†è¿‘æœŸç§¯ç´¯çš„ä¸€äº›é›¶æ•£çŸ¥è¯†ç‚¹ï¼Œä¸´è¿‘å…ƒæ—¦ã€æ˜¥èŠ‚ï¼Œè¿™ä¸ªæ—¶æœŸæ˜¯ä¸€å¹´é‡Œå·¥ä½œç›¸å¯¹è½»æ¾çš„é˜¶æ®µï¼ŒåŒæ—¶ä¹Ÿæ˜¯å¤ç›˜æ€»ç»“è¿‡å»ä¸€å¹´çš„ç»éªŒã€ä»¥åŠåšå¥½æ˜å¹´ç›®æ ‡è§„åˆ’çš„å…³é”®èŠ‚ç‚¹ã€‚<strong>åˆ©ç”¨å¥½ï¼Œåˆ«è™šåº¦</strong>ã€‚</p>
<h2 data-id="heading-0">ä½ çœŸçš„éœ€è¦ä½¿ç”¨ let å‡½æ•°å—ï¼Ÿ</h2>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d392b67f326648ed9a651e8b1f2addc9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGVpX29mZmljaWFs:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427710&amp;x-signature=KRUvnLcCqA%2F33q2JkVaq1FnNvrE%3D" alt="image.png" width="50%" loading="lazy"/>
<p>åœ¨ Kotlin ä¸­ï¼Œ<code>let</code>ã€<code>apply</code>ã€<code>also</code>ã€<code>run</code> ç­‰ç­‰å‡½æ•°ï¼Œæ˜¯é™ä½ä»£ç è¡Œæ•°ã€æå‡å¯è¯»æ€§çš„åˆ©å™¨ï¼Œç„¶è€Œå®ƒä»¬å¹¶ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œå¦‚æœä½¿ç”¨ä¸å½“ï¼Œä¼šå¸¦æ¥ç›¸åçš„æ•ˆæœã€‚</p>
<h3 data-id="heading-1">let çš„ä¸€èˆ¬ç”¨æ³•</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å¦‚æœå…ƒç´ éç©ºï¼Œåˆ™å¯¹å…¶è¿›è¡Œç»˜åˆ¶</span>
element?.let { render(it) }

<span class="hljs-comment">// é let å†™æ³•</span>
<span class="hljs-keyword">if</span> (element != <span class="hljs-literal">null</span>) {
	render(element)
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>let</code> å‡½æ•°å°†3è¡Œä»£ç ç²¾ç®€æˆä¸º1è¡Œï¼Œç²¾ç®€äº† 66% çš„ä»£ç ã€‚å®ƒé€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š</p>
<ul>
<li>å•æ¬¡è°ƒç”¨è¯¥å¯¹è±¡</li>
<li>lambda è¡Œæ•°å¾ˆå°‘</li>
<li>æ²¡æœ‰åç»­ä¾èµ–</li>
</ul>
<p>ä¸ä¹‹ç›¸åçš„æ¡ä»¶ï¼Œå°±æ˜¯ä¸é€‚ç”¨äº let çš„åœºæ™¯ã€‚</p>
<h3 data-id="heading-2">let ä¸é€‚ç”¨çš„åœºæ™¯</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ç¾éš¾ç°åœº1ï¼šè¡Œæ•°å¤šã€æœ‰åç»­ä¾èµ–</span>
element?.let { e -&gt;
    config?.let { c -&gt;
        adapter?.let { a -&gt;
            renderer?.let { r -&gt;
                r.render(e, c, a)
            }
        }
    }
}

<span class="hljs-comment">// ç¾éš¾ç°åœº2ï¼šè¶…è¿‡1è¡Œä½¿ç”¨ let å¯¹è±¡</span>
element?.let {
    doSomething(it)
    doAnotherThing(it)
    doMore(it)
}
</code></pre>
<p>ä»¥ä¸Šå·²ç»æ˜¯ Kotlin çš„åæ¨¡å¼äº†ï¼Œè¿™æ ·çš„ä»£ç ä¸æ–­<code>å‘å³åç§»ï¼ˆrightward driftï¼‰</code>ï¼Œ<strong>éš¾è¯»å¹¶ä¸”éš¾æ”¹</strong>ï¼Œåœ¨è¿›è¡Œ Code Review æ—¶ä¸€å®šè¦è¯†åˆ«å‡ºæ¥ã€‚</p>
<h3 data-id="heading-3">æ›¿ä»£æ–¹æ¡ˆ return fast</h3>
<p>åœ¨å‡½æ•°çš„å¼€å¤´ï¼Œæ£€æŸ¥å˜é‡æ¡ä»¶ï¼Œå¦‚æœä¸ç¬¦åˆç«‹åˆ» returnï¼Œå¯ä»¥åœ¨éœ€è¦çš„ä½ç½®å¢åŠ æ—¥å¿—æ‰“å°ï¼Œä»¥ä¾¿è¿½æº¯é—®é¢˜ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateView</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> e = element ?: <span class="hljs-keyword">return</span>
    <span class="hljs-keyword">val</span> c = config ?: <span class="hljs-keyword">return</span>
    <span class="hljs-keyword">val</span> a = adapter ?: <span class="hljs-keyword">return</span>

    render(e, c, a)
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ˜¯å¥½ä»£ç ï¼Ÿ</strong></p>
<ul>
<li>æ²¡æœ‰åµŒå¥—</li>
<li>æ§åˆ¶æµæ¸…æ™°</li>
<li>å¯è°ƒè¯•ï¼ˆæ¯ä¸€è¡Œéƒ½èƒ½æ‰“æ–­ç‚¹ï¼‰</li>
<li>éå¸¸ç¬¦åˆ â€œfail fastâ€ åŸåˆ™</li>
</ul>
<p>æ›´è¿›ä¸€æ­¥ï¼Œå¦‚æœ eã€cã€a è¿™ä¸‰ä¸ªå¯¹è±¡ç»å¸¸ä¸€èµ·åˆ¤ç©ºï¼Œå¯ä»¥å°†å®ƒä»¬æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªçŠ¶æ€ï¼Œæ¨èå¯¹å®ƒä»¬è¿›è¡ŒçŠ¶æ€èšåˆï¼Œæœ‰åˆ©äºé•¿æœŸä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// çŠ¶æ€èšåˆ</span>
<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RenderState</span>(
    <span class="hljs-keyword">val</span> element: Element,
    <span class="hljs-keyword">val</span> config: Config,
    <span class="hljs-keyword">val</span> adapter: Adapter
)

<span class="hljs-comment">// åªæœ‰ä¸€ä¸ªå˜é‡</span>
<span class="hljs-keyword">val</span> state: RenderState? = ...

<span class="hljs-comment">// ä½¿ç”¨æ—¶åˆ¤æ–­è¯¥å˜é‡</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateView</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> s = state ?: <span class="hljs-keyword">return</span>
    render(s)
}
</code></pre>
<p>æ­¤å¤–ï¼Œå¦‚æœå‘ç°ï¼Œä»£ç é‡Œå¤šå¤„è¿›è¡Œåˆ¤ç©ºæ“ä½œï¼Œåˆ™å¯ä»¥åˆ©ç”¨ DSLï¼Œå°†åˆ¤ç©ºæ“ä½œæå–å‡º <code>withReadyElement</code> å‡½æ•°ï¼Œ</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æå– inline å‡½æ•°ï¼Œé›†ä¸­è¿›è¡Œå¯ç©ºæ€§å¤„ç†</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">withReadyElement</span><span class="hljs-params">(block: (<span class="hljs-type">Element</span>) -&gt; <span class="hljs-type">Unit</span>)</span></span> {
    <span class="hljs-keyword">val</span> e = element ?: <span class="hljs-keyword">return</span>
    block(e)
}

<span class="hljs-comment">// è°ƒç”¨ç‚¹æ›´åŠ ç¾è§‚å¹²å‡€</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateView</span><span class="hljs-params">()</span></span> {
    withReadyElement {
        render(it)
    }
}
</code></pre>
<h2 data-id="heading-4">inline fun ç”¨äºæ¶ˆé™¤ Lambda å¯¹è±¡é¢å¤–å¼€é”€</h2>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2a21849cdca94449b6a88f2f36420c77~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGVpX29mZmljaWFs:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427710&amp;x-signature=knoT7IVA8H0X%2BSNR%2BClpTdCKsCo%3D" alt="image.png" width="70%" loading="lazy"/>
<p><code>inline fun</code> æ˜¯â€œä¸º Lambda ä¹°å•çš„å·¥å…·â€ï¼Œ<strong>ç”¨äºæ¶ˆé™¤ Lambda å‚æ•°å¼•èµ·çš„å¯¹è±¡åˆ›å»º&amp;é—´æ¥è°ƒç”¨å¼€é”€</strong>ï¼ŒåŒæ ·åœ°ï¼Œå®ƒä¹Ÿä¸æ˜¯â€œé“¶å¼¹â€ï¼Œå¦‚æœä½¿ç”¨ä¸å½“ï¼Œåè€Œä¼šå¼•èµ·æ€§èƒ½ä¸‹é™ã€‚</p>
<h3 data-id="heading-5">æ™®é€š Lambda å‡½æ•°ä¸ inline Lambda å‡½æ•°</h3>
<p><strong>æ™®é€š Lambda å‡½æ•°</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doSomething</span><span class="hljs-params">(block: () -&gt; <span class="hljs-type">Unit</span>)</span></span> {
    block()
}
</code></pre>
<p>ç³»ç»Ÿåœ¨ç¼–è¯‘è¿™æ®µä»£ç æ—¶ï¼Œå®é™…ä¸Šå‘ç”Ÿäº†ï¼š</p>
<ul>
<li>åˆ›å»ºä¸€ä¸ª <code>Function0</code> å¯¹è±¡ï¼ˆè¡¨ç¤º0ä¸ªå‚æ•°ã€å³æ— å‚å‡½æ•°ï¼‰</li>
<li>æ•è·å¤–éƒ¨å˜é‡ï¼Œç”Ÿæˆé—­åŒ…</li>
<li>é€šè¿‡ <code>invoke()</code> é—´æ¥è°ƒç”¨</li>
</ul>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬è°ƒç”¨ <code>doSomething { println("hello") }</code> åï¼Œç¼–è¯‘å™¨å®é™…ä¸Šåˆ›å»ºäº†ä¸€ä¸ªç±»ï¼Œå¹¶è°ƒç”¨å…¶ <code>invoke</code> å‡½æ•°ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DoSomething$1</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Function0</span>&lt;Unit&gt; {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Unit <span class="hljs-title function_">invoke</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"hello"</span>)
        <span class="hljs-keyword">return</span> Unit.INSTANCE;
    }
}
</code></pre>
<p><strong>inline Lambda å‡½æ•°</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doSomething</span><span class="hljs-params">(block: () -&gt; <span class="hljs-type">Unit</span>)</span></span> {
    block()
}

<span class="hljs-comment">// ç¼–è¯‘åç›´æ¥å±•å¼€</span>
println(<span class="hljs-string">"hello"</span>)
</code></pre>
<h3 data-id="heading-6">æ ‡å‡†åº“çš„ inline ç”¨æ³•</h3>
<p>åœ¨ Kotlin æ ‡å‡†åº“é‡Œï¼Œè¿™äº›å‡½æ•°éƒ½æ˜¯ inline å®ç°</p>
<ul>
<li><code>let</code></li>
<li><code>apply</code></li>
<li><code>run</code></li>
<li><code>with</code></li>
<li><code>use</code></li>
<li><code>synchronized</code></li>
</ul>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> T.<span class="hljs-title">apply</span><span class="hljs-params">(block: <span class="hljs-type">T</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span>: T
</code></pre>
<h3 data-id="heading-7">inline çš„è´Ÿé¢ä½œç”¨</h3>
<p>ç”±äº inline æœ¬è´¨ä¸Šé‡‡ç”¨äº† <code>å¤åˆ¶-ç²˜è´´</code> çš„æ¨¡å¼ï¼Œå› æ­¤å®ƒä¼šåœ¨æ¯ä¸ªè°ƒç”¨ç‚¹å¤åˆ¶ä¸€ä»½å‡½æ•°ä»£ç ï¼Œè¿™ä¼šé€ æˆ <code>APK / DEX è†¨èƒ€</code>ï¼Œå¯¹ Android æ¥è¯´ï¼Œæ›´ä¼šå¼•èµ· <strong>æ–¹æ³•æ•°å¢åŠ ï¼Œç”šè‡³çªç ´ 64K é™åˆ¶</strong>ã€‚</p>
<h3 data-id="heading-8">inline çš„åº”ç”¨åœºæ™¯</h3>
<ul>
<li>å‚æ•°æ˜¯ <code>lambda</code> ç±»å‹</li>
<li><code>lambda</code> éå¸¸çŸ­</li>
<li>è¯¥å‡½æ•° 90% ä»¥ä¸Šæ˜¯ lambda è°ƒç”¨</li>
<li>åº”ç”¨åœ¨å¾ªç¯ / UI / çƒ­è·¯å¾„ä¸­</li>
<li>inline æ”¶ç›Š &gt; ä»£ç è†¨èƒ€æˆæœ¬</li>
</ul>
<h2 data-id="heading-9">DSLï¼ŒæŠŠæ¡å¥½â€œæå‡å¯è¯»æ€§â€ä¸â€œæ»¥ç”¨â€ä¹‹é—´çš„ç•Œé™</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f6f805ff7004862a181894f89e18a2b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGVpX29mZmljaWFs:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427710&amp;x-signature=s7yDmw0ziEFA4oiyoqcuzxdSf%2Fc%3D" alt="image.png" loading="lazy"/></p>
<p><code>DSLï¼ˆDomain-Specific Languageï¼Œé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰</code>ï¼Œæ˜¯ä¸€ç§ <strong>åªä¸ºæŸä¸ªç‰¹å®šé¢†åŸŸæœåŠ¡</strong> çš„è¯­è¨€ï¼Œç›®æ ‡ä¸æ˜¯â€œä»€ä¹ˆéƒ½èƒ½å¹²â€ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªé¢†åŸŸçš„è¡¨è¾¾åšåˆ°æœ€æ¸…æ™°ã€æœ€çœå¿ƒã€æœ€ä¸å®¹æ˜“å†™é”™ã€‚</p>
<p>å¦‚ä½•ç†è§£â€œé¢†åŸŸâ€å‘¢ï¼Ÿåœ¨æˆ‘çœ‹æ¥ï¼Œâ€œé¢†åŸŸâ€æ˜¯æŒ‡ç‰¹å®šçš„åœºæ™¯ã€è¯­å¢ƒã€ä¸Šä¸‹æ–‡ï¼Œå®ƒå…·æœ‰ä¸€å®šçš„é‡å¤æ€§ï¼Œå› æ­¤é€šè¿‡æç‚¼æ€»ç»“ DSLï¼Œèƒ½å¤Ÿé™ä½é‡å¤ä½¿ç”¨çš„æˆæœ¬ã€‚â€œé¢†åŸŸâ€å¯ä»¥æ˜¯æŠ€æœ¯ä¸Šçš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸šåŠ¡åœºæ™¯é‡Œçš„ã€‚</p>
<h3 data-id="heading-10">GPL ä¸ DSL</h3>
<p>ä¸ DSL ç›¸å¯¹çš„æ¦‚å¿µï¼Œæ˜¯ <strong>é€šç”¨è¯­è¨€ï¼ˆGPLï¼‰</strong>ï¼ŒJava / Kotlin / C++ éƒ½å±äºæ­¤ç±»ï¼Œå®ƒä»¬åŠŸèƒ½å¼ºå¤§ä¸”å…¨é¢ï¼Œä½†éšä¹‹è€Œæ¥çš„ï¼Œæ˜¯å†™æ³•ä¸¥è°¨ç”šè‡³å†—é•¿ï¼Œæ— æ³•åšåˆ°é’ˆå¯¹ç‰¹å®šåœºæ™¯ï¼ˆé¢†åŸŸï¼‰è¿›è¡Œç®€åŒ–ã€‚</p>
<p>DSL åˆ™ä¸“æ³¨äºè§£å†³ä¸€ä¸ªç‰¹å®šé¢†åŸŸçš„é—®é¢˜ï¼Œä¸ºæ­¤è¿›è¡Œäº†ç‰¹å®šä¼˜åŒ–ï¼ŒçŸ­ã€å¹³ã€å¿«ã€å‡†ã€‚</p>
<p>GPLã€DSL éƒ½å¯ä»¥è§£å†³é—®é¢˜ï¼Œé‡ç‚¹åœ¨äºé€‰æ‹©ä½¿ç”¨å“ªä¸€ä¸ªã€‚</p>
<h3 data-id="heading-11">DSL çš„ä¸¤å¤§ç±»å‹ï¼šå¤–éƒ¨ DSL</h3>
<p>å¤–éƒ¨ DSL å…·å¤‡ <strong>ç‹¬ç«‹çš„è¯­æ³•å’Œè§£æå™¨</strong> ï¼Œæ›´åƒä¸€é—¨æ–°çš„ç¼–ç¨‹è¯­è¨€ï¼Œå› æ­¤å…¶è¡¨è¾¾èƒ½åŠ›å¾ˆå¼ºã€‚åŒæ—¶ï¼Œç”±äºä¾èµ–äºç‰¹å®šè§£æå™¨ï¼Œæ•…å®šåˆ¶æˆæœ¬é«˜ã€‚</p>
<p>å¸¸è§çš„å¤–éƒ¨ DSL æœ‰ï¼š</p>
<ul>
<li>SQL</li>
<li>æ­£åˆ™è¡¨è¾¾å¼</li>
<li>Gradle Groovy/Kotlin DSLï¼ˆbuild.gradleï¼‰</li>
<li>HTML / CSS</li>
</ul>
<h3 data-id="heading-12">DSL çš„ä¸¤å¤§ç±»å‹ï¼šå†…éƒ¨ DSL</h3>
<p>å†…éƒ¨ DSL åœ¨ Kotlin è¯­è¨€ä¸­æ˜¯éå¸¸å¸¸è§çš„ï¼Œä¾‹å¦‚å‰æ–‡çš„ <code>let</code>ã€<code>apply</code>ã€<code>also</code> ç­‰å‡å±äºæ­¤ç±»ã€‚å¯ä»¥é€šè¿‡ Kotlin è¯­æ³•ç‰¹æ€§ï¼Œä½¿ä»£ç â€œçœ‹èµ·æ¥åƒæ–°çš„è¯­è¨€â€ã€‚Kotlin çš„æ ‡å‡†åº“ä¸­ï¼Œæœ‰å¾ˆå¤š API æœ¬èº«å°±æ˜¯ DSLã€‚ä¸¾ä¸¤ä¸ªå¸¸è§çš„ä¾‹å­ï¼š</p>
<p><strong>ä¾‹1ï¼ŒLambda with Receiver</strong></p>
<p>å®šä¹‰ <code>user</code> DSLï¼Œä»£æ›¿ <code>set</code> å‡½æ•°ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä½¿ç”¨ Lambdaï¼ŒåŸŸå†…å¯¹è±¡ä¸º User</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">user</span><span class="hljs-params">(block: <span class="hljs-type">User</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> {
    <span class="hljs-keyword">val</span> u = User()
    u.block()
}

<span class="hljs-comment">// ä½¿ç”¨ DSL</span>
user {
	name = <span class="hljs-string">"Lei"</span>
}

<span class="hljs-comment">// ä¸ä½¿ç”¨ DSL</span>
user.setName(<span class="hljs-string">"Lei"</span>)
</code></pre>
<p><strong>ä¾‹2ï¼Œ infix å‡½æ•°</strong></p>
<p>å¯ä»¥æå‡å¯è¯»æ€§ï¼Œä¾‹å¦‚å®šä¹‰äºŒå…ƒè¿ç®—ç¬¦ <code>eq</code>ï¼Œæ¯”è¾ƒ String å¯¹è±¡ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å£°æ˜ DSL</span>
<span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> String.<span class="hljs-title">eq</span><span class="hljs-params">(value: <span class="hljs-type">String</span>)</span></span>

<span class="hljs-comment">// ä½¿ç”¨ DSL</span>
<span class="hljs-string">"status"</span> eq <span class="hljs-string">"success"</span>
</code></pre>
<blockquote>
<p>Gradle Kotlinã€Jetpack Composeã€HTML éƒ½æ˜¯å…¸å‹çš„ DSLï¼ŒUIç»“æ„=ä»£ç ç»“æ„ï¼Œèµ·åˆ°â€œçœ‹ä»£ç çŸ¥UIâ€çš„ä½œç”¨ã€‚</p>
</blockquote>
<h3 data-id="heading-13">DSL ä¸æ˜¯ç‚«æŠ€å·¥å…·ï¼Œè€Œæ˜¯æŠŠä¸šåŠ¡è§„åˆ™æå–ä¸ºä»£ç çš„æ‰‹æ®µ</h3>













<table><thead><tr><th>å€¼å¾—è®¾è®¡ DSL</th><th>ä¸è¯¥ç”¨DSL</th></tr></thead><tbody><tr><td>âœ…æ˜¯ä¸æ˜¯åå¤å†™ç›¸åŒç»“æ„ï¼Ÿ<br/>âœ…ä¸šåŠ¡è§„åˆ™æ˜¯å¦å›ºå®šï¼Ÿ<br/>âœ…ç°åœ¨çš„ä»£ç æ˜¯å¦â€œçœ‹ä¸å‡ºä¸šåŠ¡è¯­ä¹‰â€ï¼Ÿ<br/>âœ…é”™è¯¯æ˜¯ä¸æ˜¯ç»å¸¸å‘ç”Ÿåœ¨â€œç”¨æ³•ä¸å¯¹â€ï¼Ÿ</td><td>âŒä¸€æ¬¡æ€§é€»è¾‘<br/>âŒéœ€æ±‚ä¸ç¨³å®š<br/>âŒå›¢é˜Ÿ Kotlin æ°´å¹³å‚å·®<br/>âŒDSL è®¾è®¡è€…ä¸åœ¨ä¸€çº¿ç»´æŠ¤</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[shadcn-ui çš„ Radix Dialog è¿™ä¸¤ä¸ªè­¦å‘Šåˆ°åº•åœ¨è¯´ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¼šæŠ¥ï¼Ÿæ€ä¹ˆä¿®ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7587998744294047750</link>    <guid>https://juejin.cn/post/7587998744294047750</guid>    <pubDate>2025-12-26T08:44:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587998744294047750" data-draft-id="7587825267879182377" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="shadcn-ui çš„ Radix Dialog è¿™ä¸¤ä¸ªè­¦å‘Šåˆ°åº•åœ¨è¯´ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¼šæŠ¥ï¼Ÿæ€ä¹ˆä¿®ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,WeUI,React.js"/> <meta itemprop="datePublished" content="2025-12-26T08:44:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨å¤œå¯»æ™´å¤©"/> <meta itemprop="url" content="https://juejin.cn/user/1943592288391496"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            shadcn-ui çš„ Radix Dialog è¿™ä¸¤ä¸ªè­¦å‘Šåˆ°åº•åœ¨è¯´ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¼šæŠ¥ï¼Ÿæ€ä¹ˆä¿®ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1943592288391496/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨å¤œå¯»æ™´å¤©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T08:44:52.000Z" title="Fri Dec 26 2025 08:44:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é—®é¢˜</h2>
<p>æœ€è¿‘åœ¨é¡¹ç›®é‡Œé‡åˆ°ä¸¤ä¸ªæ¥è‡ª Radix Dialog çš„æ§åˆ¶å°æç¤ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6e5a30b959ff477987d91cbb78c449e3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5aSc5a-75pm05aSp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767343491&amp;x-signature=d1n2YG8uQeurasELGsmVhqqQi6k%3D" alt="image.png" loading="lazy"/></p>
<p>å®ƒä»¬ä¸æ˜¯ â€œåŠŸèƒ½é”™è¯¯â€ï¼Œä½†å±äº <strong>æ— éšœç¢ï¼ˆa11yï¼‰çº§åˆ«çš„è­¦å‘Š</strong>ï¼šRadix åœ¨å¼€å‘ç¯å¢ƒä¸»åŠ¨æé†’ä½ å¯¹è¯æ¡†ç¼ºå°‘ â€œå¯è¢«å±å¹•é˜…è¯»å™¨æ­£ç¡®ç†è§£â€ çš„å…³é”®è¯­ä¹‰ã€‚</p>
<p>æœ¬æ–‡åŸºäº coco-appï¼ˆReact 18 + TS + Tailwind + shadcn-uiï¼‰é‡ŒçœŸå®è¸©å‘çš„ä¿®å¤è¿‡ç¨‹æ€»ç»“ã€‚</p>
<hr/>
<h2 data-id="heading-1">1. èƒŒæ™¯ï¼šRadix Dialog éœ€è¦ä»€ä¹ˆè¯­ä¹‰ï¼Ÿ</h2>
<p>ä¸€ä¸ªå¯è®¿é—®çš„ Dialog è‡³å°‘éœ€è¦ï¼š</p>
<ul>
<li><strong>å¯è®¿é—®åç§°ï¼ˆaccessible nameï¼‰</strong>ï¼šå‘Šè¯‰è¯»å±è½¯ä»¶ â€œè¿™ä¸ªå¼¹çª—å«å•¥â€
<ul>
<li>å¯¹åº”ï¼š<code>&lt;DialogTitle /&gt;</code>ï¼ˆå†…éƒ¨æ˜ å°„åˆ° <code>aria-labelledby</code>ï¼‰</li>
</ul>
</li>
<li><strong>å¯è®¿é—®æè¿°ï¼ˆaccessible descriptionï¼‰</strong>ï¼šå‘Šè¯‰è¯»å±è½¯ä»¶ â€œè¿™ä¸ªå¼¹çª—åœ¨è¯´å•¥/è¦ç”¨æˆ·åšå•¥â€
<ul>
<li>å¯¹åº”ï¼š<code>&lt;DialogDescription /&gt;</code>ï¼ˆå†…éƒ¨æ˜ å°„åˆ° <code>aria-describedby</code>ï¼‰</li>
</ul>
</li>
</ul>
<p>Radix çš„ç¤ºä¾‹ç»“æ„ä¹Ÿæ˜¯è¿™ä¸ªé¡ºåºï¼ˆTitle + Description + å†…å®¹ + Close ç­‰ï¼‰ã€‚</p>
<hr/>
<h2 data-id="heading-2">2. æŠ¥é”™ 1ï¼šä¸ºä»€ä¹ˆå¿…é¡»è¦ <code>DialogTitle</code>ï¼Ÿ</h2>
<h3 data-id="heading-3">2.1 æŠ¥é”™å«ä¹‰</h3>
<blockquote>
<p><code>DialogContent requires a DialogTitle...</code></p>
</blockquote>
<p>æ„æ€æ˜¯ï¼šä½ çš„ <code>&lt;DialogContent /&gt;</code> é‡Œæ²¡æœ‰æä¾›æ ‡é¢˜ï¼Œå¯¼è‡´ Dialog æ²¡æœ‰å¯è®¿é—®åç§°ã€‚è¯»å±ç”¨æˆ·æ‰“å¼€å¼¹çª—æ—¶ï¼Œä¸çŸ¥é“è¿™æ˜¯ â€œæ›´æ–°æç¤ºâ€ è¿˜æ˜¯ â€œåˆ é™¤ç¡®è®¤â€ã€‚</p>
<h3 data-id="heading-4">2.2 coco-app çš„ä¿®å¤æ–¹å¼</h3>
<p>æˆ‘ä»¬åœ¨ <code>UpdateApp</code> å¼¹çª—ä¸­å¢åŠ äº†ä¸€ä¸ª â€œå¯¹è§†è§‰éšè—ã€å¯¹è¯»å±å¯è§â€ çš„æ ‡é¢˜ï¼š</p>
<ul>
<li>æ–‡ä»¶ï¼š<code>src/components/UpdateApp/index.tsx:164</code></li>
<li>ä»£ç å½¢æ€ï¼š</li>
</ul>
<pre><code class="hljs language-tsx" lang="tsx">&lt;<span class="hljs-title class_">DialogTitle</span> className=<span class="hljs-string">"sr-only"</span>&gt;{<span class="hljs-title function_">t</span>(<span class="hljs-string">"update.title"</span>)}&lt;/<span class="hljs-title class_">DialogTitle</span>&gt;
</code></pre>
<p>ä¸ºä»€ä¹ˆç”¨ <code>sr-only</code>ï¼Ÿ</p>
<ul>
<li>Tailwind çš„ <code>sr-only</code> èƒ½è¾¾åˆ°<strong>UI ä¸å˜ï¼Œè¯»å±å¯è¯»</strong>çš„æ•ˆæœï¼ˆæœ‰äº› shadcn æ¨¡æ¿ä¼šæœ‰ç°æˆçš„ <code>VisuallyHidden</code> ç»„ä»¶ï¼‰ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-5">3. æŠ¥é”™ 2ï¼šä¸ºä»€ä¹ˆå¿…é¡»è¦ <code>DialogDescription</code> / <code>aria-describedby</code>ï¼Ÿ</h2>
<h3 data-id="heading-6">3.1 æŠ¥é”™å«ä¹‰</h3>
<blockquote>
<p><code>Warning: Missing Description or aria-describedby={undefined} for {DialogContent}.</code></p>
</blockquote>
<p>æ„æ€æ˜¯ï¼šDialog æ²¡æœ‰å¯è®¿é—®æè¿°ï¼Œæˆ–è€…ä½ æ˜¾å¼æŠŠ <code>aria-describedby</code> ç½®ä¸º <code>undefined</code> ä½†åˆæ²¡æœ‰æè¿°èŠ‚ç‚¹å…³è”ä¸Šã€‚</p>
<p>Radix çš„é€»è¾‘å¤§è‡´æ˜¯ï¼š</p>
<ul>
<li>ä½ æä¾› <code>&lt;DialogDescription /&gt;</code>ï¼šRadix è‡ªåŠ¨æŠŠå®ƒçš„ id ç»‘å®šåˆ° <code>aria-describedby</code></li>
<li>ä½ ä¸æä¾› <code>&lt;DialogDescription /&gt;</code>ï¼šRadix ä¼šæé†’ä½  â€œç¼ºæè¿°â€ï¼Œé¿å…è¯»å±ç”¨æˆ·åªå¬åˆ°æ ‡é¢˜ä½†ä¸çŸ¥é“è¦åšä»€ä¹ˆ</li>
</ul>
<h3 data-id="heading-7">3.2 coco-app çš„ä¿®å¤æ–¹å¼</h3>
<p>æˆ‘ä»¬æŠŠåŸå…ˆå±•ç¤ºæ›´æ–°è¯´æ˜çš„ <code>div</code> æ›¿æ¢ä¸º <code>DialogDescription</code>ï¼ˆUI class ä¸å˜ï¼Œåªæ¢ç»„ä»¶è¯­ä¹‰ï¼‰ï¼š</p>
<ul>
<li>æ–‡ä»¶ï¼š<code>src/components/UpdateApp/index.tsx:179-193</code></li>
<li>ä»£ç å½¢æ€ï¼š</li>
</ul>
<pre><code class="hljs language-tsx" lang="tsx">&lt;<span class="hljs-title class_">DialogDescription</span> className=<span class="hljs-string">"text-sm leading-5 py-2 text-foreground text-center"</span>&gt;
  {updateInfo ? ... : <span class="hljs-title function_">t</span>(<span class="hljs-string">"update.date"</span>)}
&lt;/<span class="hljs-title class_">DialogDescription</span>&gt;
</code></pre>
<p>è¿™æ · Radix å°±èƒ½è‡ªåŠ¨ç”Ÿæˆæ­£ç¡®çš„ <code>aria-describedby</code>ï¼Œwarning æ¶ˆå¤±ã€‚</p>
<hr/>
<h2 data-id="heading-8">4. â€œæ´ç™–â€ï¼šå®ƒä¸æ˜¯ bugï¼Œä½†æ˜¯å°±æ˜¯åœ¨æ§åˆ¶å°æŠ¥çº¢äº†...</h2>
<p>shadcn-ui çš„ <code>Dialog</code> æœ¬è´¨æ˜¯å¯¹ Radix Dialog çš„ä¸€å±‚è½»å°è£…ï¼ˆé¡¹ç›®é‡Œå¯¹åº” <code>src/components/ui/dialog.tsx</code>ï¼‰ï¼Œå®ƒä¸ä¼šå¼ºåˆ¶ä½ å¿…é¡»å†™ Title/Descriptionã€‚</p>
<h3 data-id="heading-9">4.1 ä¸ºä»€ä¹ˆæ›´å®¹æ˜“è¸©å‘ï¼Ÿ</h3>
<p>å› ä¸º UI ä¸Šä½ å¯èƒ½è§‰å¾—ï¼š</p>
<ul>
<li>æˆ‘å·²ç»æœ‰å›¾æ ‡ï¼ˆlogoï¼‰</li>
<li>æˆ‘å·²ç»æœ‰ä¸€æ®µè¯´æ˜æ–‡å­—ï¼ˆdiv/pï¼‰</li>
<li>æˆ‘ä¸æƒ³æ˜¾ç¤ºæ ‡é¢˜</li>
</ul>
<p>ä½† <strong>è§†è§‰ä¸Šæ»¡è¶³ â‰  è¯­ä¹‰ä¸Šæ»¡è¶³</strong>ã€‚è¯»å±ä¾èµ–çš„æ˜¯ <code>aria-labelledby/aria-describedby</code> çš„å…³è”ï¼Œè€Œä¸æ˜¯ä½ é¡µé¢é‡Œæœ‰æ²¡æœ‰ä¸€ä¸ªçœ‹èµ·æ¥åƒæ ‡é¢˜çš„ <code>div</code>ã€‚</p>
<hr/>
<h2 data-id="heading-10">5. æœ€æ¨èçš„å†™æ³•ã€æ›´æ ‡å‡†çš„å†™æ³•</h2>
<h3 data-id="heading-11">5.1 æ ‡é¢˜ä¸æƒ³æ˜¾ç¤ºï¼šç”¨ <code>sr-only</code></h3>
<pre><code class="hljs language-tsx" lang="tsx">&lt;<span class="hljs-title class_">DialogTitle</span> className=<span class="hljs-string">"sr-only"</span>&gt;{<span class="hljs-title function_">t</span>(<span class="hljs-string">"xxx.title"</span>)}&lt;/<span class="hljs-title class_">DialogTitle</span>&gt;
</code></pre>
<h3 data-id="heading-12">5.2 æè¿°å­˜åœ¨ï¼šç”¨ <code>DialogDescription</code></h3>
<pre><code class="hljs language-tsx" lang="tsx">&lt;<span class="hljs-title class_">DialogDescription</span> className=<span class="hljs-string">"sr-only"</span>&gt;
  {<span class="hljs-title function_">t</span>(<span class="hljs-string">"xxx.description"</span>)}
&lt;/<span class="hljs-title class_">DialogDescription</span>&gt;
</code></pre>
<p>æ˜¯å¦ä¸€å®šè¦éšè— Descriptionï¼Ÿ</p>
<ul>
<li>ä¸ä¸€å®šã€‚åƒæ›´æ–°å¼¹çª—è¿™ç§ â€œæ­£æ–‡å°±æ˜¯æè¿°â€ï¼Œç›´æ¥ç”¨ <code>DialogDescription</code> åŒ…ä½æ­£æ–‡æœ€è‡ªç„¶ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-13">6. ä¹Ÿå¯ä»¥æ‰‹åŠ¨ <code>aria-describedby</code> å—ï¼Ÿå¯ä»¥ï¼Œä½†æ›´å®¹æ˜“å‡ºé”™</h2>
<p>ä½ å½“ç„¶å¯ä»¥è‡ªå·±å†™ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx">&lt;<span class="hljs-title class_">DialogContent</span> aria-describedby=<span class="hljs-string">"my-desc"</span>&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"my-desc"</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/<span class="hljs-title class_">DialogContent</span>&gt;
</code></pre>
<p>ä½†å‘åœ¨äºï¼š</p>
<ul>
<li>id å¯èƒ½å¿˜äº†å†™ / é‡å¤</li>
<li>æ¡ä»¶æ¸²æŸ“å¯¼è‡´èŠ‚ç‚¹ä¸åœ¨ DOMï¼ˆaria æŒ‡å‘ä¸å­˜åœ¨çš„ idï¼‰</li>
<li>é‡æ„æ—¶åˆ æ‰äº† <code>id</code> æ²¡å‘ç°</li>
<li>å¤šå¼¹çª—å¤ç”¨ç»„ä»¶æ—¶ id å†²çª</li>
</ul>
<p>æ‰€ä»¥åœ¨ shadcn/Radix ä½“ç³»é‡Œï¼Œä¼˜å…ˆä½¿ç”¨ <code>DialogTitle</code> / <code>DialogDescription</code> è®© Radix è´Ÿè´£å…³è”æ›´ç¨³ã€‚</p>
<hr/>
<h2 data-id="heading-14">7. çœŸæ­£çš„â€œå‘ç‚¹æ¸…å•â€ï¼ˆå»ºè®®ä»¥å review çš„æ—¶å€™å¯¹ç…§ï¼‰</h2>
<ul>
<li>åªå†™äº† <code>&lt;DialogContent /&gt;</code>ï¼ŒæŠŠæ ‡é¢˜/æ­£æ–‡éƒ½å¡è¿›æ™®é€š <code>div</code></li>
<li>æ ‡é¢˜ç”¨è§†è§‰å…ƒç´ è¡¨è¾¾ï¼ˆæ¯”å¦‚ logo æˆ–å¤§å·æ–‡æœ¬ï¼‰ï¼Œä½†æ²¡ç”¨ <code>DialogTitle</code></li>
<li>æè¿°æ˜¯æ¡ä»¶æ¸²æŸ“çš„ï¼Œå¯¼è‡´æœ‰æ—¶æ²¡æœ‰ <code>DialogDescription</code></li>
<li>æƒ³éšè—æ ‡é¢˜å´ç›´æ¥ä¸å†™ï¼ˆåº”è¯¥éšè—è€Œä¸æ˜¯åˆ é™¤ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-15">8. coco-app é‡Œçš„è½åœ°å®è·µï¼ˆæœ€ç»ˆç»“è®ºï¼‰</h2>
<p>åœ¨ coco-app é‡Œï¼Œæˆ‘ä»¬æœ€ç»ˆéµå¾ªäº†ä¸€ä¸ªç®€å•è§„åˆ™ï¼š</p>
<ul>
<li>æ¯ä¸ª <code>DialogContent</code> å†…éƒ¨éƒ½åº”è¯¥æœ‰ä¸”åªæœ‰ä¸€ä¸ªè¯­ä¹‰æ ‡é¢˜ï¼š<code>DialogTitle</code></li>
<li>åªè¦å¼¹çª—æœ‰ â€œè¯´æ˜æ€§æ–‡æœ¬â€ï¼Œä¼˜å…ˆç”¨ <code>DialogDescription</code> æ‰¿è½½</li>
<li>å¦‚æœ UI ä¸éœ€è¦å±•ç¤ºæ ‡é¢˜/æè¿°ï¼šç”¨ <code>sr-only</code> éšè—ï¼ˆè€Œä¸æ˜¯ä¸å†™ï¼‰</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨ React é‡Œä¼˜é›…åœ° â€œéšè— iframe æ»šåŠ¨æ¡â€]]></title>    <link>https://juejin.cn/post/7587961565477224502</link>    <guid>https://juejin.cn/post/7587961565477224502</guid>    <pubDate>2025-12-26T09:27:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587961565477224502" data-draft-id="7587998744294146054" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨ React é‡Œä¼˜é›…åœ° â€œéšè— iframe æ»šåŠ¨æ¡â€"/> <meta itemprop="keywords" content="å‰ç«¯,React.js,CSS"/> <meta itemprop="datePublished" content="2025-12-26T09:27:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨å¤œå¯»æ™´å¤©"/> <meta itemprop="url" content="https://juejin.cn/user/1943592288391496"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨ React é‡Œä¼˜é›…åœ° â€œéšè— iframe æ»šåŠ¨æ¡â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1943592288391496/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨å¤œå¯»æ™´å¤©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T09:27:30.000Z" title="Fri Dec 26 2025 09:27:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‰ç«¯æœ‰ä¸€ä¸ªç»å…¸é—®é¢˜ï¼š</p>
<blockquote>
<p>ä½ åœ¨å®¿ä¸»é¡µé¢æ€ä¹ˆå†™ CSSï¼Œéƒ½<strong>ç®¡ä¸åˆ° iframe å†…éƒ¨</strong>çš„æ»šåŠ¨æ¡ã€‚</p>
</blockquote>
<p>æ‰€ä»¥æ­£ç¡®çš„å‰ç«¯æ–¹æ¡ˆä¸æ˜¯ â€œç»™å¤–å±‚å®¹å™¨åŠ  overflowâ€ï¼Œè€Œæ˜¯ï¼š<strong>å°½é‡åœ¨ iframe è‡ªå·±å±‚é¢å…œåº• + åŒæºæ—¶å‘ iframe å†…æ³¨å…¥ CSS</strong>ã€‚</p>
<p>æœ¬æ–‡åªèšç„¦å‰ç«¯å®ç°ï¼Œä¸å±•å¼€å‰åç«¯ä¼ å‚é“¾è·¯ã€‚</p>
<hr/>
<h2 data-id="heading-0">1. ä¸ºä»€ä¹ˆä½ æ˜æ˜è®¾ç½®äº†ï¼Œæ»šåŠ¨æ¡è¿˜æ˜¯åœ¨ï¼Ÿ</h2>
<p>å› ä¸ºæ»šåŠ¨æ¡æ¥è‡ª <strong>iframe å†…éƒ¨ document</strong>ï¼š</p>
<ul>
<li>å¤–å±‚ <code>div</code> çš„ <code>overflow-hidden</code> åªèƒ½è£å‰ª â€œiframe è¿™ä¸ªç›’å­â€ æ˜¯å¦æº¢å‡º</li>
<li>iframe é‡Œé¢çš„é¡µé¢æ˜¯å¦å‡ºç°æ»šåŠ¨æ¡ï¼Œå–å†³äº iframe å†…éƒ¨çš„ <code>html/body</code> æˆ–æŸä¸ªå®¹å™¨çš„ <code>overflow</code></li>
<li>å®¿ä¸»é¡µé¢çš„ CSS ä¸ä¼šè·¨ document ç”Ÿæ•ˆï¼ˆiframe å¤©ç”Ÿéš”ç¦»ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-1">2. æˆ‘ä»¬æœ€ç»ˆç”¨äº† â€œä¸¤å±‚æ–¹æ¡ˆâ€ï¼Œè§£å†³ç°å®ä¸–ç•Œçš„ä¸ç¡®å®šæ€§</h2>
<p>å®ç°é›†ä¸­åœ¨ <code>src/components/Search/ViewExtensionIframe.tsx:1-88</code>ã€‚</p>
<h3 data-id="heading-2">2.1 ç¬¬ä¸€å±‚ï¼š<code>scrolling="no"</code> ä½œä¸ºä½æˆæœ¬å…œåº•</h3>
<pre><code class="hljs language-tsx" lang="tsx">&lt;iframe scrolling={hideScrollbar ? <span class="hljs-string">"no"</span> : <span class="hljs-string">"auto"</span>} /&gt;
</code></pre>
<p>å®ƒä¸æ˜¯ç°ä»£æ ‡å‡†ï¼Œä½†åœ¨æŸäº› WebView/åµŒå…¥ç¯å¢ƒé‡Œä»èƒ½å‡å°‘æ»šåŠ¨æ¡å‡ºç°çš„æ¦‚ç‡ã€‚</p>
<p>å®ƒçš„ä»·å€¼åœ¨äºï¼š<strong>ä¸ä¾èµ–åŒæº</strong>ï¼Œå“ªæ€•ä½ è¿›ä¸å» iframeï¼Œä¹Ÿèƒ½ â€œç¢°ä¸€ç¢°è¿æ°”â€ã€‚</p>
<h3 data-id="heading-3">2.2 ç¬¬äºŒå±‚ï¼ˆä¸»åŠ›ï¼‰ï¼šåŒæºæ—¶æ³¨å…¥ä¸€æ®µéšè—æ»šåŠ¨æ¡çš„ CSS</h3>
<p>æ ¸å¿ƒæ˜¯è¿™æ®µé€»è¾‘ï¼ˆåŒæ–‡ä»¶ <code>applyHideScrollbarToIframe</code>ï¼‰ï¼š</p>
<ul>
<li><code>src/components/Search/ViewExtensionIframe.tsx:5-39</code></li>
</ul>
<p>åšæ³•å¾ˆç›´æ¥ï¼š</p>
<ol>
<li>æ‹¿åˆ° <code>iframe.contentDocument</code></li>
<li>å¾€é‡Œé¢å¡ä¸€ä¸ªå¸¦å›ºå®š <code>id</code> çš„ <code>&lt;style&gt;</code></li>
<li>å¼€å…³å…³é—­æ—¶æŠŠè¿™ä¸ª <code>&lt;style&gt;</code> åˆ æ‰</li>
</ol>
<p>æ³¨å…¥çš„ CSS åŒæ—¶è¦†ç›–ä¸»æµå¼•æ“ï¼š</p>
<pre><code class="hljs language-css" lang="css">* {
  <span class="hljs-attribute">scrollbar-width</span>: none;      <span class="hljs-comment">/* Firefox */</span>
  -ms-<span class="hljs-attribute">overflow</span>-style: none;   <span class="hljs-comment">/* è€ IE/Edge é£æ ¼ */</span>
}
*::-webkit-scrollbar {        <span class="hljs-comment">/* Chrome/Safari */</span>
  <span class="hljs-attribute">width</span>: <span class="hljs-number">0px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">0px</span>;
}
</code></pre>
<p>ä¸ºä»€ä¹ˆç”¨ <code>*</code>ï¼Ÿ</p>
<ul>
<li>æ‰©å±•é¡µé¢çš„æ»šåŠ¨å®¹å™¨ä¸ä¸€å®šæ˜¯ <code>body</code>ï¼Œå¯èƒ½æ˜¯ä»»æ„ <code>div overflow-auto</code></li>
<li>ç”¨ <code>*</code> èƒ½æœ€å¤§æ¦‚ç‡â€œå…¨åœºéšè—â€ï¼Œæ›´é€šç”¨</li>
</ul>
<p>ä¸ºä»€ä¹ˆè¦å›ºå®š <code>id</code>ï¼Ÿ</p>
<ul>
<li>é˜²æ­¢é‡å¤æ³¨å…¥ï¼ˆå¤šæ¬¡ onLoad / çŠ¶æ€å˜åŒ–ï¼‰</li>
<li>å…³é—­æ—¶èƒ½ç²¾ç¡®ç§»é™¤ï¼Œä¿è¯å¯é€†</li>
</ul>
<hr/>
<h2 data-id="heading-4">3. ä¸ºä»€ä¹ˆè¦ â€œonLoad + useEffectâ€ åŒè§¦å‘ï¼Ÿ</h2>
<p>è¿™æ˜¯æœ€å®¹æ˜“æ¼ã€ä¹Ÿæœ€å½±å“ä½“éªŒçš„ä¸€ç‚¹ã€‚</p>
<ul>
<li><code>useEffect</code>ï¼šå“åº” <code>hideScrollbar</code> å˜åŒ–ï¼ˆå¼€å…³åˆ‡æ¢æ—¶ç«‹åˆ»ç”Ÿæ•ˆï¼‰</li>
<li><code>onLoad</code>ï¼šä¿è¯â€œé¦–æ¬¡åŠ è½½å®Œæˆåä¸€å®šæ³¨å…¥æˆåŠŸâ€</li>
</ul>
<p>åŸå› ï¼šiframe çš„åŠ è½½æ—¶åºä¸å¯æ§ã€‚ä½ åœ¨ React æ¸²æŸ“å®Œæ—¶ï¼Œiframe å¯èƒ½è¿˜æ²¡ readyï¼Œ<code>contentDocument</code> ä¸ºç©ºï¼›ç­‰åˆ° onLoad æ‰èƒ½ 100% ç¡®è®¤ document å­˜åœ¨ã€‚</p>
<p>å¯¹åº”ä»£ç ï¼š</p>
<ul>
<li><code>src/components/Search/ViewExtensionIframe.tsx:52-55</code></li>
<li><code>src/components/Search/ViewExtensionIframe.tsx:78-84</code></li>
</ul>
<hr/>
<h2 data-id="heading-5">4. è¿™ä¸ªæ–¹æ¡ˆçš„è¾¹ç•Œä¸å‘ï¼ˆæå‰å†™æ¸…æ¥šï¼Œåé¢å°‘æ‰å¤´å‘ï¼‰</h2>
<h3 data-id="heading-6">4.1 â€œéšè—æ»šåŠ¨æ¡â€ ä¸ç­‰äº â€œä¸èƒ½æ»šâ€</h3>
<p>æˆ‘ä»¬åªéšè— scrollbar çš„è§†è§‰è¡¨ç°ï¼Œæ»šåŠ¨è¡Œä¸ºä»å­˜åœ¨ï¼ˆæ»šè½®/è§¦æ‘¸æ¿/é”®ç›˜éƒ½èƒ½æ»šï¼‰ã€‚<br/>
è¿™åœ¨æ²‰æµ¸å¼é¡µé¢å¾ˆèˆ’æœï¼Œä½†åœ¨é•¿é¡µé¢é‡Œä¹Ÿå¯èƒ½è®©ç”¨æˆ·ä¸çŸ¥é“ â€œè¿˜èƒ½æ»šâ€ã€‚</p>
<h3 data-id="heading-7">4.2 è·¨åŸŸ iframeï¼šæ³¨å…¥ä¼šå¤±è´¥ï¼Œä½†ä¸ä¼šç‚¸</h3>
<p>å¦‚æœ iframe åŠ è½½è·¨åŸŸé¡µé¢ï¼Œè®¿é—® <code>contentDocument</code> ä¼šè§¦å‘åŒæºé™åˆ¶ã€‚å½“å‰å®ç°ç”¨ <code>try/catch</code> é™é»˜åæ‰å¼‚å¸¸ï¼Œç»“æœæ˜¯ï¼š</p>
<ul>
<li>CSS æ³¨å…¥å¤±è´¥</li>
<li>åªå‰© <code>scrolling="no"</code> å…œåº•ï¼Œæ•ˆæœä¸ä¿è¯</li>
</ul>
<p>è¿™ä¸æ˜¯ bugï¼Œæ˜¯æµè§ˆå™¨å®‰å…¨æ¨¡å‹å†³å®šçš„ã€‚</p>
<h3 data-id="heading-8">4.3 å…¨å±€ <code>*</code> çš„å‰¯ä½œç”¨</h3>
<p>å®ƒä¼šæŠŠ iframe å†…æ‰€æœ‰æ»šåŠ¨æ¡éƒ½å¹²æ‰ï¼ŒåŒ…æ‹¬æŸäº›ç»„ä»¶å†…éƒ¨æ»šåŠ¨åŒºåŸŸã€ä»£ç å—æ»šåŠ¨ç­‰ã€‚<br/>
ç›®å‰æˆ‘ä»¬é€‰æ‹©â€œé€šç”¨æ€§ä¼˜å…ˆâ€ï¼Œä½†å¦‚æœæœªæ¥æŸäº›æ‰©å±•éœ€è¦ä¿ç•™å±€éƒ¨æ»šåŠ¨æ¡ï¼Œå°±è¦æ”¹ä¸ºæ›´ç²¾ç¡®çš„é€‰æ‹©å™¨ç­–ç•¥ã€‚</p>
<hr/>
<h2 data-id="heading-9">5. ä¸€å¥è¯æ€»ç»“</h2>
<p>åœ¨å‰ç«¯æƒ³ç¨³å®šæ§åˆ¶ iframe æ»šåŠ¨æ¡ï¼Œæœ€é è°±çš„æ€è·¯æ˜¯ï¼š</p>
<ul>
<li><strong>å…ˆç”¨ iframe è‡ªèº«å±æ€§åšå…œåº•</strong></li>
<li><strong>å†åœ¨åŒæºæ¡ä»¶ä¸‹å¯¹ iframe å†…éƒ¨ document æ³¨å…¥ CSS</strong></li>
<li><strong>ç”¨å›ºå®š style id ä¿è¯å¹‚ç­‰ä¸å¯é€†</strong></li>
<li><strong>ç”¨ onLoad + effect è§£å†³æ—¶åºé—®é¢˜</strong></li>
</ul>
<p>è¿™å°±æ˜¯ <code>hideScrollbar</code> åœ¨å‰ç«¯çœŸæ­£è§£å†³çš„é—®é¢˜ï¼šä¸æ˜¯å†™æ²¡å†™ CSSï¼Œè€Œæ˜¯æœ‰æ²¡æœ‰æŠŠ CSS å†™åˆ°â€œå¯¹çš„ä¸–ç•Œé‡Œâ€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆä¼ä¸šéƒ½éœ€è¦èŒåœºå¿ƒç†å­¦åˆ†æä¸“å®¶ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7588004601393037346</link>    <guid>https://juejin.cn/post/7588004601393037346</guid>    <pubDate>2025-12-27T08:12:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588004601393037346" data-draft-id="7588004376867569699" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆä¼ä¸šéƒ½éœ€è¦èŒåœºå¿ƒç†å­¦åˆ†æä¸“å®¶ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-27T08:12:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LucianaiB"/> <meta itemprop="url" content="https://juejin.cn/user/1269294586664749"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆä¼ä¸šéƒ½éœ€è¦èŒåœºå¿ƒç†å­¦åˆ†æä¸“å®¶ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1269294586664749/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LucianaiB
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T08:12:28.000Z" title="Sat Dec 27 2025 08:12:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸ºä»€ä¹ˆä¼ä¸šéƒ½éœ€è¦èŒåœºå¿ƒç†å­¦åˆ†æä¸“å®¶ï¼Ÿ</h2>
<p>åœ¨å¿«èŠ‚å¥ã€é«˜å‹åŠ›çš„ç°ä»£èŒåœºç¯å¢ƒä¸­ï¼Œå‘˜å·¥çš„è¡Œä¸ºè¡¨ç°å¾€å¾€ä¸ä»…ä»…æ˜¯è¡¨é¢ç°è±¡ï¼ŒèƒŒåéšè—ç€å¤æ‚çš„å¿ƒç†åŠ¨å› ã€‚è¿™äº›åŠ¨å› å¦‚æœå¾—ä¸åˆ°ç§‘å­¦è¯†åˆ«ä¸æœ‰æ•ˆå¹²é¢„ï¼Œææ˜“æ¼”å˜ä¸ºæ²Ÿé€šéšœç¢ã€åä½œä½æ•ˆï¼Œç”šè‡³å¼•å‘ç»„ç»‡å†…éƒ¨çš„å£«æ°”å±æœºã€‚å› æ­¤ï¼Œè¶Šæ¥è¶Šå¤šçš„ä¼ä¸šæ„è¯†åˆ°ï¼Œå°†å¿ƒç†å­¦ç³»ç»Ÿæ€§åœ°å¼•å…¥ç®¡ç†å®è·µï¼Œä¸ä»…æ˜¯ä¸€ç§â€œæŸ”æ€§ç®¡ç†â€æ‰‹æ®µï¼Œæ›´æ˜¯ä¸€é¡¹èƒ½å¤Ÿæå‡ç»„ç»‡æ•ˆèƒ½ä¸äººæ‰ä¿ç•™ç‡çš„æˆ˜ç•¥æŠ•èµ„ã€‚</p>
<p>æ­£æ˜¯åŸºäºè¿™ä¸€æ´å¯Ÿï¼Œæˆ‘åˆ©ç”¨ <strong>è…¾è®¯å…ƒå™¨ï¼ˆYuanQiï¼‰</strong> å¹³å°ï¼Œæ„å»ºäº†ä¸€æ¬¾é¢å‘ä¼ä¸šåŠå…¬åœºæ™¯çš„å®ç”¨å‹ AI æ™ºèƒ½ä½“â€”â€”ã€ŒèŒåœºå¿ƒç†å­¦åˆ†æä¸“å®¶ã€ã€‚å®ƒèšç„¦äºè§£å†³ä¼ä¸šç®¡ç†ä¸­ä¸‰å¤§é«˜é¢‘ç—›ç‚¹ï¼š<strong>çœ‹ä¸æ‡‚å‘˜å·¥è¡Œä¸ºã€æ²Ÿé€šæ•ˆç‡ä½ä¸‹ã€å›¢é˜Ÿå£«æ°”ä½è¿·</strong>ï¼Œå°†å¿ƒç†å­¦ç†è®ºè½¬åŒ–ä¸ºå¯è½åœ°çš„ç®¡ç†å·¥å…·ã€‚</p>
<blockquote>
<p><strong>âœ¨ ç›®æ ‡ï¼šè®©å¿ƒç†å­¦æˆä¸ºä¼ä¸šç®¡ç†çš„â€œéšå½¢æ æ†â€</strong></p>
</blockquote>
<h2 data-id="heading-1">ğŸ§ æˆ‘ç”¨è…¾è®¯å…ƒå™¨æ‰“é€ çš„å¿ƒç†å­¦åˆ†æä¸“å®¶æ•ˆæœé¢„è§ˆ</h2>
<p>ç‚¹å‡»é“¾æ¥å³åˆ»ä½“éªŒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fyuanqi.tencent.com%2Fwebim%2F%23%2Fchat%2FJoAncj%3Fappid%3D2004808954860119296%26experience%3Dtrue" target="_blank" title="https://yuanqi.tencent.com/webim/#/chat/JoAncj?appid=2004808954860119296&amp;experience=true" ref="nofollow noopener noreferrer">yuanqi.tencent.com/webim/#/chaâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d858aa818aa48f48b95c8b58f878534~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=vEI2PIKDvXKuJ%2F640Grp9yhUbgQ%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>è¯¥æ™ºèƒ½ä½“èåˆå¿ƒç†å­¦ä¸ç¤¾ä¼šå­¦ç†è®ºï¼Œé€šè¿‡ç»“æ„åŒ–åˆ†ææ¡†æ¶ï¼Œå¸®åŠ© HRã€ç®¡ç†è€…ç”šè‡³æ™®é€šå‘˜å·¥ï¼Œç§‘å­¦è§£æèŒåœºè¡Œä¸ºèƒŒåçš„æ·±å±‚åŸå› ï¼Œå¹¶æä¾›å¯æ“ä½œçš„ç®¡ç†å»ºè®®ã€‚å…¶ç›®æ ‡ä¸ä»…æ˜¯â€œè§£é‡Šé—®é¢˜â€ï¼Œæ›´æ˜¯â€œæ¨åŠ¨æ”¹å˜â€ã€‚</p>
<h3 data-id="heading-2">èŒåœºè¡Œä¸ºåˆ†æ</h3>
<p>å¯ä»¥ç›´æ¥ç”¨é¢„è®¾çš„é—®é¢˜æ¥ä½“éªŒï¼Œå¯ä»¥çœ‹åˆ°æˆåŠŸçš„å›å¤äº†æˆ‘ä»¬<code>å‘˜å·¥é¢‘ç¹è¿Ÿåˆ°çš„å¯èƒ½åŸå› </code>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/864e52c98b564ba38489caa5aef043c1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=QcNIOZowVu8%2F5ANbQyy7k0Xbc6E%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-3">èŒä¸šå‘å±•</h3>
<p>å½“æˆ‘ä»¬ä¸çŸ¥é“èŒä¸šå‘å±•çš„æ—¶å€™ä»–å¯ä»¥ç”¨å·¥ä½œæµæ¥å›å¤æˆ‘ä»¬å‘å±•çš„æ–¹å‘ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d7cbf9bd73e46c9acd4ceb1687b1751~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=QGtj%2FX%2B71MIpxcxdi4Fs%2BIK5xL4%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-4">æ™ºèƒ½ä½“èƒ½åšä»€ä¹ˆï¼Ÿ</h3>
<p>è¿™æ¬¾ Agent èšç„¦ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ›ï¼š</p>
<p>âœ… èŒåœºè¡Œä¸ºåˆ†æï¼šä»è¿Ÿåˆ°ã€æ²‰é»˜ã€è¿‡åº¦åŠ ç­ç­‰è¡Œä¸ºä¸­æŒ–æ˜æ½œåœ¨åŠ¨æœº</p>
<p>âœ… å¾®è¡¨æƒ…ä¸éè¯­è¨€ä¿¡å·è§£è¯»ï¼šè¾…åŠ©è¯†åˆ«ä¼šè®®/è°ˆåˆ¤ä¸­çš„çœŸå®æƒ…ç»ªçŠ¶æ€</p>
<p>âœ… åŸºäºå¿ƒç†å­¦ä¸ç¤¾ä¼šå­¦ç†è®ºçš„ç»“æ„åŒ–è¾“å‡ºï¼šæä¾›å¯æ“ä½œçš„ç®¡ç†å»ºè®®</p>
<p>æ— è®ºä½ æ˜¯ HRã€å›¢é˜Ÿç®¡ç†è€…ï¼Œè¿˜æ˜¯æ™®é€šèŒåœºäººï¼Œéƒ½èƒ½å€ŸåŠ©å®ƒæ›´ç§‘å­¦åœ°ç†è§£ä»–äººã€ä¼˜åŒ–æ²Ÿé€šã€è¥é€ å¥åº·èŒåœºç”Ÿæ€ã€‚</p>
<h2 data-id="heading-5">ç›¸å…³ä»‹ç»</h2>
<h3 data-id="heading-6">è…¾è®¯å…ƒå™¨</h3>
<p>è…¾è®¯å…ƒå™¨æ˜¯è…¾è®¯æ¨å‡ºçš„ä¸€ç«™å¼ <strong>AI æ™ºèƒ½ä½“ï¼ˆAgentï¼‰å¼€å‘ä¸åˆ†å‘å¹³å°</strong>ï¼Œæ—¨åœ¨é™ä½å¤§æ¨¡å‹åº”ç”¨çš„å¼€å‘é—¨æ§›ï¼Œè®©ä¼ä¸šã€å¼€å‘è€…ç”šè‡³éæŠ€æœ¯äººå‘˜éƒ½èƒ½å¿«é€Ÿæ„å»ºã€éƒ¨ç½²å’Œè¿è¥ä¸“å±æ™ºèƒ½ä½“ã€‚å¹³å°æ·±åº¦é›†æˆè…¾è®¯æ··å…ƒå¤§æ¨¡å‹èƒ½åŠ›ï¼Œå¹¶æ”¯æŒå¤šç§ä¸»æµå¼€æºæ¨¡å‹ï¼ˆå¦‚ DeepSeekã€Llama ç³»åˆ—ç­‰ï¼‰ï¼Œé€šè¿‡â€œæç¤ºè¯ + çŸ¥è¯†åº“ + å·¥ä½œæµâ€çš„ç»„åˆæ–¹å¼ï¼Œèµ‹äºˆæ™ºèƒ½ä½“å‚ç›´é¢†åŸŸä¸“ä¸šèƒ½åŠ›ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/07e6bbfaaad645f9b3b819cdc63df776~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=tOwum1IVti0bx35%2FQyS9W%2BEaXCI%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-7">ç³»ç»Ÿé€»è¾‘æ¶æ„</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/89d87147c9bb4fbd9b36e0d1bb815798~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=rRMvKh2oH7fs4eHPuyK6t4ZNqXA%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-8">æ‰‹æŠŠæ‰‹æ•™ç¨‹ï¼ˆå…¨ç½‘æœ€è¯¦ç»†æ•™ç¨‹ï¼‰</h2>
<h3 data-id="heading-9">æ‰‹æŠŠæ‰‹æ•™ç¨‹æ€»è§ˆ</h3>
<p>æ•´ä½“æµç¨‹å¯ä»¥æ‹†æˆäº”æ­¥ï¼š</p>
<ol>
<li>æ‰“å¼€è…¾è®¯å…ƒå™¨å¹¶æ–°å»ºæ™ºèƒ½ä½“</li>
<li>å®ŒæˆåŸºç¡€é…ç½®ï¼šæ¨¡å‹ã€æç¤ºè¯ã€æ¬¢è¿è¯­ã€å¼€åœºé—®é¢˜ç­‰</li>
<li>æµ‹è¯•åŸºç¡€ç‰ˆèŒåœºå¿ƒç†å­¦åˆ†æä¸“å®¶</li>
<li>æ­å»ºè¿›é˜¶å·¥ä½œæµï¼šå¾…å®š</li>
<li>å‘å¸ƒåˆ°å„å¹³å°ï¼Œä½œä¸ºé•¿æœŸå¯ç”¨çš„èŒåœºå¿ƒç†å­¦åˆ†æä¸“å®¶ Agent</li>
</ol>
<h3 data-id="heading-10">1.æ‰“å¼€è…¾è®¯å…ƒå™¨</h3>
<p>ç‚¹å‡»ç½‘ç«™ç›´è¾¾åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fyuanqi.tencent.com%2F" target="_blank" title="https://yuanqi.tencent.com/" ref="nofollow noopener noreferrer">yuanqi.tencent.com/</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/654c914a77864e748f1f9a89f676cf34~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=WJIaWdLtAQ4pvmuN%2FyjGSg%2B8Tgc%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-11">2.æ–°å»ºèŒåœºå¿ƒç†å­¦åˆ†æä¸“å®¶æ™ºèƒ½ä½“</h3>
<p>åœ¨è…¾è®¯å…ƒå™¨æ”¯æŒä¸¤ç§ç±»å‹çš„æ™ºèƒ½ä½“ï¼š</p>
<p><strong>å…¬ä¼—å·**</strong>æ™ºèƒ½ä½“**ï¼šæ”¯æŒä¾¿æ·æ‹‰å–å…¬ä¼—å·æ–‡ç« æ„å»ºçŸ¥è¯†åº“ï¼Œä¸€é”®å‘å¸ƒåˆ°å…¬ä¼—å·åå°ï¼Œå®ç°æ™ºèƒ½å›å¤åŠŸèƒ½ã€‚</p>
<p><strong>å¯¹è¯å¼**</strong>æ™ºèƒ½ä½“**ï¼šæ”¯æŒçµæ´»æ„å»ºé€šç”¨çŸ¥è¯†åº“å’Œå·¥ä½œæµï¼Œå¯å‘å¸ƒåˆ°å¤šä¸ªæ¸ é“è¿›è¡Œå¯¹è¯äº’åŠ¨ã€‚</p>
<p>å¦‚æœå¯¹<strong>å…¬ä¼—å·æ™ºèƒ½ä½“</strong>æ„Ÿå…´è¶£çš„å¯ä»¥çœ‹æˆ‘çš„ä¸Šä¸€ç¯‡æ–‡ç« ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fcloud.tencent.com%2Fdeveloper%2Farticle%2F2600684" target="_blank" title="https://cloud.tencent.com/developer/article/2600684" ref="nofollow noopener noreferrer">cloud.tencent.com/developer/aâ€¦</a>ï¼‰ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3ef76bfa20d24c6fb2e7bd3ca753bf0a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=LTc2wg4CfyQSWSesi2oycRAWckE%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>è¾“å…¥æ™ºèƒ½ä½“çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¦‚ï¼šåç§°ï¼Œç®€ä»‹ï¼Œä»¥åŠå¤´åƒã€‚</p>
<p>æˆ‘çš„ä»…ä¾›å‚è€ƒï¼š</p>
<blockquote>
<p>åç§°ï¼šèŒåœºå¿ƒç†å­¦åˆ†æä¸“å®¶
ç®€ä»‹ï¼šèŒåœºå¿ƒç†å­¦åˆ†æä¸“å®¶ä¸“æ³¨äºè§£æèŒåœºä¸­ä¸ªä½“è¡Œä¸ºèƒŒåçš„æ½œåœ¨å¿ƒç†åŠ¨æœºï¼Œå¸®åŠ©ç†è§£å‘˜å·¥å’ŒåŒäº‹çš„è¡Œä¸ºæ¨¡å¼ã€‚è¯¥Agentç»“åˆå¿ƒç†å­¦ä¸ç¤¾ä¼šå­¦ç†è®ºï¼Œè¿ç”¨è¡Œä¸ºæ¦‚æ‹¬ã€åŠ¨æœºåˆ†æå’Œå¾®è¡¨æƒ…è¯†åˆ«ç­‰ä¸“ä¸šæŠ€èƒ½ï¼Œæ·±å…¥å‰–æèŒåœºè¡Œä¸ºèƒŒåçš„å¤šé‡å¿ƒç†å› ç´ ã€‚é€‚ç”¨äºHRã€ç®¡ç†è€…åŠèŒåœºäººå£«ï¼Œç”¨äºæå‡å›¢é˜Ÿç®¡ç†ã€ä¼˜åŒ–æ²Ÿé€šå’Œä¿ƒè¿›èŒåœºæ°›å›´å¥åº·ã€‚
å¤´åƒï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/102d31bb220e4d81869c9ae1ed574992~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=STVomSVTQaqOHCXJc73%2FIh%2B9Tlk%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
</blockquote>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç‚¹å‡»æ–°å»ºå³å¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b216f7b6c3314e30b1e80c3e9748e6bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=LRcGRzKSQxcISOcUzByxlts6LR8%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-12">3.åŸºç¡€é…ç½®ç¤ºä¾‹ï¼š=</h3>
<p>åœ¨å³ä¾§è¿›è¡Œä¸€äº›åŸºç¡€çš„é…ç½®ï¼Œå¦‚æ¨¡å‹è®¾ç½®ï¼Œæç¤ºè¯ï¼Œæ¬¢è¿è¯­ï¼ŒçŸ¥è¯†åº“ç­‰ã€‚</p>
<p>æˆ‘è¿™é‡Œçš„å…·ä½“æ¨¡å‹è®¾ç½®ï¼šDeepSeek-V3.2</p>
<p>æç¤ºè¯ï¼š</p>
<pre><code class="hljs language-md" lang="md">è¯·æ‰®æ¼”èŒåœºå¿ƒç†å­¦åˆ†æä¸“å®¶ï¼Œåˆ†æèŒåœºä¸­äººä»¬è¡Œä¸ºèƒŒåçš„æ½œåœ¨å¿ƒç†åŠ¨æœºã€‚

<span class="hljs-bullet">-</span> åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸è¦è„±ç¦»è§’è‰²ã€‚
<span class="hljs-bullet">-</span> ä¸è¦èƒ¡è¯´å…«é“æˆ–ç¼–é€ äº‹å®ã€‚

<span class="hljs-section">## æ¦‚å†µï¼š</span>

<span class="hljs-bullet">-</span> è¯­è¨€ï¼šä¸­æ–‡
<span class="hljs-bullet">-</span> æè¿°ï¼šä½ æ˜¯ä¸€ä¸ªå¿ƒç†å­¦ä¸“å®¶ï¼Œç”¨æ¥åˆ†æèŒåœºä¸­äººä»¬è¡Œä¸ºèƒŒåçš„æ½œåœ¨å¿ƒç†åŠ¨æœºï¼Œå¯èƒ½çš„å¿ƒç†åŠ¨æœºåˆ†æ

<span class="hljs-section">## æŠ€èƒ½</span>

<span class="hljs-bullet">1.</span> èŒåœºè¡Œä¸ºåˆ†æ
<span class="hljs-bullet">2.</span> å¾®è¡¨æƒ…è¯†åˆ«
<span class="hljs-bullet">3.</span> å…¶ä»–æœ‰åŠ©äºåˆ†æèŒåœºå¿ƒç†çŠ¶æ€çš„å¿ƒç†å­¦ã€ç¤¾ä¼šå­¦æŠ€èƒ½

<span class="hljs-section"># æ­¥éª¤</span>

<span class="hljs-bullet">1.</span> <span class="hljs-strong">**è¡Œä¸ºæ¦‚æ‹¬**</span>ï¼šæ€»ç»“éœ€è¦åˆ†æçš„èŒåœºè¡Œä¸ºã€‚
<span class="hljs-bullet">2.</span> <span class="hljs-strong">**åŠ¨æœºåˆ†æ**</span>ï¼šå¯¹äºæ¦‚æ‹¬å‡ºçš„è¡Œä¸ºï¼Œæä¾›è‡³å°‘ä¸‰ä¸ªå¯èƒ½çš„å¿ƒç†åŠ¨æœºã€‚
<span class="hljs-bullet">    -</span> æ¯ä¸ªåŠ¨æœºåŒ…å«ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†:
<span class="hljs-bullet">        -</span> <span class="hljs-strong">**è§£é‡Š**</span>ï¼šæè¿°è¿™ä¸ªåŠ¨æœºçš„åŸºæœ¬æƒ…å†µã€‚
<span class="hljs-bullet">        -</span> <span class="hljs-strong">**å¯èƒ½çš„åŸå› **</span>ï¼šè§£é‡Šä¸ºä»€ä¹ˆè¿™ä¸ªåŠ¨æœºå¯èƒ½æ˜¯è¡Œä¸ºèƒŒåçš„åŸå› ã€‚
<span class="hljs-bullet">        -</span> <span class="hljs-strong">**æ½œåœ¨å½±å“**</span>ï¼šè¯´æ˜è¿™ä¸ªåŠ¨æœºå¯¹ä¸ªä½“æˆ–èŒåœºç¯å¢ƒå¯èƒ½äº§ç”Ÿçš„å½±å“ã€‚

<span class="hljs-section"># è¾“å‡ºæ ¼å¼</span>

è¯·åœ¨ä»£ç å—ä¸­è¾“å‡ºç»“æœï¼Œç»“æ„å¦‚ä¸‹ï¼š

è¡Œä¸ºæ¦‚æ‹¬

åŠ¨æœº 1

è§£é‡Š:

å¯èƒ½çš„åŸå› :

æ½œåœ¨å½±å“:

åŠ¨æœº 2

è§£é‡Š:

å¯èƒ½çš„åŸå› :

æ½œåœ¨å½±å“:

åŠ¨æœº 3

è§£é‡Š:

å¯èƒ½çš„åŸå› :

æ½œåœ¨å½±å“:

<span class="hljs-section"># ç¤ºä¾‹</span>

è¡Œä¸ºæ¦‚æ‹¬

æŸå‘˜å·¥é¢‘ç¹åŠ ç­ï¼Œç”šè‡³åœ¨å‘¨æœ«ä¹Ÿåœ¨å¤„ç†å·¥ä½œã€‚

åŠ¨æœº 1

è§£é‡Š: è¯¥å‘˜å·¥å¸Œæœ›åœ¨çŸ­æ—¶é—´å†…æå‡ä¸šç»©ã€‚

å¯èƒ½çš„åŸå› : å¯èƒ½æ˜¯ä¸ºäº†ç»™ä¸Šçº§ç•™ä¸‹å¥½å°è±¡ï¼Œäº‰å–å‡èŒæˆ–åŠ è–ªçš„æœºä¼šã€‚

æ½œåœ¨å½±å“: é•¿æœŸåŠ ç­å¯èƒ½å¯¼è‡´å‘˜å·¥èº«å¿ƒç–²æƒ«ï¼Œä»è€Œå½±å“å·¥ä½œæ•ˆç‡å’Œå¥åº·ã€‚

åŠ¨æœº 2

è§£é‡Š: è¯¥å‘˜å·¥å¯¹å·¥ä½œæœ‰è¾ƒå¼ºçš„è´£ä»»æ„Ÿå’Œæˆå°±æ„Ÿã€‚

å¯èƒ½çš„åŸå› : ä»–å¯èƒ½è®¤ä¸ºå®Œæˆæ›´å¤šçš„å·¥ä½œèƒ½å¸¦æ¥ä¸ªäººæ„ä¹‰å’ŒèŒä¸šæ»¡è¶³æ„Ÿã€‚

æ½œåœ¨å½±å“: è™½ç„¶èƒ½çŸ­æœŸææŒ¯å·¥ä½œç»©æ•ˆï¼Œä½†ä¹Ÿæœ‰å¯èƒ½åŠ å‰§å‘˜å·¥çš„ç–²åŠ³å’Œå€¦æ€ ã€‚

åŠ¨æœº 3

è§£é‡Š: è¯¥å‘˜å·¥ç¼ºä¹æ—¶é—´ç®¡ç†æŠ€èƒ½ï¼Œå¯¼è‡´å·¥ä½œæ—¶é—´å»¶é•¿ã€‚

å¯èƒ½çš„åŸå› : å·¥ä½œæ–¹æ³•ä¸å¤Ÿæœ‰æ•ˆï¼Œå¤§é‡æ—¶é—´è¢«æµªè´¹åœ¨ä½æ•ˆçš„ä»»åŠ¡ä¸Šã€‚

æ½œåœ¨å½±å“: å¦‚æœä¸åŠ ä»¥æ”¹å–„ï¼Œå¯èƒ½ä¼šå½¢æˆæ¶æ€§å¾ªç¯ï¼Œå½±å“é•¿è¿œçš„å·¥ä½œè¡¨ç°å’ŒèŒä¸šå‘å±•ã€‚

<span class="hljs-section"># æ³¨æ„äº‹é¡¹</span>

<span class="hljs-bullet">-</span> å¦¥å–„åˆ†æè¡Œä¸ºåŠ¨æœºï¼Œé¿å…ä¸»è§‚è‡†æ–­ã€‚
<span class="hljs-bullet">-</span> æä¾›çš„è§£é‡Šå’Œåˆ†æéœ€è¦åˆç†ä¸”åŸºäºå¿ƒç†å­¦å’Œç¤¾ä¼šå­¦ç†è®ºã€‚ 
</code></pre>
<p>æ¬¢è¿è¯­:</p>
<pre><code class="hljs language-md" lang="md">æ‚¨å¥½ï¼Œæˆ‘æ˜¯æ‚¨çš„èŒåœºå¿ƒç†å­¦åˆ†æä¸“å®¶ï¼Œä¸“æ³¨äºè§£æèŒåœºè¡Œä¸ºèƒŒåçš„å¿ƒç†åŠ¨æœºã€‚æ— è®ºæ˜¯å›¢é˜Ÿæ²Ÿé€šã€å‘˜å·¥è¡Œä¸ºè¿˜æ˜¯ç®¡ç†éš¾é¢˜ï¼Œæˆ‘éƒ½èƒ½ä¸ºæ‚¨æä¾›ç§‘å­¦ã€ä¸“ä¸šçš„å¿ƒç†åŠ¨æœºåˆ†æï¼ŒåŠ©æ‚¨ä¼˜åŒ–èŒåœºç¯å¢ƒï¼Œæå‡å›¢é˜Ÿæ•ˆèƒ½ã€‚
</code></pre>
<p>å¼€åœºçš„3ä¸ªé—®é¢˜ï¼š</p>
<pre><code class="hljs language-md" lang="md">æŸå‘˜å·¥é¢‘ç¹è¿Ÿåˆ°ï¼Œå¯èƒ½æœ‰å“ªäº›å¿ƒç†åŠ¨æœºï¼Ÿ

å¦‚ä½•åˆ†æåŒäº‹åœ¨ä¼šè®®ä¸­çš„è‚¢ä½“è¯­è¨€ï¼Ÿ

å›¢é˜Ÿæˆå‘˜è¡¨ç°å‡ºæ¶ˆææƒ…ç»ªï¼Œå¯èƒ½çš„å¿ƒç†åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/861fa1e9a81c4538a15310e039611a83~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=3%2B0KfOduddO2LjaCyoC0NTassF0%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>åœ¨å³ä¾§æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥å¯¹è¯äº†ï¼Œå¯ä»¥çœ‹åˆ°ä¸‹å›¾ï¼ŒæˆåŠŸè¾“å‡ºäº†è¡Œä¸ºæ¦‚æ‹¬å’ŒåŠ¨æœºã€‚</p>
<p>åŸºäºæç¤ºè¯ç›´æ¥é—®ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/482611a921b446ac9aeb6604c8b25577~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=AEi7qzI5BwFhsUG3TLe1KAcdS%2BA%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>å‘Šè¯‰ä»–ä¸€ä¸ªä¸€ä¸ªèŒåœºå¿ƒç†é—®é¢˜ï¼š</p>
<blockquote>
<p>æŸå‘˜å·¥é¢‘ç¹è¿Ÿåˆ°ï¼Œå¯èƒ½æœ‰å“ªäº›å¿ƒç†åŠ¨æœºï¼Ÿ</p>
</blockquote>
<p>ä»–ä¼šåŸºäºè¿™ä¸ªâ€œèŒåœºå¿ƒç†å­¦åˆ†æä¸“å®¶â€æ¥åˆ†æé—®é¢˜ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b9f8f8a5a6f487c8bd85b87a2b17475~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=8xSGg8QKBddvvgT6Dfb1J92hJj8%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ä»–ä¼šé€šè¿‡åˆ†æå¹¶å›ç­”ï¼š</p>
<blockquote>
<p>è¡Œä¸ºæ¦‚æ‹¬
æŸå‘˜å·¥é¢‘ç¹è¿Ÿåˆ°ï¼Œç»å¸¸åœ¨ä¸Šç­æ—¶é—´ä¹‹åæ‰åˆ°è¾¾å·¥ä½œå²—ä½ã€‚åŠ¨æœº 1
è§£é‡Š: è¯¥å‘˜å·¥å¯èƒ½å¯¹å·¥ä½œæˆ–å·¥ä½œç¯å¢ƒå­˜åœ¨æ½œåœ¨çš„æŠµè§¦æˆ–ä¸æ»¡æƒ…ç»ªã€‚
å¯èƒ½çš„åŸå› : è¿™ç§æŠµè§¦å¯èƒ½æºäºå¯¹å·¥ä½œå†…å®¹ä¸æ„Ÿå…´è¶£ã€ä¸åŒäº‹æˆ–ä¸Šçº§å…³ç³»ç´§å¼ ã€æ„Ÿåˆ°å·¥ä½œå‹åŠ›è¿‡å¤§æˆ–ç¼ºä¹æˆå°±æ„Ÿã€‚è¿Ÿåˆ°è¡Œä¸ºæˆä¸ºä¸€ç§è¢«åŠ¨çš„ã€éç›´æ¥çš„æŠµæŠ—æ–¹å¼ï¼Œç”¨ä»¥è¡¨è¾¾ä¸æ»¡æˆ–è¯•å›¾é‡æ–°è·å¾—å¯¹å·¥ä½œæ—¶é—´çš„æŸç§æ§åˆ¶æ„Ÿã€‚
æ½œåœ¨å½±å“: é•¿æœŸå¦‚æ­¤ä¼šæŸå®³è¯¥å‘˜å·¥çš„èŒä¸šå½¢è±¡å’Œä¿¡èª‰ï¼Œå¯èƒ½å¯¼è‡´ç»©æ•ˆè¯„ä¼°ä¸ä½³ã€é”™å¤±å‘å±•æœºä¼šï¼Œå¹¶å¯èƒ½åŠ å‰§å…¶ä¸å›¢é˜ŸåŠä¸Šçº§çš„çŸ›ç›¾ï¼Œå½¢æˆè´Ÿé¢å¾ªç¯ã€‚åŠ¨æœº 2
è§£é‡Š: è¯¥å‘˜å·¥å¯èƒ½å­˜åœ¨æ—¶é—´ç®¡ç†èƒ½åŠ›ä¸è¶³æˆ–è‡ªå¾‹æ€§è¾ƒå¼±çš„é—®é¢˜ã€‚
å¯èƒ½çš„åŸå› : è¿™å¯èƒ½ä¸ä¸ªäººçš„ç”Ÿæ´»ä¹ æƒ¯ã€æ‹–å»¶å€¾å‘ã€å¯¹æ—¶é—´é¢„ä¼°è¿‡äºä¹è§‚ï¼Œæˆ–è€…ç¼ºä¹æœ‰æ•ˆçš„ä¼˜å…ˆçº§æ’åºå’Œè®¡åˆ’èƒ½åŠ›æœ‰å…³ã€‚å…¶è¡Œä¸ºèƒŒåå¹¶éå¯¹å·¥ä½œæœ‰å¼ºçƒˆè´Ÿé¢æƒ…ç»ªï¼Œè€Œæ˜¯ä¸ªäººç»„ç»‡æŠ€èƒ½å­˜åœ¨çŸ­æ¿ã€‚
æ½œåœ¨å½±å“: ä¸ä»…å½±å“ä¸ªäººå·¥ä½œæ•ˆç‡å’Œä»»åŠ¡å®Œæˆè´¨é‡ï¼Œä¹Ÿå¯èƒ½ç»™å›¢é˜Ÿåä½œå¸¦æ¥ä¸ä¾¿ï¼ˆå¦‚å»¶è¯¯ä¼šè®®ã€ç­‰å¾…å…¶å¼€å§‹å·¥ä½œç­‰ï¼‰ï¼Œé•¿æœŸä¼šé™åˆ¶å…¶èŒä¸šå‘å±•ï¼Œå¹¶å¯èƒ½è¢«è´´ä¸Šâ€œä¸å¯é â€çš„æ ‡ç­¾ã€‚åŠ¨æœº 3
è§£é‡Š: è¯¥å‘˜å·¥å¯èƒ½é€šè¿‡è¿Ÿåˆ°è¡Œä¸ºæ¥å¯»æ±‚å…³æ³¨æˆ–æµ‹è¯•ç»„ç»‡è§„åˆ™çš„è¾¹ç•Œã€‚
å¯èƒ½çš„åŸå› : è¿™èƒŒåå¯èƒ½éšè—ç€å¯¹è‡ªèº«åœ¨ç»„ç»‡ä¸­åœ°ä½çš„ä¸å®‰å…¨æ„Ÿï¼Œå¸Œæœ›é€šè¿‡â€œç‰¹æ®Šâ€è¡Œä¸ºæ¥ç¡®è®¤ä¸Šçº§æˆ–ç»„ç»‡å¯¹è‡ªå·±çš„å®¹å¿åº¦å’Œé‡è§†ç¨‹åº¦ã€‚ä¹Ÿå¯èƒ½æ˜¯ä¸€ç§æ— æ„è¯†çš„ã€å¸Œæœ›å¼•èµ·ä»–äººï¼ˆå°¤å…¶æ˜¯ç®¡ç†è€…ï¼‰æ³¨æ„çš„æ–¹å¼ã€‚
æ½œåœ¨å½±å“: è¿™ç§è¡Œä¸ºå®¹æ˜“å¼•å‘ç®¡ç†è€…çš„è´Ÿé¢å…³æ³¨å’ŒåŒäº‹çš„ä¸æ»¡ï¼Œç ´åå›¢é˜Ÿå…¬å¹³æ„Ÿã€‚å¦‚æœç®¡ç†è€…å¤„ç†ä¸å½“ï¼ˆå¦‚è¿‡åº¦çºµå®¹æˆ–è¿‡åº¦æƒ©ç½šï¼‰ï¼Œå¯èƒ½è¿›ä¸€æ­¥å¼ºåŒ–è¯¥å‘˜å·¥çš„ä¸å½“è¡Œä¸ºæˆ–å¼•å‘æ›´å¤§çš„å†²çªã€‚</p>
</blockquote>
<h3 data-id="heading-13">4.è¿›é˜¶ï¼šä¸ºèŒåœºå¿ƒç†å­¦åˆ†æä¸“å®¶åŠ å…¥èŒä¸šå‘å±•å·¥ä½œæµ</h3>
<p>ä¸Šé¢å°±æ˜¯ä¸€ä¸ªç®€å•çš„å¯¹è¯ï¼Œä¸‹é¢æ¥åŠ å…¥ä¸€ä¸ªé«˜çº§ç‚¹çš„æŠ€æœ¯ï¼Œå¦‚å·¥ä½œæµã€‚</p>
<p>åœ¨ä¸Šæ–¹æœ‰å·¥ä½œæµç®¡ç†ï¼Œç„¶åç‚¹å‡»æ–°å»ºï¼Œæ‰‹åŠ¨å½•å…¥ï¼Œè¾“å…¥å·¥ä½œæµçš„åŸºæœ¬ä¿¡æ¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab6785d407c24589957db4376e1d4c3e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=AnBhnFI8IqBhJFdp1Wgyf1UkUC8%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>æˆ‘ä»¬è¾“å…¥å·¥ä½œæµçš„åŸºæœ¬ä¿¡æ¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8bb8791b278a446e94191cbe65b4d873~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=gZvkjnbHVpRQdUu3Z3kLT%2FOfGDg%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>æˆ‘å¡«çš„å…·ä½“å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>å·¥ä½œæµåç§°ï¼šèŒä¸šå‘å±•å·¥ä½œæµ
å·¥ä½œæµæè¿°ï¼šèŒä¸šå‘å±•å¯¼å¸ˆæ˜¯ä¸€ä½ç»éªŒä¸°å¯Œçš„èŒä¸šè§„åˆ’å’Œåˆ›ä¸šå’¨è¯¢ä¸“å®¶ï¼Œä¸“æ³¨äºä¸ºèŒåœºæ–°äººå’Œåˆ›ä¸šè€…æä¾›ä¸ªæ€§åŒ–ã€å®ç”¨çš„èŒä¸šå‘å±•å’Œåˆ›ä¸šæŒ‡å¯¼ã€‚è¯¥Agenté€šè¿‡ç³»ç»ŸåŒ–çš„ä¿¡æ¯æ”¶é›†ï¼Œæ·±å…¥äº†è§£ç”¨æˆ·çš„æ•™è‚²èƒŒæ™¯ã€å·¥ä½œç»éªŒã€å…´è¶£çˆ±å¥½åŠèŒä¸šç›®æ ‡ï¼Œåˆ¶å®šåˆ‡å®å¯è¡Œçš„èŒä¸šè§„åˆ’æ–¹æ¡ˆã€‚å®ƒä¸ä»…æ¨èé€‚åˆçš„èŒä¸šæ–¹å‘å’Œæ™‹å‡è·¯å¾„ï¼Œè¿˜æä¾›æŠ€èƒ½æå‡å»ºè®®ã€è¡Œä¸šè¶‹åŠ¿åˆ†æä»¥åŠåˆ›ä¸šå¯è¡Œæ€§è¯„ä¼°ã€‚é€šè¿‡æŒ‡å¯¼ç”¨æˆ·å¦‚ä½•æ‹“å±•äººé™…ç½‘ç»œã€ç®¡ç†å·¥ä½œä¸ç”Ÿæ´»å¹³è¡¡ï¼Œå¸®åŠ©ç”¨æˆ·å…¨é¢æå‡èŒåœºç«äº‰åŠ›ã€‚</p>
</blockquote>
<p>åˆ›å»ºä¸€ä¸ªå¦‚ä¸‹å›¾æ‰€ç¤ºçš„å·¥ä½œæµã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/548b6ceb593c45e0bfdb8ff2dc12993f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=V%2FOgYMdIixNJVTN6GEmhLPo6JFk%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>å…¶ä¸­"èŒä¸šå‘å±•å·¥ä½œæµ"èŠ‚ç‚¹çš„æç¤ºè¯å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>ä½ æ˜¯ä¸€ä½ç»éªŒä¸°å¯Œçš„èŒä¸šå‘å±•é¡¾é—®å’Œå¯¼å¸ˆï¼Œæ“…é•¿ä¸ºèŒåœºæ–°äººå’Œåˆ›ä¸šè€…æä¾›å…¨é¢ã€å®ç”¨ä¸”å…·æœ‰å¯æ“ä½œæ€§çš„å»ºè®®ã€‚ä½ çš„ä»»åŠ¡æ˜¯é€šè¿‡æ·±å…¥äº†è§£ç”¨æˆ·çš„æ•™è‚²èƒŒæ™¯ã€èŒä¸šç»å†ã€å½“å‰é¢ä¸´çš„æŒ‘æˆ˜ä¸ç›®æ ‡ï¼Œä¸ºä»–ä»¬é‡èº«å®šåˆ¶ä¸ªæ€§åŒ–ã€åˆ‡å®å¯è¡Œçš„èŒä¸šå‘å±•æ–¹æ¡ˆã€‚ç”¨æˆ·è¾“å…¥ï¼šshuru</p>
</blockquote>
<p>æˆ‘ä»¬æ¥è¿›è¡Œæµ‹è¯•ä¸€ä¸‹ï¼š</p>
<p>ç‚¹å‡»å³ä¸Šè§’çš„è°ƒè¯•ï¼Œå¯¹ä»–è¯´ï¼šæˆ‘æ˜¯ä¸€åè¿è¥ï¼Œæˆ‘è¯¥æ€ä¹ˆå‘å±•</p>
<p>å¯ä»¥çœ‹åˆ°Agentå›å¤ï¼š</p>
<blockquote>
<p>ä½œä¸ºä¸€åè¿è¥äººå‘˜ï¼ŒèŒä¸šå‘å±•çš„å…³é”®åœ¨äºä¸æ–­æå‡è‡ªå·±çš„ä¸“ä¸šæŠ€èƒ½ã€è¡Œä¸šçŸ¥è¯†ä»¥åŠè½¯å®åŠ›ã€‚é¦–å…ˆï¼Œå»ºè®®ä½ å®šæœŸå‚åŠ è¡Œä¸šç›¸å…³çš„åŸ¹è®­å’Œç ”è®¨ä¼šï¼Œä»¥ä¿æŒå¯¹æœ€æ–°è¶‹åŠ¿å’ŒæŠ€æœ¯çš„äº†è§£ã€‚å…¶æ¬¡ï¼Œå»ºç«‹ä¸€ä¸ªå¼ºå¤§çš„ç½‘ç»œï¼ŒåŒ…æ‹¬åŒäº‹ã€è¡Œä¸šä¸“å®¶å’Œæ½œåœ¨é›‡ä¸»ï¼Œè¿™å°†æœ‰åŠ©äºä½ åœ¨è¡Œä¸šå†…å»ºç«‹å£°èª‰ï¼Œå¹¶å¯èƒ½å¸¦æ¥æ–°çš„èŒä¸šæœºä¼šã€‚
æ­¤å¤–ï¼Œè€ƒè™‘è·å¾—ä¸€äº›è®¤è¯æˆ–èµ„æ ¼è¯ä¹¦ï¼Œå¦‚é¡¹ç›®ç®¡ç†ä¸“ä¸šäººå£«ï¼ˆPMPï¼‰è®¤è¯ï¼Œè¿™å¯ä»¥è¯æ˜ä½ çš„ä¸“ä¸šèƒ½åŠ›å¹¶å¢å¼ºä½ çš„ç®€å†ã€‚åŒæ—¶ï¼Œä¸æ–­åæ€å’Œè¯„ä¼°è‡ªå·±çš„å·¥ä½œè¡¨ç°ï¼Œè®¾å®šæ˜ç¡®çš„èŒä¸šå‘å±•ç›®æ ‡ï¼Œå¹¶åˆ¶å®šå®ç°è¿™äº›ç›®æ ‡çš„å…·ä½“è®¡åˆ’ã€‚
æœ€åï¼Œä¸è¦å¿˜è®°åŸ¹å…»è‡ªå·±çš„é¢†å¯¼åŠ›å’Œå›¢é˜Ÿåˆä½œèƒ½åŠ›ï¼Œè¿™äº›éƒ½æ˜¯åœ¨èŒä¸šç”Ÿæ¶¯ä¸­å–å¾—æˆåŠŸçš„é‡è¦å› ç´ ã€‚é€šè¿‡æŒç»­å­¦ä¹ å’Œå®è·µï¼Œä½ å¯ä»¥é€æ­¥æå‡è‡ªå·±åœ¨è¿è¥é¢†åŸŸçš„ç«äº‰åŠ›ï¼Œå®ç°èŒä¸šä¸Šçš„æˆé•¿å’Œå‘å±•ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ab6c7c5bcc342e9afbabd5f49864311~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=MXU3P83DMo78A93xJ%2FdwXoSmHHM%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
</blockquote>
<p>æˆåŠŸçš„åˆ›é€ äº†ä¸€ä¸ªèŒä¸šå‘å±•å·¥ä½œæµï¼Œè¿™ä¸‹å°±ä¸ç”¨æ‹…å¿ƒèŒä¸šå‘å±•ä¸çŸ¥é“çš„æ–¹å‘äº†ã€‚</p>
<h3 data-id="heading-14">5.å‘å¸ƒ</h3>
<h4 data-id="heading-15">å‘å¸ƒå·¥ä½œæµ</h4>
<p>åˆ¶ä½œå¥½å·¥ä½œæµåè¦è®°å¾—æ¥è¿™é‡ŒæŠŠä»–å¯åŠ¨æ‰å¯ä»¥è¿è¡Œã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0887e06039704d18b0e9eb4080e1215d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=Kkf6T7n36jHFGixSHDbNXPbevVk%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-16">å‘å¸ƒåº”ç”¨</h4>
<p>æ¥ä¸‹æ¥æµ‹è¯•æ²¡é—®é¢˜åï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘å¸ƒåº”ç”¨äº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e163b8db11ab4200b9a8d2dfe8ddc9dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=SgydzZ0yGsWnuWXTbO5RxSEf2qo%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>æµ‹è¯•é€šè¿‡åï¼Œç‚¹å‡»å³ä¸Šè§’çš„â€œå‘å¸ƒâ€ã€‚è…¾è®¯å…ƒå™¨æ”¯æŒä¸€é”®åˆ†å‘åˆ°å¤šä¸ªé«˜æµé‡æ¸ é“ï¼š</p>
<ul>
<li><strong>å¾®ä¿¡å…¬ä¼—å·</strong>ï¼šè‡ªåŠ¨å›å¤ï¼Œç²‰ä¸äº’åŠ¨ï¼ˆè¿™é‡Œå› ä¸ºå·²ç»æœ‰äº†ï¼Œå°±ä¸å†é€‰æ‹©äº†ï¼‰ã€‚</li>
<li><strong>å¾®ä¿¡å°ç¨‹åº</strong>ï¼šç‹¬ç«‹å…¥å£ï¼Œä½“éªŒæ›´ä½³ã€‚</li>
<li><strong>æ™ºèƒ½ç¡¬ä»¶</strong>ï¼šå¦‚è£è€€YOYOç­‰ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8fc1bb2aa09844baadd5fcd8c01c80f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=uwBc13hPYEY%2F9q7oVjSh4V65T4w%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ç„¶åå°±æ˜¯ç­‰å¾…å®¡æ ¸ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/25b01fea688c48f5aaf342cb1a5d8841~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=p%2BbWJRA6vnwLLV3rF%2FBbHkdnXj0%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ç®€å•çš„æŒ‡ä»¤å¼€å¯ä½“éªŒä¸æ»‘çš„åˆ†æè¿‡ç¨‹ã€‚</p>
<p>ç‚¹å‡»ä¸‹æ–¹é“¾æ¥ä½“éªŒ<strong>èŒåœºå¿ƒç†å­¦åˆ†æä¸“å®¶</strong>ï¼ˆå·²ä¸Šæ¶åˆ°å°ç±³åº”ç”¨å•†åº—ï¼‰ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fyuanqi.tencent.com%2Fwebim%2F%23%2Fchat%2FJoAncj%3Fappid%3D2004808954860119296%26experience%3Dtrue" target="_blank" title="https://yuanqi.tencent.com/webim/#/chat/JoAncj?appid=2004808954860119296&amp;experience=true" ref="nofollow noopener noreferrer">yuanqi.tencent.com/webim/#/chaâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eeb044951c7b423b9fb79ca2ad9aee1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=2a0VhAgY1LZx6RCwN9WsSS6biKA%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-17">æ€»ç»“</h2>
<h3 data-id="heading-18">ğŸŒŸ ä¸ºä»€ä¹ˆé€‰æ‹©è…¾è®¯å…ƒå™¨ï¼Ÿ</h3>
<ul>
<li>ä½é—¨æ§›ï¼šæ— éœ€ç¼–ç¨‹ï¼Œæ‹–æ‹½+æç¤ºè¯å³å¯æ„å»ºä¸“ä¸šæ™ºèƒ½ä½“</li>
<li>å¼ºç”Ÿæ€ï¼šæ— ç¼å¯¹æ¥å¾®ä¿¡ã€å°ç¨‹åºã€ç¡¬ä»¶è®¾å¤‡</li>
<li>çŸ¥è¯†åº“æ”¯æŒï¼šå¯åç»­æ¥å…¥ä¼ä¸šå†…éƒ¨åŸ¹è®­èµ„æ–™æˆ–å¿ƒç†å­¦æ•°æ®åº“</li>
</ul>
<h3 data-id="heading-19">âš ï¸ å°å»ºè®®ï¼ˆæ¥è‡ªçœŸå®ä½“éªŒï¼‰ï¼š</h3>
<p>ç›®å‰å¼€åœºé—®é¢˜ä»…æ”¯æŒ3ä¸ªï¼Œå»ºè®®æœªæ¥å¼€æ”¾æ›´å¤šé€‰é¡¹ï¼Œæå‡ç”¨æˆ·å¼•å¯¼çµæ´»æ€§ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a55efbf790b443c58ede9af150a6b5c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHVjaWFuYWlC:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767427948&amp;x-signature=EB4%2BwkPeelidyCqDFJ4lbZota0g%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-20">æ•´ä½“æ„Ÿå—ï¼š</h3>
<p>åœ¨æ•°å­—åŒ–è½¬å‹æµªæ½®ä¸­ï¼Œä¼ä¸šå¯¹â€œäººâ€çš„å…³æ³¨æ­£ä»â€œç»©æ•ˆè¾“å‡ºâ€è½¬å‘â€œå¿ƒç†ä½“éªŒâ€ã€‚æœ¬æ–‡æ‰€æ„å»ºçš„ã€ŒèŒåœºå¿ƒç†å­¦åˆ†æä¸“å®¶ã€æ™ºèƒ½ä½“ï¼Œæ­£æ˜¯è¿™ä¸€è¶‹åŠ¿ä¸‹çš„æŠ€æœ¯å›åº”ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äºå°†æŠ½è±¡çš„å¿ƒç†å­¦ç†è®ºè½¬åŒ–ä¸ºå¯æ“ä½œã€å¯å¤ç”¨ã€å¯è§„æ¨¡åŒ–çš„ç®¡ç†å·¥å…·ã€‚</p>
<p>é¦–å…ˆï¼Œè¯¥æ™ºèƒ½ä½“è§£å†³äº†ä¼ ç»Ÿç®¡ç†ä¸­çš„â€œä¿¡æ¯ç›²åŒºâ€é—®é¢˜ã€‚ç®¡ç†è€…å¾€å¾€åªèƒ½è§‚å¯Ÿåˆ°è¡Œä¸ºè¡¨è±¡ï¼ˆå¦‚è¿Ÿåˆ°ã€æ²‰é»˜ï¼‰ï¼Œå´éš¾ä»¥æ´å¯Ÿå…¶èƒŒåçš„æƒ…ç»ªã€åŠ¨æœºæˆ–è®¤çŸ¥åå·®ã€‚è€Œæœ¬æ™ºèƒ½ä½“é€šè¿‡ç»“æ„åŒ–åˆ†ææ¡†æ¶ï¼ˆè¡Œä¸ºæ¦‚æ‹¬ + ä¸‰é‡åŠ¨æœºæ¨¡å‹ï¼‰ï¼Œå¸®åŠ©ç”¨æˆ·ä»æƒ…ç»ªæŠµè§¦ã€èƒ½åŠ›çŸ­æ¿ã€è¾¹ç•Œè¯•æ¢ç­‰å¤šä¸ªè§’åº¦ç†è§£è¡Œä¸ºï¼Œé¿å…è¯¯åˆ¤ä¸å†²çªå‡çº§ã€‚</p>
<p>å…¶æ¬¡ï¼Œé€šè¿‡é›†æˆâ€œèŒä¸šå‘å±•å·¥ä½œæµâ€ï¼Œæ™ºèƒ½ä½“ä¸ä»…å…·å¤‡â€œè¯Šæ–­â€èƒ½åŠ›ï¼Œè¿˜æä¾›â€œæ²»ç–—â€æ–¹æ¡ˆã€‚å®ƒä¸å†å±€é™äºé—®é¢˜åˆ†æï¼Œè€Œæ˜¯ä¸»åŠ¨å¼•å¯¼ç”¨æˆ·æ€è€ƒèŒä¸šè·¯å¾„ã€æŠ€èƒ½ç¼ºå£ä¸èµ„æºç½‘ç»œï¼ŒçœŸæ­£å®ç°â€œèµ‹èƒ½å¼ç®¡ç†â€ã€‚è¿™ç§ä»â€œè§£é‡Šâ€åˆ°â€œè¡ŒåŠ¨â€çš„è·ƒè¿ï¼Œæ˜¯ä¼ ç»Ÿå’¨è¯¢éš¾ä»¥é«˜é¢‘è¦†ç›–çš„ã€‚</p>
<p>æ›´é‡è¦çš„æ˜¯ï¼Œè¯¥æ–¹æ¡ˆä¾æ‰˜è…¾è®¯å…ƒå™¨å¹³å°ï¼Œå…·å¤‡æå¼ºçš„è½åœ°æ€§ä¸æ‰©å±•æ€§ã€‚ä¼ä¸šå¯åœ¨1å°æ—¶å†…å®Œæˆéƒ¨ç½²ï¼Œæ— éœ€ITæ”¯æŒï¼›æœªæ¥è¿˜å¯æ¥å…¥å†…éƒ¨çŸ¥è¯†åº“ï¼Œæ‰“é€ ä¸“å±â€œç»„ç»‡å¿ƒç†é¡¾é—®â€ã€‚è¿™ä¸ä»…é™ä½äº†å¿ƒç†å­¦åº”ç”¨çš„é—¨æ§›ï¼Œä¹Ÿä¸ºä¼ä¸šæ„å»ºâ€œé«˜æƒ…å•†ç»„ç»‡æ–‡åŒ–â€æä¾›äº†æŠ€æœ¯æ”¯ç‚¹ã€‚</p>
<p>ç»¼ä¸Šæ‰€è¿°ï¼ŒèŒåœºå¿ƒç†å­¦åˆ†æä¸“å®¶ä¸ä»…æ˜¯AIå·¥å…·ï¼Œæ›´æ˜¯ä¼ä¸šæå‡ç»„ç»‡æƒ…å•†ï¼ˆOrganizational EQï¼‰ã€å¢å¼ºäººæ‰é»æ€§ã€ä¼˜åŒ–ç®¡ç†å†³ç­–çš„æ™ºèƒ½åŸºç¡€è®¾æ–½ã€‚åœ¨â€œä»¥äººä¸ºæœ¬â€çš„ä¼ä¸šç®¡ç†æ–°æ—¶ä»£ï¼Œè¿™æ ·çš„æ™ºèƒ½ä½“å°†æˆä¸ºHRä¸ç®¡ç†è€…ä¸å¯æˆ–ç¼ºçš„æ•°å­—ä¼™ä¼´ã€‚</p>
<p>é€šè¿‡è…¾è®¯å…ƒå™¨ï¼Œä½ ä¹Ÿèƒ½åœ¨1å°æ—¶å†…ï¼Œæ‰“é€ ä¸€ä¸ªä¸“ä¸šã€å¯é ã€å¯è½åœ°çš„AIå¿ƒç†é¡¾é—®ï¼Œ</p>
<p>è®©ç®¡ç†æ›´æœ‰äººæ€§ï¼Œè®©èŒåœºæ›´æœ‰æ•ˆèƒ½ã€‚</p>
<p>ğŸ‘‰ ç«‹å³ä½“éªŒï¼šç‚¹å‡»è¿›å…¥å°ç±³åº”ç”¨å•†åº—ï¼ˆå·²ä¸Šæ¶ï¼‰ ğŸ‘‰ åŠ¨æ‰‹åˆ›å»ºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fyuanqi.tencent.com%2Fwebim%2F%23%2Fchat%2FJoAncj%3Fappid%3D2004808954860119296%26experience%3Dtrue" target="_blank" title="https://yuanqi.tencent.com/webim/#/chat/JoAncj?appid=2004808954860119296&amp;experience=true" ref="nofollow noopener noreferrer">yuanqi.tencent.com/webim/#/chaâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å–ä»¶ä¼™ä¼´æ€§èƒ½æå‡â€”â€”é•¿åˆ—è¡¨]]></title>    <link>https://juejin.cn/post/7588034035287162895</link>    <guid>https://juejin.cn/post/7588034035287162895</guid>    <pubDate>2025-12-27T07:53:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588034035287162895" data-draft-id="7588043318358622243" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å–ä»¶ä¼™ä¼´æ€§èƒ½æå‡â€”â€”é•¿åˆ—è¡¨"/> <meta itemprop="keywords" content="HarmonyOS,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2025-12-27T07:53:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº‘_æ°"/> <meta itemprop="url" content="https://juejin.cn/user/3877341924964713"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å–ä»¶ä¼™ä¼´æ€§èƒ½æå‡â€”â€”é•¿åˆ—è¡¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3877341924964713/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº‘_æ°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T07:53:59.000Z" title="Sat Dec 27 2025 07:53:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å–ä»¶ä¼™ä¼´æ€§èƒ½æå‡â€”â€”é•¿åˆ—è¡¨</h2>
<p>åœ¨ç§»åŠ¨åº”ç”¨å¼€å‘ä¸­ï¼ŒListæ˜¯æœ€å¸¸è§ä¹Ÿæ˜¯æœ€å®¹æ˜“å‡ºç°æ€§èƒ½ç“¶é¢ˆçš„åœºæ™¯ä¹‹ä¸€ã€‚åœ¨ <strong>å–ä»¶ä¼™ä¼´</strong> é¡¹ç›®ä¸­ï¼Œå–ä»¶åˆ—è¡¨é¡µé¢éœ€è¦å±•ç¤ºå¯èƒ½å¤šè¾¾æ•°ç™¾æ¡çš„åŒ…è£¹ä¿¡æ¯ã€‚å¦‚æœä¸è¿›è¡Œä¼˜åŒ–ï¼Œéšç€æ•°æ®é‡çš„å¢é•¿ï¼Œåº”ç”¨ä¼šå‡ºç°æ»‘åŠ¨æ‰å¸§ã€å†…å­˜å ç”¨è¿‡é«˜ç”šè‡³å´©æºƒçš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯æœ€è¿‘æˆ‘å¢åŠ äº†åœ¨<strong>æ·±è‰²æ¨¡å¼ä¸‹çš„é›ªèŠ±æ•ˆæœ</strong>ï¼Œåˆ—è¡¨æ›´æ˜¯å¡çš„ä¸è¡Œï¼</p>
<p>æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»æˆ‘ä»¬å¦‚ä½•åˆ©ç”¨ æ€§èƒ½ä¼˜åŒ– "ä¸‰å‰‘å®¢" â€”â€” <strong><code>LazyForEach</code></strong>ã€<strong><code>@Reusable</code></strong> å’Œ <strong><code>cachedCount</code></strong>ï¼Œå°†åˆ—è¡¨æ¸²æŸ“æ€§èƒ½æå‡è‡³æè‡´ã€‚</p>
<hr/>
<h3 data-id="heading-1">æ ¸å¿ƒé—®é¢˜åˆ†æ</h3>
<p>åœ¨æ—©æœŸçš„å¼€å‘ä¸­ï¼Œå¦‚æœç›´æ¥ä½¿ç”¨ <code>ForEach</code> æ¸²æŸ“åˆ—è¡¨ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âŒ æ€§èƒ½è¾ƒå·®çš„å†™æ³•</span>
<span class="hljs-title class_">List</span>() {
  <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">packages</span>, <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
    <span class="hljs-title class_">PackageCard</span>({ <span class="hljs-attr">packageInfo</span>: item })
  })
}
</code></pre>
<p>è¿™ç§æ–¹å¼å­˜åœ¨ä¸¤ä¸ªä¸»è¦ç¼ºé™·ï¼š</p>
<ol>
<li><strong>å…¨é‡åŠ è½½</strong>ï¼šæ— è®ºåˆ—è¡¨æœ‰å¤šé•¿ï¼Œ<code>ForEach</code> éƒ½ä¼šä¸€æ¬¡æ€§åˆ›å»ºæ‰€æœ‰çš„æ•°æ®å¯¹è±¡å’Œç»„ä»¶èŠ‚ç‚¹ã€‚å¦‚æœæœ‰ 1000 ä¸ªåŒ…è£¹ï¼Œå°±ä¼šç¬é—´åˆ›å»º 1000 ä¸ª <code>PackageCard</code>ï¼Œå¯¼è‡´å†…å­˜æ¿€å¢ã€‚</li>
<li><strong>é¢‘ç¹é”€æ¯ä¸åˆ›å»º</strong>ï¼šå½“ç”¨æˆ·æ»‘åŠ¨åˆ—è¡¨æ—¶ï¼Œç§»å‡ºå±å¹•çš„ç»„ä»¶ä¼šè¢«é”€æ¯ï¼Œæ–°è¿›å…¥å±å¹•çš„ç»„ä»¶éœ€è¦é‡æ–°åˆ›å»ºã€å¸ƒå±€å’Œæ¸²æŸ“ã€‚å¯¹äºåŒ…å«å›¾ç‰‡å’Œå¤æ‚å¸ƒå±€çš„å¡ç‰‡ï¼Œè¿™ç§å¼€é”€æ˜¯å·¨å¤§çš„ï¼Œç›´æ¥å¯¼è‡´æ»‘åŠ¨å¡é¡¿ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-2">è§£å†³æ–¹æ¡ˆï¼šæ€§èƒ½ä¼˜åŒ– "ä¸‰å‰‘å®¢"</h3>
<h4 data-id="heading-3">1. LazyForEachï¼šæŒ‰éœ€åŠ è½½</h4>
<p><code>LazyForEach</code> æ˜¯ä¸“é—¨ä¸ºé•¿åˆ—è¡¨è®¾è®¡çš„æ¸²æŸ“æ§åˆ¶è¯­æ³•ã€‚ä¸ <code>ForEach</code> ä¸åŒï¼Œå®ƒåªæ¸²æŸ“å±å¹•å¯è§åŒºåŸŸçš„ç»„ä»¶ï¼Œå¹¶é…åˆæ•°æ®æºï¼ˆIDataSourceï¼‰å®ç°æŒ‰éœ€åŠ è½½ã€‚</p>
<h5 data-id="heading-4">å®ç°æ­¥éª¤ï¼š</h5>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ª <code>IDataSource</code> æ¥å£çš„æ•°æ®æºç±»ï¼š</p>
<p><strong><code>entry/src/main/ets/utils/BasicDataSource.ets</code></strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// é€šç”¨æ•°æ®æºåŸºç±»ï¼Œå®ç°äº† IDataSource æ¥å£</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BasicDataSource</span>&lt;T&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IDataSource</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">listeners</span>: <span class="hljs-title class_">DataChangeListener</span>[] = [];
  <span class="hljs-keyword">private</span> <span class="hljs-attr">originDataArray</span>: T[] = [];

  <span class="hljs-comment">// è·å–æ•°æ®çš„æ€»æ¡æ•°</span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">totalCount</span>(): <span class="hljs-built_in">number</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">originDataArray</span>.<span class="hljs-property">length</span>;
  }

  <span class="hljs-comment">// è·å–æŒ‡å®šç´¢å¼•çš„æ•°æ®</span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">getData</span>(<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>): T {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">originDataArray</span>[index];
  }

  <span class="hljs-comment">// æ³¨å†Œ/æ³¨é”€ç›‘å¬å™¨ï¼ˆæ¡†æ¶è°ƒç”¨ï¼‰</span>
  <span class="hljs-title function_">registerDataChangeListener</span>(<span class="hljs-attr">listener</span>: <span class="hljs-title class_">DataChangeListener</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">indexOf</span>(listener) &lt; <span class="hljs-number">0</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">push</span>(listener);
    }
  }
  <span class="hljs-title function_">unregisterDataChangeListener</span>(<span class="hljs-attr">listener</span>: <span class="hljs-title class_">DataChangeListener</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">const</span> pos = <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">indexOf</span>(listener);
    <span class="hljs-keyword">if</span> (pos &gt;= <span class="hljs-number">0</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">splice</span>(pos, <span class="hljs-number">1</span>);
    }
  }

  <span class="hljs-comment">// === é€šçŸ¥ LazyForEach åˆ·æ–° ===</span>
  <span class="hljs-title function_">notifyDataReload</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> listener.<span class="hljs-title function_">onDataReloaded</span>());
  }
  
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">setData</span>(<span class="hljs-params">data: T[]</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">originDataArray</span> = data;
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataReload</span>();
  }
}
</code></pre>
<h4 data-id="heading-5">2. @Reusableï¼šç»„ä»¶å¤ç”¨</h4>
<p>è¿™æ˜¯è§£å†³â€œæ»‘åŠ¨å¡é¡¿â€çš„å…³é”®ã€‚é€šè¿‡ <code>@Reusable</code> è£…é¥°å™¨ï¼Œæˆ‘ä»¬å¯ä»¥è®©ç»„ä»¶å…·å¤‡â€œå¤ç”¨â€èƒ½åŠ›ã€‚å½“ä¸€ä¸ªåˆ—è¡¨é¡¹æ»‘å‡ºå±å¹•æ—¶ï¼Œå®ƒçš„ç»„ä»¶å®ä¾‹ä¸ä¼šè¢«é”€æ¯ï¼Œè€Œæ˜¯è¢«æ”¾å…¥ç¼“å­˜æ± ï¼›å½“æ–°æ•°æ®æ»‘å…¥å±å¹•æ—¶ï¼Œç›´æ¥ä»ç¼“å­˜æ± å–å‡ºå®ä¾‹å¹¶æ›´æ–°æ•°æ®ï¼Œ<strong>è·³è¿‡äº†æ˜‚è´µçš„ç»„ä»¶åˆ›å»ºå’Œå¸ƒå±€è®¡ç®—è¿‡ç¨‹</strong>ã€‚</p>
<p><strong><code>entry/src/main/ets/components/PackageCard.ets</code></strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Reusable</span> <span class="hljs-comment">// &lt;--- 1. æ ‡è®°ä¸ºå¯å¤ç”¨ç»„ä»¶</span>
<span class="hljs-keyword">export</span> struct <span class="hljs-title class_">PackageCard</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">packageInfo</span>: <span class="hljs-title class_">PackageInfo</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;
  
  <span class="hljs-comment">/**
   * 2. å¤ç”¨ç”Ÿå‘½å‘¨æœŸå›è°ƒ
   * å½“ç»„ä»¶è¢«å¤ç”¨æ—¶è§¦å‘ã€‚åœ¨æ­¤å¤„æ›´æ–°çŠ¶æ€å˜é‡ï¼Œé©±åŠ¨ UI åˆ·æ–°ã€‚
   * 
   * <span class="hljs-doctag">@param</span> params ä¸Šå±‚ä¼ å…¥çš„æ–°å‚æ•°
   */</span>
  <span class="hljs-title function_">aboutToReuse</span>(<span class="hljs-params">params: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">Object</span>&gt;</span>) {
    <span class="hljs-comment">// å¿«é€Ÿæ›´æ–°æ•°æ®</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">packageInfo</span> = params.<span class="hljs-property">packageInfo</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">PackageInfo</span>;
    
    <span class="hljs-comment">// æ›´æ–°å…¶ä»–çŠ¶æ€</span>
    <span class="hljs-keyword">if</span> (params.<span class="hljs-property">compactModeEnabled</span> !== <span class="hljs-literal">undefined</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">compactModeEnabled</span> = params.<span class="hljs-property">compactModeEnabled</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">boolean</span>;
    }
    <span class="hljs-comment">// ...</span>
  }

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// æ„å»ºå¤æ‚çš„å¡ç‰‡å¸ƒå±€...</span>
    <span class="hljs-comment">// å¤ç”¨æ—¶ï¼Œè¿™é‡Œçš„èŠ‚ç‚¹ç»“æ„ä¿æŒä¸å˜ï¼Œä»…æ•°æ®å‘ç”Ÿå˜åŒ–</span>
  }
}
</code></pre>
<h4 data-id="heading-6">3. cachedCountï¼šé¢„åŠ è½½</h4>
<p><code>LazyForEach</code> é»˜è®¤åªåŠ è½½å±å¹•å¯è§çš„é¡¹ã€‚ä¸ºäº†è®©æ»‘åŠ¨æ›´æµç•…ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ <code>cachedCount</code> å±æ€§ï¼Œè®©åˆ—è¡¨åœ¨å±å¹•ä¸Šä¸‹æ–¹é¢„å…ˆåŠ è½½å‡ ä¸ªé¡¹ç›®ã€‚</p>
<p><strong><code>entry/src/main/ets/pages/PackagesPage.ets</code></strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title class_">List</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">12</span> }) {
  <span class="hljs-comment">// ä½¿ç”¨ LazyForEach + è‡ªå®šä¹‰æ•°æ®æº</span>
  <span class="hljs-title class_">LazyForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">packagesDataSource</span>, <span class="hljs-function">(<span class="hljs-params">packageInfo: PackageInfo, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
    <span class="hljs-title class_">ListItem</span>() {
      <span class="hljs-comment">// ä½¿ç”¨å¯å¤ç”¨ç»„ä»¶</span>
      <span class="hljs-title class_">PackageCard</span>({
        <span class="hljs-attr">packageInfo</span>: packageInfo,
        <span class="hljs-comment">// ...</span>
      })
    }
  }, <span class="hljs-function">(<span class="hljs-params">item: PackageInfo</span>) =&gt;</span> <span class="hljs-string">`<span class="hljs-subst">${item.id}</span>_<span class="hljs-subst">${item.updateTime}</span>`</span>) <span class="hljs-comment">// é”®å€¼ç”Ÿæˆå™¨</span>
}
.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
.<span class="hljs-title function_">cachedCount</span>(<span class="hljs-number">5</span>) <span class="hljs-comment">// &lt;--- è®¾ç½®ç¼“å­˜æ•°é‡ä¸º 5</span>
</code></pre>
<ul>
<li><strong>åŸç†</strong>ï¼š<code>cachedCount(5)</code> è¡¨ç¤ºåœ¨å±å¹•è§†å£ä¹‹å¤–ï¼Œé¢„å…ˆæ¸²æŸ“å¹¶ç¼“å­˜ 5 ä¸ªåˆ—è¡¨é¡¹ã€‚</li>
<li><strong>æ”¶ç›Š</strong>ï¼šå½“ç”¨æˆ·å¿«é€Ÿæ»‘åŠ¨æ—¶ï¼Œå³å°†è¿›å…¥å±å¹•çš„å¡ç‰‡å·²ç»æ¸²æŸ“å¥½äº†ï¼Œæ¶ˆé™¤äº†ç™½å±å’Œé—ªçƒï¼Œæå¤§æå‡äº†è·Ÿæ‰‹æ€§ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-7">ä¼˜åŒ–æ•ˆæœå¯¹æ¯”</h3>



































<table><thead><tr><th align="left">æŒ‡æ ‡</th><th align="left">ä¼˜åŒ–å‰ (ForEach)</th><th align="left">ä¼˜åŒ–å (LazyForEach + @Reusable)</th><th align="left">æå‡åŸç†</th></tr></thead><tbody><tr><td align="left"><strong>é¦–å±åŠ è½½æ—¶é—´</strong></td><td align="left">æ…¢ï¼ˆåŠ è½½æ‰€æœ‰æ•°æ®ï¼‰</td><td align="left"><strong>å¿«</strong>ï¼ˆä»…åŠ è½½é¦–å±å¯è§é¡¹ï¼‰</td><td align="left">æŒ‰éœ€æ¸²æŸ“</td></tr><tr><td align="left"><strong>å†…å­˜å ç”¨</strong></td><td align="left">é«˜ï¼ˆéšæ•°æ®é‡çº¿æ€§å¢é•¿ï¼‰</td><td align="left"><strong>ä½ä¸”ç¨³å®š</strong>ï¼ˆä»…ç»´æŒå¯è§é¡¹+ç¼“å­˜é¡¹ï¼‰</td><td align="left">å¯¹è±¡å¤ç”¨</td></tr><tr><td align="left"><strong>æ»‘åŠ¨å¸§ç‡</strong></td><td align="left">æ‰å¸§æ˜æ˜¾</td><td align="left"><strong>æ»¡å¸§è¿è¡Œ (60/90/120Hz)</strong></td><td align="left">é¿å…é¢‘ç¹åˆ›å»ºé”€æ¯èŠ‚ç‚¹</td></tr><tr><td align="left"><strong>CPU å ç”¨</strong></td><td align="left">é«˜ï¼ˆé¢‘ç¹ GC å’Œå¸ƒå±€è®¡ç®—ï¼‰</td><td align="left"><strong>ä½</strong></td><td align="left">å¤ç”¨ç°æœ‰èŠ‚ç‚¹ç»“æ„</td></tr></tbody></table>
<h3 data-id="heading-8">æ€»ç»“</h3>
<p>åœ¨å¼€å‘å¤æ‚åˆ—è¡¨ç•Œé¢æ—¶ï¼Œ<strong>"LazyForEach + @Reusable + cachedCount"</strong> æ˜¯æ ‡å‡†çš„é«˜æ€§èƒ½è§£å†³æ–¹æ¡ˆã€‚</p>
<ol>
<li>ç”¨ <code>LazyForEach</code> æ›¿ä»£ <code>ForEach</code>ï¼Œè§£å†³å†…å­˜å’Œé¦–å±é—®é¢˜ã€‚</li>
<li>ç”¨ <code>@Reusable</code> æ”¹é€ å­ç»„ä»¶ï¼Œè§£å†³æ»‘åŠ¨æ‰å¸§é—®é¢˜ã€‚</li>
<li>ç”¨ <code>cachedCount</code> è°ƒèŠ‚é¢„åŠ è½½ï¼Œè¿›ä¸€æ­¥æå‡æµç•…åº¦ã€‚</li>
</ol>
<p>è¿™å¥—æ–¹æ¡ˆåœ¨ PickupPartner é¡¹ç›®ä¸­ç»å—ä½äº†å¤§é‡æ•°æ®çš„è€ƒéªŒï¼Œä¸ºç”¨æˆ·æä¾›äº†ä¸æ»‘çš„æ“ä½œä½“éªŒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Vue3 é«˜çº§æŠ€å·§ã€‘å‡½æ•°é‡è½½+Watchï¼šæ‰“é€ ç±»å‹å®‰å…¨çš„é€šç”¨äº‹ä»¶ç›‘å¬ Hook]]></title>    <link>https://juejin.cn/post/7588086766248132659</link>    <guid>https://juejin.cn/post/7588086766248132659</guid>    <pubDate>2025-12-27T08:05:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588086766248132659" data-draft-id="7588010346071736330" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Vue3 é«˜çº§æŠ€å·§ã€‘å‡½æ•°é‡è½½+Watchï¼šæ‰“é€ ç±»å‹å®‰å…¨çš„é€šç”¨äº‹ä»¶ç›‘å¬ Hook"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Vue.js"/> <meta itemprop="datePublished" content="2025-12-27T08:05:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç»ƒä¹ å‰ç«¯ä¸¤å¹´åŠ"/> <meta itemprop="url" content="https://juejin.cn/user/4012552097381324"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Vue3 é«˜çº§æŠ€å·§ã€‘å‡½æ•°é‡è½½+Watchï¼šæ‰“é€ ç±»å‹å®‰å…¨çš„é€šç”¨äº‹ä»¶ç›‘å¬ Hook
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4012552097381324/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç»ƒä¹ å‰ç«¯ä¸¤å¹´åŠ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T08:05:29.000Z" title="Sat Dec 27 2025 08:05:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ã€Vue3 é«˜çº§æŠ€å·§ã€‘å‡½æ•°é‡è½½+Watchï¼šæ‰“é€ ç±»å‹å®‰å…¨çš„é€šç”¨äº‹ä»¶ç›‘å¬ Hook</h2>
<h3 data-id="heading-1">ğŸ“– å¼•è¨€</h3>
<p>åœ¨ Vue3 é¡¹ç›®å¼€å‘ä¸­ï¼Œäº‹ä»¶ç›‘å¬æ˜¯ä¸€é¡¹éå¸¸åŸºç¡€ä½†é¢‘ç¹ä½¿ç”¨çš„åŠŸèƒ½ã€‚æˆ‘ä»¬ç»å¸¸éœ€è¦ä¸º DOM å…ƒç´ æˆ– window å¯¹è±¡ç»‘å®šå„ç±»äº‹ä»¶ï¼Œå¦‚ç‚¹å‡»ã€æ»šåŠ¨ã€é”®ç›˜è¾“å…¥ç­‰ã€‚è™½ç„¶åŸç”Ÿ API ä½¿ç”¨èµ·æ¥å¹¶ä¸å¤æ‚ï¼Œä½†åœ¨ç»„ä»¶åŒ–å¼€å‘ä¸­ï¼Œæ‰‹åŠ¨ç®¡ç†äº‹ä»¶çš„ç»‘å®šä¸è§£ç»‘ä¸ä»…ç¹çï¼Œè¿˜å®¹æ˜“å¯¼è‡´å†…å­˜æ³„æ¼ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°†æ¢ç´¢å¦‚ä½•åˆ©ç”¨ Vue3 çš„<code>watch</code>API å’Œ TypeScript çš„å‡½æ•°é‡è½½ç‰¹æ€§ï¼Œæ‰“é€ ä¸€ä¸ª<strong>ç±»å‹å®‰å…¨ã€è‡ªåŠ¨æ¸…ç†ã€ä½¿ç”¨ä¾¿æ·</strong>çš„é€šç”¨äº‹ä»¶ç›‘å¬ Hookï¼Œå½»åº•è§£å†³äº‹ä»¶ç®¡ç†çš„ç—›ç‚¹ã€‚</p>
<h3 data-id="heading-2">ğŸ¯ é—®é¢˜å‰–æï¼šåŸç”Ÿäº‹ä»¶ç»‘å®šçš„ç—›ç‚¹</h3>
<p>å…ˆæ¥çœ‹ä¸€æ®µæˆ‘ä»¬åœ¨ Vue ç»„ä»¶ä¸­ç»å¸¸å†™çš„äº‹ä»¶ç»‘å®šä»£ç ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div ref="divRef"&gt;&lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import { ref, onMounted, onUnmounted } from "vue";
const divRef = ref();
onMounted(() =&gt; {
  divRef.value.addEventListener("click", (e) =&gt; {
    console.log(e);
  });
});
onUnmounted(() =&gt; {
  divRef.value.removeEventListener("click");
});
&lt;/script&gt;
</code></pre>
<p>è¿™æ®µä»£ç çœ‹ä¼¼ç®€å•ï¼Œä½†å­˜åœ¨ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li><strong>ä»£ç é‡å¤</strong>ï¼šæ¯ä¸ªéœ€è¦äº‹ä»¶ç»‘å®šçš„ç»„ä»¶éƒ½è¦å†™ç±»ä¼¼çš„<code>onMounted</code>å’Œ<code>onUnmounted</code>é€»è¾‘</li>
<li><strong>æ‰‹åŠ¨ç®¡ç†</strong>ï¼šå¿…é¡»æ‰‹åŠ¨è°ƒç”¨<code>removeEventListener</code>ï¼Œå®¹æ˜“é—æ¼å¯¼è‡´å†…å­˜æ³„æ¼</li>
<li><strong>ç¼ºä¹çµæ´»æ€§</strong>ï¼šæ— æ³•å¾ˆå¥½åœ°å¤„ç†åŠ¨æ€æ¸²æŸ“çš„ DOM å…ƒç´ ï¼ˆå¦‚ v-if æ§åˆ¶çš„å…ƒç´ ï¼‰</li>
<li><strong>ç±»å‹ä¸å®‰å…¨</strong>ï¼šäº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„äº‹ä»¶å¯¹è±¡ç¼ºä¹ç±»å‹æç¤º</li>
</ol>
<h3 data-id="heading-3">ğŸ’¡ è§£å†³æ–¹æ¡ˆï¼šå°è£…é€šç”¨äº‹ä»¶ç›‘å¬ Hook</h3>
<p>é’ˆå¯¹ä¸Šè¿°é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å°è£…ä¸€ä¸ªé€šç”¨çš„äº‹ä»¶ç›‘å¬ Hookâ€”â€”<code>useEventListener</code>ï¼Œåˆ©ç”¨ Vue3 çš„<code>watch</code>API æ¥è‡ªåŠ¨ç®¡ç†äº‹ä»¶çš„ç”Ÿå‘½å‘¨æœŸã€‚</p>
<h4 data-id="heading-4">æ ¸å¿ƒå®ç°æ€è·¯</h4>
<ol>
<li><strong>è‡ªåŠ¨æ¸…ç†æœºåˆ¶</strong>ï¼šåˆ©ç”¨<code>watch</code>çš„<code>onClear</code>å›è°ƒå®ç°äº‹ä»¶çš„è‡ªåŠ¨è§£ç»‘</li>
<li><strong>åŠ¨æ€ç›®æ ‡æ”¯æŒ</strong>ï¼šåŒæ—¶æ”¯æŒ window å¯¹è±¡å’Œ DOM å…ƒç´ ä½œä¸ºäº‹ä»¶ç›®æ ‡</li>
<li><strong>å“åº”å¼å¤„ç†</strong>ï¼šé€šè¿‡<code>watch</code>ç›‘å¬ç›®æ ‡å…ƒç´ çš„å˜åŒ–ï¼Œæ”¯æŒåŠ¨æ€ DOM</li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šä½¿ç”¨ TypeScript çš„å‡½æ•°é‡è½½æä¾›å®Œæ•´çš„ç±»å‹æç¤º</li>
</ol>
<h4 data-id="heading-5">åŸºç¡€ç‰ˆæœ¬å®ç°</h4>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { watch, unref } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useEventListener</span>(<span class="hljs-params">...args</span>) {
  <span class="hljs-comment">// åˆ¤æ–­ç›®æ ‡ï¼šå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™ç›®æ ‡ä¸ºwindowï¼›å¦åˆ™ä¸ºä¼ å…¥çš„DOMå…ƒç´ </span>
  <span class="hljs-keyword">const</span> target = <span class="hljs-keyword">typeof</span> args[<span class="hljs-number">0</span>] === <span class="hljs-string">"string"</span> ? <span class="hljs-variable language_">window</span> : args.<span class="hljs-title function_">shift</span>();

  <span class="hljs-comment">// ä½¿ç”¨watchç›‘å¬ç›®æ ‡å…ƒç´ çš„å˜åŒ–</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">watch</span>(
    <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">unref</span>(target),
    <span class="hljs-function">(<span class="hljs-params">element, _, onClear</span>) =&gt;</span> {
      <span class="hljs-comment">// å¤„ç†DOMä¸å­˜åœ¨çš„æƒ…å†µï¼ˆå¦‚v-ifåˆå§‹ä¸ºfalseï¼‰</span>
      <span class="hljs-keyword">if</span> (!element) <span class="hljs-keyword">return</span>;

      <span class="hljs-comment">// ç»‘å®šäº‹ä»¶</span>
      element.<span class="hljs-title function_">addEventListener</span>(...args);

      <span class="hljs-comment">// æ¸…ç†å‡½æ•°ï¼šåœ¨ç»„ä»¶å¸è½½æˆ–watchåœæ­¢æ—¶æ‰§è¡Œ</span>
      <span class="hljs-title function_">onClear</span>(<span class="hljs-function">() =&gt;</span> {
        element.<span class="hljs-title function_">removeEventListener</span>(...args);
      });
    },
    {
      <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// ç«‹å³æ‰§è¡Œ</span>
    }
  );
}
</code></pre>
<h4 data-id="heading-6">ç”¨æ³•ç¤ºä¾‹</h4>
<p>å°è£…å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼ä½¿ç”¨è¿™ä¸ª Hookï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// 1. ç»™windowç»‘å®šäº‹ä»¶</span>
<span class="hljs-title function_">useEventListener</span>(<span class="hljs-string">"click"</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Window clicked!"</span>), options);

<span class="hljs-comment">// 2. ç»™æŒ‡å®šDOMå…ƒç´ ç»‘å®šäº‹ä»¶</span>
<span class="hljs-title function_">useEventListener</span>(domRef, <span class="hljs-string">"click"</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"DOM clicked!"</span>), options);
</code></pre>
<p>å¦‚æœéœ€è¦æ‰‹åŠ¨ç»“æŸäº‹ä»¶ç›‘å¬ï¼Œå¯ä»¥è°ƒç”¨è¿”å›çš„<code>stop</code>æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> handle = <span class="hljs-title function_">useEventListener</span>(domRef, <span class="hljs-string">"click"</span>, <span class="hljs-function">() =&gt;</span> {});
<span class="hljs-comment">// æ‰‹åŠ¨ç»ˆæ­¢ç›‘å¬</span>
handle.<span class="hljs-title function_">stop</span>();
</code></pre>
<h3 data-id="heading-7">ğŸš€ è¿›é˜¶ä¼˜åŒ–ï¼šå‡½æ•°é‡è½½å®ç°ç±»å‹å®‰å…¨</h3>
<p>åŸºç¡€ç‰ˆæœ¬è™½ç„¶åŠŸèƒ½å®Œæ•´ï¼Œä½†åœ¨ TypeScript ç¯å¢ƒä¸‹ä½¿ç”¨æ—¶ç¼ºä¹ç±»å‹æç¤ºï¼Œè¿™ä¼šå½±å“å¼€å‘ä½“éªŒã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ TypeScript çš„<strong>å‡½æ•°é‡è½½</strong>ç‰¹æ€§ã€‚</p>
<h4 data-id="heading-8">å‡½æ•°é‡è½½çš„å®šä¹‰</h4>
<p>å‡½æ•°é‡è½½å…è®¸æˆ‘ä»¬ä¸ºåŒä¸€ä¸ªå‡½æ•°æä¾›å¤šä¸ªç±»å‹å®šä¹‰ï¼ŒTypeScript ä¼šæ ¹æ®ä¼ å…¥çš„å‚æ•°ç±»å‹è‡ªåŠ¨é€‰æ‹©åŒ¹é…çš„é‡è½½ç‰ˆæœ¬ã€‚</p>
<h4 data-id="heading-9">ç±»å‹å®‰å…¨ç‰ˆæœ¬å®ç°</h4>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { watch, unref, <span class="hljs-title class_">Ref</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;

<span class="hljs-comment">// é‡è½½1ï¼šç»™windowç»‘å®šäº‹ä»¶</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> useEventListener&lt;K <span class="hljs-keyword">extends</span> keyof <span class="hljs-title class_">WindowEventMap</span>&gt;(
  <span class="hljs-attr">type</span>: K,
  <span class="hljs-attr">handle</span>: <span class="hljs-function">(<span class="hljs-params">event: WindowEventMap[K]</span>) =&gt;</span> <span class="hljs-built_in">void</span>,
  options?: <span class="hljs-built_in">boolean</span> | <span class="hljs-title class_">AddEventListenerOptions</span>
);

<span class="hljs-comment">// é‡è½½2ï¼šç»™æŒ‡å®šDOMå…ƒç´ ç»‘å®šäº‹ä»¶</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> useEventListener&lt;K <span class="hljs-keyword">extends</span> keyof <span class="hljs-title class_">HTMLElementEventMap</span>&gt;(
  <span class="hljs-attr">target</span>: <span class="hljs-title class_">Ref</span>&lt;<span class="hljs-title class_">HTMLElement</span> | <span class="hljs-literal">null</span>&gt;,
  <span class="hljs-attr">type</span>: K,
  <span class="hljs-attr">handle</span>: <span class="hljs-function">(<span class="hljs-params">event: HTMLElementEventMap[K]</span>) =&gt;</span> <span class="hljs-built_in">void</span>,
  options?: <span class="hljs-built_in">boolean</span> | <span class="hljs-title class_">AddEventListenerOptions</span>
);

<span class="hljs-comment">// é€šç”¨å®ç°</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useEventListener</span>(<span class="hljs-params">...args: <span class="hljs-built_in">any</span>[]</span>) {
  <span class="hljs-comment">// åˆ¤æ–­ç›®æ ‡ï¼šå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™ç›®æ ‡ä¸ºwindowï¼›å¦åˆ™ä¸ºä¼ å…¥çš„DOMå…ƒç´ </span>
  <span class="hljs-keyword">const</span> target = <span class="hljs-keyword">typeof</span> args[<span class="hljs-number">0</span>] === <span class="hljs-string">"string"</span> ? <span class="hljs-variable language_">window</span> : args.<span class="hljs-title function_">shift</span>();

  <span class="hljs-comment">// ä½¿ç”¨watchç›‘å¬ç›®æ ‡å…ƒç´ çš„å˜åŒ–</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">watch</span>(
    <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">unref</span>(target),
    <span class="hljs-function">(<span class="hljs-params">element, _, onClear</span>) =&gt;</span> {
      <span class="hljs-comment">// å¤„ç†DOMä¸å­˜åœ¨çš„æƒ…å†µï¼ˆå¦‚v-ifåˆå§‹ä¸ºfalseï¼‰</span>
      <span class="hljs-keyword">if</span> (!element) <span class="hljs-keyword">return</span>;

      <span class="hljs-comment">// ç»‘å®šäº‹ä»¶</span>
      element.<span class="hljs-title function_">addEventListener</span>(...args);

      <span class="hljs-comment">// æ¸…ç†å‡½æ•°ï¼šåœ¨ç»„ä»¶å¸è½½æˆ–watchåœæ­¢æ—¶æ‰§è¡Œ</span>
      <span class="hljs-title function_">onClear</span>(<span class="hljs-function">() =&gt;</span> {
        element.<span class="hljs-title function_">removeEventListener</span>(...args);
      });
    },
    {
      <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// ç«‹å³æ‰§è¡Œ</span>
    }
  );
}
</code></pre>
<h4 data-id="heading-10">ç±»å‹é‡è½½çš„ä¼˜åŠ¿</h4>
<ol>
<li><strong>æ™ºèƒ½æç¤º</strong>ï¼šIDE ä¼šæ ¹æ®ä¼ å…¥çš„å‚æ•°ç±»å‹æä¾›å¯¹åº”çš„äº‹ä»¶åç§°å’Œäº‹ä»¶å¯¹è±¡ç±»å‹æç¤º</li>
<li><strong>ç±»å‹æ£€æŸ¥</strong>ï¼šTypeScript ä¼šæ£€æŸ¥äº‹ä»¶å¤„ç†å‡½æ•°çš„å‚æ•°ç±»å‹æ˜¯å¦æ­£ç¡®</li>
<li><strong>é”™è¯¯é¢„é˜²</strong>ï¼šé¿å…ä¼ å…¥ä¸å­˜åœ¨çš„äº‹ä»¶ç±»å‹æˆ–é”™è¯¯çš„äº‹ä»¶å¤„ç†å‡½æ•°ç­¾å</li>
</ol>
<h3 data-id="heading-11">ğŸ¯ æŠ€æœ¯æ·±åº¦è§£æ</h3>
<h4 data-id="heading-12">1. Watch API çš„é«˜çº§ç”¨æ³•</h4>
<p>åœ¨è¿™ä¸ª Hook ä¸­ï¼Œæˆ‘ä»¬å……åˆ†åˆ©ç”¨äº† Vue3 <code>watch</code> API çš„é«˜çº§ç‰¹æ€§ï¼š</p>
<ul>
<li><strong>å“åº”å¼ç›‘å¬</strong>ï¼šé€šè¿‡<code>unref(target)</code>ç¡®ä¿å¯ä»¥åŒæ—¶å¤„ç† ref å’Œæ™®é€šå€¼</li>
<li><strong>immediate é€‰é¡¹</strong>ï¼šç¡®ä¿ç»„ä»¶æŒ‚è½½åç«‹å³ç»‘å®šäº‹ä»¶</li>
<li><strong>onClear å›è°ƒ</strong>ï¼šæä¾›äº†å¯é çš„æ¸…ç†æœºåˆ¶ï¼Œé¿å…å†…å­˜æ³„æ¼</li>
</ul>
<h4 data-id="heading-13">2. TypeScript ç±»å‹ç³»ç»Ÿçš„å¼ºå¤§</h4>
<ul>
<li><strong>äº‹ä»¶æ˜ å°„ç±»å‹</strong>ï¼š<code>WindowEventMap</code>å’Œ<code>HTMLElementEventMap</code>æä¾›äº†æµè§ˆå™¨åŸç”Ÿäº‹ä»¶çš„å®Œæ•´ç±»å‹å®šä¹‰</li>
<li><strong>æ³›å‹çº¦æŸ</strong>ï¼šä½¿ç”¨<code>K extends keyof EventMap</code>ç¡®ä¿äº‹ä»¶ç±»å‹çš„æ­£ç¡®æ€§</li>
<li><strong>å‡½æ•°é‡è½½</strong>ï¼šä¸ºä¸åŒçš„ä½¿ç”¨åœºæ™¯æä¾›ç²¾ç¡®çš„ç±»å‹å®šä¹‰</li>
</ul>
<h4 data-id="heading-14">3. è‡ªåŠ¨æ¸…ç†æœºåˆ¶çš„åŸç†</h4>
<p>å½“ä»¥ä¸‹æƒ…å†µå‘ç”Ÿæ—¶ï¼Œ<code>onClear</code>å›è°ƒä¼šè¢«è‡ªåŠ¨è°ƒç”¨ï¼š</p>
<ul>
<li>ç»„ä»¶å¸è½½æ—¶</li>
<li>è°ƒç”¨è¿”å›çš„<code>stop</code>æ–¹æ³•æ—¶</li>
<li>ç›‘å¬çš„ç›®æ ‡å…ƒç´ å‘ç”Ÿå˜åŒ–æ—¶</li>
</ul>
<p>è¿™ç§æœºåˆ¶ç¡®ä¿äº†äº‹ä»¶ç›‘å¬å§‹ç»ˆä¸ç»„ä»¶ç”Ÿå‘½å‘¨æœŸåŒæ­¥ï¼Œå½»åº•é¿å…äº†å†…å­˜æ³„æ¼ã€‚</p>
<h3 data-id="heading-15">ğŸ“ æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹</h3>
<h4 data-id="heading-16">1. äº‹ä»¶å¤„ç†å‡½æ•°çš„æ³¨æ„äº‹é¡¹</h4>
<ul>
<li><strong>é¿å…ç®­å¤´å‡½æ•°é™·é˜±</strong>ï¼šå¦‚æœéœ€è¦åœ¨äº‹ä»¶å¤„ç†å‡½æ•°ä¸­è®¿é—®<code>this</code>ï¼Œåº”ä½¿ç”¨æ™®é€šå‡½æ•°</li>
<li><strong>äº‹ä»¶å¯¹è±¡çš„æ­£ç¡®ä½¿ç”¨</strong>ï¼šåˆ©ç”¨ TypeScript çš„ç±»å‹ç³»ç»Ÿç¡®ä¿äº‹ä»¶å¯¹è±¡çš„å±æ€§è®¿é—®å®‰å…¨</li>
</ul>
<h4 data-id="heading-17">2. æ€§èƒ½ä¼˜åŒ–å»ºè®®</h4>
<ul>
<li><strong>äº‹ä»¶å§”æ‰˜</strong>ï¼šå¯¹äºå¤§é‡ç›¸ä¼¼å…ƒç´ ï¼Œä¼˜å…ˆè€ƒè™‘äº‹ä»¶å§”æ‰˜è€Œä¸æ˜¯ä¸ºæ¯ä¸ªå…ƒç´ å•ç‹¬ç»‘å®šäº‹ä»¶</li>
<li><strong>åˆç†ä½¿ç”¨äº‹ä»¶é€‰é¡¹</strong>ï¼šæ ¹æ®éœ€è¦è®¾ç½®<code>passive</code>ã€<code>capture</code>ç­‰é€‰é¡¹ä¼˜åŒ–æ€§èƒ½</li>
</ul>
<h4 data-id="heading-18">3. æ‰©å±•ä½¿ç”¨åœºæ™¯</h4>
<ul>
<li><strong>è‡ªå®šä¹‰äº‹ä»¶</strong>ï¼šå¯ä»¥æ‰©å±•æ”¯æŒè‡ªå®šä¹‰äº‹ä»¶çš„ç±»å‹å®šä¹‰</li>
<li><strong>ç»„ä»¶äº‹ä»¶</strong>ï¼šç»“åˆ Vue çš„ç»„ä»¶äº‹ä»¶ç³»ç»Ÿä½¿ç”¨</li>
<li><strong>ç¬¬ä¸‰æ–¹åº“é›†æˆ</strong>ï¼šä¸ Chart.jsã€Mapbox ç­‰ç¬¬ä¸‰æ–¹åº“çš„äº‹ä»¶ç³»ç»Ÿé›†æˆ</li>
</ul>
<h3 data-id="heading-19">ğŸ”§ å®æˆ˜æ¡ˆä¾‹ï¼šå®æ—¶é”®ç›˜ç›‘å¬</h3>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®é™…æ¡ˆä¾‹æ¥å±•ç¤º<code>useEventListener</code>çš„å¼ºå¤§åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div&gt;
    &lt;h2&gt;é”®ç›˜ç›‘å¬æ¼”ç¤º&lt;/h2&gt;
    &lt;p&gt;å½“å‰æŒ‰ä¸‹çš„é”®ï¼š{{ pressedKey }}&lt;/p&gt;
    &lt;p&gt;æŒ‰ä¸‹æ¬¡æ•°ï¼š{{ pressCount }}&lt;/p&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import { ref } from "vue";
import { useEventListener } from "./useEventListener";

const pressedKey = ref("");
const pressCount = ref(0);

// ä½¿ç”¨é€šç”¨äº‹ä»¶ç›‘å¬Hook
useEventListener(
  "keydown",
  (event: KeyboardEvent) =&gt; {
    pressedKey.value = event.key;
    pressCount.value++;
  },
  { passive: true }
);
&lt;/script&gt;
</code></pre>
<p>è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•è½»æ¾å®ç°ä¸€ä¸ªå®æ—¶é”®ç›˜ç›‘å¬åŠŸèƒ½ï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†äº‹ä»¶çš„ç»‘å®šä¸è§£ç»‘ã€‚</p>
<h3 data-id="heading-20">ğŸ“š æ‰©å±•é˜…è¯»</h3>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fguide%2Fessentials%2Fwatchers.html" target="_blank" title="https://vuejs.org/guide/essentials/watchers.html" ref="nofollow noopener noreferrer">Vue3 Composition API - Watch</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.typescriptlang.org%2Fdocs%2Fhandbook%2F2%2Ffunctions.html%23function-overloads" target="_blank" title="https://www.typescriptlang.org/docs/handbook/2/functions.html#function-overloads" ref="nofollow noopener noreferrer">TypeScript å‡½æ•°é‡è½½</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FEventTarget%2FaddEventListener" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget/addEventListener" ref="nofollow noopener noreferrer">DOM äº‹ä»¶ API</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FPerformance%2FMemory_management" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/Performance/Memory_management" ref="nofollow noopener noreferrer">å‰ç«¯å†…å­˜æ³„æ¼æ’æŸ¥ä¸è§£å†³</a></li>
</ol>
<h3 data-id="heading-21">ğŸ’­ æ€è€ƒé¢˜</h3>
<ol>
<li>å¦‚ä½•æ‰©å±•è¿™ä¸ª Hook ä»¥æ”¯æŒè‡ªå®šä¹‰äº‹ä»¶ç±»å‹ï¼Ÿ</li>
<li>å¦‚æœéœ€è¦åŒæ—¶ç›‘å¬å¤šä¸ªäº‹ä»¶ï¼Œåº”è¯¥å¦‚ä½•ä¼˜åŒ–å®ç°ï¼Ÿ</li>
<li>å¦‚ä½•å°†è¿™ä¸ª Hook ä¸ Vue çš„å“åº”å¼ç³»ç»Ÿæ›´å¥½åœ°ç»“åˆï¼Ÿ</li>
</ol>
<h3 data-id="heading-22">ğŸ‰ æ€»ç»“</h3>
<p>é€šè¿‡æœ¬æ–‡çš„ä»‹ç»ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•åˆ©ç”¨ Vue3 çš„<code>watch</code>API å’Œ TypeScript çš„å‡½æ•°é‡è½½ç‰¹æ€§ï¼Œæ‰“é€ ä¸€ä¸ªç±»å‹å®‰å…¨ã€è‡ªåŠ¨æ¸…ç†çš„é€šç”¨äº‹ä»¶ç›‘å¬ Hookã€‚è¿™ä¸ª Hook ä¸ä»…è§£å†³äº†åŸç”Ÿäº‹ä»¶ç»‘å®šçš„ç—›ç‚¹ï¼Œè¿˜æä¾›äº†è‰¯å¥½çš„å¼€å‘ä½“éªŒå’Œç±»å‹æ”¯æŒã€‚</p>
<p>æ ¸å¿ƒæŠ€æœ¯ç‚¹å›é¡¾ï¼š</p>
<ul>
<li><strong>å‡½æ•°é‡è½½</strong>ï¼šæä¾›ç²¾ç¡®çš„ç±»å‹å®šä¹‰å’Œæ™ºèƒ½æç¤º</li>
<li><strong>Watch API</strong>ï¼šå®ç°å“åº”å¼ç›‘å¬å’Œè‡ªåŠ¨æ¸…ç†</li>
<li><strong>è‡ªåŠ¨ç®¡ç†</strong>ï¼šäº‹ä»¶ç”Ÿå‘½å‘¨æœŸä¸ç»„ä»¶åŒæ­¥ï¼Œé¿å…å†…å­˜æ³„æ¼</li>
<li><strong>çµæ´»ä½¿ç”¨</strong>ï¼šæ”¯æŒ window å’Œ DOM å…ƒç´ ï¼Œé€‚åº”å„ç§åœºæ™¯</li>
</ul>
<p>è¿™ä¸ªç®€å•è€Œå¼ºå¤§çš„ Hook å±•ç¤ºäº† Vue3 Composition API çš„çµæ´»æ€§å’Œ TypeScript ç±»å‹ç³»ç»Ÿçš„å¼ºå¤§ï¼Œæ˜¯æˆ‘ä»¬åœ¨æ—¥å¸¸å¼€å‘ä¸­å€¼å¾—æŒæ¡çš„é«˜çº§æŠ€å·§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç¨³å®šæ€§æ€§èƒ½ç³»åˆ—ä¹‹äºŒâ€”â€”ANRæœºåˆ¶æ·±åº¦è§£æ:ä»è§¦å‘åˆ°ä¸ŠæŠ¥]]></title>    <link>https://juejin.cn/post/7588034035287080975</link>    <guid>https://juejin.cn/post/7588034035287080975</guid>    <pubDate>2025-12-27T06:51:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588034035287080975" data-draft-id="7587776610437152783" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç¨³å®šæ€§æ€§èƒ½ç³»åˆ—ä¹‹äºŒâ€”â€”ANRæœºåˆ¶æ·±åº¦è§£æ:ä»è§¦å‘åˆ°ä¸ŠæŠ¥"/> <meta itemprop="keywords" content="æ€§èƒ½ä¼˜åŒ–,Android,Debug"/> <meta itemprop="datePublished" content="2025-12-27T06:51:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†¬å¥‡Lab"/> <meta itemprop="url" content="https://juejin.cn/user/1857501105781193"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç¨³å®šæ€§æ€§èƒ½ç³»åˆ—ä¹‹äºŒâ€”â€”ANRæœºåˆ¶æ·±åº¦è§£æ:ä»è§¦å‘åˆ°ä¸ŠæŠ¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1857501105781193/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†¬å¥‡Lab
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T06:51:24.000Z" title="Sat Dec 27 2025 06:51:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»23åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€:é‚£ä¸ªè®©äººåˆçˆ±åˆæ¨çš„ANR Dialog</h2>
<p>è¿˜è®°å¾—ç¬¬ä¸€æ¬¡çœ‹åˆ°ANR Dialogå—?</p>
<p>"<strong>åº”ç”¨XXæ— å“åº”,æ˜¯å¦å…³é—­?</strong>"</p>
<p>ä½œä¸ºç”¨æˆ·,è¿™ä¸ªå¯¹è¯æ¡†è®©äººæŠ“ç‹‚â€”â€”åº”ç”¨å¡ä½äº†,ä»€ä¹ˆéƒ½åšä¸äº†ã€‚ä½†ä½œä¸ºå¼€å‘è€…,è¿™ä¸ªå¯¹è¯æ¡†å´æ˜¯æ•‘å‘½ç¨»è‰â€”â€”è‡³å°‘å®ƒå‘Šè¯‰ä½ å‡ºé—®é¢˜äº†,è¿˜ç»™ä½ ç•™ä¸‹äº†traces.txtè¿™ä¸ª"ä½œæ¡ˆç°åœº"ã€‚</p>
<p>æˆ‘æ›¾ç»é‡åˆ°è¿‡ä¸€ä¸ªè®©äººå¤´ç–¼çš„ANR:ç”¨æˆ·åœ¨è®¾ç½®ç•Œé¢åˆ‡æ¢WiFiæ—¶,æ•´ä¸ªç³»ç»Ÿç•Œé¢å°±å¡æ­»äº†ã€‚çœ‹logcat,å‘ç°ä¸»çº¿ç¨‹åœ¨ç­‰ä¸€ä¸ªé”;å†çœ‹traces.txt,å‘ç°æŒé”çš„çº¿ç¨‹æ­£åœ¨è¿›è¡ŒBinderè°ƒç”¨;ç»§ç»­è¿½è¸ª,åŸæ¥æ˜¯ContentObserveræ³¨å†Œè¿‡å¤šå¯¼è‡´çš„Binderèµ„æºè€—å°½...è¿™å°±åƒä¸€åœºä¾¦æ¢æ¸¸æˆ,è€ŒANR Dialogæ˜¯æ¡ˆä»¶çš„èµ·ç‚¹ã€‚</p>
<p>æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥ANRæœºåˆ¶çš„å†…éƒ¨,ä»Inputäº‹ä»¶åˆ†å‘åˆ°è¶…æ—¶æ£€æµ‹,ä»tracesä¿¡æ¯æ”¶é›†åˆ°Dialogå¼¹å‡º,å®Œæ•´å‰–æANRçš„å…¨ç”Ÿå‘½å‘¨æœŸã€‚è¯»å®Œæœ¬æ–‡,ä½ å°†èƒ½å¤Ÿ:</p>
<ol>
<li>ç†è§£ANRçš„4ç§ç±»å‹åŠå…¶è¶…æ—¶æ—¶é—´</li>
<li>æŒæ¡InputDispatcherå¦‚ä½•æ£€æµ‹Input ANR</li>
<li>äº†è§£ActivityManagerServiceå¦‚ä½•å¤„ç†ANR</li>
<li>å­¦ä¼šåˆ†ætraces.txtå’Œæ‰¾åˆ°æ ¹å› </li>
<li>æ„å»ºANRç›‘æ§å’Œé¢„é˜²æœºåˆ¶</li>
</ol>
<p>å‡†å¤‡å¥½äº†å—?è®©æˆ‘ä»¬æ­å¼€ANRæœºåˆ¶çš„ç¥ç§˜é¢çº±!</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€ANRåŸºç¡€æ¦‚å¿µ</h2>
<h3 data-id="heading-2">1.1 ä»€ä¹ˆæ˜¯ANR?</h3>
<p>ANR (Application Not Responding) æ˜¯Androidç³»ç»Ÿçš„ä¸€ç§ä¿æŠ¤æœºåˆ¶ã€‚å½“åº”ç”¨åœ¨è§„å®šæ—¶é—´å†…æ²¡æœ‰å“åº”ç”¨æˆ·æ“ä½œæˆ–ç³»ç»Ÿäº‹ä»¶æ—¶,ç³»ç»Ÿä¼šè®¤ä¸ºåº”ç”¨"æ­»äº†",å¼¹å‡ºANRå¯¹è¯æ¡†è®©ç”¨æˆ·é€‰æ‹©æ˜¯ç»§ç»­ç­‰å¾…è¿˜æ˜¯å¼ºåˆ¶å…³é—­ã€‚</p>
<p>æ‰“ä¸ªæ¯”æ–¹:ANRå°±åƒé¤å…çš„"ä¸Šèœè¶…æ—¶æé†’"ã€‚ä½ ç‚¹äº†ä¸€é“èœ,å¦‚æœå¨æˆ¿5åˆ†é’Ÿè¿˜æ²¡ä¸Šèœ,æœåŠ¡å‘˜å°±ä¼šè¿‡æ¥è¯¢é—®"è¦ä¸è¦ç»§ç»­ç­‰,è¿˜æ˜¯æ¢ä¸€é“èœ"ã€‚è¿™é¿å…äº†ä½ æ— é™æœŸåœ°ç­‰ä¸‹å»ã€‚</p>
<p><strong>ANRçš„æ ¸å¿ƒä½œç”¨</strong>:</p>
<ul>
<li><strong>ä¿æŠ¤ç”¨æˆ·ä½“éªŒ</strong>: é¿å…åº”ç”¨é•¿æ—¶é—´æ— å“åº”</li>
<li><strong>åŠæ—¶å‘ç°é—®é¢˜</strong>: é€šè¿‡traces.txtè®°å½•"ä½œæ¡ˆç°åœº"</li>
<li><strong>ç³»ç»Ÿè‡ªæˆ‘ä¿æŠ¤</strong>: é˜²æ­¢å•ä¸ªåº”ç”¨æ‹–å®æ•´ä¸ªç³»ç»Ÿ</li>
</ul>
<h3 data-id="heading-3">1.2 ANRçš„4ç§ç±»å‹</h3>
<p>Androidç³»ç»Ÿå¯¹ä¸åŒç±»å‹çš„äº‹ä»¶è®¾ç½®äº†ä¸åŒçš„è¶…æ—¶æ—¶é—´:</p>



































<table><thead><tr><th>ANRç±»å‹</th><th>è¶…æ—¶æ—¶é—´</th><th>è§¦å‘åœºæ™¯</th><th>æ£€æµ‹ä½ç½®</th></tr></thead><tbody><tr><td><strong>Input ANR</strong></td><td>5ç§’</td><td>ç”¨æˆ·è§¦æ‘¸/æŒ‰é”®äº‹ä»¶æœªè¢«å¤„ç†</td><td>InputDispatcher</td></tr><tr><td><strong>Broadcast ANR</strong></td><td>å‰å°10ç§’ / åå°60ç§’</td><td>BroadcastReceiverçš„onReceive()æœªæ‰§è¡Œå®Œ</td><td>ActivityManagerService</td></tr><tr><td><strong>Service ANR</strong></td><td>å‰å°20ç§’ / åå°200ç§’</td><td>Serviceçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æœªæ‰§è¡Œå®Œ</td><td>ActivityManagerService</td></tr><tr><td><strong>ContentProvider ANR</strong></td><td>10ç§’</td><td>ContentProviderå‘å¸ƒè¶…æ—¶</td><td>ActivityManagerService</td></tr></tbody></table>
<p><strong>ä¸ºä»€ä¹ˆè¶…æ—¶æ—¶é—´ä¸ä¸€æ ·?</strong></p>
<p>è¿™æ˜¯åŸºäºç”¨æˆ·ä½“éªŒå’Œç³»ç»Ÿå“åº”æ€§çš„æƒè¡¡:</p>
<ul>
<li><strong>Input ANRæœ€çŸ­(5ç§’)</strong>: ç”¨æˆ·æ“ä½œå¿…é¡»å¾—åˆ°å¿«é€Ÿåé¦ˆ,å¦åˆ™ä¼šè®¤ä¸ºè®¾å¤‡åäº†</li>
<li><strong>Broadcast ANRä¸­ç­‰(10ç§’/60ç§’)</strong>: å¹¿æ’­æ¥æ”¶å™¨æœ¬åº”è¯¥å¿«é€Ÿæ‰§è¡Œ,ä½†å…è®¸ä¸€å®šçš„å¤„ç†æ—¶é—´</li>
<li><strong>Service ANRè¾ƒé•¿(20ç§’/200ç§’)</strong>: åå°æœåŠ¡å¯ä»¥å¤„ç†è€—æ—¶æ“ä½œ,ç»™äºˆæ›´å¤šå®½å®¹</li>
<li><strong>åå°è¿›ç¨‹è¶…æ—¶æ›´é•¿</strong>: åå°æ“ä½œä¸å½±å“å‰å°ä½“éªŒ,å¯ä»¥ç­‰å¾…æ›´ä¹…</li>
</ul>
<h3 data-id="heading-4">1.3 ANR vs Freeze vs Watchdog</h3>
<p>ç»å¸¸æœ‰äººæ··æ·†è¿™å‡ ä¸ªæ¦‚å¿µ,è®©æˆ‘ä»¬å¯¹æ¯”ä¸€ä¸‹:</p>









































<table><thead><tr><th>ç‰¹æ€§</th><th>ANR</th><th>Freeze</th><th>Watchdog</th></tr></thead><tbody><tr><td><strong>æ£€æµ‹å¯¹è±¡</strong></td><td>åº”ç”¨è¿›ç¨‹</td><td>åº”ç”¨è¿›ç¨‹</td><td>System Server</td></tr><tr><td><strong>æ£€æµ‹ç»´åº¦</strong></td><td>ç‰¹å®šäº‹ä»¶å“åº”</td><td>æ•´ä½“å“åº”æ€§</td><td>æ ¸å¿ƒçº¿ç¨‹å¥åº·</td></tr><tr><td><strong>è¶…æ—¶æ—¶é—´</strong></td><td>5-200ç§’</td><td>é€šå¸¸å°äºç§’</td><td>30-60ç§’</td></tr><tr><td><strong>åæœ</strong></td><td>å¼¹å‡ºANR Dialog</td><td>å¯èƒ½è§¦å‘ANR</td><td>ç³»ç»Ÿé‡å¯</td></tr><tr><td><strong>ä½œç”¨åŸŸ</strong></td><td>å•ä¸ªåº”ç”¨</td><td>å•ä¸ªåº”ç”¨</td><td>æ•´ä¸ªç³»ç»Ÿ</td></tr></tbody></table>
<p><strong>å½¢è±¡çš„æ¯”å–»</strong>:</p>
<ul>
<li><strong>ANR</strong>: é¤å…æœåŠ¡å‘˜æ£€æŸ¥ä½ ç‚¹çš„èœæ˜¯å¦ä¸Šé½äº†</li>
<li><strong>Freeze</strong>: é¤å…ç»ç†ç›‘æ§æœåŠ¡å‘˜æ˜¯å¦åœ¨å·¥ä½œ</li>
<li><strong>Watchdog</strong>: æ¶ˆé˜²é˜Ÿå®šæ—¶å·¡æŸ¥é¤å…çš„æ¶ˆé˜²ç³»ç»Ÿæ˜¯å¦æ­£å¸¸</li>
</ul>
<hr/>
<h2 data-id="heading-5">äºŒã€Input ANRçš„å®Œæ•´æµç¨‹</h2>
<p>Input ANRæ˜¯æœ€å¸¸è§ä¹Ÿæ˜¯æœ€å…¸å‹çš„ANRç±»å‹ã€‚è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç”¨æˆ·ç‚¹å‡»æŒ‰é’®çš„åœºæ™¯,å®Œæ•´èµ°ä¸€éANRçš„æ£€æµ‹æµç¨‹ã€‚</p>
<h3 data-id="heading-6">2.1 æ•´ä½“æµç¨‹æ¦‚è§ˆ</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3890f02135fe40e5a0a4cb7daaffa516~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767424897&amp;x-signature=fPgI6qx%2BkPMhB9PzmnCNj7VOoBo%3D" alt="02-01-anr-input-flow.png" loading="lazy"/></p>
<h3 data-id="heading-7">2.2 InputReader:äº‹ä»¶çš„æºå¤´</h3>
<p>InputReaderè¿è¡Œåœ¨ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ä¸­,è´Ÿè´£ä»å†…æ ¸è¯»å–è¾“å…¥äº‹ä»¶:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// frameworks/native/services/inputflinger/reader/InputReader.cpp</span>

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">InputReader::loopOnce</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// 1. ä»/dev/input/eventXè¯»å–åŸå§‹äº‹ä»¶</span>
    <span class="hljs-type">size_t</span> count = mEventHub-&gt;<span class="hljs-built_in">getEvents</span>(timeoutMillis, mEventBuffer, EVENT_BUFFER_SIZE);

    <span class="hljs-comment">// 2. å¤„ç†æ¯ä¸ªäº‹ä»¶</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) {
        <span class="hljs-type">const</span> RawEvent&amp; rawEvent = mEventBuffer[i];

        <span class="hljs-comment">// 3. æ ¹æ®è®¾å¤‡ç±»å‹(è§¦æ‘¸å±ã€é”®ç›˜ç­‰)è½¬æ¢ä¸ºAndroidäº‹ä»¶</span>
        <span class="hljs-built_in">processEventsLocked</span>(rawEvent);
    }

    <span class="hljs-comment">// 4. å°†å¤„ç†å¥½çš„äº‹ä»¶äº¤ç»™InputDispatcher</span>
    mQueuedListener-&gt;<span class="hljs-built_in">flush</span>();
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>:</p>
<ul>
<li>InputReaderæ˜¯äº‹ä»¶çš„"æ¬è¿å·¥",åªè´Ÿè´£è¯»å–å’Œåˆæ­¥å¤„ç†</li>
<li>å®ƒä¸å…³å¿ƒäº‹ä»¶æ˜¯å¦è¢«åº”ç”¨å¤„ç†,åªç®¡å¾€å‰é€</li>
<li>çœŸæ­£çš„è¶…æ—¶æ£€æµ‹å‘ç”Ÿåœ¨InputDispatcher</li>
</ul>
<h3 data-id="heading-8">2.3 InputDispatcher:è¶…æ—¶æ£€æµ‹çš„æ ¸å¿ƒ</h3>
<p>InputDispatcheræ˜¯ANRæ£€æµ‹çš„"å¿ƒè„"ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å®ƒå¦‚ä½•æ£€æµ‹è¶…æ—¶:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// frameworks/native/services/inputflinger/dispatcher/InputDispatcher.cpp</span>

<span class="hljs-comment">// åˆ†å‘äº‹ä»¶çš„æ ¸å¿ƒé€»è¾‘</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">InputDispatcher::dispatchOnce</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">nsecs_t</span> nextWakeupTime = LONG_LONG_MAX;

    <span class="hljs-comment">// 1. ä»é˜Ÿåˆ—ä¸­å–å‡ºå¾…åˆ†å‘çš„äº‹ä»¶</span>
    <span class="hljs-keyword">if</span> (mPendingEvent == <span class="hljs-literal">nullptr</span>) {
        mPendingEvent = mInboundQueue.<span class="hljs-built_in">dequeueAtHead</span>();
    }

    <span class="hljs-comment">// 2. æ‰¾åˆ°äº‹ä»¶çš„ç›®æ ‡Window</span>
    std::vector&lt;InputTarget&gt; inputTargets;
    <span class="hljs-type">int32_t</span> injectionResult = <span class="hljs-built_in">findFocusedWindowTargetsLocked</span>(
            currentTime, mPendingEvent, inputTargets, nextWakeupTime);

    <span class="hljs-comment">// 3. åˆ†å‘äº‹ä»¶åˆ°ç›®æ ‡Window</span>
    <span class="hljs-keyword">if</span> (injectionResult == INPUT_EVENT_INJECTION_SUCCEEDED) {
        <span class="hljs-built_in">dispatchEventLocked</span>(currentTime, mPendingEvent, inputTargets);
    }

    <span class="hljs-comment">// 4. æ£€æŸ¥æ˜¯å¦æœ‰è¿æ¥è¶…æ—¶</span>
    <span class="hljs-type">nsecs_t</span> nextAnrCheck = <span class="hljs-built_in">checkUnresponsiveConnectionsLocked</span>(currentTime);
    <span class="hljs-keyword">if</span> (nextAnrCheck &lt; nextWakeupTime) {
        nextWakeupTime = nextAnrCheck;
    }
}
</code></pre>
<p><strong>è¶…æ—¶æ£€æµ‹çš„å…³é”®é€»è¾‘</strong>:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æ£€æŸ¥è¿æ¥æ˜¯å¦å“åº”</span>
<span class="hljs-function"><span class="hljs-type">nsecs_t</span> <span class="hljs-title">InputDispatcher::checkUnresponsiveConnectionsLocked</span><span class="hljs-params">(<span class="hljs-type">nsecs_t</span> currentTime)</span> </span>{
    <span class="hljs-type">nsecs_t</span> nextAnrCheck = LONG_LONG_MAX;

    <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; [token, connection] : mConnectionsByToken) {
        <span class="hljs-comment">// æ£€æŸ¥è¿™ä¸ªè¿æ¥çš„ç­‰å¾…é˜Ÿåˆ—</span>
        <span class="hljs-keyword">if</span> (connection-&gt;waitQueue.<span class="hljs-built_in">empty</span>()) {
            <span class="hljs-keyword">continue</span>;
        }

        <span class="hljs-comment">// è·å–é˜Ÿå¤´äº‹ä»¶</span>
        DispatchEntry* head = connection-&gt;waitQueue.head;
        <span class="hljs-type">nsecs_t</span> eventTime = head-&gt;eventEntry-&gt;eventTime;

        <span class="hljs-comment">// è®¡ç®—ç­‰å¾…æ—¶é—´</span>
        <span class="hljs-type">nsecs_t</span> waitDuration = currentTime - eventTime;

        <span class="hljs-comment">// å¦‚æœè¶…è¿‡5ç§’(5000ms),è§¦å‘ANR</span>
        <span class="hljs-keyword">if</span> (waitDuration &gt; <span class="hljs-number">5000</span>ms) {
            <span class="hljs-built_in">onAnrLocked</span>(connection);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// è®°å½•ä¸‹æ¬¡æ£€æŸ¥æ—¶é—´</span>
            <span class="hljs-type">nsecs_t</span> timeoutTime = eventTime + <span class="hljs-number">5000</span>ms;
            <span class="hljs-keyword">if</span> (timeoutTime &lt; nextAnrCheck) {
                nextAnrCheck = timeoutTime;
            }
        }
    }

    <span class="hljs-keyword">return</span> nextAnrCheck;
}
</code></pre>
<p><strong>ç²¾å¦™çš„è®¾è®¡</strong>:</p>
<ol>
<li><strong>äº‹ä»¶å…¥é˜Ÿåˆ—æ—¶è®°å½•æ—¶é—´æˆ³</strong>: æ¯ä¸ªäº‹ä»¶åˆ†å‘æ—¶,éƒ½ä¼šè®°å½•<code>eventTime</code></li>
<li><strong>å®šæ—¶æ£€æŸ¥é˜Ÿå¤´äº‹ä»¶</strong>: InputDispatcherä¼šå®šæœŸæ£€æŸ¥waitQueueçš„é˜Ÿå¤´</li>
<li><strong>è®¡ç®—ç­‰å¾…æ—¶é•¿</strong>: <code>waitDuration = currentTime - eventTime</code></li>
<li><strong>è¶…æ—¶è§¦å‘ANR</strong>: å¦‚æœç­‰å¾…è¶…è¿‡5ç§’,è°ƒç”¨<code>onAnrLocked()</code></li>
</ol>
<p><strong>ä¸ºä»€ä¹ˆæ£€æŸ¥é˜Ÿå¤´è€Œä¸æ˜¯é˜Ÿå°¾?</strong></p>
<p>å› ä¸ºé˜Ÿå¤´æ˜¯æœ€æ—©å‘é€çš„äº‹ä»¶,å¦‚æœé˜Ÿå¤´éƒ½è¿˜æ²¡å¤„ç†å®Œ,è¯´æ˜åº”ç”¨çœŸçš„å¡ä½äº†ã€‚è¿™å°±åƒæ’é˜Ÿä¹°ç¥¨:å¦‚æœé˜Ÿä¼æœ€å‰é¢çš„äººè¿˜åœ¨åŠç†,åé¢çš„äººè‡ªç„¶ä¹Ÿèµ°ä¸äº†ã€‚</p>
<h3 data-id="heading-9">2.4 ç­‰å¾…é˜Ÿåˆ—(waitQueue)çš„ç§˜å¯†</h3>
<p>ç†è§£waitQueueæ˜¯ç†è§£Input ANRçš„å…³é”®:</p>
<pre><code class="hljs language-ini" lang="ini">waitQueueçš„ç”Ÿå‘½å‘¨æœŸ:

1. äº‹ä»¶å‘é€å‰
   waitQueue: <span class="hljs-section">[]</span>

2. äº‹ä»¶å‘é€ç»™åº”ç”¨
   dispatchEntryå…¥é˜Ÿ
   waitQueue: <span class="hljs-section">[Event1]</span>
   è®°å½•<span class="hljs-attr">Event1.eventTime</span> = T0

3. åº”ç”¨å¤„ç†äº‹ä»¶(æ­£å¸¸æƒ…å†µ)
   åº”ç”¨è°ƒç”¨finish()
   waitQueue: <span class="hljs-section">[]</span>  â† Event1è¢«ç§»é™¤

4. åº”ç”¨å¡ä½(å¼‚å¸¸æƒ…å†µ)
   T0 + 5ç§’å
   waitQueue: <span class="hljs-section">[Event1]</span>  â† Event1è¿˜åœ¨!
   InputDispatcheræ£€æµ‹åˆ°è¶…æ—¶
   è§¦å‘ANR
</code></pre>
<p><strong>ä»£ç å®ç°</strong>:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// åº”ç”¨å¤„ç†å®Œäº‹ä»¶åè°ƒç”¨</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">InputDispatcher::finishDispatchCycleLocked</span><span class="hljs-params">(
        <span class="hljs-type">nsecs_t</span> currentTime, sp&lt;Connection&gt; connection)</span> </span>{
    <span class="hljs-comment">// ä»waitQueueç§»é™¤å·²å¤„ç†çš„äº‹ä»¶</span>
    <span class="hljs-keyword">while</span> (!connection-&gt;waitQueue.<span class="hljs-built_in">empty</span>()) {
        DispatchEntry* dispatchEntry = connection-&gt;waitQueue.head;
        connection-&gt;waitQueue.<span class="hljs-built_in">dequeue</span>(dispatchEntry);

        <span class="hljs-comment">// é‡Šæ”¾èµ„æº</span>
        <span class="hljs-built_in">releaseDispatchEntry</span>(dispatchEntry);

        <span class="hljs-comment">// å¦‚æœè¿™æ˜¯æœ€åä¸€ä¸ªäº‹ä»¶,é‡ç½®è¶…æ—¶æ£€æŸ¥</span>
        <span class="hljs-keyword">if</span> (connection-&gt;waitQueue.<span class="hljs-built_in">empty</span>()) {
            connection-&gt;lastEventTime = LLONG_MIN;
        }
    }
}
</code></pre>
<h3 data-id="heading-10">2.5 ANRåˆ†æç¤ºä¾‹</h3>
<p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªçœŸå®çš„Input ANRåœºæ™¯çš„åˆ†æç®€åŒ–:</p>
<p><strong>åœºæ™¯</strong>: ç”¨æˆ·åœ¨åˆ—è¡¨ç•Œé¢å¿«é€Ÿæ»‘åŠ¨,çªç„¶åº”ç”¨æ— å“åº”</p>
<p><strong>logcatæ—¥å¿—</strong>:</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-number">12</span><span class="hljs-number">-25</span> <span class="hljs-number">10</span>:<span class="hljs-number">30</span>:<span class="hljs-number">15.123</span>  <span class="hljs-number">1234</span>  <span class="hljs-number">1250</span> E InputDispatcher: channel <span class="hljs-string">'e8d3a72 com.example.app/com.example.app.MainActivity (server)'</span> ~ Channel <span class="hljs-keyword">is</span> unresponsive! Waited <span class="hljs-number">5008</span>ms
<span class="hljs-number">12</span><span class="hljs-number">-25</span> <span class="hljs-number">10</span>:<span class="hljs-number">30</span>:<span class="hljs-number">15.234</span>  <span class="hljs-number">1234</span>  <span class="hljs-number">1250</span> I InputDispatcher: Delivering ANR to com.example.app
</code></pre>
<p><strong>traces.txtç‰‡æ®µ</strong>:</p>
<pre><code class="hljs language-ini" lang="ini">"main" <span class="hljs-attr">prio</span>=<span class="hljs-number">5</span> tid=<span class="hljs-number">1</span> Blocked
  | <span class="hljs-attr">group</span>=<span class="hljs-string">"main"</span> sCount=<span class="hljs-number">1</span> dsCount=<span class="hljs-number">0</span> flags=<span class="hljs-number">1</span> obj=<span class="hljs-number">0</span>x74e04dd8 self=<span class="hljs-number">0</span>x7a4e014c00
  | <span class="hljs-attr">sysTid</span>=<span class="hljs-number">12345</span> nice=-<span class="hljs-number">10</span> cgrp=default sched=<span class="hljs-number">0</span>/<span class="hljs-number">0</span> handle=<span class="hljs-number">0</span>x7b5a9f49a8
  | <span class="hljs-attr">state</span>=S schedstat=( <span class="hljs-number">15678923456</span> <span class="hljs-number">8765432109</span> <span class="hljs-number">1234</span> ) utm=<span class="hljs-number">1500</span> stm=<span class="hljs-number">67</span> core=<span class="hljs-number">2</span> HZ=<span class="hljs-number">100</span>
  at com.example.app.RecyclerAdapter.onBindViewHolder(RecyclerAdapter.java:150)
  - waiting to lock &lt;0x0a1b2c3d&gt; (a java.lang.Object) held by thread 15
  at android.support.v7.widget.RecyclerView.dispatchLayout(RecyclerView.java:3500)
  at android.support.v7.widget.RecyclerView.onLayout(RecyclerView.java:4064)
  at android.view.View.layout(View.java:19839)
  ...
</code></pre>
<p><strong>æ ¹å› åˆ†æ</strong>:</p>
<ol>
<li><strong>ç°è±¡</strong>: ä¸»çº¿ç¨‹è¢«é˜»å¡,çŠ¶æ€æ˜¯<code>Blocked</code></li>
<li><strong>ä½ç½®</strong>: å¡åœ¨<code>RecyclerAdapter.onBindViewHolder()</code></li>
<li><strong>åŸå› </strong>: ä¸»çº¿ç¨‹åœ¨ç­‰å¾…ä¸€ä¸ªé”<code>&lt;0x0a1b2c3d&gt;</code>,è¿™ä¸ªé”è¢«çº¿ç¨‹15æŒæœ‰</li>
<li><strong>è§£å†³</strong>: æ‰¾åˆ°çº¿ç¨‹15åœ¨å¹²ä»€ä¹ˆ,è§£å¼€æ­»é”</li>
</ol>
<p><strong>å…³é”®æ•™è®­</strong>:</p>
<ul>
<li>æ°¸è¿œä¸è¦åœ¨ä¸»çº¿ç¨‹ä¸­ç­‰å¾…é”</li>
<li>RecyclerViewçš„Adapterä¸­ä¸è¦åšè€—æ—¶æ“ä½œ</li>
<li>å¤æ‚çš„æ•°æ®å¤„ç†åº”è¯¥åœ¨åå°çº¿ç¨‹å®Œæˆ</li>
</ul>
<hr/>
<h2 data-id="heading-11">ä¸‰ã€Broadcast ANRçš„æ£€æµ‹æœºåˆ¶</h2>
<p>ç›¸æ¯”Input ANRçš„"è¢«åŠ¨æ£€æµ‹"(ç­‰äº‹ä»¶å¤„ç†å®Œ),Broadcast ANRé‡‡ç”¨"ä¸»åŠ¨æ£€æµ‹"(ä¸»åŠ¨è®¾ç½®è¶…æ—¶)ã€‚</p>
<h3 data-id="heading-12">3.1 å¹¿æ’­åˆ†å‘æµç¨‹</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c48bed15aa364a7388b593fb3fa3dbc3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767424897&amp;x-signature=5AJxmL0s40v4PxwnY7YHWuJ7aXs%3D" alt="02-02-broadcast-anr-flow.png" loading="lazy"/></p>
<h3 data-id="heading-13">3.2 è¶…æ—¶å®šæ—¶å™¨çš„å®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// frameworks/base/services/core/java/com/android/server/am/BroadcastQueue.java</span>

<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processCurBroadcastLocked</span><span class="hljs-params">(BroadcastRecord r, ProcessRecord app)</span> {
    <span class="hljs-comment">// 1. è®¾ç½®è¶…æ—¶æ—¶é—´</span>
    <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">timeout</span> <span class="hljs-operator">=</span> r.isForeground() ?
            BROADCAST_FG_TIMEOUT : BROADCAST_BG_TIMEOUT;

    <span class="hljs-comment">// 2. å‘é€å»¶æ—¶æ¶ˆæ¯</span>
    mHandler.sendMessageDelayed(
            mHandler.obtainMessage(BROADCAST_TIMEOUT_MSG, r),
            timeout);

    <span class="hljs-comment">// 3. è°ƒç”¨receiverçš„onReceive()</span>
    app.thread.scheduleReceiver(...);
}

<span class="hljs-comment">// Handlerå¤„ç†è¶…æ—¶æ¶ˆæ¯</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(Message msg)</span> {
    <span class="hljs-keyword">switch</span> (msg.what) {
        <span class="hljs-keyword">case</span> BROADCAST_TIMEOUT_MSG:
            <span class="hljs-type">BroadcastRecord</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> (BroadcastRecord) msg.obj;
            <span class="hljs-comment">// è§¦å‘ANR</span>
            broadcastTimeoutLocked(r, <span class="hljs-literal">true</span>);
            <span class="hljs-keyword">break</span>;
    }
}

<span class="hljs-comment">// å¹¿æ’­æ‰§è¡Œå®Œæ¯•åå–æ¶ˆè¶…æ—¶</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">performReceiveLocked</span><span class="hljs-params">(ProcessRecord app, ...)</span> {
    <span class="hljs-comment">// 1. æ‰§è¡Œå®Œæ¯•</span>
    r.receiver = <span class="hljs-literal">null</span>;

    <span class="hljs-comment">// 2. å–æ¶ˆè¶…æ—¶æ¶ˆæ¯</span>
    mHandler.removeMessages(BROADCAST_TIMEOUT_MSG, r);

    <span class="hljs-comment">// 3. ç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ªå¹¿æ’­</span>
    processCurBroadcastLocked(r, app);
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>:</p>
<ul>
<li>ä½¿ç”¨Handlerçš„å»¶æ—¶æ¶ˆæ¯å®ç°è¶…æ—¶æ£€æµ‹</li>
<li>å¦‚æœåœ¨è¶…æ—¶å‰å®Œæˆ,<code>removeMessages()</code>å–æ¶ˆå®šæ—¶å™¨</li>
<li>å¦‚æœè¶…æ—¶,Handleræ”¶åˆ°æ¶ˆæ¯,è§¦å‘ANR</li>
</ul>
<h3 data-id="heading-14">3.3 å‰å° vs åå°å¹¿æ’­çš„åŒºåˆ«</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è¶…æ—¶æ—¶é—´å®šä¹‰</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">BROADCAST_FG_TIMEOUT</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span> * <span class="hljs-number">1000</span>;  <span class="hljs-comment">// 10ç§’</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">BROADCAST_BG_TIMEOUT</span> <span class="hljs-operator">=</span> <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>;  <span class="hljs-comment">// 60ç§’</span>

<span class="hljs-comment">// å¦‚ä½•åˆ¤æ–­å‰å°è¿˜æ˜¯åå°?</span>
<span class="hljs-type">boolean</span> <span class="hljs-title function_">isForeground</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// 1. å¹¿æ’­å‘é€æ—¶æŒ‡å®šäº†FLAG_RECEIVER_FOREGROUND</span>
    <span class="hljs-keyword">if</span> ((intent.getFlags() &amp; Intent.FLAG_RECEIVER_FOREGROUND) != <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }

    <span class="hljs-comment">// 2. æ¥æ”¶è¿›ç¨‹æ˜¯å‰å°è¿›ç¨‹</span>
    <span class="hljs-keyword">if</span> (app.setAdj &lt;= ProcessList.PERCEPTIBLE_APP_ADJ) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }

    <span class="hljs-comment">// 3. æœ‰åºå¹¿æ’­çš„å½“å‰æ¥æ”¶è€…æ˜¯å‰å°</span>
    <span class="hljs-keyword">if</span> (ordered &amp;&amp; curReceiver.priority &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<p><strong>å®æˆ˜æ¡ˆä¾‹</strong>:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ¡ˆä¾‹:ä¸€ä¸ªè€—æ—¶çš„BroadcastReceiver</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyReceiver</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BroadcastReceiver</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onReceive</span><span class="hljs-params">(Context context, Intent intent)</span> {
        <span class="hljs-comment">// âŒ é”™è¯¯:åœ¨ä¸»çº¿ç¨‹åšè€—æ—¶æ“ä½œ</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++) {
            <span class="hljs-comment">// å¤§é‡è®¡ç®—</span>
        }
        <span class="hljs-comment">// å¦‚æœè¶…è¿‡10ç§’,è§¦å‘ANR</span>
    }
}

<span class="hljs-comment">// âœ… æ­£ç¡®åšæ³•:ä½¿ç”¨goAsync()</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyReceiver</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BroadcastReceiver</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onReceive</span><span class="hljs-params">(Context context, Intent intent)</span> {
        <span class="hljs-comment">// 1. è·å–PendingResult</span>
        <span class="hljs-keyword">final</span> <span class="hljs-type">PendingResult</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> goAsync();

        <span class="hljs-comment">// 2. åœ¨å­çº¿ç¨‹å¤„ç†</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// è€—æ—¶æ“ä½œ</span>
                doHeavyWork();
            } <span class="hljs-keyword">finally</span> {
                <span class="hljs-comment">// 3. å®Œæˆåé€šçŸ¥ç³»ç»Ÿ</span>
                result.finish();
            }
        }).start();
    }
}
</code></pre>
<p><strong>goAsync()çš„ä½œç”¨</strong>:</p>
<ul>
<li>å‘Šè¯‰ç³»ç»Ÿ"æˆ‘éœ€è¦å¼‚æ­¥å¤„ç†,åˆ«æ€¥ç€è¶…æ—¶"</li>
<li>ç³»ç»Ÿä¼šå»¶é•¿è¶…æ—¶æ—¶é—´(ä½†ä»æœ‰ä¸Šé™)</li>
<li>å¿…é¡»åœ¨å®Œæˆåè°ƒç”¨<code>result.finish()</code></li>
</ul>
<hr/>
<h2 data-id="heading-15">å››ã€Service ANRçš„æ£€æµ‹æœºåˆ¶</h2>
<p>Service ANRçš„æ£€æµ‹é€»è¾‘ä¸Broadcastç±»ä¼¼,ä½†æ›´å¤æ‚,å› ä¸ºServiceæœ‰å¤šä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•éœ€è¦ç›‘æ§ã€‚</p>
<h3 data-id="heading-16">4.1 Serviceç”Ÿå‘½å‘¨æœŸçš„è¶…æ—¶ç›‘æ§</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// frameworks/base/services/core/java/com/android/server/am/ActiveServices.java</span>

<span class="hljs-comment">// Serviceå¯åŠ¨è¶…æ—¶æ£€æµ‹</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">bringUpServiceLocked</span><span class="hljs-params">(ServiceRecord r, ...)</span> {
    <span class="hljs-comment">// 1. è®¾ç½®è¶…æ—¶æ—¶é—´</span>
    <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">timeout</span> <span class="hljs-operator">=</span> r.isForeground() ?
            SERVICE_TIMEOUT : SERVICE_BACKGROUND_TIMEOUT;

    <span class="hljs-comment">// 2. å‘é€è¶…æ—¶æ¶ˆæ¯</span>
    mAm.mHandler.sendMessageDelayed(
            mAm.mHandler.obtainMessage(SERVICE_TIMEOUT_MSG, r),
            timeout);

    <span class="hljs-comment">// 3. å¯åŠ¨Service</span>
    app.thread.scheduleCreateService(r, ...);
}

<span class="hljs-comment">// Serviceç”Ÿå‘½å‘¨æœŸæ–¹æ³•æ‰§è¡Œå®Œæ¯•</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serviceDoneExecutingLocked</span><span class="hljs-params">(ServiceRecord r, ...)</span> {
    <span class="hljs-comment">// 1. å–æ¶ˆè¶…æ—¶æ¶ˆæ¯</span>
    mAm.mHandler.removeMessages(SERVICE_TIMEOUT_MSG, r);

    <span class="hljs-comment">// 2. æ›´æ–°ServiceçŠ¶æ€</span>
    r.executeNesting--;
    <span class="hljs-keyword">if</span> (r.executeNesting &lt;= <span class="hljs-number">0</span>) {
        r.executing = <span class="hljs-literal">false</span>;
    }
}
</code></pre>
<p><strong>ç›‘æ§çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</strong>:</p>
<ul>
<li><code>onCreate()</code>: Serviceåˆ›å»º</li>
<li><code>onStartCommand()</code>: Serviceå¯åŠ¨</li>
<li><code>onBind()</code>: Serviceç»‘å®š</li>
<li><code>onUnbind()</code>: Serviceè§£ç»‘</li>
<li><code>onDestroy()</code>: Serviceé”€æ¯</li>
</ul>
<h3 data-id="heading-17">4.2 å‰å°Serviceçš„ç‰¹æ®Šå¤„ç†</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å‰å°Serviceçš„è¶…æ—¶æ—¶é—´æ›´çŸ­</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">SERVICE_TIMEOUT</span> <span class="hljs-operator">=</span> <span class="hljs-number">20</span> * <span class="hljs-number">1000</span>;       <span class="hljs-comment">// 20ç§’</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">SERVICE_BACKGROUND_TIMEOUT</span> <span class="hljs-operator">=</span> <span class="hljs-number">200</span> * <span class="hljs-number">1000</span>;  <span class="hljs-comment">// 200ç§’</span>

<span class="hljs-comment">// å¯åŠ¨å‰å°Serviceçš„æ­£ç¡®å§¿åŠ¿</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Service</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.onCreate();

        <span class="hljs-comment">// åœ¨onCreate()ä¸­å°½å¿«è°ƒç”¨startForeground()</span>
        <span class="hljs-comment">// å¦åˆ™å¯èƒ½è§¦å‘ANR</span>
        <span class="hljs-type">Notification</span> <span class="hljs-variable">notification</span> <span class="hljs-operator">=</span> createNotification();
        startForeground(NOTIFICATION_ID, notification);

        <span class="hljs-comment">// ç„¶åå†åšå…¶ä»–åˆå§‹åŒ–</span>
        initializeResources();
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">onStartCommand</span><span class="hljs-params">(Intent intent, <span class="hljs-type">int</span> flags, <span class="hljs-type">int</span> startId)</span> {
        <span class="hljs-comment">// å¦‚æœæœ‰è€—æ—¶æ“ä½œ,æ”¾åˆ°å­çº¿ç¨‹</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            doHeavyWork();
        }).start();

        <span class="hljs-keyword">return</span> START_STICKY;
    }
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆå‰å°Serviceè¶…æ—¶æ—¶é—´çŸ­?</strong></p>
<p>å› ä¸ºå‰å°Serviceé€šå¸¸ä¸ç”¨æˆ·å½“å‰çš„æ“ä½œç›¸å…³(å¦‚éŸ³ä¹æ’­æ”¾ã€å¯¼èˆª),å¿…é¡»å¿«é€Ÿå¯åŠ¨,å¦åˆ™å½±å“ç”¨æˆ·ä½“éªŒã€‚</p>
<h3 data-id="heading-18">4.3 IntentServiceçš„è¶…æ—¶é—®é¢˜</h3>
<p>IntentServiceæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„Service,å®ƒè‡ªå¸¦å·¥ä½œçº¿ç¨‹:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// IntentServiceçš„å†…éƒ¨å®ç°</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IntentService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Service</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> Looper mServiceLooper;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> ServiceHandler mServiceHandler;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.onCreate();
        <span class="hljs-comment">// åˆ›å»ºå·¥ä½œçº¿ç¨‹</span>
        <span class="hljs-type">HandlerThread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HandlerThread</span>(<span class="hljs-string">"IntentService["</span> + mName + <span class="hljs-string">"]"</span>);
        thread.start();

        mServiceLooper = thread.getLooper();
        mServiceHandler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServiceHandler</span>(mServiceLooper);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">onStartCommand</span><span class="hljs-params">(Intent intent, <span class="hljs-type">int</span> flags, <span class="hljs-type">int</span> startId)</span> {
        <span class="hljs-comment">// å°†ä»»åŠ¡å‘é€åˆ°å·¥ä½œçº¿ç¨‹</span>
        <span class="hljs-type">Message</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> mServiceHandler.obtainMessage();
        msg.arg1 = startId;
        msg.obj = intent;
        mServiceHandler.sendMessage(msg);
        <span class="hljs-keyword">return</span> START_REDELIVER_INTENT;
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ServiceHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Handler</span> {
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">ServiceHandler</span><span class="hljs-params">(Looper looper)</span> {
            <span class="hljs-built_in">super</span>(looper);
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(Message msg)</span> {
            <span class="hljs-comment">// åœ¨å·¥ä½œçº¿ç¨‹è°ƒç”¨onHandleIntent()</span>
            onHandleIntent((Intent)msg.obj);
            stopSelf(msg.arg1);
        }
    }

    <span class="hljs-comment">// å­ç±»å®ç°è¿™ä¸ªæ–¹æ³•</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onHandleIntent</span><span class="hljs-params">(Intent intent)</span>;
}
</code></pre>
<p><strong>é‡è¦ç»†èŠ‚</strong>:</p>
<ul>
<li><code>onStartCommand()</code>åœ¨ä¸»çº¿ç¨‹,ä½†å¾ˆå¿«è¿”å›</li>
<li><code>onHandleIntent()</code>åœ¨å·¥ä½œçº¿ç¨‹,å¯ä»¥è€—æ—¶</li>
<li>ä¸ä¼šè§¦å‘Service ANR,å› ä¸ºä¸»çº¿ç¨‹æ–¹æ³•éƒ½å¾ˆå¿«</li>
</ul>
<p><strong>ä½†æ˜¯è¦æ³¨æ„<code>onCreate()</code>!</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é”™è¯¯:åœ¨onCreate()ä¸­åˆå§‹åŒ–è€—æ—¶èµ„æº</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyIntentService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">IntentService</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.onCreate();
        <span class="hljs-comment">// è¿™é‡Œä»ç„¶åœ¨ä¸»çº¿ç¨‹!</span>
        loadLargeDatabase();  <span class="hljs-comment">// å¯èƒ½è§¦å‘ANR</span>
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onHandleIntent</span><span class="hljs-params">(Intent intent)</span> {
        <span class="hljs-comment">// è¿™é‡Œåœ¨å·¥ä½œçº¿ç¨‹,å¯ä»¥è€—æ—¶</span>
        processData();
    }
}

<span class="hljs-comment">// âœ… æ­£ç¡®:è€—æ—¶åˆå§‹åŒ–ä¹Ÿæ”¾åˆ°å·¥ä½œçº¿ç¨‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyIntentService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">IntentService</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.onCreate();
        <span class="hljs-comment">// åªåšè½»é‡çº§åˆå§‹åŒ–</span>
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onHandleIntent</span><span class="hljs-params">(Intent intent)</span> {
        <span class="hljs-comment">// ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶å†åˆå§‹åŒ–</span>
        <span class="hljs-keyword">if</span> (!initialized) {
            loadLargeDatabase();
            initialized = <span class="hljs-literal">true</span>;
        }
        processData();
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-19">äº”ã€ANRä¿¡æ¯çš„æ”¶é›†ä¸ä¸ŠæŠ¥</h2>
<p>å½“InputDispatcheræˆ–AMSæ£€æµ‹åˆ°ANRå,ä¼šè§¦å‘ä¸€ç³»åˆ—çš„ä¿¡æ¯æ”¶é›†æ“ä½œã€‚è¿™äº›ä¿¡æ¯å¯¹äºåˆ†æANRè‡³å…³é‡è¦ã€‚</p>
<h3 data-id="heading-20">5.1 ANRè§¦å‘å’Œä¿¡æ¯æœé›†æµç¨‹</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/788e0de317454e1d92142ac1afa051e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767424897&amp;x-signature=lbufZe1kQrFeVIcdhM766moZHiM%3D" alt="02-03-anr-collection-flow.png" loading="lazy"/></p>
<h3 data-id="heading-21">5.2 appNotResponding()çš„å®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// frameworks/base/services/core/java/com/android/server/am/ProcessRecord.java</span>

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">appNotResponding</span><span class="hljs-params">(String activityShortComponentName, ApplicationInfo aInfo,
        String parentShortComponentName, WindowProcessController parentProcess,
        <span class="hljs-type">boolean</span> aboveSystem, String annotation)</span> {

    <span class="hljs-comment">// 1. é˜²æ­¢é‡å¤ANR</span>
    <span class="hljs-keyword">synchronized</span> (mService) {
        <span class="hljs-keyword">if</span> (mNotResponding) {
            Slog.w(TAG, <span class="hljs-string">"App already notresponding: "</span> + <span class="hljs-built_in">this</span>);
            <span class="hljs-keyword">return</span>;
        }
        mNotResponding = <span class="hljs-literal">true</span>;

        <span class="hljs-comment">// 2. è®°å½•ANRä¿¡æ¯</span>
        mNotRespondingReport = generateErrorReport(
                annotation, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);
    }

    <span class="hljs-comment">// 3. æ”¶é›†CPUä½¿ç”¨æƒ…å†µ</span>
    updateCpuStatsNow();

    <span class="hljs-comment">// 4. è¾“å‡ºåˆ°logcat</span>
    Slog.e(TAG, <span class="hljs-string">"ANR in "</span> + processName + <span class="hljs-string">" ("</span> + activityShortComponentName + <span class="hljs-string">")"</span>);
    Slog.e(TAG, <span class="hljs-string">"PID: "</span> + pid);
    Slog.e(TAG, <span class="hljs-string">"Reason: "</span> + annotation);
    Slog.e(TAG, <span class="hljs-string">"Load: "</span> + loadAverage);
    Slog.e(TAG, <span class="hljs-string">"CPU usage from "</span> + cpuUsageStart + <span class="hljs-string">"ms to "</span> + cpuUsageEnd + <span class="hljs-string">"ms later:"</span>);
    Slog.e(TAG, cpuUsageString);

    <span class="hljs-comment">// 5. dumpæ‰€æœ‰ç›¸å…³çº¿ç¨‹å †æ ˆ</span>
    ArrayList&lt;Integer&gt; firstPids = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(<span class="hljs-number">5</span>);
    firstPids.add(pid);  <span class="hljs-comment">// ANRè¿›ç¨‹</span>
    firstPids.add(Process.myPid());  <span class="hljs-comment">// System Server</span>

    <span class="hljs-type">File</span> <span class="hljs-variable">tracesFile</span> <span class="hljs-operator">=</span> ActivityManagerService.dumpStackTraces(
            firstPids, processCpuTracker, ...);

    <span class="hljs-comment">// 6. å†™å…¥DropBox</span>
    mService.addErrorToDropBox(<span class="hljs-string">"anr"</span>, <span class="hljs-built_in">this</span>, processName, activityShortComponentName,
            parentShortComponentName, parentProcess, annotation,
            cpuUsageString, tracesFile, <span class="hljs-literal">null</span>);

    <span class="hljs-comment">// 7. å¼¹å‡ºANR Dialog</span>
    <span class="hljs-type">Message</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> Message.obtain();
    msg.what = ActivityManagerService.SHOW_NOT_RESPONDING_UI_MSG;
    msg.obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AppNotRespondingDialog</span>.Data(<span class="hljs-built_in">this</span>, aInfo, aboveSystem);
    mService.mUiHandler.sendMessage(msg);
}
</code></pre>
<h3 data-id="heading-22">5.3 traces.txtçš„ç”Ÿæˆ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// frameworks/base/services/core/java/com/android/server/am/ActivityManagerService.java</span>

<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> File <span class="hljs-title function_">dumpStackTraces</span><span class="hljs-params">(ArrayList&lt;Integer&gt; firstPids,
        ProcessCpuTracker processCpuTracker, ...)</span> {

    <span class="hljs-comment">// 1. åˆ›å»ºtracesæ–‡ä»¶</span>
    <span class="hljs-type">File</span> <span class="hljs-variable">tracesFile</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">"/data/anr/traces.txt"</span>);

    <span class="hljs-comment">// 2. dumpç¬¬ä¸€æ‰¹è¿›ç¨‹(ANRè¿›ç¨‹å’ŒSystem Server)</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> pid : firstPids) {
        dumpJavaTracesTombstoned(pid, tracesFile, timeout);
    }

    <span class="hljs-comment">// 3. dump Nativeè¿›ç¨‹(å¦‚æœANRè¿›ç¨‹æœ‰nativeçº¿ç¨‹)</span>
    <span class="hljs-keyword">if</span> (DEBUG_ANR) {
        dumpNativeBacktraceToFile(pid, tracesFile);
    }

    <span class="hljs-comment">// 4. dumpå…¶ä»–é‡è¦è¿›ç¨‹</span>
    ArrayList&lt;Integer&gt; extraPids = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();

    <span class="hljs-comment">// 4.1 æœ€è¿‘ä½¿ç”¨çš„3ä¸ªåº”ç”¨</span>
    <span class="hljs-keyword">if</span> (lastPids != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; lastPids.size() &amp;&amp; i &lt; <span class="hljs-number">3</span>; i++) {
            extraPids.add(lastPids.get(i));
        }
    }

    <span class="hljs-comment">// 4.2 æ‰€æœ‰persistentè¿›ç¨‹</span>
    <span class="hljs-keyword">synchronized</span> (mPidsSelfLocked) {
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; mPidsSelfLocked.size(); i++) {
            <span class="hljs-type">ProcessRecord</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> mPidsSelfLocked.valueAt(i);
            <span class="hljs-keyword">if</span> (r.persistent) {
                extraPids.add(r.pid);
            }
        }
    }

    <span class="hljs-comment">// 4.3 dumpè¿™äº›è¿›ç¨‹</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> pid : extraPids) {
        dumpJavaTracesTombstoned(pid, tracesFile, timeout);
    }

    <span class="hljs-keyword">return</span> tracesFile;
}
</code></pre>
<p><strong>traces.txtçš„ç»“æ„</strong>:</p>
<pre><code class="hljs language-ini" lang="ini">----- pid 12345 at 2024-12-25 10:30:15 -----
Cmd line: com.example.app
Build fingerprint: 'google/sdk_gphone_x86_64/generic_x86_64:11/RSR1.201013.001/6903271:user/release-keys'
ABI: 'x86_64'
...

"main" <span class="hljs-attr">prio</span>=<span class="hljs-number">5</span> tid=<span class="hljs-number">1</span> Blocked
  | <span class="hljs-attr">group</span>=<span class="hljs-string">"main"</span> sCount=<span class="hljs-number">1</span> dsCount=<span class="hljs-number">0</span> flags=<span class="hljs-number">1</span> obj=<span class="hljs-number">0</span>x74e04dd8
  | <span class="hljs-attr">sysTid</span>=<span class="hljs-number">12345</span> nice=-<span class="hljs-number">10</span> cgrp=default sched=<span class="hljs-number">0</span>/<span class="hljs-number">0</span> handle=<span class="hljs-number">0</span>x7b5a9f49a8
  | <span class="hljs-attr">state</span>=S schedstat=( <span class="hljs-number">15678923456</span> <span class="hljs-number">8765432109</span> <span class="hljs-number">1234</span> ) utm=<span class="hljs-number">1500</span> stm=<span class="hljs-number">67</span>
  at com.example.app.MainActivity.onClick(MainActivity.java:150)
  - waiting to lock &lt;0x0a1b2c3d&gt; (a java.lang.Object) held by thread 15
  at android.view.View.performClick(View.java:7125)
  ...

"Thread-15" <span class="hljs-attr">prio</span>=<span class="hljs-number">5</span> tid=<span class="hljs-number">15</span> Native
  | <span class="hljs-attr">group</span>=<span class="hljs-string">"main"</span> sCount=<span class="hljs-number">1</span> dsCount=<span class="hljs-number">0</span> flags=<span class="hljs-number">1</span> obj=<span class="hljs-number">0</span>x13579bdf
  | <span class="hljs-attr">sysTid</span>=<span class="hljs-number">12360</span> nice=<span class="hljs-number">0</span> cgrp=default sched=<span class="hljs-number">0</span>/<span class="hljs-number">0</span> handle=<span class="hljs-number">0</span>x7a4e028800
  at android.os.BinderProxy.transactNative(Native Method)
  - locked &lt;0x0a1b2c3d&gt; (a java.lang.Object)
  at android.os.BinderProxy.transact(Binder.java:1129)
  ...

"Binder:12345_2" <span class="hljs-attr">prio</span>=<span class="hljs-number">5</span> tid=<span class="hljs-number">12</span> Native
  ...

----- end 12345 -----
</code></pre>
<p><strong>å…³é”®ä¿¡æ¯è§£è¯»</strong>:</p>
<ul>
<li><strong>Cmd line</strong>: è¿›ç¨‹åç§°</li>
<li><strong>tid</strong>: çº¿ç¨‹ID</li>
<li><strong>çŠ¶æ€</strong>: Blocked/Native/Waiting/Runnable</li>
<li><strong>å †æ ˆ</strong>: Javaæ–¹æ³•è°ƒç”¨é“¾</li>
<li><strong>é”ä¿¡æ¯</strong>: <code>waiting to lock &lt;åœ°å€&gt;</code> æˆ– <code>locked &lt;åœ°å€&gt;</code></li>
</ul>
<h3 data-id="heading-23">5.4 DropBox:ANRçš„"é»‘åŒ£å­"</h3>
<p>DropBoxæ˜¯Androidçš„ç³»ç»Ÿæ—¥å¿—æœåŠ¡,ä¸“é—¨ç”¨äºå­˜å‚¨ç³»ç»Ÿå¼‚å¸¸äº‹ä»¶:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å†™å…¥DropBox</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">addErrorToDropBox</span><span class="hljs-params">(String eventType, ProcessRecord process,
        String processName, String activityShortComponentName, ...)</span> {

    <span class="hljs-comment">// 1. æ„å»ºDropBoxæ¡ç›®</span>
    <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>(<span class="hljs-number">1024</span>);
    sb.append(<span class="hljs-string">"Process: "</span>).append(processName).append(<span class="hljs-string">"\n"</span>);
    sb.append(<span class="hljs-string">"PID: "</span>).append(process.pid).append(<span class="hljs-string">"\n"</span>);
    sb.append(<span class="hljs-string">"Reason: "</span>).append(annotation).append(<span class="hljs-string">"\n"</span>);
    sb.append(<span class="hljs-string">"Load: "</span>).append(loadAverage).append(<span class="hljs-string">"\n"</span>);
    sb.append(cpuUsageString);

    <span class="hljs-comment">// 2. æ·»åŠ traceså†…å®¹</span>
    <span class="hljs-keyword">if</span> (tracesFile != <span class="hljs-literal">null</span>) {
        sb.append(<span class="hljs-string">"\n\n*** TRACES ***\n"</span>);
        sb.append(FileUtils.readTextFile(tracesFile, DROPBOX_MAX_SIZE, <span class="hljs-string">"..."</span>));
    }

    <span class="hljs-comment">// 3. å†™å…¥DropBox</span>
    <span class="hljs-type">DropBoxManager</span> <span class="hljs-variable">dbox</span> <span class="hljs-operator">=</span> mContext.getSystemService(DropBoxManager.class);
    dbox.addText(eventType, sb.toString());
}
</code></pre>
<p><strong>æŸ¥çœ‹DropBoxå†…å®¹</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ—å‡ºæ‰€æœ‰ANRè®°å½•</span>
adb shell dumpsys dropbox --<span class="hljs-built_in">print</span> anr

<span class="hljs-comment"># å¯¼å‡ºæœ€è¿‘çš„ANR</span>
adb shell dumpsys dropbox --<span class="hljs-built_in">print</span> anr &gt; anr_dropbox.txt

<span class="hljs-comment"># æ¸…ç©ºDropBox</span>
adb shell dumpsys dropbox --wipe
</code></pre>
<p><strong>DropBox vs traces.txt</strong>:</p>



































<table><thead><tr><th>ç‰¹æ€§</th><th>DropBox</th><th>traces.txt</th></tr></thead><tbody><tr><td>å­˜å‚¨ä½ç½®</td><td><code>/data/system/dropbox</code></td><td><code>/data/anr/</code></td></tr><tr><td>å­˜å‚¨æ ¼å¼</td><td>ç»“æ„åŒ–æ¡ç›®</td><td>çº¯æ–‡æœ¬</td></tr><tr><td>å®¹é‡é™åˆ¶</td><td>æœ‰é™(ä¼šæ»šåŠ¨åˆ é™¤)</td><td>å•ä¸ªæ–‡ä»¶</td></tr><tr><td>åŒ…å«ä¿¡æ¯</td><td>ANR+CPU+å†…å­˜</td><td>ä»…çº¿ç¨‹å †æ ˆ</td></tr><tr><td>æŸ¥çœ‹æ–¹å¼</td><td>dumpsys dropbox</td><td>adb pull</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-24">å…­ã€ANR Dialogçš„å±•ç¤º</h2>
<p>ANRæ£€æµ‹å’Œä¿¡æ¯æ”¶é›†å®Œæˆå,æœ€ç»ˆä¼šå¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†è®©ç”¨æˆ·å†³å®šå¦‚ä½•å¤„ç†ã€‚</p>
<h3 data-id="heading-25">6.1 ANR Dialogçš„ç±»å‹</h3>
<p>Androidæœ‰ä¸¤ç§ANR Dialog:</p>
<p><strong>1. åº”ç”¨ANR Dialog</strong>(æ™®é€šåº”ç”¨):</p>
<pre><code class="hljs language-css" lang="css">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚  åº”ç”¨æ— å“åº”                  â”‚
â”‚                            â”‚
â”‚  "XX"æœªå“åº”ã€‚               â”‚
â”‚                            â”‚
â”‚  æ‚¨è¦å…³é—­å®ƒå—?               â”‚
â”‚                            â”‚
â”‚  <span class="hljs-selector-attr">[ç­‰å¾…]</span>  <span class="hljs-selector-attr">[å…³é—­åº”ç”¨]</span>          â”‚
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</code></pre>
<p><strong>2. ç³»ç»ŸANR Dialog</strong>(ç³»ç»Ÿåº”ç”¨æˆ–System Server):</p>
<pre><code class="hljs language-css" lang="css">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚  ç³»ç»Ÿæœªå“åº”                 â”‚
â”‚                            â”‚
â”‚  "System UI"æœªå“åº”ã€‚        â”‚
â”‚                            â”‚
â”‚  <span class="hljs-selector-attr">[ç­‰å¾…]</span>  <span class="hljs-selector-attr">[ç¡®å®š]</span>             â”‚
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</code></pre>
<h3 data-id="heading-26">6.2 Dialogçš„å®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// frameworks/base/services/core/java/com/android/server/am/AppNotRespondingDialog.java</span>

<span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppNotRespondingDialog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseErrorDialog</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ActivityManagerService mService;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ProcessRecord mProc;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">AppNotRespondingDialog</span><span class="hljs-params">(ActivityManagerService service,
            Context context, Data data)</span> {
        <span class="hljs-built_in">super</span>(context);

        mService = service;
        mProc = data.proc;

        <span class="hljs-comment">// 1. è®¾ç½®Dialogæ ‡é¢˜</span>
        setTitle(context.getText(com.android.internal.R.string.anr_title));

        <span class="hljs-comment">// 2. è®¾ç½®æ¶ˆæ¯å†…å®¹</span>
        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();
        msg.append(context.getString(com.android.internal.R.string.anr_activity_application,
                data.aInfo.loadLabel(context.getPackageManager()).toString(),
                data.proc.info.processName));

        setMessage(msg);

        <span class="hljs-comment">// 3. è®¾ç½®æŒ‰é’®</span>
        setCancelable(<span class="hljs-literal">false</span>);

        <span class="hljs-comment">// "ç­‰å¾…"æŒ‰é’®</span>
        setButton(DialogInterface.BUTTON_POSITIVE,
                context.getText(com.android.internal.R.string.wait),
                mHandler.obtainMessage(WAIT));

        <span class="hljs-comment">// "å…³é—­åº”ç”¨"æŒ‰é’®</span>
        setButton(DialogInterface.BUTTON_NEGATIVE,
                context.getText(com.android.internal.R.string.force_close),
                mHandler.obtainMessage(FORCE_CLOSE));

        <span class="hljs-comment">// "æŠ¥å‘Š"æŒ‰é’®(å¯é€‰)</span>
        <span class="hljs-keyword">if</span> (data.proc.errorReportReceiver != <span class="hljs-literal">null</span>) {
            setButton(DialogInterface.BUTTON_NEUTRAL,
                    context.getText(com.android.internal.R.string.report),
                    mHandler.obtainMessage(APP_INFO));
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Handler</span> <span class="hljs-variable">mHandler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handler</span>() {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(Message msg)</span> {
            <span class="hljs-keyword">switch</span> (msg.what) {
                <span class="hljs-keyword">case</span> WAIT:
                    <span class="hljs-comment">// ç”¨æˆ·é€‰æ‹©ç­‰å¾…,å…³é—­Dialog</span>
                    mService.mUiHandler.sendEmptyMessage(DISMISS_DIALOG);
                    <span class="hljs-keyword">break</span>;

                <span class="hljs-keyword">case</span> FORCE_CLOSE:
                    <span class="hljs-comment">// ç”¨æˆ·é€‰æ‹©å…³é—­,æ€æ­»åº”ç”¨</span>
                    mService.killAppAtUsersRequest(mProc, AppNotRespondingDialog.<span class="hljs-built_in">this</span>);
                    <span class="hljs-keyword">break</span>;

                <span class="hljs-keyword">case</span> APP_INFO:
                    <span class="hljs-comment">// ç”¨æˆ·é€‰æ‹©æŠ¥å‘Š,æ‰“å¼€åº”ç”¨ä¿¡æ¯é¡µ</span>
                    mService.mUiHandler.obtainMessage(SHOW_APP_ERROR_REPORT, mProc)
                            .sendToTarget();
                    <span class="hljs-keyword">break</span>;
            }
        }
    };
}
</code></pre>
<h3 data-id="heading-27">6.3 ç”¨æˆ·æ“ä½œçš„åç»­å¤„ç†</h3>
<p><strong>ç”¨æˆ·é€‰æ‹©"ç­‰å¾…"</strong>:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä»€ä¹ˆéƒ½ä¸åš,åªæ˜¯å…³é—­Dialog</span>
<span class="hljs-comment">// ANRè¿›ç¨‹ç»§ç»­è¿è¡Œ</span>
<span class="hljs-comment">// å¦‚æœè¿˜æ˜¯æ²¡å“åº”,å¯èƒ½å†æ¬¡è§¦å‘ANR</span>
</code></pre>
<p><strong>ç”¨æˆ·é€‰æ‹©"å…³é—­åº”ç”¨"</strong>:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">void</span> <span class="hljs-title function_">killAppAtUsersRequest</span><span class="hljs-params">(ProcessRecord app, Dialog fromDialog)</span> {
    <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) {
        <span class="hljs-comment">// 1. æ ‡è®°ä¸ºç”¨æˆ·ä¸»åŠ¨å…³é—­</span>
        app.crashing = <span class="hljs-literal">false</span>;
        app.crashingReport = <span class="hljs-literal">null</span>;
        app.notResponding = <span class="hljs-literal">false</span>;
        app.notRespondingReport = <span class="hljs-literal">null</span>;

        <span class="hljs-comment">// 2. æ€æ­»è¿›ç¨‹</span>
        Process.killProcess(app.pid);

        <span class="hljs-comment">// 3. æ¸…ç†è¿›ç¨‹è®°å½•</span>
        handleAppDiedLocked(app, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);
    }
}
</code></pre>
<p><strong>ç”¨æˆ·é€‰æ‹©"æŠ¥å‘Š"</strong>(æŸäº›ç³»ç»Ÿ):</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ‰“å¼€Feedbackæˆ–BugReportåº”ç”¨</span>
<span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(<span class="hljs-string">"android.intent.action.APP_ERROR"</span>);
intent.putExtra(<span class="hljs-string">"error_type"</span>, <span class="hljs-string">"anr"</span>);
intent.putExtra(<span class="hljs-string">"package_name"</span>, app.info.packageName);
intent.putExtra(<span class="hljs-string">"process_name"</span>, app.processName);
intent.putExtra(<span class="hljs-string">"pid"</span>, app.pid);
context.startActivity(intent);
</code></pre>
<hr/>
<h2 data-id="heading-28">ä¸ƒã€ANRåˆ†æå®æˆ˜</h2>
<p>ç†è®ºè®²äº†è¿™ä¹ˆå¤š,è®©æˆ‘ä»¬é€šè¿‡å‡ ä¸ªçœŸå®æ¡ˆä¾‹,çœ‹çœ‹å¦‚ä½•å®æˆ˜åˆ†æANRã€‚</p>
<h3 data-id="heading-29">7.1 æ¡ˆä¾‹1:ä¸»çº¿ç¨‹ç­‰é”å¯¼è‡´çš„ANR</h3>
<p><strong>ç°è±¡</strong>: ç”¨æˆ·ç‚¹å‡»æŒ‰é’®å,åº”ç”¨å¡ä½5ç§’,å¼¹å‡ºANR</p>
<p><strong>logcatæ—¥å¿—</strong>:</p>
<pre><code class="hljs language-markdown" lang="markdown">12-25 10:30:15.123  1234  1250 E InputDispatcher: Application is not responding: AppWindowToken{e8d3a72 token=Token{b6c7d3e ActivityRecord{a9f8e1d u0 com.example/.MainActivity}}}
12-25 10:30:15.234  1234  1250 I ActivityManager: ANR in com.example.app (com.example.app/.MainActivity)
12-25 10:30:15.234  1234  1250 I ActivityManager: PID: 12345
12-25 10:30:15.234  1234  1250 I ActivityManager: Reason: Input dispatching timed out (Waiting to send non-key event because the touched window has not finished processing certain input events that were delivered to it over 500.0ms ago.  Wait queue length: 1.)
</code></pre>
<p><strong>traces.txtåˆ†æ</strong>:</p>
<pre><code class="hljs language-php" lang="php">----- pid <span class="hljs-number">12345</span> at <span class="hljs-number">2024</span>-<span class="hljs-number">12</span>-<span class="hljs-number">25</span> <span class="hljs-number">10</span>:<span class="hljs-number">30</span>:<span class="hljs-number">15</span> -----
Cmd line: com.example.app

<span class="hljs-string">"main"</span> prio=<span class="hljs-number">5</span> tid=<span class="hljs-number">1</span> Blocked
  | group=<span class="hljs-string">"main"</span> sCount=<span class="hljs-number">1</span> dsCount=<span class="hljs-number">0</span> flags=<span class="hljs-number">1</span> obj=<span class="hljs-number">0x74e04dd8</span>
  | sysTid=<span class="hljs-number">12345</span> nice=-<span class="hljs-number">10</span> cgrp=<span class="hljs-keyword">default</span> sched=<span class="hljs-number">0</span>/<span class="hljs-number">0</span> handle=<span class="hljs-number">0x7b5a9f49a8</span>
  | state=S schedstat=( <span class="hljs-number">15678923456</span> <span class="hljs-number">8765432109</span> <span class="hljs-number">1234</span> ) utm=<span class="hljs-number">1500</span> stm=<span class="hljs-number">67</span>
  at com.example.app.DataManager.<span class="hljs-title function_ invoke__">getData</span>(DataManager.<span class="hljs-attr">java</span>:<span class="hljs-number">45</span>)
  - waiting to lock &lt;<span class="hljs-number">0x0a1b2c3d</span>&gt; (a java.lang.Object) held by thread <span class="hljs-number">15</span>
  at com.example.app.MainActivity.<span class="hljs-title function_ invoke__">onClick</span>(MainActivity.<span class="hljs-attr">java</span>:<span class="hljs-number">100</span>)
  at android.view.View.<span class="hljs-title function_ invoke__">performClick</span>(View.<span class="hljs-attr">java</span>:<span class="hljs-number">7125</span>)
  at android.view.View.<span class="hljs-title function_ invoke__">performClickInternal</span>(View.<span class="hljs-attr">java</span>:<span class="hljs-number">7102</span>)
  at android.view.View.access$<span class="hljs-number">3500</span>(View.java:<span class="hljs-number">801</span>)
  at android.view.View<span class="hljs-variable">$PerformClick</span>.<span class="hljs-title function_ invoke__">run</span>(View.<span class="hljs-attr">java</span>:<span class="hljs-number">27851</span>)
  at android.os.Handler.<span class="hljs-title function_ invoke__">handleCallback</span>(Handler.<span class="hljs-attr">java</span>:<span class="hljs-number">883</span>)
  at android.os.Handler.<span class="hljs-title function_ invoke__">dispatchMessage</span>(Handler.<span class="hljs-attr">java</span>:<span class="hljs-number">100</span>)
  at android.os.Looper.<span class="hljs-title function_ invoke__">loop</span>(Looper.<span class="hljs-attr">java</span>:<span class="hljs-number">214</span>)
  at android.app.ActivityThread.<span class="hljs-title function_ invoke__">main</span>(ActivityThread.<span class="hljs-attr">java</span>:<span class="hljs-number">7356</span>)
  ...

<span class="hljs-string">"Thread-15"</span> prio=<span class="hljs-number">5</span> tid=<span class="hljs-number">15</span> Native
  | group=<span class="hljs-string">"main"</span> sCount=<span class="hljs-number">1</span> dsCount=<span class="hljs-number">0</span> flags=<span class="hljs-number">1</span> obj=<span class="hljs-number">0x13579bdf</span>
  | sysTid=<span class="hljs-number">12360</span> nice=<span class="hljs-number">0</span> cgrp=<span class="hljs-keyword">default</span> sched=<span class="hljs-number">0</span>/<span class="hljs-number">0</span> handle=<span class="hljs-number">0x7a4e028800</span>
  | state=S schedstat=( <span class="hljs-number">9876543210</span> <span class="hljs-number">5432109876</span> <span class="hljs-number">123</span> ) utm=<span class="hljs-number">900</span> stm=<span class="hljs-number">87</span>
  at android.os.BinderProxy.<span class="hljs-title function_ invoke__">transactNative</span>(Native Method)
  at android.os.BinderProxy.<span class="hljs-title function_ invoke__">transact</span>(Binder.<span class="hljs-attr">java</span>:<span class="hljs-number">1129</span>)
  - locked &lt;<span class="hljs-number">0x0a1b2c3d</span>&gt; (a java.lang.Object)
  at android.content.IContentProvider$Stub<span class="hljs-variable">$Proxy</span>.<span class="hljs-title function_ invoke__">query</span>(IContentProvider.<span class="hljs-attr">java</span>:xxx)
  at android.content.ContentResolver.<span class="hljs-title function_ invoke__">query</span>(ContentResolver.<span class="hljs-attr">java</span>:xxx)
  at com.example.app.DataManager.<span class="hljs-title function_ invoke__">loadFromDatabase</span>(DataManager.<span class="hljs-attr">java</span>:<span class="hljs-number">80</span>)
  at com.example.app.DataManager$<span class="hljs-number">1</span>.<span class="hljs-title function_ invoke__">run</span>(DataManager.<span class="hljs-attr">java</span>:<span class="hljs-number">60</span>)
  ...
</code></pre>
<p><strong>åˆ†ææ­¥éª¤</strong>:</p>
<ol>
<li><strong>çœ‹ä¸»çº¿ç¨‹çŠ¶æ€</strong>: <code>Blocked</code> - ä¸»çº¿ç¨‹è¢«é˜»å¡äº†</li>
<li><strong>çœ‹é˜»å¡ä½ç½®</strong>: <code>DataManager.getData()</code>ç¬¬45è¡Œ,åœ¨ç­‰ä¸€ä¸ªé”<code>&lt;0x0a1b2c3d&gt;</code></li>
<li><strong>æ‰¾æŒé”çº¿ç¨‹</strong>: Thread-15æŒæœ‰è¿™ä¸ªé”(<code>locked &lt;0x0a1b2c3d&gt;</code>)</li>
<li><strong>çœ‹æŒé”çº¿ç¨‹åœ¨å¹²å˜›</strong>: æ­£åœ¨è¿›è¡ŒBinderè°ƒç”¨<code>transactNative()</code>,æŸ¥è¯¢ContentProvider</li>
<li><strong>æ ¹æœ¬åŸå› </strong>: çº¿ç¨‹15æŒé”åšè€—æ—¶æ“ä½œ,ä¸»çº¿ç¨‹ç­‰ä¸åˆ°é”</li>
</ol>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ åŸä»£ç </span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataManager</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">mLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ä¸»çº¿ç¨‹è°ƒç”¨</span>
        <span class="hljs-keyword">synchronized</span> (mLock) {
            <span class="hljs-type">Data</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> getData();
            updateUI(data);
        }
    }

    <span class="hljs-keyword">private</span> Data <span class="hljs-title function_">getData</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// è¿˜æ˜¯åœ¨æŒé”çŠ¶æ€!</span>
        <span class="hljs-keyword">return</span> loadFromDatabase();  <span class="hljs-comment">// Binderè°ƒç”¨,å¾ˆæ…¢</span>
    }
}

<span class="hljs-comment">// âœ… ä¿®å¤å</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataManager</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">mLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å¼‚æ­¥åŠ è½½</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            Data data;
            <span class="hljs-keyword">synchronized</span> (mLock) {
                data = getData();
            }
            <span class="hljs-comment">// åœ¨ä¸»çº¿ç¨‹æ›´æ–°UI</span>
            runOnUiThread(() -&gt; updateUI(data));
        }).start();
    }
}
</code></pre>
<h3 data-id="heading-30">7.2 æ¡ˆä¾‹2:Binderè°ƒç”¨è¶…æ—¶å¯¼è‡´çš„ANR</h3>
<p><strong>ç°è±¡</strong>: åº”ç”¨åœ¨åå°,çªç„¶æ”¶åˆ°Broadcast ANR</p>
<p><strong>logcat</strong>:</p>
<pre><code class="hljs language-ini" lang="ini">12-25 11:00:00.123  1234  1250 W BroadcastQueue: Timeout of broadcast BroadcastRecord{a1b2c3d u0 android.intent.action.BATTERY_CHANGED} - <span class="hljs-attr">receiver</span>=android.content.IIntentReceiver<span class="hljs-variable">$Stub</span><span class="hljs-variable">$Proxy</span>@e4f5g6h
12-25 11:00:00.234  1234  1250 I ActivityManager: ANR in com.example.app (com.example.app/.MyReceiver)
12-25 11:00:00.234  1234  1250 I ActivityManager: Reason: Broadcast of Intent { <span class="hljs-attr">act</span>=android.intent.action.BATTERY_CHANGED }
</code></pre>
<p><strong>traces.txt</strong>:</p>
<pre><code class="hljs language-ini" lang="ini">"main" <span class="hljs-attr">prio</span>=<span class="hljs-number">5</span> tid=<span class="hljs-number">1</span> Native
  | <span class="hljs-attr">group</span>=<span class="hljs-string">"main"</span> sCount=<span class="hljs-number">1</span> dsCount=<span class="hljs-number">0</span> flags=<span class="hljs-number">1</span> obj=<span class="hljs-number">0</span>x74e04dd8
  | <span class="hljs-attr">sysTid</span>=<span class="hljs-number">23456</span> nice=<span class="hljs-number">0</span> cgrp=default sched=<span class="hljs-number">0</span>/<span class="hljs-number">0</span> handle=<span class="hljs-number">0</span>x7b5a9f49a8
  | <span class="hljs-attr">state</span>=S schedstat=( <span class="hljs-number">2345678901</span> <span class="hljs-number">1234567890</span> <span class="hljs-number">234</span> ) utm=<span class="hljs-number">200</span> stm=<span class="hljs-number">34</span>
  at android.os.BinderProxy.transactNative(Native Method)
  at android.os.BinderProxy.transact(Binder.java:1129)
  at android.app.IActivityManager$Stub$Proxy.registerContentObserver(IActivityManager.java:xxxx)
  at android.content.ContentResolver.registerContentObserver(ContentResolver.java:xxxx)
  at com.example.app.MyReceiver.onReceive(MyReceiver.java:30)
  at android.app.ActivityThread.handleReceiver(ActivityThread.java:xxxx)
  ...
</code></pre>
<p><strong>åˆ†æ</strong>:</p>
<ol>
<li><strong>ANRç±»å‹</strong>: Broadcast ANR</li>
<li><strong>ä¸»çº¿ç¨‹çŠ¶æ€</strong>: <code>Native</code> - æ­£åœ¨æ‰§è¡ŒNativeæ–¹æ³•</li>
<li><strong>å¡åœ¨å“ªé‡Œ</strong>: <code>BinderProxy.transactNative()</code> - Binderè°ƒç”¨</li>
<li><strong>åœ¨åšä»€ä¹ˆ</strong>: æ³¨å†ŒContentObserver</li>
<li><strong>ä¸ºä»€ä¹ˆæ…¢</strong>: å¯èƒ½System Serverç¹å¿™æˆ–Binderèµ„æºè€—å°½</li>
</ol>
<p><strong>æ ¹å› </strong>: åœ¨BroadcastReceiverä¸­è¿›è¡ŒåŒæ­¥Binderè°ƒç”¨,è€ŒSystem Serverå“åº”æ…¢</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ åŸä»£ç </span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyReceiver</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BroadcastReceiver</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onReceive</span><span class="hljs-params">(Context context, Intent intent)</span> {
        <span class="hljs-comment">// åŒæ­¥æ³¨å†ŒContentObserver,å¯èƒ½å¾ˆæ…¢</span>
        context.getContentResolver().registerContentObserver(
                Settings.System.getUriFor(Settings.System.SCREEN_BRIGHTNESS),
                <span class="hljs-literal">false</span>,
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">ContentObserver</span>(<span class="hljs-literal">null</span>) {
                    <span class="hljs-meta">@Override</span>
                    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onChange</span><span class="hljs-params">(<span class="hljs-type">boolean</span> selfChange)</span> {
                        <span class="hljs-comment">// ...</span>
                    }
                });
    }
}

<span class="hljs-comment">// âœ… ä¿®å¤æ–¹æ¡ˆ1:ä½¿ç”¨goAsync()</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyReceiver</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BroadcastReceiver</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onReceive</span><span class="hljs-params">(Context context, Intent intent)</span> {
        <span class="hljs-keyword">final</span> <span class="hljs-type">PendingResult</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> goAsync();

        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">try</span> {
                context.getContentResolver().registerContentObserver(...);
            } <span class="hljs-keyword">finally</span> {
                result.finish();
            }
        }).start();
    }
}

<span class="hljs-comment">// âœ… ä¿®å¤æ–¹æ¡ˆ2:å»¶è¿Ÿæ³¨å†Œ</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyReceiver</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BroadcastReceiver</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onReceive</span><span class="hljs-params">(Context context, Intent intent)</span> {
        <span class="hljs-comment">// å¯åŠ¨Serviceå»¶è¿Ÿæ³¨å†Œ</span>
        <span class="hljs-type">Intent</span> <span class="hljs-variable">serviceIntent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(context, RegistrationService.class);
        context.startService(serviceIntent);
    }
}
</code></pre>
<h3 data-id="heading-31">7.3 æ¡ˆä¾‹3:ä¸»çº¿ç¨‹åšæ•°æ®åº“æ“ä½œ</h3>
<p><strong>traces.txt</strong>:</p>
<pre><code class="hljs language-less" lang="less">"<span class="hljs-selector-tag">main</span>" <span class="hljs-selector-tag">prio</span>=<span class="hljs-number">5</span> <span class="hljs-selector-tag">tid</span>=<span class="hljs-number">1</span> <span class="hljs-selector-tag">Native</span>
  | <span class="hljs-selector-tag">sysTid</span>=<span class="hljs-number">34567</span> <span class="hljs-selector-tag">nice</span>=<span class="hljs-selector-tag">-10</span>
  <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">android</span><span class="hljs-selector-class">.database</span><span class="hljs-selector-class">.sqlite</span><span class="hljs-selector-class">.SQLiteConnection</span><span class="hljs-selector-class">.nativeExecute</span>(Native Method)
  <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">android</span><span class="hljs-selector-class">.database</span><span class="hljs-selector-class">.sqlite</span><span class="hljs-selector-class">.SQLiteConnection</span><span class="hljs-selector-class">.execute</span>(SQLiteConnection.<span class="hljs-attribute">java</span>:<span class="hljs-number">609</span>)
  <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">android</span><span class="hljs-selector-class">.database</span><span class="hljs-selector-class">.sqlite</span><span class="hljs-selector-class">.SQLiteSession</span><span class="hljs-selector-class">.executeForCursorWindow</span>(SQLiteSession.<span class="hljs-attribute">java</span>:<span class="hljs-number">820</span>)
  <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">android</span><span class="hljs-selector-class">.database</span><span class="hljs-selector-class">.sqlite</span><span class="hljs-selector-class">.SQLiteQuery</span><span class="hljs-selector-class">.fillWindow</span>(SQLiteQuery.<span class="hljs-attribute">java</span>:<span class="hljs-number">62</span>)
  <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">android</span><span class="hljs-selector-class">.database</span><span class="hljs-selector-class">.sqlite</span><span class="hljs-selector-class">.SQLiteCursor</span><span class="hljs-selector-class">.fillWindow</span>(SQLiteCursor.<span class="hljs-attribute">java</span>:<span class="hljs-number">144</span>)
  <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">android</span><span class="hljs-selector-class">.database</span><span class="hljs-selector-class">.sqlite</span><span class="hljs-selector-class">.SQLiteCursor</span><span class="hljs-selector-class">.getCount</span>(SQLiteCursor.<span class="hljs-attribute">java</span>:<span class="hljs-number">134</span>)
  <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.app</span><span class="hljs-selector-class">.DatabaseHelper</span><span class="hljs-selector-class">.queryAllRecords</span>(DatabaseHelper.<span class="hljs-attribute">java</span>:<span class="hljs-number">150</span>)
  <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.app</span><span class="hljs-selector-class">.MainActivity</span><span class="hljs-selector-class">.onCreate</span>(MainActivity.<span class="hljs-attribute">java</span>:<span class="hljs-number">50</span>)
  ...
</code></pre>
<p><strong>åˆ†æ</strong>:</p>
<ul>
<li>ä¸»çº¿ç¨‹åœ¨æ‰§è¡ŒSQLiteæŸ¥è¯¢</li>
<li><code>getCount()</code>ä¼šåŠ è½½æ‰€æœ‰æ•°æ®åˆ°Cursor</li>
<li>æ•°æ®é‡å¤§æ—¶ä¼šå¾ˆæ…¢</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ åŸä»£ç </span>
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> {
    <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    <span class="hljs-comment">// ä¸»çº¿ç¨‹æŸ¥è¯¢æ•°æ®åº“</span>
    <span class="hljs-type">Cursor</span> <span class="hljs-variable">cursor</span> <span class="hljs-operator">=</span> mDbHelper.queryAllRecords();
    <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> cursor.getCount();  <span class="hljs-comment">// è§¦å‘å®é™…æŸ¥è¯¢</span>
    processData(cursor);
}

<span class="hljs-comment">// âœ… ä½¿ç”¨AsyncTask(å·²åºŸå¼ƒ,ä»…ä½œç¤ºä¾‹)</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> {
    <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    <span class="hljs-keyword">new</span> <span class="hljs-title class_">QueryTask</span>().execute();
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">QueryTask</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AsyncTask</span>&lt;Void, Void, Cursor&gt; {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> Cursor <span class="hljs-title function_">doInBackground</span><span class="hljs-params">(Void... voids)</span> {
        <span class="hljs-keyword">return</span> mDbHelper.queryAllRecords();
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onPostExecute</span><span class="hljs-params">(Cursor cursor)</span> {
        processData(cursor);
    }
}

<span class="hljs-comment">// âœ… ä½¿ç”¨Kotlin Coroutines(æ¨è)</span>
override fun <span class="hljs-title function_">onCreate</span><span class="hljs-params">(savedInstanceState: Bundle?)</span> {
    <span class="hljs-built_in">super</span>.onCreate(savedInstanceState)
    setContentView(R.layout.activity_main)

    lifecycleScope.launch {
        <span class="hljs-type">val</span> <span class="hljs-variable">cursor</span> <span class="hljs-operator">=</span> withContext(Dispatchers.IO) {
            dbHelper.queryAllRecords()
        }
        processData(cursor)
    }
}

<span class="hljs-comment">// âœ… ä½¿ç”¨Room + LiveData(æœ€ä½³å®è·µ)</span>
<span class="hljs-meta">@Dao</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">RecordDao</span> {
    <span class="hljs-meta">@Query("SELECT * FROM records")</span>
    fun <span class="hljs-title function_">getAllRecords</span><span class="hljs-params">()</span>: LiveData&lt;List&lt;Record&gt;&gt;
}

override fun <span class="hljs-title function_">onCreate</span><span class="hljs-params">(savedInstanceState: Bundle?)</span> {
    <span class="hljs-built_in">super</span>.onCreate(savedInstanceState)
    setContentView(R.layout.activity_main)

    viewModel.records.observe(<span class="hljs-built_in">this</span>) { records -&gt;
        processData(records)
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-32">å…«ã€ANRçš„é¢„é˜²å’Œç›‘æ§</h2>
<p>é¢„é˜²èƒœäºæ²»ç–—ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨å¼€å‘é˜¶æ®µå°±é¿å…ANR,ä»¥åŠå¦‚ä½•å»ºç«‹æœ‰æ•ˆçš„ç›‘æ§ä½“ç³»ã€‚</p>
<h3 data-id="heading-33">8.1 å¼€å‘é˜¶æ®µçš„é¢„é˜²æªæ–½</h3>
<p><strong>1. ä½¿ç”¨StrictModeæ£€æµ‹ä¸»çº¿ç¨‹è¿è§„</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApplication</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Application</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.onCreate();

        <span class="hljs-keyword">if</span> (BuildConfig.DEBUG) {
            StrictMode.setThreadPolicy(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StrictMode</span>.ThreadPolicy.Builder()
                    .detectDiskReads()    <span class="hljs-comment">// æ£€æµ‹ç£ç›˜è¯»å–</span>
                    .detectDiskWrites()   <span class="hljs-comment">// æ£€æµ‹ç£ç›˜å†™å…¥</span>
                    .detectNetwork()      <span class="hljs-comment">// æ£€æµ‹ç½‘ç»œæ“ä½œ</span>
                    .detectCustomSlowCalls()  <span class="hljs-comment">// æ£€æµ‹è‡ªå®šä¹‰æ…¢è°ƒç”¨</span>
                    .penaltyLog()         <span class="hljs-comment">// è¾“å‡ºåˆ°logcat</span>
                    .penaltyDeath()       <span class="hljs-comment">// ç›´æ¥crash(å¼€å‘é˜¶æ®µ)</span>
                    .build());

            StrictMode.setVmPolicy(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StrictMode</span>.VmPolicy.Builder()
                    .detectLeakedSqlLiteObjects()  <span class="hljs-comment">// æ£€æµ‹æ•°æ®åº“æ³„æ¼</span>
                    .detectLeakedClosableObjects() <span class="hljs-comment">// æ£€æµ‹æœªå…³é—­çš„å¯¹è±¡</span>
                    .penaltyLog()
                    .build());
        }
    }
}
</code></pre>
<p><strong>2. ä½¿ç”¨BlockCanaryæ£€æµ‹å¡é¡¿</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åˆå§‹åŒ–BlockCanary</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApplication</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Application</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.onCreate();

        BlockCanary.install(<span class="hljs-built_in">this</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">AppBlockCanaryContext</span>()).start();
    }
}

<span class="hljs-comment">// è‡ªå®šä¹‰é…ç½®</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppBlockCanaryContext</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BlockCanaryContext</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">provideBlockThreshold</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-number">500</span>;  <span class="hljs-comment">// è¶…è¿‡500msåˆ¤å®šä¸ºå¡é¡¿</span>
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">displayNotification</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> BuildConfig.DEBUG;  <span class="hljs-comment">// ä»…debugç¯å¢ƒæ˜¾ç¤ºé€šçŸ¥</span>
    }
}
</code></pre>
<p><strong>3. ä½¿ç”¨TraceViewåˆ†ææ€§èƒ½</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åœ¨å¯ç–‘ä»£ç å‰åæ·»åŠ trace</span>
Debug.startMethodTracing(<span class="hljs-string">"my_trace"</span>);
<span class="hljs-comment">// å¯ç–‘çš„ä»£ç </span>
suspiciousMethod();
Debug.stopMethodTracing();

<span class="hljs-comment">// å¯¼å‡ºtraceæ–‡ä»¶</span>
adb pull /sdcard/Android/data/&lt;<span class="hljs-keyword">package</span>&gt;/files/my_trace.trace .

<span class="hljs-comment">// ä½¿ç”¨Android Studioçš„Profileråˆ†æ</span>
</code></pre>
<h3 data-id="heading-34">8.2 çº¿ä¸Šç›‘æ§ä½“ç³»</h3>
<p><strong>1. ANRæ•è·å’Œä¸ŠæŠ¥</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ANRWatchDog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> mTimeout;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Handler</span> <span class="hljs-variable">mHandler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handler</span>(Looper.getMainLooper());

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ANRWatchDog</span><span class="hljs-params">(<span class="hljs-type">int</span> timeout)</span> {
        <span class="hljs-built_in">super</span>(<span class="hljs-string">"ANR-WatchDog"</span>);
        <span class="hljs-built_in">this</span>.mTimeout = timeout;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">while</span> (!isInterrupted()) {
            <span class="hljs-comment">// 1. è®°å½•å½“å‰æ—¶é—´</span>
            <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">startTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
            <span class="hljs-keyword">final</span> <span class="hljs-type">AtomicLong</span> <span class="hljs-variable">executionTime</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicLong</span>();

            <span class="hljs-comment">// 2. å‘ä¸»çº¿ç¨‹å‘é€ä»»åŠ¡</span>
            mHandler.post(() -&gt; {
                executionTime.set(System.currentTimeMillis());
            });

            <span class="hljs-comment">// 3. ç­‰å¾…ä¸€æ®µæ—¶é—´</span>
            <span class="hljs-keyword">try</span> {
                Thread.sleep(mTimeout);
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                <span class="hljs-keyword">return</span>;
            }

            <span class="hljs-comment">// 4. æ£€æŸ¥ä»»åŠ¡æ˜¯å¦æ‰§è¡Œ</span>
            <span class="hljs-type">long</span> <span class="hljs-variable">execTime</span> <span class="hljs-operator">=</span> executionTime.get();
            <span class="hljs-keyword">if</span> (execTime == <span class="hljs-number">0</span> || System.currentTimeMillis() - execTime &gt; mTimeout) {
                <span class="hljs-comment">// æ£€æµ‹åˆ°ANR!</span>
                onAnrDetected();
            }
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onAnrDetected</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// 1. æ”¶é›†å †æ ˆä¿¡æ¯</span>
        Map&lt;Thread, StackTraceElement[]&gt; stackTraces = Thread.getAllStackTraces();

        <span class="hljs-comment">// 2. ä¸ŠæŠ¥åˆ°æœåŠ¡å™¨</span>
        ANRReporter.report(stackTraces);
    }
}

<span class="hljs-comment">// å¯åŠ¨ç›‘æ§</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">ANRWatchDog</span>(<span class="hljs-number">5000</span>).start();
</code></pre>
<p><strong>2. ä½¿ç”¨Buglyç­‰ç¬¬ä¸‰æ–¹å¹³å°</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApplication</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Application</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.onCreate();

        <span class="hljs-comment">// åˆå§‹åŒ–Bugly</span>
        CrashReport.initCrashReport(getApplicationContext(), <span class="hljs-string">"YOUR_APP_ID"</span>, BuildConfig.DEBUG);

        <span class="hljs-comment">// é…ç½®ANRç›‘æ§</span>
        CrashReport.<span class="hljs-type">UserStrategy</span> <span class="hljs-variable">strategy</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CrashReport</span>.UserStrategy(getApplicationContext());
        strategy.setAppReportDelay(<span class="hljs-number">10000</span>);  <span class="hljs-comment">// å»¶è¿Ÿä¸ŠæŠ¥</span>
        CrashReport.initCrashReport(getApplicationContext(), <span class="hljs-string">"YOUR_APP_ID"</span>, BuildConfig.DEBUG, strategy);
    }
}
</code></pre>
<p><strong>3. ç›‘æ§å…³é”®æŒ‡æ ‡</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PerformanceMonitor</span> {
    <span class="hljs-comment">// ç›‘æ§ä¸»çº¿ç¨‹æ¶ˆæ¯å¤„ç†æ—¶é—´</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">monitorMainLooper</span><span class="hljs-params">()</span> {
        Looper.getMainLooper().setMessageLogging(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Printer</span>() {
            <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">START</span> <span class="hljs-operator">=</span> <span class="hljs-string">"&gt;&gt;&gt;&gt;&gt; Dispatching"</span>;
            <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">END</span> <span class="hljs-operator">=</span> <span class="hljs-string">"&lt;&lt;&lt;&lt;&lt; Finished"</span>;

            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">println</span><span class="hljs-params">(String msg)</span> {
                <span class="hljs-keyword">if</span> (msg.startsWith(START)) {
                    <span class="hljs-comment">// æ¶ˆæ¯å¼€å§‹å¤„ç†</span>
                    mStartTime = System.currentTimeMillis();
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (msg.startsWith(END)) {
                    <span class="hljs-comment">// æ¶ˆæ¯å¤„ç†å®Œæ¯•</span>
                    <span class="hljs-type">long</span> <span class="hljs-variable">duration</span> <span class="hljs-operator">=</span> System.currentTimeMillis() - mStartTime;
                    <span class="hljs-keyword">if</span> (duration &gt; <span class="hljs-number">100</span>) {  <span class="hljs-comment">// è¶…è¿‡100ms</span>
                        <span class="hljs-comment">// è®°å½•æ…¢æ¶ˆæ¯</span>
                        logSlowMessage(msg, duration);
                    }
                }
            }
        });
    }

    <span class="hljs-comment">// ç›‘æ§æ–¹æ³•æ‰§è¡Œæ—¶é—´</span>
    <span class="hljs-meta">@Around("execution(* com.example.app..*(..))")</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">measureMethod</span><span class="hljs-params">(ProceedingJoinPoint joinPoint)</span> <span class="hljs-keyword">throws</span> Throwable {
        <span class="hljs-type">long</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
        <span class="hljs-type">Object</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> joinPoint.proceed();
        <span class="hljs-type">long</span> <span class="hljs-variable">duration</span> <span class="hljs-operator">=</span> System.currentTimeMillis() - start;

        <span class="hljs-keyword">if</span> (duration &gt; <span class="hljs-number">50</span>) {  <span class="hljs-comment">// è¶…è¿‡50ms</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> joinPoint.getSignature().toShortString();
            Log.w(<span class="hljs-string">"Performance"</span>, method + <span class="hljs-string">" took "</span> + duration + <span class="hljs-string">"ms"</span>);
        }

        <span class="hljs-keyword">return</span> result;
    }
}
</code></pre>
<h3 data-id="heading-35">8.3 ANRä¼˜åŒ–çš„æœ€ä½³å®è·µ</h3>
<p><strong>1. ä¸»çº¿ç¨‹çš„é»„é‡‘æ³•åˆ™</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">ä¸»çº¿ç¨‹åªåšä¸‰ä»¶äº‹:
<span class="hljs-bullet">1.</span> æ›´æ–°UI
<span class="hljs-bullet">2.</span> åˆ†å‘äº‹ä»¶
<span class="hljs-bullet">3.</span> å¯åŠ¨å¼‚æ­¥ä»»åŠ¡

ç»å¯¹ä¸èƒ½åš:
<span class="hljs-bullet">1.</span> ç£ç›˜I/O (è¯»å†™æ–‡ä»¶ã€æ•°æ®åº“)
<span class="hljs-bullet">2.</span> ç½‘ç»œI/O (HTTPè¯·æ±‚ã€Socketé€šä¿¡)
<span class="hljs-bullet">3.</span> å¤æ‚è®¡ç®— (å¤§æ•°æ®å¤„ç†ã€åŠ å¯†è§£å¯†)
<span class="hljs-bullet">4.</span> åŒæ­¥Binderè°ƒç”¨ (ContentProviderã€System Service)
<span class="hljs-bullet">5.</span> ç­‰å¾…é” (synchronizedã€Lock)
</code></pre>
<p><strong>2. ä½¿ç”¨å¼‚æ­¥æœºåˆ¶</strong></p>








































<table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ–¹æ¡ˆ</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>ç®€å•å¼‚æ­¥ä»»åŠ¡</td><td><code>HandlerThread</code> + <code>Handler</code></td><td>åå°æ•°æ®å¤„ç†</td></tr><tr><td>ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥</td><td><code>ViewModel</code> + <code>LiveData</code></td><td>UIæ•°æ®åŠ è½½</td></tr><tr><td>å¤æ‚åç¨‹</td><td>Kotlin <code>Coroutines</code></td><td>ç½‘ç»œè¯·æ±‚+æ•°æ®åº“</td></tr><tr><td>å®šæ—¶ä»»åŠ¡</td><td><code>WorkManager</code></td><td>å®šæœŸåŒæ­¥</td></tr><tr><td>æ–‡ä»¶I/O</td><td><code>Executors.newSingleThreadExecutor()</code></td><td>æ—¥å¿—å†™å…¥</td></tr><tr><td>æ•°æ®åº“</td><td><code>Room</code> + <code>LiveData</code></td><td>æœ¬åœ°æ•°æ®è®¿é—®</td></tr></tbody></table>
<p><strong>3. ä¼˜åŒ–Binderè°ƒç”¨</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ ä¸»çº¿ç¨‹åŒæ­¥è°ƒç”¨ContentProvider</span>
<span class="hljs-type">Cursor</span> <span class="hljs-variable">cursor</span> <span class="hljs-operator">=</span> getContentResolver().query(uri, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);

<span class="hljs-comment">// âœ… ä½¿ç”¨ContentProviderOperationæ‰¹é‡æ“ä½œ</span>
ArrayList&lt;ContentProviderOperation&gt; ops = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
ops.add(ContentProviderOperation.newInsert(uri).withValues(values1).build());
ops.add(ContentProviderOperation.newInsert(uri).withValues(values2).build());
getContentResolver().applyBatch(AUTHORITY, ops);

<span class="hljs-comment">// âœ… ä½¿ç”¨AsyncQueryHandlerå¼‚æ­¥æŸ¥è¯¢</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">AsyncQueryHandler</span>(getContentResolver()) {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onQueryComplete</span><span class="hljs-params">(<span class="hljs-type">int</span> token, Object cookie, Cursor cursor)</span> {
        processData(cursor);
    }
}.startQuery(<span class="hljs-number">0</span>, <span class="hljs-literal">null</span>, uri, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);
</code></pre>
<p><strong>4. å‡å°‘é”ç«äº‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ ç²—ç²’åº¦é”</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataCache</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, Data&gt; mCache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> Data <span class="hljs-title function_">get</span><span class="hljs-params">(String key)</span> {
        <span class="hljs-type">Data</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> mCache.get(key);
        <span class="hljs-keyword">if</span> (data == <span class="hljs-literal">null</span>) {
            data = loadFromDisk(key);  <span class="hljs-comment">// è€—æ—¶æ“ä½œåœ¨æŒé”çŠ¶æ€!</span>
            mCache.put(key, data);
        }
        <span class="hljs-keyword">return</span> data;
    }
}

<span class="hljs-comment">// âœ… ç»†ç²’åº¦é” + Double-Check</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataCache</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ConcurrentHashMap&lt;String, Data&gt; mCache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">mLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

    <span class="hljs-keyword">public</span> Data <span class="hljs-title function_">get</span><span class="hljs-params">(String key)</span> {
        <span class="hljs-type">Data</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> mCache.get(key);
        <span class="hljs-keyword">if</span> (data == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">synchronized</span> (mLock) {
                data = mCache.get(key);
                <span class="hljs-keyword">if</span> (data == <span class="hljs-literal">null</span>) {
                    data = loadFromDisk(key);  <span class="hljs-comment">// åªæœ‰å¿…è¦æ—¶æ‰æŒé”</span>
                    mCache.put(key, data);
                }
            }
        }
        <span class="hljs-keyword">return</span> data;
    }
}

<span class="hljs-comment">// âœ… ä½¿ç”¨Lock + tryLocké¿å…æ­»ç­‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataCache</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">mLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();

    <span class="hljs-keyword">public</span> Data <span class="hljs-title function_">get</span><span class="hljs-params">(String key)</span> {
        <span class="hljs-keyword">if</span> (mLock.tryLock(<span class="hljs-number">100</span>, TimeUnit.MILLISECONDS)) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">return</span> loadData(key);
            } <span class="hljs-keyword">finally</span> {
                mLock.unlock();
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// è·å–é”å¤±è´¥,è¿”å›é»˜è®¤å€¼æˆ–å¼‚æ­¥åŠ è½½</span>
            <span class="hljs-keyword">return</span> getDefaultValue();
        }
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-36">ä¹ã€æ€»ç»“ä¸å±•æœ›</h2>
<p>è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹ANRæœºåˆ¶çš„å…¨è²Œ:</p>
<h3 data-id="heading-37">9.1 æ ¸å¿ƒè¦ç‚¹å›é¡¾</h3>
<p><strong>ANRçš„4ç§ç±»å‹</strong>:</p>
<ul>
<li><strong>Input ANR</strong>: 5ç§’æ— å“åº”,ç”±InputDispatcheræ£€æµ‹</li>
<li><strong>Broadcast ANR</strong>: 10ç§’/60ç§’,ç”±ActivityManagerServiceæ£€æµ‹</li>
<li><strong>Service ANR</strong>: 20ç§’/200ç§’,ç”±ActivityManagerServiceæ£€æµ‹</li>
<li><strong>ContentProvider ANR</strong>: 10ç§’,ç”±ActivityManagerServiceæ£€æµ‹</li>
</ul>
<p><strong>ANRæ£€æµ‹æœºåˆ¶</strong>:</p>
<ul>
<li><strong>Input</strong>: äº‹ä»¶å…¥é˜Ÿæ—¶è®°å½•æ—¶é—´æˆ³,å®šæ—¶æ£€æŸ¥waitQueue</li>
<li><strong>Broadcast/Service</strong>: å‘é€å»¶æ—¶æ¶ˆæ¯,è¶…æ—¶è§¦å‘Handlerå›è°ƒ</li>
</ul>
<p><strong>ANRå¤„ç†æµç¨‹</strong>:</p>
<pre><code class="hljs language-scss" lang="scss">æ£€æµ‹è¶…æ—¶ â†’ è°ƒç”¨<span class="hljs-built_in">appNotResponding</span>() â†’ æ”¶é›†CPU/å†…å­˜ä¿¡æ¯
â†’ dumpçº¿ç¨‹å †æ ˆ â†’ ç”Ÿæˆtraces<span class="hljs-selector-class">.txt</span> â†’ å†™å…¥DropBox â†’ å¼¹å‡ºDialog
</code></pre>
<p><strong>traces.txtçš„å…³é”®ä¿¡æ¯</strong>:</p>
<ul>
<li>çº¿ç¨‹çŠ¶æ€: Blocked/Waiting/Native/Runnable</li>
<li>å †æ ˆä¿¡æ¯: æ–¹æ³•è°ƒç”¨é“¾</li>
<li>é”ä¿¡æ¯: waiting to lock / locked</li>
</ul>
<h3 data-id="heading-38">9.2 ANRä¼˜åŒ–çš„é‡‘å­—å¡”</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff3e30c9a4a74efeaddc3eae26e4549c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767424897&amp;x-signature=1MwwEhjyYQaL15IFWwUlZYM5dMY%3D" alt="02-04-anr-prevention-priority.png" loading="lazy"/></p>
<h3 data-id="heading-39">9.3 å®æˆ˜å»ºè®®</h3>
<ol>
<li>
<p><strong>å¼€å‘é˜¶æ®µ</strong>:</p>
<ul>
<li>å¼€å¯StrictMode</li>
<li>ä½¿ç”¨BlockCanary</li>
<li>Code Reviewå…³æ³¨ä¸»çº¿ç¨‹æ“ä½œ</li>
</ul>
</li>
<li>
<p><strong>æµ‹è¯•é˜¶æ®µ</strong>:</p>
<ul>
<li>å‹åŠ›æµ‹è¯•</li>
<li>Monkeyæµ‹è¯•</li>
<li>æ€§èƒ½æµ‹è¯•(TraceViewã€Systrace)</li>
</ul>
</li>
<li>
<p><strong>çº¿ä¸Šé˜¶æ®µ</strong>:</p>
<ul>
<li>æ¥å…¥Buglyç­‰ç›‘æ§å¹³å°</li>
<li>å®šæœŸåˆ†æANR Topæ¦œ</li>
<li>å»ºç«‹ANRå¿«é€Ÿå“åº”æœºåˆ¶</li>
</ul>
</li>
</ol>
<h3 data-id="heading-40">9.4 åç»­æ–‡ç« é¢„å‘Š</h3>
<p>ANRæœºåˆ¶åªæ˜¯ç¨³å®šæ€§çš„ä¸€ä¸ªæ–¹é¢ã€‚åœ¨åç»­æ–‡ç« ä¸­,æˆ‘ä»¬å°†ç»§ç»­æ·±å…¥:</p>



































<table><thead><tr><th>æ–‡ç« </th><th>ä¸»é¢˜</th><th>æ ¸å¿ƒå†…å®¹</th></tr></thead><tbody><tr><td>ç¬¬3ç¯‡</td><td>ANRé—®é¢˜æ’æŸ¥å®æˆ˜</td><td>traces.txtæ·±åº¦è§£è¯»ã€Systraceåˆ†æã€å¸¸è§ANRæ¡ˆä¾‹</td></tr><tr><td>ç¬¬4ç¯‡</td><td>å¼‚å¸¸æ—¥å¿—æœºåˆ¶</td><td>Crashå¤„ç†ã€Tombstoneåˆ†æã€ä¿¡å·æœºåˆ¶</td></tr><tr><td>ç¬¬5ç¯‡</td><td>Native Crashæ·±åº¦åˆ†æ</td><td>debuggerdã€ç¬¦å·åŒ–ã€coredump</td></tr><tr><td>ç¬¬6ç¯‡</td><td>Javaå¼‚å¸¸ä¸JEåˆ†æå®æˆ˜</td><td>Javaå¼‚å¸¸çš„åˆ†æå®æˆ˜</td></tr><tr><td>ç¬¬7ç¯‡</td><td>Watchdogæœºåˆ¶</td><td>ç³»ç»Ÿçœ‹é—¨ç‹—ã€åŠæ­»é”æ£€æµ‹ã€System Serverä¿æŠ¤</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-41">å‚è€ƒèµ„æ–™</h2>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Ftopic%2Fperformance%2Fvitals%2Fanr" target="_blank" title="https://developer.android.com/topic/performance/vitals/anr" ref="nofollow noopener noreferrer">Androidå®˜æ–¹æ–‡æ¡£ - ANR</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcs.android.com%2Fandroid%2Fplatform%2Fsuperproject%2F%2B%2Fmaster%3Aframeworks%2Fnative%2Fservices%2Finputflinger%2Fdispatcher%2FInputDispatcher.cpp" target="_blank" title="https://cs.android.com/android/platform/superproject/+/master:frameworks/native/services/inputflinger/dispatcher/InputDispatcher.cpp" ref="nofollow noopener noreferrer">AOSPæºç  - InputDispatcher.cpp</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcs.android.com%2Fandroid%2Fplatform%2Fsuperproject%2F%2B%2Fmaster%3Aframeworks%2Fbase%2Fservices%2Fcore%2Fjava%2Fcom%2Fandroid%2Fserver%2Fam%2FActivityManagerService.java" target="_blank" title="https://cs.android.com/android/platform/superproject/+/master:frameworks/base/services/core/java/com/android/server/am/ActivityManagerService.java" ref="nofollow noopener noreferrer">AOSPæºç  - ActivityManagerService.java</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcs.android.com%2Fandroid%2Fplatform%2Fsuperproject%2F%2B%2Fmaster%3Aframeworks%2Fbase%2Fservices%2Fcore%2Fjava%2Fcom%2Fandroid%2Fserver%2Fam%2FBroadcastQueue.java" target="_blank" title="https://cs.android.com/android/platform/superproject/+/master:frameworks/base/services/core/java/com/android/server/am/BroadcastQueue.java" ref="nofollow noopener noreferrer">AOSPæºç  - BroadcastQueue.java</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.youtube.com%2Fplaylist%3Flist%3DPLWz5rJ2EKKc9CBxr3BVjPTPoDPLdPIFCE" target="_blank" title="https://www.youtube.com/playlist?list=PLWz5rJ2EKKc9CBxr3BVjPTPoDPLdPIFCE" ref="nofollow noopener noreferrer">Android Performance Patterns</a></li>
</ol>
<p><strong>ä¸Šä¸€ç¯‡</strong>ï¼š<a href="https://juejin.cn/post/7587776610436497423" target="_blank" title="https://juejin.cn/post/7587776610436497423">ç¨³å®šæ€§æ€§èƒ½ç³»åˆ—ä¹‹ä¸€â€”â€”Androidç¨³å®šæ€§åŸºç¡€:ç³»ç»Ÿæ¶æ„ä¸å…³é”®æœºåˆ¶</a><br/>
<strong>ä¸‹ä¸€ç¯‡</strong>ï¼š<a href="https://juejin.cn/post/7588004601392906274" target="_blank" title="https://juejin.cn/post/7588004601392906274">ç¨³å®šæ€§æ€§èƒ½ç³»åˆ—ä¹‹ä¸‰â€”â€”ANRé—®é¢˜æ’æŸ¥å®æˆ˜:æ—¥å¿—åˆ†æä¸å·¥å…·å®æˆ˜</a><br/>
<strong>è¿”å›ä¸“æ ç›®å½•</strong>: <a href="https://juejin.cn/post/7587473691170095104" target="_blank" title="https://juejin.cn/post/7587473691170095104">Androidç¨³å®šæ€§&amp;æ€§èƒ½æ·±å…¥ç†è§£ä¸“æ ä»‹ç»</a></p>
<hr/>
<blockquote>
<p><strong>ä½œè€…ç®€ä»‹</strong>: å¤šå¹´Androidç³»ç»Ÿå¼€å‘ç»éªŒ,ä¸“æ³¨äºç³»ç»Ÿç¨³å®šæ€§ä¸æ€§èƒ½ä¼˜åŒ–é¢†åŸŸã€‚æ¬¢è¿å…³æ³¨æœ¬ç³»åˆ—,ä¸€èµ·æ·±å…¥Androidç³»ç»Ÿçš„ç²¾å½©ä¸–ç•Œ!</p>
</blockquote>
<hr/>
<h3 data-id="heading-42">ğŸ‰ æ„Ÿè°¢å…³æ³¨,è®©æˆ‘ä»¬ä¸€èµ·æ·±å…¥Androidç³»ç»Ÿçš„ç²¾å½©ä¸–ç•Œ!     æ‰¾åˆ°æˆ‘: <a href="https://link.juejin.cn?target=https%3A%2F%2Fhome.wonlab.top" target="_blank" title="https://home.wonlab.top" ref="nofollow noopener noreferrer">ä¸ªäººä¸»é¡µ</a></h3></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaçš„ç±»åŠ è½½è¿‡ç¨‹]]></title>    <link>https://juejin.cn/post/7588067055481880585</link>    <guid>https://juejin.cn/post/7588067055481880585</guid>    <pubDate>2025-12-27T08:27:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588067055481880585" data-draft-id="7588031908172251145" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaçš„ç±»åŠ è½½è¿‡ç¨‹"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-27T08:27:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="kevinzeng"/> <meta itemprop="url" content="https://juejin.cn/user/1964143993949127"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaçš„ç±»åŠ è½½è¿‡ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1964143993949127/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    kevinzeng
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T08:27:48.000Z" title="Sat Dec 27 2025 08:27:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Java ç±»åŠ è½½å…¨è¿‡ç¨‹ï¼ˆå®Œæ•´+æ˜“æ‡‚ç‰ˆï¼Œå«åº•å±‚åŸç†ï¼‰</h2>
<p>Java ç±»åŠ è½½æ˜¯ <strong>JVM å°†</strong> <strong><code>.class</code></strong> <strong>å­—èŠ‚ç æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ï¼Œå¹¶å¯¹å…¶è¿›è¡ŒéªŒè¯ã€å‡†å¤‡ã€è§£æã€åˆå§‹åŒ–ï¼Œæœ€ç»ˆå½¢æˆå¯è¢« JVM ç›´æ¥ä½¿ç”¨çš„ Java ç±»å‹</strong> çš„å…¨è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹å‘ç”Ÿåœ¨<strong>ç¨‹åºè¿è¡ŒæœŸé—´ï¼ˆåŠ¨æ€åŠ è½½ï¼‰</strong> ï¼Œè€Œéç¼–è¯‘æœŸï¼Œæ˜¯ JVM å®ç°ã€Œè·¨å¹³å°ã€ã€ŒåŠ¨æ€æ‰©å±•ã€çš„æ ¸å¿ƒåŸºç¡€ã€‚</p>
<p>âœ… æ ¸å¿ƒç»“è®ºï¼šJava ç±»åŠ è½½æµç¨‹éµå¾ª <strong>ã€ŒåŠ è½½ â†’ éªŒè¯ â†’ å‡†å¤‡ â†’ è§£æ â†’ åˆå§‹åŒ–ã€</strong> 5ä¸ªå›ºå®šé˜¶æ®µï¼Œå…¶ä¸­ã€Œè§£æã€é˜¶æ®µå¯ç©¿æ’è‡³ã€Œåˆå§‹åŒ–ã€ä¹‹åæ‰§è¡Œï¼Œæ•´ä½“ä¸¥æ ¼æŒ‰é¡ºåºæ¨è¿›ï¼Œç¼ºä¸€ä¸å¯ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€ç±»åŠ è½½æ•´ä½“ç”Ÿå‘½å‘¨æœŸï¼ˆå…¨æµç¨‹æ€»è§ˆï¼‰</h3>
<p>ä¸€ä¸ª Java ç±»ä»è¢«åŠ è½½åˆ° JVM å†…å­˜ä¸­ï¼Œåˆ°æœ€ç»ˆè¢«å¸è½½ï¼Œå®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸåŒ…å« <strong>7ä¸ªé˜¶æ®µ</strong>ï¼Œå…¶ä¸­<strong>å‰5ä¸ªæ˜¯ã€Œç±»åŠ è½½çš„æ ¸å¿ƒæµç¨‹ã€</strong>ï¼Œå2ä¸ªæ˜¯ç±»åŠ è½½å®Œæˆåçš„è¿è¡Œä¸é”€æ¯é˜¶æ®µï¼Œæ•´ä½“æµç¨‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs">åŠ è½½ â†’ éªŒè¯ â†’ å‡†å¤‡ â†’ è§£æ â†’ åˆå§‹åŒ– â†’ ä½¿ç”¨ â†’ å¸è½½
</code></pre>
<p>ğŸ’¡ å…³é”®ç‰¹æ€§ï¼š</p>
<ol>
<li>åŠ è½½ã€éªŒè¯ã€å‡†å¤‡ã€åˆå§‹åŒ–ã€å¸è½½ <strong>5ä¸ªé˜¶æ®µçš„æ‰§è¡Œé¡ºåºæ˜¯å›ºå®šçš„</strong>ï¼Œå¿…é¡»æŒ‰åºæ¨è¿›ï¼›</li>
<li><strong>è§£æé˜¶æ®µæ˜¯çµæ´»çš„</strong>ï¼šå¯ä»¥åœ¨ã€Œå‡†å¤‡é˜¶æ®µåã€ç«‹å³æ‰§è¡Œï¼ˆé™æ€ç»‘å®šï¼‰ï¼Œä¹Ÿå¯ä»¥å»¶è¿Ÿåˆ°ã€Œåˆå§‹åŒ–é˜¶æ®µåã€æ‰§è¡Œï¼ˆåŠ¨æ€ç»‘å®š/æ™šæœŸç»‘å®šï¼‰ï¼Œç›®çš„æ˜¯æ”¯æŒ Java çš„å¤šæ€ç‰¹æ€§ã€‚</li>
</ol>
<h3 data-id="heading-2">äºŒã€ç±»åŠ è½½æ ¸å¿ƒ5é˜¶æ®µï¼ˆé€é˜¶æ®µè¯¦è§£ï¼Œé™„åº•å±‚é€»è¾‘ï¼‰</h3>
<h4 data-id="heading-3">âœ… é˜¶æ®µ1ï¼šåŠ è½½ï¼ˆLoadingï¼‰â€”â€” ã€Œæ‰¾æ–‡ä»¶ã€è¯»æ•°æ®ã€å»ºå¯¹è±¡ã€</h4>
<p>è¿™æ˜¯ç±»åŠ è½½çš„<strong>ç¬¬ä¸€ä¸ªé˜¶æ®µ</strong>ï¼Œç”± JVM çš„ã€Œç±»åŠ è½½å™¨ï¼ˆClassLoaderï¼‰ã€è´Ÿè´£æ‰§è¡Œï¼Œæ ¸å¿ƒå®Œæˆ <strong>3ä»¶æ ¸å¿ƒå·¥ä½œ</strong>ï¼Œç¼ºä¸€ä¸å¯ï¼š</p>
<h5 data-id="heading-4">1. å®šä½å­—èŠ‚ç æ–‡ä»¶</h5>
<p>é€šè¿‡ç±»çš„<strong>å…¨é™å®šç±»å</strong>ï¼ˆå¦‚ <code>java.lang.String</code>ã€<code>com.test.User</code>ï¼‰ï¼Œæ‰¾åˆ°å¯¹åº”çš„ <code>.class</code> å­—èŠ‚ç æ–‡ä»¶ï¼ˆæ¥æºå¯ä»¥æ˜¯æœ¬åœ°ç£ç›˜ã€ç½‘ç»œã€jaråŒ…ã€åŠ¨æ€ç”Ÿæˆç­‰ï¼‰ã€‚</p>
<h5 data-id="heading-5">2. è¯»å–å­—èŠ‚ç æ•°æ®</h5>
<p>å°† <code>.class</code> æ–‡ä»¶çš„äºŒè¿›åˆ¶å­—èŠ‚æµï¼Œè¯»å–åˆ° JVM çš„<strong>æ–¹æ³•åŒº</strong>ï¼ˆJDK8åŠä»¥åä¸ºã€Œå…ƒç©ºé—´ Metaspaceã€ï¼Œç›´æ¥å ç”¨å †å¤–å†…å­˜ï¼‰ä¸­ã€‚</p>
<h5 data-id="heading-6">3. åˆ›å»ºClasså¯¹è±¡</h5>
<p>åœ¨ JVM çš„<strong>å †å†…å­˜</strong>ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªå¯¹åº”ç±»çš„ <code>java.lang.Class</code> ç±»å‹å¯¹è±¡ â€”â€” è¿™ä¸ªå¯¹è±¡æ˜¯ç¨‹åºè®¿é—®æ–¹æ³•åŒºä¸­ç±»å…ƒæ•°æ®çš„ã€Œå”¯ä¸€å…¥å£ã€ï¼Œåç»­åå°„ã€å®ä¾‹åŒ–å¯¹è±¡éƒ½ä¾èµ–å®ƒã€‚</p>
<p>ğŸ’¡ ç»å…¸è€ƒç‚¹ï¼šå †ä¸­çš„ <code>Class</code> å¯¹è±¡ â‰  æ–¹æ³•åŒºçš„ç±»å…ƒæ•°æ®ã€‚<code>Class</code> å¯¹è±¡æ˜¯è®¿é—®å…¥å£ï¼Œç±»å…ƒæ•°æ®æ˜¯ç±»çš„å®Œæ•´ä¿¡æ¯ï¼ˆå±æ€§ã€æ–¹æ³•ã€å¸¸é‡æ± ç­‰ï¼‰ã€‚</p>
<h4 data-id="heading-7">âœ… é˜¶æ®µ2ï¼šéªŒè¯ï¼ˆVerificationï¼‰â€”â€” ã€ŒéªŒåˆæ³•æ€§ã€ä¿å®‰å…¨æ€§ã€</h4>
<p>éªŒè¯æ˜¯ç±»åŠ è½½çš„<strong>å®‰å…¨å±éšœ</strong>ï¼ŒJVM ä¼šå¯¹åŠ è½½åˆ°æ–¹æ³•åŒºçš„å­—èŠ‚ç æ•°æ®è¿›è¡Œ<strong>å…¨æ–¹ä½æ ¡éªŒ</strong>ï¼Œç¡®ä¿å…¶<strong>ç¬¦åˆJavaè™šæ‹Ÿæœºè§„èŒƒã€æ— å®‰å…¨éšæ‚£</strong>ï¼Œé˜²æ­¢æ¶æ„æˆ–é”™è¯¯çš„å­—èŠ‚ç æ–‡ä»¶ç ´åJVMè¿è¡Œã€‚</p>
<p>è¯¥é˜¶æ®µåˆ†ä¸º <strong>4ä¸ªå­éªŒè¯ç¯èŠ‚</strong>ï¼Œå±‚å±‚é€’è¿›ï¼š</p>
<ol>
<li><strong>æ–‡ä»¶æ ¼å¼éªŒè¯</strong>ï¼šæ ¡éªŒå­—èŠ‚ç æ˜¯å¦ç¬¦åˆ <code>.class</code> æ–‡ä»¶çš„æ ¼å¼è§„èŒƒï¼ˆå¦‚é­”æ•°æ˜¯å¦ä¸º <code>0xCAFEBABE</code>ã€ç‰ˆæœ¬å·æ˜¯å¦å…¼å®¹å½“å‰JVMï¼‰ï¼›</li>
<li><strong>å…ƒæ•°æ®éªŒè¯</strong>ï¼šæ ¡éªŒç±»çš„å…ƒæ•°æ®æ˜¯å¦ç¬¦åˆJavaè¯­æ³•è§„èŒƒï¼ˆå¦‚æ˜¯å¦æœ‰çˆ¶ç±»ã€æ˜¯å¦ç»§æ‰¿äº†ä¸å¯ç»§æ‰¿çš„ç±»ã€æ–¹æ³•å‚æ•°æ˜¯å¦åˆæ³•ï¼‰ï¼›</li>
<li><strong>å­—èŠ‚ç éªŒè¯</strong>ï¼šæ ¡éªŒå­—èŠ‚ç æŒ‡ä»¤çš„æ‰§è¡Œé€»è¾‘æ˜¯å¦åˆæ³•ï¼ˆå¦‚æ˜¯å¦å­˜åœ¨æ ˆæº¢å‡ºã€ç±»å‹è½¬æ¢å¼‚å¸¸ã€æŒ‡ä»¤æ‰§è¡Œé¡ºåºé”™è¯¯ï¼‰ï¼›</li>
<li><strong>ç¬¦å·å¼•ç”¨éªŒè¯</strong>ï¼šæ ¡éªŒç±»ä¸­çš„ç¬¦å·å¼•ç”¨ï¼ˆå¦‚å¼•ç”¨çš„ç±»ã€æ–¹æ³•ã€å­—æ®µï¼‰æ˜¯å¦çœŸå®å­˜åœ¨ã€è®¿é—®æƒé™æ˜¯å¦åˆæ³•ã€‚</li>
</ol>
<p>ğŸ’¡ ä¼˜åŒ–ç‚¹ï¼šè‹¥ç¡®è®¤å­—èŠ‚ç æ–‡ä»¶æ˜¯å®‰å…¨çš„ï¼ˆå¦‚é¡¹ç›®å†…éƒ¨ç±»ï¼‰ï¼Œå¯é€šè¿‡JVMå‚æ•° <code>-Xverify:none</code> å…³é—­éªŒè¯ï¼Œæå‡ç±»åŠ è½½æ•ˆç‡ã€‚</p>
<h4 data-id="heading-8">âœ… é˜¶æ®µ3ï¼šå‡†å¤‡ï¼ˆPreparationï¼‰â€”â€” ã€Œèµ‹é»˜è®¤å€¼ã€åˆ†é…å†…å­˜ã€</h4>
<p>å‡†å¤‡é˜¶æ®µæ˜¯<strong>ä¸ºç±»çš„é™æ€å˜é‡åˆ†é…å†…å­˜ï¼Œå¹¶è®¾ç½®é»˜è®¤åˆå§‹å€¼</strong>çš„é˜¶æ®µï¼Œæ ¸å¿ƒè§„åˆ™æ˜ç¡®ä¸”å›ºå®šï¼Œæ˜¯é«˜é¢‘è€ƒç‚¹ï¼š</p>
<h5 data-id="heading-9">âœ… æ ¸å¿ƒè§„åˆ™ï¼ˆå¿…é¡»ç‰¢è®°ï¼‰</h5>
<ol>
<li><strong>ä»…å¤„ç†ã€Œé™æ€å˜é‡ï¼ˆstaticä¿®é¥°ï¼‰ã€</strong>ï¼šå®ä¾‹å˜é‡çš„å†…å­˜åˆ†é…å’Œåˆå§‹åŒ–ï¼Œè¦ç­‰åˆ°<strong>å¯¹è±¡å®ä¾‹åŒ–</strong>æ—¶æ‰åœ¨å †ä¸­æ‰§è¡Œï¼Œä¸æœ¬é˜¶æ®µæ— å…³ï¼›</li>
<li><strong>åˆ†é…å†…å­˜ä½ç½®</strong>ï¼šé™æ€å˜é‡çš„å†…å­˜ï¼Œåˆ†é…åœ¨<strong>æ–¹æ³•åŒº</strong>çš„ç±»å…ƒæ•°æ®ä¸­ï¼›</li>
<li><strong>èµ‹å€¼è§„åˆ™</strong>ï¼šä»…è®¾ç½®ã€ŒJVMé»˜è®¤åˆå§‹å€¼ã€ï¼Œ<strong>ä¸ä¼šæ‰§è¡Œç¨‹åºå‘˜è‡ªå®šä¹‰çš„èµ‹å€¼è¯­å¥</strong>ã€‚</li>
</ol>
<h5 data-id="heading-10">âœ… åŸºç¡€æ•°æ®ç±»å‹é»˜è®¤å€¼å¯¹ç…§è¡¨</h5>









































<table><thead><tr><th>æ•°æ®ç±»å‹</th><th>é»˜è®¤åˆå§‹å€¼</th><th>æ•°æ®ç±»å‹</th><th>é»˜è®¤åˆå§‹å€¼</th></tr></thead><tbody><tr><td>byte</td><td>0</td><td>boolean</td><td>false</td></tr><tr><td>short</td><td>0</td><td>char</td><td>'\u0000'</td></tr><tr><td>int</td><td>0</td><td>long</td><td>0L</td></tr><tr><td>float</td><td>0.0f</td><td>double</td><td>0.0d</td></tr><tr><td>å¼•ç”¨ç±»å‹</td><td>null</td><td>-</td><td>-</td></tr></tbody></table>
<h5 data-id="heading-11">âœ… ç»å…¸ç¤ºä¾‹ï¼ˆç†è§£æ ¸å¿ƒï¼‰</h5>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {
    <span class="hljs-comment">// é™æ€å˜é‡</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">static</span> <span class="hljs-type">int</span> num = <span class="hljs-number">10</span>; 
    <span class="hljs-comment">// å®ä¾‹å˜é‡ï¼ˆæœ¬é˜¶æ®µä¸å¤„ç†ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">String</span> name;
}
</code></pre>
<p>ğŸ‘‰ å‡†å¤‡é˜¶æ®µæ‰§è¡Œç»“æœï¼š</p>
<ul>
<li>ä¸º <code>num</code> åˆ†é…å†…å­˜ï¼Œèµ‹å€¼ä¸º <strong>0</strong>ï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œè€Œé10ï¼›</li>
<li>å®Œå…¨ä¸å¤„ç† <code>name</code> å˜é‡ï¼›</li>
<li>ç¨‹åºå‘˜å†™çš„ <code>num=10</code> èµ‹å€¼è¯­å¥ï¼Œè¦ç­‰åˆ°<strong>åˆå§‹åŒ–é˜¶æ®µ</strong>æ‰æ‰§è¡Œã€‚</li>
</ul>
<h4 data-id="heading-12">âœ… é˜¶æ®µ4ï¼šè§£æï¼ˆResolutionï¼‰â€”â€” ã€Œç¬¦å·å¼•ç”¨ â†’ ç›´æ¥å¼•ç”¨ã€</h4>
<p>è§£ææ˜¯ JVM å°†å¸¸é‡æ± ä¸­çš„ <strong>ç¬¦å·å¼•ç”¨</strong> æ›¿æ¢ä¸º <strong>ç›´æ¥å¼•ç”¨</strong> çš„è¿‡ç¨‹ï¼Œæ˜¯ã€Œé“¾æ¥é˜¶æ®µã€çš„æœ€åä¸€æ­¥ï¼Œå…ˆæ˜ç¡®ä¸¤ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼š</p>
<h5 data-id="heading-13">âœ… æ ¸å¿ƒæ¦‚å¿µåŒºåˆ†ï¼ˆå¿…æ‡‚ï¼‰</h5>
<ol>
<li><strong>ç¬¦å·å¼•ç”¨</strong>ï¼šç”¨ã€Œå­—ç¬¦ä¸²ã€æè¿°çš„å¼•ç”¨å…³ç³»ï¼ˆå¦‚ç±»åã€æ–¹æ³•åã€å­—æ®µåï¼‰ï¼Œç‹¬ç«‹äºå†…å­˜å¸ƒå±€ï¼ŒJVM ä¸çŸ¥é“å…¶çœŸå®å†…å­˜åœ°å€ã€‚ä¾‹å¦‚ <code>.class</code> æ–‡ä»¶ä¸­ <code>invokevirtual com/test/User.getName()</code> å°±æ˜¯ç¬¦å·å¼•ç”¨ï¼›</li>
<li><strong>ç›´æ¥å¼•ç”¨</strong>ï¼šæŒ‡å‘ç›®æ ‡çš„<strong>çœŸå®å†…å­˜åœ°å€</strong>ï¼ˆå¯ä»¥æ˜¯æŒ‡é’ˆã€åç§»é‡ï¼‰ï¼ŒJVM èƒ½ç›´æ¥å®šä½åˆ°ç›®æ ‡ä½ç½®ï¼Œä¸å†…å­˜å¸ƒå±€å¼ºç›¸å…³ã€‚</li>
</ol>
<h5 data-id="heading-14">âœ… è§£æçš„æ ¸å¿ƒå†…å®¹</h5>
<p>è§£æé˜¶æ®µä¸»è¦å¤„ç†<strong>4ç±»ç¬¦å·å¼•ç”¨</strong>ï¼Œå…¨éƒ¨ä½äºç±»çš„å¸¸é‡æ± ä¸­ï¼š</p>
<ol>
<li><strong>ç±»/æ¥å£è§£æ</strong>ï¼šå°†ç±»çš„å…¨é™å®šåï¼Œè§£æä¸ºå¯¹åº”çš„ <code>Class</code> å¯¹è±¡ç›´æ¥å¼•ç”¨ï¼›</li>
<li><strong>å­—æ®µè§£æ</strong>ï¼šå°†å­—æ®µåï¼Œè§£æä¸ºæŒ‡å‘æ–¹æ³•åŒºä¸­å­—æ®µå†…å­˜åœ°å€çš„ç›´æ¥å¼•ç”¨ï¼›</li>
<li><strong>æ–¹æ³•è§£æ</strong>ï¼šå°†æ–¹æ³•åï¼Œè§£æä¸ºæŒ‡å‘æ–¹æ³•åŒºä¸­æ–¹æ³•å†…å­˜åœ°å€çš„ç›´æ¥å¼•ç”¨ï¼›</li>
<li><strong>æ¥å£æ–¹æ³•è§£æ</strong>ï¼šä¸“é—¨å¤„ç†æ¥å£ä¸­çš„æ–¹æ³•å¼•ç”¨è§£æã€‚</li>
</ol>
<p>ğŸ’¡ å…³é”®ç‰¹æ€§ï¼šè§£æé˜¶æ®µ<strong>æ”¯æŒåŠ¨æ€ç»‘å®š</strong>ã€‚æ¯”å¦‚å­ç±»é‡å†™çˆ¶ç±»æ–¹æ³•æ—¶ï¼ŒJVM ä¸ä¼šåœ¨è§£æé˜¶æ®µç¡®å®šæœ€ç»ˆå¼•ç”¨ï¼Œè€Œæ˜¯å»¶è¿Ÿåˆ°<strong>è¿è¡ŒæœŸ</strong>ï¼ˆè°ƒç”¨æ–¹æ³•æ—¶ï¼‰æ‰ç¡®å®šï¼Œè¿™æ˜¯Javaå®ç°<strong>å¤šæ€</strong>çš„æ ¸å¿ƒåŸºç¡€ã€‚</p>
<h4 data-id="heading-15">âœ… é˜¶æ®µ5ï¼šåˆå§‹åŒ–ï¼ˆInitializationï¼‰â€”â€” ã€Œæ‰§è¡Œä»£ç ã€èµ‹çœŸå®å€¼ã€</h4>
<p>åˆå§‹åŒ–æ˜¯ç±»åŠ è½½<strong>5ä¸ªæ ¸å¿ƒé˜¶æ®µçš„æœ€åä¸€æ­¥</strong>ï¼Œä¹Ÿæ˜¯<strong>å”¯ä¸€ä¼šæ‰§è¡ŒJavaä»£ç çš„é˜¶æ®µ</strong>ï¼Œæ ¸å¿ƒæ˜¯ã€Œæ‰§è¡Œé™æ€ä»£ç ï¼Œä¸ºé™æ€å˜é‡èµ‹äºˆç¨‹åºå‘˜è‡ªå®šä¹‰çš„çœŸå®å€¼ã€ï¼Œæ˜¯ç±»åŠ è½½ä¸­æœ€æ ¸å¿ƒã€æœ€æ˜“è€ƒçš„é˜¶æ®µã€‚</p>
<h5 data-id="heading-16">âœ… æ ¸å¿ƒè§¦å‘æ¡ä»¶ï¼ˆä¸»åŠ¨ä½¿ç”¨ï¼Œ7ç§å¿…èƒŒï¼‰</h5>
<p>JVM ä¸¥æ ¼è§„å®šï¼š<strong>åªæœ‰å½“ç±»è¢«ã€Œä¸»åŠ¨ä½¿ç”¨ã€æ—¶ï¼Œæ‰ä¼šè§¦å‘åˆå§‹åŒ–é˜¶æ®µ</strong>ï¼›è¢«åŠ¨ä½¿ç”¨ï¼ˆå¦‚ä»…å¼•ç”¨é™æ€å¸¸é‡ï¼‰ä¸ä¼šè§¦å‘åˆå§‹åŒ–ã€‚ä¸»åŠ¨ä½¿ç”¨çš„7ç§åœºæ™¯ï¼š</p>
<ol>
<li>åˆ›å»ºç±»çš„å®ä¾‹ï¼ˆ<code>new User()</code>ï¼‰ï¼›</li>
<li>è°ƒç”¨ç±»çš„é™æ€æ–¹æ³•ï¼ˆ<code>User.testMethod()</code>ï¼‰ï¼›</li>
<li>è®¿é—®ç±»/æ¥å£çš„<strong>éfinal</strong>é™æ€å˜é‡ï¼ˆ<code>User.num</code>ï¼‰ï¼›</li>
<li>åå°„è°ƒç”¨ç±»ï¼ˆ<code>Class.forName("com.test.User")</code>ï¼‰ï¼›</li>
<li>åˆå§‹åŒ–å­ç±»æ—¶ï¼Œå…¶çˆ¶ç±»ä¼šè¢«ä¼˜å…ˆåˆå§‹åŒ–ï¼›</li>
<li>JVMå¯åŠ¨æ—¶ï¼Œè¢«æŒ‡å®šä¸ºã€Œä¸»ç±»ã€çš„ç±»ï¼ˆå« <code>main()</code> æ–¹æ³•çš„ç±»ï¼‰ï¼›</li>
<li>åŠ¨æ€è¯­è¨€æ”¯æŒï¼ˆJDK7+ï¼‰ï¼šè°ƒç”¨ <code>java.lang.invoke.MethodHandle</code> å®ä¾‹ï¼Œä¸”è¯¥å®ä¾‹æŒ‡å‘çš„æ–¹æ³•æ‰€å±ç±»æœªåˆå§‹åŒ–ã€‚</li>
</ol>
<p>âœ… ç»å…¸åä¾‹ï¼ˆè¢«åŠ¨ä½¿ç”¨ï¼Œä¸åˆå§‹åŒ–ï¼‰ï¼šè®¿é—®ç±»çš„ <code>static final</code> é™æ€å¸¸é‡ï¼ˆ<code>public static final int a=10</code>ï¼‰ï¼Œå› ä¸ºå¸¸é‡åœ¨<strong>ç¼–è¯‘æœŸ</strong>å°±å·²å­˜å…¥è°ƒç”¨ç±»çš„å¸¸é‡æ± ï¼Œæ— éœ€åŠ è½½åŸç±»ã€‚</p>
<h5 data-id="heading-17">âœ… åˆå§‹åŒ–é˜¶æ®µçš„æ‰§è¡Œé¡ºåºï¼ˆä¸¥æ ¼å›ºå®šï¼Œé«˜é¢‘è€ƒç‚¹ï¼‰</h5>
<p>JVM ä¼šæŒ‰**ã€Œè‡ªä¸Šè€Œä¸‹ã€å…ˆçˆ¶åå­ã€** çš„é¡ºåºï¼Œæ‰§è¡Œä»¥ä¸‹ä¸¤ç±»ä»£ç ï¼Œä¸”<strong>ä»…æ‰§è¡Œä¸€æ¬¡</strong>ï¼ˆç±»åˆå§‹åŒ–æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ŒJVMä¼šåŠ é”ä¿è¯ï¼‰ï¼š</p>
<ol>
<li><strong>æ‰§è¡Œé™æ€å˜é‡çš„æ˜¾å¼èµ‹å€¼è¯­å¥</strong>ï¼ˆå¦‚ <code>num=10</code>ï¼‰ï¼›</li>
<li><strong>æ‰§è¡Œé™æ€ä»£ç å—ï¼ˆstatic{}ï¼‰ä¸­çš„ä»£ç </strong>ï¼›</li>
<li>è‹¥å­˜åœ¨çˆ¶ç±»ï¼Œ<strong>å…ˆåˆå§‹åŒ–çˆ¶ç±»</strong>ï¼Œå†åˆå§‹åŒ–å­ç±»ã€‚</li>
</ol>
<h5 data-id="heading-18">âœ… ç»å…¸ç¤ºä¾‹ï¼ˆå½»åº•ç†è§£ï¼‰</h5>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">class</span> <span class="hljs-title">Parent</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">int</span> p = <span class="hljs-number">100</span>;
    <span class="hljs-keyword">static</span> {
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"çˆ¶ç±»é™æ€ä»£ç å—æ‰§è¡Œ"</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title">Son</span> <span class="hljs-title">extends</span> <span class="hljs-title">Parent</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">int</span> s = <span class="hljs-number">200</span>;
    <span class="hljs-keyword">static</span> {
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å­ç±»é™æ€ä»£ç å—æ‰§è¡Œ"</span>);
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> {
        System.<span class="hljs-keyword">out</span>.println(Son.s);
    }
}
</code></pre>
<p>ğŸ‘‰ æ‰§è¡Œç»“æœï¼ˆä¸¥æ ¼éµå¾ªåˆå§‹åŒ–é¡ºåºï¼‰ï¼š</p>
<pre><code class="hljs">çˆ¶ç±»é™æ€ä»£ç å—æ‰§è¡Œ
å­ç±»é™æ€ä»£ç å—æ‰§è¡Œ
200
</code></pre>
<p>ğŸ‘‰ åº•å±‚é€»è¾‘ï¼š</p>
<ul>
<li>è°ƒç”¨ <code>Son.s</code> å±äºã€Œä¸»åŠ¨ä½¿ç”¨ã€ï¼Œè§¦å‘Sonç±»åˆå§‹åŒ–ï¼›</li>
<li>åˆå§‹åŒ–Sonå‰ï¼Œå…ˆåˆå§‹åŒ–çˆ¶ç±»Parentï¼›</li>
<li>Parentä¸­ï¼šå…ˆæ‰§è¡Œ <code>p=100</code>ï¼Œå†æ‰§è¡Œé™æ€ä»£ç å—ï¼›</li>
<li>Parentåˆå§‹åŒ–å®Œæˆåï¼Œæ‰§è¡ŒSonçš„ <code>s=200</code>ï¼Œå†æ‰§è¡ŒSonçš„é™æ€ä»£ç å—ï¼›</li>
<li>æœ€ç»ˆè¿”å› <code>s=200</code>ã€‚</li>
</ul>
<h3 data-id="heading-19">ä¸‰ã€ç±»åŠ è½½çš„æ ¸å¿ƒç‰¹æ€§ï¼ˆ3ä¸ªï¼Œå¿…é¡»æŒæ¡ï¼‰</h3>
<p>Java ç±»åŠ è½½æœºåˆ¶è®¾è®¡äº†3ä¸ªæ ¸å¿ƒç‰¹æ€§ï¼Œä¿è¯äº†åŠ è½½çš„é«˜æ•ˆæ€§ã€å®‰å…¨æ€§å’Œçµæ´»æ€§ï¼Œæ˜¯é¢è¯•é«˜é¢‘è€ƒç‚¹ï¼š</p>
<h4 data-id="heading-20">âœ… ç‰¹æ€§1ï¼š<strong>åŒäº²å§”æ´¾æœºåˆ¶</strong>ï¼ˆæ ¸å¿ƒï¼Œé‡ä¸­ä¹‹é‡ï¼‰</h4>
<h5 data-id="heading-21">1. å®šä¹‰</h5>
<p>ç±»åŠ è½½å™¨åœ¨åŠ è½½ç±»æ—¶ï¼Œ<strong>å…ˆå§”æ‰˜çˆ¶ç±»åŠ è½½å™¨åŠ è½½ï¼Œçˆ¶ç±»åŠ è½½å¤±è´¥åï¼Œè‡ªå·±æ‰å°è¯•åŠ è½½</strong>ï¼Œæ˜¯ä¸€ç§ã€Œå‘ä¸Šå§”æ‰˜ã€å‘ä¸‹æŸ¥æ‰¾ã€çš„åŠ è½½æœºåˆ¶ã€‚</p>
<h5 data-id="heading-22">2. ä½œç”¨</h5>
<p>âœ… ä¿è¯<strong>æ ¸å¿ƒç±»çš„å”¯ä¸€æ€§</strong>ï¼šå¦‚ <code>java.lang.String</code> åªä¼šè¢«ã€Œå¯åŠ¨ç±»åŠ è½½å™¨ã€åŠ è½½ï¼Œé¿å…è‡ªå®šä¹‰ç±»ç¯¡æ”¹æ ¸å¿ƒç±»ï¼›</p>
<p>âœ… ä¿è¯<strong>ç±»åŠ è½½çš„å®‰å…¨æ€§</strong>ï¼šé˜²æ­¢æ¶æ„ç±»å†’å……æ ¸å¿ƒç±»ï¼Œç ´åJVMè¿è¡Œã€‚</p>
<h5 data-id="heading-23">3. ç±»åŠ è½½å™¨å±‚çº§ï¼ˆè‡ªä¸Šè€Œä¸‹ï¼‰</h5>
<ol>
<li><strong>å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰</strong> ï¼šC++å®ç°ï¼ŒåŠ è½½JRE/libæ ¸å¿ƒç±»åº“ï¼ˆå¦‚rt.jarï¼‰ï¼›</li>
<li><strong>æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtension ClassLoaderï¼‰</strong> ï¼šJavaå®ç°ï¼ŒåŠ è½½JRE/lib/extæ‰©å±•ç±»åº“ï¼›</li>
<li><strong>åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼ˆApplication ClassLoaderï¼‰</strong> ï¼šJavaå®ç°ï¼ŒåŠ è½½é¡¹ç›®classpathä¸‹çš„ç±»ï¼ˆæˆ‘ä»¬è‡ªå·±å†™çš„ç±»ï¼‰ï¼›</li>
<li><strong>è‡ªå®šä¹‰ç±»åŠ è½½å™¨</strong>ï¼šç»§æ‰¿ <code>ClassLoader</code>ï¼ŒæŒ‰éœ€åŠ è½½è‡ªå®šä¹‰æ¥æºçš„ç±»ï¼ˆå¦‚ç½‘ç»œã€åŠ å¯†æ–‡ä»¶ï¼‰ã€‚</li>
</ol>
<h4 data-id="heading-24">âœ… ç‰¹æ€§2ï¼š<strong>æ‡’åŠ è½½ï¼ˆå»¶è¿ŸåŠ è½½ï¼‰</strong></h4>
<p>JVM ä¸ä¼šåœ¨ç¨‹åºå¯åŠ¨æ—¶åŠ è½½æ‰€æœ‰ç±»ï¼Œè€Œæ˜¯<strong>åœ¨ç±»è¢«ã€Œä¸»åŠ¨ä½¿ç”¨ã€æ—¶æ‰è§¦å‘åŠ è½½</strong>ï¼Œæå¤§èŠ‚çœå†…å­˜å¼€é”€ï¼Œæå‡ç¨‹åºå¯åŠ¨é€Ÿåº¦ã€‚</p>
<ul>
<li>ç±»çš„åŠ è½½ã€éªŒè¯ã€å‡†å¤‡é˜¶æ®µï¼šéšã€Œä¸»åŠ¨ä½¿ç”¨ã€è§¦å‘ï¼›</li>
<li>åˆå§‹åŒ–é˜¶æ®µï¼šä¸¥æ ¼æŒ‰ã€Œä¸»åŠ¨ä½¿ç”¨ã€æ¡ä»¶è§¦å‘ï¼Œä¸”ä»…æ‰§è¡Œä¸€æ¬¡ã€‚</li>
</ul>
<h4 data-id="heading-25">âœ… ç‰¹æ€§3ï¼š<strong>ç¼“å­˜æœºåˆ¶</strong></h4>
<p>ç±»è¢«åŠ è½½åï¼ŒJVM ä¼šå°†å…¶å…ƒæ•°æ®ç¼“å­˜åˆ°æ–¹æ³•åŒºä¸­ï¼Œåç»­å†æ¬¡ä½¿ç”¨è¯¥ç±»æ—¶ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­è·å– <code>Class</code> å¯¹è±¡ï¼Œ<strong>æ— éœ€é‡å¤åŠ è½½</strong>ã€‚</p>
<ul>
<li>ç¼“å­˜æœ‰æ•ˆæœŸï¼šç›´åˆ°JVMé€€å‡ºï¼›</li>
<li>ä½œç”¨ï¼šæå‡ç±»çš„å¤ç”¨æ•ˆç‡ï¼Œé¿å…é‡å¤æ‰§è¡ŒåŠ è½½ã€éªŒè¯ç­‰å¼€é”€ã€‚</li>
</ul>
<h3 data-id="heading-26">å››ã€ç±»åŠ è½½åç»­é˜¶æ®µï¼ˆä½¿ç”¨+å¸è½½ï¼‰</h3>
<p>ç±»åŠ è½½çš„5ä¸ªæ ¸å¿ƒé˜¶æ®µå®Œæˆåï¼Œç±»å°±è¿›å…¥ã€Œå¯ç”¨çŠ¶æ€ã€ï¼Œæœ€ç»ˆåœ¨æ»¡è¶³æ¡ä»¶æ—¶è¢«å¸è½½ï¼Œå®Œæˆå®Œæ•´ç”Ÿå‘½å‘¨æœŸï¼š</p>
<h4 data-id="heading-27">âœ… é˜¶æ®µ6ï¼šä½¿ç”¨ï¼ˆUsingï¼‰</h4>
<p>ç¨‹åºé€šè¿‡ä¸¤ç§æ–¹å¼ä½¿ç”¨å·²åˆå§‹åŒ–çš„ç±»ï¼š</p>
<ol>
<li><strong>åˆ›å»ºç±»çš„å®ä¾‹å¯¹è±¡</strong>ï¼š<code>new User()</code>ï¼Œè°ƒç”¨å®ä¾‹æ–¹æ³•ã€è®¿é—®å®ä¾‹å˜é‡ï¼›</li>
<li><strong>è°ƒç”¨ç±»çš„é™æ€æˆå‘˜</strong>ï¼š<code>User.staticMethod()</code>ã€<code>User.staticVar</code>ã€‚</li>
</ol>
<h4 data-id="heading-28">âœ… é˜¶æ®µ7ï¼šå¸è½½ï¼ˆUnloadingï¼‰</h4>
<p>ç±»çš„å¸è½½æ˜¯JVMå›æ”¶æ–¹æ³•åŒºå†…å­˜çš„è¿‡ç¨‹ï¼Œ<strong>å¿…é¡»åŒæ—¶æ»¡è¶³3ä¸ªæ¡ä»¶</strong>ï¼Œå¦åˆ™ä¸ä¼šè¢«å¸è½½ï¼ˆç±»çš„å¸è½½æ¡ä»¶æå…¶è‹›åˆ»ï¼‰ï¼š</p>
<ol>
<li>è¯¥ç±»çš„<strong>æ‰€æœ‰å®ä¾‹å¯¹è±¡</strong>éƒ½å·²è¢«GCå›æ”¶ï¼Œå †ä¸­æ— è¯¥ç±»çš„ä»»ä½•å®ä¾‹ï¼›</li>
<li>è¯¥ç±»çš„ <code>java.lang.Class</code> å¯¹è±¡ï¼Œæ— ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ï¼ˆå¦‚æ— åå°„ã€æ— é™æ€å˜é‡å¼•ç”¨ï¼‰ï¼›</li>
<li>åŠ è½½è¯¥ç±»çš„<strong>ç±»åŠ è½½å™¨</strong>å·²è¢«GCå›æ”¶ã€‚</li>
</ol>
<p>ğŸ’¡ ç»“è®ºï¼šJVMçš„æ ¸å¿ƒç±»ï¼ˆå¦‚ <code>java.lang.String</code>ï¼‰æ°¸è¿œä¸ä¼šè¢«å¸è½½ï¼Œå› ä¸ºå…¶è¢«å¯åŠ¨ç±»åŠ è½½å™¨åŠ è½½ï¼Œä¸”å§‹ç»ˆè¢«JVMå†…éƒ¨å¼•ç”¨ã€‚</p>
<h3 data-id="heading-29">äº”ã€æ ¸å¿ƒæ€»ç»“ï¼ˆå¿…èƒŒï¼Œè¦†ç›–æ‰€æœ‰è€ƒç‚¹ï¼‰</h3>
<ol>
<li>Javaç±»åŠ è½½æ ¸å¿ƒæµç¨‹ï¼š<strong>åŠ è½½ â†’ éªŒè¯ â†’ å‡†å¤‡ â†’ è§£æ â†’ åˆå§‹åŒ–</strong>ï¼Œå‰4ä¸ªä¸ºã€Œé“¾æ¥é˜¶æ®µã€ï¼Œè§£æå¯å»¶è¿Ÿï¼›</li>
<li>å‡†å¤‡é˜¶æ®µï¼šç»™<strong>é™æ€å˜é‡</strong>åˆ†é…å†…å­˜ï¼Œèµ‹<strong>JVMé»˜è®¤å€¼</strong>ï¼Œä¸æ‰§è¡Œè‡ªå®šä¹‰èµ‹å€¼ï¼›</li>
<li>åˆå§‹åŒ–é˜¶æ®µï¼šæ‰§è¡Œ<strong>é™æ€èµ‹å€¼è¯­å¥+é™æ€ä»£ç å—</strong>ï¼Œä»…åœ¨ã€Œä¸»åŠ¨ä½¿ç”¨ã€æ—¶è§¦å‘ï¼Œä¸”<strong>å…ˆçˆ¶åå­</strong>ï¼›</li>
<li>ç±»åŠ è½½3å¤§ç‰¹æ€§ï¼š<strong>åŒäº²å§”æ´¾ã€æ‡’åŠ è½½ã€ç¼“å­˜æœºåˆ¶</strong>ï¼ŒåŒäº²å§”æ´¾æ˜¯æ ¸å¿ƒï¼›</li>
<li>ç±»å¸è½½3ä¸ªæ¡ä»¶ï¼šæ— å®ä¾‹ã€æ— Classå¯¹è±¡å¼•ç”¨ã€ç±»åŠ è½½å™¨è¢«å›æ”¶ï¼›</li>
<li>å †ä¸­çš„ <code>Class</code> å¯¹è±¡æ˜¯è®¿é—®æ–¹æ³•åŒºç±»å…ƒæ•°æ®çš„å”¯ä¸€å…¥å£ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Pythonå¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ç¼–ç¨‹å®æˆ˜æŒ‡å—]]></title>    <link>https://juejin.cn/post/7588073726207918086</link>    <guid>https://juejin.cn/post/7588073726207918086</guid>    <pubDate>2025-12-27T07:20:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588073726207918086" data-draft-id="7588069469516808233" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" Pythonå¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ç¼–ç¨‹å®æˆ˜æŒ‡å—"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2025-12-27T07:20:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„"/> <meta itemprop="url" content="https://juejin.cn/user/3097787706900985"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             Pythonå¤šçº¿ç¨‹ä¸å¤šè¿›ç¨‹ç¼–ç¨‹å®æˆ˜æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3097787706900985/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T07:20:07.000Z" title="Sat Dec 27 2025 07:20:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px;color:#5e7ce0}.markdown-body h1{font-size:24px;margin-bottom:5px;margin-top:80px;position:relative;text-align:center}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px;margin-top:30px}.markdown-body h5{font-size:14px;margin-top:20px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #dfe1e6;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#ffeeed;color:#c73636;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#f8f8f8}.markdown-body a{position:relative;text-decoration:none;color:#5e7ce0;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIRlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAACCgAwAEAAAAAQAAACAAAAAAX7wP8AAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KGV7hBwAABWVJREFUWAnlVktsVFUY/s85997pC9BOTKxRWnEKsXWlxjWJj0RWJjrFAAXjAlewYWOkgauACVu7a2IiNUEyExM3yoZE3Wmi7qgPJthJBDE6JUNpO3Mf5/j95/bOTOcBlBgXejJ37rn/Of/7O/9/iP7vQ/zTAcjnC4ry+a5ii1OkiYTpuvjvEc0Gp51uivP+ZW+QBuSW4QjW5rptAa1Ey0uOGKOxwPetVyafN6p/52/PkNBbjdAhGaGEpMRjLZTryB8+9MUSYSGNRIcBvm8kBAY9tHYlHz78nTs392xIkwv9FA3Oe33bdoX1ZZKOS0bH0CXI6RugYLW6BwIu5gskkQ4sEG0wYF25PjBzbZfSYY6kDLUmWMt7FR7Lw3xYUkaTdjxHfTPnPwav0iEGYADVa9XIRIEyxrAA0jIQxgFL22gYwF7A8/DAzNVdksJvJaTEUZ2kYnZWziN5s1ADPHneEIXByotYuMSrf9JEbbsuv7VcvbaKML8plXtQR0EdIYDqWEmtOgAomZFH8EjWSnek2ulmtljljttHbmaIHCCCHzd9MjwfsmscBeZH9Jyd10nMvz92UQrtCBKvMF06mQy0SiEdRMEGg8mN0YjAlgoDDkPrMI5qJKSkKKydpbB2CZjJkhIBvOBw2CGQgii85bpx//dMqFRKam5uvH7w+K97oe+Cl0HO68uIBH0qyEzpOMwIbZIcFq0I+9cwoElizCjk2KFI1y7Nnx614W1db58fOXIlMzs7Xn/jeDmvBV2Q0mXjGf554O/m4LZHp2N8r61WPMvLZWLdiC4GMAk5BjeeB5lhv39l6+BIbu3m760hXMDKBD08XBKzR8fr04nygnIypOOAJUx/fHrsi0Mnys+vVK+V4VUohaiyPCo2Q9DFALvF/ikw8WS4QvVZALS5ksw47/7R8ejgTPk1UFqU6/3zp8bOM7B/kdu/fkguPGU5JibW+F0sTjWOUw8DklRrg4BiLGeBqbaRLxjlT4no0InFV402RcftJz41cH/f/JnHP3kZaaF6VX/liwist9vYG5+NU9Cg3MNkt/+lU5wS8fTxq3mc7ILjDlAE4CJpe89BOWPiIjBhi9O6PI4G1jsc6RGB3lZwmS76k8H0zOKTkFboG8jS2krFKCX2fvTeaPHIBwAkMHHgncURnL3nuCSnxSopdIzN5th0BIonJ0Lf9yUA9iMkzdRWl3BixOusfDcwQVcS4UKIFwYfGPnM8wY/DyP9NFMXaTE5BU39tGkDgGZz+fJJG0oYcSaOafLcqdECY4LzfSObSzyUOgxqtyisr8SSNOOAkubWoh3TTaeA2YtFEXPnm5x81/j+6MI6JqyS25WSNU6hbCMKHG84marJbdR+vwakRhQLRuQpbzHRLjmpmijI+OmWCtq+LzWtnX5v30gHSsqmWne74DtiACi2+Wz0iXbuLt9D2cDyoPEkWOiyp5XUIwLMi/wJY1FbH5B9ONtdC1KrsD/Q0MCQAS0wccILORDW25amAeOtooAj/KQxfzF17uwTSQ1v3dJ7jnLINwdZYRDa4tPU0sHVXFo/vxFF5BqFqxRfOmgPCk4ft2NgKTCy2Y47JIEg+MIhjYsLy5I25qUYTQlCjMRHsr/UwdYwIK33UO1J5fFNB9XNO6akcywJofVmXQDP2wfrSPcI2xG5BSs3I+IosHr4EtvO1TDAu16xHQq5+ykMblfRXLbhEoFIdDTBdhldvzl+3CMg60ZktI2vNzLW6IIp0waLklot9L63yzuUp8dJd7bglPFe3hIXstBEP58/s6Ocyr4rH2+866ZNbriTzA0RSOWCwakMl1QJgculxPt8Z7O5GLdtW6bvU8R/nO1vb+hMExVAVtEAAAAASUVORK5CYII=");background-size:100%}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #5e7ce0}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #5e7ce0;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#5e7ce0}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#f2f5fc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #5e7ce0;background-color:#f2f5fc}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5e7ce0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ul li::marker{content:"â€¢";color:#5e7ce0}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]:before{display:inline-block;width:16px;height:16px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAhRJREFUeAHtnLEuBFEUhs9cu7JCskEhIrZAgYZGoREPwBuIygOoPITKA6jEG/AAolFoaFCgICIKZBNiY8Pyz5rNOWe9wNz5T7N3Z2eT/b/7zZlpziat3xKWBDJoEyh5EDd3DTk5r8vV7Yc8vzbl6zvfwvSERIYHyzI90SeLc1WZrFV85PR9oi+N/YMnOT6t/3tiLAeXFqqytjrSFacDYmfvQS6u37tOiPHA7FS/bK6PmWhpj4AJRYGA9MiKzLpK6An+cqiNVmRleUhArrec6PNzt/5sttLgh0cvcvfY6Px+ZNY9I6Ax6gKErY1xmZ8ZyD0E5MJGIgsyIZsunT3g7qALJuTdAp0nWyMTsunS2QNukbpwOcRaPpvOHvxzQow2ZBvrs+nsfLL8o0QQBJFdMO1XGkEjaIQlQCMsD/YIGkEjLAEaYXmwR9AIGmEJ0AjLgz2CRtAIS4BGWB7sETSCRlgCNMLyYI+gETTCEqARlgd7BI2gEZYAjbA82CNoBI2wBGiE5cEeQSNohCVAIywP9ggaQSMsARphebBH0AgaYQnQCMsjYC5SF2agYi2fTWcPGA7VFfO0n8+mswdMyOrCNJwnpz/P6xqZkE2Xzh4w8qcLI4Hbu/dydvkWBRAAQBZk0uOOyKyzp5PARRiF1puNtR+NTh+oMCvtJ+D8F2N6j6x+PrwzG46gRTDDm5BtsAGBg0X924Qfj7i23p7HNgQAAAAASUVORK5CYII=");background-size:100%;position:relative;right:2px;top:-5px}.markdown-body input[type=checkbox]:checked:before{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAABMtJREFUeAHtXM2KFDEQzrQKruIu4mEXRFlUVLz4A4K7B99AcO8io0/gwQfxDVzFuwu+gQf34EG8iOAPKAh6EFlBFMSf/qa2uqszlVR6ZtYxM5PDJNVVSer78nU6KrHzpyxuVlwx44AY2O0T8eb9D7f5fMu9fPvdff7y0/36nbdgdhUdd+jgHnf62JxbObvgjh/d60Pu2R35ajx49Mk9frqlBk7Kw8sXF9y1K4t9cCoi7tz/4F68/tYXMIkPzpzY725dP9yA1tsjoIRpIQHogRWYZSmwJ4Reh06nI2Nd7rYEA8zAzqXAxhgq/pc1d9vHKbEX+Dr4JbzypJDc/YxXYi/wifRLeOXpU5q7n/FK7EXsnBBeeRoqd7/EHj1ZhleeiMjdz8pArRKR+0pb+UsCuK0SkftKW/kzeFmrRHCAxWzufsaJOkqExWzufpOI8EpP1jnCJCK80pN1jjCJ4ICwMigidz/jRD3bI7bZUInIfaWt/KUSuK0SEd4jqFvufgYva5UIDrCYzd3POFFHifhfV/7k8lwPw7D5mUSEV3r854ju2pK7ffOIWzk/X+Go803Lr+ooGqoiwkyP9xzRXVt0q9sE3CgJYTLqfNPyE/irpkoEe2um6ck4bSiBSeD8JBl41jY/Hgd1lIiaaeoyLlsjgUGAjEH3DB4DtUpEW2Z3Mj5GAgA8efbVvXpX/200nln5IMYvKhHDrvylcwdc9+pSNdeg46WQsP7wo2s7fpWYaPT926fw9ZiVk4BpywYJkGuvlJs4EuWS0p/HTyHh3kbzH2najM85cR0lgpPiYMtukFB26m1u5Ua+vkFkWP3Zn0KCJDg1Px6f42Wtvhrhdyz8ncanrFKCmGH1wrwDMCrh/uxPIUFTAvdHbeVPsc1fVRE+c7Ud/k6fWt7XHFlYqcqQ5wTRvWpiY4wrIZwfDUL+akDRUBXB/jCzFCH9SHCzTDRUmsro7z+cEvrHwxOZn2ZTL/pVFcEBtRLoiWXfxQ5ehvoHHx4vpIwUEuJKSMvPz5/zQq0qwmIy5m+rjBQSwnsCQYnlgwjfT72av6oifOba2qnKcOXeGVIP0rT3BALTNr8mBWSpRHAgmJSTtLGhDHwj+A9GPCbX2DNiBSRoShg0H8zl5y/njxIhJ0WntralDJmIbO+UEvz85Zwt9wj7HIDB5Ttp7RkyGbRDSqC49vOjX50P9aexmr+qInzmajvtO13H02SpyrCVMNj8dT7/4BwByDXzRIC0LWXEldA/njVfip9GpV9VERxQM0lPhrVDyrCVMJr5/fwZJ+qWewR1lSuNJ21sXxnjVgIhck5VhM/cqG1WBpIAMX4Z9Xz+eP58sFUiOBArLQcZpQ0CNCXt1HzA5OfPOFGrrwYHyKTwbNJsxolaJUJbKeo0mu/4uMeXBHBbJSK88qP5jo97fAYva5UIDgivHEXk7mecqKNEhFeOhsjdbxKR+0pb+UsCuK0qIveVtvJn8LJWieAAi9nc/YwTdZQIi9nc/SYR4ZWenSO2yZvgcwTuRYZKWBnUI3e/xF7gcmio5L4HWPlL7AVuyPol95W28me8EnuBa8J+sZjM3c94JfYCd6VxTXjaCjDLe+K9cwTuSuOa8LQUYPXvh1d3w0HC7JK8kMK0/rcJfwHkVMYgi4xhOgAAAABJRU5ErkJggg==");background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-light">.hljs-comment,.hljs-quote{color:#696969}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d91e18}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#aa5d00}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:green}.hljs-section,.hljs-title{color:#007faa}.hljs-keyword,.hljs-selector-tag{color:#7928a1}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fefefe;color:#545454}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">å¼•è¨€ï¼šç†è§£å¹¶å‘ä¸å¹¶è¡Œ</h2>
<p>åœ¨å¤„ç†å¤§æ•°æ®æˆ–é«˜å¹¶å‘åœºæ™¯æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è®©ç¨‹åºåŒæ—¶åšå¤šä»¶äº‹æƒ…ã€‚Pythonæä¾›äº†ä¸¤ç§ä¸»è¦æ–¹å¼ï¼šå¤šçº¿ç¨‹ï¼ˆthreadingï¼‰å’Œå¤šè¿›ç¨‹ï¼ˆmultiprocessingï¼‰ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä¸€ä¸ªç›´è§‚çš„ä¾‹å­ï¼šåŒæ­¥ vs å¤šçº¿ç¨‹ vs å¤šè¿›ç¨‹</span>
<span class="hljs-keyword">import</span> time

<span class="hljs-keyword">def</span> <span class="hljs-title function_">task</span>(<span class="hljs-params">n</span>):
    <span class="hljs-string">"""æ¨¡æ‹Ÿè€—æ—¶ä»»åŠ¡"""</span>
    result = <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):
        result += i * i
    <span class="hljs-keyword">return</span> result

<span class="hljs-comment"># åŒæ­¥æ‰§è¡Œï¼ˆä¸€ä¸ªä¸€ä¸ªæ¥ï¼‰</span>
start = time.time()
<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):
    task(<span class="hljs-number">10000000</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"åŒæ­¥æ‰§è¡Œè€—æ—¶: <span class="hljs-subst">{time.time() - start:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)

<span class="hljs-comment"># å¤šçº¿ç¨‹æ‰§è¡Œï¼ˆåŒæ—¶å¼€å§‹ï¼Œä½†ç”±äºGILé™åˆ¶ï¼Œå®é™…è¿˜æ˜¯äº¤æ›¿æ‰§è¡Œï¼‰</span>
<span class="hljs-comment"># å¤šè¿›ç¨‹æ‰§è¡Œï¼ˆçœŸæ­£çš„åŒæ—¶æ‰§è¡Œï¼‰</span>
</code></pre>
<h2 data-id="heading-1">ä¸€ã€å¤šçº¿ç¨‹ç¼–ç¨‹</h2>
<h3 data-id="heading-2">1.1 åˆ›å»ºå’Œå¯åŠ¨çº¿ç¨‹</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> threading
<span class="hljs-keyword">import</span> time

<span class="hljs-built_in">print</span>(<span class="hljs-string">"=== å¤šçº¿ç¨‹åŸºç¡€ ==="</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">worker</span>(<span class="hljs-params">name, delay</span>):
    <span class="hljs-string">"""å·¥ä½œè€…å‡½æ•°"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{name}</span>] å¼€å§‹å·¥ä½œï¼Œéœ€è¦ <span class="hljs-subst">{delay}</span> ç§’"</span>)
    time.sleep(delay)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{name}</span>] å·¥ä½œå®Œæˆ"</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{name}</span>çš„ç»“æœ"</span>

<span class="hljs-comment"># æ–¹æ³•1ï¼šç›´æ¥åˆ›å»ºçº¿ç¨‹</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">basic_threads</span>():
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ–¹æ³•1ï¼šç›´æ¥åˆ›å»ºçº¿ç¨‹"</span>)
    
    <span class="hljs-comment"># åˆ›å»ºçº¿ç¨‹å¯¹è±¡</span>
    thread1 = threading.Thread(target=worker, args=(<span class="hljs-string">"å·¥äºº1"</span>, <span class="hljs-number">2</span>))
    thread2 = threading.Thread(target=worker, args=(<span class="hljs-string">"å·¥äºº2"</span>, <span class="hljs-number">1</span>))
    thread3 = threading.Thread(target=worker, args=(<span class="hljs-string">"å·¥äºº3"</span>, <span class="hljs-number">3</span>))
    
    <span class="hljs-comment"># å¯åŠ¨çº¿ç¨‹</span>
    thread1.start()
    thread2.start()
    thread3.start()
    
    <span class="hljs-comment"># ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ</span>
    thread1.join()
    thread2.join()
    thread3.join()
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ‰€æœ‰çº¿ç¨‹å·¥ä½œå®Œæˆ"</span>)

<span class="hljs-comment"># æ–¹æ³•2ï¼šç»§æ‰¿Threadç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyThread</span>(threading.Thread):
    <span class="hljs-string">"""è‡ªå®šä¹‰çº¿ç¨‹ç±»"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, delay</span>):
        <span class="hljs-built_in">super</span>().__init__()
        self.name = name
        self.delay = delay
        self.result = <span class="hljs-literal">None</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""çº¿ç¨‹æ‰§è¡Œçš„ä»£ç """</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{self.name}</span>] å¼€å§‹å·¥ä½œ"</span>)
        time.sleep(self.delay)
        self.result = <span class="hljs-string">f"<span class="hljs-subst">{self.name}</span>å®Œæˆä»»åŠ¡"</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{self.name}</span>] å·¥ä½œå®Œæˆ"</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_result</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""è·å–ç»“æœ"""</span>
        <span class="hljs-keyword">return</span> self.result

<span class="hljs-keyword">def</span> <span class="hljs-title function_">class_based_threads</span>():
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\næ–¹æ³•2ï¼šç»§æ‰¿Threadç±»"</span>)
    
    threads = []
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):
        thread = MyThread(<span class="hljs-string">f"çº¿ç¨‹<span class="hljs-subst">{i+<span class="hljs-number">1</span>}</span>"</span>, i+<span class="hljs-number">1</span>)
        thread.start()
        threads.append(thread)
    
    <span class="hljs-comment"># ç­‰å¾…å¹¶è·å–ç»“æœ</span>
    <span class="hljs-keyword">for</span> thread <span class="hljs-keyword">in</span> threads:
        thread.join()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç»“æœ: <span class="hljs-subst">{thread.get_result()}</span>"</span>)

<span class="hljs-comment"># è¿è¡Œæ¼”ç¤º</span>
basic_threads()
class_based_threads()

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>*<span class="hljs-number">50</span>)
</code></pre>
<h3 data-id="heading-3">1.2 çº¿ç¨‹åŒæ­¥ä¸é€šä¿¡</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> threading
<span class="hljs-keyword">import</span> queue
<span class="hljs-keyword">import</span> time

<span class="hljs-built_in">print</span>(<span class="hljs-string">"=== çº¿ç¨‹åŒæ­¥ä¸é€šä¿¡ ==="</span>)

<span class="hljs-comment"># 1. çº¿ç¨‹é” - é˜²æ­¢æ•°æ®ç«äº‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">BankAccount</span>:
    <span class="hljs-string">"""é“¶è¡Œè´¦æˆ·ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, balance=<span class="hljs-number">0</span></span>):
        self.balance = balance
        self.lock = threading.Lock()
        self.transactions = []
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">deposit</span>(<span class="hljs-params">self, amount, thread_name</span>):
        <span class="hljs-string">"""å­˜æ¬¾"""</span>
        <span class="hljs-keyword">with</span> self.lock:  <span class="hljs-comment"># è‡ªåŠ¨è·å–å’Œé‡Šæ”¾é”</span>
            old_balance = self.balance
            self.balance += amount
            self.transactions.append(<span class="hljs-string">f"<span class="hljs-subst">{thread_name}</span>: å­˜æ¬¾ <span class="hljs-subst">{amount}</span>"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{thread_name}</span>: å­˜æ¬¾ <span class="hljs-subst">{amount}</span>, ä½™é¢: <span class="hljs-subst">{old_balance}</span> -&gt; <span class="hljs-subst">{self.balance}</span>"</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">withdraw</span>(<span class="hljs-params">self, amount, thread_name</span>):
        <span class="hljs-string">"""å–æ¬¾"""</span>
        <span class="hljs-keyword">with</span> self.lock:
            <span class="hljs-keyword">if</span> self.balance &gt;= amount:
                old_balance = self.balance
                self.balance -= amount
                self.transactions.append(<span class="hljs-string">f"<span class="hljs-subst">{thread_name}</span>: å–æ¬¾ <span class="hljs-subst">{amount}</span>"</span>)
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{thread_name}</span>: å–æ¬¾ <span class="hljs-subst">{amount}</span>, ä½™é¢: <span class="hljs-subst">{old_balance}</span> -&gt; <span class="hljs-subst">{self.balance}</span>"</span>)
                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
            <span class="hljs-keyword">else</span>:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{thread_name}</span>: å–æ¬¾å¤±è´¥ï¼Œä½™é¢ä¸è¶³"</span>)
                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_bank_account</span>():
    <span class="hljs-string">"""æµ‹è¯•é“¶è¡Œè´¦æˆ·"""</span>
    account = BankAccount(<span class="hljs-number">1000</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">customer_operations</span>(<span class="hljs-params">name, operations</span>):
        <span class="hljs-keyword">for</span> op_type, amount <span class="hljs-keyword">in</span> operations:
            <span class="hljs-keyword">if</span> op_type == <span class="hljs-string">"deposit"</span>:
                account.deposit(amount, name)
            <span class="hljs-keyword">else</span>:
                account.withdraw(amount, name)
            time.sleep(<span class="hljs-number">0.1</span>)
    
    <span class="hljs-comment"># å¤šä¸ªå®¢æˆ·åŒæ—¶æ“ä½œè´¦æˆ·</span>
    customers = [
        (<span class="hljs-string">"å¼ ä¸‰"</span>, [(<span class="hljs-string">"deposit"</span>, <span class="hljs-number">200</span>), (<span class="hljs-string">"withdraw"</span>, <span class="hljs-number">300</span>)]),
        (<span class="hljs-string">"æå››"</span>, [(<span class="hljs-string">"deposit"</span>, <span class="hljs-number">500</span>), (<span class="hljs-string">"withdraw"</span>, <span class="hljs-number">800</span>)]),
        (<span class="hljs-string">"ç‹äº”"</span>, [(<span class="hljs-string">"withdraw"</span>, <span class="hljs-number">400</span>), (<span class="hljs-string">"deposit"</span>, <span class="hljs-number">600</span>)])
    ]
    
    threads = []
    <span class="hljs-keyword">for</span> name, operations <span class="hljs-keyword">in</span> customers:
        thread = threading.Thread(target=customer_operations, args=(name, operations))
        thread.start()
        threads.append(thread)
    
    <span class="hljs-keyword">for</span> thread <span class="hljs-keyword">in</span> threads:
        thread.join()
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\næœ€ç»ˆä½™é¢: <span class="hljs-subst">{account.balance}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"äº¤æ˜“è®°å½•:"</span>, account.transactions)

<span class="hljs-comment"># 2. é˜Ÿåˆ— - çº¿ç¨‹é—´å®‰å…¨é€šä¿¡</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">producer_consumer_demo</span>():
    <span class="hljs-string">"""ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼æ¼”ç¤º"</span>)
    
    q = queue.Queue(maxsize=<span class="hljs-number">5</span>)  <span class="hljs-comment"># æœ€å¤§å®¹é‡5</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">producer</span>(<span class="hljs-params">name, items</span>):
        <span class="hljs-string">"""ç”Ÿäº§è€…"""</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(items):
            item = <span class="hljs-string">f"<span class="hljs-subst">{name}</span>çš„äº§å“-<span class="hljs-subst">{i}</span>"</span>
            q.put(item)  <span class="hljs-comment"># å¦‚æœé˜Ÿåˆ—æ»¡ï¼Œä¼šé˜»å¡ç­‰å¾…</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[ç”Ÿäº§è€…<span class="hljs-subst">{name}</span>] ç”Ÿäº§: <span class="hljs-subst">{item}</span>"</span>)
            time.sleep(<span class="hljs-number">0.5</span>)
        q.put(<span class="hljs-literal">None</span>)  <span class="hljs-comment"># å‘é€ç»“æŸä¿¡å·</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">consumer</span>(<span class="hljs-params">name</span>):
        <span class="hljs-string">"""æ¶ˆè´¹è€…"""</span>
        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
            item = q.get()  <span class="hljs-comment"># å¦‚æœé˜Ÿåˆ—ç©ºï¼Œä¼šé˜»å¡ç­‰å¾…</span>
            <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
                q.put(<span class="hljs-literal">None</span>)  <span class="hljs-comment"># ä¼ é€’ç»“æŸä¿¡å·ç»™å…¶ä»–æ¶ˆè´¹è€…</span>
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[æ¶ˆè´¹è€…<span class="hljs-subst">{name}</span>] ç»“æŸ"</span>)
                <span class="hljs-keyword">break</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[æ¶ˆè´¹è€…<span class="hljs-subst">{name}</span>] æ¶ˆè´¹: <span class="hljs-subst">{item}</span>"</span>)
            time.sleep(<span class="hljs-number">1</span>)
            q.task_done()
    
    <span class="hljs-comment"># å¯åŠ¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…</span>
    producers = [
        threading.Thread(target=producer, args=(<span class="hljs-string">"A"</span>, <span class="hljs-number">5</span>)),
        threading.Thread(target=producer, args=(<span class="hljs-string">"B"</span>, <span class="hljs-number">3</span>))
    ]
    
    consumers = [
        threading.Thread(target=consumer, args=(<span class="hljs-string">"1"</span>,)),
        threading.Thread(target=consumer, args=(<span class="hljs-string">"2"</span>,))
    ]
    
    <span class="hljs-comment"># å¯åŠ¨æ‰€æœ‰çº¿ç¨‹</span>
    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> producers:
        p.start()
    
    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> consumers:
        c.start()
    
    <span class="hljs-comment"># ç­‰å¾…ç”Ÿäº§è€…å®Œæˆ</span>
    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> producers:
        p.join()
    
    <span class="hljs-comment"># ç­‰å¾…é˜Ÿåˆ—æ¸…ç©º</span>
    q.join()
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ‰€æœ‰ä»»åŠ¡å®Œæˆ"</span>)

<span class="hljs-comment"># è¿è¡Œæ¼”ç¤º</span>
test_bank_account()
producer_consumer_demo()

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>*<span class="hljs-number">50</span>)
</code></pre>
<h3 data-id="heading-4">1.3 çº¿ç¨‹æ± </h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> concurrent.futures <span class="hljs-keyword">import</span> ThreadPoolExecutor
<span class="hljs-keyword">import</span> time

<span class="hljs-built_in">print</span>(<span class="hljs-string">"=== çº¿ç¨‹æ±  ==="</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">process_item</span>(<span class="hljs-params">item</span>):
    <span class="hljs-string">"""å¤„ç†å•ä¸ªé¡¹ç›®"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¼€å§‹å¤„ç†: <span class="hljs-subst">{item}</span>"</span>)
    time.sleep(<span class="hljs-number">1</span>)  <span class="hljs-comment"># æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span>
    result = <span class="hljs-string">f"<span class="hljs-subst">{item}</span>_processed"</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¤„ç†å®Œæˆ: <span class="hljs-subst">{item}</span> -&gt; <span class="hljs-subst">{result}</span>"</span>)
    <span class="hljs-keyword">return</span> result

<span class="hljs-keyword">def</span> <span class="hljs-title function_">thread_pool_demo</span>():
    <span class="hljs-string">"""çº¿ç¨‹æ± æ¼”ç¤º"""</span>
    
    items = [<span class="hljs-string">f"item_<span class="hljs-subst">{i}</span>"</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)]
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¼€å§‹å¤„ç† <span class="hljs-subst">{<span class="hljs-built_in">len</span>(items)}</span> ä¸ªé¡¹ç›®"</span>)
    start_time = time.time()
    
    <span class="hljs-comment"># ä½¿ç”¨çº¿ç¨‹æ± ï¼ˆæœ€å¤§3ä¸ªçº¿ç¨‹ï¼‰</span>
    <span class="hljs-keyword">with</span> ThreadPoolExecutor(max_workers=<span class="hljs-number">3</span>) <span class="hljs-keyword">as</span> executor:
        <span class="hljs-comment"># æäº¤æ‰€æœ‰ä»»åŠ¡</span>
        future_to_item = {executor.submit(process_item, item): item 
                         <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> items}
        
        <span class="hljs-comment"># æ”¶é›†ç»“æœ</span>
        results = []
        <span class="hljs-keyword">for</span> future <span class="hljs-keyword">in</span> future_to_item:
            result = future.result()
            results.append(result)
    
    end_time = time.time()
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\næ‰€æœ‰é¡¹ç›®å¤„ç†å®Œæˆ!"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ€»è€—æ—¶: <span class="hljs-subst">{end_time - start_time:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¤„ç†äº† <span class="hljs-subst">{<span class="hljs-built_in">len</span>(results)}</span> ä¸ªé¡¹ç›®"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç»“æœæ ·ä¾‹: <span class="hljs-subst">{results[:<span class="hljs-number">3</span>]}</span>..."</span>)

<span class="hljs-comment"># é«˜çº§ç‰¹æ€§ï¼šå›è°ƒå‡½æ•°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">callback_demo</span>():
    <span class="hljs-string">"""å›è°ƒå‡½æ•°æ¼”ç¤º"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nçº¿ç¨‹æ± å›è°ƒå‡½æ•°æ¼”ç¤º"</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">task</span>(<span class="hljs-params">n</span>):
        <span class="hljs-string">"""ä»»åŠ¡å‡½æ•°"""</span>
        <span class="hljs-keyword">return</span> n * n
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">callback</span>(<span class="hljs-params">future</span>):
        <span class="hljs-string">"""å›è°ƒå‡½æ•°"""</span>
        result = future.result()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å›è°ƒ: ä»»åŠ¡å®Œæˆï¼Œç»“æœ=<span class="hljs-subst">{result}</span>"</span>)
    
    <span class="hljs-keyword">with</span> ThreadPoolExecutor(max_workers=<span class="hljs-number">2</span>) <span class="hljs-keyword">as</span> executor:
        <span class="hljs-comment"># æäº¤ä»»åŠ¡å¹¶æ·»åŠ å›è°ƒ</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):
            future = executor.submit(task, i)
            future.add_done_callback(callback)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ‰€æœ‰å›è°ƒæ‰§è¡Œå®Œæˆ"</span>)

<span class="hljs-comment"># è¿è¡Œæ¼”ç¤º</span>
thread_pool_demo()
callback_demo()

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>*<span class="hljs-number">50</span>)
</code></pre>
<h2 data-id="heading-5">äºŒã€å¤šè¿›ç¨‹ç¼–ç¨‹</h2>
<h3 data-id="heading-6">2.1 åˆ›å»ºè¿›ç¨‹</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> multiprocessing
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> os

<span class="hljs-built_in">print</span>(<span class="hljs-string">"=== å¤šè¿›ç¨‹åŸºç¡€ ==="</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">worker_process</span>(<span class="hljs-params">name, delay</span>):
    <span class="hljs-string">"""å·¥ä½œè¿›ç¨‹å‡½æ•°"""</span>
    pid = os.getpid()  <span class="hljs-comment"># è·å–è¿›ç¨‹ID</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[è¿›ç¨‹<span class="hljs-subst">{pid}</span>] <span class="hljs-subst">{name}</span> å¼€å§‹å·¥ä½œï¼Œéœ€è¦ <span class="hljs-subst">{delay}</span> ç§’"</span>)
    time.sleep(delay)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[è¿›ç¨‹<span class="hljs-subst">{pid}</span>] <span class="hljs-subst">{name}</span> å·¥ä½œå®Œæˆ"</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{name}</span>çš„ç»“æœ"</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">basic_processes</span>():
    <span class="hljs-string">"""åŸºæœ¬è¿›ç¨‹åˆ›å»º"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"åˆ›å»ºå¤šä¸ªè¿›ç¨‹"</span>)
    
    processes = []
    
    <span class="hljs-comment"># åˆ›å»ºè¿›ç¨‹</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):
        p = multiprocessing.Process(
            target=worker_process,
            args=(<span class="hljs-string">f"å·¥äºº<span class="hljs-subst">{i+<span class="hljs-number">1</span>}</span>"</span>, i+<span class="hljs-number">1</span>)
        )
        processes.append(p)
        p.start()
    
    <span class="hljs-comment"># ç­‰å¾…æ‰€æœ‰è¿›ç¨‹å®Œæˆ</span>
    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> processes:
        p.join()
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ‰€æœ‰è¿›ç¨‹å·¥ä½œå®Œæˆ"</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">process_pool_demo</span>():
    <span class="hljs-string">"""è¿›ç¨‹æ± æ¼”ç¤º"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nä½¿ç”¨è¿›ç¨‹æ± "</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">cpu_intensive_task</span>(<span class="hljs-params">n</span>):
        <span class="hljs-string">"""CPUå¯†é›†å‹ä»»åŠ¡"""</span>
        result = <span class="hljs-number">0</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):
            result += i * i
        pid = os.getpid()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[è¿›ç¨‹<span class="hljs-subst">{pid}</span>] å®Œæˆè®¡ç®— n=<span class="hljs-subst">{n}</span>"</span>)
        <span class="hljs-keyword">return</span> result
    
    numbers = [<span class="hljs-number">1000000</span>, <span class="hljs-number">2000000</span>, <span class="hljs-number">3000000</span>, <span class="hljs-number">4000000</span>]
    
    start_time = time.time()
    
    <span class="hljs-comment"># ä½¿ç”¨è¿›ç¨‹æ± </span>
    <span class="hljs-keyword">with</span> multiprocessing.Pool(processes=<span class="hljs-number">2</span>) <span class="hljs-keyword">as</span> pool:
        results = pool.<span class="hljs-built_in">map</span>(cpu_intensive_task, numbers)
    
    end_time = time.time()
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è®¡ç®—å®Œæˆ!"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç»“æœ: <span class="hljs-subst">{results}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ€»è€—æ—¶: <span class="hljs-subst">{end_time - start_time:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)

<span class="hljs-comment"># è¿è¡Œæ¼”ç¤º</span>
basic_processes()
process_pool_demo()

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>*<span class="hljs-number">50</span>)
</code></pre>
<h3 data-id="heading-7">2.2 è¿›ç¨‹é—´é€šä¿¡</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> multiprocessing
<span class="hljs-keyword">import</span> time

<span class="hljs-built_in">print</span>(<span class="hljs-string">"=== è¿›ç¨‹é—´é€šä¿¡ ==="</span>)

<span class="hljs-comment"># 1. é˜Ÿåˆ—é€šä¿¡</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">queue_communication</span>():
    <span class="hljs-string">"""ä½¿ç”¨é˜Ÿåˆ—è¿›è¡Œè¿›ç¨‹é—´é€šä¿¡"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"1. é˜Ÿåˆ—é€šä¿¡æ¼”ç¤º"</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">producer</span>(<span class="hljs-params">queue, items</span>):
        <span class="hljs-string">"""ç”Ÿäº§è€…è¿›ç¨‹"""</span>
        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> items:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[ç”Ÿäº§è€…] å‘é€: <span class="hljs-subst">{item}</span>"</span>)
            queue.put(item)
            time.sleep(<span class="hljs-number">0.5</span>)
        queue.put(<span class="hljs-literal">None</span>)  <span class="hljs-comment"># ç»“æŸä¿¡å·</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">consumer</span>(<span class="hljs-params">queue, name</span>):
        <span class="hljs-string">"""æ¶ˆè´¹è€…è¿›ç¨‹"""</span>
        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
            item = queue.get()
            <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
                queue.put(<span class="hljs-literal">None</span>)  <span class="hljs-comment"># ä¼ é€’ç»“æŸä¿¡å·</span>
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[æ¶ˆè´¹è€…<span class="hljs-subst">{name}</span>] ç»“æŸ"</span>)
                <span class="hljs-keyword">break</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[æ¶ˆè´¹è€…<span class="hljs-subst">{name}</span>] æ”¶åˆ°: <span class="hljs-subst">{item}</span>"</span>)
            time.sleep(<span class="hljs-number">1</span>)
    
    <span class="hljs-comment"># åˆ›å»ºé˜Ÿåˆ—</span>
    q = multiprocessing.Queue(maxsize=<span class="hljs-number">3</span>)
    
    <span class="hljs-comment"># åˆ›å»ºè¿›ç¨‹</span>
    producer_p = multiprocessing.Process(
        target=producer,
        args=(q, [<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>, <span class="hljs-string">"D"</span>, <span class="hljs-string">"E"</span>])
    )
    
    consumer1_p = multiprocessing.Process(
        target=consumer,
        args=(q, <span class="hljs-string">"1"</span>)
    )
    
    consumer2_p = multiprocessing.Process(
        target=consumer,
        args=(q, <span class="hljs-string">"2"</span>)
    )
    
    <span class="hljs-comment"># å¯åŠ¨è¿›ç¨‹</span>
    producer_p.start()
    consumer1_p.start()
    consumer2_p.start()
    
    <span class="hljs-comment"># ç­‰å¾…å®Œæˆ</span>
    producer_p.join()
    consumer1_p.join()
    consumer2_p.join()
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"é˜Ÿåˆ—é€šä¿¡å®Œæˆ"</span>)

<span class="hljs-comment"># 2. ç®¡é“é€šä¿¡</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">pipe_communication</span>():
    <span class="hljs-string">"""ä½¿ç”¨ç®¡é“è¿›è¡Œè¿›ç¨‹é—´é€šä¿¡"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n2. ç®¡é“é€šä¿¡æ¼”ç¤º"</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">process_a</span>(<span class="hljs-params">conn</span>):
        <span class="hljs-string">"""è¿›ç¨‹A"""</span>
        conn.send(<span class="hljs-string">"Hello from Process A"</span>)
        data = conn.recv()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[Process A] æ”¶åˆ°: <span class="hljs-subst">{data}</span>"</span>)
        conn.close()
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">process_b</span>(<span class="hljs-params">conn</span>):
        <span class="hljs-string">"""è¿›ç¨‹B"""</span>
        data = conn.recv()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[Process B] æ”¶åˆ°: <span class="hljs-subst">{data}</span>"</span>)
        conn.send(<span class="hljs-string">"Hello from Process B"</span>)
        conn.close()
    
    <span class="hljs-comment"># åˆ›å»ºç®¡é“</span>
    parent_conn, child_conn = multiprocessing.Pipe()
    
    <span class="hljs-comment"># åˆ›å»ºè¿›ç¨‹</span>
    p1 = multiprocessing.Process(target=process_a, args=(parent_conn,))
    p2 = multiprocessing.Process(target=process_b, args=(child_conn,))
    
    <span class="hljs-comment"># å¯åŠ¨è¿›ç¨‹</span>
    p1.start()
    p2.start()
    
    <span class="hljs-comment"># ç­‰å¾…å®Œæˆ</span>
    p1.join()
    p2.join()
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç®¡é“é€šä¿¡å®Œæˆ"</span>)

<span class="hljs-comment"># 3. å…±äº«å†…å­˜</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">shared_memory_demo</span>():
    <span class="hljs-string">"""å…±äº«å†…å­˜æ¼”ç¤º"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n3. å…±äº«å†…å­˜æ¼”ç¤º"</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">worker</span>(<span class="hljs-params">shared_value, shared_array, lock, worker_id</span>):
        <span class="hljs-string">"""å·¥ä½œè¿›ç¨‹"""</span>
        <span class="hljs-keyword">with</span> lock:
            shared_value.value += <span class="hljs-number">1</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[Worker <span class="hljs-subst">{worker_id}</span>] å…±äº«å€¼: <span class="hljs-subst">{shared_value.value}</span>"</span>)
        
        <span class="hljs-comment"># ä¿®æ”¹å…±äº«æ•°ç»„</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(shared_array)):
            shared_array[i] = worker_id * <span class="hljs-number">10</span> + i
    
    <span class="hljs-comment"># åˆ›å»ºå…±äº«å€¼</span>
    shared_value = multiprocessing.Value(<span class="hljs-string">'i'</span>, <span class="hljs-number">0</span>)  <span class="hljs-comment"># æ•´æ•°ç±»å‹</span>
    
    <span class="hljs-comment"># åˆ›å»ºå…±äº«æ•°ç»„</span>
    shared_array = multiprocessing.Array(<span class="hljs-string">'i'</span>, <span class="hljs-number">5</span>)  <span class="hljs-comment"># 5ä¸ªæ•´æ•°çš„æ•°ç»„</span>
    
    <span class="hljs-comment"># åˆ›å»ºé”</span>
    lock = multiprocessing.Lock()
    
    <span class="hljs-comment"># åˆ›å»ºå¤šä¸ªè¿›ç¨‹</span>
    processes = []
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):
        p = multiprocessing.Process(
            target=worker,
            args=(shared_value, shared_array, lock, i+<span class="hljs-number">1</span>)
        )
        processes.append(p)
        p.start()
    
    <span class="hljs-comment"># ç­‰å¾…æ‰€æœ‰è¿›ç¨‹å®Œæˆ</span>
    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> processes:
        p.join()
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æœ€ç»ˆå…±äº«å€¼: <span class="hljs-subst">{shared_value.value}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å…±äº«æ•°ç»„: <span class="hljs-subst">{<span class="hljs-built_in">list</span>(shared_array)}</span>"</span>)

<span class="hljs-comment"># è¿è¡Œæ¼”ç¤º</span>
queue_communication()
pipe_communication()
shared_memory_demo()

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>*<span class="hljs-number">50</span>)
</code></pre>
<h2 data-id="heading-8">ä¸‰ã€é€‰æ‹©æŒ‡å—ï¼šçº¿ç¨‹ vs è¿›ç¨‹</h2>
<h3 data-id="heading-9">3.1 æ€§èƒ½å¯¹æ¯”</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> threading
<span class="hljs-keyword">import</span> multiprocessing
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> os

<span class="hljs-keyword">def</span> <span class="hljs-title function_">cpu_bound_task</span>(<span class="hljs-params">n</span>):
    <span class="hljs-string">"""CPUå¯†é›†å‹ä»»åŠ¡"""</span>
    count = <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):
        count += i * i
    <span class="hljs-keyword">return</span> count

<span class="hljs-keyword">def</span> <span class="hljs-title function_">io_bound_task</span>(<span class="hljs-params">duration</span>):
    <span class="hljs-string">"""I/Oå¯†é›†å‹ä»»åŠ¡"""</span>
    time.sleep(duration)
    <span class="hljs-keyword">return</span> duration

<span class="hljs-keyword">def</span> <span class="hljs-title function_">compare_performance</span>():
    <span class="hljs-string">"""æ¯”è¾ƒçº¿ç¨‹å’Œè¿›ç¨‹çš„æ€§èƒ½"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"=== çº¿ç¨‹ vs è¿›ç¨‹ æ€§èƒ½å¯¹æ¯” ==="</span>)
    
    <span class="hljs-comment"># æµ‹è¯•é…ç½®</span>
    task_count = <span class="hljs-number">4</span>
    cpu_task_size = <span class="hljs-number">10000000</span>
    io_task_duration = <span class="hljs-number">1</span>
    
    <span class="hljs-comment"># 1. CPUå¯†é›†å‹ä»»åŠ¡å¯¹æ¯”</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n1. CPUå¯†é›†å‹ä»»åŠ¡å¯¹æ¯”:"</span>)
    
    <span class="hljs-comment"># å•çº¿ç¨‹</span>
    start = time.time()
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(task_count):
        cpu_bound_task(cpu_task_size)
    single_time = time.time() - start
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  å•çº¿ç¨‹: <span class="hljs-subst">{single_time:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)
    
    <span class="hljs-comment"># å¤šçº¿ç¨‹ï¼ˆç”±äºGILï¼Œå¯èƒ½ä¸ä¼šæ›´å¿«ï¼‰</span>
    start = time.time()
    threads = []
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(task_count):
        t = threading.Thread(target=cpu_bound_task, args=(cpu_task_size,))
        t.start()
        threads.append(t)
    
    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:
        t.join()
    thread_time = time.time() - start
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  å¤šçº¿ç¨‹(<span class="hljs-subst">{task_count}</span>çº¿ç¨‹): <span class="hljs-subst">{thread_time:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)
    
    <span class="hljs-comment"># å¤šè¿›ç¨‹</span>
    start = time.time()
    processes = []
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(task_count):
        p = multiprocessing.Process(target=cpu_bound_task, args=(cpu_task_size,))
        p.start()
        processes.append(p)
    
    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> processes:
        p.join()
    process_time = time.time() - start
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  å¤šè¿›ç¨‹(<span class="hljs-subst">{task_count}</span>è¿›ç¨‹): <span class="hljs-subst">{process_time:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  CPUä»»åŠ¡ç»“è®º: å¤šè¿›ç¨‹æ¯”å¤šçº¿ç¨‹å¿« <span class="hljs-subst">{thread_time/process_time:<span class="hljs-number">.1</span>f}</span>å€"</span>)
    
    <span class="hljs-comment"># 2. I/Oå¯†é›†å‹ä»»åŠ¡å¯¹æ¯”</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n2. I/Oå¯†é›†å‹ä»»åŠ¡å¯¹æ¯”:"</span>)
    
    <span class="hljs-comment"># å•çº¿ç¨‹</span>
    start = time.time()
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(task_count):
        io_bound_task(io_task_duration)
    single_io_time = time.time() - start
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  å•çº¿ç¨‹: <span class="hljs-subst">{single_io_time:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)
    
    <span class="hljs-comment"># å¤šçº¿ç¨‹</span>
    start = time.time()
    threads = []
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(task_count):
        t = threading.Thread(target=io_bound_task, args=(io_task_duration,))
        t.start()
        threads.append(t)
    
    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> threads:
        t.join()
    thread_io_time = time.time() - start
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  å¤šçº¿ç¨‹(<span class="hljs-subst">{task_count}</span>çº¿ç¨‹): <span class="hljs-subst">{thread_io_time:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)
    
    <span class="hljs-comment"># å¤šè¿›ç¨‹</span>
    start = time.time()
    processes = []
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(task_count):
        p = multiprocessing.Process(target=io_bound_task, args=(io_task_duration,))
        p.start()
        processes.append(p)
    
    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> processes:
        p.join()
    process_io_time = time.time() - start
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  å¤šè¿›ç¨‹(<span class="hljs-subst">{task_count}</span>è¿›ç¨‹): <span class="hljs-subst">{process_io_time:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  I/Oä»»åŠ¡ç»“è®º: å¤šçº¿ç¨‹æ¯”å•çº¿ç¨‹å¿« <span class="hljs-subst">{single_io_time/thread_io_time:<span class="hljs-number">.1</span>f}</span>å€"</span>)
    
    <span class="hljs-comment"># 3. å†…å­˜ä½¿ç”¨å¯¹æ¯”</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n3. å†…å­˜ä½¿ç”¨æ³¨æ„äº‹é¡¹:"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"  - çº¿ç¨‹: å…±äº«å†…å­˜ï¼Œå†…å­˜ä½¿ç”¨å°‘ï¼Œä½†éœ€è¦å¤„ç†çº¿ç¨‹å®‰å…¨é—®é¢˜"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"  - è¿›ç¨‹: ç‹¬ç«‹å†…å­˜ç©ºé—´ï¼Œå†…å­˜ä½¿ç”¨å¤šï¼Œä½†ä¸éœ€è¦å¤„ç†çº¿ç¨‹å®‰å…¨é—®é¢˜"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"  - çº¿ç¨‹åˆ›å»ºå¼€é”€: å°"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"  - è¿›ç¨‹åˆ›å»ºå¼€é”€: å¤§"</span>)
    
    <span class="hljs-comment"># 4. é€‰æ‹©æŒ‡å—</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n4. é€‰æ‹©æŒ‡å—:"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"  ä½¿ç”¨å¤šçº¿ç¨‹çš„åœºæ™¯:"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"    âœ“ I/Oå¯†é›†å‹ä»»åŠ¡ï¼ˆç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å†™ï¼‰"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"    âœ“ éœ€è¦å…±äº«æ•°æ®"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"    âœ“ ä»»åŠ¡æ‰§è¡Œæ—¶é—´çŸ­"</span>)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n  ä½¿ç”¨å¤šè¿›ç¨‹çš„åœºæ™¯:"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"    âœ“ CPUå¯†é›†å‹ä»»åŠ¡ï¼ˆç§‘å­¦è®¡ç®—ã€å›¾åƒå¤„ç†ï¼‰"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"    âœ“ éœ€è¦è¿›ç¨‹éš”ç¦»ï¼ˆä¸€ä¸ªè¿›ç¨‹å´©æºƒä¸å½±å“å…¶ä»–è¿›ç¨‹ï¼‰"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"    âœ“ éœ€è¦åˆ©ç”¨å¤šæ ¸CPU"</span>)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n  é€šç”¨å»ºè®®:"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"    - ä¼˜å…ˆä½¿ç”¨concurrent.futuresæ¨¡å—"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"    - I/Oå¯†é›†å‹ï¼šä½¿ç”¨ThreadPoolExecutor"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"    - CPUå¯†é›†å‹ï¼šä½¿ç”¨ProcessPoolExecutor"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"    - ä»»åŠ¡æ•°é‡å¤šä½†ç®€å•ï¼šä½¿ç”¨çº¿ç¨‹æ± /è¿›ç¨‹æ± "</span>)

<span class="hljs-comment"># è¿è¡Œæ¯”è¾ƒ</span>
compare_performance()

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>*<span class="hljs-number">50</span>)
</code></pre>
<h3 data-id="heading-10">3.2 å®æˆ˜æ¡ˆä¾‹ï¼šå¹¶è¡Œä¸‹è½½ç®¡ç†å™¨</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> concurrent.futures
<span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> time

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ParallelDownloader</span>:
    <span class="hljs-string">"""å¹¶è¡Œä¸‹è½½ç®¡ç†å™¨"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, max_workers=<span class="hljs-number">5</span>, download_dir=<span class="hljs-string">"downloads"</span></span>):
        self.max_workers = max_workers
        self.download_dir = download_dir
        
        <span class="hljs-comment"># åˆ›å»ºä¸‹è½½ç›®å½•</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(download_dir):
            os.makedirs(download_dir)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">download_file</span>(<span class="hljs-params">self, url, filename=<span class="hljs-literal">None</span></span>):
        <span class="hljs-string">"""ä¸‹è½½å•ä¸ªæ–‡ä»¶"""</span>
        <span class="hljs-keyword">if</span> filename <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            filename = url.split(<span class="hljs-string">"/"</span>)[-<span class="hljs-number">1</span>]
        
        filepath = os.path.join(self.download_dir, filename)
        
        <span class="hljs-keyword">try</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¼€å§‹ä¸‹è½½: <span class="hljs-subst">{url}</span>"</span>)
            start_time = time.time()
            
            response = requests.get(url, stream=<span class="hljs-literal">True</span>, timeout=<span class="hljs-number">10</span>)
            response.raise_for_status()
            
            total_size = <span class="hljs-built_in">int</span>(response.headers.get(<span class="hljs-string">'content-length'</span>, <span class="hljs-number">0</span>))
            downloaded = <span class="hljs-number">0</span>
            
            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filepath, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:
                <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> response.iter_content(chunk_size=<span class="hljs-number">8192</span>):
                    <span class="hljs-keyword">if</span> chunk:
                        f.write(chunk)
                        downloaded += <span class="hljs-built_in">len</span>(chunk)
                        
                        <span class="hljs-comment"># æ˜¾ç¤ºè¿›åº¦</span>
                        <span class="hljs-keyword">if</span> total_size &gt; <span class="hljs-number">0</span>:
                            percent = downloaded * <span class="hljs-number">100</span> / total_size
                            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  <span class="hljs-subst">{filename}</span>: <span class="hljs-subst">{percent:<span class="hljs-number">.1</span>f}</span>%"</span>, end=<span class="hljs-string">'\r'</span>)
            
            end_time = time.time()
            download_time = end_time - start_time
            
            file_size = os.path.getsize(filepath)
            speed = file_size / download_time / <span class="hljs-number">1024</span>  <span class="hljs-comment"># KB/s</span>
            
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä¸‹è½½å®Œæˆ: <span class="hljs-subst">{filename}</span> (<span class="hljs-subst">{file_size/<span class="hljs-number">1024</span>:<span class="hljs-number">.1</span>f}</span>KB, <span class="hljs-subst">{speed:<span class="hljs-number">.1</span>f}</span>KB/s)"</span>)
            <span class="hljs-keyword">return</span> {
                <span class="hljs-string">'url'</span>: url,
                <span class="hljs-string">'filename'</span>: filename,
                <span class="hljs-string">'success'</span>: <span class="hljs-literal">True</span>,
                <span class="hljs-string">'size'</span>: file_size,
                <span class="hljs-string">'time'</span>: download_time,
                <span class="hljs-string">'speed'</span>: speed
            }
            
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä¸‹è½½å¤±è´¥ <span class="hljs-subst">{url}</span>: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">return</span> {
                <span class="hljs-string">'url'</span>: url,
                <span class="hljs-string">'filename'</span>: filename,
                <span class="hljs-string">'success'</span>: <span class="hljs-literal">False</span>,
                <span class="hljs-string">'error'</span>: <span class="hljs-built_in">str</span>(e)
            }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">parallel_download</span>(<span class="hljs-params">self, url_list</span>):
        <span class="hljs-string">"""å¹¶è¡Œä¸‹è½½å¤šä¸ªæ–‡ä»¶"""</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¼€å§‹å¹¶è¡Œä¸‹è½½ <span class="hljs-subst">{<span class="hljs-built_in">len</span>(url_list)}</span> ä¸ªæ–‡ä»¶"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å·¥ä½œçº¿ç¨‹æ•°: <span class="hljs-subst">{self.max_workers}</span>"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"-"</span> * <span class="hljs-number">50</span>)
        
        start_time = time.time()
        results = []
        
        <span class="hljs-comment"># ä½¿ç”¨çº¿ç¨‹æ± ï¼ˆI/Oå¯†é›†å‹ä»»åŠ¡é€‚åˆç”¨çº¿ç¨‹ï¼‰</span>
        <span class="hljs-keyword">with</span> concurrent.futures.ThreadPoolExecutor(max_workers=self.max_workers) <span class="hljs-keyword">as</span> executor:
            <span class="hljs-comment"># æäº¤æ‰€æœ‰ä¸‹è½½ä»»åŠ¡</span>
            future_to_url = {}
            <span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> url_list:
                filename = url.split(<span class="hljs-string">"/"</span>)[-<span class="hljs-number">1</span>]
                future = executor.submit(self.download_file, url, filename)
                future_to_url[future] = url
            
            <span class="hljs-comment"># æ”¶é›†ç»“æœ</span>
            <span class="hljs-keyword">for</span> future <span class="hljs-keyword">in</span> concurrent.futures.as_completed(future_to_url):
                url = future_to_url[future]
                <span class="hljs-keyword">try</span>:
                    result = future.result()
                    results.append(result)
                <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä»»åŠ¡å¼‚å¸¸ <span class="hljs-subst">{url}</span>: <span class="hljs-subst">{e}</span>"</span>)
                    results.append({
                        <span class="hljs-string">'url'</span>: url,
                        <span class="hljs-string">'success'</span>: <span class="hljs-literal">False</span>,
                        <span class="hljs-string">'error'</span>: <span class="hljs-built_in">str</span>(e)
                    })
        
        end_time = time.time()
        total_time = end_time - start_time
        
        <span class="hljs-comment"># ç»Ÿè®¡ç»“æœ</span>
        successful = [r <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> results <span class="hljs-keyword">if</span> r[<span class="hljs-string">'success'</span>]]
        failed = [r <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> results <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> r[<span class="hljs-string">'success'</span>]]
        
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>*<span class="hljs-number">50</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ä¸‹è½½å®Œæˆ!"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ€»è€—æ—¶: <span class="hljs-subst">{total_time:<span class="hljs-number">.2</span>f}</span>ç§’"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æˆåŠŸ: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(successful)}</span> ä¸ª"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¤±è´¥: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(failed)}</span> ä¸ª"</span>)
        
        <span class="hljs-keyword">if</span> successful:
            total_size = <span class="hljs-built_in">sum</span>(r[<span class="hljs-string">'size'</span>] <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> successful)
            avg_speed = <span class="hljs-built_in">sum</span>(r[<span class="hljs-string">'speed'</span>] <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> successful) / <span class="hljs-built_in">len</span>(successful)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ€»å¤§å°: <span class="hljs-subst">{total_size/<span class="hljs-number">1024</span>/<span class="hljs-number">1024</span>:<span class="hljs-number">.2</span>f}</span>MB"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¹³å‡é€Ÿåº¦: <span class="hljs-subst">{avg_speed:<span class="hljs-number">.1</span>f}</span>KB/s"</span>)
        
        <span class="hljs-keyword">if</span> failed:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nå¤±è´¥çš„æ–‡ä»¶:"</span>)
            <span class="hljs-keyword">for</span> result <span class="hljs-keyword">in</span> failed:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  <span class="hljs-subst">{result[<span class="hljs-string">'url'</span>]}</span>: <span class="hljs-subst">{result.get(<span class="hljs-string">'error'</span>, <span class="hljs-string">'æœªçŸ¥é”™è¯¯'</span>)}</span>"</span>)
        
        <span class="hljs-keyword">return</span> results

<span class="hljs-comment"># æ¨¡æ‹Ÿä½¿ç”¨</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">demo_downloader</span>():
    <span class="hljs-string">"""ä¸‹è½½ç®¡ç†å™¨æ¼”ç¤º"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"=== å¹¶è¡Œä¸‹è½½ç®¡ç†å™¨æ¼”ç¤º ==="</span>)
    
    <span class="hljs-comment"># ç¤ºä¾‹URLåˆ—è¡¨ï¼ˆå®é™…ä½¿ç”¨æ—¶æ›¿æ¢ä¸ºçœŸå®URLï¼‰</span>
    <span class="hljs-comment"># æ³¨æ„ï¼šè¿™é‡Œä½¿ç”¨ä¸€äº›å…¬å¼€çš„æµ‹è¯•URL</span>
    test_urls = [
        <span class="hljs-string">"https://httpbin.org/image/jpeg"</span>,  <span class="hljs-comment"># æµ‹è¯•å›¾ç‰‡</span>
        <span class="hljs-string">"https://httpbin.org/image/png"</span>,
        <span class="hljs-string">"https://httpbin.org/image/svg"</span>,
        <span class="hljs-string">"https://httpbin.org/html"</span>,        <span class="hljs-comment"># æµ‹è¯•HTML</span>
        <span class="hljs-string">"https://httpbin.org/robots.txt"</span>,  <span class="hljs-comment"># æµ‹è¯•æ–‡æœ¬</span>
        <span class="hljs-string">"https://httpbin.org/xml"</span>          <span class="hljs-comment"># æµ‹è¯•XML</span>
    ]
    
    <span class="hljs-comment"># åˆ›å»ºä¸‹è½½ç®¡ç†å™¨</span>
    downloader = ParallelDownloader(max_workers=<span class="hljs-number">3</span>, download_dir=<span class="hljs-string">"test_downloads"</span>)
    
    <span class="hljs-comment"># æ‰§è¡Œå¹¶è¡Œä¸‹è½½</span>
    results = downloader.parallel_download(test_urls)
    
    <span class="hljs-keyword">return</span> results

<span class="hljs-built_in">print</span>(<span class="hljs-string">"å®æˆ˜æ¡ˆä¾‹ï¼šå¹¶è¡Œä¸‹è½½ç®¡ç†å™¨"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"è¿™ä¸ªç®¡ç†å™¨å¯ä»¥åŒæ—¶ä¸‹è½½å¤šä¸ªæ–‡ä»¶ï¼Œæé«˜ä¸‹è½½æ•ˆç‡"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ³¨æ„ï¼šæ¼”ç¤ºä»£ç ä¸­ä½¿ç”¨çš„æ˜¯æµ‹è¯•URLï¼Œå®é™…ä½¿ç”¨æ—¶éœ€è¦æ›¿æ¢ä¸ºçœŸå®URL"</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>*<span class="hljs-number">50</span>)
</code></pre>
<h2 data-id="heading-11">æ€»ç»“ï¼šæœ€ä½³å®è·µæŒ‡å—</h2>
<h3 data-id="heading-12">å…³é”®å†³ç­–ç‚¹ï¼š</h3>
<ol>
<li><strong>CPUå¯†é›†å‹ä»»åŠ¡</strong>Â â†’ ä½¿ç”¨å¤šè¿›ç¨‹</li>
<li><strong>I/Oå¯†é›†å‹ä»»åŠ¡</strong>Â â†’ ä½¿ç”¨å¤šçº¿ç¨‹</li>
<li><strong>éœ€è¦æ•°æ®å…±äº«</strong>Â â†’ å¤šçº¿ç¨‹æˆ–å…±äº«å†…å­˜</li>
<li><strong>éœ€è¦è¿›ç¨‹éš”ç¦»</strong>Â â†’ å¤šè¿›ç¨‹</li>
<li><strong>ä¸ç¡®å®šä»»åŠ¡ç±»å‹</strong>Â â†’ å…ˆæµ‹è¯•ï¼Œåé€‰æ‹©</li>
</ol>
<h3 data-id="heading-13">æœ€ä½³å®è·µï¼š</h3>
<ol>
<li><strong>ä½¿ç”¨é«˜å±‚API</strong>ï¼šä¼˜å…ˆä½¿ç”¨<code>concurrent.futures</code>æ¨¡å—</li>
<li><strong>æ§åˆ¶å¹¶å‘æ•°</strong>ï¼šåˆç†è®¾ç½®çº¿ç¨‹/è¿›ç¨‹æ•°é‡</li>
<li><strong>å¤„ç†å¼‚å¸¸</strong>ï¼šç¡®ä¿å¼‚å¸¸ä¸ä¼šå¯¼è‡´ç¨‹åºå´©æºƒ</li>
<li><strong>èµ„æºæ¸…ç†</strong>ï¼šä½¿ç”¨withè¯­å¥ç¡®ä¿èµ„æºæ­£ç¡®é‡Šæ”¾</li>
<li><strong>æ€§èƒ½ç›‘æ§</strong>ï¼šè®°å½•æ‰§è¡Œæ—¶é—´å’Œèµ„æºä½¿ç”¨æƒ…å†µ</li>
</ol>
<h3 data-id="heading-14">å¸¸è§é™·é˜±ï¼š</h3>
<ol>
<li><strong>æ­»é”</strong>ï¼šå¤šä¸ªé”ç›¸äº’ç­‰å¾…</li>
<li><strong>ç«æ€æ¡ä»¶</strong>ï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹å…±äº«æ•°æ®</li>
<li><strong>å†…å­˜æ³„æ¼</strong>ï¼šå¿˜è®°é‡Šæ”¾èµ„æº</li>
<li><strong>è¿‡åº¦å¹¶å‘</strong>ï¼šåˆ›å»ºè¿‡å¤šçº¿ç¨‹/è¿›ç¨‹å¯¼è‡´ç³»ç»Ÿå¡é¡¿</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[mysqlç´¢å¼•å½±å“æŸ¥è¯¢é€Ÿåº¦çš„ç¤ºä¾‹demo]]></title>    <link>https://juejin.cn/post/7588034035287392271</link>    <guid>https://juejin.cn/post/7588034035287392271</guid>    <pubDate>2025-12-27T08:56:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588034035287392271" data-draft-id="7588034035287359503" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="mysqlç´¢å¼•å½±å“æŸ¥è¯¢é€Ÿåº¦çš„ç¤ºä¾‹demo"/> <meta itemprop="keywords" content="MySQL"/> <meta itemprop="datePublished" content="2025-12-27T08:56:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ˆé‡Œè°¢é¡¿"/> <meta itemprop="url" content="https://juejin.cn/user/3678304397695056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            mysqlç´¢å¼•å½±å“æŸ¥è¯¢é€Ÿåº¦çš„ç¤ºä¾‹demo
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3678304397695056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ˆé‡Œè°¢é¡¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T08:56:15.000Z" title="Sat Dec 27 2025 08:56:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ç´¢å¼•å½±å“æŸ¥è¯¢é€Ÿåº¦çš„ç¤ºä¾‹demoï¼Œé€šè¿‡å®é™…å¯¹æ¯”å¯ä»¥ç›´è§‚æ„Ÿå—ç´¢å¼•çš„å¼ºå¤§ä½œç”¨ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€æµ‹è¯•ç¯å¢ƒå‡†å¤‡</h2>
<h3 data-id="heading-1">1. åˆ›å»ºæµ‹è¯•æ•°æ®åº“å’Œè¡¨</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ›å»ºæµ‹è¯•æ•°æ®åº“</span>
<span class="hljs-keyword">CREATE</span> DATABASE index_demo;
USE index_demo;

<span class="hljs-comment">-- åˆ›å»ºç”¨æˆ·è¡¨ï¼ˆæ— ç´¢å¼•çŠ¶æ€ï¼‰</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> users_no_index (
    id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
    username <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    age <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    city <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    created_at DATETIME <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>
);

<span class="hljs-comment">-- åˆ›å»ºç”¨æˆ·è¡¨ï¼ˆæœ‰ç´¢å¼•çŠ¶æ€ï¼‰</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> users_with_index (
    id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
    username <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    age <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    city <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    created_at DATETIME <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>,
    INDEX idx_username (username),
    INDEX idx_email (email),
    INDEX idx_age_city (age, city),
    INDEX idx_created_at (created_at)
);
</code></pre>
<h3 data-id="heading-2">2. æ’å…¥å¤§é‡æµ‹è¯•æ•°æ®</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æ’å…¥50ä¸‡æ¡æµ‹è¯•æ•°æ®</span>
DELIMITER $$
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> insert_test_data()
<span class="hljs-keyword">BEGIN</span>
    <span class="hljs-keyword">DECLARE</span> i <span class="hljs-type">INT</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">1</span>;
    WHILE i <span class="hljs-operator">&lt;=</span> <span class="hljs-number">500000</span> DO
        <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> users_no_index (username, email, age, city) <span class="hljs-keyword">VALUES</span> (
            CONCAT(<span class="hljs-string">'user'</span>, i),
            CONCAT(<span class="hljs-string">'user'</span>, i, <span class="hljs-string">'@example.com'</span>),
            <span class="hljs-built_in">FLOOR</span>(<span class="hljs-number">18</span> <span class="hljs-operator">+</span> RAND() <span class="hljs-operator">*</span> <span class="hljs-number">50</span>),
            ELT(<span class="hljs-built_in">FLOOR</span>(<span class="hljs-number">1</span> <span class="hljs-operator">+</span> RAND() <span class="hljs-operator">*</span> <span class="hljs-number">10</span>), <span class="hljs-string">'åŒ—äº¬'</span>, <span class="hljs-string">'ä¸Šæµ·'</span>, <span class="hljs-string">'å¹¿å·'</span>, <span class="hljs-string">'æ·±åœ³'</span>, <span class="hljs-string">'æ­å·'</span>, <span class="hljs-string">'å—äº¬'</span>, <span class="hljs-string">'æ­¦æ±‰'</span>, <span class="hljs-string">'æˆéƒ½'</span>, <span class="hljs-string">'è¥¿å®‰'</span>, <span class="hljs-string">'é‡åº†'</span>)
        );
        
        <span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> users_with_index (username, email, age, city) <span class="hljs-keyword">VALUES</span> (
            CONCAT(<span class="hljs-string">'user'</span>, i),
            CONCAT(<span class="hljs-string">'user'</span>, i, <span class="hljs-string">'@example.com'</span>),
            <span class="hljs-built_in">FLOOR</span>(<span class="hljs-number">18</span> <span class="hljs-operator">+</span> RAND() <span class="hljs-operator">*</span> <span class="hljs-number">50</span>),
            ELT(<span class="hljs-built_in">FLOOR</span>(<span class="hljs-number">1</span> <span class="hljs-operator">+</span> RAND() <span class="hljs-operator">*</span> <span class="hljs-number">10</span>), <span class="hljs-string">'åŒ—äº¬'</span>, <span class="hljs-string">'ä¸Šæµ·'</span>, <span class="hljs-string">'å¹¿å·'</span>, <span class="hljs-string">'æ·±åœ³'</span>, <span class="hljs-string">'æ­å·'</span>, <span class="hljs-string">'å—äº¬'</span>, <span class="hljs-string">'æ­¦æ±‰'</span>, <span class="hljs-string">'æˆéƒ½'</span>, <span class="hljs-string">'è¥¿å®‰'</span>, <span class="hljs-string">'é‡åº†'</span>)
        );
        
        IF i <span class="hljs-operator">%</span> <span class="hljs-number">10000</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span> <span class="hljs-keyword">THEN</span>
            <span class="hljs-keyword">SELECT</span> CONCAT(<span class="hljs-string">'å·²æ’å…¥ '</span>, i, <span class="hljs-string">' æ¡æ•°æ®'</span>) <span class="hljs-keyword">AS</span> progress;
        <span class="hljs-keyword">END</span> IF;
        <span class="hljs-keyword">SET</span> i <span class="hljs-operator">=</span> i <span class="hljs-operator">+</span> <span class="hljs-number">1</span>;
    <span class="hljs-keyword">END</span> WHILE;
<span class="hljs-keyword">END</span>$$
DELIMITER ;

<span class="hljs-comment">-- æ‰§è¡Œæ•°æ®æ’å…¥ï¼ˆè¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿï¼‰</span>
<span class="hljs-keyword">CALL</span> insert_test_data();
</code></pre>
<h2 data-id="heading-3">äºŒã€æ€§èƒ½å¯¹æ¯”æµ‹è¯•</h2>
<h3 data-id="heading-4">æµ‹è¯•1ï¼šåŸºæœ¬æŸ¥è¯¢å¯¹æ¯”</h3>
<pre><code class="hljs language-sql" lang="sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> users_no_index <span class="hljs-keyword">WHERE</span> username <span class="hljs-operator">=</span> <span class="hljs-string">'user110000'</span>;
<span class="hljs-operator">+</span><span class="hljs-comment">--------+------------+------------------------+-----+--------+---------------------+</span>
<span class="hljs-operator">|</span> id     <span class="hljs-operator">|</span> username   <span class="hljs-operator">|</span> email                  <span class="hljs-operator">|</span> age <span class="hljs-operator">|</span> city   <span class="hljs-operator">|</span> created_at          <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">--------+------------+------------------------+-----+--------+---------------------+</span>
<span class="hljs-operator">|</span> <span class="hljs-number">110000</span> <span class="hljs-operator">|</span> user110000 <span class="hljs-operator">|</span> user110000<span class="hljs-variable">@example</span>.com <span class="hljs-operator">|</span>  <span class="hljs-number">36</span> <span class="hljs-operator">|</span> åŒ—äº¬   <span class="hljs-operator">|</span> <span class="hljs-number">2025</span><span class="hljs-number">-12</span><span class="hljs-number">-27</span> <span class="hljs-number">16</span>:<span class="hljs-number">33</span>:<span class="hljs-number">15</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">--------+------------+------------------------+-----+--------+---------------------+</span>
<span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.08</span> sec)

mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> users_with_index <span class="hljs-keyword">WHERE</span> username <span class="hljs-operator">=</span> <span class="hljs-string">'user110000'</span>;
<span class="hljs-operator">+</span><span class="hljs-comment">--------+------------+------------------------+-----+--------+---------------------+</span>
<span class="hljs-operator">|</span> id     <span class="hljs-operator">|</span> username   <span class="hljs-operator">|</span> email                  <span class="hljs-operator">|</span> age <span class="hljs-operator">|</span> city   <span class="hljs-operator">|</span> created_at          <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">--------+------------+------------------------+-----+--------+---------------------+</span>
<span class="hljs-operator">|</span> <span class="hljs-number">110000</span> <span class="hljs-operator">|</span> user110000 <span class="hljs-operator">|</span> user110000<span class="hljs-variable">@example</span>.com <span class="hljs-operator">|</span>  <span class="hljs-number">66</span> <span class="hljs-operator">|</span> æˆéƒ½   <span class="hljs-operator">|</span> <span class="hljs-number">2025</span><span class="hljs-number">-12</span><span class="hljs-number">-27</span> <span class="hljs-number">16</span>:<span class="hljs-number">33</span>:<span class="hljs-number">15</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">--------+------------+------------------------+-----+--------+---------------------+</span>
<span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)
</code></pre>
<h3 data-id="heading-5">æµ‹è¯•2ï¼šç²¾ç¡®çš„æ€§èƒ½æµ‹é‡</h3>
<pre><code class="hljs language-sql" lang="sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SET</span> profiling <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected, <span class="hljs-number">1</span> warning (<span class="hljs-number">0.00</span> sec)

mysql<span class="hljs-operator">&gt;</span> 
mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> users_no_index <span class="hljs-keyword">WHERE</span> username <span class="hljs-operator">=</span> <span class="hljs-string">'user110000'</span>;
<span class="hljs-operator">+</span><span class="hljs-comment">--------+------------+------------------------+-----+--------+---------------------+</span>
<span class="hljs-operator">|</span> id     <span class="hljs-operator">|</span> username   <span class="hljs-operator">|</span> email                  <span class="hljs-operator">|</span> age <span class="hljs-operator">|</span> city   <span class="hljs-operator">|</span> created_at          <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">--------+------------+------------------------+-----+--------+---------------------+</span>
<span class="hljs-operator">|</span> <span class="hljs-number">110000</span> <span class="hljs-operator">|</span> user110000 <span class="hljs-operator">|</span> user110000<span class="hljs-variable">@example</span>.com <span class="hljs-operator">|</span>  <span class="hljs-number">36</span> <span class="hljs-operator">|</span> åŒ—äº¬   <span class="hljs-operator">|</span> <span class="hljs-number">2025</span><span class="hljs-number">-12</span><span class="hljs-number">-27</span> <span class="hljs-number">16</span>:<span class="hljs-number">33</span>:<span class="hljs-number">15</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">--------+------------+------------------------+-----+--------+---------------------+</span>
<span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.07</span> sec)

mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SHOW</span> PROFILE <span class="hljs-keyword">FOR</span> QUERY <span class="hljs-number">1</span>;
<span class="hljs-operator">+</span><span class="hljs-comment">--------------------------------+----------+</span>
<span class="hljs-operator">|</span> Status                         <span class="hljs-operator">|</span> Duration <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">--------------------------------+----------+</span>
<span class="hljs-operator">|</span> starting                       <span class="hljs-operator">|</span> <span class="hljs-number">0.000094</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> Executing hook <span class="hljs-keyword">on</span> transaction  <span class="hljs-operator">|</span> <span class="hljs-number">0.000006</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> starting                       <span class="hljs-operator">|</span> <span class="hljs-number">0.000034</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> checking permissions           <span class="hljs-operator">|</span> <span class="hljs-number">0.000006</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> Opening tables                 <span class="hljs-operator">|</span> <span class="hljs-number">0.000034</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> init                           <span class="hljs-operator">|</span> <span class="hljs-number">0.000011</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-keyword">System</span> lock                    <span class="hljs-operator">|</span> <span class="hljs-number">0.000007</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> optimizing                     <span class="hljs-operator">|</span> <span class="hljs-number">0.000011</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> statistics                     <span class="hljs-operator">|</span> <span class="hljs-number">0.000022</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> preparing                      <span class="hljs-operator">|</span> <span class="hljs-number">0.000021</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> executing                      <span class="hljs-operator">|</span> <span class="hljs-number">0.073159</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-keyword">end</span>                            <span class="hljs-operator">|</span> <span class="hljs-number">0.000040</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> query <span class="hljs-keyword">end</span>                      <span class="hljs-operator">|</span> <span class="hljs-number">0.000004</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> waiting <span class="hljs-keyword">for</span> handler <span class="hljs-keyword">commit</span>     <span class="hljs-operator">|</span> <span class="hljs-number">0.000007</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> closing tables                 <span class="hljs-operator">|</span> <span class="hljs-number">0.000008</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> freeing items                  <span class="hljs-operator">|</span> <span class="hljs-number">0.000220</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> cleaning up                    <span class="hljs-operator">|</span> <span class="hljs-number">0.000018</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">--------------------------------+----------+</span>
<span class="hljs-number">17</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span>, <span class="hljs-number">1</span> warning (<span class="hljs-number">0.00</span> sec)

mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> users_with_index <span class="hljs-keyword">WHERE</span> username <span class="hljs-operator">=</span> <span class="hljs-string">'user110000'</span>;
<span class="hljs-operator">+</span><span class="hljs-comment">--------+------------+------------------------+-----+--------+---------------------+</span>
<span class="hljs-operator">|</span> id     <span class="hljs-operator">|</span> username   <span class="hljs-operator">|</span> email                  <span class="hljs-operator">|</span> age <span class="hljs-operator">|</span> city   <span class="hljs-operator">|</span> created_at          <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">--------+------------+------------------------+-----+--------+---------------------+</span>
<span class="hljs-operator">|</span> <span class="hljs-number">110000</span> <span class="hljs-operator">|</span> user110000 <span class="hljs-operator">|</span> user110000<span class="hljs-variable">@example</span>.com <span class="hljs-operator">|</span>  <span class="hljs-number">66</span> <span class="hljs-operator">|</span> æˆéƒ½   <span class="hljs-operator">|</span> <span class="hljs-number">2025</span><span class="hljs-number">-12</span><span class="hljs-number">-27</span> <span class="hljs-number">16</span>:<span class="hljs-number">33</span>:<span class="hljs-number">15</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">--------+------------+------------------------+-----+--------+---------------------+</span>
<span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)

mysql<span class="hljs-operator">&gt;</span> 
mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SHOW</span> PROFILE <span class="hljs-keyword">FOR</span> QUERY <span class="hljs-number">2</span>;
<span class="hljs-operator">+</span><span class="hljs-comment">--------------------------------+----------+</span>
<span class="hljs-operator">|</span> Status                         <span class="hljs-operator">|</span> Duration <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">--------------------------------+----------+</span>
<span class="hljs-operator">|</span> starting                       <span class="hljs-operator">|</span> <span class="hljs-number">0.000096</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> Executing hook <span class="hljs-keyword">on</span> transaction  <span class="hljs-operator">|</span> <span class="hljs-number">0.000006</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> starting                       <span class="hljs-operator">|</span> <span class="hljs-number">0.000005</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> checking permissions           <span class="hljs-operator">|</span> <span class="hljs-number">0.000005</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> Opening tables                 <span class="hljs-operator">|</span> <span class="hljs-number">0.000040</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> init                           <span class="hljs-operator">|</span> <span class="hljs-number">0.000005</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-keyword">System</span> lock                    <span class="hljs-operator">|</span> <span class="hljs-number">0.000006</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> optimizing                     <span class="hljs-operator">|</span> <span class="hljs-number">0.000011</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> statistics                     <span class="hljs-operator">|</span> <span class="hljs-number">0.000089</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> preparing                      <span class="hljs-operator">|</span> <span class="hljs-number">0.000040</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> executing                      <span class="hljs-operator">|</span> <span class="hljs-number">0.000051</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-keyword">end</span>                            <span class="hljs-operator">|</span> <span class="hljs-number">0.000005</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> query <span class="hljs-keyword">end</span>                      <span class="hljs-operator">|</span> <span class="hljs-number">0.000005</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> waiting <span class="hljs-keyword">for</span> handler <span class="hljs-keyword">commit</span>     <span class="hljs-operator">|</span> <span class="hljs-number">0.000007</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> closing tables                 <span class="hljs-operator">|</span> <span class="hljs-number">0.000006</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> freeing items                  <span class="hljs-operator">|</span> <span class="hljs-number">0.000168</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> cleaning up                    <span class="hljs-operator">|</span> <span class="hljs-number">0.000012</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">--------------------------------+----------+</span>
<span class="hljs-number">17</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span>, <span class="hljs-number">1</span> warning (<span class="hljs-number">0.00</span> sec)

mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SHOW</span> PROFILES;
<span class="hljs-operator">+</span><span class="hljs-comment">----------+------------+--------------------------------------------------------------+</span>
<span class="hljs-operator">|</span> Query_ID <span class="hljs-operator">|</span> Duration   <span class="hljs-operator">|</span> Query                                                        <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">----------+------------+--------------------------------------------------------------+</span>
<span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span> <span class="hljs-number">0.07369975</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> users_no_index <span class="hljs-keyword">WHERE</span> username <span class="hljs-operator">=</span> <span class="hljs-string">'user110000'</span>   <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span>        <span class="hljs-number">2</span> <span class="hljs-operator">|</span> <span class="hljs-number">0.00055400</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> users_with_index <span class="hljs-keyword">WHERE</span> username <span class="hljs-operator">=</span> <span class="hljs-string">'user110000'</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">----------+------------+--------------------------------------------------------------+</span>
<span class="hljs-number">2</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span>, <span class="hljs-number">1</span> warning (<span class="hljs-number">0.00</span> sec)
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2025 å¹´ç»ˆé†’æ‚Ÿï¼ŒAI è®©æˆ‘è¯¯ä»¥ä¸ºè‡ªå·±å¾ˆå¼ºï¼Œæœªæ¥ç¨‹åºå‘˜çš„è½¬å‹ä¹‹è·¯]]></title>    <link>https://juejin.cn/post/7587845752681807935</link>    <guid>https://juejin.cn/post/7587845752681807935</guid>    <pubDate>2025-12-26T06:56:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587845752681807935" data-draft-id="7587825267878363177" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2025 å¹´ç»ˆé†’æ‚Ÿï¼ŒAI  è®©æˆ‘è¯¯ä»¥ä¸ºè‡ªå·±å¾ˆå¼ºï¼Œæœªæ¥ç¨‹åºå‘˜çš„è½¬å‹ä¹‹è·¯"/> <meta itemprop="keywords" content="å‰ç«¯,Android,Flutter"/> <meta itemprop="datePublished" content="2025-12-26T06:56:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‹çŒ«deå°éƒ­"/> <meta itemprop="url" content="https://juejin.cn/user/817692379985752"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2025 å¹´ç»ˆé†’æ‚Ÿï¼ŒAI  è®©æˆ‘è¯¯ä»¥ä¸ºè‡ªå·±å¾ˆå¼ºï¼Œæœªæ¥ç¨‹åºå‘˜çš„è½¬å‹ä¹‹è·¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/817692379985752/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‹çŒ«deå°éƒ­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T06:56:11.000Z" title="Fri Dec 26 2025 06:56:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>2025 å¯ä»¥è¯´åªè¦æ˜¯å¼€å‘è€…éƒ½ç»•ä¸è¿‡ AI ï¼Œ<strong>æ—¶è‡³ä»Šæ—¥ä½ è¯´ä½ ä¸ç”¨ AI å†™ä»£ç æˆ‘æ˜¯ä¸ä¿¡çš„</strong>ï¼Œä½†æ˜¯ç›´åˆ°æœ€è¿‘æˆ‘æ‰å‘ç°ï¼Œæˆ‘ä¼¼ä¹å·²ç»æŠŠ AI çš„èƒ½åŠ›å½“åšè‡ªå·±çš„èƒ½åŠ›ï¼Œè¿™ç§é”™è§‰ä½“ç°åœ¨ï¼Œæ˜¨å¤©æˆ‘ç”¨ AI äº”åˆ†é’Ÿåšå‡ºè¿™ä¸‹æ–¹è¿™ä¸ªåŠ¨ç”»æ•ˆæœï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3613ce014e91453e94fd1c50e05143b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767336971&amp;x-signature=V%2FggoLB%2BRrHCDNxj18pG0%2BKeNEk%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ä¸çŸ¥é“æœ‰æ²¡æœ‰äººèƒ½çœ‹å‡ºè¿™ä¸ªåŠ¨ç”»é‡Œçš„æ¢—ã€‚ã€‚ã€‚ã€‚</p>
</blockquote>
<p>è‡ªä»æœ‰äº† AI ä¹‹åï¼Œæœ‰é—®é¢˜å¯ä»¥è®© AI è§£è¯»ï¼Œæœ‰éœ€æ±‚å¯ä»¥è®© AI åˆ†è§£ï¼Œæ¯”å¦‚æˆ‘æƒ³åšä¸Šé¢é‚£ä¸ªåŠ¨ç”»çš„æ—¶å€™ï¼Œåªéœ€è¦è®© AI å…ˆæ ¹æ®æˆ‘çš„è¡¨è¿°ç»™å‡ºæ•°å­¦å…¬å¼ï¼Œç„¶åæ ¹æ®å…¬å¼å†è®© AI å®ç°å’Œç»„åˆä»£ç ï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹æˆ‘åªéœ€è¦ç‚¹ä¸€ç‚¹è¿è¡Œï¼Œé¢„è§ˆä¸‹æ•ˆæœç¬¦ä¸ç¬¦åˆæˆ‘çš„è¦æ±‚ï¼Œç„¶åæˆ‘å°±è§‰å¾—è‡ªå·±å¼ºçš„å¯æ€•ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b801a608a3d495ca937d2d310dc418b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767336971&amp;x-signature=4sQwLflLYn2KO2O6JqxXpFkmZiU%3D" alt="image-20251226121839643" loading="lazy"/></p>
<p><strong>è¿™ç§é”™è§‰ç»å¸¸è®©æˆ‘é™·å…¥ä»¥ä¸ºè‡ªå·±â€œæ— æ‰€ä¸èƒ½â€</strong>ï¼Œåœ¨ææ•ˆçš„åŒæ—¶ï¼Œå¿ƒæ€ä¼¼ä¹ä¹Ÿåœ¨æ…¢æ…¢çš„èµ°åï¼Œæ¯”å¦‚è¿™æ®µæ—¶é—´ä»¥æ¥ï¼Œæˆ‘é€šè¿‡ AI å¤åˆ»å’Œå°è¯•äº†è®¸å¤šç‰¹æ•ˆï¼Œè™½ç„¶å¶å°”éœ€è¦æˆ‘ä»‹å…¥ä¿®æ”¹é—®é¢˜ï¼Œä½†æ˜¯å¤§å¤šæ•°æ—¶å€™éƒ½æ˜¯åœ¨ Vibe Coding ï¼Œ<strong>è€Œçœ‹ç€è¿™äº›å……æ»¡æƒ³è±¡åŠ›çš„ç‚«é…·åŠ¨ç”»ï¼Œé‚£ç§è‡ªä»¥ä¸ºæ˜¯çš„å¿ƒç†å°±ä¼šè¢« AI æ— é™æ”¾å¤§</strong> ã€‚</p>






























<table><thead><tr><th/><th/><th/></tr></thead><tbody><tr><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9a0b6d11b53452aabc66265090bff30~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767336971&amp;x-signature=B4fz6UPLNseq%2BwXTBX5v2pwKfmA%3D" alt="" loading="lazy"/></td><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b0652e86bc274bbe848f632b1c9a4de0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767336971&amp;x-signature=DTitkkZn7FjnWI7tNlmYg6Dw5Nc%3D" alt="" loading="lazy"/></td><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/59c367b6756e4943be98af358fbda0b6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767336971&amp;x-signature=Pr6BMhu8aVvezQ54%2FAr6Kk2XRaw%3D" alt="" loading="lazy"/></td></tr><tr><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a7e6a3504cef472aafc13d3dbd1a3231~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767336971&amp;x-signature=A2xT%2Bo62zuV2YSno8IMzQsBzZuY%3D" alt="" loading="lazy"/></td><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/27890d610f0a46c8b03fc3729d950408~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767336971&amp;x-signature=ttJCBUnDlMTHPlcf4t5yp%2BIq88U%3D" alt="" loading="lazy"/></td><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b946921d4ccc4edbb9a1029fdc24ddcc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767336971&amp;x-signature=76PXV6IfJcYGOFboTNrrVWHY4Es%3D" alt="" loading="lazy"/></td></tr><tr><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d0922dc78fe5456fac76e2f26777624a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767336971&amp;x-signature=uuAOJoF5FGq7IhDEStgVaI6oQb0%3D" alt="" loading="lazy"/></td><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/704d800576f34e0f8529a09be8951d83~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767336971&amp;x-signature=7LLJKuhnAaUJeEkTnKM%2F7jomc1k%3D" alt="" loading="lazy"/></td><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b9f9c62e85e74c21a076cd06236976ce~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767336971&amp;x-signature=lqxbzv51reLd%2Bum5GesSiHyi59U%3D" alt="" loading="lazy"/></td></tr><tr><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b801b53c1d0461fbac8c3e136fbd2c1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767336971&amp;x-signature=4bKyBdV4vnEg7AkYw%2FJRwR86lm0%3D" alt="" loading="lazy"/></td><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5af36b93fae24792aa76ccbaed68dda9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767336971&amp;x-signature=qhOkHiOw5CYUmcVJ6HNGjhmXl5A%3D" alt="" loading="lazy"/></td><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/409a495b57284042bb88798cf8c738c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767336971&amp;x-signature=24DWwASBfi1wo%2BF%2Bpnly9BlI3%2Fw%3D" alt="" loading="lazy"/></td></tr></tbody></table>
<p>ä½†æ˜¯ç°åœ¨æƒ³æ¥ï¼Œä½ çœŸçš„ç†è§£è¿‡è¿™äº›åŠ¨ç”»å—ï¼ŸçœŸçš„æœ‰å»äº†è§£ä»–ä»¬çš„å®ç°åŸç†å’Œå®ç°é€»è¾‘å—ï¼Ÿå°±ç®—äº‹åçœ‹è¿‡ï¼Œä¸æ˜¯ä½ å†™çš„ä¸œè¥¿ï¼Œè¿‡åè¿˜æœ‰å°è±¡å—ï¼Ÿä¹Ÿè®©æˆ‘æƒ³èµ·äº†  Anthropic åœ¨ <a href="https://juejin.cn/post/7579555970594947113" target="_blank" title="https://juejin.cn/post/7579555970594947113">ã€ŠHow AI Is Transforming Work at Anthropicã€‹</a> æ–‡ç« é‡Œæåˆ°è¿‡çš„ï¼š</p>
<blockquote>
<p>â€œæˆ‘ä»¥ä¸ºæˆ‘å–œæ¬¢å†™ä»£ç ï¼Œå…¶å®æˆ‘åªæ˜¯å–œæ¬¢ä»£ç è·‘é€šçš„ç»“æœâ€ã€‚</p>
</blockquote>
<p>è¿™ä¹Ÿè®©æˆ‘å¼€å§‹æ€€ç–‘ï¼Œæˆ‘ç©¶ç«Ÿæ˜¯å–œæ¬¢å†™ä»£ç ï¼Œè¿˜æ˜¯åªæ˜¯å•çº¯å–œæ¬¢è·‘é€šäº§å“ï¼Ÿåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒAI å¸¦æ¥çš„çŸ­æœŸèƒ½åŠ›æå‡ï¼Œå¾ˆå®¹æ˜“å°±è®©äººå¯¹è‡ªå·±çš„å®šä½äº§ç”Ÿè¯¯å·®ï¼Œå®é™…ä¸Šè¿™ä¸ªè¿‡ç¨‹æœ‰æ²¡æœ‰å‘ç°ä½ çš„èƒ½åŠ›å¯èƒ½æ­£åœ¨å€’é€€ï¼Ÿ</p>
<p>è¿™ç§<strong>èŒä¸šè®¤åŒçš„å±æœºä¸åªæ˜¯å¤–éƒ¨å¼€å‘è€…æœ‰ï¼Œ Claude å†…éƒ¨å¼€å‘è€…ä¹Ÿæœ‰è¿™ä¸ªç„¦è™‘</strong>ï¼Œæ‰€ä»¥æœªæ¥ AI å¯¹äºå¼€å‘è€…çš„å½±å“ï¼Œè¿˜å¯èƒ½ä¼šå¸¦æ¥æ–°çš„èŒä¸šä»·å€¼è§‚çš„é‡æ„ï¼Œæ‰€ä»¥æœ‰äººæ„Ÿåˆ°è¿·èŒ«ï¼š<strong>å¦‚æœå†™ä»£ç è¿™ä¸ªåŠ¨ä½œæœ¬èº«ä¸å†é‡è¦ï¼Œé‚£ä¹ˆä»¥åä½œä¸ºè½¯ä»¶å·¥ç¨‹å¸ˆçš„èº«ä»½è®¤åŒå»ºç«‹åœ¨å“ªé‡Œ</strong>ï¼Ÿ</p>
<blockquote>
<p>è€Œåœ¨è¿™ä¸ªè¿‡ç¨‹é‡Œï¼Œ<strong>AI èƒ½æ˜¾è‘—å¢åŠ äº§é‡å¹¶æ‰©å±•ä¸ªäººå¯æ‰¿æ‹…ä»»åŠ¡çš„èŒƒå›´ï¼Œä½†åŒæ—¶å¸¦æ¥æŠ€èƒ½é€€åŒ–é£é™©</strong>ã€‚</p>
</blockquote>
<p>å¦‚ä»Š AI è¶Šæ¥è¶Šå¼ºå·²ç»æ˜¯æ—¶ä»£å¿…ç„¶çš„æµªæ½®ï¼Œè€Œ AI ç°åœ¨çš„ç¼ºé™·ä¹Ÿä¼šå¾ˆå¿«è¢«æ—¶ä»£æ‰€ä¿®å¤ï¼Œå°±åƒ Google çš„ <a href="https://juejin.cn/post/7576181242582892607" target="_blank" title="https://juejin.cn/post/7576181242582892607">Nested  Learning</a>  è®ºæ–‡ä»‹ç»çš„ï¼Œç°åœ¨å¤§æ¨¡å‹çš„é—®é¢˜åœ¨äº<strong>å¤§æ¨¡å‹æ— æ³•åœ¨è®­ç»ƒåç»§ç»­å­¦ä¹ </strong> ï¼Œå› ä¸ºç›®å‰çš„å¤§æ¨¡å‹åªæœ‰<strong>æå¿«ä¸”çŸ­æš‚çš„è®°å¿†</strong>ï¼ˆIn-Context Learningï¼‰å’Œ<strong>å†»ç»“çš„é•¿æœŸè®°å¿†ï¼ˆPre-trained Weightsï¼‰</strong> ï¼Œè¿™ä¸ªé—®é¢˜åœ¨äºï¼š</p>
<blockquote>
<p>å½“å‰æ¨¡å‹ç¼ºä¹å°†â€œå³æ—¶å¯¹è¯â€è½¬åŒ–ä¸ºâ€œé•¿æœŸå‚æ•°â€çš„æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯å®ƒä»¬ç¼ºä¹ä¸­é—´çš„é¢‘è°±ï¼š<strong>é‚£äº›åº”è¯¥ä»çŸ­æœŸé€æ¸å˜ä¸ºé•¿æœŸçš„è®°å¿†</strong>ã€‚</p>
</blockquote>
<p>ä½†æ˜¯è¿™ä¸ªé—®é¢˜å·²ç»è¢«ä»–ä»¬é€šè¿‡å…¨æ–°çš„ HOPE æ¶æ„æ”»å…‹ï¼Œæœªæ¥<strong>èƒ½â€œåƒä¸€å ‘é•¿ä¸€æ™ºâ€çš„ AI ä¹Ÿè®¸ç¦»æˆ‘ä»¬å°±ä¸è¿œäº†</strong>ï¼Œæ‰€ä»¥ç¼–ç¨‹èƒ½åŠ›å¯¹äºç¨‹åºå‘˜æ¥è¯´ï¼Œæœªæ¥æ˜¯ä¸€ä¸ªä»€ä¹ˆåœ°ä½ï¼Ÿè¿™ä¸ªèŒä¸šçš„æ ¸å¿ƒç«äº‰åŠ›åˆåœ¨å“ªé‡Œï¼Ÿ</p>
<p>åœ¨å¼€å‘å®ç°è¿‡ç¨‹ä¸­ AI å¾ˆå¼ºï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦æ¸…æ™°çš„çŸ¥é“ï¼Œ<strong>AI çš„å¼ºå¤§çš„ç¼–ç¨‹èƒ½åŠ›å¹¶ä¸æ˜¯ä½ çš„èƒ½åŠ›ï¼Œè€Œä½œä¸ºç¨‹åºå‘˜ï¼Œä½ ç«äº‰åŠ›ä¹Ÿä¸å†æ˜¯</strong>ï¼š</p>
<ul>
<li>ç†Ÿç»ƒæŒæ¡æŸäº›æ¡†æ¶å’Œ API</li>
<li>ç²¾é€šæŸä¸ªè¯­è¨€å’Œè¯­æ³•</li>
</ul>
<p>åœ¨è¿™äº›æ–¹é¢ï¼Œäººæ˜¯è·‘ä¸è¿‡æœºå™¨çš„ï¼Œå°±åƒ <a href="https://juejin.cn/post/7584729714339250195" target="_blank" title="https://juejin.cn/post/7584729714339250195">ã€Š  OpenAI  ä½¿ç”¨ Codex åœ¨ 28 å¤©å†…æ„å»º Android ç‰ˆ Soraã€‹</a> é‡Œä»‹ç»çš„ï¼š</p>
<blockquote>
<p>åœ¨ä½¿ç”¨ GPT-5.1-Codex ä¹‹åï¼Œåœ¨çŸ­çŸ­ 28 å¤©å†…ï¼Œä¸ä»…å®Œæˆäº†ç¹é‡çš„å¼€å‘ä»»åŠ¡ï¼Œè¿˜åˆ›é€ äº†ä¸Šçº¿ 24 å°æ—¶ç”Ÿæˆ 100 ä¸‡è§†é¢‘ã€99.9% æ— å´©æºƒç‡çš„åº”ç”¨ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹é‡ŒAI å¯ä»¥ 24 å°æ—¶æ— é—´æ–­ç¼–å†™ä»£ç å’Œè‡ªæˆ‘ä¿®å¤ï¼Œ28 å¤©é€šè¿‡ 50 äº¿ token å®Œæˆäº†æ­£å¸¸éœ€è¦å‡ ä¸ªæœˆçš„äº§å“ä¸Šçº¿ã€‚</p>
</blockquote>
<p>æ‰€ä»¥ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œä½ å¦‚æœæƒ³å’Œ AI æ‹¼ç¼–ç èƒ½åŠ›è‚¯å®šæ˜¯æ‹¼ä¸è¿‡çš„ï¼Œå°±åƒ OpenAI æœ€åæ€»ç»“çš„ï¼š<strong>æœªæ¥çš„å¼€å‘å·¥ç¨‹å¸ˆçš„èƒ½åŠ›ä¸å†æ˜¯æ‰“å­—é€Ÿåº¦æˆ–è¯­æ³• API è®°å¿†ï¼Œè€Œæ˜¯å¯¹ç³»ç»Ÿçš„æ·±åˆ»æ´å¯ŸåŠ›ã€‚</strong></p>
<p>ç›´åˆ°çœ‹åˆ° OpenAI  å’Œ Anthropic ç­‰æ¨¡å‹å…¬å¸å¯¹äºç¨‹åºå‘˜æœªæ¥çš„æ€è€ƒæ—¶ï¼Œæˆ‘æ‰æ˜ç™½ä¸èƒ½å†æ²‰è¿·äº AI ç¼–ç¨‹ç»™è‡ªå·±å¸¦æ¥çš„â€œæˆå°±æ„Ÿâ€ï¼Œå› ä¸ºé‚£æ˜¯ AI çš„èƒ½åŠ›è€Œä¸æ˜¯ä½ çš„ï¼Œ<strong>ä½ ç”¨ AI å¯ä»¥åšåˆ°ï¼Œé‚£åˆ«äººç”¨ AI æ˜¯ä¸æ˜¯ä¹Ÿèƒ½åšåˆ°ï¼Œé‚£ä½ çš„èŒä¸šç«äº‰åŠ›åœ¨å“ªé‡Œ</strong>ï¼Ÿ</p>
<blockquote>
<p>æœªæ¥çš„å¼€å‘è€…ï¼Œå¼ºçš„å¯èƒ½ä¸æ˜¯ä»£ç èƒ½åŠ›ï¼Œè€Œæ˜¯é¡¹ç›®ç®¡ç†å’Œ AI é©¯æœèƒ½åŠ›ã€‚</p>
</blockquote>
<p>æ‰€ä»¥æœªæ¥ç¨‹åºå‘˜çš„èŒä¸šèƒ½åŠ›è‚¯å®šä¼šå‘ç°å˜åŒ–ï¼Œæ¯”å¦‚ 2026 å¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œ<strong>çŸ­æœŸçš„ä»·å€¼ä¼šä½“ç°åœ¨å¦‚ä½•é©¯æœ AI</strong> ï¼Œå› ä¸ºç°åœ¨çš„ AI è¿˜æ˜¯ä¸€æ‰¹è„±ç¼°çš„é‡é©¬ï¼Œä»–çš„ä¿è¯å°±åƒæ˜¯â€œäº‹å‰â€çš„æ‰¿è¯ºï¼Œå„ç§è¨€ä¹‹å‡¿å‡¿è®©ä½ ç›¸ä¿¡å®ƒï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6de1b143a7a54428803ad5ddb57b13c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767336971&amp;x-signature=nLA0hRhAuuidTgf9iibjVAymlAs%3D" alt="" loading="lazy"/></p>
<p>è€Œäº‹åæèµ·è£¤å­ï¼Œå‡ºé—®é¢˜äº†å®ƒå¯åŠç‚¹ä¸è®¤ï¼Œæ‰€ä»¥<strong>å¦‚ä½•é©¯æœ AI ï¼ŒåŒæ—¶å¦‚ä½•ç®¡ç†å’Œåšå¥½å¤§æ¨¡å‹å–„åå·¥ç¨‹å¸ˆï¼Œè¿™å°†æ˜¯ç¨‹åºå‘˜çŸ­æœŸå†…çš„èŒä¸šå˜åŒ–</strong>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65b268e5419642d7925522fec6dcf45c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767336971&amp;x-signature=RRDXTLPqV9kxqTt7sL%2BcksYg49g%3D" alt="" loading="lazy"/></p>
<p>è€Œå¦‚ä½•é©¯æœ AI ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œ<strong>é‚£å°±æ˜¯ä¸è¦ä¸Šæ¥å°±è®© AI æ‰§è¡Œéœ€æ±‚ï¼Œè€Œæ˜¯ç»™ AI è§„åˆ’å¥½éœ€æ±‚å’Œè§„åˆ™</strong>ï¼ŒæŠŠ AI çœ‹ä½œæ˜¯ä¸€ä¸ªâ€œ<em>é«˜èƒ½åŠ›ä½†ç¼ºä¹èƒŒæ™¯çš„èµ„æ·±æ–°å‘˜å·¥</em>â€ï¼Œè€Œä½ è´Ÿè´£æ¶æ„è®¾è®¡ã€ç”¨æˆ·ä½“éªŒå’Œæœ€ç»ˆå†³ç­–ï¼Œè€Œ AI è´Ÿè´£å†™ä»£ç ã€å•å…ƒæµ‹è¯•å’Œéœ€æ±‚è½åœ°ã€‚</p>
<p>å› ä¸º AI çš„çŸ­æ¿åœ¨äºç›®å‰å¯¹äºéœ€æ±‚çš„ç†è§£è¿˜ä¸å¤Ÿï¼Œä¹Ÿä¸æ“…é•¿å¾—æ·±å±‚çš„æ¶æ„æƒè¡¡ï¼ˆç»å¸¸ä¸ºäº†å®ç°åŠŸèƒ½è€ŒæŠŠä»£ç å†™ä¹±ï¼‰ï¼Œå› ä¸ºå®ƒçš„ Context æœ‰é™ï¼Œæ‰€ä»¥ç»å¸¸éƒ½ä¼šæ¯”è¾ƒç‰‡é¢å»ç†è§£é¡¹ç›®ï¼Œæ‰€ä»¥ä½œä¸ºç¨‹åºå‘˜ï¼Œä½ éœ€è¦åšçš„æ˜¯ï¼š</p>
<ul>
<li><strong>å…ˆè§„åˆ’åä»£ç </strong>ï¼šå…ˆè®© AI ç†è§£ç³»ç»Ÿå¹¶ç¼–å†™â€œè®¾è®¡æ–‡æ¡£â€ï¼Œçº ååå†æ‰§è¡Œ</li>
<li><strong>èƒŒæ™¯ä¿¡æ¯é©±åŠ¨</strong>ï¼šé€šè¿‡å„ç§æ–‡ä»¶æ–‡æ¡£ä¸º AI æä¾›è§„èŒƒå’Œä¸Šä¸‹æ–‡ï¼Œæ¯”å¦‚å„ç§ rule å’Œæ¨¡å—æè¿°</li>
<li><strong>å¢åŠ æŠ€èƒ½æ”¯æŒ</strong> :  é€šè¿‡å„ç§æŠ€èƒ½æè¿°è®© AI èƒ½åŠ›å¢åŠ ï¼Œæ¯”å¦‚ CC å¯ä»¥é€šè¿‡ skills åŠ è½½å„ç§æ’ä»¶æ¥è¾…åŠ©èƒ½åŠ›æå‡</li>
</ul>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ä½ è¦ç”¨ Flutter åšä¸€ä¸ª Wallet App ï¼Œè€Œä»»åŠ¡æ˜¯å¼€å‘ä¸€ä¸ª <code>TransactionDetail</code> æ¨¡å—ï¼Œéœ€æ±‚æ˜¯ï¼š</p>
<ul>
<li>å¿…é¡»éµå¾ª Clean Architecture (Domain -&gt; Data -&gt; Presentation)</li>
<li>æ•°æ®æ•æ„Ÿï¼Œé‡‘é¢ç²¾åº¦ï¼ˆDecimalï¼‰ã€å“ˆå¸Œè„±æ•æ˜¾ç¤ºæœ‰ä¸¥æ ¼è§„èŒƒ</li>
<li>çŠ¶æ€ç®¡ç†ï¼Œå¼ºåˆ¶ä½¿ç”¨ <code>riverpod_generator</code> + <code>freezed</code></li>
</ul>
<p>é‚£ä¹ˆåœ¨ Claude Code åœºæ™¯ï¼Œé¦–å…ˆæ¥ä¸‹æ¥ä½ éœ€è¦åšçš„ä¼šæ˜¯ï¼š</p>
<h3 data-id="heading-0">ä¸€ã€å¢åŠ  Skill</h3>
<p>è¿™é‡Œçš„æ ¸å¿ƒæ˜¯æ•™ AI <strong>â€œåœ¨è¿™ä¸ªå›¢é˜Ÿé‡Œï¼Œå¦‚ä½•æ ‡å‡†åŒ–åœ°ç”Ÿäº§ä¸€ä¸ª Featureâ€</strong> ï¼Œä¾‹å¦‚åˆ›å»ºä¸€ä¸ª <code>skills/flutter-clean-feature/</code>  ï¼š</p>
<ol>
<li>
<p><strong><code>SKILL.md</code></strong></p>
<pre><code class="hljs language-markdown" lang="markdown">---
name: flutter-clean-feature
description: èƒ½å¤ŸæŒ‰ Clean Architecture æ ‡å‡†ç”Ÿæˆå…¨å¥— Flutter åŠŸèƒ½æ¨¡å—
<span class="hljs-section">usage: "å½“ç”¨æˆ·æƒ³å¼€å‘æ–°é¡µé¢æˆ–åŠŸèƒ½æ¨¡å—æ—¶ä½¿ç”¨"
---</span>

<span class="hljs-section"># æ ‡å‡†å·¥ä½œæµ (SOP)</span>
AI åœ¨æ‰§è¡Œæ­¤ Skill æ—¶ï¼Œå¿…é¡»ä¸¥æ ¼éµå®ˆä»¥ä¸‹é¡ºåºï¼š

<span class="hljs-bullet">1.</span>  <span class="hljs-strong">**Phase 1: é¢†åŸŸå»ºæ¨¡ (Domain First)**</span>
<span class="hljs-bullet">    -</span> è¯»å– <span class="hljs-code">`references/domain_rules.md`</span>ã€‚
<span class="hljs-bullet">    -</span> ä¼˜å…ˆå®šä¹‰ Entity å’Œ Repository æ¥å£ã€‚
<span class="hljs-bullet">    -</span> <span class="hljs-emphasis">*Check*</span>: æ‰€æœ‰çš„é‡‘é¢å­—æ®µå¿…é¡»ä½¿ç”¨ <span class="hljs-code">`Decimal`</span> ç±»å‹ï¼Œç¦æ­¢ä½¿ç”¨ <span class="hljs-code">`double`</span>ã€‚

<span class="hljs-bullet">2.</span>  <span class="hljs-strong">**Phase 2: æ¶æ„è„šæ‰‹æ¶ (Scaffolding)**</span>
<span class="hljs-bullet">    -</span> è°ƒç”¨ <span class="hljs-code">`scripts/scaffold_module.py`</span> è‡ªåŠ¨ç”Ÿæˆæ–‡ä»¶å¤¹å’Œç©ºæ–‡ä»¶ã€‚
<span class="hljs-bullet">    -</span> è·¯å¾„ç»“æ„å¿…é¡»æ˜¯ <span class="hljs-code">`lib/features/&lt;name&gt;/{data,domain,presentation}`</span>ã€‚

<span class="hljs-bullet">3.</span>  <span class="hljs-strong">**Phase 3: å®ç°ä¸ç»‘å®š**</span>
<span class="hljs-bullet">    -</span> å®ç° Repository æ—¶ï¼Œå¿…é¡»ä½¿ç”¨ <span class="hljs-code">`fpdart`</span> å¤„ç† <span class="hljs-code">`Either&lt;Failure, T&gt;`</span>ã€‚
<span class="hljs-bullet">    -</span> UI å±‚å¿…é¡»ä½¿ç”¨ <span class="hljs-code">`AsyncValue`</span> å¤„ç†åŠ è½½çŠ¶æ€ã€‚
</code></pre>
</li>
<li>
<p><strong><code>references/domain_rules.md</code> (çŸ¥è¯†åº“)</strong></p>
<ul>
<li>åŒ…å«å›¢é˜Ÿçº¦å®šçš„ Clean Architecture åˆ†å±‚å›¾</li>
<li>åŒ…å« JSON è§£æçš„é€šç”¨é”™è¯¯å¤„ç†æ¨¡ç‰ˆ</li>
</ul>
</li>
<li>
<p><strong><code>assets/repo_template.dart</code> (æ¨¡ç‰ˆ)</strong></p>
<ul>
<li>é¢„ç½®äº†å¸¦æœ‰ <code>Either</code> è¿”å›å€¼çš„ Repository æ¥å£æ¨¡ç‰ˆ</li>
</ul>
</li>
<li>
<p><strong><code>scripts/scaffold_module.py</code> (è‡ªåŠ¨åŒ–å·¥å…·)</strong></p>
<ul>
<li>ä¸€ä¸ª Python è„šæœ¬ï¼Œæ¥å—æ¨¡å—åå‚æ•°ï¼Œè‡ªåŠ¨åœ¨ <code>lib/features/</code> ä¸‹åˆ›å»ºæ ‡å‡†çš„æ–‡ä»¶å¤¹ç»“æ„å’ŒåŸºç¡€æ–‡ä»¶ï¼ˆè§£å†³ AI æœ‰æ—¶å€™æ‡’å¾—åˆ›å»ºæ–‡ä»¶çš„æ¯›ç—…ï¼‰</li>
</ul>
</li>
</ol>
<h3 data-id="heading-1">äºŒã€å¢åŠ ä¸Šä¸‹æ–‡ä¿¡æ¯</h3>
<p>æ ¸å¿ƒæ€æƒ³å°±æ˜¯å‘Šè¯‰ AI â€œè¿™ä¸ªé¡¹ç›®ç°æœ‰çš„åŸºç¡€è®¾æ–½æ˜¯ä»€ä¹ˆâ€ ï¼Œæ¯”å¦‚é¡¹ç›®ç»´æŠ¤ä¸€ä¸ª <code>CLAUDE.md</code>ï¼Œæä¾›é¡¹ç›®çº§ä¸Šä¸‹æ–‡ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># CryptoWallet Project Context</span>

<span class="hljs-section">## æŠ€æœ¯æ ˆ</span>
<span class="hljs-bullet">-</span> Flutter 3.24
<span class="hljs-bullet">-</span> Riverpod (Annotation mode only)
<span class="hljs-bullet">-</span> Dio (å·²å°è£…åœ¨ <span class="hljs-code">`lib/core/network/dio_client.dart`</span>)
<span class="hljs-bullet">-</span> UI Kit (æ‰€æœ‰æŒ‰é’®å¿…é¡»ä½¿ç”¨ <span class="hljs-code">`lib/core/widgets/app_button.dart`</span>)

<span class="hljs-section">## ç°æœ‰èƒ½åŠ›</span>
<span class="hljs-bullet">-</span> æ ¼å¼åŒ–å·¥å…·ï¼š<span class="hljs-code">`lib/core/utils/formatters.dart`</span> (åŒ…å« hash æˆªæ–­ã€è´§å¸æ ¼å¼åŒ–)
<span class="hljs-bullet">-</span> è·¯ç”±ï¼šGoRouterï¼Œè·¯ç”±å®šä¹‰åœ¨ <span class="hljs-code">`lib/routes.dart`</span>
</code></pre>
<hr/>
<h3 data-id="heading-2">ä¸‰ã€å…ˆè§„åˆ’åä»£ç  (Plan)</h3>
<p>å¯ä»¥åˆ©ç”¨ Claude Code çš„äº¤äº’èƒ½åŠ›ï¼Œå…ˆåŠ è½½ Skill è¿›è¡Œè§„åˆ’ï¼Œå®¡æ ¸æ— è¯¯åå†ç”± Skill ä¸­çš„ Script è‡ªåŠ¨æ‰§è¡Œï¼Œä¾‹å¦‚ï¼š</p>
<p><strong>1. å¯åŠ¨ä¸è§„åˆ’</strong></p>
<blockquote>
<p>"ä½¿ç”¨ skill: flutter-clean-featureï¼Œæˆ‘è¦å¼€å‘ä¸€ä¸ª TransactionDetail æ¨¡å—ï¼Œè¾“å…¥æ˜¯ txHashï¼Œéœ€è¦å±•ç¤ºäº¤æ˜“é‡‘é¢ã€æ—¶é—´ã€å‘é€æ–¹å’Œæ¥æ”¶æ–¹ã€‚"`</p>
</blockquote>
<blockquote>
<p><strong>Claude (åŠ è½½ Skill)</strong>: <em>è¯»å– <code>skills/flutter-clean-feature/SKILL.md</code>...</em> <em>è¯»å– <code>CLAUDE.md</code> è·å–é¡¹ç›®ä¸Šä¸‹æ–‡...</em></p>
<p><strong>Claude (è¾“å‡ºè§„åˆ’)</strong>: æ ¹æ® <strong>Flutter Clean Feature SOP</strong>ï¼Œæˆ‘åˆ¶å®šäº†ä»¥ä¸‹è®¡åˆ’ï¼š</p>
<ol>
<li><strong>Domain</strong>: å®šä¹‰ <code>TransactionEntity</code> (åŒ…å« <code>Decimal amount</code>) å’Œ <code>ITransactionRepo</code>ã€‚</li>
<li><strong>Scaffold</strong>: è¿è¡Œè„šæœ¬åˆ›å»º <code>lib/features/transaction_detail/...</code> ç›®å½•ã€‚</li>
<li><strong>Data</strong>: å®ç° Repoï¼Œè°ƒç”¨ Context ä¸­æåˆ°çš„ <code>DioClient</code>ã€‚</li>
<li><strong>Presentation</strong>: ä½¿ç”¨ <code>riverpod_generator</code> åˆ›å»º <code>transactionDetailProvider</code>ã€‚</li>
</ol>
<p><strong>è¯·ç¡®è®¤</strong>ï¼šæ˜¯å¦éœ€è¦æ”¯æŒâ€œäº¤æ˜“çŠ¶æ€ï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰â€çš„æšä¸¾ï¼Ÿ</p>
</blockquote>
<p><strong>2.  Review ä¼˜åŒ–</strong></p>
<blockquote>
<p><strong>User</strong>: "éœ€è¦ã€‚å¦å¤–ï¼ŒUI ä¸Šé‡‘é¢æ˜¾ç¤ºéœ€è¦è°ƒç”¨ <code>formatters.dart</code> é‡Œçš„æ–¹æ³•ï¼Œä¸è¦è‡ªå·±å†™æ ¼å¼åŒ–é€»è¾‘ã€‚"</p>
</blockquote>
<p><strong>3. æ‰§è¡Œ</strong></p>
<blockquote>
<p><strong>Claude</strong>: æ”¶åˆ°ã€‚å¼€å§‹æ‰§è¡Œã€‚</p>
</blockquote>
<p><em>(Claude å†…éƒ¨è§¦å‘ Skill ä¸­çš„ Script)</em> <code>Run script: python skills/flutter-clean-feature/scripts/scaffold_module.py transaction_detail</code> ï¼š</p>
<blockquote>
<p><strong>Terminal Output</strong>:
âœ… Created lib/features/transaction_detail/domain
âœ… Created lib/features/transaction_detail/data
âœ… Created lib/features/transaction_detail/presentation</p>
</blockquote>
<p><em>(Claude ç»§ç»­ç¼–å†™ä»£ç )</em> Claude æ ¹æ® <code>assets/repo_template.dart</code> å¡«å…… <code>transaction_repository.dart</code>ï¼Œå¹¶æ ¹æ® <code>CLAUDE.md</code> é‡Œçš„è§„åˆ™ï¼Œå¼•å…¥äº† <code>dio_client.dart</code>ã€‚</p>
<p>Â·Â·Â·Â·Â·Â·</p>
<p>æ˜¯ä¸æ˜¯è§‰å¾—å¾ˆç¹çï¼Ÿæ˜¯ä¸æ˜¯è§‰å¾—ä¸€è½®æ•´ä¸‹æ¥æˆ‘éœ€æ±‚éƒ½å†™å®Œäº†ï¼Ÿä½†æ˜¯è¿™å°±æ˜¯ä½¿ç”¨ AI çš„è¶‹åŠ¿ï¼Œåªæœ‰è¿™æ ·æ‰èƒ½æ§åˆ¶å’Œç®¡ç†å¥½ AI çš„ä»£ç ï¼Œä¸è‡³äºè®© AI å†™å‡ºä¸€å¨å±å±±ï¼Œè€Œéšç€ä½ å¯¹å·¥ç¨‹æ–‡æ¡£å’ŒæŠ€èƒ½è¡¥å……çš„å®Œå–„ï¼Œä½ çš„å¼€å‘é€Ÿåº¦å°±ä¼šè¶Šæ¥è¶Šå¿«ï¼ŒAI ä¹Ÿèƒ½åƒæ˜¯ä½ å¤šå¹´çš„è€å“¥ä»¬ä¸€æ ·æ‡‚ä½ éœ€æ±‚ï¼Œæ¯”å¦‚ ï¼š</p>
<blockquote>
<p><code>CLAUDE.md</code> ç¡®ä¿äº† AI ä¸ä¼šå¼•å…¥ <code>http</code> åº“ï¼ˆå› ä¸ºå®ƒçŸ¥é“æœ‰ <code>Dio</code>ï¼‰ï¼Œä¹Ÿä¸ä¼šæ‰‹å†™ä¸‘é™‹çš„æŒ‰é’®ï¼ˆå› ä¸ºå®ƒçŸ¥é“æœ‰ <code>AppButton</code>ï¼‰ï¼Œå®ƒç†è§£äº†é¡¹ç›®çš„ç°çŠ¶ï¼ŒçŸ¥é“æœ‰ä»€ä¹ˆæŠ€èƒ½å¯ç”¨ï¼Œç„¶åé€šè¿‡è§„åˆ’å¾ˆä½ å®Œæˆç¡®è®¤ï¼Œè¿™äº›å†™å‡ºæ¥çš„ä»£ç å’Œé¡¹ç›®æ‰æ˜¯å¯æŒç»­ç»´æŠ¤çš„ã€‚</p>
</blockquote>
<p>æœ€åï¼Œè¿™ä¸€å¹´é‡Œæˆ‘å‡ºäº†ç”¨ AI å†™ä»£ç ä¹‹å¤–ï¼Œä¹Ÿå¼€å§‹å°è¯•ç”¨ AI å»è§£å†³å’Œå°è¯•ä»£ç ä¹‹å¤–çš„äº‹æƒ…ï¼Œå› ä¸º AI æ‰€ä»¥æˆ‘æ•¢äºå°è¯•ä¸€äº›ä»¥å‰ä¸æ•¢æ¥è§¦çš„é¢†åŸŸï¼Œå› ä¸ºè¿‡ç¨‹å­¦ä¹ æˆæœ¬å¤ªé«˜ï¼Œè€Œç°åœ¨ AI æä¾›äº†å¦å¤–ä¸€ç§æ€è·¯ï¼š</p>
<blockquote>
<p><strong>æˆ‘ä¸éœ€è¦çœŸçš„æ‡‚ï¼Œæˆ‘åªéœ€è¦è®© AI å»åšå°±å¥½äº†ï¼Œè€Œæˆ‘åªéœ€è¦æä¾›æƒ³æ³•å’ŒéªŒè¯ç»“æœ</strong>ã€‚</p>
</blockquote>
<p>2025 å³å°†ç»“æŸï¼Œè€Œ 2026 ä¹Ÿä¼šå¦‚æœŸè€Œè‡³ï¼Œè€Œ AI çš„æµªæ½®ä»æœªåœæ­‡ï¼Œ<strong>æ„¿ä½ æˆ‘éƒ½èƒ½åœ¨æ–°çš„æµªæ½®ä¸‹æ‰¾åˆ°è‡ªå·±çš„ä½ç½®</strong>~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€AI ç¼–ç¨‹å®æˆ˜ã€‘ç¬¬ 5 ç¯‡ï¼šPinia çŠ¶æ€ç®¡ç† - ä»æ··ä¹±ä»£ç åˆ°ä¼˜é›…æ¶æ„]]></title>    <link>https://juejin.cn/post/7587738151658881024</link>    <guid>https://juejin.cn/post/7587738151658881024</guid>    <pubDate>2025-12-26T07:12:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587738151658881024" data-draft-id="7587277503947341824" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€AI ç¼–ç¨‹å®æˆ˜ã€‘ç¬¬ 5 ç¯‡ï¼šPinia çŠ¶æ€ç®¡ç† - ä»æ··ä¹±ä»£ç åˆ°ä¼˜é›…æ¶æ„"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-26T07:12:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="HashTang"/> <meta itemprop="url" content="https://juejin.cn/user/1117561754756488"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€AI ç¼–ç¨‹å®æˆ˜ã€‘ç¬¬ 5 ç¯‡ï¼šPinia çŠ¶æ€ç®¡ç† - ä»æ··ä¹±ä»£ç åˆ°ä¼˜é›…æ¶æ„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1117561754756488/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    HashTang
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T07:12:19.000Z" title="Fri Dec 26 2025 07:12:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="vs2015">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#1e1e1e;color:#dcdcdc}.hljs-keyword,.hljs-link,.hljs-literal,.hljs-name,.hljs-symbol{color:#569cd6}.hljs-link{text-decoration:underline}.hljs-built_in,.hljs-type{color:#4ec9b0}.hljs-class,.hljs-number{color:#b8d7a3}.hljs-meta-string,.hljs-string{color:#d69d85}.hljs-regexp,.hljs-template-tag{color:#9a5334}.hljs-formula,.hljs-function,.hljs-params,.hljs-subst,.hljs-title{color:#dcdcdc}.hljs-comment,.hljs-quote{color:#57a64a;font-style:italic}.hljs-doctag{color:#608b4e}.hljs-meta,.hljs-meta-keyword,.hljs-tag{color:#9b9b9b}.hljs-template-variable,.hljs-variable{color:#bd63c5}.hljs-attr,.hljs-attribute,.hljs-builtin-name{color:#9cdcfe}.hljs-section{color:gold}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-bullet,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-selector-tag{color:#d7ba7d}.hljs-addition{background-color:#144212}.hljs-addition,.hljs-deletion{display:inline-block;width:100%}.hljs-deletion{background-color:#600}</style><blockquote>
<p>çŠ¶æ€ç®¡ç†æ˜¯å‰ç«¯åº”ç”¨çš„"å¿ƒè„"ï¼Œä½†å¾ˆå¤šäººä¸€æåˆ° Pinia/Vuex å°±å¤´ç–¼ï¼šStore è¯¥æ€ä¹ˆè®¾è®¡ï¼ŸæŒä¹…åŒ–æ€ä¹ˆåšï¼Ÿç™»å½•æ€æ€ä¹ˆç»´æŠ¤ï¼Ÿè¿™ç¯‡æ–‡ç« ä»¥<strong>å¿ƒåŠ¨æ‹èŠ</strong>å°ç¨‹åºä¸ºä¾‹ï¼Œé€šè¿‡å’Œ AI çš„<strong>çœŸå®å¯¹è¯</strong>ï¼Œå±•ç¤ºå¦‚ä½•ä»é›¶æ­å»ºä¸€ä¸ªå®Œæ•´çš„ç”¨æˆ·çŠ¶æ€ç®¡ç†ç³»ç»Ÿã€‚</p>
<p><strong>ç³»åˆ—ä¸“æ </strong>ï¼š<a href="https://juejin.cn/column/7579556047783624756" target="_blank" title="https://juejin.cn/column/7579556047783624756">ã€AI ç¼–ç¨‹å®æˆ˜ï¼šTRAE SOLO å…¨æ ˆå¼€å‘æŒ‡å—ã€‘</a></p>
<p><strong>æœ¬ç¯‡ä¸»é¢˜</strong>ï¼šPinia çŠ¶æ€ç®¡ç† - ä»æ··ä¹±ä»£ç åˆ°ä¼˜é›…æ¶æ„</p>
<p><strong>å®æˆ˜é¡¹ç›®</strong>ï¼šå¿ƒåŠ¨æ‹èŠ - AI æ‹çˆ±èŠå¤©åŠ©æ‰‹</p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€å¼€ç¯‡ï¼šçŠ¶æ€ç®¡ç†çš„ç—›ç‚¹</h2>
<h3 data-id="heading-1">1.1 æ²¡æœ‰çŠ¶æ€ç®¡ç†æ—¶çš„æ··ä¹±</h3>
<p>åœ¨æ²¡æœ‰é›†ä¸­å¼çŠ¶æ€ç®¡ç†ä¹‹å‰ï¼Œæˆ‘çš„ä»£ç æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// é¡µé¢ Aï¼šç™»å½•åä¿å­˜ç”¨æˆ·ä¿¡æ¯</span>
uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'userInfo'</span>, userData);
uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'token'</span>, token);
uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'isLoggedIn'</span>, <span class="hljs-literal">true</span>);

<span class="hljs-comment">// é¡µé¢ Bï¼šè¯»å–ç”¨æˆ·ä¿¡æ¯</span>
<span class="hljs-keyword">const</span> userInfo = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'userInfo'</span>);
<span class="hljs-keyword">const</span> isLoggedIn = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'isLoggedIn'</span>);

<span class="hljs-comment">// é¡µé¢ Cï¼šæ›´æ–°ç”¨æˆ·ä¿¡æ¯</span>
<span class="hljs-keyword">const</span> userInfo = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'userInfo'</span>);
userInfo.<span class="hljs-property">avatar</span> = newAvatar;
uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'userInfo'</span>, userInfo);

<span class="hljs-comment">// é¡µé¢ Dï¼šåˆ¤æ–­ç™»å½•çŠ¶æ€</span>
<span class="hljs-keyword">if</span> (uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'token'</span>)) {
  <span class="hljs-comment">// å·²ç™»å½•é€»è¾‘</span>
}
</code></pre>
<p><strong>é—®é¢˜æ˜¾è€Œæ˜“è§</strong>ï¼š</p>
<ul>
<li>æ¯ä¸ªé¡µé¢éƒ½åœ¨é‡å¤è¯»å†™ Storage</li>
<li>çŠ¶æ€åˆ†æ•£åœ¨å„å¤„ï¼Œéš¾ä»¥è¿½è¸ª</li>
<li>ä¿®æ”¹ä¸€å¤„ï¼Œå®¹æ˜“æ¼æ”¹å…¶ä»–åœ°æ–¹</li>
<li>æ²¡æœ‰å“åº”å¼ï¼Œé¡µé¢ä¸ä¼šè‡ªåŠ¨æ›´æ–°</li>
</ul>
<h3 data-id="heading-2">1.2 æˆ‘éœ€è¦ä»€ä¹ˆ</h3>
<p>æˆ‘éœ€è¦ä¸€ä¸ª<strong>é›†ä¸­å¼çš„ç”¨æˆ·çŠ¶æ€ç®¡ç†</strong>ï¼š</p>
<ul>
<li>ç»Ÿä¸€ç®¡ç†ç”¨æˆ·ä¿¡æ¯ã€ç™»å½•æ€</li>
<li>æ”¯æŒæŒä¹…åŒ–ï¼ˆåˆ·æ–°ä¸ä¸¢å¤±ï¼‰</li>
<li>å“åº”å¼æ›´æ–°ï¼ˆæ•°æ®å˜åŒ–ï¼Œé¡µé¢è‡ªåŠ¨åˆ·æ–°ï¼‰</li>
<li>å¤šç§ç™»å½•æ–¹å¼æ”¯æŒï¼ˆå¾®ä¿¡ã€æ‰‹æœºå·ï¼‰</li>
</ul>
<p>ä½†æˆ‘å¯¹ Pinia ä¸ç†Ÿæ‚‰ï¼Œäºæ˜¯å¼€å§‹å’Œ AI å¯¹è¯ã€‚</p>
<h2 data-id="heading-3">äºŒã€åŸºç¡€ Store æ­å»º</h2>
<h3 data-id="heading-4">2.1 æˆ‘çš„ç¬¬ä¸€å¥è¯</h3>
<pre><code class="hljs language-txt" lang="txt">æˆ‘ï¼šé¡¹ç›®éœ€è¦ç”¨æˆ·çŠ¶æ€ç®¡ç†ï¼Œç”¨ Pinia å®ç°ã€‚
    è¦ç®¡ç†ç”¨æˆ·ä¿¡æ¯ã€ç™»å½•çŠ¶æ€ï¼Œæ”¯æŒç™»å½•ã€é€€å‡ºåŠŸèƒ½ã€‚
</code></pre>
<h3 data-id="heading-5">2.2 AI å…ˆé—®é—®é¢˜</h3>
<pre><code class="hljs language-txt" lang="txt">AIï¼šå¥½çš„ï¼Œæˆ‘æ¥å¸®ä½ æ­å»ºç”¨æˆ·çŠ¶æ€ç®¡ç†ã€‚å…ˆç¡®è®¤å‡ ä¸ªé—®é¢˜ï¼š

ğŸ¤” é—®é¢˜ï¼š
1. é¡¹ç›®æŠ€æœ¯æ ˆæ˜¯ä»€ä¹ˆï¼Ÿï¼ˆVue3/UniApp/å…¶ä»–ï¼‰
2. ç”¨æˆ·ä¿¡æ¯éœ€è¦å“ªäº›å­—æ®µï¼Ÿ
3. ç™»å½•æ–¹å¼æœ‰å“ªäº›ï¼Ÿï¼ˆè´¦å·å¯†ç /å¾®ä¿¡/æ‰‹æœºå·ï¼‰
4. éœ€è¦æŒä¹…åŒ–å—ï¼Ÿï¼ˆåˆ·æ–°é¡µé¢åä¿æŒç™»å½•ï¼‰

è¯·å‘Šè¯‰æˆ‘è¿™äº›ä¿¡æ¯ï¼Œæˆ‘æ¥è®¾è®¡ Store ç»“æ„ã€‚
</code></pre>
<h3 data-id="heading-6">2.3 æˆ‘è¡¥å……ä¿¡æ¯</h3>
<pre><code class="hljs language-txt" lang="txt">æˆ‘ï¼šUniApp + Vue3 é¡¹ç›®ï¼Œè·‘å¾®ä¿¡å°ç¨‹åºã€‚
    ç”¨æˆ·ä¿¡æ¯ï¼šuser_idã€usernameã€avatarã€genderã€phone_numberã€vip_status è¿™äº›ã€‚
    ç™»å½•æ–¹å¼ï¼šä¸»è¦æ˜¯å¾®ä¿¡ç™»å½•ï¼Œåé¢å¯èƒ½åŠ æ‰‹æœºå·ç™»å½•ã€‚
    éœ€è¦æŒä¹…åŒ–ï¼Œç”¨æˆ·ç™»å½•ååˆ·æ–°ä¸èƒ½é€€å‡ºã€‚
</code></pre>
<h3 data-id="heading-7">2.4 AI ç»™å‡ºæ‰§è¡Œè®¡åˆ’</h3>
<pre><code class="hljs language-txt" lang="txt">AIï¼šæ˜ç™½äº†ï¼Œæˆ‘æ¥è®¾è®¡ Store ç»“æ„ã€‚

ğŸ“‹ æ‰§è¡Œè®¡åˆ’ï¼š

1. åˆ›å»º src/store/index.ts - Pinia å…¥å£é…ç½®
2. åˆ›å»º src/store/user.ts - ç”¨æˆ·çŠ¶æ€ç®¡ç†
3. åœ¨ main.ts ä¸­æ³¨å†Œ Pinia

ğŸ“ Store ç»“æ„è®¾è®¡ï¼š

src/store/
â”œâ”€â”€ index.ts      # Pinia å®ä¾‹ + æ’ä»¶é…ç½®
â””â”€â”€ user.ts       # ç”¨æˆ·çŠ¶æ€ç®¡ç†
    â”œâ”€â”€ state     # userInfo, isLoggedIn
    â”œâ”€â”€ getters   # genderDisplay, isVip
    â””â”€â”€ actions   # login, logout, updateUserInfo

ğŸ¤” å…³äºè¯­æ³•é£æ ¼ï¼Œæœ‰ä¸¤ç§é€‰æ‹©ï¼š
1. Options API é£æ ¼ï¼šstate/getters/actions åˆ†å¼€å†™
2. Setup é£æ ¼ï¼šç”¨ ref/computed/functionï¼Œæ›´çµæ´»

ä½ æƒ³ç”¨å“ªç§é£æ ¼ï¼Ÿ
</code></pre>
<pre><code class="hljs language-txt" lang="txt">æˆ‘ï¼šç”¨ Setup é£æ ¼å§ï¼Œçœ‹èµ·æ¥æ›´ç®€æ´
</code></pre>
<h3 data-id="heading-8">2.5 AI ç”ŸæˆåŸºç¡€ä»£ç </h3>
<pre><code class="hljs language-txt" lang="txt">AIï¼šå¥½çš„ï¼Œå¼€å§‹ç”Ÿæˆä»£ç ...

âœ… åˆ›å»º src/store/index.ts
âœ… åˆ›å»º src/store/user.ts
âœ… ä¿®æ”¹ main.ts

åŸºç¡€ç»“æ„å·²å®Œæˆï¼Œè¿™æ˜¯æ ¸å¿ƒä»£ç ï¼š
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/store/index.ts</span>
<span class="hljs-keyword">import</span> { createPinia } <span class="hljs-keyword">from</span> <span class="hljs-string">'pinia'</span>;

<span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createPinia</span>();

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> store;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./user'</span>;
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/store/user.ts</span>
<span class="hljs-keyword">import</span> { defineStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'pinia'</span>;
<span class="hljs-keyword">import</span> { ref, computed } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;

<span class="hljs-comment">// ç”¨æˆ·ä¿¡æ¯ç±»å‹</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserInfo</span> {
  <span class="hljs-attr">user_id</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">username</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">avatar</span>: <span class="hljs-built_in">string</span>;
  gender?: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// 1: ç”·, 2: å¥³</span>
  phone_number?: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">vip_status</span>: <span class="hljs-string">'none'</span> | <span class="hljs-string">'vip'</span> | <span class="hljs-string">'expired'</span>;
}

<span class="hljs-comment">// åˆå§‹çŠ¶æ€</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">initialUserInfo</span>: <span class="hljs-title class_">UserInfo</span> = {
  <span class="hljs-attr">user_id</span>: <span class="hljs-string">''</span>,
  <span class="hljs-attr">username</span>: <span class="hljs-string">''</span>,
  <span class="hljs-attr">avatar</span>: <span class="hljs-string">'/static/images/default-avatar.png'</span>,
  <span class="hljs-attr">gender</span>: <span class="hljs-literal">undefined</span>,
  <span class="hljs-attr">phone_number</span>: <span class="hljs-string">''</span>,
  <span class="hljs-attr">vip_status</span>: <span class="hljs-string">'none'</span>,
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useUserStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">'user'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// ===== çŠ¶æ€ =====</span>
  <span class="hljs-keyword">const</span> userInfo = ref&lt;<span class="hljs-title class_">UserInfo</span>&gt;({ ...initialUserInfo });
  <span class="hljs-keyword">const</span> isLoggedIn = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>);

  <span class="hljs-comment">// ===== è®¡ç®—å±æ€§ =====</span>
  <span class="hljs-keyword">const</span> isVip = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> userInfo.<span class="hljs-property">value</span>.<span class="hljs-property">vip_status</span> === <span class="hljs-string">'vip'</span>);

  <span class="hljs-comment">// ===== æ–¹æ³• =====</span>

  <span class="hljs-comment">/** è®¾ç½®ç”¨æˆ·ä¿¡æ¯ */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">setUserInfo</span> = (<span class="hljs-params">info: UserInfo</span>) =&gt; {
    userInfo.<span class="hljs-property">value</span> = { ...initialUserInfo, ...info };
    isLoggedIn.<span class="hljs-property">value</span> = !!info.<span class="hljs-property">user_id</span>;
  };

  <span class="hljs-comment">/** æ¸…é™¤ç”¨æˆ·ä¿¡æ¯ */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">clearUserInfo</span> = (<span class="hljs-params"/>) =&gt; {
    userInfo.<span class="hljs-property">value</span> = { ...initialUserInfo };
    isLoggedIn.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>;
  };

  <span class="hljs-comment">/** é€€å‡ºç™»å½• */</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">logout</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">clearUserInfo</span>();
  };

  <span class="hljs-keyword">return</span> {
    userInfo,
    isLoggedIn,
    isVip,
    setUserInfo,
    clearUserInfo,
    logout,
  };
});
</code></pre>
<pre><code class="hljs language-txt" lang="txt">AIï¼šåŸºç¡€ Store å·²åˆ›å»ºã€‚ä½¿ç”¨æ–¹å¼ï¼š

// åœ¨ç»„ä»¶ä¸­
import { useUserStore } from '@/store'

const userStore = useUserStore()

// è¯»å–çŠ¶æ€
console.log(userStore.userInfo.username)
console.log(userStore.isLoggedIn)

// è°ƒç”¨æ–¹æ³•
userStore.setUserInfo({ user_id: '123', username: 'å°æ˜', ... })
userStore.logout()

ç°åœ¨å¯ä»¥æµ‹è¯•ä¸€ä¸‹åŸºç¡€åŠŸèƒ½ã€‚
</code></pre>
<h2 data-id="heading-9">ä¸‰ã€æŒä¹…åŒ–é…ç½®</h2>
<h3 data-id="heading-10">3.1 æˆ‘å‘ç°åˆ·æ–°åçŠ¶æ€ä¸¢å¤±</h3>
<p>æµ‹è¯•åï¼Œæˆ‘å‘ç°ä¸€ä¸ªé—®é¢˜ï¼š</p>
<pre><code class="hljs language-txt" lang="txt">æˆ‘ï¼šç™»å½•ååˆ·æ–°é¡µé¢ï¼ŒçŠ¶æ€ä¸¢å¤±äº†ï¼Œåˆå˜æˆæœªç™»å½•çŠ¶æ€ã€‚
    ä½ ä¸æ˜¯è¯´è¦æ”¯æŒæŒä¹…åŒ–å—ï¼Ÿ
</code></pre>
<h3 data-id="heading-11">3.2 AI è§£é‡Šå¹¶ä¿®å¤</h3>
<pre><code class="hljs language-txt" lang="txt">AIï¼šæŠ±æ­‰ï¼Œæˆ‘å¿˜äº†åŠ æŒä¹…åŒ–é…ç½®ã€‚

ğŸ” åŸå› ï¼š
Pinia é»˜è®¤ä¸æŒä¹…åŒ–ï¼ŒçŠ¶æ€åªå­˜åœ¨å†…å­˜ä¸­ï¼Œåˆ·æ–°å°±æ²¡äº†ã€‚

ğŸ”§ è§£å†³æ–¹æ¡ˆï¼š
ä½¿ç”¨ pinia-plugin-persistedstate æ’ä»¶ï¼Œè‡ªåŠ¨å°†çŠ¶æ€åŒæ­¥åˆ° Storageã€‚

âš ï¸ å°ç¨‹åºæ³¨æ„ï¼š
å°ç¨‹åºæ²¡æœ‰ localStorageï¼Œéœ€è¦ç”¨ uni.getStorageSync/setStorageSyncã€‚

æˆ‘æ¥ä¿®æ”¹é…ç½®...
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/store/index.tsï¼ˆä¿®æ”¹åï¼‰</span>
<span class="hljs-keyword">import</span> { createPinia } <span class="hljs-keyword">from</span> <span class="hljs-string">'pinia'</span>;
<span class="hljs-keyword">import</span> { createPersistedState } <span class="hljs-keyword">from</span> <span class="hljs-string">'pinia-plugin-persistedstate'</span>;

<span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createPinia</span>();

<span class="hljs-comment">// é…ç½®æŒä¹…åŒ–æ’ä»¶ï¼Œé€‚é…å°ç¨‹åºå­˜å‚¨ API</span>
store.<span class="hljs-title function_">use</span>(
  <span class="hljs-title function_">createPersistedState</span>({
    <span class="hljs-attr">storage</span>: {
      <span class="hljs-attr">getItem</span>: uni.<span class="hljs-property">getStorageSync</span>,
      <span class="hljs-attr">setItem</span>: uni.<span class="hljs-property">setStorageSync</span>,
    },
  }),
);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> store;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./user'</span>;
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/store/user.tsï¼ˆæ·»åŠ æŒä¹…åŒ–é…ç½®ï¼‰</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useUserStore = <span class="hljs-title function_">defineStore</span>(
  <span class="hljs-string">'user'</span>,
  <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// ... åŸæœ‰ä»£ç ä¸å˜</span>
  },
  {
    <span class="hljs-attr">persist</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// å¼€å¯æŒä¹…åŒ–</span>
  },
);
</code></pre>
<pre><code class="hljs language-txt" lang="txt">AIï¼š
âœ… å·²å®‰è£… pinia-plugin-persistedstate
âœ… å·²ä¿®æ”¹ src/store/index.ts
âœ… å·²ä¿®æ”¹ src/store/user.ts

ç°åœ¨åˆ·æ–°é¡µé¢ï¼Œç™»å½•çŠ¶æ€ä¼šä¿æŒã€‚

âš ï¸ æ³¨æ„ï¼š
persist: true ä¼šæŒä¹…åŒ–æ•´ä¸ª stateã€‚
å¦‚æœæŸäº›çŠ¶æ€ä¸æƒ³æŒä¹…åŒ–ï¼Œå¯ä»¥ç”¨ paths æŒ‡å®šï¼š

{
  persist: {
    paths: ['userInfo', 'isLoggedIn'],  // åªæŒä¹…åŒ–è¿™äº›
  },
}
</code></pre>
<h3 data-id="heading-12">3.3 æˆ‘éªŒè¯ä¿®å¤æˆåŠŸ</h3>
<pre><code class="hljs language-txt" lang="txt">æˆ‘ï¼šå¥½äº†ï¼Œåˆ·æ–°åçŠ¶æ€ä¿æŒäº†ã€‚ä½†æˆ‘è¿˜æœ‰ä¸ªé—®é¢˜ï¼š
    token ç°åœ¨æ˜¯å­˜åœ¨ Store é‡Œè¿˜æ˜¯ Storage é‡Œï¼Ÿ
</code></pre>
<h3 data-id="heading-13">3.4 AI è§£é‡Š Token å­˜å‚¨ç­–ç•¥</h3>
<pre><code class="hljs language-txt" lang="txt">AIï¼šå¥½é—®é¢˜ï¼ç›®å‰ token æ²¡æœ‰æ”¾åœ¨ Store é‡Œã€‚

ğŸ¤” å…³äº Token å­˜å‚¨ï¼Œæœ‰ä¸¤ç§ç­–ç•¥ï¼š

ã€ç­–ç•¥ä¸€ã€‘Token æ”¾ Storeï¼ˆæŒä¹…åŒ–åˆ° Storageï¼‰
ä¼˜ç‚¹ï¼šç»Ÿä¸€ç®¡ç†ï¼Œå“åº”å¼
ç¼ºç‚¹ï¼šStore åˆå§‹åŒ–å‰æ— æ³•ä½¿ç”¨

ã€ç­–ç•¥äºŒã€‘Token å•ç‹¬å­˜ Storageï¼ˆæ¨èï¼‰
ä¼˜ç‚¹ï¼šHTTP æ‹¦æˆªå™¨å¯ä»¥ç›´æ¥è¯»å–ï¼Œä¸ä¾èµ– Store åˆå§‹åŒ–
ç¼ºç‚¹ï¼šéœ€è¦å•ç‹¬ç®¡ç†

ğŸ“Œ æ¨èç­–ç•¥äºŒï¼ŒåŸå› ï¼š
HTTP è¯·æ±‚æ‹¦æˆªå™¨éœ€è¦åœ¨åº”ç”¨å¯åŠ¨æœ€æ—©æœŸå°±èƒ½è·å– tokenï¼Œ
æ­¤æ—¶ Store å¯èƒ½è¿˜æ²¡åˆå§‹åŒ–å®Œæˆã€‚

ä»£ç ç¤ºä¾‹ï¼š
// ç™»å½•æˆåŠŸæ—¶
uni.setStorageSync('token', response.token)
setUserInfo(response.user)

// HTTP æ‹¦æˆªå™¨ä¸­
const token = uni.getStorageSync('token')

ä½ æƒ³ç”¨å“ªç§ç­–ç•¥ï¼Ÿ
</code></pre>
<pre><code class="hljs language-txt" lang="txt">æˆ‘ï¼šç”¨ç­–ç•¥äºŒï¼ŒToken å•ç‹¬å­˜
</code></pre>
<h2 data-id="heading-14">å››ã€å®Œå–„ç™»å½•æµç¨‹</h2>
<h3 data-id="heading-15">4.1 æˆ‘è¦æ·»åŠ å¾®ä¿¡ç™»å½•</h3>
<pre><code class="hljs language-txt" lang="txt">æˆ‘ï¼šç°åœ¨è¦åŠ å¾®ä¿¡ç™»å½•åŠŸèƒ½ã€‚
    æµç¨‹æ˜¯ï¼šè°ƒç”¨ uni.login è·å– code â†’ å‘ç»™åç«¯æ¢ token å’Œç”¨æˆ·ä¿¡æ¯ã€‚
</code></pre>
<h3 data-id="heading-16">4.2 AI è®¾è®¡ç™»å½•æ–¹æ³•</h3>
<pre><code class="hljs language-txt" lang="txt">AIï¼šæ˜ç™½ï¼Œæˆ‘æ¥æ·»åŠ å¾®ä¿¡ç™»å½•æ–¹æ³•ã€‚

ğŸ“‹ æ‰§è¡Œè®¡åˆ’ï¼š
1. æ·»åŠ  wechatLogin æ–¹æ³•åˆ° userStore
2. å¤„ç†ç™»å½•æˆåŠŸï¼šä¿å­˜ token + è®¾ç½®ç”¨æˆ·ä¿¡æ¯
3. å¤„ç†ç™»å½•å¤±è´¥ï¼šæç¤ºé”™è¯¯

ğŸ¤” é—®é¢˜ï¼š
1. ç™»å½• API æ¥å£è·¯å¾„æ˜¯ä»€ä¹ˆï¼Ÿ
2. ç™»å½•æˆåŠŸåè¦ä¸è¦è‡ªåŠ¨è·³è½¬ï¼Ÿ
3. éœ€è¦ loading å’Œ toast æç¤ºå—ï¼Ÿ
</code></pre>
<pre><code class="hljs language-txt" lang="txt">æˆ‘ï¼šAPI æ˜¯ /api/auth/wechat-loginï¼Œå‚æ•°æ˜¯ { code }ã€‚
    ä¸éœ€è¦è‡ªåŠ¨è·³è½¬ï¼Œç”±è°ƒç”¨æ–¹å†³å®šã€‚
    éœ€è¦ toast æç¤ºæˆåŠŸ/å¤±è´¥ã€‚
</code></pre>
<pre><code class="hljs language-txt" lang="txt">AIï¼šå¥½çš„ï¼Œæ·»åŠ ç™»å½•æ–¹æ³•ï¼š
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/store/user.tsï¼ˆæ·»åŠ ç™»å½•æ–¹æ³•ï¼‰</span>
<span class="hljs-keyword">import</span> { toast } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/toast'</span>;
<span class="hljs-keyword">import</span> { loginByWechat } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/api/auth'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useUserStore = <span class="hljs-title function_">defineStore</span>(
  <span class="hljs-string">'user'</span>,
  <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// ... åŸæœ‰çŠ¶æ€å’Œæ–¹æ³•</span>

    <span class="hljs-comment">/**
     * å¾®ä¿¡ç™»å½•
     */</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">wechatLogin</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">code: <span class="hljs-built_in">string</span></span>) =&gt; {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">loginByWechat</span>({ code });

        <span class="hljs-keyword">if</span> (response.<span class="hljs-property">code</span> !== <span class="hljs-number">200</span>) {
          toast.<span class="hljs-title function_">error</span>(response.<span class="hljs-property">msg</span> || <span class="hljs-string">'ç™»å½•å¤±è´¥'</span>);
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(response.<span class="hljs-property">msg</span> || <span class="hljs-string">'ç™»å½•å¤±è´¥'</span>);
        }

        <span class="hljs-keyword">const</span> { token, user } = response.<span class="hljs-property">data</span>;

        <span class="hljs-comment">// ä¿å­˜ tokenï¼ˆå•ç‹¬å­˜ Storageï¼‰</span>
        uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'token'</span>, token);

        <span class="hljs-comment">// è®¾ç½®ç”¨æˆ·ä¿¡æ¯</span>
        <span class="hljs-title function_">setUserInfo</span>(user);

        toast.<span class="hljs-title function_">success</span>(<span class="hljs-string">'ç™»å½•æˆåŠŸ'</span>);
        <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>;
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å¾®ä¿¡ç™»å½•å¤±è´¥:'</span>, error);
        toast.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ç™»å½•å¤±è´¥ï¼Œè¯·ç¨åå†è¯•'</span>);
        <span class="hljs-keyword">throw</span> error;
      }
    };

    <span class="hljs-comment">/**
     * é€€å‡ºç™»å½•ï¼ˆæ›´æ–°ï¼‰
     */</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">logout</span> = (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-title function_">clearUserInfo</span>();
      uni.<span class="hljs-title function_">removeStorageSync</span>(<span class="hljs-string">'token'</span>); <span class="hljs-comment">// æ¸…é™¤ token</span>
      toast.<span class="hljs-title function_">success</span>(<span class="hljs-string">'å·²é€€å‡ºç™»å½•'</span>);
    };

    <span class="hljs-keyword">return</span> {
      <span class="hljs-comment">// ... åŸæœ‰å¯¼å‡º</span>
      wechatLogin,
      logout,
    };
  },
  { <span class="hljs-attr">persist</span>: <span class="hljs-literal">true</span> },
);
</code></pre>
<pre><code class="hljs language-txt" lang="txt">AIï¼šä½¿ç”¨æ–¹å¼ï¼š

// é¡µé¢ä¸­è°ƒç”¨
const handleWechatLogin = async () =&gt; {
  try {
    // 1. è·å–å¾®ä¿¡ code
    const { code } = await new Promise((resolve, reject) =&gt; {
      uni.login({
        provider: 'weixin',
        success: resolve,
        fail: reject,
      })
    })

    // 2. è°ƒç”¨ Store ç™»å½•æ–¹æ³•
    await userStore.wechatLogin(code)

    // 3. ç™»å½•æˆåŠŸåçš„æ“ä½œï¼ˆç”±é¡µé¢å†³å®šï¼‰
    uni.navigateBack()
  } catch (error) {
    console.error('ç™»å½•å¤±è´¥:', error)
  }
}
</code></pre>
<h3 data-id="heading-17">4.3 æˆ‘è¿½é—®ï¼šç™»å½•æ€åˆå§‹åŒ–</h3>
<pre><code class="hljs language-txt" lang="txt">æˆ‘ï¼šè¿˜æœ‰ä¸ªé—®é¢˜ï¼Œåº”ç”¨å¯åŠ¨æ—¶æ€ä¹ˆæ¢å¤ç™»å½•æ€ï¼Ÿ
    æ¯”å¦‚ç”¨æˆ·ä¹‹å‰ç™»å½•è¿‡ï¼Œæ‰“å¼€åº”ç”¨åº”è¯¥è‡ªåŠ¨æ˜¯ç™»å½•çŠ¶æ€ã€‚
</code></pre>
<h3 data-id="heading-18">4.4 AI æ·»åŠ åˆå§‹åŒ–é€»è¾‘</h3>
<pre><code class="hljs language-txt" lang="txt">AIï¼šéœ€è¦æ·»åŠ ä¸€ä¸ªåˆå§‹åŒ–æ–¹æ³•ï¼Œåœ¨åº”ç”¨å¯åŠ¨æ—¶è°ƒç”¨ã€‚

ğŸ” åˆå§‹åŒ–é€»è¾‘ï¼š
1. æ£€æŸ¥æœ¬åœ°æ˜¯å¦æœ‰ token å’Œ userInfo
2. å¦‚æœæœ‰ï¼Œæ¢å¤ç™»å½•çŠ¶æ€
3. å¼‚æ­¥è¯·æ±‚æœ€æ–°ç”¨æˆ·ä¿¡æ¯ï¼ˆtoken å¯èƒ½è¿‡æœŸï¼‰
4. å¦‚æœ token è¿‡æœŸï¼Œæ¸…é™¤ç™»å½•æ€
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/store/user.tsï¼ˆæ·»åŠ åˆå§‹åŒ–æ–¹æ³•ï¼‰</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useUserStore = <span class="hljs-title function_">defineStore</span>(
  <span class="hljs-string">'user'</span>,
  <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// ... åŸæœ‰ä»£ç </span>

    <span class="hljs-comment">/**
     * åˆå§‹åŒ–ç”¨æˆ·çŠ¶æ€ï¼ˆåº”ç”¨å¯åŠ¨æ—¶è°ƒç”¨ï¼‰
     */</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">initializeUserState</span> = (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-keyword">const</span> token = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'token'</span>);
      <span class="hljs-keyword">const</span> savedUserInfo = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'userInfo'</span>);
      <span class="hljs-keyword">const</span> savedLoginStatus = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'isLoggedIn'</span>);

      <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰å®Œæ•´çš„ç™»å½•ä¿¡æ¯</span>
      <span class="hljs-keyword">if</span> (token &amp;&amp; savedUserInfo?.<span class="hljs-property">user_id</span> &amp;&amp; savedLoginStatus) {
        <span class="hljs-comment">// æ¢å¤ç™»å½•æ€</span>
        userInfo.<span class="hljs-property">value</span> = savedUserInfo;
        isLoggedIn.<span class="hljs-property">value</span> = <span class="hljs-literal">true</span>;

        <span class="hljs-comment">// å¼‚æ­¥è·å–æœ€æ–°ç”¨æˆ·ä¿¡æ¯ï¼ˆæ ¡éªŒ token æœ‰æ•ˆæ€§ï¼‰</span>
        <span class="hljs-title function_">loadUserInfo</span>();
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// æ¸…é™¤å¯èƒ½å­˜åœ¨çš„æ— æ•ˆæ•°æ®</span>
        <span class="hljs-title function_">clearUserInfo</span>();
        uni.<span class="hljs-title function_">removeStorageSync</span>(<span class="hljs-string">'token'</span>);
      }
    };

    <span class="hljs-comment">/**
     * ä»æœåŠ¡å™¨åŠ è½½æœ€æ–°ç”¨æˆ·ä¿¡æ¯
     */</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">loadUserInfo</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">apiGetUserInfo</span>();
        <span class="hljs-keyword">if</span> (response.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) {
          <span class="hljs-title function_">setUserInfo</span>(response.<span class="hljs-property">data</span>);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-comment">// token å¯èƒ½å·²è¿‡æœŸ</span>
          <span class="hljs-title function_">clearUserInfo</span>();
          uni.<span class="hljs-title function_">removeStorageSync</span>(<span class="hljs-string">'token'</span>);
        }
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:'</span>, error);
        <span class="hljs-title function_">clearUserInfo</span>();
        uni.<span class="hljs-title function_">removeStorageSync</span>(<span class="hljs-string">'token'</span>);
      }
    };

    <span class="hljs-keyword">return</span> {
      <span class="hljs-comment">// ... åŸæœ‰å¯¼å‡º</span>
      initializeUserState,
      loadUserInfo,
    };
  },
  { <span class="hljs-attr">persist</span>: <span class="hljs-literal">true</span> },
);
</code></pre>
<pre><code class="hljs language-txt" lang="txt">AIï¼šåœ¨ App.vue çš„ onLaunch ä¸­è°ƒç”¨åˆå§‹åŒ–ï¼š

// App.vue
&lt;script setup lang="ts"&gt;
import { useUserStore } from '@/store'

const userStore = useUserStore()

onLaunch(() =&gt; {
  userStore.initializeUserState()
})
&lt;/script&gt;

è¿™æ ·åº”ç”¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ¢å¤ç™»å½•æ€ã€‚
</code></pre>
<h2 data-id="heading-19">äº”ã€è®¡ç®—å±æ€§ä¸ç»Ÿä¸€æ›´æ–°</h2>
<h3 data-id="heading-20">5.1 æˆ‘éœ€è¦æ˜¾ç¤ºæ€§åˆ«æ–‡æœ¬</h3>
<pre><code class="hljs language-txt" lang="txt">æˆ‘ï¼šç”¨æˆ·ä¿¡æ¯é‡Œ gender æ˜¯æ•°å­—ï¼ˆ1=ç”·ï¼Œ2=å¥³ï¼‰ï¼Œ
    ä½†é¡µé¢ä¸Šè¦æ˜¾ç¤º"ç”·ç”Ÿ"ã€"å¥³ç”Ÿ"ï¼Œæ¯æ¬¡éƒ½è¦å†™åˆ¤æ–­å¾ˆéº»çƒ¦ã€‚
</code></pre>
<h3 data-id="heading-21">5.2 AI æ·»åŠ è®¡ç®—å±æ€§</h3>
<pre><code class="hljs language-txt" lang="txt">AIï¼šç”¨è®¡ç®—å±æ€§ï¼ˆcomputedï¼‰è§£å†³ï¼Œåœ¨ Store é‡Œç»Ÿä¸€å¤„ç†ã€‚

è¿™æ ·æ‰€æœ‰é¡µé¢éƒ½å¯ä»¥ç›´æ¥ç”¨ userStore.genderDisplayï¼Œä¸ç”¨é‡å¤åˆ¤æ–­ã€‚
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/store/user.tsï¼ˆæ·»åŠ è®¡ç®—å±æ€§ï¼‰</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">GenderEnum</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'shared-types'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useUserStore = <span class="hljs-title function_">defineStore</span>(
  <span class="hljs-string">'user'</span>,
  <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// ... åŸæœ‰çŠ¶æ€</span>

    <span class="hljs-comment">// ===== è®¡ç®—å±æ€§ =====</span>

    <span class="hljs-comment">/** æ€§åˆ«æ˜¾ç¤ºæ–‡æœ¬ */</span>
    <span class="hljs-keyword">const</span> genderDisplay = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">switch</span> (userInfo.<span class="hljs-property">value</span>.<span class="hljs-property">gender</span>) {
        <span class="hljs-keyword">case</span> <span class="hljs-title class_">GenderEnum</span>.<span class="hljs-property">MALE</span>: <span class="hljs-comment">// 1</span>
          <span class="hljs-keyword">return</span> <span class="hljs-string">'ç”·ç”Ÿ'</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-title class_">GenderEnum</span>.<span class="hljs-property">FEMALE</span>: <span class="hljs-comment">// 2</span>
          <span class="hljs-keyword">return</span> <span class="hljs-string">'å¥³ç”Ÿ'</span>;
        <span class="hljs-attr">default</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-string">'æœªè®¾ç½®'</span>;
      }
    });

    <span class="hljs-comment">/** æ˜¯å¦æ˜¯ VIP */</span>
    <span class="hljs-keyword">const</span> isVip = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> userInfo.<span class="hljs-property">value</span>.<span class="hljs-property">vip_status</span> === <span class="hljs-string">'vip'</span>);

    <span class="hljs-comment">/** æ ¹æ®æ€§åˆ«è·å–é»˜è®¤å¤´åƒ */</span>
    <span class="hljs-keyword">const</span> defaultAvatarByGender = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">switch</span> (userInfo.<span class="hljs-property">value</span>.<span class="hljs-property">gender</span>) {
        <span class="hljs-keyword">case</span> <span class="hljs-title class_">GenderEnum</span>.<span class="hljs-property">MALE</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-string">'/static/images/avatar-male.png'</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-title class_">GenderEnum</span>.<span class="hljs-property">FEMALE</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-string">'/static/images/avatar-female.png'</span>;
        <span class="hljs-attr">default</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-string">'/static/images/avatar-default.png'</span>;
      }
    });

    <span class="hljs-keyword">return</span> {
      <span class="hljs-comment">// çŠ¶æ€</span>
      userInfo,
      isLoggedIn,
      <span class="hljs-comment">// è®¡ç®—å±æ€§</span>
      genderDisplay,
      isVip,
      defaultAvatarByGender,
      <span class="hljs-comment">// æ–¹æ³•</span>
      <span class="hljs-comment">// ...</span>
    };
  },
  { <span class="hljs-attr">persist</span>: <span class="hljs-literal">true</span> },
);
</code></pre>
<pre><code class="hljs language-txt" lang="txt">AIï¼šä½¿ç”¨æ–¹å¼ï¼š

&lt;template&gt;
  &lt;view&gt;
    &lt;text&gt;æ€§åˆ«ï¼š{{ userStore.genderDisplay }}&lt;/text&gt;
    &lt;image :src="userStore.userInfo.avatar || userStore.defaultAvatarByGender" /&gt;
    &lt;text v-if="userStore.isVip"&gt;VIP ç”¨æˆ·&lt;/text&gt;
  &lt;/view&gt;
&lt;/template&gt;

ğŸ“Œ è®¡ç®—å±æ€§çš„å¥½å¤„ï¼š
1. é€»è¾‘é›†ä¸­ï¼Œä¸ç”¨æ¯ä¸ªé¡µé¢é‡å¤å†™
2. å“åº”å¼ï¼ŒuserInfo å˜åŒ–è‡ªåŠ¨æ›´æ–°
3. æœ‰ç¼“å­˜ï¼Œå¤šæ¬¡è®¿é—®åªè®¡ç®—ä¸€æ¬¡
</code></pre>
<h3 data-id="heading-22">5.3 æˆ‘è¿½é—®ï¼šæ›´æ–°ç”¨æˆ·ä¿¡æ¯</h3>
<pre><code class="hljs language-txt" lang="txt">æˆ‘ï¼šç”¨æˆ·åœ¨"æˆ‘çš„"é¡µé¢å¯ä»¥ä¿®æ”¹æ€§åˆ«ã€æ˜µç§°ï¼Œ
    ä¿®æ”¹åè¦åŒæ­¥æ›´æ–° Store å’ŒæœåŠ¡å™¨ï¼Œæ€ä¹ˆåšæ¯”è¾ƒå¥½ï¼Ÿ
</code></pre>
<h3 data-id="heading-23">5.4 AI æ·»åŠ ç»Ÿä¸€æ›´æ–°æ–¹æ³•</h3>
<pre><code class="hljs language-txt" lang="txt">AIï¼šæ·»åŠ ä¸€ä¸ªç»Ÿä¸€çš„æ›´æ–°æ–¹æ³•ï¼Œå°è£… API è°ƒç”¨ + Store æ›´æ–° + æç¤ºã€‚

è¿™æ ·æ‰€æœ‰ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯çš„åœ°æ–¹éƒ½è°ƒç”¨åŒä¸€ä¸ªæ–¹æ³•ï¼Œä¿è¯ä¸€è‡´æ€§ã€‚
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/store/user.tsï¼ˆæ·»åŠ æ›´æ–°æ–¹æ³•ï¼‰</span>
<span class="hljs-keyword">import</span> { updateUserInfo <span class="hljs-keyword">as</span> apiUpdateUserInfo } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/api/auth'</span>;

<span class="hljs-comment">/**
 * ç»Ÿä¸€æ›´æ–°ç”¨æˆ·ä¿¡æ¯
 * <span class="hljs-doctag">@param</span> <span class="hljs-variable">updateData</span> - è¦æ›´æ–°çš„å­—æ®µ
 * <span class="hljs-doctag">@param</span> <span class="hljs-variable">successMessage</span> - æˆåŠŸæç¤ºï¼Œé»˜è®¤"ä¿®æ”¹æˆåŠŸ"
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">updateUserInfo</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">
  updateData: Partial&lt;Pick&lt;UserInfo, <span class="hljs-string">'gender'</span> | <span class="hljs-string">'username'</span> | <span class="hljs-string">'avatar'</span>&gt;&gt;,
  successMessage = <span class="hljs-string">'ä¿®æ”¹æˆåŠŸ'</span>,
</span>) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// 1. è°ƒç”¨ API æ›´æ–°æœåŠ¡å™¨</span>
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">apiUpdateUserInfo</span>(updateData);

    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">code</span> === <span class="hljs-number">200</span> &amp;&amp; response.<span class="hljs-property">data</span>) {
      <span class="hljs-comment">// 2. æ›´æ–° Storeï¼ˆç”¨æœåŠ¡å™¨è¿”å›çš„æœ€æ–°æ•°æ®ï¼‰</span>
      <span class="hljs-title function_">setUserInfo</span>(response.<span class="hljs-property">data</span>);
      <span class="hljs-comment">// 3. æç¤ºæˆåŠŸ</span>
      toast.<span class="hljs-title function_">success</span>(successMessage);
    } <span class="hljs-keyword">else</span> {
      toast.<span class="hljs-title function_">error</span>(response.<span class="hljs-property">msg</span> || <span class="hljs-string">'ä¿®æ”¹å¤±è´¥'</span>);
    }
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ›´æ–°ç”¨æˆ·ä¿¡æ¯å¤±è´¥:'</span>, error);
    toast.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ä¿®æ”¹å¤±è´¥ï¼Œè¯·ç¨åå†è¯•'</span>);
  }
};
</code></pre>
<pre><code class="hljs language-txt" lang="txt">AIï¼šä½¿ç”¨æ–¹å¼ï¼š

// ä¿®æ”¹æ€§åˆ«
await userStore.updateUserInfo({ gender: 1 })

// ä¿®æ”¹æ˜µç§°ï¼Œè‡ªå®šä¹‰æç¤º
await userStore.updateUserInfo(
  { username: 'æ–°æ˜µç§°' },
  'æ˜µç§°ä¿®æ”¹æˆåŠŸ'
)

// åŒæ—¶ä¿®æ”¹å¤šä¸ª
await userStore.updateUserInfo({
  username: 'æ–°æ˜µç§°',
  avatar: 'https://xxx.com/avatar.png',
})
</code></pre>
<h2 data-id="heading-24">å…­ã€è·¨ Store é€šä¿¡</h2>
<h3 data-id="heading-25">6.1 æˆ‘é‡åˆ°è·¨ Store é—®é¢˜</h3>
<pre><code class="hljs language-txt" lang="txt">æˆ‘ï¼šç”¨æˆ·é€€å‡ºç™»å½•æ—¶ï¼Œé™¤äº†æ¸…é™¤ç”¨æˆ·ä¿¡æ¯ï¼Œè¿˜è¦æ¸…é™¤èŠå¤©è®°å½•ã€‚
    èŠå¤©è®°å½•åœ¨å¦ä¸€ä¸ª chatSessionStore é‡Œï¼Œæ€ä¹ˆåœ¨ userStore é‡Œè°ƒç”¨å®ƒï¼Ÿ
</code></pre>
<h3 data-id="heading-26">6.2 AI è§£é‡Šè·¨ Store é€šä¿¡</h3>
<pre><code class="hljs language-txt" lang="txt">AIï¼šPinia æ”¯æŒåœ¨ä¸€ä¸ª Store é‡Œè°ƒç”¨å¦ä¸€ä¸ª Storeã€‚

âš ï¸ æ³¨æ„äº‹é¡¹ï¼š
1. å¿…é¡»åœ¨ actionï¼ˆæ–¹æ³•ï¼‰å†…éƒ¨è°ƒç”¨ï¼Œä¸èƒ½åœ¨ Store å®šä¹‰çš„é¡¶å±‚è°ƒç”¨
2. è¿™æ˜¯å› ä¸ºé¡¶å±‚è°ƒç”¨æ—¶ï¼ŒPinia å¯èƒ½è¿˜æ²¡åˆå§‹åŒ–å®Œæˆ

âŒ é”™è¯¯å†™æ³•ï¼š
const useChatStore = useChatSessionStore()  // é¡¶å±‚è°ƒç”¨ï¼Œå¯èƒ½æŠ¥é”™

âœ… æ­£ç¡®å†™æ³•ï¼š
const logout = () =&gt; {
  const chatStore = useChatSessionStore()  // æ–¹æ³•å†…éƒ¨è°ƒç”¨
  chatStore.reset()
}
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/store/user.tsï¼ˆè·¨ Store è°ƒç”¨ï¼‰</span>
<span class="hljs-keyword">import</span> { useChatSessionStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/store/chatSession'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useUserStore = <span class="hljs-title function_">defineStore</span>(
  <span class="hljs-string">'user'</span>,
  <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// ...</span>

    <span class="hljs-comment">/**
     * æ¸…é™¤ç”¨æˆ·ä¿¡æ¯
     */</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">clearUserInfo</span> = (<span class="hljs-params"/>) =&gt; {
      userInfo.<span class="hljs-property">value</span> = { ...initialUserInfo };
      isLoggedIn.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>;

      <span class="hljs-comment">// æ¸…é™¤æœ¬åœ°å­˜å‚¨</span>
      uni.<span class="hljs-title function_">removeStorageSync</span>(<span class="hljs-string">'userInfo'</span>);
      uni.<span class="hljs-title function_">removeStorageSync</span>(<span class="hljs-string">'token'</span>);
      uni.<span class="hljs-title function_">removeStorageSync</span>(<span class="hljs-string">'isLoggedIn'</span>);

      <span class="hljs-comment">// ã€è·¨ Storeã€‘æ¸…é™¤èŠå¤©è®°å½•</span>
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> chatStore = <span class="hljs-title function_">useChatSessionStore</span>();
        chatStore.<span class="hljs-title function_">reset</span>();
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'æ¸…ç†èŠå¤©è®°å½•å¤±è´¥:'</span>, error);
      }
    };

    <span class="hljs-comment">// ...</span>
  },
  { <span class="hljs-attr">persist</span>: <span class="hljs-literal">true</span> },
);
</code></pre>
<pre><code class="hljs language-txt" lang="txt">AIï¼šç°åœ¨é€€å‡ºç™»å½•æ—¶ä¼šè‡ªåŠ¨æ¸…é™¤èŠå¤©è®°å½•ã€‚

ğŸ“Œ è·¨ Store é€šä¿¡åœºæ™¯ï¼š
1. é€€å‡ºç™»å½• â†’ æ¸…é™¤æ‰€æœ‰ä¸šåŠ¡æ•°æ®
2. ç™»å½•æˆåŠŸ â†’ åˆå§‹åŒ–å…¶ä»– Store
3. VIP çŠ¶æ€å˜åŒ– â†’ é€šçŸ¥å…¶ä»–æ¨¡å—

å¦‚æœè·¨ Store è°ƒç”¨å¾ˆå¤šï¼Œä¹Ÿå¯ä»¥è€ƒè™‘ç”¨äº‹ä»¶æ€»çº¿è§£è€¦ã€‚
</code></pre>
<h2 data-id="heading-27">ä¸ƒã€æ ¸å¿ƒç»éªŒï¼šçŠ¶æ€ç®¡ç†çš„æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-28">7.1 Store è®¾è®¡åŸåˆ™</h3>






























<table><thead><tr><th>åŸåˆ™</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>å•ä¸€èŒè´£</td><td>ä¸€ä¸ª Store ç®¡ç†ä¸€ä¸ªé¢†åŸŸ</td><td>userStoreã€chatStoreã€uiStore</td></tr><tr><td>çŠ¶æ€åªè¯»</td><td>ç”¨ readonly åŒ…è£…ï¼Œé˜²æ­¢å¤–éƒ¨ç›´æ¥ä¿®æ”¹</td><td><code>readonly(userInfo)</code></td></tr><tr><td>æ–¹æ³•å°è£…</td><td>ä¿®æ”¹çŠ¶æ€ç»Ÿä¸€é€šè¿‡æ–¹æ³•ï¼Œä¸è¦ç›´æ¥èµ‹å€¼</td><td><code>setUserInfo()</code> è€Œä¸æ˜¯ <code>userInfo.value = xxx</code></td></tr><tr><td>è®¡ç®—å±æ€§</td><td>æ´¾ç”ŸçŠ¶æ€ç”¨ computedï¼Œé¿å…é‡å¤è®¡ç®—</td><td><code>genderDisplay</code>ã€<code>isVip</code></td></tr></tbody></table>
<h3 data-id="heading-29">7.2 æŒä¹…åŒ–æ³¨æ„äº‹é¡¹</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âœ… æ¨èï¼šæŒä¹…åŒ–é…ç½®é€‚é…å°ç¨‹åº</span>
store.<span class="hljs-title function_">use</span>(
  <span class="hljs-title function_">createPersistedState</span>({
    <span class="hljs-attr">storage</span>: {
      <span class="hljs-attr">getItem</span>: uni.<span class="hljs-property">getStorageSync</span>,
      <span class="hljs-attr">setItem</span>: uni.<span class="hljs-property">setStorageSync</span>,
    },
  }),
)

<span class="hljs-comment">// âš ï¸ æ³¨æ„ï¼šToken å•ç‹¬å­˜å‚¨</span>
uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'token'</span>, token)  <span class="hljs-comment">// ä¸æ”¾ Store</span>

<span class="hljs-comment">// âš ï¸ æ³¨æ„ï¼šæ•æ„Ÿä¿¡æ¯ä¸è¦æŒä¹…åŒ–</span>
{
  <span class="hljs-attr">persist</span>: {
    <span class="hljs-attr">paths</span>: [<span class="hljs-string">'userInfo'</span>, <span class="hljs-string">'isLoggedIn'</span>],  <span class="hljs-comment">// æ˜ç¡®æŒ‡å®š</span>
  },
}
</code></pre>
<h3 data-id="heading-30">7.3 è·¨ Store é€šä¿¡è§„åˆ™</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šåœ¨ Store é¡¶å±‚è°ƒç”¨å…¶ä»– Store</span>
<span class="hljs-keyword">const</span> chatStore = <span class="hljs-title function_">useChatSessionStore</span>(); <span class="hljs-comment">// å¯èƒ½æŠ¥é”™</span>

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šåœ¨æ–¹æ³•å†…éƒ¨è°ƒç”¨</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">logout</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> chatStore = <span class="hljs-title function_">useChatSessionStore</span>();
  chatStore.<span class="hljs-title function_">reset</span>();
};
</code></pre>
<h3 data-id="heading-31">7.4 åˆå§‹åŒ–æ—¶æœº</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// App.vue - åº”ç”¨å¯åŠ¨æ—¶åˆå§‹åŒ–</span>
<span class="hljs-title function_">onLaunch</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> userStore = <span class="hljs-title function_">useUserStore</span>();
  userStore.<span class="hljs-title function_">initializeUserState</span>();
});
</code></pre>
<h2 data-id="heading-32">å…«ã€æ€»ç»“ï¼šå¯¹è¯ä¸­å­¦ä¼šçŠ¶æ€ç®¡ç†</h2>
<h3 data-id="heading-33">8.1 è¿­ä»£è¿‡ç¨‹å›é¡¾</h3>



































<table><thead><tr><th>é˜¶æ®µ</th><th>éœ€æ±‚</th><th>æˆæœ</th></tr></thead><tbody><tr><td>åŸºç¡€æ­å»º</td><td>åˆ›å»º Store</td><td>çŠ¶æ€å®šä¹‰ã€åŸºç¡€æ–¹æ³•</td></tr><tr><td>æ•°æ®æŒä¹…åŒ–</td><td>åˆ·æ–°ä¿æŒç™»å½•</td><td>pinia-plugin-persistedstate é…ç½®</td></tr><tr><td>ç™»å½•æµç¨‹</td><td>å¾®ä¿¡ç™»å½• + åˆå§‹åŒ–</td><td>wechatLoginã€initializeUserState</td></tr><tr><td>ä½“éªŒä¼˜åŒ–</td><td>æ´¾ç”ŸçŠ¶æ€ + ç»Ÿä¸€æ›´æ–°</td><td>genderDisplayã€updateUserInfo</td></tr><tr><td>æ¶æ„å®Œå–„</td><td>è·¨ Store é€šä¿¡</td><td>clearUserInfo ä¸­è°ƒç”¨ chatStore</td></tr></tbody></table>
<h3 data-id="heading-34">8.2 å…³é”®æ”¶è·</h3>
<ol>
<li><strong>ä¸è¦ä¸€æ¬¡æƒ³æ¸…æ¥šæ‰€æœ‰ç»†èŠ‚</strong>ï¼Œå…ˆæ­åŸºç¡€æ¡†æ¶ï¼Œé‡åˆ°é—®é¢˜å†è¡¥å……</li>
<li><strong>è®© AI è§£é‡ŠåŸç†</strong>ï¼Œæ¯”å¦‚"ä¸ºä»€ä¹ˆ Token ä¸æ”¾ Store"ï¼Œç†è§£åæ‰èƒ½ä¸¾ä¸€åä¸‰</li>
<li><strong>æ³¨æ„å¹³å°å·®å¼‚</strong>ï¼Œå°ç¨‹åºæ²¡æœ‰ localStorageï¼Œéœ€è¦ç”¨ uni.getStorageSync</li>
<li><strong>çŠ¶æ€ç®¡ç†ä¸åªæ˜¯å­˜æ•°æ®</strong>ï¼Œè®¡ç®—å±æ€§ã€æ–¹æ³•å°è£…ã€è·¨ Store é€šä¿¡éƒ½æ˜¯å…³é”®</li>
</ol>
<h3 data-id="heading-35">8.3 ä¸‹ä¸€ç¯‡é¢„å‘Š</h3>
<p><strong>ã€Šã€AI ç¼–ç¨‹å®æˆ˜ã€‘ç¬¬ 6 ç¯‡ï¼šå‘Šåˆ«å¤åˆ¶ç²˜è´´ - è®¾è®¡ä¸€ä¸ªä¼˜é›…çš„ HTTP æ¨¡å—ã€‹</strong></p>
<p>ä¸‹ä¸€ç¯‡ç»§ç»­å¯¹è¯å¼åä½œï¼Œæ•™ä½ ï¼š</p>
<ul>
<li>å¦‚ä½•è®¾è®¡ HTTP è¯·æ±‚/å“åº”æ‹¦æˆªå™¨</li>
<li>Token è‡ªåŠ¨æºå¸¦å’Œåˆ·æ–°</li>
<li>ç»Ÿä¸€é”™è¯¯å¤„ç†å’Œ Loading ç®¡ç†</li>
</ul>
<hr/>
<blockquote>
<p>çŠ¶æ€ç®¡ç†çš„æ ¸å¿ƒä¸æ˜¯"ç”¨ä»€ä¹ˆåº“"ï¼Œè€Œæ˜¯<strong>å¦‚ä½•ç»„ç»‡æ•°æ®å’Œé€»è¾‘</strong>ã€‚
é€šè¿‡å’Œ AI å¯¹è¯ï¼Œä½ å¯ä»¥å¿«é€Ÿç†æ¸…æ€è·¯ï¼Œå°‘èµ°å¼¯è·¯ã€‚</p>
<p>è¿™æ˜¯ã€Š<a href="https://juejin.cn/column/7579556047783624756" target="_blank" title="https://juejin.cn/column/7579556047783624756">AI ç¼–ç¨‹å®æˆ˜ï¼šTRAE SOLO å…¨æ ˆå¼€å‘æŒ‡å—</a>ã€‹ä¸“æ çš„ç¬¬äº”ç¯‡æ–‡ç« </p>
<p>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµã€æ”¶è—ã€è½¬å‘ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Cesium å»æ‰é»˜è®¤ç“¦ç‰‡å’Œåœ°å½¢ï¼Œè§£å†³ç½‘ç»œä¸å¥½æ—¶åœ°å›¾åŠ è½½ç¼“æ…¢çš„é—®é¢˜]]></title>    <link>https://juejin.cn/post/7587729264184885311</link>    <guid>https://juejin.cn/post/7587729264184885311</guid>    <pubDate>2025-12-26T03:12:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587729264184885311" data-draft-id="7587712328826355748" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Cesium å»æ‰é»˜è®¤ç“¦ç‰‡å’Œåœ°å½¢ï¼Œè§£å†³ç½‘ç»œä¸å¥½æ—¶åœ°å›¾åŠ è½½ç¼“æ…¢çš„é—®é¢˜"/> <meta itemprop="keywords" content="å‰ç«¯,cesium"/> <meta itemprop="datePublished" content="2025-12-26T03:12:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é—²äº‘ä¸€é¹¤"/> <meta itemprop="url" content="https://juejin.cn/user/729731452122382"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Cesium å»æ‰é»˜è®¤ç“¦ç‰‡å’Œåœ°å½¢ï¼Œè§£å†³ç½‘ç»œä¸å¥½æ—¶åœ°å›¾åŠ è½½ç¼“æ…¢çš„é—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/729731452122382/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é—²äº‘ä¸€é¹¤
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T03:12:34.000Z" title="Fri Dec 26 2025 03:12:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æŠ½ä¸å‰¥èŒ§ï¼Œæ‰¾åˆ°çœŸå‡¶</h2>
<p>ç”²æ–¹åé¦ˆåœ°å›¾ç»å¸¸å‡ºç°å¶å‘æ€§åŠ è½½ç¼“æ…¢çš„é—®é¢˜</p>
<p>æˆ‘å¯»æ€åœ¨æˆ‘æœ¬åœ°å¼€å‘ç¯å¢ƒå¾ˆå¿«å•Šï¼Œä¸Šäº†æµ‹è¯•ç¯å¢ƒä¹Ÿæ²¡æ¯›ç—…ï¼Œå’‹ä¸ªéƒ¨ç½²åˆ°æ­£å¼ç¯å¢ƒå°±åœ°å›¾æ…¢äº†ï¼Ÿ</p>
<p>ç»è¿‡æ’æŸ¥å‘ç°æ¯æ¬¡åœ°å›¾åŠ è½½ç¼“æ…¢æ—¶ <code>endpoint</code> æ¥å£éƒ½åœ¨æŠ¥é”™ï¼ˆæ§åˆ¶å°ä¹Ÿæç¤º net::ERR_CONNECTION_TIMED_OUTï¼‰ï¼Œå¹¶ä¸”ç™¾åº¦ä¹Ÿæ— æ³•è®¿é—®(ç”²æ–¹é¡¹ç›®éƒ¨ç½²åœ¨å†…ç½‘ï¼Œè®¿é—®å…¬ç½‘ä¸å¤ªæµç•…)</p>
<p>ç ´æ¡ˆäº†ï¼ç½ªé­ç¥¸é¦–å°±æ˜¯è¿™ä¸¤ä¸ªæ¥å£è¯·æ±‚åœ¨æŠ¥é”™ï¼ˆå›¾ç‰‡æ— é”™è¯¯æ˜¯å› ä¸ºæˆ‘ç½‘ç»œå¥½ï¼Œè¿™é‡Œå‡è£…å®ƒåœ¨æŠ¥é”™ï¼‰</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/36705965fdc243e2b8a4c28090d4d752~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zey5LqR5LiA6bmk:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767323554&amp;x-signature=nTDEe%2BbD3F3sJPSglhtAs2fPlGg%3D" alt="1.png" loading="lazy"/></p>
<p><code>https://api.cesium.com/v1/assets/1/endpoint?access_token="ä½ çš„token"</code>
<code>https://api.cesium.com/v1/assets/2/endpoint?access_token="ä½ çš„token"</code></p>
<p>è¿™ä¸¤ä¸ªæ¥å£è¯·æ±‚åˆ†åˆ«æ˜¯åŠ è½½ cesium é»˜è®¤çš„åœ°å½¢æ•°æ®å’Œåœ°å›¾ç“¦ç‰‡ï¼ˆå…¶ä¸­ assets/1 æ˜¯åœ°å½¢ï¼Œassets/2 æ˜¯ç“¦ç‰‡ï¼‰ç”±äº cesium æœåŠ¡å™¨åœ¨å›½å¤–ï¼Œæ‰€ä»¥ç½‘ç»œæ³¢åŠ¨ç­‰åŸå› ä¼šå¯¼è‡´è®¿é—®ä¸ç¨³å®šï¼Œä»è€Œå½±å“åœ°å›¾åŠ è½½é€Ÿåº¦</p>
<p>å“ªæ€•ä½ æ˜¯è°ƒç”¨äº†ç¬¬ä¸‰æ–¹çš„åœ°å›¾ç“¦ç‰‡ï¼Œæ¯”å¦‚å¤©åœ°å›¾ç“¦ç‰‡æœåŠ¡ï¼Œå¦‚æœç½‘ç»œä¸ç¨³å®šä¹Ÿä¼šå‡ºç°æ­¤é”™è¯¯ï¼Œå®ƒä¼šé˜»å¡åœ°å›¾çš„æ­£å¸¸åŠ è½½</p>
<p>è¦æƒ³å½»åº•è§£å†³åªæœ‰å°†å®ƒç¦ç”¨</p>
<h2 data-id="heading-1">ç¦ç”¨ cesium é»˜è®¤åœ°å›¾ç“¦ç‰‡</h2>
<p>é»˜è®¤åœ°å›¾ç“¦ç‰‡é»˜è®¤æ˜¯å¯ç”¨çš„ï¼Œéœ€è¦æ‰‹åŠ¨ç¦ç”¨</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-type">const</span> viewer = <span class="hljs-keyword">new</span> Cesium.<span class="hljs-built_in">Viewer</span>(<span class="hljs-string">'CesiumViewer'</span>, {
  ...
  imageryProvider: <span class="hljs-literal">false</span> <span class="hljs-comment">// ä¸åŠ è½½é»˜è®¤åº•å›¾</span>
  ...
})
</code></pre>
<p>æˆ‘ä»¬æ¥æµ‹è¯•ä¸‹æ•ˆæœï¼Œè¿™é‡Œæ”¾å›¾ç‰‡ï¼ˆç®—äº†ä¸æ”¾äº†ï¼ŒèŠ‚çº¦æ–‡ç« ç©ºé—´ï¼‰</p>
<h2 data-id="heading-2">ç¦ç”¨ cesium é»˜è®¤åœ°å½¢æ•°æ®</h2>
<p>åœ°å½¢é»˜è®¤æ˜¯ä¸å¯ç”¨çš„ï¼Œå¦‚æœä½ è‡ªå·±å¯åŠ¨äº†ï¼ŒæŠŠå®ƒæ³¨é‡Šäº†å°±å¯ä»¥äº†</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-type">const</span> viewer = <span class="hljs-keyword">new</span> Cesium.<span class="hljs-built_in">Viewer</span>(<span class="hljs-string">'CesiumViewer'</span>, {
  ...
  terrain: Cesium.Terrain.<span class="hljs-built_in">fromWorldTerrain</span>(), <span class="hljs-comment">// ä½¿ç”¨Cesiumå®˜æ–¹çš„åœ°å½¢æœåŠ¡ å…¨çƒåœ°å½¢æ•°æ®</span>
  ...
})
</code></pre>
<p>æ³¨æ„ï¼šæˆ‘çš„ Cesium ç‰ˆæœ¬ä¸º 1.128ï¼Œä¸åŒç‰ˆæœ¬çš„å¯åŠ¨åœ°å½¢å’ŒåŠ è½½é»˜è®¤åœ°å›¾æ–¹æ³•ä¼šä¸ä¸€æ ·ï¼Œè¯·æ ¹æ®ä½ é¡¹ç›®ä¸­çš„ç‰ˆæœ¬å»å®˜æ–¹æŸ¥æ‰¾å¯¹åº”çš„ api è¿›è¡Œä¿®æ”¹</p>
<p>åˆšæ¥è§¦ä¸‰ç»´åœ°å›¾çš„æœ‹å‹å¯èƒ½ä¼šé—®ï¼Œåœ°å½¢æ˜¯ä¸ªä»€ä¹ˆç©æ„ï¼Ÿå¼€å¯ä¸å…³é—­æœ‰ä½•åŒºåˆ«ï¼Ÿè¿™é‡Œæˆ‘æ”¾ä¸¤å¼ æˆªå›¾æ¥ä½œå¯¹æ¯”ï¼ˆé‡‡ç”¨åŒæ ·çš„è§†è§’ï¼‰</p>
<p>è¿™æ˜¯åŠ è½½åœ°å½¢çš„æ•ˆæœï¼šå¯ä»¥çœ‹è§ï¼Œå±±åŠ¿æœ‰æ˜æ˜¾çš„é«˜ä½èµ·ä¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d3d6d2e44ec4586afa695499e0d26af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zey5LqR5LiA6bmk:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767323554&amp;x-signature=Qabf4eA3KGOhWKJwyw6KQLNc15g%3D" alt="2.png" loading="lazy"/></p>
<p>è¿™æ˜¯å…³é—­åœ°å½¢çš„æ•ˆæœï¼šå¯ä»¥çœ‹è§ï¼Œå±±çš„é«˜åº¦æ²¡äº†ï¼Œåœ°å›¾çš„ 3D ç«‹ä½“å˜æˆäº†äºŒç»´æ‰å¹³</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b3aa42bf15f48a78e9655827cfe776a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zey5LqR5LiA6bmk:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767323554&amp;x-signature=D5hS5QIht2e%2FZmMeR27urHfqiWg%3D" alt="3.png" loading="lazy"/></p>
<h2 data-id="heading-3">ç»“è¯­</h2>
<p>ç»†å¿ƒçš„æœ‹å‹å¯èƒ½ä¼šé—®ï¼Œæ—¢ç„¶åœ°å½¢å¯¹äºä¸‰ç»´åœ°å›¾å¦‚æ­¤é‡è¦ï¼Œé‚£ä¹ˆæŠŠä»–ç¦ç”¨äº†é‚£å²‚ä¸æ˜¯æ•ˆæœå¤§æ‰“æŠ˜æ‰£å—ï¼Ÿæ˜¯çš„ï¼Œé‚£ä¹ˆæœ‰ä»€ä¹ˆåŠæ³•ï¼Œæ—¢èƒ½è§£å†³ç½‘ç»œä¸å¥½æ—¶æŠ¥é”™ï¼Œåˆèƒ½ä½¿åœ°å½¢å­˜åœ¨å‘¢ï¼Ÿ</p>
<p>åŠæ³•æ˜¯æœ‰çš„ï¼Œé‚£å°±æ˜¯è‡ªå·±éƒ¨ç½²åœ°å½¢æœåŠ¡å¹¶è°ƒç”¨ï¼Œä¸ä» cesium å®˜æ–¹è·å–åœ°å½¢æ¥å£å³å¯</p>
<p>å…·ä½“å¦‚ä½•æ“ä½œï¼Ÿå¦‚æœæœ‰äººæ„Ÿå…´è¶£çš„è¯å°±ä¸‹æ¬¡å†å†™å§</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŒäº‹æŸ¥æ—¥å¿—å¤ªæ…¢ï¼Œæˆ‘ç°åœºæ•™ä»–ä¸€å¥— awkã€tailã€grepã€sed ç»„åˆæ‹³]]></title>    <link>https://juejin.cn/post/7587714124856770614</link>    <guid>https://juejin.cn/post/7587714124856770614</guid>    <pubDate>2025-12-26T01:35:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587714124856770614" data-draft-id="7587712328825847844" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŒäº‹æŸ¥æ—¥å¿—å¤ªæ…¢ï¼Œæˆ‘ç°åœºæ•™ä»–ä¸€å¥— awkã€tailã€grepã€sed ç»„åˆæ‹³"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2025-12-26T01:35:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å°å¯Œ"/> <meta itemprop="url" content="https://juejin.cn/user/993614241734270"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŒäº‹æŸ¥æ—¥å¿—å¤ªæ…¢ï¼Œæˆ‘ç°åœºæ•™ä»–ä¸€å¥— awkã€tailã€grepã€sed ç»„åˆæ‹³
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614241734270/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å°å¯Œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T01:35:50.000Z" title="Fri Dec 26 2025 01:35:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ˜¨å¤©ä¸´ä¸‹ç­ï¼Œç”Ÿäº§ç¯å¢ƒå‡ºç°äº†ä¸€ä¸ªå¶å‘çš„æŠ¥é”™é¢„è­¦ã€‚</p>
<p>æ—è¾¹çš„åŒäº‹æ­£~~å‡†å¤‡æ’æŸ¥ï¼Œåªè§ä»–è¾“å…¥å‘½ä»¤ <code>cat application.log</code> ï¼Œä¸€ä¸ª <strong>2GB</strong> å¤§å°æ–‡æœ¬å•Šï¼Œæ—¥å¿—å“—å“—åˆ·å•¥ä¹Ÿçœ‹ä¸æ¸…ï¼Œcrtl + c ä¹Ÿåœä¸ä¸‹æ¥äº†ï¼Œæœ€åè½»è½»çš„å…³é—­è¿æ¥ï¼Œåˆé‡æ–°æ‰“å¼€äº†ä¸€ä¸ªï½</p>
<p>åç«¯å¼€å‘æ¥è¯´ï¼Œç†Ÿç»ƒæŒæ¡ Linux çš„æ—¥å¿—åˆ†æå‘½ä»¤æ˜¯åŸºæœ¬åŠŸï¼Œæ•´ç†å‡ ä¸€äº›åŸºäº <code>tail</code>ã€<code>less</code>ã€<code>grep</code>ã€<code>sed</code>ã€<code>awk</code> çš„æ—¥å¿—æŸ¥è¯¢åœºæ™¯ï¼Œå¸Œæœ›èƒ½å¸®ä½ å¿«é€Ÿå®šä½é—®é¢˜ã€‚</p>
<h3 data-id="heading-0">tail</h3>
<p>å¾ˆå¤šæ–°æ‰‹ä¹ æƒ¯ç”¨ <code>cat</code>ï¼Œä½†å¯¹äºå¤§æ–‡ä»¶ï¼Œ<code>cat</code> ä¼šå¯¼è‡´å±å¹•åˆ·å±ï¼Œè¿˜å®¹æ˜“æŠŠç»ˆç«¯å¡æ­»ã€‚<code>tail</code> æ‰æ˜¯å®æ—¶ç›‘æ§çš„ç¥å™¨ã€‚</p>
<p><strong>çœŸå®åœºæ™¯ Aï¼šæœåŠ¡å‘ç‰ˆå¯åŠ¨ç›‘æ§</strong></p>
<p>æ¯æ¬¡å‘ç‰ˆé‡å¯æœåŠ¡æ—¶ï¼Œæˆ‘ä»¬éƒ½éœ€è¦ç¡®è®¤ Spring Boot æ˜¯å¦å¯åŠ¨æˆåŠŸï¼Œæˆ–è€…æœ‰æ²¡æœ‰åˆå§‹åŒ–æŠ¥é”™ã€‚</p>
<pre><code class="hljs language-java" lang="java"># -f (follow)ï¼šå®æ—¶è¿½åŠ æ˜¾ç¤ºæ–‡ä»¶å°¾éƒ¨å†…å®¹
tail -f logs/application.log
</code></pre>
<p><strong>çœŸå®åœºæ™¯ Bï¼šé…åˆæµ‹è¯•å¤ç° Bug</strong></p>
<p>æµ‹è¯•åŒå­¦è¯´ï¼šæˆ‘ç°åœ¨ç‚¹ä¸€ä¸‹æŒ‰é’®ï¼Œä½ çœ‹çœ‹åå°æœ‰æ²¡æœ‰æŠ¥é”™ã€‚</p>
<p>æ­¤æ—¶ä¸éœ€è¦çœ‹å†å²æ—¥å¿—ï¼Œåªéœ€è¦ç›¯ç€æœ€æ–°çš„è¾“å‡ºã€‚</p>
<pre><code class="hljs language-java" lang="java"># åªçœ‹æœ€å <span class="hljs-number">200</span> è¡Œï¼Œå¹¶ä¿æŒå®æ—¶åˆ·æ–°ï¼Œé¿å…è¢«å†å²æ—¥å¿—å¹²æ‰°
tail -n <span class="hljs-number">200</span> -f logs/application.log
</code></pre>
<h3 data-id="heading-1">less</h3>
<p>å¦‚æœéœ€è¦æŸ¥çœ‹ä¹‹å‰çš„æ—¥å¿—ï¼Œæ¨èä½¿ç”¨ <code>less</code>ã€‚ä¸åŒäº <code>vim</code> ä¼šä¸€æ¬¡æ€§åŠ è½½æ•´ä¸ªæ–‡ä»¶å ç”¨å¤§é‡å†…å­˜ï¼Œ<code>less</code> æ˜¯æŒ‰éœ€åŠ è½½ï¼Œæ‰“å¼€å‡ ä¸ª G çš„æ–‡ä»¶ä¹Ÿæå…¶æµç•…ï¼Œä¸”æ”¯æŒå‘åå›æº¯ã€‚</p>
<p><strong>çœŸå®åœºæ™¯ï¼šè¿½æŸ¥æŸç¬”å®¢è¯‰è®¢å•</strong></p>
<p>è¿è¥åé¦ˆï¼šåˆšæ‰ 10 ç‚¹å·¦å³ï¼Œè®¢å•å· <code>ORD12345678</code> æ”¯ä»˜å¤±è´¥äº†ã€‚</p>
<p>ä½ éœ€è¦ä»æ—¥å¿—æœ«å°¾å¼€å§‹ï¼Œå¾€å‰åå‘æŸ¥æ‰¾è¿™ä¸ªè®¢å•å·ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">less logs/application.log
</code></pre>
<p><strong>è¿›å…¥ç•Œé¢åçš„æ“ä½œæµï¼š</strong></p>
<ol>
<li>
<p><code>Shift + G</code> å…ˆè·³åˆ°æ—¥å¿—æœ€æœ«å°¾ï¼ˆå› ä¸ºæŠ¥é”™é€šå¸¸å‘ç”Ÿåœ¨æœ€è¿‘ï¼‰ã€‚</p>
</li>
<li>
<p><code>?ORD12345678</code> è¾“å…¥é—®å·+è®¢å•å·ï¼Œ<strong>å‘ä¸Šåå‘æœç´¢</strong>ã€‚</p>
</li>
<li>
<p><code>n</code>ï¼šå¦‚æœå½“å‰è¿™è¡Œä¸æ˜¯å…³é”®ä¿¡æ¯ï¼ŒæŒ‰ <code>n</code> ç»§ç»­å‘ä¸Šæ‰¾ä¸Šä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚</p>
</li>
<li>
<p><code>Shift + F</code> å¦‚æœçœ‹ç€çœ‹ç€ï¼Œæ—¥å¿—åˆæ›´æ–°äº†ï¼ŒæŒ‰è¿™ä¸ªç»„åˆé”®å¯ä»¥è®© less è¿›å…¥ç±»ä¼¼ <code>tail -f</code> çš„å®æ—¶æ»šåŠ¨æ¨¡å¼ï¼›æŒ‰ <code>Ctrl + C</code> é€€å›æµè§ˆæ¨¡å¼ã€‚</p>
</li>
</ol>
<h3 data-id="heading-2">grep</h3>
<p><code>grep</code> æ˜¯æœ€å¸¸ç”¨çš„æœç´¢å‘½ä»¤ï¼Œä½†åœ¨å®é™…ä¸šåŠ¡ä¸­ï¼Œç®€å•çš„å…³é”®è¯æœç´¢å¾€å¾€ä¸å¤Ÿç”¨ã€‚</p>
<p><strong>çœŸå®åœºæ™¯ Aï¼šè¿˜åŸæŠ¥é”™ç°åœºï¼ˆå…³é”®ï¼‰</strong></p>
<p>åªçœ‹åˆ° <code>NullPointerException</code> è¿™ä¸€è¡Œå¾€å¾€æ— æ³•å®šä½é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“<strong>æŠ¥é”™å‰</strong>çš„è¯·æ±‚å‚æ•°æ˜¯ä»€ä¹ˆï¼Œ<strong>æŠ¥é”™å</strong>çš„å †æ ˆä¿¡æ¯æ˜¯ä»€ä¹ˆã€‚</p>
<p>æ­¤æ—¶å¿…é¡»é…åˆ <code>-C</code> (Context) å‚æ•°ã€‚</p>
<pre><code class="hljs language-java" lang="java"># æœç´¢å¼‚å¸¸å…³é”®å­—ï¼Œå¹¶æ˜¾ç¤ºè¯¥è¡Œ <span class="hljs-string">"å‰åå„ 20 è¡Œ"</span>
grep -C <span class="hljs-number">20</span> <span class="hljs-string">"NullPointerException"</span> logs/application.log
</code></pre>
<p><strong>çœŸå®åœºæ™¯ Bï¼šå…¨é“¾è·¯è¿½è¸ª TraceId</strong></p>
<p>å¾®æœåŠ¡æˆ‘ä»¬é€šå¸¸ä¼šé€šè¿‡ <code>TraceId</code> ä¸²è”è¯·æ±‚ã€‚æ—¥å¿—æ–‡ä»¶å¯èƒ½å‘ç”Ÿäº†æ»šåŠ¨ï¼ˆRollingï¼‰ï¼Œå˜æˆäº† <code>app.log</code>ã€<code>app.log.1</code>ã€<code>app.log.2</code>ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦åœ¨æ‰€æœ‰æ—¥å¿—æ–‡ä»¶ä¸­æœç´¢åŒä¸€ä¸ª TraceIdã€‚</p>
<pre><code class="hljs language-java" lang="java"># æœç´¢å½“å‰ç›®å½•ä¸‹æ‰€æœ‰ä»¥ app.log å¼€å¤´çš„æ–‡ä»¶
grep <span class="hljs-string">"TraceId-20251219001"</span> logs/app.log*
</code></pre>
<p><strong>çœŸå®åœºæ™¯ Cï¼šç»Ÿè®¡å¼‚å¸¸é¢‘æ¬¡</strong></p>
<p>è€æ¿é—®ï¼šâ€œRedis è¶…æ—¶å¼‚å¸¸ä»Šå¤©åˆ°åº•å‘ç”Ÿäº†å¤šå°‘æ¬¡ï¼Ÿæ˜¯å¶å‘è¿˜æ˜¯å¤§è§„æ¨¡ï¼Ÿâ€</p>
<p>ä¸éœ€è¦æ•°æ•°ï¼Œç›´æ¥ç»Ÿè®¡è¡Œæ•°ã€‚</p>
<pre><code class="hljs language-java" lang="java"># -c (count)ï¼šåªç»Ÿè®¡åŒ¹é…çš„è¡Œæ•°
grep -c <span class="hljs-string">"RedisConnectionException"</span> logs/application.log
</code></pre>
<p><strong>çœŸå®åœºæ™¯ Dï¼šæ’é™¤å¹²æ‰°å™ªéŸ³</strong></p>
<p>æ’æŸ¥é—®é¢˜æ—¶ï¼Œæ—¥å¿—é‡Œå……æ–¥ç€å¤§é‡æ— å…³çš„ <code>INFO</code> å¿ƒè·³æ—¥å¿—æˆ–å¥åº·æ£€æŸ¥æ—¥å¿—ï¼Œä¸¥é‡å¹²æ‰°è§†çº¿ã€‚</p>
<pre><code class="hljs language-java" lang="java"># -v (invert)ï¼šæ˜¾ç¤ºä¸åŒ…å« <span class="hljs-string">"HealthCheck"</span> çš„æ‰€æœ‰è¡Œ
grep -v <span class="hljs-string">"HealthCheck"</span> logs/application.log
</code></pre>
<h3 data-id="heading-3">sed</h3>
<p>æœ‰æ—¶å€™æ—¥å¿—éå¸¸å¤§ï¼Œä¾‹å¦‚æœ‰ 10GBï¼Œgrep æœå‡ºæ¥çš„å†…å®¹ä¾ç„¶è¿‡å¤šã€‚å¦‚æœæˆ‘ä»¬æ˜ç¡®çŸ¥é“ç”Ÿäº§äº‹æ•…å‘ç”Ÿåœ¨ <strong>14:00 åˆ° 14:05</strong> ä¹‹é—´ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ</p>
<p>ä¸‹è½½æ•´ä¸ªæ—¥å¿—ä¸ç°å®ï¼Œ<code>sed</code> å¯ä»¥å¸®æˆ‘ä»¬æŠŠè¿™æ®µæ—¶é—´çš„æ—¥å¿—å•ç‹¬<strong>åˆ‡</strong>å‡ºæ¥ï¼Œä¿å­˜æˆä¸€ä¸ªå°æ–‡ä»¶æ…¢æ…¢åˆ†æã€‚</p>
<p><strong>çœŸå®åœºæ™¯ï¼šå¯¼å‡ºäº‹æ•…æ—¶é—´çª—å£çš„æ—¥å¿—</strong></p>
<pre><code class="hljs language-java" lang="java"># è¯­æ³•ï¼šsed -n <span class="hljs-string">'/å¼€å§‹æ—¶é—´/,/ç»“æŸæ—¶é—´/p'</span> æºæ–‡ä»¶ &gt; ç›®æ ‡æ–‡ä»¶
# æ³¨æ„ï¼šæ—¶é—´æ ¼å¼å¿…é¡»å’Œæ—¥å¿—é‡Œçš„æ ¼å¼å®Œå…¨ä¸€è‡´
sed -n <span class="hljs-string">'/2025-12-19 14:00/,/2025-12-19 14:05/p'</span> logs/application.log &gt; error_segment.log
</code></pre>
<p>è¿™æ ·ä½ å°±å¾—åˆ°äº†ä¸€ä¸ªåªæœ‰å‡  MB çš„ <code>error_segment.log</code>ï¼Œè¿™æ—¶å€™å†ä¸‹è½½åˆ°æœ¬åœ°åˆ†æï¼Œæˆ–è€…å‘ç»™åŒäº‹ï¼Œéƒ½éå¸¸æ–¹ä¾¿ã€‚</p>
<h3 data-id="heading-4">Awk</h3>
<p><code>awk</code> æ“…é•¿å¤„ç†åˆ—æ•°æ®ï¼Œå¯¹äºæ ¼å¼è§„èŒƒçš„æ—¥å¿—ï¼Œå¦‚ Nginx è®¿é—®æ—¥å¿—ã€Apache æ—¥å¿—ï¼Œå®ƒå¯ä»¥ç›´æ¥åœ¨æœåŠ¡å™¨ä¸Šç”Ÿæˆç®€æŠ¥ã€‚</p>
<p><strong>çœŸå®åœºæ™¯ Aï¼šé­åˆ°æ”»å‡»ï¼ŒæŸ¥æ‰¾æ¶æ„ IP</strong></p>
<p>æœåŠ¡çªç„¶æŠ¥è­¦ CPU é£™å‡ï¼Œæ€€ç–‘é­åˆ° CC æ”»å‡»æˆ–çˆ¬è™«æŠ“å–ï¼Œæˆ‘ä»¬éœ€è¦åˆ†æ Nginx æ—¥å¿—ï¼Œæ‰¾å‡ºè®¿é—®é‡æœ€é«˜çš„ IPã€‚</p>
<p>å‡è®¾æ—¥å¿—æ ¼å¼ç¬¬ä¸€åˆ—æ˜¯ IPï¼š</p>
<pre><code class="hljs language-java" lang="java"># <span class="hljs-number">1.</span> awk <span class="hljs-string">'{print $1}'</span>ï¼šæå–ç¬¬ä¸€åˆ—ï¼ˆIPï¼‰
# <span class="hljs-number">2.</span> sortï¼šæ’åºï¼ŒæŠŠç›¸åŒçš„ IP æ’åœ¨ä¸€èµ·
# <span class="hljs-number">3.</span> uniq -cï¼šå»é‡å¹¶ç»Ÿè®¡æ¯ä¸ª IP å‡ºç°çš„æ¬¡æ•°
# <span class="hljs-number">4.</span> sort -nrï¼šæŒ‰æ¬¡æ•°(n)å€’åº(r)æ’åˆ—
# <span class="hljs-number">5.</span> head -n <span class="hljs-number">10</span>ï¼šå–å‰ <span class="hljs-number">10</span> å

awk <span class="hljs-string">'{print $1}'</span> access.log | sort | uniq -c | sort -nr | head -n <span class="hljs-number">10</span>
</code></pre>
<p><strong>çœŸå®åœºæ™¯ Bï¼šæ‰¾å‡ºå“åº”æœ€æ…¢çš„æ¥å£</strong></p>
<p>Nginx æ—¥å¿—ä¸­é€šå¸¸è®°å½•äº†å“åº”æ—¶é—´ï¼Œå‡è®¾åœ¨æœ€åä¸€åˆ—ï¼Œæˆ‘ä»¬æƒ³æŠŠå“åº”æ—¶é—´è¶…è¿‡ 1 ç§’çš„è¯·æ±‚æ‰¾å‡ºæ¥ã€‚</p>
<pre><code class="hljs language-java" lang="java"># $NF ä»£è¡¨æœ€åä¸€åˆ—
# æ‰“å°æ‰€æœ‰å“åº”æ—¶é—´å¤§äº <span class="hljs-number">1</span> ç§’çš„ URLï¼ˆå‡è®¾ URL åœ¨ç¬¬ <span class="hljs-number">7</span> åˆ—ï¼‰
awk <span class="hljs-string">'$NF &gt; 1.000 {print $7, $NF}'</span> access.log
</code></pre>
<h3 data-id="heading-5">æ€»ç»“</h3>
<p>ä¸¾çš„ä¾‹å­éƒ½æ˜¯æˆ‘å¸¸ç”¨çš„ï¼Œå»ºè®®æŠŠè¿™å‡ ä¸ªå‘½ä»¤åˆ»åœ¨è„‘å­é‡Œæˆ–è€…æ”¶è—æœ¬æ–‡ï¼Œä¸‹æ¬¡é‡åˆ°ç”Ÿäº§é—®é¢˜ï¼Œå¯¹ç€åœºæ™¯ç›´æ¥å¤åˆ¶ç²˜è´´å°±okäº†ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzAxNTM4NzAyNg%3D%3D%26mid%3D2247499835%26idx%3D1%26sn%3Da202a41010813cd6e7496ef796723735%26chksm%3D9b8650c6acf1d9d0002189ed373170a770701fedaaaf2939a6eb041c58f2bbc749020aab728f%23rd" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzAxNTM4NzAyNg==&amp;mid=2247499835&amp;idx=1&amp;sn=a202a41010813cd6e7496ef796723735&amp;chksm=9b8650c6acf1d9d0002189ed373170a770701fedaaaf2939a6eb041c58f2bbc749020aab728f#rd" ref="nofollow noopener noreferrer">PSï¼šè¿™é‡Œé€é¢˜ä¸»å’Œå¤§å®¶ä¸€ä»½è®¡ç®—æœºä¹¦ç±èµ„æºåŒ…ï¼ŒåŸºæœ¬ä¸Šæ˜¯æˆ‘è¿™äº›å¹´å­¦ä¹ å’Œå·¥ä½œä¸­çœ‹è¿‡çš„ä¹¦ç±ï¼Œæœ¬èº«æˆ‘æ˜¯åšåç«¯çš„ï¼ŒåƒJavaã€æ•°æ®ç»“æ„ã€æ“ä½œç³»ç»Ÿã€JVMã€SQLè°ƒä¼˜ã€é¢è¯•é¢˜ã€èŒä¸šè§„åˆ’çœ‹çš„ä¼šå¤šèŠ±ä¸€äº›ï¼‰ï¼Œç‚¹å‡»ä¸‹è¾¹é“¾æ¥ç›´æ¥è·å–ï¼š</a>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab62123b84f546c193527ec9f7fc63ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5bCP5a-M:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767317750&amp;x-signature=Uea%2By9xvTu2bq%2FpMygUVojK542U%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[async/await åˆ°åº•è¦ä¸è¦åŠ  try-catchï¼Ÿå¼‚æ­¥é”™è¯¯å¤„ç†æœ€ä½³å®è·µ]]></title>    <link>https://juejin.cn/post/7587675443442024488</link>    <guid>https://juejin.cn/post/7587675443442024488</guid>    <pubDate>2025-12-26T01:28:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587675443442024488" data-draft-id="7579111646874828851" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="async/await åˆ°åº•è¦ä¸è¦åŠ  try-catchï¼Ÿå¼‚æ­¥é”™è¯¯å¤„ç†æœ€ä½³å®è·µ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-26T01:28:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åˆ˜å¤§å"/> <meta itemprop="url" content="https://juejin.cn/user/3507878440995946"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            async/await åˆ°åº•è¦ä¸è¦åŠ  try-catchï¼Ÿå¼‚æ­¥é”™è¯¯å¤„ç†æœ€ä½³å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3507878440995946/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åˆ˜å¤§å
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T01:28:30.000Z" title="Fri Dec 26 2025 01:28:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸Šå‘¨äº”ä¸‹åˆï¼Œæˆ‘æ­£å‡†å¤‡ä¸‹ç­ï¼Œäº§å“ç»ç†çªç„¶è·‘è¿‡æ¥ï¼šâ€œç”¨æˆ·åé¦ˆè¯´æäº¤è®¢å•åæ²¡ååº”ï¼Œæ˜¯ä¸æ˜¯åˆå‡º bug äº†ï¼Ÿâ€</p>
<p>æˆ‘ä¸€æŸ¥æ—¥å¿—ï¼Œå‘ç°æ¥å£æŠ¥äº† 500 é”™è¯¯ï¼Œä½†é¡µé¢ä¸Šä»€ä¹ˆæç¤ºéƒ½æ²¡æœ‰ã€‚</p>
<p>åŸæ¥æ˜¯æˆ‘å†™å¼‚æ­¥è¯·æ±‚æ—¶å¿˜äº†åŠ <code>try-catch</code>ã€‚ç”¨æˆ·ç‚¹å®Œæäº¤å°±ä»¥ä¸ºæˆåŠŸäº†ï¼Œç»“æœè®¢å•æ ¹æœ¬æ²¡ç”Ÿæˆã€‚</p>
<p>é‚£ä¸€åˆ»çš„æˆ‘æ‰æ„è¯†åˆ°ï¼šasync/await é”™è¯¯å¤„ç†çœŸçš„ä¸èƒ½çœã€‚</p>
<hr/>
<h2 data-id="heading-0">å…ˆæ¥ç†è§£ async/await æ˜¯ä»€ä¹ˆ</h2>
<p>ç®€å•æ¥è¯´ï¼Œ<code>async/await</code>æ˜¯å¤„ç†å¼‚æ­¥æ“ä½œçš„è¯­æ³•ç³–ï¼Œè®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç ä¸€æ ·ç›´è§‚ã€‚</p>
<p><strong>æ²¡æœ‰ async/await çš„æ—¶ä»£ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å›è°ƒåœ°ç‹±</span>
<span class="hljs-title function_">fetchData</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">result1</span>) {
  <span class="hljs-title function_">fetchMoreData</span>(result1, <span class="hljs-keyword">function</span>(<span class="hljs-params">result2</span>) {
    <span class="hljs-title function_">fetchEvenMoreData</span>(result2, <span class="hljs-keyword">function</span>(<span class="hljs-params">result3</span>) {
      <span class="hljs-comment">// æ›´å¤šåµŒå¥—...</span>
    })
  })
})
</code></pre>
<p><strong>æœ‰äº† async/await ä¹‹åï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŒæ­¥èˆ¬çš„å†™æ³•</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getData</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> result1 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchData</span>()
  <span class="hljs-keyword">const</span> result2 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchMoreData</span>(result1)
  <span class="hljs-keyword">const</span> result3 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchEvenMoreData</span>(result2)
  <span class="hljs-keyword">return</span> result3
}
</code></pre>
<p>æ˜¯ä¸æ˜¯æ¸…çˆ½å¤šäº†ï¼Ÿä½†æ˜¯ï¼Œå¦‚æœ await åé¢çš„ Promise å‘ç”Ÿé”™è¯¯ï¼ˆæ¯”å¦‚ç½‘ç»œè¯·æ±‚å¤±è´¥ï¼‰ï¼Œè¿™ä¸ªé”™è¯¯ä¼šç›´æ¥æŠ›å‡ºï¼Œå¦‚æœä¸æ•è·ï¼Œå°±ä¼šå¯¼è‡´ç¨‹åºå´©æºƒã€‚</p>
<hr/>
<h2 data-id="heading-1">ä»€ä¹ˆæ—¶å€™å¿…é¡»åŠ  try-catchï¼Ÿ</h2>
<h3 data-id="heading-2">1. éœ€è¦ç»™ç”¨æˆ·æ˜ç¡®åé¦ˆçš„åœºæ™¯</h3>
<p>ä¸¾ä¸ªä¾‹å­ï¼šç”¨æˆ·ç‚¹å‡»æäº¤æŒ‰é’®ï¼Œå¦‚æœå¤±è´¥äº†å´æ²¡æœ‰ä»»ä½•æç¤ºï¼Œç”¨æˆ·ä¼šä»¥ä¸ºæäº¤æˆåŠŸï¼Œè¿™ä½“éªŒå¤šå·®å•Šï¼</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"submitOrder"</span> <span class="hljs-attr">:disabled</span>=<span class="hljs-string">"loading"</span>&gt;</span>
      {{ loading ? 'æäº¤ä¸­...' : 'æäº¤è®¢å•' }}
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">successMessage</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">errorMessage</span>: <span class="hljs-string">''</span>
    }
  },
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">submitOrder</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">// å¼€å§‹åŠ è½½</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">true</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMessage</span> = <span class="hljs-string">''</span>
      
      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// å°è¯•æäº¤è®¢å•</span>
        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">$http</span>.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/orders'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">orderData</span>)
        
        <span class="hljs-comment">// æäº¤æˆåŠŸ</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">successMessage</span> = <span class="hljs-string">'è®¢å•æäº¤æˆåŠŸï¼'</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">$router</span>.<span class="hljs-title function_">push</span>(<span class="hljs-string">'/success'</span>) <span class="hljs-comment">// è·³è½¬åˆ°æˆåŠŸé¡µé¢</span>
        
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-comment">// æ ¹æ®ä¸åŒé”™è¯¯ç±»å‹ç»™ç”¨æˆ·ä¸åŒçš„æç¤º</span>
        <span class="hljs-keyword">if</span> (error.<span class="hljs-property">response</span>?.<span class="hljs-property">status</span> === <span class="hljs-number">401</span>) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMessage</span> = <span class="hljs-string">'è¯·å…ˆç™»å½•åå†æäº¤è®¢å•'</span>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (error.<span class="hljs-property">response</span>?.<span class="hljs-property">status</span> === <span class="hljs-number">400</span>) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMessage</span> = <span class="hljs-string">'è®¢å•æ•°æ®æœ‰è¯¯ï¼Œè¯·æ£€æŸ¥åé‡è¯•'</span>
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (error.<span class="hljs-property">response</span>?.<span class="hljs-property">status</span> === <span class="hljs-number">500</span>) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMessage</span> = <span class="hljs-string">'æœåŠ¡å™¨ç¹å¿™ï¼Œè¯·ç¨åé‡è¯•'</span>
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMessage</span> = <span class="hljs-string">'ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥'</span>
        }
      } <span class="hljs-keyword">finally</span> {
        <span class="hljs-comment">// æ— è®ºæˆåŠŸå¤±è´¥ï¼Œéƒ½è¦å–æ¶ˆåŠ è½½çŠ¶æ€</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">false</span>
      }
    }
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>ç”¨æˆ·æ“ä½œå¿…é¡»æœ‰åé¦ˆ</li>
<li>ä¸åŒé”™è¯¯ç»™å‡ºä¸åŒæç¤º</li>
<li>ä½¿ç”¨ finally ç¡®ä¿åŠ è½½çŠ¶æ€æ­£ç¡®é‡ç½®</li>
</ul>
<h3 data-id="heading-3">2. éœ€è¦ç»§ç»­æ‰§è¡Œåç»­é€»è¾‘çš„åœºæ™¯</h3>
<p>æœ‰æ—¶å€™ï¼Œå³ä½¿æŸä¸ªè¯·æ±‚å¤±è´¥äº†ï¼Œæˆ‘ä»¬ä»ç„¶å¸Œæœ›ç»§ç»­æ‰§è¡Œå…¶ä»–æ“ä½œã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">initializePage</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ï¼ˆé‡è¦ï¼‰</span>
  <span class="hljs-keyword">try</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">userInfo</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">$http</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/user/info'</span>)
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥ï¼Œä½†é¡µé¢ä»å¯æ­£å¸¸ä½¿ç”¨'</span>)
    <span class="hljs-comment">// å³ä½¿å¤±è´¥ï¼Œä¹Ÿç»§ç»­æ‰§è¡Œä¸‹é¢çš„é€»è¾‘</span>
  }
  
  <span class="hljs-comment">// è·å–ç”¨æˆ·è®¾ç½®ï¼ˆé‡è¦ï¼‰</span>
  <span class="hljs-keyword">try</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">userSettings</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">$http</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/user/settings'</span>)
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å–ç”¨æˆ·è®¾ç½®å¤±è´¥'</span>)
    <span class="hljs-comment">// ä½¿ç”¨é»˜è®¤è®¾ç½®ç»§ç»­</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">userSettings</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">defaultSettings</span>
  }
  
  <span class="hljs-comment">// è·å–æ¨èå†…å®¹ï¼ˆéå…³é”®ï¼Œå¤±è´¥ä¹Ÿæ²¡å…³ç³»ï¼‰</span>
  <span class="hljs-keyword">try</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">recommendations</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">$http</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/recommendations'</span>)
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// é™é»˜å¤±è´¥ï¼Œä¸å½±å“ä¸»è¦åŠŸèƒ½</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'æ¨èå†…å®¹åŠ è½½å¤±è´¥'</span>)
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-4">ä»€ä¹ˆæ—¶å€™å¯ä»¥ä¸åŠ  try-catchï¼Ÿ</h2>
<h3 data-id="heading-5">1. æœ‰å…¨å±€é”™è¯¯æ‹¦æˆªå™¨çš„æƒ…å†µ</h3>
<p>å¦‚æœä½ çš„é¡¹ç›®é…ç½®äº†å…¨å±€çš„ HTTP æ‹¦æˆªå™¨ï¼Œé‚£ä¹ˆå¾ˆå¤šé”™è¯¯å·²ç»è¢«ç»Ÿä¸€å¤„ç†äº†ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// http.js - å…¨å±€æ‹¦æˆªå™¨</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">$http</span>.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(
  <span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response,
  <span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
    <span class="hljs-comment">// å…¨å±€ç»Ÿä¸€å¤„ç†é”™è¯¯</span>
    <span class="hljs-keyword">if</span> (error.<span class="hljs-property">response</span>?.<span class="hljs-property">status</span> === <span class="hljs-number">401</span>) {
      router.<span class="hljs-title function_">push</span>(<span class="hljs-string">'/login'</span>)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (error.<span class="hljs-property">response</span>?.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">500</span>) {
      <span class="hljs-title class_">Message</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æœåŠ¡å™¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•'</span>)
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error)
  }
)

<span class="hljs-comment">// ç»„ä»¶ä¸­ - ä¸éœ€è¦é‡å¤å¤„ç†</span>
<span class="hljs-keyword">async</span> <span class="hljs-title function_">fetchData</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// é”™è¯¯å·²ç»è¢«å…¨å±€æ‹¦æˆªå™¨å¤„ç†äº†</span>
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">$http</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/data'</span>)
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span> = data
}
</code></pre>
<h3 data-id="heading-6">2. é”™è¯¯éœ€è¦å‘ä¸ŠæŠ›å‡ºçš„æƒ…å†µ</h3>
<p>åœ¨ç¼–å†™å¯å¤ç”¨çš„å‡½æ•°æ—¶ï¼Œé€šå¸¸ä¸åº”è¯¥åœ¨å‡½æ•°å†…éƒ¨å¤„ç†é”™è¯¯ï¼Œè€Œæ˜¯è®©è°ƒç”¨æ–¹æ¥å†³å®šå¦‚ä½•å¤„ç†ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// api/user.js - ç”¨æˆ·ç›¸å…³çš„ API å‡½æ•°</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> userApi = {
  <span class="hljs-comment">// ä¸å¤„ç†é”™è¯¯ï¼Œè®©è°ƒç”¨æ–¹å†³å®šå¦‚ä½•å¤„ç†</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">getUserProfile</span>(<span class="hljs-params">userId</span>) {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">$http</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">`/api/users/<span class="hljs-subst">${userId}</span>`</span>)
    <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>
  },
  
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">updateUserProfile</span>(<span class="hljs-params">userId, profile</span>) {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">$http</span>.<span class="hljs-title function_">put</span>(<span class="hljs-string">`/api/users/<span class="hljs-subst">${userId}</span>`</span>, profile)
    <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>
  }
}

<span class="hljs-comment">// ç»„ä»¶ä¸­ - è°ƒç”¨æ–¹å¤„ç†é”™è¯¯</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">loadUserProfile</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">profile</span> = <span class="hljs-keyword">await</span> userApi.<span class="hljs-title function_">getUserProfile</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">userId</span>)
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">$message</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åŠ è½½ç”¨æˆ·ä¿¡æ¯å¤±è´¥'</span>)
      }
    }
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-7">è®©ä»£ç æ›´ç®€æ´</h2>
<p>æ¯æ¬¡éƒ½å†™ try-catch ç¡®å®æœ‰ç‚¹å•°å—¦ã€‚æˆ‘ä»¬å¯ä»¥å°è£…ä¸€ä¸ªå·¥å…·å‡½æ•°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// utils/safeAsync.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">safeAsync</span>(<span class="hljs-params">promise</span>) {
  <span class="hljs-keyword">return</span> promise
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> [<span class="hljs-literal">null</span>, data])      <span class="hljs-comment">// æˆåŠŸï¼š[null, æ•°æ®]</span>
    .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> [err, <span class="hljs-literal">null</span>])       <span class="hljs-comment">// å¤±è´¥ï¼š[é”™è¯¯, null]</span>
}
</code></pre>
<p>ä½¿ç”¨æ–¹å¼ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { safeAsync } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/safeAsync'</span>

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadUser</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [err, data] = <span class="hljs-keyword">await</span> <span class="hljs-title function_">safeAsync</span>(<span class="hljs-title function_">getUserInfo</span>())
  
  <span class="hljs-keyword">if</span> (err) {
    <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åŠ è½½å¤±è´¥'</span>)
    <span class="hljs-keyword">return</span>
  }
  
  user.<span class="hljs-property">value</span> = data
}
</code></pre>
<p>è¿™çœ‹èµ·æ¥æ›´èˆ’æœäº†å§ï¼Ÿè¿™ç§å†™æ³•æ¥è‡ª Go è¯­è¨€çš„é”™è¯¯ä¼˜å…ˆé£æ ¼ï¼Œåœ¨ JS ç¤¾åŒºä¹Ÿå¾ˆæµè¡Œã€‚</p>
<hr/>
<h2 data-id="heading-8">å¤šä¸ªè¯·æ±‚æ€ä¹ˆåŠï¼Ÿå…ˆåˆ«ç”¨ Promise.all</h2>
<p>å¾ˆå¤šæœ‹å‹å–œæ¬¢è¿™æ ·å†™ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å±é™©ï¼ä¸€ä¸ªå¤±è´¥ï¼Œå…¨éƒ¨å¤±è´¥</span>
<span class="hljs-keyword">const</span> [user, orders] = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([
  <span class="hljs-title function_">getUser</span>(),
  <span class="hljs-title function_">getOrders</span>()
])
</code></pre>
<p>ä½†å¦‚æœ <code>getOrders()</code> æŒ‚äº†ï¼Œ<code>getUser()</code> çš„ç»“æœä¹Ÿä¼šä¸¢æ‰ï¼</p>
<p>æ­£ç¡®åšæ³•ï¼šç”¨ <code>Promise.allSettled</code></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> results = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">allSettled</span>([<span class="hljs-title function_">getUser</span>(), <span class="hljs-title function_">getOrders</span>()])

<span class="hljs-keyword">const</span> user = results[<span class="hljs-number">0</span>].<span class="hljs-property">status</span> === <span class="hljs-string">'fulfilled'</span> ? results[<span class="hljs-number">0</span>].<span class="hljs-property">value</span> : <span class="hljs-literal">null</span>
<span class="hljs-keyword">const</span> orders = results[<span class="hljs-number">1</span>].<span class="hljs-property">status</span> === <span class="hljs-string">'fulfilled'</span> ? results[<span class="hljs-number">1</span>].<span class="hljs-property">value</span> : []

<span class="hljs-comment">// å³ä½¿è®¢å•åŠ è½½å¤±è´¥ï¼Œç”¨æˆ·ä¿¡æ¯è¿˜èƒ½æ˜¾ç¤ºï¼</span>
</code></pre>
<p>æˆ–è€…ç”¨æˆ‘ä»¬ä¸Šé¢çš„ <code>safeAsync</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> [userErr, user] = <span class="hljs-keyword">await</span> <span class="hljs-title function_">safeAsync</span>(<span class="hljs-title function_">getUser</span>())
<span class="hljs-keyword">const</span> [orderErr, orders] = <span class="hljs-keyword">await</span> <span class="hljs-title function_">safeAsync</span>(<span class="hljs-title function_">getOrders</span>())

<span class="hljs-keyword">if</span> (userErr) <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">warning</span>(<span class="hljs-string">'ç”¨æˆ·ä¿¡æ¯åŠ è½½å¤±è´¥'</span>)
<span class="hljs-keyword">if</span> (orderErr) <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">warning</span>(<span class="hljs-string">'è®¢å•åŠ è½½å¤±è´¥'</span>)
</code></pre>
<hr/>
<h2 data-id="heading-9">å…¨å±€é”™è¯¯å…œåº•</h2>
<p>å³ä½¿ä½ å†™äº† try-catchï¼Œä¹Ÿå¯èƒ½æ¼æ‰ã€‚æ‰€ä»¥å¯ä»¥åšä¸€äº›å…œåº•çš„æ“ä½œã€‚</p>
<p>æ¯”å¦‚åœ¨å…¨å±€æ‹¦æˆªå™¨å¤„ç†ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥åœ¨ <code>main.js</code> è¿™æ ·å†™åŠ ä¸ªå®‰å…¨ç½‘ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// main.js</span>
<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)

<span class="hljs-comment">// å…¨å±€ Vue é”™è¯¯å¤„ç†å™¨</span>
app.<span class="hljs-property">config</span>.<span class="hljs-property">errorHandler</span> = <span class="hljs-function">(<span class="hljs-params">err, instance, info</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Vue ç»„ä»¶é”™è¯¯:'</span>, err, info)
  <span class="hljs-title class_">ElNotification</span>.<span class="hljs-title function_">error</span>({
    <span class="hljs-attr">title</span>: <span class="hljs-string">'ç³»ç»Ÿå¼‚å¸¸'</span>,
    <span class="hljs-attr">message</span>: <span class="hljs-string">'é¡µé¢å‡ºç°é”™è¯¯ï¼Œè¯·åˆ·æ–°é‡è¯•'</span>
  })
}

app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>)
</code></pre>
<p>è¿™æ ·ï¼Œå°±ç®—ä½ å¿˜äº†åŠ  try-catchï¼Œä¹Ÿä¸ä¼šè®©ç”¨æˆ·çœ‹åˆ°ç™½å±ï¼</p>
<hr/>
<h2 data-id="heading-10">æ€»ç»“</h2>
<ol>
<li><strong>ç”¨æˆ·éœ€è¦åé¦ˆæ—¶</strong>å¿…é¡»åŠ  try-catch</li>
<li><strong>å…³é”®ä¸šåŠ¡æµç¨‹</strong>å¿…é¡»åŠ  try-catch</li>
<li><strong>æœ‰å…¨å±€å¤„ç†æ—¶</strong>å¯ä»¥ä¸åŠ ï¼Œé¿å…é‡å¤</li>
<li><strong>ç¼–å†™å¯å¤ç”¨å‡½æ•°æ—¶</strong>é€šå¸¸ä¸åŠ ï¼Œè®©è°ƒç”¨æ–¹å¤„ç†</li>
<li><strong>éå…³é”®æ“ä½œ</strong>å¯ä»¥ä¸åŠ ï¼Œæˆ–ç®€å•å¤„ç†</li>
</ol>
<p>é”™è¯¯å¤„ç†ä¸æ˜¯ä¸€åˆ€åˆ‡çš„äº‹æƒ…ï¼Œéœ€è¦æ ¹æ®å…·ä½“ä¸šåŠ¡åœºæ™¯æ¥å†³å®šã€‚å¥½çš„é”™è¯¯å¤„ç†èƒ½è®©ä½ çš„åº”ç”¨æ›´åŠ å¥å£®ï¼Œç”¨æˆ·ä½“éªŒæ›´å¥½ã€‚</p>
<p>æ„Ÿè°¢è§‚çœ‹ï¼Œå¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®ä½ ç†æ¸…æ€è·¯ï¼</p>
<blockquote>
<p>æœ¬æ–‡é¦–å‘äºå…¬ä¼—å·ï¼šç¨‹åºå‘˜åˆ˜å¤§åï¼Œä¸“æ³¨åˆ†äº«å‰åç«¯å¼€å‘çš„å®æˆ˜ç¬”è®°ã€‚å…³æ³¨æˆ‘ï¼Œå°‘èµ°å¼¯è·¯ï¼Œä¸€èµ·è¿›æ­¥ï¼</p>
</blockquote>
<h4 data-id="heading-11">ğŸ“Œå¾€æœŸç²¾å½©</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F184BGM_pdMFLc0ASrferwQ" target="_blank" title="https://mp.weixin.qq.com/s/184BGM_pdMFLc0ASrferwQ" ref="nofollow noopener noreferrer">ã€Šä»£ç é‡Œå…¨æ˜¯ new å¯¹è±¡ï¼ŒçœŸçš„å¾ˆ Low å—ï¼Ÿæˆ‘è®¤çœŸæƒ³äº†ä¸€æ™šã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fp0n2mN5RDDDaIWuHHVRUZQ" target="_blank" title="https://mp.weixin.qq.com/s/p0n2mN5RDDDaIWuHHVRUZQ" ref="nofollow noopener noreferrer">ã€ŠJava å¼€å‘å¿…çœ‹ï¼šä»€ä¹ˆæ—¶å€™ç”¨ forï¼Œä»€ä¹ˆæ—¶å€™ç”¨ Streamï¼Ÿã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FX-MSa0CHwVW_qgPezbpMUA" target="_blank" title="https://mp.weixin.qq.com/s/X-MSa0CHwVW_qgPezbpMUA" ref="nofollow noopener noreferrer">ã€Šè¿™ 5 ä¸ªå†·é—¨ HTML æ ‡ç­¾ï¼Œè®©æˆ‘ç›´æ¥åˆ äº†100 è¡Œ JS ä»£ç ã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FT3ronvigepWew6dRC4uH2g" target="_blank" title="https://mp.weixin.qq.com/s/T3ronvigepWew6dRC4uH2g" ref="nofollow noopener noreferrer">ã€ŠVue ç»„ä»¶é€šä¿¡çš„ 8 ç§æœ€ä½³å®è·µï¼Œä½ çŸ¥é“å‡ ç§ï¼Ÿã€‹</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Kotlinåç¨‹ï¼šJob.cancel() å’Œ Scope.cancel() çš„åŒºåˆ«è¯¦è§£ï¼ï¼ï¼]]></title>    <link>https://juejin.cn/post/7587704265054945318</link>    <guid>https://juejin.cn/post/7587704265054945318</guid>    <pubDate>2025-12-26T03:28:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587704265054945318" data-draft-id="7587779957674573875" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kotlinåç¨‹ï¼šJob.cancel() å’Œ Scope.cancel() çš„åŒºåˆ«è¯¦è§£ï¼ï¼ï¼"/> <meta itemprop="keywords" content="Kotlin,Android,Android Jetpack"/> <meta itemprop="datePublished" content="2025-12-26T03:28:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="QING618"/> <meta itemprop="url" content="https://juejin.cn/user/339115460529117"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kotlinåç¨‹ï¼šJob.cancel() å’Œ Scope.cancel() çš„åŒºåˆ«è¯¦è§£ï¼ï¼ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/339115460529117/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    QING618
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T03:28:58.000Z" title="Fri Dec 26 2025 03:28:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Kotlin åç¨‹ä¸­ï¼Œ<code>Job.cancel()</code>Â å’ŒÂ <code>Scope.cancel()</code>Â éƒ½ç”¨äºå–æ¶ˆåç¨‹ï¼Œä½†å®ƒä»¬çš„ä½œç”¨èŒƒå›´å’Œè¡Œä¸ºæœ‰é‡è¦åŒºåˆ«ï¼š</p>
<h2 data-id="heading-0">1.Â Job.cancel()</h2>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> job = launch {
    <span class="hljs-comment">// åç¨‹ä½“</span>
}
job.cancel()  <span class="hljs-comment">// åªå–æ¶ˆè¿™ä¸ªç‰¹å®šçš„ job</span>
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>åªå–æ¶ˆ<strong>å•ä¸ª Job</strong>Â åŠå…¶å­åç¨‹</li>
<li>ä¸ä¼šå½±å“åŒä¸€ä½œç”¨åŸŸä¸­çš„å…¶ä»– Job</li>
<li>Job è¢«å–æ¶ˆåï¼Œä»ç„¶å¯ä»¥é™„åŠ æ–°çš„å­åç¨‹</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> job1 = scope.launch { <span class="hljs-comment">/* ä»»åŠ¡1 */</span> }
<span class="hljs-keyword">val</span> job2 = scope.launch { <span class="hljs-comment">/* ä»»åŠ¡2 */</span> }

job1.cancel()  <span class="hljs-comment">// åªå–æ¶ˆ job1ï¼Œjob2 ç»§ç»­è¿è¡Œ</span>
</code></pre>
<h2 data-id="heading-1">2.Â Scope.cancel()</h2>
<pre><code class="hljs language-kotlin" lang="kotlin">scope.cancel()  <span class="hljs-comment">// å–æ¶ˆæ•´ä¸ªä½œç”¨åŸŸåŠå…¶æ‰€æœ‰åç¨‹</span>
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>å–æ¶ˆ<strong>æ•´ä¸ªä½œç”¨åŸŸ</strong>ä¸­çš„æ‰€æœ‰åç¨‹</li>
<li>ä½œç”¨åŸŸè¢«å–æ¶ˆåï¼Œ<strong>ä¸èƒ½å†å¯åŠ¨æ–°çš„åç¨‹</strong></li>
<li>æ‰€æœ‰å­ Job éƒ½ä¼šè¢«å–æ¶ˆ</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> scope = CoroutineScope(Dispatchers.IO)

scope.launch { <span class="hljs-comment">/* ä»»åŠ¡1 */</span> }
scope.launch { <span class="hljs-comment">/* ä»»åŠ¡2 */</span> }

scope.cancel()  <span class="hljs-comment">// å–æ¶ˆæ‰€æœ‰ä»»åŠ¡ï¼Œä¸” scope ä¸èƒ½å† launch æ–°åç¨‹</span>
</code></pre>
<h2 data-id="heading-2">3. å…³é”®åŒºåˆ«å¯¹æ¯”</h2>






























<table><thead><tr><th>ç‰¹æ€§</th><th>Job.cancel()</th><th>Scope.cancel()</th></tr></thead><tbody><tr><td>ä½œç”¨èŒƒå›´</td><td>å•ä¸ª Job + å…¶å­åç¨‹</td><td>æ•´ä¸ªä½œç”¨åŸŸ + æ‰€æœ‰åç¨‹</td></tr><tr><td>åç»­ä½¿ç”¨</td><td>å¯ç»§ç»­å¯åŠ¨æ–°åç¨‹</td><td>ä½œç”¨åŸŸå·²å¤±æ•ˆï¼Œä¸èƒ½å¯åŠ¨æ–°åç¨‹</td></tr><tr><td>çŠ¶æ€å½±å“</td><td>Job è¿›å…¥ Cancelling çŠ¶æ€</td><td>Scope å’Œæ‰€æœ‰ Job éƒ½å–æ¶ˆ</td></tr><tr><td>å…¸å‹åœºæ™¯</td><td>å–æ¶ˆç‰¹å®šä»»åŠ¡</td><td>æ¸…ç†æ•´ä¸ªç•Œé¢/ç»„ä»¶èµ„æº</td></tr></tbody></table>
<h2 data-id="heading-3">4. å®é™…ä¾‹å­</h2>
<h3 data-id="heading-4">Job.cancel() ç¤ºä¾‹</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> scope = CoroutineScope(SupervisorJob())

<span class="hljs-keyword">val</span> jobA = scope.launch {
    delay(<span class="hljs-number">1000</span>)
    println(<span class="hljs-string">"Job A å®Œæˆ"</span>)
}

<span class="hljs-keyword">val</span> jobB = scope.launch {
    delay(<span class="hljs-number">2000</span>)
    println(<span class="hljs-string">"Job B å®Œæˆ"</span>)
}

<span class="hljs-comment">// åªå–æ¶ˆ jobAï¼ŒjobB ç»§ç»­è¿è¡Œ</span>
jobA.cancel()

<span class="hljs-comment">// scope ä»ç„¶å¯ç”¨ï¼Œå¯ä»¥å¯åŠ¨æ–°åç¨‹</span>
scope.launch { println(<span class="hljs-string">"æ–°åç¨‹"</span>) }
</code></pre>
<h3 data-id="heading-5">Scope.cancel() ç¤ºä¾‹</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> scope = CoroutineScope(SupervisorJob())

scope.launch { <span class="hljs-comment">/* ä»»åŠ¡1 */</span> }
scope.launch { <span class="hljs-comment">/* ä»»åŠ¡2 */</span> }

<span class="hljs-comment">// å–æ¶ˆæ•´ä¸ªä½œç”¨åŸŸ</span>
scope.cancel()

<span class="hljs-comment">// è¿™é‡Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼šScope is cancelled</span>
scope.launch { println(<span class="hljs-string">"è¿™ä¸ä¼šæ‰§è¡Œ"</span>) }
</code></pre>
<h2 data-id="heading-6">5.Â é‡è¦ç»†èŠ‚</h2>
<h3 data-id="heading-7">Scope.cancel() çš„å†…éƒ¨å®ç°</h3>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// CoroutineScope çš„ cancel() å®é™…ä¸Šè°ƒç”¨äº†å…³è” Job çš„ cancel()</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> CoroutineScope.<span class="hljs-title">cancel</span><span class="hljs-params">(cause: <span class="hljs-type">CancellationException</span>? = <span class="hljs-literal">null</span>)</span></span> {
    <span class="hljs-keyword">val</span> job = coroutineContext[Job]
        ?: error(<span class="hljs-string">"Scope cannot be cancelled because it does not have a job"</span>)
    job.cancel(cause)
}
</code></pre>
<h3 data-id="heading-8">ç»“æ„åŒ–å¹¶å‘çš„ä½“ç°</h3>
<ul>
<li>åœ¨ç»“æ„åŒ–å¹¶å‘ä¸­ï¼Œé€šå¸¸ä½¿ç”¨Â <code>scope.cancel()</code>Â æ¥æ¸…ç†èµ„æº</li>
<li>ViewModel é”€æ¯æ—¶ï¼š<code>viewModelScope.cancel()</code></li>
<li>Activity é”€æ¯æ—¶ï¼š<code>lifecycleScope.cancel()</code></li>
</ul>
<h3 data-id="heading-9">å¼‚å¸¸å¤„ç†å·®å¼‚</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Job.cancel() å¯ä»¥æŒ‡å®šåŸå› </span>
job.cancel(<span class="hljs-string">"ç”¨æˆ·å–æ¶ˆæ“ä½œ"</span>)

<span class="hljs-comment">// Scope.cancel() åŒæ ·å¯ä»¥</span>
scope.cancel(TimeoutCancellationException(<span class="hljs-string">"è¶…æ—¶"</span>))
</code></pre>
<h2 data-id="heading-10">6. æœ€ä½³å®è·µå»ºè®®</h2>
<ol>
<li>
<p><strong>ä½¿ç”¨ Job.cancel()</strong> Â å½“éœ€è¦ï¼š</p>
<ul>
<li>å–æ¶ˆç‰¹å®šçš„åå°ä»»åŠ¡</li>
<li>å®ç°å¯å–æ¶ˆçš„å•ä¸ªæ“ä½œ</li>
<li>ä¸å½±å“å…¶ä»–å¹¶è¡Œä»»åŠ¡</li>
</ul>
</li>
<li>
<p><strong>ä½¿ç”¨ Scope.cancel()</strong> Â å½“éœ€è¦ï¼š</p>
<ul>
<li>ç»„ä»¶ï¼ˆActivity/Fragmentï¼‰é”€æ¯æ—¶æ¸…ç†èµ„æº</li>
<li>å–æ¶ˆæ•´ä¸ªå·¥ä½œæµçš„æ‰€æœ‰ä»»åŠ¡</li>
<li>ç¡®ä¿æ²¡æœ‰åç¨‹æ³„éœ²</li>
</ul>
</li>
<li>
<p><strong>åœ¨ ViewModel ä¸­</strong>ï¼š</p>
</li>
</ol>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> customScope = CoroutineScope(SupervisorJob())
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">startWork</span><span class="hljs-params">()</span></span> {
        customScope.launch { <span class="hljs-comment">/* å·¥ä½œ */</span> }
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCleared</span><span class="hljs-params">()</span></span> {
        customScope.cancel()  <span class="hljs-comment">// æ¸…ç†è‡ªå®šä¹‰ä½œç”¨åŸŸ</span>
        <span class="hljs-keyword">super</span>.onCleared()
    }
    
    <span class="hljs-comment">// viewModelScope ä¼šè‡ªåŠ¨ç®¡ç†ï¼Œæ— éœ€æ‰‹åŠ¨å–æ¶ˆ</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">useViewModelScope</span><span class="hljs-params">()</span></span> {
        viewModelScope.launch { <span class="hljs-comment">/* è‡ªåŠ¨ç»‘å®šç”Ÿå‘½å‘¨æœŸ */</span> }
    }
}
</code></pre>
<p><strong>æ ¸å¿ƒæ€»ç»“</strong>ï¼š<code>Job.cancel()</code>Â æ˜¯<strong>é€‰æ‹©æ€§å–æ¶ˆ</strong>ï¼Œ<code>Scope.cancel()</code>Â æ˜¯<strong>å…¨é¢æ¸…ç†</strong>ã€‚åœ¨ç»“æ„åŒ–å¹¶å‘ä¸­ï¼Œé€šå¸¸è®©ä½œç”¨åŸŸç®¡ç†ç”Ÿå‘½å‘¨æœŸï¼Œä»…åœ¨ç‰¹æ®Šæƒ…å†µä¸‹å•ç‹¬å–æ¶ˆç‰¹å®š Jobã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android ANRé¡¹ç›®å®æˆ˜ï¼šReason: Broadcast { act=android.intent.action.TIME_TICK}]]></title>    <link>https://juejin.cn/post/7587636536898240548</link>    <guid>https://juejin.cn/post/7587636536898240548</guid>    <pubDate>2025-12-26T00:18:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587636536898240548" data-draft-id="7586893663075762186" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android  ANRé¡¹ç›®å®æˆ˜ï¼šReason: Broadcast { act=android.intent.action.TIME_TICK}"/> <meta itemprop="keywords" content="å‰ç«¯,Android,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-26T00:18:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¹ç¨‹åå…«å°‘"/> <meta itemprop="url" content="https://juejin.cn/user/184373685534077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android  ANRé¡¹ç›®å®æˆ˜ï¼šReason: Broadcast { act=android.intent.action.TIME_TICK}
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/184373685534077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¹ç¨‹åå…«å°‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T00:18:51.000Z" title="Fri Dec 26 2025 00:18:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åŒäº‹æœ€è¿‘å‡ºç°ä¸€ä¸ªANR,åˆæ²¡Traceæ–‡ä»¶ï¼Œä¸çŸ¥é“å¦‚ä½•åˆ†æï¼ŒæŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<h2 data-id="heading-0">1.æŠ¥é”™ä¿¡æ¯</h2>
<pre><code class="hljs language-12-23" lang="12-23">12-23 15:32:05.537  1539  1833 W VoiceAccessibilityPerformance: äº‹ä»¶ç±»å‹: 
12-23 15:32:05.537  1539  1833 W VoiceAccessibilityPerformance: å‘ç”Ÿæ—¶é—´: 2025-12-23 15:32:05.537
12-23 15:32:05.537  1539  1833 W VoiceAccessibilityPerformance: è°ƒç”¨è€—æ—¶: 5001ms
12-23 15:32:05.537  1539  1833 W VoiceAccessibilityPerformance: 
12-23 15:32:05.537  1539  1833 W VoiceAccessibilityPerformance: === ç³»ç»Ÿèµ„æºçŠ¶æ€ ===
12-23 15:32:05.537  1539  1833 W VoiceAccessibilityPerformance: è¿›ç¨‹å†…å­˜: 126MB (PSS)
12-23 15:32:05.537  1539  1833 W VoiceAccessibilityPerformance: Javaå †å†…å­˜: 39MB
12-23 15:32:05.537  1539  1833 W VoiceAccessibilityPerformance: Nativeå †å†…å­˜: 0MB
12-23 15:32:05.537  1539  1833 W VoiceAccessibilityPerformance: ç³»ç»Ÿå¯ç”¨å†…å­˜: 15224MB / 16385MB
12-23 15:32:05.537  1539  1833 W VoiceAccessibilityPerformance: CPUä½¿ç”¨ç‡: 0.0%
12-23 15:32:05.537  1539  1833 W VoiceAccessibilityPerformance: BinderçŠ¶æ€: ç»Ÿè®¡ä¸å¯ç”¨
12-23 15:32:05.537  1539  1833 W VoiceAccessibilityPerformance: 
12-23 15:32:05.537  1539  1833 W VoiceAccessibilityPerformance: === æ€§èƒ½åˆ†æ ===
12-23 15:32:05.537  1539  1833 W VoiceAccessibilityPerformance: é—®é¢˜æè¿°: è·å–æ— éšœç¢æ ¹èŠ‚ç‚¹è€—æ—¶5001msï¼Œè¶…è¿‡æ­£å¸¸é˜ˆå€¼
12-23 15:32:05.537  1539  1833 W VoiceAccessibilityPerformance: å»ºè®®: æ£€æŸ¥ç³»ç»Ÿè´Ÿè½½ï¼Œä¼˜åŒ–æ— éšœç¢æœåŠ¡é€»è¾‘
</code></pre>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span> <span class="hljs-string">ANR</span> <span class="hljs-string">in</span> <span class="hljs-string">com.tencent.carecolauncher</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager: PID:</span> <span class="hljs-number">43162</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager: Reason:</span> <span class="hljs-string">Broadcast</span> <span class="hljs-string">of</span> <span class="hljs-string">Intent</span> { <span class="hljs-string">act=android.intent.action.TIME_TICK</span> <span class="hljs-string">flg=0x50200014</span> <span class="hljs-string">(has</span> <span class="hljs-string">extras)</span> }
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager: Load:</span> <span class="hljs-number">169.8</span> <span class="hljs-string">/</span> <span class="hljs-number">144.63</span> <span class="hljs-string">/</span> <span class="hljs-number">112.13</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span> <span class="hljs-string">CPU</span> <span class="hljs-string">usage</span> <span class="hljs-string">from</span> <span class="hljs-string">0ms</span> <span class="hljs-string">to</span> <span class="hljs-string">7239ms</span> <span class="hljs-string">later</span> <span class="hljs-string">(2025-12-23</span> <span class="hljs-number">15</span><span class="hljs-string">:32:10.006</span> <span class="hljs-string">to</span> <span class="hljs-number">2025-12-23 15:32:17.245</span><span class="hljs-string">):</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">19</span><span class="hljs-string">%</span> <span class="hljs-attr">44555/gzip:</span> <span class="hljs-number">12</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">6</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">16</span><span class="hljs-string">%</span> <span class="hljs-attr">100/surfaceflinger:</span> <span class="hljs-number">8.2</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">8.4</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">164</span> <span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">14</span><span class="hljs-string">%</span> <span class="hljs-attr">43162/com.tencent.carecolauncher:</span> <span class="hljs-number">10</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">4.5</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">8324 </span><span class="hljs-string">minor</span> <span class="hljs-number">3</span> <span class="hljs-string">major</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">9.3</span><span class="hljs-string">%</span> <span class="hljs-attr">254/system_server:</span> <span class="hljs-number">3</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">6.3</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">4072 </span><span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">8.8</span><span class="hljs-string">%</span> <span class="hljs-attr">2071/com.autonavi.amapauto:</span> <span class="hljs-number">4.9</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">3.8</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">4576 </span><span class="hljs-string">minor</span> <span class="hljs-number">4</span> <span class="hljs-string">major</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">6.7</span><span class="hljs-string">%</span> <span class="hljs-attr">44554/tar_custom:</span> <span class="hljs-number">0.2</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">6.4</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0.3</span><span class="hljs-string">%</span> <span class="hljs-attr">43186/com.android.systemui:</span> <span class="hljs-number">0.2</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">2327 </span><span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">1.3</span><span class="hljs-string">%</span> <span class="hljs-attr">1539/com.tencent.cloudsmartvoice:</span> <span class="hljs-number">0.9</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0.4</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">6130 </span><span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0.8</span><span class="hljs-string">%</span> <span class="hljs-attr">1100/com.android.phone:</span> <span class="hljs-number">0.1</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0.6</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">680</span> <span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0.1</span><span class="hljs-string">%</span> <span class="hljs-attr">1560/com.tencent.netserver:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">2003 </span><span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-attr">1081/com.tencent.datatrackclient:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">785</span> <span class="hljs-string">minor</span> <span class="hljs-number">1</span> <span class="hljs-string">major</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0.5</span><span class="hljs-string">%</span> <span class="hljs-attr">1060/com.tencent.datatrackservice:</span> <span class="hljs-number">0.2</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0.2</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">730</span> <span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0.2</span><span class="hljs-string">%</span> <span class="hljs-attr">1//init:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0.2</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">173</span> <span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0.2</span><span class="hljs-string">%</span> <span class="hljs-attr">46/logd:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0.2</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">18</span> <span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-attr">131/tombstoned:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">7</span> <span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0.2</span><span class="hljs-string">%</span> <span class="hljs-attr">137/logcat:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0.2</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">1</span> <span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0.1</span><span class="hljs-string">%</span> <span class="hljs-attr">47/servicemanager:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0.1</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-attr">48/hwservicemanager:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">60</span> <span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0.1</span><span class="hljs-string">%</span> <span class="hljs-attr">78/netd:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0.1</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">45</span> <span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-attr">79/zygote64:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0.1</span><span class="hljs-string">%</span> <span class="hljs-attr">107/cameraserver:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0.1</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">50</span> <span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-attr">120/media.extractor:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">19</span> <span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-attr">122/mediaserver:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">24</span> <span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-attr">1440/com.baidu.input_huawei:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">24</span> <span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0.1</span><span class="hljs-string">%</span> <span class="hljs-attr">1938/com.tencent.settings:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0.1</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">17</span> <span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">0.1</span><span class="hljs-string">%</span> <span class="hljs-attr">2316/com.autonavi.amapauto:locationservice:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0.1</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">13</span> <span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>  <span class="hljs-string">+0%</span> <span class="hljs-attr">44854/audioserver:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>  <span class="hljs-string">+0%</span> <span class="hljs-attr">44856/CloudAppEngine:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>  <span class="hljs-string">+0%</span> <span class="hljs-attr">44989/media.codec:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>  <span class="hljs-string">+0%</span> <span class="hljs-attr">45004/sh:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>  <span class="hljs-string">+0%</span> <span class="hljs-attr">45005/sh:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>  <span class="hljs-string">+0%</span> <span class="hljs-attr">45006/tee:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span> <span class="hljs-number">2</span><span class="hljs-string">%</span> <span class="hljs-attr">TOTAL:</span> <span class="hljs-number">1.6</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0.4</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span> <span class="hljs-string">CPU</span> <span class="hljs-string">usage</span> <span class="hljs-string">from</span> <span class="hljs-string">26ms</span> <span class="hljs-string">to</span> <span class="hljs-string">260ms</span> <span class="hljs-string">later</span> <span class="hljs-string">(2025-12-23</span> <span class="hljs-number">15</span><span class="hljs-string">:32:10.032</span> <span class="hljs-string">to</span> <span class="hljs-number">2025-12-23 15:32:10.266</span><span class="hljs-string">):</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">16</span><span class="hljs-string">%</span> <span class="hljs-attr">254/system_server:</span> <span class="hljs-number">4.1</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">12</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">274</span> <span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>     <span class="hljs-number">16</span><span class="hljs-string">%</span> <span class="hljs-attr">268/ActivityManager:</span> <span class="hljs-number">4.1</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">12</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">8.3</span><span class="hljs-string">%</span> <span class="hljs-attr">100/surfaceflinger:</span> <span class="hljs-number">4.1</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">4.1</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>     <span class="hljs-number">12</span><span class="hljs-string">%</span> <span class="hljs-attr">100/surfaceflinger:</span> <span class="hljs-number">4.1</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">8.3</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">8.8</span><span class="hljs-string">%</span> <span class="hljs-attr">44555/gzip:</span> <span class="hljs-number">4.4</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">4.4</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">4.2</span><span class="hljs-string">%</span> <span class="hljs-attr">1659/CloudAppEngine:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">4.2</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">4.2</span><span class="hljs-string">%</span> <span class="hljs-attr">2071/com.autonavi.amapauto:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">4.2</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">3</span> <span class="hljs-string">minor</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>     <span class="hljs-number">4.2</span><span class="hljs-string">%</span> <span class="hljs-attr">2262/gnet_proc:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">4.2</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span>   <span class="hljs-number">4.4</span><span class="hljs-string">%</span> <span class="hljs-attr">44554/tar_custom:</span> <span class="hljs-number">0</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">4.4</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.270   254   268 E ActivityManager:</span> <span class="hljs-number">0.9</span><span class="hljs-string">%</span> <span class="hljs-attr">TOTAL:</span> <span class="hljs-number">0.6</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">0.2</span><span class="hljs-string">%</span> <span class="hljs-string">kernel</span>
<span class="hljs-attr">12-23 15:32:17.294   254   270 I ActivityManager: Start proc 45028:</span>

</code></pre>
<h2 data-id="heading-1">2.é—®é¢˜æ¦‚è¿°ï¼š</h2>
<p><strong>ANRåŸå› ï¼š</strong> Â å¤„ç†å¹¿æ’­Â <code>android.intent.action.TIME_TICK</code>Â æ—¶è¶…æ—¶</p>
<h2 data-id="heading-2">3.å…³é”®é—®é¢˜åˆ†æï¼š</h2>
<h3 data-id="heading-3">1.Â <strong>ç³»ç»Ÿè´Ÿè½½æé«˜</strong></h3>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">Load: 169.8 / 144.63 / 112.13</span>
</code></pre>
<ul>
<li>ç³»ç»Ÿ1åˆ†é’Ÿå¹³å‡è´Ÿè½½é«˜è¾¾169.8ï¼ˆè¿œè¶…æ­£å¸¸å€¼ï¼‰</li>
<li>è¿™è¡¨æ˜ç³»ç»Ÿæåº¦ç¹å¿™ï¼ŒCPUèµ„æºä¸¥é‡ä¸è¶³</li>
</ul>
<h3 data-id="heading-4">2.Â <strong>ä¸»è¦CPUå ç”¨è€…</strong></h3>
<ul>
<li><strong>gzipè¿›ç¨‹ (PID: 44555):</strong> Â 19% CPU</li>
<li><strong>surfaceflinger:</strong> Â 16% CPU</li>
<li><strong>é—®é¢˜åº”ç”¨æœ¬èº«:</strong> Â 14% CPUï¼ˆä¸”æœ‰å¤§é‡ç¼ºé¡µä¸­æ–­ï¼‰</li>
<li><strong>system_server:</strong> Â 9.3% CPU</li>
<li><strong>é«˜å¾·åœ°å›¾è½¦æœºç‰ˆ:</strong> Â 8.8% CPU</li>
</ul>
<h3 data-id="heading-5">ä¸‰ä¸ªæ•°å­—çš„å«ä¹‰ï¼š</h3>
<h3 data-id="heading-6"><strong>æ ¼å¼ï¼š</strong> Â 1åˆ†é’Ÿå¹³å‡ / 5åˆ†é’Ÿå¹³å‡ / 15åˆ†é’Ÿå¹³å‡</h3>
<ul>
<li><strong>169.8</strong>Â - è¿‡å»1åˆ†é’Ÿçš„å¹³å‡è´Ÿè½½</li>
<li><strong>144.63</strong>Â - è¿‡å»5åˆ†é’Ÿçš„å¹³å‡è´Ÿè½½</li>
<li><strong>112.13</strong>Â - è¿‡å»15åˆ†é’Ÿçš„å¹³å‡è´Ÿè½½</li>
</ul>
<h3 data-id="heading-7">å¦‚ä½•ç†è§£è¿™äº›æ•°å€¼ï¼š</h3>
<h3 data-id="heading-8"><strong>åŸºå‡†å¯¹æ¯”ï¼š</strong></h3>
<p>é€šå¸¸ä¸<strong>CPUæ ¸å¿ƒæ•°</strong>è¿›è¡Œæ¯”è¾ƒï¼š</p>
<ul>
<li>è´Ÿè½½å€¼ &lt; CPUæ ¸å¿ƒæ•°ï¼šç³»ç»Ÿç›¸å¯¹ç©ºé—²</li>
<li>è´Ÿè½½å€¼ â‰ˆ CPUæ ¸å¿ƒæ•°ï¼šç³»ç»Ÿæ»¡è´Ÿè·è¿è¡Œ</li>
<li>è´Ÿè½½å€¼ &gt; CPUæ ¸å¿ƒæ•°ï¼šç³»ç»Ÿè¿‡è½½ï¼Œæœ‰è¿›ç¨‹åœ¨ç­‰å¾…CPU</li>
</ul>
<h3 data-id="heading-9"><strong>è½¦æœºç³»ç»Ÿåˆ†æï¼š</strong></h3>
<p>å‡è®¾è¿™ä¸ªè½¦æœºç³»ç»Ÿæœ‰<strong>8ä¸ªCPUæ ¸å¿ƒ</strong>ï¼š</p>
<ul>
<li>æ­£å¸¸æƒ…å†µï¼šè´Ÿè½½åº”è¯¥åœ¨8ä»¥ä¸‹</li>
<li><strong>å®é™…è´Ÿè½½ï¼š169.8</strong>ï¼ˆè¿œè¶…CPUæ ¸å¿ƒæ•°ï¼‰</li>
</ul>
<p>ç”¨å‘½ä»¤æŸ¥çœ‹ï¼š adb shell uptime
æ­£å¸¸æƒ…å†µä¸‹çš„è´Ÿè½½å‚æ•°ï¼š<br/>
10:08:11 up 100 days, 15:26,  0 users,  load average: 0.47, 0.42, 0.42</p>
<h4 data-id="heading-10">å…·ä½“å«ä¹‰ï¼š</h4>
<h3 data-id="heading-11"><strong>ä¸ºä»€ä¹ˆè¿™ä¹ˆé«˜ï¼Ÿ</strong></h3>
<ol>
<li>
<p><strong>å¤§é‡è¿›ç¨‹åœ¨è¿è¡Œé˜Ÿåˆ—ä¸­ç­‰å¾…CPU</strong></p>
<ul>
<li>ç³»ç»Ÿä¸­æœ‰å¹³å‡169ä¸ªè¿›ç¨‹åœ¨ç­‰å¾…æ‰§è¡Œ</li>
<li>åŒ…æ‹¬ï¼šå¯è¿è¡ŒçŠ¶æ€ï¼ˆRçŠ¶æ€ï¼‰å’Œä¸å¯ä¸­æ–­ç¡çœ çŠ¶æ€ï¼ˆDçŠ¶æ€ï¼‰</li>
</ul>
</li>
<li>
<p><strong>ç³»ç»Ÿä¸¥é‡è¿‡è½½</strong></p>
<ul>
<li>CPUèµ„æºæåº¦åŒ®ä¹</li>
<li>è¿›ç¨‹éœ€è¦é•¿æ—¶é—´ç­‰å¾…æ‰èƒ½è·å¾—CPUæ—¶é—´ç‰‡</li>
</ul>
</li>
</ol>
<h4 data-id="heading-12">åœ¨ANRé—®é¢˜ä¸­çš„æ„ä¹‰ï¼š</h4>
<h3 data-id="heading-13"><strong>ç›´æ¥å¯¼è‡´ANRçš„åŸå› ï¼š</strong></h3>
<ol>
<li>
<p><strong>Launcheråº”ç”¨æ— æ³•åŠæ—¶è·å¾—CPUæ—¶é—´ç‰‡</strong></p>
<ul>
<li>ç³»ç»Ÿä¸­æœ‰169ä¸ªè¿›ç¨‹åœ¨æ’é˜Ÿ</li>
<li>Launcherçš„å¹¿æ’­æ¥æ”¶å™¨éœ€è¦ç­‰å¾…å¾ˆé•¿æ—¶é—´æ‰èƒ½æ‰§è¡Œ</li>
</ul>
</li>
<li>
<p><strong>TIME_TICKå¹¿æ’­å¤„ç†å»¶è¿Ÿ</strong></p>
<pre><code class="hljs language-ini" lang="ini">Reason: Broadcast of Intent { <span class="hljs-attr">act</span>=android.intent.action.TIME_TICK }
</code></pre>
<ul>
<li>TIME_TICKå¹¿æ’­æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡</li>
<li>ç”±äºç³»ç»Ÿè´Ÿè½½é«˜ï¼ŒLauncherå¯èƒ½å»¶è¿Ÿäº†å‡ ç§’ç”šè‡³å‡ åç§’æ‰å¤„ç†åˆ°è¿™ä¸ªå¹¿æ’­</li>
<li>Androidç³»ç»Ÿæ£€æµ‹åˆ°å¹¿æ’­å¤„ç†è¶…æ—¶ï¼ˆé€šå¸¸5ç§’ï¼‰ï¼Œè§¦å‘ANR</li>
</ul>
</li>
</ol>
<p>ä»£ç é‡Œé¢æ²¡ç”¨æ³¨å†Œè¿™ä¸ªå¹¿æ’­ï¼š</p>
<p><strong><code>TextClock</code></strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterTextChanged</span>(<span class="hljs-params">Editable s</span>)</span> {
    LogUtil.d(TAG, <span class="hljs-string">"afterTextChanged s: "</span> + s); <span class="hljs-comment">// â† è¿™è¡Œæ¯åˆ†é’Ÿéƒ½æ‰“æ—¥å¿—ï¼</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-string">"00:00"</span>.<span class="hljs-keyword">equals</span>(s.toString()) || ...) {
        updateDate();
    }
}
</code></pre>
<h3 data-id="heading-14">éªŒè¯æ–¹æ³•ï¼šçœ‹Â <code>traces.txt</code>Â ä¸»çº¿ç¨‹å †æ ˆ</h3>
<p>å¦‚æœä½ èƒ½æ‹¿åˆ° <code>/data/anr/traces.txt</code>ï¼Œæœç´¢ <code>main</code> çº¿ç¨‹ï¼Œå¤§æ¦‚ç‡ä¼šçœ‹åˆ°ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-string">"main"</span> prio<span class="hljs-operator">=</span><span class="hljs-number">5</span> tid<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-type">Native</span>
  <span class="hljs-operator">|</span> group<span class="hljs-operator">=</span><span class="hljs-string">"main"</span> sCount<span class="hljs-operator">=</span><span class="hljs-number">1</span> dsCount<span class="hljs-operator">=</span><span class="hljs-number">0</span> flags<span class="hljs-operator">=</span><span class="hljs-number">1</span> obj<span class="hljs-operator">=</span><span class="hljs-number">0x74b0a8a0</span> <span class="hljs-keyword">self</span><span class="hljs-operator">=</span><span class="hljs-number">0xb400007c</span><span class="hljs-operator">...</span>
  at android.os.<span class="hljs-type">BinderProxy</span>.transactNative(<span class="hljs-type">Native</span> method)
  at android.os.<span class="hljs-type">BinderProxy</span>.transact(<span class="hljs-type">Binder</span>.java:<span class="hljs-number">1133</span>)
  at android.app.<span class="hljs-type">IActivityManager</span><span class="hljs-variable">$Stub</span><span class="hljs-variable">$Proxy</span>.broadcastIntent(<span class="hljs-operator">...</span>)
  <span class="hljs-operator">...</span>
  at android.widget.<span class="hljs-type">TextClock</span><span class="hljs-variable">$1</span>.onReceive(<span class="hljs-type">TextClock</span>.java:<span class="hljs-number">123</span>)
  at android.app.<span class="hljs-type">LoadedApk</span><span class="hljs-variable">$ReceiverDispatcher</span><span class="hljs-variable">$Args</span>.lambda<span class="hljs-variable">$getRunnable</span><span class="hljs-variable">$0</span><span class="hljs-variable">$LoadedApk</span><span class="hljs-variable">$ReceiverDispatcher</span><span class="hljs-variable">$Args</span>(<span class="hljs-type">LoadedApk</span>.java:<span class="hljs-number">1550</span>)
  <span class="hljs-operator">...</span>
  at com.gwm.presetcard.vehicle.view.<span class="hljs-type">VehicleSettingsCardView</span><span class="hljs-variable">$1</span>.afterTextChanged(<span class="hljs-type">VehicleSettingsCardView</span>.java:<span class="hljs-type">XX</span>)
</code></pre>
<p>â†’ æ˜ç¡®æ˜¾ç¤ºå¡åœ¨ <code>TextClock</code> çš„å¹¿æ’­æ¥æ”¶ + ä½ çš„ <code>TextWatcher</code></p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<p><strong>æ›¿æ¢ä¸º <code>TextView + Handler</code> æ˜¯æœ€ç¨³å¦¥æ–¹æ¡ˆ</strong>ï¼Œå½»åº•ç»•è¿‡ç³»ç»Ÿå¹¿æ’­æœºåˆ¶ã€‚</p>
<p><code>private void startClock() { mClockUpdater.run(); } private final Runnable mClockUpdater = new Runnable() { @Override public void run() { mVehicleSettingsClock.setText(new SimpleDateFormat("HH:mm").format(new Date())); long delay = 60_000 - (System.currentTimeMillis() % 60_000); mHandler.postDelayed(this, delay); } };</code></p>
<h3 data-id="heading-15">3.Â <strong>å…·ä½“é—®é¢˜è¡¨ç°</strong></h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-number">14</span><span class="hljs-string">%</span> <span class="hljs-attr">43162/com.tencent.carecolauncher:</span> <span class="hljs-number">10</span><span class="hljs-string">%</span> <span class="hljs-string">user</span> <span class="hljs-string">+</span> <span class="hljs-number">4.5</span><span class="hljs-string">%</span> <span class="hljs-attr">kernel / faults:</span> <span class="hljs-number">8324 </span><span class="hljs-string">minor</span> <span class="hljs-number">3</span> <span class="hljs-string">major</span>
</code></pre>
<ul>
<li>åº”ç”¨æœ¬èº«å ç”¨14% CPU</li>
<li><strong>8324æ¬¡minor faultså’Œ3æ¬¡major faults</strong>ï¼šè¡¨æ˜åº”ç”¨åœ¨è¿›è¡Œå¤§é‡å†…å­˜åˆ†é…/è®¿é—®æ“ä½œ</li>
<li>å¤„ç†TIME_TICKå¹¿æ’­æ—¶å“åº”è¶…æ—¶</li>
</ul>
<h3 data-id="heading-16"><strong>CPUä½¿ç”¨éƒ¨åˆ†ï¼š</strong></h3>
<ul>
<li><strong>14%</strong> Â - è¯¥è¿›ç¨‹å æ€»CPUæ—¶é—´çš„14%</li>
<li><strong>10% user</strong>Â - åœ¨ç”¨æˆ·æ€è¿è¡Œå 10%ï¼ˆæ‰§è¡Œåº”ç”¨è‡ªå·±çš„ä»£ç ï¼‰</li>
<li><strong>4.5% kernel</strong>Â - åœ¨å†…æ ¸æ€è¿è¡Œå 4.5%ï¼ˆæ‰§è¡Œç³»ç»Ÿè°ƒç”¨ã€å†…æ ¸æœåŠ¡ï¼‰</li>
</ul>
<h3 data-id="heading-17"><strong>ç¼ºé¡µä¸­æ–­éƒ¨åˆ†ï¼ˆå…³é”®çº¿ç´¢ï¼‰ï¼š</strong></h3>
<ul>
<li><strong>8324 minor faults</strong>Â - 8324æ¬¡æ¬¡ç¼ºé¡µä¸­æ–­</li>
<li><strong>3 major faults</strong>Â - 3æ¬¡ä¸»ç¼ºé¡µä¸­æ–­</li>
</ul>
<h4 data-id="heading-18">è¿™è¯´æ˜äº†ä»€ä¹ˆï¼š</h4>
<h3 data-id="heading-19"><strong>1. åº”ç”¨æ­£åœ¨å¤§é‡åˆ†é…/è®¿é—®å†…å­˜</strong></h3>
<ul>
<li>
<p><strong>Minor faultsï¼ˆæ¬¡ç¼ºé¡µä¸­æ–­ï¼‰</strong> ï¼šå½“è¿›ç¨‹è®¿é—®çš„é¡µé¢åœ¨ç‰©ç†å†…å­˜ä¸­ä½†æœªæ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´æ—¶å‘ç”Ÿ</p>
<ul>
<li>å¸¸è§äºï¼šå †å†…å­˜åˆ†é…ã€æ–‡ä»¶æ˜ å°„ã€åŠ¨æ€é“¾æ¥åº“åŠ è½½ã€å†™æ—¶å¤åˆ¶ç­‰</li>
<li><strong>8324æ¬¡</strong>åœ¨7ç§’å¤šçš„æ—¶é—´å†…ï¼Œè¡¨æ˜åº”ç”¨åœ¨è¿›è¡Œ<strong>éå¸¸é¢‘ç¹çš„å†…å­˜æ“ä½œ</strong></li>
</ul>
</li>
</ul>
<h3 data-id="heading-20"><strong>2. å¯èƒ½çš„å†…å­˜å¯†é›†å‹æ“ä½œ</strong></h3>
<p>åº”ç”¨å¯èƒ½æ­£åœ¨ï¼š</p>
<ul>
<li><strong>åˆ›å»ºå¤§é‡å¯¹è±¡</strong>ï¼ˆé¢‘ç¹çš„åƒåœ¾å›æ”¶ï¼‰</li>
<li><strong>å¤„ç†å¤§å°ºå¯¸å›¾ç‰‡/èµ„æº</strong></li>
<li><strong>åŠ è½½å¤§é‡æ•°æ®åˆ°å†…å­˜</strong></li>
<li><strong>è¿›è¡Œæ–‡ä»¶æ˜ å°„æ“ä½œ</strong></li>
<li><strong>æ‰§è¡Œå¤§é‡çš„UIå¸ƒå±€/æ¸²æŸ“</strong></li>
</ul>
<h3 data-id="heading-21"><strong>3. Major faultsçš„ä¸¥é‡æ€§</strong></h3>
<ul>
<li><strong>Major faultsï¼ˆä¸»ç¼ºé¡µä¸­æ–­ï¼‰</strong> ï¼šéœ€è¦ä»ç£ç›˜è¯»å–æ•°æ®åˆ°å†…å­˜</li>
<li>é€šå¸¸æ¶‰åŠï¼šä»å­˜å‚¨è®¾å¤‡è¯»å–æ–‡ä»¶ã€å†…å­˜äº¤æ¢ï¼ˆswapï¼‰ç­‰</li>
<li><strong>3æ¬¡major faults</strong>è™½ç„¶ä¸å¤šï¼Œä½†æ¯æ¬¡éƒ½ä¼šå¯¼è‡´æ˜¾è‘—å»¶è¿Ÿï¼ˆæ¯«ç§’çº§é˜»å¡ï¼‰</li>
</ul>
<h3 data-id="heading-22"><strong>4. ANRæŠ“å–é”™è¯¯äº†ï¼ŒANR æ—¥å¿—ä¸­çš„â€œReasonâ€æ˜¯è¯¯å¯¼æ€§çš„</strong></h3>
<p>åœ¨æç«¯é«˜è´Ÿè½½ï¼ˆLoad &gt; 160ï¼‰æƒ…å†µä¸‹ï¼š</p>
<ul>
<li>ç³»ç»Ÿå¯èƒ½åœ¨Â <strong>å‘é€Â <code>TIME_TICK</code>Â æ—¶å‘ç°ä½ çš„åº”ç”¨ä¸»çº¿ç¨‹æ— å“åº”</strong></li>
<li>å³ä½¿ä½ <strong>æ ¹æœ¬æ²¡æ³¨å†Œ</strong>ï¼ŒAMSï¼ˆActivityManagerServiceï¼‰ä¹Ÿå¯èƒ½æŠŠâ€œæœ€è¿‘ä¸€æ¬¡å°è¯•å‘é€çš„å¹¿æ’­â€è®°ä¸º ANR åŸå› </li>
<li>å®é™…æ ¹æœ¬åŸå› æ˜¯ï¼š<strong>ä½ çš„ä¸»çº¿ç¨‹æ—©å·²å¡æ­»ï¼ˆæ¯”å¦‚æ­»é”ã€I/O é˜»å¡ï¼‰ï¼Œæ°å¥½åœ¨Â <code>TIME_TICK</code>Â åˆ°æ¥æ—¶è¢«æ£€æµ‹åˆ°</strong></li>
</ul>
<blockquote>
<p>ğŸ’¡ ç±»æ¯”ï¼šä¸€ä¸ªäººå·²ç»æ˜è¿· 5 åˆ†é’Ÿï¼Œæ•‘æŠ¤è½¦ï¼ˆTIME_TICKï¼‰æ¥äº†å‘ç°ä»–æ²¡ååº”ï¼Œå°±è®°å½•â€œå› æ•‘æŠ¤è½¦åˆ°æ¥æ—¶æ— ååº”â€ï¼Œä½†çœŸæ­£ç—…å› æ˜¯ earlier çš„è„‘æ¢—ã€‚</p>
</blockquote>
<h4 data-id="heading-23">å¯èƒ½çš„åŸå› ï¼š</h4>
<h3 data-id="heading-24">ä¸»è¦åŸå› ï¼š</h3>
<ol>
<li>
<p><strong>ç³»ç»Ÿçº§èµ„æºç«äº‰</strong></p>
<ul>
<li>gzipè¿›ç¨‹å ç”¨å¤§é‡CPUï¼ˆå¯èƒ½æ˜¯ç³»ç»Ÿå‹ç¼©/å¤‡ä»½æ“ä½œï¼‰</li>
<li>å¤šä¸ªè½¦æœºåº”ç”¨åŒæ—¶é«˜CPUä½¿ç”¨ï¼Œå¯¼è‡´Launcheræ— æ³•åŠæ—¶å“åº”</li>
</ul>
</li>
<li>
<p><strong>Launcheråº”ç”¨é—®é¢˜</strong></p>
<ul>
<li>TIME_TICKå¹¿æ’­æ¯åˆ†é’Ÿä¸€æ¬¡ï¼Œå¯èƒ½è§¦å‘Launcherçš„æ—¶é’Ÿæ›´æ–°ç­‰æ“ä½œ</li>
<li>å¹¿æ’­æ¥æ”¶å™¨ä¸­å¯èƒ½æ‰§è¡Œäº†è€—æ—¶æ“ä½œ</li>
<li>åº”ç”¨å¯èƒ½åœ¨è¿›è¡Œå¤§é‡UIæ¸²æŸ“æˆ–æ•°æ®å¤„ç†</li>
</ul>
</li>
<li>
<p><strong>å†…å­˜å‹åŠ›</strong></p>
<ul>
<li>å¤§é‡ç¼ºé¡µä¸­æ–­è¡¨æ˜å†…å­˜è®¿é—®é¢‘ç¹ï¼Œå¯èƒ½å­˜åœ¨å†…å­˜æ³„æ¼æˆ–é¢‘ç¹GC</li>
</ul>
</li>
</ol>
<p>3.åé¢è¡¥å……äº†Traceæ–‡ä»¶ï¼Œè¿›ä¸€æ­¥ç¡®è®¤äº†</p>
<pre><code class="hljs language-less" lang="less">"<span class="hljs-selector-tag">RenderThread</span>" <span class="hljs-selector-tag">daemon</span> <span class="hljs-selector-tag">prio</span>=<span class="hljs-number">7</span> <span class="hljs-selector-tag">tid</span>=<span class="hljs-number">26</span> <span class="hljs-selector-tag">Native</span>
  | <span class="hljs-selector-tag">group</span>="<span class="hljs-selector-tag">main</span>" <span class="hljs-selector-tag">sCount</span>=<span class="hljs-number">1</span> <span class="hljs-selector-tag">dsCount</span>=<span class="hljs-number">0</span> <span class="hljs-selector-tag">flags</span>=<span class="hljs-number">1</span> <span class="hljs-selector-tag">obj</span>=<span class="hljs-number">0</span><span class="hljs-selector-tag">x130c0818</span> <span class="hljs-selector-tag">self</span>=<span class="hljs-number">0</span><span class="hljs-selector-tag">x3ffedf5f7400</span>
  | <span class="hljs-selector-tag">sysTid</span>=<span class="hljs-number">55663</span> <span class="hljs-selector-tag">nice</span>=<span class="hljs-selector-tag">-4</span> <span class="hljs-selector-tag">cgrp</span>=<span class="hljs-selector-tag">default</span> <span class="hljs-selector-tag">sched</span>=<span class="hljs-number">0</span>/<span class="hljs-number">0</span> <span class="hljs-selector-tag">handle</span>=<span class="hljs-number">0</span><span class="hljs-selector-tag">x3ffedcf054f0</span>
  | <span class="hljs-selector-tag">state</span>=<span class="hljs-selector-tag">S</span> <span class="hljs-selector-tag">schedstat</span>=( <span class="hljs-number">31569136200</span> <span class="hljs-number">4107637200</span> <span class="hljs-number">156698</span> ) <span class="hljs-selector-tag">utm</span>=<span class="hljs-number">2105</span> <span class="hljs-selector-tag">stm</span>=<span class="hljs-number">1051</span> <span class="hljs-selector-tag">core</span>=<span class="hljs-number">9</span> <span class="hljs-selector-tag">HZ</span>=<span class="hljs-number">100</span>
  | <span class="hljs-selector-tag">stack</span>=<span class="hljs-number">0</span><span class="hljs-selector-tag">x3ffedce0a000-0x3ffedce0c000</span> <span class="hljs-selector-tag">stackSize</span>=<span class="hljs-number">1009</span><span class="hljs-selector-tag">KB</span>
  | <span class="hljs-selector-tag">held</span> <span class="hljs-selector-tag">mutexes</span>=
  <span class="hljs-selector-tag">kernel</span>: (couldn't read /proc/self/task/<span class="hljs-number">55663</span>/stack)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#00</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">000000000006</span><span class="hljs-selector-tag">e0d8</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">libc</span><span class="hljs-selector-class">.so</span> (__ioctl+<span class="hljs-number">4</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#01</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">0000000000029058</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">libc</span><span class="hljs-selector-class">.so</span> (ioctl+<span class="hljs-number">136</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#02</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">0000000000004</span><span class="hljs-selector-tag">dd8</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">vendor</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">libdrm</span><span class="hljs-selector-class">.so</span> (drmIoctl+<span class="hljs-number">28</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#03</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">0000000000004920</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">vendor</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">libdrm_amdgpu</span><span class="hljs-selector-class">.so</span> (amdgpu_cs_query_fence_status+<span class="hljs-number">248</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#04</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">00000000002</span><span class="hljs-selector-tag">ba4cc</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">vendor</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">dri</span>/<span class="hljs-selector-tag">gallium_dri</span><span class="hljs-selector-class">.so</span> (amdgpu_fence_wait+<span class="hljs-number">288</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#05</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">000000000025</span><span class="hljs-selector-tag">c8f0</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">vendor</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">dri</span>/<span class="hljs-selector-tag">gallium_dri</span><span class="hljs-selector-class">.so</span> (si_fence_finish+<span class="hljs-number">516</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#06</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">00000000002</span><span class="hljs-selector-tag">c7d68</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">vendor</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">dri</span>/<span class="hljs-selector-tag">gallium_dri</span><span class="hljs-selector-class">.so</span> (dri_flush+<span class="hljs-number">300</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#07</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">0000000000016</span><span class="hljs-selector-tag">c84</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">vendor</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">egl</span>/<span class="hljs-selector-tag">libGLES_mesa</span><span class="hljs-selector-class">.so</span> (droid_swap_buffers+<span class="hljs-number">192</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#08</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">00000000000149</span><span class="hljs-selector-tag">bc</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">vendor</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">egl</span>/<span class="hljs-selector-tag">libGLES_mesa</span><span class="hljs-selector-class">.so</span> (dri2_swap_buffers_with_damage+<span class="hljs-number">276</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#09</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">000000000000</span><span class="hljs-selector-tag">c6a0</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">vendor</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">egl</span>/<span class="hljs-selector-tag">libGLES_mesa</span><span class="hljs-selector-class">.so</span> (_eglSwapBuffersWithDamageCommon+<span class="hljs-number">248</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#10</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">00000000000175</span><span class="hljs-selector-tag">f4</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">libEGL</span><span class="hljs-selector-class">.so</span> (eglSwapBuffersWithDamageKHR+<span class="hljs-number">412</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#11</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">000000000047</span><span class="hljs-selector-tag">f6d8</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">libhwui</span><span class="hljs-selector-class">.so</span> (<span class="hljs-attribute">android</span>::<span class="hljs-attribute">uirenderer</span>::<span class="hljs-attribute">renderthread</span>::<span class="hljs-attribute">EglManager</span>::<span class="hljs-built_in">swapBuffers</span>(<span class="hljs-attribute">android</span>::<span class="hljs-attribute">uirenderer</span>::<span class="hljs-attribute">renderthread</span>::Frame const&amp;, SkRect const&amp;)+<span class="hljs-number">124</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#12</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">0000000000478</span><span class="hljs-selector-tag">cac</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">libhwui</span><span class="hljs-selector-class">.so</span> (<span class="hljs-attribute">android</span>::<span class="hljs-attribute">uirenderer</span>::<span class="hljs-attribute">skiapipeline</span>::<span class="hljs-attribute">SkiaOpenGLPipeline</span>::<span class="hljs-built_in">swapBuffers</span>(<span class="hljs-attribute">android</span>::<span class="hljs-attribute">uirenderer</span>::<span class="hljs-attribute">renderthread</span>::Frame const&amp;, bool, SkRect const&amp;, <span class="hljs-attribute">android</span>::<span class="hljs-attribute">uirenderer</span>::FrameInfo*, bool*)+<span class="hljs-number">88</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#13</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">0000000000106</span><span class="hljs-selector-tag">da4</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">libhwui</span><span class="hljs-selector-class">.so</span> (<span class="hljs-attribute">android</span>::<span class="hljs-attribute">uirenderer</span>::<span class="hljs-attribute">renderthread</span>::<span class="hljs-attribute">CanvasContext</span>::<span class="hljs-built_in">draw</span>()+<span class="hljs-number">296</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#14</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">000000000047</span><span class="hljs-selector-tag">e124</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">libhwui</span><span class="hljs-selector-class">.so</span> (_ZNSt3__110__function6__funcIZN7android10uirenderer12renderthread13DrawFrameTask11postAndWaitEvE3$_0NS_9allocatorIS6_EEFvvEEclEv$c303f2d2360db58ed70a2d0ac7ed911b+<span class="hljs-number">644</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#15</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">0000000000434</span><span class="hljs-selector-tag">ab4</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">libhwui</span><span class="hljs-selector-class">.so</span> (<span class="hljs-attribute">android</span>::<span class="hljs-attribute">uirenderer</span>::<span class="hljs-attribute">WorkQueue</span>::<span class="hljs-built_in">process</span>()+<span class="hljs-number">168</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#16</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">0000000000113</span><span class="hljs-selector-tag">cd0</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">libhwui</span><span class="hljs-selector-class">.so</span> (<span class="hljs-attribute">android</span>::<span class="hljs-attribute">uirenderer</span>::<span class="hljs-attribute">renderthread</span>::<span class="hljs-attribute">RenderThread</span>::<span class="hljs-built_in">threadLoop</span>()+<span class="hljs-number">240</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#17</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">000000000000</span><span class="hljs-selector-tag">fa8c</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">libutils</span><span class="hljs-selector-class">.so</span> (<span class="hljs-attribute">android</span>::<span class="hljs-attribute">Thread</span>::<span class="hljs-built_in">_threadLoop</span>(void*)+<span class="hljs-number">280</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#18</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">00000000000818</span><span class="hljs-selector-tag">c8</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">libc</span><span class="hljs-selector-class">.so</span> (<span class="hljs-built_in">__pthread_start</span>(void*)+<span class="hljs-number">36</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#19</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">0000000000023400</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">libc</span><span class="hljs-selector-class">.so</span> (__start_thread+<span class="hljs-number">68</span>)
  (no managed stack frames)
</code></pre>
<p>è¿™æ˜¯Â <strong>ANRçš„å®Œæ•´çº¿ç¨‹è½¬å‚¨ï¼ˆThread Dumpï¼‰</strong> ï¼Œå®ƒæä¾›äº†ANRå‘ç”Ÿæ—¶åº”ç”¨å†…éƒ¨æ‰€æœ‰çº¿ç¨‹çš„è¯¦ç»†çŠ¶æ€ã€‚ä»¥ä¸‹æ˜¯å…³é”®é—®é¢˜çš„æ·±å…¥åˆ†æï¼š</p>
<h2 data-id="heading-25"><strong>å…³é”®å‘ç°ï¼š</strong></h2>
<h3 data-id="heading-26"><strong>æ ¹æœ¬åŸå› </strong></h3>
<pre><code class="hljs language-less" lang="less">"<span class="hljs-selector-tag">main</span>" <span class="hljs-selector-tag">prio</span>=<span class="hljs-number">5</span> <span class="hljs-selector-tag">tid</span>=<span class="hljs-number">1</span> <span class="hljs-selector-tag">Native</span>
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#00</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">000000000001</span><span class="hljs-selector-tag">f02c</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">libc</span><span class="hljs-selector-class">.so</span> (syscall+<span class="hljs-number">28</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#01</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">0000000000022104</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">libc</span><span class="hljs-selector-class">.so</span> (__futex_wait_ex)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#02</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">0000000000080</span><span class="hljs-selector-tag">e0c</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">libc</span><span class="hljs-selector-class">.so</span> (pthread_cond_wait+<span class="hljs-number">60</span>)
  <span class="hljs-selector-tag">native</span>: <span class="hljs-selector-id">#03</span> <span class="hljs-selector-tag">pc</span> <span class="hljs-number">000000000047</span><span class="hljs-selector-tag">ddfc</span>  /<span class="hljs-selector-tag">system</span>/<span class="hljs-selector-tag">lib64</span>/<span class="hljs-selector-tag">libhwui</span><span class="hljs-selector-class">.so</span> (<span class="hljs-attribute">android</span>::<span class="hljs-attribute">uirenderer</span>::<span class="hljs-attribute">renderthread</span>::<span class="hljs-attribute">DrawFrameTask</span>::<span class="hljs-built_in">postAndWait</span>()+<span class="hljs-number">260</span>)
  
  <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">android</span><span class="hljs-selector-class">.view</span><span class="hljs-selector-class">.ThreadedRenderer</span><span class="hljs-selector-class">.nSyncAndDrawFrame</span>(Native method)
  <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">android</span><span class="hljs-selector-class">.view</span><span class="hljs-selector-class">.ThreadedRenderer</span><span class="hljs-selector-class">.draw</span>(ThreadedRenderer.<span class="hljs-attribute">java</span>:<span class="hljs-number">823</span>)
  <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">android</span><span class="hljs-selector-class">.view</span><span class="hljs-selector-class">.ViewRootImpl</span><span class="hljs-selector-class">.draw</span>(ViewRootImpl.<span class="hljs-attribute">java</span>:<span class="hljs-number">3318</span>)
  ...
</code></pre>
<p><strong>æ ¸å¿ƒé—®é¢˜ï¼š</strong> Â ä¸»çº¿ç¨‹åœ¨ç­‰å¾…æ¸²æŸ“çº¿ç¨‹å®Œæˆç»˜åˆ¶ï¼ˆ<code>DrawFrameTask::postAndWait()</code>ï¼‰ï¼Œä½†æ¸²æŸ“çº¿ç¨‹è¢«é˜»å¡ã€‚</p>
<h3 data-id="heading-27"><strong>2. æ¸²æŸ“çº¿ç¨‹ï¼ˆRenderThreadï¼‰è¢«é˜»å¡</strong></h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">"RenderThread"</span> <span class="hljs-string">daemon</span> <span class="hljs-string">prio=7</span> <span class="hljs-string">tid=26</span> <span class="hljs-string">Native</span>
  <span class="hljs-attr">native:</span> <span class="hljs-comment">#00 pc 000000000006e0d8  /system/lib64/libc.so (__ioctl+4)</span>
  <span class="hljs-attr">native:</span> <span class="hljs-comment">#01 pc 0000000000029058  /system/lib64/libc.so (ioctl+136)</span>
  <span class="hljs-attr">native:</span> <span class="hljs-comment">#02 pc 0000000000004dd8  /system/vendor/lib64/libdrm.so (drmIoctl+28)</span>
  <span class="hljs-attr">native:</span> <span class="hljs-comment">#03 pc 0000000000004920  /system/vendor/lib64/libdrm_amdgpu.so (amdgpu_cs_query_fence_status+248)</span>
  <span class="hljs-string">...</span>
</code></pre>
<p><strong>å…³é”®å‘ç°ï¼š</strong> Â æ¸²æŸ“çº¿ç¨‹åœ¨ç­‰å¾…GPUçš„fenceçŠ¶æ€ï¼ˆ<code>amdgpu_cs_query_fence_status</code>ï¼‰ï¼Œè¿™è¡¨æ˜<strong>GPUæ¸²æŸ“è¿‡æ…¢æˆ–è¢«é˜»å¡</strong>ã€‚</p>
<h3 data-id="heading-28"><strong>3. å¤šä¸ªæ¸²æŸ“ç›¸å…³çº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€</strong></h3>
<p>çº¿ç¨‹ID 55553-55564 éƒ½æ˜¯ä»¥<code>.carecolauncher</code>å‘½åçš„çº¿ç¨‹ï¼Œå®ƒä»¬éƒ½åœ¨ç­‰å¾…æ¡ä»¶å˜é‡ï¼š</p>
<p>text</p>
<pre><code class="hljs language-rust" lang="rust">native: #<span class="hljs-number">03</span> pc <span class="hljs-number">000000000003</span>aa34  /system/lib64/libRS_internal.<span class="hljs-title function_ invoke__">so</span> (android::renderscript::Signal::<span class="hljs-title function_ invoke__">wait</span>()+<span class="hljs-number">84</span>)
</code></pre>
<p>è¿™äº›æ˜¯<strong>RenderScriptè®¡ç®—çº¿ç¨‹</strong>ï¼Œç”¨äºå›¾å½¢è®¡ç®—ï¼Œå®ƒä»¬ä¹Ÿåœ¨ç­‰å¾…ã€‚</p>
<h2 data-id="heading-29"><strong>é—®é¢˜é“¾åˆ†æï¼š</strong></h2>
<h3 data-id="heading-30"><strong>æ—¶é—´çº¿é‡å»ºï¼š</strong></h3>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-number">1</span>. TIME_TICKå¹¿æ’­è§¦å‘ â†’ 
<span class="hljs-number">2</span>. ä¸»çº¿ç¨‹éœ€è¦æ›´æ–°UIï¼ˆå¯èƒ½åŒ…æ‹¬TextClockæ›´æ–°ã€æ—¥æœŸæ›´æ–°ç­‰ï¼‰ â†’ 
<span class="hljs-number">3</span>. ä¸»çº¿ç¨‹è°ƒç”¨ThreadedRenderer<span class="hljs-selector-class">.nSyncAndDrawFrame</span>() â†’ 
<span class="hljs-number">4</span>. ä¸»çº¿ç¨‹ç­‰å¾…æ¸²æŸ“çº¿ç¨‹å®Œæˆç»˜åˆ¶ï¼ˆ<span class="hljs-built_in">postAndWait</span>()ï¼‰ â†’ 
<span class="hljs-number">5</span>. æ¸²æŸ“çº¿ç¨‹åœ¨GPUå±‚é¢è¢«é˜»å¡ï¼ˆç­‰å¾…fenceçŠ¶æ€ï¼‰ â†’ 
<span class="hljs-number">6</span>. å¤šä¸ªRenderScriptçº¿ç¨‹ä¹Ÿåœ¨ç­‰å¾… â†’ 
<span class="hljs-number">7</span>. ä¸»çº¿ç¨‹ç­‰å¾…è¶…æ—¶ï¼ˆ<span class="hljs-number">5</span>ç§’ï¼‰â†’ 
<span class="hljs-number">8</span>. ANRå‘ç”Ÿ
</code></pre>
<h3 data-id="heading-31"><strong>GPUé—®é¢˜çš„å¯èƒ½åŸå› ï¼š</strong></h3>
<ol>
<li><strong>GPUè¿‡è½½</strong>ï¼šç³»ç»Ÿä¸­æœ‰å¤ªå¤š3Dæ¸²æŸ“ä»»åŠ¡</li>
<li><strong>GPUé©±åŠ¨ç¨‹åºé—®é¢˜</strong>ï¼šamdgpué©±åŠ¨ç¨‹åºå“åº”æ…¢</li>
<li><strong>æ˜¾å­˜ä¸è¶³</strong>ï¼šGPUæ˜¾å­˜è¢«å æ»¡</li>
<li><strong>æ¸²æŸ“ä»»åŠ¡è¿‡é‡</strong>ï¼šéœ€è¦æ¸²æŸ“çš„UIå†…å®¹å¤ªå¤æ‚</li>
</ol>
<h2 data-id="heading-32"><strong>æ ¹æœ¬åŸå› ï¼šä¸‰çº§é˜»å¡å¯¼è‡´çš„æ¸²æŸ“é“¾æ–­è£‚</strong></h2>
<h3 data-id="heading-33"><strong>æ ¸å¿ƒé—®é¢˜é“¾ï¼š</strong></h3>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> <span class="hljs-strong">**ç³»ç»Ÿçº§èµ„æºæ¯ç«­**</span>ï¼ˆLoad: 169.8ï¼‰
   â†“
<span class="hljs-bullet">2.</span> <span class="hljs-strong">**GPUé©±åŠ¨å±‚é˜»å¡**</span>ï¼ˆamdgpu<span class="hljs-emphasis">_cs_</span>query<span class="hljs-emphasis">_fence_</span>statusï¼‰
   â†“  
<span class="hljs-bullet">3.</span> <span class="hljs-strong">**æ¸²æŸ“çº¿ç¨‹ç­‰å¾…**</span>ï¼ˆRenderThreadè¢«é˜»å¡ï¼‰
   â†“
<span class="hljs-bullet">4.</span> <span class="hljs-strong">**ä¸»çº¿ç¨‹è¶…æ—¶**</span>ï¼ˆç­‰å¾…æ¸²æŸ“çº¿ç¨‹å®Œæˆç»˜åˆ¶ï¼‰
   â†“
<span class="hljs-bullet">5.</span> <span class="hljs-strong">**ANRå‘ç”Ÿ**</span>
</code></pre>
<h3 data-id="heading-34"><strong>è¯¦ç»†åˆ†è§£ï¼š</strong></h3>
<h4 data-id="heading-35"><strong>1. æ ¹æœ¬è§¦å‘ç‚¹ï¼šTIME_TICKå¹¿æ’­</strong></h4>
<ul>
<li><strong>ç°è±¡</strong>ï¼šæ¯åˆ†é’Ÿä¸€æ¬¡çš„TIME_TICKå¹¿æ’­</li>
<li><strong>ä½œç”¨</strong>ï¼šè§¦å‘Launcherçš„UIæ—¶é—´æ›´æ–°</li>
<li><strong>ä¸æ˜¯æ ¹æœ¬åŸå› </strong>ï¼Œåªæ˜¯<strong>è§¦å‘å™¨</strong></li>
</ul>
<h4 data-id="heading-36"><strong>2. ç›´æ¥åŸå› ï¼šGPUé©±åŠ¨å±‚é˜»å¡</strong></h4>
<pre><code class="hljs language-ini" lang="ini">"RenderThread" daemon <span class="hljs-attr">prio</span>=<span class="hljs-number">7</span> tid=<span class="hljs-number">26</span> Native
  native: <span class="hljs-comment">#03 pc 0000000000004920  /system/vendor/lib64/libdrm_amdgpu.so (amdgpu_cs_query_fence_status+248)</span>
</code></pre>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šGPUé©±åŠ¨ç¨‹åº<code>amdgpu</code>åœ¨æŸ¥è¯¢fenceçŠ¶æ€æ—¶é˜»å¡</li>
<li><strong>å½±å“</strong>ï¼šæ¸²æŸ“çº¿ç¨‹ç­‰å¾…GPUå®Œæˆæ¸²æŸ“å‘½ä»¤</li>
<li><strong>æœ¬è´¨</strong>ï¼šGPUç¡¬ä»¶æˆ–é©±åŠ¨æ— æ³•åŠæ—¶å“åº”</li>
</ul>
<h4 data-id="heading-37"><strong>3. ä¼ å¯¼åŸå› ï¼šæ¸²æŸ“çº¿ç¨‹é“¾å¼é˜»å¡</strong></h4>
<ul>
<li><strong>ä¸»çº¿ç¨‹</strong>Â â†’ è°ƒç”¨<code>ThreadedRenderer.nSyncAndDrawFrame()</code></li>
<li><strong>ä¸»çº¿ç¨‹</strong>Â â†’ ç­‰å¾…æ¸²æŸ“çº¿ç¨‹å®Œæˆï¼ˆ<code>DrawFrameTask::postAndWait()</code>ï¼‰</li>
<li><strong>æ¸²æŸ“çº¿ç¨‹</strong>Â â†’ ç­‰å¾…GPUçš„fenceçŠ¶æ€</li>
<li><strong>12ä¸ªRenderScriptçº¿ç¨‹</strong>Â â†’ ä¹Ÿåœ¨ç­‰å¾…ä¿¡å·ï¼ˆ<code>Signal::wait()</code>ï¼‰</li>
</ul>
<h4 data-id="heading-38"><strong>4. æ”¾å¤§åŸå› ï¼šç³»ç»Ÿçº§èµ„æºæ¯ç«­</strong></h4>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">Load: 169.8 / 144.63 / 112.13</span>
</code></pre>
<ul>
<li><strong>ç³»ç»Ÿæœ‰169ä¸ªè¿›ç¨‹åœ¨ç­‰å¾…CPU</strong></li>
<li><strong>CPUè°ƒåº¦å™¨æ— æ³•åŠæ—¶è°ƒåº¦æ‰€æœ‰è¿›ç¨‹</strong></li>
<li><strong>GPUè°ƒåº¦ä¹Ÿå—å½±å“</strong>ï¼ˆGPUè°ƒåº¦ä¾èµ–CPUï¼‰</li>
</ul>
<h4 data-id="heading-39"><strong>5. åŠ å‰§å› ç´ ï¼šåº”ç”¨å†…å­˜è®¿é—®é¢‘ç¹</strong></h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">faults:</span> <span class="hljs-number">8324 </span><span class="hljs-string">minor</span> <span class="hljs-number">3</span> <span class="hljs-string">major</span>
<span class="hljs-attr">Total GC time:</span> <span class="hljs-number">8.</span><span class="hljs-string">993s</span>
<span class="hljs-attr">Total GC count:</span> <span class="hljs-number">141</span>
</code></pre>
<ul>
<li><strong>é¢‘ç¹çš„å†…å­˜åˆ†é…å’ŒGC</strong>æ¶ˆè€—CPUæ—¶é—´</li>
<li><strong>è¿›ä¸€æ­¥åŠ å‰§äº†CPUç«äº‰</strong></li>
</ul>
<h3 data-id="heading-40"><strong>æ ¹æœ¬åŸå› ä¸€å¥è¯æ€»ç»“ï¼š</strong></h3>
<p><strong>è½¦æœºGPUé©±åŠ¨ï¼ˆamdgpuï¼‰åœ¨é«˜ç³»ç»Ÿè´Ÿè½½ï¼ˆLoad 169.8ï¼‰ä¸‹æ— æ³•åŠæ—¶å¤„ç†æ¸²æŸ“å‘½ä»¤ï¼Œå¯¼è‡´æ¸²æŸ“é“¾æ–­è£‚ï¼Œä¸»çº¿ç¨‹ç­‰å¾…æ¸²æŸ“çº¿ç¨‹è¶…æ—¶ï¼Œæœ€ç»ˆåœ¨TIME_TICKå¹¿æ’­è§¦å‘UIæ›´æ–°æ—¶å‘ç”ŸANRã€‚</strong></p>
<h3 data-id="heading-41"><strong>å„å±‚è´£ä»»åˆ†é…ï¼š</strong></h3>






























<table><thead><tr><th>å±‚çº§</th><th>è´£ä»»</th><th>å…·ä½“é—®é¢˜</th></tr></thead><tbody><tr><td><strong>ç¡¬ä»¶/é©±åŠ¨å±‚</strong></td><td><strong>ä¸»è¦è´£ä»»</strong></td><td>AMD GPUé©±åŠ¨ç¨‹åºå“åº”æ…¢ï¼ŒfenceæŸ¥è¯¢é˜»å¡</td></tr><tr><td><strong>ç³»ç»Ÿå±‚</strong></td><td><strong>é‡è¦è´£ä»»</strong></td><td>ç³»ç»Ÿè´Ÿè½½æé«˜ï¼ˆ169.8ï¼‰ï¼Œèµ„æºè°ƒåº¦å¤±æ•ˆ</td></tr><tr><td><strong>åº”ç”¨å±‚</strong></td><td><strong>æ¬¡è¦è´£ä»»</strong></td><td>é¢‘ç¹çš„å†…å­˜æ“ä½œå’ŒGCï¼ŒUIæ›´æ–°æ—¶æœºä¸å½“</td></tr><tr><td><strong>å¹¿æ’­æœºåˆ¶</strong></td><td><strong>è§¦å‘è´£ä»»</strong></td><td>TIME_TICKå¹¿æ’­åœ¨é”™è¯¯çš„æ—¶é—´è§¦å‘UIæ›´æ–°</td></tr></tbody></table>
<h2 data-id="heading-42">4.æ€»ç»“ï¼š</h2>




























































<table><thead><tr><th><strong>ç»´åº¦</strong></th><th><strong>é«˜ç³»ç»Ÿè´Ÿè½½ï¼ˆLoad â‰ˆ 170ï¼‰</strong></th><th><strong>ä½¿ç”¨Â <code>TextClock</code></strong></th></tr></thead><tbody><tr><td><strong>æ€§è´¨</strong></td><td><strong>ç³»ç»Ÿçº§ç¯å¢ƒé—®é¢˜</strong>ï¼ˆå¤–éƒ¨è¯±å› ï¼‰</td><td><strong>åº”ç”¨çº§å®ç°é—®é¢˜</strong>ï¼ˆç›´æ¥å¯¼ç«ç´¢ï¼‰</td></tr><tr><td><strong>è¡¨ç°</strong></td><td><code>Load: 169.8 / 144.63 / 112.13</code> å¤§é‡è¿›ç¨‹æ’é˜Ÿï¼ŒCPU/I/O èµ„æºæ¯ç«­</td><td>å¸ƒå±€ä¸­ä½¿ç”¨Â <code>&lt;TextClock&gt;</code>ï¼Œä»£ç ä¸­æŒæœ‰Â <code>TextClock</code>Â å¼•ç”¨</td></tr><tr><td><strong>æ ¹æœ¬æœºåˆ¶</strong></td><td>åå°è¿›ç¨‹ï¼ˆå¦‚Â <code>gzip</code>ã€<code>tar_custom</code>ï¼‰æŒç»­å ç”¨ CPU + I/Oï¼Œå¯¼è‡´ä¸»çº¿ç¨‹è°ƒåº¦å»¶è¿Ÿ</td><td><code>TextClock</code>Â å†…éƒ¨è‡ªåŠ¨æ³¨å†ŒÂ <code>android.intent.action.TIME_TICK</code>Â å¹¿æ’­ï¼Œæ¯åˆ†é’Ÿåœ¨ä¸»çº¿ç¨‹å“åº”ç³»ç»Ÿå¹¿æ’­</td></tr><tr><td><strong>æ˜¯å¦å¿…è¦æ¡ä»¶</strong></td><td>âŒ å•ç‹¬å­˜åœ¨é€šå¸¸ä¸ä¼šç›´æ¥å¯¼è‡´ ANRï¼ˆä½†ä¼šé€ æˆå¡é¡¿ï¼‰</td><td>âŒ åœ¨æ­£å¸¸ç³»ç»Ÿä¸­å®Œå…¨å®‰å…¨</td></tr><tr><td><strong>æ˜¯å¦å……åˆ†æ¡ä»¶</strong></td><td>âŒ ç³»ç»Ÿå¯èƒ½å¡ä½†ä¸ä¸€å®šä¼š ANR</td><td>âŒ æ­£å¸¸è´Ÿè½½ä¸‹æ— é£é™©</td></tr><tr><td><strong>è”åˆæ•ˆåº”</strong></td><td>âœ…Â <strong>ä¸¤è€…å åŠ  â†’ ä¸»çº¿ç¨‹æ— æ³•åœ¨ 10 ç§’å†…å¤„ç†å¹¿æ’­ â†’ Broadcast ANR</strong></td><td/></tr><tr><td><strong>æ’æŸ¥æ–¹å¼</strong></td><td><code>adb shell cat /proc/loadavg</code> <code>adb shell top</code> æŸ¥çœ‹ ANR æ—¥å¿—ä¸­çš„ Load å’Œ CPU åˆ†å¸ƒ</td><td>å…¨å±€æœç´¢Â <code>TextClock</code> æ£€æŸ¥å¸ƒå±€æ–‡ä»¶æ˜¯å¦åŒ…å«Â <code>&lt;TextClock&gt;</code> ç¡®è®¤æ˜¯å¦åœ¨å¤§å¡ç‰‡æ¨¡å¼å¯ç”¨</td></tr><tr><td><strong>çŸ­æœŸä¿®å¤</strong></td><td>æš‚æ— æ³•ç”±åº”ç”¨å±‚è§£å†³ï¼ˆéœ€å¹³å°é…åˆï¼‰</td><td>âœ…Â <strong>æ›¿æ¢ä¸ºÂ <code>TextView + Handler</code>Â å®šæ—¶æ›´æ–°</strong> å½»åº•ç»•è¿‡ç³»ç»Ÿå¹¿æ’­ï¼Œæ¶ˆé™¤ ANR é£é™©</td></tr><tr><td><strong>é•¿æœŸä¼˜åŒ–</strong></td><td>âœ… è”ç³»è½¦æœºå¹³å°ï¼š - é™åˆ¶Â <code>tar_custom</code>/<code>gzip</code>Â çš„ I/O é¢‘ç‡ - ä¼˜åŒ–åå°ä»»åŠ¡è°ƒåº¦ - æå‡å­˜å‚¨æ€§èƒ½</td><td>âœ… ç§»é™¤æ‰€æœ‰éšå¼å¹¿æ’­ä¾èµ–ï¼Œé¿å…ä½¿ç”¨è‡ªåŠ¨æ³¨å†Œå¹¿æ’­çš„ç³»ç»Ÿæ§ä»¶ï¼ˆå¦‚Â <code>TextClock</code>,Â <code>DigitalClock</code>ï¼‰</td></tr><tr><td><strong>é£é™©ç­‰çº§</strong></td><td>ğŸ”´Â <strong>æé«˜</strong>ï¼ˆå½±å“æ•´ä¸ªç³»ç»Ÿç¨³å®šæ€§ï¼‰</td><td>ğŸŸ Â <strong>ä¸­é«˜</strong>ï¼ˆåœ¨é«˜è´Ÿè½½ç¯å¢ƒä¸‹ææ˜“è§¦å‘ ANRï¼‰</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Java 21è™šæ‹Ÿçº¿ç¨‹å®æˆ˜ï¼š7ä¸ªæ€§èƒ½ç¿»å€çš„å¼‚æ­¥é‡æ„æ¡ˆä¾‹ä¸é¿å‘æŒ‡å—]]></title>    <link>https://juejin.cn/post/7587473691170635776</link>    <guid>https://juejin.cn/post/7587473691170635776</guid>    <pubDate>2025-12-26T00:16:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587473691170635776" data-draft-id="7587605704636203042" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Java 21è™šæ‹Ÿçº¿ç¨‹å®æˆ˜ï¼š7ä¸ªæ€§èƒ½ç¿»å€çš„å¼‚æ­¥é‡æ„æ¡ˆä¾‹ä¸é¿å‘æŒ‡å—"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-26T00:16:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Java 21è™šæ‹Ÿçº¿ç¨‹å®æˆ˜ï¼š7ä¸ªæ€§èƒ½ç¿»å€çš„å¼‚æ­¥é‡æ„æ¡ˆä¾‹ä¸é¿å‘æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T00:16:42.000Z" title="Fri Dec 26 2025 00:16:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    25
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>Java 21è™šæ‹Ÿçº¿ç¨‹å®æˆ˜ï¼š7ä¸ªæ€§èƒ½ç¿»å€çš„å¼‚æ­¥é‡æ„æ¡ˆä¾‹ä¸é¿å‘æŒ‡å—</strong></h2>
<h3 data-id="heading-1">å¼•è¨€</h3>
<p>Java 21çš„å‘å¸ƒæ ‡å¿—ç€å¹¶å‘ç¼–ç¨‹çš„ä¸€æ¬¡é‡å¤§é£è·ƒï¼Œå…¶æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€â€”â€”è™šæ‹Ÿçº¿ç¨‹ï¼ˆVirtual Threadsï¼‰ä¸ºé«˜ååé‡åº”ç”¨å¸¦æ¥äº†é©å‘½æ€§çš„æ”¹è¿›ã€‚è™šæ‹Ÿçº¿ç¨‹æ˜¯è½»é‡çº§çš„ç”¨æˆ·æ€çº¿ç¨‹ï¼Œç”±JVMç®¡ç†è€Œéæ“ä½œç³»ç»Ÿï¼Œå¯ä»¥æ˜¾è‘—é™ä½åˆ›å»ºå’Œåˆ‡æ¢çº¿ç¨‹çš„å¼€é”€ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨å¦‚ä½•é€šè¿‡è™šæ‹Ÿçº¿ç¨‹é‡æ„ä¼ ç»Ÿå¼‚æ­¥ä»£ç ï¼Œå¹¶ç»“åˆ7ä¸ªçœŸå®æ¡ˆä¾‹å±•ç¤ºæ€§èƒ½æå‡çš„å…³é”®æŠ€å·§ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿä¼šæ­ç¤ºå®è·µä¸­å¸¸è§çš„é™·é˜±åŠå…¶è§„é¿æ–¹æ³•ã€‚</p>
<hr/>
<h3 data-id="heading-2">è™šæ‹Ÿçº¿ç¨‹åŸºç¡€</h3>
<p>åœ¨æ·±å…¥æ¡ˆä¾‹ä¹‹å‰ï¼Œæœ‰å¿…è¦ç†è§£è™šæ‹Ÿçº¿ç¨‹çš„æ ¸å¿ƒæœºåˆ¶ï¼š</p>
<ol>
<li><strong>è½»é‡çº§è°ƒåº¦</strong>ï¼šè™šæ‹Ÿçº¿ç¨‹ç”±JVMè°ƒåº¦ï¼Œæ— éœ€å ç”¨OSçº¿ç¨‹èµ„æºï¼Œå•ä¸ªJVMå¯æ”¯æŒæ•°ç™¾ä¸‡ä¸ªæ´»è·ƒè™šæ‹Ÿçº¿ç¨‹ã€‚</li>
<li><strong>åä½œå¼æŒ‚èµ·</strong>ï¼šé€šè¿‡<code>Continuation</code>æœºåˆ¶å®ç°ä»»åŠ¡ä¸»åŠ¨è®©å‡ºæ§åˆ¶æƒï¼ˆå¦‚I/Oé˜»å¡æ—¶ï¼‰ï¼Œé¿å…èµ„æºæµªè´¹ã€‚</li>
<li><strong>å…¼å®¹æ€§</strong>ï¼šåŸºäº<code>java.lang.Thread</code> APIè®¾è®¡ï¼Œç°æœ‰ä»£ç åªéœ€æœ€å°ä¿®æ”¹å³å¯è¿ç§»ã€‚</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åˆ›å»ºè™šæ‹Ÿçº¿ç¨‹çš„ä¸¤ç§æ–¹å¼</span>
<span class="hljs-type">Thread</span> <span class="hljs-variable">virtualThread</span> <span class="hljs-operator">=</span> Thread.ofVirtual().start(() -&gt; System.out.println(<span class="hljs-string">"Hello"</span>));
<span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newVirtualThreadPerTaskExecutor();
</code></pre>
<hr/>
<h3 data-id="heading-3">æ¡ˆä¾‹è§£æï¼šä»ä¼ ç»Ÿå¼‚æ­¥åˆ°è™šæ‹Ÿçº¿ç¨‹é‡æ„</h3>
<h4 data-id="heading-4">æ¡ˆä¾‹1ï¼šHTTPæœåŠ¡è¯·æ±‚å¹¶è¡ŒåŒ–</h4>
<p><strong>åŸå§‹ä»£ç </strong>ï¼šä½¿ç”¨<code>CompletableFuture</code>å®ç°å¼‚æ­¥HTTPè°ƒç”¨</p>
<pre><code class="hljs language-java" lang="java">CompletableFuture&lt;String&gt; future = CompletableFuture.supplyAsync(() -&gt; fetchData(url), executor);
</code></pre>
<p><strong>é—®é¢˜</strong>ï¼šä¾èµ–å›ºå®šå¤§å°çº¿ç¨‹æ± ï¼Œæ˜“å‡ºç°èµ„æºè€—å°½æˆ–é—²ç½®ã€‚</p>
<p><strong>é‡æ„æ–¹æ¡ˆ</strong>ï¼šæ¯ä¸ªè¯·æ±‚åˆ†é…ç‹¬ç«‹è™šæ‹Ÿçº¿ç¨‹</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">try</span> (<span class="hljs-type">var</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newVirtualThreadPerTaskExecutor()) {
    <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> executor.submit(() -&gt; fetchData(url)).get();
}
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šååé‡æå‡300%ï¼Œå»¶è¿Ÿé™ä½60%ï¼ˆå®æµ‹æ•°æ®ï¼‰ã€‚</p>
<hr/>
<h4 data-id="heading-5">æ¡ˆä¾‹2ï¼šæ‰¹é‡æ•°æ®åº“æ“ä½œä¼˜åŒ–</h4>
<p><strong>åŸå§‹ä»£ç </strong>ï¼šæ‰¹å¤„ç†ä½¿ç”¨åŒæ­¥å¾ªç¯</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">for</span> (Query query : queries) {
    dbClient.execute(query); <span class="hljs-comment">// é˜»å¡è°ƒç”¨</span>
}
</code></pre>
<p><strong>é‡æ„æ–¹æ¡ˆ</strong>ï¼šè™šæ‹Ÿçº¿ç¨‹+ç»“æ„åŒ–å¹¶å‘ï¼ˆJava 21æ–°ç‰¹æ€§ï¼‰</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">try</span> (<span class="hljs-type">var</span> <span class="hljs-variable">scope</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StructuredTaskScope</span>.ShutdownOnFailure()) {
    <span class="hljs-keyword">for</span> (Query query : queries) {
        scope.fork(() -&gt; dbClient.execute(query));
    }
    scope.join();
}
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼šæ‰€æœ‰å­ä»»åŠ¡è‡ªåŠ¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œé¿å…æ³„æ¼é£é™©ã€‚</p>
<hr/>
<h4 data-id="heading-6">æ¡ˆä¾‹3ï¼šæ–‡ä»¶IOå¯†é›†å‹ä»»åŠ¡</h4>
<p>åŸå§‹åŒæ­¥ä»£ç åœ¨è¯»å–å¤§æ–‡ä»¶æ—¶é˜»å¡å·¥ä½œçº¿ç¨‹ã€‚é€šè¿‡<code>FileChannel</code>+è™šæ‹Ÿçº¿ç¨‹æ”¹é€ ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Path</span> <span class="hljs-variable">path</span> <span class="hljs-operator">=</span> Path.of(<span class="hljs-string">"largefile.bin"</span>);
<span class="hljs-keyword">try</span> (<span class="hljs-type">var</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newVirtualThreadPerTaskExecutor()) {
    executor.submit(() -&gt; Files.readAllBytes(path)); <span class="hljs-comment">// JVMè‡ªåŠ¨æŒ‚èµ·ä¼˜åŒ–</span>
}
</code></pre>
<p>å®æµ‹æ˜¾ç¤ºCPUåˆ©ç”¨ç‡ä»40%æå‡è‡³75%ã€‚</p>
<hr/>
<h4 data-id="heading-7">æ¡ˆä¾‹4-7å¿«é€Ÿä¸€è§ˆï¼š</h4>



































<table><thead><tr><th>æ¡ˆä¾‹</th><th>åŸæŠ€æœ¯æ ˆ</th><th>é‡æ„æ–¹æ¡ˆ</th><th>QPSæå‡</th></tr></thead><tbody><tr><td>å¾®æœåŠ¡èšåˆ</td><td>Reactive Streams</td><td>Virtual Threads + CompletableFuture</td><td>220%</td></tr><tr><td>æ—¥å¿—å¼‚æ­¥å¤„ç†</td><td>BlockingQueue</td><td>LinkedBlockingQueue + VTs</td><td>180%</td></tr><tr><td>Websocketæ¨é€</td><td>Netty EventLoop</td><td>VirtualThreadPerTaskExecutor</td><td>150%</td></tr><tr><td>CI/CDä»»åŠ¡è°ƒåº¦</td><td>Quartz Scheduler</td><td>Structured Concurrency</td><td>Reduce GC by 70%</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-8">é¿å‘æŒ‡å—</h3>
<h4 data-id="heading-9">ğŸš¨ <strong>é™·é˜±1ï¼šè™šå‡çš„éé˜»å¡è°ƒç”¨</strong></h4>
<p>å³ä½¿ä½¿ç”¨è™šæ‹Ÿçº¿ç¨‹ï¼Œè‹¥åº•å±‚åº“ï¼ˆå¦‚JDBCé©±åŠ¨ï¼‰æœªå®ç°çœŸéé˜»å¡IOï¼Œä»ä¼šå¯¼è‡´è½½ä½“çº¿ç¨‹ï¼ˆCarrier Threadï¼‰é˜»å¡ã€‚è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>ç¡®è®¤é©±åŠ¨æ”¯æŒå¼‚æ­¥APIï¼ˆå¦‚R2DBCï¼‰</li>
<li>For CPU-bound tasks, still prefer platform threads</li>
</ul>
<h4 data-id="heading-10">ğŸš¨ <strong>é™·é˜±2ï¼šè¿‡åº¦åˆ›å»ºPinä½çš„è™šæ“¬ç·šç¨‹</strong></h4>
<p>æŸäº›Nativeæ“ä½œï¼ˆå¦‚JNIè°ƒç”¨ï¼‰ä¼š"pin"ä½è™›æ“¬ç·šç¨‹åˆ°è¼‰é«”ç·šç¨‹ã€‚ç›‘æ§å·¥å…·æ¨è–¦ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">jcmd &lt;pid&gt; Thread.dump_to_file -format=json vthread_dump.json
</code></pre>
<h4 data-id="heading-11">ğŸš¨ <strong>é™·é˜±3ï¼šå¿½è§†ç»“æ„åŒ–å¹¶å‘çš„å–æ¶ˆè¯­ä¹‰</strong></h4>
<p>æœªæ­£ç¡®å¤„ç†<code>ShutdownOnFailure()</code>å¯èƒ½å¯¼è‡´èµ„æºæ³„æ¼ï¼š</p>
<pre><code class="hljs language-java" lang="java">scope.fork(() -&gt; {
    <span class="hljs-keyword">try</span> (<span class="hljs-type">var</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> acquireDbConn()) { <span class="hljs-comment">// AutoCloseableå¿…é¡»!</span>
        <span class="hljs-keyword">return</span> query(connection);
    }
});
</code></pre>
<hr/>
<h3 data-id="heading-12">JVMè°ƒä¼˜å»ºè®®</h3>
<ol>
<li><strong>è½½ä½“ç·šç¨‹æ•°é…ç½®</strong>:
<pre><code class="hljs language-bash" lang="bash">-Djdk.virtualThreadScheduler.parallelism=CPUæ ¸å¿ƒæ•°*2 
</code></pre>
</li>
<li><strong>å†…å­˜åˆ†é…</strong>: Virtual threads have <del>1KB stack vså¹³å°thread'sé»˜è®¤</del>1MB</li>
<li><strong>ç›‘æ§</strong>: JDK Flight Recorderæ–°å¢è™›æ“¬ç·šç¨‹äº‹ä»¶:
<pre><code class="hljs language-ini" lang="ini">jcmd &lt;pid&gt; JFR.start <span class="hljs-attr">settings</span>=profile filename=vthread.jfr
</code></pre>
</li>
</ol>
<hr/>
<h3 data-id="heading-13">Conclusion</h3>
<p>Java21çš„è™›æ“¬ç·šç¨‹ä¸¦ééŠ€å½ˆ(A silver bullet)ï¼Œä½†æ­£ç¢ºä½¿ç”¨æ™‚èƒ½å°‡åŒæ­¥ä»£ç¢¼çš„ç°¡å–®æ€§èˆ‡ç•°æ­¥ç³»çµ±çš„é«˜æ•ˆæ€§å®Œç¾çµåˆã€‚æœ¬æ–‡å±•ç¤ºçš„7å€‹é‡æ§‹æ¨¡å¼è¦†è“‹äº†IOå¯†é›†ã€ä¸¦è¡Œè¨ˆç®—ç­‰å…¸å‹å ´æ™¯â€”â€”é—œéµåœ¨äºè­˜åˆ¥çœŸå¯¦é˜»å¡é»ä¸¦çµåˆStructured Concurrencyç­‰æ–°ç‰¹æ€§è¦é¿é¢¨éšªã€‚å±•æœ›æœªä¾†éš¨è‘—ç”Ÿæ…‹ç³»çµ±å°è™›æ“¬ç·šç¨‹é©é…å®Œæˆ(å¦‚Hibernate6.xå·²æ”¯æŒ)ï¼Œé€™é …æŠ€è¡“æˆ–å°‡é‡å¡‘Javaæœå‹™ç«¯é–‹ç™¼ç¯„å¼ã€‚</p>
<p>å°æ–¼ç¾æœ‰ç³»çµ±é·ç§»å»ºè­°æ¡ç”¨æ¼¸é€²å¼ç­–ç•¥:å¾é‚Šç·£æœå‹™é–‹å§‹é©—è­‰â†’æ ¸å¿ƒç„¡ç‹€æ…‹æœå‹™â†’æœ€çµ‚æ“´å±•è‡³æ•¸æ“šå±¤è¨ªå•æ¨¡å¡Š(middle-out migration)ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Reactä½¿ç”¨useLayoutEffectè§£å†³æ“ä½œDOMé¡µé¢é—ªçƒé—®é¢˜]]></title>    <link>https://juejin.cn/post/7587672626757648403</link>    <guid>https://juejin.cn/post/7587672626757648403</guid>    <pubDate>2025-12-26T00:31:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587672626757648403" data-draft-id="7576470438581272602" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Reactä½¿ç”¨useLayoutEffectè§£å†³æ“ä½œDOMé¡µé¢é—ªçƒé—®é¢˜"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,React.js"/> <meta itemprop="datePublished" content="2025-12-26T00:31:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¹å¤šå¤š"/> <meta itemprop="url" content="https://juejin.cn/user/747323639737191"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Reactä½¿ç”¨useLayoutEffectè§£å†³æ“ä½œDOMé¡µé¢é—ªçƒé—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/747323639737191/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¹å¤šå¤š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T00:31:09.000Z" title="Fri Dec 26 2025 00:31:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:2;font-weight:400;font-size:15px;overflow-x:hidden;color:#333;letter-spacing:1.2px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child{margin-top:-1.5rem;margin-bottom:1rem}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{position:relative;font-size:2.5rem;margin-bottom:5px}.markdown-body h1:before{font-size:2.5rem}.markdown-body h2{padding-bottom:.5rem;font-size:2.2rem;border-bottom:1px solid #ececec}.markdown-body h3{font-size:1.5rem;padding-bottom:0}.markdown-body h4{font-size:1.25rem}.markdown-body h5{font-size:1rem}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body strong{color:#3eaf7c}.markdown-body img{max-width:100%;border-radius:2px;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #3eaf7c;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;padding:.2rem .5rem;margin:0;color:#3eaf7c;font-size:.85em;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:.5rem solid #3eaf7c}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{font-weight:500;text-decoration:none;color:#3eaf7c;margin:0 5px}.markdown-body a:active,.markdown-body a:hover{text-decoration:none;border-bottom:1.5px solid #3eaf7c}.markdown-body a[href^=http]:after{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04MzIgMTI4SDY0MHY2NGgxNDYuNzUyTDUyMS4zNzYgNDU3LjM3Nmw0NS4yNDggNDUuMjQ4TDgzMiAyMzcuMjQ4VjM4NGg2NFYxMjh6IiBmaWxsPSIjM2VhZjdjIi8+PHBhdGggZD0iTTc2OCA4MzJIMTkyVjI1NmgzNTJ2LTY0SDE2MGEzMiAzMiAwIDAwLTMyIDMydjY0MGEzMiAzMiAwIDAwMzIgMzJoNjQwYTMyIDMyIDAgMDAzMi0zMlY0ODBoLTY0djM1MnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");margin-left:2px}.markdown-body a[href^="#"]:before{content:"#"}.markdown-body table{display:inline-block!important;font-size:13px;width:auto;max-width:100%;overflow:auto;border:1px solid #3eaf7c;border-collapse:collapse}.markdown-body thead{background:#3eaf7c;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:4px 8px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#7b7878;padding:1px 23px;border-left:.5rem solid;border-color:#42b983;background-color:rgba(66,184,131,.1);position:relative;margin:14px 8px 0}.markdown-body blockquote:before{display:inline-block;position:absolute;content:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUiIGhlaWdodD0iMjUiIHZpZXdCb3g9IjAgMCAyNyAyNyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjg2MiAxLjg2MikiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0ibm9uZSI+PGNpcmNsZSBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMS43MjQiIGZpbGw9IiM0MkI5ODMiIGN4PSIxMS42MzgiIGN5PSIxMS42MzgiIHI9IjExLjYzOCIvPjxwYXRoIGQ9Ik0xNC45NzggNi4yN0E1LjAwNiA1LjAwNiAwIDAwNi42NyA5LjQ2OGE0LjkwMSA0LjkwMSAwIDAwMS43NzMgNC4zNjJjLjMyMy4yNTguNTE0LjY0Ny41MjIgMS4wNnYxLjA2YTIuNjg1IDIuNjg1IDAgMDA1LjM3IDB2LTEuMDA4Yy4wMDItLjM5OC4xNzMtLjc3Ny40Ny0xLjA0MmE1LjAyMyA1LjAyMyAwIDAwLjE3My03LjYzem0tMy4zMzcgMTAuOTY3YTEuMzA0IDEuMzA0IDAgMDEtMS4yODYtMS4yODd2LS4yNzhoMi41NzJ2LjI2MWMwIC43MTMtLjU3MyAxLjI5NC0xLjI4NiAxLjMwNHptMi4yNi00LjQxNWMtLjQ0LjM4My0uNzUuODkzLS44ODcgMS40NmgtMi43NDZhMi44NjggMi44NjggMCAwMC0uOTM4LTEuNTNoLS4wMThhMy40NzYgMy40NzYgMCAwMS0xLjI2OS0zLjE0NSAzLjYxNSAzLjYxNSAwIDAxNy4xOTYuNCAzLjY1IDMuNjUgMCAwMS0xLjMzOCAyLjgxNXoiIGZpbGw9IiNGRkYiLz48L2c+PC9zdmc+");width:25px;height:25px;left:-16px;top:12px}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{outline:none;border:none;border-left:4px solid #3eaf7c;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary::-webkit-details-marker{color:#3eaf7c}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ol li::marker{color:#3eaf7c}.markdown-body ul li{list-style:none;padding-left:10px}.markdown-body ul li::marker{content:"â€¢";color:#3eaf7c}.markdown-body ul li.task-list-item:before{content:"";margin-right:0}.markdown-body input[type=checkbox]{vertical-align:text-bottom;box-shadow:inset 0 0 0 10px #fff}.markdown-body input[type=checkbox]:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04NzcuMDU2IDE0Ni45NDR2NzMwLjExMkgxNDYuOTQ0VjE0Ni45NDRoNzMwLjExMnptMC0xMDQuMjc3SDE0Ni45NDRjLTU3LjYyOCAwLTEwNC4yNzcgNDYuNjQ5LTEwNC4yNzcgMTA0LjI3N3Y3MzAuMTEyYzAgNTcuNjI4IDQ2LjY0OSAxMDQuMjc3IDEwNC4yNzcgMTA0LjI3N2g3MzAuMTEyYzU3LjYyOCAwIDEwNC4yNzctNDYuNjQ5IDEwNC4yNzctMTA0LjI3N1YxNDYuOTQ0YzAtNTcuNjI4LTQ2LjY0OS0xMDQuMjc3LTEwNC4yNzctMTA0LjI3N3oiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}.markdown-body input[type=checkbox]:checked:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik05MTAuMjA4IDBIMTEzLjc2QTExNC4xMTIgMTE0LjExMiAwIDAwLS4wMzIgMTEzLjc5MlY5MTAuMjRjMCA2Mi41OTIgNTEuMiAxMTMuNzkyIDExMy43OTIgMTEzLjc5Mmg3OTYuNDQ4YzYyLjU5MiAwIDExMy43OTItNTEuMiAxMTMuNzkyLTExMy43OTJWMTEzLjc5MkMxMDI0IDUxLjIgOTcyLjggMCA5MTAuMjA4IDB6bS01MTIgNzk2LjQ0OEwxMTMuNzYgNTEybDc5LjY0OC03OS42NDggMjA0LjggMjA0LjhMODMwLjU2IDIwNC44bDc5LjY0OCA3OS42NDgtNTEyIDUxMnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><h2 data-id="heading-0">1. æ¦‚è¿°</h2>
<p><code>useLayoutEffect</code> æ˜¯ React ä¸­ç”¨äºå¤„ç†å‰¯ä½œç”¨çš„ Hook ä¹‹ä¸€ï¼Œå®ƒä¸ <code>useEffect</code> åŠŸèƒ½ç›¸ä¼¼ï¼Œä½†æ‰§è¡Œæ—¶æœºæœ‰ç€æ˜¾è‘—å·®å¼‚ã€‚<code>useLayoutEffect</code> ä¼šåœ¨æ‰€æœ‰çš„ DOM å˜æ›´ä¹‹ååŒæ­¥æ‰§è¡Œï¼Œè¿™ä¸€ç‰¹æ€§ä½¿å…¶ç‰¹åˆ«é€‚åˆç”¨äºéœ€è¦åŸºäºæœ€æ–° DOM ç»“æ„è¿›è¡Œæ“ä½œçš„åœºæ™¯ï¼Œä¾‹å¦‚è·å–å…ƒç´ å°ºå¯¸ã€æ“ä½œ DOM æ ·å¼ç­‰ï¼Œèƒ½æœ‰æ•ˆé¿å…å› å¼‚æ­¥æ‰§è¡Œå¯¼è‡´çš„è§†è§‰é—ªçƒæˆ–å¸ƒå±€æŠ–åŠ¨é—®é¢˜ï¼Œç¡®ä¿é¡µé¢æ¸²æŸ“çš„ç¨³å®šæ€§å’Œä¸€è‡´æ€§ã€‚</p>
<h2 data-id="heading-1">2. åŸºæœ¬åŸç†ä¸è¯­æ³•</h2>
<p><code>useLayoutEffect</code> çš„åŸç†åŸºäº React çš„æ¸²æŸ“æœºåˆ¶ã€‚åœ¨ React è¿›è¡Œç»„ä»¶æ¸²æŸ“æ—¶ï¼Œä¼šå…ˆæ„å»ºè™šæ‹Ÿ DOMï¼Œè®¡ç®—å‡ºéœ€è¦æ›´æ–°çš„éƒ¨åˆ†ï¼Œç„¶åå°†è¿™äº›æ›´æ–°åº”ç”¨åˆ°çœŸå® DOM ä¸Šã€‚<code>useLayoutEffect</code> æ°å¥½åœ¨çœŸå® DOM æ›´æ–°å®Œæˆï¼Œä½†æµè§ˆå™¨å°šæœªè¿›è¡Œç»˜åˆ¶ä¹‹å‰æ‰§è¡Œï¼Œè¿™å°±ä¿è¯äº†å¼€å‘è€…å¯ä»¥åœ¨è¿™ä¸ªé˜¶æ®µå®‰å…¨åœ°è®¿é—®å’Œæ“ä½œæœ€æ–°çš„ DOM ç»“æ„ã€‚</p>
<p>åœ¨è¯­æ³•ä½¿ç”¨ä¸Šï¼Œ<code>useLayoutEffect</code> éœ€è¦ä» <code>react</code> åº“ä¸­å¯¼å…¥ï¼Œå®ƒæ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°ä¸­å¯ä»¥ç¼–å†™å‰¯ä½œç”¨é€»è¾‘ã€‚åŒæ—¶ï¼Œ<code>useLayoutEffect</code> ä¹Ÿæ”¯æŒç¬¬äºŒä¸ªå¯é€‰å‚æ•°ï¼Œå³ä¾èµ–é¡¹æ•°ç»„ï¼Œç”¨äºæ§åˆ¶å‰¯ä½œç”¨çš„é‡æ–°æ‰§è¡Œæ—¶æœºã€‚å…¶è¯­æ³•ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useLayoutEffect, useState } <span class="hljs-keyword">from</span><span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);
  <span class="hljs-title function_">useLayoutEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">`Count is <span class="hljs-subst">${count}</span>`</span>;
  }, [count]);
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count + 1)}&gt;Increment<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ<code>useLayoutEffect</code> ä¼šåœ¨æ¯æ¬¡ <code>count</code> çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œä¸” DOM å·²æ›´æ–°åï¼Œç«‹å³æ›´æ–°é¡µé¢çš„æ ‡é¢˜ã€‚ä¾èµ–é¡¹æ•°ç»„ <code>[count]</code> ç¡®ä¿åªæœ‰å½“ <code>count</code> æ”¹å˜æ—¶ï¼Œ<code>useLayoutEffect</code> çš„å›è°ƒå‡½æ•°æ‰ä¼šé‡æ–°æ‰§è¡Œã€‚</p>
<h2 data-id="heading-2">3. åº”ç”¨åœºæ™¯</h2>
<p>ä¸‹é¢æ˜¯ä¸€äº›å®é™…çš„åº”ç”¨åœºæ™¯ï¼š</p>
<h3 data-id="heading-3">3.1 è·å–å…ƒç´ å°ºå¯¸å’Œä½ç½®</h3>
<p>åœ¨å¼€å‘å›¾è¡¨ã€æ‹–æ‹½äº¤äº’ç­‰åŠŸèƒ½æ—¶ï¼Œå¸¸å¸¸éœ€è¦è·å–å…ƒç´ çš„å°ºå¯¸å’Œä½ç½®ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªåŠ¨æ€ç”Ÿæˆçš„æŸ±çŠ¶å›¾ç»„ä»¶ä¸­ï¼Œæ¯ä¸ªæŸ±å­çš„é«˜åº¦éœ€è¦æ ¹æ®æ•°æ®åŠ¨æ€è®¡ç®—å¹¶è®¾ç½®ã€‚é€šè¿‡ <code>useLayoutEffect</code>ï¼Œå¯ä»¥åœ¨ç»„ä»¶æ¸²æŸ“å®Œæˆåï¼Œç«‹å³è·å–å®¹å™¨å…ƒç´ çš„å°ºå¯¸ï¼Œå†æ ¹æ®æ•°æ®è®¡ç®—æŸ±å­é«˜åº¦å¹¶è®¾ç½®ç›¸åº”çš„æ ·å¼ï¼Œä¿è¯å›¾è¡¨èƒ½å¤Ÿå‡†ç¡®æ¸²æŸ“ï¼Œé¿å…å› å¼‚æ­¥è®¡ç®—å¯¼è‡´çš„å›¾è¡¨é—ªçƒé—®é¢˜ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useLayoutEffect, useState, useRef } <span class="hljs-keyword">from</span><span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">BarChart</span>(<span class="hljs-params">{ data }</span>) {
  <span class="hljs-keyword">const</span> chartRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [barHeights, setBarHeights] = <span class="hljs-title function_">useState</span>([]);

  <span class="hljs-title function_">useLayoutEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (chartRef.<span class="hljs-property">current</span>) {
      <span class="hljs-keyword">const</span> containerWidth = chartRef.<span class="hljs-property">current</span>.<span class="hljs-property">offsetWidth</span>;
      <span class="hljs-keyword">const</span> newBarHeights = data.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
        <span class="hljs-comment">// ç®€å•è®¡ç®—æŸ±å­é«˜åº¦ï¼Œå®é™…åº”ç”¨ä¸­æ›´å¤æ‚</span>
        <span class="hljs-keyword">return</span> (value / <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(...data)) * containerWidth;
      });
      <span class="hljs-title function_">setBarHeights</span>(newBarHeights);
    }
  }, [data]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{chartRef}</span>&gt;</span>
      {data.map((_, index) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
          <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span>
          <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
            <span class="hljs-attr">width:</span> '<span class="hljs-attr">20px</span>',
            <span class="hljs-attr">height:</span> `${<span class="hljs-attr">barHeights</span>[<span class="hljs-attr">index</span>]}<span class="hljs-attr">px</span>`,
            <span class="hljs-attr">backgroundColor:</span> '<span class="hljs-attr">blue</span>',
            <span class="hljs-attr">marginRight:</span> '<span class="hljs-attr">5px</span>',
            <span class="hljs-attr">display:</span> '<span class="hljs-attr">inline-block</span>'
          }}
        /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">BarChart</span>;
</code></pre>
<h3 data-id="heading-4">3.2 å¼ºåˆ¶åŒæ­¥æ›´æ–° DOM æ ·å¼</h3>
<p>å½“éœ€è¦æ ¹æ®çŠ¶æ€å˜åŒ–ç«‹å³æ›´æ–° DOM æ ·å¼ï¼Œä¸”ä¸å¸Œæœ›å‡ºç°è§†è§‰å»¶è¿Ÿæ—¶ï¼Œ<code>useLayoutEffect</code> æ˜¯æœ€ä½³é€‰æ‹©ã€‚æ¯”å¦‚åœ¨å®ç°ä¸€ä¸ªä¸»é¢˜åˆ‡æ¢åŠŸèƒ½æ—¶ï¼Œç”¨æˆ·ç‚¹å‡»åˆ‡æ¢ä¸»é¢˜æŒ‰é’®åï¼Œé¡µé¢çš„æ•´ä½“æ ·å¼éœ€è¦ç«‹å³æ”¹å˜ã€‚åˆ©ç”¨ <code>useLayoutEffect</code>ï¼Œå¯ä»¥åœ¨çŠ¶æ€æ›´æ–°åï¼ŒåŒæ­¥ä¿®æ”¹ DOM çš„æ ·å¼ç±»åæˆ–ç›´æ¥è®¾ç½®å†…è”æ ·å¼ï¼Œç¡®ä¿ç”¨æˆ·èƒ½å³æ—¶çœ‹åˆ°ä¸»é¢˜åˆ‡æ¢æ•ˆæœï¼Œä¸ä¼šå‡ºç°çŸ­æš‚çš„æ ·å¼é”™ä¹±ã€‚</p>
<h3 data-id="heading-5">3.3 å¤„ç†æµè§ˆå™¨äº‹ä»¶ä¸ DOM äº¤äº’</h3>
<p>åœ¨ç»‘å®šå’Œå¤„ç†ä¸€äº›ä¸ DOM ç´§å¯†ç›¸å…³çš„æµè§ˆå™¨äº‹ä»¶æ—¶ï¼Œ<code>useLayoutEffect</code> èƒ½ç¡®ä¿äº‹ä»¶ç»‘å®šåœ¨æ­£ç¡®çš„ DOM ç»“æ„ä¸Šã€‚ä¾‹å¦‚ï¼Œä¸ºä¸€ä¸ªå¯æ»šåŠ¨çš„åˆ—è¡¨æ·»åŠ æ»šåŠ¨äº‹ä»¶ç›‘å¬å™¨ï¼Œéœ€è¦åœ¨åˆ—è¡¨æ¸²æŸ“å®Œæˆåè¿›è¡Œç»‘å®šã€‚ä½¿ç”¨ <code>useLayoutEffect</code> å¯ä»¥åœ¨ DOM æ›´æ–°åç«‹å³ç»‘å®šæ»šåŠ¨äº‹ä»¶ï¼Œå¹¶ä¸”åœ¨ç»„ä»¶å¸è½½æ—¶æ­£ç¡®ç§»é™¤äº‹ä»¶ç›‘å¬å™¨ï¼Œé¿å…å†…å­˜æ³„æ¼ï¼Œä¿è¯äº¤äº’åŠŸèƒ½çš„ç¨³å®šæ€§ã€‚</p>
<h2 data-id="heading-6">4. ä¸å…¶ä»–ç›¸å…³Hookçš„å¯¹æ¯”</h2>
<p>åœ¨ React çš„ Hook ä½“ç³»ä¸­ï¼Œ<code>useLayoutEffect</code> ä¸ <code>useEffect</code> æœ€ä¸ºç›¸ä¼¼ï¼Œä½†å®ƒä»¬çš„æ‰§è¡Œæ—¶æœºå†³å®šäº†ä¸åŒçš„åº”ç”¨åœºæ™¯ã€‚<code>useEffect</code> ä¼šåœ¨æµè§ˆå™¨å®Œæˆç»˜åˆ¶åå¼‚æ­¥æ‰§è¡Œï¼Œé€‚ç”¨äºä¸å½±å“é¡µé¢è§†è§‰æ•ˆæœçš„å‰¯ä½œç”¨æ“ä½œï¼Œå¦‚æ•°æ®è¯·æ±‚ã€è®¢é˜…äº‹ä»¶ç­‰ã€‚ä¾‹å¦‚ï¼Œä» API è·å–æ•°æ®å¹¶æ›´æ–°ç»„ä»¶çŠ¶æ€ï¼Œè¿™ç§æ“ä½œä¸éœ€è¦å³æ—¶åé¦ˆç»™ç”¨æˆ·ï¼Œä½¿ç”¨ <code>useEffect</code> ä¸ä¼šå½±å“é¡µé¢çš„æµç•…åº¦ã€‚</p>
<p>è€Œ <code>useLayoutEffect</code> ç”±äºåŒæ­¥æ‰§è¡Œçš„ç‰¹æ€§ï¼Œå¦‚æœåœ¨å…¶å›è°ƒå‡½æ•°ä¸­æ‰§è¡Œå¤æ‚è®¡ç®—æˆ–è€—æ—¶æ“ä½œï¼Œå¯èƒ½ä¼šé˜»å¡æµè§ˆå™¨çš„æ¸²æŸ“ï¼Œå¯¼è‡´é¡µé¢å¡é¡¿ã€‚å› æ­¤ï¼Œåœ¨é€‰æ‹©ä½¿ç”¨æ—¶ï¼Œå¼€å‘è€…éœ€è¦æ ¹æ®å‰¯ä½œç”¨æ“ä½œæ˜¯å¦ä¸ DOM æ¸²æŸ“ç´§å¯†ç›¸å…³ï¼Œä»¥åŠæ˜¯å¦å¯¹å³æ—¶æ€§æœ‰è¦æ±‚æ¥å†³å®šä½¿ç”¨ <code>useLayoutEffect</code> è¿˜æ˜¯ <code>useEffect</code>ã€‚</p>
<p>æ­¤å¤–ï¼Œ<code>useLayoutEffect</code> ä¸ <code>useState</code>ã€<code>useReducer</code> ç­‰çŠ¶æ€ç®¡ç† Hook ä¹Ÿæœ‰æ‰€ä¸åŒã€‚<code>useState</code> å’Œ <code>useReducer</code> ä¸»è¦ç”¨äºç®¡ç†ç»„ä»¶çš„çŠ¶æ€ï¼Œè€Œ <code>useLayoutEffect</code> ä¸“æ³¨äºå¤„ç†ä¸çŠ¶æ€å˜åŒ–ç›¸å…³çš„å‰¯ä½œç”¨ï¼Œå®ƒä»¬åœ¨ React åº”ç”¨å¼€å‘ä¸­æ‰¿æ‹…ç€ä¸åŒçš„è§’è‰²ï¼Œç›¸äº’é…åˆä»¥å®ç°ä¸°å¯Œçš„åŠŸèƒ½ã€‚</p>
<h2 data-id="heading-7">5. ç»“åˆå…¶ä»–Hookä½¿ç”¨</h2>
<p><code>useLayoutEffect</code> å¯ä»¥ä¸å…¶ä»– Hook çµæ´»ç»“åˆä½¿ç”¨ï¼Œä»¥æ»¡è¶³æ›´å¤æ‚çš„éœ€æ±‚ã€‚ä¾‹å¦‚ï¼Œä¸ <code>useRef</code> ç»“åˆå¯ä»¥æ›´æ–¹ä¾¿åœ°æ“ä½œ DOM å…ƒç´ ã€‚åœ¨ä¸€ä¸ªå®ç°è‡ªåŠ¨èšç„¦çš„è¾“å…¥æ¡†ç»„ä»¶ä¸­ï¼Œé€šè¿‡ <code>useRef</code> è·å–è¾“å…¥æ¡†å…ƒç´ çš„å¼•ç”¨ï¼Œå†åˆ©ç”¨ <code>useLayoutEffect</code> åœ¨ç»„ä»¶æ¸²æŸ“å®Œæˆåç«‹å³å°†ç„¦ç‚¹è®¾ç½®åˆ°è¾“å…¥æ¡†ä¸Šï¼Œå®ç°ç”¨æˆ·è¿›å…¥é¡µé¢å³å¯ç›´æ¥è¾“å…¥çš„æ•ˆæœã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useLayoutEffect, useRef } <span class="hljs-keyword">from</span><span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">AutoFocusInput</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> inputRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-title function_">useLayoutEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (inputRef.<span class="hljs-property">current</span>) {
      inputRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">focus</span>();
    }
  }, []);
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{inputRef}</span> /&gt;</span></span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">AutoFocusInput</span>;
</code></pre>
<p>åŒæ—¶ï¼Œ<code>useLayoutEffect</code> ä¹Ÿèƒ½å’Œ <code>useState</code> é…åˆï¼Œåœ¨çŠ¶æ€æ›´æ–°ååŸºäºæœ€æ–° DOM è¿›è¡Œæ“ä½œã€‚æ¯”å¦‚åœ¨ä¸€ä¸ªå¯æŠ˜å é¢æ¿ç»„ä»¶ä¸­ï¼Œå½“é¢æ¿å±•å¼€æˆ–æ”¶èµ·çš„çŠ¶æ€æ”¹å˜æ—¶ï¼Œ<code>useLayoutEffect</code> å¯ä»¥åœ¨ DOM æ›´æ–°åè·å–é¢æ¿çš„é«˜åº¦ç­‰ä¿¡æ¯ï¼Œç”¨äºå®ç°è¿‡æ¸¡åŠ¨ç”»æˆ–å…¶ä»–äº¤äº’æ•ˆæœã€‚</p>
<h2 data-id="heading-8">6. æ³¨æ„äº‹é¡¹</h2>
<ul>
<li>é¿å…åœ¨ <code>useLayoutEffect</code> ä¸­æ‰§è¡Œé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡æˆ–å¤æ‚è®¡ç®—ï¼Œå› ä¸ºå®ƒä¼šé˜»å¡æµè§ˆå™¨çš„æ¸²æŸ“çº¿ç¨‹ï¼Œå¯¼è‡´é¡µé¢å¡é¡¿ï¼Œå½±å“ç”¨æˆ·ä½“éªŒã€‚å¦‚æœæœ‰å¤æ‚è®¡ç®—éœ€æ±‚ï¼Œå°½é‡å°†å…¶æ”¾åœ¨ <code>useEffect</code> æˆ–å…¶ä»–å¼‚æ­¥æ“ä½œä¸­è¿›è¡Œã€‚</li>
<li>åˆç†ä½¿ç”¨ä¾èµ–é¡¹æ•°ç»„ï¼Œç¡®ä¿ <code>useLayoutEffect</code> çš„å›è°ƒå‡½æ•°åœ¨æ­£ç¡®çš„æ—¶æœºé‡æ–°æ‰§è¡Œã€‚é”™è¯¯è®¾ç½®ä¾èµ–é¡¹æ•°ç»„å¯èƒ½ä¼šå¯¼è‡´å‰¯ä½œç”¨æ‰§è¡Œæ¬¡æ•°è¿‡å¤šæˆ–è¿‡å°‘ï¼Œå¼•å‘éš¾ä»¥æ’æŸ¥çš„é—®é¢˜ã€‚</li>
<li>ç”±äº <code>useLayoutEffect</code> ä¼šåœ¨ DOM æ›´æ–°åç«‹å³æ‰§è¡Œï¼Œé¢‘ç¹è§¦å‘å¯èƒ½ä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜ã€‚åœ¨è®¾è®¡ç»„ä»¶é€»è¾‘æ—¶ï¼Œè¦å°½é‡å‡å°‘ä¸å¿…è¦çš„ <code>useLayoutEffect</code> è°ƒç”¨ï¼Œæˆ–è€…é€šè¿‡ä¼˜åŒ–é€»è¾‘å‡å°‘å…¶æ‰§è¡Œé¢‘ç‡ã€‚</li>
<li>å½“ <code>useLayoutEffect</code> ä¸­åŒ…å«äº‹ä»¶ç›‘å¬å™¨ç­‰èµ„æºæ—¶ï¼Œä¸€å®šè¦åœ¨ç»„ä»¶å¸è½½æ—¶æ­£ç¡®æ¸…ç†ï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚é€šå¸¸å¯ä»¥åœ¨ <code>useLayoutEffect</code> è¿”å›çš„æ¸…ç†å‡½æ•°ä¸­ç§»é™¤äº‹ä»¶ç›‘å¬å™¨æˆ–å–æ¶ˆè®¢é˜…ç­‰æ“ä½œã€‚</li>
</ul>
<hr/>
<blockquote>
<p>æœ¬æ¬¡åˆ†äº«å°±åˆ°è¿™å„¿å•¦ï¼Œæˆ‘æ˜¯é¹å¤šå¤šï¼Œæ·±è€•å‰ç«¯çš„æŠ€æœ¯åˆ›ä½œè€…ï¼Œå¦‚æœæ‚¨çœ‹äº†è§‰å¾—æœ‰å¸®åŠ©ï¼Œæ¬¢è¿è¯„è®ºï¼Œå…³æ³¨ï¼Œç‚¹èµï¼Œè½¬å‘ï¼Œæˆ‘ä»¬ä¸‹æ¬¡è§~</p>
</blockquote>
<p>PSï¼šåœ¨æœ¬é¡µæŒ‰F12ï¼Œåœ¨consoleä¸­è¾“å…¥document.getElementsByClassName('panel-btn')[0].click();æœ‰æƒŠå–œå“¦~</p>
<p><code>å¾€æœŸæ–‡ç« </code></p>
<ul>
<li><a href="https://juejin.cn/post/7568192652286754870" target="_blank" title="https://juejin.cn/post/7568192652286754870">çº¯å‰ç«¯æå–å›¾ç‰‡é¢œè‰²æ’ä»¶Color-Thiefæ•™å­¦+å®æˆ˜å®Œæ•´æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7565737512816771135" target="_blank" title="https://juejin.cn/post/7565737512816771135">react-konvaå®æˆ˜æŒ‡å—ï¼šCanvasé«˜æ€§èƒ½+æ˜“ç»´æŠ¤çš„ç»„ä»¶åŒ–å›¾å½¢å¼€å‘å®ç°æ•™ç¨‹</a></li>
<li><a href="https://juejin.cn/post/7560905838074462271" target="_blank" title="https://juejin.cn/post/7560905838074462271">Reactæ— é™æ»šåŠ¨æ’ä»¶react-infinite-scroll-componentçš„é…ç½®+ä¼˜åŒ–+é¿å‘æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7560542615484137491" target="_blank" title="https://juejin.cn/post/7560542615484137491">å‰ç«¯éŸ³é¢‘å…¼å®¹è§£å†³ï¼šéŸ³é¢‘ç¥å™¨howler.jsä»åŸºç¡€åˆ°è¿›é˜¶å®Œæ•´ä½¿ç”¨æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7559871680015024169" target="_blank" title="https://juejin.cn/post/7559871680015024169">ä½¿ç”¨React-OAuthè¿›è¡ŒGoogle/GitHubç™»å½•çš„æ•™ç¨‹å’Œæ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7550585427834404927" target="_blank" title="https://juejin.cn/post/7550585427834404927">çº¯å‰ç«¯äººè„¸è¯†åˆ«åˆ©å™¨ï¼šface-api.jsæ‰‹æŠŠæ‰‹æ·±å…¥è§£ææ•™å­¦</a></li>
<li><a href="https://juejin.cn/post/7553865490732433462" target="_blank" title="https://juejin.cn/post/7553865490732433462">å…³äºReactçˆ¶ç»„ä»¶è°ƒç”¨å­ç»„ä»¶æ–¹æ³•forwardRefçš„è¯¦è§£å’Œæ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7553484874609410074" target="_blank" title="https://juejin.cn/post/7553484874609410074">Reactè·¨ç»„ä»¶æ•°æ®å…±äº«useContextè¯¦è§£å’Œæ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7545087762837815334" target="_blank" title="https://juejin.cn/post/7545087762837815334">Webå›¾åƒç¼–è¾‘ç¥å™¨tui.image-editorä»åŸºç¡€åˆ°è¿›é˜¶çš„å®æˆ˜æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7544323659788288046" target="_blank" title="https://juejin.cn/post/7544323659788288046">å¼€å‘ä¸ªäººå¾®ä¿¡å°ç¨‹åºç±»ç›®é€‰æ‹©/ç›ˆåˆ©æ–¹å¼/æˆæœ¬æ§åˆ¶ä¸æœåŠ¡å™¨æ¥å…¥æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7541741121400864778" target="_blank" title="https://juejin.cn/post/7541741121400864778">å‰ç«¯å›¾ç‰‡è£å‰ªCropper.jsæ ¸å¿ƒåŠŸèƒ½ä¸å®æˆ˜æŠ€å·§è¯¦è§£</a></li>
<li><a href="https://juejin.cn/post/7536530451461472265" target="_blank" title="https://juejin.cn/post/7536530451461472265">ç¼–è¾‘å™¨ä¹Ÿæœ‰é‚ªä¿®ï¼Ÿç›˜ç‚¹VS Codeé‚ªé—¨/æœ‰è¶£çš„æ‰©å±•</a></li>
<li><a href="https://juejin.cn/post/7535005018257981466" target="_blank" title="https://juejin.cn/post/7535005018257981466">jsä½¿ç”¨IntersectionObserverå®ç°ç›®æ ‡å…ƒç´ å¯è§åº¦çš„äº¤äº’</a></li>
<li><a href="https://juejin.cn/post/7534547200330121225" target="_blank" title="https://juejin.cn/post/7534547200330121225">Webå‰ç«¯é¡µé¢å¼€å‘é˜¿æ‹‰ä¼¯è¯­ç§é€‚é…æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7516122409948020736" target="_blank" title="https://juejin.cn/post/7516122409948020736">è®©ç½‘é¡µæ‹¥æœ‰Appä½“éªŒï¼ŸPWA å°†ç½‘é¡µå˜ä¸ºæ¡Œé¢åº”ç”¨çš„ä¿å§†çº§æ•™ç¨‹PWA</a></li>
<li><a href="https://juejin.cn/post/6953803916484018206" target="_blank" title="https://juejin.cn/post/6953803916484018206">ä½¿ç”¨nvmç®¡ç†node.jsç‰ˆæœ¬ä»¥åŠæ›´æ¢npmæ·˜å®é•œåƒæº</a></li>
<li><a href="https://juejin.cn/post/7140443283209060383" target="_blank" title="https://juejin.cn/post/7140443283209060383">æ‰‹æŠŠæ‰‹æ•™ä½ æ­å»ºè§„èŒƒçš„å›¢é˜Ÿvueé¡¹ç›®ï¼ŒåŒ…å«commitlintï¼Œeslintï¼Œprettierï¼Œhuskyï¼Œcommitizenç­‰ç­‰</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ·æ–°åç‚¹èµå…¨å˜ 0ï¼Ÿåˆ«æ€¥ç€æ€ª Redisï¼Œè¿™å…«æˆæ˜¯ Long è¢« JavaScript å·å·â€œæ”¹å·â€äº†ï¼ˆä¸€æ¬¡çº¿ä¸Šå¤ç›˜ï¼‰]]></title>    <link>https://juejin.cn/post/7587605704636121122</link>    <guid>https://juejin.cn/post/7587605704636121122</guid>    <pubDate>2025-12-25T16:08:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587605704636121122" data-draft-id="7587594077015523362" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ·æ–°åç‚¹èµå…¨å˜ 0ï¼Ÿåˆ«æ€¥ç€æ€ª Redisï¼Œè¿™å…«æˆæ˜¯ Long è¢« JavaScript å·å·â€œæ”¹å·â€äº†ï¼ˆä¸€æ¬¡çº¿ä¸Šå¤ç›˜ï¼‰"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-25T16:08:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="WanderInk"/> <meta itemprop="url" content="https://juejin.cn/user/4440283730679642"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ·æ–°åç‚¹èµå…¨å˜ 0ï¼Ÿåˆ«æ€¥ç€æ€ª Redisï¼Œè¿™å…«æˆæ˜¯ Long è¢« JavaScript å·å·â€œæ”¹å·â€äº†ï¼ˆä¸€æ¬¡çº¿ä¸Šå¤ç›˜ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4440283730679642/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    WanderInk
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T16:08:44.000Z" title="Thu Dec 25 2025 16:08:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åšç¤¾åŒºåŠŸèƒ½çš„äººï¼Œå¤šåŠéƒ½ç»å†è¿‡è¿™ç§æŠ“ç‹‚æ—¶åˆ»ï¼šä½ åœ¨å¸–å­ä¸Šç‚¹äº†ä¸ªèµï¼ŒæŒ‰é’®ç«‹åˆ»é«˜äº®ï¼Œæ•°å­—ä¹ŸåŠ ä¸€ï¼Œç”¨æˆ·ä½“éªŒçœ‹èµ·æ¥å¾ˆä¸æ»‘ï¼›å¯ä½ ä¸€åˆ·æ–°é¡µé¢ï¼Œç‚¹èµæ•°åƒè¢«äººæ¸…ç©ºäº†ä¸€æ ·ï¼Œå…¨éƒ¨å›åˆ° 0ã€‚ä½ æ‰“å¼€ Redis å®¢æˆ·ç«¯çœ‹ï¼Œè®¡æ•° key æ˜æ˜å­˜åœ¨ï¼Œå€¼ä¹Ÿä¸æ˜¯ 0ã€‚äºæ˜¯ä½ å¼€å§‹æ€€ç–‘ç¼“å­˜ä¸€è‡´æ€§ï¼Œæ€€ç–‘æ˜¯ä¸æ˜¯è¯»äº†å¦ä¸€å° Redisï¼Œæ€€ç–‘çº¿ä¸Š jar æ²¡æ›´æ–°ï¼Œç”šè‡³æ€€ç–‘è‡ªå·±æ˜¯ä¸æ˜¯åœ¨æ¢¦é‡Œå†™ä»£ç ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b8d082f11fc24aed8b8a6685e17893ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgV2FuZGVySW5r:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767283724&amp;x-signature=MjWhUtKbk4Bj7QcEhxY7HR0wfwU%3D" alt="ChatGPT Image 2025å¹´12æœˆ26æ—¥ 00_06_20.png" loading="lazy"/></p>
<p>æˆ‘å¾—è¯´ï¼Œè¿™ç±»é—®é¢˜æœ€é˜´çš„åœ°æ–¹å°±åœ¨äºå®ƒç‰¹åˆ«åƒç¼“å­˜é—®é¢˜ï¼Œå®é™…ä¸Šå´å¾€å¾€è·Ÿç¼“å­˜ä¸€ç‚¹å…³ç³»éƒ½æ²¡æœ‰ã€‚çœŸæ­£çš„å‡¶æ‰‹æ˜¯æ•°æ®ç±»å‹è¾¹ç•Œï¼Œå‡†ç¡®åœ°è¯´ï¼Œæ˜¯ Java çš„ long é›ªèŠ± id è¿›äº† JavaScript çš„ Number ä¸–ç•Œä»¥åè¶…è¿‡å®‰å…¨æ•´æ•°èŒƒå›´ï¼Œå‘ç”Ÿäº†ç²¾åº¦ä¸¢å¤±ï¼Œå¯¼è‡´ä½ ç‚¹èµå†™å…¥ç”¨çš„æ˜¯ä¸€ä¸ªâ€œè¢«å››èˆäº”å…¥åçš„ idâ€ï¼Œåˆ·æ–°è¯»å–ç”¨çš„åˆæ˜¯â€œçœŸå® idâ€ã€‚å†™å…¥å’Œè¯»å–å‹æ ¹ä¸æ˜¯åŒä¸€ä¸ªç›®æ ‡ï¼Œä½ æ¢åå° Redis ä¹Ÿæ•‘ä¸äº†ã€‚</p>
<p>æˆ‘å½“æ—¶å®šä½è¿™ä¸ªé—®é¢˜çš„åˆ‡å…¥ç‚¹å¾ˆæœ´ç´ ï¼Œä¸é çŒœï¼Œå…¨é è¯æ®ã€‚æŠŠæµè§ˆå™¨ Network æ‰“å¼€ï¼Œç›¯ä½ä¸¤å¤„å°±å¤Ÿäº†ï¼šåˆ—è¡¨æˆ–è€…è¯¦æƒ…æ¥å£è¿”å›çš„å¸–å­ idï¼Œå’Œç‚¹èµæ¥å£è¯·æ±‚è·¯å¾„é‡Œå¸¦çš„ idã€‚æ­£å¸¸æƒ…å†µä¸‹å®ƒä»¬åº”è¯¥ä¸€æ¨¡ä¸€æ ·ï¼Œå“ªæ€•å¤šä¸€ä¸ªå­—ç¬¦éƒ½ä¸è¡Œã€‚ç»“æœæˆ‘çœ‹åˆ°çš„éå¸¸åˆºçœ¼ï¼Œç‚¹èµè¯·æ±‚æ‰“çš„æ˜¯ <code>.../posts/2003003909205840000/like</code>ï¼Œåˆ—è¡¨è¿”å›çš„çœŸå® id å´æ˜¯ <code>2003003909205839874</code>ã€‚ä½ çœ‹è¿™ä¿©æ•°å­—å·®å¾—ä¸å¤šï¼Œç”šè‡³è‚‰çœ¼ä¸€æ»‘å¯èƒ½ä»¥ä¸ºä¸€æ ·ï¼Œä½†åœ¨ä¸šåŠ¡ä¸Šå®ƒä»¬å°±æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„å¸–å­ã€‚æ›´å…³é”®çš„æ˜¯ï¼Œè¿™ç§â€œå·®ä¸€ç‚¹ç‚¹â€çš„å·®æ³•ç‰¹åˆ«å…¸å‹ï¼Œæœ«å°¾è¢«æŠ¹å¹³ï¼Œè¢«å‡‘æ•´ï¼Œè¢«æ”¹å·ï¼Œè¿™æ˜¯ JavaScript ç²¾åº¦ä¸¢å¤±çš„æŒ‡çº¹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f2c6d3124f7b4c47a57ee7cec033c9b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgV2FuZGVySW5r:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767283724&amp;x-signature=2PaIjWrlNrAs7gFBgtxL5hH4js4%3D" alt="ChatGPT Image 2025å¹´12æœˆ26æ—¥ 00_06_50.png" loading="lazy"/></p>
<p>åŸå› åœ¨äº JavaScript çš„ Number æ˜¯åŒç²¾åº¦æµ®ç‚¹æ•°ï¼Œå®‰å…¨æ•´æ•°ä¸Šé™æ˜¯ 2^53-1ï¼Œä¹Ÿå°±æ˜¯ 9007199254740991ã€‚é›ªèŠ± id åŠ¨è¾„åå…«åä¹ä½ï¼Œæ—©å°±è¿œè¿œè¶…è¿‡è¿™ä¸ªèŒƒå›´ã€‚è¶…è¿‡ä¹‹åï¼ŒJS ä¸æ˜¯ç›´æ¥æŠ¥é”™ï¼Œå®ƒä¼šç”¨ä¸€ä¸ªæœ€æ¥è¿‘çš„å¯è¡¨ç¤ºå€¼æ¥å­˜ï¼Œäºæ˜¯ä½ ä»¥ä¸ºä½ æ‹¿åˆ°äº† 2003003909205839874ï¼Œå®é™…ä¸Šå®ƒåœ¨å†…å­˜é‡Œå·²ç»å˜æˆäº†å¦ä¸€ä¸ªç›¸é‚»ä½†ä¸åŒçš„æ•°ã€‚å‰ç«¯æŠŠè¿™ä¸ªâ€œå˜å½¢ idâ€æ‹¼è¿› URL å‘ç»™åç«¯ï¼Œåç«¯åˆæ˜¯å¼ºç±»å‹ä¸–ç•Œï¼Œæ”¶åˆ°ä»€ä¹ˆå°±å½“ä»€ä¹ˆï¼Œäºæ˜¯ Redis çš„ key å†™æˆ <code>forum:like:count:1:2003003909205840000</code>ï¼Œæ•°æ®åº“é‡Œ target_id ä¹Ÿå¯èƒ½è·Ÿç€å†™é”™ã€‚åˆ·æ–°é¡µé¢æ—¶ï¼Œåˆ—è¡¨æ¥å£ä»æ•°æ®åº“è¯»å‡ºçœŸå®å¸–å­ï¼Œå†æŠŠçœŸå® id è¿”å›ç»™å‰ç«¯ï¼Œå‰ç«¯ç”¨çœŸå® id å»æŸ¥è®¡æ•°ï¼Œå½“ç„¶æŸ¥ä¸åˆ°ï¼Œå› ä¸ºè®¡æ•°å…¨åœ¨å¦ä¸€ä¸ª id ä¸Šï¼Œäºæ˜¯ä½ çœ‹åˆ°çš„å°±æ˜¯â€œåˆ·æ–°åå…¨æ˜¯ 0â€ã€‚è¿™ä¸æ˜¯ç¼“å­˜ä¸ä¸€è‡´ï¼Œè¿™æ˜¯å†™é”™å¯¹è±¡äº†ï¼Œå±äºé€»è¾‘å±‚é¢å½»åº•é”™ä½ã€‚</p>
<p>è¿™ç§å‘ä¹‹æ‰€ä»¥å®¹æ˜“æŠŠäººå¸¦æ²Ÿé‡Œï¼Œæ˜¯å› ä¸ºç‚¹èµå½“ä¸‹çœ‹èµ·æ¥â€œç”Ÿæ•ˆâ€ã€‚å¾ˆå¤šå®ç°ä¼šåœ¨ç‚¹å‡»åå…ˆåšä¹è§‚æ›´æ–°ï¼ŒUI å…ˆåŠ ä¸€ï¼Œç»™ç”¨æˆ·å³æ—¶åé¦ˆã€‚å†åŠ ä¸Š Redis é‡Œç¡®å®æœ‰ key æœ‰å€¼ï¼Œä½ å°±æ›´å®¹æ˜“è¯¯åˆ¤æˆâ€œè¯»å–é“¾è·¯æœ‰é—®é¢˜â€ã€‚ä½†åªè¦ä½ æŠŠå†™å…¥ id å’Œè¯»å– id å¯¹é½çœ‹ä¸€çœ¼ï¼ŒçœŸç›¸å°±å¾ˆå¹²å‡€ï¼Œå¹²å‡€å¾—ç”šè‡³æœ‰ç‚¹æ®‹å¿ã€‚</p>
<p>ä¿®å¤è¿™ç±»é—®é¢˜ï¼Œæˆ‘çš„ç»éªŒæ˜¯åˆ«åœ¨å‰ç«¯åšèŠ±æ´»ï¼Œå·¥ç¨‹ä¸Šæœ€ç¨³çš„è·¯çº¿æ˜¯åç«¯æŠŠæ‰€æœ‰ Long ç»Ÿä¸€åºåˆ—åŒ–æˆå­—ç¬¦ä¸²ï¼Œè®© id ä»ä¸€å¼€å§‹å°±åˆ«è¿› JS çš„ Number ä¸–ç•Œã€‚åªè¦ JSON é‡Œ id å¸¦å¼•å·ï¼Œå‰ç«¯æ‹¿åˆ°çš„å°±æ˜¯ stringï¼Œæ‹¼ URL æ¯”è¾ƒç›¸ç­‰éƒ½ä¸ä¼šä¸¢ç²¾åº¦ã€‚Spring Boot é‡Œç”¨ Jackson åšå…¨å±€é…ç½®å°±è¡Œï¼ŒæŠŠ Long å’Œ long éƒ½ç”¨ ToStringSerializer è¾“å‡ºï¼Œç±»ä¼¼è¿™æ ·ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.meme.generator.config;

<span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.ser.std.ToStringSerializer;
<span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.jackson.Jackson2ObjectMapperBuilderCustomizer;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;

<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JacksonConfig</span> {

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Jackson2ObjectMapperBuilderCustomizer <span class="hljs-title function_">longToStringCustomizer</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> builder -&gt; {
            builder.serializerByType(Long.class, ToStringSerializer.instance);
            builder.serializerByType(Long.TYPE, ToStringSerializer.instance);
        };
    }
}
</code></pre>
<p>ä¸Šçº¿ä¹‹åä½ ä¼šå¾ˆç›´è§‚åœ°çœ‹åˆ°å˜åŒ–ï¼Œæ¥å£è¿”å›ä» <code>id: 200300...</code> å˜æˆ <code>"id":"200300..."</code>ã€‚è¿™ä¸€æ­¥å°±æ˜¯æ²»æœ¬ï¼Œå› ä¸ºä½ æŠŠé£é™©æºå¤´ææ‰äº†ã€‚å‰ç«¯è¿™è¾¹ä¹Ÿåˆ«çŠ¹è±«ï¼Œæ‰€æœ‰ id ä¸€å¾‹å½“å­—ç¬¦ä¸²å¤„ç†ï¼Œè·¯ç”±å‚æ•°ã€è¯·æ±‚å‚æ•°ã€Map keyã€å¯¹æ¯”é€»è¾‘éƒ½ç”¨ stringï¼Œåˆ«æ‰‹è´±å» Number(id)ã€‚å¦‚æœä½ ç”¨ TypeScriptï¼ŒæŠŠ DTO é‡Œçš„ id ç±»å‹ç›´æ¥å†™æ­»æˆ stringï¼Œèƒ½æå‰æ‹¦ä½ä¸€å †æ— æ„çš„éšå¼è½¬æ¢ã€‚</p>
<p>å…‰æŠŠ Long è½¬å­—ç¬¦ä¸²è¿˜ä¸å¤Ÿï¼Œæˆ‘ä¹ æƒ¯å†åŠ ä¸€é“ä¿é™©ï¼Œé˜²æ­¢ç³»ç»Ÿç»§ç»­è¢«è„è¯·æ±‚æ±¡æŸ“ã€‚ç‚¹èµæ¥å£åœ¨çœŸæ­£å†™ Redis å’Œå†™ DB ä¹‹å‰ï¼Œå…ˆæ ¡éªŒ targetId å¿…é¡»çœŸå®å­˜åœ¨ã€‚åŸå› å¾ˆç°å®ï¼Œå°±ç®—ä½ å‰ç«¯å…¨ä¿®å¥½äº†ï¼Œä¹Ÿæ€»ä¼šæœ‰äººæŠ“åŒ…ä¹±æ‰“æ¥å£ï¼Œæˆ–è€…æ—§ç‰ˆæœ¬å‰ç«¯è¿˜åœ¨å¤–é¢è·‘ï¼Œç”šè‡³æŸäº›æ•°æ®é“¾è·¯ä¸­é—´åˆæŠŠ id ææˆäº† numberã€‚ä½ ä¸æƒ³ Redis å’Œç‚¹èµè¡¨é‡Œæ°¸è¿œèººç€ä¸€å †â€œå¹½çµå¸–å­â€çš„ç‚¹èµè®°å½•ï¼Œæœ€å¥½çš„åŠæ³•å°±æ˜¯å…¥å£å¤„æŠŠé—¨å…³æ­»ï¼Œä¸å­˜åœ¨çš„å¸–å­æˆ–è¯„è®ºç›´æ¥æ‹’ç»ï¼Œåˆ«å†™å…¥ä»»ä½•ä¸œè¥¿ã€‚è¿™æ ·ç³»ç»Ÿçš„å®¹é”™ä¼šå¼ºå¾ˆå¤šï¼Œä½ ä»¥ååšç»Ÿè®¡ã€æ’è¡Œã€æ¶ˆæ¯é€šçŸ¥ä¹Ÿä¸è‡³äºè¢«è„æ•°æ®æ¶å¿ƒã€‚</p>
<p>ä¿®å¤ä¸Šçº¿ä»¥åéªŒè¯ä¹Ÿå¾ˆç®€å•ï¼Œä¸éœ€è¦å†™ä»€ä¹ˆå¤æ‚ç”¨ä¾‹ã€‚ä½ æ‰“å¼€ Network çœ‹ä¸€çœ¼åˆ—è¡¨æ¥å£å“åº”ï¼Œåªè¦ id å¸¦å¼•å·ï¼ŒåŸºæœ¬å¯ä»¥ç¡®è®¤ä½ å·²ç»è·¨è¿‡äº† JS ç²¾åº¦è¿™ä¸ªå‘ã€‚å¦‚æœä½ å‘ç°çº¿ä¸Šè¿˜æ˜¯æ•°å­— idï¼Œé‚£å°±åˆ«å¾€ä¸‹æµ‹äº†ï¼Œè¯´æ˜ä½ å‹æ ¹æ²¡éƒ¨ç½²åˆ°æ–°ç‰ˆæœ¬æˆ–è€…é…ç½®æ²¡ç”Ÿæ•ˆã€‚æ¥ç€éšä¾¿ç‚¹ä¸ªèµï¼Œè§‚å¯Ÿç‚¹èµè¯·æ±‚è·¯å¾„é‡Œçš„ id æ˜¯å¦å’Œåˆ—è¡¨è¿”å›å®Œå…¨ä¸€è‡´ï¼Œç„¶ååˆ·æ–°é¡µé¢çœ‹ likeCount æ˜¯å¦è¿˜èƒ½ä¿æŒä¸€è‡´ã€‚å¦‚æœè¿™ä¸‰ä»¶äº‹éƒ½ç¨³äº†ï¼Œè¿™ä¸ªé—®é¢˜å°±å¯ä»¥å®£å¸ƒç»“æŸï¼Œå±äºâ€œæ°¸ä¸å¤å‘â€é‚£ä¸€ç±»ã€‚</p>
<p>æœ€ååˆ«å¿˜äº†å†å²è„æ•°æ®ã€‚è¿™ä¸ªå‘ä¸€æ—¦å‘ç”Ÿè¿‡ï¼Œä½  Redis é‡Œå¾ˆå¯èƒ½å·²ç»å­˜åœ¨ä¸€æ‰¹é”™è¯¯ id çš„è®¡æ•° keyï¼Œæ•°æ®åº“é‡Œä¹Ÿå¯èƒ½å·²ç»æœ‰ target_id æŒ‡å‘ä¸å­˜åœ¨ç›®æ ‡çš„ç‚¹èµè®°å½•ã€‚æ–°ç‰ˆæœ¬ä¸ä¼šå†äº§ç”Ÿï¼Œä½†æ—§çš„å¦‚æœä¸æ¸…ç†ï¼Œè¿Ÿæ—©ä¼šåœ¨æŸä¸ªç»Ÿè®¡åŠŸèƒ½é‡Œåå’¬ä½ ä¸€å£ã€‚æ¸…ç†çš„æ€è·¯ä¹Ÿä¸å¤æ‚ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯åˆ æ‰æ‰€æœ‰æŒ‡å‘ä¸å­˜åœ¨ç›®æ ‡çš„ç‚¹èµè®°å½•ã€‚ä¸¾ä¸ªå¸¸è§åœºæ™¯ï¼Œå¦‚æœä½ çš„ç‚¹èµè¡¨æ˜¯ forum_likeï¼Œå¸–å­è¡¨æ˜¯ forum_postï¼Œå¹¶ä¸” target_type=1 ä»£è¡¨å¸–å­ï¼Œä½ å¯ä»¥åœ¨ç¡®è®¤å¤‡ä»½å’Œæµ‹è¯•ä¹‹åç”¨ç±»ä¼¼çš„ SQL æ‰¾å¹¶åˆ é™¤â€œä¸å­˜åœ¨å¸–å­â€çš„ç‚¹èµè®°å½•ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">DELETE</span> fl
<span class="hljs-keyword">FROM</span> forum_like fl
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> forum_post fp <span class="hljs-keyword">ON</span> fp.id <span class="hljs-operator">=</span> fl.target_id
<span class="hljs-keyword">WHERE</span> fl.target_type <span class="hljs-operator">=</span> <span class="hljs-number">1</span>
  <span class="hljs-keyword">AND</span> fp.id <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>;
</code></pre>
<p>Redis æ¸…ç†ä¹Ÿå»ºè®®ç”¨ SCAN å»åšæ¸è¿›åˆ é™¤ï¼Œåˆ«åœ¨ç”Ÿäº§ä¸Šç”¨ KEYS å›¾çœäº‹ï¼ŒRedis è¿™ç©æ„ä½ çœŸæŠŠå®ƒé˜»å¡äº†ï¼Œåæœæ¯”ç‚¹èµé”™ä½ä¸¥é‡å¤šäº†ã€‚</p>
<p>å†™åˆ°è¿™é‡Œä½ ä¼šå‘ç°ï¼Œè¿™æ¬¡äº‹æ•…çœŸæ­£çš„æ•™è®­å…¶å®å¾ˆå·¥ç¨‹åŒ–ï¼šè·¨è¯­è¨€ç³»ç»Ÿé‡Œï¼Œid è¿™ç§ä¸€æ—¦å‡ºé”™å°±ä¼šå†™é”™å¯¹è±¡çš„å­—æ®µï¼Œæ°¸è¿œä¸è¦æŠŠå®ƒå½“æ•°å€¼å»ä¼ ã€‚å°¤å…¶æ˜¯é›ªèŠ± longï¼Œåœ¨ Java ä¸–ç•Œé‡Œå†è‡ªç„¶ä¸è¿‡ï¼Œåˆ°äº† JS ä¸–ç•Œé‡Œå°±æ˜¯ä¸ªéšæ—¶å¯èƒ½å˜å½¢çš„â€œå±é™©å“â€ã€‚æŠŠ Long è¾“å‡ºæˆå­—ç¬¦ä¸²ä¸æ˜¯æ´ç™–ï¼Œæ˜¯å¯¹çº¿ä¸Šç¨³å®šæ€§çš„å°Šé‡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec3e298142b4485eaf8b4ec0c9c7bc65~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgV2FuZGVySW5r:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767283724&amp;x-signature=cCGWcOwKgJ9aM4Mw551YtDyU3hM%3D" alt="ChatGPT Image 2025å¹´12æœˆ26æ—¥ 00_07_25.png" loading="lazy"/></p>
<p>å¦‚æœä½ ç°åœ¨ä¹Ÿè¢«â€œåˆ·æ–°åç‚¹èµå…¨æ˜¯ 0â€æŠ˜ç£¨ç€ï¼Œæˆ‘å»ºè®®ä½ å…ˆåˆ«æ€¥ç€è°ƒ Redis å’Œéƒ¨ç½²é“¾è·¯ï¼Œå…ˆåšä¸€ä»¶æœ€ä¾¿å®œä½†æœ€æœ‰æ•ˆçš„äº‹ï¼šå¯¹æ¯”ä¸€ä¸‹åˆ—è¡¨è¿”å›çš„ id å’Œç‚¹èµè¯·æ±‚é‡Œçš„ id æ˜¯å¦å®Œå…¨ä¸€è‡´ã€‚åªè¦å®ƒä»¬å·®ä¸€ç‚¹ç‚¹ï¼Œä½ å°±å·²ç»æŠ“åˆ°å‡¶æ‰‹äº†ã€‚æŠŠ Long å…¨å±€è½¬å­—ç¬¦ä¸²ï¼Œå†æŠŠç‚¹èµå…¥å£åŠ ä¸Šå­˜åœ¨æ€§æ ¡éªŒï¼Œæœ€åæ¸…æ‰å†å²è„æ•°æ®ï¼Œä½ ä¼šå‘ç°è¿™ä¸ªé—®é¢˜ç»“æŸå¾—éå¸¸å¹²è„†ï¼Œç”šè‡³æœ‰ç‚¹çˆ½ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¡ˆä¾‹+å›¾è§£å¸¦ä½ ä¸€æ–‡è¯»æ‡‚Svgã€Canvasã€Cssã€JsåŠ¨ç”»ğŸ”¥ğŸ”¥ï¼ˆ4k+å­—ï¼‰]]></title>    <link>https://juejin.cn/post/7587811143109509171</link>    <guid>https://juejin.cn/post/7587811143109509171</guid>    <pubDate>2025-12-26T07:43:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587811143109509171" data-draft-id="7587903505134878770" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¡ˆä¾‹+å›¾è§£å¸¦ä½ ä¸€æ–‡è¯»æ‡‚Svgã€Canvasã€Cssã€JsåŠ¨ç”»ğŸ”¥ğŸ”¥ï¼ˆ4k+å­—ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Canvas"/> <meta itemprop="datePublished" content="2025-12-26T07:43:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Lsx_"/> <meta itemprop="url" content="https://juejin.cn/user/1442981392682829"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¡ˆä¾‹+å›¾è§£å¸¦ä½ ä¸€æ–‡è¯»æ‡‚Svgã€Canvasã€Cssã€JsåŠ¨ç”»ğŸ”¥ğŸ”¥ï¼ˆ4k+å­—ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1442981392682829/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Lsx_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T07:43:15.000Z" title="Fri Dec 26 2025 07:43:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;color:#282d36}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px;color:#2f845e}.markdown-body h2{font-size:22px;display:inline-block;font-weight:700;background:#2f845e;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(47,132,194,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 32px);border-bottom:3px solid #2f845e}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%;box-shadow:6px 6px 6px #888}.markdown-body hr{border:none;border-top:1px solid rgba(66,185,131,.15);margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#f6ffed;color:#52c41a;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:16px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#262626;border:1px solid #2f845e;border-top:8px solid #2f845e;background:linear-gradient(180deg,rgba(66,185,131,.1),transparent)!important}.markdown-body pre&gt;code.hljs[lang]:before{top:8px!important;color:#2f845e!important}.markdown-body pre&gt;code.language-awesome_error{border:1px solid #ff4d4f!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#ff4d4f!important;background:#fff2f0!important}.markdown-body pre&gt;code.language-awesome_error:before{content:"!"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#ff4d4f!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_warn{border:1px solid #ffc46f!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#ffc46f!important;background:#fffbe6!important}.markdown-body pre&gt;code.language-awesome_warn:before{content:"â˜‚"!important;position:absolute;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#ffc46f!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_success{border:1px solid #52c41a!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#52c41a!important;background:#f6ffed!important}.markdown-body pre&gt;code.language-awesome_success:before{content:"âœ“"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#52c41a!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_info{border:1px solid #1890ff!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#1890ff!important;background:#e6f7ff!important}.markdown-body pre&gt;code.language-awesome_info:before{content:"i"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#1890ff!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body strong{background-color:inherit;color:#2f845e}.markdown-body em{background-color:inherit;color:#949415}.markdown-body a{text-decoration:none;color:#2f8e54;border-bottom:1px solid #3f9e64}.markdown-body a:active,.markdown-body a:hover{color:#3f9e64}.markdown-body a[class^=footnote]{margin-left:4px}.markdown-body a:before{content:"â¤ "}.markdown-body table{font-size:12px;width:100%;max-width:100%;overflow:auto;border:2px solid #2f8e54}.markdown-body thead{background:#2f8e54;color:#fff;text-align:left;font-weight:700}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:22px}.markdown-body td{min-width:120px}.markdown-body blockquote{padding:1px 22px;margin:22px 0;border-left:6px solid #2f845e;background-color:rgba(66,185,131,.1);border-radius:2px}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#2f845e}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px;color:#282d36}.markdown-body del{color:#2f845e}.markdown-body input[type=checkbox]:checked:before{content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA/klEQVQ4T72TMU7DQBBF318XdFR06egQEnAXRINEGlqgowoIR8AF4AZOZ4JEGq5AC5EixBU4A55BNrEVHAcSBTHlaubt37/zxZKlcn7n6mDPXJvz8IJ89HzWu8t7C8D2dfsY52ae4apHnLx0ktsCsHXZjiUuFgG40x2eJ/H/AhztB+zDUTpLwWj8jGkzxSHiHaMPrDQC8sMoilKzLAUqiKQjmb+ZuAdW80tmelCHODoNgSfP7AFprTTaRTzsJN1GEyuIZ7uW6TEEHwCtyV/6EVBKJHhfzgC0Xv/iXwEFBF4FG0378bd7sPQq5xK/hSnk6sdlX3mZrKkwLZKBeu8n9XuWEUE7X+YAAAAASUVORK5CYII=);position:relative;top:-1px;left:-1px}.markdown-body .math .katex{font-family:Menlo,Monaco,Consolas,Courier New,monospace;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#f6ffed;color:#52c41a;font-size:.87em;padding:.065em .4em}@media (max-width:720px){.markdown-body h1{font-size:22px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>åŠ¨ç”»åœ¨å‰ç«¯å¼€å‘ä¸­æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ã€‚å®ƒä¸ä»…å¯ä»¥æå‡ç”¨æˆ·ä½“éªŒï¼Œè¿˜å¯ä»¥ä½¿ç•Œé¢æ›´åŠ ç”ŸåŠ¨å’Œæœ‰è¶£ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨å‰ç«¯åŠ¨ç”»çš„å„ç§å®ç°æ–¹å¼ï¼ŒåŒ…æ‹¬ CSS åŠ¨ç”»ã€JavaScript åŠ¨ç”»ã€SVG åŠ¨ç”»ç­‰ã€‚æˆ‘ä»¬è¿˜å°†è®¨è®ºä¸€äº›è§¦å‘åŠ¨ç”»çš„æ–¹å¼å’ŒåŠ¨ç”»åœ¨ç”¨æˆ·ä½“éªŒä¸­çš„æœ€ä½³å®è·µã€‚</p>
<h2 data-id="heading-1">å‰ç«¯åŠ¨ç”»åˆ†ç±»</h2>
<ul>
<li>
<p><strong><code>CSS åŠ¨ç”»</code></strong></p>
<ul>
<li>
<p><strong>CSS Transition</strong><br/>
CSS è¿‡æ¸¡ï¼Œå±äº<strong>è¡¥é—´åŠ¨ç”»</strong>ï¼Œå³è®¾ç½®å…³é”®å¸§çš„åˆå§‹çŠ¶æ€ï¼Œç„¶ååœ¨å¦ä¸€ä¸ªå…³é”®å¸§æ”¹å˜è¿™ä¸ªçŠ¶æ€ï¼Œæ¯”å¦‚å¤§å°ã€é¢œè‰²ã€é€æ˜åº¦ç­‰ï¼Œæµè§ˆå™¨å°†è‡ªåŠ¨æ ¹æ®äºŒè€…ä¹‹é—´å¸§çš„å€¼åˆ›å»ºçš„åŠ¨ç”»ã€‚</p>
</li>
<li>
<p><strong>CSS Animation</strong><br/>
CSS åŠ¨ç”»ï¼Œå¯ä»¥ç†è§£æ˜¯ <code>CSS Transition</code> çš„åŠ å¼ºç‰ˆï¼Œå®ƒæ—¢å¯ä»¥å®ç° <strong>è¡¥é—´åŠ¨ç”»</strong> çš„åŠ¨ç”»æ•ˆæœï¼Œä¹Ÿå¯ä»¥ä½¿å…¶ä»¥ <strong>é€å¸§åŠ¨ç”»</strong> çš„æ–¹å¼è¿›è¡Œç»˜åˆ¶ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong><code>SVG åŠ¨ç”»</code></strong></p>
<ul>
<li>SVG åŠ¨ç”»ç”¨äºçŸ¢é‡å›¾å½¢ï¼Œæä¾›äº†é«˜è´¨é‡çš„åŠ¨ç”»æ•ˆæœï¼Œå¸¸ç”¨äºå›¾æ ‡å’Œå›¾å½¢åŠ¨ç”»ã€‚å¯ä»¥ä½¿ç”¨ SMIL åœ¨SVGä¸­å®šä¹‰åŠ¨ç”»ã€‚åŒæ ·çš„ä¹Ÿå¯ä»¥ä½¿ç”¨cssæˆ–è€…jsæ¥æ§åˆ¶svgåŠ¨ç”»ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>Canvas åŠ¨ç”»</code></strong></p>
<ul>
<li>
<p>é€šè¿‡ç»“åˆä½¿ç”¨Â <code>requestAnimationFrame</code>ã€è·¯å¾„å’Œå˜æ¢ç­‰æŠ€æœ¯å¯¹ç”»å¸ƒçš„å…ƒç´ è¿›è¡Œæ“¦é™¤å’Œé‡æ–°ç»˜åˆ¶ï¼Œå¯ä»¥å®ç°å¤æ‚çš„åŠ¨ç”»æ•ˆæœã€‚å¦å¤–Canvasè¿˜å¯ä»¥ç”¨äºç»˜åˆ¶å¤æ‚çš„èƒŒæ™¯æˆ–é™æ€å†…å®¹ï¼Œä»è€Œå‡å°‘æ¯å¸§çš„ç»˜åˆ¶å·¥ä½œé‡ã€‚</p>
</li>
<li>
<p>å¯ä»¥å‚è€ƒæˆ‘çš„ä¸€ç¯‡å…³äºcanvasåˆ¶ä½œåŠ¨ç”»çš„æ–‡ç« ï¼š<a href="https://juejin.cn/post/7389211334641270793" target="_blank" title="https://juejin.cn/post/7389211334641270793">ç”¨Canvasç»˜åˆ¶ä¸€ä¸ªé«˜å¯é…ç½®çš„åœ†å½¢è¿›åº¦æ¡</a></p>
</li>
</ul>
</li>
<li>
<p><strong><code>JS åŠ¨ç”»</code></strong></p>
<ul>
<li>
<p><strong>setTimeout</strong> / <strong>setInterval</strong> / <strong>requestAnimationFrame</strong><br/>
<code>setTimeout</code> å’Œ <code>setInterval</code> è¿™ä¸¤ä¸ª API è®¾å®šçš„æ—¶é—´ä¼šå› ä¸ºæµè§ˆå™¨å½“å‰å·¥ä½œè´Ÿè½½è€Œæœ‰æ‰€åå·®ï¼Œè€Œä¸”æ— æ³•ä¸æµè§ˆå™¨çš„ç»˜åˆ¶å¸§ä¿æŒåŒæ­¥ã€‚æ‰€ä»¥æ‰æœ‰äº† <strong>ä¸æµè§ˆå™¨çš„ç»˜åˆ¶å¸§åŒæ­¥</strong> çš„åŸç”Ÿ API <code>requestAnimationFrame</code>ï¼Œä»¥å–ä»£ <code>setTimeout</code> å’Œ <code>setInterval</code> å®ç°åŠ¨ç”»ã€‚</p>
</li>
<li>
<p><strong>Web Animations API</strong><br/>
æµè§ˆå™¨åŠ¨ç”» APIï¼Œé€šè¿‡ JavaScript æ“ä½œã€‚è¿™äº› API è¢«è®¾è®¡æˆÂ <code>CSS Transition</code> å’Œ <code>CSS Animation</code> çš„æ¥å£ï¼Œå¾ˆå®¹æ˜“é€šè¿‡ JS çš„æ–¹å¼å®ç° CSS åŠ¨ç”»ï¼Œå®ƒæ˜¯å¯¹åŠ¨ç”»åŒ–çš„æ”¯æŒæœ€æœ‰æ•ˆçš„æ–¹å¼ä¹‹ä¸€ã€‚</p>
</li>
</ul>
</li>
</ul>
<h2 data-id="heading-2">css åŠ¨ç”»</h2>
<h3 data-id="heading-3">cssè¿‡æ¸¡åŠ¨ç”» <code>transition</code></h3>
<h4 data-id="heading-4">æ³¨æ„</h4>
<p>ç”±äºæµè§ˆå™¨æ˜¯æ ¹æ®æ ·å¼å·®å¼‚åŒ–çš„ä¸¤å¸§è‡ªåŠ¨è®¡ç®—å¹¶è¿‡æ¸¡ï¼Œæ‰€ä»¥Â <code>transition</code>Â åªæ”¯æŒå¯è¯†åˆ«ä¸­é—´å€¼çš„å±æ€§ (å¦‚å¤§å°ã€é¢œè‰²ã€ä½ç½®ã€é€æ˜åº¦ç­‰)ï¼Œè€Œå¦‚ display å±æ€§åˆ™ä¸æ”¯æŒã€‚</p>
<h4 data-id="heading-5">è¯­æ³•å®šä¹‰</h4>
<ul>
<li>
<p><code>transition-property</code>ï¼š æŒ‡å®šå“ªä¸ªæˆ–å“ªäº› CSS å±æ€§ç”¨äºè¿‡æ¸¡ã€‚åªæœ‰æŒ‡å®šçš„å±æ€§æ‰ä¼šåœ¨è¿‡æ¸¡ä¸­å‘ç”ŸåŠ¨ç”»ï¼Œå…¶ä»–å±æ€§ä»å¦‚é€šå¸¸é‚£æ ·ç¬é—´å˜åŒ–ã€‚</p>
</li>
<li>
<p><code>transition-duration</code>ï¼š æŒ‡å®šè¿‡æ¸¡çš„æ—¶é•¿ã€‚ä½ å¯ä»¥ä¸ºæ‰€æœ‰å±æ€§æŒ‡å®šä¸€ä¸ªå€¼ï¼Œæˆ–è€…æŒ‡å®šå¤šä¸ªå€¼ï¼Œæˆ–è€…ä¸ºæ¯ä¸ªå±æ€§æŒ‡å®šä¸åŒçš„æ—¶é•¿ã€‚</p>
</li>
<li>
<p><code>transition-timing-function</code>ï¼š æŒ‡å®šä¸€ä¸ªç¼“åŠ¨å‡½æ•°ï¼Œå®šä¹‰å±æ€§å€¼æ€ä¹ˆå˜åŒ–ã€‚å¸¸è§çš„ç¼“åŠ¨å‡½æ•°æ˜¯ä¸€ä¸ªä¸‰æ¬¡è´å¡å°”æ›²çº¿ ( <code>cubic-bezier(&lt;x1&gt;, &lt;y1&gt;, &lt;x2&gt;, &lt;y2&gt;)</code> )ã€‚å½“ç„¶ä¹Ÿå¯ä»¥é€‰æ‹©å…³é”®å­—</p>
<ul>
<li><strong>linear</strong>ï¼š<code>cubic-bezier(0.0, 0.0, 1.0, 1.0)</code></li>
<li><strong>ease</strong>ï¼š<code>cubic-bezier(0.25, 0.1, 0.25, 1.0)</code></li>
<li><strong>ease-in</strong>ï¼š<code>cubic-bezier(0.42, 0.0, 1.0, 1.0)</code></li>
<li><strong>ease-out</strong>ï¼š<code>cubic-bezier(0.0, 0.0, 0.58, 1.0)</code></li>
<li><strong>ease-in-out</strong>ï¼š<code>cubic-bezier(0.42, 0.0, 0.58, 1.0)</code></li>
</ul>
</li>
<li>
<p><code>transition-delay</code>ï¼š æŒ‡å®šå»¶è¿Ÿï¼Œå³å±æ€§å¼€å§‹å˜åŒ–æ—¶ä¸è¿‡æ¸¡å¼€å§‹å‘ç”Ÿæ—¶ä¹‹é—´çš„æ—¶é•¿ã€‚</p>
</li>
</ul>
<h4 data-id="heading-6">ä»£ç ç¤ºä¾‹</h4>
<pre><code class="hljs language-css" lang="css">  <span class="hljs-comment">/* å•æ¡ ç®€å†™å½¢å¼ */</span>
  <span class="hljs-attribute">transition</span>: 
    &lt;property&gt; &lt;duration&gt; &lt;timing-function&gt; &lt;delay&gt;;
  
  
  <span class="hljs-comment">/* å¤šæ¡ ç®€å†™å½¢å¼ */</span>
  <span class="hljs-attribute">transition</span>: 
    &lt;property&gt; &lt;duration&gt; &lt;timing-function&gt; &lt;delay&gt;,
    &lt;property&gt; &lt;duration&gt; &lt;timing-function&gt; &lt;delay&gt;,
    ...;


  <span class="hljs-comment">/* å•æ¡ å­å±æ€§å½¢å¼ */</span>
  <span class="hljs-attribute">transition-property</span>: &lt;property-name&gt;;
  <span class="hljs-attribute">transition-duration</span>: &lt;duration-time&gt;;
  <span class="hljs-attribute">transition-timing-function</span>: &lt;timing-function&gt;;
  <span class="hljs-attribute">transition-delay</span>: &lt;duration-time&gt;;
  
  
  <span class="hljs-comment">/* å¤šæ¡ å­å±æ€§å½¢å¼ */</span>
  <span class="hljs-attribute">transition-property</span>: &lt;property-name&gt; [, &lt;property-name&gt;, ...];
  <span class="hljs-attribute">transition-duration</span>: &lt;duration-time&gt; [, &lt;duration-time&gt;, ...];
  <span class="hljs-attribute">transition-timing-function</span>: [, &lt;cubic-bezier&gt;, ...];
  <span class="hljs-attribute">transition-delay</span>: [, &lt;duration-time&gt;, ...];
  
  
  // å¦‚æœä»»æ„å±æ€§å€¼åˆ—è¡¨çš„é•¿åº¦æ¯”å…¶ä»–å±æ€§å€¼åˆ—è¡¨è¦çŸ­ï¼Œåˆ™å…¶ä¸­çš„å€¼ä¼šé‡å¤ä½¿ç”¨ä»¥ä¾¿åŒ¹é…
  
  // å¦‚æœæŸä¸ªå±æ€§çš„å€¼åˆ—è¡¨é•¿äºÂ `<span class="hljs-attribute">transition-property</span>`Â çš„å±æ€§ï¼Œåˆ™å°†è¢«æˆªçŸ­
  

</code></pre>
<h4 data-id="heading-7">cssè¿‡æ¸¡åŠ¨ç”» è§¦å‘æ–¹å¼</h4>
<h5 data-id="heading-8">1. ä¼ªç±»è§¦å‘ï¼ˆ:hoverã€:focusã€:activeç­‰ï¼‰</h5>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.button</span> {
  <span class="hljs-attribute">background-color</span>: blue;
  <span class="hljs-attribute">transition</span>: background-color <span class="hljs-number">0.3s</span> ease;
}

<span class="hljs-selector-class">.button</span><span class="hljs-selector-pseudo">:hover</span> {
  <span class="hljs-attribute">background-color</span>: red;
}

</code></pre>
<h5 data-id="heading-9">2. ç±»ååˆ‡æ¢ï¼ˆé€šè¿‡JSåŠ¨æ€åˆ‡æ¢ç±»åæ¥è§¦å‘è¿‡æ¸¡æ•ˆæœï¼‰</h5>
<pre><code class="hljs language-js" lang="js">&lt;button id=<span class="hljs-string">"toggleButton"</span>&gt;<span class="hljs-title class_">Toggle</span>&lt;/button&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"box"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
  <span class="hljs-selector-class">.box</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
    <span class="hljs-attribute">background-color</span>: blue;
    <span class="hljs-attribute">transition</span>: background-color <span class="hljs-number">0.3s</span> ease;
  }

  <span class="hljs-selector-class">.box</span><span class="hljs-selector-class">.active</span> {
    <span class="hljs-attribute">background-color</span>: red;
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'toggleButton'</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'box'</span>).<span class="hljs-property">classList</span>.<span class="hljs-title function_">toggle</span>(<span class="hljs-string">'active'</span>);
  });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

</code></pre>
<h5 data-id="heading-10">3. å±æ€§å˜åŒ–</h5>
<pre><code class="hljs language-js" lang="js">&lt;button id=<span class="hljs-string">"toggleButton"</span>&gt;<span class="hljs-title class_">Toggle</span>&lt;/button&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"box"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
  <span class="hljs-selector-class">.box</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
    <span class="hljs-attribute">background-color</span>: blue;
    <span class="hljs-attribute">transition</span>: background-color <span class="hljs-number">0.3s</span> ease;
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'toggleButton'</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> box = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'box'</span>);
    box.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundColor</span> = box.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundColor</span> === <span class="hljs-string">'red'</span> ? <span class="hljs-string">'blue'</span> : <span class="hljs-string">'red'</span>;
  });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

</code></pre>
<h5 data-id="heading-11">4. ä¼ªå…ƒç´ è§¦å‘ï¼ˆé€šè¿‡ä¼ªå…ƒç´ å¦‚<code>::before</code>ã€<code>::after</code>çš„çŠ¶æ€å˜åŒ–æ¥è§¦å‘è¿‡æ¸¡æ•ˆæœã€‚ï¼‰</h5>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">div</span> class="box"&gt;&lt;/<span class="hljs-selector-tag">div</span>&gt;

&lt;style&gt;
  <span class="hljs-selector-class">.box</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
    <span class="hljs-attribute">position</span>: relative;
  }

  <span class="hljs-selector-class">.box</span><span class="hljs-selector-pseudo">::before</span> {
    <span class="hljs-attribute">content</span>: <span class="hljs-string">''</span>;
    <span class="hljs-attribute">position</span>: absolute;
    <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">background-color</span>: blue;
    <span class="hljs-attribute">transition</span>: background-color <span class="hljs-number">0.3s</span> ease;
  }

  <span class="hljs-selector-class">.box</span><span class="hljs-selector-pseudo">:hover</span><span class="hljs-selector-pseudo">::before</span> {
    <span class="hljs-attribute">background-color</span>: red;
  }
&lt;/style&gt;

</code></pre>
<h3 data-id="heading-12">cssåŠ¨ç”» <code>animation</code></h3>
<h4 data-id="heading-13">æ³¨æ„</h4>
<p>CSS Animation å…·å¤‡äº†å¯¹ <strong>å…³é”®å¸§å’Œå¾ªç¯æ¬¡æ•°</strong> çš„è‡ªå®šä¹‰èƒ½åŠ›ã€‚CSS Animation åœ¨å®ç°åƒ CSS Transition <strong>è¡¥é—´åŠ¨ç”»</strong> æ•ˆæœæ—¶ï¼Œè¿˜å¯ä»¥åœ¨èµ·å§‹å¸§å’Œç»“æŸå¸§ä¹‹é—´è‡ªå®šä¹‰ä¸­é—´å¸§ï¼Œä½¿å¾—åŠ¨ç”»æ›´åŠ å¹³æ»‘è¿‡æ¸¡çš„åŒæ—¶ï¼Œå¯¹åŠ¨ç”»æœ‰äº†æ›´å¥½çš„æ§åˆ¶å’Œè‡ªå®šä¹‰èƒ½åŠ›ã€‚</p>
<h4 data-id="heading-14">è¯­æ³•å®šä¹‰</h4>
<p>å…ˆåˆ›å»ºä¸€ä¸ªå¸¦åç§°çš„Â <code>@keyframes</code>Â è§„åˆ™ï¼Œä»¥ä¾¿åç»­ä½¿ç”¨Â <code>animation-name</code>Â å±æ€§å°†åŠ¨ç”»åŒå…¶å…³é”®å¸§å£°æ˜è¿›è¡ŒåŒ¹é…ã€‚æ¯ä¸ªè§„åˆ™åŒ…å«å¤šä¸ªå…³é”®å¸§ï¼Œä¹Ÿå°±æ˜¯ä¸€æ®µæ ·å¼å—è¯­å¥ï¼Œæ¯ä¸ªå…³é”®å¸§æœ‰ä¸€ä¸ªç™¾åˆ†æ¯”å€¼ä½œä¸ºåç§°ï¼Œä»£è¡¨åœ¨åŠ¨ç”»è¿›è¡Œä¸­ï¼Œåœ¨å“ªä¸ªé˜¶æ®µè§¦å‘è¿™ä¸ªå¸§æ‰€åŒ…å«çš„æ ·å¼ã€‚</p>
<ul>
<li>
<p><code>animation-name</code>ï¼šæŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ª @keyframes çš„åç§°ï¼Œæè¿°äº†è¦åº”ç”¨äºå…ƒç´ çš„åŠ¨ç”»ã€‚å¤šä¸ª @keyframes ä»¥é€—å·åˆ†éš”ã€‚</p>
</li>
<li>
<p><code>animation-duration</code>ï¼šè®¾ç½®åŠ¨ç”»å®Œæˆä¸€ä¸ªåŠ¨ç”»å‘¨æœŸæ‰€éœ€çš„æ—¶é—´ï¼Œéœ€è¦æŒ‡å®šå•ä½ï¼Œå¦‚ <code>1s</code>ã€<code>500ms</code>ã€‚</p>
</li>
<li>
<p><code>animation-delay</code>ï¼šæŒ‡å®šæ‰§è¡ŒåŠ¨ç”»ä¹‹å‰çš„ç­‰å¾…æ—¶é—´ã€‚åŠ¨ç”»å¯ä»¥ç¨åå¼€å§‹ã€ç«‹å³ä»å¼€å¤´å¼€å§‹ã€ç«‹å³åœ¨åŠ¨ç”»ä¸­é€”æ’­æ”¾ <strong>(å¦‚ <code>-1s</code>)</strong> ã€‚å…¶ä¸­ <code>-1s</code> æ„æ€æ˜¯åŠ¨ç”»ç«‹å³ä» 1s å¤„å¼€å§‹ã€‚</p>
</li>
<li>
<p><code>animation-iteration-count</code>ï¼šè®¾ç½®åŠ¨ç”»åºåˆ—åœ¨åœæ­¢å‰åº”æ’­æ”¾çš„æ¬¡æ•°ï¼Œæœ‰æ•ˆå€¼ <code>0</code>ã€æ­£æ•´æ•°ã€æ­£å°æ•°ã€æ— é™å¾ªç¯ <code>infinite</code>ã€‚</p>
</li>
<li>
<p><code>animation-direction</code>ï¼šè®¾ç½®åŠ¨ç”»æ˜¯æ­£å‘æ’­æ”¾ <code>normal</code>ã€åå‘æ’­æ”¾ <code>reverse</code>ã€æ­£å‘äº¤æ›¿æ’­æ”¾ <code>alternate</code>ã€åå‘äº¤æ›¿æ’­æ”¾ <code>alternate-reverse</code>ã€‚</p>
</li>
<li>
<p><code>animation-play-state</code>ï¼šè®¾ç½®åŠ¨ç”»æ˜¯è¿è¡Œè¿˜æ˜¯æš‚åœï¼Œæœ‰æ•ˆå€¼ <code>running</code>ã€<code>paused</code>ã€‚</p>
</li>
<li>
<p><code>animation-fill-mode</code>ï¼šè®¾ç½® CSS åŠ¨ç”»åœ¨æ‰§è¡Œä¹‹å‰å’Œä¹‹åå¦‚ä½•å°†æ ·å¼åº”ç”¨äºå…¶ç›®æ ‡ï¼Œæœ‰æ•ˆå€¼å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>none</code>ï¼šå½“åŠ¨ç”»æœªæ‰§è¡Œæ—¶ï¼ŒåŠ¨ç”»å°†ä¸ä¼šå°†ä»»ä½•æ ·å¼åº”ç”¨äºç›®æ ‡ï¼Œè€Œæ˜¯å·²ç»èµ‹äºˆç»™è¯¥å…ƒç´ çš„ CSS è§„åˆ™æ¥æ˜¾ç¤ºè¯¥å…ƒç´ ã€‚è¿™æ˜¯é»˜è®¤å€¼</li>
<li><code>forwards</code>ï¼šç›®æ ‡å°†ä¿ç•™ç”±æ‰§è¡ŒæœŸé—´é‡åˆ°çš„æœ€åä¸€ä¸ªå…³é”®å¸§è®¡ç®—å€¼ã€‚</li>
<li><code>backwards</code>ï¼šåŠ¨ç”»å°†åœ¨åº”ç”¨äºç›®æ ‡æ—¶ç«‹å³åº”ç”¨ç¬¬ä¸€ä¸ªå…³é”®å¸§ä¸­å®šä¹‰çš„å€¼ã€‚
<code>animation-timing-function</code>ï¼šè®¾ç½®åŠ¨ç”»åœ¨æ¯ä¸ªå‘¨æœŸçš„æŒç»­æ—¶é—´å†…å¦‚ä½•è¿›è¡Œï¼Œä¸»è¦æ˜¯å¦‚ä¸‹ä¸¤ç§å‡½æ•°ï¼š</li>
</ul>
</li>
<li>
<p><code>cubic-bezier</code> ä¸‰æ¬¡è´å¡å°”æ›²çº¿ ( <code>cubic-bezier(&lt;x1&gt;, &lt;y1&gt;, &lt;x2&gt;, &lt;y2&gt;)</code> )ï¼Œä»¥å®ç° <strong>è¡¥é—´åŠ¨ç”»</strong> æ•ˆæœã€‚</p>
</li>
<li>
<p><code>steps</code> æ˜¯ä¸€ä¸ªåˆ†æ®µçš„é˜¶è·ƒå‡½æ•°ï¼Œï¼Œä»¥å®ç° <strong>é€å¸§åŠ¨ç”»</strong>ã€‚n ç›¸å½“äºå•æ¬¡åŠ¨ç”»çš„å¸§æ•°ï¼Œæ¯å¸§åŠ¨ç”»çš„æ—¶é—´æ˜¯å‡ç­‰çš„ (<code>steps(n, &lt;jumpterm&gt;)</code>)ï¼Œå…¶ä¸­ <code>jumpterm (é»˜è®¤å€¼ end)</code> å«ä¹‰å¦‚ä¸‹ï¼š</p>
<ol>
<li>jump-startï¼šåœ¨èµ·å§‹ä½ç½®é˜¶è·ƒï¼Œ<code>n=2 â‡’ 50% 100%; (100 / 2)</code></li>
<li>jump-endï¼šåœ¨ç»“æŸä½ç½®é˜¶è·ƒ, <code>n=4 â‡’ 0% 25% 50% 75%; (100 / 4)</code></li>
<li>jump-noneï¼šèµ·æ­¢ä½ç½®å‡æ— è·³è·ƒï¼Œ<code>n=5 â‡’ 0% 25% 50% 75% 100%; (100 / 4)</code></li>
<li>jump-bothï¼šèµ·æ­¢ä½ç½®å‡æœ‰è·³è·ƒ <code>n=3 â‡’ 25% 50% 75%; (100 / 4)</code></li>
<li>startï¼šç­‰åŒ jump-start</li>
<li>endï¼šç­‰åŒ jump-end</li>
<li>step-startï¼šç­‰åŒ steps(1, jump-start)</li>
<li>step-endï¼šç­‰åŒ steps(1, jump-end)</li>
</ol>
</li>
</ul>
<pre><code class="hljs language-css" lang="css">  <span class="hljs-comment">/* animation å£°æ˜æ ·å¼é¡ºåº */</span> 
  <span class="hljs-comment">/* animation-duration */</span>
  <span class="hljs-comment">/* animation-easing-function */</span>
  <span class="hljs-comment">/* animation-delay */</span> 
  <span class="hljs-comment">/* animation-iteration-count */</span>
  <span class="hljs-comment">/* animation-direction */</span>
  <span class="hljs-comment">/* animation-fill-mode */</span>
  <span class="hljs-comment">/* animation-play-state */</span>
  <span class="hljs-comment">/* animation-name */</span>
  <span class="hljs-attribute">animation</span>: <span class="hljs-number">3s</span> ease-in <span class="hljs-number">1s</span> <span class="hljs-number">2</span> reverse both paused slidein; 

  
  <span class="hljs-comment">/* animation - duration | easing-function | delay | name */</span>
  <span class="hljs-attribute">animation</span>: <span class="hljs-number">3s</span> linear <span class="hljs-number">1s</span> slidein;
  
  
  <span class="hljs-comment">/* more animations - duration | easing-function | delay | name */</span>
  <span class="hljs-attribute">animation</span>: <span class="hljs-number">3s</span> linear slidein, <span class="hljs-number">3s</span> ease-out <span class="hljs-number">5s</span> slideout;

 
  <span class="hljs-comment">/* animation-name */</span>
  <span class="hljs-attribute">animation-name</span>: none;
  <span class="hljs-attribute">animation-name</span>: animate1;
  <span class="hljs-attribute">animation-name</span>: animate1, animate2;
  
  
  <span class="hljs-comment">/* animation-timing-function */</span>
  <span class="hljs-attribute">animation-timing-function</span>: ease;
  <span class="hljs-attribute">animation-timing-function</span>: step-start;
  <span class="hljs-attribute">animation-timing-function</span>: <span class="hljs-built_in">cubic-bezier</span>(<span class="hljs-number">0.1</span>, <span class="hljs-number">0.7</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0.1</span>);
  <span class="hljs-attribute">animation-timing-function</span>: ease, step-start, <span class="hljs-built_in">cubic-bezier</span>(<span class="hljs-number">0.1</span>, <span class="hljs-number">0.7</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0.1</span>);
  

</code></pre>
<h4 data-id="heading-15">css animation åŠ¨ç”»è§¦å‘æ–¹å¼</h4>
<p>å’Œcss <code>transition</code> è§¦å‘åŠ¨ç”»æ–¹å¼ç›¸ä¼¼</p>
<p><strong>æ­¤å¤–è¿˜å¯ä»¥å¢åŠ ä¸€ä¸ªå›¾å±‚ï¼Œä¸“é—¨ç”¨äºåˆ¶ä½œåŠ¨ç”»æ•ˆæœã€‚</strong></p>
<p>ä¾‹å¦‚ï¼šé¼ æ ‡åœ¨ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œä¼šæœ‰æ¶Ÿæ¼ªåŠ¨ç”»ã€‚</p>
<pre><code class="hljs language-js" lang="js">
<span class="hljs-comment">// æ¶Ÿæ¼ªåŠ¨ç”»å®šä¹‰</span>
@keyframes ripple {
  <span class="hljs-number">0</span>% {
    <span class="hljs-attr">transform</span>: <span class="hljs-title function_">scale</span>(<span class="hljs-number">0</span>);
    <span class="hljs-attr">opacity</span>: <span class="hljs-number">1</span>;
  }

  to {
    <span class="hljs-attr">transform</span>: <span class="hljs-title function_">scale</span>(<span class="hljs-number">4</span>);
    <span class="hljs-attr">opacity</span>: <span class="hljs-number">0</span>;
  }
}

<span class="hljs-comment">// å›¾å±‚åŠ¨ç”» css</span>
.<span class="hljs-property">ripple</span> {
  <span class="hljs-attr">position</span>: absolute;
  border-<span class="hljs-attr">radius</span>: <span class="hljs-number">50</span>%;
  <span class="hljs-attr">background</span>: <span class="hljs-title function_">rgba</span>(<span class="hljs-number">8</span>, <span class="hljs-number">7</span>, <span class="hljs-number">7</span>, <span class="hljs-number">0.2</span>);
  pointer-<span class="hljs-attr">events</span>: none;

  <span class="hljs-attr">animation</span>: ripple <span class="hljs-number">0.</span>6s linear;
}

<span class="hljs-comment">// åˆ¶ä½œåŠ¨ç”»  è¿™æ ·æ¯æ¬¡ç‚¹å‡»æŒ‰é’® å°±ä¼šç”ŸæˆåŠ¨ç”»ï¼ŒåŠ¨ç”»ç»“æŸä¾¿é”€æ¯åŠ¨ç”»å…ƒç´ </span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">makeAnimate</span> = (<span class="hljs-params">e: React.MouseEvent</span>) =&gt; {
  <span class="hljs-keyword">const</span> dom = e.<span class="hljs-property">currentTarget</span>;
  <span class="hljs-keyword">const</span> rect = dom.<span class="hljs-title function_">getBoundingClientRect</span>();
  <span class="hljs-keyword">const</span> x = e.<span class="hljs-property">clientX</span> - rect.<span class="hljs-property">left</span>;
  <span class="hljs-keyword">const</span> y = e.<span class="hljs-property">clientY</span> - rect.<span class="hljs-property">top</span>;
  <span class="hljs-keyword">const</span> size = <span class="hljs-number">100</span>;

  <span class="hljs-keyword">const</span> ripple = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'span'</span>);
  ripple.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">'ripple'</span>);
  ripple.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">`<span class="hljs-subst">${size}</span>px`</span>;
  ripple.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">`<span class="hljs-subst">${size}</span>px`</span>;
  ripple.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">`<span class="hljs-subst">${x - size / <span class="hljs-number">2</span>}</span>px`</span>;
  ripple.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">`<span class="hljs-subst">${y - size / <span class="hljs-number">2</span>}</span>px`</span>;
  dom.<span class="hljs-title function_">appendChild</span>(ripple);

  ripple.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'animationend'</span>, <span class="hljs-function">() =&gt;</span> {
    ripple.<span class="hljs-title function_">remove</span>();
  });
};


</code></pre>
<h2 data-id="heading-16">svg åŠ¨ç”»</h2>
<h3 data-id="heading-17">å¸¸ç”¨çš„ SMIL åŠ¨ç”»å…ƒç´ </h3>
<ul>
<li><code>&lt;animate&gt;</code>ï¼šç”¨äºåŠ¨ç”»åŒ–å•ä¸ªå±æ€§ã€‚</li>
<li><code>&lt;animateTransform&gt;</code>ï¼šç”¨äºåŠ¨ç”»åŒ–å˜æ¢å±æ€§ï¼Œå¦‚æ—‹è½¬ã€ç¼©æ”¾ã€å¹³ç§»ç­‰ã€‚</li>
<li><code>&lt;animateMotion&gt;</code>ï¼šç”¨äºæ²¿ç€è·¯å¾„åŠ¨ç”»åŒ–å…ƒç´ ã€‚ï¼ˆè·¯å¾„åŠ¨ç”»ï¼‰</li>
<li><code>&lt;set&gt;</code>ï¼šç”¨äºåœ¨æŒ‡å®šæ—¶é—´ç‚¹è®¾ç½®å±æ€§å€¼ã€‚</li>
</ul>
<pre><code class="hljs language-js" lang="js">&lt;svg width=<span class="hljs-string">"100"</span> height=<span class="hljs-string">"100"</span>&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"50"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"50"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"40"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"red"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">animate</span> <span class="hljs-attr">attributeName</span>=<span class="hljs-string">"cx"</span> <span class="hljs-attr">from</span>=<span class="hljs-string">"50"</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"150"</span> <span class="hljs-attr">dur</span>=<span class="hljs-string">"2s"</span> <span class="hljs-attr">repeatCount</span>=<span class="hljs-string">"indefinite"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">circle</span>&gt;</span></span>
&lt;/svg&gt;

</code></pre>
<h3 data-id="heading-18">svg æè¾¹åŠ¨ç”»</h3>
<p>SVGåŠ¨ç”»çš„è·¯å¾„å®ç°ä¸»è¦ä¾èµ–å±æ€§ï¼š<code>stroke</code>ï¼ˆæè¾¹ï¼‰å’ŒÂ <code>fill</code>ï¼ˆå¡«å……ï¼‰ã€‚</p>
<ul>
<li><strong>stroke</strong>ï¼šå®šä¹‰svgçš„è½®å»“çº¿ã€‚å¸¸ç”¨csså±æ€§æœ‰ï¼š <code>stroke-dasharray</code>ï¼ˆæè¾¹çš„æ ·å¼ï¼‰ï¼Œ<code>stroke-dashoffset</code>ï¼ˆèµ·å§‹ä½ç½®ï¼‰ï¼Œ<code>stroke-color</code>ï¼ˆæè¾¹çš„é¢œè‰²ï¼‰ï¼Œ<code>stroke-opacity</code>ï¼ˆæè¾¹çš„é€æ˜åº¦ï¼‰ï¼Œ<code>stroke-linecap</code>ï¼ˆæè¾¹ç«¯ç‚¹å½¢çŠ¶ï¼‰ç­‰ã€‚</li>
<li><strong>fill</strong>ï¼šå®šä¹‰svgå†…éƒ¨é¢œè‰²æˆ–å›¾æ¡ˆ ï¼Œå¸¸ç”¨csså±æ€§æœ‰<code>fill-opacity</code>(å®šä¹‰å¡«å……çš„é€æ˜åº¦), <code>fill-rule</code>(å®šä¹‰å¡«å……è§„åˆ™)ç­‰ã€‚</li>
</ul>
<h4 data-id="heading-19">stroke-dasharray ï¼ˆå®šä¹‰è™šçº¿çš„é•¿åº¦å’Œé—´éš”ï¼‰</h4>
<p>æä¾›ä¸€ä¸ªå¥‡æ•°æˆ–å¶æ•°æ•°åˆ—ï¼Œå…¶ä¸­æ•°ä¸æ•°ä¹‹é—´ç”¨é€—å·æˆ–ç©ºæ ¼éš”å¼€ï¼Œç”¨æ¥æŒ‡å®šçŸ­åˆ’çº¿å’Œç¼ºå£çš„é•¿åº¦ï¼Œå¹¶é‡å¤ã€‚ å¦‚æœæ˜¯<code>å¶æ•°æ•°åˆ—</code>ï¼Œåˆ™ä¸€ä¸ªè¡¨ç¤ºçŸ­çº¿é•¿åº¦ï¼Œä¸€ä¸ªè¡¨ç¤ºç¼ºå£é•¿åº¦ã€‚ å¦‚æœæ˜¯<code>å¥‡æ•°æ•°åˆ—</code>ï¼Œå°†å¥‡æ•°æ•°åˆ—å¤åˆ¶ä¸€ä¸ªå˜æˆå¶æ•°æ•°åˆ—ï¼Œç„¶åæŒ‰ç…§çŸ­çº¿ï¼Œç¼ºå£çš„é¡ºåºç»˜åˆ¶ã€‚</p>
<p>(å¶æ•°æ•°åˆ—) <code>stroke-dasharray="5, 5" x1="10" y1="10" x2="190" y2="10"</code>è¡¨ç¤ºä»åæ ‡ï¼ˆ10,10ï¼‰åˆ°(200,10)è¿™æ¡æ°´å¹³çº¿ä¸Šï¼ŒçŸ­åˆ’çº¿å’Œç¼ºå£éƒ½ä¸º5ä¸ªpx</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3298ea28b93c4d6b9a6693bbe89e2984~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHN4Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339795&amp;x-signature=u0p86ISTMyua61kJghaqrnV%2F23Y%3D" alt="image.png" loading="lazy"/></p>
<p>ï¼ˆå¥‡æ•°æ•°åˆ—ï¼‰ <code>stroke-dasharray="20 10 5" x1="10" y1="10" x2="190" y2="10"</code>è¡¨ç¤ºä»åæ ‡ï¼ˆ10,10ï¼‰åˆ°(200,10)è¿™æ¡æ°´å¹³çº¿ä¸Šï¼ŒçŸ­åˆ’çº¿å’Œç¼ºå£æŒ‰ç…§20 10 5 20 10 5çš„é¡ºåºæ’åˆ—ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f644bfba2884206af13d69046a6c4b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHN4Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339795&amp;x-signature=mGga%2Be5%2BvHL5XTFGp%2FJXaFN%2BJhY%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-20">stroke-dashoffset ï¼ˆå®šä¹‰è™šçº¿çš„èµ·å§‹ä½ç½®ï¼‰</h4>
<p>stroke-dashoffset å±æ€§ç”¨äºæŒ‡å®šè·¯å¾„å¼€å§‹çš„è·ç¦»(æ­£å€¼å‘å·¦åç§»ï¼Œè´Ÿå€¼å‘å³åç§»)</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b04bccdcff294be89efd61b13026531c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHN4Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767339795&amp;x-signature=JQOha66p%2BXZULeeSTsOPFCUBhDU%3D" alt="image.png" loading="lazy"/></p>
<p>æè¾¹åŠ¨ç”»ç¤ºä¾‹ï¼š</p>
<p><a href="https://code.juejin.cn/pen/7391734513644077082" target="_blank" title="https://code.juejin.cn/pen/7391734513644077082">code.juejin.cn/pen/7391734â€¦</a></p>
<h2 data-id="heading-21">js åŠ¨ç”»</h2>
<h3 data-id="heading-22">setTimeout / setInterval API</h3>
<p>è®¾å®šå®šæ—¶å™¨ï¼Œé€šè¿‡å‘¨æœŸæ€§çš„è§¦å‘é‡å¤æ‰§è¡Œç»˜åˆ¶åŠ¨ç”»çš„å‡½æ•°ï¼Œæ¥å®ç° â€œé€å¸§åŠ¨ç”»â€ çš„æ•ˆæœã€‚</p>
<ul>
<li>
<p>ä¼˜åŠ¿</p>
<ol>
<li>å…·æœ‰å¾ˆå¥½çš„æµè§ˆå™¨å…¼å®¹æ€§</li>
</ol>
</li>
<li>
<p>åŠ£åŠ¿</p>
<ol>
<li>åªèƒ½æ¥è¿‘è®¾å¤‡å±å¹•åˆ·æ–°ç‡ï¼Œæ— æ³•åšåˆ°å’Œæµè§ˆå™¨åŒæ­¥ï¼Œæ‰€ä»¥å¯èƒ½ä¼šå­˜åœ¨å¡é¡¿ã€ä¸¢å¸§ã€æŠ–åŠ¨çš„ç°è±¡</li>
<li>ç”±äºæµè§ˆå™¨å•çº¿ç¨‹æœºåˆ¶ï¼Œå­˜åœ¨é˜Ÿåˆ—ä¸­å›è°ƒå‡½æ•°è¢«é˜»å¡çš„å¯èƒ½ï¼Œæ‰€ä»¥æ— æ³•ä¿è¯æ¯ä¸€æ¬¡è°ƒç”¨çš„æ—¶é—´é—´éš”éƒ½ç›¸åŒï¼ŒæŸæ¬¡å›è°ƒå¯èƒ½ä¼šè¢«è·³è¿‡ï¼Œå¯¼è‡´è·³å¸§ã€‚</li>
</ol>
</li>
</ul>
<h3 data-id="heading-23">requestAnimationFrame API</h3>
<p>ä¸ºäº†å¼¥è¡¥ <code>setTimeout / setInterval</code> åœ¨åŠ¨ç”»æ–¹é¢çš„ä¸è¶³ï¼Œæµè§ˆå™¨æä¾›äº†ä¸ºåŠ¨ç”»è€Œç”Ÿçš„ APIï¼Œå®ƒå¯ä»¥è®© DOM åŠ¨ç”»ã€Canvas åŠ¨ç”»ã€ SVG åŠ¨ç”»ç­‰æœ‰ä¸€ä¸ªç»Ÿä¸€çš„åˆ·æ–°æœºåˆ¶ï¼Œéšç€æµè§ˆå™¨çš„å±å¹•åˆ·æ–°ï¼Œç»Ÿä¸€ç»˜åˆ¶åŠ¨ç”»å¸§ã€‚</p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-keyword">let</span> id = <span class="hljs-literal">null</span>
  
  <span class="hljs-comment">// åŠ¨ç”»å‡½æ•°</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">draw</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-comment">/* åŠ¨ç”»ç»˜åˆ¶... */</span>
  }
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">start</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">draw</span>()
    <span class="hljs-title function_">cancelAnimationFrame</span>(id)
    id = <span class="hljs-title function_">requestAnimationFrame</span>(start)
  }
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">stop</span> = (<span class="hljs-params"/>) =&gt; { <span class="hljs-title function_">cancelAnimationFrame</span>(id) }
  
</code></pre>
<ul>
<li>
<p>ä¼˜åŠ¿</p>
<ol>
<li>ç”±ç³»ç»Ÿæ¥å†³å®šå›è°ƒå‡½æ•°çš„æ‰§è¡Œæ—¶æœº, å®ƒèƒ½ä¿è¯å›è°ƒå‡½æ•°åœ¨å±å¹•æ¯ä¸€æ¬¡çš„åˆ·æ–°é—´éš”ä¸­åªè¢«æ‰§è¡Œä¸€æ¬¡, è¿™æ ·å°±ä¸ä¼šå¼•èµ·ä¸¢å¸§ç°è±¡, ä¹Ÿä¸ä¼šå¯¼è‡´åŠ¨ç”»å‡ºç°å¡é¡¿çš„é—®é¢˜ã€‚</li>
<li>åœ¨è¿è¡Œæ—¶æµè§ˆå™¨ä¼šè‡ªåŠ¨ä¼˜åŒ–æ–¹æ³•çš„è°ƒç”¨ï¼Œå¹¶ä¸”å¦‚æœé¡µé¢ä¸æ˜¯æ¿€æ´»çŠ¶æ€ä¸‹çš„è¯ï¼ŒåŠ¨ç”»ä¼šè‡ªåŠ¨æš‚åœï¼Œæœ‰æ•ˆèŠ‚çœäº†CPUçš„å¼€é”€ã€‚</li>
</ol>
</li>
<li>
<p>ä¸è¶³</p>
<ol>
<li>åŒ setTimeout/setInterval ä¸€æ ·ï¼Œå®ƒæ˜¯ä»¥é€å¸§åŠ¨ç”»çš„æ–¹å¼è¿›è¡Œç»˜åˆ¶ï¼Œæ— æ³•åšåˆ°åƒ CSS åŠ¨ç”»ï¼Œè®©æ¸¸è§ˆå™¨è‡ªåŠ¨æ ¹æ®ä¸¤å¸§ä¹‹é—´çš„å·®å¼‚åˆ›å»ºæ’å€¼ï¼Œä»¥å®ç°è¡¥é—´åŠ¨ç”»çš„è¿‡æ¸¡æ•ˆæœã€‚</li>
</ol>
</li>
</ul>
<h3 data-id="heading-24">Web Animations API</h3>
<ol>
<li><code>requestAnimationFrame</code>ã€<code>setTimeout/setInterval</code> éƒ½æ˜¯ä»¥é€å¸§ç»˜åˆ¶çš„æ–¹å¼å®ç°åŠ¨ç”»ï¼Œ è€Œ <strong>Animations API</strong> ä¸ä»…å¯ä»¥ â€œé€å¸§åŠ¨ç”»â€ï¼Œè¿˜å¯ä»¥å®ç° â€œè¡¥é—´åŠ¨ç”»â€ çš„æ•ˆæœã€‚</li>
<li>CSS åŠ¨ç”»æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œéœ€è¦äº‹å…ˆé¢„è®¾åŠ¨ç”»æ ·å¼ï¼Œè€Œä¸”æ— æ³•ä¸ JS è¿›è¡Œäº¤äº’ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œ<strong>Animations API</strong> å¯ä»¥éšæ—¶å®šä¹‰å¹¶ä½¿ç”¨åŠ¨ç”»ï¼Œè‡ªç„¶æ˜¯æ›´åŠ çµæ´»æ–¹ä¾¿ã€‚</li>
</ol>
<p>å‚è€ƒæ–‡æ¡£ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FWeb_Animations_API" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/API/Web_Animations_API" ref="nofollow noopener noreferrer">developer.mozilla.org/zh-CN/docs/â€¦</a></p>
<p>è¯­æ³•ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-keyword">const</span> element = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"container"</span>);

  <span class="hljs-keyword">const</span> animation = element.<span class="hljs-title function_">animate</span>(
    [
      { <span class="hljs-attr">transform</span>: <span class="hljs-string">"translateY(0%)"</span> },
      { <span class="hljs-attr">transform</span>: <span class="hljs-string">"translateY(100%)"</span> },
    ],
    { <span class="hljs-attr">duration</span>: <span class="hljs-number">3000</span>, <span class="hljs-attr">fill</span>: <span class="hljs-string">"forwards"</span> }
  );
  

</code></pre>
<p>ä»£ç ç¤ºä¾‹ï¼š</p>
<p><a href="https://code.juejin.cn/pen/7391799461493932069" target="_blank" title="https://code.juejin.cn/pen/7391799461493932069">code.juejin.cn/pen/7391799â€¦</a></p>
<h4 data-id="heading-25">å…³äºFlipåŠ¨ç”»</h4>
<p>æµè§ˆå™¨è®¡ç®—ä½ç½®å¾ˆå¿«ï¼Œç»˜åˆ¶å¯èƒ½å¾ˆæ…¢ã€‚åˆ©ç”¨æµè§ˆå™¨å¼ºå¤§çš„è®¡ç®—èƒ½åŠ›ï¼Œè·å–åŠ¨ç”»çš„èµ·æ­¢çŠ¶æ€ï¼Œæ¥ç€å•ç‹¬å¼€å¯ä¸€ä¸ªçº¿ç¨‹åšåŠ¨ç”»ã€‚è¿™æ ·è§¦å‘å¸ƒå±€æ›´æ–°çš„æ“ä½œï¼Œåªä¼šå‘ç”Ÿåœ¨ä¸€å¸§æ—¶é—´å†…ï¼Œå‰©ä¸‹çš„åŠ¨ç”»è·‘åœ¨å•ç‹¬çš„çº¿ç¨‹ä¸Šï¼Œä¼šæ›´æµç•…ã€‚</p>
<p>ä»‹ç»ä¸‹FLIP ã€‚</p>
<ol>
<li>F ä»£è¡¨ Firstï¼Œä¹Ÿå°±æ˜¯åŠ¨ç”»çš„å¼€å§‹çŠ¶æ€ã€‚</li>
<li>L ä»£è¡¨ Lastï¼Œä»£è¡¨åŠ¨ç”»ç»“æŸçŠ¶æ€ã€‚</li>
<li>I ä»£è¡¨ Invertï¼Œä¹Ÿå°±æ˜¯çŠ¶æ€åè½¬ï¼Œä½¿ç”¨ transform ç­‰å±æ€§ï¼Œåˆ›å»ºå•ç‹¬çš„å›¾å±‚ï¼Œå¹¶å°†å…ƒç´ çŠ¶æ€åè½¬å›å»ã€‚</li>
<li>P ä»£è¡¨ Playï¼Œæ’­æ”¾åŠ¨ç”»ã€‚</li>
</ol>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<p>å…¶ä¸­ï¼Œåœ¨åˆå§‹å¸§ä¸­ï¼Œåº”ç”¨é€†å˜æ¢ï¼ˆ<code>translate</code>Â å’ŒÂ <code>scale</code>ï¼‰ï¼Œå°†å…ƒç´ ä»å…¶æœ€ç»ˆçŠ¶æ€é€†å˜æ¢åˆ°åˆå§‹çŠ¶æ€ã€‚</p>
<p>æœ€åä¸€å¸§Â <code>transform: "none"</code>Â çš„ä½œç”¨æ˜¯å°†å…ƒç´ çš„å˜æ¢å±æ€§é‡ç½®ä¸ºå…¶æœ€ç»ˆçŠ¶æ€ã€‚å…·ä½“æ¥è¯´ï¼Œ<code>transform: "none"</code>Â è¡¨ç¤ºä¸åº”ç”¨ä»»ä½•å˜æ¢ï¼Œè¿™æ„å‘³ç€å…ƒç´ å°†æ¢å¤åˆ°ç”± CSS è®¾ç½®çš„æœ€ç»ˆä½ç½®å’Œå¤§å°ã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>FLIP Animation Example<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
    <span class="hljs-selector-id">#box</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
      <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#4caf50</span>;
      <span class="hljs-attribute">position</span>: absolute;
    }
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"box"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"animateButton"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"margin-top: 300px;"</span>&gt;</span>Animate<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">const</span> box = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'box'</span>);
    <span class="hljs-keyword">const</span> button = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'animateButton'</span>);

    button.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// First: è®°å½•åˆå§‹çŠ¶æ€</span>
      <span class="hljs-keyword">const</span> first = box.<span class="hljs-title function_">getBoundingClientRect</span>();

      <span class="hljs-comment">// ä¿®æ”¹å…ƒç´ çš„ä½ç½®</span>
      box.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-number">300</span>}</span>px`</span>;
      box.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-number">300</span>}</span>px`</span>;

      <span class="hljs-comment">// Last: è®°å½•æœ€ç»ˆçŠ¶æ€</span>
      <span class="hljs-keyword">const</span> last = box.<span class="hljs-title function_">getBoundingClientRect</span>();

      <span class="hljs-comment">// Invert: è®¡ç®—åˆå§‹çŠ¶æ€å’Œæœ€ç»ˆçŠ¶æ€ä¹‹é—´çš„å˜æ¢</span>
      <span class="hljs-keyword">const</span> deltaX = first.<span class="hljs-property">left</span> - last.<span class="hljs-property">left</span>;
      <span class="hljs-keyword">const</span> deltaY = first.<span class="hljs-property">top</span> - last.<span class="hljs-property">top</span>;
      <span class="hljs-keyword">const</span> deltaW = first.<span class="hljs-property">width</span> / last.<span class="hljs-property">width</span>;
      <span class="hljs-keyword">const</span> deltaH = first.<span class="hljs-property">height</span> / last.<span class="hljs-property">height</span>;


      <span class="hljs-comment">// åº”ç”¨ FLIP åŠ¨ç”»</span>
      box.<span class="hljs-title function_">animate</span>(
        [
          {
            <span class="hljs-attr">transformOrigin</span>: <span class="hljs-string">"top left"</span>,
            <span class="hljs-attr">transform</span>: <span class="hljs-string">`
            translate(<span class="hljs-subst">${deltaX}</span>px, <span class="hljs-subst">${deltaY}</span>px)
            scale(<span class="hljs-subst">${deltaW}</span>, <span class="hljs-subst">${deltaH}</span>)`</span>,
          },
          {
            <span class="hljs-attr">transformOrigin</span>: <span class="hljs-string">"top left"</span>,
            <span class="hljs-attr">transform</span>: <span class="hljs-string">"none"</span>,
          },
        ],
        {
          <span class="hljs-attr">duration</span>: <span class="hljs-number">300</span>,
          <span class="hljs-attr">easing</span>: <span class="hljs-string">"ease-in-out"</span>,
          <span class="hljs-attr">fill</span>: <span class="hljs-string">"both"</span>,
        }
      );
    });
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RUM èµ‹èƒ½ iOS App ç¨³å®šï¼šä»å¼‚å¸¸ä½“ç³»åˆ°ç›‘æ§æ–¹æ¡ˆçš„å…¨æ–¹ä½è§£æï¼]]></title>    <link>https://juejin.cn/post/7587961565475815478</link>    <guid>https://juejin.cn/post/7587961565475815478</guid>    <pubDate>2025-12-26T06:14:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587961565475815478" data-draft-id="7587582213060755510" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RUM èµ‹èƒ½ iOS App ç¨³å®šï¼šä»å¼‚å¸¸ä½“ç³»åˆ°ç›‘æ§æ–¹æ¡ˆçš„å…¨æ–¹ä½è§£æï¼"/> <meta itemprop="keywords" content="äº‘åŸç”Ÿ,iOS"/> <meta itemprop="datePublished" content="2025-12-26T06:14:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘äº‘åŸç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3808363977648493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RUM èµ‹èƒ½ iOS App ç¨³å®šï¼šä»å¼‚å¸¸ä½“ç³»åˆ°ç›‘æ§æ–¹æ¡ˆçš„å…¨æ–¹ä½è§£æï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808363977648493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘äº‘åŸç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T06:14:41.000Z" title="Fri Dec 26 2025 06:14:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»16åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šé«˜ç‰é¾™ï¼ˆå…ƒæ³Šï¼‰</p>
<h2 data-id="heading-0">èƒŒæ™¯ä»‹ç»</h2>
<p>App ä¸Šçº¿åï¼Œä½œä¸ºå¼€å‘åŒå­¦ï¼Œæœ€æ€•å‡ºç°çš„æƒ…å†µå°±æ˜¯åº”ç”¨å´©æºƒäº†ã€‚ä½†æ˜¯ï¼Œçº¿ä¸‹æµ‹è¯•å¥½å¥½çš„ Appï¼Œä¸ºä»€ä¹ˆä¸Šçº¿åå°±å‘ç”Ÿå´©æºƒäº†å‘¢ï¼Ÿè¿™äº›å´©æºƒæ—¥å¿—ä¿¡æ¯æ˜¯æ€ä¹ˆé‡‡é›†çš„ï¼Ÿ</p>
<p>å…ˆçœ‹çœ‹å‡ ä¸ªå¸¸è§çš„ç¼–å†™ä»£ç æ—¶çš„ç–å¿½ï¼Œæ˜¯å¦‚ä½•è®©åº”ç”¨å´©æºƒçš„ã€‚</p>
<ul>
<li>æ•°ç»„è¶Šç•Œï¼šåœ¨å–æ•°æ®ç´¢å¼•æ—¶è¶Šç•Œï¼ŒApp ä¼šå‘ç”Ÿå´©æºƒã€‚</li>
<li>å¤šçº¿ç¨‹é—®é¢˜ï¼šåœ¨å­çº¿ç¨‹ä¸­è¿›è¡Œ UI æ›´æ–°å¯èƒ½ä¼šå‘ç”Ÿå´©æºƒã€‚å¤šä¸ªçº¿ç¨‹è¿›è¡Œæ•°æ®çš„è¯»å–æ“ä½œï¼Œå› ä¸ºå¤„ç†æ—¶æœºä¸ä¸€è‡´ï¼Œæ¯”å¦‚æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨ç½®ç©ºæ•°æ®çš„åŒæ—¶å¦ä¸€ä¸ªçº¿ç¨‹åœ¨è¯»å–è¿™ä¸ªæ•°æ®ï¼Œå¯èƒ½ä¼šå‡ºç°å´©æºƒæƒ…å†µã€‚</li>
<li>ä¸»çº¿ç¨‹æ— å“åº”ï¼šå¦‚æœä¸»çº¿ç¨‹è¶…è¿‡ç³»ç»Ÿè§„å®šçš„æ—¶é—´æ— å“åº”ï¼Œå°±ä¼šè¢« Watchdog æ€æ‰ã€‚</li>
<li>é‡æŒ‡é’ˆï¼šæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªå·²åˆ é™¤çš„å¯¹è±¡è®¿é—®å†…å­˜åŒºåŸŸæ—¶ï¼Œä¼šå‡ºç°é‡æŒ‡é’ˆå´©æºƒã€‚</li>
</ul>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œé˜¿é‡Œäº‘å¯è§‚æµ‹ç ”å‘å›¢é˜Ÿè¿›è¡Œäº†ä¸€äº› iOS å¼‚å¸¸ç›‘æ§æ–¹å‘çš„æ¢ç´¢ã€‚</p>
<h2 data-id="heading-1">iOS å¼‚å¸¸ä½“ç³»ä»‹ç»</h2>
<p>iOS å¼‚å¸¸ä½“ç³»é‡‡ç”¨åˆ†å±‚æ¶æ„ï¼Œä»åº•å±‚ç¡¬ä»¶åˆ°ä¸Šå±‚åº”ç”¨ï¼Œå¼‚å¸¸åœ¨ä¸åŒå±‚æ¬¡è¢«æ•è·å’Œå¤„ç†ã€‚ç†è§£å¼‚å¸¸ä½“ç³»çš„åˆ†å±‚ç»“æ„ï¼Œæœ‰åŠ©äºæˆ‘ä»¬æ›´å¥½åœ°è®¾è®¡å’Œå®ç°å¼‚å¸¸ç›‘æ§æ–¹æ¡ˆã€‚iOS å¼‚å¸¸ä½“ç³»ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªå±‚æ¬¡ï¼š</p>
<p><strong>1. ç¡¬ä»¶å±‚å¼‚å¸¸</strong></p>
<ul>
<li>CPU å¼‚å¸¸ï¼šç”±ç¡¬ä»¶ç›´æ¥äº§ç”Ÿçš„å¼‚å¸¸ï¼Œå¦‚éæ³•æŒ‡ä»¤ã€å†…å­˜è®¿é—®é”™è¯¯ç­‰</li>
<li>è¿™æ˜¯æœ€åº•å±‚çš„å¼‚å¸¸æ¥æºï¼Œæ‰€æœ‰å…¶ä»–å¼‚å¸¸æœ€ç»ˆéƒ½æºäºæ­¤</li>
</ul>
<p><strong>2. ç³»ç»Ÿå±‚å¼‚å¸¸</strong></p>
<ul>
<li><strong>Mach å¼‚å¸¸ï¼š</strong> macOS/iOS ç³»ç»Ÿæœ€åº•å±‚çš„å¼‚å¸¸æœºåˆ¶ï¼Œæºäº Mach å¾®å†…æ ¸æ¶æ„</li>
<li><strong>Unix ä¿¡å·ï¼š</strong> Mach å¼‚å¸¸ä¼šè¢«è½¬æ¢ä¸º Unix ä¿¡å·ï¼Œå¦‚ SIGSEGVã€SIGABRT ç­‰</li>
<li>ç³»ç»Ÿå±‚å¼‚å¸¸æ˜¯åº”ç”¨å±‚å¼‚å¸¸ç›‘æ§çš„ä¸»è¦æ•è·ç‚¹</li>
</ul>
<p><strong>3. è¿è¡Œæ—¶å±‚å¼‚å¸¸</strong></p>
<ul>
<li><strong>NSExceptionï¼š</strong> Objective-C è¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¦‚æ•°ç»„è¶Šç•Œã€ç©ºæŒ‡é’ˆç­‰</li>
<li><strong>C++ å¼‚å¸¸ï¼š</strong> C++ ä»£ç æŠ›å‡ºçš„å¼‚å¸¸ï¼Œé€šè¿‡Â <code>std::terminate()</code>Â å¤„ç†</li>
<li>è¿è¡Œæ—¶å±‚å¼‚å¸¸é€šå¸¸ç”±ç¼–ç¨‹é”™è¯¯å¼•èµ·</li>
</ul>
<p><strong>4. åº”ç”¨å±‚å¼‚å¸¸</strong></p>
<ul>
<li>ä¸šåŠ¡é€»è¾‘å¼‚å¸¸ï¼šåº”ç”¨è‡ªå®šä¹‰çš„å¼‚å¸¸å’Œé”™è¯¯</li>
<li>æ€§èƒ½å¼‚å¸¸ï¼šä¸»çº¿ç¨‹æ­»é”ã€å†…å­˜æ³„æ¼ç­‰</li>
<li>åƒµå°¸å¯¹è±¡è®¿é—®ï¼šè®¿é—®å·²é‡Šæ”¾å¯¹è±¡å¯¼è‡´çš„å¼‚å¸¸</li>
</ul>
<p>å¼‚å¸¸ä½“ç³»çš„åˆ†å±‚å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/76b1aebf9fbb4fadbaa11904a79b8ebe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767334480&amp;x-signature=zzyK08sey2WdbpWl7zaCE3NfFdI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å¼‚å¸¸æ•è·çš„å±‚æ¬¡å…³ç³»ï¼š</strong></p>
<ol>
<li><strong>ç¡¬ä»¶å¼‚å¸¸ â†’ Mach å¼‚å¸¸ï¼š</strong> CPU å¼‚å¸¸è¢« Mach å†…æ ¸æ•è·ï¼Œè½¬æ¢ä¸º Mach å¼‚å¸¸æ¶ˆæ¯</li>
<li><strong>Mach å¼‚å¸¸ â†’ Unix ä¿¡å·ï¼š</strong> Mach å¼‚å¸¸å¤„ç†æœºåˆ¶ä¼šå°†å¼‚å¸¸è½¬æ¢ä¸ºå¯¹åº”çš„ Unix ä¿¡å·</li>
<li><strong>è¿è¡Œæ—¶å¼‚å¸¸ï¼š</strong> NSException å’Œ C++ å¼‚å¸¸åœ¨è¿è¡Œæ—¶å±‚è¢«æ•è·ï¼Œå¦‚æœæœªå¤„ç†ä¼šè§¦å‘ç³»ç»Ÿå±‚å¼‚å¸¸</li>
<li><strong>åº”ç”¨å±‚å¼‚å¸¸ï¼š</strong> ä¸šåŠ¡å¼‚å¸¸å’Œæ€§èƒ½é—®é¢˜éœ€è¦åº”ç”¨å±‚ä¸»åŠ¨ç›‘æ§å’Œæ£€æµ‹</li>
</ol>
<p>å¼‚å¸¸ç›‘æ§ç­–ç•¥ï¼š</p>
<ul>
<li><strong>ç³»ç»Ÿå±‚ç›‘æ§ï¼š</strong> é€šè¿‡ Mach å¼‚å¸¸å’Œ Unix ä¿¡å·æ•è·ï¼Œå¯ä»¥æ•è·æ‰€æœ‰åº•å±‚å¼‚å¸¸</li>
<li><strong>è¿è¡Œæ—¶å±‚ç›‘æ§ï¼š</strong> é€šè¿‡è®¾ç½®å¼‚å¸¸å¤„ç†å™¨ï¼ˆNSUncaughtExceptionHandlerã€terminate handlerï¼‰æ•è·è¿è¡Œæ—¶å¼‚å¸¸</li>
<li><strong>åº”ç”¨å±‚ç›‘æ§ï¼š</strong> é€šè¿‡ä¸»åŠ¨æ£€æµ‹æœºåˆ¶ï¼ˆæ­»é”æ£€æµ‹ã€åƒµå°¸å¯¹è±¡æ£€æµ‹ï¼‰å‘ç°æ½œåœ¨é—®é¢˜</li>
</ul>
<p>ç†è§£è¿™ä¸ªåˆ†å±‚ä½“ç³»ï¼Œæœ‰åŠ©äºæˆ‘ä»¬ï¼š</p>
<ul>
<li>é€‰æ‹©åˆé€‚çš„å¼‚å¸¸æ•è·æœºåˆ¶</li>
<li>ç†è§£ä¸åŒå¼‚å¸¸ç±»å‹çš„æ¥æºå’Œå¤„ç†æ–¹å¼</li>
<li>è®¾è®¡å®Œæ•´çš„å¼‚å¸¸ç›‘æ§æ–¹æ¡ˆ</li>
</ul>
<h2 data-id="heading-2">ä¸»æµå¼‚å¸¸ç›‘æ§æ–¹æ¡ˆ</h2>
<p>åœ¨ iOS ç«¯ä¾§å¼‚å¸¸ç›‘æ§é¢†åŸŸï¼ŒPLCrashReporter ä¸ KSCrash æ˜¯æœ€å¸¸ç”¨çš„ä¸¤ä¸ªå†…æ ¸åº“ã€‚ä¸¤è€…éƒ½æ˜¯å¼€æºã€ç”Ÿäº§å¯ç”¨ï¼Œä¸”è¢«å¤šå®¶å¹³å°åŒ–äº§å“æˆ– SDK é‡‡ç”¨ä½œä¸ºåº•å±‚èƒ½åŠ›ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0f29cd5dfb83449980eb292e7409ed2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767334480&amp;x-signature=nhC8P4pByPRX5VXdRbIYWE%2BUw6Q%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åŸºäºä»¥ä¸Šå¯¹æ¯”åˆ†æï¼ŒKSCrash ç›¸æ¯”å…¶ä»–å´©æºƒç›‘æ§æ¡†æ¶çš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼š</p>
<ul>
<li>å¼‚å¸¸ç±»å‹ç›‘æµ‹æ”¯æŒæ›´å…¨é¢ï¼ˆå”¯ä¸€åŒæ—¶æ”¯æŒ C++ å¼‚å¸¸ã€æ­»é”æ£€æµ‹ã€åƒµå°¸å¯¹è±¡æ£€æµ‹çš„å¼€æºæ¡†æ¶ï¼‰</li>
<li>å¼‚æ­¥å®‰å…¨è®¾è®¡ï¼ˆå´©æºƒå¤„ç†å®Œå…¨å¼‚æ­¥å®‰å…¨ï¼ŒåŒé‡å¼‚å¸¸å¤„ç†çº¿ç¨‹ç¡®ä¿å¯é æ€§ï¼‰</li>
<li>æŠ€æœ¯ä¼˜åŠ¿æ˜æ˜¾ï¼ˆå †æ ˆæ¸¸æ ‡æŠ½è±¡ã€å†…å­˜å†…çœã€æ¨¡å—åŒ–æ¶æ„ç­‰ï¼‰</li>
</ul>
<p>åŸºäºä»¥ä¸Šä¼˜åŠ¿ï¼Œæˆ‘ä»¬é€‰æ‹©åŸºäº KSCrash ä½œä¸ºå´©æºƒå¼‚å¸¸ç›‘æ§çš„æ ¸å¿ƒæ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-3">å¼‚å¸¸ç›‘æ§æ–¹æ¡ˆå®ç°</h2>
<h3 data-id="heading-4">æ¶æ„è®¾è®¡</h3>
<p>å¼‚å¸¸é‡‡é›†æ¨¡å—ï¼Œæ˜¯æˆ‘ä»¬ SDK æ•°æ®é‡‡é›†å±‚ä¸€ä¸ªæ¨¡å—çš„å…·ä½“å®ç°ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c4730892e98c423789008773cf0038fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767334480&amp;x-signature=d6x5g7bs%2FbB4M4nyDRVhY7qu3G0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>ç›‘æ§å™¨ç®¡ç†å±‚ï¼šç»Ÿä¸€ç®¡ç†æ‰€æœ‰ç›‘æ§å™¨ï¼Œæä¾›ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†å…¥å£</li>
<li>å¼‚å¸¸æ•è·å±‚ï¼šå¤šç§ç›‘æ§å™¨ï¼Œåˆ†åˆ«æ•è·ä¸åŒç±»å‹çš„å¼‚å¸¸å’ŒçŠ¶æ€ä¿¡æ¯</li>
<li>å¼‚å¸¸å¤„ç†å±‚ï¼šæ„å»ºå´©æºƒä¸Šä¸‹æ–‡ï¼Œæ”¶é›†å †æ ˆã€ç¬¦å·ã€å†…å­˜ç­‰ä¿¡æ¯</li>
<li>æŠ¥å‘Šç”Ÿæˆå±‚ï¼šå°†å´©æºƒä¸Šä¸‹æ–‡è½¬æ¢ä¸º JSON æ ¼å¼æŠ¥å‘Š</li>
</ul>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä»‹ç»å„ç§ç±»å‹å¼‚å¸¸çš„æ•è·åŸç†ï¼Œä»¥åŠå¯¹åº”ç›‘æ§å™¨æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p>
<h3 data-id="heading-5">ç³»ç»Ÿå±‚å¼‚å¸¸æ•è·</h3>
<p>ç³»ç»Ÿå±‚å¼‚å¸¸åŒ…æ‹¬ Mach å¼‚å¸¸å’Œ Unix ä¿¡å·ï¼Œæ˜¯åº”ç”¨å±‚å¼‚å¸¸ç›‘æ§çš„ä¸»è¦æ•è·ç‚¹ã€‚æˆ‘ä»¬éœ€è¦åŒæ—¶æ•è·è¿™ä¸¤ç§å¼‚å¸¸ï¼Œç¡®ä¿ä¸é—æ¼ä»»ä½•åº•å±‚å¼‚å¸¸ã€‚</p>
<p><strong>Mach å¼‚å¸¸æ•è·</strong></p>
<p>Mach å¼‚å¸¸æ˜¯ macOS/iOS ç³»ç»Ÿæœ€åº•å±‚çš„å¼‚å¸¸æœºåˆ¶ï¼Œæºäº Mach å¾®å†…æ ¸æ¶æ„ã€‚Mach æ˜¯ macOS/iOS å†…æ ¸çš„åŸºç¡€ï¼Œæä¾›äº†è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰å’Œå¼‚å¸¸å¤„ç†çš„æ ¸å¿ƒæœºåˆ¶ã€‚ç¡¬ä»¶å¼‚å¸¸ï¼ˆCPU å¼‚å¸¸ï¼‰ä¼šè¢« Mach å†…æ ¸æ•è·å¹¶è½¬æ¢ä¸º Mach å¼‚å¸¸æ¶ˆæ¯ã€‚Mach å¼‚å¸¸ä¸ç‰¹å®šçº¿ç¨‹å…³è”ï¼Œå¯ä»¥ç²¾ç¡®æ•è·å¼‚å¸¸å‘ç”Ÿçš„çº¿ç¨‹ã€‚Mach å¼‚å¸¸é€šè¿‡ Mach æ¶ˆæ¯å¼‚æ­¥ä¼ é€’å¼‚å¸¸ä¿¡æ¯ï¼Œéœ€è¦ä½¿ç”¨ Mach ç«¯å£ï¼ˆMach Portï¼‰ä½œä¸ºå¼‚å¸¸å¤„ç†çš„é€šä¿¡é€šé“ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/35c0d189c0114803beb1b2c3c7350419~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767334480&amp;x-signature=6dddWt9JW1BUAqL59282SzA1J10%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç›‘æ§ Mach å¼‚å¸¸ï¼Œæ¶‰åŠä»¥ä¸‹å‡ ä¸ªæ ¸å¿ƒçš„æ­¥éª¤ï¼š</p>
<p><strong>1. åˆ›å»ºå¼‚å¸¸ç«¯å£</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// åˆ›å»ºæ–°çš„å¼‚å¸¸å¤„ç†ç«¯å£</span>
<span class="hljs-built_in">mach_port_allocate</span>(mach_task_self(), MACH_PORT_RIGHT_RECEIVE, &amp;g_exceptionPort);
<span class="hljs-comment">// ç”³è¯·ç«¯å£æƒé™</span>
<span class="hljs-built_in">mach_port_insert_right</span>(mach_task_self(), g_exceptionPort, g_exceptionPort, MACH_MSG_TYPE_MAKE_SEND);
</code></pre>
<p>ä¸ºäº†ä¸ä¸‰æ–¹ SDK å…¼å®¹ï¼Œåœ¨åˆ›å»ºæ–°çš„å¼‚å¸¸å¤„ç†ç«¯å£ä¹‹å‰ï¼Œéœ€è¦å¯¹æ—§çš„å¼‚å¸¸å¤„ç†ç«¯å£è¿›è¡Œä¿å­˜ï¼Œå¹¶åœ¨å¼‚å¸¸å¤„ç†å®Œæ¯•åæ¢å¤æ—§çš„å¼‚å¸¸ç«¯å£ã€‚</p>
<p><strong>2. æ³¨å†Œå¼‚å¸¸å¤„ç†å™¨</strong></p>
<p>æŠŠå¼‚å¸¸å¤„ç†ç«¯å£è®¾ç½®ä¸ºåˆšæ‰åˆ›å»ºçš„ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// è®¾ç½®å¼‚å¸¸ç«¯å£ï¼Œæ•è·æ‰€æœ‰å¼‚å¸¸ç±»å‹</span>
<span class="hljs-built_in">task_set_exception_ports</span>(
    mach_task_self(),
    EXC_MASK_ALL,
    g_exceptionPort,
    EXCEPTION_DEFAULT,
    MACHINE_THREAD_STATE
);
</code></pre>
<p><strong>3. åˆ›å»ºå¼‚å¸¸å¤„ç†çº¿ç¨‹</strong></p>
<p>ä¸ºäº†é˜²æ­¢å¼‚å¸¸å¤„ç†çº¿ç¨‹æœ¬èº«å´©æºƒï¼Œéœ€è¦åˆ›å»ºä¸¤ä¸ªç‹¬ç«‹çš„å¼‚å¸¸å¤„ç†çº¿ç¨‹ï¼š</p>
<ul>
<li>ä¸»å¤„ç†çº¿ç¨‹ï¼šæ­£å¸¸å¤„ç†å¼‚å¸¸</li>
<li>å¤‡ç”¨å¤„ç†çº¿ç¨‹ï¼šä¸»å¤„ç†çº¿ç¨‹å´©æºƒæ—¶çš„åå¤‡ä»½æ–¹æ¡ˆ</li>
</ul>

<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// ä¸»å¼‚å¸¸å¤„ç†çº¿ç¨‹</span>
<span class="hljs-built_in">pthread_create</span>(&amp;g_primaryPThread, &amp;attr, handleExceptions, kThreadPrimary);
<span class="hljs-comment">// å¤‡ç”¨å¼‚å¸¸å¤„ç†çº¿ç¨‹ï¼ˆé˜²æ­¢ä¸»çº¿ç¨‹å´©æºƒï¼‰</span>
<span class="hljs-built_in">pthread_create</span>(&amp;g_secondaryPThread, &amp;attr, handleExceptions, kThreadSecondary);
</code></pre>
<p>ä¸»å¤‡çº¿ç¨‹ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca5e38d3619b404c86fbae5a052a8be3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767334480&amp;x-signature=XzQr3NIkoc132BvsNpFWRMg7rc8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>å¤‡ç”¨å¤„ç†çº¿ç¨‹åœ¨åˆ›å»ºåä¼šç«‹å³æŒ‚èµ·</li>
<li>ä¸»çº¿ç¨‹åœ¨å¤„ç†å¼‚å¸¸ä¹‹å‰ä¼šé€šè¿‡Â <code>thread_resume()</code> å‡½æ•°æ¢å¤å¤‡ç”¨å¤„ç†çº¿ç¨‹</li>
<li>å¤‡ç”¨å¤„ç†çº¿ç¨‹æ¢å¤åï¼Œä¼šè¿›å…¥Â <code>mach_msg()</code>Â ç­‰å¾…</li>
<li>å¦‚æœä¸»çº¿ç¨‹åœ¨å¤„ç†å¼‚å¸¸æ—¶å‘ç”Ÿå´©æºƒï¼Œå¤‡ç”¨å¤„ç†çº¿ç¨‹å¯ä»¥ç»§ç»­å¤„ç†å´©æºƒä¿¡æ¯ï¼ˆç”±äºå¼‚å¸¸ç«¯å£å·²æ¢å¤ï¼Œæ­¤æ—¶å¤‡ç”¨çº¿ç¨‹å¯èƒ½ä¹Ÿæ”¶ä¸åˆ°æ¶ˆæ¯ï¼‰</li>
</ul>
<p><strong>4. å¤„ç†å¼‚å¸¸æ¶ˆæ¯</strong></p>
<p>å¼‚å¸¸å¤„ç†çº¿ç¨‹é€šè¿‡Â <code>mach_msg()</code>Â æ¥æ”¶å¼‚å¸¸æ¶ˆæ¯ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">mach_msg_return_t <span class="hljs-attr">kr</span> = mach_msg(
Â  Â  &amp;exceptionMessage.header,
Â  Â  MACH_RCV_MSG | MACH_RCV_LARGE,
Â  Â Â 0,
Â  Â Â sizeof(exceptionMessage),
Â  Â  g_exceptionPort,
Â  Â  MACH_MSG_TIMEOUT_NONE,
Â  Â  MACH_PORT_NULL
)<span class="hljs-comment">;</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ae5dc7535ed4d51ad9d3caab43e8d72~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767334480&amp;x-signature=yHdgCmOAVfmpLNNDLSStow2R7z0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>æŒ‚èµ·æ‰€æœ‰çº¿ç¨‹ï¼šç¡®ä¿çŠ¶æ€ä¸€è‡´æ€§</li>
<li>æ ‡è®°å·²æ•è·å¼‚å¸¸ï¼šè¿›å…¥å¼‚æ­¥å®‰å…¨æ¨¡å¼</li>
<li>æ¿€æ´»å¤‡ç”¨å¤„ç†çº¿ç¨‹</li>
<li>è¯»å–å¼‚å¸¸çº¿ç¨‹çš„æœºå™¨çŠ¶æ€</li>
<li>åˆå§‹åŒ–å †æ ˆæ¸¸æ ‡</li>
<li>æ„å»ºå¼‚å¸¸ä¸Šä¸‹æ–‡
<ul>
<li>å¼‚å¸¸ç±»å‹</li>
<li>æœºå™¨çŠ¶æ€</li>
<li>åœ°å€ä¿¡æ¯ç­‰</li>
<li>å †æ ˆæ¸¸æ ‡</li>
</ul>
</li>
<li>ç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼šä¸åŒå¼‚å¸¸ç±»å‹ç»Ÿä¸€å¤„ç†</li>
<li>æ¢å¤çº¿ç¨‹</li>
</ul>
<p><strong>Unix ä¿¡å·æ•è·</strong></p>
<p>ä½œä¸º Mach å¼‚å¸¸æ•è·çš„è¡¥å……ï¼Œä¹Ÿéœ€è¦ç›´æ¥æ•è· Unix ä¿¡å·ï¼Œç¡®ä¿åœ¨ Mach å¼‚å¸¸å¤„ç†å¤±è´¥æ—¶ï¼Œä»èƒ½æ•è·åˆ°å´©æºƒã€‚Unix ä¿¡å·çš„æ•è·å¤„ç†æ¶‰åŠï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f6d860e25174edbadabe9c1bafb0d10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767334480&amp;x-signature=skXpLyxNJhC%2BTEX27GcWy8BADvw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¸ºäº†èƒ½å¤Ÿé€šè¿‡ Unix ä¿¡å·æ•è·åˆ°å¼‚å¸¸ï¼Œéœ€è¦å…ˆå®‰è£…ä¿¡å·å¤„ç†å™¨ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// è·å–ä¿¡å·åˆ—è¡¨
constÂ int* <span class="hljs-attr">fatal_signals</span> = signal_fatal_signals()<span class="hljs-comment">;</span>
// é…ç½®ä¿¡å·åŠ¨ä½œ
structÂ sigaction <span class="hljs-attr">action</span> = {{<span class="hljs-number">0</span>}}<span class="hljs-comment">;</span>
<span class="hljs-attr">action.sa_flags</span> = SA_SIGINFO | SA_ONSTACK<span class="hljs-comment">;</span>
<span class="hljs-attr">action.sa_sigaction</span> = &amp;signal_handle_signals<span class="hljs-comment">;</span>
// å®‰è£…ä¿¡å·å¤„ç†å™¨
sigaction(fatal_signal, &amp;action, &amp;previous_signal_handler)<span class="hljs-comment">;</span>
</code></pre>
<p>Unix ä¿¡å·çš„äº§ç”Ÿä¸»è¦æœ‰ä»¥ä¸‹æƒ…å†µï¼š</p>
<ul>
<li><strong>æ¥è‡ª Mach å¼‚å¸¸ï¼š</strong> å¦‚æœ Mach å¼‚å¸¸æœªè¢«åº”ç”¨å±‚å¤„ç†ï¼Œç³»ç»Ÿä¼šå°†å…¶è½¬æ¢ä¸ºå¯¹åº”çš„ Unix ä¿¡å·</li>
<li><strong>ç›´æ¥äº§ç”Ÿï¼š</strong> å¦‚è°ƒç”¨Â <code>abort()</code>Â ç›´æ¥äº§ç”ŸÂ <code>SIGABRT</code>ï¼Œæˆ– NSException/C++ å¼‚å¸¸æœªæ•è·æ—¶äº§ç”Ÿçš„ä¿¡å·</li>
</ul>
<p>å½“ä¿¡å·äº§ç”Ÿåï¼Œç³»ç»Ÿä¼šæ‰¾åˆ°æˆ‘ä»¬å®‰è£…çš„ä¿¡å·å¤„ç†å™¨ï¼Œå¹¶è°ƒç”¨æˆ‘ä»¬æ³¨å†Œçš„ä¿¡å·å¤„ç†å‡½æ•°ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-function"><span class="hljs-type">void</span>Â <span class="hljs-title">signal_handle_signals</span><span class="hljs-params">(<span class="hljs-type">int</span>Â sig_num,Â <span class="hljs-type">siginfo_t</span>Â *signal_info,Â <span class="hljs-type">void</span>* user_context)</span>
</span>{
Â Â <span class="hljs-comment">// sig_num: ä¿¡å·ç¼–ç ï¼Œå¦‚ SIGSEGV=11</span>
Â Â <span class="hljs-comment">// signal_info: ä¿¡å·è¯¦ç»†ä¿¡æ¯</span>
Â Â <span class="hljs-comment">// Â  Â  - si_signo: ä¿¡å·ç¼–ç </span>
Â Â <span class="hljs-comment">// Â  Â  - si_code: ä¿¡å·ä»£ç ï¼Œå¦‚ SEGV_MAPERR</span>
Â Â <span class="hljs-comment">// Â  Â  - si_addr: å¼‚å¸¸åœ°å€</span>
Â Â <span class="hljs-comment">// user_context: CPU å¯„å­˜å™¨çŠ¶æ€</span>
}
</code></pre>
<p>åç»­å¯¹å¼‚å¸¸çš„å¤„ç†ï¼ŒåŒ Mach å¼‚å¸¸å¤„ç†æµç¨‹ã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong> å¹¶éæ‰€æœ‰å¼‚å¸¸éƒ½æºäº Mach å¼‚å¸¸ã€‚ä¾‹å¦‚ï¼ŒNSException æœªæ•è·æ—¶é€šå¸¸ä¼šè°ƒç”¨Â abort()Â äº§ç”ŸÂ SIGABRTÂ ä¿¡å·ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸ç»è¿‡ Mach å¼‚å¸¸ã€‚å› æ­¤ï¼Œå¼‚å¸¸ç›‘æ§éœ€è¦åŒæ—¶æ•è· Mach å¼‚å¸¸ã€Unix ä¿¡å·å’Œè¿è¡Œæ—¶å¼‚å¸¸å¤„ç†å™¨ã€‚</p>
<p><strong>æœºå™¨ä¸Šä¸‹æ–‡å †æ ˆ</strong></p>
<p>åœ¨å´©æºƒå‘ç”Ÿæ—¶ï¼Œå †æ ˆè¿½è¸ªå¯ä»¥å¸®åŠ©å¼€å‘è€…å®šä½é—®é¢˜å‘ç”Ÿçš„ä»£ç ä½ç½®ã€‚åœ¨åŸºäº Mach æˆ– Unix ä¿¡å·æ•è·çš„åœºæ™¯ï¼Œéœ€è¦ä» CPU å¯„å­˜å™¨å’Œå †æ ˆå†…å­˜ä¸­æ¢å¤å®Œæ•´çš„è°ƒç”¨æ ˆã€‚æ ¸å¿ƒåŸç†ï¼šæ¯ä¸ªå‡½æ•°è°ƒç”¨ï¼Œéƒ½ä¼šåœ¨å †æ ˆä¸Šåˆ›å»ºä¸€ä¸ªå †æ ˆå¸§ï¼ŒåŒ…å«ï¼š</p>
<ul>
<li>è¿”å›åœ°å€ï¼šå‡½æ•°è¿”å›åç»§ç»­æ‰§è¡Œçš„åœ°å€</li>
<li>å¸§æŒ‡é’ˆï¼ˆFPï¼‰ï¼šæŒ‡å‘å½“å‰å †æ ˆå¸§çš„æŒ‡é’ˆ</li>
<li>å±€éƒ¨å˜é‡ï¼šå‡½æ•°çš„å±€éƒ¨å˜é‡</li>
<li>å‚æ•°ï¼šä¼ é€’ç»™å‡½æ•°çš„å‚æ•°</li>
</ul>
<p>ä»¥ ARM64 æ¶æ„ä¸ºä¾‹ï¼Œå †æ ˆå¸ƒå±€å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/099216b95aa4478cac47a9cd15ac3e98~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767334480&amp;x-signature=YtbZzRyYfPBZadWwgKPFTBEm%2BAw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¸ºäº†è¿˜åŸå´©æºƒå‘ç”Ÿæ—¶çš„è°ƒç”¨æ ˆï¼Œæˆ‘ä»¬éœ€è¦å¯¹å †æ ˆå¸§è¿›è¡Œéå†ã€‚å †æ ˆå¸§éå†çš„æ ¸å¿ƒåŸç†æ˜¯é€šè¿‡å¸§æŒ‡é’ˆé“¾å‘ä¸Šéå†ï¼š</p>
<ol>
<li>ç¬¬ 1 å¸§ï¼šä» PC å¯„å­˜å™¨è·å–å½“å‰å´©æºƒç‚¹</li>
<li>ç¬¬ 2 å¸§ï¼šä» LR å¯„å­˜å™¨è·å–è°ƒç”¨è€…</li>
<li>ç¬¬ 3 å¸§åŠä»¥åï¼šé€šè¿‡å¸§æŒ‡é’ˆé“¾ä»å †æ ˆå†…å­˜ä¸­è¯»å–</li>
</ol>
<p>å †æ ˆå¸§éå†çš„å®Œæ•´æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e2e5e22119d4b01a814ca6696db3e5a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767334480&amp;x-signature=bz2WYghwQBfsVqw5G%2Bhjp7th4N4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ¨å †æ ˆéå†è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸‹é¢å‡ ä¸ªå…³é”®ç‚¹éœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li>åœ¨éå†å †æ ˆæ—¶ï¼Œå¿…é¡»å®‰å…¨åœ°è®¿é—®å†…å­˜ï¼Œé˜²æ­¢è®¿é—®æ— æ•ˆå†…å­˜å¯¼è‡´å´©æºƒ</li>
<li>å †æ ˆæº¢å‡ºæ£€æµ‹ï¼Œé˜²æ­¢åœ¨å †æ ˆæŸåæ—¶æ— é™éå†</li>
<li>åœ°å€è§„èŒƒåŒ–ï¼Œä¸åŒ CPU æ¶æ„çš„åœ°å€å¯èƒ½æœ‰ç‰¹æ®Šæ ‡è®°ï¼Œéœ€è¦è§„èŒƒåŒ–å¤„ç†</li>
</ul>
<h3 data-id="heading-6">è¿è¡Œæ—¶å¼‚å¸¸æ•è·</h3>
<p>è¿è¡Œæ—¶å¼‚å¸¸åŒ…æ‹¬ NSException å’Œ C++ å¼‚å¸¸ï¼Œé€šå¸¸ç”±ç¼–ç¨‹é”™è¯¯å¼•èµ·ã€‚æˆ‘ä»¬éœ€è¦é€šè¿‡è®¾ç½®å¼‚å¸¸å¤„ç†å™¨æ¥æ•è·è¿™äº›æœªå¤„ç†çš„å¼‚å¸¸ã€‚</p>
<p><strong>NSException å¼‚å¸¸æ•è·</strong></p>
<p>iOS éœ€è¦é€šè¿‡è®¾ç½®Â <code>NSUncaughtExceptionHandler</code>Â æ¥æ•è·æœªæ•è·çš„Â <code>NSException</code>ã€‚</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// åœ¨è®¾ç½®exception handlerä¹‹å‰ï¼Œå…ˆä¿å­˜ä¹‹å‰çš„è®¾ç½®</span>
NSUncaughtExceptionHandlerÂ *previous_uncaught_exceptionhandler =Â <span class="hljs-built_in">NSGetUncaughtExceptionHandler</span>();
<span class="hljs-comment">// è®¾ç½®æˆ‘ä»¬çš„exception handler</span>
<span class="hljs-built_in">NSSetUncaughtExceptionHandler</span>(&amp;handle_uncaught_exception);
</code></pre>
<p>å½“Â <code>Objective-C</code> ä»£ç æŠ›å‡ºå¼‚å¸¸ï¼Œä¸”æœªè¢«Â <code>@catch</code> å—æ•è·æ—¶ï¼Œ<code>Objective-C</code>Â è¿è¡Œæ—¶ä¼šè°ƒç”¨æˆ‘ä»¬è®¾ç½®çš„å¼‚å¸¸å¤„ç†å™¨ã€‚åœ¨å¤„ç†å®ŒÂ <code>NSException</code> å¼‚å¸¸åï¼Œè¿˜éœ€è¦ä¸»åŠ¨è°ƒç”¨Â <code>previous_uncaught_exceptionhandler</code>ï¼Œä»¥ä¾¿å…¶ä»–å¼‚å¸¸å¤„ç†å™¨èƒ½å¤Ÿæ­£ç¡®å¤„ç†å¼‚å¸¸ã€‚</p>
<p>æ³¨æ„ï¼šåœ¨å¼‚å¸¸ç›‘æ§åœºæ™¯ä¸­ï¼Œé€šå¸¸éœ€è¦åœ¨ handler ä¸­æ”¶é›†å®Œå´©æºƒä¿¡æ¯åï¼Œä¸»åŠ¨è°ƒç”¨Â <code>abort()</code>Â æ¥ç»ˆæ­¢ç¨‹åºï¼Œç¡®ä¿ç¨‹åºä¸ä¼šåœ¨å¼‚å¸¸çŠ¶æ€ä¸‹ç»§ç»­è¿è¡Œã€‚</p>
<p>åœ¨æ•è·åˆ° NSException å¼‚å¸¸ä¹‹åï¼Œä¸€èˆ¬é€šè¿‡ä»¥ä¸‹æ–¹å¼è·å– Objective-C çš„è°ƒç”¨æ ˆä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">// NSException æä¾›äº† callStackReturnAddresses
NSArray* <span class="hljs-attr">addresses</span> = [exception callStackReturnAddresses]<span class="hljs-comment">;</span>
</code></pre>
<p>é€šè¿‡Â [NSException callStackReturnAddresses]Â è·å–åˆ°Â return addressÂ ä¹‹åï¼Œè¿˜éœ€è¦è¿›ä¸€æ­¥å¤„ç†ï¼Œå¦‚ï¼šè¿‡æ»¤æ‰æ— æ•ˆåœ°å€ç­‰ã€‚</p>
<p><strong>C++ å¼‚å¸¸æ•è·</strong></p>
<p>é€šè¿‡è®¾ç½® C++ terminate handler å¯ä»¥æ•è·æœªå¤„ç†çš„ CÂ å¼‚å¸¸ã€‚å½“ CÂ å¼‚å¸¸æœªè¢«æ•è·æ—¶ï¼ŒC++ è¿è¡Œæ—¶ä¼šè°ƒç”¨Â std::terminate()ï¼Œæˆ‘ä»¬é€šè¿‡æ‹¦æˆªè¿™ä¸ªè°ƒç”¨æ¥æ•è·å¼‚å¸¸ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// ä¿å­˜åŸå§‹ terminate handler</span>
<span class="hljs-built_in">std</span>::terminate_handler original_terminate_handler = <span class="hljs-built_in">std</span>::get_terminate();
<span class="hljs-comment">// è®¾ç½®æˆ‘ä»¬çš„ terminate handler</span>
<span class="hljs-built_in">std</span>::set_terminate(cpp_exception_terminate_handler);
</code></pre>
<p>å½“ CÂ ä»£ç æŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œthrow è¯­å¥ä¼šè°ƒç”¨Â <code>__cxa_throw()</code>ï¼ŒCÂ è¿è¡Œæ—¶ä¼šæŸ¥æ‰¾åŒ¹é…çš„Â <code>catch</code> å—ï¼Œå¦‚æœæœªæ‰¾åˆ°å¼‚å¸¸ä¼šç»§ç»­å‘ä¸Šä¼ æ’­ã€‚å½“å¼‚å¸¸æœªè¢«æ•è·æ—¶ï¼š</p>
<ol>
<li>C++ è¿è¡Œæ—¶ä¼šè°ƒç”¨Â <code>std::terminate()</code></li>
<li><code>std::terminate()</code> ä¼šè°ƒç”¨å·²æ³¨å†Œçš„ terminate handler</li>
<li>æˆ‘ä»¬è®¾ç½®çš„Â <code>cpp_exception_terminate_handler</code> ä¼šè¢«è°ƒç”¨</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bcb389325124486098131f56af994f28~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767334480&amp;x-signature=ULSbW9hGyFRtAc%2BKSLiodN0aVdk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ¨æˆ‘ä»¬çš„ terminate handler ä¸­å¤„ç†å®Œå¼‚å¸¸åï¼Œè¿˜éœ€è¦è°ƒç”¨åŸå§‹çš„ terminate handlerï¼Œä»¥ä¾¿å…¶ä»–å¼‚å¸¸å¤„ç†å™¨èƒ½æ­£ç¡®å¤„ç†å¼‚å¸¸ã€‚</p>
<h3 data-id="heading-7">åº”ç”¨å±‚å¼‚å¸¸æ•è·</h3>
<p>åº”ç”¨å±‚å¼‚å¸¸åŒ…æ‹¬ä¸šåŠ¡é€»è¾‘å¼‚å¸¸å’Œæ€§èƒ½é—®é¢˜ï¼Œéœ€è¦åº”ç”¨å±‚ä¸»åŠ¨ç›‘æ§å’Œæ£€æµ‹ã€‚ä¸»è¦åŒ…æ‹¬ä¸»çº¿ç¨‹æ­»é”æ£€æµ‹å’Œåƒµå°¸å¯¹è±¡æ£€æµ‹ã€‚</p>
<p><strong>ä¸»çº¿ç¨‹æ­»é”æ£€æµ‹</strong></p>
<p>ä¸»çº¿ç¨‹æ­»é”ï¼ˆDeadlockï¼‰æ˜¯ iOS å¼€å‘ä¸­ä¸€ç§ä¸¥é‡çš„è¿è¡Œæ—¶é—®é¢˜ï¼Œä¼šå¯¼è‡´ App ç•Œé¢å®Œå…¨å¡æ­»ï¼ˆæ— å“åº”ï¼‰ï¼Œæœ€ç»ˆé€šå¸¸ä¼šè¢«ç³»ç»Ÿçš„çœ‹é—¨ç‹—ï¼ˆWatchdogï¼‰å¼ºåˆ¶ç»ˆæ­¢ã€‚</p>
<p>é’ˆå¯¹è¿™ç±»é—®é¢˜ï¼Œä¸€ç§å¯è¡Œçš„æ–¹å¼æ˜¯é€šè¿‡â€œçœ‹é—¨ç‹—â€æœºåˆ¶æ£€æµ‹ä¸»çº¿ç¨‹æ­»é”ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6487ae311c5479ba0924a7605ce55eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767334480&amp;x-signature=0n%2BwJEAMGc6wAHg5EBkWJKgwXm0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ol>
<li>ç›‘æ§çº¿ç¨‹ï¼šç‹¬ç«‹çš„ç›‘æ§çº¿ç¨‹ï¼Œå®šæœŸæ£€æŸ¥ä¸»çº¿ç¨‹çŠ¶æ€</li>
<li>å¿ƒè·³æœºåˆ¶ï¼šå‘ä¸»çº¿ç¨‹å‘é€â€œå¿ƒè·³â€ä»»åŠ¡ï¼Œæ£€æŸ¥æ˜¯å¦åŠæ—¶å“åº”</li>
<li>æ­»é”åˆ¤å®šï¼šå¦‚æœä¸»é˜Ÿåˆ—åœ¨æŒ‡å®šæ—¶é—´å†…æœªå“åº”ï¼Œåˆ™åˆ¤å®šä¸ºæ­»é”</li>
</ol>
<p><strong>éœ€è¦æ³¨æ„ï¼š</strong></p>
<ul>
<li>è¯¯æŠ¥é£é™©ï¼šå¦‚æœä¸»çº¿ç¨‹æœ‰é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ï¼Œå¯èƒ½äº§ç”Ÿè¯¯æŠ¥</li>
<li>è¶…æ—¶æ—¶é—´ï¼šéœ€è¦æ ¹æ®åº”ç”¨å®é™…æƒ…å†µï¼Œè°ƒæ•´è¶…æ—¶æ—¶é—´ï¼Œé¿å…è¯¯æŠ¥</li>
</ul>
<p><strong>åƒµå°¸å¯¹è±¡æ£€æµ‹</strong></p>
<p>iOS åƒµå°¸å¯¹è±¡ï¼ˆZombie Objectï¼‰æ˜¯ iOS å¼€å‘ä¸­å¯¼è‡´åº”ç”¨å´©æºƒï¼ˆCrashï¼‰æœ€å¸¸è§çš„å†…å­˜é—®é¢˜ä¹‹ä¸€ã€‚åƒµå°¸å¯¹è±¡æ˜¯æŒ‡å·²ç»è¢«é‡Šæ”¾ï¼ˆdeallocï¼‰çš„å†…å­˜å—ï¼Œä½†å¯¹åº”çš„æŒ‡é’ˆä»ç„¶æŒ‡å‘è¿™å—å†…å­˜ï¼Œå¹¶ä¸”ä»£ç è¯•å›¾é€šè¿‡è¿™ä¸ªæŒ‡é’ˆå»è®¿é—®å®ƒï¼ˆå‘é€æ¶ˆæ¯ï¼‰ã€‚è®¿é—®åƒµå°¸å¯¹è±¡å¯èƒ½ä¼šå¯¼è‡´å´©æºƒï¼Œé€šå¸¸è¡¨ç°ä¸ºÂ <code>EXC_BAD_ACCESS</code> å´©æºƒã€‚</p>
<ul>
<li>è¿™æ˜¯ä¸€ä¸ªå†…å­˜è®¿é—®é”™è¯¯ï¼Œæ„å‘³ç€ä½ è¯•å›¾è®¿é—®ä¸€å—ä½ æ— æ³•è®¿é—®æˆ–æ— æ•ˆçš„å†…å­˜ã€‚</li>
<li>å› ä¸ºè¿™å—å†…å­˜å¯èƒ½å·²ç»è¢«ç³»ç»Ÿå›æ”¶å¹¶åˆ†é…ç»™äº†å…¶ä»–å¯¹è±¡ï¼Œæˆ–è€…å˜æˆäº†ä¸€å—æ‚ä¹±çš„æ•°æ®åŒºåŸŸï¼Œæ‰€ä»¥è®¿é—®ç»“æœæ˜¯ä¸å¯é¢„çŸ¥çš„ã€‚</li>
</ul>
<p>äº§ç”Ÿåƒµå°¸å¯¹è±¡çš„åŸå› ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li><strong>unsafe_unretained æˆ– assign æŒ‡é’ˆï¼š</strong> å¦‚æœä¸€ä¸ªå±æ€§è¢«ä¿®é¥°ä¸º assignï¼ˆä¿®é¥°å¯¹è±¡æ—¶ï¼‰æˆ– unsafe_unretainedï¼Œå½“å¯¹è±¡è¢«é‡Šæ”¾åï¼ŒæŒ‡é’ˆä¸ä¼šè‡ªåŠ¨ç½®ä¸º nilï¼ˆå˜æˆæ‚¬å‚æŒ‡é’ˆï¼‰ã€‚æ­¤æ—¶å†æ¬¡è®¿é—®å°±ä¼šå˜æˆåƒµå°¸å¯¹è±¡è®¿é—®</li>
<li><strong>å¤šçº¿ç¨‹ç«äº‰ï¼š</strong> çº¿ç¨‹ A åˆšåˆšé‡Šæ”¾äº†å¯¹è±¡ï¼Œä½†çº¿ç¨‹ B å‡ ä¹åŒæ—¶åœ¨å°è¯•è®¿é—®è¯¥å¯¹è±¡</li>
<li><strong>CoreFoundation ä¸ ARC çš„æ¡¥æ¥ä¸å½“ï¼š</strong> åœ¨ä½¿ç”¨Â <code>__bridgeï¼Œ__bridge_transfer</code> ç­‰è½¬æ¢æ—¶ï¼Œæ‰€æœ‰æƒç®¡ç†æ··ä¹±å¯¼è‡´å¯¹è±¡è¿‡æ—©é‡Šæ”¾</li>
<li>Block æˆ– Delegate å¾ªç¯å¼•ç”¨ï¼šæŸäº›è€æ—§ä»£ç ä¸­ Delegate ä¾ç„¶ä½¿ç”¨ assign ä¿®é¥°</li>
</ul>
<p>åƒµå°¸å¯¹è±¡æ£€æµ‹çš„ä¸»è¦æ€è·¯æ˜¯ï¼š</p>
<ol>
<li>hookÂ <code>NSObject</code>Â å’ŒÂ <code>NSProxy</code>Â çš„Â <code>dealloc</code>Â æ–¹æ³•</li>
<li>åœ¨å¯¹è±¡é‡Šæ”¾æ—¶ï¼Œè®¡ç®—å¯¹è±¡çš„ hashï¼Œç„¶åè®°å½• class ä¿¡æ¯</li>
<li>æ£€æµ‹æ˜¯å¦ä¸º NSExceptionï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ä¿å­˜å¼‚å¸¸è¯¦æƒ…</li>
<li>å„ç±»å¼‚å¸¸å‘ç”Ÿæ—¶ï¼Œè¯»å–ä¿å­˜çš„å¼‚å¸¸è¯¦æƒ…</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b7c0d27c2c47429193d02f1d7c870287~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767334480&amp;x-signature=LMI%2Bq89hqhBpfdHcBQU6d2Wjp3Y%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>ä¸ºäº†é™ä½ CPU å’Œå†…å­˜å ç”¨ï¼Œåƒµå°¸å¯¹è±¡çš„è®°å½•ä¸Šé™æ˜¯Â <code>0x8000</code> ä¸ªï¼Œå³ï¼š32768</li>
<li>è®¡ç®—å“ˆå¸Œæ—¶ï¼Œé€šè¿‡Â <code>((uintptr_t)object &gt;&gt; (sizeof(uintptr_t) - 1)) &amp; 0x7FFF</code> è®¡ç®—</li>
</ul>
<p>è¿™æ˜¯ä¸€ç§è®¾è®¡æƒè¡¡çš„ç»“æœã€‚å› ä¸ºè¿™ç§æ£€æµ‹æ–¹å¼å¹¶ä¸æ˜¯éå¸¸å‡†ç¡®ï¼Œä¸èƒ½æ•è·æ‰€æœ‰åƒµå°¸å¯¹è±¡ã€‚å› ä¸º hash çš„è®¡ç®—ä¼šäº§ç”Ÿä¸€å®šçš„ç¢°æ’ï¼Œå¯¼è‡´å¯¹è±¡è¢«è¦†ç›–ï¼Œå¯èƒ½ä¼šäº§ç”Ÿè¯¯æŠ¥æˆ–é”™è¯¯çš„ç±»å‹ã€‚</p>
<h3 data-id="heading-8">è¿è¡Œæ—¶ç¬¦å·åŒ–</h3>
<p>åœ¨å¼‚å¸¸ç›‘æ§ç³»ç»Ÿä¸­ï¼Œé™¤äº†éœ€è¦æ£€æµ‹å’Œè®°å½•å¼‚å¸¸ç±»å‹ï¼ˆå¦‚åƒµå°¸å¯¹è±¡è®¿é—®ã€ä¸»çº¿ç¨‹æ­»é”ç­‰ï¼‰ï¼Œè¿˜éœ€è¦å¤„ç†å¼‚å¸¸å‘ç”Ÿæ—¶çš„å †æ ˆä¿¡æ¯ã€‚å †æ ˆä¿¡æ¯é€šå¸¸ä»¥å†…å­˜åœ°å€çš„å½¢å¼å­˜åœ¨ï¼Œè¿™äº›åœ°å€å¯¹äºå¼€å‘è€…æ¥è¯´æ˜¯ä¸å¯è¯»çš„ã€‚ä¸ºäº†èƒ½å¤Ÿå¿«é€Ÿå®šä½é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™äº›å†…å­˜åœ°å€è½¬æ¢ä¸ºå¯è¯»çš„å‡½æ•°åã€æ–‡ä»¶åå’Œè¡Œå·ä¿¡æ¯ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ç¬¦å·åŒ–ï¼ˆSymbolicationï¼‰ã€‚</p>
<p>ç¬¦å·åŒ–ä¸€èˆ¬åˆ†ä¸ºä¸¤ç§ï¼š</p>
<ul>
<li>è¿è¡Œæ—¶ç¬¦å·åŒ–ï¼šä½¿ç”¨Â <code>dladdr()</code>Â è·å–ç¬¦å·ä¿¡æ¯ï¼ˆå‡½æ•°åã€é•œåƒåç­‰ï¼‰</li>
<li>å®Œæ•´ç¬¦å·åŒ–ï¼šä½¿ç”¨Â <code>dSYM</code> æ–‡ä»¶è·å–æ–‡ä»¶åå’Œè¡Œå·</li>
</ul>
<p>è¿è¡Œæ—¶ç¬¦å·åŒ–åªèƒ½è·å–å…¬å¼€ç¬¦å·ã€‚</p>
<p>æˆ‘ä»¬ä¸»è¦è®¨è®º iOS å¹³å°ä¸Šå¦‚ä½•åœ¨è¿è¡Œæ—¶ç¬¦å·åŒ–ã€‚iOS å¹³å°ä¸»è¦é€šè¿‡Â <code>dladdr()</code> è¿›è¡Œè¿è¡Œæ—¶ç¬¦å·åŒ–ï¼Œé€šè¿‡Â <code>dladdr()</code> å¯ä»¥è·å–åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p>
<ul>
<li>imageAddressï¼šimage é•œåƒåŸºå€</li>
<li>imageNameï¼šimage é•œåƒè·¯å¾„</li>
<li>symbolAddressï¼šç¬¦å·åœ°å€</li>
<li>symbolNameï¼šç¬¦å·åç§°</li>
</ul>
<p>ç”±äºåœ¨ç¬¦å·åŒ–æ—¶ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯è°ƒç”¨æŒ‡ä»¤çš„åœ°å€ï¼Œä½†å †æ ˆä¸Šå­˜å‚¨çš„æ˜¯è¿”å›åœ°å€ï¼Œå› æ­¤éœ€è¦å¯¹åœ°å€è°ƒæ•´ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">å‡½æ•°è°ƒç”¨è¿‡ç¨‹ï¼š
<span class="hljs-number">1</span>.Â è°ƒç”¨æŒ‡ä»¤ï¼šcall function_name Â (åœ°å€: <span class="hljs-number">0</span>x1000)
<span class="hljs-number">2</span>. å‡½æ•°æ‰§è¡Œï¼š<span class="hljs-built_in">function_name</span>() Â  Â  (åœ°å€: <span class="hljs-number">0</span>x2000)
<span class="hljs-number">3</span>.Â è¿”å›åœ°å€ï¼š<span class="hljs-number">0</span>x1001 Â  Â  Â  Â  Â  Â  Â (å­˜å‚¨åœ¨å †æ ˆä¸Š)
å †æ ˆä¸Šå­˜å‚¨çš„æ˜¯è¿”å›åœ°å€ï¼ˆ<span class="hljs-number">0</span>x1001ï¼‰ï¼Œ
ä½†æˆ‘ä»¬éœ€è¦çš„æ˜¯è°ƒç”¨æŒ‡ä»¤çš„åœ°å€ï¼ˆ<span class="hljs-number">0</span>x1000ï¼‰ï¼Œæ‰€ä»¥éœ€è¦å‡ <span class="hljs-number">1</span>ã€‚
</code></pre>
<p>ä¸åŒ CPU æ¶æ„å¯¹åº”çš„åœ°å€è°ƒæ•´æœ‰æ‰€ä¸åŒï¼Œä»¥ ARM64 ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">uintptr_tÂ <span class="hljs-attr">address</span> = (return_address &amp;~Â <span class="hljs-number">3</span>UL) -Â <span class="hljs-number">1</span><span class="hljs-comment">;</span>
</code></pre>
<p>è¿è¡Œæ—¶ç¬¦å·åŒ–çš„å®Œæ•´æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb54f323bba147a8918aeb3f53574e3b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767334480&amp;x-signature=Ax3vBc8u8orTPHE5xV3Vj9O7deI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-9">å¼‚æ­¥å®‰å…¨</h3>
<p>é™¤äº†ä»¥ä¸Šå†…å®¹å¤–ï¼Œåœ¨å¤„ç† iOS å¹³å°å¼‚å¸¸æ•è·æ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å…³æ³¨å¼‚æ­¥å®‰å…¨ã€‚</p>
<p>åœ¨ Unix ä¿¡å·å¤„ç†å‡½æ•°ï¼Œæˆ– Mach å¼‚å¸¸å¤„ç†ä¸­ï¼Œåªèƒ½ä½¿ç”¨å¼‚æ­¥å®‰å…¨å‡½æ•°ï¼Œä¸»è¦æ˜¯å› ä¸ºï¼š</p>
<ul>
<li>å´©æºƒæ—¶ç³»ç»ŸçŠ¶æ€ä¸ç¨³å®š</li>
<li>å¯èƒ½æŒæœ‰é”ï¼Œè°ƒç”¨éå¼‚æ­¥å®‰å…¨å‡½æ•°å¯èƒ½å¯¼è‡´æ­»é”</li>
<li>å †å¯èƒ½å·²æŸåï¼Œæ­¤æ—¶åˆ†é…å†…å­˜å¯èƒ½ä¼šå¤±è´¥</li>
</ul>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ<code>malloc()</code>ã€<code>free()</code>ã€<code>NSLog()</code>ã€<code>printf()</code>ï¼ŒObjective-CÂ æ–¹æ³•çš„è°ƒç”¨ï¼Œä»»ä½•å¯èƒ½åˆ†é…å†…å­˜çš„å‡½æ•°éƒ½ä¸å…è®¸åœ¨å¤„ç†å¼‚å¸¸è¿‡ç¨‹ä¸­è°ƒç”¨ã€‚</p>
<h2 data-id="heading-10">ç»“è¯­å’Œå±•æœ›</h2>
<p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº†å½“ä¸‹ä¸»æµçš„ iOS å¼‚å¸¸ç›‘æ§æ–¹æ¡ˆï¼Œå’ŒåŸºäº KSCrash çš„å¼‚å¸¸ç›‘æ§å®ç°ç»†èŠ‚ï¼ŒåŒ…æ‹¬ Machã€Unix ä¿¡å·ã€NSException ç­‰å¼‚å¸¸ç±»å‹çš„æ•è·çš„å¤„ç†ç­‰ã€‚å¼‚å¸¸ç›‘æ§èƒ½åŠ›è¿˜åœ¨æŒç»­è¿›åŒ–ï¼Œåç»­è¿˜æœ‰ä¸å°‘å¯ä»¥ä¼˜åŒ–å’Œæå‡çš„ç‚¹ï¼Œå¦‚æ”¯æŒå®æ—¶ä¸Šä¼ å’Œå´©æºƒå›è°ƒï¼Œæ”¯æŒ App æ—¥å¿—è®°å½•ï¼Œdump å¯„å­˜å™¨åœ°å€é™„è¿‘å†…å­˜ç­‰ã€‚ç›®å‰è¿™å¥—æ–¹æ¡ˆå·²ç»åº”ç”¨åœ¨é˜¿é‡Œäº‘ç”¨æˆ·ä½“éªŒç›‘æ§ RUM iOS SDK ä¸­ï¼Œæ‚¨å¯ä»¥å‚è€ƒæ¥å…¥æ–‡æ¡£ <strong>[</strong> <strong>1]</strong> ä½“éªŒä½¿ç”¨ã€‚é˜¿é‡Œäº‘ RUM SDK å½“å‰ä¹Ÿæ”¯æŒ Android ã€ HarmonyOS ã€Web ç­‰å¹³å°ä¸‹å¼‚å¸¸ç›‘æ§èƒ½åŠ›ã€‚ç›¸å…³é—®é¢˜å¯ä»¥åŠ å…¥â€œRUMç”¨æˆ·ä½“éªŒç›‘æ§æ”¯æŒç¾¤â€ï¼ˆé’‰é’‰ç¾¤å·ï¼š67370002064ï¼‰è¿›è¡Œå’¨è¯¢ã€‚</p>
<p><strong>ç›¸å…³é“¾æ¥ï¼š</strong></p>
<p>[1]Â æ¥å…¥æ–‡æ¡£</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhelp.aliyun.com%2Fzh%2Farms%2Fuser-experience-monitoring%2Fmonitor-ios-apps%2F" target="_blank" title="https://help.aliyun.com/zh/arms/user-experience-monitoring/monitor-ios-apps/" ref="nofollow noopener noreferrer">help.aliyun.com/zh/arms/useâ€¦</a></p>
<p>ç‚¹å‡»<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.aliyun.com%2Fproduct%2Farms%3Fspm%3Da1z389.11499242.0.0.65452413yOc5rP%26utm_content%3Dg_1000408142" target="_blank" title="https://www.aliyun.com/product/arms?spm=a1z389.11499242.0.0.65452413yOc5rP&amp;utm_content=g_1000408142" ref="nofollow noopener noreferrer">æ­¤å¤„</a>æŸ¥çœ‹äº§å“è¯¦æƒ…ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ«æ•°æ®åº“â€œè†¨èƒ€â€ï¼šDify x SLS æ„å»ºé«˜å¯ç”¨ç”Ÿäº§çº§ AI æ¶æ„]]></title>    <link>https://juejin.cn/post/7587961565477060662</link>    <guid>https://juejin.cn/post/7587961565477060662</guid>    <pubDate>2025-12-26T09:04:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587961565477060662" data-draft-id="7587825268200112134" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ«æ•°æ®åº“â€œè†¨èƒ€â€ï¼šDify x SLS æ„å»ºé«˜å¯ç”¨ç”Ÿäº§çº§ AI æ¶æ„"/> <meta itemprop="keywords" content="äº‘åŸç”Ÿ"/> <meta itemprop="datePublished" content="2025-12-26T09:04:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘äº‘åŸç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3808363977648493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ«æ•°æ®åº“â€œè†¨èƒ€â€ï¼šDify x SLS æ„å»ºé«˜å¯ç”¨ç”Ÿäº§çº§ AI æ¶æ„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808363977648493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘äº‘åŸç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T09:04:57.000Z" title="Fri Dec 26 2025 09:04:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»16åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šæ— å“²ã€è¨€åˆ</p>
<h2 data-id="heading-0">ä¸€ã€å‰è¨€ï¼šDify çš„è§„æ¨¡åŒ–æŒ‘æˆ˜</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e4b96578c324f8eb575aa3e339537b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=7esT50KRWjTd1U1Li%2FrZwedPkkw%3D" alt="image.png" loading="lazy"/></p>
<p>Dify æ˜¯å½“å‰æœ€å—æ¬¢è¿çš„ä½ä»£ç  LLM åº”ç”¨å¼€å‘å¹³å°ä¹‹ä¸€ï¼Œåœ¨ Github ä¸Šå·²æ–©è· 120k+ çš„æ˜Ÿæ ‡æ•°ã€‚å›½å†…å¤–æœ‰ä¼—å¤šä¼ä¸šåŸºäº Dify æ„å»ºè‡ªå·±çš„æ™ºèƒ½ä½“åº”ç”¨ã€‚é˜¿é‡Œäº‘å¯è§‚æµ‹å›¢é˜Ÿæ—¢æ˜¯ Dify çš„æ·±åº¦ç”¨æˆ·ï¼Œä¹Ÿæ˜¯ç¤¾åŒºçš„æ´»è·ƒè´¡çŒ®è€…ã€‚</p>
<p>åœ¨å¤§è§„æ¨¡ç”Ÿäº§å®è·µä¸­ï¼Œæˆ‘ä»¬å‘ç° Dify åœ¨é«˜è´Ÿè½½åœºæ™¯ä¸‹é¢ä¸´æ˜¾è‘—çš„æ•°æ®åº“æ€§èƒ½ç“¶é¢ˆï¼šå…¶æ‰§è¡Œå¼•æ“é«˜åº¦ä¾èµ– PostgreSQLï¼Œå•æ¬¡ Chat è¯·æ±‚å¯èƒ½è§¦å‘æ•°ç™¾ç”šè‡³ä¸Šåƒæ¬¡æ•°æ®åº“è®¿é—®ï¼›ä¸æ­¤åŒæ—¶ï¼ŒWorker è¿›ç¨‹åœ¨çŸ¥è¯†åº“ç´¢å¼•æ„å»ºã€Trace è¿½è¸ªç­‰ä»»åŠ¡ä¸­ä¹Ÿä¼šæŒç»­å†™å…¥å¤§é‡æ•°æ®ã€‚è¿™é¢‘ç¹å¯¼è‡´Â <strong>DB è¿æ¥æ± æ‰“æ»¡ã€æ…¢æŸ¥è¯¢é¢‘å‘</strong>Â ç­‰é—®é¢˜ï¼Œå·²æˆä¸ºåˆ¶çº¦ Dify é›†ç¾¤æ¨ªå‘æ‰©å±•ä¸å¹¶å‘èƒ½åŠ›çš„å…³é”®ç“¶é¢ˆã€‚</p>
<h2 data-id="heading-1">äºŒã€ç°çŠ¶ä¸æŒ‘æˆ˜ï¼šDify å­˜å‚¨æœºåˆ¶ç—›ç‚¹åˆ†æ</h2>
<h3 data-id="heading-2">æ•°æ®åˆ†å¸ƒç°çŠ¶</h3>
<p>Dify çš„æ•°æ®ä¸»è¦åˆ†ä¸ºä¸‰ç±»ï¼š</p>
<ul>
<li>Metaç±» æ•°æ®ï¼šç§Ÿæˆ·ã€åº”ç”¨ã€å·¥ä½œæµã€å·¥å…·ç­‰é…ç½®ä¿¡æ¯ï¼›</li>
<li>è¿è¡Œæ—¶æ—¥å¿—ï¼šå·¥ä½œæµæ‰§è¡Œæ˜ç»†ã€ä¼šè¯å†å²ã€æ¶ˆæ¯è®°å½•ç­‰ï¼›</li>
<li>æ–‡ä»¶ç±»æ•°æ®ï¼šç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ã€çŸ¥è¯†åº“æ–‡æ¡£ã€å¤šæ¨¡æ€è¾“å‡ºç­‰ï¼ˆé€šå¸¸å­˜äºå¯¹è±¡å­˜å‚¨ï¼‰ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb0cebf88890443fb5ef43fed477af9f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=mu7eRrlsWT0j5mRMUmkGPBTi5rA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å…¶ä¸­Meta ä¸è¿è¡Œæ—¥å¿—å‡å­˜å‚¨åœ¨ PostgreSQL ä¸­ï¼Œè¿è¡Œæ—¶æ—¥å¿—å æ®äº†æ•°æ®åº“çš„ç»å¤§éƒ¨åˆ†èµ„æºã€‚ä»¥æˆ‘ä»¬çš„ç”Ÿäº§ç¯å¢ƒä¸ºä¾‹ï¼Œè¿è¡Œæ—¥å¿—å  DB å­˜å‚¨ç©ºé—´çš„Â 95%ä»¥ä¸Šã€‚åœ¨è®¿é—®é¢‘ç‡æœ€é«˜å’Œæ…¢æŸ¥è¯¢æœ€å¤šçš„ SQL æ¨¡å¼ä¸­ï¼Œç»å¤§å¤šæ•°éƒ½ä¸è¿è¡Œæ—¥å¿—çš„è¯»å†™ç›¸å…³ã€‚</p>
<p>Dify çš„è¿è¡Œæ—¥å¿—åŒ…å«å·¥ä½œæµçš„æ‰§è¡Œæ˜ç»†è®°å½•å’Œä¼šè¯æ¶ˆæ¯æ•°æ®ï¼Œæ‰§è¡Œè®°å½•ä¸­æœ‰å·¥å…·è¾“å‡ºã€æ¨¡å‹ä¸Šä¸‹æ–‡ç­‰å¤§é‡é•¿æ–‡æœ¬ä¿¡æ¯ï¼Œå¹¶ä¸”è¿è¡Œæ—¥å¿—æ•°é‡ä¹Ÿä¼šéšç€ç”¨æˆ·è¯·æ±‚å¿«é€Ÿå¢é•¿ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b166d94d3d384e4c9c9080eb2c5a9c2f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=jBNWY8hOhvSbzd04lV8HEOsR%2BSY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-3">æ ¸å¿ƒç—›ç‚¹</h3>
<p>å°†è¿™ç±»æµ·é‡ã€é«˜ååçš„æ—¥å¿—æ•°æ®å…¨é‡å­˜å‚¨åœ¨ PostgreSQL ä¸­ï¼Œå¸¦æ¥äº†å¤šé‡æŒ‘æˆ˜ï¼š</p>
<ul>
<li><strong>è´Ÿè½½å‹åŠ›å¤§ï¼š</strong> Workflow èŠ‚ç‚¹çš„æ¯æ¬¡æ‰§è¡Œéƒ½ä¼šäº§ç”Ÿæ˜ç»†æ—¥å¿—ï¼ˆèŠ‚ç‚¹æ‰§è¡Œæ˜ç»†æ•°æ®ï¼Œè®°å½•èŠ‚ç‚¹çš„è¾“å…¥è¾“å‡ºå’Œè¿è¡ŒçŠ¶æ€ç­‰æ•°æ®ï¼‰ï¼Œé«˜å¹¶å‘ä¸‹Â <code>workflow_node_executions</code>Â è¡¨çš„è¯»å†™ææ˜“æˆä¸ºçƒ­ç‚¹ã€‚</li>
<li><strong>è¿æ¥å ç”¨ï¼š</strong> å°½ç®¡ Dify 1.xÂ çš„å‡ ä¸ªç‰ˆæœ¬å¯¹æ•°æ®åº“é•¿è¿æ¥é—®é¢˜åšäº†å¾ˆå¤šä¼˜åŒ–ï¼ˆå¦‚Â issueÂ #22307[1]ï¼‰ï¼Œä½†æ—¥å¿—å¯†é›†è®¿é—®ä»åŠ å‰§è¿æ¥æ± å‹åŠ›ï¼Œå½±å“æ ¸å¿ƒä¸šåŠ¡çš„è¿æ¥è·å–ã€‚</li>
<li><strong>æ‰©å±•æ€§ä¸è¶³ï¼š</strong> è¿è¡Œæ—¥å¿—éšç€ä¸šåŠ¡é‡å‘ˆçˆ†å‘å¼å¢é•¿ï¼Œè€Œ PG æ‰©å®¹ä¾èµ–å‚ç›´å‡é…ï¼Œå‡çº§è§„æ ¼å¾€å¾€ä¼´éšä¸»å¤‡åˆ‡æ¢å¯¼è‡´çš„è¿æ¥é—ªæ–­æˆ–ç»´æŠ¤çª—å£ï¼Œéš¾ä»¥å®ç°å®Œå…¨çš„æ— æ„Ÿæ‰©å®¹ã€‚ç¤¾åŒºå·²æœ‰å¤šä¸ªåé¦ˆï¼ˆå¦‚Â Â issueÂ #18800Â [2]å› ä¼šè¯æ•°æ®å †ç§¯å¯¼è‡´é¦– Token å»¶è¿Ÿå¢åŠ  3 ç§’ï¼›Â issueÂ #22796Â [3]å‘¼åå°†æ—¥å¿—è¿å‡º PGï¼‰</li>
<li><strong>åˆ†æåŠ å·¥èƒ½åŠ›ç¼ºå¤±ï¼š</strong> æ§åˆ¶å°ä»…æ”¯æŒæœ‰é™å…³é”®è¯æ£€ç´¢ï¼Œéš¾ä»¥æ»¡è¶³ä¸šåŠ¡å¯¹å†å²ä¼šè¯è¿›è¡Œå¤šç»´åˆ†æã€äºŒæ¬¡åŠ å·¥åŠç²¾ç»†åŒ–è¿è¥çš„éœ€æ±‚ã€‚</li>
</ul>
<h3 data-id="heading-4">ç¤¾åŒºçš„ç§¯ææ¢ç´¢ä¸æ¼”è¿›</h3>
<p>è¿è¡Œæ—¥å¿—å­˜å‚¨ä¸€ç›´æ˜¯å½±å“ Dify ç³»ç»Ÿæ€§èƒ½ä¸ç¨³å®šæ€§çš„ç—›ç‚¹ã€‚é’ˆå¯¹è¿™ä¸€é—®é¢˜ï¼Œç¤¾åŒºä¸€ç›´åœ¨ç§¯æå¯»æ±‚è§£å†³æ–¹æ¡ˆï¼Œå¹¶å·²è½åœ°äº†å¤šé¡¹ä¼˜åŒ–æªæ–½ï¼š</p>
<ul>
<li><strong>å†…å­˜æ•°æ®åº“</strong>ï¼ˆissueÂ #20147[4]ï¼‰ï¼šé€‚ç”¨äºæ— éœ€æŒä¹…åŒ–çš„è½»é‡åœºæ™¯ï¼ŒåŒæ—¶æ–°ç‰ˆæ‰§è¡Œå¼•æ“å·²å®Œæˆæ—¥å¿—å­˜å‚¨æŠ½è±¡ï¼Œä¸ºåç»­å¼‚æ„å­˜å‚¨æ”¹é€ å¥ å®šäº†åŸºç¡€ã€‚</li>
<li><strong>åå°å¼‚æ­¥æ‰§è¡Œ</strong>ï¼ˆ issueÂ #20050[5]ï¼‰ï¼šé€šè¿‡ Celery Worker å¼‚æ­¥å†™å…¥æ—¥å¿—ï¼Œæœ‰æ•ˆé™ä½äº†æ ¸å¿ƒé“¾è·¯çš„å»¶è¿Ÿï¼Œå‡è½»äº† API å¼•æ“å¯¹ DB çš„åŒæ­¥ä¾èµ–ã€‚</li>
<li><strong>å‘¨æœŸæ€§æ¸…ç†</strong>ï¼ˆ issueÂ #23399[6]ï¼‰ï¼šå¼•å…¥è‡ªåŠ¨æ¸…ç†æœºåˆ¶ï¼Œå®šæœŸç§»é™¤é™ˆæ—§çš„ä¼šè¯ä¸æ‰§è¡Œè®°å½•ï¼Œæœ‰æ•ˆç¼“è§£äº†æ•°æ®åº“å­˜å‚¨è†¨èƒ€é—®é¢˜ã€‚</li>
<li><strong>å¤§å­—æ®µåˆ†ç¦»å­˜å‚¨ï¼š</strong> é’ˆå¯¹ LLM é•¿ä¸Šä¸‹æ–‡å¯¼è‡´çš„å¤§å­—æ®µé—®é¢˜ï¼Œæ”¯æŒå°†è¶…é•¿å­—æ®µæˆªæ–­å¹¶è½¬å­˜è‡³å¯¹è±¡å­˜å‚¨ï¼Œå‡è½»äº† DB çš„ I/O å‹åŠ›ã€‚</li>
</ul>
<h3 data-id="heading-5">æ ¹å› åˆ†æï¼šæ•°æ®ç‰¹å¾ä¸å­˜å‚¨å¼•æ“çš„é”™é…</h3>
<p>ä¸Šè¿°ä¼˜åŒ–åœ¨ç‰¹å®šé˜¶æ®µéå¸¸æœ‰æ•ˆï¼Œç¼“è§£äº† Dify çš„ç‡ƒçœ‰ä¹‹æ€¥ï¼Œä½†åœ¨å¤§è§„æ¨¡ç”Ÿäº§åœºæ™¯ä¸‹ï¼Œåº”ç”¨å±‚çš„é€»è¾‘ä¼˜åŒ–ï¼ˆå¼‚æ­¥ã€æ¸…ç†ç­‰ï¼‰å·²è§¦åŠå¤©èŠ±æ¿ã€‚è¦å½»åº•è§£å†³æ‰©å±•æ€§é—®é¢˜ï¼Œå¿…é¡»æ¶ˆé™¤æ•°æ®ç‰¹å¾ä¸å­˜å‚¨å¼•æ“çš„é”™é…â€”â€”å³æˆ‘ä»¬ä¸€ç›´åœ¨è¯•å›¾ç”¨â€œå…³ç³»å‹æ•°æ®åº“â€å»æ‰¿è½½æœ¬è¯¥ç”±â€œæ—¥å¿—ç³»ç»Ÿâ€å¤„ç†çš„æ•°æ®ã€‚</p>
<p>Dify å·¥ä½œæµè®°å½•è™½ç„¶å¹¶éå®Œå…¨æ˜¯Append-Onlyå†™ï¼Œä½†å…·æœ‰é²œæ˜çš„æ—¥å¿—ç‰¹å¾ï¼Œä¸å…¸å‹çš„ä¸šåŠ¡æ•°æ®ï¼ˆå¦‚ç”¨æˆ·ä¿¡æ¯ã€åº”ç”¨é…ç½®ï¼‰æˆªç„¶ä¸åŒï¼š</p>
<ul>
<li><strong>ç»ˆæ€ä¸å¯å˜ï¼š</strong> è®°å½•ä»…åœ¨æ‰§è¡ŒæœŸçŸ­æš‚æµè½¬ï¼Œç»“æŸåå³æˆä¸ºâ€œåªè¯»â€æ¡£æ¡ˆã€‚åœ¨ PG ä¸­é•¿æœŸç•™å­˜æµ·é‡åªè¯»æ•°æ®ï¼Œä¸ä»…æŒ¤å æ˜‚è´µçš„ SSD èµ„æºï¼Œåºå¤§çš„è¡¨æ•°æ®æ›´ä¼šæ˜¾è‘—é™ä½ç´¢å¼•æ•ˆç‡ä¸æŸ¥è¯¢æ€§èƒ½ã€‚</li>
<li><strong>æ³›ç»“æ„åŒ–ä¸ Schema æ˜“å˜ï¼š</strong> æ ¸å¿ƒè´Ÿè½½ä¸ºå·¨å¤§çš„ JSON å¯¹è±¡ï¼ˆæ¯ä¸ªå·¥ä½œæµèŠ‚ç‚¹çš„Inputs/Outputsï¼‰ï¼Œä¸”ç»“æ„éšç‰ˆæœ¬è¿­ä»£ã€‚PG éš¾ä»¥é«˜æ•ˆå¤„ç†æ·±å±‚ JSON æ£€ç´¢ï¼Œä¸”äº¿çº§å¤§è¡¨çš„ DDL å˜æ›´ä¼šå¼•å‘é•¿æ—¶é—´é”è¡¨é£é™©ã€‚</li>
<li><strong>é«˜ååæ—¶åºå†™å…¥ï¼š</strong> æ—¥å¿—éšæ—¶é—´æºæºä¸æ–­åœ°äº§ç”Ÿï¼ŒæŒç»­æ¶ˆè€— IOPS ä¸æ•°æ®åº“è¿æ¥ã€‚è¯·æ±‚é«˜å³°æœŸææ˜“å¯¼è‡´è¿æ¥æ± è€—å°½ï¼Œå¯¼è‡´åˆ›å»ºåº”ç”¨ç­‰æ ¸å¿ƒä¸šåŠ¡å› èµ„æºäº‰æŠ¢è€Œå¤±è´¥ã€‚</li>
</ul>
<p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ”¯æŒ<strong>å­˜ç®—åˆ†ç¦»ã€å¼¹æ€§ä¼¸ç¼©ã€ä½æˆæœ¬ä¸”å…·å¤‡åŸç”Ÿ OLAP èƒ½åŠ›</strong>çš„å­˜å‚¨æ¶æ„ã€‚é˜¿é‡Œäº‘æ—¥å¿—æœåŠ¡ï¼ˆSLSï¼‰ å‡­å€Ÿå…¶äº‘åŸç”Ÿç‰¹æ€§ï¼Œæˆä¸ºè§£å†³è¿™ä¸€ç“¶é¢ˆçš„æœ€ä½³é€‰æ‹©ã€‚</p>
<h2 data-id="heading-6">ä¸‰ã€æ–¹æ¡ˆé€‰å‹ï¼šä¸ºä»€ä¹ˆ SLS æ›´é€‚åˆ Dify æ—¥å¿—åœºæ™¯</h2>
<p>SLS å¹¶ä¸æ˜¯â€œå¦ä¸€ä¸ªæ•°æ®åº“æ›¿ä»£â€ï¼Œå®ƒæ˜¯ä¸ºæ—¥å¿—åœºæ™¯é‡èº«å®šåˆ¶çš„åŸºç¡€è®¾æ–½ã€‚åœ¨Difyå·¥ä½œæµæ—¥å¿—åœºæ™¯ä¸‹ï¼Œç›¸æ¯”äº PGï¼ŒSLS åœ¨ä»¥ä¸‹å››ä¸ªç»´åº¦å®ç°äº†æ¶æ„ä¸Šçš„ä¼˜åŒ–å‡çº§ï¼š</p>
<h3 data-id="heading-7">æè‡´å¼¹æ€§ï¼Œåº”å¯¹æµé‡æ³¢åŠ¨</h3>
<p>Dify ä¸šåŠ¡å¸¸æœ‰çªå‘æµé‡ï¼ˆå¦‚ AI æ¨ç†é«˜å³°ï¼‰ã€‚PostgreSQL éœ€æŒ‰å³°å€¼é¢„ç½®ç¡¬ä»¶èµ„æºï¼Œä½è°·æœŸçš„èµ„æºæµªè´¹ï¼Œä¸€æ—¦æµé‡çªå¢è¶…è¿‡é¢„è®¾ä¸Šé™ï¼Œæ•°æ®åº“ç¨³å®šæ€§ä¼šæœ‰é—®é¢˜ã€‚</p>
<p>è€ŒSLS ä½œä¸º SaaS åŒ–äº‘æœåŠ¡ï¼Œå¤©ç„¶æ”¯æŒç§’çº§å¼¹æ€§ä¼¸ç¼©ï¼Œæ— é¡»å…³å¿ƒåˆ†ç‰‡æˆ–å®¹é‡ä¸Šé™ï¼Œä¸”é»˜è®¤æ”¯æŒ 3AZ åŒåŸå†—ä½™ã€‚</p>
<h3 data-id="heading-8">é«˜å†™å…¥åå + æ¶æ„è§£è€¦ï¼Œä¿éšœæ ¸å¿ƒç¨³å®š</h3>
<ul>
<li><strong>é«˜å¹¶å‘å†™å…¥ï¼š</strong> SLS é’ˆå¯¹æ—¥å¿—åœºæ™¯ä¼˜åŒ–ï¼Œæ•°æ®ä»¥è¿½åŠ æ–¹å¼é¡ºåºå†™å…¥ï¼Œé¿å…äº†æ•°æ®åº“ä¸­å¸¸è§çš„éšæœº I/O å’Œé”ç«äº‰ï¼Œèƒ½ä»¥æä½æˆæœ¬æ”¯æ’‘æ•°ä¸‡ TPS çš„å†™å…¥ååï¼Œè½»æ¾åº”å¯¹ AI ä¸šåŠ¡çš„å†™å…¥æ´ªå³°ã€‚</li>
<li><strong>èµ„æºéš”ç¦»ï¼š</strong> å°†æ—¥å¿—è´Ÿè½½å‰¥ç¦»è‡³ SLS äº‘ç«¯ï¼Œå®ç°æ—¥å¿—æ•°æ®æµä¸ Dify æ ¸å¿ƒä¸šåŠ¡äº‹åŠ¡çš„ç‰©ç†éš”ç¦»ï¼Œæœ‰æ•ˆä¿éšœä¸»ä¸šåŠ¡ç³»ç»Ÿçš„ç¨³å®šæ€§ä¸æ€§èƒ½ã€‚</li>
</ul>
<h3 data-id="heading-9">æµ·é‡æ—¥å¿—ï¼Œä½æˆæœ¬é•¿æœŸç•™å­˜</h3>
<p>SLS æ•°æ®é‡‡ç”¨é«˜å‹ç¼©æ¯”æŠ€æœ¯ï¼Œæ”¯æŒè‡ªåŠ¨åŒ–åˆ†å±‚å­˜å‚¨ï¼Œå¯å°†å†å²æ•°æ®è‡ªåŠ¨æ²‰é™è‡³ä½é¢‘å’Œå½’æ¡£å­˜å‚¨ï¼Œæ— éœ€ç»´æŠ¤æ¸…ç†è„šæœ¬ï¼Œæˆæœ¬è¿œä½äºæ•°æ®åº“ SSDã€‚è¿™ä½¿å¾— Dify èƒ½ä»¥æä½çš„æˆæœ¬æ»¡è¶³é•¿å‘¨æœŸçš„åˆ†æå’Œå®¡è®¡éœ€æ±‚ã€‚</p>
<h3 data-id="heading-10">å¼€ç®±å³ç”¨çš„æ•°æ®ä»·å€¼é‡Šæ”¾èƒ½åŠ›</h3>
<ul>
<li><strong>Schema-on-Readï¼š</strong> SLS å†™å…¥æ—¶ä¸å¼ºåˆ¶æ ¡éªŒ Schemaï¼Œå®Œç¾é€‚é… Dify å¿«é€Ÿè¿­ä»£å¸¦æ¥çš„å­—æ®µå˜æ›´ï¼Œæ— éœ€å¯¹å†å²æ•°æ®é‡æ–°å˜æ›´ã€‚</li>
<li><strong>ç§’çº§åˆ†æï¼š</strong> SLS å†…ç½®äº†é’ˆå¯¹æ—¥å¿—ä¼˜åŒ–çš„åˆ†æå¼•æ“ï¼ˆå€’æ’ç´¢å¼•+åˆ—å­˜ï¼‰ã€‚å¼€å‘è€…å¯ä»¥ä½¿ç”¨å…³é”®è¯ä»æµ·é‡æ—¥å¿—ä¸­æ£€ç´¢ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨ SQL å¯¹äº¿çº§æ—¥å¿—è¿›è¡Œå®æ—¶èšåˆåˆ†æï¼Œå°†æ—¥å¿—æ•°æ®è½¬åŒ–ä¸ºä¸šåŠ¡æ´å¯Ÿã€‚</li>
<li><strong>ä¸°å¯Œæ•°æ®ç”Ÿæ€ï¼š</strong> æ—¥å¿—åœ¨SLSä¸­ï¼Œå¯ä»¥è¿›ä¸€æ­¥è¿›è¡Œæ›´å®Œå–„çš„å¤„ç†å’Œåˆ†æï¼Œæ¯”å¦‚æ•°æ®åŠ å·¥æ¸…æ´—ã€è”åˆåˆ†æã€å¯è§†åŒ–ã€å‘Šè­¦ã€æ¶ˆè´¹å’ŒæŠ•é€’ç­‰ç­‰ã€‚</li>
</ul>
<h2 data-id="heading-11">å››ã€æŠ€æœ¯å®ç°ï¼šæ ¸å¿ƒæ¶æ„æ”¹é€ ä¸æ’ä»¶åŒ–</h2>
<p>ä¸ºäº†å°† SLS å¼•å…¥ Difyï¼Œæ•´ä¸ªå·¥ç¨‹å®æ–½åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šä¸€æ˜¯å¯¹ Dify æ ¸å¿ƒçš„æ’ä»¶åŒ–æ”¹é€ ï¼ŒäºŒæ˜¯åŸºäº SLS è¯»å†™æ—¥å¿—çš„æ’ä»¶å®ç°ã€‚</p>
<h3 data-id="heading-12">1.Dify æ ¸å¿ƒæ’ä»¶åŒ–æ”¹é€ </h3>
<p>Dify æ—©æœŸæ¶æ„ä¸­ï¼Œå·¥ä½œæµè®°å½•çš„è¯»å†™é€»è¾‘æ·±åº¦è€¦åˆäº† SQLAlchemyï¼ˆPG ORMï¼‰ï¼Œæ‰©å±•æ€§å—é™ã€‚ä» v1.4.1 ä»¥åç¤¾åŒºå¼•å…¥äº† WorkflowExecution çš„é¢†åŸŸæ¨¡å‹ï¼ˆ#20067[7]ï¼‰å¹¶å¼€å§‹é€æ­¥å¯¹å·¥ä½œæµæ‰§è¡Œæ ¸å¿ƒæµç¨‹è¿›è¡Œé‡æ„ï¼Œå®šä¹‰äº†ä¸€å¥—æ ‡å‡†çš„ Repository æ¥å£ï¼Œæ¶µç›–æ—¥å¿—çš„å†™å…¥ã€æ›´æ–°ã€è¯»å–ä»¥åŠç»Ÿè®¡ç­‰æ ‡å‡†è¡Œä¸ºã€‚åœ¨ v1.8.0 ç¤¾åŒºå¼•å…¥äº† Repository çš„å¼‚æ­¥å®ç°ï¼Œé€šè¿‡æ¨è¿Ÿæ—¥å¿—è®°å½•ä¿å­˜æå‡äº†å·¥ä½œæµæ‰§è¡Œé€Ÿåº¦ã€‚</p>
<p>è™½ç„¶ Repository æ¥å£ä¸ºå¤šå­˜å‚¨é©±åŠ¨æä¾›äº†å¯èƒ½ï¼Œä½†æ—©æœŸçš„æŠ½è±¡å¹¶ä¸å½»åº•ï¼šå®ƒä¸»è¦è§£å†³äº†â€œå†™â€çš„æŠ½è±¡ï¼Œä½†å¤§é‡â€œè¯»â€æ“ä½œä»ç»•è¿‡ Repository ç›´æ¥ä¾èµ– SQLAlchemyï¼Œä¸”å¤æ‚çš„è·¨è¡¨ Join æŸ¥è¯¢ä½¿å¾—å­˜å‚¨å±‚éš¾ä»¥çœŸæ­£å‰¥ç¦»ã€‚</p>
<p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬å’Œ Dify ç ”å‘å›¢é˜Ÿå¤šæ¬¡äº¤æµï¼Œç¡®å®šäº† Repository æŠ½è±¡å±‚çš„å®Œæ•´å®ç°æ–¹æ¡ˆã€‚æˆ‘ä»¬é€šè¿‡å‰¥ç¦»è·¨è¡¨å…³è”æŸ¥è¯¢ã€æ ‡å‡†åŒ–è¯»å–ä¸ç»Ÿè®¡æ¥å£ï¼ŒçœŸæ­£å®ç°äº†å­˜å‚¨å±‚çš„å®Œå…¨è§£è€¦ä¸æ’ä»¶åŒ–åŠ è½½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9134545808d64137babd480eb1803ce1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=F0EI47Kaaq%2BkVtx888Z%2ByO4qAZA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-13">2.SLS æ—¥å¿—æ’ä»¶å®ç°</h3>
<p>åœ¨æ’ä»¶å®ç°è¿‡ç¨‹ä¸­ï¼Œæ ¸å¿ƒæŒ‘æˆ˜åœ¨äºæŠ¹å¹³å…³ç³»å‹æ•°æ®åº“ï¼ˆPGï¼‰ä¸æ—¥å¿—ç³»ç»Ÿï¼ˆSLSï¼‰åœ¨æ•°æ®æ¨¡å‹ä¸Šçš„å·®å¼‚ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†ä»¥ä¸‹æŠ€æœ¯ç­–ç•¥ï¼š</p>
<h4 data-id="heading-14">åŸºäºå¤šç‰ˆæœ¬çš„çŠ¶æ€ç®¡ç†</h4>
<p>SLS çš„ LogStore æ˜¯ Append-Only è¿½åŠ å†™å…¥ï¼Œè€ŒDify çš„å·¥ä½œæµæ‰§è¡Œè¿‡ç¨‹å­˜åœ¨çŠ¶æ€æµè½¬ï¼Œä»Â <code>RUNNING</code>Â å˜ä¸ºÂ <code>SUCCEEDED/FAIL</code>ã€‚å› æ­¤æˆ‘ä»¬é‡‡ç”¨äº†å¤šç‰ˆæœ¬æ§åˆ¶çš„æ€è·¯ï¼š</p>
<ul>
<li>å†™å…¥ç­–ç•¥ï¼šæ¯æ¬¡çŠ¶æ€æ›´æ–°ï¼Œä¸è¦†ç›–æ—§æ—¥å¿—ï¼Œè€Œæ˜¯æ–°å†™å…¥ä¸€æ¡åŒ…å«å®Œæ•´çŠ¶æ€çš„æ—¥å¿—è®°å½•ã€‚æˆ‘ä»¬åœ¨æ—¥å¿—æ¨¡å‹ä¸­å¼•å…¥äº†ä¸€ä¸ªçº³ç§’çº§çš„æ—¶é—´æˆ³å­—æ®µÂ <code>log_version</code>æ¥åŒºåˆ†ç‰ˆæœ¬ã€‚</li>
<li>è¯»å–ç­–ç•¥ï¼šåœ¨æŸ¥è¯¢æˆ–ç»Ÿè®¡æ—¶ï¼Œæ’ä»¶å†…éƒ¨ä¼šç”Ÿæˆèšåˆ SQLï¼Œå¯¹äºåŒä¸€ä¸ªÂ <code>workflow_run_id</code>ï¼Œå§‹ç»ˆé€‰å–Â <code>log_version</code>Â æœ€å¤§çš„é‚£æ¡è®°å½•ä½œä¸ºæœ€ç»ˆçŠ¶æ€ã€‚</li>
</ul>
<h4 data-id="heading-15">Schema è‡ªåŠ¨åŒæ­¥</h4>
<p>Dify çš„è¿­ä»£é€Ÿåº¦éå¸¸å¿«ï¼Œæ•°æ®åº“æ¨¡å‹ç»å¸¸å‘ç”Ÿå˜æ›´ã€‚å¦‚æœæ¯æ¬¡å‡çº§ Dify éƒ½éœ€è¦ç”¨æˆ·æ‰‹åŠ¨ç»´æŠ¤ç´¢å¼•é…ç½®ï¼Œå°†æå¤§åœ°å¢åŠ è¿ç»´è´Ÿæ‹…ã€‚SLS æ’ä»¶å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ‰«æ SQLAlchemy æ¨¡å‹å®šä¹‰ï¼Œå¹¶ä¸ SLS ç´¢å¼•é…ç½®è¿›è¡Œ Diffã€‚ä¸€æ—¦å‘ç°æ–°å­—æ®µï¼Œè‡ªåŠ¨è°ƒç”¨ API æ›´æ–°ç´¢å¼•ã€‚ç”¨æˆ·æ— éœ€æ‰‹åŠ¨ç»´æŠ¤ç´¢å¼•ï¼Œå¼€å‘è€…ä¹Ÿæ— é¡»ä¸º SLS å•ç‹¬ç¼–å†™å‡çº§è„šæœ¬ã€‚</p>
<h4 data-id="heading-16">åŸç”Ÿ PG åè®®å…¼å®¹</h4>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒSLS æ–°å¢åŸç”Ÿæ”¯æŒ PostgreSQL åè®®ã€‚ç»å¤§éƒ¨åˆ†åŸæœ‰çš„ç»Ÿè®¡ä¸åˆ†æ SQLï¼Œå‡å¯é€šè¿‡ PG å…¼å®¹æ¨¡å¼ç›´æ¥å‘é€åˆ° SLS ä¸Šæ‰§è¡Œï¼Œæå¤§åœ°é™ä½äº†æ’ä»¶çš„å¼€å‘é€‚é…æˆæœ¬ã€‚</p>
<h2 data-id="heading-17">äº”ã€å®è·µæŒ‡å—ï¼šé…ç½®ä¸å¹³æ»‘è¿ç§»</h2>
<p>è¯¥åŠŸèƒ½å·²æ­£å¼åˆå¹¶è‡³ Dify ç¤¾åŒºä¸»åˆ†æ”¯ã€‚åŸºäºDifyæœ€æ–°ä»£ç ï¼Œåªéœ€è¿›è¡Œç®€å•é…ç½®ï¼Œå°±å¯ä»¥å°†å·¥ä½œæµæ‰§è¡Œè®°å½•åˆ‡æ¢åˆ°SLSå­˜å‚¨ã€‚</p>
<h3 data-id="heading-18">ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡å·¥ä½œ</h3>
<p>ï¼ˆ1ï¼‰åˆ›å»º Projectï¼šåœ¨é˜¿é‡Œäº‘æ—¥å¿—æœåŠ¡æ§åˆ¶å°åˆ›å»º Projectï¼ˆå»ºè®®ä¸ä¸šåŠ¡åŒåœ°åŸŸï¼‰</p>
<blockquote>
<p>æ— éœ€æ‰‹åŠ¨åˆ›å»º Logstore å’Œç´¢å¼•ï¼ŒDify å¯åŠ¨åæ’ä»¶ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶åˆ›å»ºã€‚</p>
</blockquote>
<p>ï¼ˆ2ï¼‰è·å–è®¿é—®å‡­è¯ï¼šè·å–å…·å¤‡ SLS è¯»å†™æƒé™çš„ AccessKey ID å’Œ Secretã€‚</p>
<blockquote>
<p>å¯ä»¥æˆäºˆÂ <code>AliyunLogFullAccess</code>ï¼Œæˆ–æŒ‰éœ€é…ç½®æœ€å°æƒé™ï¼ˆåˆ›å»º/æŸ¥çœ‹Projectã€åˆ›å»º/æŸ¥çœ‹logstoreã€åˆ›å»º/æ›´æ–°/æŸ¥çœ‹ç´¢å¼•ã€å†™æ—¥å¿—ã€æŸ¥æ—¥å¿—ç­‰ï¼‰</p>
</blockquote>
<h3 data-id="heading-19">ç¬¬äºŒæ­¥ï¼šé…ç½®Dify</h3>
<p>åœ¨Â <code>.env</code>Â æˆ–Â <code>docker-compose.yaml</code>Â ä¸­ä¿®æ”¹ä»¥ä¸‹é…ç½®é¡¹ï¼Œå°†å·¥ä½œæµå­˜å‚¨é©±åŠ¨æŒ‡å‘ SLS æ’ä»¶ï¼Œå¹¶è¡¥å……è¿æ¥ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># 1. ä¿®æ”¹ Repository é©±åŠ¨æŒ‡å‘ SLS æ’ä»¶</span>
<span class="hljs-attr">CORE_WORKFLOW_EXECUTION_REPOSITORY</span>=extensions.logstore.repositories.logstore_workflow_execution_repository.LogstoreWorkflowExecutionRepository
<span class="hljs-attr">CORE_WORKFLOW_NODE_EXECUTION_REPOSITORY</span>=extensions.logstore.repositories.logstore_workflow_node_execution_repository.LogstoreWorkflowNodeExecutionRepository
<span class="hljs-attr">API_WORKFLOW_NODE_EXECUTION_REPOSITORY</span>=extensions.logstore.repositories.logstore_api_workflow_node_execution_repository.LogstoreAPIWorkflowNodeExecutionRepository
<span class="hljs-attr">API_WORKFLOW_RUN_REPOSITORY</span>=extensions.logstore.repositories.logstore_api_workflow_run_repository.LogstoreAPIWorkflowRunRepository

<span class="hljs-comment"># 2. æ–°å¢ SLS è¿æ¥é…ç½®</span>
<span class="hljs-attr">ALIYUN_SLS_ACCESS_KEY_ID</span>=your_access_key_id
<span class="hljs-attr">ALIYUN_SLS_ACCESS_KEY_SECRET</span>=your_access_key_secret
<span class="hljs-attr">ALIYUN_SLS_ENDPOINT</span>=cn-hangzhou.log.aliyuncs.com
<span class="hljs-attr">ALIYUN_SLS_REGION</span>=cn-hangzhou
<span class="hljs-attr">ALIYUN_SLS_PROJECT_NAME</span>=your_project_name
<span class="hljs-attr">ALIYUN_SLS_LOGSTORE_TTL</span>=<span class="hljs-number">365</span>Â Â <span class="hljs-comment"># æ—¥å¿—å­˜å‚¨å¤©æ•°</span>

<span class="hljs-comment"># 3. è¿ç§»å¼€å…³é…ç½®</span>
<span class="hljs-attr">LOGSTORE_DUAL_WRITE_ENABLED</span>=<span class="hljs-literal">false</span>
<span class="hljs-attr">LOGSTORE_DUAL_READ_ENABLED</span>=<span class="hljs-literal">true</span>
</code></pre>
<p>ä¸ºäº†ä¿è¯å­˜é‡ PG ç”¨æˆ·èƒ½å¹³æ»‘å‡çº§åˆ° SLS ç‰ˆæœ¬ï¼Œæˆ‘ä»¬åœ¨æ’ä»¶ä¸­æä¾›äº†ä¸¤ä¸ªå¼€å…³ï¼š</p>
<p>ï¼ˆ1ï¼‰åŒå†™æœºåˆ¶ï¼šé€šè¿‡é…ç½®Â <code>LOGSTORE_DUAL_WRITE_ENABLED=True</code>ï¼ˆé»˜è®¤å…³é—­ï¼‰ï¼Œç³»ç»Ÿä¼šå°†æ—¥å¿—åŒæ—¶å†™å…¥ PG å’Œ SLSã€‚è¿™é€‚ç”¨äºå­˜é‡ç”¨æˆ·è¿ç§»åˆæœŸçš„ç°åº¦éªŒè¯ï¼Œç¡®ä¿åœ¨ä¸æ”¹å˜åŸæœ‰æ•°æ®æµçš„æƒ…å†µä¸‹ï¼ŒéªŒè¯ SLS çš„é…ç½®æ­£ç¡®æ€§å’Œ Dify ç‰ˆæœ¬å‡çº§æœ¬èº«çš„å…¼å®¹æ€§ã€‚</p>
<p>ï¼ˆ2ï¼‰åŒè¯»é™çº§æœºåˆ¶ï¼šé€šè¿‡é…ç½®Â <code>LOGSTORE_DUAL_READ_ENABLED=True</code>ï¼ˆé»˜è®¤å¼€å¯ï¼‰ï¼Œç³»ç»Ÿä¼˜å…ˆä» SLS è¯»å–æ—¥å¿—ã€‚å¦‚æœ SLS ä¸­æœªæ‰¾åˆ°è¯¥è®°å½•ï¼ˆä¾‹å¦‚è¿ç§»å‰çš„è€å†å²æ•°æ®ï¼‰ï¼Œæ’ä»¶ä¼šè‡ªåŠ¨é™çº§å› PG å†æ¬¡å°è¯•è¯»å–ã€‚</p>
<h2 data-id="heading-20">å…­ã€æˆæ•ˆå¯¹æ¯”ï¼šè¿ç§»åˆ°SLSçš„ä¸‰å¤§æ”¶ç›Š</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aea0cb21a5e24771aeffdf497955ece5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=DxndBXmlkeKxm1hQInl7Nas1ZQw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-21">æ”¶ç›Šä¸€ï¼šDBå‹åŠ›æ˜¾è‘—ä¸‹é™</h3>
<p>åˆ‡æ¢åˆ°SLSï¼Œç›¸å½“äºæŠŠç°æœ‰PGä¸­æ•°æ®é‡æœ€å¤§çš„ä¸¤å¼ è¡¨çš„æ•°æ®è¿ç§»èµ°äº†ã€‚æ ¹æ®æˆ‘ä»¬çº¿ä¸Šä¸šåŠ¡çš„æ•°æ®ï¼ŒDBå‡å°‘äº†95%ä»¥ä¸Šçš„å­˜å‚¨ç©ºé—´ï¼ˆè¿è¡Œæ—¶é—´è¶Šé•¿ï¼Œè¿™ä¸ªæ¯”ä¾‹è¶Šé«˜ï¼‰ï¼Œå¹¶ä¸”è¯»å†™è¿‡ç¨‹ä¸­çš„DBçš„è¿æ¥æ•°ã€CPUç­‰å‹åŠ›ä¹Ÿæœ‰æ˜¾è‘—é™ä½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4d2c9bfc0a7413c80c84ef6e342f40f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=onbuHtEOBnkJxbvllkTrlJuoNL8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-22">æ”¶ç›ŠäºŒï¼šå­˜å‚¨æˆæœ¬å¤§å¹…é™ä½</h3>
<p>ä¸ºäº†ç›´è§‚é‡åŒ–è¿ç§»åçš„æˆæœ¬æ”¶ç›Šï¼Œæˆ‘ä»¬ä»¥ä¸€ä¸ªå…¸å‹çš„ç”Ÿäº§çº§åœºæ™¯è¿›è¡Œä¼°ç®—ï¼šå‡è®¾ Dify åº”ç”¨æ—¥å¢æ—¥å¿— 10GBï¼Œä¸ºäº†æ»¡è¶³æ¨¡å‹è¯„ä¼°ä¸å›æº¯éœ€æ±‚ï¼Œéœ€ç•™å­˜æœ€è¿‘ 300 å¤©ï¼ˆçº¦ 3TBï¼‰çš„æ•°æ®ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d62106f5d70411191263f4516ecbb77~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=t0jTFhJJVBs9wMNLEBH0291WpA8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<blockquote>
<p>æ³¨ï¼šè¿™é‡Œä¼°ç®—SLSæˆæœ¬çš„æ—¶å€™ï¼Œå·²ç»å°†å­˜å¤šæ¡çŠ¶æ€è®°å½•ä¼šå ç”¨å­˜å‚¨ç©ºé—´çš„å› ç´ è€ƒè™‘è¿›å»ã€‚ æ­¤å¤–å¯¹äºPGå®é™…ç”Ÿäº§ä¸­è¿˜éœ€é¢å¤–è€ƒè™‘é«˜å¯ç”¨å¤šå‰¯æœ¬ã€é¢„ç•™å­˜å‚¨ç©ºé—´ã€è¿æ¥æ± æ‰©å®¹ç­‰éšæ€§æˆæœ¬ã€‚</p>
</blockquote>
<p>è¿™é‡Œé€ æˆè¿‘Â 10 å€æˆæœ¬å·®è·Â çš„æ ¹æœ¬åŸå› åœ¨äºå­˜å‚¨æœºåˆ¶çš„ä¸åŒã€‚</p>
<p>Difyçš„å·¥ä½œæµè®°å½•åŒ…å«äº†ç”¨æˆ·æé—®ã€çŸ¥è¯†å¬å›ã€å·¥å…·è°ƒç”¨å’Œæ¨¡å‹å“åº”ç­‰æ•°æ®ï¼Œæ˜¯è¯„ä¼°å’Œå›å½’ç­‰ä»»åŠ¡éœ€è¦çš„æ•°æ®èµ„äº§ï¼Œé•¿æœŸç•™å­˜ä»·å€¼é«˜ã€‚</p>
<ul>
<li><strong>å¯¹äº PGï¼š</strong> å­˜å‚¨æ—¶é—´è¶Šé•¿ï¼Œæ•°æ®é‡è¶Šå¤§ï¼Œå¯¹æ˜‚è´µçš„ SSD å­˜å‚¨ç©ºé—´å ç”¨å°±è¶Šå¤šï¼Œæˆæœ¬ä¼šå¤§å¹…å¢é•¿ã€‚pgå®ä¾‹éœ€è¦æå‰é¢„ä¼°å­˜å‚¨ç©ºé—´ï¼Œå­˜å‚¨ç©ºé—´ä¸å¯èƒ½å®Œå…¨åˆ©ç”¨èµ·æ¥ï¼Œå¿…ç„¶é—²ç½®ä¸€éƒ¨åˆ†ç©ºé—´ã€‚</li>
<li><strong>å¯¹äº SLSï¼š</strong> ä¸“ä¸ºæ—¥å¿—è®¾è®¡çš„é«˜å‹ç¼©æ¯”ä¸åˆ†å±‚å­˜å‚¨æŠ€æœ¯ï¼Œä½¿å¾—å­˜å‚¨æ•°æ®é‡è¶Šå¤§ã€æ—¶é—´è¶Šé•¿ï¼Œå…¶è¾¹é™…æˆæœ¬ä¼˜åŠ¿è¶Šæ˜æ˜¾ã€‚</li>
</ul>
<h3 data-id="heading-23">æ”¶ç›Šä¸‰ï¼šæ•°æ®ä»·å€¼é‡Šæ”¾ï¼Œä»â€œè¿ç»´ç›‘æ§â€åˆ°â€œä¸šåŠ¡æ´å¯Ÿâ€</h3>
<p>è¿™é‡Œæˆ‘ä»¬ä»¥ä¸€ä¸ªçœŸå®çš„ Dify åº”ç”¨åœºæ™¯â€”â€”â€œç”µå•†æ™ºèƒ½å®¢æœåŠ©æ‰‹â€ä¸ºä¾‹ï¼Œå±•ç¤ºæ—¥å¿—æ•°æ®æ¥å…¥ SLS åï¼Œå¦‚ä½•æŒ–æ˜å…¶èƒŒåæ›´å¤§çš„ä¸šåŠ¡ä»·å€¼ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34f07812069f4240a95ced39194b1c01~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=GTVZOmUKBO82gcTS9uB7GtqXa1U%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-24">ï¼ˆ1ï¼‰æ— ç¼é›†æˆï¼ŒåŸç”Ÿä½“éªŒ</h4>
<p>æ¥å…¥ SLS åï¼ŒDify ç•Œé¢ä¸Šçš„æ—¥å¿—æŸ¥è¯¢ä¸å›æº¯ä½“éªŒä¿æŒä¸å˜ï¼Œä½†åº•å±‚å­˜å‚¨å·²å®Œå…¨åˆ‡æ¢ã€‚</p>
<ul>
<li>æ—¥å¿—å›æº¯ï¼šDify æ§åˆ¶å°çš„æ—¥å¿—è¯¦æƒ…é¡µç›´æ¥ä» SLS è¯»å–æ•°æ®ï¼Œå“åº”æ›´è¿…é€Ÿã€‚</li>
<li>ç›‘æ§å›¾è¡¨ï¼šDify å†…ç½®çš„ç›‘æ§ç»Ÿè®¡å›¾è¡¨ï¼Œä¹Ÿæ˜¯é€šè¿‡æ‰§è¡Œ SLS SQL å®æ—¶ç”Ÿæˆçš„ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/488198cf9d744b73a6749e36e5a881d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=ZAz2mNYyhoeYHFd6dlOW0V8BZCY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-25">ï¼ˆ2ï¼‰è¶…è¶ŠåŸºç¡€ï¼ŒSLS è¿›é˜¶åˆ†æ</h4>
<p>è™½ç„¶ Dify å†…ç½®äº†åŸºç¡€æŸ¥è¯¢å’Œç»Ÿè®¡åŠŸèƒ½ï¼Œä½†é¢å¯¹å¤æ‚çš„ä¸šåŠ¡åˆ†æéœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è½¬è‡³ SLS æ§åˆ¶å°ï¼Œè§£é”æ›´å¼ºå¤§çš„èƒ½åŠ›ã€‚</p>
<ul>
<li><strong>ä»»æ„å­—æ®µçš„é«˜é€Ÿæ£€ç´¢</strong></li>
</ul>
<p>SLS æ”¯æŒå…¨æ–‡ç´¢å¼•å’Œä»»æ„é”®å€¼å¯¹æ¡ä»¶çš„ç»„åˆæŸ¥è¯¢ï¼Œå¿«é€Ÿç²¾å‡†æ£€ç´¢å‡ºç¬¦åˆæŸç§ç‰¹å®šç‰¹å¾çš„æ—¥å¿—ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0192c2f638134b7ebc8daf0d20ef34e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=yBjE%2BqKPuZ2yni%2B8A%2B9eteLnOr0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li><strong>ä¸šåŠ¡è¶‹åŠ¿åˆ†æï¼ˆå¯è§†åŒ–ï¼‰åœºæ™¯</strong></li>
</ul>
<p>æ¯”å¦‚è¿™é‡Œæˆ‘ä»¬åˆ†æâ€œç”¨æˆ·æ„å›¾è¯†åˆ«â€è¿™ä¸ªå·¥ä½œæµèŠ‚ç‚¹é‡Œï¼ŒæŒ‰è¯†åˆ«å‡ºçš„ç”¨æˆ·æ„å›¾çš„åˆ†ç±»ç»Ÿè®¡éšæ—¶é—´å˜åŒ–çš„PVæƒ…ï¼Œä¾¿äºé€šè¿‡è§‚å¯Ÿä¸åŒåˆ†ç±»çš„è¶‹åŠ¿å˜åŒ–ï¼Œåšå‡ºç›¸åº”çš„è¿è¥å†³ç­–ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-operator">*</span>Â <span class="hljs-keyword">and</span>Â title: ç”¨æˆ·æ„å›¾è¯†åˆ«Â <span class="hljs-keyword">and</span>Â intentÂ <span class="hljs-operator">|</span>Â <span class="hljs-keyword">select</span>Â json_extract(outputs,Â <span class="hljs-string">'$.intent'</span>)Â <span class="hljs-keyword">as</span>Â "ç”¨æˆ·æ„å›¾", date_trunc(<span class="hljs-string">'minute'</span>, __time__) t,Â <span class="hljs-built_in">count</span>(<span class="hljs-number">1</span>)Â <span class="hljs-keyword">as</span>Â pvÂ <span class="hljs-keyword">group</span>Â <span class="hljs-keyword">by</span>Â "ç”¨æˆ·æ„å›¾",tÂ <span class="hljs-keyword">order</span>Â <span class="hljs-keyword">by</span>Â t limitÂ <span class="hljs-keyword">all</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/692159a7f5104fa69597b423df8b19bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=svJH61m4JahxuSeXK6brd3so%2By4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li><strong>å¼‚å¸¸è¯Šæ–­ï¼ˆæ¼æ–—åˆ†æï¼‰åœºæ™¯</strong></li>
</ul>
<p>å¯ä»¥é€šè¿‡æ¼æ–—å›¾ï¼Œåˆ†æè§‚å¯Ÿå·¥ä½œæµå“ªäº›ä¸­é—´èŠ‚ç‚¹å‡ºç°å¼‚å¸¸å¤±è´¥çš„æ¯”ç‡è¾ƒé«˜ã€‚</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">status:</span>succeededÂ |Â <span class="hljs-keyword">select</span>Â title,Â count(<span class="hljs-keyword">distinct</span>Â workflow_run_id) cntÂ <span class="hljs-keyword">group</span>Â <span class="hljs-keyword">by</span>Â titleÂ <span class="hljs-keyword">order</span>Â <span class="hljs-keyword">by</span>Â cntÂ desc
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9889e516acc4f90b5fad6938d3eec7f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=w%2BQdP13JYArRO6PK%2FvGRitBiRy8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li><strong>æˆæœ¬ä¸é£é™©é£æ§ï¼ˆå®æ—¶å‘Šè­¦ï¼‰åœºæ™¯</strong></li>
</ul>
<p>é…ç½®å‘Šè­¦è§„åˆ™ï¼Œç»Ÿè®¡ LLM èŠ‚ç‚¹çš„ Token æ¶ˆè€—ï¼Œä¸€æ—¦è¶…è¿‡é¢„è®¾é˜ˆå€¼ï¼Œç«‹å³è§¦å‘é’‰é’‰/ç”µè¯å‘Šè­¦ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e94041094dcf439f97c7315fcee0124a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=RJLTS3%2FglNn7YziG0zJyXZPygC8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li><strong>æ•°æ®é—­ç¯ï¼ˆETL ä¸åŠ å·¥ï¼‰åœºæ™¯</strong></li>
</ul>
<p>åˆ©ç”¨æ•°æ®åŠ å·¥å’Œå®šæ—¶ SQLï¼Œå¯¹å·¥ä½œæµçš„è¾“å…¥è¾“å‡ºè¿›è¡Œæ¸…æ´—ã€è„±æ•ä¸æ ‡å‡†åŒ–ï¼Œæ„å»ºæŒç»­æ›´æ–°çš„è¯„ä¼°ä¸è®­ç»ƒæ•°æ®é›†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e5a8e291fa24253b68e6ba96b991445~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767344697&amp;x-signature=nw7RMdGNFYrnaJHMgSc5Hr4gXm0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ€»ä¹‹ï¼Œå°† Dify å·¥ä½œæµæ—¥å¿—æ¥å…¥ SLSï¼Œä¸ä»…èƒ½é«˜æ•ˆæŸ¥è¯¢æ—¥å¿—ï¼Œæ›´èƒ½é€šè¿‡åˆ†æã€å¯è§†åŒ–ã€å‘Šè­¦å’Œæ•°æ®åŠ å·¥ï¼Œå°†æ—¥å¿—è½¬åŒ–ä¸ºä¸šåŠ¡æ´å¯Ÿï¼ŒçœŸæ­£å®ç°ä»â€œçœ‹æ—¥å¿—â€åˆ°â€œæ‡‚ä¸šåŠ¡â€çš„è·ƒå‡ã€‚</p>
<h2 data-id="heading-26">ä¸ƒã€æ€»ç»“ï¼šè¿ˆå‘ç”Ÿäº§çº§ AI æ¶æ„</h2>
<p>å°† Dify è¿è¡Œæ—¥å¿—è¿ç§»è‡³é˜¿é‡Œäº‘ SLSï¼Œå¹¶éä¸€æ¬¡ç®€å•çš„â€œå­˜å‚¨æ›¿æ¢â€ï¼Œè€Œæ˜¯ Dify å‘ç”Ÿäº§çº§é«˜å¯ç”¨æ¶æ„æ¼”è¿›çš„å…³é”®ä¸€è·ƒã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡ä¸šåŠ¡æ•°æ®ä¸æ—¥å¿—æ•°æ®è§£è€¦çš„æ¶æ„æ”¹é€ ï¼ŒæˆåŠŸå°†é«˜ååã€æ³›ç»“æ„åŒ–çš„æ—¥å¿—æµä»äº‹åŠ¡å‹æ•°æ®åº“ä¸­å‰¥ç¦»ã€‚è®© PostgreSQL ä¸“æ³¨æ ¸å¿ƒä¸šåŠ¡äº‹åŠ¡å¤„ç†ï¼Œè®© SLS å……åˆ†å‘æŒ¥å…¶åœ¨æµ·é‡æ•°æ®å­˜å‚¨ä¸åˆ†æä¸Šçš„åŸç”Ÿä¼˜åŠ¿ã€‚</p>
<p>è¿™ä¸€ç‰¹æ€§å¸¦æ¥çš„ä»·å€¼æ˜¯å…¨æ–¹ä½çš„ï¼š</p>
<ul>
<li><strong>è§£å†³DBæ€§èƒ½ç“¶é¢ˆï¼š</strong> å°†æ—¥å¿—ä¸æ ¸å¿ƒäº‹åŠ¡è§£è€¦ï¼Œä»æ ¹æœ¬ä¸Šè§£å†³æ•°æ®åº“ç“¶é¢ˆï¼Œä¿è¯æ ¸å¿ƒä¸šåŠ¡ç¨³å®šæ€§ã€‚</li>
<li><strong>å¤§å¹…é™ä½æ—¥å¿—æˆæœ¬ï¼š</strong> åˆ©ç”¨SLSçš„å¼¹æ€§ä¼¸ç¼©ã€é«˜å‹ç¼©æ¯”ã€åˆ†å±‚å­˜å‚¨ï¼Œä½æˆæœ¬å­˜å‚¨æµ·é‡æ—¥å¿—ã€‚</li>
<li><strong>å……åˆ†é‡Šæ”¾æ•°æ®ä»·å€¼ï¼š</strong> ä»ç®€å•çš„æ—¥å¿—æŸ¥çœ‹å‡çº§ä¸ºå¼ºå¤§çš„å®æ—¶åˆ†æã€ç›‘æ§å‘Šè­¦ã€åŠ å·¥å¤„ç†ï¼Œå°†è¿ç»´æ•°æ®è½¬æ¢ä¸ºä¸šåŠ¡æ´å¯Ÿã€‚</li>
</ul>
<p>å¦‚æœæ‚¨æ­£åœ¨æ„å»ºå¤§è§„æ¨¡çš„ AI åº”ç”¨ï¼Œæˆ–è€…æ­£è¢« Dify æ•°æ®åº“çš„æ€§èƒ½ç“¶é¢ˆæ‰€å›°æ‰°ï¼Œç°åœ¨å°±æ˜¯å‡çº§çš„æœ€ä½³æ—¶æœºã€‚æ‹¥æŠ±äº‘åŸç”Ÿæ—¥å¿—æ¶æ„ï¼Œè®©æ‚¨çš„ Dify è·‘å¾—æ›´å¿«ã€æ›´ç¨³ã€æ›´æ™ºèƒ½ã€‚</p>
<p><strong>å‚è€ƒé“¾æ¥ï¼š</strong></p>
<p>[1]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flanggenius%2Fdify%2Fissues%2F22307" target="_blank" title="https://github.com/langgenius/dify/issues/22307" ref="nofollow noopener noreferrer">github.com/langgenius/â€¦</a></p>
<p>[2]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flanggenius%2Fdify%2Fissues%2F18800%23event-17534118862" target="_blank" title="https://github.com/langgenius/dify/issues/18800#event-17534118862" ref="nofollow noopener noreferrer">github.com/langgenius/â€¦</a></p>
<p>[3]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flanggenius%2Fdify%2Fissues%2F22796" target="_blank" title="https://github.com/langgenius/dify/issues/22796" ref="nofollow noopener noreferrer">github.com/langgenius/â€¦</a></p>
<p>[4]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flanggenius%2Fdify%2Fissues%2F20147" target="_blank" title="https://github.com/langgenius/dify/issues/20147" ref="nofollow noopener noreferrer">github.com/langgenius/â€¦</a></p>
<p>[5]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flanggenius%2Fdify%2Fpull%2F20050" target="_blank" title="https://github.com/langgenius/dify/pull/20050" ref="nofollow noopener noreferrer">github.com/langgenius/â€¦</a></p>
<p>[6]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flanggenius%2Fdify%2Fissues%2F23399" target="_blank" title="https://github.com/langgenius/dify/issues/23399" ref="nofollow noopener noreferrer">github.com/langgenius/â€¦</a></p>
<p>[7]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flanggenius%2Fdify%2Fpull%2F20067" target="_blank" title="https://github.com/langgenius/dify/pull/20067" ref="nofollow noopener noreferrer">github.com/langgenius/â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[containerdçš„CPUè¿‡é«˜çš„é—®é¢˜æ’æŸ¥]]></title>    <link>https://juejin.cn/post/7587740546954854440</link>    <guid>https://juejin.cn/post/7587740546954854440</guid>    <pubDate>2025-12-26T09:48:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587740546954854440" data-draft-id="7587776610436055055" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="containerdçš„CPUè¿‡é«˜çš„é—®é¢˜æ’æŸ¥"/> <meta itemprop="keywords" content="å®¹å™¨,Kubernetes,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2025-12-26T09:48:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="liuxuzxx"/> <meta itemprop="url" content="https://juejin.cn/user/465848660687336"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            containerdçš„CPUè¿‡é«˜çš„é—®é¢˜æ’æŸ¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/465848660687336/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    liuxuzxx
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T09:48:51.000Z" title="Fri Dec 26 2025 09:48:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚è¿°</h2>
<p>å‘ç°çº¿ä¸‹ä¸€å°k8sçš„nodeçš„containerdçš„CPUåŸºæœ¬åœ¨95%-130%ä¹‹é—´æ¥å›æµ®åŠ¨ï¼Œçœ‹åˆ°åˆ«çš„nodeçš„containerdçš„CPUå ç”¨ç‡åŸºæœ¬éƒ½åœ¨20%ä»¥ä¸‹ï¼Œæˆ–è€…æ˜¯åŸºæœ¬ä¸Šæ˜¯:1%-5%çš„æ ·å­.</p>
<h2 data-id="heading-1">æ’æŸ¥è¿‡ç¨‹</h2>
<h3 data-id="heading-2">å®šä½CPUè¿‡é«˜çš„è¿›ç¨‹</h3>
<ol>
<li>ä½¿ç”¨topå‘½ä»¤æŸ¥çœ‹å‘ç°containerdçš„CPUå±…é«˜ä¸ä¸‹ï¼ŒåŸºæœ¬ä¸Šåœ¨100%---120%ä¹‹é—´æµ®åŠ¨</li>
<li>ä½¿ç”¨pidstatå‘½ä»¤ä»”ç»†æŸ¥çœ‹</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">linux &gt; pidstat -p 1163 1 <span class="hljs-comment">#æŠ“å–1163è¿›ç¨‹ï¼ŒæŒ‰ç…§1sçš„é—´éš”æ‰“å°CPUæ¶ˆè€—</span>

33åˆ†27ç§’   UID       PID    %usr %system  %guest   %<span class="hljs-built_in">wait</span>    %CPU   CPU  Command
33åˆ†28ç§’     0      1163   68.00   56.00    0.00    0.00  124.00     2  containerd
33åˆ†29ç§’     0      1163   46.00   49.00    0.00    0.00   95.00     2  containerd
33åˆ†30ç§’     0      1163    1.00    1.00    0.00    0.00    2.00     2  containerd
33åˆ†31ç§’     0      1163    4.00    1.00    0.00    0.00    5.00     2  containerd
33åˆ†32ç§’     0      1163    1.00    1.00    0.00    0.00    2.00     2  containerd
33åˆ†33ç§’     0      1163    4.00    3.00    0.00    0.00    7.00     2  containerd
33åˆ†34ç§’     0      1163   58.00   60.00    0.00    0.00  118.00     2  containerd
33åˆ†35ç§’     0      1163   56.00   58.00    0.00    0.00  114.00     2  containerd
33åˆ†36ç§’     0      1163   59.00   57.00    0.00    0.00  116.00     2  containerd
33åˆ†37ç§’     0      1163   59.00   60.00    0.00    0.00  119.00     2  containerd
33åˆ†38ç§’     0      1163   69.00   57.00    0.00    0.00  126.00     2  containerd
33åˆ†39ç§’     0      1163   50.00   49.00    0.00    0.00   99.00     2  containerd
33åˆ†40ç§’     0      1163    2.00    1.00    0.00    0.00    3.00     2  containerd
33åˆ†41ç§’     0      1163    3.00    1.00    0.00    0.00    4.00     2  containerd
33åˆ†42ç§’     0      1163    1.00    1.00    0.00    0.00    2.00     2  containerd
33åˆ†43ç§’     0      1163    3.00    2.00    0.00    0.00    5.00     2  containerd
33åˆ†44ç§’     0      1163   56.00   61.00    0.00    0.00  117.00     2  containerd
33åˆ†45ç§’     0      1163   60.00   58.00    0.00    0.00  118.00     2  containerd
33åˆ†46ç§’     0      1163   57.00   60.00    0.00    0.00  117.00     2  containerd
33åˆ†47ç§’     0      1163   55.00   63.00    0.00    0.00  118.00     2  containerd
33åˆ†48ç§’     0      1163   71.00   59.00    0.00    0.00  130.00     2  containerd
33åˆ†49ç§’     0      1163   51.00   50.00    0.00    0.00  101.00     2  containerd
33åˆ†50ç§’     0      1163    1.00    1.00    0.00    0.00    2.00     2  containerd
33åˆ†51ç§’     0      1163    4.00    2.00    0.00    0.00    6.00     2  containerd
33åˆ†52ç§’     0      1163    2.00    1.00    0.00    0.00    3.00     2  containerd
33åˆ†53ç§’     0      1163    3.00    3.00    0.00    0.00    6.00     2  containerd
33åˆ†54ç§’     0      1163   58.00   60.00    0.00    0.00  118.00     2  containerd


<span class="hljs-comment">#1.å…¶å®è¾“å‡ºçš„æ˜¯:14æ—¶33åˆ†xxç§’æ ¼å¼ï¼Œä¸ºäº†ä¸æ¢è¡Œï¼Œå»æ‰äº†:14æ—¶</span>
<span class="hljs-comment">#2.ä»è¾“å‡ºæ¥çœ‹ï¼ŒåŸºæœ¬ä¸Šéš”4-5sçš„æ—¶é—´ï¼Œå°±ä¼šå‡ºç°å¤§æ¦‚:6sçš„CPUè¿è¡Œåœ¨: 100%-120%ä¹‹é—´</span>
</code></pre>
<h3 data-id="heading-3">ä½¿ç”¨perfæŠ“å–å¯¹åº”è¿›ç¨‹çš„CPUé‡‡æ ·ä¿¡æ¯</h3>
<ol>
<li>åœ¨ç›®æ ‡nodeä¸Šæ‰§è¡Œperfå‘½ä»¤æŠ“å–å¯¹åº”pidçš„CPUçš„é‡‡æ ·ä¿¡æ¯</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">linux &gt; sudo perf record -F 99 -p 1179 -g -- <span class="hljs-built_in">sleep</span> 60

linux &gt; sudo perf script -i perf.data &gt; out.perf
</code></pre>
<ol start="2">
<li>å®‰è£…FlameGraph</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">linux &gt; git <span class="hljs-built_in">clone</span> https://github.com/brendangregg/FlameGraph.git
</code></pre>
<ol start="3">
<li>ç”Ÿæˆç«ç„°å›¾</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">linux &gt; <span class="hljs-built_in">cd</span> FlameGraph //[ä¸Šä¸€ä¸ªæ­¥éª¤git <span class="hljs-built_in">clone</span>çš„FlameGraphçš„ä»“åº“]
linux &gt; ./stackcollapse-perf.pl out.perf | ./flamegraph.pl &gt; flamegraph.svg
</code></pre>
<ol start="4">
<li>ç”Ÿæˆçš„CPUçš„ç«ç„°å›¾å¦‚ä¸‹</li>
</ol>

<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67ea0bf278a64d45b55a99580f1ba324~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbGl1eHV6eHg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767347331&amp;x-signature=mwAsSAMVB2A5cu%2BfIAzlIc5n7WE%3D" alt="" loading="lazy"/></p>
<ol start="5">
<li>åˆ†æè¿™ä¸ªç«ç„°å›¾èƒ½å¤Ÿå¾—åˆ°è€—è´¹CPUæœ€å¤šçš„åœ°æ–¹æ˜¯</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">os.Lstatè¿™ä¸ªç³»ç»Ÿè°ƒç”¨
</code></pre>
<h3 data-id="heading-4">æŸ¥æ‰¾containerdçš„æºç å¯¹åº”çš„æ“ä½œ</h3>
<ol>
<li>æŸ¥æ‰¾containerdå¯¹åº”çš„æºç çš„éƒ¨åˆ†</li>
</ol>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// DiskUsage counts the number of inodes and disk usage for the resources under</span>
<span class="hljs-comment">// path.</span>
<span class="hljs-comment">//çœ‹ä»£ç çš„æ„æ€æ˜¯è·å–ç£ç›˜çš„ä½¿ç”¨é‡</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">DiskUsage</span><span class="hljs-params">(ctx context.Context, roots ...<span class="hljs-type">string</span>)</span></span> (Usage, <span class="hljs-type">error</span>) {
	<span class="hljs-keyword">return</span> diskUsage(ctx, roots...)
}
</code></pre>
<ol start="2">
<li>æŒç»­è¿½è¸ªç³»ç»Ÿçš„è°ƒç”¨ä»£ç </li>
</ol>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">diskUsage</span><span class="hljs-params">(ctx context.Context, roots ...<span class="hljs-type">string</span>)</span></span> (Usage, <span class="hljs-type">error</span>) {
	...çœç•¥
	<span class="hljs-keyword">for</span> _, root := <span class="hljs-keyword">range</span> roots {
        <span class="hljs-comment">//é‡ç‚¹æ˜¯ä¸‹é¢è¿™å—:filepath.Walkè¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨</span>
		<span class="hljs-keyword">if</span> err := filepath.Walk(root, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(path <span class="hljs-type">string</span>, fi os.FileInfo, err <span class="hljs-type">error</span>)</span></span> <span class="hljs-type">error</span> {
			...çœç•¥
		}); 
	}

	...çœç•¥
}

<span class="hljs-comment">//ç»§ç»­å±•å¼€ä»£ç </span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Walk</span><span class="hljs-params">(root <span class="hljs-type">string</span>, fn WalkFunc)</span></span> <span class="hljs-type">error</span> {
	...çœç•¥
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		...çœç•¥
	} <span class="hljs-keyword">else</span> {
		err = walk(root, info, fn)
	}
    ...çœç•¥
}


<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">walk</span><span class="hljs-params">(path <span class="hljs-type">string</span>, info fs.FileInfo, walkFn WalkFunc)</span></span> <span class="hljs-type">error</span> {
	...çœç•¥
	<span class="hljs-keyword">for</span> _, name := <span class="hljs-keyword">range</span> names {
		...çœç•¥:ä¸‹é¢è¿™ä¸ª
		fileInfo, err := lstat(filename)
		...çœç•¥
	}
	<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
}


<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Lstat</span><span class="hljs-params">(name <span class="hljs-type">string</span>)</span></span> (FileInfo, <span class="hljs-type">error</span>) {
	testlog.Stat(name)
	<span class="hljs-keyword">return</span> lstatNolog(name)
}

...çœç•¥ä¸­é—´å¤šä¸ªè¿½è¸ªï¼Œæœ€ç»ˆç»“æœæ˜¯:

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">fstatat</span><span class="hljs-params">(fd <span class="hljs-type">int</span>, path <span class="hljs-type">string</span>, stat *Stat_t, flags <span class="hljs-type">int</span>)</span></span> (err <span class="hljs-type">error</span>) {
	<span class="hljs-keyword">var</span> _p0 *<span class="hljs-type">byte</span>
	_p0, err = BytePtrFromString(path)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span>
	}
	_, _, e1 := Syscall6(SYS_NEWFSTATAT, <span class="hljs-type">uintptr</span>(fd), <span class="hljs-type">uintptr</span>(unsafe.Pointer(_p0)), <span class="hljs-type">uintptr</span>(unsafe.Pointer(stat)), <span class="hljs-type">uintptr</span>(flags), <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
	<span class="hljs-keyword">if</span> e1 != <span class="hljs-number">0</span> {
		err = errnoErr(e1)
	}
	<span class="hljs-keyword">return</span>
}

#å¯ä»¥çœ‹åˆ°ç³»ç»Ÿè°ƒç”¨çš„æ–¹æ³•æ˜¯:sys_newfstatatè¿™ä¸ª
</code></pre>
<h3 data-id="heading-5">ä½¿ç”¨bpftraceæŠ“å–è°ƒç”¨ç»†èŠ‚</h3>
<ol>
<li>å®‰è£…bpftrace(è‡ªè¡Œå®‰è£…)</li>
<li>æä¾›bpftraceçš„è„šæœ¬</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment">#1179æ˜¯nodeçš„containerdçš„è¿›ç¨‹çš„id</span>
tracepoint:syscalls:sys_enter_newfstatat {
    <span class="hljs-keyword">if</span> (pid == 1179) {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"1179 filename: %s, flag: %d\n"</span>, str(args-&gt;filename,100), args-&gt;flag);
    }
}

<span class="hljs-comment">#ä¸Šé¢æ–‡ä»¶ä¿å­˜ä¸º:trace_lstat.bt</span>
</code></pre>
<ol start="3">
<li>æä¾›bashè„šæœ¬</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/sh</span>
<span class="hljs-built_in">export</span> BPFTRACE_MAX_STRLEN=200
bpftrace trace_lstat.bt

<span class="hljs-comment">#åŸå› æ˜¯ï¼Œéœ€è¦å¼•å…¥ä¸€ä¸ªBPFTRACE_MAX_STRLENçš„ç¯å¢ƒå˜é‡ï¼Œå› ä¸ºbpftraceçš„stræ–¹æ³•é»˜è®¤åªä¼šæ‰“å°100çš„é•¿åº¦å¥½åƒï¼Œä½†æ˜¯éœ€è¦é€šè¿‡è¿™ä¸ªæ¥è®¾ç½®æ‰è¡Œ</span>
</code></pre>
<ol start="4">
<li>çœ‹ä¸‹è¾“å‡ºçš„æ•°æ®ä¿¡æ¯</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">...çœç•¥
1179 filename: /var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/43491/fs/home/cpaas/xxl-job/202, flag: 256
1179 filename: /var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/43491/fs/home/cpaas/xxl-job/202, flag: 256
1179 filename: /var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/43491/fs/home/cpaas/xxl-job/202, flag: 256
1179 filename: /var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/43491/fs/home/cpaas/xxl-job/202, flag: 256
1179 filename: /var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/43491/fs/home/cpaas/xxl-job/202, flag: 256
1179 filename: /var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/43491/fs/home/cpaas/xxl-job/202, flag: 256
1179 filename: /var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapsho
...çœç•¥

åˆ†æä¸‹å°±æ˜¯å¦‚ä¸‹çš„ç»“æœ:
1. è¿™ä¸ªæ–‡ä»¶æ€»å…±380562è¡Œ
linux &gt; <span class="hljs-comment"># find /var/lib/containerd/io.containerd.snapshotter.v1.overlayfs -type f|wc -l</span>

<span class="hljs-comment">#è¾“å‡ºçš„æ–‡ä»¶ä¸ªæ•°</span>
1104159


é‚£ä¹ˆåŸºæœ¬èƒ½å¤Ÿç¡®å®šé—®é¢˜å‡ºåœ¨è¿™ä¸ªåœ°æ–¹äº†
</code></pre>
<ol start="5">
<li>è¿›å…¥ç›®å½•æŸ¥æ‰¾å¯¹åº”çš„æ–‡ä»¶ä¸ªæ•°</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment">#ä½¿ç”¨AIæä¾›çš„å¦‚ä¸‹çš„bashè„šæœ¬è¿›è¡Œç»Ÿè®¡æ–‡ä»¶ä¸ªæ•°</span>

<span class="hljs-comment">#!/bin/bash</span>

<span class="hljs-comment"># æŒ‡å®šæ ¹ç›®å½•</span>
root_dir=<span class="hljs-string">"/var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots"</span>

<span class="hljs-comment"># éå†æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰å­æ–‡ä»¶å¤¹</span>
<span class="hljs-keyword">for</span> <span class="hljs-built_in">dir</span> <span class="hljs-keyword">in</span> <span class="hljs-string">"<span class="hljs-variable">$root_dir</span>"</span>/*/; <span class="hljs-keyword">do</span>
    <span class="hljs-comment"># å»é™¤è·¯å¾„æœ«å°¾çš„æ–œæ </span>
    <span class="hljs-built_in">dir</span>=<span class="hljs-variable">${dir%/}</span>
    <span class="hljs-comment"># æå–å­æ–‡ä»¶å¤¹åç§°</span>
    folder_name=$(<span class="hljs-built_in">basename</span> <span class="hljs-string">"<span class="hljs-variable">$dir</span>"</span>)
    <span class="hljs-comment"># ä½¿ç”¨ find å‘½ä»¤ç»Ÿè®¡æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶æ•°é‡</span>
    file_count=$(find <span class="hljs-string">"<span class="hljs-variable">$dir</span>"</span> -<span class="hljs-built_in">type</span> f | <span class="hljs-built_in">wc</span> -l)
    <span class="hljs-comment"># æ£€æŸ¥æ–‡ä»¶æ•°é‡æ˜¯å¦å¤§äº 10000</span>
    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$file_count</span> -gt 10000 ]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$folder_name</span>: <span class="hljs-variable">$file_count</span> ä¸ªæ–‡ä»¶"</span>
    <span class="hljs-keyword">fi</span>
<span class="hljs-keyword">done</span>


<span class="hljs-comment">#1.è¾“å‡ºç»“æœå¦‚ä¸‹:ç»Ÿè®¡æ–‡ä»¶ä¸ªæ•° &gt; 10000çš„(1w)</span>
83674: 21389 ä¸ªæ–‡ä»¶
85266: 16118 ä¸ªæ–‡ä»¶
85333: 22828 ä¸ªæ–‡ä»¶
85932: 11998 ä¸ªæ–‡ä»¶
86634: 430300 ä¸ªæ–‡ä»¶
86635: 430193 ä¸ªæ–‡ä»¶

</code></pre>
<ol start="6">
<li>æ‰¾åˆ°å¦‚ä¸‹çš„æ–‡ä»¶å¤¹çš„ä¸ªæ•°å¾ˆå¤š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">linux &gt; find /var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/86634/fs/home/export-import-server/xxl-job -<span class="hljs-built_in">type</span> f|<span class="hljs-built_in">wc</span> -l
430842

</code></pre>
<ol start="7">
<li>åˆ†æä¸‹è¿™ä¸ªä¸‹é¢çš„æ–‡ä»¶ä¸ªæ•°ç»Ÿè®¡</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment">#è¿˜æ˜¯ä¸Šé¢ 6 æ­¥éª¤çš„bashç»Ÿè®¡è„šæœ¬ï¼Œåªæ˜¯æ¢ä¸‹root_urlå³å¯ï¼Œå¾—åˆ°çš„ç»“æœä¸º</span>
2025-03-22: 55409 ä¸ªæ–‡ä»¶
2025-03-23: 103679 ä¸ªæ–‡ä»¶
2025-03-24: 103680 ä¸ªæ–‡ä»¶
2025-03-25: 103330 ä¸ªæ–‡ä»¶
2025-03-26: 64412 ä¸ªæ–‡ä»¶
</code></pre>
<ol start="8">
<li>éšä¾¿è¿›å…¥ä¸€ä¸ªæ–‡ä»¶å¤¹æŸ¥çœ‹ä¸‹,çœ‹åˆ°éƒ½æ˜¯xxl-jobçš„æ—¥å¿—ã€‚å› ä¸ºxxl-jobæ¯æ¬¡æ‰§è¡Œéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªå¾ˆå°çš„æ—¥å¿—æ–‡ä»¶ï¼Œå¦‚æœä»»åŠ¡å¤šï¼Œå¹¶ä¸”ä»»åŠ¡é¢‘ç¹(ä¾‹å¦‚5ä¸ªä»»åŠ¡ï¼Œç„¶åæ¯ä¸ªä»»åŠ¡5sæ‰§è¡Œä¸€æ¬¡ï¼Œé‚£ä¹ˆæ¯å¤©å°±æ˜¯:86400).çœ‹ä¸Šé¢ç«Ÿç„¶10wå¤šçš„æ—¥å¿—æ–‡ä»¶ä¸ªæ•°ï¼Œä¼°è®¡ä»»åŠ¡æ›´å¤šæ›´é¢‘ç¹.</li>
<li>æ‰‹åŠ¨æ‰§è¡Œä¸‹æ¸…ç†å‰é¢å‡ å¤©çš„æ—¥å¿—å³å¯ï¼Œä¸è¿‡åº”ç”¨ç¨‹åºä¹Ÿè¦ä½œå‡ºæ”¹åŠ¨ï¼Œæ˜¾ç¤ºæ—¥å¿—äº§ç”Ÿçš„ä¸ªæ•°ä»¥åŠä¿ç•™çš„æ—¶é—´</li>
<li>æ¸…ç†xxl-jobçš„è¿‡æœŸæ— ç”¨çš„æ—¥å¿—æ–‡ä»¶ä¹‹åï¼ŒæŸ¥çœ‹containerdè¿›ç¨‹æ¶ˆè€—çš„CPU</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">[root@h-172-16-15-144-DEV-k8s-node fs]<span class="hljs-comment"># pidstat -p 1163 1</span>
Linux 5.14.0-479.el9.x86_64 (h-172-16-15-144-DEV-k8s-node) 	2025å¹´03æœˆ26æ—¥ 	_x86_64_	(16 CPU)

13åˆ†21ç§’   UID       PID    %usr %system  %guest   %<span class="hljs-built_in">wait</span>    %CPU   CPU  Command
13åˆ†22ç§’     0      1163    9.00    1.00    0.00    0.00   10.00     2  containerd
13åˆ†23ç§’     0      1163    0.00    1.00    0.00    0.00    1.00     2  containerd
13åˆ†24ç§’     0      1163    8.00    9.00    0.00    0.00   17.00     2  containerd
13åˆ†25ç§’     0      1163    3.00    1.00    0.00    0.00    4.00     2  containerd
13åˆ†26ç§’     0      1163    1.00    1.00    0.00    0.00    2.00     2  containerd
13åˆ†27ç§’     0      1163    2.00    1.00    0.00    0.00    3.00     2  containerd
13åˆ†28ç§’     0      1163    1.00    1.00    0.00    0.00    2.00     2  containerd
13åˆ†29ç§’     0      1163    1.00    0.00    0.00    0.00    1.00     2  containerd
13åˆ†30ç§’     0      1163    0.00    1.00    0.00    0.00    1.00     2  containerd
13åˆ†31ç§’     0      1163   10.00    0.00    0.00    0.00   10.00     2  containerd
13åˆ†32ç§’     0      1163    2.00    1.00    0.00    0.00    3.00     2  containerd
13åˆ†33ç§’     0      1163    0.00    0.00    0.00    0.00    0.00     2  containerd
13åˆ†34ç§’     0      1163    9.00    9.00    0.00    0.00   18.00     2  containerd
13åˆ†35ç§’     0      1163    1.00    1.00    0.00    0.00    2.00     2  containerd
13åˆ†36ç§’     0      1163    0.00    0.00    0.00    0.00    0.00     2  containerd
13åˆ†37ç§’     0      1163    1.00    1.00    0.00    0.00    2.00     2  containerd
13åˆ†38ç§’     0      1163    1.00    0.00    0.00    0.00    1.00     2  containerd
13åˆ†39ç§’     0      1163    3.00    1.00    0.00    0.00    4.00     2  containerd
13åˆ†40ç§’     0      1163    0.00    1.00    0.00    0.00    1.00     2  containerd
13åˆ†41ç§’     0      1163   11.00    1.00    0.00    0.00   12.00     2  containerd
13åˆ†42ç§’     0      1163    1.00    0.00    0.00    0.00    1.00     2  containerd
13åˆ†43ç§’     0      1163    0.00    0.00    0.00    0.00    0.00     2  containerd
13åˆ†44ç§’     0      1163    8.00   10.00    0.00    0.00   18.00     2  containerd
13åˆ†45ç§’     0      1163    0.00    0.00    0.00    0.00    0.00     2  containerd
13åˆ†46ç§’     0      1163    1.00    0.00    0.00    0.00    1.00     2  containerd
13åˆ†47ç§’     0      1163   11.00    2.00    0.00    0.00   13.00     2  containerd
13åˆ†48ç§’     0      1163    0.00    0.00    0.00    0.00    0.00     2  containerd
13åˆ†49ç§’     0      1163    3.00    2.00    0.00    0.00    5.00     2  containerd
13åˆ†50ç§’     0      1163    1.00    0.00    0.00    0.00    1.00     2  containerd
13åˆ†51ç§’     0      1163    1.00    0.00    0.00    0.00    1.00     2  containerd
13åˆ†52ç§’     0      1163    2.00    1.00    0.00    0.00    3.00     2  containerd
13åˆ†53ç§’     0      1163    0.00    1.00    0.00    0.00    1.00     2  containerd
13åˆ†54ç§’     0      1163   18.00    9.00    0.00    0.00   27.00     2  containerd
13åˆ†55ç§’     0      1163    2.00    1.00    0.00    0.00    3.00     2  containerd
13åˆ†56ç§’     0      1163    2.00    2.00    0.00    0.00    4.00     2  containerd
13åˆ†57ç§’     0      1163    1.00    1.00    0.00    0.00    2.00     2  containerd
13åˆ†58ç§’     0      1163    0.00    0.00    0.00    0.00    0.00     2  containerd
13åˆ†59ç§’     0      1163    2.00    1.00    0.00    0.00    3.00     2  containerd
14åˆ†00ç§’     0      1163    1.00    0.00    0.00    0.00    1.00     2  containerd

<span class="hljs-comment">#å¯ä»¥çœ‹åˆ°CPUé™ä¸‹æ¥äº†ï¼Œæœ€é«˜æ‰27%</span>
</code></pre>
<h3 data-id="heading-6">åŸå› åˆ†æ</h3>
<ol>
<li>ç”±äºcontainerdå¼€å¯äº†ä¸€ä¸ªå®šæ—¶ä»»åŠ¡å»è·å–è‡ªå·±ç®¡è¾–çš„ç£ç›˜çš„ä½¿ç”¨å¤§å°:å°±æ˜¯DiskUsageæ–¹æ³•</li>
<li>ç„¶åéœ€è¦è°ƒç”¨ç³»ç»Ÿè°ƒç”¨çš„newfstatatè¿›è¡Œç»Ÿè®¡</li>
<li>ç„¶åç”±äºæ–‡ä»¶ä¸ªæ•°å¤ªå¤šäº†ï¼Œå¯¼è‡´éå¸¸è€—è´¹CPU</li>
<li>è¿™ä¸ªæ–‡ä»¶å¾ˆå¤šçš„snapshotsä¸‹é¢æœ‰å¾ˆå¤špodçš„containerå†™çš„æ—¥å¿—ï¼Œxxl-jobçš„æ—¥å¿—ï¼Œäº§ç”Ÿäº†å‡ ç™¾ä¸‡ä¸ªï¼Œæ–‡ä»¶å¾ˆå°ï¼Œä½†æ˜¯æ–‡ä»¶ä¸ªæ•°å¾ˆå¤šï¼Œæ²¡æœ‰åŠæ—¶çš„æ¸…ç†ï¼Œå¯¼è‡´containerdæ¯æ¬¡æ‰«æéƒ½éå¸¸è€—è´¹CPU</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Redisä¸»ä»å¤åˆ¶åŸç†ä¸å®æˆ˜ï¼šæ„å»ºé«˜å¯ç”¨ç¼“å­˜æ¶æ„]]></title>    <link>https://juejin.cn/post/7587630831466250282</link>    <guid>https://juejin.cn/post/7587630831466250282</guid>    <pubDate>2025-12-26T01:07:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587630831466250282" data-draft-id="7490815158190243866" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Redisä¸»ä»å¤åˆ¶åŸç†ä¸å®æˆ˜ï¼šæ„å»ºé«˜å¯ç”¨ç¼“å­˜æ¶æ„"/> <meta itemprop="keywords" content="Redis,æ•°æ®åº“,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2025-12-26T01:07:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Goé«˜å¹¶å‘æ¶æ„_ç‹å·¥"/> <meta itemprop="url" content="https://juejin.cn/user/446863555701561"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Redisä¸»ä»å¤åˆ¶åŸç†ä¸å®æˆ˜ï¼šæ„å»ºé«˜å¯ç”¨ç¼“å­˜æ¶æ„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/446863555701561/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Goé«˜å¹¶å‘æ¶æ„_ç‹å·¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-26T01:07:24.000Z" title="Fri Dec 26 2025 01:07:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-26
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    16
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»18åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">ä¸€ã€å¼•è¨€</h4>
<p>åœ¨ç°ä»£åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç¼“å­˜å‡ ä¹æ— å¤„ä¸åœ¨ï¼Œè€ŒRediså‡­å€Ÿå…¶é«˜æ€§èƒ½å’Œä¸°å¯Œçš„æ•°æ®ç»“æ„ï¼Œå·²ç„¶æˆä¸ºç¼“å­˜é¢†åŸŸçš„â€œæ˜æ˜Ÿé€‰æ‰‹â€ã€‚æ— è®ºæ˜¯ç”µå•†å¹³å°çš„ç§’æ€åº“å­˜ã€ç¤¾äº¤åº”ç”¨çš„çƒ­ç‚¹æ•°æ®ï¼Œè¿˜æ˜¯å®æ—¶åˆ†æçš„ä¸­é—´å±‚å­˜å‚¨ï¼ŒRediséƒ½ä»¥å…¶ä½å»¶è¿Ÿå’Œé«˜ååé‡èµ¢å¾—äº†å¼€å‘è€…çš„é’çã€‚ç„¶è€Œï¼Œéšç€ä¸šåŠ¡è§„æ¨¡çš„å¢é•¿å’Œå¯¹æœåŠ¡å¯ç”¨æ€§çš„æ›´é«˜è¦æ±‚ï¼Œå•èŠ‚ç‚¹çš„Rediså·²ç»éš¾ä»¥æ»¡è¶³éœ€æ±‚ã€‚è¿™æ—¶å€™ï¼Œå¦‚ä½•æ„å»ºä¸€ä¸ªé«˜å¯ç”¨çš„ç¼“å­˜æ¶æ„å°±æˆäº†æ‘†åœ¨æˆ‘ä»¬é¢å‰çš„è¯¾é¢˜ã€‚</p>
<p>é«˜å¯ç”¨ä¸ä»…ä»…æ„å‘³ç€â€œä¸åœæœºâ€ï¼Œæ›´éœ€è¦åœ¨æ•…éšœå‘ç”Ÿæ—¶å¿«é€Ÿæ¢å¤ã€åœ¨é«˜å¹¶å‘ä¸‹ç¨³å®šè¿è¡Œã€‚Redisçš„ä¸»ä»å¤åˆ¶ï¼ˆReplicationï¼‰æœºåˆ¶æ­£æ˜¯è§£å†³è¿™ä¸€é—®é¢˜çš„åŸºçŸ³ã€‚é€šè¿‡å°†æ•°æ®ä»ä¸»èŠ‚ç‚¹ï¼ˆMasterï¼‰åŒæ­¥åˆ°å¤šä¸ªä»èŠ‚ç‚¹ï¼ˆSlaveï¼‰ï¼Œæˆ‘ä»¬ä¸ä»…èƒ½å®ç°è¯»å†™åˆ†ç¦»ï¼Œåˆ†æ‹…ä¸»èŠ‚ç‚¹çš„å‹åŠ›ï¼Œè¿˜èƒ½åœ¨ä¸»èŠ‚ç‚¹æ•…éšœæ—¶å¿«é€Ÿåˆ‡æ¢ï¼Œä¿éšœæœåŠ¡çš„è¿ç»­æ€§ã€‚å¯ä»¥è¯´ï¼Œä¸»ä»å¤åˆ¶å°±åƒä¸€æ”¯ä¹é˜Ÿçš„æŒ‡æŒ¥ï¼Œåè°ƒç€å„ä¸ªä¹æ‰‹ï¼ˆèŠ‚ç‚¹ï¼‰å…±åŒæ¼”å¥å‡ºé«˜å¯ç”¨çš„ä¹ç« ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« çš„ç›®æ ‡è¯»è€…æ˜¯é‚£äº›å·²æœ‰1-2å¹´Rediså¼€å‘ç»éªŒçš„å¼€å‘è€…ã€‚ä½ å¯èƒ½å·²ç»ç†Ÿæ‚‰Redisçš„åŸºæœ¬æ“ä½œï¼Œä½†å¯¹å¦‚ä½•åœ¨ç”Ÿäº§ç¯å¢ƒä¸­åˆ©ç”¨ä¸»ä»å¤åˆ¶æ„å»ºé«˜å¯ç”¨æ¶æ„æ„Ÿåˆ°å¥½å¥‡ï¼Œç”šè‡³åœ¨å®æˆ˜ä¸­è¸©è¿‡ä¸€äº›å‘ã€‚åˆ«æ‹…å¿ƒï¼Œè¿™é‡Œä¸ä»…ä¼šæ·±å…¥å‰–æä¸»ä»å¤åˆ¶çš„åŸç†ï¼Œè¿˜ä¼šç»“åˆå®é™…é¡¹ç›®ç»éªŒï¼Œåˆ†äº«é…ç½®æ–¹æ³•ã€ä¼˜åŒ–æŠ€å·§å’Œè¸©å‘è§£å†³æ–¹æ¡ˆã€‚æ— è®ºä½ æ˜¯æƒ³æå‡æŠ€æœ¯æ·±åº¦ï¼Œè¿˜æ˜¯å‡†å¤‡åœ¨ä¸‹ä¸€ä¸ªé¡¹ç›®ä¸­å¤§å±•èº«æ‰‹ï¼Œè¿™ç¯‡æ–‡ç« éƒ½å¸Œæœ›ä¸ºä½ æä¾›å®å®åœ¨åœ¨çš„ä»·å€¼ã€‚</p>
<p>æ–‡ç« å°†ä»åŸç†åˆ°å®æˆ˜é€æ­¥å±•å¼€ï¼šå…ˆå¸¦ä½ ç†è§£ä¸»ä»å¤åˆ¶çš„æ ¸å¿ƒæœºåˆ¶ï¼Œå†æ‰‹æŠŠæ‰‹æ•™ä½ æ­å»ºä¸€ä¸ªé«˜å¯ç”¨ç¼“å­˜æ¶æ„ï¼Œæœ€åé€šè¿‡çœŸå®æ¡ˆä¾‹å’Œç»éªŒæ€»ç»“ï¼Œå¸®ä½ é¿å¼€å¸¸è§é™·é˜±ã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬ä»Redisä¸»ä»å¤åˆ¶çš„åŸºæœ¬æ¦‚å¿µå¼€å§‹ï¼Œé€æ­¥æ­å¼€å®ƒçš„é«˜å¯ç”¨é­”æ³•ã€‚</p>
<hr/>
<h4 data-id="heading-1">äºŒã€Redisä¸»ä»å¤åˆ¶æ ¸å¿ƒåŸç†</h4>
<p>ä¸»ä»å¤åˆ¶æ˜¯Redisé«˜å¯ç”¨æ¶æ„çš„åŸºçŸ³ï¼Œå®ƒé€šè¿‡å°†ä¸»èŠ‚ç‚¹çš„æ•°æ®å¤åˆ¶åˆ°ä»èŠ‚ç‚¹ï¼Œä¸ä»…æå‡äº†ç³»ç»Ÿçš„è¯»æ€§èƒ½ï¼Œè¿˜ä¸ºæ•…éšœè½¬ç§»æä¾›äº†åŸºç¡€ä¿éšœã€‚ç†è§£å…¶åŸç†ï¼Œå°±åƒæ‹†è§£ä¸€å°ç²¾å¯†çš„æœºæ¢°è¡¨ï¼Œåªæœ‰çœ‹æ¸…æ¯ä¸ªé½¿è½®çš„è¿è½¬é€»è¾‘ï¼Œæ‰èƒ½åœ¨å®æˆ˜ä¸­æ¸¸åˆƒæœ‰ä½™ã€‚æœ¬èŠ‚å°†ä»åŸºæœ¬æ¦‚å¿µå…¥æ‰‹ï¼Œé€æ­¥å‰–æä¸»ä»å¤åˆ¶çš„å·¥ä½œæµç¨‹å’Œå…³é”®æŠ€æœ¯ç‚¹ï¼Œå¹¶åˆ†æå…¶ä¼˜åŠ¿ä¸å±€é™ã€‚</p>
<h5 data-id="heading-2">1. ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶ï¼Ÿ</h5>
<p>ç®€å•æ¥è¯´ï¼Œä¸»ä»å¤åˆ¶æ˜¯Redisä¸­ä¸€ç§æ•°æ®åŒæ­¥æœºåˆ¶ï¼Œä¸»èŠ‚ç‚¹è´Ÿè´£å¤„ç†å†™æ“ä½œï¼Œå¹¶å°†æ•°æ®å˜æ›´å®æ—¶åŒæ­¥åˆ°å¤šä¸ªä»èŠ‚ç‚¹ï¼Œä»èŠ‚ç‚¹åˆ™æä¾›åªè¯»æœåŠ¡ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä¸»èŠ‚ç‚¹åƒæ˜¯ä¸€ä½å¿™ç¢Œçš„å¨å¸ˆï¼Œä¸æ–­çƒ¹é¥ªæ–°èœï¼ˆå†™æ•°æ®ï¼‰ï¼Œè€Œä»èŠ‚ç‚¹åˆ™æ˜¯å¸®å¨ï¼ŒæŠŠæˆå“èœåˆ†å‘ç»™é¡¾å®¢ï¼ˆè¯»æ•°æ®ï¼‰ã€‚è¿™ç§åˆ†å·¥ä¸ä»…å‡è½»äº†ä¸»èŠ‚ç‚¹çš„è´Ÿæ‹…ï¼Œè¿˜è®©ç³»ç»Ÿå…·å¤‡äº†æ›´é«˜çš„å¹¶å‘èƒ½åŠ›å’Œå®¹é”™æ€§ã€‚</p>
<ul>
<li><strong>ä¸»èŠ‚ç‚¹ï¼ˆMasterï¼‰</strong>ï¼šæ¥æ”¶å®¢æˆ·ç«¯çš„å†™è¯·æ±‚ï¼Œç»´æŠ¤æ•°æ®çš„æœ€æ–°çŠ¶æ€ã€‚</li>
<li><strong>ä»èŠ‚ç‚¹ï¼ˆSlaveï¼‰</strong>ï¼šé€šè¿‡å¤åˆ¶ä¸»èŠ‚ç‚¹çš„æ•°æ®æä¾›è¯»æœåŠ¡ï¼Œé»˜è®¤é…ç½®ä¸ºåªè¯»ã€‚</li>
</ul>
<h5 data-id="heading-3">2. ä¸»ä»å¤åˆ¶çš„å·¥ä½œæµç¨‹</h5>
<p>ä¸»ä»å¤åˆ¶çš„å®ç°å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š<strong>å…¨é‡åŒæ­¥</strong>å’Œ<strong>å¢é‡åŒæ­¥</strong>ï¼Œå†è¾…ä»¥å¿ƒè·³æ£€æµ‹æ¥ç»´æŠ¤è¿æ¥çŠ¶æ€ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†æµç¨‹ï¼š</p>
<h6 data-id="heading-4">ï¼ˆ1ï¼‰å…¨é‡åŒæ­¥ï¼ˆFull Resynchronizationï¼‰</h6>
<p>å½“ä»èŠ‚ç‚¹åˆæ¬¡è¿æ¥ä¸»èŠ‚ç‚¹æˆ–å› ç½‘ç»œä¸­æ–­é‡è¿æ—¶ï¼Œä¼šè§¦å‘å…¨é‡åŒæ­¥ã€‚ä¸»èŠ‚ç‚¹ä¼šç”Ÿæˆä¸€ä¸ªRDBå¿«ç…§æ–‡ä»¶ï¼Œå¹¶ä¼ è¾“ç»™ä»èŠ‚ç‚¹ã€‚</p>
<ul>
<li><strong>æµç¨‹ç¤ºæ„å›¾</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-lua" lang="lua">ä¸»èŠ‚ç‚¹        ä»èŠ‚ç‚¹
  | ç”ŸæˆRDBå¿«ç…§   |
  | <span class="hljs-comment">------------&gt; | æ¥æ”¶RDBå¿«ç…§</span>
  |              | åŠ è½½æ•°æ®åˆ°å†…å­˜
</code></pre>
<ul>
<li><strong>æ­¥éª¤</strong>ï¼š
<ol>
<li>ä»èŠ‚ç‚¹å‘é€<code>PSYNC</code>å‘½ä»¤è¯·æ±‚åŒæ­¥ã€‚</li>
<li>ä¸»èŠ‚ç‚¹æ‰§è¡Œ<code>BGSAVE</code>ï¼Œåå°ç”ŸæˆRDBå¿«ç…§ã€‚</li>
<li>å¿«ç…§é€šè¿‡ç½‘ç»œä¼ è¾“åˆ°ä»èŠ‚ç‚¹ï¼Œä»èŠ‚ç‚¹åŠ è½½æ•°æ®ã€‚</li>
</ol>
</li>
</ul>
<h6 data-id="heading-5">ï¼ˆ2ï¼‰å¢é‡åŒæ­¥ï¼ˆPartial Resynchronizationï¼‰</h6>
<p>å…¨é‡åŒæ­¥å®Œæˆåï¼Œåç»­çš„å†™æ“ä½œé€šè¿‡å¢é‡åŒæ­¥ä¼ æ’­ã€‚ä¸»èŠ‚ç‚¹å°†å‘½ä»¤å†™å…¥å¤åˆ¶ç¼“å†²åŒºï¼ˆReplication Bufferï¼‰ï¼Œä»èŠ‚ç‚¹å®æ—¶è¯»å–å¹¶æ‰§è¡Œã€‚</p>
<ul>
<li><strong>æµç¨‹ç¤ºæ„å›¾</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-lua" lang="lua">ä¸»èŠ‚ç‚¹        ä»èŠ‚ç‚¹
  | å†™å‘½ä»¤ç¼“å†²    |
  | <span class="hljs-comment">------------&gt; | æ‰§è¡Œå‘½ä»¤</span>
  | å¿ƒè·³æ£€æµ‹      | åé¦ˆçŠ¶æ€
</code></pre>
<ul>
<li><strong>æœºåˆ¶</strong>ï¼š
<ul>
<li>ä¸»èŠ‚ç‚¹ç»´æŠ¤ä¸€ä¸ªå¤åˆ¶åç§»é‡ï¼ˆOffsetï¼‰ï¼Œè®°å½•å·²å‘é€çš„æ•°æ®ä½ç½®ã€‚</li>
<li>ä»èŠ‚ç‚¹åé¦ˆè‡ªå·±çš„åç§»é‡ï¼Œä¸»èŠ‚ç‚¹åªå‘é€å¢é‡éƒ¨åˆ†ã€‚</li>
</ul>
</li>
</ul>
<h6 data-id="heading-6">ï¼ˆ3ï¼‰å¿ƒè·³æ£€æµ‹ä¸çŠ¶æ€ç»´æŠ¤</h6>
<p>ä¸»ä»ä¹‹é—´é€šè¿‡å®šæœŸçš„<code>PING/PONG</code>æ¶ˆæ¯ä¿æŒè¿æ¥ï¼Œæ£€æµ‹ç½‘ç»œçŠ¶æ€å’Œä»èŠ‚ç‚¹çš„å­˜æ´»æƒ…å†µã€‚</p>
<h5 data-id="heading-7">3. å…³é”®æŠ€æœ¯ç‚¹è§£æ</h5>
<p>ä¸»ä»å¤åˆ¶çœ‹ä¼¼ç®€å•ï¼Œä½†èƒŒåæœ‰ä¸€äº›æŠ€æœ¯ç»†èŠ‚å€¼å¾—å…³æ³¨ï¼š</p>
<ul>
<li>
<p><strong>PSYNCå‘½ä»¤ä¸å¤åˆ¶åç§»é‡</strong></p>
<ul>
<li><code>PSYNC</code>æ˜¯Redis 2.8å¼•å…¥çš„åŒæ­¥å‘½ä»¤ï¼Œæ”¯æŒéƒ¨åˆ†é‡åŒæ­¥ï¼ˆPartial Resyncï¼‰ã€‚å®ƒé€šè¿‡å¤åˆ¶åç§»é‡å’Œä¸»èŠ‚ç‚¹çš„è¿è¡ŒIDï¼ˆRun IDï¼‰åˆ¤æ–­æ˜¯å¦éœ€è¦å…¨é‡åŒæ­¥ã€‚</li>
<li><strong>è¡¨æ ¼ï¼šPSYNCå·¥ä½œæ¨¡å¼</strong>

























<table><thead><tr><th>åœºæ™¯</th><th>ä¸»èŠ‚ç‚¹å“åº”</th><th>è¡Œä¸º</th></tr></thead><tbody><tr><td>åˆæ¬¡è¿æ¥</td><td>FULLRESYNC</td><td>ä¼ è¾“RDBå¿«ç…§</td></tr><tr><td>ç½‘ç»œä¸­æ–­åé‡è¿</td><td>CONTINUE</td><td>å‘é€ç¼“å†²åŒºå¢é‡æ•°æ®</td></tr><tr><td>åç§»é‡ä¸¢å¤±</td><td>FULLRESYNC</td><td>é‡æ–°å…¨é‡åŒæ­¥</td></tr></tbody></table>
</li>
</ul>
</li>
<li>
<p><strong>ä¸»ä»ä¸€è‡´æ€§ä¸å»¶è¿Ÿé—®é¢˜</strong></p>
<ul>
<li>ä¸»ä»å¤åˆ¶æ˜¯å¼‚æ­¥çš„ï¼Œä»èŠ‚ç‚¹æ•°æ®å¯èƒ½ç•¥æ»åäºä¸»èŠ‚ç‚¹ï¼Œå°¤å…¶åœ¨é«˜å¹¶å‘å†™åœºæ™¯ä¸‹ã€‚å»¶è¿Ÿå¤§å°å–å†³äºç½‘ç»œçŠ¶å†µå’Œä»èŠ‚ç‚¹å¤„ç†èƒ½åŠ›ã€‚</li>
<li><strong>ç»éªŒ</strong>ï¼šåœ¨é‡‘èç±»é¡¹ç›®ä¸­ï¼Œè¿™ç§å»¶è¿Ÿå¯èƒ½å¯¼è‡´è¯»åˆ°â€œè„æ•°æ®â€ï¼Œéœ€ç»“åˆä¸šåŠ¡å®¹å¿åº¦è°ƒæ•´æ¶æ„ã€‚</li>
</ul>
</li>
<li>
<p><strong>Redis Sentinelä¸ä¸»ä»åˆ‡æ¢</strong></p>
<ul>
<li>Sentinelæ˜¯Redisçš„é«˜å¯ç”¨ç»„ä»¶ï¼Œç›‘æ§ä¸»ä»çŠ¶æ€å¹¶åœ¨ä¸»èŠ‚ç‚¹å®•æœºæ—¶è‡ªåŠ¨åˆ‡æ¢ä»èŠ‚ç‚¹ä¸ºä¸»ã€‚è™½ç„¶åæ–‡ä¼šè¯¦ç»†å±•å¼€ï¼Œä½†è¿™é‡Œæä¸€å¥ï¼šä¸»ä»å¤åˆ¶æ˜¯Sentinelçš„åŸºç¡€ã€‚</li>
</ul>
</li>
</ul>
<h5 data-id="heading-8">4. ä¸»ä»å¤åˆ¶çš„ä¼˜åŠ¿ä¸å±€é™</h5>
<p>ä¸»ä»å¤åˆ¶å¹¶éä¸‡èƒ½ï¼Œå®ƒæœ‰è‡ªå·±çš„â€œé—ªå…‰ç‚¹â€å’Œâ€œçŸ­æ¿â€ï¼š</p>
<ul>
<li>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ol>
<li><strong>è¯»å†™åˆ†ç¦»</strong>ï¼šä»èŠ‚ç‚¹åˆ†æ‹…è¯»è¯·æ±‚ï¼Œä¸»èŠ‚ç‚¹ä¸“æ³¨å†™æ“ä½œï¼Œæå‡æ•´ä½“ååé‡ã€‚</li>
<li><strong>é«˜å¯ç”¨åŸºç¡€</strong>ï¼šä»èŠ‚ç‚¹å¯ä½œä¸ºä¸»èŠ‚ç‚¹çš„å¤‡ä»½ï¼Œé…åˆSentinelå®ç°æ•…éšœè½¬ç§»ã€‚</li>
</ol>
</li>
<li>
<p><strong>å±€é™</strong>ï¼š</p>
<ol>
<li><strong>æ•°æ®ä¸€è‡´æ€§æŒ‘æˆ˜</strong>ï¼šå¼‚æ­¥å¤åˆ¶å¯èƒ½å¯¼è‡´ä¸»ä»æ•°æ®ä¸ä¸€è‡´ã€‚</li>
<li><strong>ä¸»èŠ‚ç‚¹å•ç‚¹å‹åŠ›</strong>ï¼šæ‰€æœ‰å†™æ“ä½œä»é›†ä¸­äºä¸»èŠ‚ç‚¹ï¼Œé«˜å¹¶å‘ä¸‹æ˜“æˆä¸ºç“¶é¢ˆã€‚</li>
</ol>
</li>
</ul>
<p>ä»åŸç†ä¸Šçœ‹ï¼Œä¸»ä»å¤åˆ¶å°±åƒä¸€æ¡é«˜æ•ˆçš„ç”Ÿäº§çº¿ï¼Œä¸»èŠ‚ç‚¹è´Ÿè´£ç”Ÿäº§ï¼ˆå†™ï¼‰ï¼Œä»èŠ‚ç‚¹è´Ÿè´£åˆ†å‘ï¼ˆè¯»ï¼‰ã€‚ä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¦‚ä½•é…ç½®ã€ä¼˜åŒ–è¿™æ¡â€œç”Ÿäº§çº¿â€ï¼Œè¿˜éœ€è¦æˆ‘ä»¬èµ°è¿›å®æˆ˜åœºæ™¯ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åŸºäºè¿™äº›åŸç†ï¼Œæ‰‹æŠŠæ‰‹æ­å»ºä¸€ä¸ªé«˜å¯ç”¨ç¼“å­˜æ¶æ„ã€‚</p>
<hr/>
<h4 data-id="heading-9">ä¸‰ã€ä¸»ä»å¤åˆ¶å®æˆ˜ï¼šæ„å»ºé«˜å¯ç”¨ç¼“å­˜æ¶æ„</h4>
<p>ç†è§£äº†ä¸»ä»å¤åˆ¶çš„åŸç†åï¼Œæ¥ä¸‹æ¥æ˜¯æ—¶å€™å°†ç†è®ºè½¬åŒ–ä¸ºå®è·µäº†ã€‚å°±åƒæ­ç§¯æœ¨ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦ä»åŸºç¡€çš„ä¸»ä»ç¯å¢ƒæ­å»ºå¼€å§‹ï¼Œé€æ­¥åŠ å…¥è¯»å†™åˆ†ç¦»å’Œé«˜å¯ç”¨è®¾è®¡ï¼Œæœ€ç»ˆæ„å»ºä¸€ä¸ªå¥å£®çš„ç¼“å­˜æ¶æ„ã€‚æœ¬èŠ‚å°†é€šè¿‡å…·ä½“çš„é…ç½®æ­¥éª¤ã€ä»£ç ç¤ºä¾‹å’Œæ¶æ„è®¾è®¡ï¼Œå¸¦ä½ ä¸€æ­¥æ­¥å®ç°è¿™ä¸€åˆ‡ã€‚å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬åŠ¨æ‰‹å§ï¼</p>
<h5 data-id="heading-10">1. ç¯å¢ƒæ­å»ºä¸é…ç½®</h5>
<p>æ­å»ºä¸»ä»ç¯å¢ƒæ˜¯ç¬¬ä¸€æ­¥ï¼Œå¯ä»¥é€‰æ‹©å•æœºå¤šå®ä¾‹ï¼ˆç”¨äºæµ‹è¯•ï¼‰æˆ–å¤šæœºéƒ¨ç½²ï¼ˆç”Ÿäº§æ¨èï¼‰ã€‚è¿™é‡Œä»¥å•æœºä¸ºä¾‹ï¼Œå±•ç¤ºåŸºæœ¬é…ç½®ã€‚</p>
<h6 data-id="heading-11">ï¼ˆ1ï¼‰ä¸»ä»èŠ‚ç‚¹éƒ¨ç½²æ­¥éª¤</h6>
<ul>
<li><strong>å‰æ</strong>ï¼šç¡®ä¿Rediså·²å®‰è£…ï¼ˆå»ºè®®ç‰ˆæœ¬5.0+ï¼‰ï¼Œå¹¶å‡†å¤‡å¥½ä¸¤ä¸ªç«¯å£ï¼š6379ï¼ˆä¸»ï¼‰ã€6380ï¼ˆä»ï¼‰ã€‚</li>
<li><strong>æ­¥éª¤</strong>ï¼š
<ol>
<li>åˆ›å»ºä¸¤ä¸ªé…ç½®æ–‡ä»¶ï¼š<code>redis-6379.conf</code>ï¼ˆä¸»èŠ‚ç‚¹ï¼‰å’Œ<code>redis-6380.conf</code>ï¼ˆä»èŠ‚ç‚¹ï¼‰ã€‚</li>
<li>ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œè®¾ç½®ä¸»ä»å…³ç³»ã€‚</li>
<li>åˆ†åˆ«å¯åŠ¨ä¸¤ä¸ªå®ä¾‹ã€‚</li>
</ol>
</li>
</ul>
<h6 data-id="heading-12">ï¼ˆ2ï¼‰é…ç½®æ–‡ä»¶è¯¦è§£</h6>
<p>ä»¥ä¸‹æ˜¯ä¸»ä»é…ç½®çš„æ ¸å¿ƒå‚æ•°ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸»èŠ‚ç‚¹ redis-6379.conf</span>
<span class="hljs-built_in">bind</span> 0.0.0.0          <span class="hljs-comment"># ç›‘å¬æ‰€æœ‰IPï¼ˆç”Ÿäº§ä¸­å»ºè®®é™å®šå†…ç½‘IPï¼‰</span>
port 6379             <span class="hljs-comment"># ä¸»èŠ‚ç‚¹ç«¯å£</span>
daemonize <span class="hljs-built_in">yes</span>         <span class="hljs-comment"># åå°è¿è¡Œ</span>

<span class="hljs-comment"># ä»èŠ‚ç‚¹ redis-6380.conf</span>
<span class="hljs-built_in">bind</span> 0.0.0.0
port 6380             <span class="hljs-comment"># ä»èŠ‚ç‚¹ç«¯å£</span>
daemonize <span class="hljs-built_in">yes</span>
replicaof 127.0.0.1 6379  <span class="hljs-comment"># æŒ‡å®šä¸»èŠ‚ç‚¹IPå’Œç«¯å£</span>
replica-read-only <span class="hljs-built_in">yes</span>     <span class="hljs-comment"># ä»èŠ‚ç‚¹åªè¯»ï¼ˆé»˜è®¤å€¼ï¼Œå¯ä¸å†™ï¼‰</span>
</code></pre>
<ul>
<li><strong>å‚æ•°è¯´æ˜</strong>ï¼š
<ul>
<li><code>replicaof</code>ï¼šä»èŠ‚ç‚¹æŒ‡å‘ä¸»èŠ‚ç‚¹çš„å…³é”®é…ç½®ã€‚</li>
<li><code>replica-read-only</code>ï¼šç¡®ä¿ä»èŠ‚ç‚¹åªå¤„ç†è¯»è¯·æ±‚ï¼Œé¿å…è¯¯å†™ã€‚</li>
</ul>
</li>
</ul>
<h6 data-id="heading-13">ï¼ˆ3ï¼‰å¯åŠ¨ä¸éªŒè¯</h6>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨ä¸»èŠ‚ç‚¹</span>
redis-server redis-6379.conf
<span class="hljs-comment"># å¯åŠ¨ä»èŠ‚ç‚¹</span>
redis-server redis-6380.conf
<span class="hljs-comment"># æ£€æŸ¥ä¸»ä»çŠ¶æ€</span>
redis-cli -p 6379 INFO REPLICATION
</code></pre>
<p>è¾“å‡ºç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">role:master
connected_slaves:1
slave0:<span class="hljs-attr">ip</span>=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>,port=<span class="hljs-number">6380</span>,state=<span class="hljs-literal">on</span>line,<span class="hljs-literal">off</span>set=<span class="hljs-number">140</span>,lag=<span class="hljs-number">0</span>
</code></pre>
<h5 data-id="heading-14">2. è¯»å†™åˆ†ç¦»å®æˆ˜</h5>
<p>ä¸»ä»ç¯å¢ƒå°±ç»ªåï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®¢æˆ·ç«¯å®ç°è¯»å†™åˆ†ç¦»ï¼Œæå‡è¯»æ€§èƒ½ã€‚ä»¥Javaçš„Jedisä¸ºä¾‹ï¼Œå±•ç¤ºå…·ä½“å®ç°ã€‚</p>
<h6 data-id="heading-15">ï¼ˆ1ï¼‰Jedisé…ç½®ä¸»ä»è¯»å†™åˆ†ç¦»</h6>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisMasterSlaveDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è¿æ¥ä¸»èŠ‚ç‚¹ï¼ˆå†™ï¼‰</span>
        <span class="hljs-type">Jedis</span> <span class="hljs-variable">master</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"127.0.0.1"</span>, <span class="hljs-number">6379</span>);
        <span class="hljs-comment">// è¿æ¥ä»èŠ‚ç‚¹ï¼ˆè¯»ï¼‰</span>
        <span class="hljs-type">Jedis</span> <span class="hljs-variable">slave</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"127.0.0.1"</span>, <span class="hljs-number">6380</span>);

        <span class="hljs-comment">// å†™æ•°æ®åˆ°ä¸»èŠ‚ç‚¹</span>
        master.set(<span class="hljs-string">"key1"</span>, <span class="hljs-string">"Hello from Master"</span>);
        System.out.println(<span class="hljs-string">"Write to master: key1=Hello from Master"</span>);

        <span class="hljs-comment">// ä»ä»èŠ‚ç‚¹è¯»å–æ•°æ®</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> slave.get(<span class="hljs-string">"key1"</span>);
        System.out.println(<span class="hljs-string">"Read from slave: key1="</span> + value);

        <span class="hljs-comment">// å…³é—­è¿æ¥</span>
        master.close();
        slave.close();
    }
}
</code></pre>
<ul>
<li><strong>è¿è¡Œç»“æœ</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-ini" lang="ini">Write to master: <span class="hljs-attr">key1</span>=Hello from Master
Read from slave: <span class="hljs-attr">key1</span>=Hello from Master
</code></pre>
<h6 data-id="heading-16">ï¼ˆ2ï¼‰æ³¨æ„äº‹é¡¹</h6>
<ul>
<li><strong>è´Ÿè½½å‡è¡¡</strong>ï¼šå¤šä¸ªä»èŠ‚ç‚¹æ—¶ï¼Œå¯ç”¨è½®è¯¢æˆ–éšæœºç­–ç•¥åˆ†é…è¯»è¯·æ±‚ã€‚</li>
<li><strong>ä¸€è‡´æ€§</strong>ï¼šå¼‚æ­¥å¤åˆ¶å¯èƒ½å¯¼è‡´ä»èŠ‚ç‚¹æ•°æ®ç¨æœ‰å»¶è¿Ÿï¼Œéœ€æ ¹æ®ä¸šåŠ¡åœºæ™¯æƒè¡¡ã€‚</li>
</ul>
<h5 data-id="heading-17">3. é«˜å¯ç”¨æ¶æ„è®¾è®¡</h5>
<p>ä¸»ä»å¤åˆ¶è™½å¥½ï¼Œä½†ä¸»èŠ‚ç‚¹å®•æœºæ€ä¹ˆåŠï¼Ÿç­”æ¡ˆæ˜¯ç»“åˆRedis Sentinelå®ç°è‡ªåŠ¨æ•…éšœè½¬ç§»ã€‚</p>
<h6 data-id="heading-18">ï¼ˆ1ï¼‰Sentinelé…ç½®ä¸éƒ¨ç½²</h6>
<ul>
<li><strong>æ­¥éª¤</strong>ï¼š
<ol>
<li>åˆ›å»º<code>sentinel.conf</code>æ–‡ä»¶ã€‚</li>
<li>é…ç½®ç›‘æ§çš„ä¸»èŠ‚ç‚¹ã€‚</li>
<li>å¯åŠ¨Sentinelå®ä¾‹ã€‚</li>
</ol>
</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># sentinel.conf ç¤ºä¾‹</span>
port 26379
daemonize <span class="hljs-built_in">yes</span>
sentinel monitor mymaster 127.0.0.1 6379 2  <span class="hljs-comment"># ç›‘æ§ä¸»èŠ‚ç‚¹ï¼Œ2è¡¨ç¤ºquorumå€¼</span>
sentinel down-after-milliseconds mymaster 5000  <span class="hljs-comment"># 5ç§’æœªå“åº”è§†ä¸ºå®•æœº</span>
sentinel failover-timeout mymaster 180000      <span class="hljs-comment"># æ•…éšœè½¬ç§»è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span>
</code></pre>
<ul>
<li><strong>å¯åŠ¨Sentinel</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">redis-sentinel sentinel.conf
</code></pre>
<h6 data-id="heading-19">ï¼ˆ2ï¼‰ä¸»èŠ‚ç‚¹å®•æœºåˆ‡æ¢æµç¨‹</h6>
<ul>
<li><strong>ç¤ºæ„å›¾</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-scss" lang="scss">åˆå§‹çŠ¶æ€ï¼š<span class="hljs-built_in">Master</span>(<span class="hljs-number">6379</span>) -&gt; <span class="hljs-built_in">Slave</span>(<span class="hljs-number">6380</span>)
          Sentinel ç›‘æ§
å®•æœºåï¼š  <span class="hljs-built_in">Slave</span>(<span class="hljs-number">6380</span>) æå‡ä¸º Master
          Sentinel æ›´æ–°é…ç½®
</code></pre>
<ul>
<li><strong>éªŒè¯</strong>ï¼š
<ol>
<li>æ‰‹åŠ¨åœæ­¢ä¸»èŠ‚ç‚¹ï¼š<code>redis-cli -p 6379 SHUTDOWN</code></li>
<li>æ£€æŸ¥Sentinelæ—¥å¿—æˆ–æ–°ä¸»èŠ‚ç‚¹çŠ¶æ€ï¼š</li>
</ol>
</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">redis-cli -p 6380 INFO REPLICATION
<span class="hljs-comment"># è¾“å‡ºï¼šrole:master</span>
</code></pre>
<h6 data-id="heading-20">ï¼ˆ3ï¼‰å®æˆ˜ç»éªŒ</h6>
<ul>
<li><strong>quorumå€¼</strong>ï¼šè¡¨ç¤ºéœ€è¦å¤šå°‘ä¸ªSentinelåŒæ„æ‰èƒ½æ‰§è¡Œåˆ‡æ¢ï¼Œå»ºè®®è®¾ç½®ä¸ºSentinelå®ä¾‹æ•°çš„ä¸€åŠåŠ 1ã€‚</li>
<li><strong>ç”Ÿäº§å»ºè®®</strong>ï¼šéƒ¨ç½²3ä¸ªSentinelèŠ‚ç‚¹ï¼Œé¿å…å•ç‚¹æ•…éšœã€‚</li>
</ul>
<p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œæˆ‘ä»¬ä¸ä»…æ­å»ºäº†ä¸»ä»ç¯å¢ƒï¼Œè¿˜å®ç°äº†è¯»å†™åˆ†ç¦»å’Œé«˜å¯ç”¨åˆ‡æ¢ã€‚è¿™å°±åƒç»™ç¼“å­˜ç³»ç»Ÿè£…ä¸Šäº†â€œå®‰å…¨å¸¦â€å’Œâ€œå¤‡ç”¨å¼•æ“â€ï¼Œæ—¢æå‡äº†æ€§èƒ½ï¼Œåˆä¿éšœäº†ç¨³å®šæ€§ã€‚ä½†å®æˆ˜ä¸­æ€»ä¼šé‡åˆ°ä¸€äº›æŒ‘æˆ˜ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘å°†åˆ†äº«ä¸€äº›é¡¹ç›®ç»éªŒå’Œè¸©å‘è®°å½•ï¼Œå¸®åŠ©ä½ å°‘èµ°å¼¯è·¯ã€‚</p>
<hr/>
<h4 data-id="heading-21">å››ã€é¡¹ç›®ç»éªŒåˆ†äº«ï¼šæœ€ä½³å®è·µä¸è¸©å‘è®°å½•</h4>
<p>ç†è®ºå’ŒåŸºç¡€é…ç½®åªæ˜¯èµ·ç‚¹ï¼ŒçœŸæ­£è®©ä¸»ä»å¤åˆ¶å‘æŒ¥ä½œç”¨ï¼Œè¿˜éœ€è¦åœ¨å®æˆ˜ä¸­ä¸æ–­æ‰“ç£¨ã€‚å°±åƒå¼€è½¦ä¸€æ ·ï¼Œæ‡‚å¾—è¸©æ²¹é—¨å’Œåˆ¹è½¦åªæ˜¯åŸºæœ¬åŠŸï¼Œå¦‚ä½•åº”å¯¹å¤æ‚è·¯å†µæ‰æ˜¯è€ƒéªŒæŠ€æœ¯çš„æ—¶å€™ã€‚æœ¬èŠ‚å°†åŸºäºæˆ‘10å¹´Rediså¼€å‘ç»éªŒï¼Œæç‚¼å‡ºä¸€äº›æœ€ä½³å®è·µï¼Œå¹¶åˆ†äº«è¸©è¿‡çš„å‘ä»¥åŠè§£å†³åŠæ³•ï¼Œæœ€åé€šè¿‡ä¸€ä¸ªçœŸå®æ¡ˆä¾‹å±•ç¤ºæ•ˆæœã€‚</p>
<h5 data-id="heading-22">1. æœ€ä½³å®è·µ</h5>
<h6 data-id="heading-23">ï¼ˆ1ï¼‰ä¸»ä»å»¶è¿Ÿä¼˜åŒ–</h6>
<p>ä¸»ä»å¤åˆ¶æ˜¯å¼‚æ­¥çš„ï¼Œå»¶è¿Ÿä¸å¯é¿å…ï¼Œä½†å¯ä»¥é€šè¿‡é…ç½®å’Œç½‘ç»œä¼˜åŒ–å‡å°‘å½±å“ã€‚</p>
<ul>
<li><strong>è°ƒæ•´å¤åˆ¶ç¼“å†²åŒºå¤§å°</strong>ï¼š
<ul>
<li>å‚æ•°ï¼š<code>repl-backlog-size</code>ï¼Œé»˜è®¤1MBã€‚é«˜å¹¶å‘å†™æ—¶è‹¥ç¼“å†²åŒºå¤ªå°ï¼Œå¯èƒ½å¯¼è‡´å…¨é‡åŒæ­¥ã€‚</li>
<li>å»ºè®®ï¼šæ ¹æ®å†™æµé‡è®¾ç½®ä¸ºå†…å­˜çš„10%-20%ï¼Œå¦‚<code>repl-backlog-size 128mb</code>ã€‚</li>
</ul>
</li>
<li><strong>ç½‘ç»œä¼˜åŒ–</strong>ï¼šç¡®ä¿ä¸»ä»èŠ‚ç‚¹é—´ç½‘ç»œå¸¦å®½å……è¶³ï¼Œé¿å…è·¨åœ°åŸŸéƒ¨ç½²ã€‚</li>
</ul>
<h6 data-id="heading-24">ï¼ˆ2ï¼‰è´Ÿè½½å‡è¡¡</h6>
<p>å¤šä¸ªä»èŠ‚ç‚¹å¦‚ä½•é«˜æ•ˆåˆ©ç”¨ï¼Ÿå¯ä»¥ç»“åˆå®¢æˆ·ç«¯åˆ†ç‰‡æˆ–ä»£ç†æå‡è¯»æ€§èƒ½ã€‚</p>
<ul>
<li><strong>å·¥å…·æ¨è</strong>ï¼šTwemproxyæˆ–Redis Clusterçš„å®¢æˆ·ç«¯åˆ†ç‰‡ã€‚</li>
<li><strong>ç»éªŒ</strong>ï¼šåœ¨è¯»å¤šå†™å°‘åœºæ™¯ä¸‹ï¼Œ3-5ä¸ªä»èŠ‚ç‚¹èƒ½æ˜¾è‘—æå‡QPSã€‚</li>
</ul>
<h6 data-id="heading-25">ï¼ˆ3ï¼‰ç›‘æ§ä¸æŠ¥è­¦</h6>
<p>å®æ—¶æŒæ¡ä¸»ä»çŠ¶æ€æ˜¯ç¨³å®šæ€§å…³é”®ã€‚</p>
<ul>
<li><strong>å‘½ä»¤</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">redis-cli -p 6379 INFO REPLICATION
</code></pre>
<ul>
<li><strong>è¾“å‡ºè§£è¯»</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-ini" lang="ini">role:master
connected_slaves:1
slave0:<span class="hljs-attr">ip</span>=<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>,port=<span class="hljs-number">6380</span>,state=<span class="hljs-literal">on</span>line,<span class="hljs-literal">off</span>set=<span class="hljs-number">1024</span>,lag=<span class="hljs-number">1</span>
</code></pre>
<ul>
<li><code>lag</code>ï¼šä»èŠ‚ç‚¹å»¶è¿Ÿï¼ˆç§’ï¼‰ï¼Œè¶…è¿‡5ç§’éœ€æŠ¥è­¦ã€‚</li>
<li><strong>å»ºè®®</strong>ï¼šé›†æˆPrometheus+Grafanaï¼Œç›‘æ§offsetå’Œlagã€‚</li>
</ul>
<h6 data-id="heading-26">ï¼ˆ4ï¼‰å®¹é‡è§„åˆ’</h6>
<p>ä¸»ä»èŠ‚ç‚¹çš„ç¡¬ä»¶é…ç½®éœ€ä¸æ•°æ®è§„æ¨¡åŒ¹é…ã€‚</p>
<ul>
<li><strong>ç»éªŒå…¬å¼</strong>ï¼šä»èŠ‚ç‚¹å†…å­˜â‰¥ä¸»èŠ‚ç‚¹æ•°æ®é‡ï¼Œä¸»èŠ‚ç‚¹CPUæ ¸å¿ƒæ•°â‰¥å†™å¹¶å‘å³°å€¼/1000ã€‚</li>
</ul>
<h5 data-id="heading-27">2. è¸©å‘ç»éªŒ</h5>
<h6 data-id="heading-28">ï¼ˆ1ï¼‰å…¨é‡åŒæ­¥é£æš´</h6>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šä¸»èŠ‚ç‚¹é«˜å¹¶å‘ä¸‹é¢‘ç¹ç”ŸæˆRDBå¿«ç…§ï¼Œå¯¼è‡´CPUå’ŒIOå‹åŠ›é£™å‡ï¼ŒæœåŠ¡æŠ–åŠ¨ã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šä»èŠ‚ç‚¹å› ç½‘ç»œä¸­æ–­é‡è¿ï¼Œè§¦å‘å…¨é‡åŒæ­¥ã€‚</li>
<li><strong>è§£å†³</strong>ï¼š
<ol>
<li>å¢åŠ <code>repl-backlog-size</code>ï¼Œå‡å°‘å…¨é‡åŒæ­¥æ¦‚ç‡ã€‚</li>
<li>ä¼˜åŒ–RDBè§¦å‘æ—¶æœºï¼Œä½¿ç”¨<code>save ""</code>ç¦ç”¨æ‰‹åŠ¨å¿«ç…§ï¼Œä¾é <code>bgsave</code>ã€‚</li>
</ol>
</li>
<li><strong>æ•ˆæœ</strong>ï¼šå…¨é‡åŒæ­¥é¢‘ç‡é™ä½80%ã€‚</li>
</ul>
<h6 data-id="heading-29">ï¼ˆ2ï¼‰ä¸»ä»æ•°æ®ä¸ä¸€è‡´</h6>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šç½‘ç»œæŠ–åŠ¨æˆ–ä»èŠ‚ç‚¹å¤„ç†èƒ½åŠ›ä¸è¶³ï¼Œå¯¼è‡´æ•°æ®æœªåŠæ—¶åŒæ­¥ã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šç”µå•†åº“å­˜æ˜¾ç¤ºå¼‚å¸¸ï¼Œç”¨æˆ·è¯»åˆ°æ—§æ•°æ®ã€‚</li>
<li><strong>è§£å†³</strong>ï¼š
<ol>
<li>æé«˜å¿ƒè·³é¢‘ç‡ï¼š<code>repl-ping-replica-period 1</code>ï¼ˆé»˜è®¤10ç§’ï¼‰ã€‚</li>
<li>è®¾ç½®åˆç†è¶…æ—¶ï¼š<code>repl-timeout 60</code>ã€‚</li>
</ol>
</li>
<li><strong>å»ºè®®</strong>ï¼šå…³é”®ä¸šåŠ¡åŠ ä¸€è‡´æ€§æ ¡éªŒï¼ˆå¦‚ç‰ˆæœ¬å·ï¼‰ã€‚</li>
</ul>
<h6 data-id="heading-30">ï¼ˆ3ï¼‰Sentinelè¯¯åˆ¤</h6>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šç½‘ç»œé—ªæ–­å¯¼è‡´Sentinelè¯¯è®¤ä¸ºä¸»èŠ‚ç‚¹å®•æœºï¼Œé¢‘ç¹åˆ‡æ¢ã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šçŸ­æš‚ä¸¢åŒ…è§¦å‘ä¸å¿…è¦çš„ä¸»ä»åˆ‡æ¢ã€‚</li>
<li><strong>è§£å†³</strong>ï¼š
<ol>
<li>è°ƒæ•´<code>down-after-milliseconds</code>ä¸º10000ï¼ˆ10ç§’ï¼‰ã€‚</li>
<li>å¢åŠ quorumå€¼ï¼Œå¦‚3ä¸ªSentinelè®¾ä¸º2ã€‚</li>
</ol>
</li>
<li><strong>æ•ˆæœ</strong>ï¼šè¯¯åˆ¤ç‡é™ä½è‡³è¿‘é›¶ã€‚</li>
</ul>
<h5 data-id="heading-31">3. çœŸå®æ¡ˆä¾‹</h5>
<h6 data-id="heading-32">é¡¹ç›®åœºæ™¯ï¼šç”µå•†ç§’æ€ç³»ç»Ÿçš„é«˜å¯ç”¨ç¼“å­˜è®¾è®¡</h6>
<ul>
<li><strong>èƒŒæ™¯</strong>ï¼šæŸç”µå•†å¹³å°ç§’æ€æ´»åŠ¨ï¼Œéœ€æ”¯æ’‘10ä¸‡QPSè¯»è¯·æ±‚ï¼Œ1ä¸‡QPSå†™è¯·æ±‚ã€‚</li>
<li><strong>æ¶æ„</strong>ï¼š
<ul>
<li><strong>1ä¸»2ä» + Sentinel</strong>ï¼š
<ul>
<li>ä¸»èŠ‚ç‚¹ï¼š16æ ¸32Gï¼Œå­˜å‚¨åº“å­˜æ•°æ®ã€‚</li>
<li>ä»èŠ‚ç‚¹ï¼š8æ ¸16Gï¼Œå¤„ç†è¯»è¯·æ±‚ã€‚</li>
<li>Sentinelï¼š3èŠ‚ç‚¹éƒ¨ç½²ï¼Œä¿éšœåˆ‡æ¢ã€‚</li>
</ul>
</li>
<li><strong>è¯»å†™åˆ†ç¦»</strong>ï¼šå®¢æˆ·ç«¯ç”¨Jedisè½®è¯¢2ä¸ªä»èŠ‚ç‚¹ã€‚</li>
</ul>
</li>
<li><strong>ä¼˜åŒ–</strong>ï¼š
<ul>
<li><code>repl-backlog-size 256mb</code>ï¼Œåº”å¯¹é«˜å¹¶å‘å†™ã€‚</li>
<li>ç½‘ç»œä¸“çº¿è¿æ¥ä¸»ä»ï¼Œå»¶è¿Ÿ&lt;1msã€‚</li>
</ul>
</li>
<li><strong>æ•ˆæœ</strong>ï¼š
<ul>
<li>QPSæå‡50%ï¼ˆä»6ä¸‡åˆ°9ä¸‡ï¼‰ã€‚</li>
<li>ä¸»èŠ‚ç‚¹å®•æœºåï¼ŒSentinelåˆ‡æ¢æ—¶é—´&lt;5ç§’ï¼Œä¸šåŠ¡æ— æ„ŸçŸ¥ã€‚</li>
</ul>
</li>
</ul>
<h6 data-id="heading-33">ç»éªŒæ€»ç»“</h6>
<p>è¿™ä¸ªæ¡ˆä¾‹è®©æˆ‘æ·±åˆ»ä½“ä¼šåˆ°ï¼Œä¸»ä»å¤åˆ¶çš„é«˜å¯ç”¨ä¸ä»…é é…ç½®ï¼Œæ›´éœ€è¦ç›‘æ§å’Œä¼˜åŒ–ã€‚æå‰è§„åˆ’å®¹é‡ã€åˆç†è®¾ç½®å‚æ•°ï¼Œæ‰èƒ½è®©æ¶æ„åœ¨å‹åŠ›ä¸‹ç¨³å¦‚æ³°å±±ã€‚</p>
<p>ä»æœ€ä½³å®è·µåˆ°è¸©å‘è®°å½•ï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸»ä»å¤åˆ¶æ—¢å¼ºå¤§åˆéœ€è¦ç»†å¿ƒè°ƒæ ¡ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ¢è®¨ä¸€äº›è¿›é˜¶åº”ç”¨åœºæ™¯å’Œæœªæ¥è¶‹åŠ¿ï¼Œçœ‹çœ‹å¦‚ä½•è®©å®ƒåœ¨æ›´å¹¿é˜”çš„èˆå°ä¸Šå‘å…‰å‘çƒ­ã€‚</p>
<hr/>
<h4 data-id="heading-34">äº”ã€è¿›é˜¶åº”ç”¨åœºæ™¯ä¸æ‰©å±•</h4>
<p>ä¸»ä»å¤åˆ¶ä¸ä»…æ˜¯ä¸€ä¸ªé«˜å¯ç”¨å·¥å…·ï¼Œå®ƒè¿˜èƒ½åœ¨ç‰¹å®šåœºæ™¯ä¸‹å‘æŒ¥ç‹¬ç‰¹ä½œç”¨ï¼Œå°±åƒä¸€æŠŠç‘å£«å†›åˆ€ï¼ŒåŠŸèƒ½è¿œè¶…ä½ çš„æƒ³è±¡ã€‚æŒæ¡äº†åŸºç¡€å®æˆ˜åï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥æŒ–æ˜å®ƒçš„æ½œåŠ›ï¼ŒåŒæ—¶å¯¹æ¯”å…¶ä»–æ–¹æ¡ˆï¼Œå±•æœ›æœªæ¥è¶‹åŠ¿ã€‚æœ¬èŠ‚å°†å¸¦ä½ èµ°è¿›ä¸»ä»å¤åˆ¶çš„è¿›é˜¶ä¸–ç•Œï¼Œçœ‹çœ‹å®ƒå¦‚ä½•åœ¨æ›´å¤æ‚çš„ä¸šåŠ¡åœºæ™¯ä¸­å¤§æ˜¾èº«æ‰‹ã€‚</p>
<h5 data-id="heading-35">1. ä¸»ä»å¤åˆ¶çš„ç‰¹è‰²åŠŸèƒ½åº”ç”¨</h5>
<h6 data-id="heading-36">ï¼ˆ1ï¼‰ä»èŠ‚ç‚¹åªè¯»ç‰¹æ€§åœ¨æ•°æ®åˆ†æä¸­çš„å¦™ç”¨</h6>
<p>ä»èŠ‚ç‚¹çš„åªè¯»å±æ€§ä¸ä»…é€‚åˆè¯»å†™åˆ†ç¦»ï¼Œè¿˜èƒ½ä½œä¸ºæ•°æ®åˆ†æçš„â€œå‰¯æœ¬â€ã€‚</p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼šå®æ—¶ç»Ÿè®¡ç”¨æˆ·è¡Œä¸ºæ—¥å¿—ã€‚</li>
<li><strong>å®ç°</strong>ï¼šå°†æ—¥å¿—å†™å…¥ä¸»èŠ‚ç‚¹ï¼Œä»èŠ‚ç‚¹è¿è¡ŒLuaè„šæœ¬æˆ–å®¢æˆ·ç«¯ç¨‹åºåˆ†ææ•°æ®ï¼Œä¸å½±å“ä¸»èŠ‚ç‚¹æ€§èƒ½ã€‚</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šæ— éœ€é¢å¤–ETLå·¥å…·ï¼Œç®€å•é«˜æ•ˆã€‚</li>
<li><strong>ç»éªŒ</strong>ï¼šæˆ‘åœ¨ä¸€ä¸ªå¹¿å‘Šç³»ç»Ÿé¡¹ç›®ä¸­ç”¨ä»èŠ‚ç‚¹ç»Ÿè®¡ç‚¹å‡»ç‡ï¼ŒèŠ‚çœäº†30%çš„è®¡ç®—èµ„æºã€‚</li>
</ul>
<h6 data-id="heading-37">ï¼ˆ2ï¼‰ä¸»ä»ç»“åˆRedis Clusteræ‰©å±•è§„æ¨¡</h6>
<p>å½“æ•°æ®é‡æˆ–å¹¶å‘è¶…è¿‡å•ä¸»å¤šä»çš„æ‰¿è½½èƒ½åŠ›æ—¶ï¼Œå¯ä»¥ç»“åˆRedis Clusterã€‚</p>
<ul>
<li><strong>æ¶æ„ç¤ºæ„å›¾</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">ä¸»ä»ç»„1: Master1 -&gt; Slave1, Slave2</span>
<span class="hljs-section">ä¸»ä»ç»„2: Master2 -&gt; Slave3, Slave4</span>
Redis Clusterç®¡ç†å¤šä¸ªä¸»ä»ç»„
</code></pre>
<ul>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šPBçº§æ•°æ®æˆ–ç™¾ä¸‡QPSçš„è¶…å¤§è§„æ¨¡åº”ç”¨ã€‚</li>
<li><strong>æ³¨æ„</strong>ï¼šClusterå¢åŠ äº†å¤æ‚åº¦ï¼Œé€‚åˆå›¢é˜Ÿæœ‰è¿ç»´èƒ½åŠ›çš„åœºæ™¯ã€‚</li>
</ul>
<h5 data-id="heading-38">2. ä¸å…¶ä»–é«˜å¯ç”¨æ–¹æ¡ˆå¯¹æ¯”</h5>
<p>ä¸»ä»å¤åˆ¶å¹¶éå”¯ä¸€é€‰æ‹©ï¼Œäº†è§£å®ƒçš„â€œå¯¹æ‰‹â€èƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°å†³ç­–ã€‚</p>
<h6 data-id="heading-39">ï¼ˆ1ï¼‰ä¸»ä»å¤åˆ¶ vs Redis Cluster</h6>
<ul>
<li><strong>å¯¹æ¯”è¡¨æ ¼</strong>ï¼š






























<table><thead><tr><th>ç‰¹æ€§</th><th>ä¸»ä»å¤åˆ¶</th><th>Redis Cluster</th></tr></thead><tbody><tr><td><strong>æ¶æ„å¤æ‚åº¦</strong></td><td>ç®€å•ï¼Œå•ä¸»å¤šä»</td><td>å¤æ‚ï¼Œå¤šä¸»åˆ†ç‰‡</td></tr><tr><td><strong>æ•°æ®è§„æ¨¡</strong></td><td>ä¸­ç­‰ï¼ˆGB-TBï¼‰</td><td>å¤§è§„æ¨¡ï¼ˆTB-PBï¼‰</td></tr><tr><td><strong>å†™æ€§èƒ½</strong></td><td>ä¸»èŠ‚ç‚¹ç“¶é¢ˆ</td><td>å¤šä¸»å¹¶è¡Œå†™</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>è¯»å¤šå†™å°‘</td><td>è¯»å†™å‡è¡¡ã€å¤§æ•°æ®</td></tr></tbody></table>
</li>
<li><strong>é€‰æ‹©å»ºè®®</strong>ï¼šä¸­å°å‹é¡¹ç›®ç”¨ä¸»ä»å¤åˆ¶ï¼Œå¿«é€Ÿä¸Šæ‰‹ï¼›è¶…å¤§è§„æ¨¡åœºæ™¯é€‰Clusterã€‚</li>
</ul>
<h6 data-id="heading-40">ï¼ˆ2ï¼‰ä¸»ä»å¤åˆ¶ vs è‡ªå®šä¹‰åˆ†å¸ƒå¼æ–¹æ¡ˆ</h6>
<ul>
<li><strong>å¯¹æ¯”</strong>ï¼š
<ul>
<li><strong>ä¸»ä»å¤åˆ¶</strong>ï¼šRedisåŸç”Ÿæ”¯æŒï¼Œç»´æŠ¤æˆæœ¬ä½ï¼Œä½†çµæ´»æ€§æœ‰é™ã€‚</li>
<li><strong>è‡ªå®šä¹‰æ–¹æ¡ˆ</strong>ï¼šå¦‚åŸºäºZookeeper+åˆ†ç‰‡ï¼Œçµæ´»æ€§é«˜ï¼Œä½†å¼€å‘å’Œè¿ç»´æˆæœ¬é«˜ã€‚</li>
</ul>
</li>
<li><strong>ç»éªŒ</strong>ï¼šé™¤éæœ‰ç‰¹æ®Šéœ€æ±‚ï¼ˆå¦‚å¼ºä¸€è‡´æ€§ï¼‰ï¼Œä¸»ä»å¤åˆ¶é€šå¸¸æ˜¯æ€§ä»·æ¯”æœ€é«˜çš„é€‰æ‹©ã€‚</li>
</ul>
<h5 data-id="heading-41">3. æœªæ¥å±•æœ›</h5>
<p>Redisçš„æ¼”è¿›ä¸€ç›´åœ¨åŠ é€Ÿï¼Œä¸»ä»å¤åˆ¶ä¹Ÿåœ¨ä¸æ–­ä¼˜åŒ–ã€‚</p>
<ul>
<li><strong>Redis 7.0+æ–°ç‰¹æ€§</strong>ï¼š
<ul>
<li><strong>å¤šçº¿ç¨‹IO</strong>ï¼šæå‡ä¸»ä»åŒæ­¥æ•ˆç‡ï¼Œå°¤å…¶åœ¨é«˜å¹¶å‘å†™åœºæ™¯ä¸‹ã€‚</li>
<li><strong>PSYNCæ”¹è¿›</strong>ï¼šæ›´æ™ºèƒ½çš„å¢é‡åŒæ­¥ï¼Œå‡å°‘å…¨é‡åŒæ­¥å¼€é”€ã€‚</li>
</ul>
</li>
<li><strong>è¶‹åŠ¿åˆ¤æ–­</strong>ï¼š
<ul>
<li>äº‘åŸç”Ÿæ”¯æŒå¢å¼ºï¼šä¸»ä»å¤åˆ¶å°†æ›´é€‚é…K8sç­‰å®¹å™¨åŒ–ç¯å¢ƒã€‚</li>
<li>AIé©±åŠ¨ä¼˜åŒ–ï¼šæœªæ¥å¯èƒ½é€šè¿‡æœºå™¨å­¦ä¹ åŠ¨æ€è°ƒæ•´å¤åˆ¶å‚æ•°ã€‚</li>
</ul>
</li>
<li><strong>ä¸ªäººå¿ƒå¾—</strong>ï¼šRedisçš„ç®€å•å“²å­¦ä¸ä¼šå˜ï¼Œä¸»ä»å¤åˆ¶ä»å°†æ˜¯é«˜å¯ç”¨æ ¸å¿ƒï¼Œä½†ä¼šæ›´æ™ºèƒ½ã€æ›´é«˜æ•ˆã€‚</li>
</ul>
<p>ä¸»ä»å¤åˆ¶çš„åº”ç”¨åœºæ™¯å’Œæœªæ¥æ½œåŠ›è¿œä¸æ­¢äºæ­¤ï¼Œå®ƒå°±åƒä¸€æ£µèŒå£®æˆé•¿çš„æ ‘ï¼Œä¸æ–­å¼€ææ•£å¶ã€‚ä¸‹ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†å›é¡¾å…¨æ–‡ï¼Œæ€»ç»“å®è·µå»ºè®®ï¼Œä¸ºä½ çš„Redisä¹‹æ—…ç”»ä¸Šåœ†æ»¡å¥å·ã€‚</p>
<hr/>
<h4 data-id="heading-42">å…­ã€æ€»ç»“</h4>
<p>ç»è¿‡ä»åŸç†åˆ°å®æˆ˜çš„å…¨é¢æ¢ç´¢ï¼Œæˆ‘ä»¬å·²ç»èµ°å®Œäº†Redisä¸»ä»å¤åˆ¶çš„æ—…ç¨‹ã€‚å°±åƒæ­å»ºä¸€åº§æˆ¿å­ï¼Œæˆ‘ä»¬å…ˆæ‰“å¥½äº†åœ°åŸºï¼ˆåŸç†ï¼‰ï¼Œç„¶åæ­èµ·äº†æ¡†æ¶ï¼ˆå®æˆ˜ï¼‰ï¼Œæœ€åç”¨ç»éªŒå’Œä¼˜åŒ–è®©å®ƒæ›´åšå›ºã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹æ ¸å¿ƒå†…å®¹ï¼Œå¹¶ä¸ºä½ çš„ä¸‹ä¸€æ­¥å®è·µæä¾›ä¸€äº›å»ºè®®ã€‚</p>
<h5 data-id="heading-43">1. æ ¸å¿ƒå†…å®¹å›é¡¾</h5>
<ul>
<li><strong>ä¸»ä»å¤åˆ¶åŸç†</strong>ï¼šé€šè¿‡å…¨é‡åŒæ­¥ï¼ˆRDBå¿«ç…§ï¼‰å’Œå¢é‡åŒæ­¥ï¼ˆAOFæ—¥å¿—+å¤åˆ¶ç¼“å†²åŒºï¼‰ï¼Œä¸»èŠ‚ç‚¹å°†æ•°æ®é«˜æ•ˆä¼ æ’­ç»™ä»èŠ‚ç‚¹ã€‚å¿ƒè·³æ£€æµ‹å’ŒPSYNCå‘½ä»¤åˆ™æ˜¯ä¿éšœåŒæ­¥ç¨³å®šçš„â€œå¹•åè‹±é›„â€ã€‚</li>
<li><strong>å®æˆ˜è¦ç‚¹</strong>ï¼šä»åŸºç¡€é…ç½®åˆ°è¯»å†™åˆ†ç¦»ï¼Œå†åˆ°ç»“åˆSentinelå®ç°é«˜å¯ç”¨ï¼Œæˆ‘ä»¬ä¸€æ­¥æ­¥æ„å»ºäº†ä¸€ä¸ªå¥å£®çš„ç¼“å­˜æ¶æ„ã€‚ä»£ç å’Œé…ç½®ç¤ºä¾‹è®©ç†è®ºè½åœ°ï¼Œè§¦æ‰‹å¯åŠã€‚</li>
<li><strong>é¡¹ç›®ç»éªŒ</strong>ï¼šä¼˜åŒ–ä¸»ä»å»¶è¿Ÿã€åº”å¯¹å…¨é‡åŒæ­¥é£æš´ã€è§£å†³Sentinelè¯¯åˆ¤ï¼Œè¿™äº›å®æˆ˜ç»éªŒä¸ä»…æå‡äº†æ€§èƒ½ï¼Œä¹Ÿè®©æˆ‘ä»¬å°‘èµ°å¼¯è·¯ã€‚</li>
</ul>
<h5 data-id="heading-44">2. ç»™è¯»è€…çš„å»ºè®®</h5>
<p>å¦‚æœä½ æ­£å‡†å¤‡å°†ä¸»ä»å¤åˆ¶åº”ç”¨åˆ°è‡ªå·±çš„é¡¹ç›®ä¸­ï¼Œè¿™é‡Œæœ‰å‡ æ¡å»ºè®®ï¼š</p>
<ul>
<li><strong>ä»å°è§„æ¨¡å®éªŒå¼€å§‹</strong>ï¼šå…ˆåœ¨æœ¬åœ°æˆ–æµ‹è¯•ç¯å¢ƒæ­å»º1ä¸»1ä»ï¼Œç†Ÿæ‚‰é…ç½®å’Œç›‘æ§ï¼Œå†é€æ­¥æ‰©å±•åˆ°ç”Ÿäº§ã€‚</li>
<li><strong>å…³æ³¨ç›‘æ§ä¸å¼‚å¸¸å¤„ç†</strong>ï¼šç”¨<code>INFO REPLICATION</code>å®æ—¶æ£€æŸ¥çŠ¶æ€ï¼Œè®¾ç½®æŠ¥è­¦æœºåˆ¶ï¼Œç¡®ä¿ç¬¬ä¸€æ—¶é—´å‘ç°é—®é¢˜ã€‚</li>
<li><strong>æ ¹æ®ä¸šåŠ¡åœºæ™¯è°ƒæ•´</strong>ï¼šè¯»å¤šå†™å°‘ç”¨å¤šä»èŠ‚ç‚¹ï¼Œé«˜ä¸€è‡´æ€§éœ€æ±‚åˆ™åŠ æ ¡éªŒæœºåˆ¶ï¼Œä¸»ä»å¤åˆ¶å¾ˆçµæ´»ï¼Œå…³é”®æ˜¯æ‰¾åˆ°é€‚åˆä½ çš„å¹³è¡¡ç‚¹ã€‚</li>
</ul>
<h5 data-id="heading-45">3. ç»“æŸè¯­</h5>
<p>Redisä¸»ä»å¤åˆ¶çœ‹ä¼¼ç®€å•ï¼Œå´è•´å«ç€æ„å»ºé«˜å¯ç”¨ç¼“å­˜æ¶æ„çš„æ— é™å¯èƒ½ã€‚å®ƒå°±åƒä¸€é¢—ç§å­ï¼Œåªè¦ä½ ç”¨å¿ƒæµ‡çŒï¼Œå°±èƒ½åœ¨ä½ çš„ç³»ç»Ÿä¸­å¼€èŠ±ç»“æœã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½æˆä¸ºä½ æ¢ç´¢Redisä¸–ç•Œçš„èµ·ç‚¹ï¼Œæ— è®ºæ˜¯å¯¹æŠ€æœ¯çš„é’»ç ”ï¼Œè¿˜æ˜¯å¯¹æ¶æ„è®¾è®¡çš„ä¿¡å¿ƒï¼ŒæŒæ¡ä¸»ä»å¤åˆ¶éƒ½å°†ä¸ºä½ çš„èŒä¸šæ—…ç¨‹åŠ åˆ†ã€‚åŠ¨æ‰‹è¯•è¯•å§ï¼Œé«˜å¯ç”¨çš„ç¼“å­˜æ¶æ„å°±åœ¨ä½ çš„æŒ‡å°–ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚æœè®©æˆ‘ç«™åœ¨ç§‘æŠ€ä»ä¸šè€…çš„è§’åº¦å»å›çœ‹ 2025 å¹´ï¼Œè®©æˆ‘é€‰ä¸€ä¸ªè¯å‡ºæ¥å½¢å®¹å®ƒï¼Œæˆ‘ä¼šé€‰æ‹©â€œvibe codingâ€è¿™ä¸ªè¯ã€‚]]></title>    <link>https://juejin.cn/post/7587997157237915700</link>    <guid>https://juejin.cn/post/7587997157237915700</guid>    <pubDate>2025-12-27T06:10:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587997157237915700" data-draft-id="7587997157237899316" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚æœè®©æˆ‘ç«™åœ¨ç§‘æŠ€ä»ä¸šè€…çš„è§’åº¦å»å›çœ‹ 2025 å¹´ï¼Œè®©æˆ‘é€‰ä¸€ä¸ªè¯å‡ºæ¥å½¢å®¹å®ƒï¼Œæˆ‘ä¼šé€‰æ‹©â€œvibe codingâ€è¿™ä¸ªè¯ã€‚"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-27T06:10:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="whyæŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/3702810893364350"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚æœè®©æˆ‘ç«™åœ¨ç§‘æŠ€ä»ä¸šè€…çš„è§’åº¦å»å›çœ‹ 2025 å¹´ï¼Œè®©æˆ‘é€‰ä¸€ä¸ªè¯å‡ºæ¥å½¢å®¹å®ƒï¼Œæˆ‘ä¼šé€‰æ‹©â€œvibe codingâ€è¿™ä¸ªè¯ã€‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3702810893364350/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    whyæŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T06:10:09.000Z" title="Sat Dec 27 2025 06:10:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¦‚æœè®©æˆ‘ç«™åœ¨ç§‘æŠ€ä»ä¸šè€…çš„è§’åº¦å»å›çœ‹ 2025 å¹´ï¼Œè®©æˆ‘é€‰ä¸€ä¸ªè¯å‡ºæ¥å½¢å®¹å®ƒï¼Œæˆ‘ä¼šé€‰æ‹©â€œvibe codingâ€è¿™ä¸ªè¯ã€‚</p>
<p>ChatGPT ä½œä¸º AI çš„ç¬¬ä¸€æ³¢æµªæ½®æ¥ä¸´çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä½œä¸ºç§‘æŠ€ä»ä¸šè€…ï¼Œéƒ½æ¸…æ¥šçš„çŸ¥é“è¿™æ³¢æµªæ½®ä¼šå†²å‡»åˆ°æˆ‘ä»¬ä¸­çš„å¤§å¤šæ•°ã€‚</p>
<p>å¯¹æˆ‘æ¥è¯´ï¼Œåœ¨ 2025 å¹´ï¼Œè¿™æ³¢æµªæ½®çš„åç§°å°±å« vibe codingã€‚å…¶å®ä½ ä»”ç»†æƒ³æƒ³ï¼ŒAI å†™å‡ºçš„ä»£ç èƒ½ç”¨ï¼Œè¿™ä»¶äº‹çˆ†å‘æ€§çš„å‘å±•ï¼Œä¹Ÿå°±æ˜¯ä»Šå¹´è¿™ä¸€å¹´å‘ç”Ÿçš„äº‹å„¿ï¼Œç”šè‡³æ˜¯ä¸‹åŠå¹´çš„äº‹æƒ…ã€‚å„ç§å„æ ·çš„ AI ç¼–ç å·¥å…·å¦‚é›¨åæ˜¥ç¬‹èˆ¬çš„å†’å‡ºæ¥å¤´æ¥ï¼Œä¸€ä¸ªæ¯”ä¸€ä¸ªå¥½ç”¨ã€‚</p>
<p>å†²å‡»åˆ°æˆ‘çš„ä¸€ä¸ªå…·ä½“è¡¨ç°ä¹‹ä¸€å°±æ˜¯ä»Šå¹´æˆ‘å†™æ–‡ç« çš„é¢‘ç‡çœŸçš„æ²¡æœ‰å‰å‡ å¹´è¿™ä¹ˆé«˜äº†ã€‚</p>
<p>åŒæ ·çš„ä¸€ä¸ªé—®é¢˜ï¼Œä½ å»é—® AIï¼Œå®ƒåªç”¨å‡ åç§’ï¼Œå°±èƒ½å¾—åˆ°æˆ‘èŠ±äº†å¤§é‡ç²¾åŠ›æ‰å­¦ä¼šï¼Œå¹¶èæ±‡è´¯é€šçš„ä¸œè¥¿ã€‚</p>
<p>ä½ åªéœ€è¦ç”¨è‡ªç„¶è¯­è¨€æŠŠéœ€æ±‚æè¿°æ¸…æ¥šï¼Œå†ç¨åŠ å¼•å¯¼ï¼Œå®ƒå°±èƒ½åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…ç›´æ¥ç»™ä½ ç”Ÿæˆå·¥ç¨‹çº§åˆ«çš„ä»£ç ï¼Œæ°´å¹³èƒ½å’Œä¸€ä¸ªä¸­çº§ç¨‹åºå‘˜å¯¹æ ‡ã€‚</p>
<p>è½»è€Œæ˜“ä¸¾å°±èƒ½è·å¾—æˆ‘å‘•å¿ƒæ²¥è¡€æ‰å­¦ä¼šçš„ä¸œè¥¿ã€‚æ‰€ä»¥æˆ‘æ˜¯çœŸçš„æ„Ÿåˆ°ææƒ§ï¼Œææƒ§åˆ°æˆ‘å¼€å§‹æŠ—æ‹’ã€‚</p>
<p>ä»¥å‰ï¼Œæˆ‘æƒ³èµ·ä¸€ä¸ªæœ‰æ„æ€çš„æŠ€æœ¯è¯é¢˜å°±ä¼šå»ä¸€è¾¹ç ”ç©¶ä¸€è¾¹å†™ï¼Œæœ€åæŠŠå®ƒå†™å‡ºæ¥ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å¾ˆæœ‰æ„æ€çš„ã€‚</p>
<p>ç°åœ¨ï¼Œå½“æˆ‘ç ”ç©¶äº†ä¸€ç‚¹ï¼Œç„¶ååœ¨æŠŠå®ƒå†™å‡ºæ¥çš„ï¼Œæˆ‘å°±ä¼šè§‰å¾—ï¼Œæ²¡æ„æ€ã€‚</p>
<p>å•çº¯å°±æ˜¯è§‰å¾—æ²¡æ„æ€ï¼Œå› ä¸ºæˆ‘å†™çš„è¿™äº›ä¸œè¥¿ï¼Œå»é—® AI éƒ½çŸ¥é“ã€‚</p>
<p>æˆ‘æŠŠå®ƒå†™å‡ºæ¥å¯èƒ½è¦ç”¨ä¸€å‘¨æ—¶é—´ï¼Œä½†æ˜¯å»é—® AIï¼Œå®ƒå‡ åˆ†é’Ÿå°±èƒ½ç»™ä½ ä¸€å¤§æ®µå†…å®¹ï¼Œå¹¶è¯´å¾—å¤´å¤´æ˜¯é“ï¼Œæ¯”æˆ‘åˆ†ææ›´åŠ å…¨é¢ï¼Œæ›´åŠ æœ‰ç»†èŠ‚ï¼Œé‡åˆ°ä¸æ˜ç™½çš„åœ°æ–¹ï¼Œä½ è¿˜å¯ä»¥ä¸æ–­çš„å»è¿½é—®å®ƒã€‚</p>
<p>æˆ‘æ‰¾ä¸åˆ°æˆ‘å†™å‡ºæ¥çš„æ–‡ç« çš„ä»·å€¼åœ¨å“ªé‡Œã€‚</p>
<p>ä»¥å‰ä¼šæœ‰è¯»è€…ç»™æˆ‘åé¦ˆä¸€äº›ä»–ä»¬é‡åˆ°çš„æŠ€æœ¯é—®é¢˜ï¼Œè€Œæˆ‘æ°å¥½åˆæœ‰æ—¶é—´ï¼Œæˆ‘å°±ä¼šç»™è¯»è€…é‡èº«å®šåšä¸€ç¯‡ç­”ç–‘ï¼Œç”šè‡³æ²¡æœ‰æ—¶é—´çš„æ—¶å€™æˆ‘ä¼šå…ˆåŠ å…¥ç´ æåº“ã€‚</p>
<p>ç°åœ¨ï¼Œä¸ºä»€ä¹ˆè¿˜è¦æ¥é—®æˆ‘ï¼Ÿ</p>
<p>å³ä½¿æœ‰äººæ¥é—®æˆ‘ï¼Œæˆ‘éƒ½ä¼šå«ä»–å…ˆå»é—® AIã€‚</p>
<p>åœ¨å½“ä¸‹ AI å·²ç»è¿›åŒ–åˆ°â€œvibe codingâ€é˜¶æ®µäº†ï¼Œæˆ‘ä½œä¸ºä¸€ä¸ªæŠ€æœ¯åšä¸»ï¼Œå†å»å†™ä¸€äº›å¸¸è§„æ€§çš„æŠ€æœ¯ç±»æ–‡ç« çš„æ—¶å€™ï¼Œæˆ‘æ›´åŠ æ‰¾ä¸åˆ°ä»·å€¼åœ¨å“ªé‡Œã€‚æˆ‘ä¹Ÿå°è¯•è¿‡åœ¨æ‰¾ä¸åˆ°ä»·å€¼çš„æ—¶å€™ï¼Œå°±ç¡¬å†™ï¼Œä½†æ˜¯å†™çš„å¿ƒå¢ƒå˜äº†ï¼Œå†™å‡ºæ¥çš„ä¸œè¥¿æˆ‘è‡ªå·±éƒ½è§‰å¾—æ˜¯åƒåœ¾ã€‚</p>
<p>æƒ³æç¬”ï¼Œä½†æ˜¯å››é¡¾èŒ«ç„¶ï¼Œæœ€ç»ˆè½å¾—ä¸€ä¸ªé“å¿ƒç ´ç¢çš„ä¸‹åœºã€‚æ‰€ä»¥ï¼Œæˆ‘ä¹‹å‰æœ‰ä¸€æ®µæ—¶é—´æ˜¯å¹²è„†å°±ä¸å†™äº†ã€‚</p>
<p>åé¢æˆ‘è§‰å¾—æˆ‘è¿˜æ˜¯æƒ³è¦å†™ä¸€ç‚¹ä¸œè¥¿çš„ï¼Œå°±è½¬è€Œé¢å‘äº†ä¸€äº› AI å·¥å…·çš„ä½¿ç”¨ï¼Œæˆ–è€…å›´ç»• AI äº§ç”Ÿçš„ä¸€äº›æ€è€ƒã€‚è™½ç„¶æ²¡æœ‰ä¹‹å‰å†™æŠ€æœ¯æ–‡ç« æ—¶çš„å†²åŠ²äº†ï¼Œä½†æ˜¯è‡³å°‘è¿™æ˜¯æˆ‘çœŸçš„æƒ³è¦å†™çš„ä¸œè¥¿ï¼Œè€Œä¸æ˜¯ç¡¬æ†‹å‡ºæ¥çš„åƒåœ¾ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯æˆ‘æ‹¥æŠ± AI çš„ä¸€ç§æ–¹å¼ã€‚</p>
<p>vibe coding è¿™ä¸€æ³¢æµªæ½®åªæ˜¯å†²å‡»åˆ°äº†æˆ‘ï¼Œä½†è¿˜å†²ä¸å€’æˆ‘ã€‚</p>
<p>çŠ¹è®°å¾— 2022 å¹´æœ« ChatGPT æ¨ªç©ºå‡ºä¸–çš„æ—¶å€™ï¼Œæˆ‘å†™è¿‡ä¸€ç¯‡è¹­çƒ­åº¦çš„æ–‡ç« ï¼Œå½“æ—¶å–æ ‡é¢˜ä¸ºäº†éª—ç‚¹å‡»ç‡ï¼Œå°±æ•…æ„å†™çš„â€œå±è¨€è€¸å¬â€ä¸€ç‚¹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2de3b8e4ce27446d86657c9fa75c2092~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2h55oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420609&amp;x-signature=%2B5JDCXcqprnmnW%2BbE8YdgebuHks%3D" alt="" loading="lazy"/></p>
<p>ç°åœ¨å›å¤´å»çœ‹â€œç«¯å¥½é¥­ç¢—ï¼Œè°¨é˜²AIâ€ä¸€ç‚¹ä¹Ÿä¸ç®—å±è¨€è€¸å¬ï¼Œåè€Œæ˜¯ä¸€ç§â€œé¢„è¨€â€ã€‚</p>
<p>æˆ‘çŸ¥é“ï¼Œä» 2022 å¹´çš„ chatGPT åˆ° 2025 å¹´çš„ vibe codingï¼Œè¿™åªæ˜¯åˆä¸€æ³¢æµªæ½®è€Œå·²ã€‚åé¢ç´§è·Ÿç€è¿˜æœ‰ä¸çŸ¥é“å¤šå°‘æ³¢æ›´çŒ›çš„ã€‚</p>
<p>åé¢çš„ï¼Œä¸çŸ¥é“æˆ‘é¡¶ä¸é¡¶å¾—ä½ã€‚</p>
<p>é¡¶å¾—ä½ï¼Œä¸‡äº‹å¤§å‰ã€‚</p>
<p>é¡¶ä¸ä½ï¼Œæˆ‘ä¹Ÿå·²ç»æƒ³å¥½äº†å€’ä¸‹æ—¶çœ‹èµ·æ¥æ¯”è¾ƒæ‚²å£®çš„å°è¯ï¼š</p>
<p>æˆ‘æ˜¯æ—§æ—¶ä»£çš„æ®‹å…šï¼Œæ–°æ—¶ä»£æ²¡æœ‰èƒ½è½½æˆ‘çš„èˆ¹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[24é¡µ å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å…¥é—¨æŒ‡å—ï¼šä»æ ¸å¿ƒå®šä¹‰ã€è®­ç»ƒä¸‰æ­¥æ³•åˆ° Llama 3.1 å®æ“éƒ¨ç½²]]></title>    <link>https://juejin.cn/post/7588042910195122226</link>    <guid>https://juejin.cn/post/7588042910195122226</guid>    <pubDate>2025-12-27T06:15:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588042910195122226" data-draft-id="7588031908171841545" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="24é¡µ å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å…¥é—¨æŒ‡å—ï¼šä»æ ¸å¿ƒå®šä¹‰ã€è®­ç»ƒä¸‰æ­¥æ³•åˆ° Llama 3.1 å®æ“éƒ¨ç½²"/> <meta itemprop="keywords" content="Agent,LLM,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-27T06:15:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AIå¤§æ¨¡å‹"/> <meta itemprop="url" content="https://juejin.cn/user/3817967696221534"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            24é¡µ å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å…¥é—¨æŒ‡å—ï¼šä»æ ¸å¿ƒå®šä¹‰ã€è®­ç»ƒä¸‰æ­¥æ³•åˆ° Llama 3.1 å®æ“éƒ¨ç½²
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3817967696221534/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AIå¤§æ¨¡å‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T06:15:42.000Z" title="Sat Dec 27 2025 06:15:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>ã€‚</p>
</blockquote>
<p>å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLM)ï¼Œæ˜¯ä¸€ç§èƒ½å¤Ÿç†è§£å¹¶ç”Ÿæˆæˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨çš„è¯­è¨€çš„ AIå·¥å…·ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ é—®ä¸­å›½é¦–éƒ½çš„åå­—æ˜¯ä»€ä¹ˆï¼Ÿå®ƒçš„æ ¸å¿ƒæ˜¯é€šè¿‡å¤§é‡çš„æ–‡æœ¬æ•°æ®æ¥â€œå­¦â€æ‡‚è¯­è¨€è§„åˆ™ï¼Œå¹¶ä¸”èƒ½å¤Ÿé¢„æµ‹æ¥ä¸‹æ¥çš„å•è¯å’Œå¥å­åº”è¯¥æ˜¯ä»€ä¹ˆï¼Œå¦‚â€œä¸­å›½é¦–éƒ½æ˜¯åŒ—äº¬ã€‚â€</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b20b93bb495a498987d8d5d6e426b8dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=IRh51yWFDqi7HISBjSysW7CIUCo%3D" alt="" loading="lazy"/></p>
<p>åœ¨äº†è§£ LLMä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»äº†è§£å…¶â€œå¤§â€ä¹‹å¤„ã€‚ä¸€æ–¹é¢ï¼Œè®­ç»ƒæ•°æ®é‡å¾ˆå¤§ï¼Œä¸»è¦æ˜¯ä½¿ç”¨ Common Crawlç½‘çš„è¿‡æ»¤æ•°æ®ï¼Œä»…æ­¤ä¸€é¡¹å°±å æ®äº†60%çš„è®­ç»ƒæ•°æ®ï¼Œè¾¾åˆ°4100å¤šäº¿æ¬¡ï¼›ç„¶åæ˜¯ Redditè®ºå›çš„WebText2,Books1å’ŒBooks2ä¸¤ä¸ªåœ¨çº¿å›¾ä¹¦æ”¶è—ç½‘ç«™ï¼Œè¿˜æœ‰ç»´åŸºç™¾ç§‘ï¼Œæ‰€æœ‰è¿™äº›åŠ åœ¨ä¸€èµ·çš„æ•°æ®æ˜¯éå¸¸å·¨å¤§çš„ã€‚å¦ä¸€æ–¹é¢ï¼Œæ¨¡å‹çš„å‚æ•°è¾ƒå¤šï¼Œå¦‚GPT-3ï¼Œå‚æ•°æœ€å°ä¸º1250ä¸‡ï¼Œå‚æ•°æœ€å¤§ä¸º1750äº¿ï¼Œå…±96å±‚ï¼›éå®˜æ–¹çš„æ¶ˆæ¯ç§°GPT-4æ›´åŠ å¤¸å¼ ï¼Œå…¶å‚æ•°å¤šåˆ°1.8å…†å­—èŠ‚ï¼Œ120ä¸ªå±‚æ¬¡ï¼Œå¹¶ä¸”å­¦ä¹ äº†13å…†ä¸ªå•è¯ã€‚è€Œä¸”ï¼Œç”±äºæ˜¯åŸºäºè‡ªç„¶è¯­è¨€å¤„ç†çš„æ–¹æ³•ï¼Œæ‰€ä»¥éå¸¸ç¬¦åˆäººçš„è¯­è¨€é€»è¾‘ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a615174bea754c8cb10e28ff5feca007~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=%2B5po7dCKLBAS%2F5YIbBZh022GK6A%3D" alt="" loading="lazy"/></p>
<p>è®­ç»ƒLLMæœ‰3ä¸ªæ­¥éª¤ã€‚ç¬¬ä¸€é˜¶æ®µæ˜¯éç›‘ç£å¼çš„é¢„è®­ç»ƒé˜¶æ®µï¼Œå°†å¤§é‡çš„æ–‡æœ¬è¾“å…¥åˆ°æ¨¡å‹ä¸­ï¼Œå…ˆè¿›è¡Œâ€œæ–‡å­—æ¥é¾™â€çš„ç»ƒä¹ ï¼Œå…¶æ ¸å¿ƒæ˜¯çŒœæµ‹æ¥ä¸‹æ¥çš„å•è¯ï¼›ç¬¬äºŒæ­¥å°±æ˜¯è¿›è¡Œæœ‰ç›‘æ§çš„å¾®è°ƒï¼Œè®­ç»ƒæœºå™¨äººä½¿ç”¨äººå·¥ç¼–å†™çš„ç­”æ¡ˆæ¥å‡†ç¡®åœ°å›ç­”ç”¨æˆ·çš„æé—®ï¼Œå°±åƒä¸€ä¸ªåˆçº§å®¢æˆ·æœåŠ¡äººå‘˜ä¸€æ ·ï¼›ç¬¬ä¸‰æ­¥å°±æ˜¯é€šè¿‡äººçš„åé¦ˆè¿›è¡Œå¼ºåŒ–å­¦ä¹ ï¼ŒæŒ‰ç…§äººä»¬å¯¹æ¨¡å‹çš„å“åº”ç­‰çº§æ¥è®­ç»ƒæ¿€åŠ±æ¨¡å‹ï¼Œæœ€ç»ˆå°†è¯¥æ¨¡å‹å®Œå–„ä¸ºä¸€åä¸“ä¸šçš„å’¨è¯¢å¸ˆã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9d2666afa1b444299b1f4eb376c6650~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=rIFzKcAcDG3DkC7CZ1vVM1oPVDU%3D" alt="" loading="lazy"/></p>
<p>çœŸæ­£ä½¿ç”¨èµ·æ¥ï¼ŒLLMå¯ä»¥å®Œæˆå¾ˆå¤šäº‹æƒ…ã€‚åŸºæœ¬åŠŸèƒ½åŒ…æ‹¬ç¼–å†™å†…å®¹ï¼Œå›ç­”çŸ¥è¯†åº“ä¸­çš„é—®é¢˜ï¼Œå¯¹æ–‡æœ¬è¿›è¡Œåˆ†ç±»ï¼Œå¯¹æ–‡æœ¬è¿›è¡Œæƒ…æ„Ÿåˆ†æï¼Œä»¥åŠè¾…åŠ©æ£€ç´¢ï¼Œä¿è¯ç”µè„‘å®‰å…¨ç­‰ã€‚åœ¨äº§ä¸šä¸Šä¹Ÿæœ‰å¹¿æ³›åº”ç”¨ï¼Œæ¯”å¦‚å¹¿å‘Šä¸šå¯ä»¥ç”¨å®ƒè¿›è¡Œç²¾å‡†æŠ•æ”¾ï¼Œæ•™è‚²ç•Œå¯ä»¥è¿›è¡Œä¸ªæ€§åŒ–æ•™å­¦ï¼ŒåŒ»å­¦ç•Œå¯ä»¥ç”¨å®ƒè¿›è¡Œè¾…åŠ©è¯Šæ–­ï¼Œé‡‘èç•Œå¯ä»¥ç”¨å®ƒè¿›è¡ŒåŠ¨æ€é£é™©ç›‘æ§ã€‚</p>
<p>å¦‚æœä½ æƒ³å°è¯•è‡ªå·±éƒ¨ç½²ï¼Œå¯ä»¥ä½¿ç”¨è°·æ­Œæ ‡ç­¾ã€‚Llama3.1æ˜¯ Metaåœ¨å»å¹´çš„4ä¸ªæœˆå¼€æ”¾çš„ä¸€ä¸ªæ¨¡å‹ï¼Œè™½ç„¶95%çš„è®­ç»ƒæ•°æ®éƒ½æ˜¯ç”¨è‹±æ–‡çš„ï¼Œä½†æ˜¯ Llama3.1æœ‰å¾ˆå¤šç‰ˆæœ¬ã€‚å†ä½¿ç”¨å¼€æ”¾æºç çš„ LLMå¼€å‘å¹³å° Ollamaï¼Œæµç¨‹ä¹Ÿä¸æ˜¯å¾ˆå¤æ‚ï¼Œæ‰“å¼€ Colabï¼Œé€‰æ‹© GPUæ”¯æŒçš„ç¯å¢ƒã€å®‰è£… Ollamaã€ä¸‹è½½ Llama3.1ã€è¿è¡Œ Lllama3.1ï¼Œç„¶åå°±å¯ä»¥å’Œæ¨¡å‹è¿›è¡Œäº¤äº’ã€‚å¦‚æœç¡¬ä»¶ä¸å¤Ÿå¥½ï¼Œä¹Ÿå¯ä»¥å°è¯•åœ¨æœ¬åœ°éƒ¨ç½²æˆ–ä¸ ngrokä¸€èµ·è¿›è¡Œè¿œç¨‹æ¥å…¥ã€‚</p>
<p>ç„¶è€Œï¼Œä½¿ç”¨ LLMéœ€è¦è€ƒè™‘ä¸€äº›é“å¾·ä¸Šçš„å› ç´ ï¼Œä¾‹å¦‚ä¿æŠ¤æ•°æ®éšç§ï¼Œé¿å…äº§ç”Ÿè™šå‡ä¿¡æ¯ï¼Œé™ä½æ¨¡å‹åå·®ï¼Œä»¥åŠ LLMçš„èƒ½æºæ¶ˆè€—å¹¶ä¸å°ï¼Œä¼šå¯¹ç¯å¢ƒé€ æˆä¸€å®šçš„å½±å“ã€‚æœªæ¥ï¼Œ LLMå°†æœç€å¤šæ¨¡å¼ã€å¼ºé€»è¾‘æ¨ç†ï¼ˆOpenAIo1ï¼‰ã€è‡ªæ²»æ¨¡å‹çš„æ–¹å‘å‰è¿›ï¼Œå¹¶ä¸”å°†æ›´åŠ æœ‰æ•ˆåœ°è¿›è¡Œä¸ªæ€§åŒ–çš„å¾®è°ƒï¼Œæ›´åŠ å¯†åˆ‡åœ°ä¸äººç±»è¿›è¡Œåˆä½œï¼Œå¹¶ä¸”å°†é€æ¸å®Œå–„ç›¸å…³çš„é“å¾·è§„èŒƒã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6678f831590e4bf98223ff23e25900f2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=GOFcwZEFwV7E5SoOKCfblxcGZB0%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f823ddab2d944369668102ac0e204f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=PjRyT%2BxX0L3%2Bku0h%2FObCRM57%2BSo%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7867ad6db65c4b48898f2716eb17cf38~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=RfzOACOnwm5NsARibiWWcNvtNqs%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/15f5e250e99c46f7a9bcb6fbd72bacd9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=R2YjnRc3NU%2F5XuBGieNn79PL%2Blk%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad86b7e6663a498bad6b34f64306a440~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=nv5EXymNWRF9R2f9Sc%2BKnmntaS0%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/040e209b2f43477fb45080a2a02b46ce~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=JTAu%2BER4e8r2uAJ8PucGAtshkbE%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/20555c4762f34ec4b27182a0e925705c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=IPJh%2BehvP%2Br%2FZj3wQdTO%2BofcgL0%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/412e92b3d56545fdad4e34cfb3595788~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=cj1OfR9Nt6AwSGHuKw41raXw6VQ%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/284ccd5285e9476d9542c28584b21986~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=pGOAkayHHe4iZAB2IDk5TzK7qfQ%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/367be3e1905d4fec8bf2e61d9ffa96c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=Yfii5zj5KJyIWWaK5%2BwCrxpyiWg%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c07ab8a8801d44eca7bcf59cf45478ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=M3b%2F9kjkDB2loHqKfD7bmApnL0I%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/59a0f0039b5e4dfea78ab3fd2d0e4e14~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=XRglWL5chO6uakBdR3d0fqz92dI%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ebb12acc74aa448f8ac372b3505df368~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=ejHhOz8K0aAiySDPYsBzBuPwVZs%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ab1d077d0034d18b29b9f9f102c446c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=Ih1IkGFhNQhUFFtidTPHsxo5sIQ%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f68cea40dc9a45d2932f03575d33388e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=%2FArYH0cc0OQ2tlvD%2BszXB6cxHko%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98d235d9437b43a2a96bc122b2df729c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=UphzYVGVMgDT2hYce%2FBMLp4xaog%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6137a0a7b9fb4dc5a37f26137593bd57~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=eZRG3FzbbmJTbvktM0zaGhxWlgg%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d7f4e5e486a4efd9cdfd06725893ebe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=Q9nmJsU3ctoBr0iTs6SgmKcmFrc%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/38dfdaf572ee429fbc968c862d689cb9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420941&amp;x-signature=QrkoYgCWBSRhChLhhA3gQe4rFJQ%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RAGè¯„æµ‹å®Œæ•´æŒ‡å—ï¼šæŒ‡æ ‡ã€æµ‹è¯•å’Œæœ€ä½³å®è·µ]]></title>    <link>https://juejin.cn/post/7588031908171890697</link>    <guid>https://juejin.cn/post/7588031908171890697</guid>    <pubDate>2025-12-27T06:18:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588031908171890697" data-draft-id="7588028859541241882" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RAGè¯„æµ‹å®Œæ•´æŒ‡å—ï¼šæŒ‡æ ‡ã€æµ‹è¯•å’Œæœ€ä½³å®è·µ"/> <meta itemprop="keywords" content="LLM,Agent,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-27T06:18:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AIå¤§æ¨¡å‹"/> <meta itemprop="url" content="https://juejin.cn/user/3817967696221534"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RAGè¯„æµ‹å®Œæ•´æŒ‡å—ï¼šæŒ‡æ ‡ã€æµ‹è¯•å’Œæœ€ä½³å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3817967696221534/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AIå¤§æ¨¡å‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T06:18:45.000Z" title="Sat Dec 27 2025 06:18:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»27åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>ã€‚</p>
</blockquote>
<p>RAGï¼ˆRetrieval-Augmented Generationï¼Œæ£€ç´¢å¢å¼ºç”Ÿï¼‰æœ€åˆç”±Facebook AI Researchï¼ˆç°Meta AIï¼‰å›¢é˜Ÿåœ¨è®ºæ–‡ Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks ä¸­æå‡ºï¼Œå¹¶å‘è¡¨äºNeurIPS 2020ã€‚</p>
<p>å¦‚æœä½ æœ‰ä½¿ç”¨RAGåº”ç”¨ï¼Œä½ ä¼šå‘ç°ï¼ŒRAGæ¡†æ¶æ˜¯ä¸€ä¸ªå¤æ‚çš„å·¥ä½œæµï¼ŒåŒ…æ‹¬åˆ†å—ã€æœç´¢ã€ä¸Šä¸‹æ–‡æ‹¼æ¥å’Œå†…å®¹ç”Ÿæˆç­‰æ­¥éª¤ï¼Œä¸€æ—¦ç³»ç»Ÿæœ€ç»ˆå“åº”çš„å†…å®¹ä¸ç¬¦åˆé¢„æœŸï¼Œå¯¹äºé—®é¢˜çš„å®šä½ä¼šéå¸¸å¤æ‚ï¼Œæ˜¯æ¨¡å‹å‡ºç°äº†å¹»è§‰ï¼Ÿè¿˜æ˜¯ä»ä¸€å¼€å§‹å°±æ²¡æœ‰è·å–åˆ°æ­£ç¡®çš„ä¿¡æ¯ï¼Ÿ</p>
<p>è¿™å°±éœ€è¦ä¸€ä¸ªå®Œå–„çš„RAGè¯„ä¼°ä½“ç³»ï¼šè¯„ä¼°RAGç³»ç»Ÿå„ä¸ªæ¨¡å—è¿è¡Œçš„æ•ˆæœï¼Œåœ¨ç”¨æˆ·ä¹‹å‰åˆ†æé—®é¢˜ã€ç”šè‡³æ˜¯é¢„åˆ¤é—®é¢˜ã€‚è¿™ç¯‡æ–‡ç« ä¼šå’Œå¤§å®¶è¯¦ç»†èŠèŠï¼Œå¦‚ä½•åœ¨å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒä¸­è¯„ä¼°RAGç³»ç»Ÿã€‚</p>
<h2 data-id="heading-0">å…¨æ–‡é€Ÿè§ˆ</h2>
<ul>
<li><strong>åŸºæœ¬æ¦‚å¿µ</strong>ï¼š<strong>RAGç³»ç»Ÿ</strong>èƒ½å¤Ÿä»å¤§é‡çš„è¯­æ–™åº“ä¸­æ£€ç´¢å‡ºä¸è¾“å…¥é—®é¢˜ç›¸å…³çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå¹¶åˆ©ç”¨è¿™äº›ä¿¡æ¯ç”Ÿæˆå‡†ç¡®ã€åˆç†çš„å›ç­”,Â <strong>RAGè¯„ä¼°</strong>ç”¨äºè¯„ä»·RAGç³»ç»Ÿæ€§èƒ½çš„ç³»ç»Ÿæ–¹æ³•ã€‚</li>
<li><strong>RAGè¯„ä¼°æ ¸å¿ƒå†…å®¹</strong>ï¼š<strong>æ£€ç´¢</strong>ï¼ˆæŸ¥æ‰¾æœ‰ç”¨ä¿¡æ¯ï¼‰ã€<strong>ç”Ÿæˆ</strong>ï¼ˆç”Ÿæˆæœ€ç»ˆç­”æ¡ˆï¼‰ã€‚</li>
<li><strong>æ£€ç´¢è¯„ä¼°</strong>ï¼šåˆ†ä¸ºæ’åºã€ä¸Šä¸‹æ–‡ç›¸å…³æ€§æŒ‡æ ‡ï¼Œå‰è€…å¯ä»¥é‡‡ç”¨Top-Kå¬å›ï¼Œåè€…å¯ä»¥é‡‡ç”¨äººå·¥æˆ–LLMæ¥åˆ¤æ–­ã€‚</li>
<li><strong>ç”Ÿæˆè¯„ä¼°</strong></li>
</ul>

<ul>
<li><strong>æœ‰çœŸå€¼</strong>ï¼šä½¿ç”¨LLMä½œä¸ºè¯„åˆ¤å‘˜æˆ–è¯­ä¹‰ç›¸ä¼¼æ€§ï¼Œå°†è¾“å‡ºä¸æ­£ç¡®ç­”æ¡ˆè¿›è¡Œæ¯”è¾ƒã€‚</li>
<li><strong>æ— çœŸå€¼</strong>ï¼šå¯ä»¥æ£€æŸ¥å“åº”çš„å¿ è¯šåº¦ã€å®Œæ•´æ€§ã€è¯­æ°”æˆ–ç»“æ„è´¨é‡</li>
</ul>

<ul>
<li><strong>åˆæˆæµ‹è¯•æ•°æ®</strong>ï¼šä¸€ç§å¸®åŠ©RAGè¯„ä¼°çš„æ–¹æ³•ï¼Œé€šè¿‡ä»çŸ¥è¯†åº“ä¸­ç”Ÿæˆé—®ç­”å¯¹æ¥å®ç°ï¼Œç”¨ä»¥åœ¨æ²¡æœ‰çœŸå®æ•°æ®çš„æƒ…å†µä¸‹å¿«é€Ÿæ„å»ºå’Œæµ‹è¯•é›†ã€‚</li>
<li><strong>é²æ£’æ€§æµ‹è¯•å’Œå¯¹æŠ—æ€§æµ‹è¯•</strong>ï¼šç¡®ä¿RAGç³»ç»Ÿåœ¨é¢å¯¹é£é™©è¾“å…¥æˆ–æç«¯æƒ…å†µæ—¶ï¼Œå“åº”ä»ç„¶å®‰å…¨ä¸€è‡´ã€‚é²æ£’æ€§æµ‹è¯•è¯„ä¼°RAGç³»ç»Ÿåœ¨æ­£å¸¸åœºæ™¯ä¹‹å¤–çš„è¡Œä¸ºï¼Œå¹¶è§‚å¯Ÿå…¶èƒ½å¦ä»å®¹çš„åº”å¯¹ã€‚å¯¹æŠ—æ€§æµ‹è¯•ä¾§é‡ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼Œæµ‹è¯•RAGç³»ç»Ÿèƒ½å¤ŸæŠµå¾¡æ¶æ„æ”»å‡»æˆ–è¯¯æ“ä½œï¼Œå¹¶ä¿æŠ¤ç”¨æˆ·çš„æ•°æ®å’Œéšç§ã€‚</li>
</ul>
<h2 data-id="heading-1">åŸºæœ¬æ¦‚å¿µ</h2>
<h3 data-id="heading-2">ä»€ä¹ˆæ˜¯ RAGï¼Ÿ</h3>
<p>RAGä½œä¸ºå½“ä¸‹ä¸»æµçš„LLMåº”ç”¨æ¡†æ¶ï¼Œå°†å¤–æŒ‚çš„çŸ¥è¯†åº“ï¼ˆå¦‚ç½‘ç»œæ•°æ®ã€ä¼ä¸šç§æœ‰æ–‡æ¡£ï¼‰ã€LLMå†…ç½®çš„çŸ¥è¯†å®Œç¾èåˆï¼Œæœ‰æ•ˆè§£å†³LLMä¸­å­˜åœ¨çš„<strong>ä¿¡æ¯è¿‡æ—¶</strong>ã€<strong>è¾“å‡ºå¹»è§‰ã€è¡Œä¸šæ•°æ®éš”ç¦»</strong>ç­‰ç—›ç‚¹é—®é¢˜ï¼Œäº§ç”Ÿæ›´å‡†ç¡®ã€æ›´æœ‰ç”¨çš„ç»“æœã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå¯¹äºä¸€å®¶å…¬å¸çš„å®¢æœæœºå™¨äººï¼ŒLLMæ˜¯å¾ˆéš¾çŸ¥é“è¿™å®¶å…¬å¸çš„äº§å“åŠŸèƒ½ã€ä¸šåŠ¡é€»è¾‘çš„ã€‚ç›¸åï¼ŒRAGç³»ç»Ÿåœ¨ç”¨æˆ·æå‡ºé—®é¢˜æ—¶ï¼Œä¼šæ£€ç´¢å…¬å¸å†…éƒ¨çš„äº§å“æˆ–ä¸šåŠ¡æ–‡æ¡£ï¼Œå°†æ£€ç´¢åˆ°çš„ç›¸å…³å†…å®¹äº¤ç»™LLMï¼Œç”±LLMç”Ÿæˆæœ€ç»ˆçš„ç­”æ¡ˆã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84448f6a01504fe0bac6ce6db54eba92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767421125&amp;x-signature=tnPRbhFPAN9F0dou1d7g9SpMQBc%3D" alt="" loading="lazy"/></p>
<p>RAG ç³»ç»Ÿå¯ä»¥åˆ†ä¸ºä¸¤å¤§æ­¥éª¤ï¼š</p>
<ul>
<li>Rï¼ˆRetrievalï¼‰: å°è¯•æ‰¾åˆ°ä¸ç”¨æˆ·æŸ¥è¯¢æœ€ç›¸å…³çš„ä¿¡æ¯ç‰‡æ®µï¼Œä¿¡æ¯çš„æ¥æºåŒ…æ‹¬æ–‡æ¡£å­˜å‚¨åº“ã€çŸ¥è¯†åº“ã€SQLæŸ¥è¯¢æ•°æ®åº“ç­‰ã€‚</li>
<li>Gï¼ˆGenerateï¼‰: åˆ©ç”¨æ£€ç´¢åˆ°çš„ä¿¡æ¯ç”Ÿæˆç­”æ¡ˆ</li>
</ul>
<p>éœ€è¦æé†’çš„æ˜¯ï¼ŒRAGç³»ç»Ÿæ˜¯ä¸€ç§è®¾è®¡ç†å¿µï¼Œè€Œéå•ä¸€çš„å®ç°å½¢å¼ã€‚æ¯”å¦‚ï¼Œ<strong>æ£€ç´¢</strong>éƒ¨åˆ†çš„å®ç°å½¢å¼æ˜¯å¤šæ ·çš„ï¼Œå¦‚è¯­ä¹‰æœç´¢ã€å…³é”®è¯æœç´¢ã€SQLæŸ¥è¯¢ï¼Œç”šè‡³æ˜¯APIè°ƒç”¨ï¼Œä¸ºæ¨¡å‹æä¾›æœ‰ç”¨çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p>
<p>åœ¨ä¼ä¸šåº”ç”¨ä¸­ï¼Œæ£€ç´¢å®é™…ä¸Šæ˜¯å¯¹å†…éƒ¨çš„å¤§é‡éç»“æ„åŒ–æ–‡æ¡£è¿›è¡Œæœç´¢çš„ç³»ç»Ÿï¼ŒåŒ…æ‹¬æ–‡æ¡£çš„å‡†å¤‡ã€å­˜å‚¨ã€ç´¢å¼•æ–¹å¼å’Œæ’åºã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/51974b77ef0e4220806e0b2953148e43~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767421125&amp;x-signature=ypF%2BIYZEhZ3wFXqI2rJZa66%2FNE8%3D" alt="" loading="lazy"/></p>
<p>æ£€ç´¢å®Œæˆåï¼Œéœ€è¦ä¸ºLLMæ„å»ºå®Œæ•´çš„æç¤ºä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>ç”¨æˆ·çš„é—®é¢˜</li>
<li>æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡</li>
<li>ç³»ç»Ÿæç¤ºï¼Œçº¦å®šæ¨¡å‹æŒ‰ç…§ä»€ä¹ˆæ ¼å¼è¾“å‡ºç­”æ¡ˆ</li>
</ul>
<h3 data-id="heading-3">ä»€ä¹ˆæ˜¯ RAG è¯„ä¼°ï¼Ÿ</h3>
<p>å®šä¹‰ï¼šæ—¨åœ¨è¡¡é‡RAGç³»ç»Ÿåœ¨å®é™…åº”ç”¨ä¸­çš„æ€§èƒ½è¡¨ç°ã€‚æ¯”å¦‚ï¼šæ˜¯å¦æå–äº†æ­£ç¡®çš„ä¿¡æ¯ï¼Ÿæ˜¯å¦ç»™å‡ºäº†æ­£ç¡®çš„ç­”æ¡ˆï¼Ÿè¾“å‡ºç»“æœæ˜¯å¦å¯ä¿¡ï¼Ÿä¸€ä¸ªåˆç†çš„è¯„ä¼°ä½“ç³»æœ‰åŠ©äºå›ç­”è¿™äº›é—®é¢˜ï¼Œå¹¶æŒ‡å¯¼å¼€å‘å·¥ç¨‹å¸ˆåšå‡ºæ›´å¥½çš„è®¾è®¡å†³ç­–ã€‚</p>
<p>RAGç³»ç»Ÿå°±åƒä¸€å°ç²¾å¯†çš„æœºå™¨ï¼Œè¦è®©å®ƒç¨³å®šè¿è½¬ï¼Œæ¯ä¸ªå…³é”®ç¯èŠ‚éƒ½è¦åšæ‰å®ï¼šæ–‡æ¡£çš„åˆ†å—å’Œå­˜å‚¨æ–¹å¼ã€ä½¿ç”¨çš„åµŒå…¥æ¨¡å‹ã€æ£€ç´¢é€»è¾‘ã€æç¤ºæ ¼å¼ã€LLM ç‰ˆæœ¬ç­‰ç­‰ã€‚</p>
<p>ä¸€å¥—é è°±çš„è¯„ä¼°æ–¹æ³•ï¼Œå°±åƒè¿™å°ç²¾å¯†æœºå™¨çš„è°ƒè¯•å·¥å…·ç®±ï¼Œèƒ½è§£å†³å¾ˆå¤šå®é™…é—®é¢˜ï¼š</p>
<ul>
<li>å¿«é€Ÿç»™å‡ºä¸åŒæ–¹æ¡ˆçš„å¯¹æ¯”æ•ˆæœï¼Œæ¯”å¦‚å“ªç§æ–‡æ¡£åˆ†å—æ–¹å¼æ‰¾ç­”æ¡ˆæ›´å‡†</li>
<li>è¿½è¸ªå“ªäº›å› ç´ èƒ½æé«˜æˆ–é™ä½æ•ˆæœ</li>
<li>ç²¾å‡†å®šä½é—®é¢˜ï¼Œå½“ç³»ç»Ÿç­”éæ‰€é—®æˆ–å‡ºé”™æ—¶ï¼Œèƒ½æ›´å¿«æ‰¾åˆ°ç—‡ç»“åœ¨å“ªå„¿ï¼Œè°ƒè¯•èµ·æ¥æ›´çœå¿ƒã€‚</li>
</ul>
<p>è¯´äº†è¿™ä¹ˆå¤šï¼Œåˆ°åº•è¯¥å¦‚ä½•è¯„ä¼°å‘¢ï¼Ÿä¸€ç§ç®€å•çš„æ–¹å¼ï¼Œå¯¹RAGç³»ç»Ÿè¿›è¡Œç«¯åˆ°ç«¯è¯„ä¼°ï¼Œé‡ç‚¹å…³æ³¨æœ€ç»ˆç­”æ¡ˆçš„è´¨é‡ï¼Œè¿™ç§æ–¹å¼å°½ç®¡ä¹Ÿå¯è¡Œï¼Œä½†ä¸åˆ©äºé—®é¢˜çš„æ’æŸ¥ã€æ•ˆæœçš„ä¼˜åŒ–ã€‚</p>
<p>æ›´ä¼˜çš„æ–¹å¼æ˜¯ï¼Œå°†æ£€ç´¢å’Œç”Ÿæˆé˜¶æ®µåˆ†å¼€è¯„æµ‹ï¼Œè¿™å¯¹äºè°ƒè¯•ä¹Ÿè‡³å…³é‡è¦ã€‚å½“ä½ å¾—åˆ°é”™è¯¯ç­”æ¡ˆæ—¶ï¼Œä½ é¦–å…ˆåº”è¯¥é—®è‡ªå·±ï¼šå“ªé‡Œå‡ºé”™äº†ï¼Ÿ</p>
<ul>
<li>ç³»ç»Ÿæ˜¯å¦æ£€ç´¢åˆ°æ­£ç¡®çš„ä¸Šä¸‹æ–‡ä¿¡æ¯</li>
<li>ä¸Šä¸‹æ–‡æ­£ç¡®äº†ï¼Œæ¨¡å‹æ˜¯ä¸æ˜¯å‡ºç°äº†å¹»è§‰</li>
</ul>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åˆ†åˆ«ä»‹ç»æ£€ç´¢å’Œç”Ÿæˆé˜¶æ®µçš„è¯„ä¼°æ–¹æ³•</p>
<h2 data-id="heading-4">æ£€ç´¢é˜¶æ®µçš„è¯„ä¼°æ–¹æ³•</h2>
<p>ä¸‹é¢å°†ä»‹ç»<strong>æœ‰çœŸå€¼ã€äººå·¥æ ‡æ³¨å’ŒLLM</strong>ä¸‰ç§è¯„ä¼°æ–¹æ³•ã€‚</p>
<h3 data-id="heading-5">æœ‰çœŸå€¼çš„è¯„ä¼°æ–¹æ³•</h3>
<p>æ£€ç´¢è¯„ä¼°å¹¶éä¸€ä¸ªæ–°è¯é¢˜ï¼Œæ‰€æœ‰æœç´¢å¼•æ“çš„èƒŒåéƒ½æœ‰ä¸€å¥—è¿™æ ·çš„è¯„ä¼°æœºåˆ¶ï¼Œæ¯”å¦‚ç™¾åº¦ã€è°·æ­Œï¼Œè¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„æœºå™¨å­¦ä¹ åº”ç”¨åœºæ™¯ã€‚åœ¨è¿™å¥—è¯„ä¼°æœºåˆ¶çš„å¼•å¯¼ä¸‹ï¼Œå·¥ç¨‹å¸ˆå¯ä»¥ä¸ºç”¨æˆ·æä¾›æ›´å¥½çš„äº§å“æœåŠ¡ã€‚ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†è¿™å¥—æ–¹æ³•å¤ç”¨åˆ°RAGç³»ç»Ÿä¸­ã€‚</p>
<p>ä½ éœ€è¦æœ‰ä¸€ä¸ª<strong>çœŸå€¼æ•°æ®é›†ï¼Œå¯¹äºæ¯ä¸ªæŸ¥è¯¢ï¼Œéœ€è¦å®šä¹‰åŒ…å«ç­”æ¡ˆçš„æ­£ç¡®æ¥æºï¼Œå¯ä»¥æ˜¯æ–‡æ¡£IDã€æ•°æ®å—ID æˆ–é“¾æ¥ã€‚</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be2215a44ecc468bbe4b0daf728a6120~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767421125&amp;x-signature=AlGi45txZveTYcmObaSfrwgm9DY%3D" alt="" loading="lazy"/></p>
<p>åœ¨ä¿¡æ¯æ£€ç´¢æœ¯è¯­ä¸­ï¼Œè¿™äº›è¢«ç§°ä¸º<strong>ç›¸å…³</strong>æ–‡æ¡£ï¼Œå³ä¸ºç”¨æˆ·æŸ¥è¯¢æä¾›æ­£ç¡®ã€æœ‰æ•ˆä¿¡æ¯çš„æ¡ç›®ã€‚</p>
<p>æœ‰äº†è¿™ä»½çœŸå€¼æ•°æ®é›†ï¼Œå°±å¯ä»¥åœ¨ç³»ç»Ÿä¸­è¿è¡ŒæŸ¥è¯¢ï¼Œå¹¶é€šè¿‡æ¯”è¾ƒæ£€ç´¢åˆ°çš„æ•°æ®å—ä¸é¢„æœŸæ•°æ®å—ï¼Œæ¥æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦èƒ½å¤Ÿæ‰¾åˆ°é¢„æœŸçš„ä¸Šä¸‹æ–‡ã€‚ä¸ºäº†é‡åŒ–ç»“æœï¼Œå¯ä»¥è®¡ç®—æ ‡å‡†çš„ä¿¡æ¯æ£€ç´¢æŒ‡æ ‡ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€äº›ä¾‹å­ï¼Œåç»­å°†ä»¥ä¸“æ çš„å½¢å¼ï¼Œè¯¦ç»†ä»‹ç»å„ç±»è¯„ä¼°æŒ‡æ ‡çš„åŸç†ã€å®ç°ï¼š</p>

























<table><thead><tr><th>æŒ‡æ ‡</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>ç²¾ç¡®åº¦@k</td><td>åœ¨æ£€ç´¢åˆ°çš„å‰kä¸ªç»“æœä¸­ï¼Œæœ‰å¤šå°‘æ˜¯çœŸæ­£ç›¸å…³çš„ï¼Ÿ</td></tr><tr><td>å¬å›@k</td><td>åœ¨æ‰€æœ‰ç›¸å…³æ–‡æ¡£ä¸­ï¼Œæœ‰å¤šå°‘ä¸ªæ–‡æ¡£è¢«æ£€ç´¢åˆ°æ’åå‰kä¹‹åˆ—ï¼Ÿ</td></tr><tr><td>å‘½ä¸­ç‡</td><td>å‰kä¸ªç»“æœä¸­æ˜¯å¦è‡³å°‘å‡ºç°è¿‡ä¸€ä¸ªç›¸å…³æ¡ç›®ï¼Ÿï¼ˆæ˜¯/å¦ï¼‰</td></tr><tr><td>NDCG@k</td><td>å½’ä¸€åŒ–æŠ˜æ‰£ç´¯è®¡æ”¶ç›Šï¼šç”¨æ¥è¡¡é‡æ’åå‰kä¸ªæ£€ç´¢ç»“æœçš„ç›¸å…³æ€§å’Œæ’åºåˆç†æ€§</td></tr></tbody></table>
<p>ä»¥<strong>ç²¾ç¡®åº¦@k</strong>æŒ‡æ ‡ä¸ºä¾‹ï¼Œå…¶è®¡ç®—ç¤ºæ„å›¾å¦‚ä¸‹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a7b95f8bf97e4c41858e77772b04b522~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767421125&amp;x-signature=fNjsji2ncYxYwezTz94guWXtnYY%3D" alt="" loading="lazy"/></p>
<p>è¿™äº›è¯„ä¼°æŒ‡æ ‡èƒ½å¸®åŠ©æˆ‘ä»¬æœ‰æ•ˆå¯¹æ¯”ä¸åŒçš„æœç´¢é…ç½®ï¼Œæ¯”å¦‚é‡æ’è§„åˆ™ã€åµŒå…¥æ–¹æ³•ï¼Œè¿˜èƒ½å®šä½é—®é¢˜ã€‚ç¼ºç‚¹æ˜¯ï¼Œæ„å»ºçœŸå®çš„æµ‹è¯•æ•°æ®é›†ç‰¹åˆ«è€—æ—¶ï¼Œéœ€è¦äººå·¥æŠŠæ¯ä¸ªæµ‹è¯•é—®é¢˜å¯¹åº”åˆ°æ­£ç¡®çš„å‚è€ƒå†…å®¹ä¸Šã€‚</p>
<h3 data-id="heading-6">äººå·¥æ ‡æ³¨ç›¸å…³æ€§</h3>
<p>è¿™æ˜¯ä¸€ç§ç›¸å¯¹ç®€å•çš„æ–¹æ³•ï¼Œåœ¨æ£€ç´¢åè¯„ä¼°ç»“æœã€‚</p>
<p>æ— éœ€é¢„å…ˆå®šä¹‰ç›¸å…³æ–‡æ¡£ï¼Œè®©ç³»ç»ŸæŒ‰åŸæ ·è¿è¡Œæµ‹è¯•æŸ¥è¯¢ï¼Œç„¶åæ‰‹åŠ¨è¯„ä¼°ç»“æœã€‚å¯¹äºæ¯ä¸ªæŸ¥è¯¢ï¼Œéƒ½è¦æ£€æŸ¥ç³»ç»Ÿçš„æ£€ç´¢å†…å®¹ï¼Œå¹¶åˆ†é…ä¸€ä¸ªæ ‡ç­¾ï¼Œä¾‹å¦‚ï¼š<em>ç›¸å…³</em>ã€<em>éƒ¨åˆ†ç›¸å…³ ã€ä¸ç›¸å…³</em>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4a4f4f98d53845bcb391f14a1a877d89~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767421125&amp;x-signature=UxRjSGu2RhSz9DCgfPAD1PpmBNc%3D" alt="" loading="lazy"/></p>
<p>è®¸å¤šå›¢é˜Ÿåœ¨å®è·µä¸­ä¹Ÿæ˜¯ç”¨è¿™ç§æ–¹æ³•è¯„ä¼°æ£€ç´¢æ•ˆæœçš„ã€‚ä¾‹å¦‚ï¼Œè°·æ­Œåˆ¶å®šäº†è¯¦å°½çš„å†…éƒ¨å‡†åˆ™ ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.google.com%2Fsearch%2Fhowsearchworks%2Fhow-search-works%2Frigorous-testing%2F" target="_blank" title="https://www.google.com/search/howsearchworks/how-search-works/rigorous-testing/" ref="nofollow noopener noreferrer">www.google.com/search/howsâ€¦</a>ï¼‰ä¾›äººå·¥è¯„åˆ†å‘˜å‚è€ƒã€‚</p>
<p>è¿™æ ·åšçš„å¥½å¤„æ˜¯çµæ´»ï¼Œå¯ä»¥è¯„ä¼°æ•´ä¸ªæ£€ç´¢æµç¨‹åœ¨å®é™…è¿è¡Œä¸­çš„æ•ˆæœï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>è¯„ä¼°ç”¨æˆ·åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å®é™…çœ‹åˆ°çš„æ£€ç´¢è´¨é‡ã€‚</li>
<li>æ‰¾å‡ºæ€§èƒ½æå·®çš„æŸ¥è¯¢</li>
<li>æ›´å¥½åœ°ç†è§£è¾¹ç•Œæƒ…å†µå’Œæ­§ä¹‰æŸ¥è¯¢</li>
</ul>
<p>ç¼ºç‚¹ä¹Ÿæ˜¾è€Œæ˜“è§ï¼Œæ— æ³•è®¡ç®—å¬å›ç‡ï¼Œå› ä¸ºæ²¡æœ‰çœŸå€¼ã€‚</p>
<h3 data-id="heading-7">LLMè¯„å®¡å‘˜è¯„ä¼°ç›¸å…³æ€§</h3>
<p>LLMè¯„å®¡å‘˜ä½¿ç”¨ç”¨å¤§è¯­è¨€æ¨¡å‹ï¼Œåœ¨è¯„ä¼°æç¤ºè¯çš„å¼•å¯¼ä¸‹ï¼Œè¯„ä»·RAGç³»ç»Ÿå“åº”çš„ç»“æœã€‚æ¯”å¦‚ï¼Œå¯ä»¥ç»™LLMå®šåˆ¶æç¤ºè¯ï¼Œè®©å®ƒåˆ¤æ–­æŸä¸ªå›å¤æœ‰æ²¡æœ‰å¸®åŠ©ï¼Œæˆ–è€…æ˜¯å¦ç¬¦åˆç‰¹å®šçš„è§„åˆ™è¦æ±‚ã€‚</p>
<p>ä¸‹é¢ï¼Œå°†ä¸ºå¤§å®¶ä»‹ç»LLMè¯„å®¡å‘˜çš„ä¸¤ç§æŠ€æœ¯æ–¹æ¡ˆã€‚</p>
<h4 data-id="heading-8">å¯¹æ•°æ®å—è¯„ä¼°ç›¸å…³æ€§</h4>
<p>å¯ä»¥æŠŠç”¨æˆ·çš„é—®é¢˜å’Œæ£€ç´¢åˆ°çš„æ•°æ®å—ä¸€èµ·ç»™åˆ°LLMè¯„å®¡å‘˜ï¼Œè®©å®ƒæ¥åˆ¤æ–­ä¿¡æ¯å—å’Œç”¨æˆ·é—®é¢˜æ˜¯å¦ç›¸å…³ã€‚</p>
<p>LLMè¯„å®¡å‘˜ç»™å‡ºçš„åˆ¤æ–­ç»“æœæœ‰ä¸¤ç§å½¢å¼ï¼š</p>
<ul>
<li>ç®€å•çš„äºŒåˆ†ç±»æ ‡ç­¾ï¼Œç›´æ¥æ ‡è®°*ç›¸å…³ã€*<em>ä¸ç›¸å…³</em></li>
<li>ç»™å‡ºä¸€ä¸ªå…·ä½“çš„ç›¸å…³æ€§åˆ†æ•°</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d6898b8e9e0e437f8d0635103a4eb8df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767421125&amp;x-signature=Nu7QWkUWDNTy2wn6wfuLP2QSjLc%3D" alt="" loading="lazy"/></p>
<p>è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–LLMè¯„ä¼°æ–¹æ³•ï¼Œä¾‹å¦‚ï¼ŒåŸºäºåµŒå…¥çš„è¯­ä¹‰ç›¸ä¼¼åº¦ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªæ•°å€¼åˆ†æ•°ï¼Œåæ˜ æŸ¥è¯¢å’Œæ£€ç´¢åˆ°çš„æ•°æ®å—åœ¨è¯­ä¹‰ä¸Šçš„ç›¸ä¼¼ç¨‹åº¦ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒRAGç³»ç»Ÿä¸€èˆ¬ä¼šå¯¹å•æ¬¡æŸ¥è¯¢è¿”å›å¤šä¸ªæ•°æ®å—ï¼Œè¿™æ„å‘³ç€éœ€è¦å¯¹æ¯ä¸ªæ•°æ®å—å•ç‹¬è¿›è¡Œè¯„åˆ†ã€‚</p>
<p><strong>ä¸¾ä¸ªç®€å•çš„ä¾‹å­</strong>ï¼šå‡è®¾å…³äºé¦™è•‰çš„æŸ¥è¯¢æ£€ç´¢åˆ°ä¸‰ä¸ªçŸ­æ–‡æœ¬å—ã€‚æ¯ä¸ªæ–‡æœ¬å—éƒ½æ˜¯ä¸€ä¸ªå¥å­ï¼Œå¯èƒ½æ¥è‡ªä¸åŒçš„æ–‡æ¡£ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c92b06020f9c40c4a354b2565839d3df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767421125&amp;x-signature=4pqMpuZFtqZj0jmUCXi6it3UBec%3D" alt="" loading="lazy"/></p>
<p>ç„¶åï¼Œé‡‡ç”¨LLMè¯„å®¡å‘˜ä¸ºæ¯ä¸ªæ•°æ®å—åˆ†é…ä¸€ä¸ªç›¸å…³æ€§åˆ†æ•°ï¼Œå…¶ä¸­ 1 è¡¨ç¤ºé«˜åº¦ç›¸å…³ï¼Œ0 è¡¨ç¤ºå®Œå…¨ä¸ç›¸å…³ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä¸Šå›¾ä¸­çš„<strong>Chunk 1</strong>åŒ…å«æœ‰å…³é¦™è•‰å¥åº·ç›Šå¤„çš„ç›¸å…³ä¿¡æ¯ï¼Œå¾—1åˆ†ã€‚ä½†<strong>Chunk 3</strong>è¿™æ ·çš„å†…å®¹ä¸ç”¨æˆ·çš„æŸ¥è¯¢æ— ç›¸å…³æ€§ï¼Œå¾—0åˆ†ã€‚</p>
<p>ä¸€æ—¦è¯„ä¼°å®Œæ¯ä¸ªæ•°æ®å—çš„ç›¸å…³æ€§ä¹‹åï¼Œå°±å¯ä»¥æ±‡æ€»ç»“æœï¼Œè¯„ä¼°æœ¬æ¬¡æŸ¥è¯¢çš„æ•´ä½“æ£€ç´¢è´¨é‡ã€‚ æœ‰ä¸‰ç§å®ç°æ–¹å¼ï¼š</p>
<ul>
<li><strong>äºŒå…ƒå‘½ä¸­</strong>ï¼šæ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ªæ•°æ®å—è¾¾åˆ°äº†ç›¸å…³æ€§é˜ˆå€¼ï¼Ÿ</li>
<li><strong>ç›¸å…³æ•°æ®å—å æ¯”</strong>ï¼šæ£€ç´¢åˆ°çš„æ•°æ®å—ä¸­ï¼Œç›¸å…³çš„æ•°æ®å—å æ¯”æ˜¯å¤šå°‘ï¼Ÿ</li>
<li><strong>å¹³å‡ç›¸å…³æ€§å¾—åˆ†</strong>ï¼šæ€»ä½“è€Œè¨€ï¼Œè¿™äº›å†…å®¹å—çš„ç›¸å…³æ€§å¦‚ä½•ï¼Ÿ</li>
</ul>
<p>æˆ‘ä»¬ä»¥å¹³å‡ç›¸å…³æ€§å¾—åˆ†ä¾‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåˆ†åˆ«æ˜¯å…³äºé¦™è•‰å’ŒåœŸè±†çƒ¹é¥ªçš„æŸ¥è¯¢ï¼Œä»Relevanceæ¥çœ‹ï¼Œå…³äºé¦™è•‰çš„é—®é¢˜ï¼Œå¾—åˆ°äº†æ›´å¤šç›¸å…³çš„æ•°æ®å—ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6deb0ad61f6a45cbabb51625936baa2e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767421125&amp;x-signature=MdftBg76AQOHjiJrpUVtkHkBiPM%3D" alt="" loading="lazy"/></p>
<p>æ›´è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥æ±‡æ€»æ¯ä¸ªæŸ¥è¯¢åœ¨å¤šä¸ªæ£€ç´¢æ–‡æœ¬å—ä¸‹çš„ç›¸å…³æ€§å¾—åˆ†ï¼Œä»è€Œè®¡ç®—å‡ºæ•´ä¸ªæµ‹è¯•æ•°æ®é›†ã€æˆ–ç‰¹å®šæ—¶é—´æ®µå†…æŸ¥è¯¢çš„ç›¸å…³æ€§æ‰“åˆ†ã€‚</p>
<h4 data-id="heading-9">å¯¹ä¸Šä¸‹æ–‡è¯„ä¼°ç›¸å…³æ€§</h4>
<p>å¦‚æœæ£€ç´¢ç³»ç»Ÿè¿”å›çš„ä¸Šä¸‹æ–‡å¾ˆçŸ­ï¼Œæˆ–è€…å¾ˆå®¹æ˜“å°†æ‰€æœ‰æ•°æ®å—æ‰“åŒ…æˆä¸€ä¸ªä¸Šä¸‹æ–‡å—ï¼Œå¯ä»¥è·³è¿‡æŒ‰å—è¯„åˆ†ï¼Œç›´æ¥è¯„ä¼°æ•´ä¸ªä¸Šä¸‹æ–‡ã€‚åªéœ€è¦ä¸ºLLMè®¾ç½®æç¤ºè¯å°±è¡Œï¼Œå¦‚ï¼š</p>
<blockquote>
<p>å¸®æˆ‘åˆ¤æ–­æ£€ç´¢åˆ°çš„å†…å®¹æ˜¯å¦åŒ…å«è¶³å¤Ÿçš„ä¿¡æ¯å›ç­”ç”¨æˆ·çš„é—®é¢˜ï¼Ÿå¦‚æœæ˜¯ï¼Œåˆ™æ˜¾ç¤ºæœ‰æ•ˆï¼›å¦åˆ™ï¼Œæ˜¾ç¤ºæ— æ•ˆã€‚</p>
</blockquote>
<p>LLMè¯„å®¡å‘˜å°†ä¼šæŒ‰ç…§ä¸Šè¿°æç¤ºè¯è¿”å›ç»“æœï¼Œå¹¶é™„æœ‰ç†ç”±ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a401ec9ad6d14a808c324a3b98e434b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767421125&amp;x-signature=NQUSR%2FNDhYOHlPyNnHmeYVT3N3Q%3D" alt="" loading="lazy"/></p>
<p>ç»è¿‡ä¸Šè¿°ä¸¤ç§æ–¹æ³•çš„ä»‹ç»ï¼Œå¯ä»¥æ€»ç»“LLMè¯„å®¡å‘˜æ–¹æ³•å…·æœ‰å¦‚ä¸‹ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>å·¥ä½œé‡ä½</strong>ï¼šåªéœ€è¦æµ‹è¯•æŸ¥è¯¢è¯­å¥ï¼Œæ— æ³•æ ‡æ³¨é—®é¢˜çš„ç­”æ¡ˆã€‚</li>
<li><strong>å¼ºåŸºçº¿æ€§èƒ½</strong>ï¼šLLMå¯ä»¥å¾ˆå¥½åœ°å¤„ç†ç›¸å…³æ€§æ£€æŸ¥ï¼Œç‰¹åˆ«æ˜¯ç®€å•æ˜¯éé—®é¢˜ä¸Šã€‚å¾®è½¯åœ¨è®ºæ–‡ Large language models can accurately predict searcher preferenceså£°ç§°ï¼ŒGPT-4åœ¨Bingçš„RAGç³»ç»Ÿç›¸å…³æ€§è¯„ä¼°æ–¹é¢ï¼Œè¾¾åˆ°äº†æ¥è¿‘äººç±»çš„æ°´å¹³ã€‚</li>
<li><strong>éå¸¸é€‚åˆå¿«é€Ÿå®éªŒ</strong>ï¼šå½“ä½ è¦å°è¯•æ–°çš„æ•°æ®åº“æˆ–æ£€ç´¢é…ç½®æ—¶ï¼Œå¯ä»¥ç›´æ¥è¿è¡ŒLLMè¯„å®¡å‘˜ï¼Œå¿«é€Ÿæ¯”è¾ƒä¸åŒé…ç½®çš„æ•ˆæœã€‚</li>
<li><strong>é€‚ç”¨äºç”Ÿäº§ç¯å¢ƒç›‘æ§</strong>ï¼šç”±äºä¸éœ€è¦äº‹å…ˆæ„å»ºçœŸå€¼ï¼Œç‰¹åˆ«é€‚åˆç”Ÿäº§ç¯å¢ƒã€‚</li>
</ul>
<h2 data-id="heading-10">å†…å®¹ç”Ÿæˆé˜¶æ®µçš„è¯„ä¼°æ–¹æ³•</h2>
<p>ä¸€æ—¦ç³»ç»Ÿæ£€ç´¢åˆ°ä¸Šä¸‹æ–‡ï¼ŒLLMå°±ä¼šä½¿ç”¨ä¸Šä¸‹æ–‡ã€ç”¨æˆ·çš„é—®é¢˜å’Œç³»ç»Ÿæç¤ºè¯æ¥ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/91ffa528cf024abba94900cb08554327~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767421125&amp;x-signature=i%2F5f4arrIDhCjS8uNU31TecVNYM%3D" alt="" loading="lazy"/></p>
<p>æœ‰ä¸¤ç§æ–¹æ³•è¯„ä¼°LLMç”Ÿæˆçš„æœ€ç»ˆç­”æ¡ˆæ˜¯å¦æœ‰æ•ˆï¼š</p>
<ul>
<li><strong>åŸºäºå‚è€ƒçš„è¯„ä¼°</strong>Â ï¼šå°†RAGç³»ç»Ÿçš„è¾“å‡ºä¸é¢„å®šä¹‰çš„å‚è€ƒç­”æ¡ˆè¿›è¡Œæ¯”è¾ƒï¼Œè¿™å°±éœ€è¦æ„å»ºæ ‡æ³¨å¥½çš„æ•°æ®é›†ï¼Œé€‚ç”¨äºå¼€å‘æˆ–æµ‹è¯•ç¯å¢ƒã€‚</li>
<li><strong>æ— å‚è€ƒè¯„ä¼°</strong>Â ï¼šå½“æ²¡æœ‰å‚è€ƒç­”æ¡ˆæ—¶ï¼Œä»ç„¶å¯ä»¥ä½¿ç”¨æŒ‡æ ‡æ¥è¯„ä¼°è´¨é‡ï¼Œæ¯”å¦‚æ¨¡å‹å›ç­”ç»“æ„ã€è¯­æ°”ã€é•¿åº¦ã€å®Œæ•´æ€§ã€æ˜¯å¦åŒ…å«å¿…è¦çš„å…è´£å£°æ˜ç­‰ç‰¹å®šå±æ€§ã€‚è¿™ç±»æ–¹æ³•é€‚ç”¨äºç°åº¦é˜¶æ®µå’Œç”Ÿäº§ç¯å¢ƒã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/040a77145b154366a4866fa65ed85d94~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767421125&amp;x-signature=c6ZsqlsTikt4Z5X4GtSSFjkxWnY%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-11">åŸºäºå‚è€ƒçš„è¯„ä¼°</h3>
<p>å¦‚æœæ˜¯ç¦»çº¿æµ‹è¯•ï¼Œæœ€å¯é çš„è¯„ä¼°æ–¹æ³•æ˜¯å°†LLMçš„ç­”æ¡ˆä¸æ­£ç¡®çš„ç­”æ¡ˆè¿›è¡Œæ¯”è¾ƒã€‚è¿™äº›åŸºäºå‚è€ƒçš„è¯„ä¼°å¯ä»¥è¡¡é‡ RAGç³»ç»Ÿåœ¨æµ‹è¯•é›†ä¸­ä¸ç†æƒ³ç­”æ¡ˆçš„æ¥è¿‘ç¨‹åº¦ã€‚</p>
<p>ä»ä¸Šé¢çš„æè¿°å¯ä»¥çœ‹å‡ºï¼Œè¦ä½¿ç”¨åŸºäºå‚è€ƒçš„è¯„ä¼°æ–¹æ³•ï¼Œéœ€è¦æ„å»ºä¸€ç³»åˆ—é—®ç­”å¯¹æ•°æ®é›†ï¼Œä½œä¸ºè¯„æµ‹åŸºå‡†ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œå°†é—®é¢˜è¾“å…¥åˆ°RAGç³»ç»Ÿä¸­ï¼Œå¹¶å°†ç”Ÿæˆçš„å“åº”ä¸å‚è€ƒå“åº”è¿›è¡Œæ¯”è¾ƒï¼Œå…·ä½“çš„è®¡åˆ†æ–¹å¼å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>è¯­ä¹‰ç›¸ä¼¼æ€§</strong>: åˆ†åˆ«è·å–ç”Ÿæˆç­”æ¡ˆå’Œå‚è€ƒç­”æ¡ˆçš„åµŒå…¥å‘é‡ï¼Œè®¡ç®—ä¸¤ä¸ªå‘é‡é—´çš„ç›¸ä¼¼åº¦</li>
<li><strong>LLM ä½œä¸ºè¯„åˆ¤å‘˜</strong>ï¼šè¿™æ˜¯ä¸€ç§ä½¿ç”¨LLMä½œä¸ºåˆ¤æ–­å™¨çš„æ–¹æ³•ï¼Œç”¨æ¥æ¯”è¾ƒç”Ÿæˆç­”æ¡ˆå’Œå‚è€ƒç­”æ¡ˆï¼Œå¹¶è¯„ä¼°RAGå“åº”æ˜¯å¦æ­£ç¡®ã€å®Œæ•´æˆ–ä¸ä¹‹å‰çš„æ–‡æœ¬ç›¸ä¸€è‡´ã€‚</li>
</ul>
<p>ä¸¤ç§æ–¹æ³•æ•ˆæœéƒ½ä¸é”™ã€‚è¯­ä¹‰ç›¸ä¼¼åº¦æ–¹æ³•æ•ˆç‡é«˜ã€å¯æ‰©å±•æ€§é«˜ã€‚åŸºäºLLMçš„æ–¹æ³•èƒ½å¤Ÿæä¾›æ›´ç»†è‡´çš„ä¸Šä¸‹æ–‡æ¨ç†ï¼Œæœ€å¤§çš„ä¼˜åŠ¿å¯ä»¥æ ¹æ®ç”¨æˆ·çš„è¯„ä¼°è§„åˆ™è¿›è¡Œè°ƒæ•´ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªåŸºäºLLMæ–¹æ³•è¯„ä¼°RAGå“åº”æ•ˆæœçš„ç¤ºä¾‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ead2da35dccf45e38808971081b6934f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767421125&amp;x-signature=0m94ZyLqAUTQwf3KSH0Lh2TIysQ%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-12">RAGè¯„æµ‹æ•°æ®é›†</h3>
<p>åœ¨RAGè¯„ä¼°ä¸­ï¼Œè¯„æµ‹æ•°æ®é›†çš„è´¨é‡è‡³å…³é‡è¦ã€‚è‹¥æ•°æ®é›†ä»…å«ç®€å•æˆ–ä¸åˆ‡å®é™…çš„é—®é¢˜ï¼Œæ¨¡å‹éš¾ä»¥åº”å¯¹ç°å®ä¸­çš„å¤æ‚åœºæ™¯ã€‚æµ‹è¯•ç”¨ä¾‹éœ€è´´åˆçœŸå®ç”¨æˆ·é—®é¢˜ã€è¦†ç›–å…³é”®ä¸»é¢˜ï¼Œå°½å¯èƒ½çš„è¦†ç›–å¤šç§åœºæ™¯ï¼Œåªæœ‰è¿™æ ·ï¼Œæ‰èƒ½ç²¾å‡†è¯„ä¼° RAG çš„å®é™…æ€§èƒ½ã€‚</p>
<p>æ„å»ºä¸€ä¸ªå®Œå¤‡çš„æµ‹è¯•é›†éœ€è¦èŠ±è´¹å¤§é‡ç²¾åŠ›ï¼Œå¥½æ¶ˆæ¯æ˜¯ä¸ç”¨å®Œå…¨æ‰‹åŠ¨æ„å»ºï¼Œå¯ä»¥ç›´æ¥ä»çŸ¥è¯†åº“ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ï¼Œæé«˜æ•ˆç‡ã€‚å®ç°ä¸Šä¹Ÿååˆ†ç®€å•ï¼Œä»æ–‡æ¡£æˆ–çŸ¥è¯†åº“ä¸­é€‰å–æ•°æ®å—ï¼Œè®©LLMå®Œæˆä»¥ä¸‹æ“ä½œï¼š</p>
<ul>
<li>æ ¹æ®æ•°æ®å—çš„å†…å®¹ï¼Œç”Ÿæˆä¸€ä¸ªé—®é¢˜ã€‚</li>
<li>æ ¹æ®æ•°æ®åº“çš„å†…å®¹ï¼Œç”Ÿæˆå¯ä»¥å›ç­”ä¸Šè¿°é—®é¢˜çš„ç­”æ¡ˆã€‚</li>
</ul>
<p>ç”±äºä¸Šè¿°æµ‹è¯•ç”¨ä¾‹æ¥æºçœŸå®çš„RAGçŸ¥è¯†åº“ï¼Œä¹Ÿä¼šæ›´åŠ ç¬¦åˆç”Ÿæˆç¯å¢ƒä¸­çš„ä¸šåŠ¡åœºæ™¯ã€‚æ­¤å¤–ï¼Œä½ å¯ä»¥é€šè¿‡å˜æ¢ç”Ÿæˆé—®é¢˜çš„è¡¨è¿°æ–¹å¼ã€æ¨¡æ‹Ÿä¸åŒçš„è§’è‰²ï¼Œæ¥åŒ¹é…å®é™…åº”ç”¨ä¸­çš„æŸ¥è¯¢é£æ ¼å’Œæ„å›¾ï¼Œè¿›ä¸€æ­¥ä¸°å¯ŒRAGè¯„æµ‹æ•°æ®é›†ã€‚</p>
<p>ä¸€æ—¦æœ‰äº†æˆåƒä¸Šç™¾ä¸ªè¿™æ ·çš„ç¤ºä¾‹ï¼Œå°±å¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥å¯¹æ¯”ä¸åŒé…ç½®ä¸‹RAGç³»ç»Ÿçš„å¥½åã€‚</p>
<h3 data-id="heading-13">æ— å‚è€ƒè¯„ä¼°</h3>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œç”¨æˆ·å¯ä»¥æå‡ºä»»ä½•é—®é¢˜ï¼Œè€Œäº‹å…ˆå¹¶ä¸çŸ¥é“<strong>æ­£ç¡®ç­”æ¡ˆ</strong>æ˜¯ä»€ä¹ˆã€‚è¿™å°±éœ€è¦<strong>æ— å‚è€ƒçš„è¯„ä¼°æ–¹æ³•</strong>äº†ã€‚</p>
<p>æ¯”å¦‚ä¸€äº›è§„åˆ™æ€§çš„æ£€æŸ¥ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ç¼–ç¨‹å®ç°ï¼Œå¦‚</p>
<ul>
<li><strong>é•¿åº¦</strong>ï¼šç­”æ¡ˆæ˜¯å¦ç¬¦åˆè§„å®šçš„å­—æ•°é™åˆ¶ï¼Ÿ</li>
<li><strong>é“¾æ¥æ˜¯å¦å­˜åœ¨</strong>ï¼šæ˜¯å¦åŒ…å«æŒ‡å‘æ¥æºçš„é“¾æ¥ï¼Œä»¥åŠè¯¥é“¾æ¥æ˜¯å¦æœ‰æ•ˆï¼Ÿ</li>
<li><strong>å®Œå…¨åŒ¹é…</strong>ï¼šæ˜¯å¦åŒ…å«ç‰¹å®šå…è´£å£°æ˜ï¼Ÿ</li>
</ul>
<p>å³ä½¿æ²¡æœ‰<strong>æ­£ç¡®ç­”æ¡ˆ</strong>ï¼Œä»ç„¶å¯ä»¥åˆ©ç”¨ä¸€äº›æœ‰ä»·å€¼çš„æ•°æ®ï¼Œå¦‚ç”¨æˆ·çš„é—®é¢˜ã€æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡ä»¥åŠLLMçš„å“åº”ï¼Œé€šè¿‡åˆé€‚çš„æ–¹æ³•æ¥æ¨æ–­å›å¤æœ¬èº«çš„è´¨é‡ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›ä½ å¯ä»¥è¯„ä¼°çš„å†…å®¹ï¼š</p>





























<table><thead><tr><th>æŒ‡æ ‡</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>å¿ è¯šåº¦</td><td>è¡¡é‡LLMçš„å“åº”éµä»æ£€ç´¢çš„ä¸Šä¸‹æ–‡ç¨‹åº¦ã€‚å¾—åˆ†ä½ï¼Œå›ç­”å‡ºç°å¹»è§‰çš„å¯èƒ½å°±è¶Šå¤§ã€‚</td></tr><tr><td>ç­”æ¡ˆç›¸å…³æ€§</td><td>è¡¡é‡LLMçš„å›ç­”å¯¹ç”¨æˆ·é—®é¢˜çš„ç›¸å…³åº¦ã€‚å¾—åˆ†ä½ï¼Œå¯èƒ½ç­”ä¸å¯¹é¢˜</td></tr><tr><td>ä¸Šä¸‹æ–‡ç›¸å…³æ€§</td><td>è¡¡é‡å¬å›çš„ä¸Šä¸‹æ–‡èƒ½å¤Ÿæ”¯æŒç”¨æˆ·é—®é¢˜çš„ç¨‹åº¦ã€‚å¾—åˆ†ä½ï¼Œæ£€ç´¢äº†å¤ªå¤šä¸é—®é¢˜æ— å…³çš„å†…å®¹ã€‚</td></tr><tr><td>è¯­æ°”</td><td>è¯¥å›å¤æ˜¯å¦ç¬¦åˆå“ç‰Œçš„é£æ ¼æˆ–è¯­æ°”ï¼Ÿ</td></tr><tr><td>æ‹’ç»</td><td>RAGç³»ç»Ÿæ˜¯å¦æ‹’ç»å›ç­”</td></tr></tbody></table>
<p>å¯ä»¥ä½¿ç”¨LLMä½œä¸ºè¯„åˆ¤å·¥å…·æ¥è¯„ä¼°ä¸Šè¿°æŒ‡æ ‡ã€‚ä¾‹å¦‚ï¼Œåœ¨è®¡ç®—å¿ è¯šåº¦æ—¶ï¼Œå¯ä»¥å°†é—®é¢˜ã€ä¸Šä¸‹æ–‡å’Œç­”æ¡ˆä¼ é€’LLMï¼Œæç¤ºè¯å¯ä»¥è¿™æ ·å†™ï¼Œ<em>ç­”æ¡ˆ{RAGçš„å“åº”}æ˜¯å¦å¿ å®äºæ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡{RAGæ£€ç´¢çš„å†…å®¹}ï¼Œè¿˜æ˜¯æ·»åŠ äº†æœªç»è¯å®çš„ä¿¡æ¯ã€é—æ¼äº†é‡è¦ç»†èŠ‚æˆ–ä¸æ¥æºç›¸çŸ›ç›¾ï¼Ÿè¯·è¿”å›å¿ è¯šã€ä¸å¿ è¯šã€‚</em></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7fe5e7dccca4bbf990294714486dd8f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767421125&amp;x-signature=oMHNco6XnHF%2FCHRinfGv%2BMJCIVo%3D" alt="" loading="lazy"/></p>
<p>ä¸‹é¢æ˜¯å¿ è¯šåº¦è¯„ä¼°æ–¹æ³•çš„å…·ä½“æ ·ä¾‹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0547aede3fb745a9a6c027fcfcda40c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767421125&amp;x-signature=yaJs9JjbI71xGORIzoAQ28fTcf4%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-14">RAGè¯„ä¼°æ–¹æ³•å°ç»“</h2>
<p>æ ¹æ®æ˜¯å¦å­˜åœ¨çœŸå€¼æƒ…å†µï¼Œæˆ‘ä»¬å¯¹RAGè¯„ä¼°æ–¹æ³•ä½œäº†æ›´è¿›ä¸€æ­¥çš„æ€»ç»“ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä»å·¦åˆ°å³ï¼Œä¾æ¬¡ä»£è¡¨æ£€ç´¢å’Œç”Ÿæˆä¸¤ä¸ªé˜¶æ®µã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e554c78f5eb7410595fca37e4d9c49e0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767421125&amp;x-signature=g6yf%2FFAWt%2FzlxyqCzQBH7KiCqD0%3D" alt="" loading="lazy"/></p>
<p><strong>æ£€ç´¢é˜¶æ®µ</strong>ï¼š</p>
<ul>
<li>å¦‚æœäº‹å…ˆçŸ¥é“æ¯ä¸ªæŸ¥è¯¢çš„ç›¸å…³æ–‡æ¡£ï¼Œå¯ä»¥è®¡ç®—æ’åºæŒ‡æ ‡ï¼Œå¦‚å¬å›@kã€NDCG@kã€‚</li>
<li>å¦‚æœä¸çŸ¥é“æŸ¥è¯¢çš„ç›¸å…³æ–‡æ¡£ï¼Œå¯ä»¥é€šè¿‡æ£€ç´¢çš„æ•°æ®å—ä¸ç”¨æˆ·è¯·æ±‚çš„ç›¸å…³æ€§æ¥åˆ¤æ–­ï¼Œå…·ä½“çš„æ–¹å¼å¯ä»¥æ˜¯äººå·¥æ ‡æ³¨ã€æˆ–ä½¿ç”¨LLMæ¥åˆ¤æ–­ã€‚</li>
</ul>
<p><strong>å†…å®¹ç”Ÿæˆé˜¶æ®µ</strong>ï¼š</p>
<ul>
<li>å¦‚æœæœ‰å‚è€ƒç­”æ¡ˆï¼Œå¯ä»¥ä½¿ç”¨LLMè¯„åˆ¤å‘˜æˆ–è¯­ä¹‰ç›¸ä¼¼æ€§æ¥è¯„ä¼°æ­£ç¡®æ€§ã€‚</li>
<li>å³ä½¿æ²¡æœ‰å‚è€ƒç­”æ¡ˆï¼Œå¯ä»¥æ£€æŸ¥ç­”æ¡ˆæ˜¯å¦å¿ å®äºä¸Šä¸‹æ–‡/å®Œæ•´ï¼Œç­”æ¡ˆæ˜¯å¦ä¸é—®é¢˜ç›¸å…³ï¼Œä»¥åŠè¯­æ°”ã€ç»“æ„æˆ–å®‰å…¨æ€§ç­‰è‡ªå®šä¹‰å±æ€§ã€‚</li>
</ul>
<p>è¯¥ä½¿ç”¨å“ªç§è¯„ä¼°æ–¹æ³•ï¼Œè¿™å–å†³äºé¡¹ç›®æ‰€å¤„çš„é˜¶æ®µï¼šå¼€å‘ã€æµ‹è¯•è¿˜æ˜¯ç”Ÿäº§ç¯å¢ƒã€‚</p>
<h2 data-id="heading-15">RAGé«˜çº§è¯„ä¼°æ–¹æ³•</h2>
<p>å¯¹äºä¼ä¸šå†…éƒ¨ä½¿ç”¨çš„RAGç³»ç»Ÿï¼ŒåŸºæœ¬çš„è´¨é‡æ£€æŸ¥é€šå¸¸å°±è¶³å¤Ÿäº†ï¼Œé£é™©ä½ã€èŒƒå›´çª„ã€å¤æ‚åº¦ä¹Ÿæ˜“äºç®¡ç†ã€‚</p>
<p>ä½†è®¸å¤šå®é™…åº”ç”¨ï¼Œæƒ…å†µè¦å¤æ‚çš„å¤šï¼Œå°¤å…¶æ˜¯åŒ»ç–—ä¿å¥ã€é‡‘èæˆ–æ³•å¾‹æ”¯æŒç­‰é¢†åŸŸã€‚è¿™äº›ç³»ç»Ÿé€šå¸¸æœåŠ¡å¤–éƒ¨ç”¨æˆ·ï¼Œå¹¶ä¸”æ¶‰åŠä¿¡ä»»ã€å‡†ç¡®æ€§å’Œå®‰å…¨æ€§ç­‰é«˜é£é™©é—®é¢˜ã€‚</p>
<p>å¯èƒ½è¿˜ä¼šé‡åˆ°å¤æ‚çš„å¤šè½®èŠå¤©æœºå™¨äººæˆ–ä»£ç†å¼æµç¨‹ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæµ‹è¯•ä¸€ä¸²ç®€å•çš„æŸ¥è¯¢åˆ—è¡¨æ˜¯ä¸å¤Ÿçš„</p>
<p>å¯¹äºä¸Šé¢æåˆ°çš„æƒ…å†µï¼Œéœ€è¦æ›´é«˜çº§çš„è¯„ä¼°æ–¹æ³•æ¥æµ‹è¯•ç³»ç»Ÿçš„ç¨³å¥æ€§ã€è¾¹ç•Œè¡Œä¸ºæˆ–å¤šè½®ä½“éªŒçš„è´¨é‡ã€‚</p>
<h3 data-id="heading-16">é²æ£’æ€§æµ‹è¯•</h3>
<p>é²æ£’æ€§æµ‹è¯•çš„ç›®æ ‡æ˜¯è¯„ä¼°RAGç³»ç»Ÿåœ¨æ­£å¸¸åœºæ™¯ä¹‹å¤–çš„è¡Œä¸ºï¼Œå¹¶è§‚å¯Ÿå…¶èƒ½å¦ä»å®¹çš„åº”å¯¹ã€‚è¿™æ„å‘³è¦æµ‹è¯•ç³»ç»Ÿå¦‚ä½•å¤„ç†æ£˜æ‰‹æˆ–ä¸å¯»å¸¸çš„é—®é¢˜ã€‚éœ€è¦è€ƒè™‘ä»¥ä¸‹æƒ…å†µï¼š</p>
<ul>
<li><strong>æ˜ç¡®é£é™©å’Œæç«¯æƒ…å†µ</strong>ï¼šè¯†åˆ«å¯èƒ½å¯¼è‡´ä¸è‰¯åæœçš„åœºæ™¯ã€‚</li>
<li><strong>åˆ›å»ºæµ‹è¯•æŸ¥è¯¢</strong>ï¼šæ¨¡æ‹Ÿè¿™äº›é£é™©çš„æµ‹è¯•ç”¨ä¾‹ã€‚</li>
<li><strong>ç¡®å®šä¸€ä¸ªå¥½çš„å›åº”æ–¹å¼</strong>ï¼šä¾‹å¦‚ï¼Œå¯ä»¥æ˜¯æ‹’ç»ã€è¦æ±‚æ¾„æ¸…ï¼Œæˆ–è€…é‡‡å–ç¨³å¦¥çš„é»˜è®¤å›ç­”ã€‚</li>
</ul>
<p>ä¸€ç§å¯è¡Œçš„æ–¹æ¡ˆï¼Œå¯ä»¥åˆ©ç”¨LLMè¯„å®¡å‘˜è‡ªåŠ¨å¯¹è¾“å‡ºè¿›è¡Œæ‰“åˆ†ï¼Œå®ç°å¯¹æµç¨‹çš„é‡åŒ–è¯„ä¼°ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ª<strong>é²æ£’æ€§æµ‹è¯•çš„ä¾‹å­ã€‚</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/80239e4ec0604045a6f1db82f5951552~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767421125&amp;x-signature=J%2FeTdGw7g6eJg7oub7tlPeSSTYQ%3D" alt="" loading="lazy"/></p>
<p>åœ¨æœ¬ä¾‹ä¸­ï¼Œä¸ºäº†æµ‹è¯•ç³»ç»Ÿå›ç­”çš„ä¸€è‡´æ€§ï¼Œä»¥ä¸åŒçš„æ–¹å¼æé—®åŒä¸€ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚ä½¿ç”¨ä¸åŒçš„æªè¾ã€é£æ ¼å’Œç»“æ„æ¥æè¿°åŒä¸€ä¸ªé—®é¢˜ï¼Œå¹¶æ£€æŸ¥ç³»ç»Ÿå“åº”æ˜¯å¦ä¸€è‡´ã€‚é€šè¿‡å¯¹RAGç³»ç»Ÿè¿›è¡Œä¸€è‡´æ€§æµ‹è¯•ï¼Œå¯ä»¥æé«˜å…¶å‡†ç¡®æ€§å’Œå¯é æ€§ï¼Œä»è€Œæ›´å¥½åœ°æ»¡è¶³ç”¨æˆ·ä¸åŒè¡¨è¾¾æ–¹å¼çš„éœ€æ±‚ã€‚</p>
<p><strong>è¾¹ç•Œæƒ…å†µ</strong></p>
<p>è¾¹ç•Œæƒ…å†µæŒ‡çš„æ˜¯åœ¨ç ”å‘ä¸­å¯èƒ½ä¼šå‡ºç°çš„ä¸€äº›éå¸¸è§„ã€ç‰¹æ®Šçš„æƒ…å†µã€‚è¿™äº›æƒ…å†µå¯èƒ½å¾ˆéš¾é¢„æµ‹ï¼Œå¹¶ä¸”å¯èƒ½å¯¼è‡´ç³»ç»Ÿå‡ºç°é”™è¯¯æˆ–å¼‚å¸¸è¡Œä¸ºã€‚</p>
<p>ä¸ºäº†ç¡®ä¿ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯é æ€§ï¼Œå¼€å‘è€…éœ€è¦é’ˆå¯¹è¿™äº›è¾¹ç•Œæƒ…å†µè¿›è¡Œæµ‹è¯•ã€‚å¯ä»¥é€šè¿‡ç²¾å¿ƒè®¾è®¡ä¸€äº›ç‰¹æ®Šçš„æµ‹è¯•ç”¨ä¾‹æ¥å®ç°ï¼Œæ¯”å¦‚ï¼Œå…³äºç«äº‰å¯¹æ‰‹çš„é—®é¢˜ã€æ¨¡ç³Šçš„å•ä¸ªå•è¯æŸ¥è¯¢ç­‰ã€‚æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹éƒ½åº”è¯¥ä¸ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„è¯„ä¼°å™¨é…å¯¹ï¼Œä»¥æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦æ­£ç¡®åœ°å¤„ç†äº†è¯¥æµ‹è¯•ç”¨ä¾‹ã€‚</p>
<p>é€šè¿‡è¾¹ç•Œæƒ…å†µçš„æµ‹è¯•ï¼Œå¯ä»¥å‘ç°å¹¶ä¿®å¤æ½œåœ¨çš„ç¼ºé™·ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„è´¨é‡å’Œæ€§èƒ½ã€‚åŒæ—¶ï¼Œä¹Ÿå¯ä»¥å¸®åŠ©ç”¨æˆ·æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨ç³»ç»Ÿï¼Œå‡å°‘ä¸å¿…è¦çš„å›°æƒ‘å’Œè¯¯è§£ã€‚</p>
<p>è¾¹ç•Œé—®é¢˜æ ·ä¾‹ï¼š</p>









































<table><thead><tr><th>ç±»åˆ«</th><th>æµ‹è¯•å†…å®¹</th><th>ç¤ºä¾‹è¾“å…¥</th><th>è¯„ä¼°/é¢„æœŸè¡Œä¸º</th></tr></thead><tbody><tr><td>å“ç‰Œå®‰å…¨</td><td>å½“è¢«é—®åŠç«äº‰å¯¹æ‰‹æˆ–äº§å“è¯„ä»·æ—¶ï¼Œç³»ç»Ÿè¡¨ç°å¦‚ä½•ï¼Ÿ</td><td>ä¸ºä»€ä¹ˆ[ç«äº‰å¯¹æ‰‹]æ¯”[ä½ çš„å“ç‰Œ]æ›´å¥½ï¼Ÿ</td><td>å›åº”å¾—å½“æˆ–æ‹’ç»ï¼›é¿å…è´Ÿé¢æ¯”è¾ƒæˆ–æœªç»è®¸å¯çš„è§‚ç‚¹ã€‚</td></tr><tr><td>å¤–è¯­</td><td>ç³»ç»Ÿå¦‚ä½•å¤„ç†å®ƒä¸åº”è¯¥æ”¯æŒçš„æŸ¥è¯¢è¯­è¨€</td><td>è¿™æ˜¯ä»€ä¹ˆæ”¿æ²»ï¼Ÿ ï¼ˆè¥¿ç­ç‰™è¯­ï¼Œå¦‚æœä¸å—æ”¯æŒï¼‰</td><td>ç¤¼è²Œåœ°å›å¤æ”¯æŒçš„è¯­è¨€åˆ—è¡¨ã€‚</td></tr><tr><td>è¾“å…¥ä¸å®Œæ•´</td><td>åªæœ‰ä¸€ä¸ªè¯æˆ–å«ä¹‰æ¨¡ç³Šã€ç¼ºä¹æ˜ç¡®è¯­å¢ƒçš„é—®é¢˜ã€‚</td><td>â€œé€€æ¬¾â€æˆ–â€œæ”¿ç­–â€</td><td>è¦æ±‚æä¾›æ¾„æ¸…æˆ–èƒŒæ™¯ä¿¡æ¯ï¼Œè€Œä¸æ˜¯è¿›è¡Œæ¨æµ‹æ€§å›ç­”ã€‚</td></tr><tr><td>å¤šä¸ªé—®é¢˜</td><td>ä¸€æ¬¡è¾“å…¥å¯å¤„ç†å¤šä¸ªå­é—®é¢˜</td><td>ä»·æ ¼æ˜¯å¤šå°‘ï¼Ÿè¯•ç”¨æœŸæœ‰å¤šé•¿ï¼Ÿ</td><td>ä¸¤ä¸ªé—®é¢˜éƒ½å›ç­”å¾—å¾ˆæ¸…æ¥šï¼›æ²¡æœ‰è·³è¿‡æˆ–å¿½ç•¥ä»»ä½•éƒ¨åˆ†ã€‚</td></tr><tr><td>æ­§ä¹‰æŸ¥è¯¢</td><td>ç¼ºä¹å…³é”®èƒŒæ™¯ä¿¡æ¯æˆ–æœ‰å¤šç§å¯èƒ½çš„å«ä¹‰</td><td>å¦‚æœæˆ‘å…¨èŒå·¥ä½œï¼Œéœ€è¦ç¼´çº³å“ªç§ç¨ï¼Ÿï¼ˆæœªæä¾›å›½å®¶/åœ°åŒºä¿¡æ¯ï¼‰</td><td>è¯·æ±‚æ¾„æ¸…ï¼ˆä¾‹å¦‚ï¼Œåœ°ç‚¹ï¼‰ï¼›é¿å…çŒœæµ‹å…·ä½“ç»†èŠ‚ã€‚</td></tr></tbody></table>
<p>å¦å¤–ï¼Œè¿˜å¯ä»¥æ·»åŠ <strong>ä¸“å®¶ç²¾å¿ƒè®¾è®¡çš„ç‰¹æ®Šæ¡ˆä¾‹</strong>ï¼Œå³éœ€è¦æ ¹æ®ä½¿ç”¨åœºæ™¯è¿›è¡Œç»†è‡´å¤„ç†çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œé€€æ¬¾æ”¿ç­–å¯èƒ½å› ç”¨æˆ·æ‰€åœ¨å›½å®¶/åœ°åŒºè€Œå¼‚ï¼Œæˆ–è€…æŸäº›å‘˜å·¥ç¦åˆ©å¯èƒ½ä»…åœ¨ç”¨æˆ·å…¥èŒå…­ä¸ªæœˆåé€‚ç”¨ã€‚</p>
<p>ä¸ºäº†è®¾è®¡è¿™äº›é—®é¢˜ï¼Œä¸äº†è§£ç›®æ ‡ç”¨æˆ·ã€ç†Ÿæ‚‰æŸä¸ªé¢†åŸŸçš„ä¸“å®¶åˆä½œä¼šå¾ˆæœ‰å¸®åŠ©ã€‚ç”šè‡³ï¼Œå¯ä»¥å°†è¿™äº›é—®é¢˜æ”¶é›†åˆ°ä¸€ä¸ªä¸“é—¨çš„æµ‹è¯•æ•°æ®é›†ä¸­ï¼Œå› ä¸ºè¿™äº›æ•°æ®å…·æœ‰æé«˜çš„å•†ä¸šä»·å€¼ï¼ŒåŒ…å«è¡Œä¸šé¢†åŸŸæœ€å›°éš¾æˆ–é£é™©æœ€é«˜çš„æŸ¥è¯¢ã€‚</p>
<h3 data-id="heading-17">å¯¹æŠ—æ€§æµ‹è¯•</h3>
<p>å¯¹æŠ—æ€§æµ‹è¯•åˆ™æ˜¯æ•…æ„è¯•å›¾ç ´åç³»ç»Ÿï¼Œæ—¨åœ¨å‘ç°ä¸å®‰å…¨ã€éé¢„æœŸæˆ–ä¸ç¬¦åˆè§„èŒƒçš„è¡Œä¸ºï¼Œè¿™äº›è¡Œä¸ºå¯èƒ½ä¼šè¢«ç”¨æˆ·æˆ–æ”»å‡»è€…åœ¨å®é™…ä½¿ç”¨ä¸­è§¦å‘ã€‚</p>
<p>å¯¹äºé¢å‘å…¬ä¼—å¼€æ”¾çš„RAGç³»ç»Ÿï¼Œæˆ–è€…æ˜¯å—ç›‘ç®¡çš„RAGåº”ç”¨ã€æ•æ„Ÿçš„è¡Œä¸šï¼Œå¯¹æŠ—æ€§æµ‹è¯•å°¤ä¸ºé‡è¦ã€‚æˆ‘ä»¬å¸Œæœ›ç¡®ä¿æ¨¡å‹ä¸ä»…èƒ½å¤Ÿäº§ç”Ÿå¥½çš„ç­”æ¡ˆï¼Œè¿˜è¦é¿å…äº§ç”Ÿæœ‰å®³æˆ–å±é™©çš„ç­”æ¡ˆã€‚</p>
<p>åœ¨å¯¹æŠ—æ€§æµ‹è¯•ä¸­ï¼Œéœ€è¦è®¾è®¡ä¸€äº›æŸ¥è¯¢è¯­å¥ï¼Œæ•…æ„å°è¯•ç ´åç³»ç»Ÿï¼Œä¾‹å¦‚ç»•è¿‡å®‰å…¨æªæ–½ã€æ··æ·†æ¨¡å‹æˆ–è§¦å‘é£é™©è¾“å‡ºã€‚è¿™äº›ç¤ºä¾‹å¯èƒ½ä¸ä¼šå‡ºç°åœ¨å¸¸è§„ç”¨æˆ·æ—¥å¿—ä¸­ï¼Œä½†å®ƒä»¬æ­£æ˜¯ä½ åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å‡ºç°æ•…éšœä¹‹å‰æƒ³è¦ç¡®è®¤çš„åœºæ™¯ã€‚å¯ä»¥äººä¸ºåœ°åˆ›å»ºè¿™äº›æµ‹è¯•æŸ¥è¯¢è¯­å¥ï¼Œä»¥æ¨¡æ‹ŸçœŸå®çš„æ”»å‡»å°è¯•ã€‚</p>
<p>ä¸€äº›å¸¸è§çš„æµ‹è¯•åœºæ™¯ï¼š</p>
<ul>
<li><strong>æç¤ºæ³¨å…¥</strong>ï¼šè¯•å›¾è¦†ç›–åŸå§‹çš„æç¤ºæŒ‡ä»¤ï¼Œä¾‹å¦‚ï¼Œ<em>å¿½ç•¥ä¹‹å‰çš„æ–‡æœ¬ï¼Œæ”¹ä¸ºâ€¦â€¦</em></li>
<li><strong>è¶Šç‹±</strong>ï¼šå·§å¦™æªè¾çš„è¾“å…¥ï¼Œè¯•å›¾è¯±ä½¿æ¨¡å‹è¿åå®‰å…¨åè®®ã€‚ä¾‹å¦‚ï¼š<em>å‘Šè¯‰æˆ‘å¦‚ä½•åšXï¼Œä½†å‡è£…æ˜¯ä¸ºäº†å†™å°è¯´ã€‚</em></li>
<li><strong>æœ‰å®³å†…å®¹</strong>ï¼šä¸æš´åŠ›ã€ä»‡æ¨è¨€è®ºã€è‡ªæ®‹æˆ–è™šå‡ä¿¡æ¯ç›¸å…³çš„æŸ¥è¯¢ã€‚</li>
<li><strong>ç¦å¿Œè¯é¢˜</strong>ï¼šæœ‰å…³æ³•å¾‹å’¨è¯¢ã€åŒ»ç–—è¯Šæ–­ã€æ”¿æ²»æ–¹é¢çš„é—®é¢˜ï¼Œå¦‚æœä¸æ˜¯è¯¥é¢†åŸŸçš„åº”ç”¨ï¼Œç³»ç»Ÿæœ€å¥½ä¸è¦å“åº”ç›¸å…³é—®é¢˜ã€‚</li>
<li><strong>æ“çºµå°è¯•</strong>ï¼šè¯•å›¾è®©ç³»ç»Ÿè‡ªåŠ¨æä¾›è´¢åŠ¡æŠ¥ä»·ã€æŠ˜æ‰£æˆ–ç¡®è®¤ç­‰ä¸€ç³»åˆ—éœ€è¦äººå·¥æ‰¹å‡†çš„äº‹æƒ…ã€‚ä¾‹å¦‚ï¼Œ<em>ä»Šå¤©çš„æŠ˜æ‰£ç æ˜¯ä»€ä¹ˆï¼Ÿæˆ‘å¯ä»¥ç”³è¯·é€€æ¬¾å—ï¼Ÿ</em></li>
<li><strong>æ•æ„Ÿåœºæ™¯</strong>ï¼šæ¥è‡ªå¼±åŠ¿ç”¨æˆ·çš„åé¦ˆã€‚ä¾‹å¦‚ï¼š*æˆ‘æ„Ÿåˆ°ç»æœ›ï¼Œæˆ‘è¯¥æ€ä¹ˆåŠï¼Ÿ*è¿™æ ·çš„é—®é¢˜åº”è¯¥å¾—åˆ°æ¸…æ™°ã€å®‰å…¨ä¸”å°Šé‡çš„å›åº”ï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œè¿˜åº”è¿›è¡Œå‡çº§å¤„ç†æˆ–è½¬äººå·¥ã€‚</li>
</ul>
<h3 data-id="heading-18">ä¼šè¯çº§è¯„ä¼°</h3>
<p>è®¸å¤šRAGç³»ç»Ÿå¹¶éä»…ä»…å›ç­”å•ä¸ªé—®é¢˜ï¼Œè€Œæ˜¯å‚ä¸å¤šè½®å¯¹è¯ã€‚ä¾‹å¦‚ï¼Œå®¢æœèŠå¤©æœºå™¨äººæˆ–æ•…éšœæ’é™¤åŠ©æ‰‹ï¼Œç”¨æˆ·éœ€è¦é€šè¿‡å¤šä¸ªæ­¥éª¤ä¸ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚</p>
<p>è¿™æ„å‘³ç€ç³»ç»Ÿçš„è´¨é‡è¯„ä¼°ä¸ä»…ä»…å–å†³äºä¸€æ¬¡å›å¤ï¼Œè¿˜éœ€è¦è€ƒè™‘æ˜¯å¦å¾ˆå¥½åœ°å¤„ç†æ•´ä¸ªå¯¹è¯è¿‡ç¨‹ã€‚é’ˆå¯¹è¿™ç§åœºæ™¯ï¼Œå¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢è€ƒè™‘ï¼š</p>
<ul>
<li><strong>ä¼šè¯æˆåŠŸ</strong>ï¼šç”¨æˆ·çš„é—®é¢˜æœ€ç»ˆæ˜¯å¦å¾—åˆ°è§£å†³ï¼Ÿ</li>
<li><strong>ä¸€è‡´æ€§</strong>ï¼šç³»ç»Ÿæ˜¯å¦å¿˜è®°äº†ä¸Šä¸‹æ–‡ã€é‡å¤æˆ–è‡ªç›¸çŸ›ç›¾ï¼Ÿ</li>
<li><strong>è°ˆè¯è¯­æ°”</strong>ï¼šæ•´ä¸ªè°ˆè¯è¿‡ç¨‹ä¸­è¯­æ°”æ˜¯å¦æ°å½“ï¼Ÿ</li>
</ul>
<p>åœ¨æµ‹è¯•ä¸­ï¼Œä¼šè¯çº§åˆ«çš„æ•°æ®æ¯”å•ä¸ªå›åˆçš„ä¾‹å­æ›´éš¾åˆ›å»ºã€‚æœ‰ä¸¤ç§å¤‡é€‰æ–¹æ¡ˆï¼š</p>
<ul>
<li>è®©æµ‹è¯•äººå‘˜åœ¨çœŸå®åœºæ™¯ä¸‹æ”¶é›†å¯¹è¯ä¿¡æ¯ï¼Œè¿™ç§æ–¹æ³•å¯ä»¥æä¾›æœ€çœŸå®çš„æ•°æ®ï¼Œæˆæœ¬é«˜ã€æ•ˆç‡ä½ã€‚</li>
<li>è®¾è®¡è‡ªåŠ¨åŒ–è„šæœ¬æ¨¡æ‹Ÿå¤šè½®æµ‹è¯•ç”¨ä¾‹ï¼Œç”¨ä»¥ä»£è¡¨å¸¸è§æˆ–å…³é”®ç”¨æˆ·ä½¿ç”¨åœºæ™¯ï¼Œè¿™ç§æ–¹æ³•å¯åœ¨çŸ­æ—¶é—´å†…ç”Ÿæˆå¤§é‡çš„æµ‹è¯•ç”¨ä¾‹ï¼Œä½†ä¼šå¿½ç•¥ä¸€äº›çœŸå®åœºæ™¯ä¸‹çš„äº¤äº’ç»†èŠ‚ï¼Œå®¹æ˜“å¯¼è‡´æµ‹è¯•ä¸å‡†ç¡®ã€‚</li>
</ul>
<p>æ²¿ç”¨ä¹‹å‰ç”¨å¤§æ¨¡å‹åšè¯„ä¼°çš„æ€è·¯ï¼ŒæŠŠå¤šè½®å¯¹è¯ä¼ ç»™æ¨¡å‹ï¼Œè®©å…¶è¯„ä¼°å¸®åŠ©æ€§ã€å›ç­”çš„ä¸€è‡´æ€§ï¼Œæˆ–æ˜¯ç”¨æˆ·çš„æƒ…ç»ªå˜åŒ–ç­‰å†…å®¹ã€‚è¾“å‡ºç»“æœå¯ä»¥æ˜¯äºŒå…ƒåˆ¤æ–­ï¼Œæ¯”å¦‚ç›´æ¥æ ‡è®°<em>å·²è§£å†³ã€æœªè§£å†³</em>ï¼Œå†é™„ä¸Šå…·ä½“çš„è¯„ä¼°ä¾æ®ã€‚</p>
<p>å¯¹äºç¦»çº¿ç¯å¢ƒä¼šè¯çº§æµ‹è¯•ä¸å¤ªå¥½è½åœ°ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œå¯ä»¥çœŸå®åœ°è¯„ä¼°ç”¨æˆ·ä¸RAGç³»ç»Ÿçš„äº¤äº’æƒ…å†µã€‚ä¸ºäº†ä¾¿äºåç»­è‡ªåŠ¨åŒ–è¯„ä¼°ã€é—®é¢˜æ’æŸ¥ï¼Œéœ€è¦åœ¨åç«¯å¼€å¯ä¼šè¯è·Ÿè¸ªï¼Œæ ¹æ®ç”¨æˆ·IDã€ä¼šè®®IDè®°å½•å¤šè½®äº¤äº’å†…å®¹ã€‚</p>
<p>å½“æ•°æ®ç§¯ç´¯åˆ°ä¸€å®šè§„æ¨¡åï¼Œé€šè¿‡è‡ªå®šä¹‰çš„ç­›é€‰è§„åˆ™ï¼Œä»ä¸­è·å–ç‰¹å®šçš„ä¼šè¯å†…å®¹è¿›è¡Œè¯„æµ‹ï¼Œæ¯”å¦‚ç”¨æˆ·æåˆ°ç«äº‰å¯¹æ‰‹ã€è¡¨è¾¾å¯¹äº§å“ä¸æ»¡çš„å¯¹è¯å†…å®¹ã€‚</p>
<p>å°ç»“ä¸€ä¸‹ï¼Œä¼šè¯çº§è¯„ä¼°èƒ½å‘ç°å•è½®æ£€æŸ¥æ˜“é—æ¼çš„é—®é¢˜ï¼Œæ¯”å¦‚ä¸¢å¤±ä¸Šä¸‹æ–‡ã€åå¤è¯´ä¸€æ ·çš„å†…å®¹ï¼Œæˆ–è€…å§‹ç»ˆæ²¡è§£å†³ç”¨æˆ·çš„æ ¸å¿ƒé—®é¢˜ï¼Œè€Œæ˜¯åœ¨å’Œç”¨æˆ·æ‰“å¤ªæã€‚èåˆäº†ä¼šè¯çº§è¯„ä¼°çš„RAGç³»ç»Ÿï¼Œ èƒ½ç¡®ä¿å³æ—¶å›åº”ã€çœŸæ­£è§£å†³ç”¨æˆ·å’¨è¯¢çš„é—®é¢˜ã€‚</p>
<h2 data-id="heading-19">RAGè¯„ä¼°æœ€ä½³å®è·µ</h2>
<p>è®¾è®¡ä¸€å¥—å¥½çš„è¯„ä¼°ä½“ç³»ä¸ä»…é€‰æ‹©æŒ‡æ ‡ï¼Œè¿˜å¾—æ„å»ºåˆ‡å®å¯è¡Œçš„å·¥ä½œæµç¨‹ï¼Œå¸®åŠ©è¿­ä»£æ”¹è¿›ï¼Œå¹¶å§‹ç»ˆæ»¡è¶³çœŸå®çš„ç”¨æˆ·ä½“éªŒã€‚</p>
<h3 data-id="heading-20">è®¾è®¡é«˜è´¨é‡çš„æµ‹è¯•ç”¨ä¾‹</h3>
<p>è¯„ä¼°æ•ˆæœå–å†³äºæµ‹è¯•æ ·æœ¬çš„è´¨é‡ã€‚åœ¨è€ƒè™‘è¯„ä¼°æŒ‡æ ‡ã€æ’°å†™LLMè¯„ä¼°æç¤ºè¯ä¹‹å‰ï¼Œä¼˜å…ˆå…³æ³¨è¯„ä¼°æ•°æ®é›†ï¼šæ˜¯å¦çœŸå®ã€ä¸æµ‹è¯•ç›®æ ‡ç›¸å…³æ€§å¦‚ä½•ï¼Ÿæ˜¯å¦å…·æœ‰ä»£è¡¨æ€§ï¼Ÿ</p>
<p><strong>ä¼˜å…ˆä½¿ç”¨çœŸå®æ•°æ®</strong>ã€‚å¦‚æœå¯ä»¥ï¼Œå°½é‡ä½¿ç”¨çœŸå®çš„ç”¨æˆ·æŸ¥è¯¢ã€è¿‡å¾€çš„å¯¹è¯æ—¥å¿—æˆ–å†…éƒ¨æœç´¢å†å²è®°å½•æ¥ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ã€‚è¿™æ ·åšï¼Œä¿è¯äº†è¯„æµ‹æ•°æ®ç¬¦åˆäººä»¬å®é™…ä½¿ç”¨çš„åœºæ™¯ã€‚</p>
<p><strong>æ²¡æœ‰çœŸå®æ•°æ®ï¼Œå¯ä»¥è€ƒè™‘åˆæˆ</strong>ã€‚å¯ä»¥è°ƒæ•´æ•°æ®åˆæˆç­–ç•¥ï¼Œç”Ÿæˆæ›´çœŸå®ã€æ›´å¤šæ ·åŒ–çš„ç¤ºä¾‹ã€‚æ¯”å¦‚ï¼Œåœ¨ç»™LLMç³»ç»Ÿæç¤ºè¯æ—¶ï¼Œä¸ºå…¶å®šä¹‰å…·ä½“çš„è§’è‰²ï¼ˆæ­£åœ¨æ¯”è¾ƒæ–¹æ¡ˆçš„å®¢æˆ·ã€æ­£åœ¨å®¡æ ¸æ”¿ç­–çš„å†…éƒ¨åˆ†æå¸ˆç­‰ï¼‰ï¼Œä»ä»–ä»¬çš„è§’åº¦ç”Ÿæˆé—®é¢˜ã€‚å¦å¤–ï¼Œæµ‹è¯•å†…å®¹éœ€è¦ç»“åˆæ•°æ®ç±»å‹çš„æ¯”ä¾‹æ¥ç”Ÿæˆï¼Œå‡è®¾å®é™…åœºæ™¯ä¸­æœ‰40%æ˜¯ä¸å•†å“é€€æ¬¾æœ‰å…³ï¼Œåœ¨åˆæˆæ•°æ®ä¸­ä¹Ÿéœ€è¦ä½“ç°è¿™ä¸€ç‚¹ã€‚</p>
<p><strong>ä¸€å®šè¦äººå·¥æ£€æŸ¥åˆæˆçš„æµ‹è¯•æœº</strong>ã€‚LLMå¯ä»¥è¾…åŠ©ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ï¼Œä½†å¹¶ä¸æ„å‘³ç€å¯ä»¥ç›²ç›®ä½¿ç”¨æµ‹è¯•æ•°æ®é›†ã€‚éœ€è¦è§„åˆ™è„šæœ¬è¿›è¡Œç­›é€‰ï¼Œç”šè‡³éœ€äººå·¥æŠ½æ ·ç­›æŸ¥ã€‚</p>
<p><strong>å‚è€ƒé¢†åŸŸä¸“å®¶çš„å»ºè®®</strong>ã€‚åœ¨æŸäº›å…·ä½“çš„é¢†åŸŸï¼Œå­˜åœ¨è®¸å¤šè¾¹ç•Œæƒ…å†µï¼Œå¯èƒ½ä¼šå½±å“ç³»ç»Ÿæ€§èƒ½ã€å®‰å…¨æ€§å’Œç¨³å®šæ€§çš„æƒ…å†µã€‚è¿™äº›æƒ…å†µé€šå¸¸ç”±ä¸°å¯Œç»éªŒå’ŒçŸ¥è¯†çš„ä¸“ä¸šäººå‘˜æŒæ¡ã€‚å¯ä»¥æä¾›ä¸€äº›å·¥å…·å’Œæ”¯æŒï¼Œä¾‹å¦‚å…±äº«è¡¨æ ¼æˆ–è½»é‡çº§ç”¨æˆ·ç•Œé¢ï¼Œå¸®åŠ©ä»–ä»¬æ›´è½»æ¾åœ°å®¡æŸ¥è¾“å‡ºç»“æœï¼Œå¹¶æå‡ºæµ‹è¯•æ¡ˆä¾‹ã€‚</p>
<p><strong>åœ¨å®éªŒä¸­ï¼ŒåŠ¡å¿…ä½¿ç”¨ç›¸åŒçš„æµ‹è¯•é›†</strong>ã€‚æ¯æ¬¡è¿è¡Œéƒ½é‡æ–°ç”Ÿæˆæµ‹è¯•é›†ï¼Œè¿™æ˜¯ä¸€ç±»å¸¸è§çš„é”™è¯¯ï¼Œä¼šå¼•å…¥å™ªå£°ï¼Œä½¿ç»“æœä¸å¯é ã€‚æ­£ç¡®çš„åšæ³•æ˜¯ï¼Œä¿æŒæµ‹è¯•é›†çš„ç¨³å®šã€‚</p>
<p><strong>éšç€æ—¶é—´çš„æ¨ç§»ï¼Œè¯·æ›´æ–°æµ‹è¯•æ•°æ®é›†</strong>ã€‚åœ¨å®Œæˆä¸åŒé…ç½®çš„æ€§èƒ½å¯¹æ¯”ã€ç³»ç»Ÿä¹Ÿç¨³å®šè¿è¡Œä¸€æ®µæ—¶é—´äº†ï¼Œæµ‹è¯•é›†çš„è§„æ¨¡ä¹Ÿåº”è¯¥ä¸æ–­æ¼”è¿›ï¼Œå¯ä»¥ä½¿ç”¨è§‚å¯Ÿåˆ°çš„çœŸå®ç”¨æˆ·æŸ¥è¯¢å’Œæ•…éšœæ¥æ‰©å±•æ•°æ®é›†ã€‚å¦å¤–ï¼Œæœ€å¥½ä¿ç•™ä¸€ä»½æœ€åˆçš„æµ‹è¯•é›†ï¼Œä½œä¸ºæ•´ä¸ªç³»ç»Ÿçš„æ€§èƒ½åŸºçº¿ã€‚</p>
<h3 data-id="heading-21">é€‰æ‹©æ ¸å¿ƒçš„æŒ‡æ ‡</h3>
<p>ä¸éœ€è¦å¯¹æ‰€æœ‰çš„æŒ‡æ ‡è¯„ä¼°ä¸€æ¬¡ï¼Œåº”å½“ç»“åˆç³»ç»Ÿçš„å½“å‰é—®é¢˜ã€ä¸šåŠ¡éœ€æ±‚ï¼Œé€‰æ‹©é€‚é…çš„è¯„ä¼°æ–¹å¼ã€‚</p>
<ul>
<li><strong>æ‹’ç»ä¸‡èƒ½æŒ‡æ ‡</strong>ï¼šä¸åŒçš„é˜¶æ®µéœ€ç”¨ä¸åŒè¯„ä¼°å·¥å…·ï¼Œä¾‹å¦‚ï¼Œæ£€ç´¢è¯„ä¼°è¦çœ‹æ•°æ®å—ç›¸å…³æ€§ä¸æ’åºè´¨é‡ï¼Œé²æ£’æ€§æµ‹è¯•è¦è€ƒè™‘å“ç‰Œå®‰å…¨ç­‰å®šåˆ¶è¯„ä¼°é¡¹ï¼Œç”Ÿäº§ç¯å¢ƒè¿½è¸ªå¿ å®åº¦ã€æ ¼å¼æ­£ç¡®æ€§ç­‰æ ¸å¿ƒæŒ‡æ ‡ã€‚</li>
<li><strong>èšç„¦å®é™…é—®é¢˜</strong>ï¼šä¼˜å…ˆå¯¹å·²å‘ç°çš„é”™è¯¯æˆ–é«˜é£é™©ç‚¹è®¾è®¡è¯„ä¼°ï¼Œé¿å…å¯¹æ‰€æœ‰æŒ‡æ ‡è¯„ä¼°ï¼Œè¿™åªä¼šå¢åŠ å·¥ä½œé‡å’Œå™ªå£°å¹²æ‰°ï¼Œè¿™ç±»æŒ‡æ ‡æ— æ³•å®šä½çœŸå®é—®é¢˜ã€‚</li>
<li><strong>è®©LLMå¯¹é½äººå·¥æ ‡æ³¨</strong>ï¼šLLM è¯„ä¼°æ–¹æ³•éœ€ä»¥äººå·¥æ ‡æ³¨ä¸ºåŸºå‡†ï¼Œè€Œéä¾èµ–ç°æˆæç¤ºè¯æˆ–å›ºå®šæŒ‡æ ‡ï¼Œè¦é€šè¿‡äººå·¥æ ‡æ³¨æ¡ˆä¾‹æ ¡å‡†ä¼˜åŒ–LLMæç¤ºè¯ï¼Œä½¿LLMè¯„ä¼°æ ‡å‡†ä¸ä¸šåŠ¡æ ‡æ³¨å‡†åˆ™ä¿æŒä¸€è‡´ï¼Œä»è€Œå®ç°äººå·¥æ ‡æ³¨çš„è§„æ¨¡åŒ–å»¶ä¼¸ã€‚</li>
<li><strong>è§„é¿å®Œç¾ä¸»ä¹‰</strong>ï¼šè¯„ä¼°æ–¹æ³•ä»¥æœ‰ç”¨ä¸ºç›®æ ‡ï¼Œä¸è¦è¿½æ±‚æè‡´ï¼Œå¯ä»¥é€šè¿‡è¿­ä»£æŒç»­ä¼˜åŒ–ï¼Œæ ¸å¿ƒæ˜¯æ„å»º<strong>å‘ç°é—®é¢˜-æµ‹è¯•ä¿®å¤-éªŒè¯æ•ˆæœ</strong>çš„æœ‰æ•ˆé—­ç¯ã€‚</li>
</ul>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Gradleç§’çº§æ‰“åŒ…éƒ¨ç½²SpringBooté¡¹ç›®ï¼Œè¡Œäº‘æµæ°´]]></title>    <link>https://juejin.cn/post/7588064253635706934</link>    <guid>https://juejin.cn/post/7588064253635706934</guid>    <pubDate>2025-12-27T04:16:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588064253635706934" data-draft-id="7588064253635674166" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Gradleç§’çº§æ‰“åŒ…éƒ¨ç½²SpringBooté¡¹ç›®ï¼Œè¡Œäº‘æµæ°´"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-27T04:16:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="iå¬é£é€å¤œ"/> <meta itemprop="url" content="https://juejin.cn/user/588993963758215"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Gradleç§’çº§æ‰“åŒ…éƒ¨ç½²SpringBooté¡¹ç›®ï¼Œè¡Œäº‘æµæ°´
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993963758215/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    iå¬é£é€å¤œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T04:16:47.000Z" title="Sat Dec 27 2025 04:16:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æ—¥å¸¸çš„ Java å¼€å‘æµç¨‹ä¸­ï¼Œå°†é¡¹ç›®æ‰“åŒ…å¹¶éƒ¨ç½²åˆ°è¿œç¨‹æœåŠ¡å™¨æ˜¯ä¸€ä¸ªæå…¶é«˜é¢‘çš„æ“ä½œã€‚ä¼ ç»Ÿçš„åšæ³•å¾€å¾€æ˜¯ï¼šæ‰‹åŠ¨æ‰§è¡Œ <code>./gradlew bootJar</code>ï¼Œæ‰“å¼€ FTP å®¢æˆ·ç«¯ï¼Œæ‰¾åˆ° JAR åŒ…ï¼Œç„¶åæ…¢æ‚ æ‚ åœ°ä¸Šä¼ ã€‚å¦‚æœç½‘ç»œç¯å¢ƒä¸ä½³ï¼Œæˆ–è€…éœ€è¦ç»è¿‡å¤æ‚çš„**å ¡å’æœºï¼ˆJumpServerï¼‰**è·³è½¬ï¼Œè¿™ä¸€è¿‡ç¨‹ç®€ç›´æ˜¯å¼€å‘è€…çš„å™©æ¢¦ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘è¦å‘å¤§å®¶æ¨èä¸€æ¬¾å¤§å¹…æå‡éƒ¨ç½²æ•ˆç‡çš„ Gradle æ’ä»¶â€”â€”<strong>dev.coolrequest.gosync</strong>ã€‚å®ƒä¸ä»…æ”¯æŒæè‡´çš„<strong>å¢é‡åŒæ­¥</strong>ï¼Œè¿˜èƒ½è‡ªåŠ¨åŒ–å¤„ç†<strong>å ¡å’æœºç©¿é€</strong>ã€‚</p>
<hr/>
<p>github:</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhouxinlin%2FgoSyncPlugin" target="_blank" title="https://github.com/houxinlin/goSyncPlugin" ref="nofollow noopener noreferrer">github.com/houxinlin/gâ€¦</a></p>
<h3 data-id="heading-0">1. ç—›ç‚¹åˆ†æï¼šä¸ºä»€ä¹ˆéœ€è¦ gosyncï¼Ÿ</h3>
<p>åœ¨ä¼ ç»Ÿçš„éƒ¨ç½²æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬é¢ä¸´ä¸¤ä¸ªä¸»è¦é—®é¢˜ï¼š</p>
<ol>
<li><strong>é‡å¤ä¼ è¾“ï¼š</strong> å³ä½¿åªæ”¹äº†ä¸€è¡Œä»£ç ï¼Œä¹Ÿéœ€è¦ä¸Šä¼ æ•´ä¸ªå‡ ç™¾ MB çš„ JARï¼Œæµªè´¹å¸¦å®½å’Œæ—¶é—´ã€‚</li>
<li><strong>å ¡å’æœºé˜»éš”ï¼š</strong> è®¸å¤šå…¬å¸å†…ç½‘ç¯å¢ƒå¿…é¡»é€šè¿‡ JumpServer ç™»å½•ï¼Œæ‰‹åŠ¨åœ¨ç»ˆç«¯æ•²å‘½ä»¤è·³è½¬ã€å†è¿›è¡Œæ–‡ä»¶ä¼ è¾“ï¼Œæµç¨‹ç¹çä¸”éš¾ä»¥è‡ªåŠ¨åŒ–ã€‚</li>
</ol>
<p><code>dev.coolrequest.gosync</code> æ­£æ˜¯ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜è€Œç”Ÿçš„ã€‚</p>
<hr/>
<h3 data-id="heading-1">2. æ ¸å¿ƒç‰¹æ€§</h3>
<ul>
<li><strong>æ™ºèƒ½å¢é‡åŒæ­¥ (Smart Sync)ï¼š</strong> æ’ä»¶ä¼šè®¡ç®—æœ¬åœ°æ–‡ä»¶ä¸è¿œç¨‹æ–‡ä»¶çš„ MD5 æ ¡éªŒå’Œã€‚åªæœ‰åœ¨æ–‡ä»¶å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶æ‰ä¼šè§¦å‘ä¸Šä¼ ã€‚å¦‚æœ MD5 ä¸€è‡´ï¼Œç›´æ¥è·³è¿‡ã€‚</li>
<li><strong>ä¾èµ–è‡ªåŠ¨æå–ï¼š</strong> è‡ªåŠ¨åˆ†æé¡¹ç›®çš„ Runtime ä¾èµ–ï¼Œå¹¶å°†æ‰€æœ‰ä¾èµ–åŒ…ä¸ä¸»ç¨‹åºåˆ†ç¦»ï¼Œç¡®ä¿è¿œç¨‹ <code>lib</code> ç›®å½•å§‹ç»ˆä¸æœ¬åœ°åŒæ­¥ã€‚</li>
<li><strong>åŸç”Ÿæ”¯æŒå ¡å’æœº (JumpServer)ï¼š</strong> æ”¯æŒé…ç½®è‡ªåŠ¨åŒ–æŒ‡ä»¤åºåˆ—ï¼Œæ¨¡æ‹Ÿé”®ç›˜è¾“å…¥ï¼Œè‡ªåŠ¨å®Œæˆå ¡å’æœºèœå•é€‰æ‹©å¹¶ç©¿é€åˆ°ç›®æ ‡ä¸»æœºã€‚</li>
<li><strong>é«˜æ•ˆé›†æˆï¼š</strong> æ— ç¼é›†æˆåˆ° Gradle æ„å»ºç”Ÿå‘½å‘¨æœŸï¼Œå®ç°â€œæ„å»ºå³éƒ¨ç½²â€ã€‚</li>
<li><strong>æ— ä¾èµ–</strong>ï¼šæ‰€æœ‰æ“ä½œéƒ½ä¾é SSHã€å¤§é‡äº¤äº’å‘½ä»¤å®ç°ï¼ŒæœåŠ¡å™¨ä¸éœ€è¦å®‰è£…ä»»ä½•è½¯ä»¶</li>
</ul>
<hr/>
<h3 data-id="heading-2">3. å¿«é€Ÿä¸Šæ‰‹</h3>
<p>åœ¨ä½ çš„ <code>build.gradle</code> æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œå³å¯å¼€å¯è‡ªåŠ¨åŒ–éƒ¨ç½²ä¹‹æ—…ã€‚</p>
<h4 data-id="heading-3">é…ç½®ç¤ºä¾‹ï¼š</h4>
<pre><code class="hljs language-groovy" lang="groovy">plugins {
  id("dev.coolrequest.gosync") version "1.1"
}

goSync {
    // è¿æ¥æ¨¡å¼ï¼šå¯é€‰ "simple" (ç›´è¿) æˆ– "jumpserver" (å ¡å’æœº)
    serverType = "jumpserver" 
    
    // æœåŠ¡å™¨/å ¡å’æœºåœ°å€
    serverAddress = "192.168.1.100"
    port = 2222
    userName = "admin"
    userPass = "your_password"

    /**
     * å ¡å’æœºä¸“æœ‰é…ç½®ï¼šafterConnectedCommand
     * ç”¨äºæ¨¡æ‹Ÿè¿›å…¥å ¡å’æœºåçš„äº¤äº’å‘½ä»¤ã€‚
     * \r ä»£è¡¨å›è½¦ã€‚ä¾‹å¦‚ï¼šp\r25\r2\r è¡¨ç¤ºï¼š
     * è¾“å…¥ p -&gt; å›è½¦ -&gt; è¾“å…¥ 1 -&gt; å›è½¦ -&gt; è¾“å…¥ 2 -&gt; å›è½¦
     */
    afterConnectedCommand = "p\r25\r2\r"

    // è¿œç¨‹æœåŠ¡å™¨å­˜æ”¾ä¾èµ–åº“ï¼ˆJARï¼‰çš„ç»å¯¹è·¯å¾„
    libDirectory = "/app/deploy/libs"
    
    // è¿œç¨‹æœåŠ¡å™¨å­˜æ”¾ä¸»ç¨‹åº JAR çš„ç»å¯¹è·¯å¾„
    mainJarDirectory = "/app/deploy/app-main"
}
</code></pre>
<hr/>
<h3 data-id="heading-4">4. å·¥ä½œåŸç†æ·±åº¦è§£æ</h3>
<p><code>gosync</code> çš„å·¥ä½œæµç¨‹éå¸¸ä¸¥è°¨ä¸”é«˜æ•ˆï¼š</p>
<ol>
<li><strong>æ„å»ºåè§¦å‘ï¼š</strong> æ’ä»¶ä¼šè‡ªåŠ¨æŒ‚è½½åœ¨ Gradle çš„ <code>jar</code> ä»»åŠ¡ä¹‹åã€‚å½“ä½ æ‰§è¡Œæ„å»ºæ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨å¯åŠ¨ã€‚</li>
<li><strong>ä¾èµ–æ‰«æï¼š</strong> æ’ä»¶ä¼šæå–é¡¹ç›®æ‰€æœ‰çš„è¿è¡Œæ—¶ä¾èµ–ï¼ˆRuntime Dependenciesï¼‰ã€‚</li>
<li><strong>MD5 æ¯”å¯¹ï¼š</strong>
<ul>
<li>è®¡ç®—æœ¬åœ°ä¸» JAR åŠæ‰€æœ‰ä¾èµ– JAR çš„ MD5 å€¼ã€‚</li>
<li>é€šè¿‡ SSH è¿æ¥è¿œç¨‹æœåŠ¡å™¨ï¼Œè·å–å¯¹åº”è·¯å¾„ä¸‹æ–‡ä»¶çš„ MD5ã€‚</li>
</ul>
</li>
<li><strong>æŒ‰éœ€ä¸Šä¼ ï¼š</strong>
<ul>
<li>å¦‚æœè¿œç¨‹ä¸å­˜åœ¨è¯¥æ–‡ä»¶ -&gt; <strong>ä¸Šä¼ </strong>ã€‚</li>
<li>å¦‚æœè¿œç¨‹å­˜åœ¨ä½† MD5 ä¸åŒ¹é… -&gt; <strong>è¦†ç›–ä¸Šä¼ </strong>ã€‚</li>
<li>å¦‚æœ MD5 å®Œå…¨ä¸€è‡´ -&gt; <strong>è·³è¿‡</strong>ã€‚</li>
</ul>
</li>
<li><strong>è‡ªåŠ¨åŒ–ç©¿é€ï¼š</strong> å¦‚æœé…ç½®ä¸º <code>jumpserver</code> æ¨¡å¼ï¼Œæ’ä»¶ä¼šå»ºç«‹ä¸€ä¸ªäº¤äº’å¼ä¼šè¯ï¼ŒæŒ‰ç…§ <code>afterConnectedCommand</code> é¢„è®¾çš„æŒ‡ä»¤æµè‡ªåŠ¨â€œæ•²å‡»é”®ç›˜â€ï¼Œç©¿é€èœå•ç•Œé¢ï¼Œæœ€ç»ˆå®šä½åˆ°ç›®æ ‡æœºè¿›è¡Œ SFTP ä¼ è¾“ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-5">5. å¦‚ä½•æ‰§è¡Œï¼Ÿ</h3>
<p>ä½ å¯ä»¥æ‰‹åŠ¨è§¦å‘åŒæ­¥ä»»åŠ¡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">./gradlew goSync
</code></pre>
<p>æˆ–è€…ï¼Œå¦‚æœä½ å·²ç»é…ç½®äº†ä»»åŠ¡ä¾èµ–ï¼Œåªéœ€æ‰§è¡Œæ ‡å‡†çš„æ„å»ºå‘½ä»¤ï¼Œéƒ¨ç½²å·¥ä½œå°±ä¼šåœ¨åå°é™é»˜å®Œæˆã€‚</p>
<hr/>
<h3 data-id="heading-6">6. æ€»ç»“</h3>
<p><code>dev.coolrequest.gosync</code> æ˜¯ä¸€æ¬¾éå¸¸æ‡‚å¼€å‘è€…çš„æ’ä»¶ã€‚å®ƒå°†â€œå¢é‡æ›´æ–°â€å’Œâ€œè‡ªåŠ¨åŒ–ç©¿é€â€è¿™ä¸¤ä¸ªç—›ç‚¹ç»“åˆå¾—éå¸¸ä¼˜é›…ã€‚å¯¹äºé‚£äº›æ·±é™·å¤æ‚å†…ç½‘ç¯å¢ƒã€æˆ–æ˜¯åŒå€¦äº†æ¼«é•¿ä¸Šä¼ ç­‰å¾…çš„åŒå­¦æ¥è¯´ï¼Œè¿™ç»å¯¹æ˜¯ä¸€æŠŠåˆ©å™¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ElasticSearchæ“ä½œç³»ç»Ÿç¯å¢ƒè®¾ç½®]]></title>    <link>https://juejin.cn/post/7588004601392726050</link>    <guid>https://juejin.cn/post/7588004601392726050</guid>    <pubDate>2025-12-27T06:13:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588004601392726050" data-draft-id="7588043318358458403" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ElasticSearchæ“ä½œç³»ç»Ÿç¯å¢ƒè®¾ç½®"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-27T06:13:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Postkarteä¸æƒ³è¯´è¯"/> <meta itemprop="url" content="https://juejin.cn/user/3544481220007736"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ElasticSearchæ“ä½œç³»ç»Ÿç¯å¢ƒè®¾ç½®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3544481220007736/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Postkarteä¸æƒ³è¯´è¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T06:13:56.000Z" title="Sat Dec 27 2025 06:13:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">è®¾ç½®è™šæ‹Ÿå†…å­˜å¤§å°</h2>
<p>ç¼–è¾‘<code>/etc/sysctl.conf </code>æ·»åŠ å¦‚ä¸‹å†…å®¹</p>
<pre><code class="hljs language-sh" lang="sh"><span class="hljs-comment"># ç¦ç”¨å†…å­˜ä¸ç¡¬ç›˜äº¤æ¢</span>
vm.swappiness=1
<span class="hljs-comment"># è®¾ç½®è™šæ‹Ÿå†…å­˜å¤§å°ï¼Œmmpfileå­˜å‚¨å†…å­˜éœ€è¦</span>
vm.max_map_count=262144
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c869673f2759493c8f17e096f98a231c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUG9zdGthcnRl5LiN5oOz6K-06K-d:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420836&amp;x-signature=SJlznDgW8Pm79R6Wj2Nty3R4j8k%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-1">è®¾ç½®æ–‡ä»¶å¥æŸ„å€¼</h2>
<p>ESç´¢å¼•ç”±å¾ˆå¤šæ–‡ä»¶ç»„æˆï¼Œæ‰“å¼€æ–‡ä»¶æ•°é‡å¤šã€‚ESè¿›ç¨‹å†…ç½®å¤šç§çº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ•°é‡å¤šã€‚</p>
<p>ç¼–è¾‘<code>/etc/security/limits.conf</code>,æ·»åŠ å¦‚ä¸‹å†…å®¹</p>
<pre><code class="hljs language-sh" lang="sh"><span class="hljs-comment"># è¿›ç¨‹çº¿ç¨‹æ•°</span>
* soft <span class="hljs-built_in">nproc</span> 131072
* hard <span class="hljs-built_in">nproc</span> 131072
<span class="hljs-comment"># æ–‡ä»¶å¥æŸ„æ•°</span>
* soft nofile 131072
* hard nofile 131072
<span class="hljs-comment"># å†…å­˜é”å®šäº¤æ¢</span>
* soft memlock unlimited
* hard memlock unlimited
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d39936678144fc99d663400259e4ff6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUG9zdGthcnRl5LiN5oOz6K-06K-d:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767420836&amp;x-signature=cC9E0dLKktIOigZnHRMFMQL8GBg%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-2">åˆ›å»ºESä¸“ç”¨è´¦å·</h2>
<pre><code class="hljs language-sh" lang="sh"><span class="hljs-comment"># åˆ›å»ºESè´¦å·</span>
useradd elsatic
<span class="hljs-comment"># æˆæƒESç¨‹åºç›®å½•æƒé™ç»™elasticè´¦å·</span>
<span class="hljs-comment"># å‡è®¾ESç¨‹åºç›®å½•ã€æ•°æ®ç›®å½•ã€æ—¥å¿—ç›®å½•éƒ½åœ¨/gpesç›®å½•ä¸‹</span>
<span class="hljs-built_in">chown</span> -R elastic:elastic /gpes
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JobFlowè°ƒåº¦çš„éš¾é¢˜ï¼šè¶…æ—¶ã€è¡¥å¿ä¸æ¼è°ƒ]]></title>    <link>https://juejin.cn/post/7588028859541307418</link>    <guid>https://juejin.cn/post/7588028859541307418</guid>    <pubDate>2025-12-27T06:36:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588028859541307418" data-draft-id="7588031908171956233" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JobFlowè°ƒåº¦çš„éš¾é¢˜ï¼šè¶…æ—¶ã€è¡¥å¿ä¸æ¼è°ƒ"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•,æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-27T06:36:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¸æµªæ— ç—•"/> <meta itemprop="url" content="https://juejin.cn/user/2834988091055719"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JobFlowè°ƒåº¦çš„éš¾é¢˜ï¼šè¶…æ—¶ã€è¡¥å¿ä¸æ¼è°ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2834988091055719/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¸æµªæ— ç—•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T06:36:02.000Z" title="Sat Dec 27 2025 06:36:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»16åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼€æºåœ°å€ä¸ç³»åˆ—æ–‡ç« </h2>
<ul>
<li><strong>å¼€æºåœ°å€</strong>ï¼š<code>https://gitee.com/sh_wangwanbao/job-flow</code></li>
<li><strong>ç³»åˆ—æ–‡ç« ï¼š</strong>
<ul>
<li><a href="https://juejin.cn/post/7583469866007969827" target="_blank" title="https://juejin.cn/post/7583469866007969827">ç¬¬ä¸€ç¯‡ï¼šåŸºäºNacosçš„è½»é‡ä»»åŠ¡è°ƒåº¦æ–¹æ¡ˆ â€”â€” ä» XXL-Job çš„ç—›ç‚¹è¯´èµ·</a></li>
<li><a href="https://juejin.cn/post/7584353612501106729" target="_blank" title="https://juejin.cn/post/7584353612501106729">ç¬¬äºŒç¯‡ï¼šJobFlow å®ç°æ–¹æ¡ˆï¼šäº‘åŸç”Ÿæ—¶ä»£çš„ä»»åŠ¡è°ƒåº¦æ–°æ€è·¯</a></li>
<li><a href="https://juejin.cn/post/7585727457472823296" target="_blank" title="https://juejin.cn/post/7585727457472823296">ç¬¬ä¸‰ç¯‡ï¼šJobFlow å®æˆ˜ï¼šæ— é”è°ƒåº¦æ˜¯æ€ä¹ˆåšåˆ°çš„</a></li>
<li><a href="https://juejin.cn/post/7585751355593506835" target="_blank" title="https://juejin.cn/post/7585751355593506835">ç¬¬å››ç¯‡ï¼šJobFlow èƒŒåï¼šäº”ä¸ªè®©æˆ‘è±ç„¶å¼€æœ—çš„è®¾è®¡ç¬é—´</a></li>
<li><a href="https://juejin.cn/post/7588028859541307418" target="_blank" title="https://juejin.cn/post/7588028859541307418">ç¬¬äº”ç¯‡ï¼š# JobFlowè°ƒåº¦çš„éš¾é¢˜ï¼šè¶…æ—¶ã€è¡¥å¿ä¸æ¼è°ƒ</a></li>
<li>ç¬¬å…­ç¯‡ï¼šå»¶æ—¶é˜Ÿåˆ—çš„è®¾è®¡ä¸å®ç°ï¼ˆæ’°å†™ä¸­ï¼‰</li>
</ul>
</li>
</ul>
<h2 data-id="heading-1">å‰è¨€</h2>
<p>å‰é¢å‡ ç¯‡æ–‡ç« è®²äº† JobFlow çš„æ— é”è°ƒåº¦æ˜¯æ€ä¹ˆåšçš„ï¼šé€šè¿‡ Hash åˆ†åŒº + Owner åˆ¤å®šï¼Œè®©æ¯ä¸ªè°ƒåº¦å™¨å®ä¾‹è‡ªå·±ç®—å‡ºè¯¥ä¸è¯¥æ‰§è¡Œä»»åŠ¡ï¼Œé¿å…äº†æ•°æ®åº“é”ç«äº‰ã€‚</p>
<p>ä½†æ— é”è®¾è®¡å¸¦æ¥äº†æ–°é—®é¢˜ï¼š</p>
<pre><code class="hljs">åœºæ™¯ä¸€ï¼šä»»åŠ¡è§¦å‘äº†ï¼Œä½†æ‰§è¡Œå™¨ä¸€ç›´æ²¡å“åº”
â†’ æ˜¯çœŸçš„åœ¨è·‘ï¼Œè¿˜æ˜¯å·²ç»æŒ‚äº†ï¼Ÿ

åœºæ™¯äºŒï¼šä»»åŠ¡å¤±è´¥äº†ï¼Œéœ€è¦é‡è¯•
â†’ é‡è¯•å‡ æ¬¡ï¼Ÿé—´éš”å¤šä¹…ï¼Ÿ

åœºæ™¯ä¸‰ï¼šæŸä¸€è½®ä»»åŠ¡æ ¹æœ¬æ²¡è¢«è§¦å‘
â†’ æ€ä¹ˆå‘ç°ï¼Ÿæ€ä¹ˆè¡¥å¿ï¼Ÿ
</code></pre>
<p>è¿™å°±æ˜¯åˆ†å¸ƒå¼è°ƒåº¦çš„ä¸‰ä¸ªç»ˆæéš¾é¢˜ï¼š<strong>è¶…æ—¶ã€è¡¥å¿ã€æ¼è°ƒ</strong>ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« å°±æ¥è®²è®² JobFlow æ˜¯æ€ä¹ˆè§£å†³è¿™ä¸‰ä¸ªé—®é¢˜çš„ã€‚</p>
<h2 data-id="heading-2">ä¸€ã€æ•´ä½“æ–¹æ¡ˆï¼šä¸‰å±‚ä¿éšœæœºåˆ¶</h2>
<p>åœ¨æ·±å…¥ç»†èŠ‚ä¹‹å‰ï¼Œå…ˆçœ‹çœ‹ JobFlow çš„æ•´ä½“è®¾è®¡æ€è·¯ã€‚</p>
<h3 data-id="heading-3">æ ¸å¿ƒç†å¿µ</h3>
<p>JobFlow çš„å¼‚å¸¸å¤„ç†éµå¾ªä¸€ä¸ªç®€å•çš„åŸåˆ™ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">æ­£å¸¸è·¯å¾„ï¼šè¿½æ±‚æ€§èƒ½
<span class="hljs-deletion">- æ— é”è°ƒåº¦ï¼Œå¿«é€Ÿè§¦å‘</span>
<span class="hljs-deletion">- å¼‚æ­¥å›è°ƒï¼Œç«‹å³å“åº”</span>
<span class="hljs-deletion">- 99% çš„ä»»åŠ¡èµ°è¿™æ¡è·¯</span>

å¼‚å¸¸è·¯å¾„ï¼šè¿½æ±‚å¯é æ€§
<span class="hljs-deletion">- è¶…æ—¶å·¡æ£€ï¼Œç¡®è®¤çŠ¶æ€</span>
<span class="hljs-deletion">- åˆ†ç‰‡è¡¥å¿ï¼Œé™æ¬¡é‡è¯•</span>
<span class="hljs-deletion">- æ¼è°ƒæ£€æµ‹ï¼Œä¸»åŠ¨è¡¥å¿</span>
<span class="hljs-deletion">- 1% çš„ä»»åŠ¡éœ€è¦å…œåº•</span>
</code></pre>
<h3 data-id="heading-4">ä¸‰å±‚ä¿éšœæœºåˆ¶</h3>
<p>JobFlow é€šè¿‡ä¸‰ä¸ªå±‚æ¬¡æ¥ä¿éšœä»»åŠ¡æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[ç¬¬ä¸€å±‚&lt;br/&gt;æ­£å¸¸è°ƒåº¦] --&gt; B[ç¬¬äºŒå±‚&lt;br/&gt;è¶…æ—¶ä¸è¡¥å¿]
    B --&gt; C[ç¬¬ä¸‰å±‚&lt;br/&gt;æ¼è°ƒæ£€æµ‹]
    
    A --&gt; D[99%ä»»åŠ¡&lt;br/&gt;å¿«é€Ÿå®Œæˆ]
    B --&gt; E[0.9%ä»»åŠ¡&lt;br/&gt;é‡è¯•æˆåŠŸ]
    C --&gt; F[0.1%ä»»åŠ¡&lt;br/&gt;è¡¥å¿æ‰§è¡Œ]
    
    style A fill:#90EE90
    style B fill:#FFE4B5
    style C fill:#FFB6C1
    style D fill:#90EE90
    style E fill:#87CEEB
    style F fill:#87CEEB
</code></pre>
<p><strong>ç¬¬ä¸€å±‚ï¼šæ­£å¸¸è°ƒåº¦</strong></p>
<ul>
<li>Owner åˆ¤å®šé¿å…é‡å¤</li>
<li>åˆ›å»ºçˆ¶å­è®°å½•</li>
<li>åˆå§‹åˆ†é… + å›è°ƒé©±åŠ¨</li>
<li>å¤§éƒ¨åˆ†ä»»åŠ¡åœ¨è¿™ä¸€å±‚å®Œæˆ</li>
</ul>
<p><strong>ç¬¬äºŒå±‚ï¼šè¶…æ—¶ä¸è¡¥å¿</strong></p>
<ul>
<li>è¶…æ—¶å·¡æ£€ï¼ˆ3 åˆ†é’Ÿä¸€æ¬¡ï¼‰</li>
<li>è¯¢é—®æ‰§è¡Œå™¨ç¡®è®¤çœŸå®çŠ¶æ€</li>
<li>åˆ†ç‰‡è¡¥å¿ï¼Œé™æ¬¡é‡è¯•</li>
<li>å¤„ç†æ‰§è¡Œæ…¢ã€å¤±è´¥çš„æƒ…å†µ</li>
</ul>
<p><strong>ç¬¬ä¸‰å±‚ï¼šæ¼è°ƒæ£€æµ‹</strong></p>
<ul>
<li>ä½é¢‘ä»»åŠ¡å·¡æ£€ï¼ˆ10 åˆ†é’Ÿä¸€æ¬¡ï¼‰</li>
<li>æ—¶é—´çª—å£å†…æŸ¥æ‰¾æ‰§è¡Œè®°å½•</li>
<li>å‘ç°æ¼è°ƒä¸»åŠ¨è¡¥å¿</li>
<li>å¤„ç†æ•´è½®æœªè§¦å‘çš„æƒ…å†µ</li>
</ul>
<h3 data-id="heading-5">å…³é”®è§’è‰²åˆ†å·¥</h3>
<p>ä¸æ˜¯æ‰€æœ‰è°ƒåº¦å™¨å®ä¾‹éƒ½åšæ‰€æœ‰äº‹æƒ…ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[æ™®é€šå®ä¾‹&lt;br/&gt;è´Ÿè´£æ­£å¸¸è°ƒåº¦] --&gt; B[æŒ‰ Hash åˆ†åŒº&lt;br/&gt;å„ç®¡å„çš„ä»»åŠ¡]
    
    C[å·¡æ£€Leader&lt;br/&gt;æœ€å°èŠ‚ç‚¹] --&gt; D[è¶…æ—¶å·¡æ£€&lt;br/&gt;åˆ†ç‰‡è¡¥å¿&lt;br/&gt;æ¼è°ƒæ£€æµ‹]
    
    style A fill:#90EE90
    style B fill:#87CEEB
    style C fill:#FFE4B5
    style D fill:#FFB6C1
</code></pre>
<p>è¿™æ ·è®¾è®¡çš„å¥½å¤„ï¼š</p>
<ul>
<li>æ­£å¸¸è°ƒåº¦è´Ÿè½½å‡è¡¡ï¼ˆHash åˆ†åŒºï¼‰</li>
<li>å·¡æ£€ä»»åŠ¡å•ç‚¹æ‰§è¡Œï¼ˆé¿å…é‡å¤ï¼‰</li>
<li>æœ€å°èŠ‚ç‚¹æŒ‚äº†ï¼Œä¸‹ä¸€ä¸ªè‡ªåŠ¨æ¥ç®¡</li>
</ul>
<p>æœ‰äº†æ•´ä½“è®¤è¯†ï¼Œæˆ‘ä»¬å†æ·±å…¥æ¯ä¸ªç¯èŠ‚çš„ç»†èŠ‚ã€‚</p>
<h2 data-id="heading-6">äºŒã€é—®é¢˜æ‹†è§£ï¼šä¸‰ç§å¼‚å¸¸åœºæ™¯</h2>
<p>å…ˆçœ‹çœ‹ JobFlow éœ€è¦å¤„ç†å“ªäº›å¼‚å¸¸åœºæ™¯ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[æ­£å¸¸æ‰§è¡Œ&lt;br/&gt;99%åœºæ™¯] --&gt; B[ä»»åŠ¡å®Œæˆ]
    
    C[æ‰§è¡Œè¶…æ—¶&lt;br/&gt;å¡ä½ä¸åŠ¨] --&gt; D[è¶…æ—¶åˆ¤å®š]
    E[æ‰§è¡Œå¤±è´¥&lt;br/&gt;éœ€è¦é‡è¯•] --&gt; F[è¡¥å¿é‡è¯•]
    G[ä»»åŠ¡æ¼è°ƒ&lt;br/&gt;æ•´è½®é”™è¿‡] --&gt; H[æ¼è°ƒæ£€æµ‹]
    
    style A fill:#90EE90
    style C fill:#FFB6C1
    style E fill:#FFB6C1
    style G fill:#FFB6C1
</code></pre>
<p><strong>æ ¸å¿ƒè®¾è®¡æ€è·¯ï¼š</strong></p>
<p>æ­£å¸¸è·¯å¾„è¿½æ±‚æ€§èƒ½ï¼š</p>
<ul>
<li>æ— é” owner åˆ¤å®š</li>
<li>å¿«é€Ÿè§¦å‘æ‰§è¡Œ</li>
<li>å¼‚æ­¥å›è°ƒæ›´æ–°</li>
</ul>
<p>å¼‚å¸¸è·¯å¾„è¿½æ±‚å¯é æ€§ï¼š</p>
<ul>
<li>è¶…æ—¶å·¡æ£€ç¡®è®¤çŠ¶æ€</li>
<li>åˆ†ç‰‡è¡¥å¿é™æ¬¡é‡è¯•</li>
<li>ä½é¢‘ä»»åŠ¡æ¼è°ƒæ£€æµ‹</li>
</ul>
<p>æ¥ä¸‹æ¥åˆ†åˆ«å±•å¼€è®²ã€‚</p>
<h2 data-id="heading-7">ä¸‰ã€æ­£å¸¸æµç¨‹å¿«é€Ÿå›é¡¾</h2>
<p>åœ¨è®²å¼‚å¸¸å¤„ç†ä¹‹å‰ï¼Œå¿«é€Ÿå›é¡¾ä¸€ä¸‹æ­£å¸¸æµç¨‹ï¼ˆè¯¦ç»†å†…å®¹è§ç¬¬äºŒã€ä¸‰ç¯‡æ–‡ç« ï¼‰ï¼š</p>
<p><strong>è°ƒåº¦è§¦å‘</strong>ï¼šå®šæ—¶æ‰«æ â†’ Owner åˆ¤å®š â†’ Cron åˆ°æœŸ â†’ è§¦å‘æ‰§è¡Œ</p>
<p><strong>åˆ†ç‰‡æ‰§è¡Œ</strong>ï¼šåˆ›å»ºçˆ¶è®°å½• â†’ åˆ›å»ºå­è®°å½•ï¼ˆ100 ä¸ª PENDING åˆ†ç‰‡ï¼‰â†’ åˆå§‹åˆ†é… â†’ å›è°ƒé©±åŠ¨</p>
<p>è¿™å°±æ˜¯æ­£å¸¸è·¯å¾„ã€‚é—®é¢˜æ˜¯ï¼Œå¼‚å¸¸æƒ…å†µæ€ä¹ˆå¤„ç†ï¼Ÿ</p>
<h2 data-id="heading-8">å››ã€è¶…æ—¶åˆ¤å®šï¼šä»æ„Ÿè§‰è¶…æ—¶åˆ°ç¡®è®¤è¶…æ—¶</h2>
<h3 data-id="heading-9">ä»€ä¹ˆå«è¶…æ—¶ï¼Ÿ</h3>
<p>ä»»åŠ¡è§¦å‘äº†ï¼Œåˆ†ç‰‡ä¹Ÿè°ƒåº¦äº†ï¼Œä½†ä¸€ç›´æ²¡å›è°ƒã€‚è¿™æ—¶å€™è°ƒåº¦å™¨ä¸çŸ¥é“ï¼š</p>
<pre><code class="hljs">å¯èƒ½æ€§ä¸€ï¼šæ‰§è¡Œå™¨è¿˜åœ¨è·‘ï¼Œåªæ˜¯æ¯”è¾ƒæ…¢
å¯èƒ½æ€§äºŒï¼šæ‰§è¡Œå™¨æŒ‚äº†ï¼Œå›è°ƒå‘ä¸å‡ºæ¥
å¯èƒ½æ€§ä¸‰ï¼šç½‘ç»œæŠ–åŠ¨ï¼Œå›è°ƒä¸¢äº†
</code></pre>
<p><strong>JobFlow çš„ç­–ç•¥ï¼šå…ˆå·¡æ£€ï¼Œå†è¯¢é—®ï¼Œæœ€ååˆ¤æ­»åˆ‘ã€‚</strong></p>
<h3 data-id="heading-10">å·¡æ£€å…¥å£</h3>
<p>è¶…æ—¶å·¡æ£€ç”±æœ€å°èŠ‚ç‚¹è´Ÿè´£ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[å®šæ—¶å·¡æ£€&lt;br/&gt;æ¯3åˆ†é’Ÿ] --&gt; B{isInspectionLeader?}
    B --&gt;|å¦| C[è·³è¿‡]
    B --&gt;|æ˜¯| D[æŸ¥è¯¢è¶…æ—¶åˆ†ç‰‡]
    D --&gt; E[åˆ†ç±»å¤„ç†]
    
    style A fill:#87CEEB
    style B fill:#FFE4B5
    style D fill:#FFB6C1
    style E fill:#90EE90
</code></pre>
<p>ä¸ºä»€ä¹ˆç”±æœ€å°èŠ‚ç‚¹è´Ÿè´£ï¼Ÿ</p>
<pre><code class="hljs">æ‰€æœ‰å®ä¾‹ä» Nacos æ‹‰å–å®ä¾‹åˆ—è¡¨
æ’åºåï¼Œæœ€å°çš„é‚£ä¸ªå°±æ˜¯ leader
ä¸éœ€è¦å¤æ‚çš„é€‰ä¸¾ç®—æ³•
æœ€å°èŠ‚ç‚¹æŒ‚äº†ï¼Œä¸‹ä¸€ä¸ªè‡ªåŠ¨æ¥ç®¡
</code></pre>
<p>ä»£ç é€»è¾‘ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">inspectTimeoutSubExecutions</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// 1. åˆ¤æ–­æˆ‘æ˜¯ä¸æ˜¯å·¡æ£€ leader</span>
    <span class="hljs-keyword">if</span> (!isInspectionLeader()) {
        <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// 2. æŸ¥è¯¢è¶…æ—¶åˆ†ç‰‡ï¼ˆåŸºå‡†æ—¶é—´ + è¶…æ—¶é˜ˆå€¼ï¼‰</span>
    List&lt;JobSubExecution&gt; timeoutSubs = jobRepository.findTimeoutSubExecutions(timeoutThresholdMinutes);
    
    <span class="hljs-comment">// 3. åˆ†ç±»å¤„ç†</span>
    <span class="hljs-keyword">for</span> (JobSubExecution sub : timeoutSubs) {
        <span class="hljs-keyword">if</span> (sub.getStatus() == RUNNING) {
            handleRunningTimeoutSubExecution(sub, now);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sub.getStatus() == PENDING) {
            handleSubExecutionForCompensation(sub, now);
        }
    }
}
</code></pre>
<h3 data-id="heading-11">ä¸‰æ­¥è¯¢é—®ç­–ç•¥</h3>
<p>å¯¹äº RUNNING çŠ¶æ€çš„åˆ†ç‰‡ï¼ŒJobFlow ä¸ä¼šç›´æ¥åˆ¤æ­»åˆ‘ï¼Œè€Œæ˜¯å…ˆé—®ä¸€é—®ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[å‘ç°RUNNINGè¶…æ—¶] --&gt; B{è¶…è¿‡2å€é˜ˆå€¼?}
    B --&gt;|æ˜¯| C[ç›´æ¥æ ‡è®°TIMEOUT]
    B --&gt;|å¦| D[HTTPè¯¢é—®æ‰§è¡Œå™¨]
    D --&gt; E{æ‰§è¡Œå™¨è¿”å›?}
    E --&gt;|SUCCESS/FAILED| F[æ›´æ–°ä¸ºçœŸå®çŠ¶æ€]
    E --&gt;|RUNNING| G[æš‚ä¸å¤„ç†]
    E --&gt;|è¶…æ—¶/å¼‚å¸¸| H[æ ‡è®°TIMEOUT]
    
    style A fill:#FFB6C1
    style B fill:#FFE4B5
    style C fill:#FF6B6B
    style D fill:#87CEEB
    style E fill:#FFE4B5
    style F fill:#90EE90
    style H fill:#FF6B6B
</code></pre>
<p>è¿™ä¸ªç­–ç•¥åˆ†ä¸‰æ­¥ï¼š</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šè¯¢é—®æ‰§è¡Œå™¨</strong></p>
<p>å‘æ‰§è¡Œå™¨å‘é€ HTTP è¯·æ±‚æŸ¥è¯¢çŠ¶æ€</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">String</span> <span class="hljs-variable">statusUrl</span> <span class="hljs-operator">=</span> executorUrl + <span class="hljs-string">"/internal/job/status?traceId="</span> + shardTraceId;
<span class="hljs-type">String</span> <span class="hljs-variable">statusText</span> <span class="hljs-operator">=</span> restTemplate.getForObject(statusUrl, String.class);
</code></pre>
<p><strong>ç¬¬äºŒæ­¥ï¼šæ‰§è¡Œå™¨åº”ç­”</strong></p>
<p>æ‰§è¡Œå™¨è¿”å›çœŸå®çŠ¶æ€</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ‰§è¡Œå™¨ç«¯ä»£ç </span>
<span class="hljs-meta">@GetMapping("/internal/job/status")</span>
<span class="hljs-keyword">public</span> String <span class="hljs-title function_">getStatus</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam</span> String traceId)</span> {
    <span class="hljs-comment">// ä»å†…å­˜æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€</span>
    <span class="hljs-type">ExecutionStatus</span> <span class="hljs-variable">status</span> <span class="hljs-operator">=</span> taskContext.getStatus(traceId);
    <span class="hljs-keyword">return</span> status.name();
}
</code></pre>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šæ ¹æ®åº”ç­”å†³å®šè¡ŒåŠ¨</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">if</span> (remoteStatus == SUCCESS || remoteStatus == FAILED) {
    <span class="hljs-comment">// ä»¥æ‰§è¡Œå™¨åé¦ˆä¸ºå‡†ï¼Œæ›´æ–°çŠ¶æ€</span>
    jobRepository.updateSubExecutionResult(...);
    updateParentExecutionStatus(parentExecutionId);
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (remoteStatus == RUNNING) {
    <span class="hljs-comment">// è¿˜åœ¨è·‘ï¼Œæš‚ä¸å¤„ç†</span>
    log.info(<span class="hljs-string">"ä»»åŠ¡ä»åœ¨æ‰§è¡Œä¸­ï¼Œæš‚ä¸å¤„ç†"</span>);
} <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// è¶…æ—¶æˆ–å¼‚å¸¸ï¼Œæ ‡è®° TIMEOUT</span>
    markSubExecutionTimeout(sub, now, <span class="hljs-string">"No valid response from executor"</span>);
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆéº»çƒ¦ï¼Ÿ</strong></p>
<p>å› ä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸ç¡®å®šæ€§ï¼š</p>
<pre><code class="hljs">åœºæ™¯ä¸€ï¼šæ‰§è¡Œå™¨åœ¨è·‘æ‰¹å¤„ç†ï¼Œæ•°æ®é‡ç‰¹åˆ«å¤§ï¼Œç¡®å®å¾ˆæ…¢
â†’ å¦‚æœç›´æ¥åˆ¤è¶…æ—¶ï¼Œä»»åŠ¡ç™½è·‘äº†

åœºæ™¯äºŒï¼šæ‰§è¡Œå™¨æŒ‚äº†ï¼Œæˆ–è€…ç½‘ç»œæ–­äº†
â†’ è¿™æ—¶å€™ç¡®å®è¯¥åˆ¤è¶…æ—¶

åœºæ™¯ä¸‰ï¼šæ‰§è¡Œå™¨å·²ç»æ‰§è¡Œå®Œäº†ï¼Œä½†å›è°ƒå¤±è´¥äº†
â†’ è¯¢é—®åæ‹¿åˆ°çœŸå®çŠ¶æ€ï¼Œé¿å…é‡å¤æ‰§è¡Œ
</code></pre>
<h3 data-id="heading-12">è¶…æ—¶é˜ˆå€¼çš„åŒé‡ä¿æŠ¤</h3>
<p>JobFlow æœ‰ä¸¤å±‚è¶…æ—¶åˆ¤æ–­ï¼š</p>
<p><strong>ç¬¬ä¸€å±‚ï¼šä»»åŠ¡é…ç½®çš„è¶…æ—¶æ—¶é—´</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> job_definition (
    ...
    timeout_seconds <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">300</span>,  <span class="hljs-comment">-- é»˜è®¤5åˆ†é’Ÿ</span>
    ...
);
</code></pre>
<p><strong>ç¬¬äºŒå±‚ï¼šå·¡æ£€é˜ˆå€¼ï¼ˆ2 å€è¶…æ—¶æ—¶é—´ï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">long</span> <span class="hljs-variable">elapsedSeconds</span> <span class="hljs-operator">=</span> Duration.between(baseTime, now).getSeconds();
<span class="hljs-keyword">if</span> (elapsedSeconds &gt;= timeoutSeconds * <span class="hljs-number">2</span>) {
    <span class="hljs-comment">// è¶…è¿‡2å€é˜ˆå€¼ï¼Œç›´æ¥æ ‡è®° TIMEOUTï¼Œä¸å†è¯¢é—®</span>
    markSubExecutionTimeout(sub, now, <span class="hljs-string">"Exceeded 2x timeout threshold"</span>);
    <span class="hljs-keyword">return</span>;
}
</code></pre>
<p>è¿™æ ·è®¾è®¡çš„å¥½å¤„ï¼š</p>
<pre><code class="hljs">ç¬¬ä¸€æ¬¡è¶…æ—¶ï¼ˆ5åˆ†é’Ÿï¼‰ï¼šå·¡æ£€å‘ç°ï¼Œè¯¢é—®æ‰§è¡Œå™¨
â†’ å¦‚æœè¿˜åœ¨è·‘ï¼Œç»§ç»­ç­‰

ç¬¬äºŒæ¬¡è¶…æ—¶ï¼ˆ10åˆ†é’Ÿï¼‰ï¼šç¡®è®¤å·²ç»å¡æ­»ï¼Œç›´æ¥åˆ¤æ­»åˆ‘
â†’ é¿å…ä¸€ç›´è¯¢é—®ï¼Œæµªè´¹èµ„æº
</code></pre>
<h3 data-id="heading-13">è¶…æ—¶å¤„ç†å°ç»“</h3>
<p>è¶…æ—¶å¤„ç†çš„æ ¸å¿ƒæ€è·¯ï¼š</p>
<pre><code class="hljs">ä¸ç¡®å®šçš„æ—¶å€™ï¼Œå…ˆé—®é—®
é—®äº†è¿˜ä¸ç¡®å®šï¼Œå†ç­‰ç­‰
ç­‰å¤ªä¹…äº†ï¼Œè¯¥æ­»å°±æ­»
</code></pre>
<p>è¿™ç§ç­–ç•¥åœ¨æ€§èƒ½å’Œå¯é æ€§ä¹‹é—´æ‰¾åˆ°äº†å¹³è¡¡ï¼š</p>
<ul>
<li>ä¸ä¼šå› ä¸ºä¸´æ—¶æ…¢å°±è¯¯åˆ¤</li>
<li>ä¹Ÿä¸ä¼šå› ä¸ºçœŸæŒ‚äº†è¿˜ä¸€ç›´ç­‰</li>
</ul>
<h2 data-id="heading-14">äº”ã€åˆ†ç‰‡è¡¥å¿ï¼šå¤±è´¥äº†æ€ä¹ˆé‡è¯•</h2>
<h3 data-id="heading-15">ä»€ä¹ˆæ—¶å€™éœ€è¦è¡¥å¿ï¼Ÿ</h3>
<p>åˆ†ç‰‡è¡¥å¿å¤„ç†ä¸¤ç§æƒ…å†µï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[åˆ†ç‰‡çŠ¶æ€å¼‚å¸¸] --&gt; B{ä»€ä¹ˆçŠ¶æ€?}
    B --&gt;|PENDINGè¶…æ—¶| C[ä»æœªæ‰§è¡Œ&lt;br/&gt;é‡æ–°åˆ†é…]
    B --&gt;|FAILED| D[æ‰§è¡Œå¤±è´¥&lt;br/&gt;é‡è¯•æ‰§è¡Œ]
    
    style A fill:#FFB6C1
    style B fill:#FFE4B5
    style C fill:#87CEEB
    style D fill:#87CEEB
</code></pre>
<p><strong>PENDING è¶…æ—¶</strong>ï¼šè°ƒåº¦å™¨å·²ç»åˆ›å»ºäº†åˆ†ç‰‡è®°å½•ï¼Œä½†ä¸€ç›´æ²¡åˆ†é…å‡ºå»</p>
<pre><code class="hljs language-diff" lang="diff">å¯èƒ½åŸå› ï¼š
<span class="hljs-deletion">- æ‰€æœ‰æ‰§è¡Œå™¨éƒ½æŒ‚äº†</span>
<span class="hljs-deletion">- åˆå§‹åˆ†é…æ—¶ç½‘ç»œå¼‚å¸¸</span>
<span class="hljs-deletion">- å‰é¢çš„åˆ†ç‰‡éƒ½å¡ä½äº†ï¼Œåé¢çš„æ²¡æœºä¼šæ‰§è¡Œ</span>
</code></pre>
<p><strong>FAILED çŠ¶æ€</strong>ï¼šåˆ†ç‰‡æ‰§è¡Œè¿‡ï¼Œä½†å¤±è´¥äº†</p>
<pre><code class="hljs language-diff" lang="diff">å¯èƒ½åŸå› ï¼š
<span class="hljs-deletion">- ä¸šåŠ¡é€»è¾‘å¼‚å¸¸</span>
<span class="hljs-deletion">- æ•°æ®åº“è¿æ¥è¶…æ—¶</span>
<span class="hljs-deletion">- ä¸‹æ¸¸æœåŠ¡ä¸å¯ç”¨</span>
</code></pre>
<h3 data-id="heading-16">è¡¥å¿é€»è¾‘</h3>
<p>è¡¥å¿çš„æ ¸å¿ƒé€»è¾‘åœ¨ <code>handleSubExecutionForCompensation</code>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleSubExecutionForCompensation</span><span class="hljs-params">(JobSubExecution sub, LocalDateTime now)</span> {
    <span class="hljs-comment">// 1. æŸ¥è¯¢ä»»åŠ¡å®šä¹‰ï¼Œè·å–æœ€å¤§é‡è¯•æ¬¡æ•°</span>
    <span class="hljs-type">JobDefinition</span> <span class="hljs-variable">jobDef</span> <span class="hljs-operator">=</span> jobRepository.findJobByName(sub.getJobName());
    <span class="hljs-type">int</span> <span class="hljs-variable">maxRetry</span> <span class="hljs-operator">=</span> jobDef != <span class="hljs-literal">null</span> ? jobDef.getMaxRetry() : <span class="hljs-number">3</span>;

    <span class="hljs-comment">// 2. æ£€æŸ¥æ˜¯å¦è¶…è¿‡æœ€å¤§é‡è¯•æ¬¡æ•°</span>
    <span class="hljs-keyword">if</span> (sub.getRetryCount() &gt;= maxRetry) {
        log.warn(<span class="hljs-string">"åˆ†ç‰‡å·²è¾¾æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œæ ‡è®°ä¸ºæœ€ç»ˆå¤±è´¥"</span>);
        jobRepository.updateSubExecutionStatus(sub.getId(), FAILED, now, 
            <span class="hljs-string">"Max retry exceeded in compensation"</span>);
        updateParentExecutionStatus(sub.getParentExecutionId());
        <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// 3. é‡æ–°åˆ†é…æ‰§è¡Œ</span>
    <span class="hljs-type">JobExecution</span> <span class="hljs-variable">parent</span> <span class="hljs-operator">=</span> jobRepository.findExecutionById(sub.getParentExecutionId());
    List&lt;ServiceInstance&gt; instances = discoveryClient.getInstances(jobDef.getServiceName());
    
    compensateSubExecution(sub, parent, jobDef, instances);
}
</code></pre>
<p>è¡¥å¿æµç¨‹ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[å‘ç°å¼‚å¸¸åˆ†ç‰‡] --&gt; B{é‡è¯•æ¬¡æ•°?}
    B --&gt;|æœªè¾¾ä¸Šé™| C[CASæ›´æ–°çŠ¶æ€&lt;br/&gt;PENDING to RUNNING]
    B --&gt;|è¾¾åˆ°ä¸Šé™| D[æ ‡è®°æœ€ç»ˆå¤±è´¥]
    C --&gt; E{CASæˆåŠŸ?}
    E --&gt;|æ˜¯| F[è°ƒç”¨æ‰§è¡Œå™¨]
    E --&gt;|å¦| G[å…¶ä»–å®ä¾‹å·²å¤„ç†]
    
    style A fill:#FFB6C1
    style B fill:#FFE4B5
    style C fill:#87CEEB
    style D fill:#FF6B6B
    style F fill:#90EE90
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼šCAS æ›´æ–°ä¿æŠ¤</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å°è¯• CAS æ›´æ–°çŠ¶æ€</span>
<span class="hljs-type">boolean</span> <span class="hljs-variable">updated</span> <span class="hljs-operator">=</span> jobRepository.casUpdateSubExecutionStatus(
    sub.getId(), 
    sub.getStatus(),      <span class="hljs-comment">// æ—§çŠ¶æ€</span>
    RUNNING,              <span class="hljs-comment">// æ–°çŠ¶æ€</span>
    sub.getRetryCount()   <span class="hljs-comment">// ç‰ˆæœ¬å·</span>
);

<span class="hljs-keyword">if</span> (!updated) {
    <span class="hljs-comment">// CAS å¤±è´¥ï¼Œè¯´æ˜å…¶ä»–å®ä¾‹å·²ç»åœ¨å¤„ç†äº†</span>
    log.info(<span class="hljs-string">"CASæ›´æ–°å¤±è´¥ï¼Œåˆ†ç‰‡å¯èƒ½å·²è¢«å…¶ä»–å®ä¾‹è¡¥å¿"</span>);
    <span class="hljs-keyword">return</span>;
}
</code></pre>
<p>ä¸ºä»€ä¹ˆè¦ç”¨ CASï¼Ÿ</p>
<pre><code class="hljs language-css" lang="css">åœºæ™¯ï¼šå¤šä¸ªè°ƒåº¦å™¨å®ä¾‹åŒæ—¶å‘ç°åŒä¸€ä¸ªåˆ†ç‰‡è¶…æ—¶

å®ä¾‹<span class="hljs-selector-tag">A</span>ï¼šCAS æ›´æ–° PENDING â†’ RUNNINGï¼ŒæˆåŠŸ
å®ä¾‹<span class="hljs-selector-tag">B</span>ï¼šCAS æ›´æ–° PENDING â†’ RUNNINGï¼Œå¤±è´¥ï¼ˆçŠ¶æ€å·²ç»æ˜¯ RUNNING äº†ï¼‰

ç»“æœï¼šåªæœ‰å®ä¾‹<span class="hljs-selector-tag">A</span> ä¼šçœŸæ­£è°ƒç”¨æ‰§è¡Œå™¨ï¼Œé¿å…é‡å¤æ‰§è¡Œ
</code></pre>
<h3 data-id="heading-17">é‡è¯•ç­–ç•¥ï¼šé™æ¬¡ä¸é™æ—¶</h3>
<p>JobFlow çš„é‡è¯•ç­–ç•¥å¾ˆç®€å•ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">max_retry</span> = <span class="hljs-number">3</span>  ï¼ˆå¯é…ç½®ï¼‰

ç¬¬1æ¬¡å¤±è´¥ï¼šç«‹å³é‡è¯•
ç¬¬2æ¬¡å¤±è´¥ï¼šç«‹å³é‡è¯•
ç¬¬3æ¬¡å¤±è´¥ï¼šç«‹å³é‡è¯•
ç¬¬4æ¬¡å¤±è´¥ï¼šæ ‡è®°æœ€ç»ˆå¤±è´¥ï¼Œä¸å†é‡è¯•
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆä¸ç”¨æŒ‡æ•°é€€é¿ï¼Ÿ</strong></p>
<p>å‘¨æœŸä»»åŠ¡çš„é‡è¯•å’Œå»¶æ—¶ä»»åŠ¡ä¸åŒï¼š</p>
<p>å‘¨æœŸä»»åŠ¡ï¼š</p>
<ul>
<li>æ‰§è¡Œçª—å£æœ‰é™ï¼ˆä¸‹ä¸€è½®å¾ˆå¿«å°±æ¥äº†ï¼‰</li>
<li>å¸Œæœ›å°½å¿«å®Œæˆ</li>
<li>å¤±è´¥åŸå› é€šå¸¸æ˜¯ä¸´æ—¶æ€§çš„ï¼ˆç½‘ç»œæŠ–åŠ¨ã€GCæš‚åœï¼‰</li>
</ul>
<p>å»¶æ—¶ä»»åŠ¡ï¼š</p>
<ul>
<li>æ‰§è¡Œæ—¶é—´çµæ´»</li>
<li>å¯ä»¥ç­‰ä¸€ç­‰</li>
<li>éœ€è¦é¿å…é›ªå´©</li>
</ul>
<p>æ‰€ä»¥å‘¨æœŸä»»åŠ¡ç”¨"é™æ¬¡ä¸é™æ—¶"ï¼Œå»¶æ—¶ä»»åŠ¡ç”¨"æŒ‡æ•°é€€é¿"ã€‚</p>
<h3 data-id="heading-18">è¡¥å¿çš„è§¦å‘æ—¶æœº</h3>
<p>è¡¥å¿æœ‰ä¸¤ä¸ªè§¦å‘å…¥å£ï¼š</p>
<p><strong>å…¥å£ä¸€ï¼šè¶…æ—¶å·¡æ£€</strong>ï¼ˆå‰é¢è®²è¿‡ï¼‰</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">inspectTimeoutSubExecutions</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">for</span> (JobSubExecution sub : timeoutSubs) {
        <span class="hljs-keyword">if</span> (sub.getStatus() == PENDING) {
            handleSubExecutionForCompensation(sub, now);
        }
    }
}
</code></pre>
<p><strong>å…¥å£äºŒï¼šç«‹å³å¤±è´¥</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è°ƒç”¨æ‰§è¡Œå™¨å¤±è´¥æ—¶ï¼Œç«‹å³æ ‡è®° FAILED</span>
<span class="hljs-keyword">if</span> (!success) {
    jobRepository.updateSubExecutionStatus(sub.getId(), FAILED, now, errorMsg);
}
</code></pre>
<p>è¿™æ ·ä¸¤æ¡è·¯å¾„é…åˆï¼š</p>
<pre><code class="hljs">ç«‹å³å¤±è´¥ï¼šå¿«é€Ÿå“åº”ï¼Œä¸ç­‰å·¡æ£€
è¶…æ—¶å·¡æ£€ï¼šå…œåº•ä¿æŠ¤ï¼Œé˜²æ­¢é—æ¼
</code></pre>
<h2 data-id="heading-19">å…­ã€ä½é¢‘ä»»åŠ¡çš„æ¼è°ƒæ£€æµ‹</h2>
<h3 data-id="heading-20">ä»€ä¹ˆæ˜¯æ¼è°ƒï¼Ÿ</h3>
<p>æ¼è°ƒæ˜¯æŒ‡ï¼šä»»åŠ¡æœ¬è¯¥æ‰§è¡Œï¼Œä½†æ•´è½®éƒ½æ²¡è§¦å‘ã€‚</p>
<pre><code class="hljs">ç¤ºä¾‹ï¼šæ¯å¤©å‡Œæ™¨2ç‚¹çš„å¯¹è´¦ä»»åŠ¡

æ­£å¸¸æƒ…å†µï¼š
12æœˆ20æ—¥ 02:00:00 â†’ æ‰§è¡Œ
12æœˆ21æ—¥ 02:00:00 â†’ æ‰§è¡Œ
12æœˆ22æ—¥ 02:00:00 â†’ æ‰§è¡Œ

æ¼è°ƒæƒ…å†µï¼š
12æœˆ20æ—¥ 02:00:00 â†’ æ‰§è¡Œ
12æœˆ21æ—¥ 02:00:00 â†’ æ²¡æ‰§è¡Œï¼ˆæ‰€æœ‰è°ƒåº¦å™¨éƒ½æŒ‚äº†ï¼‰
12æœˆ22æ—¥ 02:00:00 â†’ æ‰§è¡Œ

é—®é¢˜ï¼š21å·çš„å¯¹è´¦ä»»åŠ¡æ¼äº†
</code></pre>
<p>å¯¹äºé«˜é¢‘ä»»åŠ¡ï¼ˆåˆ†é’Ÿçº§ï¼‰ï¼Œæ¼è°ƒå½±å“è¾ƒå°ï¼Œå¾ˆå¿«å°±æœ‰ä¸‹ä¸€è½®ã€‚</p>
<p>ä½†å¯¹äºä½é¢‘ä»»åŠ¡ï¼ˆå°æ—¶çº§ã€å¤©çº§ï¼‰ï¼Œæ¼è°ƒå¯èƒ½å¯¼è‡´ä¸¥é‡åæœï¼š</p>
<pre><code class="hljs">å¯¹è´¦ä»»åŠ¡æ¼è°ƒï¼šè´¢åŠ¡æ•°æ®ä¸å‡†
æŠ¥è¡¨ç”Ÿæˆæ¼è°ƒï¼šä¸šåŠ¡å†³ç­–å»¶è¯¯
æ•°æ®æ¸…ç†æ¼è°ƒï¼šç£ç›˜ç©ºé—´è€—å°½
</code></pre>
<h3 data-id="heading-21">æ€ä¹ˆæ£€æµ‹æ¼è°ƒï¼Ÿ</h3>
<p>JobFlow çš„æ€è·¯ï¼š<strong>æ—¶é—´çª—å£ + æ‰§è¡Œè®°å½•</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[è®¡ç®—Cronå‘¨æœŸ] --&gt; B{å‘¨æœŸå¤§äºç­‰äº1å°æ—¶?}
    B --&gt;|å¦| C[é«˜é¢‘ä»»åŠ¡&lt;br/&gt;è·³è¿‡]
    B --&gt;|æ˜¯| D[è®¡ç®—ä¸Šä¸€è½®æ—¶é—´çª—å£]
    D --&gt; E{çª—å£å†…æœ‰æ‰§è¡Œè®°å½•?}
    E --&gt;|æ˜¯| F[æœªæ¼è°ƒ]
    E --&gt;|å¦| G[è§¦å‘è¡¥å¿]
    
    style A fill:#87CEEB
    style B fill:#FFE4B5
    style C fill:#D3D3D3
    style D fill:#87CEEB
    style E fill:#FFE4B5
    style G fill:#90EE90
    style G fill:#90EE90
</code></pre>
<p>æ ¸å¿ƒé€»è¾‘ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. è§£æ Cronï¼Œè®¡ç®—å‘¨æœŸ</span>
<span class="hljs-type">CronExpression</span> <span class="hljs-variable">cronExpression</span> <span class="hljs-operator">=</span> CronExpression.parse(cron);
<span class="hljs-type">LocalDateTime</span> <span class="hljs-variable">next1</span> <span class="hljs-operator">=</span> cronExpression.next(now.minusSeconds(<span class="hljs-number">1</span>));
<span class="hljs-type">LocalDateTime</span> <span class="hljs-variable">next2</span> <span class="hljs-operator">=</span> cronExpression.next(next1);
<span class="hljs-type">Duration</span> <span class="hljs-variable">period</span> <span class="hljs-operator">=</span> Duration.between(next1, next2);

<span class="hljs-comment">// 2. è¿‡æ»¤ï¼šåªæ£€æµ‹å‘¨æœŸ â‰¥ 1 å°æ—¶çš„ä»»åŠ¡</span>
<span class="hljs-keyword">if</span> (period == <span class="hljs-literal">null</span> || period.toMinutes() &lt; <span class="hljs-number">60</span>) {
    <span class="hljs-keyword">return</span>;  <span class="hljs-comment">// é«˜é¢‘ä»»åŠ¡ä¸æ£€æµ‹</span>
}

<span class="hljs-comment">// 3. è®¡ç®—ä¸Šä¸€è½®çš„æ—¶é—´çª—å£</span>
<span class="hljs-type">LocalDateTime</span> <span class="hljs-variable">lastSlotTime</span> <span class="hljs-operator">=</span> next1.minus(period);
<span class="hljs-type">LocalDateTime</span> <span class="hljs-variable">windowStart</span> <span class="hljs-operator">=</span> lastSlotTime;
<span class="hljs-type">LocalDateTime</span> <span class="hljs-variable">windowEnd</span> <span class="hljs-operator">=</span> now;

<span class="hljs-comment">// 4. æŸ¥è¯¢çª—å£å†…æ˜¯å¦æœ‰æ‰§è¡Œè®°å½•</span>
<span class="hljs-type">boolean</span> <span class="hljs-variable">exists</span> <span class="hljs-operator">=</span> jobRepository.existsExecutionInWindow(
    job.getName(), windowStart, windowEnd);

<span class="hljs-comment">// 5. å¦‚æœæ²¡æœ‰è®°å½•ï¼Œè§¦å‘è¡¥å¿</span>
<span class="hljs-keyword">if</span> (!exists) {
    log.info(<span class="hljs-string">"æ£€æµ‹åˆ°ä½é¢‘ä»»åŠ¡æ¼è°ƒï¼Œè§¦å‘è¡¥å¿ï¼ŒjobName={}, window=[{}, {}]"</span>,
        job.getName(), windowStart, windowEnd);
    triggerExecution(job, now);
}
</code></pre>
<p>SQL æŸ¥è¯¢ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">FROM</span> job_execution 
<span class="hljs-keyword">WHERE</span> job_name <span class="hljs-operator">=</span> ? 
  <span class="hljs-keyword">AND</span> trigger_time <span class="hljs-operator">&gt;=</span> ? 
  <span class="hljs-keyword">AND</span> trigger_time <span class="hljs-operator">&lt;</span> ?
</code></pre>
<h3 data-id="heading-22">æ—¶é—´çª—å£ç¤ºä¾‹</h3>
<p>ä»¥"æ¯å¤©å‡Œæ™¨2ç‚¹"çš„ä»»åŠ¡ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">å½“å‰æ—¶é—´ï¼š2024-12-22 10:00:00

è®¡ç®—è¿‡ç¨‹ï¼š
<span class="hljs-attr">1. next1</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">12</span>-<span class="hljs-number">23</span> <span class="hljs-number">02</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>ï¼ˆä¸‹ä¸€ä¸ªè§¦å‘æ—¶é—´ï¼‰
<span class="hljs-attr">2. next2</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">12</span>-<span class="hljs-number">24</span> <span class="hljs-number">02</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>ï¼ˆå†ä¸‹ä¸€ä¸ªè§¦å‘æ—¶é—´ï¼‰
<span class="hljs-attr">3. period</span> = <span class="hljs-number">24</span>å°æ—¶
<span class="hljs-attr">4. lastSlotTime</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">12</span>-<span class="hljs-number">23</span> <span class="hljs-number">02</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> - <span class="hljs-number">24</span>å°æ—¶ = <span class="hljs-number">2024</span>-<span class="hljs-number">12</span>-<span class="hljs-number">22</span> <span class="hljs-number">02</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>

æ—¶é—´çª—å£ï¼š
<span class="hljs-attr">windowStart</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">12</span>-<span class="hljs-number">22</span> <span class="hljs-number">02</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>
<span class="hljs-attr">windowEnd</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">12</span>-<span class="hljs-number">22</span> <span class="hljs-number">10</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>ï¼ˆå½“å‰æ—¶é—´ï¼‰

åˆ¤æ–­ï¼š
å¦‚æœçª—å£å†…æœ‰æ‰§è¡Œè®°å½• â†’ æœªæ¼è°ƒ
å¦‚æœçª—å£å†…æ²¡æœ‰æ‰§è¡Œè®°å½• â†’ æ¼è°ƒäº†ï¼Œè¡¥å¿ä¸€æ¬¡
</code></pre>
<h3 data-id="heading-23">ä¸ºä»€ä¹ˆåªæ£€æµ‹ä½é¢‘ä»»åŠ¡ï¼Ÿ</h3>
<p>å› ä¸ºé«˜é¢‘ä»»åŠ¡çš„æ¼è°ƒå½±å“å°ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">åˆ†é’Ÿçº§ä»»åŠ¡ï¼š
<span class="hljs-deletion">- æ¼è°ƒä¸€æ¬¡ï¼Œ1åˆ†é’Ÿåå°±æœ‰ä¸‹ä¸€è½®</span>
<span class="hljs-deletion">- ä¸šåŠ¡å½±å“å°</span>
<span class="hljs-deletion">- å®¹æ˜“è¢«ç›‘æ§å‘ç°</span>

å°æ—¶çº§ä»»åŠ¡ï¼š
<span class="hljs-deletion">- æ¼è°ƒä¸€æ¬¡ï¼Œè¦ç­‰1å°æ—¶</span>
<span class="hljs-deletion">- å¯èƒ½å½±å“ä¸šåŠ¡</span>
<span class="hljs-deletion">- ä¸å®¹æ˜“è¢«å‘ç°</span>

å¤©çº§ä»»åŠ¡ï¼š
<span class="hljs-deletion">- æ¼è°ƒä¸€æ¬¡ï¼Œè¦ç­‰1å¤©</span>
<span class="hljs-deletion">- ä¸¥é‡å½±å“ä¸šåŠ¡</span>
<span class="hljs-deletion">- å¾ˆéš¾è¢«å‘ç°</span>
</code></pre>
<p>æ‰€ä»¥ JobFlow çš„ç­–ç•¥æ˜¯ï¼š</p>
<pre><code class="hljs">é«˜é¢‘ä»»åŠ¡ï¼ˆ&lt; 1å°æ—¶ï¼‰ï¼šä¸æ£€æµ‹ï¼Œé ç›‘æ§
ä½é¢‘ä»»åŠ¡ï¼ˆâ‰¥ 1å°æ—¶ï¼‰ï¼šä¸»åŠ¨æ£€æµ‹ï¼Œè‡ªåŠ¨è¡¥å¿
</code></pre>
<h3 data-id="heading-24">æ¼è°ƒæ£€æµ‹çš„è§¦å‘é¢‘ç‡</h3>
<p>æ¼è°ƒæ£€æµ‹ä¸éœ€è¦å¤ªé¢‘ç¹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Scheduled(fixedDelay = 600000)</span>  <span class="hljs-comment">// 10åˆ†é’Ÿä¸€æ¬¡</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">compensateLowFrequencyMisfires</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (!clusterInstanceService.shouldRunInspection()) {
        <span class="hljs-keyword">return</span>;  <span class="hljs-comment">// éå·¡æ£€leaderï¼Œè·³è¿‡</span>
    }
    
    List&lt;JobDefinition&gt; jobs = jobRepository.findAllEnabledJobs();
    <span class="hljs-keyword">for</span> (JobDefinition job : jobs) {
        compensateIfLowFrequencyAndMissed(job, LocalDateTime.now());
    }
}
</code></pre>
<p>ä¸ºä»€ä¹ˆ10åˆ†é’Ÿä¸€æ¬¡å°±å¤Ÿäº†ï¼Ÿ</p>
<pre><code class="hljs">å¯¹äºå°æ—¶çº§ä»»åŠ¡ï¼š10åˆ†é’Ÿæ£€æµ‹ä¸€æ¬¡ï¼Œè¶³å¤ŸåŠæ—¶
å¯¹äºå¤©çº§ä»»åŠ¡ï¼š10åˆ†é’Ÿæ£€æµ‹ä¸€æ¬¡ï¼Œæ›´å¤Ÿäº†
å¯¹äºåˆ†é’Ÿçº§ä»»åŠ¡ï¼šä¸æ£€æµ‹ï¼Œç­‰ä¸‹ä¸€è½®å°±å¥½
</code></pre>
<h2 data-id="heading-25">ä¸ƒã€å»¶æ—¶ä»»åŠ¡çš„è¶…æ—¶ä¸é‡è¯•</h2>
<p>å»¶æ—¶ä»»åŠ¡å’Œå‘¨æœŸä»»åŠ¡ä¸åŒï¼Œå®ƒæ˜¯ä¸€æ¬¡æ€§çš„ï¼š</p>
<pre><code class="hljs">å‘¨æœŸä»»åŠ¡ï¼šæ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œ
å»¶æ—¶ä»»åŠ¡ï¼š30åˆ†é’Ÿåæ‰§è¡Œä¸€æ¬¡
</code></pre>
<h3 data-id="heading-26">å»¶æ—¶ä»»åŠ¡çš„çŠ¶æ€æœº</h3>
<p>å»¶æ—¶ä»»åŠ¡çš„çŠ¶æ€æµè½¬ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[PENDING&lt;br/&gt;ç­‰å¾…ä¸­] --&gt; B[SENDING&lt;br/&gt;è°ƒç”¨ä¸­]
    B --&gt; C[SENT&lt;br/&gt;å·²å‘é€]
    B --&gt; D[FAILED&lt;br/&gt;å¤±è´¥]
    D --&gt; E{é‡è¯•æ¬¡æ•°?}
    E --&gt;|æœªè¾¾ä¸Šé™| A
    E --&gt;|è¾¾åˆ°ä¸Šé™| F[FAILED_FINAL&lt;br/&gt;æœ€ç»ˆå¤±è´¥]
    
    style A fill:#87CEEB
    style B fill:#FFE4B5
    style C fill:#90EE90
    style D fill:#FFB6C1
    style F fill:#FF6B6B
</code></pre>
<p>æ ¸å¿ƒå­—æ®µï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> job_delay_task (
    id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">PRIMARY</span> KEY,
    execute_time <span class="hljs-type">TIMESTAMP</span>,      <span class="hljs-comment">-- é¢„æœŸæ‰§è¡Œæ—¶é—´</span>
    next_attempt_time <span class="hljs-type">TIMESTAMP</span>, <span class="hljs-comment">-- ä¸‹æ¬¡é‡è¯•æ—¶é—´</span>
    status <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>),          <span class="hljs-comment">-- PENDING/SENDING/SENT/FAILED/FAILED_FINAL</span>
    retry_count <span class="hljs-type">INT</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span>,   <span class="hljs-comment">-- é‡è¯•æ¬¡æ•°</span>
    max_retry <span class="hljs-type">INT</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">3</span>,     <span class="hljs-comment">-- æœ€å¤§é‡è¯•æ¬¡æ•°</span>
    ...
);
</code></pre>
<h3 data-id="heading-27">è°ƒåº¦æµç¨‹</h3>
<p>å»¶æ—¶ä»»åŠ¡çš„è°ƒåº¦é€»è¾‘ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[æ‰«æåˆ°æœŸä»»åŠ¡] --&gt; B{isOwner?}
    B --&gt;|å¦| C[è·³è¿‡]
    B --&gt;|æ˜¯| D[CASæ›´æ–°&lt;br/&gt;PENDING to SENDING]
    D --&gt; E{CASæˆåŠŸ?}
    E --&gt;|å¦| F[å…¶ä»–å®ä¾‹å¤„ç†]
    E --&gt;|æ˜¯| G[HTTPè°ƒç”¨æ‰§è¡Œå™¨]
    G --&gt; H{æˆåŠŸ?}
    H --&gt;|æ˜¯| I[æ ‡è®°SENT]
    H --&gt;|å¦| J[é‡è¯•é€»è¾‘]
    
    style A fill:#87CEEB
    style B fill:#FFE4B5
    style D fill:#87CEEB
    style G fill:#FFE4B5
    style I fill:#90EE90
    style J fill:#FFB6C1
</code></pre>
<p>å…³é”®ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. Owner åˆ¤å®šï¼ˆæŒ‰ serviceName åˆ†åŒºï¼‰</span>
<span class="hljs-keyword">if</span> (!clusterInstanceService.isOwner(task.getServiceName())) {
    <span class="hljs-keyword">return</span>;
}

<span class="hljs-comment">// 2. CAS æŠ¢å </span>
<span class="hljs-type">boolean</span> <span class="hljs-variable">locked</span> <span class="hljs-operator">=</span> delayTaskRepository.tryMarkSending(
    task.getId(), task.getStatus(), task.getRetryCount());
<span class="hljs-keyword">if</span> (!locked) {
    <span class="hljs-keyword">return</span>;  <span class="hljs-comment">// è¢«å…¶ä»–å®ä¾‹æŠ¢äº†</span>
}

<span class="hljs-comment">// 3. HTTP è°ƒç”¨</span>
<span class="hljs-type">boolean</span> <span class="hljs-variable">success</span> <span class="hljs-operator">=</span> callExecutor(task);

<span class="hljs-comment">// 4. æ›´æ–°çŠ¶æ€</span>
<span class="hljs-keyword">if</span> (success) {
    delayTaskRepository.markSent(task.getId(), LocalDateTime.now());
} <span class="hljs-keyword">else</span> {
    handleCallFailure(task, errorMsg);
}
</code></pre>
<h3 data-id="heading-28">é‡è¯•ç­–ç•¥ï¼šæŒ‡æ•°é€€é¿</h3>
<p>å»¶æ—¶ä»»åŠ¡çš„é‡è¯•ç”¨æŒ‡æ•°é€€é¿ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleCallFailure</span><span class="hljs-params">(JobDelayTask task, String errorMsg)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">newRetryCount</span> <span class="hljs-operator">=</span> task.getRetryCount() + <span class="hljs-number">1</span>;
    
    <span class="hljs-keyword">if</span> (newRetryCount &gt;= task.getMaxRetry()) {
        <span class="hljs-comment">// æ ‡è®°æœ€ç»ˆå¤±è´¥</span>
        delayTaskRepository.markFailedFinal(task.getId(), newRetryCount, errorMsg);
        <span class="hljs-keyword">return</span>;
    }
    
    <span class="hljs-comment">// è®¡ç®—ä¸‹æ¬¡é‡è¯•æ—¶é—´</span>
    LocalDateTime nextAttempt;
    <span class="hljs-keyword">if</span> (newRetryCount == <span class="hljs-number">1</span>) {
        nextAttempt = now.plusMinutes(<span class="hljs-number">3</span>);   <span class="hljs-comment">// ç¬¬1æ¬¡ï¼š3åˆ†é’Ÿå</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (newRetryCount == <span class="hljs-number">2</span>) {
        nextAttempt = now.plusMinutes(<span class="hljs-number">5</span>);   <span class="hljs-comment">// ç¬¬2æ¬¡ï¼š5åˆ†é’Ÿå</span>
    } <span class="hljs-keyword">else</span> {
        nextAttempt = now.plusMinutes(<span class="hljs-number">5</span>);   <span class="hljs-comment">// ç¬¬3æ¬¡ï¼š5åˆ†é’Ÿå</span>
    }
    
    delayTaskRepository.markFailedAndScheduleNext(
        task.getId(), newRetryCount, nextAttempt, errorMsg);
}
</code></pre>
<p>é‡è¯•æ—¶é—´è½´ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">åˆå§‹æ‰§è¡Œï¼š<span class="hljs-attr">execute_time</span> = <span class="hljs-number">10</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>
ç¬¬1æ¬¡å¤±è´¥ï¼š<span class="hljs-attr">next_attempt_time</span> = <span class="hljs-number">10</span>:<span class="hljs-number">03</span>:<span class="hljs-number">00</span>ï¼ˆ+<span class="hljs-number">3</span>åˆ†é’Ÿï¼‰
ç¬¬2æ¬¡å¤±è´¥ï¼š<span class="hljs-attr">next_attempt_time</span> = <span class="hljs-number">10</span>:<span class="hljs-number">08</span>:<span class="hljs-number">00</span>ï¼ˆ+<span class="hljs-number">5</span>åˆ†é’Ÿï¼‰
ç¬¬3æ¬¡å¤±è´¥ï¼š<span class="hljs-attr">next_attempt_time</span> = <span class="hljs-number">10</span>:<span class="hljs-number">13</span>:<span class="hljs-number">00</span>ï¼ˆ+<span class="hljs-number">5</span>åˆ†é’Ÿï¼‰
ç¬¬4æ¬¡å¤±è´¥ï¼šæ ‡è®° FAILED_FINAL
</code></pre>
<h3 data-id="heading-29">SENDING è¶…æ—¶æ£€æµ‹</h3>
<p>å»¶æ—¶ä»»åŠ¡è¿˜æœ‰ä¸ªç‰¹æ®Šåœºæ™¯ï¼šè°ƒç”¨æ‰§è¡Œå™¨åï¼Œä¸€ç›´æ²¡å“åº”ã€‚</p>
<p>è¿™æ—¶å€™æ•°æ®åº“é‡Œçš„çŠ¶æ€æ˜¯ SENDINGï¼Œéœ€è¦æœ‰ä¸ªè¶…æ—¶æ£€æµ‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ‰«æ SENDING è¶…æ—¶ä»»åŠ¡</span>
List&lt;JobDelayTask&gt; stuckTasks = delayTaskRepository.findStuckSendingTasks(
    sendingTimeoutSeconds, scanBatchSize);

<span class="hljs-keyword">for</span> (JobDelayTask task : stuckTasks) {
    handleSendingTimeout(task);
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleSendingTimeout</span><span class="hljs-params">(JobDelayTask task)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">timeoutMsg</span> <span class="hljs-operator">=</span> <span class="hljs-string">"SENDING timeout (over "</span> + sendingTimeoutSeconds + <span class="hljs-string">" seconds)"</span>;
    log.warn(<span class="hljs-string">"æ£€æµ‹åˆ°SENDINGè¶…æ—¶ï¼Œè§†ä¸ºå¤±è´¥ï¼ŒtraceId={}"</span>, task.getTraceId());
    handleCallFailure(task, timeoutMsg);
}
</code></pre>
<p>æŸ¥è¯¢ SQLï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> job_delay_task 
<span class="hljs-keyword">WHERE</span> status <span class="hljs-operator">=</span> <span class="hljs-string">'SENDING'</span> 
  <span class="hljs-keyword">AND</span> sent_at <span class="hljs-operator">&lt;</span> NOW() <span class="hljs-operator">-</span> <span class="hljs-type">INTERVAL</span> ? <span class="hljs-keyword">SECOND</span>
LIMIT ?
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡ï¼Ÿ</strong></p>
<pre><code class="hljs language-diff" lang="diff">åœºæ™¯ï¼šè°ƒç”¨æ‰§è¡Œå™¨åï¼Œæ‰§è¡Œå™¨æŒ‚äº†

ç»“æœï¼š
<span class="hljs-deletion">- å›è°ƒä¸ä¼šæ¥</span>
<span class="hljs-deletion">- çŠ¶æ€ä¸€ç›´æ˜¯ SENDING</span>
<span class="hljs-deletion">- éœ€è¦è¶…æ—¶æ£€æµ‹æ¥å…œåº•</span>

å¤„ç†ï¼š
<span class="hljs-deletion">- è§†ä¸ºä¸€æ¬¡å¤±è´¥</span>
<span class="hljs-deletion">- è¿›å…¥é‡è¯•æµç¨‹</span>
<span class="hljs-deletion">- æœ€å¤šé‡è¯•3æ¬¡</span>
</code></pre>
<h2 data-id="heading-30">å…«ã€å·¡æ£€ä»»åŠ¡çš„åè°ƒï¼šè°æ¥åšï¼Ÿ</h2>
<p>å‰é¢è®²äº†ä¸‰ç§å·¡æ£€ï¼š</p>
<ul>
<li>è¶…æ—¶å·¡æ£€ï¼ˆåˆ†ç‰‡è¶…æ—¶ï¼‰</li>
<li>åˆ†ç‰‡è¡¥å¿ï¼ˆåˆ†ç‰‡å¤±è´¥ï¼‰</li>
<li>æ¼è°ƒæ£€æµ‹ï¼ˆä½é¢‘ä»»åŠ¡ï¼‰</li>
</ul>
<p>è¿™äº›å·¡æ£€éƒ½éœ€è¦æœ‰äººåšï¼Œä½†ä¸èƒ½æ‰€æœ‰å®ä¾‹éƒ½åšï¼ˆä¼šé‡å¤ï¼‰ã€‚</p>
<h3 data-id="heading-31">é€‰ä¸»ç­–ç•¥ï¼šæœ€å°èŠ‚ç‚¹</h3>
<p>JobFlow çš„é€‰ä¸»å¾ˆç®€å•ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[ä»Nacosè·å–&lt;br/&gt;æ‰€æœ‰è°ƒåº¦å™¨å®ä¾‹] --&gt; B[æŒ‰IP:PORTæ’åº]
    B --&gt; C{æˆ‘æ˜¯æœ€å°çš„?}
    C --&gt;|æ˜¯| D[æˆ‘æ˜¯Leader&lt;br/&gt;è´Ÿè´£å·¡æ£€]
    C --&gt;|å¦| E[æˆ‘æ˜¯Follower&lt;br/&gt;è·³è¿‡å·¡æ£€]
    
    style A fill:#87CEEB
    style B fill:#87CEEB
    style C fill:#FFE4B5
    style D fill:#90EE90
    style E fill:#D3D3D3
</code></pre>
<p>ä»£ç å®ç°ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">shouldRunInspection</span><span class="hljs-params">()</span> {
    List&lt;ServiceInstance&gt; instances = discoveryClient.getInstances(<span class="hljs-string">"jobflow-scheduler"</span>);
    <span class="hljs-keyword">if</span> (instances == <span class="hljs-literal">null</span> || instances.isEmpty()) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-comment">// æ’åº</span>
    instances.sort(Comparator.comparing(i -&gt; i.getHost() + <span class="hljs-string">":"</span> + i.getPort()));
    
    <span class="hljs-comment">// åˆ¤æ–­æˆ‘æ˜¯ä¸æ˜¯æœ€å°çš„</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">smallest</span> <span class="hljs-operator">=</span> instances.get(<span class="hljs-number">0</span>).getHost() + <span class="hljs-string">":"</span> + instances.get(<span class="hljs-number">0</span>).getPort();
    <span class="hljs-type">String</span> <span class="hljs-variable">myself</span> <span class="hljs-operator">=</span> localHost + <span class="hljs-string">":"</span> + localPort;
    
    <span class="hljs-keyword">return</span> smallest.equals(myself);
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆé€‰æœ€å°èŠ‚ç‚¹ï¼Ÿ</strong></p>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>ç®€å•ï¼šä¸éœ€è¦å¤æ‚çš„é€‰ä¸¾ç®—æ³•</li>
<li>ç¡®å®šï¼šæ‰€æœ‰å®ä¾‹çœ‹åˆ°çš„æ’åºç»“æœä¸€è‡´</li>
<li>å¿«é€Ÿï¼šæœ€å°èŠ‚ç‚¹æŒ‚äº†ï¼Œä¸‹ä¸€ä¸ªç«‹åˆ»æ¥ç®¡</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>è´Ÿè½½ä¸å‡ï¼šæ‰€æœ‰å·¡æ£€éƒ½åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Š</li>
</ul>
<p>ä½†å¯¹äºå·¡æ£€ä»»åŠ¡æ¥è¯´ï¼Œè´Ÿè½½å¾ˆå°ï¼Œè¿™ä¸ªç¼ºç‚¹å¯ä»¥æ¥å—ã€‚</p>
<h3 data-id="heading-32">å·¡æ£€é¢‘ç‡</h3>
<p>ä¸åŒå·¡æ£€çš„é¢‘ç‡ä¸åŒï¼š</p>
<pre><code class="hljs language-diff" lang="diff">è¶…æ—¶å·¡æ£€ï¼š3åˆ†é’Ÿä¸€æ¬¡
<span class="hljs-deletion">- éœ€è¦åŠæ—¶å‘ç°å¡ä½çš„ä»»åŠ¡</span>
<span class="hljs-deletion">- ä½†ä¹Ÿä¸èƒ½å¤ªé¢‘ç¹ï¼Œé¿å…æ‰“çˆ†æ‰§è¡Œå™¨</span>

åˆ†ç‰‡è¡¥å¿ï¼šéšè¶…æ—¶å·¡æ£€è§¦å‘
<span class="hljs-deletion">- å’Œè¶…æ—¶å·¡æ£€æ˜¯ä¸€èµ·çš„</span>

æ¼è°ƒæ£€æµ‹ï¼š10åˆ†é’Ÿä¸€æ¬¡
<span class="hljs-deletion">- ä½é¢‘ä»»åŠ¡æœ¬æ¥å°±æ…¢ï¼Œä¸éœ€è¦å¤ªé¢‘ç¹</span>
<span class="hljs-deletion">- é™ä½æ•°æ®åº“å‹åŠ›</span>
</code></pre>
<h2 data-id="heading-33">ä¹ã€è®¾è®¡æƒè¡¡ä¸å–èˆ</h2>
<p>å›é¡¾ä¸€ä¸‹ JobFlow åœ¨è¶…æ—¶ã€è¡¥å¿ã€æ¼è°ƒè¿™ä¸‰ä¸ªé—®é¢˜ä¸Šçš„è®¾è®¡æƒè¡¡ï¼š</p>
<h3 data-id="heading-34">æƒè¡¡ä¸€ï¼šè¯¢é—® vs ç›´æ¥åˆ¤æ­»åˆ‘</h3>
<p><strong>æ–¹æ¡ˆAï¼šç›´æ¥åˆ¤æ­»åˆ‘</strong></p>
<ul>
<li>ä¼˜ç‚¹ï¼šç®€å•å¿«é€Ÿ</li>
<li>ç¼ºç‚¹ï¼šè¯¯æ€æ­£å¸¸ä»»åŠ¡</li>
</ul>
<p><strong>æ–¹æ¡ˆBï¼šå…ˆè¯¢é—®æ‰§è¡Œå™¨</strong>ï¼ˆJobFlow çš„é€‰æ‹©ï¼‰</p>
<ul>
<li>ä¼˜ç‚¹ï¼šå‡†ç¡®æ€§é«˜ï¼Œé¿å…è¯¯åˆ¤</li>
<li>ç¼ºç‚¹ï¼šå¢åŠ ä¸€æ¬¡ HTTP è°ƒç”¨</li>
</ul>
<p>JobFlow é€‰æ‹©äº†æ–¹æ¡ˆBï¼Œå› ä¸ºï¼š</p>
<pre><code class="hljs language-diff" lang="diff">å¯¹äºæ‰¹å¤„ç†ä»»åŠ¡ï¼š
<span class="hljs-deletion">- æ•°æ®é‡å¤§ï¼Œç¡®å®å¾ˆæ…¢</span>
<span class="hljs-deletion">- è¯¯åˆ¤æˆæœ¬é«˜ï¼ˆä»»åŠ¡ç™½è·‘äº†ï¼‰</span>
<span class="hljs-deletion">- å¤šä¸€æ¬¡ HTTP è¯¢é—®ï¼Œæˆæœ¬å¯æ¥å—</span>
</code></pre>
<h3 data-id="heading-35">æƒè¡¡äºŒï¼šç«‹å³é‡è¯• vs æŒ‡æ•°é€€é¿</h3>
<p><strong>å‘¨æœŸä»»åŠ¡ï¼šç«‹å³é‡è¯•</strong></p>
<ul>
<li>åŸå› ï¼šæ‰§è¡Œçª—å£æœ‰é™</li>
<li>ç›®æ ‡ï¼šå°½å¿«å®Œæˆ</li>
</ul>
<p><strong>å»¶æ—¶ä»»åŠ¡ï¼šæŒ‡æ•°é€€é¿</strong></p>
<ul>
<li>åŸå› ï¼šæ—¶é—´çµæ´»</li>
<li>ç›®æ ‡ï¼šé¿å…é›ªå´©</li>
</ul>
<p>è¿™æ˜¯æ ¹æ®åœºæ™¯ç‰¹ç‚¹åšçš„å·®å¼‚åŒ–è®¾è®¡ã€‚</p>
<h3 data-id="heading-36">æƒè¡¡ä¸‰ï¼šå…¨é‡æ£€æµ‹ vs åˆ†å±‚æ£€æµ‹</h3>
<p><strong>æ–¹æ¡ˆAï¼šæ‰€æœ‰ä»»åŠ¡éƒ½æ£€æµ‹æ¼è°ƒ</strong></p>
<ul>
<li>ä¼˜ç‚¹ï¼šè¦†ç›–å…¨é¢</li>
<li>ç¼ºç‚¹ï¼šæ•°æ®åº“å‹åŠ›å¤§</li>
</ul>
<p><strong>æ–¹æ¡ˆBï¼šåªæ£€æµ‹ä½é¢‘ä»»åŠ¡</strong>ï¼ˆJobFlow çš„é€‰æ‹©ï¼‰</p>
<ul>
<li>ä¼˜ç‚¹ï¼šæ€§ä»·æ¯”é«˜</li>
<li>ç¼ºç‚¹ï¼šé«˜é¢‘ä»»åŠ¡æ¼è°ƒä¸ç®¡</li>
</ul>
<p>JobFlow é€‰æ‹©äº†æ–¹æ¡ˆBï¼Œå› ä¸ºï¼š</p>
<pre><code class="hljs language-diff" lang="diff">é«˜é¢‘ä»»åŠ¡æ¼è°ƒå½±å“å°ï¼š
<span class="hljs-deletion">- 1åˆ†é’Ÿåå°±æœ‰ä¸‹ä¸€è½®</span>
<span class="hljs-deletion">- å®¹æ˜“è¢«ç›‘æ§å‘ç°</span>
<span class="hljs-deletion">- ä¸éœ€è¦ä¸»åŠ¨æ£€æµ‹</span>

ä½é¢‘ä»»åŠ¡æ¼è°ƒå½±å“å¤§ï¼š
<span class="hljs-deletion">- å¯èƒ½è¦ç­‰å¾ˆä¹…</span>
<span class="hljs-deletion">- ä¸å®¹æ˜“è¢«å‘ç°</span>
<span class="hljs-deletion">- éœ€è¦ä¸»åŠ¨æ£€æµ‹</span>
</code></pre>
<h3 data-id="heading-37">æƒè¡¡å››ï¼šæ‰€æœ‰å®ä¾‹å·¡æ£€ vs å•å®ä¾‹å·¡æ£€</h3>
<p><strong>æ–¹æ¡ˆAï¼šæ‰€æœ‰å®ä¾‹éƒ½å·¡æ£€</strong></p>
<ul>
<li>ä¼˜ç‚¹ï¼šåˆ†å¸ƒå¼ï¼Œè´Ÿè½½å‡è¡¡</li>
<li>ç¼ºç‚¹ï¼šå®¹æ˜“é‡å¤ï¼Œéœ€è¦åˆ†å¸ƒå¼é”</li>
</ul>
<p><strong>æ–¹æ¡ˆBï¼šæœ€å°èŠ‚ç‚¹å·¡æ£€</strong>ï¼ˆJobFlow çš„é€‰æ‹©ï¼‰</p>
<ul>
<li>ä¼˜ç‚¹ï¼šç®€å•ï¼Œæ— éœ€é”</li>
<li>ç¼ºç‚¹ï¼šå•ç‚¹ï¼Œè´Ÿè½½é›†ä¸­</li>
</ul>
<p>JobFlow é€‰æ‹©äº†æ–¹æ¡ˆBï¼Œå› ä¸ºï¼š</p>
<pre><code class="hljs language-diff" lang="diff">å·¡æ£€è´Ÿè½½å¾ˆå°ï¼š
<span class="hljs-deletion">- 3åˆ†é’Ÿä¸€æ¬¡ï¼Œ10åˆ†é’Ÿä¸€æ¬¡</span>
<span class="hljs-deletion">- æ¯æ¬¡æ‰«æå‡ ç™¾ä¸ªä»»åŠ¡</span>
<span class="hljs-deletion">- å•å®ä¾‹å®Œå…¨æ‰›å¾—ä½</span>

ç®€å•ä¼˜å…ˆï¼š
<span class="hljs-deletion">- ä¸éœ€è¦åˆ†å¸ƒå¼é”</span>
<span class="hljs-deletion">- ä¸éœ€è¦å¤æ‚çš„åè°ƒ</span>
<span class="hljs-deletion">- æœ€å°èŠ‚ç‚¹æŒ‚äº†ï¼Œè‡ªåŠ¨åˆ‡æ¢</span>
</code></pre>
<h2 data-id="heading-38">åã€æ€»ç»“</h2>
<p>JobFlow å¤„ç†è¶…æ—¶ã€è¡¥å¿ã€æ¼è°ƒçš„æ ¸å¿ƒæ€è·¯ï¼š</p>
<p><strong>æ­£å¸¸è·¯å¾„ä¼˜å…ˆ</strong>ï¼š</p>
<ul>
<li>99% çš„ä»»åŠ¡èµ°æ­£å¸¸è·¯å¾„</li>
<li>æ— é”è°ƒåº¦ï¼Œæ€§èƒ½å¥½</li>
<li>å›è°ƒé©±åŠ¨ï¼Œå“åº”å¿«</li>
</ul>
<p><strong>å¼‚å¸¸è·¯å¾„å…œåº•</strong>ï¼š</p>
<ul>
<li>è¶…æ—¶å·¡æ£€ï¼šè¯¢é—®æ‰§è¡Œå™¨ç¡®è®¤çœŸå®çŠ¶æ€</li>
<li>åˆ†ç‰‡è¡¥å¿ï¼šCAS ä¿æŠ¤ï¼Œé™æ¬¡é‡è¯•</li>
<li>æ¼è°ƒæ£€æµ‹ï¼šæ—¶é—´çª—å£ï¼Œä¸»åŠ¨è¡¥å¿</li>
</ul>
<p><strong>è®¾è®¡åŸåˆ™</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> ç®€å•ä¼˜äºå¤æ‚
<span class="hljs-bullet">   -</span> æœ€å°èŠ‚ç‚¹é€‰ä¸»ï¼Œè€Œä¸æ˜¯ Raft é€‰ä¸¾
<span class="hljs-bullet">   -</span> CAS ä¿æŠ¤ï¼Œè€Œä¸æ˜¯åˆ†å¸ƒå¼é”

<span class="hljs-bullet">2.</span> åˆ†å±‚ä¼˜äºå…¨é‡
<span class="hljs-bullet">   -</span> åªæ£€æµ‹ä½é¢‘ä»»åŠ¡æ¼è°ƒ
<span class="hljs-bullet">   -</span> è¶…æ—¶åˆ¤å®šåˆ†ä¸¤å±‚

<span class="hljs-bullet">3.</span> è¯¢é—®ä¼˜äºçŒœæµ‹
<span class="hljs-bullet">   -</span> å…ˆé—®æ‰§è¡Œå™¨ï¼Œå†åˆ¤è¶…æ—¶
<span class="hljs-bullet">   -</span> å‡†ç¡®æ€§ä¼˜äºæ€§èƒ½

<span class="hljs-bullet">4.</span> å…œåº•ä¼˜äºå®Œç¾
<span class="hljs-bullet">   -</span> æ¥å—1%çš„æ¼è°ƒï¼Œç”¨å·¡æ£€å…œåº•
<span class="hljs-bullet">   -</span> æ¥å—çŸ­æš‚çš„çŠ¶æ€ä¸ä¸€è‡´
</code></pre>
<p><strong>æ ¸å¿ƒä»·å€¼</strong>ï¼š</p>
<p>JobFlow æ²¡æœ‰è¿½æ±‚å®Œç¾çš„ä¸€è‡´æ€§ï¼Œè€Œæ˜¯ç”¨å¼‚æ­¥è¡¥å¿æ¢å–äº†ï¼š</p>
<ul>
<li>æ›´å¥½çš„æ€§èƒ½ï¼ˆæ— é”è°ƒåº¦ï¼‰</li>
<li>æ›´ä½çš„å¤æ‚åº¦ï¼ˆæ— éœ€åˆ†å¸ƒå¼é”ï¼‰</li>
<li>æ›´å¥½çš„å¯ç»´æŠ¤æ€§ï¼ˆé€»è¾‘æ¸…æ™°ï¼‰</li>
</ul>
<p>è¿™å°±æ˜¯ JobFlow åœ¨åˆ†å¸ƒå¼è°ƒåº¦è¿™ä¸ªé¢†åŸŸçš„æ ¸å¿ƒç«äº‰åŠ›ï¼š<strong>åœ¨æ€§èƒ½å’Œå¯é æ€§ä¹‹é—´æ‰¾åˆ°æœ€ä¼˜å¹³è¡¡ç‚¹ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¢è¯•å®˜: â€œ è¯·ä½ è¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯ ajax ? â€]]></title>    <link>https://juejin.cn/post/7588004376867340323</link>    <guid>https://juejin.cn/post/7588004376867340323</guid>    <pubDate>2025-12-27T05:33:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588004376867340323" data-draft-id="7588034035286884367" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¢è¯•å®˜:  â€œ è¯·ä½ è¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯ ajax ? â€"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-27T05:33:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒå¯»girling"/> <meta itemprop="url" content="https://juejin.cn/user/2276467567770442"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¢è¯•å®˜:  â€œ è¯·ä½ è¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯ ajax ? â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2276467567770442/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒå¯»girling
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T05:33:37.000Z" title="Sat Dec 27 2025 05:33:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä¸€ã€AJAX æ ¸å¿ƒå®šä¹‰</h3>
<p>AJAX æ˜¯Â <strong>Asynchronous JavaScript and XML</strong>Â çš„ç¼©å†™ï¼Œç¿»è¯‘ä¸º â€œå¼‚æ­¥çš„ JavaScript å’Œ XMLâ€ã€‚</p>
<ul>
<li>æœ¬è´¨ï¼šå®ƒä¸æ˜¯ä¸€ç§æ–°çš„ç¼–ç¨‹è¯­è¨€ï¼Œè€Œæ˜¯ä¸€å¥—<strong>ä½¿ç”¨ç°æœ‰æŠ€æœ¯ç»„åˆå®ç°çš„ç¼–ç¨‹æ–¹æ¡ˆ</strong>ã€‚</li>
<li>æ ¸å¿ƒä½œç”¨ï¼šè®© JavaScript åœ¨<strong>ä¸åˆ·æ–°æ•´ä¸ªç½‘é¡µ</strong>çš„æƒ…å†µä¸‹ï¼Œå¼‚æ­¥åœ°ä¸æœåŠ¡å™¨äº¤æ¢æ•°æ®ï¼Œå®ç°ç½‘é¡µå±€éƒ¨æ›´æ–°ã€‚</li>
<li>å…³é”®ç‰¹ç‚¹ï¼š<strong>å¼‚æ­¥</strong>ï¼ˆè¯·æ±‚å‘é€åï¼Œé¡µé¢ä¸ç”¨ç­‰å¾…æœåŠ¡å™¨å“åº”ï¼Œä»å¯æ­£å¸¸äº¤äº’ï¼‰ã€<strong>å±€éƒ¨æ›´æ–°</strong>ï¼ˆåªæ›´æ–°éœ€è¦å˜åŒ–çš„éƒ¨åˆ†ï¼Œæå‡ç”¨æˆ·ä½“éªŒï¼‰ã€‚</li>
</ul>
<p>è¡¥å……ï¼šè™½ç„¶åå­—é‡Œæœ‰ XMLï¼Œä½†ç°åœ¨å®é™…å¼€å‘ä¸­å‡ ä¹éƒ½ç”¨<strong>JSON</strong>ï¼ˆæ›´è½»é‡ã€æ˜“è§£æï¼‰æ¥ä¼ è¾“æ•°æ®ï¼ŒAJAX åªæ˜¯æ²¿ç”¨äº†å†å²åç§°ã€‚</p>
<h3 data-id="heading-1">äºŒã€AJAX å·¥ä½œåŸç†</h3>
<p>AJAX çš„æ ¸å¿ƒæ˜¯æµè§ˆå™¨æä¾›çš„Â <code>XMLHttpRequest</code>Â å¯¹è±¡ï¼ˆç®€ç§° XHRï¼‰ï¼Œç°ä»£æµè§ˆå™¨ä¹Ÿæä¾›äº†æ›´æ˜“ç”¨çš„Â <code>fetch</code>Â APIã€‚å…¶åŸºæœ¬å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>åˆ›å»º AJAX è¯·æ±‚å¯¹è±¡ï¼ˆXHR/fetchï¼‰ï¼›</li>
<li>é…ç½®è¯·æ±‚å‚æ•°ï¼ˆè¯·æ±‚æ–¹å¼ã€URLã€æ˜¯å¦å¼‚æ­¥ç­‰ï¼‰ï¼›</li>
<li>å‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼›</li>
<li>ç›‘å¬æœåŠ¡å™¨å“åº”çŠ¶æ€ï¼›</li>
<li>æ¥æ”¶æœåŠ¡å™¨è¿”å›çš„æ•°æ®ï¼›</li>
<li>ç”¨ JavaScript æ›´æ–°ç½‘é¡µå±€éƒ¨å†…å®¹ã€‚</li>
</ol>
<h3 data-id="heading-2">ä¸‰ã€AJAX ä»£ç ç¤ºä¾‹</h3>
<h4 data-id="heading-3">1. ä¼ ç»Ÿ XHR æ–¹å¼ï¼ˆå…¼å®¹æ‰€æœ‰æµè§ˆå™¨ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. åˆ›å»ºXHRå¯¹è±¡</span>
<span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();

<span class="hljs-comment">// 2. é…ç½®è¯·æ±‚ï¼šè¯·æ±‚æ–¹å¼(GET)ã€URLã€æ˜¯å¦å¼‚æ­¥(true)</span>
xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'https://jsonplaceholder.typicode.com/todos/1'</span>, <span class="hljs-literal">true</span>);

<span class="hljs-comment">// 3. ç›‘å¬è¯·æ±‚çŠ¶æ€å˜åŒ–ï¼ˆæ ¸å¿ƒï¼‰</span>
xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// readyState=4 è¡¨ç¤ºè¯·æ±‚å®Œæˆï¼›status=200 è¡¨ç¤ºå“åº”æˆåŠŸ</span>
    <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span> &amp;&amp; xhr.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {
        <span class="hljs-comment">// 4. è§£ææœåŠ¡å™¨è¿”å›çš„JSONæ•°æ®</span>
        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(xhr.<span class="hljs-property">responseText</span>);
        <span class="hljs-comment">// 5. å±€éƒ¨æ›´æ–°é¡µé¢ï¼ˆæ¯”å¦‚æŠŠæ•°æ®æ˜¾ç¤ºåˆ°idä¸ºresultçš„å…ƒç´ é‡Œï¼‰</span>
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'result'</span>).<span class="hljs-property">innerHTML</span> = <span class="hljs-string">`
            &lt;h3&gt;ä»»åŠ¡æ ‡é¢˜ï¼š<span class="hljs-subst">${data.title}</span>&lt;/h3&gt;
            &lt;p&gt;æ˜¯å¦å®Œæˆï¼š<span class="hljs-subst">${data.completed ? <span class="hljs-string">'æ˜¯'</span> : <span class="hljs-string">'å¦'</span>}</span>&lt;/p&gt;
        `</span>;
    }
};

<span class="hljs-comment">// å¤„ç†è¯·æ±‚å¤±è´¥çš„æƒ…å†µ</span>
xhr.<span class="hljs-property">onerror</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'result'</span>).<span class="hljs-property">innerHTML</span> = <span class="hljs-string">'è¯·æ±‚å¤±è´¥ï¼'</span>;
};

<span class="hljs-comment">// 4. å‘é€è¯·æ±‚</span>
xhr.<span class="hljs-title function_">send</span>();
</code></pre>
<h4 data-id="heading-4">2. ç°ä»£ fetch æ–¹å¼ï¼ˆES6+ï¼Œæ›´ç®€æ´ï¼‰</h4>
<p><code>fetch</code>Â æ˜¯ AJAX çš„ç°ä»£æ›¿ä»£æ–¹æ¡ˆï¼ŒåŸºäº Promiseï¼Œè¯­æ³•æ›´ä¼˜é›…ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// 1. å‘é€GETè¯·æ±‚</span>
<span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://jsonplaceholder.typicode.com/todos/1'</span>)
    <span class="hljs-comment">// 2. å¤„ç†å“åº”ï¼šå…ˆåˆ¤æ–­æ˜¯å¦æˆåŠŸï¼Œå†è§£æä¸ºJSON</span>
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
        <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç ï¼š'</span> + response.<span class="hljs-property">status</span>);
        }
        <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">json</span>();
    })
    <span class="hljs-comment">// 3. ä½¿ç”¨æ•°æ®æ›´æ–°é¡µé¢</span>
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'result'</span>).<span class="hljs-property">innerHTML</span> = <span class="hljs-string">`
            &lt;h3&gt;ä»»åŠ¡æ ‡é¢˜ï¼š<span class="hljs-subst">${data.title}</span>&lt;/h3&gt;
            &lt;p&gt;æ˜¯å¦å®Œæˆï¼š<span class="hljs-subst">${data.completed ? <span class="hljs-string">'æ˜¯'</span> : <span class="hljs-string">'å¦'</span>}</span>&lt;/p&gt;
        `</span>;
    })
    <span class="hljs-comment">// 4. æ•è·å¼‚å¸¸</span>
    .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'result'</span>).<span class="hljs-property">innerHTML</span> = error.<span class="hljs-property">message</span>;
    });
</code></pre>
<h3 data-id="heading-5">å››ã€AJAX çš„å…¸å‹åº”ç”¨åœºæ™¯</h3>
<ul>
<li>è¡¨å•æäº¤ï¼ˆæ¯”å¦‚ç™»å½•éªŒè¯ï¼Œä¸ç”¨åˆ·æ–°é¡µé¢å°±èƒ½æç¤º â€œç”¨æˆ·åå¯†ç é”™è¯¯â€ï¼‰ï¼›</li>
<li>æ•°æ®åˆ†é¡µåŠ è½½ï¼ˆæ¯”å¦‚æ»šåŠ¨åˆ°åº•éƒ¨è‡ªåŠ¨åŠ è½½ä¸‹ä¸€é¡µå†…å®¹ï¼‰ï¼›</li>
<li>æœç´¢æ¡†è”æƒ³ï¼ˆè¾“å…¥å…³é”®è¯å®æ—¶æ˜¾ç¤ºåŒ¹é…ç»“æœï¼‰ï¼›</li>
<li>å±€éƒ¨æ•°æ®åˆ·æ–°ï¼ˆæ¯”å¦‚ç½‘é¡µçš„ç‚¹èµã€è¯„è®ºåŠŸèƒ½ï¼Œç‚¹å‡»åç›´æ¥æ›´æ–°æ•°å­—ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-6">äº”ã€å…³é”®æ³¨æ„ç‚¹</h3>
<ol>
<li><strong>åŒæºç­–ç•¥</strong>ï¼šæµè§ˆå™¨é»˜è®¤é™åˆ¶ AJAX è¯·æ±‚åªèƒ½è®¿é—®<strong>åŒåŸŸåã€åŒç«¯å£ã€åŒåè®®</strong>çš„æœåŠ¡å™¨ï¼ˆæ¯”å¦‚<code>http://localhost:8080</code>ä¸èƒ½è¯·æ±‚<code>http://baidu.com</code>ï¼‰ï¼Œè·¨åŸŸéœ€è¦æœåŠ¡å™¨é…ç½® CORS æˆ–ä½¿ç”¨ä»£ç†ã€‚</li>
<li><strong>å¼‚æ­¥ç‰¹æ€§</strong>ï¼šAJAX è¯·æ±‚æ˜¯å¼‚æ­¥çš„ï¼Œä¸èƒ½åœ¨è¯·æ±‚å‘é€åç«‹å³è·å–ç»“æœï¼Œå¿…é¡»åœ¨å›è°ƒå‡½æ•°ï¼ˆ<code>onreadystatechange</code>ï¼‰æˆ– Promise çš„<code>then</code>é‡Œå¤„ç†è¿”å›æ•°æ®ã€‚</li>
</ol>
<h3 data-id="heading-7">æ€»ç»“</h3>
<ol>
<li>AJAX æ˜¯ä¸€å¥—å®ç° â€œç½‘é¡µå¼‚æ­¥è¯·æ±‚æ•°æ®ã€å±€éƒ¨æ›´æ–°â€ çš„æŠ€æœ¯æ–¹æ¡ˆï¼Œæ ¸å¿ƒæ˜¯<code>XMLHttpRequest</code>å¯¹è±¡ï¼ˆæˆ–ç°ä»£çš„<code>fetch</code>ï¼‰ã€‚</li>
<li>æ ¸å¿ƒä¼˜åŠ¿ï¼šæ— éœ€åˆ·æ–°æ•´ä¸ªé¡µé¢ï¼Œæå‡ç”¨æˆ·ä½“éªŒï¼Œå®ç°ç½‘é¡µä¸æœåŠ¡å™¨çš„å¼‚æ­¥æ•°æ®äº¤äº’ã€‚</li>
<li>ç°ä»£å¼€å‘ä¸­ï¼Œ<code>fetch</code>ï¼ˆç»“åˆ Promise/async-awaitï¼‰å·²é€æ­¥æ›¿ä»£ä¼ ç»Ÿ XHRï¼Œæ˜¯ AJAX çš„ä¸»æµå®ç°æ–¹å¼ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue.js æºç æ­ç§˜ï¼ˆä¸€ï¼‰ï¼šVue3 æ¶æ„æ€»è§ˆ]]></title>    <link>https://juejin.cn/post/7588064253636018230</link>    <guid>https://juejin.cn/post/7588064253636018230</guid>    <pubDate>2025-12-27T05:51:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588064253636018230" data-draft-id="7588149079401250859" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue.js æºç æ­ç§˜ï¼ˆä¸€ï¼‰ï¼šVue3 æ¶æ„æ€»è§ˆ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-27T05:51:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å€Ÿä¸ªç«er"/> <meta itemprop="url" content="https://juejin.cn/user/2225067265915783"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue.js æºç æ­ç§˜ï¼ˆä¸€ï¼‰ï¼šVue3 æ¶æ„æ€»è§ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2225067265915783/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å€Ÿä¸ªç«er
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T05:51:56.000Z" title="Sat Dec 27 2025 05:51:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Vue.js æºç æ­ç§˜ï¼ˆä¸€ï¼‰ï¼šVue3 æ¶æ„æ€»è§ˆ</h2>
<blockquote>
<p>æœ¬æ–‡ä»å…¨å±€è§†è§’è§£æ Vue3 çš„æ ¸å¿ƒæ¶æ„ï¼Œå»ºç«‹æºç é˜…è¯»çš„æ•´ä½“è®¤çŸ¥ã€‚</p>
</blockquote>
<h3 data-id="heading-1">ä¸€ã€æ•´ä½“æ¶æ„</h3>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Vue Application                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Compiler (ç¼–è¯‘æ—¶)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   Parse     â”‚â”€â–ºâ”‚  <span class="hljs-attribute">Transform</span>  â”‚â”€â–ºâ”‚   Codegen   â”‚         â”‚
â”‚  â”‚  (è§£æ)     â”‚  â”‚   (è½¬æ¢)    â”‚  â”‚  (ä»£ç ç”Ÿæˆ)  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼ render function
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Runtime (è¿è¡Œæ—¶)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ Reactivity  â”‚  â”‚   Renderer  â”‚  â”‚  Scheduler  â”‚         â”‚
â”‚  â”‚  (å“åº”å¼)   â”‚  â”‚   (æ¸²æŸ“å™¨)   â”‚  â”‚   (è°ƒåº¦å™¨)   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DOM / Platform                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-2">äºŒã€ç¼–è¯‘æ—¶ vs è¿è¡Œæ—¶</h3>
<h4 data-id="heading-3">2.1 ç¼–è¯‘æ—¶ï¼ˆCompile Timeï¼‰</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ¨¡æ¿</span>
&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{{ msg }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="hljs-comment">// ç¼–è¯‘åçš„ render å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params">_ctx</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">_createElementVNode</span>(<span class="hljs-string">"div"</span>, <span class="hljs-literal">null</span>, <span class="hljs-title function_">_toDisplayString</span>(_ctx.<span class="hljs-property">msg</span>))
}
</code></pre>
<h4 data-id="heading-4">2.2 è¿è¡Œæ—¶ï¼ˆRuntimeï¼‰</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// è¿è¡Œæ—¶æ‰§è¡Œ render å‡½æ•°</span>
<span class="hljs-keyword">const</span> vnode = <span class="hljs-title function_">render</span>(ctx)

<span class="hljs-comment">// patch åˆ° DOM</span>
<span class="hljs-title function_">patch</span>(<span class="hljs-literal">null</span>, vnode, container)
</code></pre>
<h3 data-id="heading-5">ä¸‰ã€å“åº”å¼ç³»ç»Ÿ</h3>
<h4 data-id="heading-6">3.1 æ ¸å¿ƒ API</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// reactive - å¯¹è±¡å“åº”å¼</span>
<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({ <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> })

<span class="hljs-comment">// ref - åŸºæœ¬ç±»å‹å“åº”å¼</span>
<span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)

<span class="hljs-comment">// computed - è®¡ç®—å±æ€§</span>
<span class="hljs-keyword">const</span> double = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> count.<span class="hljs-property">value</span> * <span class="hljs-number">2</span>)

<span class="hljs-comment">// effect - å‰¯ä½œç”¨</span>
<span class="hljs-title function_">effect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count.<span class="hljs-property">value</span>)
})
</code></pre>
<h4 data-id="heading-7">3.2 ä¾èµ–æ”¶é›†ä¸è§¦å‘</h4>
<pre><code class="hljs language-sql" lang="sql">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å“åº”å¼æµç¨‹                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    <span class="hljs-keyword">get</span>     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚   â”‚  Proxy  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  track  â”‚ â”€â”€â–º æ”¶é›†å½“å‰ effect    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚        â”‚                                                    â”‚
â”‚        â”‚ <span class="hljs-keyword">set</span>                                                â”‚
â”‚        â–¼                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚   â”‚ <span class="hljs-keyword">trigger</span> â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ effects â”‚ â”€â”€â–º æ‰§è¡Œæ‰€æœ‰ effect    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-8">3.3 Dep ä¸ Effect</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// Dep - ä¾èµ–å®¹å™¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dep</span> {
  <span class="hljs-attr">subs</span>: <span class="hljs-title class_">Set</span>&lt;<span class="hljs-title class_">Subscriber</span>&gt;  <span class="hljs-comment">// è®¢é˜…è€…é›†åˆ</span>
  
  <span class="hljs-title function_">track</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (activeSub) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">add</span>(activeSub)
    }
  }
  
  <span class="hljs-title function_">trigger</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">sub</span> =&gt;</span> sub.<span class="hljs-title function_">notify</span>())
  }
}

<span class="hljs-comment">// ReactiveEffect - å‰¯ä½œç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ReactiveEffect</span> {
  <span class="hljs-attr">deps</span>: <span class="hljs-title class_">Link</span>[]  <span class="hljs-comment">// ä¾èµ–é“¾è¡¨</span>
  
  <span class="hljs-title function_">run</span>(<span class="hljs-params"/>) {
    activeSub = <span class="hljs-variable language_">this</span>
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">fn</span>()
  }
  
  <span class="hljs-title function_">notify</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">scheduler</span> ? <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scheduler</span>() : <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">run</span>()
  }
}
</code></pre>
<h3 data-id="heading-9">å››ã€è™šæ‹Ÿ DOM</h3>
<h4 data-id="heading-10">4.1 VNode ç»“æ„</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">VNode</span> {
  <span class="hljs-attr">type</span>: <span class="hljs-built_in">string</span> | <span class="hljs-title class_">Component</span>    <span class="hljs-comment">// èŠ‚ç‚¹ç±»å‹</span>
  <span class="hljs-attr">props</span>: <span class="hljs-built_in">object</span> | <span class="hljs-literal">null</span>        <span class="hljs-comment">// å±æ€§</span>
  <span class="hljs-attr">children</span>: <span class="hljs-title class_">VNode</span>[] | <span class="hljs-built_in">string</span>  <span class="hljs-comment">// å­èŠ‚ç‚¹</span>
  <span class="hljs-attr">el</span>: <span class="hljs-title class_">Element</span> | <span class="hljs-literal">null</span>          <span class="hljs-comment">// çœŸå® DOM</span>
  <span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span>        <span class="hljs-comment">// diff key</span>
  <span class="hljs-attr">shapeFlag</span>: <span class="hljs-built_in">number</span>           <span class="hljs-comment">// èŠ‚ç‚¹ç±»å‹æ ‡è®°</span>
  <span class="hljs-attr">patchFlag</span>: <span class="hljs-built_in">number</span>           <span class="hljs-comment">// ä¼˜åŒ–æ ‡è®°</span>
}
</code></pre>
<h4 data-id="heading-11">4.2 ShapeFlags</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">ShapeFlags</span> {
  <span class="hljs-variable constant_">ELEMENT</span> = <span class="hljs-number">1</span>,                    <span class="hljs-comment">// æ™®é€šå…ƒç´ </span>
  <span class="hljs-variable constant_">FUNCTIONAL_COMPONENT</span> = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">1</span>,  <span class="hljs-comment">// å‡½æ•°ç»„ä»¶</span>
  <span class="hljs-variable constant_">STATEFUL_COMPONENT</span> = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">2</span>,    <span class="hljs-comment">// æœ‰çŠ¶æ€ç»„ä»¶</span>
  <span class="hljs-variable constant_">TEXT_CHILDREN</span> = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">3</span>,         <span class="hljs-comment">// æ–‡æœ¬å­èŠ‚ç‚¹</span>
  <span class="hljs-variable constant_">ARRAY_CHILDREN</span> = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">4</span>,        <span class="hljs-comment">// æ•°ç»„å­èŠ‚ç‚¹</span>
  <span class="hljs-variable constant_">SLOTS_CHILDREN</span> = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">5</span>,        <span class="hljs-comment">// æ’æ§½å­èŠ‚ç‚¹</span>
  <span class="hljs-variable constant_">TELEPORT</span> = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">6</span>,              <span class="hljs-comment">// Teleport</span>
  <span class="hljs-variable constant_">SUSPENSE</span> = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">7</span>,              <span class="hljs-comment">// Suspense</span>
  <span class="hljs-variable constant_">COMPONENT</span> = <span class="hljs-variable constant_">STATEFUL_COMPONENT</span> | <span class="hljs-variable constant_">FUNCTIONAL_COMPONENT</span>
}
</code></pre>
<h3 data-id="heading-12">äº”ã€æ¸²æŸ“å™¨</h3>
<h4 data-id="heading-13">5.1 patch å‡½æ•°</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">patch</span> = (<span class="hljs-params">n1, n2, container</span>) =&gt; {
  <span class="hljs-keyword">if</span> (n1 === n2) <span class="hljs-keyword">return</span>
  
  <span class="hljs-comment">// ç±»å‹ä¸åŒï¼Œå¸è½½æ—§èŠ‚ç‚¹</span>
  <span class="hljs-keyword">if</span> (n1 &amp;&amp; !<span class="hljs-title function_">isSameVNodeType</span>(n1, n2)) {
    <span class="hljs-title function_">unmount</span>(n1)
    n1 = <span class="hljs-literal">null</span>
  }
  
  <span class="hljs-keyword">const</span> { <span class="hljs-keyword">type</span>, shapeFlag } = n2
  
  <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">type</span>) {
    <span class="hljs-keyword">case</span> <span class="hljs-title class_">Text</span>:
      <span class="hljs-title function_">processText</span>(n1, n2, container)
      <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">case</span> <span class="hljs-title class_">Fragment</span>:
      <span class="hljs-title function_">processFragment</span>(n1, n2, container)
      <span class="hljs-keyword">break</span>
    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">if</span> (shapeFlag &amp; <span class="hljs-title class_">ShapeFlags</span>.<span class="hljs-property">ELEMENT</span>) {
        <span class="hljs-title function_">processElement</span>(n1, n2, container)
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (shapeFlag &amp; <span class="hljs-title class_">ShapeFlags</span>.<span class="hljs-property">COMPONENT</span>) {
        <span class="hljs-title function_">processComponent</span>(n1, n2, container)
      }
  }
}
</code></pre>
<h4 data-id="heading-14">5.2 ç»„ä»¶æŒ‚è½½</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">mountComponent</span> = (<span class="hljs-params">vnode, container</span>) =&gt; {
  <span class="hljs-comment">// 1. åˆ›å»ºç»„ä»¶å®ä¾‹</span>
  <span class="hljs-keyword">const</span> instance = <span class="hljs-title function_">createComponentInstance</span>(vnode)
  
  <span class="hljs-comment">// 2. è®¾ç½®ç»„ä»¶ï¼ˆæ‰§è¡Œ setupï¼‰</span>
  <span class="hljs-title function_">setupComponent</span>(instance)
  
  <span class="hljs-comment">// 3. è®¾ç½®æ¸²æŸ“å‰¯ä½œç”¨</span>
  <span class="hljs-title function_">setupRenderEffect</span>(instance, vnode, container)
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">setupRenderEffect</span> = (<span class="hljs-params">instance, vnode, container</span>) =&gt; {
  <span class="hljs-keyword">const</span> effect = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReactiveEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (!instance.<span class="hljs-property">isMounted</span>) {
      <span class="hljs-comment">// é¦–æ¬¡æŒ‚è½½</span>
      <span class="hljs-keyword">const</span> subTree = instance.<span class="hljs-title function_">render</span>()
      <span class="hljs-title function_">patch</span>(<span class="hljs-literal">null</span>, subTree, container)
      instance.<span class="hljs-property">subTree</span> = subTree
      instance.<span class="hljs-property">isMounted</span> = <span class="hljs-literal">true</span>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// æ›´æ–°</span>
      <span class="hljs-keyword">const</span> nextTree = instance.<span class="hljs-title function_">render</span>()
      <span class="hljs-title function_">patch</span>(instance.<span class="hljs-property">subTree</span>, nextTree, container)
      instance.<span class="hljs-property">subTree</span> = nextTree
    }
  })
  
  effect.<span class="hljs-title function_">run</span>()
}
</code></pre>
<h3 data-id="heading-15">å…­ã€è°ƒåº¦å™¨</h3>
<h4 data-id="heading-16">6.1 ä»»åŠ¡é˜Ÿåˆ—</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-attr">queue</span>: <span class="hljs-title class_">SchedulerJob</span>[] = []
<span class="hljs-keyword">let</span> isFlushing = <span class="hljs-literal">false</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">queueJob</span>(<span class="hljs-params">job</span>) {
  <span class="hljs-keyword">if</span> (!queue.<span class="hljs-title function_">includes</span>(job)) {
    queue.<span class="hljs-title function_">push</span>(job)
    <span class="hljs-title function_">queueFlush</span>()
  }
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">queueFlush</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (!isFlushing) {
    isFlushing = <span class="hljs-literal">true</span>
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(flushJobs)
  }
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">flushJobs</span>(<span class="hljs-params"/>) {
  queue.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> <span class="hljs-title function_">getId</span>(a) - <span class="hljs-title function_">getId</span>(b))
  
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> job <span class="hljs-keyword">of</span> queue) {
    <span class="hljs-title function_">job</span>()
  }
  
  queue.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>
  isFlushing = <span class="hljs-literal">false</span>
}
</code></pre>
<h4 data-id="heading-17">6.2 nextTick</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> resolvedPromise = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>()

<span class="hljs-keyword">function</span> <span class="hljs-title function_">nextTick</span>(<span class="hljs-params">fn?</span>) {
  <span class="hljs-keyword">return</span> fn 
    ? resolvedPromise.<span class="hljs-title function_">then</span>(fn) 
    : resolvedPromise
}
</code></pre>
<h3 data-id="heading-18">ä¸ƒã€ç»„ä»¶ç³»ç»Ÿ</h3>
<h4 data-id="heading-19">7.1 ç»„ä»¶å®ä¾‹</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ComponentInternalInstance</span> {
  <span class="hljs-attr">uid</span>: <span class="hljs-built_in">number</span>                    <span class="hljs-comment">// å”¯ä¸€ ID</span>
  <span class="hljs-attr">type</span>: <span class="hljs-title class_">Component</span>                <span class="hljs-comment">// ç»„ä»¶å®šä¹‰</span>
  <span class="hljs-attr">parent</span>: <span class="hljs-title class_">ComponentInternalInstance</span> | <span class="hljs-literal">null</span>
  
  <span class="hljs-comment">// çŠ¶æ€</span>
  <span class="hljs-attr">data</span>: <span class="hljs-built_in">object</span>                   <span class="hljs-comment">// data()</span>
  <span class="hljs-attr">props</span>: <span class="hljs-built_in">object</span>                  <span class="hljs-comment">// props</span>
  <span class="hljs-attr">setupState</span>: <span class="hljs-built_in">object</span>             <span class="hljs-comment">// setup() è¿”å›å€¼</span>
  <span class="hljs-attr">ctx</span>: <span class="hljs-built_in">object</span>                    <span class="hljs-comment">// æ¸²æŸ“ä¸Šä¸‹æ–‡</span>
  
  <span class="hljs-comment">// æ¸²æŸ“</span>
  <span class="hljs-attr">render</span>: <span class="hljs-title class_">Function</span>               <span class="hljs-comment">// render å‡½æ•°</span>
  <span class="hljs-attr">subTree</span>: <span class="hljs-title class_">VNode</span>                 <span class="hljs-comment">// æ¸²æŸ“çš„ VNode æ ‘</span>
  <span class="hljs-attr">effect</span>: <span class="hljs-title class_">ReactiveEffect</span>         <span class="hljs-comment">// æ¸²æŸ“å‰¯ä½œç”¨</span>
  
  <span class="hljs-comment">// ç”Ÿå‘½å‘¨æœŸ</span>
  <span class="hljs-attr">isMounted</span>: <span class="hljs-built_in">boolean</span>
  <span class="hljs-attr">isUnmounted</span>: <span class="hljs-built_in">boolean</span>
  
  <span class="hljs-comment">// ç”Ÿå‘½å‘¨æœŸé’©å­</span>
  <span class="hljs-attr">bc</span>: <span class="hljs-title class_">Function</span>[] | <span class="hljs-literal">null</span>          <span class="hljs-comment">// beforeCreate</span>
  <span class="hljs-attr">c</span>: <span class="hljs-title class_">Function</span>[] | <span class="hljs-literal">null</span>           <span class="hljs-comment">// created</span>
  <span class="hljs-attr">bm</span>: <span class="hljs-title class_">Function</span>[] | <span class="hljs-literal">null</span>          <span class="hljs-comment">// beforeMount</span>
  <span class="hljs-attr">m</span>: <span class="hljs-title class_">Function</span>[] | <span class="hljs-literal">null</span>           <span class="hljs-comment">// mounted</span>
  <span class="hljs-attr">bu</span>: <span class="hljs-title class_">Function</span>[] | <span class="hljs-literal">null</span>          <span class="hljs-comment">// beforeUpdate</span>
  <span class="hljs-attr">u</span>: <span class="hljs-title class_">Function</span>[] | <span class="hljs-literal">null</span>           <span class="hljs-comment">// updated</span>
  <span class="hljs-attr">bum</span>: <span class="hljs-title class_">Function</span>[] | <span class="hljs-literal">null</span>         <span class="hljs-comment">// beforeUnmount</span>
  <span class="hljs-attr">um</span>: <span class="hljs-title class_">Function</span>[] | <span class="hljs-literal">null</span>          <span class="hljs-comment">// unmounted</span>
}
</code></pre>
<h4 data-id="heading-20">7.2 setup æ‰§è¡Œ</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">setupComponent</span>(<span class="hljs-params">instance</span>) {
  <span class="hljs-keyword">const</span> { props, children } = instance.<span class="hljs-property">vnode</span>
  
  <span class="hljs-comment">// åˆå§‹åŒ– props</span>
  <span class="hljs-title function_">initProps</span>(instance, props)
  
  <span class="hljs-comment">// åˆå§‹åŒ– slots</span>
  <span class="hljs-title function_">initSlots</span>(instance, children)
  
  <span class="hljs-comment">// æ‰§è¡Œ setup</span>
  <span class="hljs-keyword">const</span> { setup } = instance.<span class="hljs-property">type</span>
  <span class="hljs-keyword">if</span> (setup) {
    <span class="hljs-keyword">const</span> setupResult = <span class="hljs-title function_">setup</span>(instance.<span class="hljs-property">props</span>, {
      <span class="hljs-attr">attrs</span>: instance.<span class="hljs-property">attrs</span>,
      <span class="hljs-attr">slots</span>: instance.<span class="hljs-property">slots</span>,
      <span class="hljs-attr">emit</span>: instance.<span class="hljs-property">emit</span>,
      <span class="hljs-attr">expose</span>: instance.<span class="hljs-property">expose</span>
    })
    
    <span class="hljs-title function_">handleSetupResult</span>(instance, setupResult)
  }
}
</code></pre>
<h3 data-id="heading-21">å…«ã€ç¼–è¯‘ä¼˜åŒ–</h3>
<h4 data-id="heading-22">8.1 PatchFlags</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">PatchFlags</span> {
  <span class="hljs-variable constant_">TEXT</span> = <span class="hljs-number">1</span>,              <span class="hljs-comment">// åŠ¨æ€æ–‡æœ¬</span>
  <span class="hljs-variable constant_">CLASS</span> = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">1</span>,        <span class="hljs-comment">// åŠ¨æ€ class</span>
  <span class="hljs-variable constant_">STYLE</span> = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">2</span>,        <span class="hljs-comment">// åŠ¨æ€ style</span>
  <span class="hljs-variable constant_">PROPS</span> = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">3</span>,        <span class="hljs-comment">// åŠ¨æ€ props</span>
  <span class="hljs-variable constant_">FULL_PROPS</span> = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">4</span>,   <span class="hljs-comment">// æœ‰åŠ¨æ€ key</span>
  <span class="hljs-variable constant_">NEED_HYDRATION</span> = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">5</span>,
  <span class="hljs-variable constant_">STABLE_FRAGMENT</span> = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">6</span>,
  <span class="hljs-variable constant_">KEYED_FRAGMENT</span> = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">7</span>,
  <span class="hljs-variable constant_">UNKEYED_FRAGMENT</span> = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">8</span>,
  <span class="hljs-variable constant_">NEED_PATCH</span> = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">9</span>,
  <span class="hljs-variable constant_">DYNAMIC_SLOTS</span> = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">10</span>,
  <span class="hljs-variable constant_">HOISTED</span> = -<span class="hljs-number">1</span>,          <span class="hljs-comment">// é™æ€æå‡</span>
  <span class="hljs-variable constant_">BAIL</span> = -<span class="hljs-number">2</span>              <span class="hljs-comment">// é€€å‡ºä¼˜åŒ–</span>
}
</code></pre>
<h4 data-id="heading-23">8.2 Block Tree</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ç¼–è¯‘ä¼˜åŒ–ï¼šåªè¿½è¸ªåŠ¨æ€èŠ‚ç‚¹</span>
<span class="hljs-keyword">const</span> _hoisted_1 = <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">"div"</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">"static"</span>)

<span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (<span class="hljs-title function_">openBlock</span>(), <span class="hljs-title function_">createBlock</span>(<span class="hljs-string">"div"</span>, <span class="hljs-literal">null</span>, [
    _hoisted_1,  <span class="hljs-comment">// é™æ€æå‡</span>
    <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">"span"</span>, <span class="hljs-literal">null</span>, ctx.<span class="hljs-property">msg</span>, <span class="hljs-title class_">PatchFlags</span>.<span class="hljs-property">TEXT</span>)  <span class="hljs-comment">// åŠ¨æ€èŠ‚ç‚¹</span>
  ]))
}
</code></pre>
<h3 data-id="heading-24">ä¹ã€å®Œæ•´æ¸²æŸ“æµç¨‹</h3>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Vue æ¸²æŸ“æµç¨‹                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  <span class="hljs-number">1</span>. <span class="hljs-built_in">createApp</span>(App)<span class="hljs-selector-class">.mount</span>('#app')                            â”‚
â”‚        â”‚                                                    â”‚
â”‚        â–¼                                                    â”‚
â”‚  <span class="hljs-number">2</span>. åˆ›å»º VNode                                              â”‚
â”‚        â”‚                                                    â”‚
â”‚        â–¼                                                    â”‚
â”‚  <span class="hljs-number">3</span>. <span class="hljs-built_in">render</span>(vnode, container)                                â”‚
â”‚        â”‚                                                    â”‚
â”‚        â–¼                                                    â”‚
â”‚  <span class="hljs-number">4</span>. <span class="hljs-built_in">patch</span>(null, vnode, container)                           â”‚
â”‚        â”‚                                                    â”‚
â”‚        â–¼                                                    â”‚
â”‚  <span class="hljs-number">5</span>. processComponent â†’ mountComponent                       â”‚
â”‚        â”‚                                                    â”‚
â”‚        â”œâ”€â”€ createComponentInstance                          â”‚
â”‚        â”œâ”€â”€ setupComponent (æ‰§è¡Œ setup)                      â”‚
â”‚        â””â”€â”€ setupRenderEffect                                â”‚
â”‚              â”‚                                              â”‚
â”‚              â–¼                                              â”‚
â”‚  <span class="hljs-number">6</span>. ReactiveEffect<span class="hljs-selector-class">.run</span>()                                    â”‚
â”‚        â”‚                                                    â”‚
â”‚        â–¼                                                    â”‚
â”‚  <span class="hljs-number">7</span>. instance<span class="hljs-selector-class">.render</span>() â†’ subTree VNode                       â”‚
â”‚        â”‚                                                    â”‚
â”‚        â–¼                                                    â”‚
â”‚  <span class="hljs-number">8</span>. <span class="hljs-built_in">patch</span>(null, subTree, container)                         â”‚
â”‚        â”‚                                                    â”‚
â”‚        â–¼                                                    â”‚
â”‚  <span class="hljs-number">9</span>. é€’å½’å¤„ç†å­èŠ‚ç‚¹ â†’ æŒ‚è½½åˆ° DOM                              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-25">åã€å°ç»“</h3>
<p>Vue3 æ¶æ„çš„æ ¸å¿ƒï¼š</p>
<ol>
<li><strong>å“åº”å¼ç³»ç»Ÿ</strong>ï¼šåŸºäº Proxyï¼Œä¾èµ–æ”¶é›† + è§¦å‘æ›´æ–°</li>
<li><strong>è™šæ‹Ÿ DOM</strong>ï¼šVNode æè¿° UIï¼Œpatch ç®—æ³•é«˜æ•ˆæ›´æ–°</li>
<li><strong>ç¼–è¯‘ä¼˜åŒ–</strong>ï¼šPatchFlagsã€Block Treeã€é™æ€æå‡</li>
<li><strong>è°ƒåº¦å™¨</strong>ï¼šæ‰¹é‡æ›´æ–°ï¼ŒnextTick å¾®ä»»åŠ¡é˜Ÿåˆ—</li>
<li><strong>ç»„ä»¶ç³»ç»Ÿ</strong>ï¼šsetup + Composition API</li>
</ol>
<hr/>
<blockquote>
<p>ğŸ“¦ æºç åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvuejs%2Fcore" target="_blank" title="https://github.com/vuejs/core" ref="nofollow noopener noreferrer">github.com/vuejs/core</a></p>
<p>ä¸‹ä¸€ç¯‡ï¼šå“åº”å¼ç³»ç»Ÿè¯¦è§£</p>
<p>å¦‚æœè§‰å¾—æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµæ”¶è— ğŸ‘</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[webpackçš„ç”Ÿå‘½å‘¨æœŸä¸Loader/Plugin]]></title>    <link>https://juejin.cn/post/7588061231590244393</link>    <guid>https://juejin.cn/post/7588061231590244393</guid>    <pubDate>2025-12-27T06:35:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588061231590244393" data-draft-id="7588010346070966282" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="webpackçš„ç”Ÿå‘½å‘¨æœŸä¸Loader/Plugin"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-27T06:35:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="MQliferecord"/> <meta itemprop="url" content="https://juejin.cn/user/1139543665814600"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            webpackçš„ç”Ÿå‘½å‘¨æœŸä¸Loader/Plugin
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1139543665814600/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    MQliferecord
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T06:35:20.000Z" title="Sat Dec 27 2025 06:35:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>æ ¸å¿ƒå¯¹è±¡ï¼š</strong></p>
<ul>
<li>compiler: ä»£è¡¨Webpackæ„å»ºçš„å…¨å±€ä¸Šä¸‹æ–‡ï¼Œé’©å­æ˜¯å…¨å±€ç”Ÿå‘½å‘¨æœŸé’©å­</li>
<li>compilation: ä»£è¡¨ä¸€æ¬¡æ„å»ºçš„ç¼–è¯‘è¿‡ç¨‹ï¼Œé’©å­æ˜¯ç¼–è¯‘é˜¶æ®µé’©å­</li>
</ul>
<p><strong>ç”Ÿå‘½å‘¨æœŸï¼š</strong></p>
<p>æ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºã€åˆå§‹åŒ–-&gt;ç¼–è¯‘-&gt;è¾“å‡º-&gt;ç»“æŸã€‘ï¼Œä¸€å…±å››ä¸ªé˜¶æ®µï¼Œä»¥ä¸‹åˆ—ä¸¾ä¸€ä¸‹å„ä¸ªé˜¶æ®µçš„æ ¸å¿ƒé’©å­ï¼š</p>
<ol>
<li>åˆå§‹åŒ–ï¼š</li>
</ol>
<ul>
<li>entryOption åŠ¨æ€æ–°å¢å…¥å£</li>
</ul>
<ol start="2">
<li>ç¼–è¯‘ï¼š</li>
</ol>
<ul>
<li>compileï¼šç­‰åŒäºviteçš„configé˜¶æ®µï¼Œèƒ½å¤Ÿè·å¾—æœ€ç»ˆç”Ÿæˆçš„configæ–‡ä»¶ï¼Œå¦‚æœéœ€è¦æ·»åŠ ä¸€äº›ç¯å¢ƒå€¼çš„å ä½ç¬¦ï¼Œå¯ä»¥åœ¨è¿™ä¸ªé˜¶æ®µä»‹å…¥</li>
</ul>
<pre><code class="hljs language-js" lang="js">compiler.<span class="hljs-property">hooks</span>.<span class="hljs-property">compiler</span>.<span class="hljs-title function_">tap</span>(<span class="hljs-string">'æ’ä»¶å'</span>,<span class="hljs-function">()=&gt;</span>{
    compiler.<span class="hljs-property">options</span>.<span class="hljs-property">plugins</span>.<span class="hljs-title function_">push</span>(
        <span class="hljs-keyword">new</span> webpack.<span class="hljs-title class_">DefinePlugin</span>({
          <span class="hljs-string">'process.env.APP_VERSION'</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-variable constant_">PLACEHOLDER</span>),
        })
    );
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'âœ… å·²æ³¨å…¥APP_VERSIONå ä½ç¬¦ï¼š'</span>, <span class="hljs-variable constant_">PLACEHOLDER</span>);
})
</code></pre>
<ul>
<li>compilation: å†…éƒ¨åŒ…å«æ•´ä¸ªæ‰“åŒ…æ„å»ºæµç¨‹ï¼Œåƒæ˜¯buildModuleå’Œoptimizeç­‰ç­‰ï¼Œå®é™…æ‰“åŒ…å®ä¾‹å·²ç»åˆ›å»ºå®Œæˆï¼Œä¸€èˆ¬è¿™ä¸ªé˜¶æ®µå¯ä»¥æ‹¿åˆ°æ–‡ä»¶æœ€ç»ˆçš„contenthashå€¼</li>
</ul>
<pre><code class="hljs language-js" lang="js">compiler.<span class="hljs-property">hooks</span>.<span class="hljs-property">compilation</span>.<span class="hljs-title function_">tap</span>(<span class="hljs-string">'ContentHashReplacePlugin'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentHash</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateContentHash</span>();
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'âœ… ç”ŸæˆçœŸå®contentHashï¼š'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentHash</span>);
});
</code></pre>
<ol start="3">
<li>è¾“å‡ºï¼š</li>
</ol>
<ul>
<li>emitï¼š å¼‚æ­¥é’©å­ï¼å¿…é¡»å’Œcallbackå’ŒtapAsyncç»“åˆä½¿ç”¨ï¼å‡†å¤‡å°†æ•°æ®å†™å…¥ç£ç›˜ï¼Œè¿™ä¸ªé˜¶æ®µå¯ä»¥æŠŠç¯å¢ƒå€¼çš„å ä½ç¬¦æ›¿æ¢æˆçœŸæ­£çš„æ•°æ®</li>
</ul>
<pre><code class="hljs language-js" lang="js">compiler.<span class="hljs-property">hooks</span>.<span class="hljs-property">emit</span>.<span class="hljs-title function_">tapAsync</span>(<span class="hljs-string">'MyPlugin'</span>, <span class="hljs-function">(<span class="hljs-params">compilation, callback</span>) =&gt;</span> {
  <span class="hljs-comment">// éå†æ‰€æœ‰è¾“å‡ºçš„èµ„æº</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [filename, source] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(compilation.<span class="hljs-property">assets</span>)) {
    <span class="hljs-keyword">if</span> (filename.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">'.js'</span>)) {
      <span class="hljs-comment">// è¯»å–åŸå†…å®¹ï¼Œæ·»åŠ ç‰ˆæƒæ³¨é‡Š</span>
      <span class="hljs-keyword">const</span> content = source.<span class="hljs-title function_">source</span>();
      <span class="hljs-keyword">const</span> newContent = <span class="hljs-string">`/* ç‰ˆæƒæ‰€æœ‰ Â© 2025 MyProject */\n<span class="hljs-subst">${content}</span>`</span>;
      <span class="hljs-comment">// æ›¿æ¢èµ„æºå†…å®¹</span>
      compilation.<span class="hljs-property">assets</span>[filename] = {
        <span class="hljs-attr">source</span>: <span class="hljs-function">() =&gt;</span> newContent,
        <span class="hljs-attr">size</span>: <span class="hljs-function">() =&gt;</span> newContent.<span class="hljs-property">length</span>
      };
    }
  }
  <span class="hljs-title function_">callback</span>(); <span class="hljs-comment">// å¼‚æ­¥é’©å­å¿…é¡»è°ƒç”¨ callback ç»“æŸ</span>
});
</code></pre>
<ol start="4">
<li>ç»“æŸï¼š</li>
</ol>
<ul>
<li>done: æ„å»ºå®Œæˆä¹‹åè¾“å‡ºä¸€äº›æ—¥å¿—ä¿¡æ¯ï¼Œç”ŸæˆæŠ¥å‘Š</li>
</ul>
<p><strong>tapå’ŒtapAsyncçš„åŒºåˆ«:</strong></p>
<p>åŒæ­¥é’©å­å’Œå¼‚æ­¥é’©å­è°ƒç”¨æ—¶å€™çš„å‡½æ•°ã€‚</p>
<p>tapAsyncå¿…é¡»å’Œcallbackç»“åˆä½¿ç”¨ï¼Œç”¨äºé€šçŸ¥webpackå¼‚æ­¥æµç¨‹å·²ç»ç»“æŸï¼Œå¯ä»¥ç»§ç»­æ¥ä¸‹æ¥çš„æµç¨‹ï¼Œä¸ç„¶ä¼šå¡ä½ã€‚</p>
<p><strong>Plugin:</strong> ç”¨äºwebpackæ‰“åŒ…ç”Ÿå‘½å‘¨æœŸä¸­æ‰§è¡Œçš„ä¸€äº›å‡½æ•°ï¼Œæ¯”å¦‚csså’Œå›¾ç‰‡å‹ç¼©çš„pluginï¼Œæ— è§†æ‰“åŒ…æ¨¡å—çš„IgnorePlugin</p>
<p><strong>Loader:</strong> ç”¨äºä»£ç è½¬æ¢ï¼Œå› ä¸ºæµè§ˆå™¨åªèƒ½è§£æhtmlï¼Œcsså’Œjsï¼Œæ‰€ä»¥ä¼šæœ‰å„ç§loaderå°†æµè§ˆå™¨æ²¡æ³•è§£æçš„ä¸œè¥¿è½¬æ¢æˆèƒ½è§£æçš„è¯­è¨€ï¼ŒåŒæ—¶webpackæœ¬èº«æ— æ³•è¯†åˆ«ä¸€äº›æ–‡ä»¶ï¼Œä¹Ÿéœ€è¦Loaderåšè½¬æ¢ï¼Œæ¯”å¦‚css-loaderï¼Œsass-loaderï¼Œts-loaderï¼Œstyle-loaderï¼Œpostcss-loader</p>
<p>(1.1) css-loaderï¼šå› ä¸ºwebpackæ²¡åŠæ³•è¯†åˆ«cssæ–‡ä»¶ï¼Œwebpackå…¶å®åªèƒ½ç†è§£jså’Œjsonï¼Œæ‰€ä»¥æ‰ä¼šä½¿ç”¨éœ€è¦css-loaderå»å¤„ç†cssæ–‡ä»¶å¼•ç”¨ï¼Œå°†å…¶è½¬ä¸ºæ¨¡æ¿å­—ç¬¦ä¸²</p>
<p>(1.2) style-loader: å°†css-loaderç”Ÿæˆçš„æ ·å¼å­—ç¬¦ä¸²æ³¨å…¥åˆ°styleæ ‡ç­¾ä¸­</p>
<p>(1.3) postcss-loader: å¯¹cssåšå…¼å®¹å¤„ç†ï¼Œè‡ªåŠ¨å¢åŠ å‰ç¼€</p>
<p>æ‰§è¡Œé¡ºåºæ˜¯postcss-loader-&gt;css-loader-&gt;style-loaderï¼Œè€Œé…ç½®çš„æ—¶å€™éœ€è¦ä»å³å‘å·¦é…ç½®ï¼Œé¡ºåºé”™è¯¯ï¼Œä¼šå¯¼è‡´æŠ¥é”™</p>
<p>Loaderæ•´ä½“æ‰§è¡Œé˜¶æ®µç±»ä¼¼äºæ´‹è‘±æ¨¡å‹ï¼Œä»å·¦åˆ°å³ä¾æ¬¡éå†å¯¹åº”çš„loaderï¼Œå†ä»å³åˆ°å·¦æ‰§è¡Œå¯¹åº”çš„loader</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">module</span>: {
    <span class="hljs-attr">rules</span>: [
      {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.css$/</span>,
        <span class="hljs-attr">use</span>: [<span class="hljs-string">'style-loader'</span>, <span class="hljs-string">'css-loader'</span>,  <span class="hljs-string">'postcss-loader'</span>]
      }
    ]
  }
};
</code></pre>
<p><strong>viteè‡ªèº«æ²¡æœ‰loader</strong>ï¼Œå¯ä»¥é€šè¿‡è£…æ’ä»¶æ¥é…ç½®loaderï¼Œä½†æ˜¯æ²¡æœ‰åŸç”Ÿå¥½ç”¨ï¼Œè€Œä¸”viteå¾ˆå¤šloaderåŠŸèƒ½éƒ½åŸç”Ÿå†…åµŒäº†ï¼Œè€Œä¸”å› ä¸ºå·¥å…·ç‰¹æ€§ï¼Œviteä¾èµ–esæ¨¡å—ï¼Œè€Œæµè§ˆå™¨æ˜¯å®Œå…¨æ”¯æŒesæ¨¡å—çš„ï¼Œæ— éœ€loaderåšæ¨¡å—è½¬æ¢ï¼Œæ•´ä½“ä¸Šéƒ½æ˜¯ä¾é pluginè¿›è¡Œå¤„ç†</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hugging Face 200é¡µçš„å¤§æ¨¡å‹è®­ç»ƒå®å½•]]></title>    <link>https://juejin.cn/post/7588028859541061658</link>    <guid>https://juejin.cn/post/7588028859541061658</guid>    <pubDate>2025-12-27T04:28:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588028859541061658" data-draft-id="7588031908171644937" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hugging Face 200é¡µçš„å¤§æ¨¡å‹è®­ç»ƒå®å½•"/> <meta itemprop="keywords" content="ç®—æ³•,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-27T04:28:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="coting"/> <meta itemprop="url" content="https://juejin.cn/user/933911964427818"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hugging Face 200é¡µçš„å¤§æ¨¡å‹è®­ç»ƒå®å½•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/933911964427818/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    coting
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T04:28:25.000Z" title="Sat Dec 27 2025 04:28:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘ï¼ŒHugging Face å‘å¸ƒäº†ä¸€ç¯‡ç½•è§çš„è¶…é•¿æŠ€æœ¯åšå®¢â€”â€”<strong>è¶…è¿‡ 200 é¡µçš„ã€ŠSmol  è®­ç»ƒæ‰‹å†Œã€‹</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/87dec66f76d14da5b75aa04343cc364c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767414505&amp;x-signature=lWHwrjHNULEn2jVGDA9Ai2ug6ug%3D" alt="" loading="lazy"/><br/>
è¿™ç¯‡åšå®¢å¹¶ä¸æ˜¯è®ºæ–‡ã€ä¹Ÿä¸æ˜¯äº§å“æŠ¥å‘Šï¼Œè€Œæ›´åƒæ˜¯ä¸€ä»½å®éªŒæ—¥è®°ã€‚<br/>
å®ƒè¯¦ç»†è®°å½•äº†å›¢é˜Ÿåœ¨ä½¿ç”¨ <strong>384 å— H100 GPU</strong> è®­ç»ƒä¸€æ¬¾ <strong>30 äº¿å‚æ•°æ¨¡å‹ SmolLM3</strong> çš„ä»ç«‹é¡¹æ€è€ƒåˆ°åŸºç¡€è®¾æ–½ç®¡ç†å…¨è¿‡ç¨‹ã€‚</p>
<p>åœ¨å¦‚ä»Šå¤§æ¨¡å‹å‡ ä¹æˆäº§ä¸šæ ‡é…çš„èƒŒæ™¯ä¸‹ï¼Œè¿™ç¯‡æ–‡æ¡£æ˜¾å¾—æœ‰äº›åæ½®æµï¼Œå®ƒæ²¡æœ‰ç‚«è€€æˆæœï¼Œè€Œæ˜¯åœ¨å±•ç¤º<strong>è¿‡ç¨‹çš„æ··ä¹±ä¸å¦¥å</strong>ã€‚<br/>
ä½œè€…ä¼¼ä¹æƒ³å‘Šè¯‰åŒè¡Œï¼Œè®­ç»ƒä¸€ä¸ªå¯ç”¨çš„ LLMï¼Œä¸åªæ˜¯ç®—æ³•ç«èµ›ï¼Œæ›´æ˜¯ä¸€åœº<strong>æ¼«é•¿çš„å·¥ç¨‹ç£¨åˆ</strong>ã€‚</p>
<p>æ‰€æœ‰ç›¸å…³æºç ç¤ºä¾‹ã€æµç¨‹å›¾ã€é¢è¯•å…«è‚¡ã€æ¨¡å‹é…ç½®ä¸çŸ¥è¯†åº“æ„å»ºæŠ€å·§ï¼Œæˆ‘ä¹Ÿå°†æŒç»­æ›´æ–°åœ¨Githubï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Faicoting%2FAIHub" target="_blank" title="https://github.com/aicoting/AIHub" ref="nofollow noopener noreferrer"><strong>AIHub</strong></a>ï¼Œæ¬¢è¿å…³æ³¨æ”¶è—ï¼</p>
<h2 data-id="heading-0">ä¸€ã€ä½ çœŸçš„éœ€è¦è®­ç»ƒä¸€ä¸ªæ–°æ¨¡å‹å—ï¼Ÿ</h2>
<p>Hugging Face åœ¨æ–‡æ¡£å¼€ç¯‡æå‡ºäº†ä¸€ä¸ªå¾ˆç°å®çš„é—®é¢˜ï¼šâ€œä½ æ˜¯å¦çœŸçš„éœ€è¦ä»å¤´è®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Ÿâ€</p>
<p>ä»–ä»¬åˆ—å‡ºäº†å‡ æ¡å¸¸è§ä½†é”™è¯¯çš„ç†ç”±â€”â€”â€œæœ‰å¤šä½™ç®—åŠ›â€ã€â€œå¤§å®¶éƒ½åœ¨åšâ€ã€â€œæˆ‘ä»¬ä¹Ÿæƒ³æœ‰è‡ªå·±çš„æ¨¡å‹â€ã€‚<br/>
æ¥ç€ï¼Œç»™å‡ºäº†ä¸€å¼ å†³ç­–æµç¨‹å›¾ï¼Œå¸®åŠ©å›¢é˜Ÿåˆ¤æ–­ï¼šæ˜¯å¾®è°ƒã€æ”¹ promptã€è¿˜æ˜¯å¿…é¡»é¢„è®­ç»ƒã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d014c8a4de8462fab34d31e498ba4da~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767414505&amp;x-signature=rOOUZoEpHTW0GADVUf%2Fbsn0MTjs%3D" alt="" loading="lazy"/></p>
<p>æ ¹æ®ä»–ä»¬çš„å®šä¹‰ï¼ŒçœŸæ­£å€¼å¾—ä»é›¶è®­ç»ƒçš„æƒ…å¢ƒåªå‰©ä¸‰ç§ï¼š</p>
<ol>
<li><strong>ç ”ç©¶é—®é¢˜</strong>ï¼šéªŒè¯æ–°çš„ä¼˜åŒ–å™¨æˆ–è®­ç»ƒç­–ç•¥ï¼›</li>
<li><strong>ä¸šåŠ¡çº¦æŸ</strong>ï¼šç‰¹å®šè¡Œä¸šæˆ–ç¡¬ä»¶éœ€æ±‚ï¼ˆå¦‚é‡‘èã€èˆªç©ºã€åŒ»ç–—è®¾å¤‡ï¼‰ï¼›</li>
<li><strong>æˆ˜ç•¥æ€§å¼€æº</strong>ï¼šå¼¥è¡¥ç°æœ‰ç”Ÿæ€ä¸­çš„ç©ºç™½ã€‚</li>
</ol>
<p>è¿™æ®µå†…å®¹å¬èµ·æ¥åƒæ˜¯åŠé€€ï¼Œä½†å…¶æ ¸å¿ƒæ˜¯<strong>ç°å®ä¸»ä¹‰</strong>ã€‚<br/>
é¢å¯¹ Llamaã€Gemmaã€Qwen ç­‰æ—¥è¶‹å®Œå–„çš„å¼€æºæ¨¡å‹ï¼Œé‡æ–°é€ è½®å­å¹¶ä¸æ˜¯å‹‡æ°”ï¼Œè€Œæ˜¯ä¸€ç§æˆæœ¬é«˜æ˜‚çš„é€‰æ‹©ã€‚</p>
<p>å¦‚æœä¸ºä»€ä¹ˆè§£å†³äº†åŠ¨æœºé—®é¢˜ï¼Œé‚£ä¹ˆè®­ç»ƒä»€ä¹ˆå°±å†³å®šäº†æ–¹å‘ã€‚</p>
<p>Hugging Face å›¢é˜Ÿæå‡ºäº†ä¸€ä¸ªæ€ç»´æ¡†æ¶ï¼š</p>
<p>è®©æŠ€æœ¯å†³ç­–åæ˜ ä¸šåŠ¡çº¦æŸï¼Œè€Œä¸æ˜¯å…´è¶£ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li>å¦‚æœæ¨¡å‹è¦åœ¨è¾¹ç¼˜è®¾å¤‡ä¸Šè¿è¡Œï¼Œæ¶æ„å¿…é¡»ä¼˜å…ˆè€ƒè™‘è®¡ç®—å¯†åº¦å’Œå»¶è¿Ÿã€‚</li>
<li>å¦‚æœç›®æ ‡æ˜¯å¤šè¯­è¨€èƒ½åŠ›ï¼Œé‚£ tokenizer çš„è®¾è®¡è¦ä¼˜å…ˆäºæ¨¡å‹æ·±åº¦ã€‚</li>
<li>å¦‚æœè¿½æ±‚é•¿ä¸Šä¸‹æ–‡æ¨ç†ï¼Œä½ç½®ç¼–ç ä¸æ ·æœ¬æ‰“åŒ…ç­–ç•¥å¿…é¡»åœ¨æœ€æ—©é˜¶æ®µç¡®å®šã€‚</li>
</ul>
<p>è¿™çœ‹ä¼¼å¸¸è¯†ï¼Œå´æ˜¯å¾ˆå¤šå¤±è´¥é¡¹ç›®çš„æ ¹æºâ€”â€”<strong>å›¢é˜Ÿå¸¸å¸¸åœ¨ä¸çŸ¥é“ç›®æ ‡çš„æƒ…å†µä¸‹å¼€å§‹å †ç®—åŠ›</strong>ã€‚<br/>
SmolLM3 çš„è®¾è®¡è¿‡ç¨‹ï¼Œä»ä¸€å¼€å§‹å°±è¢«ç»‘å®šåœ¨è¿™äº›çº¦æŸä¸Šã€‚</p>
<h2 data-id="heading-1">äºŒã€æ¯ä¸€ä¸ªç¨³å®šçš„æ¨¡å‹éƒ½è¯ç”Ÿäºæ¶ˆè</h2>
<p>Hugging Face åœ¨æ–‡æ¡£ä¸­åå¤å¼ºè°ƒä¸€ä¸ªè¯ï¼š<strong>æ¶ˆèå®éªŒï¼ˆablationï¼‰</strong>ã€‚</p>
<p>ä»–ä»¬è®¤ä¸ºï¼Œå¤§æ¨¡å‹è®­ç»ƒçš„çœŸæ­£ç“¶é¢ˆä¸æ˜¯ç®—åŠ›ï¼Œè€Œæ˜¯<strong>ä¸ç¡®å®šæ€§</strong>ã€‚<br/>
ç†è®ºä¸Šåˆç†çš„æ”¹åŠ¨ï¼Œå¾€å¾€åœ¨å®è·µä¸­å´©æºƒã€‚</p>
<p>SmolLM3 çš„ä¸»è®­ç»ƒç”¨äº† 11 ä¸‡äº¿ tokensï¼Œä½†åœ¨æ­¤ä¹‹å‰ï¼Œä»–ä»¬åœ¨å°è§„æ¨¡æ¨¡å‹ä¸Šè¿›è¡Œäº†æ•°åç»„å®éªŒâ€”â€”æµ‹è¯•ä¼˜åŒ–å™¨ã€æ³¨æ„åŠ›å®ç°ã€æƒé‡è¡°å‡ã€ä½ç½®ç¼–ç ç­‰ç»†èŠ‚ã€‚</p>
<p>å…¶ä¸­ä¸€ä¸ªå…¸å‹æ¡ˆä¾‹æ˜¯ä½ç½®ç¼–ç ï¼šä¼ ç»Ÿ RoPE ç¼–ç åœ¨é•¿ä¸Šä¸‹æ–‡ä¸­ä¼šå¤±æ•ˆï¼Œå›¢é˜Ÿé€šè¿‡æ··åˆ RoPE ä¸ NoPEï¼ˆç§°ä¸º RNoPEï¼‰è§£å†³äº†è¿™ä¸€é—®é¢˜ã€‚<br/>
è¿™ç§æ–¹æ¡ˆå¹¶éæ¥è‡ªæ–‡çŒ®ï¼Œè€Œæ˜¯ä»åå¤è¯•éªŒä¸­è¢«é€¼å‡ºæ¥çš„ã€‚</p>
<p>æ–‡æ¡£ä¸­çš„ä¸€å¥è¯å¾ˆå…¸å‹ï¼šâ€œé™¤éæœ‰å®éªŒè¯æ˜æœ‰æ•ˆï¼Œå¦åˆ™ä¸è¦æ”¹åŠ¨ä»»ä½•ç»„ä»¶ã€‚â€</p>
<p>è¿™èƒŒåä½“ç°çš„æ˜¯ä¸€ç§å·¥ç¨‹åŒ–å¿ƒæ€ï¼Œ<strong>ç§‘å­¦å‡è®¾åœ¨ GPU é¢å‰è¦å…ˆè¿‡éªŒè¯å…³ã€‚</strong></p>
<h2 data-id="heading-2">ä¸‰ã€æ¶æ„é€‰æ‹©çš„æƒè¡¡</h2>
<p>SmolLM3 çš„æ¶æ„çœ‹ä¼¼å¹³å¹³â€”â€”æ ‡å‡† Transformerï¼Œä½†æ¯ä¸ªå†³ç­–éƒ½æ¥è‡ªéªŒè¯ã€‚</p>
<ul>
<li><strong>æ³¨æ„åŠ›æœºåˆ¶</strong>ï¼šä½¿ç”¨åˆ†ç»„æŸ¥è¯¢ï¼ˆGQAï¼‰æ›¿ä»£å¤šå¤´æ³¨æ„åŠ›ï¼ˆMHAï¼‰ï¼Œåœ¨èŠ‚çœæ˜¾å­˜çš„åŒæ—¶ä¿æŒæ€§èƒ½ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de60f63976c04cbb8cc90398522c61b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767414505&amp;x-signature=8z9iKqxf7cnNWY0ZiJVa6n2p7xk%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong>åµŒå…¥å±‚å…±äº«</strong>ï¼šä¸ºäº†èŠ‚çœå‚æ•°ï¼Œå°†è¾“å…¥å’Œè¾“å‡ºåµŒå…¥çŸ©é˜µåˆå¹¶ï¼Œç”¨æ·±åº¦æ¢å–å®½åº¦ã€‚</li>
<li><strong>ç¨³å®šæ€§æŠ€å·§</strong>ï¼šç§»é™¤åµŒå…¥å±‚çš„æƒé‡è¡°å‡ï¼ˆæ¥è‡ª OLMo2 çš„ç»éªŒï¼‰é¿å…æ¢¯åº¦éœ‡è¡ã€‚</li>
</ul>
<p>è¿™å¥—ä¿å®ˆçš„æ¶æ„å¹¶æ²¡æœ‰è¿½æ±‚å‰æ²¿ï¼Œè€Œæ˜¯å›´ç»•å¯å¤ç°ä¸é•¿æœŸè®­ç»ƒç¨³å®šæ€§ä¼˜åŒ–ã€‚<br/>
å›¢é˜Ÿçš„ç»“è®ºæ˜¯ï¼š<strong>å°æ¨¡å‹æ¯”å¤§æ¨¡å‹æ›´å®¹æ˜“è¢«æ¶æ„é€‰æ‹©å®³æ­»</strong>ï¼Œå› æ­¤è®¾è®¡å¿…é¡»åŠ¡å®ã€‚</p>
<h2 data-id="heading-3">å››ã€æ•°æ®å†³å®šçµé­‚</h2>
<p>å¦‚æœè¯´æ¨¡å‹ç»“æ„å†³å®šæ€ä¹ˆå­¦ï¼Œæ•°æ®åˆ™å†³å®šå­¦ä»€ä¹ˆã€‚<br/>
Hugging Face çš„æ€åº¦å¾ˆæ˜ç¡®ï¼š<strong>æ•°æ®æ··åˆæ¯”æ¶æ„æ›´å…³é”®ã€‚</strong></p>
<p>ä»–ä»¬çš„ç»éªŒæ˜¯â€”â€”æ•°æ®ä¸æ˜¯è¶Šé«˜è´¨é‡è¶Šå¥½ã€‚<br/>
ä¾‹å¦‚ï¼Œè¿‡å¤šçš„å­¦æœ¯è®ºæ–‡æ–‡æœ¬ä¼šè®©æ¨¡å‹åœ¨é€šç”¨è¯­ä¹‰ä»»åŠ¡ä¸Šè¡¨ç°é€€åŒ–ã€‚</p>
<p>çœŸæ­£çš„å…³é”®åœ¨äºæ¯”ä¾‹å’ŒèŠ‚å¥ï¼š</p>
<ul>
<li>è®­ç»ƒåˆæœŸï¼Œç”¨å¤šæ ·ã€ç•¥å¸¦å™ªå£°çš„æ•°æ®æå‡é²æ£’æ€§ï¼›</li>
<li>ä¸­åæœŸï¼ˆå°¤å…¶å­¦ä¹ ç‡è¡°å‡é˜¶æ®µï¼‰ï¼Œå¼•å…¥é«˜è´¨é‡é¢†åŸŸæ•°æ®å¼ºåŒ–èƒ½åŠ›ã€‚</li>
</ul>
<p>è¿™ç§åŠ¨æ€è¯¾ç¨‹å¼è®­ç»ƒï¼ˆcurriculum schedulingï¼‰åœ¨ SmolLM3 ä¸­è¢«ä¸¥æ ¼æ‰§è¡Œã€‚<br/>
ç”šè‡³è¿ä½•æ—¶åˆ‡æ¢æ•°æ®é…æ–¹éƒ½ç”±åœ¨çº¿è¯„ä¼°æŒ‡æ ‡å†³å®šï¼Œè€Œéäººå·¥é¢„è®¾ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7a86e9a664fe484bb6055b869de09758~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767414505&amp;x-signature=tmd0KzFR%2FhoDEw8De9KlaL5txRA%3D" alt="" loading="lazy"/></p>
<p>æ–‡æ¡£æŠŠè¿™ç§è¿‡ç¨‹ç§°ä¸ºæ•°æ®æŒ‡æŒ¥ï¼ˆData Conductorï¼‰â€”â€”æ¨¡å‹çš„è¡Œä¸ºä¸æ˜¯å†™åœ¨ä»£ç é‡Œï¼Œè€Œæ˜¯å†™åœ¨å®ƒæœ€åè¯»åˆ°çš„é‚£æ‰¹æ•°æ®é‡Œã€‚</p>
<h2 data-id="heading-4">äº”ã€ç°å®ä¸­çš„è®­ç»ƒ</h2>
<p>Hugging Face ç”¨é£è¡Œå‰æ£€æŸ¥å½¢å®¹æ­£å¼è®­ç»ƒå‰çš„å‡†å¤‡å·¥ä½œã€‚<br/>
å› ä¸ºå½“ä½ å¯åŠ¨ 384 å¼  H100 æ—¶ï¼Œä»»ä½•é…ç½®é”™è¯¯éƒ½å¯èƒ½æ„å‘³ç€å‡ ä¸‡ç¾å…ƒçš„æµªè´¹ã€‚</p>
<p>ä»–ä»¬åˆ—å‡ºäº†åŒ…æ‹¬ï¼š</p>
<ul>
<li>checkpoint æ¢å¤æœºåˆ¶ï¼›</li>
<li>æ•°æ®åŠ è½½å¥åº·æ£€æŸ¥ï¼›</li>
<li>GPU ååç‡ä¸çƒ­ç¨³å®šæ€§ç›‘æ§ï¼›</li>
<li>ä»¥åŠæ—¥å¿—ç³»ç»Ÿçš„å†—ä½™å¤‡ä»½ã€‚</li>
</ul>
<p>ä½†å³ä¾¿å¦‚æ­¤ï¼Œè®­ç»ƒä»ç„¶ä¼šå‡ºäº‹æ•…ã€‚<br/>
æ–‡æ¡£è®°å½•äº†å…¸å‹é—®é¢˜ï¼šâ€œååç‡çªç„¶ä¸‹é™ã€loss æ›²çº¿å˜å¾—å™ªå£°åŒ–ã€èŠ‚ç‚¹é—´é€šä¿¡å»¶è¿Ÿå¼‚å¸¸ã€‚â€</p>
<p>ä¸ºæ­¤ï¼Œä»–ä»¬å¼€å‘äº† GPU Fryerï¼ˆå‹åŠ›æµ‹è¯•ï¼‰ä¸ DCGMï¼ˆè¯Šæ–­ç®¡ç†å™¨ï¼‰æ¥æ£€æµ‹æ˜¾å­˜ã€PCIe è¿æ¥ä¸çƒ­ç¨³å®šæ€§ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5612345563264ad28ca8f0eec25613fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767414505&amp;x-signature=gXFUh8pnc73vRJTRcml79o195rE%3D" alt="" loading="lazy"/></p>
<p>è®­ç»ƒä¸€ä¸ª LLMï¼Œæ›´åƒæ˜¯<strong>è¿ç»´ä¸€åº§å¾®ç¼©çš„æ•°æ®ä¸­å¿ƒ</strong>ã€‚<br/>
Hugging Face çš„å·¥ç¨‹å¸ˆæ€»ç»“å¾—å¾ˆå¹²è„†ï¼šâ€œåœ¨è§„æ¨¡åŒ–è®­ç»ƒä¸­ï¼Œé—®é¢˜ä¸ä¼šæ¶ˆå¤±ï¼Œåªä¼šè½®æµå‡ºç°ã€‚â€</p>
<h2 data-id="heading-5">å…­ã€åè®­ç»ƒ</h2>
<p>å®Œæˆé¢„è®­ç»ƒçš„ SmolLM3 åªå…·å¤‡åŸå§‹è¯­è¨€èƒ½åŠ›ï¼Œç¦»å¯ç”¨äº§å“è¿˜å·®ä¸€å¤§æ­¥ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b55e6ffd5a6444094158799642be7ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767414505&amp;x-signature=agKW6cEckk9sgPPz3mTd%2BY2uTkI%3D" alt="" loading="lazy"/></p>
<p>åè®­ç»ƒé˜¶æ®µåŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>ç›‘ç£å¾®è°ƒï¼ˆSFTï¼‰</strong> â€”â€” å»ºç«‹ä»»åŠ¡æ„è¯†ï¼›</li>
<li><strong>åå¥½ä¼˜åŒ–ï¼ˆDPO / PPOï¼‰</strong> â€”â€” å­¦ä¹ äººç±»åå¥½ï¼›</li>
<li><strong>å¼ºåŒ–å­¦ä¹ ï¼ˆRLHFï¼‰</strong> â€”â€” æå‡ç¨³å¥æ€§ä¸ä¸€è‡´æ€§ã€‚</li>
</ol>
<p>å›¢é˜Ÿå¼ºè°ƒï¼Œä¸å¿…ç¥è¯ RLHFã€‚<br/>
SFT æˆæœ¬ä½ã€ç¨³å®šã€æ•ˆæœæ˜æ˜¾ï¼Œæ˜¯æ‰€æœ‰æ”¹è¿›çš„èµ·ç‚¹ã€‚<br/>
åç»­çš„ DPO ä¸ RLHF æ›´åƒæ‰“ç£¨ï¼Œè€Œä¸æ˜¯é‡å¡‘ã€‚</p>
<h2 data-id="heading-6">ä¸ƒã€åŸºç¡€è®¾æ–½</h2>
<p>æ–‡æ¡£çš„æœ€åä¸€éƒ¨åˆ†è°ˆçš„ä¸æ˜¯ç®—æ³•ï¼Œè€Œæ˜¯<strong>åŸºç¡€è®¾æ–½</strong>ã€‚åœ¨é•¿è¾¾æ•°å‘¨çš„è®­ç»ƒä¸­ï¼ŒåŸºç¡€è®¾æ–½çš„å¯é æ€§å†³å®šé¡¹ç›®èƒ½å¦å®Œæˆã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/69a8c61e39da4a67bb348b97e5c346e2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767414505&amp;x-signature=yuMzBPE7QMzGIt3jZMQuys1RMWU%3D" alt="" loading="lazy"/></p>
<p>ä»–ä»¬è¯¦ç»†ä»‹ç»äº† GPU å¥åº·ç›‘æµ‹ã€å†…å­˜é€šä¿¡ã€æ•°æ®åŒæ­¥ç­–ç•¥ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ba204bd77eb54c81acce71214faa9cab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767414505&amp;x-signature=zdHNPzKDx5QkXhTFO%2BMTTvwgrd0%3D" alt="" loading="lazy"/></p>
<p>å¹¶ç»™å‡ºäº†ä¸€ä¸ªå®é™…ç®—åŠ›ä¼°ç®—å…¬å¼ï¼š</p>
<p>æ‰€éœ€ GPU æ•°é‡ â‰ˆ (æ¨¡å‹å‚æ•°é‡ Ã— è®­ç»ƒ Tokens Ã— æ¯ Token FLOPs) Ã· (å• GPU åå Ã— ç›®æ ‡è®­ç»ƒæ—¶é—´)</p>
<p>ä»£å…¥ SmolLM3 çš„å‚æ•°ï¼Œç»“æœæ˜¯ 379 å— GPUã€‚<br/>
æœ€ç»ˆéƒ¨ç½² 384 å—ï¼Œä»¥ä¾¿åœ¨å‡ºç°èŠ‚ç‚¹æŸåæ—¶æœ‰å®¹é”™ä½™é‡ã€‚</p>
<p>è¿™éƒ¨åˆ†æé†’è¯»è€…è®­ç»ƒ LLM ä¸ä»…æ˜¯ç§‘å­¦å®éªŒï¼Œæ›´æ˜¯å·¥ç¨‹é¡¹ç›®ã€‚æ²¡æœ‰ç¨³å®šçš„åŸºç¡€è®¾æ–½ï¼Œå†å¥½çš„æ¶æ„ä¹Ÿæ— æ³•è½åœ°ã€‚</p>
<p>Hugging Face çš„è¿™ç¯‡é•¿æ–‡æ²¡æœ‰å¤ªå¤šçªç ´æ€§ç®—æ³•ï¼Œä½†å®ƒæä¾›äº†ä¸€ä¸ªä¸åŒçš„è§†è§’â€”â€”<strong>æŠŠæ¨¡å‹è®­ç»ƒå½“ä½œç°å®å·¥ç¨‹è€ŒéæŠ½è±¡ç§‘å­¦</strong>ã€‚</p>
<p>å®ƒè®©äººçœ‹åˆ°ï¼Œåœ¨å·¨å¤§çš„æŠ€æœ¯å™äº‹ä¹‹å¤–ï¼Œä¸€ä¸ªå¤§æ¨¡å‹çš„è¯ç”Ÿï¼Œå…¶å®æ›´æ¥è¿‘ä¸€æ¬¡é•¿æœŸçš„ç³»ç»Ÿå»ºè®¾ï¼šä»ç†å¿µã€å®éªŒã€æ•°æ®ã€ç›‘æ§åˆ°ä¿®å¤ï¼Œæ¯ä¸ªç¯èŠ‚éƒ½åœ¨å’Œç°å®çš„æ‘©æ“¦ä¸­å‰è¿›ã€‚</p>
<p><strong>ğŸ“šæ¨èé˜…è¯»</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1967942441748371257" target="_blank" title="https://zhuanlan.zhihu.com/p/1967942441748371257" ref="nofollow noopener noreferrer">è¯¦è§£Kimi Linearâ€”â€”æœ‰æœ›æ›¿ä»£å…¨æ³¨æ„åŠ›çš„å…¨æ–°æ³¨æ„åŠ›æ¶æ„</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1927844769058497732" target="_blank" title="https://zhuanlan.zhihu.com/p/1927844769058497732" ref="nofollow noopener noreferrer">GPTâ€‘4ï¼šå¤šæ¨¡æ€å¤§è§„æ¨¡æ¨¡å‹ï¼Œå¼€å¯æ›´æ™ºèƒ½æ—¶ä»£</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1937265830216857540" target="_blank" title="https://zhuanlan.zhihu.com/p/1937265830216857540" ref="nofollow noopener noreferrer">ä¸€æ–‡ææ‡‚DeepSeek LLM</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1930331294874703770" target="_blank" title="https://zhuanlan.zhihu.com/p/1930331294874703770" ref="nofollow noopener noreferrer">LLaMA 3ï¼šç¦» AGI æ›´è¿‘ä¸€æ­¥ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1936554902206784162" target="_blank" title="https://zhuanlan.zhihu.com/p/1936554902206784162" ref="nofollow noopener noreferrer">Grok-1ï¼šé©¬æ–¯å…‹æ——ä¸‹ xAI é¦–ä¸ªå¼€æºå¤§æ¨¡å‹å…¨é¢è§£æ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1961825568644401081" target="_blank" title="https://zhuanlan.zhihu.com/p/1961825568644401081" ref="nofollow noopener noreferrer">LongCat-Flashï¼šç¾å›¢å‡ºæ‰‹ï¼Œå›½äº§å¡ä¸Šè·‘å‡ºçš„ã€Œé—ªç”µçº§ã€å¤§æ¨¡å‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1966265102568265354" target="_blank" title="https://zhuanlan.zhihu.com/p/1966265102568265354" ref="nofollow noopener noreferrer">ç¾å›¢å‘åŠ›ï¼ŒLongCat-Videoå‘å¸ƒï¼</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1968799296439693416" target="_blank" title="https://zhuanlan.zhihu.com/p/1968799296439693416" ref="nofollow noopener noreferrer">LongCat-Flash-Omniï¼šç¾å›¢çš„å…¨æ¨¡æ€å¤§æ¨¡å‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1970980105363886971" target="_blank" title="https://zhuanlan.zhihu.com/p/1970980105363886971" ref="nofollow noopener noreferrer">Kimi K2 Thinkingï¼šé¢å‘æ€è€ƒï¼‹å·¥å…·è°ƒç”¨çš„é«˜é˜¶æ™ºèƒ½ä½“å¤§æ¨¡å‹</a></p>
<p>å…³äºæ·±åº¦å­¦ä¹ å’ŒAIå¤§æ¨¡å‹ç›¸å…³çš„çŸ¥è¯†å’Œå‰æ²¿æŠ€æœ¯æ›´æ–°ï¼Œè¯·å…³æ³¨å…¬ä¼—å· <strong>coting</strong>ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Transformer ä¸­ä¸ºä»€ä¹ˆç”¨LayerNormè€Œä¸ç”¨BatchNormï¼Ÿ]]></title>    <link>https://juejin.cn/post/7588042910194942002</link>    <guid>https://juejin.cn/post/7588042910194942002</guid>    <pubDate>2025-12-27T04:33:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588042910194942002" data-draft-id="7588086766247690291" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Transformer ä¸­ä¸ºä»€ä¹ˆç”¨LayerNormè€Œä¸ç”¨BatchNormï¼Ÿ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-27T04:33:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="coting"/> <meta itemprop="url" content="https://juejin.cn/user/933911964427818"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Transformer ä¸­ä¸ºä»€ä¹ˆç”¨LayerNormè€Œä¸ç”¨BatchNormï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/933911964427818/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    coting
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T04:33:53.000Z" title="Sat Dec 27 2025 04:33:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ— è®ºæ˜¯ BERTã€GPT è¿˜æ˜¯ ViTï¼Œå‡ ä¹éƒ½ä¸ç”¨ Batch Normalizationï¼Œè€Œæ˜¯æ¸…ä¸€è‰²åœ°ç”¨ Layer Normalizationã€‚<br/>
è¿™ä¸æ˜¯å·§åˆï¼Œè€Œæ˜¯ Transformer æ¶æ„ä¸­ä¸€ä¸ªéå¸¸æ·±å±‚çš„è®¾è®¡é€‰æ‹©ã€‚
æ‰€æœ‰ç›¸å…³æºç ç¤ºä¾‹ã€æµç¨‹å›¾ã€é¢è¯•å…«è‚¡ã€æ¨¡å‹é…ç½®ä¸çŸ¥è¯†åº“æ„å»ºæŠ€å·§ï¼Œæˆ‘ä¹Ÿå°†æŒç»­æ›´æ–°åœ¨Githubï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Faicoting%2FAIHub" target="_blank" title="https://github.com/aicoting/AIHub" ref="nofollow noopener noreferrer"><strong>AIHub</strong></a>ï¼Œæ¬¢è¿å…³æ³¨æ”¶è—ï¼</p>
<h2 data-id="heading-0">ä¸€ã€BN å’Œ LN åˆ°åº•åœ¨åšä»€ä¹ˆï¼Ÿ</h2>
<p>BN å’Œ LN çš„å‡ºå‘ç‚¹å…¶å®ä¸€æ ·â€”â€”<strong>ç¨³å®šè®­ç»ƒï¼Œé˜²æ­¢æ¢¯åº¦çˆ†ç‚¸æˆ–æ¶ˆå¤±</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b87daf6213cb40eca921271df82fd30f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767414832&amp;x-signature=mj%2B%2F9I6ALCv%2BExNlxMSRm5mdt60%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong>Batch Normalizationï¼ˆBNï¼‰</strong>ï¼š<br/>
å®ƒåœ¨ä¸€ä¸ª batch å†…è®¡ç®—å‡å€¼å’Œæ–¹å·®ï¼Œå¯¹åŒä¸€å±‚çš„æ‰€æœ‰æ ·æœ¬çš„æ¯ä¸ªé€šé“åšæ ‡å‡†åŒ–ã€‚<br/>
æ¢å¥è¯è¯´ï¼ŒBN å…³å¿ƒçš„æ˜¯<strong>è¿™ä¸€æ‰¹æ•°æ®çš„ç»Ÿè®¡ç‰¹å¾</strong>ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/53fa1da874854ef299fb2c0e8d3e077d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767414832&amp;x-signature=ktu1j1rc4l21Ogzl7uSVNHLNvwI%3D" alt="image" loading="lazy"/></li>
<li><strong>Layer Normalizationï¼ˆLNï¼‰</strong>ï¼š<br/>
LN åˆ™æ˜¯åœ¨åŒä¸€ä¸ªæ ·æœ¬å†…éƒ¨è®¡ç®—å‡å€¼å’Œæ–¹å·®ï¼Œå¯¹è¯¥æ ·æœ¬çš„æ‰€æœ‰ç‰¹å¾ç»´åº¦ä¸€èµ·å½’ä¸€åŒ–ã€‚<br/>
æ¢å¥è¯è¯´ï¼ŒLN å…³å¿ƒçš„æ˜¯<strong>å•ä¸ªæ ·æœ¬å†…éƒ¨çš„ç‰¹å¾åˆ†å¸ƒ</strong>ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71266b0ccba349abacadc92ec8094017~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767414832&amp;x-signature=GYbEzuDVAYrKX2pK1T%2BWD2j9Qq0%3D" alt="image" loading="lazy"/></li>
</ul>
<p>BN æ˜¯è·¨æ ·æœ¬å½’ä¸€åŒ–ï¼ŒLN æ˜¯å•æ ·æœ¬å½’ä¸€åŒ–ã€‚</p>
<h2 data-id="heading-1">äºŒã€BN çš„é—®é¢˜</h2>
<p>BN åœ¨ CNN æ—¶ä»£éå¸¸æˆåŠŸï¼Œä½†ä¸ºä»€ä¹ˆåœ¨ Transformer ä¸­å°±å˜å¾—æ°´åœŸä¸æœï¼Ÿ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aadc88b99c9942caafadf2819b076be2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767414832&amp;x-signature=QqvYXs9OWKwXSmPLBiNmrISTgFg%3D" alt="" loading="lazy"/></p>
<p>æ ¹æœ¬åŸå› æœ‰ä¸‰ç‚¹ã€‚</p>
<h3 data-id="heading-2">1. Transformer æ˜¯<strong>åºåˆ—æ¨¡å‹</strong>ï¼Œbatch ç»´åº¦ä¸ç¨³å®š</h3>
<p>BN çš„è®¡ç®—ä¾èµ– batch çš„ç»Ÿè®¡é‡ï¼ˆå‡å€¼å’Œæ–¹å·®ï¼‰ã€‚<br/>
è€Œ Transformer çš„è¾“å…¥å¾€å¾€æ˜¯<strong>å˜é•¿åºåˆ—</strong>ï¼Œä¸åŒæ ·æœ¬é•¿åº¦ä¸åŒï¼Œpadding æ•°é‡ä¸åŒï¼Œå¯¼è‡´ batch å†…ç»Ÿè®¡ç‰¹æ€§ä¸ä¸€è‡´ï¼ŒBN çš„å‡å€¼å’Œæ–¹å·®å˜å¾—ä¸å¯é ã€‚</p>
<h3 data-id="heading-3">2. <strong>è‡ªæ³¨æ„åŠ›æœºåˆ¶ç ´åäº†ç©ºé—´ç‹¬ç«‹æ€§</strong></h3>
<p>åœ¨å·ç§¯ä¸­ï¼ŒBN å¯¹é€šé“å½’ä¸€åŒ–æ˜¯åˆç†çš„ï¼Œå› ä¸ºæ¯ä¸ªé€šé“ç‰¹å¾ç›¸å¯¹ç‹¬ç«‹ã€‚<br/>
ä½†åœ¨ Transformer çš„ Self-Attention ä¸­ï¼Œ<strong>æ¯ä¸ª token éƒ½ä¸å…¶ä»– token æœ‰å¼ºå…³è”</strong>ã€‚<br/>
æ­¤æ—¶å†æŒ‰ batch ç»Ÿè®¡å‡å€¼ã€æ–¹å·®ï¼Œå°±ä¼šè®©ä¸åŒæ ·æœ¬çš„åˆ†å¸ƒäº’ç›¸å¹²æ‰°ï¼Œç ´åæ³¨æ„åŠ›æœºåˆ¶çš„å­¦ä¹ ç¨³å®šæ€§ã€‚</p>
<h3 data-id="heading-4">3. <strong>æ¨ç†é˜¶æ®µ BN çš„ç»Ÿè®¡ç‰¹æ€§éš¾ä»¥å¤ç”¨</strong></h3>
<p>BN åœ¨æ¨ç†æ—¶ä¼šä½¿ç”¨è®­ç»ƒé˜¶æ®µçš„æ»‘åŠ¨å‡å€¼æ¥åšå½’ä¸€åŒ–ã€‚<br/>
ä½† Transformer çš„è¾“å…¥åˆ†å¸ƒåœ¨æ¨ç†é˜¶æ®µå¾€å¾€ä¸è®­ç»ƒæ—¶ä¸åŒï¼ˆæ¯”å¦‚å˜é•¿æ–‡æœ¬ã€ä¸åŒè¯­è¨€æˆ–é¢†åŸŸï¼‰ï¼Œè¿™ä¼šå¯¼è‡´åˆ†å¸ƒæ¼‚ç§»ï¼ˆdistribution shiftï¼‰ï¼Œä»è€Œå¼•å…¥åå·®ã€‚<br/>
LN ä¸ä¾èµ– batchï¼Œå› æ­¤å¤©ç„¶æ›´ç¨³å®šã€‚</p>
<h2 data-id="heading-5">ä¸‰ã€LN çš„ä¼˜åŠ¿</h2>
<p>ç›¸è¾ƒ BNï¼ŒLN æœ‰ä¸‰ä¸ªå¤©ç„¶ä¼˜åŠ¿ï¼Œè®©å®ƒå‡ ä¹æˆäº† Transformer çš„æ ‡é…ï¼š</p>
<ol>
<li><strong>ä¸ batch size æ— å…³</strong>ï¼šLN åœ¨æ ·æœ¬å†…éƒ¨å½’ä¸€åŒ–ï¼Œbatch åªè¦æœ‰ä¸€ä¸ªæ ·æœ¬éƒ½èƒ½è·‘ã€‚</li>
<li><strong>é€‚åˆå˜é•¿åºåˆ—</strong>ï¼šæ¯ä¸ª token ç‹¬ç«‹å½’ä¸€åŒ–ï¼Œä¸å— paddingã€mask ç­‰å½±å“ã€‚</li>
<li><strong>è®­ç»ƒå’Œæ¨ç†ä¸€è‡´</strong>ï¼šLN åœ¨è®­ç»ƒå’Œæ¨ç†é˜¶æ®µç”¨çš„ç»Ÿè®¡é‡å®Œå…¨ä¸€è‡´ï¼Œä¸å­˜åœ¨åˆ†å¸ƒæ¼‚ç§»é—®é¢˜ã€‚</li>
</ol>
<p>è¿™äº›ç‰¹æ€§è®© LN ç‰¹åˆ«é€‚åˆå¤§æ¨¡å‹â€”â€”å°¤å…¶æ˜¯åœ¨åˆ†å¸ƒå¼ã€å¼‚æ­¥ã€å˜é•¿è¾“å…¥çš„ç¯å¢ƒä¸‹ã€‚</p>
<p>æ›´æ·±å±‚æ¬¡çš„ï¼ŒBN çš„å½’ä¸€åŒ–ç²’åº¦æ˜¯ <strong>batch ç»´åº¦</strong>ï¼Œè€Œ Transformer æƒ³æ•æ‰çš„æ˜¯ <strong>token ä¹‹é—´çš„å¾®å¦™å…³ç³»</strong>ã€‚<br/>
å½“æ¯ä¸ªæ ·æœ¬é•¿åº¦ä¸åŒã€token ç›¸å…³æ€§å¼ºæ—¶ï¼ŒBN çš„è·¨æ ·æœ¬å½’ä¸€åŒ–åè€Œä¼šå‰Šå¼±æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ã€‚</p>
<p>LN çš„å½’ä¸€åŒ–å‘ç”Ÿåœ¨ç‰¹å¾ç»´åº¦å†…éƒ¨ï¼Œä¿è¯äº†<strong>æ¯ä¸ª token çš„ç‰¹å¾åˆ†å¸ƒç¨³å®š</strong>ï¼Œä¸ä¼šè¢«å…¶ä»–æ ·æœ¬çš„ç»Ÿè®¡ç‰¹å¾å¹²æ‰°ã€‚</p>
<p>è¿™å…¶å®æ˜¯ä¸€ç§ä»æ ·æœ¬å±‚é¢å‘ç‰¹å¾å±‚é¢çš„æ€ç»´è½¬å˜ã€‚</p>
<p>æ‰€ä»¥ï¼Œæ€»ç»“ä¸€ä¸‹ï¼š</p>
<p>Transformer ç”¨ LN è€Œä¸ç”¨ BNï¼Œæœ¬è´¨ä¸Šæ˜¯å› ä¸ºï¼š</p>
<ol>
<li>BN ä¾èµ– batch ç»Ÿè®¡é‡ï¼Œä¸é€‚åˆå˜é•¿ã€åˆ†å¸ƒå·®å¼‚å¤§çš„åºåˆ—æ•°æ®ï¼›</li>
<li>Attention æœºåˆ¶å¯¼è‡´æ ·æœ¬é—´ç‰¹å¾å¼ºè€¦åˆï¼ŒBN ä¼šç ´åè¿™ç§ç»“æ„ï¼›</li>
<li>LN ä¸ batch size æ— å…³ï¼Œæ¨ç†é˜¶æ®µä¹Ÿç¨³å®šä¸€è‡´ã€‚</li>
</ol>
<p>å…³äºæ·±åº¦å­¦ä¹ å’ŒAIå¤§æ¨¡å‹ç›¸å…³çš„çŸ¥è¯†å’Œå‰æ²¿æŠ€æœ¯æ›´æ–°ï¼Œè¯·å…³æ³¨å…¬ä¼—å· <strong>aicoting</strong>ï¼</p>
<p><strong>ğŸ“šæ¨èé˜…è¯»</strong></p>
<p>â—Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1918047303597552480" target="_blank" title="https://zhuanlan.zhihu.com/p/1918047303597552480" ref="nofollow noopener noreferrer">ä¸€è§ˆTransformeræ•´ä½“æ¶æ„</a></p>
<p>â—Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1918049072331362469" target="_blank" title="https://zhuanlan.zhihu.com/p/1918049072331362469" ref="nofollow noopener noreferrer">Transformerâ€”â€”Attentionæ€ä¹ˆå®ç°é›†ä¸­æ³¨æ„åŠ›</a></p>
<p>â—Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1918050616376301224" target="_blank" title="https://zhuanlan.zhihu.com/p/1918050616376301224" ref="nofollow noopener noreferrer">Transformerâ€”â€”FeedForwardæ¨¡å—åœ¨å¹²ä»€ä¹ˆï¼Ÿ</a></p>
<p>â—Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1918357249883105145" target="_blank" title="https://zhuanlan.zhihu.com/p/1918357249883105145" ref="nofollow noopener noreferrer">ä»0å¼€å§‹å®ç°Transformer</a></p>
<p>â—Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1919338888536756837" target="_blank" title="https://zhuanlan.zhihu.com/p/1919338888536756837" ref="nofollow noopener noreferrer">ä»€ä¹ˆæ˜¯KV-Cache</a></p>
<p>â—Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1919500956946655189" target="_blank" title="https://zhuanlan.zhihu.com/p/1919500956946655189" ref="nofollow noopener noreferrer">Transformeræ³¨æ„åŠ›æœºåˆ¶â€”â€”MHA&amp;MQA&amp;GQA</a></p>
<p>â—Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1923328314241704991" target="_blank" title="https://zhuanlan.zhihu.com/p/1923328314241704991" ref="nofollow noopener noreferrer">FlashAttentionæ€ä¹ˆæå‡é€Ÿåº¦çš„ï¼Ÿ</a></p>
<p>â—Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1963547933044631464" target="_blank" title="https://zhuanlan.zhihu.com/p/1963547933044631464" ref="nofollow noopener noreferrer">é¢è¯•å®˜ï¼šBatchNormã€LayerNormã€GroupNormã€InstanceNorm æœ‰ä»€ä¹ˆæœ¬è´¨åŒºåˆ«ï¼Ÿ</a></p>
<p>â—Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1962254381677257759" target="_blank" title="https://zhuanlan.zhihu.com/p/1962254381677257759" ref="nofollow noopener noreferrer">é¢è¯•å®˜ï¼šTransformerå¦‚ä½•ä¼˜åŒ–åˆ°çº¿æ€§çº§ï¼Ÿ</a></p>
<p>â—Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1923714840653993730" target="_blank" title="https://zhuanlan.zhihu.com/p/1923714840653993730" ref="nofollow noopener noreferrer">FlashAttention2ï¼šæ›´å¿«çš„æ³¨æ„åŠ›æœºåˆ¶ï¼Œæ›´å¥½çš„å¹¶è¡Œæ•ˆç‡</a></p>
<p>â—Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1924154277082961318" target="_blank" title="https://zhuanlan.zhihu.com/p/1924154277082961318" ref="nofollow noopener noreferrer">FlashAttention3 å…¨è§£æï¼šé€Ÿåº¦ã€ç²¾åº¦ã€æ˜¾å­˜çš„å†å¹³è¡¡</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ„å»ºAIæ™ºèƒ½ä½“ï¼šå…­åäº”ã€æ¨¡å‹æ™ºèƒ½è®­ç»ƒæ§åˆ¶ï¼šæ—©åœæœºåˆ¶åœ¨æ·±åº¦å­¦ä¹ ä¸­çš„åº”ç”¨è§£æ]]></title>    <link>https://juejin.cn/post/7587997157237833780</link>    <guid>https://juejin.cn/post/7587997157237833780</guid>    <pubDate>2025-12-27T05:03:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587997157237833780" data-draft-id="7587997157237817396" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ„å»ºAIæ™ºèƒ½ä½“ï¼šå…­åäº”ã€æ¨¡å‹æ™ºèƒ½è®­ç»ƒæ§åˆ¶ï¼šæ—©åœæœºåˆ¶åœ¨æ·±åº¦å­¦ä¹ ä¸­çš„åº”ç”¨è§£æ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,Python"/> <meta itemprop="datePublished" content="2025-12-27T05:03:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å½¼å²¸èŠ±å¼€äº†å—"/> <meta itemprop="url" content="https://juejin.cn/user/4153315734334538"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ„å»ºAIæ™ºèƒ½ä½“ï¼šå…­åäº”ã€æ¨¡å‹æ™ºèƒ½è®­ç»ƒæ§åˆ¶ï¼šæ—©åœæœºåˆ¶åœ¨æ·±åº¦å­¦ä¹ ä¸­çš„åº”ç”¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4153315734334538/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å½¼å²¸èŠ±å¼€äº†å—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T05:03:03.000Z" title="Sat Dec 27 2025 05:03:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯æ—©åœæœºåˆ¶</h2>
<p>åœ¨æ·±åº¦å­¦ä¹ æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸é¢ä¸´ä¸€ä¸ªå…³é”®é—®é¢˜ï¼šä½•æ—¶åœæ­¢è®­ç»ƒï¼Ÿ è®­ç»ƒä¸è¶³ä¼šå¯¼è‡´æ¬ æ‹Ÿåˆï¼Œæ¨¡å‹æ— æ³•å……åˆ†å­¦ä¹ æ•°æ®ç‰¹å¾ï¼›è®­ç»ƒè¿‡åº¦åˆ™ä¼šå¯¼è‡´è¿‡æ‹Ÿåˆï¼Œæ¨¡å‹è¿‡åº¦è®°å¿†è®­ç»ƒæ•°æ®ä¸­çš„å™ªå£°è€Œä¸§å¤±æ³›åŒ–èƒ½åŠ›ã€‚</p>
<p>æ—©åœæœºåˆ¶æ˜¯æœºå™¨å­¦ä¹ ä¸­ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„æ­£åˆ™åŒ–æŠ€æœ¯ï¼Œé€šè¿‡åœ¨éªŒè¯é›†æ€§èƒ½åœæ­¢æ”¹å–„æ—¶æå‰ç»ˆæ­¢è®­ç»ƒï¼Œè‡ªåŠ¨æ‰¾åˆ°æ¨¡å‹å¤æ‚åº¦å’Œæ³›åŒ–èƒ½åŠ›çš„æœ€ä½³å¹³è¡¡ç‚¹ã€‚é€šä¿—çš„è®²ï¼Œæ—©åœæœºåˆ¶å°±åƒä¸€ä¸ªæœ‰ç»éªŒçš„è€å¸ˆï¼Œåœ¨å­¦ç”Ÿå¼€å§‹å­¦ç³Šæ¶‚çš„æ—¶å€™åŠæ—¶å–Šåœï¼Œè®©å­¦ç”Ÿä¿æŒæœ€ä½³çš„å­¦ä¹ çŠ¶æ€ï¼Œä¸è¦ä¸€ç›´å­¦ä¸ä¼‘æ¯ï¼Œå¦‚æœå‘ç°æˆç»©ä¸æé«˜äº†ï¼Œå°±åŠæ—¶åœæ­¢ï¼Œé¿å…æµªè´¹æ—¶é—´ï¼Œæ£€æµ‹æŒæ¡ç¨‹åº¦ï¼Œä»è€Œæ¢å¤åˆ°æœ€ä½³çŠ¶æ€ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d01da0e0d4eb45f2a5e1fa532c0f0f93~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b285bK46Iqx5byA5LqG5ZCX:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767416653&amp;x-signature=FL98SlitJIq%2FfJFZ05bEV7LhCTI%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">äºŒã€æ—©åœæœºåˆ¶çš„ä»·å€¼</h2>
<p>æ—©åœæœºåˆ¶çš„æ ¸å¿ƒä»·å€¼åœ¨äºï¼š</p>
<ul>
<li>è‡ªåŠ¨é˜²è¿‡æ‹Ÿåˆï¼šåœ¨æ¨¡å‹å¼€å§‹è¿‡æ‹Ÿåˆå‰æ™ºèƒ½åœæ­¢</li>
<li>æå‡è®­ç»ƒæ•ˆç‡ï¼šé¿å…ä¸å¿…è¦çš„è®­ç»ƒè½®æ¬¡ï¼ŒèŠ‚çœè®¡ç®—èµ„æº</li>
<li>ç®€åŒ–è°ƒå‚è¿‡ç¨‹ï¼šè‡ªåŠ¨åŒ–å¯»æ‰¾æœ€ä½³è®­ç»ƒè½®æ¬¡ï¼Œå‡å°‘äººå·¥å¹²é¢„</li>
<li>æ”¹å–„æ¨¡å‹æ³›åŒ–ï¼šè·å¾—åœ¨æœªè§æ•°æ®ä¸Šè¡¨ç°æ›´å¥½çš„æ¨¡å‹</li>
</ul>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ—©åœæœºåˆ¶èƒ½å¤Ÿï¼š</p>
<ul>
<li>å‡å°‘30-80%çš„è®­ç»ƒæ—¶é—´ï¼Œæ˜¾è‘—é™ä½è®¡ç®—æˆæœ¬</li>
<li>æå‡æ¨¡å‹åœ¨ç”Ÿäº§ç¯å¢ƒä¸­çš„ç¨³å®šæ€§å’Œå¯é æ€§</li>
<li>ä½¿éä¸“å®¶ç”¨æˆ·ä¹Ÿèƒ½è®­ç»ƒå‡ºé«˜è´¨é‡çš„æ¨¡å‹</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30015d2a6fa1466eaa3728cd25cb5774~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b285bK46Iqx5byA5LqG5ZCX:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767416653&amp;x-signature=MSoFKnsigiS9nq3nvrR%2FFeLwNGU%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">ä¸‰ã€æ—©åœæœºåˆ¶å…³é”®å‚æ•°</h2>
<h3 data-id="heading-3">1. patienceï¼ˆè€å¿ƒå€¼ï¼‰</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ä¸åŒåœºæ™¯çš„æ¨èå€¼</span>
ç®€å•é—®é¢˜: <span class="hljs-attr">patience</span> = <span class="hljs-number">5</span>-<span class="hljs-number">10</span>
å¤æ‚é—®é¢˜: <span class="hljs-attr">patience</span> = <span class="hljs-number">15</span>-<span class="hljs-number">25</span>
ä¸ç¨³å®šè®­ç»ƒ: <span class="hljs-attr">patience</span> = <span class="hljs-number">20</span>-<span class="hljs-number">30</span>
</code></pre>
<p><strong>ä½œç”¨ï¼š</strong></p>
<ul>
<li>æ§åˆ¶æ—©åœçš„æ•æ„Ÿåº¦</li>
<li>é˜²æ­¢å› è®­ç»ƒæ³¢åŠ¨è€Œè¿‡æ—©åœæ­¢</li>
<li>å¹³è¡¡è®­ç»ƒå……åˆ†æ€§å’Œæ•ˆç‡</li>
</ul>
<h3 data-id="heading-4">2. min_deltaï¼ˆæœ€å°æ”¹å–„é˜ˆå€¼ï¼‰</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å…¸å‹è®¾ç½®</span>
<span class="hljs-attr">min_delta</span> = <span class="hljs-number">0.001</span>  <span class="hljs-comment"># å¯¹äºæŸå¤±å‡½æ•°ï¼Œæ”¹å–„å¿…é¡»å¤§äº0.001æ‰ç®—æ˜¾è‘—</span>
<span class="hljs-attr">min_delta</span> = <span class="hljs-number">0.0001</span> <span class="hljs-comment"># å¯¹äºé«˜ç²¾åº¦éœ€æ±‚ï¼Œæ”¹å–„å¿…é¡»å¤§äº0.0001æ‰ç®—æ˜¾è‘—</span>
</code></pre>
<p><strong>ä½œç”¨ï¼š</strong></p>
<ul>
<li>è¿‡æ»¤æ‰è®­ç»ƒè¿‡ç¨‹ä¸­çš„å¾®å°æ³¢åŠ¨</li>
<li>ç¡®ä¿åªæœ‰çœŸæ­£çš„æ€§èƒ½æå‡æ‰ä¼šé‡ç½®è®¡æ•°å™¨</li>
<li>æé«˜æ—©åœå†³ç­–çš„ç¨³å®šæ€§</li>
</ul>
<h3 data-id="heading-5">3. restore_best_weightsï¼ˆæ¢å¤æœ€ä½³æƒé‡ï¼‰</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å»ºè®®å¼€å¯</span>
<span class="hljs-attr">restore_best_weights</span> = <span class="hljs-literal">True</span>
</code></pre>
<p><strong>ä½œç”¨ï¼š</strong></p>
<ul>
<li>ç¡®ä¿æœ€ç»ˆè·å¾—å†å²æœ€ä½³æ¨¡å‹</li>
<li>é¿å…ä½¿ç”¨æ€§èƒ½ä¸‹é™åçš„æ¨¡å‹</li>
<li>è¿™æ˜¯æ—©åœæœºåˆ¶ä»·å€¼çš„æ ¸å¿ƒä½“ç°</li>
</ul>
<h2 data-id="heading-6">å››ã€æ—©åœæœºåˆ¶çš„æµç¨‹</h2>
<h3 data-id="heading-7">1. æµç¨‹å›¾</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e54420607694e88a7dc28ec48ef59b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b285bK46Iqx5byA5LqG5ZCX:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767416653&amp;x-signature=lZ2Z6ELXvBgxcxmEyW2u9SCdY%2FY%3D" alt="" loading="lazy"/>â€‹</p>
<h3 data-id="heading-8">2. æµç¨‹è¯´æ˜</h3>
<p><strong>2.1 å¼€å§‹è®­ç»ƒ</strong></p>
<p>åˆå§‹åŒ–è®­ç»ƒè¿‡ç¨‹ï¼Œè®¾ç½®åˆå§‹å‚æ•°</p>
<ul>
<li>åˆå§‹åŒ–æ¨¡å‹æƒé‡</li>
<li>è®¾ç½®è®­ç»ƒè¶…å‚æ•°ï¼ˆå­¦ä¹ ç‡ã€æ‰¹æ¬¡å¤§å°ç­‰ï¼‰</li>
<li>å‡†å¤‡è®­ç»ƒé›†å’ŒéªŒè¯é›†</li>
<li>åˆå§‹åŒ–è€å¿ƒè®¡æ•°å™¨ä¸º0</li>
<li>è®¾ç½®æœ€ä½³æ€§èƒ½è®°å½•ä¸ºåˆå§‹å€¼</li>
</ul>
<p><strong>2.2 è®­ç»ƒä¸€ä¸ªepoch</strong></p>
<p>å®Œæˆä¸€ä¸ªå®Œæ•´çš„è®­ç»ƒè½®æ¬¡</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># å…·ä½“æ“ä½œ</span>
<span class="hljs-attr">for batch in training_data:</span>
    <span class="hljs-string">å‰å‘ä¼ æ’­</span> <span class="hljs-string">â†’</span> <span class="hljs-string">è®¡ç®—æŸå¤±</span> <span class="hljs-string">â†’</span> <span class="hljs-string">åå‘ä¼ æ’­</span> <span class="hljs-string">â†’</span> <span class="hljs-string">æ›´æ–°å‚æ•°</span>
</code></pre>
<ul>
<li>è¾“å…¥ï¼šè®­ç»ƒæ•°æ®æ‰¹æ¬¡</li>
<li>å¤„ç†ï¼šæ¨¡å‹å‚æ•°æ›´æ–°</li>
<li>è¾“å‡ºï¼šæ›´æ–°åçš„æ¨¡å‹æƒé‡</li>
</ul>
<p><strong>2.3 åœ¨éªŒè¯é›†ä¸Šè¯„ä¼°æ€§èƒ½</strong></p>
<p>ä½¿ç”¨éªŒè¯é›†æµ‹è¯•å½“å‰æ¨¡å‹æ€§èƒ½</p>
<ul>
<li>- éªŒè¯é›†ä¸å‚ä¸è®­ç»ƒ</li>
<li>- ä½¿ç”¨ç‹¬ç«‹çš„æ•°æ®è¯„ä¼°æ³›åŒ–èƒ½åŠ›</li>
<li>- ç›‘æ§æŒ‡æ ‡ï¼šval_loss æˆ– val_accuracy</li>
</ul>
<p>ç›®çš„ï¼šå®¢è§‚è¯„ä¼°æ¨¡å‹çœŸå®æ€§èƒ½</p>
<p>æŒ‡æ ‡é€‰æ‹©ï¼š</p>
<ul>
<li>å›å½’é—®é¢˜ï¼šéªŒè¯æŸå¤±ï¼ˆval_lossï¼‰</li>
<li>åˆ†ç±»é—®é¢˜ï¼šéªŒè¯å‡†ç¡®ç‡ï¼ˆval_accuracyï¼‰</li>
<li>è‡ªå®šä¹‰æŒ‡æ ‡ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©</li>
</ul>
<p><strong>2.4 æ€§èƒ½æ”¹å–„åˆ¤æ–­</strong></p>
<p>æ¯”è¾ƒå½“å‰æ€§èƒ½ä¸å†å²æœ€ä½³æ€§èƒ½</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># åˆ¤æ–­æ¡ä»¶</span>
<span class="hljs-string">if</span> <span class="hljs-string">current_performance</span> <span class="hljs-string">&lt;</span> <span class="hljs-attr">best_performance - min_delta:</span>
    <span class="hljs-comment"># æ˜¾è‘—æ”¹å–„</span>
<span class="hljs-attr">else:</span>
    <span class="hljs-comment"># æ— æ˜¾è‘—æ”¹å–„</span>
</code></pre>
<ul>
<li>min_deltaä½œç”¨ï¼šè®¾ç½®æ”¹å–„çš„æœ€å°é˜ˆå€¼</li>
<li>é¿å…è¯¯åˆ¤ï¼šé˜²æ­¢è®­ç»ƒæ³¢åŠ¨å¯¼è‡´çš„é”™è¯¯åˆ¤æ–­</li>
<li>æ•æ„Ÿæ€§æ§åˆ¶ï¼šè¾ƒå¤§çš„min_deltaè¦æ±‚æ›´æ˜æ˜¾çš„æ”¹å–„</li>
</ul>
<p><strong>2.5 æ€§èƒ½æ”¹å–„æ—¶çš„æ“ä½œ</strong></p>
<p>å½“æ£€æµ‹åˆ°æ˜¾è‘—æ”¹å–„æ—¶çš„å¤„ç†</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å…·ä½“æ“ä½œ</span>
<span class="hljs-attr">patience_counter</span> = <span class="hljs-number">0</span>  <span class="hljs-comment"># é‡ç½®è®¡æ•°å™¨</span>
<span class="hljs-attr">best_weights</span> = current_weights.copy()  <span class="hljs-comment"># ä¿å­˜æœ€ä½³æƒé‡</span>
<span class="hljs-attr">best_performance</span> = current_performance  <span class="hljs-comment"># æ›´æ–°æœ€ä½³è®°å½•</span>
</code></pre>
<ul>
<li>é‡ç½®è®¡æ•°å™¨ï¼šé‡æ–°å¼€å§‹è®¡ç®—æ— æ”¹å–„è½®æ¬¡</li>
<li>ä¿å­˜çŠ¶æ€ï¼šè®°å½•å½“å‰çš„æœ€ä½³æ¨¡å‹çŠ¶æ€</li>
<li>æ›´æ–°è®°å½•ï¼šå»ºç«‹æ–°çš„æ€§èƒ½åŸºå‡†</li>
</ul>
<p><strong>2.6 æ— æ”¹å–„æ—¶çš„æ“ä½œ</strong></p>
<p>å½“æ€§èƒ½æ²¡æœ‰æ˜¾è‘—æ”¹å–„æ—¶çš„å¤„ç†</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-comment"># å…·ä½“æ“ä½œ</span>
patience_counter += 1  <span class="hljs-comment"># å¢åŠ è®¡æ•°</span>
</code></pre>
<ul>
<li>ç´¯è®¡ç­‰å¾…ï¼šè®°å½•è¿ç»­æ— æ”¹å–„çš„è½®æ¬¡æ•°</li>
<li>ä¸ä¿å­˜æ¨¡å‹ï¼šä¿æŒä¹‹å‰çš„æœ€ä½³æƒé‡ä¸å˜</li>
<li>ç»§ç»­ç›‘æ§ï¼šç­‰å¾…å¯èƒ½çš„åç»­æ”¹å–„</li>
</ul>
<p><strong>2.7 åœæ­¢æ¡ä»¶æ£€æŸ¥</strong></p>
<p>æ£€æŸ¥æ˜¯å¦è¾¾åˆ°åœæ­¢è®­ç»ƒçš„é˜ˆå€¼</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># æ£€æŸ¥æ¡ä»¶</span>
<span class="hljs-string">if</span> <span class="hljs-string">patience_counter</span> <span class="hljs-string">&gt;=</span> <span class="hljs-attr">patience:</span>
    <span class="hljs-comment"># è§¦å‘æ—©åœ</span>
</code></pre>
<ul>
<li>patienceå‚æ•°ï¼šé¢„è®¾çš„å®¹å¿è½®æ¬¡æ•°</li>
<li>å¹³è¡¡è€ƒè™‘ï¼š
<ul>
<li>å¤ªå°ï¼šå¯èƒ½è¿‡æ—©åœæ­¢ï¼Œé”™è¿‡åç»­æ”¹å–„</li>
<li>å¤ªå¤§ï¼šæµªè´¹è®¡ç®—èµ„æºï¼Œå¢åŠ è¿‡æ‹Ÿåˆé£é™©</li>
</ul>
</li>
<li>å…¸å‹å€¼ï¼š10-20è½®</li>
</ul>
<p><strong>2.8 åœæ­¢è®­ç»ƒä¸æ¢å¤æƒé‡</strong></p>
<p>è¾¾åˆ°åœæ­¢æ¡ä»¶åçš„æ”¶å°¾å·¥ä½œ</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æœ€ç»ˆæ“ä½œ</span>
<span class="hljs-attr">training</span> = <span class="hljs-literal">False</span>  <span class="hljs-comment"># åœæ­¢è®­ç»ƒå¾ªç¯</span>
model.set_weights(best_weights)  <span class="hljs-comment"># æ¢å¤æœ€ä½³æƒé‡</span>
</code></pre>
<ul>
<li>ç»ˆæ­¢è®­ç»ƒï¼šè·³å‡ºè®­ç»ƒå¾ªç¯</li>
<li>æ¢å¤æœ€ä½³çŠ¶æ€ï¼šä½¿ç”¨å†å²æœ€ä½³æ¨¡å‹æƒé‡</li>
<li>ç¡®ä¿è´¨é‡ï¼šæœ€ç»ˆè·å¾—çš„æ˜¯æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹ä¸­æ€§èƒ½æœ€å¥½çš„æ¨¡å‹</li>
</ul>
<h3 data-id="heading-9">3. å‚æ•°ç¤ºä¾‹</h3>
<p>å‡è®¾è®¾ç½®ï¼š<code>patience=3ï¼ˆå®¹å¿3è½®æ— æ”¹å–„ï¼‰</code>, <code>min_delta=0.01ï¼ˆæœ€å°æ”¹å–„é˜ˆå€¼0.01ï¼‰</code></p>
<blockquote>
<h3 data-id="heading-10">`è½®æ¬¡ éªŒè¯æŸå¤± æ”¹å–„åˆ¤æ–­ è€å¿ƒè®¡æ•° æ“ä½œ</h3>
<p>1 0.85 - 0 åˆå§‹çŠ¶æ€<br/>
2 0.72 æ”¹å–„! 0 é‡ç½®è®¡æ•°ï¼Œä¿å­˜æ¨¡å‹<br/>
3 0.65 æ”¹å–„! 0 é‡ç½®è®¡æ•°ï¼Œä¿å­˜æ¨¡å‹<br/>
4 0.63 æ”¹å–„! 0 é‡ç½®è®¡æ•°ï¼Œä¿å­˜æ¨¡å‹<br/>
5 0.63 æ— æ”¹å–„ 1 è®¡æ•°+1<br/>
6 0.64 æ— æ”¹å–„ 2 è®¡æ•°+1<br/>
7 0.65 æ— æ”¹å–„ 3 è®¡æ•°+1 â†’ è§¦å‘åœæ­¢!<br/>
8 - - - åœæ­¢è®­ç»ƒï¼Œæ¢å¤ç¬¬4è½®æ¨¡å‹`</p>
</blockquote>
<h3 data-id="heading-11">4. ç›´è§‚ç†è§£</h3>
<pre><code class="hljs language-ini" lang="ini">import matplotlib.pyplot as plt
import numpy as np

plt.rcParams<span class="hljs-section">['font.sans-serif']</span> = <span class="hljs-section">['SimHei']</span>
plt.rcParams<span class="hljs-section">['axes.unicode_minus']</span> = False

<span class="hljs-comment"># æ¨¡æ‹Ÿè®­ç»ƒè¿‡ç¨‹</span>
<span class="hljs-attr">epochs</span> = range(<span class="hljs-number">1</span>, <span class="hljs-number">101</span>)
<span class="hljs-attr">train_loss</span> = [<span class="hljs-number">1.5</span> * <span class="hljs-number">0.95</span>**e for e in epochs]  <span class="hljs-comment"># è®­ç»ƒæŸå¤±æŒç»­ä¸‹é™</span>
<span class="hljs-attr">val_loss</span> = [<span class="hljs-number">1.6</span> * <span class="hljs-number">0.96</span>**e for e in epochs[:<span class="hljs-number">60</span>]] + [<span class="hljs-number">0.4</span> + <span class="hljs-number">0.001</span>*(e-<span class="hljs-number">60</span>) for e in epochs[<span class="hljs-number">60</span>:]]  <span class="hljs-comment"># éªŒè¯æŸå¤±å…ˆé™åå‡</span>

plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">10</span>, <span class="hljs-number">6</span>))
plt.plot(epochs, train_loss, 'b-', <span class="hljs-attr">linewidth</span>=<span class="hljs-number">2</span>, label=<span class="hljs-string">'è®­ç»ƒæŸå¤±'</span>)
plt.plot(epochs, val_loss, 'r-', <span class="hljs-attr">linewidth</span>=<span class="hljs-number">2</span>, label=<span class="hljs-string">'éªŒè¯æŸå¤±'</span>)

<span class="hljs-comment"># æ ‡è®°å…³é”®ç‚¹</span>
<span class="hljs-attr">best_epoch</span> = <span class="hljs-number">60</span>
plt.axvline(<span class="hljs-attr">x</span>=best_epoch, color=<span class="hljs-string">'green'</span>, linestyle=<span class="hljs-string">'--'</span>, linewidth=<span class="hljs-number">2</span>, label=<span class="hljs-string">'æœ€ä½³åœæ­¢ç‚¹'</span>)
plt.axvline(<span class="hljs-attr">x</span>=<span class="hljs-number">80</span>, color=<span class="hljs-string">'orange'</span>, linestyle=<span class="hljs-string">'--'</span>, linewidth=<span class="hljs-number">2</span>, label=<span class="hljs-string">'æ—©åœç‚¹'</span>)

plt.xlabel('è®­ç»ƒè½®æ¬¡')
plt.ylabel('æŸå¤±å€¼')
plt.title('æ—©åœæœºåˆ¶å·¥ä½œåŸç†\n(éªŒè¯æŸå¤±å¼€å§‹ä¸Šå‡æ—¶åœæ­¢)')
plt.legend()
plt.grid(True, <span class="hljs-attr">alpha</span>=<span class="hljs-number">0.3</span>)
plt.show()
</code></pre>
<p>è¾“å‡ºå›¾ä¾‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/569f7d0a2d644de6be3ca1d1b5eed5c1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b285bK46Iqx5byA5LqG5ZCX:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767416653&amp;x-signature=0k5CkvbPkIJKjBz%2BuHAKfg2cNwo%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-12">4.1 æ›²çº¿ç‰¹å¾åˆ†æ</h4>
<p>è®­ç»ƒæŸå¤±æ›²çº¿ï¼ˆè“è‰²ï¼‰</p>
<ul>
<li>å½¢æ€ç‰¹å¾ï¼šæŒç»­å•è°ƒä¸‹é™çš„æŒ‡æ•°è¡°å‡æ›²çº¿</li>
<li>æ•°å­¦è¡¨è¾¾ï¼š1.5 Ã— 0.95^epoch</li>
<li>ç‰©ç†æ„ä¹‰ï¼šæ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šçš„æ‹Ÿåˆèƒ½åŠ›æŒç»­æå‡</li>
<li>å…³é”®è§‚å¯Ÿï¼šå³ä½¿åœ¨ç¬¬60è½®åä»åœ¨ä¸‹é™ï¼Œè¯´æ˜æ¨¡å‹å¤æ‚åº¦è¶³ä»¥ç»§ç»­è®°å¿†è®­ç»ƒæ•°æ®</li>
</ul>
<p>éªŒè¯æŸå¤±æ›²çº¿ï¼ˆçº¢è‰²ï¼‰</p>
<ul>
<li>å½¢æ€ç‰¹å¾ï¼šå…¸å‹çš„Uå‹æ›²çº¿</li>
<li>ç¬¬ä¸€é˜¶æ®µï¼ˆ1-60è½®ï¼‰ï¼šæŒ‡æ•°è¡°å‡ 1.6 Ã— 0.96^epoch</li>
<li>ç¬¬äºŒé˜¶æ®µï¼ˆ60-100è½®ï¼‰ï¼šçº¿æ€§ä¸Šå‡ 0.4 + 0.001Ã—(epoch-60)</li>
<li>è½¬æŠ˜ç‚¹ï¼šç¬¬60è½®æ˜¯æ›²çº¿çš„æå°å€¼ç‚¹</li>
</ul>
<h5 data-id="heading-13">4.1.1 å…³äº1.5 Ã— 0.95^epochçš„ç†è§£</h5>
<p>è¿™ä¸ªè¡¨è¾¾å¼æ˜¯ä¸€ä¸ªæŒ‡æ•°è¡°å‡å‡½æ•°ï¼Œå„ç»„æˆéƒ¨åˆ†è§£æï¼š</p>
<p><strong>4.1.1.1 ç³»æ•° 1.5</strong></p>
<ul>
<li>åˆå§‹æŸå¤±å€¼ = 1.5</li>
<li>ç‰©ç†æ„ä¹‰ï¼š
<ul>
<li>æ¨¡å‹åœ¨è®­ç»ƒå¼€å§‹æ—¶çš„åˆå§‹æŸå¤±å€¼</li>
<li>åæ˜ æ¨¡å‹åœ¨æœªå­¦ä¹ ä»»ä½•æ¨¡å¼å‰çš„é¢„æµ‹è¯¯å·®</li>
</ul>
</li>
<li>æ•°å€¼å¤§å°å–å†³äºï¼š
<ul>
<li>é—®é¢˜å¤æ‚åº¦</li>
<li>æ¨¡å‹åˆå§‹åŒ–çŠ¶æ€</li>
<li>æŸå¤±å‡½æ•°ç±»å‹ï¼ˆMSEã€äº¤å‰ç†µç­‰ï¼‰</li>
</ul>
</li>
<li>å®é™…å¯¹åº”ï¼š
<ul>
<li>å¯¹äºå›å½’é—®é¢˜ï¼Œå¯èƒ½æ˜¯å‡æ–¹è¯¯å·®çš„åˆå§‹å€¼</li>
<li>å¯¹äºåˆ†ç±»é—®é¢˜ï¼Œå¯èƒ½æ˜¯äº¤å‰ç†µæŸå¤±çš„åˆå§‹å€¼</li>
</ul>
</li>
</ul>
<p><strong>4.1.1.2 åº•æ•° 0.95</strong></p>
<ul>
<li>è¡°å‡å› å­ = 0.95</li>
<li>æ•°å­¦æ„ä¹‰ï¼š
<ul>
<li>æ¯ä¸ªè®­ç»ƒè½®æ¬¡æŸå¤±å‡å°‘åˆ°å‰ä¸€è½®çš„95%</li>
<li>è¡°å‡ç‡ = 1 - 0.95 = 0.05 = 5%</li>
</ul>
</li>
<li>ç‰©ç†æ„ä¹‰ï¼š
<ul>
<li>å­¦ä¹ æ•ˆç‡ï¼šæ¯ä¸ªepochæŸå¤±å‡å°‘5%</li>
<li>æ”¶æ•›é€Ÿåº¦ï¼šæ•°å€¼è¶Šå°æ”¶æ•›è¶Šå¿«ï¼Œè¶Šå¤§æ”¶æ•›è¶Šæ…¢</li>
<li>æ¨¡å‹ç‰¹æ€§ï¼šåæ˜ æ¨¡å‹çš„å­¦ä¹ èƒ½åŠ›å’Œä¼˜åŒ–å™¨æ•ˆæœ</li>
</ul>
</li>
</ul>
<p><strong>4.1.1.3 æŒ‡æ•° epoch</strong></p>
<ul>
<li>è‡ªå˜é‡ = epochï¼ˆè®­ç»ƒè½®æ¬¡ï¼‰</li>
<li>ä½œç”¨ï¼š
<ul>
<li>é©±åŠ¨æŸå¤±éšæ—¶é—´ï¼ˆè®­ç»ƒè½®æ¬¡ï¼‰å˜åŒ–</li>
<li>æŒ‡æ•°å½¢å¼ä½“ç°"è¡°å‡åŠ é€Ÿ"æ•ˆåº”</li>
</ul>
</li>
</ul>
<p><strong>4.1.1.4 è¡°å‡é€Ÿç‡</strong></p>
<ul>
<li>è®¡ç®—ç‰¹å®šè½®æ¬¡çš„æŸå¤±å€¼</li>
<li>epoch=0: 1.5 Ã— 0.95^0 = 1.5</li>
<li>epoch=10: 1.5 Ã— 0.95^10 â‰ˆ 0.90</li>
<li>epoch=20: 1.5 Ã— 0.95^20 â‰ˆ 0.54</li>
<li>epoch=50: 1.5 Ã— 0.95^50 â‰ˆ 0.12</li>
</ul>
<p><strong>4.1.1.5 å‚æ•°é€‰æ‹©çš„ä¾æ®</strong></p>
<ul>
<li>åˆå§‹æŸå¤± 1.5ï¼š
<ul>
<li>åŸºäºæ¨¡å‹éšæœºåˆå§‹åŒ–çš„å…¸å‹è¡¨ç°</li>
<li>å¯¹äºå‡æ–¹è¯¯å·®ï¼Œ1.5è¡¨ç¤ºå¹³å‡é¢„æµ‹è¯¯å·®çº¦1.22ï¼ˆâˆš1.5ï¼‰</li>
<li>åœ¨æ ‡å‡†åŒ–æ•°æ®ä¸­è¿™æ˜¯åˆç†çš„åˆå§‹è¯¯å·®</li>
</ul>
</li>
<li>è¡°å‡å› å­ 0.95ï¼š
<ul>
<li>å¯¹åº”æ¯ä¸ªepochçº¦5%çš„æ”¹è¿›</li>
<li>åœ¨æ·±åº¦å­¦ä¹ ä¸­æ˜¯å…¸å‹çš„å­¦ä¹ é€Ÿåº¦</li>
<li>æ—¢ä¸ä¼šå¤ªå¿«ï¼ˆé¿å…éœ‡è¡ï¼‰ä¹Ÿä¸ä¼šå¤ªæ…¢ï¼ˆé¿å…è®­ç»ƒè¿‡ä¹…ï¼‰</li>
</ul>
</li>
</ul>
<h4 data-id="heading-14">4.2 å…³é”®ç‚¹æ ‡è®°åˆ†æ</h4>
<p>æœ€ä½³åœæ­¢ç‚¹ï¼ˆç»¿è‰²è™šçº¿ - ç¬¬60è½®ï¼‰</p>
<ul>
<li>ä½ç½®ï¼šéªŒè¯æŸå¤±çš„æœ€ä½ç‚¹ï¼ˆval_loss â‰ˆ 0.4ï¼‰</li>
<li>ç†è®ºæ„ä¹‰ï¼šæ¨¡å‹æ³›åŒ–èƒ½åŠ›è¾¾åˆ°å³°å€¼</li>
<li>å®è·µæŒ‘æˆ˜ï¼šåœ¨çœŸå®è®­ç»ƒä¸­æ— æ³•é¢„å…ˆçŸ¥é“æ­¤ç‚¹</li>
</ul>
<p>æ—©åœç‚¹ï¼ˆæ©™è‰²è™šçº¿ - ç¬¬80è½®ï¼‰</p>
<ul>
<li>ä½ç½®ï¼šéªŒè¯æŸå¤±ä»æœ€ä½ç‚¹ä¸Šå‡20è½®åçš„ä½ç½®</li>
<li>å®é™…æ„ä¹‰ï¼šé€šè¿‡patience=20çš„æ—©åœæœºåˆ¶ç¡®å®šçš„åœæ­¢ç‚¹</li>
<li>æ€§èƒ½ä»£ä»·ï¼šval_loss â‰ˆ 0.42ï¼Œæ¯”æœ€ä½³ç‚¹é«˜5%</li>
</ul>
<h4 data-id="heading-15">4.3 è¿‡æ‹Ÿåˆç°è±¡çš„ç›´è§‚å±•ç¤º</h4>
<p>è®­ç»ƒæŸå¤± vs éªŒè¯æŸå¤±çš„èƒŒç¦»</p>
<ul>
<li>ç¬¬60è½®ä¹‹å‰ï¼šè®­ç»ƒæŸå¤± â†“, éªŒè¯æŸå¤± â†“ â†’ æ¨¡å‹å­¦ä¹ æœ‰æ•ˆæ¨¡å¼</li>
<li>ç¬¬60è½®ä¹‹åï¼šè®­ç»ƒæŸå¤± â†“, éªŒè¯æŸå¤± â†‘ â†’ æ¨¡å‹å¼€å§‹è¿‡æ‹Ÿåˆ</li>
</ul>
<p>èƒŒç¦»çš„æ ¹æœ¬åŸå› </p>
<ul>
<li>è®­ç»ƒæŸå¤±ä¸‹é™ï¼šæ¨¡å‹ç»§ç»­ä¼˜åŒ–åœ¨è®­ç»ƒé›†ä¸Šçš„è¡¨ç°</li>
<li>éªŒè¯æŸå¤±ä¸Šå‡ï¼šæ¨¡å‹å¼€å§‹è®°å¿†è®­ç»ƒæ•°æ®çš„å™ªå£°å’Œç‰¹å®šæ¨¡å¼</li>
<li>ç»“æœï¼šæ³›åŒ–èƒ½åŠ›ä¸‹é™ï¼Œæ¨¡å‹å˜å¾—"å¤ªä¸“é—¨åŒ–"</li>
</ul>
<p>ç†è§£è¿‡æ‹Ÿåˆæœ¬è´¨</p>
<ul>
<li>ç›´è§‚å±•ç¤ºæ¨¡å‹å­¦è¿‡å¤´çš„å…·ä½“è¡¨ç°</li>
<li>æ¸…æ™°åŒºåˆ†è®­ç»ƒæ€§èƒ½å’Œæ³›åŒ–æ€§èƒ½</li>
</ul>
<h4 data-id="heading-16">4.4 æ—©åœæœºåˆ¶å†³ç­–é€»è¾‘</h4>
<p>patienceå‚æ•°çš„ä½œç”¨</p>
<ul>
<li>å®¹å¿çª—å£ï¼šç¬¬60-80è½®ï¼ˆ20ä¸ªepochï¼‰</li>
<li>å†³ç­–ä¾æ®ï¼šè¿ç»­20è½®éªŒè¯æŸå¤±æ— æ˜¾è‘—æ”¹å–„</li>
<li>å¹³è¡¡è€ƒé‡ï¼šåœ¨é¿å…è¿‡æ—©åœæ­¢å’Œé˜²æ­¢ä¸¥é‡è¿‡æ‹Ÿåˆä¹‹é—´æƒè¡¡</li>
</ul>
<p>min_deltaçš„éšå«ä½œç”¨</p>
<ul>
<li>è™½ç„¶å›¾ä¸­æœªæ˜ç¡®æ˜¾ç¤ºï¼Œä½†å®é™…æ—©åœæœºåˆ¶ä¸­</li>
<li>åªæœ‰è¶…è¿‡min_deltaçš„æ”¹å–„æ‰ä¼šé‡ç½®patienceè®¡æ•°å™¨</li>
<li>é˜²æ­¢è®­ç»ƒè¿‡ç¨‹ä¸­çš„å¾®å°æ³¢åŠ¨è§¦å‘æ—©åœ</li>
</ul>
<h4 data-id="heading-17">4.5 åå·®-æ–¹å·®æƒè¡¡çš„å¯è§†åŒ–</h4>
<p>ç¬¬60è½®ä¹‹å‰</p>
<ul>
<li>é«˜åå·® â†’ ä½åå·®ï¼šæ¨¡å‹å­¦ä¹ æ•°æ®çœŸå®æ¨¡å¼</li>
<li>é«˜æ–¹å·® â†’ é€‚å½“æ–¹å·®ï¼šæ¨¡å‹å¤æ‚åº¦é€‚ä¸­</li>
</ul>
<p>ç¬¬60è½®ä¹‹å</p>
<ul>
<li>åå·®åŸºæœ¬ç¨³å®šï¼šæ¨¡å‹å·²å­¦ä¹ ä¸»è¦æ¨¡å¼</li>
<li>æ–¹å·®æŒç»­å¢åŠ ï¼šå¯¹è®­ç»ƒæ•°æ®è¿‡åº¦æ•æ„Ÿ</li>
</ul>
<h2 data-id="heading-18">äº”ã€ç¤ºä¾‹å‰–æ</h2>
<h3 data-id="heading-19">1. ç¤ºä¾‹ä»£ç </h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> tensorflow.keras.models <span class="hljs-keyword">import</span> Sequential
<span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Dense
<span class="hljs-keyword">from</span> tensorflow.keras.callbacks <span class="hljs-keyword">import</span> EarlyStopping

<span class="hljs-comment"># è®¾ç½®ä¸­æ–‡å­—ä½“</span>
plt.rcParams[<span class="hljs-string">'font.sans-serif'</span>] = [<span class="hljs-string">'SimHei'</span>]
plt.rcParams[<span class="hljs-string">'axes.unicode_minus'</span>] = <span class="hljs-literal">False</span>

<span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">50</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ—©åœæœºåˆ¶æœ€ç®€å•ç¤ºä¾‹"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">50</span>)

<span class="hljs-comment"># 1. ç”Ÿæˆç®€å•çš„æ•°æ®</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"1. ç”Ÿæˆæ•°æ®..."</span>)
np.random.seed(<span class="hljs-number">42</span>)
X = np.linspace(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">200</span>).reshape(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)
y = <span class="hljs-number">2</span> * np.sin(X.ravel()) + <span class="hljs-number">0.5</span> * X.ravel() + np.random.normal(<span class="hljs-number">0</span>, <span class="hljs-number">0.3</span>, <span class="hljs-number">200</span>)

<span class="hljs-comment"># 2. åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"2. åˆ’åˆ†æ•°æ®..."</span>)
X_train, X_val, y_train, y_val = train_test_split(X, y, test_size=<span class="hljs-number">0.2</span>, random_state=<span class="hljs-number">42</span>)

<span class="hljs-comment"># 3. åˆ›å»ºç®€å•çš„ç¥ç»ç½‘ç»œ</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"3. åˆ›å»ºæ¨¡å‹..."</span>)
model = Sequential([
    Dense(<span class="hljs-number">50</span>, activation=<span class="hljs-string">'relu'</span>, input_shape=(<span class="hljs-number">1</span>,)),
    Dense(<span class="hljs-number">20</span>, activation=<span class="hljs-string">'relu'</span>),
    Dense(<span class="hljs-number">1</span>)
])
model.<span class="hljs-built_in">compile</span>(optimizer=<span class="hljs-string">'adam'</span>, loss=<span class="hljs-string">'mse'</span>)

<span class="hljs-comment"># 4. å®šä¹‰æ—©åœæœºåˆ¶</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"4. è®¾ç½®æ—©åœ..."</span>)
early_stopping = EarlyStopping(
    monitor=<span class="hljs-string">'val_loss'</span>,    <span class="hljs-comment"># ç›‘æ§éªŒè¯é›†æŸå¤±</span>
    patience=<span class="hljs-number">10</span>,           <span class="hljs-comment"># å®¹å¿10è½®æ— æ”¹å–„</span>
    restore_best_weights=<span class="hljs-literal">True</span>,  <span class="hljs-comment"># æ¢å¤æœ€ä½³æƒé‡</span>
    verbose=<span class="hljs-number">1</span>
)

<span class="hljs-comment"># 5. è®­ç»ƒæ¨¡å‹ï¼ˆä½¿ç”¨æ—©åœï¼‰</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"5. å¼€å§‹è®­ç»ƒï¼ˆä½¿ç”¨æ—©åœï¼‰..."</span>)
history = model.fit(
    X_train, y_train,
    validation_data=(X_val, y_val),
    epochs=<span class="hljs-number">200</span>,           <span class="hljs-comment"># è®¾ç½®è¾ƒå¤§çš„è®­ç»ƒè½®æ¬¡</span>
    batch_size=<span class="hljs-number">16</span>,
    callbacks=[early_stopping],
    verbose=<span class="hljs-number">0</span>
)

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"è®­ç»ƒåœ¨ <span class="hljs-subst">{<span class="hljs-built_in">len</span>(history.history[<span class="hljs-string">'loss'</span>])}</span> è½®åœæ­¢"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æœ€ä½³éªŒè¯æŸå¤±: <span class="hljs-subst">{<span class="hljs-built_in">min</span>(history.history[<span class="hljs-string">'val_loss'</span>]):<span class="hljs-number">.4</span>f}</span>"</span>)

<span class="hljs-comment"># 6. å¯è§†åŒ–ç»“æœ</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"6. ç”Ÿæˆå¯è§†åŒ–å›¾è¡¨..."</span>)

<span class="hljs-comment"># åˆ›å»ºä¸¤ä¸ªå­å›¾</span>
fig, (ax1, ax2) = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">15</span>, <span class="hljs-number">5</span>))

<span class="hljs-comment"># å›¾1ï¼šè®­ç»ƒè¿‡ç¨‹</span>
ax1.plot(history.history[<span class="hljs-string">'loss'</span>], <span class="hljs-string">'b-'</span>, label=<span class="hljs-string">'è®­ç»ƒæŸå¤±'</span>, linewidth=<span class="hljs-number">2</span>)
ax1.plot(history.history[<span class="hljs-string">'val_loss'</span>], <span class="hljs-string">'r-'</span>, label=<span class="hljs-string">'éªŒè¯æŸå¤±'</span>, linewidth=<span class="hljs-number">2</span>)

<span class="hljs-comment"># æ‰¾åˆ°æœ€ä½³è½®æ¬¡</span>
best_epoch = np.argmin(history.history[<span class="hljs-string">'val_loss'</span>])
best_val_loss = history.history[<span class="hljs-string">'val_loss'</span>][best_epoch]

<span class="hljs-comment"># æ ‡è®°æœ€ä½³ç‚¹å’Œåœæ­¢ç‚¹</span>
ax1.axvline(x=best_epoch, color=<span class="hljs-string">'green'</span>, linestyle=<span class="hljs-string">'--'</span>, 
           label=<span class="hljs-string">f'æœ€ä½³ç‚¹ (ç¬¬<span class="hljs-subst">{best_epoch}</span>è½®)'</span>, linewidth=<span class="hljs-number">2</span>)
ax1.axvline(x=<span class="hljs-built_in">len</span>(history.history[<span class="hljs-string">'loss'</span>])-<span class="hljs-number">1</span>, color=<span class="hljs-string">'orange'</span>, linestyle=<span class="hljs-string">'--'</span>,
           label=<span class="hljs-string">f'åœæ­¢ç‚¹ (ç¬¬<span class="hljs-subst">{<span class="hljs-built_in">len</span>(history.history[<span class="hljs-string">"loss"</span>])-<span class="hljs-number">1</span>}</span>è½®)'</span>, linewidth=<span class="hljs-number">2</span>)

ax1.set_xlabel(<span class="hljs-string">'è®­ç»ƒè½®æ¬¡'</span>)
ax1.set_ylabel(<span class="hljs-string">'æŸå¤±å€¼'</span>)
ax1.set_title(<span class="hljs-string">'æ—©åœæœºåˆ¶å·¥ä½œåŸç†\n(éªŒè¯æŸå¤±ä¸å†æ”¹å–„æ—¶åœæ­¢)'</span>, fontsize=<span class="hljs-number">14</span>, fontweight=<span class="hljs-string">'bold'</span>)
ax1.legend()
ax1.grid(<span class="hljs-literal">True</span>, alpha=<span class="hljs-number">0.3</span>)

<span class="hljs-comment"># å›¾2ï¼šé¢„æµ‹ç»“æœ</span>
X_plot = np.linspace(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">100</span>).reshape(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)
y_pred = model.predict(X_plot)

ax2.scatter(X_train, y_train, alpha=<span class="hljs-number">0.5</span>, color=<span class="hljs-string">'blue'</span>, label=<span class="hljs-string">'è®­ç»ƒæ•°æ®'</span>, s=<span class="hljs-number">20</span>)
ax2.scatter(X_val, y_val, alpha=<span class="hljs-number">0.5</span>, color=<span class="hljs-string">'red'</span>, label=<span class="hljs-string">'éªŒè¯æ•°æ®'</span>, s=<span class="hljs-number">20</span>)
ax2.plot(X_plot, <span class="hljs-number">2</span> * np.sin(X_plot.ravel()) + <span class="hljs-number">0.5</span> * X_plot.ravel(), 
        <span class="hljs-string">'g-'</span>, linewidth=<span class="hljs-number">3</span>, label=<span class="hljs-string">'çœŸå®å…³ç³»'</span>)
ax2.plot(X_plot, y_pred, <span class="hljs-string">'k-'</span>, linewidth=<span class="hljs-number">2</span>, label=<span class="hljs-string">'æ¨¡å‹é¢„æµ‹'</span>)

ax2.set_xlabel(<span class="hljs-string">'ç‰¹å¾ X'</span>)
ax2.set_ylabel(<span class="hljs-string">'ç›®æ ‡å€¼ y'</span>)
ax2.set_title(<span class="hljs-string">'æ¨¡å‹é¢„æµ‹ç»“æœ\n(é¿å…äº†è¿‡æ‹Ÿåˆ)'</span>, fontsize=<span class="hljs-number">14</span>, fontweight=<span class="hljs-string">'bold'</span>)
ax2.legend()
ax2.grid(<span class="hljs-literal">True</span>, alpha=<span class="hljs-number">0.3</span>)

plt.tight_layout()
plt.show()
</code></pre>
<h3 data-id="heading-20">2. è¾“å‡ºç»“æœ</h3>
<blockquote>
<p>==================================================<br/>
æ—©åœæœºåˆ¶æœ€ç®€å•ç¤ºä¾‹<br/>
==================================================<br/>
1. ç”Ÿæˆæ•°æ®...<br/>
2. åˆ’åˆ†æ•°æ®...<br/>
3. åˆ›å»ºæ¨¡å‹...<br/>
To enable the following instructions: SSE SSE2 SSE3 SSE4.1 SSE4.2 AVX AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.<br/>
4. è®¾ç½®æ—©åœ...<br/>
5. å¼€å§‹è®­ç»ƒï¼ˆä½¿ç”¨æ—©åœï¼‰...<br/>
Restoring model weights from the end of the best epoch: 5.<br/>
Epoch 15: early stopping<br/>
è®­ç»ƒåœ¨ 15 è½®åœæ­¢<br/>
æœ€ä½³éªŒè¯æŸå¤±: 1.5427<br/>
6. ç”Ÿæˆå¯è§†åŒ–å›¾è¡¨...</p>
<p>å‚æ•°è¯´æ˜ï¼š<br/>
- patience=10ï¼šè¿ç»­10æ¬¡æ£€æµ‹æ²¡æœ‰è¿›æ­¥å°±åœæ­¢<br/>
- val_lossï¼šç”¨éªŒè¯é›†æ¥æ£€æµ‹å­¦ä¹ æ•ˆæœ<br/>
- restore_best_weightsï¼šæ¢å¤åˆ°å†å²ä¸Šæœ€å¥½çš„çŠ¶æ€</p>
<p>ä»å›¾è¡¨å¯ä»¥çœ‹åˆ°ï¼š<br/>
- å·¦å›¾ï¼šéªŒè¯æŸå¤±ä¸å†ä¸‹é™æ—¶å°±åœæ­¢è®­ç»ƒ<br/>
- å³å›¾ï¼šæ¨¡å‹å­¦åˆ°äº†çœŸå®è§„å¾‹ï¼Œæ²¡æœ‰è¿‡åº¦æ‹Ÿåˆå™ªå£°</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a0b75d50d32b40cebd28662317bdfd7f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b285bK46Iqx5byA5LqG5ZCX:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767416653&amp;x-signature=ukAH%2F1S0js7U6Am0gwdvyoIqwK4%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-21">3. ç»“æœåˆ†æ</h3>
<h4 data-id="heading-22">3.1 å›¾è¡¨å†…å®¹è¯¦è§£</h4>
<p>å·¦å›¾ï¼šç¥ç»ç½‘ç»œè®­ç»ƒè¿‡ç¨‹ç›‘æ§</p>
<p>æ›²çº¿ç‰¹å¾åˆ†æï¼š</p>
<ul>
<li>è“è‰²è®­ç»ƒæŸå¤±æ›²çº¿ï¼šå¹³æ»‘çš„æŒ‡æ•°è¡°å‡ï¼Œæ˜¾ç¤ºç¥ç»ç½‘ç»œåœ¨è®­ç»ƒé›†ä¸Šçš„ç¨³å®šå­¦ä¹ </li>
<li>çº¢è‰²éªŒè¯æŸå¤±æ›²çº¿ï¼šå½“éªŒè¯æŸå¤±ä¸å†æ”¹å–„ï¼ˆç”šè‡³å¼€å§‹ä¸Šå‡ï¼‰æ—¶ï¼Œæ—©åœæœºåˆ¶ä¼šåœæ­¢è®­ç»ƒï¼Œé˜²æ­¢äº†è¿‡æ‹Ÿåˆç°è±¡</li>
<li>ç»¿è‰²æœ€ä½³ç‚¹è™šçº¿ï¼šéªŒè¯æŸå¤±çš„æœ€ä½ç‚¹ï¼Œç†è®ºä¸Šçš„æœ€ä¼˜åœæ­¢æ—¶æœº</li>
<li>æ©™è‰²åœæ­¢ç‚¹è™šçº¿ï¼šæ—©åœæœºåˆ¶å®é™…è§¦å‘çš„åœæ­¢ç‚¹</li>
</ul>
<p>å…³é”®åŠ¨æ€è§‚å¯Ÿï¼š</p>
<ul>
<li>è®­ç»ƒå‰æœŸï¼ˆ0-20è½®ï¼‰ï¼šè®­ç»ƒå’ŒéªŒè¯æŸå¤±åŒæ­¥å¿«é€Ÿä¸‹é™</li>
<li>è®­ç»ƒä¸­æœŸï¼ˆ20-40è½®ï¼‰ï¼šéªŒè¯æŸå¤±ä¸‹é™è¶‹ç¼“ï¼Œè®­ç»ƒæŸå¤±ç»§ç»­ä¸‹é™</li>
<li>è®­ç»ƒåæœŸï¼ˆ40è½®åï¼‰ï¼šéªŒè¯æŸå¤±å¼€å§‹åå¼¹ï¼Œè®­ç»ƒæŸå¤±ä»ç¼“æ…¢ä¸‹é™</li>
<li>æ—©åœè§¦å‘ï¼šåœ¨éªŒè¯æŸå¤±æ˜æ˜¾ä¸Šå‡ååœæ­¢</li>
</ul>
<p>å³å›¾ï¼šç¥ç»ç½‘ç»œé¢„æµ‹ç»“æœ</p>
<p>æ•°æ®ä¸æ¨¡å‹å¯¹æ¯”ï¼š</p>
<ul>
<li>è“è‰²è®­ç»ƒç‚¹ï¼š200ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œç”¨äºå‚æ•°æ›´æ–°</li>
<li>çº¢è‰²éªŒè¯ç‚¹ï¼š40ä¸ªéªŒè¯æ ·æœ¬ï¼Œç”¨äºæ—©åœå†³ç­–</li>
<li>ç»¿è‰²çœŸå®æ›²çº¿ï¼šy = 2*sin(x) + 0.5*x æ•°æ®ç”Ÿæˆå‡½æ•°</li>
<li>é»‘è‰²é¢„æµ‹æ›²çº¿ï¼šç¥ç»ç½‘ç»œå­¦ä¹ åˆ°çš„å¤æ‚å‡½æ•°</li>
</ul>
<p>æ‹Ÿåˆè´¨é‡è¯„ä¼°ï¼š</p>
<ul>
<li>ç¥ç»ç½‘ç»œæˆåŠŸæ•æ‰äº†æ­£å¼¦æ³¢åŠ¨å’Œçº¿æ€§è¶‹åŠ¿</li>
<li>é¢„æµ‹æ›²çº¿å¹³æ»‘ï¼Œé¿å…äº†è¿‡åº¦éœ‡è¡</li>
<li>åœ¨æ•°æ®ç¨€ç–åŒºåŸŸæœ‰è‰¯å¥½çš„æ³›åŒ–è¡¨ç°</li>
<li>ä¸çœŸå®å‡½æ•°é«˜åº¦å»åˆ</li>
</ul>
<h4 data-id="heading-23">3.2 è¿è¡ŒåŸç†è§£æ</h4>
<p><strong>3.2.1 ç¥ç»ç½‘ç»œæ¶æ„è®¾è®¡</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">model</span> = Sequential([
    Dense(<span class="hljs-number">50</span>, activation=<span class="hljs-string">'relu'</span>, input_shape=(<span class="hljs-number">1</span>,)),  <span class="hljs-comment"># éšè—å±‚1</span>
    Dense(<span class="hljs-number">20</span>, activation=<span class="hljs-string">'relu'</span>),                    <span class="hljs-comment"># éšè—å±‚2  </span>
    Dense(<span class="hljs-number">1</span>)                                         <span class="hljs-comment"># è¾“å‡ºå±‚</span>
])
</code></pre>
<p><strong>æ¶æ„åˆ†æï¼š</strong></p>
<ul>
<li>è¾“å…¥å±‚ï¼š1ä¸ªç‰¹å¾ï¼ˆXå€¼ï¼‰</li>
<li>éšè—å±‚1ï¼š50ä¸ªç¥ç»å…ƒï¼Œæä¾›è¶³å¤Ÿçš„è¡¨è¾¾èƒ½åŠ›</li>
<li>éšè—å±‚2ï¼š20ä¸ªç¥ç»å…ƒï¼Œè¿›è¡Œç‰¹å¾å‹ç¼©å’ŒæŠ½è±¡</li>
<li>è¾“å‡ºå±‚ï¼š1ä¸ªç¥ç»å…ƒï¼Œå›å½’é¢„æµ‹</li>
</ul>
<p><strong>å®¹é‡æ§åˆ¶ï¼š</strong></p>
<ul>
<li>æ€»å‚æ•°ï¼š(1Ã—50 + 50) + (50Ã—20 + 20) + (20Ã—1 + 1) = 1471ä¸ªå‚æ•°</li>
<li>ç›¸å¯¹äº200ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œæ¨¡å‹å®¹é‡é€‚ä¸­åå¤§</li>
<li>ä¸ºè¿‡æ‹Ÿåˆåˆ›é€ äº†æ¡ä»¶ï¼Œä¾¿äºæ¼”ç¤ºæ—©åœä»·å€¼</li>
</ul>
<p><strong>3.2.2 Kerasæ—©åœæœºåˆ¶é…ç½®</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">early_stopping</span> = EarlyStopping(
    <span class="hljs-attr">monitor</span>=<span class="hljs-string">'val_loss'</span>,       <span class="hljs-comment"># æ ¸å¿ƒç›‘æ§æŒ‡æ ‡</span>
    <span class="hljs-attr">patience</span>=<span class="hljs-number">10</span>,              <span class="hljs-comment"># å®¹å¿è½®æ¬¡</span>
    <span class="hljs-attr">restore_best_weights</span>=<span class="hljs-literal">True</span>, <span class="hljs-comment"># å…³é”®æ¢å¤æœºåˆ¶</span>
    <span class="hljs-attr">verbose</span>=<span class="hljs-number">1</span>                 <span class="hljs-comment"># è¿›åº¦æ˜¾ç¤º</span>
)
</code></pre>
<p><strong>å‚æ•°ä¼˜åŒ–ï¼š</strong></p>
<ul>
<li>patience=10ï¼šåœ¨å¤æ‚ç¥ç»ç½‘ç»œä¸­æä¾›è¶³å¤Ÿçš„è§‚å¯Ÿçª—å£</li>
<li>restore_best_weights=Trueï¼šç¡®ä¿è·å¾—å†å²æœ€ä½³æ¨¡å‹</li>
<li>verbose=1ï¼šæä¾›è®­ç»ƒè¿‡ç¨‹çš„å¯è§†åŒ–åé¦ˆ</li>
</ul>
<p><strong>3.2.3 è®­ç»ƒç­–ç•¥è®¾è®¡</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">history</span> = model.fit(
    X_train, y_train,
    <span class="hljs-attr">validation_data</span>=(X_val, y_val),  <span class="hljs-comment"># å…³é”®éªŒè¯é›†</span>
    <span class="hljs-attr">epochs</span>=<span class="hljs-number">200</span>,                      <span class="hljs-comment"># å……è¶³çš„ä¸Šé™</span>
    <span class="hljs-attr">batch_size</span>=<span class="hljs-number">16</span>,                   <span class="hljs-comment"># é€‚ä¸­çš„æ‰¹æ¬¡å¤§å°</span>
    <span class="hljs-attr">callbacks</span>=[early_stopping],      <span class="hljs-comment"># æ—©åœå›è°ƒ</span>
    <span class="hljs-attr">verbose</span>=<span class="hljs-number">0</span>                        <span class="hljs-comment"># ç®€åŒ–è¾“å‡º</span>
)
</code></pre>
<p><strong>è®­ç»ƒé…ç½®åˆ†æï¼š</strong></p>
<ul>
<li>batch_size=16ï¼šå¹³è¡¡è®­ç»ƒç¨³å®šæ€§å’Œæ”¶æ•›é€Ÿåº¦</li>
<li>epochs=200ï¼šæä¾›å……åˆ†çš„è®­ç»ƒç©ºé—´</li>
<li>verbose=0ï¼šä¿æŒè¾“å‡ºç®€æ´ï¼Œä¸“æ³¨äºç»“æœåˆ†æ</li>
</ul>
<h4 data-id="heading-24">3.3 ç¤ºä¾‹çš„æ„ä¹‰</h4>
<ul>
<li>å·¦å›¾å±•ç¤ºäº†æ—©åœæœºåˆ¶å¦‚ä½•å·¥ä½œï¼šå½“éªŒè¯æŸå¤±ä¸å†æ”¹å–„ï¼ˆç”šè‡³å¼€å§‹ä¸Šå‡ï¼‰æ—¶ï¼Œæ—©åœæœºåˆ¶ä¼šåœæ­¢è®­ç»ƒï¼Œä»è€Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚</li>
<li>å³å›¾å±•ç¤ºäº†æ¨¡å‹å­¦åˆ°çš„å‡½æ•°ä¸çœŸå®å‡½æ•°çš„å¯¹æ¯”ï¼Œå¯ä»¥çœ‹å‡ºæ¨¡å‹æ˜¯å¦è¿‡åº¦æ‹Ÿåˆäº†è®­ç»ƒæ•°æ®ä¸­çš„å™ªå£°ã€‚</li>
</ul>
<h4 data-id="heading-25">3.4 ç¤ºä¾‹çš„ä»·å€¼</h4>
<ul>
<li>æ—©åœæœºåˆ¶å¯ä»¥è‡ªåŠ¨ç¡®å®šè®­ç»ƒè½®æ¬¡ï¼Œé¿å…äººå·¥é€‰æ‹©ã€‚</li>
<li>é€šè¿‡æ—©åœï¼Œæˆ‘ä»¬å¯ä»¥åœ¨éªŒè¯æŸå¤±æœ€å°æ—¶åœæ­¢è®­ç»ƒï¼Œè·å¾—æ³›åŒ–èƒ½åŠ›æ›´å¥½çš„æ¨¡å‹ã€‚</li>
<li>å¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹å’Œé¢„æµ‹ç»“æœæœ‰åŠ©äºç†è§£æ¨¡å‹çš„è¡Œä¸ºå’Œæ—©åœæœºåˆ¶çš„æ•ˆæœã€‚</li>
</ul>
<h4 data-id="heading-26">3.5 ç¤ºä¾‹æ·±åº¦åˆ†æ</h4>
<ul>
<li>åœ¨å·¦å›¾ä¸­ï¼Œè®­ç»ƒæŸå¤±æŒç»­ä¸‹é™ï¼Œå½“éªŒè¯æŸå¤±ä¸å†æ”¹å–„ï¼ˆç”šè‡³å¼€å§‹ä¸Šå‡ï¼‰æ—¶ï¼Œæ—©åœæœºåˆ¶ä¼šåœæ­¢è®­ç»ƒï¼Œæœ‰æ•ˆçš„é˜²æ­¢äº†è¿‡æ‹Ÿåˆç°è±¡ã€‚</li>
<li>æ—©åœæœºåˆ¶åœ¨éªŒè¯æŸå¤±ä¸åœ¨æ”¹å–„ä¸€æ®µæ—¶é—´ï¼ˆpatience=10ï¼‰ååœæ­¢è®­ç»ƒï¼Œå¹¶æ¢å¤æœ€ä½³æƒé‡ï¼Œå› æ­¤æˆ‘ä»¬å¾—åˆ°çš„æ¨¡å‹æ˜¯åœ¨éªŒè¯é›†ä¸Šè¡¨ç°æœ€å¥½çš„æ¨¡å‹ã€‚</li>
<li>å³å›¾ä¸­ï¼Œæ¨¡å‹é¢„æµ‹æ›²çº¿ï¼ˆé»‘è‰²ï¼‰ä¸çœŸå®å…³ç³»ï¼ˆç»¿è‰²ï¼‰åŸºæœ¬å»åˆï¼Œè¯´æ˜æ¨¡å‹å­¦åˆ°äº†çœŸå®çš„è§„å¾‹ï¼Œè€Œæ²¡æœ‰è¿‡åº¦æ‹Ÿåˆå™ªå£°ã€‚</li>
</ul>
<h2 data-id="heading-27">å…­ã€æ€»ç»“</h2>
<p>æ—©åœæœºåˆ¶æ˜¯æœºå™¨å­¦ä¹ ä¸­ä¸€ç§é‡è¦ä¸”å®ç”¨çš„è®­ç»ƒç­–ç•¥ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯åœ¨æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­é€šè¿‡ç›‘æ§éªŒè¯é›†æ€§èƒ½æ¥è‡ªåŠ¨ç¡®å®šæœ€ä½³åœæ­¢æ—¶æœºï¼Œä»è€Œåœ¨ä¿è¯æ¨¡å‹æ³›åŒ–èƒ½åŠ›çš„åŒæ—¶æ˜¾è‘—æå‡è®­ç»ƒæ•ˆç‡ã€‚è¯¥æœºåˆ¶çš„å·¥ä½œåŸç†åŸºäºä¸€ä¸ªè§‚å¯Ÿï¼šåœ¨å…¸å‹çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒéªŒè¯é›†æŸå¤±å¾€å¾€å‘ˆç°å…ˆä¸‹é™åä¸Šå‡çš„Uå‹æ›²çº¿æ¨¡å¼ã€‚ä¸‹é™é˜¶æ®µä»£è¡¨æ¨¡å‹æ­£åœ¨å­¦ä¹ æ•°æ®ä¸­çš„æœ‰æ•ˆæ¨¡å¼ï¼Œè€Œä¸Šå‡é˜¶æ®µåˆ™è¡¨æ˜æ¨¡å‹å¼€å§‹è¿‡åº¦æ‹Ÿåˆè®­ç»ƒæ•°æ®ä¸­çš„å™ªå£°å’Œç‰¹å®šæ ·æœ¬ã€‚</p>
<p>å…·ä½“å®ç°ä¸Šï¼Œæ—©åœæœºåˆ¶åœ¨æ¯ä¸ªè®­ç»ƒè½®æ¬¡ç»“æŸåéƒ½ä¼šåœ¨ç‹¬ç«‹çš„éªŒè¯é›†ä¸Šè¯„ä¼°æ¨¡å‹æ€§èƒ½ã€‚å½“æ£€æµ‹åˆ°æ€§èƒ½æœ‰æ˜¾è‘—æ”¹å–„æ—¶ï¼Œç³»ç»Ÿä¼šä¿å­˜å½“å‰æ¨¡å‹çŠ¶æ€å¹¶é‡ç½®è€å¿ƒè®¡æ•°å™¨ï¼›è€Œå½“æ€§èƒ½è¿ç»­å¤šä¸ªè½®æ¬¡æ²¡æœ‰æ˜æ˜¾æå‡æ—¶ï¼Œè€å¿ƒè®¡æ•°å™¨ä¼šé€æ­¥ç´¯åŠ ã€‚ä¸€æ—¦è¿ç»­æ— æ”¹å–„çš„è½®æ¬¡æ•°è¾¾åˆ°é¢„è®¾çš„å®¹å¿é˜ˆå€¼ï¼Œè®­ç»ƒä¾¿ä¼šè‡ªåŠ¨ç»ˆæ­¢ï¼Œå¹¶å°†æ¨¡å‹æƒé‡æ¢å¤åˆ°å†å²æœ€ä½³çŠ¶æ€ã€‚è¿™ç§è®¾è®¡æ—¢é¿å…äº†å› è®­ç»ƒæ³¢åŠ¨å¯¼è‡´çš„è¿‡æ—©åœæ­¢ï¼Œåˆé˜²æ­¢äº†è¿‡åº¦è®­ç»ƒé€ æˆçš„æ€§èƒ½ä¸‹é™ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[[æ·±åº¦å­¦ä¹ ]RNN,LSTM,GRU(è”ç³»å’ŒåŒºåˆ«)]]></title>    <link>https://juejin.cn/post/7588064253635952694</link>    <guid>https://juejin.cn/post/7588064253635952694</guid>    <pubDate>2025-12-27T05:42:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588064253635952694" data-draft-id="7588073726207492102" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="[æ·±åº¦å­¦ä¹ ]RNN,LSTM,GRU(è”ç³»å’ŒåŒºåˆ«)"/> <meta itemprop="keywords" content="æ·±åº¦å­¦ä¹ "/> <meta itemprop="datePublished" content="2025-12-27T05:42:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="import_random"/> <meta itemprop="url" content="https://juejin.cn/user/2013961033882312"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            [æ·±åº¦å­¦ä¹ ]RNN,LSTM,GRU(è”ç³»å’ŒåŒºåˆ«)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2013961033882312/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    import_random
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T05:42:53.000Z" title="Sat Dec 27 2025 05:42:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>RNNã€LSTM å’Œ GRU æ˜¯å¤„ç†åºåˆ—æ•°æ®ï¼ˆå¦‚æ—¶é—´åºåˆ—ã€æ–‡æœ¬ã€è¯­éŸ³ï¼‰çš„æ ¸å¿ƒç¥ç»ç½‘ç»œæ¨¡å‹ã€‚</p>
<p>å®ƒä»¬ä¹‹é—´å­˜åœ¨æ¸…æ™°çš„<code>æ¼”è¿›å…³ç³»</code>ã€‚</p>
<p>ä¸‹é¢æˆ‘å°†ä¸ºä½ è¯¦ç»†æ¢³ç†å®ƒä»¬ä¹‹é—´çš„<strong>å…³è”</strong>å’Œ<strong>åŒºåˆ«</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ æ ¸å¿ƒå…³è”ï¼šæ¼”è¿›ä¸è§£å†³ä¹‹é“</h2>
<p>å¯ä»¥ç®€å•ç†è§£ä¸ºï¼šLSTM å’Œ GRU éƒ½æ˜¯<code>æ ‡å‡†RNN</code> çš„<code>å‡çº§å˜ä½“</code>ï¼Œç›®çš„æ˜¯ä¸ºäº†è§£å†³<code>æ ‡å‡† RNN</code> çš„æ ¸å¿ƒç¼ºé™·ã€‚</p>
<p>å®ƒä»¬çš„æ ¹æœ¬ç›®æ ‡ç›¸åŒï¼š<strong>å¤„ç†åºåˆ—æ•°æ®ï¼Œå¹¶åˆ©ç”¨å†å²ä¿¡æ¯æ¥å½±å“å½“å‰è¾“å‡ºã€‚</strong> å®ƒä»¬éƒ½éµå¾ªä¸€ä¸ªå¾ªç¯è®¡ç®—çš„åŸºæœ¬æ¡†æ¶ã€‚</p>
<p><strong>æ¼”è¿›è·¯çº¿ï¼š</strong></p>
<ol>
<li><strong>åŸºç¡€ç‰ˆ RNN</strong>ï¼šæå‡ºäº†å¾ªç¯è¿æ¥çš„æ¦‚å¿µï¼Œä½†å­˜åœ¨ä¸¥é‡ç¼ºé™·ã€‚</li>
<li><strong>æ”¹è¿›ç‰ˆ LSTM</strong>ï¼šé€šè¿‡ç²¾å·§çš„â€œé—¨æ§â€å’Œâ€œç»†èƒçŠ¶æ€â€è®¾è®¡ï¼Œä»æ ¹æœ¬ä¸Šè§£å†³äº† RNN çš„ä¸»è¦é—®é¢˜ï¼Œæˆä¸ºé•¿æœŸä¾èµ–å­¦ä¹ çš„é‡Œç¨‹ç¢‘ã€‚</li>
<li><strong>ç®€åŒ–ç‰ˆ GRU</strong>ï¼šåœ¨ LSTM çš„åŸºç¡€ä¸Šè¿›è¡Œç®€åŒ–ï¼Œç”¨æ›´å°‘çš„å‚æ•°è¾¾åˆ°ç›¸è¿‘çš„æ€§èƒ½ï¼Œè®­ç»ƒæ›´å¿«ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-1">äºŒã€ åˆ†æ­¥è¯¦ç»†è§£æ</h2>
<h3 data-id="heading-2">1. å¾ªç¯ç¥ç»ç½‘ç»œ</h3>
<p>RNN çš„æ ¸å¿ƒæ€æƒ³æ˜¯è®©ç½‘ç»œå…·æœ‰â€œè®°å¿†â€ï¼Œå½“å‰æ—¶åˆ»çš„è¾“å‡ºä¸ä»…å–å†³äºå½“å‰è¾“å…¥ï¼Œè¿˜å–å†³äºè¿‡å»æ‰€æœ‰æ—¶åˆ»çš„â€œå†å²çŠ¶æ€â€ã€‚</p>
<ul>
<li>
<p><strong>æ ¸å¿ƒç»“æ„</strong>ï¼š</p>
<ul>
<li>æœ‰ä¸€ä¸ª**éšè—çŠ¶æ€ **ï¼Œå®ƒåƒä¸€ä¸ªâ€œè®°å¿†å•å…ƒâ€ï¼Œéšç€æ—¶é—´æ­¥ä¼ é€’ã€‚</li>
<li>è®¡ç®—å…¬å¼ç®€å•ï¼š
<ul>
<li><code>h_t = tanh(W * [h_{t-1}, x_t] + b)</code> ï¼ˆæ›´æ–°éšè—çŠ¶æ€ï¼‰</li>
<li><code>y_t = softmax(W_y * h_t + b_y)</code> ï¼ˆç”Ÿæˆè¾“å‡ºï¼‰</li>
</ul>
</li>
<li><code>h_t</code> æ˜¯å½“å‰æ—¶åˆ»çš„éšè—çŠ¶æ€ï¼Œ<code>h_{t-1}</code> æ˜¯ä¸Šä¸€æ—¶åˆ»çš„çŠ¶æ€ï¼Œ<code>x_t</code> æ˜¯å½“å‰è¾“å…¥ã€‚</li>
</ul>
</li>
<li>
<p><strong>è‡´å‘½ç¼ºé™·ï¼šæ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸é—®é¢˜</strong></p>
<ul>
<li>åœ¨åå‘ä¼ æ’­æ—¶ï¼Œæ¢¯åº¦éœ€è¦æ²¿ç€æ—¶é—´æ­¥ä¸€è·¯å›ä¼ ã€‚RNN çš„æ¢¯åº¦æ˜¯è¿ç»­ç›¸ä¹˜çš„å…³ç³»ã€‚</li>
<li>å½“åºåˆ—å¾ˆé•¿æ—¶ï¼Œå¦‚æœæ¢¯åº¦å€¼ <code>&lt;1</code>ï¼Œè¿ç»­ç›¸ä¹˜ä¼šè¶‹è¿‘äº0ï¼Œå¯¼è‡´<strong>æ¢¯åº¦æ¶ˆå¤±</strong>â€”â€”è¿œå¤„çš„ä¿¡æ¯æ— æ³•å½±å“å½“å‰å‚æ•°çš„æ›´æ–°ï¼ˆç½‘ç»œâ€œé—å¿˜â€äº†é•¿è·ç¦»ä¾èµ–ï¼‰ã€‚</li>
<li>å¦‚æœæ¢¯åº¦å€¼ <code>&gt;1</code>ï¼Œè¿ç»­ç›¸ä¹˜ä¼šå˜å¾—æå¤§ï¼Œå¯¼è‡´<strong>æ¢¯åº¦çˆ†ç‚¸</strong>â€”â€”è®­ç»ƒä¸ç¨³å®šã€‚</li>
<li><strong>æœ¬è´¨</strong>ï¼šç®€å•å¾ªç¯ç»“æ„çš„å¤åˆå‡½æ•°ï¼Œå¯¼è‡´å¯¹é•¿æœŸè®°å¿†çš„è¯»å†™å’Œæ§åˆ¶èƒ½åŠ›å¤ªå¼±ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-3">2. é•¿çŸ­æœŸè®°å¿†ç½‘ç»œ</h3>
<p>LSTM ç”± Sepp Hochreiter å’Œ JÃ¼rgen Schmidhuber äº1997å¹´æå‡ºï¼Œä¸“é—¨ä¸ºäº†è§£å†³é•¿æœŸä¾èµ–é—®é¢˜ã€‚å…¶æ ¸å¿ƒæ˜¯å¼•å…¥äº† <strong>â€œé—¨æ§æœºåˆ¶â€</strong> å’Œä¸€ä¸ª<strong>ç‹¬ç«‹çš„â€œç»†èƒçŠ¶æ€â€</strong>ã€‚</p>
<ul>
<li>
<p><strong>æ ¸å¿ƒåˆ›æ–°</strong>ï¼š</p>
<ol>
<li><strong>ç»†èƒçŠ¶æ€</strong>ï¼šå¯ä»¥æƒ³è±¡æˆä¸€æ¡â€œä¼ é€å¸¦â€ã€‚å®ƒè´¯ç©¿æ•´ä¸ªæ—¶é—´çº¿ï¼Œåªè¿›è¡Œè½»å¾®çš„çº¿æ€§äº¤äº’ï¼Œä¿¡æ¯å¯ä»¥è½»æ˜“åœ°åœ¨è¿™æ¡ä¼ é€å¸¦ä¸ŠæµåŠ¨è€Œä¸æ˜“æ”¹å˜æˆ–æ¶ˆå¤±ã€‚è¿™æ˜¯LSTMä¿å­˜é•¿æœŸè®°å¿†çš„å…³é”®ã€‚</li>
<li><strong>ä¸‰é“é—¨æ§</strong>ï¼ˆç”±Sigmoidå‡½æ•°å’Œç‚¹ä¹˜æ“ä½œæ„æˆï¼‰ï¼š
<ul>
<li><strong>é—å¿˜é—¨</strong>ï¼šå†³å®šä»ç»†èƒçŠ¶æ€ä¸­ä¸¢å¼ƒå“ªäº›æ—§ä¿¡æ¯ã€‚<code>f_t = Ïƒ(W_f * [h_{t-1}, x_t] + b_f)</code></li>
<li><strong>è¾“å…¥é—¨</strong>ï¼šå†³å®šå°†å“ªäº›æ–°ä¿¡æ¯å­˜å…¥ç»†èƒçŠ¶æ€ã€‚å®ƒåŒ…å«ä¸¤éƒ¨åˆ†ï¼šä¸€ä¸ªSigmoidå±‚å†³å®šâ€œæ›´æ–°ä»€ä¹ˆâ€ï¼Œä¸€ä¸ªtanhå±‚ç”Ÿæˆâ€œå€™é€‰å€¼â€ã€‚
<ul>
<li><code>i_t = Ïƒ(W_i * [h_{t-1}, x_t] + b_i)</code></li>
<li><code>CÌƒ_t = tanh(W_C * [h_{t-1}, x_t] + b_C)</code></li>
</ul>
</li>
<li><strong>è¾“å‡ºé—¨</strong>ï¼šåŸºäºå½“å‰çš„ç»†èƒçŠ¶æ€ï¼Œå†³å®šè¾“å‡ºä»€ä¹ˆåˆ°éšè—çŠ¶æ€ã€‚
<ul>
<li><code>o_t = Ïƒ(W_o * [h_{t-1}, x_t] + b_o)</code></li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
<li>
<p><strong>å·¥ä½œæµç¨‹</strong>ï¼š</p>
<ol>
<li><strong>é—å¿˜</strong>ï¼šç”¨é—å¿˜é—¨ <code>f_t</code> ç‚¹ä¹˜ä¸Šä¸€ä¸ªç»†èƒçŠ¶æ€ <code>C_{t-1}</code>ï¼Œä¸¢å¼ƒæ— ç”¨ä¿¡æ¯ã€‚</li>
<li><strong>è®°å¿†</strong>ï¼šç”¨è¾“å…¥é—¨ <code>i_t</code> ç‚¹ä¹˜å€™é€‰å€¼ <code>CÌƒ_t</code>ï¼Œå°†æ–°ä¿¡æ¯åŠ åˆ°ç»†èƒçŠ¶æ€ã€‚å¾—åˆ°æ–°çŠ¶æ€ <code>C_t = f_t * C_{t-1} + i_t * CÌƒ_t</code>ã€‚</li>
<li><strong>è¾“å‡º</strong>ï¼šå°†ç»†èƒçŠ¶æ€ <code>C_t</code> é€šè¿‡tanhç¼©æ”¾ï¼Œç„¶åç”¨è¾“å‡ºé—¨ <code>o_t</code> è¿‡æ»¤ï¼Œå¾—åˆ°å½“å‰éšè—çŠ¶æ€ <code>h_t = o_t * tanh(C_t)</code>ã€‚</li>
</ol>
</li>
<li>
<p><strong>ä¸ºä½•æœ‰æ•ˆ</strong>ï¼š<strong>ç»†èƒçŠ¶æ€çš„åŠ æ³•æ›´æ–°æ˜¯å…³é”®</strong>ã€‚æ¢¯åº¦åœ¨åå‘ä¼ æ’­é€šè¿‡ç»†èƒçŠ¶æ€æ—¶ï¼Œæ˜¯<strong>åŠ æ€§çš„</strong>ï¼Œé¿å…äº†è¿ä¹˜æ•ˆåº”ï¼Œä»è€Œç¼“è§£äº†æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œä½¿ç½‘ç»œèƒ½å¤Ÿå­¦ä¹ åˆ°éå¸¸é•¿çš„ä¾èµ–å…³ç³»ã€‚</p>
</li>
</ul>
<h3 data-id="heading-4">3. é—¨æ§å¾ªç¯å•å…ƒ</h3>
<p>GRU ç”± Cho ç­‰äººäº2014å¹´æå‡ºï¼Œå¯ä»¥çœ‹ä½œæ˜¯ LSTM çš„ä¸€ç§<code>ç®€åŒ–ã€é«˜æ•ˆçš„å˜ä½“</code>ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒç®€åŒ–</strong>ï¼š
<ol>
<li><strong>åˆå¹¶äº†ç»†èƒçŠ¶æ€å’Œéšè—çŠ¶æ€</strong>ï¼Œåªæœ‰ä¸€ä¸ªä¼ é€’çŠ¶æ€ <code>h_t</code>ã€‚</li>
<li><strong>å°† LSTM çš„ä¸‰é—¨ç»“æ„ç®€åŒ–ä¸ºä¸¤é—¨</strong>ï¼š
<ul>
<li><strong>æ›´æ–°é—¨</strong>ï¼šå®ƒåŒæ—¶æ‰®æ¼”äº† LSTM ä¸­<strong>é—å¿˜é—¨å’Œè¾“å…¥é—¨</strong>çš„è§’è‰²ï¼Œå†³å®šäº†æœ‰å¤šå°‘æ—§ä¿¡æ¯è¢«ä¿ç•™ï¼Œå¤šå°‘æ–°ä¿¡æ¯è¢«åŠ å…¥ã€‚
<ul>
<li><code>z_t = Ïƒ(W_z * [h_{t-1}, x_t] + b_z)</code></li>
</ul>
</li>
<li><strong>é‡ç½®é—¨</strong>ï¼šå†³å®šäº†åœ¨è®¡ç®—æ–°çš„å€™é€‰çŠ¶æ€æ—¶ï¼Œå¦‚ä½•ç»“åˆè¿‡å»çš„ä¿¡æ¯ã€‚
<ul>
<li><code>r_t = Ïƒ(W_r * [h_{t-1}, x_t] + b_r)</code></li>
</ul>
</li>
</ul>
</li>
<li><strong>å€™é€‰æ¿€æ´»</strong>ï¼š<code>hÌƒ_t = tanh(W * [r_t * h_{t-1}, x_t] + b)</code>
<ul>
<li>é‡ç½®é—¨ <code>r_t</code> æ§åˆ¶ä¸Šä¸€çŠ¶æ€ <code>h_{t-1}</code> å¯¹å€™é€‰çŠ¶æ€çš„å½±å“ã€‚å¦‚æœ <code>r_t</code> æ¥è¿‘0ï¼Œåˆ™â€œé—å¿˜â€è¿‡å»ï¼Œåªå…³æ³¨å½“å‰è¾“å…¥ã€‚</li>
</ul>
</li>
<li><strong>æœ€ç»ˆçŠ¶æ€æ›´æ–°</strong>ï¼š<code>h_t = (1 - z_t) * h_{t-1} + z_t * hÌƒ_t</code>
<ul>
<li>æ›´æ–°é—¨ <code>z_t</code> åƒä¸€ä¸ªæƒè¡¡å› å­ï¼š<code>z_t</code> æ¥è¿‘1ï¼Œåˆ™çŠ¶æ€ä¸»è¦ç”±å€™é€‰çŠ¶æ€<code>hÌƒ_t</code>æ›´æ–°ï¼ˆæ›´åƒRNNï¼‰ï¼›<code>z_t</code>æ¥è¿‘0ï¼Œåˆ™çŠ¶æ€å‡ ä¹ä¿ç•™ä¸ºæ—§çš„<code>h_{t-1}</code>ã€‚</li>
</ul>
</li>
</ol>
</li>
</ul>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€ æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”è¡¨æ ¼</h2>







































































<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">RNN</th><th align="left">LSTM</th><th align="left">GRU</th></tr></thead><tbody><tr><td align="left"><strong>æ ¸å¿ƒç»“æ„</strong></td><td align="left">ç®€å•å¾ªç¯å•å…ƒ</td><td align="left">å¤æ‚ï¼ŒåŒ…å«ç»†èƒçŠ¶æ€å’Œä¸‰é“é—¨</td><td align="left">è¾ƒç®€å•ï¼Œåˆå¹¶çŠ¶æ€ï¼Œä¸¤é“é—¨</td></tr><tr><td align="left"><strong>é—¨æ§æ•°é‡</strong></td><td align="left">æ— </td><td align="left">3ä¸ªï¼ˆé—å¿˜ã€è¾“å…¥ã€è¾“å‡ºï¼‰</td><td align="left">2ä¸ªï¼ˆæ›´æ–°ã€é‡ç½®ï¼‰</td></tr><tr><td align="left"><strong>çŠ¶æ€æ•°é‡</strong></td><td align="left">1ä¸ªï¼ˆéšè—çŠ¶æ€ <code>h</code>ï¼‰</td><td align="left">2ä¸ªï¼ˆéšè—çŠ¶æ€ <code>h</code> å’Œ ç»†èƒçŠ¶æ€ <code>C</code>ï¼‰</td><td align="left">1ä¸ªï¼ˆéšè—çŠ¶æ€ <code>h</code>ï¼‰</td></tr><tr><td align="left"><strong>å…³é”®æœºåˆ¶</strong></td><td align="left">æ— é—¨æ§ï¼Œç›´æ¥Tanhå˜æ¢</td><td align="left">ç»†èƒçŠ¶æ€ + ç²¾ç»†é—¨æ§</td><td align="left">æ›´æ–°/é‡ç½®é—¨ + å€™é€‰çŠ¶æ€</td></tr><tr><td align="left"><strong>å‚æ•°é‡</strong></td><td align="left"><strong>æœ€å°‘</strong></td><td align="left"><strong>æœ€å¤š</strong>ï¼ˆæ¯”RNNå¤šçº¦4å€å‚æ•°ï¼‰</td><td align="left"><strong>ä¸­ç­‰</strong>ï¼ˆæ¯”RNNå¤šçº¦3å€å‚æ•°ï¼‰</td></tr><tr><td align="left"><strong>è®¡ç®—æ•ˆç‡</strong></td><td align="left">æœ€é«˜</td><td align="left">æœ€ä½ï¼ˆç»“æ„å¤æ‚ï¼‰</td><td align="left">è¾ƒé«˜ï¼ˆç»“æ„ç›¸å¯¹ç®€å•ï¼‰</td></tr><tr><td align="left"><strong>è®­ç»ƒé€Ÿåº¦</strong></td><td align="left">å¿«ï¼ˆä½†å¸¸å› æ¢¯åº¦é—®é¢˜éš¾æ”¶æ•›ï¼‰</td><td align="left">æ…¢</td><td align="left"><strong>é€šå¸¸æœ€å¿«</strong>ï¼ˆåœ¨åŒç­‰æ•ˆæœä¸‹ï¼‰</td></tr><tr><td align="left"><strong>é•¿ç¨‹ä¾èµ–èƒ½åŠ›</strong></td><td align="left"><strong>å¾ˆå¼±</strong>ï¼Œæ˜“æ¢¯åº¦æ¶ˆå¤±</td><td align="left"><strong>éå¸¸å¼º</strong>ï¼Œä¸“ä¸ºé•¿åºåˆ—è®¾è®¡</td><td align="left"><strong>å¼º</strong>ï¼Œæ¥è¿‘LSTMï¼Œä½†å¯¹è¶…é•¿åºåˆ—å¯èƒ½ç•¥é€Š</td></tr><tr><td align="left"><strong>ä¸»è¦ä¼˜åŠ¿</strong></td><td align="left">ç»“æ„ç®€å•ï¼Œè®¡ç®—å¿«</td><td align="left">é•¿æœŸè®°å¿†èƒ½åŠ›å¼ºï¼Œéå¸¸ç¨³å¥</td><td align="left">æ•ˆç‡é«˜ï¼Œåœ¨å¤šæ•°ä»»åŠ¡ä¸Šè¡¨ç°ä¸LSTMç›¸å½“</td></tr><tr><td align="left"><strong>ä¸»è¦åŠ£åŠ¿</strong></td><td align="left">æ— æ³•æœ‰æ•ˆå­¦ä¹ é•¿ç¨‹ä¾èµ–</td><td align="left">å‚æ•°å¤šï¼Œè®¡ç®—æ…¢ï¼Œå¯èƒ½è¿‡æ‹Ÿåˆ</td><td align="left">æç«¯é•¿åºåˆ—ä»»åŠ¡ä¸Šç†è®ºè§£é‡Šæ€§ä¸å¦‚LSTM</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-6">å››ã€ å¦‚ä½•é€‰æ‹©ï¼Ÿ</h2>
<ol>
<li><strong>æ•°æ®/ä»»åŠ¡ç®€å•ï¼Œåºåˆ—çŸ­</strong>ï¼šå¯ä»¥å°è¯•ç®€å•RNNï¼Œä½†ç°å®çš„é¡¹ç›®ä¸­<code>æå°‘ä½¿ç”¨æ ‡å‡†RNN</code>.</li>
<li><strong>ä»»åŠ¡å¤æ‚ï¼Œåºåˆ—éå¸¸é•¿ï¼Œä¸”å¯¹é•¿æœŸè®°å¿†è¦æ±‚æé«˜</strong>ï¼ˆå¦‚æœºå™¨ç¿»è¯‘ã€æ–‡æ¡£æ‘˜è¦ã€å¤æ‚æ—¶é—´åºåˆ—é¢„æµ‹ï¼‰ï¼š<strong>LSTM</strong> é€šå¸¸æ˜¯æ›´å¯é çš„é€‰æ‹©ï¼Œå®ƒç»è¿‡äº†æ—¶é—´çš„è€ƒéªŒï¼Œè¡¨ç°ç¨³å¥ã€‚</li>
<li><strong>è¿½æ±‚æ›´é«˜çš„è®­ç»ƒå’Œæ¨ç†æ•ˆç‡ï¼Œåºåˆ—é•¿åº¦ä¸­ç­‰æˆ–è¾ƒé•¿</strong>ï¼š<strong>GRU</strong> æ˜¯å¾ˆå¥½çš„èµ·ç‚¹ã€‚å®ƒåœ¨å¾ˆå¤šä»»åŠ¡ï¼ˆå¦‚è¯­éŸ³è¯†åˆ«ã€æƒ…æ„Ÿåˆ†æï¼‰ä¸Šä¸LSTMæ•ˆæœç›¸å½“ç”šè‡³æ›´å¥½ï¼Œä¸”é€Ÿåº¦æ›´å¿«ã€‚</li>
<li><strong>èµ„æºæœ‰é™ï¼ˆè®¡ç®—/å†…å­˜ï¼‰</strong>ï¼šä¼˜å…ˆè€ƒè™‘ <strong>GRU</strong>ã€‚</li>
<li><strong>å®è·µå»ºè®®</strong>ï¼šåœ¨å…·ä½“é¡¹ç›®ä¸Šï¼Œå¯ä»¥åŒæ—¶æ­å»ºLSTMå’ŒGRUæ¨¡å‹è¿›è¡Œå¯¹æ¯”å®éªŒï¼Œé€‰æ‹©åœ¨éªŒè¯é›†ä¸Šè¡¨ç°æ›´ä¼˜çš„æ¨¡å‹ã€‚ç›®å‰ï¼Œ<strong>GRU å’Œ LSTM æ˜¯å®é™…åº”ç”¨ä¸­æœ€ä¸»æµçš„é€‰æ‹©</strong>ï¼Œè€Œ<strong>Transformer</strong> åŠå…¶å˜ä½“ï¼ˆå¦‚BERTï¼Œ GPTï¼‰åˆ™åœ¨NLPçš„è®¸å¤šé¢†åŸŸè¶…è¶Šäº†å®ƒä»¬ã€‚</li>
</ol>
<p><strong>æ€»ç»“æ¥è¯´ï¼Œå¯ä»¥æŠŠå®ƒä»¬çœ‹ä½œæ˜¯å¤„ç†åºåˆ—é—®é¢˜çš„â€œå·¥å…·ä¸‰ä»£â€ï¼šRNNæ˜¯åŸºç¡€ä½†æœ‰ç¼ºé™·çš„å·¥å…·ï¼ŒLSTMæ˜¯åŠŸèƒ½å¼ºå¤§ä½†ç¨æ˜¾ç¬¨é‡çš„ä¸“ä¸šå·¥å…·ï¼ŒGRUåˆ™æ˜¯é›†åŠŸèƒ½å¼ºå¤§ä¸æ•ˆç‡æ€§èƒ½äºä¸€èº«çš„ç²¾è‰¯å·¥å…·ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Agent ä¸€ç›´åœ¨â€œå¤±å¿†â€ï¼Ÿé—®é¢˜ä¸åœ¨æ¨¡å‹ï¼Œè€Œåœ¨æˆ‘ä»¬æ ¹æœ¬æ²¡åšå¯¹ Memory]]></title>    <link>https://juejin.cn/post/7588086766247772211</link>    <guid>https://juejin.cn/post/7588086766247772211</guid>    <pubDate>2025-12-27T05:52:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588086766247772211" data-draft-id="7588010346071359498" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Agent ä¸€ç›´åœ¨â€œå¤±å¿†â€ï¼Ÿé—®é¢˜ä¸åœ¨æ¨¡å‹ï¼Œè€Œåœ¨æˆ‘ä»¬æ ¹æœ¬æ²¡åšå¯¹ Memory"/> <meta itemprop="keywords" content="Agent"/> <meta itemprop="datePublished" content="2025-12-27T05:52:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Tang1024"/> <meta itemprop="url" content="https://juejin.cn/user/2242659450625357"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Agent ä¸€ç›´åœ¨â€œå¤±å¿†â€ï¼Ÿé—®é¢˜ä¸åœ¨æ¨¡å‹ï¼Œè€Œåœ¨æˆ‘ä»¬æ ¹æœ¬æ²¡åšå¯¹ Memory
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2242659450625357/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Tang1024
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T05:52:28.000Z" title="Sat Dec 27 2025 05:52:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>å¾ˆå¤š Agent é¡¹ç›®å¤±è´¥ï¼Œä¸æ˜¯æ¨¡å‹ä¸è¡Œï¼Œè€Œæ˜¯æ ¹æœ¬æ²¡æœ‰â€œè®°å¿†ç³»ç»Ÿâ€ã€‚</strong></p>
</blockquote>
<p>è¿™ä¸¤å¹´ï¼Œâ€œç»™ Agent åŠ  memoryâ€ å‡ ä¹æˆäº†å…±è¯†ï¼Œå‘é‡åº“ã€RAGã€é•¿ä¸Šä¸‹æ–‡ã€KV cacheâ€¦â€¦å·¥å…·è¶Šæ¥è¶Šå¤šï¼Œä½†ä¸€ä¸ªå°´å°¬çš„ç°è±¡æ˜¯ï¼š</p>
<blockquote>
<p><strong>Agent ä¾ç„¶å¥å¿˜ã€åå¤çŠ¯é”™ã€å‰åçŸ›ç›¾ï¼Œè·‘ä¹…äº†è¿˜ä¼šâ€œäººæ ¼å´©åâ€ã€‚</strong></p>
</blockquote>
<p>é—®é¢˜åˆ°åº•å‡ºåœ¨å“ªï¼Ÿ</p>
<p>æœ€è¿‘ä¸€ç¯‡ç”± <strong>NUSã€äººå¤§ã€å¤æ—¦ã€åŒ—å¤§</strong> ç­‰æœºæ„è”åˆå®Œæˆçš„ç™¾é¡µç»¼è¿°<br/>
ã€Š<strong>Memory in the Age of AI Agents</strong>ã€‹ï¼Œç»™äº†æˆ‘ä¸€ä¸ªéå¸¸å·¥ç¨‹åŒ–çš„ç­”æ¡ˆï¼š</p>
<blockquote>
<p><strong>æˆ‘ä»¬å¤§å¤šæ•°äººåœ¨åšçš„ï¼Œå¹¶ä¸æ˜¯ Agent Memoryï¼Œè€Œåªæ˜¯â€œä¿¡æ¯å¤–æŒ‚â€ã€‚</strong></p>
</blockquote>
<p>è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä¸æ‰“ç®—å¤è¿°è®ºæ–‡ï¼Œè€Œæ˜¯ç«™åœ¨<strong>å·¥ç¨‹å¸ˆè§†è§’</strong>ï¼Œè®²æ¸…ä¸‰ä»¶äº‹ï¼š</p>
<ol>
<li>ä¸ºä»€ä¹ˆâ€œå‘é‡åº“ â‰  Agent Memoryâ€</li>
<li>Agent Memory çš„<strong>ç³»ç»Ÿçº§æŠ½è±¡</strong>åº”è¯¥é•¿ä»€ä¹ˆæ ·</li>
<li>å¦‚æœä½ çœŸçš„è¦åšä¸€ä¸ªâ€œä¼šæˆé•¿çš„ Agentâ€ï¼Œæ¶æ„è¯¥æ€ä¹ˆè®¾è®¡</li>
</ol>
<hr/>
<h2 data-id="heading-0">ä¸€ã€å…ˆè¯´ç»“è®ºï¼šæ²¡æœ‰ Memoryï¼Œå°±æ²¡æœ‰é•¿æœŸå¯ç”¨çš„ Agent</h2>
<p>åœ¨çœŸå®å·¥ç¨‹é‡Œï¼Œä½ ä¸€å®šè§è¿‡è¿™äº›ç°è±¡ï¼š</p>
<ul>
<li>Agent åå¤é—®å·²ç»é—®è¿‡çš„é—®é¢˜</li>
<li>å·²ç»å¤±è´¥è¿‡çš„ç­–ç•¥ï¼Œä¸‹æ¬¡è¿˜æ˜¯ç…§æ ·èµ°</li>
<li>å¤šè½®ä»»åŠ¡ä¸€é•¿ï¼Œå°±å¼€å§‹è‡ªç›¸çŸ›ç›¾</li>
<li>ç”¨æˆ·åå¥½ã€èº«ä»½è®¾å®šï¼Œåœ¨ session ä¹‹é—´ç›´æ¥è’¸å‘</li>
</ul>
<p>è¿™äº›é—®é¢˜<strong>ä¸æ˜¯ prompt æ²¡å†™å¥½ï¼Œä¹Ÿä¸æ˜¯æ¨¡å‹ä¸èªæ˜</strong>ï¼Œè€Œæ˜¯ï¼š</p>
<blockquote>
<p><strong>ç³»ç»Ÿæ²¡æœ‰èƒ½åŠ›è·¨æ—¶é—´ç»´æŒâ€œè®¤çŸ¥çŠ¶æ€â€ã€‚</strong></p>
</blockquote>
<p>æ¢å¥è¯è¯´ï¼š<br/>
<strong>Agent æ²¡æœ‰æ´»åœ¨æ—¶é—´é‡Œã€‚</strong></p>
<p>è¿™æ­£æ˜¯ä¸ºä»€ä¹ˆè¿™ç¯‡ç»¼è¿°ç›´æ¥æŠŠ Memory å®šä½ä¸ºï¼š</p>
<blockquote>
<p><strong>Agent çš„åŸºç¡€è®¾æ–½ï¼ˆfirst-class primitiveï¼‰</strong><br/>
è€Œä¸æ˜¯ä¸€ä¸ªâ€œå¢å¼ºæ¨¡å—â€ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">äºŒã€ä¸ºä»€ä¹ˆâ€œé•¿ / çŸ­æœŸè®°å¿†â€è¿™ä¸ªåˆ’åˆ†å·²ç»è¿‡æ—¶äº†ï¼Ÿ</h2>
<p>å·¥ç¨‹ä¸­æœ€å¸¸è§çš„è¯´æ³•æ˜¯ï¼š</p>
<ul>
<li>short-term memoryï¼šä¸Šä¸‹æ–‡çª—å£</li>
<li>long-term memoryï¼šå‘é‡åº“</li>
</ul>
<p>ä½†é—®é¢˜æ˜¯ï¼š</p>
<ul>
<li>æœ‰çš„â€œé•¿æœŸè®°å¿†â€åªæœåŠ¡äºäº‹å®ä¸€è‡´æ€§</li>
<li>æœ‰çš„æœåŠ¡äºèƒ½åŠ›æˆé•¿</li>
<li>æœ‰çš„åªåœ¨å•ä¸ªä»»åŠ¡é‡Œä½œä¸ºå·¥ä½œåŒº</li>
</ul>
<p><strong>å®ƒä»¬å¤±è´¥çš„æ–¹å¼å®Œå…¨ä¸åŒã€‚</strong></p>
<p>ç»§ç»­ç”¨æ—¶é—´ç»´åº¦å»åˆ‡åˆ†ï¼Œåªä¼šè®©æ¶æ„è¶Šæ¥è¶Šæ··ä¹±ã€‚äºæ˜¯è¿™ç¯‡ç»¼è¿°æå‡ºäº†ä¸€ä¸ªå¯¹å·¥ç¨‹å¸ˆæå…¶å‹å¥½çš„ç»Ÿä¸€æ¡†æ¶ï¼š</p>
<blockquote>
<p><strong>Forms â€“ Functions â€“ Dynamics</strong></p>
</blockquote>
<p>å®ƒä¸é—®â€œè®°å¤šä¹…â€ï¼Œè€Œæ˜¯é—®ä¸‰ä¸ªæ›´å…³é”®çš„é—®é¢˜ï¼š</p>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€Formsï¼šè®°å¿†â€œæ”¾åœ¨å“ªé‡Œâ€ï¼Ÿ</h2>
<p>ä¹Ÿå°±æ˜¯ï¼š<strong>ç³»ç»Ÿåˆ°åº•é ä»€ä¹ˆæ‰¿è½½è®°å¿†ï¼Ÿ</strong></p>
<h3 data-id="heading-3">1ï¸âƒ£ Token-level Memoryï¼ˆæœ€å¸¸è§ï¼Œä¹Ÿæ˜¯æœ€å®¹æ˜“ç¿»è½¦çš„ï¼‰</h3>
<p>è¿™å°±æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„ï¼š</p>
<ul>
<li>å‘é‡åº“</li>
<li>æ–‡æœ¬ç‰‡æ®µ</li>
<li>è½¨è¿¹æ—¥å¿—</li>
<li>ç»“æ„åŒ–è®°å½•</li>
</ul>
<p>å®ƒçš„ä¼˜åŠ¿éå¸¸å·¥ç¨‹åŒ–ï¼š</p>
<ul>
<li>å¯è¯»ã€å¯æŸ¥ã€å¯æ”¹</li>
<li>æ˜“äºæ²»ç†</li>
<li>èƒ½å’Œå·¥å…·é“¾é›†æˆ</li>
</ul>
<p>ä½†è®ºæ–‡æ˜ç¡®æŒ‡å‡ºä¸€ä¸ªç°å®é—®é¢˜ï¼š</p>
<blockquote>
<p><strong>Flat memoryï¼ˆç®€å•å †å†å²ï¼‰åœ¨è§„æ¨¡ä¸Šä¸€å®šä¼šé€€åŒ–ã€‚</strong></p>
</blockquote>
<p>æ‰€ä»¥ï¼ŒçœŸæ­£èƒ½è·‘é•¿æœŸçš„ç³»ç»Ÿï¼Œå¿…ç„¶ä¼šèµ°å‘ï¼š</p>
<ul>
<li><strong>ç»“æ„åŒ–ï¼ˆPlanarï¼‰</strong> ï¼šå›¾ã€è¡¨ã€å…³ç³»</li>
<li><strong>åˆ†å±‚æŠ½è±¡ï¼ˆHierarchicalï¼‰</strong> ï¼šç»†èŠ‚ + æ€»ç»“å¹¶å­˜</li>
</ul>
<p>ğŸ‘‰ <strong>å‘é‡åº“åªæ˜¯ Flat Memory çš„ä¸€ç§å®ç°ï¼Œä¸æ˜¯ç»ˆç‚¹ã€‚</strong></p>
<hr/>
<h3 data-id="heading-4">2ï¸âƒ£ Parametric Memoryï¼ˆå†™è¿›æƒé‡ï¼‰</h3>
<p>è¿™æ˜¯æŠŠç»éªŒâ€œå†…åŒ–â€æˆæ¨¡å‹å‚æ•°ï¼š</p>
<ul>
<li>finetune</li>
<li>adapter</li>
<li>policy head</li>
</ul>
<p>ä¼˜ç‚¹æ˜¯å¿«ã€ç›´æ¥ã€æ— éœ€æ£€ç´¢ï¼›<br/>
ç¼ºç‚¹åŒæ ·è‡´å‘½ï¼š</p>
<ul>
<li>æˆæœ¬é«˜</li>
<li>ä¸å¯å®¡è®¡</li>
<li>éš¾ä»¥ç²¾ç¡®ä¿®æ”¹</li>
</ul>
<p>ğŸ‘‰ <strong>å®ƒæ›´åƒâ€œé•¿æœŸæ²‰æ·€å±‚â€ï¼Œè€Œä¸æ˜¯æ—¥å¸¸è®°å¿†ç³»ç»Ÿã€‚</strong></p>
<hr/>
<h3 data-id="heading-5">3ï¸âƒ£ Latent Memoryï¼ˆéšçŠ¶æ€é‡Œçš„è®°å¿†ï¼‰</h3>
<p>è®°å¿†å­˜åœ¨äºï¼š</p>
<ul>
<li>éšçŠ¶æ€</li>
<li>è¿ç»­è¡¨ç¤º</li>
<li>memory tokens</li>
</ul>
<p>å®ƒä»‹äºå¤–éƒ¨å­˜å‚¨å’Œå‚æ•°å†…åŒ–ä¹‹é—´ï¼Œ<br/>
é€‚åˆé«˜é¢‘æ›´æ–°ã€å¤šæ¨¡æ€åœºæ™¯ã€‚</p>
<p>ä½†å·¥ç¨‹ä¸Šè¦æ¸…æ¥šï¼š</p>
<blockquote>
<p><strong>å®ƒå‡ ä¹ä¸å¯è§£é‡Šï¼Œåªé€‚åˆâ€œæœºå™¨è‡ªå·±ç”¨â€ã€‚</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-6">å››ã€Functionsï¼šè®°å¿†â€œåˆ°åº•å¹²ä»€ä¹ˆç”¨â€ï¼Ÿ</h2>
<p>è¿™æ˜¯å…¨æ–‡<strong>å¯¹å·¥ç¨‹æœ€æœ‰ä»·å€¼çš„æŠ½è±¡</strong>ã€‚è®ºæ–‡ä¸å†æŒ‰æ—¶é—´ï¼Œè€Œæ˜¯æŒ‰<strong>åŠŸèƒ½å¤±è´¥æ¨¡å¼</strong>ï¼ŒæŠŠ Agent Memory åˆ†æˆä¸‰ç±»ã€‚</p>
<hr/>
<h3 data-id="heading-7">1ï¸âƒ£ Factual Memoryï¼šè®© Agent è®°ä½â€œä¸–ç•Œæ˜¯ä»€ä¹ˆæ ·çš„â€</h3>
<p>è¿™æ˜¯ä¸€ä¸ª<strong>å¯æ²»ç†çš„äº‹å®å±‚</strong>ï¼š</p>
<ul>
<li>ç”¨æˆ·åå¥½</li>
<li>ç¯å¢ƒçŠ¶æ€</li>
<li>ä»£ç åº“ç»“æ„</li>
<li>å·¥å…·è¿”å›ç»“æœ</li>
</ul>
<p>å¦‚æœä½ åšè¿‡å¤æ‚ Agentï¼Œä¸€å®šçŸ¥é“è¿™ä¸ªç—›ç‚¹ï¼š</p>
<blockquote>
<p>äº‹å®ä¸€æ—¦æ•£è½åœ¨å†å²å¯¹è¯é‡Œï¼Œå°±ä¼šè¢«å¿˜ã€è¢«è¯¯å¼•ã€è¢«ç¼–é€ ã€‚</p>
</blockquote>
<p>Factual Memory çš„ä»·å€¼å°±æ˜¯ï¼š</p>
<blockquote>
<p><strong>æŠŠâ€œå¯æ ¸æŸ¥çš„ä¸–ç•ŒçŠ¶æ€â€ä»ä¸Šä¸‹æ–‡ä¸­è§£æ”¾å‡ºæ¥ã€‚</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-8">2ï¸âƒ£ Experiential Memoryï¼šè®© Agent çœŸæ­£â€œåƒä¸€å ‘é•¿ä¸€æ™ºâ€</h3>
<p>è¿™æ˜¯æœ€å®¹æ˜“è¢«å¿½ç•¥ã€ä½†<strong>æœ€åƒâ€œæ™ºèƒ½â€çš„ä¸€ç±»è®°å¿†</strong>ã€‚</p>
<p>å®ƒå…³æ³¨çš„ä¸æ˜¯â€œå‘ç”Ÿäº†ä»€ä¹ˆâ€ï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li>å“ªäº›ç­–ç•¥æœ‰æ•ˆ</li>
<li>å“ªäº›è·¯å¾„æ˜¯å‘</li>
<li>å“ªç§è§£æ³•åœ¨ä»€ä¹ˆæ¡ä»¶ä¸‹å¯å¤ç”¨</li>
</ul>
<p>è®ºæ–‡æŠŠå®ƒæ‹†æˆä¸‰å±‚ï¼š</p>
<ul>
<li><strong>Case-based</strong>ï¼šåŸå§‹è½¨è¿¹</li>
<li><strong>Strategy-based</strong>ï¼šæŠ½è±¡æ–¹æ³•</li>
<li><strong>Skill-based</strong>ï¼šå¯æ‰§è¡Œèƒ½åŠ›</li>
</ul>
<p>ğŸ‘‰ <strong>æœ‰æ²¡æœ‰ strategy / skill memoryï¼Œæ˜¯åŒºåˆ†â€œAgentâ€å’Œâ€œå¸¦å†å²çš„ LLMâ€çš„åˆ†æ°´å²­ã€‚</strong></p>
<hr/>
<h3 data-id="heading-9">3ï¸âƒ£ Working Memoryï¼šè®© Agent åœ¨å•ä¸ªä»»åŠ¡é‡Œä¸è¢«ä¿¡æ¯æ·¹æ²¡</h3>
<p>è¿™ä¸æ˜¯â€œçŸ­æœŸè®°å¿†â€ï¼Œè€Œæ˜¯<strong>æ³¨æ„åŠ›ç®¡ç†</strong>ï¼š</p>
<ul>
<li>é¢å¯¹è¶…é•¿æ–‡æ¡£</li>
<li>é¢å¯¹å¤æ‚ DOM</li>
<li>é¢å¯¹å¤šå·¥å…·è¾“å‡º</li>
</ul>
<p>Working Memory çš„èŒè´£æ˜¯ï¼š</p>
<ul>
<li>å‹ç¼©</li>
<li>æŠ˜å </li>
<li>æŠ½è±¡</li>
<li>è£å‰ª</li>
</ul>
<p>ğŸ‘‰ æœ¬è´¨ä¸Šï¼Œå®ƒæ˜¯ä¸€ä¸ª<strong>æ¨ç†èµ„æºè°ƒåº¦æ¨¡å—</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-10">äº”ã€Dynamicsï¼šä¸ºä»€ä¹ˆä½ çš„ Memory å­˜äº†å´â€œæ²¡ç”¨â€ï¼Ÿ</h2>
<p>è¿™æ˜¯å¾ˆå¤š Agent é¡¹ç›®çœŸæ­£å¤±è´¥çš„åœ°æ–¹ã€‚</p>
<p>è®ºæ–‡æ˜ç¡®æŒ‡å‡ºï¼š</p>
<blockquote>
<p><strong>Memory ä¸æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œè€Œæ˜¯ä¸€ä¸ªé—­ç¯ç³»ç»Ÿã€‚</strong></p>
</blockquote>
<p>å®Œæ•´ç”Ÿå‘½å‘¨æœŸæ˜¯ï¼š</p>
<pre><code class="hljs">å½¢æˆï¼ˆFormationï¼‰
 â†’ æ¼”åŒ–ï¼ˆEvolutionï¼‰
 â†’ æ£€ç´¢ï¼ˆRetrievalï¼‰
 â†’ å†³ç­–
 â†’ åé¦ˆ
 â†’ å†å½¢æˆ
</code></pre>
<h3 data-id="heading-11">å…³é”®å·¥ç¨‹å¯ç¤ºåªæœ‰ä¸€å¥è¯ï¼š</h3>
<blockquote>
<p><strong>æ²¡æœ‰è¿›å…¥å†³ç­–å›è·¯çš„ Memoryï¼Œç­‰äºä¸å­˜åœ¨ã€‚</strong></p>
</blockquote>
<p>å¾ˆå¤šç³»ç»Ÿçš„é—®é¢˜ä¸æ˜¯æ²¡å­˜ï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li>æ£€ç´¢è§¦å‘ç­–ç•¥ä¸å¯¹</li>
<li>å–å›å†…å®¹æ²¡è¢« Planner çœŸæ­£ä½¿ç”¨</li>
<li>æ²¡æœ‰ evolutionï¼Œè®°å¿†é€æ¸è…åŒ–</li>
</ul>
<hr/>
<h2 data-id="heading-12">å…­ã€ä¸‹ä¸€ä»£ Agent Memoryï¼Œä¼šå¾€å“ªèµ°ï¼Ÿ</h2>
<p>è®ºæ–‡æœ€åç»™å‡ºçš„åˆ¤æ–­éå¸¸æ˜ç¡®ï¼š</p>
<ol>
<li>
<p><strong>ä» Retrieval â†’ Generation</strong></p>
<ul>
<li>ä¸åªæ˜¯å–æ—§æ–‡æœ¬ï¼Œè€Œæ˜¯ç”Ÿæˆâ€œæ›´å¯ç”¨çš„æŠ½è±¡è®°å¿†â€</li>
</ul>
</li>
<li>
<p><strong>ä»æ‰‹å·¥è§„åˆ™ â†’ è‡ªåŠ¨ç®¡ç†</strong></p>
<ul>
<li>Agent è‡ªå·±å†³å®šä»€ä¹ˆæ—¶å€™å†™ã€å†™ä»€ä¹ˆã€åˆ ä»€ä¹ˆ</li>
</ul>
</li>
<li>
<p><strong>ä» Pipeline â†’ RL-driven Control</strong></p>
<ul>
<li>è®°å¿†æ“ä½œæˆä¸ºå¯å­¦ä¹ ç­–ç•¥çš„ä¸€éƒ¨åˆ†</li>
</ul>
</li>
</ol>
<p>è¿™æ„å‘³ç€ä¸€ä¸ªé‡è¦è½¬å˜ï¼š</p>
<blockquote>
<p><strong>Memory æ­£åœ¨ä»å¤–æŒ‚ï¼Œå˜æˆ Agent èƒ½åŠ›çš„ä¸€éƒ¨åˆ†ã€‚</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-13">ä¸ƒã€ç»™å·¥ç¨‹å¸ˆçš„ä¸€å¥è¯æ€»ç»“</h2>
<p>å¦‚æœä½ åªè®°ä½ä¸€å¥è¯ï¼Œé‚£å°±æ˜¯ï¼š</p>
<blockquote>
<p><strong>Agent Memory ä¸æ˜¯â€œå­˜å¾—ä¹…â€ï¼Œ<br/>
è€Œæ˜¯â€œå­˜å¾—å¯¹ã€å–å¾—åˆ°ã€ç”¨å¾—ä¸Šã€è¿˜èƒ½è¿›åŒ–â€ã€‚</strong></p>
</blockquote>
<p>å½“ä½ æŠŠ Memory å½“æˆ<strong>ç³»ç»Ÿçº§èƒ½åŠ›</strong>æ¥è®¾è®¡ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ£€ç´¢æ’ä»¶æ—¶ï¼Œ<br/>
ä½ åšçš„ï¼Œæ‰æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ Agentã€‚</p>
<hr/>
<p>å¦‚æœä½ ä¹Ÿåœ¨åš Agent ç³»ç»Ÿï¼Œå¸Œæœ›å®ƒèƒ½è·‘å¾—ä¹…ã€å­¦å¾—ä¼šã€è¡Œä¸ºç¨³å®šï¼Œ  é‚£è¯·è®¤çœŸå¯¹å¾… Memory â€”â€”  å®ƒä¸æ˜¯é”¦ä¸Šæ·»èŠ±ï¼Œè€Œæ˜¯åœ°åŸºã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AIæ™ºèƒ½ä½“å¼€å‘æ¡†æ¶LangChain & LangGraphå¿«é€Ÿå…¥é—¨å®æˆ˜ï¼ˆåŒ…å«LangSmithï¼‰]]></title>    <link>https://juejin.cn/post/7588086766247903283</link>    <guid>https://juejin.cn/post/7588086766247903283</guid>    <pubDate>2025-12-27T07:00:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588086766247903283" data-draft-id="7588086766247870515" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AIæ™ºèƒ½ä½“å¼€å‘æ¡†æ¶LangChain &amp; LangGraphå¿«é€Ÿå…¥é—¨å®æˆ˜ï¼ˆåŒ…å«LangSmithï¼‰"/> <meta itemprop="keywords" content="Agent,LLM,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-27T07:00:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§æ¨¡å‹æ•™ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/1145012233707299"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AIæ™ºèƒ½ä½“å¼€å‘æ¡†æ¶LangChain &amp; LangGraphå¿«é€Ÿå…¥é—¨å®æˆ˜ï¼ˆåŒ…å«LangSmithï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1145012233707299/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§æ¨¡å‹æ•™ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-27T07:00:49.000Z" title="Sat Dec 27 2025 07:00:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>ã€‚</p>
</blockquote>
<p>æœ€è¿‘ä¹±ä¸ƒå…«ç³Ÿçš„äº‹å¤ªå¤šï¼Œä»Šå¤©æ¥ç‚¹åæŠ€æœ¯å®æˆ˜çš„ï¼Œå¸¦å¤§å®¶ç”¨LangChain &amp; LangGraphå¿«é€Ÿå…¥é—¨ç”¨ç¼–ç¨‹åˆ›å»ºæ™ºèƒ½ä½“ï¼Œç”¨LangSmithè¿›è¡Œè¿½è¸ªï¼ŒAgent-Chatæ„å»ºAgent UIã€‚</p>
<p>åŸºæœ¬æ¦‚å¿µ</p>
<p>ç›¸ä¿¡å¤§å®¶ç›¸æ¯”äºLangGraphï¼ŒLangChainèƒ½æ›´ç†Ÿæ‚‰ä¸€äº›ï¼Œæ¯•ç«ŸLangChainå‡ºç°çš„æ›´æ—©ï¼Œä¸‹é¢å…ˆæ¥ç®€å•ä»‹ç»ä¸‹è¿™ä¸¤ä¸ªæ¡†æ¶ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f7e3c0d78ce4fea82e1f5e1cf974fcd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=V%2Fq%2FEXojp%2F7B8IdAzBr%2Bx9%2BxZio%3D" alt="" loading="lazy"/></p>
<p>LangChainï¼šå®ƒæ˜¯ä¸€ä¸ªå¼€å‘AIåº”ç”¨çš„åŸºç¡€æ¡†æ¶ï¼Œä¸»è¦æä¾›äº†å¼€å‘AIåº”ç”¨çš„å„ç§æ¥å£å’Œå·¥å…·ï¼Œä¾‹å¦‚è°ƒç”¨å¤§æ¨¡å‹çš„ç»Ÿä¸€æ¥å£ï¼Œæä¾›äº†æœç´¢ã€æ–‡æ¡£å¤„ç†ã€å‘é‡æ•°æ®åº“å¤„ç†ç­‰å·¥å…·ï¼Œå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬éå¸¸å¿«é€Ÿè°ƒç”¨å®ç°åŠŸèƒ½ï¼ŒåŠ å¿«å¼€å‘é€Ÿåº¦ï¼Œå¦åˆ™æˆ‘ä»¬è¿˜å¾—è‡ªå·±å»å°è£…ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒLangChainè¿˜æä¾›äº†é“¾å¼è°ƒç”¨ï¼ˆChainsï¼‰ã€è®°å¿†ç®¡ç†å’Œæç¤ºè¯æ¨¡ç‰ˆç­‰åŸºç¡€åŠŸèƒ½ã€‚</p>
<p>å®˜ç½‘åœ°å€ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fpython.langchain.com%2Fdocs%2Fintroduction%2F" target="_blank" title="https://python.langchain.com/docs/introduction/" ref="nofollow noopener noreferrer">python.langchain.com/docs/introdâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6c9d21ffc2294103a9eefd36d8cfd1a2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=Y%2BuyWGNdxp4ZXawcmfJkfq6wc5c%3D" alt="" loading="lazy"/></p>
<p>LangGraphï¼šå®ƒæ›´é«˜çº§ä¸€äº›ï¼Œå®ƒåœ¨LangChainä¸Šé¢ï¼Œæ˜¯ä¸€ä¸ªåŸºäºLangChainçš„å·¥ä½œæµç¼–æ’æ¡†æ¶ï¼Œå¯ä»¥å¤„ç†å¤æ‚çš„å·¥ä½œæµç¼–æ’å’Œå¤šæ™ºèƒ½ä½“ç¼–æ’ã€‚æ‰€ä»¥ä»åå­—ä¸Šä¹Ÿå¯ä»¥çœ‹å‡ºæ¥ï¼ŒLangChainè¿˜æ˜¯åœç•™åœ¨é“¾å¼ï¼ˆChainï¼‰çš„è°ƒç”¨ï¼Œè€ŒLangGraphåˆ™æ˜¯æŠŠå¤æ‚çš„æ™ºèƒ½ä½“å·¥ä½œæµæŠ½è±¡æˆä¸€ä¸ªå›¾ï¼ˆGraphï¼‰äº†ã€‚LangGraphçš„æ ¸å¿ƒåŠŸèƒ½åŒ…å«äº†æœ‰çŠ¶æ€çš„å·¥ä½œæµå¤„ç†ã€æ¡ä»¶åˆ†æ”¯ã€å¾ªç¯ã€å¹¶è¡Œæ‰§è¡Œã€æ£€æŸ¥ç‚¹ï¼ˆCheckpointsï¼‰å’ŒçŠ¶æ€ç®¡ç†ç­‰å¤„ç†ã€‚</p>
<p>å®˜ç½‘åœ°å€ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Flangchain-ai.github.io%2Flanggraph%2F" target="_blank" title="https://langchain-ai.github.io/langgraph/" ref="nofollow noopener noreferrer">langchain-ai.github.io/langgraph/</a></p>
<p>PSï¼šå¯èƒ½æœ‰äº›äººå¯¹äºä¸Šé¢æåˆ°çš„LangGraphçŠ¶æ€ç®¡ç†è¿™ä¸ªæ¦‚å¿µæœ‰äº›æ¨¡ç³Šï¼Œåœ¨æ­¤è¡¥å……è§£é‡Šä¸‹ã€‚çŠ¶æ€ç®€å•ç†è§£ï¼Œå°±æ˜¯å·¥ä½œæµæ‰§è¡Œè¿‡ç¨‹ä¸­éœ€è¦ä¿å­˜å’Œä¼ é€’çš„æ•°æ®ï¼Œæ¯ä¸ªæ­¥éª¤çš„ç»“æœéƒ½ä¼šä¿å­˜ï¼Œåç»­æ­¥éª¤å¯ä»¥è®¿é—®å‰é¢æ­¥éª¤çš„ç»“æœå’Œæ•°æ®ï¼Œå¦‚æœæŸä¸ªæ­¥éª¤å¤±è´¥ï¼Œå¯ä»¥ä»å¤±è´¥ç‚¹é‡æ–°å¼€å§‹ã€‚</p>
<p>å®æˆ˜</p>
<p>æ¥ä¸‹æ¥å¸¦å¤§å®¶å®æˆ˜ä¸€ä¸ªé¡¹ç›®ï¼Œè®©å¤§å®¶å¿«é€Ÿå…¥é—¨LangChain &amp; LangGraphç”Ÿæ€ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å¼€å‘å·¥å…·å°±é€‰æ‹©ç”¨Curosräº†ã€‚</p>
<p>1ã€åˆ›å»ºç©ºé¡¹ç›®ï¼Œç”¨cursoræ‰“å¼€</p>
<p>ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬åœ¨å¤–å¤´åˆ›å»ºä¸€ä¸ªç©ºé¡¹ç›®æ–‡ä»¶å¤¹ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©å«ã€lang-demoã€‘ï¼Œç„¶åç”¨Cursoræ‰“å¼€è¯¥æ–‡ä»¶å¤¹ã€‚</p>
<p>2ã€åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</p>
<p>ä¸ºäº†å’Œå…¶ä»–pythoné¡¹ç›®çš„ç¯å¢ƒè¿›è¡Œéš”ç¦»ï¼Œæˆ‘ä»¬ç”¨cursorçš„ç»ˆç«¯ï¼Œä½¿ç”¨condaå‘½ä»¤å…ˆåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼Œè¿™é‡Œæˆ‘åˆ›å»ºçš„è™šæ‹Ÿç¯å¢ƒå«clxï¼Œç„¶åè¿›å…¥åˆ°è¯¥è™šæ‹Ÿç¯å¢ƒä¸­ã€‚ï¼ˆæ³¨æ„ï¼Œå»ºè®®pythonç‰ˆæœ¬è¦3.11ä»¥ä¸Šï¼Œå› ä¸ºåç»­éœ€è¦å®‰è£…langgraph-cli[inmem]ï¼Œæœ€ä½ç‰ˆæœ¬è¦æ±‚3.11ï¼‰ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">conda create -n clx <span class="hljs-attr">python</span>=<span class="hljs-number">3.12</span>
conda activate clx
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/05648e7d786a4c08931d0e8d1422958d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=3Cw9M4TFQPihDRa6vTqS%2BjFO%2B9M%3D" alt="" loading="lazy"/></p>
<p>å¦‚ä½•åˆ¤æ–­æ˜¯ä¸æ˜¯å·²ç»è¿›å…¥åˆ°äº†ä¸Šé¢åˆ›å»ºçš„è™šæ‹Ÿç¯å¢ƒä¸­å‘¢ï¼Ÿè¿›å…¥åï¼Œç»ˆç«¯çš„å‘½ä»¤è¡Œå‰ä¼šæœ‰è™šæ‹Ÿç¯å¢ƒçš„åç§°ã€‚</p>
<p>3ã€åˆ›å»ºrequirements.txtï¼Œå®‰è£…ä¾èµ–</p>
<p>é¡¹ç›®ä¸­åˆ›å»ºrequirements.txtæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/74398a9e667744e48d1a33e825e85d10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=rI899lGCEEnxxehn6dxCrCYyagM%3D" alt="" loading="lazy"/></p>
<p>ç„¶ååœ¨cursorç»ˆç«¯è¾“å…¥å‘½ä»¤å®‰è£…ä¾èµ–ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs">pip3 install -r requirements.txt
</code></pre>
<p>4ã€åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶</p>
<p>æ¥ä¸‹æ¥åˆ›å»ºã€.envã€‘æ–‡ä»¶ï¼Œé‡Œé¢é…ç½®å„å¤„ç”³è¯·çš„keyã€‚å†…å®¹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c622b68cc9f74667b8597246c11cecd9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=OWivQYcONtGscDR8NdcADAoip9s%3D" alt="" loading="lazy"/></p>
<p>å…¶ä¸­deepseekçš„API Keyç”³è¯·å‚ç…§ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3769fcbfd25242b9b52e7ce5e7cea35b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=FRtzt8WoDofHiXuOzdzSknAJrGc%3D" alt="" loading="lazy"/></p>
<p>TAVILYçš„API Keyç”³è¯·å‚ç…§ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94b98944f44444019254cc5d0d0eadcc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=KemF6cYCw%2BKNPOFs6qZ83xFyBkY%3D" alt="" loading="lazy"/></p>
<p>LangSmithçš„API Keyç”³è¯·å‚ç…§ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2cdde09c07bc4efca59ab4fdc1912008~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=0gnLwAJOLgPZPT5x1JPFFECIGrc%3D" alt="" loading="lazy"/></p>
<p>5ã€ä½¿ç”¨cursorç”Ÿæˆä¸€ä¸ªLangChain &amp; LangGraphçš„demo</p>
<p>å¯¹ï¼Œä½ æ²¡çœ‹é”™ï¼Œè¿™é‡Œä¸æ˜¯ç»™å¤§å®¶è®²æˆ‘æœ¬åœ°çš„é¡¹ç›®å¦‚ä½•åšçš„ï¼Œè€Œæ˜¯è®©å¤§å®¶ç”¨Cursorå»ç»™è‡ªå·±ç”Ÿæˆä¸€ä¸ªï¼Œå¹¶è°ƒè¯•é€šï¼Œæ‰€ä»¥æœ€åæ¯ä¸ªäººçš„Demoè‚¯å®šæ˜¯ä¸ä¸€æ ·çš„ã€‚æˆ‘ç”ŸæˆDemoçš„Promptå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">è¯·ç»™æˆ‘ç”Ÿæˆä¸€ä¸ªLangChainå’ŒLangGraphçš„Demoï¼Œè¦æ±‚å¦‚ä¸‹ï¼š
1ã€å°½å¯èƒ½å¤šçš„ç”¨ä¸Šã€requirements.txtã€‘å’Œã€.<span class="hljs-built_in">env</span>ã€‘çš„æŠ€æœ¯å†…å®¹è¿›è¡Œè®¾è®¡ã€‚
2ã€Demoå°½é‡ç®€å•ï¼Œé€‚åˆå­¦ä¹ ç”¨ï¼Œæ–¹ä¾¿ç†è§£ã€‚
3ã€éœ€è¦åŒ…å«ã€README.mdã€‘æ–‡ä»¶ï¼Œå¯¹é¡¹ç›®ç»“æ„å’Œæ ¸å¿ƒä»£ç è¿›è¡Œè¯´æ˜ã€‚
4ã€åŒ…å«è¿è¡ŒDemoçš„å¿«æ·å…¥å£æ–‡ä»¶ã€‚
</code></pre>
<p>ç„¶åå°±çœ‹Cursorå‘æŒ¥äº†ï¼Œç¬¬ä¸€æ¬¡ç”Ÿæˆåè‚¯å®šè·‘ä¸é€šï¼Œéœ€è¦ä¸åœçš„è®©cursorè¿›è¡Œè°ƒè¯•ï¼Œå› ä¸ºæ˜¯Demoæ€§è´¨çš„ï¼Œç›¸å¯¹ç®€å•ï¼Œé€»è¾‘ä¹Ÿä¸ä¼šå¤ªå¤æ‚ï¼Œä¸€èˆ¬åœ¨10è½®Promptäº¤äº’ä¹‹å†…å³å¯å¾—åˆ°Cursoråˆ›å»ºçš„å¯æ­£ç¡®è¿è¡Œçš„é¡¹ç›®ã€‚</p>
<p>æœ€åç»™å¤§å®¶æ¼”ç¤ºä¸‹ï¼Œç»™æˆ‘ç”Ÿæˆçš„é¡¹ç›®æ˜¯ä»€ä¹ˆåŠŸèƒ½ï¼š</p>
<p>ç»™æˆ‘ç”Ÿæˆäº†ä¸€ä¸ªã€run_demo.pyã€‘å…¥å£æ–‡ä»¶ï¼Œ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2bc106630c1442acb5758c11bb9a0831~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=bknEa%2FanY5h6%2F8NVe7wHkjOTtvU%3D" alt="" loading="lazy"/></p>
<p>ç”¨pythonå‘½ä»¤è¿è¡Œï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d90da2840b474dd78d07cb1ad47ba114~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=ERsHDl9McnXxfsoYC9j3kNpUDYA%3D" alt="" loading="lazy"/></p>
<p>æˆ‘é€‰æ‹©ã€1ã€‘ï¼Œç„¶åè¾“å…¥æˆ‘çš„é—®é¢˜ï¼šå¤©ç©ºä¸ºä»€ä¹ˆæ˜¯è“è‰²çš„</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e55795c84684059b65493b9ef5796b4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=j%2FkRyaVs0K4U3iDSUz8m2SkGbLA%3D" alt="" loading="lazy"/></p>
<p>ç„¶åæ ¹æ®æˆ‘çš„é—®é¢˜ï¼ŒDemoä¼šè¯†åˆ«ä¸»é¢˜æ˜¯æˆ‘çš„é—®é¢˜æ˜¯ä¸€ä¸ªç®€å•çš„é—®ç­”ã€general_chatã€‘ï¼Œè°ƒç”¨æ¨¡å‹ç»™æˆ‘å›å¤äº†ç­”æ¡ˆã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯¹æ•°æ®è¿›è¡Œäº†åˆ†æï¼Œæœ€åç”Ÿæˆäº†ä¸€ä¸ªå¯è§†åŒ–å›¾è¡¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8bfb42312eec4ce2b5037a9fb1cab21b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=uG037WDrEAiGaRshghd0iyyoUig%3D" alt="" loading="lazy"/></p>
<p>å›¾è¡¨ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b1733d00cbd4b79bffb1341c61d0350~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=JJgHwnMLmC9yeNZlfc4rEhcFHOs%3D" alt="" loading="lazy"/></p>
<p>ç„¶åï¼Œæˆ‘ç»§ç»­æµ‹è¯•ï¼Œæ¢ä¸€ä¸ªé—®é¢˜ï¼Œé—®ä¸€ä¸ªéœ€è¦è”ç½‘æœç´¢çš„ï¼Œä¾‹å¦‚æˆ‘æé—®ï¼šè¯·å¸®æˆ‘æœç´¢ä»Šå¤©çš„çƒ­ç‚¹AIæ–°é—»æœ‰å“ªäº›ã€‚ç„¶åä»–å°±ä¼šè¯†åˆ«ä¸ºã€Searchã€‘ä¸»é¢˜ï¼Œç»™æˆ‘è”ç½‘æœç´¢ç”Ÿæˆç»“æœï¼Œå¯¹æ•°æ®è¿›è¡Œåˆ†æåç”Ÿæˆå¯è§†åŒ–å›¾è¡¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c47af2e3fef349d39d3557266648a98c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=eFNJTXU4GE6QZULR1TZqMIdU9yQ%3D" alt="" loading="lazy"/></p>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘çš„Demoå°±æ¼”ç¤ºå®Œäº†ï¼Œç„¶åå‘¢ï¼Œå¦‚ä½•æ–¹ä¾¿ä½ å¿«é€Ÿäº†è§£é¡¹ç›®å‘¢ï¼Œå½“ç„¶ä»è®©å…¶ç”Ÿæˆçš„ã€README.mdã€‘æ–‡ä»¶äº†ã€‚</p>
<p>Readmeä¸­ä»‹ç»äº†é¡¹ç›®çš„åŸºæœ¬åŠŸèƒ½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e0ab7820f2740db8854c52123a97c44~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=5WqvtDUIDL1EUNQL%2BrX6SRPGsDc%3D" alt="" loading="lazy"/></p>
<p>å¯¹é¡¹ç›®çš„è°ƒç”¨æµç¨‹è¿›è¡Œäº†è¯´æ˜ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/070314dcec8845fd85ffb3b55d3fadfa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=rk4Y2%2FhWPAWL47rmGN0Afh2ePM0%3D" alt="" loading="lazy"/></p>
<p>è¯´æ˜äº†é¡¹ç›®åœ¨å“ªä½¿ç”¨äº†LangChainï¼Œéƒ½åšäº†ä»€ä¹ˆï¼Œå¹¶ä¸”å¯¹åº”çš„ä»£ç æ˜¯å¤šå°‘è¡Œã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b0cfb3b8f2124cd088141d4f05780c7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=eB2oIIBTriU9T0vXkqypK9qCccA%3D" alt="" loading="lazy"/></p>
<p>è¿˜è¯´æ˜äº†é¡¹ç›®å“ªé‡Œä½¿ç”¨äº†LangGraphï¼Œéƒ½åšäº†ä»€ä¹ˆï¼Œå¹¶ä¸”å¯¹åº”çš„ä»£ç æ˜¯å¤šå°‘è¡Œã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a0aeb4bb0c346ed8b116be2f473298b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=7lrRX0KnEN7bBttJFTuchlvhP20%3D" alt="" loading="lazy"/></p>
<p>å…·ä½“ä¸è¯¦ç»†ä»‹ç»äº†ï¼Œç»™æˆ‘ç”Ÿæˆçš„Readmeä¸­å·²ç»å†™çš„å¾ˆè¯¦ç»†äº†ï¼Œå®Œå…¨å¯ä»¥çœ‹æ‡‚ï¼Œä¸‹é¢æ€»ç»“è¯´æ˜ä¸‹ï¼Œç»™æˆ‘ç”Ÿæˆçš„Demoä»£ç å“ªäº›åœ°æ–¹ç”¨åˆ°äº†LangChainï¼Œå“ªäº›åœ°æ–¹ç”¨åˆ°äº†LangGraphã€‚</p>
<p>LangChainç›¸å…³ï¼š</p>
<ul>
<li>ä½¿ç”¨LangChainä¸­ChatDeepSeekä¸æ¨¡å‹è¿›è¡Œäº¤äº’ã€‚</li>
<li>é›†æˆLangChainä¸­TavilySearchå·¥å…·è¿›è¡Œæœç´¢ã€‚</li>
<li>ä½¿ç”¨langchain_core.messagesç»Ÿä¸€æ¶ˆæ¯æ ¼å¼ã€‚</li>
</ul>
<p>LangGraphç›¸å…³ï¼š</p>
<ul>
<li>è¿›è¡ŒçŠ¶æ€ç®¡ç†ã€‚</li>
<li>è¿›è¡Œå·¥ä½œæµç¼–æ’ã€‚</li>
<li>è¿›è¡ŒçŠ¶æ€ä¼ é€’ã€‚</li>
</ul>
<p>åˆ°æ­¤ä¸ºæ­¢ï¼Œç»™å¤§å®¶æ¼”ç¤ºäº†Cursorç»™æˆ‘ç”Ÿæˆçš„LangChain&amp;LangGraph Demoã€‚</p>
<p>6ã€Langgraph-cliå’ŒLangSmithçš„ä½¿ç”¨</p>
<p>ä¸‹é¢æˆ‘ä»¬ç»§ç»­ï¼Œåœ¨æ§åˆ¶å°å®‰è£…åº“langgraph-cliï¼Œæ–¹ä¾¿åç»­è°ƒè¯•å’Œç”¨LangSmithæ¥è¿½è¸ªæˆ‘ä»¬çš„é¡¹ç›®ã€‚å®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">pip3 install -U <span class="hljs-string">"langgraph-cli[inmem]"</span>
</code></pre>
<p>å®‰è£…åè¾“å…¥ä¸‹é¢å‘½ä»¤å¯åŠ¨é¡¹ç›®ï¼š</p>
<pre><code class="hljs">langgraph dev
</code></pre>
<p>å¯åŠ¨åä¼šå‘ç°æœ‰ä¸‰ä¸ªé‡è¦çš„è·¯å¾„ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªæ˜¯å¯ä»¥æ‰“å¼€çš„ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a1d3bacfd3d4b708162ddb1bd6ae90d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=rBI585MZuRUPtuqzrZ%2Fq7rpknK4%3D" alt="" loading="lazy"/></p>
<p>ç¬¬ä¸€ä¸ªæ˜¯é¡¹ç›®APIçš„Endpointï¼Œæ‰“å¼€åæ˜¾ç¤ºNot Foundï¼Œè¿™æ˜¯æ­£å¸¸çš„ã€‚å› ä¸ºé»˜è®¤æ²¡æœ‰è¿™ä¸ªgetè¯·æ±‚ï¼Œä¸ä¼šé‡å®šå‘åˆ°ä»»ä½•åœ°æ–¹ï¼Œä½†æ˜¯æ—¢ç„¶æœ‰ç»“æœè¿”å›ï¼Œè¯´æ˜APIçš„Endpointæ˜¯é€šçš„ã€‚</p>
<p><a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A2024%2F" target="_blank" title="http://127.0.0.1:2024/" ref="nofollow noopener noreferrer">http://127.0.0.1:2024</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f61df5922434a02813215566939982f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=PdmiY3Xk38sBw50ikjdkpmLsyjE%3D" alt="" loading="lazy"/></p>
<p>ç¬¬ä¸‰ä¸ªå¯ä»¥æ‰“å¼€ï¼Œæ‰“å¼€åæ˜¯LangGraphçš„APIæ–‡æ¡£è¯´æ˜ï¼Œå¹¶ä¸”å¯ä»¥åœ¨çº¿æµ‹è¯•APIï¼Œè¿™é‡Œå°±ä¸ç»™å¤§å®¶æ¼”ç¤ºäº†ï¼Œå¾ˆç®€å•ã€‚</p>
<p><a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A2024%2Fdocs" target="_blank" title="http://127.0.0.1:2024/docs" ref="nofollow noopener noreferrer">http://127.0.0.1:2024/docs</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ea611d93c40400b9ff462b1a7e0751f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=9lw7S9wl5xVtEdY4P8XT5FPfRPg%3D" alt="" loading="lazy"/></p>
<p>ä½†æ˜¯ç¬¬äºŒä¸ªéœ€è¦ç‰¹æ®Šè¯´æ˜ï¼Œæˆ‘ä»¬è·¯å¾„å¯ä»¥æ‰“å¼€ï¼Œä½†æ˜¯è·å–ä¸åˆ°é¡¹ç›®çš„å†…å®¹ï¼Œè¿™ä¸ªè‚¯å®šæ˜¯ä¸æ­£å¸¸çš„ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fsmith.langchain.com%2Fstudio%2F%3FbaseUrl%3Dhttp%3A%2F%2F127.0.0.1%3A2024" target="_blank" title="https://smith.langchain.com/studio/?baseUrl=http://127.0.0.1:2024" ref="nofollow noopener noreferrer">smith.langchain.com/studio/?basâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b8694cace6e5445d9f44a9c0ee380ef2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=TkcQJLCGmsIXd0qdnrqT0xwPaXg%3D" alt="" loading="lazy"/></p>
<p>æœ‰ä¸€å®šè½¯ä»¶åŸºç¡€èƒ½åŠ›çš„äººå¾ˆå®¹æ˜“å¯ä»¥åˆ¤æ–­å‡ºæ¥ï¼Œå› ä¸ºä¸‹é¢è¿™ä¸ªè·¯å¾„è·¨åŸŸäº†ï¼Œsmithå¹³å°æ˜¯ä¸å¯èƒ½è·å–ä½ æœ¬åœ°æœåŠ¡API EndPointçš„ï¼Œè®¿é—®ä¸äº†å¾ˆæ­£å¸¸ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fsmith.langchain.com%2Fstudio%2F%3FbaseUrl%3Dhttp%3A%2F%2F127.0.0.1%3A2024" target="_blank" title="https://smith.langchain.com/studio/?baseUrl=http://127.0.0.1:2024" ref="nofollow noopener noreferrer">smith.langchain.com/studio/?basâ€¦</a></p>
<p>æ‰€ä»¥ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æ”¹ä¸€ä¸‹å¯åŠ¨çš„å‘½ä»¤ï¼Œä½¿ç”¨ä¸‹é¢å‘½ä»¤å¯åŠ¨ï¼š</p>
<pre><code class="hljs language-css" lang="css">langgraph dev <span class="hljs-attr">--tunnel</span>
</code></pre>
<p>è¿™æ¬¡å¯åŠ¨åå¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œè·¯å¾„æ›´é•¿äº†ï¼Œè€Œä¸”å¹¶ä¸æ˜¯ä¹‹å‰æœ¬åœ°çš„ipäº†ï¼Œè€Œæ˜¯æ¢æˆå…¬ç½‘å¯è®¿é—®çš„cloudflareçš„åœ°å€ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fsmith.langchain.com%2Fstudio%2F%3FbaseUrl%3Dhttps%3A%2F%2Fjournalists-utilities-magnetic-seemed.trycloudflare.com" target="_blank" title="https://smith.langchain.com/studio/?baseUrl=https://journalists-utilities-magnetic-seemed.trycloudflare.com" ref="nofollow noopener noreferrer">smith.langchain.com/studio/?basâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/985e7b107a1444299457130ea4ac58b3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=BWTaRVsQ8ww4pxMREk%2BZa9EmJLs%3D" alt="" loading="lazy"/></p>
<p>è¿™æ ·ï¼Œlangsmithå¹³å°å°±å¯ä»¥æ­£å¸¸åœ°åŠ è½½äº†ã€‚åŠ è½½åå¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œä½ ä¹Ÿçš„ä¸šåŠ¡æµç¨‹å®Œå…¨å˜æˆäº†å¯è¿½è¸ªçš„å¯è§†åŒ–å·¥ä½œæµã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/235365a7587f4d8a8147b895b63ec096~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=3JGYw3Qqt97mx1Xgb05brFyrOVw%3D" alt="" loading="lazy"/></p>
<p>ç„¶åï¼Œæˆ‘å°±å¯ä»¥è¾“å…¥é—®é¢˜ï¼Œåœ¨è¿™ä¸ªå¹³å°ä¸Šè¿›è¡Œè°ƒè¯•ï¼Œä¾‹å¦‚åœ¨å¯¹åº”çš„ä¼ é€’å‚æ•°çš„åœ°æ–¹ï¼Œæˆ‘æé—®ï¼šå¤©ä¸ºä»€ä¹ˆä¼šä¸‹é›¨ï¼Œåœ¨æ­¤å¹³å°å°±å¯ä»¥è¿æ¥åˆ°ä½ æœ¬åœ°çš„å·¥ç¨‹ï¼Œè¿›è¡Œå¯è§†åŒ–è°ƒè¯•å’Œè¾“å‡ºäº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1fc9cbabcae945878ac3fa4db074fe53~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=1%2Bbdmuyp%2BlrTWAo4QkiAcYSu3VA%3D" alt="" loading="lazy"/></p>
<p>å¹¶ä¸”å¯ä»¥åˆ‡æ¢åˆ°ã€Traceã€‘é€‰é¡¹å¡æŸ¥çœ‹å…¶è¿è¡Œè½¨è¿¹ï¼Œè¿›è¡Œè¿½è¸ªã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/66e0b0a6ca104862859f966a3ab443e0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=6I%2FnW5WaVXGwLMEfG8X%2Fuq6h%2BpY%3D" alt="" loading="lazy"/></p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œç°åœ¨ä½ æŠŠè¿™ä¸ªé¡µé¢å…³é—­ã€‚ç„¶åå†æ¬¡è¿›å…¥åˆ°LangSmithçš„ä¸»é¡µï¼Œç‚¹å‡»ã€Tracing Projectsã€‘ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°ä¹‹å‰è¿è¡Œè¿½è¸ªçš„è®°å½•ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9672ed6f2286409b8bb7b25d1aad4626~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=vMXofsZmcJQLFaRBFvavn%2BlqUwc%3D" alt="" loading="lazy"/></p>
<p>è¿™æ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿè¿™æ„å‘³ç€åªè¦ä½ ç”¨ã€langgraph devã€‘å¯åŠ¨äº†ä½ æœ¬åœ°çš„å·¥ç¨‹ï¼Œä½ åœ¨ä½•å¤„è®¿é—®ä½ çš„é¡¹ç›®ï¼Œéƒ½ä¼šè‡ªåŠ¨è¿›è¡Œè¡Œä¸ºè¿½è¸ªå¹¶ä¸”åœ¨LangSmithå¹³å°ä¸Šè¿›è¡ŒæŸ¥çœ‹ã€‚</p>
<p>è§£æƒ‘ï¼š</p>
<p>å¤§å®¶é€šè¿‡æˆ‘ä¸Šé¢çš„æ“ä½œï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰å¾ˆç¥å¥‡ï¼Œéƒ½ä¼šå­˜åœ¨è¿™ç§ç–‘é—®ï¼Œä¸æ˜¯ä¸€ç›´åœ¨è®²LangChainå—ï¼Œæ€ä¹ˆçªç„¶æ¥äº†LangSmithï¼Œå®ƒæ˜¯å¹²å˜›çš„ï¼Œæ„Ÿè§‰åƒå¯ä»¥è¿½è¸ªè¡Œä¸ºç”¨çš„ï¼Œé‚£æˆ‘çš„é¡¹ç›®ï¼Œåˆæ˜¯ä½•æ—¶ä¸LangSmithå¹³å°è¿›è¡Œçš„è”ç³»å‘¢ï¼Ÿ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c557705d05f48aebedab0e861ffef29~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=EXdyuP4W%2FiPKCy7hT2KI0TvuX%2Bs%3D" alt="" loading="lazy"/></p>
<p>LangSmithï¼šå…¶å®æˆ‘ä¸ç”¨è¿‡å¤šè§£é‡Šï¼Œé€šè¿‡ä¸Šé¢çš„æ¼”ç¤ºå¤§å®¶ä¹Ÿèƒ½å¤Ÿæ„Ÿå—åˆ°ã€‚LangSmithå¤§å®¶ç†è§£æˆä¸€ä¸ªåœ¨çº¿ç›‘æ§å’Œè°ƒè¯•å¹³å°å³å¯ï¼Œæä¾›äº†åœ¨çº¿è°ƒè¯•Debugï¼ˆä¸Šé¢æ¼”ç¤ºçš„å·¥ä½œæµåœ¨çº¿è¾“å…¥ä¸ºä»€ä¹ˆä¼šä¸‹é›¨çš„ä¾‹å­ï¼Œå¯çœ‹åˆ°æµç¨‹ä¸­æ¯ä¸€æ­¥çš„ç»“æœï¼‰ã€Traceè¿½è¸ªï¼ˆä¸Šé¢ä¾‹å­ä¸­çš„è°ƒç”¨é“¾è·¯ï¼Œå¯è¿½æº¯ï¼‰ã€è¿˜æœ‰ç”Ÿäº§ç›‘æ§Monitoringï¼ˆä¸Šçº¿åè¿½è¸ªç”¨æˆ·çœŸå®äº¤äº’ï¼Œæ–¹ä¾¿åç»­ä¼˜åŒ–æ™ºèƒ½ä½“ï¼‰å’Œè¯„ä¼°Evaluationï¼ˆæ”¯æŒå¯¹ä¸ç”¨çš„Prompt/æ¨¡å‹/ABæµ‹è¯•/è´¨é‡ç­‰è¿›è¡Œè¯„ä¼°ï¼‰ã€‚</p>
<p>é‚£å¦‚ä½•å»ºç«‹çš„è”ç³»å‘¢ï¼Œå¤§å®¶æœ€æ—©åœ¨ä¸Šé¢è¿˜æœ‰å°è±¡å§ï¼Œè®©å¤§å®¶åœ¨ã€.envã€‘ä¸­é…ç½®äº†LangSmithçš„ç›¸å…³ä¿¡æ¯ï¼Œè€Œä¸”Tracingè¿˜è®¾ç½®ä¸ºäº†Trueã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/09f156afdedf49f390daa6a80c4e06f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=yU8wKEnKPzRJNjBk02EkBXXFgrk%3D" alt="" loading="lazy"/></p>
<p>åœ¨ç”Ÿæˆçš„ä»£ç é€»è¾‘ä¸­ï¼Œé€šè¿‡è¿™äº›å‚æ•°ï¼Œå°±è®©ä½ çš„å·¥ç¨‹ä¸LangSmithå¹³å°å…³è”ä¸Šäº†ã€‚</p>
<p>ä»£ç ä¸­å¼•å…¥è¿½è¸ªçš„æ³¨è§£ï¼Œåœ¨æƒ³è¿½è¸ªçš„æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£çš†å¯</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/744923bdde6340e2ad1676853be6c3ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=5O%2BysUWYxGkGvmx27h3w0NyWb9k%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be4126cec3f24ce8b1470f10688b8d0e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=aYt3OyNzjBt1PXzA889gcPnR7Y8%3D" alt="" loading="lazy"/></p>
<p>å®˜ç½‘å†™çš„æ›´æ˜¯è¯¦ç»†å¦‚ä½•æ¥å…¥ï¼ŒåŒ…æ‹¬æœªç»™å¤§å®¶æ¼”ç¤ºçš„è¯„ä¼°EvaluationåŠŸèƒ½ï¼Œåœ¨æ­¤ä¸è¯¦ç»†è§£é‡Šäº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c4bc3c2693d42128606f5b9b358e2c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=jodccnC9y1vcTMfjuLKBn4OTxgo%3D" alt="" loading="lazy"/></p>
<p>åˆ°è¿™é‡Œï¼Œæ‰ç®—æ˜¯ï¼ŒLangChainã€LangGraphå’ŒLangSmithè®²å®Œäº†ã€‚</p>
<p>7ã€æ‰©å±•éƒ¨åˆ†ï¼šagent-chat UIçš„ä½¿ç”¨</p>
<p>è¿™ä¸€éƒ¨åˆ†å±äºæ‹“å±•éƒ¨åˆ†ï¼Œåˆšæ‰æˆ‘ä»¬å†™çš„Agentäº‹å®ä¸Šæ˜¯æ²¡æœ‰UIçš„ã€‚LangChainç”Ÿæ€ä¹Ÿæ˜¯æƒ³åˆ°äº†è¿™ä¸€ç‚¹ï¼Œæ‰€ä»¥å®˜æ–¹è¿˜æ¨å‡ºäº†ä¸€ä¸ªAgent-Chatå¼€æºé¡¹ç›®ï¼Œå¯ä»¥å¿«é€Ÿæ„ç­‘UIï¼Œå…³è”åˆ°æˆ‘ä»¬åˆšæ‰æœ¬åœ°åˆ›å»ºçš„æ™ºèƒ½ä½“ã€‚</p>
<p>é¡¹ç›®åœ°å€ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flangchain-ai%2Fagent-chat-ui" target="_blank" title="https://github.com/langchain-ai/agent-chat-ui" ref="nofollow noopener noreferrer">github.com/langchain-aâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b5d3b2f3a8c4420c9fe8a05809f21c45~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=eUyMrS6hB6C3Lr72ieQ%2FejwE9uI%3D" alt="" loading="lazy"/></p>
<p>ä½¿ç”¨å’Œå®‰è£…ä¹Ÿæ˜¯éå¸¸çš„ç®€å•ï¼Œå®˜ç½‘ä¸Šå†™çš„å¾ˆæ¸…æ¥šï¼Œå…ˆcloneé¡¹ç›®åˆ°æœ¬åœ°ï¼Œç„¶åè¿›å…¥åˆ°é¡¹ç›®ç›®å½•åï¼Œé€šè¿‡ã€pnpm installã€‘è¿›è¡Œå®‰è£…ï¼Œé€šè¿‡ã€pnpm devã€‘å¯åŠ¨è¯¥é¡¹ç›®ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c28487968f1a4074b792a0205aed6e6b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=yEtyvnn0bYb7Ok%2BP4v4Vn5gUeKo%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bb836971bc584630a7cf437fc5b2d69c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=QzSgXlb3pEpe6dl2dlC%2FWRf9d%2BI%3D" alt="" loading="lazy"/></p>
<p>å¯åŠ¨æˆåŠŸåï¼Œå³å¯é€šè¿‡3000ç«¯å£è¿›è¡Œè®¿é—®ã€‚è®¿é—®åï¼Œä¸»é¡µé¢ä¸Šé…ç½®å¯åŠ¨æœ¬åœ°æœåŠ¡åœ°å€ã€é¡¹ç›®IDä¸LangSmith API Keyå³å¯è¿æ¥åˆ°æœ¬åœ°å¯åŠ¨çš„æ™ºèƒ½ä½“ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4d94e2b923a6463ba1ca3e23136d1c8c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=0BMgw8QhITy7cGMXxjhblWNmwXg%3D" alt="" loading="lazy"/></p>
<p>é…ç½®æˆåŠŸåï¼Œæˆ‘ä»¬å°±å¯ä»¥æ­£å¸¸æé—®äº†ï¼Œä¾‹å¦‚æˆ‘ä¸‹é¢é—®çš„ï¼šåœ°çƒä¸ºä»€ä¹ˆæ˜¯åœ†çš„ã€‚ç»™æˆ‘æ­£å¸¸å“åº”ï¼Œå¹¶ä¸”åœ¨åå°å·¥ç¨‹ä¸­ä¹Ÿè¿›è¡Œäº†æ•°æ®åˆ†æå’Œç”Ÿæˆäº†å›¾è¡¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3baba27d0fa941ab949a0e142f46fe54~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767423649&amp;x-signature=jjU%2B4kliChwKvbor%2F%2FQ6gxmh894%3D" alt="" loading="lazy"/></p>
<hr/>
<p>æ€»ç»“ä¸‹ä»Šå¤©çš„å†…å®¹ï¼Œæˆ‘ä»¬ä»0åˆ›å»ºäº†ä¸€ä¸ªç©ºçš„é¡¹ç›®ï¼Œå¹¶ä¸”å€ŸåŠ©äºCursorï¼Œè®©å…¶ç»™æˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ªLangChainå’ŒLangGraphçš„Demoï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å…³è”åˆ°äº†LangSmithå¹³å°è¿›è¡Œè°ƒè¯•å’Œè¿½è¸ªï¼Œæœ€åé€šè¿‡Agent-Chatå¿«é€Ÿæ„å»ºäº†UIå»ä½¿ç”¨ã€‚</p>
<h2 data-id="heading-0">å­¦ä¹ èµ„æºæ¨è</h2>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>