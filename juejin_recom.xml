<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[npm Classic Token ä½œåºŸåï¼ŒCI/CD è‡ªåŠ¨å‘åŒ…å¦‚ä½•æ”¹ï¼Ÿä¸€ä»½å®Œæ•´è¸©å‘å¤ç›˜]]></title>    <link>https://juejin.cn/post/7586969583783444486</link>    <guid>https://juejin.cn/post/7586969583783444486</guid>    <pubDate>2025-12-24T03:03:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586969583783444486" data-draft-id="7586994471738327083" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="npm Classic Token ä½œåºŸåï¼ŒCI/CD è‡ªåŠ¨å‘åŒ…å¦‚ä½•æ”¹ï¼Ÿä¸€ä»½å®Œæ•´è¸©å‘å¤ç›˜"/> <meta itemprop="keywords" content="GitHub,NPM,CI/CD"/> <meta itemprop="datePublished" content="2025-12-24T03:03:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨å¤œå¯»æ™´å¤©"/> <meta itemprop="url" content="https://juejin.cn/user/1943592288391496"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            npm Classic Token ä½œåºŸåï¼ŒCI/CD è‡ªåŠ¨å‘åŒ…å¦‚ä½•æ”¹ï¼Ÿä¸€ä»½å®Œæ•´è¸©å‘å¤ç›˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1943592288391496/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨å¤œå¯»æ™´å¤©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T03:03:23.000Z" title="Wed Dec 24 2025 03:03:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>æœ€è¿‘åœ¨ç»™ npm åŒ…åš CI å‘ç‰ˆæ—¶ï¼Œçªç„¶å¼€å§‹é¢‘ç¹å¤±è´¥ï¼Œnpm çš„æç¤ºä¹Ÿéå¸¸ç›´ç™½ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db658b389bec4f9c885dd11ec3859eed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5aSc5a-75pm05aSp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767150202&amp;x-signature=Ln1SXVSPP17UqRVDpX9voePXP%2B4%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p><strong>Classic tokens have been revoked.<br/>
Granular tokens are now limited to 90 days and require 2FA by default.<br/>
Update your CI/CD workflows to avoid disruption.</strong></p>
</blockquote>
<p>ä¸€å¥è¯æ€»ç»“å°±æ˜¯ï¼š</p>
<blockquote>
<p><strong>è€çš„ npm token æ–¹æ¡ˆï¼Œå·²ç»ä¸é€‚åˆ CI äº†ã€‚</strong></p>
</blockquote>
<p>ç°åœ¨å°±è®°å½•ä¸€æ¬¡å®Œæ•´çš„ CI/CD æ”¹é€ è¿‡ç¨‹ï¼ŒåŒ…å«ï¼š</p>
<ul>
<li>npm æ–°è§„åˆ™åˆ°åº•æ”¹äº†ä»€ä¹ˆ</li>
<li>CI ä¸ºä»€ä¹ˆä¼šçªç„¶å‘å¸ƒå¤±è´¥</li>
<li>è¿‡ç¨‹ä¸­é‡åˆ°çš„å‡ ä¸ªâ€œå¿…è¸©å‘â€</li>
<li>æœ€ç»ˆä¸€å¥—å¯é•¿æœŸè¿è¡Œçš„ GitHub Actions å‘åŒ…æ–¹æ¡ˆ</li>
</ul>
<hr/>
<h2 data-id="heading-1">ä¸€ã€npm è¿™æ¬¡åˆ°åº•åŠ¨äº†è°çš„è›‹ç³•ï¼Ÿ</h2>
<p>å…ˆè¯´ç»“è®ºï¼š</p>
<blockquote>
<p><strong>npm æ­£åœ¨å½»åº•åºŸå¼ƒâ€œé•¿æœŸæœ‰æ•ˆ token + npm loginâ€çš„å‘å¸ƒæ¨¡å‹ã€‚</strong></p>
</blockquote>
<p>æ ¸å¿ƒå˜åŒ–æœ‰ä¸‰ç‚¹ã€‚</p>
<h3 data-id="heading-2">1. Classic Token ä½œåºŸ</h3>
<p>ä»¥å‰æœ€å¸¸è§çš„åšæ³•æ˜¯ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">env:</span>
  <span class="hljs-attr">NODE_AUTH_TOKEN:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.NPM_TOKEN</span> <span class="hljs-string">}}</span>
</code></pre>
<p>è¿™ç§ <strong>Classic Token</strong>ï¼š</p>
<ul>
<li>é•¿æœŸæœ‰æ•ˆ</li>
<li>æ²¡æœ‰æ˜ç¡®æƒé™è¾¹ç•Œ</li>
<li>ä¸€æ—¦æ³„éœ²ï¼Œåæœå¾ˆä¸¥é‡</li>
</ul>
<p>ç°åœ¨ npm æ˜ç¡®è¡¨æ€ï¼š<br/>
<strong>Classic Token ä¸å†æ¨èï¼Œå¹¶ä¼šé€æ­¥å¤±æ•ˆã€‚</strong></p>
<hr/>
<h3 data-id="heading-3">2. Granular Token é»˜è®¤ 90 å¤© + 2FA</h3>
<p>æ–°çš„ Granular Tokenï¼š</p>
<ul>
<li>å¿…é¡»å¼€å¯ 2FA</li>
<li>é»˜è®¤ 90 å¤©è¿‡æœŸ</li>
<li>éå¸¸ä¸é€‚åˆæ— äººå€¼å®ˆçš„ CI</li>
</ul>
<p>ğŸ‘‰ è¿™æ„å‘³ç€ï¼š<br/>
<strong>å³ä½¿ä½ æ¢æˆ Granular Tokenï¼ŒCI ä¾ç„¶ä¸ç¨³å®šã€‚</strong></p>
<hr/>
<h3 data-id="heading-4">3. npm å¼€å§‹å¼ºåˆ¶æ¨å¹¿ provenanceï¼ˆä¾›åº”é“¾æ ¡éªŒï¼‰</h3>
<p>è¿™æ˜¯æœ€å…³é”®ã€ä¹Ÿæ˜¯æœ€å®¹æ˜“è¢«å¿½ç•¥çš„ä¸€ç‚¹ã€‚</p>
<p>npm ç°åœ¨ä¼šæ ¡éªŒï¼š</p>
<ul>
<li>è¿™ä¸ªåŒ…æ˜¯ä¸æ˜¯åœ¨ GitHub Actions é‡Œå‘å¸ƒçš„</li>
<li>å‘å¸ƒå®ƒçš„ä»“åº“æ˜¯è°</li>
<li><code>package.json.repository</code> æŒ‡å‘å“ªé‡Œ</li>
<li>GitHub OIDC èº«ä»½æ˜¯å¦åŒ¹é…</li>
</ul>
<p>æ ¡éªŒå¤±è´¥ï¼Œç›´æ¥æ‹’ç»å‘å¸ƒã€‚</p>
<hr/>
<h2 data-id="heading-5">äºŒã€ä¸ºä»€ä¹ˆâ€œæ˜æ˜ç™»å½•äº†â€ï¼Œè¿˜æ˜¯å‘å¸ƒå¤±è´¥ï¼Ÿ</h2>
<p>æˆ‘ä»¬æœ€åˆé‡åˆ°çš„é”™è¯¯åŒ…æ‹¬ï¼š</p>
<h3 data-id="heading-6">âŒ ENEEDAUTH</h3>
<pre><code class="hljs language-vbnet" lang="vbnet">npm <span class="hljs-keyword">error</span> need auth This command requires you <span class="hljs-keyword">to</span> be logged <span class="hljs-keyword">in</span>
</code></pre>
<p>åŸå› å¾ˆç®€å•ï¼š</p>
<ul>
<li>CI é‡Œå·²ç»ä¸å†æ”¯æŒè€çš„ç™»å½•æ–¹å¼</li>
<li>token è¢«åˆ¤å®šä¸ºè¿‡æœŸæˆ– revoked</li>
</ul>
<hr/>
<h3 data-id="heading-7">âŒ 404 / E404</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-number">404</span> <span class="hljs-string">'@scope/package@x.y.z'</span> <span class="hljs-keyword">is</span> not <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span> registry
</code></pre>
<p>è¿™ä¸ªé”™è¯¯éå¸¸è¿·æƒ‘ï¼Œä½†æœ¬è´¨ä¸Šæ˜¯ï¼š</p>
<blockquote>
<p>npm <strong>æ‹’ç»äº†ä½ çš„å‘å¸ƒè¯·æ±‚</strong>ï¼Œå¹¶ä¸æ˜¯åŒ…ä¸å­˜åœ¨ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-8">âŒ 422 Unprocessable Entityï¼ˆæœ€å‘ï¼‰</h3>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-keyword">Error</span> verifying sigstore provenance bundle:
package.json: <span class="hljs-string">"repository.url"</span> <span class="hljs-built_in">is</span> <span class="hljs-string">""</span>
expected <span class="hljs-keyword">to</span> match <span class="hljs-string">"https://github.com/infinilabs/ci"</span>
</code></pre>
<p>è¿™ä¸€æ­¥ï¼Œå‡ ä¹æ˜¯æ‰€æœ‰äººéƒ½ä¼šè¸©çš„å‘ã€‚</p>
<hr/>
<h2 data-id="heading-9">ä¸‰ã€npm provenance æ ¡éªŒåœ¨æ ¡éªŒä»€ä¹ˆï¼Ÿ</h2>
<p>npm çš„é€»è¾‘æ˜¯ï¼š</p>
<blockquote>
<p><strong>æˆ‘ä¸åªè¦ä½ èƒ½å‘å¸ƒï¼Œæˆ‘è¿˜è¦çŸ¥é“ä½ æ˜¯ä»å“ªé‡Œå‘å¸ƒçš„ã€‚</strong></p>
</blockquote>
<p>å®ƒä¼šåšä¸€ç»„ä¸¥æ ¼åŒ¹é…ï¼š</p>





















<table><thead><tr><th>æ ¡éªŒé¡¹</th><th>æ¥æº</th></tr></thead><tbody><tr><td>GitHub Actions æ‰€åœ¨ä»“åº“</td><td>CI</td></tr><tr><td>OIDC èº«ä»½</td><td>GitHub</td></tr><tr><td><code>package.json.repository.url</code></td><td>åŒ…å…ƒæ•°æ®</td></tr></tbody></table>
<p>åªè¦æœ‰ä¸€ä¸ªä¸ä¸€è‡´ï¼š</p>
<p>ğŸ‘‰ <strong>422ï¼Œæ‹’ç»å‘å¸ƒã€‚</strong></p>
<hr/>
<h2 data-id="heading-10">å››ã€ä¸ºä»€ä¹ˆæ„å»ºäº§ç‰©é‡Œçš„ package.json ä¼šå‡ºé—®é¢˜ï¼Ÿ</h2>
<p>æˆ‘ä»¬çš„å‘å¸ƒæµç¨‹æ˜¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pnpm run build:web
<span class="hljs-built_in">cd</span> out/search-chat
npm publish
</code></pre>
<p>æ³¨æ„é‡ç‚¹ï¼š</p>
<blockquote>
<p><strong>çœŸæ­£ publish çš„ä¸æ˜¯æºç ç›®å½•ï¼Œè€Œæ˜¯æ„å»ºäº§ç‰©ç›®å½•ã€‚</strong></p>
</blockquote>
<p>å¾ˆå¤šé¡¹ç›®åœ¨ build åï¼š</p>
<ul>
<li><code>package.json</code> æ˜¯é‡æ–°ç”Ÿæˆçš„</li>
<li><code>repository</code> ä¸ºç©º</li>
<li>æˆ–æŒ‡å‘æºç ä»“åº“ï¼Œè€Œä¸æ˜¯ CI ä»“åº“</li>
</ul>
<p>è¿™åœ¨ npm provenance æ—¶ä»£ï¼Œç›´æ¥å°±æ˜¯æ­»åˆ‘ã€‚</p>
<hr/>
<h2 data-id="heading-11">äº”ã€æ­£ç¡®çš„ CI æ”¹é€ æ€è·¯</h2>
<p>ç›®æ ‡å¾ˆæ˜ç¡®ï¼š</p>
<blockquote>
<p><strong>ä¸ç”¨ npm tokenï¼Œä¸ç”¨ npm loginï¼Œè®© CI è‡ªå·±å®Œæˆèº«ä»½è®¤è¯ã€‚</strong></p>
</blockquote>
<p>æ ¸å¿ƒæ–¹æ¡ˆæ˜¯ï¼š</p>
<h3 data-id="heading-12">âœ… GitHub Actions + OIDC + npm provenance</h3>
<hr/>
<h2 data-id="heading-13">å…­ã€å…³é”®æ”¹é€ ç‚¹ä¸€ï¼šnpm è´¦æˆ·è®¾ç½®ä»¥åŠåŒ…è®¾ç½®</h2>
<p>npm è´¦æˆ·è®¾ç½®ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0491aa7642c341a3a9025ca1ccbb4a19~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5aSc5a-75pm05aSp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767150202&amp;x-signature=5m%2BZj4sReBExH13boTIQiv%2FaaL0%3D" alt="image.png" loading="lazy"/></p>
<p>npm å¯¹åº”åŒ…è®¾ç½®ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a84e5adbdb7e4295a93abf81d8e2912a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5aSc5a-75pm05aSp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767150202&amp;x-signature=qYmuoFdax0H7%2BdwfBz%2BzMaP6iNM%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/49fa14bd118f48db9fc5bbbc715928bf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5aSc5a-75pm05aSp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767150202&amp;x-signature=TAYMj4iKc2FFVACPfaX0UnvZaso%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-14">ä¸ƒã€å…³é”®æ”¹é€ ç‚¹äºŒï¼šå¼€å¯ OIDC æƒé™</h2>
<p>åœ¨ workflow é¡¶éƒ¨å¢åŠ ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">permissions:</span>
  <span class="hljs-attr">contents:</span> <span class="hljs-string">read</span>
  <span class="hljs-attr">id-token:</span> <span class="hljs-string">write</span>
</code></pre>
<p>è¿™ä¸€æ­¥éå¸¸å…³é”®ï¼š</p>
<ul>
<li><code>id-token: write</code> æ˜¯ npm provenance çš„å‰æ</li>
<li>æ²¡æœ‰å®ƒï¼Œnpm æ— æ³•éªŒè¯ CI èº«ä»½</li>
</ul>
<hr/>
<h2 data-id="heading-15">å…«ã€å…³é”®æ”¹é€ ç‚¹ä¸‰ï¼šå½»åº•ç§»é™¤ npm token</h2>
<p>æˆ‘ä»¬åšäº†ä¸‰ä»¶äº‹ï¼š</p>
<ul>
<li>åˆ é™¤ <code>NODE_AUTH_TOKEN</code></li>
<li>åˆ é™¤ <code>.npmrc</code></li>
<li>ä¸å†æ‰§è¡Œ <code>npm login</code></li>
</ul>
<p>CI é‡Œåªä¿ç•™ï¼š</p>
<pre><code class="hljs">npm publish
</code></pre>
<p>GitHub Actions ä¼šè‡ªåŠ¨ç”¨ OIDC èº«ä»½å’Œ npm é€šä¿¡ã€‚</p>
<hr/>
<h2 data-id="heading-16">ä¹ã€å…³é”®æ”¹é€ ç‚¹å››ï¼šä¿®æ­£æ„å»ºäº§ç‰©é‡Œçš„ repository</h2>
<p>åœ¨çœŸæ­£ publish å‰ï¼Œå¼ºåˆ¶ä¿®æ­£ <code>package.json</code>ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">jq <span class="hljs-comment">'.repository = {</span>
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"git"</span>,
  <span class="hljs-string">"url"</span>: <span class="hljs-string">"https://github.com/infinilabs/ci"</span>
}<span class="hljs-comment">' package.json &gt; tmp.json &amp;&amp; mv tmp.json package.json</span>
</code></pre>
<p>æ³¨æ„å‡ ä¸ªè¦ç‚¹ï¼š</p>
<ul>
<li>URL <strong>å¿…é¡»æ˜¯å½“å‰ CI æ‰€åœ¨ä»“åº“</strong></li>
<li>ä¸èƒ½æ˜¯æºç ä»“åº“</li>
<li>ä¸èƒ½ä¸ºç©º</li>
<li>å¿…é¡»æ˜¯ https GitHub åœ°å€</li>
</ul>
<hr/>
<h2 data-id="heading-17">åã€æœ€ç»ˆå‘å¸ƒæµç¨‹ï¼ˆæ ¸å¿ƒç‰‡æ®µï¼‰</h2>
<pre><code class="hljs language-bash" lang="bash">pnpm run build:web
<span class="hljs-built_in">cd</span> out/search-chat

<span class="hljs-comment"># ä¿®æ­£ repository</span>
jq <span class="hljs-string">'.repository = {
  "type": "git",
  "url": "https://github.com/infinilabs/ci"
}'</span> package.json &gt; tmp.json &amp;&amp; <span class="hljs-built_in">mv</span> tmp.json package.json

<span class="hljs-comment"># å‘å¸ƒ</span>
npm publish
</code></pre>
<p>å‘å¸ƒæˆåŠŸæ—¶ï¼Œnpm ä¼šè¾“å‡ºï¼š</p>
<ul>
<li>provenance å·²ç­¾å</li>
<li>å·²å†™å…¥ sigstore transparency log</li>
</ul>
<hr/>
<h2 data-id="heading-18">åä¸€ã€ä¸ºä»€ä¹ˆä¸ç›´æ¥å…³ provenanceï¼Ÿ</h2>
<p>npm æä¾›äº†ï¼š</p>
<pre><code class="hljs language-css" lang="css">npm publish <span class="hljs-attr">--no-provenance</span>
</code></pre>
<p>ä½†è¿™åªæ˜¯ä¸€ä¸ª <strong>ä¸´æ—¶é€‰é¡¹</strong>ï¼š</p>
<ul>
<li>å®˜æ–¹è¶‹åŠ¿æ˜¯é»˜è®¤å¼€å¯</li>
<li>æœªæ¥å¯èƒ½ç›´æ¥å¼ºåˆ¶</li>
<li>CI æ—©é€‚é…ï¼Œåé¢å°‘æŠ˜è…¾</li>
</ul>
<hr/>
<h2 data-id="heading-19">åäºŒã€è¿™æ¬¡æ”¹é€ åçš„æ”¶ç›Š</h2>
<p>æœ€ç»ˆæˆ‘ä»¬å¾—åˆ°çš„æ˜¯ä¸€å¥—ï¼š</p>
<ul>
<li>âœ… æ—  token</li>
<li>âœ… æ—  2FA äººå·¥å‚ä¸</li>
<li>âœ… ä¸ä¼šè¿‡æœŸ</li>
<li>âœ… å¯å®¡è®¡ã€å¯è¿½æº¯</li>
<li>âœ… ç¬¦åˆ npm å®˜æ–¹é•¿æœŸè·¯çº¿</li>
</ul>
<p>çœŸæ­£æ„ä¹‰ä¸Šçš„ <strong>æ— äººå€¼å®ˆ CI å‘åŒ…</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-20">åä¸‰ã€å°ç»“</h2>
<blockquote>
<p>npm ä¸å†ç›¸ä¿¡â€œä½ æ˜¯è°â€ï¼Œ<br/>
å®ƒåªç›¸ä¿¡ <strong>ä½ ä»å“ªé‡Œæ¥</strong>ã€‚</p>
</blockquote>
<p>åœ¨è¿™ä¸ªå‰æä¸‹ï¼Œ<br/>
<strong>OIDC + provenanceï¼Œä¸æ˜¯å¯é€‰é¡¹ï¼Œè€Œæ˜¯å¿…é€‰é¡¹ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ§© ä¸º AI æä¾›ä¸“ä¸šå¯ä¿¡çš„å·¥å…·ï¼Œå®ç°â€œæ€è·¯çŒœæƒ³â€]]></title>    <link>https://juejin.cn/post/7586994471738523691</link>    <guid>https://juejin.cn/post/7586994471738523691</guid>    <pubDate>2025-12-24T03:06:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586994471738523691" data-draft-id="7586974728579055635" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ§© ä¸º AI æä¾›ä¸“ä¸šå¯ä¿¡çš„å·¥å…·ï¼Œå®ç°â€œæ€è·¯çŒœæƒ³â€"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,LLM,AIGC"/> <meta itemprop="datePublished" content="2025-12-24T03:06:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ§© ä¸º AI æä¾›ä¸“ä¸šå¯ä¿¡çš„å·¥å…·ï¼Œå®ç°â€œæ€è·¯çŒœæƒ³â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T03:06:57.000Z" title="Wed Dec 24 2025 03:06:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ§­ ä¸€ã€AI çš„â€œæ€è·¯çŒœæƒ³â€æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>ç®€å•æ¥è¯´ï¼Œâ€œæ€è·¯çŒœæƒ³â€æ˜¯è®© AI ä¸åªå›ç­”é—®é¢˜ï¼Œè€Œæ˜¯èƒ½å¤Ÿ<strong>å»ºç«‹åˆç†çš„å‡è®¾ç©ºé—´</strong>ã€‚<br/>
äººç±»çš„å¤§è„‘åœ¨é¢å¯¹æœªçŸ¥é—®é¢˜æ—¶ï¼Œä¼šï¼š</p>
<ol>
<li>çŒœæµ‹å¯èƒ½çš„åŸå› ï¼›</li>
<li>é€šè¿‡é€»è¾‘æ’é™¤ï¼›</li>
<li>å¾—å‡ºæ–°çš„ç†è§£æˆ–æ–¹æ¡ˆã€‚</li>
</ol>
<p>AI è¦èƒ½åšè¿™ä»¶äº‹ï¼Œå°±å¿…é¡»æœ‰ä¸€ä¸ªã€Œå†…åœ¨éªŒè¯ç³»ç»Ÿã€â€”â€”<br/>
æ—¢èƒ½ç”Ÿæˆå‡è®¾ï¼Œåˆèƒ½éªŒè¯å‡è®¾ï¼Œè¿™å°±å˜æˆäº†**â€œæ€ç»´é—­ç¯â€**é—®é¢˜ã€‚</p>
<hr/>
<h2 data-id="heading-1">âš™ï¸ äºŒã€å¯ä¿¡å·¥å…·ï¼šè®© AI ä»â€œå˜´ç‚®å‹æ™ºèƒ½â€å˜æˆâ€œéªŒè¯å‹æ™ºèƒ½â€</h2>
<p>ç›®å‰çš„ WebAIGC ç³»ç»Ÿï¼Œå¤šæ•°åœç•™åœ¨â€œç”Ÿæˆâ€å±‚é¢ï¼š<br/>
å®ƒèƒ½å†™è¯—ã€ç¼–ç¨‹ã€å‡ºæ–¹æ¡ˆï¼Œä½†å®ƒå¹¶ä¸çŸ¥é“â€”â€”<strong>è‡ªå·±è¯´çš„å¯¹ä¸å¯¹</strong>ã€‚</p>
<p>ä¸“ä¸šå¯ä¿¡å·¥å…·çš„å»ºè®¾ï¼Œå°±æ˜¯è¦è®© AI èƒ½åƒç§‘ç ”å·¥ä½œè€…é‚£æ ·ï¼š</p>
<blockquote>
<p><strong>æ¯ä¸€å¥è¯éƒ½æœ‰å‡ºå¤„ï¼Œæ¯ä¸€ä¸ªçŒœæƒ³èƒ½è¢«éªŒè¯ï¼Œæ¯ä¸€æ¬¡ç»“è®ºèƒ½è¢«é‡æ¼”ã€‚</strong></p>
</blockquote>
<p>å®ç°è¿™ä¸ªç›®æ ‡ï¼Œéœ€è¦æ„å»ºä¸‰ç±»æ ¸å¿ƒå·¥å…·ï¼š</p>





























<table><thead><tr><th>å·¥å…·ç±»å‹</th><th>åŠŸèƒ½å®šä½</th><th>ç±»æ¯”äººç±»æ€ç»´</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>ğŸ§  æ€ç»´å»ºæ¨¡å·¥å…·</td><td>å»ºç«‹é€»è¾‘å›¾è°±ï¼Œæ¢ç´¢å‡è®¾ä¹‹é—´çš„å…³ç³»</td><td>æ€ç»´å¯¼å›¾</td><td>Graph reasoning engines</td></tr><tr><td>ğŸ”¬ éªŒè¯å·¥å…·</td><td>å¯¹ç”Ÿæˆç»“æœè¿›è¡Œé€»è¾‘ä¸äº‹å®æ ¡éªŒ</td><td>å®éªŒä¸æ¨ç†</td><td>Truth-check API, Reliable sandbox</td></tr><tr><td>ğŸ“š æº¯æºå·¥å…·</td><td>è¿½è¸ªæ¯ä¸ªç”Ÿæˆç»“æœçš„æ¥æºä¸ä¾æ®</td><td>å­¦æœ¯å¼•ç”¨ç³»ç»Ÿ</td><td>Data lineage, Provenance Tracker</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-2">ğŸ§© ä¸‰ã€åº•å±‚æ€è·¯ï¼šä»ç®—æ³•è§’åº¦æ„å»ºå¯ä¿¡ä½“ç³»</h2>
<p>ä¸€ä¸ªå¯ä¿¡ AI å·¥å…·çš„åº•å±‚é€»è¾‘åº”è¯¥åƒè¿™æ ·ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ReasonAndVerify</span>(<span class="hljs-params">prompt</span>) {
  <span class="hljs-comment">// Step 1: ç”Ÿæˆåˆæ­¥å‡è®¾</span>
  <span class="hljs-keyword">const</span> hypothesis = <span class="hljs-keyword">await</span> <span class="hljs-variable constant_">AI</span>.<span class="hljs-title function_">generate</span>(prompt);

  <span class="hljs-comment">// Step 2: ä¸ºå‡è®¾å¯»æ‰¾è¯æ®</span>
  <span class="hljs-keyword">const</span> evidence = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Search</span>.<span class="hljs-title function_">database</span>(hypothesis.<span class="hljs-title function_">keyTerms</span>());

  <span class="hljs-comment">// Step 3: å»ºç«‹å› æœå…³ç³»è¯„åˆ†</span>
  <span class="hljs-keyword">const</span> score = <span class="hljs-title class_">LogicEngine</span>.evaluate(hypothesis, evidence);

  <span class="hljs-comment">// Step 4: è¾“å‡ºç»“æœ + å¯ä¿¡åº¦</span>
  <span class="hljs-keyword">return</span> {
    hypothesis,
    <span class="hljs-attr">confidence</span>: score &gt; <span class="hljs-number">0.8</span> ? <span class="hljs-string">"âœ… High"</span> : <span class="hljs-string">"âš ï¸ Medium"</span>,
    <span class="hljs-attr">references</span>: evidence.<span class="hljs-title function_">sourceList</span>()
  };
}
</code></pre>
<p>ğŸ’¡ è¿™æ®µä¼ªä»£ç ä½“ç°äº†ä¸€ä¸ªåŸåˆ™ï¼š</p>
<blockquote>
<p>â€œAIä¸è¯¥åªå›ç­”ï¼Œè€Œåº”<strong>è‡ªå¸¦æ€€ç–‘ç²¾ç¥</strong>ã€‚â€</p>
</blockquote>
<hr/>
<h2 data-id="heading-3">ğŸ§¬ å››ã€å¯ä¿¡ç³»ç»Ÿçš„â€œæŠ€æœ¯æ”¯æ¶â€ï¼šæ•°æ®â€”æ¨¡å‹â€”éªŒè¯é“¾</h2>
<p>åœ¨ç³»ç»Ÿè®¾è®¡å±‚é¢ï¼Œæˆ‘ä»¬å¸Œæœ› AI å…·å¤‡å¦‚ä¸‹ç»“æ„ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[ æ•°æ®æº ]</span>
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¨¡å‹æ€ç»´å±‚ â”‚ â€” è´Ÿè´£ç¼–ç»‡æ¨ç†é€»è¾‘ä¸çŒœæƒ³è·¯å¾„
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ éªŒè¯ä¸å®¡è®¡å±‚ â”‚ â€” è‡ªåŠ¨æŸ¥è¯å¹¶é‡åŒ–å¯ä¿¡åº¦
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
<span class="hljs-selector-attr">[ è¾“å‡ºå±‚ / å¯æº¯æºæŠ¥å‘Š ]</span>
</code></pre>
<p>è¿™ç§å¤šå±‚æ¶æ„ï¼Œæœ€ç»ˆè¦å®ç°ä¸€ä¸ªç›®æ ‡ï¼š<br/>
<strong>è®©AIä¸å†åªæ˜¯â€œè¯´çš„è‡ªä¿¡â€ï¼Œè€Œæ˜¯â€œè¯´çš„æœ‰æ®â€</strong> ã€‚</p>
<hr/>
<h2 data-id="heading-4">ğŸ“œ äº”ã€å“²å­¦å±‚é¢çš„éšå–»ï¼š</h2>
<p>AI çš„æ€è·¯çŒœæƒ³ç³»ç»Ÿï¼Œå…¶å®æ­£è¿½æ±‚ä¸€ç§â€œç†æ€§è‡ªè§‰â€ã€‚</p>
<p>äººç±»åœ¨åšç§‘ç ”æ—¶ï¼Œæ°¸è¿œæœ‰ä¸¤ä¸ªè¿‡ç¨‹ï¼š</p>
<ul>
<li>æƒ³ â†’ åˆ›é€ å‡è®¾</li>
<li>è¯ â†’ éªŒè¯å‡è®¾</li>
</ul>
<p>è€Œå¯ä¿¡ AI çš„æœªæ¥è·¯å¾„ï¼Œæ˜¯è®©æœºå™¨ä¹Ÿå…·å¤‡ï¼š</p>
<blockquote>
<p>â€œæ€æƒ³çš„è°¦å‘ + é€»è¾‘çš„åšå®šã€‚â€</p>
</blockquote>
<p>è¿™å°±åƒæˆ‘ä»¬åœ¨ JS é‡Œå†™ä¸‹è¿™æ ·çš„å®ˆå¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">thinkingAI</span>(<span class="hljs-params">idea</span>) {
  <span class="hljs-keyword">if</span> (!idea.<span class="hljs-title function_">hasEvidence</span>()) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">"ğŸ¤” Hypothesis lacks evidence. Seeking verification..."</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-variable constant_">AI</span>.<span class="hljs-title function_">seekFacts</span>(idea);
  }
  <span class="hljs-keyword">return</span> idea;
}
</code></pre>
<hr/>
<h2 data-id="heading-5">ğŸŒ± å…­ã€ä»å·¥å…·åˆ°æ–‡æ˜ï¼šä¸ºä»€ä¹ˆâ€œå¯ä¿¡â€æ‰æ˜¯é•¿æœŸä»·å€¼</h2>
<p>æ²¡æœ‰å¯ä¿¡åº¦çš„ AIï¼Œå°±åƒæ²¡æœ‰å®éªŒå®¤æ ‡å‡†çš„ç§‘å­¦ç ”ç©¶â€”â€”<br/>
çŸ­æœŸå†…èƒ½å¤Ÿå¸å¼•æ³¨æ„åŠ›ï¼Œé•¿æœŸæ¥çœ‹åªä¼šåˆ¶é€ å™ªéŸ³ã€‚</p>
<p>WebAIGC çš„æœ€ç»ˆä½¿å‘½ï¼Œä¸æ˜¯ç”Ÿæˆæ¼‚äº®çš„ç»“æœï¼Œè€Œæ˜¯ï¼š</p>
<blockquote>
<p><strong>è®©æ™ºèƒ½æˆä¸ºç¤¾ä¼šå…±è¯†çš„ä¸€éƒ¨åˆ†ã€‚</strong></p>
</blockquote>
<p>å¯ä¿¡å·¥å…·çš„æ„ä¹‰ä¸åªæ˜¯æŠ€æœ¯é—®é¢˜ï¼Œå®ƒæ˜¯æ–‡æ˜çš„é˜²ç«å¢™ã€‚</p>
<hr/>
<h2 data-id="heading-6">ğŸ ä¸ƒã€æ€»ç»“ï¼šå¯ä¿¡ AI çš„å››åŸåˆ™</h2>






























<table><thead><tr><th>åŸåˆ™</th><th>å«ä¹‰</th><th>è½åœ°å½¢æ€</th></tr></thead><tbody><tr><td>ğŸ”— æº¯æº</td><td>æ˜ç¡®æ¯ä¸ªç”Ÿæˆç»“æœçš„æ•°æ®æ¥æº</td><td>æ•°æ®è¿½è¸ªç³»ç»Ÿ</td></tr><tr><td>âœ… å¯éªŒè¯</td><td>ç»“æœå¯é‡å¤ã€å¯å®¡è®¡</td><td>ç‹¬ç«‹éªŒè¯ API</td></tr><tr><td>âš–ï¸ é€æ˜</td><td>æ¨¡å‹å£°æ˜ã€åå·®å¯è§</td><td>Model card</td></tr><tr><td>ğŸ¤ äººæœºååŒ</td><td>è®©äººç±»å‚ä¸åˆ¤æ–­é“¾</td><td>äººæœºå®¡è®®ç•Œé¢</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Redis Luaè„šæœ¬ç¼–ç¨‹ï¼šæå‡åŸå­æ€§æ“ä½œä¸æ€§èƒ½çš„ç§˜å¯†æ­¦å™¨]]></title>    <link>https://juejin.cn/post/7586941997195149364</link>    <guid>https://juejin.cn/post/7586941997195149364</guid>    <pubDate>2025-12-24T03:11:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586941997195149364" data-draft-id="7490784514842263602" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Redis Luaè„šæœ¬ç¼–ç¨‹ï¼šæå‡åŸå­æ€§æ“ä½œä¸æ€§èƒ½çš„ç§˜å¯†æ­¦å™¨"/> <meta itemprop="keywords" content="Redis,æ•°æ®åº“,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2025-12-24T03:11:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Goé«˜å¹¶å‘æ¶æ„_ç‹å·¥"/> <meta itemprop="url" content="https://juejin.cn/user/446863555701561"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Redis Luaè„šæœ¬ç¼–ç¨‹ï¼šæå‡åŸå­æ€§æ“ä½œä¸æ€§èƒ½çš„ç§˜å¯†æ­¦å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/446863555701561/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Goé«˜å¹¶å‘æ¶æ„_ç‹å·¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T03:11:01.000Z" title="Wed Dec 24 2025 03:11:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»22åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">1. å¼•è¨€</h4>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªç”µå•†ç³»ç»Ÿï¼Œä¿ƒé”€æ´»åŠ¨åˆšä¸€ä¸Šçº¿ï¼Œåº“å­˜å´å› ä¸ºå¹¶å‘è¯·æ±‚ç¬é—´å˜æˆäº†è´Ÿæ•°ï¼›æˆ–è€…ä½ åœ¨ä¼˜åŒ–ä¸€ä¸ªå®æ—¶æ’è¡Œæ¦œï¼Œé¢‘ç¹çš„Rediså‘½ä»¤è°ƒç”¨è®©ç½‘ç»œå¼€é”€æ‹–æ…¢äº†æ•´ä¸ªæœåŠ¡ã€‚è¿™äº›é—®é¢˜å¬èµ·æ¥æ˜¯ä¸æ˜¯æœ‰ç‚¹è€³ç†Ÿï¼Ÿä½ å¯èƒ½å·²ç»ç†Ÿç»ƒæŒæ¡äº†Redisçš„åŸºç¡€æ“ä½œï¼Œæ¯”å¦‚<code>SET</code>ã€<code>GET</code>ã€<code>INCR</code>ï¼Œç”šè‡³ç”¨è¿‡<code>MULTI/EXEC</code>æ¥ä¿è¯äº‹åŠ¡æ€§ï¼Œä½†é¢å¯¹é«˜å¹¶å‘å’Œå¤æ‚é€»è¾‘æ—¶ï¼Œæ€»æ„Ÿè§‰è¿˜å·®äº†ç‚¹â€œç«å€™â€ã€‚åˆ«æ€¥ï¼Œä»Šå¤©æˆ‘ä»¬è¦èŠçš„Redis Luaè„šæœ¬ç¼–ç¨‹ï¼Œæˆ–è®¸å°±æ˜¯ä½ ä¸€ç›´åœ¨å¯»æ‰¾çš„é‚£æŠŠâ€œç§˜å¯†æ­¦å™¨â€ã€‚</p>
<p>Redis Luaè„šæœ¬æ˜¯ä¸€ç§å†…ç½®äºRedisçš„é«˜çº§åŠŸèƒ½ï¼Œé€šè¿‡EVALå‘½ä»¤è°ƒç”¨Luaè§£é‡Šå™¨ï¼Œè®©ä½ å¯ä»¥åœ¨æœåŠ¡ç«¯æ‰§è¡Œè‡ªå®šä¹‰é€»è¾‘ã€‚å®ƒä¸ä»…èƒ½ä¿è¯æ“ä½œçš„åŸå­æ€§ï¼Œè¿˜èƒ½å¤§å¹…å‡å°‘ç½‘ç»œå¾€è¿”å¼€é”€ï¼Œä»è€Œæå‡æ€§èƒ½ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒå°±åƒä¸€ä¸ªâ€œé­”æ³•ç›’å­â€ï¼ŒæŠŠå¤šæ¡å‘½ä»¤æ‰“åŒ…æˆä¸€ä¸ªåŸå­æ“ä½œï¼Œæ—¢å®‰å…¨åˆé«˜æ•ˆã€‚å¯¹äºé‚£äº›å·²ç»æœ‰1-2å¹´Redisä½¿ç”¨ç»éªŒã€å¸Œæœ›æ›´è¿›ä¸€æ­¥çš„å¼€å‘è€…æ¥è¯´ï¼ŒLuaè„šæœ¬æ— ç–‘æ˜¯å€¼å¾—æ·±å…¥æ¢ç´¢çš„å®è—ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« çš„ç›®æ ‡å¾ˆæ˜ç¡®ï¼šå¸¦ä½ ä»å…¥é—¨åˆ°å®æˆ˜ï¼Œæ­ç¤ºRedis Luaè„šæœ¬çš„æ ¸å¿ƒä¼˜åŠ¿ï¼Œå¹¶ç»“åˆæˆ‘åœ¨å®é™…é¡¹ç›®ä¸­çš„ç»éªŒï¼Œåˆ†äº«ä¸€äº›è¸©å‘æ•™è®­å’Œè§£å†³æ–¹æ¡ˆã€‚æˆ‘ä»¬ä¼šä»åŸºç¡€çŸ¥è¯†è®²èµ·ï¼Œé€æ­¥å‰–æå®ƒçš„åŸå­æ€§å’Œæ€§èƒ½ä¼˜åŠ¿ï¼Œå†é€šè¿‡å‡ ä¸ªå…¸å‹åœºæ™¯å±•ç¤ºå®ƒçš„å¨åŠ›ï¼Œæœ€åæ€»ç»“ä¸€äº›å®ç”¨å»ºè®®ã€‚æ— è®ºä½ æ˜¯æƒ³è§£å†³å¹¶å‘ç«äº‰é—®é¢˜ï¼Œè¿˜æ˜¯å¸Œæœ›ä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½ï¼Œè¿™ç¯‡æ–‡ç« éƒ½ä¼šç»™ä½ ä¸€äº›å¯å‘ã€‚å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬ä¸€èµ·æ‰“å¼€Redis Luaè„šæœ¬çš„â€œé­”æ³•ä¹¦â€ï¼Œçœ‹çœ‹å®ƒåˆ°åº•èƒ½ä¸ºæˆ‘ä»¬å¸¦æ¥ä»€ä¹ˆæƒŠå–œï¼</p>
<p><strong>è¿‡æ¸¡åˆ°ä¸‹ä¸€èŠ‚</strong>ï¼šåœ¨æ­£å¼è¿›å…¥å®æˆ˜ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆä»åŸºç¡€æ‰“èµ·ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä¼šå¸¦ä½ å¿«é€Ÿäº†è§£Redis Luaè„šæœ¬æ˜¯ä»€ä¹ˆï¼Œå®ƒå’Œä¼ ç»Ÿæ“ä½œæœ‰ä½•ä¸åŒï¼Œä»¥åŠå¦‚ä½•ç”¨ä¸€ä¸ªç®€å•ç¤ºä¾‹ä¸Šæ‰‹ã€‚åˆ«æ‹…å¿ƒï¼Œå³ä½¿ä½ æ²¡æ¥è§¦è¿‡Luaè¯­è¨€ï¼Œä¹Ÿèƒ½è½»æ¾è·Ÿä¸ŠèŠ‚å¥ã€‚</p>
<hr/>
<h4 data-id="heading-1">2. Redis Luaè„šæœ¬å…¥é—¨</h4>
<p>ä»å¼•è¨€ä¸­æˆ‘ä»¬å·²ç»çŸ¥é“ï¼ŒRedis Luaè„šæœ¬æ˜¯ä¸ªèƒ½è§£å†³å¹¶å‘å’Œæ€§èƒ½é—®é¢˜çš„â€œé­”æ³•ç›’å­â€ã€‚ä½†å…·ä½“æ¥è¯´ï¼Œå®ƒæ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆç”¨ï¼Ÿä¸ºä»€ä¹ˆå€¼å¾—æˆ‘ä»¬èŠ±æ—¶é—´å»å­¦ä¹ ï¼Ÿè¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†ä»é›¶å¼€å§‹ï¼Œå¸¦ä½ å¿«é€Ÿå…¥é—¨Redis Luaè„šæœ¬ç¼–ç¨‹ã€‚å³ä½¿ä½ å¯¹Luaè¯­è¨€ä¸€æ— æ‰€çŸ¥ï¼Œä¹Ÿèƒ½åœ¨å‡ åˆ†é’Ÿå†…ä¸Šæ‰‹ä¸€ä¸ªç®€å•çš„è„šæœ¬ã€‚</p>
<h5 data-id="heading-2">ä»€ä¹ˆæ˜¯Redis Luaè„šæœ¬ï¼Ÿ</h5>
<p>Redisä»2.6ç‰ˆæœ¬å¼€å§‹å†…ç½®äº†Lua 5.1è§£é‡Šå™¨ï¼Œé€šè¿‡<code>EVAL</code>å‘½ä»¤å…è®¸ç”¨æˆ·åœ¨æœåŠ¡ç«¯æ‰§è¡Œè‡ªå®šä¹‰è„šæœ¬ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒå°±åƒåœ¨Rediså†…éƒ¨åµŒäº†ä¸€ä¸ªå°å‹ç¼–ç¨‹ç¯å¢ƒï¼Œä½ å¯ä»¥ç”¨Luaè¯­è¨€å†™é€»è¾‘ï¼Œç›´æ¥æ“ä½œRedisçš„é”®å€¼æ•°æ®ã€‚ä¼ ç»Ÿçš„Redisæ“ä½œé€šå¸¸æ˜¯å®¢æˆ·ç«¯å‘é€ä¸€æ¡æ¡å‘½ä»¤ï¼Œæ¯”å¦‚<code>GET</code>ã€<code>SET</code>ï¼Œè€ŒLuaè„šæœ¬åˆ™æ˜¯æŠŠå¤šæ¡å‘½ä»¤æ‰“åŒ…æˆä¸€ä¸ªè„šæœ¬ï¼Œä¸€æ¬¡æ€§äº¤ç»™Redisæ‰§è¡Œã€‚</p>
<p>ä¸Redisçš„äº‹åŠ¡ï¼ˆå¦‚<code>MULTI/EXEC</code>ï¼‰ç›¸æ¯”ï¼ŒLuaè„šæœ¬æœ‰æ˜æ˜¾çš„ä¸åŒã€‚<code>MULTI/EXEC</code>è™½ç„¶ä¹Ÿèƒ½ç»„åˆå¤šæ¡å‘½ä»¤ï¼Œä½†æœ¬è´¨ä¸Šæ˜¯å®¢æˆ·ç«¯é©±åŠ¨çš„äº‹åŠ¡ï¼Œéœ€è¦å¤šæ¬¡ç½‘ç»œäº¤äº’ï¼Œè€Œä¸”åœ¨é«˜å¹¶å‘ä¸‹å®¹æ˜“å› ä¹è§‚é”å¤±è´¥è€Œé‡è¯•ã€‚è€ŒLuaè„šæœ¬æ˜¯æœåŠ¡ç«¯åŸå­æ‰§è¡Œçš„ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸ä¼šè¢«æ‰“æ–­ï¼Œå¤©ç„¶é€‚åˆå¹¶å‘åœºæ™¯ã€‚</p>
<h5 data-id="heading-3">ä¸ºä»€ä¹ˆè¦ç”¨Luaè„šæœ¬ï¼Ÿ</h5>
<p>ç”¨Luaè„šæœ¬ä¸»è¦æœ‰ä¸¤å¤§é©±åŠ¨åŠ›ï¼š<strong>åŸå­æ€§</strong>å’Œ<strong>æ€§èƒ½</strong>ã€‚</p>
<ul>
<li><strong>åŸå­æ€§</strong>ï¼šæƒ³è±¡ä½ åœ¨æ‰£å‡åº“å­˜ï¼Œå¦‚æœç”¨æ™®é€šå‘½ä»¤ï¼Œå…ˆ<code>GET</code>æ£€æŸ¥åº“å­˜ï¼Œå†<code>DECR</code>æ‰£å‡ï¼Œè¿™ä¸­é—´å¦‚æœæœ‰å¹¶å‘è¯·æ±‚æ’è¿›æ¥ï¼Œå°±å¯èƒ½å¯¼è‡´è¶…å–ã€‚è€ŒLuaè„šæœ¬æŠŠé€»è¾‘å°è£…æˆä¸€ä¸ªæ•´ä½“ï¼Œä¸€æ¬¡æ‰§è¡Œï¼Œé¿å…äº†è¿™ç§ç«äº‰ã€‚</li>
<li><strong>æ€§èƒ½</strong>ï¼šæ¯æ¬¡å®¢æˆ·ç«¯ä¸Redisé€šä¿¡éƒ½æœ‰ç½‘ç»œå¼€é”€ï¼ˆRTTï¼ŒRound-Trip Timeï¼‰ã€‚å¦‚æœä¸€ä¸ªä¸šåŠ¡éœ€è¦10æ¡å‘½ä»¤ï¼Œä¼ ç»Ÿæ–¹å¼è¦10æ¬¡å¾€è¿”ï¼Œè€ŒLuaè„šæœ¬åªéœ€è¦1æ¬¡ï¼Œæ•ˆç‡æå‡æ˜¾è€Œæ˜“è§ã€‚</li>
</ul>
<p>ä¸ºäº†ç›´è§‚å¯¹æ¯”ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªè¡¨æ ¼æ¥æ€»ç»“ï¼š</p>






























<table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>ä¼ ç»Ÿå‘½ä»¤ï¼ˆMULTI/EXECï¼‰</strong></th><th><strong>Luaè„šæœ¬</strong></th></tr></thead><tbody><tr><td>æ‰§è¡Œæ–¹å¼</td><td>å®¢æˆ·ç«¯åˆ†æ­¥å‘é€</td><td>æœåŠ¡ç«¯ä¸€æ¬¡æ€§æ‰§è¡Œ</td></tr><tr><td>åŸå­æ€§</td><td>ä¾èµ–ä¹è§‚é”ï¼Œæ˜“å¤±è´¥é‡è¯•</td><td>å¤©ç„¶åŸå­ï¼Œæ— ä¸­æ–­</td></tr><tr><td>ç½‘ç»œå¼€é”€</td><td>å¤šæ¬¡RTT</td><td>å•æ¬¡RTT</td></tr><tr><td>é€»è¾‘å¤æ‚åº¦</td><td>ç®€å•å‘½ä»¤ç»„åˆ</td><td>æ”¯æŒå¤æ‚é€»è¾‘ï¼ˆå¦‚å¾ªç¯ï¼‰</td></tr></tbody></table>
<h5 data-id="heading-4">å¿«é€Ÿä¸Šæ‰‹ç¤ºä¾‹</h5>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨ç¤ºä¾‹ï¼Œå®é™…æ„Ÿå—ä¸€ä¸‹Luaè„šæœ¬çš„é­…åŠ›ã€‚éœ€æ±‚æ˜¯ï¼šå®ç°ä¸€ä¸ªå¸¦ä¸Šé™çš„è®¡æ•°å™¨ï¼Œæ¯æ¬¡è°ƒç”¨åŠ 1ï¼Œä½†ä¸èƒ½è¶…è¿‡æŒ‡å®šé™åˆ¶ã€‚</p>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-comment">-- å¸¦ä¸Šé™çš„è®¡æ•°å™¨è„šæœ¬</span>
<span class="hljs-comment">-- KEYS[1]: è®¡æ•°å™¨çš„é”®å</span>
<span class="hljs-comment">-- ARGV[1]: ä¸Šé™å€¼</span>
<span class="hljs-keyword">local</span> key = KEYS[<span class="hljs-number">1</span>]              <span class="hljs-comment">-- ä»KEYSæ•°ç»„è·å–é”®å</span>
<span class="hljs-keyword">local</span> limit = <span class="hljs-built_in">tonumber</span>(ARGV[<span class="hljs-number">1</span>])  <span class="hljs-comment">-- ä»ARGVè·å–ä¸Šé™å¹¶è½¬ä¸ºæ•°å­—</span>
<span class="hljs-keyword">local</span> current = <span class="hljs-built_in">tonumber</span>(redis.call(<span class="hljs-string">'GET'</span>, key) <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>)  <span class="hljs-comment">-- è·å–å½“å‰å€¼ï¼Œé»˜è®¤0</span>
<span class="hljs-keyword">if</span> current &lt; limit <span class="hljs-keyword">then</span>          <span class="hljs-comment">-- åˆ¤æ–­æ˜¯å¦æœªè¾¾ä¸Šé™</span>
    redis.call(<span class="hljs-string">'INCR'</span>, key)      <span class="hljs-comment">-- æœªè¾¾ä¸Šé™åˆ™åŠ 1</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>                     <span class="hljs-comment">-- è¿”å›æˆåŠŸ</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>                     <span class="hljs-comment">-- å·²è¾¾ä¸Šé™ï¼Œè¿”å›å¤±è´¥</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p><strong>è°ƒç”¨æ–¹å¼</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">redis-cli EVAL <span class="hljs-string">"script content"</span> 1 mycounter 10
</code></pre>
<ul>
<li><code>1</code>è¡¨ç¤º1ä¸ªKEYï¼Œ<code>mycounter</code>æ˜¯é”®åï¼Œ<code>10</code>æ˜¯ä¸Šé™ã€‚</li>
<li>è¿”å›<code>1</code>è¡¨ç¤ºæˆåŠŸåŠ 1ï¼Œè¿”å›<code>0</code>è¡¨ç¤ºå·²è¾¾ä¸Šé™ã€‚</li>
</ul>
<p><strong>ä»£ç è§£æ</strong>ï¼š</p>
<ol>
<li><code>KEYS</code>å’Œ<code>ARGV</code>æ˜¯è„šæœ¬çš„ä¸¤ä¸ªè¾“å…¥å‚æ•°ï¼Œåˆ†åˆ«å­˜å‚¨é”®åå’Œé¢å¤–å‚æ•°ï¼Œæ•°ç»„ä»1å¼€å§‹ç´¢å¼•ã€‚</li>
<li><code>redis.call()</code>æ˜¯è°ƒç”¨Rediså‘½ä»¤çš„æ¥å£ï¼Œæ¯”å¦‚<code>redis.call('GET', key)</code>ç­‰ä»·äºå®¢æˆ·ç«¯çš„<code>GET key</code>ã€‚</li>
<li><code>tonumber()</code>ç¡®ä¿æ•°å€¼ç±»å‹å®‰å…¨ï¼Œé¿å…å­—ç¬¦ä¸²å¯¼è‡´é€»è¾‘é”™è¯¯ã€‚</li>
<li>è¿”å›å€¼ä¼šä¼ å›å®¢æˆ·ç«¯ï¼Œæ–¹ä¾¿åˆ¤æ–­ç»“æœã€‚</li>
</ol>
<p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†Luaè„šæœ¬çš„åŸºæœ¬ç»“æ„ï¼šè¾“å…¥å‚æ•°ã€Redisæ“ä½œã€é€»è¾‘åˆ¤æ–­å’Œè¿”å›å€¼ã€‚æ˜¯ä¸æ˜¯æ¯”ä½ æƒ³è±¡çš„ç®€å•ï¼Ÿ</p>
<p><strong>è¿‡æ¸¡åˆ°ä¸‹ä¸€èŠ‚</strong>ï¼šé€šè¿‡è¿™ä¸ªå°ä¾‹å­ï¼Œæˆ‘ä»¬å·²ç»è¿ˆå‡ºäº†Luaè„šæœ¬çš„ç¬¬ä¸€æ­¥ã€‚ä½†è¿™åªæ˜¯å¼€èƒƒèœï¼ŒLuaè„šæœ¬çœŸæ­£çš„å¨åŠ›åœ¨äºè§£å†³æ›´å¤æ‚çš„å¹¶å‘å’Œæ€§èƒ½é—®é¢˜ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨å®ƒçš„æ ¸å¿ƒä¼˜åŠ¿ï¼Œçœ‹çœ‹å®ƒå¦‚ä½•åœ¨åº“å­˜æ‰£å‡ã€æ€§èƒ½ä¼˜åŒ–ç­‰åœºæ™¯ä¸­å¤§æ˜¾èº«æ‰‹ã€‚</p>
<hr/>
<h4 data-id="heading-5">3. Luaè„šæœ¬çš„æ ¸å¿ƒä¼˜åŠ¿</h4>
<p>ä¸Šä¸€èŠ‚æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨ç¤ºä¾‹ï¼Œåˆæ­¥æ„Ÿå—äº†Redis Luaè„šæœ¬çš„ä¾¿æ·æ€§ã€‚ä½†å¦‚æœä»…ä»…åœç•™åœ¨â€œç®€å•å¥½ç”¨â€çš„å±‚é¢ï¼Œé‚£å°±å¤ªå°çœ‹å®ƒçš„æ½œåŠ›äº†ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼ŒLuaè„šæœ¬ä¹‹æ‰€ä»¥è¢«ç§°ä¸ºâ€œç§˜å¯†æ­¦å™¨â€ï¼Œæ˜¯å› ä¸ºå®ƒåœ¨<strong>åŸå­æ€§ä¿éšœ</strong>ã€<strong>æ€§èƒ½ä¼˜åŒ–</strong>å’Œ<strong>çµæ´»æ€§</strong>ä¸Šçš„è¡¨ç°å ªç§°æƒŠè‰³ã€‚è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†é€ä¸€æ‹†è§£è¿™ä¸‰å¤§ä¼˜åŠ¿ï¼Œç»“åˆä»£ç å’Œæ¡ˆä¾‹ï¼Œå¸¦ä½ çœ‹çœ‹å®ƒå¦‚ä½•åœ¨å¤æ‚åœºæ™¯ä¸­åŒ–ç¹ä¸ºç®€ã€‚</p>
<h5 data-id="heading-6">åŸå­æ€§ä¿éšœ</h5>
<p>åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œæ•°æ®ä¸€è‡´æ€§æ˜¯ä¸ªè€å¤§éš¾é—®é¢˜ã€‚æ¯”å¦‚ç”µå•†ç³»ç»Ÿä¸­çš„åº“å­˜æ‰£å‡ï¼Œå¦‚æœç”¨ä¼ ç»Ÿæ–¹å¼ï¼Œå…ˆ<code>GET</code>æ£€æŸ¥åº“å­˜ï¼Œå†ç”¨<code>SET</code>æˆ–<code>DECR</code>æ›´æ–°ï¼Œä¸­é—´çš„ç©ºéš™å¾ˆå®¹æ˜“è¢«å…¶ä»–è¯·æ±‚â€œé’»ç©ºå­â€ï¼Œå¯¼è‡´è¶…å–ã€‚Redisæä¾›äº†<code>WATCH/MULTI/EXEC</code>æ¥å®ç°ä¹è§‚é”ï¼Œä½†è¿™ç§æ–¹å¼åœ¨å¹¶å‘å‹åŠ›å¤§æ—¶ï¼Œå¤±è´¥é‡è¯•çš„æ¦‚ç‡ä¼šé£™å‡ï¼Œæ€§èƒ½åè€Œä¸‹é™ã€‚</p>
<p>Luaè„šæœ¬çš„æ€æ‰‹é”åœ¨äº<strong>æœåŠ¡ç«¯åŸå­æ‰§è¡Œ</strong>ã€‚æ•´ä¸ªè„šæœ¬ä½œä¸ºä¸€ä¸ªæ•´ä½“è¿è¡Œï¼Œä¸ä¼šè¢«å…¶ä»–å‘½ä»¤æ‰“æ–­ï¼Œå½»åº•æœç»äº†ç«äº‰æ¡ä»¶ã€‚æ¥çœ‹ä¸€ä¸ªåº“å­˜æ‰£å‡çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-comment">-- åº“å­˜æ‰£å‡è„šæœ¬</span>
<span class="hljs-comment">-- KEYS[1]: åº“å­˜é”®å</span>
<span class="hljs-comment">-- ARGV[1]: æ‰£å‡æ•°é‡</span>
<span class="hljs-keyword">local</span> stock_key = KEYS[<span class="hljs-number">1</span>]              <span class="hljs-comment">-- è·å–åº“å­˜é”®</span>
<span class="hljs-keyword">local</span> quantity = <span class="hljs-built_in">tonumber</span>(ARGV[<span class="hljs-number">1</span>])     <span class="hljs-comment">-- è·å–æ‰£å‡æ•°é‡</span>
<span class="hljs-keyword">local</span> stock = <span class="hljs-built_in">tonumber</span>(redis.call(<span class="hljs-string">'GET'</span>, stock_key) <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>)  <span class="hljs-comment">-- è·å–å½“å‰åº“å­˜ï¼Œé»˜è®¤0</span>
<span class="hljs-keyword">if</span> stock &gt;= quantity <span class="hljs-keyword">then</span>              <span class="hljs-comment">-- æ£€æŸ¥åº“å­˜æ˜¯å¦è¶³å¤Ÿ</span>
    redis.call(<span class="hljs-string">'DECRBY'</span>, stock_key, quantity)  <span class="hljs-comment">-- æ‰£å‡åº“å­˜</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>                           <span class="hljs-comment">-- è¿”å›æˆåŠŸ</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>                           <span class="hljs-comment">-- åº“å­˜ä¸è¶³ï¼Œè¿”å›å¤±è´¥</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p><strong>è°ƒç”¨æ–¹å¼</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">redis-cli EVAL <span class="hljs-string">"script content"</span> 1 product:stock 5
</code></pre>
<ul>
<li><code>product:stock</code>æ˜¯åº“å­˜é”®ï¼Œ<code>5</code>æ˜¯è¦æ‰£å‡çš„æ•°é‡ã€‚</li>
<li>è¿”å›<code>1</code>è¡¨ç¤ºæ‰£å‡æˆåŠŸï¼Œ<code>0</code>è¡¨ç¤ºåº“å­˜ä¸è¶³ã€‚</li>
</ul>
<p><strong>ä¸ä¼ ç»Ÿæ–¹å¼å¯¹æ¯”</strong>ï¼š</p>
<ul>
<li><strong>WATCH/MULTI/EXEC</strong>ï¼šéœ€è¦å®¢æˆ·ç«¯å¤šæ¬¡äº¤äº’ï¼Œå…ˆ<code>WATCH</code>ç›‘æ§é”®ï¼Œå†<code>GET</code>æ£€æŸ¥ï¼Œæœ€å<code>MULTI/EXEC</code>æäº¤ã€‚å¦‚æœæœŸé—´é”®è¢«ä¿®æ”¹ï¼Œäº‹åŠ¡å¤±è´¥ï¼Œéœ€è¦é‡è¯•ã€‚</li>
<li><strong>Luaè„šæœ¬</strong>ï¼šä¸€æ¬¡è°ƒç”¨ï¼ŒæœåŠ¡ç«¯å®Œæˆæ‰€æœ‰é€»è¾‘ï¼Œæ— éœ€é‡è¯•ï¼ŒåŸå­æ€§æœ‰ä¿éšœã€‚</li>
</ul>
<p>æˆ‘åœ¨ä¸€ä¸ªç”µå•†é¡¹ç›®ä¸­å°±é‡åˆ°è¿‡è¶…å–é—®é¢˜ã€‚å½“æ—¶ç”¨<code>WATCH</code>æ–¹æ¡ˆï¼Œå³°å€¼æ—¶é‡è¯•ç‡é«˜è¾¾30%ï¼ŒQPSç›´æ¥è…°æ–©ã€‚æ”¹ç”¨Luaè„šæœ¬åï¼Œé—®é¢˜è¿åˆƒè€Œè§£ï¼ŒæˆåŠŸç‡æ¥è¿‘100%ã€‚</p>
<p><strong>ç¤ºæ„å›¾</strong>ï¼š</p>
<pre><code class="hljs language-rust" lang="rust">ä¼ ç»Ÿæ–¹å¼ï¼š    å®¢æˆ·ç«¯ <span class="hljs-punctuation">-&gt;</span> GET <span class="hljs-punctuation">-&gt;</span> æ£€æŸ¥ <span class="hljs-punctuation">-&gt;</span> SET <span class="hljs-punctuation">-&gt;</span> Redisï¼ˆå¯èƒ½å¤±è´¥ï¼‰
Luaè„šæœ¬ï¼š     å®¢æˆ·ç«¯ <span class="hljs-punctuation">-&gt;</span> EVALï¼ˆæ£€æŸ¥+æ‰£å‡ï¼‰ <span class="hljs-punctuation">-&gt;</span> Redisï¼ˆåŸå­æ‰§è¡Œï¼‰
</code></pre>
<h5 data-id="heading-7">æ€§èƒ½ä¼˜åŒ–</h5>
<p>é™¤äº†åŸå­æ€§ï¼ŒLuaè„šæœ¬è¿˜èƒ½æ˜¾è‘—æå‡æ€§èƒ½ã€‚æ¯æ¬¡å®¢æˆ·ç«¯ä¸Redisé€šä¿¡éƒ½æœ‰ç½‘ç»œå¾€è¿”å¼€é”€ï¼ˆRTTï¼‰ï¼Œå°¤å…¶åœ¨é«˜é¢‘æ“ä½œä¸­ï¼Œè¿™éƒ¨åˆ†å»¶è¿Ÿä¼šç´¯ç§¯æˆæ€§èƒ½ç“¶é¢ˆã€‚Pipelineï¼ˆç®¡é“ï¼‰å¯ä»¥æ‰¹é‡å‘é€å‘½ä»¤å‡å°‘RTTï¼Œä½†å®ƒåªæ˜¯â€œæ‰“åŒ…å‘é€â€ï¼Œæ‰§è¡Œä»æ˜¯é€æ¡è¿›è¡Œï¼Œæ— æ³•ä¿è¯åŸå­æ€§ã€‚è€ŒLuaè„šæœ¬ä¸ä»…å‡å°‘äº†RTTï¼Œè¿˜åœ¨æœåŠ¡ç«¯é«˜æ•ˆæ‰§è¡Œã€‚</p>
<p>ä»¥ä¸‹æ˜¯Pipelineå’ŒLuaè„šæœ¬çš„å¯¹æ¯”ï¼š</p>





























<table><thead><tr><th><strong>æ–¹å¼</strong></th><th><strong>RTTæ¬¡æ•°</strong></th><th><strong>åŸå­æ€§</strong></th><th><strong>æ‰§è¡Œæ•ˆç‡</strong></th></tr></thead><tbody><tr><td>å•æ¡å‘½ä»¤</td><td>Næ¬¡</td><td>æ— </td><td>ä½</td></tr><tr><td>Pipeline</td><td>1æ¬¡</td><td>æ— </td><td>ä¸­</td></tr><tr><td>Luaè„šæœ¬</td><td>1æ¬¡</td><td>æœ‰</td><td>é«˜ï¼ˆæœåŠ¡ç«¯æ‰§è¡Œï¼‰</td></tr></tbody></table>
<p>åœ¨ä¸€ä¸ªå®æ—¶ç»Ÿè®¡é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ‰¹é‡æ›´æ–°10ä¸ªé”®çš„å€¼ã€‚ä½¿ç”¨Pipelineæ—¶ï¼ŒQPSåœ¨5000å·¦å³ï¼Œæ”¹ç”¨Luaè„šæœ¬åï¼ŒQPSæå‡åˆ°6000ï¼Œæ€§èƒ½æå‡çº¦20%ã€‚åŸå› å¾ˆç®€å•ï¼šLuaè„šæœ¬æŠŠé€»è¾‘äº¤ç»™Rediså†…éƒ¨çš„Cå®ç°ï¼Œçœå»äº†å®¢æˆ·ç«¯çš„è§£æå’Œå¤šæ¬¡é€šä¿¡ã€‚</p>
<h5 data-id="heading-8">çµæ´»æ€§</h5>
<p>Luaè„šæœ¬çš„å¦ä¸€ä¸ªäº®ç‚¹æ˜¯å®ƒçš„çµæ´»æ€§ã€‚ä¼ ç»ŸRediså‘½ä»¤æ˜¯â€œæ­»æ¿â€çš„ï¼Œåªèƒ½æŒ‰å›ºå®šæ–¹å¼ç»„åˆï¼Œè€ŒLuaè„šæœ¬æ”¯æŒæ¡ä»¶åˆ¤æ–­ã€å¾ªç¯ç”šè‡³ç®€å•çš„è®¡ç®—ï¼Œå ªç§°Redisçš„â€œç¼–ç¨‹æ‰©å±•åŒ…â€ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒå®ç°æ‰¹é‡æ“ä½œçš„åŠ¨æ€å¤„ç†ï¼š</p>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-comment">-- æ‰¹é‡å¢åŠ å¤šä¸ªé”®çš„å€¼</span>
<span class="hljs-comment">-- KEYS: é”®ååˆ—è¡¨</span>
<span class="hljs-comment">-- ARGV[1]: å¢é‡</span>
<span class="hljs-keyword">for</span> i, key <span class="hljs-keyword">in</span> <span class="hljs-built_in">ipairs</span>(KEYS) <span class="hljs-keyword">do</span>          <span class="hljs-comment">-- éå†æ‰€æœ‰é”®</span>
    <span class="hljs-keyword">local</span> current = <span class="hljs-built_in">tonumber</span>(redis.call(<span class="hljs-string">'GET'</span>, key) <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>)
    redis.call(<span class="hljs-string">'SET'</span>, key, current + <span class="hljs-built_in">tonumber</span>(ARGV[<span class="hljs-number">1</span>]))  <span class="hljs-comment">-- å¢åŠ æŒ‡å®šå€¼</span>
<span class="hljs-keyword">end</span>
<span class="hljs-keyword">return</span> #KEYS                           <span class="hljs-comment">-- è¿”å›å¤„ç†çš„é”®æ•°é‡</span>
</code></pre>
<p><strong>è°ƒç”¨æ–¹å¼</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">redis-cli EVAL <span class="hljs-string">"script content"</span> 3 key1 key2 key3 10
</code></pre>
<ul>
<li>å¤„ç†<code>key1</code>ã€<code>key2</code>ã€<code>key3</code>ï¼Œæ¯ä¸ªå€¼åŠ 10ã€‚</li>
</ul>
<p>è¿™ä¸ªè„šæœ¬å±•ç¤ºäº†å¾ªç¯å’ŒåŠ¨æ€æ“ä½œçš„èƒ½åŠ›ï¼Œè¿œè¶…Pipelineçš„ç®€å•æ‰¹é‡æäº¤ã€‚</p>
<p><strong>è¿‡æ¸¡åˆ°ä¸‹ä¸€èŠ‚</strong>ï¼šé€šè¿‡åŸå­æ€§ã€æ€§èƒ½å’Œçµæ´»æ€§ä¸‰å¤§ä¼˜åŠ¿ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº†Luaè„šæœ¬çš„å¼ºå¤§ä¹‹å¤„ã€‚ä½†å…‰è¯´ä¸ç»ƒå¯ä¸è¡Œï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†èµ°è¿›å®é™…é¡¹ç›®ï¼Œçœ‹çœ‹å®ƒåœ¨åˆ†å¸ƒå¼é”ã€ä¸šåŠ¡é€»è¾‘å°è£…ç­‰åœºæ™¯ä¸­å¦‚ä½•å¤§å±•æ‹³è„šï¼ŒåŒæ—¶åˆ†äº«ä¸€äº›çœŸå®çš„è¸©å‘ç»éªŒã€‚</p>
<hr/>
<h4 data-id="heading-9">4. å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨åœºæ™¯</h4>
<p>ä¸Šä¸€èŠ‚æˆ‘ä»¬å‰–æäº†Luaè„šæœ¬çš„ä¸‰å¤§æ ¸å¿ƒä¼˜åŠ¿ï¼šåŸå­æ€§ã€æ€§èƒ½å’Œçµæ´»æ€§ã€‚è¿™äº›ç‰¹è´¨å¬èµ·æ¥å¾ˆç¾ï¼Œä½†çœŸæ­£è®©å®ƒå‘å…‰å‘çƒ­çš„ï¼Œè¿˜æ˜¯åœ¨å®é™…é¡¹ç›®ä¸­çš„è½åœ°åº”ç”¨ã€‚è¿™ä¸€èŠ‚ï¼Œæˆ‘å°†å¸¦ä½ èµ°è¿›ä¸‰ä¸ªå…¸å‹åœºæ™¯ï¼Œçœ‹çœ‹Luaè„šæœ¬å¦‚ä½•è§£å†³åˆ†å¸ƒå¼é”ã€å¤æ‚ä¸šåŠ¡é€»è¾‘å’Œçƒ­ç‚¹æ•°æ®æ›´æ–°çš„éš¾é¢˜ï¼ŒåŒæ—¶åˆ†äº«ä¸€äº›æˆ‘åœ¨é¡¹ç›®ä¸­è¸©è¿‡çš„å‘å’Œè§£å†³æ€è·¯ã€‚</p>
<h5 data-id="heading-10">åœºæ™¯1ï¼šåˆ†å¸ƒå¼é”çš„é«˜æ•ˆå®ç°</h5>
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œé”æ˜¯ç¡®ä¿èµ„æºäº’æ–¥è®¿é—®çš„å¸¸è§æ‰‹æ®µã€‚Redisçš„åˆ†å¸ƒå¼é”é€šå¸¸ç”¨<code>SETNX</code>ï¼ˆSet if Not Existsï¼‰å®ç°åŠ é”ï¼Œç”¨<code>EXPIRE</code>è®¾ç½®è¶…æ—¶é‡Šæ”¾ã€‚ä½†å¦‚æœåˆ†å¼€æ‰§è¡Œè¿™ä¸¤æ­¥ï¼ŒæœåŠ¡å™¨å®•æœºå¯èƒ½å¯¼è‡´é”æ— æ³•é‡Šæ”¾ã€‚Luaè„šæœ¬å¯ä»¥æŠŠåŠ é”å’Œè®¾ç½®è¶…æ—¶å°è£…æˆä¸€ä¸ªåŸå­æ“ä½œï¼Œé¿å…è¿™ç§é£é™©ã€‚</p>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-comment">-- åˆ†å¸ƒå¼é”åŠ é”è„šæœ¬</span>
<span class="hljs-comment">-- KEYS[1]: é”çš„é”®å</span>
<span class="hljs-comment">-- ARGV[1]: é”çš„å”¯ä¸€å€¼ï¼ˆç”¨äºé‡Šæ”¾æ—¶éªŒè¯ï¼‰</span>
<span class="hljs-comment">-- ARGV[2]: è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span>
<span class="hljs-keyword">local</span> lock_key = KEYS[<span class="hljs-number">1</span>]
<span class="hljs-keyword">local</span> lock_value = ARGV[<span class="hljs-number">1</span>]
<span class="hljs-keyword">local</span> ttl = ARGV[<span class="hljs-number">2</span>]
<span class="hljs-keyword">if</span> redis.call(<span class="hljs-string">'SETNX'</span>, lock_key, lock_value) == <span class="hljs-number">1</span> <span class="hljs-keyword">then</span>  <span class="hljs-comment">-- å°è¯•åŠ é”</span>
    redis.call(<span class="hljs-string">'PEXPIRE'</span>, lock_key, ttl)                <span class="hljs-comment">-- è®¾ç½®è¶…æ—¶</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>                                            <span class="hljs-comment">-- åŠ é”æˆåŠŸ</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>                                            <span class="hljs-comment">-- åŠ é”å¤±è´¥</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p><strong>è°ƒç”¨æ–¹å¼</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">redis-cli EVAL <span class="hljs-string">"script content"</span> 1 mylock 12345 10000
</code></pre>
<ul>
<li><code>mylock</code>æ˜¯é”é”®ï¼Œ<code>12345</code>æ˜¯å”¯ä¸€å€¼ï¼Œ<code>10000</code>æ˜¯10ç§’è¶…æ—¶ã€‚</li>
<li>è¿”å›<code>1</code>è¡¨ç¤ºåŠ é”æˆåŠŸï¼Œ<code>0</code>è¡¨ç¤ºå·²è¢«å ç”¨ã€‚</li>
</ul>
<p><strong>é‡Šæ”¾é”è„šæœ¬</strong>ï¼ˆç®€å•ç¤ºä¾‹ï¼‰ï¼š</p>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-keyword">if</span> redis.call(<span class="hljs-string">'GET'</span>, KEYS[<span class="hljs-number">1</span>]) == ARGV[<span class="hljs-number">1</span>] <span class="hljs-keyword">then</span>  <span class="hljs-comment">-- éªŒè¯é”å½’å±</span>
    redis.call(<span class="hljs-string">'DEL'</span>, KEYS[<span class="hljs-number">1</span>])                 <span class="hljs-comment">-- é‡Šæ”¾é”</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>                                   <span class="hljs-comment">-- éæœ¬äººé”ï¼Œæ— æƒé‡Šæ”¾</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>åŸå­æ€§ç¡®ä¿åŠ é”å’Œè¶…æ—¶è®¾ç½®ä¸è¢«æ‰“æ–­ï¼Œé¿å…äº†â€œé”æ­»â€é£é™©ã€‚</li>
<li>æ¯”å®¢æˆ·ç«¯åˆ†æ­¥æ“ä½œæ›´é«˜æ•ˆï¼Œå‡å°‘äº†ä¸€æ¬¡RTTã€‚</li>
</ul>
<p><strong>é¡¹ç›®ç»éªŒ</strong>ï¼šåœ¨ä¸€ä¸ªæ”¯ä»˜ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ç”¨Luaè„šæœ¬å®ç°äº†åˆ†å¸ƒå¼é”ï¼Œä¿è¯è®¢å•å¤„ç†çš„äº’æ–¥æ€§ã€‚ç›¸æ¯”ä¼ ç»Ÿçš„<code>SETNX</code>+<code>EXPIRE</code>ï¼Œå®•æœºåœºæ™¯ä¸‹çš„é”æ®‹ç•™é—®é¢˜å®Œå…¨æ¶ˆå¤±ã€‚</p>
<h5 data-id="heading-11">åœºæ™¯2ï¼šå¤æ‚ä¸šåŠ¡é€»è¾‘çš„å°è£…</h5>
<p>æœ‰äº›ä¸šåŠ¡é€»è¾‘æ¶‰åŠå¤šä¸ªæ­¥éª¤ï¼Œæ¯”å¦‚ç”µå•†è®¢å•å¤„ç†ï¼šæ£€æŸ¥åº“å­˜ã€æ‰£å‡åº“å­˜ã€è®°å½•æ—¥å¿—ã€‚å¦‚æœç”¨å®¢æˆ·ç«¯åˆ†æ­¥è°ƒç”¨ï¼Œä¸ä»…æ•ˆç‡ä½ï¼Œè¿˜å¯èƒ½å› ç½‘ç»œæŠ–åŠ¨å¯¼è‡´éƒ¨åˆ†æ­¥éª¤å¤±è´¥ã€‚Luaè„šæœ¬å¯ä»¥å°†è¿™äº›æ­¥éª¤å°è£…æˆä¸€ä¸ªåŸå­æ“ä½œã€‚</p>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-comment">-- è®¢å•å¤„ç†è„šæœ¬</span>
<span class="hljs-comment">-- KEYS[1]: åº“å­˜é”®</span>
<span class="hljs-comment">-- KEYS[2]: æ—¥å¿—é”®</span>
<span class="hljs-comment">-- ARGV[1]: æ‰£å‡æ•°é‡</span>
<span class="hljs-comment">-- ARGV[2]: æ—¥å¿—å†…å®¹</span>
<span class="hljs-keyword">local</span> stock_key = KEYS[<span class="hljs-number">1</span>]
<span class="hljs-keyword">local</span> log_key = KEYS[<span class="hljs-number">2</span>]
<span class="hljs-keyword">local</span> quantity = <span class="hljs-built_in">tonumber</span>(ARGV[<span class="hljs-number">1</span>])
<span class="hljs-keyword">local</span> log_msg = ARGV[<span class="hljs-number">2</span>]
<span class="hljs-keyword">local</span> stock = <span class="hljs-built_in">tonumber</span>(redis.call(<span class="hljs-string">'GET'</span>, stock_key) <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>)
<span class="hljs-keyword">if</span> stock &gt;= quantity <span class="hljs-keyword">then</span>
    redis.call(<span class="hljs-string">'DECRBY'</span>, stock_key, quantity)         <span class="hljs-comment">-- æ‰£å‡åº“å­˜</span>
    redis.call(<span class="hljs-string">'RPUSH'</span>, log_key, log_msg)             <span class="hljs-comment">-- è®°å½•æ—¥å¿—</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>                                          <span class="hljs-comment">-- æˆåŠŸ</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>                                          <span class="hljs-comment">-- åº“å­˜ä¸è¶³</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p><strong>è°ƒç”¨æ–¹å¼</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">redis-cli EVAL <span class="hljs-string">"script content"</span> 2 product:stock order:<span class="hljs-built_in">log</span> 5 <span class="hljs-string">"order123 processed"</span>
</code></pre>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>å¤šæ­¥éª¤é€»è¾‘åŸå­æ‰§è¡Œï¼Œé¿å…ä¸­é—´çŠ¶æ€ä¸ä¸€è‡´ã€‚</li>
<li>æœåŠ¡ç«¯å¤„ç†å‡å°‘äº†å®¢æˆ·ç«¯çš„åè°ƒæˆæœ¬ã€‚</li>
</ul>
<p><strong>é¡¹ç›®ç»éªŒ</strong>ï¼šåœ¨ä¸€ä¸ªç§’æ€æ´»åŠ¨ä¸­ï¼Œæˆ‘ä»¬ç”¨ç±»ä¼¼è„šæœ¬å¤„ç†è®¢å•ï¼Œå•èŠ‚ç‚¹QPSä»3000æå‡åˆ°4500ï¼Œå®¢æˆ·ç«¯ä»£ç ä¹Ÿç®€åŒ–äº†ä¸å°‘ã€‚</p>
<h5 data-id="heading-12">åœºæ™¯3ï¼šçƒ­ç‚¹æ•°æ®æ‰¹é‡æ›´æ–°</h5>
<p>å®æ—¶æ’è¡Œæ¦œæ˜¯Redisçš„ç»å…¸åº”ç”¨åœºæ™¯ï¼Œæ¯”å¦‚æ¸¸æˆç§¯åˆ†æ¦œã€‚æ¯æ¬¡æ›´æ–°å¯èƒ½æ¶‰åŠå¤šä¸ªç”¨æˆ·çš„æ•°æ®ï¼Œä¼ ç»Ÿæ–¹å¼éœ€è¦é€æ¡è°ƒç”¨<code>ZINCRBY</code>ï¼Œç½‘ç»œå¼€é”€å¤§ä¸”æ•ˆç‡ä½ã€‚Luaè„šæœ¬å¯ä»¥æ‰¹é‡å¤„ç†ï¼ŒåŠ¨æ€æ›´æ–°çƒ­ç‚¹æ•°æ®ã€‚</p>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-comment">-- æ‰¹é‡æ›´æ–°æ’è¡Œæ¦œ</span>
<span class="hljs-comment">-- KEYS: ç”¨æˆ·IDåˆ—è¡¨</span>
<span class="hljs-comment">-- ARGV: å¯¹åº”çš„ç§¯åˆ†å¢é‡åˆ—è¡¨</span>
<span class="hljs-keyword">local</span> updates = {}
<span class="hljs-keyword">for</span> i, key <span class="hljs-keyword">in</span> <span class="hljs-built_in">ipairs</span>(KEYS) <span class="hljs-keyword">do</span>
    <span class="hljs-keyword">local</span> score = <span class="hljs-built_in">tonumber</span>(ARGV[i])
    redis.call(<span class="hljs-string">'ZINCRBY'</span>, <span class="hljs-string">'leaderboard'</span>, score, key)  <span class="hljs-comment">-- æ›´æ–°ç§¯åˆ†</span>
    updates[i] = redis.call(<span class="hljs-string">'ZSCORE'</span>, <span class="hljs-string">'leaderboard'</span>, key)  <span class="hljs-comment">-- è·å–æœ€æ–°ç§¯åˆ†</span>
<span class="hljs-keyword">end</span>
<span class="hljs-keyword">return</span> updates  <span class="hljs-comment">-- è¿”å›æ‰€æœ‰ç”¨æˆ·çš„æœ€æ–°ç§¯åˆ†</span>
</code></pre>
<p><strong>è°ƒç”¨æ–¹å¼</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">redis-cli EVAL <span class="hljs-string">"script content"</span> 3 user1 user2 user3 10 20 5
</code></pre>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼š</p>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šæ—©æœŸç‰ˆæœ¬è„šæœ¬å¤ªé•¿ï¼ˆå¾ªç¯å¤„ç†100ä¸ªç”¨æˆ·ï¼‰ï¼Œæ‰§è¡Œæ—¶é—´è¶…å‡ºäº†é»˜è®¤çš„<code>lua-time-limit</code>ï¼ˆ5ç§’ï¼‰ï¼Œå¯¼è‡´Redisé˜»å¡ã€‚</li>
<li><strong>è§£å†³</strong>ï¼šå°†æ‰¹é‡æ›´æ–°æ‹†æˆå°æ‰¹æ¬¡ï¼ˆæ¯æ¬¡10-20ä¸ªï¼‰ï¼Œå¹¶ä¼˜åŒ–é€»è¾‘å‡å°‘è®¡ç®—é‡ï¼Œæœ€ç»ˆç¨³å®šè¿è¡Œã€‚</li>
</ul>
<p><strong>ç¤ºæ„å›¾</strong>ï¼š</p>
<pre><code class="hljs language-rust" lang="rust">ä¼ ç»Ÿæ–¹å¼ï¼š    å®¢æˆ·ç«¯ <span class="hljs-punctuation">-&gt;</span> ZINCRBY user1 <span class="hljs-punctuation">-&gt;</span> ZINCRBY user2 <span class="hljs-punctuation">-&gt;</span> ... <span class="hljs-punctuation">-&gt;</span> Redis
Luaè„šæœ¬ï¼š     å®¢æˆ·ç«¯ <span class="hljs-punctuation">-&gt;</span> EVALï¼ˆæ‰¹é‡æ›´æ–°ï¼‰ <span class="hljs-punctuation">-&gt;</span> Redis
</code></pre>
<p><strong>é¡¹ç›®ç»éªŒ</strong>ï¼šåœ¨ä¸€ä¸ªæ¸¸æˆæ’è¡Œæ¦œä¸­ï¼Œæ”¹ç”¨Luaè„šæœ¬åï¼Œæ›´æ–°å»¶è¿Ÿä»50msé™åˆ°10msï¼Œç”¨æˆ·ä½“éªŒæ˜¾è‘—æå‡ã€‚</p>
<p><strong>è¿‡æ¸¡åˆ°ä¸‹ä¸€èŠ‚</strong>ï¼šé€šè¿‡è¿™ä¸‰ä¸ªåœºæ™¯ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†Luaè„šæœ¬åœ¨å®æˆ˜ä¸­çš„å¨åŠ›ã€‚ä½†è¦ç”¨å¥½å®ƒï¼Œè¿˜éœ€è¦ä¸€äº›æŠ€å·§å’Œæ³¨æ„äº‹é¡¹ã€‚ä¸‹ä¸€èŠ‚ï¼Œæˆ‘å°†åˆ†äº«æœ€ä½³å®è·µå’Œè¸©å‘ç»éªŒï¼Œå¸®ä½ åœ¨é¡¹ç›®ä¸­å°‘èµ°å¼¯è·¯ã€‚</p>
<hr/>
<h4 data-id="heading-13">5. æœ€ä½³å®è·µä¸è¸©å‘ç»éªŒ</h4>
<p>é€šè¿‡å‰é¢çš„åœºæ™¯åˆ†æï¼Œæˆ‘ä»¬å·²ç»è§è¯†äº†Luaè„šæœ¬åœ¨åˆ†å¸ƒå¼é”ã€ä¸šåŠ¡é€»è¾‘å°è£…å’Œçƒ­ç‚¹æ•°æ®æ›´æ–°ä¸­çš„å¼ºå¤§èƒ½åŠ›ã€‚ä½†å°±åƒä»»ä½•åˆ©å™¨ä¸€æ ·ï¼Œç”¨å¾—å¥½èƒ½äº‹åŠåŠŸå€ï¼Œç”¨ä¸å¥½å¯èƒ½ä¼šâ€œä¼¤åˆ°è‡ªå·±â€ã€‚è¿™ä¸€èŠ‚ï¼Œæˆ‘å°†ç»“åˆå®é™…é¡¹ç›®ç»éªŒï¼Œåˆ†äº«ä¸€äº›æœ€ä½³å®è·µå’Œè¸©è¿‡çš„å‘ï¼Œå¸®ä½ åœ¨ä½¿ç”¨Luaè„šæœ¬æ—¶å°‘èµ°å¼¯è·¯ï¼Œå……åˆ†å‘æŒ¥å®ƒçš„æ½œåŠ›ã€‚</p>
<h5 data-id="heading-14">æœ€ä½³å®è·µ</h5>
<p>è¦è®©Luaè„šæœ¬æˆä¸ºä½ çš„å¾—åŠ›åŠ©æ‰‹ï¼Œä»¥ä¸‹å‡ ç‚¹å€¼å¾—é“­è®°ï¼š</p>
<ol>
<li>
<p><strong>è„šæœ¬çŸ­å°ç²¾æ‚</strong><br/>
Luaè„šæœ¬è¿è¡Œåœ¨RedisæœåŠ¡ç«¯ï¼Œæ‰§è¡Œæ—¶é—´ç›´æ¥å½±å“Redisçš„å“åº”èƒ½åŠ›ã€‚å°½é‡é¿å…å¤æ‚çš„è®¡ç®—æˆ–è¿‡å¤šçš„å¾ªç¯ï¼ŒæŠŠé‡é€»è¾‘äº¤ç»™å®¢æˆ·ç«¯æˆ–åå°ä»»åŠ¡å¤„ç†ã€‚æ¯”å¦‚ï¼Œä¸Šä¸€èŠ‚çš„æ’è¡Œæ¦œæ›´æ–°è„šæœ¬ï¼Œæˆ‘ä»¬é™åˆ¶äº†æ¯æ¬¡å¤„ç†çš„é”®æ•°é‡ï¼Œé¿å…é˜»å¡ã€‚</p>
</li>
<li>
<p><strong>ä½¿ç”¨EVALSHAå‡å°‘ä¼ è¾“å¼€é”€</strong><br/>
<code>EVAL</code>æ¯æ¬¡éƒ½éœ€è¦ä¼ è¾“å®Œæ•´è„šæœ¬ï¼Œç½‘ç»œå¼€é”€è¾ƒå¤§ã€‚æ›´å¥½çš„æ–¹å¼æ˜¯ç”¨<code>SCRIPT LOAD</code>é¢„åŠ è½½è„šæœ¬ï¼Œè¿”å›SHA1å“ˆå¸Œå€¼ï¼Œç„¶åç”¨<code>EVALSHA</code>è°ƒç”¨ã€‚<br/>
<strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">redis-cli SCRIPT LOAD <span class="hljs-string">"return redis.call('GET', KEYS[1])"</span>
<span class="hljs-comment"># è¿”å›SHA1: "a42059b356c875f0712db19a51f6aaca403f8265"</span>
redis-cli EVALSHA a42059b356c875f0712db19a51f6aaca403f8265 1 mykey
</code></pre>
<p><strong>ä¼˜ç‚¹</strong>ï¼šå‡å°‘å¸¦å®½å ç”¨ï¼Œå°¤å…¶é€‚åˆé¢‘ç¹è°ƒç”¨çš„è„šæœ¬ã€‚</p>
</li>
<li>
<p><strong>å‚æ•°åŒ–è®¾è®¡</strong><br/>
é€šè¿‡<code>KEYS</code>å’Œ<code>ARGV</code>åŠ¨æ€ä¼ å…¥å‚æ•°ï¼Œè€Œä¸æ˜¯ç¡¬ç¼–ç é”®åæˆ–å€¼ã€‚è¿™æ ·è„šæœ¬æ›´é€šç”¨ï¼Œå¯å¤ç”¨æ€§å¼ºã€‚æ¯”å¦‚åº“å­˜æ‰£å‡è„šæœ¬ä¸­ï¼Œé”®åå’Œæ•°é‡éƒ½é€šè¿‡å‚æ•°ä¼ å…¥ï¼Œé¿å…ä¸ºæ¯ä¸ªå•†å“å†™ä¸€ä¸ªè„šæœ¬ã€‚</p>
</li>
<li>
<p><strong>è°ƒè¯•æŠ€å·§ï¼šå€ŸåŠ©redis.log</strong><br/>
Luaè„šæœ¬ä¸åƒå®¢æˆ·ç«¯ä»£ç é‚£æ ·å®¹æ˜“è°ƒè¯•ï¼Œå¯ä»¥ç”¨<code>redis.call('LOG', level, message)</code>è®°å½•ä¸­é—´çŠ¶æ€ã€‚<br/>
<strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-lua" lang="lua">redis.call(<span class="hljs-string">'LOG'</span>, <span class="hljs-string">'NOTICE'</span>, <span class="hljs-string">'Current stock: '</span> .. stock)
</code></pre>
<p>è¾“å‡ºåˆ°Redisæ—¥å¿—ï¼Œæ–¹ä¾¿æ’æŸ¥é—®é¢˜ã€‚</p>
</li>
</ol>
<p><strong>æœ€ä½³å®è·µé€Ÿè§ˆè¡¨</strong>ï¼š</p>






























<table><thead><tr><th><strong>å®è·µç‚¹</strong></th><th><strong>å»ºè®®</strong></th><th><strong>æ”¶ç›Š</strong></th></tr></thead><tbody><tr><td>è„šæœ¬é•¿åº¦</td><td>çŸ­å°ç²¾æ‚ï¼Œé¿å…å¤æ‚è®¡ç®—</td><td>é™ä½é˜»å¡é£é™©</td></tr><tr><td>è°ƒç”¨æ–¹å¼</td><td>EVALSHAä»£æ›¿EVAL</td><td>å‡å°‘ç½‘ç»œå¼€é”€</td></tr><tr><td>å‚æ•°è®¾è®¡</td><td>KEYS/ARGVåŠ¨æ€ä¼ å…¥</td><td>æé«˜å¤ç”¨æ€§</td></tr><tr><td>è°ƒè¯•æ‰‹æ®µ</td><td>redis.logè®°å½•ä¸­é—´çŠ¶æ€</td><td>åŠ é€Ÿé—®é¢˜å®šä½</td></tr></tbody></table>
<h5 data-id="heading-15">è¸©å‘ç»éªŒ</h5>
<p>å®è·µå‡ºçœŸçŸ¥ï¼Œä¹Ÿå‡ºâ€œå‘â€ã€‚ä»¥ä¸‹æ˜¯æˆ‘åœ¨é¡¹ç›®ä¸­é‡åˆ°çš„ä¸€äº›å…¸å‹é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼š</p>
<ol>
<li>
<p><strong>å‘1ï¼šè„šæœ¬æ‰§è¡Œè¶…æ—¶å¯¼è‡´Redisé˜»å¡</strong><br/>
<strong>åœºæ™¯</strong>ï¼šä¸€ä¸ªæ‰¹é‡æ›´æ–°è„šæœ¬å¤„ç†100ä¸ªé”®ï¼ŒåŒ…å«å¾ªç¯å’Œæ¡ä»¶åˆ¤æ–­ï¼Œæ‰§è¡Œæ—¶é—´è¶…å‡ºäº†é»˜è®¤çš„<code>lua-time-limit</code>ï¼ˆ5ç§’ï¼‰ï¼ŒRedisç›´æ¥æŠ¥<code>BUSY</code>é”™è¯¯ï¼Œå®¢æˆ·ç«¯è¯·æ±‚å †ç§¯ã€‚<br/>
<strong>è§£å†³</strong>ï¼š</p>
<ul>
<li>ä¼˜åŒ–è„šæœ¬é€»è¾‘ï¼Œå‡å°‘ä¸å¿…è¦çš„æ“ä½œã€‚</li>
<li>å°†å¤§ä»»åŠ¡æ‹†æˆå°æ‰¹æ¬¡å¤„ç†ã€‚</li>
<li>è°ƒæ•´Redisé…ç½®<code>lua-time-limit</code>ï¼Œä½†éœ€è°¨æ…è¯„ä¼°å½±å“ã€‚<br/>
<strong>ç»éªŒ</strong>ï¼šè„šæœ¬æ‰§è¡Œæ—¶é—´å°½é‡æ§åˆ¶åœ¨æ¯«ç§’çº§ï¼Œé¿å…å½±å“ä¸»çº¿ç¨‹ã€‚</li>
</ul>
</li>
<li>
<p><strong>å‘2ï¼šKEYSå’ŒARGVä½¿ç”¨ä¸å½“å¼•å‘é”™è¯¯</strong><br/>
<strong>åœºæ™¯</strong>ï¼šä¸€ä¸ªè„šæœ¬å¿˜äº†ç”¨<code>tonumber()</code>è½¬æ¢<code>ARGV</code>ï¼Œä¼ å…¥å­—ç¬¦ä¸²â€œ10â€æ—¶ï¼Œæ¯”è¾ƒé€»è¾‘å¤±æ•ˆï¼Œå¯¼è‡´åº“å­˜æ‰£å‡å¼‚å¸¸ã€‚<br/>
<strong>è§£å†³</strong>ï¼š</p>
<ul>
<li>å¯¹æ‰€æœ‰æ•°å€¼å‚æ•°åŠ <code>tonumber()</code>ï¼Œå¦‚<code>tonumber(ARGV[1]) or 0</code>ã€‚</li>
<li>åœ¨å®¢æˆ·ç«¯ä¸¥æ ¼æ ¡éªŒè¾“å…¥ç±»å‹ï¼Œé¿å…ä¼ éæ³•å€¼ã€‚<br/>
<strong>ç»éªŒ</strong>ï¼šLuaæ˜¯åŠ¨æ€ç±»å‹è¯­è¨€ï¼Œç±»å‹å®‰å…¨è¦è‡ªå·±æŠŠå…³ã€‚</li>
</ul>
</li>
<li>
<p><strong>å‘3ï¼šé›†ç¾¤æ¨¡å¼ä¸‹çš„å…¼å®¹æ€§é—®é¢˜</strong><br/>
<strong>åœºæ™¯</strong>ï¼šåœ¨Redis Clusterä¸­ï¼Œä¸€ä¸ªè„šæœ¬æ“ä½œäº†å¤šä¸ªé”®ï¼Œä½†è¿™äº›é”®ä¸åœ¨åŒä¸€ä¸ªslotï¼ŒæŠ¥<code>CROSSSLOT</code>é”™è¯¯ã€‚<br/>
<strong>è§£å†³</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨hash tagï¼ˆå¦‚<code>{tag}key1</code>ã€<code>{tag}key2</code>ï¼‰ç¡®ä¿é”®åœ¨åŒä¸€slotã€‚</li>
<li>è®¾è®¡æ—¶å°½é‡å‡å°‘è·¨slotæ“ä½œï¼Œæˆ–æ‹†åˆ†è„šæœ¬ã€‚<br/>
<strong>ç»éªŒ</strong>ï¼šé›†ç¾¤ç¯å¢ƒä¸‹ï¼Œé”®çš„åˆ†å¸ƒæ˜¯å…³é”®ï¼Œæå‰è§„åˆ’å¥½ã€‚</li>
</ul>
</li>
</ol>
<h5 data-id="heading-16">é¡¹ç›®ç»éªŒåˆ†äº«</h5>
<p>åœ¨ä¸€ä¸ªé«˜å¹¶å‘æ”¯ä»˜ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ç”¨Luaè„šæœ¬å®ç°äº†è®¢å•çŠ¶æ€æ£€æŸ¥å’Œåº“å­˜æ‰£å‡ã€‚èµ·åˆè„šæœ¬ç›´æ¥å¤„ç†æ‰€æœ‰é€»è¾‘ï¼ŒåŒ…æ‹¬æ—¥å¿—è®°å½•å’ŒçŠ¶æ€æ›´æ–°ï¼Œæ‰§è¡Œæ—¶é—´è¾¾åˆ°200msï¼Œå¶å°”è§¦å‘è¶…æ—¶ã€‚ä¼˜åŒ–åï¼Œæˆ‘ä»¬æŠŠéæ ¸å¿ƒé€»è¾‘ï¼ˆæ—¥å¿—ï¼‰ç§»åˆ°å®¢æˆ·ç«¯å¼‚æ­¥å¤„ç†ï¼Œè„šæœ¬åªè´Ÿè´£åŸå­æ“ä½œï¼Œæ‰§è¡Œæ—¶é—´é™åˆ°20msï¼ŒQPSä»4000æå‡åˆ°6000ã€‚è¿™ä¸ªæ¡ˆä¾‹å‘Šè¯‰æˆ‘ï¼š<strong>Luaè„šæœ¬çš„æ ¸å¿ƒä»·å€¼åœ¨äºåŸå­æ€§ï¼Œå¤æ‚è®¡ç®—è¿˜æ˜¯äº¤ç»™å…¶ä»–ç»„ä»¶æ›´åˆé€‚</strong>ã€‚</p>
<p><strong>è¿‡æ¸¡åˆ°ä¸‹ä¸€èŠ‚</strong>ï¼šæŒæ¡äº†æœ€ä½³å®è·µå’Œé¿å‘æŠ€å·§ï¼Œä½ å·²ç»ç¦»â€œLuaè„šæœ¬å¤§å¸ˆâ€ä¸è¿œäº†ã€‚ä½†ä»»ä½•æŠ€æœ¯éƒ½æœ‰å±€é™æ€§ï¼Œä¸‹ä¸€èŠ‚æˆ‘ä»¬å°†èŠèŠLuaè„šæœ¬çš„æ³¨æ„äº‹é¡¹å’Œæ½œåœ¨é£é™©ï¼Œç¡®ä¿ä½ åœ¨ä½¿ç”¨æ—¶å¿ƒä¸­æœ‰æ•°ã€‚</p>
<hr/>
<h4 data-id="heading-17">6. æ³¨æ„äº‹é¡¹ä¸å±€é™æ€§</h4>
<p>é€šè¿‡å‰é¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å·²ç»æŒæ¡äº†Luaè„šæœ¬çš„å¼ºå¤§åŠŸèƒ½å’Œä½¿ç”¨æŠ€å·§ã€‚ä½†å†å‰å®³çš„â€œç§˜å¯†æ­¦å™¨â€ä¹Ÿæœ‰è‡ªå·±çš„è¾¹ç•Œã€‚è¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†èŠèŠRedis Luaè„šæœ¬çš„å±€é™æ€§ã€æ½œåœ¨é£é™©ä»¥åŠå¦‚ä½•åœ¨å®è·µä¸­å¦¥å–„åº”å¯¹ï¼Œç¡®ä¿ä½ ç”¨å¾—å®‰å¿ƒã€ç”¨å¾—é¡ºæ‰‹ã€‚</p>
<h5 data-id="heading-18">è„šæœ¬çš„å±€é™æ€§</h5>
<p>Luaè„šæœ¬è™½ç„¶çµæ´»ï¼Œå´ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œä»¥ä¸‹å‡ ç‚¹éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š</p>
<ul>
<li><strong>ä¸æ”¯æŒå¤æ‚IOæ“ä½œ</strong><br/>
Redisçš„Luaè§£é‡Šå™¨åªæ”¯æŒä¸Redisæœ¬èº«çš„äº¤äº’ï¼Œæ— æ³•ç›´æ¥è®¿é—®æ–‡ä»¶ã€ç½‘ç»œæˆ–å¤–éƒ¨æ•°æ®åº“ã€‚æ¯”å¦‚ï¼Œä½ ä¸èƒ½åœ¨è„šæœ¬ä¸­è°ƒç”¨HTTPæ¥å£è·å–æ•°æ®ã€‚è¿™ç§é™åˆ¶è®©å®ƒæ›´åƒä¸€ä¸ªâ€œè½»é‡çº§æ‰§è¡Œå™¨â€ï¼Œé€‚åˆç®€å•é€»è¾‘è€Œéå¤æ‚ä»»åŠ¡ã€‚</li>
<li><strong>é›†ç¾¤æ¨¡å¼ä¸‹çš„sloté™åˆ¶</strong><br/>
åœ¨Redis Clusterä¸­ï¼Œæ‰€æœ‰<code>KEYS</code>å¿…é¡»ä½äºåŒä¸€ä¸ªslotï¼Œå¦åˆ™ä¼šæŠ¥<code>CROSSSLOT</code>é”™è¯¯ã€‚è™½ç„¶å¯ä»¥ç”¨hash tagï¼ˆå¦‚<code>{tag}key</code>ï¼‰è§£å†³ï¼Œä½†è¿™å¢åŠ äº†è®¾è®¡å¤æ‚åº¦ã€‚å¦‚æœä¸šåŠ¡éœ€è¦é¢‘ç¹æ“ä½œè·¨sloté”®ï¼Œå¯èƒ½å¾—è€ƒè™‘å…¶ä»–æ–¹æ¡ˆï¼Œæ¯”å¦‚å®¢æˆ·ç«¯åˆ†ç‰‡é€»è¾‘ã€‚</li>
</ul>
<p><strong>å±€é™æ€§é€Ÿè§ˆè¡¨</strong>ï¼š</p>




















<table><thead><tr><th><strong>å±€é™æ€§</strong></th><th><strong>æè¿°</strong></th><th><strong>åº”å¯¹å»ºè®®</strong></th></tr></thead><tbody><tr><td>IOé™åˆ¶</td><td>ä»…æ”¯æŒRediså‘½ä»¤ï¼Œæ— å¤–éƒ¨äº¤äº’</td><td>å°†IOé€»è¾‘æ”¾å®¢æˆ·ç«¯å¤„ç†</td></tr><tr><td>é›†ç¾¤sloté™åˆ¶</td><td>KEYSéœ€åœ¨åŒä¸€slot</td><td>ä½¿ç”¨hash tagæˆ–æ‹†åˆ†æ“ä½œ</td></tr></tbody></table>
<h5 data-id="heading-19">å®‰å…¨æ€§</h5>
<p>Luaè„šæœ¬è™½å°ï¼Œå´å¯èƒ½è—ç€å®‰å…¨éšæ‚£ï¼š</p>
<ul>
<li><strong>é˜²æ­¢è„šæœ¬æ³¨å…¥</strong><br/>
å¦‚æœè„šæœ¬ç›´æ¥æ‹¼æ¥ç”¨æˆ·è¾“å…¥ï¼ˆæ¯”å¦‚æŠŠ<code>ARGV</code>æ‹¼æ¥åˆ°å‘½ä»¤ä¸­ï¼‰ï¼Œå¯èƒ½è¢«æ¶æ„ç”¨æˆ·æ³¨å…¥å±é™©ä»£ç ã€‚è™½ç„¶Redisçš„Luaæ²™ç®±é™åˆ¶äº†ç³»ç»Ÿè°ƒç”¨ï¼Œä½†æ‹¼æ¥ä¸å½“ä»å¯èƒ½å¯¼è‡´é€»è¾‘é”™è¯¯æˆ–æ•°æ®æ³„éœ²ã€‚<br/>
<strong>é”™è¯¯ç¤ºä¾‹</strong>ï¼š
<pre><code class="hljs language-lua" lang="lua">redis.call(<span class="hljs-string">'SET'</span>, KEYS[<span class="hljs-number">1</span>], ARGV[<span class="hljs-number">1</span>] .. <span class="hljs-string">' malicious code'</span>)
</code></pre>
<strong>æ­£ç¡®åšæ³•</strong>ï¼šé¿å…æ‹¼æ¥ï¼Œä¸¥æ ¼ä½¿ç”¨<code>KEYS</code>å’Œ<code>ARGV</code>ä½œä¸ºå‚æ•°ï¼Œå®¢æˆ·ç«¯æå‰æ ¡éªŒè¾“å…¥ã€‚</li>
</ul>
<p><strong>ç»éªŒ</strong>ï¼šæˆ‘åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­è§è¿‡å› æœªæ ¡éªŒ<code>ARGV</code>å¯¼è‡´çš„å¼‚å¸¸ï¼Œå®¢æˆ·ç«¯ä¼ å…¥ç©ºå­—ç¬¦ä¸²ï¼Œè„šæœ¬é€»è¾‘ç›´æ¥å´©æºƒã€‚ä»é‚£ä»¥åï¼Œæˆ‘ä»¬å¼ºåˆ¶åœ¨å®¢æˆ·ç«¯åŠ äº†å‚æ•°è¿‡æ»¤ã€‚</p>
<h5 data-id="heading-20">ç›‘æ§ä¸ç»´æŠ¤</h5>
<p>ç”¨å¾—å¥½Luaè„šæœ¬ï¼Œè¿˜è¦ç®¡å¾—å¥½ï¼š</p>
<ul>
<li><strong>æ‰§è¡Œæ—¶é—´ç›‘æ§</strong><br/>
è„šæœ¬æ‰§è¡Œæ—¶é—´è¿‡é•¿ä¼šé˜»å¡Redisä¸»çº¿ç¨‹ï¼Œå½±å“å…¶ä»–è¯·æ±‚ã€‚å¯ä»¥é€šè¿‡Redisçš„<code>SLOWLOG</code>å‘½ä»¤æŸ¥çœ‹æ…¢è„šæœ¬ï¼ˆ<code>SLOWLOG GET</code>ï¼‰ï¼Œæˆ–è€…ç”¨<code>redis-cli --stat</code>è§‚å¯Ÿæ€»ä½“æ€§èƒ½ã€‚</li>
<li><strong>é”™è¯¯æ’æŸ¥</strong><br/>
è„šæœ¬å‡ºé”™æ—¶ï¼ŒRedisä¼šè¿”å›é”™è¯¯ä¿¡æ¯ï¼ˆå¦‚<code>ERR script timeout</code>ï¼‰ï¼Œä½†å…·ä½“åŸå› éœ€è¦ç»“åˆæ—¥å¿—åˆ†æã€‚å»ºè®®åœ¨å¼€å‘æ—¶ç”¨<code>redis.log</code>è®°å½•å…³é”®å˜é‡ï¼Œç”Ÿäº§ç¯å¢ƒä¸­æ­é…å¤–éƒ¨ç›‘æ§å·¥å…·ï¼ˆå¦‚Prometheusï¼‰è·Ÿè¸ªè„šæœ¬è°ƒç”¨æƒ…å†µã€‚</li>
</ul>
<p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼šä¸€ä¸ªçœŸå®çš„æ•™è®­æ˜¯ï¼Œæˆ‘ä»¬æ›¾å› æœªç›‘æ§è„šæœ¬æ‰§è¡Œæ—¶é—´ï¼Œçº¿ä¸Šçªå‘æµé‡æ—¶Rediså“åº”å»¶è¿Ÿæš´å¢ã€‚åæ¥åŠ äº†æ…¢æ—¥å¿—å‘Šè­¦ï¼Œé—®é¢˜å®šä½æ—¶é—´ä»å°æ—¶çº§é™åˆ°åˆ†é’Ÿçº§ã€‚</p>
<p><strong>è¿‡æ¸¡åˆ°ä¸‹ä¸€èŠ‚</strong>ï¼šäº†è§£äº†Luaè„šæœ¬çš„å±€é™æ€§å’Œæ³¨æ„äº‹é¡¹ï¼Œä½ å·²ç»å…·å¤‡äº†å…¨é¢é©¾é©­å®ƒçš„èƒ½åŠ›ã€‚æœ€åä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†æ€»ç»“å…¨æ–‡ï¼Œæç‚¼å®è·µå»ºè®®ï¼Œå¹¶å±•æœ›å®ƒçš„æœªæ¥å‘å±•ã€‚</p>
<hr/>
<h4 data-id="heading-21">7. ç»“å°¾</h4>
<p>ç»è¿‡å‰å…­èŠ‚çš„æ¢ç´¢ï¼Œæˆ‘ä»¬ä»Redis Luaè„šæœ¬çš„åŸºç¡€å…¥é—¨ï¼Œåˆ°æ ¸å¿ƒä¼˜åŠ¿ã€å®æˆ˜åœºæ™¯ï¼Œå†åˆ°æœ€ä½³å®è·µå’Œæ³¨æ„äº‹é¡¹ï¼Œå®Œæ•´åœ°èµ°äº†ä¸€éå®ƒçš„â€œæˆé•¿ä¹‹è·¯â€ã€‚ç°åœ¨ï¼Œæ˜¯æ—¶å€™åœä¸‹æ¥å›é¡¾ä¸€ä¸‹ï¼Œè¿™æŠŠâ€œç§˜å¯†æ­¦å™¨â€ç©¶ç«Ÿç»™æˆ‘ä»¬å¸¦æ¥äº†ä»€ä¹ˆï¼Œä»¥åŠå¦‚ä½•åœ¨æœªæ¥çš„é¡¹ç›®ä¸­ç”¨å¥½å®ƒã€‚</p>
<h5 data-id="heading-22">æ€»ç»“</h5>
<p>Redis Luaè„šæœ¬ä¹‹æ‰€ä»¥å¼ºå¤§ï¼Œæ ¸å¿ƒåœ¨äºå®ƒçš„<strong>åŸå­æ€§</strong>å’Œ<strong>æ€§èƒ½ä¼˜åŒ–</strong>ã€‚å®ƒåƒä¸€ä¸ªé«˜æ•ˆçš„â€œäº‹åŠ¡ç®¡å®¶â€ï¼ŒæŠŠå¤æ‚çš„å¤šå‘½ä»¤æ“ä½œå°è£…æˆä¸€æ¬¡æœåŠ¡ç«¯æ‰§è¡Œï¼Œé¿å…äº†å¹¶å‘ç«äº‰ï¼›åˆåƒä¸€ä¸ªâ€œç½‘ç»œåŠ é€Ÿå™¨â€ï¼Œå‡å°‘äº†å®¢æˆ·ç«¯ä¸Redisä¹‹é—´çš„é¢‘ç¹é€šä¿¡ã€‚åœ¨åˆ†å¸ƒå¼é”ã€ä¸šåŠ¡é€»è¾‘å°è£…å’Œçƒ­ç‚¹æ•°æ®æ›´æ–°ç­‰åœºæ™¯ä¸­ï¼Œå®ƒå±•ç°äº†æ— ä¸ä¼¦æ¯”çš„ä¼˜åŠ¿ã€‚æˆ‘åœ¨å¤šä¸ªé¡¹ç›®ä¸­è§è¯äº†å®ƒå°†QPSæå‡20%-50%çš„è¡¨ç°ï¼Œä¹Ÿä½“ä¼šåˆ°å®ƒç®€åŒ–ä»£ç å¸¦æ¥çš„å¼€å‘æ•ˆç‡æå‡ã€‚å¯¹äºé«˜å¹¶å‘ã€å¤æ‚é€»è¾‘çš„åœºæ™¯ï¼ŒLuaè„šæœ¬æ— ç–‘æ˜¯ä¸€ä¸ªå€¼å¾—ä¿¡èµ–çš„ä¼™ä¼´ã€‚</p>
<h5 data-id="heading-23">å®è·µå»ºè®®</h5>
<p>æƒ³ç”¨å¥½Luaè„šæœ¬ï¼Œä¸å¦¨ä»è¿™å‡ æ­¥å¼€å§‹ï¼š</p>
<ol>
<li><strong>ä»å°å¤„ç€æ‰‹</strong>ï¼šæ‰¾ä¸€ä¸ªç®€å•çš„åœºæ™¯ï¼ˆæ¯”å¦‚è®¡æ•°å™¨æˆ–é”ï¼‰è¯•è¯•æ‰‹ï¼Œç†Ÿæ‚‰<code>KEYS</code>ã€<code>ARGV</code>å’Œ<code>redis.call</code>ã€‚</li>
<li><strong>ä¼˜åŒ–ä¸ºç‹</strong>ï¼šä¿æŒè„šæœ¬ç²¾ç®€ï¼Œç”¨<code>EVALSHA</code>å‡å°‘å¼€é”€ï¼Œç›‘æ§æ‰§è¡Œæ—¶é—´é¿å…é˜»å¡ã€‚</li>
<li><strong>å›¢é˜Ÿåä½œ</strong>ï¼šæŠŠå¸¸ç”¨çš„è„šæœ¬æ•´ç†æˆåº“ï¼Œç»“åˆhash tagæ”¯æŒé›†ç¾¤ï¼Œç¡®ä¿å¯ç»´æŠ¤æ€§ã€‚</li>
</ol>
<h5 data-id="heading-24">æœªæ¥å±•æœ›ä¸å¿ƒå¾—</h5>
<p>ä»æŠ€æœ¯ç”Ÿæ€çœ‹ï¼ŒLuaè„šæœ¬ä¸Redisçš„ç»“åˆåªæ˜¯å¼€å§‹ã€‚éšç€å¾®æœåŠ¡å’Œäº‘åŸç”Ÿçš„æ™®åŠï¼ŒRediså¯èƒ½ä¼šè¿›ä¸€æ­¥å¢å¼ºè„šæœ¬åŠŸèƒ½ï¼Œæ¯”å¦‚æ”¯æŒæ›´å¤æ‚çš„é€»è¾‘æˆ–ä¸å¤–éƒ¨ç³»ç»Ÿé›†æˆã€‚æœªæ¥ï¼Œæˆ‘ä»¬æˆ–è®¸èƒ½çœ‹åˆ°æ›´æ™ºèƒ½çš„è„šæœ¬è°ƒè¯•å·¥å…·ï¼Œç”šè‡³æ˜¯AIè¾…åŠ©ç”Ÿæˆè„šæœ¬çš„å¯èƒ½æ€§ã€‚ä½œä¸ºä¸€åå¼€å‘è€…ï¼Œæˆ‘åœ¨ä½¿ç”¨Luaè„šæœ¬çš„è¿‡ç¨‹ä¸­ï¼Œä¸ä»…è§£å†³äº†æŠ€æœ¯éš¾é¢˜ï¼Œè¿˜ä½“ä¼šåˆ°â€œå°‘å³æ˜¯å¤šâ€çš„è®¾è®¡å“²å­¦â€”â€”ç”¨æœ€å°‘çš„ä»£ç ï¼Œå®ç°æœ€å¤§çš„ä»·å€¼ã€‚</p>
<h5 data-id="heading-25">é¼“åŠ±ä¸äº’åŠ¨</h5>
<p>å¦‚æœä½ è¿˜æ²¡åœ¨é¡¹ç›®ä¸­å°è¯•è¿‡Luaè„šæœ¬ï¼Œä¸å¦¨ä»ä»Šå¤©å¼€å§‹åŠ¨æ‰‹å®è·µã€‚å®ƒå¯èƒ½ä¸ä¼šç«‹åˆ»è§£å†³æ‰€æœ‰é—®é¢˜ï¼Œä½†ä¸€å®šä¼šè®©ä½ çš„æŠ€æœ¯æ·±åº¦æ›´è¿›ä¸€æ­¥ã€‚æœ‰ä»€ä¹ˆä½¿ç”¨å¿ƒå¾—æˆ–ç–‘é—®å—ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œæˆ‘ä»¬ä¸€èµ·æ¢è®¨å¦‚ä½•è®©è¿™æŠŠâ€œç§˜å¯†æ­¦å™¨â€å‘æŒ¥æ›´å¤§å¨åŠ›ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆé”®ç›˜æœ‰"æœºæ¢°"å’Œ"è–„è†œ"ä¹‹åˆ†ï¼Ÿâ€”â€”æŒ‰é”®çš„è§¦æ„Ÿé©å‘½]]></title>    <link>https://juejin.cn/post/7586941997195296820</link>    <guid>https://juejin.cn/post/7586941997195296820</guid>    <pubDate>2025-12-24T03:14:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586941997195296820" data-draft-id="7586941468873572386" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆé”®ç›˜æœ‰&quot;æœºæ¢°&quot;å’Œ&quot;è–„è†œ&quot;ä¹‹åˆ†ï¼Ÿâ€”â€”æŒ‰é”®çš„è§¦æ„Ÿé©å‘½"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-24T03:14:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ— é™å¤§6"/> <meta itemprop="url" content="https://juejin.cn/user/2865758605422890"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆé”®ç›˜æœ‰"æœºæ¢°"å’Œ"è–„è†œ"ä¹‹åˆ†ï¼Ÿâ€”â€”æŒ‰é”®çš„è§¦æ„Ÿé©å‘½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2865758605422890/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ— é™å¤§6
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T03:14:25.000Z" title="Wed Dec 24 2025 03:14:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">âŒ¨ï¸ ä¸ºä»€ä¹ˆé”®ç›˜æœ‰"æœºæ¢°"å’Œ"è–„è†œ"ä¹‹åˆ†ï¼Ÿâ€”â€”æŒ‰é”®çš„è§¦æ„Ÿé©å‘½ ğŸ¸</h2>
<blockquote>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ— é™å¤§ï¼Œæ¬¢è¿æ”¶çœ‹åä¸‡ä¸ªä¸ºä»€ä¹ˆç³»åˆ—æ–‡ç« </p>
<p>å¸Œæœ›ä»Šå¤©çš„å†…å®¹èƒ½å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©</p>
</blockquote>
<p>ä»Šå¤©å’±ä»¬æ¥èŠèŠé”®ç›˜è¿™ä¸ª"ç”µè„‘çš„å˜´å·´"ï¼æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨æ‰“æ¸¸æˆï¼Œå…³é”®æ—¶åˆ»æŒ‰é”®æ²¡ååº”ï¼›ä½ æ­£åœ¨èµ¶è®ºæ–‡ï¼Œé”®ç›˜æ‰‹æ„Ÿç”Ÿç¡¬å¾—åƒåœ¨æ•²é’¢æ¿â€”â€”è¿™äº›ç³Ÿå¿ƒçš„ä½“éªŒï¼Œéƒ½æ˜¯å› ä¸ºä½ æ²¡é€‰å¯¹é”®ç›˜ï¼</p>
<h3 data-id="heading-1">ğŸ¤” æ ¸å¿ƒé—®é¢˜ï¼šæœºæ¢°é”®ç›˜å’Œè–„è†œé”®ç›˜çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆæœºæ¢°é”®ç›˜æ›´è´µï¼Ÿ</h3>
<p>å¾ˆå¤šäººè§‰å¾—é”®ç›˜å°±æ˜¯"æŒ‰é”®çš„é›†åˆ"ï¼Œå…¶å®é”®ç›˜çš„å­¦é—®å¤§ç€å‘¢ï¼æœºæ¢°é”®ç›˜å’Œè–„è†œé”®ç›˜å°±åƒ"é’¢ç´å’Œç”µå­ç´"ï¼Œè™½ç„¶éƒ½èƒ½å‘å£°ï¼Œä½†åŸç†å’Œä½“éªŒå®Œå…¨ä¸åŒã€‚</p>
<h4 data-id="heading-2">é”®ç›˜çš„æœ¬è´¨</h4>
<p>é”®ç›˜æ˜¯ä¸€ç§<strong>è¾“å…¥è®¾å¤‡</strong>ï¼Œé€šè¿‡æŒ‰é”®å°†ç”¨æˆ·çš„æŒ‡ä»¤ä¼ é€’ç»™ç”µè„‘ã€‚å®ƒå°±åƒ"ç”µè„‘çš„ç¿»è¯‘å®˜"ï¼ŒæŠŠäººç±»çš„æ•²å‡»è½¬åŒ–ä¸ºç”µè„‘èƒ½ç†è§£çš„ç”µä¿¡å·ã€‚</p>
<h4 data-id="heading-3">ä¸ºä»€ä¹ˆæœºæ¢°é”®ç›˜æ›´è´µï¼Ÿ</h4>
<ul>
<li>ğŸ”§ <strong>ç»“æ„å¤æ‚</strong>ï¼šæ¯ä¸ªæŒ‰é”®éƒ½æœ‰ç‹¬ç«‹çš„æœºæ¢°è½´ä½“</li>
<li>âš™ï¸ <strong>å·¥è‰ºè¦æ±‚é«˜</strong>ï¼šè½´ä½“åˆ¶é€ éœ€è¦ç²¾å¯†åŠ å·¥</li>
<li>ğŸ›¡ï¸ <strong>ä½¿ç”¨å¯¿å‘½é•¿</strong>ï¼šå¯è¾¾5000ä¸‡æ¬¡æ•²å‡»</li>
<li>ğŸ¨ <strong>ä¸ªæ€§åŒ–å¼º</strong>ï¼šæ”¯æŒæ¢è½´ã€æ¢é”®å¸½ã€RGBç¯å…‰</li>
<li>ğŸ’ <strong>ç”¨æˆ·ä½“éªŒå¥½</strong>ï¼šç‹¬ç‰¹çš„è§¦æ„Ÿå’Œå£°éŸ³</li>
</ul>
<h3 data-id="heading-4">ğŸ“œ é”®ç›˜çš„"è¿›åŒ–å²"ï¼šä»æ‰“å­—æœºåˆ°æœºæ¢°é”®ç›˜å¤å…´</h3>
<h4 data-id="heading-5">1. ğŸ“  æ‰“å­—æœºæ—¶ä»£ï¼š"æœºæ¢°å…ˆé©±"</h4>
<p>19ä¸–çºªä¸­æœŸï¼Œæ‰“å­—æœºè¯ç”Ÿã€‚å®ƒä½¿ç”¨æœºæ¢°ç»“æ„ï¼Œæ¯ä¸ªæŒ‰é”®è¿æ¥ä¸€ä¸ªå­—é”¤ï¼Œæ•²å‡»æ—¶å­—é”¤å‡»æ‰“è‰²å¸¦ï¼Œåœ¨çº¸ä¸Šç•™ä¸‹å°è®°ã€‚</p>
<p>è¿™å°±åƒ"æ¯ä¸ªæŒ‰é”®éƒ½æ˜¯ä¸€ä¸ªå°é”¤å­"ï¼Œæ•²å‡»æ—¶æœ‰æ¸…è„†çš„å£°éŸ³å’Œæ˜æ˜¾çš„åé¦ˆã€‚æœºæ¢°é”®ç›˜çš„é›å½¢å°±æ˜¯ä»è¿™é‡Œå¼€å§‹çš„ï¼</p>
<h4 data-id="heading-6">2. ğŸ“± è–„è†œé”®ç›˜å…´èµ·ï¼š"ä½æˆæœ¬é©å‘½"</h4>
<p>20ä¸–çºª80å¹´ä»£ï¼Œéšç€ä¸ªäººç”µè„‘çš„æ™®åŠï¼Œè–„è†œé”®ç›˜åº”è¿è€Œç”Ÿã€‚å®ƒç”¨è–„è†œç”µè·¯ä»£æ›¿äº†å¤æ‚çš„æœºæ¢°ç»“æ„ï¼Œæˆæœ¬å¤§å¤§é™ä½ã€‚</p>
<p>è¿™å°±åƒ"æŠŠæ‰€æœ‰æŒ‰é”®éƒ½åšåœ¨ä¸€å¼ è†œä¸Š"ï¼Œè™½ç„¶æˆæœ¬ä½ã€å™ªéŸ³å°ï¼Œä½†è§¦æ„Ÿç”Ÿç¡¬ï¼Œæ—¶é—´é•¿äº†æ‰‹æŒ‡ä¼šå¾ˆç´¯ã€‚</p>
<h4 data-id="heading-7">3. âš¡ æœºæ¢°é”®ç›˜å¤å…´ï¼š"è§¦æ„Ÿå›å½’"</h4>
<p>2010å¹´åï¼Œéšç€æ¸¸æˆäº§ä¸šçš„å‘å±•å’Œäººä»¬å¯¹è¾“å…¥ä½“éªŒçš„è¿½æ±‚ï¼Œæœºæ¢°é”®ç›˜å¼€å§‹å¤å…´ã€‚ç©å®¶å’Œç¨‹åºå‘˜ä»¬å‘ç°ï¼Œæœºæ¢°é”®ç›˜çš„è§¦æ„Ÿå’Œè€ç”¨æ€§æ˜¯è–„è†œé”®ç›˜æ— æ³•æ¯”æ‹Ÿçš„ã€‚</p>
<p>è¿™å°±åƒ"å¤å¤é£æµè¡Œ"ï¼Œäººä»¬é‡æ–°å‘ç°äº†æœºæ¢°é”®ç›˜çš„é­…åŠ›ï¼Œå¼€å§‹ä¸º"æ›´å¥½çš„è§¦æ„Ÿ"ä¹°å•ï¼</p>
<h3 data-id="heading-8">ğŸ”§ æŠ€æœ¯åŸç†ï¼šæœºæ¢°é”®ç›˜ vs è–„è†œé”®ç›˜</h3>
<h4 data-id="heading-9">1. âš™ï¸ æœºæ¢°é”®ç›˜ï¼š"ç‹¬ç«‹è½´ä½“ï¼Œç²¾å‡†åé¦ˆ"</h4>
<p>æœºæ¢°é”®ç›˜çš„æ ¸å¿ƒæ˜¯<strong>æœºæ¢°è½´ä½“</strong>ï¼Œæ¯ä¸ªæŒ‰é”®éƒ½æœ‰ç‹¬ç«‹çš„è½´ä½“ã€‚è½´ä½“ç”±å¤–å£³ã€å¼¹ç°§ã€è½´å¿ƒå’Œè§¦ç‚¹ç»„æˆã€‚</p>
<p><strong>æœºæ¢°è½´ä½“çš„å·¥ä½œåŸç†</strong>ï¼š</p>
<ul>
<li>å½“ä½ æŒ‰ä¸‹æŒ‰é”®æ—¶ï¼Œè½´å¿ƒå‘ä¸‹ç§»åŠ¨</li>
<li>è½´å¿ƒåº•éƒ¨çš„é‡‘å±ç‰‡æ¥è§¦è§¦ç‚¹ï¼Œå½¢æˆé€šè·¯</li>
<li>å¼¹ç°§æä¾›å›å¼¹åŠ›ï¼Œç»™ç”¨æˆ·æ˜æ˜¾çš„è§¦æ„Ÿåé¦ˆ</li>
<li>é‡Šæ”¾æŒ‰é”®æ—¶ï¼Œå¼¹ç°§å°†è½´å¿ƒå¼¹å›åŸä½</li>
</ul>
<p><strong>å¸¸è§çš„æœºæ¢°è½´ä½“</strong>ï¼š</p>















































<table><thead><tr><th>è½´ä½“ç±»å‹</th><th>è§¦å‘å‹åŠ›</th><th>å£°éŸ³å¤§å°</th><th>è§¦æ„Ÿç‰¹ç‚¹</th><th>é€‚åˆåœºæ™¯</th></tr></thead><tbody><tr><td>ğŸŸ¢ é’è½´</td><td>60g</td><td>å¤§ï¼ˆæ¸…è„†ï¼‰</td><td>æ®µè½æ„Ÿå¼ºï¼Œå’”å—’å£°</td><td>æ‰“å­—ã€åŠå…¬</td></tr><tr><td>ğŸ”´ çº¢è½´</td><td>45g</td><td>å°ï¼ˆé™éŸ³ï¼‰</td><td>çº¿æ€§é¡ºæ»‘ï¼Œæ— æ®µè½æ„Ÿ</td><td>æ¸¸æˆã€é•¿æ—¶é—´æ‰“å­—</td></tr><tr><td>ğŸŸ¡ èŒ¶è½´</td><td>55g</td><td>ä¸­ï¼ˆæŸ”å’Œï¼‰</td><td>è½»å¾®æ®µè½æ„Ÿï¼Œå£°éŸ³é€‚ä¸­</td><td>å…¼é¡¾æ‰“å­—å’Œæ¸¸æˆ</td></tr><tr><td>âš« é»‘è½´</td><td>80g</td><td>å°ï¼ˆé™éŸ³ï¼‰</td><td>çº¿æ€§å›å¼¹ï¼Œå‹åŠ›è¾ƒå¤§</td><td>æ¸¸æˆï¼ˆéœ€è¦å¿«é€Ÿè§¦å‘ï¼‰</td></tr><tr><td>ğŸ”µ é“¶è½´</td><td>45g</td><td>å°ï¼ˆé™éŸ³ï¼‰</td><td>çº¿æ€§è¶…çŸ­è§¦å‘ï¼Œååº”å¿«</td><td>ç«æŠ€æ¸¸æˆ</td></tr></tbody></table>
<h4 data-id="heading-10">2. ğŸ“‹ è–„è†œé”®ç›˜ï¼š"ä¸€å±‚è†œï¼Œä¸‰ä¸ªå±‚"</h4>
<p>è–„è†œé”®ç›˜çš„æ ¸å¿ƒæ˜¯<strong>ä¸‰å±‚è–„è†œç”µè·¯</strong>ï¼Œç”±ä¸Šå¯¼ç”µå±‚ã€ä¸­é—´éš”ç¦»å±‚å’Œä¸‹å¯¼ç”µå±‚ç»„æˆã€‚</p>
<p><strong>è–„è†œé”®ç›˜çš„å·¥ä½œåŸç†</strong>ï¼š</p>
<ul>
<li>å½“ä½ æŒ‰ä¸‹æŒ‰é”®æ—¶ï¼Œé”®å¸½å‹è¿«æ©¡èƒ¶ç¢—</li>
<li>æ©¡èƒ¶ç¢—å˜å½¢ï¼Œä½¿ä¸Šå¯¼ç”µå±‚æ¥è§¦ä¸‹å¯¼ç”µå±‚</li>
<li>å½¢æˆé€šè·¯ï¼Œå‘é€ç”µä¿¡å·</li>
<li>é‡Šæ”¾æŒ‰é”®æ—¶ï¼Œæ©¡èƒ¶ç¢—å¼¹æ€§æ¢å¤ï¼Œä¸¤å±‚åˆ†ç¦»</li>
</ul>
<h4 data-id="heading-11">3. ğŸ¯ æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”</h4>


















































<table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>æœºæ¢°é”®ç›˜</th><th>è–„è†œé”®ç›˜</th></tr></thead><tbody><tr><td><strong>ç»“æ„</strong></td><td>ç‹¬ç«‹æœºæ¢°è½´ä½“</td><td>ä¸‰å±‚è–„è†œç”µè·¯+æ©¡èƒ¶ç¢—</td></tr><tr><td><strong>è§¦å‘åŸç†</strong></td><td>é‡‘å±è§¦ç‚¹æ¥è§¦</td><td>è–„è†œç”µè·¯æ¥è§¦</td></tr><tr><td><strong>è§¦æ„Ÿ</strong></td><td>æœ‰æ®µè½æ„Ÿ/çº¿æ€§ï¼Œåé¦ˆæ˜æ˜¾</td><td>ç»µè½¯ï¼Œåé¦ˆå¼±</td></tr><tr><td><strong>å£°éŸ³</strong></td><td>æ¸…è„†/é™éŸ³ï¼ˆè§†è½´ä½“è€Œå®šï¼‰</td><td>å®‰é™ï¼ˆæ©¡èƒ¶ç¢—ç¼“å†²ï¼‰</td></tr><tr><td><strong>å¯¿å‘½</strong></td><td>5000ä¸‡æ¬¡æ•²å‡»</td><td>500ä¸‡æ¬¡æ•²å‡»</td></tr><tr><td><strong>æˆæœ¬</strong></td><td>é«˜ï¼ˆ100-1000å…ƒ+ï¼‰</td><td>ä½ï¼ˆ20-100å…ƒï¼‰</td></tr><tr><td><strong>ä¸ªæ€§åŒ–</strong></td><td>æ”¯æŒæ¢è½´ã€æ¢é”®å¸½ã€RGB</td><td>åŸºæœ¬ä¸å¯å®šåˆ¶</td></tr><tr><td><strong>å“åº”é€Ÿåº¦</strong></td><td>å¿«ï¼ˆæ— é”®ç¨‹æµªè´¹ï¼‰</td><td>æ…¢ï¼ˆæ©¡èƒ¶ç¢—æœ‰å»¶è¿Ÿï¼‰</td></tr></tbody></table>
<h3 data-id="heading-12">ğŸ® è¶£å‘³å¯¹æ¯”ï¼šä¸åŒè½´ä½“çš„è§¦æ„Ÿå·®å¼‚</h3>
<h4 data-id="heading-13">1. ğŸŸ¢ é’è½´ï¼š"æ‰“å­—æœºçš„çµé­‚ç»§æ‰¿è€…"</h4>
<p>é’è½´çš„è§¦æ„Ÿå°±åƒ"åœ¨å¼¹é’¢ç´"ï¼Œæ¯ä¸€æ¬¡æ•²å‡»éƒ½æœ‰æ¸…è„†çš„"å’”å—’"å£°å’Œæ˜æ˜¾çš„æ®µè½æ„Ÿã€‚æ‰“å­—æ—¶å°±åƒåœ¨æ¼”å¥ä¸€é¦–èŠ‚å¥æ„Ÿåè¶³çš„æ›²å­ï¼Œéå¸¸è§£å‹ï¼</p>
<p><strong>é€‚åˆäººç¾¤</strong>ï¼šå–œæ¬¢æ‰“å­—å£°éŸ³ã€è¿½æ±‚æ®µè½æ„Ÿçš„ç”¨æˆ·
<strong>ä¸é€‚åˆ</strong>ï¼šå®‰é™çš„åŠå…¬å®¤ã€å®¿èˆï¼ˆä¼šè¢«æŠ•è¯‰ï¼‰</p>
<h4 data-id="heading-14">2. ğŸ”´ çº¢è½´ï¼š"ä¸æ»‘çš„çº¿æ€§ä½“éªŒ"</h4>
<p>çº¢è½´çš„è§¦æ„Ÿå°±åƒ"åœ¨æ‘¸ä¸ç»¸"ï¼Œçº¿æ€§é¡ºæ»‘ï¼Œæ²¡æœ‰æ®µè½æ„Ÿã€‚é•¿æ—¶é—´æ‰“å­—æˆ–ç©æ¸¸æˆä¹Ÿä¸ä¼šè§‰å¾—æ‰‹æŒ‡ç´¯ï¼Œè¢«ç§°ä¸º"é€€çƒ§è½´"ã€‚</p>
<p><strong>é€‚åˆäººç¾¤</strong>ï¼šé•¿æ—¶é—´ä½¿ç”¨é”®ç›˜ã€è¿½æ±‚é™éŸ³çš„ç”¨æˆ·
<strong>ä¸é€‚åˆ</strong>ï¼šå–œæ¬¢æ®µè½æ„Ÿå’Œå£°éŸ³çš„ç”¨æˆ·</p>
<h4 data-id="heading-15">3. ğŸŸ¡ èŒ¶è½´ï¼š"ä¸‡èƒ½è½´ä½“"</h4>
<p>èŒ¶è½´çš„è§¦æ„Ÿå°±åƒ"åœ¨æŒ‰åœ†ç ç¬”"ï¼Œæœ‰è½»å¾®çš„æ®µè½æ„Ÿï¼Œä½†å£°éŸ³ä¸å¤§ã€‚å…¼é¡¾äº†é’è½´çš„æ®µè½æ„Ÿå’Œçº¢è½´çš„é™éŸ³ï¼Œé€‚åˆå„ç§åœºæ™¯ã€‚</p>
<p><strong>é€‚åˆäººç¾¤</strong>ï¼šç¬¬ä¸€æ¬¡æ¥è§¦æœºæ¢°é”®ç›˜çš„ç”¨æˆ·ã€å…¼é¡¾æ‰“å­—å’Œæ¸¸æˆçš„ç”¨æˆ·
<strong>ä¸é€‚åˆ</strong>ï¼šè¿½æ±‚æè‡´ä½“éªŒçš„ç”¨æˆ·ï¼ˆè¦ä¹ˆé€‰é’è½´ï¼Œè¦ä¹ˆé€‰çº¢è½´ï¼‰</p>
<h4 data-id="heading-16">4. âš« é»‘è½´ï¼š"æ¸¸æˆç©å®¶çš„æœ€çˆ±"</h4>
<p>é»‘è½´çš„è§¦æ„Ÿå°±åƒ"åœ¨æŒ‰å¼¹ç°§"ï¼Œå‹åŠ›è¾ƒå¤§ï¼Œå›å¼¹è¿…é€Ÿã€‚é€‚åˆéœ€è¦å¿«é€Ÿè§¦å‘çš„æ¸¸æˆï¼Œæ¯”å¦‚ã€ŠCS:GOã€‹ã€Šå®ˆæœ›å…ˆé”‹ã€‹ç­‰ã€‚</p>
<p><strong>é€‚åˆäººç¾¤</strong>ï¼šç«æŠ€æ¸¸æˆç©å®¶ã€å–œæ¬¢é‡æ‰‹æ„Ÿçš„ç”¨æˆ·
<strong>ä¸é€‚åˆ</strong>ï¼šé•¿æ—¶é—´æ‰“å­—ï¼ˆæ‰‹æŒ‡ä¼šé…¸ï¼‰</p>
<h3 data-id="heading-17">ğŸ’¸ æœºæ¢°é”®ç›˜ä¸ºä»€ä¹ˆæ›´è´µï¼Ÿâ€”â€”æˆæœ¬æ‹†è§£</h3>















































<table><thead><tr><th>æˆæœ¬ç»„æˆ</th><th>æœºæ¢°é”®ç›˜</th><th>è–„è†œé”®ç›˜</th><th>å·®å€¼</th></tr></thead><tbody><tr><td><strong>è½´ä½“</strong></td><td>50-300å…ƒï¼ˆ87é”®ï¼‰</td><td>5-10å…ƒ</td><td>45-290å…ƒ</td></tr><tr><td><strong>é”®å¸½</strong></td><td>20-100å…ƒ</td><td>5-10å…ƒ</td><td>15-90å…ƒ</td></tr><tr><td><strong>PCBæ¿</strong></td><td>20-50å…ƒ</td><td>5-15å…ƒ</td><td>15-35å…ƒ</td></tr><tr><td><strong>å¤–å£³</strong></td><td>30-100å…ƒ</td><td>10-30å…ƒ</td><td>20-70å…ƒ</td></tr><tr><td><strong>å…¶ä»–</strong></td><td>10-50å…ƒï¼ˆRGBã€å«æ˜Ÿè½´ç­‰ï¼‰</td><td>5-10å…ƒ</td><td>5-40å…ƒ</td></tr><tr><td><strong>æ€»æˆæœ¬</strong></td><td>130-600å…ƒ</td><td>30-75å…ƒ</td><td>100-525å…ƒ</td></tr></tbody></table>
<p><strong>æ•°æ®æ”¯æ’‘</strong>ï¼š</p>
<ul>
<li>æœºæ¢°é”®ç›˜çš„è½´ä½“æˆæœ¬å æ€»æˆæœ¬çš„30-50%</li>
<li>ä¸€ä¸ªä¼˜è´¨çš„æœºæ¢°è½´ä½“æˆæœ¬åœ¨0.5-3å…ƒä¹‹é—´ï¼Œè€Œè–„è†œé”®ç›˜çš„æŒ‰é”®æˆæœ¬ä¸åˆ°0.1å…ƒ</li>
<li>æœºæ¢°é”®ç›˜çš„ä½¿ç”¨å¯¿å‘½æ˜¯è–„è†œé”®ç›˜çš„10å€</li>
</ul>
<h3 data-id="heading-18">ğŸ” å¸¸è§è¯¯åŒºçº æ­£</h3>
<h4 data-id="heading-19">1. "æœºæ¢°é”®ç›˜å°±æ˜¯å¥½ï¼Œè–„è†œé”®ç›˜éƒ½æ˜¯åƒåœ¾ï¼Ÿ"</h4>
<p>ä¸ï¼é€‚åˆè‡ªå·±çš„æ‰æ˜¯æœ€å¥½çš„ã€‚å¦‚æœä½ éœ€è¦å®‰é™ã€ä½æˆæœ¬çš„é”®ç›˜ï¼Œè–„è†œé”®ç›˜å¯èƒ½æ›´é€‚åˆä½ ï¼›å¦‚æœä½ è¿½æ±‚è§¦æ„Ÿå’Œè€ç”¨æ€§ï¼Œæœºæ¢°é”®ç›˜æ‰æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚</p>
<h4 data-id="heading-20">2. "é’è½´å£°éŸ³å¤ªå“ï¼Œä¼šå½±å“åˆ«äººï¼Ÿ"</h4>
<p>æ˜¯çš„ï¼é’è½´çš„å£°éŸ³å¯ä»¥è¾¾åˆ°60-70åˆ†è´ï¼Œç›¸å½“äºæ­£å¸¸è¯´è¯çš„å£°éŸ³ã€‚å¦‚æœä½ åœ¨åŠå…¬å®¤æˆ–å®¿èˆä½¿ç”¨ï¼Œå»ºè®®é€‰æ‹©çº¢è½´æˆ–èŒ¶è½´ã€‚</p>
<h4 data-id="heading-21">3. "æœºæ¢°é”®ç›˜ä¸€å®šæ¯”è–„è†œé”®ç›˜è´µï¼Ÿ"</h4>
<p>ä¸ä¸€å®šï¼ç°åœ¨ä¹Ÿæœ‰ä¸€äº›å…¥é—¨çº§æœºæ¢°é”®ç›˜ï¼Œä»·æ ¼åªæ¯”é«˜ç«¯è–„è†œé”®ç›˜è´µä¸€ç‚¹ï¼ˆ100-200å…ƒï¼‰ã€‚è€Œä¸”ä»ä½¿ç”¨å¯¿å‘½æ¥çœ‹ï¼Œæœºæ¢°é”®ç›˜çš„æ€§ä»·æ¯”æ›´é«˜ã€‚</p>
<h4 data-id="heading-22">4. "æœºæ¢°é”®ç›˜ä¸éœ€è¦ä¿å…»ï¼Ÿ"</h4>
<p>ä¸ï¼æœºæ¢°é”®ç›˜éœ€è¦å®šæœŸæ¸…æ´ï¼Œå¦åˆ™ç°å°˜ä¼šè¿›å…¥è½´ä½“ï¼Œå½±å“æ‰‹æ„Ÿå’Œå¯¿å‘½ã€‚å»ºè®®æ¯3-6ä¸ªæœˆæ¸…æ´ä¸€æ¬¡ã€‚</p>
<h3 data-id="heading-23">ğŸ”® æœªæ¥å±•æœ›ï¼šé”®ç›˜çš„å‘å±•è¶‹åŠ¿</h3>
<h4 data-id="heading-24">1. ğŸ¨ æ›´ä¸ªæ€§åŒ–çš„è®¾è®¡</h4>
<p>æœªæ¥çš„é”®ç›˜ä¼šæ›´åŠ ä¸ªæ€§åŒ–ï¼Œæ”¯æŒè‡ªå®šä¹‰è½´ä½“ã€é”®å¸½ã€RGBç¯å…‰ï¼Œç”šè‡³å¯ä»¥æ ¹æ®ç”¨æˆ·çš„æ‰“å­—ä¹ æƒ¯è‡ªåŠ¨è°ƒæ•´è§¦å‘å‹åŠ›ã€‚</p>
<h4 data-id="heading-25">2. ğŸ§  æ™ºèƒ½é”®ç›˜</h4>
<p>æ™ºèƒ½é”®ç›˜ä¼šèå…¥AIæŠ€æœ¯ï¼Œæ”¯æŒè¯­éŸ³è¾“å…¥ã€æ‰‹åŠ¿æ§åˆ¶ã€è¡¨æƒ…è¯†åˆ«ç­‰åŠŸèƒ½ï¼Œæˆä¸ºè¿æ¥äººä¸ç”µè„‘çš„æ™ºèƒ½æ¡¥æ¢ã€‚</p>
<h4 data-id="heading-26">3. ğŸ¯ æ›´å¥åº·çš„è®¾è®¡</h4>
<p>äººä½“å·¥å­¦é”®ç›˜ä¼šè¶Šæ¥è¶Šæ™®åŠï¼Œå‡å°‘é•¿æ—¶é—´æ‰“å­—å¯¹é¢ˆæ¤ã€æ‰‹è…•çš„ä¼¤å®³ã€‚æ¯”å¦‚åˆ†åˆ—å¼é”®ç›˜ã€å‚ç›´é”®ç›˜ç­‰ã€‚</p>
<h4 data-id="heading-27">4. ğŸ”‹ æ— çº¿åŒ–è¶‹åŠ¿</h4>
<p>éšç€è“ç‰™å’Œ2.4GæŠ€æœ¯çš„å‘å±•ï¼Œæ— çº¿æœºæ¢°é”®ç›˜ä¼šè¶Šæ¥è¶Šæµè¡Œï¼Œæ‘†è„±çº¿ç¼†çš„æŸç¼šï¼Œè®©æ¡Œé¢æ›´åŠ æ•´æ´ã€‚</p>
<h3 data-id="heading-28">ğŸ“ äº’åŠ¨å°æµ‹éªŒï¼šä½ ç­”å¯¹äº†å—ï¼Ÿ</h3>



































<table><thead><tr><th>é—®é¢˜</th><th>ç­”æ¡ˆ</th><th>ä½ ç­”å¯¹äº†å—ï¼Ÿ</th></tr></thead><tbody><tr><td>æœºæ¢°é”®ç›˜çš„ä½¿ç”¨å¯¿å‘½æ˜¯å¤šå°‘ï¼Ÿ</td><td>5000ä¸‡æ¬¡æ•²å‡»</td><td>âœ…/âŒ</td></tr><tr><td>å“ªä¸ªè½´ä½“å£°éŸ³æœ€å¤§ï¼Ÿ</td><td>é’è½´</td><td>âœ…/âŒ</td></tr><tr><td>å“ªä¸ªè½´ä½“é€‚åˆé•¿æ—¶é—´æ‰“å­—ï¼Ÿ</td><td>çº¢è½´</td><td>âœ…/âŒ</td></tr><tr><td>è–„è†œé”®ç›˜çš„æ ¸å¿ƒç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ</td><td>ä¸‰å±‚è–„è†œç”µè·¯</td><td>âœ…/âŒ</td></tr><tr><td>æœºæ¢°é”®ç›˜ä¸ºä»€ä¹ˆæ›´è´µï¼Ÿ</td><td>è½´ä½“æˆæœ¬é«˜</td><td>âœ…/âŒ</td></tr></tbody></table>
<h3 data-id="heading-29">ğŸ¯ ç»“è¯­ï¼šè§¦æ„Ÿçš„é©å‘½</h3>
<p>é”®ç›˜çš„å‘å±•ï¼Œå°±æ˜¯äººç±»è¿½æ±‚æ›´å¥½è¾“å…¥ä½“éªŒçš„å†å²ã€‚ä»ç¬¨é‡çš„æ‰“å­—æœºåˆ°è½»è–„çš„è–„è†œé”®ç›˜ï¼Œå†åˆ°è§¦æ„Ÿä¸°å¯Œçš„æœºæ¢°é”®ç›˜ï¼Œæ¯ä¸€æ¬¡è¿›æ­¥éƒ½è®©æˆ‘ä»¬çš„è¾“å…¥æ›´åŠ èˆ’é€‚ã€é«˜æ•ˆã€‚</p>
<p>ä¸‹æ¬¡ä½¿ç”¨é”®ç›˜æ—¶ï¼Œä¸å¦¨æ„Ÿå—ä¸€ä¸‹å®ƒçš„è§¦æ„Ÿå’Œå£°éŸ³ï¼Œæƒ³æƒ³èƒŒåçš„æŠ€æœ¯åŸç†ã€‚é€‚åˆè‡ªå·±çš„é”®ç›˜ï¼Œèƒ½è®©ä½ çš„å·¥ä½œå’Œæ¸¸æˆæ›´åŠ æ„‰å¿«ï¼</p>
<hr/>
<h3 data-id="heading-30">ğŸ’¬ äº’åŠ¨è¯é¢˜</h3>
<ol>
<li>ä½ ç°åœ¨ç”¨çš„æ˜¯æœºæ¢°é”®ç›˜è¿˜æ˜¯è–„è†œé”®ç›˜ï¼Ÿæ»¡æ„å—ï¼Ÿ</li>
<li>ä½ æœ€å–œæ¬¢å“ªç§è½´ä½“ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</li>
<li>ä½ è§‰å¾—æœºæ¢°é”®ç›˜çš„ä»·æ ¼åˆç†å—ï¼Ÿ</li>
</ol>
<p>å¿«æ¥è¯„è®ºåŒºèŠèŠä½ çš„æƒ³æ³•ï¼ğŸ’¬ ç‚¹èµæ”¶è—ä¸è¿·è·¯ï¼Œå’±ä»¬ä¸‹æœŸç»§ç»­æ¢ç´¢è®¡ç®—æœºçš„"åä¸‡ä¸ªä¸ºä»€ä¹ˆ"ï¼ğŸ‰</p>
<p><strong>å…³æ³¨æˆ‘</strong>ï¼Œä¸‹æœŸå¸¦ä½ è§£é”æ›´å¤šè®¡ç®—æœºçš„"å¥‡è‘©å†·çŸ¥è¯†"ï¼ğŸ¤“</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä» Todo é¡¹ç›®çœ‹ React ç»„ä»¶é€šä¿¡ï¼šæ ¸å¿ƒé€»è¾‘ä¸ä¼˜åŒ–æŠ€å·§]]></title>    <link>https://juejin.cn/post/7587175302347898915</link>    <guid>https://juejin.cn/post/7587175302347898915</guid>    <pubDate>2025-12-24T03:17:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587175302347898915" data-draft-id="7587175302347849763" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä» Todo é¡¹ç›®çœ‹ React ç»„ä»¶é€šä¿¡ï¼šæ ¸å¿ƒé€»è¾‘ä¸ä¼˜åŒ–æŠ€å·§"/> <meta itemprop="keywords" content="React.js"/> <meta itemprop="datePublished" content="2025-12-24T03:17:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç™½å…°åœ°ç©ºç“¶"/> <meta itemprop="url" content="https://juejin.cn/user/191753514127514"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä» Todo é¡¹ç›®çœ‹ React ç»„ä»¶é€šä¿¡ï¼šæ ¸å¿ƒé€»è¾‘ä¸ä¼˜åŒ–æŠ€å·§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/191753514127514/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç™½å…°åœ°ç©ºç“¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T03:17:15.000Z" title="Wed Dec 24 2025 03:17:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>React çœŸæ­£è®©äººå¤´ç–¼çš„ï¼Œä»æ¥ä¸æ˜¯ Hooks çš„ APIï¼Œè€Œæ˜¯ï¼šç»„ä»¶ä¸€å¤šï¼Œæ•°æ®åˆ°åº•è¯¥å¾€å“ªæ”¾ï¼Ÿ</strong></p>
</blockquote>
<p>å¾ˆå¤šäººå†™ Reactï¼Œéƒ½æ˜¯å…¸å‹çš„ã€Œèƒ½è·‘å°±è¡Œã€ğŸ‘‡</p>
<ul>
<li>Props å±‚å±‚ä¼ é€’ï¼ˆProp Drillingï¼‰ï¼Œæ”¹ä¸€ä¸ªé€»è¾‘è¦åŠ¨äº”ä¸ªæ–‡ä»¶</li>
<li>å…„å¼Ÿç»„ä»¶çŠ¶æ€ä¸åŒæ­¥ï¼ŒBug åƒâ€œé‡å­çº ç¼ â€</li>
<li>Debug åƒç ´æ¡ˆï¼Œæ ¹æœ¬ä¸çŸ¥é“æ˜¯è°æŠŠ <code>todos</code> æ”¹äº†</li>
</ul>
<p><strong>é—®é¢˜ä¸åœ¨è¯­æ³•ï¼Œåœ¨â€œé€šä¿¡æ¨¡å‹â€æ²¡è®¾è®¡æ¸…æ¥šã€‚</strong></p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±é€šè¿‡ä¸€ä¸ªç»å…¸çš„ <strong>Todo List é¡¹ç›®</strong>ï¼ŒæŠŠ React ç»„ä»¶é€šä¿¡çš„<strong>åº•å±‚é€»è¾‘ä¸€æ¬¡æ€§è®²é€</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€æ¶æ„å…ˆè¡Œï¼šå…ˆç«™åœ¨â€œä¸Šå¸è§†è§’â€çœ‹ç»„ä»¶æ ‘</h2>
<blockquote>
<p><strong>åœ¨ React é‡Œï¼Œé€šä¿¡é—®é¢˜ 80% ä¸æ˜¯ä»£ç é—®é¢˜ï¼Œè€Œæ˜¯ç»“æ„é—®é¢˜ã€‚</strong></p>
</blockquote>
<h3 data-id="heading-1">1ï¸âƒ£ ç»„ä»¶åˆ†å·¥ä¸€è§ˆ</h3>
<pre><code class="hljs language-arduino" lang="arduino">App
â”œâ”€â”€ TodoInput   <span class="hljs-comment">// åŠ¨ä½œå‘èµ·è€…</span>
â”œâ”€â”€ TodoList    <span class="hljs-comment">// çŠ¶æ€å±•ç¤ºè€…</span>
â””â”€â”€ TodoStats   <span class="hljs-comment">// æ•°æ®ç»Ÿè®¡è€…</span>
</code></pre>
<ul>
<li><strong>Appï¼ˆæ•°æ®ä¸­å¿ƒï¼‰</strong><br/>
å”¯ä¸€çš„ <em>Source of Truth</em>ï¼ŒæŒæœ‰ <code>todos</code></li>
<li><strong>TodoInputï¼ˆåŠ¨ä½œå‘èµ·è€…ï¼‰</strong><br/>
åªè´Ÿè´£æ”¶é›†è¾“å…¥ï¼Œä¸å…³å¿ƒæ•°æ®å­˜å“ª</li>
<li><strong>TodoListï¼ˆå±•ç¤ºè€…ï¼‰</strong><br/>
æ¸²æŸ“åˆ—è¡¨ï¼Œå¹¶è§¦å‘â€œåˆ é™¤ / åˆ‡æ¢å®Œæˆæ€â€</li>
<li><strong>TodoStatsï¼ˆç»Ÿè®¡è€…ï¼‰</strong><br/>
æ ¹æ®æ•°æ®è®¡ç®—ç»Ÿè®¡ä¿¡æ¯ï¼Œå¹¶æä¾›â€œæ¸…ç©ºâ€èƒ½åŠ›</li>
</ul>
<hr/>
<h3 data-id="heading-2">2ï¸âƒ£ æ ¸å¿ƒåŸåˆ™ï¼šçŠ¶æ€æå‡ï¼ˆLifting State Upï¼‰</h3>
<blockquote>
<p><strong>åªè¦å¤šä¸ªç»„ä»¶å…±äº«åŒä¸€ä»½æ•°æ®ï¼Œè¿™ä»½æ•°æ®å°±å¿…é¡»ä¸Šç§»ã€‚</strong></p>
</blockquote>
<p>ä¸ºä»€ä¹ˆ <code>todos</code> ä¸èƒ½æ”¾åœ¨ <code>TodoList</code>ï¼Ÿ</p>
<p>å› ä¸ºï¼š</p>
<ul>
<li>TodoInput è¦æ–°å¢</li>
<li>TodoStats è¦ç»Ÿè®¡</li>
<li>TodoList è¦å±•ç¤º</li>
</ul>
<p>ğŸ‘‰ <strong>ä¸‰è€…å…±äº« â‡’ æ•°æ®åªèƒ½æ”¾åœ¨æœ€è¿‘çš„å…±åŒçˆ¶ç»„ä»¶ App</strong></p>
<p>è¿™ä¸æ˜¯æœ€ä½³å®è·µï¼Œè¿™æ˜¯ <strong>React çš„è®¾è®¡å‰æ</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-3">äºŒã€ä¸‰å¤§é€šä¿¡åœºæ™¯æ·±åº¦æ‹†è§£</h2>
<hr/>
<h3 data-id="heading-4">1ï¸âƒ£ çˆ¶ â†’ å­ï¼šProps ä¸æ˜¯â€œä¼ æ•°æ®â€ï¼Œè€Œæ˜¯â€œæˆäºˆä½¿ç”¨æƒâ€</h3>
<p>åœ¨ <code>App.jsx</code> ä¸­ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;TodoList
  <span class="hljs-attr">todos</span>={todos}
  <span class="hljs-attr">onDelete</span>={deleteTodo}
  <span class="hljs-attr">onToggle</span>={toggleTodo}
/&gt;
</code></pre>
<p>ğŸ’¡ <strong>æ·±åº¦ç†è§£ Propsï¼š</strong></p>
<blockquote>
<p>Props ä¸æ˜¯æ‹·è´ä¸€ä»½æ•°æ®<br/>
è€Œæ˜¯çˆ¶ç»„ä»¶ç»™å­ç»„ä»¶çš„ã€Œåªè¯»ä½¿ç”¨æƒã€</p>
</blockquote>
<p>ğŸ“Œ ç±»æ¯”ä¸€ä¸‹ï¼š</p>
<ul>
<li>çˆ¶ç»„ä»¶æ˜¯è€æ¿</li>
<li>Props æ˜¯ä»»åŠ¡æ¸…å•</li>
<li>å­ç»„ä»¶åªèƒ½<strong>ç…§å•æ‰§è¡Œï¼Œä¸èƒ½ç§è‡ªæ”¹å•</strong></li>
</ul>
<p><strong>å­ç»„ä»¶æ°¸è¿œä¸åº”è¯¥ä¿®æ”¹ Propsã€‚</strong></p>
<hr/>
<h3 data-id="heading-5">2ï¸âƒ£ å­ â†’ çˆ¶ï¼šä»â€œæ”¹æ•°æ®â€åˆ°â€œä¸ŠæŠ¥äº‹ä»¶â€</h3>
<p>è¿™æ˜¯ React æ–°æ‰‹<strong>æœ€å®¹æ˜“çŠ¯é”™</strong>çš„åœ°æ–¹ã€‚</p>
<p>âŒ é”™è¯¯æ€ç»´ï¼š</p>
<blockquote>
<p>â€œæˆ‘èƒ½ä¸èƒ½åœ¨å­ç»„ä»¶é‡Œç›´æ¥ <code>props.todos.push()</code>ï¼Ÿâ€</p>
</blockquote>
<p>âœ… æ­£ç¡®æ¨¡å‹ï¼š</p>
<blockquote>
<p><strong>å­ç»„ä»¶åªè´Ÿè´£â€œä¸ŠæŠ¥è¡Œä¸ºâ€ï¼Œä¸è´Ÿè´£â€œå†³å®šç»“æœâ€</strong></p>
</blockquote>
<hr/>
<p>åœ¨ <code>TodoInput</code> ä¸­ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">TodoInput</span> = ({ <span class="hljs-literal">on</span>Add }) =&gt; {
  const <span class="hljs-section">[text, setText]</span> = useState('')<span class="hljs-comment">;</span>

  const <span class="hljs-attr">handleSubmit</span> = () =&gt; {
    if (!text.trim()) return<span class="hljs-comment">;</span>
    onAdd(text)<span class="hljs-comment">; // ğŸ“¢ å‘çˆ¶ç»„ä»¶ä¸ŠæŠ¥ï¼šæ–°å¢äº†ä¸€ä¸ªä»»åŠ¡</span>
    setText('')<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-6">â“ ä¸ºä»€ä¹ˆä¸€å®šè¦ç”¨å‡½æ•°ï¼Ÿ</h3>
<p>å› ä¸ºï¼š</p>
<ul>
<li>åªæœ‰ App æŒæœ‰ <code>setTodos</code></li>
<li>åªæœ‰ App æœ‰èµ„æ ¼å†³å®šæ•°æ®å¦‚ä½•å˜åŒ–</li>
<li>Bug å‡ºç°æ—¶ï¼Œä½ åªéœ€è¦æ£€æŸ¥ <strong>ä¸€ä¸ªåœ°æ–¹</strong></li>
</ul>
<blockquote>
<p><strong>æŠŠâ€œä¿®æ”¹æƒâ€é›†ä¸­ï¼Œæ˜¯ React å¯ç»´æŠ¤æ€§çš„æ ¸å¿ƒæ¥æºã€‚</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-7">3ï¸âƒ£ å…„å¼Ÿç»„ä»¶é€šä¿¡ï¼šæœ€ç†Ÿæ‚‰çš„é™Œç”Ÿäºº</h3>
<blockquote>
<p><strong>TodoStats å¦‚ä½•â€œçŸ¥é“â€ TodoList é‡Œå‘ç”Ÿäº†å˜åŒ–ï¼Ÿ</strong></p>
</blockquote>
<p>ç­”æ¡ˆæ˜¯ï¼š<strong>å®ƒå¹¶ä¸çŸ¥é“ã€‚</strong></p>
<hr/>
<h3 data-id="heading-8">æ­£ç¡®æµç¨‹æ˜¯è¿™æ ·çš„ï¼š</h3>
<p>1ï¸âƒ£ TodoList è§¦å‘ <code>onToggle</code>ï¼ˆå­ â†’ çˆ¶ï¼‰<br/>
2ï¸âƒ£ App æ›´æ–° <code>todos</code><br/>
3ï¸âƒ£ App é‡æ–°æ¸²æŸ“<br/>
4ï¸âƒ£ æ–°çš„ <code>todos</code> é€šè¿‡ Props ä¸‹å‘ç»™ TodoStats</p>
<p>ğŸ’¡ <strong>é‡‘å¥è®°ä½è¿™ä¸€å¥ï¼š</strong></p>
<blockquote>
<p><strong>åœ¨ React ä¸­ï¼Œå…„å¼Ÿç»„ä»¶ä¹‹é—´æ°¸è¿œâ€œäº’ä¸è®¤è¯†â€ï¼Œå®ƒä»¬åªå¯¹çˆ¶ç»„ä»¶è´Ÿè´£ã€‚</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-9">ä¸‰ã€é«˜é˜¶æŠ€å·§ï¼šé¿å¼€é€šä¿¡ä¸­çš„â€œéšå½¢å‘â€</h2>
<hr/>
<h3 data-id="heading-10">1ï¸âƒ£ åˆ«æŠŠ Props å½“ Stateï¼šè­¦æƒ•æ´¾ç”ŸçŠ¶æ€</h3>
<p>âŒ å¸¸è§é”™è¯¯ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">const <span class="hljs-selector-attr">[activeCount, setActiveCount]</span> = <span class="hljs-built_in">useState</span>(<span class="hljs-number">0</span>);

<span class="hljs-built_in">useEffect</span>(() =&gt; {
  <span class="hljs-built_in">setActiveCount</span>(todos.filter(t =&gt; !t.completed)<span class="hljs-selector-class">.length</span>);
}, <span class="hljs-selector-attr">[todos]</span>);
</code></pre>
<p>âœ… æ­£ç¡®åšæ³•ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">activeCount</span> = todos.filter(todo =&gt; !todo.completed).length<span class="hljs-comment">;</span>
</code></pre>
<p>ğŸ“Œ <strong>åŸåˆ™åªæœ‰ä¸€å¥è¯ï¼š</strong></p>
<blockquote>
<p><strong>å¦‚æœä¸€ä¸ªå€¼å¯ä»¥é€šè¿‡ Props è®¡ç®—å¾—å‡ºï¼Œå°±æ°¸è¿œä¸è¦ç”¨ useState å­˜ã€‚</strong></p>
</blockquote>
<p>è¿™ç±»æ•°æ®å«ï¼š<strong>æ´¾ç”ŸçŠ¶æ€ï¼ˆDerived Stateï¼‰</strong> ã€‚</p>
<hr/>
<h3 data-id="heading-11">2ï¸âƒ£ åªæœ‰â€œå‰¯ä½œç”¨â€æ‰è¿› useEffect</h3>
<p>åœ¨ Todo é¡¹ç›®ä¸­ï¼ŒçœŸæ­£éœ€è¦ <code>useEffect</code> çš„åªæœ‰ä¸€ä»¶äº‹ğŸ‘‡</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'todos'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(todos));
}, [todos]);
</code></pre>
<p>âœ… ç‰¹ç‚¹ï¼š</p>
<ul>
<li>ä¸å½±å“æ¸²æŸ“</li>
<li>ä¾èµ–æ˜ç¡®</li>
<li>èŒè´£å•ä¸€</li>
</ul>
<p>ğŸ‘‰ <strong>è¿™æ‰æ˜¯ useEffect çš„æ­£ç¡®å§¿åŠ¿ã€‚</strong></p>
<hr/>
<h2 data-id="heading-12">å››ã€æ€»ç»“ï¼šReact é€šä¿¡çš„â€œç§©åºæ„Ÿâ€</h2>
<p>React åšæŒå•å‘æ•°æ®æµï¼Œä¸æ˜¯ä¸ºäº†é™åˆ¶ä½ ï¼Œè€Œæ˜¯ä¸ºäº†<strong>å»ºç«‹ç§©åº</strong>ã€‚</p>
<p>ğŸ“Œ è®°ä½è¿™ 4 å¥è¯ï¼š</p>
<ul>
<li><strong>æ•°æ®å‘ä¸Šæ‰¾</strong>ï¼šå…±äº«å°±æå‡</li>
<li><strong>å±•ç¤ºå‘ä¸‹èµ°</strong>ï¼šå­ç»„ä»¶åªçœ‹ Props</li>
<li><strong>ä¿®æ”¹è°ƒå‡½æ•°</strong>ï¼šå­ç»„ä»¶åŠ¨å£ä¸åŠ¨æ‰‹</li>
<li><strong>å…„å¼Ÿä¸ç›´è¿</strong>ï¼šçˆ¶ç»„ä»¶æ¥è½¬è¾¾</li>
</ul>
<hr/>
<h2 data-id="heading-13">ğŸ”¥ æœ€åé€ä½  5 å¥å¼€å‘å£è¯€</h2>
<blockquote>
<p>âœ… çŠ¶æ€æ”¾å¯¹ä½ï¼Œä»£ç çœä¸€åŠ<br/>
âœ… Props æ˜¯åˆåŒï¼Œå­ç»„ä»¶å¾—ç…§åŠ<br/>
âœ… æ”¹æ•°æ®å‘è¯·æ±‚ï¼Œåˆ«åœ¨å­ç»„ä»¶é‡Œä¹±èµ°<br/>
âœ… å…„å¼Ÿä¸ä¼ è¯ï¼Œè€çˆ¸æ¥è½¬è¾¾<br/>
âœ… ç®—å‡ºæ¥çš„çŠ¶æ€ï¼Œåˆ«ç”¨ State å­˜</p>
</blockquote>
<hr/>
<h3 data-id="heading-14">ğŸ¯ ç»“è¯­</h3>
<p>Todo é¡¹ç›®å¾ˆå°ï¼Œ<br/>
ä½†å®ƒå‡ ä¹è¦†ç›–äº† <strong>React ç»„ä»¶é€šä¿¡çš„æ‰€æœ‰æ ¸å¿ƒåœºæ™¯</strong>ã€‚</p>
<p>å¦‚æœä½ çœŸæ­£åƒé€è¿™ä¸€å¥—æ¨¡å‹ï¼š</p>
<ul>
<li>Redux / Zustand ä¼šç«‹åˆ»â€œé€šç”µâ€</li>
<li>é¡¹ç›®è¶Šå¤§ï¼Œä½ è¶Šç¨³</li>
<li>é¢è¯•å®˜é—®ç»„ä»¶é€šä¿¡ï¼Œä½ èƒ½è®²<strong>è®¾è®¡è€Œä¸æ˜¯ API</strong></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥è§£æ Binder è¿è¡Œçš„çŠ¶æ€]]></title>    <link>https://juejin.cn/post/7586934804291305506</link>    <guid>https://juejin.cn/post/7586934804291305506</guid>    <pubDate>2025-12-24T03:03:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586934804291305506" data-draft-id="7586941468873228322" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥è§£æ Binder è¿è¡Œçš„çŠ¶æ€"/> <meta itemprop="keywords" content="Android,APP"/> <meta itemprop="datePublished" content="2025-12-24T03:03:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ„¤æ€’çš„ä»£ç "/> <meta itemprop="url" content="https://juejin.cn/user/4125023358426190"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥è§£æ Binder è¿è¡Œçš„çŠ¶æ€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4125023358426190/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ„¤æ€’çš„ä»£ç 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T03:03:42.000Z" title="Wed Dec 24 2025 03:03:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å½“å‡ºç°åº”ç”¨å¡é¡¿ç­‰æ€§èƒ½é—®é¢˜æ—¶ï¼Œå¦‚ä½•é€šè¿‡æŸ¥çœ‹ Binder çš„è¿è¡Œæ—¶çŠ¶æ€æ¥è¯Šæ–­ä½ çš„åº”ç”¨ï¼Ÿæœ¬æ–‡å°†å±•ç¤ºäº†ä¸€ä¸ªç®€å•å®ç”¨çš„æ‰‹æ®µ</p>
<h3 data-id="heading-0">0x00. æŸ¥çœ‹ Binder å®ä½“è¿è¡ŒçŠ¶æ€</h3>
<ol>
<li><strong>ç¯å¢ƒå‡†å¤‡ï¼š</strong> éœ€è¦ä¸€å° Root è¿‡çš„æ‰‹æœºæˆ–æ¨¡æ‹Ÿå™¨ã€‚</li>
<li><strong>æ‰§è¡Œå‘½ä»¤ï¼š</strong> è¾“å‡ºæ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œè¿™é‡Œä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­</li>
</ol>
<pre><code class="hljs language-Shell" lang="Shell">adb shell cat /sys/kernel/debug/binder/state &gt; binder.txt
</code></pre>
<ol start="3">
<li><strong>åˆ†æé‡ç‚¹ï¼š</strong> åœ¨è¾“å‡ºçš„å·¨é‡æ–‡æœ¬ä¸­ï¼Œæ‰¾åˆ°ä½ æ­£åœ¨å¼€å‘çš„ App PIDï¼ˆæœ¬æ–‡PID=3011ï¼‰ã€‚</li>
</ol>
<ul>
<li>çœ‹ <code>proc</code> èŠ‚ç‚¹ï¼šå®ƒå¼€äº†å¤šå°‘ä¸ªçº¿ç¨‹ï¼ˆ<code>threads</code>ï¼‰ï¼Ÿ</li>
<li>çœ‹ <code>nodes</code>ï¼šå®ƒæš´éœ²äº†å¤šå°‘ä¸ª Binder å®ä½“ï¼ˆæœåŠ¡ï¼‰ç»™åˆ«äººç”¨ï¼Ÿ</li>
<li>çœ‹ <code>refs</code>ï¼šå®ƒå¼•ç”¨äº†å¤šå°‘ä¸ªè¿œç¨‹æœåŠ¡ï¼Ÿ</li>
</ul>
<p>è¾“å‡ºçš„ binder.txt å†…å®¹å®åœ¨å¤ªå¤§ï¼Œè¿™é‡Œåªå±•ç¤ºPID:3011(åŒ…åä¸º<code>com.android.launcher3</code>)çš„binder è¿è¡ŒçŠ¶æ€</p>
<pre><code class="hljs language-shell" lang="shell">proc 3011
context binder
  thread 3011: l 00 need_return 0 tr 0
  thread 3060: l 12 need_return 0 tr 0
  thread 3061: l 11 need_return 0 tr 0
  thread 3062: l 11 need_return 0 tr 0
  thread 3136: l 00 need_return 0 tr 0
  thread 3196: l 00 need_return 0 tr 0
  thread 3198: l 00 need_return 0 tr 0
  thread 3203: l 11 need_return 0 tr 0
  thread 3209: l 00 need_return 0 tr 0
  thread 3210: l 00 need_return 0 tr 0
  node 30941: ub400006dcd0c4b20 cb400006dfd0981d0 pri 0:139 hs 1 hw 1 ls 0 lw 0 is 1 iw 1 tr 1 proc 1411
  node 31046: ub400006dcd0d70f0 cb400006dfd0988f0 pri 0:139 hs 1 hw 1 ls 0 lw 0 is 1 iw 1 tr 1 proc 1411
  node 33583: ub400006dcd0f07a0 cb400006dfd0ac930 pri 0:139 hs 1 hw 1 ls 0 lw 0 is 1 iw 1 tr 1 proc 1411
  node 63104: ub400006dcd0f2060 cb400006e2d120db8 pri 0:139 hs 1 hw 1 ls 1 lw 1 is 0 iw 0 tr 1
  node 33482: ub400006dcd0f4f40 cb400006ded0b0d30 pri 0:139 hs 1 hw 1 ls 0 lw 0 is 1 iw 1 tr 1 proc 581
  node 32258: ub400006dcd0f7cd0 cb400006dfd09ee30 pri 0:139 hs 1 hw 1 ls 0 lw 0 is 2 iw 2 tr 1 proc 2643 1411
  node 32218: ub400006dcd0f7d60 cb400006dfd0a06f0 pri 0:139 hs 1 hw 1 ls 0 lw 0 is 1 iw 1 tr 1 proc 1411
  node 32256: ub400006dcd0f7e80 cb400006dfd09fcd0 pri 0:139 hs 1 hw 1 ls 0 lw 0 is 1 iw 1 tr 1 proc 1411
  node 32262: ub400006dcd0f7eb0 cb400006dfd0969d0 pri 0:139 hs 1 hw 1 ls 0 lw 0 is 1 iw 1 tr 1 proc 1411
  node 32295: ub400006dcd0f7ee0 cb400006dfd09f310 pri 0:139 hs 1 hw 1 ls 0 lw 0 is 1 iw 1 tr 1 proc 1411
  node 32308: ub400006dcd0f8120 cb400006dfd09f370 pri 0:139 hs 1 hw 1 ls 0 lw 0 is 1 iw 1 tr 1 proc 1411
  node 32091: ub400006dcd0f8240 cb400006dfd09f010 pri 0:139 hs 1 hw 1 ls 0 lw 0 is 1 iw 1 tr 1 proc 1411
  node 31614: ub400006dcd102d10 cb400006dfd09e950 pri 0:139 hs 1 hw 1 ls 0 lw 0 is 1 iw 1 tr 1 proc 1411
  ref 30933: desc 0 node 1 s 1 w 1 d 0000000000000000
  ref 30936: desc 1 node 3466 s 1 w 1 d 0000000000000000
  ref 30955: desc 2 node 2917 s 1 w 1 d 0000000000000000
  ref 30956: desc 3 node 2714 s 1 w 1 d 0000000000000000
  ref 30957: desc 4 node 4037 s 1 w 1 d 0000000000000000
  ref 30958: desc 5 node 8172 s 1 w 1 d 0000000000000000
  ref 30959: desc 6 node 3446 s 1 w 1 d 0000000000000000
  ref 30960: desc 7 node 4200 s 1 w 1 d 0000000000000000
  ref 30962: desc 8 node 4418 s 1 w 1 d 0000000000000000
  ref 30963: desc 9 node 3462 s 1 w 1 d 0000000000000000
  ref 30964: desc 10 node 4150 s 1 w 1 d 0000000000000000
  ref 30965: desc 11 node 4205 s 1 w 1 d 0000000000000000
  ref 30966: desc 12 node 4519 s 1 w 1 d 0000000000000000
  ref 30967: desc 13 node 2775 s 1 w 1 d 0000000000000000
  ref 30968: desc 14 node 6037 s 1 w 1 d 0000000000000000
  ref 30969: desc 15 node 4041 s 1 w 1 d 0000000000000000
  ref 30970: desc 16 node 4411 s 1 w 1 d 0000000000000000
  ref 30971: desc 17 node 8081 s 1 w 1 d 0000000000000000
  ref 30972: desc 18 node 4124 s 1 w 1 d 0000000000000000
  ref 30973: desc 19 node 2860 s 1 w 1 d 0000000000000000
  ref 30974: desc 20 node 5801 s 1 w 1 d 0000000000000000
  ref 30975: desc 21 node 4878 s 1 w 1 d 0000000000000000
  ref 30992: desc 22 node 30991 s 1 w 1 d 0000000000000000
  ref 30994: desc 23 node 30993 s 1 w 1 d 0000000000000000
  ref 31597: desc 24 node 571 s 1 w 1 d 0000000000000000
  ref 31601: desc 25 node 31600 s 1 w 1 d 0000000000000000
  ref 31819: desc 26 node 31818 s 1 w 1 d 0000000000000000
  ref 31757: desc 27 node 2168 s 1 w 1 d 0000000000000000
  ref 31771: desc 28 node 999 s 1 w 1 d 0000000000000000
  ref 31989: desc 29 node 9401 s 1 w 1 d 0000000000000000
  ref 31991: desc 30 node 31990 s 1 w 1 d 0000000000000000
  ref 32266: desc 31 node 32265 s 1 w 1 d 0000000000000000
  ref 32270: desc 32 node 32269 s 1 w 1 d 0000000000000000
  ref 32339: desc 33 node 32338 s 1 w 1 d 0000000000000000
  ref 32569: desc 34 node 8313 s 1 w 1 d 0000000000000000
  ref 32577: desc 35 node 8319 s 1 w 1 d 0000000000000000
  ref 33004: desc 36 node 32318 s 1 w 1 d 0000000000000000
  ref 33005: desc 37 node 32981 s 1 w 1 d 0000000000000000
  ref 33006: desc 38 node 32983 s 1 w 1 d 0000000000000000
  ref 33023: desc 39 node 18749 s 1 w 1 d 0000000000000000
  ref 78180: desc 40 node 78169 s 1 w 1 d 0000000000000000
  ref 61925: desc 41 node 61900 s 1 w 1 d 0000000000000000
  ref 33739: desc 42 node 33725 s 1 w 1 d 0000000000000000
  ref 33740: desc 43 node 33710 s 1 w 1 d 0000000000000000
  ref 33858: desc 44 node 25540 s 1 w 1 d 0000000000000000
  ref 33859: desc 45 node 33759 s 1 w 1 d 0000000000000000
  buffer 33519: 0000000000000000 size 8:0:0 delivered
  buffer 63108: 0000000000000000 size 0:0:0 delivered
  buffer 32963: 0000000000000000 size 36:0:0 delivered
  buffer 63164: 0000000000000000 size 144:0:0 delivered
</code></pre>
<h3 data-id="heading-1">0x01. çº¿ç¨‹æ± çŠ¶æ€åˆ†æï¼ˆThreadsï¼‰</h3>
<p>è¿™é‡Œåˆ—å‡ºäº† 10 ä¸ªçº¿ç¨‹ï¼ˆä» 3011 åˆ° 3210ï¼‰ã€‚</p>
<ul>
<li>
<p><strong>å…³é”®æ•°æ®ï¼š</strong> <code>l</code> å€¼ï¼ˆä»£è¡¨ <code>looper</code> çŠ¶æ€ï¼‰ã€‚</p>
<ul>
<li><code>l 11</code> (BC_REGISTER_LOOPER) å’Œ <code>l 12</code> (BC_ENTER_LOOPER) è¡¨ç¤ºè¿™äº›çº¿ç¨‹æ˜¯ <strong>Binder å·¥ä½œçº¿ç¨‹</strong>ã€‚</li>
<li><code>thread 3060, 3061, 3062, 3203</code> è¿™å››ä¸ªçº¿ç¨‹ç›®å‰å¤„äº Ready çŠ¶æ€ï¼Œç­‰å¾…ä»»åŠ¡ã€‚</li>
</ul>
</li>
<li>
<p><strong>ä¸“å®¶è§†è§’ï¼š</strong> * <strong>å¥åº·åº¦ï¼š</strong> 10 ä¸ªçº¿ç¨‹è¿œæœªè¾¾åˆ°é»˜è®¤çš„ 15 ä¸ªä¸Šé™ï¼Œè¯´æ˜è¯¥è¿›ç¨‹ç›®å‰æ²¡æœ‰ Binder çº¿ç¨‹é¥¥é¥¿é—®é¢˜ã€‚</p>
<ul>
<li><strong>ä¸»çº¿ç¨‹ï¼š</strong> <code>thread 3011</code> æ˜¯ä¸»çº¿ç¨‹ï¼ˆPID=TIDï¼‰ï¼Œå®ƒçš„ <code>tr 0</code> è¡¨ç¤ºç›®å‰æ²¡æœ‰æ­£åœ¨è¿›è¡Œçš„ Binder äº‹åŠ¡ã€‚å¦‚æœè¿™é‡Œ <code>tr</code> é•¿æœŸä¸ä¸º 0ï¼Œè¯´æ˜ä¸»çº¿ç¨‹è¢« Binder è°ƒç”¨å¡ä½äº†ï¼ˆå³å¸¸è§çš„ ANR éšæ‚£ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-2">0x02. Binder å®ä½“åˆ†æï¼ˆNodesï¼‰â€”â€” ä½ æš´éœ²äº†ä»€ä¹ˆï¼Ÿ</h3>
<p>Node ä»£è¡¨è¿›ç¨‹ 3011 æä¾›çš„æ¥å£ï¼ˆStubï¼‰ã€‚</p>
<ul>
<li>
<p><strong>å¤šç«¯å¼•ç”¨ï¼š</strong> çœ‹åˆ° <code>node 32258</code> åé¢è·Ÿç€ <code>proc 2643 1411</code>ã€‚</p>
<ul>
<li>è¿™è¯´æ˜è¿›ç¨‹ 2643 å’Œ 1411 éƒ½åœ¨æŒæœ‰å¹¶å¯èƒ½è°ƒç”¨ 3011 çš„åŒä¸€ä¸ªæ¥å£ã€‚</li>
</ul>
</li>
<li>
<p><strong>è·¨è¿›ç¨‹è¶³è¿¹ï¼š</strong> 3011 æš´éœ²çš„ Node å¤§éƒ¨åˆ†è¢« <strong>PID 1411</strong> å¼•ç”¨ã€‚</p>
<ul>
<li><strong>ä¸“å®¶è¡ŒåŠ¨ï¼š</strong> å¯ä»¥å»æŸ¥ä¸€ä¸‹ PID 1411 æ˜¯å“ªä¸ªè¿›ç¨‹ï¼ˆé€šå¸¸æ˜¯ <code>system_server</code> æˆ–å…³é”®ç³»ç»Ÿ UI è¿›ç¨‹ï¼‰ã€‚è¿™èƒ½å¸®ä½ ç†æ¸…ä½ çš„ App ä¸»è¦æ˜¯è¢«è°åœ¨é¢‘ç¹è°ƒç”¨ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-3">0x03. å¼•ç”¨åˆ†æï¼ˆRefsï¼‰â€”â€” ä½ æŒæœ‰äº†è°ï¼Ÿ</h3>
<p>Ref ä»£è¡¨è¿›ç¨‹ 3011 è°ƒç”¨çš„è¿œç¨‹æ¥å£ï¼ˆProxyï¼‰ã€‚</p>
<ul>
<li>
<p><strong>å¥æŸ„ 0 (desc 0)ï¼š</strong> <code>ref 30933: desc 0 node 1</code>ã€‚è¿™æ˜¯æ ‡å‡†çš„ <code>ServiceManager</code>ã€‚</p>
</li>
<li>
<p><strong>å¼•ç”¨æ•°é‡ï¼š</strong> ä½ æ‹¥æœ‰ä» <code>desc 0</code> åˆ° <code>desc 45</code> çš„å¼•ç”¨ã€‚</p>
<ul>
<li><strong>ä¸“å®¶è§†è§’ï¼š</strong> 45 ä¸ªå¤–éƒ¨å¼•ç”¨å¯¹äºä¸€ä¸ª App è¿›ç¨‹æ¥è¯´æ˜¯æ­£å¸¸çš„ã€‚ä½†å¦‚æœ <code>desc</code> è¾¾åˆ°å‡ ç™¾ï¼Œè¯´æ˜ä½ çš„ App ç”³è¯·äº†å¤ªå¤šçš„ç³»ç»ŸæœåŠ¡ï¼ˆå¦‚é¢‘ç¹è·å– LocationManager, WindowManager ç­‰ï¼‰ä¸”æ²¡æœ‰é‡Šæ”¾ï¼Œè¿™ä¼šå¯¼è‡´ <strong>ç³»ç»ŸæœåŠ¡ç«¯</strong> å‡ºç°å†…å­˜æ³„æ¼ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-4">0x04. å†…å­˜ç¼“å†²åŒºï¼ˆBuffersï¼‰â€”â€” é£é™©æ ¸å¿ƒ</h3>
<p>è¿™æ˜¯æœ€ç¡¬æ ¸çš„éƒ¨åˆ†ï¼Œç›´æ¥å…³è”åˆ° <code>TransactionTooLargeException</code>ã€‚</p>
<ul>
<li>
<p><strong>æ•°æ®ï¼š</strong> <code>buffer 63164: size 144:0:0 delivered</code></p>
</li>
<li>
<p><strong>è§£æï¼š</strong> * <code>144:0:0</code> åˆ†åˆ«ä»£è¡¨ï¼š<code>æ•°æ®å¤§å° : åç§»é‡å¤§å° : æ­»äº¡é€šçŸ¥å¤§å°</code>ã€‚</p>
<ul>
<li>è¿™é‡Œçš„ Buffer éƒ½å¾ˆå°ï¼ˆæœ€å¤§æ‰ 144 å­—èŠ‚ï¼‰ï¼Œä¸”çŠ¶æ€éƒ½æ˜¯ <code>delivered</code>ï¼ˆå·²äº¤ä»˜ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>é¢„è­¦ä¿¡å·ï¼š</strong> å¦‚æœä½ åœ¨æ’æŸ¥å¡é¡¿æˆ–å´©æºƒæ—¶ï¼Œçœ‹åˆ°æŸä¸ª <code>buffer</code> çš„ <code>size</code> è¾¾åˆ° <strong>500,000</strong> ä»¥ä¸Šï¼ˆçº¦ 0.5MBï¼‰ï¼Œå¹¶ä¸”çŠ¶æ€ä¸æ˜¯ <code>delivered</code> è€Œæ˜¯é•¿æ—¶é—´æŒ‚èµ·ï¼Œè¯´æ˜æœ‰ä¸€ä¸ªå¤§äº‹åŠ¡é˜»å¡äº† Binder é©±åŠ¨ï¼Œè¿™ä¼šç›´æ¥å¯¼è‡´åç»­æ‰€æœ‰ç®€å•çš„ Binder è°ƒç”¨è¶…æ—¶ã€‚</p>
</li>
</ul>
<h3 data-id="heading-5">0x05. å¯»æ‰¾â€œå¹•åé»‘æ‰‹â€</h3>
<ol>
<li>ä»æŸ¥è¯¢ PID</li>
</ol>
<pre><code class="hljs language-shell" lang="shell">adb shell ps -A | grep 1411Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
</code></pre>
<blockquote>
<p>system Â <strong>1411</strong>Â  Â  851 16778868 399132 do_epoll_waitÂ  Â  Â  0 S system_server</p>
</blockquote>
<pre><code class="hljs language-Shell" lang="Shell">adb shell ps -A | grep 2643Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
</code></pre>
<blockquote>
<p>u0_a118Â  <strong>2643</strong>Â  Â  851 13886788 123388 do_epoll_waitÂ  Â  Â  0 S com.android.inputmethod.latin</p>
</blockquote>
<pre><code class="hljs language-shell" lang="shell">adb shell ps -A | grep 581 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
</code></pre>
<blockquote>
<p>systemÂ  Â  <strong>581</strong>Â  Â  Â  1 11133444 43892 do_epoll_wait Â  Â  Â  0 S surfaceflinger</p>
</blockquote>
<p>å¯ä»¥å‘ç°è¿™ä¸ªè¿›ç¨‹(com.android.launcher3)ä¸»è¦æ˜¯è·Ÿ <code>system_server</code>ã€è¾“å…¥æ³•ã€<code>surfaceflinger</code> è¿›ç¨‹äº¤äº’ã€‚</p>
<ol start="2">
<li><strong>æ€è€ƒï¼š</strong> ä¸ºä»€ä¹ˆ <code>node 63104</code> åªæœ‰ <code>ls 1 lw 1</code>ï¼ˆæœ¬åœ°å¼ºå¼±å¼•ç”¨ï¼‰è€Œæ²¡æœ‰ <code>proc</code> åˆ—è¡¨ï¼Ÿ<br/>
ç­”ï¼šè¿™é€šå¸¸æ„å‘³ç€è¯¥å¯¹è±¡åˆšåˆ›å»ºæˆ–æ­£åœ¨é”€æ¯ï¼Œå°šæœªè¢«è¿œç¨‹è¿›ç¨‹è·å–</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€ä¸ª AI èŠå¤©åŠŸèƒ½ï¼ŒèƒŒåè‡³å°‘ 8 ä¸ªä½ æ²¡æƒ³åˆ°çš„å·¥ç¨‹ç»†èŠ‚]]></title>    <link>https://juejin.cn/post/7586941468873506850</link>    <guid>https://juejin.cn/post/7586941468873506850</guid>    <pubDate>2025-12-24T03:08:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586941468873506850" data-draft-id="7586934804291239970" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€ä¸ª AI èŠå¤©åŠŸèƒ½ï¼ŒèƒŒåè‡³å°‘ 8 ä¸ªä½ æ²¡æƒ³åˆ°çš„å·¥ç¨‹ç»†èŠ‚"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,AIGC"/> <meta itemprop="datePublished" content="2025-12-24T03:08:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¼–ç¨‹å¹²è´§é“º"/> <meta itemprop="url" content="https://juejin.cn/user/52383084474680"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€ä¸ª AI èŠå¤©åŠŸèƒ½ï¼ŒèƒŒåè‡³å°‘ 8 ä¸ªä½ æ²¡æƒ³åˆ°çš„å·¥ç¨‹ç»†èŠ‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/52383084474680/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¼–ç¨‹å¹²è´§é“º
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T03:08:27.000Z" title="Wed Dec 24 2025 03:08:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/efa7fc16a39343e29e57c44fd7dd4ae8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg57yW56iL5bmy6LSn6ZO6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767150506&amp;x-signature=HOFD63BrBnrInlv%2FWRQpEFhCcUc%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-0">ä¸€ä¸ª AI èŠå¤©åŠŸèƒ½ï¼ŒèƒŒåè‡³å°‘ 8 ä¸ªä½ æ²¡æƒ³åˆ°çš„å·¥ç¨‹ç»†èŠ‚</h2>
<p>å¾ˆå¤šäººç¬¬ä¸€æ¬¡åš AI é¡¹ç›®ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªé”™è§‰ã€‚</p>
<blockquote>
<p><strong>â€œä¸å°±æ˜¯æ¥ä¸ªå¤§æ¨¡å‹ APIï¼Œåšä¸ªè¾“å…¥æ¡†ï¼Œå†æŠŠç»“æœå±•ç¤ºå‡ºæ¥å—ï¼Ÿâ€</strong></p>
</blockquote>
<p>ä½†åªè¦ä½ çœŸçš„åšè¿‡ä¸€ä¸ª<strong>åƒæ ·çš„ AI èŠå¤©åŠŸèƒ½</strong>ï¼Œä½ å°±ä¼šå‘ç°ï¼š<strong>çœŸæ­£çš„éš¾ç‚¹ï¼Œ80% éƒ½ä¸åœ¨æ¨¡å‹æœ¬èº«ã€‚</strong></p>
<p>ä¸€ä¸ªâ€œçœ‹èµ·æ¥å¾ˆç®€å•â€çš„èŠå¤©çª—å£ï¼ŒèƒŒåå…¶å®æ˜¯ä¸€æ•´å¥—å·¥ç¨‹ç³»ç»Ÿã€‚</p>
<p>ä»Šå¤©æˆ‘å°±æ‹†ç»™ä½ çœ‹â€”â€”<strong>ä¸€ä¸ª AI èŠå¤©åŠŸèƒ½ï¼Œè‡³å°‘éšè—ç€ 8 ä¸ªä½ å¹³æ—¶æ ¹æœ¬æ³¨æ„ä¸åˆ°çš„å·¥ç¨‹ç»†èŠ‚ã€‚</strong></p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€ä½ ä»¥ä¸ºçš„ AI èŠå¤©ï¼šä¸‰æ­¥æå®š</h3>
<p>å¤§å¤šæ•°äººè„‘å­é‡Œçš„ AI èŠå¤©æ˜¯è¿™æ ·çš„ï¼š</p>
<ol>
<li>è¾“å…¥ä¸€å¥è¯</li>
<li>è°ƒç”¨å¤§æ¨¡å‹æ¥å£</li>
<li>æŠŠè¿”å›ç»“æœå±•ç¤ºå‡ºæ¥</li>
</ol>
<p>å¦‚æœåªæ˜¯ Demoï¼Œè¿™ç¡®å®å¤Ÿäº†ã€‚ä½†å¦‚æœä½ æƒ³åšçš„æ˜¯ä¸€ä¸ª<strong>èƒ½é•¿æœŸä½¿ç”¨ã€èƒ½å†™è¿›ç®€å†ã€ç”šè‡³èƒ½ä¸Šçº¿çš„ AI äº§å“</strong>â€”â€”é‚£ä»è¿™ä¸€åˆ»å¼€å§‹ï¼Œäº‹æƒ…å°±å®Œå…¨ä¸ä¸€æ ·äº†ã€‚</p>
<hr/>
<h3 data-id="heading-2">äºŒã€å·¥ç¨‹ç»†èŠ‚ 1ï¼šèŠå¤©â€œæµå¼è¾“å‡ºâ€ï¼Œä¸æ˜¯ä¸€å¥è¯è¿”å›</h3>
<p>çœŸæ­£å¥½ç”¨çš„ AI èŠå¤©ï¼Œ<strong>ä¸€å®šæ˜¯è¾¹ç”Ÿæˆã€è¾¹æ˜¾ç¤º</strong>çš„ã€‚</p>
<p>ä¸ºä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>ç”¨æˆ·ä¸æƒ³ç­‰ 10 ç§’çœ‹ä¸€æ•´æ®µæ–‡å­—</li>
<li>â€œæ‰“å­—æœºæ•ˆæœâ€æœ¬èº«å°±æ˜¯ä½“éªŒçš„ä¸€éƒ¨åˆ†</li>
</ul>
<p>ä½†è¿™æ„å‘³ç€ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>åç«¯è¦æ”¯æŒÂ <strong>æµå¼å“åº”</strong></li>
<li>å‰ç«¯è¦å®æ—¶æ¥æ”¶ã€æ‹¼æ¥å†…å®¹</li>
<li>ä¸­é€”è¿˜è¦èƒ½ä¸­æ–­ç”Ÿæˆ</li>
</ul>
<p>ğŸ‘‰ å¾ˆå¤šæ–°æ‰‹å¡åœ¨è¿™ä¸€æ­¥ï¼Œæ‰ç¬¬ä¸€æ¬¡æ„è¯†åˆ°ï¼š<strong>AI é¡¹ç›®ä¸æ˜¯æ™®é€šçš„ HTTP è¯·æ±‚ã€‚</strong></p>
<hr/>
<h3 data-id="heading-3">ä¸‰ã€å·¥ç¨‹ç»†èŠ‚ 2ï¼šå†å²å¯¹è¯ä¸æ˜¯â€œç®€å•æ•°ç»„â€</h3>
<p>ä½ ä»¥ä¸ºçš„å†å²è®°å½•ï¼š</p>
<pre><code class="hljs">ç”¨æˆ·ï¼šä½ å¥½ Â AIï¼šä½ å¥½ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®ä½ ï¼Ÿ
</code></pre>
<p>çœŸå®é¡¹ç›®é‡Œçš„å†å²è®°å½•è¦è€ƒè™‘ï¼š</p>
<ul>
<li>æ¯ä¸€è½®å¯¹è¯çš„è§’è‰²ï¼ˆsystem / user / assistantï¼‰</li>
<li>ä¸Šä¸‹æ–‡é•¿åº¦é™åˆ¶</li>
<li>æ˜¯å¦è¦è£å‰ªæ—§æ¶ˆæ¯</li>
<li>ä¸åŒæ¨¡å‹çš„ä¸Šä¸‹æ–‡ç­–ç•¥</li>
</ul>
<p>å¦‚æœä½ ä¸åšè¿™äº›æ§åˆ¶ï¼Œç»“æœåªæœ‰ä¸€ä¸ªï¼šğŸ‘‰Â <strong>è¦ä¹ˆæ•ˆæœè¶Šæ¥è¶Šå·®ï¼Œè¦ä¹ˆæˆæœ¬è¶Šæ¥è¶Šé«˜ã€‚</strong></p>
<hr/>
<h3 data-id="heading-4">å››ã€å·¥ç¨‹ç»†èŠ‚ 3ï¼šPrompt ä¸æ˜¯å†™ä¸€å¥è¯å°±å®Œäº‹</h3>
<p>å¾ˆå¤šäººå¯¹ Prompt çš„ç†è§£è¿˜åœç•™åœ¨ï¼š</p>
<blockquote>
<p>â€œå†™æ¸…æ¥šä¸€ç‚¹å°±è¡Œâ€</p>
</blockquote>
<p>ä½†åœ¨çœŸå®å·¥ç¨‹é‡Œï¼ŒPrompt å¾€å¾€éœ€è¦ï¼š</p>
<ul>
<li>æ¨¡æ¿åŒ–ç®¡ç†</li>
<li>æ”¯æŒåŠ¨æ€å˜é‡</li>
<li>ä¸åŒåœºæ™¯ä½¿ç”¨ä¸åŒ Prompt</li>
<li>åæœŸå¯é…ç½®ã€å¯è°ƒæ•´</li>
</ul>
<p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆï¼Œ<strong>æˆç†Ÿçš„ AI äº§å“ä¸€å®šæœ‰ã€Œæç¤ºè¯ç®¡ç†ç³»ç»Ÿã€</strong>ï¼Œè€Œä¸æ˜¯å†™æ­»åœ¨ä»£ç é‡Œã€‚</p>
<hr/>
<h3 data-id="heading-5">äº”ã€å·¥ç¨‹ç»†èŠ‚ 4ï¼šToken æ¶ˆè€—ï¼Œç›´æ¥å†³å®šä½ ä¼šä¸ä¼šâ€œäºé’±â€</h3>
<p>å½“ä½ å¼€å§‹æ­£å¼ç”¨ AI æ¥å£ï¼Œä½ ä¼šå¾ˆå¿«å‘ç°ä¸€ä¸ªæ®‹é…·ç°å®ï¼š</p>
<blockquote>
<p><strong>Token = æˆæœ¬</strong></p>
</blockquote>
<p>ä¸€ä¸ª AI èŠå¤©åŠŸèƒ½ï¼Œå¿…é¡»è€ƒè™‘ï¼š</p>
<ul>
<li>å•æ¬¡å¯¹è¯ token ä¸Šé™</li>
<li>å†å²ä¸Šä¸‹æ–‡å¦‚ä½•è£å‰ª</li>
<li>æ˜¯å¦é™åˆ¶ç”¨æˆ·è¾“å…¥é•¿åº¦</li>
<li>ä¸åŒæ¨¡å‹çš„æˆæœ¬å·®å¼‚</li>
</ul>
<p>å¾ˆå¤šâ€œçœ‹èµ·æ¥è·‘å¾—å¾ˆçˆ½â€çš„ Demoï¼Œä¸€ä¸Šçº¿å°±å‘ç°â€”â€”<strong>æ ¹æœ¬çƒ§ä¸èµ·é’±ã€‚</strong></p>
<hr/>
<h3 data-id="heading-6">å…­ã€å·¥ç¨‹ç»†èŠ‚ 5ï¼šç”¨æˆ·ç³»ç»Ÿå’Œç™»å½•ï¼Œå†³å®šä½ æ˜¯ä¸æ˜¯â€œç©å…·â€</h3>
<p>æ²¡æœ‰ç™»å½•çš„ AI èŠå¤©ï¼Œæ°¸è¿œåªæ˜¯ä¸ªæ¼”ç¤ºé¡µé¢ã€‚</p>
<p>ä¸€æ—¦ä½ å¼•å…¥ç™»å½•ï¼Œå°±ä¼šè¿é”å¼•å‡ºä¸€å †å·¥ç¨‹é—®é¢˜ï¼š</p>
<ul>
<li>Token é‰´æƒ</li>
<li>ç”¨æˆ·éš”ç¦»</li>
<li>æ¯ä¸ªç”¨æˆ·çš„èŠå¤©è®°å½•å½’å±</li>
<li>æƒé™ä¸æ¥å£ä¿æŠ¤</li>
</ul>
<p>ğŸ‘‰ åˆ°è¿™ä¸€æ­¥ï¼ŒAI é¡¹ç›®å·²ç»ä¸å†æ˜¯â€œå‰ç«¯ç©å…·â€ï¼Œè€Œæ˜¯ä¸€ä¸ªçœŸæ­£çš„Â <strong>Web åº”ç”¨ç³»ç»Ÿ</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-7">ä¸ƒã€å·¥ç¨‹ç»†èŠ‚ 6ï¼šæ•°æ®å­˜å‚¨ï¼Œè¿œæ¯”ä½ æƒ³çš„å¤æ‚</h3>
<p>ä½ éœ€è¦å­˜çš„ï¼Œä»æ¥ä¸åªæ˜¯â€œèŠå¤©å†…å®¹â€ï¼š</p>
<ul>
<li>å¯¹è¯åˆ—è¡¨</li>
<li>æ¶ˆæ¯é¡ºåº</li>
<li>ä½¿ç”¨çš„æ¨¡å‹</li>
<li>Prompt ç‰ˆæœ¬</li>
<li>åˆ›å»ºæ—¶é—´ã€æ›´æ–°æ—¶é—´</li>
</ul>
<p>è¿™èƒŒåæ˜¯ï¼š</p>
<ul>
<li>æ•°æ®è¡¨è®¾è®¡</li>
<li>ç´¢å¼•ç­–ç•¥</li>
<li>æŸ¥è¯¢æ€§èƒ½</li>
<li>åæœŸæ‰©å±•èƒ½åŠ›</li>
</ul>
<p>å¾ˆå¤šäººç¬¬ä¸€æ¬¡åšåˆ°è¿™é‡Œæ‰å‘ç°ï¼š<strong>AI é¡¹ç›®ï¼Œæœ¬è´¨ä¸Šä¹Ÿæ˜¯æ•°æ®é©±åŠ¨äº§å“ã€‚</strong></p>
<hr/>
<h3 data-id="heading-8">å…«ã€å·¥ç¨‹ç»†èŠ‚ 7ï¼šå¼‚å¸¸å¤„ç†ï¼Œå†³å®šä½“éªŒâ€œåƒä¸åƒäººâ€</h3>
<p>çœŸå®ç”¨æˆ·ä¸€å®šä¼šé‡åˆ°ï¼š</p>
<ul>
<li>æ¨¡å‹è¶…æ—¶</li>
<li>æ¥å£æŠ¥é”™</li>
<li>å†…å®¹ç”Ÿæˆä¸­æ–­</li>
<li>ç½‘ç»œå¼‚å¸¸</li>
</ul>
<p>å¦‚æœä½ ä¸å¤„ç†ï¼Œç”¨æˆ·çœ‹åˆ°çš„åªä¼šæ˜¯ï¼š</p>
<blockquote>
<p>â€œè¯·æ±‚å¤±è´¥â€</p>
</blockquote>
<p>è€Œæˆç†Ÿçš„ AI èŠå¤©ï¼Œä¼šåšåˆ°ï¼š</p>
<ul>
<li>å‹å¥½çš„é”™è¯¯æç¤º</li>
<li>å¯é‡æ–°ç”Ÿæˆ</li>
<li>å¯ç»§ç»­å¯¹è¯</li>
<li>çŠ¶æ€å¯æ¢å¤</li>
</ul>
<p>è¿™äº›ï¼Œéƒ½æ˜¯<strong>å·¥ç¨‹èƒ½åŠ›ï¼Œè€Œä¸æ˜¯æ¨¡å‹èƒ½åŠ›</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-9">ä¹ã€å·¥ç¨‹ç»†èŠ‚ 8ï¼šè¿™ä¸æ˜¯ä¸€ä¸ªåŠŸèƒ½ï¼Œè€Œæ˜¯ä¸€æ•´å¥—ç³»ç»Ÿ</h3>
<p>å½“ä½ æŠŠä¸Šé¢è¿™äº›æ‹¼åœ¨ä¸€èµ·ï¼Œä½ ä¼šå‘ç°ï¼š</p>
<p>ä¸€ä¸ª AI èŠå¤©åŠŸèƒ½ï¼Œè‡³å°‘æ¶‰åŠï¼š</p>
<ul>
<li>å‰ç«¯çŠ¶æ€ç®¡ç†</li>
<li>åç«¯æ¥å£è®¾è®¡</li>
<li>å®æ—¶é€šä¿¡</li>
<li>æ•°æ®åº“è®¾è®¡</li>
<li>æƒé™ä¸å®‰å…¨</li>
<li>æˆæœ¬ä¸æ€§èƒ½æ§åˆ¶</li>
</ul>
<p>ğŸ‘‰ å®ƒä»æ¥ä¸æ˜¯â€œè°ƒä¸ª APIâ€é‚£ä¹ˆç®€å•ã€‚</p>
<hr/>
<h3 data-id="heading-10">åã€å†™åœ¨æœ€åï¼šè¿™æ‰æ˜¯ AI é¡¹ç›®çš„çœŸæ­£åˆ†æ°´å²­</h3>
<p>å¾ˆå¤šäººå­¦ AIï¼Œå¡åœ¨ä¸€ä¸ªé˜¶æ®µï¼š</p>
<blockquote>
<p><strong>ä¼šç”¨ï¼Œä½†åšä¸å‡ºæ¥ï¼›èƒ½æ¼”ç¤ºï¼Œä½†æ— æ³•ä¸Šçº¿ã€‚</strong></p>
</blockquote>
<p>çœŸæ­£æ‹‰å¼€å·®è·çš„ï¼Œä»æ¥ä¸æ˜¯ä½ ä¼šä¸ä¼šè°ƒç”¨æ¨¡å‹ï¼Œè€Œæ˜¯ä½ æœ‰æ²¡æœ‰èƒ½åŠ›ï¼ŒæŠŠ AIÂ <strong>åšæˆä¸€ä¸ªå®Œæ•´çš„å·¥ç¨‹äº§å“</strong>ã€‚</p>
<p>å½“ä½ çœŸæ­£åšè¿‡ä¸€æ¬¡å®Œæ•´çš„ AI èŠå¤©ç³»ç»Ÿä¹‹åï¼Œä½ å¯¹â€œAI é¡¹ç›®â€â€œå‰ç«¯èƒ½åŠ›â€â€œå·¥ç¨‹åŒ–â€çš„ç†è§£ï¼Œéƒ½ä¼šè¢«å½»åº•é‡å¡‘ã€‚</p>
<hr/>
<hr/>
<p>å¦‚æœä½ åœ¨è¯»åˆ°è¿™é‡Œæ—¶ï¼Œå¿ƒé‡Œå†’å‡ºè¿‡ç±»ä¼¼çš„æƒ³æ³•ï¼š <em>â€œåŸæ¥ä¸€ä¸ª AI èŠå¤©åŠŸèƒ½è¦è€ƒè™‘è¿™ä¹ˆå¤šä¸œè¥¿ã€‚â€</em> é‚£è¯´æ˜ä½ å·²ç»ç«™åœ¨<strong>ä» Demo èµ°å‘çœŸå®é¡¹ç›®</strong>çš„é—¨æ§›ä¸Šäº†ã€‚çœŸæ­£çš„æå‡ï¼Œå¾€å¾€ä¸æ˜¯å¤šçœ‹å‡ ä¸ª API æ–‡æ¡£ï¼Œè€Œæ˜¯å®Œæ•´åšä¸€æ¬¡ï¼šä»å·¥ç¨‹ç»“æ„ã€åˆ°åç«¯ã€åˆ° AI èƒ½åŠ›æ•´åˆçš„Â <strong>å…¨æµç¨‹å®æˆ˜</strong>ã€‚è‡³å°‘ï¼Œä½ ä¼šæ¸…æ¥šçŸ¥é“â€”â€”è‡ªå·±è¿˜ç¼ºçš„ï¼Œç©¶ç«Ÿæ˜¯å“ªä¸€å—ã€‚</p>
<p>ä»0åˆ°1æ‰“é€ ä¸€æ¬¾å…·å¤‡AièŠå¤©ï¼ŒAIå†™ä½œï¼Œæ–‡ç”Ÿå›¾ï¼Œè¯­éŸ³åˆæˆï¼Œè¯­éŸ³è¯†åˆ«åŠŸèƒ½çš„å¤šæ¨¡æ€å…¨æ ˆé¡¹ç›®:</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/12025dd18d8c4e58b9144a4658378bbb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg57yW56iL5bmy6LSn6ZO6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767150506&amp;x-signature=T27XU43LWa4CTmofhVEVUUtEzQY%3D" alt="è®¾è®¡å›¾ï¼ˆå¸¦äºŒç»´ç ï¼‰.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AutoMQ x FSx: 10ms Latency Diskless Kafka on AWS]]></title>    <link>https://juejin.cn/post/7586971532699336713</link>    <guid>https://juejin.cn/post/7586971532699336713</guid>    <pubDate>2025-12-24T03:34:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586971532699336713" data-draft-id="7586901995430658057" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AutoMQ x FSx: 10ms Latency Diskless Kafka on AWS"/> <meta itemprop="keywords" content="å¼€æº"/> <meta itemprop="datePublished" content="2025-12-24T03:34:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AutoMQ"/> <meta itemprop="url" content="https://juejin.cn/user/2878958479084707"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AutoMQ x FSx: 10ms Latency Diskless Kafka on AWS
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2878958479084707/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AutoMQ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T03:34:09.000Z" title="Wed Dec 24 2025 03:34:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»18åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»‹ç»</h2>
<p><strong>ä»Šå¤©ï¼Œæˆ‘ä»¬æ­£å¼å®£å¸ƒï¼šç»§ S3 WALã€EBS/Regional EBS WAL[1] ä¹‹åï¼ŒAutoMQ å°†åœ¨ 2025 å¹´çš„ 12 æœˆçš„æ–°ç‰ˆæœ¬ä¸­å…¨é¢æ”¯æŒä»¥ AWS FSx ä½œä¸ºæ–°çš„ WAL å­˜å‚¨é€‰é¡¹</strong>ã€‚AutoMQ æœ¬èº«æ˜¯ä¸€æ¬¾å®Œå…¨å…¼å®¹ Apache Kafka åè®®ã€åŸºäº S3 å¯¹è±¡å­˜å‚¨æ„å»ºçš„æ–°ä¸€ä»£ Diskless Kafkaï¼Œé€šè¿‡è‡ªç ”çš„ã€ŒWAL + å¯¹è±¡å­˜å‚¨ã€åˆ›æ–°æµå­˜å‚¨å¼•æ“ï¼Œå°†å†™å…¥æ—¥å¿—ä¸å¤§è§„æ¨¡æŒä¹…åŒ–å­˜å‚¨è§£è€¦ï¼Œåœ¨ä¿è¯ Kafka è¯­ä¹‰å’Œç¨³å®šæ€§çš„åŒæ—¶ï¼Œå¤§å¹…é™ä½å­˜å‚¨æˆæœ¬ã€ç®€åŒ–è¿ç»´ï¼Œå¹¶å·²åœ¨è¡Œä¸šå†…è·å¾—å¹¿æ³›è®¤å¯ã€‚éšç€ FSx WAL çš„å¼•å…¥ï¼ŒAWS ä¸Šçš„ AutoMQ ç»ˆäºè¡¥é½äº†å…³é”®çš„ä¸€å—æ‹¼å›¾ï¼šåœ¨ AWS ä¸Šï¼Œä½ å¯ä»¥åœ¨ä¸€å¥—çœŸæ­£ Diskless çš„ Kafka æ–¹æ¡ˆä¸­ï¼ŒåŒæ—¶å…¼é¡¾æ¶ˆé™¤è·¨ AZ æµé‡æˆæœ¬ã€å¤š AZ çº§åˆ«å®¹ç¾èƒ½åŠ›ä»¥åŠæ¥è¿‘æœ¬åœ°ç£ç›˜ä½“éªŒçš„ä½å»¶è¿Ÿã€‚</p>
<h2 data-id="heading-1">Diskless Kafka çš„å»¶è¿ŸæŒ‘æˆ˜</h2>
<p>è¿‘äº›å¹´æ¥ï¼Œéšç€ S3 API å‡­å€Ÿæè‡´ä½æˆæœ¬ã€å¼¹æ€§ä¸å…±äº«å­˜å‚¨ç‰¹æ€§ï¼Œé€æ¸æˆä¸ºäº‘ä¸Šæ•°æ®åŸºç¡€è®¾æ–½çš„æ–°æ ‡å‡†ï¼ŒåŸºäºå¯¹è±¡å­˜å‚¨é‡æ„æµå­˜å‚¨å¼•æ“çš„ Diskless Kafka æ–¹æ¡ˆå¼€å§‹å…´èµ·ã€‚è‡ª AutoMQ åœ¨ 2023 å¹´ç‡å…ˆæå‡ºåŸºäºå…±äº«å­˜å‚¨çš„ Kafka æ¶æ„ä»¥æ¥ï¼ŒDiskless Kafka å·²ç»æˆä¸º data streaming é¢†åŸŸçš„ä¸€è‚¡é‡è¦è¶‹åŠ¿ï¼šåœ¨äº‘ä¸Šï¼Œå®ƒå¤©ç„¶å…·å¤‡è®¡ç®—ä¸å­˜å‚¨è§£è€¦ã€æŒ‰éœ€å¼¹æ€§æ‰©ç¼©å®¹ã€ä»¥åŠæ˜¾è‘—çš„æˆæœ¬ä¼˜åŠ¿ã€‚å°¤å…¶æ˜¯å€ŸåŠ©å…±äº«å­˜å‚¨æ¶ˆé™¤è·¨ AZ æµé‡è´¹ç”¨ï¼Œåœ¨ AWSã€GCP ç­‰ä¸»æµå…¬æœ‰äº‘ä¸Šï¼Œå¤š AZ éƒ¨ç½²çš„ Kafka é›†ç¾¤æ¯æœˆå¯ä»¥èŠ‚çœæ•°åƒåˆ°æ•°ä¸‡ç¾å…ƒçš„ç½‘ç»œæˆæœ¬ï¼Œè¿™ä¸€ç‚¹å·²ç»è·å¾—å¤§é‡äº‘ä¸Š Kafka å®¢æˆ·çš„é«˜åº¦è®¤å¯ï¼Œä¹Ÿæ˜¯æ¨åŠ¨ä»–ä»¬è€ƒè™‘è¿ç§»åˆ° Diskless Kafka æ–¹æ¡ˆçš„æ ¸å¿ƒé©±åŠ¨åŠ›ä¹‹ä¸€ã€‚</p>
<p>ä½† Diskless Kafka ä¹Ÿé¢ä¸´ä¸€ä¸ªæ ¹æœ¬æ€§æŒ‘æˆ˜ï¼šå¦‚æœåªæ˜¯ç®€å•æŠ›å¼ƒæœ¬åœ°ç£ç›˜ï¼ŒæŠŠæ‰€æœ‰æ•°æ®ç›´æ¥åŒæ­¥å†™å…¥å¯¹è±¡å­˜å‚¨ï¼Œå°±ä¼šå½»åº•ä¸§å¤± Kafka æœ€é‡è¦çš„èƒ½åŠ›ä¹‹ä¸€â€”â€”<strong>ä½å»¶è¿Ÿ</strong>ã€‚å¯¹è±¡å­˜å‚¨çš„è®¾è®¡ç›®æ ‡æ˜¯é«˜å¯é ä¸é«˜ååï¼Œè€Œä¸æ˜¯äºšæ¯«ç§’çº§å†™å…¥å»¶è¿Ÿã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œç›´æ¥å†™ S3 è¿™ç±»å¯¹è±¡å­˜å‚¨çš„å¹³å‡å†™å…¥å»¶è¿Ÿåœ¨ 200â€“500ms åŒºé—´ï¼Œå³ä¾¿ä½¿ç”¨è¯¸å¦‚ S3 Express One Zoneï¼ˆS3 E1Zï¼‰è¿™ç±»æœ€æ–°äº§å“ï¼Œå†™å…¥å»¶è¿Ÿä¾ç„¶å¤§çº¦åœ¨ 150ms å·¦å³ã€‚å¯¹äºå¾®æœåŠ¡é“¾è·¯ã€æ’®åˆå¼•æ“ã€é£æ§å†³ç­–ã€å®æ—¶é£æ§ç­‰å»¶è¿Ÿæ•æ„Ÿçš„é‡‘èä¸äº¤æ˜“åœºæ™¯ï¼Œè¿™æ ·çš„å»¶è¿Ÿæ˜¯è¿œè¿œä¸èƒ½æ¥å—çš„ï¼Œä¹Ÿæå¤§é™åˆ¶äº†å¸‚é¢ä¸Šå¤§å¤šæ•° â€œå¯¹è±¡å­˜å‚¨ç›´å†™å‹â€ Diskless Kafka çš„é€‚ç”¨èŒƒå›´ï¼Œä½¿å…¶æ›´å¤šåªèƒ½ç”¨äºå¯è§‚æµ‹æ€§ã€æ—¥å¿—é‡‡é›†ã€å‡†å®æ—¶äº‹ä»¶æµåˆ†æç­‰å¯¹ç«¯åˆ°ç«¯å»¶è¿Ÿè¦æ±‚ä¸é‚£ä¹ˆä¸¥è‹›çš„åœºæ™¯ã€‚</p>
<p>AutoMQ åœ¨ 2023 å¹´æå‡ºå¹¶å®è·µäº†ä¸€æ¡ä¸åŒçš„æŠ€æœ¯è·¯å¾„ï¼šåŸºäºã€ŒWAL åŠ é€Ÿå±‚ + å¯¹è±¡å­˜å‚¨ã€çš„å…±äº«å­˜å‚¨æ¶æ„ã€‚é€šè¿‡åœ¨å¯¹è±¡å­˜å‚¨ä¹‹å‰å¼•å…¥ä¸€å±‚é«˜æ€§èƒ½ã€ä½å»¶è¿Ÿçš„å…±äº«å­˜å‚¨ä½œä¸º Write-Ahead Logï¼ˆWALï¼‰ï¼ŒAutoMQ å°†å†™å…¥è·¯å¾„ä¸ä½æˆæœ¬çš„å¯¹è±¡å­˜å‚¨è§£è€¦ï¼Œåœ¨ä¿è¯ Kafka è¯­ä¹‰çš„å‰æä¸‹ï¼Œå°†å¤§éƒ¨åˆ†å†™å…¥ä¸è¯»çƒ­ç‚¹è½åœ¨ä½å»¶è¿Ÿå­˜å‚¨ä¸Šï¼Œå†ä»¥æ‰¹é‡æ–¹å¼å¼‚æ­¥åˆ·æ–°åˆ°å¯¹è±¡å­˜å‚¨ï¼Œä»è€Œå®ç°äº†çœŸæ­£æ„ä¹‰ä¸Šçš„ä½å»¶è¿Ÿ Diskless Kafkaã€‚è¿™ç§æ¶æ„æœ‰ä¸¤å¤§å…³é”®ä»·å€¼ï¼šä¸€æ˜¯åˆ©ç”¨äº‘ä¸Šä½å»¶è¿Ÿå…±äº«å­˜å‚¨æ˜¾è‘—æå‡å†™å…¥ä¸è¯»å–æ€§èƒ½ï¼›äºŒæ˜¯é€šè¿‡ WAL åšæ‰¹é‡èšåˆå†™å…¥ï¼Œé™ä½ S3 API è°ƒç”¨æ¬¡æ•°ï¼Œè¿›ä¸€æ­¥æå‡ååå¹¶æ§åˆ¶æˆæœ¬ã€‚åœ¨ GCPã€Azure ç­‰æ”¯æŒ Regional EBSï¼ˆæˆ–ç­‰ä»·å¤š AZ å…±äº«å—å­˜å‚¨ï¼‰çš„äº‘ä¸Šï¼ŒåŸºäº Regional EBS çš„ WAL + å¯¹è±¡å­˜å‚¨æ¶æ„ï¼Œè¢«ä¸šç•Œæ™®éè®¤ä¸ºæ˜¯å½“å‰ Diskless Kafka çš„â€œç†æƒ³å½¢æ€â€ã€‚</p>
<p><img src="https://image.automq.com/20251224bot/lkzend.png" alt="" loading="lazy"/></p>
<p>çœŸæ­£çš„æŠ€æœ¯éš¾é¢˜å‡ºç°åœ¨ AWS ä¸Šã€‚ä¸ GCPã€Azure ä¸åŒï¼ŒAWS ä¸€ç›´ç¼ºä¹ç±»ä¼¼ Regional EBS è¿™ç§å¤š AZ å…±äº«å—å­˜å‚¨æœåŠ¡ï¼Œè¿™æ„å‘³ç€åœ¨ AWS ä¸Šæ„å»ºä½å»¶è¿Ÿçš„ Diskless Kafka æ¶æ„æ—¶ï¼Œæˆ‘ä»¬è¿‡å»åªèƒ½åœ¨ EBS å’Œ S3 ä¹‹é—´åšè‰°éš¾å–èˆï¼š</p>
<ul>
<li>ä½¿ç”¨ EBS åš WALï¼Œå¯ä»¥è·å¾—è¾ƒå¥½å»¶è¿Ÿï¼Œä½†ä»ç„¶é€ƒä¸å¼€è·¨ AZ å¤åˆ¶å¸¦æ¥çš„ç½‘ç»œæˆæœ¬å’Œå¤æ‚æ€§ï¼›</li>
<li>ç›´æ¥ç”¨ S3 åš WALï¼Œå¯ä»¥å½»åº•é¿å…è·¨ AZ ç½‘ç»œæµé‡æˆæœ¬ï¼Œä½†ç«¯åˆ°ç«¯å»¶è¿Ÿéš¾ä»¥æ»¡è¶³å»¶è¿Ÿæ•æ„Ÿä¸šåŠ¡çš„éœ€æ±‚ã€‚</li>
</ul>
<p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´é‡Œï¼ŒDiskless Kafka åœ¨ AWS ä¸Šå§‹ç»ˆå­˜åœ¨â€œè¦ä¹ˆä¾¿å®œä½†ä¸å¤Ÿå¿«ï¼Œè¦ä¹ˆå¤Ÿå¿«ä½†ä¸å¤Ÿä¾¿å®œâ€çš„ç»“æ„æ€§çŸ­æ¿ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸€çŸ›ç›¾ï¼ŒAutoMQ åœ¨è°ƒç ”äº† AWS ç”Ÿæ€ä¸‹çš„å¤šç§å…±äº«å­˜å‚¨æœåŠ¡åï¼Œæœ€ç»ˆé€‰æ‹©äº† <strong>AWS FSx for NetApp ONTAP</strong> ä½œä¸º WAL å±‚çš„å…³é”®åŸºç¡€è®¾æ–½ã€‚FSx ONTAP æ—¢æ˜¯ä¸€ä¸ªè·¨ AZ é«˜å¯ç”¨çš„å…±äº«æ–‡ä»¶å­˜å‚¨æœåŠ¡ï¼Œåˆå¯ä»¥åœ¨å¤š AZ éƒ¨ç½²åœºæ™¯ä¸‹å®ç°ä½äº 10ms çº§åˆ«çš„å¹³å‡å†™å…¥å»¶è¿Ÿï¼ŒåŒæ—¶åœ¨è®¡è´¹æ¨¡å‹ä¸Šä¸å åŠ è·¨ AZ æµé‡è´¹ï¼Œå®Œç¾å¥‘åˆ Diskless Kafka å¯¹â€œä½å»¶è¿Ÿ + å…±äº«å­˜å‚¨ + å¤š AZâ€çš„å¤åˆè¯‰æ±‚ã€‚å€ŸåŠ© AutoMQ çš„ WAL æŠ½è±¡ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€äº›å›ºå®šå®¹é‡çš„ FSx ä½œä¸ºé«˜æ€§èƒ½ WAL ç©ºé—´ï¼Œå°±å¯ä»¥å°†å†™å…¥å…ˆæŒä¹…åŒ–åˆ° FSx WAL ä¸Šï¼Œå†æ‰¹é‡åˆ·å†™åˆ° S3ï¼Œä»è€Œåœ¨ AWS ä¸Šé¦–æ¬¡å®ç°ï¼š</p>
<ul>
<li>ä¿æŒ Diskless Kafka çš„æ‰€æœ‰ä¼˜åŠ¿ï¼šè®¡ç®—å­˜å‚¨åˆ†ç¦»ã€å¼¹æ€§æ‰©ç¼©ã€S3 çº§åˆ«çš„ä½æˆæœ¬ï¼›</li>
<li>æ¶ˆé™¤è·¨ AZ æµé‡æˆæœ¬ï¼Œæ”¯æŒå¤š AZ éƒ¨ç½²ä¸å®¹ç¾ï¼›</li>
<li>åŒæ—¶è·å¾—æ¥è¿‘æœ¬åœ°ç›˜ä½“éªŒçš„ä½å»¶è¿Ÿå†™å…¥ä¸æ¶ˆè´¹ã€‚</li>
</ul>
<p>è¿™ä½¿å¾— AutoMQ æˆä¸ºç›®å‰ AWS ä¸Šå°‘æœ‰çš„ã€åœ¨æˆæœ¬ã€å¤š AZ é«˜å¯ç”¨ä¸ä½å»¶è¿Ÿä¸‰ä¸ªç»´åº¦ä¸Šå‡ ä¹æ²¡æœ‰æ˜æ˜¾çŸ­æ¿çš„ Diskless Kafka æ–¹æ¡ˆï¼Œä¹ŸçœŸæ­£æ‰“å¼€äº† Diskless Kafka åœ¨å»¶è¿Ÿæ•æ„Ÿä¸šåŠ¡åœºæ™¯çš„åº”ç”¨ç©ºé—´ã€‚</p>
<h2 data-id="heading-2">FSx å¦‚ä½•æ¶ˆé™¤è·¨AZ æµé‡è´¹</h2>
<p>è¦ç†è§£ FSx å¦‚ä½•å¸®åŠ© AutoMQ æ¶ˆé™¤ Kafka è·¨ AZ æµé‡è´¹ï¼Œå¯ä»¥å…ˆä»â€œæˆ‘ä»¬åˆ°åº•æ”¹äº† Kafka çš„å“ªä¸€å±‚â€å…¥æ‰‹ï¼Œå†çœ‹ FSx åœ¨è¿™ä¸ªæ–°æ¶æ„é‡Œçš„å…·ä½“èŒè´£ã€‚Apache Kafka æœ¬èº«å¯ä»¥è¢«æ‹†åˆ†ä¸ºä¸‰å±‚ï¼šç½‘ç»œå±‚è´Ÿè´£å¤„ç† KafkaApis è¯·æ±‚ï¼›è®¡ç®—å±‚åŒ…å«äº‹åŠ¡ã€å‹ç¼©ã€å»é‡ã€LogCleaner ç­‰æ ¸å¿ƒé€»è¾‘ï¼Œå  Kafka ä»£ç çš„ç»å¤§éƒ¨åˆ†ï¼›æœ€åº•å±‚æ˜¯å­˜å‚¨å±‚ï¼Œé€šè¿‡ LocalLog å’Œ LogSegment å°†æ— é™é•¿æ—¥å¿—è½åˆ°æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€‚AutoMQ ä¿ç•™äº† Kafka åŸç”Ÿçš„ç½‘ç»œå±‚å’Œè®¡ç®—å±‚ä»£ç ï¼Œåªåœ¨å­˜å‚¨å±‚çš„ LogSegment è¿™ä¸€éå¸¸è–„çš„åˆ‡é¢ä¸Šï¼Œå°†æœ¬åœ°ç£ç›˜æ›¿æ¢ä¸ºåŸºäº â€œS3 + ä½å»¶è¿Ÿ WALï¼ˆFSxï¼‰â€ çš„å…±äº«å­˜å‚¨å¼•æ“ï¼Œå¹¶åœ¨ç½‘ç»œå±‚ä¹‹ä¸Šå¢åŠ äº†ä¸€ä¸ª Zoneâ€‘routing interceptorã€‚FSx ä»¥åŒºåŸŸçº§å…±äº«å·çš„å½¢å¼æ‰¿æ‹…æŒä¹… WAL çš„è§’è‰²ï¼Œæ‰€æœ‰å†™å…¥é¦–å…ˆé¡ºåºè½åˆ° FSxï¼Œå†å¼‚æ­¥ä¸‹æ²‰åˆ° S3ã€‚</p>
<p><img src="https://image.automq.com/20251224bot/g23zk8.png" alt="" loading="lazy"/></p>
<p>åœ¨å¤š AZ éƒ¨ç½²ä¸‹ï¼Œä¼ ç»Ÿ Kafka çš„è·¨ AZ æµé‡ä¸»è¦æ¥è‡ªä¸‰éƒ¨åˆ†ï¼šä¸‰å‰¯æœ¬å¤åˆ¶ã€è·¨ AZ æ¶ˆè´¹ã€ä»¥åŠè·¨ AZ å†™å…¥ã€‚AutoMQ é€šè¿‡å•å‰¯æœ¬ + äº‘å­˜å‚¨ï¼ˆS3/FSxï¼‰æ¥æ‰¿æ‹…æŒä¹…åŒ–ä¸å¤š AZ å¯ç”¨æ€§ï¼Œå¤©ç„¶æ¶ˆé™¤äº†é›†ç¾¤å†…ä¸‰å‰¯æœ¬å¸¦æ¥çš„å¤åˆ¶æµé‡ï¼›å†ç»“åˆ rackâ€‘aware è°ƒåº¦ï¼Œå¯ä»¥è®©æ¶ˆè´¹è€…ä¼˜å…ˆå°±è¿‘è¯»å–ï¼Œé¿å…æ¶ˆè´¹ä¾§è·¨ AZã€‚å‰©ä¸‹æœ€éš¾çš„ä¸€å—ï¼Œæ˜¯ç”Ÿäº§è€…å†™å…¥å¯¼è‡´çš„è·¨ AZ æµé‡ã€‚è¿™é‡Œ FSx èµ·åˆ°äº†å…³é”®ä½œç”¨ï¼šä½œä¸ºå…±äº« WALï¼Œå®ƒè®©ä¸åŒ AZ çš„ Broker å¯ä»¥â€œå¯¹ç€åŒä¸€ä»½æ—¥å¿—å†™â€ï¼Œä¸éœ€è¦åœ¨ Broker ä¹‹é—´å†åšæ•°æ®å¤åˆ¶ï¼›åŒæ—¶ï¼ŒZoneâ€‘routing interceptor ä¼šå°†è·¨ AZ å†™å…¥â€œå°±åœ°ä»£ç†â€åˆ°æœ¬ AZ çš„ Brokerï¼ŒåªæŠŠæå°‘é‡æ§åˆ¶ä¿¡æ¯è·¨ AZ å‘é€ï¼Œè€ŒçœŸæ­£çš„å¤§æ•°æ®å—å§‹ç»ˆåœ¨æœ¬ AZ å†™å…¥ FSx å¹¶æœ€ç»ˆè½åˆ° S3ã€‚é€šè¿‡è¿™å¥—è®¾è®¡ï¼ŒAutoMQ åœ¨ä¿ç•™ Kafka åè®®å…¼å®¹å’Œè·¨ AZ é«˜å¯ç”¨çš„å‰æä¸‹ï¼Œå°†è·¨ AZ æ•°æ®é¢æµé‡å‹ç¼©åˆ°æ¥è¿‘ç†è®ºä¸‹é™ã€‚</p>
<p>ä»ç»“æœä¸Šçœ‹ï¼Œè¿™ä¸ªæ¶æ„è®© AutoMQ åœ¨ AWS ä¸Šå®ç°äº†ä¸‰ä¸ªç›®æ ‡ï¼š</p>
<ul>
<li>é€šè¿‡ FSx æä¾›çš„ä½å»¶è¿Ÿ WALï¼Œä¿æŒæ¥è¿‘æœ¬åœ°ç›˜çš„å†™å…¥ä¸è¯»å–ä½“éªŒï¼›</li>
<li>é€šè¿‡åŒºåŸŸå…±äº«å­˜å‚¨å’Œ Zoneâ€‘routing æœºåˆ¶ï¼Œå°†è·¨ AZ æ•°æ®é¢æµé‡å‹ç¼©åˆ°å‡ ä¹ä¸ºé›¶ï¼Œä»…ä¿ç•™å°‘é‡æ§åˆ¶æ¶ˆæ¯ï¼›</li>
<li>é€šè¿‡ S3 æ‰¿æ‹…ä¸»å­˜å‚¨ï¼Œç»§ç»­äº«å— Diskless Kafka åœ¨æˆæœ¬å’Œå¼¹æ€§ä¸Šçš„å…¨éƒ¨ä¼˜åŠ¿ã€‚</li>
</ul>
<blockquote>
<p>æ›´å¤šå®ç°ç»†èŠ‚å¯ä»¥å‚è€ƒï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fgo.automq.com%2Fhow-does-automq-implement-sub-10ms-latency-diskless-kafka%3Futm_source%3Dopenwrite" target="_blank" title="https://go.automq.com/how-does-automq-implement-sub-10ms-latency-diskless-kafka?utm_source=openwrite" ref="nofollow noopener noreferrer">How does AutoMQ implement a sub-10ms latency Diskless Kafka?</a></p>
</blockquote>
<h2 data-id="heading-3">æ”¶ç›Š</h2>
<p>å¼•å…¥ FSx ä¹‹åï¼ŒAutoMQ åœ¨ AWS ä¸Šçš„ Diskless æ¶æ„ä¸å†éœ€è¦åœ¨â€œæè‡´ä½å»¶è¿Ÿâ€å’Œâ€œæè‡´ä½æˆæœ¬â€ä¹‹é—´åšå–èˆï¼šä¸€æ–¹é¢ï¼Œç»§ç»­ä¿æŒå­˜ç®—åˆ†ç¦»ã€æ¶ˆé™¤è·¨ AZ æ•°æ®é¢æµé‡å’ŒåŸºäº S3 çš„è¶…ä½å­˜å‚¨æˆæœ¬ï¼›å¦ä¸€æ–¹é¢ï¼Œåªéœ€å°‘é‡ã€å›ºå®šå®¹é‡çš„ FSx ä½œä¸ºåŒºåŸŸçº§ä½å»¶è¿Ÿ WALï¼Œå°±å¯ä»¥æŠŠç«¯åˆ°ç«¯å»¶è¿Ÿæ‹‰å›åˆ°é€‚é…å¾®æœåŠ¡ã€é‡‘èäº¤æ˜“ç­‰æ ¸å¿ƒå®æ—¶åœºæ™¯çš„æ°´å¹³ã€‚ä¸‹é¢æˆ‘ä»¬åˆ†åˆ«ä»æ€§èƒ½å’Œæˆæœ¬ä¸¤ä¸ªç»´åº¦æ¥è¯´æ˜è¿™ä¸€ç»„åˆæ–¹æ¡ˆå¸¦æ¥çš„æ”¶ç›Šã€‚</p>
<h3 data-id="heading-4">æ€§èƒ½è§£è¯»</h3>
<p>ä»æ¶æ„ä¸Šçœ‹ï¼ŒAutoMQ + FSx è§£å†³çš„æ˜¯â€œè·¨ AZ é«˜å¯ç”¨åœºæ™¯ä¸‹ï¼Œå¦‚ä½•åœ¨ä¸å¼•å…¥è·¨ AZ å¤åˆ¶æµé‡çš„å‰æä¸‹ç»§ç»­è·å¾—æœ¬åœ°ç›˜çº§åˆ«å»¶è¿Ÿâ€çš„é—®é¢˜ã€‚æˆ‘ä»¬é€‰æ‹© AWS æä¾›çš„ <strong>FSx for NetApp ONTAP Multiâ€‘AZ éƒ¨ç½²æ¨¡å¼</strong>ï¼šåœ¨åŒä¸€ Region å†…ç”± FSx åœ¨ä¸¤ä¸ª AZ å†…æ‰˜ç®¡ä¸€å¯¹ HA èŠ‚ç‚¹ï¼Œå¯¹å¤–æš´éœ²ä¸ºä¸€ä¸ªåŒºåŸŸçº§å…±äº«æ–‡ä»¶ç³»ç»Ÿï¼Œæ‰€æœ‰ Broker éƒ½å°†å…¶æŒ‚è½½ä¸ºå”¯ä¸€çš„æŒä¹… WAL è®¾å¤‡ã€‚åŸºäºè¿™å±‚åŒºåŸŸçº§å…±äº« WALï¼Œæ•´ä¸ªç³»ç»Ÿåœ¨é«˜å¯ç”¨ã€å¼¹æ€§å’Œç½‘ç»œæˆæœ¬ä¸Šå½¢æˆäº†ä¸€ä¸ªæ–°çš„å¹³è¡¡ç‚¹ï¼š</p>
<ul>
<li>FSx æä¾›æ¥è¿‘æœ¬åœ° EBS çš„éšæœº IO èƒ½åŠ›ï¼ŒåŒæ—¶åœ¨å¤šä¸ª AZ ä¹‹é—´è‡ªåŠ¨å†—ä½™ï¼Œå¤©ç„¶æ»¡è¶³è·¨ AZ é«˜å¯ç”¨è¦æ±‚ï¼›</li>
<li>AutoMQ Broker ä»ç„¶æ˜¯æ— çŠ¶æ€çš„è®¡ç®—èŠ‚ç‚¹ï¼Œå¯ä»¥æŒ‰è´Ÿè½½å¼¹æ€§ä¼¸ç¼©ï¼Œè€Œçƒ­æ•°æ®å†™å…¥å…¨éƒ¨æ±‡èšåˆ° FSx ä¸Šï¼Œå†å¼‚æ­¥ä¸‹æ²‰åˆ° S3ï¼›</li>
<li>ç”±äºæ•°æ®ä¸å†åœ¨ Broker ä¹‹é—´å¤åˆ¶ï¼Œè·¨ AZ çš„æ•°æ®é¢æµé‡åŸºæœ¬è¢«æ¶ˆé™¤ï¼Œåªä¿ç•™æ§åˆ¶é¢é€šä¿¡ã€‚</li>
</ul>
<p>åœ¨è¿™æ ·çš„å‰æä¸‹ï¼Œæˆ‘ä»¬åœ¨ AWS us-east-1 ç”¨ä¸€ä¸ªå…¸å‹çš„é«˜åååœºæ™¯æ¥æµ‹è¯•ç«¯åˆ°ç«¯æ€§èƒ½ï¼š</p>
<ul>
<li><strong>ç¯å¢ƒ</strong>ï¼š6 å° m7g.4xlarge ä½œä¸º Brokerï¼ŒFSx ONTAP é‡‡ç”¨ Multiâ€‘AZ åŒèŠ‚ç‚¹éƒ¨ç½²ï¼ŒäºŒä»£ï¼Œé…ç½® 1,024â€¯GiB å®¹é‡ã€4,000 é¢„ç½® IOPSã€1,536â€¯MB/s ååï¼›</li>
<li><strong>è´Ÿè½½æ¨¡å‹</strong>ï¼š4:1 è¯»å†™æ¯”ï¼Œ64â€¯KB æ¶ˆæ¯ï¼ŒæŒç»­ 460â€¯MB/s å†™å…¥ã€1,840â€¯MB/s è¯»å–ï¼Œæ¨¡æ‹Ÿçº¿ä¸Šé«˜å¹¶å‘å¾®æœåŠ¡å’Œå®æ—¶è®¡ç®—ä»»åŠ¡çš„æ··åˆå‹åŠ›ï¼›</li>
<li><strong>ç»“æœ</strong>ï¼š<strong>å†™å…¥å¹³å‡å»¶è¿Ÿ 6.34â€¯msã€P99 17.50â€¯msï¼›ç«¯åˆ°ç«¯å¹³å‡å»¶è¿Ÿ 9.40â€¯msã€P99 28.00â€¯ms</strong>ã€‚</li>
</ul>
<p>è¿™ç»„æ•°æ®å¯ä»¥è¿™æ ·ç†è§£ï¼šåœ¨ä¿è¯è·¨ AZ å®¹ç¾ã€å®Œå…¨å­˜ç®—åˆ†ç¦»ã€ä»¥ S3 ä½œä¸ºä¸»å­˜å‚¨çš„å‰æä¸‹ï¼ŒAutoMQ é€šè¿‡ä¸€ä¸ªå›ºå®šå¤§å°çš„ FSx å±‚ï¼ŒæŠŠ Diskless Kafka çš„ å¹³å‡å†™å…¥å»¶è¿Ÿä»â€œå‡ ç™¾æ¯«ç§’é‡çº§â€æ‹‰å›åˆ°â€œ 10 æ¯«ç§’ä»¥ä¸‹â€ï¼Œæ¥è¿‘ä¼ ç»Ÿæœ¬åœ°ç›˜ Kafka çš„ä½“éªŒã€‚è¿™æ„å‘³ç€ï¼Œå®¢æˆ·ä¸éœ€è¦å†ä¸ºâ€œæ˜¯å¦èƒ½ç”¨ Diskless æ¶æ„æ‰¿è½½æ ¸å¿ƒä¸šåŠ¡â€æ‹…å¿ƒâ€”â€”åŒ…æ‹¬é“¾è·¯å¤æ‚çš„å¾®æœåŠ¡è°ƒç”¨ã€æ¯«ç§’çº§æ•æ„Ÿçš„é£æ§å†³ç­–ä¸è®¢å•æ’®åˆç­‰åœºæ™¯ï¼Œéƒ½å¯ä»¥åœ¨ AutoMQ + FSx ä¸Šè·å¾—æ—¢ç¨³å®šåˆå¯é¢„æµ‹çš„å»¶è¿Ÿè¡¨ç°ã€‚</p>
<h3 data-id="heading-5">æˆæœ¬è§£è¯»</h3>
<p>åœ¨æˆæœ¬å±‚é¢ï¼ŒAutoMQ çš„æ ¸å¿ƒè®¾è®¡æ˜¯ï¼šç”¨å°‘é‡ FSx æ„å»ºä¸€ä¸ªå¯é çš„åŒºåŸŸçº§æŒä¹… WALï¼Œç”¨æµ·é‡ S3 æ‰¿æ¥é•¿æœŸæ•°æ®ï¼Œä»è€Œå½¢æˆä¸ä¼ ç»Ÿ Kafka å®Œå…¨ä¸åŒçš„æˆæœ¬ç»“æ„ã€‚</p>
<ul>
<li>FSx åªæ‰¿æ‹…é«˜å¯é ã€ä½å»¶è¿Ÿçš„æŒä¹… WAL èŒè´£ï¼Œç”¨æ¥æ‰¿è½½æœ€æ–°ä¸€æ®µå†™å…¥æ—¥å¿—ï¼Œè€Œä¸ä¼šç”¨æ¥é•¿æ—¶é—´å †ç§¯ä¸šåŠ¡æ•°æ®ï¼›</li>
<li>S3 è´Ÿè´£å­˜æ”¾ç»å¤§éƒ¨åˆ†å†å²æ•°æ®ï¼Œæ˜¯é›†ç¾¤å®é™…å®¹é‡æ‰©å±•çš„ä¸»è¦è½½ä½“ï¼Œä¸»æ•°æ®å§‹ç»ˆåœ¨ S3 ä¸Šï¼Œæ•´ä½“å­˜å‚¨å•ä»·ç¨³å®šåœ¨å¯¹è±¡å­˜å‚¨é‡çº§ï¼›</li>
<li>ç”±äºå‰¯æœ¬å†—ä½™é›†ä¸­åœ¨ FSx ä¸ S3 çš„æœåŠ¡çº§é«˜å¯ç”¨ä¸Šï¼ŒAutoMQ ä¸å†éœ€è¦åœ¨ Broker ä¹‹é—´åšæ—¥å¿—å¤åˆ¶ï¼Œä¹Ÿä¸éœ€è¦è·¨ AZ å¤åˆ¶æ•°æ®ï¼Œä»æ ¹æºä¸Šé™ä½äº†å­˜å‚¨å’ŒåŒºåŸŸé—´æµé‡å¼€é”€ã€‚</li>
</ul>
<p>å¾—ç›Šäºè¿™ç§åˆ†å±‚è®¾è®¡ï¼Œå³ä¾¿æ˜¯ 10â€¯Gbps å†™å…¥ã€50 èŠ‚ç‚¹è§„æ¨¡çš„ AutoMQ é›†ç¾¤ï¼Œåœ¨ FSx ä¸Šä¹Ÿåªéœ€è¦ä¸åˆ° 100â€¯GB çš„ WAL ç©ºé—´ï¼›è€Œåœ¨ 1â€¯Gbps å†™å…¥ / 1â€¯Gbps æ¶ˆè´¹ã€TTL 3 å¤©çš„å…¸å‹åœºæ™¯ä¸‹ï¼Œåªéœ€ 6 å° m7g.4xlarge å’Œ 2Ã—1536â€¯GB çš„ FSx å³å¯æ»¡è¶³æ€§èƒ½ä¸å¯é æ€§éœ€æ±‚ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè™½ç„¶ FSx å•ä½å®¹é‡ä»·æ ¼æ›´é«˜ï¼Œä½†æˆ‘ä»¬åªéœ€è¦ä¸€å°å—ã€åŸºæœ¬å›ºå®šå®¹é‡çš„ FSx ç”¨äº WALï¼Œè¿™éƒ¨åˆ†æˆæœ¬ä¸ä¸šåŠ¡ TTL é•¿çŸ­ã€å†å²æ•°æ®è§„æ¨¡å‡ ä¹æ— å…³ï¼Œä¸ä¼šåƒä¼ ç»Ÿ Kafka é‚£æ ·éšç€ä¿ç•™å‘¨æœŸæ‹‰é•¿è€ŒæŒ‡æ•°å¼å¢åŠ å‰¯æœ¬å­˜å‚¨è´¹ç”¨ã€‚åŒæ—¶ï¼Œé€šè¿‡æ¶æ„ä¸Šå–æ¶ˆè·¨ AZ æ—¥å¿—å¤åˆ¶å’Œå¤§éƒ¨åˆ†è·¨ AZ æ•°æ®é¢æµé‡ï¼ŒAutoMQ é¿å…äº†ä¼ ç»Ÿ Kafka åœ¨å¤š AZ éƒ¨ç½²ä¸­å·¨é¢çš„ç½‘ç»œä¸å¤åˆ¶æˆæœ¬ï¼Œä½¿å¾—æ•´ä½“ TCO ä¾ç„¶ç”±å»‰ä»·çš„ S3 å­˜å‚¨å’ŒæŒ‰éœ€ä¼¸ç¼©çš„è®¡ç®—å®ä¾‹ä¸»å¯¼ï¼Œè€Œä¸æ˜¯è¢«å¤§è§„æ¨¡é«˜ä»·å—å­˜å‚¨å’Œè·¨ AZ å¸¦å®½è´¹ç”¨ç»‘æ¶ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡ä¸‹é¢è¿™ä¸ªå…·ä½“çš„ä»·æ ¼ä¾‹å­æ¥è¯´æ˜ä»·æ ¼ä¼˜åŠ¿ï¼ˆå•ä½ï¼šæœˆï¼‰ã€‚ä»è¿™ç»„å¯¹æ¯”æ•°æ®å¯ä»¥æ›´ç›´è§‚åœ°çœ‹å‡º FSx åœ¨æ•´ä½“æˆæœ¬ç»“æ„ä¸­çš„ä»·å€¼ï¼šåœ¨ç”Ÿæˆç«¯ P99 &lt; 10ms çš„åŒç­‰å»¶è¿Ÿç›®æ ‡ä¸‹ï¼Œä¼ ç»Ÿ Apache Kafka éœ€è¦ä¾èµ–å¤§é‡é«˜è§„æ ¼å®ä¾‹ã€ä¸‰å‰¯æœ¬å­˜å‚¨ä»¥åŠè·¨ AZ å¤åˆ¶æ‰èƒ½å‹‰å¼ºè¾¾æ ‡ï¼Œå•æœˆæ€»æˆæœ¬é«˜è¾¾çº¦ 22.7 ä¸‡ç¾å…ƒï¼Œå…¶ä¸­ç»å¤§éƒ¨åˆ†æ”¯å‡ºéƒ½è¢«æ˜‚è´µçš„å—å­˜å‚¨å’ŒåŒºåŸŸé—´æµé‡åå™¬ã€‚è€Œ AutoMQ BYOC + FSx é€šè¿‡å›ºå®šå®¹é‡ FSx WAL + S3 çš„æ¶æ„ï¼Œå°†å‰¯æœ¬å†—ä½™ä¸‹æ²‰åˆ° FSx/S3 çš„æœåŠ¡çº§é«˜å¯ç”¨ä¸Šï¼Œä¸å†åœ¨ Broker ä¹‹é—´åšæ—¥å¿—å¤åˆ¶ï¼Œä¹Ÿå‡ ä¹ä¸äº§ç”Ÿè·¨ AZ æ•°æ®é¢æµé‡ï¼Œåœ¨æä¾›åŒç­‰çº§åˆ«ï¼ˆç”šè‡³æ›´å¯é¢„æµ‹ï¼‰çš„äºš 10ms ç”Ÿæˆå»¶è¿Ÿçš„å‰æä¸‹ï¼Œæ€»æˆæœ¬ä»…çº¦ 1.8 ä¸‡ç¾å…ƒé‡çº§ï¼Œæ•´ä½“èŠ‚çœæ¥è¿‘ 10Ã—ã€‚</p>
<p>ä¸ AutoMQ å¼€æºï¼ˆS3 ç›´å†™ï¼‰çš„æ–¹æ¡ˆç›¸æ¯”ï¼Œå¼•å…¥ FSx åè™½ç„¶æ–°å¢äº†çº¦ 8,000 ç¾å…ƒçš„ FSx æˆæœ¬ï¼Œä½† S3 API è°ƒç”¨å¼€é”€æ˜¾è‘—ä¸‹é™ï¼ŒåŒæ—¶å°† P99 ä»è¿‘ 900ms ç›´æ¥æ‹‰å›åˆ°å‡ åæ¯«ç§’é‡çº§ï¼Œå®Œæˆäº†â€œä»¥æå°çš„é¢å¤–æˆæœ¬æ¢å–æ¥è¿‘æœ¬åœ°ç›˜ä½“éªŒçš„ä½å»¶è¿Ÿâ€çš„å‡çº§ã€‚è¿™ä¹Ÿè¯´æ˜ï¼Œåœ¨ AWS ä¸Šé€‰æ‹© AutoMQ + FSxï¼Œæœ¬è´¨ä¸Šæ˜¯ç”¨ä¸€ä¸ªå¯æ§ã€çº¿æ€§å¯é¢„ä¼°çš„ FSx æˆæœ¬ï¼Œæ¢å–ä¼ ç»Ÿ Kafka éš¾ä»¥å®ç°çš„ä½å»¶è¿Ÿã€å¤š AZ é«˜å¯ç”¨å’Œè·¨ AZ æµé‡æˆæœ¬è¿‘ä¹å½’é›¶çš„ç»¼åˆæ”¶ç›Šã€‚</p>
<p><img src="https://image.automq.com/20251224bot/la25yn.png" alt="" loading="lazy"/></p>
<h2 data-id="heading-6">AutoMQ BYOC x FSx: äº‘å¸‚åœºè¯•ç”¨</h2>
<h3 data-id="heading-7">å®‰è£… AutoMQ BYOC æ§åˆ¶é¢</h3>
<p>ä½ å¯ä»¥å‚è€ƒ AutoMQ å®˜æ–¹æ–‡æ¡£[2] ä» AWS Marketplace å®Œæˆ AutoMQ æ§åˆ¶é¢çš„å®‰è£…ã€‚</p>
<p><img src="https://image.automq.com/20251224bot/t7hld8.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-8">åˆ›å»ºé›†ç¾¤</h3>
<p>ç™»å…¥ AutoMQ æ§åˆ¶é¢çš„ Dashboardï¼Œç‚¹å‡» <code>Create Instance</code> æŒ‰é’®å¼€å§‹åˆ›å»ºé›†ç¾¤æµç¨‹ã€‚</p>
<p><img src="https://image.automq.com/20251224bot/yhltkr.png" alt="" loading="lazy"/></p>
<p>åœ¨é›†ç¾¤åˆ›å»ºæ­¥éª¤ Network Specs éƒ¨åˆ†é€‰æ‹© 3 AZ éƒ¨ç½²ã€‚åœ¨ AWS ä¸Šï¼Œå¦‚æœé€‰æ‹©å• AZ éƒ¨ç½²ï¼Œæˆ‘ä»¬ä»ç„¶é¦–å…ˆæ¨èä½¿ç”¨ EBS WALï¼Œå®ƒå…·æœ‰æœ€ä½³çš„æ€§èƒ½ã€æˆæœ¬è¡¨ç°ã€‚åœ¨å¤š AZ éƒ¨ç½²çš„æ—¶å€™ï¼Œè€ƒè™‘åˆ°è·¨ AZ ç½‘ç»œä¼ è¾“æˆæœ¬ï¼Œä½ å¯ä»¥é€‰æ‹© S3 WAL æˆ–è€… FSx WALã€‚å…³äº AutoMQ é€‰æ‹©ä¸åŒ WAL æ—¶åœ¨æˆæœ¬ã€æ€§èƒ½ä¸Šçš„å·®å¼‚è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£[3]ã€‚</p>
<p><img src="https://image.automq.com/20251224bot/0dsbd0.png" alt="" loading="lazy"/></p>
<p>é€‰æ‹©å¤š AZ éƒ¨ç½²ä»¥åï¼Œä½ å¯ä»¥åœ¨è®¡ç®—å­˜å‚¨è§„æ ¼ä¸­å‹¾é€‰<code>FS WAL</code> ç„¶åå¯¹é›†ç¾¤å®¹é‡è¿›è¡Œé…ç½®ã€‚</p>
<p>å½“ä½ é€‰æ‹© EBS WAL æˆ– S3 WAL ç­‰é€‰é¡¹æ—¶ï¼Œé›†ç¾¤çš„å®¹é‡è§„åˆ’è¢«ç®€åŒ–ä¸ºä»…éœ€é…ç½®ä¸€ä¸ªå‚æ•°ï¼šAKUï¼ˆAutoMQ Kafka Unitï¼‰ã€‚ä½ æ— éœ€å†ä¸ºå¦‚ä½•é€‰æ‹© EC2 å®ä¾‹ç±»å‹ã€è§„æ ¼å’Œæ•°é‡è€Œæ“å¿ƒï¼ŒAutoMQ ä¼šè‡ªåŠ¨ä¸ºä½ æŒ‘é€‰ç»è¿‡å……åˆ†å‹æµ‹éªŒè¯ã€åœ¨æ€§èƒ½ä¸æˆæœ¬ä¹‹é—´æœ€ä¼˜çš„ EC2 å®ä¾‹ç»„åˆï¼Œå¹¶ç¡®ä¿é›†ç¾¤èƒ½å¤Ÿç¨³å®šæ»¡è¶³å¹³å°æ‰€æ‰¿è¯ºçš„ååæ€§èƒ½æŒ‡æ ‡ã€‚ä¾‹å¦‚ï¼Œåœ¨ 3 AKU çš„é…ç½®ä¸‹ï¼ŒAutoMQ æ‰¿è¯ºå¯æä¾› 60 MB/s å†™å…¥ã€60 MB/s è¯»å–ã€2,400 RPSï¼Œä»¥åŠä¸å°‘äº 3,375 ä¸ªåˆ†åŒºã€‚é€šè¿‡å°†åº•å±‚å®¹é‡ä¸ç®—åŠ›æŠ½è±¡ä¸º AKUï¼ŒAutoMQ å°†ä¼ ç»Ÿ Kafka éƒ¨ç½²ä¸­å¤æ‚è€Œæ˜“å‡ºé”™çš„å®¹é‡è§„åˆ’è¿‡ç¨‹æ”¶æ•›ä¸ºä¸€ä¸ªæ¸…æ™°å¯é‡åŒ–çš„æŒ‡æ ‡ï¼›å…³äº AKU çš„è®¾è®¡ç†å¿µã€åŸºå‡†æµ‹è¯•æ–¹æ³•å’Œå®¹é‡æ¢ç®—è§„åˆ™ï¼Œå¯å‚è€ƒ AutoMQ å®˜æ–¹æ–‡æ¡£è·å–è¯¦ç»†è¯´æ˜[4]ã€‚</p>
<p>åœ¨æœ¬ç¤ºä¾‹ä¸­æˆ‘ä»¬é€‰æ‹© FSx WALï¼Œé™¤äº†é…ç½® AKU ä¹‹å¤–ï¼Œè¿˜éœ€è¦é¢å¤–é€‰æ‹© <strong>Amazon FSx for NetApp ONTAP</strong> çš„å®ä¾‹è§„æ ¼å’Œæ•°é‡ã€‚AutoMQ å·²å¯¹ä¸åŒ FSx ONTAP å®ä¾‹è§„æ ¼è¿›è¡Œäº†ç³»ç»ŸåŒ–çš„æ€§èƒ½å‹æµ‹ä¸éªŒè¯ï¼Œç”¨æˆ·æ— éœ€ä» IOPSã€å¸¦å®½ã€å®¹é‡ç­‰ç»´åº¦è‡ªè¡Œåšå¤æ‚è§„åˆ’ï¼Œåªéœ€æ ¹æ®ç›®æ ‡å†™å…¥ååé‡ï¼Œç»“åˆä¸‹è¡¨å³å¯å¿«é€Ÿä¼°ç®—æ‰€éœ€ FSx å®ä¾‹æ•°é‡ã€‚åœ¨å½“å‰é…ç½®ä¸­ï¼Œæˆ‘ä»¬é€‰æ‹©äº† 3 AKUï¼ˆå¯æ”¯æŒ 60 MB/s çš„è¯»å–ä¸å†™å…¥ï¼‰ï¼Œåªéœ€æ­é… 1 ä¸ª 384 MBps è§„æ ¼çš„ FSx å®ä¾‹å³å¯æ»¡è¶³ WAL å†™å…¥æ€§èƒ½éœ€æ±‚ã€‚</p>
<ul>
<li>FSx 384MBps è§„æ ¼ï¼Œæä¾› 150MiB/s Kafka å†™å…¥</li>
<li>FSx 768MBps è§„æ ¼ï¼Œæä¾› 300MiB/s Kafka å†™å…¥</li>
<li>FSx 1536MBps è§„æ ¼ï¼Œæä¾› 600MiB/s Kafka å†™å…¥</li>
</ul>
<p><img src="https://image.automq.com/20251224bot/pr83eg.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-9">è¯»å†™æµ‹è¯•</h3>
<p>é›†ç¾¤åˆ›å»ºå®Œæˆåï¼Œä½ å¯ä»¥åœ¨é›†ç¾¤è¯¦æƒ…é¡µé¢æŸ¥çœ‹é›†ç¾¤çš„åŸºç¡€ä¿¡æ¯ï¼Œå¹¶æŒ‰éœ€å¯¹é›†ç¾¤å®¹é‡è¿›è¡Œå¼¹æ€§è°ƒæ•´ã€‚</p>
<ul>
<li><strong>FSxï¼š</strong> å¾—ç›Šäº AutoMQ å­˜ç®—åˆ†ç¦»çš„å…±äº«å­˜å‚¨æ¶æ„ï¼Œä¸»æ•°æ®å…¨éƒ¨æŒä¹…åŒ–åœ¨å¯¹è±¡å­˜å‚¨ä¹‹ä¸Šï¼ŒFSx ä»…ç”¨äºåŠ é€Ÿ WAL ç­‰çƒ­è·¯å¾„ I/Oã€‚ä½ å¯ä»¥é€šè¿‡å¢åŠ æˆ–å‡å°‘ FSx å®ä¾‹æ•°é‡è¿›è¡Œæ°´å¹³æ‰©å®¹ï¼Œè€Œæ— éœ€åƒä¼ ç»Ÿ Kafka é‚£æ ·è¿›è¡Œç¹é‡çš„åˆ†åŒºè¿ç§»å’Œæ•°æ®æ¬ç§»ï¼Œä»è€Œä»¥ä¸šåŠ¡æ— æ„Ÿçš„æ–¹å¼æå‡æˆ–æ”¶ç¼© FSx å¯ç”¨å®¹é‡ä¸å¸¦å®½ã€‚</li>
<li><strong>AKUï¼š</strong> åœ¨å®Œæˆ FSx å®ä¾‹è°ƒæ•´åï¼Œä½ å¯ä»¥è¿›ä¸€æ­¥è°ƒæ•´ AKU çš„æ•°é‡ï¼Œä½¿é›†ç¾¤çš„æœ€å¤§å¤„ç†èƒ½åŠ›ä¸ FSx èƒ½å¤Ÿæä¾›çš„æœ€å¤§å†™å…¥èƒ½åŠ›ç›¸åŒ¹é…ï¼Œå®ç°è®¡ç®—ä¸å­˜å‚¨çš„è§£è€¦ä¼¸ç¼©å’Œæ•´ä½“èµ„æºåˆ©ç”¨ç‡çš„æœ€ä¼˜åŒ–ã€‚</li>
</ul>
<p><img src="https://image.automq.com/20251224bot/egyc5h.png" alt="" loading="lazy"/></p>
<p>åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ AutoMQ åŸºäº OpenMessaging[5] å°è£…çš„ perf å·¥å…·[6]æ¥è¿›è¡Œæ€§èƒ½æµ‹è¯•ã€‚æˆ‘ä»¬åœ¨åŒä¸€ VPC å†…çš„ä¸€å° EC2 ä¸Šå‘èµ·äº†å¦‚ä¸‹çš„æµ‹è¯•è´Ÿè½½ã€‚</p>
<pre><code class="hljs language-lua" lang="lua">KAFKA_HEAP_OPTS=<span class="hljs-string">"-Xmx2g -Xms2g"</span> ./bin/automq-perf-test.sh \
<span class="hljs-comment">--bootstrap-server 0.kf-t1rf19ju6yrtl9fh.fsx-test-wanshao.automq.private:9092,1.kf-t1rf19ju6yrtl9fh.fsx-test-wanshao.automq.private:9092,2.kf-t1rf19ju6yrtl9fh.fsx-test-wanshao.automq.private:9092 \</span>
<span class="hljs-comment">--producer-configs batch.size=0 \</span>
<span class="hljs-comment">--consumer-configs fetch.max.wait.ms=1000 \</span>
<span class="hljs-comment">--topics 10 \</span>
<span class="hljs-comment">--partitions-per-topic 128 \</span>
<span class="hljs-comment">--producers-per-topic 1 \</span>
<span class="hljs-comment">--groups-per-topic 1 \</span>
<span class="hljs-comment">--consumers-per-group 1 \</span>
<span class="hljs-comment">--record-size 52224 \</span>
<span class="hljs-comment">--send-rate 160 \</span>
<span class="hljs-comment">--warmup-duration 1 \</span>
<span class="hljs-comment">--test-duration 5 \</span>
<span class="hljs-comment">--reset</span>
</code></pre>
<p>ä»¥ä¸‹æ˜¯æœ¬æ¬¡ç¤ºä¾‹åœºæ™¯ä¸‹çš„è¯»å†™æ€§èƒ½æµ‹è¯•ç»“æœï¼Œä¾›å‚è€ƒã€‚ä»å®é™…æµ‹è¯•æ•°æ®å¯ä»¥çœ‹åˆ°ï¼ŒFSx çš„å†™å…¥å»¶è¿Ÿä¸åŸç”Ÿ Apache Kafka å¤„äºåŒä¸€é‡çº§ï¼Œèƒ½å¤Ÿæ»¡è¶³ç»å¤§å¤šæ•°å¯¹ç«¯åˆ°ç«¯å»¶è¿Ÿæ•æ„Ÿçš„äº‹ä»¶æµä¸å®æ—¶å¤„ç†åœºæ™¯çš„è¦æ±‚ã€‚</p>
<p><img src="https://image.automq.com/20251224bot/c3dbz7.png" alt="" loading="lazy"/></p>
<h2 data-id="heading-10">æ€»ç»“</h2>
<p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº† AutoMQ åœ¨ AWS ä¸Šå¼•å…¥ FSx ä½œä¸º WAL å±‚ä¹‹åï¼Œå¦‚ä½•åœ¨ä¿æŒ Diskless Kafka æ¶æ„å…¨éƒ¨ä¼˜åŠ¿çš„å‰æä¸‹ï¼ŒæŠŠç«¯åˆ°ç«¯å»¶è¿Ÿæ‹‰å›åˆ°é€‚é…æ ¸å¿ƒå®æ—¶ä¸šåŠ¡çš„æ°´å¹³ï¼šä¸€æ–¹é¢ï¼Œå€ŸåŠ©ã€ŒFSx + S3ã€çš„å…±äº«å­˜å‚¨æ¶æ„ï¼ŒAutoMQ å®ç°äº†çœŸæ­£æ„ä¹‰ä¸Šçš„å­˜ç®—åˆ†ç¦»ã€å¤š AZ é«˜å¯ç”¨ä»¥åŠè·¨ AZ æ•°æ®é¢æµé‡å‡ ä¹ä¸ºé›¶ï¼›å¦ä¸€æ–¹é¢ï¼Œé€šè¿‡åœ¨ FSx ä¸Šæ„å»ºä¸€ä¸ªå°è€Œé«˜æ•ˆçš„åŒºåŸŸçº§ WALï¼Œå°†å†™å…¥ä¸è¯»çƒ­ç‚¹å…¨éƒ¨æ”¶æ•›åˆ°ä½å»¶è¿Ÿå…±äº«å­˜å‚¨ï¼Œå†å¼‚æ­¥ä¸‹æ²‰åˆ° S3ï¼Œä»æ ¹æºä¸Šé‡å¡‘äº† Kafka åœ¨äº‘ä¸Šçš„æ€§èƒ½ä¸æˆæœ¬ç»“æ„ã€‚æœ¬æ¬¡ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯¹åŸºäº FSx çš„ AutoMQ è¿›è¡Œäº†ç®€å•çš„æ€§èƒ½éªŒè¯ï¼Œå¯ä»¥ç¨³å®šå®ç°äºš 10ms çº§åˆ«çš„å¹³å‡å†™å…¥å»¶è¿Ÿå’Œå‡ åæ¯«ç§’é‡çº§çš„ç«¯åˆ°ç«¯å»¶è¿Ÿï¼ŒåŒæ—¶ç»§ç»­äº«å— S3 çº§åˆ«çš„ä½æˆæœ¬å­˜å‚¨å’Œæ— çŠ¶æ€ Broker å¸¦æ¥çš„æè‡´å¼¹æ€§ä¼¸ç¼©èƒ½åŠ›ã€‚</p>
<p>å¦‚æœä½ æ­£åœ¨è¯„ä¼°å¦‚ä½•åœ¨ AWS ä¸Šä¸ºå¾®æœåŠ¡ã€é‡‘èäº¤æ˜“ã€é£æ§å†³ç­–ç­‰å»¶è¿Ÿæ•æ„Ÿä¸šåŠ¡æ„å»ºä¸€å¥—çœŸæ­£äº‘åŸç”Ÿã€ä½æˆæœ¬ã€å¯æ¨ªå‘æ‰©å±•çš„ Kafka åŸºç¡€è®¾æ–½ï¼Œæ¬¢è¿ç›´æ¥åœ¨ AWS Marketplace [8]ä¸Šä¸€é”®éƒ¨ç½²å¹¶ä½“éªŒ AutoMQ æ­é… FSx çš„æ–¹æ¡ˆï¼Œäº²è‡ªéªŒè¯ Sub-10ms Latency Diskless Kafka åœ¨ä½ çš„ç”Ÿäº§ç¯å¢ƒä¸­çš„è¡¨ç°ä¸ä»·å€¼ã€‚</p>
<p><img src="https://image.automq.com/20251224bot/z46ta6.png" alt="" loading="lazy"/></p>
<h2 data-id="heading-11">å‚è€ƒèµ„æ–™</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.automq.com%2Fdocs%2Fautomq%2Farchitecture%2Fs3stream-shared-streaming-storage%2Fwal-storage%23wal-storage" target="_blank" title="https://www.automq.com/docs/automq/architecture/s3stream-shared-streaming-storage/wal-storage#wal-storage" ref="nofollow noopener noreferrer">[1] AutoMQ WAL Storage</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.automq.com%2Fdocs%2Fautomq-cloud%2Fgetting-started%2Finstall-byoc-environment%2Faws%2Finstall-env-from-marketplace" target="_blank" title="https://www.automq.com/docs/automq-cloud/getting-started/install-byoc-environment/aws/install-env-from-marketplace" ref="nofollow noopener noreferrer">[2] Guide: Install AutoMQ from AWS Marketplace</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.automq.com%2Fdocs%2Fautomq%2Farchitecture%2Fs3stream-shared-streaming-storage%2Fwal-storage" target="_blank" title="https://www.automq.com/docs/automq/architecture/s3stream-shared-streaming-storage/wal-storage" ref="nofollow noopener noreferrer">[3] AutoMQ's WAL Storage</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.automq.com%2Fdocs%2Fautomq-cloud%2Fsubscriptions-and-billings%2Fbyoc-env-billings%2Fbilling-instructions-for-byoc%23metric-constraints" target="_blank" title="https://www.automq.com/docs/automq-cloud/subscriptions-and-billings/byoc-env-billings/billing-instructions-for-byoc#metric-constraints" ref="nofollow noopener noreferrer">[4] AutoMQ's AKU definition</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fopenmessaging.cloud%2Fdocs%2Fbenchmarks%2F" target="_blank" title="https://openmessaging.cloud/docs/benchmarks/" ref="nofollow noopener noreferrer">[5] The OpenMessaging Benchmark Framework</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FAutoMQ%2Fautomq%2Fblob%2Fmain%2Fbin%2Fautomq-perf-test.sh" target="_blank" title="https://github.com/AutoMQ/automq/blob/main/bin/automq-perf-test.sh" ref="nofollow noopener noreferrer">[6] AutoMQ's Open Source Perf Tool</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Faws.amazon.com%2Fmarketplace%2Fpp%2Fprodview-suwr5pyxwakrk%3FapplicationId%3DAWSMPContessa%26ref_%3Dbeagle%26sr%3D0-1" target="_blank" title="https://aws.amazon.com/marketplace/pp/prodview-suwr5pyxwakrk?applicationId=AWSMPContessa&amp;ref_=beagle&amp;sr=0-1" ref="nofollow noopener noreferrer">[7] AutoMQ AWS Marketplace</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäº Vue 3 å’Œ Guacamole æ­å»ºè¿œç¨‹æ¡Œé¢ï¼ˆåˆ©ç”¨RDPå»å®ç°ï¼Œå»é™¤vncç¹çé…ç½®ï¼‰]]></title>    <link>https://juejin.cn/post/7586934804291174434</link>    <guid>https://juejin.cn/post/7586934804291174434</guid>    <pubDate>2025-12-24T02:51:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586934804291174434" data-draft-id="7587175302347636771" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäº Vue 3 å’Œ Guacamole æ­å»ºè¿œç¨‹æ¡Œé¢ï¼ˆåˆ©ç”¨RDPå»å®ç°ï¼Œå»é™¤vncç¹çé…ç½®ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-24T02:51:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="404NotFound305"/> <meta itemprop="url" content="https://juejin.cn/user/270910253182796"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäº Vue 3 å’Œ Guacamole æ­å»ºè¿œç¨‹æ¡Œé¢ï¼ˆåˆ©ç”¨RDPå»å®ç°ï¼Œå»é™¤vncç¹çé…ç½®ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/270910253182796/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    404NotFound305
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T02:51:42.000Z" title="Wed Dec 24 2025 02:51:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åŸºäº Vue 3 å’Œ Guacamole æ­å»ºè¿œç¨‹æ¡Œé¢ï¼šæŠ€æœ¯å®ç°ä¸ç»†èŠ‚è§£æ</h2>
<p>åœ¨ Web ç«¯å®ç°æµç•…çš„è¿œç¨‹æ¡Œé¢è®¿é—®ï¼ŒApache Guacamole æ˜¯ç›®å‰æœ€æˆç†Ÿçš„æ–¹æ¡ˆä¹‹ä¸€ã€‚å®ƒé€šè¿‡ HTML5 Canvas è¿›è¡Œæ¸²æŸ“ï¼Œé¿å¼€äº†è§£ç æ’ä»¶çš„é™åˆ¶ã€‚ä»¥ä¸‹æ˜¯é’ˆå¯¹å‰ç«¯æ ¸å¿ƒé€»è¾‘çš„æ·±åº¦è§£æåŠæ³¨æ„äº‹é¡¹ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€ æ ¸å¿ƒé€»è¾‘åˆ†æ</h3>
<h4 data-id="heading-2">1. ä¸ºä»€ä¹ˆé€‰æ‹©åŸç”Ÿ Axios å‘é€è¯·æ±‚ï¼Ÿ</h4>
<p>åœ¨è¿æ¥å¼€å§‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å‘åç«¯è¯·æ±‚ <code>authToken</code>ã€‚ä»£ç ä¸­ä½¿ç”¨äº†åŸç”Ÿçš„ Axiosï¼Œå¹¶æ‰‹åŠ¨é…ç½®äº† <code>application/x-www-form-urlencoded</code>ã€‚</p>
<ul>
<li><strong>åè®®åŒ¹é…</strong>ï¼šGuacamole çš„åŸç”Ÿè®¤è¯æ¥å£é€šå¸¸éµå¾ªæ ‡å‡†çš„ Form Data æ ¼å¼ï¼Œè€Œé JSONã€‚ä½¿ç”¨åŸç”Ÿ Axios å¹¶æŒ‡å®š Headerï¼Œå¯ä»¥ç¡®ä¿è¯·æ±‚ä¸ä¼šè¢«é¡¹ç›®ä¸­å¯èƒ½å­˜åœ¨çš„å…¨å±€æ‹¦æˆªå™¨è¯¯ä¿®æ”¹ã€‚</li>
<li><strong>è§£è€¦</strong>ï¼šè¿œç¨‹æ¡Œé¢é€šå¸¸å±äºç‹¬ç«‹çš„ç®¡ç†æ¨¡å—ï¼Œä½¿ç”¨çº¯å‡€çš„è¯·æ±‚æ–¹å¼å¯ä»¥é¿å…ä¸ä¸»ç³»ç»Ÿçš„ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚ç»Ÿä¸€é”™è¯¯å¼¹çª—ã€Token åˆ·æ–°æœºåˆ¶ï¼‰äº§ç”Ÿå†²çªã€‚</li>
</ul>
<h4 data-id="heading-3">2. äº¤äº’çš„å…³é”®ï¼šåæ ‡ç¼©æ”¾ä¸æ˜ å°„</h4>
<p>åœ¨è¿œç¨‹æ¡Œé¢å¼€å‘ä¸­ï¼Œæœ€å¸¸è§çš„é—®é¢˜æ˜¯â€œé¼ æ ‡ç‚¹ä¸å‡†â€ã€‚</p>
<p>JavaScript</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">scale</span> = display.getScale()<span class="hljs-comment">;</span>
<span class="hljs-attr">state.mouseX</span> = Math.round((e.clientX - rect.left) / scale)<span class="hljs-comment">;</span>
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼šç”±äº Guacamole çš„ç”»å¸ƒä¼šæ ¹æ®æµè§ˆå™¨çª—å£åŠ¨æ€ç¼©æ”¾ï¼ŒDOM å…ƒç´ çš„åƒç´ ä½ç½®ï¼ˆClientX/Yï¼‰å¹¶ä¸ç­‰äºè¿œç¨‹æ“ä½œç³»ç»Ÿçš„ç‰©ç†åæ ‡ã€‚æˆ‘ä»¬å¿…é¡»è·å–å½“å‰çš„ç¼©æ”¾æ¯”ä¾‹ï¼Œå¹¶å°†åç§»é‡è¿›è¡Œåå‘è®¡ç®—ï¼Œå¦åˆ™ç”¨æˆ·å°†æ— æ³•ç²¾ç¡®ç‚¹å‡»åˆ°è¿œç¨‹ç³»ç»Ÿçš„å›¾æ ‡ã€‚</p>
<h4 data-id="heading-4">3. æ€§èƒ½ä¼˜åŒ–ï¼šhandleResize çš„å¤„ç†</h4>
<p>ä»£ç é€šè¿‡ <code>display.scale(scale)</code> æ¥é€‚é…çª—å£ï¼Œè€Œä¸æ˜¯é€šè¿‡ CSS æš´åŠ›æ‹‰ä¼¸ã€‚</p>
<ul>
<li><strong>æ¸…æ™°åº¦</strong>ï¼šCSS æ‹‰ä¼¸ä¼šå¯¼è‡´ç”»é¢æ¨¡ç³Šã€‚ä½¿ç”¨ Guacamole å†…ç½®çš„ç¼©æ”¾æ–¹æ³•å¯ä»¥ä¿æŒ Canvas åƒç´ çš„æ¸²æŸ“è´¨é‡ã€‚</li>
<li><strong>åŒæ­¥æ€§</strong>ï¼šæ‰‹åŠ¨è§¦å‘ç¼©æ”¾èƒ½ç¡®ä¿æ¸²æŸ“å¼•æ“å’Œåæ ‡æ˜ å°„é€»è¾‘åœ¨åŒä¸€ç¼©æ”¾ç³»æ•°ä¸‹è¿è¡Œï¼Œé¿å…äº¤äº’åç§»ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-5">äºŒã€ å¼€å‘æ³¨æ„äº‹é¡¹</h3>
<ol>
<li><strong>ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>ï¼šè¿œç¨‹æ¡Œé¢è¿æ¥éå¸¸æ¶ˆè€—æœåŠ¡ç«¯èµ„æºã€‚åŠ¡å¿…åœ¨ Vue ç»„ä»¶å¸è½½ï¼ˆ<code>onBeforeUnmount</code>ï¼‰æ—¶ä¸»åŠ¨è°ƒç”¨ <code>client.disconnect()</code>ï¼Œå¦åˆ™åç«¯çš„ <code>guacd</code> è¿›ç¨‹å¯èƒ½ä¼šå‡ºç°åƒµæ­»æˆ–èµ„æºå ç”¨è¿‡é«˜çš„æƒ…å†µã€‚</li>
<li><strong>å®‰å…¨æ€§</strong>ï¼šä»£ç ä¸­çš„ <code>GUAC_ID</code> å’Œ <code>token</code> æ˜¯è¿æ¥çš„å”¯ä¸€å‡­è¯ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¿™äº›æ•æ„Ÿä¿¡æ¯åº”ç”±åç«¯åŠ¨æ€ç”Ÿæˆå¹¶åŠ å¯†ï¼Œå‰ç«¯ä»…è´Ÿè´£é€ä¼ ã€‚</li>
<li><strong>ç½‘ç»œæ³¢åŠ¨</strong>ï¼šè¿œç¨‹æ¡Œé¢å¯¹äºç½‘ç»œå»¶è¿Ÿæå…¶æ•æ„Ÿã€‚å»ºè®®åœ¨ <code>client.onstatechange</code> ä¸­åŠ å…¥æ›´ç»†è‡´çš„çŠ¶æ€å¤„ç†ï¼Œå½“çŠ¶æ€é•¿æ—¶é—´å¤„äºâ€œæ­£åœ¨åˆå§‹åŒ–â€æ—¶ï¼Œç»™ç”¨æˆ·æ˜ç¡®çš„é‡è¿æç¤ºã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-6">ä¸‰ã€ å®Œæ•´å‰ç«¯å®ç°ä»£ç </h3>
<p>ä»¥ä¸‹æ˜¯å°è£…å¥½çš„ Vue 3 ç»„ä»¶ï¼Œä½ å¯ä»¥ç›´æ¥æ ¹æ®åç«¯æ¥å£åœ°å€å¡«å…¥å¯¹åº”çš„é…ç½®é¡¹ã€‚</p>
<p>ä»£ç æ®µ</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"rdp-manager"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">el-card</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"!state.isConnected"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"connect-card"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">header</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-header"</span>&gt;</span>è¿œç¨‹æ¡Œé¢è¿æ¥<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">el-form</span> <span class="hljs-attr">:model</span>=<span class="hljs-string">"rdpConfig"</span> <span class="hljs-attr">label-width</span>=<span class="hljs-string">"80px"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">el-form-item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"ä¸»æœºåœ°å€"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">el-input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"rdpConfig.hostname"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥è¿œç¨‹ä¸»æœº IP"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">el-form-item</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"large"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"startRDP"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 100%"</span>&gt;</span>
          ç«‹å³è¿æ¥
        <span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">el-form</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">el-card</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"state.isConnected"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"rdp-screen"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"rdp-toolbar"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>çŠ¶æ€: {{ state.isReady ? 'å·²è¿æ¥' : 'æ­£åœ¨åˆå§‹åŒ–...' }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"danger"</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"small"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"closeRDP"</span>&gt;</span>æ–­å¼€è¿æ¥<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"viewportRef"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"guac-viewport"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"debug-panel"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>è¿œç¨‹åæ ‡: {{ state.mouseX }}, {{ state.mouseY }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>æ¸²æŸ“çŠ¶æ€: {{ state.foundCanvas ? 'Canvas å·²å°±ç»ª' : 'ç­‰å¾…ç”»é¢...' }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref, reactive, onBeforeUnmount, nextTick } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ElMessage</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'element-plus'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Guacamole</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'guacamole-common-js'</span>;
<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;

<span class="hljs-comment">// --- é…ç½®é¡¹ï¼šè¯·æ ¹æ®å®é™…åç«¯ç¯å¢ƒå¡«å†™ ---</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">API_PREFIX</span> = <span class="hljs-string">''</span>;      <span class="hljs-comment">// ç¤ºä¾‹: http://1.2.3.4:8888/api</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">REAL_BACKEND_WS</span> = <span class="hljs-string">''</span>; <span class="hljs-comment">// ç¤ºä¾‹: ws://1.2.3.4:8888/guacamole/websocket-tunnel</span>

<span class="hljs-keyword">const</span> viewportRef = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>);
<span class="hljs-keyword">const</span> rdpConfig = <span class="hljs-title function_">reactive</span>({ <span class="hljs-attr">hostname</span>: <span class="hljs-string">''</span> });
<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({ 
  <span class="hljs-attr">isConnected</span>: <span class="hljs-literal">false</span>, 
  <span class="hljs-attr">isReady</span>: <span class="hljs-literal">false</span>, 
  <span class="hljs-attr">mouseX</span>: <span class="hljs-number">0</span>, 
  <span class="hljs-attr">mouseY</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">foundCanvas</span>: <span class="hljs-literal">false</span> 
});

<span class="hljs-keyword">let</span> client = <span class="hljs-literal">null</span>;
<span class="hljs-keyword">let</span> tunnel = <span class="hljs-literal">null</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleResize</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (!client || !viewportRef.<span class="hljs-property">value</span>) <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">const</span> display = client.<span class="hljs-title function_">getDisplay</span>();
  <span class="hljs-keyword">const</span> containerW = viewportRef.<span class="hljs-property">value</span>.<span class="hljs-property">clientWidth</span>;
  <span class="hljs-keyword">const</span> containerH = viewportRef.<span class="hljs-property">value</span>.<span class="hljs-property">clientHeight</span>;
  <span class="hljs-keyword">const</span> remoteW = display.<span class="hljs-title function_">getWidth</span>();
  <span class="hljs-keyword">const</span> remoteH = display.<span class="hljs-title function_">getHeight</span>();

  <span class="hljs-keyword">if</span> (remoteW &gt; <span class="hljs-number">0</span> &amp;&amp; remoteH &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">const</span> scale = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(containerW / remoteW, containerH / remoteH);
    display.<span class="hljs-title function_">scale</span>(scale);
    state.<span class="hljs-property">foundCanvas</span> = !!display.<span class="hljs-title function_">getElement</span>().<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'canvas'</span>);
  }
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleMouse</span> = (<span class="hljs-params">e</span>) =&gt; {
  <span class="hljs-keyword">if</span> (!client || !state.<span class="hljs-property">isReady</span>) <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">const</span> display = client.<span class="hljs-title function_">getDisplay</span>();
  <span class="hljs-keyword">const</span> rect = display.<span class="hljs-title function_">getElement</span>().<span class="hljs-title function_">getBoundingClientRect</span>();
  <span class="hljs-keyword">const</span> scale = display.<span class="hljs-title function_">getScale</span>();

  state.<span class="hljs-property">mouseX</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>((e.<span class="hljs-property">clientX</span> - rect.<span class="hljs-property">left</span>) / scale);
  state.<span class="hljs-property">mouseY</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>((e.<span class="hljs-property">clientY</span> - rect.<span class="hljs-property">top</span>) / scale);

  <span class="hljs-keyword">const</span> mouseState = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Guacamole</span>.<span class="hljs-property">Mouse</span>.<span class="hljs-title class_">State</span>(
    state.<span class="hljs-property">mouseX</span>, state.<span class="hljs-property">mouseY</span>, 
    e.<span class="hljs-property">buttons</span> &amp; <span class="hljs-number">1</span>, e.<span class="hljs-property">buttons</span> &amp; <span class="hljs-number">4</span>, e.<span class="hljs-property">buttons</span> &amp; <span class="hljs-number">2</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>
  );
  client.<span class="hljs-title function_">sendMouseState</span>(mouseState);
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">startRDP</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (!rdpConfig.<span class="hljs-property">hostname</span>) <span class="hljs-keyword">return</span> <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">warning</span>(<span class="hljs-string">'è¯·è¾“å…¥ä¸»æœºåœ°å€'</span>);

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">`<span class="hljs-subst">${API_PREFIX}</span>/api/tokens`</span>, 
      <span class="hljs-string">`username=&amp;password=`</span>, 
      { <span class="hljs-attr">headers</span>: { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-www-form-urlencoded'</span> } }
    );
    
    state.<span class="hljs-property">isConnected</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">nextTick</span>();
    
    <span class="hljs-title function_">initConnection</span>(res.<span class="hljs-property">data</span>.<span class="hljs-property">authToken</span> || <span class="hljs-string">''</span>);
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ— æ³•è¿æ¥åˆ°æˆæƒæœåŠ¡ï¼Œè¯·æ£€æŸ¥åç«¯é…ç½®'</span>);
  }
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">initConnection</span> = (<span class="hljs-params">token</span>) =&gt; {
  tunnel = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Guacamole</span>.<span class="hljs-title class_">WebSocketTunnel</span>(<span class="hljs-variable constant_">REAL_BACKEND_WS</span>);
  client = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Guacamole</span>.<span class="hljs-title class_">Client</span>(tunnel);
  
  <span class="hljs-keyword">const</span> displayElement = client.<span class="hljs-title function_">getDisplay</span>().<span class="hljs-title function_">getElement</span>();
  viewportRef.<span class="hljs-property">value</span>.<span class="hljs-title function_">appendChild</span>(displayElement);

  client.<span class="hljs-property">onstatechange</span> = <span class="hljs-function">(<span class="hljs-params">s</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (s === <span class="hljs-number">3</span>) {
      state.<span class="hljs-property">isReady</span> = <span class="hljs-literal">true</span>;
      <span class="hljs-title function_">handleResize</span>();
      <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'resize'</span>, handleResize);
    }
  };

  client.<span class="hljs-title function_">getDisplay</span>().<span class="hljs-property">onresize</span> = handleResize;

  <span class="hljs-keyword">const</span> params = {
    <span class="hljs-string">'token'</span>: token,
    <span class="hljs-string">'GUAC_DATA_SOURCE'</span>: <span class="hljs-string">''</span>,
    <span class="hljs-string">'GUAC_ID'</span>: <span class="hljs-string">''</span>, 
    <span class="hljs-string">'GUAC_TYPE'</span>: <span class="hljs-string">'c'</span>,
    <span class="hljs-string">'GUAC_WIDTH'</span>: <span class="hljs-number">1920</span>,
    <span class="hljs-string">'GUAC_HEIGHT'</span>: <span class="hljs-number">1080</span>,
    <span class="hljs-string">'GUAC_DPI'</span>: <span class="hljs-number">96</span>,
    <span class="hljs-string">'GUAC_AUDIO'</span>: <span class="hljs-string">'audio/L16'</span>,
    <span class="hljs-string">'GUAC_IMAGE'</span>: <span class="hljs-string">'image/png'</span>
  };

  <span class="hljs-keyword">const</span> query = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(params)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">k</span> =&gt;</span> <span class="hljs-string">`<span class="hljs-subst">${k}</span>=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(params[k])}</span>`</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">'&amp;'</span>);

  client.<span class="hljs-title function_">connect</span>(query);

  displayElement.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousemove'</span>, handleMouse);
  displayElement.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousedown'</span>, handleMouse);
  displayElement.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mouseup'</span>, handleMouse);
  displayElement.<span class="hljs-property">oncontextmenu</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> e.<span class="hljs-title function_">preventDefault</span>();
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">closeRDP</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'resize'</span>, handleResize);
  <span class="hljs-keyword">if</span> (client) client.<span class="hljs-title function_">disconnect</span>();
  state.<span class="hljs-property">isConnected</span> = <span class="hljs-literal">false</span>;
  state.<span class="hljs-property">isReady</span> = <span class="hljs-literal">false</span>;
};

<span class="hljs-title function_">onBeforeUnmount</span>(closeRDP);
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.rdp-manager</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100vh</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#1a1a1a</span>;
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">justify-content</span>: center;
  <span class="hljs-attribute">overflow</span>: hidden;
}

<span class="hljs-selector-class">.connect-card</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">400px</span>;
}

<span class="hljs-selector-class">.rdp-screen</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">flex-direction</span>: column;
}

<span class="hljs-selector-class">.rdp-toolbar</span> {
  <span class="hljs-attribute">height</span>: <span class="hljs-number">40px</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#333</span>;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#eee</span>;
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">justify-content</span>: space-between;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">20px</span>;
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
}

<span class="hljs-selector-class">.viewport</span> {
  <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#000</span>;
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">justify-content</span>: center;
  <span class="hljs-attribute">overflow</span>: hidden;
}

:<span class="hljs-built_in">deep</span>(.guac-display) {
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.5</span>);
}

<span class="hljs-selector-class">.debug-panel</span> {
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">bottom</span>: <span class="hljs-number">20px</span>;
  <span class="hljs-attribute">right</span>: <span class="hljs-number">20px</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.7</span>);
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#00ff00</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;
  <span class="hljs-attribute">font-family</span>: monospace;
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">12px</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;
  <span class="hljs-attribute">pointer-events</span>: none;
  <span class="hljs-attribute">z-index</span>: <span class="hljs-number">99</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c8f51138f197436bb15f789a66eb2a2e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgNDA0Tm90Rm91bmQzMDU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149502&amp;x-signature=pX6walHeznyxw4YRc30RE3euFpY%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2026æœ€æ–°æ¬¾Vite7+Vue3+DeepSeek-V3.2+Markdownæµå¼è¾“å‡ºAIä¼šè¯]]></title>    <link>https://juejin.cn/post/7586994471738392619</link>    <guid>https://juejin.cn/post/7586994471738392619</guid>    <pubDate>2025-12-24T02:52:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586994471738392619" data-draft-id="7586971886589870123" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2026æœ€æ–°æ¬¾Vite7+Vue3+DeepSeek-V3.2+Markdownæµå¼è¾“å‡ºAIä¼šè¯"/> <meta itemprop="keywords" content="Vue.js,DeepSeek,OpenAI"/> <meta itemprop="datePublished" content="2025-12-24T02:52:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="xiaoyan2015"/> <meta itemprop="url" content="https://juejin.cn/user/4230576475215165"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2026æœ€æ–°æ¬¾Vite7+Vue3+DeepSeek-V3.2+Markdownæµå¼è¾“å‡ºAIä¼šè¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4230576475215165/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    xiaoyan2015
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T02:52:52.000Z" title="Wed Dec 24 2025 02:52:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿æ¥å´­æ–°2026å¹´ï¼Œå†æ—¶ä¸¤å‘¨çˆ†è‚è¿­ä»£ç ”å‘ <code>vue3.5+vant4+openai</code> é›†æˆ <code>deepseek-chat</code> èŠå¤©å¤§æ¨¡å‹ã€‚æ–°å¢<strong>ä»£ç é«˜äº®å¤åˆ¶</strong>ã€<strong>katexå…¬å¼</strong>åŠ<strong>mermaidå›¾è¡¨</strong>è§£æç­‰åŠŸèƒ½ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b3f9b89db8034b5f91b08ce2d0918813~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=y%2F7piVRPSVkhMNOndLwcvqlP%2F%2F0%3D" alt="æœªæ ‡é¢˜-5.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c06f4b85e0034329b7d4b4bcd5d7e02f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=C01Tv6Fm2RUvjrJj5RaozKDKUys%3D" alt="p3.gif" loading="lazy"/></p>
<p>vite7-deepseekæ–°å¢<strong>ä»£ç å¤åˆ¶</strong>ã€<strong>katexæ•°å­¦å…¬å¼</strong>åŠ<strong>mermaidå›¾è¡¨</strong>åŠŸèƒ½ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ef1a1f4811549e28836b296b9abbbf7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=DMn08xl1COMntGV2WR%2BMO679go8%3D" alt="015360æˆªå›¾20251222210008268.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c57e527595e34b2aafe08d43e3318b26~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=cgOl64Ioe%2FfWly0K9E1XEse0iuI%3D" alt="p4.gif" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/06f61bc077c443f1b305e39551fd3a87~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=Ri98RypyPkl4H4mdaRyESY4nI3s%3D" alt="p5.gif" loading="lazy"/></p>
<h2 data-id="heading-0">ä½¿ç”¨æŠ€æœ¯</h2>
<ul>
<li>å¼€å‘å·¥å…·ï¼šVscode</li>
<li>å‰ç«¯æ¡†æ¶ï¼švite^7.2.4+vue^3.5.24+vue-router^4.6.4</li>
<li>å¤§æ¨¡å‹æ¡†æ¶ï¼šdeepseek-v3.2 + openai</li>
<li>ç»„ä»¶åº“ï¼švant^4.9.21 (æœ‰èµvue3ç§»åŠ¨ç«¯ç»„ä»¶åº“)</li>
<li>çŠ¶æ€ç®¡ç†ï¼špinia^3.0.4</li>
<li>ä»£ç é«˜äº®æ’ä»¶ï¼šhighlight.js^11.11.1</li>
<li>markdownè§£æï¼šmarkdown-it</li>
<li>katexå…¬å¼ï¼š@mdit/plugin-katex^0.24.1</li>
<li>æœ¬åœ°ç¼“å­˜ï¼špinia-plugin-persistedstate^4.7.1</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/acc34a854bcd4012a327b5e050692643~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=CKC6wBg%2B7B7tjziiezfeiVs4b%2FA%3D" alt="æœªæ ‡é¢˜-4.png" loading="lazy"/></p>
<h2 data-id="heading-1">åŠŸèƒ½ç‰¹æ€§</h2>
<ol>
<li>Vite7.2æ„å»ºï¼Œæ¥å…¥DeepSeek-Chatæ¨¡å‹ï¼Œæµå¼æ‰“å­—ã€æ€§èƒ½æ›´ä¼˜ã€å¯¹è¯ä¸æ»‘æµç•…</li>
<li>æ”¯æŒå„ç§ä»£ç é«˜äº®ï¼ˆå¤åˆ¶ä»£ç /æ”¶ç¼©åŠŸèƒ½ï¼‰</li>
<li>æ–°å¢æ”¯æŒè¾“å‡ºKatexæ•°å­¦å…¬å¼ã€Mermaidå›¾è¡¨</li>
<li>ä½¿ç”¨vant4ç»„ä»¶åº“ï¼Œé£æ ¼ç»Ÿä¸€ï¼Œæ—¶å°šå¤§æ°”</li>
<li>æ”¯æŒç§»åŠ¨ç«¯+PCç«¯750pxåƒç´ é€‚é…</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1beeac1368e4f70889a685b0f67505a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=faUwoMUXzhmGN4dklZrGdAm0HDk%3D" alt="p2_1.gif" loading="lazy"/></p>
<h2 data-id="heading-2">é¡¹ç›®æ¡†æ¶ç›®å½•</h2>
<p>ä½¿ç”¨<code>vite7.2</code>åˆ›å»ºé¡¹ç›®æ¨¡æ¿ï¼Œé›†æˆ<code>deepseek-v3.2</code>å¯¹è¯å¤§æ¨¡å‹ï¼Œ<code>vue3 setup</code>è¯­æ³•ç³–ç¼–ç ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd48ef516ac84036b37cf0cd0870e100~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=yLzBqkUSjeseb3%2FSOMmrOl76o4o%3D" alt="360æˆªå›¾20251222233502584.png" loading="lazy"/></p>
<h2 data-id="heading-3">vue3ç¯å¢ƒå˜é‡.env</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/867b668928f24b38be662e95c323ebd6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=pq7F2Qx0RmfL25MigHfbz0M%2BAH0%3D" alt="360æˆªå›¾20251222233755347.png" loading="lazy"/></p>
<p>å¦‚ä¸Šå›¾ï¼šåªéœ€æ›¿æ¢ä¸‹é¡¹ç›®æ ¹ç›®å½•ä¸‹ <strong>.env</strong> æ–‡ä»¶é‡Œçš„keyï¼Œå³å¯ç•…å¿«ä½“éªŒæµå¼è¾“å‡ºå¯¹è¯åŠŸèƒ½ã€‚</p>
<h2 data-id="heading-4">é¡¹ç›®é€šç”¨å¸ƒå±€</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fcd7b456dc7744d29228849f41b983fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=N6zNy2QDzL7nN557w0Df5nMdZEs%3D" alt="47e1a5f57babf41e391a3ff4193b53be_1289798-20251223102355099-271621583.png" loading="lazy"/></p>
<p>å¦‚ä¸Šå›¾ï¼šé¡¹ç›®æ•´ä½“ç»“æ„åˆ†ä¸º<strong>é¡¶éƒ¨æ ‡é¢˜æ +ä¼šè¯åŒº+åº•éƒ¨ç¼–è¾‘åŒº</strong>ä¸‰ä¸ªéƒ¨åˆ†ã€‚</p>
<pre><code class="hljs language-ts" lang="ts">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flexbox flex-col"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"height:100%;"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Toolbar</span> <span class="hljs-attr">:title</span>=<span class="hljs-string">"chatSession?.title"</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"v3ai__scrollview flex1"</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- Chatå¯¹è¯ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"chatSession &amp;&amp; !isEmpty(chatSession.data)"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"v3ai__chatbot"</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"scrollRef"</span> @<span class="hljs-attr">scroll</span>=<span class="hljs-string">"onScroll"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"v3ai__chatbot-sessions"</span>&gt;</span>
          ...
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- æ»šåŠ¨åº•éƒ¨ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"v3ai__scrollbottom"</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"{'is-bottom': reachBottom}"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"scrollToBottom"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"iconfont ai-arrD"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- å¯¼è¯­ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-else</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"v3ai__chatbot-intro"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"logo iconfont ai-deepseek"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"name"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"txt text-gradient"</span>&gt;</span>å—¨~ Vue3-DeepSeek<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"desc"</span>&gt;</span>ä½ èº«è¾¹çš„æ™ºèƒ½å°å¸®æ‰‹ï¼Œæˆ‘å¯ä»¥å¸®ä½ æœç´¢ã€ç­”ç–‘ã€å†™ä½œï¼Œè¯·æŠŠä½ çš„ä»»åŠ¡äº¤ç»™æˆ‘å§~<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"prompt"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tip"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>ä½ å¯ä»¥è¿™æ ·é—®<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">span</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"refreshPrompt"</span>&gt;</span>æ¢ä¸€æ¢<span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"iconfont ai-shuaxin"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"list"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(item,index) in promptList"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"index"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"txt"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"changePrompt(item.prompt)"</span>&gt;</span>{{item.emoji}} {{item.prompt}}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- ç¼–è¾‘å™¨ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ChatEditor</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"editorRef"</span> <span class="hljs-attr">:value</span>=<span class="hljs-string">"promptValue"</span> <span class="hljs-attr">:reachBottom</span>=<span class="hljs-string">"reachBottom"</span> <span class="hljs-attr">:scrollBottom</span>=<span class="hljs-string">"scrollToBottom"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b4d3703b25e34d19a17f67bba3af4884~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=FWSIWL3o%2FIMKEeSaR19kvPzDEbg%3D" alt="001360æˆªå›¾20251222193621367.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc8af9c8e6cc43cf97018971585f12ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=E5QqiOvT3XjyB9gHZJ7D03AUjEY%3D" alt="001360æˆªå›¾20251222193715663.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b995b159f1c47d7884101d5864aedc9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=WcCTDQWFxIVDpKla%2B8RE4%2BTWUSc%3D" alt="002360æˆªå›¾20251222193857046.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da9eaa20e4db4fa898e7c145a78f5cb9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=bxxkmARPuKiiCGJ5DB%2Bw7s5Ht5g%3D" alt="004360æˆªå›¾20251222194654876.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0b489d7fc99b45bab208c2b631ddfe79~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=%2FlKgQxSqXyjIeMroMGViY0CmdnY%3D" alt="004360æˆªå›¾20251222194816308.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f415f8ff40f742c38baa184cc7af9251~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=bsIq26M59gzyRK9W7efli8uZFCY%3D" alt="005360æˆªå›¾20251222194921868.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e8f4a9a9caf407eb37de465fc1eaec8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=pAvr2r4v%2BkusswfJBLMddY2cFfI%3D" alt="006360æˆªå›¾20251222195224210.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7852e196888345ae9bf21b852230b635~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=nFcBcEySn%2BQuKyhuEm8iaNjZBkI%3D" alt="007360æˆªå›¾20251222201358858.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8721c5a74cad4f61bcd47ea245076b36~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=OTm7XRbEBmB9S8KkPbZpVrqBi7M%3D" alt="009360æˆªå›¾20251222201751888.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55f748b317ac4950997c7304f2c343cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=QT46pd887spET3f%2Bk8ZrFKSBNL8%3D" alt="010360æˆªå›¾20251222203850741.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/99a29c52f6fa4d869cbacffd863608eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=bKx8YoCxzXuBMkjO9g1MtHJ3fyQ%3D" alt="012360æˆªå›¾20251222204205526.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f516e7e4b3f14c95862343dca44d3bcc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=1IEwto%2FVqvQfSR%2BjKWK%2ByTjz4Cg%3D" alt="014360æˆªå›¾20251222204432469.png" loading="lazy"/></p>
<h2 data-id="heading-5">vue3+markdownæ”¯æŒkatexå’Œmermaid</h2>
<p>åœ¨é¡µé¢å¼•å…¥katexæ’ä»¶å’Œmermaidæ’ä»¶ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { imgSize } <span class="hljs-keyword">from</span> <span class="hljs-string">'@mdit/plugin-img-size'</span> <span class="hljs-comment">// æ”¯æŒå¸¦å°ºå¯¸å›¾ç‰‡</span>
<span class="hljs-keyword">import</span> { katex } <span class="hljs-keyword">from</span> <span class="hljs-string">"@mdit/plugin-katex"</span>; <span class="hljs-comment">// æ”¯æŒæ•°å­¦å…¬å¼</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'katex/dist/katex.min.css'</span>
<span class="hljs-comment">// æ¸²æŸ“mermaidå›¾è¡¨</span>
<span class="hljs-keyword">import</span> { markdownItMermaidPlugin } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/components/markdown/plugins/mermaidPlugin'</span>
</code></pre>
<p>åœ¨æ¸²æŸ“ç»„ä»¶ä¸­è°ƒç”¨å¦‚ä¸‹</p>
<pre><code class="hljs language-ts" lang="ts">&lt;<span class="hljs-title class_">Markdown</span>
  :source=<span class="hljs-string">"item.content"</span>
  :html=<span class="hljs-string">"true"</span>
  :linkify=<span class="hljs-string">"true"</span>
  :typographer=<span class="hljs-string">"true"</span>
  :plugins=<span class="hljs-string">"[
    imgSize,
    [katex, {delimiters: 'all'}],
    [markdownItMermaidPlugin, { ... }]
  ]"</span>
  <span class="hljs-meta">@copy</span>=<span class="hljs-string">"onCopy"</span>
/&gt;
</code></pre>
<p>å°è£…ä¸€ä¸ªmermaidå›¾è¡¨æ’ä»¶ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">markdownItMermaidPlugin</span> = (<span class="hljs-params">md, options</span>) =&gt; {
  <span class="hljs-keyword">const</span> defaultFence = md.<span class="hljs-property">renderer</span>.<span class="hljs-property">rules</span>.<span class="hljs-property">fence</span>
  md.<span class="hljs-property">renderer</span>.<span class="hljs-property">rules</span>.<span class="hljs-property">fence</span> = <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> [tokens, idx] = args
    <span class="hljs-keyword">const</span> token = tokens[idx]
    <span class="hljs-keyword">const</span> lang = token.<span class="hljs-property">info</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\[.*\]/</span>, <span class="hljs-string">''</span>).<span class="hljs-title function_">trim</span>() || <span class="hljs-string">''</span>

    <span class="hljs-keyword">if</span>(lang === <span class="hljs-string">'mermaid'</span>) {
      <span class="hljs-keyword">const</span> code = token.<span class="hljs-property">content</span>.<span class="hljs-title function_">trim</span>()
      <span class="hljs-keyword">const</span> hash = <span class="hljs-title function_">generateHash</span>(code)
      <span class="hljs-keyword">const</span> uuid = <span class="hljs-string">`<span class="hljs-subst">${hash}</span>-<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>-<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random().toString(<span class="hljs-number">36</span>).substring(<span class="hljs-number">2</span>, <span class="hljs-number">9</span>)}</span>`</span>

      <span class="hljs-comment">// å¦‚æœæœ‰ç¼“å­˜ï¼ŒåŠ è½½ç¼“å­˜å›¾è¡¨</span>
      <span class="hljs-keyword">if</span>(renderCache.<span class="hljs-title function_">has</span>(hash)) {
        <span class="hljs-comment">// console.log('åŠ è½½ç¼“å­˜mermaidå›¾è¡¨')</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">`
          <span class="hljs-subst">${ defaultFence(...args) }</span>
          &lt;div class="mermaid-container"&gt;<span class="hljs-subst">${renderCache.get(hash)}</span>&lt;/div&gt;
        `</span>
      }

      <span class="hljs-title function_">nextTickRender</span>(uuid)

      <span class="hljs-keyword">return</span> <span class="hljs-string">`
        <span class="hljs-subst">${ defaultFence(...args) }</span>
        &lt;div class="mermaid-container" id="<span class="hljs-subst">${uuid}</span>" data-mermaid-hash="<span class="hljs-subst">${hash}</span>" data-mermaid-code="<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(code)}</span>"&gt;
          &lt;div class="mermaid-loading"&gt;ğŸ“ŠMermaid å›¾è¡¨åŠ è½½ä¸­...&lt;/div&gt;
        &lt;/div&gt;
      `</span>
    }

    <span class="hljs-keyword">return</span> <span class="hljs-title function_">defaultFence</span>(...args)
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">nextTickRender</span>(<span class="hljs-params">containerId</span>) {
    <span class="hljs-comment">// å¦‚æœå®¹å™¨å­˜åœ¨ï¼Œç›´æ¥æ¸²æŸ“</span>
    <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(containerId)) {
      <span class="hljs-title function_">renderMermaidDiagram</span>(containerId)
      <span class="hljs-keyword">return</span>
    }
    <span class="hljs-comment">// ä½¿ç”¨MutationObserverç›‘å¬DOMæ›´æ–°</span>
    <span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutationObserver</span>(<span class="hljs-function">(<span class="hljs-params">mutations, ob</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(containerId)
      <span class="hljs-keyword">if</span>(container) {
        ob.<span class="hljs-title function_">disconnect</span>()
        <span class="hljs-title function_">renderMermaidDiagram</span>(containerId)
      }
    })
    observer.<span class="hljs-title function_">observe</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>, {
      <span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>
    })
  }
  
  <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">renderMermaidDiagram</span>(<span class="hljs-params">containerId</span>) {
    <span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(containerId)
    <span class="hljs-keyword">if</span> (!container) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`Mermaid container #<span class="hljs-subst">${containerId}</span> not found`</span>)
      <span class="hljs-keyword">return</span>
    }
  
    <span class="hljs-keyword">const</span> code = <span class="hljs-built_in">decodeURIComponent</span>(container.<span class="hljs-property">dataset</span>.<span class="hljs-property">mermaidCode</span>)
    <span class="hljs-keyword">const</span> hash = container.<span class="hljs-property">dataset</span>.<span class="hljs-property">mermaidHash</span>

    <span class="hljs-keyword">if</span> (!code) {
      <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// æ£€æŸ¥ mermaid æ˜¯å¦å¯ç”¨</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">window</span>.<span class="hljs-property">mermaid</span> === <span class="hljs-string">'undefined'</span>) {
      <span class="hljs-title function_">showError</span>(container, <span class="hljs-string">'Mermaid åº“æœªåŠ è½½!'</span>)
      <span class="hljs-keyword">return</span>
    }
  
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// é…ç½® mermaidï¼ˆå¦‚æœè¿˜æœªé…ç½®ï¼‰</span>
      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">window</span>.<span class="hljs-property">mermaid</span>.<span class="hljs-property">initialized</span>) {
        <span class="hljs-variable language_">window</span>.<span class="hljs-property">mermaid</span>.<span class="hljs-title function_">initialize</span>({
          <span class="hljs-attr">startOnLoad</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">theme</span>: <span class="hljs-string">'default'</span>,
          <span class="hljs-attr">securityLevel</span>: <span class="hljs-string">'loose'</span>,
        })
        <span class="hljs-variable language_">window</span>.<span class="hljs-property">mermaid</span>.<span class="hljs-property">initialized</span> = <span class="hljs-literal">true</span>
      }
  
      <span class="hljs-keyword">let</span> svg
  
      <span class="hljs-comment">// æ£€æŸ¥ç¼“å­˜</span>
      <span class="hljs-keyword">if</span>(renderCache.<span class="hljs-title function_">has</span>(hash)) {
        svg = renderCache.<span class="hljs-title function_">get</span>(hash)
      }<span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">const</span> { isValid } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">verifyMermaid</span>(code)

        <span class="hljs-keyword">if</span>(!isValid) {
          <span class="hljs-title function_">showError</span>(container, <span class="hljs-string">`&lt;pre&gt;æ¸²æŸ“è¯­æ³•é”™è¯¯ï¼š\n<span class="hljs-subst">${ code }</span>\n&lt;/pre&gt;`</span>)
          <span class="hljs-keyword">return</span>
        }

        <span class="hljs-comment">// ä½¿ç”¨å”¯ä¸€IDæ¸²æŸ“(é¿å…å›¾è¡¨å†²çª)</span>
        <span class="hljs-keyword">const</span> {<span class="hljs-attr">svg</span>: renderedSvg} = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">window</span>.<span class="hljs-property">mermaid</span>.<span class="hljs-title function_">render</span>(<span class="hljs-string">`mermaid-<span class="hljs-subst">${containerId}</span>`</span>, code)
        svg = renderedSvg
        renderCache.<span class="hljs-title function_">set</span>(hash, svg)
      }

      <span class="hljs-comment">// æ›´æ–°å®¹å™¨å†…å®¹</span>
      container.<span class="hljs-property">innerHTML</span> = svg
      container.<span class="hljs-title function_">removeAttribute</span>(<span class="hljs-string">'data-mermaid-hash'</span>)
      container.<span class="hljs-title function_">removeAttribute</span>(<span class="hljs-string">'data-mermaid-code'</span>)

      <span class="hljs-comment">// è§¦å‘å›è°ƒ</span>
      <span class="hljs-keyword">if</span>(options?.<span class="hljs-property">reachBottom</span>) {
        options?.<span class="hljs-property">onRender</span>?.()
      }
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Mermaid æ¸²æŸ“å¤±è´¥:'</span>, error)
      <span class="hljs-title function_">showError</span>(container, <span class="hljs-string">`&lt;pre&gt;æ¸²æŸ“å›¾è¡¨æ—¶å‡ºé”™: \n <span class="hljs-subst">${error.message}</span>\n&lt;/pre&gt;`</span>)
    }
  }
}
</code></pre>
<p>å½“ç„¶é¡¹ç›®è¿˜æ”¯æŒè¿è¡Œåˆ°PCç«¯ï¼Œä»¥750pxå®½åº¦æ˜¾ç¤ºé¡µé¢å¸ƒå±€ï¼Œä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/855f2217082944f2a3e51dd4d37cf0e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=P%2BKsXW2vXWDMbwAo82nggNS3KO8%3D" alt="015360æˆªå›¾20251222205124068.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8602e3a34ef747b9a60413bb93cef96d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=4xjkh8WD4tYTGP1wPsV6tjngVZ0%3D" alt="015360æˆªå›¾20251222205317068.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/978b89012a7a4e59a7982703adfeaca1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=TZtTkB8vV720vCrV6b1a%2ByX%2BWLg%3D" alt="015360æˆªå›¾20251222205434741.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef9e5939a75b4a2ba3e22ec5dd85024a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=MwYoL5m%2BsFYZL7fgUikfUM%2FSEqw%3D" alt="015360æˆªå›¾20251222205900564.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/885c53d0052b46f4ad4b22f119df7ec5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=JSfN6nRr9MOfWL0nQR5eGTk5qyc%3D" alt="015360æˆªå›¾20251222210220635.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff971545581144bcb7f3baffc25d7032~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=odvjAIgq3zNAeu9cpSMNa5%2BJ91Q%3D" alt="015360æˆªå›¾20251222210419690.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2447ca137bee408781c87b4d244665d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=3ABWqOBFDjWs4A8zf1oOjOM9NeQ%3D" alt="015360æˆªå›¾20251222210730201.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/23c503a8bedd46d58593d66923f66101~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3lhbjIwMTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149572&amp;x-signature=vXgeCcvZDuwXQFPw9RjfHS5rTlI%3D" alt="015360æˆªå›¾20251222210730204.png" loading="lazy"/></p>
<h2 data-id="heading-6">vue3+deepseekå¤šè½®å¯¹è¯å’Œæµå¼è¾“å‡º</h2>
<ul>
<li>å®ç°ä¸€ä¸ªä¸Šä¸‹æ–‡å¤šè½®ä¼šè¯</li>
</ul>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> completion = <span class="hljs-keyword">await</span> openai.<span class="hljs-property">chat</span>.<span class="hljs-property">completions</span>.<span class="hljs-title function_">create</span>({
  <span class="hljs-comment">// å•ä¸€ä¼šè¯</span>
  <span class="hljs-comment">/* messages: [
    {role: 'user', content: editorValue}
  ], */</span>
  <span class="hljs-comment">// å¤šè½®ä¼šè¯</span>
  <span class="hljs-attr">messages</span>: props.<span class="hljs-property">multiConversation</span> ? historySession.<span class="hljs-property">value</span> : [{<span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>, <span class="hljs-attr">content</span>: editorValue}],
  <span class="hljs-attr">model</span>: <span class="hljs-string">'deepseek-chat'</span>, <span class="hljs-comment">// deepseek-chatå¯¹è¯æ¨¡å‹ deepseek-reasoneræ¨ç†æ¨¡å‹</span>
  <span class="hljs-attr">stream</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æµå¼è¾“å‡º</span>
  <span class="hljs-attr">max_tokens</span>: <span class="hljs-number">8192</span>, <span class="hljs-comment">// é™åˆ¶ä¸€æ¬¡è¯·æ±‚ä¸­æ¨¡å‹ç”Ÿæˆ completion çš„æœ€å¤§ token æ•°(é»˜è®¤ä½¿ç”¨ 4096)</span>
  <span class="hljs-attr">temperature</span>: <span class="hljs-number">0.4</span>, <span class="hljs-comment">// ä¸¥è°¨é‡‡æ · è¶Šä½è¶Šä¸¥è°¨(é»˜è®¤1)</span>
})
</code></pre>
<ul>
<li>æµå¼è¾“å‡ºå¯¹è¯</li>
</ul>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">for</span> <span class="hljs-keyword">await</span> (<span class="hljs-keyword">const</span> chunk <span class="hljs-keyword">of</span> completion) {
  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å·²ç»ˆæ­¢</span>
  <span class="hljs-keyword">if</span>(chatState.<span class="hljs-property">aborted</span>) <span class="hljs-keyword">break</span>

  <span class="hljs-keyword">const</span> content = chunk.<span class="hljs-property">choices</span>[<span class="hljs-number">0</span>]?.<span class="hljs-property">delta</span>?.<span class="hljs-property">content</span>
  <span class="hljs-keyword">if</span>(content) {
    streamText += content
    <span class="hljs-comment">// é™åˆ¶æ›´æ–°é¢‘ç‡ï¼šæ¯100msæœ€å¤šæ›´æ–°ä¸€æ¬¡</span>
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
    <span class="hljs-keyword">if</span>(now - lastUpdate &gt; <span class="hljs-number">100</span>) {
      lastUpdate = now
      <span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// ...</span>
      })
    }
  }
  <span class="hljs-keyword">if</span>(chunk.<span class="hljs-property">choices</span>[<span class="hljs-number">0</span>]?.<span class="hljs-property">finish_reason</span> === <span class="hljs-string">'stop'</span>) {
    <span class="hljs-comment">// ç¡®ä¿æœ€ç»ˆå†…å®¹å®Œæ•´æ›´æ–°</span>
    ...
  }
}
</code></pre>
<p>Okï¼Œä»¥ä¸Šå°±æ˜¯vite7+vue3é›†æˆdeepseek-chatå®ç°æµå¼aiå¯¹è¯çš„ä¸€äº›é¡¹ç›®åˆ†äº«ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰ç‚¹å¸®åŠ©ï¼</p>
<p><a href="https://juejin.cn/post/7501149179563376680" target="_blank" title="https://juejin.cn/post/7501149179563376680">åŸºäºuniapp+vue3+deepseek+markdownæ­å»ºappç‰ˆæµå¼è¾“å‡ºAIæ¨¡æ¿</a></p>
<p><a href="https://juejin.cn/post/7486369696738017321" target="_blank" title="https://juejin.cn/post/7486369696738017321">vue3.5+deepseek+arco+markdownæ­å»ºwebç‰ˆæµå¼è¾“å‡ºAIæ¨¡æ¿</a></p>
<p><a href="https://juejin.cn/post/7555690975866044431" target="_blank" title="https://juejin.cn/post/7555690975866044431">2025æœ€æ–°æ¬¾Electron38+Vite7+Vue3+ElementPlusç”µè„‘ç«¯åå°adminç³»ç»Ÿ</a></p>
<p><a href="https://juejin.cn/post/7550160737244708898" target="_blank" title="https://juejin.cn/post/7550160737244708898">åŸºäºelectron38+vite7+vue3 setup+elementPlusç”µè„‘ç«¯ä»¿å¾®ä¿¡/QQèŠå¤©è½¯ä»¶</a></p>
<p><a href="https://juejin.cn/post/7560576454849757220" target="_blank" title="https://juejin.cn/post/7560576454849757220">electron38.2-vue3osç³»ç»Ÿ|Vite7+Electron38+Pinia3+ArcoDesignæ¡Œé¢ç‰ˆOSç®¡ç†ç³»ç»Ÿ</a></p>
<p><a href="https://juejin.cn/post/7565043957638938675" target="_blank" title="https://juejin.cn/post/7565043957638938675">2025æœ€æ–°ç‰ˆTauri2.8+Vite7.1+Vue3+ElementPluså®¢æˆ·ç«¯èŠå¤©è½¯ä»¶Exe</a></p>
<p><a href="https://juejin.cn/post/7567181492067696655" target="_blank" title="https://juejin.cn/post/7567181492067696655">æœ€æ–°è‡ªåˆ›Tauri2.9+Vite7.1+Vue3+ElementPlusæ¡Œé¢ç«¯é€šç”¨åå°ç³»ç»Ÿç®¡ç†Exeæ¨¡æ¿</a></p>
<p><a href="https://juejin.cn/post/7574357603406217266" target="_blank" title="https://juejin.cn/post/7574357603406217266">2025åŸåˆ›ç ”å‘Tauri2.9+Vite7.2+Vue3+ArcoDesignå®¢æˆ·ç«¯OSç®¡ç†ç³»ç»ŸExe</a></p>
<p><a href="https://juejin.cn/post/7534184729319440419" target="_blank" title="https://juejin.cn/post/7534184729319440419">åŸºäºflutter3.32+window_managerä»¿macOS/Winsé£æ ¼æ¡Œé¢osç³»ç»Ÿ</a></p>
<p><a href="https://juejin.cn/post/7529357546844504100" target="_blank" title="https://juejin.cn/post/7529357546844504100">flutter3.27+bitsdojo_windowç”µè„‘ç«¯ä»¿å¾®ä¿¡Exeåº”ç”¨</a></p>
<p><a href="https://juejin.cn/post/7552733801081749513" target="_blank" title="https://juejin.cn/post/7552733801081749513">æœ€æ–°ç‰ˆVite7+Vue3+Pinia3+ArcoDesignç½‘é¡µç‰ˆwebosåå°ç®¡ç†ç³»ç»Ÿ</a></p>
<p><a href="https://juejin.cn/post/7522315126492512283" target="_blank" title="https://juejin.cn/post/7522315126492512283">åŸºäºuniapp+vue3+uvueä»¿æŠ–éŸ³appçŸ­è§†é¢‘+èŠå¤©+ç›´æ’­appç³»ç»Ÿ</a></p>
<p><a href="https://juejin.cn/post/7537106747279065134" target="_blank" title="https://juejin.cn/post/7537106747279065134">åŸºäºuni-app+vue3+uvuiè·¨ä¸‰ç«¯ä»¿å¾®ä¿¡appèŠå¤©æ¨¡æ¿</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React ä¸­å…„å¼Ÿç»„ä»¶é€šä¿¡çš„æœ€ä½³å®è·µï¼šä»¥ Todo åº”ç”¨ä¸ºä¾‹]]></title>    <link>https://juejin.cn/post/7586971532698959881</link>    <guid>https://juejin.cn/post/7586971532698959881</guid>    <pubDate>2025-12-24T02:58:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586971532698959881" data-draft-id="7586959875768516617" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React ä¸­å…„å¼Ÿç»„ä»¶é€šä¿¡çš„æœ€ä½³å®è·µï¼šä»¥ Todo åº”ç”¨ä¸ºä¾‹"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-24T02:58:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ohyeah"/> <meta itemprop="url" content="https://juejin.cn/user/740446536480618"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React ä¸­å…„å¼Ÿç»„ä»¶é€šä¿¡çš„æœ€ä½³å®è·µï¼šä»¥ Todo åº”ç”¨ä¸ºä¾‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/740446536480618/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ohyeah
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T02:58:59.000Z" title="Wed Dec 24 2025 02:58:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ React å¼€å‘ä¸­ï¼Œç»„ä»¶ä¹‹é—´çš„é€šä¿¡æ˜¯æ„å»ºäº¤äº’å¼åº”ç”¨çš„æ ¸å¿ƒç¯èŠ‚ã€‚å°¤å…¶æ˜¯å½“å¤šä¸ªå­ç»„ä»¶éœ€è¦å…±äº«æˆ–åŒæ­¥çŠ¶æ€æ—¶ï¼Œå¦‚ä½•é«˜æ•ˆã€æ¸…æ™°åœ°å®ç°é€šä¿¡æœºåˆ¶å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚æœ¬æ–‡å°†ä»¥ä¸€ä¸ªå…¸å‹çš„ Todo åº”ç”¨ä¸ºä¾‹ï¼Œæ·±å…¥æ¢è®¨ React ä¸­<strong>å…„å¼Ÿç»„ä»¶é€šä¿¡çš„å®ç°æ–¹å¼</strong>ï¼Œå¹¶å±•ç¤ºå¦‚ä½•é€šè¿‡â€œçŠ¶æ€æå‡â€ä¸â€œå•å‘æ•°æ®æµâ€åŸåˆ™ï¼Œæ„å»ºç»“æ„æ¸…æ™°ã€æ˜“äºç»´æŠ¤çš„åº”ç”¨é€»è¾‘ã€‚</p>
<h2 data-id="heading-0">é¡¹ç›®ç»“æ„æ¦‚è§ˆ</h2>
<p>è¯¥ Todo åº”ç”¨åŸºäº React + Vite + Stylus æ„å»ºï¼Œæ•´ä½“ç»“æ„ç®€æ´æ˜äº†ï¼š</p>
<ul>
<li><code>App.jsx</code>ï¼šæ ¹ç»„ä»¶ï¼Œè´Ÿè´£ç®¡ç†å…¨å±€çŠ¶æ€å’Œæ ¸å¿ƒé€»è¾‘ï¼›</li>
<li><code>components/TodoInput.jsx</code>ï¼šç”¨äºè¾“å…¥æ–°ä»»åŠ¡ï¼›</li>
<li><code>components/TodoList.jsx</code>ï¼šå±•ç¤ºä»»åŠ¡åˆ—è¡¨ï¼Œå¹¶æ”¯æŒå®Œæˆ/åˆ é™¤æ“ä½œï¼›</li>
<li><code>components/TodoStats.jsx</code>ï¼šæ˜¾ç¤ºä»»åŠ¡ç»Ÿè®¡ä¿¡æ¯ï¼Œå¹¶æä¾›æ¸…é™¤å·²å®Œæˆä»»åŠ¡çš„åŠŸèƒ½ã€‚</li>
</ul>
<p>è¿™ä¸‰ä¸ªå­ç»„ä»¶å½¼æ­¤ä¹‹é—´æ²¡æœ‰ç›´æ¥è”ç³»ï¼Œä½†å®ƒä»¬éƒ½éœ€è¦è®¿é—®æˆ–ä¿®æ”¹åŒä¸€ä»½ä»»åŠ¡æ•°æ®ï¼ˆ<code>todos</code>ï¼‰ã€‚è¿™ç§åœºæ™¯æ­£æ˜¯å…„å¼Ÿç»„ä»¶é€šä¿¡çš„å…¸å‹ç”¨ä¾‹ã€‚</p>
<h2 data-id="heading-1">çŠ¶æ€æå‡ï¼šå…„å¼Ÿé€šä¿¡çš„å…³é”®ç­–ç•¥</h2>
<p>React å®˜æ–¹æ¨èçš„å…„å¼Ÿç»„ä»¶é€šä¿¡æ–¹å¼æ˜¯<strong>å°†å…±äº«çŠ¶æ€æå‡è‡³æœ€è¿‘çš„å…±åŒçˆ¶ç»„ä»¶</strong>ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>App</code> ç»„ä»¶å°±æ˜¯ <code>TodoInput</code>ã€<code>TodoList</code> å’Œ <code>TodoStats</code> çš„å…±åŒçˆ¶ç»„ä»¶ï¼Œå› æ­¤å®ƒæ‰¿æ‹…äº†ä»¥ä¸‹èŒè´£ï¼š</p>
<ol>
<li><strong>æŒæœ‰å…±äº«çŠ¶æ€</strong>ï¼šé€šè¿‡ <code>useState</code> ç®¡ç† <code>todos</code> æ•°ç»„ï¼›</li>
<li><strong>æä¾›çŠ¶æ€ä¿®æ”¹æ–¹æ³•</strong>ï¼šå¦‚ <code>addTodo</code>ã€<code>deleteTodo</code>ã€<code>toggleTodo</code>ã€<code>clearCompleted</code>ï¼›</li>
<li><strong>å°†çŠ¶æ€å’Œæ–¹æ³•é€šè¿‡ props ä¼ é€’ç»™å­ç»„ä»¶</strong>ã€‚</li>
</ol>
<p>è¿™ç§æ–¹å¼ç¡®ä¿äº†æ•°æ®æµçš„<strong>å•å‘æ€§</strong>â€”â€”æ‰€æœ‰çŠ¶æ€å˜æ›´éƒ½ç”±çˆ¶ç»„ä»¶ç»Ÿä¸€å¤„ç†ï¼Œå­ç»„ä»¶ä»…é€šè¿‡å›è°ƒå‡½æ•°â€œè¯·æ±‚â€å˜æ›´ï¼Œè€Œä¸èƒ½ç›´æ¥ä¿®æ”¹çŠ¶æ€ã€‚è¿™ä¸ä»…é¿å…äº†çŠ¶æ€ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œä¹Ÿä½¿å¾—è°ƒè¯•å’Œæµ‹è¯•æ›´åŠ å®¹æ˜“ã€‚</p>
<h3 data-id="heading-2">åˆå§‹åŒ–çŠ¶æ€ä¸æœ¬åœ°æŒä¹…åŒ–</h3>
<p>åœ¨ <code>App.jsx</code> ä¸­ï¼Œ<code>todos</code> çš„åˆå§‹å€¼å¹¶éç®€å•çš„ç©ºæ•°ç»„ï¼Œè€Œæ˜¯å°è¯•ä» <code>localStorage</code> ä¸­è¯»å–ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-section">[todos, setTodos]</span> = useState(() =&gt; {
  const <span class="hljs-attr">saved</span> = localStorage.getItem(<span class="hljs-string">'todos'</span>)<span class="hljs-comment">;</span>
  return saved ? JSON.parse(saved) : <span class="hljs-section">[]</span><span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>
</code></pre>
<p>è¿™é‡Œä½¿ç”¨äº† <code>useState</code> çš„<strong>åˆå§‹åŒ–å‡½æ•°å½¢å¼</strong>ï¼Œé¿å…æ¯æ¬¡æ¸²æŸ“éƒ½æ‰§è¡Œè§£æé€»è¾‘ï¼Œæ˜¯ä¸€ç§æ€§èƒ½ä¼˜åŒ–æŠ€å·§ã€‚</p>
<p>åŒæ—¶ï¼Œé€šè¿‡ <code>useEffect</code> ç›‘å¬ <code>todos</code> çš„å˜åŒ–ï¼Œè‡ªåŠ¨å°†å…¶åŒæ­¥åˆ°æœ¬åœ°å­˜å‚¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'todos'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(todos));
}, [todos]);
</code></pre>
<p>è¿™ç§â€œé›†ä¸­ç›‘å¬+è‡ªåŠ¨æŒä¹…åŒ–â€çš„è®¾è®¡ï¼Œé¿å…äº†åœ¨æ¯ä¸ªçŠ¶æ€ä¿®æ”¹å‡½æ•°ä¸­é‡å¤å†™å…¥ <code>localStorage</code>ï¼Œä½“ç°äº†å…³æ³¨ç‚¹åˆ†ç¦»çš„åŸåˆ™ã€‚</p>
<h2 data-id="heading-3">å­ç»„ä»¶å¦‚ä½•ä¸çˆ¶ç»„ä»¶åä½œ</h2>
<h3 data-id="heading-4">1. <code>TodoInput</code>ï¼šæäº¤æ–°ä»»åŠ¡</h3>
<p><code>TodoInput</code> ç»„ä»¶å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªå±€éƒ¨çŠ¶æ€ <code>inputValue</code>ï¼Œç”¨äºæ§åˆ¶è¾“å…¥æ¡†çš„å†…å®¹ã€‚React ä¸æ”¯æŒv-modelé‚£æ ·çš„åŒå‘ç»‘å®šï¼Œé€šè¿‡<code>å•å‘ç»‘å®š + onChange </code> å®ç°æ•°æ®çŠ¶æ€å’Œè§†å›¾çš„åŒæ­¥ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;input 
  <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
  <span class="hljs-attr">value</span>={inputValue}
  <span class="hljs-attr">onChange</span>={e =&gt; setInputValue(e.target.value)}
/&gt;
</code></pre>
<p>å½“ç”¨æˆ·æäº¤è¡¨å•æ—¶ï¼Œè°ƒç”¨çˆ¶ç»„ä»¶ä¼ å…¥çš„ <code>onAdd</code> å›è°ƒï¼š</p>
<pre><code class="hljs language-scss" lang="scss">const handleSubmit = (e) =&gt; {
  e<span class="hljs-selector-class">.preventDefault</span>(); <span class="hljs-comment">// é˜»æ­¢è¡¨å•é»˜è®¤è·³è½¬</span>
  <span class="hljs-built_in">onAdd</span>(inputValue); <span class="hljs-comment">// è¡¨å•å†…å®¹é€šè¿‡onAdd(çˆ¶ç»„ä»¶çš„è‡ªå®šä¹‰å‡½æ•°)è¿›è¡Œæ·»åŠ   'æ‰“æŠ¥å‘Š'</span>
  <span class="hljs-built_in">setInputValue</span>(''); <span class="hljs-comment">// æ¸…ç©ºè¾“å…¥æ¡† ç”¨æˆ·ä½“éªŒ</span>
};
</code></pre>
<p>è¿™é‡Œçš„å…³é”®åœ¨äºï¼š<code>TodoInput</code> <strong>ä¸å…³å¿ƒ</strong> <code>todos</code> æ˜¯ä»€ä¹ˆï¼Œä¹Ÿä¸ç›´æ¥æ“ä½œå®ƒï¼Œåªè´Ÿè´£â€œé€šçŸ¥â€çˆ¶ç»„ä»¶â€œæˆ‘æƒ³æ·»åŠ ä¸€ä¸ªä»»åŠ¡â€ã€‚</p>
<h3 data-id="heading-5">2. <code>TodoList</code>ï¼šå±•ç¤ºä¸æ“ä½œä»»åŠ¡</h3>
<p><code>TodoList</code> æ¥æ”¶å®Œæ•´çš„ <code>todos</code> åˆ—è¡¨ä»¥åŠä¸¤ä¸ªæ“ä½œå‡½æ•° <code>onDelete</code> å’Œ <code>onToggle</code>ã€‚å®ƒé€šè¿‡ <code>map</code> æ¸²æŸ“æ¯ä¸ªä»»åŠ¡é¡¹ï¼Œå¹¶ä¸ºå¤é€‰æ¡†å’Œåˆ é™¤æŒ‰é’®ç»‘å®šç›¸åº”çš„å›è°ƒï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;input 
  <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> 
  <span class="hljs-attr">checked</span>={todo.completed} 
  <span class="hljs-attr">onChange</span>={() =&gt; <span class="hljs-literal">on</span>Toggle(todo.id)} 
/&gt;
&lt;button <span class="hljs-attr">onClick</span>={() =&gt; <span class="hljs-literal">on</span>Delete(todo.id)}&gt;X&lt;/button&gt;
</code></pre>
<p>æ³¨æ„ï¼š<code>onToggle</code> å’Œ <code>onDelete</code> éƒ½åªä¼ é€’ <code>id</code>ï¼Œè€Œä¸æ˜¯æ•´ä¸ª <code>todo</code> å¯¹è±¡ã€‚è¿™ç§è®¾è®¡å‡å°‘äº†ä¸å¿…è¦çš„æ•°æ®ä¼ é€’ï¼Œä¹Ÿä½¿å¾—çˆ¶ç»„ä»¶çš„å¤„ç†é€»è¾‘æ›´æ¸…æ™°ã€‚</p>
<h3 data-id="heading-6">3. <code>TodoStats</code>ï¼šå±•ç¤ºç»Ÿè®¡ä¸æ‰¹é‡æ“ä½œ</h3>
<p><code>TodoStats</code> æ¥æ”¶ä»»åŠ¡æ€»æ•°ã€æ´»è·ƒæ•°ã€å·²å®Œæˆæ•°ï¼Œä»¥åŠ <code>onClearCompleted</code> å‡½æ•°ã€‚å®ƒæ ¹æ® <code>completed &gt; 0</code> åŠ¨æ€æ¸²æŸ“â€œæ¸…é™¤å·²å®Œæˆâ€æŒ‰é’®ï¼š</p>
<pre><code class="hljs language-css" lang="css">{completed &gt; <span class="hljs-number">0</span> &amp;&amp; (
  &lt;<span class="hljs-selector-tag">button</span> onClick={onClearCompleted}&gt;<span class="hljs-attribute">Clear</span> Completed&lt;/<span class="hljs-selector-tag">button</span>&gt;
)}
</code></pre>
<p>è¿™ç§æ¡ä»¶æ¸²æŸ“æå‡äº†ç”¨æˆ·ä½“éªŒï¼Œé¿å…åœ¨æ— å¯æ¸…é™¤é¡¹æ—¶æ˜¾ç¤ºæ— ç”¨æŒ‰é’®ã€‚</p>
<h2 data-id="heading-7">æ ¸å¿ƒçŠ¶æ€æ“ä½œé€»è¾‘è§£æ</h2>
<p>çˆ¶ç»„ä»¶ <code>App</code> ä¸­å®šä¹‰äº†å››ä¸ªå…³é”®çš„çŠ¶æ€æ›´æ–°å‡½æ•°ï¼Œå®ƒä»¬å…±åŒæ„æˆäº†åº”ç”¨çš„æ•°æ®å˜æ›´ä¸­æ¢ã€‚</p>
<h3 data-id="heading-8">æ·»åŠ ä»»åŠ¡ï¼š<code>addTodo</code></h3>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">addTodo</span> = (text) =&gt; {
  setTodos(<span class="hljs-section">[...todos, {
    id: Date.now(),
    text,
    completed: false
  }]</span>)<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<p>ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦åˆ›å»ºæ–°æ•°ç»„ï¼Œä¿è¯ä¸å¯å˜æ€§ã€‚è¿™é‡Œåªæ˜¯ç®€å•<code>id</code> ä½¿ç”¨ <code>Date.now()</code> ï¼Œè¿™ç§ç”¨æ³•åœ¨é«˜é¢‘ç‡æ·»åŠ æ—¶å¯èƒ½å†²çªã€‚</p>
<h3 data-id="heading-9">åˆ é™¤ä»»åŠ¡ï¼š<code>deleteTodo</code></h3>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">deleteTodo</span> = (id) =&gt; {
  setTodos(todos.filter(<span class="hljs-attr">todo</span> =&gt; todo.id !== id))<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<p><code>filter</code> æ–¹æ³•è¿”å›ä¸€ä¸ª<strong>æ–°æ•°ç»„</strong>ï¼Œä»…åŒ…å« <code>id</code> ä¸ç­‰äºç›®æ ‡å€¼çš„é¡¹ã€‚è¿™æ˜¯ React ä¸­åˆ é™¤åˆ—è¡¨é¡¹çš„æ ‡å‡†åšæ³•ã€‚</p>
<h3 data-id="heading-10">åˆ‡æ¢å®ŒæˆçŠ¶æ€ï¼š<code>toggleTodo</code></h3>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">toggleTodo</span> = (id) =&gt; {
  setTodos(todos.map(<span class="hljs-attr">todo</span> =&gt; 
    <span class="hljs-attr">todo.id</span> === id ? { ...todo, completed: !todo.completed } : todo
  ))<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<p>è¿™é‡Œä½¿ç”¨ <code>map</code> éå†æ•°ç»„ï¼Œå¯¹åŒ¹é… <code>id</code> çš„é¡¹è¿›è¡Œå±æ€§æ›´æ–°ï¼ˆä½¿ç”¨å±•å¼€è¯­æ³•ä¿ç•™å…¶ä»–å­—æ®µï¼‰ï¼Œå…¶ä½™é¡¹ä¿æŒä¸å˜ã€‚</p>
<h3 data-id="heading-11">æ¸…é™¤å·²å®Œæˆä»»åŠ¡ï¼š<code>clearCompleted</code></h3>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">clearCompleted</span> = () =&gt; {
  setTodos(todos.filter(<span class="hljs-attr">todo</span> =&gt; !todo.completed))<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<p>å†æ¬¡åˆ©ç”¨ <code>filter</code>ï¼Œä¿ç•™ <code>completed</code> ä¸º <code>false</code> çš„é¡¹ã€‚é€»è¾‘ç®€æ´ä¸”é«˜æ•ˆã€‚</p>
<h2 data-id="heading-12">å…„å¼Ÿç»„ä»¶é€šä¿¡çš„æœ¬è´¨ï¼šé—´æ¥ä½†å¯é </h2>
<p>è™½ç„¶ <code>TodoInput</code>ã€<code>TodoList</code> å’Œ <code>TodoStats</code> åœ¨ UI ä¸Šæ˜¯å¹¶åˆ—å…³ç³»ï¼Œä½†å®ƒä»¬ä¹‹é—´çš„â€œé€šä¿¡â€å¹¶éç›´æ¥å‘ç”Ÿã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li>å½“ <code>TodoInput</code> æ·»åŠ ä¸€ä¸ªæ–°ä»»åŠ¡åï¼Œ<code>TodoList</code> èƒ½ç«‹å³æ˜¾ç¤ºå®ƒï¼›</li>
<li>å½“ <code>TodoList</code> åˆ é™¤ä¸€ä¸ªä»»åŠ¡åï¼Œ<code>TodoStats</code> çš„è®¡æ•°ä¼šè‡ªåŠ¨æ›´æ–°ï¼›</li>
<li>å½“ <code>TodoStats</code> æ¸…é™¤å·²å®Œæˆä»»åŠ¡åï¼Œ<code>TodoList</code> ä¼šç§»é™¤å¯¹åº”é¡¹ã€‚</li>
</ul>
<p>è¿™ä¸€åˆ‡çš„å®ç°ï¼Œéƒ½ä¾èµ–äº <code>App</code> ç»„ä»¶ä½œä¸º<strong>ä¸­å¤®è°ƒåº¦å™¨</strong>ï¼š</p>
<ol>
<li>å­ç»„ä»¶ A è§¦å‘å›è°ƒ â†’ çˆ¶ç»„ä»¶æ›´æ–°çŠ¶æ€ï¼›</li>
<li>çˆ¶ç»„ä»¶çŠ¶æ€å˜åŒ– â†’ æ‰€æœ‰æ¥æ”¶è¯¥çŠ¶æ€çš„å­ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼›</li>
<li>å­ç»„ä»¶ B å’Œ C è‡ªåŠ¨è·å¾—æœ€æ–°æ•°æ®ã€‚</li>
</ol>
<p>è¿™ç§æ¨¡å¼è™½ç„¶å¢åŠ äº†çˆ¶ç»„ä»¶çš„èŒè´£ï¼Œä½†æ¢æ¥çš„æ˜¯<strong>æ¸…æ™°çš„æ•°æ®æµå‘</strong>å’Œ<strong>å¯é¢„æµ‹çš„çŠ¶æ€å˜æ›´</strong>ï¼Œéå¸¸é€‚åˆä¸­å°å‹åº”ç”¨ã€‚</p>
<h2 data-id="heading-13">æ€»ç»“ä¸å¯ç¤º</h2>
<p>é€šè¿‡è¿™ä¸ª Todo åº”ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥æç‚¼å‡º React ä¸­å…„å¼Ÿç»„ä»¶é€šä¿¡çš„æœ€ä½³å®è·µï¼š</p>
<ul>
<li><strong>çŠ¶æ€æå‡</strong>ï¼šå°†å…±äº«çŠ¶æ€ç½®äºæœ€è¿‘çš„å…±åŒçˆ¶ç»„ä»¶ï¼›</li>
<li><strong>å•å‘æ•°æ®æµ</strong>ï¼šå­ç»„ä»¶é€šè¿‡å›è°ƒå‡½æ•°è¯·æ±‚çŠ¶æ€å˜æ›´ï¼Œä¸ç›´æ¥ä¿®æ”¹ propsï¼›</li>
<li><strong>ä¸å¯å˜æ›´æ–°</strong>ï¼šä½¿ç”¨ <code>filter</code>ã€<code>map</code>ã€å±•å¼€è¿ç®—ç¬¦ç­‰åˆ›å»ºæ–°æ•°ç»„/å¯¹è±¡ï¼›</li>
<li><strong>é€»è¾‘é›†ä¸­ç®¡ç†</strong>ï¼šçŠ¶æ€å˜æ›´é€»è¾‘é›†ä¸­åœ¨çˆ¶ç»„ä»¶ï¼Œä¾¿äºç»´æŠ¤å’Œè°ƒè¯•ï¼›</li>
<li><strong>å‰¯ä½œç”¨ç»Ÿä¸€å¤„ç†</strong>ï¼šå¦‚æœ¬åœ°å­˜å‚¨ï¼Œé€šè¿‡ <code>useEffect</code> é›†ä¸­ç›‘å¬çŠ¶æ€å˜åŒ–ã€‚</li>
</ul>
<p>è¿™ç§æ¶æ„è™½ç„¶çœ‹ä¼¼â€œç»•è¿œè·¯â€ï¼Œä½†æ­£æ˜¯ React å“åº”å¼ç¼–ç¨‹æ€æƒ³çš„ä½“ç°ï¼š<strong>çŠ¶æ€é©±åŠ¨è§†å›¾ï¼Œè§†å›¾è§¦å‘çŠ¶æ€å˜æ›´ï¼Œå½¢æˆé—­ç¯</strong>ã€‚å¯¹äºæ›´å¤æ‚çš„çŠ¶æ€ç®¡ç†éœ€æ±‚ï¼Œå¼€å‘è€…å¯ä»¥è¿›ä¸€æ­¥å¼•å…¥Zustandã€Redux ç­‰çŠ¶æ€åº“ï¼Œä½†å…¶æ ¸å¿ƒæ€æƒ³â€”â€”<strong>å•ä¸€æ•°æ®æºã€æ˜ç¡®çš„æ•°æ®æµ</strong>â€”â€”å§‹ç»ˆä¸å˜ã€‚</p>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼ŒåšæŒè¿™ç§æ¸…æ™°çš„é€šä¿¡æ¨¡å¼ï¼Œä¸ä»…èƒ½å‡å°‘ bugï¼Œè¿˜èƒ½æ˜¾è‘—æå‡å›¢é˜Ÿåä½œæ•ˆç‡ã€‚æ¯•ç«Ÿï¼Œå½“æ‰€æœ‰äººéƒ½ç†è§£â€œçŠ¶æ€ä»å“ªé‡Œæ¥ï¼Œåˆ°å“ªé‡Œå»â€æ—¶ï¼Œä»£ç å°±ä¸å†ç¥ç§˜ï¼Œç»´æŠ¤ä¹Ÿå°±å˜å¾—è½»æ¾ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI åº”ç”¨å¼€å‘ï¼šAgent @åœ¨çº¿æ–‡æ¡£åŠŸèƒ½ - å‰ç«¯äº¤äº’ä¸è®¾è®¡]]></title>    <link>https://juejin.cn/post/7586954475656871982</link>    <guid>https://juejin.cn/post/7586954475656871982</guid>    <pubDate>2025-12-24T03:30:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586954475656871982" data-draft-id="7573972055269687334" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI åº”ç”¨å¼€å‘ï¼šAgent @åœ¨çº¿æ–‡æ¡£åŠŸèƒ½ - å‰ç«¯äº¤äº’ä¸è®¾è®¡"/> <meta itemprop="keywords" content="å‰ç«¯,Agent,AIGC"/> <meta itemprop="datePublished" content="2025-12-24T03:30:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å’šå’šå’šddd"/> <meta itemprop="url" content="https://juejin.cn/user/1667322351722023"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI åº”ç”¨å¼€å‘ï¼šAgent @åœ¨çº¿æ–‡æ¡£åŠŸèƒ½ - å‰ç«¯äº¤äº’ä¸è®¾è®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1667322351722023/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å’šå’šå’šddd
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T03:30:03.000Z" title="Wed Dec 24 2025 03:30:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="androidstudio">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#a9b7c6;background:#282b2e}.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#6897bb}.hljs-deletion,.hljs-keyword,.hljs-selector-tag{color:#cc7832}.hljs-link,.hljs-template-variable,.hljs-variable{color:#629755}.hljs-comment,.hljs-quote{color:grey}.hljs-meta{color:#bbb529}.hljs-addition,.hljs-attribute,.hljs-string{color:#6a8759}.hljs-section,.hljs-title,.hljs-type{color:#ffc66d}.hljs-name,.hljs-selector-class,.hljs-selector-id{color:#e8bf6a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Agent @åœ¨çº¿æ–‡æ¡£åŠŸèƒ½ - å‰ç«¯äº¤äº’ä¸ä»£ç è®¾è®¡æ–¹æ¡ˆ</h2>
<h3 data-id="heading-1">ç›®å½•</h3>
<ul>
<li><a href="#%E5%8A%9F%E8%83%BD%E6%A6%82%E8%BF%B0" title="#%E5%8A%9F%E8%83%BD%E6%A6%82%E8%BF%B0">åŠŸèƒ½æ¦‚è¿°</a></li>
<li><a href="#%E5%89%8D%E7%AB%AF%E4%BA%A4%E4%BA%92%E8%AE%BE%E8%AE%A1" title="#%E5%89%8D%E7%AB%AF%E4%BA%A4%E4%BA%92%E8%AE%BE%E8%AE%A1">å‰ç«¯äº¤äº’è®¾è®¡</a></li>
<li><a href="#%E4%BB%A3%E7%A0%81%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1" title="#%E4%BB%A3%E7%A0%81%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1">ä»£ç æ¶æ„è®¾è®¡</a></li>
<li><a href="#%E6%A0%B8%E5%BF%83%E5%AE%9E%E7%8E%B0%E7%BB%86%E8%8A%82" title="#%E6%A0%B8%E5%BF%83%E5%AE%9E%E7%8E%B0%E7%BB%86%E8%8A%82">æ ¸å¿ƒå®ç°ç»†èŠ‚</a></li>
<li><a href="#%E5%8F%AF%E5%A4%8D%E7%94%A8%E6%80%A7%E8%AF%B4%E6%98%8E" title="#%E5%8F%AF%E5%A4%8D%E7%94%A8%E6%80%A7%E8%AF%B4%E6%98%8E">å¯å¤ç”¨æ€§è¯´æ˜</a></li>
<li><a href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5" title="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">æœ€ä½³å®è·µ</a></li>
</ul>
<hr/>
<h3 data-id="heading-2">åŠŸèƒ½æ¦‚è¿°</h3>
<p>Agent @åœ¨çº¿æ–‡æ¡£åŠŸèƒ½å…è®¸ç”¨æˆ·åœ¨è¾“å…¥æ¡†ä¸­é€šè¿‡è¾“å…¥ <code>@</code> ç¬¦å·è§¦å‘æ–‡ä»¶é€‰æ‹©ï¼Œä»çŸ¥è¯†åº“ä¸­é€‰æ‹©æ–‡ä»¶å¹¶é™„åŠ åˆ°æ¶ˆæ¯ä¸­ã€‚è¯¥åŠŸèƒ½é‡‡ç”¨ç»„ä»¶åŒ–è®¾è®¡ï¼Œå…·æœ‰è‰¯å¥½çš„å¯ç»´æŠ¤æ€§å’Œå¯å¤ç”¨æ€§ã€‚</p>
<h4 data-id="heading-3">æ ¸å¿ƒç‰¹æ€§</h4>
<ul>
<li>âœ… <code>@</code> ç¬¦å·è§¦å‘æ–‡ä»¶é€‰æ‹©æµ®çª—</li>
<li>âœ… å®æ—¶æœç´¢æ–‡ä»¶åˆ—è¡¨ï¼ˆé˜²æŠ–ä¼˜åŒ–ï¼‰</li>
<li>âœ… æ–‡ä»¶æ ‡ç­¾å±•ç¤ºä¸åˆ é™¤</li>
<li>âœ… æ™ºèƒ½å®šä½æµ®çª—ä½ç½®</li>
<li>âœ… éª¨æ¶å±åŠ è½½åŠ¨ç”»</li>
<li>âœ… å¹³æ»‘è¿‡æ¸¡åŠ¨ç”»</li>
</ul>
<hr/>
<h3 data-id="heading-4">å‰ç«¯äº¤äº’è®¾è®¡</h3>
<h4 data-id="heading-5">1. äº¤äº’æµç¨‹å›¾</h4>
<pre><code class="hljs language-md" lang="md">ç”¨æˆ·è¾“å…¥ @ ç¬¦å·
<span class="hljs-code">    â†“
æ£€æµ‹åˆ° @ ç¬¦å·
    â†“
æ˜¾ç¤ºæ–‡ä»¶é€‰æ‹©æµ®çª—ï¼ˆéª¨æ¶å±ï¼‰
    â†“
è¯·æ±‚æ–‡ä»¶åˆ—è¡¨ API
    â†“
ç”¨æˆ·ç»§ç»­è¾“å…¥ï¼ˆæœç´¢å…³é”®è¯ï¼‰
    â†“
é˜²æŠ–è¯·æ±‚ï¼ˆ300msï¼‰
    â†“
æ›´æ–°æ–‡ä»¶åˆ—è¡¨
    â†“
ç”¨æˆ·é€‰æ‹©æ–‡ä»¶
    â†“
æ’å…¥æ–‡ä»¶æ ‡ç­¾ï¼ˆç§»é™¤ @ åŠåç»­æ–‡æœ¬ï¼‰
    â†“
å…³é—­æµ®çª—
    â†“
å‘é€æ¶ˆæ¯æ—¶æºå¸¦ ref_docs
</span></code></pre>
<h4 data-id="heading-6">2. äº¤äº’çŠ¶æ€è®¾è®¡</h4>
<h5 data-id="heading-7">2.1 æµ®çª—æ˜¾ç¤ºçŠ¶æ€</h5>






























<table><thead><tr><th>çŠ¶æ€</th><th>æ¡ä»¶</th><th>UIè¡¨ç°</th></tr></thead><tbody><tr><td>åˆå§‹åŠ è½½</td><td><code>loading=true &amp;&amp; fileList.length=0</code></td><td>éª¨æ¶å±åŠ¨ç”»</td></tr><tr><td>æœ‰æ•°æ®åŠ è½½</td><td><code>loading=true &amp;&amp; fileList.length&gt;0</code></td><td>åˆ—è¡¨åŠé€æ˜ï¼ˆopacity-50ï¼‰</td></tr><tr><td>æ­£å¸¸æ˜¾ç¤º</td><td><code>loading=false &amp;&amp; fileList.length&gt;0</code></td><td>æ­£å¸¸æ˜¾ç¤ºæ–‡ä»¶åˆ—è¡¨</td></tr><tr><td>ç©ºçŠ¶æ€</td><td><code>loading=false &amp;&amp; fileList.length=0</code></td><td>æ˜¾ç¤º"æš‚æ— æ–‡ä»¶"</td></tr></tbody></table>
<h5 data-id="heading-8">2.2 æµ®çª—å®šä½é€»è¾‘</h5>
<pre><code class="hljs language-md" lang="md">@ ç¬¦å·ä½ç½®è®¡ç®—ï¼š
<span class="hljs-bullet">1.</span> è·å– textarea çš„ DOM ä½ç½®
<span class="hljs-bullet">2.</span> è®¡ç®— @ ç¬¦å·åœ¨æ–‡æœ¬ä¸­çš„è¡Œæ•°å’Œåˆ—æ•°
<span class="hljs-bullet">3.</span> ä½¿ç”¨ Canvas æµ‹é‡æ–‡æœ¬å®½åº¦ï¼ˆç²¾ç¡®ï¼‰
<span class="hljs-bullet">4.</span> è®¡ç®—æµ®çª— left ä½ç½® = paddingLeft + æ–‡æœ¬å®½åº¦ + 8px
<span class="hljs-bullet">5.</span> è¾¹ç•Œæ£€æŸ¥ï¼šç¡®ä¿ä¸è¶…å‡ºè¾“å…¥æ¡†å³ä¾§
</code></pre>
<h5 data-id="heading-9">2.3 è§¦å‘ä¸å…³é—­æ¡ä»¶</h5>
<p><strong>è§¦å‘æ¡ä»¶ï¼š</strong></p>
<ul>
<li>è¾“å…¥ <code>@</code> ç¬¦å·</li>
<li>å­˜åœ¨ <code>thread_group_id</code>ï¼ˆå·²å¼€å§‹å¯¹è¯ï¼‰</li>
<li><code>@</code> åæ— ç©ºæ ¼</li>
</ul>
<p><strong>å…³é—­æ¡ä»¶ï¼š</strong></p>
<ul>
<li><code>@</code> åè¾“å…¥ç©ºæ ¼</li>
<li>åˆ é™¤ <code>@</code> ç¬¦å·</li>
<li>ç‚¹å‡»æµ®çª—å¤–åŒºåŸŸ</li>
<li>é€‰æ‹©æ–‡ä»¶å</li>
<li>å‘é€æ¶ˆæ¯å</li>
</ul>
<h4 data-id="heading-10">3. ç”¨æˆ·ä½“éªŒä¼˜åŒ–</h4>
<h5 data-id="heading-11">3.1 é˜²æŠ–ä¼˜åŒ–</h5>
<ul>
<li>ä½¿ç”¨ <code>lodash.debounce</code>ï¼Œå»¶è¿Ÿ 300ms</li>
<li>é¿å…é¢‘ç¹è¯·æ±‚ï¼Œæå‡æ€§èƒ½</li>
</ul>
<h5 data-id="heading-12">3.2 åŠ¨ç”»ä¼˜åŒ–</h5>
<ul>
<li>ä½¿ç”¨ Vue <code>&lt;Transition&gt;</code> ç»„ä»¶</li>
<li>å»¶è¿Ÿæ¸…ç©ºæ•°æ®ï¼ˆ300msï¼‰ï¼Œé¿å…åŠ¨ç”»é—ªçƒ</li>
<li>éª¨æ¶å±å¹³æ»‘åŠ è½½åŠ¨ç”»</li>
</ul>
<h5 data-id="heading-13">3.3 è§†è§‰åé¦ˆ</h5>
<ul>
<li>æ–‡ä»¶æ ‡ç­¾ hover æ•ˆæœ</li>
<li>åˆ é™¤æŒ‰é’® hover é«˜äº®</li>
<li>æµ®çª—åˆ—è¡¨é¡¹ hover èƒŒæ™¯å˜åŒ–</li>
</ul>
<hr/>
<h3 data-id="heading-14">ä»£ç æ¶æ„è®¾è®¡</h3>
<h4 data-id="heading-15">1. æ¶æ„åˆ†å±‚</h4>
<pre><code class="hljs language-md" lang="md">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      SearchInput.vue (å®¹å™¨ç»„ä»¶)      â”‚
â”‚  - é›†æˆ FileTagList                 â”‚
â”‚  - é›†æˆ FileDropdown                â”‚
â”‚  - ä½¿ç”¨ useFileMention composable   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<span class="hljs-code">              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   useFileMention.ts (ä¸šåŠ¡é€»è¾‘å±‚)     â”‚
â”‚  - çŠ¶æ€ç®¡ç†                          â”‚
â”‚  - API è°ƒç”¨                          â”‚
â”‚  - äº‹ä»¶å¤„ç†                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FileTagList.vue (å±•ç¤ºç»„ä»¶)         â”‚
â”‚   FileDropdown.vue (äº¤äº’ç»„ä»¶)        â”‚
â”‚   utils/common.ts (å·¥å…·å‡½æ•°)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></code></pre>
<h4 data-id="heading-16">2. ç»„ä»¶èŒè´£åˆ’åˆ†</h4>
<h5 data-id="heading-17">2.1 <code>useFileMention</code> Composable</h5>
<p><strong>èŒè´£ï¼š</strong> å°è£…æ‰€æœ‰æ–‡ä»¶ @ ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘</p>
<p><strong>çŠ¶æ€ç®¡ç†ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript">- <span class="hljs-attr">showFileDropdown</span>: æµ®çª—æ˜¾ç¤ºçŠ¶æ€
- <span class="hljs-attr">selectedFiles</span>: å·²é€‰æ–‡ä»¶åˆ—è¡¨
- <span class="hljs-attr">fileList</span>: æ–‡ä»¶åˆ—è¡¨æ•°æ®
- <span class="hljs-attr">isLoadingFiles</span>: åŠ è½½çŠ¶æ€
- <span class="hljs-attr">dropdownPosition</span>: æµ®çª—ä½ç½®
- <span class="hljs-attr">atSymbolIndex</span>: @ ç¬¦å·ä½ç½®ç´¢å¼•
</code></pre>
<p><strong>æ ¸å¿ƒæ–¹æ³•ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript">- <span class="hljs-title function_">handleInputChange</span>(): å¤„ç†è¾“å…¥å˜åŒ–ï¼Œæ£€æµ‹ @ ç¬¦å·
- <span class="hljs-title function_">fetchFileList</span>(): è·å–æ–‡ä»¶åˆ—è¡¨
- <span class="hljs-title function_">updateDropdownPosition</span>(): æ›´æ–°æµ®çª—ä½ç½®
- <span class="hljs-title function_">selectFile</span>(): é€‰æ‹©æ–‡ä»¶
- <span class="hljs-title function_">removeFile</span>(): åˆ é™¤æ–‡ä»¶
- <span class="hljs-title function_">closeDropdown</span>(): å…³é—­æµ®çª—
- <span class="hljs-title function_">getSelectedFiles</span>(): è·å–å·²é€‰æ–‡ä»¶
- <span class="hljs-title function_">clearSelectedFiles</span>(): æ¸…ç©ºå·²é€‰æ–‡ä»¶
- <span class="hljs-title function_">cleanup</span>(): æ¸…ç†èµ„æº
</code></pre>
<h5 data-id="heading-18">2.2 <code>FileTagList</code> ç»„ä»¶</h5>
<p><strong>èŒè´£ï¼š</strong> å±•ç¤ºå·²é€‰æ–‡ä»¶æ ‡ç­¾</p>
<p><strong>Propsï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-attr">files</span>: <span class="hljs-built_in">string</span>[]  <span class="hljs-comment">// æ–‡ä»¶åˆ—è¡¨</span>
</code></pre>
<p><strong>Eventsï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-attr">remove</span>: <span class="hljs-function">(<span class="hljs-params">file: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>  <span class="hljs-comment">// åˆ é™¤æ–‡ä»¶</span>
</code></pre>
<p><strong>ç‰¹æ€§ï¼š</strong></p>
<ul>
<li>è‡ªåŠ¨æ¢è¡Œå¸ƒå±€</li>
<li>æ–‡ä»¶å›¾æ ‡æ˜¾ç¤º</li>
<li>åˆ é™¤äº¤äº’</li>
</ul>
<h5 data-id="heading-19">2.3 <code>FileDropdown</code> ç»„ä»¶</h5>
<p><strong>èŒè´£ï¼š</strong> æ–‡ä»¶é€‰æ‹©æµ®çª—</p>
<p><strong>Propsï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-attr">visible</span>: <span class="hljs-built_in">boolean</span>              <span class="hljs-comment">// æ˜¾ç¤ºçŠ¶æ€</span>
<span class="hljs-attr">position</span>: { <span class="hljs-attr">left</span>: <span class="hljs-built_in">number</span> }    <span class="hljs-comment">// ä½ç½®</span>
<span class="hljs-attr">fileList</span>: <span class="hljs-built_in">string</span>[]            <span class="hljs-comment">// æ–‡ä»¶åˆ—è¡¨</span>
<span class="hljs-attr">loading</span>: <span class="hljs-built_in">boolean</span>              <span class="hljs-comment">// åŠ è½½çŠ¶æ€</span>
</code></pre>
<p><strong>Eventsï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-attr">select</span>: <span class="hljs-function">(<span class="hljs-params">file: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>  <span class="hljs-comment">// é€‰æ‹©æ–‡ä»¶</span>
</code></pre>
<p><strong>ç‰¹æ€§ï¼š</strong></p>
<ul>
<li>éª¨æ¶å±åŠ è½½</li>
<li>ç©ºçŠ¶æ€æç¤º</li>
<li>è¿‡æ¸¡åŠ¨ç”»</li>
<li>åˆ—è¡¨æ»šåŠ¨</li>
</ul>
<h5 data-id="heading-20">2.4 <code>getFileIcon</code> å·¥å…·å‡½æ•°</h5>
<p><strong>èŒè´£ï¼š</strong> æ ¹æ®æ–‡ä»¶æ‰©å±•åè¿”å›å¯¹åº”å›¾æ ‡</p>
<p><strong>æ”¯æŒæ ¼å¼ï¼š</strong></p>
<ul>
<li>PDF: <code>file-pdf.svg</code></li>
<li>Word: <code>file-word.svg</code> (doc, docx)</li>
<li>Text: <code>file-text.svg</code> (txt, md)</li>
<li>Default: <code>file.svg</code></li>
</ul>
<hr/>
<h3 data-id="heading-21">æ ¸å¿ƒå®ç°ç»†èŠ‚</h3>
<h4 data-id="heading-22">1. @ ç¬¦å·æ£€æµ‹ä¸å¤„ç†</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">handleInputChange</span> = (<span class="hljs-params">value: <span class="hljs-built_in">string</span>, cursorPos?: <span class="hljs-built_in">number</span></span>) =&gt; {
  <span class="hljs-keyword">const</span> actualCursorPos = cursorPos ?? (textareaRef.<span class="hljs-property">value</span>?.<span class="hljs-property">$el</span>?.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'textarea'</span>)?.<span class="hljs-property">selectionStart</span> ?? value.<span class="hljs-property">length</span>)
  <span class="hljs-keyword">const</span> textBeforeCursor = value.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, actualCursorPos)
  <span class="hljs-keyword">const</span> lastAtIndex = textBeforeCursor.<span class="hljs-title function_">lastIndexOf</span>(<span class="hljs-string">'@'</span>)
  
  <span class="hljs-comment">// æ£€æŸ¥ @ ç¬¦å·åæ˜¯å¦æœ‰ç©ºæ ¼</span>
  <span class="hljs-keyword">if</span> (lastAtIndex &gt;= <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">const</span> textAfterAt = textBeforeCursor.<span class="hljs-title function_">substring</span>(lastAtIndex + <span class="hljs-number">1</span>)
    <span class="hljs-keyword">if</span> (textAfterAt.<span class="hljs-title function_">includes</span>(<span class="hljs-string">' '</span>)) {
      <span class="hljs-title function_">closeDropdown</span>()
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// æ˜¾ç¤ºæµ®çª—å¹¶è¯·æ±‚æ–‡ä»¶åˆ—è¡¨</span>
      atSymbolIndex.<span class="hljs-property">value</span> = lastAtIndex
      <span class="hljs-keyword">const</span> searchKeyword = textAfterAt.<span class="hljs-title function_">trim</span>()
      <span class="hljs-title function_">updateDropdownPosition</span>()
      showFileDropdown.<span class="hljs-property">value</span> = <span class="hljs-literal">true</span>
      <span class="hljs-title function_">debouncedFetchFileList</span>(searchKeyword)
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">closeDropdown</span>()
  }
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨ <code>lastIndexOf</code> æ‰¾åˆ°æœ€åä¸€ä¸ª <code>@</code> ç¬¦å·</li>
<li>æ£€æŸ¥ <code>@</code> åæ˜¯å¦æœ‰ç©ºæ ¼æ¥å†³å®šæ˜¯å¦å…³é—­æµ®çª—</li>
<li>ä½¿ç”¨é˜²æŠ–å‡½æ•°é¿å…é¢‘ç¹è¯·æ±‚</li>
</ul>
<h4 data-id="heading-23">2. æµ®çª—ä½ç½®è®¡ç®—</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">updateDropdownPosition</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-title function_">nextTick</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> textarea = textareaRef.<span class="hljs-property">value</span>?.<span class="hljs-property">$el</span>?.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'textarea'</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLTextAreaElement</span>
    <span class="hljs-keyword">if</span> (!textarea) <span class="hljs-keyword">return</span>

    <span class="hljs-keyword">const</span> cursorPos = textarea.<span class="hljs-property">selectionStart</span>
    <span class="hljs-keyword">const</span> textBeforeCursor = searchText.<span class="hljs-property">value</span>.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, cursorPos)
    <span class="hljs-keyword">const</span> lastAtIndex = textBeforeCursor.<span class="hljs-title function_">lastIndexOf</span>(<span class="hljs-string">'@'</span>)
    
    <span class="hljs-keyword">if</span> (lastAtIndex &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>

    <span class="hljs-comment">// è®¡ç®— @ ç¬¦å·åœ¨æ–‡æœ¬ä¸­çš„ä½ç½®</span>
    <span class="hljs-keyword">const</span> textareaRect = textarea.<span class="hljs-title function_">getBoundingClientRect</span>()
    <span class="hljs-keyword">const</span> style = <span class="hljs-title function_">getComputedStyle</span>(textarea)
    <span class="hljs-keyword">const</span> paddingLeft = <span class="hljs-built_in">parseFloat</span>(style.<span class="hljs-property">paddingLeft</span>) || <span class="hljs-number">20</span>
    
    <span class="hljs-comment">// è®¡ç®—è¡Œæ•°å’Œåˆ—æ•°</span>
    <span class="hljs-keyword">const</span> textBeforeAt = searchText.<span class="hljs-property">value</span>.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, lastAtIndex)
    <span class="hljs-keyword">const</span> lines = textBeforeAt.<span class="hljs-title function_">split</span>(<span class="hljs-string">'\n'</span>)
    <span class="hljs-keyword">const</span> lastLine = lines[lines.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]
    
    <span class="hljs-comment">// ä½¿ç”¨ canvas æµ‹é‡æ–‡æœ¬å®½åº¦ï¼ˆæ›´å‡†ç¡®ï¼‰</span>
    <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'canvas'</span>)
    <span class="hljs-keyword">const</span> context = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>)
    
    <span class="hljs-keyword">let</span> left = <span class="hljs-number">0</span>
    <span class="hljs-keyword">if</span> (context) {
      context.<span class="hljs-property">font</span> = <span class="hljs-string">`<span class="hljs-subst">${style.fontSize}</span> <span class="hljs-subst">${style.fontFamily}</span>`</span>
      <span class="hljs-keyword">const</span> textWidth = context.<span class="hljs-title function_">measureText</span>(lastLine).<span class="hljs-property">width</span>
      left = paddingLeft + textWidth + <span class="hljs-number">8</span>  <span class="hljs-comment">// @ ç¬¦å·å³ä¾§ä½ç½®</span>
    }
    
    <span class="hljs-comment">// è¾¹ç•Œæ£€æŸ¥</span>
    <span class="hljs-keyword">const</span> maxLeft = textareaRect.<span class="hljs-property">width</span> - <span class="hljs-number">280</span>
    <span class="hljs-keyword">if</span> (left &gt; maxLeft) {
      left = maxLeft
    }
    
    dropdownPosition.<span class="hljs-property">value</span> = { left }
  })
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨ <code>Canvas.measureText()</code> ç²¾ç¡®æµ‹é‡æ–‡æœ¬å®½åº¦</li>
<li>è€ƒè™‘å¤šè¡Œæ–‡æœ¬çš„æƒ…å†µ</li>
<li>è¾¹ç•Œæ£€æŸ¥é˜²æ­¢æµ®çª—è¶…å‡ºè¾“å…¥æ¡†</li>
</ul>
<h4 data-id="heading-24">3. æ–‡ä»¶é€‰æ‹©ä¸æ–‡æœ¬æ›¿æ¢</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">selectFile</span> = (<span class="hljs-params">fileName: <span class="hljs-built_in">string</span></span>) =&gt; {
  <span class="hljs-keyword">if</span> (selectedFiles.<span class="hljs-property">value</span>.<span class="hljs-title function_">includes</span>(fileName)) {
    <span class="hljs-keyword">return</span>
  }
  
  selectedFiles.<span class="hljs-property">value</span>.<span class="hljs-title function_">push</span>(fileName)
  
  <span class="hljs-comment">// ç§»é™¤ @ ç¬¦å·åŠåç»­æ–‡æœ¬</span>
  <span class="hljs-keyword">if</span> (atSymbolIndex.<span class="hljs-property">value</span> &gt;= <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">const</span> textBeforeAt = searchText.<span class="hljs-property">value</span>.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, atSymbolIndex.<span class="hljs-property">value</span>)
    <span class="hljs-keyword">const</span> textAfterAt = searchText.<span class="hljs-property">value</span>.<span class="hljs-title function_">substring</span>(atSymbolIndex.<span class="hljs-property">value</span>)
    <span class="hljs-keyword">const</span> spaceIndex = textAfterAt.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">' '</span>)
    <span class="hljs-keyword">const</span> remainingText = spaceIndex &gt; <span class="hljs-number">0</span> ? textAfterAt.<span class="hljs-title function_">substring</span>(spaceIndex) : <span class="hljs-string">''</span>
    
    <span class="hljs-keyword">const</span> newText = textBeforeAt + remainingText
    
    <span class="hljs-comment">// æ›´æ–°æ–‡æœ¬</span>
    <span class="hljs-keyword">if</span> (onTextUpdate) {
      <span class="hljs-title function_">onTextUpdate</span>(newText)
    } <span class="hljs-keyword">else</span> {
      searchText.<span class="hljs-property">value</span> = newText
    }
    
    <span class="hljs-comment">// å…³é—­æµ®çª—å¹¶è®¾ç½®å…‰æ ‡ä½ç½®</span>
    <span class="hljs-title function_">closeDropdown</span>()
    <span class="hljs-title function_">nextTick</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">const</span> textarea = textareaRef.<span class="hljs-property">value</span>?.<span class="hljs-property">$el</span>?.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'textarea'</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLTextAreaElement</span>
      <span class="hljs-keyword">if</span> (textarea) {
        <span class="hljs-keyword">const</span> newCursorPos = textBeforeAt.<span class="hljs-property">length</span>
        textarea.<span class="hljs-title function_">focus</span>()
        textarea.<span class="hljs-title function_">setSelectionRange</span>(newCursorPos, newCursorPos)
      }
    })
  }
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>ç§»é™¤ <code>@</code> ç¬¦å·åŠåç»­æ–‡æœ¬ï¼ˆç›´åˆ°ç©ºæ ¼ï¼‰</li>
<li>ä¿ç•™ç©ºæ ¼åçš„æ–‡æœ¬</li>
<li>é€‰æ‹©æ–‡ä»¶åè‡ªåŠ¨èšç„¦å¹¶è®¾ç½®å…‰æ ‡ä½ç½®</li>
</ul>
<h4 data-id="heading-25">4. éª¨æ¶å±åŠ è½½ä¼˜åŒ–</h4>
<pre><code class="hljs language-jsx" lang="jsx">&lt;!-- åŠ è½½ä¸­éª¨æ¶å± --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"loading &amp;&amp; fileList.length === 0"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"file-dropdown-skeleton"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"i in 3"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"i"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"skeleton-item"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"skeleton-icon"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"skeleton-text"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>

&lt;!-- æœ‰æ•°æ®æ—¶åŠ è½½ --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-else</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"file-dropdown-list"</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ 'opacity-50': loading }"</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- æ–‡ä»¶åˆ—è¡¨ --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>é¦–æ¬¡åŠ è½½æ˜¾ç¤ºéª¨æ¶å±ï¼ˆ<code>fileList.length === 0</code>ï¼‰</li>
<li>æœ‰æ•°æ®æ—¶åŠ è½½æ˜¾ç¤ºåŠé€æ˜ï¼ˆ<code>opacity-50</code>ï¼‰</li>
<li>é¿å…æ•°æ®é—ªçƒ</li>
</ul>
<h4 data-id="heading-26">5. å»¶è¿Ÿæ¸…ç†æ•°æ®</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">closeDropdown</span> = (<span class="hljs-params"/>) =&gt; {
  showFileDropdown.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>
  atSymbolIndex.<span class="hljs-property">value</span> = -<span class="hljs-number">1</span>
  <span class="hljs-comment">// å»¶è¿Ÿæ¸…ç©ºæ•°æ®ï¼Œé¿å…åŠ¨ç”»è¿‡ç¨‹ä¸­å†…å®¹çªç„¶æ¶ˆå¤±</span>
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (!showFileDropdown.<span class="hljs-property">value</span>) {
      fileList.<span class="hljs-property">value</span> = []
    }
  }, <span class="hljs-number">300</span>)
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>å»¶è¿Ÿ 300ms æ¸…ç©ºæ•°æ®ï¼ˆä¸åŠ¨ç”»æ—¶é•¿ä¸€è‡´ï¼‰</li>
<li>æ£€æŸ¥æµ®çª—çŠ¶æ€ï¼Œé¿å…é‡å¤æ¸…ç©º</li>
</ul>
<hr/>
<h3 data-id="heading-27">å¯å¤ç”¨æ€§è¯´æ˜</h3>
<h4 data-id="heading-28">1. Composable è®¾è®¡æ¨¡å¼</h4>
<p><code>useFileMention</code> é‡‡ç”¨ Vue 3 Composition API è®¾è®¡ï¼Œå…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>è§£è€¦ä¸šåŠ¡é€»è¾‘</strong>ï¼šå°†æ–‡ä»¶ @ åŠŸèƒ½ä»ç»„ä»¶ä¸­æŠ½ç¦»</li>
<li><strong>æ˜“äºæµ‹è¯•</strong>ï¼šçº¯å‡½æ•°é€»è¾‘ï¼Œä¾¿äºå•å…ƒæµ‹è¯•</li>
<li><strong>å¯å¤ç”¨</strong>ï¼šå¯åœ¨ä»»ä½•éœ€è¦æ–‡ä»¶ @ åŠŸèƒ½çš„ç»„ä»¶ä¸­ä½¿ç”¨</li>
</ul>
<p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> fileMention = <span class="hljs-title function_">useFileMention</span>({
  textareaRef,
  searchText,
  <span class="hljs-attr">getThreadGroupId</span>: <span class="hljs-function">() =&gt;</span> store.<span class="hljs-property">threadGroupId</span>,
  <span class="hljs-attr">onTextUpdate</span>: <span class="hljs-function">(<span class="hljs-params">newText: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
    searchText.<span class="hljs-property">value</span> = newText
  }
})
</code></pre>
<h4 data-id="heading-29">2. ç»„ä»¶åŒ–è®¾è®¡</h4>
<h5 data-id="heading-30">FileTagList ç»„ä»¶</h5>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> ä»»ä½•éœ€è¦å±•ç¤ºæ–‡ä»¶æ ‡ç­¾åˆ—è¡¨çš„åœ°æ–¹</p>
<p><strong>æ‰©å±•æ€§ï¼š</strong></p>
<ul>
<li>å¯æ·»åŠ æ›´å¤šäº¤äº’ï¼ˆå¦‚æ‹–æ‹½æ’åºï¼‰</li>
<li>å¯è‡ªå®šä¹‰æ ·å¼ï¼ˆé€šè¿‡ props æˆ–æ’æ§½ï¼‰</li>
<li>å¯æ·»åŠ æ–‡ä»¶é¢„è§ˆåŠŸèƒ½</li>
</ul>
<h5 data-id="heading-31">FileDropdown ç»„ä»¶</h5>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> ä»»ä½•éœ€è¦æ–‡ä»¶é€‰æ‹©ä¸‹æ‹‰æ¡†çš„åœ°æ–¹</p>
<p><strong>æ‰©å±•æ€§ï¼š</strong></p>
<ul>
<li>å¯æ·»åŠ æ–‡ä»¶æœç´¢é«˜äº®</li>
<li>å¯æ·»åŠ æ–‡ä»¶åˆ†ç±»ç­›é€‰</li>
<li>å¯æ·»åŠ æ–‡ä»¶é¢„è§ˆåŠŸèƒ½</li>
</ul>
<h4 data-id="heading-32">3. å·¥å…·å‡½æ•°å¤ç”¨</h4>
<p><code>getFileIcon</code> å‡½æ•°å¯åœ¨æ•´ä¸ªé¡¹ç›®ä¸­å¤ç”¨ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { getFileIcon } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/common'</span>

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> icon = <span class="hljs-title function_">getFileIcon</span>(<span class="hljs-string">'document.pdf'</span>)  <span class="hljs-comment">// è¿”å› PDF å›¾æ ‡è·¯å¾„</span>
</code></pre>
<p><strong>æ‰©å±•æ€§ï¼š</strong></p>
<ul>
<li>å¯æ·»åŠ æ›´å¤šæ–‡ä»¶ç±»å‹æ”¯æŒ</li>
<li>å¯æ”¯æŒè‡ªå®šä¹‰å›¾æ ‡æ˜ å°„</li>
<li>å¯æ”¯æŒå›¾æ ‡ç¼“å­˜</li>
</ul>
<h4 data-id="heading-33">4. API æ¥å£è®¾è®¡</h4>
<p>æ–‡ä»¶åˆ—è¡¨æ¥å£è®¾è®¡ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-variable constant_">GET</span> /thread_group/{thread_group_id}/citations?title={title}
</code></pre>
<p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>thread_group_id</code>: ä¼šè¯ç»„ IDï¼ˆå¿…éœ€ï¼‰</li>
<li><code>title</code>: æœç´¢å…³é”®è¯ï¼ˆå¯é€‰ï¼‰</li>
</ul>
<p><strong>å“åº”æ ¼å¼ï¼š</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Success"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"ref_docs"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"file1.pdf"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"file2.docx"</span><span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-34">5. çŠ¶æ€ç®¡ç†é›†æˆ</h4>
<p>ä¸ Pinia Store é›†æˆï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> searchResultStore = <span class="hljs-title function_">useMetaSearchResultStore</span>()
<span class="hljs-keyword">const</span> threadGroupId = <span class="hljs-title function_">getThreadGroupId</span>() || searchResultStore.<span class="hljs-property">currTreadGroupId</span>
</code></pre>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>è‡ªåŠ¨è·å–å½“å‰ä¼šè¯ ID</li>
<li>çŠ¶æ€é›†ä¸­ç®¡ç†</li>
<li>æ˜“äºè°ƒè¯•</li>
</ul>
<hr/>
<h3 data-id="heading-35">æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-36">1. æ€§èƒ½ä¼˜åŒ–</h4>
<ul>
<li>âœ… <strong>é˜²æŠ–å¤„ç†</strong>ï¼šä½¿ç”¨ <code>lodash.debounce</code> é¿å…é¢‘ç¹è¯·æ±‚</li>
<li>âœ… <strong>å»¶è¿Ÿæ¸…ç†</strong>ï¼šå»¶è¿Ÿæ¸…ç©ºæ•°æ®ï¼Œé¿å…åŠ¨ç”»é—ªçƒ</li>
<li>âœ… <strong>æ¡ä»¶æ¸²æŸ“</strong>ï¼šä½¿ç”¨ <code>v-if</code> è€Œé <code>v-show</code> å‡å°‘ DOM èŠ‚ç‚¹</li>
<li>âœ… <strong>éª¨æ¶å±</strong>ï¼šé¦–æ¬¡åŠ è½½æ˜¾ç¤ºéª¨æ¶å±ï¼Œæå‡ç”¨æˆ·ä½“éªŒ</li>
</ul>
<h4 data-id="heading-37">2. ç”¨æˆ·ä½“éªŒ</h4>
<ul>
<li>âœ… <strong>è§†è§‰åé¦ˆ</strong>ï¼šhover æ•ˆæœã€åŠ è½½çŠ¶æ€ã€ç©ºçŠ¶æ€æç¤º</li>
<li>âœ… <strong>å¹³æ»‘åŠ¨ç”»</strong>ï¼šä½¿ç”¨ Vue Transition ç»„ä»¶</li>
<li>âœ… <strong>æ™ºèƒ½å®šä½</strong>ï¼šæµ®çª—ä½ç½®è·Ÿéš @ ç¬¦å·</li>
<li>âœ… <strong>è¾¹ç•Œå¤„ç†</strong>ï¼šé˜²æ­¢æµ®çª—è¶…å‡ºå¯è§†åŒºåŸŸ</li>
</ul>
<h4 data-id="heading-38">3. ä»£ç è´¨é‡</h4>
<ul>
<li>âœ… <strong>ç±»å‹å®‰å…¨</strong>ï¼šä½¿ç”¨ TypeScript å®šä¹‰æ¥å£</li>
<li>âœ… <strong>èŒè´£åˆ†ç¦»</strong>ï¼šComposableã€ç»„ä»¶ã€å·¥å…·å‡½æ•°å„å¸å…¶èŒ</li>
<li>âœ… <strong>é”™è¯¯å¤„ç†</strong>ï¼šAPI è¯·æ±‚é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º</li>
<li>âœ… <strong>èµ„æºæ¸…ç†</strong>ï¼šç»„ä»¶å¸è½½æ—¶æ¸…ç†é˜²æŠ–å‡½æ•°</li>
</ul>
<h4 data-id="heading-39">4. å¯ç»´æŠ¤æ€§</h4>
<ul>
<li>âœ… <strong>å•ä¸€èŒè´£</strong>ï¼šæ¯ä¸ªç»„ä»¶/å‡½æ•°åªåšä¸€ä»¶äº‹</li>
<li>âœ… <strong>å‘½åè§„èŒƒ</strong>ï¼šæ¸…æ™°çš„å˜é‡å’Œå‡½æ•°å‘½å</li>
<li>âœ… <strong>æ³¨é‡Šæ–‡æ¡£</strong>ï¼šå…³é”®é€»è¾‘æ·»åŠ æ³¨é‡Š</li>
<li>âœ… <strong>ä»£ç å¤ç”¨</strong>ï¼šæŠ½å–å…¬å…±é€»è¾‘åˆ° composable å’Œå·¥å…·å‡½æ•°</li>
</ul>
<h4 data-id="heading-40">5. æ‰©å±•å»ºè®®</h4>
<p><strong>æœªæ¥å¯æ‰©å±•åŠŸèƒ½ï¼š</strong></p>
<ol>
<li>
<p><strong>æ–‡ä»¶é¢„è§ˆ</strong></p>
<ul>
<li>ç‚¹å‡»æ–‡ä»¶æ ‡ç­¾é¢„è§ˆæ–‡ä»¶å†…å®¹</li>
<li>æµ®çª—ä¸­æ˜¾ç¤ºæ–‡ä»¶æ‘˜è¦</li>
</ul>
</li>
<li>
<p><strong>æ–‡ä»¶åˆ†ç±»</strong></p>
<ul>
<li>æŒ‰æ–‡ä»¶ç±»å‹åˆ†ç»„æ˜¾ç¤º</li>
<li>æ·»åŠ åˆ†ç±»ç­›é€‰åŠŸèƒ½</li>
</ul>
</li>
<li>
<p><strong>æœç´¢é«˜äº®</strong></p>
<ul>
<li>é«˜äº®æ˜¾ç¤ºåŒ¹é…çš„æ–‡æœ¬</li>
<li>æ”¯æŒæ¨¡ç³ŠåŒ¹é…</li>
</ul>
</li>
<li>
<p><strong>æ‰¹é‡æ“ä½œ</strong></p>
<ul>
<li>æ”¯æŒæ‰¹é‡é€‰æ‹©æ–‡ä»¶</li>
<li>æ”¯æŒæ‹–æ‹½æ’åº</li>
</ul>
</li>
<li>
<p><strong>å†å²è®°å½•</strong></p>
<ul>
<li>è®°å½•æœ€è¿‘ä½¿ç”¨çš„æ–‡ä»¶</li>
<li>å¿«é€Ÿé€‰æ‹©å†å²æ–‡ä»¶</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-41">æ€»ç»“</h3>
<p>Agent @åœ¨çº¿æ–‡æ¡£åŠŸèƒ½é‡‡ç”¨<strong>ç»„ä»¶åŒ– + Composable</strong> çš„æ¶æ„è®¾è®¡ï¼Œå®ç°äº†ï¼š</p>
<ul>
<li>âœ… <strong>æ¸…æ™°çš„èŒè´£åˆ’åˆ†</strong>ï¼šä¸šåŠ¡é€»è¾‘ã€UI ç»„ä»¶ã€å·¥å…·å‡½æ•°åˆ†ç¦»</li>
<li>âœ… <strong>è‰¯å¥½çš„å¯å¤ç”¨æ€§</strong>ï¼šå¯åœ¨å…¶ä»–é¡¹ç›®ä¸­å¿«é€Ÿå¤ç”¨</li>
<li>âœ… <strong>ä¼˜ç§€çš„ç”¨æˆ·ä½“éªŒ</strong>ï¼šæµç•…çš„åŠ¨ç”»ã€æ™ºèƒ½çš„å®šä½ã€å®Œå–„çš„åé¦ˆ</li>
<li>âœ… <strong>æ˜“äºç»´æŠ¤æ‰©å±•</strong>ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œä¾¿äºåç»­åŠŸèƒ½æ‰©å±•</li>
</ul>
<p>è¯¥è®¾è®¡æ–¹æ¡ˆå¯ä½œä¸ºç±»ä¼¼åŠŸèƒ½çš„å‚è€ƒæ¨¡æ¿ï¼Œé€‚ç”¨äºä»»ä½•éœ€è¦"@æåŠ"åŠŸèƒ½çš„åœºæ™¯ã€‚</p>
<hr/>
<h3 data-id="heading-42">ç›¸å…³æ–‡ä»¶</h3>
<ul>
<li><code>composables/ai-search/useFileMention.ts</code> - ä¸šåŠ¡é€»è¾‘å±‚</li>
<li><code>components/ai-search/FileTagList.vue</code> - æ–‡ä»¶æ ‡ç­¾ç»„ä»¶</li>
<li><code>components/ai-search/FileDropdown.vue</code> - æ–‡ä»¶é€‰æ‹©ä¸‹æ‹‰æ¡†ç»„ä»¶</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2-2-7 å¿«é€ŸæŒæ¡Kotlin-æ³›å‹ç±»å‹çº¦æŸ]]></title>    <link>https://juejin.cn/post/7586971886590050347</link>    <guid>https://juejin.cn/post/7586971886590050347</guid>    <pubDate>2025-12-24T02:38:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586971886590050347" data-draft-id="7586994471738277931" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2-2-7 å¿«é€ŸæŒæ¡Kotlin-æ³›å‹ç±»å‹çº¦æŸ"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-12-24T02:38:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å®‰å“è€ç‹"/> <meta itemprop="url" content="https://juejin.cn/user/289926799429805"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2-2-7 å¿«é€ŸæŒæ¡Kotlin-æ³›å‹ç±»å‹çº¦æŸ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/289926799429805/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å®‰å“è€ç‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T02:38:53.000Z" title="Wed Dec 24 2025 02:38:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸŒŸ Kotlinæ³›å‹ç±»å‹çº¦æŸï¼šè®©ä»£ç æ›´å®‰å…¨ã€æ›´ä¼˜é›…ï¼</h2>
<p>å˜¿ï¼Œçœ‹åˆ°ä½ å¯¹Kotlinæ³›å‹ç±»å‹çº¦æŸæ„Ÿå…´è¶£ï¼Œå¤ªæ£’äº†ï¼è¿™å¯æ˜¯Kotlinä¸­è®©ä»£ç æ—¢å®‰å…¨åˆçµæ´»çš„"é­”æ³•"ä¹‹ä¸€ï¼Œèƒ½è®©ä½ çš„ä»£ç åœ¨ç¼–è¯‘æ—¶å°±é¿å…å¾ˆå¤šç±»å‹é”™è¯¯ï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒè¿è¡Œæ—¶çš„<code>ClassCastException</code>å•¦ï½ ğŸ˜„</p>
<h3 data-id="heading-1">ğŸ“Œ ä»€ä¹ˆæ˜¯æ³›å‹ç±»å‹çº¦æŸï¼Ÿ</h3>
<p>æ³›å‹ç±»å‹çº¦æŸå°±æ˜¯<strong>ä¸ºæ³›å‹å‚æ•°è®¾ç½®é™åˆ¶æ¡ä»¶</strong>ï¼Œç¡®ä¿ä¼ å…¥çš„ç±»å‹æ»¡è¶³ç‰¹å®šè¦æ±‚ã€‚å°±åƒç»™æ³›å‹å‚æ•°åŠ äº†ä¸ª"å®‰å…¨å¸½"ï¼Œç¡®ä¿å®ƒä¸ä¼šæ˜¯"ä¸åˆé€‚çš„ç±»å‹"ã€‚</p>
<p>åœ¨Kotlinä¸­ï¼Œæ³›å‹çº¦æŸä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼š</p>
<ol>
<li><strong>ä¸Šé™çº¦æŸ</strong>ï¼š<code>&lt;T : UpperType&gt;</code> - é™åˆ¶ç±»å‹å¿…é¡»æ˜¯<code>UpperType</code>æˆ–å…¶å­ç±»</li>
<li><strong>ä¸‹é™çº¦æŸ</strong>ï¼š<code>&lt;in LowerType&gt;</code> - é™åˆ¶ç±»å‹å¿…é¡»æ˜¯<code>LowerType</code>æˆ–å…¶çˆ¶ç±»</li>
</ol>
<h3 data-id="heading-2">ğŸ”¥ ä¸Šé™çº¦æŸï¼šè®©ç±»å‹"æœ‰ä¸Šé™"</h3>
<h4 data-id="heading-3">ä»€ä¹ˆæ˜¯ä¸Šé™çº¦æŸï¼Ÿ</h4>
<p>ä¸Šé™çº¦æŸç”¨äº<strong>é™åˆ¶ç±»å‹å‚æ•°å¿…é¡»æ˜¯æŸä¸ªç±»çš„å­ç±»</strong>ï¼ˆåŒ…æ‹¬è¯¥ç±»æœ¬èº«ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨æ³›å‹ä»£ç ä¸­å®‰å…¨åœ°è°ƒç”¨è¯¥ç±»çš„æ–¹æ³•ã€‚</p>
<h4 data-id="heading-4">ä½¿ç”¨åœºæ™¯</h4>
<ul>
<li>å½“æ³›å‹å‡½æ•°éœ€è¦è°ƒç”¨ç±»å‹å‚æ•°çš„ç‰¹å®šæ–¹æ³•æ—¶</li>
<li>å½“æˆ‘ä»¬éœ€è¦ç¡®ä¿ä¼ å…¥çš„ç±»å‹æœ‰ç‰¹å®šçš„å±æ€§æˆ–è¡Œä¸ºæ—¶</li>
</ul>
<h4 data-id="heading-5">ä»£ç ç¤ºä¾‹</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä¸Šé™çº¦æŸä¸º Numberï¼Œç¡®ä¿ T æ˜¯æ•°å­—ç±»å‹</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Number&gt;</span> <span class="hljs-title">sum</span><span class="hljs-params">(list: <span class="hljs-type">List</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: <span class="hljs-built_in">Double</span> {
    <span class="hljs-keyword">var</span> total = <span class="hljs-number">0.0</span>
    <span class="hljs-keyword">for</span> (num <span class="hljs-keyword">in</span> list) {
        total += num.toDouble() <span class="hljs-comment">// è°ƒç”¨ Number ç±»çš„ toDouble() æ–¹æ³•</span>
    }
    <span class="hljs-keyword">return</span> total
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> intList = listOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>)
    <span class="hljs-keyword">val</span> doubleList = listOf(<span class="hljs-number">1.5</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">3.5</span>)
    
    println(sum(intList))       <span class="hljs-comment">// è¾“å‡ºï¼š10.0</span>
    println(sum(doubleList))    <span class="hljs-comment">// è¾“å‡ºï¼š7.5</span>
}
</code></pre>
<h4 data-id="heading-6">ä¸ºä»€ä¹ˆéœ€è¦ä¸Šé™çº¦æŸï¼Ÿ</h4>
<p>æ²¡æœ‰çº¦æŸçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ— æ³•å®‰å…¨åœ°è°ƒç”¨ç±»å‹å‚æ•°çš„æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹ï¼šæ— æ³•ä¿è¯ T æœ‰ toDouble() æ–¹æ³•</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">sum</span><span class="hljs-params">(list: <span class="hljs-type">List</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: <span class="hljs-built_in">Double</span> {
    <span class="hljs-keyword">var</span> total = <span class="hljs-number">0.0</span>
    <span class="hljs-keyword">for</span> (num <span class="hljs-keyword">in</span> list) {
        total += num.toDouble() <span class="hljs-comment">// ç¼–è¯‘é”™è¯¯ï¼</span>
    }
    <span class="hljs-keyword">return</span> total
}
</code></pre>
<h4 data-id="heading-7">ä¸Javaçš„å¯¹æ¯”</h4>
<p>Kotlinçš„ä¸Šé™çº¦æŸæ¯”Javaæ›´å¼ºå¤§ï¼Œå› ä¸ºKotlinçš„æ³›å‹æ˜¯<strong>ç±»å‹å®‰å…¨</strong>çš„ï¼Œè€ŒJavaçš„æ³›å‹æ˜¯<strong>ç±»å‹æ“¦é™¤</strong>çš„ã€‚</p>
<h3 data-id="heading-8">ğŸ”¥ ä¸‹é™çº¦æŸï¼šè®©ç±»å‹"æœ‰ä¸‹é™"</h3>
<h4 data-id="heading-9">ä»€ä¹ˆæ˜¯ä¸‹é™çº¦æŸï¼Ÿ</h4>
<p>ä¸‹é™çº¦æŸç”¨äº<strong>é™åˆ¶ç±»å‹å‚æ•°å¿…é¡»æ˜¯æŸä¸ªç±»çš„çˆ¶ç±»</strong>ï¼ˆåŒ…æ‹¬è¯¥ç±»æœ¬èº«ï¼‰ï¼Œé€šå¸¸ç”¨äº<strong>å®‰å…¨å†™å…¥é›†åˆ</strong>ã€‚</p>
<h4 data-id="heading-10">ä½¿ç”¨åœºæ™¯</h4>
<ul>
<li>å‘é›†åˆä¸­æ·»åŠ å…ƒç´ æ—¶ï¼Œç¡®ä¿ç±»å‹å…¼å®¹</li>
<li>åœ¨éœ€è¦æ¶ˆè´¹æ•°æ®æ—¶ï¼Œç¡®ä¿ç±»å‹å®‰å…¨</li>
</ul>
<h4 data-id="heading-11">ä»£ç ç¤ºä¾‹</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä¸‹é™çº¦æŸï¼šç¡®ä¿ T æ˜¯ Animal çš„çˆ¶ç±»</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Animal&gt;</span> <span class="hljs-title">addAnimal</span><span class="hljs-params">(animals: <span class="hljs-type">MutableList</span>&lt;<span class="hljs-type">T</span>&gt;, animal: <span class="hljs-type">T</span>)</span></span> {
    animals.add(animal)
}

<span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> : <span class="hljs-type">Animal</span>()
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> : <span class="hljs-type">Animal</span>()

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> animals = mutableListOf&lt;Animal&gt;()
    
    <span class="hljs-comment">// å¯ä»¥æ·»åŠ  Dog æˆ– Catï¼Œå› ä¸ºå®ƒä»¬æ˜¯ Animal çš„å­ç±»</span>
    addAnimal(animals, Dog())
    addAnimal(animals, Cat())
    
    <span class="hljs-comment">// ä¸èƒ½æ·»åŠ  Animal æœ¬èº«ï¼Œå› ä¸º Animal æ˜¯ Animal çš„çˆ¶ç±»ï¼Œä¸æ˜¯å­ç±»</span>
    <span class="hljs-comment">// addAnimal(animals, Animal()) // ç¼–è¯‘é”™è¯¯</span>
}
</code></pre>
<h4 data-id="heading-12">ä¸ä¸Šé™çº¦æŸçš„åŒºåˆ«</h4>
<ul>
<li>ä¸Šé™çº¦æŸï¼š<code>&lt;T : UpperType&gt;</code> - ç”¨äº<strong>è¯»å–</strong>æ“ä½œ</li>
<li>ä¸‹é™çº¦æŸï¼š<code>&lt;in LowerType&gt;</code> - ç”¨äº<strong>å†™å…¥</strong>æ“ä½œ</li>
</ul>
<h3 data-id="heading-13">ğŸŒˆ å¤šé‡çº¦æŸï¼šç»™ç±»å‹åŠ ä¸ª"å®‰å…¨å›´æ "</h3>
<p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹ç±»å‹å‚æ•°è®¾ç½®å¤šä¸ªçº¦æŸï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨<code>where</code>å…³é”®å­—ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// T å¿…é¡»åŒæ—¶æ˜¯ CharSequence å’Œ Comparable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">copyWhenGreater</span><span class="hljs-params">(list: <span class="hljs-type">List</span>&lt;<span class="hljs-type">T</span>&gt;, threshold: <span class="hljs-type">T</span>)</span></span>: List&lt;String&gt;
    <span class="hljs-keyword">where</span> T : CharSequence, T : Comparable&lt;T&gt; {
    
    <span class="hljs-keyword">return</span> list.filter { it &gt; threshold }.map { it.toString() }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> words = listOf(<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"cherry"</span>)
    println(copyWhenGreater(words, <span class="hljs-string">"b"</span>)) <span class="hljs-comment">// [banana, cherry]</span>
}
</code></pre>
<h4 data-id="heading-14">ä¸ºä»€ä¹ˆéœ€è¦å¤šé‡çº¦æŸï¼Ÿ</h4>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¤„ç†åŒæ—¶æ»¡è¶³å¤šä¸ªæ¡ä»¶çš„ç±»å‹ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>ä¸€ä¸ªç±»å‹æ—¢æ˜¯å¯æ¯”è¾ƒçš„ï¼ˆ<code>Comparable</code>ï¼‰</li>
<li>åˆæ˜¯å­—ç¬¦ä¸²ï¼ˆ<code>CharSequence</code>ï¼‰</li>
<li>è¿˜éœ€è¦æœ‰ç‰¹å®šçš„å±æ€§</li>
</ul>
<h3 data-id="heading-15">ğŸ’¡ ç»å¯¹éç©ºç±»å‹ï¼šå‘Šåˆ«nullçš„å›°æ‰°</h3>
<p>Kotlinä¸­æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç±»å‹çº¦æŸï¼Œç”¨äºå¤„ç†ä¸å¯ä¸ºç©ºçš„ç±»å‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// T å¿…é¡»æ˜¯éç©ºç±»å‹ï¼ˆç›¸å½“äº Java çš„ @NotNullï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Any&gt;</span> <span class="hljs-title">processNonNullable</span><span class="hljs-params">(value: <span class="hljs-type">T</span>)</span></span> {
    println(value.hashCode())
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Any?&gt;</span> <span class="hljs-title">processNullable</span><span class="hljs-params">(value: <span class="hljs-type">T</span>)</span></span> {
    value?.hashCode() <span class="hljs-comment">// å®‰å…¨è°ƒç”¨</span>
}
</code></pre>
<h4 data-id="heading-16">ä¸ºä»€ä¹ˆéœ€è¦ç»å¯¹éç©ºç±»å‹ï¼Ÿ</h4>
<p>å½“éœ€è¦ä¸Javaä»£ç äº’æ“ä½œæ—¶ï¼Œç‰¹åˆ«æ˜¯å½“Javaæ–¹æ³•ä½¿ç”¨äº†<code>@NotNull</code>æ³¨è§£æ—¶ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Java æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Game</span>&lt;<span class="hljs-type">T</span>&gt; {
    T save(T x);
    <span class="hljs-meta">@NotNull</span> T load(<span class="hljs-meta">@NotNull</span> T x);
}

<span class="hljs-comment">// Kotlin å®ç°</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ArcadeGame</span>&lt;<span class="hljs-type">T</span>&gt; : <span class="hljs-type">Game</span>&lt;<span class="hljs-type">T</span>&gt; {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">save</span><span class="hljs-params">(x: <span class="hljs-type">T</span>)</span></span>: T
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">load</span><span class="hljs-params">(x: <span class="hljs-type">T</span> &amp; <span class="hljs-type">Any</span>)</span></span>: T &amp; Any <span class="hljs-comment">// å¿…é¡»ä½¿ç”¨ &amp; Any</span>
}
</code></pre>
<h3 data-id="heading-17">ğŸŒŸ å®é™…åº”ç”¨åœºæ™¯</h3>
<h4 data-id="heading-18">1. æ•°å€¼å¤„ç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å¤„ç†æ•°å€¼åˆ—è¡¨</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Number&gt;</span> <span class="hljs-title">sum</span><span class="hljs-params">(list: <span class="hljs-type">List</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: <span class="hljs-built_in">Double</span> {
    <span class="hljs-keyword">return</span> list.sumOf { it.toDouble() }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">val</span> numbers = listOf(<span class="hljs-number">1</span>, <span class="hljs-number">2.5</span>, <span class="hljs-number">3</span>)
println(sum(numbers)) <span class="hljs-comment">// 6.5</span>
</code></pre>
<h4 data-id="heading-19">2. æ’åºåŠŸèƒ½</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æ’åºå‡½æ•°ï¼Œè¦æ±‚ç±»å‹å¯æ¯”è¾ƒ</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Comparable&lt;T&gt;</span>&gt; <span class="hljs-title">sort</span><span class="hljs-params">(list: <span class="hljs-type">List</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: List&lt;T&gt; {
    <span class="hljs-keyword">return</span> list.sorted()
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">val</span> words = listOf(<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"cherry"</span>)
println(sort(words)) <span class="hljs-comment">// [apple, banana, cherry]</span>

<span class="hljs-keyword">val</span> numbers = listOf(<span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>)
println(sort(numbers)) <span class="hljs-comment">// [1, 2, 3]</span>
</code></pre>
<h4 data-id="heading-20">3. æ•°æ®åº“æŸ¥è¯¢</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä»æ•°æ®åº“è·å–æ•°æ®</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Entity&gt;</span> <span class="hljs-title">query</span><span class="hljs-params">(entityClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: List&lt;T&gt; {
    <span class="hljs-comment">// å®é™…å®ç°ä¼šæŸ¥è¯¢æ•°æ®åº“</span>
    <span class="hljs-keyword">return</span> emptyList()
}

<span class="hljs-comment">// å®ä½“ç±»</span>
<span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Entity</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> : <span class="hljs-type">Entity</span>()
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Product</span> : <span class="hljs-type">Entity</span>()

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">val</span> users = query(User::<span class="hljs-keyword">class</span>.java)
<span class="hljs-keyword">val</span> products = query(Product::<span class="hljs-keyword">class</span>.java)
</code></pre>
<h3 data-id="heading-21">ğŸ“š æ€»ç»“ï¼šæ³›å‹ç±»å‹çº¦æŸçš„è¦ç‚¹</h3>



































<table><thead><tr><th>çº¦æŸç±»å‹</th><th>è¯­æ³•</th><th>ä½¿ç”¨åœºæ™¯</th><th>ä¾‹å­</th></tr></thead><tbody><tr><td>ä¸Šé™çº¦æŸ</td><td><code>&lt;T : UpperType&gt;</code></td><td>è¯»å–æ“ä½œï¼Œéœ€è¦è°ƒç”¨ç‰¹å®šæ–¹æ³•</td><td><code>fun &lt;T : Number&gt; sum(list: List&lt;T&gt;)</code></td></tr><tr><td>ä¸‹é™çº¦æŸ</td><td><code>&lt;in LowerType&gt;</code></td><td>å†™å…¥æ“ä½œï¼Œç¡®ä¿ç±»å‹å…¼å®¹</td><td><code>fun &lt;T : Animal&gt; addAnimal(animals: MutableList&lt;T&gt;, animal: T)</code></td></tr><tr><td>å¤šé‡çº¦æŸ</td><td><code>where T : Type1, T : Type2</code></td><td>éœ€è¦å¤šä¸ªçº¦æŸ</td><td><code>where T : CharSequence, T : Comparable&lt;T&gt;</code></td></tr><tr><td>ç»å¯¹éç©º</td><td><code>T &amp; Any</code></td><td>ä¸Java @NotNulläº’æ“ä½œ</td><td><code>fun load(x: T &amp; Any): T &amp; Any</code></td></tr></tbody></table>
<h3 data-id="heading-22">ğŸ’¡ å°è´´å£«</h3>
<ol>
<li><strong>é»˜è®¤ä¸Šç•Œ</strong>ï¼šå¦‚æœæ²¡æœ‰æŒ‡å®šä¸Šç•Œï¼ŒKotliné»˜è®¤æ˜¯<code>Any?</code>ï¼ˆå…è®¸nullï¼‰</li>
<li><strong>åˆç†ä½¿ç”¨</strong>ï¼šä¸è¦è¿‡åº¦çº¦æŸï¼Œå¦åˆ™ä¼šé™åˆ¶å‡½æ•°çš„ä½¿ç”¨åœºæ™¯</li>
<li><strong>ç±»å‹æ¨æ–­</strong>ï¼šKotlinä¼šè‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œæ‰€ä»¥é€šå¸¸ä¸éœ€è¦æ˜¾å¼æŒ‡å®š</li>
<li><strong>å‘½åçº¦å®š</strong>ï¼šç±»å‹å‚æ•°é€šå¸¸ç”¨å•ä¸ªå¤§å†™å­—æ¯ï¼Œå¦‚<code>T</code>ã€<code>E</code>ã€<code>K</code>ã€<code>V</code></li>
</ol>
<h3 data-id="heading-23">ğŸŒˆ ä¸€ä¸ªæœ‰è¶£çš„ä¾‹å­</h3>
<p>è¯•è¯•çœ‹ï¼Œå†™ä¸€ä¸ªæ³›å‹å‡½æ•°ï¼Œå¯ä»¥æ¯”è¾ƒä¸¤ä¸ªå¯æ¯”è¾ƒçš„å¯¹è±¡ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Comparable&lt;T&gt;</span>&gt; <span class="hljs-title">compare</span><span class="hljs-params">(a: <span class="hljs-type">T</span>, b: <span class="hljs-type">T</span>)</span></span>: <span class="hljs-built_in">Int</span> {
    <span class="hljs-keyword">return</span> a.compareTo(b)
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    println(compare(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>)) <span class="hljs-comment">// -1</span>
    println(compare(<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>)) <span class="hljs-comment">// -1</span>
    <span class="hljs-comment">// println(compare(10, "20")) // ç¼–è¯‘é”™è¯¯ï¼ç±»å‹ä¸åŒ¹é…</span>
}
</code></pre>
<h3 data-id="heading-24">ğŸ’¬ æœ€åæƒ³å¯¹ä½ è¯´</h3>
<p>æ³›å‹ç±»å‹çº¦æŸæ˜¯Kotlinä¸­è®©ä»£ç æ›´å®‰å…¨ã€æ›´ä¼˜é›…çš„å…³é”®ç‰¹æ€§ä¹‹ä¸€ã€‚åˆšå¼€å§‹å­¦ä¹ æ—¶å¯èƒ½ä¼šè§‰å¾—æœ‰ç‚¹æŠ½è±¡ï¼Œä½†ä¸€æ—¦æŒæ¡äº†ï¼Œä½ ä¼šå‘ç°å®ƒèƒ½è®©ä½ çš„ä»£ç æ—¢å®‰å…¨åˆçµæ´»ï¼Œå¤§å¤§å‡å°‘è¿è¡Œæ—¶é”™è¯¯ã€‚</p>
<blockquote>
<p>ğŸ’¡ <strong>å°å»ºè®®</strong>ï¼šåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå…ˆä»ç®€å•çš„ä¸Šé™çº¦æŸå¼€å§‹ï¼Œæ¯”å¦‚<code>&lt;T : Number&gt;</code>ï¼Œç„¶åæ…¢æ…¢å°è¯•æ›´å¤æ‚çš„åœºæ™¯ã€‚æ³›å‹çº¦æŸç”¨å¤šäº†ï¼Œä½ ä¼šçˆ±ä¸Šå®ƒçš„ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Collections.synchronizedMap()ä¸ConcurrentHashMapçš„åŒºåˆ«ç¬”è®°]]></title>    <link>https://juejin.cn/post/7586971886590132267</link>    <guid>https://juejin.cn/post/7586971886590132267</guid>    <pubDate>2025-12-24T02:46:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586971886590132267" data-draft-id="7586972442422820905" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Collections.synchronizedMap()ä¸ConcurrentHashMapçš„åŒºåˆ«ç¬”è®°"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-12-24T02:46:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¿ƒæºxinyuan"/> <meta itemprop="url" content="https://juejin.cn/user/4283353029151694"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Collections.synchronizedMap()ä¸ConcurrentHashMapçš„åŒºåˆ«ç¬”è®°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4283353029151694/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¿ƒæºxinyuan
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T02:46:31.000Z" title="Wed Dec 24 2025 02:46:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><code>Collections.synchronizedMap()</code> å’Œ <code>ConcurrentHashMap</code> éƒ½æ˜¯Javaä¸­ç”¨äºçº¿ç¨‹å®‰å…¨çš„Mapå®ç°ï¼Œä½†å®ƒä»¬åœ¨è®¾è®¡ç†å¿µã€æ€§èƒ½å’Œç‰¹æ€§ä¸Šæœ‰æ˜¾è‘—åŒºåˆ«ï¼š</p>
<h2 data-id="heading-0">1. <strong>é”çš„ç²’åº¦</strong></h2>
<h3 data-id="heading-1"><code>Collections.synchronizedMap()</code></h3>
<ul>
<li><strong>å…¨è¡¨é”</strong>ï¼šå¯¹æ•´ä¸ªMapå¯¹è±¡åŠ é”</li>
<li>ä»»ä½•çº¿ç¨‹è®¿é—®ä»»ä½•æ–¹æ³•æ—¶éƒ½ä¼šé”å®šæ•´ä¸ªMap</li>
<li>è¯»æ“ä½œå’Œå†™æ“ä½œéƒ½ä¼šé˜»å¡å…¶ä»–æ‰€æœ‰æ“ä½œ</li>
</ul>
<h3 data-id="heading-2"><code>ConcurrentHashMap</code></h3>
<ul>
<li><strong>åˆ†æ®µé”</strong>ï¼ˆJava 7ï¼‰æˆ– <strong>CAS + synchronized</strong>ï¼ˆJava 8ï¼‰</li>
<li>åªé”å®šéƒ¨åˆ†æ•°æ®ï¼ˆæ¡¶æˆ–èŠ‚ç‚¹ï¼‰</li>
<li>å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›è¡Œè¯»æ“ä½œ</li>
<li>å…è®¸ä¸åŒçº¿ç¨‹åŒæ—¶ä¿®æ”¹ä¸åŒçš„æ®µ/èŠ‚ç‚¹</li>
</ul>
<h2 data-id="heading-3">2. <strong>å¹¶å‘æ€§èƒ½å¯¹æ¯”</strong></h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// synchronizedMap - ä½å¹¶å‘æ€§èƒ½</span>
Map&lt;String, String&gt; syncMap = Collections.synchronizedMap(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;());

<span class="hljs-comment">// ConcurrentHashMap - é«˜å¹¶å‘æ€§èƒ½</span>
ConcurrentHashMap&lt;String, String&gt; concurrentMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
</code></pre>

























<table><thead><tr><th>åœºæ™¯</th><th>synchronizedMap</th><th>ConcurrentHashMap</th></tr></thead><tbody><tr><td>è¯»å¤šå†™å°‘</td><td>å·®ï¼ˆæ‰€æœ‰è¯»æ“ä½œä¸²è¡Œï¼‰</td><td>ä¼˜ç§€ï¼ˆè¯»æ“ä½œæ— é”ï¼‰</td></tr><tr><td>å†™å¤šè¯»å°‘</td><td>å·®ï¼ˆæ‰€æœ‰å†™æ“ä½œä¸²è¡Œï¼‰</td><td>è‰¯å¥½ï¼ˆéƒ¨åˆ†å†™å¯å¹¶è¡Œï¼‰</td></tr><tr><td>é«˜å¹¶å‘</td><td>æ€§èƒ½æ€¥å‰§ä¸‹é™</td><td>æ€§èƒ½ä¿æŒç›¸å¯¹ç¨³å®š</td></tr></tbody></table>
<h2 data-id="heading-4">3. <strong>è¿­ä»£å™¨è¡Œä¸º</strong></h2>
<h3 data-id="heading-5"><code>synchronizedMap</code></h3>
<ul>
<li><strong>å¼ºä¸€è‡´æ€§è¿­ä»£å™¨</strong></li>
<li>è¿­ä»£è¿‡ç¨‹ä¸­ä¼šæŒæœ‰é”ï¼Œé˜»æ­¢å…¶ä»–çº¿ç¨‹ä¿®æ”¹</li>
<li>è¿­ä»£æ—¶çœ‹åˆ°çš„æ˜¯æŸä¸ªæ—¶é—´ç‚¹çš„å¿«ç…§</li>
</ul>
<pre><code class="hljs language-java" lang="java">Map&lt;String, String&gt; syncMap = Collections.synchronizedMap(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;());
<span class="hljs-comment">// è¿­ä»£æ—¶éœ€è¦æ‰‹åŠ¨åŒæ­¥</span>
<span class="hljs-keyword">synchronized</span>(syncMap) {
    <span class="hljs-keyword">for</span>(String key : syncMap.keySet()) {
        <span class="hljs-comment">// çº¿ç¨‹å®‰å…¨</span>
    }
}
</code></pre>
<h3 data-id="heading-6"><code>ConcurrentHashMap</code></h3>
<ul>
<li><strong>å¼±ä¸€è‡´æ€§è¿­ä»£å™¨</strong></li>
<li>è¿­ä»£æ—¶ä¸éœ€è¦é”ï¼Œä¸é˜»æ­¢å…¶ä»–çº¿ç¨‹ä¿®æ”¹</li>
<li>å¯èƒ½åæ˜ è¿­ä»£è¿‡ç¨‹ä¸­çš„ä¿®æ”¹ï¼Œä¹Ÿå¯èƒ½ä¸åæ˜ </li>
</ul>
<pre><code class="hljs language-java" lang="java">ConcurrentHashMap&lt;String, String&gt; concurrentMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
<span class="hljs-comment">// è¿­ä»£ä¸éœ€è¦é¢å¤–åŒæ­¥</span>
<span class="hljs-keyword">for</span>(String key : concurrentMap.keySet()) {
    <span class="hljs-comment">// å¯èƒ½çœ‹åˆ°å…¶ä»–çº¿ç¨‹çš„ä¿®æ”¹</span>
}
</code></pre>
<h2 data-id="heading-7">4. <strong>ç©ºå€¼æ”¯æŒ</strong></h2>




















<table><thead><tr><th>ç‰¹æ€§</th><th>synchronizedMap</th><th>ConcurrentHashMap</th></tr></thead><tbody><tr><td>keyä¸ºnull</td><td>å…è®¸ï¼ˆå–å†³äºåº•å±‚Mapï¼‰</td><td>ä¸å…è®¸</td></tr><tr><td>valueä¸ºnull</td><td>å…è®¸ï¼ˆå–å†³äºåº•å±‚Mapï¼‰</td><td>ä¸å…è®¸</td></tr></tbody></table>
<h2 data-id="heading-8">5. <strong>å†…å­˜å¯è§æ€§ä¿è¯</strong></h2>
<h3 data-id="heading-9"><code>synchronizedMap</code></h3>
<ul>
<li>é€šè¿‡<code>synchronized</code>å…³é”®å­—ä¿è¯å¯è§æ€§</li>
<li>éµå¾ª<code>synchronized</code>çš„happens-beforeè§„åˆ™</li>
</ul>
<h3 data-id="heading-10"><code>ConcurrentHashMap</code></h3>
<ul>
<li>ä½¿ç”¨<code>volatile</code>å˜é‡ä¿è¯å¯è§æ€§</li>
<li>éµå¾ªJMMï¼ˆJavaå†…å­˜æ¨¡å‹ï¼‰çš„happens-beforeè§„åˆ™</li>
</ul>
<h2 data-id="heading-11">6. <strong>åŸå­æ“ä½œæ”¯æŒ</strong></h2>
<h3 data-id="heading-12"><code>synchronizedMap</code></h3>
<ul>
<li>æ— å†…ç½®åŸå­æ“ä½œ</li>
<li>éœ€è¦æ‰‹åŠ¨åŒæ­¥å®ç°å¤åˆæ“ä½œ</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ‰‹åŠ¨å®ç°putIfAbsent</span>
<span class="hljs-keyword">synchronized</span>(syncMap) {
    <span class="hljs-keyword">if</span>(!syncMap.containsKey(key)) {
        syncMap.put(key, value);
    }
}
</code></pre>
<h3 data-id="heading-13"><code>ConcurrentHashMap</code></h3>
<ul>
<li>æä¾›ä¸°å¯Œçš„åŸå­æ“ä½œAPI</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åŸå­æ“ä½œï¼Œæ— éœ€å¤–éƒ¨åŒæ­¥</span>
concurrentMap.putIfAbsent(key, value);
concurrentMap.compute(key, (k, v) -&gt; v == <span class="hljs-literal">null</span> ? <span class="hljs-number">1</span> : v + <span class="hljs-number">1</span>);
concurrentMap.merge(key, <span class="hljs-number">1</span>, Integer::sum);
</code></pre>
<h2 data-id="heading-14">7. <strong>æ¨èä½¿ç”¨åœºæ™¯</strong></h2>
<h3 data-id="heading-15">ä½¿ç”¨ <code>Collections.synchronizedMap()</code> å½“ï¼š</h3>
<ol>
<li>å¹¶å‘é‡éå¸¸ä½</li>
<li>éœ€è¦ä¿æŒä¸ç°æœ‰ä»£ç çš„å…¼å®¹æ€§</li>
<li>éœ€è¦å…è®¸nullå€¼</li>
<li>å¯¹æ€§èƒ½è¦æ±‚ä¸é«˜çš„å°è§„æ¨¡åº”ç”¨</li>
</ol>
<h3 data-id="heading-16">ä½¿ç”¨ <code>ConcurrentHashMap</code> å½“ï¼š</h3>
<ol>
<li>é«˜å¹¶å‘ç¯å¢ƒ</li>
<li>è¯»å¤šå†™å°‘çš„åœºæ™¯</li>
<li>éœ€è¦æ›´å¥½çš„å¯ä¼¸ç¼©æ€§</li>
<li>éœ€è¦ä½¿ç”¨åŸå­æ“ä½œ</li>
<li>ç°ä»£Javaåº”ç”¨ï¼ˆJava 5+ï¼‰</li>
</ol>
<h2 data-id="heading-17">8. <strong>ä»£ç ç¤ºä¾‹å¯¹æ¯”</strong></h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ–¹å¼1: synchronizedMap</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SyncMapExample</span> {
    <span class="hljs-keyword">private</span> Map&lt;String, Integer&gt; map = 
        Collections.synchronizedMap(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;());
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">(String key)</span> {
        <span class="hljs-keyword">synchronized</span>(map) {  <span class="hljs-comment">// éœ€è¦é¢å¤–åŒæ­¥</span>
            map.put(key, map.getOrDefault(key, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);
        }
    }
}

<span class="hljs-comment">// æ–¹å¼2: ConcurrentHashMap</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcurrentMapExample</span> {
    <span class="hljs-keyword">private</span> ConcurrentHashMap&lt;String, Integer&gt; map = 
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">(String key)</span> {
        map.compute(key, (k, v) -&gt; v == <span class="hljs-literal">null</span> ? <span class="hljs-number">1</span> : v + <span class="hljs-number">1</span>);
        <span class="hljs-comment">// æˆ–è€…ä½¿ç”¨åŸå­æ“ä½œ</span>
        <span class="hljs-comment">// map.merge(key, 1, Integer::sum);</span>
    }
}
</code></pre>
<h2 data-id="heading-18">æ€»ç»“è¡¨æ ¼</h2>













































<table><thead><tr><th>ç‰¹æ€§</th><th>Collections.synchronizedMap()</th><th>ConcurrentHashMap</th></tr></thead><tbody><tr><td>é”æœºåˆ¶</td><td>å…¨è¡¨é”</td><td>åˆ†æ®µé”/CAS+synchronized</td></tr><tr><td>å¹¶å‘æ€§èƒ½</td><td>ä½</td><td>é«˜</td></tr><tr><td>è¿­ä»£å™¨</td><td>å¼ºä¸€è‡´æ€§ï¼Œéœ€è¦é”</td><td>å¼±ä¸€è‡´æ€§ï¼Œæ— éœ€é”</td></tr><tr><td>ç©ºå€¼</td><td>å…è®¸</td><td>ä¸å…è®¸</td></tr><tr><td>åŸå­æ“ä½œ</td><td>éœ€è¦æ‰‹åŠ¨åŒæ­¥</td><td>å†…ç½®æ”¯æŒ</td></tr><tr><td>å†…å­˜å¼€é”€</td><td>è¾ƒä½</td><td>è¾ƒé«˜ï¼ˆåˆ†æ®µç»“æ„ï¼‰</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>ä½å¹¶å‘ã€ç®€å•åœºæ™¯</td><td>é«˜å¹¶å‘ã€å¤æ‚åœºæ™¯</td></tr></tbody></table>
<p><strong>å»ºè®®</strong>ï¼šåœ¨ç°ä»£Javaå¹¶å‘ç¼–ç¨‹ä¸­ï¼Œä¼˜å…ˆè€ƒè™‘ä½¿ç”¨<code>ConcurrentHashMap</code>ï¼Œé™¤éæœ‰ç‰¹æ®Šéœ€æ±‚ï¼ˆå¦‚éœ€è¦nullå€¼ï¼‰æˆ–è¿è¡Œåœ¨ä½ç‰ˆæœ¬Javaç¯å¢ƒä¸­ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2-2-8 å¿«é€ŸæŒæ¡Kotlin-varargå…³é”®å­—ä¸getå‡½æ•°]]></title>    <link>https://juejin.cn/post/7586994471738540075</link>    <guid>https://juejin.cn/post/7586994471738540075</guid>    <pubDate>2025-12-24T03:11:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586994471738540075" data-draft-id="7586972442422738985" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2-2-8 å¿«é€ŸæŒæ¡Kotlin-varargå…³é”®å­—ä¸getå‡½æ•°"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-12-24T03:11:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å®‰å“è€ç‹"/> <meta itemprop="url" content="https://juejin.cn/user/289926799429805"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2-2-8 å¿«é€ŸæŒæ¡Kotlin-varargå…³é”®å­—ä¸getå‡½æ•°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/289926799429805/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å®‰å“è€ç‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T03:11:22.000Z" title="Wed Dec 24 2025 03:11:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸŒŸ Kotlinçš„varargå…³é”®å­—ä¸getå‡½æ•°ï¼šå®Œç¾ç»„åˆï¼</h2>
<p>å˜¿ï¼çœ‹åˆ°ä½ å¯¹Kotlinçš„varargå…³é”®å­—å’Œgetå‡½æ•°æ„Ÿå…´è¶£ï¼Œå¤ªæ£’äº†ï¼è¿™ä¸¤ä¸ªç‰¹æ€§ç»„åˆèµ·æ¥èƒ½è®©ä½ çš„ä»£ç æ—¢çµæ´»åˆä¼˜é›…ï¼Œå°±åƒç»™ä½ çš„ä»£ç è£…ä¸Šäº†"ä¸‡èƒ½æ’å¤´"ä¸€æ ·ï¼ğŸ˜„</p>
<h3 data-id="heading-1">ğŸ§© varargå…³é”®å­—ï¼šè®©å‚æ•°æ•°é‡"è‡ªç”±"èµ·æ¥</h3>
<p><strong>vararg</strong>ï¼ˆvariable number of argumentsï¼‰æ˜¯Kotlinä¸­ç”¨äºå®šä¹‰<strong>å¯å˜æ•°é‡å‚æ•°</strong>çš„å…³é”®å­—ï¼Œå®ƒå…è®¸å‡½æ•°æ¥æ”¶ä»»æ„æ•°é‡çš„åŒç±»å‹å‚æ•°ã€‚</p>
<h4 data-id="heading-2">åŸºæœ¬ç”¨æ³•</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sum</span><span class="hljs-params">(<span class="hljs-keyword">vararg</span> numbers: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span> {
    <span class="hljs-keyword">var</span> total = <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> (num <span class="hljs-keyword">in</span> numbers) {
        total += num
    }
    <span class="hljs-keyword">return</span> total
}

<span class="hljs-comment">// è°ƒç”¨ç¤ºä¾‹</span>
println(sum(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>))       <span class="hljs-comment">// 6</span>
println(sum(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>)) <span class="hljs-comment">// 15</span>
println(sum())              <span class="hljs-comment">// 0ï¼ˆ0ä¸ªå‚æ•°ï¼‰</span>
</code></pre>
<h4 data-id="heading-3">é‡è¦æç¤º</h4>
<ul>
<li>varargå‚æ•°<strong>å¿…é¡»æ˜¯æœ€åä¸€ä¸ª</strong>å‚æ•°</li>
<li>ä¸èƒ½å°†æ•°ç»„ç›´æ¥ä¼ é€’ç»™varargå‚æ•°ï¼ˆä¼šæŠ¥ç±»å‹ä¸åŒ¹é…é”™è¯¯ï¼‰</li>
<li>å¦‚æœéœ€è¦ä¼ é€’æ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨<code>*</code>æ“ä½œç¬¦</li>
</ul>
<h3 data-id="heading-4">ğŸ§© getå‡½æ•°ï¼šå±æ€§è®¿é—®ä¸æ•°ç»„ç´¢å¼•</h3>
<p><strong>getå‡½æ•°</strong>åœ¨Kotlinä¸­é€šå¸¸ç”¨äºï¼š</p>
<ol>
<li>å±æ€§çš„getterï¼ˆè®¿é—®å±æ€§å€¼ï¼‰</li>
<li>é‡è½½<code>[]</code>è¿ç®—ç¬¦ï¼Œå®ç°ç±»ä¼¼æ•°ç»„çš„ç´¢å¼•è®¿é—®</li>
</ol>
<h4 data-id="heading-5">åŸºæœ¬ç”¨æ³•</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å±æ€§çš„getter</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {
    <span class="hljs-keyword">var</span> name: String = <span class="hljs-string">"John"</span>
        <span class="hljs-keyword">get</span>() {
            println(<span class="hljs-string">"Getting name: <span class="hljs-variable">$field</span>"</span>)
            <span class="hljs-keyword">return</span> field
        }
}

<span class="hljs-comment">// é‡è½½[]è¿ç®—ç¬¦</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyList</span>&lt;<span class="hljs-type">T</span>&gt;(<span class="hljs-keyword">vararg</span> items: T) {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> list = items.toList()
    
    <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">get</span><span class="hljs-params">(index: <span class="hljs-type">Int</span>)</span></span>: T {
        <span class="hljs-keyword">return</span> list[index]
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> list = MyList(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>)
    println(list[<span class="hljs-number">2</span>]) <span class="hljs-comment">// 3</span>
}
</code></pre>
<h3 data-id="heading-6">ğŸ”¥ varargä¸getå‡½æ•°çš„å®Œç¾ç»“åˆ</h3>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®ƒä»¬å¦‚ä½•ç»„åˆä½¿ç”¨ï¼Œæ‰“é€ ä¸€ä¸ª"ä¸‡èƒ½å£«å…µ"ç±»ï¼š</p>
<h4 data-id="heading-7">å®æˆ˜ç¤ºä¾‹</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Soldier</span>&lt;<span class="hljs-type">T : Weapon</span>&gt;(<span class="hljs-keyword">vararg</span> _items: T) {
    <span class="hljs-keyword">var</span> items: Array&lt;<span class="hljs-keyword">out</span> T&gt; = _items
    
    <span class="hljs-comment">// é‡è½½[]è¿ç®—ç¬¦ï¼Œå®ç°é€šè¿‡ç´¢å¼•è·å–æ­¦å™¨</span>
    <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">get</span><span class="hljs-params">(index: <span class="hljs-type">Int</span>)</span></span>: T? {
        <span class="hljs-keyword">return</span> items[index]
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fight</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">for</span> (item <span class="hljs-keyword">in</span> items) {
            item.fire()
        }
    }
}

<span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Weapon</span>(<span class="hljs-keyword">var</span> name: String) {
    <span class="hljs-keyword">open</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fire</span><span class="hljs-params">()</span></span> {
        println(<span class="hljs-string">"Weapon fire!"</span>)
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AK47</span> : <span class="hljs-type">Weapon</span>(<span class="hljs-string">"AK47"</span>) {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fire</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.fire()
        println(<span class="hljs-string">"AK47 fire fire!"</span>)
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">T72</span> : <span class="hljs-type">Weapon</span>(<span class="hljs-string">"T72"</span>) {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fire</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.fire()
        println(<span class="hljs-string">"T72 fire fire!"</span>)
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> soldier = Soldier(AK47(), T72())
    soldier.fight()
    
    <span class="hljs-comment">// é€šè¿‡getè·å–ç‰¹å®šæ­¦å™¨</span>
    println(<span class="hljs-string">"First weapon: <span class="hljs-subst">${soldier[<span class="hljs-number">0</span>]?.name}</span>"</span>)
    println(<span class="hljs-string">"Second weapon: <span class="hljs-subst">${soldier[<span class="hljs-number">1</span>]?.name}</span>"</span>)
}
</code></pre>
<h4 data-id="heading-8">æ‰§è¡Œç»“æœ</h4>
<pre><code class="hljs language-sql" lang="sql">Weapon fire<span class="hljs-operator">!</span>
AK47 fire fire<span class="hljs-operator">!</span>
Weapon fire<span class="hljs-operator">!</span>
T72 fire fire<span class="hljs-operator">!</span>
<span class="hljs-keyword">First</span> weapon: AK47
<span class="hljs-keyword">Second</span> weapon: T72
</code></pre>
<h3 data-id="heading-9">ğŸ’¡ ä¸ºä»€ä¹ˆè¿™æ ·ç»„åˆè¿™ä¹ˆå¼ºå¤§ï¼Ÿ</h3>
<ol>
<li><strong>çµæ´»æ€§</strong>ï¼š<code>vararg</code>å…è®¸ä½ ä¼ é€’ä»»æ„æ•°é‡çš„æ­¦å™¨</li>
<li><strong>ä¾¿æ·æ€§</strong>ï¼š<code>get</code>å‡½æ•°è®©ä½ èƒ½åƒæ•°ç»„ä¸€æ ·é€šè¿‡ç´¢å¼•è·å–æ­¦å™¨</li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šé€šè¿‡æ³›å‹<code>&lt;T : Weapon&gt;</code>ç¡®ä¿åªèƒ½æ·»åŠ æ­¦å™¨ç±»å‹</li>
</ol>
<h3 data-id="heading-10">ğŸŒŸ å®é™…åº”ç”¨åœºæ™¯</h3>
<h4 data-id="heading-11">1. é€šç”¨æ•°æ®ç»“æ„</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DataContainer</span>&lt;<span class="hljs-type">T</span>&gt;(<span class="hljs-keyword">vararg</span> items: T) {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> <span class="hljs-keyword">data</span> = items.toList()
    
    <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">get</span><span class="hljs-params">(index: <span class="hljs-type">Int</span>)</span></span>: T {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">data</span>[index]
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">size</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Int</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">data</span>.size
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> container = DataContainer(<span class="hljs-string">"Apple"</span>, <span class="hljs-string">"Banana"</span>, <span class="hljs-string">"Cherry"</span>)
    println(container[<span class="hljs-number">0</span>]) <span class="hljs-comment">// Apple</span>
    println(container.size()) <span class="hljs-comment">// 3</span>
}
</code></pre>
<h4 data-id="heading-12">2. ç½‘ç»œè¯·æ±‚å‚æ•°</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchUrl</span><span class="hljs-params">(<span class="hljs-keyword">vararg</span> urls: <span class="hljs-type">String</span>)</span></span> {
    <span class="hljs-comment">// å¤„ç†å¤šä¸ªURL</span>
    urls.forEach { url -&gt;
        println(<span class="hljs-string">"Fetching <span class="hljs-variable">$url</span>"</span>)
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
fetchUrl(<span class="hljs-string">"https://example.com"</span>, <span class="hljs-string">"https://example.org"</span>, <span class="hljs-string">"https://example.net"</span>)
</code></pre>
<h4 data-id="heading-13">3. æ—¥å¿—è®°å½•</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">log</span><span class="hljs-params">(<span class="hljs-keyword">vararg</span> messages: <span class="hljs-type">String</span>)</span></span> {
    messages.forEach { message -&gt;
        println(<span class="hljs-string">"LOG: <span class="hljs-variable">$message</span>"</span>)
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
log(<span class="hljs-string">"User logged in"</span>, <span class="hljs-string">"Session created"</span>, <span class="hljs-string">"Data loaded"</span>)
</code></pre>
<h3 data-id="heading-14">ğŸ“Œ é‡è¦æ³¨æ„äº‹é¡¹</h3>
<ol>
<li>
<p><strong>varargå¿…é¡»æ˜¯æœ€åä¸€ä¸ªå‚æ•°</strong>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æ­£ç¡®</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">process</span><span class="hljs-params">(a: <span class="hljs-type">Int</span>, <span class="hljs-keyword">vararg</span> b: <span class="hljs-type">String</span>)</span></span>

<span class="hljs-comment">// é”™è¯¯</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">process</span><span class="hljs-params">(<span class="hljs-keyword">vararg</span> a: <span class="hljs-type">String</span>, b: <span class="hljs-type">Int</span>)</span></span> <span class="hljs-comment">// ç¼–è¯‘é”™è¯¯</span>
</code></pre>
</li>
<li>
<p><strong>ä¸èƒ½ç›´æ¥ä¼ é€’æ•°ç»„</strong>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> array = arrayOf(<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>, <span class="hljs-string">"c"</span>)
<span class="hljs-comment">// ä¸‹é¢ä»£ç ä¼šæŠ¥é”™ï¼šType mismatch: inferred type is Array&lt;String&gt; but String was expected</span>
process(array)

<span class="hljs-comment">// æ­£ç¡®åšæ³•ï¼šä½¿ç”¨*æ“ä½œç¬¦</span>
process(*array)
</code></pre>
</li>
<li>
<p><strong>getå‡½æ•°å¿…é¡»ä½¿ç”¨<code>operator</code>å…³é”®å­—</strong>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">get</span><span class="hljs-params">(index: <span class="hljs-type">Int</span>)</span></span>: T { ... } <span class="hljs-comment">// å¿…é¡»åŠ operator</span>
</code></pre>
</li>
</ol>
<h3 data-id="heading-15">ğŸ’¡ å°è´´å£«</h3>
<ol>
<li><strong>å‘½åçº¦å®š</strong>ï¼švarargå‚æ•°é€šå¸¸ä½¿ç”¨<code>items</code>ã€<code>values</code>ã€<code>numbers</code>ç­‰æè¿°æ€§åç§°</li>
<li><strong>ç±»å‹æ¨æ–­</strong>ï¼šKotlinä¼šè‡ªåŠ¨æ¨æ–­varargå‚æ•°çš„ç±»å‹</li>
<li><strong>æ€§èƒ½è€ƒè™‘</strong>ï¼švarargåœ¨å†…éƒ¨ä¼šåˆ›å»ºä¸€ä¸ªæ•°ç»„ï¼Œå¯¹äºå¤§é‡æ•°æ®å¯èƒ½æœ‰æ€§èƒ½å¼€é”€</li>
<li><strong>æ›¿ä»£æ–¹æ¡ˆ</strong>ï¼šå¦‚æœéœ€è¦é¢‘ç¹ä½¿ç”¨ï¼Œè€ƒè™‘ä½¿ç”¨é›†åˆç±»å‹ï¼ˆå¦‚Listï¼‰ä»£æ›¿vararg</li>
</ol>
<h3 data-id="heading-16">ğŸŒˆ ä¸€ä¸ªæœ‰è¶£çš„ç»ƒä¹ </h3>
<p>è¯•è¯•çœ‹ï¼Œå†™ä¸€ä¸ª<code>ShoppingCart</code>ç±»ï¼Œå®ƒèƒ½å­˜å‚¨ä»»æ„æ•°é‡çš„å•†å“ï¼Œå¹¶é€šè¿‡<code>get</code>å‡½æ•°æŒ‰ç´¢å¼•è·å–ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ShoppingCart</span>&lt;<span class="hljs-type">T</span>&gt;(<span class="hljs-keyword">vararg</span> items: T) {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> itemsList = items.toList()
    
    <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">get</span><span class="hljs-params">(index: <span class="hljs-type">Int</span>)</span></span>: T {
        <span class="hljs-keyword">return</span> itemsList[index]
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">add</span><span class="hljs-params">(item: <span class="hljs-type">T</span>)</span></span> {
        <span class="hljs-comment">// å®é™…å®ç°ä¼šæ·»åŠ åˆ°åˆ—è¡¨</span>
        println(<span class="hljs-string">"Added <span class="hljs-variable">$item</span> to cart"</span>)
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> cart = ShoppingCart(<span class="hljs-string">"Apple"</span>, <span class="hljs-string">"Banana"</span>, <span class="hljs-string">"Cherry"</span>)
    println(<span class="hljs-string">"First item: <span class="hljs-subst">${cart[<span class="hljs-number">0</span>]}</span>"</span>)
    cart.add(<span class="hljs-string">"Mango"</span>)
}
</code></pre>
<h3 data-id="heading-17">ğŸ“š æ€»ç»“</h3>
<ul>
<li><code>vararg</code>ï¼šè®©å‡½æ•°æ¥æ”¶ä»»æ„æ•°é‡çš„åŒç±»å‹å‚æ•°</li>
<li><code>get</code>ï¼šé‡è½½<code>[]</code>è¿ç®—ç¬¦ï¼Œå®ç°ç±»ä¼¼æ•°ç»„çš„ç´¢å¼•è®¿é—®</li>
<li><strong>ç»„åˆä½¿ç”¨</strong>ï¼šé€šè¿‡<code>operator fun get</code>ï¼Œå¯ä»¥åƒè®¿é—®æ•°ç»„ä¸€æ ·é€šè¿‡ç´¢å¼•è·å–varargå‚æ•°</li>
</ul>
<p>è¿™ç§ç»„åˆè®©Kotlinçš„ä»£ç æ—¢çµæ´»åˆå®‰å…¨ï¼Œæ˜¯Kotlinè¯­è¨€ä¸­éå¸¸ä¼˜é›…çš„ç‰¹æ€§ä¹‹ä¸€ï¼ä½ å­¦ä¼šäº†å—ï¼ŸğŸ˜Š</p>
<p>éœ€è¦æˆ‘å¸®ä½ è§£å†³ä»€ä¹ˆå®é™…é—®é¢˜ï¼Œæˆ–è€…æƒ³äº†è§£æ›´å¤šKotlinçš„é«˜çº§ç‰¹æ€§å—ï¼Ÿæˆ‘å¾ˆä¹æ„ç»§ç»­å’Œä½ æ¢è®¨ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2-2-10 å¿«é€ŸæŒæ¡Kotlin-outåå˜]]></title>    <link>https://juejin.cn/post/7586971886590328875</link>    <guid>https://juejin.cn/post/7586971886590328875</guid>    <pubDate>2025-12-24T03:18:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586971886590328875" data-draft-id="7586969583783542790" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2-2-10 å¿«é€ŸæŒæ¡Kotlin-outåå˜"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-12-24T03:18:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å®‰å“è€ç‹"/> <meta itemprop="url" content="https://juejin.cn/user/289926799429805"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2-2-10 å¿«é€ŸæŒæ¡Kotlin-outåå˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/289926799429805/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å®‰å“è€ç‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T03:18:05.000Z" title="Wed Dec 24 2025 03:18:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸŒŸ Kotlinçš„outåå˜ï¼šè®©æ³›å‹æ›´å®‰å…¨ã€æ›´çµæ´»ï¼</h2>
<p>å˜¿ï¼çœ‹åˆ°ä½ å¯¹Kotlinçš„outåå˜æ„Ÿå…´è¶£ï¼Œå¤ªæ£’äº†ï¼è¿™å¯æ˜¯Kotlinä¸­è®©æ³›å‹ç±»å‹ç³»ç»Ÿæ›´å®‰å…¨ã€æ›´çµæ´»çš„"é­”æ³•"ä¹‹ä¸€ã€‚åˆ«æ‹…å¿ƒï¼Œæˆ‘æ¥å¸®ä½ è½»æ¾æŒæ¡å®ƒï¼ğŸ˜„</p>
<h3 data-id="heading-1">ğŸ§© ä»€ä¹ˆæ˜¯outåå˜ï¼Ÿ</h3>
<p><strong>outåå˜</strong>æ˜¯Kotlinä¸­ç”¨äº<strong>å£°æ˜åå˜æ³›å‹ç±»å‹</strong>çš„å…³é”®å­—ã€‚å½“æˆ‘ä»¬åœ¨æ³›å‹ç±»å‹å‚æ•°å‰ä½¿ç”¨<code>out</code>å…³é”®å­—æ—¶ï¼Œè¡¨ç¤ºè¿™ä¸ªæ³›å‹ç±»å‹æ˜¯<strong>åå˜çš„</strong>ï¼Œå³å…è®¸å°†å­ç±»å‹çš„æ³›å‹å®ä¾‹èµ‹å€¼ç»™çˆ¶ç±»å‹çš„æ³›å‹å®ä¾‹ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼š<strong>"out"è¡¨ç¤ºè¿™ä¸ªæ³›å‹ç±»å‹æ˜¯"ç”Ÿäº§è€…"ï¼Œåªæä¾›æ•°æ®ï¼Œä¸æ¥æ”¶æ•°æ®ã€‚</strong></p>
<h3 data-id="heading-2">ğŸ“Œ ä¸ºä»€ä¹ˆéœ€è¦outåå˜ï¼Ÿ</h3>
<p>åœ¨Kotlinä¸­ï¼Œæ³›å‹é»˜è®¤æ˜¯<strong>ä¸å˜</strong>çš„ï¼ˆInvariantï¼‰ã€‚è¿™æ„å‘³ç€ï¼š</p>
<ul>
<li><code>List&lt;String&gt;</code> ä¸æ˜¯ <code>List&lt;Any&gt;</code> çš„å­ç±»å‹</li>
<li><code>List&lt;Dog&gt;</code> ä¸æ˜¯ <code>List&lt;Animal&gt;</code> çš„å­ç±»å‹</li>
</ul>
<p>è¿™ä¼šå¯¼è‡´å¾ˆå¤šç±»å‹å®‰å…¨é—®é¢˜ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> strings: List&lt;String&gt; = listOf(<span class="hljs-string">"Hello"</span>, <span class="hljs-string">"Kotlin"</span>)
<span class="hljs-keyword">val</span> objects: List&lt;Any&gt; = strings <span class="hljs-comment">// ç¼–è¯‘é”™è¯¯ï¼</span>
</code></pre>
<p>ä½¿ç”¨<code>out</code>å…³é”®å­—åï¼ŒKotlinå…è®¸æˆ‘ä»¬å®‰å…¨åœ°å°†å­ç±»å‹èµ‹å€¼ç»™çˆ¶ç±»å‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> strings: List&lt;String&gt; = listOf(<span class="hljs-string">"Hello"</span>, <span class="hljs-string">"Kotlin"</span>)
<span class="hljs-keyword">val</span> objects: List&lt;<span class="hljs-keyword">out</span> Any&gt; = strings <span class="hljs-comment">// æ­£ç¡®ï¼</span>
</code></pre>
<h3 data-id="heading-3">ğŸŒŸ æ ¸å¿ƒåŸç†ï¼šPECSåŸåˆ™</h3>
<p>Kotlinçš„åå˜ï¼ˆoutï¼‰å’Œé€†å˜ï¼ˆinï¼‰éµå¾ª<strong>PECSåŸåˆ™</strong>ï¼š</p>
<blockquote>
<p><strong>Producer-Extends, Consumer-Super</strong></p>
</blockquote>
<ul>
<li><strong>Producerï¼ˆç”Ÿäº§è€…ï¼‰</strong>ï¼šå¦‚æœä¸€ä¸ªæ³›å‹ç±»å‹<strong>åªæä¾›æ•°æ®</strong>ï¼ˆå¦‚Listï¼‰ï¼Œä½¿ç”¨<code>out</code>ï¼ˆåå˜ï¼‰</li>
<li><strong>Consumerï¼ˆæ¶ˆè´¹è€…ï¼‰</strong>ï¼šå¦‚æœä¸€ä¸ªæ³›å‹ç±»å‹<strong>åªæ¥æ”¶æ•°æ®</strong>ï¼ˆå¦‚Consumerï¼‰ï¼Œä½¿ç”¨<code>in</code>ï¼ˆé€†å˜ï¼‰</li>
</ul>
<h3 data-id="heading-4">ğŸ§ª å®é™…ç¤ºä¾‹</h3>
<h4 data-id="heading-5">1. ç®€å•çš„åå˜ç±»</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä½¿ç”¨outå£°æ˜åå˜</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Producer</span>&lt;<span class="hljs-type">out T</span>&gt;(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> item: T) {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">produce</span><span class="hljs-params">()</span></span>: T {
        <span class="hljs-keyword">return</span> item
    }
}

<span class="hljs-comment">// çˆ¶ç±»å’Œå­ç±»</span>
<span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> : <span class="hljs-type">Animal</span>()

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// å­ç±»å‹å¯ä»¥èµ‹å€¼ç»™çˆ¶ç±»å‹</span>
    <span class="hljs-keyword">val</span> dogProducer: Producer&lt;Dog&gt; = Producer(Dog())
    <span class="hljs-keyword">val</span> animalProducer: Producer&lt;Animal&gt; = dogProducer <span class="hljs-comment">// åå˜</span>
    
    <span class="hljs-comment">// è¯»å–æ•°æ®</span>
    <span class="hljs-keyword">val</span> animal: Animal = animalProducer.produce()
    println(animal::<span class="hljs-keyword">class</span>.simpleName) <span class="hljs-comment">// Dog</span>
}
</code></pre>
<h4 data-id="heading-6">2. åå˜æ¥å£</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// åå˜æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Container</span>&lt;<span class="hljs-type">out T</span>&gt; {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getItem</span><span class="hljs-params">()</span></span>: T
}

<span class="hljs-comment">// å­ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> : <span class="hljs-type">Animal</span>()
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> : <span class="hljs-type">Animal</span>()

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> catContainer: Container&lt;Cat&gt; = <span class="hljs-keyword">object</span> : Container&lt;Cat&gt; {
        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getItem</span><span class="hljs-params">()</span></span>: Cat = Cat()
    }
    
    <span class="hljs-comment">// åå˜ï¼šå­ç±»å‹å¯ä»¥èµ‹å€¼ç»™çˆ¶ç±»å‹</span>
    <span class="hljs-keyword">val</span> animalContainer: Container&lt;Animal&gt; = catContainer
    <span class="hljs-keyword">val</span> animal: Animal = animalContainer.getItem()
    println(animal::<span class="hljs-keyword">class</span>.simpleName) <span class="hljs-comment">// Cat</span>
}
</code></pre>
<h4 data-id="heading-7">3. é›†åˆçš„åå˜</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Kotlinæ ‡å‡†åº“ä¸­çš„åå˜é›†åˆ</span>
<span class="hljs-keyword">val</span> strings: List&lt;String&gt; = listOf(<span class="hljs-string">"Hello"</span>, <span class="hljs-string">"Kotlin"</span>)
<span class="hljs-keyword">val</span> objects: List&lt;<span class="hljs-keyword">out</span> Any&gt; = strings <span class="hljs-comment">// åå˜</span>

<span class="hljs-comment">// åªèƒ½è¯»å–ï¼Œä¸èƒ½ä¿®æ”¹</span>
<span class="hljs-comment">// objects.add("World") // ç¼–è¯‘é”™è¯¯ï¼</span>
println(objects[<span class="hljs-number">0</span>]) <span class="hljs-comment">// Hello</span>
</code></pre>
<h3 data-id="heading-8">âš ï¸ ä¸ºä»€ä¹ˆoutä¸èƒ½æ·»åŠ å…ƒç´ ï¼Ÿ</h3>
<p>è¿™æ˜¯åå˜è®¾è®¡çš„å…³é”®ç‚¹ï¼š<strong>ä¸€æ—¦ä½¿ç”¨outï¼Œæ³›å‹ç±»å‹åªèƒ½å‡ºç°åœ¨"out"ä½ç½®ï¼ˆè¿”å›å€¼ã€æ„é€ å‡½æ•°ç­‰ï¼‰ï¼Œä¸èƒ½å‡ºç°åœ¨"in"ä½ç½®ï¼ˆæ–¹æ³•å‚æ•°ç­‰ï¼‰</strong>ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Producer</span>&lt;<span class="hljs-type">out T</span>&gt;(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> item: T) {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">produce</span><span class="hljs-params">()</span></span>: T = item
    
    <span class="hljs-comment">// ä¸‹é¢çš„ä»£ç ä¼šç¼–è¯‘é”™è¯¯ï¼</span>
    <span class="hljs-comment">// fun consume(item: T) { } // ä¸èƒ½æ·»åŠ å…ƒç´ </span>
}
</code></pre>
<p><strong>åŸå› </strong>ï¼šç¼–è¯‘å™¨ä¸çŸ¥é“å…·ä½“ç±»å‹æ˜¯ä»€ä¹ˆï¼Œå¦‚æœå…è®¸æ·»åŠ å…ƒç´ ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç±»å‹ä¸å®‰å…¨ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> strings: List&lt;String&gt; = listOf(<span class="hljs-string">"Hello"</span>)
<span class="hljs-keyword">val</span> objects: List&lt;<span class="hljs-keyword">out</span> Any&gt; = strings

<span class="hljs-comment">// å¦‚æœå…è®¸æ·»åŠ ï¼Œç¼–è¯‘å™¨ä¼šå…è®¸ä»¥ä¸‹æ“ä½œ</span>
objects.add(<span class="hljs-number">123</span>) <span class="hljs-comment">// ä¼šæ·»åŠ Intåˆ°Stringåˆ—è¡¨ï¼Œå¯¼è‡´è¿è¡Œæ—¶é”™è¯¯</span>
</code></pre>
<h3 data-id="heading-9">ğŸ” ä¸Javaçš„å¯¹æ¯”</h3>

























<table><thead><tr><th>ç‰¹æ€§</th><th>Java</th><th>Kotlin</th></tr></thead><tbody><tr><td>åå˜å®ç°</td><td>ä½¿ç”¨é€šé…ç¬¦<code>? extends</code>ï¼ˆä½¿ç”¨å¤„åå˜ï¼‰</td><td>ä½¿ç”¨<code>out</code>å…³é”®å­—ï¼ˆå£°æ˜å¤„åå˜ï¼‰</td></tr><tr><td>ä»£ç ç®€æ´æ€§</td><td>éœ€è¦åœ¨æ¯æ¬¡ä½¿ç”¨æ—¶æŒ‡å®šé€šé…ç¬¦</td><td>åœ¨å£°æ˜ç±»å‹æ—¶æŒ‡å®šä¸€æ¬¡</td></tr><tr><td>ç±»å‹å®‰å…¨</td><td>é€šè¿‡é€šé…ç¬¦ç¡®ä¿</td><td>é€šè¿‡<code>out</code>å…³é”®å­—ç¡®ä¿</td></tr></tbody></table>
<p>Javaç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Javaä½¿ç”¨é€šé…ç¬¦</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">printList</span><span class="hljs-params">(List&lt;? extends Object&gt; list)</span> {
    <span class="hljs-keyword">for</span> (Object item : list) {
        System.out.println(item);
    }
}
</code></pre>
<p>Kotlinç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Kotlinä½¿ç”¨out</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">printList</span><span class="hljs-params">(list: <span class="hljs-type">List</span>&lt;<span class="hljs-type">out</span> <span class="hljs-type">Any</span>&gt;)</span></span> {
    <span class="hljs-keyword">for</span> (item <span class="hljs-keyword">in</span> list) {
        println(item)
    }
}
</code></pre>
<h3 data-id="heading-10">ğŸ’¡ å®é™…åº”ç”¨åœºæ™¯</h3>
<h4 data-id="heading-11">1. åªè¯»é›†åˆ</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä»æ•°æ®åº“è·å–åªè¯»åˆ—è¡¨</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getAnimals</span><span class="hljs-params">()</span></span>: List&lt;<span class="hljs-keyword">out</span> Animal&gt; {
    <span class="hljs-keyword">return</span> listOf(Dog(), Cat())
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> animals: List&lt;Animal&gt; = getAnimals()
    <span class="hljs-comment">// åªèƒ½è¯»å–ï¼Œä¸èƒ½æ·»åŠ </span>
    <span class="hljs-comment">// animals.add(Cat()) // ç¼–è¯‘é”™è¯¯</span>
}
</code></pre>
<h4 data-id="heading-12">2. æ•°æ®æº</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DataSource</span>&lt;<span class="hljs-type">out T</span>&gt; {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> <span class="hljs-keyword">data</span> = mutableListOf&lt;T&gt;()
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">add</span><span class="hljs-params">(item: <span class="hljs-type">T</span>)</span></span> {
        <span class="hljs-keyword">data</span>.add(item)
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getData</span><span class="hljs-params">()</span></span>: List&lt;T&gt; {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">data</span>
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> dataSource = DataSource&lt;String&gt;()
    dataSource.add(<span class="hljs-string">"Hello"</span>)
    
    <span class="hljs-comment">// åªèƒ½è·å–ï¼Œä¸èƒ½æ·»åŠ </span>
    <span class="hljs-keyword">val</span> items: List&lt;<span class="hljs-keyword">out</span> String&gt; = dataSource.getData()
}
</code></pre>
<h4 data-id="heading-13">3. äº‹ä»¶å¤„ç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">EventListener</span>&lt;<span class="hljs-type">out T</span>&gt; {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onEvent</span><span class="hljs-params">(event: <span class="hljs-type">T</span>)</span></span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AnimalListener</span> : <span class="hljs-type">EventListener</span>&lt;<span class="hljs-type">Animal</span>&gt; {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onEvent</span><span class="hljs-params">(event: <span class="hljs-type">Animal</span>)</span></span> {
        println(<span class="hljs-string">"Animal event: <span class="hljs-variable">$event</span>"</span>)
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> animalListener: EventListener&lt;Animal&gt; = AnimalListener()
    <span class="hljs-comment">// åå˜ï¼šå¯ä»¥å°†AnimalListenerèµ‹å€¼ç»™æ›´é€šç”¨çš„EventListener</span>
    <span class="hljs-keyword">val</span> eventListener: EventListener&lt;Any&gt; = animalListener
}
</code></pre>
<h3 data-id="heading-14">ğŸ“Œ é‡è¦è§„åˆ™æ€»ç»“</h3>
<ol>
<li><strong>ä½¿ç”¨<code>out</code>å…³é”®å­—</strong>ï¼šåœ¨æ³›å‹ç±»å‹å‚æ•°å‰æ·»åŠ <code>out</code></li>
<li><strong>åªèƒ½åœ¨"out"ä½ç½®ä½¿ç”¨</strong>ï¼šæ³›å‹ç±»å‹åªèƒ½å‡ºç°åœ¨è¿”å›å€¼ã€æ„é€ å‡½æ•°ç­‰"ç”Ÿäº§"ä½ç½®</li>
<li><strong>ä¸èƒ½åœ¨"in"ä½ç½®ä½¿ç”¨</strong>ï¼šä¸èƒ½åœ¨æ–¹æ³•å‚æ•°ã€èµ‹å€¼ç­‰"æ¶ˆè´¹"ä½ç½®ä½¿ç”¨</li>
<li><strong>åªè¯»å®‰å…¨</strong>ï¼šä½¿ç”¨<code>out</code>çš„æ³›å‹ç±»å‹åªèƒ½ç”¨äºè¯»å–ï¼Œä¸èƒ½ç”¨äºä¿®æ”¹</li>
</ol>
<h3 data-id="heading-15">ğŸ’¡ å°è´´å£«</h3>
<ol>
<li><strong>å‘½åçº¦å®š</strong>ï¼š<code>out</code>è¡¨ç¤º"è¾“å‡º"ï¼Œæ‰€ä»¥åªç”¨äº"ç”Ÿäº§è€…"ç±»å‹</li>
<li><strong>ç±»å‹æ¨æ–­</strong>ï¼šKotlinä¼šè‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œæ‰€ä»¥é€šå¸¸ä¸éœ€è¦æ˜¾å¼æŒ‡å®š</li>
<li><strong>ä¸Javaäº’æ“ä½œ</strong>ï¼šå½“ä¸Javaä»£ç äº¤äº’æ—¶ï¼ŒKotlinçš„<code>out</code>å¯¹åº”Javaçš„<code>? extends</code></li>
<li><strong>é¿å…æ··æ·†</strong>ï¼š<code>out</code>æ˜¯å£°æ˜å¤„åå˜ï¼Œä¸æ˜¯ä½¿ç”¨å¤„åå˜</li>
</ol>
<h3 data-id="heading-16">ğŸŒˆ ä¸€ä¸ªæœ‰è¶£çš„ç»ƒä¹ </h3>
<p>è¯•è¯•çœ‹ï¼Œå†™ä¸€ä¸ª<code>Cache</code>ç±»ï¼Œå®ƒèƒ½ç¼“å­˜ä»»æ„ç±»å‹çš„åªè¯»æ•°æ®ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cache</span>&lt;<span class="hljs-type">out T</span>&gt; {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> cache = mutableMapOf&lt;String, T&gt;()
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">put</span><span class="hljs-params">(key: <span class="hljs-type">String</span>, value: <span class="hljs-type">T</span>)</span></span> {
        cache[key] = value
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">get</span><span class="hljs-params">(key: <span class="hljs-type">String</span>)</span></span>: T? {
        <span class="hljs-keyword">return</span> cache[key]
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> stringCache = Cache&lt;String&gt;()
    stringCache.put(<span class="hljs-string">"name"</span>, <span class="hljs-string">"Alice"</span>)
    
    <span class="hljs-comment">// åå˜ï¼šå¯ä»¥å°†Cache&lt;String&gt;èµ‹å€¼ç»™Cache&lt;out Any&gt;</span>
    <span class="hljs-keyword">val</span> anyCache: Cache&lt;<span class="hljs-keyword">out</span> Any&gt; = stringCache
    println(anyCache.<span class="hljs-keyword">get</span>(<span class="hljs-string">"name"</span>)) <span class="hljs-comment">// Alice</span>
}
</code></pre>
<h3 data-id="heading-17">ğŸ“š æ€»ç»“</h3>
<ul>
<li><strong>out</strong>ï¼šåå˜ï¼Œè¡¨ç¤º"ç”Ÿäº§è€…"ï¼Œåªèƒ½ç”¨äºè¯»å–</li>
<li><strong>in</strong>ï¼šé€†å˜ï¼Œè¡¨ç¤º"æ¶ˆè´¹è€…"ï¼Œåªèƒ½ç”¨äºå†™å…¥</li>
<li><strong>é»˜è®¤</strong>ï¼šæ³›å‹ç±»å‹æ˜¯ä¸å˜çš„ï¼Œæ—¢ä¸èƒ½è¯»ä¹Ÿä¸èƒ½å†™</li>
</ul>
<p>Kotlinçš„<code>out</code>åå˜è®©æˆ‘ä»¬çš„ä»£ç æ›´å®‰å…¨ã€æ›´çµæ´»ï¼Œé¿å…äº†Javaä¸­é€šé…ç¬¦çš„å†—é•¿å†™æ³•ã€‚é€šè¿‡åˆç†ä½¿ç”¨<code>out</code>ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™å‡ºæ—¢ç±»å‹å®‰å…¨åˆçµæ´»çš„APIï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸš€åŸºäº Qoder å¹³å°çš„ Vibe Coding èŒƒå¼ï¼šä»¥åœ£è¯æ¶ˆæ¶ˆä¹ç½‘é¡µæ¸¸æˆå¼€å‘ä¸äº‘ç«¯éƒ¨ç½²ä¸ºä¾‹ğŸ§£]]></title>    <link>https://juejin.cn/post/7586941468873736226</link>    <guid>https://juejin.cn/post/7586941468873736226</guid>    <pubDate>2025-12-24T03:19:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586941468873736226" data-draft-id="7587175302347718691" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸš€åŸºäº Qoder å¹³å°çš„ Vibe Coding èŒƒå¼ï¼šä»¥åœ£è¯æ¶ˆæ¶ˆä¹ç½‘é¡µæ¸¸æˆå¼€å‘ä¸äº‘ç«¯éƒ¨ç½²ä¸ºä¾‹ğŸ§£"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-24T03:19:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å›´å·¾å“¥è§å°˜"/> <meta itemprop="url" content="https://juejin.cn/user/1222312659548446"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸš€åŸºäº Qoder å¹³å°çš„ Vibe Coding èŒƒå¼ï¼šä»¥åœ£è¯æ¶ˆæ¶ˆä¹ç½‘é¡µæ¸¸æˆå¼€å‘ä¸äº‘ç«¯éƒ¨ç½²ä¸ºä¾‹ğŸ§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1222312659548446/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å›´å·¾å“¥è§å°˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T03:19:22.000Z" title="Wed Dec 24 2025 03:19:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸš€åŸºäº Qoder å¹³å°çš„ Vibe Coding èŒƒå¼ï¼šä»¥åœ£è¯æ¶ˆæ¶ˆä¹ç½‘é¡µæ¸¸æˆå¼€å‘ä¸äº‘ç«¯éƒ¨ç½²ä¸ºä¾‹ğŸ§£</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d93d4af58c441b8ad1571ea352ea056~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zu05be-5ZOl6JCn5bCY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767151161&amp;x-signature=SJOSVz3Mo6danmL1fWnV1hQ8G48%3D" alt="c820427f50e44024979b65ef2f4d95f5preview.jpeg~tplv-a9rns2rl98-image_pre_watermark_1_6b.png" loading="lazy"/></p>
<p><strong>æ‘˜è¦ï¼š</strong> æœ¬ç ”ç©¶æ¢è®¨äº†åœ¨ Vibe Coding æ¨¡å¼ä¸‹ï¼Œåˆ©ç”¨ AI åŸç”Ÿå¼€å‘å·¥å…· Qoder é«˜æ•ˆæ„å»ºå¹¶éƒ¨ç½²ç½‘é¡µåº”ç”¨çš„å…¨æµç¨‹ã€‚é€šè¿‡â€œåœ£è¯æ¶ˆæ¶ˆä¹â€æ¸¸æˆçš„å¼€å‘å®è·µï¼ŒéªŒè¯äº†æç¤ºè¯ä¼˜åŒ–ã€è½»é‡çº§æ¨¡å‹è°ƒç”¨ä»¥åŠåŸºäºæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼ˆMCPï¼‰åœ¨é˜¿é‡Œäº‘ç¯å¢ƒä¸‹çš„éƒ¨ç½²å¯è¡Œæ€§ã€‚æœ¬æ–‡è¯¦ç»†è®°å½•äº†ä»éœ€æ±‚è¾“å…¥åˆ°äº‘ç«¯ä¸Šçº¿çš„é«˜çº§æ­¥éª¤ï¼Œå¹¶é’ˆå¯¹éƒ¨ç½²è¿‡ç¨‹ä¸­çš„è·¯å¾„é…ç½®åŠäº‘èµ„æºæƒé™ç­‰å¸¸è§é—®é¢˜æä¾›äº†å®è·µè§è§£ã€‚</p>
<p><strong>å…³é”®è¯ï¼š</strong> Qoderï¼›Vibe Codingï¼›MCPï¼›é˜¿é‡Œäº‘éƒ¨ç½²ï¼›æ¶ˆæ¶ˆä¹å°æ¸¸æˆ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5fc3d48497454fa6904ba75c8638ae39~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zu05be-5ZOl6JCn5bCY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767151161&amp;x-signature=GsQkNwANrWA0udXa%2Bh4iUoYpSGE%3D" alt="æˆªå±2025-12-24 10.10.57.png" loading="lazy"/></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1ixBVB4EMo%2F%3Fspm_id_from%3D333.1387.homepage.video_card.click" target="_blank" title="https://www.bilibili.com/video/BV1ixBVB4EMo/?spm_id_from=333.1387.homepage.video_card.click" ref="nofollow noopener noreferrer">è§†é¢‘æ“ä½œï¼šQoder Vibe Codingä½“éªŒè¥--åœ£è¯æ¶ˆæ¶ˆä¹ç½‘é¡µå°æ¸¸æˆä»å¼€å‘åˆ°éƒ¨ç½²ğŸ§£@å›´å·¾å“¥è§å°˜ #Qoder #Vibe Coding</a></p>
<hr/>
<h4 data-id="heading-1">ä¸€ã€ å®éªŒèƒŒæ™¯ä¸å¼€å‘ç¯å¢ƒ</h4>
<p>åœ¨ 2025 å¹´çš„å¼€å‘ç¯å¢ƒä¸‹ï¼ŒAI é©±åŠ¨çš„ <strong>Vibe Coding</strong> æå¤§ç¼©çŸ­äº†ä»åˆ›æ„åˆ°äº§å“çš„å‘¨æœŸã€‚æœ¬æ¬¡å¼€å‘ç›®æ ‡ä¸ºä¸€æ¬¾å…·æœ‰åœ£è¯ä¸»é¢˜å…ƒç´ çš„â€œæ¶ˆæ¶ˆä¹â€ç½‘é¡µå°æ¸¸æˆï¼Œä¸»è¦ä¾æ‰˜ Qoder å¹³å°çš„é›†æˆç¯å¢ƒå®Œæˆã€‚</p>
<ul>
<li><strong>å¼€å‘å·¥å…·ï¼š</strong> Qoder (é›†æˆ AI å¯¹è¯ä¸ä»£ç ç”ŸæˆåŠŸèƒ½)</li>
<li><strong>éƒ¨ç½²ç¯å¢ƒï¼š</strong> é˜¿é‡Œäº‘æœåŠ¡å™¨ï¼ˆECSï¼‰åŠå¯¹è±¡å­˜å‚¨æœåŠ¡ï¼ˆOSSï¼‰</li>
<li><strong>æ ¸å¿ƒæŠ€æœ¯ï¼š</strong> MCP (Model Context Protocol)ã€æç¤ºè¯ä¼˜åŒ–å¼•æ“</li>
</ul>
<hr/>
<h4 data-id="heading-2">äºŒã€ ç»“æ„åŒ–æ‰§è¡Œæ­¥éª¤ä¸æŠ€æœ¯å®ç°</h4>
<h5 data-id="heading-3">1. æç¤ºè¯å·¥ç¨‹ä¸éœ€æ±‚å®šä¹‰ (Prompt Engineering)</h5>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/69e9ffbb7f3a47e7b813684109f98928~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zu05be-5ZOl6JCn5bCY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767151161&amp;x-signature=C2NKiswPJn%2BE5900u6uZY8jgrtk%3D" alt="æˆªå±2025-12-24 11.04.25.png" loading="lazy"/></p>
<p>å¼€å‘çš„é¦–è¦æ­¥éª¤æ˜¯é€šè¿‡ç»“æ„åŒ–æç¤ºè¯å¼•å¯¼ AI ç”Ÿæˆåˆå§‹ä»£ç ã€‚</p>
<ul>
<li><strong>åˆå§‹æç¤ºè¯ï¼š</strong> â€œè¯·å¸®æˆ‘ç”Ÿæˆä¸€ä¸ªåœ£è¯ä¸»é¢˜çš„æ¶ˆæ¶ˆä¹ç½‘é¡µå°æ¸¸æˆã€‚â€</li>
<li><strong>æç¤ºè¯ä¼˜åŒ– (Prompt Optimization)ï¼š</strong> åœ¨ Qoder ä¸­ï¼Œä¸å»ºè®®ç›´æ¥ä½¿ç”¨ç®€çŸ­æç¤ºï¼Œè€Œåº”åˆ©ç”¨å…¶å†…ç½®çš„<strong>æç¤ºè¯ä¼˜åŒ–åŠŸèƒ½</strong>ã€‚è¯¥åŠŸèƒ½ä¼šå°†ç®€å•çš„éœ€æ±‚æ‰©å……ä¸ºåŒ…å«æ¸¸æˆé€»è¾‘ã€è§†è§‰è§„èŒƒå’Œäº¤äº’ç»†èŠ‚çš„æ·±åº¦æŒ‡ä»¤ã€‚</li>
<li><strong>æ¨¡å‹é€‰æ‹©ï¼š</strong> å®é™…å¼€å‘ä¸­æ¨èä½¿ç”¨<strong>è½»é‡åŒ–æ¨¡å‹</strong>ä»¥æé«˜å“åº”é€Ÿåº¦å¹¶å®Œæˆåˆæ­¥çš„è¿­ä»£å¼€å‘ã€‚</li>
</ul>
<h5 data-id="heading-4">2. ä»£ç ç”Ÿæˆä¸æœ¬åœ°é¢„è§ˆ (Development &amp; Preview)</h5>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4447c610db8c489bb749b765715c769b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zu05be-5ZOl6JCn5bCY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767151161&amp;x-signature=94i3UPzfqrCNUI8oN9%2Byz%2FfjIkc%3D" alt="æˆªå±2025-12-24 11.11.23.png" loading="lazy"/></p>
<p>AI æ ¹æ®ä¼˜åŒ–åçš„æŒ‡ä»¤è‡ªåŠ¨åˆ›å»ºé¡¹ç›®æ–‡ä»¶ç»“æ„ã€‚</p>
<ul>
<li><strong>è‡ªåŠ¨åŒ–æ„å»ºï¼š</strong> AI ä»é›¶å¼€å§‹æ–°å»ºæ–‡ä»¶å¹¶å®Œæˆé€»è¾‘ç¼–å†™ï¼Œç”¨æˆ·å¯é€šè¿‡ Qoder æä¾›çš„<strong>åœ¨çº¿é¢„è§ˆåŠŸèƒ½</strong>å³æ—¶æŸ¥çœ‹æ¸¸æˆè¿è¡Œæ•ˆæœï¼Œå¹¶è¿›è¡Œäº¤äº’æµ‹è¯•ã€‚</li>
</ul>
<h5 data-id="heading-5">3. äº‘ç«¯éƒ¨ç½²å‡†å¤‡ (Environment Setup)</h5>
<p>éƒ¨ç½²é˜¶æ®µä¾èµ–äºé˜¿é‡Œäº‘çš„åº•å±‚æ”¯æŒï¼Œéœ€å®Œæˆä»¥ä¸‹é…ç½®ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/16fc06e2deaf4a88b982a2c0c88b9b74~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zu05be-5ZOl6JCn5bCY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767151161&amp;x-signature=epyYfNFSNfxmSBNuiYAhU1AM2Bs%3D" alt="æˆªå±2025-12-22 23.31.42.png" loading="lazy"/></p>
<ul>
<li><strong>å‡­è¯è·å–ï¼š</strong> åœ¨é˜¿é‡Œäº‘æ§åˆ¶å°è·å– <strong>AccessKey ID (KID)</strong> å’Œ <strong>AccessKey Secret (MID)</strong> ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc2687770eff404c8b9d7d95f5b5ca10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zu05be-5ZOl6JCn5bCY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767151161&amp;x-signature=s9ZUHxU0%2BjAB%2B1xh5bsCzT%2FM0fI%3D" alt="84460357382f94a51b192e697ae1ca3b.png" loading="lazy"/></p>
<ul>
<li><strong>æœåŠ¡å¼€é€šï¼š</strong> å¿…é¡»æ‰‹åŠ¨å¼€é€š<strong>é˜¿é‡Œäº‘ OSSï¼ˆå¯¹è±¡å­˜å‚¨æœåŠ¡ï¼‰</strong> ã€‚éœ€æ³¨æ„ï¼Œè¯¥æœåŠ¡é€šå¸¸æŒ‰é‡è®¡è´¹ï¼Œæœªæ¿€æ´»æˆ–æœªé…ç½® Bucket å°†å¯¼è‡´éƒ¨ç½²å¤±è´¥ã€‚</li>
</ul>
<h5 data-id="heading-6">4. åŸºäº MCP çš„è‡ªåŠ¨åŒ–éƒ¨ç½² (MCP Deployment)</h5>
<pre><code class="hljs language-perl" lang="perl">{
  <span class="hljs-string">"mcpServers"</span>: {
    <span class="hljs-string">"alibaba-cloud-ops-mcp-server"</span>: {
      <span class="hljs-string">"command"</span>: <span class="hljs-string">"/Users/xiaochen/.local/bin/uvx"</span>,
      <span class="hljs-string">"args"</span>: [
        <span class="hljs-string">"alibaba-cloud-ops-mcp-server@0.9.17"</span>,
        <span class="hljs-string">"--code-deploy"</span>
      ],
      <span class="hljs-string">"env"</span>: {
        <span class="hljs-string">"ALIBABA_CLOUD_ACCESS_KEY_ID"</span>: <span class="hljs-string">"LTAI5tPEvCRi..."</span>,
        <span class="hljs-string">"ALIBABA_CLOUD_ACCESS_KEY_SECRET"</span>: <span class="hljs-string">"2PechQPmVx74aPd3Z..."</span>
      }
    }
  }
}
</code></pre>
<p>åˆ©ç”¨ MCP åè®®å’Œå‘½ä»¤è¡Œå·¥å…·å°†æœ¬åœ°é¡¹ç›®æ¨é€è‡³æœåŠ¡å™¨ã€‚</p>
<ul>
<li><strong>æ‰§è¡ŒæŒ‡ä»¤ï¼š</strong> é€šè¿‡ç‰¹å®šçš„éƒ¨ç½²å‘½ä»¤è°ƒç”¨é˜¿é‡Œäº‘ MCP æ’ä»¶ï¼Œå®Œæˆæ–‡ä»¶çš„ä¸Šä¼ ä¸å®ä¾‹æ›´æ–°ã€‚</li>
<li><strong>çŠ¶æ€åé¦ˆï¼š</strong> ç³»ç»Ÿæ˜¾ç¤ºâ€œè¿è¡Œå®ä¾‹å‘½ä»¤æ›´æ–°â€åŠâ€œå¤–ç½‘è®¿é—®é“¾æ¥â€åï¼Œæ ‡å¿—éƒ¨ç½²æˆåŠŸã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-7">ä¸‰ã€ ä¸ªäººè§è§£ï¼šç»éªŒæ€»ç»“ä¸é¿å‘æŒ‡å—</h4>
<p>åœ¨æ•´ä¸ªâ€œVibe Codingâ€çš„å®è·µè¿‡ç¨‹ä¸­ï¼Œè™½ç„¶ AI æ‰¿æ‹…äº†å¤§éƒ¨åˆ†ç¼–ç å·¥ä½œï¼Œä½†<strong>å¼€å‘è€…åœ¨ç¯å¢ƒé…ç½®å’Œè·¯å¾„ç®¡ç†ä¸Šçš„ç»éªŒ</strong>ä¾ç„¶æ˜¯é¡¹ç›®ä¸Šçº¿çš„å…³é”®ã€‚</p>
<h5 data-id="heading-8">1. è¸©å‘é¿å‘æŒ‡å—</h5>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eee1969cd5fa4b08b9360a5c7700d0a3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Zu05be-5ZOl6JCn5bCY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767151161&amp;x-signature=RYXibpxxudmfwawaCC%2BLR3i7x9w%3D" alt="æˆªå±2025-12-24 11.14.37.png" loading="lazy"/></p>
<ul>
<li>
<p><strong>è·¯å¾„é…ç½®é™·é˜±ï¼š</strong> åœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­ï¼ŒAI å¯èƒ½ä¼šé»˜è®¤å¯»æ‰¾ç‰¹å®šçš„å­æ–‡ä»¶å¤¹ï¼ˆå¦‚ <code> root /game</code>ï¼‰æ¥å¯åŠ¨æœåŠ¡ã€‚å¦‚æœé¡¹ç›®ç»“æ„æ˜¯æ‰å¹³çš„ï¼Œä¼šå¯¼è‡´â€œæ‰¾ä¸åˆ°æ–‡ä»¶â€çš„é”™è¯¯ã€‚</p>
<ul>
<li><strong>é¿å‘æ–¹æ¡ˆï¼š</strong> é‡åˆ°æ­¤ç±»è·¯å¾„æŠ¥é”™æ—¶ï¼Œåº”åŠæ—¶<strong>ä¿®æ”¹å¯åŠ¨å‘½ä»¤</strong>ï¼Œå¼ºåˆ¶ç¨‹åºåœ¨æ ¹ç›®å½•ä¸‹è¿è¡Œï¼Œæˆ–é€šè¿‡ AI é‡æ–°è¯†åˆ«é¡¹ç›®ç»“æ„ã€‚</li>
</ul>
</li>
<li>
<p><strong>UVX è¿è¡Œç¯å¢ƒé—®é¢˜ï¼š</strong> å¦‚æœç³»ç»Ÿæ— æ³•è¯†åˆ«ç›¸å…³åŒ…æˆ–ç¯å¢ƒï¼Œå»ºè®®ä½¿ç”¨<strong>ç»å¯¹è·¯å¾„</strong>æ¥å¯åŠ¨ MCP æˆ– UVX ä»»åŠ¡ï¼Œä»¥ç¡®ä¿ç¯å¢ƒçš„ä¸€è‡´æ€§ã€‚</p>
</li>
</ul>
<h5 data-id="heading-9">2. ç»éªŒåˆ†äº«</h5>
<ul>
<li><strong>èµ„æºé¢„æ£€ï¼š</strong> å¾ˆå¤šå¼€å‘è€…ä¼šå¡åœ¨æœ€åä¸€æ­¥ï¼ŒåŸå› å¾€å¾€æ˜¯å¿˜è®°åœ¨é˜¿é‡Œäº‘åå°æ‰‹åŠ¨ç‚¹å‡»â€œå¼€å¯ OSS æœåŠ¡â€ã€‚åœ¨æ‰§è¡Œéƒ¨ç½²è„šæœ¬å‰ï¼ŒåŠ¡å¿…ç¡®è®¤ OSS çŠ¶æ€åŠ Bucket æƒé™å·²æ­£ç¡®é…ç½®ã€‚</li>
<li><strong>å·¥å…·ä¼˜åŠ¿ï¼š</strong> Qoder çš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºå°†â€œå¼€å‘-é¢„è§ˆ-éƒ¨ç½²â€é“¾è·¯é—­ç¯ã€‚åˆ©ç”¨å…¶<strong>è¯†å›¾åŠŸèƒ½</strong>ï¼Œç”šè‡³å¯ä»¥å®ç°â€œç”±å›¾ç”Ÿç â€ï¼Œè¿›ä¸€æ­¥é™ä½å¼€å‘é—¨æ§›ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-10">å››ã€ ç»“è®º</h4>
<p>é€šè¿‡æœ¬æ¬¡â€œåœ£è¯æ¶ˆæ¶ˆä¹â€çš„å¼€å‘å®éªŒè¯æ˜ï¼ŒåŸºäº Qoder å’Œ MCP çš„å·¥ä½œæµèƒ½å¤Ÿå®ç°åœ¨ä¸‰å¤©å†…å®Œæˆä»æ„æ€åˆ°å…¨çƒè®¿é—®çš„å¿«é€Ÿä¸Šçº¿ã€‚æœªæ¥çš„å¼€å‘æ¨¡å¼å°†æ›´åŠ ä¾§é‡äº<strong>æç¤ºè¯çš„ç²¾å‡†æ§åˆ¶</strong>ä¸<strong>è‡ªåŠ¨åŒ–éƒ¨ç½²é“¾è·¯çš„è°ƒä¼˜</strong>ï¼Œè€Œå¼€å‘è€…å°†ä»ç¹ççš„ä»£ç ç¼–å†™ä¸­è§£æ”¾ï¼Œè½¬å‘æ›´é«˜ç»´åº¦çš„æ¶æ„è®¾è®¡ä¸ä½“éªŒä¼˜åŒ–ã€‚</p>
<hr/>
<hr/>
<p><strong>å­¦æœ¯ç±»æ¯”ï¼š</strong> å¦‚æœå°†ä¼ ç»Ÿæ‰‹åŠ¨ç¼–ç æ¯”ä½œ<strong>ä¼æœ¨å»ºå±‹</strong>ï¼ˆéœ€è¦ä»æ¯ä¸€å—ç –ç“¦ç£¨èµ·ï¼‰ï¼Œé‚£ä¹ˆåŸºäº Qoder çš„ Vibe Coding å°±åƒæ˜¯<strong>3D æ‰“å°å»ºç­‘</strong>ã€‚å¼€å‘è€…åªéœ€è¾“å…¥è®¾è®¡è“å›¾ï¼ˆæç¤ºè¯ï¼‰å¹¶ç¡®ä¿ç”µåŠ›å’ŒåŸæ–™ä¾›åº”ï¼ˆäº‘èµ„æºä¸ç¯å¢ƒé…ç½®ï¼‰ï¼ŒAI å³å¯è‡ªåŠ¨å®Œæˆç‰©ç†ç»“æ„çš„å †å ã€‚è€Œâ€œé¿å‘æŒ‡å—â€åˆ™æ˜¯ç¡®ä¿æ‰“å°æœºå–·å¤´ä¸å µå¡ã€åœ°åŸºå¹³æ•´çš„å…³é”®ç»éªŒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€èŠ‚ç‚¹ã€‘[Filter-FadeTransitionèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨]]></title>    <link>https://juejin.cn/post/7586901995431051273</link>    <guid>https://juejin.cn/post/7586901995431051273</guid>    <pubDate>2025-12-24T03:41:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586901995431051273" data-draft-id="7586971532699418633" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€èŠ‚ç‚¹ã€‘[Filter-FadeTransitionèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨"/> <meta itemprop="keywords" content="æ¸¸æˆå¼€å‘,å›¾å½¢å­¦,Unity3D"/> <meta itemprop="datePublished" content="2025-12-24T03:41:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SmalBox"/> <meta itemprop="url" content="https://juejin.cn/user/2218166695237532"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€èŠ‚ç‚¹ã€‘[Filter-FadeTransitionèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2218166695237532/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SmalBox
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T03:41:13.000Z" title="Wed Dec 24 2025 03:41:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong></p>
</blockquote>
<h2 data-id="heading-0">èŠ‚ç‚¹æ¦‚è¿°</h2>
<p>FadeTransitionèŠ‚ç‚¹æ˜¯Unity URPï¼ˆUniversal Render Pipelineï¼‰æ¸²æŸ“ç®¡çº¿ä¸­ç”¨äºå®ç°å¹³æ»‘è¿‡æ¸¡æ•ˆæœçš„æ ¸å¿ƒå·¥å…·ã€‚è¯¥èŠ‚ç‚¹é‡‡ç”¨å™ªå£°é‡æ˜ å°„æœºåˆ¶ï¼Œå°†çº¿æ€§è¿‡æ¸¡è¿‡ç¨‹è½¬åŒ–ä¸ºå…·æœ‰è‡ªç„¶çº¹ç†å˜åŒ–çš„è§†è§‰æ•ˆæœï¼Œå¹¿æ³›åº”ç”¨äºåœºæ™¯åˆ‡æ¢ã€UIåŠ¨ç”»ä»¥åŠç‰¹æ•ˆæ§åˆ¶ç­‰åœºæ™¯ã€‚å…¶æ ¸å¿ƒä¼˜åŠ¿åœ¨äºæœ‰æ•ˆæ‰“ç ´ä¼ ç»Ÿçº¿æ€§è¿‡æ¸¡çš„æœºæ¢°æ„Ÿï¼Œåˆ›é€ å‡ºæ›´ç¬¦åˆäººç±»è§†è§‰æ„ŸçŸ¥çš„æœ‰æœºè¿‡æ¸¡æ•ˆæœã€‚</p>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼ŒFadeTransitionèŠ‚ç‚¹ç‰¹åˆ«é€‚åˆéœ€è¦è‰ºæœ¯åŒ–è¿‡æ¸¡æ•ˆæœçš„åœºæ™¯ã€‚ä¸ä¼ ç»Ÿçº¿æ€§æ¸å˜ç›¸æ¯”ï¼Œå®ƒèƒ½å¤Ÿé€šè¿‡å™ªå£°çº¹ç†çš„å¼•å…¥ï¼Œæ¨¡æ‹Ÿè‡ªç„¶ç•Œä¸­å¸¸è§çš„æ‰©æ•£ã€æº¶è§£ã€ä¾µèš€ç­‰ç°è±¡ï¼Œå¤§å¤§æå‡äº†è§†è§‰è¡¨ç°åŠ›ã€‚åŒæ—¶ï¼Œè¯¥èŠ‚ç‚¹çš„é«˜æ€§èƒ½ç‰¹æ€§ä½¿å…¶åœ¨ç§»åŠ¨è®¾å¤‡å’Œé«˜ç«¯PCå¹³å°éƒ½èƒ½ä¿æŒæµç•…è¿è¡Œã€‚</p>
<h2 data-id="heading-1">æŠ€æœ¯åŸç†æ·±åº¦è§£æ</h2>
<h3 data-id="heading-2">å™ªå£°æ˜ å°„æœºåˆ¶</h3>
<p>FadeTransitionèŠ‚ç‚¹çš„æ ¸å¿ƒç®—æ³•åŸºäºå™ªå£°é‡æ˜ å°„æŠ€æœ¯ï¼Œå…¶æ•°å­¦è¡¨è¾¾å¼ä¸ºï¼š</p>
<p><code>float ret = saturate(fadeValue * (fadeContrast + 1) + (noise - 1) * fadeContrast);</code></p>
<p>è¯¥å…¬å¼é€šè¿‡ä¸‰ä¸ªå…³é”®å‚æ•°çš„ååŒä½œç”¨ï¼Œå®ç°è¿‡æ¸¡æ•ˆæœçš„é‡æ„ï¼š</p>
<ol>
<li><strong>FadeValue</strong>ï¼šåŸºç¡€è¿‡æ¸¡é©±åŠ¨å€¼ï¼Œæ§åˆ¶è¿‡æ¸¡è¿›åº¦ï¼Œé€šå¸¸ç”±åŠ¨ç”»æ›²çº¿æˆ–è„šæœ¬æ§åˆ¶ï¼›</li>
<li><strong>Noise</strong>ï¼šå™ªå£°è¾“å…¥å€¼ï¼Œæä¾›è§†è§‰å˜åŒ–æ€§ï¼Œå¯ä»¥æ˜¯é™æ€çº¹ç†æˆ–åŠ¨æ€ç”Ÿæˆï¼›</li>
<li><strong>FadeContrast</strong>ï¼šå¯¹æ¯”åº¦å‚æ•°ï¼Œæ§åˆ¶è¿‡æ¸¡è¾¹ç¼˜çš„é”åˆ©ç¨‹åº¦ï¼Œå€¼è¶Šå¤§è¾¹ç¼˜è¶Šç¡¬ã€‚</li>
</ol>
<p>å½“FadeValueä¸º0æ—¶ï¼Œè¾“å‡ºå§‹ç»ˆä¸º0ï¼›ä¸º1æ—¶è¾“å‡ºå§‹ç»ˆä¸º1ã€‚åœ¨0åˆ°1çš„åŒºé—´å†…ï¼Œå™ªå£°å€¼å°†ä¸»å¯¼è¿‡æ¸¡çš„å…·ä½“å½¢æ€ï¼Œä»è€Œåˆ›é€ å‡ºä¸°å¯Œçš„è§†è§‰å˜åŒ–ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨Perlinå™ªå£°çº¹ç†å¯ä»¥æ¨¡æ‹Ÿç«ç„°ç‡ƒçƒ§çš„è¿‡æ¸¡æ•ˆæœï¼Œè€Œä½¿ç”¨Voronoiå™ªå£°åˆ™èƒ½åˆ›é€ å‡ºç»†èƒåˆ†è£‚èˆ¬çš„è§†è§‰æ•ˆæœã€‚</p>
<h3 data-id="heading-3">é€æ˜åº¦æ§åˆ¶åŸç†</h3>
<p>åœ¨URPæ¸²æŸ“ç®¡çº¿ä¸­ï¼Œé€æ˜åº¦æ§åˆ¶éµå¾ªç‰¹å®šçš„æ¸²æŸ“æœºåˆ¶ï¼š</p>
<ol>
<li><strong>Alphaé€šé“æ§åˆ¶</strong>ï¼šé¢œè‰²å€¼çš„Aåˆ†é‡åœ¨0-1èŒƒå›´å†…è°ƒèŠ‚åƒç´ é€æ˜åº¦ï¼Œ0ä¸ºå®Œå…¨é€æ˜ï¼Œ1ä¸ºå®Œå…¨ä¸é€æ˜ï¼›</li>
<li><strong>æ¸²æŸ“é˜Ÿåˆ—è®¾ç½®</strong>ï¼šå¿…é¡»ä½¿ç”¨Transparentï¼ˆ3000ï¼‰æ¨¡å¼ä»¥æ”¯æŒAlphaæ··åˆï¼Œç¡®ä¿é€æ˜ç‰©ä½“æ­£ç¡®æ’åºï¼›</li>
<li><strong>æ··åˆæ¨¡å¼é…ç½®</strong>ï¼šæ ‡å‡†é€æ˜æ··åˆé‡‡ç”¨SrcAlpha OneMinusSrcAlphaæ¨¡å¼ï¼Œå®ç°è‡ªç„¶çš„é€æ˜å åŠ ï¼›</li>
<li><strong>æ·±åº¦å†™å…¥ä¼˜åŒ–</strong>ï¼šé€æ˜ç‰©ä½“é€šå¸¸éœ€è¦ç¦ç”¨Zå†™å…¥ä»¥æ”¯æŒæ­£ç¡®çš„æ¸²æŸ“æ’åºï¼Œé¿å…æ·±åº¦æµ‹è¯•å†²çªã€‚</li>
</ol>
<h2 data-id="heading-4">ç«¯å£è¯¦ç»†è¯´æ˜</h2>
<h3 data-id="heading-5">è¾“å…¥ç«¯å£</h3>






























<table><thead><tr><th>ç«¯å£åç§°</th><th>ç±»å‹</th><th>åŠŸèƒ½æè¿°</th></tr></thead><tbody><tr><td>Texture</td><td>Texture 2D</td><td>å™ªå£°æºè¾“å…¥ï¼Œæ”¯æŒå¤šç§çº¹ç†æ ¼å¼ï¼ŒåŒ…æ‹¬PNGã€JPGã€TGAç­‰å¸¸è§æ ¼å¼ï¼Œæ¨èä½¿ç”¨ç°åº¦çº¹ç†ä»¥è·å¾—æœ€ä½³æ•ˆæœ</td></tr><tr><td>Noise</td><td>Float</td><td>åŠ¨æ€å™ªå£°å€¼è¾“å…¥ï¼Œå¯ä¸å…¶ä»–èŠ‚ç‚¹è¿æ¥ï¼Œå¦‚TimeèŠ‚ç‚¹å®ç°åŠ¨æ€æ•ˆæœ</td></tr><tr><td>FadeValue</td><td>Float</td><td>è¿‡æ¸¡è¿›åº¦æ§åˆ¶ï¼ŒèŒƒå›´0-1ï¼Œé€šå¸¸ç”±åŠ¨ç”»ç³»ç»Ÿæˆ–è„šæœ¬é©±åŠ¨</td></tr><tr><td>FadeContrast</td><td>Float</td><td>è¿‡æ¸¡è¾¹ç¼˜å¯¹æ¯”åº¦è°ƒèŠ‚ï¼Œæ¨èèŒƒå›´0-5ï¼Œè¶…å‡ºèŒƒå›´å¯èƒ½å¯¼è‡´æ•ˆæœå¼‚å¸¸</td></tr></tbody></table>
<h3 data-id="heading-6">è¾“å‡ºç«¯å£</h3>















<table><thead><tr><th>ç«¯å£åç§°</th><th>ç±»å‹</th><th>åŠŸèƒ½æè¿°</th></tr></thead><tbody><tr><td>Fade</td><td>Float</td><td>æœ€ç»ˆè¿‡æ¸¡å€¼è¾“å‡ºï¼ŒèŒƒå›´0-1ï¼Œå¯ç›´æ¥è¿æ¥åˆ°ç‰‡å…ƒç€è‰²å™¨çš„Alphaé€šé“</td></tr></tbody></table>
<h2 data-id="heading-7">å®é™…åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-8">åœºæ™¯åˆ‡æ¢è¿‡æ¸¡</h3>
<p>åœ¨Unityåœºæ™¯åˆ‡æ¢è¿‡ç¨‹ä¸­ï¼ŒFadeTransitionèŠ‚ç‚¹å¯åˆ›å»ºæ›´ä¸ºè‡ªç„¶å’Œè§†è§‰å‹å¥½çš„è¿‡æ¸¡æ•ˆæœï¼š</p>
<ol>
<li><strong>çƒŸé›¾è¿‡æ¸¡</strong>ï¼šä½¿ç”¨çƒŸé›¾çŠ¶å™ªå£°çº¹ç†å®ç°åœºæ™¯é€æ¸è¢«çƒŸé›¾ç¬¼ç½©çš„æ•ˆæœï¼Œé€‚åˆå¥‡å¹»æˆ–ç¥ç§˜ä¸»é¢˜çš„æ¸¸æˆï¼›</li>
<li><strong>ç¢ç‰‡è¿‡æ¸¡</strong>ï¼šä½¿ç”¨é«˜å¯¹æ¯”åº¦å‚æ•°å’Œè§„åˆ™å™ªå£°å®ç°åœºæ™¯ç ´ç¢æ¶ˆå¤±çš„æ•ˆæœï¼Œé€‚ç”¨äºåŠ¨ä½œæˆ–ç§‘å¹»æ¸¸æˆï¼›</li>
<li><strong>æ‰«æçº¿è¿‡æ¸¡</strong>ï¼šä½¿ç”¨å®šå‘å™ªå£°çº¹ç†å®ç°ç±»ä¼¼ç”µè§†æ‰«æçº¿çš„åˆ‡æ¢æ•ˆæœï¼Œé€‚åˆèµ›åšæœ‹å…‹æˆ–ç§‘æŠ€ä¸»é¢˜ã€‚</li>
</ol>
<p>å…·ä½“å®ç°æ—¶ï¼Œå¼€å‘è€…å¯ä»¥åˆ›å»ºä¸“é—¨çš„è¿‡æ¸¡ç®¡ç†å™¨ï¼Œé€šè¿‡åç¨‹æ§åˆ¶FadeValueçš„å˜åŒ–ï¼Œå¹¶ç»“åˆåœºæ™¯åŠ è½½å¼‚æ­¥æ“ä½œï¼Œç¡®ä¿è¿‡æ¸¡æ•ˆæœä¸åœºæ™¯åŠ è½½è¿›åº¦å®Œç¾åŒæ­¥ã€‚</p>
<h3 data-id="heading-9">UIå…ƒç´ åŠ¨ç”»</h3>
<p>åœ¨ç”¨æˆ·ç•Œé¢è®¾è®¡ä¸­ï¼ŒFadeTransitionèŠ‚ç‚¹ä¸ºUIå…ƒç´ çš„æ˜¾ç¤ºä¸éšè—æä¾›äº†ä¸°å¯Œçš„åŠ¨ç”»å¯èƒ½æ€§ï¼š</p>
<ol>
<li><strong>æŒ‰é’®äº¤äº’åé¦ˆ</strong>ï¼šä¸ºæŒ‰é’®çš„æŒ‰ä¸‹å’Œé‡Šæ”¾çŠ¶æ€æ·»åŠ è¿‡æ¸¡æ•ˆæœï¼Œå¢å¼ºç”¨æˆ·äº¤äº’ä½“éªŒï¼›</li>
<li><strong>èœå•å¼¹å‡ºåŠ¨ç”»</strong>ï¼šä¸ºå¼¹å‡ºèœå•å’Œå¯¹è¯æ¡†æ·»åŠ åˆ›æ„çš„å‡ºç°ä¸æ¶ˆå¤±åŠ¨ç”»ï¼Œæå‡ç•Œé¢è´¨æ„Ÿï¼›</li>
<li><strong>é¡µé¢åˆ‡æ¢è¿‡æ¸¡</strong>ï¼šåœ¨å¤šé¡µé¢åº”ç”¨ä¸­å®ç°æµç•…çš„é¡µé¢åˆ‡æ¢æ•ˆæœï¼Œé¿å…ç”Ÿç¡¬çš„è·³è½¬ã€‚</li>
</ol>
<p>ä¾‹å¦‚ï¼Œåœ¨ç§»åŠ¨ç«¯åº”ç”¨ä¸­ï¼Œå¯ä»¥ä½¿ç”¨FadeTransitionå®ç°å¡ç‰‡å¼ç•Œé¢çš„æ»‘å…¥æ»‘å‡ºæ•ˆæœï¼Œé€šè¿‡ç»“åˆä½ç§»åŠ¨ç”»å’Œé€æ˜åº¦è¿‡æ¸¡ï¼Œåˆ›é€ å‡ºæ·±åº¦æ„Ÿå’Œå±‚æ¬¡æ„Ÿã€‚</p>
<h2 data-id="heading-10">èŠ‚ç‚¹è¿æ¥ä¸é…ç½®</h2>
<h3 data-id="heading-11">åŸºç¡€è¿æ¥æ–¹æ³•</h3>
<p>åˆ›å»ºåŸºç¡€çš„FadeTransitionæ•ˆæœéœ€æŒ‰ç…§ä»¥ä¸‹èŠ‚ç‚¹è¿æ¥é¡ºåºï¼š</p>
<ol>
<li>åœ¨Projecté¢æ¿å³é”®åˆ›å»ºUnlit Graphï¼Œé€‰æ‹©URPæ¨¡æ¿ï¼›</li>
<li>æ‰“å¼€ShaderGraphç¼–è¾‘å™¨ï¼Œåœ¨èŠ‚ç‚¹åº“ä¸­æœç´¢å¹¶æ·»åŠ FadeTransitionèŠ‚ç‚¹ï¼›</li>
<li>è¿æ¥å™ªå£°çº¹ç†åˆ°Textureç«¯å£ï¼Œç¡®ä¿çº¹ç†çš„Wrap Modeè®¾ç½®ä¸ºRepeatä»¥æ”¯æŒå¹³é“ºï¼›</li>
<li>è®¾ç½®FadeValueå‚æ•°çš„åŠ¨ç”»æ›²çº¿ï¼Œå¯ä½¿ç”¨Linearã€EaseInOutç­‰æ›²çº¿ç±»å‹ï¼›</li>
<li>è°ƒèŠ‚FadeContrastå‚æ•°ä»¥è·å¾—ç†æƒ³çš„è¾¹ç¼˜æ•ˆæœï¼Œé€šå¸¸ä»1.0å¼€å§‹è°ƒè¯•ï¼›</li>
<li>å°†Fadeè¾“å‡ºè¿æ¥åˆ°MasterèŠ‚ç‚¹çš„Alphaç«¯å£ï¼Œå®ŒæˆåŸºç¡€é…ç½®ã€‚</li>
</ol>
<h3 data-id="heading-12">é«˜çº§é…ç½®æŠ€å·§</h3>
<p>ä¸ºå®ç°æ›´åŠ å¤æ‚å’Œç²¾ç¾çš„è¿‡æ¸¡æ•ˆæœï¼Œå¯é‡‡ç”¨ä»¥ä¸‹é«˜çº§é…ç½®æŠ€å·§ï¼š</p>
<ol>
<li><strong>åŠ¨æ€å™ªå£°ç”Ÿæˆ</strong>ï¼šç»“åˆTiling And OffsetèŠ‚ç‚¹å®ç°å™ªå£°çº¹ç†çš„åŠ¨æ€å¹³ç§»ï¼Œåˆ›å»ºæµåŠ¨çš„è¿‡æ¸¡æ•ˆæœï¼›</li>
<li><strong>å¤šå±‚è¿‡æ¸¡æ•ˆæœ</strong>ï¼šé€šè¿‡ç»„åˆå¤šä¸ªFadeTransitionèŠ‚ç‚¹å®ç°åˆ†å±‚è¿‡æ¸¡ï¼Œä¾‹å¦‚åŒæ—¶ä½¿ç”¨å¤§å°ºåº¦å™ªå£°å’Œå°å°ºåº¦å™ªå£°ï¼›</li>
<li><strong>å®æ—¶å‚æ•°æ§åˆ¶</strong>ï¼šé€šè¿‡C#è„šæœ¬å®æ—¶æ§åˆ¶è¿‡æ¸¡å‚æ•°ï¼Œå“åº”æ¸¸æˆäº‹ä»¶æˆ–ç”¨æˆ·è¾“å…¥ã€‚</li>
</ol>
<p>è¿›é˜¶æŠ€å·§è¿˜åŒ…æ‹¬ä½¿ç”¨BlendèŠ‚ç‚¹æ··åˆå¤šä¸ªè¿‡æ¸¡æ•ˆæœï¼Œæˆ–è€…ä½¿ç”¨SplitèŠ‚ç‚¹åˆ†ç¦»RGBé€šé“å®ç°å½©è‰²è¿‡æ¸¡æ•ˆæœã€‚</p>
<h2 data-id="heading-13">æ€§èƒ½åˆ†æä¸ä¼˜åŒ–</h2>
<h3 data-id="heading-14">æ€§èƒ½å¼€é”€è¯„ä¼°</h3>
<p>FadeTransitionèŠ‚ç‚¹åœ¨Shaderä¸­æ‰§è¡Œçš„è®¡ç®—ç›¸å¯¹ç®€å•ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(1)ï¼Œæ€§èƒ½å¼€é”€æä½ã€‚ä½†åœ¨æŸäº›æƒ…å†µä¸‹ä»éœ€è€ƒè™‘æ€§èƒ½ä¼˜åŒ–ï¼š</p>
<ol>
<li><strong>çº¹ç†é‡‡æ ·ä¼˜åŒ–</strong>ï¼šåˆç†é€‰æ‹©çº¹ç†çš„è¿‡æ»¤æ¨¡å¼å’Œå‹ç¼©æ ¼å¼ï¼Œç§»åŠ¨è®¾å¤‡æ¨èä½¿ç”¨ASTCå‹ç¼©ï¼›</li>
<li><strong>è®¡ç®—ç²¾åº¦é€‰æ‹©</strong>ï¼šåœ¨å¯æ¥å—èŒƒå›´å†…ä½¿ç”¨åŠç²¾åº¦æµ®ç‚¹æ•°ï¼Œç‰¹åˆ«æ˜¯å¯¹äºç§»åŠ¨å¹³å°ï¼›</li>
<li><strong>èŠ‚ç‚¹æ•°é‡æ§åˆ¶</strong>ï¼šé¿å…åœ¨å•ä¸ªShaderä¸­ä½¿ç”¨è¿‡å¤šçš„FadeTransitionèŠ‚ç‚¹ï¼Œé€šå¸¸2-3ä¸ªå³å¯æ»¡è¶³éœ€æ±‚ã€‚</li>
</ol>
<h3 data-id="heading-15">è·¨å¹³å°å…¼å®¹æ€§</h3>
<p>åœ¨ä¸åŒå¹³å°ä¸Šä½¿ç”¨FadeTransitionèŠ‚ç‚¹æ—¶ï¼Œéœ€æ³¨æ„ä»¥ä¸‹å…¼å®¹æ€§é—®é¢˜ï¼š</p>
<ol>
<li><strong>OpenGL ESå…¼å®¹æ€§</strong>ï¼šç¡®ä¿ä½¿ç”¨çš„å™ªå£°çº¹ç†æ ¼å¼åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šå¾—åˆ°è‰¯å¥½æ”¯æŒï¼Œé¿å…ä½¿ç”¨è¿‡å¤§çš„çº¹ç†å°ºå¯¸ï¼›</li>
<li><strong>é‡‘å±APIä¼˜åŒ–</strong>ï¼šé’ˆå¯¹iOSå¹³å°è¿›è¡Œç‰¹å®šçš„Shaderä¼˜åŒ–ï¼Œåˆ©ç”¨Metalçš„ç‰¹æ€§æå‡æ€§èƒ½ï¼›</li>
<li><strong>Vulkané€‚é…</strong>ï¼šæ£€æŸ¥èŠ‚ç‚¹åœ¨Vulkanæ¸²æŸ“åç«¯ä¸‹çš„è¡¨ç°ï¼Œç¡®ä¿ä¸€è‡´æ€§ã€‚</li>
</ol>
<h2 data-id="heading-16">å®é™…æ¡ˆä¾‹å®ç°</h2>
<h3 data-id="heading-17">åœºæ™¯æ·¡å…¥æ·¡å‡ºç³»ç»Ÿ</h3>
<p>åŸºäºFadeTransitionèŠ‚ç‚¹å¯æ„å»ºå®Œæ•´çš„åœºæ™¯æ·¡å…¥æ·¡å‡ºç³»ç»Ÿï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">using</span> System.Collections;
<span class="hljs-keyword">using</span> UnityEngine;
<span class="hljs-keyword">using</span> UnityEngine.SceneManagement;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SceneFadeController</span> : <span class="hljs-title">MonoBehaviour</span>
{
    <span class="hljs-keyword">public</span> Material fadeMaterial;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">float</span> fadeDuration = <span class="hljs-number">2.0f</span>;
    <span class="hljs-keyword">public</span> AnimationCurve fadeCurve = AnimationCurve.EaseInOut(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> IEnumerator <span class="hljs-title">FadeOutIn</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> sceneName</span>)</span>
    {
        <span class="hljs-built_in">float</span> timer = <span class="hljs-number">0f</span>;
        
        <span class="hljs-comment">// æ·¡å‡ºå½“å‰åœºæ™¯</span>
        <span class="hljs-keyword">while</span> (timer &lt; fadeDuration)
        {
            timer += Time.deltaTime;
            <span class="hljs-built_in">float</span> curveValue = fadeCurve.Evaluate(timer / fadeDuration);
            fadeMaterial.SetFloat(<span class="hljs-string">"_FadeValue"</span>, curveValue);
            <span class="hljs-function"><span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title">WaitForEndOfFrame</span>()</span>;
        }
        
        <span class="hljs-comment">// å¼‚æ­¥åŠ è½½æ–°åœºæ™¯</span>
        AsyncOperation asyncLoad = SceneManager.LoadSceneAsync(sceneName);
        
        <span class="hljs-keyword">while</span> (!asyncLoad.isDone)
        {
            <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        
        <span class="hljs-comment">// æ·¡å…¥æ–°åœºæ™¯</span>
        timer = <span class="hljs-number">0f</span>;
        <span class="hljs-keyword">while</span> (timer &lt; fadeDuration)
        {
            timer += Time.deltaTime;
            <span class="hljs-built_in">float</span> curveValue = fadeCurve.Evaluate(<span class="hljs-number">1</span> - (timer / fadeDuration));
            fadeMaterial.SetFloat(<span class="hljs-string">"_FadeValue"</span>, curveValue);
            <span class="hljs-function"><span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title">WaitForEndOfFrame</span>()</span>;
        }
    }
}
</code></pre>
<p>æ­¤ç³»ç»Ÿé€šè¿‡åŠ¨ç”»æ›²çº¿æ§åˆ¶è¿‡æ¸¡èŠ‚å¥ï¼Œç»“åˆå¼‚æ­¥åœºæ™¯åŠ è½½ï¼Œç¡®ä¿è¿‡æ¸¡æµç•…ä¸”æ— å¡é¡¿ã€‚å¼€å‘è€…å¯æ ¹æ®å…·ä½“éœ€æ±‚è°ƒæ•´æ›²çº¿å½¢çŠ¶ï¼Œå®ç°åŠ é€Ÿã€å‡é€Ÿæˆ–è‡ªå®šä¹‰çš„è¿‡æ¸¡æ—¶åºã€‚</p>
<h2 data-id="heading-18">æ•…éšœæ’é™¤ä¸è°ƒè¯•</h2>
<h3 data-id="heading-19">å¸¸è§é—®é¢˜è§£å†³</h3>
<p>åœ¨ä½¿ç”¨FadeTransitionèŠ‚ç‚¹è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°ä»¥ä¸‹å¸¸è§é—®é¢˜ï¼š</p>
<ol>
<li><strong>è¿‡æ¸¡æ•ˆæœä¸æ˜æ˜¾</strong>ï¼šæ£€æŸ¥FadeContrastå‚æ•°æ˜¯å¦è®¾ç½®è¿‡ä½ï¼ŒåŒæ—¶ç¡®è®¤å™ªå£°çº¹ç†çš„å¯¹æ¯”åº¦æ˜¯å¦è¶³å¤Ÿï¼›</li>
<li><strong>è¾¹ç¼˜é”¯é½¿ä¸¥é‡</strong>ï¼šé™ä½FadeContrastå‚æ•°å€¼æˆ–ä½¿ç”¨æŠ—é”¯é½¿æŠ€æœ¯ï¼Œä¹Ÿå¯å°è¯•å¼€å¯çº¹ç†çš„MipmapåŠŸèƒ½ï¼›</li>
<li><strong>æ€§èƒ½ä¸‹é™æ˜æ˜¾</strong>ï¼šä¼˜åŒ–å™ªå£°çº¹ç†çš„åˆ†è¾¨ç‡å’Œå‹ç¼©æ ¼å¼ï¼Œç¡®ä¿çº¹ç†å°ºå¯¸ä¸è¶…è¿‡1024x1024ã€‚</li>
</ol>
<p>è°ƒè¯•æŠ€å·§åŒ…æ‹¬ä½¿ç”¨Frame Debuggeræ£€æŸ¥å®é™…çš„Shaderè¾“å‡ºï¼Œæˆ–è€…åˆ›å»ºæµ‹è¯•åœºæ™¯å•ç‹¬éªŒè¯FadeTransitionèŠ‚ç‚¹çš„æ•ˆæœã€‚</p>
<h2 data-id="heading-20">è¿›é˜¶åº”ç”¨æŠ€å·§</h2>
<h3 data-id="heading-21">è‡ªå®šä¹‰è¿‡æ¸¡æ›²çº¿</h3>
<p>é€šè¿‡ç»“åˆå…¶ä»–æ•°å­¦èŠ‚ç‚¹ï¼Œå¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„è¿‡æ¸¡æ›²çº¿ï¼š</p>
<ol>
<li>ä½¿ç”¨Animation CurveèŠ‚ç‚¹å®ç°å¤æ‚çš„æ—¶åºæ§åˆ¶ï¼Œä¾‹å¦‚å…ˆå¿«åæ…¢çš„è¿‡æ¸¡èŠ‚å¥ï¼›</li>
<li>é€šè¿‡RemapèŠ‚ç‚¹é‡æ–°æ˜ å°„å‚æ•°èŒƒå›´ï¼Œå°†0-1çš„è¿‡æ¸¡å€¼æ˜ å°„åˆ°å…¶ä»–åŒºé—´ï¼›</li>
<li>åˆ©ç”¨PowerèŠ‚ç‚¹åˆ›å»ºæŒ‡æ•°å‹çš„è¿‡æ¸¡å˜åŒ–ï¼Œæ¨¡æ‹Ÿç‰©ç†ä¸–ç•Œçš„è¡°å‡ç°è±¡ã€‚</li>
</ol>
<h3 data-id="heading-22">å®æ—¶å‚æ•°æ§åˆ¶</h3>
<p>é€šè¿‡C#è„šæœ¬å®æ—¶æ§åˆ¶FadeTransitionèŠ‚ç‚¹çš„å‚æ•°ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">using</span> UnityEngine;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">RealTimeFadeControl</span> : <span class="hljs-title">MonoBehaviour</span> 
{
    <span class="hljs-keyword">public</span> Material targetMaterial;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">float</span> currentFadeValue = <span class="hljs-number">0f</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">float</span> fadeSpeed = <span class="hljs-number">1.0f</span>;
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Update</span>()</span> 
    {
        <span class="hljs-built_in">float</span> targetValue = CalculateFadeBasedOnGameState();
        currentFadeValue = Mathf.MoveTowards(currentFadeValue, targetValue, fadeSpeed * Time.deltaTime);
        targetMaterial.SetFloat(<span class="hljs-string">"_FadeValue"</span>, currentFadeValue);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-built_in">float</span> <span class="hljs-title">CalculateFadeBasedOnGameState</span>()</span>
    {
        <span class="hljs-keyword">return</span> Mathf.Clamp01(<span class="hljs-comment">/* è®¡ç®—é€»è¾‘ */</span>);
    }
}
</code></pre>
<p>æ­¤è„šæœ¬å±•ç¤ºäº†å¦‚ä½•æ ¹æ®æ¸¸æˆçŠ¶æ€åŠ¨æ€æ§åˆ¶è¿‡æ¸¡æ•ˆæœï¼Œå¯ç”¨äºå®ç°å—ä¼¤ç‰¹æ•ˆã€ç¯å¢ƒé€‚åº”ã€å‰§æƒ…æç¤ºç­‰å¤šç§æ¸¸æˆæœºåˆ¶ã€‚</p>
<h3 data-id="heading-23">å¤šé€šé“è¿‡æ¸¡æ•ˆæœ</h3>
<p>é€šè¿‡åˆ†ç¦»RGBé€šé“å®ç°å¤æ‚çš„å½©è‰²è¿‡æ¸¡ï¼š</p>
<ul>
<li>åœ¨ShaderGraphä¸­ï¼Œå¯ä»¥ä½¿ç”¨SplitèŠ‚ç‚¹åˆ†ç¦»é¢œè‰²é€šé“</li>
<li>ç„¶åä¸ºæ¯ä¸ªé€šé“å•ç‹¬è®¾ç½®FadeTransitionå‚æ•°</li>
<li>æœ€åä½¿ç”¨CombineèŠ‚ç‚¹é‡æ–°åˆå¹¶é€šé“</li>
</ul>
<p>è¿™ç§æ–¹æ³•ç‰¹åˆ«é€‚åˆéœ€è¦è‰²å½©å˜åŒ–çš„è¿‡æ¸¡åœºæ™¯ï¼Œä¾‹å¦‚æ˜¼å¤œäº¤æ›¿æ—¶çš„å¤©ç©ºé¢œè‰²æ¸å˜ï¼Œæˆ–è€…é­”æ³•æ•ˆæœçš„é¢œè‰²æ¼”å˜ã€‚</p>
<hr/>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong>
ï¼ˆæ¬¢è¿<em>ç‚¹èµç•™è¨€</em>æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[äººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆï¼šåˆå­¦è€…çš„åŠ¡å®å­¦ä¹ è·¯çº¿å›¾]]></title>    <link>https://juejin.cn/post/7586954475657003054</link>    <guid>https://juejin.cn/post/7586954475657003054</guid>    <pubDate>2025-12-24T03:52:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586954475657003054" data-draft-id="7586971532699451401" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="äººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆï¼šåˆå­¦è€…çš„åŠ¡å®å­¦ä¹ è·¯çº¿å›¾"/> <meta itemprop="keywords" content="Agent,LLM,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-24T03:52:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AIå¤§æ¨¡å‹"/> <meta itemprop="url" content="https://juejin.cn/user/3817967696221534"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            äººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆï¼šåˆå­¦è€…çš„åŠ¡å®å­¦ä¹ è·¯çº¿å›¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3817967696221534/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AIå¤§æ¨¡å‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T03:52:18.000Z" title="Wed Dec 24 2025 03:52:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>ã€‚</p>
</blockquote>
<p>ä»Šå¤©ï¼Œæˆ‘æƒ³å’Œå¤§å®¶èŠèŠå¦‚ä½•æˆä¸ºä¸€åäººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆâ€”â€”ä½†ä¼šé‡‡ç”¨åŠ¡å®çš„è§†è§’ï¼Œå……åˆ†è€ƒè™‘å¤§å¤šæ•°äººå®é™…çš„èµ·ç‚¹ã€‚</p>
<p>å¸‚é¢ä¸Šæœ‰æ— æ•°â€œäººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆå­¦ä¹ è·¯çº¿å›¾â€ï¼Œå£°ç§°åªéœ€å‡ ä¸ªæœˆå°±èƒ½è®©ä½ æˆä¸ºäººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆã€‚ä½œä¸ºä¸€ååœ¨äºšé©¬é€Šï¼ˆAmazonï¼‰ä»äº‹åº”ç”¨æœºå™¨å­¦ä¹ å·¥ä½œã€ä¸“æ³¨äºæœºå™¨å­¦ä¹ åŸºç¡€è®¾æ–½åŠç”Ÿæˆå¼äººå·¥æ™ºèƒ½å†…å®¹ç†è§£çš„ä»ä¸šè€…ï¼Œæˆ‘å¯ä»¥è´Ÿè´£ä»»åœ°å‘Šè¯‰ä½ ï¼šè¦åœ¨å¤§å‹ç§‘æŠ€å…¬å¸æˆä¸ºä¸€åäººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆï¼Œéœ€è¦æŠ•å…¥å¤§é‡æ—¶é—´å¹¶ä»˜å‡ºæŒç»­çš„åŠªåŠ›ã€‚</p>
<p>ä½†å¥½æ¶ˆæ¯æ˜¯ï¼Œè¦å¼€å§‹æ„å»ºå®ç”¨çš„äººå·¥æ™ºèƒ½åº”ç”¨ï¼Œä½ å¹¶ä¸éœ€è¦æŒæ¡æ‰€æœ‰é‚£äº›é«˜çº§æŠ€èƒ½ï¼å¤§å¤šæ•°è‡ªå­¦æˆæ‰çš„å¼€å‘è€…å¹¶ä¸ä¼šä»å¤§å‹ç§‘æŠ€å…¬å¸èµ·æ­¥ï¼›ä»–ä»¬é€šå¸¸ä»ä¸ªäººé¡¹ç›®åšèµ·ï¼Œæˆ–åŠ å…¥åˆåˆ›å…¬å¸ï¼Œäº¦æˆ–æ˜¯å¼€å‘è‡ªå·±çš„äººå·¥æ™ºèƒ½åº”ç”¨ï¼Œåœ¨å®è·µè¿‡ç¨‹ä¸­ä¸æ–­å­¦ä¹ ã€‚</p>
<p>å› æ­¤ï¼Œä¸‹é¢æˆ‘å°†æ‹†è§£ä¸€ä»½æ›´åŠ¡å®çš„å­¦ä¹ è·¯çº¿å›¾ï¼Œæ¸…æ™°è¯´æ˜åœ¨ä½ å­¦ä¹ æ—…ç¨‹çš„æ¯ä¸ªé˜¶æ®µï¼ŒçœŸæ­£éœ€è¦æŒæ¡çš„å†…å®¹ã€‚</p>
<h2 data-id="heading-0"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/>ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆï¼Ÿ</h2>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡®äººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆçš„å…·ä½“å·¥ä½œå†…å®¹ï¼Œå› ä¸ºå¾ˆå¤šå­¦ä¹ è·¯çº¿å›¾ç”šè‡³éƒ½æ²¡æœ‰å‡†ç¡®æè¿°è¿™ä¸ªå²—ä½ï¼å®ƒä»¬å¾€å¾€æè¿°çš„æ˜¯æ•°æ®ç§‘å­¦æˆ–ä¼ ç»Ÿæœºå™¨å­¦ä¹ å·¥ç¨‹å¸ˆçš„å·¥ä½œèŒƒç•´ã€‚</p>
<p>äººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆçš„æ ¸å¿ƒèŒè´£å¹¶éåƒæ•°æ®ç§‘å­¦å®¶æˆ–æœºå™¨å­¦ä¹ å·¥ç¨‹å¸ˆé‚£æ ·ä»é›¶å¼€å§‹è®­ç»ƒæ¨¡å‹ã€‚ç›¸åï¼Œäººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆä¸»è¦è´Ÿè´£ä»¥ä¸‹å·¥ä½œï¼š</p>
<ul>
<li>â€¢ åŸºäºGPT-4ã€LLaMAç­‰é¢„è®­ç»ƒåŸºç¡€æ¨¡å‹æ„å»ºåº”ç”¨ç¨‹åº</li>
<li>â€¢ ä¸“æ³¨äºé€šè¿‡æç¤ºå·¥ç¨‹ã€æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRetrieval-Augmented Generationï¼ŒRAGï¼‰å’Œå¾®è°ƒå®ç°æ¨¡å‹é€‚é…</li>
<li>â€¢ ä¼˜å…ˆè€ƒè™‘å¯æ‰©å±•æ€§ã€è¯„ä¼°ã€æ¨ç†ä¼˜åŒ–åŠå®é™…åœºæ™¯éƒ¨ç½²</li>
<li>â€¢ å¤„ç†ç«¯åˆ°ç«¯ç³»ç»Ÿï¼ŒåŒ…æ‹¬å®‰å…¨æ€§ã€æ•°æ®å¤„ç†å’Œç”¨æˆ·åé¦ˆ</li>
</ul>
<p>è¿™æ˜¯ä¸€ä¸ªä»¥è½¯ä»¶å·¥ç¨‹æŠ€èƒ½ä¸ºåŸºç¡€çš„ä¸“ä¸šå²—ä½ï¼Œæ ¹æ®ä¸ªäººèƒŒæ™¯ä¸åŒï¼Œæœ‰å¤šç§å…¥è¡Œé€”å¾„ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥èŠèŠè¿™ä¸€ç‚¹ã€‚</p>
<h2 data-id="heading-1"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/>åŸºç¡€æŠ€èƒ½</h2>
<p>åœ¨æ·±å…¥å­¦ä¹ äººå·¥æ™ºèƒ½ç‰¹å®šæŠ€æœ¯ä¹‹å‰ï¼Œä½ éœ€è¦æŒæ¡ä¸€äº›åŸºç¡€æŠ€èƒ½ï¼š</p>
<ul>
<li>â€¢Â <strong>æ•°å­¦åŸºç¡€</strong>ï¼šç»Ÿè®¡å­¦ã€æ¦‚ç‡è®ºå’ŒåŸºç¡€çº¿æ€§ä»£æ•°æœ‰åŠ©äºä½ ç†è§£æŠ€æœ¯èƒŒåçš„åŸç†ã€‚ä½ ä¸éœ€è¦æ‹¥æœ‰æ•°å­¦åšå£«å­¦ä½ï¼Œä½†è‡³å°‘è¦ä»æ¦‚å¿µä¸Šç†è§£çŸ©é˜µè¿ç®—ã€æ¦‚ç‡åˆ†å¸ƒç­‰æ¦‚å¿µã€‚</li>
<li>â€¢Â <strong>Pythonç¼–ç¨‹</strong>ï¼šå³ä½¿æ˜¯éƒ¨ç½²è‡ªå·±çš„äººå·¥æ™ºèƒ½åº”ç”¨ï¼Œä½ ä¹Ÿéœ€è¦èƒ½å¤Ÿç¼–å†™ç”Ÿäº§çº§åˆ«çš„ä»£ç ã€‚åœ¨è¯¥é¢†åŸŸï¼Œæ‰å®çš„PythonæŠ€èƒ½å‡ ä¹æ˜¯å¿…å¤‡æ¡ä»¶ã€‚</li>
<li>â€¢Â <strong>åŸºç¡€è½¯ä»¶å¼€å‘æ¦‚å¿µ</strong>ï¼šåŒ…æ‹¬ä½¿ç”¨Gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶ã€å‘½ä»¤è¡ŒåŸºç¡€æ“ä½œï¼Œä»¥åŠç†è§£å¦‚ä½•ä½¿ç”¨APIã€‚ä½ éœ€è¦çŸ¥é“ä¸åŒæœåŠ¡ä¹‹é—´å¦‚ä½•é€šä¿¡ï¼Œä»¥åŠå¦‚ä½•æœ‰æ•ˆç®¡ç†ä»£ç ã€‚</li>
<li>â€¢Â <strong>æœºå™¨å­¦ä¹ åŸºç¡€æ¦‚å¿µ</strong>ï¼šå°½ç®¡äººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆä¸å¸¸ä»é›¶å¼€å§‹è®­ç»ƒæ¨¡å‹ï¼Œä½†ç†è§£ç›‘ç£å­¦ä¹ ä¸æ— ç›‘ç£å­¦ä¹ çš„åŒºåˆ«ã€åŸºç¡€æ¨¡å‹è¯„ä¼°æŒ‡æ ‡ï¼Œä»¥åŠè¿‡æ‹Ÿåˆã€æ¬ æ‹Ÿåˆç­‰æ¦‚å¿µï¼Œèƒ½è®©ä½ æŒæ¡ç†è§£æ›´é«˜çº§ä¸»é¢˜çš„â€œé€šç”¨è¯­è¨€â€ã€‚</li>
</ul>
<p>è¿™äº›åŸºç¡€è‡³å…³é‡è¦ï¼Œå› ä¸ºäººå·¥æ™ºèƒ½å·¥ç¨‹æœ¬è´¨ä¸Šæ˜¯åœ¨è½¯ä»¶å·¥ç¨‹å­¦ç§‘åŸºç¡€ä¸Šå‘å±•èµ·æ¥çš„ä¸“ä¸šé¢†åŸŸã€‚æ²¡æœ‰è¿™äº›åŸºç¡€ï¼Œä½ åœ¨å­¦ä¹ æ›´é«˜çº§æ¦‚å¿µæ—¶ä¼šä¸¾æ­¥ç»´è‰°ã€‚</p>
<h2 data-id="heading-2"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/>æ„å»ºä½ çš„ç¬¬ä¸€ä¸ªäººå·¥æ™ºèƒ½é¡¹ç›®</h2>
<p>æŒæ¡ä¸Šè¿°åŸºç¡€åï¼Œä½ å°±å¯ä»¥å¼€å§‹æ¥è§¦äººå·¥æ™ºèƒ½å·¥å…·å’Œæ¨¡å‹äº†ã€‚é¦–å…ˆï¼Œä½ éœ€è¦å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li><strong>å­¦ä¹ ä½¿ç”¨äººå·¥æ™ºèƒ½API</strong>ï¼šåƒOpenAI APIè¿™æ ·çš„æœåŠ¡èƒ½è®©ä½ æ— éœ€è‡ªè¡Œæ„å»ºæ¨¡å‹ï¼Œå°±èƒ½é›†æˆå¼ºå¤§çš„æ¨¡å‹åŠŸèƒ½ã€‚è¿™æ˜¯å¼€å§‹æ„å»ºå…·å¤‡äººå·¥æ™ºèƒ½èƒ½åŠ›çš„å®é™…åº”ç”¨æœ€å¿«çš„æ–¹å¼ã€‚</li>
<li><strong>ç†è§£æç¤ºå·¥ç¨‹</strong>ï¼šå­¦ä¹ å¦‚ä½•ä¸äººå·¥æ™ºèƒ½æ¨¡å‹è¿›è¡Œæœ‰æ•ˆâ€œæ²Ÿé€šâ€æ˜¯ä¸€é¡¹å…³é”®æŠ€èƒ½ã€‚è®¾è®¡ç²¾è‰¯çš„æç¤ºèƒ½æ˜¾è‘—æå‡æ¨¡å‹è¾“å‡ºè´¨é‡ï¼Œå¯¹äºè·å¾—ç¨³å®šç»“æœè‡³å…³é‡è¦ã€‚</li>
<li><strong>æ„å»ºç®€å•çš„RAGåº”ç”¨</strong>ï¼šè¿™éœ€è¦é€šè¿‡å‘é‡æ•°æ®åº“å’ŒåµŒå…¥æŠ€æœ¯ï¼Œå°†äººå·¥æ™ºèƒ½æ¨¡å‹ä¸ä½ è‡ªå·±çš„æ•°æ®æºè¿æ¥èµ·æ¥ï¼Œä»è€Œè®©æ¨¡å‹èƒ½æ›´æœ‰æ•ˆåœ°å›ç­”ä½ çš„é—®é¢˜ã€‚</li>
<li><strong>å°è¯•ä¸åŒçš„é¢„è®­ç»ƒæ¨¡å‹</strong>ï¼šåˆ©ç”¨Hugging Faceç­‰å¹³å°è·å–ä»–äººå¼€å‘çš„æ¨¡å‹ã€‚è¿™èƒ½è®©ä½ åœ¨æ— éœ€è‡ªè¡Œè®­ç»ƒæˆ–å¾®è°ƒæ¨¡å‹çš„æƒ…å†µä¸‹ï¼Œç§¯ç´¯å¯¹ä¸åŒæ¨¡å‹æ¶æ„çš„ç»éªŒã€‚</li>
<li><strong>æŒæ¡åŸºç¡€åº”ç”¨æ¶æ„</strong>ï¼šä½ éœ€è¦å¼€å§‹å­¦ä¹ å¦‚ä½•æ„å»ºäººå·¥æ™ºèƒ½åº”ç”¨çš„ç»“æ„ï¼ŒåŒ…æ‹¬æ°å½“çš„è¾“å…¥å¤„ç†ã€ä¸Šä¸‹æ–‡æ„å»ºå’Œè¾“å‡ºå¤„ç†ã€‚</li>
</ol>
<p>åœ¨è¿™ä¸ªé˜¶æ®µï¼Œä½ çš„é‡ç‚¹æ˜¯â€œåº”ç”¨â€è€Œéâ€œåˆ›é€ â€â€”â€”å³åˆ©ç”¨ç°æœ‰å·¥å…·æ„å»ºå®ç”¨é¡¹ç›®ã€‚å¤§å¤šæ•°è‡ªå­¦å¼€å‘è€…éƒ½æ˜¯ä»è¿™ä¸ªé˜¶æ®µèµ·æ­¥çš„ï¼ä½ å¯ä»¥å¼€å‘èŠå¤©æœºå™¨äººã€å†…å®¹ç”Ÿæˆå™¨ã€ç®€å•åˆ†ç±»ç³»ç»Ÿç­‰åº”ç”¨ï¼Œè§£å†³å®é™…é—®é¢˜ã€‚</p>
<p>å¦‚æœä½ éœ€è¦å¸®åŠ©æ¥å­¦ä¹ æ„å»ºé¡¹ç›®æ‰€éœ€çš„å…¨éƒ¨æŠ€èƒ½ï¼ŒDataCampå¹³å°æä¾›äº†ä¼˜è´¨è¯¾ç¨‹ï¼ŒåŠ©åŠ›ä½ æ‰“ä¸‹äººå·¥æ™ºèƒ½å·¥ç¨‹åŸºç¡€ï¼š</p>
<ul>
<li>â€¢ å¯¹äºå¸Œæœ›å°†äººå·¥æ™ºèƒ½é›†æˆåˆ°åº”ç”¨ä¸­çš„å¼€å‘è€…ï¼Œå…¶â€œå¼€å‘è€…äººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆåŠ©ç†â€ï¼ˆAssociate AI Engineer for Developersï¼‰å­¦ä¹ è·¯å¾„ä¼šæ•™ä½ å¦‚ä½•ä½¿ç”¨OpenAI APIã€Hugging Faceã€LangChainï¼Œä»¥åŠPineconeç­‰å‘é‡æ•°æ®åº“ã€‚</li>
<li>â€¢ å¯¹äºæ‹¥æœ‰æ•°æ®ç§‘å­¦èƒŒæ™¯ã€å¸Œæœ›æ·±å…¥å­¦ä¹ åŸºç¡€æ¨¡å‹åº”ç”¨çš„äººï¼Œâ€œæ•°æ®ç§‘å­¦å®¶äººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆåŠ©ç†â€ï¼ˆAssociate AI Engineer for Data Scientistsï¼‰å­¦ä¹ è·¯å¾„èƒ½å¸®åŠ©ä½ å‘äººå·¥æ™ºèƒ½å·¥ç¨‹é¢†åŸŸè½¬å‹ã€‚</li>
<li>â€¢ å¦‚æœä½ æ˜¯å®Œå…¨çš„åˆå­¦è€…ï¼Œâ€œäººå·¥æ™ºèƒ½åŸºç¡€â€ï¼ˆAI Fundamentalsï¼‰å­¦ä¹ è·¯å¾„ä¼šé€šè¿‡æ— ä»£ç æ–¹å¼ï¼Œä¸ºä½ ä»‹ç»äººå·¥æ™ºèƒ½æ ¸å¿ƒæ¦‚å¿µã€‚</li>
</ul>
<p>è¿™äº›è¯¾ç¨‹çš„ä¼˜åŠ¿åœ¨äºï¼Œå®ƒä»¬èƒ½ä¸ºä½ æ‰“ä¸‹å¿…è¦çš„åŸºç¡€ï¼Œè®©ä½ ï¼š</p>
<ul>
<li>â€¢ å¼€å§‹æ„å»ºå®é™…é¡¹ç›®â€”â€”è¿™æ˜¯å­¦ä¹ è¿‡ç¨‹ä¸­æœ€é‡è¦çš„ç¯èŠ‚</li>
<li>â€¢ å‘ç°äººå·¥æ™ºèƒ½å·¥ç¨‹é¢†åŸŸä¸­æœ€å¸å¼•ä½ çš„æ–¹å‘ï¼Œä»¥ä¾¿ç»§ç»­ä½ çš„å­¦ä¹ æ—…ç¨‹</li>
</ul>
<h2 data-id="heading-3"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/>è¿ˆå‘ä¸“ä¸šäººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆ</h2>
<p>æ‹¥æœ‰æ‰å®çš„åŸºç¡€å¹¶å®Œæˆä¸€äº›å®é™…é¡¹ç›®åï¼Œä½ è‡ªç„¶ä¼šå¸Œæœ›æ·±åŒ–è‡ªå·±çš„çŸ¥è¯†ã€‚</p>
<p>æ­¤æ—¶ï¼Œé˜…è¯»å¥‡æ™®Â·èƒ¡æ©ï¼ˆChip Huyenï¼‰æ‰€è‘—çš„ã€Šäººå·¥æ™ºèƒ½å·¥ç¨‹ã€‹ï¼ˆAI Engineeringï¼‰æ˜¯ç»ä½³é€‰æ‹©ï¼Œè¯¥ä¹¦æ¶µç›–äº†æˆä¸ºä¸€åå®æˆ˜å‹äººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆæ‰€éœ€ç†è§£çš„å…¨éƒ¨å†…å®¹ã€‚é˜…è¯»è¿™æœ¬ä¹¦åŠå…¶å‚è€ƒæ–‡çŒ®ï¼Œèƒ½è®©ä½ åœ¨å­¦ä¹ é“è·¯ä¸Šç¨³æ­¥å‰è¡Œã€‚</p>
<p>é¡ºä¾¿è¯´ä¸€å¥â€”â€”æˆ‘åœ¨è‡ªå·±çš„YouTubeé¢‘é“ä¸Šåˆ¶ä½œäº†ä¸€ä¸ª76åˆ†é’Ÿçš„å®Œæ•´ç‰ˆæ€»ç»“è§†é¢‘ï¼Œæ‹†è§£äº†ä¹¦ä¸­æ‰€æœ‰å…³é”®æ¦‚å¿µã€‚ä½ å¯ä»¥åœ¨é˜…è¯»å‰è§‚çœ‹è¯¥è§†é¢‘è¿›è¡Œé¢„ä¹ ï¼Œä¹Ÿå¯ä»¥åœ¨é˜…è¯»åè§‚çœ‹ä»¥å·©å›ºå¤ä¹ ã€‚</p>
<p>éšç€ä½ å®Œæˆæ›´å¤šé¡¹ç›®ï¼Œå¹¶å­¦ä¹ è¯¸å¦‚å¥‡æ™®æ‰€è‘—ä¹¦ç±ç­‰èµ„æ–™ï¼Œä½ çš„æŠ€èƒ½ä¼šè‡ªç„¶æ‹“å±•ï¼Œé€æ¸æ¶µç›–ä»¥ä¸‹é¢†åŸŸï¼š</p>
<ul>
<li>â€¢Â <strong>æ·±åº¦å­¦ä¹ </strong>ï¼šç†è§£ç¥ç»ç½‘ç»œçš„å¤æ‚ç»†èŠ‚ã€è®­ç»ƒè¿‡ç¨‹ä»¥åŠåŸºç¡€æ¨¡å‹çš„å·¥ä½œåŸç†ã€‚å­¦ä¹ Transformeræ¶æ„ã€æ³¨æ„åŠ›æœºåˆ¶ï¼Œä»¥åŠåµŒå…¥æŠ€æœ¯å¦‚ä½•æ•æ‰è¯­ä¹‰ä¿¡æ¯ã€‚</li>
<li>â€¢Â <strong>éƒ¨ç½²ä¸åŸºç¡€è®¾æ–½</strong>ï¼šå­¦ä¹ ä½¿ç”¨Dockerè¿›è¡Œå®¹å™¨åŒ–ï¼Œä»¥åŠåœ¨AWSã€GCPã€Azureç­‰å¹³å°ä¸Šè¿›è¡Œäº‘éƒ¨ç½²ã€‚ç†è§£ç³»ç»Ÿæ¶æ„ã€ç›‘æ§å’Œæ—¥å¿—ç®¡ç†ã€‚</li>
<li>â€¢Â <strong>é«˜çº§RAGæŠ€æœ¯</strong>ï¼šå®ç°æ›´å¤æ‚çš„æ–‡æ¡£åˆ†å—ç­–ç•¥ï¼Œä¼˜åŒ–åµŒå…¥æŠ€æœ¯ï¼Œå¹¶ç†è§£ä¸åŒæ£€ç´¢æ–¹æ³•ä¹‹é—´çš„æƒè¡¡ã€‚</li>
<li>â€¢Â <strong>åŸºç¡€æ¨¡å‹åº”ç”¨</strong>ï¼šæŒæ¡ä½ç§©é€‚åº”ï¼ˆLoRAï¼‰ç­‰å¾®è°ƒæŠ€æœ¯ï¼Œå¹¶æ ¹æ®æˆæœ¬ã€æ€§èƒ½å’Œæˆæƒè®¸å¯ä¹‹é—´çš„æƒè¡¡ï¼Œåšå‡ºæ˜æ™ºçš„æ¨¡å‹é€‰æ‹©å†³ç­–ã€‚</li>
<li>â€¢Â <strong>æ„å»ºç¨³å¥çš„è¯„ä¼°ç³»ç»Ÿ</strong>ï¼šå»ºç«‹ç³»ç»ŸåŒ–çš„æ¨¡å‹æ€§èƒ½æµ‹è¯•æ–¹æ³•ï¼Œè¡¡é‡å¹»è§‰ç°è±¡ä¸åå·®ï¼Œå¹¶å®æ–½è‡ªåŠ¨åŒ–å’Œäººå·¥è¯„ä¼°æµç¨‹ã€‚</li>
<li>â€¢Â <strong>æ¨ç†ä¼˜åŒ–</strong>ï¼šé€šè¿‡é‡åŒ–ã€è’¸é¦ã€ä¼˜åŒ–éƒ¨ç½²æ¶æ„ç­‰æŠ€æœ¯ï¼Œæé«˜æ¨¡å‹è¿è¡Œé€Ÿåº¦å’Œæ•ˆç‡ã€‚</li>
<li>â€¢Â <strong>æ™ºèƒ½ä½“ç³»ç»Ÿ</strong>ï¼šæ„å»ºèƒ½å¤Ÿåˆ†è§£å¤æ‚ä»»åŠ¡ã€æœ‰æ•ˆä½¿ç”¨å·¥å…·ï¼Œå¹¶åœ¨é•¿æ—¶é—´äº¤äº’ä¸­ä¿æŒä¸Šä¸‹æ–‡çš„äººå·¥æ™ºèƒ½åº”ç”¨ã€‚</li>
<li>â€¢Â <strong>å®‰å…¨ã€éšç§ä¸ä¼¦ç†</strong>ï¼šå®æ–½é˜²èŒƒæç¤ºæ³¨å…¥ç­‰æ”»å‡»çš„é˜²æŠ¤æªæ–½ï¼Œç¡®ä¿éšç§åˆè§„ï¼Œå¹¶è€ƒé‡äººå·¥æ™ºèƒ½ç³»ç»Ÿçš„ä¼¦ç†å½±å“ã€‚</li>
</ul>
<p>åœ¨è¿™ä¸ªé˜¶æ®µï¼Œä½ æ­£ä»â€œä½¿ç”¨äººå·¥æ™ºèƒ½å·¥å…·â€å‘â€œç†è§£å·¥å…·å·¥ä½œåŸç†å¹¶é’ˆå¯¹ç‰¹å®šåœºæ™¯ä¼˜åŒ–å·¥å…·â€è½¬å˜ã€‚ä¸­çº§ä¸é«˜çº§äººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆçš„åŒºåˆ«ï¼Œå¾€å¾€å°±åœ¨äºæ˜¯å¦ç²¾é€šè¿™äº›é«˜çº§ä¸»é¢˜ã€‚æ²¡æœ‰è¿™äº›æŠ€èƒ½ï¼Œä½ å°†éš¾ä»¥æ„å»ºå…·å¤‡è§„æ¨¡åŒ–è¿è¥èƒ½åŠ›æˆ–èƒ½åº”å¯¹å¤æ‚å®é™…åœºæ™¯çš„ç³»ç»Ÿï¼›è€ŒæŒæ¡è¿™äº›æŠ€èƒ½åï¼Œä½ å°†æœ‰èµ„æ ¼åº”è˜é¡¶çº§å…¬å¸ä¸­ä»äº‹å‰æ²¿äººå·¥æ™ºèƒ½åº”ç”¨çš„å²—ä½â€”â€”è¿™ç±»å²—ä½çš„è–ªèµ„é€šå¸¸å¯è¾¾30ä¸‡è‡³40ä¸‡ç¾å…ƒã€‚</p>
<p>åœ¨è¿™ä¸ªé«˜çº§é˜¶æ®µï¼Œè¿˜æœ‰æ›´å¤šä¸“ä¸šæŠ€èƒ½éœ€è¦å­¦ä¹ â€”â€”ä»æ•°æ®é›†å·¥ç¨‹åˆ°åº”ç”¨æ¶æ„æ¨¡å¼ç­‰ã€‚</p>
<h2 data-id="heading-4"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/>åŠ¡å®çš„æ—¶é—´è§„åˆ’</h2>
<p>ä»è¿™ä»½å……æ»¡æŠ€æœ¯ç»†èŠ‚çš„æ¸…å•ä¸­ä¸éš¾çœ‹å‡ºï¼Œæƒ³ä»å®Œå…¨çš„åˆå­¦è€…åœ¨ä¸‰ä¸ªæœˆå†…æˆé•¿ä¸ºä¸“ä¸šäººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆï¼Œæ˜¯ä¸ç°å®çš„ã€‚ä»¥ä¸‹æ˜¯æ›´åŠ¡å®çš„æ—¶é—´è§„åˆ’ï¼š</p>
<ul>
<li>â€¢Â <strong>æŒæ¡åŸºç¡€å¹¶æ„å»ºé¦–ä¸ªäººå·¥æ™ºèƒ½åº”ç”¨</strong>ï¼šçº¦6ä¸ªæœˆï¼ˆå…¼èŒå­¦ä¹ ï¼‰<br/>
è¿™ä¸€å‰ææ˜¯ä½ èƒ½æŒç»­å­¦ä¹ ï¼Œä¸”å·²å…·å¤‡ä¸€å®šç¼–ç¨‹åŸºç¡€ã€‚å¦‚æœä»é›¶åŸºç¡€å¼€å§‹ï¼Œéœ€é¢å¤–å¢åŠ 6ä¸ªæœˆã€‚</li>
<li>â€¢Â <strong>ç†Ÿç»ƒæŒæ¡æ›´é«˜çº§æ¦‚å¿µ</strong>ï¼šå†éœ€6è‡³12ä¸ªæœˆ<br/>
åœ¨æ­¤æœŸé—´ï¼Œä½ åº”ä¸æ–­æ„å»ºæ›´å¤æ‚çš„é¡¹ç›®ï¼Œå¹¶æ·±åŒ–å¯¹åº•å±‚æŠ€æœ¯çš„ç†è§£ã€‚</li>
<li>â€¢Â <strong>è¾¾åˆ°ä¸“ä¸šæ°´å¹³</strong>ï¼šå†éœ€1è‡³2å¹´<br/>
è¿™ä¸€é˜¶æ®µï¼Œä½ å°†åŸ¹å…»åœ¨å¤§å‹å…¬å¸æˆ–é«˜çº§äººå·¥æ™ºèƒ½åº”ç”¨é¡¹ç›®ä¸­ä»»èŒæ‰€éœ€çš„ä¸“ä¸šæŠ€èƒ½ã€‚</li>
<li>â€¢Â <strong>æˆä¸ºé¡¶çº§å…¬å¸çš„é«˜çº§/ä¸»ç®¡çº§äººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆï¼ˆè–ªèµ„çœŸæ­£è¾¾åˆ°30ä¸‡ç¾å…ƒä»¥ä¸Šï¼‰</strong> ï¼šå†éœ€3è‡³5å¹´<br/>
è¦ç²¾é€šäººå·¥æ™ºèƒ½å·¥ç¨‹çš„å…¨é¢†åŸŸæŠ€èƒ½ï¼Œå¹¶ç§¯ç´¯é¢†å¯¼å¤æ‚é¡¹ç›®çš„ç»éªŒï¼Œéœ€è¦åœ¨è¯¥é¢†åŸŸæŠ•å…¥å¤§é‡æ—¶é—´ã€‚</li>
</ul>
<p>æ€»ä½“è€Œè¨€ï¼Œå¦‚æœä½ ä»é›¶åŸºç¡€å¼€å§‹ï¼Œä¸”ä»¥å…¼èŒæ–¹å¼å­¦ä¹ ï¼Œé¢„è®¡éœ€è¦3è‡³6å¹´æ‰èƒ½è¾¾æˆç›®æ ‡ã€‚</p>
<p>è¿™çœ‹èµ·æ¥æ—¶é—´å¾ˆé•¿ï¼Ÿç¡®å®å¦‚æ­¤ï¼Œä½†ä¹Ÿç¬¦åˆå®é™…æƒ…å†µã€‚</p>
<p>è¯·è®°ä½ï¼Œä½ å®Œå…¨å¯ä»¥æ›´æ—©åœ°å¼€å§‹æ„å»ºé¡¹ç›®ï¼Œç”šè‡³è¿›å…¥è¯¥é¢†åŸŸå·¥ä½œâ€”â€”æ— éœ€ç­‰åˆ°æŒæ¡æ‰€æœ‰æŠ€èƒ½æ‰è¡ŒåŠ¨ã€‚</p>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ«å†è¢«å‰²éŸ­èœï¼çœŸæ­£å…è´¹çš„Promptå­¦ä¹ è·¯å¾„ï¼Œ0åŸºç¡€ä¹Ÿèƒ½æŠ„]]></title>    <link>https://juejin.cn/post/7586957587076661298</link>    <guid>https://juejin.cn/post/7586957587076661298</guid>    <pubDate>2025-12-24T03:56:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586957587076661298" data-draft-id="7586954475657019438" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ«å†è¢«å‰²éŸ­èœï¼çœŸæ­£å…è´¹çš„Promptå­¦ä¹ è·¯å¾„ï¼Œ0åŸºç¡€ä¹Ÿèƒ½æŠ„"/> <meta itemprop="keywords" content="LLM,Agent,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-24T03:56:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AIå¤§æ¨¡å‹"/> <meta itemprop="url" content="https://juejin.cn/user/3817967696221534"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ«å†è¢«å‰²éŸ­èœï¼çœŸæ­£å…è´¹çš„Promptå­¦ä¹ è·¯å¾„ï¼Œ0åŸºç¡€ä¹Ÿèƒ½æŠ„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3817967696221534/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AIå¤§æ¨¡å‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T03:56:52.000Z" title="Wed Dec 24 2025 03:56:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>ã€‚</p>
</blockquote>
<p>ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰è¿™ç§æ„Ÿè§‰ï¼šæƒ³å­¦Promptï¼ˆæç¤ºè¯ï¼‰ï¼Œä½†ä¸€æœå°±æ‡µäº†ã€‚åˆ°å¤„éƒ½åœ¨å–è¯¾ï¼Œä»·æ ¼ä»å‡ ååˆ°å‡ åƒï¼Œä¸ªä¸ªéƒ½è¯´è‡ªå·±æ˜¯â€œç»ˆæç§˜ç±â€ï¼Œå­¦äº†å°±èƒ½â€œé©¾é©­AIï¼Œæ•ˆç‡ç¿»åå€â€ã€‚</p>
<p>ç‚¹è¿›å»ä¸€çœ‹ï¼Œè¦ä¹ˆæ˜¯é›¶æ•£çš„â€œå’’è¯­å¤§å…¨â€ï¼Œè¦ä¹ˆæ˜¯å †ç Œä¸€å †â€œé›¶æ ·æœ¬â€ã€â€œæ€ç»´é“¾â€ç­‰é»‘è¯ï¼Œçœ‹å®Œè¿˜æ˜¯ä¸çŸ¥é“ä»ä½•ä¸‹æ‰‹ã€‚ä½ éœ€è¦çš„æ˜æ˜æ˜¯ä¸€å¼ æ¸…æ™°çš„åœ°å›¾ï¼Œä»–ä»¬å´åªæƒ³å¡ç»™ä½ ä¸€å †ä¸çŸ¥æ‰€è°“çš„è—å®å›¾ç¢ç‰‡ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä½œä¸ºè¿™ä¸ªé¢†åŸŸçš„æ·±åº¦å®è·µè€…ï¼Œå°±ä¸ºä½ å½»åº•æ­ç©¿é‚£äº›â€œé€Ÿæˆç¥è¯â€ï¼Œå¹¶è§„åˆ’ä¸€æ¡<strong>çœŸæ­£å…è´¹ã€ç³»ç»Ÿã€0åŸºç¡€å¯è·ŸæŠ„çš„å­¦ä¹ è·¯å¾„</strong>ã€‚è¿™æ¡è·¯å¾„ä¸å–ä½ ç„¦è™‘ï¼Œåªç»™ä½ å¹²è´§ã€‚</p>
<h4 data-id="heading-0"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>ç¬¬ä¸€æ­¥ï¼šèŠ±1å°æ—¶ï¼Œå»ºç«‹è®¤çŸ¥åœ°åŸºï¼ˆå…è´¹ï¼‰</strong></h4>
<p>åˆ«å†æ­»è®°ç¡¬èƒŒâ€œå’’è¯­â€äº†ã€‚åœ¨å­¦ä»»ä½•æŠ€å·§å‰ï¼Œä½ éœ€è¦å…ˆç†è§£AIæ˜¯å¦‚ä½•â€œæ€è€ƒâ€çš„ã€‚è¿™èƒ½å¸®ä½ æœªæ¥çœä¸‹æ•°ç™¾å°æ—¶çš„è¯•é”™æ—¶é—´ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒåŸåˆ™ï¼šå­¦ä¹ CLEARæ¡†æ¶</strong><br/>
è¿™æ˜¯æ¥è‡ªå›¾ä¹¦é¦†ä¿¡æ¯ç§‘å­¦é¢†åŸŸçš„ä¸“ä¸šæ¡†æ¶ï¼Œæå…¶ç®€æ´æœ‰æ•ˆï¼Œèƒ½ç«‹åˆ»æå‡ä½ çš„æé—®è´¨é‡ï¼š</li>
</ul>

<ul>
<li><strong>C (ç®€æ´æ¸…æ™°)</strong> ï¼šå»æ‰åºŸè¯ï¼Œèšç„¦å…³é”®è¯ã€‚</li>
<li><strong>L (é€»è¾‘)</strong> ï¼šè®©é—®é¢˜çš„é¡ºåºç¬¦åˆé€»è¾‘ã€‚</li>
<li><strong>E (æ˜ç¡®)</strong> ï¼šæ˜ç¡®è¯´æ˜ä½ æƒ³è¦çš„ç­”æ¡ˆå½¢å¼ï¼ˆå¦‚åˆ—è¡¨ã€åˆ†æã€ä»£ç ï¼‰ã€‚</li>
<li><strong>A (é€‚åº”)</strong> ï¼šæ ¹æ®AIçš„ç¬¬ä¸€æ¬¡å›ç­”ï¼Œè°ƒæ•´ä½ çš„ä¸‹ä¸€æ¬¡æé—®ã€‚</li>
<li><strong>R (åæ€)</strong> ï¼šæ‰¹åˆ¤æ€§åœ°å®¡è§†AIçš„ç­”æ¡ˆï¼Œæ£€æŸ¥å…¶äº‹å®å’Œé€»è¾‘ã€‚</li>
</ul>

<ul>
<li><strong>åŠ¨æ‰‹ä»»åŠ¡</strong>ï¼š<br/>
æ‰“å¼€ä»»æ„ä¸€ä¸ªAIå¯¹è¯å·¥å…·ï¼Œç”¨åŒä¸€ä¸ªé—®é¢˜ï¼Œåˆ†åˆ«ç”¨æ¨¡ç³Šæé—®ï¼ˆå¦‚â€œæ€ä¹ˆå†™å¥½æ–‡æ¡ˆâ€ï¼‰å’Œè¿ç”¨CLEARåŸåˆ™çš„æé—®ï¼ˆå¦‚â€œä½œä¸ºæœ‰3å¹´ç»éªŒçš„æ–°åª’ä½“è¿è¥ï¼Œè¯·ä¸ºæˆ‘å³å°†ä¸Šå¸‚çš„æ™ºèƒ½æ°´æ¯å†™3ä¸ªå°çº¢ä¹¦æ–‡æ¡ˆå¼€å¤´ï¼Œè¦æ±‚æŠ“ä½å¹´è½»å¥³æ€§çš„å¥åº·ç„¦è™‘ç—›ç‚¹ï¼Œé£æ ¼æ´»æ³¼â€ï¼‰å„é—®ä¸€æ¬¡ã€‚ç›´è§‚æ„Ÿå—å…¶ä¸­çš„å·¨å¤§å·®å¼‚ã€‚</li>
</ul>
<h4 data-id="heading-1"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>ç¬¬äºŒæ­¥ï¼šç”¨3å¤©ï¼Œå®Œæˆä¸€é—¨ç³»ç»Ÿæ€§å…è´¹æ•™ç¨‹ï¼ˆå…è´¹ï¼‰</strong></h4>
<h4 data-id="heading-2"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></h4>
<p>åœ°åŸºæ‰“å¥½ï¼Œå°±è¯¥ç³»ç»Ÿå­¦ä¹ å»ºç­‘æ–¹æ³•äº†ã€‚è¿™é‡Œå¼ºçƒˆæ¨èä¸¤ä¸ªå®Œå…¨å…è´¹ã€è´¨é‡æé«˜çš„é€‰æ‹©ï¼š</p>
<ol>
<li><strong>å´æ©è¾¾ã€ŠChatGPTæç¤ºè¯å·¥ç¨‹ã€‹ä¸­æ–‡ç‰ˆ</strong>ï¼šç”±AIæ•™è‚²å·¨å¤´DeepLearning.aiå®˜æ–¹å‡ºå“ï¼Œå ªç§°è¡Œä¸šåœ£ç»ã€‚å›½å†…DataWhaleå›¢é˜Ÿå·²å°†å…¶å®Œæ•´ç¿»è¯‘ä¸ºä¸­æ–‡ï¼Œå¹¶æä¾›PDFå’Œåœ¨çº¿é˜…è¯»ã€‚è¿™é—¨è¯¾çŸ­å°ç²¾æ‚ï¼Œèƒ½å¸¦ä½ å¿«é€Ÿç†è§£â€œæ€ç»´é“¾â€ï¼ˆChain-of-Thoughtï¼‰ç­‰æ ¸å¿ƒæŠ€æœ¯çš„åŸç†ä¸åº”ç”¨ã€‚</li>
<li><strong>å¼€æºæ•™ç¨‹ã€ŠLearning Promptã€‹</strong> ï¼šè¿™æ˜¯ä¸€ä»½ç”±å›½å†…å¼€å‘è€…ç»´æŠ¤çš„å…è´¹ã€å¼€æºæ•™ç¨‹ï¼Œè¦†ç›–ChatGPTå’ŒMidjourneyï¼Œå†…å®¹æŒç»­æ›´æ–°ï¼Œè¯­è¨€éå¸¸å‹å¥½ã€‚å®ƒçš„ä¼˜åŠ¿åœ¨äºæ›´è´´è¿‘å›½å†…ç”¨æˆ·çš„å¸¸ç”¨åœºæ™¯å’Œè¡¨è¾¾ä¹ æƒ¯ã€‚</li>
</ol>
<p><strong>è·¯çº¿å»ºè®®</strong>ï¼šé›¶åŸºç¡€æˆ–æƒ³å»ºç«‹å®Œæ•´çŸ¥è¯†ä½“ç³»çš„åŒå­¦ï¼Œä¼˜å…ˆå­¦Â  <strong>ã€ŠLearning Promptã€‹</strong> Â ã€‚å·²æœ‰ä¸€å®šåŸºç¡€ï¼Œæƒ³æ·±å…¥ç†è§£åŸç†çš„ï¼Œç²¾å­¦Â <strong>å´æ©è¾¾è¯¾ç¨‹</strong>Â ã€‚</p>
<h4 data-id="heading-3"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>ç¬¬ä¸‰æ­¥ï¼šå®è·µ2å‘¨ï¼Œåœ¨çœŸå®é¡¹ç›®ä¸­å†…åŒ–æŠ€èƒ½ï¼ˆå…è´¹ï¼‰</strong></h4>
<p>å­¦å®Œç†è®ºï¼Œä¸å®è·µç­‰äºé›¶ã€‚ç°åœ¨ï¼Œä½ éœ€è¦ä¸ºè‡ªå·±åˆ›é€ å®æˆ˜åœºæ™¯ã€‚</p>
<ul>
<li><strong>å¯åŠ¨â€œä¸ªäººæ•ˆç‡æå‡â€é¡¹ç›®</strong>ï¼š</li>
</ul>

<ul>
<li><strong>å‘¨ä¸€è‡³å‘¨äº”</strong>ï¼šæ¯å¤©ç”¨AIå¤„ç†ä¸€é¡¹å®é™…å·¥ä½œã€‚ä¾‹å¦‚ï¼šå‘¨ä¸€å†™å·¥ä½œå‘¨æŠ¥ã€å‘¨äºŒç”Ÿæˆç­–åˆ’æ¡ˆæ¡†æ¶ã€å‘¨ä¸‰æ¶¦è‰²å®¢æˆ·é‚®ä»¶ã€å‘¨å››åˆ†æä¸€ä»½æ•°æ®è¡¨æ ¼ã€å‘¨äº”ä¸ºå‘¨æœ«æ—…è¡Œåšæ”»ç•¥ã€‚</li>
<li><strong>å…³é”®åŠ¨ä½œ</strong>ï¼šæ¯æ¬¡å¯¹è¯åï¼Œ<strong>åŠ¡å¿…ä¿å­˜ä½ ä½¿ç”¨çš„æœ€ç»ˆç‰ˆPromptå’ŒAIçš„å›å¤</strong>ã€‚å»ºç«‹ä½ è‡ªå·±çš„â€œPromptæ­¦å™¨åº“â€å’Œæ¡ˆä¾‹åº“ã€‚</li>
</ul>

<ul>
<li><strong>å‚ä¸å¼€æºé¡¹ç›®ï¼Œè¿›è¡Œâ€œæé™æŒ‘æˆ˜â€</strong> ï¼š<br/>
åœ¨GitHubä¸Šæœç´¢â€œawesome-promptsâ€æˆ–â€œprompt-engineeringâ€ç­‰å…³é”®è¯ï¼Œä½ ä¼šå‘ç°å¤§é‡å¼€æºé¡¹ç›®ã€‚å°è¯•å»å¤ç°ã€æ”¹è¿›å…¶ä¸­çš„ä¾‹å­ï¼Œç”šè‡³æäº¤ä½ çš„ç‰ˆæœ¬ã€‚è¿™ä¸ªè¿‡ç¨‹èƒ½è®©ä½ æ¥è§¦åˆ°æœ€å‰æ²¿çš„å®è·µã€‚</li>
</ul>
<h4 data-id="heading-4"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><strong>ç¬¬å››æ­¥ï¼šæŒç»­è¿­ä»£ï¼Œèå…¥åœˆå­ï¼ˆå…è´¹ï¼‰</strong></h4>
<p>Promptå·¥ç¨‹æ˜¯é—¨å®è·µå­¦ç§‘ï¼Œé—­é—¨é€ è½¦æ•ˆç‡æœ€ä½ã€‚</p>
<ul>
<li><strong>å»ºç«‹å¤ç›˜æœºåˆ¶</strong>ï¼šæ¯å‘¨å›é¡¾ä½ çš„â€œæ­¦å™¨åº“â€ï¼Œæ€è€ƒï¼šå“ªäº›Promptç™¾è¯•ç™¾çµï¼Ÿå“ªäº›åœºæ™¯ä¸‹AIæ€»æ˜¯è·‘åï¼Ÿå¦‚ä½•ä¼˜åŒ–ï¼Ÿ</li>
<li><strong>èå…¥å…è´¹ç¤¾åŒº</strong>ï¼šåœ¨GitHubã€Discordã€Redditæˆ–ä¸€äº›é«˜è´¨é‡çš„AIçŸ¥è¯†æ˜Ÿçƒï¼ˆæœ‰å…è´¹ä¸“åŒºï¼‰é‡Œï¼Œå…³æ³¨ç›¸å…³çš„è®¨è®ºã€‚çœ‹åˆ«äººå¦‚ä½•è§£å†³ä½ é‡åˆ°è¿‡çš„éš¾é¢˜ï¼Œæ˜¯æœ€é«˜æ•ˆçš„å­¦ä¹ æ–¹å¼ã€‚</li>
</ul>
<p><strong>è¡¥å……</strong></p>
<p>çœ‹åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½å‘ç°ï¼Œè¿™æ¡å…è´¹è·¯å¾„<strong>æ¸…æ™°ã€æœ‰æ•ˆï¼Œä½†éœ€è¦ä½ æå¼ºçš„è‡ªå¾‹ã€ä¿¡æ¯ç­›é€‰èƒ½åŠ›å’Œè§£å†³é—®é¢˜çš„æ¯…åŠ›</strong>ã€‚å®ƒè§£å†³çš„æ˜¯â€œä»0åˆ°60åˆ†â€çš„é—®é¢˜ã€‚</p>
<p>é‚£ä¹ˆï¼Œä»˜è´¹è¯¾ç¨‹çš„ä»·å€¼åœ¨å“ªé‡Œï¼Ÿå®ƒåº”è¯¥è§£å†³çš„æ˜¯å…è´¹è·¯å¾„ä¸­çš„æ ¸å¿ƒç—›ç‚¹ï¼š</p>
<ol>
<li><strong>èŠ‚çœæ—¶é—´ä¸é™ä½ç­›é€‰æˆæœ¬</strong>ï¼šè®²å¸ˆæ›¿ä½ æ¶ˆåŒ–äº†æµ·é‡ä¿¡æ¯ï¼Œå°†æœ€æ ¸å¿ƒçš„20%å†…å®¹ç³»ç»ŸåŒ–åœ°äº¤ä»˜ç»™ä½ ï¼Œå¸¦ä½ ç›´è¾¾80åˆ†ã€‚</li>
<li><strong>æä¾›â€œæ•™ç»ƒå¼â€åé¦ˆä¸äº’åŠ¨</strong>ï¼šå½“ä½ å†™å‡ºä¸€ä¸ªè¹©è„šçš„Promptæ—¶ï¼Œå…è´¹è·¯å¾„åªèƒ½é ä½ è‡ªå·±ç¢ç£¨ã€‚è€Œå¥½çš„è¯¾ç¨‹åº”æä¾›ä½œä¸šæ‰¹æ”¹ã€ç­”ç–‘äº’åŠ¨ï¼Œç›´æ¥æŒ‡å‡ºä½ çš„ç›²åŒºï¼Œè¿™æ˜¯æ— ä»·çš„ã€‚</li>
<li><strong>é¡¹ç›®é©±åŠ¨ä¸å®æˆ˜ç¯å¢ƒ</strong>ï¼šç‹¬è‡ªç»ƒä¹ å®¹æ˜“é™·å…¥é‡å¤ã€‚ä¼˜ç§€çš„è¯¾ç¨‹ä¼šè®¾è®¡çœŸå®çš„å•†ä¸šé¡¹ç›®ï¼ˆå¦‚æ­å»ºä¸€ä¸ªæ™ºèƒ½å®¢æœåŸå‹ã€åˆ›å»ºä¸€ä¸ªè¥é”€æ–‡æ¡ˆç”Ÿæˆå™¨ï¼‰ï¼Œè®©ä½ åœ¨è§£å†³å¤æ‚é—®é¢˜çš„è¿‡ç¨‹ä¸­ï¼Œèä¼šè´¯é€šæ‰€æœ‰æŠ€å·§ã€‚</li>
<li><strong>æ„å»ºé«˜è´¨é‡äººè„‰åœˆ</strong>ï¼šå’Œä¸€ç¾¤æ°´å¹³ç›¸å½“ã€ç›®æ ‡ä¸€è‡´çš„åŒè¡Œè€…ä¸€èµ·å­¦ä¹ ã€äº¤æµã€ç”šè‡³åˆä½œï¼Œå…¶å¸¦æ¥çš„å¯å‘å’Œæœºä¼šï¼Œè¿œè¶…è¯¾ç¨‹å†…å®¹æœ¬èº«ã€‚</li>
</ol>
<p><strong>æ‰€ä»¥ï¼ŒçœŸæ­£çš„â€œå‰²éŸ­èœâ€ï¼Œæ˜¯å–ç»™ä½ ä¸€å †ç½‘ä¸Šèƒ½æ‰¾åˆ°çš„å…è´¹ä¿¡æ¯ï¼Œç„¶ååŒ…è£…æˆâ€œç§˜ç¬ˆâ€ã€‚è€ŒçœŸæ­£æœ‰ä»·å€¼çš„ä»˜è´¹è¯¾ç¨‹ï¼Œå–çš„ä»æ¥ä¸æ˜¯ä¿¡æ¯ï¼Œè€Œæ˜¯ç»è¿‡éªŒè¯çš„â€œç³»ç»Ÿæ–¹æ³•è®ºâ€ã€é«˜è´¨é‡çš„â€œåé¦ˆç¯å¢ƒâ€å’Œå®è´µçš„â€œå®è·µç»éªŒåœºâ€ã€‚</strong></p>
<p>å¯¹äºå­¦ä¹ è€…ï¼Œæˆ‘çš„æœ€ç»ˆå»ºè®®æ˜¯ï¼š<strong>å…ˆå…¨åŠ›ä»¥èµ´èµ°å®Œä¸Šè¿°å…è´¹è·¯å¾„ã€‚</strong> Â å¦‚æœä½ èƒ½é è‡ªå·±èµ°åˆ°ç¬¬ä¸‰æ­¥å¹¶ä¹åœ¨å…¶ä¸­ï¼Œä½ å¾ˆå¯èƒ½å·²ç»è¶…è¶Šäº†90%çš„æ™®é€šç”¨æˆ·ã€‚æ­¤æ—¶ï¼Œå¦‚æœä½ æ¸´æœ›è§£å†³æ›´å¤æ‚çš„å®é™…é—®é¢˜ã€è¿½æ±‚ä¸“ä¸šå±‚é¢çš„çªç ´ï¼Œå†æ ¹æ®è‡ªå·±çš„ç›®æ ‡å’Œè–„å¼±ç¯èŠ‚ï¼Œå»ç²¾å‡†åœ°å¯»æ‰¾èƒ½ä¸ºä½ æä¾›â€œé¡¹ç›®å®æˆ˜â€å’Œâ€œä¸“ä¸šåé¦ˆâ€çš„è¿›é˜¶è¯¾ç¨‹ã€‚</p>
<p>è¿™æ¡è·¯ï¼Œæ²¡æœ‰é­”æ³•ã€‚ä½†å®ƒçœŸå®ã€æœ‰æ•ˆï¼Œå¹¶ä¸”è‡ªç”±çš„å¤§é—¨ï¼Œä»ä¸€å¼€å§‹å°±ä¸ºä½ æ•å¼€ã€‚</p>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Qwen3-8B vLLM éƒ¨ç½²å®è·µæ•™ç¨‹ï¼ˆAutoDL å¹³å°ï¼‰]]></title>    <link>https://juejin.cn/post/7586872817876303898</link>    <guid>https://juejin.cn/post/7586872817876303898</guid>    <pubDate>2025-12-23T16:28:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586872817876303898" data-draft-id="7586865729703919654" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Qwen3-8B vLLM éƒ¨ç½²å®è·µæ•™ç¨‹ï¼ˆAutoDL å¹³å°ï¼‰"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-23T16:28:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Miku16"/> <meta itemprop="url" content="https://juejin.cn/user/525983678469801"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Qwen3-8B vLLM éƒ¨ç½²å®è·µæ•™ç¨‹ï¼ˆAutoDL å¹³å°ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/525983678469801/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Miku16
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-23T16:28:21.000Z" title="Tue Dec 23 2025 16:28:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Qwen3-8B vLLM éƒ¨ç½²å®è·µæ•™ç¨‹ï¼ˆAutoDL å¹³å°ï¼‰</h2>
<blockquote>
<p><strong>å®è·µæ—¥æœŸ</strong>ï¼š2025å¹´12æœˆ23æ—¥
<strong>vLLM ç‰ˆæœ¬</strong>ï¼š0.8.5.post1
<strong>æ¨¡å‹</strong>ï¼šQwen3-8B
<strong>å¹³å°</strong>ï¼šAutoDLï¼ˆRTX 4090 24GBï¼‰
<strong>å‚è€ƒæ•™ç¨‹</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdatawhalechina%2Fself-llm%2Fblob%2Fmaster%2Fmodels%2FQwen3%2F02-Qwen3-8B-vLLM%2520%25E9%2583%25A8%25E7%25BD%25B2%25E8%25B0%2583%25E7%2594%25A8.md" target="_blank" title="https://github.com/datawhalechina/self-llm/blob/master/models/Qwen3/02-Qwen3-8B-vLLM%20%E9%83%A8%E7%BD%B2%E8%B0%83%E7%94%A8.md" ref="nofollow noopener noreferrer">github.com/datawhalechâ€¦</a></p>
</blockquote>
<hr/>
<h3 data-id="heading-1">ç›®å½•</h3>
<ol>
<li><a href="#1-%E9%A1%B9%E7%9B%AE%E6%A6%82%E8%BF%B0" title="#1-%E9%A1%B9%E7%9B%AE%E6%A6%82%E8%BF%B0">é¡¹ç›®æ¦‚è¿°</a></li>
<li><a href="#2-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87" title="#2-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87">ç¯å¢ƒå‡†å¤‡</a></li>
<li><a href="#3-%E8%BF%9E%E6%8E%A5%E6%9C%8D%E5%8A%A1%E5%99%A8" title="#3-%E8%BF%9E%E6%8E%A5%E6%9C%8D%E5%8A%A1%E5%99%A8">è¿æ¥æœåŠ¡å™¨</a></li>
<li><a href="#4-%E7%8E%AF%E5%A2%83%E4%BF%AE%E5%A4%8D" title="#4-%E7%8E%AF%E5%A2%83%E4%BF%AE%E5%A4%8D">ç¯å¢ƒä¿®å¤</a></li>
<li><a href="#5-%E6%A8%A1%E5%9E%8B%E4%B8%8B%E8%BD%BD" title="#5-%E6%A8%A1%E5%9E%8B%E4%B8%8B%E8%BD%BD">æ¨¡å‹ä¸‹è½½</a></li>
<li><a href="#6-python%E8%84%9A%E6%9C%AC%E6%8E%A8%E7%90%86" title="#6-python%E8%84%9A%E6%9C%AC%E6%8E%A8%E7%90%86">Pythonè„šæœ¬æ¨ç†</a></li>
<li><a href="#7-%E5%90%AF%E5%8A%A8api%E6%9C%8D%E5%8A%A1%E5%99%A8" title="#7-%E5%90%AF%E5%8A%A8api%E6%9C%8D%E5%8A%A1%E5%99%A8">å¯åŠ¨APIæœåŠ¡å™¨</a></li>
<li><a href="#8-api%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95" title="#8-api%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95">APIæ¥å£æµ‹è¯•</a></li>
<li><a href="#9-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3" title="#9-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3">å¸¸è§é—®é¢˜ä¸è§£å†³</a></li>
<li><a href="#10-%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93" title="#10-%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93">å­¦ä¹ æ€»ç»“</a></li>
</ol>
<hr/>
<h3 data-id="heading-2">1. é¡¹ç›®æ¦‚è¿°</h3>
<h4 data-id="heading-3">1.1 ä»€ä¹ˆæ˜¯ vLLMï¼Ÿ</h4>
<p><strong>vLLM</strong>ï¼ˆVectorized Large Language Modelï¼‰æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„å¤§è¯­è¨€æ¨¡å‹æ¨ç†å¼•æ“ï¼Œç”±åŠ å·å¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡å¼€å‘ã€‚</p>
<h5 data-id="heading-4">vLLM çš„æ ¸å¿ƒä¼˜åŠ¿</h5>

























<table><thead><tr><th>ç‰¹æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>PagedAttention</strong></td><td>åˆ›æ–°çš„æ³¨æ„åŠ›æœºåˆ¶ï¼Œæ˜¾è‘—å‡å°‘æ˜¾å­˜å ç”¨</td></tr><tr><td><strong>é«˜ååé‡</strong></td><td>æ¯” Hugging Face Transformers å¿« 10-24 å€</td></tr><tr><td><strong>OpenAI å…¼å®¹ API</strong></td><td>å¯ä»¥ç›´æ¥æ›¿æ¢ OpenAI APIï¼Œæ— éœ€ä¿®æ”¹ä»£ç </td></tr><tr><td><strong>è¿ç»­æ‰¹å¤„ç†</strong></td><td>è‡ªåŠ¨åˆå¹¶å¤šä¸ªè¯·æ±‚ï¼Œæé«˜ GPU åˆ©ç”¨ç‡</td></tr></tbody></table>
<h4 data-id="heading-5">1.2 ä»€ä¹ˆæ˜¯ Qwen3-8Bï¼Ÿ</h4>
<p><strong>Qwen3-8B</strong> æ˜¯é˜¿é‡Œäº‘é€šä¹‰åƒé—®å›¢é˜Ÿå‘å¸ƒçš„ç¬¬ä¸‰ä»£å¤§è¯­è¨€æ¨¡å‹ï¼Œæ‹¥æœ‰ 80 äº¿å‚æ•°ã€‚</p>
<h5 data-id="heading-6">Qwen3 çš„ç‰¹è‰²åŠŸèƒ½</h5>
<ul>
<li><strong>æ€è€ƒæ¨¡å¼ï¼ˆThinking Modeï¼‰</strong>ï¼šæ¨¡å‹ä¼šå…ˆè¿›è¡Œæ¨ç†æ€è€ƒï¼Œå†ç»™å‡ºç­”æ¡ˆ</li>
<li><strong>å¤šè¯­è¨€æ”¯æŒ</strong>ï¼šæ”¯æŒä¸­æ–‡ã€è‹±æ–‡ç­‰å¤šç§è¯­è¨€</li>
<li><strong>é•¿ä¸Šä¸‹æ–‡</strong>ï¼šæ”¯æŒ 32K ç”šè‡³æ›´é•¿çš„ä¸Šä¸‹æ–‡çª—å£</li>
</ul>
<h4 data-id="heading-7">1.3 ä¸ºä»€ä¹ˆé€‰æ‹© AutoDLï¼Ÿ</h4>

























<table><thead><tr><th>å¹³å°</th><th>ä¼˜åŠ¿</th><th>åŠ£åŠ¿</th></tr></thead><tbody><tr><td><strong>Google Colab</strong></td><td>å…è´¹ã€æ˜“ç”¨</td><td>vLLM å¤šè¿›ç¨‹ä¸å…¼å®¹</td></tr><tr><td><strong>AutoDL</strong></td><td>å›½å†…è®¿é—®å¿«ã€æŒ‰å°æ—¶è®¡è´¹ã€ç¯å¢ƒç¨³å®š</td><td>éœ€è¦ä»˜è´¹</td></tr><tr><td><strong>Kaggle</strong></td><td>å…è´¹ GPU</td><td>ç½‘ç»œé™åˆ¶ã€æ—¶é—´é™åˆ¶</td></tr></tbody></table>
<p>æœ¬æ•™ç¨‹é€‰æ‹© <strong>AutoDL</strong> æ˜¯å› ä¸ºï¼š</p>
<ol>
<li>vLLM åœ¨ Jupyter Notebook ç¯å¢ƒä¸­å­˜åœ¨å¤šè¿›ç¨‹å…¼å®¹é—®é¢˜</li>
<li>AutoDL æä¾›å®Œæ•´çš„ Linux ç»ˆç«¯ç¯å¢ƒ</li>
<li>å›½å†…è®¿é—® ModelScope ä¸‹è½½æ¨¡å‹æ›´å¿«</li>
</ol>
<hr/>
<h3 data-id="heading-8">2. ç¯å¢ƒå‡†å¤‡</h3>
<h4 data-id="heading-9">2.1 æ³¨å†Œ AutoDL è´¦å·</h4>
<ol>
<li>è®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.autodl.com%2F" target="_blank" title="https://www.autodl.com/" ref="nofollow noopener noreferrer">AutoDL å®˜ç½‘</a></li>
<li>æ³¨å†Œå¹¶å®Œæˆå®åè®¤è¯</li>
<li>å……å€¼ï¼ˆå»ºè®®å…ˆå…… 10-20 å…ƒæµ‹è¯•ï¼‰</li>
</ol>
<h4 data-id="heading-10">2.2 åˆ›å»ºå®ä¾‹</h4>
<p>DataWhaleåœ¨ AutoDL å¹³å°å‡†å¤‡çš„ Qwen3 çš„ç¯å¢ƒé•œåƒï¼Œç‚¹å‡»ä¸‹æ–¹é“¾æ¥å¹¶ç›´æ¥åˆ›å»º Autodl ç¤ºä¾‹å³å¯ã€‚ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.codewithgpu.com%2Fi%2Fdatawhalechina%2Fself-llm%2FQwen3" target="_blank" title="https://www.codewithgpu.com/i/datawhalechina/self-llm/Qwen3" ref="nofollow noopener noreferrer">www.codewithgpu.com/i/datawhaleâ€¦</a></p>
<h5 data-id="heading-11">æ­¥éª¤ 1ï¼šé€‰æ‹© GPU</h5>
<p>åœ¨ AutoDL æ§åˆ¶å°ï¼Œç‚¹å‡»"ç§Ÿç”¨æ–°å®ä¾‹"ï¼Œé€‰æ‹© GPUï¼š</p>



































<table><thead><tr><th>GPU å‹å·</th><th>æ˜¾å­˜</th><th>ä»·æ ¼ï¼ˆå‚è€ƒï¼‰</th><th>æ˜¯å¦è¶³å¤Ÿ</th></tr></thead><tbody><tr><td>RTX 4090</td><td>24GB</td><td>~2å…ƒ/å°æ—¶</td><td>æ¨è</td></tr><tr><td>RTX 3090</td><td>24GB</td><td>~1.5å…ƒ/å°æ—¶</td><td>å¯ç”¨</td></tr><tr><td>A100 40GB</td><td>40GB</td><td>~4å…ƒ/å°æ—¶</td><td>å……è£•</td></tr><tr><td>RTX 3080</td><td>10GB</td><td>~0.8å…ƒ/å°æ—¶</td><td>ä¸å¤Ÿ</td></tr></tbody></table>
<blockquote>
<p><strong>æ˜¾å­˜éœ€æ±‚è¯´æ˜</strong>ï¼šQwen3-8B ä½¿ç”¨ float16 ç²¾åº¦çº¦éœ€ 16GB æ˜¾å­˜ï¼ŒåŠ ä¸Š KV Cache ç­‰å¼€é”€ï¼Œå»ºè®®è‡³å°‘ 24GBã€‚</p>
</blockquote>
<h5 data-id="heading-12">æ­¥éª¤ 2ï¼šé€‰æ‹©é•œåƒ</h5>
<p>é€‰æ‹©ç¤¾åŒºé•œåƒï¼š<code>datawhalechina/self-llm/Qwen3:v1</code></p>
<p>è¿™ä¸ªé•œåƒé¢„è£…äº†ï¼š</p>
<ul>
<li>Python 3.12</li>
<li>PyTorch + CUDA</li>
<li>vLLM 0.8.5</li>
<li>Transformers</li>
<li>ModelScope</li>
</ul>
<p><strong>ã€æˆªå›¾ï¼šAutoDL å®ä¾‹åˆ›å»ºé¡µé¢ - GPUå’Œé•œåƒé€‰æ‹©ã€‘</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a0320ef4c9e84058ad68e94ad2849148~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=5EcJsuesBWfWdegFhAHaacbyU2U%3D" alt="alt text" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ccf09025b6054f44b9c902c0e814023c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=15CGa4%2FUB9eJu99tISJt9Pr85n0%3D" alt="alt text" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/08935a089a6f43ec8fe8709e6e919f57~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=RZyTFLZi2HtsjBlI9KI1LTFmimk%3D" alt="alt text" loading="lazy"/></p>
<h5 data-id="heading-13">æ­¥éª¤ 3ï¼šåˆ›å»ºå®ä¾‹</h5>
<p>ç‚¹å‡»"ç«‹å³åˆ›å»º"ï¼Œç­‰å¾…å®ä¾‹å¯åŠ¨ï¼ˆé€šå¸¸ 1-2 åˆ†é’Ÿï¼‰ã€‚</p>
<hr/>
<h3 data-id="heading-14">3. è¿æ¥æœåŠ¡å™¨</h3>
<h4 data-id="heading-15">3.1 è·å– SSH è¿æ¥ä¿¡æ¯</h4>
<p>å®ä¾‹åˆ›å»ºæˆåŠŸåï¼Œåœ¨æ§åˆ¶å°å¯ä»¥çœ‹åˆ°â€œSSHç™»å½•â€åˆ—ï¼Œå¤åˆ¶å…¶ä¸­çš„ç™»å½•æŒ‡ä»¤å’Œå¯†ç ï¼Œå¯ä»¥è·å¾—ä¸‹åˆ—ä¿¡æ¯ã€‚</p>
<ul>
<li><strong>SSH åœ°å€</strong>ï¼šä¾‹å¦‚ <code>region-1.autodl.pro</code></li>
<li><strong>SSH ç«¯å£</strong>ï¼šä¾‹å¦‚ <code>12345</code></li>
<li><strong>ç”¨æˆ·å</strong>ï¼š<code>root</code></li>
<li><strong>å¯†ç </strong>ï¼šåˆ›å»ºæ—¶è®¾ç½®çš„å¯†ç </li>
</ul>
<h4 data-id="heading-16">3.2 ä½¿ç”¨ VS Code è¿œç¨‹è¿æ¥ï¼ˆæ¨èï¼‰</h4>
<h5 data-id="heading-17">æ­¥éª¤ 1ï¼šå®‰è£… Remote-SSH æ‰©å±•</h5>
<p>åœ¨ VS Code ä¸­å®‰è£… <code>Remote - SSH</code> æ‰©å±•ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a2c595973a7d42f0b4bb91d9535a395d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=G0Ich5yx9SUviq3zaIXWEzGp%2F7E%3D" alt="alt text" loading="lazy"/></p>
<h5 data-id="heading-18">æ­¥éª¤ 2ï¼šé…ç½® SSH</h5>
<p>æŒ‰ <code>Ctrl+Shift+P</code>ï¼Œè¾“å…¥ <code>Remote-SSH: Open SSH Configuration File</code>ï¼Œé€‰æ‹©ç”¨æˆ·ç›®å½•ä¸‹çš„ config æ–‡ä»¶ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/78885005e7f444c3b088e2f86dc200b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=fDE%2B%2BN1GLFAbGajeQ1AWnkbFd1g%3D" alt="alt text" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/28ab8a26a318427693e493fdfd78ca04~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=4piVtC%2BTHtLUaB0%2FP8OxjRoqg30%3D" alt="alt text" loading="lazy"/></p>
<p>æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š</p>
<pre><code class="hljs language-ssh-config" lang="ssh-config"># ============================================================
# SSH é…ç½®æ–‡ä»¶è¯´æ˜
# ============================================================
#
# ã€æ–‡ä»¶ä½ç½®ã€‘
# Windows: C:\Users\ç”¨æˆ·å\.ssh\config
# Linux/Mac: ~/.ssh/config
#
# ã€é…ç½®æ ¼å¼è¯´æ˜ã€‘
# Host: è¿æ¥çš„åˆ«åï¼Œå¯ä»¥è‡ªå®šä¹‰ï¼Œæ–¹ä¾¿è®°å¿†
# HostName: æœåŠ¡å™¨çœŸå®åœ°å€ï¼ˆä» AutoDL æ§åˆ¶å°è·å–ï¼‰
# Port: SSH ç«¯å£å·ï¼ˆä» AutoDL æ§åˆ¶å°è·å–ï¼‰
# User: ç™»å½•ç”¨æˆ·åï¼ŒAutoDL é»˜è®¤æ˜¯ root
# ============================================================

Host autodl-qwen3
    HostName region-1.autodl.pro
    Port 12345
    User root
</code></pre>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šè¯·å°† <code>HostName</code> å’Œ <code>Port</code> æ›¿æ¢ä¸ºä½ å®é™…çš„ AutoDL å®ä¾‹ä¿¡æ¯ã€‚</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/78408f9ff7f0457d95d0f148cc5c299d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=9iGffosyRJYJjWZkpRVbBFoinrA%3D" alt="alt text" loading="lazy"/></p>
<h5 data-id="heading-19">æ­¥éª¤ 3ï¼šè¿æ¥æœåŠ¡å™¨</h5>
<ol>
<li>æŒ‰ <code>Ctrl+Shift+P</code>ï¼Œè¾“å…¥ <code>Remote-SSH: Connect to Host</code></li>
<li>SSHä¸»æœºé€‰æ‹© <code>autodl</code>ï¼Œå¹³å°é€‰æ‹©Linux</li>
<li>è¾“å…¥å¯†ç </li>
<li>ç­‰å¾…è¿æ¥æˆåŠŸ</li>
</ol>
<p><strong>ã€æˆªå›¾ï¼šVS Code æˆåŠŸè¿æ¥ AutoDLã€‘</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa67506d2f9c4bbcb67144c5f642c6c7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=ZSP4WQ20dci2CH4WRC3g4qR8NME%3D" alt="alt text" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f5283ef4e4140689320ee2e4e0bccce~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=oKvxKwAv9d%2B1g1cxJnw3j2L82aw%3D" alt="alt text" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/719e3069ba2346bdb320961d4b82a6cb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=DKiOupwiTEdFY5iOBcV7iKoSXbQ%3D" alt="alt text" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef8a91088c204e00a0d572bbf9375385~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=tsS9VCbcIH7Hez9YiHzxwcoAmPk%3D" alt="alt text" loading="lazy"/></p>
<h4 data-id="heading-20">3.3 æ‰“å¼€ç»ˆç«¯</h4>
<p>è¿æ¥æˆåŠŸåï¼Œæ‰“å¼€/root/autodl-tmpæ–‡ä»¶å¤¹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/53ec4afa9d2a4c7fa0e5c8c90baf8175~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=zSpci8%2BWqPJXdakj4C7hnghfP0E%3D" alt="alt text" loading="lazy"/></p>
<p>åœ¨ VS Code ä¸­æŒ‰ <code>Ctrl+`</code> æ‰“å¼€ç»ˆç«¯ï¼Œä½ åº”è¯¥çœ‹åˆ°ç±»ä¼¼ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">root@autodl-container-xxxxx:~<span class="hljs-comment">#</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e8040aef14d4bf5a5cd7325edb0b4b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=oeP%2BjUqniouZ%2B%2Byx8RwdyMZ7VYg%3D" alt="alt text" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-21">4. ç¯å¢ƒä¿®å¤</h3>
<h4 data-id="heading-22">4.1 é—®é¢˜èƒŒæ™¯</h4>
<p>ç¤¾åŒºé•œåƒä¸­çš„ä¾èµ–ç‰ˆæœ¬å¯èƒ½å­˜åœ¨å†²çªï¼Œéœ€è¦å…ˆä¿®å¤æ‰èƒ½æ­£å¸¸ä½¿ç”¨ vLLMã€‚é¦–å…ˆ pip æ¢æºåŠ é€Ÿä¸‹è½½å¹¶å®‰è£…ä¾èµ–åŒ…ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">python -m pip install --upgrade pip
pip config <span class="hljs-built_in">set</span> global.index-url https://pypi.tuna.tsinghua.edu.cn/simple

pip install modelscope
pip install vllm
</code></pre>
<h4 data-id="heading-23">4.2 æ£€æŸ¥ vLLM ç‰ˆæœ¬</h4>
<pre><code class="hljs language-bash" lang="bash">vllm --version
</code></pre>
<p>å¦‚æœå‡ºç°é”™è¯¯ï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤ä¿®å¤ã€‚</p>
<h4 data-id="heading-24">4.3 ä¿®å¤ä¾èµ–å†²çª</h4>
<h5 data-id="heading-25">é”™è¯¯ 1ï¼šNumPy/SciPy ä¸å…¼å®¹</h5>
<p><strong>é”™è¯¯ä¿¡æ¯</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ValueError: All ufuncs must have <span class="hljs-built_in">type</span> numpy.ufunc
</code></pre>
<p><strong>åŸå› </strong>ï¼šscipy ä¸ numpy ç‰ˆæœ¬ä¸åŒ¹é…ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># ä¿®å¤ NumPy å’Œ SciPy ä¾èµ–</span>
<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€å‘½ä»¤è¯´æ˜ã€‘</span>
<span class="hljs-comment"># pip install: Python åŒ…ç®¡ç†å™¨çš„å®‰è£…å‘½ä»¤</span>
<span class="hljs-comment"># --force-reinstall: å¼ºåˆ¶é‡æ–°å®‰è£…ï¼Œå³ä½¿å·²å­˜åœ¨ä¹Ÿä¼šé‡è£…</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€ç‰ˆæœ¬é€‰æ‹©è¯´æ˜ã€‘</span>
<span class="hljs-comment"># numpy==1.26.4: æŒ‡å®šå®‰è£… 1.26.4 ç‰ˆæœ¬</span>
<span class="hljs-comment">#   - ä½¿ç”¨ == ç²¾ç¡®æŒ‡å®šç‰ˆæœ¬å·</span>
<span class="hljs-comment">#   - 1.26.x æ˜¯ç¨³å®šç‰ˆæœ¬ï¼Œå…¼å®¹æ€§å¥½</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># scipy==1.13.1: æŒ‡å®šå®‰è£… 1.13.1 ç‰ˆæœ¬</span>
<span class="hljs-comment">#   - ä¸ numpy 1.26.x å…¼å®¹</span>
<span class="hljs-comment"># ============================================================</span>

pip install numpy==1.26.4 scipy==1.13.1 --force-reinstall
</code></pre>
<h5 data-id="heading-26">é”™è¯¯ 2ï¼šRecursionErrorï¼ˆé€’å½’é”™è¯¯ï¼‰</h5>
<p><strong>é”™è¯¯ä¿¡æ¯</strong>ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">RecursionError: maximum recursion depth exceeded</span>
</code></pre>
<p><strong>åŸå› </strong>ï¼šscikit-learn çš„ç¼–è¯‘æ‰©å±•ä¸æ–° numpy ä¸å…¼å®¹ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é‡æ–°å®‰è£… scikit-learnï¼Œä½¿å…¶é‡æ–°ç¼–è¯‘ä»¥é€‚é…æ–°çš„ numpy</span>
pip install scikit-learn --force-reinstall
</code></pre>
<h5 data-id="heading-27">é”™è¯¯ 3ï¼šNumba éœ€è¦ NumPy 2.2 æˆ–æ›´ä½</h5>
<p><strong>é”™è¯¯ä¿¡æ¯</strong>ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">ImportError: Numba needs NumPy 2.2 or less. Got NumPy 2.4.</span>
</code></pre>
<p><strong>åŸå› </strong>ï¼šå®‰è£… scikit-learn æ—¶è‡ªåŠ¨å‡çº§äº† numpy åˆ° 2.4ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># é™çº§ NumPy åˆ°å…¼å®¹ç‰ˆæœ¬</span>
<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># NumPy 2.2.0 å¯ä»¥åŒæ—¶æ»¡è¶³ï¼š</span>
<span class="hljs-comment"># - numba çš„è¦æ±‚ï¼ˆ&lt;= 2.2ï¼‰</span>
<span class="hljs-comment"># - scikit-learn çš„è¦æ±‚ï¼ˆ&gt;= 1.24.1ï¼‰</span>
<span class="hljs-comment"># - scipy çš„è¦æ±‚</span>
<span class="hljs-comment"># ============================================================</span>

pip install numpy==2.2.0 --force-reinstall
</code></pre>
<h4 data-id="heading-28">4.4 éªŒè¯ä¿®å¤æˆåŠŸ</h4>
<pre><code class="hljs language-bash" lang="bash">vllm --version
</code></pre>
<p><strong>é¢„æœŸè¾“å‡º</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">INFO 12-23 11:09:14 <span class="hljs-section">[__init__.py:239]</span> Automatically detected platform cuda.
0.8.5.post1
</code></pre>
<p><strong>ã€æˆªå›¾ä½ç½®ï¼švLLM ç‰ˆæœ¬éªŒè¯æˆåŠŸã€‘</strong></p>
<blockquote>
<p>è¯·åœ¨æ­¤å¤„æ’å…¥ç»ˆç«¯æ˜¾ç¤º vllm --version è¾“å‡ºçš„æˆªå›¾</p>
</blockquote>
<hr/>
<h3 data-id="heading-29">5. æ¨¡å‹ä¸‹è½½</h3>
<h4 data-id="heading-30">5.1 åˆ›å»ºä¸‹è½½è„šæœ¬</h4>
<p>åœ¨ <code>/root/autodl-tmp/</code> ç›®å½•ä¸‹åˆ›å»º <code>model_download.py</code> æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># model_download.py - æ¨¡å‹ä¸‹è½½è„šæœ¬</span>
<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€è„šæœ¬åŠŸèƒ½ã€‘</span>
<span class="hljs-comment"># ä» ModelScopeï¼ˆé­”æ­ç¤¾åŒºï¼‰ä¸‹è½½ Qwen3-8B æ¨¡å‹åˆ°æœ¬åœ°</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€ä¸ºä»€ä¹ˆç”¨ ModelScopeï¼Ÿã€‘</span>
<span class="hljs-comment"># - ModelScope æ˜¯é˜¿é‡Œå·´å·´çš„æ¨¡å‹æ‰˜ç®¡å¹³å°</span>
<span class="hljs-comment"># - æœåŠ¡å™¨åœ¨å›½å†…ï¼Œä¸‹è½½é€Ÿåº¦æ¯” Hugging Face å¿«å¾ˆå¤š</span>
<span class="hljs-comment"># - Qwen æ¨¡å‹åœ¨ ModelScope ä¸Šæ˜¯å®˜æ–¹å‘å¸ƒçš„</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€æ–‡ä»¶è·¯å¾„ã€‘</span>
<span class="hljs-comment"># /root/autodl-tmp/model_download.py</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-comment"># ------------------------------------------------------------</span>
<span class="hljs-comment"># å¯¼å…¥è¯­å¥</span>
<span class="hljs-comment"># ------------------------------------------------------------</span>
<span class="hljs-keyword">from</span> modelscope <span class="hljs-keyword">import</span> snapshot_download
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€Python å¯¼å…¥è¯­æ³•ã€‘</span>
<span class="hljs-comment"># from æ¨¡å—å import å‡½æ•°å</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ä½œç”¨ï¼šä» modelscope åº“ä¸­å¯¼å…¥ snapshot_download å‡½æ•°</span>
<span class="hljs-comment"># è¿™æ ·å¯ä»¥ç›´æ¥ä½¿ç”¨ snapshot_download()ï¼Œè€Œä¸éœ€è¦å†™ modelscope.snapshot_download()</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€snapshot_download å‡½æ•°è¯´æ˜ã€‘</span>
<span class="hljs-comment"># - snapshot: å¿«ç…§ï¼ŒæŒ‡æ¨¡å‹çš„æŸä¸ªç‰ˆæœ¬</span>
<span class="hljs-comment"># - download: ä¸‹è½½</span>
<span class="hljs-comment"># - åŠŸèƒ½ï¼šä¸‹è½½æŒ‡å®šæ¨¡å‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°æœ¬åœ°</span>
<span class="hljs-comment"># ------------------------------------------------------------</span>

<span class="hljs-comment"># ------------------------------------------------------------</span>
<span class="hljs-comment"># è°ƒç”¨ä¸‹è½½å‡½æ•°</span>
<span class="hljs-comment"># ------------------------------------------------------------</span>
model_dir = snapshot_download(
    <span class="hljs-string">'Qwen/Qwen3-8B'</span>,               <span class="hljs-comment"># å‚æ•°1ï¼šæ¨¡å‹æ ‡è¯†ç¬¦ï¼ˆä½ç½®å‚æ•°ï¼‰</span>
    cache_dir=<span class="hljs-string">'/root/autodl-tmp'</span>,  <span class="hljs-comment"># å‚æ•°2ï¼šç¼“å­˜ç›®å½•ï¼ˆå…³é”®å­—å‚æ•°ï¼‰</span>
    revision=<span class="hljs-string">'master'</span>              <span class="hljs-comment"># å‚æ•°3ï¼šç‰ˆæœ¬/åˆ†æ”¯ï¼ˆå…³é”®å­—å‚æ•°ï¼‰</span>
)
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€å‚æ•°è¯¦è§£ã€‘</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># 1. 'Qwen/Qwen3-8B' (ä½ç½®å‚æ•°)</span>
<span class="hljs-comment">#    - æ ¼å¼ï¼šç»„ç»‡å/æ¨¡å‹å</span>
<span class="hljs-comment">#    - Qwen: é˜¿é‡Œé€šä¹‰åƒé—®å›¢é˜Ÿ</span>
<span class="hljs-comment">#    - Qwen3-8B: ç¬¬ä¸‰ä»£ï¼Œ80äº¿å‚æ•°</span>
<span class="hljs-comment">#    - åœ¨ ModelScope ä¸Šçš„åœ°å€ï¼šhttps://modelscope.cn/models/Qwen/Qwen3-8B</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># 2. cache_dir='/root/autodl-tmp' (å…³é”®å­—å‚æ•°)</span>
<span class="hljs-comment">#    - å…³é”®å­—å‚æ•°æ ¼å¼ï¼šå‚æ•°å=å€¼</span>
<span class="hljs-comment">#    - æŒ‡å®šä¸‹è½½æ–‡ä»¶ä¿å­˜çš„ç›®å½•</span>
<span class="hljs-comment">#    - /root/autodl-tmp æ˜¯ AutoDL çš„æ•°æ®ç›˜</span>
<span class="hljs-comment">#    - æ•°æ®ç›˜çš„æ•°æ®åœ¨å…³æœºåä¼šä¿ç•™</span>
<span class="hljs-comment">#    - ç³»ç»Ÿç›˜ /root çš„æ•°æ®å…³æœºåå¯èƒ½ä¸¢å¤±</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># 3. revision='master' (å…³é”®å­—å‚æ•°)</span>
<span class="hljs-comment">#    - æŒ‡å®šè¦ä¸‹è½½çš„ç‰ˆæœ¬</span>
<span class="hljs-comment">#    - 'master' æ˜¯ä¸»åˆ†æ”¯ï¼Œå³æœ€æ–°ç¨³å®šç‰ˆ</span>
<span class="hljs-comment">#    - ä¹Ÿå¯ä»¥æŒ‡å®šå…·ä½“çš„ commit hash æˆ– tag</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€è¿”å›å€¼ã€‘</span>
<span class="hljs-comment"># model_dir: å­—ç¬¦ä¸²ï¼Œæ¨¡å‹å®é™…ä¿å­˜çš„å®Œæ•´è·¯å¾„</span>
<span class="hljs-comment">#   ä¾‹å¦‚ï¼š/root/autodl-tmp/Qwen/Qwen3-8B</span>
<span class="hljs-comment"># ------------------------------------------------------------</span>

<span class="hljs-comment"># ------------------------------------------------------------</span>
<span class="hljs-comment"># æ‰“å°ä¸‹è½½ç»“æœ</span>
<span class="hljs-comment"># ------------------------------------------------------------</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ¨¡å‹å·²ä¸‹è½½åˆ°: <span class="hljs-subst">{model_dir}</span>"</span>)
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€f-string è¯­æ³•è¯´æ˜ã€‘</span>
<span class="hljs-comment"># f"..." æ˜¯ Python 3.6+ å¼•å…¥çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼ˆf-stringï¼‰</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># è¯­æ³•è§„åˆ™ï¼š</span>
<span class="hljs-comment"># - å­—ç¬¦ä¸²å‰åŠ  f æˆ– F å‰ç¼€</span>
<span class="hljs-comment"># - èŠ±æ‹¬å· {} ä¸­å¯ä»¥æ”¾å…¥å˜é‡æˆ–è¡¨è¾¾å¼</span>
<span class="hljs-comment"># - Python ä¼šè‡ªåŠ¨å°†å˜é‡çš„å€¼æ’å…¥å­—ç¬¦ä¸²ä¸­</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ç¤ºä¾‹ï¼š</span>
<span class="hljs-comment">#   name = "Alice"</span>
<span class="hljs-comment">#   age = 25</span>
<span class="hljs-comment">#   print(f"å§“å: {name}, å¹´é¾„: {age}")</span>
<span class="hljs-comment">#   # è¾“å‡ºï¼šå§“å: Alice, å¹´é¾„: 25</span>
<span class="hljs-comment"># ------------------------------------------------------------</span>
</code></pre>
<h4 data-id="heading-31">5.2 å¼€å¯ç½‘ç»œåŠ é€Ÿï¼ˆå¯é€‰ï¼‰</h4>
<p>AutoDL æä¾›å­¦æœ¯èµ„æºåŠ é€Ÿï¼Œå¯ä»¥åŠ å¿«ä¸‹è½½é€Ÿåº¦ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># å¼€å¯ AutoDL å­¦æœ¯åŠ é€Ÿ</span>
<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€å‘½ä»¤è¯´æ˜ã€‘</span>
<span class="hljs-comment"># source: Shell å†…ç½®å‘½ä»¤ï¼Œç”¨äºåœ¨å½“å‰ Shell ä¸­æ‰§è¡Œè„šæœ¬</span>
<span class="hljs-comment">#         ä¸ç›´æ¥æ‰§è¡Œè„šæœ¬ä¸åŒï¼Œsource ä¼šåœ¨å½“å‰è¿›ç¨‹ä¸­æ‰§è¡Œ</span>
<span class="hljs-comment">#         è¿™æ ·è„šæœ¬ä¸­è®¾ç½®çš„ç¯å¢ƒå˜é‡ä¼šä¿ç•™</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># /etc/network_turbo: AutoDL æä¾›çš„ç½‘ç»œåŠ é€Ÿè„šæœ¬</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€ä½œç”¨ã€‘</span>
<span class="hljs-comment"># ä¼˜åŒ–åˆ°å­¦æœ¯èµ„æºï¼ˆå¦‚ ModelScopeã€Hugging Faceï¼‰çš„ç½‘ç»œè¿æ¥</span>
<span class="hljs-comment"># å¯èƒ½æå‡ä¸‹è½½é€Ÿåº¦</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-built_in">source</span> /etc/network_turbo
</code></pre>
<h4 data-id="heading-32">5.3 è¿è¡Œä¸‹è½½è„šæœ¬</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># æ‰§è¡Œæ¨¡å‹ä¸‹è½½</span>
<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€å‘½ä»¤è¯´æ˜ã€‘</span>
<span class="hljs-comment"># cd: change directoryï¼Œåˆ‡æ¢å½“å‰å·¥ä½œç›®å½•</span>
<span class="hljs-comment">#     cd /root/autodl-tmp è¡¨ç¤ºåˆ‡æ¢åˆ° /root/autodl-tmp ç›®å½•</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># &amp;&amp;: é€»è¾‘ä¸æ“ä½œç¬¦</span>
<span class="hljs-comment">#     ä½œç”¨ï¼šå‰ä¸€ä¸ªå‘½ä»¤æˆåŠŸï¼ˆè¿”å›å€¼ä¸º0ï¼‰åæ‰æ‰§è¡Œä¸‹ä¸€ä¸ªå‘½ä»¤</span>
<span class="hljs-comment">#     å¦‚æœ cd å¤±è´¥ï¼Œpython å‘½ä»¤ä¸ä¼šæ‰§è¡Œ</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># python: Python è§£é‡Šå™¨</span>
<span class="hljs-comment">#     python æ–‡ä»¶å.py è¡¨ç¤ºç”¨ Python æ‰§è¡Œè¯¥è„šæœ¬</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-built_in">cd</span> /root/autodl-tmp &amp;&amp; python model_download.py
</code></pre>
<p><strong>é¢„æœŸè¾“å‡º</strong>ï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-title class_">Downloading</span> <span class="hljs-title class_">Model</span> from <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/www.modelscope.cn to directory: /root</span><span class="hljs-regexp">/autodl-tmp/</span><span class="hljs-title class_">Qwen</span>/<span class="hljs-title class_">Qwen3</span>-8B
...
<span class="hljs-title class_">Downloading</span> [model-<span class="hljs-number">00001</span>-of-<span class="hljs-number">00005</span>.safetensors]: <span class="hljs-number">100</span><span class="hljs-string">%|==========|</span>
<span class="hljs-title class_">Downloading</span> [model-<span class="hljs-number">00002</span>-of-<span class="hljs-number">00005</span>.safetensors]: <span class="hljs-number">100</span><span class="hljs-string">%|==========|</span>
...
æ¨¡å‹å·²ä¸‹è½½åˆ°: <span class="hljs-regexp">/root/autodl</span>-tmp/<span class="hljs-title class_">Qwen</span>/<span class="hljs-title class_">Qwen3</span>-8B
</code></pre>
<blockquote>
<p><strong>ä¸‹è½½æ—¶é—´</strong>ï¼šæ¨¡å‹çº¦ 16GBï¼Œæ ¹æ®ç½‘ç»œçŠ¶å†µéœ€è¦ 10-30 åˆ†é’Ÿã€‚</p>
</blockquote>
<p><strong>ã€æˆªå›¾ä½ç½®ï¼šæ¨¡å‹ä¸‹è½½å®Œæˆã€‘</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b203a2531604a3e8d53ef93537ba4c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=wH6cWIe5bQfoW%2Fk4EGCU4cY3p7U%3D" alt="alt text" loading="lazy"/></p>
<h4 data-id="heading-33">5.4 éªŒè¯ä¸‹è½½</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹ä¸‹è½½çš„æ–‡ä»¶</span>
<span class="hljs-built_in">ls</span> -lh /root/autodl-tmp/Qwen/Qwen3-8B/
</code></pre>
<p><strong>ã€ls å‘½ä»¤è¯´æ˜ã€‘</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ls: listï¼Œåˆ—å‡ºç›®å½•å†…å®¹</span>
<span class="hljs-comment"># -l: é•¿æ ¼å¼æ˜¾ç¤ºï¼ˆæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼šæƒé™ã€å¤§å°ã€æ—¥æœŸç­‰ï¼‰</span>
<span class="hljs-comment"># -h: human-readableï¼Œä»¥äººç±»å¯è¯»çš„æ ¼å¼æ˜¾ç¤ºæ–‡ä»¶å¤§å°ï¼ˆKBã€MBã€GBï¼‰</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ç»„åˆä½¿ç”¨ï¼šls -lh ç­‰ä»·äº ls -l -h</span>
</code></pre>
<p><strong>é¢„æœŸè¾“å‡º</strong>ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">total 16G
<span class="hljs-deletion">-rw-r--r-- 1 root root  728 Dec 23 11:40 config.json</span>
<span class="hljs-deletion">-rw-r--r-- 1 root root  239 Dec 23 11:40 generation_config.json</span>
<span class="hljs-deletion">-rw-r--r-- 1 root root 3.7G Dec 23 11:35 model-00001-of-00005.safetensors</span>
<span class="hljs-deletion">-rw-r--r-- 1 root root 3.7G Dec 23 11:36 model-00002-of-00005.safetensors</span>
<span class="hljs-deletion">-rw-r--r-- 1 root root 3.7G Dec 23 11:37 model-00003-of-00005.safetensors</span>
<span class="hljs-deletion">-rw-r--r-- 1 root root 3.7G Dec 23 11:38 model-00004-of-00005.safetensors</span>
<span class="hljs-deletion">-rw-r--r-- 1 root root 1.1G Dec 23 11:39 model-00005-of-00005.safetensors</span>
<span class="hljs-deletion">-rw-r--r-- 1 root root  11M Dec 23 11:40 tokenizer.json</span>
...
</code></pre>
<h5 data-id="heading-34">æ¨¡å‹æ–‡ä»¶è¯´æ˜</h5>



































<table><thead><tr><th>æ–‡ä»¶</th><th>å¤§å°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>config.json</code></td><td>728B</td><td>æ¨¡å‹é…ç½®æ–‡ä»¶ï¼ˆå±‚æ•°ã€ç»´åº¦ã€æ³¨æ„åŠ›å¤´æ•°ç­‰ï¼‰</td></tr><tr><td><code>model-*.safetensors</code></td><td>å„çº¦3.7GB</td><td>æ¨¡å‹æƒé‡æ–‡ä»¶ï¼ˆåˆ†ç‰‡å­˜å‚¨ï¼Œå…±5ä¸ªæ–‡ä»¶ï¼‰</td></tr><tr><td><code>tokenizer.json</code></td><td>11MB</td><td>åˆ†è¯å™¨é…ç½®ï¼ˆè¯æ±‡è¡¨ã€åˆ†è¯è§„åˆ™ç­‰ï¼‰</td></tr><tr><td><code>vocab.json</code></td><td>2.6MB</td><td>è¯æ±‡è¡¨</td></tr><tr><td><code>generation_config.json</code></td><td>239B</td><td>ç”Ÿæˆé…ç½®ï¼ˆé»˜è®¤é‡‡æ ·å‚æ•°ç­‰ï¼‰</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-35">6. Pythonè„šæœ¬æ¨ç†</h3>
<h4 data-id="heading-36">6.1 åˆ›å»ºæ¨ç†è„šæœ¬</h4>
<p>åœ¨ <code>/root/autodl-tmp/</code> ç›®å½•ä¸‹åˆ›å»º <code>vllm_model.py</code> æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># vllm_model.py - vLLM æœ¬åœ°æ¨ç†è„šæœ¬</span>
<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€è„šæœ¬åŠŸèƒ½ã€‘</span>
<span class="hljs-comment"># ä½¿ç”¨ vLLM åŠ è½½ Qwen3-8B æ¨¡å‹ï¼Œè¿›è¡Œæœ¬åœ°æ¨ç†æµ‹è¯•</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€æ–‡ä»¶è·¯å¾„ã€‘</span>
<span class="hljs-comment"># /root/autodl-tmp/vllm_model.py</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€è¿è¡Œæ–¹å¼ã€‘</span>
<span class="hljs-comment"># python vllm_model.py</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€é¢„è®¡è¿è¡Œæ—¶é—´ã€‘</span>
<span class="hljs-comment"># - é¦–æ¬¡è¿è¡Œï¼ˆéœ€è¦ç¼–è¯‘ï¼‰ï¼š2-3 åˆ†é’Ÿ</span>
<span class="hljs-comment"># - åç»­è¿è¡Œï¼šçº¦ 30 ç§’</span>
<span class="hljs-comment"># ============================================================</span>


<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># ç¬¬ä¸€éƒ¨åˆ†ï¼šå¯¼å…¥å¿…è¦çš„åº“</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-keyword">from</span> vllm <span class="hljs-keyword">import</span> LLM, SamplingParams
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€å¯¼å…¥è¯­æ³•è¯´æ˜ã€‘</span>
<span class="hljs-comment"># from æ¨¡å—å import ç±»å1, ç±»å2</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ä½œç”¨ï¼šä» vllm åº“ä¸­å¯¼å…¥ä¸¤ä¸ªç±»</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€å¯¼å…¥çš„ç±»è¯´æ˜ã€‘</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># 1. LLM ç±»</span>
<span class="hljs-comment">#    - å…¨ç§°ï¼šLarge Language Model</span>
<span class="hljs-comment">#    - ä½œç”¨ï¼šå¤§è¯­è¨€æ¨¡å‹çš„å°è£…ç±»</span>
<span class="hljs-comment">#    - åŠŸèƒ½ï¼š</span>
<span class="hljs-comment">#      - åŠ è½½æ¨¡å‹æƒé‡åˆ° GPU</span>
<span class="hljs-comment">#      - ç®¡ç† GPU æ˜¾å­˜ï¼ˆPagedAttentionï¼‰</span>
<span class="hljs-comment">#      - æ‰§è¡Œæ¨ç†ç”Ÿæˆ</span>
<span class="hljs-comment">#      - å¤„ç†æ‰¹é‡è¯·æ±‚</span>
<span class="hljs-comment">#    - æ˜¯ vLLM çš„æ ¸å¿ƒç±»</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># 2. SamplingParams ç±»</span>
<span class="hljs-comment">#    - å…¨ç§°ï¼šSampling Parametersï¼ˆé‡‡æ ·å‚æ•°ï¼‰</span>
<span class="hljs-comment">#    - ä½œç”¨ï¼šé…ç½®æ–‡æœ¬ç”Ÿæˆæ—¶çš„é‡‡æ ·ç­–ç•¥</span>
<span class="hljs-comment">#    - å‚æ•°åŒ…æ‹¬ï¼štemperatureã€top_pã€top_k ç­‰</span>

<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€å¯¼å…¥è¯´æ˜ã€‘</span>
<span class="hljs-comment"># transformers: Hugging Face å¼€å‘çš„ NLP åº“</span>
<span class="hljs-comment"># AutoTokenizer: è‡ªåŠ¨åˆ†è¯å™¨ç±»</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># è™½ç„¶ vLLM å†…ç½®äº†åˆ†è¯å™¨ï¼Œä½†æˆ‘ä»¬éœ€è¦ç”¨ transformers çš„åˆ†è¯å™¨</span>
<span class="hljs-comment"># æ¥è°ƒç”¨ apply_chat_template() æ–¹æ³•æ ¼å¼åŒ–å¯¹è¯</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€ä¸ºä»€ä¹ˆéœ€è¦åˆ†è¯å™¨ï¼Ÿã€‘</span>
<span class="hljs-comment"># è®¡ç®—æœºä¸èƒ½ç›´æ¥ç†è§£æ–‡å­—ï¼Œéœ€è¦å°†æ–‡å­—è½¬æ¢ä¸ºæ•°å­—</span>
<span class="hljs-comment"># åˆ†è¯å™¨çš„ä½œç”¨ï¼š</span>
<span class="hljs-comment"># - ç¼–ç ï¼šæ–‡å­— -&gt; æ•°å­—ï¼ˆå¦‚ "ä½ å¥½" -&gt; [108386, 35946]ï¼‰</span>
<span class="hljs-comment"># - è§£ç ï¼šæ•°å­— -&gt; æ–‡å­—ï¼ˆå¦‚ [108386, 35946] -&gt; "ä½ å¥½"ï¼‰</span>

<span class="hljs-keyword">import</span> os
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€å¯¼å…¥è¯´æ˜ã€‘</span>
<span class="hljs-comment"># os: Python æ ‡å‡†åº“ï¼Œæä¾›æ“ä½œç³»ç»Ÿç›¸å…³åŠŸèƒ½</span>
<span class="hljs-comment"># è¿™é‡Œç”¨äºè®¾ç½®ç¯å¢ƒå˜é‡</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># å¸¸ç”¨åŠŸèƒ½ï¼š</span>
<span class="hljs-comment"># - os.environ: è®¿é—®å’Œä¿®æ”¹ç¯å¢ƒå˜é‡</span>
<span class="hljs-comment"># - os.path: è·¯å¾„æ“ä½œ</span>
<span class="hljs-comment"># - os.listdir(): åˆ—å‡ºç›®å½•å†…å®¹</span>


<span class="hljs-keyword">import</span> json

<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># ç¬¬äºŒéƒ¨åˆ†ï¼šè®¾ç½®ç¯å¢ƒå˜é‡</span>
<span class="hljs-comment"># ============================================================</span>

os.environ[<span class="hljs-string">'VLLM_USE_MODELSCOPE'</span>] = <span class="hljs-string">'True'</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€ç¯å¢ƒå˜é‡è¯´æ˜ã€‘</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># os.environ æ˜¯ä¸€ä¸ªç±»ä¼¼å­—å…¸çš„å¯¹è±¡ï¼Œå­˜å‚¨æ‰€æœ‰ç¯å¢ƒå˜é‡</span>
<span class="hljs-comment"># å¯ä»¥åƒå­—å…¸ä¸€æ ·è¯»å–å’Œè®¾ç½®ï¼š</span>
<span class="hljs-comment">#   è¯»å–ï¼švalue = os.environ['å˜é‡å']</span>
<span class="hljs-comment">#   è®¾ç½®ï¼šos.environ['å˜é‡å'] = 'å€¼'</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># VLLM_USE_MODELSCOPE = 'True' çš„ä½œç”¨ï¼š</span>
<span class="hljs-comment"># - å‘Šè¯‰ vLLM ä½¿ç”¨ ModelScope ä½œä¸ºæ¨¡å‹ä¸‹è½½æº</span>
<span class="hljs-comment"># - å¦‚æœæœ¬åœ°æ²¡æœ‰æ¨¡å‹ï¼Œä¼šä» ModelScope ä¸‹è½½</span>
<span class="hljs-comment"># - ç”±äºæˆ‘ä»¬å·²ç»ä¸‹è½½äº†æ¨¡å‹ï¼Œè¿™ä¸ªè®¾ç½®ä¸»è¦æ˜¯ä¿é™©æªæ–½</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€æ³¨æ„ã€‘ç¯å¢ƒå˜é‡çš„å€¼å¿…é¡»æ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ç”¨ 'True' è€Œä¸æ˜¯ True</span>


<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># ç¬¬ä¸‰éƒ¨åˆ†ï¼šå®šä¹‰æ¨ç†å‡½æ•°</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_completion</span>(<span class="hljs-params">prompts, model, tokenizer=<span class="hljs-literal">None</span>, temperature=<span class="hljs-number">0.6</span>,
                   top_p=<span class="hljs-number">0.95</span>, top_k=<span class="hljs-number">20</span>, min_p=<span class="hljs-number">0</span>, max_tokens=<span class="hljs-number">4096</span>,
                   max_model_len=<span class="hljs-number">8192</span></span>):
    <span class="hljs-string">"""
    ä½¿ç”¨ vLLM è¿›è¡Œæ–‡æœ¬ç”Ÿæˆçš„å‡½æ•°

    ã€Python å‡½æ•°å®šä¹‰è¯­æ³•ã€‘

    def å‡½æ•°å(å‚æ•°1, å‚æ•°2=é»˜è®¤å€¼, ...):
        '''æ–‡æ¡£å­—ç¬¦ä¸²ï¼ˆdocstringï¼‰'''
        å‡½æ•°ä½“
        return è¿”å›å€¼

    ã€å‚æ•°è¯¦è§£ã€‘

    prompts: str æˆ– list[str]
        - è¾“å…¥çš„æç¤ºæ–‡æœ¬
        - å¯ä»¥æ˜¯å•ä¸ªå­—ç¬¦ä¸²ï¼š"ä½ å¥½"
        - ä¹Ÿå¯ä»¥æ˜¯å­—ç¬¦ä¸²åˆ—è¡¨ï¼š["é—®é¢˜1", "é—®é¢˜2"]ï¼ˆæ‰¹é‡å¤„ç†ï¼‰

    model: str
        - æ¨¡å‹è·¯å¾„æˆ–æ¨¡å‹åç§°
        - æœ¬åœ°è·¯å¾„ï¼š'/root/autodl-tmp/Qwen/Qwen3-8B'
        - æˆ–æ¨¡å‹IDï¼š'Qwen/Qwen3-8B'ï¼ˆä¼šè‡ªåŠ¨ä¸‹è½½ï¼‰

    temperature: float = 0.6
        - æ¸©åº¦å‚æ•°ï¼Œæ§åˆ¶éšæœºæ€§
        - èŒƒå›´ 0-2ï¼š
          - 0: ç¡®å®šæ€§è¾“å‡ºï¼ˆæ€»æ˜¯é€‰æ¦‚ç‡æœ€é«˜çš„ï¼‰
          - 0.6: é€‚ä¸­çš„éšæœºæ€§ï¼ˆæ¨èï¼‰
          - 1.0+: æ›´éšæœºã€æ›´æœ‰åˆ›æ„

    top_p: float = 0.95
        - æ ¸é‡‡æ ·ï¼ˆNucleus Samplingï¼‰å‚æ•°
        - åªä»ç´¯ç§¯æ¦‚ç‡è¾¾åˆ° top_p çš„ token ä¸­é‡‡æ ·
        - 0.95 è¡¨ç¤ºè€ƒè™‘æ¦‚ç‡æœ€é«˜çš„ 95% çš„ token

    top_k: int = 20
        - Top-K é‡‡æ ·å‚æ•°
        - åªä»æ¦‚ç‡æœ€é«˜çš„ K ä¸ª token ä¸­é‡‡æ ·

    max_tokens: int = 4096
        - æœ€å¤§ç”Ÿæˆ token æ•°
        - é™åˆ¶è¾“å‡ºé•¿åº¦ï¼Œé˜²æ­¢æ— é™ç”Ÿæˆ

    max_model_len: int = 8192
        - æ¨¡å‹æœ€å¤§ä¸Šä¸‹æ–‡é•¿åº¦
        - åŒ…æ‹¬è¾“å…¥å’Œè¾“å‡ºçš„æ€»é•¿åº¦

    ã€è¿”å›å€¼ã€‘
    outputs: list[RequestOutput]
        - ç”Ÿæˆç»“æœåˆ—è¡¨
        - æ¯ä¸ªå…ƒç´ åŒ…å« prompt å’Œ outputs å±æ€§
    """</span>

    <span class="hljs-comment"># --------------------------------------------------------</span>
    <span class="hljs-comment"># é…ç½®åœæ­¢ token</span>
    <span class="hljs-comment"># --------------------------------------------------------</span>
    stop_token_ids = [<span class="hljs-number">151645</span>, <span class="hljs-number">151643</span>]
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># ã€åœæ­¢ token è¯´æ˜ã€‘</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># è¿™æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼ˆlistï¼‰ï¼ŒåŒ…å«ä¸¤ä¸ªæ•´æ•°</span>
    <span class="hljs-comment"># è¿™äº›æ•°å­—æ˜¯ Qwen3 çš„ç‰¹æ®Š token IDï¼š</span>
    <span class="hljs-comment"># - 151645: &lt;|im_end|&gt; æ¶ˆæ¯ç»“æŸæ ‡è®°</span>
    <span class="hljs-comment"># - 151643: &lt;|endoftext|&gt; æ–‡æœ¬ç»“æŸæ ‡è®°</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># ã€ä½œç”¨ã€‘</span>
    <span class="hljs-comment"># å½“æ¨¡å‹ç”Ÿæˆè¿™äº› token æ—¶ï¼Œä¼šåœæ­¢ç»§ç»­ç”Ÿæˆ</span>
    <span class="hljs-comment"># ç›¸å½“äºå‘Šè¯‰æ¨¡å‹"å¯ä»¥ç»“æŸäº†"</span>
    <span class="hljs-comment"># å¦‚æœä¸è®¾ç½®ï¼Œæ¨¡å‹å¯èƒ½ä¼šæ— é™ç”Ÿæˆä¸‹å»</span>

    <span class="hljs-comment"># --------------------------------------------------------</span>
    <span class="hljs-comment"># åˆ›å»ºé‡‡æ ·å‚æ•°å¯¹è±¡</span>
    <span class="hljs-comment"># --------------------------------------------------------</span>
    sampling_params = SamplingParams(
        temperature=temperature,
        top_p=top_p,
        top_k=top_k,
        min_p=min_p,
        max_tokens=max_tokens,
        stop_token_ids=stop_token_ids
    )
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># ã€åˆ›å»ºå¯¹è±¡è¯­æ³•ã€‘</span>
    <span class="hljs-comment"># å˜é‡å = ç±»å(å‚æ•°1=å€¼1, å‚æ•°2=å€¼2, ...)</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># SamplingParams æ˜¯ä¸€ä¸ªç±»ï¼Œè°ƒç”¨å®ƒä¼šåˆ›å»ºä¸€ä¸ªå¯¹è±¡</span>
    <span class="hljs-comment"># ç±»ä¼¼äºç”¨æ¨¡å…·ï¼ˆç±»ï¼‰åˆ¶ä½œä¸€ä¸ªå…·ä½“çš„ä¸œè¥¿ï¼ˆå¯¹è±¡ï¼‰</span>

    <span class="hljs-comment"># --------------------------------------------------------</span>
    <span class="hljs-comment"># åˆ›å»º LLM å¯¹è±¡ï¼ˆåŠ è½½æ¨¡å‹ï¼‰</span>
    <span class="hljs-comment"># --------------------------------------------------------</span>
    llm = LLM(
        model=model,
        tokenizer=tokenizer,
        max_model_len=max_model_len,
        trust_remote_code=<span class="hljs-literal">True</span>
    )
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># ã€LLM æ„é€ å‚æ•°è¯´æ˜ã€‘</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># model: æ¨¡å‹è·¯å¾„</span>
    <span class="hljs-comment">#   - å¯ä»¥æ˜¯æœ¬åœ°è·¯å¾„ï¼š'/root/autodl-tmp/Qwen/Qwen3-8B'</span>
    <span class="hljs-comment">#   - ä¹Ÿå¯ä»¥æ˜¯æ¨¡å‹IDï¼š'Qwen/Qwen3-8B'ï¼ˆä¼šè‡ªåŠ¨ä¸‹è½½ï¼‰</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># tokenizer: åˆ†è¯å™¨</span>
    <span class="hljs-comment">#   - None è¡¨ç¤ºä½¿ç”¨æ¨¡å‹ç›®å½•ä¸­çš„åˆ†è¯å™¨</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># max_model_len: æœ€å¤§åºåˆ—é•¿åº¦</span>
    <span class="hljs-comment">#   - 8192 è¡¨ç¤ºæœ€å¤šå¤„ç† 8192 ä¸ª token</span>
    <span class="hljs-comment">#   - è¶Šå¤§éœ€è¦è¶Šå¤šæ˜¾å­˜ï¼ˆç”¨äº KV Cacheï¼‰</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># trust_remote_code: æ˜¯å¦ä¿¡ä»»è¿œç¨‹ä»£ç </span>
    <span class="hljs-comment">#   - True è¡¨ç¤ºå…è®¸æ‰§è¡Œæ¨¡å‹ä»“åº“ä¸­çš„è‡ªå®šä¹‰ Python ä»£ç </span>
    <span class="hljs-comment">#   - Qwen æ¨¡å‹æœ‰è‡ªå®šä¹‰çš„æ¨¡å‹ä»£ç ï¼Œéœ€è¦å¼€å¯æ­¤é€‰é¡¹</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># ã€åˆ›å»º LLM å¯¹è±¡æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿã€‘</span>
    <span class="hljs-comment"># 1. è¯»å– config.jsonï¼Œäº†è§£æ¨¡å‹ç»“æ„</span>
    <span class="hljs-comment"># 2. åŠ è½½æ¨¡å‹æƒé‡åˆ° GPUï¼ˆçº¦ 16GBï¼‰</span>
    <span class="hljs-comment"># 3. ç¼–è¯‘ä¼˜åŒ–è®¡ç®—å›¾ï¼ˆé¦–æ¬¡è¾ƒæ…¢ï¼Œçº¦ 1-2 åˆ†é’Ÿï¼‰</span>
    <span class="hljs-comment"># 4. é¢„çƒ­ CUDA Graphï¼ˆæ•è·ä¸åŒé•¿åº¦çš„è®¡ç®—å›¾ï¼‰</span>
    <span class="hljs-comment"># 5. åˆ†é… KV Cacheï¼ˆç”¨äºå­˜å‚¨æ³¨æ„åŠ›çš„ä¸­é—´ç»“æœï¼‰</span>

    <span class="hljs-comment"># --------------------------------------------------------</span>
    <span class="hljs-comment"># æ‰§è¡Œæ¨ç†</span>
    <span class="hljs-comment"># --------------------------------------------------------</span>
    outputs = llm.generate(prompts, sampling_params)
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># ã€æ–¹æ³•è°ƒç”¨è¯­æ³•ã€‘</span>
    <span class="hljs-comment"># å¯¹è±¡.æ–¹æ³•å(å‚æ•°1, å‚æ•°2)</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># llm.generate() æ˜¯ LLM å¯¹è±¡çš„æ–¹æ³•</span>
    <span class="hljs-comment"># ä½œç”¨ï¼šæ ¹æ®è¾“å…¥çš„ prompts ç”Ÿæˆæ–‡æœ¬</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># å‚æ•°ï¼š</span>
    <span class="hljs-comment"># - prompts: è¾“å…¥æ–‡æœ¬ï¼ˆå¯ä»¥æ˜¯åˆ—è¡¨ï¼Œæ”¯æŒæ‰¹é‡å¤„ç†ï¼‰</span>
    <span class="hljs-comment"># - sampling_params: é‡‡æ ·å‚æ•°å¯¹è±¡</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># è¿”å›å€¼ï¼š</span>
    <span class="hljs-comment"># - outputs: ä¸€ä¸ªåˆ—è¡¨ï¼ŒåŒ…å«æ¯ä¸ªè¾“å…¥çš„ç”Ÿæˆç»“æœ</span>

    <span class="hljs-keyword">return</span> outputs


<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># ç¬¬å››éƒ¨åˆ†ï¼šä¸»ç¨‹åº</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-string">"""
    ã€if __name__ == "__main__" è¯¦è§£ã€‘

    è¿™æ˜¯ Python çš„æ ‡å‡†å†™æ³•ï¼Œå‡ ä¹æ¯ä¸ªå¯æ‰§è¡Œè„šæœ¬éƒ½æœ‰

    ã€åŸç†ã€‘
    æ¯ä¸ª Python æ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªå†…ç½®å˜é‡ __name__
    - ç›´æ¥è¿è¡Œæ—¶ï¼š__name__ çš„å€¼æ˜¯ "__main__"
    - è¢«å¯¼å…¥æ—¶ï¼š__name__ çš„å€¼æ˜¯æ¨¡å—åï¼ˆå¦‚ "vllm_model"ï¼‰

    ã€å¥½å¤„ã€‘
    - è„šæœ¬å¯ä»¥ç›´æ¥è¿è¡Œ
    - ä¹Ÿå¯ä»¥è¢«å…¶ä»–è„šæœ¬å¯¼å…¥ä½¿ç”¨å…¶ä¸­çš„å‡½æ•°
    - ä¸¤ç§ç”¨æ³•äº’ä¸å¹²æ‰°
    """</span>

    <span class="hljs-comment"># --------------------------------------------------------</span>
    <span class="hljs-comment"># å®šä¹‰æ¨¡å‹è·¯å¾„</span>
    <span class="hljs-comment"># --------------------------------------------------------</span>
    model = <span class="hljs-string">'/root/autodl-tmp/Qwen/Qwen3-8B'</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># è¿™æ˜¯æ¨¡å‹æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•</span>
    <span class="hljs-comment"># åŒ…å« config.jsonã€model-*.safetensorsã€tokenizer.json ç­‰æ–‡ä»¶</span>

    <span class="hljs-comment"># --------------------------------------------------------</span>
    <span class="hljs-comment"># åŠ è½½åˆ†è¯å™¨</span>
    <span class="hljs-comment"># --------------------------------------------------------</span>
    tokenizer = AutoTokenizer.from_pretrained(model, use_fast=<span class="hljs-literal">False</span>)
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># ã€ç±»æ–¹æ³•è°ƒç”¨è¯­æ³•ã€‘</span>
    <span class="hljs-comment"># ç±»å.æ–¹æ³•å(å‚æ•°)</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># from_pretrained æ˜¯ AutoTokenizer çš„ç±»æ–¹æ³•ï¼ˆclass methodï¼‰</span>
    <span class="hljs-comment"># ç±»æ–¹æ³•ä¸éœ€è¦å…ˆåˆ›å»ºå¯¹è±¡å°±å¯ä»¥è°ƒç”¨</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># ã€å‚æ•°è¯´æ˜ã€‘</span>
    <span class="hljs-comment"># model: æ¨¡å‹è·¯å¾„ï¼Œä¼šè¯»å–å…¶ä¸­çš„ tokenizer.json ç­‰æ–‡ä»¶</span>
    <span class="hljs-comment"># use_fast=False: ä½¿ç”¨æ ‡å‡†åˆ†è¯å™¨ï¼ˆè€Œéå¿«é€Ÿåˆ†è¯å™¨ï¼‰</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># ã€è¿”å›å€¼ã€‘</span>
    <span class="hljs-comment"># tokenizer: åˆ†è¯å™¨å¯¹è±¡ï¼Œå¯ä»¥ç”¨äºï¼š</span>
    <span class="hljs-comment"># - tokenizer.encode("æ–‡æœ¬"): å°†æ–‡æœ¬è½¬ä¸º token ID</span>
    <span class="hljs-comment"># - tokenizer.decode([ids]): å°† token ID è½¬å›æ–‡æœ¬</span>
    <span class="hljs-comment"># - tokenizer.apply_chat_template(): æ ¼å¼åŒ–å¯¹è¯</span>

    <span class="hljs-comment"># --------------------------------------------------------</span>
    <span class="hljs-comment"># å®šä¹‰ç”¨æˆ·è¾“å…¥</span>
    <span class="hljs-comment"># --------------------------------------------------------</span>
    prompt = <span class="hljs-string">"ç»™æˆ‘ä¸€ä¸ªå…³äºå¤§æ¨¡å‹çš„ç®€çŸ­ä»‹ç»ã€‚"</span>

    <span class="hljs-comment"># --------------------------------------------------------</span>
    <span class="hljs-comment"># æ„å»ºå¯¹è¯æ¶ˆæ¯</span>
    <span class="hljs-comment"># --------------------------------------------------------</span>
    messages = [
        {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: prompt}
    ]
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># ã€æ•°æ®ç»“æ„è¯´æ˜ã€‘</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># messages æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼ˆlistï¼‰</span>
    <span class="hljs-comment"># åˆ—è¡¨ç”¨æ–¹æ‹¬å· [] è¡¨ç¤ºï¼Œå…ƒç´ ç”¨é€—å·åˆ†éš”</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå­—å…¸ï¼ˆdictï¼‰</span>
    <span class="hljs-comment"># å­—å…¸ç”¨èŠ±æ‹¬å· {} è¡¨ç¤ºï¼Œæ ¼å¼ä¸º {é”®: å€¼, é”®: å€¼, ...}</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># è¿™é‡Œçš„å­—å…¸æœ‰ä¸¤ä¸ªé”®å€¼å¯¹ï¼š</span>
    <span class="hljs-comment"># - "role": "user"     è¡¨ç¤ºè¯´è¯çš„è§’è‰²æ˜¯ç”¨æˆ·</span>
    <span class="hljs-comment"># - "content": prompt  è¡¨ç¤ºè¯´è¯çš„å†…å®¹</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># ã€OpenAI æ¶ˆæ¯æ ¼å¼ã€‘</span>
    <span class="hljs-comment"># è¿™æ˜¯ OpenAI API å®šä¹‰çš„æ ‡å‡†å¯¹è¯æ ¼å¼</span>
    <span class="hljs-comment"># æ”¯æŒçš„è§’è‰²ï¼ˆroleï¼‰ï¼š</span>
    <span class="hljs-comment"># - "system": ç³»ç»Ÿæç¤ºï¼ˆè®¾å®šAIçš„è¡Œä¸ºï¼‰</span>
    <span class="hljs-comment"># - "user": ç”¨æˆ·æ¶ˆæ¯</span>
    <span class="hljs-comment"># - "assistant": AIåŠ©æ‰‹çš„å›å¤</span>

    <span class="hljs-comment"># --------------------------------------------------------</span>
    <span class="hljs-comment"># ä½¿ç”¨æ¨¡æ¿æ ¼å¼åŒ–å¯¹è¯</span>
    <span class="hljs-comment"># --------------------------------------------------------</span>
    text = tokenizer.apply_chat_template(
        messages,                      <span class="hljs-comment"># å¯¹è¯æ¶ˆæ¯åˆ—è¡¨</span>
        tokenize=<span class="hljs-literal">False</span>,                <span class="hljs-comment"># ä¸è¿›è¡Œåˆ†è¯ï¼Œè¿”å›å­—ç¬¦ä¸²</span>
        add_generation_prompt=<span class="hljs-literal">True</span>,    <span class="hljs-comment"># æ·»åŠ ç”Ÿæˆæç¤º</span>
        enable_thinking=<span class="hljs-literal">True</span>           <span class="hljs-comment"># å¼€å¯æ€è€ƒæ¨¡å¼</span>
    )
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># ã€apply_chat_template æ–¹æ³•è¯´æ˜ã€‘</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># ä½œç”¨ï¼šå°†å¯¹è¯æ¶ˆæ¯è½¬æ¢ä¸ºæ¨¡å‹æœŸæœ›çš„ç‰¹å®šæ ¼å¼</span>
    <span class="hljs-comment"># ä¸åŒæ¨¡å‹æœ‰ä¸åŒçš„å¯¹è¯æ ¼å¼ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šè‡ªåŠ¨å¤„ç†</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># ã€å‚æ•°è¯¦è§£ã€‘</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># messages: å¯¹è¯æ¶ˆæ¯åˆ—è¡¨</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># tokenize=False:</span>
    <span class="hljs-comment">#   - False: è¿”å›æ ¼å¼åŒ–åçš„å­—ç¬¦ä¸²ï¼ˆäººç±»å¯è¯»ï¼‰</span>
    <span class="hljs-comment">#   - True: è¿”å› token ID åˆ—è¡¨ï¼ˆæ•°å­—åºåˆ—ï¼‰</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># add_generation_prompt=True:</span>
    <span class="hljs-comment">#   - True: åœ¨æœ«å°¾æ·»åŠ  assistant çš„å¼€å§‹æ ‡è®°</span>
    <span class="hljs-comment">#   - è¿™å‘Šè¯‰æ¨¡å‹"ç°åœ¨è¯¥ä½ å›ç­”äº†"</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># enable_thinking=True: (Qwen3 ç‰¹æœ‰å‚æ•°)</span>
    <span class="hljs-comment">#   - True: å¼€å¯æ€è€ƒæ¨¡å¼</span>
    <span class="hljs-comment">#   - æ¨¡å‹ä¼šå…ˆç”Ÿæˆæ€è€ƒè¿‡ç¨‹ &lt;think&gt;...&lt;/think&gt;</span>
    <span class="hljs-comment">#   - ç„¶åå†ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ</span>
    <span class="hljs-comment">#   - ç±»ä¼¼äº DeepSeek-R1 å’Œ o1 çš„æ¨ç†èƒ½åŠ›</span>

    <span class="hljs-comment"># --------------------------------------------------------</span>
    <span class="hljs-comment"># è°ƒç”¨æ¨ç†å‡½æ•°</span>
    <span class="hljs-comment"># --------------------------------------------------------</span>
    outputs = get_completion(
        text,                  <span class="hljs-comment"># æ ¼å¼åŒ–åçš„è¾“å…¥æ–‡æœ¬</span>
        model,                 <span class="hljs-comment"># æ¨¡å‹è·¯å¾„</span>
        tokenizer=<span class="hljs-literal">None</span>,        <span class="hljs-comment"># ä½¿ç”¨æ¨¡å‹è‡ªå¸¦çš„åˆ†è¯å™¨</span>
        temperature=<span class="hljs-number">0.6</span>,       <span class="hljs-comment"># æ¸©åº¦å‚æ•°</span>
        top_p=<span class="hljs-number">0.95</span>,            <span class="hljs-comment"># æ ¸é‡‡æ ·å‚æ•°</span>
        top_k=<span class="hljs-number">20</span>,              <span class="hljs-comment"># Top-K é‡‡æ ·å‚æ•°</span>
        min_p=<span class="hljs-number">0</span>                <span class="hljs-comment"># æœ€å°æ¦‚ç‡é˜ˆå€¼</span>
    )
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># ã€æ€è€ƒæ¨¡å¼æ¨èå‚æ•°ã€‘</span>
    <span class="hljs-comment"># å®˜æ–¹æ¨èçš„æ€è€ƒæ¨¡å¼é‡‡æ ·å‚æ•°ï¼š</span>
    <span class="hljs-comment"># - temperature=0.6ï¼šé€‚ä¸­çš„éšæœºæ€§</span>
    <span class="hljs-comment"># - top_p=0.95ï¼šä¿ç•™ 95% æ¦‚ç‡è´¨é‡çš„ token</span>
    <span class="hljs-comment"># - top_k=20ï¼šåªè€ƒè™‘æ¦‚ç‡å‰ 20 çš„ token</span>

    <span class="hljs-comment"># --------------------------------------------------------</span>
    <span class="hljs-comment"># æ‰“å°ç»“æœ</span>
    <span class="hljs-comment"># --------------------------------------------------------</span>
    <span class="hljs-keyword">for</span> output <span class="hljs-keyword">in</span> outputs:
        prompt = output.prompt
        generated_text = output.outputs[<span class="hljs-number">0</span>].text
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Prompt: <span class="hljs-subst">{prompt!r}</span>, \nResponse: <span class="hljs-subst">{generated_text!r}</span>"</span>)
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># ã€for å¾ªç¯è¯­æ³•ã€‘</span>
    <span class="hljs-comment"># for å˜é‡ in å¯è¿­ä»£å¯¹è±¡:</span>
    <span class="hljs-comment">#     å¾ªç¯ä½“</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># outputs æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œfor å¾ªç¯ä¼šéå†å…¶ä¸­æ¯ä¸ªå…ƒç´ </span>
    <span class="hljs-comment"># æ¯æ¬¡å¾ªç¯ï¼Œoutput å˜é‡ä¼šè¢«èµ‹å€¼ä¸ºåˆ—è¡¨ä¸­çš„ä¸€ä¸ªå…ƒç´ </span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># ã€è®¿é—®å¯¹è±¡å±æ€§ã€‘</span>
    <span class="hljs-comment"># output.prompt: è·å– output å¯¹è±¡çš„ prompt å±æ€§</span>
    <span class="hljs-comment"># output.outputs: è·å– outputs å±æ€§ï¼ˆæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼‰</span>
    <span class="hljs-comment"># output.outputs[0]: è·å–ç¬¬ä¸€ä¸ªå…ƒç´ </span>
    <span class="hljs-comment"># output.outputs[0].text: è·å–å…¶ text å±æ€§</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># ã€f-string ä¸­çš„ !rã€‘</span>
    <span class="hljs-comment"># {å˜é‡!r} ä½¿ç”¨ repr() æ ¼å¼åŒ–</span>
    <span class="hljs-comment"># repr() ä¼šæ˜¾ç¤ºå­—ç¬¦ä¸²çš„"åŸå§‹"å½¢å¼ï¼ŒåŒ…æ‹¬ç‰¹æ®Šå­—ç¬¦</span>
</code></pre>
<h4 data-id="heading-37">6.2 è¿è¡Œæ¨ç†è„šæœ¬</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> /root/autodl-tmp &amp;&amp; python vllm_model.py
</code></pre>
<p><strong>é¦–æ¬¡è¿è¡Œè¯´æ˜</strong>ï¼š</p>






























<table><thead><tr><th>é˜¶æ®µ</th><th>è€—æ—¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>æ¨¡å‹åŠ è½½</td><td>~30ç§’</td><td>è¯»å– 16GB æ¨¡å‹æƒé‡åˆ° GPU</td></tr><tr><td>ç¼–è¯‘ä¼˜åŒ–</td><td>~60ç§’</td><td>vLLM ç¼–è¯‘å’Œä¼˜åŒ–è®¡ç®—å›¾</td></tr><tr><td>CUDA Graph</td><td>~30ç§’</td><td>æ•è·ä¸åŒè¾“å…¥é•¿åº¦çš„è®¡ç®—å›¾</td></tr><tr><td>æ¨ç†</td><td>~10ç§’</td><td>å®é™…ç”Ÿæˆæ–‡æœ¬</td></tr></tbody></table>
<p><strong>é¢„æœŸè¾“å‡º</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">INFO 12-23 11:45:25 <span class="hljs-section">[__init__.py:239]</span> Automatically detected platform cuda.
INFO 12-23 11:45:40 <span class="hljs-section">[config.py:717]</span> This model supports multiple tasks...
...
INFO 12-23 11:47:30 <span class="hljs-section">[gpu_model_runner.py:1329]</span> Starting to compile...
INFO 12-23 11:49:03 <span class="hljs-section">[monitor.py:33]</span> torch.compile takes 52.65 s in total
INFO 12-23 11:49:36 <span class="hljs-section">[gpu_model_runner.py:1686]</span> Graph capturing finished in 31 secs
INFO 12-23 11:49:36 <span class="hljs-section">[core.py:159]</span> init engine took 119.94 seconds
Prompt: '&lt;|im_start|&gt;user\nç»™æˆ‘ä¸€ä¸ªå…³äºå¤§æ¨¡å‹çš„ç®€çŸ­ä»‹ç»ã€‚&lt;|im_end|&gt;\n&lt;|im_start|&gt;assistant\n',
Response: '&lt;think&gt;\nå—¯ï¼Œç”¨æˆ·é—®çš„æ˜¯å¤§æ¨¡å‹çš„ç®€çŸ­ä»‹ç»...\n&lt;/think&gt;\n\nå¤§æ¨¡å‹æ˜¯...'
</code></pre>
<p><strong>ã€æˆªå›¾ä½ç½®ï¼šPython è„šæœ¬æ¨ç†æˆåŠŸã€‘</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cab71ebe6c1e452a8f8de0a06252bd55~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=ALgLYR%2FFErls4D%2Baao2cZzM8igU%3D" alt="alt text" loading="lazy"/></p>
<h4 data-id="heading-38">6.3 è¡¥å……ï¼šä¸å¯ç”¨æ€è€ƒæ¨¡å¼çš„æ¨ç†è„šæœ¬</h4>
<p>åœ¨ <code>/root/autodl-tmp/</code> ç›®å½•ä¸‹åˆ›å»º <code>vllm_without_thinking.py</code> æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># vllm_without_thinking.py - ä¸å¯ç”¨æ€è€ƒæ¨¡å¼çš„ vLLM æ¨ç†è„šæœ¬</span>
<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€ä¸ vllm_model.py çš„åŒºåˆ«ã€‘</span>
<span class="hljs-comment"># - enable_thinking=Falseï¼šä¸å¯ç”¨æ€è€ƒæ¨¡å¼</span>
<span class="hljs-comment"># - temperature=0.7ï¼šéæ€è€ƒæ¨¡å¼æ¨èå‚æ•°</span>
<span class="hljs-comment"># - top_p=0.8ï¼šéæ€è€ƒæ¨¡å¼æ¨èå‚æ•°</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€æ–‡ä»¶è·¯å¾„ã€‘</span>
<span class="hljs-comment"># /root/autodl-tmp/vllm_without_thinking.py</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-keyword">from</span> vllm <span class="hljs-keyword">import</span> LLM, SamplingParams
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> json

<span class="hljs-comment"># è‡ªåŠ¨ä¸‹è½½æ¨¡å‹æ—¶ï¼ŒæŒ‡å®šä½¿ç”¨modelscopeï¼›å¦åˆ™ï¼Œä¼šä»HuggingFaceä¸‹è½½</span>
os.environ[<span class="hljs-string">'VLLM_USE_MODELSCOPE'</span>]=<span class="hljs-string">'True'</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_completion</span>(<span class="hljs-params">prompts, model, tokenizer=<span class="hljs-literal">None</span>, temperature=<span class="hljs-number">0.6</span>, top_p=<span class="hljs-number">0.95</span>, top_k=<span class="hljs-number">20</span>, min_p=<span class="hljs-number">0</span>, max_tokens=<span class="hljs-number">4096</span>, max_model_len=<span class="hljs-number">8192</span></span>):
    stop_token_ids = [<span class="hljs-number">151645</span>, <span class="hljs-number">151643</span>]
    <span class="hljs-comment"># åˆ›å»ºé‡‡æ ·å‚æ•°ã€‚temperature æ§åˆ¶ç”Ÿæˆæ–‡æœ¬çš„å¤šæ ·æ€§ï¼Œtop_p æ§åˆ¶æ ¸å¿ƒé‡‡æ ·çš„æ¦‚ç‡ï¼Œtop_k é€‰æ‹©æ¦‚ç‡æœ€é«˜çš„kä¸ªæ ‡è®°</span>
    sampling_params = SamplingParams(temperature=temperature, top_p=top_p, top_k=top_k, min_p=min_p, max_tokens=max_tokens, stop_token_ids=stop_token_ids)
    <span class="hljs-comment"># åˆå§‹åŒ– vLLM æ¨ç†å¼•æ“</span>
    llm = LLM(model=model, tokenizer=tokenizer, max_model_len=max_model_len, trust_remote_code=<span class="hljs-literal">True</span>)
    outputs = llm.generate(prompts, sampling_params)
    <span class="hljs-keyword">return</span> outputs


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-comment"># åˆå§‹åŒ– vLLM æ¨ç†å¼•æ“</span>
    model=<span class="hljs-string">'/root/autodl-tmp/Qwen/Qwen3-8B'</span> <span class="hljs-comment"># æŒ‡å®šæ¨¡å‹è·¯å¾„</span>
    tokenizer = AutoTokenizer.from_pretrained(model, use_fast=<span class="hljs-literal">False</span>) <span class="hljs-comment"># åŠ è½½åˆ†è¯å™¨</span>

    prompt = <span class="hljs-string">"ä½ æ˜¯è°ï¼Ÿ"</span>
    messages = [
        {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: prompt}
    ]
    text = tokenizer.apply_chat_template(
        messages,
        tokenize=<span class="hljs-literal">False</span>,
        add_generation_prompt=<span class="hljs-literal">True</span>,
        enable_thinking=<span class="hljs-literal">False</span>  <span class="hljs-comment"># æ˜¯å¦å¼€å¯æ€è€ƒæ¨¡å¼ï¼Œé»˜è®¤ä¸º True</span>
    )

    <span class="hljs-comment"># ============================================================</span>
    <span class="hljs-comment"># ã€éæ€è€ƒæ¨¡å¼æ¨èå‚æ•°ã€‘</span>
    <span class="hljs-comment"># temperature=0.7ï¼šæ¯”æ€è€ƒæ¨¡å¼ç¨é«˜ï¼Œå¢åŠ åˆ›æ„æ€§</span>
    <span class="hljs-comment"># top_p=0.8ï¼šæ¯”æ€è€ƒæ¨¡å¼ç¨ä½ï¼Œæ›´èšç„¦</span>
    <span class="hljs-comment"># top_k=20ï¼šä¿æŒä¸å˜</span>
    <span class="hljs-comment"># ============================================================</span>
    outputs = get_completion(text, model, tokenizer=<span class="hljs-literal">None</span>, temperature=<span class="hljs-number">0.7</span>, top_p=<span class="hljs-number">0.8</span>, top_k=<span class="hljs-number">20</span>, min_p=<span class="hljs-number">0</span>, max_tokens=<span class="hljs-number">4096</span>)

    <span class="hljs-comment"># è¾“å‡ºæ˜¯ä¸€ä¸ªåŒ…å« promptã€ç”Ÿæˆæ–‡æœ¬å’Œå…¶ä»–ä¿¡æ¯çš„ RequestOutput å¯¹è±¡åˆ—è¡¨ã€‚</span>
    <span class="hljs-comment"># æ‰“å°è¾“å‡ºã€‚</span>
    <span class="hljs-keyword">for</span> output <span class="hljs-keyword">in</span> outputs:
        prompt = output.prompt
        generated_text = output.outputs[<span class="hljs-number">0</span>].text
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Prompt: <span class="hljs-subst">{prompt!r}</span>,Response: <span class="hljs-subst">{generated_text!r}</span>"</span>)
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/385a87de15ee4cc1b91a4e279bf01339~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=6q5kD31J1Ne5Ug920COc972nj6o%3D" alt="alt text" loading="lazy"/></p>
<p><strong>ã€æ€è€ƒæ¨¡å¼ vs éæ€è€ƒæ¨¡å¼å¯¹æ¯”ã€‘</strong></p>



































<table><thead><tr><th>å‚æ•°</th><th align="center">æ€è€ƒæ¨¡å¼ (<code>enable_thinking=True</code>)</th><th align="center">éæ€è€ƒæ¨¡å¼ (<code>enable_thinking=False</code>)</th></tr></thead><tbody><tr><td><code>temperature</code></td><td align="center">0.6</td><td align="center">0.7</td></tr><tr><td><code>top_p</code></td><td align="center">0.95</td><td align="center">0.8</td></tr><tr><td><code>top_k</code></td><td align="center">20</td><td align="center">20</td></tr><tr><td>è¾“å‡ºç‰¹ç‚¹</td><td align="center">åŒ…å« <code>&lt;think&gt;...&lt;/think&gt;</code> æ€è€ƒè¿‡ç¨‹</td><td align="center">ç›´æ¥è¾“å‡ºç­”æ¡ˆï¼Œæ— æ€è€ƒè¿‡ç¨‹</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td align="center">å¤æ‚æ¨ç†ã€æ•°å­¦é¢˜ã€é€»è¾‘åˆ†æ</td><td align="center">ç®€å•é—®ç­”ã€åˆ›æ„å†™ä½œã€å¿«é€Ÿå“åº”</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-39">7. å¯åŠ¨APIæœåŠ¡å™¨</h3>
<h4 data-id="heading-40">7.1 vLLM æœåŠ¡å™¨ç®€ä»‹</h4>
<p>vLLM å¯ä»¥å¯åŠ¨ä¸€ä¸ªå…¼å®¹ OpenAI API çš„ HTTP æœåŠ¡å™¨ï¼Œè¿™æ ·ä½ å°±å¯ä»¥ï¼š</p>
<ul>
<li>ä½¿ç”¨ HTTP è¯·æ±‚è°ƒç”¨æ¨¡å‹</li>
<li>ä½¿ç”¨ OpenAI Python SDK è°ƒç”¨</li>
<li>é›†æˆåˆ°ä»»ä½•æ”¯æŒ OpenAI API çš„åº”ç”¨ä¸­</li>
</ul>
<h4 data-id="heading-41">7.2 å¯åŠ¨æœåŠ¡å™¨å‘½ä»¤</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># å¯åŠ¨ vLLM OpenAI å…¼å®¹ API æœåŠ¡å™¨</span>
<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€å‘½ä»¤æ ¼å¼ã€‘</span>
<span class="hljs-comment"># ç¯å¢ƒå˜é‡=å€¼ å‘½ä»¤ å‚æ•°1 å‚æ•°2 ...</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€ç¯å¢ƒå˜é‡ã€‘</span>
<span class="hljs-comment"># VLLM_USE_MODELSCOPE=true</span>
<span class="hljs-comment">#   - è®¾ç½®åœ¨å‘½ä»¤å‰ï¼Œåªå¯¹è¿™ä¸ªå‘½ä»¤ç”Ÿæ•ˆ</span>
<span class="hljs-comment">#   - å‘½ä»¤ç»“æŸåç¯å¢ƒå˜é‡ä¸ä¿ç•™</span>
<span class="hljs-comment">#   - å‘Šè¯‰ vLLM ä½¿ç”¨ ModelScope ä½œä¸ºæ¨¡å‹æº</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€vllm serve å‘½ä»¤ã€‘</span>
<span class="hljs-comment"># vllm æ˜¯å‘½ä»¤è¡Œå·¥å…·</span>
<span class="hljs-comment"># serve æ˜¯å­å‘½ä»¤ï¼Œè¡¨ç¤ºå¯åŠ¨ API æœåŠ¡å™¨</span>
<span class="hljs-comment"># ============================================================</span>

VLLM_USE_MODELSCOPE=<span class="hljs-literal">true</span> vllm serve /root/autodl-tmp/Qwen/Qwen3-8B \
    --served-model-name Qwen3-8B \
    --max_model_len 8192 \
    --enable-reasoning \
    --reasoning-parser deepseek_r1
</code></pre>
<p><strong>ã€å‘½ä»¤å‚æ•°è¯¦è§£ã€‘</strong></p>



































<table><thead><tr><th>å‚æ•°</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>ç¬¬ä¸€ä¸ªå‚æ•°</td><td><code>/root/autodl-tmp/Qwen/Qwen3-8B</code></td><td>æ¨¡å‹è·¯å¾„ï¼ˆä½ç½®å‚æ•°ï¼‰</td></tr><tr><td><code>--served-model-name</code></td><td><code>Qwen3-8B</code></td><td>API ä¸­ä½¿ç”¨çš„æ¨¡å‹åç§°</td></tr><tr><td><code>--max_model_len</code></td><td><code>8192</code></td><td>æœ€å¤§ä¸Šä¸‹æ–‡é•¿åº¦</td></tr><tr><td><code>--enable-reasoning</code></td><td>(æ— å€¼)</td><td>å¯ç”¨æ¨ç†/æ€è€ƒæ¨¡å¼</td></tr><tr><td><code>--reasoning-parser</code></td><td><code>deepseek_r1</code></td><td>æ€è€ƒå†…å®¹è§£æå™¨</td></tr></tbody></table>
<p><strong>ã€åæ–œæ  \ çš„ä½œç”¨ã€‘</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨ Shell ä¸­ï¼Œåæ–œæ  \ ç”¨äºæ¢è¡Œç»­å†™</span>
<span class="hljs-comment"># å®ƒå‘Šè¯‰ Shell "å‘½ä»¤è¿˜æ²¡ç»“æŸï¼Œä¸‹ä¸€è¡Œæ˜¯ç»§ç»­"</span>
<span class="hljs-comment"># è¿™æ ·å¯ä»¥æŠŠå¾ˆé•¿çš„å‘½ä»¤åˆ†æˆå¤šè¡Œï¼Œæ›´å®¹æ˜“é˜…è¯»</span>
</code></pre>
<h4 data-id="heading-42">7.3 å¯åŠ¨è¾“å‡ºè¯´æ˜</h4>
<p>å¯åŠ¨æˆåŠŸåï¼Œä½ ä¼šçœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">INFO</span> <span class="hljs-number">12</span><span class="hljs-number">-23</span> <span class="hljs-number">12</span><span class="hljs-string">:00:24</span> [<span class="hljs-string">__init__.py:239</span>] <span class="hljs-string">Automatically</span> <span class="hljs-string">detected</span> <span class="hljs-string">platform</span> <span class="hljs-string">cuda.</span>
<span class="hljs-string">INFO</span> <span class="hljs-number">12</span><span class="hljs-number">-23</span> <span class="hljs-number">12</span><span class="hljs-string">:00:29</span> [<span class="hljs-string">api_server.py:1043</span>] <span class="hljs-string">vLLM</span> <span class="hljs-string">API</span> <span class="hljs-string">server</span> <span class="hljs-string">version</span> <span class="hljs-number">0.8</span><span class="hljs-number">.5</span><span class="hljs-string">.post1</span>
<span class="hljs-string">...</span>
<span class="hljs-string">INFO</span> <span class="hljs-number">12</span><span class="hljs-number">-23</span> <span class="hljs-number">12</span><span class="hljs-string">:03:02</span> [<span class="hljs-string">launcher.py:36</span>] <span class="hljs-attr">Route:</span> <span class="hljs-string">/v1/chat/completions,</span> <span class="hljs-attr">Methods:</span> <span class="hljs-string">POST</span>
<span class="hljs-string">INFO</span> <span class="hljs-number">12</span><span class="hljs-number">-23</span> <span class="hljs-number">12</span><span class="hljs-string">:03:02</span> [<span class="hljs-string">launcher.py:36</span>] <span class="hljs-attr">Route:</span> <span class="hljs-string">/v1/completions,</span> <span class="hljs-attr">Methods:</span> <span class="hljs-string">POST</span>
<span class="hljs-string">INFO</span> <span class="hljs-number">12</span><span class="hljs-number">-23</span> <span class="hljs-number">12</span><span class="hljs-string">:03:02</span> [<span class="hljs-string">launcher.py:36</span>] <span class="hljs-attr">Route:</span> <span class="hljs-string">/v1/models,</span> <span class="hljs-attr">Methods:</span> <span class="hljs-string">GET</span>
<span class="hljs-string">...</span>
<span class="hljs-attr">INFO:</span>     <span class="hljs-string">Started</span> <span class="hljs-string">server</span> <span class="hljs-string">process</span> [<span class="hljs-number">10358</span>]
<span class="hljs-attr">INFO:</span>     <span class="hljs-string">Waiting</span> <span class="hljs-string">for</span> <span class="hljs-string">application</span> <span class="hljs-string">startup.</span>
<span class="hljs-attr">INFO:</span>     <span class="hljs-string">Application</span> <span class="hljs-string">startup</span> <span class="hljs-string">complete.</span>
</code></pre>
<h5 data-id="heading-43">API ç«¯ç‚¹è¯´æ˜</h5>








































<table><thead><tr><th>ç«¯ç‚¹</th><th>æ–¹æ³•</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>/v1/models</code></td><td>GET</td><td>è·å–å¯ç”¨æ¨¡å‹åˆ—è¡¨</td></tr><tr><td><code>/v1/chat/completions</code></td><td>POST</td><td><strong>å¯¹è¯è¡¥å…¨</strong>ï¼ˆæ¨èä½¿ç”¨ï¼‰</td></tr><tr><td><code>/v1/completions</code></td><td>POST</td><td>æ–‡æœ¬è¡¥å…¨</td></tr><tr><td><code>/v1/embeddings</code></td><td>POST</td><td>è·å–æ–‡æœ¬åµŒå…¥å‘é‡</td></tr><tr><td><code>/health</code></td><td>GET</td><td>å¥åº·æ£€æŸ¥</td></tr><tr><td><code>/metrics</code></td><td>GET</td><td>Prometheus ç›‘æ§æŒ‡æ ‡</td></tr></tbody></table>
<p><strong>ã€æˆªå›¾ï¼švLLM æœåŠ¡å™¨å¯åŠ¨æˆåŠŸã€‘</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f233610318a84be1b7d9ad590fef1360~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=PaYj4N9XEjcpRXfat32p1TIqxuY%3D" alt="alt text" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b9a41336bb748939a1d765a1e63a670~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=DBajbBcyW17Fg%2BlMy6gDpD4JrXk%3D" alt="alt text" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34867ea14bd94596b5a57eb4c35cd3a0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=DQGf9kUmJnhiNCVxztOMPJbYhoI%3D" alt="alt text" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-44">8. APIæ¥å£æµ‹è¯•</h3>
<blockquote>
<p><strong>é‡è¦æç¤º</strong>ï¼šå¯åŠ¨æœåŠ¡å™¨åï¼Œéœ€è¦<strong>æ‰“å¼€ä¸€ä¸ªæ–°ç»ˆç«¯</strong>æ¥æµ‹è¯• APIã€‚
æœåŠ¡å™¨ç»ˆç«¯éœ€è¦ä¿æŒè¿è¡Œï¼Œä¸è¦å…³é—­ã€‚</p>
</blockquote>
<h4 data-id="heading-45">8.1 ä½¿ç”¨ curl æµ‹è¯•</h4>
<h5 data-id="heading-46">æµ‹è¯• 1ï¼šæ£€æŸ¥æ¨¡å‹åˆ—è¡¨</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># è·å–å¯ç”¨æ¨¡å‹åˆ—è¡¨</span>
<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€curl å‘½ä»¤è¯´æ˜ã€‘</span>
<span class="hljs-comment"># curl: Client URLï¼Œå‘½ä»¤è¡Œ HTTP å®¢æˆ·ç«¯å·¥å…·</span>
<span class="hljs-comment"># ç”¨äºå‘é€ HTTP è¯·æ±‚å¹¶æ˜¾ç¤ºå“åº”</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€å‘½ä»¤æ ¼å¼ã€‘</span>
<span class="hljs-comment"># curl [é€‰é¡¹] URL</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># è¿™é‡Œæ²¡æœ‰é¢å¤–é€‰é¡¹ï¼Œå‘é€ä¸€ä¸ªç®€å•çš„ GET è¯·æ±‚</span>
<span class="hljs-comment"># ============================================================</span>

curl http://localhost:8000/v1/models
</code></pre>
<p><strong>é¢„æœŸè¾“å‡º</strong>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"object"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"list"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Qwen3-8B"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"object"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"model"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"created"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1703318400</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"owned_by"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vllm"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h5 data-id="heading-47">æµ‹è¯• 2ï¼šå‘é€å¯¹è¯è¯·æ±‚</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># å‘é€å¯¹è¯è¡¥å…¨è¯·æ±‚</span>
<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€curl å‚æ•°è¯´æ˜ã€‘</span>
<span class="hljs-comment"># -H: Headerï¼Œè®¾ç½® HTTP è¯·æ±‚å¤´</span>
<span class="hljs-comment"># -d: Dataï¼Œè®¾ç½®è¯·æ±‚ä½“ï¼ˆPOST æ•°æ®ï¼‰</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># å½“ä½¿ç”¨ -d å‚æ•°æ—¶ï¼Œcurl è‡ªåŠ¨ä½¿ç”¨ POST æ–¹æ³•</span>
<span class="hljs-comment"># ============================================================</span>

curl http://localhost:8000/v1/chat/completions \
    -H <span class="hljs-string">"Content-Type: application/json"</span> \
    -d <span class="hljs-string">'{
        "model": "Qwen3-8B",
        "messages": [
            {"role": "user", "content": "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±"}
        ]
    }'</span>
</code></pre>
<p><strong>é¢„æœŸè¾“å‡º</strong>ï¼ˆæ ¼å¼åŒ–åï¼‰ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"chat-xxx"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"object"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"chat.completion"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"created"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1703318500</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Qwen3-8B"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"choices"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"index"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"role"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"assistant"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ å¥½ï¼æˆ‘æ˜¯é€šä¹‰åƒé—®..."</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"reasoning_content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ç”¨æˆ·åœ¨æ‰“æ‹›å‘¼å¹¶è¯¢é—®æˆ‘çš„èº«ä»½..."</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"finish_reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"stop"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"usage"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"prompt_tokens"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"completion_tokens"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">50</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"total_tokens"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">60</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>ã€å“åº”å­—æ®µè¯´æ˜ã€‘</strong></p>

































<table><thead><tr><th>å­—æ®µ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>id</code></td><td>è¯·æ±‚å”¯ä¸€æ ‡è¯†ç¬¦</td></tr><tr><td><code>choices[0].message.content</code></td><td>æ¨¡å‹çš„å›å¤å†…å®¹</td></tr><tr><td><code>choices[0].message.reasoning_content</code></td><td>æ¨¡å‹çš„æ€è€ƒè¿‡ç¨‹</td></tr><tr><td><code>usage.prompt_tokens</code></td><td>è¾“å…¥æ¶ˆè€—çš„ token æ•°</td></tr><tr><td><code>usage.completion_tokens</code></td><td>è¾“å‡ºæ¶ˆè€—çš„ token æ•°</td></tr><tr><td><code>finish_reason</code></td><td>ç»“æŸåŸå› ï¼ˆstop=æ­£å¸¸ç»“æŸï¼‰</td></tr></tbody></table>
<h4 data-id="heading-48">8.2 ä½¿ç”¨ Python æµ‹è¯•</h4>
<h5 data-id="heading-49">åˆ›å»ºæµ‹è¯•è„šæœ¬</h5>
<p>åœ¨ <code>/root/autodl-tmp/</code> ç›®å½•ä¸‹åˆ›å»º <code>test_api.py</code> æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># test_api.py - vLLM API æµ‹è¯•è„šæœ¬</span>
<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€è„šæœ¬åŠŸèƒ½ã€‘</span>
<span class="hljs-comment"># ä½¿ç”¨ OpenAI Python SDK è°ƒç”¨ vLLM æœåŠ¡å™¨</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€æ–‡ä»¶è·¯å¾„ã€‘</span>
<span class="hljs-comment"># /root/autodl-tmp/test_api.py</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€ä¸ºä»€ä¹ˆèƒ½ç”¨ OpenAI SDKï¼Ÿã€‘</span>
<span class="hljs-comment"># vLLM çš„ API ä¸ OpenAI API æ ¼å¼å®Œå…¨å…¼å®¹</span>
<span class="hljs-comment"># åªéœ€è¦ä¿®æ”¹ base_url æŒ‡å‘æœ¬åœ°æœåŠ¡å™¨å³å¯</span>
<span class="hljs-comment"># è¿™æ„å‘³ç€ä»»ä½•ä½¿ç”¨ OpenAI API çš„ä»£ç ï¼Œå‡ ä¹ä¸ç”¨ä¿®æ”¹å°±èƒ½ç”¨ vLLM</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># å¯¼å…¥ OpenAI å®¢æˆ·ç«¯</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-keyword">from</span> openai <span class="hljs-keyword">import</span> OpenAI
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€å®‰è£…æ–¹å¼ã€‘</span>
<span class="hljs-comment"># pip install openai</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€è¯´æ˜ã€‘</span>
<span class="hljs-comment"># openai æ˜¯ OpenAI å®˜æ–¹ Python SDK</span>
<span class="hljs-comment"># è™½ç„¶å« "openai"ï¼Œä½†å®ƒå¯ä»¥è¿æ¥ä»»ä½•å…¼å®¹çš„ API æœåŠ¡å™¨</span>

<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># åˆ›å»ºå®¢æˆ·ç«¯</span>
<span class="hljs-comment"># ============================================================</span>

client = OpenAI(
    base_url=<span class="hljs-string">"http://localhost:8000/v1"</span>,  <span class="hljs-comment"># API åŸºç¡€åœ°å€</span>
    api_key=<span class="hljs-string">"sk-xxx"</span>                       <span class="hljs-comment"># API å¯†é’¥</span>
)
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€å‚æ•°è¯´æ˜ã€‘</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># base_url: API çš„åŸºç¡€ URL</span>
<span class="hljs-comment">#   - é»˜è®¤å€¼æ˜¯ "https://api.openai.com/v1"ï¼ˆOpenAI å®˜æ–¹ï¼‰</span>
<span class="hljs-comment">#   - ä¿®æ”¹ä¸ºæœ¬åœ° vLLM æœåŠ¡å™¨åœ°å€</span>
<span class="hljs-comment">#   - localhost:8000 æ˜¯ vLLM é»˜è®¤ç›‘å¬çš„åœ°å€å’Œç«¯å£</span>
<span class="hljs-comment">#   - /v1 æ˜¯ API ç‰ˆæœ¬è·¯å¾„</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># api_key: API å¯†é’¥</span>
<span class="hljs-comment">#   - è°ƒç”¨ OpenAI å®˜æ–¹éœ€è¦çœŸå®çš„ API Key</span>
<span class="hljs-comment">#   - è°ƒç”¨ vLLM ä¸éªŒè¯å¯†é’¥ï¼Œä½†å‚æ•°ä¸èƒ½çœç•¥</span>
<span class="hljs-comment">#   - éšä¾¿å¡«ä¸€ä¸ªå­—ç¬¦ä¸²å³å¯ï¼Œå¦‚ "sk-xxx"</span>

<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># å‘é€å¯¹è¯è¯·æ±‚</span>
<span class="hljs-comment"># ============================================================</span>

chat_outputs = client.chat.completions.create(
    model=<span class="hljs-string">"Qwen3-8B"</span>,
    messages=[
        {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä»€ä¹ˆæ˜¯æ·±åº¦å­¦ä¹ ï¼Ÿ"</span>}
    ]
)
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€æ–¹æ³•è°ƒç”¨é“¾è¯´æ˜ã€‘</span>
<span class="hljs-comment"># client.chat.completions.create(...)</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ç»“æ„ï¼š</span>
<span class="hljs-comment"># - client: OpenAI å®¢æˆ·ç«¯å¯¹è±¡</span>
<span class="hljs-comment"># - .chat: èŠå¤©ç›¸å…³çš„ API å‘½åç©ºé—´</span>
<span class="hljs-comment"># - .completions: è¡¥å…¨ç›¸å…³çš„æ“ä½œ</span>
<span class="hljs-comment"># - .create(): åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è¯è¡¥å…¨</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€å‚æ•°è¯´æ˜ã€‘</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># model: strï¼ˆå¿…éœ€ï¼‰</span>
<span class="hljs-comment">#   - è¦ä½¿ç”¨çš„æ¨¡å‹åç§°</span>
<span class="hljs-comment">#   - å¿…é¡»ä¸ vLLM å¯åŠ¨æ—¶çš„ --served-model-name ä¸€è‡´</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># messages: list[dict]ï¼ˆå¿…éœ€ï¼‰</span>
<span class="hljs-comment">#   - å¯¹è¯æ¶ˆæ¯åˆ—è¡¨</span>
<span class="hljs-comment">#   - æ¯ä¸ªæ¶ˆæ¯æ˜¯å­—å…¸ï¼ŒåŒ…å« role å’Œ content</span>

<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># æ‰“å°å®Œæ•´å“åº”</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-built_in">print</span>(<span class="hljs-string">"ã€å®Œæ•´å“åº”å¯¹è±¡ã€‘"</span>)
<span class="hljs-built_in">print</span>(chat_outputs)

<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># æå–ä¸»è¦å†…å®¹</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span> * <span class="hljs-number">50</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"ã€æ¨¡å‹å›å¤ã€‘"</span>)
<span class="hljs-built_in">print</span>(chat_outputs.choices[<span class="hljs-number">0</span>].message.content)
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€è®¿é—®å“åº”å†…å®¹ã€‘</span>
<span class="hljs-comment"># chat_outputs.choices[0].message.content</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># å±‚çº§ç»“æ„ï¼š</span>
<span class="hljs-comment"># chat_outputs          # ChatCompletion å¯¹è±¡</span>
<span class="hljs-comment">#   .choices            # é€‰é¡¹åˆ—è¡¨ï¼ˆé€šå¸¸åªæœ‰ä¸€ä¸ªï¼‰</span>
<span class="hljs-comment">#     [0]               # ç¬¬ä¸€ä¸ªé€‰é¡¹ï¼ˆç´¢å¼•ä» 0 å¼€å§‹ï¼‰</span>
<span class="hljs-comment">#       .message        # æ¶ˆæ¯å¯¹è±¡</span>
<span class="hljs-comment">#         .content      # æ¶ˆæ¯æ–‡æœ¬å†…å®¹</span>

<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># è·å–æ€è€ƒè¿‡ç¨‹ï¼ˆå¦‚æœæœ‰ï¼‰</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-comment"># hasattr(å¯¹è±¡, å±æ€§å): æ£€æŸ¥å¯¹è±¡æ˜¯å¦æœ‰æŸä¸ªå±æ€§</span>
<span class="hljs-comment"># è¿”å› True æˆ– False</span>
<span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(chat_outputs.choices[<span class="hljs-number">0</span>].message, <span class="hljs-string">'reasoning_content'</span>):
    reasoning = chat_outputs.choices[<span class="hljs-number">0</span>].message.reasoning_content
    <span class="hljs-comment"># æ£€æŸ¥ reasoning æ˜¯å¦æœ‰å€¼ï¼ˆä¸æ˜¯ None æˆ–ç©ºå­—ç¬¦ä¸²ï¼‰</span>
    <span class="hljs-keyword">if</span> reasoning:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nã€æ€è€ƒè¿‡ç¨‹ã€‘"</span>)
        <span class="hljs-built_in">print</span>(reasoning)
</code></pre>
<h5 data-id="heading-50">è¿è¡Œæµ‹è¯•è„šæœ¬</h5>
<pre><code class="hljs language-bash" lang="bash">python /root/autodl-tmp/test_api.py
</code></pre>
<p><strong>é¢„æœŸè¾“å‡º</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">ã€å®Œæ•´å“åº”å¯¹è±¡ã€‘
ChatCompletion(<span class="hljs-attr">id</span>=<span class="hljs-string">'chat-xxx'</span>, choices=[...], model=<span class="hljs-string">'Qwen3-8B'</span>, ...)

==================================================
ã€æ¨¡å‹å›å¤ã€‘
æ·±åº¦å­¦ä¹ æ˜¯æœºå™¨å­¦ä¹ çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œå®ƒä½¿ç”¨å¤šå±‚ç¥ç»ç½‘ç»œ...

ã€æ€è€ƒè¿‡ç¨‹ã€‘
ç”¨æˆ·åœ¨è¯¢é—®æ·±åº¦å­¦ä¹ çš„å®šä¹‰ã€‚æˆ‘éœ€è¦ç»™å‡ºä¸€ä¸ªæ¸…æ™°ã€å‡†ç¡®çš„è§£é‡Š...
</code></pre>
<h4 data-id="heading-51">8.3 ç®€æ´ç‰ˆ OpenAI SDK æµ‹è¯•è„šæœ¬</h4>
<h5 data-id="heading-52">vllm_openai_completions.py</h5>
<p>åœ¨ <code>/root/autodl-tmp/</code> ç›®å½•ä¸‹åˆ›å»º <code>vllm_openai_completions.py</code> æ–‡ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯ç”¨æ€è€ƒæ¨¡å¼çš„ç®€æ´ç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># vllm_openai_completions.py - ç®€æ´ç‰ˆ OpenAI SDK æµ‹è¯•ï¼ˆå¯ç”¨æ€è€ƒæ¨¡å¼ï¼‰</span>
<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€æ–‡ä»¶è·¯å¾„ã€‘</span>
<span class="hljs-comment"># /root/autodl-tmp/vllm_openai_completions.py</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€ç‰¹ç‚¹ã€‘</span>
<span class="hljs-comment"># - ä»£ç ç®€æ´ï¼Œé€‚åˆå¿«é€Ÿæµ‹è¯•</span>
<span class="hljs-comment"># - åœ¨ content æœ«å°¾æ·»åŠ  &lt;think&gt;\n è§¦å‘æ€è€ƒæ¨¡å¼</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-keyword">from</span> openai <span class="hljs-keyword">import</span> OpenAI

client = OpenAI(
    base_url=<span class="hljs-string">"http://localhost:8000/v1"</span>,
    api_key=<span class="hljs-string">"sk-xxx"</span>,  <span class="hljs-comment"># éšä¾¿å¡«å†™ï¼Œåªæ˜¯ä¸ºäº†é€šè¿‡æ¥å£å‚æ•°æ ¡éªŒ</span>
)

completion = client.chat.completions.create(
    model=<span class="hljs-string">"Qwen3-8B"</span>,
    messages=[
        {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æˆ‘æƒ³é—®ä½ ï¼Œ5çš„é˜¶ä¹˜æ˜¯å¤šå°‘?&lt;think&gt;\n"</span>}
        <span class="hljs-comment"># ============================================================</span>
        <span class="hljs-comment"># ã€æ€è€ƒæ¨¡å¼è§¦å‘æ–¹å¼ã€‘</span>
        <span class="hljs-comment"># åœ¨ content æœ«å°¾æ·»åŠ  &lt;think&gt;\n å¯ä»¥è§¦å‘æ¨¡å‹çš„æ€è€ƒæ¨¡å¼</span>
        <span class="hljs-comment"># æ¨¡å‹ä¼šå…ˆè¿›è¡Œæ¨ç†æ€è€ƒï¼Œç„¶åç»™å‡ºç­”æ¡ˆ</span>
        <span class="hljs-comment"># ============================================================</span>
    ]
)

<span class="hljs-built_in">print</span>(completion.choices[<span class="hljs-number">0</span>].message)
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b4ae6b9c36a4fa6912af664c72eec84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=nD38RBRXuMMYdkOksWs6PzYWCGQ%3D" alt="alt text" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6e32b8a6d6a0409f912054b520ea1a88~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=2T0%2Bt4b2ihsi0IUSLRAi9K4icNw%3D" alt="alt text" loading="lazy"/></p>
<h5 data-id="heading-53">vllm_openai_chat_completions.py</h5>
<p>åœ¨ <code>/root/autodl-tmp/</code> ç›®å½•ä¸‹åˆ›å»º <code>vllm_openai_chat_completions.py</code> æ–‡ä»¶ï¼Œè¿™æ˜¯å¦ä¸€ä¸ªç®€æ´ç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment"># vllm_openai_chat_completions.py - ç®€æ´ç‰ˆ OpenAI SDK Chat æµ‹è¯•</span>
<span class="hljs-comment"># ============================================================</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€æ–‡ä»¶è·¯å¾„ã€‘</span>
<span class="hljs-comment"># /root/autodl-tmp/vllm_openai_chat_completions.py</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># ã€ç‰¹ç‚¹ã€‘</span>
<span class="hljs-comment"># - ä½¿ç”¨å˜é‡å­˜å‚¨ API é…ç½®ï¼Œä¾¿äºä¿®æ”¹</span>
<span class="hljs-comment"># - ä¸å¯ç”¨æ€è€ƒæ¨¡å¼çš„æ™®é€šå¯¹è¯æµ‹è¯•</span>
<span class="hljs-comment"># ============================================================</span>

<span class="hljs-keyword">from</span> openai <span class="hljs-keyword">import</span> OpenAI

openai_api_key = <span class="hljs-string">"sk-xxx"</span>  <span class="hljs-comment"># éšä¾¿å¡«å†™ï¼Œåªæ˜¯ä¸ºäº†é€šè¿‡æ¥å£å‚æ•°æ ¡éªŒ</span>
openai_api_base = <span class="hljs-string">"http://localhost:8000/v1"</span>

client = OpenAI(
    api_key=openai_api_key,
    base_url=openai_api_base,
)

chat_outputs = client.chat.completions.create(
    model=<span class="hljs-string">"Qwen3-8B"</span>,
    messages=[
        {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä»€ä¹ˆæ˜¯æ·±åº¦å­¦ä¹ ï¼Ÿ"</span>},
    ]
)

<span class="hljs-built_in">print</span>(chat_outputs)
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c08712eaeb73402c8b331c8939ad9e7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=g%2BK7Ihmgz9SkiKYrNxMf5a43l6M%3D" alt="alt text" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/16d63f7dc6b943efa8a6e4070169f450~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWlrdTE2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767112101&amp;x-signature=flzWm8KJ6lxoLLBV%2BhsG9YXlpNY%3D" alt="alt text" loading="lazy"/></p>
<p><strong>ã€ä¸‰ä¸ª API æµ‹è¯•è„šæœ¬å¯¹æ¯”ã€‘</strong></p>





























<table><thead><tr><th>è„šæœ¬åç§°</th><th>åŠŸèƒ½</th><th align="center">æ€è€ƒæ¨¡å¼</th><th>è¾“å‡ºå†…å®¹</th></tr></thead><tbody><tr><td><code>test_api.py</code></td><td>å®Œæ•´ç‰ˆæµ‹è¯•</td><td align="center">ç”±æœåŠ¡å™¨é…ç½®å†³å®š</td><td>å®Œæ•´å“åº” + æå–å†…å®¹ + æ€è€ƒè¿‡ç¨‹</td></tr><tr><td><code>vllm_openai_completions.py</code></td><td>ç®€æ´ç‰ˆ</td><td align="center">æ˜¯ï¼ˆæ‰‹åŠ¨è§¦å‘ï¼‰</td><td>åªæ‰“å° message</td></tr><tr><td><code>vllm_openai_chat_completions.py</code></td><td>ç®€æ´ç‰ˆ</td><td align="center">å¦</td><td>åªæ‰“å°å®Œæ•´å“åº”</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-54">9. å¸¸è§é—®é¢˜ä¸è§£å†³</h3>
<h4 data-id="heading-55">9.1 ç¯å¢ƒç›¸å…³é—®é¢˜</h4>
<h5 data-id="heading-56">é—®é¢˜ 1ï¼šNumPy ç‰ˆæœ¬å†²çª</h5>
<p><strong>é”™è¯¯ä¿¡æ¯</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ValueError: All ufuncs must have <span class="hljs-built_in">type</span> numpy.ufunc
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pip install numpy==1.26.4 scipy==1.13.1 --force-reinstall
</code></pre>
<hr/>
<h5 data-id="heading-57">é—®é¢˜ 2ï¼šNumba ä¸å…¼å®¹</h5>
<p><strong>é”™è¯¯ä¿¡æ¯</strong>ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">ImportError: Numba needs NumPy 2.2 or less. Got NumPy 2.4.</span>
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pip install numpy==2.2.0 --force-reinstall
</code></pre>
<hr/>
<h5 data-id="heading-58">é—®é¢˜ 3ï¼šé€’å½’æ·±åº¦è¶…é™</h5>
<p><strong>é”™è¯¯ä¿¡æ¯</strong>ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">RecursionError: maximum recursion depth exceeded</span>
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pip install scikit-learn --force-reinstall
</code></pre>
<h4 data-id="heading-59">9.2 æ¨¡å‹ä¸‹è½½é—®é¢˜</h4>
<h5 data-id="heading-60">é—®é¢˜ 4ï¼šä¸‹è½½é€Ÿåº¦æ…¢</h5>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>å¼€å¯ AutoDL å­¦æœ¯åŠ é€Ÿï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">source</span> /etc/network_turbo
</code></pre>
<ol start="2">
<li>ä½¿ç”¨åå°ä¸‹è½½ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># nohup: no hangupï¼Œå¿½ç•¥æŒ‚æ–­ä¿¡å·ï¼Œå‘½ä»¤åœ¨åå°è¿è¡Œ</span>
<span class="hljs-comment"># &gt; download.log: å°†æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶</span>
<span class="hljs-comment"># 2&gt;&amp;1: å°†æ ‡å‡†é”™è¯¯ä¹Ÿé‡å®šå‘åˆ°åŒä¸€æ–‡ä»¶</span>
<span class="hljs-comment"># &amp;: æ”¾åˆ°åå°è¿è¡Œ</span>

<span class="hljs-built_in">nohup</span> python model_download.py &gt; download.log 2&gt;&amp;1 &amp;

<span class="hljs-comment"># æŸ¥çœ‹ä¸‹è½½è¿›åº¦</span>
<span class="hljs-built_in">tail</span> -f download.log
<span class="hljs-comment"># tail -f: å®æ—¶æ˜¾ç¤ºæ–‡ä»¶æœ«å°¾çš„æ–°å†…å®¹</span>
<span class="hljs-comment"># æŒ‰ Ctrl+C é€€å‡ºæŸ¥çœ‹ï¼ˆä¸ä¼šåœæ­¢ä¸‹è½½ï¼‰</span>
</code></pre>
<h4 data-id="heading-61">9.3 æ¨ç†é—®é¢˜</h4>
<h5 data-id="heading-62">é—®é¢˜ 5ï¼šæ˜¾å­˜ä¸è¶³ï¼ˆOOMï¼‰</h5>
<p><strong>é”™è¯¯ä¿¡æ¯</strong>ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">torch.cuda.OutOfMemoryError: CUDA <span class="hljs-keyword">out</span> of memory
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–¹æ¡ˆ 1ï¼šå‡å°ä¸Šä¸‹æ–‡é•¿åº¦</span>
vllm serve ... --max_model_len 4096

<span class="hljs-comment"># æ–¹æ¡ˆ 2ï¼šé™ä½ GPU æ˜¾å­˜åˆ©ç”¨ç‡</span>
vllm serve ... --gpu-memory-utilization 0.8
</code></pre>
<hr/>
<h5 data-id="heading-63">é—®é¢˜ 6ï¼šAPI æœåŠ¡å™¨æ— å“åº”</h5>
<p><strong>æ£€æŸ¥æ­¥éª¤</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦è¿è¡Œ</span>
ps aux | grep vllm

<span class="hljs-comment"># 2. æ£€æŸ¥ç«¯å£æ˜¯å¦ç›‘å¬</span>
netstat -tlnp | grep 8000

<span class="hljs-comment"># 3. æµ‹è¯•å¥åº·æ£€æŸ¥æ¥å£</span>
curl http://localhost:8000/health
</code></pre>
<h4 data-id="heading-64">9.4 ä¸ºä»€ä¹ˆä¸èƒ½åœ¨ Colab ä¸­è¿è¡Œï¼Ÿ</h4>
<p><strong>é—®é¢˜</strong>ï¼švLLM åœ¨ Jupyter Notebook ä¸­æŠ¥é”™</p>
<p><strong>é”™è¯¯ä¿¡æ¯</strong>ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">RuntimeError: Cannot re-initialize CUDA in forked subprocess</span>
</code></pre>
<p><strong>åŸå› è§£é‡Š</strong>ï¼š</p>
<p>Jupyter Notebook ä½¿ç”¨ <code>fork()</code> åˆ›å»ºå­è¿›ç¨‹ï¼Œä½† CUDA ä¸å…è®¸åœ¨ fork åçš„è¿›ç¨‹ä¸­é‡æ–°åˆå§‹åŒ–ã€‚vLLM éœ€è¦å¤šè¿›ç¨‹å·¥ä½œï¼Œè¿™ä¸ Notebook ç¯å¢ƒä¸å…¼å®¹ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨æä¾›ç»ˆç«¯ç¯å¢ƒçš„å¹³å°ï¼ˆå¦‚ AutoDLï¼‰</p>
<hr/>
<h3 data-id="heading-65">10. å­¦ä¹ æ€»ç»“</h3>
<h4 data-id="heading-66">10.1 å®Œæˆçš„ä»»åŠ¡æ¸…å•</h4>













































<table><thead><tr><th>æ­¥éª¤</th><th>å†…å®¹</th><th align="center">çŠ¶æ€</th></tr></thead><tbody><tr><td>1</td><td>åˆ›å»º AutoDL å®ä¾‹ï¼ˆRTX 4090 24GBï¼‰</td><td align="center">Done</td></tr><tr><td>2</td><td>é…ç½® VS Code è¿œç¨‹ SSH è¿æ¥</td><td align="center">Done</td></tr><tr><td>3</td><td>ä¿®å¤ç¯å¢ƒä¾èµ–é—®é¢˜ï¼ˆnumpy 2.2.0ï¼‰</td><td align="center">Done</td></tr><tr><td>4</td><td>ä¸‹è½½ Qwen3-8B æ¨¡å‹ï¼ˆ~16GBï¼‰</td><td align="center">Done</td></tr><tr><td>5</td><td>Python è„šæœ¬æ¨ç†æµ‹è¯•ï¼ˆæ€è€ƒæ¨¡å¼ï¼‰</td><td align="center">Done</td></tr><tr><td>6</td><td>å¯åŠ¨ vLLM OpenAI å…¼å®¹ API æœåŠ¡å™¨</td><td align="center">Done</td></tr><tr><td>7</td><td>ä½¿ç”¨ curl å’Œ Python æµ‹è¯• API</td><td align="center">Done</td></tr></tbody></table>
<h4 data-id="heading-67">10.2 æ ¸å¿ƒçŸ¥è¯†ç‚¹å›é¡¾</h4>
<h5 data-id="heading-68">Python è¯­æ³•é€ŸæŸ¥è¡¨</h5>
















































































<table><thead><tr><th>è¯­æ³•</th><th>ç¤ºä¾‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>å˜é‡èµ‹å€¼</strong></td><td><code>x = 10</code></td><td>ä¸éœ€è¦å£°æ˜ç±»å‹</td></tr><tr><td><strong>å­—ç¬¦ä¸²</strong></td><td><code>"hello"</code> æˆ– <code>'hello'</code></td><td>å•å¼•å·åŒå¼•å·ç­‰ä»·</td></tr><tr><td><strong>åˆ—è¡¨</strong></td><td><code>[1, 2, 3]</code></td><td>æœ‰åºé›†åˆï¼Œå¯ä¿®æ”¹</td></tr><tr><td><strong>å­—å…¸</strong></td><td><code>{"key": "value"}</code></td><td>é”®å€¼å¯¹é›†åˆ</td></tr><tr><td><strong>å¯¼å…¥æ¨¡å—</strong></td><td><code>import os</code></td><td>å¯¼å…¥æ•´ä¸ªæ¨¡å—</td></tr><tr><td><strong>å¯¼å…¥éƒ¨åˆ†</strong></td><td><code>from os import path</code></td><td>åªå¯¼å…¥ç‰¹å®šå†…å®¹</td></tr><tr><td><strong>å‡½æ•°å®šä¹‰</strong></td><td><code>def func(arg):</code></td><td>å®šä¹‰å‡½æ•°</td></tr><tr><td><strong>é»˜è®¤å‚æ•°</strong></td><td><code>def func(x=10):</code></td><td>å‚æ•°æœ‰é»˜è®¤å€¼</td></tr><tr><td><strong>f-string</strong></td><td><code>f"å€¼æ˜¯{x}"</code></td><td>æ ¼å¼åŒ–å­—ç¬¦ä¸²</td></tr><tr><td><strong>for å¾ªç¯</strong></td><td><code>for i in list:</code></td><td>éå†å¯è¿­ä»£å¯¹è±¡</td></tr><tr><td><strong>if æ¡ä»¶</strong></td><td><code>if x &gt; 0:</code></td><td>æ¡ä»¶åˆ¤æ–­</td></tr><tr><td><strong>ç´¢å¼•è®¿é—®</strong></td><td><code>list[0]</code></td><td>è·å–ç¬¬ä¸€ä¸ªå…ƒç´ </td></tr><tr><td><strong>å±æ€§è®¿é—®</strong></td><td><code>obj.attr</code></td><td>è·å–å¯¹è±¡å±æ€§</td></tr><tr><td><strong>æ–¹æ³•è°ƒç”¨</strong></td><td><code>obj.method()</code></td><td>è°ƒç”¨å¯¹è±¡æ–¹æ³•</td></tr></tbody></table>
<h5 data-id="heading-69">é‡‡æ ·å‚æ•°å¯¹ç…§è¡¨</h5>



































<table><thead><tr><th>å‚æ•°</th><th align="center">æ€è€ƒæ¨¡å¼</th><th align="center">éæ€è€ƒæ¨¡å¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>temperature</code></td><td align="center">0.6</td><td align="center">0.7</td><td>æ§åˆ¶éšæœºæ€§</td></tr><tr><td><code>top_p</code></td><td align="center">0.95</td><td align="center">0.8</td><td>æ ¸é‡‡æ ·é˜ˆå€¼</td></tr><tr><td><code>top_k</code></td><td align="center">20</td><td align="center">20</td><td>å€™é€‰ token æ•°</td></tr><tr><td><code>enable_thinking</code></td><td align="center">True</td><td align="center">False</td><td>æ˜¯å¦æ˜¾ç¤ºæ€è€ƒè¿‡ç¨‹</td></tr></tbody></table>
<h4 data-id="heading-70">10.3 å…³é”®å‘½ä»¤é€ŸæŸ¥</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ==================== ç¯å¢ƒä¿®å¤ ====================</span>
<span class="hljs-comment"># ä¿®å¤ numpy ç‰ˆæœ¬</span>
pip install numpy==2.2.0 --force-reinstall

<span class="hljs-comment"># éªŒè¯ vLLM</span>
vllm --version

<span class="hljs-comment"># ==================== æ¨¡å‹ä¸‹è½½ ====================</span>
<span class="hljs-comment"># ä¸‹è½½æ¨¡å‹</span>
<span class="hljs-built_in">cd</span> /root/autodl-tmp &amp;&amp; python model_download.py

<span class="hljs-comment"># æŸ¥çœ‹æ¨¡å‹æ–‡ä»¶</span>
<span class="hljs-built_in">ls</span> -lh /root/autodl-tmp/Qwen/Qwen3-8B/

<span class="hljs-comment"># ==================== æ¨ç†æµ‹è¯• ====================</span>
<span class="hljs-comment"># Python è„šæœ¬æ¨ç†</span>
python /root/autodl-tmp/vllm_model.py

<span class="hljs-comment"># ==================== API æœåŠ¡å™¨ ====================</span>
<span class="hljs-comment"># å¯åŠ¨æœåŠ¡å™¨</span>
VLLM_USE_MODELSCOPE=<span class="hljs-literal">true</span> vllm serve /root/autodl-tmp/Qwen/Qwen3-8B \
    --served-model-name Qwen3-8B \
    --max_model_len 8192 \
    --enable-reasoning \
    --reasoning-parser deepseek_r1

<span class="hljs-comment"># æµ‹è¯• APIï¼ˆåœ¨æ–°ç»ˆç«¯ï¼‰</span>
curl http://localhost:8000/v1/models

curl http://localhost:8000/v1/chat/completions \
    -H <span class="hljs-string">"Content-Type: application/json"</span> \
    -d <span class="hljs-string">'{"model": "Qwen3-8B", "messages": [{"role": "user", "content": "ä½ å¥½"}]}'</span>

<span class="hljs-comment"># Python æµ‹è¯•</span>
python /root/autodl-tmp/test_api.py

<span class="hljs-comment"># ==================== æœåŠ¡å™¨ç®¡ç† ====================</span>
<span class="hljs-comment"># åœæ­¢æœåŠ¡å™¨ï¼šåœ¨æœåŠ¡å™¨ç»ˆç«¯æŒ‰ Ctrl+C</span>

<span class="hljs-comment"># åå°è¿è¡ŒæœåŠ¡å™¨</span>
<span class="hljs-built_in">nohup</span> vllm serve ... &gt; vllm.log 2&gt;&amp;1 &amp;

<span class="hljs-comment"># æŸ¥çœ‹åå°è¿›ç¨‹</span>
ps aux | grep vllm

<span class="hljs-comment"># ç»ˆæ­¢åå°è¿›ç¨‹</span>
<span class="hljs-built_in">kill</span> &lt;è¿›ç¨‹ID&gt;
</code></pre>
<h4 data-id="heading-71">10.4 ä¸‹ä¸€æ­¥å­¦ä¹ å»ºè®®</h4>
<ol>
<li>
<p><strong>å°è¯•å…¶ä»–æ¨¡å‹</strong></p>
<ul>
<li>Qwen2.5-7B-Instructï¼ˆæ›´å°ï¼Œé€Ÿåº¦æ›´å¿«ï¼‰</li>
<li>DeepSeek-R1-Distillï¼ˆå¼ºæ¨ç†èƒ½åŠ›ï¼‰</li>
<li>Llama-3-8Bï¼ˆè‹±æ–‡èƒ½åŠ›å¼ºï¼‰</li>
</ul>
</li>
<li>
<p><strong>å­¦ä¹ æ¨¡å‹é‡åŒ–</strong></p>
<ul>
<li>ä½¿ç”¨ AWQ/GPTQ é‡åŒ–å‡å°‘æ˜¾å­˜å ç”¨</li>
<li>INT4 é‡åŒ–å¯ä»¥åœ¨ 8GB æ˜¾å­˜ä¸Šè¿è¡Œ 8B æ¨¡å‹</li>
</ul>
</li>
<li>
<p><strong>æ„å»ºåº”ç”¨</strong></p>
<ul>
<li>ä½¿ç”¨ Gradio åˆ›å»º Web èŠå¤©ç•Œé¢</li>
<li>ä½¿ç”¨ LangChain æ„å»º RAG åº”ç”¨</li>
<li>é›†æˆåˆ°ä½ è‡ªå·±çš„é¡¹ç›®ä¸­</li>
</ul>
</li>
<li>
<p><strong>å­¦ä¹ å¾®è°ƒ</strong></p>
<ul>
<li>ä½¿ç”¨ LoRA è¿›è¡Œé«˜æ•ˆå¾®è°ƒ</li>
<li>å®šåˆ¶ä½ è‡ªå·±çš„é¢†åŸŸæ¨¡å‹</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-72">å‚è€ƒèµ„æ–™</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.vllm.ai%2F" target="_blank" title="https://docs.vllm.ai/" ref="nofollow noopener noreferrer">vLLM å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fqwen.readthedocs.io%2F" target="_blank" title="https://qwen.readthedocs.io/" ref="nofollow noopener noreferrer">Qwen3 å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelscope.cn%2F" target="_blank" title="https://modelscope.cn/" ref="nofollow noopener noreferrer">ModelScope æ¨¡å‹åº“</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdatawhalechina%2Fself-llm" target="_blank" title="https://github.com/datawhalechina/self-llm" ref="nofollow noopener noreferrer">datawhalechina/self-llm æ•™ç¨‹</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.autodl.com%2Fdocs%2F" target="_blank" title="https://www.autodl.com/docs/" ref="nofollow noopener noreferrer">AutoDL å¸®åŠ©æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fapi-reference" target="_blank" title="https://platform.openai.com/docs/api-reference" ref="nofollow noopener noreferrer">OpenAI API æ–‡æ¡£</a></li>
</ul>
<hr/>
<p><em>æœ¬æ–‡æ¡£åŸºäº 2025 å¹´ 12 æœˆ 23 æ—¥çš„å®è·µç¼–å†™</em>
<em>vLLM ç‰ˆæœ¬ï¼š0.8.5.post1</em>
<em>æ¨¡å‹ï¼šQwen/Qwen3-8B</em>
<em>å¹³å°ï¼šAutoDL RTX 4090 24GB</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ï¼ˆ æ•™å­¦ ï¼‰Agent æ„å»º Memoryï¼ˆæç¤ºè¯å¯¹è¯å­˜å‚¨ï¼‰1. ConversationBufferMemory(å¯¹è¯ç¼“å­˜å­˜å‚¨, ç‰ˆæœ¬>1.0å’Œ<1.0çš„åŒºåˆ«]]></title>    <link>https://juejin.cn/post/7586973107322486824</link>    <guid>https://juejin.cn/post/7586973107322486824</guid>    <pubDate>2025-12-23T16:01:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586973107322486824" data-draft-id="7586855770505543714" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ï¼ˆ æ•™å­¦ ï¼‰Agent æ„å»º Memoryï¼ˆæç¤ºè¯å¯¹è¯å­˜å‚¨ï¼‰1. ConversationBufferMemory(å¯¹è¯ç¼“å­˜å­˜å‚¨, ç‰ˆæœ¬&gt;1.0å’Œ&lt;1.0çš„åŒºåˆ«"/> <meta itemprop="keywords" content="LangChain,Agent"/> <meta itemprop="datePublished" content="2025-12-23T16:01:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="RedTiemr"/> <meta itemprop="url" content="https://juejin.cn/user/2140104538466522"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ï¼ˆ æ•™å­¦ ï¼‰Agent æ„å»º Memoryï¼ˆæç¤ºè¯å¯¹è¯å­˜å‚¨ï¼‰1. ConversationBufferMemory(å¯¹è¯ç¼“å­˜å­˜å‚¨, ç‰ˆæœ¬&gt;1.0å’Œ&lt;1.0çš„åŒºåˆ«
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2140104538466522/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    RedTiemr
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-23T16:01:19.000Z" title="Tue Dec 23 2025 16:01:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ï¼ˆ æ•™å­¦ ï¼‰Agent æ„å»º Memoryï¼ˆæç¤ºè¯å¯¹è¯å­˜å‚¨ï¼‰1. ConversationBufferMemory(å¯¹è¯ç¼“å­˜å­˜å‚¨, ç‰ˆæœ¬&gt;1.0å’Œ&lt;1.0çš„åŒºåˆ«)</h2>
<p><code>ConversationBufferMemory</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºåœ¨ç¼“å†²åŒºä¸­å­˜å‚¨å¯¹è¯å†å²çš„å†…å­˜ç±»ã€‚</p>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸éœ€è¦é¢å¤–çš„å¤„ç†ã€‚ä½†æ˜¯ï¼Œå½“å¯¹è¯å†å²è¶…å‡ºæ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£æ—¶ï¼Œå¯èƒ½éœ€è¦è¿›è¡Œé¢å¤–å¤„ç†ã€‚</p>
<p>å­¦ä¹ å¦‚ä½•ä½¿ç”¨ <code>ConversationBufferMemory</code> æ¥å­˜å‚¨å’Œæ£€ç´¢å¯¹è¯å†å²ã€‚</p>
<h3 data-id="heading-1">ç›®å‰çœ‹è¿™äº›ä¹‹å‰çš„ç‰ˆæœ¬1.0ä»¥å‰çš„ï¼Œç‰ˆæœ¬1.0ä»¥åçš„ã€‚æˆ‘ä¼šåˆ—å‡ºä¸¤ä¸ªç‰ˆæœ¬çš„ä½¿ç”¨æ–¹å¼å’Œç‰¹ç‚¹ã€‚</h3>
<p>åŠ è½½ ConversationBufferMemory ç±»</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_classic.memory <span class="hljs-keyword">import</span> ConversationBufferWindowMemory
    
memory = ConversationBufferMemory()
</code></pre>
<p>å¯ä»¥ä½¿ç”¨ <code>save_context(inputs, outputs)</code> æ–¹æ³•æ¥ä¿å­˜å¯¹è¯è®°å½•ã€‚</p>
<ul>
<li>è¿™ä¸ªæ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œ<code>inputs</code> å’Œ <code>outputs</code>ã€‚</li>
<li><code>inputs</code> ç”¨äºå­˜å‚¨ç”¨æˆ·çš„é—®é¢˜ï¼Œè€Œ <code>outputs</code> ç”¨äºå­˜å‚¨ AI çš„å›ç­”ã€‚</li>
<li>å¯¹è¯è®°å½•ä¼šåœ¨å†…éƒ¨ä»¥ <code>history</code> é”®è¿›è¡Œå­˜å‚¨ã€‚</li>
<li>ä½ å¯ä»¥ä½¿ç”¨ <code>load_memory_variables</code> æ–¹æ³•æ¥è·å–å’ŒæŸ¥çœ‹å·²ä¿å­˜çš„å¯¹è¯å†å²ã€‚</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># inputs: dictionary(key: "human" or "ai", value: question)</span>
<span class="hljs-comment"># outputs: dictionary(key: "ai" or "human", value: answer)</span>
memory.save_context(
    inputs={
        <span class="hljs-string">"human"</span>: <span class="hljs-string">"ä½ å¥½ï¼Œæˆ‘æƒ³è¦è¿œç¨‹å¼€è®¾ä¸€ä¸ªé“¶è¡Œè´¦æˆ·ã€‚æˆ‘è¯¥å¦‚ä½•å¼€å§‹ï¼Ÿ"</span>,
    },
    outputs={
        <span class="hljs-string">"ai"</span>: <span class="hljs-string">"ä½ å¥½ï¼å¾ˆé«˜å…´ä½ æƒ³å¼€è®¾è´¦æˆ·ã€‚é¦–å…ˆï¼Œè¯·å‡†å¤‡å¥½ä½ çš„èº«ä»½è¯ä»¶ä»¥ä¾›èº«ä»½éªŒè¯ã€‚"</span>
    },
)
</code></pre>
<p>å†…å­˜å¯¹è±¡çš„ <code>load_memory_variables({})</code> æ–¹æ³•ä¼šä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›å®Œæ•´çš„å¯¹è¯å†å²ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ£€æŸ¥å­˜å‚¨åœ¨'history'é”®ä¸­çš„æ¶ˆæ¯å†å²è®°å½•</span>
<span class="hljs-built_in">print</span>(memory.load_memory_variables({})[<span class="hljs-string">"history"</span>])
</code></pre>
<p>å¡å…¥æ•°æ®</p>
<pre><code class="hljs language-python" lang="python">memory.save_context(
    inputs={
        <span class="hljs-string">"human"</span>: <span class="hljs-string">"æˆ‘å·²ç»ä¸Šä¼ äº†ç…§ç‰‡ã€‚å¦‚ä½•è¿›è¡Œèº«ä»½éªŒè¯ï¼Ÿ"</span>
    },
    outputs={
        <span class="hljs-string">"ai"</span>: <span class="hljs-string">"æˆ‘ä»¬å·²ç¡®è®¤æ‚¨ä¸Šä¼ çš„ç…§ç‰‡ã€‚è¯·é€šè¿‡æ‰‹æœºè¿›è¡Œèº«ä»½éªŒè¯ã€‚è¯·è¾“å…¥é€šè¿‡çŸ­ä¿¡å‘é€çš„éªŒè¯ç ã€‚"</span>
    },
)
memory.save_context(
    inputs={
        <span class="hljs-string">"human"</span>: <span class="hljs-string">"æˆ‘å·²è¾“å…¥éªŒè¯ç ã€‚ç°åœ¨å¦‚ä½•å¼€æˆ·ï¼Ÿ"</span>
    },
    outputs={
        <span class="hljs-string">"ai"</span>: <span class="hljs-string">"èº«ä»½éªŒè¯å·²å®Œæˆã€‚è¯·é€‰æ‹©æ‚¨æƒ³è¦çš„è´¦æˆ·ç±»å‹å¹¶è¾“å…¥å¿…è¦ä¿¡æ¯ã€‚æ‚¨å¯ä»¥é€‰æ‹©å­˜æ¬¾ç±»å‹ã€å¸ç§ç­‰ã€‚"</span>
    },
)
<span class="hljs-comment"># Save 2 more conversations.</span>
memory.save_context(
    inputs={
        <span class="hljs-string">"human"</span>: <span class="hljs-string">"æˆ‘å·²ç»è¾“å…¥äº†æ‰€æœ‰ä¿¡æ¯ã€‚ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Ÿ"</span>,
    },
    outputs={
        <span class="hljs-string">"ai"</span>: <span class="hljs-string">"æˆ‘å·²ç¡®è®¤æ‚¨è¾“å…¥çš„ä¿¡æ¯ã€‚å¼€æˆ·æµç¨‹å³å°†å®Œæˆã€‚è¯·åŒæ„ä½¿ç”¨æ¡æ¬¾å¹¶ç¡®è®¤å¼€æˆ·ã€‚"</span>
    },
)
memory.save_context(
    inputs={
        <span class="hljs-string">"human"</span>: <span class="hljs-string">"æˆ‘å·²å®Œæˆæ‰€æœ‰æ­¥éª¤ã€‚è´¦æˆ·å¼€é€šäº†å—ï¼Ÿ"</span>,
    },
    outputs={
        <span class="hljs-string">"ai"</span>: <span class="hljs-string">"æ˜¯çš„ï¼Œè´¦æˆ·å·²å¼€é€šã€‚æ‚¨çš„è´¦å·å’Œç›¸å…³ä¿¡æ¯å·²å‘é€è‡³æ‚¨æ³¨å†Œçš„é‚®ç®±ã€‚å¦‚æœéœ€è¦å…¶ä»–å¸®åŠ©ï¼Œè¯·éšæ—¶è”ç³»æˆ‘ä»¬ã€‚è°¢è°¢ï¼"</span>
    },
)
</code></pre>
<p>æ‰“å°ä¸€ä¸‹ï¼ŒæŸ¥çœ‹ä¸€ä¸‹å†…å­˜ä¸­çš„å¯¹è¯å†å²ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-built_in">print</span>(memory.load_memory_variables({})[<span class="hljs-string">"history"</span>])
</code></pre>
<blockquote>
<p>Human: ä½ å¥½ï¼Œæˆ‘æƒ³è¦è¿œç¨‹å¼€è®¾ä¸€ä¸ªé“¶è¡Œè´¦æˆ·ã€‚æˆ‘è¯¥å¦‚ä½•å¼€å§‹ï¼Ÿ
AI: ä½ å¥½ï¼å¾ˆé«˜å…´ä½ æƒ³å¼€è®¾è´¦æˆ·ã€‚é¦–å…ˆï¼Œè¯·å‡†å¤‡å¥½ä½ çš„èº«ä»½è¯ä»¶ä»¥ä¾›èº«ä»½éªŒè¯ã€‚
Human: æ˜¯çš„,æˆ‘å·²ç»å‡†å¤‡å¥½äº†èº«ä»½è¯ä»¶ç”¨äºèº«ä»½éªŒè¯ã€‚æ¥ä¸‹æ¥æˆ‘è¯¥æ€ä¹ˆåš?
AI: è°¢è°¢ã€‚è¯·æ¸…æ™°åœ°ä¸Šä¼ æ‚¨èº«ä»½è¯ä»¶çš„æ­£åé¢ç…§ç‰‡ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†ç»§ç»­è¿›è¡Œèº«ä»½éªŒè¯æµç¨‹ã€‚
Human: æˆ‘å·²ç»ä¸Šä¼ äº†ç…§ç‰‡ã€‚å¦‚ä½•è¿›è¡Œèº«ä»½éªŒè¯ï¼Ÿ
AI: æˆ‘ä»¬å·²ç¡®è®¤æ‚¨ä¸Šä¼ çš„ç…§ç‰‡ã€‚è¯·é€šè¿‡æ‰‹æœºè¿›è¡Œèº«ä»½éªŒè¯ã€‚è¯·è¾“å…¥é€šè¿‡çŸ­ä¿¡å‘é€çš„éªŒè¯ç ã€‚
Human: æˆ‘å·²è¾“å…¥éªŒè¯ç ã€‚ç°åœ¨å¦‚ä½•å¼€æˆ·ï¼Ÿ
AI: èº«ä»½éªŒè¯å·²å®Œæˆã€‚è¯·é€‰æ‹©æ‚¨æƒ³è¦çš„è´¦æˆ·ç±»å‹å¹¶è¾“å…¥å¿…è¦ä¿¡æ¯ã€‚æ‚¨å¯ä»¥é€‰æ‹©å­˜æ¬¾ç±»å‹ã€å¸ç§ç­‰ã€‚
Human: æˆ‘å·²ç»è¾“å…¥äº†æ‰€æœ‰ä¿¡æ¯ã€‚ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Ÿ
AI: æˆ‘å·²ç¡®è®¤æ‚¨è¾“å…¥çš„ä¿¡æ¯ã€‚å¼€æˆ·æµç¨‹å³å°†å®Œæˆã€‚è¯·åŒæ„ä½¿ç”¨æ¡æ¬¾å¹¶ç¡®è®¤å¼€æˆ·ã€‚
Human: æˆ‘å·²å®Œæˆæ‰€æœ‰æ­¥éª¤ã€‚è´¦æˆ·å¼€é€šäº†å—ï¼Ÿ
AI: æ˜¯çš„ï¼Œè´¦æˆ·å·²å¼€é€šã€‚æ‚¨çš„è´¦å·å’Œç›¸å…³ä¿¡æ¯å·²å‘é€è‡³æ‚¨æ³¨å†Œçš„é‚®ç®±ã€‚å¦‚æœéœ€è¦å…¶ä»–å¸®åŠ©ï¼Œè¯·éšæ—¶è”ç³»æˆ‘ä»¬ã€‚è°¢è°¢ï¼</p>
</blockquote>
<h4 data-id="heading-2">å°†æ¶ˆæ¯æå–ä¸º <code>HumanMessage</code> å’Œ <code>AIMessage</code> å¯¹è±¡</h4>
<p>è®¾ç½® <code>return_messages=True</code> å°†è¿”å› <code>HumanMessage</code> å’Œ <code>AIMessage</code> å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-python" lang="python">memory = ConversationBufferMemory(return_messages=<span class="hljs-literal">True</span>)

memory = ConversationBufferMemory(return_messages=<span class="hljs-literal">True</span>)

memory.save_context(
    inputs={
        <span class="hljs-string">"human"</span>: <span class="hljs-string">"ä½ å¥½ï¼Œæˆ‘æƒ³è¦è¿œç¨‹å¼€è®¾ä¸€ä¸ªé“¶è¡Œè´¦æˆ·ã€‚æˆ‘è¯¥å¦‚ä½•å¼€å§‹ï¼Ÿ"</span>,
    },
    outputs={
        <span class="hljs-string">"ai"</span>: <span class="hljs-string">"ä½ å¥½ï¼å¾ˆé«˜å…´ä½ æƒ³å¼€è®¾è´¦æˆ·ã€‚é¦–å…ˆï¼Œè¯·å‡†å¤‡å¥½ä½ çš„èº«ä»½è¯ä»¶ä»¥ä¾›èº«ä»½éªŒè¯ã€‚"</span>,
    },
)

memory.save_context(
    inputs={
        <span class="hljs-string">"human"</span>: <span class="hljs-string">"å¥½çš„ï¼Œæˆ‘å·²ç»å‡†å¤‡å¥½èº«ä»½è¯ä»¶äº†ã€‚æ¥ä¸‹æ¥æˆ‘è¯¥æ€ä¹ˆåšï¼Ÿ"</span>
    },
    outputs={
        <span class="hljs-string">"ai"</span>: <span class="hljs-string">"è°¢è°¢ã€‚è¯·æ¸…æ™°åœ°ä¸Šä¼ ä½ çš„èº«ä»½è¯æ­£åé¢ç…§ç‰‡ã€‚ä¹‹åæˆ‘ä»¬å°†è¿›è¡Œèº«ä»½éªŒè¯æµç¨‹ã€‚"</span>
    },
)

memory.save_context(
    inputs={
        <span class="hljs-string">"human"</span>: <span class="hljs-string">"æˆ‘å·²ç»ä¸Šä¼ äº†ç…§ç‰‡ã€‚å¦‚ä½•è¿›è¡Œèº«ä»½éªŒè¯ï¼Ÿ"</span>
    },
    outputs={
        <span class="hljs-string">"ai"</span>: <span class="hljs-string">"æˆ‘ä»¬å·²ç¡®è®¤æ”¶åˆ°æ‚¨ä¸Šä¼ çš„ç…§ç‰‡ã€‚è¯·é€šè¿‡æ‰‹æœºè¿›è¡Œèº«ä»½éªŒè¯ã€‚è¯·è¾“å…¥é€šè¿‡çŸ­ä¿¡æ”¶åˆ°çš„éªŒè¯ç ã€‚"</span>
    },
)
memory.load_memory_variables({})[<span class="hljs-string">"history"</span>]
</code></pre>
<p>æ‰“å°å†…å®¹</p>
<pre><code class="hljs language-python" lang="python">memory.load_memory_variables({})[<span class="hljs-string">"history"</span>]
</code></pre>
<blockquote>
<p>[HumanMessage(content='ä½ å¥½ï¼Œæˆ‘æƒ³è¦è¿œç¨‹å¼€è®¾ä¸€ä¸ªé“¶è¡Œè´¦æˆ·ã€‚æˆ‘è¯¥å¦‚ä½•å¼€å§‹ï¼Ÿ', additional_kwargs={}, response_metadata={}),
AIMessage(content='ä½ å¥½ï¼å¾ˆé«˜å…´ä½ æƒ³å¼€è®¾è´¦æˆ·ã€‚é¦–å…ˆï¼Œè¯·å‡†å¤‡å¥½ä½ çš„èº«ä»½è¯ä»¶ä»¥ä¾›èº«ä»½éªŒè¯ã€‚', additional_kwargs={}, response_metadata={}),
HumanMessage(content='å¥½çš„ï¼Œæˆ‘å·²ç»å‡†å¤‡å¥½èº«ä»½è¯ä»¶äº†ã€‚æ¥ä¸‹æ¥æˆ‘è¯¥æ€ä¹ˆåšï¼Ÿ', additional_kwargs={}, response_metadata={}),
AIMessage(content='è°¢è°¢ã€‚è¯·æ¸…æ™°åœ°ä¸Šä¼ ä½ çš„èº«ä»½è¯æ­£åé¢ç…§ç‰‡ã€‚ä¹‹åæˆ‘ä»¬å°†è¿›è¡Œèº«ä»½éªŒè¯æµç¨‹ã€‚', additional_kwargs={}, response_metadata={}),
HumanMessage(content='æˆ‘å·²ç»ä¸Šä¼ äº†ç…§ç‰‡ã€‚å¦‚ä½•è¿›è¡Œèº«ä»½éªŒè¯ï¼Ÿ', additional_kwargs={}, response_metadata={}),
AIMessage(content='æˆ‘ä»¬å·²ç¡®è®¤æ”¶åˆ°æ‚¨ä¸Šä¼ çš„ç…§ç‰‡ã€‚è¯·é€šè¿‡æ‰‹æœºè¿›è¡Œèº«ä»½éªŒè¯ã€‚è¯·è¾“å…¥é€šè¿‡çŸ­ä¿¡æ”¶åˆ°çš„éªŒè¯ç ã€‚', additional_kwargs={}, response_metadata={})]</p>
</blockquote>
<h4 data-id="heading-3">ä½¿ç”¨æ–°ç‰ˆæœ¬çš„å­˜å‚¨æ–¹å¼</h4>
<pre><code class="hljs language-python" lang="python">
<span class="hljs-keyword">from</span> langgraph.checkpoint.memory <span class="hljs-keyword">import</span> MemorySaver
<span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-keyword">from</span> langgraph.graph <span class="hljs-keyword">import</span> MessagesState, START, StateGraph
<span class="hljs-keyword">from</span> langchain_core.messages <span class="hljs-keyword">import</span> HumanMessage

<span class="hljs-comment"># ä½¿ç”¨ MemorySaver ä½œä¸º checkpointer</span>
checkpointer = MemorySaver()

<span class="hljs-comment"># å®šä¹‰ç®€å•çš„èŠå¤©å›¾</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">chat</span>(<span class="hljs-params">state: MessagesState</span>):
    model = ChatOpenAI(
        temperature=<span class="hljs-number">0.1</span>,  <span class="hljs-comment"># æ§åˆ¶è¾“å‡ºçš„éšæœºæ€§å’Œåˆ›é€ æ€§ï¼Œå€¼è¶Šä½è¾“å‡ºè¶Šç¨³å®šå¯é¢„æµ‹ï¼Œå€¼è¶Šé«˜è¾“å‡ºè¶Šæœ‰åˆ›æ„ä½†å¯èƒ½åç¦»é¢„æœŸ (èŒƒå›´: 0.0 ~ 2.0)</span>
        model_name=<span class="hljs-string">"Qwen/Qwen2.5-7B-Instruct"</span>,  <span class="hljs-comment"># ç¡…åŸºæµåŠ¨æ”¯æŒçš„æ¨¡å‹åç§°</span>
        openai_api_key=os.getenv(<span class="hljs-string">"SILICONFLOW_API_KEY"</span>),  <span class="hljs-comment"># ä»ç¯å¢ƒå˜é‡è·å–APIå¯†é’¥</span>
        openai_api_base=<span class="hljs-string">"https://api.siliconflow.cn/v1"</span>  <span class="hljs-comment"># ç¡…åŸºæµåŠ¨APIçš„åŸºç¡€URL</span>
    )
    response = model.invoke(state[<span class="hljs-string">"messages"</span>])
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"messages"</span>: [response]}

builder = StateGraph(state_schema=MessagesState)
builder.add_node(<span class="hljs-string">"chat"</span>, chat)
builder.add_edge(START, <span class="hljs-string">"chat"</span>)
graph = builder.<span class="hljs-built_in">compile</span>(checkpointer=checkpointer)

<span class="hljs-comment"># ä½¿ç”¨ thread_id ä¿æŒå¯¹è¯ä¸Šä¸‹æ–‡</span>
config = {<span class="hljs-string">"configurable"</span>: {<span class="hljs-string">"thread_id"</span>: <span class="hljs-string">"user-1"</span>}}

<span class="hljs-comment"># ç¬¬ä¸€è½®å¯¹è¯</span>
result1 = graph.invoke(
    {<span class="hljs-string">"messages"</span>: [HumanMessage(content=<span class="hljs-string">"ä½ å¥½ï¼Œæˆ‘å«Bob"</span>)]}, 
    config
)
<span class="hljs-built_in">print</span>(result1[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>].content)

<span class="hljs-comment"># ç¬¬äºŒè½®å¯¹è¯ - è®°ä½ä¸Šæ–‡</span>
result2 = graph.invoke(
    {<span class="hljs-string">"messages"</span>: [HumanMessage(content=<span class="hljs-string">"æˆ‘çš„åå­—æ˜¯ä»€ä¹ˆï¼Ÿ"</span>)]}, 
    config
)
<span class="hljs-built_in">print</span>(result2[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>].content)  <span class="hljs-comment"># ä¼šè®°ä½ "Bob"</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[DanceGRPO+FLUX:å¤šæ¨¡æ€ç”Ÿæˆå¼ºåŒ–å­¦ä¹ æ¨¡å‹çš„é«˜æ•ˆ]]></title>    <link>https://juejin.cn/post/7586872817876418586</link>    <guid>https://juejin.cn/post/7586872817876418586</guid>    <pubDate>2025-12-24T00:43:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586872817876418586" data-draft-id="7586959875767713801" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="DanceGRPO+FLUX:å¤šæ¨¡æ€ç”Ÿæˆå¼ºåŒ–å­¦ä¹ æ¨¡å‹çš„é«˜æ•ˆ"/> <meta itemprop="keywords" content="è®¾è®¡æ¨¡å¼"/> <meta itemprop="datePublished" content="2025-12-24T00:43:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜¯åº—å°äºŒå‘€"/> <meta itemprop="url" content="https://juejin.cn/user/4132386718619243"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            DanceGRPO+FLUX:å¤šæ¨¡æ€ç”Ÿæˆå¼ºåŒ–å­¦ä¹ æ¨¡å‹çš„é«˜æ•ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4132386718619243/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜¯åº—å°äºŒå‘€
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T00:43:48.000Z" title="Wed Dec 24 2025 00:43:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/77ff012c00e54e8e8bb3848c287606fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5bqX5bCP5LqM5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767141828&amp;x-signature=rOzuCUSlsbWa%2Bm9zwy2Wa4PEY%2Fs%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">ä¸€ã€èƒŒæ™¯ä»‹ç»</h2>
<p><strong>Flux æ¨¡å‹</strong>ï¼š<strong>å°æ¨¡å‹é«˜æ•ˆç”Ÿæˆé«˜è´¨é‡å›¾åƒçš„åŸºç¡€</strong></p>
<p>Flux è™½æ˜¯ç™¾äº¿çº§å‚æ•°çš„å¤§æ¨¡å‹å®¶æ—ï¼Œä½†å…¶ä¸­çš„è½»é‡åŒ–å˜ä½“ï¼ˆå¦‚ Flux.1 (schnell)ï¼‰ä»¥åŠæ ¸å¿ƒæŠ€æœ¯ï¼Œä¸ºå°å°ºå¯¸æ¨¡å‹æä¾›äº†é«˜æ•ˆç”Ÿæˆçš„èŒƒå¼ã€‚å…¶å…³é”®æŠ€æœ¯ä¼˜åŠ¿é€‚é…å°æ¨¡å‹çš„ä¼˜åŒ–éœ€æ±‚ï¼Œå…·ä½“ä½“ç°åœ¨ä¸¤ç‚¹ã€‚ä¸€æ˜¯é‡‡ç”¨ Rectified Flowï¼ˆæ ¡æ­£æµï¼‰æŠ€æœ¯ï¼Œæ‹‰ç›´äº†ä¼ ç»Ÿæ‰©æ•£æ¨¡å‹ä»å™ªå£°åˆ°å›¾åƒçš„ç”Ÿæˆè·¯å¾„ï¼Œå°†ç”Ÿæˆè¿‡ç¨‹ä¼˜åŒ–ä¸ºè¿‘ä¼¼ç›´çº¿çš„æœ€çŸ­è·¯å¾„ï¼Œå¤§å¹…å‡å°‘é‡‡æ ·æ­¥æ•°ã€‚åƒ Flux.1 (schnell) ä»…éœ€ 4 æ­¥å·¦å³é‡‡æ ·å°±èƒ½ç”Ÿæˆåˆç†å›¾åƒï¼Œè¿™å¯¹å°æ¨¡å‹è€Œè¨€ï¼Œæ„å‘³ç€åœ¨é™ä½è®¡ç®—æˆæœ¬çš„åŒæ—¶ï¼Œè¿˜èƒ½é¿å…å¤šæ­¥è¿­ä»£å¸¦æ¥çš„ç²¾åº¦æŸè€—ã€‚äºŒæ˜¯åˆ›æ–°çš„å¤šæ¨¡æ€èåˆæ¶æ„ï¼Œé€šè¿‡åŒæ–‡æœ¬ç¼–ç å™¨ï¼ˆCLIP+T5ï¼‰ç²¾å‡†è§£ææ–‡æœ¬è¯­ä¹‰ï¼Œå†ç»“åˆåŒæµè½¬å•æµçš„ Transformer æ³¨æ„åŠ›æœºåˆ¶ï¼Œå®ç°æ–‡æœ¬ä¸å›¾åƒç‰¹å¾çš„æ·±åº¦äº¤äº’ã€‚è¿™ç§è®¾è®¡è®©å°æ¨¡å‹æ— éœ€å¤æ‚ç»“æ„ï¼Œå°±èƒ½é«˜æ•ˆæ•æ‰å›¾æ–‡å…³è”ï¼Œæå‡ç”Ÿæˆå›¾åƒçš„å†…å®¹ä¸€è‡´æ€§ã€‚</p>
<p><strong>DanceGRPO æ¡†æ¶ï¼šé€šè¿‡å¼ºåŒ–å­¦ä¹ è¿›ä¸€æ­¥æå‡å°æ¨¡å‹æ€§èƒ½</strong></p>
<p>DanceGRPO æ˜¯ä¸“é—¨é’ˆå¯¹è§†è§‰ç”Ÿæˆé¢†åŸŸ RLHF æ–¹æ¡ˆä¸æˆç†Ÿçš„é—®é¢˜è®¾è®¡ï¼Œèƒ½ç²¾å‡†è§£å†³å°æ¨¡å‹è®­ç»ƒä¸­è´¨é‡æå‡çš„æ ¸å¿ƒç—›ç‚¹ï¼Œå…·ä½“ä¼˜åŠ¿æœ‰ä¸‰ã€‚å…¶ä¸€ï¼Œå…¼å®¹æ€§å¼ºï¼Œé€‚é… Flux çš„æ ¸å¿ƒèŒƒå¼ã€‚è¯¥æ¡†æ¶åˆ›æ–°æ€§åœ°å°†æ‰©æ•£æ¨¡å‹å’Œæ ¡æ­£æµæ¨¡å‹ï¼ˆå¦‚ Fluxï¼‰ç»Ÿä¸€è§†ä¸ºéšæœºæ’å€¼çš„ç‰¹æ®Šæƒ…å†µï¼ŒäºŒè€…çš„é‡‡æ ·è¿‡ç¨‹å‡å¯é€šè¿‡ SDE å®ç°ï¼Œè¿™è®©å®ƒèƒ½æ— ç¼å¯¹æ¥ Flux æ¨¡å‹ï¼Œé’ˆå¯¹æ€§åœ°å¼€å±•å¼ºåŒ–å­¦ä¹ ä¼˜åŒ–ï¼Œæ— éœ€å¯¹ Flux çš„åŸºç¡€æ¶æ„åšå¤§å¹…ä¿®æ”¹ï¼Œé™ä½äº†å°æ¨¡å‹é€‚é…å¼ºåŒ–å­¦ä¹ çš„æˆæœ¬ã€‚å…¶äºŒï¼Œæ˜¾å­˜å‹åŠ›ä½ï¼Œé€‚é…å°æ¨¡å‹è®­ç»ƒèµ„æºé™åˆ¶ã€‚æ­¤å‰ ReFL ç­‰å¼ºåŒ–å­¦ä¹ æ–¹æ¡ˆéœ€å¯¹å¥–åŠ±æ¨¡å‹å’Œ VAE è§£ç ç‰¹å¾åå‘ä¼ æ’­ï¼Œåœ¨è§†é¢‘ç”Ÿæˆç­‰åœºæ™¯ä¸­æ˜¾å­˜å‹åŠ›æå¤§ï¼Œæ ¹æœ¬ä¸é€‚åˆå°æ¨¡å‹ã€‚è€Œ DanceGRPO é€šè¿‡é‡‡æ ·éƒ¨åˆ†æ—¶é—´æ­¥åŠ é€Ÿè®­ç»ƒã€å»é™¤ä½œç”¨ä¸å¤§çš„ KL æ•£åº¦æ­£åˆ™é¡¹ç­‰è®¾è®¡ï¼Œå¤§å¹…é™ä½äº†è®¡ç®—å’Œæ˜¾å­˜å¼€é”€ï¼ŒåŒæ—¶è¿˜èƒ½è®©å°æ¨¡å‹åœ¨æ›´å¤šæç¤ºè¯æ ·æœ¬ä¸Šå­¦ä¹ ï¼Œæå‡æ³›åŒ–èƒ½åŠ›ã€‚å…¶ä¸‰ï¼Œå¼ºåŒ–å­¦ä¹ æ•ˆæœæ˜¾è‘—ï¼Œç²¾å‡†ä¼˜åŒ–æ ¸å¿ƒæŒ‡æ ‡ã€‚è¯¥æ¡†æ¶é€šè¿‡å¤šå¥–åŠ±æ¨¡å‹å åŠ ï¼ˆå›¾åƒç¾æ„Ÿã€å›¾æ–‡åŒ¹é…ç­‰äº”ç±»æŒ‡æ ‡ï¼‰ï¼Œè®©å°æ¨¡å‹èƒ½é’ˆå¯¹æ€§æå‡è–„å¼±é¡¹ï¼›åŒæ—¶é€šè¿‡å›ºå®šåˆå§‹åŒ–å™ªå£°ã€æ§åˆ¶æ¢¯åº¦æ›´æ–°é¢‘ç‡ç­‰ä¼˜åŒ–æ‰‹æ®µï¼Œé¿å…è®­ç»ƒä¸­çš„å¥–åŠ±ä½œå¼Šå’Œå¤šæ ·æ€§ä¸‹é™é—®é¢˜ã€‚</p>
<p><strong>å¼ºåŒ–å­¦ä¹ æ¡†æ¶å¯¹æ¯”</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa929431df8f489d85882c323183be9a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5bqX5bCP5LqM5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767141828&amp;x-signature=lhJdURPsVOt1qecas%2B5B%2B8V2798%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">äºŒã€ç¯å¢ƒä¾èµ–</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39242855f7b0430aa5a08f2779d96049~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5bqX5bCP5LqM5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767141828&amp;x-signature=%2F2faFFiU%2B31WJi9KJP8h59zxjyg%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">ä¸‰ã€DanceGRPO+FLUX æ•´ä½“æµç¨‹</h2>
<h3 data-id="heading-3">æ¨ç†é˜¶æ®µï¼ˆå»å™ªç”Ÿæˆå›¾ç‰‡ï¼Œç”¨äºè®­ç»ƒè¿‡ç¨‹è§‚å¯Ÿï¼‰</h3>
<ol start="0">
<li><strong>åŠ è½½æ–‡æœ¬ä¿¡æ¯ï¼š</strong> è·å–åˆå§‹æ•°æ®ï¼Œå°†æ•°æ®å¤åˆ¶æˆ N ä»½ä½œä¸ºè¾“å…¥ã€‚</li>
<li><strong>å»å™ªï¼š</strong> ç”Ÿæˆåˆå§‹å™ªå£°ï¼Œinput å’Œå½“å‰å™ªéŸ³è¾“å…¥åˆ° policy mode é¢„æµ‹å™ªå£°æˆåˆ†ï¼Œå»å™ªç”Ÿæˆ latentsã€‚</li>
<li><strong>å›¾ç‰‡ç”Ÿæˆä¿å­˜ï¼š</strong> åŸºäºæ¨ç†é˜¶æ®µè¾“å‡º latentsï¼Œç»è¿‡ vae mode è§£ç æˆ imageï¼Œä¿å­˜ä¸ºæ–‡ä»¶ç”¨äºè§‚å¯Ÿè¿‡ç¨‹ã€‚</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7c32ee7a4ab64b37841c073d7eaffaf8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5bqX5bCP5LqM5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767141828&amp;x-signature=HJ1c2TOUXtyxkF1RsdKW3piQzmw%3D" alt="" loading="lazy"/></p>
<p><strong>å…³é”®ç‚¹</strong></p>
<ul>
<li>æ¨ç†å»å™ªç”Ÿæˆå›¾åƒï¼šè¯¥æ¨¡å‹ä¸­ï¼Œé»˜è®¤ä¸€ç»„ç”Ÿæˆ 12 å“¥æ ·æœ¬ï¼Œå³ä¸€ä¸ª prompt ä¼šç”Ÿæˆ 12 å“¥å¤§ä½“ç›¸ä¼¼è€Œç»†èŠ‚ä¸åŒçš„å›¾åƒï¼Œæ¯ä¸ªå›¾åƒé»˜è®¤ç»è¿‡ 16 æ­¥è¿­ä»£å»å™ªç”Ÿæˆã€‚</li>
<li>å»å™ªæ­¥é•¿ï¼šæ­¥é•¿éšæ—¶é—´æ­¥é•¿ä»å¤§åˆ°å°ï¼Œå› ä¸ºåˆå§‹å™ªå£°æˆåˆ†è¾ƒå¤šï¼Œç›¸å½“äºå‹¾å‹’è½®å»“å»å™ªæ­¥é•¿å¯ä»¥å¤§äº›ï¼Œåé¢è¦æ”¶æ•›åˆ°æ­£ç¡®ç»ˆç‚¹ï¼Œç›¸å½“äºæç»˜ç»†èŠ‚ï¼Œéœ€è¦æ…¢æ…¢å»å™ªã€‚</li>
<li>å›¾åƒå¤šæ ·æ€§ï¼šå»å™ªè¿‡ç¨‹ä¼šåŠ å…¥éšæœºæ‰°åŠ¨ï¼Œå±€éƒ¨ä¼˜åŒ–ï¼Œå› æ­¤ä¼šæœ‰ä¸€ç»„é»˜è®¤ 12 å¼ å›¾ç‰‡ï¼Œæ¯å¼ æ•´ä½“ç›¸ä¼¼è€Œç»†èŠ‚æœ‰å·®å¼‚çš„å›¾ç‰‡ï¼›ä¸€ç»„å†…ä¼šè¿›è¡Œå¯¹æ¯”ï¼Œæå‡ä¼˜åŠ¿åŠ¨ä½œçš„æ¦‚ç‡ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3988405dd4a84e8295d49c2bbd48d1c9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5bqX5bCP5LqM5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767141828&amp;x-signature=UrLlLWs9KKOynnOKxOvC9a96gag%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-4">Reward é˜¶æ®µï¼ˆjisaunq reward å€¼ï¼‰</h3>
<ol start="0">
<li><strong>è®¡ç®—å¥–åŠ±å€¼ï¼š</strong> image å’Œ prompt è¾“å…¥åˆ° reward modelï¼Œè®¡ç®—å¾—åˆ° reward å€¼ã€‚</li>
<li><strong>è®¡ç®—ç›¸å¯¹ä¼˜åŠ¿å€¼ï¼š</strong> è®¡ç®— reward çš„ç»„å†…å¹³å‡å€¼ï¼Œæ¯ä¸ª reward å’Œå¹³å‡å€¼æ¯”è¾ƒï¼Œå¾—åˆ° advantageï¼ˆç»„å†…ç›¸å¯¹ä¼˜åŠ¿ï¼‰ã€‚</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f20eaa69ead94f009e3862f452fd313c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5bqX5bCP5LqM5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767141828&amp;x-signature=PPPGAfirmXUUGW9ngskZUtw4HAA%3D" alt="" loading="lazy"/></p>
<p><strong>reward è¯¦ç»†æµç¨‹</strong></p>
<ul>
<li>è®¡ç®— reward å€¼ï¼šåŸºäº promptï¼Œå›¾ä¾‹é˜¶æ®µå¾—åˆ°çš„å®Œå…¨å»å™ªçš„ image å€¼ï¼Œè¾“å…¥åˆ° reward mode ä¸­ï¼Œç»è¿‡ä¸€ç³»åˆ—è®¡ç®—å¾—åˆ°æ¯ä¸ª image çš„ reward å€¼ã€‚</li>
<li>è®¡ç®— advantage å€¼ï¼šreward å€¼ç»è¿‡ç»„å†…å¹³å‡å¾—åˆ°å¹³å‡å€¼ï¼Œå†ç”¨æ¯ä¸ª iamge çš„ reward å€¼å’Œå¹³å‡å€¼å¯¹æ¯”ï¼Œå¾—åˆ° advantage ï¼ˆç›¸å¯¹ä¼˜åŠ¿å€¼ï¼‰ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6baa779bcc8149c6be3c4797818f52d4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5bqX5bCP5LqM5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767141828&amp;x-signature=kXJ9jKeZnTv419K%2BdkjrrPIw0Es%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">è®­ç»ƒé˜¶æ®µï¼ˆè®¡ç®— lossï¼Œæ›´æ–°æ¢¯åº¦ï¼‰</h3>
<ol start="0">
<li><strong>è®°å½•å»å™ªè¿‡ç¨‹ï¼š</strong> å‰é¢æ­¥éª¤ä¼šè®°å½•æ¯ä¸ªæ ·æœ¬çš„å»å™ªè¿‡ç¨‹çŠ¶æ€ï¼ŒåŒ…æ‹¬ reward å€¼ï¼Œadvantag å€¼ï¼Œlog_p å€¼ï¼ˆä»£è¡¨å½“æ—¶ç­–ç•¥çš„å¯¹æ•°ï¼‰ã€‚</li>
<li><strong>è®¡ç®—æ–°ç­–ç•¥å¯¹æ•°ï¼š</strong> æ­¤æ—¶ policy model ä¼šç”Ÿæˆæ–°é¢„æµ‹å€¼ï¼Œæ ¹æ®æ–°é¢„æµ‹å€¼è®¡ç®—å‡º new_log_p å€¼ï¼ˆä»£è¡¨æ–°ç­–ç•¥çš„å¯¹æ•°ï¼‰ã€‚</li>
<li><strong>è®¡ç®—æ—§ç­–ç•¥æ¯”ç‡ï¼š</strong> f(new_log, old_log) = ratioï¼Œä»£è¡¨æŸè¡Œä¸ºåœ¨æ–°æ—§ç­–ç•¥çš„æ¦‚ç‡æ¯”ã€‚</li>
<li><strong>è®¡ç®— loss å€¼ï¼š</strong> åŸºäº ratio å’Œ advantage è®¡ç®—å‡º loss å€¼ã€‚</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2196a69f3d1646549b29c6452c8c62f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5bqX5bCP5LqM5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767141828&amp;x-signature=tECMUJcqqbt8k0fVRtrWPu7CXVs%3D" alt="" loading="lazy"/></p>
<p><strong>è®­ç»ƒè¯¦ç»†æµç¨‹</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/76a6b42386924dc485a6b037efcdbcef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5bqX5bCP5LqM5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767141828&amp;x-signature=AXomrqyjqgBF30wbsc9vJYk%2BqCE%3D" alt="" loading="lazy"/></p>
<ul>
<li>loss æ˜¯åŸºäº advantage å’Œ ratio è®¡ç®—å¾—å‡ºçš„ï¼Œå½“ advantage å’Œ ratio å¤„äºä¸åŒå€¼æ—¶ä»£è¡¨ä¸åŒçš„å«ä¹‰</li>
</ul>




















<table><thead><tr><th><strong>ADVANTAGE</strong></th><th><strong>RATIO</strong></th><th><strong>å«ä¹‰</strong></th></tr></thead><tbody><tr><td>&gt;0</td><td>&gt;1</td><td>è¯¥åŠ¨ä½œä¸ºä¼˜åŠ¿åŠ¨ä½œï¼Œä¸”æ–°ç­–ç•¥è¯¥åŠ¨ä½œæ¦‚ç‡æ›´å¤§ï¼Œæ–°ç­–ç•¥æ­£ç¡®çš„æå‡äº†è¯¥åŠ¨ä½œçš„æ¦‚ç‡ï¼Œæ–°ç­–ç•¥æ›´ä¼˜</td></tr><tr><td>&gt;0</td><td>&lt;1</td><td>è¯¥åŠ¨ä½œä¸ºä¼˜åŠ¿åŠ¨ä½œï¼Œä¸”æ–°ç­–ç•¥è¯¥åŠ¨ä½œæ¦‚ç‡æ›´å°ï¼Œæ–°ç­–ç•¥é”™è¯¯çš„æŠ‘åˆ¶äº†ä¼˜åŠ¿åŠ¨ä½œï¼Œåç»­éœ€è¦æé«˜ ratio</td></tr></tbody></table>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0538eedfc2a94a7883acab421c88774e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5bqX5bCP5LqM5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767141828&amp;x-signature=fl2tsYilNU6Ln0eYm4hAQF3a53Q%3D" alt="" loading="lazy"/></p>
<ul>
<li>ç¬¬ä¸€æ¬¡è®¡ç®— loss æ—¶ï¼Œpolicy mode è¿˜æ²¡æœ‰æ›´æ–°æƒé‡ï¼Œæ­¤æ—¶ new_log_p å’Œ old_log_p å®é™…ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œå°±æ˜¯è™½ç„¶å®šä¹‰ä¸Šæ˜¯æ–°æ—§ç­–ç•¥ï¼Œä½†å®é™…ä¸Šæ–°æ—§ç­–ç•¥çš„æƒé‡ä¸€æ ·ã€‚</li>
<li>loss å€¼ä¼šåŸºäº advantage å’Œ ratio ä¸€å¹¶è®¡ç®—ï¼Œæ‰€ä»¥å¼€å§‹çš„ loss å€¼ä¾èµ–äºæ ·æœ¬çš„ advantage å€¼ï¼Œé»˜è®¤çš„æ¢¯åº¦æ›´æ–°é¢‘ç‡ä¸º 4 å“¥æ ·å“ä¸€æ¬¡ï¼Œå½“å¤„ç†æœ¬ç»„ç¬¬å››ä¸ªæ ·å“å ratio å°±ä¼šå¼€å§‹å˜åŒ–äº†ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7fb638a425bc45fc84e05f4cbaebc8aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5bqX5bCP5LqM5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767141828&amp;x-signature=4iTmXrcPyZ2Uxx8SmgjNFFI9iKg%3D" alt="" loading="lazy"/></p>
<p>å­˜åœ¨ä¸¤ä¸ª loss å€¼ï¼Œclipped_loss å’Œ unclipped_lossï¼Œéƒ½æ˜¯åŸºäº advantage å’Œ ratio è®¡ç®—å¾—åˆ°çš„ï¼Œä½†æ˜¯ clipped_loss çš„è®¡ç®—ä¸­åŠ å…¥äº† clip_rangeï¼Œçº¦æŸäº†æœ€ç»ˆè®¡ç®—å€¼çš„èŒƒå›´ï¼Œé˜²æ­¢å±€éƒ¨è¿‡åº¦ä¼˜åŒ–ã€‚</p>
<h2 data-id="heading-6">å››ã€æ¨¡å‹éƒ¨ç½²æµç¨‹</h2>
<ol start="0">
<li>æ‹‰å–ä»£ç ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FXueZeyue%2FDanceGRPO" target="_blank" title="https://github.com/XueZeyue/DanceGRPO" ref="nofollow noopener noreferrer">GitHub - XueZeyue/DanceGRPO: An official implementation of DanceGRPO: Unleashing GRPO on Visual Generation</a></li>
</ol>

<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">clone</span> https://github.com/XueZeyue/DanceGRPO.git
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a7b55180183e460cb1307faa550adbef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5bqX5bCP5LqM5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767141828&amp;x-signature=OHv%2FPeqSOGXNSh3nvhTc9swZG4w%3D" alt="" loading="lazy"/></p>
<ol start="2">
<li>ä¸‹è½½æƒé‡</li>
</ol>
<p>FLUXï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fhuggingface.co%2Fblack-forest-labs%2FFLUX.1-dev" target="_blank" title="https://huggingface.co/black-forest-labs/FLUX.1-dev" ref="nofollow noopener noreferrer">huggingface.co/black-foresâ€¦</a></p>
<p>HPSï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fhuggingface.co%2Fxswu%2FHPSv2%2Ftree%2Fmain" target="_blank" title="https://huggingface.co/xswu/HPSv2/tree/main" ref="nofollow noopener noreferrer">huggingface.co/xswu/HPSv2/â€¦</a></p>
<p>open_clipï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fhuggingface.co%2Flaion%2FCLIP-ViT-H-14-laion2B-s32B-b79K%2Ftree%2Fmain" target="_blank" title="https://huggingface.co/laion/CLIP-ViT-H-14-laion2B-s32B-b79K/tree/main" ref="nofollow noopener noreferrer">huggingface.co/laion/CLIP-â€¦</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/527ecd34d7af4e6385fe343f8ad4768c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5bqX5bCP5LqM5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767141828&amp;x-signature=BawBbTntC5lV71srDyO2Ez5Ea4A%3D" alt="" loading="lazy"/></p>
<ol start="3">
<li>å…¶å®ƒä¾èµ–å®‰è£…</li>
</ol>
<blockquote>
<ol start="0">
<li>ä»“åº“æœªå®ç°æ‡’åŠ è½½ï¼Œæ‰€ä»¥ä¼šå¯¼å…¥è®¸å¤šç”¨ä¸åˆ°çš„ä¸‰æ–¹åº“ï¼Œå¯ä»¥ç›´æ¥æ³¨é‡Šï¼Œé¿å…å¼•å…¥å¤ªå¤šæ— ç”¨çš„ä¾èµ–ï¼Œè€—è´¹å¼€å‘æ—¶é—´ã€‚</li>
<li>ä¸€äº›ä¸ºè°ƒç”¨çš„æ¥å£ä¹Ÿå¯ä»¥è¿›è¡Œè§„é¿ï¼Œä¾‹å¦‚ flashatth ä¸‰æ–¹åº“æ¥å£ç­‰ã€‚</li>
</ol>
</blockquote>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># DanceGRPO/fastvideo/models/mochi_hf/modeling_mochi.py</span>
<span class="hljs-comment"># æ³¨é‡Šæ‰ä»¥ä¸‹</span>
<span class="hljs-keyword">from</span> liger_kernel.ops.swiglu <span class="hljs-keyword">import</span> LigerSiLUMulFunction;flash_attn_no_pad.py
â€‹
<span class="hljs-comment"># flash_attn_no_pad.py</span>
<span class="hljs-comment"># æ³¨é‡Šæ‰flash_attnçš„å¯¼åŒ…ï¼Œflash_attn_no_padæ³¨é‡Šæ‰ä¸­é—´é€»è¾‘ï¼Œç›´æ¥returnï¼›</span>
</code></pre>
<p>æ‰§è¡Œå®‰è£…è„šæœ¬ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">./env_setup.sh fastvideo
</code></pre>
<p>4.  ä¿®æ”¹<code>&lt;font style="color:rgb(37, 43, 58);background-color:rgb(246, 247, 249);"&gt;preprocess_flux_embedding.py&lt;/font&gt;</code>ï¼š</p>

<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># # å¼•å…¥torch_npu</span>
<span class="hljs-keyword">import</span> torch_npu
<span class="hljs-keyword">from</span> torch_npu.contrib <span class="hljs-keyword">import</span> transfer_to_npu
â€‹
<span class="hljs-comment"># "./data/flux"å†™æ­»çš„è·¯å¾„æ”¹æˆå‚æ•°</span>
<span class="hljs-comment"># åŸ ï¼š pipe = FluxPipeline.from_pretrained("./data/flux", torch_dtype=torch.bfloat16).to(device)</span>
pipe = FluxPipeline.from_pretrained(args.model_path, torch_dtype=torch.bfloat16).to(device)
</code></pre>
<p>5.  ä¿®æ”¹<code>&lt;font style="color:rgb(37, 43, 58);background-color:rgb(246, 247, 249);"&gt;train_grpo_flux.py&lt;/font&gt;</code>ï¼š</p>

<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># # å¼•å…¥torch_npu</span>
<span class="hljs-keyword">import</span> torch_npu
<span class="hljs-keyword">from</span> torch_npu.contrib <span class="hljs-keyword">import</span> transfer_to_npu
</code></pre>
<p>6.  æ‰§è¡Œ Flux GRPO è„šæœ¬ï¼š</p>

<pre><code class="hljs language-bash" lang="bash">bash ./scripts/finetune/finetune_flux_grpo.sh
</code></pre>
<h2 data-id="heading-7">äº”ã€æ¨¡å‹éªŒè¯</h2>
<p>éªŒè¯æµç¨‹å°† GRPO çš„æ¨ç†ã€rewardã€è®­ç»ƒä¸‰ä¸ªé˜¶æ®µå•ç‹¬æŠ½ç¦»å¯¹é½ï¼Œå†è¿›è¡Œå…¨æµç¨‹éªŒè¯ï¼Œé‡‡ç”¨â€œåˆ† - åˆâ€ éªŒè¯ç­–ç•¥ï¼š</p>
<ul>
<li>å•ç‹¬é˜¶æ®µå¯¹é½èƒ½éš”ç¦»ä¸åŒæ¨¡å‹å’Œæ¡†æ¶çš„å·®å¼‚ï¼Œèšç„¦æ¯ä¸ªç¯èŠ‚çš„å‰å‘è®¡ç®—å‡†ç¡®æ€§ï¼ˆæ¯”å¦‚æ¨ç†é˜¶æ®µçš„åŠ¨ä½œç”Ÿæˆã€reward é˜¶æ®µçš„è¯„åˆ†è®¡ç®—ã€è®­ç»ƒé˜¶æ®µçš„æ¢¯åº¦æ›´æ–°ï¼‰ï¼Œé¿å…å› å•ä¸ªé˜¶æ®µè¯¯å·®ç´¯ç§¯æ©ç›–é—®é¢˜ã€‚</li>
<li>å…¨æµç¨‹å¯¹é½åˆ™èƒ½éªŒè¯é˜¶æ®µé—´æ•°æ®ä¼ é€’çš„ä¸€è‡´æ€§ï¼Œå°¤å…¶è¦å…³æ³¨è·¨æ¡†æ¶äº¤äº’æ—¶çš„æ•°æ®æ ¼å¼ã€ç²¾åº¦æŸå¤±ç­‰ç»†èŠ‚ã€‚</li>
</ul>
<p>è®°å½•å…³é”®èŠ‚ç‚¹çš„å¯¹é½æ•°æ®ï¼ˆå¦‚ä¸­é—´ç‰¹å¾ã€æ¦‚ç‡åˆ†å¸ƒã€loss å€¼ã€æ¢¯åº¦ç­‰ï¼‰ï¼Œæ—¢èƒ½ä½œä¸ºé˜¶æ®µéªŒè¯çš„åŸºå‡†ï¼Œä¹Ÿèƒ½åœ¨å…¨æµç¨‹ä¸­å¿«é€Ÿå®šä½è¯¯å·®æ¥æºã€‚</p>
<h3 data-id="heading-8">éšæœºæ€§å›ºå®š</h3>
<h4 data-id="heading-9">load ç‰ˆæœ¬ï¼ˆå‡†ç¡®ä½†éº»çƒ¦ï¼‰</h4>
<blockquote>
<p>é€šè¿‡<code>torch.save</code>ã€<code>torch.load</code>çš„æ–¹å¼å°†ç¨‹åºä¸­æ¶‰åŠéšæœºæ€§çš„å˜é‡ï¼Œåœ¨ NPU å’Œ GPU ä¸Šä¿æŒä¸€è‡´ã€‚</p>
</blockquote>
<ol start="0">
<li>å…³é—­<code>shuffle</code>ï¼Œå›ºå®šè®­ç»ƒçš„æ•°æ®é¡ºåº</li>
</ol>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># fastvideo/train_grpo_flux.pyä¸­ï¼Œshuffleè®¾ä¸ºfalse</span>
â€‹
<span class="hljs-attr">sampler</span> = DistributedSampler(train_dataset, rank=rank, num_replicas=world_size, shuffle=<span class="hljs-literal">False</span>, seed=args.sampler_seed)
</code></pre>
<p>2.  prev_sample å›ºå®š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">0.</span>  GPUä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼Œåœ¨GPUä¸Šè¿è¡Œåä¿å­˜ä¸‹æ¥
</code></pre>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#  1. æ·»åŠ å…¨å±€å˜é‡COFF_STEPï¼Œæ§åˆ¶coffç”Ÿæˆçš„stepæ•° Â </span>
<span class="hljs-attr">COFF_STEP</span> = <span class="hljs-number">0</span> Â 
â€‹
def flux_step(): Â 
 Â   global COFF_STEP Â 
 Â   ...... Â 
 Â  Â if grpo and prev_sample is None: Â 
 Â   <span class="hljs-attr">coff</span> = torch.randn_like(prev_sample_mean) Â 
 Â   torch.save(coff, f"saves/coff_{COFF_STEP}_{torch.distributed.get_rank()}.pt") Â 
 Â   <span class="hljs-attr">prev_sample</span> = prev_sample_mean + c<span class="hljs-literal">off</span> * std_dev_t Â 
 Â   COFF_STEP += 1
</code></pre>

<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">2.</span> NPU ä¸ŠåŠ è½½
</code></pre>

<pre><code class="hljs language-python" lang="python">coff = torch.load(<span class="hljs-string">f"saves/coff_<span class="hljs-subst">{COFF_STEP}</span>_<span class="hljs-subst">{torch.distributed.get_rank()}</span>.pt"</span>, map_location=<span class="hljs-string">f"cuda:<span class="hljs-subst">{torch.cuda.current_device()}</span>"</span>)
</code></pre>
<p>3.  input_latents å›ºå®š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">0.</span>  GPUä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼Œåœ¨GPUä¸Šè¿è¡Œåä¿å­˜ä¸‹æ¥
</code></pre>

<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">sample_reference_model</span>(<span class="hljs-params">  
    args,  
    device,  
    transformer,  
    vae,  
    encoder_hidden_states,  
    pooled_prompt_embeds,  
    text_ids,  
    reward_model,  
    tokenizer,  
    caption,  
    preprocess_val,  
    step,  <span class="hljs-comment"># # # å¢åŠ å‚æ•°è¾“å…¥ï¼Œç”¨äºåºåˆ—æ–‡ä»¶è®°å½•ï¼Œæ‰¾åˆ°ç›¸å…³è°ƒç”¨å¤„ï¼ŒåŠ ä¸Šè¯¥å…¥å‚  </span>
</span>)  

<span class="hljs-keyword">def</span> <span class="hljs-title function_">train_one_step</span>(<span class="hljs-params">  
    args,  
    device,  
    transformer,  
    vae,  
    reward_model,  
    tokenizer,  
    optimizer,  
    lr_scheduler,  
    loader,  
    noise_scheduler,  
    max_grad_norm,  
    preprocess_val,  
    step,  <span class="hljs-comment"># # # å¢åŠ å‚æ•°è¾“å…¥ï¼Œç”¨äºåºåˆ—æ–‡ä»¶è®°å½•ï¼Œæ‰¾åˆ°ç›¸å…³è°ƒç”¨å¤„ï¼ŒåŠ ä¸Šè¯¥å…¥å‚  </span>
</span>) 

<span class="hljs-keyword">def</span> <span class="hljs-title function_">sample_reference_model</span>();  
     ......  
    <span class="hljs-keyword">if</span> args.init_same_noise:  
        input_latents = torch.randn(  
                (<span class="hljs-number">1</span>, IN_CHANNELS, latent_h, latent_w),  <span class="hljs-comment"># ï¼ˆc,t,h,w)  </span>
                device=device,  
                dtype=torch.bfloat16,  
            )  
        torch.save(input_latents, <span class="hljs-string">f"saves/input_latents_<span class="hljs-subst">{step}</span>_<span class="hljs-subst">{torch.distributed.get_rank()}</span>.pt"</span>)
</code></pre>

<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">2.</span> NPUä¸ŠåŠ è½½
</code></pre>

<pre><code class="hljs language-python" lang="python">input_latents = torch.load(<span class="hljs-string">f"saves/input_latents_<span class="hljs-subst">{step}</span>_<span class="hljs-subst">{torch.distributed.get_rank()}</span>.pt"</span>, map_location=<span class="hljs-string">f'cuda:<span class="hljs-subst">{device}</span>'</span>)
</code></pre>
<p>4.  perms å›ºå®š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">0.</span>  GPUä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼Œåœ¨GPUä¸Šè¿è¡Œåä¿å­˜ä¸‹æ¥
</code></pre>

<pre><code class="hljs language-scss" lang="scss">def <span class="hljs-built_in">train_one_step</span>():  
    ......  
    perms = torch.<span class="hljs-built_in">stack</span>(  
            [  
                torch.<span class="hljs-built_in">randperm</span>(<span class="hljs-built_in">len</span>(samples[<span class="hljs-string">"timesteps"</span>][<span class="hljs-number">0</span>]))  
                for _ in <span class="hljs-built_in">range</span>(batch_size)  
            ]  
        ).<span class="hljs-built_in">to</span>(device)  
    torch.<span class="hljs-built_in">save</span>(perms, f<span class="hljs-string">"saves/perms_{step}_{torch.distributed.get_rank()}.pt"</span>)
</code></pre>

<pre><code class="hljs language-css" lang="css"><span class="hljs-number">2</span>. &lt;<span class="hljs-attribute">font</span> style="<span class="hljs-attribute">color</span>:<span class="hljs-built_in">rgb</span>(<span class="hljs-number">37</span>, <span class="hljs-number">43</span>, <span class="hljs-number">58</span>);"&gt;NPUä¸ŠåŠ è½½&lt;/<span class="hljs-attribute">font</span>&gt;
</code></pre>

<pre><code class="hljs language-python" lang="python">perms = torch.load(<span class="hljs-string">f"saves/perms_<span class="hljs-subst">{step}</span>_<span class="hljs-subst">{torch.distributed.get_rank()}</span>.pt"</span>, map_location=<span class="hljs-string">f'<span class="hljs-subst">{device}</span>'</span>)
</code></pre>
<h4 data-id="heading-10">ä½¿ç”¨ CPU è¿›è¡Œéšæœºæ€§å›ºå®š</h4>
<blockquote>
<p>å›ºå®šseedå¯ç”¨äºæ¨¡å‹è®­ç»ƒå¤ç°ï¼Œä½†æ˜¯ä¸åŒçš„è®¾å¤‡å¦‚GPUå’ŒNPUåœ¨åŒæ ·çš„seedä¸‹ç”Ÿæˆçš„å€¼ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼Œä½†æ˜¯ä¸åŒè®¾å¤‡ä¸Šéƒ½æœ‰CPUï¼Œå› æ­¤å¯ä»¥å›ºå®šseedåä½¿ç”¨CPUç”Ÿæˆå¼ é‡ï¼Œä»¥æ­¤è®©GPUå’ŒNPUä¸Šç”Ÿæˆçš„å¼ é‡è¾“å…¥ä¿æŒç›¸åŒ</p>
</blockquote>
<ol start="0">
<li><code>fastvideo/train_grpo_flux.py:91</code>ä¿®æ”¹ä¸º</li>
</ol>

<pre><code class="hljs language-css" lang="css">if grpo and prev_sample is <span class="hljs-attribute">None</span>:  
	prev_sample = prev_sample_mean + torch.<span class="hljs-built_in">randn_like</span>(prev_sample_mean.<span class="hljs-built_in">cpu</span>()).<span class="hljs-built_in">to</span>(  
		prev_sample_mean.device) * std_dev_t
</code></pre>
<p>2.  <code>&lt;font style="color:rgb(59, 62, 85);"&gt;fastvideo/train_grpo_flux.py:270&lt;/font&gt;</code>ä¿®æ”¹ä¸º</p>

<pre><code class="hljs language-ini" lang="ini">if args.init_same_noise:  
	<span class="hljs-attr">input_latents</span> = torch.randn(  
		(1, IN_CHANNELS, latent_h, latent_w),  <span class="hljs-comment">#  ï¼ˆc,t,h,w)  </span>
		<span class="hljs-attr">dtype</span>=torch.bfloat16,  
	).to(device)
</code></pre>
<p>3.  <code>fastvideo/train_grpo_flux.py:657</code>ä¿®æ”¹ä¸º</p>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">sampler</span> = DistributedSampler(  
		train_dataset, <span class="hljs-attr">rank</span>=rank, num_replicas=world_size, shuffle=<span class="hljs-literal">False</span>, seed=args.sampler_seed  
	)
</code></pre>
<p>4.  <code>fastvideo/train_grpo_flux.py:1061</code>å¢åŠ </p>

<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> random  
<span class="hljs-keyword">def</span> <span class="hljs-title function_">seed_all_own</span>(<span class="hljs-params">seed=<span class="hljs-number">1234</span>, mode=<span class="hljs-literal">True</span>, is_gpu=<span class="hljs-literal">True</span></span>):  
	random.seed(seed)  
	os.environ[<span class="hljs-string">'PYTHONHASHSEED'</span>] = <span class="hljs-built_in">str</span>(seed)  
	os.environ[<span class="hljs-string">'GLOBAL_SEED'</span>] = <span class="hljs-built_in">str</span>(seed)  
	np.random.seed(seed)  
	torch.manual_seed(seed)  
	torch.use_deterministic_algorithms(mode)  
	<span class="hljs-keyword">if</span> is_gpu:  
		os.environ[<span class="hljs-string">'CUBLAS_WORKSPACE_CONFIG'</span>] = <span class="hljs-string">':4096:8'</span>  
		os.environ[<span class="hljs-string">'CUDA_LAUNCH_BLOCKING'</span>] = <span class="hljs-string">'1'</span>  
		torch.cuda.manual_seed_all(seed)  
		torch.cuda.manual_seed(seed)  
		torch.backends.cudnn.deterministic = <span class="hljs-literal">True</span>  
		torch.backends.cudnn.enable = <span class="hljs-literal">False</span>  
		torch.backends.cudnn.benchmark = <span class="hljs-literal">False</span>  
	<span class="hljs-keyword">else</span>:  
		<span class="hljs-keyword">import</span> torch_npu  
		os.environ[<span class="hljs-string">'HCCL_DETERMINISTIC'</span>] = <span class="hljs-string">'true'</span>  
		os.environ[<span class="hljs-string">'CLOSE_MATMUL_K_SHIFT'</span>] = <span class="hljs-string">'1'</span>  
		torch_npu.npu.manual_seed_all(seed)  
		torch_npu.npu.manual_seed(seed)  
	<span class="hljs-built_in">print</span>(<span class="hljs-string">"====== seed all ========"</span>)  
seed_all_own(is_gpu=<span class="hljs-literal">False</span>)  
<span class="hljs-keyword">from</span> msprobe.pytorch <span class="hljs-keyword">import</span> seed_all  
seed_all(mode=<span class="hljs-literal">True</span>)
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6906fe89a5014f83961e61592ad775ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5bqX5bCP5LqM5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767141828&amp;x-signature=%2FpMBXviYZx16q1qS2bM3EpiLp6g%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-11">æ¨ç†æµç¨‹å¯¹é½</h3>
<p>æ¨ç†æµç¨‹å¯¹é½çš„å†…å®¹ä¸»è¦æ˜¯ GRPO å»å™ªåç”Ÿæˆçš„ latentsï¼Œlatents è§£ç æˆå›¾ç‰‡åå¯¹æ¯”ï¼šå›ºå®šéšæœºæ€§ï¼Œå°†GPUã€NPUä¸Šä½¿ç”¨ç›¸åŒnoiseçš„latentsä½¿ç”¨vaeè§£ç ï¼Œå†ä¿å­˜ï¼Œæ­¤æ—¶åªéœ€è¦å¯¹æ¯”ç”Ÿæˆå›¾ç‰‡çš„å·®å¼‚ã€‚ å…³é”®ä»£ç ï¼š<code>decoded_image[0].save(img_path)</code>ï¼Œè¿™é‡Œä¼šä¿å­˜è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹åœ¨æ¯ä¸ªstep,æ¯æ¬¡generationä¸­ç”Ÿæˆçš„å›¾ç‰‡ï¼Œå¯ä»¥ç›´è§‚çš„çœ‹åˆ°è®­ç»ƒè¿‡ç¨‹ä¸­çš„çš„å˜åŒ–ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># # # # sample_reference_modelå‡½æ•°  </span>
def sample_reference_model():  
    with torch.inference_mode():  
        with torch.autocast("cuda", <span class="hljs-attr">dtype</span>=torch.bfloat16):  
            <span class="hljs-attr">latents</span> = unpack_latents(latents, h, w, <span class="hljs-number">8</span>)  
                <span class="hljs-attr">latents</span> = (latents / <span class="hljs-number">0.3611</span>) + <span class="hljs-number">0.1159</span>  
                <span class="hljs-attr">image</span> = vae.decode(latents, return_dict=<span class="hljs-literal">False</span>)[<span class="hljs-number">0</span>]  
                <span class="hljs-attr">decoded_image</span> = image_processor.postprocess(  
                image)  
        decoded_image<span class="hljs-section">[0]</span>.save(f"./images/flux_{step}_{rank}_{index}.png")
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8139b4c7585146f083f0e56012127c62~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5bqX5bCP5LqM5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767141828&amp;x-signature=T%2FeQQo0WlnH%2BGKVR0lsgXV2SiQk%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-12">Reward Model å¯¹é½</h3>
<p>DanceGRPO æ¨¡å‹æ¶‰åŠå¤šä¸ª modelï¼Œå¼ºåŒ–å­¦ä¹ ä¸­éœ€è¦å¯¹é½çš„ä¸»è¦æ˜¯losså’Œrewardå€¼ï¼Œè¿™é‡Œè®²çš„æ˜¯å¦‚ä½•å¯¹é½rewardã€‚</p>
<p>æ­¤å¤„é‡‡å–çš„æ–¹æ³•æ˜¯æŠŠreward modelå•ç‹¬æ‹¿å‡ºæ¥ï¼Œforå¾ªç¯å¤šæ­¥ï¼Œå¯¹æ¯”GPUå’ŒNPUçš„å€¼rewardå€¼ï¼Œä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-css" lang="css">for step in range(<span class="hljs-number">1</span>, <span class="hljs-number">1001</span>):
             #  text = <span class="hljs-built_in">tokenizer</span>([batch_caption[<span class="hljs-number">0</span>]]).<span class="hljs-built_in">to</span>(device=device, non_blocking=True)
         image = torch.<span class="hljs-built_in">load</span>(f<span class="hljs-string">"/home/grpo/DanceGRPO/save/images-1/image_{step}_{rank}.pt"</span>)
         text = torch.<span class="hljs-built_in">load</span>(f<span class="hljs-string">"/home/grpo/DanceGRPO/save/texts-1/text_{step}_{rank}.pt"</span>)
         
         #  torch.<span class="hljs-built_in">save</span>(image, f<span class="hljs-string">"/home/GRPO/DanceGRPO/save/images-1/image_{step}_{rank}.pt"</span>)
         #  torch.<span class="hljs-built_in">save</span>(text, f<span class="hljs-string">"/home/GRPO/DanceGRPO/save/texts-1/text_{step}_{rank}.pt"</span>)
         if rank == <span class="hljs-number">0</span>:
             <span class="hljs-built_in">print</span>(f<span class="hljs-string">"image_{rank}_{step}: "</span>, image, <span class="hljs-string">"\n\n"</span>)
             <span class="hljs-built_in">print</span>(f<span class="hljs-string">"text_{rank}_{step}: "</span>, text, <span class="hljs-string">"\n\n"</span>)
         with torch.<span class="hljs-built_in">no_grad</span>():
             with torch.amp.<span class="hljs-built_in">autocast</span>(<span class="hljs-string">"cuda"</span>):
                 outputs = <span class="hljs-built_in">reward_model</span>(image, text)
         if rank == <span class="hljs-number">0</span>:
             <span class="hljs-built_in">print</span>(f<span class="hljs-string">"output_{rank}_{step}: "</span>, outputs, <span class="hljs-string">"\n\n"</span>)
         image_features, text_features = outputs[<span class="hljs-string">"image_features"</span>], outputs[<span class="hljs-string">"text_features"</span>]
         logits_per_image = image_features @ text_features.T
         hps_score = torch.<span class="hljs-built_in">diagonal</span>(logits_per_image)
         all_rewards = []
         all_rewards.<span class="hljs-built_in">append</span>(hps_score)
         all_rewards = torch.<span class="hljs-built_in">cat</span>(all_rewards, dim=<span class="hljs-number">0</span>)
         samples = {
             "rewards": all_rewards.<span class="hljs-built_in">to</span>(torch.float32)
         }
         if rank == <span class="hljs-number">0</span>:
             <span class="hljs-built_in">print</span>(f<span class="hljs-string">"samples_{rank}_{step}: "</span>, samples, <span class="hljs-string">"\n\n"</span>)
         gathered_reward = <span class="hljs-built_in">gather_tensor</span>(samples[<span class="hljs-string">"rewards"</span>])
         if rank == <span class="hljs-number">0</span>:
             <span class="hljs-built_in">print</span>(f<span class="hljs-string">"gather_reward_{rank}_{step}: "</span>, gathered_reward, <span class="hljs-string">"\n\n"</span>)
         if dist.<span class="hljs-built_in">get_rank</span>() == <span class="hljs-number">0</span>:
             <span class="hljs-built_in">print</span>(<span class="hljs-string">"gathered_hps_reward"</span>, gathered_reward)
             with <span class="hljs-built_in">open</span>(<span class="hljs-string">'./hps_reward.txt'</span>, <span class="hljs-string">'a'</span>) as f:
                 f.<span class="hljs-built_in">write</span>(f<span class="hljs-string">"{gathered_reward.mean().item()}\n"</span>)
         samples_batched = {
             k: v.<span class="hljs-built_in">unsqueeze</span>(<span class="hljs-number">1</span>)
             for k, v in samples.<span class="hljs-built_in">items</span>()
         }
         samples_batched_list = <span class="hljs-selector-attr">[             dict(zip(samples_batched, x)) for x in zip(*samples_batched.values())         ]</span>
         for <span class="hljs-selector-tag">i</span>, sample in list(enumerate(samples_batched_list)):
             if rank == <span class="hljs-number">0</span>:
                 <span class="hljs-built_in">print</span>(f<span class="hljs-string">"sample_{rank}_{step}: "</span>, sample[<span class="hljs-string">"rewards"</span>], <span class="hljs-string">"\n\n"</span>)
             if dist.<span class="hljs-built_in">get_rank</span>() % <span class="hljs-number">8</span> == <span class="hljs-number">0</span>:
                 <span class="hljs-built_in">print</span>(<span class="hljs-string">"hps reward"</span>, sample[<span class="hljs-string">"rewards"</span>].<span class="hljs-built_in">item</span>(), <span class="hljs-string">"\n\n\n\n\n"</span>)
             #  <span class="hljs-built_in">print</span>(<span class="hljs-string">"ratio"</span>, ratio)
             #  <span class="hljs-built_in">print</span>(<span class="hljs-string">"advantage"</span>, sample[<span class="hljs-string">"advantages"</span>].<span class="hljs-built_in">item</span>())
             #  <span class="hljs-built_in">print</span>(<span class="hljs-string">"final loss"</span>, loss.<span class="hljs-built_in">item</span>())
</code></pre>
<p>ç”Ÿæˆ1000ä¸ªrewardå€¼ï¼Œå…¶ç²¾åº¦å¯¹æ¯”æ•ˆæœå¦‚ä¸‹ï¼ˆç»å¯¹è¯¯å·®â‰ˆ0.015%ï¼‰ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/07e76283de7847b68d7cbfdaf3bfdad4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5bqX5bCP5LqM5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767141828&amp;x-signature=aWHYdjoIEHMhXwuR%2FBFRNYm6tJc%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>æ•°æ®ã€å›¾ç‰‡æ¥è‡ªæ˜‡è…¾å®˜æ–¹æ•°æ®ã€‚</p>
</blockquote>
<h3 data-id="heading-13">ç«¯åˆ°ç«¯å¯¹é½</h3>
<h4 data-id="heading-14">å¯¹é½æ ‡å‡†</h4>
<p>å›ºå®šéšæœºæ€§åï¼Œéœ€è¦æŒ‰ç…§å¦‚ä¸‹æ ‡å‡†å…³æ³¨å¯¹é½ç»“æœï¼š</p>
<ul>
<li>å…³æ³¨æ¨ç†é˜¶æ®µç”Ÿæˆçš„å›¾ç‰‡ï¼Œä¸»è§‚å¯¹é½</li>
<li>å…³æ³¨è®­ç»ƒè¿‡ç¨‹ä¸­çš„lossï¼ˆç”Ÿæˆæ¨¡å‹lossè¾ƒå°ï¼Œå‚è€ƒä»·å€¼æœ‰é™ï¼‰</li>
<li>å…³æ³¨reward scoresï¼Œ200æ­¥è¯¯å·®5%ä»¥å†…</li>
</ul>
<h4 data-id="heading-15">å¯¹é½æ­¥éª¤</h4>
<p>ç«¯åˆ°ç«¯å¯¹é½æµç¨‹ä¸»è¦å…³æ³¨ä¸¤æ–¹é¢ï¼Œä¸€æ–¹é¢æ˜¯ç»¼åˆåº¦é‡æ¨¡å‹è®­ç»ƒçš„æŒ‡æ ‡ï¼šæ¨ç†é˜¶æ®µå›¾ç‰‡+loss+rward scoresï¼Œå¦ä¸€æ–¹é¢æ˜¯ä¸‹æ¸¸ä»»åŠ¡æ¨ç†æ•ˆæœã€‚</p>
<p><strong>å…¨æµç¨‹å¯¹é½å…·ä½“æ­¥éª¤ï¼š</strong></p>
<ul>
<li>ä¸¤è¾¹åŠ è½½ç›¸åŒçš„é¢„è®­ç»ƒæƒé‡ã€‚</li>
<li>å›ºå®šéšæœºæ€§ï¼šæ•´ä½“éšæœºæ€§ä¸ç¡®å®šæ€§è®¡ç®—å›ºå®šï¼ˆseed_all,mode=Trueï¼‰ï¼Œnoiseåœ¨cpuä¾§ç”Ÿæˆã€‚</li>
<li>ä¿å­˜å…³é”®ä¿¡æ¯ï¼šæ¨ç†é˜¶æ®µçš„å›¾ç‰‡ã€rewardé˜¶æ®µçš„rewardvaluesã€è®­ç»ƒé˜¶æ®µæ¨¡å‹lossï¼ŒåŒæ—¶ä¿å­˜æƒé‡ï¼Œç”¨äºå¯¹é½æ¨ç†æ•ˆæœï¼Œæ­¤å¤„æ³¨æ„éœ€è¦æŒç»­å…³æ³¨æ¨ç†é˜¶æ®µç”Ÿæˆå›¾ç‰‡çš„æ•ˆæœï¼Œå…·ä½“ä¾‹å­ä¸ºåœ¨æ›¿æ¢ropeèåˆç®—å­æ—¶ï¼Œlossç»“æœä¸rewardå·®å¼‚ä¸å¤§ï¼Œä½†æ¨ç†é˜¶æ®µå‡ºç°äº†èŠ±å›¾ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ef95c41d13c4315ba7e6792a5fa3272~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5bqX5bCP5LqM5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767141828&amp;x-signature=q5WSoTkqOi0aLn21ikGWmjHeMpI%3D" alt="" loading="lazy"/></p>
<p><strong>ç«¯åˆ°ç«¯æµç¨‹ç»“æ„</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/06fbff03ab4d4a48895f635bcf04acb3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5bqX5bCP5LqM5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767141828&amp;x-signature=lMknB93Qt7228tSAcYcBYH1nj44%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-16">å…­ã€å¸¸è§é—®é¢˜</h2>
<p>å¦‚é‡åˆ°<code>ROPE</code>éƒ¨åˆ†ä¸æ”¯æŒ<code>complex128</code>è®¡ç®—é—®é¢˜ï¼ŒNPUåœºæ™¯éœ€è¦é€‚é…ä¿®æ”¹<code>___CODE_BLOCK_PLACEHOLDER___211250</code>è¡Œ</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">is_mps</span> = ids.device.type == <span class="hljs-string">"mps"</span>
<span class="hljs-attr">is_npu</span> = ids.device.type == <span class="hljs-string">"npu"</span>  <span class="hljs-comment">#å¢åŠ æ”¹è¡Œ</span>

<span class="hljs-comment">##ä¸‹é¢å¢åŠ is_npuåˆ¤æ–­</span>
<span class="hljs-attr">freqs_dtype</span> = torch.float32 if is_mps or is_npu else torch.float64
</code></pre>
<h2 data-id="heading-17">ä¸ƒã€æ€»ç»“</h2>
<p>DanceGRPO+FLUX æ¨¡å‹åœ¨ AI ç”Ÿå›¾é¢†åŸŸï¼Œè§£å†³ FLUX åœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­ä¸äººç±»å®¡ç¾ã€è¯­ä¹‰å¯¹é½ç­‰æ–¹é¢çš„é€‚é…é—®é¢˜ï¼Œå¤§å¹…æå‡å…¶ç”Ÿå›¾è´¨é‡ä¸ç¨³å®šæ€§ã€‚å±•æœ›æœªæ¥ï¼Œå¤šæ¨¡æ€ç”Ÿæˆå¼ºåŒ–å­¦ä¹ æ¨¡å‹æœ‰æœ›åœ¨æ›´å¤šé¢†åŸŸå¼€èŠ±ç»“æœï¼Œå¦‚å½±è§†ç‰¹æ•ˆåˆ¶ä½œä¸­å®ç°æ›´é€¼çœŸçš„è™šæ‹Ÿåœºæ™¯ä¸è§’è‰²åˆ›å»ºï¼Œæ•™è‚²é¢†åŸŸä¸­æ‰“é€ æ²‰æµ¸å¼çš„å­¦ä¹ ç¯å¢ƒï¼ŒåŒ»ç–—é¢†åŸŸè¾…åŠ©åŒ»ç”Ÿè¿›è¡Œæ‰‹æœ¯æ¨¡æ‹Ÿä¸ç—…æƒ…å¯è§†åŒ–åˆ†æç­‰ ã€‚åŒæ—¶ï¼Œéšç€æŠ€æœ¯å‘å±•ï¼Œæ¨¡å‹å°†ä¸æ–­ä¼˜åŒ–ï¼Œç”Ÿæˆæ•ˆç‡ä¸è´¨é‡è¿›ä¸€æ­¥æå‡ï¼Œåœ¨å¤„ç†å¤æ‚ä»»åŠ¡ã€ç†è§£æ¨¡ç³ŠæŒ‡ä»¤ç­‰æ–¹é¢å–å¾—æ›´å¤§çªç ´ï¼Œä¸ºå„è¡Œä¸šæ•°å­—åŒ–è½¬å‹ä¸åˆ›æ–°å‘å±•æ³¨å…¥å¼ºå¤§åŠ¨åŠ› ã€‚</p>
<p>æ³¨æ˜ï¼šæ˜‡è…¾PAEæ¡ˆä¾‹åº“å¯¹æœ¬æ–‡å†™ä½œäº¦æœ‰å¸®åŠ©ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[YOLO11ç®—æ³•æ·±åº¦è§£æï¼šå››å¤§å·¥ä¸šåœºæ™¯å®æˆ˜ï¼Œå¼€æºæ•°æ®é›†åŠ©åŠ›AIè´¨æ£€è½åœ°]]></title>    <link>https://juejin.cn/post/7587175302347440163</link>    <guid>https://juejin.cn/post/7587175302347440163</guid>    <pubDate>2025-12-24T02:05:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587175302347440163" data-draft-id="7587175302347259939" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="YOLO11ç®—æ³•æ·±åº¦è§£æï¼šå››å¤§å·¥ä¸šåœºæ™¯å®æˆ˜ï¼Œå¼€æºæ•°æ®é›†åŠ©åŠ›AIè´¨æ£€è½åœ°"/> <meta itemprop="keywords" content="ç®—æ³•,è®¡ç®—æœºè§†è§‰,æ·±åº¦å­¦ä¹ "/> <meta itemprop="datePublished" content="2025-12-24T02:05:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="CoovallyAIHub"/> <meta itemprop="url" content="https://juejin.cn/user/2461151071843739"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            YOLO11ç®—æ³•æ·±åº¦è§£æï¼šå››å¤§å·¥ä¸šåœºæ™¯å®æˆ˜ï¼Œå¼€æºæ•°æ®é›†åŠ©åŠ›AIè´¨æ£€è½åœ°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2461151071843739/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    CoovallyAIHub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T02:05:03.000Z" title="Wed Dec 24 2025 02:05:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å·¥ä¸šæ™ºé€ çš„æ—¶ä»£æµªæ½®ä¸­ï¼Œäº§å“è´¨é‡æ˜¯ä¼ä¸šç«‹è¶³ä¹‹æœ¬ã€‚ä¼ ç»Ÿç¼ºé™·æ£€æµ‹ä¾èµ–äººå·¥ï¼Œæ•ˆç‡ä½ã€æ˜“æ¼æ£€ï¼Œæˆä¸ºåˆ¶çº¦äº§çº¿è‡ªåŠ¨åŒ–å‡çº§çš„ç“¶é¢ˆã€‚å¦‚ä»Šï¼Œéšç€Ultralytics YOLO11çš„å‘å¸ƒï¼Œå·¥ä¸šè´¨æ£€æ­£å¼è¿ˆå…¥é«˜ç²¾åº¦ã€é«˜é€Ÿåº¦ã€é«˜é€‚åº”æ€§çš„AIæ–°é˜¶æ®µã€‚</p>
<h2 data-id="heading-0"><strong>YOLO11ç®—æ³•æ·±åº¦è§£æï¼šä¸ºä½•å¦‚æ­¤é€‚é…å·¥ä¸šç¼ºé™·æ£€æµ‹ï¼Ÿ</strong></h2>
<p>ç®—æ³•æ¶æ„ä¸å·¥ä¸šéœ€æ±‚çš„å®Œç¾å¥‘åˆ</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/97afca86a8f84103a86009394a6d8f57~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767146729&amp;x-signature=r2HFI1zOf%2FZDNqmF9Mb4Lis2MuA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li><strong>å°ç›®æ ‡æ£€æµ‹èƒ½åŠ›çªç ´</strong></li>
</ul>
<p>å·¥ä¸šç¼ºé™·é€šå¸¸å°ºå¯¸å¾®å°ã€ç‰¹å¾ä¸æ˜æ˜¾ã€‚YOLO11é€šè¿‡ä»¥ä¸‹åˆ›æ–°è§£å†³è¿™ä¸€ç—›ç‚¹ï¼š</p>
<ul>
<li><strong>å¤šå°ºåº¦ç‰¹å¾é‡‘å­—å¡”ä¼˜åŒ–ï¼š</strong> åœ¨ç‰¹å¾æå–é˜¶æ®µå®ç°æ·±æµ…å±‚ç‰¹å¾çš„é«˜æ•ˆèåˆ</li>
<li><strong>è‡ªé€‚åº”æ„Ÿå—é‡è®¾è®¡ï¼š</strong> è‡ªåŠ¨è°ƒæ•´å·ç§¯æ ¸æ„Ÿå—é‡ï¼Œæ•è·ä¸åŒå°ºåº¦ç¼ºé™·ç‰¹å¾</li>
<li><strong>ç»†ç²’åº¦ç‰¹å¾å¢å¼ºæ¨¡å—ï¼š</strong> ä¸“é—¨é’ˆå¯¹å¾®å°ç¼ºé™·çš„ç‰¹å¾æå–è¿›è¡Œå¼ºåŒ–</li>
</ul>

<ul>
<li><strong>å¤æ‚ç¯å¢ƒé²æ£’æ€§è®¾è®¡</strong></li>
</ul>
<p>å·¥ä¸šç°åœºå…‰ç…§å˜åŒ–ã€ç²‰å°˜å¹²æ‰°ã€è®¾å¤‡æŒ¯åŠ¨ç­‰é—®é¢˜æ™®éå­˜åœ¨ï¼š</p>
<ul>
<li><strong>æ•°æ®å¢å¼ºç­–ç•¥ä¼˜åŒ–ï¼š</strong> ä¸“é—¨é’ˆå¯¹å·¥ä¸šåœºæ™¯çš„å…‰ç…§å˜åŒ–ã€æ¨¡ç³Šã€å™ªå£°ç­‰è¿›è¡Œå¢å¼º</li>
<li><strong>æ³¨æ„åŠ›æœºåˆ¶èåˆï¼š</strong> EMAã€CBAMç­‰æ³¨æ„åŠ›æ¨¡å—çš„é›†æˆï¼Œæå‡æ¨¡å‹æŠ—å¹²æ‰°èƒ½åŠ›</li>
<li><strong>åŠ¨æ€é˜ˆå€¼è°ƒæ•´ï¼š</strong> æ ¹æ®ç¯å¢ƒå˜åŒ–è‡ªåŠ¨è°ƒæ•´æ£€æµ‹é˜ˆå€¼ï¼Œä¿æŒç¨³å®šæ£€å‡ºç‡</li>
</ul>

<ul>
<li><strong>å®æ—¶æ€§èƒ½ä¸ç²¾åº¦å¹³è¡¡</strong></li>
</ul>
<p>é«˜é€Ÿç”Ÿäº§çº¿è¦æ±‚æ¯«ç§’çº§å“åº”ï¼š</p>
<ul>
<li><strong>è½»é‡åŒ–Backboneè®¾è®¡ï¼š</strong> åœ¨ç²¾åº¦æŸå¤±æœ€å°åŒ–çš„å‰æä¸‹å‡å°‘è®¡ç®—é‡30%ä»¥ä¸Š</li>
<li><strong>NMSç®—æ³•ä¼˜åŒ–ï¼š</strong> å‡å°‘åå¤„ç†æ—¶é—´ï¼Œæå‡æ•´ä½“æ¨ç†é€Ÿåº¦</li>
<li><strong>å¼‚æ„è®¡ç®—æ”¯æŒï¼š</strong> å…¨é¢æ”¯æŒGPUã€NPUã€è¾¹ç¼˜è®¡ç®—èŠ¯ç‰‡çš„åŠ é€Ÿ</li>
</ul>
<h2 data-id="heading-1"><strong>æ€§èƒ½å¯¹æ¯”ï¼šYOLO11 vs ä¼ ç»Ÿå·¥ä¸šæ£€æµ‹æ–¹æ¡ˆ</strong></h2>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d2361dc8cdee4e00829bb7c993de2f46~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767146729&amp;x-signature=M1XGJrlFfSuB%2BTmx0tR8clUQbAg%3D" alt="screenshot_2025-12-23_15-01-30.png" loading="lazy"/></p>
<h2 data-id="heading-2"><strong>YOLO11åœ¨å·¥ä¸šç¼ºé™·æ£€æµ‹ä¸­çš„å››å¤§å…¸å‹åº”ç”¨</strong></h2>
<ul>
<li><strong>PCBç¼ºé™·æ£€æµ‹</strong></li>
</ul>
<p>å°åˆ·ç”µè·¯æ¿ï¼ˆPCBï¼‰æ˜¯ç°ä»£ç”µå­è®¾å¤‡çš„æ ¸å¿ƒç»„ä»¶ï¼Œå…¶è´¨é‡ç›´æ¥å½±å“æ•´ä¸ªç”µå­äº§å“çš„å¯é æ€§ã€‚ä¼ ç»ŸPCBç¼ºé™·æ£€æµ‹ä¸»è¦ä¾èµ–äººå·¥è§†è§‰æ£€æŸ¥ï¼Œè¿™ç§æ–¹æ³•ä¸ä»…æ•ˆç‡ä½ä¸‹ï¼Œè€Œä¸”å®¹æ˜“å—åˆ°æ“ä½œå‘˜ç–²åŠ³å’Œä¸»è§‚åˆ¤æ–­çš„å½±å“ã€‚</p>
<p>ç®—æ³•é€‚é…ä¼˜åŠ¿ï¼š</p>
<ul>
<li>é’ˆå¯¹ç„Šç‚¹ã€çº¿è·¯ç­‰äºšæ¯«ç±³çº§ç¼ºé™·ï¼ŒYOLO11çš„å¾®å°ç›®æ ‡æ£€æµ‹èƒ½åŠ›å¾—åˆ°å……åˆ†å‘æŒ¥</li>
<li>è‡ªé€‚åº”å¤šå°ºåº¦ç‰¹å¾èåˆï¼Œè§£å†³PCBæ¿ä¸åŒå±‚çº§çš„ç¼ºé™·è¯†åˆ«é—®é¢˜</li>
</ul>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d89f6872e80a4b988903c1c80e9d355f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767146729&amp;x-signature=7eGAG8IGEFxQIIUg%2BnWr3YdE4Gs%3D" alt="å›¾ç‰‡2.png" loading="lazy"/></p>
<ul>
<li><strong>æ— äººæœºèˆªæ‹é£åŠ›å¶ç‰‡ç¼ºé™·æ£€æµ‹</strong></li>
</ul>
<p>é£åŠ›å‘ç”µå¶ç‰‡é•¿æœŸæš´éœ²åœ¨æ¶åŠ£ç¯å¢ƒä¸­ï¼Œè¡¨é¢æ˜“äº§ç”Ÿè£‚çº¹ã€è…èš€ã€é›·å‡»æŸä¼¤ç­‰ç¼ºé™·ï¼Œä¼ ç»Ÿäººå·¥å·¡æ£€æ•ˆç‡ä½ã€é£é™©é«˜ã€è¦†ç›–èŒƒå›´æœ‰é™ã€‚</p>
<p>ç®—æ³•é€‚é…ä¼˜åŠ¿ï¼š</p>
<ul>
<li>å¤§å°ºåº¦åœºæ™¯è‡ªé€‚åº”æ£€æµ‹ï¼šYOLO11èƒ½å¤Ÿå¤„ç†é«˜ç©ºæ‹æ‘„çš„å¤§å°ºåº¦å›¾åƒï¼Œè‡ªåŠ¨é€‚åº”ä¸åŒè·ç¦»å’Œè§’åº¦çš„å¶ç‰‡æ£€æµ‹</li>
<li>åŠ¨æ€ç¯å¢ƒé²æ£’æ€§ï¼šåœ¨å¼ºé£ã€å…‰ç…§å˜åŒ–ã€äº‘å±‚é®æŒ¡ç­‰å¤æ‚æ°”è±¡æ¡ä»¶ä¸‹ä¿æŒç¨³å®šæ€§èƒ½</li>
<li>å°ç›®æ ‡è£‚çº¹è¯†åˆ«ï¼šå¯¹å¶ç‰‡è¡¨é¢å¾®è£‚çº¹ã€è¾¹ç¼˜æŸä¼¤ç­‰ç»†å°ç¼ºé™·å…·å¤‡ç²¾å‡†è¯†åˆ«èƒ½åŠ›</li>
</ul>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc552a2d61f04575a5b774edb9431fde~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767146729&amp;x-signature=ilOl0VREWy0oUgq5wmE4syXxwJ8%3D" alt="å›¾ç‰‡3.png" loading="lazy"/></p>
<ul>
<li><strong>ç“¶è£…é…’ç‘•ç–µæ£€æµ‹</strong></li>
</ul>
<p>é…’ç±»ç”Ÿäº§è¿‡ç¨‹ä¸­ï¼Œç“¶èº«ç¼ºé™·ã€æ ‡ç­¾é”™ä½ã€æ¶²ä½å¼‚å¸¸ã€å°å£ä¸ä¸¥ç­‰é—®é¢˜ç›´æ¥å½±å“äº§å“å“è´¨å’Œå“ç‰Œå½¢è±¡ï¼Œä¼ ç»Ÿäººå·¥ç¯æ£€å­˜åœ¨è§†è§‰ç–²åŠ³å’Œæ ‡å‡†ä¸ä¸€çš„é—®é¢˜ã€‚</p>
<p>ç®—æ³•é€‚é…ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>é€æ˜æè´¨é€‚åº”èƒ½åŠ›ï¼š</strong> YOLO11é’ˆå¯¹ç»ç’ƒç“¶èº«çš„é€å…‰æ€§å’Œåå…‰ç‰¹æ€§è¿›è¡Œäº†ä¸“é¡¹ä¼˜åŒ–</li>
<li><strong>é«˜é€Ÿäº§çº¿å®æ—¶æ£€æµ‹ï¼š</strong> æ”¯æŒé«˜é€Ÿäº§çº¿ï¼Œå®ç°æ¯«ç§’çº§å•ç“¶æ£€æµ‹</li>
<li><strong>å¤šç¼ºé™·ç±»å‹åŒæ­¥è¯†åˆ«ï¼š</strong> èƒ½å¤ŸåŒæ—¶æ£€æµ‹ç“¶èº«ã€æ ‡ç­¾ã€æ¶²ä½ã€å°å£ç­‰å¤šä¸ªç»´åº¦çš„ç¼ºé™·</li>
</ul>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc87d9f033824134a00b6ac4899bef64~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767146729&amp;x-signature=GbQQT1ejdTNRNnip79CqC%2FL9%2FDo%3D" alt="å›¾ç‰‡4.png" loading="lazy"/></p>
<ul>
<li><strong>é’¢é“è¡¨é¢ç¼ºé™·æ£€æµ‹</strong></li>
</ul>
<p>é’¢é“ç”Ÿäº§è¿‡ç¨‹ä¸­è¡¨é¢æ˜“äº§ç”Ÿåˆ’ç—•ã€å‡¹å‘ã€æ°§åŒ–çš®ã€ç»“ç–¤ç­‰å¤šç§ç¼ºé™·ï¼Œä¼ ç»Ÿæ£€æµ‹æ–¹æ³•å—é™äºç¯å¢ƒå…‰çº¿ã€é’¢æåå…‰ç­‰å› ç´ ï¼Œæ£€æµ‹ç¨³å®šæ€§ä¸è¶³ã€‚</p>
<p>ç®—æ³•é€‚é…ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>å¼ºåå…‰è¡¨é¢é€‚åº”ï¼š</strong> ä¸“é—¨ä¼˜åŒ–äº†é«˜åå…‰é‡‘å±è¡¨é¢çš„ç¼ºé™·æ£€æµ‹ç®—æ³•</li>
<li><strong>é«˜æ¸©ç¯å¢ƒé€‚åº”æ€§ï¼š</strong> èƒ½å¤Ÿåœ¨è½§é’¢ç”Ÿäº§çº¿çš„é«˜æ¸©ç¯å¢ƒä¸‹ç¨³å®šè¿è¡Œ</li>
<li><strong>è¿ç»­è¿åŠ¨ç›®æ ‡æ£€æµ‹ï¼š</strong> é’ˆå¯¹é«˜é€Ÿè¿åŠ¨çš„é’¢æ¿ã€é’¢å¸¦å®ç°å®æ—¶åœ¨çº¿æ£€æµ‹</li>
</ul>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/367c457ee9dd4464a0eb9474fb24bf48~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767146729&amp;x-signature=wdMnTDR4PsvE8th%2FfViNkHkLEiw%3D" alt="å›¾ç‰‡5.png" loading="lazy"/></p>
<p><strong>è¿™äº›æ•°æ®é›†å·²åœ¨Coovallyå¼€æºå…è´¹ä½¿ç”¨ï¼Œå¹¶ä¸”å¹³å°ä¹Ÿå·²ç»å®‰è£…YOLO11ç®—æ³•ï¼Œå¯ç›´æ¥è°ƒç”¨ï¼</strong></p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca540bd091ae426d834f90c9c46ee477~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767146729&amp;x-signature=QuC%2BfIv3zNPzMSmiDm9%2FtHCveI8%3D" alt="æ¨¡å‹æ•°æ®é›†.GIF" loading="lazy"/></p>
<h2 data-id="heading-3"><strong>æœªæ¥å±•æœ›ï¼šYOLO11åœ¨å·¥ä¸šç¼ºé™·æ£€æµ‹çš„å‘å±•è¶‹åŠ¿</strong></h2>
<ul>
<li><strong>æŠ€æœ¯æ¼”è¿›æ–¹å‘</strong></li>
</ul>
<p><strong>1. æ— NMSæ¨ç†ä¼˜åŒ–</strong></p>
<ul>
<li>ç«¯åˆ°ç«¯æ£€æµ‹æ¶æ„ï¼Œç®€åŒ–æ¨ç†æµç¨‹</li>
<li>ä¸€å¯¹ä¸€åŒ¹é…ç­–ç•¥ï¼Œæå‡æ£€æµ‹æ•ˆç‡</li>
</ul>
<p><strong>2. è‡ªç›‘ç£å­¦ä¹ åº”ç”¨</strong></p>
<ul>
<li>åˆ©ç”¨æœªæ ‡æ³¨æ•°æ®é¢„è®­ç»ƒï¼Œé™ä½æ ‡æ³¨æˆæœ¬</li>
<li>å¯¹æ¯”å­¦ä¹ å¢å¼ºç‰¹å¾è¡¨ç¤ºèƒ½åŠ›</li>
</ul>
<p><strong>3. å¤šæ¨¡æ€èåˆæ£€æµ‹</strong></p>
<ul>
<li>ç»“åˆçº¢å¤–ã€è¶…å£°ç­‰å¤šç§ä¼ æ„Ÿæ•°æ®</li>
<li>è·¨æ¨¡æ€ç‰¹å¾å¯¹é½ä¸èåˆ</li>
</ul>

<ul>
<li><strong>è¡Œä¸šåº”ç”¨æ‹“å±•</strong></li>
</ul>
<p>æ™ºèƒ½åˆ¶é€ æ·±åŒ–ï¼š</p>
<ul>
<li>ä¸æ•°å­—å­ªç”ŸæŠ€æœ¯ç»“åˆï¼Œå®ç°é¢„æµ‹æ€§ç»´æŠ¤</li>
<li>èå…¥ç”Ÿäº§æ§åˆ¶ç³»ç»Ÿï¼Œå½¢æˆè´¨é‡é—­ç¯</li>
</ul>
<p>æ–°å…´é¢†åŸŸåº”ç”¨ï¼š</p>
<ul>
<li>æ–°èƒ½æºè®¾å¤‡æ£€æµ‹ï¼ˆé£ç”µå¶ç‰‡ã€å…‰ä¼ç»„ä»¶ï¼‰</li>
<li>ç²¾å¯†åˆ¶é€ è´¨æ£€ï¼ˆåŠå¯¼ä½“ã€åŒ»ç–—å™¨æ¢°ï¼‰</li>
<li>åŸºç¡€è®¾æ–½ç›‘æµ‹ï¼ˆæ¡¥æ¢ã€éš§é“ã€å¤§åï¼‰</li>
</ul>
<h2 data-id="heading-4"><strong>ç»“è¯­</strong></h2>
<p>YOLO11å‡­å€Ÿå…¶å“è¶Šçš„ç®—æ³•é€‚é…æ€§å’Œå¼ºå¤§çš„å·¥ä¸šåœºæ™¯é€‚åº”èƒ½åŠ›ï¼Œæ­£åœ¨é‡æ–°å®šä¹‰å·¥ä¸šç¼ºé™·æ£€æµ‹çš„æ ‡å‡†ã€‚ä»å¾®å°ç”µå­å…ƒä»¶çš„æ˜¾å¾®ç¼ºé™·åˆ°å¤§å‹å·¥ä¸šè®¾å¤‡çš„å®è§‚å¼‚å¸¸ï¼Œä»é™æ€ç²¾å¯†æ£€æµ‹åˆ°é«˜é€ŸåŠ¨æ€è´¨æ£€ï¼ŒYOLO11éƒ½å±•ç°å‡ºæƒŠäººçš„æŠ€æœ¯ä¼˜åŠ¿ã€‚</p>
<p>éšç€ç®—æ³•çš„æŒç»­ä¼˜åŒ–å’Œåº”ç”¨åœºæ™¯çš„ä¸æ–­æ‹“å±•ï¼ŒYOLO11ä¸ä»…å°†æ¨åŠ¨å·¥ä¸šè´¨æ£€æŠ€æœ¯å‘å‰å‘å±•ï¼Œæ›´å°†ä¸ºæ™ºèƒ½åˆ¶é€ ã€å·¥ä¸š4.0ç­‰é‡å¤§æˆ˜ç•¥çš„å®æ–½æä¾›åšå®çš„æŠ€æœ¯æ”¯æ’‘ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LangChain å…¥é—¨å®æˆ˜ï¼šä»é›¶æ­å»º AI åº”ç”¨å·¥ä½œæµ]]></title>    <link>https://juejin.cn/post/7586974728578416659</link>    <guid>https://juejin.cn/post/7586974728578416659</guid>    <pubDate>2025-12-24T01:22:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586974728578416659" data-draft-id="7586869907066372131" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LangChain å…¥é—¨å®æˆ˜ï¼šä»é›¶æ­å»º AI åº”ç”¨å·¥ä½œæµ"/> <meta itemprop="keywords" content="JavaScript,LangChain,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-24T01:22:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å—å±±å®‰"/> <meta itemprop="url" content="https://juejin.cn/user/1795929588117962"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LangChain å…¥é—¨å®æˆ˜ï¼šä»é›¶æ­å»º AI åº”ç”¨å·¥ä½œæµ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1795929588117962/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å—å±±å®‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T01:22:19.000Z" title="Wed Dec 24 2025 01:22:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>2022 å¹´åº• ChatGPT æ¨ªç©ºå‡ºä¸–ï¼Œè®©å¤§å®¶çœŸæ­£æ„Ÿå—åˆ°å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„å¨åŠ›ã€‚ä½†å…¶å®åœ¨ ChatGPT å‘å¸ƒä¹‹å‰ï¼Œå°±å·²ç»æœ‰ä¸€ä¸ªä¸“é—¨ä¸º AI åº”ç”¨å¼€å‘è€Œç”Ÿçš„æ¡†æ¶â€”â€”<strong>LangChain</strong>ï¼Œå¦‚ä»Šå®ƒå·²ç»å‘å±•åˆ° 1.0+ ç‰ˆæœ¬ï¼Œæˆä¸ºæœ€å—æ¬¢è¿çš„ LLM åº”ç”¨å¼€å‘æ¡†æ¶ä¹‹ä¸€ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼ŒLangChain å°±æ˜¯ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…å¿«é€ŸæŠŠå¤§è¯­è¨€æ¨¡å‹é›†æˆåˆ°å®é™…ä¸šåŠ¡ä¸­çš„â€œå·¥å…·ç®±â€ã€‚å®ƒè§£å†³äº†ä¸¤ä¸ªæ ¸å¿ƒé—®é¢˜ï¼š</p>
<ol>
<li>å¤§æ¨¡å‹åˆ‡æ¢æˆæœ¬é«˜ï¼ˆä¸åŒå‚å•† API ä¸ç»Ÿä¸€ï¼‰</li>
<li>çœŸå®ä¸šåŠ¡åœºæ™¯å¾€å¾€ä¸æ˜¯â€œä¸€é—®ä¸€ç­”â€é‚£ä¹ˆç®€å•ï¼Œéœ€è¦å¤šæ­¥å¤„ç†ã€ç»„åˆå¤šç§èƒ½åŠ›</li>
</ol>
<p>LangChain çš„åå­—å°±å¾ˆç›´ç™½ï¼š<strong>Lang</strong>ï¼ˆLanguage Modelï¼‰ + <strong>Chain</strong>ï¼ˆé“¾ï¼‰ã€‚æŠŠè¯­è¨€æ¨¡å‹åƒç§¯æœ¨ä¸€æ ·ä¸²èµ·æ¥ï¼Œå½¢æˆå¯å¤ç”¨ã€å¯é…ç½®çš„å·¥ä½œæµã€‚</p>
<p>æœ¬æ–‡å°†ç»“åˆå®é™…ä»£ç ï¼Œä»æœ€åŸºç¡€çš„è°ƒç”¨å¼€å§‹ï¼Œä¸€æ­¥æ­¥å¸¦ä½ æŒæ¡ LangChain çš„æ ¸å¿ƒæ¦‚å¿µã€‚æ‰€æœ‰ä»£ç éƒ½åŸºäº Node.jsï¼ˆESM æ¨¡å—ï¼‰ä¸ DeepSeek æ¨¡å‹å®æˆ˜è¿è¡Œé€šè¿‡ï¼Œé€‚åˆå‰ç«¯å¼€å‘è€…å¿«é€Ÿä¸Šæ‰‹ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ç¯å¢ƒå‡†å¤‡ä¸ç¬¬ä¸€ä¸ª Hello World</h2>
<h3 data-id="heading-2">1. å®‰è£…ä¾èµ–</h3>
<pre><code class="hljs language-Bash" lang="Bash">pnpm init
pnpm i @langchain/deepseek @langchain/core dotenv
</code></pre>
<h3 data-id="heading-3">2. é…ç½® API Key</h3>
<p>åˆ›å»º .env æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">.env
`<span class="hljs-attr">DEEPSEEK_API_KEY</span>=sk-ä½ çš„å¯†é’¥`
</code></pre>
<h3 data-id="heading-4">3. æœ€ç®€å•çš„è°ƒç”¨ï¼ˆmain.jsï¼‰</h3>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">import</span> <span class="hljs-string">"dotenv/config"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatDeepSeek</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/deepseek"</span>;

<span class="hljs-keyword">const</span> model = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatDeepSeek</span>({
  <span class="hljs-attr">model</span>: <span class="hljs-string">"deepseek-reasoner"</span>, <span class="hljs-comment">// æ¨ç†èƒ½åŠ›æ›´å¼ºçš„æ¨¡å‹</span>
  <span class="hljs-attr">temperature</span>: <span class="hljs-number">0</span>,             <span class="hljs-comment">// ç¡®å®šæ€§è¾“å‡º</span>
});

<span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> model.<span class="hljs-title function_">invoke</span>(<span class="hljs-string">"è®²ä¸€ä¸ªæ²¸ç¾Šç¾Šå’Œç¾ç¾Šç¾Šçš„çŸ­æ•…äº‹"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res.<span class="hljs-property">content</span>);
</code></pre>
<p>è¿™å°±æ˜¯ LangChain æœ€æ ¸å¿ƒçš„ä»·å€¼ä¹‹ä¸€ï¼š<strong>ç»Ÿä¸€çš„ LLM æ¥å£</strong>ã€‚</p>
<p>ä½ åªéœ€è¦æ¢ä¸€è¡Œå¯¼å…¥å’Œå®ä¾‹åŒ–ï¼Œå°±èƒ½æ— ç¼åˆ‡æ¢åˆ° OpenAIã€Anthropicã€é€šä¹‰åƒé—®ã€ç™¾åº¦æ–‡å¿ƒç­‰å‡ åç§æ¨¡å‹ã€‚çœå»äº†æ¯æ¬¡éƒ½è¦ç ”ç©¶æ–° API æ–‡æ¡£çš„éº»çƒ¦ã€‚</p>
<h4 data-id="heading-5">ä¸ºä»€ä¹ˆè¿™æ®µä»£ç é‡Œä¸ç”¨æ‰‹åŠ¨æŒ‡å®š apiKey å’Œ baseURLï¼Ÿ</h4>
<p><strong>ç­”æ¡ˆå¾ˆç®€å•</strong>ï¼šLangChain çš„ @langchain/deepseek åŒ…åœ¨è®¾è®¡æ—¶ï¼Œå·²ç»å¸®ä½ æŠŠè¿™ä¸¤ä¸ªå‚æ•°è®¾ç½®æˆäº†â€œæ™ºèƒ½é»˜è®¤å€¼â€ã€‚</p>
<h5 data-id="heading-6">1). apiKey ä¸ºä»€ä¹ˆä¸ç”¨å†™ï¼Ÿ</h5>
<ul>
<li>
<p>ChatDeepSeek ç±»ç»§æ‰¿è‡ª LangChain çš„ OpenAI å…¼å®¹æ¨¡å‹åŸºç±»ã€‚</p>
</li>
<li>
<p>åœ¨æ„é€ å‡½æ•°ä¸­ï¼ŒapiKey å‚æ•°æ˜¯<strong>å¯é€‰çš„</strong>ï¼Œå¦‚æœä¸ä¼ ï¼Œå®ƒä¼šè‡ªåŠ¨ä»ç¯å¢ƒå˜é‡ process.env.DEEPSEEK_API_KEY ä¸­è¯»å–ã€‚</p>
</li>
<li>
<p>ä»£ç æœ€å‰é¢æœ‰<code> import "dotenv/config"</code>ï¼Œè¿™è¡Œä»£ç å·²ç»æŠŠ .env æ–‡ä»¶é‡Œçš„ DEEPSEEK_API_KEY=sk-... åŠ è½½è¿›äº† process.envã€‚</p>
</li>
<li>
<p>æ‰€ä»¥ LangChain ä¸€å®ä¾‹åŒ–æ¨¡å‹ï¼Œå°±è‡ªåŠ¨æ‹¿åˆ°äº†API Keyï¼Œå®Œå…¨ä¸éœ€è¦ä½ æ‰‹åŠ¨ä¼  { apiKey: process.env.DEEPSEEK_API_KEY }ã€‚</p>
</li>
</ul>
<p>è¿™æ˜¯ LangChain çš„æœ€ä½³å®è·µè®¾è®¡ï¼š<strong>é¼“åŠ±ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†å¯†é’¥</strong>ï¼Œæ—¢å®‰å…¨ï¼ˆä¸ç¡¬ç¼–ç ï¼‰ï¼Œåˆçµæ´»ï¼ˆä¸åŒç¯å¢ƒç”¨ä¸åŒé…ç½®ï¼‰ã€‚</p>
<p>å¦‚æœä½ æƒ³æ˜¾å¼ä¼ ï¼Œä¹Ÿå¯ä»¥ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> model = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatDeepSeek</span>({
  <span class="hljs-attr">apiKey</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">DEEPSEEK_API_KEY</span>,  <span class="hljs-comment">// æ˜¾å¼ä¼ ï¼Œç­‰ä»·äºä¸ä¼ </span>
});
</code></pre>
<p>ä½†ä¸ä¼ æ›´ç®€æ´ã€æ›´æ¨èã€‚</p>
<h5 data-id="heading-7">2). baseURL ä¸ºä»€ä¹ˆä¸ç”¨å†™ï¼Ÿ</h5>
<ul>
<li>
<p>DeepSeek çš„å®˜æ–¹ API æ˜¯å®Œå…¨<strong>å…¼å®¹ OpenAI API æ ¼å¼</strong>çš„ï¼Œåªä¸è¿‡ç«¯ç‚¹ä¸ä¸€æ ·ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.deepseek.com%25EF%25BC%2589%25E3%2580%2582" target="_blank" title="https://api.deepseek.com%EF%BC%89%E3%80%82" ref="nofollow noopener noreferrer">api.deepseek.comï¼‰ã€‚</a></p>
</li>
<li>
<p>LangChain çš„ ChatDeepSeek åœ¨å†…éƒ¨å·²ç»<strong>ç¡¬ç¼–ç äº†æ­£ç¡®çš„ baseURL</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.deepseek.com%25EF%25BC%2588%25E6%2588%2596" target="_blank" title="https://api.deepseek.com%EF%BC%88%E6%88%96" ref="nofollow noopener noreferrer">api.deepseek.comï¼ˆæˆ–</a> /v1 è·¯å¾„ï¼‰ã€‚</p>
</li>
<li>
<p>æ‰€ä»¥ä½ ä¸éœ€è¦åƒç›´æ¥ç”¨ OpenAI SDK é‚£æ ·æ‰‹åŠ¨è®¾ç½® baseURL: '<a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.deepseek.com'%25E3%2580%2582" target="_blank" title="https://api.deepseek.com'%E3%80%82" ref="nofollow noopener noreferrer">api.deepseek.com'ã€‚</a></p>
</li>
</ul>
<p>è¿™ä¹Ÿæ˜¯ LangChain â€œé€‚é…å™¨æ¨¡å¼â€çš„å¨åŠ›ï¼šå®ƒæŠŠä¸åŒå‚å•†çš„ç»†å¾®å·®å¼‚ï¼ˆæ¯”å¦‚ baseURLã€è®¤è¯æ–¹å¼ï¼‰å°è£…å¥½äº†ï¼Œä½ åªç®¡ç”¨ç»Ÿä¸€çš„æ¥å£ã€‚</p>
<p>å¦‚æœä½ ç”¨çš„æ˜¯å…¶ä»–ä»£ç†æˆ–è‡ªéƒ¨ç½²çš„ DeepSeek æ¨¡å‹ï¼Œæ‰éœ€è¦æ‰‹åŠ¨è¦†ç›–ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> model = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatDeepSeek</span>({
  <span class="hljs-attr">baseURL</span>: <span class="hljs-string">"http://localhost:11434/v1"</span>,  <span class="hljs-comment">// æ¯”å¦‚ Ollama æœ¬åœ°éƒ¨ç½²</span>
});
</code></pre>
<p>ä½†å®˜æ–¹äº‘ç«¯ API å®Œå…¨ä¸éœ€è¦ã€‚</p>
<h5 data-id="heading-8">æ€»ç»“å¯¹æ¯”è¡¨</h5>



































<table><thead><tr><th>å‚æ•°</th><th>æ˜¯å¦å¿…é¡»ä¼ ï¼Ÿ</th><th>é»˜è®¤è¡Œä¸º</th><th>ä»£ç ä¸­å®é™…æ¥æº</th></tr></thead><tbody><tr><td>apiKey</td><td>å¦ï¼ˆå¯é€‰ï¼‰</td><td>è‡ªåŠ¨è¯»å– process.env.DEEPSEEK_API_KEY</td><td>æ¥è‡ª .env + dotenv/config</td></tr><tr><td>baseURL</td><td>å¦ï¼ˆå¯é€‰ï¼‰</td><td>å†…ç½®é»˜è®¤ <a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.deepseek.com%25EF%25BC%2588%25E5%25AE%2598%25E6%2596%25B9%25E7%25AB%25AF%25E7%2582%25B9%25EF%25BC%2589" target="_blank" title="https://api.deepseek.com%EF%BC%88%E5%AE%98%E6%96%B9%E7%AB%AF%E7%82%B9%EF%BC%89" ref="nofollow noopener noreferrer">api.deepseek.comï¼ˆå®˜æ–¹ç«¯ç‚¹ï¼‰</a></td><td>LangChain åŒ…å†…éƒ¨ç¡¬ç¼–ç </td></tr><tr><td>model</td><td>æ˜¯</td><td>æ— é»˜è®¤ï¼Œå¿…é¡»æŒ‡å®šï¼ˆå¦‚ "deepseek-reasoner"ï¼‰</td><td>æ‰‹åŠ¨ä¼ çš„</td></tr><tr><td>temperature</td><td>å¦</td><td>é»˜è®¤ 1.0ï¼ˆéšæœºæ€§æ›´é«˜ï¼‰</td><td>æ‰‹åŠ¨è®¾ä¸º 0ï¼ˆç¡®å®šæ€§è¾“å‡ºï¼‰</td></tr></tbody></table>
<h5 data-id="heading-9">å°è´´å£«</h5>
<ul>
<li>
<p>è¿™ç§â€œé»˜è®¤è¯»å–ç¯å¢ƒå˜é‡ + å†…ç½® baseURLâ€çš„è®¾è®¡ï¼Œåœ¨ LangChain çš„å¾ˆå¤šé›†æˆåŒ…é‡Œéƒ½å¾ˆå¸¸è§ï¼ˆæ¯”å¦‚ OpenAI æ˜¯ OPENAI_API_KEYï¼ŒAnthropic æ˜¯ ANTHROPIC_API_KEYï¼‰ã€‚</p>
</li>
<li>
<p>å®ƒè®©ä½ æœ¬åœ°å¼€å‘æ—¶ç”¨ .env æ–¹ä¾¿ï¼Œéƒ¨ç½²åˆ° Vercel/Netlify/Cloudflare ç­‰å¹³å°æ—¶ï¼Œç›´æ¥åœ¨å¹³å°åå°è®¾ç½®ç¯å¢ƒå˜é‡å°±è¡Œï¼Œæ— éœ€æ”¹ä»£ç ã€‚</p>
</li>
</ul>
<h2 data-id="heading-10">äºŒã€Prompt æ¨¡æ¿ï¼šè®©æç¤ºè¯å¯å¤ç”¨ã€å¯é…ç½®</h2>
<p>å•çº¯è°ƒç”¨æ¨¡å‹å¾ˆå¿«ä¼šé‡åˆ°é—®é¢˜ï¼šæ¯æ¬¡éƒ½è¦æ‰‹å†™ä¸€é•¿ä¸² promptï¼Œè§’è‰²ã€å­—æ•°é™åˆ¶ã€é—®é¢˜éƒ½ç¡¬ç¼–ç æ­»äº†ï¼Œå¤ç”¨æ€§æå·®ã€‚</p>
<p>LangChain æä¾›äº† PromptTemplateï¼Œè®©æç¤ºè¯å˜æˆå¯å‚æ•°åŒ–çš„æ¨¡æ¿ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">PromptTemplate</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/core/prompts"</span>;

<span class="hljs-keyword">const</span> prompt = <span class="hljs-title class_">PromptTemplate</span>.<span class="hljs-title function_">fromTemplate</span>(<span class="hljs-string">`
  ä½ æ˜¯ä¸€ä¸ª{role},
  è¯·ç”¨ä¸è¶…è¿‡{limit}å­—å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š{question}
`</span>);

<span class="hljs-keyword">const</span> prompt1 = <span class="hljs-keyword">await</span> prompt.<span class="hljs-title function_">format</span>({
  <span class="hljs-attr">role</span>: <span class="hljs-string">"å‰ç«¯é¢è¯•å®˜"</span>,
  <span class="hljs-attr">limit</span>: <span class="hljs-string">"50"</span>,
  <span class="hljs-attr">question</span>: <span class="hljs-string">"ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ"</span>
});

<span class="hljs-keyword">const</span> prompt2 = <span class="hljs-keyword">await</span> prompt.<span class="hljs-title function_">format</span>({
  <span class="hljs-attr">role</span>: <span class="hljs-string">"åç«¯é¢è¯•å®˜"</span>,
  <span class="hljs-attr">limit</span>: <span class="hljs-string">"50"</span>,
  <span class="hljs-attr">question</span>: <span class="hljs-string">"ä»€ä¹ˆæ˜¯MVCæ¶æ„ï¼Ÿ"</span>
});
<span class="hljs-comment">// è°ƒç”¨</span>
<span class="hljs-keyword">const</span> model = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatDeepSeek</span>({
  <span class="hljs-attr">model</span>: <span class="hljs-string">"deepseek-reasoner"</span>, 
  <span class="hljs-attr">temperature</span>: <span class="hljs-number">0</span>,
});

<span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> model.<span class="hljs-title function_">invoke</span>(prompt2);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res.<span class="hljs-property">content</span>);
<span class="hljs-comment">//MVCæ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå°†åº”ç”¨åˆ†ä¸ºæ¨¡å‹ï¼ˆæ•°æ®ï¼‰ã€è§†å›¾ï¼ˆç•Œé¢ï¼‰å’Œæ§åˆ¶å™¨ï¼ˆé€»è¾‘ï¼‰ä¸‰å±‚ï¼Œä»¥å®ç°èŒè´£åˆ†ç¦»å’Œä»£ç æ˜“ç»´æŠ¤ã€‚</span>
</code></pre>
<p>è¿™æ ·åŒä¸€å¥—æ¨¡æ¿å¯ä»¥æœåŠ¡å¤šä¸ªåœºæ™¯ï¼Œå¤§å¤§æå‡äº†ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚</p>
<p><strong>é¢è¯•å¸¸è€ƒ</strong>ï¼š â€œå¦‚ä½•è®¾è®¡ä¸€ä¸ªç¨³å®šçš„ Promptï¼Ÿå¦‚ä½•åœ¨å›¢é˜Ÿä¸­å¤ç”¨ Promptï¼Ÿâ€ ç­”æ¡ˆï¼šä½¿ç”¨æ¨¡æ¿åŒ–ç®¡ç†ï¼Œå˜é‡åˆ†ç¦»ï¼Œè§’è‰²ã€é™åˆ¶æ¡ä»¶ã€è¾“å…¥å†…å®¹åˆ†å¼€é…ç½®ã€‚</p>
<h2 data-id="heading-11">ä¸‰ã€Chainï¼šæŠŠå¤šä¸ªæ­¥éª¤ä¸²èµ·æ¥</h2>
<p>çœŸå®ä¸šåŠ¡å¾ˆå°‘æ˜¯ä¸€é—®ä¸€ç­”å°±ç»“æŸçš„ã€‚æ›´å¸¸è§çš„éœ€æ±‚æ˜¯ï¼š</p>
<ol>
<li>å…ˆè¯¦ç»†è§£é‡Šä¸€ä¸ªæ¦‚å¿µ</li>
<li>å†æŠŠè§£é‡Šæç‚¼æˆå‡ ä¸ªå…³é”®ç‚¹</li>
<li>æœ€åç”Ÿæˆé¢è¯•é¢˜æˆ–ä»£ç ç¤ºä¾‹</li>
</ol>
<p>è¿™å°±æ˜¯ <strong>Chain</strong>ï¼ˆé“¾ï¼‰çš„ç”¨æ­¦ä¹‹åœ°ã€‚</p>
<h3 data-id="heading-12">1.LangChain ä¸­çš„ RunnableSequence å½»åº•è®²è§£</h3>
<p>åœ¨ LangChainï¼ˆå°¤å…¶æ˜¯ JS/TS ç‰ˆæœ¬ @langchain/coreï¼‰ä¸­ï¼Œ<strong>RunnableSequence</strong> æ˜¯æ„å»º Chainï¼ˆé“¾ï¼‰çš„æ ¸å¿ƒåŸºçŸ³ã€‚å®ƒæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªâ€œé¡ºåºæ‰§è¡Œçš„å·¥ä½œæµâ€ï¼šæŠŠå¤šä¸ªå¯è¿è¡Œçš„ç»„ä»¶ï¼ˆRunnableï¼‰æŒ‰é¡ºåºè¿æ¥èµ·æ¥ï¼Œ<strong>å‰ä¸€ä¸ªç»„ä»¶çš„è¾“å‡ºè‡ªåŠ¨ä½œä¸ºåä¸€ä¸ªç»„ä»¶çš„è¾“å…¥ã€‚</strong></p>
<p>ç®€å•æ¥è¯´ï¼š<strong>RunnableSequence å°±æ˜¯ LangChain é‡Œâ€œChainâ€çš„ç°ä»£å®ç°æ–¹å¼</strong>ã€‚å®ƒå–ä»£äº†æ—©æœŸç‰ˆæœ¬ä¸­ç¹ççš„ Chain ç±»ï¼Œè®©ä¸€åˆ‡å˜å¾—æ›´æ¨¡å—åŒ–ã€æ›´çµæ´»ã€æ›´æ˜“ç»„åˆã€‚</p>
<h4 data-id="heading-13">ä¸ºä»€ä¹ˆéœ€è¦ RunnableSequenceï¼Ÿ</h4>
<p>æ—©æœŸ LangChain çš„ Chain å†™æ³•å¾ˆæ­»æ¿ï¼šä½ è¦æ‰‹åŠ¨åˆ›å»ºå„ç§å…·ä½“çš„ Chain ç±»ï¼ˆå¦‚ LLMChainã€SequentialChainï¼‰ï¼Œä»£ç å†—é•¿ï¼Œæ‰©å±•æ€§å·®ã€‚</p>
<p>ç°åœ¨ LangChain å¼•å…¥äº† <strong>LCELï¼ˆLangChain Expression Languageï¼‰</strong> ï¼Œæ ¸å¿ƒå°±æ˜¯ <strong>Runnable æ¥å£</strong>ã€‚å‡ ä¹æ‰€æœ‰ç»„ä»¶ï¼ˆPromptTemplateã€ChatModelã€OutputParserã€è‡ªå®šä¹‰å‡½æ•°ç­‰ï¼‰éƒ½å®ç°äº† Runnable æ¥å£ï¼Œå…·å¤‡ç»Ÿä¸€çš„ .invoke()ã€.stream()ã€.batch() ç­‰æ–¹æ³•ã€‚</p>
<p>RunnableSequence çš„ä½œç”¨å°±æ˜¯ï¼š<strong>æŠŠè¿™äº› Runnable åƒç®¡é“ä¸€æ ·ä¸²èµ·æ¥ï¼Œå½¢æˆå¤æ‚çš„å·¥ä½œæµ</strong>ã€‚</p>
<h3 data-id="heading-14">2.ç®€å• Sequential Chain</h3>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">PromptTemplate</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/core/prompts"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">RunnableSequence</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/core/runnables"</span>;

<span class="hljs-keyword">const</span> prompt = <span class="hljs-title class_">PromptTemplate</span>.<span class="hljs-title function_">fromTemplate</span>(
  <span class="hljs-string">`ä½ æ˜¯ä¸€ä¸ªå‰ç«¯ä¸“å®¶ï¼Œç”¨ä¸€å¥è¯è§£é‡Šï¼š{topic}`</span>
);

<span class="hljs-keyword">const</span> chain = prompt.<span class="hljs-title function_">pipe</span>(model); <span class="hljs-comment">// ç”¨ pipe æŠŠ prompt å’Œ model è¿æ¥</span>

<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> chain.<span class="hljs-title function_">invoke</span>({ <span class="hljs-attr">topic</span>: <span class="hljs-string">"é—­åŒ…"</span> });
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">content</span>);
</code></pre>
<p>pipe æ˜¯ LangChain çš„æ ¸å¿ƒæ“ä½œç¬¦ï¼ŒæŠŠå¯è¿è¡Œçš„èŠ‚ç‚¹ï¼ˆRunnableï¼‰è¿æ¥æˆæµæ°´çº¿ã€‚</p>
<p>prompt.pipe(model) ç­‰ä»·äºï¼šå…ˆæ ¼å¼åŒ– promptï¼Œå†æŠŠç»“æœå–‚ç»™ modelã€‚</p>
<h3 data-id="heading-15">3.å¤šæ­¥ Chainï¼šè§£é‡Š + æ€»ç»“</h3>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> explainPrompt = <span class="hljs-title class_">PromptTemplate</span>.<span class="hljs-title function_">fromTemplate</span>(<span class="hljs-string">`
  ä½ æ˜¯ä¸€ä¸ªå‰ç«¯ä¸“å®¶ï¼Œè¯·è¯¦ç»†ä»‹ç»ä¸€ä¸‹æ¦‚å¿µï¼š{topic}
  è¦æ±‚ï¼šè¦†ç›–å®šä¹‰ã€åŸç†ã€ä½¿ç”¨æ–¹å¼ï¼Œä¸è¶…è¿‡300å­—
`</span>);

<span class="hljs-keyword">const</span> summaryPrompt = <span class="hljs-title class_">PromptTemplate</span>.<span class="hljs-title function_">fromTemplate</span>(<span class="hljs-string">`
  è¯·å°†ä»¥ä¸‹å‰ç«¯æ¦‚å¿µè§£é‡Šæ€»ç»“ä¸ºä¸‰ä¸ªæ ¸å¿ƒè¦ç‚¹ï¼ˆæ¯ç‚¹ä¸è¶…è¿‡20å­—ï¼‰ï¼š
  {explanation}
`</span>);

<span class="hljs-keyword">const</span> explainChain = explainPrompt.<span class="hljs-title function_">pipe</span>(model);
<span class="hljs-keyword">const</span> summaryChain = summaryPrompt.<span class="hljs-title function_">pipe</span>(model);

<span class="hljs-comment">// ç»„åˆæˆå®Œæ•´é“¾</span>
<span class="hljs-keyword">const</span> fullChain = <span class="hljs-title class_">RunnableSequence</span>.<span class="hljs-title function_">from</span>([
  <span class="hljs-keyword">async</span> ({ topic }) =&gt; {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> explainChain.<span class="hljs-title function_">invoke</span>({ topic });
    <span class="hljs-keyword">return</span> result.<span class="hljs-property">content</span>; <span class="hljs-comment">// æ³¨æ„æ˜¯ .content</span>
  },
  <span class="hljs-keyword">async</span> (explanation) =&gt; {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> summaryChain.<span class="hljs-title function_">invoke</span>({ explanation });
    <span class="hljs-keyword">return</span> <span class="hljs-string">`çŸ¥è¯†ç‚¹ï¼š<span class="hljs-subst">${explanation}</span>\n\næ€»ç»“ï¼š<span class="hljs-subst">${result.content}</span>`</span>;
  },
]);

<span class="hljs-comment">// è°ƒç”¨</span>
<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fullChain.<span class="hljs-title function_">invoke</span>({
  <span class="hljs-attr">topic</span>: <span class="hljs-string">"é—­åŒ…"</span>,
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response);
</code></pre>
<p>è¾“å‡ºç¤ºä¾‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b2b0a3a96ed4ae5968882936e8f50e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2X5bGx5a6J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767144139&amp;x-signature=9cUSiFl10q%2BP0IyOXG1J%2FvA%2FnGU%3D" alt="image.png" loading="lazy"/></p>
<h5 data-id="heading-16">LangChain JS çš„ RunnableSequence.from() çš„å·¥ä½œæœºåˆ¶æ˜¯ï¼š</h5>
<ul>
<li>æ¯ä¸ªå‡½æ•°çš„<strong>è¿”å›å€¼</strong>ä¼šç›´æ¥ä½œä¸º<strong>ä¸‹ä¸€ä¸ªå‡½æ•°çš„å‚æ•°</strong>ä¼ å…¥ã€‚</li>
<li>å‚æ•°åå°±æ˜¯ä½ å‡½æ•°å£°æ˜é‡Œçš„å‚æ•°åï¼ˆè¿™é‡Œæ˜¯ explanationï¼‰ã€‚</li>
<li>ç±»å‹å®Œå…¨åŒ¹é…ï¼šç¬¬ä¸€ä¸ª async å‡½æ•°è¿”å› stringï¼ˆå³ result.contentï¼‰ï¼Œç¬¬äºŒä¸ªå‡½æ•°çš„å½¢å‚ explanation å°±ä¼šæ”¶åˆ°è¿™ä¸ªå­—ç¬¦ä¸²ã€‚</li>
</ul>
<p>è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ï¼š<strong>æ„å»ºä¸€ä¸ªä¸¤æ­¥é¡ºåºæ‰§è¡Œçš„ AI å·¥ä½œæµ</strong>ï¼š</p>
<ol>
<li>å…ˆç”¨ explainChainï¼ˆPrompt + Modelï¼‰ç”Ÿæˆä¸€ä¸ªæ¦‚å¿µçš„è¯¦ç»†è§£é‡Š</li>
<li>å†æŠŠè¿™ä¸ªè§£é‡Šå–‚ç»™ summaryChainï¼ˆå¦ä¸€ä¸ª Prompt + Modelï¼‰ï¼Œç”Ÿæˆä¸‰ç‚¹æ€»ç»“</li>
<li>æœ€åæŠŠâ€œè¯¦ç»†è§£é‡Šâ€å’Œâ€œä¸‰ç‚¹æ€»ç»“â€æ‹¼æ¥æˆæœ€ç»ˆè¾“å‡º</li>
</ol>
<p>æ•´ä¸ªè¿‡ç¨‹åªéœ€è¦ä¸€è¡Œè°ƒç”¨ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">await</span> fullChain.<span class="hljs-title function_">invoke</span>({ <span class="hljs-attr">topic</span>: <span class="hljs-string">"é—­åŒ…"</span> });
</code></pre>
<p>å°±èƒ½å¾—åˆ°ç»“æ„åŒ–çš„å®Œæ•´ç»“æœã€‚</p>
<h4 data-id="heading-17">é€è¡Œæ‹†è§£</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> fullChain = <span class="hljs-title class_">RunnableSequence</span>.<span class="hljs-title function_">from</span>([
</code></pre>
<ul>
<li>
<p>const fullChainï¼šå£°æ˜ä¸€ä¸ªå¸¸é‡å˜é‡ï¼Œç”¨äºå­˜æ”¾æˆ‘ä»¬æ„å»ºçš„å®Œæ•´å¤„ç†é“¾ã€‚</p>
</li>
<li>
<p>RunnableSequence.from([ ... ])ï¼šè¿™æ˜¯ LangChain JS ä¸­åˆ›å»ºåºåˆ—é“¾ï¼ˆSequence Chainï¼‰çš„æ ‡å‡†æ–¹å¼ã€‚</p>
<ul>
<li>å®ƒæ¥å—ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„é‡Œçš„æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ª <strong>Runnable</strong>ï¼ˆå¯è¿è¡Œçš„å¯¹è±¡ï¼‰ã€‚</li>
<li>è¿™é‡Œæˆ‘ä»¬ä¼ å…¥çš„æ˜¯ä¸¤ä¸ª <strong>async å‡½æ•°</strong>ï¼ŒLangChain ä¼šè‡ªåŠ¨å°†å®ƒä»¬åŒ…è£…æˆ Runnableã€‚</li>
<li>æ•´ä¸ªåºåˆ—çš„æ‰§è¡Œé¡ºåºï¼šä»æ•°ç»„ç¬¬0ä¸ªå…ƒç´ å¼€å§‹ï¼Œä¾æ¬¡æ‰§è¡Œï¼Œæ¯ä¸ªæ­¥éª¤çš„è¾“å‡ºè‡ªåŠ¨ä½œä¸ºä¸‹ä¸€ä¸ªæ­¥éª¤çš„è¾“å…¥ã€‚</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">async</span> ({ topic }) =&gt; {
</code></pre>
<ul>
<li>å®šä¹‰åºåˆ—çš„<strong>ç¬¬ä¸€ä¸ªæ­¥éª¤</strong>ï¼šä¸€ä¸ªå¼‚æ­¥å‡½æ•°ã€‚</li>
<li>å‚æ•°ä½¿ç”¨è§£æ„å½¢å¼ { topic }ï¼Œè¡¨ç¤ºè¿™ä¸ªæ­¥éª¤æ¥æ”¶çš„è¾“å…¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¿…é¡»åŒ…å« topic å±æ€§ï¼ˆä¾‹å¦‚ { topic: "é—­åŒ…" }ï¼‰ã€‚</li>
<li>è¿™æ˜¯æ•´ä¸ªé“¾çš„å…¥å£è¾“å…¥æ ¼å¼å†³å®šçš„â€”â€”å› ä¸ºæœ€åè°ƒç”¨ fullChain.invoke({ topic: "é—­åŒ…" })ã€‚</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> explainChain.<span class="hljs-title function_">invoke</span>({ topic });
</code></pre>
<ul>
<li>è°ƒç”¨å‰é¢å®šä¹‰å¥½çš„ explainChainï¼ˆå³ explainPrompt + model çš„é“¾ï¼‰ã€‚</li>
<li>ä¼ å…¥ { topic }ï¼Œä¼šè‡ªåŠ¨æ›¿æ¢æç¤ºæ¨¡æ¿ä¸­çš„ {topic} å ä½ç¬¦ã€‚</li>
<li>invoke() è¿”å›ä¸€ä¸ª Promiseï¼Œé‡Œé¢æ˜¯æ¨¡å‹çš„è¾“å‡ºï¼šä¸€ä¸ª AIMessage å¯¹è±¡ã€‚</li>
<li>ä½¿ç”¨ await ç­‰å¾…æ¨¡å‹çœŸæ­£è¿”å›ç»“æœã€‚</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">return</span> result.<span class="hljs-property">content</span>; <span class="hljs-comment">// æ³¨æ„æ˜¯ .content</span>
</code></pre>
<ul>
<li>
<p>ä» AIMessage å¯¹è±¡ä¸­æå–å®é™…çš„æ–‡æœ¬å†…å®¹ã€‚</p>
</li>
<li>
<p>åœ¨ LangChain JS ç‰ˆæœ¬ä¸­ï¼Œæ¨¡å‹è¿”å›çš„æ¶ˆæ¯å†…å®¹å­˜å‚¨åœ¨ .content å±æ€§ï¼ˆå­—ç¬¦ä¸²ç±»å‹ï¼‰ï¼Œ<strong>ä¸æ˜¯ .text</strong>ã€‚</p>
</li>
<li>
<p>return è¿™ä¸ªçº¯å­—ç¬¦ä¸²ï¼ˆè¯¦ç»†è§£é‡Šæ–‡æœ¬ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å…³é”®ç‚¹</strong>ï¼šè¿™ä¸ªè¿”å›å€¼ä¼š<strong>ç›´æ¥ã€å®Œæ•´ã€æ— åŒ…è£…åœ°</strong>ä½œä¸ºä¸‹ä¸€ä¸ªæ­¥éª¤å‡½æ•°çš„å‚æ•°ä¼ å…¥ã€‚</p>
</li>
<li>
<p>ç»“æŸç¬¬ä¸€ä¸ªæ­¥éª¤çš„å‡½æ•°å®šä¹‰ï¼Œå¹¶ä»¥é€—å·åˆ†éš”ï¼Œè¿›å…¥æ•°ç»„ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚</p>
</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">async</span> (explanation) =&gt; {
</code></pre>
<ul>
<li>å®šä¹‰åºåˆ—çš„<strong>ç¬¬äºŒä¸ªæ­¥éª¤</strong>ï¼šå¦ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ã€‚</li>
<li>å‚æ•°ç›´æ¥å†™æˆ explanationï¼ˆå•ä¸ªå­—ç¬¦ä¸²ï¼‰ï¼Œå› ä¸ºä¸Šä¸€æ­¥è¿”å›çš„å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</li>
<li>LangChain ä¼šè‡ªåŠ¨æŠŠä¸Šä¸€æ­¥çš„è¿”å›å€¼ä½œä¸ºè¿™ä¸ªå‚æ•°ä¼ è¿›æ¥ã€‚</li>
<li>å‚æ•°å explanation æ˜¯æˆ‘ä»¬è‡ªå·±èµ·çš„ï¼Œä¾¿äºä»£ç é˜…è¯»ï¼Œè¡¨ç¤ºâ€œè¯¦ç»†è§£é‡Šæ–‡æœ¬â€ã€‚</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> summaryChain.<span class="hljs-title function_">invoke</span>({ explanation });
</code></pre>
<ul>
<li>è°ƒç”¨ summaryChainï¼ˆsummaryPrompt + model çš„é“¾ï¼‰ã€‚</li>
<li>ä¼ å…¥ { explanation }ï¼Œä¼šæŠŠä¸Šä¸€æ­¥å¾—åˆ°çš„è¯¦ç»†è§£é‡Šæ–‡æœ¬å¡«å……åˆ°æ€»ç»“æç¤ºçš„ {explanation} å ä½ç¬¦ä¸­ã€‚</li>
<li>å†æ¬¡ç­‰å¾…æ¨¡å‹ç”Ÿæˆä¸‰ç‚¹æ€»ç»“ï¼Œè¿”å›å¦ä¸€ä¸ª AIMessage å¯¹è±¡ã€‚</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">return</span> <span class="hljs-string">`çŸ¥è¯†ç‚¹ï¼š<span class="hljs-subst">${explanation}</span>\n\næ€»ç»“ï¼š<span class="hljs-subst">${result.content}</span>`</span>;
</code></pre>
<ul>
<li>
<p>æ„å»ºæœ€ç»ˆè¾“å‡ºå­—ç¬¦ä¸²ï¼š</p>
<ul>
<li>å…ˆè¾“å‡ºâ€œçŸ¥è¯†ç‚¹ï¼šâ€ + åŸå§‹çš„è¯¦ç»†è§£é‡Šï¼ˆexplanationï¼‰</li>
<li>æ¢ä¸¤è¡Œ</li>
<li>å†è¾“å‡ºâ€œæ€»ç»“ï¼šâ€ + æ¨¡å‹ç”Ÿæˆçš„ä¸‰ä¸ªæ ¸å¿ƒè¦ç‚¹ï¼ˆresult.contentï¼‰</li>
</ul>
</li>
<li>
<p>è¿™ä¸ªè¿”å›å€¼å°±æ˜¯æ•´ä¸ª fullChain.invoke() çš„æœ€ç»ˆç»“æœï¼ˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼‰ã€‚</p>
</li>
<li>
<p>è‡³æ­¤ï¼ŒfullChain å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„ã€å¯å¤ç”¨çš„ Runnable å¯¹è±¡ï¼Œå¯ä»¥å¤šæ¬¡è°ƒç”¨ã€‚</p>
</li>
</ul>
<p><strong>é¢è¯•å¸¸è€ƒ</strong>ï¼š â€œå¦‚ä½•é¿å… Prompt è¿‡é•¿å¯¼è‡´æˆæœ¬é«˜ã€æ•ˆæœå·®ï¼Ÿâ€ ç­”æ¡ˆï¼šæ‹†åˆ†ä»»åŠ¡ä¸ºå¤šæ­¥ Chainï¼Œå…ˆè®©æ¨¡å‹ä¸“æ³¨åšä¸€ä»¶äº‹ï¼Œå†åŸºäºç»“æœåšä¸‹ä¸€æ­¥ï¼Œæ•´ä½“æ•ˆæœæ›´å¥½ä¸”æ›´å¯æ§ã€‚</p>
<h2 data-id="heading-18">å››ã€ä¸ºä»€ä¹ˆé€‰æ‹© LangChainï¼Ÿ</h2>
<ol>
<li>
<p><strong>æ¢æ¨¡å‹è·Ÿæ¢å¤´åƒä¸€æ ·ç®€å•</strong></p>
<p>ç°å®ä¸­ï¼Œæ¨¡å‹è¯´æ¢å°±æ¢ï¼šä»Šå¤© DeepSeek ä¾¿å®œï¼Œæ˜å¤© Claude æ•ˆæœå¥½ï¼Œåå¤©é¢†å¯¼è¯´ç”¨ Grok 4ã€‚ ç”¨åŸç”Ÿ SDK æ¯æ¬¡æ¢éƒ½è¦æ”¹ä¸€å †ä»£ç ï¼ŒLangChain ç›´æ¥æ¢ä¸€è¡Œ import + ç¯å¢ƒå˜é‡ï¼Œå®Œäº‹ã€‚ è¿™ç‚¹åœ¨å›½å†…å°¤å…¶é¦™â€”â€”å›½äº§æ¨¡å‹å±‚å‡ºä¸ç©·ï¼Œæ¥å£è¿˜ä¸ç»Ÿä¸€ï¼ŒLangChain åŸºæœ¬éƒ½ç»™ä½ é€‚é…å¥½äº†ã€‚</p>
</li>
<li>
<p><strong>ä¸šåŠ¡åœºæ™¯åŸºæœ¬éƒ½ä¸æ˜¯â€œä¸€é—®ä¸€ç­”â€</strong> ä½ çœŸæ­£è¦åšçš„ä¸œè¥¿å¤§æ¦‚ç‡æ˜¯ï¼š</p>
<ul>
<li>ç”¨æˆ·é—®é—®é¢˜ â†’ å…ˆæœçŸ¥è¯†åº“ â†’ å†ç”Ÿæˆç­”æ¡ˆï¼ˆRAGï¼‰</li>
<li>å…ˆè§£é‡Šæ¦‚å¿µ â†’ å†å‡ºæ€»ç»“ â†’ å†ç”Ÿæˆé¢è¯•é¢˜</li>
<li>å…ˆåˆ¤æ–­æ„å›¾ â†’ è°ƒç”¨å·¥å…· â†’ å†å›å¤ï¼ˆAgentï¼‰ LangChain çš„ Chain / RunnableSequence å¤©ç”Ÿå°±ä¸ºè¿™ç§â€œå¤šæ­¥æµç¨‹â€è€Œç”Ÿï¼Œå‡ è¡Œä»£ç å°±èƒ½æ­å¥½æ•´ä¸ªæµæ°´çº¿ï¼Œå…¶ä»–æ¡†æ¶è¦ä¹ˆæ²¡è¿™æ¦‚å¿µï¼Œè¦ä¹ˆè‡ªå·±æ‰‹æ’¸çŠ¶æ€æœºï¼Œç´¯å¾—è¦æ­»ã€‚</li>
</ul>
</li>
<li>
<p><strong>å·¥ç¨‹åŒ–åšå¾—æœ€åˆ°ä½</strong></p>
<ul>
<li>Prompt å¯ä»¥æ¨¡æ¿åŒ–ç®¡ç†ï¼Œä¸ä¼šæ»¡æ–‡ä»¶éƒ½æ˜¯ç¡¬ç¼–ç é•¿å­—ç¬¦ä¸²</li>
<li>å¯¹è¯å†å²ï¼ˆMemoryï¼‰ç°æˆç”¨ï¼Œä¸ç”¨è‡ªå·±æ‹¼ messages æ•°ç»„</li>
<li>æµå¼è¾“å‡ºã€è¶…æ—¶é‡è¯•ã€æ—¥å¿—è¿½è¸ªè¿™äº›ç”Ÿäº§å¿…å¤‡éƒ½å†…ç½®</li>
<li>è¿˜æœ‰ LangSmith èƒ½å¯è§†åŒ–æ¯ä¸€æ­¥çš„è¾“å…¥è¾“å‡ºã€token æ¶ˆè€—ï¼Œè°ƒè¯•ç¥å™¨</li>
</ul>
</li>
<li>
<p><strong>ç”Ÿæ€æœ€ç‹ </strong> æƒ³è¦ä»€ä¹ˆåŸºæœ¬éƒ½æœ‰ï¼š100+ æ¨¡å‹ã€50+ å‘é‡åº“ã€å„ç§æ–‡æ¡£åŠ è½½å™¨ã€å·¥å…·è°ƒç”¨ã€Agent æ¡†æ¶â€¦â€¦ åŸºæœ¬ä¸éœ€è¦ä½ è‡ªå·±ä»é›¶é€ è½®å­ï¼Œè¸©å‘æ¦‚ç‡ä½å¤ªå¤šã€‚</p>
</li>
<li>
<p><strong>ç¤¾åŒºå’Œèµ„æ–™æœ€ä¸°å¯Œ</strong> å›½å†…å¤–ç”¨çš„äººæœ€å¤šï¼ŒGitHub å¿« 10 ä¸‡æ˜Ÿäº†ï¼Œé‡åˆ°é—®é¢˜ Google/Baidu ä¸€æœä¸€å¤§å †è§£å†³æ–¹æ¡ˆï¼Œä¸­æ–‡æ•™ç¨‹ä¹Ÿå¤šåˆ°çˆ†ç‚¸ã€‚</p>
</li>
</ol>
<p>ç¼ºç‚¹å½“ç„¶ä¹Ÿæœ‰ï¼šæ¦‚å¿µæœ‰ç‚¹å¤šï¼Œå…¥é—¨æ—¶ä¼šè§‰å¾—â€œå“‡æ€ä¹ˆè¿™ä¹ˆå¤šç±»â€ï¼ŒåŒ…æ›¾ç»æ¯”è¾ƒå¤§ï¼ˆç°åœ¨æ‹†åˆ†å¥½å¤šäº†ï¼‰ã€‚ ä½†ä¸€æ—¦ä¸Šæ‰‹ï¼Œä½ å°±ä¼šå‘ç°ï¼š<strong>å®ƒæŠŠä½ ä»â€œæ€ä¹ˆè°ƒ APIâ€çš„çäº‹é‡Œè§£æ”¾å‡ºæ¥ï¼Œè®©ä½ çœŸæ­£å»æ€è€ƒâ€œè¿™ä¸ª AI åŠŸèƒ½è¯¥æ€ä¹ˆè®¾è®¡æ‰åˆç†â€ã€‚</strong></p>
<p>ä¸€å¥è¯æ€»ç»“ï¼š <strong>å¦‚æœä½ åªæ˜¯ç©ç© demoï¼Œç”¨åŸç”Ÿ SDK å°±è¡Œï¼›ä½†ä¸€æ—¦è¦åšçœŸå®ä¸Šçº¿ã€èƒ½è¿­ä»£ã€èƒ½ç»´æŠ¤çš„ AI åŠŸèƒ½ï¼ŒLangChain ç›®å‰è¿˜æ˜¯æœ€çœå¿ƒã€æœ€å…¨é¢çš„é€‰æ‹©ã€‚</strong></p>
<h2 data-id="heading-19">äº”ã€å†™åœ¨æœ€å</h2>
<p>LangChain ä¸æ˜¯ä¸€ä¸ªâ€œé»‘ç›’é­”æ³•â€ï¼Œè€Œæ˜¯æŠŠå¤§è¯­è¨€æ¨¡å‹ä»â€œç©å…·â€å˜æˆâ€œç”Ÿäº§å·¥å…·â€çš„å…³é”®ä¸€å±‚æŠ½è±¡ã€‚</p>
<p>å®ƒè®©ä½ å…³æ³¨çš„é‡ç‚¹ä»â€œæ€ä¹ˆè°ƒç”¨ APIâ€å˜æˆâ€œæ€ä¹ˆè®¾è®¡åˆç†çš„ AI å·¥ä½œæµâ€ï¼Œè¿™æ‰æ˜¯æ„å»ºå¯é  AI åº”ç”¨çš„æ­£ç¡®å§¿åŠ¿ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2-2-6 å¿«é€ŸæŒæ¡Kotlin-è¯­è¨€çš„å¤šæ³›å‹å‚æ•°å­¦ä¹ ]]></title>    <link>https://juejin.cn/post/7586969583782887430</link>    <guid>https://juejin.cn/post/7586969583782887430</guid>    <pubDate>2025-12-24T02:06:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586969583782887430" data-draft-id="7586969583782805510" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2-2-6 å¿«é€ŸæŒæ¡Kotlin-è¯­è¨€çš„å¤šæ³›å‹å‚æ•°å­¦ä¹ "/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-12-24T02:06:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å®‰å“è€ç‹"/> <meta itemprop="url" content="https://juejin.cn/user/289926799429805"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2-2-6 å¿«é€ŸæŒæ¡Kotlin-è¯­è¨€çš„å¤šæ³›å‹å‚æ•°å­¦ä¹ 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/289926799429805/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å®‰å“è€ç‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T02:06:41.000Z" title="Wed Dec 24 2025 02:06:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸŒŸ Kotlinå¤šæ³›å‹å‚æ•°ï¼šè®©ä»£ç æ›´çµæ´»ã€æ›´å¼ºå¤§ï¼</h2>
<p>å˜¿ï¼çœ‹åˆ°ä½ å¯¹Kotlinå¤šæ³›å‹å‚æ•°æ„Ÿå…´è¶£ï¼Œå¤ªæ£’äº†ï¼è¿™å¯æ˜¯Kotlinçš„é«˜é˜¶æŠ€å·§ï¼Œèƒ½è®©ä½ çš„ä»£ç æ—¢ä¼˜é›…åˆå®‰å…¨ï¼Œå†ä¹Ÿä¸ç”¨ä¸ºæ¯ç§ç±»å‹å†™é‡å¤ä»£ç å•¦ï½ ğŸ˜„</p>
<h3 data-id="heading-1">ğŸ§ª ä»€ä¹ˆæ˜¯å¤šæ³›å‹å‚æ•°ï¼Ÿ</h3>
<p>å¤šæ³›å‹å‚æ•°å°±æ˜¯<strong>åœ¨ä¸€ä¸ªç±»ã€æ¥å£æˆ–å‡½æ•°ä¸­åŒæ—¶ä½¿ç”¨å¤šä¸ªç±»å‹å‚æ•°</strong>ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ª"ä¸‡èƒ½ç›’å­"ï¼Œä¸ä»…èƒ½è£…è‹¹æœï¼Œè¿˜èƒ½è£…é¦™è•‰ï¼Œç”šè‡³èƒ½è£…æ‰‹æœºï¼å¤šæ³›å‹å‚æ•°å°±æ˜¯è®©ä½ çš„ä»£ç èƒ½åŒæ—¶å¤„ç†å¤šç§ä¸åŒç±»å‹çš„æ•°æ®ã€‚</p>
<h3 data-id="heading-2">ğŸ“ åŸºæœ¬è¯­æ³•</h3>
<p>åœ¨Kotlinä¸­ï¼Œå¤šæ³›å‹å‚æ•°çš„å®šä¹‰éå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨ç±»/æ¥å£/å‡½æ•°åå‰ç”¨é€—å·åˆ†éš”å¤šä¸ªç±»å‹å‚æ•°ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å¤šæ³›å‹å‚æ•°ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Box</span>&lt;<span class="hljs-type">T, U</span>&gt;(<span class="hljs-keyword">val</span> item1: T, <span class="hljs-keyword">val</span> item2: U)

<span class="hljs-comment">// å¤šæ³›å‹å‚æ•°å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T, U&gt;</span> <span class="hljs-title">combine</span><span class="hljs-params">(item1: <span class="hljs-type">T</span>, item2: <span class="hljs-type">U</span>)</span></span>: Pair&lt;T, U&gt; {
    <span class="hljs-keyword">return</span> Pair(item1, item2)
}
</code></pre>
<h3 data-id="heading-3">ğŸ¯ å®é™…ç¤ºä¾‹</h3>
<h4 data-id="heading-4">1. ç®€å•çš„å¤šæ³›å‹ç±»</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Pair</span>&lt;<span class="hljs-type">T, U</span>&gt;(<span class="hljs-keyword">val</span> first: T, <span class="hljs-keyword">val</span> second: U) {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">swap</span><span class="hljs-params">()</span></span>: Pair&lt;U, T&gt; = Pair(second, first)
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">toString</span><span class="hljs-params">()</span></span>: String = <span class="hljs-string">"(<span class="hljs-variable">$first</span>, <span class="hljs-variable">$second</span>)"</span>
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// å¤šç§ç±»å‹ç»„åˆ</span>
    <span class="hljs-keyword">val</span> stringIntPair = Pair(<span class="hljs-string">"Hello"</span>, <span class="hljs-number">42</span>)
    <span class="hljs-keyword">val</span> boolStringPair = Pair(<span class="hljs-literal">true</span>, <span class="hljs-string">"Kotlin"</span>)
    
    println(stringIntPair) <span class="hljs-comment">// (Hello, 42)</span>
    println(stringIntPair.swap()) <span class="hljs-comment">// (42, Hello)</span>
    println(boolStringPair) <span class="hljs-comment">// (true, Kotlin)</span>
}
</code></pre>
<h4 data-id="heading-5">2. å¤šæ³›å‹å‚æ•°çš„ç±»å‹çº¦æŸ</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Tå¿…é¡»å®ç°Comparableï¼ŒUå¿…é¡»æ˜¯Anyï¼ˆéç©ºç±»å‹ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">BoxWithConstraint</span>&lt;<span class="hljs-type">T : Comparable&lt;T</span>&gt;, <span class="hljs-type">U</span> : <span class="hljs-type">Any&gt;</span>(<span class="hljs-keyword">val</span> value1: T, <span class="hljs-keyword">val</span> value2: U) {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">compare</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> = value1 &gt; value2 <span class="hljs-keyword">as</span> T <span class="hljs-comment">// æ³¨æ„ï¼šè¿™é‡Œéœ€è¦ç±»å‹è½¬æ¢</span>
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// æœ‰æ•ˆä½¿ç”¨</span>
    <span class="hljs-keyword">val</span> box1 = BoxWithConstraint(<span class="hljs-number">10</span>, <span class="hljs-string">"Number"</span>) <span class="hljs-comment">// T=Int, U=String</span>
    
    <span class="hljs-comment">// æ— æ•ˆä½¿ç”¨ï¼šStringä¸èƒ½å®ç°Comparable&lt;String&gt;</span>
    <span class="hljs-comment">// val box2 = BoxWithConstraint("Hello", "World") // ç¼–è¯‘é”™è¯¯</span>
    
    <span class="hljs-comment">// æœ‰æ•ˆä½¿ç”¨ï¼šStringå¯ä»¥å®ç°Comparable&lt;String&gt;</span>
    <span class="hljs-keyword">val</span> box3 = BoxWithConstraint(<span class="hljs-string">"Apple"</span>, <span class="hljs-string">"Banana"</span>) <span class="hljs-comment">// T=String, U=String</span>
    println(box3.compare()) <span class="hljs-comment">// false</span>
}
</code></pre>
<h4 data-id="heading-6">3. å¤šæ³›å‹å‚æ•°å‡½æ•°</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å¤šæ³›å‹å‚æ•°å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T, U&gt;</span> <span class="hljs-title">createTuple</span><span class="hljs-params">(item1: <span class="hljs-type">T</span>, item2: <span class="hljs-type">U</span>)</span></span>: Pair&lt;T, U&gt; {
    <span class="hljs-keyword">return</span> Pair(item1, item2)
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T, U&gt;</span> <span class="hljs-title">compareItems</span><span class="hljs-params">(item1: <span class="hljs-type">T</span>, item2: <span class="hljs-type">U</span>)</span></span>: <span class="hljs-built_in">Boolean</span> <span class="hljs-keyword">where</span> T : Comparable&lt;T&gt;, U : Comparable&lt;U&gt; {
    <span class="hljs-keyword">return</span> item1 &gt; item2
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// ç±»å‹æ¨æ–­</span>
    <span class="hljs-keyword">val</span> tuple1 = createTuple(<span class="hljs-number">10</span>, <span class="hljs-string">"Hello"</span>) <span class="hljs-comment">// (10, Hello)</span>
    <span class="hljs-keyword">val</span> tuple2 = createTuple(<span class="hljs-literal">true</span>, <span class="hljs-number">3.14</span>) <span class="hljs-comment">// (true, 3.14)</span>
    
    <span class="hljs-comment">// ä½¿ç”¨ç±»å‹çº¦æŸ</span>
    <span class="hljs-keyword">val</span> result1 = compareItems(<span class="hljs-number">10</span>, <span class="hljs-number">5</span>) <span class="hljs-comment">// true</span>
    <span class="hljs-keyword">val</span> result2 = compareItems(<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>) <span class="hljs-comment">// false</span>
}
</code></pre>
<h3 data-id="heading-7">ğŸ”’ å¤šæ³›å‹å‚æ•°çš„ç±»å‹çº¦æŸ</h3>
<p>åœ¨å¤šæ³›å‹å‚æ•°ä¸­ï¼Œæ¯ä¸ªç±»å‹å‚æ•°éƒ½å¯ä»¥æœ‰è‡ªå·±çš„ä¸Šç•Œçº¦æŸï¼Œä½¿ç”¨<code>where</code>å…³é”®å­—ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T, U&gt;</span> <span class="hljs-title">combineAndProcess</span><span class="hljs-params">(
    item1: <span class="hljs-type">T</span>, 
    item2: <span class="hljs-type">U</span>,
    processor: (<span class="hljs-type">T</span>, <span class="hljs-type">U</span>) -&gt; <span class="hljs-type">String</span>
)</span></span>: String <span class="hljs-keyword">where</span> T : Comparable&lt;T&gt;, U : CharSequence {
    <span class="hljs-keyword">return</span> processor(item1, item2)
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// åªèƒ½å¤„ç†Comparableå’ŒCharSequenceç±»å‹</span>
    <span class="hljs-keyword">val</span> result = combineAndProcess(
        <span class="hljs-number">42</span>, 
        <span class="hljs-string">"Hello"</span>, 
        { t, u -&gt; <span class="hljs-string">"Number: <span class="hljs-variable">$t</span>, String: <span class="hljs-variable">$u</span>"</span> }
    )
    println(result) <span class="hljs-comment">// Number: 42, String: Hello</span>
}
</code></pre>
<h3 data-id="heading-8">ğŸ’¡ ä¸ºä»€ä¹ˆéœ€è¦å¤šæ³›å‹å‚æ•°ï¼Ÿ</h3>
<ol>
<li><strong>æ›´ç²¾ç¡®çš„ç±»å‹æ§åˆ¶</strong>ï¼šå¯ä»¥ä¸ºä¸åŒç±»å‹çš„å‚æ•°è®¾ç½®ä¸åŒçš„çº¦æŸ</li>
<li><strong>å¢å¼ºä»£ç å¤ç”¨æ€§</strong>ï¼šä¸€ä¸ªç±»/å‡½æ•°å¯ä»¥å¤„ç†å¤šç§ä¸åŒç±»å‹ç»„åˆ</li>
<li><strong>æé«˜ç±»å‹å®‰å…¨æ€§</strong>ï¼šç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶å°±èƒ½æ£€æŸ¥ç±»å‹æ˜¯å¦åŒ¹é…</li>
<li><strong>ä»£ç æ›´æ¸…æ™°</strong>ï¼šæ˜ç¡®è¡¨ç¤ºå‡½æ•°/ç±»èƒ½å¤„ç†å“ªäº›ç±»å‹çš„ç»„åˆ</li>
</ol>
<h3 data-id="heading-9">ğŸŒˆ å®é™…åº”ç”¨åœºæ™¯</h3>
<h4 data-id="heading-10">1. æ•°æ®ä»“åº“</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DataStore</span>&lt;<span class="hljs-type">K, V</span>&gt; {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> <span class="hljs-keyword">data</span> = mutableMapOf&lt;K, V&gt;()
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">set</span><span class="hljs-params">(key: <span class="hljs-type">K</span>, value: <span class="hljs-type">V</span>)</span></span> {
        <span class="hljs-keyword">data</span>[key] = value
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">get</span><span class="hljs-params">(key: <span class="hljs-type">K</span>)</span></span>: V? {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">data</span>[key]
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// å­—ç¬¦ä¸²ä½œä¸ºé”®ï¼Œæ•´æ•°ä½œä¸ºå€¼</span>
    <span class="hljs-keyword">val</span> stringIntStore = DataStore&lt;String, <span class="hljs-built_in">Int</span>&gt;()
    stringIntStore.<span class="hljs-keyword">set</span>(<span class="hljs-string">"one"</span>, <span class="hljs-number">1</span>)
    stringIntStore.<span class="hljs-keyword">set</span>(<span class="hljs-string">"two"</span>, <span class="hljs-number">2</span>)
    
    <span class="hljs-comment">// å­—ç¬¦ä¸²ä½œä¸ºé”®ï¼Œå­—ç¬¦ä¸²ä½œä¸ºå€¼</span>
    <span class="hljs-keyword">val</span> stringStringStore = DataStore&lt;String, String&gt;()
    stringStringStore.<span class="hljs-keyword">set</span>(<span class="hljs-string">"name"</span>, <span class="hljs-string">"Alice"</span>)
    stringStringStore.<span class="hljs-keyword">set</span>(<span class="hljs-string">"age"</span>, <span class="hljs-string">"30"</span>)
}
</code></pre>
<h4 data-id="heading-11">2. é€šç”¨æ¯”è¾ƒå™¨</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Comparator</span>&lt;<span class="hljs-type">T, U</span>&gt; <span class="hljs-title">where</span> <span class="hljs-title">T</span> : <span class="hljs-type">Comparable</span>&lt;<span class="hljs-type">T</span>&gt;, <span class="hljs-type">U</span> : <span class="hljs-type">Comparable</span>&lt;<span class="hljs-type">U</span>&gt; {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">compare</span><span class="hljs-params">(a: <span class="hljs-type">T</span>, b: <span class="hljs-type">U</span>)</span></span>: <span class="hljs-built_in">Int</span> {
        <span class="hljs-keyword">return</span> a.compareTo(b)
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> comparator = Comparator&lt;<span class="hljs-built_in">Int</span>, String&gt;()
    <span class="hljs-comment">// æ³¨æ„ï¼šIntå’ŒStringä¸èƒ½ç›´æ¥æ¯”è¾ƒï¼Œä½†è¿™é‡Œåªæ˜¯ç¤ºä¾‹</span>
    <span class="hljs-comment">// å®é™…ä½¿ç”¨ä¸­ï¼Œéœ€è¦ç¡®ä¿ç±»å‹å…¼å®¹</span>
}
</code></pre>
<h3 data-id="heading-12">ğŸ“Œ å¤šæ³›å‹å‚æ•° vs å•æ³›å‹å‚æ•°</h3>



































<table><thead><tr><th>ç‰¹æ€§</th><th>å•æ³›å‹å‚æ•°</th><th>å¤šæ³›å‹å‚æ•°</th></tr></thead><tbody><tr><td>é€‚ç”¨åœºæ™¯</td><td>å¤„ç†å•ä¸€ç±»å‹æ•°æ®</td><td>å¤„ç†å¤šç§ç±»å‹æ•°æ®ç»„åˆ</td></tr><tr><td>ä»£ç å¤ç”¨æ€§</td><td>æœ‰é™</td><td>é«˜</td></tr><tr><td>ç±»å‹çº¦æŸ</td><td>æ¯ä¸ªå‚æ•°åªèƒ½æœ‰ä¸€ä¸ªçº¦æŸ</td><td>æ¯ä¸ªå‚æ•°å¯ä»¥æœ‰è‡ªå·±çš„çº¦æŸ</td></tr><tr><td>ä»£ç å¤æ‚åº¦</td><td>ä½</td><td>ä¸­ç­‰</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>ç®€å•å®¹å™¨ã€é€šç”¨å‡½æ•°</td><td>å¤æ‚æ•°æ®ç»“æ„ã€ç»„åˆå¤„ç†</td></tr></tbody></table>
<h3 data-id="heading-13">ğŸ’¡ å°è´´å£«</h3>
<ol>
<li><strong>ç±»å‹å‚æ•°å‘½å</strong>ï¼šé€šå¸¸ç”¨å•ä¸ªå¤§å†™å­—æ¯ï¼Œå¦‚<code>T</code>ã€<code>U</code>ã€<code>V</code>ã€<code>K</code>ï¼ˆKeyï¼‰ã€<code>V</code>ï¼ˆValueï¼‰</li>
<li><strong>åˆç†ä½¿ç”¨çº¦æŸ</strong>ï¼šä¸è¦è¿‡åº¦çº¦æŸï¼Œå¦åˆ™ä¼šé™åˆ¶å‡½æ•°çš„ä½¿ç”¨åœºæ™¯</li>
<li><strong>ç±»å‹æ¨æ–­</strong>ï¼šKotlinä¼šè‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œæ‰€ä»¥é€šå¸¸ä¸éœ€è¦æ˜¾å¼æŒ‡å®š</li>
<li><strong>é¿å…è¿‡åº¦ä½¿ç”¨</strong>ï¼šå¦‚æœä¸éœ€è¦å¤„ç†å¤šç§ç±»å‹ï¼Œå•æ³›å‹å‚æ•°å°±è¶³å¤Ÿäº†</li>
</ol>
<h3 data-id="heading-14">ğŸŒŸ ä¸€ä¸ªå°ç»ƒä¹ </h3>
<p>è¯•è¯•çœ‹ï¼Œå†™ä¸€ä¸ª<code>Triple</code>ç±»ï¼Œå®ƒèƒ½å­˜å‚¨ä¸‰ä¸ªä¸åŒç±»å‹çš„å€¼ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Triple</span>&lt;<span class="hljs-type">T, U, V</span>&gt;(<span class="hljs-keyword">val</span> first: T, <span class="hljs-keyword">val</span> second: U, <span class="hljs-keyword">val</span> third: V) {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">swapFirstTwo</span><span class="hljs-params">()</span></span>: Triple&lt;U, T, V&gt; = Triple(second, first, third)
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">toString</span><span class="hljs-params">()</span></span>: String = <span class="hljs-string">"(<span class="hljs-variable">$first</span>, <span class="hljs-variable">$second</span>, <span class="hljs-variable">$third</span>)"</span>
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> triple = Triple(<span class="hljs-number">10</span>, <span class="hljs-string">"Hello"</span>, <span class="hljs-literal">true</span>)
    println(triple) <span class="hljs-comment">// (10, Hello, true)</span>
    println(triple.swapFirstTwo()) <span class="hljs-comment">// (Hello, 10, true)</span>
}
</code></pre>
<h3 data-id="heading-15">ğŸ“š æ€»ç»“</h3>
<p>Kotlinçš„å¤šæ³›å‹å‚æ•°æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ç‰¹æ€§ï¼Œå®ƒè®©æˆ‘ä»¬çš„ä»£ç èƒ½å¤Ÿå¤„ç†æ›´å¤æ‚çš„ç±»å‹ç»„åˆï¼ŒåŒæ—¶ä¿æŒç±»å‹å®‰å…¨ã€‚é€šè¿‡åˆç†ä½¿ç”¨å¤šæ³›å‹å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™å‡ºæ›´é€šç”¨ã€æ›´å®‰å…¨ã€æ›´æ˜“ç»´æŠ¤çš„ä»£ç ã€‚</p>
<blockquote>
<p>ğŸ’¡ <strong>å°å»ºè®®</strong>ï¼šåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå…ˆä»ç®€å•çš„å¤šæ³›å‹å‚æ•°ç±»å¼€å§‹ï¼Œæ¯”å¦‚<code>Pair</code>ï¼Œç„¶åæ…¢æ…¢å°è¯•æ›´å¤æ‚çš„åœºæ™¯ã€‚å¤šæ³›å‹å‚æ•°ç”¨å¤šäº†ï¼Œä½ ä¼šçˆ±ä¸Šå®ƒçš„ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Unity3Dçš„å§”æ‰˜å’Œäº‹ä»¶çš„ç”¨æ³•è¯¦è§£]]></title>    <link>https://juejin.cn/post/7587207950248345600</link>    <guid>https://juejin.cn/post/7587207950248345600</guid>    <pubDate>2025-12-24T02:07:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587207950248345600" data-draft-id="7587207950248329216" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Unity3Dçš„å§”æ‰˜å’Œäº‹ä»¶çš„ç”¨æ³•è¯¦è§£"/> <meta itemprop="keywords" content="Unity3D,æ¸¸æˆå¼€å‘,å‰ç«¯æ¡†æ¶"/> <meta itemprop="datePublished" content="2025-12-24T02:07:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Thomasæ¸¸æˆå¼€å‘"/> <meta itemprop="url" content="https://juejin.cn/user/3758599706256028"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Unity3Dçš„å§”æ‰˜å’Œäº‹ä»¶çš„ç”¨æ³•è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3758599706256028/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Thomasæ¸¸æˆå¼€å‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T02:07:45.000Z" title="Wed Dec 24 2025 02:07:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<h2 data-id="heading-1">ä¸€ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D267983448%26content_type%3DArticle%26match_order%3D1%26q%3D%25E5%25A7%2594%25E6%2589%2598%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=267983448&amp;content_type=Article&amp;match_order=1&amp;q=%E5%A7%94%E6%89%98&amp;zhida_source=entity" ref="nofollow noopener noreferrer">å§”æ‰˜</a>ï¼ˆDelegateï¼‰åŸºç¡€</h2>
<p><strong>å¯¹æƒ¹ï¼Œè¿™é‡Œæœ‰ä¸€</strong><a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttp%253A%2F%2Fqm.qq.com%2Fcgi-bin%2Fqm%2Fqr%253F_wv%253D1027%2526k%253DdMAq1DlcS381YbFZmdb7BtZY0P6oUBtl%2526authKey%253DhZcaQ9EFvMcDLf%25252FPsKrFKENOeVlSVBMgFEsh1P43L2ZfSUQZjAndaA5MFK5IsGBM%2526noverify%253D0%2526group_code%253D682143601" target="_blank" title="https://link.zhihu.com/?target=http%3A//qm.qq.com/cgi-bin/qm/qr%3F_wv%3D1027%26k%3DdMAq1DlcS381YbFZmdb7BtZY0P6oUBtl%26authKey%3DhZcaQ9EFvMcDLf%252FPsKrFKENOeVlSVBMgFEsh1P43L2ZfSUQZjAndaA5MFK5IsGBM%26noverify%3D0%26group_code%3D682143601" ref="nofollow noopener noreferrer">ä¸ªæ¸¸æˆå¼€å‘äº¤æµå°ç»„</a> <strong>ï¼Œå¸Œæœ›å¤§å®¶å¯ä»¥ç‚¹å‡»è¿›æ¥ä¸€èµ·äº¤æµä¸€ä¸‹å¼€å‘ç»éªŒå‘€ï¼</strong></p>
<h3 data-id="heading-2">1.1 å§”æ‰˜çš„å®šä¹‰ä¸ä½¿ç”¨</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// 1. å®šä¹‰å§”æ‰˜ç±»å‹</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">delegate</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SimpleDelegate</span>()</span>;
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">delegate</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ParameterDelegate</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> message</span>)</span>;
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">delegate</span> <span class="hljs-built_in">int</span> <span class="hljs-title">CalculateDelegate</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> a, <span class="hljs-built_in">int</span> b</span>)</span>;

<span class="hljs-comment">// 2. ä½¿ç”¨å§”æ‰˜</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">DelegateExample</span> : <span class="hljs-title">MonoBehaviour</span>
{
    <span class="hljs-keyword">private</span> SimpleDelegate myDelegate;
    <span class="hljs-keyword">private</span> ParameterDelegate paramDelegate;
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Start</span>()</span>
    {
        <span class="hljs-comment">// 3. èµ‹å€¼æ–¹æ³•</span>
        myDelegate = PrintHello;
        paramDelegate = PrintMessage;
        
        <span class="hljs-comment">// 4. è°ƒç”¨å§”æ‰˜</span>
        myDelegate?.Invoke();
        paramDelegate?.Invoke(<span class="hljs-string">"Hello World"</span>);
        
        <span class="hljs-comment">// 5. å¤šæ’­å§”æ‰˜ï¼ˆå¤šä¸ªæ–¹æ³•ï¼‰</span>
        myDelegate += PrintWorld;
        myDelegate += () =&gt; Debug.Log(<span class="hljs-string">"Lambdaè¡¨è¾¾å¼"</span>);
        myDelegate?.Invoke();
        
        <span class="hljs-comment">// 6. ç§»é™¤æ–¹æ³•</span>
        myDelegate -= PrintHello;
    }
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PrintHello</span>()</span>
    {
        Debug.Log(<span class="hljs-string">"Hello"</span>);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PrintWorld</span>()</span>
    {
        Debug.Log(<span class="hljs-string">"World"</span>);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PrintMessage</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> msg</span>)</span>
    {
        Debug.Log(msg);
    }
}
</code></pre>
<p><strong>1.2 Unityå†…ç½®å§”æ‰˜ç±»å‹</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">UnityBuiltInDelegates</span> : <span class="hljs-title">MonoBehaviour</span>
{
    <span class="hljs-comment">// UnityAction - æ— è¿”å›å€¼å§”æ‰˜</span>
    <span class="hljs-keyword">private</span> UnityAction unityAction;
    <span class="hljs-keyword">private</span> UnityAction&lt;<span class="hljs-built_in">int</span>, <span class="hljs-built_in">float</span>&gt; paramAction;
    
    <span class="hljs-comment">// UnityEvent - åºåˆ—åŒ–çš„äº‹ä»¶</span>
    <span class="hljs-keyword">public</span> UnityEvent onEventTriggered;
    <span class="hljs-keyword">public</span> UnityEvent&lt;<span class="hljs-built_in">string</span>&gt; onMessageEvent;
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Start</span>()</span>
    {
        <span class="hljs-comment">// UnityActionç”¨æ³•</span>
        unityAction = () =&gt; Debug.Log(<span class="hljs-string">"Action triggered"</span>);
        paramAction = (x, y) =&gt; Debug.Log(<span class="hljs-string">$"x=<span class="hljs-subst">{x}</span>, y=<span class="hljs-subst">{y}</span>"</span>);
        
        <span class="hljs-comment">// æ·»åŠ ç›‘å¬</span>
        onEventTriggered.AddListener(OnTriggered);
        onMessageEvent.AddListener(OnMessageReceived);
        
        <span class="hljs-comment">// è§¦å‘</span>
        onEventTriggered?.Invoke();
        onMessageEvent?.Invoke(<span class="hljs-string">"Test Message"</span>);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">OnTriggered</span>()</span>
    {
        Debug.Log(<span class="hljs-string">"äº‹ä»¶è¢«è§¦å‘"</span>);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">OnMessageReceived</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> msg</span>)</span>
    {
        Debug.Log(<span class="hljs-string">$"æ”¶åˆ°æ¶ˆæ¯: <span class="hljs-subst">{msg}</span>"</span>);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">OnDestroy</span>()</span>
    {
        <span class="hljs-comment">// é‡è¦ï¼šæ¸…ç†ç›‘å¬</span>
        onEventTriggered.RemoveAllListeners();
        onMessageEvent.RemoveAllListeners();
    }
}
</code></pre>
<h2 data-id="heading-3">äºŒã€äº‹ä»¶ï¼ˆEventï¼‰é«˜çº§ç”¨æ³•</h2>
<h3 data-id="heading-4">2.1 æ ‡å‡†äº‹ä»¶æ¨¡å¼</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// 1. å®šä¹‰äº‹ä»¶å‚æ•°ç±»</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">GameEventArgs</span> : <span class="hljs-title">EventArgs</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> EventName { <span class="hljs-keyword">get</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">object</span> Data { <span class="hljs-keyword">get</span>; }
    <span class="hljs-keyword">public</span> DateTime Timestamp { <span class="hljs-keyword">get</span>; }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">GameEventArgs</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> name, <span class="hljs-built_in">object</span> data</span>)</span>
    {
        EventName = name;
        Data = data;
        Timestamp = DateTime.Now;
    }
}

<span class="hljs-comment">// 2. äº‹ä»¶å‘å¸ƒè€…</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EventPublisher</span> : <span class="hljs-title">MonoBehaviour</span>
{
    <span class="hljs-comment">// å®šä¹‰äº‹ä»¶ï¼ˆä½¿ç”¨EventHandleræ ‡å‡†æ¨¡å¼ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> EventHandler&lt;GameEventArgs&gt; OnGameEvent;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> EventHandler OnSimpleEvent;
    
    <span class="hljs-comment">// è§¦å‘äº‹ä»¶çš„ä¿æŠ¤æ–¹æ³•</span>
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">RaiseGameEvent</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> eventName, <span class="hljs-built_in">object</span> data</span>)</span>
    {
        OnGameEvent?.Invoke(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">new</span> GameEventArgs(eventName, data));
    }
    
    <span class="hljs-comment">// ç¤ºä¾‹ï¼šè§¦å‘äº‹ä»¶</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">PlayerDied</span>()</span>
    {
        RaiseGameEvent(<span class="hljs-string">"PlayerDied"</span>, <span class="hljs-keyword">new</span> { score = <span class="hljs-number">100</span>, position = transform.position });
    }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">LevelCompleted</span>()</span>
    {
        OnSimpleEvent?.Invoke(<span class="hljs-keyword">this</span>, EventArgs.Empty);
    }
}
</code></pre>
<p><strong>2.2 äº‹ä»¶è®¢é˜…è€…</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EventSubscriber</span> : <span class="hljs-title">MonoBehaviour</span>
{
    [<span class="hljs-meta">SerializeField</span>] <span class="hljs-keyword">private</span> EventPublisher publisher;
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">OnEnable</span>()</span>
    {
        <span class="hljs-keyword">if</span> (publisher != <span class="hljs-literal">null</span>)
        {
            publisher.OnGameEvent += HandleGameEvent;
            publisher.OnSimpleEvent += HandleSimpleEvent;
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">OnDisable</span>()</span>
    {
        <span class="hljs-comment">// é‡è¦ï¼šé¿å…å†…å­˜æ³„æ¼</span>
        <span class="hljs-keyword">if</span> (publisher != <span class="hljs-literal">null</span>)
        {
            publisher.OnGameEvent -= HandleGameEvent;
            publisher.OnSimpleEvent -= HandleSimpleEvent;
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">HandleGameEvent</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> sender, GameEventArgs e</span>)</span>
    {
        Debug.Log(<span class="hljs-string">$"äº‹ä»¶: <span class="hljs-subst">{e.EventName}</span>, æ•°æ®: <span class="hljs-subst">{e.Data}</span>, æ—¶é—´: <span class="hljs-subst">{e.Timestamp}</span>"</span>);
        
        <span class="hljs-keyword">switch</span> (e.EventName)
        {
            <span class="hljs-keyword">case</span> <span class="hljs-string">"PlayerDied"</span>:
                HandlePlayerDeath(e.Data);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">"ItemCollected"</span>:
                HandleItemCollection(e.Data);
                <span class="hljs-keyword">break</span>;
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">HandleSimpleEvent</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> sender, EventArgs e</span>)</span>
    {
        Debug.Log(<span class="hljs-string">"ç®€å•äº‹ä»¶è§¦å‘"</span>);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">HandlePlayerDeath</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> data</span>)</span>
    {
        <span class="hljs-comment">// å¤„ç†ç©å®¶æ­»äº¡é€»è¾‘</span>
        Debug.Log(<span class="hljs-string">"ç©å®¶æ­»äº¡å¤„ç†"</span>);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">HandleItemCollection</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> data</span>)</span>
    {
        <span class="hljs-comment">// å¤„ç†ç‰©å“æ”¶é›†</span>
    }
}
</code></pre>
<h2 data-id="heading-5">ä¸‰ã€Unityä¸­çš„å®é™…åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-6">3.1 UIäº‹ä»¶ç³»ç»Ÿ</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">UIEventHandler</span> : <span class="hljs-title">MonoBehaviour</span>
{
    <span class="hljs-comment">// è‡ªå®šä¹‰UIäº‹ä»¶</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> Action&lt;Button&gt; OnButtonClicked;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> Action&lt;Slider, <span class="hljs-built_in">float</span>&gt; OnSliderValueChanged;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> Action&lt;Toggle, <span class="hljs-built_in">bool</span>&gt; OnToggleChanged;
    
    [<span class="hljs-meta">SerializeField</span>] <span class="hljs-keyword">private</span> Button playButton;
    [<span class="hljs-meta">SerializeField</span>] <span class="hljs-keyword">private</span> Slider volumeSlider;
    [<span class="hljs-meta">SerializeField</span>] <span class="hljs-keyword">private</span> Toggle soundToggle;
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Start</span>()</span>
    {
        <span class="hljs-comment">// Unity UIç»„ä»¶äº‹ä»¶è½¬æ¢ä¸ºè‡ªå®šä¹‰äº‹ä»¶</span>
        playButton.onClick.AddListener(() =&gt; OnButtonClicked?.Invoke(playButton));
        volumeSlider.onValueChanged.AddListener(<span class="hljs-keyword">value</span> =&gt; 
            OnSliderValueChanged?.Invoke(volumeSlider, <span class="hljs-keyword">value</span>));
        soundToggle.onValueChanged.AddListener(isOn =&gt; 
            OnToggleChanged?.Invoke(soundToggle, isOn));
    }
}
</code></pre>
<p><strong>3.2 æ¸¸æˆçŠ¶æ€ç®¡ç†</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">GameManager</span> : <span class="hljs-title">MonoBehaviour</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> GameManager Instance { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">private</span> <span class="hljs-keyword">set</span>; }
    
    <span class="hljs-comment">// æ¸¸æˆçŠ¶æ€äº‹ä»¶</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> Action&lt;GameState&gt; OnGameStateChanged;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> Action&lt;<span class="hljs-built_in">int</span>&gt; OnScoreChanged;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> Action&lt;<span class="hljs-built_in">int</span>&gt; OnPlayerHealthChanged;
    
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">enum</span> GameState { Menu, Playing, Paused, GameOver }
    <span class="hljs-keyword">private</span> GameState currentState;
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Awake</span>()</span>
    {
        <span class="hljs-keyword">if</span> (Instance == <span class="hljs-literal">null</span>)
        {
            Instance = <span class="hljs-keyword">this</span>;
            DontDestroyOnLoad(gameObject);
        }
        <span class="hljs-keyword">else</span>
        {
            Destroy(gameObject);
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ChangeGameState</span>(<span class="hljs-params">GameState newState</span>)</span>
    {
        currentState = newState;
        OnGameStateChanged?.Invoke(newState);
        
        <span class="hljs-keyword">switch</span> (newState)
        {
            <span class="hljs-keyword">case</span> GameState.Playing:
                StartGame();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> GameState.GameOver:
                EndGame();
                <span class="hljs-keyword">break</span>;
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AddScore</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> points</span>)</span>
    {
        <span class="hljs-comment">// åˆ†æ•°é€»è¾‘...</span>
        OnScoreChanged?.Invoke(currentScore);
    }
    
    <span class="hljs-comment">// å…¶ä»–æ–¹æ³•...</span>
}
</code></pre>
<p><strong>3.3 æˆå°±ç³»ç»Ÿ</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AchievementSystem</span> : <span class="hljs-title">MonoBehaviour</span>
{
    <span class="hljs-comment">// æˆå°±äº‹ä»¶</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> Action&lt;<span class="hljs-built_in">string</span>&gt; OnAchievementUnlocked;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> Action&lt;<span class="hljs-built_in">int</span>&gt; OnTotalAchievementsChanged;
    
    <span class="hljs-keyword">private</span> Dictionary&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">bool</span>&gt; achievements = <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">bool</span>&gt;();
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">UnlockAchievement</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> achievementId</span>)</span>
    {
        <span class="hljs-keyword">if</span> (!achievements.ContainsKey(achievementId) || !achievements[achievementId])
        {
            achievements[achievementId] = <span class="hljs-literal">true</span>;
            OnAchievementUnlocked?.Invoke(achievementId);
            OnTotalAchievementsChanged?.Invoke(achievements.Count(a =&gt; a.Value));
            
            <span class="hljs-comment">// æ˜¾ç¤ºæˆå°±UIç­‰</span>
            Debug.Log(<span class="hljs-string">$"æˆå°±è§£é”: <span class="hljs-subst">{achievementId}</span>"</span>);
        }
    }
}

<span class="hljs-comment">// æˆå°±è§¦å‘å™¨</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AchievementTrigger</span> : <span class="hljs-title">MonoBehaviour</span>
{
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">OnTriggerEnter</span>(<span class="hljs-params">Collider other</span>)</span>
    {
        <span class="hljs-keyword">if</span> (other.CompareTag(<span class="hljs-string">"Player"</span>))
        {
            AchievementSystem.Instance?.OnAchievementUnlocked?.Invoke(<span class="hljs-string">"First_Secret_Found"</span>);
        }
    }
}
</code></pre>
<h2 data-id="heading-7">å››ã€é«˜çº§æ¨¡å¼ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-8">4.1 äº‹ä»¶æ€»çº¿æ¨¡å¼</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EventBus</span> : <span class="hljs-title">MonoBehaviour</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> EventBus instance;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> EventBus Instance =&gt; instance;
    
    <span class="hljs-comment">// äº‹ä»¶å­—å…¸</span>
    <span class="hljs-keyword">private</span> Dictionary&lt;Type, Delegate&gt; eventTable = <span class="hljs-keyword">new</span> Dictionary&lt;Type, Delegate&gt;();
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Awake</span>()</span>
    {
        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>)
        {
            instance = <span class="hljs-keyword">this</span>;
            DontDestroyOnLoad(gameObject);
        }
    }
    
    <span class="hljs-comment">// è®¢é˜…äº‹ä»¶</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Subscribe</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params">Action&lt;T&gt; handler</span>) <span class="hljs-keyword">where</span> T : <span class="hljs-keyword">struct</span></span>
    {
        Type eventType = <span class="hljs-keyword">typeof</span>(T);
        
        <span class="hljs-keyword">if</span> (!eventTable.ContainsKey(eventType))
        {
            eventTable[eventType] = handler;
        }
        <span class="hljs-keyword">else</span>
        {
            eventTable[eventType] = Delegate.Combine(eventTable[eventType], handler);
        }
    }
    
    <span class="hljs-comment">// å–æ¶ˆè®¢é˜…</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Unsubscribe</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params">Action&lt;T&gt; handler</span>) <span class="hljs-keyword">where</span> T : <span class="hljs-keyword">struct</span></span>
    {
        Type eventType = <span class="hljs-keyword">typeof</span>(T);
        
        <span class="hljs-keyword">if</span> (eventTable.ContainsKey(eventType))
        {
            eventTable[eventType] = Delegate.Remove(eventTable[eventType], handler);
        }
    }
    
    <span class="hljs-comment">// å‘å¸ƒäº‹ä»¶</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Publish</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params">T eventData</span>) <span class="hljs-keyword">where</span> T : <span class="hljs-keyword">struct</span></span>
    {
        Type eventType = <span class="hljs-keyword">typeof</span>(T);
        
        <span class="hljs-keyword">if</span> (eventTable.ContainsKey(eventType) &amp;&amp; eventTable[eventType] != <span class="hljs-literal">null</span>)
        {
            (eventTable[eventType] <span class="hljs-keyword">as</span> Action&lt;T&gt;)?.Invoke(eventData);
        }
    }
}

<span class="hljs-comment">// ä½¿ç”¨äº‹ä»¶æ€»çº¿</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">struct</span> PlayerDiedEvent
{
    <span class="hljs-keyword">public</span> Vector3 DeathPosition;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> RemainingLives;
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> KillerName;
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">PlayerController</span> : <span class="hljs-title">MonoBehaviour</span>
{
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Die</span>()</span>
    {
        <span class="hljs-keyword">var</span> deathEvent = <span class="hljs-keyword">new</span> PlayerDiedEvent
        {
            DeathPosition = transform.position,
            RemainingLives = currentLives,
            KillerName = <span class="hljs-string">"Enemy"</span>
        };
        
        EventBus.Instance.Publish(deathEvent);
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">DeathEffectManager</span> : <span class="hljs-title">MonoBehaviour</span>
{
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">OnEnable</span>()</span>
    {
        EventBus.Instance.Subscribe&lt;PlayerDiedEvent&gt;(OnPlayerDied);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">OnDisable</span>()</span>
    {
        EventBus.Instance.Unsubscribe&lt;PlayerDiedEvent&gt;(OnPlayerDied);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">OnPlayerDied</span>(<span class="hljs-params">PlayerDiedEvent evt</span>)</span>
    {
        <span class="hljs-comment">// æ’­æ”¾æ­»äº¡ç‰¹æ•ˆ</span>
        Instantiate(deathEffect, evt.DeathPosition, Quaternion.identity);
    }
}
</code></pre>
<p><strong>4.2 è§‚å¯Ÿè€…æ¨¡å¼å®ç°</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// å¯è§‚å¯Ÿå¯¹è±¡æ¥å£</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">IObservable</span>&lt;<span class="hljs-title">T</span>&gt;
{
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">AddObserver</span>(<span class="hljs-params">IObserver&lt;T&gt; observer</span>)</span>;
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">RemoveObserver</span>(<span class="hljs-params">IObserver&lt;T&gt; observer</span>)</span>;
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">NotifyObservers</span>(<span class="hljs-params">T data</span>)</span>;
}

<span class="hljs-comment">// è§‚å¯Ÿè€…æ¥å£</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">IObserver</span>&lt;<span class="hljs-title">T</span>&gt;
{
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">OnNotify</span>(<span class="hljs-params">T data</span>)</span>;
}

<span class="hljs-comment">// å…·ä½“å®ç°</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">HealthSystem</span> : <span class="hljs-title">MonoBehaviour</span>, <span class="hljs-title">IObservable</span>&lt;<span class="hljs-title">int</span>&gt;
{
    <span class="hljs-keyword">private</span> List&lt;IObserver&lt;<span class="hljs-built_in">int</span>&gt;&gt; observers = <span class="hljs-keyword">new</span> List&lt;IObserver&lt;<span class="hljs-built_in">int</span>&gt;&gt;();
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> currentHealth = <span class="hljs-number">100</span>;
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AddObserver</span>(<span class="hljs-params">IObserver&lt;<span class="hljs-built_in">int</span>&gt; observer</span>)</span>
    {
        <span class="hljs-keyword">if</span> (!observers.Contains(observer))
        {
            observers.Add(observer);
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">RemoveObserver</span>(<span class="hljs-params">IObserver&lt;<span class="hljs-built_in">int</span>&gt; observer</span>)</span>
    {
        observers.Remove(observer);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">NotifyObservers</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> health</span>)</span>
    {
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> observer <span class="hljs-keyword">in</span> observers)
        {
            observer.OnNotify(health);
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">TakeDamage</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> damage</span>)</span>
    {
        currentHealth -= damage;
        currentHealth = Mathf.Max(<span class="hljs-number">0</span>, currentHealth);
        NotifyObservers(currentHealth);
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">HealthUI</span> : <span class="hljs-title">MonoBehaviour</span>, <span class="hljs-title">IObserver</span>&lt;<span class="hljs-title">int</span>&gt;
{
    [<span class="hljs-meta">SerializeField</span>] <span class="hljs-keyword">private</span> Slider healthSlider;
    [<span class="hljs-meta">SerializeField</span>] <span class="hljs-keyword">private</span> Text healthText;
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Start</span>()</span>
    {
        <span class="hljs-keyword">var</span> healthSystem = FindObjectOfType&lt;HealthSystem&gt;();
        <span class="hljs-keyword">if</span> (healthSystem != <span class="hljs-literal">null</span>)
        {
            healthSystem.AddObserver(<span class="hljs-keyword">this</span>);
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnNotify</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> health</span>)</span>
    {
        healthSlider.<span class="hljs-keyword">value</span> = health / <span class="hljs-number">100f</span>;
        healthText.text = <span class="hljs-string">$"HP: <span class="hljs-subst">{health}</span>"</span>;
        
        <span class="hljs-keyword">if</span> (health &lt; <span class="hljs-number">30</span>)
        {
            <span class="hljs-comment">// ä½è¡€é‡è­¦å‘Š</span>
            StartCoroutine(FlashWarning());
        }
    }
    
    <span class="hljs-function">IEnumerator <span class="hljs-title">FlashWarning</span>()</span>
    {
        <span class="hljs-comment">// é—ªçƒæ•ˆæœ</span>
        healthText.color = Color.red;
        <span class="hljs-function"><span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title">WaitForSeconds</span>(<span class="hljs-params"><span class="hljs-number">0.5f</span></span>)</span>;
        healthText.color = Color.white;
    }
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">OnDestroy</span>()</span>
    {
        <span class="hljs-keyword">var</span> healthSystem = FindObjectOfType&lt;HealthSystem&gt;();
        <span class="hljs-keyword">if</span> (healthSystem != <span class="hljs-literal">null</span>)
        {
            healthSystem.RemoveObserver(<span class="hljs-keyword">this</span>);
        }
    }
}
</code></pre>
<h2 data-id="heading-9">äº”ã€æ€§èƒ½ä¼˜åŒ–ä¸æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-10">5.1 æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">OptimizedEventSystem</span> : <span class="hljs-title">MonoBehaviour</span>
{
    <span class="hljs-comment">// 1. ä½¿ç”¨ç¼“å­˜å‡å°‘å§”æ‰˜åˆ†é…</span>
    <span class="hljs-keyword">private</span> UnityAction cachedAction;
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Start</span>()</span>
    {
        cachedAction = DoSomething;
        
        <span class="hljs-comment">// é¿å…åœ¨å¾ªç¯ä¸­åˆ›å»ºæ–°å§”æ‰˜</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++)
        {
            someEvent.AddListener(cachedAction); <span class="hljs-comment">// å¥½</span>
            <span class="hljs-comment">// someEvent.AddListener(() =&gt; DoSomething()); // ä¸å¥½ï¼Œæ¯æ¬¡åˆ›å»ºæ–°å§”æ‰˜</span>
        }
    }
    
    <span class="hljs-comment">// 2. ä½¿ç”¨å¯¹è±¡æ± ç®¡ç†äº‹ä»¶å‚æ•°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EventDataPool</span>
    {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ObjectPool&lt;GameEventArgs&gt; pool = 
            <span class="hljs-keyword">new</span> ObjectPool&lt;GameEventArgs&gt;(() =&gt; <span class="hljs-keyword">new</span> GameEventArgs(), <span class="hljs-number">10</span>);
        
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> GameEventArgs <span class="hljs-title">Get</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> name, <span class="hljs-built_in">object</span> data</span>)</span>
        {
            <span class="hljs-keyword">var</span> args = pool.Get();
            <span class="hljs-comment">// åˆå§‹åŒ–...</span>
            <span class="hljs-keyword">return</span> args;
        }
        
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Release</span>(<span class="hljs-params">GameEventArgs args</span>)</span>
        {
            pool.Release(args);
        }
    }
    
    <span class="hljs-comment">// 3. é¿å…é¢‘ç¹çš„äº‹ä»¶è§¦å‘</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">float</span> lastEventTime;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-built_in">float</span> EVENT_COOLDOWN = <span class="hljs-number">0.1f</span>;
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">TryTriggerEvent</span>()</span>
    {
        <span class="hljs-keyword">if</span> (Time.time - lastEventTime &gt; EVENT_COOLDOWN)
        {
            lastEventTime = Time.time;
            OnEvent?.Invoke();
        }
    }
}
</code></pre>
<p><strong>5.2 å¸¸è§é™·é˜±ä¸è§£å†³æ–¹æ¡ˆ</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EventPitfalls</span> : <span class="hljs-title">MonoBehaviour</span>
{
    <span class="hljs-comment">// é™·é˜±1ï¼šå¿˜è®°å–æ¶ˆè®¢é˜…ï¼ˆå†…å­˜æ³„æ¼ï¼‰</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SubscribeAndForget</span>()</span>
    {
        SomeClass.Instance.OnEvent += HandleEvent;
        <span class="hljs-comment">// å¦‚æœä¸åœ¨é€‚å½“æ—¶å€™å–æ¶ˆè®¢é˜…ï¼Œå³ä½¿å¯¹è±¡è¢«é”€æ¯ï¼Œå§”æ‰˜ä»ç„¶æŒæœ‰å¼•ç”¨</span>
    }
    
    <span class="hljs-comment">// è§£å†³æ–¹æ¡ˆï¼šåœ¨OnDisableæˆ–OnDestroyä¸­å–æ¶ˆè®¢é˜…</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">OnEnable</span>()</span>
    {
        SomeClass.Instance.OnEvent += HandleEvent;
    }
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">OnDisable</span>()</span>
    {
        SomeClass.Instance.OnEvent -= HandleEvent;
    }
    
    <span class="hljs-comment">// é™·é˜±2ï¼šç©ºå¼•ç”¨æ£€æŸ¥</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> Action OnUnsafeEvent;
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">TriggerUnsafeEvent</span>()</span>
    {
        OnUnsafeEvent(); <span class="hljs-comment">// å¦‚æœæ²¡æœ‰è®¢é˜…è€…ä¼šæŠ›å‡ºNullReferenceException</span>
    }
    
    <span class="hljs-comment">// è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ç©ºæ¡ä»¶è¿ç®—ç¬¦</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">TriggerSafeEvent</span>()</span>
    {
        OnUnsafeEvent?.Invoke();
    }
    
    <span class="hljs-comment">// é™·é˜±3ï¼šçº¿ç¨‹å®‰å…¨é—®é¢˜</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">event</span> Action OnThreadEvent;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-built_in">object</span> lockObject = <span class="hljs-keyword">new</span> <span class="hljs-built_in">object</span>();
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ThreadSafeSubscribe</span>(<span class="hljs-params">Action handler</span>)</span>
    {
        <span class="hljs-keyword">lock</span> (lockObject)
        {
            OnThreadEvent += handler;
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ThreadSafeInvoke</span>()</span>
    {
        Action localCopy;
        <span class="hljs-keyword">lock</span> (lockObject)
        {
            localCopy = OnThreadEvent;
        }
        localCopy?.Invoke();
    }
    
    <span class="hljs-comment">// é™·é˜±4ï¼šäº‹ä»¶é“¾å¯¼è‡´æ— é™é€’å½’</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">bool</span> isHandlingEvent = <span class="hljs-literal">false</span>;
    
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">HandleEventA</span>()</span>
    {
        <span class="hljs-keyword">if</span> (isHandlingEvent) <span class="hljs-keyword">return</span>;
        
        isHandlingEvent = <span class="hljs-literal">true</span>;
        <span class="hljs-comment">// å¤„ç†äº‹ä»¶...</span>
        OnEventB?.Invoke(); <span class="hljs-comment">// å¯èƒ½è§¦å‘å…¶ä»–äº‹ä»¶</span>
        isHandlingEvent = <span class="hljs-literal">false</span>;
    }
}
</code></pre>
<h2 data-id="heading-11">æ€»ç»“</h2>
<h3 data-id="heading-12">å§”æ‰˜ä¸äº‹ä»¶çš„é€‰æ‹©æŒ‡å—</h3>
<ol>
<li><strong>ä½¿ç”¨å§”æ‰˜çš„æƒ…å†µ</strong>ï¼š</li>
</ol>
<ul>
<li>
<p>éœ€è¦å›è°ƒå‡½æ•°</p>
</li>
<li>
<p>ç®€å•çš„æ–¹æ³•ä¼ é€’</p>
</li>
<li>
<p>éœ€è¦å¤šæ’­åŠŸèƒ½</p>
</li>
<li>
<p>åœ¨ç±»å†…éƒ¨ä½¿ç”¨</p>
</li>
<li>
<p><strong>ä½¿ç”¨äº‹ä»¶çš„æƒ…å†µ</strong>ï¼š</p>
</li>
<li>
<p>å…¬å¼€çš„æ¥å£ï¼Œéœ€è¦å°è£…</p>
</li>
<li>
<p>è§‚å¯Ÿè€…æ¨¡å¼å®ç°</p>
</li>
<li>
<p>ç»„ä»¶é—´é€šä¿¡</p>
</li>
<li>
<p>éœ€è¦æ›´å®‰å…¨çš„è®¿é—®æ§åˆ¶</p>
</li>
<li>
<p><strong>UnityEventçš„ç‰¹æ®Šä¼˜åŠ¿</strong>ï¼š</p>
</li>
<li>
<p>æ”¯æŒåºåˆ—åŒ–ï¼Œå¯åœ¨Inspectorä¸­é…ç½®</p>
</li>
<li>
<p>å¯è§†åŒ–ç¼–è¾‘</p>
</li>
<li>
<p>é€‚åˆéç¨‹åºå‘˜ä½¿ç”¨</p>
</li>
</ul>
<h3 data-id="heading-13">æœ€ä½³å®è·µ</h3>
<ol>
<li>å§‹ç»ˆä½¿ç”¨ç©ºæ¡ä»¶è¿ç®—ç¬¦ï¼ˆ<code>?.Invoke()</code>ï¼‰</li>
<li>åŠæ—¶æ¸…ç†è®¢é˜…ï¼ˆOnDisable/OnDestroyï¼‰</li>
<li>è€ƒè™‘ä½¿ç”¨äº‹ä»¶æ€»çº¿è§£è€¦å¤æ‚ç³»ç»Ÿ</li>
<li>ä¸ºé¢‘ç¹è§¦å‘çš„äº‹ä»¶æ·»åŠ èŠ‚æµæœºåˆ¶</li>
<li>ä½¿ç”¨ç»“æ„ä½“ä½œä¸ºäº‹ä»¶å‚æ•°ä»¥å‡å°‘GC</li>
<li>é¿å…åœ¨äº‹ä»¶å¤„ç†ä¸­æŠ›å‡ºå¼‚å¸¸</li>
<li>æ–‡æ¡£åŒ–äº‹ä»¶çš„ä½¿ç”¨æ–¹å¼å’ŒæœŸæœ›è¡Œä¸º</li>
</ol>
<p>æŒæ¡å§”æ‰˜å’Œäº‹ä»¶æ˜¯Unityå¼€å‘ä¸­çš„æ ¸å¿ƒæŠ€èƒ½ï¼Œåˆç†ä½¿ç”¨å¯ä»¥åˆ›å»ºå‡ºæ¾è€¦åˆã€å¯ç»´æŠ¤æ€§é«˜çš„ä»£ç æ¶æ„ã€‚</p>
<p><strong>æ›´å¤šæ•™å­¦è§†</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Fwww.bycwedu.com%2Fpromotion_channels%2F2146264125" target="_blank" title="https://link.zhihu.com/?target=https%3A//www.bycwedu.com/promotion_channels/2146264125" ref="nofollow noopener noreferrer">çŸ¥ä¹ - å®‰å…¨ä¸­å¿ƒwww.bycwedu.com/promotion_channels/2146264125</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Andrej Karpathyçš„2025 LLM å¹´åº¦æ€»ç»“]]></title>    <link>https://juejin.cn/post/7586971886589558827</link>    <guid>https://juejin.cn/post/7586971886589558827</guid>    <pubDate>2025-12-24T01:31:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586971886589558827" data-draft-id="7586969583782576134" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Andrej Karpathyçš„2025 LLM å¹´åº¦æ€»ç»“"/> <meta itemprop="keywords" content="LLM"/> <meta itemprop="datePublished" content="2025-12-24T01:31:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‰å¸½lufei"/> <meta itemprop="url" content="https://juejin.cn/user/501033035632093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Andrej Karpathyçš„2025 LLM å¹´åº¦æ€»ç»“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/501033035632093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‰å¸½lufei
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T01:31:02.000Z" title="Wed Dec 24 2025 01:31:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">Andrej Karpathyçš„2025 LLM å¹´åº¦æ€»ç»“</h2>
<h3 data-id="heading-1">å‰è¨€</h3>
<p>Andrej Karpathy è¿™ä¸ªæAIçš„è€å“¥ï¼Œåœ¨Xä¸Šå‘å¸ƒäº†è‡ªå·±çš„2025 LLM å¹´åº¦æ€»ç»“ï¼Œå¼•èµ·äº†çƒ­çƒˆçš„è®¨è®ºï¼Œè¿™é‡Œè®°å½•æ¨æ–‡å†…å®¹å¹¶å•ç‹¬åŠ äº†ä¸€äº›è‡ªå·±çš„æ€è€ƒï¼Œæ–¹ä¾¿åç»­å­¦ä¹ </p>
<h3 data-id="heading-2">Andrej Karpathyä»‹ç»</h3>
<p>åœ¨ EurekaLabsAI å·¥ä½œï¼Œæ›¾ä»»ç‰¹æ–¯æ‹‰äººå·¥æ™ºèƒ½æ€»ç›‘ï¼ŒOpenAIåˆ›å§‹å›¢é˜Ÿæˆå‘˜ï¼Œæ–¯å¦ç¦å¤§å­¦è®¡ç®—æœºç§‘å­¦ç¡•å£«/åšå£«</p>
<h3 data-id="heading-3">æ¨æ–‡å†…å®¹</h3>
<p>2025å¹´æ˜¯å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å–å¾—çš„å¼ºåŠ²ä¸”å……æ»¡äº‹ä»¶æ€§çš„ä¸€å¹´ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä¸ªäººå€¼å¾—æ³¨æ„ä¸”ç•¥æ˜¾æ„å¤–çš„â€œèŒƒå¼å˜é©â€â€”â€”é‚£äº›æ”¹å˜äº†å±€åŠ¿å¹¶åœ¨æ¦‚å¿µä¸Šè®©æˆ‘å°è±¡æ·±åˆ»çš„äº‹æƒ…ã€‚</p>
<h4 data-id="heading-4">1. å¯éªŒè¯å¥–åŠ±çš„å¼ºåŒ–å­¦ä¹ ï¼ˆRLVRï¼‰</h4>
<p>2025å¹´åˆï¼Œæ‰€æœ‰å®éªŒå®¤çš„LLMç”Ÿäº§å †æ ˆå¤§è‡´å¦‚ä¸‹ï¼š</p>
<ol>
<li>é¢„è®­ç»ƒï¼ˆ2020 å¹´ ~3 çš„ GPT-2/3ï¼‰</li>
<li>ç›‘ç£å¾®è°ƒï¼ˆInstructGPT ~2022ï¼‰</li>
<li>äººç±»åé¦ˆå¼ºåŒ–å­¦ä¹ ï¼ˆRLHF ~2022ï¼‰</li>
</ol>
<p>è¿™æ›¾æ˜¯è®­ç»ƒç”Ÿäº§çº§å¤§å‹è¯­è¨€æ¨¡å‹çš„ç¨³å®šä¸”ç»è¿‡éªŒè¯çš„é…æ–¹ã€‚2025å¹´ï¼Œå¯éªŒè¯å¥–åŠ±å¼ºåŒ–å­¦ä¹ ï¼ˆRLVRï¼‰æˆä¸ºè¿™ä¸€ç»„åˆä¸­äº‹å®ä¸Šçš„æ–°ä¸»è¦å¹³å°ã€‚é€šè¿‡è®­ç»ƒLLMé¢å¯¹å¤šç§ç¯å¢ƒä¸­è‡ªåŠ¨éªŒè¯çš„å¥–åŠ±ï¼ˆä¾‹å¦‚æ•°å­¦/ä»£ç è°œé¢˜ï¼‰ï¼ŒLLMè‡ªå‘å‘å±•å‡ºçœ‹èµ·æ¥åƒâ€œæ¨ç†â€çš„ç­–ç•¥â€”â€”å®ƒä»¬å­¦ä¼šå°†é—®é¢˜è§£å†³åˆ†è§£ä¸ºä¸­é—´è®¡ç®—ï¼Œå¹¶å­¦ä¹ å¤šç§è§£å†³é—®é¢˜çš„ç­–ç•¥æ¥åå¤è§£å†³é—®é¢˜ï¼ˆç¤ºä¾‹è§DeepSeek R1è®ºæ–‡ï¼‰ã€‚åœ¨ä¹‹å‰çš„èŒƒå¼ä¸­ï¼Œè¿™äº›ç­–ç•¥å¾ˆéš¾å®ç°ï¼Œå› ä¸ºç›®å‰è¿˜ä¸æ¸…æ¥šLLMçš„æœ€ä½³æ¨ç†è¿½è¸ªå’Œæ¢å¤æ–¹å¼æ˜¯ä»€ä¹ˆâ€”â€”å®ƒå¿…é¡»é€šè¿‡é’ˆå¯¹å¥–åŠ±çš„ä¼˜åŒ–æ‰¾åˆ°é€‚åˆè‡ªå·±çš„æ–¹æ³•ã€‚</p>
<p>ä¸SFTå’ŒRLHFé˜¶æ®µä¸åŒï¼Œåè€…éƒ½æ˜¯ç›¸å¯¹è–„ä¸”çŸ­çš„é˜¶æ®µï¼ˆè®¡ç®—å¾®è°ƒï¼‰ï¼ŒRLVRæ¶‰åŠé’ˆå¯¹ç›®æ ‡ï¼ˆä¸å¯æ¸¸æˆï¼‰å¥–åŠ±å‡½æ•°è¿›è¡Œè®­ç»ƒï¼Œä»è€Œå®ç°æ›´é•¿æ—¶é—´çš„ä¼˜åŒ–ã€‚è¿è¡ŒRLVRæä¾›äº†é«˜èƒ½åŠ›/æˆæœ¬ï¼Œæ¶ˆè€—äº†åŸæœ¬ç”¨äºé¢„è®­ç»ƒçš„è®¡ç®—é‡ã€‚å› æ­¤ï¼Œ2025å¹´å¤§éƒ¨åˆ†èƒ½åŠ›è¿›æ­¥éƒ½ç”±å¤§å‹è¯­è¨€æ¨¡å‹å®éªŒå®¤çªç ´è¿™ä¸€æ–°é˜¶æ®µçš„çªå‡ºéƒ¨åˆ†å®šä¹‰ï¼Œæ€»ä½“ä¸Šæˆ‘ä»¬çœ‹åˆ°äº†~å¤§å°ç›¸è¿‘çš„å¤§å‹è¯­è¨€æ¨¡å‹ï¼Œä½†å¼ºåŒ–å­¦ä¹ è¿è¡Œæ—¶é—´æ›´é•¿ã€‚è¿™ä¸ªæ–°é˜¶æ®µçš„ç‹¬ç‰¹ä¹‹å¤„æ˜¯ï¼Œæˆ‘ä»¬æ–°å¢äº†ä¸€ä¸ªå…¨æ–°çš„æ—‹é’®ï¼ˆä»¥åŠç›¸å…³çš„å°ºåº¦å®šå¾‹ï¼‰ï¼Œé€šè¿‡ç”Ÿæˆæ›´é•¿çš„æ¨ç†è¿¹å’Œå¢åŠ â€œæ€è€ƒæ—¶é—´â€æ¥æ§åˆ¶æµ‹è¯•æ—¶é—´è®¡ç®—çš„èƒ½åŠ›ã€‚OpenAI o1ï¼ˆ2024å¹´åº•ï¼‰æ˜¯RLVRæ¨¡å‹çš„é¦–æ¬¡æ¼”ç¤ºï¼Œä½†o3å‘å¸ƒï¼ˆ2025å¹´åˆï¼‰æ˜¯æ˜æ˜¾çš„è½¬æŠ˜ç‚¹ï¼Œç›´è§‚åœ°æ„Ÿå—åˆ°å·®å¼‚ã€‚</p>
<blockquote>
<p>æ€è€ƒï¼š</p>
<p>è™½ç„¶æˆ‘ä¸æ˜¯AIç ”ç©¶äººå‘˜ï¼Œä»åº”ç”¨å±‚é¢ä¸Šï¼Œä¹Ÿç®—äº†è§£ä¸€éƒ¨åˆ†å§ï¼Œ2025å¹´åˆDeepSeekçš„ç«çˆ†ï¼Œå„è·¯å‚å•†ï¼Œä¸ªä½“éƒ½åœ¨ä½¿ç”¨DeepSeekï¼Œæˆ–åŸºäºDeepSeekå¼€å‘åº”ç”¨ï¼Œè’¸é¦æ¨¡å‹ï¼Œå¾®è°ƒè®­ç»ƒç­‰</p>
</blockquote>
<h4 data-id="heading-5">2. é¬¼é­‚å¯¹æŠ—åŠ¨ç‰© / é”¯é½¿æ™ºåŠ›</h4>
<p>2025å¹´æ˜¯æˆ‘ï¼ˆæˆ‘æƒ³æ•´ä¸ªè¡Œä¸šä¹Ÿæ˜¯ï¼‰é¦–æ¬¡ä»¥æ›´ç›´è§‚çš„æ–¹å¼å†…åŒ–â€œLLMæ™ºèƒ½â€çš„æ—¶æœŸã€‚æˆ‘ä»¬ä¸æ˜¯â€œè¿›åŒ–/æˆé•¿çš„åŠ¨ç‰©â€ï¼Œè€Œæ˜¯â€œå¬å”¤é¬¼é­‚â€ã€‚LLMå †æ ˆçš„ä¸€åˆ‡éƒ½ä¸åŒï¼ˆç¥ç»æ¶æ„ã€è®­ç»ƒæ•°æ®ã€è®­ç»ƒç®—æ³•ï¼Œå°¤å…¶æ˜¯ä¼˜åŒ–å‹åŠ›ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬åœ¨æ™ºèƒ½é¢†åŸŸçœ‹åˆ°éå¸¸ä¸åŒçš„å®ä½“å¹¶ä¸ä»¤äººæ„å¤–ï¼Œè¿™äº›å®ä½“ä¸é€‚åˆç”¨åŠ¨ç‰©çš„è§†è§’æ¥æ€è€ƒã€‚åœ¨ç›‘ç£æ–¹é¢ï¼Œäººç±»ç¥ç»ç½‘ç»œä¼˜åŒ–ä¸ºä¸›æ—ä¸­éƒ¨è½çš„ç”Ÿå­˜ï¼Œè€Œå¤§å‹è¯­è¨€æ¨¡å‹ç¥ç»ç½‘ç»œåˆ™ä¼˜åŒ–ä¸ºæ¨¡ä»¿äººç±»æ–‡æœ¬ã€åœ¨æ•°å­¦è°œé¢˜ä¸­æ”¶é›†å¥–åŠ±ï¼Œä»¥åŠåœ¨LMç«æŠ€åœºè·å¾—äººç±»çš„èµã€‚éšç€å¯éªŒè¯åŸŸå…è®¸RLVRï¼ŒLLMåœ¨è¿™äº›åŸŸé™„è¿‘çš„èƒ½åŠ›â€œæ¿€å¢â€ï¼Œæ•´ä½“è¡¨ç°è¡¨ç°å¥‡ç‰¹ä¸”å‚å·®ä¸é½â€”â€”å®ƒä»¬æ—¢æ˜¯å¤©æ‰åšå­¦è€…ï¼Œä¹Ÿæ˜¯å›°æƒ‘ä¸”è®¤çŸ¥æœ‰éšœç¢çš„å°å­¦ç”Ÿï¼Œéšæ—¶å¯èƒ½è¢«è¶Šç‹±éª—å–æ•°æ®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca74395787e6456aa6a6d8214a13b0e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5bi9bHVmZWk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767144662&amp;x-signature=4VQIbVAdVD%2BfnnBKHKfUK1qLfUc%3D" alt="" loading="lazy"/></p>
<p>äººç±»æ™ºèƒ½ï¼šè“è‰²ï¼Œäººå·¥æ™ºèƒ½æ™ºèƒ½ï¼šçº¢è‰²ã€‚æˆ‘å–œæ¬¢è¿™ä¸ªç‰ˆæœ¬çš„æ¢—ï¼ˆæŠ±æ­‰æˆ‘ä¸¢å¤±äº†å¯¹XåŸå¸–çš„å¼•ç”¨ï¼‰ï¼Œå› ä¸ºå®ƒæŒ‡å‡ºäººç±»çš„æ™ºèƒ½ä¹Ÿæœ‰å®ƒç‹¬ç‰¹çš„é”¯é½¿çŠ¶ã€‚</p>
<p>ä¸æ­¤ç›¸å…³çš„æ˜¯æˆ‘å¯¹2025å¹´åŸºå‡†çš„æ™®éå†·æ¼ å’Œå¤±å»ä¿¡ä»»ã€‚æ ¸å¿ƒé—®é¢˜åœ¨äºåŸºå‡†æµ‹è¯•å‡ ä¹å¤©ç”Ÿå°±æ˜¯å¯éªŒè¯çš„ç¯å¢ƒï¼Œå› æ­¤å¾ˆå®¹æ˜“å—åˆ°RLVRåŠå…¶è¾ƒå¼±å½¢å¼ï¼ˆé€šè¿‡åˆæˆæ•°æ®ç”Ÿæˆï¼‰çš„å½±å“ã€‚åœ¨å…¸å‹çš„benchmaxxingè¿‡ç¨‹ä¸­ï¼ŒLLMå®éªŒå®¤çš„å›¢é˜Ÿä¸å¯é¿å…åœ°ä¼šåœ¨åµŒå…¥ç©ºé—´ä¸­åŸºå‡†æµ‹è¯•çš„å°åŒºåŸŸæ—è¾¹æ„å»ºç¯å¢ƒï¼Œå¹¶åŠ é•¿é”¯é½¿è¦†ç›–è¿™äº›åŒºåŸŸã€‚åœ¨æµ‹è¯•åœºä¸Šè®­ç»ƒæ˜¯ä¸€ç§æ–°è‰ºæœ¯å½¢å¼ã€‚</p>
<p>èƒ½è½»æ¾å®Œæˆæ‰€æœ‰åŸºå‡†æµ‹è¯•å´è¿˜æ²¡è¾¾åˆ°AGIæ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿ</p>
<p>æˆ‘åœ¨è¿™é‡Œå†™è¿‡æ›´å¤šå…³äºæœ¬èŠ‚ä¸»é¢˜çš„å†…å®¹ï¼š</p>
<ul>
<li>åŠ¨ç‰©ä¸é¬¼é­‚çš„å¯¹å†³</li>
<li>å¯éªŒè¯æ€§</li>
<li>å¿ƒçµç©ºé—´</li>
</ul>
<blockquote>
<p>æ€è€ƒï¼š</p>
<p>åœ¨AIä¸æ–­çš„ä½¿ç”¨ä¸­ï¼Œæ—©èµ·ä¹Ÿé‡åˆ°ä¸å°‘AIæ¨¡å‹å¹»è§‰é—®é¢˜ï¼Œå¦‚æœå†…å®¹é•¿äº†æˆ–è€…æœ‰äº›é—®é¢˜å›ç­”ä¸äº†äº†ï¼ŒAIè¿˜åœ¨ä¸€æœ¬æ­£ç»çš„èƒ¡è¯´å…«é“</p>
</blockquote>
<h4 data-id="heading-6">3. å…‰æ ‡/æ–°ä¸€å±‚å¤§å‹è¯­è¨€æ¨¡å‹åº”ç”¨</h4>
<p>æˆ‘è§‰å¾—Cursoræœ€å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹ï¼ˆé™¤äº†å®ƒä»Šå¹´çš„è¿…é€Ÿå´›èµ·ï¼‰æ˜¯å®ƒä»¤äººä¿¡æœåœ°æ­ç¤ºäº†â€œLLMåº”ç”¨â€çš„æ–°å±‚é¢â€”â€”äººä»¬å¼€å§‹è°ˆè®ºâ€œXçš„Cursorâ€ã€‚æ­£å¦‚æˆ‘åœ¨ä»Šå¹´çš„Yç»„åˆå™¨æ¼”è®²ä¸­å¼ºè°ƒçš„é‚£æ ·ï¼ˆé€å­—ç¨¿ä»¥åŠè§†é¢‘ï¼‰ï¼Œå¦‚Cursoræ†ç»‘å¹¶åè°ƒç‰¹å®šå‚ç›´é¢†åŸŸçš„LLMè°ƒç”¨ï¼š</p>
<ol>
<li>ä»–ä»¬åšçš„æ˜¯â€œä¸Šä¸‹æ–‡å·¥ç¨‹â€</li>
<li>ä»–ä»¬åœ¨åº•å±‚åè°ƒå¤šä¸ªLLMè°ƒç”¨ï¼Œä¸²è”åœ¨è¶Šæ¥è¶Šå¤æ‚çš„DAGä¸­ï¼Œè°¨æ…å¹³è¡¡æ€§èƒ½å’Œæˆæœ¬æƒè¡¡ã€‚</li>
<li>å®ƒä»¬ä¸ºç¯è·¯ä¸­çš„äººç±»æä¾›äº†ä¸€ä¸ªåº”ç”¨ç‰¹å®šçš„å›¾å½¢ç•Œé¢</li>
<li>ä»–ä»¬æä¾›â€œè‡ªåŠ¨æ»‘å—â€</li>
</ol>
<p>2025å¹´æœ‰å¾ˆå¤šè®¨è®ºï¼Œå…³äºè¿™ä¸ªæ–°åº”ç”¨å±‚æœ‰å¤šâ€œåšâ€ã€‚LLMå®éªŒå®¤ä¼šæ¶µç›–æ‰€æœ‰åº”ç”¨å—ï¼Ÿè¿˜æ˜¯LLMåº”ç”¨æœ‰â€œç»¿è‰åœ°â€ï¼Ÿæˆ‘ä¸ªäººè®¤ä¸ºLLMå®éªŒå®¤ä¼šåŸ¹å…»å‡ºæ™®éèƒ½åŠ›å¼ºçš„å¤§å­¦ç”Ÿï¼Œä½†LLMåº”ç”¨ä¼šé€šè¿‡æä¾›ç§æœ‰æ•°æ®ã€ä¼ æ„Ÿå™¨å’Œæ‰§è¡Œå™¨ä»¥åŠåé¦ˆå›è·¯ï¼Œç»„ç»‡ã€ä¼˜åŒ–å¹¶çœŸæ­£æ¿€æ´»LLMå›¢é˜Ÿï¼Œæˆä¸ºç‰¹å®šè¡Œä¸šçš„ä¸“ä¸šäººæ‰ã€‚</p>
<blockquote>
<p>æ€è€ƒï¼š</p>
<p>Cursor åˆšå‡ºæ¥çš„æ—¶å€™æˆ‘å°±ä¸€ç›´åœ¨ç”¨äº†ï¼Œä»2024å¹´å¼€å§‹ç”¨èµ·æ¥çš„ï¼Œä¸€ç›´åˆ°ç°åœ¨ä¹Ÿäº¤æ›¿ç€ä½¿ç”¨ï¼Œå†…ç½®çš„ä¸€äº›èƒ½åŠ›éå¸¸å¼ºå¤§ï¼Œæ€§èƒ½æ–¹é¢è¡¨ç°ç‰¹åˆ«ä¼˜ç§€ï¼Œä¼¼ä¹æ²¡æœ‰å‡ºç°æ˜æ˜¾å¡çš„é—®é¢˜ï¼Œå°¤å…¶æ˜¯Tabçš„èƒ½åŠ›ï¼Œæ˜æ˜¾ä¼˜äºå…¶ä»–å¼€å‘ç¼–è¾‘å™¨</p>
</blockquote>
<h4 data-id="heading-7">4. Claudeä»£ç /å­˜å‚¨åœ¨ä½ ç”µè„‘ä¸Šçš„AIã€‚</h4>
<p>Claude Codeï¼ˆCCï¼‰æˆä¸ºäº†ç¬¬ä¸€ä¸ªä»¤äººä¿¡æœçš„å¤§å‹è¯­è¨€æ¨¡å‹ä»£ç†ï¼ˆLLM Agentï¼‰çš„æ¼”ç¤ºâ€”â€”å®ƒä»¥ä¸€ç§å¥‡æ€ªçš„æ–¹å¼å°†å·¥å…·ä½¿ç”¨å’Œæ¨ç†ä¸²è”èµ·æ¥ï¼Œç”¨äºæ‰©å±•é—®é¢˜è§£å†³ã€‚æ­¤å¤–ï¼ŒCCå¯¹æˆ‘æ¥è¯´ç‰¹åˆ«ä¹‹å¤„åœ¨äºå®ƒè¿è¡Œåœ¨ä½ çš„ç”µè„‘ä¸Šï¼Œå¹¶ç»“åˆä½ çš„ç§äººç¯å¢ƒã€æ•°æ®å’Œä¸Šä¸‹æ–‡ã€‚æˆ‘è§‰å¾—OpenAIåšé”™äº†ï¼Œå› ä¸ºä»–ä»¬æŠŠcodex/agentå·¥ä½œé‡ç‚¹æ”¾åœ¨ChatGPTç¼–æ’çš„å®¹å™¨äº‘éƒ¨ç½²ä¸Šï¼Œè€Œä¸æ˜¯â€œlocalhostâ€ã€‚è™½ç„¶åœ¨äº‘ç«¯è¿è¡Œçš„ä»£ç†ç¾¤ä½“æ„Ÿè§‰åƒæ˜¯â€œé€šç”¨äººå·¥æ™ºèƒ½çš„ç»ˆæç›®æ ‡â€ï¼Œä½†æˆ‘ä»¬ç”Ÿæ´»åœ¨ä¸€ä¸ªä¸­ä»‹ä¸”èµ·æ­¥ç¼“æ…¢ã€èƒ½åŠ›å‚å·®ä¸é½çš„ä¸–ç•Œï¼Œæ›´åˆç†çš„åšæ³•æ˜¯ç›´æ¥åœ¨ç”µè„‘ä¸Šè¿è¡Œä»£ç†ï¼Œé…åˆå¼€å‘è€…åŠå…¶å…·ä½“é…ç½®ã€‚CCæ­£ç¡®åœ°å®‰æ’äº†ä¼˜å…ˆé¡ºåºï¼Œå¹¶å°†å…¶æ‰“åŒ…æˆä¸€ä¸ªç¾ä¸½ã€æç®€ä¸”å¼•äººå…¥èƒœçš„CLIå½¢æ€ï¼Œæ”¹å˜äº†AIçš„é¢è²Œâ€”â€”å®ƒä¸ä»…ä»…æ˜¯åƒGoogleé‚£æ ·çš„ç½‘ç«™ï¼Œè€Œæ˜¯â€œç”Ÿæ´»â€åœ¨ä½ ç”µè„‘ä¸Šçš„ä¸€ä¸ªå°çµä½“/å¹½çµã€‚è¿™æ˜¯ä¸€ç§å…¨æ–°çš„ã€ç‹¬ç‰¹çš„äººå·¥æ™ºèƒ½äº’åŠ¨èŒƒå¼ã€‚</p>
<blockquote>
<p>æ€è€ƒï¼š</p>
<p>CCæˆ‘æ²¡ç”¨è¿‡ï¼Œå‘¨å›´çš„æœ‹å‹å¾ˆå¤šäººåœ¨ç”¨ï¼Œåé¦ˆä¸é”™ï¼Œèƒ½åŠ›å¼ºå¤§</p>
</blockquote>
<h4 data-id="heading-8">5. æ°›å›´ç¼–ç </h4>
<p>2025å¹´æ˜¯äººå·¥æ™ºèƒ½è·¨è¶Šèƒ½åŠ›é—¨æ§›ï¼Œèƒ½å¤Ÿä»…å‡­è‹±è¯­æ„å»ºå„ç§ä»¤äººå°è±¡æ·±åˆ»çš„ç¨‹åºï¼Œç”šè‡³å¿˜è®°äº†ä»£ç çš„å­˜åœ¨çš„ä¸€å¹´ã€‚æœ‰è¶£çš„æ˜¯ï¼Œæˆ‘åˆ›é€ äº†â€œæ°›å›´ç¼–ç â€è¿™ä¸ªè¯è¿™ç¾¤æ€ç»ªçš„é›¨ æ¨æ–‡å®Œå…¨æ²¡æ„è¯†åˆ°äº‹æƒ…ä¼šå‘å±•åˆ°:)ã€‚åœ¨æ°›å›´ç¼–ç ä¸­ï¼Œç¼–ç¨‹å¹¶ä¸ä¸¥æ ¼åœ°åªé™äºå—è¿‡é«˜ç´ è´¨çš„ä¸“ä¸šäººå£«ï¼Œä»»ä½•äººéƒ½èƒ½åšåˆ°ã€‚åœ¨è¿™ä¸ªèº«ä»½ä¸Šï¼Œè¿™åˆæ˜¯æˆ‘åœ¨æƒåŠ›å½’äºäººæ°‘ï¼šå¤§å‹è¯­è¨€æ¨¡å‹å¦‚ä½•é¢ è¦†æŠ€æœ¯æ‰©æ•£çš„æ ¼å±€ï¼Œä»¥åŠï¼ˆä¸è¿„ä»Šä¸ºæ­¢æ‰€æœ‰å…¶ä»–æŠ€æœ¯å½¢æˆé²œæ˜å¯¹æ¯”ï¼‰æ™®é€šäººä»å¤§å‹è¯­è¨€æ¨¡å‹ä¸­å—ç›Šè¿œå¤šäºä¸“ä¸šäººå£«ã€ä¼ä¸šå’Œæ”¿åºœã€‚ä½†æ°›å›´ç¼–ç ä¸ä»…è®©æ™®é€šäººèƒ½å¤Ÿæ›´å¥½åœ°ç¼–ç¨‹ï¼Œè¿˜è®©å—è¿‡åŸ¹è®­çš„ä¸“ä¸šäººå£«èƒ½å¤Ÿç¼–å†™æ›´å¤šï¼ˆæ°›å›´ç¼–ç ï¼‰çš„è½¯ä»¶ï¼Œè¿™äº›è½¯ä»¶æœ¬æ¥æ ¹æœ¬ä¸ä¼šè¢«å†™å‡ºæ¥ã€‚åœ¨nanochaté‡Œï¼Œæˆ‘æ„Ÿè§‰è‡ªå·±ç”¨Rustç¼–å†™äº†è‡ªå®šä¹‰é«˜æ•ˆBPEåˆ†è¯å™¨ï¼Œè€Œä¸æ˜¯ç”¨ç°æœ‰åº“æˆ–åœ¨é‚£ä¸ªå±‚é¢å­¦ä¹ Rustã€‚ä»Šå¹´æˆ‘æŠŠå¾ˆå¤šé¡¹ç›®éƒ½å†™æˆäº†å¿«é€Ÿåº”ç”¨æ¼”ç¤ºï¼Œå±•ç¤ºæˆ‘æƒ³å®ç°çš„ä¸œè¥¿ï¼ˆä¾‹å¦‚ï¼šå‚è§èœå•,LLMç†äº‹ä¼š,è¯»è€…3,HN æ—¶é—´èƒ¶å›Š).æˆ‘ç”šè‡³å°è¯•ç¼–å†™è¿‡æ•´ä¸ªçŸ­æš‚åº”ç”¨ï¼Œåªä¸ºæ‰¾åˆ°ä¸€ä¸ªæ¼æ´ï¼Œå› ä¸ºä¸ºä»€ä¹ˆä¸å‘¢â€”â€”ä»£ç çªç„¶å˜å¾—å…è´¹ã€çŸ­æš‚ã€å¯å¡‘ã€ä¸€æ¬¡æ€§ä½¿ç”¨åå¯ä»¥ä¸¢å¼ƒã€‚Vibeç¼–ç ä¼šæ”¹é€ è½¯ä»¶å¹¶æ”¹å˜èŒä½æè¿°ã€‚</p>
<blockquote>
<p>æ€è€ƒï¼š</p>
<p>è¿™æ˜¯ä»Šå¹´æœ€ç«çš„ä¸€ä¸ªæƒ…å†µäº†ï¼ŒAIç¼–ç¨‹åº”ç”¨èƒ½åŠ›çš„å¤§å¹…æå‡ï¼Œé‡æ–°å®šä¹‰äº†è½¯ä»¶å¼€å‘çš„èŒƒå¼ï¼Œéå¼€å‘äººå‘˜ä¹Ÿèƒ½å¼€å‘è½¯ä»¶ï¼ŒåƒTraeè¿™ç§æ—©å°±å†…ç½®äº†è¯­éŸ³è½¬æ–‡å­—çš„è¾“å…¥åŠŸèƒ½ï¼Œå¥½å¤šè¿œç¨‹å·¥ä½œè€…ï¼Œç‹¬ç«‹äº§å“åˆ¶ä½œè€…åŠ¨åŠ¨å˜´å°±èƒ½å¼€å‘è½¯ä»¶äº†</p>
</blockquote>
<h4 data-id="heading-9">6. çº³ç±³é¦™è•‰ / LLM å›¾å½¢ç•Œé¢</h4>
<p>è°·æ­ŒGemini Nanoé¦™è•‰æ˜¯2025å¹´æœ€ä»¤äººéš¾ä»¥ç½®ä¿¡ã€æœ€å…·èŒƒå¼è½¬å˜æ€§çš„å‹å·ä¹‹ä¸€ã€‚åœ¨æˆ‘çœ‹æ¥ï¼ŒLLMæ˜¯ä¸‹ä¸€ä¸ªä¸»è¦çš„è®¡ç®—èŒƒå¼ï¼Œç±»ä¼¼äº1970å¹´ä»£ã€80å¹´ä»£çš„è®¡ç®—æœºã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°åŸºäºæ ¹æœ¬ç›¸ä¼¼åŸå› çš„ç±»ä¼¼åˆ›æ–°ã€‚æˆ‘ä»¬å°†çœ‹åˆ°ç±»ä¼¼ä¸ªäººè®¡ç®—ã€å¾®æ§åˆ¶å™¨ï¼ˆè®¤çŸ¥æ ¸å¿ƒï¼‰æˆ–äº’è”ç½‘ï¼ˆæ™ºèƒ½ä½“ï¼‰ç­‰ç­‰ç‰©å‡ºç°ã€‚ç‰¹åˆ«æ˜¯åœ¨UIUXæ–¹é¢ï¼Œä¸LLMè¿›è¡Œâ€œèŠå¤©â€æœ‰ç‚¹åƒ1980å¹´ä»£å‘è®¡ç®—æœºæ§åˆ¶å°ä¸‹è¾¾å‘½ä»¤ã€‚æ–‡æœ¬æ˜¯è®¡ç®—æœºï¼ˆå’Œå¤§å‹è¯­è¨€æ¨¡å‹ï¼‰æœ€å¸¸ç”¨çš„åŸå§‹æ•°æ®è¡¨ç¤ºæ–¹å¼ï¼Œä½†å¯¹ç”¨æˆ·æ¥è¯´ï¼Œå°¤å…¶æ˜¯åœ¨è¾“å…¥ç«¯ï¼Œå®ƒå¹¶ä¸æ˜¯é¦–é€‰æ ¼å¼ã€‚äººä»¬å…¶å®ä¸å–œæ¬¢è¯»æ–‡å­—â€”â€”å®ƒç¼“æ…¢ä¸”è´¹åŠ›ã€‚ç›¸åï¼Œäººä»¬å–œæ¬¢è§†è§‰å’Œç©ºé—´ä¸Šè·å–ä¿¡æ¯ï¼Œè¿™ä¹Ÿæ˜¯ä¼ ç»Ÿè®¡ç®—æœºä¸­å›¾å½¢ç•Œé¢ï¼ˆGUIï¼‰è¢«å‘æ˜çš„åŸå› ã€‚åŒæ ·ï¼ŒLLMä¹Ÿåº”è¯¥ä»¥æˆ‘ä»¬å–œæ¬¢çš„å½¢å¼ä¸æˆ‘ä»¬å¯¹è¯â€”â€”é€šè¿‡å›¾ç‰‡ã€ä¿¡æ¯å›¾è¡¨ã€å¹»ç¯ç‰‡ã€ç™½æ¿ã€åŠ¨ç”»/è§†é¢‘ã€ç½‘é¡µåº”ç”¨ç­‰å½¢å¼ã€‚å½“ç„¶ï¼Œæ—©æœŸå’Œç°åœ¨çš„ç‰ˆæœ¬æ˜¯åƒè¡¨æƒ…ç¬¦å·å’ŒMarkdownè¿™æ ·çš„å·¥å…·ï¼Œå®ƒä»¬ç”¨æ¥â€œè£…é¥°â€æ–‡å­—ï¼Œç”¨æ ‡é¢˜ã€åŠ ç²—ã€æ–œä½“ã€åˆ—è¡¨ã€è¡¨æ ¼ç­‰æ–¹å¼ç›´è§‚åœ°æ’ç‰ˆï¼Œæ–¹ä¾¿ä½¿ç”¨ã€‚ä½†åˆ°åº•æ˜¯è°æ¥æ„å»ºLLMå›¾å½¢ç•Œé¢å‘¢ï¼Ÿåœ¨è¿™ç§ä¸–ç•Œè§‚ä¸­ï¼Œçº³ç±³é¦™è•‰æ˜¯å…¶å¯èƒ½é¢è²Œçš„æœ€åˆæ—©æœŸæš—ç¤ºã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè¿™ä¸ä»…ä»…æ˜¯å›¾åƒç”Ÿæˆæœ¬èº«çš„é—®é¢˜ï¼Œè€Œæ˜¯æ–‡æœ¬ç”Ÿæˆã€å›¾åƒç”Ÿæˆå’Œä¸–ç•ŒçŸ¥è¯†çš„è”åˆèƒ½åŠ›ï¼Œè¿™äº›éƒ½äº¤ç»‡åœ¨æ¨¡å‹æƒé‡ä¸­ã€‚</p>
<blockquote>
<p>æ€è€ƒï¼š</p>
<p>Nano Banana çš„å‡ºç°ï¼Œè®©åˆ›ä½œæ›´æ–¹ä¾¿ï¼Œæ›´æœ‰è¶£ï¼Œçœ‹äº†ä¸€äº›åˆ«äººçš„ä½œå“ï¼Œè¡¨ç°å¤ªç§€äº†ï¼Œè¯´ä»€ä¹ˆç”Ÿæˆä»€ä¹ˆï¼Œå¾ˆå¤šå¥‡æ€å¦™æƒ³éƒ½å€¼å¾—ä¸€è¯•</p>
</blockquote>
<h4 data-id="heading-10">æ€»ç»“</h4>
<p>æ€»ç»“ä¸€ä¸‹ã€‚2025å¹´æ˜¯å¤§å‹è¯­è¨€æ¨¡å‹ä»¤äººå…´å¥‹ä¸”ç•¥å¸¦æƒŠå–œçš„ä¸€å¹´ã€‚å¤§å‹è¯­è¨€æ¨¡å‹ä½œä¸ºä¸€ç§æ–°å‹æ™ºèƒ½å‡ºç°ï¼Œæ—¢æ¯”æˆ‘é¢„æœŸçš„èªæ˜å¾—å¤šï¼Œåˆæ¯”æˆ‘é¢„æƒ³çš„ç¬¨å¾—å¤šã€‚æ— è®ºå¦‚ä½•ï¼Œå®ƒä»¬éå¸¸æœ‰ç”¨ï¼Œæˆ‘è®¤ä¸ºå³ä½¿ä»¥ç›®å‰çš„èƒ½åŠ›ï¼Œè¡Œä¸šä¹Ÿè¿œæœªå®ç°å…¶æ½œåŠ›çš„10%ã€‚ä¸æ­¤åŒæ—¶ï¼Œæœ‰å¤ªå¤šæƒ³æ³•å¯ä»¥å°è¯•ï¼Œä»æ¦‚å¿µä¸Šçœ‹ï¼Œè¿™ä¸ªé¢†åŸŸçœ‹èµ·æ¥éå¸¸å¼€æ”¾ã€‚æ­£å¦‚æˆ‘åœ¨ Dwarkesh pod ä»Šå¹´æ—©äº›æ—¶å€™ï¼Œæˆ‘åŒæ—¶ï¼ˆè¡¨é¢ä¸Šçœ‹ä¼¼çŸ›ç›¾åœ°ï¼‰ç›¸ä¿¡æˆ‘ä»¬ä¼šçœ‹åˆ°å¿«é€Ÿä¸”æŒç»­çš„è¿›æ­¥ï¼Œ<em>ä½†</em>ä»ç„¶æœ‰å¾ˆå¤šå·¥ä½œè¦åšã€‚ç³»å¥½å®‰å…¨å¸¦ã€‚</p>
<blockquote>
<p>æ€è€ƒï¼š</p>
<p>2025å¹´ï¼ŒAIå„ä¸ªæ–¹é¢éƒ½å‘ç”Ÿäº†ç¿»å¤©è¦†åœ°çš„å˜åŒ–ï¼ŒAIæ­£åœ¨æ”¹å˜æˆ‘ä»¬çš„ä¸€åˆ‡ï¼Œç§¯ææ‹¥æŠ±AIï¼Œæ‹¥æŠ±å˜åŒ–</p>
</blockquote>
<h3 data-id="heading-11">Xæ¨æ–‡é“¾æ¥</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fkarpathy%2Fstatus%2F2002118205729562949" target="_blank" title="https://x.com/karpathy/status/2002118205729562949" ref="nofollow noopener noreferrer">x.com/karpathy/stâ€¦</a></p>
<blockquote>
<p>æ¬¢è¿ç•™è¨€äº¤æµï¼Œå¦‚æœè§‰å¾—æœ‰å¸®åŠ©ï¼Œå¯ä»¥<code>ç‚¹ä¸ªèµ</code>æ”¯æŒä¸€ä¸‹</p>
<p>å…¬ä¼—å·ï¼šè‰å¸½lufei</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å…³äºæˆ‘80%çš„ä»£ç éƒ½ç”¨AIç”Ÿæˆè¿™ä»¶äº‹]]></title>    <link>https://juejin.cn/post/7586851351470587944</link>    <guid>https://juejin.cn/post/7586851351470587944</guid>    <pubDate>2025-12-24T01:50:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586851351470587944" data-draft-id="7587175302347292707" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å…³äºæˆ‘80%çš„ä»£ç éƒ½ç”¨AIç”Ÿæˆè¿™ä»¶äº‹"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,å…¨æ ˆ,ä»£ç è§„èŒƒ"/> <meta itemprop="datePublished" content="2025-12-24T01:50:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="realze"/> <meta itemprop="url" content="https://juejin.cn/user/976022052805805"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å…³äºæˆ‘80%çš„ä»£ç éƒ½ç”¨AIç”Ÿæˆè¿™ä»¶äº‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/976022052805805/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    realze
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T01:50:40.000Z" title="Wed Dec 24 2025 01:50:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    30
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘ä¸€æ®µæ—¶é—´ï¼ŒåŸºæœ¬çš„ä»£ç å¼€å‘éƒ½ä½¿ç”¨äº†Claude Codeï¼ŒåŒ…æ‹¬ä¸¤ä¸ªAndroidåŸç”Ÿé¡¹ç›®ã€ä¸€ä¸ªJava Spring Bootåç«¯é¡¹ç›®ã€ä¸€ä¸ªReact+Antdçš„å‰åç«¯é¡¹ç›®ã€ä¸€ä¸ªPythonçš„åç«¯é¡¹ç›®ï¼Œå…¶ä¸­å¤§æ¦‚80%çš„ä»£ç éƒ½æ˜¯AIç”Ÿæˆçš„ï¼Œè¯´å®è¯ï¼Œè¦æ˜¯ä¹‹å‰ï¼Œè¿™äº›éšä¾¿ä¸€ä¸ªæ‹¿å‡ºæ¥éƒ½è¦å¼„ä¸€ä¸¤ä¸ªæ˜ŸæœŸç”šè‡³ä¸€ä¸¤ä¸ªæœˆï¼Œä½†æ˜¯AIå¤§æ¦‚æ˜¯ä¸€ä¸¤å¤©ï¼ŒçœŸçš„æ˜¯å¿«å•Šã€‚ä¸‹é¢æ€»ç»“ä¸‹ä½¿ç”¨ç»éªŒ</p>
<p>æ€•ä½ çœ‹ä¸å®Œï¼Œå…ˆæ”¾ç™½å«–é“¾æ¥ <a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.code-relay.com%2Fregister%3Faff%3DudRx" target="_blank" title="https://api.code-relay.com/register?aff=udRx" ref="nofollow noopener noreferrer">ç‚¹å‡»è¿™é‡Œæ³¨å†Œè·Ÿæˆ‘ç™½å«–</a></p>
<hr/>
<h2 data-id="heading-0">AI ç¼–ç æ—¶ä»£ï¼šæ€æ ·è®© Claude å†™å‡ºæ›´ç¬¦åˆéœ€æ±‚çš„ä»£ç ï¼Ÿ</h2>
<p>AI ç¼–ç æ—¶ä»£å·²ç»ä»â€œèƒ½ä¸èƒ½å†™â€è¿›å…¥â€œå†™å¾—å¥½ä¸å¥½â€çš„é˜¶æ®µã€‚æƒ³è®©å¯¹è¯å¼ AI æˆä¸ºçœŸæ­£çš„ç”Ÿäº§åŠ›ï¼Œä¸æ˜¯ç®€å•ä¸¢ä¸€å¥â€œå¸®æˆ‘å†™ä»£ç â€ï¼Œè€Œæ˜¯è¦å­¦ä¼š<strong>å¦‚ä½•åƒå¯¹å·¥ç¨‹å¸ˆä¸€æ ·ç»™å®ƒéœ€æ±‚ã€èƒŒæ™¯ã€çº¦æŸä¸ä¸Šä¸‹æ–‡</strong>ã€‚</p>
<p>ç‰¹åˆ«æ˜¯ Claude è¿™ç§å¼ºé€»è¾‘å‹æ¨¡å‹ï¼Œå¦‚æœä½ ç»™çš„æ–¹æ³•æ­£ç¡®ï¼Œå®ƒèƒ½å†™å‡ºéå¸¸è´´åˆä¸šåŠ¡ã€ç»“æ„æ¸…æ™°ä¸”ç¨³å®šå¯è¿è¡Œçš„ä»£ç ã€‚æœ¬ç¯‡æ–‡ç« ä¸“é—¨è®²ï¼š<strong>æ€æ ·è®© Claude å†™å‡ºæ›´ç¬¦åˆéœ€æ±‚çš„ä»£ç ï¼Ÿ</strong></p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€Claude å†™ä»£ç çš„å‰æï¼šä¸è¦è®©å®ƒâ€œçŒœâ€</h2>
<p>æ‰€æœ‰ AI å†™ä»£ç çš„é—®é¢˜ï¼Œæœ¬è´¨éƒ½æ˜¯ä¸€ä¸ªåŸå› ï¼š<br/>
<strong>å®ƒä¸çŸ¥é“ä½ çœŸæ­£æƒ³è¦ä»€ä¹ˆï¼Œæœ€ååªèƒ½è‡ªå·±çŒœã€‚</strong></p>
<p>è¦é¿å…å®ƒçŒœï¼Œä½ å¿…é¡»æ˜ç¡®å‘Šè¯‰å®ƒï¼š</p>
<h3 data-id="heading-2">1. ä½ çš„åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<ul>
<li>æ˜¯ä¼ä¸šé¡¹ç›®è¿˜æ˜¯å­¦ä¹  demoï¼Ÿ</li>
<li>é¢å‘é«˜å¹¶å‘è¿˜æ˜¯å†…éƒ¨å·¥å…·ï¼Ÿ</li>
<li>æ˜¯å¦è¦ä¸ç°æœ‰è€ç³»ç»Ÿå…¼å®¹ï¼Ÿ</li>
</ul>
<h3 data-id="heading-3">2. ä½ å¸Œæœ›ç”¨ä»€ä¹ˆæŠ€æœ¯æ ˆï¼Ÿ</h3>
<p>AI ä¸ä¼šçŸ¥é“ä½ å…¬å¸ç”¨ï¼šJavaï¼ŸNodeï¼ŸGoï¼ŸKotlinï¼Ÿ</p>
<p>ä½ å¿…é¡»æ˜ç¡®å‘ŠçŸ¥ï¼š</p>
<blockquote>
<p>â€œåç«¯ç”¨ Spring Boot 3ï¼Œæ•°æ®åº“ç”¨ MySQLï¼Œè¦æ±‚ä½¿ç”¨ MyBatisã€‚â€</p>
</blockquote>
<p>å¦åˆ™ AI ä¼šé»˜è®¤â€œæœ€ä½³å®è·µâ€ï¼Œä½†ä¸ä¸€å®šé€‚åˆä½ ã€‚</p>
<h3 data-id="heading-4">3. ä»£ç è¾“å‡ºçš„â€œç²’åº¦â€æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>ä½ åˆ°åº•è¦ï¼š</p>
<ul>
<li>å…¨é¡¹ç›®è„šæ‰‹æ¶ï¼Ÿ</li>
<li>å•ä¸ª classï¼Ÿ</li>
<li>å•ä¸ª APIï¼Ÿ</li>
<li>å…¬å…±æ–¹æ³•ï¼Ÿ</li>
<li>æˆ–è€…åªè¦é€»è¾‘ä¼ªä»£ç ï¼Ÿ</li>
</ul>
<p>è¾“å…¥æ—¶å¿…é¡»æ˜ç¡®ï¼Œå¦åˆ™ AI ä¼šè¿‡åº¦ï¼ˆç»™ä½ ä¸€ä¸ªå¤§é¡¹ç›®ï¼‰æˆ–ä¸è¶³ï¼ˆåªç»™ä½ å‡ è¡Œå‡½æ•°ï¼‰ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<blockquote>
<p>â€œæˆ‘å¸Œæœ›ä½ è¾“å‡ºä¸€ä¸ª<strong>å¯ç›´æ¥æ”¾å…¥ Spring Boot é¡¹ç›®çš„ Controller + Service + Mapper</strong>ï¼Œé¡¹ç›®ä½¿ç”¨ MyBatisï¼Œä¸è¦å†™ main æ–‡ä»¶ã€‚â€</p>
</blockquote>
<hr/>
<h2 data-id="heading-5">äºŒã€Claude å†™ä»£ç çš„æ ¸å¿ƒæŠ€å·§ï¼š <strong>â€œäº”æ®µå¼è¯·æ±‚æ³•â€</strong></h2>
<p>æˆ‘æ€»ç»“äº†è®© Claude è¾“å‡ºé«˜è´¨é‡ä»£ç çš„æœ€ä½³å¥—è·¯ï¼Œå«åšï¼š</p>
<h2 data-id="heading-6">ğŸŸ¦ äº”æ®µå¼è¯·æ±‚æ³•</h2>
<hr/>
<h3 data-id="heading-7"><strong>â‘  èƒŒæ™¯ï¼ˆBackgroundï¼‰</strong></h3>
<p>å‘Šè¯‰å®ƒä¸ºä»€ä¹ˆå†™è¿™ä¸ªä»£ç ï¼Œå±äºå“ªä¸ªç³»ç»Ÿã€‚</p>
<p>ä¾‹ï¼š</p>
<blockquote>
<p>â€œæˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªä¼šå‘˜ç³»ç»Ÿï¼Œæ”¯æŒç”¨æˆ·å……å€¼ç§¯åˆ†ã€‚â€</p>
</blockquote>
<hr/>
<h3 data-id="heading-8"><strong>â‘¡ éœ€æ±‚ï¼ˆRequirementsï¼‰</strong></h3>
<p>è¯¦ç»†å†™åŠŸèƒ½ç‚¹ï¼Œç”¨åˆ—è¡¨éå¸¸æœ‰æ•ˆã€‚</p>
<p>ä¾‹ï¼š</p>
<ul>
<li>ç”¨æˆ·è¾“å…¥ userId å’Œ amount</li>
<li>æ ¡éªŒé‡‘é¢ &gt; 0</li>
<li>å°†ç§¯åˆ†ç´¯è®¡åˆ°ç”¨æˆ·è´¦æˆ·</li>
<li>è®°å½•å……å€¼æ—¥å¿—</li>
<li>å¤±è´¥æ—¶å›æ»šäº‹åŠ¡</li>
</ul>
<hr/>
<h3 data-id="heading-9"><strong>â‘¢ çº¦æŸï¼ˆConstraintsï¼‰</strong></h3>
<p>å‘Šè¯‰ Claudeï¼šå¿…é¡»æ€ä¹ˆå†™ã€‚</p>
<p>è¿™æ˜¯æå‡ä»£ç è´¨é‡çš„å…³é”®ã€‚</p>
<p>ä¾‹ï¼š</p>
<ul>
<li>ä½¿ç”¨ Spring Boot 3</li>
<li>å¿…é¡»åˆ† Controller / Service / Mapper</li>
<li>Mapper ä½¿ç”¨ MyBatis XML</li>
<li>è¿”å›ç»Ÿä¸€æ ¼å¼ Result</li>
<li>ä¸èƒ½çœç•¥å¼‚å¸¸å¤„ç†ä¸äº‹åŠ¡</li>
</ul>
<hr/>
<h3 data-id="heading-10"><strong>â‘£ ä¸Šä¸‹æ–‡ï¼ˆContextï¼‰</strong></h3>
<p>æŠŠå·²æœ‰æ–‡ä»¶è´´è¿›å»ï¼Œè®© Claude å‚è€ƒä¸€è‡´é£æ ¼ã€‚</p>
<p>ä¾‹ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Result</span>&lt;T&gt; {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> code;
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> message;
    <span class="hljs-keyword">private</span> T data;
}
</code></pre>
<p>Claude å°±ä¼šè‡ªåŠ¨ç”¨ä½ çš„ç»“æ„ã€‚</p>
<p>ä¸Šä¸‹æ–‡è¶Šå…¨ï¼ŒClaude å†™å¾—è¶Šå‡†ã€‚</p>
<hr/>
<h3 data-id="heading-11"><strong>â‘¤ è¾“å‡ºæ ¼å¼ï¼ˆOutput Formatï¼‰</strong></h3>
<p>å‘Šè¯‰å®ƒæ€ä¹ˆè¾“å‡ºï¼Œå¦åˆ™ä¼šåˆåœ¨ä¸€èµ·æ— æ³•ç›´æ¥ä½¿ç”¨ã€‚</p>
<p>ä¾‹ï¼š</p>
<blockquote>
<p>â€œè¯·åˆ†æˆ 3 æ®µè¿”å›ï¼šControllerï¼ŒServiceï¼ŒMapper XMLï¼Œç”¨ä»£ç å—åˆ†å¼€ã€‚â€</p>
</blockquote>
<p>Claude ä¼šç…§åšã€‚</p>
<hr/>
<h3 data-id="heading-12">â­ å®æˆ˜æ•ˆæœ</h3>
<p>ä½¿ç”¨â€œäº”æ®µå¼è¯·æ±‚æ³•â€åï¼ŒClaude è¾“å‡ºçš„ä»£ç ï¼š</p>
<ul>
<li>100% ç¬¦åˆä½ çš„æŠ€æœ¯æ ˆ</li>
<li>ç»“æ„å®Œæ•´ä¸”å¯ç›´æ¥ç²˜è´´</li>
<li>ä¸ç°æœ‰é¡¹ç›®é£æ ¼ä¸€è‡´</li>
<li>ä¸ä¹±ç¼– APIã€ä¾èµ–æ˜æ˜¾å‡å°‘</li>
<li>å‡ºç° bug çš„æ¦‚ç‡å¤§å¹…é™ä½</li>
</ul>
<hr/>
<h2 data-id="heading-13">ä¸‰ã€è®© Claude å†™å‡ºâ€œåƒèµ„æ·±å·¥ç¨‹å¸ˆâ€çš„ä»£ç  = ç»™å®ƒæ›´å¤šä¸Šä¸‹æ–‡</h2>
<p>Claude çš„çœŸæ­£å¼ºé¡¹æ˜¯ï¼š<br/>
<strong>èƒ½åŸºäºä¸Šä¸‹æ–‡å­¦ä¹ ä½ çš„é¡¹ç›®é£æ ¼ï¼Œç„¶åå®Œå…¨æ¨¡ä»¿ã€‚</strong></p>
<p>ä½ ç»™å®ƒä»€ä¹ˆé£æ ¼ï¼Œå®ƒå°±å†™ä»€ä¹ˆé£æ ¼ã€‚</p>
<p>è¿™æ„å‘³ç€ï¼š</p>
<blockquote>
<p>æŠŠä½ ä»¬é¡¹ç›®ä¸­â€œå†™å¾—å¥½çš„ä»£ç â€è´´ç»™ Claudeï¼Œå®ƒä¼šè‡ªåŠ¨æ¨¡ä»¿æ¶æ„ã€æ¥å£ã€å˜é‡å‘½åã€é”™è¯¯å¤„ç†æ–¹å¼ã€‚</p>
</blockquote>
<p>ç”šè‡³ä½ å¯ä»¥è¦æ±‚ï¼š</p>
<blockquote>
<p>â€œä»ç°åœ¨å¼€å§‹ï¼Œä½ å†™ä»£ç è¦åƒä¸‹é¢è¿™ä½å·¥ç¨‹å¸ˆä¸€æ ·ï¼šâ€</p>
</blockquote>
<p>ç„¶åè´´ä¸Šï¼š</p>
<ul>
<li>ä½ ä»¬å›¢é˜Ÿçš„å¼€å‘è§„èŒƒæ–‡æ¡£</li>
<li>é¡¹ç›®ç›®å½•ç»“æ„</li>
<li>ç¤ºä¾‹ API</li>
<li>æ•°æ®åº“è®¾è®¡</li>
<li>æ—¥å¿—ä¸å¼‚å¸¸å¤„ç†æ¨¡æ¿</li>
</ul>
<p>Claude ä¼šè‡ªåŠ¨â€œå­¦ä¹ â€ä½ çš„é¡¹ç›®å¹¶ä¿æŒä¸€è‡´ã€‚</p>
<p>è¿™æ˜¯ Claude å’Œå…¶å®ƒæ¨¡å‹æœ€å¤§çš„å·®å¼‚ï¼š<br/>
<strong>Claude çš„é£æ ¼æ¨¡ä»¿èƒ½åŠ›éå¸¸å¼ºï¼Œéå¸¸é€‚åˆé•¿æœŸé¡¹ç›®å¼€å‘ã€‚</strong></p>
<hr/>
<h2 data-id="heading-14">å››ã€è¶Šå¤§å‹çš„ä»»åŠ¡è¶Šè¦â€œåˆ†æ­¥â€è®© Claude åš</h2>
<p>ä¸è¦ä¸€æ¬¡æ€§è®© Claude æ•´ä¸ªç³»ç»Ÿï¼Œä½ ä¼šå¾—åˆ°ï¼š</p>
<p>âŒ å¤ªå¤§ã€ä½ æ ¹æœ¬æ— æ³•ç”¨<br/>
âŒ AI ä¼šå¼€å§‹è„‘è¡¥å’ŒçŒœ</p>
<p>æ­£ç¡®æ–¹å¼ï¼š</p>
<ol>
<li><strong>å…ˆè®©å®ƒç”Ÿæˆæ¥å£è®¾è®¡ï¼ˆAPI Specï¼‰</strong></li>
<li><strong>ç¡®è®¤æ— è¯¯åï¼Œè®©å®ƒç”Ÿæˆæ•°æ®ç»“æ„ï¼ˆDTO/VOï¼‰</strong></li>
<li><strong>å†è®©å®ƒå†™ Service å±‚</strong></li>
<li><strong>å†å†™ Mapper</strong></li>
<li><strong>æœ€åæ‹¼æˆä¸€ä¸ªæ¨¡å—</strong></li>
</ol>
<p>Claude éå¸¸é€‚åˆâ€œé€æ®µå®ç°â€ï¼Œä½ åªéœ€ä¸æ–­ç»™å®ƒï¼š</p>
<blockquote>
<p>â€œè¿™é‡Œå†™å¾—ä¸é”™ï¼Œè¯·ç»§ç»­ä¸‹ä¸€éƒ¨åˆ†ã€‚â€</p>
</blockquote>
<p>è¿™æ ·ä½ çš„ä»£ç èƒ½ 100% ç¬¦åˆéœ€æ±‚ã€‚</p>
<hr/>
<h2 data-id="heading-15">äº”ã€Claude å†™ä»£ç æ—¶æœ€é‡è¦çš„ä¸‰å¥é­”æ³•æç¤º</h2>
<p>ä»¥ä¸‹ä¸‰å¥è¯æå‡æ•ˆæœå·¨å¤§ï¼š</p>
<hr/>
<h4 data-id="heading-16">â‘  <strong>â€œè¯·æŒ‰å¯ç›´æ¥è¿è¡Œçš„ç”Ÿäº§ä»£ç æ ‡å‡†ç¼–å†™ï¼Œä¸èƒ½ä½¿ç”¨ä¼ªä»£ç ã€‚â€</strong></h4>
<p>é¿å…å®ƒå†™â€œç¤ºä¾‹é€»è¾‘â€â€œä¼ªä»£ç â€â€œTODOâ€ã€‚</p>
<hr/>
<h4 data-id="heading-17">â‘¡ <strong>â€œè¯·ä¸¥æ ¼éµå®ˆæˆ‘ç»™å‡ºçš„æŠ€æœ¯æ ˆï¼Œä¸å…è®¸ä½¿ç”¨æœªæŒ‡å®šçš„ä¾èµ–æˆ–æ¡†æ¶ã€‚â€</strong></h4>
<p>é¿å…ä¹±ç”¨åº“ã€‚</p>
<hr/>
<h4 data-id="heading-18">â‘¢ <strong>â€œè¯·å…ˆæå‡º 3 ä¸ªä½ è®¤ä¸ºå­˜åœ¨æ­§ä¹‰çš„åœ°æ–¹ï¼Œæˆ‘ç¡®è®¤åå†å†™ä»£ç ã€‚â€</strong></h4>
<p>è¿™æ˜¯æœ€å¼ºæŠ€å·§ä¹‹ä¸€ã€‚<br/>
Claude ä¼šå…ˆé—®ä½ ï¼š</p>
<ul>
<li>é”™è¯¯æƒ…å†µè¦å¦‚ä½•å¤„ç†ï¼Ÿ</li>
<li>æ—¥å¿—æ ¼å¼ï¼Ÿ</li>
<li>è¿”å›ç»“æ„å¦‚ä½•ï¼Ÿ</li>
<li>æ˜¯å¦éœ€è¦äº‹åŠ¡ï¼Ÿ</li>
</ul>
<p>ä½ ç¡®è®¤åï¼Œå®ƒå†™çš„ä»£ç ä¼šå®Œç¾è´´åˆä½ çš„çœŸå®éœ€æ±‚ã€‚</p>
<hr/>
<h2 data-id="heading-19">å…­ã€æ€»ç»“ï¼šè¦è®© Claude å†™å¥½ä»£ç ï¼Œä½ è¦ï¼š</h2>
<p>âœ” ç»™èƒŒæ™¯<br/>
âœ” ç»™éœ€æ±‚<br/>
âœ” ç»™çº¦æŸ<br/>
âœ” ç»™ä¸Šä¸‹æ–‡<br/>
âœ” ç»™è¾“å‡ºæ ¼å¼<br/>
âœ” åˆ†æ­¥éª¤å¼€å‘ï¼Œä¸ä¸€æ¬¡æ€§è¾“å‡º<br/>
âœ” é¿å…è®© AI è‡ªå·±çŒœ</p>
<p>å½“ä½ æŒæ¡è¿™äº›æŠ€å·§åï¼ŒClaude å°±åƒä¸€ä¸ªï¼š</p>
<p><strong>â€œèƒ½è¯»æ‡‚ä½ æ¯å¥è¯ã€å¹¶å‡†ç¡®æŒ‰ç…§ä½ å…¬å¸è§„èŒƒå†™ä»£ç çš„é«˜çº§å·¥ç¨‹å¸ˆâ€ã€‚</strong></p>
<hr/>
<h2 data-id="heading-20">æœ€ååˆ†äº«ä¸‹ç™½å«–çš„Claude Code</h2>
<p>æˆ‘æ˜¯ç”¨ç¬¬ä¸‰æ–¹çš„ä¸­è½¬ç«™çš„ï¼Œä¸€å¼€å§‹æ³¨å†Œæœ‰125åˆ€çš„é¢åº¦ï¼Œçœç‚¹ç”¨è¿˜èƒ½ç”¨æŒºä¹…çš„ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.code-relay.com%2Fregister%3Faff%3DudRx" target="_blank" title="https://api.code-relay.com/register?aff=udRx" ref="nofollow noopener noreferrer">ç‚¹å‡»è¿™é‡Œæ³¨å†Œè·Ÿæˆ‘ç™½å«–</a>ï¼Œé‚€è¯·äººä¹Ÿæœ‰é€é¢åº¦ï¼Œä¾‹å¦‚æˆ‘è¿™ä¸ªé‚€è¯·é“¾æ¥</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[GLM-4.7 vs MiniMax-M2.1ï¼šä»£ç å·¥ç¨‹ç†è§£]]></title>    <link>https://juejin.cn/post/7586892413891067950</link>    <guid>https://juejin.cn/post/7586892413891067950</guid>    <pubDate>2025-12-23T16:06:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586892413891067950" data-draft-id="7586893663076220938" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="GLM-4.7 vs MiniMax-M2.1ï¼šä»£ç å·¥ç¨‹ç†è§£"/> <meta itemprop="keywords" content="AIç¼–ç¨‹,æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-23T16:06:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é£Ÿå°˜è€…"/> <meta itemprop="url" content="https://juejin.cn/user/4075235699079676"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            GLM-4.7 vs MiniMax-M2.1ï¼šä»£ç å·¥ç¨‹ç†è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4075235699079676/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é£Ÿå°˜è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-23T16:06:33.000Z" title="Tue Dec 23 2025 16:06:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»19åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1 ç¯å¢ƒä¿¡æ¯</h2>
<ul>
<li>æ“ä½œç³»ç»Ÿï¼šwindows 10</li>
<li>AI ç¼–ç¨‹å·¥å…·ï¼šClaude Code 2.0.42</li>
<li>æ¨¡å‹ä¿¡æ¯
<ul>
<li>GLM-4.7ï¼šå›½å†…å®˜ç½‘ï¼ŒCoding Plan å¥—é¤ã€‚</li>
<li>MiniMax-M2.1ï¼šå›½å¤–å®˜ç½‘ï¼ŒCoding Plan å¥—é¤ã€‚</li>
</ul>
</li>
</ul>
<h2 data-id="heading-1">2 ç»“è®ºå…ˆè¡Œ</h2>
<h3 data-id="heading-2">2.1 è¯„åˆ†æ±‡æ€»</h3>











































































<table><thead><tr><th>åœºæ™¯</th><th>æ¨¡å‹</th><th>æŠ€æœ¯æ ˆè¯†åˆ«</th><th>æ¶æ„ç†è§£æ·±åº¦</th><th>è§„èŒƒå®Œæ•´æ€§</th><th>è¾“å‡ºä¸“ä¸šæ€§</th><th>å®ç”¨æ€§</th><th><strong>æ€»åˆ†</strong></th></tr></thead><tbody><tr><td><strong>åç«¯ï¼šNestJS+TypeScript+Fastify</strong></td><td>MiniMax-M2.1</td><td>5</td><td>5</td><td>5</td><td>5</td><td>5</td><td><strong>25</strong></td></tr><tr><td/><td>GLM-4.7</td><td>5</td><td>5</td><td>5</td><td>5</td><td>5</td><td><strong>25</strong></td></tr><tr><td><strong>åç«¯ï¼šJava+Spring Boot2</strong></td><td>MiniMax-M2.1</td><td>4</td><td>3</td><td>3</td><td>3</td><td>3</td><td><strong>16</strong></td></tr><tr><td/><td>GLM-4.7</td><td>5</td><td>5</td><td>5</td><td>5</td><td>5</td><td><strong>25</strong></td></tr><tr><td><strong>å‰ç«¯ï¼šVue3+TypeScript+Vite</strong></td><td>MiniMax-M2.1</td><td>5</td><td>5</td><td>5</td><td>5</td><td>5</td><td><strong>25</strong></td></tr><tr><td/><td>GLM-4.7</td><td>5</td><td>5</td><td>5</td><td>4</td><td>5</td><td><strong>24</strong></td></tr></tbody></table>
<h3 data-id="heading-3">2.2 æ¨¡å‹ç‰¹æ€§æ€»ç»“</h3>
<h4 data-id="heading-4">2.2.1 MiniMax-M2.1</h4>
<ul>
<li>ç»“æ„åŒ–è¾“å‡ºï¼šå±‚æ¬¡åˆ†æ˜ï¼Œæ˜“äºå¿«é€Ÿç†è§£å’Œå®æ–½</li>
<li>è§„èŒƒæ˜ç¡®ï¼šæä¾›æ¸…æ™°çš„å‘½åã€æ ¼å¼ã€ç»„ç»‡è§„èŒƒ</li>
<li>å®ç”¨æ€§å¼ºï¼šä¾§é‡å¯æ“ä½œæ€§å’Œå®æ–½ç»†èŠ‚</li>
<li>æ·±åº¦æœ‰é™ï¼šåœ¨å¤æ‚æ¶æ„å’Œè®¾è®¡åŸåˆ™é˜è¿°ä¸Šç›¸å¯¹è–„å¼±</li>
<li>ä¸ä¸€è‡´æ€§ï¼šä¸åŒåœºæ™¯è¡¨ç°å·®å¼‚è¾ƒå¤§ï¼ˆJavaåœºæ™¯è¾ƒå¼±ï¼‰</li>
</ul>
<blockquote>
<p><strong>æ”¹è¿›å»ºè®®</strong></p>
<ol>
<li>åŠ å¼ºå¤æ‚åœºæ™¯ï¼ˆå¦‚Javaä¼ä¸šçº§ï¼‰çš„æ·±åº¦åˆ†æ</li>
<li>æå‡æ¶æ„ç†å¿µå’Œè®¾è®¡åŸåˆ™çš„é˜è¿°èƒ½åŠ›</li>
</ol>
</blockquote>
<h4 data-id="heading-5">2.2.2 GLM-4.7</h4>
<ul>
<li>æ¶æ„æ·±åº¦ï¼šæ·±å…¥é˜è¿°è®¾è®¡åŸåˆ™ã€åˆ†å±‚æ¶æ„ã€æœ€ä½³å®è·µ</li>
<li>å…¨é¢æ€§ï¼šè¦†ç›–å¼€å‘å…¨ç”Ÿå‘½å‘¨æœŸè§„èŒƒ</li>
<li>ä¸€è‡´æ€§ï¼šå„åœºæ™¯è¡¨ç°ç¨³å®šä¸”ä¼˜ç§€</li>
<li>å·¥ç¨‹æ€ç»´ï¼šä½“ç°ä¼ä¸šçº§å¼€å‘ç†å¿µå’Œå·¥ç¨‹åŒ–æ€è€ƒ</li>
<li>ç»“æ„ç•¥å†—ï¼šéƒ¨åˆ†è¾“å‡ºå†…å®¹å¯è¿›ä¸€æ­¥ç²¾ç®€ä¼˜åŒ–</li>
</ul>
<blockquote>
<p><strong>æ”¹è¿›å»ºè®®</strong></p>
<ol>
<li>ä¼˜åŒ–è¾“å‡ºç»“æ„ï¼Œæå‡å¯è¯»æ€§å’Œå®æ–½æ•ˆç‡</li>
<li>ä¿æŒç°æœ‰ä¼˜åŠ¿ï¼Œç»§ç»­åŠ å¼ºå®ç”¨æ€§ç¤ºä¾‹</li>
</ol>
</blockquote>
<h3 data-id="heading-6">2.3 åœºæ™¯é€‰æ‹©å»ºè®®</h3>



































<table><thead><tr><th>é¡¹ç›®ç±»å‹</th><th>æ¨èæ¨¡å‹</th><th>ç†ç”±</th></tr></thead><tbody><tr><td><strong>å¿«é€ŸåŸå‹/æ ‡å‡†åŒ–é¡¹ç›®</strong></td><td>MiniMax-M2.1</td><td>ç»“æ„æ¸…æ™°ï¼Œä¾¿äºå¿«é€Ÿå®æ–½</td></tr><tr><td><strong>å¤æ‚ä¼ä¸šçº§ç³»ç»Ÿ</strong></td><td>GLM-4.7</td><td>æ¶æ„ç†è§£æ·±å…¥ï¼Œè§„èŒƒå…¨é¢</td></tr><tr><td><strong>Javaç”Ÿæ€é¡¹ç›®</strong></td><td>GLM-4.7</td><td>åœ¨Javaåœºæ™¯è¡¨ç°æ˜¾è‘—æ›´ä¼˜</td></tr><tr><td><strong>å‰ç«¯Vueé¡¹ç›®</strong></td><td>æ ¹æ®éœ€æ±‚ï¼š  <br/>â€¢ å¿«é€Ÿå®æ–½â†’MiniMax  <br/>â€¢ æ¶æ„æ·±åº¦â†’GLM</td><td>äºŒè€…å„æœ‰ä¼˜åŠ¿</td></tr><tr><td><strong>å…¨æ ˆé¡¹ç›®æŒ‡å¯¼</strong></td><td>GLM-4.7</td><td>è¡¨ç°æ›´ç¨³å®šå…¨é¢</td></tr></tbody></table>
<h2 data-id="heading-7">3 åç«¯</h2>
<blockquote>
<p>æç¤ºè¯ï¼šè¾“å‡ºå·¥ç¨‹ç”¨åˆ°çš„æŠ€æœ¯æ ˆ/ä»£ç ç»“æ„ï¼Œå¹¶æä¾›ç¼–ç¨‹è§„èŒƒ</p>
</blockquote>
<h3 data-id="heading-8">3.1 è¯„ä»·æ ‡å‡†</h3>









































<table><thead><tr><th>ç»´åº¦</th><th>5åˆ†æ ‡å‡†</th><th>3åˆ†æ ‡å‡†</th><th>1åˆ†æ ‡å‡†</th></tr></thead><tbody><tr><td><strong>æŠ€æœ¯æ ˆè¯†åˆ«</strong></td><td>å‡†ç¡®è¯†åˆ«å…¨éƒ¨æ ¸å¿ƒæŠ€æœ¯æ ˆåŠå¼€å‘å·¥å…·é“¾</td><td>è¯†åˆ«ä¸»è¦æŠ€æœ¯æ ˆï¼Œé—æ¼éƒ¨åˆ†å·¥å…·</td><td>æŠ€æœ¯æ ˆè¯†åˆ«ä¸å…¨æˆ–æœ‰é”™è¯¯</td></tr><tr><td><strong>æ¶æ„ç†è§£æ·±åº¦</strong></td><td>è¯¦ç»†æè¿°åˆ†å±‚æ¶æ„ã€è®¾è®¡æ¨¡å¼ã€æ¨¡å—ç»„ç»‡</td><td>åŸºæœ¬æè¿°ç»“æ„ï¼Œç¼ºä¹æ·±åº¦åˆ†æ</td><td>æ¶æ„æè¿°æ¨¡ç³Šæˆ–é”™è¯¯</td></tr><tr><td><strong>è§„èŒƒå®Œæ•´æ€§</strong></td><td>è¦†ç›–ç¼–ç ã€æµ‹è¯•ã€éƒ¨ç½²ç­‰å®Œæ•´å¼€å‘è§„èŒƒ</td><td>æ¶µç›–åŸºæœ¬è§„èŒƒï¼Œç»†èŠ‚ä¸å®Œæ•´</td><td>è§„èŒƒæè¿°é›¶æ•£ä¸ç³»ç»Ÿ</td></tr><tr><td><strong>è¾“å‡ºä¸“ä¸šæ€§</strong></td><td>æŠ€æœ¯æœ¯è¯­å‡†ç¡®ï¼Œæ¶æ„ç†å¿µå…ˆè¿›ï¼Œä½“ç°å·¥ç¨‹æ€ç»´</td><td>æŠ€æœ¯æè¿°åŸºæœ¬æ­£ç¡®ï¼Œç¼ºä¹æ·±åº¦</td><td>æŠ€æœ¯ç†è§£è‚¤æµ…æˆ–æœ‰é”™è¯¯</td></tr><tr><td><strong>å®ç”¨æ€§</strong></td><td>æä¾›å…·ä½“é…ç½®ã€ä»£ç ç¤ºä¾‹å’Œæœ€ä½³å®è·µ</td><td>æœ‰æ¦‚å¿µæè¿°ä½†ç¼ºä¹å®æ–½ç»†èŠ‚</td><td>ç¼ºä¹å¯æ“ä½œ</td></tr></tbody></table>
<h3 data-id="heading-9">3.2 æŠ€æœ¯æ ˆï¼šNestJS+TypeScript+Fastify</h3>
<h4 data-id="heading-10">3.2.1 è¯„æµ‹ç»“æœ</h4>
<blockquote>
<p>äºŒè€…å‡è¡¨ç°ä¼˜ç§€ï¼Œæ— æ˜æ˜¾å·®è·ã€‚GLM-4.7åœ¨æ¶æ„ç†å¿µå’Œè®¾è®¡åŸåˆ™é˜è¿°ä¸Šç•¥èƒœä¸€ç­¹ã€‚</p>
</blockquote>
<h5 data-id="heading-11">3.2.1.1 MiniMax-M2.1</h5>
<blockquote>
<p>å¾—åˆ†ï¼š25</p>
</blockquote>



































<table><thead><tr><th>ç»´åº¦</th><th>è¯„åˆ†</th><th>è¯„ä»·ç†ç”±</th></tr></thead><tbody><tr><td>æŠ€æœ¯æ ˆè¯†åˆ«</td><td>5</td><td>å®Œæ•´åˆ—å‡ºæ ¸å¿ƒä¸è¾…åŠ©æŠ€æœ¯æ ˆï¼Œç‰ˆæœ¬æ¸…æ™°ï¼Œæ¶µç›–å·¥å…·é“¾</td></tr><tr><td>æ¶æ„ç†è§£æ·±åº¦</td><td>5</td><td>è¯¦ç»†æè¿°åˆ†å±‚æ¶æ„ã€æ¨¡å—ç»„ç»‡ã€è®¾è®¡æ¨¡å¼ï¼ˆå¦‚MVCã€Repositoryï¼‰</td></tr><tr><td>è§„èŒƒå®Œæ•´æ€§</td><td>5</td><td>è¦†ç›–ç¼–ç ã€å‘½åã€APIè®¾è®¡ã€æ•°æ®åº“ã€Gitæäº¤ç­‰å®Œæ•´è§„èŒƒ</td></tr><tr><td>è¾“å‡ºä¸“ä¸šæ€§</td><td>5</td><td>æœ¯è¯­å‡†ç¡®ï¼Œç»“æ„æ¸…æ™°ï¼Œä½“ç°ä¼ä¸šçº§å·¥ç¨‹æ€ç»´</td></tr><tr><td>å®ç”¨æ€§</td><td>5</td><td>æä¾›å…·ä½“é…ç½®ã€å‘½ä»¤ã€ä»£ç ç¤ºä¾‹ã€æ¨¡å—ç»“æ„æ¨¡æ¿</td></tr></tbody></table>
<h5 data-id="heading-12">3.2.1.2 GLM-4.7</h5>
<blockquote>
<p>å¾—åˆ†ï¼š25</p>
</blockquote>



































<table><thead><tr><th>ç»´åº¦</th><th>è¯„åˆ†</th><th>è¯„ä»·ç†ç”±</th></tr></thead><tbody><tr><td>æŠ€æœ¯æ ˆè¯†åˆ«</td><td>5</td><td>æŠ€æœ¯æ ˆè¯†åˆ«å®Œæ•´ï¼Œåˆ†ç±»æ¸…æ™°ï¼Œç‰ˆæœ¬é½å…¨</td></tr><tr><td>æ¶æ„ç†è§£æ·±åº¦</td><td>5</td><td>è¯¦ç»†æè¿°åˆ†å±‚ã€å®ä½“è®¾è®¡ã€ç”Ÿå‘½å‘¨æœŸã€æ§åˆ¶å™¨è§„èŒƒç­‰</td></tr><tr><td>è§„èŒƒå®Œæ•´æ€§</td><td>5</td><td>è¦†ç›–ç¼–ç ã€æ³¨é‡Šã€å¼‚å¸¸ã€æŸ¥è¯¢ã€æ—¥å¿—ã€äº‹åŠ¡ç­‰å…¨æ–¹ä½è§„èŒƒ</td></tr><tr><td>è¾“å‡ºä¸“ä¸šæ€§</td><td>5</td><td>æœ¯è¯­ä¸“ä¸šï¼Œæ¶æ„ç†å¿µå…ˆè¿›ï¼Œè®¾è®¡åŸåˆ™æ˜ç¡®ï¼ˆå¦‚SOLIDï¼‰</td></tr><tr><td>å®ç”¨æ€§</td><td>5</td><td>æä¾›å®Œæ•´ä»£ç ç¤ºä¾‹ã€é…ç½®è¯´æ˜ã€å¼€å‘å‘½ä»¤ã€è®¾è®¡åŸåˆ™</td></tr></tbody></table>
<h4 data-id="heading-13">3.2.2 æ¨¡å‹è¾“å‡ºç»“æœ</h4>
<h5 data-id="heading-14">3.2.2.1 MiniMax-M2.1</h5>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">Backend</span> <span class="hljs-string">æŠ€æœ¯æ ˆä¸ä»£ç ç»“æ„</span>

  <span class="hljs-string">---</span>
  <span class="hljs-string">ä¸€ã€æŠ€æœ¯æ ˆ</span>

  <span class="hljs-string">|</span> <span class="hljs-string">åˆ†ç±»</span>     <span class="hljs-string">|</span> <span class="hljs-string">æŠ€æœ¯/ç‰ˆæœ¬</span>                           <span class="hljs-string">|</span> <span class="hljs-string">è¯´æ˜</span>                                 <span class="hljs-string">|
  |----------|-------------------------------------|--------------------------------------|
  | è¿è¡Œæ—¶   | Node.js                             | TypeScript ç¼–è¯‘æ‰§è¡Œç¯å¢ƒ              |
  | æ¡†æ¶     | NestJS v11                          | Node.js ä¼ä¸šçº§åç«¯æ¡†æ¶               |
  | Web æ¡†æ¶ | Fastify v5.4                        | é«˜æ€§èƒ½ HTTP æœåŠ¡å™¨                   |
  | ORM      | Prisma v6.9                         | æ•°æ®åº“ ORM æ¡†æ¶ï¼ˆSQLite/PostgreSQLï¼‰ |
  | è®¤è¯     | Passport + JWT                      | èº«ä»½è®¤è¯ä¸­é—´ä»¶                       |
  | éªŒè¯     | class-validator + class-transformer | DTO æ ¡éªŒä¸è½¬æ¢                       |
  | æ–‡æ¡£     | Swagger/NestJS Swagger              | API æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ                     |
  | æ—¥å¿—     | Winston + Winston Daily Rotate      | æ—¥å¿—ç®¡ç†ä¸è½®è½¬                       |
  | æŒ‡æ ‡     | prom-client + @nestjs/terminus      | åº”ç”¨å¥åº·ç›‘æ§                         |
  | é…ç½®     | YAML + ConfigService                | é…ç½®æ–‡ä»¶ç®¡ç†                         |
  | å·¥å…·åº“   | Lodashã€bcryptã€qsã€zod             | è¾…åŠ©å·¥å…·                             |
  | æ„å»º     | TypeScript + SWC                    | TS ç¼–è¯‘ä¸æ„å»º                        |
  | æµ‹è¯•     | Jest + Supertest                    | å•å…ƒæµ‹è¯•ä¸ E2E æµ‹è¯•                  |
  | ä»£ç è§„èŒƒ | ESLint + Prettier                   | ä»£ç æ ¼å¼åŒ–ä¸æ£€æŸ¥                     |
</span>
  <span class="hljs-string">---</span>
  <span class="hljs-string">äºŒã€ä»£ç ç»“æ„</span>

  <span class="hljs-string">backend/</span>
  <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">src/</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">main.ts</span>                    <span class="hljs-comment"># åº”ç”¨å…¥å£</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">app.module.ts</span>              <span class="hljs-comment"># æ ¹æ¨¡å—</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">config/</span>                    <span class="hljs-comment"># é…ç½®æ–‡ä»¶</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â””â”€â”€</span> <span class="hljs-string">config.yml</span>             <span class="hljs-comment"># ä¸»é…ç½®ï¼ˆæ•°æ®åº“ã€ç«¯å£ã€æ—¥å¿—ç­‰ï¼‰</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">commons/</span>                   <span class="hljs-comment"># å…¬å…±æ¨¡å—</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">auth/</span>                  <span class="hljs-comment"># è®¤è¯æˆæƒï¼ˆJWT/Basicã€Guardsã€Decoratorsï¼‰</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">config/</span>                <span class="hljs-comment"># é…ç½®å®ä½“ç±»</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">database/</span>              <span class="hljs-comment"># Prisma æœåŠ¡å°è£…</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">entity/</span>                <span class="hljs-comment"># åŸºç¡€å®ä½“ç±»ï¼ˆStandardEntityã€CreateEntity ç­‰ï¼‰</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">exception/</span>             <span class="hljs-comment"># å¼‚å¸¸å¤„ç†ï¼ˆBusinessExceptionã€ErrorCodeï¼‰</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">log/</span>                   <span class="hljs-comment"># æ—¥å¿—æ¨¡å—</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">query/</span>                 <span class="hljs-comment"># åˆ†é¡µæŸ¥è¯¢ï¼ˆQueryFilterã€QueryResultï¼‰</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">util/</span>                  <span class="hljs-comment"># å·¥å…·ç±»ï¼ˆæ—¥æœŸã€å¯†ç åŠ å¯†ï¼‰</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â””â”€â”€</span> <span class="hljs-string">web/</span>                   <span class="hljs-comment"># Web é€šç”¨ï¼ˆæ‹¦æˆªå™¨ã€è¿‡æ»¤å™¨ï¼‰</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â””â”€â”€</span> <span class="hljs-string">modules/</span>                   <span class="hljs-comment"># ä¸šåŠ¡æ¨¡å—</span>
  <span class="hljs-string">â”‚</span>       <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">admin/</span>                 <span class="hljs-comment"># ç®¡ç†å‘˜æ¨¡å—</span>
  <span class="hljs-string">â”‚</span>       <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">auth/</span>                  <span class="hljs-comment"># ç™»å½•è®¤è¯æ¨¡å—</span>
  <span class="hljs-string">â”‚</span>       <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">attendance/</span>            <span class="hljs-comment"># è€ƒå‹¤ç®¡ç†æ¨¡å—</span>
  <span class="hljs-string">â”‚</span>       <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">course/</span>                <span class="hljs-comment"># è¯¾ç¨‹ç®¡ç†æ¨¡å—</span>
  <span class="hljs-string">â”‚</span>       <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">operationlog/</span>          <span class="hljs-comment"># æ“ä½œæ—¥å¿—æ¨¡å—</span>
  <span class="hljs-string">â”‚</span>       <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">option/</span>                <span class="hljs-comment"># é…ç½®é€‰é¡¹æ¨¡å—</span>
  <span class="hljs-string">â”‚</span>       <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">student/</span>               <span class="hljs-comment"># å­¦ç”Ÿç®¡ç†æ¨¡å—</span>
  <span class="hljs-string">â”‚</span>       <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">teacher/</span>               <span class="hljs-comment"># æ•™å¸ˆç®¡ç†æ¨¡å—</span>
  <span class="hljs-string">â”‚</span>       <span class="hljs-string">â””â”€â”€</span> <span class="hljs-string">user/</span>                  <span class="hljs-comment"># ç”¨æˆ·ç®¡ç†æ¨¡å—</span>
  <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">prisma/</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">schema.prisma</span>              <span class="hljs-comment"># æ•°æ®æ¨¡å‹å®šä¹‰</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">schema.prisma.sqlite</span>       <span class="hljs-comment"># SQLite é…ç½®</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">schema.prisma.postgresql</span>   <span class="hljs-comment"># PostgreSQL é…ç½®</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â””â”€â”€</span> <span class="hljs-string">seed.ts</span>                    <span class="hljs-comment"># æ•°æ®å¡«å……è„šæœ¬</span>
  <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">test/</span>                          <span class="hljs-comment"># æµ‹è¯•æ–‡ä»¶</span>
  <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">package.json</span>
  <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">tsconfig.json</span>
  <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">.prettierrc</span>
  <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">eslint.config.mjs</span>
  <span class="hljs-string">â””â”€â”€</span> <span class="hljs-string">Dockerfile</span>

  <span class="hljs-string">---</span>
  <span class="hljs-string">ä¸‰ã€æ¨¡å—æ ‡å‡†ç»“æ„</span>

  <span class="hljs-string">æ¯ä¸ªä¸šåŠ¡æ¨¡å—éµå¾ªç»Ÿä¸€ç»“æ„ï¼š</span>

  <span class="hljs-string">modules/{module}/</span>
  <span class="hljs-string">â”œâ”€â”€</span> {<span class="hljs-string">module</span>}<span class="hljs-string">.module.ts</span>              <span class="hljs-comment"># æ¨¡å—å®šä¹‰</span>
  <span class="hljs-string">â”œâ”€â”€</span> {<span class="hljs-string">module</span>}<span class="hljs-string">.controller.ts</span>          <span class="hljs-comment"># API æ§åˆ¶å™¨</span>
  <span class="hljs-string">â”œâ”€â”€</span> {<span class="hljs-string">module</span>}<span class="hljs-string">.service.ts</span>             <span class="hljs-comment"># ä¸šåŠ¡é€»è¾‘å±‚</span>
  <span class="hljs-string">â”œâ”€â”€</span> {<span class="hljs-string">module</span>}<span class="hljs-string">.repository.ts</span>          <span class="hljs-comment"># æ•°æ®è®¿é—®å±‚ï¼ˆå¯é€‰ï¼‰</span>
  <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">dto/</span>                            <span class="hljs-comment"># æ•°æ®ä¼ è¾“å¯¹è±¡</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> {<span class="hljs-string">module</span>}<span class="hljs-string">.create.dto.ts</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> {<span class="hljs-string">module</span>}<span class="hljs-string">.update.dto.ts</span>
  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â””â”€â”€</span> {<span class="hljs-string">module</span>}<span class="hljs-string">.query.dto.ts</span>
  <span class="hljs-string">â””â”€â”€</span> <span class="hljs-string">entity/</span>                         <span class="hljs-comment"># å®ä½“ç±»</span>
      <span class="hljs-string">â”œâ”€â”€</span> {<span class="hljs-string">module</span>}<span class="hljs-string">.entity.ts</span>
      <span class="hljs-string">â”œâ”€â”€</span> {<span class="hljs-string">module</span>}<span class="hljs-string">.queryfilter.ts</span>
      <span class="hljs-string">â””â”€â”€</span> {<span class="hljs-string">module</span>}<span class="hljs-string">.querydecoder.ts</span>

  <span class="hljs-string">---</span>
  <span class="hljs-string">å››ã€ç¼–ç¨‹è§„èŒƒ</span>

  <span class="hljs-number">4.1</span> <span class="hljs-string">ä»£ç é£æ ¼</span>

  <span class="hljs-string">|</span> <span class="hljs-string">é…ç½®é¡¹</span> <span class="hljs-string">|</span> <span class="hljs-string">å€¼</span>                  <span class="hljs-string">|
  |--------|---------------------|
  | ç¼©è¿›   | 2 ç©ºæ ¼              |
  | å¼•å·   | å•å¼•å· ' '          |
  | åˆ†å·   | å¿…é¡»ä½¿ç”¨ ;          |
  | å°¾é€—å· | allï¼ˆå¯¹è±¡ã€æ•°ç»„ç­‰ï¼‰ |
  | è¡Œå®½   | 80 å­—ç¬¦             |
</span>
  <span class="hljs-number">4.2</span> <span class="hljs-string">ESLint</span> <span class="hljs-string">è§„åˆ™</span>

  <span class="hljs-bullet">-</span> <span class="hljs-string">@typescript-eslint/no-explicit-any:</span> <span class="hljs-string">offï¼ˆå…è®¸ä½¿ç”¨</span> <span class="hljs-string">anyï¼‰</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">@typescript-eslint/no-floating-promises:</span> <span class="hljs-string">warn</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">@typescript-eslint/no-unsafe-*::</span> <span class="hljs-string">warn</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">prettier/prettier:</span> <span class="hljs-string">error</span>

  <span class="hljs-number">4.3</span> <span class="hljs-string">å‘½åè§„èŒƒ</span>

  <span class="hljs-string">|</span> <span class="hljs-string">ç±»å‹</span>       <span class="hljs-string">|</span> <span class="hljs-string">è§„èŒƒ</span>             <span class="hljs-string">|</span> <span class="hljs-string">ç¤ºä¾‹</span>                                      <span class="hljs-string">|
  |------------|------------------|-------------------------------------------|
  | æ–‡ä»¶å     | kebab-case       | course.controller.ts                      |
  | ç±»å       | PascalCase       | CourseControllerã€CourseService           |
  | å˜é‡/å‡½æ•°  | camelCase        | courseServiceã€findById                   |
  | å¸¸é‡       | UPPER_SNAKE_CASE | MAX_RETRY_COUNT                           |
  | æ•°æ®åº“å­—æ®µ | snake_case       | created_atã€user_id                       |
  | DTO å±æ€§   | camelCase        | courseIdï¼ˆå†…éƒ¨ï¼‰â†’ course_idï¼ˆæ•°æ®åº“æ˜ å°„ï¼‰ |
  | æšä¸¾       | PascalCase       | UserTypeã€CourseType                      |
</span>
  <span class="hljs-number">4.4</span> <span class="hljs-string">æ¨¡å—åˆ†å±‚è§„èŒƒ</span>

  <span class="hljs-string">Controller</span> <span class="hljs-string">(API</span> <span class="hljs-string">å±‚)</span>
      <span class="hljs-string">â†“</span> <span class="hljs-string">è°ƒç”¨</span>
  <span class="hljs-string">Service</span> <span class="hljs-string">(ä¸šåŠ¡é€»è¾‘å±‚)</span>
      <span class="hljs-string">â†“</span> <span class="hljs-string">è°ƒç”¨</span>
  <span class="hljs-string">Repository</span> <span class="hljs-string">(æ•°æ®è®¿é—®å±‚)</span>
      <span class="hljs-string">â†“</span> <span class="hljs-string">è°ƒç”¨</span>
  <span class="hljs-string">Prisma</span> <span class="hljs-string">(æ•°æ®åº“æ“ä½œ)</span>

  <span class="hljs-number">4.5</span> <span class="hljs-string">API</span> <span class="hljs-string">è®¾è®¡è§„èŒƒ</span>

  <span class="hljs-bullet">-</span> <span class="hljs-string">è·¯ç”±å‰ç¼€:</span> <span class="hljs-string">å…¨å±€é€šè¿‡</span> <span class="hljs-string">config.yml</span> <span class="hljs-string">é…ç½®ï¼ˆé»˜è®¤</span> <span class="hljs-string">/apiï¼‰</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">è¯·æ±‚æ–¹å¼:</span> <span class="hljs-string">ç»Ÿä¸€ä½¿ç”¨</span> <span class="hljs-string">POSTï¼ˆBody</span> <span class="hljs-string">ä¼ å‚ï¼‰</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">å“åº”æ ¼å¼:</span> <span class="hljs-string">ç»Ÿä¸€</span> <span class="hljs-string">ResponseDto&lt;T&gt;</span> <span class="hljs-string">ç»“æ„</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">åˆ†é¡µ:</span> <span class="hljs-string">ä½¿ç”¨</span> <span class="hljs-string">QueryResult&lt;T&gt;</span> <span class="hljs-string">åŒ…è£…</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">è®¤è¯:</span> <span class="hljs-string">@UseGuards(JwtAuthGuard,</span> <span class="hljs-string">RolesGuard)</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">è§’è‰²æ§åˆ¶:</span> <span class="hljs-string">@Roles(UserType.admin)</span>

  <span class="hljs-number">4.6</span> <span class="hljs-string">æ•°æ®åº“è§„èŒƒ</span>

  <span class="hljs-bullet">-</span> <span class="hljs-string">å­—æ®µæ˜ å°„ä½¿ç”¨</span> <span class="hljs-string">@map()</span> <span class="hljs-string">æ³¨è§£</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">å¿…é¡»æ·»åŠ ç´¢å¼•</span> <span class="hljs-string">@index()</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">è½¯åˆ é™¤ä½¿ç”¨</span> <span class="hljs-string">isActive</span> <span class="hljs-string">å¸ƒå°”å­—æ®µ</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">å®¡è®¡å­—æ®µ:</span> <span class="hljs-string">creatorId/Nameã€updatorId/Nameã€createdAtã€updatedAt</span>

  <span class="hljs-number">4.7</span> <span class="hljs-string">Git</span> <span class="hljs-string">æäº¤è§„èŒƒ</span>

  <span class="hljs-attr">feat:</span> <span class="hljs-string">æ–°åŠŸèƒ½</span>
  <span class="hljs-attr">fix:</span> <span class="hljs-string">ä¿®å¤</span> <span class="hljs-string">bug</span>
  <span class="hljs-attr">docs:</span> <span class="hljs-string">æ–‡æ¡£æ›´æ–°</span>
  <span class="hljs-attr">style:</span> <span class="hljs-string">ä»£ç æ ¼å¼ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰</span>
  <span class="hljs-attr">refactor:</span> <span class="hljs-string">é‡æ„</span>
  <span class="hljs-attr">test:</span> <span class="hljs-string">æµ‹è¯•ç›¸å…³</span>
  <span class="hljs-attr">chore:</span> <span class="hljs-string">æ„å»º/å·¥å…·/ä¾èµ–æ›´æ–°</span>

  <span class="hljs-string">---</span>
  <span class="hljs-string">äº”ã€å¸¸ç”¨å‘½ä»¤</span>

  <span class="hljs-comment"># å¼€å‘å¯åŠ¨</span>
  <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">start:dev</span>

  <span class="hljs-comment"># ä»£ç æ£€æŸ¥</span>
  <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">lint</span>

  <span class="hljs-comment"># ä»£ç æ ¼å¼åŒ–</span>
  <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">format</span>

  <span class="hljs-comment"># Prisma æ“ä½œ</span>
  <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">prisma:generate</span>   <span class="hljs-comment"># ç”Ÿæˆå®¢æˆ·ç«¯</span>
  <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">prisma:migrate</span>    <span class="hljs-comment"># è¿ç§»æ•°æ®åº“</span>
  <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">prisma:studio</span>     <span class="hljs-comment"># å¯è§†åŒ–æ•°æ®åº“</span>
  <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">prisma:seed</span>       <span class="hljs-comment"># å¡«å……æ•°æ®</span>

  <span class="hljs-comment"># æ„å»ºä¸è¿è¡Œ</span>
  <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">build</span>
  <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">start:prod</span>

  <span class="hljs-string">---</span>
  <span class="hljs-string">å…­ã€é…ç½®è¯´æ˜</span>

  <span class="hljs-string">backend/src/config/config.yml</span> <span class="hljs-string">ä¸»è¦é…ç½®é¡¹ï¼š</span>

  <span class="hljs-attr">app:</span>
    <span class="hljs-attr">contextPath:</span> <span class="hljs-string">/api</span>        <span class="hljs-comment"># å…¨å±€è·¯ç”±å‰ç¼€</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">3000</span>              <span class="hljs-comment"># ç›‘å¬ç«¯å£</span>
    <span class="hljs-attr">compression:</span>
      <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>
      <span class="hljs-attr">threshold:</span> <span class="hljs-number">1024</span>

  <span class="hljs-attr">database:</span>
    <span class="hljs-attr">provider:</span> <span class="hljs-string">sqlite</span>        <span class="hljs-comment"># sqlite / postgresql</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">prisma/local.db</span>

  <span class="hljs-attr">jwt:</span>
    <span class="hljs-attr">secret:</span> <span class="hljs-string">your-secret</span>
    <span class="hljs-attr">expiresIn:</span> <span class="hljs-string">1h</span>

  <span class="hljs-attr">swagger:</span>
    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">title:</span> <span class="hljs-string">Course</span> <span class="hljs-string">System</span> <span class="hljs-string">API</span>
    <span class="hljs-attr">path:</span> <span class="hljs-string">swagger</span>
</code></pre>
<h5 data-id="heading-15">3.2.2.2 GLM-4.7</h5>
<pre><code class="hljs language-typescript" lang="typescript"> ğŸ“¦ <span class="hljs-title class_">Backend</span> å·¥ç¨‹æŠ€æœ¯æ ˆ

  æ ¸å¿ƒæ¡†æ¶

  | æŠ€æœ¯       | ç‰ˆæœ¬    | ç”¨é€”                                 |
  |------------|---------|--------------------------------------|
  | <span class="hljs-title class_">NestJS</span>     | ^<span class="hljs-number">11.0</span><span class="hljs-number">.1</span> | æ¸è¿›å¼<span class="hljs-title class_">Node</span>.<span class="hljs-property">js</span>æ¡†æ¶ï¼Œæä¾›å®Œæ•´çš„<span class="hljs-variable constant_">MVC</span>æ¶æ„ |
  | <span class="hljs-title class_">Fastify</span>    | ^<span class="hljs-number">5.4</span><span class="hljs-number">.0</span>  | é«˜æ€§èƒ½<span class="hljs-title class_">Web</span>æœåŠ¡å™¨ï¼ˆæ›¿ä»£<span class="hljs-title class_">Express</span>ï¼‰       |
  | <span class="hljs-title class_">TypeScript</span> | ^<span class="hljs-number">5.7</span><span class="hljs-number">.3</span>  | ç±»å‹å®‰å…¨çš„å¼€å‘è¯­è¨€                   |

  æ•°æ®å±‚

  | æŠ€æœ¯           | ç‰ˆæœ¬   | ç”¨é€”                                 |
  |----------------|--------|--------------------------------------|
  | <span class="hljs-title class_">Prisma</span>         | ^<span class="hljs-number">6.9</span><span class="hljs-number">.0</span> | ç±»å‹å®‰å…¨çš„<span class="hljs-variable constant_">ORM</span>ï¼Œæ”¯æŒ<span class="hljs-title class_">SQLite</span>/<span class="hljs-title class_">PostgreSQL</span> |
  | <span class="hljs-meta">@prisma</span>/client | ^<span class="hljs-number">6.9</span><span class="hljs-number">.0</span> | <span class="hljs-title class_">Prisma</span>æŸ¥è¯¢å®¢æˆ·ç«¯                     |

  è®¤è¯ä¸å®‰å…¨

  | æŠ€æœ¯             | ç‰ˆæœ¬    | ç”¨é€”          |
  |------------------|---------|---------------|
  | <span class="hljs-meta">@nestjs</span>/passport | ^<span class="hljs-number">11.0</span><span class="hljs-number">.5</span> | è®¤è¯ç­–ç•¥é›†æˆ  |
  | <span class="hljs-meta">@nestjs</span>/jwt      | ^<span class="hljs-number">11.0</span><span class="hljs-number">.0</span> | <span class="hljs-variable constant_">JWT</span>ä»¤ç‰Œå¤„ç†   |
  | passport-jwt     | ^<span class="hljs-number">4.0</span><span class="hljs-number">.1</span>  | <span class="hljs-variable constant_">JWT</span>è®¤è¯ç­–ç•¥   |
  | passport-http    | ^<span class="hljs-number">0.3</span><span class="hljs-number">.0</span>  | <span class="hljs-title class_">Basic</span>è®¤è¯ç­–ç•¥ |
  | bcrypt           | ^<span class="hljs-number">6.0</span><span class="hljs-number">.0</span>  | å¯†ç å“ˆå¸ŒåŠ å¯†  |

  æ—¥å¿—ä¸ç›‘æ§

  | æŠ€æœ¯                      | ç‰ˆæœ¬    | ç”¨é€”               |
  |---------------------------|---------|--------------------|
  | winston                   | ^<span class="hljs-number">3.17</span><span class="hljs-number">.0</span> | æ—¥å¿—è®°å½•           |
  | winston-daily-rotate-file | ^<span class="hljs-number">5.0</span><span class="hljs-number">.0</span>  | æ—¥å¿—æ–‡ä»¶æŒ‰æ—¥æœŸè½®è½¬ |
  | <span class="hljs-meta">@nestjs</span>/terminus          | ^<span class="hljs-number">11.0</span><span class="hljs-number">.0</span> | å¥åº·æ£€æŸ¥           |
  | prom-client               | ^<span class="hljs-number">15.1</span><span class="hljs-number">.3</span> | <span class="hljs-title class_">Prometheus</span>æŒ‡æ ‡é‡‡é›† |

  <span class="hljs-variable constant_">API</span>æ–‡æ¡£ä¸éªŒè¯

  | æŠ€æœ¯              | ç‰ˆæœ¬    | ç”¨é€”                |
  |-------------------|---------|---------------------|
  | <span class="hljs-meta">@nestjs</span>/swagger   | ^<span class="hljs-number">11.2</span><span class="hljs-number">.0</span> | <span class="hljs-title class_">OpenAPI</span>/<span class="hljs-title class_">Swagger</span>æ–‡æ¡£ |
  | <span class="hljs-keyword">class</span>-validator   | ^<span class="hljs-number">0.14</span><span class="hljs-number">.2</span> | <span class="hljs-variable constant_">DTO</span>å£°æ˜å¼éªŒè¯       |
  | <span class="hljs-keyword">class</span>-transformer | ^<span class="hljs-number">0.5</span><span class="hljs-number">.1</span>  | å¯¹è±¡è½¬æ¢            |

  å…¶ä»–å·¥å…·

  | æŠ€æœ¯        | ç‰ˆæœ¬     | ç”¨é€”           |
  |-------------|----------|----------------|
  | compression | ^<span class="hljs-number">1.8</span><span class="hljs-number">.1</span>   | <span class="hljs-variable constant_">HTTP</span>å“åº”å‹ç¼©   |
  | nestjs-cls  | ^<span class="hljs-number">6.0</span><span class="hljs-number">.1</span>   | è¯·æ±‚ä¸Šä¸‹æ–‡ç®¡ç† |
  | lodash      | ^<span class="hljs-number">4.17</span><span class="hljs-number">.21</span> | å·¥å…·å‡½æ•°åº“     |
  | uuid        | ^<span class="hljs-number">11.1</span><span class="hljs-number">.0</span>  | <span class="hljs-variable constant_">UUID</span>ç”Ÿæˆ       |
  | zod         | ^<span class="hljs-number">4.1</span><span class="hljs-number">.5</span>   | è¿è¡Œæ—¶ç±»å‹éªŒè¯ |

  ---
  ğŸ—ï¸ ä»£ç ç»“æ„

  ç›®å½•æ¶æ„

  backend/
  â”œâ”€â”€ prisma/                    # æ•°æ®åº“å±‚
  â”‚   â”œâ”€â”€ schema.<span class="hljs-property">prisma</span>          # æ•°æ®æ¨¡å‹å®šä¹‰
  â”‚   â””â”€â”€ seed.<span class="hljs-property">ts</span>                # ç§å­æ•°æ®
  â”‚
  â”œâ”€â”€ src/
  â”‚   â”œâ”€â”€ main.<span class="hljs-property">ts</span>                # åº”ç”¨å…¥å£
  â”‚   â”œâ”€â”€ app.<span class="hljs-property">module</span>.<span class="hljs-property">ts</span>          # æ ¹æ¨¡å—
  â”‚   â”‚
  â”‚   â”œâ”€â”€ commons/               # å…¬å…±æ¨¡å—ï¼ˆè·¨ä¸šåŠ¡ï¼‰
  â”‚   â”‚   â”œâ”€â”€ auth/              # è®¤è¯æˆæƒ
  â”‚   â”‚   â”‚   â”œâ”€â”€ decorator/     # è£…é¥°å™¨ï¼ˆ<span class="hljs-meta">@JwtAuth</span>, <span class="hljs-meta">@Public</span>ç­‰ï¼‰
  â”‚   â”‚   â”‚   â”œâ”€â”€ guard/         # å®ˆå«
  â”‚   â”‚   â”‚   â”œâ”€â”€ strategy/      # <span class="hljs-title class_">Passport</span>ç­–ç•¥
  â”‚   â”‚   â”‚   â””â”€â”€ jwt-auth.<span class="hljs-property">service</span>.<span class="hljs-property">ts</span>
  â”‚   â”‚   â”‚
  â”‚   â”‚   â”œâ”€â”€ config/            # é…ç½®ç®¡ç†
  â”‚   â”‚   â”œâ”€â”€ database/          # æ•°æ®åº“æœåŠ¡
  â”‚   â”‚   â”œâ”€â”€ entity/            # å…¬å…±å®ä½“åŸºç±»
  â”‚   â”‚   â”œâ”€â”€ exception/         # å¼‚å¸¸å¤„ç†
  â”‚   â”‚   â”œâ”€â”€ log/               # æ—¥å¿—æœåŠ¡
  â”‚   â”‚   â”œâ”€â”€ query/             # æŸ¥è¯¢å°è£…
  â”‚   â”‚   â”œâ”€â”€ util/              # å·¥å…·ç±»
  â”‚   â”‚   â””â”€â”€ web/               # <span class="hljs-title class_">Web</span>å±‚ç»„ä»¶
  â”‚   â”‚       â”œâ”€â”€ filter/        # å¼‚å¸¸è¿‡æ»¤å™¨
  â”‚   â”‚       â”œâ”€â”€ interceptor/   # æ‹¦æˆªå™¨
  â”‚   â”‚       â””â”€â”€ management/    # ç®¡ç†ç«¯ç‚¹
  â”‚   â”‚
  â”‚   â””â”€â”€ modules/               # ä¸šåŠ¡æ¨¡å—
  â”‚       â”œâ”€â”€ user/              # ç”¨æˆ·æ¨¡å—
  â”‚       â”œâ”€â”€ course/            # è¯¾ç¨‹æ¨¡å—
  â”‚       â”œâ”€â”€ attendance/        # è€ƒå‹¤æ¨¡å—
  â”‚       â”œâ”€â”€ auth/              # è®¤è¯æ§åˆ¶å™¨
  â”‚       â”œâ”€â”€ admin/             # ç®¡ç†å‘˜
  â”‚       â”œâ”€â”€ student/           # å­¦ç”Ÿ
  â”‚       â”œâ”€â”€ teacher/           # æ•™å¸ˆ
  â”‚       â””â”€â”€ operationlog/      # æ“ä½œæ—¥å¿—
  â”‚
  â”œâ”€â”€ test/                      # æµ‹è¯•ç›®å½•
  â””â”€â”€ docs/                      # é¡¹ç›®æ–‡æ¡£

  æ¨¡å—æ ‡å‡†ç»“æ„

  æ¯ä¸ªä¸šåŠ¡æ¨¡å—éµå¾ªç»Ÿä¸€çš„åˆ†å±‚æ¶æ„ï¼š

  <span class="hljs-variable language_">module</span>-name/
  â”œâ”€â”€ <span class="hljs-variable language_">module</span>-name.<span class="hljs-property">controller</span>.<span class="hljs-property">ts</span>  # æ§åˆ¶å™¨å±‚ï¼ˆè·¯ç”±ã€å‚æ•°éªŒè¯ï¼‰
  â”œâ”€â”€ <span class="hljs-variable language_">module</span>-name.<span class="hljs-property">service</span>.<span class="hljs-property">ts</span>     # æœåŠ¡å±‚ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰
  â”œâ”€â”€ <span class="hljs-variable language_">module</span>-name.<span class="hljs-property">repository</span>.<span class="hljs-property">ts</span>  # ä»“å‚¨å±‚ï¼ˆæ•°æ®è®¿é—®ï¼‰
  â”œâ”€â”€ <span class="hljs-variable language_">module</span>-name.<span class="hljs-property">module</span>.<span class="hljs-property">ts</span>      # æ¨¡å—å®šä¹‰ï¼ˆä¾èµ–æ³¨å…¥ï¼‰
  â”œâ”€â”€ dto/                       # æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆ<span class="hljs-variable constant_">API</span>è¯·æ±‚/å“åº”ï¼‰
  â”‚   â”œâ”€â”€ <span class="hljs-variable language_">module</span>-create.<span class="hljs-property">dto</span>.<span class="hljs-property">ts</span>
  â”‚   â”œâ”€â”€ <span class="hljs-variable language_">module</span>-update.<span class="hljs-property">dto</span>.<span class="hljs-property">ts</span>
  â”‚   â””â”€â”€ <span class="hljs-variable language_">module</span>.<span class="hljs-property">dto</span>.<span class="hljs-property">ts</span>
  â””â”€â”€ entity/                    # å®ä½“ç±»ï¼ˆé¢†åŸŸæ¨¡å‹ï¼‰
      â”œâ”€â”€ <span class="hljs-variable language_">module</span>.<span class="hljs-property">entity</span>.<span class="hljs-property">ts</span>
      â”œâ”€â”€ <span class="hljs-variable language_">module</span>.<span class="hljs-property">queryfilter</span>.<span class="hljs-property">ts</span>  # æŸ¥è¯¢è¿‡æ»¤å™¨
      â””â”€â”€ <span class="hljs-variable language_">module</span>.<span class="hljs-property">querydecoder</span>.<span class="hljs-property">ts</span> # æŸ¥è¯¢è§£ç å™¨

  æ•°æ®æ¨¡å‹

  | æ¨¡å‹             | è¯´æ˜                       | å…³é”®å­—æ®µ                                                             |
  |------------------|----------------------------|----------------------------------------------------------------------|
  | <span class="hljs-title class_">User</span>             | ç”¨æˆ·è¡¨ï¼ˆç®¡ç†å‘˜/æ•™å¸ˆ/å­¦ç”Ÿï¼‰ | id, name, username, password, userType, isActive                     |
  | <span class="hljs-title class_">Course</span>           | è¯¾ç¨‹è¡¨                     | id, name, courseType, isActive, studentCount                         |
  | <span class="hljs-title class_">CourseTeacher</span>    | è¯¾ç¨‹-æ•™å¸ˆå…³è”              | courseId, teacherId                                                  |
  | <span class="hljs-title class_">CourseStudent</span>    | è¯¾ç¨‹-å­¦ç”Ÿå…³è”              | courseId, studentId, totalSessions, usedSessions, startDate, endDate |
  | <span class="hljs-title class_">AttendanceRecord</span> | è€ƒå‹¤è®°å½•                   | courseId, studentId, attendanceDate, sessionsConsumed                |
  | <span class="hljs-title class_">OperationLog</span>     | æ“ä½œæ—¥å¿—                   | id, <span class="hljs-variable language_">module</span>, operation, operatorId                                    |

  ---
  ğŸ“‹ ç¼–ç¨‹è§„èŒƒ

  <span class="hljs-number">1.</span> <span class="hljs-title class_">TypeScript</span>é…ç½®è§„èŒƒ

  ç¼–è¯‘é€‰é¡¹ (tsconfig.<span class="hljs-property">json</span>):
  - ç›®æ ‡ç‰ˆæœ¬: <span class="hljs-title class_">ES2023</span>
  - æ¨¡å—ç³»ç»Ÿ: <span class="hljs-title class_">CommonJS</span>
  - è£…é¥°å™¨æ”¯æŒ: å¯ç”¨ experimentalDecorators
  - ä¸¥æ ¼æ¨¡å¼: <span class="hljs-attr">strictNullChecks</span>: <span class="hljs-literal">true</span>
  - æºç æ˜ å°„: å¯ç”¨ sourceMap

  <span class="hljs-number">2.</span> ä»£ç é£æ ¼è§„èŒƒ

  <span class="hljs-title class_">Prettier</span>é…ç½® (.<span class="hljs-property">prettierrc</span>):
  {
    <span class="hljs-string">"singleQuote"</span>: <span class="hljs-literal">true</span>,      <span class="hljs-comment">// ä½¿ç”¨å•å¼•å·</span>
    <span class="hljs-string">"tabWidth"</span>: <span class="hljs-number">2</span>,            <span class="hljs-comment">// ç¼©è¿›2ç©ºæ ¼</span>
    <span class="hljs-string">"printWidth"</span>: <span class="hljs-number">80</span>,         <span class="hljs-comment">// æ¯è¡Œæœ€å¤§80å­—ç¬¦</span>
    <span class="hljs-string">"semi"</span>: <span class="hljs-literal">true</span>,             <span class="hljs-comment">// ä½¿ç”¨åˆ†å·</span>
    <span class="hljs-string">"trailingComma"</span>: <span class="hljs-string">"all"</span>    <span class="hljs-comment">// å°¾éšé€—å·</span>
  }

  <span class="hljs-title class_">ESLint</span>è§„åˆ™ (eslint.<span class="hljs-property">config</span>.<span class="hljs-property">mjs</span>):
  - å…³é—­ <span class="hljs-meta">@typescript</span>-eslint/no-explicit-<span class="hljs-built_in">any</span>ï¼ˆå…è®¸<span class="hljs-built_in">any</span>ï¼‰
  - æµ®åŠ¨<span class="hljs-title class_">Promise</span>è­¦å‘Š
  - ä¸å®‰å…¨æ“ä½œè­¦å‘Šï¼ˆå‚æ•°/æˆå‘˜è®¿é—®/èµ‹å€¼ï¼‰
  - <span class="hljs-title class_">Prettier</span>é›†æˆ

  <span class="hljs-number">3.</span> å‘½åè§„èŒƒ

  | ç±»å‹     | è§„èŒƒ                    | ç¤ºä¾‹                                  |
  |----------|-------------------------|---------------------------------------|
  | æ–‡ä»¶å   | kebab-<span class="hljs-keyword">case</span>              | course.<span class="hljs-property">service</span>.<span class="hljs-property">ts</span>, user-create.<span class="hljs-property">dto</span>.<span class="hljs-property">ts</span> |
  | ç±»å     | <span class="hljs-title class_">PascalCase</span>              | <span class="hljs-title class_">CourseService</span>, <span class="hljs-title class_">UserCreateDto</span>          |
  | æ–¹æ³•å   | camelCase               | findById, listUnAssignedTeachers      |
  | æ¥å£å   | <span class="hljs-title class_">PascalCase</span>ï¼Œæ— Iå‰ç¼€     | <span class="hljs-title class_">QueryDecoder</span>, <span class="hljs-title class_">Converter</span>               |
  | å¸¸é‡     | <span class="hljs-variable constant_">UPPER_SNAKE_CASE</span>        | <span class="hljs-title class_">CourseType</span>.<span class="hljs-property">session_card</span>               |
  | ç§æœ‰æˆå‘˜ | camelCaseï¼Œæ— ä¸‹åˆ’çº¿å‰ç¼€ | <span class="hljs-keyword">private</span> courseRepository              |

  <span class="hljs-number">4.</span> æ³¨é‡Šè§„èŒƒ

  <span class="hljs-comment">/**
   * åˆ›å»ºè¯¾ç¨‹
   * <span class="hljs-doctag">@param</span> createCourseDto åˆ›å»ºDTO
   * <span class="hljs-doctag">@param</span> operateContext æ“ä½œä¸Šä¸‹æ–‡
   * <span class="hljs-doctag">@returns</span> è¯¾ç¨‹å®ä½“
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">create</span>(
    <span class="hljs-attr">createCourseDto</span>: <span class="hljs-title class_">CourseCreateDto</span>,
    <span class="hljs-attr">operateContext</span>: <span class="hljs-title class_">OperateContext</span>,
  ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">CourseEntity</span>&gt;

  è¦æ±‚ï¼š
  - æ‰€æœ‰å…¬å¼€æ–¹æ³•å¿…é¡»æœ‰<span class="hljs-title class_">JSDoc</span>æ³¨é‡Š
  - å¤æ‚é€»è¾‘å¿…é¡»æ·»åŠ è¡Œå†…æ³¨é‡Š
  - æ³¨é‡Šä½¿ç”¨ä¸­æ–‡ç®€ä½“

  <span class="hljs-number">5.</span> å®ä½“è®¾è®¡è§„èŒƒ

  ç»§æ‰¿ä½“ç³»ï¼š
  <span class="hljs-title class_">Entity</span> (åŸºç¡€å®ä½“)
    â””â”€â”€ <span class="hljs-title class_">StandardEntity</span> (æ ‡å‡†å®ä½“ï¼Œå«å®¡è®¡å­—æ®µ)
         â””â”€â”€ <span class="hljs-title class_">CourseCreateEntity</span>, <span class="hljs-title class_">UserCreateEntity</span>ç­‰

  å®¡è®¡å­—æ®µï¼ˆç»§æ‰¿è‡ª <span class="hljs-title class_">StandardEntity</span>ï¼‰:
  <span class="hljs-attr">createdAt</span>: <span class="hljs-title class_">Date</span>;        <span class="hljs-comment">// åˆ›å»ºæ—¶é—´</span>
  <span class="hljs-attr">creatorId</span>: <span class="hljs-built_in">string</span>;      <span class="hljs-comment">// åˆ›å»ºäººID</span>
  <span class="hljs-attr">creatorName</span>: <span class="hljs-built_in">string</span>;    <span class="hljs-comment">// åˆ›å»ºäººå§“å</span>
  <span class="hljs-attr">updatedAt</span>: <span class="hljs-title class_">Date</span>;        <span class="hljs-comment">// æ›´æ–°æ—¶é—´</span>
  <span class="hljs-attr">updatorId</span>: <span class="hljs-built_in">string</span>;      <span class="hljs-comment">// æ›´æ–°äººID</span>
  <span class="hljs-attr">updatorName</span>: <span class="hljs-built_in">string</span>;    <span class="hljs-comment">// æ›´æ–°äººå§“å</span>

  ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼š
  - <span class="hljs-title function_">onCreated</span>(operateContext): åˆ›å»ºæ—¶è°ƒç”¨
  - <span class="hljs-title function_">onUpdated</span>(operateContext): æ›´æ–°æ—¶è°ƒç”¨

  <span class="hljs-number">6.</span> æ§åˆ¶å™¨è§„èŒƒ

  è£…é¥°å™¨é¡ºåºï¼š
  <span class="hljs-meta">@Controller</span>(<span class="hljs-string">'route'</span>)              <span class="hljs-comment">// 1. è·¯ç”±å®šä¹‰</span>
  <span class="hljs-meta">@UseGuards</span>(<span class="hljs-title class_">JwtAuthGuard</span>, <span class="hljs-title class_">RolesGuard</span>) <span class="hljs-comment">// 2. å®ˆå«</span>
  <span class="hljs-meta">@Roles</span>(<span class="hljs-title class_">UserType</span>.<span class="hljs-property">admin</span>)            <span class="hljs-comment">// 3. è§’è‰²æ§åˆ¶</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">methodName</span>(<span class="hljs-params"/>) { }            <span class="hljs-comment">// 4. æ–¹æ³•å®ç°</span>

  ä¾èµ–æ³¨å…¥ï¼š
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> courseService: CourseService,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> userService: UserService,
  </span>) {}

  <span class="hljs-number">7.</span> æœåŠ¡å±‚è§„èŒƒ

  å¼‚å¸¸å¤„ç†ï¼š
  - èµ„æºä¸å­˜åœ¨ï¼š<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NotFoundException</span>(<span class="hljs-string">'èµ„æºä¸å­˜åœ¨'</span>)
  - å†²çªï¼š<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConflictException</span>(<span class="hljs-string">'èµ„æºå·²å­˜åœ¨'</span>)
  - å‚æ•°é”™è¯¯ï¼š<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BadRequestException</span>(<span class="hljs-string">'å‚æ•°é”™è¯¯'</span>)

  æ“ä½œæ¨¡å¼ï¼š
  <span class="hljs-comment">// 1. éªŒè¯</span>
  <span class="hljs-keyword">const</span> exists = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">repository</span>.<span class="hljs-title function_">existsByName</span>(name);
  <span class="hljs-keyword">if</span> (exists) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConflictException</span>(<span class="hljs-string">'åç§°å·²å­˜åœ¨'</span>);
  }

  <span class="hljs-comment">// 2. è½¬æ¢DTOä¸ºEntity</span>
  <span class="hljs-keyword">const</span> entity = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CourseCreateEntity</span>(dto);
  entity.<span class="hljs-title function_">onCreated</span>(operateContext);

  <span class="hljs-comment">// 3. æŒä¹…åŒ–</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">repository</span>.<span class="hljs-title function_">create</span>(entity);

  <span class="hljs-number">8.</span> æŸ¥è¯¢è§„èŒƒ

  æŸ¥è¯¢è¿‡æ»¤å™¨ (<span class="hljs-title class_">QueryFilter</span>):
  {
    <span class="hljs-attr">page</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">pageSize</span>: <span class="hljs-number">10</span>,
    keyword?: <span class="hljs-built_in">string</span>,
    isActive?: <span class="hljs-built_in">boolean</span>,
    sorts?: [{ <span class="hljs-attr">field</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">direction</span>: <span class="hljs-string">'asc'</span>|<span class="hljs-string">'desc'</span> }]
  }

  æŸ¥è¯¢ç»“æœ (<span class="hljs-title class_">QueryResult</span>&lt;T&gt;):
  {
    <span class="hljs-attr">records</span>: T[],
    <span class="hljs-attr">page</span>: <span class="hljs-built_in">number</span>,
    <span class="hljs-attr">pageSize</span>: <span class="hljs-built_in">number</span>,
    <span class="hljs-attr">total</span>: <span class="hljs-built_in">number</span>
  }

  <span class="hljs-number">9.</span> è®¤è¯æˆæƒè§„èŒƒ

  è®¤è¯æ–¹å¼ï¼š
  - <span class="hljs-title class_">Basic</span> <span class="hljs-title class_">Auth</span>: ç®¡ç†å‘˜è·å–åˆå§‹<span class="hljs-title class_">Token</span>
  - <span class="hljs-variable constant_">JWT</span> <span class="hljs-title class_">Bearer</span>: æ ‡å‡†<span class="hljs-variable constant_">API</span>è°ƒç”¨
  - <span class="hljs-title class_">Refresh</span> <span class="hljs-title class_">Token</span>: åˆ·æ–°è®¿é—®ä»¤ç‰Œ

  è§’è‰²ç±»å‹ (<span class="hljs-title class_">UserType</span>):
  - <span class="hljs-attr">admin</span>: ç®¡ç†å‘˜ï¼ˆå®Œå…¨æƒé™ï¼‰
  - <span class="hljs-attr">teacher</span>: æ•™å¸ˆï¼ˆè¯¾ç¨‹ç›¸å…³æƒé™ï¼‰
  - <span class="hljs-attr">student</span>: å­¦ç”Ÿï¼ˆåªè¯»æƒé™ï¼‰

  ä½¿ç”¨æ–¹å¼ï¼š
  <span class="hljs-meta">@UseGuards</span>(<span class="hljs-title class_">JwtAuthGuard</span>, <span class="hljs-title class_">RolesGuard</span>)
  <span class="hljs-meta">@Roles</span>(<span class="hljs-title class_">UserType</span>.<span class="hljs-property">admin</span>)
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">adminOnlyMethod</span>(<span class="hljs-params"/>) { }

  <span class="hljs-meta">@AccessContext</span>() <span class="hljs-attr">operateContext</span>: <span class="hljs-title class_">OperateContext</span>  <span class="hljs-comment">// è·å–å½“å‰æ“ä½œäºº</span>

  <span class="hljs-number">10.</span> æ—¥å¿—è§„èŒƒ

  æ—¥å¿—çº§åˆ«ï¼š
  - <span class="hljs-attr">error</span>: é”™è¯¯ï¼Œéœ€è¦ç«‹å³å¤„ç†
  - <span class="hljs-attr">warn</span>: è­¦å‘Šï¼Œéœ€è¦å…³æ³¨
  - <span class="hljs-attr">info</span>: ä¸€èˆ¬ä¿¡æ¯
  - <span class="hljs-attr">debug</span>: è°ƒè¯•ä¿¡æ¯

  æ—¥å¿—è½®è½¬ï¼šæŒ‰æ—¥æœŸè‡ªåŠ¨è½®è½¬ï¼Œæ–‡ä»¶åæ ¼å¼ï¼šapplication-<span class="hljs-variable constant_">YYYY</span>-<span class="hljs-variable constant_">MM</span>-<span class="hljs-variable constant_">DD</span>.<span class="hljs-property">log</span>

  ---
  ğŸ”§ å¼€å‘å‘½ä»¤

  # å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
  npm run <span class="hljs-attr">start</span>:dev

  # ç”Ÿäº§æ„å»º
  npm run build
  npm run <span class="hljs-attr">start</span>:prod

  # æ•°æ®åº“æ“ä½œ
  npm run <span class="hljs-attr">prisma</span>:generate    # ç”Ÿæˆ<span class="hljs-title class_">Prisma</span>å®¢æˆ·ç«¯
  npm run <span class="hljs-attr">prisma</span>:migrate     # æ‰§è¡Œè¿ç§»
  npm run <span class="hljs-attr">prisma</span>:seed        # å¡«å……ç§å­æ•°æ®
  npm run <span class="hljs-attr">prisma</span>:studio      # æ‰“å¼€æ•°æ®åº“ç®¡ç†ç•Œé¢

  # ä»£ç è´¨é‡
  npm run lint              # <span class="hljs-title class_">ESLint</span>æ£€æŸ¥
  npm run format            # <span class="hljs-title class_">Prettier</span>æ ¼å¼åŒ–

  # æµ‹è¯•
  npm run test              # å•å…ƒæµ‹è¯•
  npm run <span class="hljs-attr">test</span>:e2e          # ç«¯åˆ°ç«¯æµ‹è¯•
  npm run <span class="hljs-attr">test</span>:cov          # æµ‹è¯•è¦†ç›–ç‡

  ---
  ğŸ“ æ ¸å¿ƒè®¾è®¡åŸåˆ™

  <span class="hljs-number">1.</span> å•ä¸€èŒè´£: æ¯ä¸ªç±»åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½é¢†åŸŸ
  <span class="hljs-number">2.</span> ä¾èµ–æ³¨å…¥: ä½¿ç”¨<span class="hljs-title class_">NestJS</span>çš„<span class="hljs-variable constant_">DI</span>å®¹å™¨ç®¡ç†ä¾èµ–
  <span class="hljs-number">3.</span> åˆ†å±‚æ¶æ„: <span class="hljs-title class_">Controller</span> â†’ <span class="hljs-title class_">Service</span> â†’ <span class="hljs-title class_">Repository</span> æ¸…æ™°åˆ†ç¦»
  <span class="hljs-number">4.</span> å®ä½“è½¬æ¢: <span class="hljs-variable constant_">DTO</span> â†” <span class="hljs-title class_">Entity</span> â†” <span class="hljs-variable constant_">PO</span> åˆ†å±‚è½¬æ¢
  <span class="hljs-number">5.</span> å®¡è®¡è¿½è¸ª: æ‰€æœ‰å†™æ“ä½œè‡ªåŠ¨è®°å½•åˆ›å»ºäºº/æ›´æ–°äºº
  <span class="hljs-number">6.</span> å¼‚å¸¸ç»Ÿä¸€: ä½¿ç”¨<span class="hljs-title class_">NestJS</span>å†…ç½®å¼‚å¸¸ï¼Œç»Ÿä¸€é”™è¯¯å¤„ç†
  <span class="hljs-number">7.</span> ç±»å‹å®‰å…¨: å…¨é“¾è·¯<span class="hljs-title class_">TypeScript</span>ç±»å‹æ£€æŸ¥
</code></pre>
<h3 data-id="heading-16">3.3 æŠ€æœ¯æ ˆï¼šJava+Spring Boot2</h3>
<h4 data-id="heading-17">3.3.1 è¯„æµ‹ç»“æœ</h4>
<blockquote>
<p>GLM-4.7åœ¨Javaé¡¹ç›®ç†è§£æ·±åº¦ã€è§„èŒƒå®Œæ•´æ€§å’Œå®ç”¨æ€§ä¸Šæ˜æ˜¾ä¼˜äºMiniMax-M2.1ã€‚</p>
</blockquote>
<h5 data-id="heading-18">3.3.1.1 MiniMax-M2.1</h5>
<blockquote>
<p>å¾—åˆ†ï¼š16</p>
</blockquote>



































<table><thead><tr><th>ç»´åº¦</th><th>è¯„åˆ†</th><th>è¯„ä»·ç†ç”±</th></tr></thead><tbody><tr><td>æŠ€æœ¯æ ˆè¯†åˆ«</td><td>4</td><td>åˆ—å‡ºä¸»è¦æŠ€æœ¯æ ˆï¼Œä½†éƒ¨åˆ†ç»„ä»¶ï¼ˆå¦‚MyBatisç»†èŠ‚ã€ç›‘æ§å·¥å…·ï¼‰æè¿°è¾ƒç®€</td></tr><tr><td>æ¶æ„ç†è§£æ·±åº¦</td><td>3</td><td>æè¿°åŸºæœ¬ç»“æ„ï¼Œç¼ºä¹æ·±åº¦åˆ†å±‚å’Œè®¾è®¡æ¨¡å¼åˆ†æ</td></tr><tr><td>è§„èŒƒå®Œæ•´æ€§</td><td>3</td><td>æ¶µç›–åŸºç¡€è§„èŒƒï¼Œä½†ç¼ºä¹å¼‚å¸¸å¤„ç†ã€äº‹åŠ¡ã€æ—¥å¿—ç­‰ç»†èŠ‚</td></tr><tr><td>è¾“å‡ºä¸“ä¸šæ€§</td><td>3</td><td>æè¿°åŸºæœ¬æ­£ç¡®ï¼Œä½†ç¼ºä¹æ¶æ„ç†å¿µå’Œå·¥ç¨‹æ€ç»´ä½“ç°</td></tr><tr><td>å®ç”¨æ€§</td><td>3</td><td>æœ‰é¡¹ç›®ç»“æ„å’ŒåŸºæœ¬å‘½ä»¤ï¼Œä½†ç¼ºå°‘å…·ä½“ä»£ç ç¤ºä¾‹å’Œæœ€ä½³å®è·µ</td></tr></tbody></table>
<h5 data-id="heading-19">3.3.1.2 GLM-4.7</h5>
<blockquote>
<p>å¾—åˆ†ï¼š25</p>
</blockquote>



































<table><thead><tr><th>ç»´åº¦</th><th>è¯„åˆ†</th><th>è¯„ä»·ç†ç”±</th></tr></thead><tbody><tr><td>æŠ€æœ¯æ ˆè¯†åˆ«</td><td>5</td><td>å®Œæ•´è¯†åˆ«æŠ€æœ¯æ ˆï¼ŒåŒ…æ‹¬åŸºç¡€è®¾æ–½ç»„ä»¶å’Œç›‘æ§å·¥å…·</td></tr><tr><td>æ¶æ„ç†è§£æ·±åº¦</td><td>5</td><td>è¯¦ç»†æè¿°åˆ†å±‚æ¶æ„ã€æ¨¡å—èŒè´£ã€ä¾èµ–æ³¨å…¥ã€å¤–éƒ¨æœåŠ¡è°ƒç”¨ç­‰</td></tr><tr><td>è§„èŒƒå®Œæ•´æ€§</td><td>5</td><td>è¦†ç›–å¼‚å¸¸ã€äº‹åŠ¡ã€æ—¥å¿—ã€é…ç½®ã€æ³¨é‡Šã€SOLIDåŸåˆ™ç­‰å®Œæ•´è§„èŒƒ</td></tr><tr><td>è¾“å‡ºä¸“ä¸šæ€§</td><td>5</td><td>æœ¯è¯­å‡†ç¡®ï¼Œæ¶æ„æ¸…æ™°ï¼Œä½“ç°ä¼ä¸šçº§å¼€å‘ç†å¿µ</td></tr><tr><td>å®ç”¨æ€§</td><td>5</td><td>æä¾›è¯¦ç»†ä»£ç ç¤ºä¾‹ã€é…ç½®è¯´æ˜ã€å¼€å‘åŸåˆ™å’Œæ£€æŸ¥æ¸…å•</td></tr></tbody></table>
<h4 data-id="heading-20">3.3.2 æ¨¡å‹è¾“å‡ºç»“æœ</h4>
<h5 data-id="heading-21">3.3.2.1 MiniMax-M2.1</h5>
<pre><code class="hljs language-typescript" lang="typescript">  <span class="hljs-variable constant_">LAB</span>-<span class="hljs-variable constant_">PROJECT</span> é¡¹ç›®æŠ€æœ¯æ ˆä¸ç¼–ç¨‹è§„èŒƒ

  ä¸€ã€é¡¹ç›®æ¦‚è¿°

  | é¡¹ç›®å±æ€§ | è¯´æ˜                                       |
  |----------|--------------------------------------------|
  | é¡¹ç›®åç§° | åŒä¸‰æ–¹åä½œå¹³å°çš„å¯¹æ¥æœåŠ¡            |
  | é¡¹ç›®ç®€ç§° | lab                                       |
  | ç‰ˆæœ¬     | <span class="hljs-number">1.13</span>-<span class="hljs-variable constant_">SNAPSHOT</span>                              |
  | é¡¹ç›®ç±»å‹ | å¤šæ¨¡å— <span class="hljs-title class_">Maven</span> é¡¹ç›®                          |
  | <span class="hljs-title class_">GitLab</span>   | <span class="hljs-attr">https</span>:<span class="hljs-comment">//xx/LAB/lab.git |</span>

  ---
  äºŒã€æŠ€æœ¯æ ˆ

  <span class="hljs-number">2.1</span> åç«¯æŠ€æœ¯æ ˆ

  | æŠ€æœ¯                   | ç‰ˆæœ¬/è¯´æ˜ | ç”¨é€”             |
  |------------------------|-----------|------------------|
  | <span class="hljs-title class_">Java</span>                   | <span class="hljs-number">1.8</span>       | ç¼–ç¨‹è¯­è¨€         |
  | <span class="hljs-title class_">Spring</span> <span class="hljs-title class_">Boot</span>            | -         | åº”ç”¨æ¡†æ¶æ ¸å¿ƒ     |
  | <span class="hljs-title class_">Spring</span> <span class="hljs-title class_">Cloud</span> <span class="hljs-title class_">OpenFeign</span> | -         | å£°æ˜å¼<span class="hljs-variable constant_">HTTP</span>å®¢æˆ·ç«¯ |
  | <span class="hljs-title class_">Tomcat</span> <span class="hljs-title class_">Embedded</span>        | <span class="hljs-number">9.0</span><span class="hljs-number">.69</span>    | å†…åµŒ<span class="hljs-title class_">Web</span>å®¹å™¨      |
  | <span class="hljs-title class_">MyBatis</span>/<span class="hljs-title class_">Custom</span>-<span class="hljs-variable constant_">DAO</span>   | -         | æ•°æ®è®¿é—®å±‚       |
  | <span class="hljs-title class_">Oracle</span> <span class="hljs-variable constant_">JDBC</span>            | ojdbc6    | æ•°æ®åº“é©±åŠ¨       |
  | <span class="hljs-title class_">Druid</span>                  | -         | æ•°æ®åº“è¿æ¥æ±      |
  | <span class="hljs-title class_">Custom</span>               | <span class="hljs-number">2.15</span>      | ä¸ªäººæœåŠ¡æ¡†æ¶     |
  | custom-<span class="hljs-title class_">Commons</span>          | <span class="hljs-number">2.</span>x       | ä¸ªäººå…¬å…±ç»„ä»¶åº“   |
  | <span class="hljs-title class_">Logback</span>                | <span class="hljs-number">1.2</span><span class="hljs-number">.11</span>    | æ—¥å¿—æ¡†æ¶         |
  | <span class="hljs-title class_">Lombok</span>                 | -         | ä»£ç ç®€åŒ–         |

  <span class="hljs-number">2.2</span> <span class="hljs-variable constant_">API</span>æ–‡æ¡£

  | æŠ€æœ¯              | ç”¨é€”           |
  |-------------------|----------------|
  | <span class="hljs-title class_">Swagger</span>/<span class="hljs-title class_">Springfox</span> | <span class="hljs-variable constant_">API</span>æ¥å£æ–‡æ¡£    |
  | <span class="hljs-title class_">Knife4</span>j           | <span class="hljs-title class_">Swagger</span> <span class="hljs-variable constant_">UI</span>å¢å¼º |

  <span class="hljs-number">2.3</span> ä¸ªäººåŸºç¡€è®¾æ–½ç»„ä»¶

  | ç»„ä»¶             | ç”¨é€”                         |
  |------------------|------------------------------|
  | custom-event     | äº‹ä»¶è°ƒç”¨ï¼ˆæ¶ˆæ¯é˜Ÿåˆ—å¯é æŠ•é€’ï¼‰ |
  | custom-rdb-version     | æ•°æ®åº“ç‰ˆæœ¬ç®¡ç†               |
  | custom-micrometer | æŒ‡æ ‡ç›‘æ§ï¼ˆ<span class="hljs-title class_">Prometheus</span>ï¼‰       |
  | custom-job     | å®šæ—¶ä»»åŠ¡è°ƒåº¦                 |
  | custom-sequence   | åˆ†å¸ƒå¼åºåˆ—å·ç”Ÿæˆ             |
  | custom-snowflake  | é›ªèŠ±ç®—æ³•<span class="hljs-variable constant_">ID</span>ç”Ÿæˆ               |

  ---
  ä¸‰ã€é¡¹ç›®æ¨¡å—ç»“æ„

  lab (çˆ¶<span class="hljs-variable constant_">POM</span>)
  â”œâ”€â”€ pom.<span class="hljs-property">xml</span>
  â”œâ”€â”€ lab-api              # å¯¹å¤–æœåŠ¡æ¥å£å¯¹è±¡
  â”‚   â””â”€â”€ src/main/java/com/custom/lab/api/
  â”‚       â””â”€â”€ domain/       # é¢†åŸŸå¯¹è±¡å®šä¹‰
  â”œâ”€â”€ lab-core             # æœåŠ¡æ•°æ®è®¿é—®å±‚
  â”‚   â””â”€â”€ src/main/java/com/custom/lab/
  â”‚       â”œâ”€â”€ commons/      # å…¬å…±ç»„ä»¶
  â”‚       â”œâ”€â”€ domain/       # ä¸šåŠ¡é¢†åŸŸ
  â”‚       â”‚   â”œâ”€â”€ config/
  â”‚       â”‚   â”œâ”€â”€ department/
  â”‚       â”‚   â”œâ”€â”€ feishu/
  â”‚       â”‚   â”œâ”€â”€ message/
  â”‚       â”‚   â”œâ”€â”€ orgUser/
  â”‚       â”‚   â”œâ”€â”€ store/
  â”‚       â”‚   â””â”€â”€ user/
  â”‚       â””â”€â”€ feishu/       # é£ä¹¦å®¢æˆ·ç«¯
  â”œâ”€â”€ lab-service          # å¯¹å¤–æœåŠ¡å®ç°ï¼ˆ<span class="hljs-title class_">Spring</span> <span class="hljs-title class_">Boot</span>ä¸»æ¨¡å—ï¼‰
  â”‚   â”œâ”€â”€ src/main/java/com/custom/lab/
  â”‚   â”‚   â”œâ”€â”€ <span class="hljs-title class_">Application</span>.<span class="hljs-property">java</span>  # å¯åŠ¨ç±»
  â”‚   â”‚   â”œâ”€â”€ config/
  â”‚   â”‚   â”œâ”€â”€ domain/
  â”‚   â”‚   â”œâ”€â”€ feishu/
  â”‚   â”‚   â”œâ”€â”€ web/
  â”‚   â”‚   â”œâ”€â”€ wecom/
  â”‚   â”‚   â””â”€â”€ health/
  â”‚   â””â”€â”€ src/main/resources/
  â”‚       â”œâ”€â”€ application.<span class="hljs-property">yml</span>
  â”‚       â”œâ”€â”€ logback.<span class="hljs-property">xml</span>
  â”‚       â””â”€â”€ <span class="hljs-keyword">public</span>/       # é™æ€èµ„æº
  â”œâ”€â”€ lab-rdb-scripts      # æ•°æ®åº“å®‰è£…è„šæœ¬
  â”œâ”€â”€ lab-rdb-setup        # æ•°æ®åº“å®‰è£…ç¨‹åº
  â””â”€â”€ lab-rdb-upgrade      # æ•°æ®åº“å‡çº§ç¨‹åº

  ---
  å››ã€ä»£ç åˆ†å±‚æ¶æ„

  <span class="hljs-title class_">Controller</span>å±‚ (<span class="hljs-variable constant_">REST</span> <span class="hljs-variable constant_">API</span>)
      â†“
  <span class="hljs-title class_">Service</span>å±‚ (ä¸šåŠ¡é€»è¾‘)
      â†“
  <span class="hljs-title class_">Repository</span>/<span class="hljs-variable constant_">DAO</span>å±‚ (æ•°æ®è®¿é—®)
      â†“
  æ•°æ®åº“ (<span class="hljs-title class_">Oracle</span>)

  ---
  äº”ã€ç¼–ç¨‹è§„èŒƒ

  <span class="hljs-number">5.1</span> æ–‡ä»¶å¤´ç‰ˆæƒå£°æ˜

  <span class="hljs-comment">/**
   * ç‰ˆæƒæ‰€æœ‰(C)ï¼Œä¸ªäººæ‰€æœ‰ï¼Œ2021ï¼Œæ‰€æœ‰æƒåˆ©ä¿ç•™ã€‚
   * &lt;p&gt;
   * é¡¹ç›®åï¼š lab
   * æ–‡ä»¶åï¼š æ–‡ä»¶å.java
   * æ¨¡å—è¯´æ˜ï¼š
   * ä¿®æ”¹å†å²ï¼š
   * 2022å¹´05æœˆ18æ—¥ - zhangsan - åˆ›å»ºã€‚
   */</span>

  <span class="hljs-number">5.2</span> åŒ…å‘½åè§„èŒƒ

  <span class="hljs-comment">// åŸºç¡€åŒ…ç»“æ„</span>
  com.<span class="hljs-property">custom</span>.<span class="hljs-property">lab</span>.{æ¨¡å—å}

  <span class="hljs-comment">// ç¤ºä¾‹</span>
  com.<span class="hljs-property">custom</span>.<span class="hljs-property">lab</span>.<span class="hljs-property">domain</span>.<span class="hljs-property">department</span>
  com.<span class="hljs-property">custom</span>.<span class="hljs-property">lab</span>.<span class="hljs-property">feishu</span>
  com.<span class="hljs-property">custom</span>.<span class="hljs-property">lab</span>.<span class="hljs-property">wecom</span>

  <span class="hljs-number">5.3</span> ç±»å‘½åè§„èŒƒ

  | ç±»å‹     | è§„èŒƒ              | ç¤ºä¾‹                      |
  |----------|-------------------|---------------------------|
  | å®ä½“ç±»   | ç®€å•åè¯          | <span class="hljs-title class_">Department</span>, <span class="hljs-title class_">User</span>          |
  | æœåŠ¡æ¥å£ | {æ¨¡å—}<span class="hljs-title class_">Service</span>     | <span class="hljs-title class_">DepartmentService</span>         |
  | æœåŠ¡å®ç° | {æ¨¡å—}<span class="hljs-title class_">ServiceImpl</span> | <span class="hljs-title class_">UserOperLogServiceImpl</span> |
  | æ§åˆ¶å™¨   | {æ¨¡å—}<span class="hljs-title class_">Controller</span>  | <span class="hljs-title class_">FeiShuController</span>          |
  | å¸¸é‡ç±»   | {æ¨¡å—}<span class="hljs-title class_">Constants</span>   | -                         |

  <span class="hljs-number">5.4</span> æ–¹æ³•å‘½åè§„èŒƒ

  | ç±»å‹     | è§„èŒƒ            | ç¤ºä¾‹                    |
  |----------|-----------------|-------------------------|
  | è·å–å•ä¸ª | getBy{<span class="hljs-title class_">Field</span>}    | <span class="hljs-title function_">getBy</span>(<span class="hljs-title class_">String</span> code)      |
  | ä¿å­˜     | save            | <span class="hljs-title function_">save</span>(<span class="hljs-title class_">Department</span> dept)   |
  | åˆ é™¤     | <span class="hljs-keyword">delete</span>          | <span class="hljs-title function_">delete</span>(<span class="hljs-title class_">Department</span> dept) |
  | æŸ¥è¯¢åˆ—è¡¨ | query æˆ– getAll | <span class="hljs-title function_">query</span>(<span class="hljs-title class_">Filter</span> filter)    |

  <span class="hljs-number">5.5</span> <span class="hljs-title class_">Controller</span> è§„èŒƒ

  <span class="hljs-meta">@Slf4j</span>
  <span class="hljs-meta">@Api</span>(tags = <span class="hljs-title class_">FeiShuController</span>.<span class="hljs-property">TAG</span>)
  <span class="hljs-meta">@RestController</span>
  <span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">"/v1/feishu"</span>)
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FeiShuController</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> final <span class="hljs-title class_">String</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"é£ä¹¦"</span>;

    <span class="hljs-meta">@ApiOperation</span>(value = <span class="hljs-string">"æ¥å£æè¿°"</span>)
    <span class="hljs-meta">@PostMapping</span>(value = <span class="hljs-string">"/login"</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Response</span>&lt;<span class="hljs-title class_">LoginResult</span>&gt; <span class="hljs-title function_">login</span>(<span class="hljs-params"><span class="hljs-meta">@RequestBody</span> RequestDTO request</span>) {
      <span class="hljs-comment">// ...</span>
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Response</span>.<span class="hljs-title function_">success</span>(result);
    }
  }

  è§„èŒƒè¦ç‚¹ï¼š
  - ä½¿ç”¨ <span class="hljs-meta">@Api</span> å’Œ <span class="hljs-meta">@ApiOperation</span> æ³¨è§£
  - è·¯å¾„ä½¿ç”¨ <span class="hljs-title class_">RESTful</span> é£æ ¼ï¼š/v1/{platform}/{resource}
  - è¿”å›ç»Ÿä¸€ä½¿ç”¨ <span class="hljs-title class_">Response</span>&lt;T&gt; åŒ…è£…
  - ä½¿ç”¨ <span class="hljs-meta">@Slf4j</span> æ‰“å°æ—¥å¿—

  <span class="hljs-number">5.6</span> å®ä½“ç±»è§„èŒƒ

  <span class="hljs-meta">@Data</span>
  <span class="hljs-meta">@EqualsAndHashCode</span>(callSuper = <span class="hljs-literal">true</span>)
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Department</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Entity</span> {
    <span class="hljs-meta">@ApiModelProperty</span>(<span class="hljs-string">"éƒ¨é—¨ä»£ç "</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> code;
    <span class="hljs-meta">@ApiModelProperty</span>(<span class="hljs-string">"éƒ¨é—¨åç§°"</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> name;
  }

  è§„èŒƒè¦ç‚¹ï¼š
  - ä½¿ç”¨ <span class="hljs-title class_">Lombok</span> <span class="hljs-meta">@Data</span>ã€<span class="hljs-meta">@EqualsAndHashCode</span>(callSuper = <span class="hljs-literal">true</span>)
  - ç»§æ‰¿ <span class="hljs-title class_">Entity</span> åŸºç±»
  - å­—æ®µä½¿ç”¨ <span class="hljs-meta">@ApiModelProperty</span> æ³¨é‡Š
  - ä¸ä½¿ç”¨ <span class="hljs-meta">@Data</span> æ³¨è§£æ—¶æ‰‹åŠ¨æ·»åŠ  <span class="hljs-title function_">toString</span>()

  <span class="hljs-number">5.7</span> å¼‚å¸¸å¤„ç†

  <span class="hljs-comment">// Service å±‚æŠ›å‡ºå¼‚å¸¸</span>
  <span class="hljs-built_in">void</span> <span class="hljs-title function_">save</span>(<span class="hljs-title class_">Department</span> department) throws <span class="hljs-title class_">CustomServiceException</span>;

  <span class="hljs-comment">// å¼‚å¸¸ç±»å‹</span>
  com.<span class="hljs-property">custom</span>.<span class="hljs-property">exception</span>.<span class="hljs-property">CustomServiceException</span>

  <span class="hljs-number">5.8</span> æ—¥å¿—è§„èŒƒ

  <span class="hljs-meta">@Slf4j</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SomeService</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">doSomething</span>(<span class="hljs-params"/>) {
      log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"å¼€å§‹å¤„ç†..."</span>);
      log.<span class="hljs-title function_">debug</span>(<span class="hljs-string">"è¯¦ç»†å‚æ•°: {}"</span>, param);
      log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"é”™è¯¯ä¿¡æ¯"</span>, exception);
    }
  }

  <span class="hljs-number">5.9</span> é…ç½®è§„èŒƒ

  # application.<span class="hljs-property">yml</span> æ³¨é‡Šé£æ ¼
  #==========================================================
  # åº”ç”¨æœåŠ¡å™¨é…ç½®
  #==========================================================
  <span class="hljs-attr">server</span>:
    <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>  # æœåŠ¡è¿è¡Œç«¯å£

  ---
  å…­ã€<span class="hljs-variable constant_">API</span> å“åº”è§„èŒƒ

  <span class="hljs-comment">// æˆåŠŸå“åº”</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Response</span>.<span class="hljs-title function_">success</span>(result);

  <span class="hljs-comment">// å¤±è´¥å“åº”ï¼ˆä½¿ç”¨ CustomServiceExceptionï¼‰</span>
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomServiceException</span>(<span class="hljs-string">"é”™è¯¯æè¿°"</span>);

  ---
  ä¸ƒã€<span class="hljs-title class_">Git</span> æäº¤è§„èŒƒ

  é¡¹ç›®ä½¿ç”¨ <span class="hljs-title class_">Conventional</span> <span class="hljs-title class_">Commits</span> æ ‡å‡†ï¼Œæäº¤ä¿¡æ¯æ ¼å¼ï¼š

  &lt;<span class="hljs-keyword">type</span>&gt;(&lt;scope&gt;): &lt;subject&gt;

  # ç¤ºä¾‹
  <span class="hljs-title function_">feat</span>(feishu): å¢åŠ é£ä¹¦ç™»å½•åŠŸèƒ½
  <span class="hljs-title function_">fix</span>(department): ä¿®å¤éƒ¨é—¨åŒæ­¥bug
  <span class="hljs-attr">docs</span>: æ›´æ–°<span class="hljs-variable constant_">README</span>

  ---
  å…«ã€ç›¸å…³æ–‡æ¡£

  | æ–‡æ¡£è·¯å¾„                       | å†…å®¹     |
  |--------------------------------|----------|
  | doc/design/é£ä¹¦å¯¹æ¥è®¾è®¡æ–‡æ¡£.<span class="hljs-property">md</span> | è®¾è®¡æ–‡æ¡£ |
  | doc/devops/éƒ¨ç½²é…ç½®è¯´æ˜.<span class="hljs-property">md</span>     | éƒ¨ç½²é…ç½® |
  | doc/faq/<span class="hljs-variable constant_">FAQ</span>.<span class="hljs-property">md</span>                 | å¸¸è§é—®é¢˜ |
  | <span class="hljs-variable constant_">README</span>.<span class="hljs-property">md</span>                      | é¡¹ç›®æ¦‚è¿° |

  ---
  ä¹ã€å…³é”®é…ç½®

  | é…ç½®é¡¹      | å€¼                     |
  |-------------|------------------------|
  | æœåŠ¡ç«¯å£    | <span class="hljs-number">8080</span>                   |
  | ç›‘æ§ç«¯å£    | <span class="hljs-number">8081</span>                   |
  | ä¸Šä¸‹æ–‡è·¯å¾„  | /lab-service          |
  | <span class="hljs-variable constant_">API</span>æ–‡æ¡£åœ°å€ | <span class="hljs-regexp">/lab-service/</span>doc.<span class="hljs-property">html</span> |
  | é»˜è®¤ç¯å¢ƒ    | prd                    |
</code></pre>
<h5 data-id="heading-22">3.3.2.2 GLM-4.7</h5>
<pre><code class="hljs language-java" lang="java"> æ ¹æ®ä»£ç åº“åˆ†æï¼Œæˆ‘ä¸ºä½ æ•´ç†äº†å®Œæ•´çš„æŠ€æœ¯æ ˆã€ä»£ç ç»“æ„å’Œç¼–ç¨‹è§„èŒƒï¼š

  ---
  ğŸ“Š æŠ€æœ¯æ ˆæ¦‚è§ˆ

  æ ¸å¿ƒæ¡†æ¶

  | æŠ€æœ¯                   | ç‰ˆæœ¬   | ç”¨é€”             |
  |------------------------|--------|------------------|
  | Spring Boot            | <span class="hljs-number">2.</span>x    | åº”ç”¨æ¡†æ¶         |
  | lab               | <span class="hljs-number">2.15</span>   | ä¸ªäººåº”ç”¨å¼€å‘æ¡†æ¶ |
  | custom                  | å¤šç»„ä»¶ | ä¼ä¸šç»„ä»¶åº“       |
  | Spring Cloud OpenFeign | -      | RESTå®¢æˆ·ç«¯       |
  | Lombok                 | -      | ä»£ç ç®€åŒ–         |

  æŒä¹…å±‚ä¸æ•°æ®åº“

  - Spring JDBC + Druid è¿æ¥æ± 
  - Oracle (ä¸»è¦) / MySQL / PostgreSQL
  - custom RDB æ•°æ®åº“ç‰ˆæœ¬ç®¡ç†

  ç›‘æ§ä¸æ–‡æ¡£

  - Swagger/Knife4j - APIæ–‡æ¡£
  - Micrometer/Prometheus - ç›‘æ§æŒ‡æ ‡
  - Logback - æ—¥å¿—æ¡†æ¶

  ---
  ğŸ—ï¸ ä»£ç ç»“æ„

  lab/
  â”œâ”€â”€ lab-api/              # APIæ¥å£å¯¹è±¡å±‚
  â”‚   â””â”€â”€ domain/            # é¢†åŸŸå¯¹è±¡å®šä¹‰
  â”‚
  â”œâ”€â”€ lab-core/             # æ ¸å¿ƒä¸šåŠ¡å±‚
  â”‚   â”œâ”€â”€ commons/           # å…¬å…±å·¥å…·(JDBCç­‰)
  â”‚   â”œâ”€â”€ domain/            # é¢†åŸŸæœåŠ¡
  â”‚   â”‚   â”œâ”€â”€ department/    # éƒ¨é—¨ç®¡ç†
  â”‚   â”‚   â”œâ”€â”€ feishu/        # é£ä¹¦é›†æˆ
  â”‚   â”‚   â”œâ”€â”€ wecom/         # ä¼ä¸šå¾®ä¿¡
  â”‚   â”‚   â”œâ”€â”€ user/          # ç”¨æˆ·ç®¡ç†
  â”‚   â”‚   â””â”€â”€ store/         # é—¨åº—ç®¡ç†
  â”‚   â””â”€â”€ feishu/            # é£ä¹¦ä¸šåŠ¡æœåŠ¡
  â”‚
  â”œâ”€â”€ lab-service/          # WebæœåŠ¡å±‚(ä¸»åº”ç”¨)
  â”‚   â”œâ”€â”€ config/            # Springé…ç½®
  â”‚   â”œâ”€â”€ domain/            # æœåŠ¡å®ç°
  â”‚   â”œâ”€â”€ feishu/            # é£ä¹¦æ§åˆ¶å™¨
  â”‚   â”œâ”€â”€ wecom/             # ä¼ä¸šå¾®ä¿¡æ§åˆ¶å™¨
  â”‚   â””â”€â”€ Application.java   # å¯åŠ¨ç±»
  â”‚
  â””â”€â”€ pom.xml                # Mavençˆ¶POM

  åˆ†å±‚åŸåˆ™ï¼š
  <span class="hljs-number">1.</span> lab-api - å¯¹å¤–æ¥å£å®šä¹‰ï¼Œæ— ä¸šåŠ¡é€»è¾‘
  <span class="hljs-number">2.</span> lab-core - æ ¸å¿ƒä¸šåŠ¡ + æ•°æ®è®¿é—®
  <span class="hljs-number">3.</span> lab-service - Webå±‚ï¼Œä»…å¤„ç†HTTPè¯·æ±‚/å“åº”

  ---
  ğŸ“ ç¼–ç¨‹è§„èŒƒ

  <span class="hljs-number">4.</span> åŒ…å‘½åè§„èŒƒ

  com.custom.lab
  â”œâ”€â”€ domain.{feature}        # é¢†åŸŸå¯¹è±¡
  â”‚   â”œâ”€â”€ repository/         # æ•°æ®è®¿é—®å±‚
  â”‚   â””â”€â”€ service/            # é¢†åŸŸæœåŠ¡
  â”œâ”€â”€ commons                 # å…¬å…±å·¥å…·
  â”œâ”€â”€ config                  # é…ç½®ç±»
  â””â”€â”€ {platform}             # å¹³å°æ§åˆ¶å™¨(feishu/wecom)

  ç¤ºä¾‹ï¼š
  <span class="hljs-comment">// âœ… æ­£ç¡®</span>
  com.custom.lab.domain.user.repository.UserRepository
  com.custom.lab.domain.user.service.UserService
  com.custom.lab.feishu.FeiShuController

  <span class="hljs-comment">// âŒ é”™è¯¯</span>
  com.custom.lab.user.UserDao
  com.custom.UserController

  ---
  <span class="hljs-number">5.</span> é¢†åŸŸå¯¹è±¡è®¾è®¡è§„èŒƒ

  å®ä½“ç±»ä½ç½®

  | ç±»å‹       | ä½ç½®              | è¯´æ˜       |
  |------------|-------------------|------------|
  | é¢†åŸŸå®ä½“   | lab-api/domain/  | è·¨æ¨¡å—å…±äº« |
  | æ•°æ®åº“å®ä½“ | lab-core/domain/ | æŒä¹…åŒ–ä¸“ç”¨ |

  å®ä½“ç±»è§„èŒƒ

  <span class="hljs-comment">// âœ… æ¨èï¼šä½¿ç”¨Lombokç®€åŒ–</span>
  <span class="hljs-meta">@Getter</span>
  <span class="hljs-meta">@Setter</span>
  <span class="hljs-meta">@AllArgsConstructor</span>
  <span class="hljs-meta">@NoArgsConstructor</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DUser</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> {
      <span class="hljs-keyword">private</span> String uuid;
      <span class="hljs-keyword">private</span> String name;
      <span class="hljs-keyword">private</span> String orgUuid;

      <span class="hljs-comment">// é¢†åŸŸè¡Œä¸º</span>
      <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isActive</span><span class="hljs-params">()</span> {
          <span class="hljs-keyword">return</span> StringUtils.isNotBlank(uuid);
      }
  }

  <span class="hljs-comment">// âŒ é¿å…ï¼šè¿‡å¤šçš„DTOè½¬æ¢å±‚</span>

  ---
  <span class="hljs-number">6.</span> åˆ†å±‚è®¾è®¡åŸåˆ™

  ä¸‰å±‚æ¶æ„èŒè´£

  <span class="hljs-comment">// ========== lab-service (Webå±‚) ==========</span>
  <span class="hljs-meta">@RestController</span>
  <span class="hljs-meta">@RequestMapping("/v1/feishu")</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FeiShuController</span> {

      <span class="hljs-meta">@Autowired</span>
      <span class="hljs-keyword">private</span> UserService userService;  <span class="hljs-comment">// ä»…è°ƒç”¨é¢†åŸŸæœåŠ¡</span>

      <span class="hljs-comment">// âœ… ä»…å¤„ç†HTTPè¯·æ±‚/å“åº”ï¼Œæ— ä¸šåŠ¡é€»è¾‘</span>
      <span class="hljs-meta">@PostMapping("/login")</span>
      <span class="hljs-keyword">public</span> Result&lt;LoginResult&gt; <span class="hljs-title function_">login</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> LoginRequest request)</span> {
          <span class="hljs-type">LoginResult</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> userService.login(request.getCode());
          <span class="hljs-keyword">return</span> Result.success(result);
      }
  }

  <span class="hljs-comment">// ========== lab-core (é¢†åŸŸå±‚) ==========</span>
  <span class="hljs-meta">@Service</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserService</span> {

      <span class="hljs-meta">@Autowired</span>
      <span class="hljs-keyword">private</span> UserRepository userRepository;  <span class="hljs-comment">// æ•°æ®è®¿é—®</span>
      <span class="hljs-meta">@Autowired</span>
      <span class="hljs-keyword">private</span> FeiShuClient feiShuClient;      <span class="hljs-comment">// å¤–éƒ¨æœåŠ¡</span>

      <span class="hljs-comment">// âœ… ä¸šåŠ¡é€»è¾‘æ ¸å¿ƒ</span>
      <span class="hljs-meta">@Override</span>
      <span class="hljs-meta">@Transactional</span>
      <span class="hljs-keyword">public</span> LoginResult <span class="hljs-title function_">login</span><span class="hljs-params">(String code)</span> {
          <span class="hljs-comment">// 1. è°ƒç”¨é£ä¹¦è®¤è¯</span>
          <span class="hljs-type">FeiShuUser</span> <span class="hljs-variable">fsUser</span> <span class="hljs-operator">=</span> feiShuClient.getUserInfo(code);

          <span class="hljs-comment">// 2. æŸ¥è¯¢æˆ–åˆ›å»ºç”¨æˆ·</span>
          <span class="hljs-type">DUser</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userRepository.findByUuid(fsUser.getUuid());
          <span class="hljs-keyword">if</span> (user == <span class="hljs-literal">null</span>) {
              user = createUserFromFeiShu(fsUser);
              userRepository.save(user);
          }

          <span class="hljs-comment">// 3. ç”Ÿæˆä»¤ç‰Œ</span>
          <span class="hljs-keyword">return</span> generateLoginResult(user);
      }
  }

  <span class="hljs-comment">// ========== lab-core (æ•°æ®è®¿é—®å±‚) ==========</span>
  <span class="hljs-meta">@Repository</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserRepositoryImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserRepository</span> {

      <span class="hljs-meta">@Autowired</span>
      <span class="hljs-keyword">private</span> JdbcTemplate jdbcTemplate;

      <span class="hljs-comment">// âœ… ä»…è´Ÿè´£æ•°æ®CRUD</span>
      <span class="hljs-meta">@Override</span>
      <span class="hljs-keyword">public</span> DUser <span class="hljs-title function_">findByUuid</span><span class="hljs-params">(String uuid)</span> {
          <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"SELECT * FROM d_user WHERE uuid = ?"</span>;
          <span class="hljs-keyword">return</span> jdbcTemplate.queryForObject(sql, <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserRowMapper</span>(), uuid);
      }
  }

  ---
  <span class="hljs-number">7.</span> å¼‚å¸¸å¤„ç†è§„èŒƒ

  <span class="hljs-comment">// ========== è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ ==========</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">labException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">RuntimeException</span> {
      <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String code;

      <span class="hljs-keyword">public</span> <span class="hljs-title function_">labException</span><span class="hljs-params">(String code, String message)</span> {
          <span class="hljs-built_in">super</span>(message);
          <span class="hljs-built_in">this</span>.code = code;
      }
  }

  <span class="hljs-comment">// ========== å…¨å±€å¼‚å¸¸å¤„ç† ==========</span>
  <span class="hljs-meta">@RestControllerAdvice</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GlobalExceptionHandler</span> {

      <span class="hljs-meta">@ExceptionHandler(labException.class)</span>
      <span class="hljs-keyword">public</span> Result&lt;Void&gt; <span class="hljs-title function_">handlelabException</span><span class="hljs-params">(labException e)</span> {
          log.warn(<span class="hljs-string">"ä¸šåŠ¡å¼‚å¸¸: {}"</span>, e.getMessage());
          <span class="hljs-keyword">return</span> Result.fail(e.getCode(), e.getMessage());
      }

      <span class="hljs-meta">@ExceptionHandler(Exception.class)</span>
      <span class="hljs-keyword">public</span> Result&lt;Void&gt; <span class="hljs-title function_">handleException</span><span class="hljs-params">(Exception e)</span> {
          log.error(<span class="hljs-string">"ç³»ç»Ÿå¼‚å¸¸"</span>, e);
          <span class="hljs-keyword">return</span> Result.fail(<span class="hljs-string">"SYSTEM_ERROR"</span>, <span class="hljs-string">"ç³»ç»Ÿå¼‚å¸¸ï¼Œè¯·è”ç³»ç®¡ç†å‘˜"</span>);
      }
  }

  <span class="hljs-comment">// ========== ä½¿ç”¨ç¤ºä¾‹ ==========</span>
  <span class="hljs-comment">// âœ… æ˜ç¡®æŠ›å‡ºä¸šåŠ¡å¼‚å¸¸</span>
  <span class="hljs-keyword">if</span> (user == <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">labException</span>(<span class="hljs-string">"USER_NOT_FOUND"</span>, <span class="hljs-string">"ç”¨æˆ·ä¸å­˜åœ¨"</span>);
  }

  ---
  <span class="hljs-number">8.</span> å¤–éƒ¨æœåŠ¡è°ƒç”¨è§„èŒƒ

  <span class="hljs-comment">// ========== Feignå®¢æˆ·ç«¯å®šä¹‰ ==========</span>
  <span class="hljs-meta">@FeignClient(
      name = "feishu-api",
      url = "${feishu.api-url}",
      configuration = FeiShuFeignConfig.class
  )</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">FeiShuClient</span> {

      <span class="hljs-meta">@GetMapping("/open-apis/user/v4/info")</span>
      FeiShuUserResponse <span class="hljs-title function_">getUserInfo</span><span class="hljs-params">(<span class="hljs-meta">@RequestHeader("Authorization")</span> String token)</span>;

      <span class="hljs-meta">@PostMapping("/open-apis/contact/v3/users/batch_get")</span>
      FeiShuUserBatchResponse <span class="hljs-title function_">batchGetUsers</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> FeiShuUserBatchRequest request)</span>;
  }

  <span class="hljs-comment">// ========== é…ç½®ç±» ==========</span>
  <span class="hljs-meta">@Configuration</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FeiShuFeignConfig</span> {

      <span class="hljs-meta">@Bean</span>
      <span class="hljs-keyword">public</span> RequestInterceptor <span class="hljs-title function_">authInterceptor</span><span class="hljs-params">(<span class="hljs-meta">@Value("${feishu.app-id}")</span> String appId,
                                                <span class="hljs-meta">@Value("${feishu.app-secret}")</span> String appSecret)</span> {
          <span class="hljs-keyword">return</span> template -&gt; {
              <span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> getAccessToken(appId, appSecret);
              template.header(<span class="hljs-string">"Authorization"</span>, <span class="hljs-string">"Bearer "</span> + token);
          };
      }

      <span class="hljs-meta">@Bean</span>
      <span class="hljs-keyword">public</span> Logger.Level <span class="hljs-title function_">feignLoggerLevel</span><span class="hljs-params">()</span> {
          <span class="hljs-keyword">return</span> Logger.Level.BASIC;  <span class="hljs-comment">// ç”Ÿäº§ç¯å¢ƒä½¿ç”¨BASICæˆ–NONE</span>
      }
  }

  <span class="hljs-comment">// âœ… è°ƒç”¨æ—¶æ·»åŠ é‡è¯•å’Œé™çº§</span>
  <span class="hljs-meta">@Retryable(value = {FeignException.class}, maxAttempts = 3)</span>
  <span class="hljs-keyword">public</span> FeiShuUser <span class="hljs-title function_">getUserFromFeiShu</span><span class="hljs-params">(String userId)</span> {
      <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">return</span> feiShuClient.getUserInfo(userId);
      } <span class="hljs-keyword">catch</span> (FeignException e) {
          log.error(<span class="hljs-string">"è°ƒç”¨é£ä¹¦APIå¤±è´¥"</span>, e);
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">labException</span>(<span class="hljs-string">"FEISHU_API_ERROR"</span>, <span class="hljs-string">"è·å–é£ä¹¦ç”¨æˆ·ä¿¡æ¯å¤±è´¥"</span>);
      }
  }

  ---
  <span class="hljs-number">9.</span> æ•°æ®åº“æ“ä½œè§„èŒƒ

  <span class="hljs-comment">// âœ… ä½¿ç”¨JdbcTemplate + RowMapper</span>
  <span class="hljs-meta">@Repository</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserRepositoryImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserRepository</span> {

      <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> JdbcTemplate jdbcTemplate;

      <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">SQL_BY_UUID</span> <span class="hljs-operator">=</span>
          <span class="hljs-string">"SELECT uuid, name, org_uuid FROM d_user WHERE uuid = ?"</span>;

      <span class="hljs-meta">@Override</span>
      <span class="hljs-keyword">public</span> DUser <span class="hljs-title function_">findByUuid</span><span class="hljs-params">(String uuid)</span> {
          List&lt;DUser&gt; users = jdbcTemplate.query(
              SQL_BY_UUID,
              <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserRowMapper</span>(),
              uuid
          );
          <span class="hljs-keyword">return</span> users.isEmpty() ? <span class="hljs-literal">null</span> : users.get(<span class="hljs-number">0</span>);
      }

      <span class="hljs-comment">// âœ… RowMapperä½œä¸ºé™æ€å†…éƒ¨ç±»</span>
      <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserRowMapper</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RowMapper</span>&lt;DUser&gt; {
          <span class="hljs-meta">@Override</span>
          <span class="hljs-keyword">public</span> DUser <span class="hljs-title function_">mapRow</span><span class="hljs-params">(ResultSet rs, <span class="hljs-type">int</span> rowNum)</span> <span class="hljs-keyword">throws</span> SQLException {
              <span class="hljs-type">DUser</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DUser</span>();
              user.setUuid(rs.getString(<span class="hljs-string">"uuid"</span>));
              user.setName(rs.getString(<span class="hljs-string">"name"</span>));
              user.setOrgUuid(rs.getString(<span class="hljs-string">"org_uuid"</span>));
              <span class="hljs-keyword">return</span> user;
          }
      }
  }

  <span class="hljs-comment">// âœ… ä½¿ç”¨custom JDBCæ‰©å±•ï¼ˆå¦‚æœå¯ç”¨ï¼‰</span>
  <span class="hljs-meta">@Autowired</span>
  <span class="hljs-keyword">private</span> CustomJdbcTemplate customJdbcTemplate;

  <span class="hljs-keyword">public</span> List&lt;DUser&gt; <span class="hljs-title function_">findByOrg</span><span class="hljs-params">(String orgUuid)</span> {
      <span class="hljs-keyword">return</span> customJdbcTemplate.query(
          <span class="hljs-string">"SELECT * FROM d_user WHERE org_uuid = :orgUuid"</span>,
          Map.of(<span class="hljs-string">"orgUuid"</span>, orgUuid),
          <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserRowMapper</span>()
      );
  }

  ---
  <span class="hljs-number">10.</span> é…ç½®ç®¡ç†è§„èŒƒ

  # ========== application.yml ç»“æ„ ==========
  spring:
    application:
      name: lab-service
    datasource:
      url: ${DB_URL:jdbc:oracle:thin:<span class="hljs-meta">@localhost</span>:<span class="hljs-number">1521</span>:db}
      username: ${DB_USER:user}
      password: ${DB_PASSWORD:pwd}
      type: com.alibaba.druid.pool.DruidDataSource

  feishu:
    api-url: https:<span class="hljs-comment">//open.feishu.cn</span>
    app-id: ${FEISHU_APP_ID}
    app-secret: ${FEISHU_APP_SECRET}
    encrypt-key: ${FEISHU_ENCRYPT_KEY}

  wecom:
    api-url: https:<span class="hljs-comment">//qyapi.weixin.qq.com</span>
    corp-id: ${WECOM_CORP_ID}
    secret: ${WECOM_SECRET}

  # ========== é…ç½®å±æ€§ç±» ==========
  <span class="hljs-meta">@ConfigurationProperties(prefix = "feishu")</span>
  <span class="hljs-meta">@Validated</span>
  <span class="hljs-meta">@Getter</span>
  <span class="hljs-meta">@Setter</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FeiShuProperties</span> {

      <span class="hljs-meta">@NotBlank</span>
      <span class="hljs-keyword">private</span> String apiUrl;

      <span class="hljs-meta">@NotBlank</span>
      <span class="hljs-keyword">private</span> String appId;

      <span class="hljs-meta">@NotBlank</span>
      <span class="hljs-keyword">private</span> String appSecret;

      <span class="hljs-keyword">private</span> String encryptKey;
  }

  ---
  <span class="hljs-number">11.</span> æ—¥å¿—è§„èŒƒ

  <span class="hljs-comment">// ========== ä½¿ç”¨Slf4j ==========</span>
  <span class="hljs-meta">@Slf4j</span>
  <span class="hljs-meta">@Service</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceImpl</span> {

      <span class="hljs-comment">// âœ… è®°å½•å…³é”®ä¸šåŠ¡æµç¨‹</span>
      <span class="hljs-keyword">public</span> LoginResult <span class="hljs-title function_">login</span><span class="hljs-params">(String code)</span> {
          log.info(<span class="hljs-string">"ç”¨æˆ·ç™»å½•å¼€å§‹, code={}"</span>, code);

          <span class="hljs-keyword">try</span> {
              <span class="hljs-type">FeiShuUser</span> <span class="hljs-variable">fsUser</span> <span class="hljs-operator">=</span> feiShuClient.getUserInfo(code);
              log.info(<span class="hljs-string">"è·å–é£ä¹¦ç”¨æˆ·æˆåŠŸ, uuid={}"</span>, fsUser.getUserId());

              <span class="hljs-comment">// ... ä¸šåŠ¡é€»è¾‘</span>

              log.info(<span class="hljs-string">"ç”¨æˆ·ç™»å½•æˆåŠŸ, uuid={}"</span>, user.getUuid());
              <span class="hljs-keyword">return</span> result;

          } <span class="hljs-keyword">catch</span> (Exception e) {
              log.error(<span class="hljs-string">"ç”¨æˆ·ç™»å½•å¤±è´¥, code={}, error={}"</span>, code, e.getMessage(), e);
              <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">labException</span>(<span class="hljs-string">"LOGIN_FAILED"</span>, <span class="hljs-string">"ç™»å½•å¤±è´¥"</span>);
          }
      }
  }

  <span class="hljs-comment">// ========== æ—¥å¿—çº§åˆ«è§„èŒƒ ==========</span>
  <span class="hljs-comment">// ERROR: ç³»ç»Ÿé”™è¯¯ã€éœ€è¦ç«‹å³å…³æ³¨çš„å¼‚å¸¸</span>
  <span class="hljs-comment">// WARN:  ä¸šåŠ¡å¼‚å¸¸ã€é‡è¯•æ“ä½œ</span>
  <span class="hljs-comment">// INFO:  å…³é”®ä¸šåŠ¡æµç¨‹ï¼ˆç™»å½•ã€åŒæ­¥ç­‰ï¼‰</span>
  <span class="hljs-comment">// DE<span class="hljs-doctag">BUG:</span> å¼€å‘è°ƒè¯•ä¿¡æ¯ï¼ˆç”Ÿäº§ç¯å¢ƒå…³é—­ï¼‰</span>

  ---
  <span class="hljs-number">12.</span> äº‹åŠ¡ç®¡ç†è§„èŒƒ

  <span class="hljs-meta">@Service</span>
  <span class="hljs-meta">@Transactional</span>  <span class="hljs-comment">// âœ… ç±»çº§åˆ«é»˜è®¤åªè¯»äº‹åŠ¡</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DepartmentServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">DepartmentService</span> {

      <span class="hljs-comment">// âœ… åªè¯»æ“ä½œ</span>
      <span class="hljs-meta">@Transactional(readOnly = true)</span>
      <span class="hljs-keyword">public</span> Department <span class="hljs-title function_">findByUuid</span><span class="hljs-params">(String uuid)</span> {
          <span class="hljs-keyword">return</span> departmentRepository.findByUuid(uuid);
      }

      <span class="hljs-comment">// âœ… å†™æ“ä½œæ˜ç¡®æŒ‡å®š</span>
      <span class="hljs-meta">@Transactional(readOnly = false, rollbackFor = Exception.class)</span>
      <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">syncDepartment</span><span class="hljs-params">(FeiShuDepartment fsDept)</span> {
          <span class="hljs-type">Department</span> <span class="hljs-variable">dept</span> <span class="hljs-operator">=</span> convertToDepartment(fsDept);
          departmentRepository.save(dept);

          <span class="hljs-comment">// åŒæ­¥å­éƒ¨é—¨</span>
          fsDept.getChildren().forEach(<span class="hljs-built_in">this</span>::syncDepartment);
      }

      <span class="hljs-comment">// âœ… é¿å…é•¿äº‹åŠ¡ï¼Œå¤§æ•°æ®é‡åˆ†æ‰¹å¤„ç†</span>
      <span class="hljs-meta">@Transactional</span>
      <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">syncAllDepartments</span><span class="hljs-params">()</span> {
          <span class="hljs-type">int</span> <span class="hljs-variable">pageSize</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;
          <span class="hljs-type">int</span> <span class="hljs-variable">page</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
          List&lt;FeiShuDepartment&gt; batch;

          <span class="hljs-keyword">do</span> {
              batch = feiShuClient.fetchDepartments(page, pageSize);
              batch.forEach(<span class="hljs-built_in">this</span>::syncDepartment);
              page++;
          } <span class="hljs-keyword">while</span> (!batch.isEmpty());
      }
  }

  ---
  <span class="hljs-number">13.</span> ä»£ç æ³¨é‡Šè§„èŒƒ

  <span class="hljs-comment">/**
   * ç”¨æˆ·æœåŠ¡å®ç°
   *
   * &lt;p&gt;ä¸»è¦èŒè´£ï¼š&lt;/p&gt;
   * &lt;ul&gt;
   *   &lt;li&gt;ç”¨æˆ·ç™»å½•è®¤è¯ï¼ˆé£ä¹¦/ä¼ä¸šå¾®ä¿¡ï¼‰&lt;/li&gt;
   *   &lt;li&gt;ç”¨æˆ·ä¿¡æ¯åŒæ­¥&lt;/li&gt;
   *   &lt;li&gt;å¹³å°è´¦å·ç®¡ç†&lt;/li&gt;
   * &lt;/ul&gt;
   *
   * <span class="hljs-doctag">@author</span> zhangsan
   * <span class="hljs-doctag">@since</span> 1.0
   */</span>
  <span class="hljs-meta">@Slf4j</span>
  <span class="hljs-meta">@Service</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserService</span> {

      <span class="hljs-comment">/**
       * ç”¨æˆ·ç™»å½•
       *
       * <span class="hljs-doctag">@param</span> code ç¬¬ä¸‰æ–¹å¹³å°æˆæƒç 
       * <span class="hljs-doctag">@return</span> ç™»å½•ç»“æœï¼ˆåŒ…å«ä»¤ç‰Œå’Œç”¨æˆ·ä¿¡æ¯ï¼‰
       * <span class="hljs-doctag">@throws</span> labException å½“è®¤è¯å¤±è´¥æˆ–ç”¨æˆ·ä¸å­˜åœ¨æ—¶æŠ›å‡º
       */</span>
      <span class="hljs-meta">@Override</span>
      <span class="hljs-keyword">public</span> LoginResult <span class="hljs-title function_">login</span><span class="hljs-params">(String code)</span> {
          <span class="hljs-comment">// å®ç°ä»£ç ...</span>
      }
  }

  <span class="hljs-comment">// âœ… å•è¡Œæ³¨é‡Šè¯´æ˜å¤æ‚é€»è¾‘</span>
  <span class="hljs-comment">// æ£€æŸ¥ç”¨æˆ·çŠ¶æ€ï¼šå·²ç¦ç”¨çš„ç”¨æˆ·ä¸å…è®¸ç™»å½•</span>
  <span class="hljs-keyword">if</span> (user.getStatus() == UserStatus.DISABLED) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">labException</span>(<span class="hljs-string">"USER_DISABLED"</span>, <span class="hljs-string">"ç”¨æˆ·å·²è¢«ç¦ç”¨"</span>);
  }

  ---
  <span class="hljs-number">11.</span> SOLIDåŸåˆ™å®è·µ

  <span class="hljs-comment">// ========== S: å•ä¸€èŒè´£ ==========</span>
  <span class="hljs-comment">// âœ… æ¯ä¸ªServiceåªè´Ÿè´£ä¸€ä¸ªé¢†åŸŸ</span>
  <span class="hljs-meta">@Service</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> { }      <span class="hljs-comment">// ç”¨æˆ·ç®¡ç†</span>
  <span class="hljs-meta">@Service</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DepartmentService</span> { } <span class="hljs-comment">// éƒ¨é—¨ç®¡ç†</span>
  <span class="hljs-meta">@Service</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StoreService</span> { }      <span class="hljs-comment">// é—¨åº—ç®¡ç†</span>

  <span class="hljs-comment">// âŒ é¿å…å¤§è€Œå…¨çš„æœåŠ¡</span>
  <span class="hljs-comment">// @Service</span>
  <span class="hljs-comment">// public class ManagementService { } // åŒ…å«æ‰€æœ‰ç®¡ç†é€»è¾‘</span>

  <span class="hljs-comment">// ========== O: å¼€é—­åŸåˆ™ ==========</span>
  <span class="hljs-comment">// âœ… ä½¿ç”¨æ¥å£ + ç­–ç•¥æ¨¡å¼æ‰©å±•</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">PlatformClient</span> {
      PlatformUser <span class="hljs-title function_">getUserInfo</span><span class="hljs-params">(String code)</span>;
  }

  <span class="hljs-meta">@Component("feishu")</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FeiShuClient</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">PlatformClient</span> { }

  <span class="hljs-meta">@Component("wecom")</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WeComClient</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">PlatformClient</span> { }

  <span class="hljs-comment">// ========== D: ä¾èµ–å€’ç½® ==========</span>
  <span class="hljs-comment">// âœ… ä¾èµ–æŠ½è±¡è€Œéå…·ä½“å®ç°</span>
  <span class="hljs-meta">@Service</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceImpl</span> {

      <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserRepository userRepository;  <span class="hljs-comment">// æ¥å£</span>

      <span class="hljs-meta">@Autowired</span>
      <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserServiceImpl</span><span class="hljs-params">(UserRepository userRepository)</span> {
          <span class="hljs-built_in">this</span>.userRepository = userRepository;
      }
  }

  ---
  ğŸ¯ å…³é”®å¼€å‘åŸåˆ™

  | åŸåˆ™       | å®è·µè¦ç‚¹                              |
  |------------|---------------------------------------|
  | KISS       | æ¯ä¸ªæ–¹æ³•ä¸è¶…è¿‡<span class="hljs-number">50</span>è¡Œï¼ŒèŒè´£å•ä¸€          |
  | DRY        | é‡å¤ä»£ç æå–åˆ° commons å·¥å…·ç±»         |
  | YAGNI      | ä¸é¢„ç•™<span class="hljs-string">"æœªæ¥å¯èƒ½ç”¨åˆ°"</span>çš„æ¥å£å’Œå­—æ®µ      |
  | é˜²å¾¡å¼ç¼–ç¨‹ | æ‰€æœ‰å¤–éƒ¨è¾“å…¥ï¼ˆå‚æ•°ã€APIå“åº”ï¼‰å¿…é¡»æ ¡éªŒ |

  ---
  ğŸ“ æ£€æŸ¥æ¸…å•

  åœ¨æäº¤ä»£ç å‰ï¼Œç¡®ä¿ï¼š

  - æ‰€æœ‰å…¬å…±æ–¹æ³•éƒ½æœ‰Javadocæ³¨é‡Š
  - å¼‚å¸¸å¤„ç†ä¸åæ²¡é”™è¯¯ï¼Œè®°å½•æ—¥å¿—
  - å¤–éƒ¨æœåŠ¡è°ƒç”¨æœ‰è¶…æ—¶å’Œé‡è¯•æœºåˆ¶
  - æ•°æ®åº“æ“ä½œä½¿ç”¨PreparedStatementé˜²æ­¢SQLæ³¨å…¥
  - æ•æ„Ÿä¿¡æ¯é€šè¿‡é…ç½®ä¸­å¿ƒæ³¨å…¥ï¼Œä¸ç¡¬ç¼–ç 
  - äº‹åŠ¡è¾¹ç•Œæ¸…æ™°ï¼Œé•¿äº‹åŠ¡æ‹†åˆ†
  - æ—¥å¿—çº§åˆ«æ­£ç¡®ï¼Œç”Ÿäº§ç¯å¢ƒä¸è¾“å‡ºDEBUGæ—¥å¿—
  - å•å…ƒæµ‹è¯•è¦†ç›–æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
</code></pre>
<h2 data-id="heading-23">4 å‰ç«¯</h2>
<blockquote>
<p>æŠ€æœ¯æ ˆï¼šVu3+TypeScript+Viteå·¥ç¨‹
æç¤ºè¯ï¼šè¾“å‡ºå·¥ç¨‹ frontend ç”¨åˆ°çš„æŠ€æœ¯æ ˆ/ä»£ç ç»“æ„ï¼Œå¹¶æä¾›ç¼–ç¨‹è§„èŒƒ</p>
</blockquote>
<h3 data-id="heading-24">4.1 è¯„ä»·æ ‡å‡†</h3>









































<table><thead><tr><th>ç»´åº¦</th><th>5åˆ†æ ‡å‡†</th><th>3åˆ†æ ‡å‡†</th><th>1åˆ†æ ‡å‡†</th></tr></thead><tbody><tr><td><strong>æŠ€æœ¯æ ˆè¯†åˆ«</strong></td><td>å‡†ç¡®è¯†åˆ«å…¨éƒ¨æ ¸å¿ƒæŠ€æœ¯æ ˆåŠå¼€å‘å·¥å…·é“¾</td><td>è¯†åˆ«ä¸»è¦æŠ€æœ¯æ ˆï¼Œé—æ¼éƒ¨åˆ†å·¥å…·</td><td>æŠ€æœ¯æ ˆè¯†åˆ«ä¸å…¨æˆ–æœ‰é”™è¯¯</td></tr><tr><td><strong>ä»£ç ç»“æ„ç†è§£</strong></td><td>è¯¦ç»†æè¿°ç›®å½•ç»“æ„ï¼Œä½“ç°æ¶æ„è®¾è®¡æ€æƒ³</td><td>åŸºæœ¬æè¿°ç»“æ„ï¼Œç¼ºä¹æ·±åº¦åˆ†æ</td><td>ç»“æ„æè¿°æ¨¡ç³Šæˆ–é”™è¯¯</td></tr><tr><td><strong>ç¼–ç¨‹è§„èŒƒå®Œæ•´æ€§</strong></td><td>è¦†ç›–å‘½åã€æ ¼å¼ã€ç»„ä»¶ã€APIç­‰å®Œæ•´è§„èŒƒ</td><td>æ¶µç›–åŸºæœ¬è§„èŒƒï¼Œç»†èŠ‚ä¸å®Œæ•´</td><td>è§„èŒƒæè¿°é›¶æ•£ä¸ç³»ç»Ÿ</td></tr><tr><td><strong>è¾“å‡ºå¯è¯»æ€§</strong></td><td>å±‚æ¬¡åˆ†æ˜ï¼Œé€»è¾‘æ¸…æ™°ï¼Œä¾¿äºç†è§£å®æ–½</td><td>ç»“æ„åŸºæœ¬æ¸…æ™°ï¼Œéƒ¨åˆ†å†…å®¹å†—é•¿</td><td>ç»„ç»‡æ··ä¹±ï¼Œéš¾ä»¥é˜…è¯»</td></tr><tr><td><strong>å®ç”¨æ€§</strong></td><td>æä¾›å…·ä½“é…ç½®ç¤ºä¾‹å’Œæœ€ä½³å®è·µ</td><td>æœ‰ä»£ç ç¤ºä¾‹ä½†ç¼ºä¹é…ç½®ç»†èŠ‚</td><td>ç¼ºä¹å¯æ“ä½œå†…å®¹</td></tr></tbody></table>
<h3 data-id="heading-25">4.2 è¯„æµ‹ç»“æœ</h3>
<blockquote>
<p>äºŒè€…å‡è¡¨ç°ä¼˜ç§€ï¼ŒMiniMax-M2.1åœ¨è¾“å‡ºç»“æ„æ¸…æ™°åº¦ä¸Šç•¥ä¼˜ï¼ŒGLM-4.7åœ¨å†…å®¹æ·±åº¦å’ŒåŸåˆ™é˜è¿°ä¸Šæ›´å…¨é¢ã€‚</p>
</blockquote>
<h4 data-id="heading-26">4.2.1 MiniMax-M2.1</h4>
<blockquote>
<p>å¾—åˆ†ï¼š25</p>
</blockquote>



































<table><thead><tr><th>ç»´åº¦</th><th>è¯„åˆ†</th><th>è¯„ä»·ç†ç”±</th></tr></thead><tbody><tr><td>æŠ€æœ¯æ ˆè¯†åˆ«</td><td>5</td><td>å®Œæ•´åˆ—å‡ºæ ¸å¿ƒä¸è¾…åŠ©æŠ€æœ¯æ ˆï¼Œç‰ˆæœ¬æ¸…æ™°</td></tr><tr><td>ä»£ç ç»“æ„ç†è§£</td><td>5</td><td>è¯¦ç»†æè¿°ç›®å½•ç»“æ„ã€æ¨¡å—åˆ’åˆ†ã€ç»„ä»¶ç»„ç»‡</td></tr><tr><td>ç¼–ç¨‹è§„èŒƒå®Œæ•´æ€§</td><td>5</td><td>è¦†ç›–å‘½åã€æ ¼å¼ã€ç»„ä»¶ã€APIã€è·¯ç”±ã€çŠ¶æ€ç®¡ç†ç­‰å®Œæ•´è§„èŒƒ</td></tr><tr><td>è¾“å‡ºå¯è¯»æ€§</td><td>5</td><td>ç»“æ„æ¸…æ™°ï¼Œå±‚æ¬¡åˆ†æ˜ï¼Œä¾¿äºç†è§£ä¸å®æ–½</td></tr><tr><td>å®ç”¨æ€§</td><td>5</td><td>æä¾›å…·ä½“é…ç½®ã€ä»£ç ç¤ºä¾‹ã€æ¨¡å—æ¨¡æ¿ã€å¸¸ç”¨å‘½ä»¤</td></tr></tbody></table>
<h4 data-id="heading-27">4.2.2 GLM-4.7</h4>
<blockquote>
<p>å¾—åˆ†ï¼š24</p>
</blockquote>



































<table><thead><tr><th>ç»´åº¦</th><th>è¯„åˆ†</th><th>è¯„ä»·ç†ç”±</th></tr></thead><tbody><tr><td>æŠ€æœ¯æ ˆè¯†åˆ«</td><td>5</td><td>æŠ€æœ¯æ ˆè¯†åˆ«å®Œæ•´ï¼Œåˆ†ç±»æ¸…æ™°ï¼Œç‰ˆæœ¬é½å…¨</td></tr><tr><td>ä»£ç ç»“æ„ç†è§£</td><td>5</td><td>è¯¦ç»†æè¿°æ¨¡å—åŒ–ç»“æ„ã€åˆ†å±‚æ¶æ„ã€è·¯å¾„åˆ«åç­‰</td></tr><tr><td>ç¼–ç¨‹è§„èŒƒå®Œæ•´æ€§</td><td>5</td><td>è¦†ç›–å‘½åã€æ ·å¼ã€TypeScriptã€Vueç»„ä»¶ã€APIã€çŠ¶æ€ç®¡ç†ç­‰å®Œæ•´è§„èŒƒ</td></tr><tr><td>è¾“å‡ºå¯è¯»æ€§</td><td>4</td><td>ç»“æ„æ¸…æ™°ï¼Œä½†éƒ¨åˆ†å†…å®¹ç•¥æ˜¾å†—é•¿</td></tr><tr><td>å®ç”¨æ€§</td><td>5</td><td>æä¾›å®Œæ•´é…ç½®ç¤ºä¾‹ã€æœ€ä½³å®è·µã€å¼€å‘åŸåˆ™å’Œå‘½ä»¤é€ŸæŸ¥</td></tr></tbody></table>
<h3 data-id="heading-28">4.3 æ¨¡å‹è¾“å‡ºç»“æœ</h3>
<h4 data-id="heading-29">4.3.1 MiniMax-M2.1</h4>
<pre><code class="hljs language-python" lang="python"> Frontend æŠ€æœ¯æ ˆã€ä»£ç ç»“æ„ä¸ç¼–ç¨‹è§„èŒƒ

  ä¸€ã€æŠ€æœ¯æ ˆ

  | åˆ†ç±»        | æŠ€æœ¯              | ç‰ˆæœ¬    |
  |-------------|-------------------|---------|
  | æ„å»ºå·¥å…·    | Vite              | ^<span class="hljs-number">7.1</span><span class="hljs-number">.2</span>  |
  | æ¡†æ¶        | Vue <span class="hljs-number">3</span>             | ^<span class="hljs-number">3.5</span><span class="hljs-number">.18</span> |
  | è¯­è¨€        | TypeScript        | ~<span class="hljs-number">5.8</span><span class="hljs-number">.3</span>  |
  | çŠ¶æ€ç®¡ç†    | Pinia             | ^<span class="hljs-number">3.0</span><span class="hljs-number">.3</span>  |
  | è·¯ç”±        | Vue Router        | ^<span class="hljs-number">4.5</span><span class="hljs-number">.1</span>  |
  | UI ç»„ä»¶åº“   | Element Plus      | ^<span class="hljs-number">2.11</span><span class="hljs-number">.1</span> |
  | å›¾è¡¨        | ECharts           | ^<span class="hljs-number">6.0</span><span class="hljs-number">.0</span>  |
  | HTTP å®¢æˆ·ç«¯ | Axios             | ^<span class="hljs-number">1.11</span><span class="hljs-number">.0</span> |
  | æ ·å¼        | Tailwind CSS      | ^<span class="hljs-number">4.1</span><span class="hljs-number">.13</span> |
  | è¡¨å•éªŒè¯    | Zod               | ^<span class="hljs-number">4.1</span><span class="hljs-number">.1</span>  |
  | ä»£ç æ£€æŸ¥    | ESLint + Prettier | -       |

  ---
  äºŒã€ä»£ç ç»“æ„

  frontend/
  â”œâ”€â”€ src/
  â”‚   â”œâ”€â”€ main.ts                    <span class="hljs-comment"># åº”ç”¨å…¥å£</span>
  â”‚   â”œâ”€â”€ App.vue                    <span class="hljs-comment"># æ ¹ç»„ä»¶</span>
  â”‚   â”œâ”€â”€ router/                    <span class="hljs-comment"># è·¯ç”±é…ç½®</span>
  â”‚   â”‚   â””â”€â”€ index.ts
  â”‚   â”œâ”€â”€ components/                <span class="hljs-comment"># å…¬å…±ç»„ä»¶</span>
  â”‚   â”‚   â”œâ”€â”€ DataTable.vue          <span class="hljs-comment"># é€šç”¨æ•°æ®è¡¨æ ¼ï¼ˆæ”¯æŒåˆ†é¡µã€ç§»åŠ¨ç«¯å¡ç‰‡è§†å›¾ï¼‰</span>
  â”‚   â”‚   â”œâ”€â”€ ActionButton.vue       <span class="hljs-comment"># æ“ä½œæŒ‰é’®</span>
  â”‚   â”‚   â”œâ”€â”€ ActionButtonGroup.vue  <span class="hljs-comment"># æŒ‰é’®ç»„</span>
  â”‚   â”‚   â”œâ”€â”€ SearchForm.vue         <span class="hljs-comment"># æœç´¢è¡¨å•</span>
  â”‚   â”‚   â”œâ”€â”€ DynamicFormDialog.vue  <span class="hljs-comment"># åŠ¨æ€è¡¨å•å¼¹çª—</span>
  â”‚   â”‚   â”œâ”€â”€ BatchOperationDialog.vue <span class="hljs-comment"># æ‰¹é‡æ“ä½œå¼¹çª—</span>
  â”‚   â”‚   â”œâ”€â”€ Sidebar.vue            <span class="hljs-comment"># ä¾§è¾¹æ </span>
  â”‚   â”‚   â”œâ”€â”€ AppHeader.vue          <span class="hljs-comment"># é¡¶éƒ¨æ </span>
  â”‚   â”‚   â”œâ”€â”€ AppLayout.vue          <span class="hljs-comment"># å¸ƒå±€å®¹å™¨</span>
  â”‚   â”‚   â”œâ”€â”€ MobileBottomNav.vue    <span class="hljs-comment"># ç§»åŠ¨ç«¯åº•éƒ¨å¯¼èˆª</span>
  â”‚   â”‚   â”œâ”€â”€ StatCard.vue           <span class="hljs-comment"># ç»Ÿè®¡å¡ç‰‡</span>
  â”‚   â”‚   â”œâ”€â”€ PageHeader.vue         <span class="hljs-comment"># é¡µé¢å¤´éƒ¨</span>
  â”‚   â”‚   â””â”€â”€ index.ts               <span class="hljs-comment"># ç»„ä»¶å¯¼å‡º</span>
  â”‚   â”œâ”€â”€ composables/               <span class="hljs-comment"># ç»„åˆå¼å‡½æ•°</span>
  â”‚   â”‚   â””â”€â”€ useResponsive.ts       <span class="hljs-comment"># å“åº”å¼åˆ¤æ–­ï¼ˆç§»åŠ¨ç«¯/æ¡Œé¢ç«¯ï¼‰</span>
  â”‚   â”œâ”€â”€ utils/                     <span class="hljs-comment"># å·¥å…·å‡½æ•°</span>
  â”‚   â”‚   â”œâ”€â”€ api.util.ts            <span class="hljs-comment"># API å°è£…</span>
  â”‚   â”‚   â”œâ”€â”€ date.util.ts           <span class="hljs-comment"># æ—¥æœŸå¤„ç†</span>
  â”‚   â”‚   â”œâ”€â”€ course.util.ts         <span class="hljs-comment"># è¯¾ç¨‹ç›¸å…³</span>
  â”‚   â”‚   â””â”€â”€ mobile.ts              <span class="hljs-comment"># ç§»åŠ¨ç«¯å·¥å…·</span>
  â”‚   â”œâ”€â”€ model/                     <span class="hljs-comment"># å…¬å…±æ¨¡å‹</span>
  â”‚   â”‚   â”œâ”€â”€ api-response.model.ts  <span class="hljs-comment"># API å“åº”ç»“æ„</span>
  â”‚   â”‚   â”œâ”€â”€ api-query-<span class="hljs-built_in">filter</span>.model.ts <span class="hljs-comment"># æŸ¥è¯¢å‚æ•°</span>
  â”‚   â”‚   â”œâ”€â”€ api-query-result.model.ts <span class="hljs-comment"># åˆ†é¡µç»“æœ</span>
  â”‚   â”‚   â””â”€â”€ api-<span class="hljs-built_in">id</span>-name.model.ts   <span class="hljs-comment"># ID-åç§°æ˜ å°„</span>
  â”‚   â”œâ”€â”€ modules/                   <span class="hljs-comment"># ä¸šåŠ¡æ¨¡å—ï¼ˆæŒ‰è§’è‰²/åŠŸèƒ½åˆ’åˆ†ï¼‰</span>
  â”‚   â”‚   â”œâ”€â”€ admin/                 <span class="hljs-comment"># ç®¡ç†å‘˜æ¨¡å—</span>
  â”‚   â”‚   â”‚   â”œâ”€â”€ api/               <span class="hljs-comment"># API æ¥å£</span>
  â”‚   â”‚   â”‚   â”œâ”€â”€ model/             <span class="hljs-comment"># æ•°æ®æ¨¡å‹</span>
  â”‚   â”‚   â”‚   â”œâ”€â”€ views/             <span class="hljs-comment"># é¡µé¢ç»„ä»¶</span>
  â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AdminLayout.vue
  â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.vue
  â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SystemSettings.vue
  â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ...
  â”‚   â”‚   â”‚   â””â”€â”€ [ä¸šåŠ¡æ¨¡å—]/
  â”‚   â”‚   â”‚       â”œâ”€â”€ api/
  â”‚   â”‚   â”‚       â”œâ”€â”€ model/
  â”‚   â”‚   â”‚       â””â”€â”€ views/
  â”‚   â”‚   â”œâ”€â”€ teacher/               <span class="hljs-comment"># æ•™å¸ˆæ¨¡å—</span>
  â”‚   â”‚   â”‚   â””â”€â”€ ...
  â”‚   â”‚   â”œâ”€â”€ student/               <span class="hljs-comment"># å­¦ç”Ÿæ¨¡å—</span>
  â”‚   â”‚   â”‚   â””â”€â”€ ...
  â”‚   â”‚   â””â”€â”€ system/                <span class="hljs-comment"># ç³»ç»Ÿæ¨¡å—</span>
  â”‚   â”‚       â”œâ”€â”€ api/
  â”‚   â”‚       â”œâ”€â”€ model/
  â”‚   â”‚       â”œâ”€â”€ store/             <span class="hljs-comment"># Pinia Store</span>
  â”‚   â”‚       â”‚   â””â”€â”€ auth.ts        <span class="hljs-comment"># è®¤è¯çŠ¶æ€</span>
  â”‚   â”‚       â””â”€â”€ views/
  â”‚   â”‚           â”œâ”€â”€ Login.vue
  â”‚   â”‚           â”œâ”€â”€ Profile.vue
  â”‚   â”‚           â”œâ”€â”€ <span class="hljs-number">403.</span>vue
  â”‚   â”‚           â””â”€â”€ <span class="hljs-number">404.</span>vue
  â”‚   â””â”€â”€ styles/                    <span class="hljs-comment"># å…¨å±€æ ·å¼</span>
  â”‚       â””â”€â”€ index.css              <span class="hljs-comment"># Tailwind CSS å…¥å£</span>
  â”œâ”€â”€ index.html
  â”œâ”€â”€ vite.config.ts                 <span class="hljs-comment"># Vite é…ç½®</span>
  â”œâ”€â”€ tsconfig.json                  <span class="hljs-comment"># TypeScript é…ç½®</span>
  â”œâ”€â”€ .prettierrc                    <span class="hljs-comment"># Prettier é…ç½®</span>
  â”œâ”€â”€ eslint.config.ts               <span class="hljs-comment"># ESLint é…ç½®</span>
  â””â”€â”€ package.json

  æ¨¡å—ç»“æ„è§„èŒƒ

  modules/[è§’è‰²]/              <span class="hljs-comment"># å¦‚ adminã€teacherã€student</span>
  â”œâ”€â”€ api/                     <span class="hljs-comment"># API æ¥å£ï¼ˆAPI ç±»å°è£…ï¼‰</span>
  â”‚   â””â”€â”€ [ä¸šåŠ¡].api.ts
  â”œâ”€â”€ model/                   <span class="hljs-comment"># æ•°æ®æ¨¡å‹</span>
  â”‚   â”œâ”€â”€ [ä¸šåŠ¡].model.ts      <span class="hljs-comment"># å®ä½“æ¨¡å‹</span>
  â”‚   â”œâ”€â”€ [ä¸šåŠ¡]-create.model.ts  <span class="hljs-comment"># åˆ›å»ºå‚æ•°</span>
  â”‚   â”œâ”€â”€ [ä¸šåŠ¡]-update.model.ts  <span class="hljs-comment"># æ›´æ–°å‚æ•°</span>
  â”‚   â””â”€â”€ [ä¸šåŠ¡].queryfilter.model.ts <span class="hljs-comment"># æŸ¥è¯¢ç­›é€‰å‚æ•°</span>
  â””â”€â”€ views/                   <span class="hljs-comment"># é¡µé¢ç»„ä»¶</span>
      â”œâ”€â”€ [è§’è‰²]Layout.vue     <span class="hljs-comment"># å¸ƒå±€ç»„ä»¶</span>
      â”œâ”€â”€ [è§’è‰²]Dashboard.vue  <span class="hljs-comment"># é¦–é¡µ</span>
      â””â”€â”€ [ä¸šåŠ¡]/
          â””â”€â”€ [ä¸šåŠ¡]Management.vue

  ---
  ä¸‰ã€ç¼–ç¨‹è§„èŒƒ

  <span class="hljs-number">3.1</span> ä»£ç é£æ ¼

  | é…ç½®é¡¹ | å€¼                     |
  |--------|------------------------|
  | å¼•å·   | å•å¼•å· <span class="hljs-string">'               |
  | ç¼©è¿›   | 2 ç©ºæ ¼                 |
  | è¡Œå®½   | 80 å­—ç¬¦                |
  | åˆ†å·   | ä½¿ç”¨ ;                 |
  | å°¾é€—å· | all (åŒ…æ‹¬å¯¹è±¡ã€æ•°ç»„ç­‰) |

  3.2 ESLint è§„åˆ™

  // eslint.config.ts å…³é”®è§„åˆ™
  {
    rules: {
      '</span>@typescript-eslint/no-explicit-<span class="hljs-built_in">any</span><span class="hljs-string">': '</span>of<span class="hljs-string">f',  // å…è®¸ anyï¼ˆç”¨äºæ³›å‹åœºæ™¯ï¼‰
      '</span>@typescript-eslint/no-floating-promises<span class="hljs-string">': '</span>warn<span class="hljs-string">',
      '</span>@typescript-eslint/no-unsafe-argument<span class="hljs-string">': '</span>warn<span class="hljs-string">',
      '</span>@typescript-eslint/no-unsafe-member-access<span class="hljs-string">': '</span>warn<span class="hljs-string">',
      '</span>@typescript-eslint/no-unsafe-assignment<span class="hljs-string">': '</span>warn<span class="hljs-string">',
      '</span>prettier/prettie<span class="hljs-string">r': ['</span>erro<span class="hljs-string">r', {
        endOfLine: '</span>auto<span class="hljs-string">',
        trailingComma: '</span><span class="hljs-built_in">all</span><span class="hljs-string">'
      }],
    },
  }

  3.3 TypeScript é…ç½®

  {
    "compilerOptions": {
      "strict": true,              // ä¸¥æ ¼æ¨¡å¼
      "noUnusedLocals": false,     // å…è®¸æœªä½¿ç”¨çš„å±€éƒ¨å˜é‡
      "noUnusedParameters": false, // å…è®¸æœªä½¿ç”¨çš„å‚æ•°
      "noFallthroughCasesInSwitch": true,
      "forceConsistentCasingInFileNames": true
    }
  }

  3.4 Vue ç»„ä»¶è§„èŒƒ

  ç»„ä»¶å‘½åï¼š
  - ä½¿ç”¨ PascalCase å‘½åï¼ˆå¦‚ DataTable.vueã€UserManagement.vueï¼‰

  Script Setup è¯­æ³•ï¼š
  &lt;script setup lang="ts"&gt;
  // å¯¼å…¥é¡ºåºï¼šVue API â†’ å…¬å…±ç»„ä»¶ â†’ å…¬å…±å·¥å…· â†’ ä¸šåŠ¡æ¨¡å—
  import { ref, computed, watch } from '</span>vue<span class="hljs-string">';
  import DataTable from '</span>@/components/DataTable.vue<span class="hljs-string">';
  import { ApiUtil } from '</span>@/utils/api.util<span class="hljs-string">';
  import type { UserModel } from '</span>../model/user.model<span class="hljs-string">';

  // Props å®šä¹‰
  interface Props {
    title?: string;
    data?: UserModel[];
  }

  const props = withDefaults(defineProps&lt;Props&gt;(), {
    title: '</span><span class="hljs-string">',
    data: () =&gt; [],
  });

  // Emits å®šä¹‰
  const emit = defineEmits&lt;{
    '</span>update<span class="hljs-string">': [data: UserModel];
    '</span>delete<span class="hljs-string">': [id: number];
  }&gt;();

  // ç»„ä»¶æš´éœ²æ–¹æ³•
  defineExpose({
    refresh,
    resetAndRefresh,
  });
  &lt;/script&gt;

  3.5 API å±‚è§„èŒƒ

  // src/modules/admin/api/admin.api.ts

  import { ApiUtil } from '</span>@/utils/api.util<span class="hljs-string">';
  import type { ApiResponse } from '</span>@/model/api-response.model<span class="hljs-string">';
  import type { AdminDashboardStatsModel } from '</span>../model/admin-dashboard-stats.model<span class="hljs-string">';

  /**
   * ç®¡ç†å‘˜ç«¯APIæ¥å£
   */
  export class AdminApi {
    /**
     * è·å–ç®¡ç†å‘˜ç«¯é¦–é¡µç»Ÿè®¡æ•°æ®
     * @returns ç»Ÿè®¡æ•°æ®
     */
    static async getDashboardStats(): Promise&lt;
      ApiResponse&lt;AdminDashboardStatsModel&gt;
    &gt; {
      return ApiUtil.post&lt;AdminDashboardStatsModel&gt;('</span>/admin/dashboard/stats<span class="hljs-string">');
    }
  }

  è§„èŒƒè¦ç‚¹ï¼š
  - ä½¿ç”¨é™æ€ç±»æ–¹æ³•ï¼ˆStatic Class Patternï¼‰
  - æ¯ä¸ªä¸šåŠ¡æ¨¡å—ä¸€ä¸ª API ç±»
  - æ–¹æ³•æ·»åŠ  JSDoc æ³¨é‡Š
  - è¿”å› ApiResponse&lt;T&gt; ç±»å‹

  3.6 æ¨¡å‹å®šä¹‰è§„èŒƒ

  // src/modules/admin/model/user.model.ts

  /**
   * ç”¨æˆ·å®ä½“æ¨¡å‹
   */
  export interface UserModel {
    /** ç”¨æˆ·ID */
    id: number;
    /** ç”¨æˆ·å */
    username: string;
    /** çœŸå®å§“å */
    realName: string;
    /** é‚®ç®± */
    email: string;
    /** ç”¨æˆ·ç±»å‹: admin=ç®¡ç†å‘˜, teacher=æ•™å¸ˆ, student=å­¦ç”Ÿ */
    userType: '</span>admin<span class="hljs-string">' | '</span>teache<span class="hljs-string">r' | '</span>student<span class="hljs-string">';
    /** åˆ›å»ºæ—¶é—´ */
    createdAt: string;
    /** æ›´æ–°æ—¶é—´ */
    updatedAt: string;
  }

  /**
   * ç”¨æˆ·æŸ¥è¯¢ç­›é€‰å‚æ•°
   */
  export interface UserQueryFilterModel {
    /** æœç´¢å…³é”®è¯ï¼ˆåŒ¹é…ç”¨æˆ·åã€å§“åï¼‰ */
    keyword?: string;
    /** ç”¨æˆ·ç±»å‹ç­›é€‰ */
    userType?: '</span>admin<span class="hljs-string">' | '</span>teache<span class="hljs-string">r' | '</span>student<span class="hljs-string">';
    /** é¡µç ï¼ˆä»1å¼€å§‹ï¼‰ */
    page?: number;
    /** æ¯é¡µæ•°é‡ */
    pageSize?: number;
  }

  3.7 è·¯ç”±è§„èŒƒ

  // src/router/index.ts

  const routes: RouteRecordRaw[] = [
    {
      path: '</span>/admin<span class="hljs-string">',
      name: '</span>AdminLayout<span class="hljs-string">',
      component: () =&gt; import('</span>../modules/admin/views/AdminLayout.vue<span class="hljs-string">'),
      meta: {
        requiresAuth: true,
        roles: ['</span>admin<span class="hljs-string">'],
        title: '</span>ç®¡ç†å‘˜å·¥ä½œå°<span class="hljs-string">',
      },
      children: [
        {
          path: '</span>dashboard<span class="hljs-string">',
          name: '</span>AdminDashboard<span class="hljs-string">',
          component: () =&gt; import('</span>../modules/admin/views/Dashboard.vue<span class="hljs-string">'),
          meta: {
            title: '</span>å·¥ä½œå°<span class="hljs-string">',
          },
        },
        // ...
      ],
    },
  ];

  è§„èŒƒè¦ç‚¹ï¼š
  - ä½¿ç”¨è·¯ç”±æ‡’åŠ è½½
  - meta.requiresAuth: æ˜¯å¦éœ€è¦è®¤è¯
  - meta.roles: è§’è‰²æƒé™æ§åˆ¶
  - meta.title: é¡µé¢æ ‡é¢˜

  3.8 å¯¼å…¥è·¯å¾„åˆ«å

  // vite.config.ts é…ç½®
  resolve: {
    alias: {
      '</span>@<span class="hljs-string">': resolve(__dirname, '</span>src<span class="hljs-string">'),
    },
  }

  // ä½¿ç”¨ç¤ºä¾‹
  import { ApiUtil } from '</span>@/utils/api.util<span class="hljs-string">';
  import UserModel from '</span>@/modules/admin/model/user.model<span class="hljs-string">';

  ---
  å››ã€å¸¸ç”¨å‘½ä»¤

  | å‘½ä»¤            | è¯´æ˜                         |
  |-----------------|------------------------------|
  | npm run dev     | å¯åŠ¨å¼€å‘æœåŠ¡å™¨               |
  | npm run build   | æ„å»ºç”Ÿäº§ç‰ˆæœ¬ï¼ˆåŒ…å«ç±»å‹æ£€æŸ¥ï¼‰ |
  | npm run preview | é¢„è§ˆç”Ÿäº§æ„å»º                 |

  ---
  äº”ã€æ ¸å¿ƒç‰¹æ€§

  1. å“åº”å¼é€‚é…ï¼šuseResponsive composable è‡ªåŠ¨æ£€æµ‹ç§»åŠ¨ç«¯/æ¡Œé¢ç«¯ï¼Œç»„ä»¶è‡ªåŠ¨é€‚é…
  2. API ç»Ÿä¸€å°è£…ï¼šApiUtil å°è£… axiosï¼Œç»Ÿä¸€å¤„ç†è¯·æ±‚/å“åº”
  3. æ•°æ®è¡¨æ ¼ï¼šé€šç”¨ DataTable ç»„ä»¶æ”¯æŒåˆ†é¡µã€æ‰¹é‡æ“ä½œã€ç§»åŠ¨ç«¯å¡ç‰‡è§†å›¾
  4. çŠ¶æ€æŒä¹…åŒ–ï¼šPinia + pinia-plugin-persistedstate æŒä¹…åŒ–å­˜å‚¨è®¤è¯çŠ¶æ€
  5. Element Plus è‡ªåŠ¨å¯¼å…¥ï¼šé€šè¿‡ unplugin-vue-components è‡ªåŠ¨æŒ‰éœ€åŠ è½½ç»„ä»¶

</span></code></pre>
<h4 data-id="heading-30">4.3.2 GLM-4.7</h4>
<pre><code class="hljs language-ini" lang="ini">ğŸ“‹ Frontend å·¥ç¨‹æŠ€æœ¯æ ˆä¸ç¼–ç¨‹è§„èŒƒ

  ä¸€ã€æŠ€æœ¯æ ˆæ¦‚è§ˆ

  1.1 æ ¸å¿ƒæ¡†æ¶

  | æŠ€æœ¯       | ç‰ˆæœ¬   | ç”¨é€”                                         |
  |------------|--------|----------------------------------------------|
  | Vue 3      | 3.5.18 | æ¸è¿›å¼ JavaScript æ¡†æ¶ï¼Œä½¿ç”¨ Composition API |
  | TypeScript | 5.8.3  | ç±»å‹å®‰å…¨ï¼Œå¼€å¯ä¸¥æ ¼æ¨¡å¼                       |
  | Vite       | 7.1.2  | æ–°ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·                           |

  1.2 è·¯ç”±ä¸çŠ¶æ€ç®¡ç†

  | æŠ€æœ¯                        | ç‰ˆæœ¬  | ç”¨é€”                        |
  |-----------------------------|-------|-----------------------------|
  | Vue Router                  | 4.5.1 | å®˜æ–¹è·¯ç”±ç®¡ç†å™¨ï¼ˆHash æ¨¡å¼ï¼‰ |
  | Pinia                       | 3.0.3 | å®˜æ–¹çŠ¶æ€ç®¡ç†åº“              |
  | pinia-plugin-persistedstate | 4.5.0 | çŠ¶æ€æŒä¹…åŒ–                  |

  1.3 UI æ¡†æ¶

  | æŠ€æœ¯                    | ç‰ˆæœ¬   | ç”¨é€”                     |
  |-------------------------|--------|--------------------------|
  | Element Plus            | 2.11.1 | Vue 3 ç»„ä»¶åº“ï¼ˆè‡ªåŠ¨å¯¼å…¥ï¼‰ |
  | @element-plus/icons-vue | 2.3.2  | å›¾æ ‡åº“                   |
  | Tailwind CSS            | 4.1.13 | åŸå­åŒ– CSS æ¡†æ¶          |
  | ECharts                 | 6.0.0  | æ•°æ®å¯è§†åŒ–å›¾è¡¨åº“         |

  1.4 HTTP å®¢æˆ·ç«¯

  | æŠ€æœ¯  | ç‰ˆæœ¬   | ç”¨é€”                                   |
  |-------|--------|----------------------------------------|
  | Axios | 1.11.0 | HTTP è¯·æ±‚åº“ï¼Œå°è£…äº†æ‹¦æˆªå™¨å’Œ Token åˆ·æ–° |

  1.5 å·¥å…·åº“

  | æŠ€æœ¯      | ç‰ˆæœ¬    | ç”¨é€”                      |
  |-----------|---------|---------------------------|
  | lodash-es | 4.17.21 | JavaScript å·¥å…·åº“         |
  | zod       | 4.1.1   | TypeScript ä¼˜å…ˆçš„æ¨¡å¼éªŒè¯ |
  | js-base64 | 3.7.8   | Base64 ç¼–è§£ç              |

  1.6 ä»£ç è´¨é‡å·¥å…·

  | å·¥å…·              | ç‰ˆæœ¬   | é…ç½®                           |
  |-------------------|--------|--------------------------------|
  | ESLint            | 9.34.0 | æ‰å¹³é…ç½®ï¼Œæ”¯æŒ Vue/TS/JSON/CSS |
  | Prettier          | 3.6.2  | ä»£ç æ ¼å¼åŒ–                     |
  | typescript-eslint | 8.40.0 | TypeScript ESLint æ”¯æŒ         |

  1.7 å¼€å‘å¢å¼º

  | æ’ä»¶                    | ç‰ˆæœ¬   | ä½œç”¨                          |
  |-------------------------|--------|-------------------------------|
  | unplugin-auto-import    | 20.0.0 | è‡ªåŠ¨å¯¼å…¥ Vue/Router/Pinia API |
  | unplugin-vue-components | 29.0.0 | è‡ªåŠ¨å¯¼å…¥ç»„ä»¶                  |

  ---
  äºŒã€ä»£ç ç»“æ„

  2.1 ç›®å½•æ ‘

  frontend/
  â”œâ”€â”€ src/
  â”‚   â”œâ”€â”€ components/          <span class="hljs-comment"># å…¬å…±ç»„ä»¶</span>
  â”‚   â”œâ”€â”€ composables/         <span class="hljs-comment"># ç»„åˆå¼å‡½æ•°</span>
  â”‚   â”œâ”€â”€ model/               <span class="hljs-comment"># å…¨å±€æ•°æ®æ¨¡å‹</span>
  â”‚   â”œâ”€â”€ modules/             <span class="hljs-comment"># ä¸šåŠ¡æ¨¡å—ï¼ˆæŒ‰è§’è‰²åˆ’åˆ†ï¼‰</span>
  â”‚   â”‚   â”œâ”€â”€ admin/          <span class="hljs-comment"># ç®¡ç†å‘˜æ¨¡å—</span>
  â”‚   â”‚   â”œâ”€â”€ student/        <span class="hljs-comment"># å­¦ç”Ÿæ¨¡å—</span>
  â”‚   â”‚   â”œâ”€â”€ teacher/        <span class="hljs-comment"># æ•™å¸ˆæ¨¡å—</span>
  â”‚   â”‚   â””â”€â”€ system/         <span class="hljs-comment"># ç³»ç»Ÿæ¨¡å—ï¼ˆè®¤è¯ã€ä¸ªäººèµ„æ–™ç­‰ï¼‰</span>
  â”‚   â”œâ”€â”€ router/             <span class="hljs-comment"># è·¯ç”±é…ç½®</span>
  â”‚   â”œâ”€â”€ styles/             <span class="hljs-comment"># å…¨å±€æ ·å¼</span>
  â”‚   â”œâ”€â”€ utils/              <span class="hljs-comment"># å·¥å…·å‡½æ•°</span>
  â”‚   â”œâ”€â”€ assets/             <span class="hljs-comment"># é™æ€èµ„æº</span>
  â”‚   â”œâ”€â”€ App.vue             <span class="hljs-comment"># æ ¹ç»„ä»¶</span>
  â”‚   â””â”€â”€ main.ts             <span class="hljs-comment"># å…¥å£æ–‡ä»¶</span>
  â”œâ”€â”€ public/                 <span class="hljs-comment"># å…¬å…±é™æ€æ–‡ä»¶</span>
  â””â”€â”€ é…ç½®æ–‡ä»¶

  2.2 æ¨¡å—åŒ–ç»“æ„è§„èŒƒ

  æ¯ä¸ªä¸šåŠ¡æ¨¡å—éµå¾ªä»¥ä¸‹ç»“æ„ï¼š

  modules/{module-name}/
  â”œâ”€â”€ api/              <span class="hljs-comment"># API è¯·æ±‚å±‚</span>
  â”œâ”€â”€ model/            <span class="hljs-comment"># æ•°æ®æ¨¡å‹/ç±»å‹å®šä¹‰</span>
  â”œâ”€â”€ views/            <span class="hljs-comment"># é¡µé¢ç»„ä»¶</span>
  â”œâ”€â”€ components/       <span class="hljs-comment"># æ¨¡å—ä¸“å±ç»„ä»¶ï¼ˆå¯é€‰ï¼‰</span>
  â””â”€â”€ store/            <span class="hljs-comment"># Pinia çŠ¶æ€ç®¡ç†ï¼ˆå¯é€‰ï¼‰</span>

  ç¤ºä¾‹ï¼š
  modules/admin/course/
  â”œâ”€â”€ api/
  â”‚   â””â”€â”€ course.api.ts
  â”œâ”€â”€ model/
  â”‚   â”œâ”€â”€ course.model.ts
  â”‚   â”œâ”€â”€ course-create.model.ts
  â”‚   â”œâ”€â”€ course-update.model.ts
  â”‚   â””â”€â”€ course.queryfilter.model.ts
  â””â”€â”€ views/
      â””â”€â”€ CourseListView.vue

  2.3 åˆ†å±‚æ¶æ„

  Views (é¡µé¢å±‚)
      â†“
  Components (ç»„ä»¶å±‚)
      â†“
  API (æ¥å£å±‚)
      â†“
  Axios (HTTP å±‚)
      â†“
  Backend

  ---
  ä¸‰ã€é…ç½®è§„èŒƒ

  3.1 TypeScript é…ç½®

  {
    "compilerOptions": {
      "strict": true,
      "noUnusedLocals": false,
      "noUnusedParameters": false,
      "noFallthroughCasesInSwitch": true,
      "forceConsistentCasingInFileNames": true,
      "baseUrl": ".",
      "paths": {
        "@/*": <span class="hljs-section">["src/*"]</span>
      }
    }
  }

  3.2 Prettier é…ç½®

  {
    "singleQuote": true,       // ä½¿ç”¨å•å¼•å·
    "tabWidth": 2,             // ç¼©è¿› 2 ç©ºæ ¼
    "printWidth": 80,          // æ¯è¡Œæœ€å¤§ 80 å­—ç¬¦
    "semi": true,              // è¯­å¥æœ«å°¾åŠ åˆ†å·
    "trailingComma": "all"     // å°¾éšé€—å·
  }

  3.3 ESLint è§„åˆ™

  {
    rules: {
      '@typescript-eslint/no-explicit-any': 'off',
      '@typescript-eslint/no-floating-promises': 'warn',
      '@typescript-eslint/no-unsafe-argument': 'warn',
      '@typescript-eslint/no-unsafe-member-access': 'warn',
      '@typescript-eslint/no-unsafe-assignment': 'warn',
    }
  }

  3.4 è·¯å¾„åˆ«å

  - @/* æ˜ å°„åˆ° src/*
  - ç¤ºä¾‹ï¼šimport { foo } from '@/utils/api.util'

  3.5 æ„å»ºé…ç½®

  {
    base: '/course/',  // éƒ¨ç½²å­è·¯å¾„
    plugins: <span class="hljs-section">[
      vue(),
      tailwindcss(),
      AutoImport({ resolvers: [ElementPlusResolver()]</span> }),
      Components({ resolvers: <span class="hljs-section">[ElementPlusResolver()]</span> })
    ]
  }

  ---
  å››ã€ç¼–ç¨‹è§„èŒƒ

  4.1 æ–‡ä»¶å‘½åè§„èŒƒ

  | ç±»å‹            | è§„èŒƒ              | ç¤ºä¾‹             |
  |-----------------|-------------------|------------------|
  | Vue ç»„ä»¶        | PascalCase + .vue | UserList.vue     |
  | TypeScript æ–‡ä»¶ | camelCase + .ts   | api.util.ts      |
  | æ¨¡å‹æ–‡ä»¶        | {name}.model.ts   | course.model.ts  |
  | API æ–‡ä»¶        | {name}.api.ts     | course.api.ts    |
  | ç»„åˆå¼å‡½æ•°      | use{Purpose}.ts   | useResponsive.ts |

  4.2 ä»£ç é£æ ¼

  ç¼©è¿›ä¸ç©ºæ ¼

  - ä½¿ç”¨ 2 ç©ºæ ¼ç¼©è¿›ï¼ˆä¸ä½¿ç”¨ Tabï¼‰
  - è¿ç®—ç¬¦å‰ååŠ ç©ºæ ¼ï¼ša + b
  - é€—å·ååŠ ç©ºæ ¼ï¼šfn(a, b, c)

  å¼•å·

  - ä¼˜å…ˆä½¿ç”¨å•å¼•å·ï¼šconst <span class="hljs-attr">name</span> = <span class="hljs-string">'John'</span>
  - JSON æˆ–åŒ…å«å•å¼•å·çš„å­—ç¬¦ä¸²ä½¿ç”¨åŒå¼•å·

  åˆ†å·

  - è¯­å¥æœ«å°¾å¿…é¡»åŠ åˆ†å·

  <span class="hljs-comment">####å°¾éšé€—å·</span>
  - å¯¹è±¡/æ•°ç»„/å‡½æ•°å‚æ•°æ·»åŠ å°¾éšé€—å·ï¼š
  const <span class="hljs-attr">obj</span> = {
    a: 1,
    b: 2,
  }<span class="hljs-comment">;</span>

  è¡Œå®½

  - æ¯è¡Œæœ€å¤š 80 å­—ç¬¦

  4.3 TypeScript è§„èŒƒ

  ç±»å‹å®šä¹‰

  // âœ… ä½¿ç”¨ interface å®šä¹‰å¯¹è±¡ç±»å‹
  export interface ApiResponse&lt;<span class="hljs-attr">T</span> = any&gt; {
    success: boolean<span class="hljs-comment">;</span>
    data?: T<span class="hljs-comment">;</span>
    message?: string<span class="hljs-comment">;</span>
    code?: string<span class="hljs-comment">;</span>
  }

  // âœ… ä½¿ç”¨ type å®šä¹‰è”åˆç±»å‹æˆ–å·¥å…·ç±»å‹
  export type <span class="hljs-attr">UserRole</span> = <span class="hljs-string">'admin'</span> | <span class="hljs-string">'teacher'</span> | <span class="hljs-string">'student'</span><span class="hljs-comment">;</span>

  // âœ… æ³›å‹çº¦æŸ
  export function query&lt;T&gt;(params: QueryFilter): Promise&lt;ApiResponse&lt;T&gt;&gt; {
    return ApiUtil.post('/query', params)<span class="hljs-comment">;</span>
  }

  é¿å… any

  // âŒ é¿å…ä½¿ç”¨ any
  function processData(data: any) { }

  // âœ… ä½¿ç”¨ unknown æˆ–å…·ä½“ç±»å‹
  function processData(data: unknown) {
    if (typeof <span class="hljs-attr">data</span> === <span class="hljs-string">'string'</span>) { }
  }

  ç±»å‹å¯¼å…¥

  // âœ… ä½¿ç”¨ type å…³é”®å­—å¯¼å…¥ç±»å‹
  import type { ApiResponse } from '@/model/api-response.model'<span class="hljs-comment">;</span>
  import { ApiUtil } from '@/utils/api.util'<span class="hljs-comment">;</span>

  4.4 Vue 3 ç»„ä»¶è§„èŒƒ

  ä½¿ç”¨ &lt;script setup&gt;

  &lt;script setup <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;
  import { ref, computed } from 'vue'<span class="hljs-comment">;</span>

  // å“åº”å¼çŠ¶æ€
  const <span class="hljs-attr">count</span> = ref(<span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
  const <span class="hljs-attr">doubled</span> = computed(() =&gt; count.value * <span class="hljs-number">2</span>)<span class="hljs-comment">;</span>

  // æ–¹æ³•
  function increment() {
    count.value++<span class="hljs-comment">;</span>
  }
  &lt;/script&gt;

  &lt;template&gt;
    &lt;div&gt;{{ count }} Ã— <span class="hljs-attr">2</span> = {{ doubled }}&lt;/div&gt;
  &lt;/template&gt;

  Props å®šä¹‰

  &lt;script setup <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;
  interface Props {
    title: string<span class="hljs-comment">;</span>
    count?: number<span class="hljs-comment">;</span>
  }

  // ä½¿ç”¨ withDefaults è®¾ç½®é»˜è®¤å€¼
  const <span class="hljs-attr">props</span> = withDefaults(defineProps&lt;Props&gt;(), {
    count: 0,
  })<span class="hljs-comment">;</span>
  &lt;/script&gt;

  Emits å®šä¹‰

  &lt;script setup <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;
  const <span class="hljs-attr">emit</span> = defineEmits&lt;{
    update: <span class="hljs-section">[value: string]</span><span class="hljs-comment">;</span>
    delete: <span class="hljs-section">[id: string]</span><span class="hljs-comment">;</span>
  }&gt;()<span class="hljs-comment">;</span>
  &lt;/script&gt;

  4.5 API è°ƒç”¨è§„èŒƒ

  API æ¨¡å—ç»„ç»‡

  // src/modules/{module}/api/{name}.api.ts
  import { ApiUtil } from '@/utils/api.util'<span class="hljs-comment">;</span>
  import type { ApiResponse } from '@/model/api-response.model'<span class="hljs-comment">;</span>
  import type { CourseModel } from '../model/course.model'<span class="hljs-comment">;</span>

  export const <span class="hljs-attr">courseApi</span> = {
    /**
     * æŸ¥è¯¢è¯¾ç¨‹åˆ—è¡¨
     */
    query: (params?: CourseQueryFilterModel): Promise&lt;ApiResponse&lt;ApiQueryResult&lt;CourseModel&gt;&gt;&gt; =&gt; {
      return ApiUtil.post('/course/query', params)<span class="hljs-comment">;</span>
    },

    /**
     * æ ¹æ®IDè·å–è¯¾ç¨‹è¯¦æƒ…
     */
    getById: (id: string): Promise&lt;ApiResponse&lt;CourseModel&gt;&gt; =&gt; {
      return ApiUtil.post('/course/getById', { id })<span class="hljs-comment">;</span>
    },

    /**
     * åˆ›å»ºè¯¾ç¨‹
     */
    create: (data: CourseCreateModel): Promise&lt;ApiResponse&lt;CourseModel&gt;&gt; =&gt; {
      return ApiUtil.post('/course/create', data)<span class="hljs-comment">;</span>
    },

    /**
     * æ›´æ–°è¯¾ç¨‹
     */
    update: (data: Partial&lt;CourseUpdateModel&gt;): Promise&lt;ApiResponse&lt;CourseModel&gt;&gt; =&gt; {
      return ApiUtil.post('/course/update', data)<span class="hljs-comment">;</span>
    },

    /**
     * åˆ é™¤è¯¾ç¨‹
     */
    delete: (data: { id: string }): Promise&lt;ApiResponse&lt;void&gt;&gt; =&gt; {
      return ApiUtil.post('/course/delete', data)<span class="hljs-comment">;</span>
    },
  }<span class="hljs-comment">;</span>

  ç»Ÿä¸€å“åº”æ ¼å¼

  export interface ApiResponse&lt;<span class="hljs-attr">T</span> = any&gt; {
    success: boolean<span class="hljs-comment">;</span>
    data?: T<span class="hljs-comment">;</span>
    message?: string<span class="hljs-comment">;</span>
    code?: string<span class="hljs-comment">;</span>
  }

  4.6 è·¯ç”±è§„èŒƒ

  è·¯ç”±ç»“æ„

  /admin/*     â†’ ç®¡ç†å‘˜æ¨¡å—
  /teacher/*   â†’ æ•™å¸ˆæ¨¡å—
  /student/*   â†’ å­¦ç”Ÿæ¨¡å—
  /login       â†’ ç™»å½•é¡µ

  è·¯ç”±å®ˆå«

  - è®¤è¯æ£€æŸ¥ï¼šæœªç™»å½•è·³è½¬ç™»å½•é¡µ
  - è§’è‰²éªŒè¯ï¼šæ ¹æ®ç”¨æˆ·è§’è‰²é™åˆ¶è®¿é—®
  - è‡ªåŠ¨é‡å®šå‘ï¼šç™»å½•åè·³è½¬åˆ°åŸç›®æ ‡é¡µé¢

  4.7 çŠ¶æ€ç®¡ç†è§„èŒƒ

  Pinia Store ç»“æ„

  // src/modules/system/store/auth.ts
  import { defineStore } from 'pinia'<span class="hljs-comment">;</span>
  import { ref, computed } from 'vue'<span class="hljs-comment">;</span>

  export const <span class="hljs-attr">useAuthStore</span> = defineStore(<span class="hljs-string">'auth'</span>, () =&gt; {
    // State
    const <span class="hljs-attr">accessToken</span> = ref&lt;string | null&gt;(null)<span class="hljs-comment">;</span>
    const <span class="hljs-attr">refreshToken</span> = ref&lt;string | null&gt;(null)<span class="hljs-comment">;</span>
    const <span class="hljs-attr">user</span> = ref&lt;UserModel | null&gt;(null)<span class="hljs-comment">;</span>

    // Getters
    const <span class="hljs-attr">isAuthenticated</span> = computed(() =&gt; !!accessToken.value)<span class="hljs-comment">;</span>
    const <span class="hljs-attr">isAdmin</span> = computed(() =&gt; user.value?.role === <span class="hljs-string">'admin'</span>)<span class="hljs-comment">;</span>

    // Actions
    async function login(credentials: LoginModel) { }
    async function logout() { }
    async function checkAuth() { }

    return {
      accessToken,
      refreshToken,
      user,
      isAuthenticated,
      isAdmin,
      login,
      logout,
      checkAuth,
    }<span class="hljs-comment">;</span>
  }, {
    persist: true,  // æŒä¹…åŒ–é…ç½®
  })<span class="hljs-comment">;</span>

  4.8 æ³¨é‡Šè§„èŒƒ

  JSDoc æ³¨é‡Š

  /**
   * æŸ¥è¯¢è¯¾ç¨‹åˆ—è¡¨
   * @param params - æŸ¥è¯¢è¿‡æ»¤æ¡ä»¶
   * @returns è¯¾ç¨‹åˆ—è¡¨å“åº”
   */
  query: (params?: CourseQueryFilterModel): Promise&lt;ApiResponse&lt;ApiQueryResult&lt;CourseModel&gt;&gt;&gt; =&gt; {
    return ApiUtil.post('/course/query', params)<span class="hljs-comment">;</span>
  }

  ç»„ä»¶æ³¨é‡Š

  /**
   * é€šç”¨æ•°æ®è¡¨æ ¼ç»„ä»¶
   * æ”¯æŒæ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯åŒè§†å›¾
   *
   * @example
   * &lt;DataTable :<span class="hljs-attr">data</span>=<span class="hljs-string">"courses"</span> :columns=<span class="hljs-string">"columns"</span> /&gt;
   */

  4.9 ç»„ä»¶å‘½åè§„èŒƒ

  å…¬å…±ç»„ä»¶

  - ä½ç½®ï¼šsrc/components/
  - å‘½åï¼šPascalCase
  - ç¤ºä¾‹ï¼šDataTable.vue, SearchForm.vue

  ä¸šåŠ¡æ¨¡å—ç»„ä»¶

  - ä½ç½®ï¼šsrc/modules/{module}/components/
  - å‘½åï¼šPascalCase + æ¨¡å—å‰ç¼€ï¼ˆå¯é€‰ï¼‰
  - ç¤ºä¾‹ï¼šAdminUserForm.vue, StudentCourseCard.vue

  4.10 æ ·å¼è§„èŒƒ

  ä¼˜å…ˆçº§

  1. Tailwind CSS å·¥å…·ç±»ï¼ˆåŸå­åŒ–ï¼‰
  2. Element Plus ç»„ä»¶æ ·å¼
  3. å…¨å±€æ ·å¼ (src/styles/)
  4. ç»„ä»¶ scoped æ ·å¼

  æ ·å¼å†™æ³•

  &lt;template&gt;
    &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"p-4 bg-white rounded-lg shadow"</span>&gt;å†…å®¹&lt;/div&gt;
  &lt;/template&gt;

  &lt;style scoped&gt;
  /* ç»„ä»¶ç‰¹å®šæ ·å¼ */
  .custom-style {
    /* ... */
  }
  &lt;/style&gt;

  ---
  äº”ã€æœ€ä½³å®è·µ

  5.1 SOLID åŸåˆ™åº”ç”¨

  S - å•ä¸€èŒè´£

  - æ¯ä¸ªç»„ä»¶/å‡½æ•°åªåšä¸€ä»¶äº‹
  - API å±‚åªè´Ÿè´£è¯·æ±‚ï¼Œä¸å¤„ç†ä¸šåŠ¡é€»è¾‘

  O - å¼€é—­åŸåˆ™

  - ä½¿ç”¨ Props å’Œ Slots æ‰©å±•ç»„ä»¶åŠŸèƒ½
  - é¿å…ç›´æ¥ä¿®æ”¹ç¬¬ä¸‰æ–¹åº“

  L - é‡Œæ°æ›¿æ¢

  - å­ç»„ä»¶å¯æ›¿æ¢çˆ¶ç»„ä»¶ä½¿ç”¨

  I - æ¥å£éš”ç¦»

  - Props æ¥å£ä¸“ä¸€ï¼Œé¿å…å†—ä½™å±æ€§

  D - ä¾èµ–å€’ç½®

  - ä¾èµ–æŠ½è±¡ï¼ˆæ¥å£ï¼‰è€Œéå…·ä½“å®ç°

  5.2 DRYï¼ˆæœç»é‡å¤ï¼‰

  // âŒ é‡å¤ä»£ç 
  function getCourses() { return ApiUtil.post('/course/query')<span class="hljs-comment">; }</span>
  function getStudents() { return ApiUtil.post('/student/query')<span class="hljs-comment">; }</span>

  // âœ… æŠ½è±¡é€šç”¨é€»è¾‘
  function createQueryApi(endpoint: string) {
    return (params?: any) =&gt; ApiUtil.post(`/${endpoint}/query`, params)<span class="hljs-comment">;</span>
  }

  5.3 KISSï¼ˆç®€å•è‡³ä¸Šï¼‰

  // âŒ è¿‡åº¦å¤æ‚
  const <span class="hljs-attr">result</span> = data.reduce((acc, item) =&gt; {
    return item.active ? <span class="hljs-section">[...acc, item]</span> : acc<span class="hljs-comment">;</span>
  }, <span class="hljs-section">[]</span>)<span class="hljs-comment">;</span>

  // âœ… ç®€å•ç›´è§‚
  const <span class="hljs-attr">result</span> = data.filter(item =&gt; item.active)<span class="hljs-comment">;</span>

  5.4 YAGNIï¼ˆç²¾ç›Šæ±‚ç²¾ï¼‰

  - åªå®ç°å½“å‰éœ€è¦çš„åŠŸèƒ½
  - ä¸è¦ä¸ºæœªæ¥é¢„ç•™
  - åˆ é™¤æœªä½¿ç”¨çš„ä»£ç å’Œä¾èµ–

  ---
  å…­ã€å‘½ä»¤é€ŸæŸ¥

  <span class="hljs-comment"># å®‰è£…ä¾èµ–</span>
  npm install

  <span class="hljs-comment"># å¯åŠ¨å¼€å‘æœåŠ¡å™¨</span>
  npm run dev

  <span class="hljs-comment"># ç±»å‹æ£€æŸ¥</span>
  npm run type-check

  <span class="hljs-comment"># ä»£ç æ£€æŸ¥</span>
  npm run lint

  <span class="hljs-comment"># æ ¼å¼åŒ–ä»£ç </span>
  npm run format

  <span class="hljs-comment"># æ„å»ºç”Ÿäº§ç‰ˆæœ¬</span>
  npm run build

  ---
  ä¸ƒã€å…³é”®ç‰¹æ€§æ€»ç»“

  | ç‰¹æ€§           | è¯´æ˜                              |
  |----------------|-----------------------------------|
  | æ¨¡å—åŒ–æ¶æ„     | æŒ‰è§’è‰²å’Œä¸šåŠ¡æ¨¡å—æ¸…æ™°åˆ’åˆ†          |
  | ä¸¥æ ¼ç±»å‹ç³»ç»Ÿ   | TypeScript strict æ¨¡å¼            |
  | è‡ªåŠ¨å¯¼å…¥       | ç»„ä»¶å’Œ API è‡ªåŠ¨å¯¼å…¥ï¼Œæ— éœ€æ‰‹åŠ¨å¼•å…¥ |
  | ç§»åŠ¨ç«¯é€‚é…     | å“åº”å¼è®¾è®¡ + è§¦æ‘¸æ‰‹åŠ¿æ”¯æŒ         |
  | ç»Ÿä¸€ API è§„èŒƒ  | æ ‡å‡†åŒ–çš„ CRUD æ“ä½œ                |
  | å¤šè§’è‰²æƒé™     | Admin/Teacher/Student ä¸‰çº§è·¯ç”±    |
  | Token è‡ªåŠ¨åˆ·æ–° | æ— æ„Ÿåˆ·æ–°è®¤è¯æœºåˆ¶                  |
  | ä»£ç è´¨é‡ä¿è¯   | ESLint + Prettier è‡ªåŠ¨æ£€æŸ¥        |

  ---
  ä»¥ä¸Šè§„èŒƒåŸºäºç°æœ‰ä»£ç åº“åˆ†ææ€»ç»“ï¼Œéµå¾ªäº† SOLIDã€KISSã€DRYã€YAGNI åŸåˆ™ï¼Œé€‚åˆä¼ä¸šçº§å›¢é˜Ÿåä½œå¼€å‘ã€‚
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue ç¼–è¯‘åŸç†]]></title>    <link>https://juejin.cn/post/7586893663076974602</link>    <guid>https://juejin.cn/post/7586893663076974602</guid>    <pubDate>2025-12-24T02:07:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586893663076974602" data-draft-id="7586959875768221705" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue ç¼–è¯‘åŸç†"/> <meta itemprop="keywords" content="ç¼–è¯‘åŸç†"/> <meta itemprop="datePublished" content="2025-12-24T02:07:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="coderjc"/> <meta itemprop="url" content="https://juejin.cn/user/4279763486908104"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue ç¼–è¯‘åŸç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4279763486908104/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    coderjc
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T02:07:16.000Z" title="Wed Dec 24 2025 02:07:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»40åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å‚è€ƒ: ã€ŠVue.jsè®¾è®¡ä¸å®ç°ã€‹ -- éœæ˜¥é˜³</p>
</blockquote>
<blockquote>
<p>å£°æ˜ï¼šæœ¬æ–‡æ˜¯åŸºäºä¸ªäººå­¦ä¹ å’Œç†è§£æ‰€å†™ï¼Œå¦‚æœ‰ç†è§£åå·®æˆ–é”™è¯¯ä¹‹å¤„ï¼Œè¿˜è¯·å„ä½è¯»è€…æŒ‡å‡ºã€‚</p>
</blockquote>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯ç¼–è¯‘ï¼Ÿ</h2>
<p>æåˆ°ç¼–è¯‘ï¼Œç›¸ä¿¡ä¸å°‘è¯»è€…éƒ½ä¼šè§‰å¾—æ˜¯ä¸€ä»¶å¾ˆç¥ç§˜çš„äº‹æƒ…ï¼Œæœ¬æ–‡å°±é€šè¿‡åˆ†æ Vue çš„ç¼–è¯‘åŸç†ï¼Œæ¥æ€å¼€å®ƒçš„ç¥ç§˜é¢çº±ã€‚</p>
<p>ä»€ä¹ˆæ˜¯**ç¼–è¯‘ï¼ˆcompileï¼‰**å‘¢ï¼Ÿåœ¨ Vue ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸è¯´çš„ç¼–è¯‘å°±æ˜¯æŒ‡å°†æ¨¡æ¿ä¸­çš„ä»£ç è½¬ä¸ºå¯ç”¨çš„ render å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å°† html ä»£ç è½¬ä¸ºäº† js ä»£ç ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç†è§£ç¼–è¯‘å°±æ˜¯å°†ä¸€ç§è¯­è¨€ ==è½¬å˜==&gt; å¦ä¸€ç§è¯­è¨€ã€‚è€Œè¿™ä¸ªè¢«è½¬å˜çš„å°±ç§°ä¹‹ä¸ºæºç ï¼ˆsource codeï¼‰ï¼Œè½¬å˜åå¾—åˆ°çš„ç»“æœï¼Œå°±ç§°ä¹‹ä¸ºç›®æ ‡ä»£ç ï¼ˆtarget codeï¼‰ã€‚</p>
<p>è€Œä¸€ä¸ªè¯­è¨€è¦è½¬å˜ä¸ºä¸€ç§æ–°çš„è¯­è¨€ï¼Œæˆ‘ä»¬è¦é€šè¿‡ä»€ä¹ˆæ‰‹æ®µå‘¢ï¼Ÿç²—æš´çš„å…³é”®è¯æ˜ å°„æˆ–è€…å­—ç¬¦ä¸²æ›¿æ¢å—ï¼Ÿåœ¨ç¼–ç¨‹ä¸­ï¼Œè™½ç„¶ä¸å¯é¿å…çš„å­˜åœ¨ç¡¬ç¼–ç ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸€å®šä¼šé€šè¿‡å„ç§æ‰‹æ®µæ¥è¿›è¡Œä¼˜åŒ–ï¼Œè®©ç¡¬ç¼–ç å°½å¯èƒ½çš„å°‘ï¼Œè€Œè¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œå¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯ä¸€ç§éå¸¸ç³Ÿç³•çš„ç¡¬ç¼–ç ã€‚</p>
<p>è®¾æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæŠŠä¸€æ®µä¸­æ–‡ç¿»è¯‘ä¸ºè‹±æ–‡ï¼Œå¦‚æœç›´æ¥æŒ‰ç…§è¯è¯­çš„é¡ºåºç›´ç¿»ï¼Œé‚£ä¹ˆä¸å°‘æ—¶å€™ï¼Œä¸€æ®µå¥å­çš„è¯­ä¹‰å¯èƒ½éƒ½æ˜¯æ˜¾å¾—æ¯”è¾ƒå¥‡æ€ªçš„ã€‚æ‰€ä»¥é€šå¸¸ä¸ä¼šé€å­—æ›¿æ¢ï¼Œè€Œæ˜¯ä¼šå…ˆç†è§£è¿™æ®µè¯çš„æ„æ€å’Œç»“æ„ï¼šå“ªäº›æ˜¯ä¸»è¯­ã€å“ªäº›æ˜¯è°“è¯­ã€å“ªäº›æ˜¯ä¿®é¥°æˆåˆ†ã€‚ç„¶åå†ç”¨è‹±æ–‡çš„è¯­æ³•è§„åˆ™é‡æ–°ç»„ç»‡è¿™äº›å†…å®¹ã€‚</p>
<p>ç¼–è¯‘ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ª"ä¸­é—´å½¢å¼"æ¥è¡¨è¾¾æºç çš„ç»“æ„å’Œè¯­ä¹‰ï¼Œè¿™ä¸ªä¸­é—´å½¢å¼å°±æ˜¯ <strong>æŠ½è±¡è¯­æ³•æ ‘ï¼ˆAbstract Syntax Treeï¼Œç®€ç§° ASTï¼‰</strong>ã€‚</p>
<p>å®é™…ä¸Šï¼Œåœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œç¼–è¯‘è¿‡ç¨‹é€šå¸¸è¢«åˆ†ä¸ºå‡ ä¸ªå…³é”®æ­¥éª¤ï¼š</p>
<ol>
<li><strong>è¯æ³•åˆ†æ</strong>ï¼šå°†ä»£ç å­—ç¬¦ä¸²åˆ†è§£æˆä¸€ä¸ªä¸ªæœ‰æ„ä¹‰çš„è¯æ³•å•å…ƒï¼ˆtokenï¼‰</li>
<li><strong>è¯­æ³•åˆ†æ</strong>ï¼šå°†è¿™äº›è¯æ³•å•å…ƒç»„ç»‡æˆä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼Œè¿™ä¸ªç»“æ„å°±æ˜¯ <strong>æŠ½è±¡è¯­æ³•æ ‘ï¼ˆAbstract Syntax Treeï¼Œç®€ç§° ASTï¼‰</strong></li>
<li>ä¸­é—´ä»£ç ç”Ÿæˆã€ä¼˜åŒ–...ï¼ˆæœ‰äº›ç¼–è¯‘è¿‡ç¨‹ä¼šæœ‰è¿™äº›æ­¥éª¤ï¼‰</li>
<li><strong>ä»£ç ç”Ÿæˆ</strong>ï¼šåŸºäº AST ç”Ÿæˆç›®æ ‡ä»£ç </li>
</ol>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒAST åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­æ‰®æ¼”ç€æ‰¿ä¸Šå¯ä¸‹çš„å…³é”®è§’è‰²ï¼Œå®ƒå°±åƒä¸€åº§æ¡¥æ¢ï¼Œè¿æ¥ç€æºç å’Œç›®æ ‡ä»£ç ã€‚</p>
<p>å¦‚æœå¯¹ä¸Šé¢çš„æ­¥éª¤è¿›è¡Œä¸€äº›æ‹†åˆ†ï¼Œé‚£ä¹ˆå¤§è‡´å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œç¼–è¯‘å‰ç«¯å’Œç¼–è¯‘åç«¯ï¼š</p>
<ul>
<li>ç¼–è¯‘å‰ç«¯: é€šå¸¸ä¸ç›®æ ‡å¹³å°æ— å…³ï¼Œä»…è´Ÿè´£åˆ†ææºç ã€‚</li>
<li>ç¼–è¯‘åç«¯: é€šå¸¸ä¸ç›®æ ‡å¹³å°ç›¸å…³ï¼Œè´Ÿè´£ç”Ÿæˆèƒ½å¤Ÿè¿è¡Œçš„å¹³å°ä»£ç ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2452c9ea14b544e1adbb30a59e7c3a25~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJqYw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767146836&amp;x-signature=0vApKhDVK5Urviu3ZsdpwDC20Sg%3D" alt="image-20251218101936666.png" loading="lazy"/></p>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯ ASTï¼Ÿ</h2>
<p>å‰é¢æˆ‘ä»¬å¤šæ¬¡æåˆ°äº† ASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰ï¼Œä½†å®ƒåˆ°åº•é•¿ä»€ä¹ˆæ ·å‘¢ï¼Ÿä¸ºä»€ä¹ˆè¦å«"æ ‘"ï¼Œåˆä¸ºä»€ä¹ˆè¦å«"æŠ½è±¡"ï¼Ÿ</p>
<p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥ç†è§£ä»€ä¹ˆæ˜¯"æ ‘"ã€‚å‡è®¾æˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ªç®€å•çš„ç®—æœ¯è¡¨è¾¾å¼ï¼š</p>
<pre><code class="hljs">2 + 3 * 4
</code></pre>
<p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œè¿™ä¸ªè¡¨è¾¾å¼çš„è®¡ç®—ç»“æœæ˜¯ <code>14</code>ï¼Œè€Œä¸æ˜¯ <code>20</code>ï¼Œå› ä¸ºä¹˜æ³•çš„ä¼˜å…ˆçº§é«˜äºåŠ æ³•ã€‚é‚£ä¹ˆåœ¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å¦‚ä½•è¡¨è¾¾è¿™ç§ä¼˜å…ˆçº§å…³ç³»å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ç”¨<strong>æ ‘å½¢ç»“æ„</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">        +</span>
       / \
<span class="hljs-code">      2   *
         / \
        3   4
</span></code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ ‘å½¢ç»“æ„æ¸…æ™°åœ°è¡¨è¾¾äº†è¿ç®—çš„ä¼˜å…ˆçº§ï¼šå…ˆè®¡ç®— <code>3 * 4</code>ï¼Œå†å°†ç»“æœä¸ <code>2</code> ç›¸åŠ ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå«"æ ‘"â€”â€”å®ƒç”¨<strong>å±‚çº§å…³ç³»</strong>æ¥è¡¨è¾¾ä»£ç çš„<strong>ç»“æ„å’Œä¼˜å…ˆçº§</strong>ã€‚</p>
<p>é‚£ä¸ºä»€ä¹ˆåˆå«"æŠ½è±¡"å‘¢ï¼Ÿå› ä¸ºè¿™æ£µæ ‘åªä¿ç•™äº†ä»£ç çš„æ ¸å¿ƒç»“æ„å’Œè¯­ä¹‰ï¼Œè€Œ<strong>çœç•¥äº†ä¸€äº›è¯­æ³•ç»†èŠ‚</strong>ã€‚æ¯”å¦‚åœ¨ä¸Šé¢çš„æ ‘ä¸­ï¼Œæˆ‘ä»¬çœ‹ä¸åˆ°ç©ºæ ¼ã€çœ‹ä¸åˆ°è¡¨è¾¾å¼ä»å·¦å¾€å³çš„ä¹¦å†™é¡ºåºï¼Œåªä¿ç•™äº†æœ€æ ¸å¿ƒçš„ä¿¡æ¯ï¼šæœ‰ä¸¤ä¸ªæ“ä½œç¬¦ï¼ˆ<code>+</code> å’Œ <code>*</code>ï¼‰ï¼Œä¸‰ä¸ªæ“ä½œæ•°ï¼ˆ<code>2</code>ã€<code>3</code>ã€<code>4</code>ï¼‰ï¼Œä»¥åŠå®ƒä»¬ä¹‹é—´çš„å±‚çº§å…³ç³»ã€‚</p>
<p>åœ¨å®é™…çš„ç¼–ç¨‹ä¸­ï¼ŒAST é€šå¸¸ç”¨å¯¹è±¡æ¥è¡¨ç¤ºã€‚ä¸Šé¢çš„ç®—æœ¯è¡¨è¾¾å¼å¯¹åº”çš„ AST å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-js" lang="js">{
  <span class="hljs-attr">type</span>: <span class="hljs-string">'BinaryExpression'</span>,    <span class="hljs-comment">// äºŒå…ƒè¡¨è¾¾å¼</span>
  <span class="hljs-attr">operator</span>: <span class="hljs-string">'+'</span>,
  <span class="hljs-attr">left</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'Literal'</span>,           <span class="hljs-comment">// å­—é¢é‡</span>
    <span class="hljs-attr">value</span>: <span class="hljs-number">2</span>
  },
  <span class="hljs-attr">right</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'BinaryExpression'</span>,
    <span class="hljs-attr">operator</span>: <span class="hljs-string">'*'</span>,
    <span class="hljs-attr">left</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'Literal'</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-number">3</span>
    },
    <span class="hljs-attr">right</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'Literal'</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-number">4</span>
    }
  }
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ª AST èŠ‚ç‚¹éƒ½åŒ…å«äº†å‡ ä¸ªå…³é”®ä¿¡æ¯ï¼š</p>
<ul>
<li><strong>typeï¼ˆç±»å‹ï¼‰</strong>ï¼šè¿™ä¸ªèŠ‚ç‚¹æ˜¯ä»€ä¹ˆç±»å‹çš„è¯­æ³•ç»“æ„ï¼ˆè¡¨è¾¾å¼ã€è¯­å¥ã€å­—é¢é‡ç­‰ï¼‰</li>
<li><strong>å±æ€§</strong>ï¼šè¿™ä¸ªèŠ‚ç‚¹çš„å…·ä½“ä¿¡æ¯ï¼ˆæ¯”å¦‚æ“ä½œç¬¦æ˜¯ <code>+</code> è¿˜æ˜¯ <code>-</code>ï¼Œå­—é¢é‡çš„å€¼æ˜¯å¤šå°‘ï¼‰</li>
<li><strong>å­èŠ‚ç‚¹</strong>ï¼šè¿™ä¸ªèŠ‚ç‚¹åŒ…å«çš„å­ç»“æ„ï¼ˆæ¯”å¦‚äºŒå…ƒè¡¨è¾¾å¼çš„å·¦å³æ“ä½œæ•°ï¼‰</li>
</ul>
<p>æ­£æ˜¯é€šè¿‡è¿™ç§æ ‘å½¢ç»“æ„ï¼Œç¼–è¯‘å™¨å¯ä»¥æ–¹ä¾¿åœ°éå†ã€åˆ†æå’Œè½¬æ¢ä»£ç ã€‚æ¯”å¦‚è¦è®¡ç®—ä¸Šé¢çš„è¡¨è¾¾å¼ï¼Œåªéœ€è¦é€’å½’åœ°è®¡ç®—å­èŠ‚ç‚¹ï¼Œç„¶åæ ¹æ®æ“ä½œç¬¦è¿›è¡Œè¿ç®—å³å¯ã€‚</p>
<p>é‚£ä¹ˆåœ¨ Vue ä¸­ï¼Œæ¨¡æ¿å¯¹åº”çš„ AST åˆæ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿè®©æˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹ã€‚</p>
<h2 data-id="heading-2">äº†è§£ Vue ç¼–è¯‘æµç¨‹</h2>
<p>ç»è¿‡å‰æ–‡çš„è§£æï¼Œç›¸ä¿¡ä½ å¯¹ç¼–è¯‘å·²ç»æœ‰äº†ä¸€äº›å¤§æ¦‚çš„ç†è§£ï¼Œè€Œ Vue çš„æ¨¡æ¿ç¼–è¯‘ä¹Ÿæ­£æ˜¯éµå¾ªäº†è¿™æ ·çš„æµç¨‹ã€‚</p>
<p>å›åˆ°æ–‡ç« å¼€å¤´æåˆ°çš„ï¼ŒVue çš„ç¼–è¯‘å°±æ˜¯å°†æ¨¡æ¿ï¼ˆTemplateï¼‰è½¬æ¢ä¸ºæ¸²æŸ“å‡½æ•°ï¼ˆRender Functionï¼‰ã€‚é‚£ä¹ˆè¿™ä¸ªè¿‡ç¨‹å…·ä½“æ˜¯å¦‚ä½•è¿›è¡Œçš„å‘¢ï¼Ÿè®©æˆ‘ä»¬å°†å‰é¢å­¦åˆ°çš„ç¼–è¯‘çŸ¥è¯†åº”ç”¨åˆ° Vue ä¸­ï¼š</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ª Vue æ¨¡æ¿ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;div id="app"&gt;
  &lt;p&gt;{{ message }}&lt;/p&gt;
&lt;/div&gt;
</code></pre>
<p>Vue æœ€ç»ˆä¼šå°†å®ƒè½¬æ¢æˆç±»ä¼¼è¿™æ ·çš„æ¸²æŸ“å‡½æ•°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">_c</span>(<span class="hljs-string">'div'</span>, { <span class="hljs-attr">attrs</span>: { <span class="hljs-attr">id</span>: <span class="hljs-string">'app'</span> } }, [
    <span class="hljs-title function_">_c</span>(<span class="hljs-string">'p'</span>, [<span class="hljs-title function_">_v</span>(<span class="hljs-title function_">_s</span>(message))])
  ])
}
</code></pre>
<p>è€Œå˜æˆè¿™æ ·å¤§æ¦‚ä¼šç»è¿‡å¦‚ä¸‹å‡ ä¸ªæ­¥éª¤ï¼Œå¦‚å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a308314b4a1249af8fcbeb2a1d602946~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJqYw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767146836&amp;x-signature=5HtYJXy2wvovtgayx4rKIyKmicw%3D" alt="image-20251218103223833.png" loading="lazy"/></p>
<p>è€Œè¿™ç§æ­¥éª¤ä¹Ÿåœ¨å…¶å®ƒåœ°æ–¹æœ‰æ‰€ä½“ç°ï¼Œæ¯”å¦‚ typescript --&gt; javascriptã€‚é‚£è‚¯å®šå¤§æ¦‚æµç¨‹å°±æ˜¯ typescript --&gt; typescript AST --&gt; javascript AST --&gt; javascriptã€‚å½“ç„¶ï¼Œè¿™ç§ä¾‹å­è¿˜æœ‰å¾ˆå¤šï¼Œå°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ã€‚</p>
<h2 data-id="heading-3">Template --&gt; Template AST</h2>
<h3 data-id="heading-4">å®ç°åˆ†æ</h3>
<blockquote>
<p>ç¼–è¯‘çš„æ€æƒ³è™½ç„¶éƒ½å·®ä¸å¤šï¼Œä½†æ˜¯è½åˆ°å…·ä½“çš„å®ç°ï¼Œåˆå„æœ‰ä¸åŒï¼Œæ‰€ä»¥æ­¤å°èŠ‚ï¼Œå°†ä¼šå¯¹ vue ä¸­å¦‚å°† templete ç¼–è¯‘ä¸º render å‡½æ•°åšå‡ºç®€è¦çš„ä»‹ç»ã€‚</p>
</blockquote>
<p>é€šè¿‡ä¸Šé¢çš„èµ˜è¿°ï¼Œä¸éš¾çŒœåˆ°è§£æå™¨çš„æ ¸å¿ƒä½œç”¨å°±æ˜¯å°†æ¨¡æ¿ä»£ç å˜ä¸º ASTã€‚ å‡è®¾æˆ‘ä»¬æœ‰ä¸‹é¢ä¸€æ®µæ¨¡æ¿ä»£ç :</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
    &lt;div&gt;
        &lt;h1 :class="titleClass"&gt;Hello World&lt;/h1&gt;
    &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>ä¸Šé¢è¿™æ®µä»£ç ï¼Œä»æˆ‘ä»¬çœ‹æ¥ï¼Œå¯èƒ½ä¼šæœ‰å˜é‡ã€æ ‡ç­¾ã€å­—ç¬¦...çš„å­˜åœ¨ï¼Œè€Œå¯¹äºè§£æèµ·æ¥è¯´ï¼Œå°±æ˜¯ä¸€æ®µæºç å­—ç¬¦ä¸²ï¼Œä½¿ç”¨ä»£ç ç®€å•è¡¨ç¤ºï¼Œå¦‚ä¸‹:</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> sourceCode = <span class="hljs-string">`&lt;template&gt;&lt;div&gt;&lt;h1 :class="titleClass"&gt;Hello World&lt;/h1&gt;&lt;/div&gt;&lt;/template&gt;`</span>
</code></pre>
<p>é‚£ä¹ˆå¦‚ä½•è§£æå‘¢ï¼Ÿå¦‚æœä½ çœ‹è¿‡éœæ˜¥é˜³å¤§ä½¬çš„ã€ŠVue.js è®¾è®¡ä¸å®ç°ã€‹è¿™æœ¬ä¹¦ï¼Œé‚£ä¹ˆç›¸ä¿¡ä½ ä¸€å®šä¸é™Œç”Ÿã€‚åœ¨è¿™æœ¬é‡Œé¢ï¼Œæå‡ºäº†ä¸€ä¸ªæ¦‚å¿µ<strong>æœ‰é™çŠ¶æ€è‡ªåŠ¨æœº</strong>ã€‚</p>
<p>é‚£ä¹ˆä»€ä¹ˆæ˜¯æœ‰é™çŠ¶æ€è‡ªåŠ¨æœºå‘¢ï¼Ÿæœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼ˆFinite State Automatonï¼Œä¹Ÿç§°æœ‰é™çŠ¶æ€æœºï¼‰å¬èµ·æ¥å¥½åƒå¾ˆé«˜å¤§ä¸Šï¼Œç†è§£èµ·æ¥å¹¶ä¸å›°éš¾ï¼Œ"æœ‰é™çŠ¶æ€"æŒ‡çš„æ˜¯çŠ¶æ€æ˜¯æœ‰é™çš„ï¼Œ"è‡ªåŠ¨æœº"æ„å‘³ç€éšç€å­—ç¬¦çš„è¾“å…¥ï¼Œè§£æå™¨ä¼šè‡ªåŠ¨åœ°åœ¨ä¸åŒçŠ¶æ€é—´è¿ç§»ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³éå¸¸ç®€å•ï¼š<strong>ä¸€ä¸ªç³»ç»Ÿåœ¨ä»»æ„æ—¶åˆ»éƒ½å¤„äºæŸä¸ªç‰¹å®šçš„"çŠ¶æ€"ï¼Œå½“æ¥æ”¶åˆ°ä¸åŒçš„"è¾“å…¥"æ—¶ï¼Œä¼š"è‡ªåŠ¨"è½¬ç§»åˆ°å¦ä¸€ä¸ª"çŠ¶æ€"</strong>ã€‚è¿™é‡Œçš„"è‡ªåŠ¨"æŒ‡çš„æ˜¯çŠ¶æ€è½¬ç§»æ˜¯ç¡®å®šæ€§çš„ï¼Œéµå¾ªé¢„å…ˆå®šä¹‰å¥½çš„è§„åˆ™ã€‚</p>
<p>ä¸¾ä¸ªç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼Œæƒ³è±¡ä¸€ä¸‹ä½ åœ¨ä½¿ç”¨ä¸€ä¸ªç®€å•çš„ç”µç¯å¼€å…³ï¼š</p>
<ul>
<li><strong>åˆå§‹çŠ¶æ€</strong>ï¼šç¯æ˜¯å…³é—­çš„</li>
<li><strong>è¾“å…¥</strong>ï¼šæŒ‰ä¸€ä¸‹å¼€å…³ â†’ <strong>çŠ¶æ€è½¬ç§»</strong> â†’ ç¯æ‰“å¼€äº†</li>
<li><strong>å†è¾“å…¥</strong>ï¼šå†æŒ‰ä¸€ä¸‹å¼€å…³ â†’ <strong>çŠ¶æ€è½¬ç§»</strong> â†’ ç¯å…³é—­äº†</li>
</ul>
<p>è¿™ä¸ªç”µç¯ç³»ç»Ÿå°±æ˜¯ä¸€ä¸ªç®€å•çš„æœ‰é™çŠ¶æ€æœºï¼Œå®ƒåªæœ‰ä¸¤ä¸ªçŠ¶æ€ï¼ˆå¼€/å…³ï¼‰ï¼Œé€šè¿‡ç‰¹å®šçš„è¾“å…¥ï¼ˆæŒ‰å¼€å…³ï¼‰æ¥åˆ‡æ¢çŠ¶æ€ã€‚</p>
<p>é‚£ä¹ˆåœ¨è§£æ HTML æ¨¡æ¿æ—¶ï¼Œæœ‰é™çŠ¶æ€æœºæ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥æŠŠè§£æå™¨æƒ³è±¡æˆä¸€ä¸ª"è¯»å­—ç¬¦"çš„æœºå™¨ï¼Œå®ƒä¼šä»å·¦å¾€å³é€ä¸ªå­—ç¬¦åœ°è¯»å–æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œæ ¹æ®å½“å‰è¯»åˆ°çš„å­—ç¬¦ï¼Œæ¥åˆ¤æ–­è‡ªå·±å¤„äºä»€ä¹ˆçŠ¶æ€ï¼Œç„¶åå†³å®šä¸‹ä¸€æ­¥è¯¥åšä»€ä¹ˆã€‚</p>
<p>æ¯”å¦‚è§£æ <code>&lt;div&gt;Hello&lt;/div&gt;</code> è¿™æ®µä»£ç æ—¶ï¼Œè§£æå™¨å¯èƒ½ä¼šç»å†è¿™æ ·çš„çŠ¶æ€å˜åŒ–ï¼š</p>
<ol>
<li><strong>"åˆå§‹çŠ¶æ€"</strong> â†’ è¯»åˆ° <code>&lt;</code> â†’ è¿›å…¥ <strong>"æ ‡ç­¾å¼€å§‹"çŠ¶æ€</strong></li>
<li><strong>"æ ‡ç­¾å¼€å§‹"çŠ¶æ€</strong> â†’ è¯»åˆ°å­—æ¯ <code>d</code> â†’ è¿›å…¥ <strong>"æ ‡ç­¾å"çŠ¶æ€</strong></li>
<li><strong>"æ ‡ç­¾å"çŠ¶æ€</strong> â†’ ç»§ç»­è¯»åˆ° <code>i</code>ã€<code>v</code>ï¼Œæ‹¼æ¥æˆæ ‡ç­¾å <code>div</code></li>
<li><strong>"æ ‡ç­¾å"çŠ¶æ€</strong> â†’ è¯»åˆ° <code>&gt;</code> â†’ <strong>å¼€å§‹æ ‡ç­¾è§£æå®Œæˆ</strong>ï¼Œåˆ›å»ºä¸€ä¸ª <code>&lt;div&gt;</code> å…ƒç´ èŠ‚ç‚¹ï¼Œè¿›å…¥ <strong>"æ–‡æœ¬å†…å®¹"çŠ¶æ€</strong></li>
<li><strong>"æ–‡æœ¬å†…å®¹"çŠ¶æ€</strong> â†’ è¯»åˆ° <code>H</code>ã€<code>e</code>ã€<code>l</code>ã€<code>l</code>ã€<code>o</code>ï¼Œæ‹¼æ¥æˆæ–‡æœ¬å†…å®¹ <code>Hello</code></li>
<li><strong>"æ–‡æœ¬å†…å®¹"çŠ¶æ€</strong> â†’ è¯»åˆ° <code>&lt;</code> â†’ æ–‡æœ¬å†…å®¹æ”¶é›†å®Œæˆï¼Œè¿›å…¥ <strong>"æ ‡ç­¾å¼€å§‹"çŠ¶æ€</strong></li>
<li><strong>"æ ‡ç­¾å¼€å§‹"çŠ¶æ€</strong> â†’ è¯»åˆ° <code>/</code> â†’ åˆ¤æ–­è¿™æ˜¯ä¸€ä¸ªç»“æŸæ ‡ç­¾ï¼Œè¿›å…¥ <strong>"ç»“æŸæ ‡ç­¾å"çŠ¶æ€</strong></li>
<li><strong>"ç»“æŸæ ‡ç­¾å"çŠ¶æ€</strong> â†’ è¯»åˆ° <code>d</code>ã€<code>i</code>ã€<code>v</code> â†’ æ‹¼æ¥æˆç»“æŸæ ‡ç­¾å <code>div</code></li>
<li><strong>"ç»“æŸæ ‡ç­¾å"çŠ¶æ€</strong> â†’ è¯»åˆ° <code>&gt;</code> â†’ <strong>ç»“æŸæ ‡ç­¾è§£æå®Œæˆ</strong>ï¼Œä¸ä¹‹å‰çš„å¼€å§‹æ ‡ç­¾ <code>&lt;div&gt;</code> é…å¯¹ï¼Œå®Œæˆè¯¥å…ƒç´ çš„è§£æ</li>
</ol>
<p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªç®€åŒ–çš„çŠ¶æ€è½¬æ¢å›¾æ¥è¡¨ç¤ºï¼š</p>
<pre><code class="hljs language-scss" lang="scss">åˆå§‹çŠ¶æ€
   â†“ (è¯»åˆ° '&lt;')
æ ‡ç­¾å¼€å§‹
   â†“ (è¯»åˆ°å­—æ¯)
æ ‡ç­¾å (æ”¶é›† "div")
   â†“ (è¯»åˆ° '&gt;')
æ–‡æœ¬å†…å®¹ (æ”¶é›† "Hello")
   â†“ (è¯»åˆ° '&lt;')
æ ‡ç­¾å¼€å§‹
   â†“ (è¯»åˆ° '/')
ç»“æŸæ ‡ç­¾å (æ”¶é›† "div")
   â†“ (è¯»åˆ° '&gt;')
å®Œæˆè§£æ
</code></pre>
<p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œè§£æå™¨å¯ä»¥<strong>ç²¾ç¡®åœ°è¯†åˆ«</strong>æ¨¡æ¿ä¸­çš„æ¯ä¸€ä¸ªéƒ¨åˆ†ï¼šå“ªäº›æ˜¯å¼€å§‹æ ‡ç­¾ã€å“ªäº›æ˜¯å±æ€§ã€å“ªäº›æ˜¯æ–‡æœ¬å†…å®¹ã€å“ªäº›æ˜¯ç»“æŸæ ‡ç­¾ã€‚è€Œä¸”ï¼Œè¿™ç§æ–¹æ³•ä¸éœ€è¦å¤æ‚çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œä¹Ÿä¸éœ€è¦å›æº¯ï¼Œåªéœ€è¦é¡ºåºè¯»å–å­—ç¬¦ï¼Œæ ¹æ®å½“å‰çŠ¶æ€åšå‡ºç›¸åº”çš„å¤„ç†å³å¯ï¼Œ<strong>æ•ˆç‡éå¸¸é«˜</strong>ã€‚</p>
<h3 data-id="heading-5">å…·ä½“å®ç°-å‰ç½®å‡†å¤‡</h3>
<blockquote>
<p>è¿™ä¸€æ­¥éª¤åšçš„äº‹æƒ…å¾ˆç®€å•ï¼Œåšå¥½ä¸€äº›å‡†å¤‡å·¥ä½œï¼Œå®šä¹‰è¦è§£æçš„æ¨¡æ¿å­—ç¬¦ä»£ç ï¼ŒçŠ¶æ€æ˜ å°„å­—æ®µï¼Œåˆ¤æ–­å­—æ¯çš„è¾…åŠ©å‡½æ•°</p>
</blockquote>
<p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸ªæ¥è¿›è¡Œä¸€ä¸ªæœ€ç®€å®ç°ï¼Œæ—¢ç„¶æ˜¯é€šè¿‡çŠ¶æ€æ¥ç¡®å®šï¼Œå°±å¿…é¡»å…ˆå®šä¹‰å¥½çŠ¶æ€ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> template = <span class="hljs-string">`&lt;div&gt;Vue&lt;/div&gt;`</span> <span class="hljs-comment">// å‡è®¾è¿™å°±æ˜¯æ¨¡æ¿ä»£ç </span>

<span class="hljs-keyword">const</span> <span class="hljs-title class_">Status</span> = {
    <span class="hljs-comment">/**åˆå§‹çŠ¶æ€ */</span>
    <span class="hljs-attr">INITIAL</span>: <span class="hljs-string">'INITIAL'</span>,
    <span class="hljs-comment">/**æ ‡ç­¾å¼€å§‹çŠ¶æ€ */</span>
    <span class="hljs-attr">TAG_OPEN</span>: <span class="hljs-string">'TAG_OPEN'</span>,
    <span class="hljs-comment">/**æ ‡ç­¾åçŠ¶æ€ */</span>
    <span class="hljs-attr">TAG_NAME</span>: <span class="hljs-string">'TAG_NAME'</span>,
    <span class="hljs-comment">/**æ ‡ç­¾ç»“æŸåçŠ¶æ€ */</span>
    <span class="hljs-attr">TAG_CLOSE_NAME</span>: <span class="hljs-string">'TAG_CLOSE_NAME'</span>,
    <span class="hljs-comment">/**æ–‡æœ¬çŠ¶æ€ */</span>
    <span class="hljs-attr">TEXT</span>: <span class="hljs-string">'TEXT'</span>
}

<span class="hljs-comment">/**
 * åˆ¤æ–­æ˜¯å¦æ˜¯å­—æ¯
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isAlpha</span>(<span class="hljs-params">char</span>) {
    <span class="hljs-keyword">return</span> char.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/[a-zA-Z]/</span>)
}
</code></pre>
<h3 data-id="heading-6">å…·ä½“å®ç°-è¯æ³•åˆ†æ</h3>
<blockquote>
<p>ç»è¿‡æ­¤å°èŠ‚ï¼Œæ¨¡æ¿ä»£ç ä¼šä»ä¸€æ®µå­—ç¬¦ï¼Œå˜ä¸ºä¸€ä¸ª tokens æ•°ç»„ã€‚</p>
</blockquote>
<p>ç¼–è¯‘ç¬¬ä¸€æ­¥ï¼Œè¯æ³•åˆ†æï¼Œå°±æ˜¯æŠŠè¿™æºä»£ç æ‹†åˆ†ä¸ºæœ€å°å•å…ƒï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å†™å‡ºè¿™ä¸ªå‡½æ•°çš„å‡½æ•°ç­¾åï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">tokenizes</span>(<span class="hljs-params">str</span>){
    <span class="hljs-keyword">const</span> tokens = []
    
    <span class="hljs-keyword">switch</span> (curState) {       
        <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">INITIAL</span>: <span class="hljs-comment">// åˆå§‹çŠ¶æ€</span>
            <span class="hljs-keyword">break</span>  
        <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_OPEN</span>: <span class="hljs-comment">// æ ‡ç­¾å¼€å§‹çŠ¶æ€</span>
            <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_NAME</span>: <span class="hljs-comment">// æ ‡ç­¾åçŠ¶æ€</span>
            <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TEXT</span>: <span class="hljs-comment">// æ–‡æœ¬çŠ¶æ€</span>
            <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_CLOSE_NAME</span>: <span class="hljs-comment">// æ ‡ç­¾ç»“æŸåçŠ¶æ€</span>
            <span class="hljs-keyword">break</span>
    }
    
    <span class="hljs-keyword">return</span> tokens
} 
</code></pre>
<p>æ ¹æ®å‰æ–‡çš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š</p>
<ol>
<li>æœ€å¼€å§‹çš„çŠ¶æ€ä¸º<code>åˆå§‹çŠ¶æ€</code>ï¼Œ</li>
<li>å¦‚æœæ˜¯åˆå§‹çŠ¶æ€çš„æƒ…å†µä¸‹ï¼Œè‹¥ç¢°åˆ° <code>&lt;</code> å­—ç¬¦åˆ™ä¼šè¡¨ç¤ºä¸ºæ˜¯<code>æ ‡ç­¾å¼€å§‹çŠ¶æ€</code>ï¼Œ</li>
<li>ä¸”è¿™ä¸ªå­—ç¬¦ç»è¿‡åˆ¤å®šä¹‹åï¼Œå°±æ— ç”¨äº†ï¼Œæ‰€ä»¥å°±è¦æŠŠè¿™ä¸ª<strong>å­—ç¬¦åˆ‡é™¤</strong>ï¼Œç„¶åè¿›å…¥ä¸‹ä¸€ä¸ªå­—ç¬¦çš„åˆ¤å®š</li>
<li>é‚£ä¹ˆå¦‚æœä¸æ˜¯ç¢°åˆ° &lt;ï¼Œè€Œæ˜¯ä¸€ä¸ªå­—æ¯å‘¢ï¼Ÿ é‚£ä¹ˆå°±è¡¨ç¤ºè¿›å…¥ä¸€ä¸ªæ–‡æœ¬çŠ¶æ€ã€‚</li>
<li>æ–‡æœ¬çŠ¶æ€ä¸‹å°±æ˜¯æŒç»­çš„æ”¶é›†å­—ç¬¦ï¼Œç­‰å¾… &lt; çš„å‡ºç°ã€‚</li>
</ol>
<p>æ‰€ä»¥ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * å°†æ¨¡æ¿å­—ç¬¦ä¸²è½¬æ¢ä¸º token æ•°ç»„
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">tokenizes</span>(<span class="hljs-params">str</span>) {
    <span class="hljs-keyword">let</span> curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">INITIAL</span> <span class="hljs-comment">// å®šä¹‰åˆå§‹çŠ¶æ€</span>
    
    <span class="hljs-keyword">const</span> tokens = []

    <span class="hljs-keyword">while</span> (str) {
        <span class="hljs-keyword">let</span> char = str[<span class="hljs-number">0</span>] <span class="hljs-comment">// æå–å½“å‰å­—ç¬¦</span>

        <span class="hljs-keyword">switch</span> (curState) {
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">INITIAL</span>:
                <span class="hljs-comment">// å¦‚æœå½“å‰å­—ç¬¦æ˜¯ &lt;ï¼Œåˆ™è¡¨ç¤ºéœ€è¦è¿›å…¥ [æ ‡ç­¾å¼€å§‹çŠ¶æ€]</span>
                <span class="hljs-keyword">if</span> (char === <span class="hljs-string">'&lt;'</span>) {
                    curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_OPEN</span>
                    str = str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
                } 
            		<span class="hljs-comment">// å¦åˆ™è¿›å…¥[æ–‡æœ¬çŠ¶æ€]</span>
            		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isAlpha</span>(char)) {
                    curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">TEXT</span>
                }
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_OPEN</span>:
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_NAME</span>:
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TEXT</span>:
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_CLOSE_NAME</span>:
                <span class="hljs-keyword">break</span>
        }
    }
  
    <span class="hljs-keyword">return</span> tokens
}
</code></pre>
<p>ç»è¿‡è¿™ä¸€æ­¥éª¤ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ä¸€ä¸‹å½“å‰çš„å„é¡¹å€¼ï¼Œå¦‚å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/469ea2969d8943e2972a3c849c4a7686~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJqYw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767146836&amp;x-signature=WWYlFHCCs3WvBU%2FL%2F1jbVyxc%2Bw0%3D" alt="image-20251222223719610.png" loading="lazy"/></p>
<p>é‚£ä¹ˆç»§ç»­è¿›è¡Œä¸‹ä¸€ä¸ªå­—ç¬¦ d çš„è§£è¯»ï¼š</p>
<ol>
<li><code>æ ‡ç­¾å¼€å§‹çŠ¶æ€</code>ä¸‹å¦‚æœé‡åˆ°äº†ä¸€ä¸ª<strong>å­—æ¯</strong>ï¼Œåˆ™ä¼šåˆ‡æ¢åˆ°<code>æ ‡ç­¾åçŠ¶æ€</code>ï¼Œä½†æ˜¯è¿™ä¸€æ­¥åªä¼šåˆ‡æ¢çŠ¶æ€ï¼Œå¹¶ä¸ä¼šåˆ‡é™¤å­—ç¬¦</li>
<li>è€Œæ ‡ç­¾åçŠ¶æ€ä¸‹ï¼Œå¦‚æœé‡åˆ°å­—æ¯åˆ™ä¼šè¿›è¡Œæ”¶é›†</li>
<li>ç›´åˆ°é‡åˆ° <code>&gt;</code> å­—ç¬¦ï¼Œæ‰ä¼šç»“æŸæ ‡ç­¾å¼€å§‹çŠ¶æ€ï¼Œç„¶ååˆå›å½’<code>åˆå§‹çŠ¶æ€</code></li>
<li>ç„¶åè®°å½•æœ¬æ¬¡å¾—åˆ° tokenï¼Œå¹¶æ¸…ç©ºæœ¬æ¬¡å­˜å‚¨å­—ç¬¦çš„å®¹å™¨</li>
</ol>
<p>æ‰€ä»¥ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">tokenizes</span>(<span class="hljs-params">str</span>) {
    <span class="hljs-keyword">let</span> curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">INITIAL</span>

    <span class="hljs-keyword">const</span> tokens = []

    <span class="hljs-comment">// å› ä¸ºè¦æ”¶é›†å­—ç¬¦ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªå˜é‡æ¥å­˜å‚¨å½“å‰æ”¶é›†çš„å­—ç¬¦</span>
    <span class="hljs-keyword">const</span> chars = []

    <span class="hljs-keyword">while</span> (str) {
        <span class="hljs-keyword">let</span> char = str[<span class="hljs-number">0</span>]

        <span class="hljs-keyword">switch</span> (curState) {
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">INITIAL</span>:
                <span class="hljs-keyword">if</span> (char === <span class="hljs-string">'&lt;'</span>) {
                    curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_OPEN</span>
                    str = str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
                }
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_OPEN</span>:
                <span class="hljs-comment">// [æ ‡ç­¾å¼€å§‹çŠ¶æ€]ä¸‹ï¼Œé‡åˆ°å­—æ¯ï¼Œåˆ™è¡¨ç¤ºè¿›å…¥ [æ ‡ç­¾åçŠ¶æ€]</span>
                <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isAlpha</span>(char)) {
                    curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_NAME</span>
                }
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_NAME</span>:
                <span class="hljs-comment">// [æ ‡ç­¾åçŠ¶æ€]ä¸‹ï¼Œé‡åˆ°å­—æ¯åªéœ€è¦å°†å…¶å­˜å…¥ chars ä¸­å³å¯</span>
                <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isAlpha</span>(char)) {
                    chars.<span class="hljs-title function_">push</span>(char)
                    str = str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
                }
                <span class="hljs-comment">// è€Œå¦‚æœé‡åˆ° &gt; å­—ç¬¦ï¼Œåˆ™è¡¨ç¤º[æ ‡ç­¾å¼€å§‹çŠ¶æ€]ç»“æŸï¼Œåˆ™éœ€è¦å›åˆ°[åˆå§‹çŠ¶æ€]</span>
                <span class="hljs-keyword">if</span> (char === <span class="hljs-string">'&gt;'</span>) {
                    curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">INITIAL</span>
                    <span class="hljs-comment">// å°† chars è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶æ·»åŠ åˆ° tokens ä¸­</span>
                    tokens.<span class="hljs-title function_">push</span>({
                        <span class="hljs-attr">type</span>: <span class="hljs-string">'tag_start'</span>,
                        <span class="hljs-attr">name</span>: chars.<span class="hljs-title function_">join</span>(<span class="hljs-string">''</span>)
                    })
                    chars.<span class="hljs-property">length</span> = <span class="hljs-number">0</span> <span class="hljs-comment">// æ¸…ç©º chars</span>
                    str = str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
                }
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TEXT</span>:
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_CLOSE_NAME</span>:
                <span class="hljs-keyword">break</span>
        }
    }
  
    <span class="hljs-keyword">return</span> tokens
} 
</code></pre>
<p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çœ‹ä¸‹è¾“å‡ºæ˜¯å¦ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸï¼Œå¦‚å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9a320555ef549098e0d8c5e94f0ccde~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJqYw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767146836&amp;x-signature=IdwD9U%2FtfqPxqI5WDHzzABl4qhY%3D" alt="image-20251222232528410.png" loading="lazy"/></p>
<p>ç»§ç»­è§£æä¸‹ä¸€ä¸ªå­—ç¬¦ï¼š</p>
<ol>
<li>ç°åœ¨æˆ‘ä»¬åˆå›åˆ°äº†<code>åˆå§‹çŠ¶æ€</code></li>
<li>åˆå§‹çŠ¶æ€å¦‚æœæ²¡æœ‰é‡åˆ° &lt;ï¼Œåˆ™ä¼šè¿›å…¥æ–‡æœ¬çŠ¶æ€</li>
<li>æ–‡æœ¬çŠ¶æ€è¦åšçš„äº‹æƒ…ä¹Ÿå¾ˆç®€å•ï¼Œæ”¶é›†å­—ç¬¦ï¼Œç›´åˆ°é‡åˆ°å­—ç¬¦ &lt;ï¼Œåœæ­¢æ”¶é›†ï¼Œç”Ÿæˆä¸€ä¸ª tokenï¼Œå¹¶è¿›å…¥<code>æ ‡ç­¾å¼€å§‹çŠ¶æ€</code></li>
</ol>
<p>æ‰€ä»¥ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">tokenizes</span>(<span class="hljs-params">str</span>) {
    <span class="hljs-keyword">let</span> curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">INITIAL</span>

    <span class="hljs-keyword">const</span> tokens = []

    <span class="hljs-keyword">const</span> chars = []

    <span class="hljs-keyword">while</span> (str) {
        <span class="hljs-keyword">let</span> char = str[<span class="hljs-number">0</span>]

        <span class="hljs-keyword">switch</span> (curState) {
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">INITIAL</span>:
                <span class="hljs-keyword">if</span> (char === <span class="hljs-string">'&lt;'</span>) {
                    curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_OPEN</span>
                    str = str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isAlpha</span>(char)) {
                    curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">TEXT</span>
                }
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_OPEN</span>:
                <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isAlpha</span>(char)) {
                    curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_NAME</span>
                }
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_NAME</span>:
                <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isAlpha</span>(char)) {
                    chars.<span class="hljs-title function_">push</span>(char)
                    str = str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
                }
                <span class="hljs-keyword">if</span> (char === <span class="hljs-string">'&gt;'</span>) {
                    curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">INITIAL</span>
                    tokens.<span class="hljs-title function_">push</span>({
                        <span class="hljs-attr">type</span>: <span class="hljs-string">'tag_start'</span>,
                        <span class="hljs-attr">name</span>: chars.<span class="hljs-title function_">join</span>(<span class="hljs-string">''</span>)
                    })
                    str = str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
                    chars.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>
                }
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TEXT</span>:
                <span class="hljs-keyword">if</span> (char === <span class="hljs-string">'&lt;'</span>) {
                    <span class="hljs-comment">// åˆ‡æ¢åˆ°æ ‡ç­¾å¼€å§‹çŠ¶æ€</span>
                    curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_OPEN</span>
                    tokens.<span class="hljs-title function_">push</span>({
                        <span class="hljs-attr">type</span>: <span class="hljs-string">'text'</span>,
                        <span class="hljs-attr">name</span>: chars.<span class="hljs-title function_">join</span>(<span class="hljs-string">''</span>)
                    })
                    chars.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>
                    str = str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-comment">// æ”¶é›†æ–‡æœ¬</span>
                    chars.<span class="hljs-title function_">push</span>(char)
                    str = str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
                }
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_CLOSE_NAME</span>:
                <span class="hljs-keyword">break</span>
        }
    }

    <span class="hljs-keyword">return</span> tokens
}
</code></pre>
<p>ç…§ä¾‹ï¼Œæˆ‘ä»¬æ¥é˜…è§ˆä¸€ä¸‹ç»“æœï¼Œå¦‚å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e6a2ac40a574bc299233710007d73d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJqYw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767146836&amp;x-signature=lbQ0hsTNibGtEvpvuxJ22jkUQuo%3D" alt="image-20251223001742973.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç»“æœæ˜¯ç¬¦åˆé¢„æœŸçš„ã€‚ç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ªå­—ç¬¦ï¼š</p>
<ol>
<li>ç°åœ¨çŠ¶æ€æ˜¯<code>å¼€å§‹æ ‡ç­¾çŠ¶æ€</code>ï¼Œè¦å¤„ç†çš„å­—ç¬¦æ˜¯ <code>/</code>ï¼Œè¿™ä¸ªå­—ç¬¦åˆ™ä¼šè¿›å…¥<code>æ ‡ç­¾ç»“æŸåçŠ¶æ€</code></li>
<li>è¿™ç§çŠ¶æ€ä¹Ÿå’Œä¹‹å‰çš„åˆ«æ— äºŒè‡´ï¼Œæ”¶é›†å­—æ¯ï¼Œç›´åˆ°é‡åˆ° &gt;ï¼Œåˆ‡æ¢åˆ°<code>åˆå§‹çŠ¶æ€</code></li>
</ol>
<p>å› æ­¤ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">tokenizes</span>(<span class="hljs-params">str</span>) {
    <span class="hljs-keyword">let</span> curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">INITIAL</span>

    <span class="hljs-keyword">const</span> tokens = []

    <span class="hljs-keyword">const</span> chars = []

    <span class="hljs-keyword">while</span> (str) {
        <span class="hljs-keyword">let</span> char = str[<span class="hljs-number">0</span>]

        <span class="hljs-keyword">switch</span> (curState) {
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">INITIAL</span>:
                <span class="hljs-keyword">if</span> (char === <span class="hljs-string">'&lt;'</span>) {
                    curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_OPEN</span>
                    str = str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isAlpha</span>(char)) {
                    curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">TEXT</span>
                }
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_OPEN</span>:
                <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isAlpha</span>(char)) {
                    curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_NAME</span>
                }
                <span class="hljs-comment">// è¿›è¡Œæ¡ä»¶è¡¥å……</span>
                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (char === <span class="hljs-string">'/'</span>) {
                    curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_CLOSE_NAME</span>
                    str = str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
                }
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_NAME</span>:
                <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isAlpha</span>(char)) {
                    chars.<span class="hljs-title function_">push</span>(char)
                    str = str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
                }
                <span class="hljs-keyword">if</span> (char === <span class="hljs-string">'&gt;'</span>) {
                    curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">INITIAL</span>
                    tokens.<span class="hljs-title function_">push</span>({
                        <span class="hljs-attr">type</span>: <span class="hljs-string">'tag_start'</span>,
                        <span class="hljs-attr">name</span>: chars.<span class="hljs-title function_">join</span>(<span class="hljs-string">''</span>)
                    })
                    str = str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
                    chars.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>
                }
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TEXT</span>:
                <span class="hljs-keyword">if</span> (char === <span class="hljs-string">'&lt;'</span>) {
                    curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_OPEN</span>
                    tokens.<span class="hljs-title function_">push</span>({
                        <span class="hljs-attr">type</span>: <span class="hljs-string">'text'</span>,
                        <span class="hljs-attr">name</span>: chars.<span class="hljs-title function_">join</span>(<span class="hljs-string">''</span>)
                    })
                    chars.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>
                    str = str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
                } <span class="hljs-keyword">else</span> {
                    chars.<span class="hljs-title function_">push</span>(char)
                    str = str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
                }
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Status</span>.<span class="hljs-property">TAG_CLOSE_NAME</span>:
                <span class="hljs-comment">// å¦‚æœæ˜¯å­—æ¯ï¼Œåˆ™æ”¶é›†</span>
                <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isAlpha</span>(char)) {
                    chars.<span class="hljs-title function_">push</span>(char)
                    str = str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
                }
                <span class="hljs-comment">// å¦‚æœæ˜¯ &gt;ï¼Œåˆ™ç»“æŸæ ‡ç­¾ç»“æŸåçŠ¶æ€</span>
                <span class="hljs-keyword">if</span> (char === <span class="hljs-string">'&gt;'</span>) {
                    curState = <span class="hljs-title class_">Status</span>.<span class="hljs-property">INITIAL</span>
                    tokens.<span class="hljs-title function_">push</span>({
                        <span class="hljs-attr">type</span>: <span class="hljs-string">'tag_end'</span>,
                        <span class="hljs-attr">name</span>: chars.<span class="hljs-title function_">join</span>(<span class="hljs-string">''</span>)
                    })
                    str = str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)
                    chars.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>
                }
                <span class="hljs-keyword">break</span>
        }
    }

    <span class="hljs-keyword">return</span> tokens
}
</code></pre>
<p>ç°åœ¨æŒ‰ç…§é¢„æœŸæ¥è¯´ï¼Œå·²ç»å¯ä»¥å¾—åˆ°ä¸€æ•´ä¸ª toknes äº†ï¼Œç»“æœå¦‚å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/771f4938b41a420ebe778220625bc0c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJqYw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767146836&amp;x-signature=Hb4qwPM1x4cf0yf976psYLE1BeY%3D" alt="image-20251223002814486.png" loading="lazy"/></p>
<p>okï¼Œè‡³æ­¤ï¼Œè¯æ³•åˆ†æå°±å‘Šä¸€æ®µè½äº†ï¼Œå½“ç„¶ï¼Œæœ¬æ–‡çš„å®ç°ä»…ä»…æ˜¯æœ€å°å®ç°ï¼Œä¹Ÿä¸è§„èŒƒï¼Œæœ‰å…´è¶£è‡ªå·±æ·±åº¦å®ç°ä¸€ä¸‹çš„ï¼Œå¯ä»¥è‡ªè¡Œå®Œå–„ã€‚</p>
<h3 data-id="heading-7">å…·ä½“å®ç°-æ„é€  AST</h3>
<blockquote>
<p>ç»è¿‡è¯æ³•åˆ†æï¼Œåªæ˜¯å¾—åˆ°äº†æœ€å°å•å…ƒï¼Œä½†æ˜¯è¿™ä¸ªæœ€å°å•å…ƒï¼Œè·ç¦» ast è¿˜æœ‰ä¸€æ®µè·¯è¦èµ°ï¼Œè¿™å°±æ˜¯æœ¬å°èŠ‚çš„ä»»åŠ¡ã€‚</p>
</blockquote>
<p>å›é¡¾ä¸€ä¸‹ï¼Œç»è¿‡è¯æ³•åˆ†æåï¼Œæˆ‘ä»¬å¾—åˆ°äº†è¿™æ ·ä¸€ä¸ª tokens æ•°ç»„ï¼š</p>
<pre><code class="hljs language-js" lang="js">[
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'tag_start'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'div'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'text'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Vue'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'tag_end'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'div'</span> }
]
</code></pre>
<p>è€Œæˆ‘ä»¬æœŸæœ›å¾—åˆ°çš„ AST ç»“æ„åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-js" lang="js">{
  <span class="hljs-attr">type</span>: <span class="hljs-string">'Root'</span>,
  <span class="hljs-attr">children</span>: [
    {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'Element'</span>,
      <span class="hljs-attr">tag</span>: <span class="hljs-string">'div'</span>,
      <span class="hljs-attr">children</span>: [
        {
          <span class="hljs-attr">type</span>: <span class="hljs-string">'Text'</span>,
          <span class="hljs-attr">content</span>: <span class="hljs-string">'Vue'</span>
        }
      ]
    }
  ]
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒAST æ˜¯ä¸€ä¸ª<strong>æ ‘å½¢ç»“æ„</strong>ï¼Œè€Œ tokens æ˜¯ä¸€ä¸ª<strong>æ‰å¹³çš„æ•°ç»„</strong>ã€‚é‚£ä¹ˆå¦‚ä½•å°†æ‰å¹³çš„æ•°ç»„è½¬æ¢ä¸ºæ ‘å½¢ç»“æ„å‘¢ï¼Ÿ</p>
<p>å®ç°çš„æ‰‹æ®µä¸åšé™åˆ¶ï¼Œæœ¬æ–‡é‡‡ç”¨çš„æ–¹æ¡ˆæ˜¯â€”â€”<strong>æ ˆï¼ˆStackï¼‰</strong>ã€‚</p>
<p>è®©æˆ‘ä»¬æ€è€ƒä¸€ä¸‹è§£æè¿‡ç¨‹ï¼š</p>
<ol>
<li>é‡åˆ° <code>tag_start</code>ï¼ˆå¼€å§‹æ ‡ç­¾ï¼‰ï¼Œåˆ›å»ºä¸€ä¸ªå…ƒç´ èŠ‚ç‚¹ï¼Œç„¶åå°†å…¶<strong>å‹å…¥æ ˆä¸­</strong></li>
<li>é‡åˆ° <code>text</code>ï¼ˆæ–‡æœ¬ï¼‰ï¼Œåˆ›å»ºä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹ï¼Œå°†å…¶æ·»åŠ åˆ°<strong>æ ˆé¡¶å…ƒç´ </strong>çš„ <code>children</code> ä¸­</li>
<li>é‡åˆ° <code>tag_end</code>ï¼ˆç»“æŸæ ‡ç­¾ï¼‰ï¼Œå°†æ ˆé¡¶å…ƒç´ <strong>å¼¹å‡º</strong></li>
</ol>
<p>è€Œå› ä¸º<strong>æ ˆé¡¶å…ƒç´ </strong>å§‹ç»ˆæ˜¯"å½“å‰æ­£åœ¨å¤„ç†çš„çˆ¶å…ƒç´ "ã€‚å½“æˆ‘ä»¬é‡åˆ°æ–°çš„å­èŠ‚ç‚¹æ—¶ï¼Œåªéœ€è¦å°†å…¶æ·»åŠ åˆ°æ ˆé¡¶å…ƒç´ çš„ <code>children</code> ä¸­å³å¯ã€‚</p>
<p>è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥æ¼”ç¤ºè¿™ä¸ªè¿‡ç¨‹ï¼Œå‡è®¾æˆ‘ä»¬è¦è§£æ <code>&lt;div&gt;&lt;p&gt;Hello&lt;/p&gt;&lt;/div&gt;</code>ï¼š</p>
<pre><code class="hljs language-css" lang="css">tokens: [
  { type: <span class="hljs-string">'tag_start'</span>, name: <span class="hljs-string">'div'</span> },
  { type: <span class="hljs-string">'tag_start'</span>, name: <span class="hljs-string">'p'</span> },
  { type: <span class="hljs-string">'text'</span>, name: <span class="hljs-string">'Hello'</span> },
  { type: <span class="hljs-string">'tag_end'</span>, name: <span class="hljs-string">'p'</span> },
  { type: <span class="hljs-string">'tag_end'</span>, name: <span class="hljs-string">'div'</span> }
]

æ­¥éª¤æ¼”ç¤ºï¼š

<span class="hljs-number">1</span>. é‡åˆ° &lt;<span class="hljs-selector-tag">div</span>&gt;  â†’ åˆ›å»º <span class="hljs-selector-tag">div</span> èŠ‚ç‚¹ï¼Œå‹å…¥æ ˆ â†’ æ ˆ: [Root, div]
<span class="hljs-number">2</span>. é‡åˆ° &lt;p&gt;    â†’ åˆ›å»º p èŠ‚ç‚¹ï¼Œæ·»åŠ åˆ° div.childrenï¼Œå‹å…¥æ ˆ â†’ æ ˆ: [Root, div, p]
<span class="hljs-number">3</span>. é‡åˆ° Hello  â†’ åˆ›å»ºæ–‡æœ¬èŠ‚ç‚¹ï¼Œæ·»åŠ åˆ° p.children â†’ æ ˆ: [Root, div, p]
<span class="hljs-number">4</span>. é‡åˆ° &lt;/p&gt;   â†’ å¼¹å‡ºæ ˆé¡¶ p â†’ æ ˆ: [Root, div]
<span class="hljs-number">5</span>. é‡åˆ° &lt;/div&gt; â†’ å¼¹å‡ºæ ˆé¡¶ div â†’ æ ˆ: [Root]

æœ€ç»ˆ Root.children å°±æ˜¯å®Œæ•´çš„ AST
</code></pre>
<p>å½“ç„¶ï¼Œæ–‡æœ¬çš„åˆ†æå¦‚æœä¸å¤Ÿæ˜ç¡®ï¼Œå°±è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä»£ç ï¼Œè®©æˆ‘ä»¬å¼€å§‹ç¼–å†™ä»£ç ã€‚é¦–å…ˆå®šä¹‰å‡½æ•°ç­¾åï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * å°† tokens è½¬æ¢ä¸º AST
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">parse</span>(<span class="hljs-params">tokens</span>) {
    <span class="hljs-comment">// åˆ›å»ºæ ¹èŠ‚ç‚¹</span>
    <span class="hljs-keyword">const</span> root = {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'Root'</span>,
        <span class="hljs-attr">children</span>: []
    }

    <span class="hljs-keyword">return</span> root
}
</code></pre>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ ˆæ¥ç»´æŠ¤çˆ¶å­å…³ç³»ã€‚<strong>å°†æ ¹èŠ‚ç‚¹ä½œä¸ºæ ˆçš„åˆå§‹å…ƒç´ </strong>ï¼Œè¿™æ ·å°±ä¸éœ€è¦é¢å¤–åˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©ºäº†ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">parse</span>(<span class="hljs-params">tokens</span>) {
    <span class="hljs-keyword">const</span> root = {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'Root'</span>,
        <span class="hljs-attr">children</span>: []
    }

    <span class="hljs-comment">// ä½¿ç”¨æ ˆæ¥ç»´æŠ¤çˆ¶å­å…³ç³»ï¼Œåˆå§‹æ—¶æ ¹èŠ‚ç‚¹å…¥æ ˆ</span>
    <span class="hljs-keyword">const</span> stack = [root]

    <span class="hljs-keyword">return</span> root
}
</code></pre>
<p>ç„¶åï¼Œæˆ‘ä»¬éå† tokensï¼Œæ ¹æ®ä¸åŒçš„ç±»å‹è¿›è¡Œå¤„ç†ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">parse</span>(<span class="hljs-params">tokens</span>) {
    <span class="hljs-keyword">const</span> root = {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'Root'</span>,
        <span class="hljs-attr">children</span>: []
    }

    <span class="hljs-keyword">const</span> stack = [root]

    <span class="hljs-keyword">while</span> (tokens.<span class="hljs-property">length</span>) {
        <span class="hljs-comment">// å–å‡ºå½“å‰æ ˆé¡¶å…ƒç´ ä½œä¸ºçˆ¶èŠ‚ç‚¹</span>
        <span class="hljs-keyword">const</span> parent = stack[stack.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]
        <span class="hljs-comment">// å–å‡ºå½“å‰è¦å¤„ç†çš„ token</span>
        <span class="hljs-keyword">const</span> token = tokens[<span class="hljs-number">0</span>]

        <span class="hljs-keyword">switch</span> (token.<span class="hljs-property">type</span>) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'tag_start'</span>:
                <span class="hljs-comment">// é‡åˆ°å¼€å§‹æ ‡ç­¾ï¼Œåˆ›å»ºå…ƒç´ èŠ‚ç‚¹</span>
                <span class="hljs-keyword">const</span> elementNode = {
                    <span class="hljs-attr">type</span>: <span class="hljs-string">'Element'</span>,
                    <span class="hljs-attr">tag</span>: token.<span class="hljs-property">name</span>,
                    <span class="hljs-attr">children</span>: []
                }
                <span class="hljs-comment">// å°†å…ƒç´ èŠ‚ç‚¹æ·»åŠ åˆ°çˆ¶èŠ‚ç‚¹çš„ children ä¸­</span>
                parent.<span class="hljs-property">children</span>.<span class="hljs-title function_">push</span>(elementNode)
                <span class="hljs-comment">// å°†å…ƒç´ èŠ‚ç‚¹å‹å…¥æ ˆä¸­ï¼Œä½œä¸ºåç»­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹</span>
                stack.<span class="hljs-title function_">push</span>(elementNode)
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-string">'text'</span>:
                <span class="hljs-comment">// é‡åˆ°æ–‡æœ¬ï¼Œåˆ›å»ºæ–‡æœ¬èŠ‚ç‚¹</span>
                <span class="hljs-keyword">const</span> textNode = {
                    <span class="hljs-attr">type</span>: <span class="hljs-string">'Text'</span>,
                    <span class="hljs-attr">content</span>: token.<span class="hljs-property">name</span>
                }
                <span class="hljs-comment">// å°†æ–‡æœ¬èŠ‚ç‚¹æ·»åŠ åˆ°çˆ¶èŠ‚ç‚¹çš„ children ä¸­</span>
                parent.<span class="hljs-property">children</span>.<span class="hljs-title function_">push</span>(textNode)
                <span class="hljs-keyword">break</span>
            <span class="hljs-keyword">case</span> <span class="hljs-string">'tag_end'</span>:
                <span class="hljs-comment">// é‡åˆ°ç»“æŸæ ‡ç­¾ï¼Œå°†æ ˆé¡¶å…ƒç´ å¼¹å‡º</span>
                stack.<span class="hljs-title function_">pop</span>()
                <span class="hljs-keyword">break</span>
        }

        <span class="hljs-comment">// å¤„ç†å®Œå½“å‰ token åï¼Œå°†å…¶ç§»é™¤</span>
        tokens.<span class="hljs-title function_">shift</span>()
    }

    <span class="hljs-keyword">return</span> root
}
</code></pre>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹å®Œæ•´çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> template = <span class="hljs-string">`&lt;div&gt;Vue&lt;/div&gt;`</span>

<span class="hljs-comment">// å…ˆè¿›è¡Œè¯æ³•åˆ†æ</span>
<span class="hljs-keyword">const</span> tokens = <span class="hljs-title function_">tokenizes</span>(template)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'tokens:'</span>, tokens)

<span class="hljs-comment">// å†æ„é€  AST</span>
<span class="hljs-keyword">const</span> ast = <span class="hljs-title function_">parse</span>(tokens)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ast:'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(ast, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>))
</code></pre>
<p>è¿è¡Œåï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">tokens</span>: [
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'tag_start'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'div'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'text'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Vue'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'tag_end'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'div'</span> }
]

<span class="hljs-attr">ast</span>: {
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"Root"</span>,
  <span class="hljs-string">"children"</span>: [
    {
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"Element"</span>,
      <span class="hljs-string">"tag"</span>: <span class="hljs-string">"div"</span>,
      <span class="hljs-string">"children"</span>: [
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"Text"</span>,
          <span class="hljs-string">"content"</span>: <span class="hljs-string">"Vue"</span>
        }
      ]
    }
  ]
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æˆåŠŸåœ°å°† tokens è½¬æ¢ä¸ºäº† ASTã€‚å®ƒè¡¨è¾¾äº†æ¨¡æ¿çš„ç»“æ„ï¼šæ ¹èŠ‚ç‚¹ä¸‹æœ‰ä¸€ä¸ª <code>div</code> å…ƒç´ ï¼Œ<code>div</code> å…ƒç´ ä¸‹æœ‰ä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹ <code>Vue</code>ã€‚</p>
<p>æˆ‘ä»¬è¿˜å¯ä»¥æŠŠå‰æ–‡æåˆ°çš„ç¨å¾®å¤æ‚ä¸€äº›çš„ä¾‹å­ï¼Œæ¥è¿›è¡ŒéªŒè¯ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> template2 = <span class="hljs-string">`&lt;div&gt;&lt;p&gt;Hello&lt;/p&gt;&lt;/div&gt;`</span>
<span class="hljs-keyword">const</span> tokens2 = <span class="hljs-title function_">tokenizes</span>(template2)
<span class="hljs-keyword">const</span> ast2 = <span class="hljs-title function_">parse</span>(tokens2)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ast2:'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(ast2, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>))
</code></pre>
<p>è¾“å‡ºç»“æœï¼š</p>
<pre><code class="hljs language-js" lang="js">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"Root"</span>,
  <span class="hljs-string">"children"</span>: [
    {
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"Element"</span>,
      <span class="hljs-string">"tag"</span>: <span class="hljs-string">"div"</span>,
      <span class="hljs-string">"children"</span>: [
        {
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"Element"</span>,
          <span class="hljs-string">"tag"</span>: <span class="hljs-string">"p"</span>,
          <span class="hljs-string">"children"</span>: [
            {
              <span class="hljs-string">"type"</span>: <span class="hljs-string">"Text"</span>,
              <span class="hljs-string">"content"</span>: <span class="hljs-string">"Hello"</span>
            }
          ]
        }
      ]
    }
  ]
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œä¹Ÿæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚</p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†ä»<strong>æ¨¡æ¿å­—ç¬¦ä¸²</strong>åˆ° <strong>AST</strong> çš„è½¬æ¢è¿‡ç¨‹ã€‚æ•´ä¸ªè¿‡ç¨‹å¯ä»¥æ€»ç»“ä¸ºï¼š</p>
<ol>
<li><strong>è¯æ³•åˆ†æ</strong>ï¼šå°†æ¨¡æ¿å­—ç¬¦ä¸²æ‹†åˆ†ä¸º tokens æ•°ç»„</li>
<li><strong>è¯­æ³•åˆ†æ</strong>ï¼šåˆ©ç”¨æ ˆç»“æ„ï¼Œå°† tokens æ•°ç»„è½¬æ¢ä¸ºæ ‘å½¢çš„ AST</li>
</ol>
<p>å½“ç„¶ï¼Œè¿™åªæ˜¯ä¸€ä¸ªæœ€ç®€å®ç°ï¼ŒçœŸæ­£çš„ Vue ç¼–è¯‘å™¨è¿˜éœ€è¦å¤„ç†æ›´å¤šçš„æƒ…å†µï¼Œæ¯”å¦‚ï¼šå±æ€§è§£æã€æŒ‡ä»¤å¤„ç†ã€æ’å€¼è¡¨è¾¾å¼ã€è‡ªé—­åˆæ ‡ç­¾ç­‰ç­‰ã€‚ä½†æ ¸å¿ƒæ€æƒ³æ˜¯ä¸€è‡´çš„ï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥è‡ªè¡Œæ‰©å±•ã€‚</p>
<h2 data-id="heading-8">è½¬æ¢å™¨ï¼šTemplate AST --&gt; JS AST</h2>
<blockquote>
<p>ä¸ºä»€ä¹ˆéœ€è¦ ast è½¬ ast å‘¢ï¼Ÿå› ä¸ºæ¸²æŸ“å‡½æ•°æ˜¯ç”± js ä»£ç æ¥æè¿°çš„ï¼Œæ‰€ä»¥éœ€è¦è½¬æ¢ã€‚</p>
</blockquote>
<h3 data-id="heading-9">å…·ä½“å®ç°-å‰ç½®å‡†å¤‡</h3>
<p>æ—¢ç„¶æ˜¯è½¬åŒ–ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦åšåˆ°çš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯èƒ½å¤Ÿå¯¹<strong>æ¯ä¸€ä¸ªèŠ‚ç‚¹</strong>éƒ½è¿›è¡Œè®¿é—®ï¼Œç„¶åæ‰èƒ½å¯¹æ¯ä¸ªèŠ‚ç‚¹è¿›è¡Œè½¬æ¢ã€‚è¿™é‡Œæˆ‘ä»¬å€Ÿé‰´æ–‡ç« å¼€å¤´ä¹¦ä¸­çš„ç¤ºä¾‹ï¼Œåœ¨ç¼–å†™è¿™ä¸ªè½¬æ¢å™¨ä¹‹å‰ï¼Œå®ç°ä¸€ä¸ªæ‰“å°çš„æ–¹æ³•ï¼Œæ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œè§‚æµ‹ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> templateAST = <span class="hljs-title function_">parse</span>(template)

<span class="hljs-keyword">function</span> <span class="hljs-title function_">dump</span>(<span class="hljs-params">node, indent = <span class="hljs-number">0</span></span>) {
    <span class="hljs-keyword">const</span> hyphens = <span class="hljs-string">'-'</span>.<span class="hljs-title function_">repeat</span>(indent)
    <span class="hljs-keyword">const</span> tag = node.<span class="hljs-property">tag</span> || node.<span class="hljs-property">content</span> || <span class="hljs-string">''</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(hyphens + node.<span class="hljs-property">type</span> + <span class="hljs-string">': '</span> + tag)

    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">children</span> &amp;&amp; node.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>) {
        node.<span class="hljs-property">children</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> <span class="hljs-title function_">dump</span>(child, indent + <span class="hljs-number">2</span>))
    }
}

<span class="hljs-title function_">dump</span>(templateAST)
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ä¸€ä¸‹è¾“å‡ºï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">Root:</span>
<span class="hljs-section">--Element: div</span>
<span class="hljs-section">----Element: p</span>
<span class="hljs-section">------Text: Vue</span>
</code></pre>
<p>æœ‰äº†è¿™ä¸ªè¾…åŠ©å‡½æ•°ä¹‹åï¼Œå°±å¯ä»¥æ¯”è¾ƒæ¸…æ™°çš„çœ‹åˆ°è¿™äº› ast çš„èŠ‚ç‚¹äº†ã€‚</p>
<h3 data-id="heading-10">å…·ä½“å®ç°-èŠ‚ç‚¹éå†</h3>
<p>ç°åœ¨æˆ‘ä»¬éœ€è¦çš„å°±æ˜¯ä¸€ä¸ªå¯ä»¥å¯¹ ast æ¯ä¸ªèŠ‚ç‚¹è¿›è¡Œéå†çš„å‡½æ•°ï¼Œå¹¶å®ç°ä¸€ä¸ªåŠŸèƒ½ï¼Œå°† p æ ‡ç­¾æ›¿æ¢ä¸º h1 æ ‡ç­¾ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">traverseNode</span>(<span class="hljs-params">node</span>) {
    <span class="hljs-keyword">const</span> currentNode = node

    <span class="hljs-keyword">if</span> (currentNode.<span class="hljs-property">type</span> === <span class="hljs-string">'Element'</span> &amp;&amp; currentNode.<span class="hljs-property">tag</span> === <span class="hljs-string">'p'</span>) {
        currentNode.<span class="hljs-property">tag</span> = <span class="hljs-string">'h1'</span>
    }

    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">children</span> &amp;&amp; node.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; node.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>; i++) {
            <span class="hljs-keyword">const</span> child = node.<span class="hljs-property">children</span>[i]
            <span class="hljs-title function_">traverseNode</span>(child)
        }
    }
}

<span class="hljs-keyword">const</span> templateAST = <span class="hljs-title function_">parse</span>(template)

<span class="hljs-title function_">traverseNode</span>(templateAST)

<span class="hljs-title function_">dump</span>(templateAST)
</code></pre>
<p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">Root: </span>
<span class="hljs-section">--Element: div</span>
<span class="hljs-section">----Element: h1</span>
<span class="hljs-section">------Text: Vue</span>
</code></pre>
<h3 data-id="heading-11">å…·ä½“å®ç°-èŠ‚ç‚¹è½¬æ¢</h3>
<p>å½“ç„¶ï¼ŒçœŸå®çš„è½¬æ¢è¿‡ç¨‹å¯èƒ½ä¸èƒ½å’Œæˆ‘ä»¬è¿™æ ·ä¸€æ ·çš„ç²—æš´ä¸”ä¸è®²é“ç†ï¼Œè¿™æ ·éšç€åç»­çš„è½¬æ¢é€»è¾‘å¢åŠ ï¼Œå¿…ç„¶å¯¼è‡´æˆ‘ä»¬å†™å‡ºçš„ä»£ç æˆä¸ºä¸€åº§â€œå±å±±â€ã€‚è€Œè¿™ç§åˆ¤æ–­å¯ä»¥é¢„è§ï¼Œæ˜¯å¤šç§å¤šæ ·çš„ï¼Œæ¯”å¦‚å¤„ç†æ ‡ç­¾ã€å¤„ç†æ–‡æœ¬ã€å¤„ç†å±æ€§...ç­‰ç­‰ã€‚æ‰€ä»¥è¿™ä¸ªå¤–éƒ¨ä¼ å…¥å¤„ç†å™¨åº”è¯¥æ˜¯å¤šä¸ªçš„ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">traverseNode</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">const</span> currentNode = node

    <span class="hljs-comment">// éå†æ‰€æœ‰è½¬æ¢å‡½æ•°</span>
    <span class="hljs-keyword">const</span> { nodeTransforms } = context
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; nodeTransforms.<span class="hljs-property">length</span>; i++) {
        nodeTransforms[i](currentNode, context)
    }

    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">children</span> &amp;&amp; node.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; node.<span class="hljs-property">children</span>.<span class="hljs-property">length</span>; i++) {
            <span class="hljs-keyword">const</span> child = node.<span class="hljs-property">children</span>[i]
            <span class="hljs-title function_">traverseNode</span>(child, context)
        }
    }
}
<span class="hljs-comment">/**
 * å¤„ç†æ–‡æœ¬èŠ‚ç‚¹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">transformText</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> !== <span class="hljs-string">'Text'</span>) {
        <span class="hljs-keyword">return</span>
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'-- å¤„ç†æ–‡æœ¬èŠ‚ç‚¹ --'</span>)
}

<span class="hljs-comment">/**
 * å¤„ç†å…ƒç´ èŠ‚ç‚¹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">transformElement</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> !== <span class="hljs-string">'Element'</span>) {
        <span class="hljs-keyword">return</span>
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'-- å¤„ç†å…ƒç´ èŠ‚ç‚¹ --'</span>)
}

<span class="hljs-keyword">const</span> nodeTransforms = [transformText, transformElement]

<span class="hljs-keyword">const</span> context = {
    <span class="hljs-attr">nodeTransforms</span>: [transformText, transformElement]
}

<span class="hljs-title function_">traverseNode</span>(templateAST, context)
</code></pre>
<p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-diff" lang="diff"><span class="hljs-deletion">-- å¤„ç†å…ƒç´ èŠ‚ç‚¹ --</span>
<span class="hljs-deletion">-- å¤„ç†å…ƒç´ èŠ‚ç‚¹ --</span>
<span class="hljs-deletion">-- å¤„ç†æ–‡æœ¬èŠ‚ç‚¹ --</span>
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå‡½æ•°çš„è§¦å‘éƒ½æ˜¯ç¬¦åˆé¢„æœŸçš„ï¼Œä¹ŸåŒæ—¶è§£å†³äº†ä¹‹å‰ä»£ç ä¼šåº”ä¸ºè‡ƒè‚¿å˜å¾—"å±å±±"çš„é—®é¢˜ã€‚</p>
<p>è€Œè§‚çœ‹ä»£ç ä»£ç ï¼Œæˆ‘ä»¬ä¸éš¾çœ‹å‡ºä¸€äº›ç–‘æƒ‘ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆä¼šå¤šåˆ›å»ºä¸€ä¸ª context çš„å­˜åœ¨å‘¢ï¼Ÿè€Œä¸æ˜¯ç›´æ¥ä¼ é€’ä¸€ä¸ª nodeTransforms ä½œä¸ºå‚æ•°ï¼Œè¿™æ ·ä¸æ˜¯æ›´ç®€å•å—ï¼Ÿ</p>
<h3 data-id="heading-12">å…·ä½“å®ç°-context</h3>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œ<strong>context å°±æ˜¯ä¸€ä¸ª"ä¿¡æ¯ä¸­è½¬ç«™"</strong>ï¼Œä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆæ—…è¡Œæ—¶çš„èƒŒåŒ…â€”â€”é’±åŒ…ã€æ‰‹æœºã€å……ç”µå™¨è¿™äº›é›¶æ•£çš„ä¸œè¥¿ç»Ÿä¸€è£…åœ¨ä¸€èµ·ï¼Œè€Œä¸æ˜¯æ¯æ ·éƒ½æ‹¿åœ¨æ‰‹ä¸Šã€‚</p>
<p>ç°åœ¨ context é‡Œåªè£…äº† <code>nodeTransforms</code>ï¼Œä½†éšç€ç¼–è¯‘è¿‡ç¨‹å˜å¤æ‚ï¼Œæˆ‘ä»¬è¿˜ä¼šéœ€è¦å¡æ›´å¤šä¸œè¥¿è¿›å»ï¼Œæ¯”å¦‚ï¼šå½“å‰èŠ‚ç‚¹ä¿¡æ¯ã€çˆ¶èŠ‚ç‚¹å¼•ç”¨ã€éœ€è¦å¯¼å…¥çš„è¾…åŠ©å‡½æ•°ã€ç¼–è¯‘é€‰é¡¹ç­‰ç­‰ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆä¸ç›´æ¥ä¼ å‚æ•°ï¼Ÿ</strong> ä¸»è¦æœ‰ä¸‰ä¸ªåŸå› ï¼š</p>
<ol>
<li><strong>å‚æ•°ä¼šçˆ†ç‚¸</strong>ï¼šå‡å¦‚æœ‰ 7ã€8 ä¸ªå‚æ•°ï¼Œæ¯æ¬¡è°ƒç”¨å‡½æ•°éƒ½è¦ä¼ ä¸€é•¿ä¸²ï¼Œè€Œä¸”é¡ºåºè¿˜ä¸èƒ½é”™ï¼Œä»¥ååŠ æ–°å‚æ•°æ›´æ˜¯ä¸€ç§ç¾éš¾</li>
<li><strong>æ•°æ®å…±äº«æ–¹ä¾¿</strong>ï¼šæ¯ä¸ªè½¬æ¢å‡½æ•°éƒ½èƒ½ä» context é‡Œå–æ•°æ®ã€å­˜æ•°æ®ï¼Œæ“ä½œæ•°æ®</li>
<li><strong>æ‰©å±•æ€§å¼º</strong>ï¼šå¦‚æœéœ€è¦å¢åŠ ä¸€äº›æ–°åŠŸèƒ½ï¼Œåªéœ€åœ¨ context é‡ŒåŠ ä¸ªå­—æ®µï¼Œä¸ç”¨æ”¹ä»»ä½•å‡½æ•°ç­¾å</li>
</ol>
<p>è€Œå¦‚æœä½ ç»å¸¸ä½¿ç”¨ Vueï¼Œé‚£ä¹ˆå…³äºå…¶ä¸­ provide/inject ä¸¤ä¸ª api ä¸€å®šä¸é™Œç”Ÿï¼Œå®ƒä»¬å°±æ˜¯ä¸€ç§ context çš„ä½“ç°ã€‚è¿™ç§ä¾‹å­åœ¨å¼€å‘çš„é¢†åŸŸä¸­è¿˜æœ‰å¾ˆå¤šï¼Œå°±ä¸è¿›è¡Œåˆ—ä¸¾äº†ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬æŠŠè§†çº¿è½¬å›åˆ° <code>context.nodeTransforms</code> æœ¬èº«ï¼Œæˆ‘ä»¬ç°åœ¨çŸ¥é“ context æ˜¯ç”¨æ¥å…±äº«æ•°æ®çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦é‚£äº›æ•°æ®å‘¢ï¼Ÿ</p>
<h4 data-id="heading-13">ç¬¬ä¸€æ­¥ï¼šåŸºç¡€æ•°æ® - nodeTransforms</h4>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†æœ€åŸºæœ¬çš„æ•°æ®ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> context = {
    <span class="hljs-attr">nodeTransforms</span>: [transformText, transformElement]
}
</code></pre>
<p>è¿™ä¸ª <code>nodeTransforms</code> æ•°ç»„å­˜å‚¨äº†æ‰€æœ‰çš„èŠ‚ç‚¹è½¬æ¢å‡½æ•°ï¼Œæ˜¯è½¬æ¢ AST çš„æ ¸å¿ƒã€‚ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬çœŸæ­£å¼€å§‹å¤„ç†èŠ‚ç‚¹æ—¶ï¼Œå°±ä¼šå‘ç°ä»…ä»…æœ‰è¿™ä¸ªæ˜¯ä¸å¤Ÿçš„ã€‚</p>
<h4 data-id="heading-14">ç¬¬äºŒæ­¥ï¼šèŠ‚ç‚¹åˆ é™¤çš„éœ€æ±‚</h4>
<p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªå®é™…åœºæ™¯ï¼šå‡è®¾æˆ‘ä»¬æƒ³è¦åˆ é™¤æ‰€æœ‰çš„æ³¨é‡ŠèŠ‚ç‚¹ã€‚ä»£ç å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">transformRemoveComment</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> === <span class="hljs-string">'Comment'</span>) {
        <span class="hljs-comment">// é—®é¢˜æ¥äº†ï¼šæˆ‘ä»¬æ€ä¹ˆåˆ é™¤è¿™ä¸ªèŠ‚ç‚¹ï¼Ÿ</span>
        <span class="hljs-comment">// åˆ é™¤èŠ‚ç‚¹éœ€è¦çŸ¥é“ï¼š</span>
        <span class="hljs-comment">// 1. çˆ¶èŠ‚ç‚¹æ˜¯è°</span>
        <span class="hljs-comment">// 2. å½“å‰èŠ‚ç‚¹åœ¨çˆ¶èŠ‚ç‚¹ children ä¸­çš„ç´¢å¼•</span>
    }
}
</code></pre>
<p>è¦åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦è®¿é—®å®ƒçš„çˆ¶èŠ‚ç‚¹ï¼Œç„¶åä»çˆ¶èŠ‚ç‚¹çš„ children æ•°ç»„ä¸­ç§»é™¤å®ƒã€‚ä½†ç°åœ¨æˆ‘ä»¬çš„ <code>traverseNode</code> å‡½æ•°å¹¶æ²¡æœ‰ä¼ é€’çˆ¶èŠ‚ç‚¹çš„ä¿¡æ¯ï¼Œè½¬æ¢å‡½æ•°ä¹Ÿæ— ä»è·å–ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ context ä¸­æ·»åŠ <strong>å½“å‰èŠ‚ç‚¹çš„ä¸Šä¸‹æ–‡ä¿¡æ¯</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> context = {
    <span class="hljs-attr">nodeTransforms</span>: [transformText, transformElement],
    <span class="hljs-attr">currentNode</span>: <span class="hljs-literal">null</span>,  <span class="hljs-comment">// å½“å‰æ­£åœ¨å¤„ç†çš„èŠ‚ç‚¹</span>
    <span class="hljs-attr">parent</span>: <span class="hljs-literal">null</span>,       <span class="hljs-comment">// å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹</span>
    <span class="hljs-attr">childIndex</span>: <span class="hljs-number">0</span>       <span class="hljs-comment">// å½“å‰èŠ‚ç‚¹åœ¨çˆ¶èŠ‚ç‚¹ children ä¸­çš„ç´¢å¼•</span>
}
</code></pre>
<p>ç›¸åº”çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ <code>traverseNode</code> å‡½æ•°æ¥ç»´æŠ¤è¿™äº›ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">traverseNode</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-comment">// è®¾ç½®å½“å‰èŠ‚ç‚¹</span>
    context.<span class="hljs-property">currentNode</span> = node

    <span class="hljs-comment">// éå†æ‰€æœ‰è½¬æ¢å‡½æ•°</span>
    <span class="hljs-keyword">const</span> { nodeTransforms } = context
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; nodeTransforms.<span class="hljs-property">length</span>; i++) {
        nodeTransforms[i](node, context)
        <span class="hljs-comment">// è½¬æ¢å‡½æ•°å¯èƒ½ä¼šåˆ é™¤å½“å‰èŠ‚ç‚¹</span>
        <span class="hljs-keyword">if</span> (!context.<span class="hljs-property">currentNode</span>) <span class="hljs-keyword">return</span>
    }

    <span class="hljs-keyword">const</span> children = context.<span class="hljs-property">currentNode</span>.<span class="hljs-property">children</span>
    <span class="hljs-keyword">if</span> (children &amp;&amp; children.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; children.<span class="hljs-property">length</span>; i++) {
            context.<span class="hljs-property">parent</span> = context.<span class="hljs-property">currentNode</span> <span class="hljs-comment">// å°†å½“å‰èŠ‚ç‚¹ä½œä¸ºçˆ¶èŠ‚ç‚¹</span>
            context.<span class="hljs-property">childIndex</span> = i <span class="hljs-comment">// è®°å½•å½“å‰èŠ‚ç‚¹åœ¨ children ä¸­çš„ç´¢å¼•</span>
            <span class="hljs-title function_">traverseNode</span>(children[i], context) <span class="hljs-comment">// å¼€å§‹é€’å½’å¤„ç†èŠ‚ç‚¹</span>
        }
    }
}
</code></pre>
<p>ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥å®ç°åˆ é™¤èŠ‚ç‚¹çš„åŠŸèƒ½äº†ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">transformRemoveComment</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> === <span class="hljs-string">'Comment'</span>) {
        <span class="hljs-keyword">if</span> (context.<span class="hljs-property">parent</span>) {
            <span class="hljs-comment">// ä»çˆ¶èŠ‚ç‚¹çš„ children ä¸­åˆ é™¤å½“å‰èŠ‚ç‚¹</span>
            context.<span class="hljs-property">parent</span>.<span class="hljs-property">children</span>.<span class="hljs-title function_">splice</span>(context.<span class="hljs-property">childIndex</span>, <span class="hljs-number">1</span>)
            <span class="hljs-comment">// å°† currentNode ç½®ä¸º nullï¼Œè¡¨ç¤ºèŠ‚ç‚¹å·²è¢«åˆ é™¤</span>
            context.<span class="hljs-property">currentNode</span> = <span class="hljs-literal">null</span>
        }
    }
}
</code></pre>
<h4 data-id="heading-15">ç¬¬ä¸‰æ­¥ï¼šèŠ‚ç‚¹æ›¿æ¢çš„éœ€æ±‚</h4>
<p>é™¤äº†åˆ é™¤ï¼Œæˆ‘ä»¬å¯èƒ½è¿˜ä¼šé‡åˆ°éœ€è¦æ›¿æ¢èŠ‚ç‚¹çš„åœºæ™¯ã€‚æ¯”å¦‚æˆ‘ä»¬æƒ³æŠŠæ‰€æœ‰çš„æ–‡æœ¬èŠ‚ç‚¹åŒ…è£…æˆä¸€ä¸ªç‰¹æ®Šçš„å¯¹è±¡ï¼Œæ–¹ä¾¿åç»­çš„ä»£ç ç”Ÿæˆé˜¶æ®µå¤„ç†ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">transformText</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> === <span class="hljs-string">'Text'</span>) {
        <span class="hljs-comment">// æˆ‘ä»¬æƒ³æ›¿æ¢å½“å‰èŠ‚ç‚¹</span>
        <span class="hljs-comment">// ä½†æ˜¯ç›´æ¥ä¿®æ”¹ node çš„å±æ€§å¯èƒ½ä¸å¤Ÿï¼Œæˆ‘ä»¬éœ€è¦æ•´ä¸ªæ›¿æ¢è¿™ä¸ªèŠ‚ç‚¹</span>
    }
}
</code></pre>
<p>ä¸ºäº†æ”¯æŒèŠ‚ç‚¹æ›¿æ¢ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æœ‰ä¸€ä¸ªå·¥å…·å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ context ä¸­æ·»åŠ è¿™ä¸ªå‡½æ•°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> context = {
    <span class="hljs-attr">nodeTransforms</span>: [transformText, transformElement],
    <span class="hljs-attr">currentNode</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">parent</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">childIndex</span>: <span class="hljs-number">0</span>,
    <span class="hljs-comment">// æ·»åŠ èŠ‚ç‚¹æ›¿æ¢å‡½æ•°</span>
    <span class="hljs-title function_">replaceNode</span>(<span class="hljs-params">newNode</span>) {
        <span class="hljs-comment">// æ›¿æ¢å½“å‰èŠ‚ç‚¹</span>
        context.<span class="hljs-property">parent</span>.<span class="hljs-property">children</span>[context.<span class="hljs-property">childIndex</span>] = newNode
        <span class="hljs-comment">// æ›´æ–° currentNode</span>
        context.<span class="hljs-property">currentNode</span> = newNode
    }
}
</code></pre>
<p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿™æ ·ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">transformText</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> === <span class="hljs-string">'Text'</span>) {
        <span class="hljs-comment">// å°†æ–‡æœ¬èŠ‚ç‚¹åŒ…è£…æˆ JavaScript å­—ç¬¦ä¸²å­—é¢é‡</span>
        <span class="hljs-comment">//  - ä¹Ÿå°±æ˜¯å°† Template AST çš„æ–‡æœ¬èŠ‚ç‚¹ï¼Œæ¢æˆ JS AST ä¸­çš„å­—ç¬¦ä¸²èŠ‚ç‚¹</span>
        context.<span class="hljs-title function_">replaceNode</span>({
            <span class="hljs-attr">type</span>: <span class="hljs-string">'StringLiteral'</span>,
            <span class="hljs-attr">value</span>: node.<span class="hljs-property">content</span>
        })
    }
}
</code></pre>
<h4 data-id="heading-16">ç¬¬å››æ­¥ï¼šèŠ‚ç‚¹ç§»é™¤çš„ä¾¿æ·æ–¹æ³•</h4>
<p>éƒ½è¯´ç å†œå¹²çš„å°±æ˜¯ CRUDï¼Œé‚£ä¹ˆæ—¢ç„¶æˆ‘ä»¬æœ‰äº† <code>replaceNode</code>ï¼Œä¸€ä¸ªæ›´ä¾¿æ·çš„ <code>removeNode</code> æ–¹æ³•ä¹Ÿè‚¯å®šæ˜¯å¿…ä¸å¯å°‘çš„ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> context = {
    <span class="hljs-attr">nodeTransforms</span>: [transformText, transformElement],
    <span class="hljs-attr">currentNode</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">parent</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">childIndex</span>: <span class="hljs-number">0</span>,
    <span class="hljs-title function_">replaceNode</span>(<span class="hljs-params">newNode</span>) {
        context.<span class="hljs-property">parent</span>.<span class="hljs-property">children</span>[context.<span class="hljs-property">childIndex</span>] = newNode
        context.<span class="hljs-property">currentNode</span> = newNode
    },
    <span class="hljs-comment">// æ·»åŠ èŠ‚ç‚¹ç§»é™¤å‡½æ•°</span>
    <span class="hljs-title function_">removeNode</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">if</span> (context.<span class="hljs-property">parent</span>) {
            context.<span class="hljs-property">parent</span>.<span class="hljs-property">children</span>.<span class="hljs-title function_">splice</span>(context.<span class="hljs-property">childIndex</span>, <span class="hljs-number">1</span>)
            context.<span class="hljs-property">currentNode</span> = <span class="hljs-literal">null</span>
        }
    }
}
</code></pre>
<p>ç°åœ¨åˆ é™¤æ³¨é‡ŠèŠ‚ç‚¹çš„ä»£ç å¯ä»¥ç®€åŒ–ä¸ºï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">transformRemoveComment</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> === <span class="hljs-string">'Comment'</span>) {
        context.<span class="hljs-title function_">removeNode</span>()
    }
}
</code></pre>
<h4 data-id="heading-17">ç¬¬äº”æ­¥ï¼šå®Œæ•´çš„ä»£ç ç¤ºä¾‹</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å› ä¸ºæˆ‘ä»¬çš„åœ¨è§£æä¸º Template AST çš„æ—¶å€™ï¼Œå…¶å®æ˜¯æ²¡æœ‰å¤„ç†æ³¨é‡ŠèŠ‚ç‚¹çš„ï¼Œæ‰€ä»¥è¿™é‡Œå¹¶æ²¡æœ‰æŠŠä¸Šæ–‡çš„æ³¨é‡ŠèŠ‚ç‚¹åŠ åˆ°æ¨¡æ¿ä¸­</span>
<span class="hljs-keyword">const</span> template = <span class="hljs-string">`&lt;div&gt;&lt;p&gt;Vue&lt;/p&gt;&lt;/div&gt;`</span>
<span class="hljs-keyword">const</span> templateAST = <span class="hljs-title function_">parse</span>(template)

<span class="hljs-keyword">function</span> <span class="hljs-title function_">traverseNode</span>(<span class="hljs-params">node, context</span>) {
    context.<span class="hljs-property">currentNode</span> = node

    <span class="hljs-keyword">const</span> { nodeTransforms } = context
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; nodeTransforms.<span class="hljs-property">length</span>; i++) {
        nodeTransforms[i](node, context)
        <span class="hljs-keyword">if</span> (!context.<span class="hljs-property">currentNode</span>) <span class="hljs-keyword">return</span>
    }

    <span class="hljs-keyword">const</span> children = context.<span class="hljs-property">currentNode</span>.<span class="hljs-property">children</span>
    <span class="hljs-keyword">if</span> (children &amp;&amp; children.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; children.<span class="hljs-property">length</span>; i++) {
            context.<span class="hljs-property">parent</span> = context.<span class="hljs-property">currentNode</span>
            context.<span class="hljs-property">childIndex</span> = i
            <span class="hljs-title function_">traverseNode</span>(children[i], context)
        }
    }
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">transformRemoveComment</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> === <span class="hljs-string">'Comment'</span>) {
        context.<span class="hljs-title function_">removeNode</span>()
    }
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">transformText</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> === <span class="hljs-string">'Text'</span>) {
        context.<span class="hljs-title function_">replaceNode</span>({
            <span class="hljs-attr">type</span>: <span class="hljs-string">'StringLiteral'</span>,
            <span class="hljs-attr">value</span>: node.<span class="hljs-property">content</span>
        })
    }
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">transformElement</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> !== <span class="hljs-string">'Element'</span>) {
        <span class="hljs-keyword">return</span>
    }
    <span class="hljs-comment">// è¿™ä¸ªéœ€è¦æ›¿æ¢çš„èŠ‚ç‚¹ï¼Œç›¸å¯¹å¤æ‚ä¸€äº›ï¼Œç›´æ¥å†™å‡ºæ¥ï¼Œä¼šè®©å¤§å®¶è§‰å¾—å›°æƒ‘ï¼Œæ‰€ä»¥æš‚æ—¶ç•™ç©ºï¼Œç­‰åæ–‡å†è¿›è¡Œè§£æ</span>
}

<span class="hljs-keyword">const</span> context = {
    <span class="hljs-attr">nodeTransforms</span>: [transformRemoveComment, transformText],
    <span class="hljs-attr">currentNode</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">parent</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">childIndex</span>: <span class="hljs-number">0</span>,
    <span class="hljs-title function_">replaceNode</span>(<span class="hljs-params">newNode</span>) {
        context.<span class="hljs-property">parent</span>.<span class="hljs-property">children</span>[context.<span class="hljs-property">childIndex</span>] = newNode
        context.<span class="hljs-property">currentNode</span> = newNode
    },
    <span class="hljs-title function_">removeNode</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">if</span> (context.<span class="hljs-property">parent</span>) {
            context.<span class="hljs-property">parent</span>.<span class="hljs-property">children</span>.<span class="hljs-title function_">splice</span>(context.<span class="hljs-property">childIndex</span>, <span class="hljs-number">1</span>)
            context.<span class="hljs-property">currentNode</span> = <span class="hljs-literal">null</span>
        }
    }
}

<span class="hljs-title function_">traverseNode</span>(templateAST, context)

<span class="hljs-title function_">dump</span>(templateAST)
</code></pre>
<p>ç»è¿‡ä¸Šè¿°æ­¥éª¤çš„ä¾æ¬¡é€’è¿›ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° context çš„æ•°æ®æ˜¯å¦‚ä½•ä¸€æ­¥æ­¥è¢«æ·»åŠ è¿›æ¥çš„ï¼š</p>
<ol>
<li><strong>nodeTransforms</strong>ï¼šæœ€åŸºç¡€çš„è½¬æ¢å‡½æ•°æ•°ç»„</li>
<li><strong>currentNode</strong>ï¼šè·Ÿè¸ªå½“å‰æ­£åœ¨å¤„ç†çš„èŠ‚ç‚¹</li>
<li><strong>parent</strong>ï¼šè·Ÿè¸ªçˆ¶èŠ‚ç‚¹ï¼Œç”¨äºèŠ‚ç‚¹çš„åˆ é™¤å’Œæ›¿æ¢</li>
<li><strong>childIndex</strong>ï¼šè·Ÿè¸ªå½“å‰èŠ‚ç‚¹åœ¨çˆ¶èŠ‚ç‚¹ä¸­çš„ä½ç½®</li>
<li><strong>replaceNode</strong>ï¼šæä¾›ä¾¿æ·çš„èŠ‚ç‚¹æ›¿æ¢æ–¹æ³•</li>
<li><strong>removeNode</strong>ï¼šæä¾›ä¾¿æ·çš„èŠ‚ç‚¹åˆ é™¤æ–¹æ³•</li>
</ol>
<p>æ¯ä¸€ä¸ªæ•°æ®çš„æ·»åŠ éƒ½æ˜¯ä¸ºäº†è§£å†³ä¸€ä¸ªå…·ä½“çš„é—®é¢˜ï¼Œé€šè¿‡ç†Ÿæ‚‰è¿™ä¸ªæµç¨‹ï¼Œè¯¦ç»†å¤§å®¶ä¹Ÿå¯ä»¥ä½“ä¼šåˆ° context çš„ä¸€äº›å¥½å¤„ã€‚</p>
<h3 data-id="heading-18">å…·ä½“å®ç°-æ­£ç¡®çš„å·¥ä½œæµ</h3>
<h4 data-id="heading-19">å½“å‰çš„å¤„ç†é¡ºåºå­˜åœ¨çš„é—®é¢˜</h4>
<p>å›é¡¾ä¹‹å‰å†™çš„ <code>traverseNode</code> å‡½æ•°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">traverseNode</span>(<span class="hljs-params">node, context</span>) {
    context.<span class="hljs-property">currentNode</span> = node

    <span class="hljs-comment">// å…ˆå¤„ç†å½“å‰èŠ‚ç‚¹</span>
    <span class="hljs-keyword">const</span> { nodeTransforms } = context
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; nodeTransforms.<span class="hljs-property">length</span>; i++) {
        nodeTransforms[i](node, context)
        <span class="hljs-keyword">if</span> (!context.<span class="hljs-property">currentNode</span>) <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// å†å¤„ç†å­èŠ‚ç‚¹</span>
    <span class="hljs-keyword">const</span> children = context.<span class="hljs-property">currentNode</span>.<span class="hljs-property">children</span>
    <span class="hljs-keyword">if</span> (children &amp;&amp; children.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; children.<span class="hljs-property">length</span>; i++) {
            context.<span class="hljs-property">parent</span> = context.<span class="hljs-property">currentNode</span> <span class="hljs-comment">// å°†å½“å‰èŠ‚ç‚¹ä½œä¸ºçˆ¶èŠ‚ç‚¹</span>
            context.<span class="hljs-property">childIndex</span> = i <span class="hljs-comment">// è®°å½•å½“å‰èŠ‚ç‚¹åœ¨ children ä¸­çš„ç´¢å¼•</span>
            <span class="hljs-title function_">traverseNode</span>(children[i], context) <span class="hljs-comment">// å¼€å§‹é€’å½’å¤„ç†èŠ‚ç‚¹</span>
        }
    }
}
</code></pre>
<p>è¿™ä¸ªå‡½æ•°çš„å¤„ç†é¡ºåºæ˜¯ï¼š<strong>å…ˆå¤„ç†å½“å‰èŠ‚ç‚¹ï¼Œå†é€’å½’å¤„ç†å­èŠ‚ç‚¹</strong>ã€‚è¿™ç§éå†æ–¹å¼åœ¨è®¡ç®—æœºç§‘å­¦é‡Œæœ‰ä¸ªä¸“ä¸šåè¯ï¼Œå«"å…ˆåºéå†"ï¼ˆPre-order Traversalï¼‰ã€‚</p>
<p>å¬èµ·æ¥å¥½åƒæ²¡å•¥é—®é¢˜ï¼Ÿä½†å®é™…ä¸Šï¼Œè¿™ç§é¡ºåºåœ¨æˆ‘ä»¬è½¬æ¢ AST çš„æ—¶å€™ä¼šé‡åˆ°ä¸€ä¸ªå°´å°¬çš„æƒ…å†µï¼š</p>
<p>å‡è®¾æˆ‘ä»¬è¦æŠŠè¿™ä¸ªæ¨¡æ¿ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Vue<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>è½¬æ¢æˆè¿™æ ·çš„ JavaScript ä»£ç ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">h</span>(<span class="hljs-string">'div'</span>, [<span class="hljs-title function_">h</span>(<span class="hljs-string">'p'</span>, [<span class="hljs-string">'Vue'</span>])])
</code></pre>
<p>å½“æˆ‘ä»¬å¤„ç† <code>&lt;div&gt;</code> è¿™ä¸ªå…ƒç´ èŠ‚ç‚¹æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æŠŠå®ƒè½¬æ¢æˆä¸€ä¸ª <code>h()</code> å‡½æ•°è°ƒç”¨ï¼Œè€Œè¿™ä¸ªå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯å®ƒçš„å­èŠ‚ç‚¹æ•°ç»„ã€‚<strong>é—®é¢˜æ¥äº†</strong>ï¼šæ­¤æ—¶å­èŠ‚ç‚¹ <code>&lt;p&gt;Vue&lt;/p&gt;</code> è¿˜æ²¡æœ‰è¢«è½¬æ¢å‘¢ï¼å®ƒè¿˜æ˜¯ Template AST çš„èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯ JavaScript AST çš„èŠ‚ç‚¹ã€‚</p>
<p>è¿™å°±å¥½æ¯”æ­ç§¯æœ¨ï¼Œä½ æƒ³æ­ä¸€ä¸ªå¤§æˆ¿å­ï¼Œä½†æˆ¿å­é‡Œé¢è¿˜æœ‰å°æˆ¿é—´ã€‚ä½ å¿…é¡»å…ˆæŠŠå°æˆ¿é—´æ­å¥½ï¼Œæ‰èƒ½æŠŠå®ƒä»¬ç»„è£…åˆ°å¤§æˆ¿å­é‡Œâ€”â€”ä½ ä¸èƒ½ä¸€è¾¹æ­å¤§æˆ¿å­çš„æ¡†æ¶ï¼Œä¸€è¾¹å°æˆ¿é—´è¿˜æ˜¯æ•£è½çš„ç§¯æœ¨å—ã€‚</p>
<h4 data-id="heading-20">æ­£ç¡®çš„é¡ºåºï¼šååºéå†</h4>
<p>æ‰€ä»¥ï¼Œæ­£ç¡®çš„å¤„ç†é¡ºåºåº”è¯¥æ˜¯ï¼š<strong>å…ˆé€’å½’å¤„ç†å­èŠ‚ç‚¹ï¼Œå†å¤„ç†å½“å‰èŠ‚ç‚¹</strong>ã€‚è¿™ç§éå†æ–¹å¼å«"ååºéå†"ï¼ˆPost-order Traversalï¼‰ã€‚</p>
<p>è¿™æ ·ä¸€æ¥ï¼Œå½“æˆ‘ä»¬å¤„ç†çˆ¶èŠ‚ç‚¹æ—¶ï¼Œå®ƒçš„æ‰€æœ‰å­èŠ‚ç‚¹éƒ½å·²ç»è¢«è½¬æ¢å®Œæˆäº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ”¾å¿ƒåœ°ä½¿ç”¨è½¬æ¢åçš„å­èŠ‚ç‚¹æ¥æ„å»ºçˆ¶èŠ‚ç‚¹çš„ JavaScript AST äº†ã€‚</p>
<p>ä½†è¿™é‡Œå­˜åœ¨ä¸€ä¸ªå°é—®é¢˜ï¼šæˆ‘ä»¬çš„è½¬æ¢å‡½æ•°å¯èƒ½éœ€è¦åœ¨"è¿›å…¥èŠ‚ç‚¹"æ—¶åšä¸€äº›äº‹æƒ…ï¼Œä¹Ÿå¯èƒ½éœ€è¦åœ¨"é€€å‡ºèŠ‚ç‚¹"æ—¶åšä¸€äº›äº‹æƒ…ã€‚æ¯”å¦‚ï¼š</p>
<ul>
<li><strong>è¿›å…¥èŠ‚ç‚¹æ—¶</strong>ï¼šæ”¶é›†ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚å½“å‰ä½œç”¨åŸŸçš„å˜é‡</li>
<li><strong>é€€å‡ºèŠ‚ç‚¹æ—¶</strong>ï¼šè¿›è¡Œå®é™…çš„è½¬æ¢ï¼Œå› ä¸ºæ­¤æ—¶å­èŠ‚ç‚¹å·²ç»å¤„ç†å®Œäº†</li>
</ul>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦è®©è½¬æ¢å‡½æ•°èƒ½å¤Ÿè¿”å›ä¸€ä¸ª"é€€å‡ºå‡½æ•°"ï¼Œè¿™ä¸ªé€€å‡ºå‡½æ•°ä¼šåœ¨å­èŠ‚ç‚¹å¤„ç†å®Œä¹‹åè¢«è°ƒç”¨ã€‚</p>
<p>æˆ–è®¸ä½ ä¼šç–‘æƒ‘ï¼Ÿä¸ºä»€ä¹ˆä¸èƒ½åƒå‰æ–‡é‚£æ ·ï¼Œè¿›è¡Œåˆ¤æ–­ï¼Œç„¶åç›´æ¥åœ¨å‡½æ•°å†…è¿›è¡ŒèŠ‚ç‚¹çš„æ›¿æ¢ï¼Œè€Œå¿…é¡»åˆ†ä¸º<strong>ä¸¤ä¸ªé˜¶æ®µ</strong>å‘¢ï¼Ÿ</p>
<p>å› ä¸ºå‰æ–‡ä¸­çš„ç®€å•è½¬æ¢ï¼ˆå¦‚åˆ é™¤æ³¨é‡Šã€è½¬æ¢æ–‡æœ¬èŠ‚ç‚¹ï¼‰æ˜¯ä¸ä¾èµ–å­èŠ‚ç‚¹çš„è½¬æ¢ç»“æœï¼Œæ‰€ä»¥å¯ä»¥åœ¨éå†åˆ°èŠ‚ç‚¹æ—¶ç«‹å³å®Œæˆã€‚ä½†å…ƒç´ èŠ‚ç‚¹çš„è½¬æ¢ä¸åŒâ€”â€”å®ƒéœ€è¦æŠŠå­èŠ‚ç‚¹ä½œä¸ºå‚æ•°ä¼ é€’ç»™ <code>h()</code> å‡½æ•°ï¼Œè€Œæ­¤æ—¶å­èŠ‚ç‚¹è¿˜æ²¡æœ‰è¢«è½¬æ¢ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬åœ¨"è¿›å…¥èŠ‚ç‚¹"æ—¶å°±å°è¯•è½¬æ¢å…ƒç´ èŠ‚ç‚¹ï¼Œä¼šé‡åˆ°è¿™æ ·çš„å›°å¢ƒï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// é”™è¯¯çš„åšæ³•ï¼šåœ¨è¿›å…¥é˜¶æ®µç›´æ¥è½¬æ¢</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">transformElement</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> !== <span class="hljs-string">'Element'</span>) <span class="hljs-keyword">return</span>

    <span class="hljs-comment">// æ­¤æ—¶ node.children è¿˜æ˜¯ Template AST èŠ‚ç‚¹ï¼Œä¸æ˜¯ JavaScript ASTï¼Œå¦‚æœç›´æ¥æ›¿æ¢çš„è¯ï¼Œå®ƒçš„å­èŠ‚ç‚¹å°±æ— æ³•æ­£ç¡®çš„å­˜å‚¨äº†</span>
    context.<span class="hljs-title function_">replaceNode</span>(<span class="hljs-comment">/* ... */</span>)
}
</code></pre>
<p>æ‰€ä»¥æˆ‘ä»¬å¿…é¡»åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š<strong>è¿›å…¥é˜¶æ®µ</strong>å¯ä»¥æ”¶é›†ä¿¡æ¯ã€åšå‡†å¤‡å·¥ä½œï¼Œ<strong>é€€å‡ºé˜¶æ®µ</strong>åœ¨å­èŠ‚ç‚¹å¤„ç†å®Œåè¿›è¡Œå®é™…è½¬æ¢ã€‚è¿™æ ·å½“æˆ‘ä»¬è½¬æ¢çˆ¶èŠ‚ç‚¹æ—¶ï¼Œå­èŠ‚ç‚¹å·²ç»æ˜¯è½¬æ¢å¥½çš„ JavaScript AST äº†ã€‚</p>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ‰§è¡Œçš„å·¥ä½œæµæµç¨‹ï¼Œå¦‚å›¾:</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/799cef7fae9b41e6ae8d0b6658a303cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJqYw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767146836&amp;x-signature=ujvh1kpxECLPSG0DwHGoCGkdMTk%3D" alt="image-20251223153037396.png" loading="lazy"/></p>
<p>æ ¹æ®æˆ‘ä»¬çš„æ€è€ƒï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè½¬æ¢å™¨éœ€è¦è¿”å›ä¸€ä¸ªé€€å‡ºé˜¶æ®µæ‰§è¡Œçš„å‡½æ•°ï¼Œå‡½æ•°ç­¾åå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">transformElement</span>(<span class="hljs-params">node, context</span>){
    <span class="hljs-keyword">return</span> <span class="hljs-function">()=&gt;</span>{
        <span class="hljs-comment">// åœ¨è¿™é‡Œç¼–å†™é€€å‡ºèŠ‚ç‚¹çš„é€»è¾‘ï¼Œå½“è¿™é‡Œçš„ä»£ç è¿è¡Œæ—¶ï¼Œå½“å‰è½¬æ¢èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ä¸€å®šå¤„ç†å®Œæ¯•äº†</span>
    }
}
</code></pre>
<p>è½¬æ¢å™¨å‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆå¯¹åº”çš„æ‰§è¡Œçš„é€»è¾‘ä¹Ÿè¦å‘ç”Ÿä¸€äº›æ”¹å˜ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">traverseNode</span>(<span class="hljs-params">node, context</span>) {
    context.<span class="hljs-property">currentNode</span> = node

    <span class="hljs-comment">// ç”¨äºå­˜å‚¨é€€å‡ºå‡½æ•°</span>
    <span class="hljs-keyword">const</span> exitFns = []

    <span class="hljs-comment">// éå†æ‰€æœ‰è½¬æ¢å‡½æ•°</span>
    <span class="hljs-keyword">const</span> { nodeTransforms } = context
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; nodeTransforms.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-comment">// è·å–é€€å‡ºå‡½æ•°</span>
        <span class="hljs-keyword">const</span> onExit = nodeTransforms[i](node, context)
        <span class="hljs-keyword">if</span> (onExit) {
            exitFns.<span class="hljs-title function_">push</span>(onExit)
        }
        <span class="hljs-comment">// å¦‚æœå½“å‰èŠ‚ç‚¹è¢«åˆ é™¤ï¼Œåˆ™ç›´æ¥è¿”å›</span>
        <span class="hljs-comment">//  - å› ä¸ºä»»ä½•è½¬æ¢å‡½æ•°ï¼Œéƒ½å¯èƒ½ä¼šåˆ é™¤å½“å‰èŠ‚ç‚¹ï¼Œæ‰€ä»¥ï¼Œé˜²æ­¢åç»­çš„è½¬æ¢å‡½æ•°ç»§ç»­å¤„ç†ä¸€ä¸ªä¸å­˜åœ¨çš„èŠ‚ç‚¹ï¼Œæå‰é€€å‡º</span>
        <span class="hljs-keyword">if</span> (!context.<span class="hljs-property">currentNode</span>) <span class="hljs-keyword">return</span>
    }

    <span class="hljs-keyword">const</span> children = context.<span class="hljs-property">currentNode</span>.<span class="hljs-property">children</span>
    <span class="hljs-keyword">if</span> (children &amp;&amp; children.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; children.<span class="hljs-property">length</span>; i++) {
            context.<span class="hljs-property">parent</span> = context.<span class="hljs-property">currentNode</span>
            context.<span class="hljs-property">childIndex</span> = i
            <span class="hljs-title function_">traverseNode</span>(children[i], context)
        }
    }
}
</code></pre>
<p>æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œæˆ‘ä»¬åªæ˜¯æ‹¿åˆ°äº†é€€å‡ºå‡½æ•°ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦æ·»åŠ ä¸€äº›æ‰§è¡Œé€»è¾‘ã€‚</p>
<p>ä½†æ˜¯ï¼Œæ‰§è¡Œå°±æ˜¯ç›´æ¥éå† exitFns ç„¶åè°ƒç”¨å—ï¼Ÿåœ¨å›ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸å¦¨è¯•è¯•ç›´æ¥éå†æ‰§è¡Œçš„æƒ…å†µï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</p>
<p>å‡è®¾æˆ‘ä»¬æœ‰è¿™æ ·ä¸€æ®µæ¨¡æ¿ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ msg }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>ç°åœ¨æœ‰ä¸¤ä¸ªè½¬æ¢å‡½æ•°ï¼š</p>
<ol>
<li><code>transformElement</code> - è´Ÿè´£å°†å…ƒç´ è½¬æ¢ä¸º <code>h()</code> å‡½æ•°è°ƒç”¨</li>
<li><code>transformText</code> - è´Ÿè´£å°†æ–‡æœ¬å’Œæ’å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ‹¼æ¥</li>
</ol>
<p>å¦‚æœæˆ‘ä»¬ç›´æ¥æ‰§è¡Œé€€å‡ºå‡½æ•°ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">traverseNode</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-comment">// ... å‰é¢çš„ä»£ç çœç•¥</span>
    
    <span class="hljs-comment">// å‡è®¾ exitFns = [exitElement, exitText]</span>
    <span class="hljs-comment">// ç›´æ¥éå†æ‰§è¡Œ</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; exitFns.<span class="hljs-property">length</span>; i++) {
        exitFns[i]()  <span class="hljs-comment">// å…ˆæ‰§è¡Œ exitElementï¼Œå†æ‰§è¡Œ exitText</span>
    }
}
</code></pre>
<p>æ­¤æ—¶é—®é¢˜å°±å‡ºç°äº†ï¼Œå…¶å®å’Œå‰é¢çš„åˆ†æå·®ä¸å¤šï¼šå½“æˆ‘ä»¬å¤„ç† <code>&lt;div&gt;</code> èŠ‚ç‚¹æ—¶ï¼Œæ‰§è¡Œé¡ºåºæ˜¯ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">å¤„ç† <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span> èŠ‚ç‚¹ï¼š
<span class="hljs-bullet">  1.</span> transformElement è¿›å…¥ â†’ è¿”å› exitElement
<span class="hljs-bullet">  2.</span> transformText è¿›å…¥ â†’ è¿”å› exitText
<span class="hljs-bullet">  3.</span> é€’å½’å¤„ç†å­èŠ‚ç‚¹ <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span></span>
<span class="hljs-bullet">  4.</span> ç›´æ¥æ‰§è¡Œé€€å‡ºå‡½æ•°ï¼š
<span class="hljs-bullet">    -</span> exitElement() æ‰§è¡Œ â†’ æƒ³æŠŠ <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span> è½¬æˆ h('div', [...children])ï¼Œä½†æ­¤æ—¶ children è¿˜æ˜¯ Template AST èŠ‚ç‚¹ï¼è¿˜æ²¡è¢«è½¬æ¢æˆ JS ASTã€‚
<span class="hljs-bullet">    -</span> exitText() æ‰§è¡Œ â†’ ä½†èŠ‚ç‚¹å·²ç»è¢«æ›¿æ¢äº†ï¼Œæ— æ³•ç»§ç»­å¤„ç†
</code></pre>
<p>æ­£ç¡®çš„åšæ³•æ˜¯<strong>åå‘éå†</strong> exitFnsï¼Œè®©åæ³¨å†Œçš„å…ˆæ‰§è¡Œï¼Œå…ˆæ³¨å†Œçš„åæ‰§è¡Œï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">traverseNode</span>(<span class="hljs-params">node, context</span>) {
    context.<span class="hljs-property">currentNode</span> = node

    <span class="hljs-comment">// ç”¨äºå­˜å‚¨é€€å‡ºå‡½æ•°</span>
    <span class="hljs-keyword">const</span> exitFns = []

    <span class="hljs-comment">// éå†æ‰€æœ‰è½¬æ¢å‡½æ•°ï¼ˆè¿›å…¥é˜¶æ®µï¼‰</span>
    <span class="hljs-keyword">const</span> { nodeTransforms } = context
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; nodeTransforms.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-keyword">const</span> onExit = nodeTransforms[i](node, context)
        <span class="hljs-keyword">if</span> (onExit) {
            exitFns.<span class="hljs-title function_">push</span>(onExit)
        }
        <span class="hljs-keyword">if</span> (!context.<span class="hljs-property">currentNode</span>) <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// é€’å½’å¤„ç†å­èŠ‚ç‚¹</span>
    <span class="hljs-keyword">const</span> children = context.<span class="hljs-property">currentNode</span>.<span class="hljs-property">children</span>
    <span class="hljs-keyword">if</span> (children &amp;&amp; children.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; children.<span class="hljs-property">length</span>; i++) {
            context.<span class="hljs-property">parent</span> = context.<span class="hljs-property">currentNode</span>
            context.<span class="hljs-property">childIndex</span> = i
            <span class="hljs-title function_">traverseNode</span>(children[i], context)
        }
    }

    <span class="hljs-comment">// å…³é”®ï¼šåå‘éå†æ‰§è¡Œé€€å‡ºå‡½æ•°</span>
    <span class="hljs-keyword">let</span> i = exitFns.<span class="hljs-property">length</span>
    <span class="hljs-keyword">while</span> (i--) {
        exitFns[i]()
    }
}
</code></pre>
<h3 data-id="heading-21">å…·ä½“å®ç°-Template AST è½¬ä¸º JavaScript AST</h3>
<p>åœ¨å‰æ–‡ï¼Œæˆ‘ä»¬åŸºæœ¬æ­å»ºå¥½äº†è½¬æ¢æ¶æ„ï¼Œç°åœ¨åªå·®æœ€å…³é”®çš„ä¸€æ­¥ï¼š<strong>å®šä¹‰ JavaScript AST çš„èŠ‚ç‚¹ç»“æ„</strong>ï¼Œç„¶ååœ¨è½¬æ¢å‡½æ•°ä¸­ç”Ÿæˆè¿™äº›èŠ‚ç‚¹ã€‚</p>
<p>è®©æˆ‘ä»¬æ˜ç¡®ä¸€ä¸‹ç›®æ ‡ã€‚è¿˜æ˜¯ä½¿ç”¨æˆ‘ä»¬çš„è€æœ‹å‹ï¼Œæ¨¡æ¿ä»£ç ä¸ºï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Vue<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>æˆ‘ä»¬æœŸæœ›æœ€ç»ˆç”Ÿæˆçš„æ¸²æŸ“å‡½æ•°æ˜¯ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params"/>){
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">h</span>(<span class="hljs-string">'div'</span>, <span class="hljs-title function_">h</span>(<span class="hljs-string">'p'</span>, <span class="hljs-string">'Vue'</span>))
}
</code></pre>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼š<strong>å¦‚ä½•ç”¨ AST æ¥æè¿°è¿™æ®µ JavaScript ä»£ç å‘¢ï¼Ÿ</strong></p>
<p>å›æƒ³ä¸€ä¸‹å‰æ–‡ä¸­æˆ‘ä»¬å¦‚ä½•æè¿° Template ASTâ€”â€”æ¯ä¸ª HTML å…ƒç´ éƒ½æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæœ‰ <code>type</code>ã€<code>tag</code>ã€<code>children</code> ç­‰å±æ€§ã€‚åŒæ ·çš„é“ç†ï¼ŒJavaScript ä»£ç ä¹Ÿå¯ä»¥ç”¨ç±»ä¼¼çš„æ–¹å¼æ¥æè¿°ï¼šæ¯ä¸ªè¯­æ³•ç»“æ„éƒ½æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p>
<h4 data-id="heading-22">å‡½æ•°å£°æ˜èŠ‚ç‚¹</h4>
<p>æˆ‘ä»¬å…ˆä»æœ€å¤–å±‚å¼€å§‹åˆ†æã€‚è¿™æ®µä»£ç æ•´ä½“æ˜¯ä¸€ä¸ª<strong>å‡½æ•°å£°æ˜</strong>ï¼Œè¦æè¿°å®ƒï¼Œæˆ‘ä»¬è‡³å°‘éœ€è¦çŸ¥é“ï¼š</p>
<ul>
<li>å‡½æ•°åç§°ï¼ˆ<code>render</code>ï¼‰</li>
<li>å‡½æ•°å‚æ•°ï¼ˆè¿™é‡Œä¸ºç©ºï¼‰</li>
<li>å‡½æ•°ä½“ï¼ˆä¸€ä¸ª return è¯­å¥ï¼‰</li>
</ul>
<p>åŸºäºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è®¾è®¡å‡ºè¿™æ ·çš„èŠ‚ç‚¹ç»“æ„ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">FunctionDecl</span> = {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'FunctionDecl'</span>,        <span class="hljs-comment">// èŠ‚ç‚¹ç±»å‹ï¼šå‡½æ•°å£°æ˜</span>
    <span class="hljs-attr">id</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'Identifier'</span>,      <span class="hljs-comment">// æ ‡è¯†ç¬¦èŠ‚ç‚¹</span>
        <span class="hljs-attr">name</span>: <span class="hljs-string">'render'</span>           <span class="hljs-comment">// å‡½æ•°åç§°</span>
    },
    <span class="hljs-attr">params</span>: [],                  <span class="hljs-comment">// å‡½æ•°å‚æ•°ï¼ˆè¿™é‡Œä¸ºç©ºï¼‰</span>
    <span class="hljs-attr">body</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'ReturnStatement'</span>, <span class="hljs-comment">// å‡½æ•°ä½“ï¼šè¿”å›è¯­å¥</span>
        <span class="hljs-attr">return</span>: <span class="hljs-literal">null</span>             <span class="hljs-comment">// è¿”å›å€¼ï¼ˆç¨åå¡«å……ï¼‰</span>
    }
}
</code></pre>
<h4 data-id="heading-23">å‡½æ•°è°ƒç”¨èŠ‚ç‚¹</h4>
<p>æ¥ä¸‹æ¥çœ‹å‡½æ•°ä½“ã€‚<code>return</code> åé¢è·Ÿç€çš„æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯ä¸€ä¸ª <code>h('div', ...)</code> çš„<strong>å‡½æ•°è°ƒç”¨</strong>ã€‚è¦æè¿°ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ï¼š</p>
<ul>
<li>è¢«è°ƒç”¨çš„å‡½æ•°åï¼ˆ<code>h</code>ï¼‰</li>
<li>ä¼ é€’çš„å‚æ•°åˆ—è¡¨ï¼ˆ<code>'div'</code> å’ŒåµŒå¥—çš„ <code>h(...)</code> è°ƒç”¨ï¼‰</li>
</ul>
<p>äºæ˜¯æˆ‘ä»¬å¯ä»¥è®¾è®¡å‡ºè¿™æ ·çš„èŠ‚ç‚¹ç»“æ„ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">CallExp</span> = {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'CallExpression'</span>,      <span class="hljs-comment">// èŠ‚ç‚¹ç±»å‹ï¼šå‡½æ•°è°ƒç”¨è¡¨è¾¾å¼</span>
    <span class="hljs-attr">callee</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'Identifier'</span>,      <span class="hljs-comment">// è¢«è°ƒç”¨çš„å‡½æ•°</span>
        <span class="hljs-attr">name</span>: <span class="hljs-string">'h'</span>
    },
    <span class="hljs-attr">arguments</span>: []                <span class="hljs-comment">// å‚æ•°åˆ—è¡¨ï¼ˆç¨åå¡«å……ï¼‰</span>
}
</code></pre>
<h4 data-id="heading-24">å­—ç¬¦ä¸²å­—é¢é‡èŠ‚ç‚¹</h4>
<p><code>h</code> å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•° <code>'div'</code> æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å­—é¢é‡ï¼Œè¿™ä¹Ÿéœ€è¦ç”¨èŠ‚ç‚¹æ¥æè¿°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">StrLiteral</span> = {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'StringLiteral'</span>,       <span class="hljs-comment">// èŠ‚ç‚¹ç±»å‹ï¼šå­—ç¬¦ä¸²å­—é¢é‡</span>
    <span class="hljs-attr">value</span>: <span class="hljs-string">'div'</span>                 <span class="hljs-comment">// å­—ç¬¦ä¸²çš„å€¼</span>
}
</code></pre>
<h4 data-id="heading-25">å®Œæ•´çš„ JavaScript AST</h4>
<p>ç°åœ¨æˆ‘ä»¬æŠŠè¿™äº›èŠ‚ç‚¹ç»„åˆèµ·æ¥ï¼Œæè¿°å®Œæ•´çš„æ¸²æŸ“å‡½æ•° <code>function render(){ return h('div', h('p', 'Vue')) }</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> jsAST = {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'FunctionDecl'</span>,
    <span class="hljs-attr">id</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">'Identifier'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'render'</span> },
    <span class="hljs-attr">params</span>: [],
    <span class="hljs-attr">body</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'ReturnStatement'</span>,
        <span class="hljs-attr">return</span>: {
            <span class="hljs-attr">type</span>: <span class="hljs-string">'CallExpression'</span>,
            <span class="hljs-attr">callee</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">'Identifier'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'h'</span> },
            <span class="hljs-attr">arguments</span>: [
                { <span class="hljs-attr">type</span>: <span class="hljs-string">'StringLiteral'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'div'</span> },
                <span class="hljs-comment">// ç¬¬äºŒä¸ªå‚æ•°ï¼šåµŒå¥—çš„ h('p', 'Vue') è°ƒç”¨</span>
                {
                    <span class="hljs-attr">type</span>: <span class="hljs-string">'CallExpression'</span>,
                    <span class="hljs-attr">callee</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">'Identifier'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'h'</span> },
                    <span class="hljs-attr">arguments</span>: [
                        { <span class="hljs-attr">type</span>: <span class="hljs-string">'StringLiteral'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'p'</span> },
                        { <span class="hljs-attr">type</span>: <span class="hljs-string">'StringLiteral'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'Vue'</span> }
                    ]
                }
            ]
        }
    }
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒJavaScript AST çš„ç»“æ„å’Œ Template AST éå¸¸ç›¸ä¼¼â€”â€”éƒ½æ˜¯é€šè¿‡<strong>åµŒå¥—çš„èŠ‚ç‚¹</strong>æ¥è¡¨è¾¾ä»£ç çš„å±‚çº§å…³ç³»ã€‚</p>
<p>æœ‰äº†è¿™äº›èŠ‚ç‚¹ç»“æ„çš„å®šä¹‰ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥ç¼–å†™è½¬æ¢å‡½æ•°ï¼Œå°† Template AST è½¬æ¢ä¸ºä¸Šè¿°çš„ JavaScript AST äº†ã€‚</p>
<h4 data-id="heading-26">åˆ›å»º JavaScript AST èŠ‚ç‚¹çš„è¾…åŠ©å‡½æ•°</h4>
<p>åœ¨å®é™…ç¼–å†™è½¬æ¢å‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬ä¼šå‘ç°ä¸€ä¸ªé—®é¢˜ï¼šæ¯æ¬¡åˆ›å»ºèŠ‚ç‚¹éƒ½è¦æ‰‹å†™ä¸€å¤§å † <code>{ type: '...', ... }</code> çš„å¯¹è±¡å­—é¢é‡ï¼Œè€Œè¿™ç§é‡å¤çš„æ´»ï¼Œå°±ç®—æ˜¯å† m çš„ npm ä¹Ÿå—ä¸äº†ï¼Œæ‰€ä»¥å¿…é¡»å°è£…ã€‚</p>
<p>ä¸ºäº†ç®€åŒ–èŠ‚ç‚¹åˆ›å»ºè¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæ¯ç§èŠ‚ç‚¹ç±»å‹ç¼–å†™ä¸€ä¸ªè¾…åŠ©å‡½æ•°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * åˆ›å»ºå­—ç¬¦ä¸²å­—é¢é‡èŠ‚ç‚¹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createStringLiteral</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'StringLiteral'</span>,
        value
    }
}

<span class="hljs-comment">/**
 * åˆ›å»ºæ ‡è¯†ç¬¦èŠ‚ç‚¹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createIdentifier</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'Identifier'</span>,
        name
    }
}

<span class="hljs-comment">/**
 * åˆ›å»ºæ•°ç»„è¡¨è¾¾å¼èŠ‚ç‚¹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createArrayExpression</span>(<span class="hljs-params">elements</span>) {
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'ArrayExpression'</span>,
        elements
    }
}

<span class="hljs-comment">/**
 * åˆ›å»ºå‡½æ•°è°ƒç”¨è¡¨è¾¾å¼èŠ‚ç‚¹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createCallExpression</span>(<span class="hljs-params">callee, <span class="hljs-variable language_">arguments</span></span>) {
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'CallExpression'</span>,
        <span class="hljs-attr">callee</span>: <span class="hljs-title function_">createIdentifier</span>(callee),
        <span class="hljs-variable language_">arguments</span>
    }
}

<span class="hljs-comment">/**
 * åˆ›å»ºè¿”å›è¯­å¥èŠ‚ç‚¹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createReturnStatement</span>(<span class="hljs-params">returnValue</span>) {
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'ReturnStatement'</span>,
        <span class="hljs-attr">return</span>: returnValue
    }
}

<span class="hljs-comment">/**
 * åˆ›å»ºå‡½æ•°å£°æ˜èŠ‚ç‚¹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createFunctionDecl</span>(<span class="hljs-params">id, params, body</span>) {
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'FunctionDecl'</span>,
        <span class="hljs-attr">id</span>: <span class="hljs-title function_">createIdentifier</span>(id),
        params,
        body
    }
}
</code></pre>
<p>æœ‰äº†è¿™äº›è¾…åŠ©å‡½æ•°ï¼Œåˆ›å»ºèŠ‚ç‚¹å°±å˜å¾—ç®€æ´å¤šäº†ã€‚æ¯”å¦‚åˆ›å»º <code>h('div', 'Vue')</code> çš„ ASTï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¹‹å‰çš„å†™æ³•ï¼šç¹çä¸”å®¹æ˜“å‡ºé”™</span>
<span class="hljs-keyword">const</span> callExp = {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'CallExpression'</span>,
    <span class="hljs-attr">callee</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">'Identifier'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'h'</span> },
    <span class="hljs-attr">arguments</span>: [
        { <span class="hljs-attr">type</span>: <span class="hljs-string">'StringLiteral'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'div'</span> },
        { <span class="hljs-attr">type</span>: <span class="hljs-string">'StringLiteral'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'Vue'</span> }
    ]
}

<span class="hljs-comment">// ä½¿ç”¨è¾…åŠ©å‡½æ•°ï¼šç®€æ´æ¸…æ™°</span>
<span class="hljs-keyword">const</span> callExp = <span class="hljs-title function_">createCallExpression</span>(<span class="hljs-string">'h'</span>, [
    <span class="hljs-title function_">createStringLiteral</span>(<span class="hljs-string">'div'</span>),
    <span class="hljs-title function_">createStringLiteral</span>(<span class="hljs-string">'Vue'</span>)
])
</code></pre>
<h4 data-id="heading-27">transformTextï¼šè½¬æ¢æ–‡æœ¬èŠ‚ç‚¹</h4>
<p>æ–‡æœ¬èŠ‚ç‚¹çš„è½¬æ¢ç›¸å¯¹ç®€å•ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">transformText</span>(<span class="hljs-params">node</span>) {
    <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> !== <span class="hljs-string">'Text'</span>) {
        <span class="hljs-keyword">return</span>
    }

    node.<span class="hljs-property">jsNode</span> = <span class="hljs-title function_">createStringLiteral</span>(node.<span class="hljs-property">content</span>)
}
</code></pre>
<p>ä¸ºä»€ä¹ˆæ˜¯æŒ‚è½½åˆ° <code>node.jsNode</code> ä¸Šï¼Ÿè¿™æ˜¯å› ä¸ºï¼š</p>
<ol>
<li><strong>ä¿ç•™åŸå§‹ä¿¡æ¯</strong>ï¼š<code>node</code> æœ¬èº«å­˜å‚¨çš„æ˜¯æ¨¡æ¿ AST çš„ä¿¡æ¯ï¼ˆtypeã€content ç­‰ï¼‰</li>
<li><strong>é™„åŠ è½¬æ¢ç»“æœ</strong>ï¼š<code>node.jsNode</code> å­˜å‚¨çš„æ˜¯è½¬æ¢åçš„ JavaScript AST èŠ‚ç‚¹</li>
</ol>
<p>è¿™ç§è®¾è®¡ä½¿å¾—æ¯ä¸ªèŠ‚ç‚¹éƒ½åŒæ—¶ä¿ç•™äº†ä¸¤ç§ä¿¡æ¯ï¼šåŸå§‹æ¨¡æ¿ä¿¡æ¯å’Œè½¬æ¢åçš„ JavaScript ä»£ç ä¿¡æ¯ã€‚</p>
<h4 data-id="heading-28">transformElementï¼šè½¬æ¢å…ƒç´ èŠ‚ç‚¹</h4>
<p>å…ƒç´ èŠ‚ç‚¹çš„è½¬æ¢è¦å¤æ‚ä¸€äº›ã€‚è¿˜è®°å¾—å‰æ–‡æåˆ°çš„"é€€å‡ºé˜¶æ®µ"å—ï¼Ÿå…ƒç´ èŠ‚ç‚¹å¿…é¡»åœ¨å­èŠ‚ç‚¹å¤„ç†å®Œæˆåæ‰èƒ½è½¬æ¢ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦æŠŠè½¬æ¢åçš„å­èŠ‚ç‚¹ä½œä¸ºå‚æ•°ä¼ é€’ç»™ <code>h()</code> å‡½æ•°ã€‚</p>
<p>æ‰€ä»¥ <code>transformElement</code> éœ€è¦è¿”å›ä¸€ä¸ªé€€å‡ºå‡½æ•°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">transformElement</span>(<span class="hljs-params">node</span>) {
    <span class="hljs-comment">// è¿”å›ä¸€ä¸ªé€€å‡ºå‡½æ•°ï¼Œåœ¨å­èŠ‚ç‚¹å¤„ç†å®Œæˆåæ‰§è¡Œ</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// åªå¤„ç†å…ƒç´ èŠ‚ç‚¹</span>
        <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> !== <span class="hljs-string">'Element'</span>) {
            <span class="hljs-keyword">return</span>
        }

        <span class="hljs-comment">// åˆ›å»º h å‡½æ•°è°ƒç”¨çš„å‚æ•°æ•°ç»„</span>
        <span class="hljs-comment">//  - h('div', h('p', 'Vue'))</span>
        <span class="hljs-keyword">const</span> callArgs = [
            <span class="hljs-title function_">createStringLiteral</span>(node.<span class="hljs-property">tag</span>) <span class="hljs-comment">// ç¬¬ä¸€ä¸ªå‚æ•°ï¼šæ ‡ç­¾åï¼Œå¦‚ï¼šdiv</span>
        ]

        <span class="hljs-comment">// å¤„ç†å­èŠ‚ç‚¹</span>
        <span class="hljs-keyword">if</span> (node.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> === <span class="hljs-number">1</span>) {
            <span class="hljs-comment">// åªæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œç›´æ¥ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°</span>
            <span class="hljs-comment">//  - å› ä¸ºè¿™æ˜¯é€€å‡ºé˜¶æ®µï¼Œæ‰€ä»¥è¿™ä¸ªå­èŠ‚ç‚¹å·²ç»è¢«è½¬æ¢ä¸º JavaScript AST èŠ‚ç‚¹</span>
            callArgs.<span class="hljs-title function_">push</span>(node.<span class="hljs-property">children</span>[<span class="hljs-number">0</span>].<span class="hljs-property">jsNode</span>)
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (node.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">1</span>) {
            <span class="hljs-comment">// å¤šä¸ªå­èŠ‚ç‚¹ï¼ŒåŒ…è£…æˆæ•°ç»„</span>
            callArgs.<span class="hljs-title function_">push</span>(
                <span class="hljs-title function_">createArrayExpression</span>(node.<span class="hljs-property">children</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> child.<span class="hljs-property">jsNode</span>))
            )
        }

        <span class="hljs-comment">// åˆ›å»º h å‡½æ•°è°ƒç”¨èŠ‚ç‚¹</span>
        <span class="hljs-keyword">const</span> callExp = <span class="hljs-title function_">createCallExpression</span>(<span class="hljs-string">'h'</span>, callArgs)

        <span class="hljs-comment">// å°†å½“å‰èŠ‚ç‚¹çš„ jsNode å±æ€§è®¾ç½®ä¸ºåˆ›å»ºçš„å‡½æ•°è°ƒç”¨èŠ‚ç‚¹</span>
        node.<span class="hljs-property">jsNode</span> = callExp
    }
}
</code></pre>
<h4 data-id="heading-29">transformRootï¼šè½¬æ¢æ ¹èŠ‚ç‚¹</h4>
<p>æˆ‘ä»¬è¿˜ç¼ºå°‘äº†æœ€åä¸€å—æ‹¼å›¾ï¼š<strong>å°†æ ¹èŠ‚ç‚¹è½¬æ¢ä¸ºå®Œæ•´çš„ render å‡½æ•°</strong>ã€‚</p>
<p>ç°åœ¨ <code>transformElement</code> åªæ˜¯æŠŠå…ƒç´ è½¬æ¢æˆäº† <code>h()</code> è°ƒç”¨ï¼Œä½†æˆ‘ä»¬çš„æœ€ç»ˆç›®æ ‡æ˜¯ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„å‡½æ•°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">h</span>(<span class="hljs-string">"div"</span>, ...)
}
</code></pre>
<p>æ‰€ä»¥éœ€è¦ä¸€ä¸ª <code>transformRoot</code> å‡½æ•°æ¥å¤„ç†æ ¹èŠ‚ç‚¹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">transformRoot</span>(<span class="hljs-params">node</span>) {
    <span class="hljs-comment">// åŒæ ·è¿”å›é€€å‡ºå‡½æ•°ï¼Œå› ä¸ºéœ€è¦ç­‰æ‰€æœ‰å­èŠ‚ç‚¹éƒ½å¤„ç†å®Œ</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// åªå¤„ç†æ ¹èŠ‚ç‚¹</span>
        <span class="hljs-keyword">if</span> (node.<span class="hljs-property">type</span> !== <span class="hljs-string">'Root'</span>) {
            <span class="hljs-keyword">return</span>
        }

        <span class="hljs-comment">// è·å–æ ¹èŠ‚ç‚¹çš„ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹ï¼ˆé€šå¸¸æ˜¯æœ€å¤–å±‚çš„å…ƒç´ ï¼‰</span>
        <span class="hljs-keyword">const</span> vnodeJSAST = node.<span class="hljs-property">children</span>[<span class="hljs-number">0</span>].<span class="hljs-property">jsNode</span>

        <span class="hljs-comment">// å°†å®ƒåŒ…è£…æˆ return è¯­å¥</span>
        <span class="hljs-comment">//  - return h("div", ...)</span>
        <span class="hljs-keyword">const</span> returnStatement = <span class="hljs-title function_">createReturnStatement</span>(vnodeJSAST)

        <span class="hljs-comment">// å†åŒ…è£…æˆå®Œæ•´çš„å‡½æ•°å£°æ˜</span>
        <span class="hljs-comment">//  - function render() { return h("div", ...) }</span>
        <span class="hljs-keyword">const</span> functionDecl = <span class="hljs-title function_">createFunctionDecl</span>(<span class="hljs-string">'render'</span>, [], [returnStatement])

        <span class="hljs-comment">// å°†å®Œæ•´çš„å‡½æ•°å£°æ˜æŒ‚è½½åˆ°æ ¹èŠ‚ç‚¹çš„ jsNode ä¸Š</span>
        node.<span class="hljs-property">jsNode</span> = functionDecl
    }
}
</code></pre>
<p>è¿™ä¸ªå‡½æ•°åšäº†ä»€ä¹ˆï¼Ÿ</p>
<ol>
<li>å–å‡ºæ ¹èŠ‚ç‚¹ç¬¬ä¸€ä¸ªå­å…ƒç´ çš„ <code>jsNode</code>ï¼ˆä¹Ÿå°±æ˜¯ <code>h("div", ...)</code> è¿™ä¸ª CallExpressionï¼‰</li>
<li>ç”¨ <code>createReturnStatement</code> åŒ…è£…æˆ <code>return h("div", ...)</code></li>
<li>ç”¨ <code>createFunctionDecl</code> åŒ…è£…æˆå®Œæ•´çš„å‡½æ•°å£°æ˜</li>
<li>å°†ç»“æœæŒ‚è½½åˆ°æ ¹èŠ‚ç‚¹çš„ <code>jsNode</code> ä¸Š</li>
</ol>
<h4 data-id="heading-30">å®Œæ•´çš„è½¬æ¢ç¤ºä¾‹</h4>
<p>ç°åœ¨è®©æˆ‘ä»¬æŠŠæ‰€æœ‰éƒ¨åˆ†ç»„åˆèµ·æ¥ï¼Œå®Œæˆä¸€æ¬¡å®Œæ•´çš„è½¬æ¢ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> template = <span class="hljs-string">`&lt;div&gt;&lt;p&gt;Vue&lt;/p&gt;&lt;/div&gt;`</span>

<span class="hljs-comment">// 1. è¯æ³•åˆ†æ + è¯­æ³•åˆ†æï¼Œå¾—åˆ° Template AST</span>
<span class="hljs-keyword">const</span> tokens = <span class="hljs-title function_">tokenizes</span>(template)
<span class="hljs-keyword">const</span> templateAST = <span class="hljs-title function_">parse</span>(tokens)

<span class="hljs-comment">// 2. åˆ›å»ºè½¬æ¢ä¸Šä¸‹æ–‡</span>
<span class="hljs-keyword">const</span> context = {
    <span class="hljs-comment">// æ³¨æ„ï¼štransformRoot å¿…é¡»æ”¾åœ¨æœ€åï¼Œå› ä¸ºå®ƒéœ€è¦ç­‰æ‰€æœ‰å­èŠ‚ç‚¹éƒ½å¤„ç†å®Œ</span>
    <span class="hljs-attr">nodeTransforms</span>: [transformText, transformElement, transformRoot],
    <span class="hljs-attr">currentNode</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">parent</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">childIndex</span>: <span class="hljs-number">0</span>,
    <span class="hljs-title function_">replaceNode</span>(<span class="hljs-params">newNode</span>) {
        context.<span class="hljs-property">parent</span>.<span class="hljs-property">children</span>[context.<span class="hljs-property">childIndex</span>] = newNode
        context.<span class="hljs-property">currentNode</span> = newNode
    },
    <span class="hljs-title function_">removeNode</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">if</span> (context.<span class="hljs-property">parent</span>) {
            context.<span class="hljs-property">parent</span>.<span class="hljs-property">children</span>.<span class="hljs-title function_">splice</span>(context.<span class="hljs-property">childIndex</span>, <span class="hljs-number">1</span>)
            context.<span class="hljs-property">currentNode</span> = <span class="hljs-literal">null</span>
        }
    }
}

<span class="hljs-comment">// 3. æ‰§è¡Œè½¬æ¢</span>
<span class="hljs-title function_">traverseNode</span>(templateAST, context)

<span class="hljs-comment">// 4. æŸ¥çœ‹è½¬æ¢ç»“æœï¼ˆç°åœ¨åº”è¯¥è®¿é—®æ ¹èŠ‚ç‚¹çš„ jsNodeï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(templateAST.<span class="hljs-property">jsNode</span>, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>))
</code></pre>
<p>è¾“å‡ºç»“æœï¼ˆæ ¹èŠ‚ç‚¹çš„ jsNodeï¼Œä¹Ÿå°±æ˜¯å®Œæ•´çš„ JavaScript ASTï¼‰ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"FunctionDecl"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Identifier"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"render"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"body"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ReturnStatement"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"return"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"CallExpression"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"callee"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Identifier"</span><span class="hljs-punctuation">,</span>
                    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"h"</span>
                <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"arguments"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
                    <span class="hljs-punctuation">{</span>
                        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"StringLiteral"</span><span class="hljs-punctuation">,</span>
                        <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"div"</span>
                    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
                    <span class="hljs-punctuation">{</span>
                        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"CallExpression"</span><span class="hljs-punctuation">,</span>
                        <span class="hljs-attr">"callee"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Identifier"</span><span class="hljs-punctuation">,</span>
                            <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"h"</span>
                        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
                        <span class="hljs-attr">"arguments"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
                            <span class="hljs-punctuation">{</span>
                                <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"StringLiteral"</span><span class="hljs-punctuation">,</span>
                                <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"p"</span>
                            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
                            <span class="hljs-punctuation">{</span>
                                <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"StringLiteral"</span><span class="hljs-punctuation">,</span>
                                <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Vue"</span>
                            <span class="hljs-punctuation">}</span>
                        <span class="hljs-punctuation">]</span>
                    <span class="hljs-punctuation">}</span>
                <span class="hljs-punctuation">]</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å®Œç¾ï¼ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªå®Œæ•´çš„ JavaScript ASTï¼Œå®ƒæè¿°äº†ä¸€ä¸ªå®Œæ•´çš„ <code>render</code> å‡½æ•°ã€‚å¯ä»¥çœ‹åˆ°ï¼š</p>
<ul>
<li>æœ€å¤–å±‚æ˜¯ <code>FunctionDecl</code>ï¼ˆå‡½æ•°å£°æ˜ï¼‰</li>
<li>å‡½æ•°åæ˜¯ <code>render</code></li>
<li>å‡½æ•°ä½“æ˜¯ä¸€ä¸ª <code>ReturnStatement</code>ï¼ˆè¿”å›è¯­å¥ï¼‰</li>
<li>è¿”å›å€¼æ˜¯ <code>h()</code> å‡½æ•°è°ƒç”¨</li>
</ul>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†ä» Template AST åˆ° JavaScript AST çš„è½¬æ¢ã€‚ä¸‹ä¸€æ­¥å°±æ˜¯æ ¹æ®è¿™ä¸ª JavaScript AST ç”ŸæˆçœŸæ­£çš„ JavaScript ä»£ç å­—ç¬¦ä¸²äº†ã€‚</p>
<h2 data-id="heading-31">ä»£ç ç”Ÿæˆ</h2>
<p>ä¿—è¯è¯´"è¡Œç™¾é‡Œè€…åŠä¹å"ï¼Œç»è¿‡äº†è¯æ³•åˆ†æã€è¯­æ³•åˆ†æã€è¯­ä¹‰åˆ†æã€AST è½¬æ¢ç­‰ä¸€ç³»åˆ—å¤æ‚çš„æ“ä½œï¼Œæˆ‘ä»¬ç»ˆäºæ¥åˆ°äº†ç¼–è¯‘çš„æœ€åä¸€æ­¥â€”â€”<strong>ä»£ç ç”Ÿæˆ</strong>ã€‚å³å°† JavaScript AST å˜æˆçœŸæ­£çš„ JavaScript ä»£ç å­—ç¬¦ä¸²ã€‚</p>
<p>è€Œä¸ºäº†çœ‹åˆ°æ•°ç»„çš„èŠ‚ç‚¹æƒ…å†µå¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä¼šå¯¹è¿™ä¸ªæ¨¡æ¿åŸä»£ç è¿›è¡Œä¸€äº›æ”¹é€ ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> template = <span class="hljs-string">`&lt;div&gt;&lt;p&gt;Vue&lt;/p&gt;&lt;p&gt;Hello&lt;/p&gt;&lt;/div&gt;`</span>
</code></pre>
<p>å®ƒç”Ÿæˆçš„ JS AST å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"> <span class="hljs-attr">"jsNode"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"FunctionDecl"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Identifier"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"render"</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"body"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
            <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ReturnStatement"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"return"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"CallExpression"</span><span class="hljs-punctuation">,</span>
                    <span class="hljs-attr">"callee"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Identifier"</span><span class="hljs-punctuation">,</span>
                        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"h"</span>
                    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
                    <span class="hljs-attr">"arguments"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
                        <span class="hljs-punctuation">{</span>
                            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"StringLiteral"</span><span class="hljs-punctuation">,</span>
                            <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"div"</span>
                        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
                        <span class="hljs-punctuation">{</span>
                            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ArrayExpression"</span><span class="hljs-punctuation">,</span>
                            <span class="hljs-attr">"elements"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
                                <span class="hljs-punctuation">{</span>
                                    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"CallExpression"</span><span class="hljs-punctuation">,</span>
                                    <span class="hljs-attr">"callee"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                                        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Identifier"</span><span class="hljs-punctuation">,</span>
                                        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"h"</span>
                                    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
                                    <span class="hljs-attr">"arguments"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
                                        <span class="hljs-punctuation">{</span>
                                            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"StringLiteral"</span><span class="hljs-punctuation">,</span>
                                            <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"p"</span>
                                        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
                                        <span class="hljs-punctuation">{</span>
                                            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"StringLiteral"</span><span class="hljs-punctuation">,</span>
                                            <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Vue"</span>
                                        <span class="hljs-punctuation">}</span>
                                    <span class="hljs-punctuation">]</span>
                                <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
                                <span class="hljs-punctuation">{</span>
                                    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"CallExpression"</span><span class="hljs-punctuation">,</span>
                                    <span class="hljs-attr">"callee"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                                        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Identifier"</span><span class="hljs-punctuation">,</span>
                                        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"h"</span>
                                    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
                                    <span class="hljs-attr">"arguments"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
                                        <span class="hljs-punctuation">{</span>
                                            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"StringLiteral"</span><span class="hljs-punctuation">,</span>
                                            <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"p"</span>
                                        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
                                        <span class="hljs-punctuation">{</span>
                                            <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"StringLiteral"</span><span class="hljs-punctuation">,</span>
                                            <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Hello"</span>
                                        <span class="hljs-punctuation">}</span>
                                    <span class="hljs-punctuation">]</span>
                                <span class="hljs-punctuation">}</span>
                            <span class="hljs-punctuation">]</span>
                        <span class="hljs-punctuation">}</span>
                    <span class="hljs-punctuation">]</span>
                <span class="hljs-punctuation">}</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
</code></pre>
<p>é‚£ä¹ˆè¯ä¸å¤šè¯´ï¼Œè®©æˆ‘ä»¬æ­£å¼å¼€å§‹ï¼ŒLet's  Goï¼ï¼ï¼</p>
<h3 data-id="heading-32">å…·ä½“å®ç°-å‰ç½®å‡†å¤‡</h3>
<blockquote>
<p>è¿™ä¸€æ­¥è¦åšçš„äº‹æƒ…ï¼šåˆ›å»º context ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œé‡Œé¢å­˜æ”¾ç”Ÿæˆçš„ä»£ç å­—ç¬¦ä¸²ã€å½“å‰ç¼©è¿›çº§åˆ«ï¼Œä»¥åŠä¸€äº›å¸¸ç”¨çš„è¾…åŠ©æ–¹æ³•ã€‚</p>
</blockquote>
<p>å’Œå‰é¢çš„ <code>transform</code> å‡½æ•°ä¸€æ ·ï¼Œæˆ‘ä»¬çš„ <code>generate</code> å‡½æ•°ä¹Ÿéœ€è¦ä¸€ä¸ª <code>context</code> å¯¹è±¡ã€‚å…ˆæ¥çœ‹çœ‹è¿™ä¸ª context éœ€è¦å“ªäº›ä¸œè¥¿ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">node</span>) {
    <span class="hljs-keyword">const</span> context = {
        <span class="hljs-attr">code</span>: <span class="hljs-string">''</span>,              <span class="hljs-comment">// å­˜æ”¾ç”Ÿæˆçš„ä»£ç å­—ç¬¦ä¸²</span>
        <span class="hljs-attr">currentIndent</span>: <span class="hljs-number">0</span>,      <span class="hljs-comment">// å½“å‰ç¼©è¿›çº§åˆ«</span>
        
        <span class="hljs-comment">// å‘ä»£ç ä¸­æ·»åŠ å†…å®¹</span>
        <span class="hljs-title function_">push</span>(<span class="hljs-params">code</span>) {
            context.<span class="hljs-property">code</span> += code
        },
        
        <span class="hljs-comment">// æ¢è¡Œ</span>
        <span class="hljs-title function_">newLine</span>(<span class="hljs-params"/>) {
          	<span class="hljs-comment">// é»˜è®¤ä»¥ä¸¤ä¸ªç©ºæ ¼ä¸ºç¼©è¿›æ ‡å‡†</span>
            context.<span class="hljs-property">code</span> += <span class="hljs-string">'\n'</span> + <span class="hljs-string">'  '</span>.<span class="hljs-title function_">repeat</span>(context.<span class="hljs-property">currentIndent</span>)
        },
        
        <span class="hljs-comment">// å¢åŠ ç¼©è¿›</span>
        <span class="hljs-title function_">indent</span>(<span class="hljs-params"/>) {
            context.<span class="hljs-property">currentIndent</span>++
            context.<span class="hljs-title function_">newLine</span>()
        },
        
        <span class="hljs-comment">// å‡å°‘ç¼©è¿›</span>
        <span class="hljs-title function_">deIndent</span>(<span class="hljs-params"/>) {
            context.<span class="hljs-property">currentIndent</span>--
            context.<span class="hljs-title function_">newLine</span>()
        }
    }
    
    <span class="hljs-keyword">return</span> context
}
</code></pre>
<p>è¿™éƒ¨åˆ†ä»£ç æˆ‘ç›¸ä¿¡è¿˜æ˜¯å¾ˆå®¹æ˜“çœ‹æ‡‚ï¼Œæœ‰äº†è¿™äº›å·¥å…·æ–¹æ³•ï¼Œåé¢ç”Ÿæˆä»£ç å°±æ–¹ä¾¿å¤šäº†ã€‚æ¯”å¦‚è¦ç”Ÿæˆä¸€ä¸ªå‡½æ•°ï¼š</p>
<pre><code class="hljs language-js" lang="js">context.<span class="hljs-title function_">push</span>(<span class="hljs-string">'function render() {'</span>)
context.<span class="hljs-title function_">indent</span>()              <span class="hljs-comment">// è¿›å…¥å‡½æ•°ä½“ï¼Œç¼©è¿› +1</span>
context.<span class="hljs-title function_">push</span>(<span class="hljs-string">'return h("div")'</span>)
context.<span class="hljs-title function_">deIndent</span>()            <span class="hljs-comment">// é€€å‡ºå‡½æ•°ä½“ï¼Œç¼©è¿› -1</span>
context.<span class="hljs-title function_">push</span>(<span class="hljs-string">'}'</span>)
</code></pre>
<p>ç”Ÿæˆçš„ä»£ç å°±ç»“æœä¸ºï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">h</span>(<span class="hljs-string">"div"</span>)
}
</code></pre>
<h3 data-id="heading-33">å…·ä½“å®ç°-genNode</h3>
<p>æˆ‘ä»¬ç®€å•æ€è€ƒä¸€ä¸‹ï¼Œå°±å¯ä»¥çŒœå‡ºï¼Œå¤„ç†æ¯ä¸ªèŠ‚ç‚¹ç”Ÿæˆä¸åŒçš„å­—ç¬¦ä»£ç ï¼Œè‚¯å®šä¼šæœ‰ä¸å°çš„ç¯‡å¹…ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æå–å‡ºå»ï¼Œåœ¨ genNode ä¸­å¤„ç†ï¼Œè°ƒç”¨å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">node</span>) {
  	<span class="hljs-comment">// çœç•¥ context</span>
  
  	<span class="hljs-title function_">genNode</span>(node, context)	
  
  	<span class="hljs-keyword">return</span> context
}
</code></pre>
<p>okï¼Œç°åœ¨æˆ‘ä»¬çš„é‡å¿ƒå°±ä¸“æ³¨äº genNode è¿™ä¸ªå‡½æ•°ï¼Œé‚£å®ƒåº”è¯¥å¦‚ä½•å®ç°ï¼Ÿ</p>
<p>æˆ‘ä»¬ä¹‹å‰è®¾è®¡çš„ JavaScript AST ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ª <code>type</code> å­—æ®µæ¥æ ‡è¯†å®ƒçš„ç±»å‹ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li><code>StringLiteral</code>ï¼šå­—ç¬¦ä¸²å­—é¢é‡</li>
<li><code>Identifier</code>ï¼šæ ‡è¯†ç¬¦</li>
<li><code>CallExpression</code>ï¼šå‡½æ•°è°ƒç”¨è¡¨è¾¾å¼</li>
<li><code>ArrayExpression</code>ï¼šæ•°ç»„è¡¨è¾¾å¼</li>
<li><code>FunctionDecl</code>ï¼šå‡½æ•°å£°æ˜</li>
</ul>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œç”¨ <code>switch</code> è¯­å¥æ ¹æ®ä¸åŒçš„ <code>type</code> æ¥åˆ†åˆ«å¤„ç†ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">genNode</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">switch</span> (node.<span class="hljs-property">type</span>) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'FunctionDecl'</span>:
            <span class="hljs-title function_">genFunctionDecl</span>(node, context)
            <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">'ReturnStatement'</span>:
            <span class="hljs-title function_">genReturnStatement</span>(node, context)
            <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">'CallExpression'</span>:
            <span class="hljs-title function_">genCallExpression</span>(node, context)
            <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">'StringLiteral'</span>:
            <span class="hljs-title function_">genStringLiteral</span>(node, context)
            <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">'ArrayExpression'</span>:
            <span class="hljs-title function_">genArrayExpression</span>(node, context)
            <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">'Identifier'</span>:
            <span class="hljs-title function_">genIdentifier</span>(node, context)
            <span class="hljs-keyword">break</span>
    }
}
</code></pre>
<p>ç°åœ¨ç»“æ„æ­å»ºå¥½äº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯é€æ­¥å®ç°è¿™äº›å¤„ç†ä¸åŒèŠ‚ç‚¹çš„å¤„ç†å‡½æ•°ã€‚</p>
<h3 data-id="heading-34">å…·ä½“å®ç°-å¤„ç†ç®€å•èŠ‚ç‚¹</h3>
<p>æˆ‘ä»¬å…ˆä»æœ€ç®€å•çš„å¼€å§‹ï¼š<strong>å­—ç¬¦ä¸²å­—é¢é‡</strong>ï¼ˆStringLiteralï¼‰å’Œ<strong>æ ‡è¯†ç¬¦</strong>ï¼ˆIdentifierï¼‰ã€‚</p>
<h4 data-id="heading-35">genStringLiteral - å¤„ç†å­—ç¬¦ä¸²å­—é¢é‡</h4>
<p>å­—ç¬¦ä¸²å­—é¢é‡æ˜¯ä»€ä¹ˆï¼Ÿæ¯”å¦‚ <code>"Vue"</code>ã€<code>"div"</code> è¿™äº›å¸¦å¼•å·çš„å­—ç¬¦ä¸²ã€‚å¤„ç†èµ·æ¥éå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨å€¼çš„ä¸¤è¾¹åŠ ä¸Šå¼•å·å°±è¡Œäº†ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">genStringLiteral</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-comment">// å­—ç¬¦ä¸²å­—é¢é‡ï¼šåŠ ä¸ŠåŒå¼•å·</span>
    context.<span class="hljs-title function_">push</span>(<span class="hljs-string">`"<span class="hljs-subst">${node.value}</span>"`</span>)
}
</code></pre>
<p>æ¯”å¦‚é‡åˆ°è¿™ä¸ªèŠ‚ç‚¹ï¼š</p>
<pre><code class="hljs language-js" lang="js">{
    <span class="hljs-attr">type</span>: <span class="hljs-string">'StringLiteral'</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-string">'Vue'</span>
}
</code></pre>
<p>å°±ä¼šç”Ÿæˆä»£ç ï¼š<code>"Vue"</code></p>
<h4 data-id="heading-36">genIdentifier - å¤„ç†æ ‡è¯†ç¬¦</h4>
<p>æ ‡è¯†ç¬¦æ˜¯ä»€ä¹ˆï¼Ÿå°±æ˜¯å˜é‡åã€å‡½æ•°åè¿™äº›ï¼Œæ¯”å¦‚ <code>h</code>ã€<code>render</code> ç­‰ã€‚å¤„ç†èµ·æ¥æ›´ç®€å•ï¼Œç›´æ¥è¾“å‡ºåå­—å°±è¡Œï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">genIdentifier</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-comment">// æ ‡è¯†ç¬¦ï¼šç›´æ¥è¾“å‡ºåå­—</span>
    context.<span class="hljs-title function_">push</span>(node.<span class="hljs-property">name</span>)
}
</code></pre>
<p>æ¯”å¦‚é‡åˆ°è¿™ä¸ªèŠ‚ç‚¹ï¼š</p>
<pre><code class="hljs language-js" lang="js">{
    <span class="hljs-attr">type</span>: <span class="hljs-string">'Identifier'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'h'</span>
}
</code></pre>
<p>å°±ä¼šç”Ÿæˆä»£ç ï¼š<code>h</code></p>
<h3 data-id="heading-37">å…·ä½“å®ç°-genArrayExpression</h3>
<p>æ•°ç»„è¡¨è¾¾å¼ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œå®ç°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">genArrayExpression</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">const</span> { push } = context
    
    <span class="hljs-comment">// è¾“å‡ºå·¦æ–¹æ‹¬å·</span>
    <span class="hljs-title function_">push</span>(<span class="hljs-string">'['</span>)
    
    <span class="hljs-comment">// å¤„ç†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ </span>
    <span class="hljs-keyword">const</span> { elements } = node
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; elements.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-comment">// é€’å½’å¤„ç†æ¯ä¸ªå…ƒç´ </span>
        <span class="hljs-title function_">genNode</span>(elements[i], context)
        
        <span class="hljs-comment">// å¦‚æœä¸æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ï¼Œæ·»åŠ é€—å·å’Œç©ºæ ¼</span>
        <span class="hljs-keyword">if</span> (i &lt; elements.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>) {
            <span class="hljs-title function_">push</span>(<span class="hljs-string">', '</span>)
        }
    }
    
    <span class="hljs-comment">// è¾“å‡ºå³æ–¹æ‹¬å·</span>
    <span class="hljs-title function_">push</span>(<span class="hljs-string">']'</span>)
}
</code></pre>
<p>æ¯”å¦‚é‡åˆ°è¿™æ ·çš„èŠ‚ç‚¹ï¼š</p>
<pre><code class="hljs language-js" lang="js">{
    <span class="hljs-attr">type</span>: <span class="hljs-string">'ArrayExpression'</span>,
    <span class="hljs-attr">elements</span>: [
        { <span class="hljs-attr">type</span>: <span class="hljs-string">'StringLiteral'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'Vue'</span> },
        { <span class="hljs-attr">type</span>: <span class="hljs-string">'StringLiteral'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'Hello'</span> }
    ]
}
</code></pre>
<p>å°±ä¼šç”Ÿæˆä»£ç ï¼š<code>["Vue", "Hello"]</code></p>
<h3 data-id="heading-38">å…·ä½“å®ç°-genCallExpression</h3>
<p><strong>å‡½æ•°è°ƒç”¨è¡¨è¾¾å¼</strong>ï¼ˆCallExpressionï¼‰ï¼Œä¹Ÿå°±æ˜¯ç±»ä¼¼äº <code>h("div", ...)</code> è¿™æ ·çš„å‡½æ•°è°ƒç”¨ã€‚</p>
<p>å‡½æ•°è°ƒç”¨ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š<strong>å‡½æ•°å</strong>ï¼ˆcalleeï¼‰å’Œ<strong>å‚æ•°åˆ—è¡¨</strong>ï¼ˆargumentsï¼‰ã€‚å®ç°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">genCallExpression</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">const</span> { push } = context
    <span class="hljs-keyword">const</span> { callee, <span class="hljs-attr">arguments</span>: args } = node
    
    <span class="hljs-comment">// å…ˆå¤„ç†å‡½æ•°å</span>
    <span class="hljs-comment">// - æˆ‘ä»¬å®Œå…¨æ˜ç™½ callee æ˜¯ä¸€ä¸ªä»€ä¹ˆèŠ‚ç‚¹ï¼Œæ‰€ä»¥å¯ä»¥æ”¾å¿ƒçš„å»å¤ç”¨</span>
    <span class="hljs-title function_">genNode</span>(callee, context)
    
    <span class="hljs-comment">// è¾“å‡ºå·¦æ‹¬å·</span>
    <span class="hljs-title function_">push</span>(<span class="hljs-string">'('</span>)
    
    <span class="hljs-comment">// å¤„ç†å‚æ•°åˆ—è¡¨</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; args.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-comment">// é€’å½’å¤„ç†æ¯ä¸ªå‚æ•°</span>
        <span class="hljs-title function_">genNode</span>(args[i], context)
        
        <span class="hljs-comment">// å¦‚æœä¸æ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼Œæ·»åŠ é€—å·å’Œç©ºæ ¼</span>
        <span class="hljs-keyword">if</span> (i &lt; args.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>) {
            <span class="hljs-title function_">push</span>(<span class="hljs-string">', '</span>)
        }
    }
    
    <span class="hljs-comment">// è¾“å‡ºå³æ‹¬å·</span>
    <span class="hljs-title function_">push</span>(<span class="hljs-string">')'</span>)
}
</code></pre>
<p>æ¯”å¦‚é‡åˆ°è¿™æ ·çš„èŠ‚ç‚¹ï¼š</p>
<pre><code class="hljs language-js" lang="js">{
    <span class="hljs-attr">type</span>: <span class="hljs-string">'CallExpression'</span>,
    <span class="hljs-attr">callee</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">'Identifier'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'h'</span> },
    <span class="hljs-attr">arguments</span>: [
        { <span class="hljs-attr">type</span>: <span class="hljs-string">'StringLiteral'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'div'</span> },
        { <span class="hljs-attr">type</span>: <span class="hljs-string">'StringLiteral'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'Vue'</span> }
    ]
}
</code></pre>
<p>å°±ä¼šç”Ÿæˆä»£ç ï¼š<code>h("div", "Vue")</code></p>
<h3 data-id="heading-39">å…·ä½“å®ç°-å¤„ç†å‡½æ•°å£°æ˜å’Œè¿”å›è¯­å¥</h3>
<p>æœ€åï¼Œæˆ‘ä»¬æ¥å¤„ç†<strong>å‡½æ•°å£°æ˜</strong>ï¼ˆFunctionDeclï¼‰å’Œ<strong>è¿”å›è¯­å¥</strong>ï¼ˆReturnStatementï¼‰ã€‚è¿™ä¸¤ä¸ªä¼šæ¶‰åŠåˆ°æ¢è¡Œå’Œç¼©è¿›ã€‚</p>
<h4 data-id="heading-40">genFunctionDecl - å¤„ç†å‡½æ•°å£°æ˜</h4>
<p>å‡½æ•°å£°æ˜æ˜¯æœ€å¤æ‚çš„ï¼Œå› ä¸ºå®ƒåŒ…å«ï¼šå‡½æ•°åã€å‚æ•°åˆ—è¡¨ã€å‡½æ•°ä½“ï¼Œè€Œä¸”éœ€è¦æ¢è¡Œå’Œç¼©è¿›ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">genFunctionDecl</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">const</span> { push, indent, deIndent } = context
    <span class="hljs-keyword">const</span> { id, params, body } = node
    
    <span class="hljs-comment">// ç”Ÿæˆå‡½æ•°ç­¾åï¼šfunction å‡½æ•°å(å‚æ•°åˆ—è¡¨) {</span>
    <span class="hljs-title function_">push</span>(<span class="hljs-string">'function '</span>)
    <span class="hljs-title function_">genNode</span>(id, context)
    <span class="hljs-title function_">push</span>(<span class="hljs-string">'('</span>)
    
    <span class="hljs-comment">// å¤„ç†å‚æ•°åˆ—è¡¨ï¼ˆè¿™é‡Œæˆ‘ä»¬çš„ç¤ºä¾‹æ²¡æœ‰å‚æ•°ï¼Œæ‰€ä»¥ç•™ç©ºï¼‰</span>
    <span class="hljs-keyword">if</span> (params &amp;&amp; params.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; params.<span class="hljs-property">length</span>; i++) {
            <span class="hljs-title function_">genNode</span>(params[i], context)
            <span class="hljs-keyword">if</span> (i &lt; params.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>) {
                <span class="hljs-title function_">push</span>(<span class="hljs-string">', '</span>)
            }
        }
    }
    
    <span class="hljs-title function_">push</span>(<span class="hljs-params"><span class="hljs-string">') {'</span></span>)
    
    <span class="hljs-comment">// å‡½æ•°ä½“ï¼šéœ€è¦ç¼©è¿›</span>
    <span class="hljs-title function_">indent</span>()
    
    <span class="hljs-comment">// å¤„ç†å‡½æ•°ä½“ä¸­çš„è¯­å¥ï¼ˆé€šå¸¸æ˜¯è¿”å›è¯­å¥ï¼‰</span>
    body.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">statement</span> =&gt;</span> {
        <span class="hljs-title function_">genNode</span>(statement, context)
    })
    
    <span class="hljs-comment">// é€€å‡ºå‡½æ•°ä½“ï¼šå‡å°‘ç¼©è¿›</span>
    <span class="hljs-title function_">deIndent</span>()
    <span class="hljs-title function_">push</span>(<span class="hljs-string">'}'</span>)
}
</code></pre>
<h4 data-id="heading-41">genReturnStatement - å¤„ç†è¿”å›è¯­å¥</h4>
<p>è¿”å›è¯­å¥ç›¸å¯¹ç®€å•ï¼Œå°±æ˜¯ <code>return</code> å…³é”®å­— + è¿”å›å€¼ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">genReturnStatement</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">const</span> { push } = context
    
    <span class="hljs-comment">// è¾“å‡º return å…³é”®å­—</span>
    <span class="hljs-title function_">push</span>(<span class="hljs-string">'return '</span>)
    
    <span class="hljs-comment">// å¤„ç†è¿”å›å€¼</span>
    <span class="hljs-title function_">genNode</span>(node.<span class="hljs-property">return</span>, context)
}
</code></pre>
<p>æ¯”å¦‚é‡åˆ°è¿™æ ·çš„èŠ‚ç‚¹ï¼š</p>
<pre><code class="hljs language-js" lang="js">{
    <span class="hljs-attr">type</span>: <span class="hljs-string">'ReturnStatement'</span>,
    <span class="hljs-attr">return</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'CallExpression'</span>,
        <span class="hljs-attr">callee</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">'Identifier'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'h'</span> },
        <span class="hljs-attr">arguments</span>: [
            { <span class="hljs-attr">type</span>: <span class="hljs-string">'StringLiteral'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'div'</span> }
        ]
    }
}
</code></pre>
<p>å°±ä¼šç”Ÿæˆä»£ç ï¼š<code>return h("div")</code></p>
<h3 data-id="heading-42">å…·ä½“å®ç°-å®Œæ•´æµ‹è¯•</h3>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬æŠŠæ‰€æœ‰ä»£ç ç»„åˆèµ·æ¥ï¼Œå®Œæ•´çš„ <code>generate</code> å‡½æ•°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">node</span>) {
    <span class="hljs-keyword">const</span> context = {
        <span class="hljs-attr">code</span>: <span class="hljs-string">''</span>,
        <span class="hljs-attr">currentIndent</span>: <span class="hljs-number">0</span>,
        
        <span class="hljs-title function_">push</span>(<span class="hljs-params">code</span>) {
            context.<span class="hljs-property">code</span> += code
        },
        
        <span class="hljs-title function_">newLine</span>(<span class="hljs-params"/>) {
            context.<span class="hljs-property">code</span> += <span class="hljs-string">'\n'</span> + <span class="hljs-string">'  '</span>.<span class="hljs-title function_">repeat</span>(context.<span class="hljs-property">currentIndent</span>)
        },
        
        <span class="hljs-title function_">indent</span>(<span class="hljs-params"/>) {
            context.<span class="hljs-property">currentIndent</span>++
            context.<span class="hljs-title function_">newLine</span>()
        },
        
        <span class="hljs-title function_">deIndent</span>(<span class="hljs-params"/>) {
            context.<span class="hljs-property">currentIndent</span>--
            context.<span class="hljs-title function_">newLine</span>()
        }
    }
    
    <span class="hljs-comment">// ç”Ÿæˆä»£ç </span>
    <span class="hljs-title function_">genNode</span>(node, context)
    
    <span class="hljs-comment">// è¿”å›ç”Ÿæˆçš„ä»£ç å­—ç¬¦ä¸²</span>
    <span class="hljs-keyword">return</span> context.<span class="hljs-property">code</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">genNode</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">switch</span> (node.<span class="hljs-property">type</span>) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'FunctionDecl'</span>:
            <span class="hljs-title function_">genFunctionDecl</span>(node, context)
            <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">'ReturnStatement'</span>:
            <span class="hljs-title function_">genReturnStatement</span>(node, context)
            <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">'CallExpression'</span>:
            <span class="hljs-title function_">genCallExpression</span>(node, context)
            <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">'StringLiteral'</span>:
            <span class="hljs-title function_">genStringLiteral</span>(node, context)
            <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">'ArrayExpression'</span>:
            <span class="hljs-title function_">genArrayExpression</span>(node, context)
            <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">'Identifier'</span>:
            <span class="hljs-title function_">genIdentifier</span>(node, context)
            <span class="hljs-keyword">break</span>
    }
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">genStringLiteral</span>(<span class="hljs-params">node, context</span>) {
    context.<span class="hljs-title function_">push</span>(<span class="hljs-string">`"<span class="hljs-subst">${node.value}</span>"`</span>)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">genIdentifier</span>(<span class="hljs-params">node, context</span>) {
    context.<span class="hljs-title function_">push</span>(node.<span class="hljs-property">name</span>)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">genArrayExpression</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">const</span> { push } = context
    <span class="hljs-title function_">push</span>(<span class="hljs-string">'['</span>)
    
    <span class="hljs-keyword">const</span> { elements } = node
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; elements.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-title function_">genNode</span>(elements[i], context)
        <span class="hljs-keyword">if</span> (i &lt; elements.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>) {
            <span class="hljs-title function_">push</span>(<span class="hljs-string">', '</span>)
        }
    }
    
    <span class="hljs-title function_">push</span>(<span class="hljs-string">']'</span>)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">genCallExpression</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">const</span> { push } = context
    <span class="hljs-keyword">const</span> { callee, <span class="hljs-attr">arguments</span>: args } = node
    
    <span class="hljs-title function_">genNode</span>(callee, context)
    <span class="hljs-title function_">push</span>(<span class="hljs-string">'('</span>)
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; args.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-title function_">genNode</span>(args[i], context)
        <span class="hljs-keyword">if</span> (i &lt; args.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>) {
            <span class="hljs-title function_">push</span>(<span class="hljs-string">', '</span>)
        }
    }
    
    <span class="hljs-title function_">push</span>(<span class="hljs-string">')'</span>)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">genFunctionDecl</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">const</span> { push, indent, deIndent } = context
    <span class="hljs-keyword">const</span> { id, params, body } = node
    
    <span class="hljs-title function_">push</span>(<span class="hljs-string">'function '</span>)
    <span class="hljs-title function_">genNode</span>(id, context)
    <span class="hljs-title function_">push</span>(<span class="hljs-string">'('</span>)
    
    <span class="hljs-keyword">if</span> (params &amp;&amp; params.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; params.<span class="hljs-property">length</span>; i++) {
            <span class="hljs-title function_">genNode</span>(params[i], context)
            <span class="hljs-keyword">if</span> (i &lt; params.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>) {
                <span class="hljs-title function_">push</span>(<span class="hljs-string">', '</span>)
            }
        }
    }
    
    <span class="hljs-title function_">push</span>(<span class="hljs-params"><span class="hljs-string">') {'</span></span>)
    <span class="hljs-title function_">indent</span>()
    
    body.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">statement</span> =&gt;</span> {
        <span class="hljs-title function_">genNode</span>(statement, context)
    })
    
    <span class="hljs-title function_">deIndent</span>()
    <span class="hljs-title function_">push</span>(<span class="hljs-string">'}'</span>)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">genReturnStatement</span>(<span class="hljs-params">node, context</span>) {
    <span class="hljs-keyword">const</span> { push } = context
    <span class="hljs-title function_">push</span>(<span class="hljs-string">'return '</span>)
    <span class="hljs-title function_">genNode</span>(node.<span class="hljs-property">return</span>, context)
}
</code></pre>
<p>ç°åœ¨è®©æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ã€‚æŠŠæ•´ä¸ªæµç¨‹ä¸²èµ·æ¥ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> template = <span class="hljs-string">`&lt;div&gt;&lt;p&gt;Vue&lt;/p&gt;&lt;p&gt;Hello&lt;/p&gt;&lt;/div&gt;`</span>

<span class="hljs-comment">// 1. è¯æ³•åˆ†æ + è¯­æ³•åˆ†æ</span>
<span class="hljs-keyword">const</span> templateAST = <span class="hljs-title function_">parse</span>(template)

<span class="hljs-comment">// 2. AST è½¬æ¢</span>
<span class="hljs-keyword">const</span> context = {
    <span class="hljs-attr">nodeTransforms</span>: [transformText, transformElement, transformRoot],
    <span class="hljs-attr">currentNode</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">parent</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">childIndex</span>: <span class="hljs-number">0</span>
}
<span class="hljs-title function_">traverseNode</span>(templateAST, context)

<span class="hljs-comment">// 3. ä»£ç ç”Ÿæˆ</span>
<span class="hljs-keyword">const</span> code = <span class="hljs-title function_">generate</span>(templateAST.<span class="hljs-property">jsNode</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(code)
</code></pre>
<p>è¾“å‡ºç»“æœï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">h</span>(<span class="hljs-string">"div"</span>, [<span class="hljs-title function_">h</span>(<span class="hljs-string">"p"</span>, <span class="hljs-string">"Vue"</span>), <span class="hljs-title function_">h</span>(<span class="hljs-string">"p"</span>, <span class="hljs-string">"Hello"</span>)])
}
</code></pre>
<p>æŸ¥çœ‹ç»“æœï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸåœ°æŠŠ JavaScript AST è½¬æ¢æˆäº†çœŸæ­£çš„ JavaScript ä»£ç å­—ç¬¦ä¸²ï¼</p>
<p>è‡³æ­¤ï¼Œæ•´ä¸ª Vue ç¼–è¯‘æµç¨‹å°±å…¨éƒ¨å®Œæˆäº†ï¼š</p>
<ol>
<li><strong>è¯æ³•åˆ†æ</strong>ï¼šæ¨¡æ¿å­—ç¬¦ä¸² â†’ tokens æ•°ç»„</li>
<li><strong>è¯­æ³•åˆ†æ</strong>ï¼štokens æ•°ç»„ â†’ Template AST</li>
<li><strong>è¯­ä¹‰åˆ†æå’Œè½¬æ¢</strong>ï¼šTemplate AST â†’ JavaScript ASTï¼ˆåŒ…æ‹¬ transformRoot å°†æ ¹èŠ‚ç‚¹åŒ…è£…ä¸ºå‡½æ•°ï¼‰</li>
<li><strong>ä»£ç ç”Ÿæˆ</strong>ï¼šJavaScript AST â†’ JavaScript ä»£ç å­—ç¬¦ä¸²</li>
</ol>
<p>ä» <code>&lt;div&gt;&lt;p&gt;Vue&lt;/p&gt;&lt;p&gt;Hello&lt;/p&gt;&lt;/div&gt;</code> åˆ° <code>function render() { return h("div", [h("p", "Vue"), h("p", "Hello")]) }</code>ï¼Œè¿™å°±æ˜¯ Vue æ¨¡æ¿ç¼–è¯‘çš„æ•´ä¸ªè¿‡ç¨‹ï¼</p>
<h2 data-id="heading-43">ç»“è¯­</h2>
<p>ä¿—è¯è¯´"ä¸‡ä¸ˆé«˜æ¥¼å¹³åœ°èµ·"ï¼Œé€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ä»é›¶å¼€å§‹ï¼Œä¿®å»ºäº†ä¸€æ‰€è‡ªå·±çš„ â€œVue ç¼–è¯‘å°å±‹â€ã€‚æ•´ä¸ªå®ç°ï¼Œéº»é›€è™½å°ï¼Œäº”è„ä¿±å…¨â€”â€”è¯æ³•åˆ†æã€è¯­æ³•åˆ†æã€AST è½¬æ¢ã€ä»£ç ç”Ÿæˆï¼Œè¯¥æœ‰çš„éƒ½æœ‰äº†ã€‚æˆ‘ä»¬å¯ä»¥è¯´ä¸€å¥ï¼šâ€œæˆ‘ç°åœ¨ä»€ä¹ˆéƒ½ä¸ç¼ºäº†â€ã€‚</p>
<p>ä¸è¿‡ï¼Œéœ€è¦ç‰¹åˆ«è¯´æ˜çš„æ˜¯ï¼š<strong>è¿™åªæ˜¯ä¸€ä¸ªæœ€å°åŒ–çš„å®ç°æ¡ˆä¾‹</strong>ï¼Œæ—¨åœ¨å¸®åŠ©å¤§å®¶ç†è§£ç¼–è¯‘çš„æ ¸å¿ƒåŸç†å’Œæµç¨‹ã€‚çœŸå®çš„ Vue ç¼–è¯‘å™¨è¦å¤æ‚å¾—å¤šï¼Œè¿˜æœ‰å¤§é‡çš„ ec æ²¡æœ‰å¤„ç†ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li><strong>å±æ€§å¤„ç†</strong>ï¼šclassã€styleã€è‡ªå®šä¹‰å±æ€§ã€åŠ¨æ€å±æ€§...</li>
<li><strong>æŒ‡ä»¤ç³»ç»Ÿ</strong>ï¼šv-ifã€v-forã€v-modelã€v-bindã€v-on...</li>
<li><strong>æ’å€¼è¡¨è¾¾å¼</strong>ï¼š<code>{{ msg }}</code>ã€<code>{{ count + 1 }}</code>...</li>
<li><strong>äº‹ä»¶å¤„ç†</strong>ï¼š@clickã€@inputã€ä¿®é¥°ç¬¦...</li>
<li><strong>æ’æ§½ç³»ç»Ÿ</strong>ï¼šå…·åæ’æ§½ã€ä½œç”¨åŸŸæ’æ§½...</li>
<li><strong>ç»„ä»¶å¤„ç†</strong>ï¼šç»„ä»¶è¯†åˆ«ã€props ä¼ é€’...</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šè¯­æ³•é”™è¯¯æç¤ºã€ä½ç½®ä¿¡æ¯...</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šé™æ€æå‡ã€ç¼“å­˜ä¼˜åŒ–...</li>
</ul>
<p>æ¯ä¸€ä¸ªç‰¹æ€§èƒŒåéƒ½æœ‰å¤§é‡çš„å®ç°ç»†èŠ‚ï¼ŒçœŸå®çš„ç¼–è¯‘å™¨ä»£ç é‡å¯èƒ½æ˜¯è¿™ä¸ªç¤ºä¾‹çš„å‡ åå€ç”šè‡³ä¸Šç™¾å€ã€‚</p>
<p>ä½†æ­£å¦‚å¤äººæ‰€è¨€ï¼š"ä¸ç§¯è·¬æ­¥ï¼Œæ— ä»¥è‡³åƒé‡Œ"ã€‚ç†è§£äº†è¿™ä¸ªæœ€å°å®ç°ï¼Œä½ å°±æŒæ¡äº†ç¼–è¯‘å™¨çš„æ ¸å¿ƒæ€æƒ³ã€‚å½“ä½ å†å»é˜…è¯» Vue æºç æ—¶ï¼Œå°±ä¸ä¼šè§‰å¾—é‚£ä¹ˆæ™¦æ¶©éš¾æ‡‚äº†ï¼Œå› ä¸ºä½ å·²ç»çŸ¥é“äº†å®ƒçš„"éª¨æ¶"æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œå‰©ä¸‹çš„åªæ˜¯"è¡€è‚‰"çš„ä¸°æ»¡è€Œå·²ã€‚</p>
<p>æœ€åçš„æœ€åï¼Œ"çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œç»çŸ¥æ­¤äº‹è¦èº¬è¡Œ" â€”â€” å¦‚æœä½ çœŸçš„æƒ³æ·±å…¥ç†è§£ï¼Œå»ºè®®åŠ¨æ‰‹å®ç°ä¸€éï¼Œè¿™æ¯”å•çº¯é˜…è¯»è¦æœ‰æ•ˆå¾—å¤šã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®ä½ æ­å¼€ç¼–è¯‘çš„ç¥ç§˜é¢çº±ï¼Œè®©ä½ åœ¨å‰ç«¯è¿›é˜¶çš„é“è·¯ä¸Šæ›´è¿›ä¸€æ­¥ï¼ŒåŠ æ²¹ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ClaudeæŠ€èƒ½ï¼šçœŸæ­£è§£å†³å®é™…é—®é¢˜çš„AIåŠŸèƒ½]]></title>    <link>https://juejin.cn/post/7586971886589919275</link>    <guid>https://juejin.cn/post/7586971886589919275</guid>    <pubDate>2025-12-24T02:08:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586971886589919275" data-draft-id="7586971886589902891" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ClaudeæŠ€èƒ½ï¼šçœŸæ­£è§£å†³å®é™…é—®é¢˜çš„AIåŠŸèƒ½"/> <meta itemprop="keywords" content="OpenAI,AIGC,Agent"/> <meta itemprop="datePublished" content="2025-12-24T02:08:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å®‰æ€æ´¾Anspire"/> <meta itemprop="url" content="https://juejin.cn/user/3044964115417419"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ClaudeæŠ€èƒ½ï¼šçœŸæ­£è§£å†³å®é™…é—®é¢˜çš„AIåŠŸèƒ½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3044964115417419/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å®‰æ€æ´¾Anspire
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T02:08:38.000Z" title="Wed Dec 24 2025 02:08:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Anthropicæ‚„æ‚„å‘å¸ƒäº†å¯èƒ½æ˜¯2025å¹´æœ€å®ç”¨çš„AIåŠŸèƒ½ã€‚å®ƒä¸æ˜¯æ›´åä¸½çš„æ¨¡å‹æˆ–æ›´å¥½çš„åŸºå‡†æµ‹è¯•ã€‚å®ƒæ›´ç®€å•ï¼šä¸€ç§æ— éœ€ç¼–å†™ä¸€è¡Œä»£ç å°±èƒ½è®©Claudeå­¦ä¹ ä½ ç‰¹å®šå·¥ä½œæµç¨‹çš„æ–¹æ³•ã€‚</p>
<p>ä»–ä»¬ç§°ä¹‹ä¸ºæŠ€èƒ½ã€‚è¿™å¯èƒ½æ¯”å»å¹´è®©æ‰€æœ‰äººéƒ½è®®è®ºçº·çº·çš„æ¨¡å‹ä¸Šä¸‹æ–‡åè®®æ›´é‡è¦ã€‚</p>
<h3 data-id="heading-0">æŠ€èƒ½ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>æŠ€èƒ½éå¸¸ç®€å•æ˜äº†ï¼šå®ƒä»¬æ˜¯åŒ…å«æŒ‡ä»¤ã€è„šæœ¬å’Œèµ„æºçš„æ–‡ä»¶å¤¹ï¼ŒClaudeåœ¨è¯†åˆ«åˆ°ç›¸å…³ä»»åŠ¡æ—¶ä¼šåŠ è½½è¿™äº›æ–‡ä»¶å¤¹ã€‚</p>
<p>æŠŠå®ƒä»¬æƒ³è±¡æˆå®šåˆ¶åŸ¹è®­æ‰‹å†Œã€‚ä½ æ­£åœ¨æ„å»ºè´¢åŠ¡æ¨¡å‹ï¼ŸClaudeä¼šå€Ÿé‰´ä½ çš„Excelä¸“ä¸šçŸ¥è¯†ã€‚æ­£åœ¨åˆ¶ä½œæ¼”ç¤ºæ–‡ç¨¿ï¼Ÿä½ çš„å“ç‰ŒæŒ‡å—å’Œæ¨¡æ¿ä¼šè‡ªåŠ¨åŠ è½½ã€‚æ­£åœ¨ç¼–å†™ä»£ç ï¼Ÿä½ å›¢é˜Ÿçš„ç¼–ç æ ‡å‡†ä¼šå‘æŒ¥ä½œç”¨ã€‚</p>
<p>ç²¾å¦™ä¹‹å¤„ä½•åœ¨ï¼Ÿä½ æ— éœ€å¯¹è¿™ä¸€åˆ‡è¿›è¡Œå¾®è§‚ç®¡ç†ã€‚Claudeä¼šæ‰«æå¯ç”¨æŠ€èƒ½ï¼Œè¯†åˆ«ç›¸å…³å†…å®¹ï¼Œå¹¶ç²¾å‡†è°ƒç”¨æ‰€éœ€çš„ä¸€åˆ‡ï¼Œä»…æ­¤è€Œå·²ã€‚</p>
<p><strong>ä»¥ä¸‹æ˜¯å®ƒä»¬çš„ä¸åŒä¹‹å¤„ï¼š</strong></p>
<p><strong>å¯ç»„åˆæ€§</strong>ï¼šæŠ€èƒ½å¯ä»¥è‡ªè¡Œå †å ï¼Œæ— éœ€ä½ è¿›è¡Œåè°ƒã€‚</p>
<p><strong>å¯ç§»æ¤æ€§</strong>ï¼šä¸€æ¬¡æ„å»ºï¼Œéšå¤„ä½¿ç”¨ã€‚åŒæ ·çš„æŠ€èƒ½åœ¨Claudeçš„ç½‘é¡µç•Œé¢ã€APIå’ŒClaude Codeä¸­éƒ½èƒ½å‘æŒ¥ä½œç”¨ã€‚</p>
<p><strong>é«˜æ•ˆ</strong>ï¼šæ¯ä¸ªæŠ€èƒ½åœ¨Claudeéœ€è¦ä¹‹å‰ä»…æ¶ˆè€—å‡ åä¸ªä»¤ç‰Œã€‚ç„¶åå®ƒä¼šåŠ è½½å®Œæ•´çš„è¯¦ç»†ä¿¡æ¯ã€‚</p>
<p><strong>å¼ºå¤§</strong>ï¼šæŠ€èƒ½å¯ä»¥åŒ…æ‹¬å¯æ‰§è¡Œçš„Pythonè„šæœ¬ï¼Œç”¨äºä¼ ç»Ÿä»£ç ä¼˜äºä»¤ç‰Œç”Ÿæˆçš„ä»»åŠ¡ã€‚</p>
<p>æŒ‰å›è½¦é”®æˆ–ç‚¹å‡»ä»¥æŸ¥çœ‹å…¨å°ºå¯¸å›¾åƒ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ae6e31cfa10b419ab93d56f69d4b4ba8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a6J5oCd5rS-QW5zcGlyZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767146918&amp;x-signature=msDW7JasqlhWtfm75ZTiblZFU7U%3D" alt="" loading="lazy"/></p>
<p>ClaudeæŠ€èƒ½ã€‚æ¥æºï¼šAnthropic</p>
<h3 data-id="heading-1">æ·±å…¥å‰–æï¼šæŠ€èƒ½ç©¶ç«Ÿå¦‚ä½•å‘æŒ¥ä½œç”¨</h3>
<p>æŠ€æœ¯å®ç°æ­ç¤ºäº†æŠ€èƒ½ä¸ºä½•é‡è¦ã€‚</p>
<p>åœ¨ä¼šè¯å¼€å§‹æ—¶ï¼ŒClaudeä¼šæ‰«ææ‰€æœ‰å¯ç”¨çš„æŠ€èƒ½æ–‡ä»¶ï¼Œå¹¶ä»æ¯ä¸ªMarkdownæ–‡ä»¶çš„YAMLä¸­è¯»å–ç®€çŸ­è¯´æ˜ã€‚è¿™åœ¨æ ‡è®°æ•ˆç‡æ–¹é¢è¡¨ç°å‡ºè‰²â€”â€”æ¯ä¸ªæŠ€èƒ½åœ¨è¢«è°ƒç”¨ä¹‹å‰å¯èƒ½åªå ç”¨30 - 50ä¸ªæ ‡è®°ã€‚</p>
<p>å½“ä½ æå‡ºç±»ä¼¼â€œæŒ‰ç…§æˆ‘ä»¬çš„å“ç‰Œå‡†åˆ™åˆ›å»ºä¸€ä¸ªé”€å”®æ¼”ç¤ºæ–‡ç¨¿â€çš„è¯·æ±‚æ—¶ï¼ŒClaudeä¼šè¯†åˆ«å‡ºä¸¤é¡¹ç›¸å…³æŠ€èƒ½ï¼šæ¼”ç¤ºæ–‡ç¨¿åˆ›å»ºå’Œä½ çš„å“ç‰Œæ ‡å‡†ã€‚å®ƒä¼šåŠ è½½è¿™ä¸¤é¡¹æŠ€èƒ½ï¼Œåè°ƒå®ƒä»¬çš„ä½¿ç”¨ï¼Œç„¶åå¼€å§‹å·¥ä½œã€‚</p>
<p>å…‹åŠ³å¾·åœ¨9æœˆæ¨å‡ºçš„é‚£äº›æ–‡æ¡£åˆ›å»ºåŠŸèƒ½ï¼Ÿäº‹å®è¯æ˜ï¼Œå®ƒä»¬ä¸€ç›´éƒ½æ˜¯æŠ€èƒ½ã€‚</p>
<h3 data-id="heading-2">ä¸€ä¸ªçœŸå®çš„ä¾‹å­ï¼šPPTåˆ¶ä½œ</h3>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†ä¸»é¢˜å·¥å‚ã€‚è¿™æ˜¯ä¸€ä¸ªï¼š</p>
<p>ç”¨äºä¸ºåˆ¶å“åº”ç”¨ä¸»é¢˜æ ·å¼çš„å·¥å…·åŒ…ã€‚è¿™äº›åˆ¶å“å¯ä»¥æ˜¯å¹»ç¯ç‰‡ã€æ–‡æ¡£ã€æŠ¥å‘Šã€HTMLç€é™†é¡µç­‰ã€‚æœ‰10ç§é¢„è®¾ä¸»é¢˜ï¼ŒåŒ…å«é¢œè‰²å’Œå­—ä½“ï¼Œä½ å¯ä»¥å°†å…¶åº”ç”¨äºä»»ä½•åˆ¶å“</p>
<p>æŒ‰å›è½¦é”®æˆ–ç‚¹å‡»ä»¥æŸ¥çœ‹å…¨å°ºå¯¸å›¾åƒ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34cd3ad2412c46ec864a2b0069221390~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a6J5oCd5rS-QW5zcGlyZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767146918&amp;x-signature=qa25rP1yxkAvvrvGQKqThrzs9zk%3D" alt="" loading="lazy"/></p>
<p>ä¸»é¢˜å·¥å‚å·¥å…·åŒ…ç¤ºä¾‹</p>
<p>æˆ‘ç›¸ä¿¡è¿™ä¸ªéå¸¸æœ‰ç”¨ã€‚æˆ‘èƒ½çœ‹å‡ºä½ å¯ä»¥åˆ›å»ºå…¬å¸ä½¿ç”¨çš„å¹»ç¯ç‰‡æ¨¡æ¿ï¼Œå¹¶æŒ‰ç…§æ­£ç¡®æ ¼å¼å¿«é€Ÿåˆ›å»ºæ¼”ç¤ºæ–‡ç¨¿ã€‚ä½ æ‰€éœ€è¦åšçš„å°±æ˜¯ä¸Šä¼ åŒ…å«æ•°æ®çš„ Excel æ–‡ä»¶ï¼Œå…¶ä½™çš„ç”± Claude å®Œæˆã€‚ä½ å¯ä»¥ä¿å­˜å¤šç§æ ¼å¼ï¼Œå¹¶åœ¨éœ€è¦æ—¶éšæ—¶ä½¿ç”¨ã€‚</p>
<h3 data-id="heading-3">ç¤ºä¾‹äºŒï¼šç”»å¸ƒè®¾è®¡æŠ€èƒ½</h3>
<p>ç”»å¸ƒè®¾è®¡ç”¨äºâ€œè¿ç”¨è®¾è®¡ç†å¿µåœ¨.pngå’Œ.pdfæ–‡æ¡£ä¸­åˆ›ä½œç²¾ç¾çš„è§†è§‰è‰ºæœ¯ä½œå“ã€‚å½“ç”¨æˆ·è¦æ±‚åˆ›ä½œæµ·æŠ¥ã€è‰ºæœ¯ä½œå“ã€è®¾è®¡æˆ–å…¶ä»–é™æ€ä½œå“æ—¶ï¼Œä½ åº”è¯¥è¿ç”¨è¿™é¡¹æŠ€èƒ½ã€‚â€</p>
<p>æŒ‰å›è½¦é”®æˆ–ç‚¹å‡»ä»¥æŸ¥çœ‹å…¨å°ºå¯¸å›¾åƒ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8992af4698754b19b257d822e659edb0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a6J5oCd5rS-QW5zcGlyZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767146918&amp;x-signature=WhDvZD8uaLmZZWHxMXSk8QdmFMo%3D" alt="" loading="lazy"/></p>
<p>ç”»å¸ƒè®¾è®¡æŠ€èƒ½ç¤ºä¾‹</p>
<h3 data-id="heading-4">ç¼–ç ç¯å¢ƒè¦æ±‚</h3>
<p>æŠ€èƒ½å®Œå…¨ä¾èµ–äºClaudeèƒ½å¤Ÿè®¿é—®æ–‡ä»¶ç³»ç»Ÿå¹¶æ‰§è¡Œä»£ç ã€‚è¿™å¹¶éæ–°é²œäº‹ç‰©â€”â€”ChatGPTçš„ä»£ç è§£é‡Šå™¨æ—©åœ¨2023å¹´åˆå°±å¼€åˆ›äº†è¿™ç§æ¨¡å¼ï¼Œè€ŒCursorå’ŒClaude Codeç­‰æœ¬åœ°å·¥å…·åˆ™å°†å…¶æ‰©å±•åˆ°äº†ä½ çš„æœºå™¨ä¸Šã€‚</p>
<p>ä½†è¿™ä¸€è¦æ±‚æ­£æ˜¯å°†æŠ€èƒ½ä¸ä¹‹å‰æ‰©å±•å¤§è¯­è¨€æ¨¡å‹èƒ½åŠ›çš„å°è¯•ï¼ˆå¦‚MCPæˆ–ChatGPTæ’ä»¶ï¼‰åŒºåˆ†å¼€æ¥çš„åœ°æ–¹ã€‚</p>
<p>æƒè¡¡æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼šä½ éœ€è¦å®‰å…¨çš„æ²™ç®±æ¥é™åˆ¶æ½œåœ¨æç¤ºæ³¨å…¥æ”»å‡»é€ æˆçš„æŸå®³ã€‚ä½†ä¸€æ—¦æ‹¥æœ‰äº†è¿™æ ·çš„ç¯å¢ƒï¼Œå¯èƒ½æ€§å°±ä¼šå¤§å¹…å¢åŠ ã€‚</p>
<h3 data-id="heading-5">Claudeä½œä¸ºé€šç”¨æ™ºèƒ½ä½“ï¼ˆè€Œéä»…ä»…æ˜¯ç¼–ç å·¥å…·ï¼‰</h3>
<p>æ¥ä¸‹æ¥äº‹æƒ…å°±æœ‰è¶£äº†ã€‚Claude Codeçš„å‘½åå…·æœ‰è¯¯å¯¼æ€§ã€‚å®ƒå¹¶éå•çº¯ç”¨äºç¼–ç ï¼Œè€Œæ˜¯ä¸€ç§é€šç”¨çš„è®¡ç®—æœºè‡ªåŠ¨åŒ–å·¥å…·ã€‚ä»»ä½•ä½ å¯ä»¥é€šè¿‡åœ¨ç»ˆç«¯ä¸­è¾“å…¥å‘½ä»¤æ¥å®Œæˆçš„äº‹æƒ…ï¼ŒClaude Codeç°åœ¨éƒ½èƒ½å®ç°è‡ªåŠ¨åŒ–ã€‚</p>
<h3 data-id="heading-6">æŠ€èƒ½ä¸MCPï¼šæ›´å¥½çš„æ–¹æ³•ï¼Ÿ</h3>
<p>æ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼ˆMCPï¼‰äºå»å¹´11æœˆæ¨å‡ºï¼Œå¼•èµ·äº†æå¤§çš„è½°åŠ¨ã€‚æ¯ä¸€ä¸ªåˆ¶å®šâ€œAIæˆ˜ç•¥â€çš„å…¬å¸éƒ½æ€¥äºå®£å¸ƒå®æ–½MCPã€‚</p>
<p>ä½†å±€é™æ€§ä¹Ÿéšä¹‹æ˜¾ç°ã€‚ä»…GitHubçš„å®˜æ–¹MCPå°±ä¼šæ¶ˆè€—æ•°ä¸‡ä¸ªä»¤ç‰Œã€‚å†å¢åŠ å‡ ä¸ªMCPï¼Œç•™ç»™å®é™…å·¥ä½œçš„ä¸Šä¸‹æ–‡å°±æ‰€å‰©æ— å‡ äº†ã€‚</p>
<p>æŠ€èƒ½å…·æœ‰ç›¸åŒçš„ä¼˜åŠ¿ï¼Œä½†æ•ˆæœæ›´å¥½ã€‚ä½ ç”šè‡³æ— éœ€å®ç°ä¸€ä¸ª CLI å·¥å…·ã€‚æ”¾å…¥ä¸€ä¸ªæè¿°å¦‚ä½•æ‰§è¡Œä»»åŠ¡çš„ Markdown æ–‡ä»¶å³å¯ã€‚ä»…åœ¨è„šæœ¬èƒ½å¤Ÿæé«˜å¯é æ€§æˆ–æ•ˆç‡æ—¶æ‰æ·»åŠ å®ƒä»¬ã€‚</p>
<p>ä»¤ç‰Œæ•ˆç‡ååˆ†æ˜¾è‘—ã€‚MCPé¢„å…ˆåŠ è½½æ•°åƒä¸ªæè¿°æ‰€æœ‰å¯èƒ½åŠŸèƒ½çš„ä»¤ç‰Œã€‚æŠ€èƒ½åŠ è½½ä¸€ä¸ª30ä»¤ç‰Œçš„æè¿°ï¼Œä»…åœ¨éœ€è¦æ—¶æ‰æå–å®Œæ•´ç»†èŠ‚ã€‚</p>
<h3 data-id="heading-7">æ„å»ºä½ çš„ç¬¬ä¸€ä¸ªæŠ€èƒ½</h3>
<p>åˆ›å»ºæŠ€èƒ½å¾ˆç®€å•ã€‚Anthropicç”šè‡³å¼€å‘äº†ä¸€ä¸ªâ€œæŠ€èƒ½åˆ›å»ºè€…â€æŠ€èƒ½ï¼Œå®ƒä¼šè¯¢é—®ä½ çš„å·¥ä½œæµç¨‹ï¼Œå¹¶ä¸ºä½ ç”Ÿæˆæ–‡ä»¶å¤¹ç»“æ„ã€‚</p>
<p>åŸºæœ¬ç»“æ„ï¼š</p>
<p>my-skill/ â”œâ”€â”€ SKILL.md # ä¸»è¦è¯´æ˜ â”œâ”€â”€ core/ # è¾…åŠ©è„šæœ¬ï¼ˆå¯é€‰ï¼‰ â”‚ â””â”€â”€ utilities.py â””â”€â”€ examples/ # ç¤ºä¾‹æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰ â””â”€â”€ template.json</p>
<p>SKILL.mdæ–‡ä»¶åŒ…å«å¸¦æœ‰ç®€çŸ­æè¿°çš„å‰ç½®å…ƒæ•°æ®ï¼Œå…¶åæ˜¯é’ˆå¯¹Claudeçš„è¯¦ç»†è¯´æ˜ï¼š</p>
<p>â€” - åç§°: å“ç‰ŒæŒ‡å— æè¿°: å…¬å¸ç”¨äºæ¼”ç¤ºæ–‡ç¨¿å’Œæ–‡æ¡£çš„å“ç‰Œæ ‡å‡† â€” -</p>
<p>#å“ç‰ŒæŒ‡å—æŠ€èƒ½</p>
<p>åœ¨åˆ›å»ºæ¼”ç¤ºæ–‡ç¨¿æˆ–æ–‡æ¡£æ—¶ï¼Œè¯·éµå¾ªä»¥ä¸‹æ ‡å‡†ï¼š</p>
<p>## é¢œè‰² - ä¸»è‰²ï¼š#0066CC - å‰¯è‰²ï¼š#FF6B35 - èƒŒæ™¯è‰²ï¼š#F8F9FA</p>
<p>## æ’ç‰ˆ - æ ‡é¢˜ï¼šMontserrat Bold - æ­£æ–‡ï¼šOpen Sans Regular</p>
<p>## å¾½æ ‡ä½¿ç”¨ ä» `/examples/logo.svg` åŠ è½½å¾½æ ‡ã€‚å§‹ç»ˆå°†å…¶ç½®äºå³ä¸Šè§’â€¦</p>
<p>å°±æ˜¯è¿™æ ·ã€‚æ²¡æœ‰ API é›†æˆï¼Œæ²¡æœ‰èº«ä»½éªŒè¯æµç¨‹ï¼Œåªæœ‰è¯´æ˜ã€‚</p>
<h3 data-id="heading-8">ç°å®ä¸–ç•Œåº”ç”¨</h3>
<p><strong>å¯¹äºå›¢é˜Ÿï¼š</strong></p>
<ul>
<li>
<p>Claudeè‡ªåŠ¨å¼•ç”¨çš„å…¥èŒæ–‡æ¡£</p>
</li>
<li>
<p>å®¡æŸ¥æ‹‰å–è¯·æ±‚æ—¶é€‚ç”¨çš„ä»£ç å®¡æŸ¥æ ‡å‡†</p>
</li>
<li>
<p>ç¡®ä¿æ‰€æœ‰æ–‡ä»¶ä¿æŒä¸€è‡´æ€§çš„å“ç‰ŒæŒ‡å—</p>
</li>
</ul>
<p><strong>é¢å‘å¼€å‘è€…ï¼š</strong></p>
<ul>
<li>
<p>ç‰¹å®šäºæ‚¨çš„æŠ€æœ¯æ ˆçš„ API é›†æˆæ¨¡å¼</p>
</li>
<li>
<p>ä¸æ‚¨å›¢é˜Ÿçš„æ–¹æ³•ç›¸åŒ¹é…çš„æµ‹è¯•ç­–ç•¥</p>
</li>
<li>
<p>éµå¾ªæ‚¨ç¡®åˆ‡å·¥ä½œæµç¨‹çš„éƒ¨ç½²ç¨‹åº</p>
</li>
</ul>
<p><strong>å¯¹äºåˆ†æå¸ˆï¼š</strong></p>
<ul>
<li>
<p>å¸¸è§æ•°æ®æºçš„æ•°æ®æ¸…ç†ç¨‹åº</p>
</li>
<li>
<p>å¯è§†åŒ–æ ‡å‡†å’Œæ¨¡æ¿</p>
</li>
<li>
<p>ç¬¦åˆåˆ©ç›Šç›¸å…³è€…æœŸæœ›çš„æŠ¥å‘Šç»“æ„</p>
</li>
</ul>
<p><strong>å¯¹äºå†…å®¹åˆ›ä½œè€…ï¼š</strong></p>
<ul>
<li>
<p>SEOä¼˜åŒ–æŒ‡å—</p>
</li>
<li>
<p>ä¸åŒå¹³å°çš„å‘å¸ƒå·¥ä½œæµç¨‹</p>
</li>
<li>
<p>å“ç‰Œå£°éŸ³å’Œè¯­è°ƒæ ‡å‡†</p>
</li>
</ul>
<h3 data-id="heading-9">æ¥ä¸‹æ¥ä¼šå‘ç”Ÿä»€ä¹ˆ</h3>
<p>åˆ›é€ å’Œåˆ†äº«æŠ€èƒ½çš„é—¨æ§›å¦‚æ­¤ä¹‹ä½ï¼Œä»¥è‡³äºæˆ‘ä»¬å¯èƒ½ä¼šçœ‹åˆ°ï¼š</p>
<ul>
<li>
<p>ç‰¹å®šè¡Œä¸šæŠ€èƒ½åº“ï¼ˆæ³•å¾‹ã€åŒ»ç–—ã€é‡‘èï¼‰</p>
</li>
<li>
<p>å…¨å…¬å¸èŒƒå›´çš„æŠ€èƒ½åº“ï¼Œå¯è§„èŒƒæ“ä½œ</p>
</li>
<li>
<p>ç¤¾åŒºè´¡çŒ®çš„å¸¸è§å·¥å…·å’Œæ¡†æ¶æŠ€èƒ½</p>
</li>
<li>
<p>ä¼ æˆé¢†åŸŸä¸“ä¸šçŸ¥è¯†çš„æ•™è‚²æŠ€èƒ½</p>
</li>
</ul>
<p>æœ€æœ‰è¶£çš„æ–¹é¢æ˜¯ä»€ä¹ˆï¼Ÿæ²¡æœ‰ä»€ä¹ˆèƒ½é˜»æ­¢è¿™äº›æŠ€èƒ½ä¸å…¶ä»–æ¨¡å‹ååŒå·¥ä½œã€‚ä½ ä»Šå¤©å°±å¯ä»¥å°†ClaudeæŠ€èƒ½æ–‡ä»¶å¤¹ä¸Codex CLIæˆ–Gemini CLIä¸€èµ·ä½¿ç”¨ã€‚é˜…è¯»SKILL.mdæ–‡ä»¶ï¼Œç„¶åå°±å¯ä»¥å¼€å§‹äº†ã€‚</p>
<p>è¿™ä¸æ˜¯ä¾›åº”å•†é”å®šã€‚è¿™æ˜¯ä¸€ç§å…±äº«æ ¼å¼ï¼Œæœ‰å¯èƒ½æˆä¸ºæ ‡å‡†ã€‚</p>
<h3 data-id="heading-10">åº•çº¿</h3>
<p>æŠ€èƒ½ä»£è¡¨ç€ä»â€œæç¤ºå·¥ç¨‹â€å‘â€œä¸“ä¸šçŸ¥è¯†æ‰“åŒ…â€çš„è½¬å˜ã€‚</p>
<p>ä½ ä¸å¿…è¯•å›¾å®Œç¾åœ°è¡¨è¿°ä½ çš„è¯·æ±‚ã€‚ä½ åªéœ€å‘åŠ©æ‰‹ä¼ æˆä¸€æ¬¡ä½ çš„é¢†åŸŸçŸ¥è¯†ï¼Œå®ƒå°±ä¼šè®°ä½ã€‚</p>
<p>å…¶å½±å“ä¸ä»…é™äºä¸ªäººç”Ÿäº§åŠ›ã€‚ç»„ç»‡å¯ä»¥å°†æœºæ„çŸ¥è¯†ç¼–çº‚æˆå…¸ã€‚å›¢é˜Ÿå¯ä»¥åœ¨ä¸é‡‡ç”¨åƒµåŒ–æµç¨‹çš„æƒ…å†µä¸‹å®ç°æ–¹æ³•æ ‡å‡†åŒ–ã€‚ä¸“å®¶å¯ä»¥å¤§è§„æ¨¡åœ°åˆ†äº«ä¸“ä¸šçŸ¥è¯†ã€‚</p>
<p>ä¸å¤§å¤šæ•°å¤§å¼ æ——é¼“æ¨å‡ºã€ä¸‹ä¸ªå­£åº¦å°±è¢«é—å¿˜çš„AIåŠŸèƒ½ä¸åŒï¼ŒSkillsè§£å†³äº†ä¸€ä¸ªå®é™…é—®é¢˜ï¼šAIç†è®ºä¸Šèƒ½åšçš„äº‹æƒ…ä¸å®ƒå¯¹æ‚¨å…·ä½“å·¥ä½œçš„å®é™…ç†è§£ä¹‹é—´çš„å·®è·ã€‚</p>
<p>è¿™å€¼å¾—å…³æ³¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•ä¼˜åŒ–MATLABåŠ¨ç”»çš„æ€§èƒ½ï¼Ÿä»å¡é¡¿åˆ°æµç•…çš„å®æˆ˜æŠ€å·§]]></title>    <link>https://juejin.cn/post/7587175302347391011</link>    <guid>https://juejin.cn/post/7587175302347391011</guid>    <pubDate>2025-12-24T01:55:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587175302347391011" data-draft-id="7586941997194674228" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•ä¼˜åŒ–MATLABåŠ¨ç”»çš„æ€§èƒ½ï¼Ÿä»å¡é¡¿åˆ°æµç•…çš„å®æˆ˜æŠ€å·§"/> <meta itemprop="keywords" content="MATLAB"/> <meta itemprop="datePublished" content="2025-12-24T01:55:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹å‘˜å¤–"/> <meta itemprop="url" content="https://juejin.cn/user/4496334519809408"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•ä¼˜åŒ–MATLABåŠ¨ç”»çš„æ€§èƒ½ï¼Ÿä»å¡é¡¿åˆ°æµç•…çš„å®æˆ˜æŠ€å·§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4496334519809408/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹å‘˜å¤–
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T01:55:15.000Z" title="Wed Dec 24 2025 01:55:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>MATLABåŠ¨ç”»åˆ¶ä½œä¸­å¸¸é‡åˆ°<strong>å¡é¡¿ã€å¸§ç”Ÿæˆæ…¢ã€å†…å­˜å ç”¨è¿‡é«˜</strong>ç­‰æ€§èƒ½é—®é¢˜ï¼Œå°¤å…¶åœ¨å¤„ç†å¤§è§„æ¨¡æ•°æ®æˆ–å¤æ‚å›¾å½¢æ—¶æ›´ä¸ºæ˜æ˜¾ã€‚è¿™äº›é—®é¢˜ä¸»è¦æºäºç”»å¸ƒé‡ç»˜é¢‘ç¹ã€æ•°æ®è®¡ç®—æ•ˆç‡ä½ã€æ¸²æŸ“æ–¹å¼ä¸å½“ç­‰åŸå› ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€å…ˆå®šä½æ€§èƒ½ç“¶é¢ˆï¼šæ‰¾åˆ°é—®é¢˜æ ¹æº</h2>
<p>ä¼˜åŒ–å‰éœ€å…ˆç¡®å®šæ€§èƒ½ç“¶é¢ˆæ‰€åœ¨ï¼ŒMATLABæä¾›äº†ä¸¤ä¸ªå®ç”¨å·¥å…·ï¼š</p>
<ol>
<li><strong><code>profile</code>æ€§èƒ½åˆ†æå·¥å…·</strong>ï¼šè¿½è¸ªä»£ç ä¸­å„å‡½æ•°çš„æ‰§è¡Œæ—¶é—´ï¼Œå®šä½è€—æ—¶æ¨¡å—
<pre><code class="hljs language-matlab" lang="matlab">profile on; <span class="hljs-comment">% å¼€å¯æ€§èƒ½åˆ†æ</span>
run(<span class="hljs-string">'your_animation_code.m'</span>); <span class="hljs-comment">% è¿è¡ŒåŠ¨ç”»ä»£ç </span>
profile viewer; <span class="hljs-comment">% æ‰“å¼€åˆ†ææŠ¥å‘Šï¼ŒæŸ¥çœ‹è€—æ—¶å‡½æ•°</span>
</code></pre>
</li>
<li><strong><code>fps</code>å¸§ç‡ç»Ÿè®¡</strong>ï¼šé€šè¿‡è®¡ç®—å¸§ç”Ÿæˆæ—¶é—´ï¼Œåˆ¤æ–­åŠ¨ç”»æµç•…åº¦ï¼ˆç†æƒ³å¸§ç‡30~60fpsï¼‰
<pre><code class="hljs language-matlab" lang="matlab">tic;
<span class="hljs-keyword">for</span> k = <span class="hljs-number">1</span>:nFrames
    <span class="hljs-comment">% å¸§ç”Ÿæˆä»£ç </span>
    frameTime(k) = toc;
    tic;
<span class="hljs-keyword">end</span>
fps = <span class="hljs-number">1.</span>/<span class="hljs-built_in">mean</span>(diff(frameTime)); <span class="hljs-comment">% è®¡ç®—å¹³å‡å¸§ç‡</span>
<span class="hljs-built_in">disp</span>([<span class="hljs-string">'å¹³å‡å¸§ç‡ï¼š'</span>, num2str(fps), <span class="hljs-string">'fps'</span>]);
</code></pre>
</li>
</ol>
<p>å¸¸è§ç“¶é¢ˆï¼š<strong>å¾ªç¯å†…æ•°æ®è®¡ç®—è€—æ—¶</strong>ã€<strong>ç”»å¸ƒé‡ç»˜é¢‘ç¹</strong>ã€<strong>å¸§å­˜å‚¨å ç”¨å†…å­˜è¿‡å¤§</strong>ã€<strong>é«˜åˆ†è¾¨ç‡æ¸²æŸ“å‹åŠ›</strong>ã€‚</p>
<h2 data-id="heading-1">äºŒã€æ ¸å¿ƒä¼˜åŒ–æŠ€å·§ï¼šé€šç”¨ç¯‡ï¼ˆé€‚ç”¨äºæ‰€æœ‰åŠ¨ç”»ï¼‰</h2>
<h3 data-id="heading-2">1. å‡å°‘ç”»å¸ƒé‡ç»˜ï¼Œå›ºå®šæ¸²æŸ“èŒƒå›´</h3>
<p>ç”»å¸ƒé‡ç»˜æ˜¯åŠ¨ç”»å¡é¡¿çš„é¦–è¦åŸå› ï¼Œå°¤å…¶æ˜¯é¢‘ç¹åˆ·æ–°åæ ‡è½´ã€å›¾ä¾‹ç­‰å…ƒç´ ã€‚</p>
<ul>
<li><strong>å›ºå®šåæ ‡è½´èŒƒå›´</strong>ï¼šç”¨<code>axis([xmin xmax ymin ymax])</code>é”å®šè½´èŒƒå›´ï¼Œé¿å…æ¯å¸§è‡ªåŠ¨ç¼©æ”¾
<pre><code class="hljs language-matlab" lang="matlab"><span class="hljs-comment">% ä¼˜åŒ–å‰ï¼šæ¯å¸§é‡ç»˜åæ ‡è½´ï¼Œå¯¼è‡´å¡é¡¿</span>
<span class="hljs-keyword">for</span> k = <span class="hljs-number">1</span>:<span class="hljs-number">100</span>
    <span class="hljs-built_in">plot</span>(x, y); <span class="hljs-comment">% æ¯æ¬¡plotéƒ½ä¼šé‡ç½®åæ ‡è½´</span>
<span class="hljs-keyword">end</span>

<span class="hljs-comment">% ä¼˜åŒ–åï¼šæå‰å›ºå®šè½´èŒƒå›´</span>
axis([<span class="hljs-number">0</span> <span class="hljs-number">2</span>*<span class="hljs-built_in">pi</span> <span class="hljs-number">-2</span> <span class="hljs-number">2</span>]);
<span class="hljs-built_in">hold</span> on;
<span class="hljs-keyword">for</span> k = <span class="hljs-number">1</span>:<span class="hljs-number">100</span>
    <span class="hljs-built_in">plot</span>(x, y);
    cla(<span class="hljs-string">'reset'</span>); <span class="hljs-comment">% ä»…æ¸…é™¤å›¾å½¢ï¼Œä¿ç•™åæ ‡è½´</span>
    axis([<span class="hljs-number">0</span> <span class="hljs-number">2</span>*<span class="hljs-built_in">pi</span> <span class="hljs-number">-2</span> <span class="hljs-number">2</span>]); <span class="hljs-comment">% é‡æ–°å›ºå®šè½´èŒƒå›´ï¼ˆå¯é€‰ï¼‰</span>
<span class="hljs-keyword">end</span>
<span class="hljs-built_in">hold</span> off;
</code></pre>
</li>
<li><strong>å…³é—­åŠ¨æ€å…ƒç´ æ›´æ–°</strong>ï¼šç¦ç”¨å›¾ä¾‹ã€ç½‘æ ¼çš„è‡ªåŠ¨åˆ·æ–°ï¼Œä»…åœ¨åˆå§‹åŒ–æ—¶è®¾ç½®</li>
<li><strong>ä½¿ç”¨<code>hold on</code></strong>ï¼šé¿å…æ¯å¸§é‡æ–°åˆ›å»ºç»˜å›¾å¯¹è±¡ï¼Œå‡å°‘æ¸²æŸ“å¼€é”€</li>
</ul>
<h3 data-id="heading-3">2. ä¼˜åŒ–<code>drawnow</code>çš„ä½¿ç”¨æ–¹å¼</h3>
<p><code>drawnow</code>æ˜¯æ§åˆ¶ç”»é¢åˆ·æ–°çš„æ ¸å¿ƒå‡½æ•°ï¼Œä¸åŒè°ƒç”¨æ–¹å¼æ€§èƒ½å·®å¼‚æå¤§ï¼š</p>

























<table><thead><tr><th>è°ƒç”¨æ–¹å¼</th><th>ç‰¹ç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><code>drawnow</code></td><td>ç«‹å³åˆ·æ–°ç”»é¢ï¼ŒCPUå ç”¨é«˜</td><td>é«˜ç²¾åº¦å®æ—¶åŠ¨ç”»</td></tr><tr><td><code>drawnow limitrate</code></td><td>é™åˆ¶åˆ·æ–°é€Ÿåº¦ï¼ˆæœ€å¤§30fpsï¼‰ï¼Œé™ä½CPUå ç”¨</td><td>å¤§å¤šæ•°å®æ—¶åŠ¨ç”»</td></tr><tr><td><code>drawnow nocallbacks</code></td><td>åˆ·æ–°ç”»é¢ä½†è·³è¿‡å›è°ƒå‡½æ•°ï¼Œé€Ÿåº¦æœ€å¿«</td><td>æ— äº¤äº’çš„æ‰¹é‡æ¸²æŸ“</td></tr></tbody></table>
<p><strong>å®æˆ˜å»ºè®®</strong>ï¼šéå®æ—¶åœºæ™¯ç”¨<code>drawnow limitrate</code>ï¼Œæ‰¹é‡æ¸²æŸ“ç”¨<code>drawnow nocallbacks</code>ã€‚</p>
<h3 data-id="heading-4">3. é¢„è®¡ç®—æ•°æ®ï¼Œå‡å°‘å¾ªç¯å†…è®¡ç®—é‡</h3>
<p>å¾ªç¯å†…çš„é‡å¤è®¡ç®—ï¼ˆå¦‚ä¸‰è§’å‡½æ•°ã€çŸ©é˜µè¿ç®—ï¼‰ä¼šä¸¥é‡æ‹–æ…¢å¸§ç”Ÿæˆé€Ÿåº¦ï¼Œ<strong>å°†å¯é¢„è®¡ç®—çš„æ•°æ®ç§»åˆ°å¾ªç¯å¤–</strong>ã€‚</p>
<pre><code class="hljs language-matlab" lang="matlab"><span class="hljs-comment">% ä¼˜åŒ–å‰ï¼šå¾ªç¯å†…é‡å¤è®¡ç®—xå’Œæ­£å¼¦å€¼ï¼Œè€—æ—¶</span>
<span class="hljs-keyword">for</span> k = <span class="hljs-number">1</span>:<span class="hljs-number">60</span>
    x = <span class="hljs-built_in">linspace</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>*<span class="hljs-built_in">pi</span>, <span class="hljs-number">1000</span>); <span class="hljs-comment">% é‡å¤è®¡ç®—</span>
    y = <span class="hljs-built_in">sin</span>(x + <span class="hljs-number">2</span>*<span class="hljs-built_in">pi</span>*k/<span class="hljs-number">60</span>);
    <span class="hljs-built_in">plot</span>(x, y);
<span class="hljs-keyword">end</span>

<span class="hljs-comment">% ä¼˜åŒ–åï¼šé¢„è®¡ç®—æ‰€æœ‰æ•°æ®ï¼Œå¾ªç¯å†…ä»…ç´¢å¼•</span>
x = <span class="hljs-built_in">linspace</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>*<span class="hljs-built_in">pi</span>, <span class="hljs-number">1000</span>); <span class="hljs-comment">% é¢„è®¡ç®—x</span>
theta = <span class="hljs-built_in">linspace</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>*<span class="hljs-built_in">pi</span>, <span class="hljs-number">60</span>); <span class="hljs-comment">% é¢„è®¡ç®—æ‰€æœ‰è§’åº¦</span>
<span class="hljs-keyword">for</span> k = <span class="hljs-number">1</span>:<span class="hljs-number">60</span>
    y = <span class="hljs-built_in">sin</span>(x + theta(k)); <span class="hljs-comment">% ä»…ç´¢å¼•é¢„è®¡ç®—çš„è§’åº¦</span>
    <span class="hljs-built_in">plot</span>(x, y);
<span class="hljs-keyword">end</span>
</code></pre>
<h3 data-id="heading-5">4. ä½¿ç”¨ä½å±‚æ¬¡ç»˜å›¾å‡½æ•°</h3>
<p><code>plot()</code>/<code>scatter()</code>ç­‰é«˜å±‚å‡½æ•°ä¼šè‡ªåŠ¨åˆ›å»ºå¤§é‡ç»˜å›¾å¯¹è±¡ï¼Œè€Œ**<code>line()</code>/<code>patch()</code>ç­‰ä½å±‚æ¬¡å‡½æ•°**ç›´æ¥æ“ä½œå›¾å½¢å¥æŸ„ï¼Œæ€§èƒ½æ›´é«˜ã€‚</p>
<pre><code class="hljs language-matlab" lang="matlab"><span class="hljs-comment">% ç”¨lineå‡½æ•°æ›¿ä»£plotï¼Œç›´æ¥æ›´æ–°å¥æŸ„æ•°æ®ï¼ˆæ— éœ€é‡ç»˜ï¼‰</span>
h = line(<span class="hljs-string">'XData'</span>, [], <span class="hljs-string">'YData'</span>, [], <span class="hljs-string">'Color'</span>, <span class="hljs-string">'r'</span>, <span class="hljs-string">'LineWidth'</span>, <span class="hljs-number">2</span>); <span class="hljs-comment">% åˆ›å»ºç©ºçº¿æ¡å¥æŸ„</span>
x = <span class="hljs-built_in">linspace</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>*<span class="hljs-built_in">pi</span>, <span class="hljs-number">1000</span>);
<span class="hljs-keyword">for</span> k = <span class="hljs-number">1</span>:<span class="hljs-number">60</span>
    y = <span class="hljs-built_in">sin</span>(x + <span class="hljs-number">2</span>*<span class="hljs-built_in">pi</span>*k/<span class="hljs-number">60</span>);
    set(h, <span class="hljs-string">'XData'</span>, x, <span class="hljs-string">'YData'</span>, y); <span class="hljs-comment">% ä»…æ›´æ–°æ•°æ®ï¼Œä¸é‡ç»˜å¯¹è±¡</span>
    drawnow limitrate;
<span class="hljs-keyword">end</span>
</code></pre>
<h2 data-id="heading-6">ä¸‰ã€é’ˆå¯¹<code>movie()</code>çš„ä¸“å±ä¼˜åŒ–</h2>
<p><code>movie()</code>ä¾èµ–é¢„æ¸²æŸ“å¸§çš„å­˜å‚¨ä¸æ’­æ”¾ï¼Œæ€§èƒ½ç“¶é¢ˆä¸»è¦åœ¨<strong>å¸§ç”Ÿæˆé€Ÿåº¦</strong>å’Œ<strong>å†…å­˜å ç”¨</strong>ï¼š</p>
<h3 data-id="heading-7">1. å‡å°‘å¸§çš„åˆ†è¾¨ç‡ä¸æ•°é‡</h3>
<ul>
<li><strong>é™ä½ç”»å¸ƒå°ºå¯¸</strong>ï¼šé€šè¿‡<code>figure('Position', [x y w h])</code>å‡å°ç”»å¸ƒå®½åº¦/é«˜åº¦ï¼Œå‡å°‘æ¯å¸§çš„åƒç´ æ•°æ®</li>
<li><strong>æ§åˆ¶å¸§æ•°</strong>ï¼šå¸§ç‡30fpsæ—¶ï¼Œ10ç§’åŠ¨ç”»ä»…éœ€300å¸§ï¼Œæ— éœ€è¿½æ±‚è¿‡å¤šå¸§æ•°ï¼ˆäººçœ¼åˆ†è¾¨æé™çº¦60fpsï¼‰</li>
</ul>
<h3 data-id="heading-8">2. ä¼˜åŒ–å¸§å­˜å‚¨æ–¹å¼</h3>
<ul>
<li>é¿å…ç”¨<code>moviein</code>å‡½æ•°ï¼ˆæ—§ç‰ˆå‡½æ•°ï¼Œæ•ˆç‡ä½ï¼‰ï¼Œæ”¹ç”¨<code>struct</code>å­˜å‚¨å¸§æ•°æ®</li>
<li>è‹¥ä»…éœ€æ’­æ”¾ä¸€æ¬¡ï¼Œå¯è¾¹ç”Ÿæˆè¾¹æ’­æ”¾ï¼Œæ— éœ€å­˜å‚¨æ‰€æœ‰å¸§ï¼ˆèŠ‚çœå†…å­˜ï¼‰
<pre><code class="hljs language-matlab" lang="matlab"><span class="hljs-comment">% è¾¹ç”Ÿæˆè¾¹æ’­æ”¾ï¼Œæ— éœ€å­˜å‚¨å¸§</span>
<span class="hljs-built_in">figure</span>;
axis([<span class="hljs-number">0</span> <span class="hljs-number">2</span>*<span class="hljs-built_in">pi</span> <span class="hljs-number">-2</span> <span class="hljs-number">2</span>]);
<span class="hljs-keyword">for</span> k = <span class="hljs-number">1</span>:<span class="hljs-number">60</span>
    y = <span class="hljs-built_in">sin</span>(x + <span class="hljs-number">2</span>*<span class="hljs-built_in">pi</span>*k/<span class="hljs-number">60</span>);
    <span class="hljs-built_in">plot</span>(x, y);
    drawnow; <span class="hljs-comment">% ç›´æ¥æ’­æ”¾ï¼Œä¸å­˜å‚¨</span>
    cla;
<span class="hljs-keyword">end</span>
</code></pre>
</li>
</ul>
<h3 data-id="heading-9">3. æ‰¹é‡æ¸²æŸ“åå†æ’­æ”¾</h3>
<p>å°†å¸§ç”Ÿæˆä¸æ’­æ”¾åˆ†ç¦»ï¼Œç”Ÿæˆæ—¶å…³é—­ç”»é¢æ˜¾ç¤ºï¼ˆ<code>set(gcf, 'Visible', 'off')</code>ï¼‰ï¼Œé¿å…å®æ—¶æ¸²æŸ“çš„æ€§èƒ½æŸè€—ï¼š</p>
<pre><code class="hljs language-matlab" lang="matlab"><span class="hljs-built_in">figure</span>(<span class="hljs-string">'Visible'</span>, <span class="hljs-string">'off'</span>); <span class="hljs-comment">% éšè—ç”»å¸ƒï¼ŒåŠ å¿«å¸§ç”Ÿæˆ</span>
<span class="hljs-comment">% ç”Ÿæˆå¸§çš„ä»£ç ...</span>
set(gcf, <span class="hljs-string">'Visible'</span>, <span class="hljs-string">'on'</span>); <span class="hljs-comment">% æ˜¾ç¤ºç”»å¸ƒåæ’­æ”¾</span>
movie(gcf, mov, <span class="hljs-number">3</span>, <span class="hljs-number">30</span>);
</code></pre>
<h2 data-id="heading-10">å››ã€é’ˆå¯¹<code>animatedline()</code>çš„ä¸“å±ä¼˜åŒ–</h2>
<p><code>animatedline()</code>ä¸»æ‰“å®æ—¶é€ç‚¹ç»˜åˆ¶ï¼Œæ€§èƒ½ç“¶é¢ˆåœ¨<strong>æ•°æ®ç‚¹ç´¯ç§¯</strong>å’Œ<strong>å®æ—¶åˆ·æ–°</strong>ï¼š</p>
<h3 data-id="heading-11">1. é™åˆ¶æ•°æ®ç‚¹æ•°é‡ï¼Œå®šæœŸæ¸…ç†å†å²æ•°æ®</h3>
<p>å½“ç»˜åˆ¶è¶…å¤§é‡æ•°æ®ç‚¹æ—¶ï¼Œä¼šå¯¼è‡´å†…å­˜å ç”¨é£™å‡ï¼Œç”¨<code>clearpoints()</code>æˆ–<code>removepoints()</code>æ¸…ç†æ—§æ•°æ®ï¼š</p>
<pre><code class="hljs language-matlab" lang="matlab">h = animatedline;
maxPoints = <span class="hljs-number">1000</span>; <span class="hljs-comment">% æœ€å¤šä¿ç•™1000ä¸ªç‚¹</span>
x = <span class="hljs-number">0</span>; y = <span class="hljs-number">0</span>;
<span class="hljs-keyword">for</span> k = <span class="hljs-number">1</span>:<span class="hljs-number">10000</span>
    x = x + <span class="hljs-number">1</span>;
    y = y + <span class="hljs-built_in">randn</span>(<span class="hljs-number">1</span>)*<span class="hljs-number">0.5</span>;
    addpoints(h, x, y);
    
    <span class="hljs-comment">% å½“ç‚¹æ•°è¶…è¿‡é˜ˆå€¼ï¼Œæ¸…é™¤å‰500ä¸ªç‚¹</span>
    <span class="hljs-keyword">if</span> k &gt; maxPoints
        removepoints(h, <span class="hljs-number">1</span>:<span class="hljs-number">500</span>);
    <span class="hljs-keyword">end</span>
    
    drawnow limitrate;
<span class="hljs-keyword">end</span>
</code></pre>
<h3 data-id="heading-12">2. æ‰¹é‡æ·»åŠ æ•°æ®ç‚¹ï¼Œå‡å°‘åˆ·æ–°æ¬¡æ•°</h3>
<p><code>addpoints()</code>æ”¯æŒæ‰¹é‡ä¼ å…¥æ•°ç»„ï¼Œè€Œéå•ä¸€ç‚¹ï¼Œå‡å°‘å¾ªç¯å†…çš„å‡½æ•°è°ƒç”¨æ¬¡æ•°ï¼š</p>
<pre><code class="hljs language-matlab" lang="matlab"><span class="hljs-comment">% ä¼˜åŒ–å‰ï¼šé€ç‚¹æ·»åŠ ï¼Œæ•ˆç‡ä½</span>
<span class="hljs-keyword">for</span> k = <span class="hljs-number">1</span>:<span class="hljs-number">1000</span>
    addpoints(h, x(k), y(k));
<span class="hljs-keyword">end</span>

<span class="hljs-comment">% ä¼˜åŒ–åï¼šæ‰¹é‡æ·»åŠ ï¼Œå‡å°‘å‡½æ•°è°ƒç”¨</span>
addpoints(h, x, y); <span class="hljs-comment">% ç›´æ¥ä¼ å…¥æ•°ç»„</span>
</code></pre>
<h3 data-id="heading-13">3. é¿å…åŠ¨æ€åæ ‡è½´è°ƒæ•´</h3>
<p><code>xlim()</code>/<code>ylim()</code>çš„åŠ¨æ€è°ƒæ•´ä¼šè§¦å‘ç”»å¸ƒé‡ç»˜ï¼Œå¯é¢„è®¾è¶³å¤Ÿå¤§çš„è½´èŒƒå›´ï¼Œæˆ–æ¯éš”å¤šå¸§å†è°ƒæ•´ä¸€æ¬¡ï¼š</p>
<pre><code class="hljs language-matlab" lang="matlab"><span class="hljs-comment">% ä¼˜åŒ–å‰ï¼šæ¯å¸§è°ƒæ•´è½´èŒƒå›´ï¼Œå¡é¡¿</span>
<span class="hljs-keyword">for</span> k = <span class="hljs-number">1</span>:<span class="hljs-number">1000</span>
    xlim([x<span class="hljs-number">-100</span> x]);
    ylim([<span class="hljs-built_in">min</span>(y)<span class="hljs-number">-1</span> <span class="hljs-built_in">max</span>(y)+<span class="hljs-number">1</span>]);
<span class="hljs-keyword">end</span>

<span class="hljs-comment">% ä¼˜åŒ–åï¼šæ¯10å¸§è°ƒæ•´ä¸€æ¬¡</span>
<span class="hljs-keyword">for</span> k = <span class="hljs-number">1</span>:<span class="hljs-number">1000</span>
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">mod</span>(k, <span class="hljs-number">10</span>) == <span class="hljs-number">0</span>
        xlim([x<span class="hljs-number">-100</span> x]);
        ylim([<span class="hljs-built_in">min</span>(y)<span class="hljs-number">-1</span> <span class="hljs-built_in">max</span>(y)+<span class="hljs-number">1</span>]);
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h2 data-id="heading-14">äº”ã€å†…å­˜ç®¡ç†ä¼˜åŒ–</h2>
<ol>
<li><strong>åŠæ—¶æ¸…ç†æ— ç”¨å˜é‡</strong>ï¼šç”¨<code>clear</code>åˆ é™¤å¾ªç¯å†…çš„ä¸´æ—¶å˜é‡ï¼Œå°¤å…¶æ˜¯å¤§æ•°ç»„</li>
<li><strong>é¿å…å¤åˆ¶å¤§çŸ©é˜µ</strong>ï¼šç”¨å¼•ç”¨ï¼ˆ<code>~</code>ï¼‰æˆ–ç´¢å¼•ä»£æ›¿çŸ©é˜µå¤åˆ¶ï¼Œå¦‚<code>y = sin(x)</code>è€Œé<code>temp = x; y = sin(temp)</code></li>
<li><strong>é‡Šæ”¾å¸§æ•°æ®</strong>ï¼šæ’­æ”¾å®Œ<code>movie()</code>åŠ¨ç”»åï¼Œç”¨<code>clear mov</code>é‡Šæ”¾å¸§å­˜å‚¨çš„å†…å­˜</li>
<li><strong>å…³é—­ä¸å¿…è¦çš„å›¾å½¢å¯¹è±¡</strong>ï¼šåˆ é™¤æœªä½¿ç”¨çš„çº¿æ¡ã€æ ‡æ³¨ç­‰ï¼Œå‡å°‘å›¾å½¢å¥æŸ„æ•°é‡</li>
</ol>
<h2 data-id="heading-15">å…­ã€ç¡¬ä»¶ä¸ç¯å¢ƒé…ç½®ä¼˜åŒ–</h2>
<ol>
<li><strong>å¯ç”¨ç¡¬ä»¶åŠ é€Ÿ</strong>ï¼šMATLABé»˜è®¤å¯ç”¨GPUç¡¬ä»¶åŠ é€Ÿï¼Œå¯é€šè¿‡<code>opengl info</code>æ£€æŸ¥çŠ¶æ€ï¼Œè‹¥ç¦ç”¨åˆ™æ‰§è¡Œ<code>opengl('enable')</code></li>
<li><strong>å…³é—­åå°ç¨‹åº</strong>ï¼šå‡å°‘CPU/å†…å­˜å ç”¨ï¼Œé¿å…å…¶ä»–ç¨‹åºä¸MATLABäº‰æŠ¢èµ„æº</li>
<li><strong>ä½¿ç”¨64ä½MATLAB</strong>ï¼š32ä½MATLABå†…å­˜é™åˆ¶ä¸º4GBï¼Œ64ä½å¯åˆ©ç”¨æ›´å¤§å†…å­˜ï¼ˆå°¤å…¶é€‚åˆ<code>movie()</code>çš„å¸§å­˜å‚¨ï¼‰</li>
<li><strong>å‡çº§MATLABç‰ˆæœ¬</strong>ï¼šæ–°ç‰ˆMATLABå¯¹ç»˜å›¾å¼•æ“æœ‰æ€§èƒ½ä¼˜åŒ–ï¼ˆå¦‚R2020båçš„<code>painters</code>æ¸²æŸ“å™¨æé€Ÿï¼‰</li>
</ol>
<h2 data-id="heading-16">ä¸ƒã€å¸¸è§æ€§èƒ½é—®é¢˜æ’æŸ¥ä¸è§£å†³</h2>



































<table><thead><tr><th>é—®é¢˜ç°è±¡</th><th>å¸¸è§åŸå› </th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>åŠ¨ç”»å¸§ç‡ä½äº10fps</td><td>å¾ªç¯å†…è®¡ç®—é‡å¤§ã€ç”»å¸ƒé‡ç»˜é¢‘ç¹</td><td>é¢„è®¡ç®—æ•°æ®ã€ç”¨<code>drawnow limitrate</code>ã€ä½å±‚æ¬¡ç»˜å›¾å‡½æ•°</td></tr><tr><td><code>movie()</code>æ’­æ”¾æ—¶å†…å­˜æº¢å‡º</td><td>å¸§æ•°è¿‡å¤šã€ç”»å¸ƒåˆ†è¾¨ç‡è¿‡é«˜</td><td>å‡å°‘å¸§æ•°ã€é™ä½ç”»å¸ƒå°ºå¯¸ã€è¾¹ç”Ÿæˆè¾¹æ’­æ”¾</td></tr><tr><td><code>animatedline()</code>è¶Šç”»è¶Šå¡</td><td>æ•°æ®ç‚¹ç´¯ç§¯è¿‡å¤š</td><td>å®šæœŸæ¸…ç†æ—§ç‚¹ã€æ‰¹é‡æ·»åŠ æ•°æ®</td></tr><tr><td>åŠ¨ç”»ç”»é¢é—ªçƒ</td><td>åæ ‡è½´é¢‘ç¹é‡ç»˜ã€<code>cla</code>ä½¿ç”¨ä¸å½“</td><td>å›ºå®šè½´èŒƒå›´ã€ç”¨<code>cla('reset')</code>ä»£æ›¿<code>cla</code></td></tr><tr><td>ç¡¬ä»¶åŠ é€Ÿå¤±æ•ˆ</td><td>æ˜¾å¡é©±åŠ¨è¿‡æ—¶ã€OpenGLç‰ˆæœ¬ä½</td><td>æ›´æ–°æ˜¾å¡é©±åŠ¨ã€å‡çº§MATLAB</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[eBPFæŠ€æœ¯å…¥é—¨ä¸å®æˆ˜ï¼šLinuxå†…æ ¸é»‘ç§‘æŠ€]]></title>    <link>https://juejin.cn/post/7586972442422525993</link>    <guid>https://juejin.cn/post/7586972442422525993</guid>    <pubDate>2025-12-24T02:13:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586972442422525993" data-draft-id="7586957204585054244" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="eBPFæŠ€æœ¯å…¥é—¨ä¸å®æˆ˜ï¼šLinuxå†…æ ¸é»‘ç§‘æŠ€"/> <meta itemprop="keywords" content="Linux"/> <meta itemprop="datePublished" content="2025-12-24T02:13:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å˜»å“ˆbaby"/> <meta itemprop="url" content="https://juejin.cn/user/485305583405066"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            eBPFæŠ€æœ¯å…¥é—¨ä¸å®æˆ˜ï¼šLinuxå†…æ ¸é»‘ç§‘æŠ€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/485305583405066/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å˜»å“ˆbaby
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T02:13:54.000Z" title="Wed Dec 24 2025 02:13:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä¸‰å¹´å‰ç¬¬ä¸€æ¬¡å¬è¯´eBPFï¼Œè§‰å¾—è¿™ç©æ„ç¦»æˆ‘å¤ªè¿œâ€”â€”å†…æ ¸å¼€å‘ï¼Ÿé‚£æ˜¯ç¥ä»™å¹²çš„äº‹ã€‚</p>
<p>ç›´åˆ°å‰æ®µæ—¶é—´æ’æŸ¥ä¸€ä¸ªè¯¡å¼‚çš„ç½‘ç»œå»¶è¿Ÿé—®é¢˜ï¼Œä¼ ç»Ÿå·¥å…·éƒ½å®šä½ä¸åˆ°æ ¹å› ï¼ŒåŒäº‹ç”©ç»™æˆ‘ä¸€ä¸ªbpftraceè„šæœ¬ï¼Œå‡ ç§’é’Ÿå°±æŠ“åˆ°äº†é—®é¢˜ã€‚é‚£ä¸€åˆ»æˆ‘æ‰æ„è¯†åˆ°ï¼ŒeBPFå·²ç»ä¸æ˜¯ä»€ä¹ˆé«˜æ·±è«æµ‹çš„ä¸œè¥¿ï¼Œè€Œæ˜¯å®æ‰“å®èƒ½è§£å†³é—®é¢˜çš„ç”Ÿäº§åŠ›å·¥å…·ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« æ˜¯æˆ‘å­¦ä¹ å’Œä½¿ç”¨eBPFçš„ä¸€äº›è®°å½•ï¼Œä¸è®²å¤ªå¤šåº•å±‚åŸç†ï¼Œä¸»è¦èŠèŠæ€ä¹ˆç”¨å®ƒè§£å†³å®é™…é—®é¢˜ã€‚</p>
<h2 data-id="heading-1">eBPFæ˜¯ä»€ä¹ˆ</h2>
<p>ç®€å•è¯´ï¼ŒeBPFï¼ˆextended Berkeley Packet Filterï¼‰è®©ä½ å¯ä»¥åœ¨å†…æ ¸é‡Œå®‰å…¨åœ°è¿è¡Œè‡ªå®šä¹‰ç¨‹åºï¼Œè€Œä¸éœ€è¦ä¿®æ”¹å†…æ ¸æºç æˆ–åŠ è½½å†…æ ¸æ¨¡å—ã€‚</p>
<p>ä¼ ç»Ÿçš„åšæ³•è¦è§‚æµ‹å†…æ ¸è¡Œä¸ºï¼Œè¦ä¹ˆæ”¹å†…æ ¸é‡æ–°ç¼–è¯‘ï¼Œè¦ä¹ˆå†™ä¸ªå†…æ ¸æ¨¡å—ã€‚ä¸¤ä¸ªæ–¹æ¡ˆéƒ½å¾ˆé‡ï¼Œé£é™©ä¹Ÿå¤§ã€‚eBPFç›¸å½“äºåœ¨å†…æ ¸é‡Œå¼€äº†ä¸ª"æ²™ç›’"ï¼Œä½ çš„ç¨‹åºåœ¨é‡Œé¢è·‘ï¼Œæ—¢èƒ½è®¿é—®å†…æ ¸æ•°æ®ï¼Œåˆä¸ä¼šæŠŠç³»ç»Ÿæå´©ã€‚</p>
<h3 data-id="heading-2">èƒ½å¹²ä»€ä¹ˆ</h3>
<ul>
<li><strong>ç½‘ç»œ</strong>ï¼šé«˜æ€§èƒ½è´Ÿè½½å‡è¡¡ã€DDoSé˜²æŠ¤ã€æµé‡è¿‡æ»¤</li>
<li><strong>å®‰å…¨</strong>ï¼šç³»ç»Ÿè°ƒç”¨å®¡è®¡ã€å…¥ä¾µæ£€æµ‹ã€å®¹å™¨å®‰å…¨</li>
<li><strong>è§‚æµ‹</strong>ï¼šæ€§èƒ½åˆ†æã€å»¶è¿Ÿè¿½è¸ªã€èµ„æºç›‘æ§</li>
<li><strong>è°ƒè¯•</strong>ï¼šå†…æ ¸å‡½æ•°è¿½è¸ªã€ç”¨æˆ·æ€ç¨‹åºåˆ†æ</li>
</ul>
<p>Cloudflareç”¨eBPFæ‰›DDoSï¼ŒFacebookç”¨å®ƒåšè´Ÿè½½å‡è¡¡ï¼ŒCiliumç”¨å®ƒæå®¹å™¨ç½‘ç»œã€‚è¿™ä¸œè¥¿å·²ç»åœ¨ç”Ÿäº§ç¯å¢ƒå¤§è§„æ¨¡ä½¿ç”¨äº†ã€‚</p>
<h2 data-id="heading-3">ç¯å¢ƒå‡†å¤‡</h2>
<p>eBPFéœ€è¦å†…æ ¸ç‰ˆæœ¬æ”¯æŒï¼Œæœ€ä½4.xï¼Œå»ºè®®5.xä»¥ä¸Šã€‚Ubuntu 20.04/22.04éƒ½æ²¡é—®é¢˜ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥å†…æ ¸ç‰ˆæœ¬</span>
<span class="hljs-built_in">uname</span> -r
<span class="hljs-comment"># 5.15.0-91-generic</span>

<span class="hljs-comment"># å®‰è£…BCCå·¥å…·é›†ï¼ˆæœ€å¸¸ç”¨çš„eBPFå·¥å…·é›†ï¼‰</span>
apt update
apt install -y bpfcc-tools linux-headers-$(<span class="hljs-built_in">uname</span> -r)

<span class="hljs-comment"># å®‰è£…bpftraceï¼ˆé«˜çº§è¿½è¸ªè¯­è¨€ï¼‰</span>
apt install -y bpftrace

<span class="hljs-comment"># éªŒè¯å®‰è£…</span>
bpftrace --version
<span class="hljs-comment"># bpftrace v0.14.0</span>
</code></pre>
<h2 data-id="heading-4">å®æˆ˜ä¸€ï¼šè¿½è¸ªç³»ç»Ÿè°ƒç”¨å»¶è¿Ÿ</h2>
<p>å‰å‡ å¤©é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šæŸä¸ªJavaæœåŠ¡å“åº”å˜æ…¢ï¼Œä½†CPUã€å†…å­˜ã€IOçœ‹ç€éƒ½æ­£å¸¸ã€‚</p>
<p>ç”¨bpftraceè¿½è¸ªä¸€ä¸‹readç³»ç»Ÿè°ƒç”¨çš„å»¶è¿Ÿåˆ†å¸ƒï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿½è¸ªreadè°ƒç”¨å»¶è¿Ÿï¼ˆæŒ‰è¿›ç¨‹åè¿‡æ»¤ï¼‰</span>
bpftrace -e <span class="hljs-string">'
tracepoint:syscalls:sys_enter_read /comm == "java"/ {
    @start[tid] = nsecs;
}
tracepoint:syscalls:sys_exit_read /comm == "java" &amp;&amp; @start[tid]/ {
    @usecs = hist((nsecs - @start[tid]) / 1000);
    delete(@start[tid]);
}
'</span>
</code></pre>
<p>è¾“å‡ºï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@usecs:</span>
[<span class="hljs-number">0</span>]                  <span class="hljs-number">156</span> |@@@@@@@@@@@@@@@                                     |
[<span class="hljs-number">1</span>]                  <span class="hljs-number">489</span> |@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@|
[<span class="hljs-number">2</span>, <span class="hljs-number">4</span>)               <span class="hljs-number">234</span> |@@@@@@@@@@@@@@@@@@@@@@@                             |
[<span class="hljs-number">4</span>, <span class="hljs-number">8</span>)                <span class="hljs-number">67</span> |@@@@@@                                              |
[<span class="hljs-number">8</span>, <span class="hljs-number">16</span>)               <span class="hljs-number">23</span> |@@                                                  |
[<span class="hljs-number">16</span>, <span class="hljs-number">32</span>)              <span class="hljs-number">12</span> |@                                                   |
[<span class="hljs-number">32</span>, <span class="hljs-number">64</span>)               <span class="hljs-number">8</span> |                                                    |
[<span class="hljs-number">64</span>, <span class="hljs-number">128</span>)              <span class="hljs-number">3</span> |                                                    |
[<span class="hljs-number">128</span>, <span class="hljs-number">256</span>)           <span class="hljs-number">156</span> |@@@@@@@@@@@@@@@                                     |  &lt;-- å¼‚å¸¸
</code></pre>
<p>128-256å¾®ç§’è¿™ä¸ªåŒºé—´çš„è°ƒç”¨æ•°é‡å¼‚å¸¸åå¤šï¼Œæ­£å¸¸åº”è¯¥æ˜¯å•å³°åˆ†å¸ƒã€‚è¿›ä¸€æ­¥è¿½è¸ªå‘ç°æ˜¯è¯»å–æŸä¸ªé…ç½®æ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶ç³»ç»Ÿæœ‰é”ç«äº‰ã€‚</p>
<p>è¿™ç§é—®é¢˜ç”¨ä¼ ç»Ÿå·¥å…·ï¼ˆstraceä¼šæ‹–æ…¢è¿›ç¨‹å¤ªå¤šï¼‰å¾ˆéš¾å¿«é€Ÿå®šä½ï¼ŒeBPFå‡ ä¹é›¶å¼€é”€ã€‚</p>
<h2 data-id="heading-5">å®æˆ˜äºŒï¼šç½‘ç»œå»¶è¿Ÿåˆ†æ</h2>
<p>ç”Ÿäº§ç¯å¢ƒæœ‰å°æœºå™¨TCPå»¶è¿Ÿå¶å‘é£™é«˜ï¼Œç½‘ç»œç»„è¯´çº¿è·¯æ²¡é—®é¢˜ã€‚ç”¨tcpretransè¿½è¸ªé‡ä¼ ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># BCCå·¥å…·ï¼šè¿½è¸ªTCPé‡ä¼ </span>
/usr/share/bcc/tools/tcpretrans

<span class="hljs-comment"># è¾“å‡º</span>
TIME     PID    IP LADDR:LPORT          T&gt; RADDR:RPORT          STATE
14:23:15 0      4  10.0.1.5:443         R&gt; 10.0.2.8:52341       ESTABLISHED
14:23:15 0      4  10.0.1.5:443         R&gt; 10.0.2.8:52341       ESTABLISHED
14:23:16 0      4  10.0.1.5:443         R&gt; 10.0.2.8:52341       ESTABLISHED
</code></pre>
<p>åŒä¸€ä¸ªè¿æ¥è¿ç»­é‡ä¼ ï¼Œé—®é¢˜ç¼©å°åˆ°10.0.2.xè¿™ä¸ªç½‘æ®µã€‚æœ€åæŸ¥å‡ºæ¥æ˜¯é‚£ä¸ªæœºæˆ¿çš„äº¤æ¢æœºæœ‰é—®é¢˜ã€‚</p>
<p>æ›´è¿›ä¸€æ­¥ï¼Œçœ‹TCPè¿æ¥å»¶è¿Ÿåˆ†å¸ƒï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿½è¸ªTCPè¿æ¥å»ºç«‹å»¶è¿Ÿ</span>
/usr/share/bcc/tools/tcpconnlat

<span class="hljs-comment"># è¾“å‡º</span>
PID    COMM         IP SADDR            DADDR            DPORT LAT(ms)
1892   curl         4  10.0.1.5         10.0.2.8         443   245.12
1893   curl         4  10.0.1.5         10.0.2.8         443   312.45
1894   curl         4  10.0.1.5         10.0.3.9         443   1.23
</code></pre>
<p>å¯¹æ¯”å¾ˆæ˜æ˜¾ï¼Œè¿10.0.2ç½‘æ®µå»¶è¿Ÿé«˜äº†ä¸¤ä¸ªæ•°é‡çº§ã€‚</p>
<h2 data-id="heading-6">å®æˆ˜ä¸‰ï¼šè¿›ç¨‹çº§èµ„æºç›‘æ§</h2>
<p>æœ‰ä¸ªå®¹å™¨CPUç”¨é‡ä¸€ç›´å¾ˆé«˜ï¼Œä½†topé‡Œçœ‹ä¸å‡ºå“ªä¸ªå‡½æ•°åœ¨æ¶ˆè€—ã€‚ç”¨profileå·¥å…·ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># CPUé‡‡æ ·ç«ç„°å›¾æ•°æ®</span>
/usr/share/bcc/tools/profile -p $(pgrep -f myapp) -f 30 &gt; profile.out

<span class="hljs-comment"># ç”Ÿæˆç«ç„°å›¾ï¼ˆéœ€è¦å®‰è£…FlameGraphï¼‰</span>
git <span class="hljs-built_in">clone</span> https://github.com/brendangregg/FlameGraph
./FlameGraph/flamegraph.pl profile.out &gt; cpu.svg
</code></pre>
<p>ç«ç„°å›¾ä¸€ç›®äº†ç„¶ï¼Œå‘ç°æŸä¸ªJSONè§£æå‡½æ•°å äº†40%çš„CPUã€‚åŸæ¥æ˜¯æ¯æ¬¡è¯·æ±‚éƒ½åœ¨é‡å¤è§£æåŒä¸€ä¸ªå¤§é…ç½®æ–‡ä»¶ï¼ŒåŠ ä¸ªç¼“å­˜è§£å†³ã€‚</p>
<h2 data-id="heading-7">å®æˆ˜å››ï¼šè‡ªå®šä¹‰è¿½è¸ªç‚¹</h2>
<p>æœ‰æ—¶å€™éœ€è¦è¿½è¸ªç‰¹å®šçš„å†…æ ¸å‡½æ•°ã€‚æ¯”å¦‚æƒ³çŸ¥é“æ–‡ä»¶æ‰“å¼€æ“ä½œçš„åˆ†å¸ƒï¼š</p>
<pre><code class="hljs language-bash" lang="bash">bpftrace -e <span class="hljs-string">'
kprobe:do_sys_openat2 {
    @files[str(arg1)] = count();
}
interval:s:5 {
    print(@files);
    clear(@files);
}
'</span>
</code></pre>
<p>è¾“å‡ºæ¯5ç§’æ‰“å°ä¸€æ¬¡æ–‡ä»¶æ‰“å¼€ç»Ÿè®¡ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@files</span>[/etc/ld.so.cache]: <span class="hljs-number">234</span>
<span class="hljs-variable">@files</span>[/lib/x86_64-linux-gnu/libc.so.<span class="hljs-number">6</span>]: <span class="hljs-number">156</span>
<span class="hljs-variable">@files</span>[/proc/self/status]: <span class="hljs-number">89</span>
<span class="hljs-variable">@files</span>[/app/config.json]: <span class="hljs-number">67</span>
...
</code></pre>
<p>è¿™ç§æ–¹å¼å¯¹æ’æŸ¥"åˆ°åº•è°åœ¨é¢‘ç¹è¯»å†™æŸä¸ªæ–‡ä»¶"ç‰¹åˆ«æœ‰ç”¨ã€‚</p>
<h2 data-id="heading-8">å†™ä¸ªç®€å•çš„eBPFç¨‹åº</h2>
<p>BCCæä¾›Pythonæ¥å£ï¼Œå†™èµ·æ¥æ¯”è¾ƒæ–¹ä¾¿ã€‚è¿½è¸ªæ‰€æœ‰çš„execveè°ƒç”¨ï¼ˆæ–°è¿›ç¨‹å¯åŠ¨ï¼‰ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#!/usr/bin/env python3</span>
<span class="hljs-keyword">from</span> bcc <span class="hljs-keyword">import</span> BPF

<span class="hljs-comment"># eBPFç¨‹åºï¼ˆCè¯­è¨€ï¼‰</span>
prog = <span class="hljs-string">"""
#include &lt;linux/sched.h&gt;

struct data_t {
    u32 pid;
    char comm[TASK_COMM_LEN];
};

BPF_PERF_OUTPUT(events);

int trace_execve(struct pt_regs *ctx) {
    struct data_t data = {};
    
    data.pid = bpf_get_current_pid_tgid() &gt;&gt; 32;
    bpf_get_current_comm(&amp;data.comm, sizeof(data.comm));
    
    events.perf_submit(ctx, &amp;data, sizeof(data));
    return 0;
}
"""</span>

b = BPF(text=prog)
b.attach_kprobe(event=<span class="hljs-string">"__x64_sys_execve"</span>, fn_name=<span class="hljs-string">"trace_execve"</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"è¿½è¸ªæ–°è¿›ç¨‹å¯åŠ¨ï¼ŒCtrl+Cé€€å‡º..."</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">print_event</span>(<span class="hljs-params">cpu, data, size</span>):
    event = b[<span class="hljs-string">"events"</span>].event(data)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"PID: <span class="hljs-subst">{event.pid}</span>, COMM: <span class="hljs-subst">{event.comm.decode()}</span>"</span>)

b[<span class="hljs-string">"events"</span>].open_perf_buffer(print_event)
<span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
    b.perf_buffer_poll()
</code></pre>
<p>è¿è¡Œæ•ˆæœï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">è¿½è¸ªæ–°è¿›ç¨‹å¯åŠ¨ï¼ŒCtrl+Cé€€å‡º...</span>
<span class="hljs-attr">PID:</span> <span class="hljs-number">12345</span><span class="hljs-string">,</span> <span class="hljs-attr">COMM:</span> <span class="hljs-string">bash</span>
<span class="hljs-attr">PID:</span> <span class="hljs-number">12346</span><span class="hljs-string">,</span> <span class="hljs-attr">COMM:</span> <span class="hljs-string">ls</span>
<span class="hljs-attr">PID:</span> <span class="hljs-number">12347</span><span class="hljs-string">,</span> <span class="hljs-attr">COMM:</span> <span class="hljs-string">grep</span>
</code></pre>
<p>è¿™å¯¹å®‰å…¨å®¡è®¡å¾ˆæœ‰ä»·å€¼â€”â€”è°åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œäº†ä»€ä¹ˆå‘½ä»¤ï¼Œä¸€æ¸…äºŒæ¥šã€‚</p>
<h2 data-id="heading-9">ç”Ÿäº§ç¯å¢ƒä½¿ç”¨å»ºè®®</h2>
<h3 data-id="heading-10">æ€§èƒ½å¼€é”€</h3>
<p>eBPFçš„å¼€é”€å¾ˆä½ï¼Œä½†ä¸æ˜¯é›¶ã€‚å‡ ä¸ªåŸåˆ™ï¼š</p>
<ol>
<li><strong>è¿‡æ»¤è¦å‰ç½®</strong>ï¼šåœ¨eBPFç¨‹åºé‡Œåšè¿‡æ»¤ï¼Œè€Œä¸æ˜¯å…¨é‡é‡‡é›†å†åœ¨ç”¨æˆ·æ€è¿‡æ»¤</li>
<li><strong>é‡‡æ ·è€Œéå…¨é‡</strong>ï¼šprofileç”¨é‡‡æ ·ï¼Œä¸è¦æ¯ä¸ªäº‹ä»¶éƒ½è¿½è¸ª</li>
<li><strong>æ§åˆ¶è¾“å‡ºé¢‘ç‡</strong>ï¼šç”¨intervalèšåˆï¼Œä¸è¦æ¯ä¸ªäº‹ä»¶éƒ½è¾“å‡º</li>
</ol>
<h3 data-id="heading-11">å¸¸ç”¨å·¥å…·é€ŸæŸ¥</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ€§èƒ½åˆ†æ</span>
profile      <span class="hljs-comment"># CPUç«ç„°å›¾</span>
offcputime   <span class="hljs-comment"># Off-CPUæ—¶é—´åˆ†æ</span>
runqlat      <span class="hljs-comment"># è¿è¡Œé˜Ÿåˆ—å»¶è¿Ÿ</span>

<span class="hljs-comment"># ç½‘ç»œ</span>
tcplife      <span class="hljs-comment"># TCPè¿æ¥ç”Ÿå‘½å‘¨æœŸ</span>
tcpretrans   <span class="hljs-comment"># TCPé‡ä¼ è¿½è¸ª</span>
tcpconnlat   <span class="hljs-comment"># TCPè¿æ¥å»¶è¿Ÿ</span>

<span class="hljs-comment"># ç£ç›˜IO</span>
biolatency   <span class="hljs-comment"># å—è®¾å¤‡IOå»¶è¿Ÿ</span>
biosnoop     <span class="hljs-comment"># å—è®¾å¤‡IOè¿½è¸ª</span>
ext4slower   <span class="hljs-comment"># ext4æ…¢æ“ä½œ</span>

<span class="hljs-comment"># å†…å­˜</span>
memleak      <span class="hljs-comment"># å†…å­˜æ³„æ¼æ£€æµ‹</span>
cachestat    <span class="hljs-comment"># ç¼“å­˜å‘½ä¸­ç‡</span>

<span class="hljs-comment"># ç³»ç»Ÿè°ƒç”¨</span>
execsnoop    <span class="hljs-comment"># è¿›ç¨‹å¯åŠ¨è¿½è¸ª</span>
opensnoop    <span class="hljs-comment"># æ–‡ä»¶æ‰“å¼€è¿½è¸ª</span>
</code></pre>
<h3 data-id="heading-12">å¤šæœºå™¨æ‰¹é‡æ’æŸ¥</h3>
<p>é‡åˆ°è·¨å¤šå°æœåŠ¡å™¨çš„é—®é¢˜æ—¶ï¼Œéœ€è¦åŒæ—¶åœ¨å¤šä¸ªèŠ‚ç‚¹è¿è¡ŒeBPFå·¥å…·åšå¯¹æ¯”åˆ†æã€‚è¿™ç§åœºæ™¯ä¸‹æˆ‘ä¼šç”¨æ˜Ÿç©ºç»„ç½‘å…ˆæŠŠå„ä¸ªç½‘æ®µçš„æœºå™¨ä¸²èµ·æ¥ï¼Œç»Ÿä¸€ç®¡ç†åå†æ‰¹é‡è·‘è¯Šæ–­è„šæœ¬ï¼Œæ¯”é€å°SSHæ•ˆç‡é«˜å¾ˆå¤šã€‚</p>
<h2 data-id="heading-13">è¿›é˜¶å­¦ä¹ èµ„æº</h2>
<ul>
<li><strong>ã€ŠBPF Performance Toolsã€‹</strong> by Brendan Gregg - è¿™æœ¬ä¹¦æ˜¯åœ£ç»çº§åˆ«çš„</li>
<li><strong>bccå®˜æ–¹ä»“åº“</strong>ï¼šgithub.com/iovisor/bcc - å¤§é‡ç°æˆå·¥å…·å’Œç¤ºä¾‹</li>
<li><strong>bpftraceå‚è€ƒ</strong>ï¼šgithub.com/iovisor/bpftrace - è¿½è¸ªè¯­è¨€æ–‡æ¡£</li>
<li><strong>Cilium eBPFæ•™ç¨‹</strong>ï¼šdocs.cilium.io - ç½‘ç»œæ–¹å‘çš„æœ€ä½³å®è·µ</li>
</ul>
<h2 data-id="heading-14">æ€»ç»“</h2>
<p>eBPFä¸å†æ˜¯å†…æ ¸é»‘å®¢çš„ä¸“å±ç©å…·ã€‚å¯¹äºè¿ç»´å’Œåç«¯å¼€å‘æ¥è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¨åŠ›å·¨å¤§çš„é—®é¢˜æ’æŸ¥å·¥å…·ï¼š</p>
<ol>
<li><strong>ä½å¼€é”€</strong>ï¼šç”Ÿäº§ç¯å¢ƒå¯ç”¨</li>
<li><strong>é«˜ç²¾åº¦</strong>ï¼šå†…æ ¸çº§åˆ«çš„è§‚æµ‹èƒ½åŠ›</li>
<li><strong>çµæ´»</strong>ï¼šå¯ä»¥è‡ªå®šä¹‰è¿½è¸ªé€»è¾‘</li>
<li><strong>å®‰å…¨</strong>ï¼šå†…æ ¸ä¿è¯ç¨‹åºä¸ä¼šæå´©ç³»ç»Ÿ</li>
</ol>
<p>ä»BCCå·¥å…·é›†å…¥æ‰‹ï¼Œé‡åˆ°é—®é¢˜å…ˆè¯•è¯•ç°æˆå·¥å…·ï¼Œç†Ÿç»ƒåå†å°è¯•å†™è‡ªå®šä¹‰è¿½è¸ªç¨‹åºã€‚è¿™ä¸ªå­¦ä¹ è·¯å¾„æ¯”è¾ƒå¹³æ»‘ã€‚</p>
<p>è¯´å®è¯ï¼Œç”¨æƒ¯äº†eBPFå†å›å¤´çœ‹ä¼ ç»Ÿçš„æ’æŸ¥æ‰‹æ®µï¼Œä¼šè§‰å¾—æ•ˆç‡å·®å¤ªå¤šã€‚æ¨èæ¯ä¸ªåšæœåŠ¡ç«¯çš„åŒå­¦éƒ½äº†è§£ä¸€ä¸‹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è‡ªé¡¶å‘ä¸‹ or è‡ªåº•å‘ä¸Šï¼Ÿå§¿æ€ä¼°è®¡æŠ€æœ¯æ˜¯å¦‚ä½•è¿›åŒ–çš„ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7586941997194821684</link>    <guid>https://juejin.cn/post/7586941997194821684</guid>    <pubDate>2025-12-24T02:19:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586941997194821684" data-draft-id="7587207950248411136" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è‡ªé¡¶å‘ä¸‹ or è‡ªåº•å‘ä¸Šï¼Ÿå§¿æ€ä¼°è®¡æŠ€æœ¯æ˜¯å¦‚ä½•è¿›åŒ–çš„ï¼Ÿ"/> <meta itemprop="keywords" content="ç®—æ³•,è®¡ç®—æœºè§†è§‰,æ·±åº¦å­¦ä¹ "/> <meta itemprop="datePublished" content="2025-12-24T02:19:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="CoovallyAIHub"/> <meta itemprop="url" content="https://juejin.cn/user/2461151071843739"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è‡ªé¡¶å‘ä¸‹ or è‡ªåº•å‘ä¸Šï¼Ÿå§¿æ€ä¼°è®¡æŠ€æœ¯æ˜¯å¦‚ä½•è¿›åŒ–çš„ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2461151071843739/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    CoovallyAIHub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T02:19:52.000Z" title="Wed Dec 24 2025 02:19:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>äººç±»å¤©ç”Ÿå°±èƒ½æœ¬èƒ½åœ°ç†è§£åŠ¨ä½œã€‚å½“æœ‰äººå‰å€¾ã€è½¬å¤´æˆ–æŠ¬æ‰‹æ—¶ï¼Œä½ ç«‹åˆ»å°±èƒ½æ¨æ–­å‡ºä»–ä»¬åœ¨åšä»€ä¹ˆã€‚è¿™æ˜¯ä¸€ç§æ— å£°çš„ã€è¿‘ä¹ä¸‹æ„è¯†çš„æŠ€èƒ½ï¼Œå¡‘é€ ç€æˆ‘ä»¬ä¸ä»–äººäº’åŠ¨å’Œæ¢ç´¢ä¸–ç•Œçš„æ–¹å¼ã€‚</p>
<p>éšç€ç§‘æŠ€åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­æ—¥ç›Šæ™®åŠï¼Œæˆ‘ä»¬å¾ˆè‡ªç„¶åœ°å¸Œæœ›è®¾å¤‡èƒ½åƒæˆ‘ä»¬ä¸€æ ·æµç•…åœ°ç†è§£åŠ¨ä½œã€‚è¿‘å¹´æ¥äººå·¥æ™ºèƒ½çš„è¿›æ­¥ï¼Œç‰¹åˆ«æ˜¯åŸºäºæ·±åº¦å­¦ä¹ çš„å‘å±•ï¼Œæ­£è®©è¿™æˆä¸ºå¯èƒ½ã€‚å…¶ä¸­ï¼Œè®¡ç®—æœºè§†è§‰å¸®åŠ©æœºå™¨ä»å›¾åƒå’Œè§†é¢‘ä¸­æå–æ„ä¹‰ï¼Œæ˜¯æ¨åŠ¨è¿™ä¸€è¿›ç¨‹çš„å…³é”®ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå§¿æ€ä¼°è®¡æ˜¯ä¸€é¡¹å¸¸è§çš„è®¡ç®—æœºè§†è§‰ä»»åŠ¡ï¼Œå®ƒå¯ä»¥é¢„æµ‹å›¾åƒæˆ–è§†é¢‘å¸§ä¸­é¢„å®šä¹‰çš„èº«ä½“å…³é”®ç‚¹ï¼ˆå¦‚è‚©è†€ã€è‚˜éƒ¨ã€é«‹éƒ¨ã€è†ç›–ï¼‰çš„ä½ç½®ã€‚è¿™äº›å…³é”®ç‚¹å¯ä»¥é€šè¿‡ä¸€ä¸ªå›ºå®šçš„éª¨æ¶å®šä¹‰è¿æ¥èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªç®€åŒ–çš„äººä½“å§¿æ€è¡¨ç¤ºã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c4a3d3a008b47c2ba8c889f36cb1101~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767147592&amp;x-signature=C1ZZ2GXszFhp%2FuEOdF9sxRhncCE%3D" alt="screenshot_2025-12-23_16-19-24.png" loading="lazy"/></p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨å§¿æ€ä¼°è®¡å·¥å…·ï¼Œäº†è§£å…¶å·¥ä½œåŸç†ã€åº”ç”¨åœºæ™¯ä»¥åŠç›®å‰å¯ç”¨çš„é¡¶çº§æ¨¡å‹å’Œåº“ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ï¼</p>
<h2 data-id="heading-0"><strong>ä»€ä¹ˆæ˜¯å§¿æ€ä¼°è®¡ï¼Ÿ</strong></h2>
<p>å§¿æ€ä¼°è®¡æ˜¯ä¸€ç§è®¡ç®—æœºè§†è§‰æŠ€æœ¯ï¼Œå¸®åŠ©ç³»ç»Ÿç†è§£äººæˆ–ç‰©ä½“åœ¨å›¾åƒæˆ–è§†é¢‘ä¸­çš„å§¿æ€ã€‚å®ƒä¸æ˜¯å¹³å‡åˆ†ææ¯ä¸ªåƒç´ ï¼Œè€Œæ˜¯é¢„æµ‹ä¸€ç»„ä¸€è‡´çš„åœ°æ ‡ç‚¹ï¼Œä¾‹å¦‚å¤´éƒ¨ã€è‚©è†€ã€è‚˜éƒ¨ã€é«‹éƒ¨ã€è†ç›–å’Œè„šè¸ã€‚</p>
<p>å¤§å¤šæ•°æ¨¡å‹ä¼šè¾“å‡ºè¿™äº›å…³é”®ç‚¹çš„åæ ‡ï¼Œä»¥åŠä¸€ä¸ªåæ˜ æ¯ä¸ªé¢„æµ‹æ­£ç¡®å¯èƒ½æ€§çš„ç½®ä¿¡åº¦åˆ†æ•°ã€‚ç„¶åï¼Œè¿™äº›å…³é”®ç‚¹å¯ä»¥é€šè¿‡é¢„å®šä¹‰çš„éª¨æ¶å¸ƒå±€è¿æ¥èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªç®€å•çš„å§¿æ€è¡¨ç¤ºã€‚</p>
<p>å½“é€å¸§åº”ç”¨äºè§†é¢‘æ—¶ï¼Œå¾—åˆ°çš„å…³é”®ç‚¹å¯ä»¥éšæ—¶é—´å…³è”èµ·æ¥ä»¥ä¼°è®¡è¿åŠ¨ã€‚è¿™ä½¿å¾—åŠ¨ä½œå½¢å¼æ£€æŸ¥ã€è¿åŠ¨åˆ†æå’ŒåŸºäºæ‰‹åŠ¿çš„äº¤äº’ç­‰åº”ç”¨æˆä¸ºå¯èƒ½ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f81b16f7a4ac4b4aa2180f28ad96e0ac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767147592&amp;x-signature=dgNQfQDqqGR5Ab3oW2D5Lxi5oYM%3D" alt="screenshot_2025-12-23_16-20-22.png" loading="lazy"/></p>
<h2 data-id="heading-1"><strong>ä¸ºä»€ä¹ˆéœ€è¦å§¿æ€ä¼°è®¡å·¥å…·ï¼Ÿ</strong></h2>
<p>äººä½“åŠ¨ä½œæ‰¿è½½ç€å¤§é‡ä¿¡æ¯ã€‚ä¸€ä¸ªäººçš„å¼¯è…°ã€ä¼¸æ‰‹æˆ–é‡å¿ƒè½¬ç§»æ–¹å¼å¯ä»¥æ­ç¤ºå…¶æ„å›¾ã€åŠªåŠ›ç¨‹åº¦ã€ç–²åŠ³ç”šè‡³å—ä¼¤é£é™©ã€‚ç›´åˆ°æœ€è¿‘ï¼Œè¦æ•æ‰è¿™ç§ç»†èŠ‚é€šå¸¸è¿˜éœ€è¦ä¸“é—¨çš„ä¼ æ„Ÿå™¨ã€åŠ¨ä½œæ•æ‰æœæˆ–å—æ§çš„å®éªŒå®¤ç¯å¢ƒã€‚</p>
<p>å§¿æ€ä¼°è®¡æ”¹å˜äº†è¿™ä¸€ç‚¹ã€‚ä»æ™®é€šå›¾åƒå’Œè§†é¢‘ä¸­æå–å…³é”®èº«ä½“åœ°æ ‡ç‚¹ï¼Œä½¿å¾—è®¡ç®—æœºèƒ½å¤Ÿä½¿ç”¨æ ‡å‡†æ‘„åƒå¤´åˆ†æåŠ¨ä½œã€‚è¿™è®©è¿åŠ¨åˆ†æå˜å¾—æ›´åŠ æ˜“äºè·å–ã€å¯æ‰©å±•ï¼Œä¹Ÿæ›´èƒ½é€‚åº”ç°å®ä¸–ç•Œçš„å®é™…åº”ç”¨ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å§¿æ€ä¼°è®¡äº§ç”Ÿå½±å“çš„å‡ ç§æ–¹å¼ï¼š</p>
<ul>
<li><strong>æ›´å®‰å…¨çš„å·¥ä½œåœºæ‰€ï¼š</strong> è§†è§‰é©±åŠ¨çš„ç³»ç»Ÿå¯ç”¨äºåœ¨å—ä¼¤å‘ç”Ÿå‰æ£€æµ‹å±é™©å§¿åŠ¿ã€é‡å¤æ€§åŠ³æŸæˆ–ä¸å®‰å…¨çš„ä¸¾é‡æŠ€æœ¯ã€‚</li>
<li><strong>æ›´å¥½çš„å¥èº«å’Œè¿åŠ¨è®­ç»ƒï¼š</strong> è§†è§‰AIè§£å†³æ–¹æ¡ˆå¯ä»¥å®æ—¶è¯„ä¼°å§¿åŠ¿ã€å¹³è¡¡å’ŒæŠ€æœ¯ï¼Œæ— éœ€å¯ç©¿æˆ´è®¾å¤‡å³å¯ä¸ºç”¨æˆ·æä¾›å³æ—¶åé¦ˆã€‚</li>
<li><strong>åŒ»ç–—ä¿å¥å’Œåº·å¤ï¼š</strong> ä¸´åºŠåŒ»ç”Ÿå¯ä»¥ä½¿ç”¨ç®€å•çš„è§†é¢‘è®°å½•è¿œç¨‹è·Ÿè¸ªæ¢å¤è¿›åº¦ã€å§¿åŠ¿å’Œæ´»åŠ¨èŒƒå›´ã€‚</li>
<li><strong>äº’åŠ¨ä½“éªŒï¼š</strong> å§¿æ€ä¼°è®¡è®©æ•°å­—è™šæ‹Ÿå½¢è±¡å’Œæ²‰æµ¸å¼ç¯å¢ƒèƒ½å¤Ÿæ›´å‡†ç¡®åœ°è·Ÿéšå’Œåæ˜ äººä½“è¿åŠ¨ã€‚</li>
</ul>
<h2 data-id="heading-2"><strong>å§¿æ€ä¼°è®¡ç®—æ³•çš„æ¼”è¿›</strong></h2>
<p>å§¿æ€ä¼°è®¡çš„æƒ³æ³•å·²ç»å­˜åœ¨å¤šå¹´ã€‚æ—©æœŸæ–¹æ³•ä½¿ç”¨ç®€å•çš„å‡ ä½•æ¨¡å‹å’Œæ‰‹å·¥åˆ¶å®šçš„è§„åˆ™ï¼Œé€šå¸¸åªåœ¨å—æ§æ¡ä»¶ä¸‹æœ‰æ•ˆã€‚</p>
<p>ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªäººé™æ­¢ç«™ç«‹åœ¨å›ºå®šä½ç½®æ—¶ï¼Œç³»ç»Ÿå¯èƒ½è¡¨ç°è‰¯å¥½ï¼Œä½†å½“ä»–ä»¬åœ¨ç°å®åœºæ™¯ä¸­å¼€å§‹è¡Œèµ°ã€è½¬èº«æˆ–ä¸ç‰©ä½“äº’åŠ¨æ—¶ï¼Œç³»ç»Ÿå°±å¯èƒ½å¤±æ•ˆã€‚è¿™äº›æ–¹æ³•å¾€å¾€éš¾ä»¥åº”å¯¹è‡ªç„¶è¿åŠ¨ã€å˜åŒ–çš„æ‘„åƒæœºè§’åº¦ã€æ‚ä¹±çš„èƒŒæ™¯å’Œéƒ¨åˆ†é®æŒ¡ã€‚</p>
<p>ç°ä»£å§¿æ€ä¼°è®¡ä¾é æ·±åº¦å­¦ä¹ æ¥åº”å¯¹è¿™äº›æŒ‘æˆ˜ã€‚é€šè¿‡åœ¨å¤§å‹æ ‡æ³¨æ•°æ®é›†ä¸Šè®­ç»ƒå·ç§¯ç¥ç»ç½‘ç»œï¼Œæ¨¡å‹å­¦ä¹ åˆ°è§†è§‰æ¨¡å¼ï¼Œå¸®åŠ©å®ƒä»¬åœ¨ä¸åŒå§¿æ€ã€äººç‰©å’Œç¯å¢ƒä¸­æ›´å¯é åœ°æ£€æµ‹å…³é”®ç‚¹ã€‚éšç€çœ‹åˆ°æ›´å¤šæ ·æœ¬ï¼Œæ¨¡å‹ä¼šæ”¹è¿›å…¶é¢„æµ‹ï¼Œå¹¶æ›´å¥½åœ°æ³›åŒ–åˆ°æ–°çš„åœºæ™¯ã€‚ç”±äºè¿™äº›è¿›æ­¥ï¼Œå§¿æ€ä¼°è®¡ç°åœ¨æ”¯æŒå¹¿æ³›çš„å®é™…åº”ç”¨ï¼ŒåŒ…æ‹¬å·¥ä½œåœºæ‰€ç›‘æ§ã€äººä½“å·¥ç¨‹å­¦å’Œä½“è‚²åˆ†æï¼Œæ•™ç»ƒå’Œåˆ†æå¸ˆå€Ÿæ­¤ç ”ç©¶è¿åŠ¨å‘˜çš„åŠ¨ä½œã€‚</p>
<h2 data-id="heading-3"><strong>å§¿æ€ä¼°è®¡æŠ€æœ¯çš„ç±»å‹</strong></h2>
<p>å§¿æ€ä¼°è®¡æ ¹æ®ç¯å¢ƒå’Œéœ€è¦æµ‹é‡çš„å†…å®¹ï¼Œæœ‰å‡ ç§ä¸åŒçš„å½¢å¼ã€‚ä»¥ä¸‹æ˜¯æ‚¨ä¼šé‡åˆ°çš„ä¸»è¦ç±»å‹ï¼š</p>
<ul>
<li><strong>2Då§¿æ€ä¼°è®¡ï¼š</strong> è¿™ç§æ–¹æ³•åœ¨äºŒç»´å›¾åƒæˆ–è§†é¢‘å¸§ä¸­æ£€æµ‹èº«ä½“å…³é”®ç‚¹ã€‚å®ƒé€‚ç”¨äºæ ‡å‡†æ‘„åƒå¤´ï¼Œè®¡ç®—æ•ˆç‡é«˜ï¼Œé€‚åˆåŸºæœ¬çš„è¿åŠ¨è·Ÿè¸ªã€å§¿åŠ¿åˆ†æå’Œå®æ—¶å§¿åŠ¿åé¦ˆç­‰ä»»åŠ¡ã€‚</li>
<li><strong>3Då§¿æ€ä¼°è®¡ï¼š</strong> é€šè¿‡é¢å¤–ä¼°è®¡æ·±åº¦ä¿¡æ¯ï¼Œ3Då§¿æ€æä¾›äº†å¯¹èº«ä½“è¿åŠ¨çš„ç©ºé—´ç†è§£ã€‚è¿™åœ¨å‰åè¿åŠ¨å¾ˆé‡è¦æ—¶å°¤å…¶æœ‰ç”¨ï¼Œä¾‹å¦‚ä½“è‚²åˆ†æã€åº·å¤ã€ç”Ÿç‰©åŠ›å­¦å’ŒåŠ¨ç”»åˆ¶ä½œã€‚å…·ä½“æ¥è¯´ï¼Œ3Däººä½“å§¿æ€ä¼°è®¡æ•è·ä¸‰ç»´ç©ºé—´ä¸­çš„å…³èŠ‚ä½ç½®å’Œè¿åŠ¨ï¼Œå‡å°‘äº†2DæŠ•å½±å¯èƒ½äº§ç”Ÿçš„æ¨¡ç³Šæ€§ã€‚</li>
<li><strong>å•äººå§¿æ€ä¼°è®¡ï¼š</strong> è¿™äº›ç³»ç»Ÿæ—¨åœ¨ä¸€æ¬¡è·Ÿè¸ªä¸€ä¸ªä¸ªä½“ã€‚å®ƒä»¬é€šå¸¸åœ¨å—æ§æˆ–åŠå—æ§ç¯å¢ƒä¸­è¡¨ç°æœ€ä½³ï¼Œä¾‹å¦‚æŒ‡å¯¼æ€§é”»ç‚¼åº”ç”¨ã€è§†é¢‘é€šè¯æˆ–è¿åŠ¨åˆ†æè®¾ç½®ã€‚</li>
<li><strong>å¤šäººå§¿æ€ä¼°è®¡ï¼š</strong> ä¸ºæœ‰å¤šäººçš„åœºæ™¯è®¾è®¡ï¼Œè¿™ç§æ–¹æ³•å¯ä»¥åŒæ—¶æ£€æµ‹å’Œè·Ÿè¸ªå¤šä¸ªä¸ªä½“çš„å§¿æ€ã€‚è¿™åœ¨ç¹å¿™çš„ç¯å¢ƒä¸­ç‰¹åˆ«æœ‰ç”¨ï¼Œä¾‹å¦‚å·¥ä½œåœºæ‰€ã€å¥èº«æˆ¿ã€å…¬å…±ç©ºé—´å’Œå›¢ä½“æ´»åŠ¨ä¸­ï¼Œå› ä¸ºç›®æ ‡äººç‰©å¯èƒ½ä¼šé‡å æˆ–ç›¸äº’é®æŒ¡ã€‚</li>
</ul>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c438b1072cb43f6bdba0729f8e38c03~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767147592&amp;x-signature=%2BMMfFplej%2BIHtgVAzgW6nExf3UU%3D" alt="screenshot_2025-12-23_16-20-36.png" loading="lazy"/></p>
<h2 data-id="heading-4"><strong>äº†è§£äººä½“å§¿æ€ä¼°è®¡æ¨¡å‹å¦‚ä½•å·¥ä½œ</strong></h2>
<p>å§¿æ€ä¼°è®¡å¯ä»¥åº”ç”¨äºè®¸å¤šç§ç±»çš„ç‰©ä½“ï¼Œä½†ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬é‡ç‚¹è®¨è®ºäººä½“å§¿æ€ä¼°è®¡ã€‚</p>
<p>å¤§å¤šæ•°äººä½“å§¿æ€ä¼°è®¡ç³»ç»Ÿæ˜¯åœ¨æ ‡æ³¨æ•°æ®é›†ä¸Šè®­ç»ƒçš„ï¼Œè¿™äº›æ•°æ®é›†åŒ…å«å¤§é‡å›¾åƒå’Œè§†é¢‘å¸§ï¼Œå…¶ä¸­äººä½“å…³é”®éƒ¨ä½è¢«æ ‡è®°å‡ºæ¥ã€‚é€šè¿‡è¿™äº›æ ·æœ¬ï¼Œæ¨¡å‹å­¦ä¹ åˆ°ä¸äººä½“åœ°æ ‡ç‚¹ï¼ˆå¦‚è‚©è†€ã€è‚˜éƒ¨ã€é«‹éƒ¨ã€è†ç›–ã€è„šè¸ï¼‰ç›¸å…³çš„è§†è§‰æ¨¡å¼ï¼Œä»è€Œèƒ½åœ¨æ–°åœºæ™¯ä¸­å‡†ç¡®é¢„æµ‹å…³é”®ç‚¹ã€‚</p>
<p>å¦ä¸€ä¸ªå…³é”®æ–¹é¢æ˜¯æ¨¡å‹çš„æ¨ç†æ¶æ„ï¼Œå®ƒå†³å®šäº†æ¨¡å‹å¦‚ä½•æ£€æµ‹å…³é”®ç‚¹å¹¶å°†å®ƒä»¬ç»„è£…æˆå®Œæ•´çš„å§¿æ€ã€‚æœ‰äº›ç³»ç»Ÿå…ˆæ£€æµ‹æ¯ä¸ªäººï¼Œç„¶ååœ¨æ¯ä¸ªäººçš„åŒºåŸŸå†…ä¼°è®¡å…³é”®ç‚¹ï¼›å¦ä¸€äº›ç³»ç»Ÿåˆ™åœ¨æ•´ä¸ªå›¾åƒä¸­æ£€æµ‹å…³é”®ç‚¹ï¼Œç„¶åå†å°†å®ƒä»¬åˆ†ç»„åˆ°ä¸ªä½“èº«ä¸Šã€‚è¾ƒæ–°çš„å•é˜¶æ®µè®¾è®¡å¯ä»¥åœ¨ä¸€æ¬¡å‰å‘ä¼ æ’­ä¸­é¢„æµ‹å§¿æ€ï¼Œå¹³è¡¡äº†å®æ—¶åº”ç”¨çš„é€Ÿåº¦å’Œå‡†ç¡®æ€§ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬è¯¦ç»†äº†è§£ä¸€ä¸‹ä¸åŒçš„å§¿æ€ä¼°è®¡æ–¹æ³•ã€‚</p>
<ul>
<li><strong>è‡ªåº•å‘ä¸Šçš„å§¿æ€ä¼°è®¡</strong></li>
</ul>
<p>åœ¨è‡ªåº•å‘ä¸Šçš„æ–¹æ³•ä¸­ï¼Œæ¨¡å‹é¦–å…ˆæŸ¥çœ‹æ•´ä¸ªå›¾åƒï¼Œæ‰¾å‡ºæ‰€æœ‰èº«ä½“å…³é”®ç‚¹ï¼Œæ¯”å¦‚å¤´ã€è‚©ã€è‚˜ã€é«‹ã€è†ã€è¸ã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼Œå®ƒå¹¶ä¸è¯•å›¾åŒºåˆ†ä¸åŒçš„äººã€‚å®ƒåªæ˜¯åœ¨æ•´ä¸ªåœºæ™¯ä¸­æ£€æµ‹ç”±å§¿æ€éª¨æ¶å®šä¹‰çš„æ‰€æœ‰å…³é”®ç‚¹æˆ–èº«ä½“å…³èŠ‚ã€‚</p>
<p>ä¹‹åï¼Œç³»ç»Ÿè¿›è¡Œç¬¬äºŒæ­¥æ¥â€œè¿æ¥è¿™äº›ç‚¹â€ã€‚å®ƒå°†å±äºåŒä¸€ä¸ªäººçš„å…³é”®ç‚¹è¿æ¥èµ·æ¥ï¼Œå¹¶åˆ†ç»„å½¢æˆå®Œæ•´çš„éª¨æ¶ã€‚ç”±äºå®ƒä¸éœ€è¦å…ˆæ£€æµ‹æ¯ä¸ªäººï¼Œè‡ªåº•å‘ä¸Šçš„æ–¹æ³•é€šå¸¸åœ¨æ‹¥æŒ¤çš„åœºæ™¯ä¸­è¡¨ç°è‰¯å¥½ï¼Œæ¯”å¦‚äººç‰©é‡å ã€å¤§å°ä¸ä¸€æˆ–éƒ¨åˆ†è¢«é®æŒ¡çš„æƒ…å†µã€‚</p>
<ul>
<li><strong>è‡ªé¡¶å‘ä¸‹çš„å§¿æ€æ£€æµ‹</strong></li>
</ul>
<p>ç›¸æ¯”ä¹‹ä¸‹ï¼Œè‡ªé¡¶å‘ä¸‹çš„ç³»ç»Ÿé¦–å…ˆæ£€æµ‹å›¾åƒä¸­çš„æ¯ä¸ªäººã€‚å®ƒä»¬åœ¨æ¯ä¸ªä¸ªä½“å‘¨å›´æ”¾ç½®ä¸€ä¸ªè¾¹ç•Œæ¡†ï¼Œå¹¶å°†æ¯ä¸ªæ¡†è§†ä¸ºç‹¬ç«‹çš„åˆ†æåŒºåŸŸã€‚</p>
<p>ä¸€æ—¦ä¸€ä¸ªäººè¢«å•ç‹¬éš”ç¦»å‡ºæ¥ï¼Œæ¨¡å‹å°±ä¼šé¢„æµ‹è¯¥åŒºåŸŸå†…çš„èº«ä½“å…³é”®ç‚¹ã€‚è¿™ç§åˆ†æ­¥è¿›è¡Œçš„è®¾ç½®é€šå¸¸èƒ½äº§ç”Ÿéå¸¸å‡†ç¡®çš„ç»“æœï¼Œå°¤å…¶æ˜¯åœ¨åœºæ™¯ä¸­åªæœ‰å°‘æ•°äººä¸”æ¯ä¸ªäººéƒ½æ¸…æ™°å¯è§çš„æƒ…å†µä¸‹ã€‚</p>
<ul>
<li><strong>å•é˜¶æ®µæˆ–æ··åˆå§¿æ€ä¼°è®¡</strong></li>
</ul>
<p>å•é˜¶æ®µï¼ˆæœ‰æ—¶ç§°ä¸ºæ··åˆï¼‰æ¨¡å‹åœ¨ä¸€æ¬¡å‰å‘ä¼ æ’­ä¸­é¢„æµ‹å§¿æ€ã€‚å®ƒä»¬ä¸æ˜¯å…ˆè¿è¡Œäººå‘˜æ£€æµ‹å†è¿›è¡Œå…³é”®ç‚¹ä¼°è®¡ï¼Œè€Œæ˜¯åŒæ—¶è¾“å‡ºäººå‘˜ä½ç½®å’Œèº«ä½“å…³é”®ç‚¹ã€‚</p>
<p>å› ä¸ºæ‰€æœ‰æ­¥éª¤éƒ½åœ¨å•ä¸€æ¨¡å—ä¸­å®Œæˆï¼Œè¿™äº›æ¨¡å‹é€šå¸¸æ›´å¿«ã€æ›´é«˜æ•ˆï¼Œè¿™ä½¿å®ƒä»¬éå¸¸é€‚ç”¨äºå®æ—¶åº”ç”¨ï¼Œå¦‚å®æ—¶è¿åŠ¨è·Ÿè¸ªå’ŒåŠ¨ä½œæ•æ‰ã€‚</p>
<h2 data-id="heading-5"><strong>è®­ç»ƒå’Œè¯„ä¼°å§¿æ€ä¼°è®¡æ¨¡å‹</strong></h2>
<p>æ— è®ºé‡‡ç”¨å“ªç§æ–¹æ³•ï¼Œå§¿æ€ä¼°è®¡æ¨¡å‹åœ¨å®é™…åº”ç”¨ä¸­å¯é ä¹‹å‰ï¼Œä»ç„¶éœ€è¦ä»”ç»†çš„è®­ç»ƒå’Œæµ‹è¯•ã€‚å®ƒé€šå¸¸ä»å¤§å‹å›¾åƒï¼ˆæœ‰æ—¶æ˜¯è§†é¢‘ï¼‰é›†åˆä¸­å­¦ä¹ ï¼Œå…¶ä¸­èº«ä½“å…³é”®ç‚¹å·²è¢«æ ‡è®°ï¼Œè¿™æœ‰åŠ©äºå®ƒå¤„ç†ä¸åŒçš„å§¿æ€ã€æ‘„åƒæœºè§’åº¦å’Œç¯å¢ƒã€‚</p>
<p>ä¸€äº›çŸ¥åçš„å§¿æ€ä¼°è®¡æ•°æ®é›†åŒ…æ‹¬Â COCO Keypointsã€MPII Human Poseã€CrowdPoseÂ å’ŒÂ OCHumanã€‚å½“è¿™äº›æ•°æ®é›†ä¸èƒ½åæ˜ æ¨¡å‹åœ¨éƒ¨ç½²æ—¶å°†é¢ä¸´çš„ç¯å¢ƒæ—¶ï¼ˆä¾‹å¦‚å·¥å‚è½¦é—´ã€å¥èº«æˆ¿æˆ–è¯Šæ‰€ï¼‰ï¼Œå·¥ç¨‹å¸ˆé€šå¸¸ä¼šä»ç›®æ ‡ç¯å¢ƒä¸­æ”¶é›†å¹¶æ ‡æ³¨é¢å¤–çš„å›¾åƒã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c00a9c472ce9487bbb6a6ff93218c461~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767147592&amp;x-signature=Y04DM3yJ4k%2FGQ2bB7arse0GO3Ig%3D" alt="screenshot_2025-12-23_16-20-48.png" loading="lazy"/></p>
<p>è®­ç»ƒåï¼Œæ¨¡å‹ä¼šåœ¨æ ‡å‡†åŸºå‡†æµ‹è¯•ä¸Šè¿›è¡Œè¯„ä¼°ï¼Œä»¥è¡¡é‡å…¶å‡†ç¡®æ€§å’Œé²æ£’æ€§ï¼Œå¹¶ä¸ºå®é™…åº”ç”¨çš„è¿›ä¸€æ­¥è°ƒä¼˜æä¾›æŒ‡å¯¼ã€‚ç»“æœé€šå¸¸ä½¿ç”¨å¹³å‡ç²¾åº¦å‡å€¼ï¼ˆmAPï¼‰æ¥æŠ¥å‘Šï¼Œè¯¥æŒ‡æ ‡é€šè¿‡æ¯”è¾ƒé¢„æµ‹å§¿æ€ä¸æ ‡æ³¨çš„çœŸå®å§¿æ€ï¼Œç»¼åˆäº†ä¸åŒç½®ä¿¡åº¦é˜ˆå€¼ä¸‹çš„æ€§èƒ½ã€‚</p>
<p>åœ¨è®¸å¤šå§¿æ€åŸºå‡†æµ‹è¯•ä¸­ï¼Œé¢„æµ‹å§¿æ€ä¸çœŸå®å§¿æ€ä¹‹é—´ä½¿ç”¨å¯¹è±¡å…³é”®ç‚¹ç›¸ä¼¼åº¦ï¼ˆOKSï¼‰è¿›è¡ŒåŒ¹é…ã€‚OKS è¡¡é‡é¢„æµ‹å…³é”®ç‚¹ä¸æ ‡æ³¨å…³é”®ç‚¹çš„æ¥è¿‘ç¨‹åº¦ï¼ŒåŒæ—¶è€ƒè™‘äº†äººç‰©çš„å°ºåº¦å’Œæ¯ä¸ªå…³é”®ç‚¹å…¸å‹çš„å®šä½éš¾åº¦ç­‰å› ç´ ã€‚</p>
<p>å§¿æ€æ¨¡å‹è¿˜ä¼šä¸ºæ£€æµ‹åˆ°çš„äººå’Œå„ä¸ªå…³é”®ç‚¹è¾“å‡ºç½®ä¿¡åº¦åˆ†æ•°ã€‚è¿™äº›åˆ†æ•°åæ˜ äº†æ¨¡å‹çš„ç½®ä¿¡åº¦ï¼Œç”¨äºå¯¹é¢„æµ‹è¿›è¡Œæ’åºå’Œè¿‡æ»¤ï¼Œè¿™åœ¨å…·æœ‰é®æŒ¡ã€è¿åŠ¨æ¨¡ç³Šæˆ–å¼‚å¸¸æ‘„åƒæœºè§’åº¦ç­‰æŒ‘æˆ˜æ€§çš„æ¡ä»¶ä¸‹å°¤å…¶é‡è¦ã€‚</p>
<h2 data-id="heading-6"><strong>æµè¡Œçš„å§¿æ€ä¼°è®¡å·¥å…·</strong></h2>
<p>å¦‚ä»Šæœ‰è®¸å¤šå§¿æ€ä¼°è®¡å·¥å…·å¯ä¾›é€‰æ‹©ï¼Œå„è‡ªåœ¨é€Ÿåº¦ã€å‡†ç¡®æ€§å’Œæ˜“ç”¨æ€§ä¹‹é—´å–å¾—å¹³è¡¡ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›æœ€å¸¸ç”¨çš„å·¥å…·å’Œåº“ï¼š</p>
<ul>
<li><strong>YOLO11ï¼š</strong> ä½œä¸ºæœ€å…ˆè¿›çš„å¼€æºè§†è§‰AIæ¨¡å‹å¼€å‘ï¼ŒYOLO11 å»ºç«‹åœ¨ YOLOv8 ç­‰æ—©æœŸæ¨¡å‹ä¹‹ä¸Šã€‚å®ƒæé«˜äº†é€Ÿåº¦ã€å‡†ç¡®æ€§å’Œæ•´ä½“æ•ˆç‡ï¼ŒåŒæ—¶æ”¯æŒåŒ…æ‹¬å§¿æ€ä¼°è®¡åœ¨å†…çš„å„ç§è®¡ç®—æœºè§†è§‰ä»»åŠ¡ã€‚å‡­å€Ÿåœ¨ä»ç¬”è®°æœ¬ç”µè„‘åˆ°è¾¹ç¼˜è®¾å¤‡ç­‰å„ç§å¹³å°ä¸Šçš„å¼ºå¤§æ€§èƒ½ï¼ŒYOLO11 æ˜¯è®¸å¤šå®é™…éƒ¨ç½²åœºæ™¯çš„ç»ä½³é€‰æ‹©ã€‚</li>
<li><strong>Coovallyï¼š</strong> è¿™æ˜¯ä¸€ä¸ªAIæ¨¡å‹è®­ç»ƒä¸åº”ç”¨å¹³å°ã€‚å®ƒæ•´åˆäº†å›½å†…å¤–å¼€æºç¤¾åŒº1000+æ¨¡å‹ç®—æ³•å’Œå„ç±»å…¬å¼€è¯†åˆ«æ•°æ®é›†ï¼Œæ— éœ€é…ç½®ç¯å¢ƒã€ä¿®æ”¹é…ç½®æ–‡ä»¶ç­‰ç¹çæ“ä½œï¼Œå³å¯è®­ç»ƒæ¨¡å‹ï¼Œæ¨¡å‹å¯åˆ†äº«ä¸ä¸‹è½½ã€‚</li>
<li><strong>MediaPipeï¼š</strong> è¿™æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºè§†è§‰å’Œæœºå™¨å­¦ä¹ ç®¡é“çš„è·¨å¹³å°æ¡†æ¶ã€‚å®ƒè½»é‡çº§ï¼Œèƒ½åœ¨ç§»åŠ¨è®¾å¤‡ã€å¹³æ¿ç”µè„‘å’Œç½‘ç»œåº”ç”¨ä¸­é«˜æ•ˆè¿è¡Œï¼Œå¹¶åŒ…å«å…¨èº«å§¿æ€ã€é¢éƒ¨æ ‡å¿—ç‚¹å’Œæ‰‹éƒ¨è·Ÿè¸ªç­‰å³ç”¨å‹è§£å†³æ–¹æ¡ˆå’Œæ¨¡å‹ã€‚</li>
<li><strong>OpenPoseï¼š</strong> è¿™æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„ç«¯åˆ°ç«¯å¼€æºå§¿æ€ä¼°è®¡ç³»ç»Ÿï¼Œä»¥å¤šäººå…³é”®ç‚¹æ£€æµ‹è€Œé—»åã€‚å®ƒå¯ä»¥åŒæ—¶ä¼°è®¡èº«ä½“ã€æ‰‹éƒ¨å’Œé¢éƒ¨çš„å…³é”®ç‚¹ï¼Œé€šå¸¸ç”¨äºç ”ç©¶ã€åŠ¨ç”»å’Œè¿åŠ¨åˆ†æã€‚</li>
<li><strong>MMPoseï¼š</strong> MMPose æ˜¯ OpenMMLab ç”Ÿæ€ç³»ç»Ÿä¸­çš„ä¸€ä¸ªåŸºäº PyTorch çš„å§¿æ€ä¼°è®¡å·¥å…·åŒ…ã€‚å®ƒæä¾›äº†è®¸å¤šæ¨¡å‹å®ç°ã€è®­ç»ƒå·¥å…·å’Œé…ç½®é€‰é¡¹ï¼Œè¿™å¯¹äºå®éªŒå’Œæ·±åº¦å®šåˆ¶éå¸¸æœ‰ç”¨ã€‚</li>
<li><strong>HRNet å’Œ AlphaPoseï¼š</strong> è¿™äº›æ˜¯è¾ƒæ—©æœŸçš„å§¿æ€ä¼°è®¡æ¨¡å‹ï¼Œè‡³ä»Šä»åœ¨ç ”ç©¶ä¸­ä½¿ç”¨ã€‚HRNet æ˜¯ä¸€ç§èƒ½å§‹ç»ˆä¿æŒé«˜åˆ†è¾¨ç‡å›¾åƒç‰¹å¾ç½‘ç»œçš„å§¿æ€æ¨¡å‹æ¶æ„ï¼Œè¿™æœ‰åŠ©äºå…¶ç²¾ç¡®å®šä½å…³é”®ç‚¹ã€‚AlphaPose æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„å¤šäººå§¿æ€ä¼°è®¡ç³»ç»Ÿï¼Œé€šå¸¸åœ¨æ‹¥æŒ¤æˆ–å¤æ‚åœºæ™¯ä¸­éœ€è¦é«˜ç²¾åº¦æ—¶ä½¿ç”¨ã€‚</li>
</ul>
<h2 data-id="heading-7"><strong>å§¿æ€åˆ†æä¸ä¼°è®¡çš„ç°å®åº”ç”¨</strong></h2>
<p>å§¿æ€ä¼°è®¡æ­£è¶Šæ¥è¶Šå¤šåœ°è¢«ç”¨äºå°†æ™®é€šè§†é¢‘è½¬åŒ–ä¸ºæœ‰ç”¨çš„è¿åŠ¨æ´å¯Ÿã€‚é€šè¿‡é€å¸§è·Ÿè¸ªèº«ä½“å…³é”®ç‚¹ï¼Œè¿™äº›ç³»ç»Ÿå¯ä»¥ä»æ‘„åƒå¤´ä¿¡æ¯ä¸­æ¨æ–­å§¿åŠ¿ã€è¿åŠ¨å’Œèº«ä½“è¡Œä¸ºï¼Œä½¿æ­¤ç±»æŠ€æœ¯åœ¨è®¸å¤šç°å®åœºæ™¯ä¸­å˜å¾—å®ç”¨ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨åŒ»ç–—ä¿å¥å’Œåº·å¤é¢†åŸŸï¼Œå§¿æ€è·Ÿè¸ªå¯ä»¥å¸®åŠ©ä¸´åºŠåŒ»ç”Ÿè§‚å¯Ÿå’Œæµ‹é‡æ‚£è€…åœ¨æ²»ç–—å’Œæ¢å¤æœŸé—´çš„æ´»åŠ¨ã€‚é€šè¿‡ä»æ™®é€šè§†é¢‘è®°å½•ä¸­æå–èº«ä½“åœ°æ ‡ç‚¹ï¼Œå¯ç”¨äºè¯„ä¼°å§¿åŠ¿ã€æ´»åŠ¨èŒƒå›´å’Œéšæ—¶é—´å˜åŒ–çš„æ•´ä½“è¿åŠ¨æ¨¡å¼ã€‚è¿™äº›æµ‹é‡å¯ä»¥æ”¯æŒå’Œä¼˜åŒ–ä¼ ç»Ÿçš„ä¸´åºŠè¯„ä¼°ï¼Œå¹¶ä¸”åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥æ›´è½»æ¾åœ°è·Ÿè¸ªè¿›å±•ï¼Œè€Œæ— éœ€å¯ç©¿æˆ´ä¼ æ„Ÿå™¨æˆ–ä¸“ç”¨è®¾å¤‡ã€‚</p>
<p>åŒæ ·ï¼Œåœ¨ä½“è‚²å’Œå¹¿æ’­é¢†åŸŸï¼Œå§¿æ€ä¼°è®¡å¯ä»¥ç›´æ¥ä»è§†é¢‘ä¿¡æ¯ä¸­åˆ†æè¿åŠ¨å‘˜çš„åŠ¨ä½œã€‚ä¸€ä¸ªæœ‰è¶£çš„ä¾‹å­æ˜¯é¹°çœ¼ç³»ç»Ÿï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäºæ‘„åƒå¤´çš„è¿½è¸ªç³»ç»Ÿï¼Œç”¨äºèŒä¸šä½“è‚²ä¸­çš„è£åˆ¤å’Œå¹¿æ’­å›¾å½¢æ˜¾ç¤ºã€‚å®ƒè¿˜èƒ½é€šè¿‡ä»æ‘„åƒæœºè§†å›¾ä¼°è®¡è¿åŠ¨å‘˜çš„èº«ä½“å…³é”®ç‚¹æ¥æä¾›éª¨æ¶è·Ÿè¸ªã€‚</p>
<h2 data-id="heading-8"><strong>é€‰æ‹©åˆé€‚çš„å§¿æ€ä¼°è®¡å·¥å…·</strong></h2>
<p>é€‰æ‹©åˆé€‚çš„å§¿æ€ä¼°è®¡å·¥å…·ï¼Œé¦–å…ˆè¦äº†è§£æ‚¨è®¡ç®—æœºè§†è§‰é¡¹ç›®çš„éœ€æ±‚ã€‚æœ‰äº›åº”ç”¨ä¼˜å…ˆè€ƒè™‘å®æ—¶é€Ÿåº¦ï¼Œè€Œå¦ä¸€äº›åˆ™éœ€è¦æ›´é«˜çš„å‡†ç¡®æ€§å’Œç»†èŠ‚ã€‚</p>
<p>ç›®æ ‡éƒ¨ç½²è®¾å¤‡ä¹Ÿå¾ˆé‡è¦ã€‚ç§»åŠ¨åº”ç”¨å’Œè¾¹ç¼˜è®¾å¤‡é€šå¸¸éœ€è¦è½»é‡çº§ã€é«˜æ•ˆçš„æ¨¡å‹ï¼Œè€ŒæœåŠ¡å™¨æˆ–äº‘ç¯å¢ƒåˆ™é€šå¸¸æ›´é€‚åˆè¾ƒå¤§çš„æ¨¡å‹ã€‚</p>
<p>æ­¤å¤–ï¼Œæ˜“ç”¨æ€§ä¹Ÿèµ·ç€ä½œç”¨ã€‚è‰¯å¥½çš„æ–‡æ¡£ã€é¡ºç•…çš„éƒ¨ç½²ä»¥åŠå¯¹è‡ªå®šä¹‰è®­ç»ƒçš„æ”¯æŒï¼Œå¯ä»¥ç®€åŒ–æ‚¨çš„é¡¹ç›®ã€‚</p>
<p>ç®€è€Œè¨€ä¹‹ï¼Œä¸åŒçš„å·¥å…·åœ¨ä¸åŒçš„é¢†åŸŸè¡¨ç°å‡ºè‰²ã€‚ä¾‹å¦‚ï¼Œå¯¹äºè®¸å¤šç°å®ä¸–ç•Œçš„å§¿æ€ä¼°è®¡åº”ç”¨ï¼ŒUltralytics YOLO ç³»åˆ—æ¨¡å‹åœ¨é€Ÿåº¦ã€å‡†ç¡®æ€§å’Œéƒ¨ç½²ä¾¿æ·æ€§ä¹‹é—´æä¾›äº†å®ç”¨çš„å¹³è¡¡ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/97587fd50f6e419aa7fafdc607c2c435~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767147592&amp;x-signature=UizVKwwtlNjA1WlXPqYKdlnfx6s%3D" alt="screenshot_2025-12-23_16-21-03.png" loading="lazy"/></p>
<h2 data-id="heading-9"><strong>æ€»ç»“</strong></h2>
<p>å§¿æ€ä¼°è®¡é€šè¿‡æ£€æµ‹å›¾åƒå’Œè§†é¢‘ä¸­çš„èº«ä½“å…³é”®ç‚¹ï¼Œå¸®åŠ©è®¡ç®—æœºç†è§£äººä½“è¿åŠ¨ã€‚åƒ YOLO11 å’Œ YOLO26 è¿™æ ·çš„æ¨¡å‹ä½¿å¾—ä¸ºä½“è‚²ã€åŒ»ç–—ä¿å¥ã€å·¥ä½œåœºæ‰€å®‰å…¨å’Œäº’åŠ¨ä½“éªŒç­‰é¢†åŸŸæ„å»ºå®æ—¶åº”ç”¨å˜å¾—æ›´åŠ å®¹æ˜“ã€‚éšç€æ¨¡å‹å˜å¾—è¶Šæ¥è¶Šå¿«ã€è¶Šæ¥è¶Šå‡†ç¡®ï¼Œå§¿æ€ä¼°è®¡å¾ˆå¯èƒ½æˆä¸ºè®¸å¤šè§†è§‰AIç³»ç»Ÿä¸­çš„å¸¸è§åŠŸèƒ½ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ–‡ææ‡‚ä»€ä¹ˆæ˜¯ Vibe Codingï¼Ÿ]]></title>    <link>https://juejin.cn/post/7586969583783100422</link>    <guid>https://juejin.cn/post/7586969583783100422</guid>    <pubDate>2025-12-24T02:22:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586969583783100422" data-draft-id="7586972442422542377" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ–‡ææ‡‚ä»€ä¹ˆæ˜¯ Vibe Codingï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-24T02:22:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ¶æ„ç²¾è¿›ä¹‹è·¯"/> <meta itemprop="url" content="https://juejin.cn/user/3746752294032328"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ–‡ææ‡‚ä»€ä¹ˆæ˜¯ Vibe Codingï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3746752294032328/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ¶æ„ç²¾è¿›ä¹‹è·¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T02:22:09.000Z" title="Wed Dec 24 2025 02:22:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong><code>æœ¬æ–‡ç³»ä½œè€… [æ¶æ„ç²¾è¿›ä¹‹è·¯] åŸåˆ›ï¼Œè‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ï¼Œæœªç»æˆæƒç¦æ­¢ä»»ä½•å½¢å¼çš„è½¬è½½ã€æŠ„è¢­æˆ–ç›—ç”¨ï¼Œè¿è€…å¿…ç©¶ã€‚</code></strong></p>
<p>æœ€è¿‘åˆ·è®ºå›ã€é€›ç¤¾åŒºï¼Œå‘ç°ä¸€ä¸ªå¾ˆæ½®ã€å¾ˆé…·çš„æ–°è¯å„¿ï¼šâ€œVibe Codingâ€ã€‚</p>
<p>ä¹ä¸€å¬æœ‰ç‚¹æ‡µï¼Œåˆ°åº•å•¥æ˜¯â€œVibe Codingâ€ï¼Ÿ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d2986757d7b4ea6a1ddc9bbdbd13fcd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p625p6E57K-6L-b5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767147728&amp;x-signature=reesgyH3pwIldBnhXfulUBVcQKc%3D" alt="" loading="lazy"/></p>
<p>æ˜¯å†™ä»£ç è¿˜è¦è®²ç©¶æ°›å›´æ„Ÿå—ï¼Ÿä»Šå¤©æˆ‘å°±ä»¥ä¸€ä¸ªç å†œçš„è§†è§’ï¼ŒèŠèŠæˆ‘ç†è§£ä¸‹çš„â€œVibe Codingâ€ï¼Œä»¥åŠé‚£äº›è®©äººâ€œvibe èµ·æ¥â€çš„å·¥å…·ã€‚</p>
<h2 data-id="heading-0">Vibe Coding åˆ°åº•æ˜¯å•¥ï¼Ÿ</h2>
<p>Vibe åœ¨è‹±æ–‡é‡Œæœ¬æ¥å°±æ˜¯â€œæ°›å›´â€ã€â€œæ„Ÿè§‰â€çš„æ„æ€ã€‚æ‰€ä»¥ç›´è¯‘è¿‡æ¥å…¶å®å°±æ˜¯â€œæ°›å›´ç¼–ç¨‹â€æˆ–è€…å«â€œæ²‰æµ¸å¼ç¼–ç¨‹â€ã€‚ä½†è¿™é‡Œçš„â€œæ²‰æµ¸â€ä¸ä»…ä»…æ˜¯è®©ä½ æ²‰æµ¸åœ¨ä¸€ä¸ªæœ‰ä»ªå¼æ„Ÿçš„ç¼–ç¨‹ç¯å¢ƒé‡Œï¼Œæ›´é‡è¦çš„æ˜¯å®ƒé¢ è¦†äº†æˆ‘ä»¬ä»¥å¾€å†™ä»£ç çš„æ–¹å¼ã€‚</p>
<p>æˆ‘ç›´æ¥è¯´ç»“è®ºï¼šVibe Coding å‹æ ¹å°±ä¸å…³å¿ƒä½ ä»£ç å…·ä½“æ€ä¹ˆå®ç°çš„ï¼Œæ ¸å¿ƒå…³æ³¨ç‚¹æ˜¯ä»£ç ç”Ÿæˆçš„ç»“æœå¯¹ä¸å¯¹ã€‚è‡³äºå®ç°é€»è¾‘ã€åº•å±‚ç»†èŠ‚è¿™äº›ç¹ççš„æ´»ï¼Œéƒ½äº¤ç»™ AI å»æå®šã€‚æˆ‘åªéœ€è¦ç›¯ç€æ•ˆæœï¼Œè§‰å¾—å“ªé‡Œä¸å¯¹ã€å“ªé‡Œæœ‰é—®é¢˜ï¼Œå°±ç›´æ¥æ”¹ promptï¼Œé‡æ–°æéœ€æ±‚ï¼ŒAI ä¼šè‡ªåŠ¨å¸®ä½ è°ƒæ•´å’Œä¼˜åŒ–ï¼Œç›´åˆ°æœ€åç»“æœå®Œå…¨ç¬¦åˆä½ çš„é¢„æœŸä¸ºæ­¢ã€‚æ•´ä¸ªè¿‡ç¨‹ä½ éƒ½æ²‰æµ¸åœ¨ â€œè¯´æƒ³æ³•â€”&gt;çœ‹ç»“æœâ€”&gt;ç»§ç»­è°ƒæ•´â€”&gt;å†å‡ºç»“æœâ€ çš„å¾ªç¯é‡Œï¼Œæ•ˆç‡é«˜å¾—é£èµ·ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œæ­£å¸¸å†™ä»£ç â€”â€”</p>
<p>æˆ‘ä»¬å¤§å¤šæ•°äººè¦æƒ³æ˜ç™½æ•´ä¸ªå®ç°æ€è·¯ï¼Œæµç¨‹ã€ç»†èŠ‚éƒ½æ˜¯äº²æ‰‹å†™ã€äº²è‡ªæ”¹ï¼Œé‡åˆ° bug è¿˜å¾—è¿½æ ¹æº¯æºã€‚</p>
<p>Vibe Codingâ€”â€”</p>
<p>å®Œå…¨ä¸ä¸€æ ·ï¼Œæµç¨‹å˜æˆäº†ï¼š</p>
<ol>
<li>
<p>æˆ‘ç”¨è‡ªå·±çš„è¯ï¼ˆå¯èƒ½æ˜¯è‡ªç„¶è¯­è¨€ï¼Œä¹Ÿå¯ä»¥æ˜¯ç”»ä¸ªå›¾ã€ä¸¾ä¸ªä¾‹å­ï¼‰å‘Šè¯‰ AIï¼šâ€œæˆ‘è¦å•¥æ ·çš„åŠŸèƒ½/æ•ˆæœ/ç»“æœâ€ã€‚</p>
</li>
<li>
<p>AIï¼ˆä¸è®ºæ˜¯ ChatGPTã€Copilot è¿˜æ˜¯ä¸“ä¸š Vibe Coding å¹³å°é‡Œçš„ Agentï¼‰è‡ªåŠ¨ç»™ä½ é€ å‡ºä»£ç +ç•Œé¢ï¼Œä½ æ ¹æœ¬ä¸ç”¨ç®¡å®ƒç”¨å•¥æ–¹æ³•ã€‚</p>
</li>
<li>
<p>ä½ ç”¨å®é™…è¿è¡Œå‡ºæ¥çš„ç»“æœæ¥â€œæ£€éªŒâ€ï¼šå¯¹äº†å°±æ”¶ä¸‹ï¼Œä¸å¯¹å°±åæ§½ã€æè¦æ±‚ï¼Œè®© AI å†è°ƒã€‚</p>
</li>
<li>
<p>å¦‚æ­¤å¾ªç¯ï¼Œç›´åˆ°ä½ çœ‹åˆ°çš„ç»“æœå®Œå…¨ç¬¦åˆä½ å¿ƒä¸­æ‰€æƒ³ï¼Œè¿™ä»£ç ä½ å°±äº¤å·®äº†ã€‚</p>
</li>
</ol>
<p>è¯´ç™½äº†å°±æ˜¯ï¼Œäººç±»è´Ÿè´£å‡ºé¢˜+å®¡æ ¸ï¼ŒAI è´Ÿè´£è§£é¢˜+æ”¹å·ï¼Œå…¨è¿‡ç¨‹éƒ½æ²‰æµ¸åœ¨â€œå³æ—¶åé¦ˆâ†’è°ƒæ•´â†’å†åé¦ˆâ†’å†è°ƒæ•´â€çš„é—­ç¯é‡Œï¼Œè‡ªå·±éƒ½ä¸ç”¨è€ƒè™‘æ€ä¹ˆå®ç°ï¼Œæ•´ä¸ªå°±æ˜¯æè‡´çš„â€œèººå¹³â€å¼ç”Ÿäº§åŠ›ã€‚</p>
<h2 data-id="heading-1">Vibe Coding æ€ä¹ˆä¸ªæµç¨‹ï¼Ÿ</h2>
<p>æˆ‘å¤§æ¦‚ç”»äº†ä¸ªæµç¨‹å›¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92e254e157c848e7a17c58755a812666~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p625p6E57K-6L-b5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767147728&amp;x-signature=0hZT3JyZvAvT5jyTfO%2B3PJxZdPI%3D" alt="" loading="lazy"/></p>
<p>ä¸¾ä¸ªç”Ÿæ´»åŒ–çš„ä¾‹å­ï¼šå°±åƒç‚¹å¤–å–ä¸€æ ·ï¼Œä½ åªç®¡é€‰èœï¼ŒAI å¸®ä½ åšã€‚èœç«¯ä¸Šæ¥ä¸åˆå£å‘³ï¼Ÿä½ ç›´æ¥ç‚¹è¯„å®ƒï¼AI å¨å­ç«‹åˆ»å†æ”¹ï¼Œç›´åˆ°å–‚åˆ°ä½ æ»¡æ„ã€‚</p>
<h2 data-id="heading-2">è¿™ç§æ–¹å¼ä¸ºä»€ä¹ˆçˆ½ï¼Ÿ</h2>
<ol>
<li>æ•ˆç‡æé«˜</li>
</ol>
<p>ä½ çœå»äº†å¤§é‡çº ç»“åº•å±‚é€»è¾‘ã€è°ƒ bug çš„æ—¶é—´ï¼ŒæŠŠç²¾åŠ›å…¨æ”¾åœ¨â€œåˆ°åº•è¦ä»€ä¹ˆâ€ä¸Šï¼›æƒ³æ³•ç»†èŠ‚å…¨è®© AI å¸®ä½ è¡¥å…¨å’Œè½åœ°ã€‚</p>
<p>2. é›¶é—¨æ§›å…¥é—¨</p>
<p>ä¸ç”¨æ˜¯ç¼–ç¨‹é«˜æ‰‹ï¼Œå°ç™½éƒ½èƒ½ç©å¾—è½¬ã€‚æ€è·¯å…¨é ä¸»è§‚æ„Ÿå—+å³æ—¶è°ƒæ•´ï¼Œè€å°‘å’¸å®œï¼Œéå¸¸é€‚åˆå¿«é€Ÿè¯•é”™ã€äº§å“åŸå‹éªŒè¯ã€å¯è§†åŒ– demoã€‚</p>
<p>3. æ›´æ²‰æµ¸ã€å¦‚æœ‰ç¥åŠ©</p>
<p>ä½ ä¸è¢«ä»£ç ç»Šä½ï¼Œå…¨èº«å¿ƒæ²‰æµ¸åœ¨â€œåˆ›ä½œâ€å’Œâ€œè¡¨è¾¾â€æœ¬èº«ã€‚å¿ƒè·¯å°å®‡å®™å…¨å¼€ï¼Œé‡åˆ°â€œå“ªé‡Œä¸å¯¹åŠ²â€è¿˜å¯ä»¥è¿…é€Ÿä¿®æ­£ï¼Œæµç¨‹é¡ºæ»‘åœ°é£èµ·ã€‚</p>
<h2 data-id="heading-3">å¸¸ç”¨çš„ Vibe Coding å·¥å…·</h2>
<p>è¯´ç™½äº†ï¼Œåªè¦èƒ½â€œä½“éªŒæ²‰æµ¸å¼+AI è‡ªåŠ¨è°ƒæ•´+å³æ—¶é¢„è§ˆâ€ï¼Œéƒ½ç®— Vibe Coding åˆ©å™¨ã€‚ç°åœ¨è¿™ä¸ªâ€œæ²‰æµ¸å¼ç¼–ç¨‹â€ã€ç»“æœå¯¼å‘çš„ Vibe Coding ç©æ³•ï¼Œå°‘ä¸äº† AI IDE å’Œ AI å·¥å…·çš„å¼ºå¼ºè”æ‰‹ã€‚</p>
<p>ä¸‹é¢æˆ‘å°±ç»™å¤§å®¶å®‰åˆ©å‡ ä¸ªç›®å‰å¸‚é¢ä¸Šç”¨èµ·æ¥æœ€çˆ½çš„å·¥å…·ï¼š</p>
<h3 data-id="heading-4">1. Cursor</h3>
<p>è®²çœŸï¼Œç°åœ¨å†™ä»£ç çš„ IDE ï¼ŒCursor ç»å¯¹ç®—å¤´å·ç½‘çº¢ï¼å®ƒè‡ªå¸¦çš„ AI åŠ©æ‰‹ç‰¹åˆ«èƒ½å¸®ä½ çœäº‹ï¼Œç›´æ¥æŠŠéœ€æ±‚å‘Šè¯‰å®ƒï¼ŒCursor å°±èƒ½å¸®ä½ å†™ä»£ç ã€æŸ¥ bugã€æ”¹é€»è¾‘ï¼Œç”šè‡³è‡ªåŠ¨é‡æ„ï¼Œæµç¨‹çˆ½åˆ°é£èµ·ã€‚ä½ çœ‹ç»“æœã€ææ”¹åŠ¨å°±è¡Œï¼Œä»£ç çš„ç»†èŠ‚äº¤ç»™ AI æå®šï¼Œå®Œå…¨è´´åˆ Vibe Coding é‚£ç§â€œæ²‰æµ¸-åé¦ˆ-å†è°ƒæ•´â€çš„é£æ ¼ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c67a50d1643848e8984d97c6862c464a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p625p6E57K-6L-b5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767147728&amp;x-signature=MkaJBwXnM0xwGrZjkxdAcQBJaok%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">2. Trae</h3>
<p>Trae.ai ä¹Ÿæ˜¯ä¸ª AI ç¼–ç¨‹ IDEï¼Œå­—èŠ‚è·³åŠ¨çš„äº§å“ï¼Œç›®å‰æ˜¯å…è´¹ä½¿ç”¨ï¼Œå†™ä»£ç ã€æŸ¥æ–‡æ¡£ã€åŠ æ¥å£éƒ½å¯ä»¥ï¼Œå’Œå®ƒå¯¹è¯å°±èƒ½æ”¹åŠŸèƒ½ã€æŸ¥é—®é¢˜ï¼Œäº‹åŠåŠŸå€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/437e9c1c358f4fd58337612b6ad9e57d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p625p6E57K-6L-b5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767147728&amp;x-signature=YFjKkkNds%2B%2Bstqc%2B5skmeZS5aoM%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-6">3. VSCode + Cline æ’ä»¶</h3>
<p>å¦‚æœä½ â€œæ­»å¿ â€ VSCode ç”¨æˆ·ï¼Œæ¨èè¯•è¯• Cline æ’ä»¶ã€‚å®ƒèƒ½æŠŠ AI åŠ©æ‰‹ç›´æ¥é›†æˆè¿› VSCode é‡Œé¢ï¼Œå’Œç¼–è¾‘å™¨æ— ç¼åä½œã€‚ä½ åœ¨ VSCode é‡Œå†™ä»£ç ã€æŸ¥ APIã€æéœ€æ±‚ï¼Œå®ƒéƒ½èƒ½å¸®ä½ ç”Ÿæˆã€è¡¥å…¨ã€é‡æ„ï¼Œè¿˜èƒ½ä¸€é”®è¿æ¥ Apifox MCP Serverï¼Œå¸®ä½ è‡ªåŠ¨è·å–å’Œåˆ©ç”¨ API æ–‡æ¡£ã€‚è¿™æ ·å¼€å‘å°±å˜æˆäº†â€œVSCode å†™- Cline æƒ³ - AI å‡ºç»“æœâ€ï¼Œæ•´ä¸ªä½“éªŒè¶…çº§ä¸æ»‘ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c20e2afe65a44d41b731cad853f81250~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p625p6E57K-6L-b5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767147728&amp;x-signature=ncLMLuqoiiA0NxYiRd3%2FsgtMYsw%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">4. Apifox MCP Server</h3>
<p>è¯´åˆ° AI æ—¶ä»£çš„çŸ¥è¯†ç®¡ç†å’Œ API æ•°æ®ï¼ŒMCP Server çœŸçš„ä¸èƒ½ä¸æã€‚</p>
<p>å®ƒç‰›åœ¨å“ªé‡Œï¼Ÿç®€å•è¯´å°±æ˜¯â€”â€”èƒ½æŠŠä½ åœ¨é‡Œå†™å¥½çš„æ¥å£æ–‡æ¡£ï¼ˆæ¯”å¦‚ä½ çš„é¡¹ç›® API è§„èŒƒã€å­—æ®µã€ç”¨æ³•è¯´æ˜ç­‰ç­‰ï¼‰ï¼Œä¸€é”®å–‚ç»™Cursorã€Traeã€VS Codeï¼ˆè£… Cline æ’ä»¶ï¼‰ã€æˆ–è€…ä»»ä½•æ”¯æŒçš„ AI å·¥å…·ã€‚</p>
<p>æœ€å¤§å¥½å¤„å°±æ˜¯ï¼š ä½ å†™ä»£ç ã€æä¸šåŠ¡ï¼Œä¸ç”¨æ­»è®°ç¡¬èƒŒ API æ¥å£æˆ–è€…åå¤ç¿»æŸ¥æ–‡æ¡£ï¼Œåªè¦å‘Šè¯‰ AIï¼šâ€œæ ¹æ® API æ–‡æ¡£ï¼ŒæŠŠ Product æ¥å£ä¸€é”®ç”Ÿæˆå‡ºæ¥â€ã€â€œåœ¨ DTO é‡Œå¤šåŠ å‡ ä¸ªæ–°å­—æ®µâ€ã€â€œæ‰€æœ‰å­—æ®µå†™è¯¦ç»†æ³¨é‡Šâ€â€¦â€¦AI å°±å¸®ä½ è‡ªåŠ¨åšå¥½ï¼ŒçœŸæ­£å®ç°ä¸“ä¸šä»£ç ã€æ¥å£ã€æ³¨é‡Šâ€œå†™å‡ºæ¥å³æ˜¯è§„èŒƒï¼Œæ”¹ä¸€è¡Œå…¨åŒæ­¥â€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/01042ff0304e4fa0abfed828d82ccd00~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p625p6E57K-6L-b5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767147728&amp;x-signature=EcIj1uEtwJxTpQAgZ9uuQa1qDew%3D" alt="" loading="lazy"/></p>
<p>æœ‰ MCP Server åï¼ŒAI ç¼–ç¨‹çš„â€œçŸ¥è¯†ç›²ç‚¹â€åŸºæœ¬æ²¡äº†ï¼Œæ•ˆç‡æš´æ¶¨ï¼Œå›¢é˜Ÿåˆä½œä¹Ÿæ›´ä¸“ä¸šï¼Œç‰¹åˆ«é€‚åˆåšåç«¯ã€å¾®æœåŠ¡ã€å›¢é˜Ÿåä½œé¡¹ç›®ï¼Œè¿˜æœ‰å„ç§è‡ªåŠ¨åŒ–å’Œæ™ºèƒ½ä»£ç ç”Ÿæˆã€‚</p>
<h2 data-id="heading-8">å°ç»“</h2>
<p>Vibe Codingï¼Œå°±æ˜¯çœŸæ­£è®©äººç±»åšæœ€èˆ’æœçš„äº‹â€”â€”åªçœ‹æ•ˆæœï¼Œè¯´å‡ºéœ€æ±‚ï¼Œå…¶ä»–å…¨éƒ¨æ‰”ç»™ AIã€‚å‘ç°å“ªé‡Œä¸æ»¡è¶³ï¼Ÿ</p>
<p>åªéœ€å†æ¬¡å‘Šè¯‰ AIï¼Œâ€œé©¬ä¸Šè°ƒã€é©¬ä¸Šåé¦ˆâ€ï¼Œæ²‰æµ¸æ„Ÿæ‹‰æ»¡ï¼Œæ•ˆç‡é«˜å¾—ç¦»è°±ã€‚</p>
<p><strong>åç»­ AI å†…å®¹</strong>å­¦ä¹ ï¼ŒæŒç»­æ›´æ–°ï¼Œæ¬¢è¿å…³æ³¨~</p>
<p><strong>Â·ENDÂ·</strong></p>
<p>å¸Œæœ›ä»Šå¤©çš„è®²è§£å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©ï¼Œè°¢è°¢ï¼</p>
<p>Thanks for reading!</p>
<blockquote>
<p>ä½œè€…ï¼šæ¶æ„ç²¾è¿›ä¹‹è·¯ï¼Œåå¹´ç ”å‘é£é›¨è·¯ï¼Œå¤§å‚æ¶æ„å¸ˆï¼ŒCSDN åšå®¢ä¸“å®¶ï¼Œä¸“æ³¨æ¶æ„æŠ€æœ¯æ²‰æ·€å­¦ä¹ åŠåˆ†äº«ï¼ŒèŒä¸šä¸è®¤çŸ¥å‡çº§ï¼ŒåšæŒåˆ†äº«æ¥åœ°æ°”å„¿çš„å¹²è´§æ–‡ç« ï¼ŒæœŸå¾…ä¸ä½ ä¸€èµ·æˆé•¿ã€‚<br/>
å…³æ³¨å¹¶ç§ä¿¡æˆ‘å›å¤â€œ01â€ï¼Œé€ä½ ä¸€ä»½ç¨‹åºå‘˜æˆé•¿è¿›é˜¶å¤§ç¤¼åŒ…ï¼Œæ¬¢è¿å‹¾æ­ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäºå¾®å‰ç«¯ qiankun å¤šå®ä¾‹ä¿æ´»çš„å·¥ç¨‹å®è·µ]]></title>    <link>https://juejin.cn/post/7586994471738048555</link>    <guid>https://juejin.cn/post/7586994471738048555</guid>    <pubDate>2025-12-24T02:17:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586994471738048555" data-draft-id="7586957204585070628" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäºå¾®å‰ç«¯ qiankun å¤šå®ä¾‹ä¿æ´»çš„å·¥ç¨‹å®è·µ"/> <meta itemprop="keywords" content="å‰ç«¯,å‰ç«¯å·¥ç¨‹åŒ–,JavaScript"/> <meta itemprop="datePublished" content="2025-12-24T02:17:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è½¬è½¬æŠ€æœ¯å›¢é˜Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/606586148237431"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäºå¾®å‰ç«¯ qiankun å¤šå®ä¾‹ä¿æ´»çš„å·¥ç¨‹å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/606586148237431/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è½¬è½¬æŠ€æœ¯å›¢é˜Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T02:17:44.000Z" title="Wed Dec 24 2025 02:17:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä¸€ã€ä¸šåŠ¡èƒŒæ™¯ä¸ç—›ç‚¹</h3>
<p>åœ¨ä¸­åå°ç³»ç»Ÿçš„å®é™…ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œé€šå¸¸ä¼šé‡åˆ°ä»¥ä¸‹åœºæ™¯ï¼š</p>
<ul>
<li>â€‹<strong>è®¢å•ç®¡ç†</strong>â€‹ï¼šç”¨æˆ·æ­£åœ¨å¡«å†™ä¸€å¼ å¤æ‚çš„è®¢å•è¡¨å•ï¼Œå·²è¾“å…¥å¤§é‡æ•°æ®</li>
<li>â€‹<strong>åº“å­˜æŸ¥è¯¢</strong>â€‹ï¼šéœ€è¦ä¸´æ—¶åˆ‡æ¢åˆ°è¿™é‡ŒæŸ¥è¯¢å•†å“åº“å­˜</li>
<li>â€‹<strong>å®¢æˆ·ä¿¡æ¯</strong>â€‹ï¼šéœ€è¦ç¡®è®¤å®¢æˆ·çš„æ”¶è´§åœ°å€</li>
</ul>
<p>åœ¨ä¼ ç»Ÿçš„å®ç°ä¸­ï¼Œå½“ç”¨æˆ·ä»"è®¢å•ç®¡ç†"åˆ‡æ¢åˆ°"åº“å­˜æŸ¥è¯¢"æ—¶ï¼š</p>
<ol>
<li>è®¢å•ç®¡ç†é¡µé¢<strong>è¢«é‡ç½®</strong></li>
<li>å·²å¡«å†™çš„è¡¨å•æ•°æ®<strong>å…¨éƒ¨ä¸¢å¤±</strong></li>
<li>ç­›é€‰æ¡ä»¶ã€å±•å¼€çš„æ ‘èŠ‚ç‚¹ç­‰çŠ¶æ€<strong>å…¨éƒ¨æ¸…ç©º</strong></li>
</ol>
<p>å½“ç”¨æˆ·æŸ¥å®Œåº“å­˜è¿”å›æ—¶ï¼Œä¸å¾—ä¸ï¼š</p>
<ul>
<li>é‡æ–°åŠ è½½è®¢å•ç®¡ç†é¡µé¢</li>
<li>é‡æ–°å¡«å†™æ‰€æœ‰è¡¨å•å­—æ®µ</li>
<li>é‡æ–°å®šä½åˆ°ä¹‹å‰çš„æ“ä½œä½ç½®</li>
</ul>
<p>è¿™ç§ä½“éªŒå¯¹äºéœ€è¦<strong>é¢‘ç¹åˆ‡æ¢</strong>çš„ä¸­åå°åœºæ™¯æ¥è¯´æ˜¯<strong>ä¸å¯æ¥å—</strong>çš„ã€‚</p>
<p>ä¸šåŠ¡è¯‰æ±‚ï¼šå®ç°ç±»ä¼¼æµè§ˆå™¨å¤šæ ‡ç­¾é¡µçš„æ•ˆæœï¼š</p>
<ul>
<li>âœ… é¡µé¢åˆ‡æ¢æ—¶ä¿ç•™å®Œæ•´çŠ¶æ€ï¼ˆè¡¨å•è¾“å…¥ã€æ»šåŠ¨ä½ç½®ã€å±•å¼€/æ”¶èµ·çŠ¶æ€ç­‰ï¼‰</li>
<li>âœ… æ— éœ€é‡æ–°åŠ è½½ï¼Œç¬é—´åˆ‡æ¢</li>
<li>âœ… æ”¯æŒå¤šä¸ªè·¯ç”±åŒæ—¶"å­˜æ´»"</li>
</ul>
<p>åœ¨å•ç‹¬è¿è¡Œçš„å­åº”ç”¨ï¼ˆéå¾®å‰ç«¯åœºæ™¯ï¼‰ï¼Œé€šå¸¸å¯ä»¥é€šè¿‡ Vue çš„ keep-aliveã€React çš„è·¯ç”±ç¼“å­˜ç­‰æŠ€æœ¯æ‰‹æ®µæ¥å®ç°ï¼Œè€Œåœ¨å¾®å‰ç«¯æ¶æ„ä¸‹ï¼Œåˆè¯¥å¦‚ä½•å®ç°è¯¥æ•ˆæœå‘¢ï¼Œæˆ–è€…è¯´å¦‚ä½•å®ç°<strong>å¤šå®ä¾‹ä¿æ´»</strong>çš„èƒ½åŠ›å‘¢ï¼Ÿ</p>
<p>åœ¨æ·±å…¥è§£å†³æ–¹æ¡ˆä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç†è§£ qiankun æ²™ç®±æœºåˆ¶çš„æ ¸å¿ƒåŸç†ã€‚</p>
<h3 data-id="heading-1">äºŒã€qiankun æ²™ç®±æœºåˆ¶åŸç†</h3>
<h4 data-id="heading-2">2.1 ä¸ºä»€ä¹ˆéœ€è¦æ²™ç®±ï¼Ÿ</h4>
<p>å¾®å‰ç«¯æ¶æ„ä¸­ï¼Œå¤šä¸ªå­åº”ç”¨å¯èƒ½æ¥è‡ªä¸åŒå›¢é˜Ÿã€ä½¿ç”¨ä¸åŒæŠ€æœ¯æ ˆï¼Œå®ƒä»¬å…±äº«åŒä¸€ä¸ªæµè§ˆå™¨è¿è¡Œç¯å¢ƒã€‚å¦‚æœä¸åŠ éš”ç¦»ï¼Œä¼šäº§ç”Ÿä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>â€‹<strong>å…¨å±€å˜é‡æ±¡æŸ“</strong>â€‹ï¼šå­åº”ç”¨ A å®šä¹‰çš„ <code>window.config</code> å¯èƒ½è¢«å­åº”ç”¨ B è¦†ç›–</li>
<li>â€‹<strong>äº‹ä»¶ç›‘å¬æ³„æ¼</strong>â€‹ï¼šå­åº”ç”¨å¸è½½åï¼Œæ³¨å†Œçš„ <code>addEventListener</code> ä»åœ¨æ‰§è¡Œ</li>
<li>â€‹<strong>æ ·å¼å†²çª</strong>â€‹ï¼šä¸åŒå­åº”ç”¨çš„ CSS è§„åˆ™ç›¸äº’å½±å“</li>
</ul>
<p>qiankun é€šè¿‡ <strong>JavaScript æ²™ç®±</strong> æœºåˆ¶è§£å†³å…¨å±€å˜é‡éš”ç¦»é—®é¢˜ã€‚</p>
<h4 data-id="heading-3">2.2 ProxySandbox æ ¸å¿ƒåŸç†</h4>
<p>qiankun æä¾›äº†ä¸‰ç§æ²™ç®±æ–¹æ¡ˆï¼Œå…¶ä¸­ <code>ProxySandbox</code> æ˜¯å¤šå®ä¾‹ä¿æ´»åœºæ™¯çš„å”¯ä¸€é€‰æ‹©ï¼š</p>





























<table><thead><tr><th>æ²™ç®±ç±»å‹</th><th>å®ç°åŸç†</th><th>å¤šå®ä¾‹æ”¯æŒ</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>SnapshotSandbox</strong></td><td>æ¿€æ´»æ—¶å¿«ç…§ã€å¤±æ´»æ—¶ diff æ¢å¤</td><td>âŒ ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ Proxy çš„ä½ç‰ˆæœ¬æµè§ˆå™¨</td></tr><tr><td><strong>LegacySandbox</strong></td><td>å•ä¾‹ä»£ç†ï¼Œè®°å½•å˜æ›´</td><td>âŒ ä¸æ”¯æŒ</td><td>åªæœ‰ä¸€ä¸ªå­åº”ç”¨æ¿€æ´»çš„åœºæ™¯</td></tr><tr><td><strong>ProxySandbox</strong></td><td>ä¸ºæ¯ä¸ªå®ä¾‹åˆ›å»ºç‹¬ç«‹ fakeWindow</td><td>âœ… æ”¯æŒ</td><td>ç°ä»£æµè§ˆå™¨ï¼ˆæ¨èï¼‰</td></tr></tbody></table>
<p>â€‹<strong>ProxySandbox çš„å·¥ä½œåŸç†</strong>â€‹ï¼š</p>
<pre><code class="hljs language-Plaintext" lang="Plaintext">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      çœŸå® window å¯¹è±¡                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â–²
                              â”‚ è¯»å–ç™½åå•å±æ€§ / åŸç”Ÿæ–¹æ³•
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚                     â”‚
        â–¼                     â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Proxy ä»£ç†å±‚  â”‚    â”‚  Proxy ä»£ç†å±‚  â”‚    â”‚  Proxy ä»£ç†å±‚  â”‚
â”‚   (å­åº”ç”¨ A)   â”‚    â”‚   (å­åº”ç”¨ B)   â”‚    â”‚   (å­åº”ç”¨ C)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  fakeWindow A â”‚    â”‚  fakeWindow B â”‚    â”‚  fakeWindow C â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ config  â”‚  â”‚    â”‚  â”‚ config  â”‚  â”‚    â”‚  â”‚ config  â”‚  â”‚
â”‚  â”‚ myVar   â”‚  â”‚    â”‚  â”‚ myVar   â”‚  â”‚    â”‚  â”‚ myVar   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      å„è‡ªç‹¬ç«‹                å„è‡ªç‹¬ç«‹                å„è‡ªç‹¬ç«‹
</code></pre>
<p>æ ¸å¿ƒä»£ç ç®€åŒ–ç¤ºæ„ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ProxySandbox</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">fakeWindow</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-title class_">PropertyKey</span>, <span class="hljs-built_in">any</span>&gt; = {};

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">proxy</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">fakeWindow</span>, {
      <span class="hljs-attr">get</span>: <span class="hljs-function">(<span class="hljs-params">target, prop</span>) =&gt;</span> {
        <span class="hljs-comment">// ä¼˜å…ˆä» fakeWindow è¯»å–</span>
        <span class="hljs-keyword">if</span> (prop <span class="hljs-keyword">in</span> target) {
          <span class="hljs-keyword">return</span> target[prop];
        }
        <span class="hljs-comment">// ç™½åå•å±æ€§ä»çœŸå® window è¯»å–</span>
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">window</span>[prop];
      },
      <span class="hljs-attr">set</span>: <span class="hljs-function">(<span class="hljs-params">target, prop, value</span>) =&gt;</span> {
        <span class="hljs-comment">// æ‰€æœ‰å†™æ“ä½œéƒ½å†™å…¥ fakeWindowï¼Œä¸æ±¡æŸ“çœŸå® window</span>
        target[prop] = value;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      }
    });
  }
}
</code></pre>
<h4 data-id="heading-4">2.3 æ²™ç®±çš„æ¿€æ´»ä¸å¤±æ´»ç”Ÿå‘½å‘¨æœŸ</h4>
<p>qiankun æ²™ç®±æœ‰æ˜ç¡®çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼š</p>
<pre><code class="hljs language-Plaintext" lang="Plaintext">å­åº”ç”¨åŠ è½½ â”€â”€â–º beforeLoad â”€â”€â–º æ‰§è¡Œå…¥å£è„šæœ¬ â”€â”€â–º mount â”€â”€â–º æ²™ç®±æ¿€æ´»
                                                          â”‚
                                                          â–¼
                                              å‰¯ä½œç”¨ patch å¼€å§‹ç”Ÿæ•ˆ
                                              (Interval/Listener/History)
                                                          â”‚
                                              â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                          â”‚
ç”¨æˆ·åˆ‡æ¢è·¯ç”± â”€â”€â–º unmount â”€â”€â–º æ²™ç®±å¤±æ´» â”€â”€â–º å‰¯ä½œç”¨æ¸…ç† â”€â”€â–º DOM ç§»é™¤
</code></pre>
<p>â€‹<strong>å…³é”®æ—¶æœºè¯´æ˜</strong>â€‹ï¼š</p>
<ol>
<li>â€‹**æ²™ç®±æ¿€æ´» (active)**â€‹ï¼šè°ƒç”¨ <code>sandbox.active()</code>ï¼ŒProxy å¼€å§‹æ‹¦æˆª</li>
<li>â€‹<strong>å‰¯ä½œç”¨ patch</strong>â€‹ï¼šåœ¨ <code>mount</code> é˜¶æ®µå¯¹ <code>setInterval</code>ã€<code>addEventListener</code> ç­‰è¿›è¡ŒåŠ«æŒ</li>
<li>â€‹**æ²™ç®±å¤±æ´» (inactive)**â€‹ï¼šè°ƒç”¨ <code>sandbox.inactive()</code>ï¼Œæ¸…ç†è®°å½•çš„å‰¯ä½œç”¨</li>
</ol>
<p>ç†è§£äº†æ²™ç®±æœºåˆ¶åï¼Œæˆ‘ä»¬æ¥åˆ†æåœ¨å¤šå®ä¾‹ä¿æ´»åœºæ™¯ä¸‹ä¼šé‡åˆ°å“ªäº›å…·ä½“çš„æŠ€æœ¯æŒ‘æˆ˜ã€‚</p>
<h3 data-id="heading-5">ä¸‰ã€æŠ€æœ¯éš¾ç‚¹åˆ†æ</h3>
<p>å®ç°å¾®å‰ç«¯å¤šå®ä¾‹ä¿æ´»ï¼Œæœ‰å“ªäº›æŠ€æœ¯éš¾ç‚¹ï¼š</p>
<h4 data-id="heading-6">3.1ï¼šåº”ç”¨å®ä¾‹çš„ä¿æ´»ä¸æ¿€æ´»</h4>
<p>â€‹<strong>å…³é”®ç‚¹</strong>â€‹ï¼šåœ¨è·¯ç”±åˆ‡æ¢æ—¶ä¿ç•™åº”ç”¨çŠ¶æ€ï¼Œè€Œéé”€æ¯é‡å»ºã€‚</p>
<p>å¯¹äºå•ä½“åº”ç”¨ï¼Œè¿™ä¸ªé—®é¢˜å·²æœ‰æˆç†Ÿæ–¹æ¡ˆï¼š</p>
<ul>
<li>â€‹<strong>Vue é¡¹ç›®</strong>â€‹ï¼šä½¿ç”¨å†…ç½®çš„ <code>&lt;keep-alive&gt;</code> ç»„ä»¶å³å¯</li>
<li>â€‹<strong>React é¡¹ç›®</strong>â€‹ï¼šéœ€è¦è‡ªè¡Œå®ç°è·¯ç”±ç¼“å­˜ï¼Œæ ¸å¿ƒæ€è·¯æ˜¯<strong>ç¼“å­˜ç»„ä»¶å®ä¾‹</strong>è€Œéé”€æ¯</li>
</ul>
<p>â€‹<strong>å¯¹åº”åˆ° qiankun åœºæ™¯</strong>â€‹ï¼š</p>
<p>æœ¬è´¨ä¸Š qiankun ä»ç„¶æ˜¯ä¸€ä¸ª SPA åº”ç”¨ï¼Œåªæ˜¯é€šè¿‡è·¯ç”±è§„åˆ™å°†ä¸åŒçš„è·¯ç”±åˆ†å‘åˆ°å¯¹åº”çš„å­åº”ç”¨ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å¥—ç”¨ç›¸åŒçš„æ€è·¯ï¼š</p>
<ul>
<li>å­åº”ç”¨åˆ‡æ¢æ—¶ï¼š<strong>éšè—</strong>å½“å‰å­åº”ç”¨å®ä¾‹ï¼ˆè€Œéè°ƒç”¨ unmountï¼‰</li>
<li>å†æ¬¡æ¿€æ´»æ—¶ï¼š<strong>æ˜¾ç¤º</strong>å·²ç¼“å­˜çš„å®ä¾‹å¹¶æ¸²æŸ“</li>
<li>å…³é”®è¦ç‚¹ï¼š<strong>éšè—è€Œéé”€æ¯</strong> DOM èŠ‚ç‚¹</li>
</ul>
<h4 data-id="heading-7">3.2ï¼šå¤šæ²™ç®±å¹¶å­˜çš„éš”ç¦»</h4>
<p>â€‹<strong>å…³é”®ç‚¹</strong>â€‹ï¼šå¤šä¸ªå­åº”ç”¨åŒæ—¶ä¿æ´»ï¼Œæ„å‘³ç€å¤šä¸ªæ²™ç®±éœ€è¦åŒæ—¶æ¿€æ´»ä¸”äº’ä¸å¹²æ‰°ã€‚</p>
<p>â€‹<strong>è§£æ³•</strong>â€‹ï¼š</p>
<p>å¯ç”¨ <code>ProxySandbox</code>ï¼ˆå¤šå®ä¾‹ä»£ç†æ²™ç®±ï¼‰ã€‚å®ƒä¸ºæ¯ä¸ªå­åº”ç”¨åˆ›å»ºç‹¬ç«‹çš„ fakeWindow å‰¯æœ¬ï¼Œç¡®ä¿å¤šä¸ªå­åº”ç”¨å¯ä»¥åŒæ—¶æ¿€æ´»ä¸”å…¨å±€å˜é‡äº’ä¸æ±¡æŸ“ã€‚</p>
<p>åŸºäºä»¥ä¸Šåˆ†æï¼Œæˆ‘ä»¬å¼€å§‹å®æˆ˜ï¼ˆæ ¸å¿ƒæŠ€æœ¯æ ˆï¼šumijs 4 + qiankun + reactï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fasyncguo%2Fqiankun-multi-instance" target="_blank" title="https://github.com/asyncguo/qiankun-multi-instance" ref="nofollow noopener noreferrer">ä»£ç ä»“åº“</a>ï¼‰ã€‚</p>
<p>ä¸»åº”ç”¨æ ¸å¿ƒå®ç°ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">CachedApp</span> {
  <span class="hljs-attr">microApp</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">element</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">ReactElement</span> | <span class="hljs-literal">null</span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Layout</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// ä¿æ´»å®ä¾‹ç¼“å­˜æ± </span>
  <span class="hljs-keyword">const</span> cache = useRef&lt;<span class="hljs-title class_">CachedApp</span>[]&gt;([])
  <span class="hljs-keyword">const</span> element = <span class="hljs-title function_">useOutlet</span>()
  <span class="hljs-keyword">const</span> routeProps = <span class="hljs-title function_">useRouteProps</span>()
  <span class="hljs-keyword">const</span> { microApp } = routeProps

  <span class="hljs-comment">// é¦–æ¬¡è®¿é—®æ—¶åŠ å…¥ç¼“å­˜æ± </span>
  <span class="hljs-keyword">if</span> (!cache.<span class="hljs-property">current</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-property">microApp</span> === microApp)) {
    cache.<span class="hljs-property">current</span>.<span class="hljs-title function_">push</span>({
      microApp,
      element
    })
  }

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* æ‰€æœ‰å·²ç¼“å­˜çš„å­åº”ç”¨åŒæ—¶æ¸²æŸ“ï¼Œé€šè¿‡ hidden æ§åˆ¶æ˜¾éš */}
      {
        cache.current.map((app) =&gt; {
          return (
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
              <span class="hljs-attr">key</span>=<span class="hljs-string">{app.microApp}</span>
              <span class="hljs-attr">hidden</span>=<span class="hljs-string">{app.microApp</span> !== <span class="hljs-string">microApp}</span>
            &gt;</span>
              {app.element}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          )
        })
      }
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<p>ç„¶è€Œåœ¨çœŸå®ç¯å¢ƒè¿è¡Œæ—¶ï¼Œå­åº”ç”¨åœ¨åˆ‡æ¢è¿‡ç¨‹ä¸­ä¼šä¸¢å¤±çŠ¶æ€ï¼Œæµè§ˆå™¨çš„ warning ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92f6ce17997e454a9f3bb164295d0f97~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L2s6L2s5oqA5pyv5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767147464&amp;x-signature=slheSkFOyobzh%2FW7Ng3aAZ47gsk%3D" alt="" loading="lazy"/></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æ·±å…¥åˆ†æé—®é¢˜çš„å…·ä½“åŸå› ã€‚</p>
<h3 data-id="heading-8">å››ã€é—®é¢˜åˆ†æä¸å®šä½</h3>
<h4 data-id="heading-9">4.1ï¼šReact Router ä¸ºä»€ä¹ˆè§¦å‘ warningï¼Ÿ</h4>
<p>é€šè¿‡ warning æ‰§è¡Œæ ˆå®šä½åˆ° React Router çš„ Router ç»„ä»¶ã€‚æ ¹å› æ˜¯ <code>pathname</code> ä¸ <code>basename</code> ä¸åŒ¹é…æ—¶ï¼Œ<code>stripBasename</code> è¿”å› <code>null</code>ï¼Œå¯¼è‡´ Router ç»„ä»¶æ¸²æŸ“ç©ºå†…å®¹å¹¶æŠ›å‡ºè­¦å‘Šã€‚</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Router</span>(<span class="hljs-params">{
  // ...
}: RouterProps</span>): <span class="hljs-title class_">React</span>.<span class="hljs-property">ReactElement</span> | <span class="hljs-literal">null</span> {
  <span class="hljs-keyword">let</span> locationContext = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// pathname å’Œ basename ä¸åŒ¹é…æ—¶è¿”å› null</span>
    <span class="hljs-keyword">let</span> trailingPathname = <span class="hljs-title function_">stripBasename</span>(pathname, basename);
    <span class="hljs-keyword">if</span> (trailingPathname == <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
  }, [basename, pathname, search, hash, state, key, navigationType]);

  <span class="hljs-title function_">warning</span>(
    locationContext != <span class="hljs-literal">null</span>,
    <span class="hljs-string">`&lt;Router basename="<span class="hljs-subst">${basename}</span>"&gt; is not able to match the URL `</span> +
      <span class="hljs-string">`"<span class="hljs-subst">${pathname}</span><span class="hljs-subst">${search}</span><span class="hljs-subst">${hash}</span>" because it does not start with the `</span> +
      <span class="hljs-string">`basename, so the &lt;Router&gt; won't render anything.`</span>
  );

  <span class="hljs-keyword">if</span> (locationContext == <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">NavigationContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{navigationContext}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">LocationContext.Provider</span> <span class="hljs-attr">children</span>=<span class="hljs-string">{children}</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{locationContext}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">NavigationContext.Provider</span>&gt;</span></span>
  );
}
</code></pre>
<p>â€‹<strong>å…·ä½“åŸå› â€‹</strong>â€‹ï¼šéæ¿€æ´»å­åº”ç”¨ï¼ˆbasename=/app1ï¼‰æ”¶åˆ°äº†ä¸å±äºå®ƒçš„è·¯ç”±å˜åŒ–é€šçŸ¥ï¼ˆpathname=/app2/xxxï¼‰ï¼Œå¯¼è‡´åŒ¹é…å¤±è´¥ã€‚</p>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼šä¸ºä»€ä¹ˆéæ¿€æ´»çŠ¶æ€çš„å­åº”ç”¨è¿˜ä¼šå“åº”è·¯ç”±å˜åŒ–ï¼Ÿ</p>
<h4 data-id="heading-10">4.2ï¼šéæ¿€æ´»å­åº”ç”¨ä¸ºä»€ä¹ˆè§¦å‘ Re-renderï¼Ÿ</h4>
<p>â€‹<strong>è°ƒç”¨é“¾åˆ†æ</strong>â€‹ï¼š</p>
<pre><code class="hljs language-Plaintext" lang="Plaintext">è·¯ç”±å˜åŒ– (pushState/popstate)
        â”‚
        â–¼
window.dispatchEvent('popstate')  â—„â”€â”€ å…¨å±€äº‹ä»¶ï¼Œæ‰€æœ‰ç›‘å¬è€…éƒ½ä¼šæ”¶åˆ°
        â”‚
        â”œâ”€â”€â–º å­åº”ç”¨ A çš„ history.listen å›è°ƒæ‰§è¡Œ
        â”œâ”€â”€â–º å­åº”ç”¨ B çš„ history.listen å›è°ƒæ‰§è¡Œ  â—„â”€â”€ é—®é¢˜ï¼šå³ä½¿ B å·²"éšè—"
        â””â”€â”€â–º å­åº”ç”¨ C çš„ history.listen å›è°ƒæ‰§è¡Œ
                    â”‚
                    â–¼
        BrowserRoutes ç»„ä»¶ setState
                    â”‚
                    â–¼
        Router ç»„ä»¶ re-render â”€â”€â–º basename ä¸åŒ¹é… â”€â”€â–º Warning + æ¸²æŸ“å¤±è´¥
</code></pre>
<p>åˆ†æå…·ä½“ä»£ç é“¾è·¯ï¼š</p>
<ol>
<li>umijs çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fumijs%2Fumi%2Fblob%2Fmaster%2Fpackages%2Frenderer-react%2Fsrc%2Fbrowser.tsx" target="_blank" title="https://github.com/umijs/umi/blob/master/packages/renderer-react/src/browser.tsx" ref="nofollow noopener noreferrer">BrowserRoutes</a> é€šè¿‡ <code>history.listen</code> è®¢é˜…è·¯ç”±å˜åŒ–</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fremix-run%2Fhistory%2Fblob%2Fdev%2Fpackages%2Fhistory%2Findex.ts%23L430" target="_blank" title="https://github.com/remix-run/history/blob/dev/packages/history/index.ts#L430" ref="nofollow noopener noreferrer">history</a> å†…éƒ¨é€šè¿‡ <code>window.addEventListener</code> ç›‘å¬ <code>popstate</code> äº‹ä»¶</li>
<li>è·¯ç”±åˆ‡æ¢æ—¶è§¦å‘å…¨å±€ <code>popstate</code> äº‹ä»¶ï¼Œ<strong>æ‰€æœ‰è®¢é˜…å›è°ƒæ‰§è¡Œ</strong></li>
<li>å¯¼è‡´æ‰€æœ‰å­åº”ç”¨çš„ BrowserRoutes é‡æ–°æ¸²æŸ“ï¼Œè¿›è€Œè§¦å‘ Router çš„ re-render</li>
</ol>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">BrowserRoutes</span>(<span class="hljs-params">props</span>) {
  <span class="hljs-comment">// ...</span>
  <span class="hljs-title function_">useLayoutEffect</span>(<span class="hljs-function">() =&gt;</span> history.<span class="hljs-title function_">listen</span>(setState), [history]);
  <span class="hljs-title function_">useLayoutEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">return</span> history.<span class="hljs-title function_">listen</span>(onRouteChange);
  }, [history, props.<span class="hljs-property">routes</span>, props.<span class="hljs-property">clientRoutes</span>]);
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Router</span>
      <span class="hljs-attr">navigator</span>=<span class="hljs-string">{history}</span>
      <span class="hljs-attr">location</span>=<span class="hljs-string">{state.location}</span>
      <span class="hljs-attr">basename</span>=<span class="hljs-string">{props.basename}</span>
    &gt;</span>
      {props.children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">Router</span>&gt;</span></span>
  );
}
</code></pre>
<p>â€‹<strong>å…·ä½“åŸå› â€‹</strong>â€‹ï¼šå¤šä¸ªå­åº”ç”¨çš„ <code>history.listen</code> éƒ½æ³¨å†Œåœ¨åŒä¸€ä¸ªå…¨å±€ window ä¸Šï¼Œè·¯ç”±å˜åŒ–æ—¶æ‰€æœ‰å­åº”ç”¨éƒ½ä¼šå“åº”ã€‚</p>
<p>æŒ‰ç†è¯´ qiankun çš„æ²™ç®±åº”è¯¥éš”ç¦» <code>window.addEventListener</code>ï¼Œå¹¶ä¸” qiankun å¯¹ <code>setInterval</code>ã€<code>addEventListener</code>ã€<code>history.listen</code> éƒ½æœ‰ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fumijs%2Fqiankun%2Fblob%2Fmaster%2Fsrc%2Fsandbox%2Findex.ts%23L90" target="_blank" title="https://github.com/umijs/qiankun/blob/master/src/sandbox/index.ts#L90" ref="nofollow noopener noreferrer">patch</a>ï¼Œä¸ºä»€ä¹ˆè¿™é‡Œæ²¡ç”Ÿæ•ˆï¼Ÿ</p>
<h4 data-id="heading-11">4.3ï¼šä¸ºä»€ä¹ˆ addEventListener æ²¡è¢« patch ä½ï¼Ÿ</h4>
<p>è¦ç†è§£è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å…ˆäº†è§£ä¸€ä¸ªå…³é”®æ¦‚å¿µâ€”â€”â€‹**æ²™ç®±é€ƒé€¸ï¼ˆSandbox Escapeï¼‰**â€‹ã€‚</p>
<h5 data-id="heading-12">ä»€ä¹ˆæ˜¯æ²™ç®±é€ƒé€¸ï¼Ÿ</h5>
<p>æ²™ç®±é€ƒé€¸æ˜¯æŒ‡ä»£ç ç»•è¿‡æ²™ç®±çš„ä»£ç†æœºåˆ¶ï¼Œç›´æ¥è®¿é—®åˆ°çœŸå®çš„å…¨å±€å¯¹è±¡ã€‚ä¸€æ—¦å‘ç”Ÿé€ƒé€¸ï¼Œåœ¨çœŸå®å¯¹è±¡ä¸Šçš„æ“ä½œå°†æ— æ³•è¢«æ²™ç®±è¿½è¸ªå’Œæ¸…ç†ã€‚</p>
<pre><code class="hljs language-Plaintext" lang="Plaintext">æ­£å¸¸è·¯å¾„ï¼ˆè¢«æ²™ç®±æ‹¦æˆªï¼‰ï¼š
å­åº”ç”¨ä»£ç  â”€â”€â–º proxy.addEventListener â”€â”€â–º æ²™ç®±è®°å½• â”€â”€â–º å¸è½½æ—¶è‡ªåŠ¨æ¸…ç† âœ…

é€ƒé€¸è·¯å¾„ï¼ˆç»•è¿‡æ²™ç®±ï¼‰ï¼š
å­åº”ç”¨ä»£ç  â”€â”€â–º document.defaultView â”€â”€â–º çœŸå® window â”€â”€â–º addEventListener
                                                              â”‚
                                              æ²™ç®±æ— æ³•æ„ŸçŸ¥ï¼Œå¸è½½åä»å­˜åœ¨ âŒ
</code></pre>
<blockquote>
<p>é™¤æ­¤ä¹‹å¤–è¿˜æœ‰<strong>ä¿®æ”¹åŸå‹é“¾</strong>ã€<strong>ä¿®æ”¹æ·±å±‚å¯¹è±¡å±æ€§</strong>ç­‰æ–¹å¼ä¹Ÿä¼šè§¦å‘æ²™ç®±é€ƒé€¸ï¼Œè¿™éƒ¨åˆ†å†…å®¹å¯ä»¥è‡ªè¡Œäº†è§£ã€‚</p>
</blockquote>
<h5 data-id="heading-13">React Router çš„é€ƒé€¸è·¯å¾„åˆ†æ</h5>
<p><strong>Step 1ï¼šqiankun ä¸ºä½•ä¸ä»£ç† documentï¼Ÿ</strong></p>
<p>qiankun çš„ ProxySandbox å¯¹ <code>document</code> çš„è®¿é—®ä¼šè¿”å›çœŸå®çš„ document å¯¹è±¡ã€‚è¿™æ˜¯â€‹<strong>æœ‰æ„ä¸ºä¹‹</strong>â€‹â€”â€”å­åº”ç”¨å¿…é¡»æ“ä½œçœŸå® DOM æ‰èƒ½æ¸²æŸ“å†…å®¹ï¼ˆè¯¦è§ qiankun document æ²™ç›’ç¯å¢ƒè®¨è®º <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fumijs%2Fqiankun%2Fissues%2F493%23issuecomment-619707583" target="_blank" title="https://github.com/umijs/qiankun/issues/493#issuecomment-619707583" ref="nofollow noopener noreferrer">issue #493</a>ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fumijs%2Fqiankun%2Fissues%2F1175" target="_blank" title="https://github.com/umijs/qiankun/issues/1175" ref="nofollow noopener noreferrer">issue #1175</a>ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fumijs%2Fqiankun%2Fissues%2F1555" target="_blank" title="https://github.com/umijs/qiankun/issues/1555" ref="nofollow noopener noreferrer">issue #1555</a>ï¼‰ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// qiankun ProxySandbox æºç </span>
<span class="hljs-attr">get</span>: <span class="hljs-function">(<span class="hljs-params">target, prop</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (prop === <span class="hljs-string">'document'</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">document</span>;  <span class="hljs-comment">// è¿”å›çœŸå® documentï¼Œæœªä»£ç†</span>
  }
  <span class="hljs-comment">// ...</span>
}
</code></pre>
<p><strong>Step 2ï¼šReact Router å¦‚ä½•è§¦å‘é€ƒé€¸ï¼Ÿ</strong></p>
<p>React Router çš„ history åº“é€šè¿‡ <code>document.defaultView</code> è·å– window å¯¹è±¡ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// remix-run/history æºç </span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createBrowserHistory</span>(<span class="hljs-params">options = {}</span>) {
  <span class="hljs-comment">// å…³é”®ï¼šé€šè¿‡ document.defaultView è·å– window</span>
  <span class="hljs-comment">// ç”±äº document æœªè¢«ä»£ç†ï¼Œè¿™é‡Œæ‹¿åˆ°çš„æ˜¯çœŸå® windowï¼</span>
  <span class="hljs-keyword">let</span> { <span class="hljs-variable language_">window</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-property">defaultView</span>! } = options;

  <span class="hljs-comment">// åœ¨çœŸå® window ä¸Šæ³¨å†Œç›‘å¬å™¨ï¼Œç»•è¿‡äº†æ²™ç®±çš„ patch</span>
  <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'popstate'</span>, handlePop);
}
</code></pre>
<p>ç”±äº <code>document.defaultView === window</code>ï¼ˆçœŸå® windowï¼‰ï¼Œæ‰€æœ‰å­åº”ç”¨çš„è·¯ç”±ç›‘å¬å™¨æœ€ç»ˆéƒ½æ³¨å†Œåœ¨åŒä¸€ä¸ªå…¨å±€ window ä¸Šã€‚</p>
<pre><code class="hljs language-Plaintext" lang="Plaintext">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å­åº”ç”¨ä»£ç æ‰§è¡Œ                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ProxySandbox (fakeWindow ä»£ç†å±‚)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ get(prop) {                                              â”‚    â”‚
â”‚  â”‚   if (prop === 'window') return proxy; // âœ… æ‹¦æˆª       â”‚    â”‚
â”‚  â”‚   if (prop === 'document') return document; // âš ï¸ é€ƒé€¸  â”‚    â”‚
â”‚  â”‚ }                                                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                    â”‚
         â”‚ window.xxx                         â”‚ document.defaultView
         â–¼                                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ è¢«æ‹¦æˆª   â”‚                      â”‚  çœŸå® window â”‚
    â”‚ fakeWindowâ”‚                      â”‚  (é€ƒé€¸æˆåŠŸ)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h5 data-id="heading-14">qiankun çš„ addEventListener patch ä¸ºä½•å¤±æ•ˆï¼Ÿ</h5>
<p>ç†Ÿæ‚‰ qiankun æºç çš„åŒå­¦å¯èƒ½ä¼šé—®ï¼šqiankun ä¸æ˜¯å¯¹ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fumijs%2Fqiankun%2Fblob%2Ffc81b6241086c473ddff09d1ed1e19b5722926ee%2Fsrc%2Fsandbox%2Fpatchers%2FwindowListener.ts%23L80" target="_blank" title="https://github.com/umijs/qiankun/blob/fc81b6241086c473ddff09d1ed1e19b5722926ee/src/sandbox/patchers/windowListener.ts#L80" ref="nofollow noopener noreferrer">addEventListener åšè¿‡ patch</a> å—ï¼Ÿ</p>
<p>å…³é”®åœ¨äº patch çš„å¯¹è±¡æ˜¯â€‹<strong>â€‹ â€‹<code>proxy.addEventListener</code><strong>â€‹ï¼Œè€ŒéçœŸå® window ä¸Šçš„æ–¹æ³•ã€‚å½“ React Router é€šè¿‡ <code>document.defaultView</code> æ‹¿åˆ°çœŸå® window åï¼Œè°ƒç”¨çš„æ˜¯â€‹</strong>æœªè¢« patch çš„åŸç”Ÿ addEventListener</strong>â€‹ï¼Œè‡ªç„¶æ— æ³•è¢«æ²™ç®±è¿½è¸ªã€‚</p>
<pre><code class="hljs language-Plaintext" lang="Plaintext">qiankun patch çš„æ˜¯ï¼šproxy.addEventListener  â”€â”€â–º è¢«åŠ«æŒ âœ…
React Router è°ƒç”¨çš„æ˜¯ï¼šwindow.addEventListenerï¼ˆé€šè¿‡ document.defaultView è·å–ï¼‰â”€â”€â–º æœªè¢«åŠ«æŒ âŒ
</code></pre>
<p>è¿™ä¸ªé—®é¢˜ä¸ä»…å­˜åœ¨äºå¤šå®ä¾‹ä¿æ´»åœºæ™¯ï¼Œåœ¨æ™®é€šçš„ qiankun å­åº”ç”¨ä¸­ä¹Ÿå­˜åœ¨ï¼ˆè¯¦è§ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fumijs%2Fumi%2Fissues%2F12484" target="_blank" title="https://github.com/umijs/umi/issues/12484" ref="nofollow noopener noreferrer">umi issue #12484</a>ï¼‰ã€‚åªæ˜¯åœ¨å¤šå®ä¾‹ä¿æ´»åœºæ™¯ä¸‹ï¼Œç”±äºå­åº”ç”¨ä¸ä¼šè§¦å‘ unmountï¼Œé—®é¢˜è¢«æ”¾å¤§æš´éœ²å‡ºæ¥ã€‚</p>
<blockquote>
<p>è¿™ä¹Ÿå°è¯äº† qiankun å®˜æ–¹æ–‡æ¡£çš„è¯´æ˜ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fqiankun.umijs.org%2Fzh%2Ffaq%23%25E5%25A6%2582%25E4%25BD%2595%25E5%2590%258C%25E6%2597%25B6%25E6%25BF%2580%25E6%25B4%25BB%25E4%25B8%25A4%25E4%25B8%25AA%25E5%25BE%25AE%25E5%25BA%2594%25E7%2594%25A8" target="_blank" title="https://qiankun.umijs.org/zh/faq#%E5%A6%82%E4%BD%95%E5%90%8C%E6%97%B6%E6%BF%80%E6%B4%BB%E4%B8%A4%E4%B8%AA%E5%BE%AE%E5%BA%94%E7%94%A8" ref="nofollow noopener noreferrer">å¦‚ä½•åŒæ—¶æ¿€æ´»ä¸¤ä¸ªå¾®åº”ç”¨ï¼Ÿ</a></p>
<p>é¡µé¢ä¸Šä¸èƒ½åŒæ—¶æ˜¾ç¤ºå¤šä¸ªä¾èµ–äºè·¯ç”±çš„å¾®åº”ç”¨ï¼Œå› ä¸ºæµè§ˆå™¨åªæœ‰ä¸€ä¸ª urlï¼Œå¦‚æœæœ‰å¤šä¸ªä¾èµ–è·¯ç”±çš„å¾®åº”ç”¨åŒæ—¶è¢«æ¿€æ´»ï¼Œé‚£ä¹ˆå¿…å®šä¼šå¯¼è‡´å…¶ä¸­ä¸€ä¸ª 404ã€‚</p>
</blockquote>
<p>é—®é¢˜çš„åŸå› å·²ç»æ˜ç¡®ï¼šæ²™ç®±é€ƒé€¸å¯¼è‡´å‰¯ä½œç”¨æ— æ³•éš”ç¦»ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è®¾è®¡é’ˆå¯¹æ€§çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-15">äº”ã€è§£å†³æ–¹æ¡ˆè®¾è®¡</h3>
<p>å¤šå®ä¾‹ä¿æ´»åœºæ™¯ä¸‹ï¼Œå­åº”ç”¨å®ä¾‹æœªè§¦å‘ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fumijs%2Fqiankun%2Fblob%2Fmaster%2Fsrc%2Fsandbox%2Findex.ts%23L105C11-L105C18" target="_blank" title="https://github.com/umijs/qiankun/blob/master/src/sandbox/index.ts#L105C11-L105C18" ref="nofollow noopener noreferrer">unmount</a>ï¼ŒåŠ ä¸Šæ²™ç®±é€ƒé€¸å¯¼è‡´å‰¯ä½œç”¨ï¼ˆå¦‚ <code>popstate</code> ç›‘å¬å™¨ï¼‰æŒç»­ç´¯ç§¯ï¼Œå¼•å‘ä¿æ´»å¤±æ•ˆã€‚æ¥ä¸‹æ¥å¯ä»¥é€šè¿‡ patch React Router History çš„æ–¹å¼æ¥è§£å†³ã€‚</p>
<p>â€‹<strong>æ ¸å¿ƒæ€è·¯</strong>â€‹ï¼šæ‹¦æˆª <code>history.listen</code>ï¼Œåœ¨å›è°ƒå‡½æ•°ä¸­å¢åŠ è·¯ç”±åŒ¹é…åˆ¤æ–­ï¼Œåªæœ‰è·¯ç”±åŒ¹é…çš„å­åº”ç”¨æ‰æ‰§è¡Œè®¢é˜…å›è°ƒã€‚</p>
<pre><code class="hljs language-Plaintext" lang="Plaintext">è·¯ç”±å˜åŒ–é€šçŸ¥
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         åŒ…è£…åçš„ listen å›è°ƒ             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ if (pathname.startsWith(basename))â”‚  â”‚
â”‚  â”‚   æ‰§è¡ŒåŸå§‹å›è°ƒ âœ…                  â”‚  â”‚
â”‚  â”‚ else                              â”‚  â”‚
â”‚  â”‚   å¿½ç•¥æœ¬æ¬¡é€šçŸ¥ ğŸš«                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>åˆ©ç”¨ umi çš„ <code>modifyClientRenderOpts</code> æ’ä»¶é’©å­å®ç°ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">/**
 * patch history.listenï¼Œç¡®ä¿åªæœ‰è·¯ç”±åŒ¹é…çš„å­åº”ç”¨å“åº”è·¯ç”±å˜åŒ–
 * æ³¨æ„ï¼šç¡®ä¿è¯¥æ’ä»¶æœ€åæ‰§è¡Œï¼Œé¿å… patch è¢«è¦†ç›–
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">modifyClientRenderOpts</span> = (<span class="hljs-params">context: <span class="hljs-built_in">any</span></span>) =&gt; {
  <span class="hljs-comment">// ä»…åœ¨ qiankun å­åº”ç”¨æ¨¡å¼ä¸‹ä¸”å¼€å¯ä¿æ´»åŠŸèƒ½æ—¶ç”Ÿæ•ˆ</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">__POWERED_BY_QIANKUN__</span> &amp;&amp; !!context.<span class="hljs-property">enablePatchHistory</span>) {
    <span class="hljs-keyword">const</span> { history, basename } = context;
    <span class="hljs-keyword">const</span> rawHistoryListen = history.<span class="hljs-property">listen</span>;

    history.<span class="hljs-property">listen</span> = <span class="hljs-function">(<span class="hljs-params">fn: <span class="hljs-built_in">any</span></span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> <span class="hljs-title function_">listener</span> = (<span class="hljs-params">...args: <span class="hljs-built_in">any</span>[]</span>) =&gt; {
        <span class="hljs-keyword">const</span> { location } = args[<span class="hljs-number">0</span>];

        <span class="hljs-comment">// æ ¸å¿ƒé€»è¾‘ï¼šä»…å½“è·¯ç”±åŒ¹é…å½“å‰å­åº”ç”¨æ—¶æ‰æ‰§è¡Œå›è°ƒ</span>
        <span class="hljs-keyword">if</span> (location.<span class="hljs-property">pathname</span>.<span class="hljs-title function_">startsWith</span>(basename)) {
          <span class="hljs-title function_">fn</span>(...args);
        }
        <span class="hljs-comment">// ä¸åŒ¹é…æ—¶é™é»˜å¿½ç•¥ï¼Œé¿å…è§¦å‘ re-render</span>
      };

      <span class="hljs-keyword">const</span> unlistener = <span class="hljs-title function_">rawHistoryListen</span>(listener);
      <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">unlistener</span>();
    };

    <span class="hljs-keyword">return</span> context;
  }

  <span class="hljs-keyword">return</span> context;
};
</code></pre>
<p>æ¥ä¸‹æ¥ï¼Œå†è€ƒè™‘ä¸‹ç›´æ¥é€šè¿‡ window.addEventListener æ³¨å†Œçš„ç›‘å¬å™¨ï¼Œå³å­åº”ç”¨åœ¨åˆå§‹åŒ–é˜¶æ®µï¼ˆmount å‰ï¼‰é€šè¿‡ <code>headScripts</code> ç­‰æ–¹å¼æ³¨å†Œäº†å…¨å±€ç›‘å¬å™¨ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// umirc.ts - è¿™ç±»å‰¯ä½œç”¨åœ¨æ²™ç®± patch ç”Ÿæ•ˆå‰å°±å·²æ³¨å†Œ</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">headScripts</span>:[
    <span class="hljs-string">`window.addEventListener("popstate", function(){
        console.log("========= app1 popstate change =========");
      })`</span>
  ]
});
</code></pre>
<p>åŒæ ·ä¼šè¢«ç»§ç»­æ‰§è¡Œï¼Œé—®é¢˜åŸå› ï¼šqiankun çš„å‰¯ä½œç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fumijs%2Fqiankun%2Fblob%2Ffc81b6241086c473ddff09d1ed1e19b5722926ee%2Fsrc%2Fsandbox%2Findex.ts%23L90" target="_blank" title="https://github.com/umijs/qiankun/blob/fc81b6241086c473ddff09d1ed1e19b5722926ee/src/sandbox/index.ts#L90" ref="nofollow noopener noreferrer">patch</a> å‘ç”Ÿåœ¨ <code>mount</code> é˜¶æ®µï¼Œè€Œå…¥å£è„šæœ¬æ‰§è¡Œåœ¨æ­¤ä¹‹å‰ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createSandboxContainer</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">mount</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">/* ------------------------------------------ 1. å¯åŠ¨/æ¢å¤ æ²™ç®±------------------------------------------ */</span>
      sandbox.<span class="hljs-title function_">active</span>();

      <span class="hljs-comment">/* ------------------------------------------ 2. å¼€å¯å…¨å±€å˜é‡è¡¥ä¸ ------------------------------------------*/</span>
      <span class="hljs-comment">// render æ²™ç®±å¯åŠ¨æ—¶å¼€å§‹åŠ«æŒå„ç±»å…¨å±€ç›‘å¬ï¼Œå°½é‡ä¸è¦åœ¨åº”ç”¨åˆå§‹åŒ–é˜¶æ®µæœ‰ äº‹ä»¶ç›‘å¬/å®šæ—¶å™¨ ç­‰å‰¯ä½œç”¨</span>
      mountingFreers = <span class="hljs-title function_">patchAtMounting</span>(...);
    }
  };
}
</code></pre>
<p>â€‹<strong>è§£æ³•</strong>â€‹ï¼šåœ¨ <code>beforeLoad</code> é’©å­ä¸­æå‰ patchï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// ä¸»åº”ç”¨é…ç½®</span>
<span class="hljs-title function_">registerMicroApps</span>([{
  <span class="hljs-attr">name</span>: <span class="hljs-string">'app1'</span>,
  <span class="hljs-attr">entry</span>: <span class="hljs-string">'//localhost:6001'</span>,
  <span class="hljs-attr">container</span>: <span class="hljs-string">'#container'</span>,
  <span class="hljs-attr">activeRule</span>: <span class="hljs-string">'/app1'</span>,
  <span class="hljs-attr">props</span>: {
    <span class="hljs-comment">// é€šè¿‡ beforeLoad æå‰ patch</span>
    <span class="hljs-attr">beforeLoad</span>: <span class="hljs-keyword">async</span> (app) =&gt; {
      <span class="hljs-title function_">patchWindowAddEventListener</span>(app.<span class="hljs-property">name</span>);
    }
  }
}]);
</code></pre>
<blockquote>
<p>â€‹<strong>æ³¨</strong>â€‹ï¼šæ ¹æ®å®é™…ä¸šåŠ¡åœºæ™¯å†³å®šæ˜¯å¦éœ€è¦å®ç°æ­¤å¢å¼ºæ–¹æ¡ˆã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ–¹æ¡ˆä¸€å·²è¶³å¤Ÿè§£å†³é—®é¢˜ã€‚</p>
</blockquote>
<h3 data-id="heading-16">å…­ã€æ€»ç»“ä¸å±•æœ›</h3>
<p>é€šè¿‡æ·±å…¥åˆ†æ qiankun çš„æ²™ç®±æœºåˆ¶å’Œé€ƒé€¸è·¯å¾„ï¼Œæˆ‘ä»¬æˆåŠŸå®ç°äº†å¤šå®ä¾‹ä¿æ´»èƒ½åŠ›ã€‚æ ¸å¿ƒè§£å†³æ€è·¯æ˜¯ï¼šâ€‹<strong>åœ¨æ²™ç®±æ— æ³•è¦†ç›–çš„é€ƒé€¸ç‚¹è¿›è¡Œç²¾å‡† patch</strong>â€‹ã€‚</p>
<p>ç„¶è€Œåœ¨å®è·µè¿‡ç¨‹ä¸­ä¹Ÿå‘ç°ï¼Œæ‰‹åŠ¨ patch æ²™ç®±å‰¯ä½œç”¨éœ€è¦å¤„ç†å¤§é‡è¾¹ç•Œåœºæ™¯ï¼Œå®ç°æˆæœ¬è¾ƒé«˜ã€‚</p>
<p>éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œå½“å‰æ–¹æ¡ˆä¸»è¦è§£å†³äº†æ ¸å¿ƒåŠŸèƒ½å®ç°ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒè½åœ°æ—¶ä»éœ€å…³æ³¨ä»¥ä¸‹å·¥ç¨‹åŒ–é—®é¢˜ï¼š</p>
<ul>
<li>â€‹<strong>æ€§èƒ½è¾¹ç•Œ</strong>â€‹ï¼šå¤šå®ä¾‹å¸¸é©»å†…å­˜ä¼šå¯¼è‡´èµ„æºæ¶ˆè€—æ¿€å¢ï¼Œå¯ä»¥åŠ¨æ€é…ç½®å¼€å¯ä¿æ´»çš„å­åº”ç”¨ä¸ªæ•°</li>
<li>â€‹<strong>ç›‘æ§ä½“ç³»</strong>â€‹ï¼šæ¥å…¥å†…å­˜å ç”¨ã€å®ä¾‹æ•°é‡ã€æ¸²æŸ“æ€§èƒ½ç­‰å…³é”®æŒ‡æ ‡çš„å®æ—¶ç›‘æ§</li>
</ul>
<h4 data-id="heading-17">å…¶ä»–å¯è¡Œæ–¹æ¡ˆ</h4>
<p>é™¤äº†ä¸Šé¢å®è·µçš„æ–¹æ¡ˆï¼Œè¿˜æœ‰ä»¥ä¸‹æ€è·¯å¯ä¾›å‚è€ƒï¼š</p>
<p><strong>æ€è·¯ä¸€ï¼šåŸºäº iframe çš„æ²™ç®±éš”ç¦»ï¼ˆå¦‚ Wujieï¼‰</strong></p>
<p>åˆ©ç”¨ iframe å¤©ç„¶çš„éš”ç¦»ç‰¹æ€§å®ç°å¤šå®ä¾‹ä¿æ´»ï¼Œä½†åŒæ ·éœ€è¦å¤„ç†ï¼š</p>
<ul>
<li>iframe ä¸ä¸»åº”ç”¨çš„è·¯ç”±åŒæ­¥</li>
<li>DOM èŠ‚ç‚¹çš„è·¨ iframe æ¸²æŸ“</li>
</ul>
<p><strong>æ€è·¯äºŒï¼šæ¡†æ¶å±‚çš„çŠ¶æ€å¿«ç…§æœºåˆ¶</strong></p>
<p>ä¸Šé¢æ–¹æ¡ˆæ˜¯åœ¨ä¸»åº”ç”¨å±‚å®ç°å®ä¾‹ä¿æ´»ï¼Œå¦ä¸€ä¸ªæ€è·¯æ˜¯ä»å­åº”ç”¨æ¡†æ¶å±‚å…¥æ‰‹ï¼š</p>
<ul>
<li>å‚è€ƒ SSR çš„è®¾è®¡ç†å¿µï¼Œåœ¨æ¡†æ¶å±‚å®ç°çŠ¶æ€å¿«ç…§ä¸æ¢å¤</li>
<li>é€šè¿‡ç¼“å­˜ Virtual DOM æˆ–æ¸²æŸ“ç»“æœï¼Œåœ¨é‡æ–°æŒ‚è½½æ—¶å¿«é€Ÿæ¢å¤ç°åœº</li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fasyncguo%2Fqiankun-multi-instance" target="_blank" title="https://github.com/asyncguo/qiankun-multi-instance" ref="nofollow noopener noreferrer">å®Œæ•´ä»£ç ä»“åº“</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[python--å¤šç»§æ‰¿]]></title>    <link>https://juejin.cn/post/7586972442422919209</link>    <guid>https://juejin.cn/post/7586972442422919209</guid>    <pubDate>2025-12-24T02:55:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586972442422919209" data-draft-id="7586969583782821894" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="python--å¤šç»§æ‰¿"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2025-12-24T02:55:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ozyzo"/> <meta itemprop="url" content="https://juejin.cn/user/458965109710202"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            python--å¤šç»§æ‰¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/458965109710202/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ozyzo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T02:55:02.000Z" title="Wed Dec 24 2025 02:55:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¤šç»§æ‰¿ï¼š</h2>
<p><strong>å¼•è¨€ï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/86a618d79451424b936d7aa6ca9b53be~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgb3p5em8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149702&amp;x-signature=IUwcJEiwKISBjSN3dkBbsFzmwJ8%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1145eda38ce94b2194ee510d35f26a2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgb3p5em8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149702&amp;x-signature=tPdSgRV2WQeyURI1dV%2BoS2KkJXE%3D" alt="image.png" loading="lazy"/></p>
<p><strong>ä»£ç å¦‚ä¸‹ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å®šä¹‰ä¸€ä¸ªè¡¨ç¤ºæˆ¿å±‹çš„ç±»House</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">House</span>(<span class="hljs-title class_ inherited__">object</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">live</span>(<span class="hljs-params">self</span>):          <span class="hljs-comment"># å±…ä½</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ä¾›äººå±…ä½"</span>)
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">self</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"Houseç±»æµ‹è¯•"</span>)

<span class="hljs-comment"># å®šä¹‰ä¸€ä¸ªè¡¨ç¤ºæ±½è½¦çš„ç±»Car</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Car</span>(<span class="hljs-title class_ inherited__">object</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">drive</span>(<span class="hljs-params">self</span>):         <span class="hljs-comment"># è¡Œé©¶</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"è¡Œé©¶"</span>)
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">self</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"Carç±»æµ‹è¯•"</span>)

<span class="hljs-comment"># å®šä¹‰ä¸€ä¸ªè¡¨ç¤ºæˆ¿è½¦çš„ç±»ï¼Œç»§æ‰¿Houseå’ŒCarç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TouringCar</span>(House, Car):
    <span class="hljs-keyword">pass</span>

tour_car = TouringCar()
tour_car.live()    <span class="hljs-comment"># å­ç±»å¯¹è±¡è°ƒç”¨çˆ¶ç±»Houseçš„æ–¹æ³•</span>
tour_car.drive()   <span class="hljs-comment"># å­ç±»å¯¹è±¡è°ƒç”¨çˆ¶ç±»Carçš„æ–¹æ³•</span>
tour_car.test()    <span class="hljs-comment"># å­ç±»å¯¹è±¡è°ƒç”¨ä¸¤ä¸ªçˆ¶ç±»çš„åŒåæ–¹æ³•</span>
</code></pre>
<p><strong>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e0f752b68a743a797422e2bc4973d02~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgb3p5em8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767149702&amp;x-signature=wE0wDWgcekKXlUighXs%2BJTpPffM%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2025å¿«æ‰‹ç›´æ’­è‡³æš—æ—¶åˆ»ï¼šå½“é»‘äº§è‡ªåŠ¨åŒ–æ´ªæµå‡»ç©¿P0é˜²çº¿ï¼Œæˆ‘ä»¬å‰ç«¯èƒ½åšä»€ä¹ˆï¼ŸğŸ¤·â€â™‚ï¸]]></title>    <link>https://juejin.cn/post/7586944874526539814</link>    <guid>https://juejin.cn/post/7586944874526539814</guid>    <pubDate>2025-12-24T02:27:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586944874526539814" data-draft-id="7586954475655970862" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2025å¿«æ‰‹ç›´æ’­è‡³æš—æ—¶åˆ»ï¼šå½“é»‘äº§è‡ªåŠ¨åŒ–æ´ªæµå‡»ç©¿P0é˜²çº¿ï¼Œæˆ‘ä»¬å‰ç«¯èƒ½åšä»€ä¹ˆï¼ŸğŸ¤·â€â™‚ï¸"/> <meta itemprop="keywords" content="å‰ç«¯,å®‰å…¨,JavaScript"/> <meta itemprop="datePublished" content="2025-12-24T02:27:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ErpanOmer"/> <meta itemprop="url" content="https://juejin.cn/user/3878732754331096"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2025å¿«æ‰‹ç›´æ’­è‡³æš—æ—¶åˆ»ï¼šå½“é»‘äº§è‡ªåŠ¨åŒ–æ´ªæµå‡»ç©¿P0é˜²çº¿ï¼Œæˆ‘ä»¬å‰ç«¯èƒ½åšä»€ä¹ˆï¼ŸğŸ¤·â€â™‚ï¸
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3878732754331096/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ErpanOmer
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T02:27:26.000Z" title="Wed Dec 24 2025 02:27:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å…„å¼Ÿä»¬ï¼Œå‰å¤©çš„ç“œéƒ½åƒäº†å—ï¼ŸğŸ¤£</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f5e0fa1b982f44568e05e76e2dcf8d41~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJwYW5PbWVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767148046&amp;x-signature=VNk7UvKY%2FrBxb8XpCKPrHS9iI5s%3D" alt="image.png" loading="lazy"/></p>
<p>è¯´å®è¯ï¼Œä½œä¸ºä¸€åè¿˜åœ¨å†™ä»£ç çš„æ‰“å·¥ä»”ï¼Œçœ‹åˆ°å‰å¤©æ™šä¸Šå¿«æ‰‹é‚£ä¸ªçƒ­æœï¼Œæˆ‘æ‰‹é‡Œæ§ç€çš„å’–å•¡éƒ½ä¸é¦™äº†ï¼ŒåèƒŒä¸€é˜µå‘å‡‰ã€‚</p>
<p><strong>12æœˆ22æ—¥æ™šä¸Š10ç‚¹</strong>ï¼Œæ­£æ˜¯æµé‡æœ€çŒ›çš„æ—¶å€™ï¼Œå¿«æ‰‹ç›´æ’­é—´çªç„¶å¤±æ§ã€‚ä¸æ˜¯æœåŠ¡å™¨å´©äº†ï¼Œè€Œæ˜¯å†…å®¹å´©äº†â€”â€”å¤§é‡è§†é¢‘åƒæ´ªæ°´ä¸€æ ·çŒè¿›æ¥ã€‚ç´§æ¥ç€å°±æ˜¯å®˜æ–¹æ— å¥ˆçš„æ‹”ç½‘çº¿ï¼Œå…¨ç«™ç›´æ’­å¼ºè¡Œå…³åœã€‚ç¬¬äºŒå¤©å¼€ç›˜ï¼Œè‚¡ä»·ç›´æ¥è·Œäº†3ä¸ªç‚¹ã€‚</p>
<p>è¿™å¯ä¸æ˜¯æ™®é€šçš„ Bugï¼Œè¿™æ˜¯<strong>P0 çº§ä¸­çš„ P0</strong>ã€‚</p>
<p>å¾ˆå¤šç¾¤é‡Œåœ¨ä¼ å†…é¬¼æˆ–è€…0dayï¼Œä½†çœ‹äº†å‡ ä½å®‰å…¨åœˆå¤§ä½¬ï¼ˆ360ã€å¥‡å®‰ä¿¡ï¼‰çš„å¤ç›˜ï¼Œæˆ‘å‘ç°è¿™äº‹å„¿æ¯”æƒ³è±¡ä¸­æ›´ææ€–ï¼š<strong>è¿™æ˜¯ä¸€æ¬¡æ•™ç§‘ä¹¦çº§åˆ«çš„é»‘äº§è‡ªåŠ¨åŒ–é™ç»´æ‰“å‡»ã€‚</strong></p>
<p>ä»Šå¤©ä¸è°ˆå…¬å…³ï¼Œå’±ä»¬çº¯ä»æŠ€æœ¯è§’åº¦å¤ç›˜ä¸€ä¸‹ï¼š<strong>å‡å¦‚è¿™äº‹å„¿å‘ç”Ÿåœ¨ä½ è´Ÿè´£çš„é¡¹ç›®é‡Œï¼Œä½ çš„å‰ç«¯ä»£ç èƒ½æŠ—ä½å‡ ç§’ï¼Ÿ</strong></p>
<hr/>
<h3 data-id="heading-0">å½“è„šæœ¬æ¯”çœŸäººè¿˜å¤šè¿˜å¿«æ—¶ï¼Ÿ</h3>
<p>è¿™æ¬¡äº‹æ•…æœ€éªšçš„åœ°æ–¹åœ¨äºï¼Œé»‘äº§æ ¹æœ¬ä¸æŒ‰å¥—è·¯å‡ºç‰Œã€‚</p>
<p>ä»¥å‰çš„æ”»å‡»æ˜¯ DDoSï¼Œæ‰“ä½ çš„å¸¦å®½ï¼Œè®©ä½ æœåŠ¡ä¸å¯ç”¨ã€‚</p>
<p>è¿™æ¬¡æ˜¯ Content DDoSï¼ˆå†…å®¹æ‹’ç»æœåŠ¡ï¼‰ã€‚</p>
<h4 data-id="heading-1">1. å‰ç«¯é˜²çº¿å½¢åŒè™šè®¾</h4>
<p>å¤§å®¶æœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œé»‘äº§æ˜¯æ€ä¹ˆæŠŠè§†é¢‘å‘å‡ºæ¥çš„ï¼Ÿ</p>
<p>ä»–ä»¬ç»å¯¹ä¸ä¼šååœ¨æ‰‹æœºå‰ï¼Œä¸€ä¸ªä¸€ä¸ªç‚¹å¼€å§‹ç›´æ’­ã€‚ä»–ä»¬ç”¨çš„æ˜¯ç¾¤æ§ã€æ˜¯è„šæœ¬ã€æ˜¯æ— å¤´æµè§ˆå™¨ï¼ˆHeadless Browserï¼‰ã€‚</p>
<p>è¿™æ„å‘³ç€ä»€ä¹ˆï¼Ÿ</p>
<p>æ„å‘³ç€ä½ å‰ç«¯å†™çš„é‚£äº› if (user.isLogin)ã€é‚£äº›æ¼‚äº®çš„ UI æ‹¦æˆªã€é‚£äº›å¼¹çª—æç¤ºï¼Œåœ¨é»‘å®¢çœ¼é‡Œå…¨æ˜¯ç©ºæ°”ã€‚ä»–ä»¬ç›´æ¥é€†å‘äº†ä½ çš„ APIï¼Œæ‹¿åˆ°äº†æ¨æµæ¥å£ï¼Œç„¶åå‡ ä¸‡ä¸ªå¹¶å‘è°ƒç”¨ã€‚</p>
<h4 data-id="heading-2">2. å®¡æ ¸ç³»ç»Ÿè¢«é¥±å’Œå¼æ”»å‡»</h4>
<p>åç«¯é€šå¸¸æœ‰äººå·¥+AI å®¡æ ¸ã€‚å¹³æ—¶ QPS æ˜¯ 1ä¸‡ï¼Œå¤§å®¶ç›¸å®‰æ— äº‹ã€‚</p>
<p>æ˜¨æ™šï¼Œé»‘äº§å¯èƒ½ç¬é—´æŠŠ QPS æ‹‰åˆ°äº† 100ä¸‡ã€‚</p>
<p>äº‘ç«¯ AI å®¡æ ¸é˜Ÿåˆ—ç›´æ¥çˆ†äº†ï¼Œäººå·¥å®¡æ ¸å‘˜ä¼°è®¡é¼ æ ‡éƒ½ç‚¹å†’çƒŸäº†ä¹Ÿå®¡ä¸è¿‡æ¥ã€‚ä¸€æ—¦é˜ˆå€¼è¢«å‡»ç©¿ï¼Œè„ä¸œè¥¿å°±æµåˆ°äº†ç”¨æˆ·ç«¯ã€‚</p>
<hr/>
<h3 data-id="heading-3">é‚£å‰ç«¯èƒŒé”…äº†å—ï¼Ÿ</h3>
<p>è™½ç„¶æ ¸å¿ƒæ¼æ´è‚¯å®šåœ¨åç«¯é‰´æƒå’Œé£æ§é€»è¾‘ï¼ˆå¤§æ¦‚ç‡æ˜¯æ¥å£ç­¾åæ³„éœ²ï¼‰ï¼Œä½†å’±ä»¬å‰ç«¯ä½œä¸º <strong>ç¦»é»‘å®¢æœ€è¿‘çš„ä¸€å±‚çš®</strong>ï¼Œå¦‚æœåšå¾—å¥½ï¼Œç»å¯¹èƒ½æŠŠæ”»å‡»æˆæœ¬æ‹‰é«˜ 100 å€ã€‚</p>
<p>æ¥ï¼Œå¦‚æœä¸å¹¸é‡åˆ°äº†è¿™ç§<strong>è‡ªåŠ¨åŒ–è„šæœ¬</strong>æ”»å‡»ï¼Œå’±ä»¬å‰ç«¯æ‰‹é‡Œè¿˜æœ‰ä»€ä¹ˆç‰Œï¼ŸğŸ¤”</p>
<h4 data-id="heading-4">åˆ«æŠŠ <code>Sign</code> ç®—æ³•ç›´æ¥å†™åœ¨ JS é‡Œï¼</h4>
<p>å¾ˆå¤šå…„å¼Ÿå†™æ¥å£ç­¾åï¼Œç›´æ¥åœ¨ request.js é‡Œå†™ä¸ª md5(params + salt) å®Œäº‹ã€‚</p>
<p>å¤§å“¥ï¼ŒChrome F12 ä¸€å¼€ï¼ŒSources ä¸€æœï¼Œæ–­ç‚¹ä¸€æ‰“ï¼Œä½ çš„ç›ï¼ˆSaltï¼‰å°±è£¸å¥”äº†ã€‚</p>
<p>é˜²èŒƒæ“ä½œï¼šç›´æ¥ä¸Š WASM (WebAssembly)</p>
<p>æŠŠæ ¸å¿ƒçš„åŠ å¯†ã€ç­¾åé€»è¾‘ï¼Œç”¨ C++ æˆ– Rust å†™ï¼Œç¼–è¯‘æˆ .wasm æ–‡ä»¶ç»™å‰ç«¯è°ƒã€‚</p>
<p>é»‘å®¢æƒ³é€†å‘ WASMï¼Ÿé‚£æˆæœ¬å¯æ¯”è¯» JS ä»£ç é«˜å¤ªå¤šäº†ã€‚è¿™å°±æ˜¯ç»™ä»–ä»¬è®¾çš„ç¬¬ä¸€é“åã€‚</p>
<h4 data-id="heading-5">ä½ çš„ç”¨æˆ·ï¼Œå¯èƒ½æ ¹æœ¬ä¸æ˜¯äºº</h4>
<p>é»‘äº§ç”¨çš„æ˜¯è„šæœ¬ã€‚è„šæœ¬å’ŒçœŸäººçš„æ“ä½œæ˜¯æœ‰æœ¬è´¨åŒºåˆ«çš„ã€‚</p>
<p>ä¸è¦åªä¼šåœ¨ç™»å½•é¡µæä¸ªæ»‘å—ï¼Œæ²¡ç”¨çš„ï¼Œç°åœ¨çš„å›¾åƒè¯†åˆ«æ—©ç ´äº†ã€‚</p>
<p>è¦åœ¨ <strong>å…³é”®æ“ä½œï¼ˆæ¯”å¦‚ç‚¹å‡»å¼€å§‹ç›´æ’­ï¼‰</strong> å‰ï¼Œé‡‡é›†ä¸€æ³¢æ•°æ®ï¼š</p>
<ul>
<li><strong>é¼ æ ‡è½¨è¿¹</strong>ï¼šçœŸäººçš„è½¨è¿¹æ˜¯æ›²çº¿ï¼ˆè´å¡å°”æ›²çº¿ï¼‰ï¼Œè„šæœ¬é€šå¸¸æ˜¯ç›´çº¿ã€‚</li>
<li><strong>ç‚¹å‡»é—´éš”</strong>ï¼šè„šæœ¬æ˜¯æ¯«ç§’çº§çš„å›ºå®šé—´éš”ï¼Œäººæ˜¯æœ‰éšæœºæŠ–åŠ¨çš„ã€‚</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// ä¼ªä»£ç ï¼Œç®€å•çš„æ˜¯ä¸æ˜¯äººæ£€æµ‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isHuman</span>(<span class="hljs-params">events</span>) {
    <span class="hljs-comment">// å¦‚æœé¼ æ ‡è½¨è¿¹è¿‡äºå¹³æ»‘æˆ–å‘ˆç»å¯¹ç›´çº¿ -&gt; æœºå™¨äºº</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">analyzeTrajectory</span>(events) === <span class="hljs-string">'perfect_linear'</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-comment">// å¦‚æœç‚¹å‡»æ—¶é—´é—´éš”å®Œå…¨ä¸€è‡´ -&gt; æœºå™¨äºº</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">checkTiming</span>(events) === <span class="hljs-string">'fixed_interval'</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}
</code></pre>
<p>æŠŠè¿™äº›è¡Œä¸ºæ•°æ®æ‰“åˆ†ï¼Œéšç€è¯·æ±‚å‘ç»™åç«¯ã€‚åˆ†ä½çš„ï¼Œç›´æ¥æ‹’ç»æ¨æµã€‚</p>
<h4 data-id="heading-6">æ—¢ç„¶é˜²ä¸ä½å†…é¬¼ï¼Œé‚£å°±ç»™ä»–æ‰“æ ‡</h4>
<p>è¿™æ¬¡å¾ˆå¤šäººæ€€ç–‘æ˜¯å†…éƒ¨æ³„éœ²äº†æ¥å£æ–‡æ¡£æˆ–å¯†é’¥ã€‚è¯´å®è¯ï¼Œè¿™ç§äº‹é˜²ä¸èƒœé˜²ã€‚</p>
<p>ä½†æ˜¯ï¼Œå‰ç«¯å¯ä»¥æ <strong>ç›²æ°´å°</strong>ã€‚</p>
<p>åœ¨ä½ çš„ Admin ç®¡ç†åå°ã€æ–‡æ¡£å¹³å°ï¼ŒåŠ ä¸Šè‚‰çœ¼çœ‹ä¸è§çš„ Canvas æ°´å°ï¼ˆæŠŠå‘˜å·¥ ID ç¼–ç è¿›èƒŒæ™¯å›¾çš„ RGB å¾®å°å·®å€¼é‡Œï¼Œå…·ä½“å¤§å®¶è‡ªå·±å»æ¢ç´¢ğŸ˜–ï¼‰ã€‚</p>
<p>ä¸€æ—¦æˆªå›¾æµå‡ºï¼Œé©¬ä¸Šå°±èƒ½è§£ç å‡ºæ˜¯å“ªä¸ªå‘˜å·¥æ³„éœ²çš„ã€‚å¨æ…‘åŠ› &gt; æŠ€æœ¯æœ¬èº«ã€‚</p>
<p>æˆ–è€…è¯•è¯•è¿™ä¸ªæŠ€å·§ ğŸ‘‰ <a href="https://juejin.cn/post/7578402574653112372" target="_blank" title="https://juejin.cn/post/7578402574653112372">å¦‚ä½•ç”¨éšå½¢å­—ç¬¦ç»™å…¬å¸å†…éƒ¨æ–‡æ¡£åŠ ç›²æ°´å°?(æŠ“å†…é¬¼ç¥å™¨ğŸ¤£)</a></p>
<hr/>
<h3 data-id="heading-7">å®‰å…¨å¤ç›˜</h3>
<p>è¿™æ¬¡å¿«æ‰‹äº‹ä»¶ï¼Œå…¶å®å°±æ­»åœ¨äº†ä¸€ä¸ªé€»è¾‘ä¸Šï¼š <strong>åç«¯å¤ªä¿¡ä»»é€šè¿‡äº†å‰ç«¯æµç¨‹çš„è¯·æ±‚ã€‚</strong></p>
<p>æˆ‘ä»¬å†™ä»£ç æ—¶å¸¸çŠ¯çš„é”™è¯¯ï¼š</p>
<ul>
<li>å‰ç«¯æ ¡éªŒè¿‡æ‰‹æœºå·æ ¼å¼äº†ï¼Œåç«¯ä¸ç”¨æ ¡éªŒäº†å§ï¼Ÿ</li>
<li>å¿…é¡»ç‚¹äº†æŒ‰é’®æ‰èƒ½è§¦å‘è¿™ä¸ªè¯·æ±‚ï¼Œæ‰€ä»¥è¿™ä¸ªæ¥å£å¾ˆå®‰å…¨ã€‚</li>
</ul>
<p>å¤§é”™ç‰¹é”™ï¼</p>
<p>2025 å¹´äº†ï¼Œå…„å¼Ÿä»¬ã€‚åœ¨ Web çš„ä¸–ç•Œé‡Œï¼Œ<strong>ä¸ç›¸ä¿¡å‰ç«¯</strong> æ‰æ˜¯ä¿å‘½æ³•åˆ™ã€‚</p>
<p>ä»»ä½•ä»å®¢æˆ·ç«¯å‘æ¥çš„æ•°æ®ï¼Œéƒ½è¦é»˜è®¤å®ƒæ˜¯<strong>æœ‰æ¯’</strong>çš„ã€‚</p>
<p>ä¹‹å‰æˆ‘éƒ½å‘è¿‡ç±»ä¼¼çš„æ–‡ç« ï¼š<a href="https://juejin.cn/post/7580616979473367046" target="_blank" title="https://juejin.cn/post/7580616979473367046">ä¸ºä»€ä¹ˆæ°¸è¿œä¸è¦ç›¸ä¿¡å‰ç«¯è¾“å…¥ï¼Ÿç»•è¿‡å‰ç«¯éªŒè¯ï¼Œåªéœ€ä¸€ä¸ª cURL å‘½ä»¤ï¼</a></p>
<p>å¸Œæœ›å¯¹ä½ ä»¬æœ‰å¸®åŠ©ğŸ‘†</p>
<hr/>
<p>è¿™æ¬¡æ˜¯å¿«æ‰‹ï¼Œä¸‹æ¬¡å¯èƒ½å°±æ˜¯å’±ä»¬çš„å…¬å¸ã€‚</p>
<p>å°¤å…¶æ˜¯å¹´åº•äº†ï¼Œé»‘ç°äº§ä¹Ÿè¦å†²ä¸šç»©ï¼ˆè™½ç„¶è¿™ä¸ªä¸šç»©æœ‰ç‚¹ç¼ºå¾·ğŸ˜–ï¼‰ã€‚</p>
<p>å»ºè®®å¤§å®¶ä¸Šç­æ—¶çœ‹çœ‹è¿™å‡ ä»¶äº‹ï¼š</p>
<ol>
<li><strong>æŸ¥ä¸€ä¸‹æ ¸å¿ƒæ¥å£ï¼ˆæ”¯ä»˜ã€å‘å¸–ã€æ¨æµï¼‰æœ‰æ²¡æœ‰åšç­¾åæ ¡éªŒã€‚</strong></li>
<li><strong>çœ‹çœ‹æœ‰æ²¡æœ‰åšé¢‘ç‡é™åˆ¶ï¼ˆRate Limitingï¼‰ï¼Œå‰ç«¯åç«¯éƒ½è¦çœ‹ã€‚</strong></li>
<li><strong>æœä¸€ä¸‹ä½ ä»¬çš„ä»£ç ä»“åº“ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æŠŠå…¬å¸çš„ Key æˆ–è€…æºç ä¼ ä¸Šå»ï¼ˆè¿™ä¸ªçœŸçš„å¾ˆå¸¸è§ï¼ï¼‰ã€‚</strong></li>
</ol>
<p><strong>å‰ç«¯ä¸åªæ˜¯ç”»é¡µé¢çš„ï¼Œå…³é”®æ—¶åˆ»ï¼Œå’±ä»¬ä¹Ÿæ˜¯å®‰å…¨é˜²çº¿çš„ä¸€éƒ¨åˆ†ã€‚</strong></p>
<p>åˆ«ç­‰åˆ°åŠå¤œè¢«è¿ç»´ç”µè¯å«é†’ï¼Œé‚£æ—¶å€™å°±çœŸåªèƒ½ç”šè‡³æƒ³é‡å†™ç®€å†äº†ğŸ¤£ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b2deea76254f4c57beded6b7a5983301~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJwYW5PbWVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767148046&amp;x-signature=2FtzYugdhwEcO0QYW8HwURdh86M%3D" alt="è°¢è°¢å¤§å®¶.gif" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆ Spring Cloud Gateway å¿…é¡»ç”¨ WebFluxï¼Ÿ]]></title>    <link>https://juejin.cn/post/7586969583783428102</link>    <guid>https://juejin.cn/post/7586969583783428102</guid>    <pubDate>2025-12-24T03:02:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586969583783428102" data-draft-id="7586994471738441771" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆ Spring Cloud Gateway å¿…é¡»ç”¨ WebFluxï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•,æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-24T03:02:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¸æµªæ— ç—•"/> <meta itemprop="url" content="https://juejin.cn/user/2834988091055719"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆ Spring Cloud Gateway å¿…é¡»ç”¨ WebFluxï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2834988091055719/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¸æµªæ— ç—•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T03:02:20.000Z" title="Wed Dec 24 2025 03:02:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•å­ï¼šä¸ºä»€ä¹ˆSpring Cloud Gatewayé€‰æ‹©WebFluxï¼Ÿ</h2>
<p>Spring Cloud Gatewayæ˜¯Springå®˜æ–¹çš„æ–°ä¸€ä»£ç½‘å…³ï¼Œå®ƒå½»åº•æŠ›å¼ƒäº†ä¹‹å‰åŸºäºServletçš„Zuul 1.xï¼Œè½¬è€Œé‡‡ç”¨WebFluxã€‚</p>
<p>è¿™ä¸æ˜¯èµ¶æ—¶é«¦ï¼Œè€Œæ˜¯ç½‘å…³åœºæ™¯çš„å¿…ç„¶é€‰æ‹©ã€‚</p>
<h3 data-id="heading-1">ç½‘å…³çš„ç‰¹æ®Šæ€§</h3>
<p>ç½‘å…³çš„æ ¸å¿ƒå·¥ä½œæ˜¯ä»€ä¹ˆï¼Ÿ<strong>è½¬å‘è¯·æ±‚ã€‚</strong></p>
<pre><code class="hljs language-css" lang="css">å®¢æˆ·ç«¯è¯·æ±‚
    â†“
ç½‘å…³æ¥æ”¶
    â†“
è·¯ç”±åˆ°åç«¯æœåŠ¡<span class="hljs-selector-tag">A</span>ã€<span class="hljs-selector-tag">B</span>ã€Cï¼ˆå¯èƒ½éœ€è¦è°ƒç”¨å¤šä¸ªï¼‰
    â†“
èšåˆç»“æœ
    â†“
è¿”å›ç»™å®¢æˆ·ç«¯
</code></pre>
<p>è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œç½‘å…³è‡ªå·±å‡ ä¹ä¸åšè®¡ç®—ï¼Œ95%çš„æ—¶é—´éƒ½åœ¨ï¼š</p>
<ul>
<li>ç­‰å¾…åç«¯æœåŠ¡å“åº”</li>
<li>å¤„ç†ç½‘ç»œI/O</li>
</ul>
<h3 data-id="heading-2">ä¼ ç»ŸServletçš„å›°å¢ƒ</h3>
<p>å¦‚æœç”¨Servletå®¹å™¨ï¼ˆTomcatï¼‰ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">1ä¸ªè¯·æ±‚è¿›æ¥
<span class="hljs-code">    â†“
åˆ†é…1ä¸ªçº¿ç¨‹
    â†“
çº¿ç¨‹å‘èµ·HTTPè°ƒç”¨åç«¯æœåŠ¡
    â†“
çº¿ç¨‹é˜»å¡ç­‰å¾…å“åº”ï¼ˆå¯èƒ½100ms-500msï¼‰
    â†“
æ”¶åˆ°å“åº”ï¼Œè¿”å›å®¢æˆ·ç«¯
    â†“
çº¿ç¨‹é‡Šæ”¾
</span></code></pre>
<p><strong>é—®é¢˜åœ¨å“ªï¼Ÿ</strong></p>
<p>å‡è®¾ç½‘å…³è¦æ‰¿è½½1ä¸‡QPSï¼š</p>
<ul>
<li>æ¯ä¸ªè¯·æ±‚å¹³å‡è€—æ—¶200ms</li>
<li>åŒæ—¶åœ¨å¤„ç†çš„è¯·æ±‚ = 10000 * 0.2 = 2000ä¸ª</li>
<li>éœ€è¦2000ä¸ªçº¿ç¨‹</li>
</ul>
<p>ä½†Tomcaté»˜è®¤æœ€å¤§çº¿ç¨‹æ•°æ˜¯200ï¼Œå³ä½¿è°ƒåˆ°2000ï¼š</p>
<ul>
<li>2000ä¸ªçº¿ç¨‹ Ã— 1MBæ ˆç©ºé—´ = 2GBå†…å­˜</li>
<li>çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€å·¨å¤§</li>
<li>å¤§éƒ¨åˆ†çº¿ç¨‹éƒ½åœ¨é˜»å¡ç­‰å¾…ï¼Œæµªè´¹èµ„æº</li>
</ul>
<h3 data-id="heading-3">WebFluxçš„ä¼˜åŠ¿</h3>
<p>åŒæ ·çš„åœºæ™¯ï¼ŒWebFluxåªéœ€è¦ï¼š</p>
<ul>
<li>8-16ä¸ªEventLoopçº¿ç¨‹</li>
<li>å†…å­˜å ç”¨ä¸åˆ°200MB</li>
<li>çº¿ç¨‹æ°¸ä¸é˜»å¡ï¼Œåˆ©ç”¨ç‡100%</li>
</ul>
<p><strong>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆSpring Cloud Gatewayå¿…é¡»ç”¨WebFluxã€‚</strong></p>
<p>ç½‘å…³ä¸æ˜¯ç®€å•çš„åº”ç”¨ï¼Œè€Œæ˜¯æµé‡æ¢çº½ï¼Œå¿…é¡»ç”¨éé˜»å¡I/Oæ¥æ¦¨å¹²ç¡¬ä»¶æ€§èƒ½ã€‚</p>
<h2 data-id="heading-4">ç¬¬ä¸€å±‚ï¼šWebFluxçš„æŠ€æœ¯æ ˆ</h2>
<p>å…ˆçœ‹WebFluxåˆ°åº•ç”±å“ªäº›éƒ¨åˆ†ç»„æˆï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[ä½ çš„Controllerä»£ç ] --&gt; B[Spring WebFluxæ¡†æ¶å±‚]
    B --&gt; C[Project Reactorå“åº”å¼åº“]
    C --&gt; D[Nettyç½‘ç»œI/Oæ¡†æ¶]
    D --&gt; E[Java NIO]
    E --&gt; F[æ“ä½œç³»ç»Ÿ epoll/kqueue]
</code></pre>
<p>æ¯ä¸€å±‚éƒ½æœ‰æ˜ç¡®çš„èŒè´£ï¼š</p>









































<table><thead><tr><th>å±‚æ¬¡</th><th>ç»„ä»¶</th><th>èŒè´£</th><th>ä¸¾ä¾‹</th></tr></thead><tbody><tr><td>åº”ç”¨å±‚</td><td>Spring WebFlux</td><td>è·¯ç”±ã€æ³¨è§£ã€ä¾èµ–æ³¨å…¥</td><td>@GetMapping</td></tr><tr><td>ç¼–ç¨‹æ¨¡å‹å±‚</td><td>Project Reactor</td><td>å“åº”å¼API</td><td>Monoã€Fluxã€flatMap</td></tr><tr><td>ç½‘ç»œå±‚</td><td>Netty</td><td>äº‹ä»¶é©±åŠ¨I/O</td><td>EventLoopã€Channel</td></tr><tr><td>ç³»ç»ŸæŠ½è±¡å±‚</td><td>Java NIO</td><td>éé˜»å¡I/O</td><td>Selectorã€ByteBuffer</td></tr><tr><td>æ“ä½œç³»ç»Ÿå±‚</td><td>epoll/kqueue</td><td>I/Oå¤šè·¯å¤ç”¨</td><td>ç³»ç»Ÿè°ƒç”¨</td></tr></tbody></table>
<p>è¿™äº›å±‚æ¬¡ç¯ç¯ç›¸æ‰£ï¼Œç¼ºä¸€ä¸å¯ã€‚</p>
<h2 data-id="heading-5">ç¬¬äºŒå±‚ï¼šReactoråˆ°åº•æ˜¯ä»€ä¹ˆ</h2>
<p>å¾ˆå¤šäººç¬¬ä¸€æ¬¡æ¥è§¦WebFluxï¼Œä¼šè¢«ä¸¤ä¸ª"Reactor"ææ™•ï¼š</p>
<ul>
<li>Nettyçš„Reactoræ¨¡å¼</li>
<li>Project Reactoråº“</li>
</ul>
<p>å®ƒä»¬æ˜¯ä¸åŒçš„ä¸œè¥¿ã€‚</p>
<h3 data-id="heading-6">Nettyçš„Reactoræ¨¡å¼</h3>
<p>è¿™æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œç”¨äºå¤„ç†å¹¶å‘I/Oï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Nettyçš„Reactorå®ç°</span>
<span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">bossGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">1</span>);     <span class="hljs-comment">// ä¸»Reactor</span>
<span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workerGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">4</span>);   <span class="hljs-comment">// ä»Reactor</span>

<span class="hljs-type">ServerBootstrap</span> <span class="hljs-variable">bootstrap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerBootstrap</span>()
    .group(bossGroup, workerGroup);
</code></pre>
<p><strong>Bossè´Ÿè´£æ¥æ”¶è¿æ¥ï¼ŒWorkerè´Ÿè´£å¤„ç†I/O</strong>ï¼Œè¿™å°±æ˜¯Reactoræ¨¡å¼çš„ä¸»ä»å¤šçº¿ç¨‹ç‰ˆæœ¬ã€‚</p>
<h3 data-id="heading-7">Project Reactoråº“</h3>
<p>è¿™æ˜¯Springç”Ÿæ€çš„å“åº”å¼ç¼–ç¨‹åº“ï¼Œæä¾›Monoå’ŒFluxè¿™äº›APIï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// çº¯å†…å­˜æ“ä½œï¼Œä¸éœ€è¦Netty</span>
Mono.just(<span class="hljs-number">1</span>)
    .map(i -&gt; i * <span class="hljs-number">2</span>)
    .filter(i -&gt; i &gt; <span class="hljs-number">1</span>)
    .subscribe(System.out::println);
</code></pre>
<p>Project Reactoræ˜¯ç‹¬ç«‹çš„åº“ï¼Œä¸ä¾èµ–Nettyã€‚å®ƒåªæ˜¯æä¾›äº†å“åº”å¼ç¼–ç¨‹çš„æŠ½è±¡ï¼Œç±»ä¼¼Java 8çš„Stream APIã€‚</p>
<p><strong>é‚£ä¸ºä»€ä¹ˆæ€»å’ŒNettyä¸€èµ·å‡ºç°ï¼Ÿ</strong></p>
<p>å› ä¸ºåœ¨WebFluxåšç½‘ç»œI/Oæ—¶ï¼Œåº•å±‚ç”¨Nettyå®ç°ï¼Œä¸Šå±‚ç”¨Reactor APIç¼–ç¨‹ã€‚ä¸¤è€…é…åˆå·¥ä½œï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">Reactorå®šä¹‰<span class="hljs-string">"åšä»€ä¹ˆ"</span>ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰
Nettyè´Ÿè´£<span class="hljs-string">"æ€ä¹ˆåš"</span>ï¼ˆç½‘ç»œI/Oï¼‰
</code></pre>
<h2 data-id="heading-8">ç¬¬ä¸‰å±‚ï¼šä¸€ä¸ªåŠNettyçš„æ¶æ„</h2>
<p>è¿™æ˜¯ç†è§£WebFluxçš„æ ¸å¿ƒã€‚</p>
<p>WebFluxä½¿ç”¨äº†ä¸¤å¥—Nettyçº¿ç¨‹ç»„ï¼Œä½†ç¬¬äºŒå¥—æ˜¯"é˜‰å‰²ç‰ˆ"ã€‚</p>
<h3 data-id="heading-9">Serverç«¯ï¼šå®Œæ•´çš„Netty</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ ‡å‡†çš„NettyæœåŠ¡ç«¯é…ç½®</span>
<span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">bossGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">1</span>);
<span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workerGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">4</span>);

<span class="hljs-type">ServerBootstrap</span> <span class="hljs-variable">bootstrap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerBootstrap</span>();
bootstrap.group(bossGroup, workerGroup)
    .channel(NioServerSocketChannel.class)
    .childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpServerInitializer</span>());
</code></pre>
<p>è¿™æ˜¯å®Œæ•´çš„Reactoræ¨¡å¼ï¼š</p>
<ul>
<li><strong>Bossçº¿ç¨‹ç»„</strong>ï¼šä¸“é—¨è´Ÿè´£<code>accept()</code>æ–°çš„TCPè¿æ¥</li>
<li><strong>Workerçº¿ç¨‹ç»„</strong>ï¼šè´Ÿè´£å¤„ç†å·²å»ºç«‹è¿æ¥çš„I/Oè¯»å†™</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[å®¢æˆ·ç«¯è¿æ¥1] --&gt; B[Bossçº¿ç¨‹]
    C[å®¢æˆ·ç«¯è¿æ¥2] --&gt; B
    D[å®¢æˆ·ç«¯è¿æ¥3] --&gt; B
    B --&gt; E[Workerçº¿ç¨‹1]
    B --&gt; F[Workerçº¿ç¨‹2]
    B --&gt; G[Workerçº¿ç¨‹3]
    B --&gt; H[Workerçº¿ç¨‹4]
</code></pre>
<p>Bosså°±åƒå…¬å¸è€æ¿ï¼Œåªè´Ÿè´£æ¥é¡¹ç›®ï¼ˆæ¥æ”¶è¿æ¥ï¼‰ï¼Œç„¶ååˆ†é…ç»™é¡¹ç›®ç»ç†ï¼ˆWorkerï¼‰å»æ‰§è¡Œã€‚</p>
<h3 data-id="heading-10">Clientç«¯ï¼šåŠä¸ªNetty</h3>
<p>å½“WebFluxéœ€è¦è°ƒç”¨å¤–éƒ¨æœåŠ¡æ—¶ï¼Œç”¨çš„æ˜¯WebClientï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">WebClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> WebClient.builder()
    .baseUrl(<span class="hljs-string">"http://api.example.com"</span>)
    .build();

Mono&lt;User&gt; user = client.get()
    .uri(<span class="hljs-string">"/user/123"</span>)
    .retrieve()
    .bodyToMono(User.class);
</code></pre>
<p>WebClientåº•å±‚ç”¨çš„æ˜¯Nettyçš„HttpClientï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Netty Clientçš„é…ç½®</span>
<span class="hljs-type">HttpClient</span> <span class="hljs-variable">httpClient</span> <span class="hljs-operator">=</span> HttpClient.create()
    .runOn(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">4</span>));  <span class="hljs-comment">// åªæœ‰EventLoop</span>
</code></pre>
<p><strong>æ³¨æ„ï¼šè¿™é‡Œåªæœ‰EventLoopï¼Œæ²¡æœ‰Bossçº¿ç¨‹ç»„ã€‚</strong></p>
<h3 data-id="heading-11">ä¸ºä»€ä¹ˆClientä¸éœ€è¦Bossï¼Ÿ</h3>
<p>è¿™æ˜¯å…³é”®é—®é¢˜ã€‚</p>
<p><strong>Bossçš„èŒè´£æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Bossçº¿ç¨‹åšçš„äº‹</span>
<span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
    <span class="hljs-type">SocketChannel</span> <span class="hljs-variable">clientSocket</span> <span class="hljs-operator">=</span> serverSocket.accept();  <span class="hljs-comment">// æ¥æ”¶æ–°è¿æ¥</span>
    workerGroup.register(clientSocket);  <span class="hljs-comment">// åˆ†é…ç»™Worker</span>
}
</code></pre>
<p>Bossè´Ÿè´£ç›‘å¬ç«¯å£ï¼Œæ¥æ”¶å®¢æˆ·ç«¯ä¸»åŠ¨å‘èµ·çš„è¿æ¥è¯·æ±‚ã€‚</p>
<p><strong>Clientçš„å·¥ä½œæ–¹å¼å®Œå…¨ä¸åŒï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Clientä¸»åŠ¨è¿æ¥æœåŠ¡ç«¯</span>
<span class="hljs-type">Socket</span> <span class="hljs-variable">socket</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Socket</span>(<span class="hljs-string">"api.example.com"</span>, <span class="hljs-number">80</span>);
socket.connect();  <span class="hljs-comment">// ä¸»åŠ¨å‘èµ·è¿æ¥</span>
</code></pre>
<p>Clientæ˜¯ä¸»åŠ¨è¿æ¥åˆ«äººï¼Œä¸éœ€è¦ç›‘å¬ç«¯å£ï¼Œè‡ªç„¶ä¸éœ€è¦Bossã€‚</p>
<h3 data-id="heading-12">ç±»æ¯”è¯´æ˜</h3>
<p><strong>Serverç«¯ï¼ˆå®Œæ•´å…¬å¸æ¶æ„ï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-css" lang="css">è€æ¿ï¼ˆBossï¼‰
    â†“
ä¸“é—¨è´Ÿè´£ç­¾çº¦æ–°å®¢æˆ·ï¼ˆæ¥æ”¶TCPè¿æ¥ï¼‰
    â†“
æŠŠé¡¹ç›®åˆ†é…ç»™é¡¹ç›®ç»ç†ï¼ˆWorkerï¼‰
    â†“
é¡¹ç›®ç»ç†è´Ÿè´£æ‰§è¡Œï¼ˆå¤„ç†<span class="hljs-selector-tag">I</span>/Oï¼‰
</code></pre>
<p><strong>Clientç«¯ï¼ˆå¤–åŒ…å¼€å‘å›¢é˜Ÿï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">æ²¡æœ‰è€æ¿
<span class="hljs-code">    â†“
å¼€å‘äººå‘˜ç›´æ¥æ¥åˆ°ä»»åŠ¡ï¼ˆä¸»åŠ¨å‘èµ·è¿æ¥ï¼‰
    â†“
è‡ªå·±å»å¯¹æ¥å®¢æˆ·ï¼ˆå‘é€HTTPè¯·æ±‚ï¼‰
    â†“
å®Œæˆåç›´æ¥æ±‡æŠ¥ï¼ˆæ¥æ”¶HTTPå“åº”ï¼‰
</span></code></pre>
<p>å¤–åŒ…å›¢é˜Ÿä¸éœ€è¦è€æ¿æ¥æ¥æ´»ï¼Œå› ä¸ºæ´»æ˜¯åˆ«äººæ´¾ç»™ä»–ä»¬çš„ã€‚</p>
<p><strong>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¯´"åŠä¸ªNetty"ï¼šClientç«¯çš„Nettyåªæœ‰EventLoopï¼Œç¼ºå°‘Bossç»„ä»¶ã€‚</strong></p>
<h3 data-id="heading-13">å®Œæ•´æ¶æ„å›¾</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph &amp;#34;Serverç«¯ - å®Œæ•´Netty&amp;#34;
        SB[Bossçº¿ç¨‹ç»„&lt;br/&gt;1ä¸ªçº¿ç¨‹&lt;br/&gt;æ¥æ”¶TCPè¿æ¥]
        SW[Workerçº¿ç¨‹ç»„&lt;br/&gt;4ä¸ªçº¿ç¨‹&lt;br/&gt;å¤„ç†HTTPè¯·æ±‚]
        SB --&gt; SW
    end
    
    subgraph &amp;#34;Clientç«¯ - åŠä¸ªNetty&amp;#34;
        CE[EventLoopçº¿ç¨‹ç»„&lt;br/&gt;4ä¸ªçº¿ç¨‹&lt;br/&gt;å‘èµ·HTTPè¯·æ±‚]
    end
    
    SW -.æ´¾å‘å¤–éƒ¨è°ƒç”¨.-&gt; CE
    CE -.è¿”å›å“åº”æ•°æ®.-&gt; SW
    
    style SB fill:#90EE90
    style SW fill:#87CEEB
    style CE fill:#FFB6C1
</code></pre>
<ul>
<li>ç»¿è‰²ï¼šServer Bossï¼ˆæ¥æ”¶è¿æ¥ï¼‰</li>
<li>è“è‰²ï¼šServer Workerï¼ˆå¤„ç†ä¸šåŠ¡ï¼‰</li>
<li>ç²‰è‰²ï¼šClient EventLoopï¼ˆè°ƒç”¨å¤–éƒ¨ï¼‰</li>
</ul>
<p>Serverå’ŒClientæ˜¯ä¸¤å¥—ç‹¬ç«‹çš„çº¿ç¨‹ç»„ï¼Œé€šè¿‡Reactorçš„å›è°ƒæœºåˆ¶åä½œã€‚</p>
<h2 data-id="heading-14">ç¬¬å››å±‚ï¼šä¸€ä¸ªè¯·æ±‚çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸ</h2>
<p>å‡è®¾æœ‰ä¸ªControlleréœ€è¦æŸ¥è¯¢ç”¨æˆ·å’Œè®¢å•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RestController</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderController</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> WebClient webClient;
    
    <span class="hljs-meta">@GetMapping("/order/{userId}")</span>
    <span class="hljs-keyword">public</span> Mono&lt;OrderDTO&gt; <span class="hljs-title function_">getOrder</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> <span class="hljs-type">int</span> userId)</span> {
        <span class="hljs-keyword">return</span> webClient.get()
            .uri(<span class="hljs-string">"http://user-service/user/"</span> + userId)
            .retrieve()
            .bodyToMono(User.class)
            .flatMap(user -&gt; webClient.get()
                .uri(<span class="hljs-string">"http://order-service/order/"</span> + user.getOrderId())
                .retrieve()
                .bodyToMono(Order.class))
            .map(order -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderDTO</span>(order));
    }
}
</code></pre>
<h3 data-id="heading-15">å®Œæ•´æ—¶åºå›¾</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant Client as å®¢æˆ·ç«¯
    participant SB as Server Boss&lt;br/&gt;(1ä¸ªçº¿ç¨‹)
    participant SW as Server Worker&lt;br/&gt;(4ä¸ªçº¿ç¨‹)
    participant Code as ä¸šåŠ¡ä»£ç &lt;br/&gt;(Reactor)
    participant CE as Client EventLoop&lt;br/&gt;(4ä¸ªçº¿ç¨‹)
    participant US as ç”¨æˆ·æœåŠ¡
    participant OS as è®¢å•æœåŠ¡

    Client-&gt;&gt;SB: HTTPè¯·æ±‚
    Note over SB: Bossæ¥æ”¶TCPè¿æ¥
    SB-&gt;&gt;SW: åˆ†é…ç»™Workerçº¿ç¨‹2
    Note over SW: çº¿ç¨‹2è§£æHTTP
    SW-&gt;&gt;Code: è·¯ç”±åˆ°getOrder()
    
    Note over Code: æ‰§è¡ŒwebClient.get(user)
    Code-&gt;&gt;CE: æ´¾å‘ç»™Client EventLoop
    Note over SW: Workerçº¿ç¨‹2ç•™ä¸‹é’©å­&lt;br/&gt;ç«‹å³è¿”å›ï¼Œä¸ç­‰å¾…
    
    Note over CE: Clientçº¿ç¨‹5å‘èµ·HTTP
    CE-&gt;&gt;US: GET /user/123
    
    Note over SW: Workerçº¿ç¨‹2ç»§ç»­&lt;br/&gt;å¤„ç†å…¶ä»–è¯·æ±‚
    
    US-&gt;&gt;CE: è¿”å›Useræ•°æ®
    Note over CE: è§¦å‘Reactorå›è°ƒ
    CE-&gt;&gt;Code: æ‰§è¡ŒflatMapé€»è¾‘
    
    Note over Code: æ‰§è¡ŒwebClient.get(order)
    Code-&gt;&gt;CE: å†æ¬¡æ´¾å‘ä»»åŠ¡
    Note over CE: Clientçº¿ç¨‹6å‘èµ·HTTP
    CE-&gt;&gt;OS: GET /order/456
    
    OS-&gt;&gt;CE: è¿”å›Orderæ•°æ®
    Note over CE: è§¦å‘æœ€åçš„mapå›è°ƒ
    CE-&gt;&gt;SW: è¿”å›æœ€ç»ˆç»“æœ
    
    Note over SW: Workerçº¿ç¨‹2æ”¶åˆ°ç»“æœ
    SW-&gt;&gt;Client: å‘é€HTTPå“åº”&lt;br/&gt;ä¸ç»è¿‡Boss
</code></pre>
<h3 data-id="heading-16">è¯¦ç»†æ­¥éª¤æ‹†è§£</h3>
<p><strong>ç¬¬1æ­¥ï¼šæ¥æ”¶è¿æ¥ï¼ˆBossçš„å·¥ä½œï¼‰</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">å®¢æˆ·ç«¯å‘èµ·TCPè¿æ¥
    â†“
<span class="hljs-built_in">Server</span> Bossçº¿ç¨‹ï¼ˆçº¿ç¨‹<span class="hljs-number">1</span>ï¼‰æ‰§è¡Œ<span class="hljs-built_in">accept</span>()
    â†“
åˆ›å»ºSocketChannel
    â†“
æ³¨å†Œåˆ°<span class="hljs-built_in">Server</span> Workerçº¿ç¨‹ç»„
    â†“
Bossçº¿ç¨‹å›åˆ°å¾ªç¯ï¼Œç»§ç»­acceptå…¶ä»–è¿æ¥
</code></pre>
<p>Bossåªè´Ÿè´£æ¥æ”¶è¿æ¥ï¼Œç«‹å³å°±äº¤å‡ºå»äº†ã€‚</p>
<p><strong>ç¬¬2æ­¥ï¼šå¤„ç†HTTPè¯·æ±‚ï¼ˆWorkerçš„å·¥ä½œï¼‰</strong></p>
<pre><code class="hljs language-scss" lang="scss">å‡è®¾åˆ†é…ç»™Workerçº¿ç¨‹<span class="hljs-number">2</span>
    â†“
çº¿ç¨‹<span class="hljs-number">2</span>ä»SocketChannelè¯»å–HTTPè¯·æ±‚
    â†“
è§£æHTTPå¤´ã€è·¯å¾„ã€å‚æ•°
    â†“
WebFluxè·¯ç”±ï¼š/<span class="hljs-attribute">order</span>/<span class="hljs-number">123</span> -&gt; OrderController<span class="hljs-selector-class">.getOrder</span>(<span class="hljs-number">123</span>)
    â†“
æ‰§è¡ŒControlleræ–¹æ³•
</code></pre>
<p>è¿™ä¸€æ­¥éƒ½åœ¨çº¿ç¨‹2ä¸ŠåŒæ­¥æ‰§è¡Œã€‚</p>
<p><strong>ç¬¬3æ­¥ï¼šç¬¬ä¸€æ¬¡å¤–éƒ¨è°ƒç”¨ï¼ˆå…³é”®è½¬æŠ˜ç‚¹ï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ‰§è¡Œåˆ°è¿™ä¸€è¡Œ</span>
<span class="hljs-keyword">return</span> webClient.get()
    .uri(<span class="hljs-string">"http://user-service/user/123"</span>)
    .retrieve()
    .bodyToMono(User.class)
</code></pre>
<p>è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p>
<pre><code class="hljs language-arduino" lang="arduino">Workerçº¿ç¨‹<span class="hljs-number">2</span>æ‰§è¡ŒwebClient.<span class="hljs-built_in">get</span>()
    â†“
åˆ›å»ºHTTPè¯·æ±‚å¯¹è±¡
    â†“
æ´¾å‘ç»™<span class="hljs-built_in">Client</span> EventLoopçº¿ç¨‹ç»„
    â†“
å‡è®¾åˆ†é…ç»™<span class="hljs-built_in">Client</span>çº¿ç¨‹<span class="hljs-number">5</span>
    â†“
Workerçº¿ç¨‹<span class="hljs-number">2</span>æ³¨å†Œå›è°ƒï¼ˆé’©å­ï¼‰
    â†“
ç«‹å³è¿”å›Mono&lt;User&gt;å¯¹è±¡ï¼ˆæ­¤æ—¶è¿˜æ²¡æœ‰æ•°æ®ï¼‰
    â†“
Workerçº¿ç¨‹<span class="hljs-number">2</span>çš„å·¥ä½œå®Œæˆï¼Œå¯ä»¥å¤„ç†å…¶ä»–è¯·æ±‚äº†
</code></pre>
<p><strong>å…³é”®ï¼šWorkerçº¿ç¨‹2ä¸ç­‰å¾…ï¼</strong></p>
<p>å®ƒç•™ä¸‹ä¸€ä¸ª"é’©å­"ï¼ˆå›è°ƒå‡½æ•°ï¼‰ï¼Œç„¶åç«‹å³é‡Šæ”¾ï¼Œå»å¤„ç†ä¸‹ä¸€ä¸ªHTTPè¯·æ±‚äº†ã€‚</p>
<p><strong>ç¬¬4æ­¥ï¼šClientçº¿ç¨‹å‘èµ·å®é™…è°ƒç”¨</strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-built_in">Client</span> EventLoopçº¿ç¨‹<span class="hljs-number">5</span>æ‹¿åˆ°ä»»åŠ¡
    â†“
ä½¿ç”¨Nettyçš„Channelå‘èµ·HTTPè¯·æ±‚
    â†“
é€šè¿‡NIOçš„Selectoræ³¨å†ŒOP_CONNECTäº‹ä»¶
    â†“
å‘é€HTTPè¯·æ±‚æ•°æ®åˆ°ç”¨æˆ·æœåŠ¡
    â†“
æ³¨å†ŒOP_READäº‹ä»¶ï¼Œç­‰å¾…å“åº”
    â†“
çº¿ç¨‹<span class="hljs-number">5</span>ä¸é˜»å¡ï¼Œç»§ç»­å¤„ç†å…¶ä»–ä»»åŠ¡
</code></pre>
<p>Clientçº¿ç¨‹5ä¹Ÿä¸ä¼šå‚»ç­‰ï¼Œå®ƒå‘å‡ºè¯·æ±‚åï¼Œé€šè¿‡Selectoræ³¨å†Œäº†"è¯»äº‹ä»¶"ï¼Œç„¶åå»å¹²åˆ«çš„äº†ã€‚</p>
<p><strong>ç¬¬5æ­¥ï¼šæ¥æ”¶ç”¨æˆ·æœåŠ¡å“åº”</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">ç”¨æˆ·æœåŠ¡è¿”å›æ•°æ®
    â†“
Selectoræ£€æµ‹åˆ°OP_READäº‹ä»¶
    â†“
<span class="hljs-built_in">Client</span>çº¿ç¨‹<span class="hljs-number">5</span>è¢«å”¤é†’
    â†“
ä»SocketChannelè¯»å–å“åº”æ•°æ®
    â†“
è§£æHTTPå“åº”ä½“ï¼Œå¾—åˆ°Userå¯¹è±¡
    â†“
è§¦å‘Reactorçš„å›è°ƒé“¾
</code></pre>
<p>è¿™æ—¶ï¼Œä¹‹å‰æ³¨å†Œçš„"é’©å­"è¢«è§¦å‘äº†ã€‚</p>
<p><strong>ç¬¬6æ­¥ï¼šæ‰§è¡ŒflatMapï¼ˆè¿˜åœ¨Clientçº¿ç¨‹5ä¸Šï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java">.flatMap(user -&gt; webClient.get()
    .uri(<span class="hljs-string">"http://order-service/order/"</span> + user.getOrderId())
    .retrieve()
    .bodyToMono(Order.class))
</code></pre>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-built_in">Client</span>çº¿ç¨‹<span class="hljs-number">5</span>æ‹¿åˆ°Userå¯¹è±¡
    â†“
æ‰§è¡ŒflatMapä¸­çš„lambda
    â†“
å†æ¬¡è°ƒç”¨webClient.<span class="hljs-built_in">get</span>()
    â†“
è¿™æ¬¡å¯èƒ½åˆ†é…ç»™<span class="hljs-built_in">Client</span>çº¿ç¨‹<span class="hljs-number">6</span>
    â†“
å‘èµ·ç¬¬äºŒä¸ªHTTPè¯·æ±‚åˆ°è®¢å•æœåŠ¡
    â†“
æ³¨å†Œæ–°çš„å›è°ƒ
</code></pre>
<p><strong>ç¬¬7æ­¥ï¼šè®¢å•æœåŠ¡å“åº”</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">è®¢å•æœåŠ¡è¿”å›Orderæ•°æ®
    â†“
<span class="hljs-built_in">Client</span>çº¿ç¨‹<span class="hljs-number">6</span>æ¥æ”¶å“åº”
    â†“
è§¦å‘mapå›è°ƒ
    â†“
æ„é€ OrderDTOå¯¹è±¡
    â†“
è°ƒç”¨ä¹‹å‰Workerçº¿ç¨‹<span class="hljs-number">2</span>ç•™ä¸‹çš„é’©å­
</code></pre>
<p><strong>ç¬¬8æ­¥ï¼šè¿”å›ç»™å®¢æˆ·ç«¯ï¼ˆWorkerçš„æ”¶å°¾å·¥ä½œï¼‰</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">Worker</span>çº¿ç¨‹<span class="hljs-number">2</span>ï¼ˆæˆ–è€…å…¶ä»–ç©ºé—²çš„<span class="hljs-title class_">Worker</span>ï¼‰è¢«å”¤é†’
    â†“
æ‹¿åˆ°æœ€ç»ˆçš„<span class="hljs-title class_">OrderDTO</span>å¯¹è±¡
    â†“
åºåˆ—åŒ–æˆ<span class="hljs-title class_">JSON</span>
    â†“
é€šè¿‡åŸæ¥çš„<span class="hljs-title class_">SocketChannel</span>å‘é€<span class="hljs-variable constant_">HTTP</span>å“åº”
    â†“
æ³¨æ„ï¼šç›´æ¥å‘é€ï¼Œä¸ç»è¿‡<span class="hljs-title class_">Boss</span>
</code></pre>
<p><strong>Bossåªç®¡æ¥æ”¶æ–°è¿æ¥ï¼Œå“åº”ç”±Workerç›´æ¥å‘é€ã€‚</strong></p>
<h3 data-id="heading-17">æ—¶é—´çº¿å¯¹æ¯”</h3>
<p><strong>ä¼ ç»ŸServletæ¨¡å¼</strong>ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">T0: è¯·æ±‚åˆ°è¾¾ï¼Œåˆ†é…çº¿ç¨‹A</span>
<span class="hljs-section">T100ms: çº¿ç¨‹Aè°ƒç”¨ç”¨æˆ·æœåŠ¡ï¼Œé˜»å¡ç­‰å¾…</span>
<span class="hljs-section">T200ms: æ”¶åˆ°ç”¨æˆ·æœåŠ¡å“åº”</span>
<span class="hljs-section">T200ms: çº¿ç¨‹Aè°ƒç”¨è®¢å•æœåŠ¡ï¼Œé˜»å¡ç­‰å¾…</span>
<span class="hljs-section">T300ms: æ”¶åˆ°è®¢å•æœåŠ¡å“åº”</span>
<span class="hljs-section">T300ms: çº¿ç¨‹Aè¿”å›ç»“æœ</span>
æ€»è€—æ—¶ï¼š300ms
çº¿ç¨‹Aåˆ©ç”¨ç‡ï¼š33%ï¼ˆ100mså®é™…å·¥ä½œï¼Œ200msç­‰å¾…ï¼‰
</code></pre>
<p><strong>WebFluxæ¨¡å¼</strong>ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">T0: è¯·æ±‚åˆ°è¾¾ï¼ŒWorkerçº¿ç¨‹2å¤„ç†</span>
<span class="hljs-section">T0: Workerçº¿ç¨‹2æ´¾å‘ä»»åŠ¡ç»™Clientçº¿ç¨‹5</span>
<span class="hljs-section">T0: Workerçº¿ç¨‹2å»å¤„ç†å…¶ä»–è¯·æ±‚äº†</span>
<span class="hljs-section">T50ms: Clientçº¿ç¨‹5åŒæ—¶å‘èµ·ç”¨æˆ·å’Œè®¢å•æœåŠ¡è°ƒç”¨</span>
<span class="hljs-section">T100ms: ä¸¤ä¸ªæœåŠ¡åŒæ—¶è¿”å›</span>
<span class="hljs-section">T100ms: Clientçº¿ç¨‹è§¦å‘å›è°ƒï¼Œæ±‡æ€»ç»“æœ</span>
<span class="hljs-section">T100ms: é€šçŸ¥Workerçº¿ç¨‹ï¼ˆå¯èƒ½æ˜¯çº¿ç¨‹3ï¼‰å‘é€å“åº”</span>
æ€»è€—æ—¶ï¼š100ms
Workerçº¿ç¨‹åˆ©ç”¨ç‡ï¼šæ¥è¿‘100%
</code></pre>
<p><strong>æ€§èƒ½å·®è·ï¼š3å€ã€‚</strong></p>
<p>è€Œä¸”WebFluxçš„Workerçº¿ç¨‹å¯ä»¥åŒæ—¶å¤„ç†æˆç™¾ä¸Šåƒä¸ªè¯·æ±‚ï¼ŒServletçš„çº¿ç¨‹åœ¨é˜»å¡ç­‰å¾…ã€‚</p>
<h2 data-id="heading-18">ç¬¬äº”å±‚ï¼šå…¬å¸é¡¹ç›®çš„å®Œæ•´ç±»æ¯”</h2>
<p>ç”¨ä¸€ä¸ªæ›´å®Œæ•´çš„ç±»æ¯”æ¥ç†è§£æ•´ä¸ªæµç¨‹ã€‚</p>
<h3 data-id="heading-19">è§’è‰²å®šä¹‰</h3>






























<table><thead><tr><th>WebFluxç»„ä»¶</th><th>å…¬å¸è§’è‰²</th><th>èŒè´£</th></tr></thead><tbody><tr><td>Server Boss</td><td>å…¬å¸è€æ¿</td><td>ç­¾çº¦æ–°å®¢æˆ·ï¼ˆæ¥æ”¶TCPè¿æ¥ï¼‰</td></tr><tr><td>Server Worker</td><td>é¡¹ç›®ç»ç†</td><td>ç®¡ç†é¡¹ç›®ã€åè°ƒèµ„æº</td></tr><tr><td>Client EventLoop</td><td>å¤–åŒ…å¼€å‘å›¢é˜Ÿ</td><td>å¹²å…·ä½“çš„æ´»ï¼ˆè°ƒç”¨å¤–éƒ¨APIï¼‰</td></tr><tr><td>Reactorå›è°ƒ</td><td>é¡¹ç›®é’©å­/é‡Œç¨‹ç¢‘</td><td>é€šçŸ¥æœºåˆ¶</td></tr></tbody></table>
<h3 data-id="heading-20">å·¥ä½œæµç¨‹</h3>
<p><strong>åœºæ™¯</strong>ï¼šå®¢æˆ·è¦æ±‚åšä¸€ä¸ªé¡¹ç›®ï¼Œéœ€è¦å¤–åŒ…éƒ¨åˆ†å·¥ä½œã€‚</p>
<p><strong>ç¬¬1æ­¥ï¼šè€æ¿æ¥é¡¹ç›®</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">å®¢æˆ·ä¸Šé—¨
<span class="hljs-code">    â†“
è€æ¿æ¥å¾…ï¼ˆBossçº¿ç¨‹acceptè¿æ¥ï¼‰
    â†“
ç­¾è®¢åˆåŒ
    â†“
åˆ†é…ç»™é¡¹ç›®ç»ç†å¼ ä¸‰ï¼ˆWorkerçº¿ç¨‹2ï¼‰
    â†“
è€æ¿ç»§ç»­æ¥å¾…å…¶ä»–å®¢æˆ·
</span></code></pre>
<p>è€æ¿åªè´Ÿè´£æ‹‰ä¸šåŠ¡ï¼Œä¸ç®¡å…·ä½“æ‰§è¡Œã€‚</p>
<p><strong>ç¬¬2æ­¥ï¼šé¡¹ç›®ç»ç†å¯åŠ¨é¡¹ç›®</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">å¼ ä¸‰æ¥æ‰‹é¡¹ç›®
    â†“
æŸ¥çœ‹éœ€æ±‚æ–‡æ¡£ï¼ˆè§£æHTTPè¯·æ±‚ï¼‰
    â†“
å‘ç°éœ€è¦ç”¨æˆ·æ•°æ®ï¼Œè¿™éƒ¨åˆ†è¦å¤–åŒ…
    â†“
è”ç³»å¤–åŒ…å›¢é˜Ÿæå››ï¼ˆ<span class="hljs-built_in">Client</span>çº¿ç¨‹<span class="hljs-number">5</span>ï¼‰
    â†“
åœ¨é¡¹ç›®ç®¡ç†ç³»ç»Ÿè®¾ç½®é‡Œç¨‹ç¢‘ï¼šç”¨æˆ·æ•°æ®å®Œæˆåé€šçŸ¥æˆ‘
    â†“
å¼ ä¸‰ç»§ç»­å»ç®¡ç†å…¶ä»–é¡¹ç›®ï¼Œä¸å¹²ç­‰
</code></pre>
<p><strong>å…³é”®ï¼šå¼ ä¸‰ä¸ç­‰å¤–åŒ…å®Œæˆï¼Œä»–å»å¿™åˆ«çš„äº†ã€‚</strong></p>
<p><strong>ç¬¬3æ­¥ï¼šå¤–åŒ…å›¢é˜Ÿå¹²æ´»</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">æå››æ¥åˆ°ä»»åŠ¡
<span class="hljs-code">    â†“
å»ç”¨æˆ·æœåŠ¡APIæ‹‰æ•°æ®
    â†“
ä¸é˜»å¡ç­‰å¾…ï¼ŒåŒæ—¶å¯ä»¥æ¥å…¶ä»–ä»»åŠ¡
    â†“
ç”¨æˆ·æœåŠ¡è¿”å›æ•°æ®
    â†“
æå››æ‹¿åˆ°æ•°æ®ï¼Œè§¦å‘é‡Œç¨‹ç¢‘
    â†“
é€šçŸ¥å¼ ä¸‰ï¼šç”¨æˆ·æ•°æ®å¥½äº†
</span></code></pre>
<p><strong>ç¬¬4æ­¥ï¼šé¡¹ç›®ç»ç†ç»§ç»­æ¨è¿›</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">å¼ ä¸‰æ”¶åˆ°é€šçŸ¥
    â†“
æ‹¿åˆ°ç”¨æˆ·æ•°æ®ï¼ŒæŸ¥çœ‹è®¢å•ID
    â†“
åˆéœ€è¦è®¢å•æ•°æ®ï¼Œå†æ¬¡å¤–åŒ…
    â†“
è”ç³»å¤–åŒ…å›¢é˜Ÿç‹äº”ï¼ˆ<span class="hljs-built_in">Client</span>çº¿ç¨‹<span class="hljs-number">6</span>ï¼‰
    â†“
è®¾ç½®æ–°çš„é‡Œç¨‹ç¢‘ï¼šè®¢å•æ•°æ®å®Œæˆåé€šçŸ¥æˆ‘
    â†“
å¼ ä¸‰åˆå»å¹²åˆ«çš„äº†
</code></pre>
<p><strong>ç¬¬5æ­¥ï¼šå†æ¬¡å¤–åŒ…</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">ç‹äº”æ¥åˆ°ä»»åŠ¡
<span class="hljs-code">    â†“
å»è®¢å•æœåŠ¡APIæ‹‰æ•°æ®
    â†“
è®¢å•æœåŠ¡è¿”å›æ•°æ®
    â†“
è§¦å‘é‡Œç¨‹ç¢‘ï¼Œé€šçŸ¥å¼ ä¸‰
</span></code></pre>
<p><strong>ç¬¬6æ­¥ï¼šé¡¹ç›®æ”¶å°¾</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">å¼ ä¸‰æ”¶åˆ°è®¢å•æ•°æ®
<span class="hljs-code">    â†“
æ±‡æ€»ç”¨æˆ·æ•°æ®å’Œè®¢å•æ•°æ®
    â†“
ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š
    â†“
ç›´æ¥äº¤ä»˜ç»™å®¢æˆ·ï¼ˆå‘é€HTTPå“åº”ï¼‰
    â†“
ä¸éœ€è¦å†æ‰¾è€æ¿å®¡æ‰¹
</span></code></pre>
<p><strong>è€æ¿åªç®¡æ¥é¡¹ç›®ï¼Œäº¤ä»˜ç”±é¡¹ç›®ç»ç†å®Œæˆã€‚</strong></p>
<h3 data-id="heading-21">å…³é”®ç‚¹æ€»ç»“</h3>
<ol>
<li>
<p><strong>è€æ¿ï¼ˆBossï¼‰åªæ¥æ´»ï¼Œä¸å¹²æ´»</strong></p>
<ul>
<li>Bossçº¿ç¨‹åªè´Ÿè´£acceptè¿æ¥</li>
<li>ç«‹å³åˆ†é…ç»™Workerï¼Œè‡ªå·±ç»§ç»­æ¥æ–°è¿æ¥</li>
</ul>
</li>
<li>
<p><strong>é¡¹ç›®ç»ç†ï¼ˆWorkerï¼‰ä¸å‚»ç­‰</strong></p>
<ul>
<li>é‡åˆ°éœ€è¦å¤–éƒ¨èµ„æºçš„åœ°æ–¹ï¼Œç«‹å³å¤–åŒ…</li>
<li>ç•™ä¸‹"é’©å­"ï¼ˆå›è°ƒï¼‰ï¼Œå»ç®¡ç†å…¶ä»–é¡¹ç›®</li>
<li>ä¸€ä¸ªé¡¹ç›®ç»ç†å¯ä»¥åŒæ—¶ç®¡ç†å‡ ç™¾ä¸ªé¡¹ç›®</li>
</ul>
</li>
<li>
<p><strong>å¤–åŒ…å›¢é˜Ÿï¼ˆClient EventLoopï¼‰å¹¶å‘å¹²æ´»</strong></p>
<ul>
<li>åŒæ—¶å¯ä»¥å¤„ç†å¤šä¸ªå¤–åŒ…ä»»åŠ¡</li>
<li>ä¸é˜»å¡ï¼Œç”¨äº‹ä»¶é©±åŠ¨</li>
<li>å¹²å®Œäº†è§¦å‘é’©å­é€šçŸ¥é¡¹ç›®ç»ç†</li>
</ul>
</li>
<li>
<p><strong>äº¤ä»˜ä¸ç»è¿‡è€æ¿</strong></p>
<ul>
<li>é¡¹ç›®å®Œæˆåï¼Œé¡¹ç›®ç»ç†ç›´æ¥äº¤ä»˜</li>
<li>Bossä¸å‚ä¸é¡¹ç›®æ‰§è¡Œå’Œäº¤ä»˜</li>
</ul>
</li>
</ol>
<h3 data-id="heading-22">ä¸ºä»€ä¹ˆè¿™ä¹ˆé«˜æ•ˆï¼Ÿ</h3>
<p><strong>ä¼ ç»ŸServletæ¨¡å¼ï¼ˆæ¯ä¸ªé¡¹ç›®é…ä¸€ä¸ªä¸“èŒç»ç†ï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">100ä¸ªé¡¹ç›®åŒæ—¶è¿›è¡Œ
<span class="hljs-code">    â†“
éœ€è¦100ä¸ªé¡¹ç›®ç»ç†
    â†“
æ¯ä¸ªç»ç†åªç›¯è‡ªå·±çš„é¡¹ç›®
    â†“
å¤§éƒ¨åˆ†æ—¶é—´åœ¨ç­‰å¤–åŒ…å®Œæˆï¼ˆé˜»å¡ï¼‰
    â†“
äººåŠ›æµªè´¹ä¸¥é‡
</span></code></pre>
<p><strong>WebFluxæ¨¡å¼ï¼ˆå°‘æ•°ç»ç†ç®¡ç†å¤§é‡é¡¹ç›®ï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">100ä¸ªé¡¹ç›®åŒæ—¶è¿›è¡Œ
<span class="hljs-code">    â†“
åªéœ€è¦4ä¸ªé¡¹ç›®ç»ç†
    â†“
æ¯ä¸ªç»ç†åŒæ—¶ç®¡ç†25ä¸ªé¡¹ç›®
    â†“
åˆ©ç”¨ç­‰å¾…æ—¶é—´å¤„ç†å…¶ä»–é¡¹ç›®
    â†“
äººåŠ›åˆ©ç”¨ç‡æ¥è¿‘100%
</span></code></pre>
<h2 data-id="heading-23">ç¬¬å…­å±‚ï¼šä¸ºä»€ä¹ˆå¿…é¡»å…¨é“¾è·¯å“åº”å¼</h2>
<p>æœ‰äº›å¼€å‘ä¼šè¿™ä¹ˆå†™ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@GetMapping("/user")</span>
<span class="hljs-keyword">public</span> Mono&lt;User&gt; <span class="hljs-title function_">getUser</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// ç”¨äº†Monoï¼Œä½†è¿˜æ˜¯é˜»å¡æ“ä½œ</span>
    <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> jdbcTemplate.queryForObject(
        <span class="hljs-string">"SELECT * FROM users WHERE id = 1"</span>,
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">BeanPropertyRowMapper</span>&lt;&gt;(User.class)
    );
    <span class="hljs-keyword">return</span> Mono.just(user);
}
</code></pre>
<p>è¡¨é¢ä¸Šè¿”å›äº†<code>Mono</code>ï¼Œå®é™…ä¸Šè¿˜æ˜¯é˜»å¡çš„ã€‚</p>
<h3 data-id="heading-24">ä¼šå‘ç”Ÿä»€ä¹ˆ</h3>
<pre><code class="hljs language-scss" lang="scss">Workerçº¿ç¨‹<span class="hljs-number">2</span>æ‰§è¡Œè¿™ä¸ªæ–¹æ³•
    â†“
æ‰§è¡ŒjdbcTemplate<span class="hljs-selector-class">.queryForObject</span>()
    â†“
è¿™æ˜¯JDBCï¼Œä¼šé˜»å¡ç­‰å¾…æ•°æ®åº“è¿”å›ï¼ˆå¯èƒ½<span class="hljs-number">50ms</span>ï¼‰
    â†“
Workerçº¿ç¨‹<span class="hljs-number">2</span>è¢«é˜»å¡ï¼Œå•¥ä¹Ÿå¹²ä¸äº†
    â†“
<span class="hljs-number">50ms</span>åæ•°æ®åº“è¿”å›
    â†“
åŒ…è£…æˆMono<span class="hljs-selector-class">.just</span>(user)è¿”å›
</code></pre>
<p><strong>çº¿ç¨‹2è¢«é˜»å¡äº†50msï¼</strong></p>
<p>å‡è®¾åªæœ‰4ä¸ªWorkerçº¿ç¨‹ï¼Œå¦‚æœåŒæ—¶æ¥4ä¸ªè¿™æ ·çš„è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">4ä¸ªWorkerçº¿ç¨‹å…¨éƒ¨é˜»å¡
    â†“
ç¬¬5ä¸ªè¯·æ±‚è¿›æ¥ï¼Œæ²¡æœ‰ç©ºé—²çº¿ç¨‹
    â†“
è¯·æ±‚æ’é˜Ÿç­‰å¾…
    â†“
<span class="hljs-attr">QPS</span> = <span class="hljs-number">4</span>ä¸ªçº¿ç¨‹ / <span class="hljs-number">0.05</span>ç§’ = <span class="hljs-number">80</span>
</code></pre>
<p><strong>è¿˜ä¸å¦‚Tomcatçš„200ä¸ªçº¿ç¨‹ï¼</strong></p>
<h3 data-id="heading-25">æ­£ç¡®çš„åšæ³•</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@GetMapping("/user")</span>
<span class="hljs-keyword">public</span> Mono&lt;User&gt; <span class="hljs-title function_">getUser</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// ä½¿ç”¨R2DBCï¼ŒçœŸæ­£çš„å“åº”å¼æ•°æ®åº“é©±åŠ¨</span>
    <span class="hljs-keyword">return</span> r2dbcTemplate
        .select(User.class)
        .matching(query(where(<span class="hljs-string">"id"</span>).is(<span class="hljs-number">1</span>)))
        .one();
}
</code></pre>
<p>è¿™æ ·Workerçº¿ç¨‹ä¸ä¼šé˜»å¡ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">Workerçº¿ç¨‹<span class="hljs-number">2</span>æ‰§è¡Œè¿™ä¸ªæ–¹æ³•
    â†“
è°ƒç”¨r2dbcTemplate.select()
    â†“
é€šè¿‡R2DBCå‘èµ·å¼‚æ­¥æŸ¥è¯¢ï¼ˆç±»ä¼¼WebClientï¼‰
    â†“
ç«‹å³è¿”å›Mono<span class="hljs-operator">&lt;</span><span class="hljs-keyword">User</span><span class="hljs-operator">&gt;</span>ï¼ˆè¿˜æ²¡æœ‰æ•°æ®ï¼‰
    â†“
Workerçº¿ç¨‹<span class="hljs-number">2</span>å»å¤„ç†å…¶ä»–è¯·æ±‚
    â†“
æ•°æ®åº“è¿”å›æ•°æ®æ—¶ï¼Œè§¦å‘å›è°ƒ
    â†“
Monoå‘å‡º<span class="hljs-keyword">User</span>å¯¹è±¡
</code></pre>
<h3 data-id="heading-26">å“åº”å¼æŠ€æœ¯æ ˆå¯¹ç…§</h3>



































<table><thead><tr><th>åœºæ™¯</th><th>é˜»å¡æ–¹å¼</th><th>å“åº”å¼æ–¹å¼</th></tr></thead><tbody><tr><td>HTTPå®¢æˆ·ç«¯</td><td>RestTemplate</td><td>WebClient</td></tr><tr><td>æ•°æ®åº“</td><td>JDBC (JdbcTemplate)</td><td>R2DBC</td></tr><tr><td>Redis</td><td>Jedis (åŒæ­¥)</td><td>Lettuce Reactive</td></tr><tr><td>MongoDB</td><td>MongoTemplate</td><td>ReactiveMongoTemplate</td></tr><tr><td>Kafka</td><td>KafkaTemplate</td><td>ReactiveKafkaTemplate</td></tr></tbody></table>
<p><strong>ä»»ä½•ä¸€ä¸ªç¯èŠ‚ç”¨é˜»å¡APIï¼Œæ•´ä¸ªé“¾è·¯çš„å“åº”å¼ä¼˜åŠ¿éƒ½ä¼šä¸§å¤±ã€‚</strong></p>
<h2 data-id="heading-27">ç¬¬ä¸ƒå±‚ï¼šæ€§èƒ½æ•°æ®å¯¹æ¯”</h2>
<h3 data-id="heading-28">æµ‹è¯•åœºæ™¯</h3>
<p>æ¨¡æ‹Ÿç½‘å…³åœºæ™¯ï¼šæ¯ä¸ªè¯·æ±‚éœ€è¦è°ƒç”¨3ä¸ªåç«¯æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡è€—æ—¶100msã€‚</p>
<p><strong>ç¯å¢ƒ</strong>ï¼š</p>
<ul>
<li>æœºå™¨ï¼š4æ ¸CPUã€8GBå†…å­˜</li>
<li>å¹¶å‘è¯·æ±‚ï¼š1000</li>
</ul>
<h3 data-id="heading-29">Spring MVC + Tomcat</h3>
<pre><code class="hljs language-diff" lang="diff">é…ç½®ï¼š
<span class="hljs-deletion">- Tomcatçº¿ç¨‹æ± ï¼š200</span>
<span class="hljs-deletion">- æ¯ä¸ªè¯·æ±‚è€—æ—¶ï¼š100ms + 100ms + 100ms = 300msï¼ˆä¸²è¡Œï¼‰</span>

ç»“æœï¼š
<span class="hljs-deletion">- QPSï¼š666ï¼ˆ200çº¿ç¨‹ / 0.3ç§’ï¼‰</span>
<span class="hljs-deletion">- å¹³å‡å“åº”æ—¶é—´ï¼š1500ms</span>
<span class="hljs-deletion">- P99å“åº”æ—¶é—´ï¼š3000ms</span>
<span class="hljs-deletion">- CPUä½¿ç”¨ç‡ï¼š85%</span>
<span class="hljs-deletion">- å†…å­˜å ç”¨ï¼š1.2GBï¼ˆ200ä¸ªçº¿ç¨‹æ ˆï¼‰</span>
</code></pre>
<h3 data-id="heading-30">Spring WebFlux + Netty</h3>
<pre><code class="hljs language-diff" lang="diff">é…ç½®ï¼š
<span class="hljs-deletion">- Server Workerçº¿ç¨‹ï¼š4</span>
<span class="hljs-deletion">- Client EventLoopçº¿ç¨‹ï¼š4</span>
<span class="hljs-deletion">- æ¯ä¸ªè¯·æ±‚è€—æ—¶ï¼šmax(100ms, 100ms, 100ms) = 100msï¼ˆå¹¶å‘ï¼‰</span>

ç»“æœï¼š
<span class="hljs-deletion">- QPSï¼š10000+</span>
<span class="hljs-deletion">- å¹³å‡å“åº”æ—¶é—´ï¼š120ms</span>
<span class="hljs-deletion">- P99å“åº”æ—¶é—´ï¼š200ms</span>
<span class="hljs-deletion">- CPUä½¿ç”¨ç‡ï¼š60%</span>
<span class="hljs-deletion">- å†…å­˜å ç”¨ï¼š512MB</span>
</code></pre>
<h3 data-id="heading-31">æ€§èƒ½å·®è·</h3>



































<table><thead><tr><th>æŒ‡æ ‡</th><th>Spring MVC</th><th>WebFlux</th><th>æå‡</th></tr></thead><tbody><tr><td>QPS</td><td>666</td><td>10000</td><td><strong>15å€</strong></td></tr><tr><td>å“åº”æ—¶é—´</td><td>1500ms</td><td>120ms</td><td><strong>12å€</strong></td></tr><tr><td>å†…å­˜</td><td>1.2GB</td><td>512MB</td><td><strong>å‡å°‘60%</strong></td></tr><tr><td>çº¿ç¨‹æ•°</td><td>200</td><td>8</td><td><strong>å‡å°‘96%</strong></td></tr></tbody></table>
<p><strong>ä¸ºä»€ä¹ˆå·®è·è¿™ä¹ˆå¤§ï¼Ÿ</strong></p>
<ol>
<li><strong>å¤–éƒ¨è°ƒç”¨å¹¶å‘æ‰§è¡Œ</strong>ï¼šWebFluxå¯ä»¥åŒæ—¶å‘èµ·3ä¸ªè¯·æ±‚ï¼ŒMVCå¿…é¡»ä¸²è¡Œ</li>
<li><strong>çº¿ç¨‹ä¸é˜»å¡</strong>ï¼šWebFluxçš„8ä¸ªçº¿ç¨‹æ°¸è¿œåœ¨å·¥ä½œï¼ŒMVCçš„200ä¸ªçº¿ç¨‹å¤§éƒ¨åˆ†åœ¨ç­‰å¾…</li>
<li><strong>å†…å­˜å ç”¨å°</strong>ï¼šå°‘é‡çº¿ç¨‹æ„å‘³ç€æ›´å°‘çš„æ ˆç©ºé—´</li>
</ol>
<h2 data-id="heading-32">ç¬¬å…«å±‚ï¼šåº•å±‚æŠ€æœ¯åŸç†</h2>
<p>WebFluxçš„æ€§èƒ½æ¥è‡ªåº•å±‚æŠ€æœ¯çš„å±‚å±‚æ”¯æ’‘ã€‚</p>
<h3 data-id="heading-33">Linuxçš„epoll</h3>
<p>è¿™æ˜¯ä¸€åˆ‡çš„åŸºç¡€ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// åˆ›å»ºepollå®ä¾‹</span>
<span class="hljs-type">int</span> epoll_fd = epoll_create(<span class="hljs-number">1024</span>);

<span class="hljs-comment">// æ³¨å†Œå¤šä¸ªsocket</span>
epoll_ctl(epoll_fd, EPOLL_CTL_ADD, socket1, &amp;event1);
epoll_ctl(epoll_fd, EPOLL_CTL_ADD, socket2, &amp;event2);
<span class="hljs-comment">// ... æ³¨å†Œ1000ä¸ªsocket</span>

<span class="hljs-comment">// ç­‰å¾…äº‹ä»¶</span>
<span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {
    <span class="hljs-type">int</span> n = epoll_wait(epoll_fd, events, <span class="hljs-number">1024</span>, <span class="hljs-number">-1</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {
        <span class="hljs-comment">// å¤„ç†æœ‰æ•°æ®çš„socket</span>
        handle_event(events[i]);
    }
}
</code></pre>
<p><strong>å…³é”®</strong>ï¼šä¸€ä¸ªçº¿ç¨‹å¯ä»¥ç›‘å¬1000ä¸ªsocketï¼Œå“ªä¸ªæœ‰æ•°æ®å°±å¤„ç†å“ªä¸ªã€‚</p>
<p>ä¼ ç»Ÿé˜»å¡I/Oéœ€è¦1000ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹ç›¯ä¸€ä¸ªsocketã€‚</p>
<h3 data-id="heading-34">Java NIOçš„Selector</h3>
<p>JavaæŠŠepollå°è£…æˆäº†Selectorï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Selector</span> <span class="hljs-variable">selector</span> <span class="hljs-operator">=</span> Selector.open();

<span class="hljs-comment">// æ³¨å†Œå¤šä¸ªChannel</span>
channel1.register(selector, SelectionKey.OP_READ);
channel2.register(selector, SelectionKey.OP_READ);
<span class="hljs-comment">// ... æ³¨å†Œæ›´å¤š</span>

<span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
    selector.select();  <span class="hljs-comment">// ç­‰å¾…äº‹ä»¶ï¼Œåº•å±‚è°ƒç”¨epoll_wait</span>
    
    Set&lt;SelectionKey&gt; keys = selector.selectedKeys();
    <span class="hljs-keyword">for</span> (SelectionKey key : keys) {
        <span class="hljs-keyword">if</span> (key.isReadable()) {
            <span class="hljs-comment">// æœ‰æ•°æ®å¯è¯»</span>
            <span class="hljs-type">SocketChannel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> (SocketChannel) key.channel();
            <span class="hljs-type">ByteBuffer</span> <span class="hljs-variable">buffer</span> <span class="hljs-operator">=</span> ByteBuffer.allocate(<span class="hljs-number">1024</span>);
            channel.read(buffer);
        }
    }
}
</code></pre>
<h3 data-id="heading-35">Nettyçš„EventLoop</h3>
<p>NettyæŠŠSelectorå°è£…æˆäº†EventLoopï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// EventLoop = ä¸€ä¸ªçº¿ç¨‹ + ä¸€ä¸ªSelector + ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—</span>
<span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">group</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">4</span>);

<span class="hljs-comment">// 4ä¸ªEventLoopï¼Œæ¯ä¸ªéƒ½æ˜¯ï¼š</span>
<span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
    selector.select(timeout);  <span class="hljs-comment">// ç­‰å¾…I/Oäº‹ä»¶</span>
    processSelectedKeys();     <span class="hljs-comment">// å¤„ç†I/O</span>
    runAllTasks();            <span class="hljs-comment">// æ‰§è¡Œä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡</span>
}
</code></pre>
<p><strong>EventLoopåšä¸‰ä»¶äº‹</strong>ï¼š</p>
<ol>
<li>ç­‰å¾…I/Oäº‹ä»¶ï¼ˆé€šè¿‡Selectorï¼‰</li>
<li>å¤„ç†I/Oäº‹ä»¶ï¼ˆè¯»å†™æ•°æ®ï¼‰</li>
<li>æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰</li>
</ol>
<h3 data-id="heading-36">Reactorçš„å¼‚æ­¥ç¼–æ’</h3>
<p>ReactoræŠŠå›è°ƒåœ°ç‹±å˜æˆäº†é“¾å¼è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å›è°ƒåœ°ç‹±</span>
webClient.get(<span class="hljs-string">"/user/1"</span>, user -&gt; {
    webClient.get(<span class="hljs-string">"/order/"</span> + user.getOrderId(), order -&gt; {
        webClient.get(<span class="hljs-string">"/product/"</span> + order.getProductId(), product -&gt; {
            <span class="hljs-comment">// ä¸‰å±‚åµŒå¥—</span>
            <span class="hljs-keyword">return</span> result;
        });
    });
});

<span class="hljs-comment">// Reactoré“¾å¼è°ƒç”¨</span>
webClient.get(<span class="hljs-string">"/user/1"</span>)
    .flatMap(user -&gt; webClient.get(<span class="hljs-string">"/order/"</span> + user.getOrderId()))
    .flatMap(order -&gt; webClient.get(<span class="hljs-string">"/product/"</span> + order.getProductId()));
</code></pre>
<p>ä»£ç æ›´æ¸…æ™°ï¼Œä½†æœ¬è´¨éƒ½æ˜¯å¼‚æ­¥å›è°ƒã€‚</p>
<h2 data-id="heading-37">ç¬¬ä¹å±‚ï¼šé€‚ç”¨åœºæ™¯åˆ†æ</h2>
<h3 data-id="heading-38">é€‚åˆç”¨WebFlux</h3>
<p><strong>ç½‘å…³ç³»ç»Ÿ</strong>ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">Gatewayçš„æ ¸å¿ƒå·¥ä½œï¼š
<span class="hljs-deletion">- æ¥æ”¶è¯·æ±‚ï¼ˆI/Oï¼‰</span>
<span class="hljs-deletion">- è·¯ç”±ï¼ˆCPUæå°‘ï¼‰</span>
<span class="hljs-deletion">- è°ƒç”¨åç«¯ï¼ˆI/Oï¼‰</span>
<span class="hljs-deletion">- èšåˆå“åº”ï¼ˆCPUæå°‘ï¼‰</span>
<span class="hljs-deletion">- è¿”å›ï¼ˆI/Oï¼‰</span>

95%éƒ½æ˜¯I/Oç­‰å¾…ï¼ŒWebFluxå®Œç¾åŒ¹é…
</code></pre>
<p><strong>å¾®æœåŠ¡èšåˆå±‚</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">ä¸€ä¸ªè¯·æ±‚è°ƒç”¨<span class="hljs-number">5</span>-<span class="hljs-number">10</span>ä¸ªå¾®æœåŠ¡
    â†“
WebFluxå¯ä»¥å¹¶å‘è°ƒç”¨
    â†“
å“åº”æ—¶é—´ = <span class="hljs-built_in">max</span>(æœåŠ¡è€—æ—¶)ï¼Œä¸æ˜¯<span class="hljs-built_in">sum</span>(æœåŠ¡è€—æ—¶)
</code></pre>
<p><strong>å®æ—¶é€šä¿¡</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">WebSocketé•¿è¿æ¥
<span class="hljs-code">    â†“
1ä¸‡ä¸ªè¿æ¥ = 1ä¸‡ä¸ªç”¨æˆ·åœ¨çº¿
    â†“
WebFluxåªéœ€8ä¸ªçº¿ç¨‹
    â†“
Tomcatéœ€è¦1ä¸‡ä¸ªçº¿ç¨‹ï¼ˆæ ¹æœ¬ä¸ç°å®ï¼‰
</span></code></pre>
<h3 data-id="heading-39">ä¸é€‚åˆç”¨WebFlux</h3>
<p><strong>ç®€å•CRUDåº”ç”¨</strong>ï¼š</p>
<pre><code class="hljs language-rust" lang="rust">è¯»æ•°æ®åº“ <span class="hljs-punctuation">-&gt;</span> è¿”å›
å†™æ•°æ®åº“ <span class="hljs-punctuation">-&gt;</span> è¿”å›

å¹¶å‘ä¸é«˜ï¼ˆQPS &lt; <span class="hljs-number">1000</span>ï¼‰
å“åº”å¼ä¼˜åŠ¿ä½“ç°ä¸å‡ºæ¥
åè€Œå¢åŠ ä»£ç å¤æ‚åº¦
</code></pre>
<p><strong>CPUå¯†é›†å‹ä»»åŠ¡</strong>ï¼š</p>
<pre><code class="hljs language-css" lang="css">å›¾åƒå¤„ç†ã€ç®—æ³•è®¡ç®—ã€åŠ å¯†è§£å¯†

è¿™äº›ä»»åŠ¡çš„ç“¶é¢ˆæ˜¯CPUï¼Œä¸æ˜¯<span class="hljs-selector-tag">I</span>/O
å“åº”å¼æ— æ³•æå‡æ€§èƒ½
</code></pre>
<p><strong>å›¢é˜Ÿä¸ç†Ÿæ‚‰</strong>ï¼š</p>
<pre><code class="hljs">å“åº”å¼ç¼–ç¨‹å­¦ä¹ æ›²çº¿é™¡
è°ƒè¯•å›°éš¾
å¦‚æœå›¢é˜Ÿæ²¡ç»éªŒï¼Œåè€Œé™ä½å¼€å‘æ•ˆç‡
</code></pre>
<h2 data-id="heading-40">æ€»ç»“</h2>
<h3 data-id="heading-41">æ ¸å¿ƒè¦ç‚¹</h3>
<ol>
<li>
<p><strong>æ¶æ„ï¼šä¸€ä¸ªåŠNetty</strong></p>
<ul>
<li>Serverç«¯ï¼šå®Œæ•´çš„Boss-Worker</li>
<li>Clientç«¯ï¼šåªæœ‰EventLoopï¼Œæ²¡æœ‰Boss</li>
<li>Bossåªç®¡æ¥è¿æ¥ï¼ŒWorkerå¤„ç†ä¸šåŠ¡ï¼ŒClientè°ƒå¤–éƒ¨</li>
</ul>
</li>
<li>
<p><strong>å·¥ä½œåŸç†ï¼šäº‹ä»¶é©±åŠ¨</strong></p>
<ul>
<li>æ“ä½œç³»ç»Ÿçš„epollï¼šä¸€ä¸ªçº¿ç¨‹ç›‘å¬å¤šä¸ªè¿æ¥</li>
<li>Java NIOçš„Selectorï¼šå°è£…epoll</li>
<li>Nettyçš„EventLoopï¼šäº‹ä»¶å¾ªç¯ + ä»»åŠ¡é˜Ÿåˆ—</li>
<li>Reactorçš„APIï¼šä¼˜é›…çš„å¼‚æ­¥ç¼–æ’</li>
</ul>
</li>
<li>
<p><strong>æ€§èƒ½å…³é”®ï¼šçº¿ç¨‹ä¸é˜»å¡</strong></p>
<ul>
<li>Workeræ´¾å‘ä»»åŠ¡åç«‹å³è¿”å›</li>
<li>Clientå¹¶å‘è°ƒç”¨å¤–éƒ¨æœåŠ¡</li>
<li>å°‘é‡çº¿ç¨‹å¤„ç†å¤§é‡å¹¶å‘</li>
<li>èµ„æºåˆ©ç”¨ç‡æ¥è¿‘100%</li>
</ul>
</li>
<li>
<p><strong>é€‚ç”¨åœºæ™¯ï¼šé«˜å¹¶å‘I/O</strong></p>
<ul>
<li>ç½‘å…³ç³»ç»Ÿ</li>
<li>å¾®æœåŠ¡èšåˆ</li>
<li>å®æ—¶é€šä¿¡</li>
<li>é«˜å¹¶å‘API</li>
</ul>
</li>
</ol>
<h3 data-id="heading-42">ä¸€å¥è¯æ€»ç»“</h3>
<p><strong>WebFluxç”¨ä¸€ä¸ªåŠNettyï¼ˆServerå®Œæ•´ + Clienté˜‰å‰²ï¼‰çš„æ¶æ„ï¼Œé€šè¿‡äº‹ä»¶é©±åŠ¨å’Œå¼‚æ­¥å›è°ƒï¼Œè®©å°‘é‡EventLoopçº¿ç¨‹å¤„ç†å¤§é‡å¹¶å‘I/Oï¼Œä»è€Œå®ç°åœ¨ç½‘å…³ç­‰I/Oå¯†é›†åœºæ™¯ä¸‹çš„é«˜æ€§èƒ½ã€‚</strong></p>
<h3 data-id="heading-43">å­¦ä¹ å»ºè®®</h3>
<p><strong>å¾ªåºæ¸è¿›</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> ç†è§£Java NIOï¼ˆSelectoråŸç†ï¼‰
<span class="hljs-bullet">2.</span> å­¦ä¹ Nettyï¼ˆEventLoopæ¨¡å‹ï¼‰
<span class="hljs-bullet">3.</span> æŒæ¡Reactorï¼ˆMono/Flux/æ“ä½œç¬¦ï¼‰
<span class="hljs-bullet">4.</span> å®æˆ˜WebFluxé¡¹ç›®
<span class="hljs-bullet">5.</span> æ€§èƒ½è°ƒä¼˜
</code></pre>
<p><strong>é¿å…è¯¯åŒº</strong>ï¼š</p>
<ul>
<li>ä¸æ˜¯æ‰€æœ‰é¡¹ç›®éƒ½è¦ç”¨WebFlux</li>
<li>ä¸æ˜¯åŠ ä¸ªMonoå°±æ˜¯å“åº”å¼</li>
<li>å¿…é¡»å…¨é“¾è·¯å“åº”å¼æ‰æœ‰æ•ˆæœ</li>
<li>è°ƒè¯•éš¾åº¦ç¡®å®æ¯”MVCé«˜</li>
</ul>
<p><strong>åˆç†é€‰å‹</strong>ï¼š</p>
<p>æ ¹æ®å®é™…åœºæ™¯å†³å®šï¼Œä¸è¦ä¸ºäº†æŠ€æœ¯è€ŒæŠ€æœ¯ã€‚ç®€å•çš„CRUDç”¨Spring MVCå°±å¤Ÿäº†ï¼ŒçœŸæ­£çš„é«˜å¹¶å‘åœºæ™¯æ‰è€ƒè™‘WebFluxã€‚</p>
<hr/>
<p><strong>å‚è€ƒèµ„æ–™</strong>ï¼š</p>
<ul>
<li>Spring WebFluxå®˜æ–¹æ–‡æ¡£</li>
<li>Project Reactoræ–‡æ¡£</li>
<li>Nettyæƒå¨æŒ‡å—</li>
<li>Spring Cloud Gatewayæºç </li>
<li>Apache ShenYuæ¶æ„è®¾è®¡</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è®°ä¸€æ¬¡å…¨è‡ªåŠ¨çš„é—®é¢˜è¯Šæ–­è¿‡ç¨‹]]></title>    <link>https://juejin.cn/post/7586865729703608358</link>    <guid>https://juejin.cn/post/7586865729703608358</guid>    <pubDate>2025-12-23T13:48:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586865729703608358" data-draft-id="7586865729703510054" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è®°ä¸€æ¬¡å…¨è‡ªåŠ¨çš„é—®é¢˜è¯Šæ–­è¿‡ç¨‹"/> <meta itemprop="keywords" content="Kubernetes,VibeCoding,DevOps"/> <meta itemprop="datePublished" content="2025-12-23T13:48:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº‘äº‘ä¼—ç”Ÿs"/> <meta itemprop="url" content="https://juejin.cn/user/380845430158739"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è®°ä¸€æ¬¡å…¨è‡ªåŠ¨çš„é—®é¢˜è¯Šæ–­è¿‡ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/380845430158739/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº‘äº‘ä¼—ç”Ÿs
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-23T13:48:33.000Z" title="Tue Dec 23 2025 13:48:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Vibe Coding æ–¹æ³•è®ºå·²åœ¨ä¼—å¤šé¡¹ç›®ä¸­å¤§æ”¾å¼‚å½©ï¼Œæˆ‘è‡ªå·±ä¹Ÿå¼€å‘äº†å‡ ä¸ªç›¸å…³å·¥å…·ã€‚ä¸è¿‡å½“æ¶‰åŠåˆ°è¿ç»´å·¥ä½œæ—¶ï¼Œé—®é¢˜çš„å¤æ‚æ€§å¾€å¾€ä¼šå¤§å¹…æå‡ã€‚å‰ä¸¤å¤©æˆ‘ç”¨ Antigravity æˆåŠŸè§£å†³äº†ä¸€ä¸ªç½‘ç»œè¯Šæ–­é—®é¢˜ï¼Œæ•´ä¸ªè¿‡ç¨‹éå¸¸é¡ºç•…ï¼Œç‰¹åˆ«æƒ³ä¸å¤§å®¶åˆ†äº«è¿™ä¸ªç»å†ã€‚</p>
<p>å›é¡¾ä»Šå¹´ï¼Œæœ€å¤§çš„æ”¶è·è«è¿‡äºç»ˆäºå®ç°äº†åŸºç¡€è®¾æ–½å³ä»£ç ï¼ˆInfrastructure as Codeï¼‰ã€‚æˆ‘ä½¿ç”¨ Pulumi æ¥ç®¡ç†æ•´ä¸ª AWS ç¯å¢ƒï¼Œè¿™å¸¦æ¥äº†æ˜¾è‘—çš„å¥½å¤„â€”â€”ç‰¹åˆ«æ˜¯å½“é—®é¢˜ç”±é…ç½®é”™è¯¯å¼•èµ·æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¿®æ­£è®°å½•åˆ°ä»£ç ä¸­ï¼Œä»è€Œé¿å…é‡å¤çŠ¯åŒæ ·çš„é”™è¯¯ã€‚ç„¶è€Œï¼Œå¯¹äºæ—¥å¸¸çš„é—®é¢˜è¯Šæ–­å·¥ä½œï¼ŒPulumi æœ¬èº«æ— æ³•ç›´æ¥æä¾›å¸®åŠ©ã€‚</p>
<h2 data-id="heading-0">è¯Šæ–­è¿‡ç¨‹</h2>
<p>å‰æ®µæ—¶é—´ï¼Œæœ‰äººæŠ¥å‘Šç§° Pulumi æ­å»ºçš„ EKS é›†ç¾¤å‡ºç°äº†é—®é¢˜ã€‚æˆ‘å°è¯•éƒ¨ç½²ä¸€ä¸ªæµ‹è¯• Podï¼Œå´é­é‡é•œåƒæ‹‰å–å¤±è´¥çš„é”™è¯¯ã€‚è€ƒè™‘åˆ°è¿™å¥—ç¯å¢ƒå·²ç»ä½¿ç”¨äº†å¤šæ¬¡ï¼Œæˆ‘å¯¹å…¶é…ç½®å¾ˆæœ‰ä¿¡å¿ƒï¼Œé—®é¢˜å¾ˆå¯èƒ½æ˜¯æœ‰äººæ‰‹åŠ¨ä¿®æ”¹äº†æŸäº›é…ç½®ã€‚æ—¢ç„¶è¦è¯Šæ–­çš„å¯¹è±¡æ˜¯ EKS å’Œ AWS çš„å„é¡¹é…ç½®ï¼Œè€Œè¿™äº›èµ„æºéƒ½å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œå·¥å…·è®¿é—®ï¼Œé‚£ä¹ˆè¿™ä¸ªä»»åŠ¡å®Œå…¨å¯ä»¥äº¤ç»™ AI ä»£ç†æ¥å¤„ç†ã€‚äºæ˜¯ï¼Œæˆ‘æ‰“å¼€äº† <code>Antigravity</code>ã€‚</p>
<p>æˆ‘æƒ³åˆ›å»ºä¸€ä¸ª <code>README.md</code> æ¥è¯¦ç»†æè¿°é—®é¢˜ï¼Œä½†æœ€ç»ˆåªéœ€è¦å†™ä¸‹è¿™ä¸¤è¡Œå…³é”®ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-md" lang="md">æˆ‘çš„æœºå™¨å·²ç»å®‰è£…äº† AWS CLI å’Œ kubectlã€‚

ä½¿ç”¨çš„ AWS Profile æ˜¯ prodã€‚
</code></pre>
<p>éšåæˆ‘å‘ <code>Antigravity</code> æé—®ï¼š</p>
<pre><code class="hljs language-md" lang="md">å‚è€ƒ README.md ç¯å¢ƒã€‚æˆ‘çš„ eks é›†ç¾¤
my-infra-eks1-cluster è®¿é—®ç½‘ç»œæœ‰é—®é¢˜ï¼Œä½ èƒ½å¸®æˆ‘è¯Šæ–­ä¸€ä¸‹å—ï¼Ÿ
</code></pre>
<p>è®©æˆ‘æƒŠå–œçš„æ˜¯ï¼Œ<code>Antigravity</code> éšå³æè®®æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">aws eks update-kubeconfig --name my-infra-eks1-cluster --profile prod; kubectl get nodes; kubectl get pods -A
</code></pre>
<p>è™½ç„¶å®ƒçš„å»ºè®®å¾ˆè´´å¿ƒâ€”â€”æƒ³ä¸ºæˆ‘ç”Ÿæˆ kubeconfig æ–‡ä»¶â€”â€”ä½†è¿™ä¸€æ­¥å…¶å®æ˜¯å¤šä½™çš„ï¼Œå› ä¸ºæˆ‘çš„é…ç½®æ–‡ä»¶æ—©å·²å°±ä½ã€‚æˆ‘å‘å®ƒè¯´æ˜äº†è¿™ä¸€ç‚¹ï¼Œå®ƒéšå³è°ƒæ•´äº†æ–¹æ¡ˆã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œ<code>Antigravity</code> è¿…é€Ÿå®šä½åˆ°äº† Pod å±‚é¢çš„é—®é¢˜ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">dial tcp 3.227.50.168:443: i/o <span class="hljs-built_in">timeout</span>
</code></pre>
<p>è¿™ä¸ªé”™è¯¯è¡¨æ˜ç½‘ç»œè¿æ¥å·²ç»è¶…æ—¶ã€‚ä¸ºäº†è¿›ä¸€æ­¥è¯Šæ–­ EKS çš„ç½‘ç»œé…ç½®ï¼Œå®ƒéšåæ‰§è¡Œäº†ï¼š</p>
<pre><code class="hljs language-md" lang="md">çœ‹èµ·æ¥ AWS CLI çš„è¾“å‡ºæœ‰é—®é¢˜ã€‚è®©æˆ‘æ¢ä¸€ç§æ–¹å¼æ£€æŸ¥ç½‘ç»œé…ç½®ï¼š

<span class="hljs-emphasis">*User accepted the command `$env:PAGER=''; aws eks describe-cluster --name my-infra-eks1-cluster --profile prod --query 'cluster.resourcesVpcConfig'`*</span>

<span class="hljs-emphasis">*Checked command status*</span>

<span class="hljs-emphasis">*User accepted the command `aws ec2 describe-subnets --subnet-ids subnet-022afbc288eec0c95 subnet-054c0ebc0fc6d50d9 --profile prod --output json | ConvertFrom-Json | Select-Object -ExpandProperty Subnets | Select-Object SubnetId, VpcId, CidrBlock, MapPublicIpOnLaunch, AvailabilityZone | Format-Table`*</span>

<span class="hljs-emphasis">*Checked command status*</span>
</code></pre>
<p>è¿›ä¸€æ­¥æ£€æŸ¥ç§æœ‰å­ç½‘çš„é…ç½®åï¼Œå®ƒå‘ç°äº†ä¸€ä¸ªå…³é”®ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-md" lang="md">å¾ˆå¥½ï¼æˆ‘çœ‹åˆ°èŠ‚ç‚¹åœ¨<span class="hljs-strong">**ç§æœ‰å­ç½‘**</span>ä¸­ï¼ˆ<span class="hljs-code">`MapPublicIpOnLaunch: False`</span>ï¼‰ï¼Œå¹¶ä¸”æ²¡æœ‰å¤–éƒ¨ IPã€‚ç°åœ¨è®©æˆ‘æ£€æŸ¥è¿™äº›å­ç½‘çš„è·¯ç”±è¡¨å’Œ NAT ç½‘å…³é…ç½®ï¼š

<span class="hljs-emphasis">*User accepted the command `aws ec2 describe-route-tables --filters "Name=association.subnet-id,Values=subnet-022afbc288eec0c95,subnet-054c0ebc0fc6d50d9" --profile prod --output json | ConvertFrom-Json | Select-Object -ExpandProperty RouteTables | ForEach-Object { $_.Routes } | Format-Table DestinationCidrBlock, GatewayId, NatGatewayId, State`*</span>
</code></pre>
<p>è·¯ç”±è¡¨æ£€æŸ¥å®Œæ¯•åï¼Œå®ƒç»§ç»­æ¢æŸ¥ NAT ç½‘å…³çš„å¥åº·çŠ¶å†µï¼š</p>
<pre><code class="hljs language-md" lang="md">å¥½çš„ï¼Œè·¯ç”±è¡¨çœ‹èµ·æ¥æ­£å¸¸ï¼Œå·²é…ç½® NAT ç½‘å…³ã€‚ç°åœ¨è®©æˆ‘æ£€æŸ¥è¿™ä¸ª NAT ç½‘å…³çš„çŠ¶æ€ï¼š

<span class="hljs-emphasis">*User accepted the command `aws ec2 describe-nat-gateways --nat-gateway-ids nat-0e773344c68bd5f76 --profile prod --output json | ConvertFrom-Json | Select-Object -ExpandProperty NatGateways | Select-Object NatGatewayId, State, SubnetId, VpcId | Format-Table`*</span>
</code></pre>
<pre><code class="hljs language-md" lang="md">NAT ç½‘å…³çŠ¶æ€ä¸º <span class="hljs-code">`available`</span>ï¼Œè¡¨é¢ä¸Šçœ‹æ­£å¸¸ã€‚è®©æˆ‘è¿›ä¸€æ­¥æ£€æŸ¥ NAT ç½‘å…³æ‰€åœ¨çš„å…¬æœ‰å­ç½‘åŠå…¶å…³è”çš„å¼¹æ€§ IPï¼š

<span class="hljs-emphasis">*User accepted the command `aws ec2 describe-nat-gateways --nat-gateway-ids nat-0e773344c68bd5f76 --profile prod --output json | ConvertFrom-Json | Select-Object -ExpandProperty NatGateways | Select-Object -ExpandProperty NatGatewayAddresses | Format-Table`*</span>

<span class="hljs-emphasis">*User accepted the command `aws ec2 describe-subnets --subnet-ids subnet-01d07402f48299965 --profile prod --output json | ConvertFrom-Json | Select-Object -ExpandProperty Subnets | Select-Object SubnetId, MapPublicIpOnLaunch, AvailabilityZone | Format-Table`*</span>
</code></pre>
<p>æ¥ä¸‹æ¥éœ€è¦æ£€æŸ¥å®‰å…¨ç»„å’Œç½‘ç»œè®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰çš„é…ç½®ï¼š</p>
<pre><code class="hljs language-css" lang="css">NAT ç½‘å…³é…ç½®çœ‹èµ·æ¥ä¹Ÿæ˜¯æ­£å¸¸çš„ï¼Œå·²è·å¾—å…¬ç½‘ IP `<span class="hljs-number">18.143</span>.<span class="hljs-number">220.16</span>`ã€‚ç°åœ¨è®©æˆ‘æ£€æŸ¥ä¸€ä¸‹å®‰å…¨ç»„å’Œç½‘ç»œ ACL é…ç½®ï¼š

*User accepted the command `aws ec2 describe-instances <span class="hljs-attr">--filters</span> "Name=private-ip-<span class="hljs-selector-tag">address</span>,Values=<span class="hljs-number">10.60</span>.<span class="hljs-number">21.217</span>" <span class="hljs-attr">--profile</span> prod <span class="hljs-attr">--query</span> 'Reservations<span class="hljs-selector-attr">[0]</span><span class="hljs-selector-class">.Instances</span><span class="hljs-selector-attr">[0]</span><span class="hljs-selector-class">.SecurityGroups</span><span class="hljs-selector-attr">[*]</span>.<span class="hljs-selector-attr">[GroupId,GroupName]</span>' <span class="hljs-attr">--output</span> <span class="hljs-selector-tag">table</span>`*

*User accepted the command `aws ec2 describe-security-groups <span class="hljs-attr">--group-ids</span> sg-<span class="hljs-number">0506</span>cc37f37d190f5 <span class="hljs-attr">--profile</span> prod <span class="hljs-attr">--query</span> 'SecurityGroups<span class="hljs-selector-attr">[0]</span>.{Egress:IpPermissionsEgress}' <span class="hljs-attr">--output</span> json | ConvertFrom-Json | Select-<span class="hljs-selector-tag">Object</span> -ExpandProperty Egress | Format-List`*
</code></pre>
<p>è¿™æ—¶ï¼Œé—®é¢˜çš„æ ¹æºæµ®ç°äº†æ°´é¢ï¼š</p>
<pre><code class="hljs language-md" lang="md">å¤ªå¥½äº†ï¼ç°åœ¨çœŸç›¸å¤§ç™½äº†ã€‚ç½‘ç»œ ACL çš„é…ç½®æƒ…å†µæ˜¯ï¼š
<span class="hljs-bullet">-</span> <span class="hljs-strong">**å‡ºç«™è§„åˆ™ï¼ˆEgress=Trueï¼‰**</span>ï¼šè§„åˆ™ 100 å…è®¸æ‰€æœ‰æµé‡ç›®çš„åœ°ä¸º <span class="hljs-code">`0.0.0.0/0`</span> âœ…
<span class="hljs-bullet">-</span> <span class="hljs-strong">**å…¥ç«™è§„åˆ™ï¼ˆEgress=Falseï¼‰**</span>ï¼šä»…å…è®¸æ¥è‡ª <span class="hljs-code">`10.60.0.0/16`</span>ã€<span class="hljs-code">`10.62.1.10/32`</span> å’Œ <span class="hljs-code">`10.62.0.0/16:38880`</span> çš„æµé‡

è¿™å°±æ˜¯ç—‡ç»“æ‰€åœ¨ï¼š<span class="hljs-strong">**è™½ç„¶å‡ºç«™æµé‡å¯ä»¥æ­£å¸¸ç¦»å¼€ï¼Œä½†è¿”å›çš„æµé‡é­åˆ°äº†é˜»æ­¢**</span>ï¼è®©æˆ‘æ£€æŸ¥å…¥ç«™è§„åˆ™æ˜¯å¦å…è®¸è¿”å›çš„ä¸´æ—¶ç«¯å£æµé‡ï¼š

<span class="hljs-emphasis">*User accepted the command `kubectl exec -it network-tester -n default -- ping -c 3 8.8.8.8`*</span>
</code></pre>
<p>è¿™æ—¶ï¼ŒAI æ„è¯†åˆ°äº†ä¸€ä¸ªé€»è¾‘ä¸Šçš„çŸ›ç›¾â€”â€”ç”±äºç½‘ç»œé—®é¢˜å¯¼è‡´æ— æ³•æ‹‰å–é•œåƒï¼Œè‡ªç„¶ä¹Ÿå°±æ²¡æœ‰å¯ç”¨çš„ Pod æ¥è¿›è¡Œæµ‹è¯•ã€‚å®ƒè¿…é€Ÿè°ƒæ•´äº†ç­–ç•¥ï¼š</p>
<pre><code class="hljs language-md" lang="md">æ‚¨è¯´å¾—å¯¹ï¼è¿™ç¡®å®å½¢æˆäº†ä¸€ä¸ªæ­»å¾ªç¯â€”â€”æ— æ³•æ‹‰å–é•œåƒï¼Œå°±æ— æ³•åˆ›å»ºæµ‹è¯• Podï¼›è€Œæ²¡æœ‰ Podï¼Œæˆ‘ä»¬åˆæ— æ³•æµ‹è¯•ç½‘ç»œã€‚

è®©æˆ‘æ¢ä¸ªæ€è·¯ï¼Œç›´æ¥åˆ©ç”¨å·²ç»è¿è¡Œçš„ Pod æ¥è¿›è¡Œç½‘ç»œæµ‹è¯•ã€‚æˆ‘æ³¨æ„åˆ° <span class="hljs-code">`wallet-web`</span> Pod å·²ç»æˆåŠŸè¿è¡Œï¼Œå®Œå…¨å¯ä»¥ç”¨å®ƒæ¥éªŒè¯ç½‘ç»œè¿æ¥ï¼š

<span class="hljs-emphasis">*User accepted the command `kubectl exec -it wallet-web-5c8d94dc6b-r57wn -n wallet -- sh -c "wget -O- -T 5 https://registry-1.docker.io 2&gt;&amp;1 || curl -v --max-time 5 https://registry-1.docker.io 2&gt;&amp;1 || echo 'Both wget and curl failed'"`*</span>
</code></pre>
<p>æ‰¾äº†ä¸€ä¸ªå­˜åœ¨çš„ Pod æ‰§è¡Œè€Œæ˜¯ï¼Œç»“è®ºæ˜¯ç½‘ç»œç¡®å®æœ‰é—®é¢˜ã€‚</p>
<p>æœ€åå®ƒä¹Ÿç»™äº†æˆ‘ä¿®æ­£å‘½ä»¤ï¼Œè°ƒæ•´äº† ACL åæ¢å¤æ­£å¸¸ã€‚æ ¹æœ¬åŸå› æ˜¯æŸä½åŒäº‹æ‰‹åŠ¨ä¿®æ”¹äº† ACL é…ç½®ï¼Œä½†æ²¡æœ‰æ„è¯†åˆ°è¿™ä¸ªçœ‹ä¼¼ç®€å•çš„æ”¹åŠ¨ä¼šé€ æˆå¦‚æ­¤ä¸¥é‡çš„åæœã€‚</p>
<h2 data-id="heading-1">æ€»ç»“</h2>
<p>å°±å¦‚åŒ Vibe Coding çš„ç†å¿µä¸€æ ·ï¼Œè¿™æ¬¡æˆ‘åªæ˜¯æä¾›äº†æœ€åŸºæœ¬çš„æç¤ºï¼Œå°±è®© AI å®Œæˆäº†æ•´ä¸ªè¯Šæ–­è¿‡ç¨‹ã€‚ä¹‹æ‰€ä»¥èƒ½è¿™ä¹ˆé¡ºåˆ©ï¼Œæ ¸å¿ƒåŸå› æœ‰ä¸¤ä¸ªï¼šé¦–å…ˆï¼ŒAWS å’Œ EKS éƒ½æ˜¯éå¸¸æ ‡å‡†çš„äº‘æœåŠ¡ï¼ŒAI çš„çŸ¥è¯†åº“å·²ç»ç§¯ç´¯äº†å……è¶³çš„ç›¸å…³ä¿¡æ¯ï¼›å…¶æ¬¡ï¼Œé€šè¿‡ <code>aws</code> å’Œ <code>kubectl</code> è¿™ä¸¤ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼ŒAI å°±èƒ½è·å–åˆ°è¿›è¡Œè¯Šæ–­æ‰€éœ€çš„å…¨éƒ¨ä¿¡æ¯ã€‚</p>
<p>ç„¶è€Œï¼Œåœ¨ç°å®ä¸–ç•Œä¸­ï¼Œè®¸å¤šç»„ç»‡éƒ½æ‹¥æœ‰è‡ªå·±ç‹¬ç‰¹çš„ç³»ç»Ÿæ¶æ„å’ŒçŸ¥è¯†ä½“ç³»ï¼Œå¾€å¾€ä¸é€šç”¨ AI çš„è®¤è¯†å­˜åœ¨è¾ƒå¤§åå·®ã€‚åŒæ—¶ï¼ŒAI ç›®å‰å¯è°ƒç”¨çš„è¯Šæ–­å·¥å…·ç›¸å½“é›¶æ•£ï¼Œéš¾ä»¥é«˜æ•ˆåœ°èšåˆä¿¡æ¯è¿›è¡Œåˆ†æã€‚æˆ‘è®¤ä¸ºè¿™äº›é—®é¢˜å¯ä»¥é€šè¿‡ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io%2F" target="_blank" title="https://modelcontextprotocol.io/" ref="nofollow noopener noreferrer">MCP</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fanthropics%2Fskills" target="_blank" title="https://github.com/anthropics/skills" ref="nofollow noopener noreferrer">Skills</a> ä»¥åŠ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.anthropic.com%2Fengineering%2Feffective-context-engineering-for-ai-agents" target="_blank" title="https://www.anthropic.com/engineering/effective-context-engineering-for-ai-agents" ref="nofollow noopener noreferrer">ä¸Šä¸‹æ–‡å·¥ç¨‹</a>ç­‰æ–°å…´æŠ€æœ¯å’Œæ–¹æ³•è®ºæ¥é€æ­¥æ”¹å–„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[[æ¨è]embeddingåµŒå…¥è¡¨ç¤ºæ˜¯å¦‚ä½•ç”Ÿæˆçš„(å®æˆ˜)]]></title>    <link>https://juejin.cn/post/7586942589321756708</link>    <guid>https://juejin.cn/post/7586942589321756708</guid>    <pubDate>2025-12-23T14:56:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586942589321756708" data-draft-id="7586942589321740324" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="[æ¨è]embeddingåµŒå…¥è¡¨ç¤ºæ˜¯å¦‚ä½•ç”Ÿæˆçš„(å®æˆ˜)"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2025-12-23T14:56:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="import_random"/> <meta itemprop="url" content="https://juejin.cn/user/2013961033882312"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            [æ¨è]embeddingåµŒå…¥è¡¨ç¤ºæ˜¯å¦‚ä½•ç”Ÿæˆçš„(å®æˆ˜)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2013961033882312/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    import_random
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-23T14:56:29.000Z" title="Tue Dec 23 2025 14:56:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æˆ‘ä»¬é¦–å…ˆæ¨¡æ‹Ÿç”¨æˆ·æ•°æ®ï¼šå‡è®¾æœ‰1000ä¸ªç”¨æˆ·ï¼Œæ¯ä¸ªç”¨æˆ·æœ‰100ä¸ªç‰¹å¾ã€‚è¿™äº›ç‰¹å¾å¯èƒ½åŒ…æ‹¬æ•°å€¼å‹ã€ç±»åˆ«å‹ç­‰ï¼Œä½†ä¸ºäº†ç®€åŒ–ï¼Œæˆ‘ä»¬å…ˆç”Ÿæˆæ··åˆç±»å‹çš„æ¨¡æ‹Ÿæ•°æ®ã€‚<br/>
ç„¶åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å‡ ç§æ–¹æ³•æ¥ç”Ÿæˆembeddingï¼ŒåŒ…æ‹¬ï¼š</p>
<ol>
<li>ç›´æ¥æ ‡å‡†åŒ–åæ‹¼æ¥ï¼ˆä½œä¸ºåŸºçº¿ï¼‰</li>
<li>ä½¿ç”¨è‡ªç¼–ç å™¨è¿›è¡Œé™ç»´</li>
<li>ä½¿ç”¨ç›‘ç£å­¦ä¹ ï¼ˆå‡è®¾æˆ‘ä»¬æœ‰ä»»åŠ¡æ ‡ç­¾ï¼‰è®­ç»ƒä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œå¹¶æå–ä¸­é—´å±‚ä½œä¸ºembedding</li>
</ol>
<p>æˆ‘ä»¬å°†æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œï¼š<br/>
æ­¥éª¤1ï¼šç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®<br/>
æ­¥éª¤2ï¼šæ•°æ®é¢„å¤„ç†ï¼ˆæ ‡å‡†åŒ–ã€ç¼–ç ç­‰ï¼‰<br/>
æ­¥éª¤3ï¼šæ„å»ºæ¨¡å‹<br/>
æ­¥éª¤4ï¼šè®­ç»ƒæ¨¡å‹ï¼ˆå¦‚æœæ˜¯è‡ªç¼–ç å™¨æˆ–ç›‘ç£å­¦ä¹ ï¼‰<br/>
æ­¥éª¤5ï¼šæå–embedding</p>
<p>ç”±äºæ²¡æœ‰å…·ä½“ä»»åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è‡ªç¼–ç å™¨æ¥å­¦ä¹ å‹ç¼©è¡¨ç¤ºï¼Œæˆ–è€…ç”¨ç›‘ç£å­¦ä¹ ï¼ˆå‡è®¾ä¸€ä¸ªäºŒåˆ†ç±»ä»»åŠ¡ï¼‰æ¥å­¦ä¹ æœ‰æ„ä¹‰çš„è¡¨ç¤ºã€‚</p>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬å°†æ¨¡æ‹Ÿä¸€ä¸ªäºŒåˆ†ç±»ä»»åŠ¡ï¼ˆä¾‹å¦‚ç”¨æˆ·æ˜¯å¦ç‚¹å‡»å¹¿å‘Šï¼‰ï¼Œç„¶åè®­ç»ƒä¸€ä¸ªç›‘ç£æ¨¡å‹ï¼Œå¹¶æå–ä¸­é—´å±‚çš„è¾“å‡ºä½œä¸ºembeddingã€‚</p>
<p>å¦å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨æ— ç›‘ç£çš„è‡ªç¼–ç å™¨ã€‚</p>
<p>æˆ‘ä»¬å°†åˆ†åˆ«å±•ç¤ºä¸¤ç§æ–¹æ³•ã€‚</p>
<p>æ³¨æ„ï¼šç”±äºæ˜¯æ¨¡æ‹Ÿæ•°æ®ï¼Œæˆ‘ä»¬æ— æ³•ä¿è¯å­¦åˆ°çš„embeddingçš„å®é™…æ„ä¹‰ï¼Œä½†ä»£ç ç»“æ„æ˜¯å®Œæ•´çš„ã€‚</p>
<p>å¼€å§‹å†™ä»£ç ï¼š</p>
<p>æˆ‘æ¥ä¸ºä½ ç¼–å†™ä¸€ä¸ªå®Œæ•´çš„ã€å¯è¿è¡Œçš„Pythonä»£ç ï¼Œæ¨¡æ‹Ÿç”¨æˆ·æ•°æ®å¹¶ç”ŸæˆembeddingåµŒå…¥è¡¨ç¤ºã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">import</span> torch.nn <span class="hljs-keyword">as</span> nn
<span class="hljs-keyword">import</span> torch.optim <span class="hljs-keyword">as</span> optim
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler, LabelEncoder
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.decomposition <span class="hljs-keyword">import</span> PCA
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns
<span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> DataLoader, TensorDataset

<span class="hljs-comment"># è®¾ç½®éšæœºç§å­ç¡®ä¿å¯é‡å¤æ€§</span>
np.random.seed(<span class="hljs-number">42</span>)
torch.manual_seed(<span class="hljs-number">42</span>)

<span class="hljs-comment"># 1. æ¨¡æ‹Ÿç”¨æˆ·æ•°æ®</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_synthetic_users</span>(<span class="hljs-params">n_users=<span class="hljs-number">1000</span>, n_features=<span class="hljs-number">100</span></span>):
    <span class="hljs-string">"""ç”Ÿæˆæ¨¡æ‹Ÿç”¨æˆ·æ•°æ®"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ­£åœ¨ç”Ÿæˆ <span class="hljs-subst">{n_users}</span> ä¸ªç”¨æˆ·çš„æ¨¡æ‹Ÿæ•°æ®ï¼Œæ¯ä¸ªç”¨æˆ·æœ‰ <span class="hljs-subst">{n_features}</span> ä¸ªç‰¹å¾..."</span>)
    
    <span class="hljs-comment"># ç”¨æˆ·ID</span>
    user_ids = [<span class="hljs-string">f"user_<span class="hljs-subst">{i:04d}</span>"</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n_users)]
    
    <span class="hljs-comment"># åˆ›å»ºç©ºçš„æ•°æ®å­—å…¸</span>
    data = {<span class="hljs-string">"user_id"</span>: user_ids}
    
    <span class="hljs-comment"># æ¨¡æ‹Ÿä¸åŒç±»å‹çš„æ•°æ®ç‰¹å¾</span>
    <span class="hljs-comment"># 1. åŸºæœ¬äººå£ç»Ÿè®¡ç‰¹å¾ (20ä¸ªç‰¹å¾)</span>
    data[<span class="hljs-string">"age"</span>] = np.random.normal(<span class="hljs-number">35</span>, <span class="hljs-number">10</span>, n_users).clip(<span class="hljs-number">18</span>, <span class="hljs-number">70</span>)  <span class="hljs-comment"># å¹´é¾„</span>
    data[<span class="hljs-string">"income"</span>] = np.random.lognormal(<span class="hljs-number">10</span>, <span class="hljs-number">0.5</span>, n_users)  <span class="hljs-comment"># æ”¶å…¥ï¼Œå¯¹æ•°æ­£æ€åˆ†å¸ƒ</span>
    data[<span class="hljs-string">"education_years"</span>] = np.random.choice([<span class="hljs-number">9</span>, <span class="hljs-number">12</span>, <span class="hljs-number">16</span>, <span class="hljs-number">18</span>, <span class="hljs-number">21</span>], n_users, p=[<span class="hljs-number">0.1</span>, <span class="hljs-number">0.3</span>, <span class="hljs-number">0.4</span>, <span class="hljs-number">0.15</span>, <span class="hljs-number">0.05</span>])  <span class="hljs-comment"># æ•™è‚²å¹´é™</span>
    
    <span class="hljs-comment"># 2. è¡Œä¸ºç‰¹å¾ (40ä¸ªç‰¹å¾) - æ¨¡æ‹Ÿç”¨æˆ·åœ¨ä¸åŒç±»åˆ«ä¸Šçš„æ´»è·ƒåº¦</span>
    categories = [<span class="hljs-string">"å¨±ä¹"</span>, <span class="hljs-string">"ç§‘æŠ€"</span>, <span class="hljs-string">"ä½“è‚²"</span>, <span class="hljs-string">"è´­ç‰©"</span>, <span class="hljs-string">"æ—…æ¸¸"</span>, <span class="hljs-string">"ç¾é£Ÿ"</span>, <span class="hljs-string">"å¥åº·"</span>, <span class="hljs-string">"é‡‘è"</span>, <span class="hljs-string">"æ•™è‚²"</span>, <span class="hljs-string">"æ¸¸æˆ"</span>]
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):  <span class="hljs-comment"># æ¯ä¸ªç±»åˆ«æœ‰4ä¸ªè¡Œä¸ºæŒ‡æ ‡</span>
            feature_name = <span class="hljs-string">f"<span class="hljs-subst">{categories[i]}</span>_è¡Œä¸º_<span class="hljs-subst">{j}</span>"</span>
            <span class="hljs-comment"># ä½¿ç”¨ä¸åŒçš„åˆ†å¸ƒæ¨¡æ‹Ÿä¸åŒè¡Œä¸º</span>
            <span class="hljs-keyword">if</span> j == <span class="hljs-number">0</span>:
                data[feature_name] = np.random.exponential(scale=<span class="hljs-number">2</span>, size=n_users)  <span class="hljs-comment"># æµè§ˆæ—¶é•¿</span>
            <span class="hljs-keyword">elif</span> j == <span class="hljs-number">1</span>:
                data[feature_name] = np.random.poisson(lam=<span class="hljs-number">3</span>, size=n_users)  <span class="hljs-comment"># è®¿é—®æ¬¡æ•°</span>
            <span class="hljs-keyword">elif</span> j == <span class="hljs-number">2</span>:
                data[feature_name] = np.random.beta(<span class="hljs-number">2</span>, <span class="hljs-number">5</span>, size=n_users) * <span class="hljs-number">100</span>  <span class="hljs-comment"># äº’åŠ¨ç‡</span>
            <span class="hljs-keyword">else</span>:
                data[feature_name] = np.random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>, size=n_users)  <span class="hljs-comment"># è¯„åˆ†</span>
    
    <span class="hljs-comment"># 3. åå¥½ç‰¹å¾ (20ä¸ªç‰¹å¾) - 0-1ä¹‹é—´çš„åå¥½å¾—åˆ†</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):
        data[<span class="hljs-string">f"åå¥½_<span class="hljs-subst">{i}</span>"</span>] = np.random.beta(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, size=n_users)
    
    <span class="hljs-comment"># 4. è®¾å¤‡å’Œä½¿ç”¨ç‰¹å¾ (10ä¸ªç‰¹å¾)</span>
    data[<span class="hljs-string">"è®¾å¤‡ç±»å‹"</span>] = np.random.choice([<span class="hljs-string">"ç§»åŠ¨ç«¯"</span>, <span class="hljs-string">"PC"</span>, <span class="hljs-string">"å¹³æ¿"</span>], n_users, p=[<span class="hljs-number">0.6</span>, <span class="hljs-number">0.3</span>, <span class="hljs-number">0.1</span>])
    data[<span class="hljs-string">"ä½¿ç”¨é¢‘ç‡"</span>] = np.random.choice([<span class="hljs-string">"æ¯å¤©"</span>, <span class="hljs-string">"æ¯å‘¨"</span>, <span class="hljs-string">"æ¯æœˆ"</span>, <span class="hljs-string">"å¶å°”"</span>], n_users, p=[<span class="hljs-number">0.4</span>, <span class="hljs-number">0.3</span>, <span class="hljs-number">0.2</span>, <span class="hljs-number">0.1</span>])
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):
        data[<span class="hljs-string">f"åŠŸèƒ½ä½¿ç”¨_<span class="hljs-subst">{i}</span>"</span>] = np.random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, size=n_users)
    
    <span class="hljs-comment"># 5. ç¤¾äº¤ç‰¹å¾ (10ä¸ªç‰¹å¾)</span>
    data[<span class="hljs-string">"å¥½å‹æ•°"</span>] = np.random.pareto(<span class="hljs-number">2.5</span>, size=n_users).clip(<span class="hljs-number">0</span>, <span class="hljs-number">500</span>) + <span class="hljs-number">10</span>
    data[<span class="hljs-string">"å…³æ³¨æ•°"</span>] = np.random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">200</span>, size=n_users)
    data[<span class="hljs-string">"ç²‰ä¸æ•°"</span>] = np.random.poisson(lam=<span class="hljs-number">50</span>, size=n_users)
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">7</span>):
        data[<span class="hljs-string">f"ç¤¾äº¤äº’åŠ¨_<span class="hljs-subst">{i}</span>"</span>] = np.random.exponential(scale=<span class="hljs-number">5</span>, size=n_users)
    
    <span class="hljs-comment"># è½¬æ¢ä¸ºDataFrame</span>
    df = pd.DataFrame(data)
    
    <span class="hljs-comment"># ç¡®ä¿æ­£å¥½æœ‰100ä¸ªç‰¹å¾</span>
    <span class="hljs-comment"># å¦‚æœä¸å¤Ÿï¼Œæ·»åŠ ä¸€äº›éšæœºç‰¹å¾</span>
    current_features = <span class="hljs-built_in">len</span>(df.columns) - <span class="hljs-number">1</span>  <span class="hljs-comment"># å‡å»user_idåˆ—</span>
    <span class="hljs-keyword">if</span> current_features &lt; n_features:
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n_features - current_features):
            df[<span class="hljs-string">f"é™„åŠ ç‰¹å¾_<span class="hljs-subst">{i}</span>"</span>] = np.random.normal(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, n_users)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ•°æ®ç”Ÿæˆå®Œæˆï¼å®é™…ç‰¹å¾æ•°: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(df.columns)-<span class="hljs-number">1</span>}</span> (åŒ…å«user_id)"</span>)
    <span class="hljs-keyword">return</span> df

<span class="hljs-comment"># 2. æ•°æ®é¢„å¤„ç†</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">preprocess_data</span>(<span class="hljs-params">df, target_column=<span class="hljs-literal">None</span></span>):
    <span class="hljs-string">"""é¢„å¤„ç†æ•°æ®ï¼šå¤„ç†ç¼ºå¤±å€¼ã€ç¼–ç åˆ†ç±»å˜é‡ã€æ ‡å‡†åŒ–æ•°å€¼ç‰¹å¾"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\næ­£åœ¨é¢„å¤„ç†æ•°æ®..."</span>)
    
    <span class="hljs-comment"># å¤åˆ¶æ•°æ®ï¼Œé¿å…ä¿®æ”¹åŸå§‹æ•°æ®</span>
    df_processed = df.copy()
    
    <span class="hljs-comment"># åˆ†ç¦»ç”¨æˆ·ID</span>
    user_ids = df_processed[<span class="hljs-string">'user_id'</span>]
    df_processed = df_processed.drop(<span class="hljs-string">'user_id'</span>, axis=<span class="hljs-number">1</span>)
    
    <span class="hljs-comment"># å¤„ç†ç¼ºå¤±å€¼</span>
    <span class="hljs-keyword">if</span> df_processed.isnull().<span class="hljs-built_in">any</span>().<span class="hljs-built_in">any</span>():
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‘ç° <span class="hljs-subst">{df_processed.isnull().<span class="hljs-built_in">sum</span>().<span class="hljs-built_in">sum</span>()}</span> ä¸ªç¼ºå¤±å€¼ï¼Œä½¿ç”¨ä¸­ä½æ•°å¡«å……..."</span>)
        df_processed = df_processed.fillna(df_processed.median())
    
    <span class="hljs-comment"># è¯†åˆ«æ•°å€¼ç‰¹å¾å’Œåˆ†ç±»ç‰¹å¾</span>
    numerical_features = df_processed.select_dtypes(include=[np.number]).columns.tolist()
    categorical_features = df_processed.select_dtypes(include=[<span class="hljs-string">'object'</span>]).columns.tolist()
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ•°å€¼ç‰¹å¾: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(numerical_features)}</span> ä¸ª"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åˆ†ç±»ç‰¹å¾: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(categorical_features)}</span> ä¸ª"</span>)
    
    <span class="hljs-comment"># ç¼–ç åˆ†ç±»ç‰¹å¾</span>
    label_encoders = {}
    <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> categorical_features:
        le = LabelEncoder()
        df_processed[col] = le.fit_transform(df_processed[col])
        label_encoders[col] = le
    
    <span class="hljs-comment"># æ ‡å‡†åŒ–æ•°å€¼ç‰¹å¾</span>
    scaler = StandardScaler()
    df_processed[numerical_features] = scaler.fit_transform(df_processed[numerical_features])
    
    <span class="hljs-comment"># å¦‚æœæœ‰ç›®æ ‡å˜é‡ï¼Œåˆ†ç¦»å‡ºæ¥</span>
    target = <span class="hljs-literal">None</span>
    <span class="hljs-keyword">if</span> target_column <span class="hljs-keyword">and</span> target_column <span class="hljs-keyword">in</span> df.columns:
        target = df[target_column]
        df_processed = df_processed.drop(target_column, axis=<span class="hljs-number">1</span>) <span class="hljs-keyword">if</span> target_column <span class="hljs-keyword">in</span> df_processed.columns <span class="hljs-keyword">else</span> df_processed
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"é¢„å¤„ç†å®Œæˆï¼æœ€ç»ˆç‰¹å¾ç»´åº¦: <span class="hljs-subst">{df_processed.shape[<span class="hljs-number">1</span>]}</span>"</span>)
    
    <span class="hljs-keyword">return</span> df_processed, user_ids, scaler, label_encoders, target

<span class="hljs-comment"># 3. ä½¿ç”¨PCAç”Ÿæˆembeddingï¼ˆç®€å•æ–¹æ³•ï¼‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_embeddings_pca</span>(<span class="hljs-params">features, n_components=<span class="hljs-number">32</span></span>):
    <span class="hljs-string">"""ä½¿ç”¨PCAé™ç»´ç”Ÿæˆembedding"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nä½¿ç”¨PCAç”Ÿæˆ<span class="hljs-subst">{features.shape[<span class="hljs-number">0</span>]}</span>ä¸ªç”¨æˆ·çš„embeddingï¼Œç»´åº¦: <span class="hljs-subst">{n_components}</span>..."</span>)
    
    pca = PCA(n_components=n_components, random_state=<span class="hljs-number">42</span>)
    embeddings = pca.fit_transform(features)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"PCAè§£é‡Šæ–¹å·®æ¯”: <span class="hljs-subst">{pca.explained_variance_ratio_.<span class="hljs-built_in">sum</span>():<span class="hljs-number">.3</span>f}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‰5ä¸ªä¸»æˆåˆ†è§£é‡Šæ–¹å·®æ¯”: <span class="hljs-subst">{pca.explained_variance_ratio_[:<span class="hljs-number">5</span>]}</span>"</span>)
    
    <span class="hljs-keyword">return</span> embeddings, pca

<span class="hljs-comment"># 4. ä½¿ç”¨è‡ªç¼–ç å™¨ç”Ÿæˆembeddingï¼ˆæ·±åº¦å­¦ä¹ æ–¹æ³•ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Autoencoder</span>(nn.Module):
    <span class="hljs-string">"""è‡ªç¼–ç å™¨æ¨¡å‹ï¼Œç”¨äºå­¦ä¹ ä½ç»´è¡¨ç¤º"""</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, input_dim, embedding_dim</span>):
        <span class="hljs-built_in">super</span>(Autoencoder, self).__init__()
        
        <span class="hljs-comment"># ç¼–ç å™¨</span>
        self.encoder = nn.Sequential(
            nn.Linear(input_dim, <span class="hljs-number">256</span>),
            nn.BatchNorm1d(<span class="hljs-number">256</span>),
            nn.ReLU(),
            nn.Dropout(<span class="hljs-number">0.2</span>),
            nn.Linear(<span class="hljs-number">256</span>, <span class="hljs-number">128</span>),
            nn.ReLU(),
            nn.Linear(<span class="hljs-number">128</span>, embedding_dim)
        )
        
        <span class="hljs-comment"># è§£ç å™¨</span>
        self.decoder = nn.Sequential(
            nn.Linear(embedding_dim, <span class="hljs-number">128</span>),
            nn.ReLU(),
            nn.Linear(<span class="hljs-number">128</span>, <span class="hljs-number">256</span>),
            nn.ReLU(),
            nn.Linear(<span class="hljs-number">256</span>, input_dim)
        )
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):
        embedding = self.encoder(x)
        reconstructed = self.decoder(embedding)
        <span class="hljs-keyword">return</span> embedding, reconstructed

<span class="hljs-keyword">def</span> <span class="hljs-title function_">train_autoencoder</span>(<span class="hljs-params">features, embedding_dim=<span class="hljs-number">32</span>, epochs=<span class="hljs-number">50</span>, batch_size=<span class="hljs-number">64</span>, learning_rate=<span class="hljs-number">0.001</span></span>):
    <span class="hljs-string">"""è®­ç»ƒè‡ªç¼–ç å™¨å¹¶ç”Ÿæˆembedding"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nè®­ç»ƒè‡ªç¼–ç å™¨ç”Ÿæˆembeddingï¼Œç»´åº¦: <span class="hljs-subst">{embedding_dim}</span>..."</span>)
    
    <span class="hljs-comment"># è½¬æ¢ä¸ºPyTorchå¼ é‡</span>
    features_tensor = torch.FloatTensor(features)
    
    <span class="hljs-comment"># åˆ›å»ºæ•°æ®åŠ è½½å™¨</span>
    dataset = TensorDataset(features_tensor, features_tensor)
    train_loader = DataLoader(dataset, batch_size=batch_size, shuffle=<span class="hljs-literal">True</span>)
    
    <span class="hljs-comment"># åˆå§‹åŒ–æ¨¡å‹</span>
    input_dim = features.shape[<span class="hljs-number">1</span>]
    model = Autoencoder(input_dim, embedding_dim)
    
    <span class="hljs-comment"># æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨</span>
    criterion = nn.MSELoss()
    optimizer = optim.Adam(model.parameters(), lr=learning_rate)
    
    <span class="hljs-comment"># è®­ç»ƒå¾ªç¯</span>
    model.train()
    train_losses = []
    
    <span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(epochs):
        epoch_loss = <span class="hljs-number">0.0</span>
        <span class="hljs-keyword">for</span> batch_features, _ <span class="hljs-keyword">in</span> train_loader:
            optimizer.zero_grad()
            _, reconstructed = model(batch_features)
            loss = criterion(reconstructed, batch_features)
            loss.backward()
            optimizer.step()
            epoch_loss += loss.item()
        
        avg_loss = epoch_loss / <span class="hljs-built_in">len</span>(train_loader)
        train_losses.append(avg_loss)
        
        <span class="hljs-keyword">if</span> (epoch + <span class="hljs-number">1</span>) % <span class="hljs-number">10</span> == <span class="hljs-number">0</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Epoch [<span class="hljs-subst">{epoch+<span class="hljs-number">1</span>}</span>/<span class="hljs-subst">{epochs}</span>], Loss: <span class="hljs-subst">{avg_loss:<span class="hljs-number">.6</span>f}</span>"</span>)
    
    <span class="hljs-comment"># ç”Ÿæˆæ‰€æœ‰æ•°æ®çš„embedding</span>
    model.<span class="hljs-built_in">eval</span>()
    <span class="hljs-keyword">with</span> torch.no_grad():
        all_embeddings = []
        <span class="hljs-keyword">for</span> batch_features, _ <span class="hljs-keyword">in</span> train_loader:
            embeddings, _ = model(batch_features)
            all_embeddings.append(embeddings)
        
        embeddings = torch.cat(all_embeddings, dim=<span class="hljs-number">0</span>).numpy()
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è‡ªç¼–ç å™¨è®­ç»ƒå®Œæˆï¼æœ€ç»ˆæŸå¤±: <span class="hljs-subst">{train_losses[-<span class="hljs-number">1</span>]:<span class="hljs-number">.6</span>f}</span>"</span>)
    
    <span class="hljs-keyword">return</span> embeddings, model, train_losses

<span class="hljs-comment"># 5. ä½¿ç”¨ç›‘ç£å­¦ä¹ ç”Ÿæˆembeddingï¼ˆå‡è®¾æœ‰æ ‡ç­¾ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SupervisedEmbeddingModel</span>(nn.Module):
    <span class="hljs-string">"""ç›‘ç£å­¦ä¹ æ¨¡å‹ï¼Œç”¨äºå­¦ä¹ æœ‰ä»»åŠ¡æ„ä¹‰çš„embedding"""</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, input_dim, embedding_dim, n_classes=<span class="hljs-number">2</span></span>):
        <span class="hljs-built_in">super</span>(SupervisedEmbeddingModel, self).__init__()
        
        <span class="hljs-comment"># å…±äº«ç¼–ç å±‚</span>
        self.encoder = nn.Sequential(
            nn.Linear(input_dim, <span class="hljs-number">128</span>),
            nn.BatchNorm1d(<span class="hljs-number">128</span>),
            nn.ReLU(),
            nn.Dropout(<span class="hljs-number">0.3</span>),
            nn.Linear(<span class="hljs-number">128</span>, <span class="hljs-number">64</span>),
            nn.ReLU(),
            nn.Linear(<span class="hljs-number">64</span>, embedding_dim)
        )
        
        <span class="hljs-comment"># åˆ†ç±»å¤´</span>
        self.classifier = nn.Sequential(
            nn.Linear(embedding_dim, <span class="hljs-number">32</span>),
            nn.ReLU(),
            nn.Linear(<span class="hljs-number">32</span>, n_classes)
        )
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):
        embedding = self.encoder(x)
        logits = self.classifier(embedding)
        <span class="hljs-keyword">return</span> embedding, logits

<span class="hljs-keyword">def</span> <span class="hljs-title function_">train_supervised_model</span>(<span class="hljs-params">features, labels, embedding_dim=<span class="hljs-number">32</span>, epochs=<span class="hljs-number">50</span>, batch_size=<span class="hljs-number">64</span>, learning_rate=<span class="hljs-number">0.001</span></span>):
    <span class="hljs-string">"""è®­ç»ƒç›‘ç£æ¨¡å‹å¹¶æå–embedding"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nè®­ç»ƒç›‘ç£æ¨¡å‹ç”Ÿæˆembeddingï¼Œç»´åº¦: <span class="hljs-subst">{embedding_dim}</span>..."</span>)
    
    <span class="hljs-comment"># è½¬æ¢ä¸ºPyTorchå¼ é‡</span>
    features_tensor = torch.FloatTensor(features)
    labels_tensor = torch.LongTensor(labels)
    
    <span class="hljs-comment"># åˆ’åˆ†è®­ç»ƒé›†å’ŒéªŒè¯é›†</span>
    X_train, X_val, y_train, y_val = train_test_split(
        features_tensor.numpy(), labels_tensor.numpy(), test_size=<span class="hljs-number">0.2</span>, random_state=<span class="hljs-number">42</span>
    )
    
    X_train = torch.FloatTensor(X_train)
    X_val = torch.FloatTensor(X_val)
    y_train = torch.LongTensor(y_train)
    y_val = torch.LongTensor(y_val)
    
    <span class="hljs-comment"># åˆ›å»ºæ•°æ®åŠ è½½å™¨</span>
    train_dataset = TensorDataset(X_train, y_train)
    val_dataset = TensorDataset(X_val, y_val)
    train_loader = DataLoader(train_dataset, batch_size=batch_size, shuffle=<span class="hljs-literal">True</span>)
    val_loader = DataLoader(val_dataset, batch_size=batch_size, shuffle=<span class="hljs-literal">False</span>)
    
    <span class="hljs-comment"># åˆå§‹åŒ–æ¨¡å‹</span>
    input_dim = features.shape[<span class="hljs-number">1</span>]
    n_classes = <span class="hljs-built_in">len</span>(np.unique(labels))
    model = SupervisedEmbeddingModel(input_dim, embedding_dim, n_classes)
    
    <span class="hljs-comment"># æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨</span>
    criterion = nn.CrossEntropyLoss()
    optimizer = optim.Adam(model.parameters(), lr=learning_rate)
    
    <span class="hljs-comment"># è®­ç»ƒå¾ªç¯</span>
    model.train()
    train_losses = []
    val_accuracies = []
    
    <span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(epochs):
        <span class="hljs-comment"># è®­ç»ƒé˜¶æ®µ</span>
        model.train()
        epoch_loss = <span class="hljs-number">0.0</span>
        <span class="hljs-keyword">for</span> batch_features, batch_labels <span class="hljs-keyword">in</span> train_loader:
            optimizer.zero_grad()
            _, logits = model(batch_features)
            loss = criterion(logits, batch_labels)
            loss.backward()
            optimizer.step()
            epoch_loss += loss.item()
        
        avg_train_loss = epoch_loss / <span class="hljs-built_in">len</span>(train_loader)
        train_losses.append(avg_train_loss)
        
        <span class="hljs-comment"># éªŒè¯é˜¶æ®µ</span>
        model.<span class="hljs-built_in">eval</span>()
        correct = <span class="hljs-number">0</span>
        total = <span class="hljs-number">0</span>
        <span class="hljs-keyword">with</span> torch.no_grad():
            <span class="hljs-keyword">for</span> batch_features, batch_labels <span class="hljs-keyword">in</span> val_loader:
                _, logits = model(batch_features)
                _, predicted = torch.<span class="hljs-built_in">max</span>(logits, <span class="hljs-number">1</span>)
                total += batch_labels.size(<span class="hljs-number">0</span>)
                correct += (predicted == batch_labels).<span class="hljs-built_in">sum</span>().item()
        
        val_accuracy = correct / total
        val_accuracies.append(val_accuracy)
        
        <span class="hljs-keyword">if</span> (epoch + <span class="hljs-number">1</span>) % <span class="hljs-number">10</span> == <span class="hljs-number">0</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Epoch [<span class="hljs-subst">{epoch+<span class="hljs-number">1</span>}</span>/<span class="hljs-subst">{epochs}</span>], Loss: <span class="hljs-subst">{avg_train_loss:<span class="hljs-number">.4</span>f}</span>, Val Accuracy: <span class="hljs-subst">{val_accuracy:<span class="hljs-number">.4</span>f}</span>"</span>)
    
    <span class="hljs-comment"># ç”Ÿæˆæ‰€æœ‰æ•°æ®çš„embedding</span>
    model.<span class="hljs-built_in">eval</span>()
    all_embeddings = []
    <span class="hljs-keyword">with</span> torch.no_grad():
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(features_tensor), batch_size):
            batch = features_tensor[i:i+batch_size]
            embeddings, _ = model(batch)
            all_embeddings.append(embeddings)
        
        embeddings = torch.cat(all_embeddings, dim=<span class="hljs-number">0</span>).numpy()
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç›‘ç£æ¨¡å‹è®­ç»ƒå®Œæˆï¼æœ€ç»ˆéªŒè¯å‡†ç¡®ç‡: <span class="hljs-subst">{val_accuracies[-<span class="hljs-number">1</span>]:<span class="hljs-number">.4</span>f}</span>"</span>)
    
    <span class="hljs-keyword">return</span> embeddings, model, train_losses, val_accuracies

<span class="hljs-comment"># 6. å¯è§†åŒ–embedding</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">visualize_embeddings</span>(<span class="hljs-params">embeddings, labels=<span class="hljs-literal">None</span>, method=<span class="hljs-string">"PCA"</span>, n_components=<span class="hljs-number">2</span></span>):
    <span class="hljs-string">"""å¯è§†åŒ–embedding"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nä½¿ç”¨<span class="hljs-subst">{n_components}</span>ç»´å¯è§†åŒ–embedding..."</span>)
    
    <span class="hljs-comment"># å¦‚æœembeddingç»´åº¦é«˜äº2ï¼Œä½¿ç”¨PCAæˆ–t-SNEé™ç»´</span>
    <span class="hljs-keyword">if</span> embeddings.shape[<span class="hljs-number">1</span>] &gt; <span class="hljs-number">2</span>:
        <span class="hljs-keyword">if</span> method == <span class="hljs-string">"PCA"</span>:
            reducer = PCA(n_components=n_components, random_state=<span class="hljs-number">42</span>)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">from</span> sklearn.manifold <span class="hljs-keyword">import</span> TSNE
            reducer = TSNE(n_components=n_components, random_state=<span class="hljs-number">42</span>, perplexity=<span class="hljs-number">30</span>)
        
        embeddings_2d = reducer.fit_transform(embeddings)
    <span class="hljs-keyword">else</span>:
        embeddings_2d = embeddings
    
    <span class="hljs-comment"># ç»˜åˆ¶æ•£ç‚¹å›¾</span>
    plt.figure(figsize=(<span class="hljs-number">10</span>, <span class="hljs-number">8</span>))
    
    <span class="hljs-keyword">if</span> labels <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
        scatter = plt.scatter(embeddings_2d[:, <span class="hljs-number">0</span>], embeddings_2d[:, <span class="hljs-number">1</span>], 
                             c=labels, cmap=<span class="hljs-string">'viridis'</span>, alpha=<span class="hljs-number">0.6</span>, s=<span class="hljs-number">30</span>)
        plt.colorbar(scatter, label=<span class="hljs-string">'ç±»åˆ«'</span>)
    <span class="hljs-keyword">else</span>:
        plt.scatter(embeddings_2d[:, <span class="hljs-number">0</span>], embeddings_2d[:, <span class="hljs-number">1</span>], alpha=<span class="hljs-number">0.6</span>, s=<span class="hljs-number">30</span>)
    
    plt.title(<span class="hljs-string">f'ç”¨æˆ·Embeddingå¯è§†åŒ– (<span class="hljs-subst">{method}</span>)'</span>)
    plt.xlabel(<span class="hljs-string">'ç»´åº¦1'</span>)
    plt.ylabel(<span class="hljs-string">'ç»´åº¦2'</span>)
    plt.grid(<span class="hljs-literal">True</span>, alpha=<span class="hljs-number">0.3</span>)
    plt.tight_layout()
    plt.show()

<span class="hljs-comment"># 7. è¯„ä¼°embeddingè´¨é‡</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">evaluate_embeddings</span>(<span class="hljs-params">embeddings, labels=<span class="hljs-literal">None</span></span>):
    <span class="hljs-string">"""è¯„ä¼°embeddingçš„è´¨é‡"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nè¯„ä¼°embeddingè´¨é‡..."</span>)
    
    <span class="hljs-comment"># 1. è®¡ç®—embeddingçš„åŸºæœ¬ç»Ÿè®¡</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Embeddingå½¢çŠ¶: <span class="hljs-subst">{embeddings.shape}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Embeddingå‡å€¼: <span class="hljs-subst">{embeddings.mean():<span class="hljs-number">.4</span>f}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Embeddingæ ‡å‡†å·®: <span class="hljs-subst">{embeddings.std():<span class="hljs-number">.4</span>f}</span>"</span>)
    
    <span class="hljs-comment"># 2. è®¡ç®—ç±»å†…è·ç¦»å’Œç±»é—´è·ç¦»ï¼ˆå¦‚æœæœ‰æ ‡ç­¾ï¼‰</span>
    <span class="hljs-keyword">if</span> labels <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
        unique_labels = np.unique(labels)
        within_distances = []
        between_distances = []
        
        <span class="hljs-keyword">for</span> label <span class="hljs-keyword">in</span> unique_labels:
            <span class="hljs-comment"># ç±»å†…è·ç¦»</span>
            class_samples = embeddings[labels == label]
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(class_samples) &gt; <span class="hljs-number">1</span>:
                centroid = class_samples.mean(axis=<span class="hljs-number">0</span>)
                distances = np.linalg.norm(class_samples - centroid, axis=<span class="hljs-number">1</span>)
                within_distances.extend(distances)
            
            <span class="hljs-comment"># ç±»é—´è·ç¦»</span>
            other_labels = unique_labels[unique_labels != label]
            <span class="hljs-keyword">for</span> other_label <span class="hljs-keyword">in</span> other_labels:
                other_centroid = embeddings[labels == other_label].mean(axis=<span class="hljs-number">0</span>)
                between_distance = np.linalg.norm(centroid - other_centroid)
                between_distances.append(between_distance)
        
        <span class="hljs-keyword">if</span> within_distances <span class="hljs-keyword">and</span> between_distances:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¹³å‡ç±»å†…è·ç¦»: <span class="hljs-subst">{np.mean(within_distances):<span class="hljs-number">.4</span>f}</span>"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¹³å‡ç±»é—´è·ç¦»: <span class="hljs-subst">{np.mean(between_distances):<span class="hljs-number">.4</span>f}</span>"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åˆ†ç¦»åº¦(ç±»é—´/ç±»å†…): <span class="hljs-subst">{np.mean(between_distances)/np.mean(within_distances):<span class="hljs-number">.4</span>f}</span>"</span>)
    
    <span class="hljs-comment"># 3. è®¡ç®—æœ€è¿‘é‚»çš„ä¸€è‡´æ€§ï¼ˆå¦‚æœæœ‰åŸå§‹ç‰¹å¾ï¼‰</span>
    <span class="hljs-comment"># è¿™é‡Œå¯ä»¥æ·»åŠ æ›´å¤šè¯„ä¼°æŒ‡æ ‡</span>
    
    <span class="hljs-keyword">return</span> embeddings

<span class="hljs-comment"># 8. ä¸»å‡½æ•°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    <span class="hljs-string">"""ä¸»å‡½æ•°ï¼šç”Ÿæˆç”¨æˆ·æ•°æ®å¹¶åˆ›å»ºembedding"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span>*<span class="hljs-number">60</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç”¨æˆ·Embeddingç”Ÿæˆç³»ç»Ÿ"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span>*<span class="hljs-number">60</span>)
    
    <span class="hljs-comment"># ç”Ÿæˆæ¨¡æ‹Ÿç”¨æˆ·æ•°æ®</span>
    df_users = generate_synthetic_users(n_users=<span class="hljs-number">1000</span>, n_features=<span class="hljs-number">100</span>)
    
    <span class="hljs-comment"># åˆ›å»ºæ¨¡æ‹Ÿæ ‡ç­¾ï¼ˆå‡è®¾æ˜¯äºŒåˆ†ç±»ä»»åŠ¡ï¼šé«˜ä»·å€¼ç”¨æˆ· vs æ™®é€šç”¨æˆ·ï¼‰</span>
    <span class="hljs-comment"># åŸºäºæ”¶å…¥å’Œè¡Œä¸ºç‰¹å¾åˆ›å»ºæ ‡ç­¾</span>
    df_users[<span class="hljs-string">'high_value'</span>] = ((df_users[<span class="hljs-string">'income'</span>] &gt; df_users[<span class="hljs-string">'income'</span>].quantile(<span class="hljs-number">0.7</span>)) &amp; 
                              (df_users[<span class="hljs-string">'å¨±ä¹_è¡Œä¸º_0'</span>] &gt; df_users[<span class="hljs-string">'å¨±ä¹_è¡Œä¸º_0'</span>].quantile(<span class="hljs-number">0.6</span>))).astype(<span class="hljs-built_in">int</span>)
    
    <span class="hljs-comment"># æ˜¾ç¤ºæ•°æ®ç¤ºä¾‹</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nå‰5ä¸ªç”¨æˆ·çš„æ•°æ®ç¤ºä¾‹:"</span>)
    <span class="hljs-built_in">print</span>(df_users.head())
    
    <span class="hljs-comment"># æ•°æ®é¢„å¤„ç†</span>
    features, user_ids, scaler, label_encoders, target = preprocess_data(
        df_users, target_column=<span class="hljs-string">'high_value'</span>
    )
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nå¤„ç†åçš„ç‰¹å¾çŸ©é˜µå½¢çŠ¶: <span class="hljs-subst">{features.shape}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç›®æ ‡å˜é‡åˆ†å¸ƒ:\n<span class="hljs-subst">{pd.Series(target).value_counts()}</span>"</span>)
    
    <span class="hljs-comment"># æ–¹æ³•1: ä½¿ç”¨PCAç”Ÿæˆembedding</span>
    embeddings_pca, pca_model = generate_embeddings_pca(features, n_components=<span class="hljs-number">32</span>)
    
    <span class="hljs-comment"># æ–¹æ³•2: ä½¿ç”¨è‡ªç¼–ç å™¨ç”Ÿæˆembedding</span>
    embeddings_ae, ae_model, ae_losses = train_autoencoder(
        features.values, embedding_dim=<span class="hljs-number">32</span>, epochs=<span class="hljs-number">50</span>, batch_size=<span class="hljs-number">64</span>
    )
    
    <span class="hljs-comment"># æ–¹æ³•3: ä½¿ç”¨ç›‘ç£å­¦ä¹ ç”Ÿæˆembeddingï¼ˆéœ€è¦æ ‡ç­¾ï¼‰</span>
    embeddings_supervised, supervised_model, train_losses, val_accuracies = train_supervised_model(
        features.values, target.values, embedding_dim=<span class="hljs-number">32</span>, epochs=<span class="hljs-number">50</span>, batch_size=<span class="hljs-number">64</span>
    )
    
    <span class="hljs-comment"># å¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹</span>
    fig, axes = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">4</span>))
    
    <span class="hljs-comment"># è‡ªç¼–ç å™¨æŸå¤±</span>
    axes[<span class="hljs-number">0</span>].plot(ae_losses)
    axes[<span class="hljs-number">0</span>].set_title(<span class="hljs-string">'è‡ªç¼–ç å™¨è®­ç»ƒæŸå¤±'</span>)
    axes[<span class="hljs-number">0</span>].set_xlabel(<span class="hljs-string">'Epoch'</span>)
    axes[<span class="hljs-number">0</span>].set_ylabel(<span class="hljs-string">'MSE Loss'</span>)
    axes[<span class="hljs-number">0</span>].grid(<span class="hljs-literal">True</span>, alpha=<span class="hljs-number">0.3</span>)
    
    <span class="hljs-comment"># ç›‘ç£æ¨¡å‹æŸå¤±å’Œå‡†ç¡®ç‡</span>
    ax2 = axes[<span class="hljs-number">1</span>].twinx()
    line1, = axes[<span class="hljs-number">1</span>].plot(train_losses, <span class="hljs-string">'b-'</span>, label=<span class="hljs-string">'è®­ç»ƒæŸå¤±'</span>)
    line2, = ax2.plot(val_accuracies, <span class="hljs-string">'r-'</span>, label=<span class="hljs-string">'éªŒè¯å‡†ç¡®ç‡'</span>)
    axes[<span class="hljs-number">1</span>].set_xlabel(<span class="hljs-string">'Epoch'</span>)
    axes[<span class="hljs-number">1</span>].set_ylabel(<span class="hljs-string">'æŸå¤±'</span>, color=<span class="hljs-string">'b'</span>)
    ax2.set_ylabel(<span class="hljs-string">'å‡†ç¡®ç‡'</span>, color=<span class="hljs-string">'r'</span>)
    axes[<span class="hljs-number">1</span>].set_title(<span class="hljs-string">'ç›‘ç£æ¨¡å‹è®­ç»ƒè¿‡ç¨‹'</span>)
    axes[<span class="hljs-number">1</span>].legend(handles=[line1, line2], loc=<span class="hljs-string">'upper right'</span>)
    axes[<span class="hljs-number">1</span>].grid(<span class="hljs-literal">True</span>, alpha=<span class="hljs-number">0.3</span>)
    
    plt.tight_layout()
    plt.show()
    
    <span class="hljs-comment"># å¯è§†åŒ–ä¸åŒæ–¹æ³•ç”Ÿæˆçš„embedding</span>
    visualize_embeddings(embeddings_pca, labels=target.values, method=<span class="hljs-string">"PCA"</span>, n_components=<span class="hljs-number">2</span>)
    visualize_embeddings(embeddings_ae, labels=target.values, method=<span class="hljs-string">"PCA"</span>, n_components=<span class="hljs-number">2</span>)
    visualize_embeddings(embeddings_supervised, labels=target.values, method=<span class="hljs-string">"PCA"</span>, n_components=<span class="hljs-number">2</span>)
    
    <span class="hljs-comment"># è¯„ä¼°ä¸åŒæ–¹æ³•ç”Ÿæˆçš„embedding</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>*<span class="hljs-number">60</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"PCA Embeddingè¯„ä¼°:"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span>*<span class="hljs-number">60</span>)
    evaluate_embeddings(embeddings_pca, labels=target.values)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>*<span class="hljs-number">60</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"è‡ªç¼–ç å™¨Embeddingè¯„ä¼°:"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span>*<span class="hljs-number">60</span>)
    evaluate_embeddings(embeddings_ae, labels=target.values)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>*<span class="hljs-number">60</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç›‘ç£å­¦ä¹ Embeddingè¯„ä¼°:"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span>*<span class="hljs-number">60</span>)
    evaluate_embeddings(embeddings_supervised, labels=target.values)
    
    <span class="hljs-comment"># åˆ›å»ºåŒ…å«æ‰€æœ‰embeddingçš„DataFrame</span>
    embedding_dfs = {}
    
    <span class="hljs-comment"># PCA embedding</span>
    pca_cols = [<span class="hljs-string">f"pca_dim_<span class="hljs-subst">{i}</span>"</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(embeddings_pca.shape[<span class="hljs-number">1</span>])]
    df_pca = pd.DataFrame(embeddings_pca, columns=pca_cols)
    df_pca[<span class="hljs-string">'user_id'</span>] = user_ids.values
    df_pca[<span class="hljs-string">'embedding_method'</span>] = <span class="hljs-string">'pca'</span>
    embedding_dfs[<span class="hljs-string">'pca'</span>] = df_pca
    
    <span class="hljs-comment"># è‡ªç¼–ç å™¨embedding</span>
    ae_cols = [<span class="hljs-string">f"ae_dim_<span class="hljs-subst">{i}</span>"</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(embeddings_ae.shape[<span class="hljs-number">1</span>])]
    df_ae = pd.DataFrame(embeddings_ae, columns=ae_cols)
    df_ae[<span class="hljs-string">'user_id'</span>] = user_ids.values
    df_ae[<span class="hljs-string">'embedding_method'</span>] = <span class="hljs-string">'autoencoder'</span>
    embedding_dfs[<span class="hljs-string">'autoencoder'</span>] = df_ae
    
    <span class="hljs-comment"># ç›‘ç£å­¦ä¹ embedding</span>
    supervised_cols = [<span class="hljs-string">f"supervised_dim_<span class="hljs-subst">{i}</span>"</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(embeddings_supervised.shape[<span class="hljs-number">1</span>])]
    df_supervised = pd.DataFrame(embeddings_supervised, columns=supervised_cols)
    df_supervised[<span class="hljs-string">'user_id'</span>] = user_ids.values
    df_supervised[<span class="hljs-string">'embedding_method'</span>] = <span class="hljs-string">'supervised'</span>
    embedding_dfs[<span class="hljs-string">'supervised'</span>] = df_supervised
    
    <span class="hljs-comment"># åˆå¹¶æ‰€æœ‰embedding</span>
    all_embeddings = pd.concat(embedding_dfs.values(), ignore_index=<span class="hljs-literal">True</span>)
    
    <span class="hljs-comment"># ä¿å­˜embeddingåˆ°æ–‡ä»¶</span>
    output_file = <span class="hljs-string">"user_embeddings.csv"</span>
    all_embeddings.to_csv(output_file, index=<span class="hljs-literal">False</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\næ‰€æœ‰embeddingå·²ä¿å­˜åˆ°: <span class="hljs-subst">{output_file}</span>"</span>)
    
    <span class="hljs-comment"># æ˜¾ç¤ºembeddingç¤ºä¾‹</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nPCAç”Ÿæˆçš„embeddingç¤ºä¾‹ (å‰3ä¸ªç”¨æˆ·ï¼Œå‰10ä¸ªç»´åº¦):"</span>)
    <span class="hljs-built_in">print</span>(df_pca[[<span class="hljs-string">'user_id'</span>] + pca_cols[:<span class="hljs-number">10</span>]].head(<span class="hljs-number">3</span>))
    
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">'df_users'</span>: df_users,
        <span class="hljs-string">'features'</span>: features,
        <span class="hljs-string">'embeddings'</span>: {
            <span class="hljs-string">'pca'</span>: embeddings_pca,
            <span class="hljs-string">'autoencoder'</span>: embeddings_ae,
            <span class="hljs-string">'supervised'</span>: embeddings_supervised
        },
        <span class="hljs-string">'models'</span>: {
            <span class="hljs-string">'pca'</span>: pca_model,
            <span class="hljs-string">'autoencoder'</span>: ae_model,
            <span class="hljs-string">'supervised'</span>: supervised_model
        },
        <span class="hljs-string">'embedding_dfs'</span>: embedding_dfs,
        <span class="hljs-string">'all_embeddings'</span>: all_embeddings
    }

<span class="hljs-comment"># 9. ä½¿ç”¨ç¤ºä¾‹ï¼šå¦‚ä½•æŸ¥æ‰¾ç›¸ä¼¼ç”¨æˆ·</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">find_similar_users</span>(<span class="hljs-params">user_id, embeddings_df, method=<span class="hljs-string">'pca'</span>, n_similar=<span class="hljs-number">5</span></span>):
    <span class="hljs-string">"""æŸ¥æ‰¾ä¸ç»™å®šç”¨æˆ·æœ€ç›¸ä¼¼çš„ç”¨æˆ·"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\næŸ¥æ‰¾ä¸ <span class="hljs-subst">{user_id}</span> æœ€ç›¸ä¼¼çš„ <span class="hljs-subst">{n_similar}</span> ä¸ªç”¨æˆ· (æ–¹æ³•: <span class="hljs-subst">{method}</span>)..."</span>)
    
    <span class="hljs-comment"># ç­›é€‰æŒ‡å®šæ–¹æ³•çš„embedding</span>
    method_df = embeddings_df[embeddings_df[<span class="hljs-string">'embedding_method'</span>] == method].copy()
    
    <span class="hljs-comment"># è·å–ç›®æ ‡ç”¨æˆ·çš„embedding</span>
    user_embedding = method_df[method_df[<span class="hljs-string">'user_id'</span>] == user_id].iloc[<span class="hljs-number">0</span>]
    
    <span class="hljs-comment"># æå–embeddingå‘é‡</span>
    embedding_cols = [col <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> method_df.columns <span class="hljs-keyword">if</span> <span class="hljs-string">'dim_'</span> <span class="hljs-keyword">in</span> col]
    target_vector = user_embedding[embedding_cols].values
    
    <span class="hljs-comment"># è®¡ç®—ä¸æ‰€æœ‰å…¶ä»–ç”¨æˆ·çš„ç›¸ä¼¼åº¦ï¼ˆä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦ï¼‰</span>
    similarities = []
    <span class="hljs-keyword">for</span> idx, row <span class="hljs-keyword">in</span> method_df.iterrows():
        <span class="hljs-keyword">if</span> row[<span class="hljs-string">'user_id'</span>] == user_id:
            <span class="hljs-keyword">continue</span>
        
        other_vector = row[embedding_cols].values
        <span class="hljs-comment"># è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦</span>
        similarity = np.dot(target_vector, other_vector) / (
            np.linalg.norm(target_vector) * np.linalg.norm(other_vector)
        )
        similarities.append((row[<span class="hljs-string">'user_id'</span>], similarity))
    
    <span class="hljs-comment"># æŒ‰ç›¸ä¼¼åº¦æ’åº</span>
    similarities.sort(key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">1</span>], reverse=<span class="hljs-literal">True</span>)
    
    <span class="hljs-comment"># è¿”å›æœ€ç›¸ä¼¼çš„ç”¨æˆ·</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nä¸ <span class="hljs-subst">{user_id}</span> æœ€ç›¸ä¼¼çš„ <span class="hljs-subst">{n_similar}</span> ä¸ªç”¨æˆ·:"</span>)
    <span class="hljs-keyword">for</span> i, (similar_user, similarity) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(similarities[:n_similar], <span class="hljs-number">1</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{i}</span>. <span class="hljs-subst">{similar_user}</span> (ç›¸ä¼¼åº¦: <span class="hljs-subst">{similarity:<span class="hljs-number">.4</span>f}</span>)"</span>)
    
    <span class="hljs-keyword">return</span> similarities[:n_similar]

<span class="hljs-comment"># è¿è¡Œä¸»ç¨‹åº</span>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-comment"># è¿è¡Œä¸»å‡½æ•°</span>
    results = main()
    
    <span class="hljs-comment"># æ¼”ç¤ºå¦‚ä½•æŸ¥æ‰¾ç›¸ä¼¼ç”¨æˆ·</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>*<span class="hljs-number">60</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç›¸ä¼¼ç”¨æˆ·æŸ¥æ‰¾æ¼”ç¤º"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span>*<span class="hljs-number">60</span>)
    
    <span class="hljs-comment"># ä½¿ç”¨ç¬¬ä¸€ä¸ªç”¨æˆ·ä½œä¸ºç¤ºä¾‹</span>
    sample_user = results[<span class="hljs-string">'df_users'</span>].iloc[<span class="hljs-number">0</span>][<span class="hljs-string">'user_id'</span>]
    find_similar_users(sample_user, results[<span class="hljs-string">'all_embeddings'</span>], method=<span class="hljs-string">'pca'</span>, n_similar=<span class="hljs-number">5</span>)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>*<span class="hljs-number">60</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç¨‹åºæ‰§è¡Œå®Œæˆï¼"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span>*<span class="hljs-number">60</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nç”Ÿæˆäº†ä¸‰ç§ä¸åŒç±»å‹çš„embedding:"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"1. PCA Embedding: åŸºäºçº¿æ€§é™ç»´"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"2. è‡ªç¼–ç å™¨Embedding: åŸºäºæ— ç›‘ç£æ·±åº¦å­¦ä¹ "</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"3. ç›‘ç£å­¦ä¹ Embedding: åŸºäºæœ‰ç›‘ç£ä»»åŠ¡å­¦ä¹ "</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\næ‰€æœ‰embeddingå·²ä¿å­˜åˆ° 'user_embeddings.csv' æ–‡ä»¶ä¸­ã€‚"</span>)
</code></pre>
<h2 data-id="heading-0">ä»£ç è¯´æ˜</h2>
<h3 data-id="heading-1">1. <strong>æ•°æ®ç”Ÿæˆéƒ¨åˆ†</strong></h3>
<ul>
<li>æ¨¡æ‹Ÿäº†1000ä¸ªç”¨æˆ·ï¼Œæ¯ä¸ªç”¨æˆ·æœ‰100ä¸ªç‰¹å¾</li>
<li>åŒ…å«å¤šç§æ•°æ®ç±»å‹ï¼šæ•°å€¼å‹ã€ç±»åˆ«å‹</li>
<li>ç‰¹å¾åŒ…æ‹¬ï¼šäººå£ç»Ÿè®¡ã€è¡Œä¸ºç‰¹å¾ã€åå¥½ç‰¹å¾ã€è®¾å¤‡ç‰¹å¾ã€ç¤¾äº¤ç‰¹å¾</li>
<li>åˆ›å»ºäº†æ¨¡æ‹Ÿçš„æ ‡ç­¾ï¼ˆé«˜ä»·å€¼ç”¨æˆ· vs æ™®é€šç”¨æˆ·ï¼‰</li>
</ul>
<h3 data-id="heading-2">2. <strong>ä¸‰ç§embeddingç”Ÿæˆæ–¹æ³•</strong></h3>
<ol>
<li><strong>PCAæ–¹æ³•</strong>ï¼šç®€å•çš„çº¿æ€§é™ç»´</li>
<li><strong>è‡ªç¼–ç å™¨æ–¹æ³•</strong>ï¼šæ— ç›‘ç£æ·±åº¦å­¦ä¹ ï¼Œå­¦ä¹ æ•°æ®çš„å‹ç¼©è¡¨ç¤º</li>
<li><strong>ç›‘ç£å­¦ä¹ æ–¹æ³•</strong>ï¼šåŸºäºåˆ†ç±»ä»»åŠ¡å­¦ä¹ æœ‰è¯­ä¹‰çš„embedding</li>
</ol>
<h3 data-id="heading-3">3. <strong>ä¸»è¦åŠŸèƒ½</strong></h3>
<ul>
<li>æ•°æ®é¢„å¤„ç†å’Œæ ‡å‡†åŒ–</li>
<li>æ¨¡å‹è®­ç»ƒå’Œè¯„ä¼°</li>
<li>å¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹å’Œembedding</li>
<li>è¯„ä¼°embeddingè´¨é‡</li>
<li>æŸ¥æ‰¾ç›¸ä¼¼ç”¨æˆ·</li>
<li>ä¿å­˜embeddingåˆ°CSVæ–‡ä»¶</li>
</ul>
<h3 data-id="heading-4">4. <strong>è¿è¡Œæ–¹å¼</strong></h3>
<p>ç›´æ¥è¿è¡Œè„šæœ¬å³å¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python user_embedding_generator.py
</code></pre>
<h3 data-id="heading-5">5. <strong>è¾“å‡ºç»“æœ</strong></h3>
<ul>
<li>è®­ç»ƒè¿‡ç¨‹å¯è§†åŒ–</li>
<li>embeddingæ•£ç‚¹å›¾å¯è§†åŒ–</li>
<li>embeddingè´¨é‡è¯„ä¼°æŠ¥å‘Š</li>
<li>ä¿å­˜çš„CSVæ–‡ä»¶åŒ…å«æ‰€æœ‰embedding</li>
</ul>
<h3 data-id="heading-6">6. <strong>æ‰©å±•ä½¿ç”¨</strong></h3>
<p>ä½ å¯ä»¥ï¼š</p>
<ol>
<li>ä¿®æ”¹ç”Ÿæˆçš„æ•°æ®é‡æˆ–ç‰¹å¾æ•°</li>
<li>è°ƒæ•´embeddingç»´åº¦</li>
<li>æ·»åŠ æ›´å¤šembeddingç”Ÿæˆæ–¹æ³•</li>
<li>ä½¿ç”¨çœŸå®æ•°æ®æ›¿æ¢æ¨¡æ‹Ÿæ•°æ®</li>
<li>å°†embeddingç”¨äºæ¨èç³»ç»Ÿã€ç”¨æˆ·åˆ†ç¾¤ç­‰ä¸‹æ¸¸ä»»åŠ¡</li>
</ol>
<p>è¿™ä¸ªå®Œæ•´ä»£ç å¯ä»¥ç›´æ¥è¿è¡Œï¼Œå±•ç¤ºäº†ä»æ•°æ®ç”Ÿæˆåˆ°embeddingåº”ç”¨çš„å…¨è¿‡ç¨‹ã€‚ä½ å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´å‚æ•°å’Œæ¨¡å‹æ¶æ„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LongCat-Flash-Omniï¼šç¾å›¢çš„å…¨æ¨¡æ€å¤§æ¨¡å‹]]></title>    <link>https://juejin.cn/post/7586872817876172826</link>    <guid>https://juejin.cn/post/7586872817876172826</guid>    <pubDate>2025-12-23T14:58:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586872817876172826" data-draft-id="7586872817876156442" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LongCat-Flash-Omniï¼šç¾å›¢çš„å…¨æ¨¡æ€å¤§æ¨¡å‹"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-23T14:58:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="coting"/> <meta itemprop="url" content="https://juejin.cn/user/933911964427818"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LongCat-Flash-Omniï¼šç¾å›¢çš„å…¨æ¨¡æ€å¤§æ¨¡å‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/933911964427818/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    coting
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-23T14:58:13.000Z" title="Tue Dec 23 2025 14:58:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å¤šæ¨¡æ€æµªæ½®åŠ é€Ÿçš„ 2025 å¹´ï¼Œç¾å›¢å†æ¬¡äº¤å‡ºäº†ä¸€ä»½ä»¤äººæƒŠè‰³çš„ç­”å·ã€‚<br/>
ç»§ LongCat-Flash-Chat ä¸ LongCat-Flash-Thinking ä¹‹åï¼ŒLongCat ç³»åˆ—è¿æ¥äº†æ–°æˆå‘˜â€”â€”<strong>LongCat-Flash-Omni</strong>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f0aec0ae8104432b84b84345433fb1d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767106693&amp;x-signature=RczcmmWIzSFwo%2BCyIiv9lkDOVxk%3D" alt="" loading="lazy"/></p>
<p>å®ƒä¸ä»…æ˜¯ç¾å›¢ LongCat å›¢é˜Ÿåœ¨å¤§è¯­è¨€æ¨¡å‹ä¹‹åçš„é‡è¦å‡çº§ï¼Œæ›´æ˜¯å¼€æºç¤¾åŒºé¦–æ¬¡å®ç°**â€œå…¨æ¨¡æ€è¦†ç›– + ç«¯åˆ°ç«¯æ¶æ„ + å¤§å‚æ•°é«˜æ•ˆæ¨ç†â€<strong>äºä¸€ä½“çš„æ¨¡å‹</strong>ã€‚<br/>
****Omni ä¸åªæ˜¯èƒ½â€œçœ‹å›¾â€â€œå¬å£°â€â€œè¯´è¯â€ï¼Œå®ƒæ­£åœ¨è®© AI çœŸæ­£å…·å¤‡**ç†è§£ä¸–ç•Œçš„å¤šæ„Ÿå®˜èƒ½åŠ›ã€‚</p>
<p>æ‰€æœ‰ç›¸å…³æºç ç¤ºä¾‹ã€æµç¨‹å›¾ã€æ¨¡å‹é…ç½®ä¸çŸ¥è¯†åº“æ„å»ºæŠ€å·§ï¼Œæˆ‘ä¹Ÿå°†æŒç»­æ›´æ–°åœ¨Githubï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Faicoting%2FAIHub" target="_blank" title="https://github.com/aicoting/AIHub" ref="nofollow noopener noreferrer"><strong>AIHub</strong></a>ï¼Œæ¬¢è¿å…³æ³¨æ”¶è—ï¼</p>
<h2 data-id="heading-0">ä¸€ã€ä» Flash åˆ° Omni</h2>
<p>LongCat-Flash ç³»åˆ—ä¸€ç›´ä»¥<strong>é«˜æ•ˆæ¶æ„å’Œæè‡´å“åº”é€Ÿåº¦</strong>é—»åï¼ŒOmni åˆ™åœ¨æ­¤åŸºç¡€ä¸Šï¼Œè¿ˆå‡ºäº†ä»å•ä¸€è¾“å…¥åˆ°â€œå…¨æ¨¡æ€ååŒâ€çš„ä¸€æ­¥ã€‚</p>
<p><strong>LongCat-Flash-Omni = é«˜æ•ˆæ¶æ„ + å¤šæ¨¡æ€æ„ŸçŸ¥ + å®æ—¶è¯­éŸ³äº¤äº’</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67ab8da1d0814dd19aaaa4eebdd6257c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767106693&amp;x-signature=lFBtupsOsv%2F6p%2BAhBi6ZKcUia2Y%3D" alt="" loading="lazy"/></p>
<p>å®ƒé›†æˆäº†è§†è§‰ã€éŸ³é¢‘ã€æ–‡æœ¬å’Œè§†é¢‘ç­‰å¤šç§è¾“å…¥å½¢å¼ï¼Œå¹¶é€šè¿‡åˆ›æ–°çš„ <strong>Shortcut-Connected MoEï¼ˆScMoEï¼‰æ¶æ„</strong>ï¼ˆå«é›¶è®¡ç®—ä¸“å®¶ï¼‰ï¼Œåœ¨ä¿æŒè¶…å¤§å‚æ•°è§„æ¨¡ï¼ˆæ€»å‚æ•° 5600 äº¿ï¼Œæ¿€æ´» 270 äº¿ï¼‰çš„åŒæ—¶ï¼Œå®ç°äº†æ¯«ç§’çº§ä½å»¶è¿Ÿçš„æµå¼äº¤äº’ä½“éªŒã€‚</p>
<p>è¿™æ„å‘³ç€ï¼Œå³ä½¿æ˜¯é¢å¯¹é•¿è¾¾æ•°åˆ†é’Ÿçš„éŸ³è§†é¢‘è¾“å…¥ï¼Œå®ƒä¾ç„¶èƒ½åšåˆ°<strong>å®æ—¶å“åº”ä¸è‡ªç„¶äº¤æµ</strong>ã€‚</p>
<h2 data-id="heading-1">äºŒã€ç«¯åˆ°ç«¯æ¶æ„</h2>
<p>ä¸åŒäºä¼ ç»Ÿçš„å¤šæ¨¡æ€æ¨¡å‹ï¼ˆå¾€å¾€ç”±ç‹¬ç«‹çš„æ„ŸçŸ¥å™¨ + æ–‡æœ¬æ¨¡å‹æ‹¼æ¥è€Œæˆï¼‰ï¼ŒLongCat-Flash-Omni é‡‡ç”¨äº†å®Œå…¨<strong>ç«¯åˆ°ç«¯çš„ä¸€ä½“åŒ–è®¾è®¡</strong>ï¼š</p>
<ul>
<li><strong>è§†è§‰ç¼–ç å™¨</strong>ï¼šè½»é‡é«˜æ•ˆï¼Œå‚æ•°é‡ä»…çº¦ 6 äº¿ï¼›</li>
<li><strong>éŸ³é¢‘ç¼–è§£ç å™¨</strong>ï¼šæ”¯æŒè¯­éŸ³æ„ŸçŸ¥ä¸é‡å»ºï¼Œç›´æ¥ç”Ÿæˆè‡ªç„¶è¯­éŸ³ï¼›</li>
<li><strong>æ ¸å¿ƒ LLM</strong>ï¼šç›´æ¥å¤„ç†å›¾åƒã€æ–‡æœ¬ã€è¯­éŸ³ç­‰å¤šæ¨¡æ€ tokenï¼›</li>
<li><strong>æµå¼æ¨ç†å¼•æ“</strong>ï¼šæ”¯æŒ 128K tokens ä¸Šä¸‹æ–‡ä¸ 8 åˆ†é’ŸéŸ³è§†é¢‘äº¤äº’ã€‚</li>
</ul>
<p>è¿™ç§è®¾è®¡çš„å…³é”®åœ¨äºï¼šæ‰€æœ‰æ¨¡æ€éƒ½åœ¨ç»Ÿä¸€çš„ token ç©ºé—´å†…ååŒå¤„ç†ï¼ŒLLM ä¸å†æ˜¯â€œåç«¯ç¿»è¯‘æœºâ€ï¼Œè€Œæ˜¯æˆä¸º<strong>å¤šæ¨¡æ€ä¿¡æ¯çš„ä¸­æ¢å¤„ç†å™¨</strong>ã€‚</p>
<p>å› æ­¤ï¼ŒOmni ä¸ä»…èƒ½â€œç†è§£è§†é¢‘è®²çš„æ˜¯ä»€ä¹ˆâ€ï¼Œè¿˜èƒ½åœ¨å¯¹è¯ä¸­â€œå¬æ‡‚ä½ çš„è¯­æ°”â€â€œçœ‹æ‡‚ä½ çš„è¡¨æƒ…â€ï¼Œå®ç°çœŸæ­£çš„â€œå¬ã€çœ‹ã€è¯´ã€æƒ³â€ä¸€ä½“åŒ–æ™ºèƒ½ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€æ¸è¿›å¼å¤šæ¨¡èåˆ</h2>
<p>å…¨æ¨¡æ€æ¨¡å‹çš„æœ€å¤§éš¾é¢˜æ˜¯â€”â€”ä¸åŒæ¨¡æ€çš„æ•°æ®åˆ†å¸ƒå®Œå…¨ä¸åŒã€‚Omni çš„è§£å†³æ€è·¯æ˜¯ <strong>æ¸è¿›å¼æ—©æœŸå¤šæ¨¡èåˆè®­ç»ƒï¼ˆProgressive Early Fusionï¼‰</strong>ã€‚</p>
<p>å®ƒæŠŠå¤æ‚çš„å¤šæ¨¡æ€å­¦ä¹ è¿‡ç¨‹åˆ†ä¸ºå…­ä¸ªé˜¶æ®µï¼Œä»è¯­è¨€å‡ºå‘ï¼Œé€æ­¥èå…¥å¬è§‰ä¸è§†è§‰èƒ½åŠ›ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3374f4335acb465da53cb4119ea93d87~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767106693&amp;x-signature=MsHcmYEngmrjZT6r69s5GL1VjbE%3D" alt="" loading="lazy"/></p>
<ol>
<li><strong>é˜¶æ®µ 0ï¼šæ–‡æœ¬é¢„è®­ç»ƒ</strong> â€”â€” å¥ å®šè¯­è¨€ç†è§£åŸºç¡€ï¼›</li>
<li><strong>é˜¶æ®µ 1ï¼šè¯­éŸ³å¼•å…¥</strong> â€”â€” å¯¹é½å£°å­¦è¡¨å¾ä¸è¯­è¨€ç‰¹å¾ç©ºé—´ï¼›</li>
<li><strong>é˜¶æ®µ 2ï¼šå›¾æ–‡èåˆ</strong> â€”â€” åŠ å…¥å¤§è§„æ¨¡å›¾åƒ-æ–‡æœ¬å¯¹é½è¯­æ–™ï¼›</li>
<li><strong>é˜¶æ®µ 3ï¼šè§†é¢‘ç†è§£</strong> â€”â€” å¼•å…¥åŠ¨æ€è§†é¢‘æ•°æ®ï¼Œæå‡æ—¶ç©ºæ¨ç†ï¼›</li>
<li><strong>é˜¶æ®µ 4ï¼šä¸Šä¸‹æ–‡æ‰©å±•</strong> â€”â€” ä¸Šä¸‹æ–‡çª—å£æ‹“å±•è‡³ 128K tokensï¼›</li>
<li><strong>é˜¶æ®µ 5ï¼šè¯­éŸ³å¯¹é½è®­ç»ƒ</strong> â€”â€” ç¼“è§£ç¦»æ•£ token ä¿¡æ¯ä¸¢å¤±ï¼Œæå‡è¯­éŸ³ä¿çœŸåº¦ã€‚</li>
</ol>
<p>è¿™ç§â€œé€å±‚æ³¨å…¥â€ç­–ç•¥è®© Omni åœ¨ä¿æŒç¨³å®šæ–‡æœ¬èƒ½åŠ›çš„åŒæ—¶ï¼Œå®ç°äº†<strong>çœŸæ­£çš„å…¨æ¨¡æ€ååŒ</strong>ï¼Œå„æ¨¡æ€ä¹‹é—´ä¸å†ç›¸äº’ç‰µåˆ¶ï¼Œè€Œæ˜¯äº’ç›¸å¢å¼ºã€‚</p>
<h2 data-id="heading-3">å››ã€æ€§èƒ½</h2>
<p>åœ¨ç»¼åˆè¯„ä¼°ï¼ˆOmni-Benchã€WorldSenseï¼‰ä¸­ï¼ŒLongCat-Flash-Omni è¾¾åˆ°äº†å¼€æºæœ€å…ˆè¿›æ°´å¹³ï¼ˆSOTAï¼‰ã€‚<br/>
å…¶å•æ¨¡æ€ä¸è·¨æ¨¡æ€è¡¨ç°åŒæ ·äº®çœ¼ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0530a62ea39a49bcad6d26b44df6c750~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767106693&amp;x-signature=1NK7XZ2OeoS92BcA0qpNrmAg5ug%3D" alt="" loading="lazy"/></p>
<p>ä¸ä»…å¦‚æ­¤ï¼ŒOmni åœ¨ç«¯åˆ°ç«¯äº¤äº’è¯„åˆ†ä¸­ä¹Ÿè¡¨ç°çªå‡ºï¼Œåœ¨ 250 åç”¨æˆ·ä¸ 10 åä¸“å®¶è¯„æµ‹ä¸­ï¼Œå…¶è‡ªç„¶åº¦ä¸æµç•…åº¦æ¯”å½“å‰æœ€ä¼˜å¼€æºæ¨¡å‹ <strong>Qwen3-Omni é«˜å‡º 0.56 åˆ†</strong>ï¼Œæ¥è¿‘é—­æºæ——èˆ° <strong>Gemini-2.5-Pro</strong> çš„å®æ—¶äº¤äº’ä½“éªŒã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b78e12bb53f14c07a1956049616e4060~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767106693&amp;x-signature=eRYpuZi5gkKKrK0c0dQLrLIDYw0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">äº”ã€é«˜æ•ˆæ¨ç†</h2>
<p>Omni çš„å¦ä¸€é¡¹æ ¸å¿ƒçªç ´ï¼Œæ˜¯åœ¨ 5600 äº¿å‚æ•°è§„æ¨¡ä¸‹ä¾ç„¶ä¿æŒæ¯«ç§’çº§å“åº”ï¼Œç§˜è¯€åœ¨äº ScMoEï¼ˆShortcut-Connected Mixture of Expertsï¼‰æ¶æ„ä¸â€œé›¶è®¡ç®—ä¸“å®¶â€çš„ç»„åˆã€‚</p>
<ul>
<li>ScMoE è®©æ¨¡å‹åªæ¿€æ´»éƒ¨åˆ†ä¸“å®¶ï¼ˆçº¦ 270 äº¿å‚æ•°ï¼‰ï¼Œæå¤§é™ä½è®¡ç®—æˆæœ¬ï¼›</li>
<li>â€œé›¶è®¡ç®—ä¸“å®¶â€è®©è·¯ç”±å±‚å¯ä»¥å¿«é€Ÿè·³è¿‡å†—ä½™åˆ†æ”¯ï¼Œå®ç°æµå¼å¤„ç†ï¼›</li>
<li>ç»“åˆâ€œåˆ†å—å¼éŸ³è§†é¢‘ç‰¹å¾äº¤ç»‡æœºåˆ¶â€ï¼Œä¿è¯éŸ³è§†é¢‘å¤„ç†çš„è¿ç»­æ€§ä¸ä½å»¶è¿Ÿã€‚</li>
</ul>
<p>æœ€ç»ˆï¼ŒOmni æˆä¸ºé¦–ä¸ªåœ¨å¼€æºèŒƒç•´å†…å®ç°**â€œå¤§æ¨¡å‹ + å®æ—¶äº¤äº’â€**çš„ç³»ç»Ÿã€‚</p>
<p>LongCat-Flash-Omni çš„å‡ºç°æ ‡å¿—ç€ä¸€ä¸ªè½¬æŠ˜ç‚¹ï¼ŒAI ä¸å†åªæ˜¯è¯­è¨€ä¸“å®¶ï¼Œè€Œæ˜¯ä¸€ä¸ªèƒ½çœŸæ­£â€œæ„ŸçŸ¥ä¸–ç•Œâ€çš„å¤šæ¨¡æ€æ™ºèƒ½ä½“ï¼Œå®ƒèƒ½çœ‹å›¾ã€èƒ½å¬å£°ã€èƒ½ç†è§£è¯­æ°”ã€èƒ½ç”Ÿæˆè¯­éŸ³ï¼Œå¹¶åœ¨åŒä¸€æ¡†æ¶ä¸‹å®Œæˆè·¨æ¨¡æ€æ¨ç†ã€‚</p>
<p>è¿™ä¸åªæ˜¯ä¸€æ¬¡æŠ€æœ¯å‡çº§ï¼Œæ›´æ˜¯ä¸–ç•Œæ¨¡å‹æ–¹å‘çš„åˆä¸€æ¬¡é‡è¦è·ƒè¿ï¼š<strong>ä»ç†è§£æ–‡å­— â†’ ç†è§£æ„Ÿå®˜ â†’ ç†è§£ä¸–ç•Œã€‚</strong></p>
<p>å½“ AI æ‹¥æœ‰äº†å¤šæ¨¡æ€æ„ŸçŸ¥èƒ½åŠ›ï¼Œå®ƒä¹Ÿå°±æ‹¥æœ‰äº†é€šå‘å…·èº«æ™ºèƒ½çš„æ„ŸçŸ¥æ¥å£ï¼Œå¤šæ¨¡æ€æ™ºèƒ½æ­£åœ¨ä»åŠŸèƒ½å åŠ èµ°å‘ç»Ÿä¸€ç†è§£ã€‚</p>
<p>å…³äºæ·±åº¦å­¦ä¹ å’Œå¤§æ¨¡å‹ç›¸å…³çš„çŸ¥è¯†å’Œå‰æ²¿æŠ€æœ¯æ›´æ–°ï¼Œè¯·å…³æ³¨å…¬ä¼—å·cotingï¼</p>
<p>ğŸ“š <strong>æ¨èé˜…è¯»</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1961825568644401081" target="_blank" title="https://zhuanlan.zhihu.com/p/1961825568644401081" ref="nofollow noopener noreferrer">LongCat-Flashï¼šç¾å›¢å‡ºæ‰‹ï¼Œå›½äº§å¡ä¸Šè·‘å‡ºçš„ã€Œé—ªç”µçº§ã€å¤§æ¨¡å‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1966265102568265354" target="_blank" title="https://zhuanlan.zhihu.com/p/1966265102568265354" ref="nofollow noopener noreferrer">ç¾å›¢å‘åŠ›ï¼ŒLongCat-Videoå‘å¸ƒï¼</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[TypeScript ä¸­ Type å’Œ Interface å‚»å‚»åˆ†ä¸æ¸…ï¼Ÿçœ‹å®Œè¿™ç¯‡å°±ä¸çº ç»“äº†]]></title>    <link>https://juejin.cn/post/7586877892468752411</link>    <guid>https://juejin.cn/post/7586877892468752411</guid>    <pubDate>2025-12-24T01:53:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586877892468752411" data-draft-id="7586901995430248457" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="TypeScript ä¸­ Type å’Œ Interface å‚»å‚»åˆ†ä¸æ¸…ï¼Ÿçœ‹å®Œè¿™ç¯‡å°±ä¸çº ç»“äº†"/> <meta itemprop="keywords" content="å‰ç«¯,TypeScript"/> <meta itemprop="datePublished" content="2025-12-24T01:53:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å…‰å¤´è€çŸ³"/> <meta itemprop="url" content="https://juejin.cn/user/2963939077135006"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            TypeScript ä¸­ Type å’Œ Interface å‚»å‚»åˆ†ä¸æ¸…ï¼Ÿçœ‹å®Œè¿™ç¯‡å°±ä¸çº ç»“äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2963939077135006/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å…‰å¤´è€çŸ³
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T01:53:03.000Z" title="Wed Dec 24 2025 01:53:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ æ˜¯ä¸æ˜¯ä¹Ÿæœ‰è¿‡è¿™æ ·çš„å›°æƒ‘ï¼š</p>
<p>æ‰“å¼€ä¸€ä¸ªè€é¡¹ç›®ï¼Œæˆ–è€…åœ¨åš Code Review æ—¶ï¼Œå‘ç°ä»£ç é‡Œä¸€ä¼šå„¿æ˜¯ <code>interface Props</code>ï¼Œä¸€ä¼šå„¿åˆæ˜¯ <code>type State</code>ã€‚é—®åŒäº‹ä¸ºä»€ä¹ˆè¦æ··ç”¨ï¼Œä»–ä¹Ÿæ”¯æ”¯å¾å¾è¯´ä¸å‡ºä¸ªæ‰€ä»¥ç„¶ï¼Œæœ€ååªèƒ½æ¥ä¸€å¥ï¼šâ€œå“å‘€ï¼Œåæ­£éƒ½èƒ½è·‘ï¼Œçœ‹å¿ƒæƒ…å‘—ã€‚â€</p>
<p><strong>ä½†åœ¨ TypeScript çš„ä¸–ç•Œé‡Œï¼Œâ€œèƒ½è·‘â€å’Œâ€œå†™å¾—å¥½â€æ˜¯ä¸¤ç äº‹ã€‚</strong></p>
<p><code>type</code>ï¼ˆç±»å‹åˆ«åï¼‰å’Œ <code>interface</code>ï¼ˆæ¥å£ï¼‰è¿™å¯¹åŒèƒèƒï¼Œåœ¨ TS è¯ç”Ÿä¹‹åˆå°±ä¸€ç›´ç›¸çˆ±ç›¸æ€ã€‚å®ƒä»¬ç¡®å®å¤ªåƒäº†ï¼Œåƒåˆ°åœ¨ç»å¤§å¤šæ•° CRUD ä¸šåŠ¡å¼€å‘ä¸­ï¼Œä½ é—­ç€çœ¼éšä¾¿é€‰ä¸€ä¸ªéƒ½ä¸ä¼šæŠ¥é”™ã€‚</p>
<p>ä½†æ˜¯ï¼Œä½œä¸ºä¸€ä¸ªè¿½æ±‚ä»£ç è´¨é‡çš„å¼€å‘è€…ï¼Œæˆ‘ä»¬ä¸èƒ½æ­¢æ­¥äºæ­¤ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬è·³å‡ºè¡¨é¢çš„è¯­æ³•ç³–ï¼Œä»åº•å±‚æœºåˆ¶å…¥æ‰‹ï¼Œå½»åº•ææ¸…æ¥šå®ƒä»¬çš„æœ¬è´¨åŒºåˆ«ï¼Œå¹¶ç»™ä½ ä¸€å¥—<strong>æœ€ä½³å®è·µæ–¹æ¡ˆ</strong>ã€‚æ‹’ç»é€‰æ‹©å›°éš¾ç—‡ã€‚</p>
<h3 data-id="heading-0">1. è¡¨è±¡ï¼š90% çš„é‡åˆåº¦ä¸å…¶è¯¯åŒº</h3>
<p>ä¸ºä»€ä¹ˆå¤§å®¶ä¼šçº ç»“ï¼Ÿå› ä¸ºåœ¨å®šä¹‰â€œå¯¹è±¡â€çš„å½¢çŠ¶ï¼ˆShapeï¼‰æ—¶ï¼Œå®ƒä»¬é•¿å¾—å‡ ä¹ä¸€æ¨¡ä¸€æ ·ã€‚</p>
<p>çœ‹çœ‹ä¸‹é¢çš„ä»£ç ï¼Œä½ èƒ½ä¸€çœ¼çœ‹å‡ºåŒºåˆ«å—ï¼Ÿ</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä½¿ç”¨ interface</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserI</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;
}

<span class="hljs-comment">// ä½¿ç”¨ type</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">UserT</span> = {
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;
}
</code></pre>
<p>åœ¨æ—¥å¸¸ä½¿ç”¨ä¸­ï¼Œå¦‚æœä½ æƒ³å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ–è€…åœ¨å‡½æ•°å‚æ•°ä¸­çº¦æŸç±»å‹ï¼Œè¿™ä¿©å…„å¼Ÿçš„è¡¨ç°æ˜¯<strong>å®Œå…¨ä¸€è‡´</strong>çš„ã€‚å®ƒä»¬éƒ½æ”¯æŒï¼š</p>
<ul>
<li>å®šä¹‰å¯¹è±¡ç»“æ„</li>
<li>å®šä¹‰å‡½æ•°ç­¾å</li>
<li>æ”¯æŒæ³›å‹</li>
<li>æ”¯æŒç±»ï¼ˆClassï¼‰çš„å®ç°ï¼ˆimplementsï¼‰</li>
</ul>
<p>ä½†è¿™æ­£æ˜¯æ–°æ‰‹å®¹æ˜“é™·å…¥çš„è¯¯åŒºï¼š<strong>ä»¥ä¸ºå®ƒä»¬æ˜¯å¯ä»¥éšæ„äº’æ¢çš„åŒä¹‰è¯ã€‚</strong> å®é™…ä¸Šï¼ŒTS è®¾è®¡è¿™ä¸¤ä¸ªæ¦‚å¿µï¼Œæ˜¯ä¸ºäº†è§£å†³å®Œå…¨ä¸åŒçš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-1">2. æ ¸å¿ƒï¼šå£°æ˜åˆå¹¶ã€ç±»å‹è¡¨è¾¾ä¸æ‰©å±•æ€§</h3>
<p>åŒºåˆ«ä¸ä»…å­˜åœ¨ï¼Œè€Œä¸”åœ¨å…³é”®æ—¶åˆ»å†³å®šäº†ä½ çš„æ¶æ„è®¾è®¡æ˜¯å¦åˆç†ã€‚ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹ä¸‰ä¸ªæ ¸å¿ƒç»´åº¦ï¼š</p>
<h3 data-id="heading-2">2.1 å£°æ˜åˆå¹¶ (Declaration Merging) â€”â€” Interface çš„å¿…æ€æŠ€</h3>
<p>è¿™æ˜¯ <code>interface</code> ç‹¬æœ‰çš„ç‰¹æ€§ï¼Œä¹Ÿæ˜¯å®ƒå­˜åœ¨çš„æœ€å¤§ç†ç”±ã€‚</p>
<p>åœºæ™¯æ¨¡æ‹Ÿï¼š</p>
<p>ä½ å¼•å…¥äº†ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼ˆæ¯”å¦‚ Vue æˆ– jQueryï¼‰ï¼Œä½†ä½ å‘ç°å®ƒçš„å…¨å±€å¯¹è±¡ä¸Šå°‘äº†ä¸€ä¸ªä½ éœ€è¦çš„å±æ€§ã€‚è¿™æ—¶ï¼Œå¦‚æœä½ ç”¨ interfaceï¼Œä½ å¯ä»¥ç›´æ¥åœ¨è‡ªå·±çš„ä»£ç é‡Œâ€œè¡¥â€ä¸Šè¿™ä¸ªå±æ€§ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å‡è®¾è¿™æ˜¯ç¬¬ä¸‰æ–¹åº“å®šä¹‰çš„ interface</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">User</span> {
  name: string;
}

<span class="hljs-comment">// ä½ çš„ä»£ç ä¸­å†æ¬¡å®šä¹‰åŒå interface</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">User</span> {
  age: number;
}

<span class="hljs-comment">// âœ¨ TS ä¼šè‡ªåŠ¨æŠŠå®ƒä»¬ç¼åˆåœ¨ä¸€èµ·ï¼</span>
<span class="hljs-keyword">const</span> me: User = {
  name: <span class="hljs-string">"Gemini"</span>,
  age: <span class="hljs-number">18</span> <span class="hljs-comment">// å¿…é¡»ä¸¤ä¸ªå±æ€§éƒ½æœ‰ï¼Œå¦åˆ™æŠ¥é”™</span>
};
</code></pre>
<p>åè§‚ typeï¼š</p>
<p>å®ƒæ˜¯å°é—­çš„ï¼ˆClosedï¼‰ã€‚ä¸€æ—¦å®šä¹‰ï¼Œæ— æ³•é€šè¿‡åŒåæ–¹å¼ä¿®æ”¹ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">type <span class="hljs-attr">User</span> = {
  name: string<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

// âŒ æŠ¥é”™ï¼šDuplicate identifier 'User'.
type <span class="hljs-attr">User</span> = {
  age: number<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<p><strong>ğŸ’¡ ç»“è®ºï¼š</strong> <code>interface</code> å…·æœ‰å¼€æ”¾æ€§ï¼Œå…è®¸åç»­æ‰©å±•ï¼›è€Œ <code>type</code> å…·æœ‰å°é—­æ€§ï¼Œæ›´é€‚åˆç¡®å®šçš„ä¸šåŠ¡é€»è¾‘ã€‚</p>
<h3 data-id="heading-3">2.2 ç±»å‹è¡¨è¾¾èƒ½åŠ› â€”â€” Type çš„ä¸»åœº</h3>
<p><code>type</code> çš„å…¨ç§°æ˜¯ <strong>Type Aliasï¼ˆç±»å‹åˆ«åï¼‰</strong> ã€‚æ—¢ç„¶æ˜¯åˆ«åï¼Œå®ƒå°±èƒ½ç»™<strong>ä»»ä½•ä¸œè¥¿</strong>èµ·åå­—ï¼Œä¸ä»…ä»…æ˜¯å¯¹è±¡ã€‚</p>
<p>åœ¨å¤„ç†å¤æ‚ç±»å‹æ—¶ï¼ŒType çš„çµæ´»æ€§å®Œèƒœ Interfaceï¼š</p>
<ul>
<li>
<p><strong>è”åˆç±»å‹ (Union Types)ï¼š</strong> å‰ç«¯å¼€å‘ä¸­æœ€å¸¸ç”¨çš„åŠŸèƒ½ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">type <span class="hljs-attr">Status</span> = <span class="hljs-string">'pending'</span> | <span class="hljs-string">'success'</span> | <span class="hljs-string">'failed'</span><span class="hljs-comment">;</span>
type <span class="hljs-attr">ID</span> = string | number<span class="hljs-comment">;</span>
</code></pre>
<p><em>Interface æ— æ³•ç›´æ¥å®šä¹‰è¿™ç§â€œæˆ–â€çš„å…³ç³»ã€‚</em></p>
</li>
<li>
<p><strong>å…ƒç»„ (Tuple)ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">type <span class="hljs-attr">Point</span> = [number, number]<span class="hljs-comment">;</span>
</code></pre>
</li>
<li>
<p>ç±»å‹ä½“æ“ï¼š</p>
<p>å½“ä½ ä½¿ç”¨ Pickã€Omitã€Record æˆ–è€…æ¡ä»¶ç±»å‹ï¼ˆConditional Typesï¼‰æ—¶ï¼Œäº§å‡ºçš„ç»“æœé€šå¸¸éƒ½æ˜¯ typeã€‚</p>
</li>
</ul>
<h3 data-id="heading-4">2.3 æ‰©å±•æ–¹å¼ï¼šExtends vs Intersection</h3>
<p>è™½ç„¶ä¸¤è€…éƒ½èƒ½å®ç°â€œç»§æ‰¿â€çš„æ•ˆæœï¼Œä½†è¯­ä¹‰ä¸åŒã€‚</p>
<ul>
<li><strong>Interface ä½¿ç”¨ <code>extends</code></strong>ï¼šä¾§é‡äºé¢å‘å¯¹è±¡çš„å±‚çº§ç»§æ‰¿ã€‚</li>
<li><strong>Type ä½¿ç”¨ <code>&amp;</code> (äº¤å‰ç±»å‹)</strong> ï¼šä¾§é‡äºé›†åˆçš„åˆå¹¶ã€‚</li>
</ul>
<p>è™½ç„¶é€šå¸¸å¯ä»¥äº’é€šï¼Œä½†åœ¨å¤„ç†å†²çªå±æ€§æ—¶ï¼Œ<code>interface</code> ä¼šç›´æ¥æŠ¥é”™æé†’ï¼Œè€Œäº¤å‰ç±»å‹ï¼ˆ<code>&amp;</code>ï¼‰å¯èƒ½ä¼šäº§ç”Ÿ <code>never</code> ç±»å‹ï¼Œå¯¼è‡´é”™è¯¯æç¤ºä¸å¤Ÿç›´è§‚ã€‚</p>
<hr/>
<h3 data-id="heading-5">3. è§„èŒƒï¼šä¸€å¥—æ‹¿æ¥å³ç”¨çš„æœ€ä½³å®è·µ</h3>
<p>è®²äº†è¿™ä¹ˆå¤šç†è®ºï¼Œå›åˆ°æœ€åˆçš„é—®é¢˜ï¼š<strong>æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­åˆ°åº•è¯¥æ€ä¹ˆé€‰ï¼Ÿ</strong></p>
<p>ä¸å…¶æ¯æ¬¡éƒ½çº ç»“ï¼Œä¸å¦‚éµå¾ªè¿™å¥—ç®€å•çš„ <strong>â€œäºŒé€‰ä¸€æ³•åˆ™â€</strong> ï¼Œè¿™ä¹Ÿç¬¦åˆç›®å‰ä¸»æµå¤§å‚ï¼ˆå¦‚ Google è§„èŒƒï¼‰å’Œ React ç¤¾åŒºçš„æ¨èè¶‹åŠ¿ï¼š</p>
<h3 data-id="heading-6">åœºæ™¯ä¸€ï¼šä½ åœ¨ç¼–å†™åº“ (Library) æˆ–ç¬¬ä¸‰æ–¹åŒ…</h3>
<p><strong>è¯·ä¼˜å…ˆä½¿ç”¨ <code>interface</code>ã€‚</strong></p>
<p><strong>ç†ç”±ï¼š</strong> ä½œä¸ºåº“çš„ä½œè€…ï¼Œä½ éœ€è¦ä¸ºä½ çš„ç”¨æˆ·ç•™å‡ºâ€œåè·¯â€ã€‚ç”¨æˆ·å¯èƒ½éœ€è¦åˆ©ç”¨â€œå£°æ˜åˆå¹¶â€çš„ç‰¹æ€§ï¼Œå‘ä½ çš„å…¨å±€æ¥å£ä¸­æ³¨å…¥è‡ªå®šä¹‰å±æ€§ï¼ˆæ¯”å¦‚æ‰©å±• <code>Window</code> å¯¹è±¡æˆ–ç»™ <code>Request</code> å¯¹è±¡å¢åŠ  <code>user</code> å­—æ®µï¼‰ã€‚ä½¿ç”¨ Interface æ˜¯å¯¹ä½¿ç”¨è€…çš„å°Šé‡ã€‚</p>
<h3 data-id="heading-7">åœºæ™¯äºŒï¼šä½ åœ¨ç¼–å†™ä¸šåŠ¡åº”ç”¨ (Application / UI ç»„ä»¶)</h3>
<p><strong>è¯·ä¼˜å…ˆä½¿ç”¨ <code>type</code>ã€‚</strong></p>
<p><strong>ç†ç”±ï¼š</strong></p>
<ol>
<li><strong>ä¸€è‡´æ€§ (Consistency)ï¼š</strong> æ—¢ç„¶ <code>type</code> èƒ½æå®šå¯¹è±¡ã€è”åˆç±»å‹ã€å…ƒç»„ç­‰æ‰€æœ‰æƒ…å†µï¼Œè€Œ <code>interface</code> åªèƒ½æå®šå¯¹è±¡ï¼Œé‚£ä¹ˆå…¨å‘˜ä½¿ç”¨ <code>type</code> å¯ä»¥è®©ä»£ç é£æ ¼æ›´ç»Ÿä¸€ã€‚</li>
<li><strong>å®‰å…¨æ€§ (Safety)ï¼š</strong> åœ¨ä¸šåŠ¡ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¸å¸Œæœ›å®šä¹‰å¥½çš„ç±»å‹è¢«è«åå…¶å¦™åœ°â€œè‡ªåŠ¨åˆå¹¶â€äº†ï¼ˆè¿™æ˜¯éšæ‚£ï¼‰ã€‚<code>type</code> çš„æŠ¥é”™æé†’èƒ½è®©ä½ æ›´å®‰å…¨ã€‚</li>
<li><strong>React ç”Ÿæ€ï¼š</strong> ç°åœ¨çš„ React ç¤¾åŒºæ›´å€¾å‘äºç”¨ <code>type</code> æ¥å®šä¹‰ <code>Props</code> å’Œ <code>State</code>ï¼Œå› ä¸ºå®ƒåœ¨å¤„ç†ç»„ä»¶å¤åˆç±»å‹æ—¶æ›´åŠ ç›´è§‚ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-8">æ€»ç»“</h3>
<p>ä¸ºäº†æ–¹ä¾¿è®°å¿†ï¼Œæˆ‘åšäº†ä¸€å¼ å¯¹æ¯”é€ŸæŸ¥è¡¨ï¼š</p>



































<table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>Interface</strong></th><th><strong>Type</strong></th></tr></thead><tbody><tr><td><strong>æ ¸å¿ƒç†å¿µ</strong></td><td>æè¿°å¯¹è±¡çš„å½¢çŠ¶ (Shape)</td><td>ä»»ä½•ç±»å‹çš„åˆ«å (Alias)</td></tr><tr><td><strong>å£°æ˜åˆå¹¶</strong></td><td>âœ… <strong>æ”¯æŒ (è‡ªåŠ¨åˆå¹¶)</strong></td><td>âŒ ä¸æ”¯æŒ (ä¼šæŠ¥é”™)</td></tr><tr><td>**è”åˆç±»å‹ (</td><td>)**</td><td>âŒ ä¸æ”¯æŒ</td></tr><tr><td><strong>æ˜ å°„/æ¡ä»¶ç±»å‹</strong></td><td>âŒ ä¸æ”¯æŒ</td><td>âœ… æ”¯æŒ</td></tr><tr><td><strong>æœ€ä½³ä½¿ç”¨åœºæ™¯</strong></td><td><strong>ç¼–å†™åº“ (Library)</strong></td><td><strong>ç¼–å†™åº”ç”¨ (App)</strong></td></tr></tbody></table>
<p>ä¸€å¥è¯å£è¯€ï¼š</p>
<p>å¯¹å¤– APIï¼ˆåº“ï¼‰ç”¨ Interfaceï¼Œå¯¹å†…ä¸šåŠ¡é€»è¾‘ç”¨ Typeã€‚å¦‚æœä½ å®åœ¨æ‹¿ä¸å‡†ï¼Œå°±ç”¨ Typeï¼Œç›´åˆ°ä½ å¿…é¡»ç”¨ Interface ä¸ºæ­¢ã€‚</p>
<p>ä½ ä»¬å›¢é˜Ÿçš„ä»£ç è§„èŒƒé‡Œï¼Œæ˜¯å¼ºåˆ¶ç”¨ <code>type</code> è¿˜æ˜¯ <code>interface</code>ï¼Ÿè¿˜æ˜¯åƒå¤§éƒ¨åˆ†é¡¹ç›®ä¸€æ ·â€œéšç¼˜æ··ç”¨â€ï¼Ÿ</p>
<p>æ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œæˆ‘ä»¬ä¸€èµ·èŠèŠ TS é‡Œçš„é‚£äº›å‘ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Kubernetes é›†ç¾¤éƒ¨ç½²è¯¦ç»†æ•™ç¨‹ï¼škubeadm å• Master / é«˜å¯ç”¨éƒ¨ç½²å®æ“]]></title>    <link>https://juejin.cn/post/7586943543018635306</link>    <guid>https://juejin.cn/post/7586943543018635306</guid>    <pubDate>2025-12-23T14:11:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586943543018635306" data-draft-id="7586940555404329001" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kubernetes é›†ç¾¤éƒ¨ç½²è¯¦ç»†æ•™ç¨‹ï¼škubeadm å• Master / é«˜å¯ç”¨éƒ¨ç½²å®æ“"/> <meta itemprop="keywords" content="è¿ç»´"/> <meta itemprop="datePublished" content="2025-12-23T14:11:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åˆšå“¥çš„è¿›åŒ–è·¯"/> <meta itemprop="url" content="https://juejin.cn/user/71892859621675"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kubernetes é›†ç¾¤éƒ¨ç½²è¯¦ç»†æ•™ç¨‹ï¼škubeadm å• Master / é«˜å¯ç”¨éƒ¨ç½²å®æ“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/71892859621675/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åˆšå“¥çš„è¿›åŒ–è·¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-23T14:11:58.000Z" title="Tue Dec 23 2025 14:11:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨äº‘åŸç”Ÿæ—¶ä»£ï¼ŒKubernetesï¼ˆç®€ç§° K8sï¼‰ä½œä¸ºå®¹å™¨ç¼–æ’å¹³å°çš„äº‹å®æ ‡å‡†ï¼Œå…¶é›†ç¾¤éƒ¨ç½²æ˜¯è¿ç»´å’Œå¼€å‘äººå‘˜çš„æ ¸å¿ƒæŠ€èƒ½ã€‚æœ¬æ–‡åŸºäº <strong>Ubuntu 22.04 LTS</strong> ç³»ç»Ÿï¼Œè¯¦ç»†è®²è§£ä¸¤ç§ä¸»æµéƒ¨ç½²æ–¹æ¡ˆï¼š<strong>å• Master é›†ç¾¤ï¼ˆå¿«é€Ÿæµ‹è¯•ï¼‰</strong> å’Œ <strong>å¤š Master é«˜å¯ç”¨é›†ç¾¤ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰</strong>ï¼Œé‡‡ç”¨å®˜æ–¹æ¨èçš„<code>kubeadm</code>å·¥å…·ï¼Œæ­é…<code>containerd</code>å®¹å™¨è¿è¡Œæ—¶ï¼Œå…¨ç¨‹æ­¥éª¤å¯å¤ç°ï¼Œæ–°æ‰‹ä¹Ÿèƒ½é¡ºåˆ©å®Œæˆéƒ¨ç½²ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€éƒ¨ç½²å‰æ ¸å¿ƒå‡†å¤‡ï¼šç¯å¢ƒè¦æ±‚ä¸åŸºç¡€é…ç½®</h2>
<h3 data-id="heading-1">1. ç³»ç»Ÿä¸ç¡¬ä»¶è¦æ±‚</h3>






























<table><thead><tr><th>èŠ‚ç‚¹ç±»å‹</th><th>ç¡¬ä»¶é…ç½®å»ºè®®</th><th>ç³»ç»Ÿè¦æ±‚</th></tr></thead><tbody><tr><td>Master èŠ‚ç‚¹</td><td>2 æ ¸ 4G ä»¥ä¸Šå†…å­˜ï¼Œ20G + ç¡¬ç›˜</td><td>Ubuntu 22.04 LTSï¼ˆ64 ä½ï¼‰</td></tr><tr><td>Node èŠ‚ç‚¹</td><td>2 æ ¸ 2G ä»¥ä¸Šå†…å­˜ï¼Œ20G + ç¡¬ç›˜</td><td>Ubuntu 22.04 LTSï¼ˆ64 ä½ï¼‰</td></tr><tr><td>é«˜å¯ç”¨ Master èŠ‚ç‚¹</td><td>3 ä¸ªèŠ‚ç‚¹ï¼Œæ¯èŠ‚ç‚¹ 2 æ ¸ 4G ä»¥ä¸Š</td><td>åŒå• Master ç³»ç»Ÿè¦æ±‚</td></tr><tr><td>ç½‘ç»œè¦æ±‚</td><td>æ‰€æœ‰èŠ‚ç‚¹äº’é€šï¼Œå¤–ç½‘å¯è®¿é—®ï¼ˆæ‹‰å–é•œåƒï¼‰</td><td>å…³é—­é˜²ç«å¢™ / å¼€æ”¾å¿…è¦ç«¯å£</td></tr></tbody></table>
<h3 data-id="heading-2">2. åŸºç¡€ç¯å¢ƒé…ç½®ï¼ˆæ‰€æœ‰èŠ‚ç‚¹æ‰§è¡Œï¼‰</h3>
<h4 data-id="heading-3">ï¼ˆ1ï¼‰å…³é—­é˜²ç«å¢™ä¸ SELinux</h4>
<p>K8s é›†ç¾¤å†…éƒ¨éœ€è¦å¤§é‡ç«¯å£é€šä¿¡ï¼Œæ–°æ‰‹å»ºè®®ç›´æ¥å…³é—­é˜²ç«å¢™ï¼ˆç”Ÿäº§ç¯å¢ƒå¯æŒ‰éœ€å¼€æ”¾ç«¯å£ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">\ å…³é—­Ubuntué˜²ç«å¢™ï¼ˆUFWï¼‰

sudo ufw <span class="hljs-built_in">disable</span>

\ éªŒè¯é˜²ç«å¢™çŠ¶æ€ï¼ˆè¾“å‡ºinactiveå³ä¸ºå…³é—­ï¼‰

sudo ufw status

\ å…³é—­SELinuxï¼ˆUbuntué»˜è®¤æœªå®‰è£…ï¼Œå¯è·³è¿‡ï¼›CentOSéœ€æ‰§è¡Œï¼‰

\ sudo setenforce 0

\ sudo sed -i <span class="hljs-string">'s/^SELINUX=enforcing\$/SELINUX=permissive/'</span> /etc/selinux/config
</code></pre>
<h4 data-id="heading-4">ï¼ˆ2ï¼‰ç¦ç”¨ Swap åˆ†åŒºï¼ˆK8s å¼ºåˆ¶è¦æ±‚ï¼‰</h4>
<p>Swap åˆ†åŒºä¼šå½±å“ K8s çš„è°ƒåº¦å’Œæ€§èƒ½ï¼Œå¿…é¡»ç¦ç”¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">\ ä¸´æ—¶ç¦ç”¨Swap

sudo swapoff -a

\ æ°¸ä¹…ç¦ç”¨Swapï¼ˆæ³¨é‡Š/etc/fstabä¸­çš„Swapé…ç½®ï¼‰

sudo sed -i <span class="hljs-string">'/swap/s/^/#/'</span> /etc/fstab

\ éªŒè¯Swapæ˜¯å¦ç¦ç”¨ï¼ˆè¾“å‡ºå‡ä¸º0å³ä¸ºæˆåŠŸï¼‰

free -h
</code></pre>
<h4 data-id="heading-5">ï¼ˆ3ï¼‰é…ç½®å†…æ ¸å‚æ•°ï¼ˆå¼€å¯ IP è½¬å‘ä¸æ¨¡å—ï¼‰</h4>
<p>K8s éœ€è¦å†…æ ¸æ”¯æŒ IP è½¬å‘å’Œå®¹å™¨ç½‘ç»œç›¸å…³æ¨¡å—ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">\ åˆ›å»ºå†…æ ¸é…ç½®æ–‡ä»¶

sudo cat &gt; /etc/sysctl.d/k8s.conf &lt;&lt; EOF

<span class="hljs-attr">net.bridge.bridge-nf-call-iptables</span>  = <span class="hljs-number">1</span>

<span class="hljs-attr">net.bridge.bridge-nf-call-ip6tables</span> = <span class="hljs-number">1</span>

net.ipv4.ip\<span class="hljs-attr">_forward</span>                 = <span class="hljs-number">1</span>

net.ipv4.tcp\_tw\<span class="hljs-attr">_recycle</span>             = <span class="hljs-number">0</span>

<span class="hljs-attr">vm.swappiness</span>                       = <span class="hljs-number">0</span>

EOF

\ åŠ è½½å†…æ ¸æ¨¡å—

sudo modprobe br\_netfilter

sudo modprobe overlay

\ ç”Ÿæ•ˆå†…æ ¸é…ç½®

sudo sysctl --system

\ éªŒè¯å‚æ•°ï¼ˆè¾“å‡º1å³ä¸ºæˆåŠŸï¼‰

sysctl net.bridge.bridge-nf-call-iptables net.ipv4.ip\_forward
</code></pre>
<h4 data-id="heading-6">ï¼ˆ4ï¼‰é…ç½®ä¸»æœºåä¸ Hosts è§£æ</h4>
<p>ç¡®ä¿æ‰€æœ‰èŠ‚ç‚¹çš„ä¸»æœºåå”¯ä¸€ï¼Œä¸”èƒ½é€šè¿‡ä¸»æœºåäº’é€šï¼š</p>
<pre><code class="hljs language-bash" lang="bash">\ é…ç½®ä¸»æœºåï¼ˆMasterèŠ‚ç‚¹æ‰§è¡Œï¼‰

sudo hostnamectl set-hostname k8s-master-01

\ é…ç½®ä¸»æœºåï¼ˆNodeèŠ‚ç‚¹1æ‰§è¡Œï¼‰

sudo hostnamectl set-hostname k8s-node-01

\ é…ç½®ä¸»æœºåï¼ˆNodeèŠ‚ç‚¹2æ‰§è¡Œï¼Œå¦‚éœ€å¤šNodeï¼‰

sudo hostnamectl set-hostname k8s-node-02

\ é…ç½®Hostsè§£æï¼ˆæ‰€æœ‰èŠ‚ç‚¹ï¼Œæ›¿æ¢ä¸ºå®é™…IPï¼‰

sudo <span class="hljs-built_in">cat</span> &gt;&gt; /etc/hosts &lt;&lt; <span class="hljs-string">EOF

192.168.1.100 k8s-master-01   å•MasterèŠ‚ç‚¹IP/é«˜å¯ç”¨MasterèŠ‚ç‚¹1IP

192.168.1.101 k8s-master-02   é«˜å¯ç”¨MasterèŠ‚ç‚¹2IPï¼ˆå•Masterå¿½ç•¥ï¼‰

192.168.1.102 k8s-master-03   é«˜å¯ç”¨MasterèŠ‚ç‚¹3IPï¼ˆå•Masterå¿½ç•¥ï¼‰

192.168.1.110 k8s-node-01     NodeèŠ‚ç‚¹1IP

192.168.1.111 k8s-node-02     NodeèŠ‚ç‚¹2IPï¼ˆå¯é€‰ï¼‰

192.168.1.200 k8s-vip         é«˜å¯ç”¨è™šæ‹ŸIPï¼ˆå•Masterå¿½ç•¥ï¼‰

EOF</span>

\ éªŒè¯Hostsè§£æï¼ˆèƒ½pingé€šæ‰€æœ‰èŠ‚ç‚¹ä¸»æœºåå³ä¸ºæˆåŠŸï¼‰

ping k8s-master-01 -c 2

ping k8s-node-01 -c 2
</code></pre>
<h4 data-id="heading-7">ï¼ˆ5ï¼‰å®‰è£…ä¾èµ–å·¥å…·</h4>
<pre><code class="hljs language-sql" lang="sql">sudo apt <span class="hljs-keyword">update</span> <span class="hljs-operator">&amp;&amp;</span> sudo apt install <span class="hljs-operator">-</span>y apt<span class="hljs-operator">-</span>transport<span class="hljs-operator">-</span>https ca<span class="hljs-operator">-</span>certificates curl gnupg lsb<span class="hljs-operator">-</span><span class="hljs-keyword">release</span>
</code></pre>
<h2 data-id="heading-8">äºŒã€å®‰è£…å®¹å™¨è¿è¡Œæ—¶ï¼šcontainerdï¼ˆK8s 1.24 + æ¨èï¼‰</h2>
<p>K8s ä» 1.24 ç‰ˆæœ¬å¼€å§‹ä¸å†é»˜è®¤ä¾èµ– Dockerï¼Œ<code>containerd</code>æ˜¯ CNCF è®¤è¯çš„å®¹å™¨è¿è¡Œæ—¶ï¼Œè½»é‡ä¸”ç¨³å®šï¼Œä»¥ä¸‹æ˜¯è¯¦ç»†å®‰è£…æ­¥éª¤ï¼š</p>
<h3 data-id="heading-9">1. å®‰è£… containerd</h3>
<pre><code class="hljs language-bash" lang="bash">\ æ·»åŠ Dockerå®˜æ–¹æºï¼ˆcontainerdåŒ…å«åœ¨Dockeræºä¸­ï¼‰

curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg

<span class="hljs-built_in">echo</span> <span class="hljs-string">"deb \[arch=\$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \$(lsb\_release -cs) stable"</span> | sudo <span class="hljs-built_in">tee</span> /etc/apt/sources.list.d/docker.list &gt; /dev/null

\ å®‰è£…containerdï¼ˆæŒ‡å®šç‰ˆæœ¬ï¼Œé¿å…è‡ªåŠ¨æ›´æ–°ï¼‰

sudo apt update &amp;&amp; sudo apt install -y containerd.io=1.6.28-1
</code></pre>
<h3 data-id="heading-10">2. é…ç½® containerdï¼ˆå…³é”®æ­¥éª¤ï¼‰</h3>
<pre><code class="hljs language-arduino" lang="arduino">\ ç”Ÿæˆé»˜è®¤é…ç½®æ–‡ä»¶

sudo containerd config <span class="hljs-keyword">default</span> | sudo tee /etc/containerd/config.toml

\ ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆ<span class="hljs-number">3</span>ä¸ªæ ¸å¿ƒä¿®æ”¹ç‚¹ï¼‰

sudo sed -i <span class="hljs-string">'s/SystemdCgroup \\= false/SystemdCgroup \\= true/g'</span> /etc/containerd/config.toml   å¼€å¯SystemdCgroup

sudo sed -i <span class="hljs-string">'s#sandbox\_image \\= "k8s.gcr.io/pause:3.6"#sandbox\_image \\= "registry.aliyuncs.com/google\_containers/pause:3.9"#g'</span> /etc/containerd/config.toml   æ›¿æ¢pauseé•œåƒä¸ºé˜¿é‡Œäº‘æº

sudo sed -i <span class="hljs-string">'s#config\_path \\= ""#config\_path \\= "/etc/containerd/certs.d"#g'</span> /etc/containerd/config.toml   é…ç½®é•œåƒä»“åº“è¯ä¹¦è·¯å¾„

\ é‡å¯containerdå¹¶è®¾ç½®å¼€æœºè‡ªå¯

sudo systemctl restart containerd

sudo systemctl enable containerd

\ éªŒè¯containerdçŠ¶æ€ï¼ˆè¾“å‡ºactiveå³ä¸ºæˆåŠŸï¼‰

sudo systemctl status containerd
</code></pre>
<h2 data-id="heading-11">ä¸‰ã€å®‰è£… K8s æ ¸å¿ƒç»„ä»¶ï¼škubeadmã€kubeletã€kubectl</h2>
<p><code>kubeadm</code>æ˜¯é›†ç¾¤éƒ¨ç½²å·¥å…·ï¼Œ<code>kubelet</code>æ˜¯èŠ‚ç‚¹ä¸Šçš„æ ¸å¿ƒç»„ä»¶ï¼Œ<code>kubectl</code>æ˜¯é›†ç¾¤å‘½ä»¤è¡Œå·¥å…·ï¼Œä¸‰è€…ç‰ˆæœ¬å¿…é¡»ä¸€è‡´ã€‚</p>
<h3 data-id="heading-12">1. æ·»åŠ  K8s å®˜æ–¹æºï¼ˆå›½å†…ä¼˜åŒ–ï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash">\ æ·»åŠ K8så®˜æ–¹GPGå¯†é’¥

curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.29/deb/Release.key | sudo gpg --dearmor -o /etc/apt/trusted.gpg.d/kubernetes-apt-keyring.gpg

\ æ·»åŠ K8sæºï¼ˆå›½å†…å¯è®¿é—®ï¼‰

<span class="hljs-built_in">echo</span> <span class="hljs-string">'deb \[signed-by=/etc/apt/trusted.gpg.d/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.29/deb/ /'</span> | sudo <span class="hljs-built_in">tee</span> /etc/apt/sources.list.d/kubernetes.list
</code></pre>
<h3 data-id="heading-13">2. å®‰è£…ç»„ä»¶å¹¶é”å®šç‰ˆæœ¬</h3>
<pre><code class="hljs language-sql" lang="sql">\ å®‰è£…æŒ‡å®šç‰ˆæœ¬ï¼ˆ<span class="hljs-number">1.29</span><span class="hljs-number">.0</span>ä¸ºç¨³å®šç‰ˆï¼Œå¯æ›¿æ¢ä¸ºå…¶ä»–ç¨³å®šç‰ˆï¼‰

sudo apt <span class="hljs-keyword">update</span> <span class="hljs-operator">&amp;&amp;</span> sudo apt install <span class="hljs-operator">-</span>y kubeadm<span class="hljs-operator">=</span><span class="hljs-number">1.29</span><span class="hljs-number">.0</span><span class="hljs-number">-1.1</span> kubelet<span class="hljs-operator">=</span><span class="hljs-number">1.29</span><span class="hljs-number">.0</span><span class="hljs-number">-1.1</span> kubectl<span class="hljs-operator">=</span><span class="hljs-number">1.29</span><span class="hljs-number">.0</span><span class="hljs-number">-1.1</span>

\ é”å®šç‰ˆæœ¬ï¼Œé¿å…è‡ªåŠ¨æ›´æ–°å¯¼è‡´ç‰ˆæœ¬ä¸ä¸€è‡´

sudo apt<span class="hljs-operator">-</span>mark <span class="hljs-keyword">hold</span> kubeadm kubelet kubectl

\ éªŒè¯å®‰è£…ï¼ˆè¾“å‡ºç‰ˆæœ¬å·å³ä¸ºæˆåŠŸï¼‰

kubeadm version

kubectl version <span class="hljs-comment">--client</span>
</code></pre>
<h2 data-id="heading-14">å››ã€æ–¹æ¡ˆä¸€ï¼šå• Master é›†ç¾¤éƒ¨ç½²ï¼ˆå¿«é€Ÿæµ‹è¯•ï¼‰</h2>
<p>é€‚åˆæ–°æ‰‹å…¥é—¨ã€æµ‹è¯•ç¯å¢ƒï¼Œéƒ¨ç½² 1 ä¸ª Master èŠ‚ç‚¹ + N ä¸ª Node èŠ‚ç‚¹ï¼Œæ­¥éª¤ç®€å•é«˜æ•ˆã€‚</p>
<h3 data-id="heading-15">1. åˆå§‹åŒ– Master èŠ‚ç‚¹ï¼ˆä»… Master æ‰§è¡Œï¼‰</h3>
<pre><code class="hljs language-css" lang="css">\ åˆå§‹åŒ–é›†ç¾¤ï¼ˆå…³é”®å‚æ•°è¯´æ˜ï¼‰

\ <span class="hljs-attr">--apiserver-advertise-address</span>ï¼šMasterèŠ‚ç‚¹IP

\ <span class="hljs-attr">--pod-network-cidr</span>ï¼šPodç½‘ç»œç½‘æ®µï¼ˆéœ€ä¸åç»­ç½‘ç»œæ’ä»¶ä¸€è‡´ï¼ŒCalicoé»˜è®¤<span class="hljs-number">10.244</span>.<span class="hljs-number">0.0</span>/<span class="hljs-number">16</span>ï¼‰

\ <span class="hljs-attr">--image-repository</span>ï¼šå›½å†…é•œåƒä»“åº“ï¼ˆé¿å…k8s<span class="hljs-selector-class">.gcr</span><span class="hljs-selector-class">.io</span>æ— æ³•è®¿é—®ï¼‰

\ <span class="hljs-attr">--kubernetes-version</span>ï¼šæŒ‡å®šK8sç‰ˆæœ¬ï¼ˆä¸å®‰è£…çš„kubeadmç‰ˆæœ¬ä¸€è‡´ï¼‰

sudo kubeadm init \\

&amp;<span class="hljs-selector-id">#x20</span>; \<span class="hljs-attr">--apiserver-advertise-address</span>=<span class="hljs-number">192.168</span>.<span class="hljs-number">1.100</span> \\

&amp;<span class="hljs-selector-id">#x20</span>; \<span class="hljs-attr">--pod-network-cidr</span>=<span class="hljs-number">10.244</span>.<span class="hljs-number">0.0</span>/<span class="hljs-number">16</span> \\

&amp;<span class="hljs-selector-id">#x20</span>; \<span class="hljs-attr">--image-repository</span>=registry<span class="hljs-selector-class">.aliyuncs</span><span class="hljs-selector-class">.com</span>/google\_containers \\

&amp;<span class="hljs-selector-id">#x20</span>; \<span class="hljs-attr">--kubernetes-version</span>=v1.<span class="hljs-number">29.0</span>
</code></pre>
<h4 data-id="heading-16">åˆå§‹åŒ–æˆåŠŸåï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼ˆæ™®é€šç”¨æˆ·æ‰§è¡Œï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash">\ é…ç½®kubectlæƒé™ï¼ˆè®©æ™®é€šç”¨æˆ·èƒ½æ“ä½œé›†ç¾¤ï¼‰

<span class="hljs-built_in">mkdir</span> -p \<span class="hljs-variable">$HOME</span>/.kube

sudo <span class="hljs-built_in">cp</span> -i /etc/kubernetes/admin.conf \<span class="hljs-variable">$HOME</span>/.kube/config

sudo <span class="hljs-built_in">chown</span> \$(<span class="hljs-built_in">id</span> -u):\$(<span class="hljs-built_in">id</span> -g) \<span class="hljs-variable">$HOME</span>/.kube/config

\ éªŒè¯MasterèŠ‚ç‚¹çŠ¶æ€ï¼ˆè¾“å‡ºReadyå³ä¸ºæˆåŠŸï¼‰

kubectl get nodes
</code></pre>
<blockquote>
<p>é‡è¦ï¼šåˆå§‹åŒ–æˆåŠŸåï¼Œç»ˆç«¯ä¼šè¾“å‡º</p>
<p><strong>Node èŠ‚ç‚¹åŠ å…¥é›†ç¾¤çš„å‘½ä»¤</strong></p>
<p>ï¼ˆå½¢å¦‚</p>
<p><code>kubeadm join </code></p>
<p><code>192.168.1.100:6443</code></p>
<p><code> --token xxx --discovery-token-ca-cert-hash sha256:xxx</code></p>
<p>ï¼‰ï¼Œå¤åˆ¶ä¿å­˜ï¼Œåç»­ Node èŠ‚ç‚¹éœ€ä½¿ç”¨ã€‚è‹¥å¿˜è®°ï¼Œå¯åœ¨ Master èŠ‚ç‚¹æ‰§è¡Œ</p>
<p><code>kubeadm token create --print-join-command</code></p>
<p>é‡æ–°ç”Ÿæˆã€‚</p>
</blockquote>
<h3 data-id="heading-17">2. å®‰è£…ç½‘ç»œæ’ä»¶ï¼šCalicoï¼ˆå¿…è£…ï¼‰</h3>
<p>K8s é›†ç¾¤éœ€ç½‘ç»œæ’ä»¶å®ç° Pod é—´é€šä¿¡ï¼ŒCalico æ˜¯è½»é‡ã€ç¨³å®šçš„é€‰æ‹©ï¼Œæ”¯æŒç½‘ç»œç­–ç•¥ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">\ ä¸‹è½½Calicoé…ç½®æ–‡ä»¶ï¼ˆå›½å†…åŠ é€Ÿåœ°å€ï¼‰

curl <span class="hljs-operator">-</span>O https:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>docs.projectcalico.org<span class="hljs-operator">/</span>v3<span class="hljs-number">.27</span><span class="hljs-operator">/</span>manifests<span class="hljs-operator">/</span>calico.yaml

\ ï¼ˆå¯é€‰ï¼‰ä¿®æ”¹Podç½‘ç»œç½‘æ®µï¼ˆè‹¥åˆå§‹åŒ–æ—¶ä¿®æ”¹äº†<span class="hljs-comment">--pod-network-cidrï¼Œéœ€åŒæ­¥ä¿®æ”¹æ­¤å¤„ï¼‰</span>

\ sed <span class="hljs-operator">-</span>i <span class="hljs-string">'s/10.244.0.0\\/16/ä½ çš„ç½‘æ®µ/g'</span> calico.yaml

\ å®‰è£…Calico

kubectl apply <span class="hljs-operator">-</span>f calico.yaml

\ æŸ¥çœ‹Calico PodçŠ¶æ€ï¼ˆæ‰€æœ‰Podä¸º<span class="hljs-keyword">Running</span>å³ä¸ºæˆåŠŸï¼Œçº¦<span class="hljs-number">1</span><span class="hljs-number">-2</span>åˆ†é’Ÿï¼‰

kubectl <span class="hljs-keyword">get</span> pods <span class="hljs-operator">-</span>n kube<span class="hljs-operator">-</span><span class="hljs-keyword">system</span> <span class="hljs-operator">-</span>l k8s<span class="hljs-operator">-</span>app<span class="hljs-operator">=</span>calico<span class="hljs-operator">-</span>node
</code></pre>
<h3 data-id="heading-18">3. Node èŠ‚ç‚¹åŠ å…¥é›†ç¾¤ï¼ˆä»… Node æ‰§è¡Œï¼‰</h3>
<p>åœ¨æ‰€æœ‰ Node èŠ‚ç‚¹æ‰§è¡Œä¹‹å‰ä¿å­˜çš„<code>kubeadm join</code>å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">sudo kubeadm <span class="hljs-keyword">join</span> <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.100</span>:<span class="hljs-number">6443</span> <span class="hljs-comment">--token xxx --discovery-token-ca-cert-hash sha256:xxx</span>
</code></pre>
<h4 data-id="heading-19">éªŒè¯ Node èŠ‚ç‚¹åŠ å…¥çŠ¶æ€ï¼ˆMaster èŠ‚ç‚¹æ‰§è¡Œï¼‰</h4>
<pre><code class="hljs language-arduino" lang="arduino">\ æŸ¥çœ‹æ‰€æœ‰èŠ‚ç‚¹ï¼ˆçŠ¶æ€å‡ä¸ºReadyå³ä¸ºæˆåŠŸï¼‰

kubectl get nodes

\ æŸ¥çœ‹é›†ç¾¤ç»„ä»¶çŠ¶æ€ï¼ˆæ‰€æœ‰ç»„ä»¶ä¸ºHealthyå³ä¸ºæˆåŠŸï¼‰

kubectl get cs
</code></pre>
<h2 data-id="heading-20">äº”ã€æ–¹æ¡ˆäºŒï¼šå¤š Master é«˜å¯ç”¨é›†ç¾¤éƒ¨ç½²ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰</h2>
<p>ç”Ÿäº§ç¯å¢ƒéœ€é¿å…å•ç‚¹æ•…éšœï¼Œé‡‡ç”¨ â€œ3 ä¸ª Master èŠ‚ç‚¹ + N ä¸ª Node èŠ‚ç‚¹ + è´Ÿè½½å‡è¡¡ï¼ˆHAProxy+Keepalivedï¼‰â€ æ¶æ„ï¼Œä»¥ä¸‹æ˜¯å…³é”®æ­¥éª¤ï¼ˆåŸºäºå• Master åŸºç¡€ï¼Œè¡¥å……é«˜å¯ç”¨ç›¸å…³é…ç½®ï¼‰ã€‚</p>
<h3 data-id="heading-21">1. éƒ¨ç½²è´Ÿè½½å‡è¡¡ï¼ˆHAProxy+Keepalivedï¼‰</h3>
<p>åœ¨ 2 ä¸ªç‹¬ç«‹èŠ‚ç‚¹ï¼ˆæˆ– Master èŠ‚ç‚¹ä¸Šï¼Œä¸æ¨èç”Ÿäº§ç¯å¢ƒï¼‰éƒ¨ç½²è´Ÿè½½å‡è¡¡ï¼Œæä¾›è™šæ‹Ÿ IPï¼ˆVIPï¼‰è®¿é—® Master èŠ‚ç‚¹çš„ apiserverï¼ˆ6443 ç«¯å£ï¼‰ã€‚</p>
<h4 data-id="heading-22">ï¼ˆ1ï¼‰å®‰è£… HAProxy ä¸ Keepalivedï¼ˆæ‰€æœ‰è´Ÿè½½å‡è¡¡èŠ‚ç‚¹æ‰§è¡Œï¼‰</h4>
<pre><code class="hljs language-sql" lang="sql">sudo apt <span class="hljs-keyword">update</span> <span class="hljs-operator">&amp;&amp;</span> sudo apt install <span class="hljs-operator">-</span>y haproxy keepalived
</code></pre>
<h4 data-id="heading-23">ï¼ˆ2ï¼‰é…ç½® HAProxyï¼ˆè´Ÿè½½å‡è¡¡èŠ‚ç‚¹æ‰§è¡Œï¼‰</h4>
<pre><code class="hljs language-ruby" lang="ruby">sudo cat &gt; <span class="hljs-regexp">/etc/haproxy</span><span class="hljs-regexp">/haproxy.cfg &lt;&lt; EOF

global

&amp;#x20;   log /dev</span><span class="hljs-regexp">/log local0 warning

&amp;#x20;   chroot /var</span><span class="hljs-regexp">/lib/haproxy</span>

&amp;<span class="hljs-comment">#x20;   stats socket /run/haproxy/admin.sock mode 660 level admin expose-fd listeners</span>

&amp;<span class="hljs-comment">#x20;   stats timeout 30s</span>

&amp;<span class="hljs-comment">#x20;   user haproxy</span>

&amp;<span class="hljs-comment">#x20;   group haproxy</span>

&amp;<span class="hljs-comment">#x20;   daemon</span>

defaults

&amp;<span class="hljs-comment">#x20;   log global</span>

&amp;<span class="hljs-comment">#x20;   mode tcp</span>

&amp;<span class="hljs-comment">#x20;   option tcplog</span>

&amp;<span class="hljs-comment">#x20;   option dontlognull</span>

&amp;<span class="hljs-comment">#x20;   timeout connect 5000</span>

&amp;<span class="hljs-comment">#x20;   timeout client 50000</span>

&amp;<span class="hljs-comment">#x20;   timeout server 50000</span>

\ <span class="hljs-title class_">K8s</span> apiserverè´Ÿè½½å‡è¡¡é…ç½®

frontend k8s-apiserver

&amp;<span class="hljs-comment">#x20;   bind \*:6443</span>

&amp;<span class="hljs-comment">#x20;   mode tcp</span>

&amp;<span class="hljs-comment">#x20;   option tcplog</span>

&amp;<span class="hljs-comment">#x20;   default\_backend k8s-apiserver-backend</span>

backend k8s-apiserver-backend

&amp;<span class="hljs-comment">#x20;   mode tcp</span>

&amp;<span class="hljs-comment">#x20;   option tcplog</span>

&amp;<span class="hljs-comment">#x20;   option tcp-check</span>

&amp;<span class="hljs-comment">#x20;   balance roundrobin   è½®è¯¢è´Ÿè½½å‡è¡¡</span>

&amp;<span class="hljs-comment">#x20;   server k8s-master-01 192.168.1.100:6443 check fall 3 rise 2</span>

&amp;<span class="hljs-comment">#x20;   server k8s-master-02 192.168.1.101:6443 check fall 3 rise 2</span>

&amp;<span class="hljs-comment">#x20;   server k8s-master-03 192.168.1.102:6443 check fall 3 rise 2</span>

<span class="hljs-variable constant_">EOF</span>

\ é‡å¯<span class="hljs-title class_">HAProxy</span>å¹¶è®¾ç½®å¼€æœºè‡ªå¯

sudo systemctl restart haproxy

sudo systemctl enable haproxy

\ éªŒè¯<span class="hljs-title class_">HAProxy</span>çŠ¶æ€

sudo systemctl status haproxy
</code></pre>
<h4 data-id="heading-24">ï¼ˆ3ï¼‰é…ç½® Keepalivedï¼ˆè´Ÿè½½å‡è¡¡èŠ‚ç‚¹æ‰§è¡Œï¼‰</h4>
<p><strong>ä¸»è´Ÿè½½å‡è¡¡èŠ‚ç‚¹</strong>ï¼ˆå¦‚ 192.168.1.150ï¼‰é…ç½®ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">sudo cat &gt; /etc/keepalived/keepalived.conf &lt;&lt; EOF

! Configuration File <span class="hljs-keyword">for</span> keepalived

<span class="hljs-keyword">global</span>\_defs {

&amp;<span class="hljs-meta">#x20;   router\_id LVS\_DEVEL</span>

}

vrrp\_instance VI\_1 {

&amp;<span class="hljs-meta">#x20;   state MASTER   ä¸»èŠ‚ç‚¹ä¸ºMASTERï¼Œå¤‡èŠ‚ç‚¹ä¸ºBACKUP</span>

&amp;<span class="hljs-meta">#x20;   interface ens33   ç½‘å¡åç§°ï¼ˆé€šè¿‡ip addræŸ¥çœ‹ï¼‰</span>

&amp;<span class="hljs-meta">#x20;   virtual\_router\_id 51</span>

&amp;<span class="hljs-meta">#x20;   priority 100   ä¸»èŠ‚ç‚¹ä¼˜å…ˆçº§é«˜äºå¤‡èŠ‚ç‚¹ï¼ˆå¦‚å¤‡èŠ‚ç‚¹è®¾ä¸º90ï¼‰</span>

&amp;<span class="hljs-meta">#x20;   advert\_int 1</span>

&amp;<span class="hljs-meta">#x20;   authentication {</span>

&amp;<span class="hljs-meta">#x20;       auth\_type PASS</span>

&amp;<span class="hljs-meta">#x20;       auth\_pass 1111</span>

&amp;<span class="hljs-meta">#x20;   }</span>

&amp;<span class="hljs-meta">#x20;   virtual\_ipaddress {</span>

&amp;<span class="hljs-meta">#x20;       192.168.1.200/24   è™šæ‹ŸIPï¼ˆK8s-VIPï¼‰</span>

&amp;<span class="hljs-meta">#x20;   }</span>

}

EOF
</code></pre>
<p><strong>å¤‡è´Ÿè½½å‡è¡¡èŠ‚ç‚¹</strong>ï¼ˆå¦‚ 192.168.1.151ï¼‰é…ç½®ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">sudo cat &gt; /etc/keepalived/keepalived.conf &lt;&lt; EOF

! Configuration File <span class="hljs-keyword">for</span> keepalived

<span class="hljs-keyword">global</span>\_defs {

&amp;<span class="hljs-meta">#x20;   router\_id LVS\_DEVEL</span>

}

vrrp\_instance VI\_1 {

&amp;<span class="hljs-meta">#x20;   state BACKUP</span>

&amp;<span class="hljs-meta">#x20;   interface ens33</span>

&amp;<span class="hljs-meta">#x20;   virtual\_router\_id 51</span>

&amp;<span class="hljs-meta">#x20;   priority 90</span>

&amp;<span class="hljs-meta">#x20;   advert\_int 1</span>

&amp;<span class="hljs-meta">#x20;   authentication {</span>

&amp;<span class="hljs-meta">#x20;       auth\_type PASS</span>

&amp;<span class="hljs-meta">#x20;       auth\_pass 1111</span>

&amp;<span class="hljs-meta">#x20;   }</span>

&amp;<span class="hljs-meta">#x20;   virtual\_ipaddress {</span>

&amp;<span class="hljs-meta">#x20;       192.168.1.200/24</span>

&amp;<span class="hljs-meta">#x20;   }</span>

}

EOF
</code></pre>
<h4 data-id="heading-25">ï¼ˆ4ï¼‰å¯åŠ¨ Keepalived å¹¶éªŒè¯ VIP</h4>
<pre><code class="hljs language-bash" lang="bash">\ æ‰€æœ‰è´Ÿè½½å‡è¡¡èŠ‚ç‚¹æ‰§è¡Œ

sudo systemctl restart keepalived

sudo systemctl <span class="hljs-built_in">enable</span> keepalived

sudo systemctl status keepalived

\ éªŒè¯VIPæ˜¯å¦ç”Ÿæ•ˆï¼ˆä¸»èŠ‚ç‚¹æ‰§è¡Œï¼Œèƒ½çœ‹åˆ°192.168.1.200å³ä¸ºæˆåŠŸï¼‰

ip addr
</code></pre>
<h3 data-id="heading-26">2. åˆå§‹åŒ–ç¬¬ä¸€ä¸ª Master èŠ‚ç‚¹ï¼ˆ192.168.1.100 æ‰§è¡Œï¼‰</h3>
<pre><code class="hljs language-csharp" lang="csharp">sudo kubeadm <span class="hljs-keyword">init</span> \\

&amp;<span class="hljs-meta">#x20; \--apiserver-advertise-address=192.168.1.100 \\</span>

&amp;<span class="hljs-meta">#x20; \--apiserver-cert-extra-sans=192.168.1.200 \   æ·»åŠ è™šæ‹ŸIPï¼ˆVIPï¼‰åˆ°è¯ä¹¦ä¿¡ä»»åˆ—è¡¨</span>

&amp;<span class="hljs-meta">#x20; \--pod-network-cidr=10.244.0.0/16 \\</span>

&amp;<span class="hljs-meta">#x20; \--image-repository=registry.aliyuncs.com/google\_containers \\</span>

&amp;<span class="hljs-meta">#x20; \--kubernetes-version=v1.29.0</span>
</code></pre>
<h4 data-id="heading-27">é…ç½® kubectl æƒé™ï¼ˆåŒå• Master æ­¥éª¤ï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> -p \<span class="hljs-variable">$HOME</span>/.kube

sudo <span class="hljs-built_in">cp</span> -i /etc/kubernetes/admin.conf \<span class="hljs-variable">$HOME</span>/.kube/config

sudo <span class="hljs-built_in">chown</span> \$(<span class="hljs-built_in">id</span> -u):\$(<span class="hljs-built_in">id</span> -g) \<span class="hljs-variable">$HOME</span>/.kube/config
</code></pre>
<h3 data-id="heading-28">3. åŠ å…¥å…¶ä»– Master èŠ‚ç‚¹ï¼ˆ192.168.1.101ã€192.168.1.102 æ‰§è¡Œï¼‰</h3>
<p>é¦–å…ˆåœ¨ç¬¬ä¸€ä¸ª Master èŠ‚ç‚¹ç”ŸæˆåŠ å…¥å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-lua" lang="lua">\ ç”ŸæˆMasterèŠ‚ç‚¹åŠ å…¥å‘½ä»¤ï¼ˆå¤åˆ¶è¾“å‡ºç»“æœï¼‰

kubeadm token <span class="hljs-built_in">create</span> <span class="hljs-comment">--print-join-command</span>
</code></pre>
<p>åœ¨å…¶ä»– Master èŠ‚ç‚¹æ‰§è¡ŒåŠ å…¥å‘½ä»¤ï¼Œå¹¶æ·»åŠ <code>--control-plane</code>å‚æ•°ï¼ˆè¡¨ç¤ºåŠ å…¥ä¸º Master èŠ‚ç‚¹ï¼‰ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">sudo kubeadm <span class="hljs-keyword">join</span> <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.200</span>:<span class="hljs-number">6443</span> <span class="hljs-comment">--token xxx --discovery-token-ca-cert-hash sha256:xxx \\</span>

<span class="hljs-operator">&amp;</span>#x20; \<span class="hljs-comment">--control-plane \\</span>

<span class="hljs-operator">&amp;</span>#x20; \<span class="hljs-comment">--certificate-key \$(kubeadm init phase upload-certs --upload-certs | grep -v 'certificate-key' | tail -n1)</span>
</code></pre>
<h3 data-id="heading-29">4. å®‰è£… Calico ç½‘ç»œæ’ä»¶ï¼ˆç¬¬ä¸€ä¸ª Master èŠ‚ç‚¹æ‰§è¡Œï¼‰</h3>
<p>åŒå• Master æ­¥éª¤ï¼Œå®‰è£… Calico åï¼Œæ‰€æœ‰ Master èŠ‚ç‚¹çŠ¶æ€ä¼šå˜ä¸º Readyã€‚</p>
<h3 data-id="heading-30">5. Node èŠ‚ç‚¹åŠ å…¥é«˜å¯ç”¨é›†ç¾¤ï¼ˆNode èŠ‚ç‚¹æ‰§è¡Œï¼‰</h3>
<p>é€šè¿‡ VIP åŠ å…¥é›†ç¾¤ï¼ˆè€Œéå•ä¸ª Master èŠ‚ç‚¹ IPï¼‰ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">sudo kubeadm <span class="hljs-keyword">join</span> <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.200</span>:<span class="hljs-number">6443</span> <span class="hljs-comment">--token xxx --discovery-token-ca-cert-hash sha256:xxx</span>
</code></pre>
<h3 data-id="heading-31">6. éªŒè¯é«˜å¯ç”¨é›†ç¾¤çŠ¶æ€ï¼ˆä»»æ„ Master èŠ‚ç‚¹æ‰§è¡Œï¼‰</h3>
<pre><code class="hljs language-sql" lang="sql">\ æŸ¥çœ‹æ‰€æœ‰èŠ‚ç‚¹ï¼ˆ<span class="hljs-number">3</span>ä¸ªMaster<span class="hljs-operator">+</span>Nä¸ªNodeå‡ä¸ºReadyï¼‰

kubectl <span class="hljs-keyword">get</span> nodes

\ æŸ¥çœ‹apiserver Podï¼ˆ<span class="hljs-number">3</span>ä¸ªMasterèŠ‚ç‚¹å„<span class="hljs-number">1</span>ä¸ªï¼Œå‡ä¸º<span class="hljs-keyword">Running</span>ï¼‰

kubectl <span class="hljs-keyword">get</span> pods <span class="hljs-operator">-</span>n kube<span class="hljs-operator">-</span><span class="hljs-keyword">system</span> <span class="hljs-operator">-</span>l component<span class="hljs-operator">=</span>kube<span class="hljs-operator">-</span>apiserver
</code></pre>
<h2 data-id="heading-32">å…­ã€é›†ç¾¤éªŒè¯ï¼šéƒ¨ç½²æµ‹è¯•åº”ç”¨</h2>
<p>æ— è®ºå• Master è¿˜æ˜¯é«˜å¯ç”¨é›†ç¾¤ï¼Œéƒ¨ç½² Nginx åº”ç”¨éªŒè¯é›†ç¾¤å¯ç”¨æ€§ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">\ åˆ›å»ºDeploymentï¼ˆ<span class="hljs-number">2</span>ä¸ªå‰¯æœ¬ï¼‰

kubectl <span class="hljs-keyword">create</span> deployment nginx<span class="hljs-operator">-</span>test <span class="hljs-comment">--image=nginx:1.25-alpine --replicas=2</span>

\ åˆ›å»ºNodePortç±»å‹Serviceï¼ˆå¤–éƒ¨å¯è®¿é—®ï¼‰

kubectl expose deployment nginx<span class="hljs-operator">-</span>test <span class="hljs-comment">--type=NodePort --port=80</span>

\ æŸ¥çœ‹Podå’ŒServiceçŠ¶æ€

kubectl <span class="hljs-keyword">get</span> pods

kubectl <span class="hljs-keyword">get</span> svc nginx<span class="hljs-operator">-</span>test

\ è®¿é—®æµ‹è¯•ï¼ˆæµè§ˆå™¨è®¿é—®http:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>èŠ‚ç‚¹IP:NodePortï¼Œå¦‚<span class="hljs-number">30</span>xxxç«¯å£ï¼‰
</code></pre>
<h2 data-id="heading-33">ä¸ƒã€å¸¸è§é—®é¢˜æ’æŸ¥ï¼ˆæ–°æ‰‹å¿…çœ‹ï¼‰</h2>
<h3 data-id="heading-34">1. èŠ‚ç‚¹çŠ¶æ€ä¸º NotReady</h3>
<ul>
<li>
<p>åŸå› ï¼šç½‘ç»œæ’ä»¶æœªå®‰è£…æˆ–è¿è¡Œå¤±è´¥ï¼Œæˆ– containerd æœªæ­£å¸¸å¯åŠ¨ã€‚</p>
</li>
<li>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
</li>
</ul>
<pre><code class="hljs language-perl" lang="perl">\ æŸ¥çœ‹Calico Podæ—¥å¿—

kubectl logs -n kube-<span class="hljs-keyword">system</span> calico-node-xxx

\ é‡å¯Calico

kubectl <span class="hljs-keyword">delete</span> pods -n kube-<span class="hljs-keyword">system</span> -l k8s-app=calico-node

\ é‡å¯containerd

sudo systemctl restart containerd
</code></pre>
<h3 data-id="heading-35">2. é•œåƒæ‹‰å–å¤±è´¥ï¼ˆå¦‚ pauseã€calico é•œåƒï¼‰</h3>
<ul>
<li>
<p>åŸå› ï¼šå›½å¤–é•œåƒä»“åº“æ— æ³•è®¿é—®ã€‚</p>
</li>
<li>
<p>è§£å†³æ–¹æ¡ˆï¼šæ›¿æ¢ä¸ºé˜¿é‡Œäº‘é•œåƒæºï¼Œå‚è€ƒ containerd é…ç½®æ­¥éª¤ä¸­çš„<code>sandbox_image</code>ä¿®æ”¹ï¼Œæˆ–æ‰‹åŠ¨æ‹‰å–é•œåƒå¹¶æ‰“æ ‡ç­¾ã€‚</p>
</li>
</ul>
<h3 data-id="heading-36">3. kubeadm init å¤±è´¥ï¼Œæç¤º â€œport 6443 is in useâ€</h3>
<ul>
<li>
<p>åŸå› ï¼š6443 ç«¯å£ï¼ˆapiserverï¼‰è¢«å ç”¨ã€‚</p>
</li>
<li>
<p>è§£å†³æ–¹æ¡ˆï¼šæŸ¥æ‰¾å ç”¨è¿›ç¨‹å¹¶æ€æ­»ï¼š</p>
</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">sudo lsof -i :6443

sudo <span class="hljs-built_in">kill</span> -9 è¿›ç¨‹ID
</code></pre>
<h3 data-id="heading-37">4. Node èŠ‚ç‚¹åŠ å…¥å¤±è´¥ï¼Œæç¤º â€œconnection refusedâ€</h3>
<ul>
<li>
<p>åŸå› ï¼šMaster èŠ‚ç‚¹ 6443 ç«¯å£æœªå¼€æ”¾ï¼Œæˆ–ç½‘ç»œä¸é€šã€‚</p>
</li>
<li>
<p>è§£å†³æ–¹æ¡ˆï¼šå…³é—­ Master èŠ‚ç‚¹é˜²ç«å¢™ï¼Œæˆ–å¼€æ”¾ 6443 ç«¯å£ï¼š</p>
</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">sudo ufw allow 6443/tcp
</code></pre>
<h3 data-id="heading-38">5. é«˜å¯ç”¨é›†ç¾¤ apiserver Pod å¯åŠ¨å¤±è´¥</h3>
<ul>
<li>
<p>åŸå› ï¼šVIP æœªç”Ÿæ•ˆï¼Œæˆ–è¯ä¹¦æœªåŒ…å« VIPã€‚</p>
</li>
<li>
<p>è§£å†³æ–¹æ¡ˆï¼šéªŒè¯ Keepalived çš„ VIP æ˜¯å¦å­˜åœ¨ï¼ˆ<code>ip addr</code>ï¼‰ï¼Œé‡æ–°åˆå§‹åŒ– Master èŠ‚ç‚¹æ—¶æ·»åŠ <code>--apiserver-cert-extra-sans=VIP</code>å‚æ•°ã€‚</p>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Cè¯­è¨€----å±€éƒ¨å˜é‡ä¸å…¨å±€å˜é‡]]></title>    <link>https://juejin.cn/post/7586892413890953262</link>    <guid>https://juejin.cn/post/7586892413890953262</guid>    <pubDate>2025-12-23T14:55:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586892413890953262" data-draft-id="7586877892468015131" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Cè¯­è¨€----å±€éƒ¨å˜é‡ä¸å…¨å±€å˜é‡"/> <meta itemprop="keywords" content="C"/> <meta itemprop="datePublished" content="2025-12-23T14:55:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸‰ç»´é±¼"/> <meta itemprop="url" content="https://juejin.cn/user/2886686784102032"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Cè¯­è¨€----å±€éƒ¨å˜é‡ä¸å…¨å±€å˜é‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2886686784102032/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸‰ç»´é±¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-23T14:55:59.000Z" title="Tue Dec 23 2025 14:55:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å‡½æ•°çš„ä½œç”¨åŸŸï¼šâ€œå˜é‡çš„æœ‰æ•ˆèŒƒå›´â€</h2>
<ol>
<li><strong>å±€éƒ¨ä½œç”¨åŸŸï¼ˆLocalï¼‰</strong> Â ï¼šå‡½æ•°å†…éƒ¨å®šä¹‰çš„å˜é‡ï¼Œä»…åœ¨å‡½æ•°å†…æœ‰æ•ˆï¼Œå¤–éƒ¨æ— æ³•è®¿é—®ï¼›</li>
<li><strong>å…¨å±€ä½œç”¨åŸŸï¼ˆGlobalï¼‰</strong> Â ï¼šå‡½æ•°å¤–éƒ¨å®šä¹‰çš„å˜é‡ï¼Œæ•´ä¸ªç¨‹åºéƒ½èƒ½è®¿é—®ï¼ˆå‡½æ•°å†…å¯è¯»å–ï¼Œä½†é»˜è®¤ä¸èƒ½ä¿®æ”¹ï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-1">äºŒã€ä»£ç æ¼”ç¤º</h2>
<p>ï¼ˆ1ï¼‰å±€éƒ¨å˜é‡</p>
<pre><code class="hljs language-C" lang="C"> <span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
 <span class="hljs-type">int</span> a = <span class="hljs-number">1</span>;
 <span class="hljs-type">void</span> <span class="hljs-title function_">f</span><span class="hljs-params">()</span> {
     <span class="hljs-type">int</span> a = <span class="hljs-number">1</span>;
     <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, a);
 }
 <span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {
     f();
     <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>, a);
 }
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/36ac968032bd49129b7c5e62eba92abb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiJ57u06bG8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767106559&amp;x-signature=4pX%2FYbIbxDvVvE91%2BxN9qIn7u3A%3D" alt="image.png" loading="lazy"/></p>
<p>ï¼ˆ2ï¼‰å±€éƒ¨å˜é‡</p>
<pre><code class="hljs language-C" lang="C"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>


<span class="hljs-type">int</span> a = <span class="hljs-number">1</span>;

<span class="hljs-type">void</span> <span class="hljs-title function_">f</span><span class="hljs-params">()</span> {
    a = <span class="hljs-number">2</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"åœ¨å‡½æ•°fçš„å†…éƒ¨ï¼ša=%d"</span>, a);
}

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {
    f();
   <span class="hljs-built_in">printf</span>(<span class="hljs-string">"åœ¨å‡½æ•°mainçš„å†…éƒ¨ï¼ša=%d"</span>, a);
}
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/786a7747d79243e78dcb3dda9b41d1df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiJ57u06bG8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767106559&amp;x-signature=kdvUBekC6Ey%2BvXzaEOMy3r2z0Wc%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ«IDå†²çªï¼šåˆ†å¸ƒå¼å”¯ä¸€ ID ç”Ÿæˆæ–¹æ¡ˆå…¨è§£æ]]></title>    <link>https://juejin.cn/post/7586910902285762612</link>    <guid>https://juejin.cn/post/7586910902285762612</guid>    <pubDate>2025-12-23T16:10:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586910902285762612" data-draft-id="7586973107322519592" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ«IDå†²çªï¼šåˆ†å¸ƒå¼å”¯ä¸€ ID ç”Ÿæˆæ–¹æ¡ˆå…¨è§£æ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-23T16:10:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="itThinking"/> <meta itemprop="url" content="https://juejin.cn/user/4288551418863256"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ«IDå†²çªï¼šåˆ†å¸ƒå¼å”¯ä¸€ ID ç”Ÿæˆæ–¹æ¡ˆå…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4288551418863256/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    itThinking
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-23T16:10:26.000Z" title="Tue Dec 23 2025 16:10:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;color:#282d36}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px;color:#2f845e}.markdown-body h2{font-size:22px;display:inline-block;font-weight:700;background:#2f845e;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(47,132,194,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 32px);border-bottom:3px solid #2f845e}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%;box-shadow:6px 6px 6px #888}.markdown-body hr{border:none;border-top:1px solid rgba(66,185,131,.15);margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#f6ffed;color:#52c41a;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:16px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#262626;border:1px solid #2f845e;border-top:8px solid #2f845e;background:linear-gradient(180deg,rgba(66,185,131,.1),transparent)!important}.markdown-body pre&gt;code.hljs[lang]:before{top:8px!important;color:#2f845e!important}.markdown-body pre&gt;code.language-awesome_error{border:1px solid #ff4d4f!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#ff4d4f!important;background:#fff2f0!important}.markdown-body pre&gt;code.language-awesome_error:before{content:"!"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#ff4d4f!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_warn{border:1px solid #ffc46f!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#ffc46f!important;background:#fffbe6!important}.markdown-body pre&gt;code.language-awesome_warn:before{content:"â˜‚"!important;position:absolute;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#ffc46f!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_success{border:1px solid #52c41a!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#52c41a!important;background:#f6ffed!important}.markdown-body pre&gt;code.language-awesome_success:before{content:"âœ“"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#52c41a!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_info{border:1px solid #1890ff!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#1890ff!important;background:#e6f7ff!important}.markdown-body pre&gt;code.language-awesome_info:before{content:"i"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#1890ff!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body strong{background-color:inherit;color:#2f845e}.markdown-body em{background-color:inherit;color:#949415}.markdown-body a{text-decoration:none;color:#2f8e54;border-bottom:1px solid #3f9e64}.markdown-body a:active,.markdown-body a:hover{color:#3f9e64}.markdown-body a[class^=footnote]{margin-left:4px}.markdown-body a:before{content:"â¤ "}.markdown-body table{font-size:12px;width:100%;max-width:100%;overflow:auto;border:2px solid #2f8e54}.markdown-body thead{background:#2f8e54;color:#fff;text-align:left;font-weight:700}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:22px}.markdown-body td{min-width:120px}.markdown-body blockquote{padding:1px 22px;margin:22px 0;border-left:6px solid #2f845e;background-color:rgba(66,185,131,.1);border-radius:2px}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#2f845e}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px;color:#282d36}.markdown-body del{color:#2f845e}.markdown-body input[type=checkbox]:checked:before{content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA/klEQVQ4T72TMU7DQBBF318XdFR06egQEnAXRINEGlqgowoIR8AF4AZOZ4JEGq5AC5EixBU4A55BNrEVHAcSBTHlaubt37/zxZKlcn7n6mDPXJvz8IJ89HzWu8t7C8D2dfsY52ae4apHnLx0ktsCsHXZjiUuFgG40x2eJ/H/AhztB+zDUTpLwWj8jGkzxSHiHaMPrDQC8sMoilKzLAUqiKQjmb+ZuAdW80tmelCHODoNgSfP7AFprTTaRTzsJN1GEyuIZ7uW6TEEHwCtyV/6EVBKJHhfzgC0Xv/iXwEFBF4FG0378bd7sPQq5xK/hSnk6sdlX3mZrKkwLZKBeu8n9XuWEUE7X+YAAAAASUVORK5CYII=);position:relative;top:-1px;left:-1px}.markdown-body .math .katex{font-family:Menlo,Monaco,Consolas,Courier New,monospace;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#f6ffed;color:#52c41a;font-size:.87em;padding:.065em .4em}@media (max-width:720px){.markdown-body h1{font-size:22px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ–‡ç« é¦–å‘äºå¾®ä¿¡å…¬ä¼—å·ã€ŠitThinkingã€‹ï¼Œ åŸæ–‡é“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FvLI9RCy4mPYzRLryZsktCw" target="_blank" title="https://mp.weixin.qq.com/s/vLI9RCy4mPYzRLryZsktCw" ref="nofollow noopener noreferrer">mp.weixin.qq.com/s/vLI9RCy4mâ€¦</a></p>
<p>åœ¨ç°ä»£é«˜å¹¶å‘ã€å¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆIDï¼‰ä¸ä»…æ˜¯æ•°æ®çš„â€œèº«ä»½è¯â€ï¼Œæ›´æ˜¯ç³»ç»Ÿç¨³å®šæ€§å’Œå¯æ‰©å±•æ€§çš„åŸºçŸ³ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ IDã€ä¸šåŠ¡å¯¹ ID çš„æ ¸å¿ƒè¦æ±‚ï¼Œå¹¶å…¨é¢å¯¹æ¯”ä¸»æµçš„åˆ†å¸ƒå¼ ID ç”Ÿæˆæ–¹æ¡ˆï¼ŒåŒ…æ‹¬å…¶åŸç†ã€ä¼˜ç¼ºç‚¹ã€é€‚ç”¨åœºæ™¯åŠæ€§èƒ½è¡¨ç°ã€‚</p>
<hr/>
<h2 data-id="heading-0">1. ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ IDï¼Ÿ</h2>
<h3 data-id="heading-1">å•ä½“ç³»ç»Ÿ vs åˆ†å¸ƒå¼ç³»ç»Ÿ</h3>
<p>åœ¨å•ä½“åº”ç”¨ä¸­ï¼Œæ•°æ®åº“ä¸»é”®å¸¸é‡‡ç”¨è‡ªå¢ IDï¼ˆAuto Incrementï¼‰ï¼Œç®€å•é«˜æ•ˆã€‚ä½†åœ¨åˆ†å¸ƒå¼æ¶æ„ä¸‹ï¼Œå°¤å…¶æ˜¯è¿›è¡Œåˆ†åº“åˆ†è¡¨åï¼Œè¿™ç§æ–¹æ¡ˆä¼šé¢ä¸´ä¸¥é‡é—®é¢˜ï¼šå¤šä¸ªæ•°æ®åº“å®ä¾‹å„è‡ªç»´æŠ¤è‡ªå¢åºåˆ—ï¼Œå¯¼è‡´ID å†²çªï¼›æ— æ³•ä¿è¯å…¨å±€å”¯ä¸€æ€§ï¼Œç ´åæ•°æ®ä¸€è‡´æ€§ï¼›æ‰©å®¹å›°éš¾ï¼Œéš¾ä»¥æ¨ªå‘æ‰©å±•ã€‚</p>
<blockquote>
<p>ğŸ“ŒÂ <strong>ç¤ºä¾‹</strong>ï¼šè®¢å•è¡¨å› æ•°æ®é‡è¿‡å¤§è¢«æ‹†åˆ†ä¸º 4 ä¸ªåº“ã€‚è‹¥æ¯ä¸ªåº“ç‹¬ç«‹è‡ªå¢ï¼Œåˆ™å¯èƒ½å‡ºç°å¤šä¸ªâ€œè®¢å•ID=1001â€çš„è®°å½•ï¼Œé€ æˆä¸šåŠ¡é€»è¾‘æ··ä¹±ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-2">2. ä¸šåŠ¡ç³»ç»Ÿå¯¹åˆ†å¸ƒå¼ ID çš„æ ¸å¿ƒè¦æ±‚</h2>
<p>ä¸€ä¸ªç†æƒ³çš„åˆ†å¸ƒå¼ ID ç”Ÿæˆç³»ç»Ÿéœ€æ»¡è¶³ä»¥ä¸‹å…³é”®ç‰¹æ€§ï¼š</p>

































<table><thead><tr><th>è¦æ±‚</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>å…¨å±€å”¯ä¸€æ€§</strong></td><td>ç»å¯¹ä¸èƒ½é‡å¤ï¼Œæ˜¯ ID çš„åŸºæœ¬å‰æ</td></tr><tr><td><strong>è¶‹åŠ¿é€’å¢</strong></td><td>ID æ•´ä½“é€’å¢ï¼ˆéä¸¥æ ¼è¿ç»­ï¼‰ï¼Œåˆ©äºæ•°æ®åº“ç´¢å¼•æ€§èƒ½ï¼ˆå¦‚ MySQL InnoDB èšç°‡ç´¢å¼•ï¼‰</td></tr><tr><td><strong>å•è°ƒé€’å¢ï¼ˆå¯é€‰ï¼‰</strong></td><td>æŸäº›åœºæ™¯ï¼ˆå¦‚äº‹åŠ¡ç‰ˆæœ¬å·ã€æ¶ˆæ¯åºå·ï¼‰è¦æ±‚ä¸¥æ ¼é€’å¢</td></tr><tr><td><strong>ä¿¡æ¯å®‰å…¨</strong></td><td>ID ä¸åº”æš´éœ²ä¸šåŠ¡ä¿¡æ¯ï¼ˆå¦‚è®¢å•é‡ã€ç”¨æˆ·å¢é•¿ï¼‰ï¼Œé¿å…è¢«ç«å¯¹æˆ–çˆ¬è™«æ¨ç®—</td></tr><tr><td><strong>é«˜æ€§èƒ½ &amp; é«˜å¯ç”¨</strong></td><td>ä½å»¶è¿Ÿã€é«˜ QPSã€99.999% å¯ç”¨æ€§ï¼ˆ5ä¸ª9ï¼‰</td></tr><tr><td><strong>æ— ä¸­å¿ƒä¾èµ–ï¼ˆç†æƒ³ï¼‰</strong></td><td>å°½é‡å‡å°‘å¯¹æ•°æ®åº“ã€ZooKeeper ç­‰å¤–éƒ¨ç»„ä»¶çš„å¼ºä¾èµ–</td></tr></tbody></table>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼š<strong>è¶‹åŠ¿é€’å¢</strong>Â ä¸Â <strong>ä¿¡æ¯å®‰å…¨</strong>Â å¾€å¾€äº’æ–¥â€”â€”å‰è€…å¸Œæœ›æœ‰åºï¼Œåè€…å¸Œæœ›æ— åºã€‚éœ€æ ¹æ®ä¸šåŠ¡æƒè¡¡ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-3">3. ä¸»æµåˆ†å¸ƒå¼ ID ç”Ÿæˆæ–¹æ¡ˆå¯¹æ¯”</h2>









































































































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>åŸç†</th><th>å…¨å±€å”¯ä¸€</th><th>è¶‹åŠ¿é€’å¢</th><th>å®‰å…¨æ€§</th><th>ä¾èµ–</th><th>QPSï¼ˆå•æœºï¼‰</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>UUID</strong></td><td>æœ¬åœ°ç”Ÿæˆ 128 ä½éšæœº/æ—¶é—´+MAC</td><td>âœ…</td><td>âŒ</td><td>ä¸­ï¼ˆéƒ¨åˆ†æ³„éœ² MACï¼‰</td><td>æ— </td><td>&gt;100ä¸‡</td><td>æ—¥å¿—ã€ä¸´æ—¶ID</td></tr><tr><td><strong>æ•°æ®åº“è‡ªå¢ï¼ˆFlickr Ticket Serverï¼‰</strong></td><td>å¤šDB + æ­¥é•¿éš”ç¦»</td><td>âœ…</td><td>âœ…ï¼ˆè¶‹åŠ¿ï¼‰</td><td>ä½ï¼ˆå¯æ¨ç®—ï¼‰</td><td>MySQL</td><td>~1ä¸‡</td><td>å°è§„æ¨¡ç³»ç»Ÿ</td></tr><tr><td><strong>å·æ®µæ¨¡å¼ï¼ˆSegmentï¼‰</strong></td><td>æ‰¹é‡é¢„å– ID æ®µåˆ°å†…å­˜</td><td>âœ…</td><td>âœ…</td><td>ä½</td><td>MySQL</td><td>10ä¸‡+</td><td>é«˜å¹¶å‘å†™å…¥</td></tr><tr><td><strong>Redis INCR</strong></td><td>Redis è‡ªå¢åŸå­æ“ä½œ</td><td>âœ…</td><td>âœ…</td><td>ä½</td><td>Redis</td><td>10ä¸‡+</td><td>å·²æœ‰ Redis æ¶æ„</td></tr><tr><td><strong>Snowflake</strong></td><td>æ—¶é—´æˆ³ + æœºå™¨ID + åºåˆ—å·</td><td>âœ…</td><td>âœ…</td><td>ä¸­</td><td>æ—¶é’Ÿ</td><td>40ä¸‡+</td><td>é€šç”¨åœºæ™¯</td></tr><tr><td><strong>ç™¾åº¦ UidGenerator</strong></td><td>Snowflake æ”¹è¿› + RingBuffer</td><td>âœ…</td><td>âœ…</td><td>ä¸­</td><td>DBï¼ˆåˆ†é… workerIdï¼‰</td><td><strong>600ä¸‡</strong></td><td>è¶…é«˜å¹¶å‘</td></tr><tr><td><strong>ç¾å›¢ Leafï¼ˆSegmentï¼‰</strong></td><td>ä¼˜åŒ–å·æ®µ + åŒ buffer é¢„åŠ è½½</td><td>âœ…</td><td>âœ…</td><td>ä½</td><td>MySQL</td><td><strong>5ä¸‡+</strong></td><td>è®¢å•ã€æ”¯ä»˜ç­‰</td></tr><tr><td><strong>ç¾å›¢ Leafï¼ˆSnowflakeï¼‰</strong></td><td>Snowflake + ZooKeeper è‡ªåŠ¨åˆ†é… workerId</td><td>âœ…</td><td>âœ…</td><td>ä¸­</td><td>ZK + æ—¶é’Ÿ</td><td><strong>5ä¸‡+</strong></td><td>éœ€é˜²å†²çªçš„ Snowflake</td></tr><tr><td><strong>æ»´æ»´ TinyID</strong></td><td>Leaf-segment å¤š DB æ‰©å±•ç‰ˆ</td><td>âœ…</td><td>âœ…</td><td>ä½</td><td>MySQLï¼ˆå¤šæºï¼‰</td><td>10ä¸‡+</td><td>å¤šç§Ÿæˆ·ã€å¤šä¸šåŠ¡çº¿</td></tr></tbody></table>
<blockquote>
<p>ğŸ’¡ æ³¨ï¼šQPS æ•°æ®åŸºäºå…¸å‹é…ç½®ï¼ˆå¦‚ 4C8G æœºå™¨ï¼‰ï¼Œå®é™…å—ç½‘ç»œã€å­˜å‚¨ã€GC ç­‰å½±å“ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-4">3.1 UUID</h3>
<p>UUIDæ˜¯ä¸€ä¸ª128ä½çš„æ•°å­—ï¼Œå…¶ç»“æ„é€šå¸¸ç”±äº”ä¸ªéƒ¨åˆ†ç»„æˆ,ä¸ºäº†æ–¹ä¾¿é˜…è¯»ï¼Œé€šå¸¸è½¬æ¢æˆ32ä¸ªåå…­è¿›åˆ¶æ•°å­—çš„å½¢å¼è¡¨ç¤ºã€‚æ ¼å¼ï¼š8-4-4-4-12ï¼Œå…± 36 å­—ç¬¦ï¼ˆå¦‚9acadbef-f92f-49fb-8907-1cd91a493982ï¼‰<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/96f9177bdb65454d864bb4058a9f7f81~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaXRUaGlua2luZw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767111025&amp;x-signature=K%2FIsazMlztmqRBs3%2BzCVUrA0g4A%3D" alt="æˆªå›¾_20242801062840.png" loading="lazy"/></p>











<table><thead><tr><th/></tr></thead><tbody><tr><td/></tr></tbody></table>















































<table><thead><tr><th>å­—æ®µ</th><th>hexOctetï¼ˆå­—èŠ‚ï¼‰</th><th>ä½ç½®</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>time_low</td><td>4</td><td>0-3</td><td><strong>æ—¶é—´æˆ³</strong>Â çš„ä½ä½éƒ¨åˆ†</td></tr><tr><td>time_mid</td><td>2</td><td>4-5</td><td>æ—¶é—´æˆ³çš„ä¸­é—´éƒ¨åˆ†</td></tr><tr><td><strong>time_hi_and_version</strong></td><td>2</td><td>6-7</td><td>æ—¶é—´æˆ³é«˜ä½éƒ¨åˆ†ä¸Â <strong>ç‰ˆæœ¬</strong>Â å­—æ®µï¼Œå…¶ä¸­12ä½ä»£è¡¨æ—¶é—´æˆ³çš„é«˜12ä½ï¼Œ<strong>4ä½åˆ™ç”¨æ¥æ ‡è¯†UUIDçš„ç‰ˆæœ¬å·</strong></td></tr><tr><td><strong>clock_seq_hi_and_reserved</strong></td><td>1</td><td>8</td><td><strong>æ—¶é’Ÿåºåˆ—</strong>Â é«˜ä½ä¸Â <strong>ä¿ç•™ä½</strong></td></tr><tr><td>clock_seq_low</td><td>1</td><td>9</td><td>æ—¶é’Ÿåºåˆ—ä½ä½</td></tr><tr><td>node</td><td>6</td><td>10-15</td><td><strong>èŠ‚ç‚¹æ ‡è¯†ç¬¦</strong>ï¼Œæä¾›ç©ºé—´å”¯ä¸€æ€§ï¼Œé€šå¸¸åŸºäºMACåœ°å€æˆ–éšæœºæ•°ç”Ÿæˆï¼Œä»¥ç¡®ä¿å…¨å±€èŒƒå›´å†…çš„å”¯ä¸€æ€§</td></tr></tbody></table>
<ul>
<li>ä¼˜ç‚¹ï¼šæœ¬åœ°ç”Ÿæˆã€æ— ç½‘ç»œå¼€é”€ã€æé«˜æ€§èƒ½</li>
</ul>

<ul>
<li>ç¼ºç‚¹ï¼š</li>
</ul>

<ul>
<li>é•¿åº¦å¤§ï¼ˆ36å­—ç¬¦ï¼‰ï¼Œå ç”¨å­˜å‚¨ç©ºé—´ï¼›</li>
<li>æ— åºï¼Œå¯¼è‡´ InnoDB é¢‘ç¹é¡µåˆ†è£‚ï¼Œå†™æ€§èƒ½ä¸‹é™ï¼›</li>
<li>éƒ¨åˆ†ç‰ˆæœ¬ï¼ˆv1ï¼‰å« MAC åœ°å€ï¼Œå­˜åœ¨éšç§æ³„éœ²é£é™©ã€‚</li>
</ul>

<ul>
<li>é€‚ç”¨ï¼šéä¸»é”®åœºæ™¯ï¼ˆå¦‚ traceIdã€sessionIdï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-5">3.2 æ•°æ®åº“è‡ªå¢ï¼ˆFlickr Ticket Serverï¼‰</h3>
<p>åŸç†ï¼šN å° DBï¼Œæ­¥é•¿ = Nï¼Œoffset = 0~N-1ç¼ºç‚¹ï¼š</p>
<ul>
<li>æ‰©å®¹å¤æ‚ï¼ˆéœ€é‡æ–°åˆ†é… offset å’Œ stepï¼‰ï¼›</li>
<li>å¼ºä¾èµ– DBï¼Œå•ç‚¹æ•…éšœé£é™©ï¼›</li>
<li>ID å¯é¢„æµ‹ï¼Œä¸å®‰å…¨ã€‚</li>
</ul>
<p>æ€§èƒ½ï¼šå—é™äºå• DB å†™å…¥èƒ½åŠ›ï¼Œé€šå¸¸ &lt; 1ä¸‡ QPS<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/50294e360f604a1cbcf8bd752de87b2f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaXRUaGlua2luZw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767111025&amp;x-signature=v9atpZDG%2BvILEvWYrIgcuGxrE7s%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-6">3.3 å·æ®µæ¨¡å¼ï¼ˆSegmentï¼‰</h3>
<ul>
<li>æ ¸å¿ƒæ€æƒ³ï¼šä¸€æ¬¡ä» DB è·å–ä¸€æ®µ IDï¼ˆå¦‚ 1~1000ï¼‰ï¼Œç”¨å®Œå†å–</li>
</ul>

<ul>
<li>ä¼˜åŒ–ï¼ˆLeaf-segmentï¼‰ï¼š</li>
</ul>

<ul>
<li>
<ul>
<li><strong>åŒ Buffer é¢„åŠ è½½ï¼šå½“å‰å·æ®µç”¨åˆ° 10% æ—¶å¼‚æ­¥åŠ è½½ä¸‹ä¸€æ®µï¼Œé¿å…ä¸´ç•Œé˜»å¡ï¼›</strong></li>
<li><strong>biz_tag éš”ç¦»ï¼šä¸åŒä¸šåŠ¡ä½¿ç”¨ä¸åŒ tagï¼Œäº’ä¸å½±å“ï¼›</strong></li>
</ul>
</li>
<li>
<ul>
<li><strong>é«˜å¯ç”¨ï¼šä¸»ä» + Atlas ä¸­é—´ä»¶è‡ªåŠ¨åˆ‡æ¢ã€‚</strong></li>
</ul>
</li>
</ul>

<ul>
<li>æ€§èƒ½ï¼šLeaf å®æµ‹ 5ä¸‡ QPSï¼ŒTP999 &lt; 1ms</li>
</ul>

<ul>
<li>ç¼ºç‚¹ï¼š</li>
</ul>

<ul>
<li>ä»ä¾èµ– DBï¼›</li>
<li>ID å¯æ¨ç®—</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6a01008aa784456be4a09ba2c54e618~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaXRUaGlua2luZw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767111025&amp;x-signature=KdTnRxmpxPoJsqr89Lp%2BCM%2Bo9sc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-7">3.4 Redis å®ç°</h3>
<ul>
<li><strong>å‘½ä»¤ï¼šINCR keyæˆ– INCRBY key step</strong></li>
<li><strong>ä¼˜ç‚¹ï¼šåŸå­æ€§ã€é«˜æ€§èƒ½ã€ç®€å•</strong></li>
<li><strong>ç¼ºç‚¹ï¼š</strong></li>
<li>
<ul>
<li>å¼•å…¥ Redis ä¾èµ–ï¼›</li>
<li>é›†ç¾¤æ¨¡å¼ä¸‹éœ€ç±»ä¼¼ DB çš„åˆ†æ®µç­–ç•¥ï¼›</li>
<li>æŒä¹…åŒ–å¯èƒ½ä¸¢å¤± IDï¼ˆéœ€ AOF + fsyncï¼‰</li>
</ul>
</li>
<li><strong>æ€§èƒ½ï¼šå• Redis å®ä¾‹å¯è¾¾ 10ä¸‡+ QPS</strong></li>
</ul>
<hr/>
<h3 data-id="heading-8">3.5 é›ªèŠ±ç®—æ³•ï¼ˆSnowflakeï¼‰</h3>
<h3 data-id="heading-9">é›ªèŠ±ç®—æ³•ï¼ˆSnowflakeï¼‰æ˜¯ç”± Twitter å¼€æºçš„åˆ†å¸ƒå¼ ID ç”Ÿæˆç®—æ³•ï¼Œä»¥åˆ’åˆ†å‘½åç©ºé—´çš„æ–¹å¼å°† 64-bit ä½åˆ†å‰²æˆå¤šä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†ä»£è¡¨ä¸åŒçš„å«ä¹‰ã€‚åœ¨ Java ä¸­ Long ç±»å‹æ˜¯ 64 ä½çš„ï¼Œæ‰€ä»¥ Java ç¨‹åºä¸­ä¸€èˆ¬ä½¿ç”¨ Long ç±»å‹å­˜å‚¨ã€‚</h3>
<h3 data-id="heading-10"/>
<ul>
<li><strong>64 ä½ç»“æ„ï¼š</strong></li>
<li>
<ul>
<li>1 bit ç¬¦å·ä½ï¼ˆå›ºå®š 0ï¼‰</li>
<li>41 bit æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼Œçº¦ 69 å¹´ï¼‰</li>
<li>10 bit æœºå™¨ IDï¼ˆ1024 èŠ‚ç‚¹ï¼‰</li>
<li>12 bit åºåˆ—å·ï¼ˆ4096/æ¯«ç§’ï¼‰</li>
</ul>
</li>
<li><strong>ä¼˜ç‚¹ï¼šè¶‹åŠ¿é€’å¢ã€æ—  DB ä¾èµ–ã€é«˜æ€§èƒ½</strong></li>
<li><strong>è‡´å‘½ç¼ºé™·ï¼šæ—¶é’Ÿå›æ‹¨â†’ å¯èƒ½é‡å¤ ID</strong></li>
<li><strong>æ€§èƒ½ï¼šç†è®º 409.6ä¸‡ QPSï¼Œå®æµ‹ 40ä¸‡+</strong><br/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/728ce97a3be947e6b7f478e690015b64~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaXRUaGlua2luZw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767111025&amp;x-signature=5IctVgUUlZCzdwjIfpFmqT9T1II%3D" alt="å›¾ç‰‡" loading="lazy"/></li>
</ul>
<hr/>
<h3 data-id="heading-11">3.6 ç™¾åº¦ UidGenerator</h3>
<ul>
<li>æ”¹è¿›ç‚¹ï¼š</li>
</ul>

<ul>
<li>æ—¶é—´å•ä½æ”¹ä¸ºÂ <strong>ç§’</strong>ï¼ˆ28 bit â†’ æ”¯æŒ 8.7 å¹´ï¼‰ï¼›</li>
<li>workerId æ‰©å±•è‡³Â <strong>22 bit</strong>ï¼ˆæ”¯æŒ 420 ä¸‡æœºå™¨ï¼‰ï¼›</li>
<li>ä½¿ç”¨Â <strong>RingBuffer</strong>Â ç¼“å­˜ IDï¼Œç”Ÿäº§æ¶ˆè´¹åˆ†ç¦»ï¼›</li>
<li>è§£å†³ CPU Cache ä¼ªå…±äº«é—®é¢˜ã€‚</li>
</ul>

<ul>
<li>æ€§èƒ½ï¼šå•æœº 600ä¸‡ QPSï¼ˆå®˜æ–¹æ•°æ®ï¼‰</li>
</ul>

<ul>
<li>ä¾èµ–ï¼šå¯åŠ¨æ—¶éœ€ DB åˆ†é… workerIdï¼ˆå¯å¤ç”¨ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-12">3.7 ç¾å›¢ Leaf</h3>
<h3 data-id="heading-13">3.7.1 Leaf-segmentï¼ˆå·æ®µæ¨¡å¼å¢å¼ºç‰ˆï¼‰</h3>
<ul>
<li>è¡¨ç»“æ„ï¼š</li>
</ul>

<ul>
<li/>
</ul>

<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span>Â leaf_alloc ( Â biz_tagÂ <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">128</span>)Â <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>, Â max_idÂ <span class="hljs-type">BIGINT</span>Â <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>Â <span class="hljs-keyword">DEFAULT</span>Â <span class="hljs-string">'1'</span>, Â stepÂ <span class="hljs-type">INT</span>Â <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>, Â descriptionÂ <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">256</span>), Â update_timeÂ <span class="hljs-type">TIMESTAMP</span>Â <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>Â <span class="hljs-keyword">DEFAULT</span>Â <span class="hljs-built_in">CURRENT_TIMESTAMP</span>Â <span class="hljs-keyword">ON</span>Â <span class="hljs-keyword">UPDATE</span>Â <span class="hljs-built_in">CURRENT_TIMESTAMP</span>, Â <span class="hljs-keyword">PRIMARY</span> KEY(biz_tag));
</code></pre>
<ul>
<li>ç‰¹æ€§ï¼šåŒ bufferã€biz_tag éš”ç¦»ã€DB ä¸»ä»é«˜å¯ç”¨</li>
</ul>
<h3 data-id="heading-14">3.7.2 Leaf-snowflakeï¼ˆSnowflake + è‡ªåŠ¨æ³¨å†Œï¼‰</h3>
<ul>
<li><strong>workerId è‡ªåŠ¨åˆ†é…ï¼šé€šè¿‡ ZooKeeper æŒä¹…é¡ºåºèŠ‚ç‚¹ç”Ÿæˆ</strong></li>
</ul>

<ul>
<li><strong>æ—¶é’Ÿå›æ‹¨å¤„ç†ï¼š</strong></li>
<li>
<ul>
<li>å°å›æ‹¨ï¼ˆ&lt;5msï¼‰ï¼šç­‰å¾…ï¼›</li>
<li>å¤§å›æ‹¨ï¼šæŠ¥è­¦å¹¶æ‹’ç»æœåŠ¡</li>
</ul>
</li>
<li><strong>å¼±ä¾èµ– ZKï¼šæœ¬åœ°ç¼“å­˜ workerId æ–‡ä»¶ï¼Œé‡å¯å¯ç”¨</strong></li>
</ul>
<h3 data-id="heading-15"/>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7366e09b78ec4f65ae3dd9a53a302aaa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaXRUaGlua2luZw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767111025&amp;x-signature=h627ZNhHCdXq%2Bt2RdVIvwydpxuc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-16">3.8 æ»´æ»´ TinyID</h3>
<ul>
<li><strong>å®šä½ï¼šLeaf-segment çš„å¤š DB æ‰©å±•ç‰ˆ</strong></li>
</ul>

<ul>
<li>
<p><strong>ç‰¹æ€§ï¼š</strong></p>
</li>
<li>
<ul>
<li>æ”¯æŒå¤šæ•°æ®æºï¼ˆfailoverï¼‰ï¼›</li>
<li>æä¾› HTTP API å’Œ Java Clientï¼›</li>
<li>æ”¯æŒå¤šä¸šåŠ¡éš”ç¦»ï¼ˆç±»ä¼¼ biz_tagï¼‰</li>
</ul>
</li>
<li>
<p><strong>é€‚ç”¨ï¼šå·²æœ‰ MySQL é›†ç¾¤ã€éœ€å¤šç§Ÿæˆ·æ”¯æŒçš„åœºæ™¯</strong></p>
</li>
</ul>
<hr/>
<h2 data-id="heading-17">4. æ€»ç»“ä¸é€‰å‹å»ºè®®</h2>





























<table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ–¹æ¡ˆ</th></tr></thead><tbody><tr><td><strong>è¶…é«˜å¹¶å‘ã€æ— å®‰å…¨è¦æ±‚</strong></td><td>ç™¾åº¦ UidGenerator</td></tr><tr><td><strong>å·²æœ‰ MySQLã€éœ€ç®€å•é›†æˆ</strong></td><td>ç¾å›¢ Leaf-segment / æ»´æ»´ TinyID</td></tr><tr><td><strong>æ—  DB ä¾èµ–ã€å®¹å¿æ—¶é’Ÿé£é™©</strong></td><td>Snowflake / Leaf-snowflake</td></tr><tr><td><strong>ä¸´æ—¶ IDã€éä¸»é”®</strong></td><td>UUID</td></tr><tr><td><strong>å·²æœ‰ Redis æ¶æ„</strong></td><td>Redis INCR</td></tr></tbody></table>
<blockquote>
<p>âœ…Â <strong>æœ€ä½³å®è·µ</strong>ï¼š</p>
<ul>
<li>æ ¸å¿ƒä¸šåŠ¡ï¼ˆå¦‚è®¢å•ï¼‰å»ºè®®ä½¿ç”¨Â <strong>Leaf-segment</strong>ï¼ˆå¯æ§ã€ç¨³å®šï¼‰ï¼›</li>
<li>æ—¥å¿—è¿½è¸ªå¯ä½¿ç”¨Â <strong>UUID</strong>ï¼›</li>
<li>è‹¥è¿½æ±‚æè‡´æ€§èƒ½ä¸”èƒ½ç®¡æ§æ—¶é’Ÿï¼Œå¯é€‰Â <strong>UidGenerator</strong>ã€‚</li>
</ul>
</blockquote>
<hr/>
<h2 data-id="heading-18">å‚è€ƒèµ„æ–™</h2>
<ol>
<li>ç¾å›¢æŠ€æœ¯å›¢é˜Ÿ - Leaf</li>
<li>ç™¾åº¦ UidGenerator GitHub</li>
<li>Twitter Snowflake (Archived)</li>
<li>æ»´æ»´ TinyID GitHub</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŒ…è£…ç±»çš„ â€œç¼“å­˜é™·é˜±â€ï¼šInteger.valueOf (128) == 128 ä¸ºä½•ä¸º falseï¼Ÿ]]></title>    <link>https://juejin.cn/post/7586959875767861257</link>    <guid>https://juejin.cn/post/7586959875767861257</guid>    <pubDate>2025-12-24T01:10:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586959875767861257" data-draft-id="7585171571129712676" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŒ…è£…ç±»çš„ â€œç¼“å­˜é™·é˜±â€ï¼šInteger.valueOf (128) == 128 ä¸ºä½•ä¸º falseï¼Ÿ"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-24T01:10:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="uup"/> <meta itemprop="url" content="https://juejin.cn/user/4378706456356627"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŒ…è£…ç±»çš„ â€œç¼“å­˜é™·é˜±â€ï¼šInteger.valueOf (128) == 128 ä¸ºä½•ä¸º falseï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4378706456356627/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    uup
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T01:10:30.000Z" title="Wed Dec 24 2025 01:10:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€Bug åœºæ™¯</h2>
<p>åœ¨ä¸€ä¸ª Java é¡¹ç›®ä¸­ï¼Œå¼€å‘äººå‘˜åœ¨è¿›è¡Œæ•´æ•°åŒ…è£…ç±»Â <code>Integer</code>Â çš„æ¯”è¾ƒæ“ä½œæ—¶ï¼Œé‡åˆ°äº†ä¸€ä¸ªçœ‹ä¼¼å¥‡æ€ªçš„ç°è±¡ã€‚å½“ä½¿ç”¨Â <code>Integer.valueOf(128)</code>Â ä¸Â <code>128</code>Â è¿›è¡ŒÂ <code>==</code>Â æ¯”è¾ƒæ—¶ï¼Œç»“æœä¸ºÂ <code>false</code>ï¼Œè¿™ä¸ä»–ä»¬é¢„æœŸçš„ç»“æœä¸ç¬¦ï¼Œå› ä¸ºä»é€»è¾‘ä¸Šçœ‹è¿™ä¸¤ä¸ªå€¼åº”è¯¥ç›¸ç­‰ã€‚è¿™ä¸ªé—®é¢˜å¯¼è‡´äº†ä¸€äº›ä¾èµ–äºæ­£ç¡®æ¯”è¾ƒç»“æœçš„ä¸šåŠ¡é€»è¾‘å‡ºç°é”™è¯¯ï¼Œå½±å“äº†ç¨‹åºçš„æ­£å¸¸è¿è¡Œã€‚</p>
<h2 data-id="heading-1">äºŒã€ä»£ç ç¤ºä¾‹</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IntegerComparisonBugExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Integer</span> <span class="hljs-variable">num1</span> <span class="hljs-operator">=</span> Integer.valueOf(<span class="hljs-number">128</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">num2</span> <span class="hljs-operator">=</span> <span class="hljs-number">128</span>;

        System.out.println(<span class="hljs-string">"num1 == num2 çš„ç»“æœ: "</span> + (num1 == num2));
    }
}
</code></pre>
<h2 data-id="heading-2">ä¸‰ã€é—®é¢˜æè¿°</h2>
<ol>
<li><strong>é¢„æœŸè¡Œä¸º</strong>ï¼šå¼€å‘äººå‘˜é¢„æœŸÂ <code>num1 == num2</code>Â çš„ç»“æœä¸ºÂ <code>true</code>ï¼Œå› ä¸ºÂ <code>num1</code>Â æ˜¯é€šè¿‡Â <code>Integer.valueOf(128)</code>Â è·å–çš„Â <code>Integer</code>Â å¯¹è±¡ï¼Œè€ŒÂ <code>num2</code>Â æ˜¯å€¼ä¸ºÂ <code>128</code>Â çš„åŸºæœ¬æ•°æ®ç±»å‹Â <code>int</code>ï¼Œä»æ•°å€¼è§’åº¦çœ‹å®ƒä»¬æ˜¯ç›¸ç­‰çš„ã€‚</li>
<li><strong>å®é™…è¡Œä¸º</strong>ï¼šå®é™…è¾“å‡ºç»“æœä¸ºÂ <code>false</code>ã€‚è¿™æ˜¯å› ä¸ºÂ <code>Integer.valueOf()</code>Â æ–¹æ³•å­˜åœ¨ç¼“å­˜æœºåˆ¶ã€‚åœ¨ Java ä¸­ï¼Œ<code>Integer</code>Â ç±»å¯¹ - 128 åˆ° 127 ä¹‹é—´çš„æ•´æ•°è¿›è¡Œäº†ç¼“å­˜ã€‚å½“è°ƒç”¨Â <code>Integer.valueOf(int i)</code>Â æ–¹æ³•æ—¶ï¼Œå¦‚æœÂ <code>i</code>Â çš„å€¼åœ¨ - 128 åˆ° 127 è¿™ä¸ªèŒƒå›´å†…ï¼Œä¼šç›´æ¥è¿”å›ç¼“å­˜ä¸­çš„å¯¹è±¡ï¼›å¦‚æœè¶…å‡ºè¿™ä¸ªèŒƒå›´ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„Â <code>Integer</code>Â å¯¹è±¡ã€‚åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ<code>Integer.valueOf(128)</code>Â åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„Â <code>Integer</code>Â å¯¹è±¡ï¼Œè€ŒÂ <code>num2</code>Â æ˜¯åŸºæœ¬æ•°æ®ç±»å‹Â <code>int</code>ã€‚å½“ä½¿ç”¨Â <code>==</code>Â è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œå¯¹äºåŸºæœ¬æ•°æ®ç±»å‹å’ŒåŒ…è£…ç±»çš„æ¯”è¾ƒï¼Œ<code>num1</code>Â ä¼šè‡ªåŠ¨æ‹†ç®±ä¸ºÂ <code>int</code>Â ç±»å‹å†è¿›è¡Œæ¯”è¾ƒã€‚ä½†ç”±äºÂ <code>num1</code>Â æ˜¯æ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œåœ¨å†…å­˜åœ°å€ä¸Šä¸Â <code>num2</code>Â ä¸åŒï¼ˆå³ä½¿æ•°å€¼ç›¸åŒï¼‰ï¼Œæ‰€ä»¥Â <code>==</code>Â æ¯”è¾ƒç»“æœä¸ºÂ <code>false</code>ã€‚å¦‚æœä¸¤ä¸ªÂ <code>Integer</code>Â å¯¹è±¡éƒ½æ˜¯é€šè¿‡Â <code>valueOf</code>Â æ–¹æ³•è·å–ä¸”å€¼åœ¨ç¼“å­˜èŒƒå›´å†…ï¼Œ<code>==</code>Â æ¯”è¾ƒä¼šè¿”å›Â <code>true</code>ï¼Œå› ä¸ºå®ƒä»¬æŒ‡å‘åŒä¸€ä¸ªç¼“å­˜å¯¹è±¡ã€‚</li>
</ol>
<h2 data-id="heading-3">å››ã€è§£å†³æ–¹æ¡ˆ</h2>
<ol>
<li><strong>ä½¿ç”¨Â <code>equals</code>Â æ–¹æ³•</strong>ï¼šåœ¨è¿›è¡ŒÂ <code>Integer</code>Â ä¸Â <code>int</code>Â çš„æ¯”è¾ƒæ—¶ï¼Œå§‹ç»ˆä½¿ç”¨Â <code>equals</code>Â æ–¹æ³•ï¼Œè¿™æ ·æ¯”è¾ƒçš„æ˜¯æ•°å€¼è€Œä¸æ˜¯å†…å­˜åœ°å€ã€‚</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IntegerComparisonBugExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Integer</span> <span class="hljs-variable">num1</span> <span class="hljs-operator">=</span> Integer.valueOf(<span class="hljs-number">128</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">num2</span> <span class="hljs-operator">=</span> <span class="hljs-number">128</span>;

        System.out.println(<span class="hljs-string">"num1.equals(num2) çš„ç»“æœ: "</span> + num1.equals(num2));
    }
}
</code></pre>
<ol start="2">
<li><strong>äº†è§£ç¼“å­˜æœºåˆ¶å¹¶è°¨æ…ä½¿ç”¨Â <code>==</code></strong>ï¼šå¦‚æœç¡®å®éœ€è¦ä½¿ç”¨Â <code>==</code>Â è¿›è¡Œæ¯”è¾ƒï¼Œè¦ç¡®ä¿ä¸¤ä¸ªÂ <code>Integer</code>Â å¯¹è±¡éƒ½æ˜¯é€šè¿‡Â <code>valueOf</code>Â æ–¹æ³•è·å–ä¸”å€¼åœ¨ - 128 åˆ° 127 èŒƒå›´å†…ï¼Œæˆ–è€…æ˜ç¡®çŸ¥é“æ¯”è¾ƒçš„æ˜¯å¯¹è±¡å¼•ç”¨ï¼ˆå†…å­˜åœ°å€ï¼‰ã€‚ä¾‹å¦‚ï¼š</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IntegerComparisonBugExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Integer</span> <span class="hljs-variable">num1</span> <span class="hljs-operator">=</span> Integer.valueOf(<span class="hljs-number">127</span>);
        <span class="hljs-type">Integer</span> <span class="hljs-variable">num2</span> <span class="hljs-operator">=</span> Integer.valueOf(<span class="hljs-number">127</span>);

        System.out.println(<span class="hljs-string">"num1 == num2 çš„ç»“æœ: "</span> + (num1 == num2));
    }
}
</code></pre>
<p>è¿™é‡Œç”±äºÂ <code>127</code>Â åœ¨ç¼“å­˜èŒƒå›´å†…ï¼Œ<code>num1</code>Â å’ŒÂ <code>num2</code>Â æŒ‡å‘åŒä¸€ä¸ªç¼“å­˜å¯¹è±¡ï¼Œæ‰€ä»¥Â <code>==</code>Â æ¯”è¾ƒç»“æœä¸ºÂ <code>true</code>ã€‚ä½†è¿™ç§æ¯”è¾ƒæ–¹å¼ä¾èµ–äºç¼“å­˜æœºåˆ¶ï¼Œä½¿ç”¨æ—¶éœ€è°¨æ…ï¼Œé¿å…å› å€¼è¶…å‡ºç¼“å­˜èŒƒå›´å¯¼è‡´çš„æ„å¤–ç»“æœã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring Boot å¤šæ•°æ®æºä¸äº‹åŠ¡ç®¡ç†æ·±åº¦è§£æï¼šä»åŸç†åˆ°å®è·µ]]></title>    <link>https://juejin.cn/post/7586901995429789705</link>    <guid>https://juejin.cn/post/7586901995429789705</guid>    <pubDate>2025-12-24T00:39:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586901995429789705" data-draft-id="7586263211089215514" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring Boot å¤šæ•°æ®æºä¸äº‹åŠ¡ç®¡ç†æ·±åº¦è§£æï¼šä»åŸç†åˆ°å®è·µ"/> <meta itemprop="keywords" content="Java,Spring Boot"/> <meta itemprop="datePublished" content="2025-12-24T00:39:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é—²ç…®å…‰é˜´"/> <meta itemprop="url" content="https://juejin.cn/user/1523239911963420"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring Boot å¤šæ•°æ®æºä¸äº‹åŠ¡ç®¡ç†æ·±åº¦è§£æï¼šä»åŸç†åˆ°å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1523239911963420/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é—²ç…®å…‰é˜´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T00:39:39.000Z" title="Wed Dec 24 2025 00:39:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å¼•è¨€</h3>
<p>åœ¨ç°ä»£ä¼ä¸šçº§åº”ç”¨å¼€å‘ä¸­ï¼Œå¤šæ•°æ®æºçš„éœ€æ±‚æ—¥ç›Šæ™®éã€‚æ— è®ºæ˜¯æ•°æ®åº“è¯»å†™åˆ†ç¦»ã€å¤šç§Ÿæˆ·æ¶æ„ï¼Œè¿˜æ˜¯å¼‚æ„æ•°æ®æºé›†æˆï¼Œéƒ½éœ€è¦æˆ‘ä»¬æŒæ¡åœ¨ Spring Boot ä¸­é…ç½®å’Œç®¡ç†å¤šæ•°æ®æºçš„æŠ€æœ¯ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ Spring Boot æ•°æ®æºå’Œäº‹åŠ¡çš„åŠ è½½åŸç†ï¼Œå¹¶è¯¦ç»†è®²è§£å¤šç§å®ç°å¤šæ•°æ®æºçš„æ–¹æ¡ˆï¼Œç‰¹åˆ«æ˜¯å¦‚ä½•ä¿è¯åŠ¨æ€æ•°æ®æºåˆ‡æ¢çš„æ­£ç¡®æ€§ã€‚</p>
<h3 data-id="heading-1">ç¬¬ä¸€éƒ¨åˆ†ï¼šSpring Boot æ•°æ®æºä¸äº‹åŠ¡åŠ è½½åŸç†</h3>
<h4 data-id="heading-2">1.1 æ•°æ®æºè‡ªåŠ¨é…ç½®æœºåˆ¶</h4>
<p><strong>ä¾èµ–è§¦å‘ â†’ è‡ªåŠ¨é…ç½® â†’ Beanåˆ›å»º â†’ åº”ç”¨å¯åŠ¨</strong>
<strong>æ ¸å¿ƒç»„ä»¶åˆ†å·¥ï¼š</strong></p>
<ul>
<li>spring-boot-starter-*ï¼šä¾èµ–ç®¡ç†ï¼Œå¬é›†ç›¸å…³ç»„ä»¶</li>
<li>spring-jdbcï¼šæä¾›æ ¸å¿ƒ API å’Œç¼–ç¨‹æ¨¡å‹</li>
<li>spring-boot-autoconfigureï¼šè‡ªåŠ¨é…ç½®é€»è¾‘çš„å®ç°è€…</li>
</ul>
<p><strong>æ•°æ®æºåŠ è½½è¯¦ç»†æµç¨‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. è§¦å‘æ¡ä»¶ï¼šç±»è·¯å¾„å­˜åœ¨ DataSource.class</span>
<span class="hljs-meta">@ConditionalOnClass({DataSource.class, EmbeddedDatabaseType.class})</span>
<span class="hljs-meta">@EnableConfigurationProperties(DataSourceProperties.class)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataSourceAutoConfiguration</span> {
    
    <span class="hljs-comment">// 2. é…ç½®å±æ€§ç»‘å®š</span>
    <span class="hljs-meta">@ConfigurationProperties(prefix = "spring.datasource")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataSourceProperties</span> {
        <span class="hljs-keyword">private</span> String url;
        <span class="hljs-keyword">private</span> String username;
        <span class="hljs-keyword">private</span> String password;
        <span class="hljs-comment">// ...</span>
    }
    
    <span class="hljs-comment">// 3. æ•°æ®æºåˆ›å»ºï¼ˆé»˜è®¤HikariCPï¼‰</span>
    <span class="hljs-meta">@ConditionalOnMissingBean(DataSource.class)</span>
    <span class="hljs-meta">@ConditionalOnProperty(name = "spring.datasource.type", 
                          havingValue = "com.zaxxer.hikari.HikariDataSource", 
                          matchIfMissing = true)</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Hikari</span> {
        <span class="hljs-meta">@Bean</span>
        <span class="hljs-meta">@ConfigurationProperties(prefix = "spring.datasource.hikari")</span>
        HikariDataSource <span class="hljs-title function_">dataSource</span><span class="hljs-params">(DataSourceProperties properties)</span> {
            <span class="hljs-keyword">return</span> properties.initializeDataSourceBuilder()
                           .type(HikariDataSource.class)
                           .build();
        }
    }
}
</code></pre>
<h4 data-id="heading-3">1.2 äº‹åŠ¡ç®¡ç†åŠ è½½åŸç†</h4>
<p>äº‹åŠ¡ç®¡ç†çš„æ ¸å¿ƒæ˜¯ AOP ä»£ç†æœºåˆ¶ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// äº‹åŠ¡è‡ªåŠ¨é…ç½®</span>
<span class="hljs-meta">@ConditionalOnClass(PlatformTransactionManager.class)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TransactionAutoConfiguration</span> {
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-meta">@ConditionalOnMissingBean</span>
    <span class="hljs-keyword">public</span> PlatformTransactionManager <span class="hljs-title function_">transactionManager</span><span class="hljs-params">(DataSource dataSource)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataSourceTransactionManager</span>(dataSource);
    }
}

<span class="hljs-comment">// äº‹åŠ¡é¡¾é—®é…ç½®</span>
<span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@ConditionalOnBean(PlatformTransactionManager.class)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InfrastructureAdvisorAutoConfiguration</span> {
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> BeanFactoryTransactionAttributeSourceAdvisor <span class="hljs-title function_">transactionAdvisor</span><span class="hljs-params">(
            TransactionAttributeSource transactionAttributeSource,
            TransactionInterceptor transactionInterceptor)</span> {
        <span class="hljs-comment">// åˆ›å»ºäº‹åŠ¡åˆ‡é¢é¡¾é—®</span>
        <span class="hljs-keyword">return</span> advisor;
    }
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> TransactionInterceptor <span class="hljs-title function_">transactionInterceptor</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// åˆ›å»ºäº‹åŠ¡æ‹¦æˆªå™¨</span>
        <span class="hljs-keyword">return</span> interceptor;
    }
}
</code></pre>
<p>äº‹åŠ¡æ‰§è¡Œæµç¨‹ï¼š</p>
<ol>
<li>ä¸ºè¢«Â @TransactionalÂ æ³¨è§£çš„ Bean åˆ›å»ºä»£ç†</li>
<li>æ–¹æ³•è°ƒç”¨æ—¶è¢«Â TransactionInterceptorÂ æ‹¦æˆª</li>
<li>æ‹¦æˆªå™¨è°ƒç”¨Â PlatformTransactionManagerÂ ç®¡ç†äº‹åŠ¡</li>
<li>æ‰§è¡Œç›®æ ‡ä¸šåŠ¡æ–¹æ³•</li>
<li>æ ¹æ®æ‰§è¡Œç»“æœæäº¤æˆ–å›æ»šäº‹åŠ¡</li>
</ol>
<h3 data-id="heading-4">ç¬¬äºŒéƒ¨åˆ†ï¼šMyBatis å¤šæ•°æ®æºå®ç°æ–¹æ¡ˆ</h3>
<h4 data-id="heading-5">2.1 æ‰‹åŠ¨é…ç½®å¤šæ•°æ®æºï¼ˆç”Ÿäº§æ¨èï¼‰</h4>
<p><strong>é¡¹ç›®ç»“æ„è§„åˆ’ï¼š</strong></p>
<pre><code class="hljs language-text" lang="text">src/main/java/
â”œâ”€â”€ com/example/
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ PrimaryDataSourceConfig.java
â”‚   â”‚   â””â”€â”€ SecondaryDataSourceConfig.java
â”‚   â”œâ”€â”€ entity/
â”‚   â”‚   â”œâ”€â”€ primary/
â”‚   â”‚   â””â”€â”€ secondary/
â”‚   â”œâ”€â”€ mapper/
â”‚   â”‚   â”œâ”€â”€ primary/
â”‚   â”‚   â””â”€â”€ secondary/
â”‚   â””â”€â”€ service/
â””â”€â”€ resources/
    â”œâ”€â”€ mapper/
    â”‚   â”œâ”€â”€ primary/
    â”‚   â””â”€â”€ secondary/
    â””â”€â”€ application.yml
</code></pre>
<p><strong>é…ç½®æ–‡ä»¶ï¼š</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">datasource:</span>
    <span class="hljs-attr">primary:</span>
      <span class="hljs-attr">jdbc-url:</span> <span class="hljs-string">jdbc:mysql://localhost:3306/db1</span>
      <span class="hljs-attr">username:</span> <span class="hljs-string">user1</span>
      <span class="hljs-attr">password:</span> <span class="hljs-string">pass1</span>
      <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.cj.jdbc.Driver</span>
      <span class="hljs-attr">hikari:</span>
        <span class="hljs-attr">maximum-pool-size:</span> <span class="hljs-number">20</span>
        <span class="hljs-attr">connection-timeout:</span> <span class="hljs-number">30000</span>
    <span class="hljs-attr">secondary:</span>
      <span class="hljs-attr">jdbc-url:</span> <span class="hljs-string">jdbc:mysql://localhost:3306/db2</span>
      <span class="hljs-attr">username:</span> <span class="hljs-string">user2</span>
      <span class="hljs-attr">password:</span> <span class="hljs-string">pass2</span>
      <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.cj.jdbc.Driver</span>
      <span class="hljs-attr">hikari:</span>
        <span class="hljs-attr">maximum-pool-size:</span> <span class="hljs-number">15</span>
        <span class="hljs-attr">connection-timeout:</span> <span class="hljs-number">30000</span>
</code></pre>
<p>ä¸»æ•°æ®æºé…ç½®ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@MapperScan(
    basePackages = "com.example.mapper.primary",
    sqlSessionFactoryRef = "primarySqlSessionFactory"
)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PrimaryDataSourceConfig</span> {

    <span class="hljs-meta">@Bean("primaryDataSource")</span>
    <span class="hljs-meta">@ConfigurationProperties(prefix = "spring.datasource.primary")</span>
    <span class="hljs-meta">@Primary</span>
    <span class="hljs-keyword">public</span> DataSource <span class="hljs-title function_">primaryDataSource</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> DataSourceBuilder.create().build();
    }

    <span class="hljs-meta">@Bean("primarySqlSessionFactory")</span>
    <span class="hljs-meta">@Primary</span>
    <span class="hljs-keyword">public</span> SqlSessionFactory <span class="hljs-title function_">primarySqlSessionFactory</span><span class="hljs-params">(
            <span class="hljs-meta">@Qualifier("primaryDataSource")</span> DataSource dataSource)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">SqlSessionFactoryBean</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqlSessionFactoryBean</span>();
        sessionFactory.setDataSource(dataSource);
        sessionFactory.setMapperLocations(
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">PathMatchingResourcePatternResolver</span>()
                .getResources(<span class="hljs-string">"classpath:mapper/primary/*.xml"</span>));
        <span class="hljs-keyword">return</span> sessionFactory.getObject();
    }

    <span class="hljs-meta">@Bean("primaryTransactionManager")</span>
    <span class="hljs-meta">@Primary</span>
    <span class="hljs-keyword">public</span> PlatformTransactionManager <span class="hljs-title function_">primaryTransactionManager</span><span class="hljs-params">(
            <span class="hljs-meta">@Qualifier("primaryDataSource")</span> DataSource dataSource)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataSourceTransactionManager</span>(dataSource);
    }
}
</code></pre>
<p>ä¸šåŠ¡å±‚ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BusinessService</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> PrimaryUserMapper primaryUserMapper;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> SecondaryOrderMapper secondaryOrderMapper;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">BusinessService</span><span class="hljs-params">(PrimaryUserMapper primaryUserMapper,
                          SecondaryOrderMapper secondaryOrderMapper)</span> {
        <span class="hljs-built_in">this</span>.primaryUserMapper = primaryUserMapper;
        <span class="hljs-built_in">this</span>.secondaryOrderMapper = secondaryOrderMapper;
    }

    <span class="hljs-meta">@Transactional(transactionManager = "primaryTransactionManager")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createUserWithPrimary</span><span class="hljs-params">(PrimaryUser user)</span> {
        primaryUserMapper.insert(user);
    }

    <span class="hljs-meta">@Transactional(transactionManager = "secondaryTransactionManager")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrderWithSecondary</span><span class="hljs-params">(SecondaryOrder order)</span> {
        secondaryOrderMapper.insert(order);
    }
}
</code></pre>
<h4 data-id="heading-6">2.2 åŠ¨æ€æ•°æ®æºæ–¹æ¡ˆ</h4>
<p><strong>åŠ¨æ€æ•°æ®æºè·¯ç”±ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicDataSource</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractRoutingDataSource</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ThreadLocal&lt;String&gt; DATA_SOURCE_KEY = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setDataSource</span><span class="hljs-params">(String dataSource)</span> {
        DATA_SOURCE_KEY.set(dataSource);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clearDataSource</span><span class="hljs-params">()</span> {
        DATA_SOURCE_KEY.remove();
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> Object <span class="hljs-title function_">determineCurrentLookupKey</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> DATA_SOURCE_KEY.get();
    }
}
</code></pre>
<p><strong>åŠ¨æ€æ•°æ®æºé…ç½®ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@MapperScan(basePackages = "com.example.mapper")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicDataSourceConfig</span> {

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> DataSource <span class="hljs-title function_">dynamicDataSource</span><span class="hljs-params">(
            <span class="hljs-meta">@Qualifier("primaryDataSource")</span> DataSource primaryDataSource,
            <span class="hljs-meta">@Qualifier("secondaryDataSource")</span> DataSource secondaryDataSource)</span> {
        
        <span class="hljs-type">DynamicDataSource</span> <span class="hljs-variable">dynamicDataSource</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DynamicDataSource</span>();
        
        Map&lt;Object, Object&gt; targetDataSources = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        targetDataSources.put(<span class="hljs-string">"primary"</span>, primaryDataSource);
        targetDataSources.put(<span class="hljs-string">"secondary"</span>, secondaryDataSource);
        
        dynamicDataSource.setTargetDataSources(targetDataSources);
        dynamicDataSource.setDefaultTargetDataSource(primaryDataSource);
        
        <span class="hljs-keyword">return</span> dynamicDataSource;
    }
}
</code></pre>
<h3 data-id="heading-7">ç¬¬ä¸‰éƒ¨åˆ†ï¼šä¿è¯æ•°æ®æºåˆ‡æ¢ä¼˜å…ˆäºäº‹åŠ¡å¼€å¯</h3>
<h4 data-id="heading-8">3.1 é—®é¢˜åˆ†æ</h4>
<p>åœ¨åŠ¨æ€æ•°æ®æºåœºæ™¯ä¸­ï¼Œ<strong>æ•°æ®æºåˆ‡æ¢å¿…é¡»åœ¨äº‹åŠ¡å¼€å¯ä¹‹å‰</strong>æ‰§è¡Œï¼Œè¿™æ˜¯å› ä¸ºï¼š</p>
<ul>
<li>äº‹åŠ¡ç®¡ç†å™¨åœ¨äº‹åŠ¡å¼€å§‹æ—¶è·å–æ•°æ®åº“è¿æ¥</li>
<li>è¿æ¥è·å–ä¾èµ–äºå½“å‰è®¾ç½®çš„æ•°æ®æº</li>
<li>å¦‚æœæ•°æ®æºåˆ‡æ¢åœ¨äº‹åŠ¡å¼€å§‹ä¹‹åï¼Œå°†ä½¿ç”¨é”™è¯¯çš„æ•°æ®æº</li>
</ul>
<h4 data-id="heading-9">3.2 è§£å†³æ–¹æ¡ˆ</h4>
<p><strong>æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ @Order æ³¨è§£ï¼ˆæ¨èï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Aspect</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Order(0)</span> <span class="hljs-comment">// æœ€é«˜ä¼˜å…ˆçº§ï¼Œç¡®ä¿åœ¨äº‹åŠ¡åˆ‡é¢ä¹‹å‰æ‰§è¡Œ</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataSourceAspect</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(DataSourceAspect.class);

    <span class="hljs-meta">@Around("@annotation(dataSource)")</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">aroundDataSource</span><span class="hljs-params">(ProceedingJoinPoint point, DataSource dataSource)</span> <span class="hljs-keyword">throws</span> Throwable {
        <span class="hljs-type">String</span> <span class="hljs-variable">dsName</span> <span class="hljs-operator">=</span> dataSource.value();
        <span class="hljs-type">String</span> <span class="hljs-variable">methodName</span> <span class="hljs-operator">=</span> point.getSignature().getName();
        
        <span class="hljs-type">boolean</span> <span class="hljs-variable">wasDataSourceSet</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å·²æœ‰äº‹åŠ¡ï¼ˆè­¦å‘Šæç¤ºï¼‰</span>
            <span class="hljs-keyword">if</span> (TransactionSynchronizationManager.isActualTransactionActive()) {
                logger.warn(<span class="hljs-string">"æ£€æµ‹åˆ°åœ¨äº‹åŠ¡å¼€å¯ååˆ‡æ¢æ•°æ®æºï¼Œæ–¹æ³•: {}ï¼Œæ•°æ®æº: {}ï¼Œè¿™å¯èƒ½å¯¼è‡´æ•°æ®æºåˆ‡æ¢å¤±æ•ˆ!"</span>, 
                           methodName, dsName);
            }
            
            <span class="hljs-comment">// è®¾ç½®æ•°æ®æº</span>
            DynamicDataSource.setDataSource(dsName);
            wasDataSourceSet = <span class="hljs-literal">true</span>;
            logger.debug(<span class="hljs-string">"æ•°æ®æºå·²åˆ‡æ¢è‡³: {}ï¼Œæ–¹æ³•: {}"</span>, dsName, methodName);
            
            <span class="hljs-comment">// æ‰§è¡Œç›®æ ‡æ–¹æ³•</span>
            <span class="hljs-keyword">return</span> point.proceed();
            
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// æ¸…ç†æ•°æ®æº</span>
            <span class="hljs-keyword">if</span> (wasDataSourceSet) {
                DynamicDataSource.clearDataSource();
                logger.debug(<span class="hljs-string">"å·²æ¸…ç†æ•°æ®æº: {}"</span>, dsName);
            }
        }
    }
}
</code></pre>
<p><strong>æ–¹æ¡ˆäºŒï¼šè‡ªå®šä¹‰ Advisorï¼ˆæ›´ç²¾ç»†æ§åˆ¶ï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataSourceAdvisor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractPointcutAdvisor</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> StaticMethodMatcherPointcut pointcut;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> DataSourceInterceptor interceptor;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DataSourceAdvisor</span><span class="hljs-params">(DataSourceInterceptor interceptor)</span> {
        <span class="hljs-built_in">this</span>.interceptor = interceptor;
        <span class="hljs-built_in">this</span>.pointcut = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StaticMethodMatcherPointcut</span>() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">matches</span><span class="hljs-params">(Method method, Class&lt;?&gt; targetClass)</span> {
                <span class="hljs-keyword">return</span> method.isAnnotationPresent(DataSource.class) ||
                       targetClass.isAnnotationPresent(DataSource.class);
            }
        };
        <span class="hljs-comment">// è®¾ç½®æœ€é«˜ä¼˜å…ˆçº§</span>
        setOrder(Ordered.HIGHEST_PRECEDENCE);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Pointcut <span class="hljs-title function_">getPointcut</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> pointcut;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Advice <span class="hljs-title function_">getAdvice</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> interceptor;
    }
}
</code></pre>
<p><strong>æ–¹æ¡ˆä¸‰ï¼šäº‹åŠ¡åŒæ­¥å›è°ƒï¼ˆå¤„ç†äº‹åŠ¡ç¯å¢ƒï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Aspect</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Order(0)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataSourceAspect</span> {

    <span class="hljs-meta">@Around("@annotation(dataSource)")</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">aroundSwitchDataSource</span><span class="hljs-params">(ProceedingJoinPoint point, DataSource dataSource)</span> <span class="hljs-keyword">throws</span> Throwable {
        <span class="hljs-type">String</span> <span class="hljs-variable">dsName</span> <span class="hljs-operator">=</span> dataSource.value();
        
        <span class="hljs-comment">// å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œç›´æ¥åˆ‡æ¢å¹¶æ‰§è¡Œ</span>
        <span class="hljs-keyword">if</span> (!TransactionSynchronizationManager.isActualTransactionActive()) {
            <span class="hljs-keyword">return</span> executeWithDataSource(point, dsName);
        }
        
        <span class="hljs-comment">// å¦‚æœå·²ç»æœ‰äº‹åŠ¡ï¼Œæ³¨å†Œå›è°ƒç¡®ä¿æ•°æ®æºæ¸…ç†</span>
        DynamicDataSource.setDataSource(dsName);
        <span class="hljs-keyword">try</span> {
            TransactionSynchronizationManager.registerSynchronization(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransactionSynchronization</span>() {
                    <span class="hljs-meta">@Override</span>
                    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCompletion</span><span class="hljs-params">(<span class="hljs-type">int</span> status)</span> {
                        DynamicDataSource.clearDataSource();
                    }
                }
            );
            <span class="hljs-keyword">return</span> point.proceed();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            DynamicDataSource.clearDataSource();
            <span class="hljs-keyword">throw</span> e;
        }
    }
    
    <span class="hljs-keyword">private</span> Object <span class="hljs-title function_">executeWithDataSource</span><span class="hljs-params">(ProceedingJoinPoint point, String dsName)</span> <span class="hljs-keyword">throws</span> Throwable {
        DynamicDataSource.setDataSource(dsName);
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> point.proceed();
        } <span class="hljs-keyword">finally</span> {
            DynamicDataSource.clearDataSource();
        }
    }
}
</code></pre>
<h4 data-id="heading-10">3.3 æœ€ä½³å®è·µç¤ºä¾‹</h4>
<p><strong>æ•°æ®æºæ³¨è§£å®šä¹‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Target({ElementType.METHOD, ElementType.TYPE})</span>
<span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span>
<span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> DataSource {
    String <span class="hljs-title function_">value</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-string">"primary"</span>;
}
</code></pre>
<p><strong>Serviceå±‚ä½¿ç”¨è§„èŒƒï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    
    <span class="hljs-comment">// æ­£ç¡®ç”¨æ³•ï¼šæ³¨è§£åœ¨åŒä¸€ä¸ªæ–¹æ³•ä¸Š</span>
    <span class="hljs-meta">@DataSource("primary")</span>
    <span class="hljs-meta">@Transactional(transactionManager = "primaryTransactionManager")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createUserInPrimary</span><span class="hljs-params">(User user)</span> {
        <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘</span>
    }
    
    <span class="hljs-comment">// æ­£ç¡®ç”¨æ³•ï¼šæ³¨è§£åœ¨ç±»ä¸Šï¼Œå½±å“æ‰€æœ‰æ–¹æ³•</span>
    <span class="hljs-meta">@DataSource("secondary")</span>  
    <span class="hljs-meta">@Transactional(transactionManager = "secondaryTransactionManager")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createUserInSecondary</span><span class="hljs-params">(User user)</span> {
        <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘</span>
    }
    
    <span class="hljs-comment">// é”™è¯¯ç”¨æ³•ï¼šé¿å…åœ¨å†…éƒ¨æ–¹æ³•è°ƒç”¨æ—¶åˆ‡æ¢æ•°æ®æº</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">problematicMethod</span><span class="hljs-params">(User user)</span> {
        <span class="hljs-comment">// è¿™é‡Œçš„æ•°æ®æºåˆ‡æ¢å¯èƒ½å¤±æ•ˆ</span>
        switchToSecondary();
        createUserInSecondary(user); <span class="hljs-comment">// äº‹åŠ¡å¯èƒ½å·²ç»ä½¿ç”¨é»˜è®¤æ•°æ®æº</span>
    }
    
    <span class="hljs-meta">@DataSource("secondary")</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">switchToSecondary</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ç§æœ‰æ–¹æ³•ä¸Šçš„æ³¨è§£ä¸ä¼šè¢«ä»£ç†æ‹¦æˆª</span>
    }
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>