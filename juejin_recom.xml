<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[2025 nodejs å‘ç”Ÿå“ªäº›é‡å¤§æ”¹å˜ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7591348605865820195</link>    <guid>https://juejin.cn/post/7591348605865820195</guid>    <pubDate>2026-01-04T14:59:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591348605865820195" data-draft-id="7591350620188966918" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2025 nodejs å‘ç”Ÿå“ªäº›é‡å¤§æ”¹å˜ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-04T14:59:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜æœˆ_æ¸…é£"/> <meta itemprop="url" content="https://juejin.cn/user/1081575170131006"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2025 nodejs å‘ç”Ÿå“ªäº›é‡å¤§æ”¹å˜ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1081575170131006/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜æœˆ_æ¸…é£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T14:59:17.000Z" title="Sun Jan 04 2026 14:59:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>2025å¹´è¢«ç¤¾åŒºç§°ä¸º Node.js çš„â€œç°ä»£åŒ–å…ƒå¹´â€ã€‚åœ¨è¿™ä¸€å¹´ï¼ŒNode.js å®Œæˆäº†ä»â€œéœ€è¦å¤§é‡é…ç½®çš„å·¥å…·â€åˆ°â€œåŸç”Ÿå…¨èƒ½è¿è¡Œæ—¶â€çš„åä¸½è½¬èº«ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ 2025 å¹´ Node.js å‘ç”Ÿçš„å››é¡¹è¶³ä»¥æ”¹å˜ä½ å¼€å‘ä¹ æƒ¯çš„é‡å¤§å˜é©ï¼š</p>
<hr/>
<h3 data-id="heading-0">1. åŸç”Ÿæ”¯æŒ TypeScript (Native TS Execution)</h3>
<p>è¿™æ˜¯ 2025 å¹´æœ€å—å‰ç«¯æ¬¢è¿çš„æ”¹å˜ã€‚</p>
<ul>
<li><strong>ä¸å†éœ€è¦ç¼–è¯‘ï¼š</strong> ä» Node.js 22.6/23 ç‰ˆæœ¬å¼€å§‹ï¼ŒNode å†…ç½®äº†â€œç±»å‹å‰¥ç¦»ï¼ˆType Strippingï¼‰â€åŠŸèƒ½ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ç›´æ¥è¿è¡Œ <code>node index.ts</code>ï¼ŒNode ä¼šåœ¨æ‰§è¡Œå‰è‡ªåŠ¨ç§»é™¤ç±»å‹å®šä¹‰ï¼Œè€Œæ— éœ€å®‰è£… <code>ts-node</code>ã€<code>tsx</code> æˆ–é…ç½®ç¹ççš„ <code>tsconfig.js</code>ã€‚</li>
<li><strong>å¼€å‘ä½“éªŒï¼š</strong> é…åˆ Node è‡ªå¸¦çš„ <code>--watch</code> æ¨¡å¼ï¼Œå‰ç«¯è„šæœ¬çš„å¼€å‘æµç¨‹å˜å¾—åƒå†™åŸç”Ÿ JS ä¸€æ ·å¿«ï¼Œå·¥ç¨‹é“¾è·¯æå…¶ç®€åŒ–ã€‚</li>
</ul>
<h3 data-id="heading-1">2. CommonJS ä¸ ESM çš„â€œä¸–çºªå¤§å’Œè§£â€ (<code>require(esm)</code>)</h3>
<p>å›°æ‰°å‰ç«¯å¤šå¹´çš„ <code>ERR_REQUIRE_ESM</code> æŠ¥é”™åœ¨ 2025 å¹´æ­£å¼æˆä¸ºå†å²ã€‚</p>
<ul>
<li><strong>åŒæ­¥åŠ è½½ï¼š</strong> Node.js å®ç°äº†åŒæ­¥çš„ <code>require(esm)</code>ã€‚ç°åœ¨ï¼Œä½ å¯ä»¥åœ¨æ—§çš„ CommonJS é¡¹ç›®ä¸­ç›´æ¥ <code>require</code> ä¸€ä¸ªçº¯ ESM çš„ç¬¬ä¸‰æ–¹åŒ…ã€‚</li>
<li><strong>åº“ç»´æŠ¤è€…çš„è§£è„±ï¼š</strong> å¹¿å¤§ npm åŒ…ä½œè€…ç»ˆäºä¸éœ€è¦è´¹åŠ²å¿ƒæ€å‘å¸ƒâ€œåŒæ¨¡å—ï¼ˆDual Buildï¼‰â€ç‰ˆæœ¬äº†ï¼Œè¿™æå¤§åœ°åŠ é€Ÿäº†å‰ç«¯ç”Ÿæ€å‘çº¯ ESM è¿ç§»çš„è¿›åº¦ã€‚</li>
</ul>
<h3 data-id="heading-2">3. å®‰å…¨æƒé™æ¨¡å‹æ­£å¼ç¨³å®š (Permission Model)</h3>
<p>Node.js å€Ÿé‰´äº† Deno çš„å®‰å…¨ç†å¿µï¼Œå¼•å…¥äº†<strong>å®éªŒæ€§è½¬ç¨³å®š</strong>çš„æƒé™æ§åˆ¶ç³»ç»Ÿã€‚</p>
<ul>
<li><strong>ç²¾å‡†é™åˆ¶ï¼š</strong> ä½ ç°åœ¨å¯ä»¥ä½¿ç”¨ <code>--allow-fs-read</code>ã€<code>--allow-net</code> ç­‰å‘½ä»¤è¡Œæ ‡å¿—æ¥è¿è¡Œç¨‹åºã€‚</li>
<li><strong>é˜²èŒƒä¾›åº”é“¾æ”»å‡»ï¼š</strong> æ¯”å¦‚è¿è¡Œä¸€ä¸ªä¸å¯ä¿¡çš„ npm è„šæœ¬æ—¶ï¼Œä½ å¯ä»¥é™åˆ¶å®ƒâ€œåªå…è®¸è¯»å– <code>./src</code> ç›®å½•ï¼Œç¦æ­¢è®¿é—®ç½‘ç»œâ€ã€‚å³ä¾¿åŒ…é‡Œæœ‰æ¶æ„ä»£ç ï¼Œä¹Ÿæ— æ³•å·å·ä¸Šä¼ ä½ çš„ <code>.env</code> æ•æ„Ÿæ–‡ä»¶ã€‚</li>
</ul>
<h3 data-id="heading-3">4. æ·±åº¦å¯¹é½ Web æ ‡å‡†ä¸å†…ç½®å†…ç½®æ•°æ®åº“</h3>
<p>Node.js è¶Šæ¥è¶Šåƒæµè§ˆå™¨ï¼Œä¹Ÿè¶Šæ¥è¶Šåƒä¸€ä¸ªå®Œæ•´çš„å¹³å°ã€‚</p>
<ul>
<li><strong>Web Storage å…¥é©»ï¼š</strong> Node.js 25 é»˜è®¤å¯ç”¨äº† <code>localStorage</code> å’Œ <code>sessionStorage</code>ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨æœåŠ¡ç«¯ç›´æ¥ä½¿ç”¨å’Œæµè§ˆå™¨ä¸€æ¨¡ä¸€æ ·çš„ API æ¥åšæ•°æ®æŒä¹…åŒ–ï¼ŒSSRï¼ˆæœåŠ¡ç«¯æ¸²æŸ“ï¼‰çš„ä»£ç å¤ç”¨ç‡å¤§å¹…æå‡ã€‚</li>
<li><strong>å†…ç½® SQLiteï¼š</strong> Node.js ç°åœ¨å†…ç½®äº† <code>node:sqlite</code> æ¨¡å—ã€‚å¯¹äºå°å‹åº”ç”¨æˆ–æœ¬åœ°å·¥å…·ï¼Œä½ ä¸å†éœ€è¦å®‰è£…è‡ƒè‚¿çš„ <code>sqlite3</code> é©±åŠ¨ï¼Œç›´æ¥è°ƒç”¨åŸç”Ÿçš„é«˜æ€§èƒ½æ•°æ®åº“æ¥å£ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-4">æ€»ç»“ï¼š2025 å¹´ç»™å‰ç«¯å¸¦æ¥çš„å˜åŒ–</h3>






























<table><thead><tr><th><strong>æ”¹å˜ç‚¹</strong></th><th><strong>è¿‡å» (2024ä»¥å‰)</strong></th><th><strong>ç°åœ¨ (2025/2026)</strong></th></tr></thead><tbody><tr><td><strong>TS å¼€å‘</strong></td><td>é…ç½® <code>esbuild</code> / <code>swc</code> / <code>tsx</code></td><td><strong>ç›´æ¥è¿è¡Œ <code>node file.ts</code></strong></td></tr><tr><td><strong>æ¨¡å—å†²çª</strong></td><td><code>require</code> åŠ è½½ ESM æŠ¥é”™</td><td><strong><code>require</code> å®Œç¾å…¼å®¹ ESM</strong></td></tr><tr><td><strong>å®‰å…¨æ€§</strong></td><td>é»˜è®¤å…¨æƒé™ï¼ˆä¸å®‰å…¨ï¼‰</td><td><strong>æ˜¾å¼æƒé™æ§åˆ¶ (<code>--allow-*)</code></strong></td></tr><tr><td><strong>æœ¬åœ°å­˜å‚¨</strong></td><td>å¯»æ‰¾ç¬¬ä¸‰æ–¹ File DB åº“</td><td><strong>å†…ç½® SQLite &amp; localStorage</strong></td></tr></tbody></table>
<p><strong>ä½œä¸ºå‰ç«¯ï¼Œä½ æ˜¯å¦å·²ç»åŒå€¦äº†å„ç§æ‰“åŒ…å·¥å…·çš„é…ç½®ï¼Ÿ</strong> æ—¢ç„¶ Node.js å·²ç»å†…ç½®äº† TS æ”¯æŒå’ŒåŸç”Ÿ Web APIï¼Œæˆ‘å¯ä»¥æ•™ä½ å¦‚ä½•è„±ç¦»æ„å»ºå·¥å…·ï¼Œç›´æ¥ç”¨â€œåŸç”Ÿ Nodeâ€å†™ä¸€ä¸ªé«˜æ€§èƒ½çš„è‡ªåŠ¨åŒ–è„šæœ¬ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3-å¼‚æ­¥ç»„ä»¶ && suspense]]></title>    <link>https://juejin.cn/post/7591346773827715098</link>    <guid>https://juejin.cn/post/7591346773827715098</guid>    <pubDate>2026-01-04T12:31:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591346773827715098" data-draft-id="7591334208997261338" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3-å¼‚æ­¥ç»„ä»¶ &amp;&amp; suspense"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2026-01-04T12:31:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="YaeZed"/> <meta itemprop="url" content="https://juejin.cn/user/3977350021390107"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3-å¼‚æ­¥ç»„ä»¶ &amp;&amp; suspense
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3977350021390107/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    YaeZed
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T12:31:46.000Z" title="Sun Jan 04 2026 12:31:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body .octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}.markdown-body .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown-body .anchor:focus{outline:none}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1:hover .anchor .octicon-link:before,.markdown-body h2:hover .anchor .octicon-link:before,.markdown-body h3:hover .anchor .octicon-link:before,.markdown-body h4:hover .anchor .octicon-link:before,.markdown-body h5:hover .anchor .octicon-link:before,.markdown-body h6:hover .anchor .octicon-link:before{width:16px;height:16px;content:" ";display:inline-block;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E")}.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body details{display:block}.markdown-body summary{display:list-item}.markdown-body a{background-color:initial}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body strong{font-weight:inherit;font-weight:bolder}.markdown-body h1{margin:.67em 0}.markdown-body img{border-style:none}.markdown-body code,.markdown-body kbd,.markdown-body pre{font-family:monospace,monospace;font-size:1em}.markdown-body hr{box-sizing:initial;overflow:visible}.markdown-body input{font:inherit;margin:0;overflow:visible}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body input{font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body a{color:#0366d6;text-decoration:none}.markdown-body a:hover{text-decoration:underline}.markdown-body strong{font-weight:600}.markdown-body hr{height:0;margin:15px 0;overflow:hidden;background:transparent;border-bottom:1px solid #dfe2e5}.markdown-body hr:after,.markdown-body hr:before{display:table;content:""}.markdown-body hr:after{clear:both}.markdown-body table{border-spacing:0;border-collapse:collapse}.markdown-body td,.markdown-body th{padding:0}.markdown-body details summary{cursor:pointer}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:0;margin-bottom:0}.markdown-body h1{font-size:32px}.markdown-body h1,.markdown-body h2{font-weight:600}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:20px}.markdown-body h3,.markdown-body h4{font-weight:600}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:14px}.markdown-body h5,.markdown-body h6{font-weight:600}.markdown-body h6{font-size:12px}.markdown-body p{margin-top:0;margin-bottom:10px}.markdown-body blockquote{margin:0}.markdown-body ol,.markdown-body ul{padding-left:0;margin-top:0;margin-bottom:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body dd{margin-left:0}.markdown-body code,.markdown-body pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}.markdown-body pre{margin-top:0;margin-bottom:0}.markdown-body input::-webkit-inner-spin-button,.markdown-body input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none;appearance:none}.markdown-body :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}.markdown-body .border{border:1px solid #e1e4e8!important}.markdown-body .border-0{border:0!important}.markdown-body .border-bottom{border-bottom:1px solid #e1e4e8!important}.markdown-body .rounded-1{border-radius:3px!important}.markdown-body .bg-white{background-color:#fff!important}.markdown-body .bg-gray-light{background-color:#fafbfc!important}.markdown-body .text-gray-light{color:#6a737d!important}.markdown-body .pl-3,.markdown-body .px-3{padding-left:16px!important}.markdown-body .px-3{padding-right:16px!important}.markdown-body .f6{font-size:12px!important}.markdown-body .lh-condensed{line-height:1.25!important}.markdown-body .text-bold{font-weight:600!important}.markdown-body .pl-c{color:#6a737d}.markdown-body .pl-c1,.markdown-body .pl-s .pl-v{color:#005cc5}.markdown-body .pl-e,.markdown-body .pl-en{color:#6f42c1}.markdown-body .pl-s .pl-s1,.markdown-body .pl-smi{color:#24292e}.markdown-body .pl-ent{color:#22863a}.markdown-body .pl-k{color:#d73a49}.markdown-body .pl-pds,.markdown-body .pl-s,.markdown-body .pl-s .pl-pse .pl-s1,.markdown-body .pl-sr,.markdown-body .pl-sr .pl-cce,.markdown-body .pl-sr .pl-sra,.markdown-body .pl-sr .pl-sre{color:#032f62}.markdown-body .pl-smw,.markdown-body .pl-v{color:#e36209}.markdown-body .pl-bu{color:#b31d28}.markdown-body .pl-ii{color:#fafbfc;background-color:#b31d28}.markdown-body .pl-c2{color:#fafbfc;background-color:#d73a49}.markdown-body .pl-c2:before{content:"^M"}.markdown-body .pl-sr .pl-cce{font-weight:700;color:#22863a}.markdown-body .pl-ml{color:#735c0f}.markdown-body .pl-mh,.markdown-body .pl-mh .pl-en,.markdown-body .pl-ms{font-weight:700;color:#005cc5}.markdown-body .pl-mi{font-style:italic;color:#24292e}.markdown-body .pl-mb{font-weight:700;color:#24292e}.markdown-body .pl-md{color:#b31d28;background-color:#ffeef0}.markdown-body .pl-mi1{color:#22863a;background-color:#f0fff4}.markdown-body .pl-mc{color:#e36209;background-color:#ffebda}.markdown-body .pl-mi2{color:#f6f8fa;background-color:#005cc5}.markdown-body .pl-mdr{font-weight:700;color:#6f42c1}.markdown-body .pl-ba{color:#586069}.markdown-body .pl-sg{color:#959da5}.markdown-body .pl-corl{text-decoration:underline;color:#032f62}.markdown-body .mb-0{margin-bottom:0!important}.markdown-body .my-2{margin-bottom:8px!important;margin-top:8px!important}.markdown-body .pl-0{padding-left:0!important}.markdown-body .py-0{padding-top:0!important;padding-bottom:0!important}.markdown-body .pl-1{padding-left:4px!important}.markdown-body .pl-2{padding-left:8px!important}.markdown-body .py-2{padding-top:8px!important;padding-bottom:8px!important}.markdown-body .pl-3{padding-left:16px!important}.markdown-body .pl-4{padding-left:24px!important}.markdown-body .pl-5{padding-left:32px!important}.markdown-body .pl-6{padding-left:40px!important}.markdown-body .pl-7{padding-left:48px!important}.markdown-body .pl-8{padding-left:64px!important}.markdown-body .pl-9{padding-left:80px!important}.markdown-body .pl-10{padding-left:96px!important}.markdown-body .pl-11{padding-left:112px!important}.markdown-body .pl-12{padding-left:128px!important}.markdown-body hr{border-bottom-color:#eee}.markdown-body kbd{display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body&gt;:first-child{margin-top:0!important}.markdown-body&gt;:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body blockquote,.markdown-body details,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e1e4e8;border:0}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eaecef}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#6a737d}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li{word-wrap:break-all}.markdown-body li&gt;p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #dfe2e5}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{max-width:100%;box-sizing:initial;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body code{padding:.2em .4em;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body pre{word-wrap:normal}.markdown-body pre&gt;code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:initial;border:0}.markdown-body .commit-tease-sha{display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%;color:#444d56}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}.markdown-body .blob-wrapper{overflow-x:auto;overflow-y:hidden}.markdown-body .blob-wrapper-embedded{max-height:240px;overflow-y:auto}.markdown-body .blob-num{width:1%;min-width:50px;padding-right:10px;padding-left:10px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;vertical-align:top;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-body .blob-num:hover{color:rgba(27,31,35,.6)}.markdown-body .blob-num:before{content:attr(data-line-number)}.markdown-body .blob-code{position:relative;padding-right:10px;padding-left:10px;line-height:20px;vertical-align:top}.markdown-body .blob-code-inner{overflow:visible;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;color:#24292e;word-wrap:normal;white-space:pre}.markdown-body .pl-token.active,.markdown-body .pl-token:hover{cursor:pointer;background:#ffea7f}.markdown-body .tab-size[data-tab-size="1"]{-moz-tab-size:1;tab-size:1}.markdown-body .tab-size[data-tab-size="2"]{-moz-tab-size:2;tab-size:2}.markdown-body .tab-size[data-tab-size="3"]{-moz-tab-size:3;tab-size:3}.markdown-body .tab-size[data-tab-size="4"]{-moz-tab-size:4;tab-size:4}.markdown-body .tab-size[data-tab-size="5"]{-moz-tab-size:5;tab-size:5}.markdown-body .tab-size[data-tab-size="6"]{-moz-tab-size:6;tab-size:6}.markdown-body .tab-size[data-tab-size="7"]{-moz-tab-size:7;tab-size:7}.markdown-body .tab-size[data-tab-size="8"]{-moz-tab-size:8;tab-size:8}.markdown-body .tab-size[data-tab-size="9"]{-moz-tab-size:9;tab-size:9}.markdown-body .tab-size[data-tab-size="10"]{-moz-tab-size:10;tab-size:10}.markdown-body .tab-size[data-tab-size="11"]{-moz-tab-size:11;tab-size:11}.markdown-body .tab-size[data-tab-size="12"]{-moz-tab-size:12;tab-size:12}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}</style><style data-highlight="" data-highlight-key="gml">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#222;color:silver}.hljs-keyword{color:#ffb871;font-weight:700}.hljs-built_in{color:#ffb871}.hljs-literal{color:#ff8080}.hljs-symbol{color:#58e55a}.hljs-comment{color:#5b995b}.hljs-string{color:#ff0}.hljs-number{color:#ff8080}.hljs-addition,.hljs-attribute,.hljs-bullet,.hljs-code,.hljs-deletion,.hljs-doctag,.hljs-function,.hljs-link,.hljs-meta,.hljs-meta-keyword,.hljs-name,.hljs-quote,.hljs-regexp,.hljs-section,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-selector-tag,.hljs-subst,.hljs-template-tag,.hljs-template-variable,.hljs-title,.hljs-type,.hljs-variable{color:silver}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>å¼‚æ­¥ç»„ä»¶</strong>ï¼ˆAsync Componentsï¼‰ä¹Ÿç§°ä¸º<strong>æ‡’åŠ è½½ç»„ä»¶</strong>ï¼ˆLazy-loaded Componentsï¼‰ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒWebpack æˆ– Vite ç­‰æ„å»ºå·¥å…·ä¼šæŠŠä½ æ‰€æœ‰çš„ç»„ä»¶æ‰“åŒ…åˆ°ä¸€ä¸ªï¼ˆæˆ–å‡ ä¸ªï¼‰JavaScript æ–‡ä»¶ä¸­ã€‚å½“ç”¨æˆ·è®¿é—®ä½ çš„ç½‘ç«™æ—¶ï¼Œä»–ä»¬å¿…é¡»ä¸€æ¬¡æ€§ä¸‹è½½æ‰€æœ‰ä»£ç ï¼Œè¿™å¯èƒ½å¯¼è‡´åˆå§‹åŠ è½½æ—¶é—´å¾ˆé•¿ã€‚</p>
<p>å¼‚æ­¥ç»„ä»¶å…è®¸ä½ å°†æŸäº›ç»„ä»¶ï¼ˆé€šå¸¸æ˜¯â€œé‡é‡çº§â€æˆ–ä¸æ€»æ˜¯éœ€è¦ç«‹å³æ˜¾ç¤ºçš„ç»„ä»¶ï¼‰åˆ†ç¦»æˆ<strong>å•ç‹¬çš„ JavaScript æ–‡ä»¶ï¼ˆchunkï¼‰</strong> ã€‚è¿™äº›æ–‡ä»¶åªä¼šåœ¨<strong>å®é™…éœ€è¦æ¸²æŸ“è¯¥ç»„ä»¶æ—¶</strong>æ‰ä»æœåŠ¡å™¨ä¸‹è½½ã€‚</p>
<p><strong>ä¸»è¦å¥½å¤„ï¼š</strong></p>
<ul>
<li><strong>ä»£ç åˆ†å‰² (Code-splitting)ï¼š</strong> å‡å°åˆå§‹åŒ…çš„ä½“ç§¯ã€‚</li>
<li><strong>æå‡æ€§èƒ½ï¼š</strong> åŠ å¿«åº”ç”¨çš„åˆå§‹åŠ è½½å’Œæ¸²æŸ“é€Ÿåº¦ã€‚</li>
</ul>
<h2 data-id="heading-0">1.åœ¨ Vue 3 ä¸­, ä½¿ç”¨ <code>defineAsyncComponent</code> å‡½æ•°æ¥åˆ›å»ºå¼‚æ­¥ç»„ä»¶</h2>
<p>ä¸¾ä¸ªæ —å­ï¼Œéª¨æ¶å±ï¼Œå‡†å¤‡ä¸¤ä¸ªç»„ä»¶ï¼Œcardå’Œskeleton</p>
<blockquote>
<p>card.vue</p>
</blockquote>
<pre><code class="hljs language-ts" lang="ts">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"user-info"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">:src</span>=<span class="hljs-string">"user.avatar"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"avatar"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"user-name"</span>&gt;</span>{{ user.name }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">hr</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"content"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ user.content }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;
interface <span class="hljs-title class_">User</span> {
  <span class="hljs-attr">id</span>: number;
  <span class="hljs-attr">name</span>: string;
  <span class="hljs-attr">avatar</span>: string;
  <span class="hljs-attr">content</span>: string;
}

<span class="hljs-keyword">const</span> user = ref&lt;<span class="hljs-title class_">User</span>&gt;({
  <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">name</span>: <span class="hljs-string">"YaeZed"</span>,
  <span class="hljs-attr">avatar</span>: <span class="hljs-string">"https://avatars.githubusercontent.com/u/52018740?v=5"</span>,
  <span class="hljs-attr">content</span>: <span class="hljs-string">"Hello, Vue3!"</span>,
});
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.card</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">300px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">300px</span>;
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">2px</span> <span class="hljs-number">2px</span> <span class="hljs-number">10px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.3</span>);
}

<span class="hljs-selector-class">.user-info</span> {
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">flex-direction</span>: row;
  <span class="hljs-attribute">text-align</span>: center;
  <span class="hljs-attribute">align-items</span>: center;
}

<span class="hljs-selector-tag">img</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">150px</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">100px</span>;
}

<span class="hljs-selector-class">.user-name</span> {
  <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">30px</span>;
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">24px</span>;
  <span class="hljs-attribute">font-weight</span>: bold;
}

<span class="hljs-selector-class">.content</span> {
  <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">10px</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>

</span></code></pre>
<blockquote>
<p>skeleton.vue</p>
</blockquote>
<pre><code class="hljs language-ts" lang="ts">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"user-info"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">""</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">""</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"user-name"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">hr</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"content"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.card</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">300px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">300px</span>;
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">2px</span> <span class="hljs-number">2px</span> <span class="hljs-number">10px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.3</span>);
}

<span class="hljs-selector-class">.user-info</span> {
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">flex-direction</span>: row;
  <span class="hljs-attribute">text-align</span>: center;
  <span class="hljs-attribute">align-items</span>: center;
}

<span class="hljs-selector-tag">img</span> {
  <span class="hljs-attribute">background-color</span>: bisque;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">150px</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">100px</span>;
}

<span class="hljs-selector-class">.user-name</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">70px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">20px</span>;
  <span class="hljs-attribute">background-color</span>: bisque;
  <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">30px</span>;
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">24px</span>;
  <span class="hljs-attribute">font-weight</span>: bold;
}

<span class="hljs-selector-class">.content</span> {
  <span class="hljs-attribute">background-color</span>: beige;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">120px</span>;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">300px</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre>
<p>ç»“åˆä½¿ç”¨å¼‚æ­¥ç»„ä»¶å’Œ Suspense</p>
<blockquote>
<p>åœ¨<code>App.vue</code>ä¸­ ï¼Œä½¿ç”¨ <code>Suspense</code> æ¥åŠ è½½ <code>card.vue</code>ï¼ˆä½œä¸ºå¼‚æ­¥ç»„ä»¶ï¼‰ï¼Œå¹¶åœ¨åŠ è½½æ—¶æ˜¾ç¤º <code>skeleton.vue</code></p>
</blockquote>
<pre><code class="hljs language-ts" lang="ts">&lt;template&gt;
 <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>åº”ç”¨<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ä¸‹é¢çš„å¡ç‰‡æ˜¯å¼‚æ­¥åŠ è½½çš„...<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

   <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span>&gt;</span>

     <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">default</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">AsyncUserCard</span> /&gt;</span>
     <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

     <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">fallback</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">CardSkeleton</span> /&gt;</span>
     <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

   <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// å¯¼å…¥ defineAsyncComponent æ¥åˆ›å»ºå¼‚æ­¥ç»„ä»¶</span>
<span class="hljs-keyword">import</span> { defineAsyncComponent } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;

<span class="hljs-comment">// 1. åŒæ­¥å¯¼å…¥éª¨æ¶å±</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// "fallback" å†…å®¹å¿…é¡»æ˜¯ç«‹å³ï¼ˆåŒæ­¥ï¼‰å¯ç”¨çš„ï¼Œ</span>
<span class="hljs-comment">// æ‰€ä»¥æˆ‘ä»¬åƒå¹³å¸¸ä¸€æ ·å¯¼å…¥ skeleton.vueã€‚</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">CardSkeleton</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./skeleton.vue'</span>;

<span class="hljs-comment">// 2. å¼‚æ­¥å¯¼å…¥ä½ çš„å¡ç‰‡ç»„ä»¶</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// æˆ‘ä»¬ä½¿ç”¨ `defineAsyncComponent` æ¥â€œåŒ…è£…â€ä½ çš„ card.vueã€‚</span>
<span class="hljs-comment">// è¿™å‘Šè¯‰ Vue è¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥ç»„ä»¶ï¼Œåº”è¯¥æ‡’åŠ è½½ã€‚</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">AsyncUserCard</span> = <span class="hljs-title function_">defineAsyncComponent</span>(<span class="hljs-function">() =&gt;</span> 
 <span class="hljs-keyword">import</span>(<span class="hljs-string">'./card.vue'</span>)
);


<span class="hljs-comment">// ----------------------------------------------------</span>
<span class="hljs-comment">// ğŸ’¡ (å¯é€‰) å¦‚ä½•åœ¨æœ¬åœ°æµ‹è¯•éª¨æ¶å±:</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// åœ¨æœ¬åœ°å¼€å‘ä¸­ï¼Œ`card.vue` åŠ è½½å¾—å¤ªå¿«ï¼Œä½ å¯èƒ½</span>
<span class="hljs-comment">// çœ‹ä¸åˆ°éª¨æ¶å±ã€‚ä½ å¯ä»¥åƒè¿™æ ·æ¨¡æ‹Ÿä¸€ä¸ª 2 ç§’çš„ç½‘ç»œå»¶è¿Ÿï¼š</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// const AsyncUserCard = defineAsyncComponent(() =&gt; {</span>
<span class="hljs-comment">//   return new Promise(resolve =&gt; {</span>
<span class="hljs-comment">//     setTimeout(() =&gt; {</span>
<span class="hljs-comment">//       // @ts-ignore</span>
<span class="hljs-comment">//       resolve(import('./card.vue'));</span>
<span class="hljs-comment">//     }, 2000); // å»¶è¿Ÿ 2 ç§’</span>
<span class="hljs-comment">//   });</span>
<span class="hljs-comment">// });</span>
<span class="hljs-comment">// ----------------------------------------------------</span>

</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-comment">/* ä¸€äº›å…¨å±€æ ·å¼ */</span>
<span class="hljs-selector-tag">body</span> {
 <span class="hljs-attribute">font-family</span>: sans-serif;
 <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-1">æµç¨‹</h4>
<ul>
<li>
<p>ç”¨æˆ·åŠ è½½ <code>App.vue</code>ã€‚</p>
</li>
<li>
<p><code>Suspense</code> å¼€å§‹æ¸²æŸ“ã€‚å®ƒå°è¯•æ¸²æŸ“ <code>#default</code> æ’æ§½ã€‚</p>
</li>
<li>
<p>å®ƒå‘ç° <code>#default</code> é‡Œçš„ <code>AsyncUserCard</code> æ˜¯ä¸€ä¸ªå¼‚æ­¥ç»„ä»¶ï¼Œå¹¶ä¸”å°šæœªåŠ è½½ã€‚</p>
</li>
<li>
<p><code>Suspense</code> ç«‹å³åˆ‡æ¢åˆ°æ¸²æŸ“ <code>#fallback</code> æ’æ§½ï¼Œæ˜¾ç¤º <code>CardSkeleton</code>ã€‚</p>
</li>
<li>
<p>åŒæ—¶ï¼ŒVue åœ¨åå°å¼€å§‹ä¸‹è½½ <code>card.vue</code> å¯¹åº”çš„ JavaScript æ–‡ä»¶ã€‚</p>
</li>
<li>
<p>ä¸‹è½½å’Œè§£æå®Œæˆåï¼Œ<code>Suspense</code> è‡ªåŠ¨ç”¨ <code>AsyncUserCard</code> çš„å†…å®¹æ›¿æ¢æ‰ <code>CardSkeleton</code>ã€‚</p>
</li>
</ul>
<h2 data-id="heading-2">2.å¦ä¸€ç§è§¦å‘ Suspense çš„æ–¹å¼ï¼š<code>async setup</code></h2>
<p>ä¿®æ”¹ä¸€ä¸‹<code>card.vue</code></p>
<pre><code class="hljs language-ts" lang="ts">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"user-info"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">:src</span>=<span class="hljs-string">"user.avatar"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"avatar"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"user-name"</span>&gt;</span>{{ user.name }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">hr</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"content"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ user.content }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import { ref } from "vue";
interface User {
  id: number;
  name: string;
  avatar: string;
  content: string;
}

// 1. æ¨¡æ‹Ÿä¸€ä¸ªå¼‚æ­¥æ•°æ®è·å– (ä¾‹å¦‚ API è°ƒç”¨)
const fetchUserData = (): Promise&lt;User&gt; =&gt; {
  return new Promise(resolve =&gt; {
    setTimeout(() =&gt; {
      console.log("æ•°æ®è·å–å®Œæˆ!");
      resolve({
        id: 1,
        name: "YaeZed (æ¥è‡ª API)",
        avatar: "https://avatars.githubusercontent.com/u/52018740?v=4",
        content: "Hello, from async setup!",
      });
    }, 2000); // æ¨¡æ‹Ÿ 2 ç§’çš„ API è°ƒç”¨
  });
};

// 2. åœ¨ &lt;script setup&gt; é¡¶å±‚ä½¿ç”¨ await
//
// Vue ä¼šè‡ªåŠ¨å°† `setup` å˜ä¸º `async setup`ã€‚
// `Suspense` å°†ä¼šç­‰å¾…è¿™ä¸ª `await` (fetchUserData) å®Œæˆã€‚
const user = ref&lt;User&gt;(await fetchUserData());

&lt;/script&gt;

&lt;style scoped&gt;
/* æ ·å¼ä¸å˜ */
.card {
  width: 300px;
  height: 300px;
  box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.3);
}

.user-info {
  display: flex;
  flex-direction: row;
  text-align: center;
  align-items: center;
}

img {
  width: 150px;
  height: 150px;
  border-radius: 100px;
}

.user-name {
  margin-left: 30px;
  font-size: 24px;
  font-weight: bold;
}

.content {
  margin-left: 10px;
}
&lt;/style&gt;
</code></pre>
<p>ç°åœ¨ï¼Œ<code>card.vue</code> è‡ªèº«åŒ…å«äº†ä¸€ä¸ªå¼‚æ­¥æ“ä½œã€‚<code>App.vue</code> å¯ä»¥è¿™æ ·å†™ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">default</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">UserCard</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">fallback</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">CardSkeleton</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// è¿™æ¬¡å¯ä»¥åŒæ­¥å¯¼å…¥ card</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">UserCard</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./card.vue'</span>; 
<span class="hljs-keyword">import</span> <span class="hljs-title class_">CardSkeleton</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./skeleton.vue'</span>;
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<p>åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­ï¼Œ<strong>åŒæ­¥å¯¼å…¥</strong>äº† <code>UserCard</code>ï¼Œä½†å› ä¸º <code>UserCard</code> å†…éƒ¨æœ‰ <code>async setup</code>ï¼Œ<code>Suspense</code> ä»ç„¶ä¼šæ•è·è¿™ä¸ªå¼‚æ­¥çŠ¶æ€ï¼Œå¹¶åœ¨ <code>await fetchUserData()</code> å®Œæˆä¹‹å‰æ˜¾ç¤º <code>CardSkeleton</code>ã€‚</p>
<h2 data-id="heading-3">3.å¤„ç†åŠ è½½å¤±è´¥</h2>
<p>å¼‚æ­¥ç»„ä»¶åœ¨ç½‘ç»œä¸ç¨³å®šæˆ–èµ„æºä¸å­˜åœ¨æ—¶å¯èƒ½ä¼šåŠ è½½å¤±è´¥ã€‚ä¸ºäº†é˜²æ­¢æ•´ä¸ªé¡µé¢å´©æºƒï¼Œé€šå¸¸ä¼šé…åˆ Vue çš„ <code>onErrorCaptured</code> é’©å­æˆ–ä¸“é—¨çš„â€œé”™è¯¯è¾¹ç•Œâ€ç»„ä»¶æ¥å¤„ç†å¼‚å¸¸ã€‚</p>
<p>å¯ä»¥é€šè¿‡ <code>defineAsyncComponent</code> çš„é«˜çº§é…ç½®é¡¹æ¥å¤„ç†è¶…æ—¶æˆ–åŠ è½½å¤±è´¥çš„æƒ…å†µï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> <span class="hljs-title class_">AsyncUserCard</span> = <span class="hljs-title function_">defineAsyncComponent</span>({
  <span class="hljs-attr">loader</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./card.vue'</span>),
  <span class="hljs-comment">// åŠ è½½å¼‚æ­¥ç»„ä»¶æ—¶ä½¿ç”¨çš„ç»„ä»¶ï¼ˆç±»ä¼¼ skeletonï¼‰</span>
  <span class="hljs-attr">loadingComponent</span>: <span class="hljs-title class_">CardSkeleton</span>,
  <span class="hljs-comment">// å±•ç¤ºåŠ è½½ç»„ä»¶å‰çš„å»¶è¿Ÿæ—¶é—´ã€‚é»˜è®¤ï¼š200ms</span>
  <span class="hljs-attr">delay</span>: <span class="hljs-number">200</span>,
  <span class="hljs-comment">// å¦‚æœæä¾›äº†ä¸€ä¸ªåŠ è½½ç»„ä»¶ï¼Œåœ¨è¶…æ—¶å‰å®ƒå°†è¢«å±•ç¤º</span>
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">3000</span>,
  <span class="hljs-comment">// åŠ è½½å¤±è´¥æ—¶ä½¿ç”¨çš„ç»„ä»¶</span>
  <span class="hljs-attr">errorComponent</span>: <span class="hljs-title class_">ErrorComponent</span>, 
});
</code></pre>
<p>æˆ–è€…åœ¨ <code>Suspense</code> çš„çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨ <code>onErrorCaptured</code> é’©å­æ¥æ•è·å¼‚æ­¥ä¾èµ–æŠ›å‡ºçš„ä»»ä½•é”™è¯¯ã€‚</p>
<p><code>å‚è€ƒæ–‡ç« </code></p>
<p>å°æ»¡zs  å­¦ä¹ Vue3 ç¬¬åå…«ç« ï¼ˆå¼‚æ­¥ç»„ä»¶&amp;ä»£ç åˆ†åŒ…&amp;suspenseï¼‰<a href="https://link.juejin.cn?target=https%3A%2F%2Fxiaoman.blog.csdn.net%2Farticle%2Fdetails%2F122909360" target="_blank" title="https://xiaoman.blog.csdn.net/article/details/122909360" ref="nofollow noopener noreferrer">xiaoman.blog.csdn.net/article/detâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Tauri (25)â€”â€”æ¶ˆé™¤æœç´¢åˆ—è¡¨é»˜è®¤é€‰ä¸­çš„ UI é—ªåŠ¨]]></title>    <link>https://juejin.cn/post/7591309945511608320</link>    <guid>https://juejin.cn/post/7591309945511608320</guid>    <pubDate>2026-01-05T01:46:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591309945511608320" data-draft-id="7590752433989074998" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Tauri (25)â€”â€”æ¶ˆé™¤æœç´¢åˆ—è¡¨é»˜è®¤é€‰ä¸­çš„ UI é—ªåŠ¨"/> <meta itemprop="keywords" content="å‰ç«¯,React.js,WeUI"/> <meta itemprop="datePublished" content="2026-01-05T01:46:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨å¤œå¯»æ™´å¤©"/> <meta itemprop="url" content="https://juejin.cn/user/1943592288391496"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Tauri (25)â€”â€”æ¶ˆé™¤æœç´¢åˆ—è¡¨é»˜è®¤é€‰ä¸­çš„ UI é—ªåŠ¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1943592288391496/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨å¤œå¯»æ™´å¤©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-05T01:46:26.000Z" title="Mon Jan 05 2026 01:46:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨åšæ¡Œé¢åº”ç”¨ coco-appï¼ˆReact 18 + Tauriï¼‰æ—¶ï¼Œé‡åˆ°ä¸€ä¸ªè‚‰çœ¼å¯è§çš„ä½“éªŒé—®é¢˜ï¼šæœç´¢ç»“æœæ¸²æŸ“å‡ºæ¥åï¼Œé»˜è®¤é€‰ä¸­çš„ç¬¬ä¸€é¡¹ä¼š â€œæ…¢åŠæ‹â€ æ‰é«˜äº®ï¼Œå¯¼è‡´ UI æœ‰è½»å¾®é—ªåŠ¨ã€‚è¿™ç¯‡æ–‡ç« åˆ†äº«å®šä½è¿‡ç¨‹ä¸æœ€ç»ˆä¿®å¤æ–¹æ¡ˆï¼Œæ·±åº¦è§£æ<code>useLayoutEffect</code> çš„ä½¿ç”¨é€»è¾‘ï¼Œå¹¶ç»™å‡ºä»£ç å¯¹æ¯”ä¸æ‰©å±•å®è·µï¼Œå¸®ä½ é¿å¼€åŒç±»äº¤äº’ä¼˜åŒ–å‘ã€‚</p>
<hr/>
<h2 data-id="heading-0">èƒŒæ™¯ä¸é—®é¢˜</h2>
<ul>
<li>ä¸šåŠ¡åœºæ™¯ï¼šæœç´¢é¢æ¿åˆ—è¡¨æ¸²æŸ“åï¼Œé»˜è®¤é«˜äº®ç¬¬ä¸€æ¡ï¼Œä¾¿äºç”¨æˆ·å¿«é€Ÿå›è½¦æˆ–æ–¹å‘é”®æ“ä½œã€‚</li>
<li>ç°è±¡ï¼šåˆ—è¡¨å·²ç»æ¸²æŸ“ï¼Œä½†é»˜è®¤é€‰ä¸­å‡ºç°å»¶è¿Ÿï¼Œè‚‰çœ¼å¯è§çš„â€œæŠ–ä¸€ä¸‹â€ã€‚</li>
</ul>
<p>ç»è¿‡å®šä½ï¼Œæ ¹å› æ˜¯åˆå§‹åŒ–é€‰ä¸­é€»è¾‘ä½¿ç”¨äº† 200ms çš„é˜²æŠ–ï¼Œå¯¼è‡´çŠ¶æ€æ›´æ–°æ™šäºæ¸²æŸ“â€”â€”åˆ—è¡¨ DOM å·²å‡ºç°åœ¨å±å¹•ä¸Šï¼Œä½†é€‰ä¸­çŠ¶æ€çš„æ ·å¼è¿˜æœªç”Ÿæ•ˆï¼Œå½¢æˆè§†è§‰æ–­å±‚ã€‚</p>
<hr/>
<h2 data-id="heading-1">å¤ç°ä¸å®šä½</h2>
<p>æ—§é€»è¾‘åœ¨æ¸²æŸ“åé€šè¿‡ <code>useDebounceFn</code> å»¶è¿Ÿ 200ms æ‰è®¾ç½®é€‰ä¸­é¡¹ï¼Œæœ¬æ„æ˜¯ â€œé¿å…è¿‡å¤šçš„åˆå§‹åŒ–â€ï¼Œä½†åœ¨ç”¨æˆ·å¯æ„ŸçŸ¥çš„äº¤äº’åœºæ™¯ä¸­ï¼Œè¿™ç§å»¶è¿Ÿå®Œå…¨æš´éœ²ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// æ—§ä»£ç ï¼ˆé—®é¢˜æ ¹æºï¼‰</span>
<span class="hljs-keyword">const</span> { <span class="hljs-attr">run</span>: initializeSelection } = <span class="hljs-title function_">useDebounceFn</span>(
  <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">setSelectedIndex</span>(<span class="hljs-number">0</span>);
    <span class="hljs-title function_">setSelectedSearchContent</span>(suggests[<span class="hljs-number">0</span>]?.<span class="hljs-property">document</span> || <span class="hljs-literal">null</span>);
  },
  { <span class="hljs-attr">wait</span>: <span class="hljs-number">200</span> }
);

<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">setSelectedIndex</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-title function_">initializeSelection</span>();
}, [searchData]);
</code></pre>
<p>é˜²æŠ–åœ¨ â€œé¢‘ç¹è§¦å‘çš„æœç´¢è¾“å…¥â€ åœºæ™¯ä¸­æ˜¯åˆç†çš„ï¼Œä½†åœ¨ â€œæœç´¢ç»“æœæœ€ç»ˆæ¸²æŸ“å®Œæˆååˆå§‹åŒ–é€‰ä¸­â€ è¿™ä¸ªç¯èŠ‚ï¼Œ200ms çš„å»¶è¿Ÿç›´æ¥è§¦å‘äº† UI é—ªåŠ¨â€”â€”ç”¨æˆ·å…ˆçœ‹åˆ°æ— é€‰ä¸­çš„åˆ—è¡¨ï¼Œå†çœ‹åˆ°ç¬¬ä¸€é¡¹é«˜äº®ï¼Œè§†è§‰ä¸Šå½¢æˆ â€œæŠ–åŠ¨â€ã€‚</p>
<hr/>
<h2 data-id="heading-2">è§£å†³æ–¹æ¡ˆï¼šç”¨ useLayoutEffect å®ç°å¸ƒå±€é˜¶æ®µåŒæ­¥æ›´æ–°</h2>
<p>æ”¹ä¸ºåœ¨å¸ƒå±€é˜¶æ®µåŒæ­¥åˆå§‹åŒ–é€‰ä¸­é¡¹ï¼Œç¡®ä¿é¦–å±æ¸²æŸ“æ—¶é€‰ä¸­çŠ¶æ€ä¸åˆ—è¡¨ DOM åŒæ—¶ç”Ÿæ•ˆï¼Œä»æ ¹æºæ¶ˆé™¤å»¶è¿Ÿã€‚</p>
<h3 data-id="heading-3">æ ¸å¿ƒæ”¹åŠ¨ä»£ç </h3>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// æ–°ä»£ç ï¼ˆåŒæ­¥åˆå§‹åŒ–ï¼Œæ— å»¶è¿Ÿï¼‰</span>
<span class="hljs-title function_">useLayoutEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">if</span> (isChatMode) <span class="hljs-keyword">return</span>;

  <span class="hljs-keyword">if</span> (suggests.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-title function_">setSelectedIndex</span>(<span class="hljs-number">0</span>);
    <span class="hljs-title function_">setSelectedSearchContent</span>(suggests[<span class="hljs-number">0</span>].<span class="hljs-property">document</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">setSelectedIndex</span>(<span class="hljs-literal">null</span>);
    <span class="hljs-title function_">setSelectedSearchContent</span>(<span class="hljs-literal">undefined</span>);
  }
}, [searchData, suggests, isChatMode]);
</code></pre>
<p>è¿™ä¸€æ”¹åŠ¨èƒ½ç¡®ä¿ï¼š</p>
<ul>
<li>åˆ—è¡¨DOMå¸ƒå±€å®Œæˆåã€å±å¹•ç»˜åˆ¶å‰ï¼Œé€‰ä¸­çŠ¶æ€å·²æ›´æ–°ï¼›</li>
<li>ç”¨æˆ·çœ‹åˆ°çš„ç¬¬ä¸€å¸§å°±æ˜¯ â€œå·²é€‰ä¸­ç¬¬ä¸€é¡¹â€ çš„çŠ¶æ€ï¼›</li>
<li>é”®ç›˜å¯¼èˆªã€æ»šåŠ¨è”åŠ¨ã€ä¸Šä¸‹æ–‡èœå•ç­‰åŸæœ‰äº¤äº’é€»è¾‘å®Œå…¨ä¸å˜ã€‚</li>
</ul>
<h3 data-id="heading-4">æ–°æ—§é€»è¾‘å¯¹æ¯”</h3>

























<table><thead><tr><th>ç»´åº¦</th><th>æ—§å®ç°ï¼ˆé˜²æŠ–+useEffectï¼‰</th><th>æ–°å®ç°ï¼ˆuseLayoutEffectï¼‰</th></tr></thead><tbody><tr><td>æ‰§è¡Œæ—¶æœº</td><td>æ¸²æŸ“å®Œæˆåå»¶è¿Ÿ200ms</td><td>å¸ƒå±€å®Œæˆåã€ç»˜åˆ¶å‰åŒæ­¥æ‰§è¡Œ</td></tr><tr><td>è§†è§‰è¡¨ç°</td><td>å…ˆæ¸²æŸ“åˆ—è¡¨ï¼Œåé«˜äº®ï¼Œæœ‰é—ªåŠ¨</td><td>æ¸²æŸ“ä¸é«˜äº®åŒæ­¥ï¼Œæ— è§†è§‰æ–­å±‚</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>éé¦–å±å…³é”®äº¤äº’ã€é«˜é¢‘è§¦å‘é€»è¾‘</td><td>é¦–å±çŠ¶æ€åŒæ­¥ã€æ— å»¶è¿Ÿäº¤äº’</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-5">æ·±åº¦è§£æï¼šuseLayoutEffect æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<h3 data-id="heading-6">1. æ ¸å¿ƒå®šä¹‰</h3>
<p><code>useLayoutEffect</code> æ˜¯ React æä¾›çš„ç”Ÿå‘½å‘¨æœŸ Hookï¼Œä¸ <code>useEffect</code> åŠŸèƒ½ç±»ä¼¼ï¼Œä½†<strong>æ‰§è¡Œæ—¶æœºå®Œå…¨ä¸åŒ</strong>ï¼š</p>
<ul>
<li><code>useEffect</code>ï¼šåœ¨ç»„ä»¶æ¸²æŸ“å®Œæˆï¼ˆDOM ç»˜åˆ¶åˆ°å±å¹•ï¼‰åå¼‚æ­¥æ‰§è¡Œï¼Œä¸ä¼šé˜»å¡æµè§ˆå™¨ç»˜åˆ¶ï¼›</li>
<li><code>useLayoutEffect</code>ï¼šåœ¨ç»„ä»¶ DOM å¸ƒå±€å®Œæˆåã€å±å¹•ç»˜åˆ¶å‰åŒæ­¥æ‰§è¡Œï¼Œä¼šé˜»å¡ç»˜åˆ¶ï¼Œç›´åˆ°å›è°ƒå®Œæˆã€‚</li>
</ul>
<h3 data-id="heading-7">2. æ‰§è¡Œæ—¶åºï¼ˆReact 18ï¼‰</h3>
<pre><code class="hljs">ç»„ä»¶è§¦å‘æ›´æ–° â†’ è®¡ç®—æ–°DOM â†’ å¸ƒå±€é˜¶æ®µï¼ˆLayoutï¼‰â†’ useLayoutEffectæ‰§è¡Œ â†’ ç»˜åˆ¶é˜¶æ®µï¼ˆPaintï¼‰â†’ useEffectæ‰§è¡Œ
</code></pre>
<p>æ­£æ˜¯è¿™ä¸ª â€œå¸ƒå±€åã€ç»˜åˆ¶å‰â€ çš„æ—¶åºï¼Œè®© <code>useLayoutEffect</code> æˆä¸º â€œé¦–å±çŠ¶æ€åŒæ­¥â€ çš„æœ€ä½³é€‰æ‹©â€”â€”ä¿®æ”¹çŠ¶æ€çš„æ“ä½œä¼šåœ¨ç”¨æˆ·çœ‹åˆ°ç”»é¢ä¹‹å‰å®Œæˆï¼Œé¿å…è§†è§‰é—ªåŠ¨ã€‚</p>
<h3 data-id="heading-8">3. useLayoutEffect vs useEffectï¼ˆæ ¸å¿ƒåŒºåˆ«ï¼‰</h3>






























<table><thead><tr><th>ç‰¹æ€§</th><th>useLayoutEffect</th><th>useEffect</th></tr></thead><tbody><tr><td>æ‰§è¡Œæ—¶æœº</td><td>å¸ƒå±€åã€ç»˜åˆ¶å‰ï¼ˆåŒæ­¥ï¼‰</td><td>ç»˜åˆ¶åï¼ˆå¼‚æ­¥ï¼‰</td></tr><tr><td>é˜»å¡ç»˜åˆ¶</td><td>æ˜¯ï¼ˆçŸ­æ—¶é—´æ“ä½œæ— æ„ŸçŸ¥ï¼‰</td><td>å¦</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>é¦–å±çŠ¶æ€åŒæ­¥ã€DOMå°ºå¯¸/ä½ç½®è®¡ç®—</td><td>æ•°æ®è¯·æ±‚ã€å¼‚æ­¥æ“ä½œã€éç´§æ€¥DOMä¿®æ”¹</td></tr><tr><td>SSR å…¼å®¹æ€§</td><td>ä¸å…¼å®¹ï¼ˆæœåŠ¡ç«¯æ— å¸ƒå±€é˜¶æ®µï¼‰</td><td>å…¼å®¹</td></tr></tbody></table>
<h3 data-id="heading-9">4. ä¸ºä»€ä¹ˆæœ¬åœºæ™¯ä¸èƒ½ç”¨ useEffectï¼Ÿ</h3>
<p>å¦‚æœå°†æ–°ä»£ç ä¸­çš„ <code>useLayoutEffect</code> æ¢æˆ <code>useEffect</code>ï¼Œä¾ç„¶ä¼šå‡ºç°è½»å¾®é—ªåŠ¨ï¼š</p>
<ul>
<li><code>useEffect</code> æ‰§è¡Œæ—¶ï¼Œåˆ—è¡¨å·²ç»ç»˜åˆ¶åˆ°å±å¹•ï¼›</li>
<li>æ­¤æ—¶ä¿®æ”¹ <code>selectedIndex</code> ä¼šè§¦å‘äºŒæ¬¡æ¸²æŸ“ï¼Œç”¨æˆ·èƒ½çœ‹åˆ°â€œå…ˆæ— é€‰ä¸­ã€åé«˜äº®â€çš„è¿‡ç¨‹ã€‚</li>
</ul>
<p>è€Œ <code>useLayoutEffect</code> æ‰§è¡Œæ—¶ï¼Œåˆ—è¡¨è¿˜æœªç»˜åˆ¶ï¼ŒçŠ¶æ€ä¿®æ”¹ä¼šèå…¥æœ¬æ¬¡æ¸²æŸ“æµç¨‹ï¼Œæœ€ç»ˆåªè§¦å‘ä¸€æ¬¡ç»˜åˆ¶ï¼Œè§†è§‰ä¸Šå®Œå…¨æ— æ„ŸçŸ¥ã€‚</p>
<hr/>
<h2 data-id="heading-10">useLayoutEffect æ‰©å±•å®è·µï¼šé€‚ç”¨åœºæ™¯ä¸é¿å‘æŒ‡å—</h2>
<h3 data-id="heading-11">ä¸€ã€é€‚ç”¨åœºæ™¯ï¼ˆä¼˜å…ˆç”¨ useLayoutEffect çš„æƒ…å†µï¼‰</h3>
<ol>
<li>
<p><strong>é¦–å±çŠ¶æ€åŒæ­¥</strong>ï¼šå¦‚æœ¬æ¡ˆä¾‹çš„åˆ—è¡¨é»˜è®¤é€‰ä¸­ã€è¡¨å•é»˜è®¤èšç„¦ã€è·¯ç”±è·³è½¬åçš„æ»šåŠ¨å®šä½ï¼›</p>
</li>
<li>
<p><strong>DOM å°ºå¯¸/ä½ç½®è®¡ç®—</strong>ï¼šæ¯”å¦‚è·å–å…ƒç´ å®½é«˜åç«‹å³è°ƒæ•´æ ·å¼ï¼Œé¿å… â€œå…ˆé”™ä½ã€åä¿®æ­£â€ï¼›</p>
</li>
</ol>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// ç¤ºä¾‹ï¼šè·å–å…ƒç´ é«˜åº¦å¹¶åŒæ­¥è®¾ç½®å®¹å™¨é«˜åº¦</span>
<span class="hljs-title function_">useLayoutEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> height = ref.<span class="hljs-property">current</span>?.<span class="hljs-property">offsetHeight</span>;
  <span class="hljs-keyword">if</span> (height) <span class="hljs-title function_">setContainerHeight</span>(height);
}, []);
</code></pre>
<ol start="3">
<li><strong>æ— éšœç¢å±æ€§åŒæ­¥</strong>ï¼šå¦‚ <code>aria-selected</code>ã€<code>aria-hidden</code> ç­‰å±æ€§çš„åˆå§‹åŒ–ï¼Œç¡®ä¿é¦–å±ç¬¦åˆæ— éšœç¢è§„èŒƒã€‚</li>
</ol>
<h3 data-id="heading-12">äºŒã€é¿å‘æŒ‡å—ï¼ˆä½¿ç”¨æ³¨æ„äº‹é¡¹ï¼‰</h3>
<ol>
<li>
<p><strong>é¿å…é‡è®¡ç®—/è€—æ—¶æ“ä½œ</strong>ï¼š<code>useLayoutEffect</code> é˜»å¡ç»˜åˆ¶ï¼Œè‹¥å›è°ƒå†…æœ‰å¤æ‚è®¡ç®—ï¼ˆå¦‚å¾ªç¯éå†å¤§é‡æ•°æ®ï¼‰ï¼Œä¼šå¯¼è‡´é¡µé¢å¡é¡¿ï¼›</p>
</li>
<li>
<p><strong>SSR ç¯å¢ƒå¤„ç†</strong>ï¼šåœ¨ Next.jsã€Remix ç­‰ SSR æ¡†æ¶ä¸­ä½¿ç”¨æ—¶ï¼Œéœ€åŠ åˆ¤æ–­é¿å…æœåŠ¡ç«¯æ‰§è¡Œï¼š</p>
</li>
</ol>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> isBrowser = <span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">window</span> !== <span class="hljs-string">'undefined'</span>;
(isBrowser ? useLayoutEffect : useEffect)(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘</span>
}, [deps]);
</code></pre>
<ol start="3">
<li>
<p><strong>ä¾èµ–é¡¹å®Œæ•´</strong>ï¼šä¸ <code>useEffect</code> ä¸€è‡´ï¼Œå¿…é¡»å£°æ˜æ‰€æœ‰ä¾èµ–ï¼Œé¿å…é—­åŒ…æ•è·æ—§å€¼ï¼ˆæœ¬æ¡ˆä¾‹ä¾èµ– <code>searchData</code>/<code>suggests</code>/<code>isChatMode</code> ç¡®ä¿çŠ¶æ€åŒæ­¥ï¼‰ï¼›</p>
</li>
<li>
<p><strong>é¿å…è¿‡åº¦ä½¿ç”¨</strong>ï¼šä»…åœ¨â€œé¦–å±è§†è§‰ä¸€è‡´æ€§â€åœºæ™¯ä½¿ç”¨ï¼Œæ™®é€šå¼‚æ­¥é€»è¾‘ï¼ˆå¦‚æ•°æ®è¯·æ±‚ï¼‰ä»ç”¨ <code>useEffect</code>ã€‚</p>
</li>
</ol>
<h3 data-id="heading-13">ä¸‰ã€ä¸é˜²æŠ–/èŠ‚æµçš„é…åˆåŸåˆ™</h3>
<p>é˜²æŠ–ï¼ˆdebounceï¼‰å’ŒèŠ‚æµï¼ˆthrottleï¼‰æ˜¯ â€œé«˜é¢‘è§¦å‘åœºæ™¯â€ çš„ä¼˜åŒ–æ‰‹æ®µï¼Œä½†éœ€åˆ†æ¸…ä½¿ç”¨é˜¶æ®µï¼š</p>
<ul>
<li>âœ… é€‚ç”¨ï¼šæœç´¢è¾“å…¥ã€çª—å£ resizeã€æ»šåŠ¨äº‹ä»¶ç­‰<strong>é«˜é¢‘è§¦å‘çš„æºäº‹ä»¶</strong>ï¼›</li>
<li>âŒ ä¸é€‚ç”¨ï¼šäº‹ä»¶è§¦å‘åçš„ <strong>æœ€ç»ˆçŠ¶æ€åŒæ­¥</strong>ï¼ˆå¦‚æœ¬æ¡ˆä¾‹çš„æœç´¢ç»“æœæ¸²æŸ“ååˆå§‹åŒ–é€‰ä¸­ï¼‰ã€‚</li>
</ul>
<p>ç®€å•è¯´ï¼šé˜²æŠ–èŠ‚æµç”¨äº â€œæ§åˆ¶è§¦å‘é¢‘ç‡â€ï¼Œè€Œé â€œå»¶è¿Ÿæœ€ç»ˆçŠ¶æ€ç”Ÿæ•ˆâ€ã€‚</p>
<hr/>
<h2 data-id="heading-14">å°ç»“</h2>
<p>ç”¨æˆ·ä½“éªŒçš„ â€œå¾®å»¶è¿Ÿâ€ å’Œ â€œè§†è§‰é—ªåŠ¨â€ï¼Œå¾€å¾€è—åœ¨å¼‚æ­¥å¤„ç†ã€ç”Ÿå‘½å‘¨æœŸæ—¶æœºçš„ç»†èŠ‚é‡Œã€‚å¯¹äº â€œé¦–å¸§çŠ¶æ€å¿…é¡»ä¸€è‡´â€ çš„äº¤äº’åœºæ™¯ï¼š</p>
<ol>
<li>æ”¾å¼ƒä¸å¿…è¦çš„é˜²æŠ–å»¶è¿Ÿï¼Œä¼˜å…ˆç”¨ <code>useLayoutEffect</code> å®ç°â€œå¸ƒå±€åã€ç»˜åˆ¶å‰â€çš„çŠ¶æ€åŒæ­¥ï¼›</li>
<li>åŒºåˆ† <code>useLayoutEffect</code> ä¸ <code>useEffect</code> çš„æ‰§è¡Œæ—¶åºï¼Œé¿å…ç”¨é”™å¯¼è‡´è§†è§‰é—®é¢˜ï¼›</li>
<li>é˜²æŠ–/èŠ‚æµåªç”¨äºé«˜é¢‘è§¦å‘çš„æºé€»è¾‘ï¼Œè€Œéæœ€ç»ˆçš„çŠ¶æ€åˆå§‹åŒ–ã€‚</li>
</ol>
<p>å¦‚æœä½ ä¹Ÿåœ¨åš React æ¡Œé¢ï¼ˆTauri/Electronï¼‰æˆ– Web åº”ç”¨çš„æœç´¢åˆ—è¡¨ã€è¡¨å•ã€å¯¼èˆªç­‰äº¤äº’ç»„ä»¶ï¼Œä¸å¦¨æ£€æŸ¥ä¸€ä¸‹é»˜è®¤çŠ¶æ€çš„åˆå§‹åŒ–æ—¶æœºâ€”â€”ç”¨å¯¹ <code>useLayoutEffect</code>ï¼Œå¾€å¾€èƒ½ç«‹ç«¿è§å½±åœ°æ¶ˆé™¤è§†è§‰æŠ–åŠ¨ï¼Œæå‡äº¤äº’é¡ºæ»‘åº¦ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸš€ é‡æ–°å®šä¹‰å‰ç«¯ç»„ä»¶å®‰è£…ä½“éªŒï¼šshadcn + Bun çš„æè‡´å¼€å‘æ•ˆç‡]]></title>    <link>https://juejin.cn/post/7591309945510821888</link>    <guid>https://juejin.cn/post/7591309945510821888</guid>    <pubDate>2026-01-04T12:34:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591309945510821888" data-draft-id="7591309945510805504" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸš€ é‡æ–°å®šä¹‰å‰ç«¯ç»„ä»¶å®‰è£…ä½“éªŒï¼šshadcn + Bun çš„æè‡´å¼€å‘æ•ˆç‡"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-04T12:34:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Erishen"/> <meta itemprop="url" content="https://juejin.cn/user/3342957408695086"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸš€ é‡æ–°å®šä¹‰å‰ç«¯ç»„ä»¶å®‰è£…ä½“éªŒï¼šshadcn + Bun çš„æè‡´å¼€å‘æ•ˆç‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3342957408695086/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Erishen
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T12:34:46.000Z" title="Sun Jan 04 2026 12:34:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>è¿˜åœ¨ä¸º npm install é¾Ÿé€Ÿå®‰è£…è€Œçƒ¦æ¼ï¼Ÿæœ¬æ–‡å°†å¸¦ä½ ä½“éªŒä¸€ç§å…¨æ–°çš„ç»„ä»¶è·å–æ–¹å¼ï¼š<strong>copy instead of install</strong>ã€‚é€šè¿‡ shadcn çš„ç»„ä»¶æ³¨å†Œè¡¨æ¨¡å¼ + Bun çš„æé€Ÿæ€§èƒ½ï¼Œè®©ä½ çš„å¼€å‘æ•ˆç‡æå‡ 10 å€ï¼</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb3d6365e11248babbd8b8dd682a2dac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJpc2hlbg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141648&amp;x-signature=%2BvX7mTY8eJHB8V9lIW%2FSucncQ8I%3D" alt="shadcn-bun-medium-cover.png" loading="lazy"/></p>
<h2 data-id="heading-0">ğŸ’¡ é‡æ–°æ€è€ƒï¼šä¸ºä»€ä¹ˆè¿˜è¦ npm installï¼Ÿ</h2>
<h3 data-id="heading-1">ä¼ ç»Ÿæ–¹å¼çš„ç—›ç‚¹</h3>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># âŒ ä¼ ç»Ÿçš„ npm æ–¹å¼</span>
npm install <span class="hljs-variable">@tanstack</span>/react-table      <span class="hljs-comment"># å¤æ‚çš„è¡¨æ ¼ç»„ä»¶</span>
npm install <span class="hljs-variable">@headlessui</span>/react          <span class="hljs-comment"># æ— æ ·å¼ç»„ä»¶</span>
npm install <span class="hljs-variable">@heroicons</span>/react           <span class="hljs-comment"># å›¾æ ‡åº“</span>
npm install clsx tailwind-merge        <span class="hljs-comment"># å·¥å…·å‡½æ•°</span>
npm install <span class="hljs-keyword">class</span>-variance-authority   <span class="hljs-comment"># å˜ä½“ç®¡ç†</span>

<span class="hljs-comment"># ç»“æœï¼šnode_modules è‡ƒè‚¿ã€å®‰è£…ç¼“æ…¢ã€ç‰ˆæœ¬å†²çª</span>
</code></pre>
<h3 data-id="heading-2">shadcn çš„é©æ–°ç†å¿µ</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># âœ… shadcn çš„æ–¹å¼ï¼šä¸€è¡Œå‘½ä»¤æå®š</span>
pnpm dlx shadcn@latest <span class="hljs-keyword">add</span> https:<span class="hljs-comment">//erishen.github.io/shadcn-registry/r/data-table.json</span>

<span class="hljs-meta"># ç»“æœï¼šç›´æ¥å¤åˆ¶ç»„ä»¶ä»£ç åˆ°ä½ çš„é¡¹ç›®ï¼Œå®Œå…¨å¯æ§</span>
</code></pre>
<blockquote>
<p><strong>æ ¸å¿ƒç†å¿µ</strong>: "Copy and paste, not install"</p>
</blockquote>
<h2 data-id="heading-3">ğŸ”¥ ä¸ºä»€ä¹ˆé€‰æ‹© Bunï¼Ÿæ€§èƒ½å¯¹æ¯”å®æµ‹</h2>
<h3 data-id="heading-4">å®‰è£…é€Ÿåº¦å¯¹æ¯”</h3>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># ğŸŒ npm (åŸºçº¿æ—¶é—´)</span>
<span class="hljs-keyword">time</span> npm install
<span class="hljs-comment"># real    0m45.231s  # 45ç§’</span>

<span class="hljs-comment"># âš¡ pnpm (ä¸é”™ä½†è¿˜æœ‰å·®è·)  </span>
<span class="hljs-keyword">time</span> pnpm install
<span class="hljs-comment"># real    0m12.456s  # 12ç§’</span>

<span class="hljs-comment"># ğŸš€ Bun (æè‡´ä½“éªŒ)</span>
<span class="hljs-keyword">time</span> bun install
<span class="hljs-comment"># real    0m2.134s   # 2ç§’ï¼</span>
</code></pre>
<h3 data-id="heading-5">å¼€å‘æœåŠ¡å™¨å¯åŠ¨å¯¹æ¯”</h3>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// åŒæ ·çš„ Next.js é¡¹ç›®</span>
<span class="hljs-type">const</span> startupTime = {
  npm: <span class="hljs-string">"8500ms"</span>,    <span class="hljs-comment">// 8.5ç§’</span>
  pnpm: <span class="hljs-string">"3200ms"</span>,   <span class="hljs-comment">// 3.2ç§’  </span>
  bun: <span class="hljs-string">"1200ms"</span>     <span class="hljs-comment">// 1.2ç§’</span>
};

<span class="hljs-comment">// æå‡æ•ˆæœ</span>
<span class="hljs-type">const</span> improvement = {
  vs_npm: <span class="hljs-string">"85% faster"</span>,    <span class="hljs-comment">// æ¯” npm å¿« 85%</span>
  vs_pnpm: <span class="hljs-string">"62% faster"</span>    <span class="hljs-comment">// æ¯” pnpm å¿« 62%</span>
};
</code></pre>
<h3 data-id="heading-6">Bun çš„æ ¸å¿ƒä¼˜åŠ¿</h3>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// 1. æé€Ÿå®‰è£…ç®—æ³•</span>
<span class="hljs-type">const</span> bunFeatures = {
  parallelDownloads: <span class="hljs-string">"å¹¶è¡Œä¸‹è½½ï¼Œé€Ÿåº¦æå‡ 10-20 å€"</span>,
  smartCache: <span class="hljs-string">"æ™ºèƒ½ç¼“å­˜ï¼Œé¿å…é‡å¤ä¸‹è½½"</span>,
  nativePerformance: <span class="hljs-string">"åŸç”Ÿæ€§èƒ½ï¼Œæ—  Node.js å¼€é”€"</span>,
  webAPIs: <span class="hljs-string">"å†…ç½® fetchã€WebSocketã€Streams"</span>
};

<span class="hljs-comment">// 2. å¼€å‘ä½“éªŒæå‡</span>
<span class="hljs-type">const</span> devExperience = {
  hotReload: <span class="hljs-string">"çƒ­é‡è½½é€Ÿåº¦æå‡ 70%"</span>,
  typeChecking: <span class="hljs-string">"TypeScript åŸç”Ÿæ”¯æŒ"</span>,
  bundling: <span class="hljs-string">"å†…ç½® ESBuildï¼Œæ‰“åŒ…é€Ÿåº¦ç¿»å€"</span>,
  testing: <span class="hljs-string">"å†…ç½®æµ‹è¯•è¿è¡Œå™¨"</span>
};
</code></pre>
<h2 data-id="heading-7">ğŸ—ï¸ æ‰“é€ ä½ çš„ç»„ä»¶æ³¨å†Œè¡¨</h2>
<h3 data-id="heading-8">ä»€ä¹ˆæ˜¯ç»„ä»¶æ³¨å†Œè¡¨ï¼Ÿ</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// registry.json - ä½ çš„ç»„ä»¶å•†åº—</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"erishen-components"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"homepage"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://your-registry.com/"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"items"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"data-table"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"registry:component"</span><span class="hljs-punctuation">,</span> 
      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Data Table"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä¼ä¸šçº§æ•°æ®è¡¨æ ¼ç»„ä»¶"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"files"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"components/data-table.tsx"</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"registry:component"</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-9">ä¸€é”®å®‰è£…ä½“éªŒ</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># å®‰è£…ä»»ä½•ç»„ä»¶åªéœ€è¦ä¸€è¡Œå‘½ä»¤</span>
pnpm dlx shadcn@latest <span class="hljs-keyword">add</span> https:<span class="hljs-comment">//erishen.github.io/shadcn-registry/r/data-table.json</span>

<span class="hljs-meta"># ç»„ä»¶ä¼šè‡ªåŠ¨ä¸‹è½½åˆ°ä½ çš„é¡¹ç›®ä¸­</span>
src/
â””â”€â”€ components/
    â”œâ”€â”€ ui/                    <span class="hljs-meta"># åŸºç¡€ç»„ä»¶</span>
    â””â”€â”€ data-table.tsx         <span class="hljs-meta"># ä½ åˆšå®‰è£…çš„ç»„ä»¶</span>
</code></pre>
<h2 data-id="heading-10">ğŸ’» å®æˆ˜ï¼šåˆ›å»º shadcn-registry é¡¹ç›®</h2>
<h3 data-id="heading-11">1. é¡¹ç›®åˆå§‹åŒ–</h3>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># ä½¿ç”¨ Bun åˆ›å»ºé¡¹ç›®ï¼Œæé€Ÿå¯åŠ¨</span>
bun create <span class="hljs-keyword">next</span>-app@latest shadcn-registry --typescript --tailwind --eslint --app --src-dir

cd shadcn-registry

<span class="hljs-comment"># å®‰è£…ä¾èµ–ï¼ˆæ¯” npm å¿« 15 å€ï¼‰</span>
bun install

<span class="hljs-comment"># å¯åŠ¨å¼€å‘æœåŠ¡å™¨</span>
bun dev  <span class="hljs-comment"># ğŸš€ 1.2ç§’å¯åŠ¨å®Œæˆï¼</span>
</code></pre>
<h3 data-id="heading-12">2. æ„å»ºç»„ä»¶æ³¨å†Œè¡¨</h3>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// registry/new-york/ui/button.tsx</span>
<span class="hljs-string">'use client'</span>;

import * <span class="hljs-keyword">as</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
import { Slot } <span class="hljs-keyword">from</span> <span class="hljs-string">'@radix-ui/react-slot'</span>;
import { cva, type VariantProps } <span class="hljs-keyword">from</span> <span class="hljs-string">'class-variance-authority'</span>;
import { cn } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/lib/utils'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">buttonVariants</span> = <span class="hljs-title function_ invoke__">cva</span>(
  <span class="hljs-string">'inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50'</span>,
  {
    <span class="hljs-attr">variants</span>: {
      <span class="hljs-attr">variant</span>: {
        <span class="hljs-attr">default</span>: <span class="hljs-string">'bg-slate-900 text-slate-50 hover:bg-slate-900/90'</span>,
        <span class="hljs-attr">destructive</span>: <span class="hljs-string">'bg-red-500 text-slate-50 hover:bg-red-500/90'</span>,
        <span class="hljs-attr">outline</span>: <span class="hljs-string">'border border-slate-200 bg-white hover:bg-slate-100'</span>,
        <span class="hljs-attr">secondary</span>: <span class="hljs-string">'bg-slate-100 text-slate-900 hover:bg-slate-100/80'</span>,
        <span class="hljs-attr">ghost</span>: <span class="hljs-string">'hover:bg-slate-100 hover:text-slate-900'</span>,
        <span class="hljs-attr">link</span>: <span class="hljs-string">'text-slate-900 underline-offset-4 hover:underline'</span>,
      },
      <span class="hljs-attr">size</span>: {
        <span class="hljs-attr">default</span>: <span class="hljs-string">'h-10 px-4 py-2'</span>,
        <span class="hljs-attr">sm</span>: <span class="hljs-string">'h-9 rounded-md px-3'</span>,
        <span class="hljs-attr">lg</span>: <span class="hljs-string">'h-11 rounded-md px-8'</span>,
        <span class="hljs-attr">icon</span>: <span class="hljs-string">'h-10 w-10'</span>,
      },
    },
    <span class="hljs-attr">defaultVariants</span>: {
      <span class="hljs-attr">variant</span>: <span class="hljs-string">'default'</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-string">'default'</span>,
    },
  }
);

export <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">ButtonProps</span>
  <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">ButtonHTMLAttributes</span>&lt;<span class="hljs-title">HTMLButtonElement</span>&gt;,
    <span class="hljs-title">VariantProps</span>&lt;<span class="hljs-title">typeof</span> <span class="hljs-title">buttonVariants</span>&gt; </span>{
  asChild?: <span class="hljs-keyword">boolean</span>;
}

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">Button</span> = React.forwardRef&lt;HTMLButtonElement, ButtonProps&gt;(
  ({ className, variant, size, asChild = <span class="hljs-literal">false</span>, ...props }, ref) =&gt; {
    <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">Comp</span> = asChild ? Slot : <span class="hljs-string">'button'</span>;
    <span class="hljs-keyword">return</span> (
      &lt;Comp
        className={<span class="hljs-title function_ invoke__">cn</span>(<span class="hljs-title function_ invoke__">buttonVariants</span>({ variant, size, className }))}
        ref={ref}
        {...props}
      /&gt;
    );
  }
);
Button.displayName = <span class="hljs-string">'Button'</span>;

export { Button, buttonVariants };
</code></pre>
<h3 data-id="heading-13">3. å®šä¹‰æ³¨å†Œè¡¨é…ç½®</h3>
<pre><code class="hljs language-perl" lang="perl">{
  <span class="hljs-string">"$schema"</span>: <span class="hljs-string">"https://ui.shadcn.com/schema/registry.json"</span>,
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"erishen"</span>,
  <span class="hljs-string">"homepage"</span>: <span class="hljs-string">"https://erishen.github.io/shadcn-registry/"</span>,
  <span class="hljs-string">"items"</span>: [
    {
      <span class="hljs-string">"name"</span>: <span class="hljs-string">"button"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"registry:ui"</span>,
      <span class="hljs-string">"title"</span>: <span class="hljs-string">"Button"</span>,
      <span class="hljs-string">"description"</span>: <span class="hljs-string">"A versatile button component with multiple variants"</span>,
      <span class="hljs-string">"dependencies"</span>: [<span class="hljs-string">"@radix-ui/react-slot"</span>, <span class="hljs-string">"class-variance-authority"</span>, <span class="hljs-string">"clsx"</span>, <span class="hljs-string">"tailwind-merge"</span>],
      <span class="hljs-string">"files"</span>: [
        {
          <span class="hljs-string">"path"</span>: <span class="hljs-string">"registry/new-york/ui/button.tsx"</span>,
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"registry:ui"</span>
        }
      ]
    },
    {
      <span class="hljs-string">"name"</span>: <span class="hljs-string">"data-table"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"registry:component"</span>,
      <span class="hljs-string">"title"</span>: <span class="hljs-string">"Data Table"</span>, 
      <span class="hljs-string">"description"</span>: <span class="hljs-string">"Feature-rich data table with sorting, filtering, and pagination"</span>,
      <span class="hljs-string">"dependencies"</span>: [<span class="hljs-string">"react"</span>, <span class="hljs-string">"react-dom"</span>],
      <span class="hljs-string">"files"</span>: [
        {
          <span class="hljs-string">"path"</span>: <span class="hljs-string">"components/data-table.tsx"</span>,
          <span class="hljs-string">"type"</span>: <span class="hljs-string">"registry:component"</span>
        }
      ]
    }
  ]
}
</code></pre>
<h2 data-id="heading-14">ğŸ¯ å®é™…åº”ç”¨ï¼šDataTable ç»„ä»¶ç¤ºä¾‹</h2>
<h3 data-id="heading-15">ä¸ºä»€ä¹ˆé€‰æ‹© DataTable ä½œä¸ºæ¼”ç¤ºï¼Ÿ</h3>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// ä¼ ç»Ÿæ–¹å¼ï¼šéœ€è¦å®‰è£…å¤šä¸ªä¾èµ–</span>
<span class="hljs-type">const</span> traditionalSetup = {
  react_table: <span class="hljs-string">"@tanstack/react-table"</span>,      <span class="hljs-comment">// è¡¨æ ¼æ ¸å¿ƒ</span>
  ui_framework: <span class="hljs-string">"@headlessui/react"</span>,        <span class="hljs-comment">// UI ç»„ä»¶</span>
  icons: <span class="hljs-string">"@heroicons/react"</span>,                 <span class="hljs-comment">// å›¾æ ‡</span>
  utils: [<span class="hljs-string">"clsx"</span>, <span class="hljs-string">"tailwind-merge"</span>],        <span class="hljs-comment">// å·¥å…·å‡½æ•°</span>
  styling: <span class="hljs-string">"tailwindcss"</span>,                   <span class="hljs-comment">// æ ·å¼</span>
  total_deps: <span class="hljs-string">"50+ packages"</span>                <span class="hljs-comment">// 50 å¤šä¸ªä¾èµ–åŒ…ï¼</span>
};

<span class="hljs-comment">// shadcn æ–¹å¼ï¼šä¸€è¡Œå‘½ä»¤æå®š</span>
<span class="hljs-type">const</span> shadcnSetup = {
  command: <span class="hljs-string">"pnpm dlx shadcn@latest add https://your-registry.com/r/data-table.json"</span>,
  dependencies: <span class="hljs-string">"ç›´æ¥é›†æˆåˆ°é¡¹ç›®"</span>,           <span class="hljs-comment">// æ— é¢å¤–ä¾èµ–</span>
  customization: <span class="hljs-string">"å®Œå…¨å¯æ§"</span>,                 <span class="hljs-comment">// å¯ä»¥ä»»æ„ä¿®æ”¹</span>
  size: <span class="hljs-string">"å•ä¸ªæ–‡ä»¶"</span>                           <span class="hljs-comment">// ç²¾ç¡®æ§åˆ¶</span>
};
</code></pre>
<h3 data-id="heading-16">DataTable ç»„ä»¶å®ç°</h3>
<pre><code class="hljs language-ini" lang="ini">'use client'<span class="hljs-comment">;</span>

import { useState, useMemo } from 'react'<span class="hljs-comment">;</span>
import { Button } from '@/components/ui/button'<span class="hljs-comment">;</span>
import { Input } from '@/components/ui/input'<span class="hljs-comment">;</span>

interface Column&lt;T&gt; {
  key: keyof T<span class="hljs-comment">;</span>
  label: string<span class="hljs-comment">;</span>
  sortable?: boolean<span class="hljs-comment">;</span>
  filterable?: boolean<span class="hljs-comment">;</span>
  render?: (value: T<span class="hljs-section">[keyof T]</span>, row: T) =&gt; React.ReactNode<span class="hljs-comment">;</span>
}

export function DataTable&lt;T extends Record&lt;string, any&gt;&gt;({
  data,
  columns,
  <span class="hljs-attr">pageSize</span> = <span class="hljs-number">10</span>,
  onRowClick,
}: DataTableProps&lt;T&gt;) {
  const <span class="hljs-section">[currentPage, setCurrentPage]</span> = useState(1)<span class="hljs-comment">;</span>
  const <span class="hljs-section">[sortKey, setSortKey]</span> = useState&lt;keyof T | null&gt;(null)<span class="hljs-comment">;</span>
  const <span class="hljs-section">[sortDirection, setSortDirection]</span> = useState&lt;'asc' | 'desc' | null&gt;(null)<span class="hljs-comment">;</span>
  const <span class="hljs-section">[filters, setFilters]</span> = useState&lt;Record&lt;string, string&gt;&gt;({})<span class="hljs-comment">;</span>

  // æ€§èƒ½ä¼˜åŒ–ï¼šuseMemo ç¼“å­˜
  const <span class="hljs-attr">filteredData</span> = useMemo(() =&gt; {
    return data.filter((row) =&gt; {
      return Object.entries(filters).every((<span class="hljs-section">[key, value]</span>) =&gt; {
        if (!value) return true<span class="hljs-comment">;</span>
        const <span class="hljs-attr">cellValue</span> = String(row[key as keyof T]).toLowerCase()<span class="hljs-comment">;</span>
        return cellValue.includes(value.toLowerCase())<span class="hljs-comment">;</span>
      })<span class="hljs-comment">;</span>
    })<span class="hljs-comment">;</span>
  }, <span class="hljs-section">[data, filters]</span>)<span class="hljs-comment">;</span>

  // ä¸‰çº§æ’åºé€»è¾‘
  const <span class="hljs-attr">handleSort</span> = (key: keyof T) =&gt; {
    if (<span class="hljs-attr">sortKey</span> === key) {
      if (<span class="hljs-attr">sortDirection</span> === <span class="hljs-string">'asc'</span>) {
        setSortDirection('desc')<span class="hljs-comment">;</span>
      } else if (<span class="hljs-attr">sortDirection</span> === <span class="hljs-string">'desc'</span>) {
        setSortDirection(null)<span class="hljs-comment">;</span>
        setSortKey(null)<span class="hljs-comment">;</span>
      }
    } else {
      setSortKey(key)<span class="hljs-comment">;</span>
      setSortDirection('asc')<span class="hljs-comment">;</span>
    }
  }<span class="hljs-comment">;</span>

  return (
    &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"w-full space-y-4"</span>&gt;
      {/* æœç´¢è¿‡æ»¤ */}
      &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"flex gap-4 p-4 bg-white rounded border"</span>&gt;
        {columns.filter(<span class="hljs-attr">col</span> =&gt; col.filterable).map(col =&gt; (
          &lt;Input
            <span class="hljs-attr">key</span>={String(col.key)}
            <span class="hljs-attr">placeholder</span>={`æœç´¢ <span class="hljs-variable">${col.label}</span>...`}
            <span class="hljs-attr">value</span>={filters[String(col.key)] || <span class="hljs-string">''</span>}
            <span class="hljs-attr">onChange</span>={(e) =&gt; setFilters(prev =&gt; ({ ...prev, [col.key]: e.target.value }))}
            <span class="hljs-attr">className</span>=<span class="hljs-string">"w-48"</span>
          /&gt;
        ))}
      &lt;/div&gt;

      {/* è¡¨æ ¼ */}
      &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"border rounded bg-white"</span>&gt;
        &lt;table <span class="hljs-attr">className</span>=<span class="hljs-string">"w-full"</span>&gt;
          &lt;thead <span class="hljs-attr">className</span>=<span class="hljs-string">"bg-gray-50"</span>&gt;
            &lt;tr&gt;
              {columns.map(<span class="hljs-attr">col</span> =&gt; (
                &lt;th <span class="hljs-attr">key</span>={String(col.key)} className=<span class="hljs-string">"p-4 text-left"</span>&gt;
                  {col.sortable ? (
                    &lt;button <span class="hljs-attr">onClick</span>={() =&gt; handleSort(col.key)} className=<span class="hljs-string">"flex items-center gap-2"</span>&gt;
                      {col.label}
                      &lt;span <span class="hljs-attr">className</span>=<span class="hljs-string">"text-xs"</span>&gt;
                        {<span class="hljs-attr">sortKey</span> === col.key ? (sortDirection === <span class="hljs-string">'asc'</span> ? <span class="hljs-string">'â†‘'</span> : <span class="hljs-string">'â†“'</span>) : <span class="hljs-string">'â†•'</span>}
                      &lt;/span&gt;
                    &lt;/button&gt;
                  ) : col.label}
                &lt;/th&gt;
              ))}
            &lt;/tr&gt;
          &lt;/thead&gt;
          &lt;tbody&gt;
            {filteredData.slice((currentPage - 1) * pageSize, currentPage * pageSize).map(<span class="hljs-attr">row</span> =&gt; (
              &lt;tr <span class="hljs-attr">key</span>={row.id} <span class="hljs-literal">on</span>Click={() =&gt; <span class="hljs-literal">on</span>RowClick?.(row)} className=<span class="hljs-string">"border-t hover:bg-gray-50 cursor-pointer"</span>&gt;
                {columns.map(<span class="hljs-attr">col</span> =&gt; (
                  &lt;td <span class="hljs-attr">key</span>={String(col.key)} className=<span class="hljs-string">"p-4"</span>&gt;
                    {col.render ? col.render(row<span class="hljs-section">[col.key]</span>, row) : String(row<span class="hljs-section">[col.key]</span>)}
                  &lt;/td&gt;
                ))}
              &lt;/tr&gt;
            ))}
          &lt;/tbody&gt;
        &lt;/table&gt;
      &lt;/div&gt;

      {/* åˆ†é¡µ */}
      &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"flex justify-between p-4 bg-white rounded border"</span>&gt;
        &lt;div&gt;å…± {filteredData.length} æ¡è®°å½•&lt;/div&gt;
        &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"flex gap-2"</span>&gt;
          &lt;Button 
            <span class="hljs-attr">variant</span>=<span class="hljs-string">"outline"</span> 
            <span class="hljs-attr">size</span>=<span class="hljs-string">"sm"</span> 
            <span class="hljs-attr">onClick</span>={() =&gt; setCurrentPage(p =&gt; Math.max(<span class="hljs-number">1</span>, p - <span class="hljs-number">1</span>))}
            <span class="hljs-attr">disabled</span>={currentPage === <span class="hljs-number">1</span>}
          &gt;
            ä¸Šä¸€é¡µ
          &lt;/Button&gt;
          &lt;Button 
            <span class="hljs-attr">variant</span>=<span class="hljs-string">"outline"</span> 
            <span class="hljs-attr">size</span>=<span class="hljs-string">"sm"</span>
            <span class="hljs-attr">onClick</span>={() =&gt; setCurrentPage(p =&gt; p + <span class="hljs-number">1</span>)}
            <span class="hljs-attr">disabled</span>={currentPage * pageSize &gt;= filteredData.length}
          &gt;
            ä¸‹ä¸€é¡µ
          &lt;/Button&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  )<span class="hljs-comment">;</span>
}
</code></pre>
<h2 data-id="heading-17">ğŸ“Š æ€§èƒ½å¯¹æ¯”ï¼šä¼ ç»Ÿ vs shadcn + Bun</h2>
<h3 data-id="heading-18">å¼€å‘ä½“éªŒå¯¹æ¯”</h3>









































<table><thead><tr><th>ç¯èŠ‚</th><th>ä¼ ç»Ÿæ–¹å¼ (npm)</th><th>shadcn + Bun</th><th>æå‡</th></tr></thead><tbody><tr><td>é¡¹ç›®åˆå§‹åŒ–</td><td>45s</td><td>3s</td><td><strong>15x</strong></td></tr><tr><td>ä¾èµ–å®‰è£…</td><td>180s</td><td>12s</td><td><strong>15x</strong></td></tr><tr><td>å¼€å‘å¯åŠ¨</td><td>8.5s</td><td>1.2s</td><td><strong>7x</strong></td></tr><tr><td>æ·»åŠ æ–°ç»„ä»¶</td><td>30s</td><td>5s</td><td><strong>6x</strong></td></tr><tr><td>æ„å»ºéƒ¨ç½²</td><td>120s</td><td>25s</td><td><strong>5x</strong></td></tr></tbody></table>
<h3 data-id="heading-19">å®é™…æµ‹è¯•æ•°æ®</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æµ‹è¯•é¡¹ç›®ï¼šNext.js + 20ä¸ªç»„ä»¶</span>
<span class="hljs-comment"># æµ‹è¯•ç¯å¢ƒï¼šMacBook Pro M1, 16GB RAM</span>

<span class="hljs-comment"># npm æ–¹å¼</span>
npm install &amp;&amp; npm run build
<span class="hljs-comment"># æ€»æ—¶é—´: 5m 45s</span>
<span class="hljs-comment"># node_modules: 450MB</span>

<span class="hljs-comment"># shadcn + Bun æ–¹å¼  </span>
bun install &amp;&amp; bun run build
<span class="hljs-comment"># æ€»æ—¶é—´: 1m 12s  ğŸš€</span>
<span class="hljs-comment"># ä»£ç é‡: ä»…éœ€ 45KB</span>
</code></pre>
<h3 data-id="heading-20">ä»£ç é‡å¯¹æ¯”</h3>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// ä¼ ç»Ÿè¡¨æ ¼ç»„ä»¶åº“</span>
<span class="hljs-type">const</span> traditionalTable = {
  dependencies: <span class="hljs-number">15</span>,           <span class="hljs-comment">// 15ä¸ªä¾èµ–åŒ…</span>
  bundle_size: <span class="hljs-string">"245KB"</span>,      <span class="hljs-comment">// æœ€ç»ˆæ‰“åŒ…å¤§å°</span>
  code_lines: <span class="hljs-string">"5000+"</span>,       <span class="hljs-comment">// æ ¸å¿ƒä»£ç è¡Œæ•°</span>
  customization: <span class="hljs-string">"å›°éš¾"</span>       <span class="hljs-comment">// å®šåˆ¶åŒ–å›°éš¾</span>
};

<span class="hljs-comment">// shadcn DataTable</span>
<span class="hljs-type">const</span> shadcnTable = {
  dependencies: <span class="hljs-number">0</span>,            <span class="hljs-comment">// æ— é¢å¤–ä¾èµ–</span>
  bundle_size: <span class="hljs-string">"8KB"</span>,        <span class="hljs-comment">// ç²¾ç¡®æ§åˆ¶å¤§å°</span>
  code_lines: <span class="hljs-string">"200"</span>,         <span class="hljs-comment">// 200è¡Œæ ¸å¿ƒä»£ç </span>
  customization: <span class="hljs-string">"å®Œå…¨å¯æ§"</span>   <span class="hljs-comment">// ä»»æ„ä¿®æ”¹</span>
};

<span class="hljs-comment">// ç»“æœï¼š30å€å¤§å°å·®å¼‚</span>
</code></pre>
<h2 data-id="heading-21">ğŸ¯ å®é™…é¡¹ç›®åº”ç”¨</h2>
<h3 data-id="heading-22">æ¡ˆä¾‹ï¼šç”µå•†åå°ç®¡ç†ç³»ç»Ÿ</h3>
<pre><code class="hljs language-perl" lang="perl">// ä¼ ç»Ÿæ–¹å¼ï¼šéœ€è¦å®‰è£…å¤§é‡ä¾èµ–
const ecommerceDependencies = [
  <span class="hljs-string">"@tanstack/react-table"</span>,    <span class="hljs-regexp">//</span> è¡¨æ ¼
  <span class="hljs-string">"@headlessui/react"</span>,       <span class="hljs-regexp">//</span> UIç»„ä»¶
  <span class="hljs-string">"@heroicons/react"</span>,        <span class="hljs-regexp">//</span> å›¾æ ‡
  <span class="hljs-string">"react-hook-form"</span>,         <span class="hljs-regexp">//</span> è¡¨å•
  <span class="hljs-string">"@hookform/resolvers"</span>,     <span class="hljs-regexp">//</span> è¡¨å•éªŒè¯
  <span class="hljs-string">"zod"</span>,                     <span class="hljs-regexp">//</span> æ•°æ®éªŒè¯
  <span class="hljs-string">"clsx"</span>,                    <span class="hljs-regexp">//</span> æ ·å¼å·¥å…·
  <span class="hljs-string">"tailwind-merge"</span>,          <span class="hljs-regexp">//</span> Tailwindåˆå¹¶
  <span class="hljs-string">"date-fns"</span>,                <span class="hljs-regexp">//</span> æ—¥æœŸå¤„ç†
  <span class="hljs-string">"lodash"</span>,                  <span class="hljs-regexp">//</span> å·¥å…·å‡½æ•°
  // ... æ€»å…±<span class="hljs-number">30</span>+ä¸ªåŒ…
];

<span class="hljs-regexp">//</span> shadcn æ–¹å¼ï¼šä¸€è¡Œå‘½ä»¤
// pnpm dlx shadcn@latest add https:<span class="hljs-regexp">//</span>your-registry.com/r/ecommerce-package.json
</code></pre>
<h3 data-id="heading-23">ç»„ä»¶ä½¿ç”¨ç¤ºä¾‹</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ç”¨æˆ·ç®¡ç†é¡µé¢</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">DataTable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/components/data-table'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/components/ui/button'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Input</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/components/ui/input'</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">User</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">email</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">role</span>: <span class="hljs-string">'admin'</span> | <span class="hljs-string">'user'</span>;
  <span class="hljs-attr">status</span>: <span class="hljs-string">'active'</span> | <span class="hljs-string">'inactive'</span>;
}

<span class="hljs-keyword">const</span> <span class="hljs-attr">userColumns</span>: <span class="hljs-title class_">Column</span>&lt;<span class="hljs-title class_">User</span>&gt;[] = [
  {
    <span class="hljs-attr">key</span>: <span class="hljs-string">'name'</span>,
    <span class="hljs-attr">label</span>: <span class="hljs-string">'ç”¨æˆ·å'</span>,
    <span class="hljs-attr">sortable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">filterable</span>: <span class="hljs-literal">true</span>,
  },
  {
    <span class="hljs-attr">key</span>: <span class="hljs-string">'email'</span>, 
    <span class="hljs-attr">label</span>: <span class="hljs-string">'é‚®ç®±'</span>,
    <span class="hljs-attr">sortable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">filterable</span>: <span class="hljs-literal">true</span>,
  },
  {
    <span class="hljs-attr">key</span>: <span class="hljs-string">'role'</span>,
    <span class="hljs-attr">label</span>: <span class="hljs-string">'è§’è‰²'</span>,
    <span class="hljs-attr">render</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">px-2</span> <span class="hljs-attr">py-1</span> <span class="hljs-attr">rounded</span> <span class="hljs-attr">text-xs</span> ${
        <span class="hljs-attr">value</span> === <span class="hljs-string">'admin'</span> ? '<span class="hljs-attr">bg-purple-100</span> <span class="hljs-attr">text-purple-800</span>' <span class="hljs-attr">:</span> '<span class="hljs-attr">bg-blue-100</span> <span class="hljs-attr">text-blue-800</span>'
      }`}&gt;</span>
        {value === 'admin' ? 'ç®¡ç†å‘˜' : 'ç”¨æˆ·'}
      <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>
    ),
  },
  {
    <span class="hljs-attr">key</span>: <span class="hljs-string">'status'</span>,
    <span class="hljs-attr">label</span>: <span class="hljs-string">'çŠ¶æ€'</span>,
    <span class="hljs-attr">render</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">px-2</span> <span class="hljs-attr">py-1</span> <span class="hljs-attr">rounded</span> <span class="hljs-attr">text-xs</span> ${
        <span class="hljs-attr">value</span> === <span class="hljs-string">'active'</span> ? '<span class="hljs-attr">bg-green-100</span> <span class="hljs-attr">text-green-800</span>' <span class="hljs-attr">:</span> '<span class="hljs-attr">bg-red-100</span> <span class="hljs-attr">text-red-800</span>'
      }`}&gt;</span>
        {value === 'active' ? 'æ¿€æ´»' : 'ç¦ç”¨'}
      <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>
    ),
  },
];

<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserManagement</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [users, setUsers] = useState&lt;<span class="hljs-title class_">User</span>[]&gt;([]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"p-6"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"flex justify-between items-center mb-6"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"text-2xl font-bold"</span>&gt;</span>ç”¨æˆ·ç®¡ç†<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>&gt;</span>æ·»åŠ ç”¨æˆ·<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      
      <span class="hljs-tag">&lt;<span class="hljs-name">DataTable</span>
        <span class="hljs-attr">data</span>=<span class="hljs-string">{users}</span>
        <span class="hljs-attr">columns</span>=<span class="hljs-string">{userColumns}</span>
        <span class="hljs-attr">pageSize</span>=<span class="hljs-string">{20}</span>
        <span class="hljs-attr">onRowClick</span>=<span class="hljs-string">{(user)</span> =&gt;</span> navigate(`/users/${user.id}`)}
      /&gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h2 data-id="heading-24">ğŸš€ éƒ¨ç½²ä¸åˆ†äº«</h2>
<h3 data-id="heading-25">GitHub Pages éƒ¨ç½²</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è‡ªåŠ¨éƒ¨ç½²è„šæœ¬</span>
{
  <span class="hljs-string">"scripts"</span>: {
    <span class="hljs-string">"build"</span>: <span class="hljs-string">"bun next build"</span>,
    <span class="hljs-string">"export"</span>: <span class="hljs-string">"bun next export"</span>, 
    <span class="hljs-string">"deploy"</span>: <span class="hljs-string">"bun run build &amp;&amp; touch out/.nojekyll"</span>
  }
}

<span class="hljs-comment"># è®¿é—®åœ°å€</span>
<span class="hljs-comment"># ç»„ä»¶å±•ç¤º: https://erishen.github.io/shadcn-registry/</span>
<span class="hljs-comment"># Storybook: https://erishen.github.io/shadcn-registry/storybook/</span>
</code></pre>
<h3 data-id="heading-26">å®é™…åº”ç”¨æ¡ˆä¾‹</h3>
<p>æˆ‘ä»¬å·²ç»åœ¨Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ferishen%2Finterview" target="_blank" title="https://github.com/erishen/interview" ref="nofollow noopener noreferrer">interview</a>Â é¡¹ç›®ä¸­å®é™…éƒ¨ç½²äº†è¿™äº›ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">è®¿é—®æ¼”ç¤ºé¡µé¢</span>
<span class="hljs-meta prompt_"># </span><span class="bash">https://web.erishen.cn/data-table-demo</span>
<span class="hljs-meta prompt_"># </span><span class="bash">æºç ä½ç½®ï¼šinterview/apps/web/src/app/[locale]/data-table-demo/page.tsx</span>
</code></pre>
<h3 data-id="heading-27">ç¤¾åŒºåˆ†äº«</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># å…¶ä»–å¼€å‘è€…å¯ä»¥è¿™æ ·ä½¿ç”¨ä½ çš„ç»„ä»¶</span>
pnpm dlx shadcn@latest <span class="hljs-keyword">add</span> https:<span class="hljs-comment">//erishen.github.io/shadcn-registry/r/data-table.json</span>

<span class="hljs-meta"># æˆ–è€…ä»æœ¬åœ°å¼€å‘</span>
pnpm dlx shadcn@latest <span class="hljs-keyword">add</span> http:<span class="hljs-comment">//localhost:3000/r/data-table.json</span>
</code></pre>
<h2 data-id="heading-28">ğŸ’¡ æ ¸å¿ƒä¼˜åŠ¿æ€»ç»“</h2>
<h3 data-id="heading-29">1. shadcn çš„é©æ–°ç†å¿µ</h3>
<pre><code class="hljs language-css" lang="css">const shadcnAdvantages = {
  philosophy: <span class="hljs-string">"Copy and paste, not install"</span>,
  benefits: {
    no_dependencies: <span class="hljs-string">"æ— é¢å¤–ä¾èµ–ï¼Œå‡å°‘å†²çª"</span>,
    full_control: <span class="hljs-string">"å®Œå…¨å¯æ§ï¼Œå¯ä»¥ä»»æ„ä¿®æ”¹"</span>,
    tree_shaking: <span class="hljs-string">"ç²¾ç¡®çš„ä»£ç åˆ†å‰²"</span>,
    type_safe: <span class="hljs-string">"å®Œæ•´çš„ TypeScript æ”¯æŒ"</span>
  },
  installation: <span class="hljs-string">"ä¸€é”®å®‰è£…ï¼Œç±»ä¼¼åº”ç”¨å•†åº—"</span>,
  customization: <span class="hljs-string">"ç»„ä»¶ä»£ç ç›´æ¥å¤åˆ¶ï¼Œé¡¹ç›®å†…å¯æ§"</span>
};
</code></pre>
<h3 data-id="heading-30">2. Bun çš„æè‡´æ€§èƒ½</h3>
<pre><code class="hljs language-css" lang="css">const bunAdvantages = {
  performance: {
    install_speed: <span class="hljs-string">"10-20x faster than npm"</span>,
    dev_server: <span class="hljs-string">"7x faster startup"</span>,
    hot_reload: <span class="hljs-string">"70% faster reload"</span>,
    bundle_speed: <span class="hljs-string">"2x faster build"</span>
  },
  features: {
    native_performance: <span class="hljs-string">"åŸç”Ÿæ€§èƒ½ï¼Œæ—  Node.js å¼€é”€"</span>,
    web_apis: <span class="hljs-string">"å†…ç½® fetch, WebSocket, Streams"</span>,
    type_script: <span class="hljs-string">"åŸç”Ÿ TypeScript æ”¯æŒ"</span>,
    testing: <span class="hljs-string">"å†…ç½®æµ‹è¯•è¿è¡Œå™¨"</span>
  },
  developer_experience: {
    faster_feedback: <span class="hljs-string">"æ›´å¿«çš„å¼€å‘åé¦ˆ"</span>,
    less_waiting: <span class="hljs-string">"å‡å°‘ç­‰å¾…æ—¶é—´"</span>,
    better_caching: <span class="hljs-string">"æ™ºèƒ½ç¼“å­˜æœºåˆ¶"</span>
  }
};
</code></pre>
<h3 data-id="heading-31">3. ç»„ä»¶æ³¨å†Œè¡¨æ¨¡å¼</h3>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-type">const</span> registryBenefits = {
  distribution: <span class="hljs-string">"ç»„ä»¶åˆ†å‘çš„æ–°æ¨¡å¼"</span>,
  accessibility: <span class="hljs-string">"ä¸€é”®å®‰è£…ï¼Œé™ä½ä½¿ç”¨é—¨æ§›"</span>, 
  customization: <span class="hljs-string">"æ”¯æŒè‡ªå®šä¹‰ç»„ä»¶åº“"</span>,
  community: <span class="hljs-string">"å¼€æºç¤¾åŒºçš„ç»„ä»¶å…±äº«"</span>,
  scalability: <span class="hljs-string">"æ”¯æŒå›¢é˜Ÿå†…éƒ¨ç»„ä»¶æ ‡å‡†åŒ–"</span>
};
</code></pre>
<h2 data-id="heading-32">ğŸ”® æœªæ¥å±•æœ›</h2>
<h3 data-id="heading-33">ç»„ä»¶ç”Ÿæ€çš„å‘å±•æ–¹å‘</h3>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-type">const</span> futureVision = {
  registry_networks: <span class="hljs-string">"ç»„ä»¶æ³¨å†Œè¡¨ç½‘ç»œ"</span>,
  ai_assisted: <span class="hljs-string">"AI è¾…åŠ©ç»„ä»¶ç”Ÿæˆ"</span>,
  cross_platform: <span class="hljs-string">"è·¨å¹³å°ç»„ä»¶æ”¯æŒ"</span>,
  real_time_sync: <span class="hljs-string">"å®æ—¶ç»„ä»¶æ›´æ–°åŒæ­¥"</span>
};
</code></pre>
<h3 data-id="heading-34">å¯¹å‰ç«¯å¼€å‘çš„å½±å“</h3>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-type">const</span> industryImpact = {
  development_speed: <span class="hljs-string">"å¼€å‘é€Ÿåº¦æå‡ 5-10 å€"</span>,
  learning_curve: <span class="hljs-string">"é™ä½ç»„ä»¶ä½¿ç”¨é—¨æ§›"</span>,
  code_quality: <span class="hljs-string">"æé«˜ä»£ç è´¨é‡å’Œä¸€è‡´æ€§"</span>,
  ecosystem: <span class="hljs-string">"æ¨åŠ¨ç»„ä»¶ç”Ÿæ€æ ‡å‡†åŒ–"</span>
};
</code></pre>
<h2 data-id="heading-35">ğŸ“š å»¶ä¼¸é˜…è¯»</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fui.shadcn.com%2F" target="_blank" title="https://ui.shadcn.com/" ref="nofollow noopener noreferrer">shadcn/ui å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fbun.sh%2F" target="_blank" title="https://bun.sh/" ref="nofollow noopener noreferrer">Bun å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ferishen.github.io%2Fshadcn-registry%2F" target="_blank" title="https://erishen.github.io/shadcn-registry/" ref="nofollow noopener noreferrer">shadcn-registry æ¼”ç¤º</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ferishen%2Fshadcn-registry" target="_blank" title="https://github.com/erishen/shadcn-registry" ref="nofollow noopener noreferrer">GitHub æºç </a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ferishen.cn%2F%3Fp%3D192" target="_blank" title="https://erishen.cn/?p=192" ref="nofollow noopener noreferrer">ä¸ªäººåšå®¢æ·±åº¦è§£æ</a>Â - æ„å»ºç°ä»£åŒ–çš„ç»„ä»¶åº“ï¼šshadcn + Bun å¸¦æ¥çš„å‰ç«¯å¼€å‘é©å‘½</li>
</ul>
<hr/>
<p><strong>ğŸ’¡ è¿™ç¯‡æ–‡ç« å±•ç¤ºäº†å‰ç«¯å¼€å‘çš„æ–°å¯èƒ½æ€§ï¼šé€šè¿‡ shadcn çš„ç†å¿µ + Bun çš„æ€§èƒ½ï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°å®šä¹‰å¼€å‘ä½“éªŒã€‚</strong></p>
<p><strong>ğŸš€ å¦‚æœä½ è§‰å¾—è¿™ç§æ–¹å¼æœ‰æ½œåŠ›ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„æƒ³æ³•ï¼</strong></p>
<p><strong>ğŸ”¥ æƒ³è¦ä½“éªŒæè‡´å¼€å‘æ•ˆç‡ï¼Ÿè¯•è¯• Bun + shadcn çš„ç»„åˆï¼</strong></p>
<hr/>
<p><em>ä½œè€…ï¼šerishen</em><br/>
<em>å‘å¸ƒæ—¶é—´ï¼š2024å¹´1æœˆ</em><br/>
<em>æ ‡ç­¾ï¼š#shadcn #Bun #Next.js #ç»„ä»¶åº“ #å¼€å‘æ•ˆç‡</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è®©å¤§æ¨¡å‹â€œè®°ä½ä½ â€ï¼šLangChain ä¸­çš„å¯¹è¯è®°å¿†æœºåˆ¶å®æˆ˜]]></title>    <link>https://juejin.cn/post/7591309945511051264</link>    <guid>https://juejin.cn/post/7591309945511051264</guid>    <pubDate>2026-01-04T14:21:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591309945511051264" data-draft-id="7590654280899936299" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è®©å¤§æ¨¡å‹â€œè®°ä½ä½ â€ï¼šLangChain ä¸­çš„å¯¹è¯è®°å¿†æœºåˆ¶å®æˆ˜"/> <meta itemprop="keywords" content="LangChain"/> <meta itemprop="datePublished" content="2026-01-04T14:21:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Zyx2007"/> <meta itemprop="url" content="https://juejin.cn/user/3924597867554890"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è®©å¤§æ¨¡å‹â€œè®°ä½ä½ â€ï¼šLangChain ä¸­çš„å¯¹è¯è®°å¿†æœºåˆ¶å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3924597867554890/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Zyx2007
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T14:21:34.000Z" title="Sun Jan 04 2026 14:21:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æœ¬è´¨ä¸Šæ˜¯æ— çŠ¶æ€çš„â€”â€”æ¯ä¸€æ¬¡ API è°ƒç”¨éƒ½åƒä¸€æ¬¡å…¨æ–°çš„å¯¹è¯ï¼Œæ¨¡å‹å¯¹ä¹‹å‰çš„äº¤äº’ä¸€æ— æ‰€çŸ¥ã€‚è¿™ç§è®¾è®¡è™½ä¿è¯äº†æ¥å£çš„ç®€æ´ä¸å¯æ‰©å±•æ€§ï¼Œå´ä¹Ÿå¸¦æ¥äº†æ˜æ˜¾çš„å±€é™ï¼š<strong>æ— æ³•æ”¯æŒå¤šè½®è¿è´¯çš„å¯¹è¯ä½“éªŒ</strong>ã€‚ç”¨æˆ·è¯´â€œæˆ‘å«å¼ ä¸‰â€ï¼Œä¸‹ä¸€å¥é—®â€œæˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿâ€ï¼Œè‹¥ä¸ä¼ é€’ä¸Šä¸‹æ–‡ï¼Œæ¨¡å‹åªèƒ½å›ç­”â€œæˆ‘ä¸çŸ¥é“â€ã€‚è¦è®© AI çœŸæ­£å…·å¤‡â€œè®°å¿†â€ï¼Œå¼€å‘è€…å¿…é¡»ä¸»åŠ¨ç»´æŠ¤å¯¹è¯å†å²ï¼Œå¹¶å°†å…¶ä½œä¸ºè¾“å…¥çš„ä¸€éƒ¨åˆ†ä¼ ç»™æ¨¡å‹ã€‚è€Œ LangChain æä¾›çš„ <code>RunnableWithMessageHistory</code> æœºåˆ¶ï¼Œæ­£æ˜¯è§£å†³è¿™ä¸€é—®é¢˜çš„å·¥ç¨‹åŒ–æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-0">æ— çŠ¶æ€è°ƒç”¨çš„å±€é™</h2>
<p>æœ€åŸºç¡€çš„ LLM è°ƒç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">res1</span> = await model.invoke(<span class="hljs-string">'æˆ‘å«å¼ ä¸‰ï¼Œå–œæ¬¢å–ç™½å…°åœ°'</span>)<span class="hljs-comment">;</span>
const <span class="hljs-attr">res2</span> = await model.invoke(<span class="hljs-string">'æˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿ'</span>)<span class="hljs-comment">;</span>
console.log(res2.content)<span class="hljs-comment">; // æ¨¡å‹æ— æ³•å›ç­”ï¼Œå› æ— ä¸Šä¸‹æ–‡</span>
</code></pre>
<p>ä¸¤æ¬¡è°ƒç”¨å½¼æ­¤ç‹¬ç«‹ï¼Œæ¨¡å‹æ— æ³•å»ºç«‹å…³è”ã€‚è¿™å°±åƒæ¯æ¬¡è§é¢éƒ½å¿˜è®°å¯¹æ–¹æ˜¯è°ï¼Œæ˜¾ç„¶æ— æ³•æ”¯æ’‘çœŸå®çš„å¯¹è¯åœºæ™¯ã€‚è¦å®ç°è¿è´¯äº¤äº’ï¼Œå¿…é¡»å°†ä¹‹å‰çš„å¯¹è¯è®°å½•ï¼ˆmessagesï¼‰ä¸€å¹¶ä¼ å…¥ã€‚</p>
<h2 data-id="heading-1">æ‰‹åŠ¨ç»´æŠ¤æ¶ˆæ¯å†å²ï¼šå¯è¡Œä½†ç¹ç</h2>
<p>ä¸€ç§æœ´ç´ çš„åšæ³•æ˜¯æ‰‹åŠ¨ç»´æŠ¤ä¸€ä¸ªæ¶ˆæ¯æ•°ç»„ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">messages</span> = [
  { role: <span class="hljs-string">'user'</span>, content: <span class="hljs-string">'æˆ‘å«å¼ ä¸‰ï¼Œå–œæ¬¢å–ç™½å…°åœ°'</span> },
  { role: <span class="hljs-string">'assistant'</span>, content: <span class="hljs-string">'å¥½çš„ï¼Œå¼ ä¸‰ï¼'</span> },
  { role: <span class="hljs-string">'user'</span>, content: <span class="hljs-string">'æˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿ'</span> }
]<span class="hljs-comment">;</span>
// å°† messages ä½œä¸º prompt çš„ä¸€éƒ¨åˆ†ä¼ ç»™æ¨¡å‹
</code></pre>
<p>ç„¶è€Œï¼Œè¿™ç§æ–¹å¼å­˜åœ¨æ˜æ˜¾é—®é¢˜ï¼šéšç€å¯¹è¯è½®æ¬¡å¢åŠ ï¼Œæ¶ˆæ¯é•¿åº¦å‘ˆâ€œæ»šé›ªçƒâ€å¼å¢é•¿ï¼Œè¿…é€Ÿæ¶ˆè€—å¤§é‡ tokenï¼Œä¸ä»…å¢åŠ æˆæœ¬ï¼Œè¿˜å¯èƒ½è¶…å‡ºæ¨¡å‹ä¸Šä¸‹æ–‡çª—å£é™åˆ¶ã€‚æ›´å…³é”®çš„æ˜¯ï¼Œ<strong>å¼€å‘è€…éœ€è‡ªè¡Œç®¡ç†å­˜å‚¨ã€æˆªæ–­ã€ä¼šè¯éš”ç¦»ç­‰é€»è¾‘</strong>ï¼Œææ˜“å‡ºé”™ã€‚</p>
<h2 data-id="heading-2">LangChain çš„è§£å†³æ–¹æ¡ˆï¼šå†…ç½®è®°å¿†æ¨¡å—</h2>
<p>LangChain é€šè¿‡ <code>RunnableWithMessageHistory</code> æŠ½è±¡ï¼Œå°†â€œå¸¦è®°å¿†çš„å¯¹è¯â€å°è£…ä¸ºä¸€ä¸ªå¯å¤ç”¨çš„è¿è¡Œå•å…ƒã€‚é…åˆ <code>InMemoryChatMessageHistory</code>ï¼Œå¯è½»æ¾å®ç°ä¼šè¯çº§è®°å¿†ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">const</span> messageHistory = <span class="hljs-keyword">new</span> InMemoryChatMessageHistory();
<span class="hljs-keyword">const</span> chain = <span class="hljs-keyword">new</span> RunnableWithMessageHistory({
  runnable,
  getMessageHistory: <span class="hljs-keyword">async</span> () =&gt; messageHistory,
  inputMessagesKey: <span class="hljs-string">'input'</span>,
  historyMessagesKey: <span class="hljs-string">'history'</span>,
});
</code></pre>
<p>è¿™é‡Œï¼Œ<code>runnable</code> æ˜¯åŸå§‹çš„æç¤ºè¯+æ¨¡å‹é“¾ï¼Œè€Œ <code>RunnableWithMessageHistory</code> åœ¨å…¶å‰åè‡ªåŠ¨æ³¨å…¥å’Œæ›´æ–°å¯¹è¯å†å²ã€‚å¼€å‘è€…åªéœ€å…³æ³¨å½“å‰è¾“å…¥ï¼Œå†å²ç®¡ç†ç”±æ¡†æ¶è‡ªåŠ¨å®Œæˆã€‚</p>
<h2 data-id="heading-3">æ„å»ºå¸¦è®°å¿†çš„å¯¹è¯é“¾</h2>
<p>å®Œæ•´çš„æµç¨‹åŒ…å«ç³»ç»Ÿæç¤ºã€å†å²å ä½ç¬¦å’Œç”¨æˆ·è¾“å…¥ä¸‰éƒ¨åˆ†ï¼š</p>
<pre><code class="hljs language-css" lang="css">const prompt = ChatPromptTemplate<span class="hljs-selector-class">.fromMessages</span>(<span class="hljs-selector-attr">[  [<span class="hljs-string">'system'</span>, <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªæœ‰è®°å¿†çš„åŠ©æ‰‹"</span>]</span>,
  <span class="hljs-selector-attr">[<span class="hljs-string">'placeholder'</span>, <span class="hljs-string">"{history}"</span>]</span>,
  <span class="hljs-selector-attr">[<span class="hljs-string">'human'</span>, <span class="hljs-string">"{input}"</span>]</span>
]);
</code></pre>
<ul>
<li><code>system</code> æ¶ˆæ¯è®¾å®šè§’è‰²ï¼›</li>
<li><code>{history}</code> å ä½ç¬¦ç”± LangChain è‡ªåŠ¨æ›¿æ¢ä¸ºè¿‡å¾€å¯¹è¯ï¼›</li>
<li><code>{input}</code> æ¥æ”¶å½“å‰ç”¨æˆ·æé—®ã€‚</li>
</ul>
<p>å½“è°ƒç”¨ <code>chain.invoke()</code> æ—¶ï¼Œæ¡†æ¶ä¼šï¼š</p>
<ol>
<li>ä» <code>messageHistory</code> è¯»å–å·²æœ‰æ¶ˆæ¯ï¼›</li>
<li>å°†å…¶æ’å…¥ <code>prompt</code> çš„ <code>{history}</code> ä½ç½®ï¼›</li>
<li>è°ƒç”¨æ¨¡å‹ç”Ÿæˆå›å¤ï¼›</li>
<li>å°†æ–°å¯¹è¯ï¼ˆç”¨æˆ·è¾“å…¥ + æ¨¡å‹å›å¤ï¼‰å­˜å› <code>messageHistory</code>ã€‚</li>
</ol>
<h2 data-id="heading-4">ä¼šè¯éš”ç¦»ä¸å®é™…æ•ˆæœ</h2>
<p>é€šè¿‡ <code>sessionId</code> å¯åŒºåˆ†ä¸åŒç”¨æˆ·çš„å¯¹è¯ä¸Šä¸‹æ–‡ï¼š</p>
<pre><code class="hljs language-css" lang="css">await chain<span class="hljs-selector-class">.invoke</span>({ <span class="hljs-selector-tag">input</span>: <span class="hljs-string">'æˆ‘å«å¼ ä¸‰...'</span> }, { configurable: { sessionId: <span class="hljs-string">'user123'</span> } });
await chain<span class="hljs-selector-class">.invoke</span>({ <span class="hljs-selector-tag">input</span>: <span class="hljs-string">'æˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿ'</span> }, { configurable: { sessionId: <span class="hljs-string">'user123'</span> } });
</code></pre>
<p>ç¬¬äºŒæ¬¡è°ƒç”¨æ—¶ï¼Œæ¨¡å‹èƒ½å‡†ç¡®å›ç­”â€œä½ å«å¼ ä¸‰â€ï¼Œå› ä¸ºå®ƒæ¥æ”¶åˆ°äº†å®Œæ•´çš„å¯¹è¯å†å²ã€‚æ•´ä¸ªè¿‡ç¨‹å¯¹å¼€å‘è€…é€æ˜ï¼Œæ— éœ€æ‰‹åŠ¨æ‹¼æ¥æ¶ˆæ¯ã€‚</p>
<h2 data-id="heading-5">å†…å­˜å­˜å‚¨çš„æƒè¡¡ä¸æ‰©å±•</h2>
<p>ç¤ºä¾‹ä¸­ä½¿ç”¨ <code>InMemoryChatMessageHistory</code> å°†å¯¹è¯æš‚å­˜äºå†…å­˜ï¼Œé€‚åˆæ¼”ç¤ºæˆ–çŸ­æœŸä¼šè¯ã€‚ä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œé€šå¸¸éœ€æ›¿æ¢ä¸ºæŒä¹…åŒ–å­˜å‚¨ï¼ˆå¦‚ Redisã€æ•°æ®åº“ï¼‰ï¼Œå¹¶é€šè¿‡è‡ªå®šä¹‰ <code>getMessageHistory</code> å‡½æ•°æŒ‰ <code>sessionId</code> åŠ è½½å†å²ã€‚LangChain çš„è®¾è®¡å…è®¸æ— ç¼åˆ‡æ¢åº•å±‚å­˜å‚¨ï¼Œä¿æŒä¸Šå±‚é€»è¾‘ä¸å˜ã€‚</p>
<p>æ­¤å¤–ï¼Œä¸ºé¿å… token è€—å°½ï¼Œè¿˜å¯ç»“åˆ<strong>æ‘˜è¦è®°å¿†</strong>ï¼ˆSummary Memoryï¼‰æˆ–<strong>æ»‘åŠ¨çª—å£</strong>ç­–ç•¥ï¼šå½“å†å²è¿‡é•¿æ—¶ï¼Œè‡ªåŠ¨å‹ç¼©æ—§å¯¹è¯æˆ–ä»…ä¿ç•™æœ€è¿‘ N è½®ã€‚è¿™äº›é«˜çº§åŠŸèƒ½åŒæ ·å¯é€šè¿‡ LangChain çš„ memory æ¨¡å—å®ç°ã€‚</p>
<h2 data-id="heading-6">å·¥ç¨‹ä»·å€¼ï¼šä»â€œé—®ç­”æœºâ€åˆ°â€œæ™ºèƒ½ä½“â€</h2>
<p>å¼•å…¥è®°å¿†æœºåˆ¶åï¼ŒAI åº”ç”¨çš„èƒ½åŠ›è¾¹ç•Œæ˜¾è‘—æ‹“å±•ï¼š</p>
<ul>
<li><strong>ä¸ªæ€§åŒ–æœåŠ¡</strong>ï¼šè®°ä½ç”¨æˆ·åå¥½ã€èº«ä»½ä¿¡æ¯ï¼›</li>
<li><strong>ä»»åŠ¡å»¶ç»­</strong>ï¼šåœ¨å¤šæ­¥éª¤æ“ä½œä¸­ä¿æŒä¸Šä¸‹æ–‡ï¼ˆå¦‚è®¢ç¥¨ã€è°ƒè¯•ï¼‰ï¼›</li>
<li><strong>æƒ…æ„Ÿè¿è´¯</strong>ï¼šç»´æŒè¯­æ°”ä¸é£æ ¼çš„ä¸€è‡´æ€§ã€‚</li>
</ul>
<p>æ›´é‡è¦çš„æ˜¯ï¼Œè¿™ç§èƒ½åŠ›ä»¥<strong>å£°æ˜å¼ã€æ¨¡å—åŒ–</strong>çš„æ–¹å¼é›†æˆï¼Œä¸ç ´ååŸæœ‰ä»£ç ç»“æ„ã€‚å¼€å‘è€…æ— éœ€é‡å†™æ•´ä¸ªè°ƒç”¨é€»è¾‘ï¼Œåªéœ€å°†æ™®é€šé“¾åŒ…è£…ä¸º <code>RunnableWithMessageHistory</code>ï¼Œå³å¯è·å¾—è®°å¿†èƒ½åŠ›ã€‚</p>
<h2 data-id="heading-7">ç»“è¯­</h2>
<p>è®©å¤§æ¨¡å‹â€œè®°ä½â€ç”¨æˆ·ï¼Œä¸æ˜¯é­”æ³•ï¼Œè€Œæ˜¯å·¥ç¨‹ã€‚LangChain é€šè¿‡æŠ½è±¡å¯¹è¯å†å²çš„ç®¡ç†ï¼Œå°†å¤æ‚çš„ä¸Šä¸‹æ–‡ç»´æŠ¤è½¬åŒ–ä¸ºç®€å•çš„é…ç½®é€‰é¡¹ã€‚è¿™ä¸ä»…é™ä½äº†å¤šè½®å¯¹è¯çš„å®ç°é—¨æ§›ï¼Œä¹Ÿä¸ºæ„å»ºçœŸæ­£æ™ºèƒ½ã€è¿è´¯ã€ä¸ªæ€§åŒ–çš„ AI åº”ç”¨é“ºå¹³äº†é“è·¯ã€‚åœ¨ AI ä»å·¥å…·èµ°å‘ä¼™ä¼´çš„è¿›ç¨‹ä¸­ï¼Œè®°å¿†ï¼Œæ­£æ˜¯å»ºç«‹ä¿¡ä»»ä¸æ·±åº¦äº¤äº’çš„ç¬¬ä¸€æ­¥ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[instanceof è¿ç®—ç¬¦çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•å®ç°]]></title>    <link>https://juejin.cn/post/7591130604430262312</link>    <guid>https://juejin.cn/post/7591130604430262312</guid>    <pubDate>2026-01-04T15:21:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591130604430262312" data-draft-id="7591330139083571215" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="instanceof è¿ç®—ç¬¦çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•å®ç°"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-04T15:21:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»£ç çŒäºº"/> <meta itemprop="url" content="https://juejin.cn/user/624972624037374"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            instanceof è¿ç®—ç¬¦çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•å®ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/624972624037374/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»£ç çŒäºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T15:21:03.000Z" title="Sun Jan 04 2026 15:21:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1.Â <strong><code>instanceof</code>Â çš„åŸºæœ¬åŸç†</strong></h2>
<p><code>instanceof</code>Â è¿ç®—ç¬¦ç”¨äºæ£€æµ‹<strong>æ„é€ å‡½æ•°çš„Â <code>prototype</code>Â å±æ€§</strong>æ˜¯å¦å‡ºç°åœ¨<strong>æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾</strong>ä¸Šã€‚</p>
<pre><code class="hljs language-js" lang="js">obj <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Constructor</span>
<span class="hljs-comment">// æ£€æŸ¥ Constructor.prototype æ˜¯å¦åœ¨ obj çš„åŸå‹é“¾ä¸Š</span>
</code></pre>
<h2 data-id="heading-1">2.Â <strong>JavaScript å†…éƒ¨å®ç°åŸç†</strong></h2>
<h3 data-id="heading-2"><strong>åŸå‹é“¾æŸ¥æ‰¾è¿‡ç¨‹ï¼š</strong></h3>
<ol>
<li>è·å–å¯¹è±¡çš„åŸå‹ï¼š<code>Object.getPrototypeOf(obj)</code></li>
<li>è·å–æ„é€ å‡½æ•°çš„åŸå‹ï¼š<code>Constructor.prototype</code></li>
<li>æ²¿ç€å¯¹è±¡çš„åŸå‹é“¾å‘ä¸ŠæŸ¥æ‰¾ï¼Œçœ‹æ˜¯å¦èƒ½æ‰¾åˆ°æ„é€ å‡½æ•°çš„åŸå‹</li>
</ol>
<h3 data-id="heading-3"><strong>ä¼ªä»£ç è¡¨ç¤ºï¼š</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">instanceof</span>(<span class="hljs-params">obj, Constructor</span>) {
    <span class="hljs-comment">// 1. åŸºæœ¬ç±»å‹ç›´æ¥è¿”å› false</span>
    <span class="hljs-keyword">if</span> (obj === <span class="hljs-literal">null</span> || <span class="hljs-keyword">typeof</span> obj !== <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> obj !== <span class="hljs-string">'function'</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-comment">// 2. è·å–å¯¹è±¡çš„åŸå‹</span>
    <span class="hljs-keyword">let</span> proto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(obj);
    
    <span class="hljs-comment">// 3. è·å–æ„é€ å‡½æ•°çš„åŸå‹</span>
    <span class="hljs-keyword">const</span> prototype = <span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
    
    <span class="hljs-comment">// 4. æ²¿ç€åŸå‹é“¾å‘ä¸ŠæŸ¥æ‰¾</span>
    <span class="hljs-keyword">while</span> (proto !== <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (proto === prototype) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        proto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(proto);
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<h2 data-id="heading-4">3.Â <strong>è‡ªå®šä¹‰å®ç°</strong></h2>
<h3 data-id="heading-5"><strong>å®Œæ•´çš„æ‰‹å†™å®ç°ï¼š</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">myInstanceof</span>(<span class="hljs-params">instance, Constructor</span>) {
    <span class="hljs-comment">// åŸºæœ¬ç±»å‹ç›´æ¥è¿”å› false</span>
    <span class="hljs-keyword">if</span> (instance === <span class="hljs-literal">null</span> || <span class="hljs-keyword">typeof</span> instance !== <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> instance !== <span class="hljs-string">'function'</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-comment">// æ„é€ å‡½æ•°å¿…é¡»æ˜¯å‡½æ•°</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Constructor</span> !== <span class="hljs-string">'function'</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">'Right-hand side of instanceof is not callable'</span>);
    }
    
    <span class="hljs-comment">// è·å–æ„é€ å‡½æ•°çš„åŸå‹</span>
    <span class="hljs-keyword">const</span> prototype = <span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
    
    <span class="hljs-comment">// è·å–å®ä¾‹çš„åŸå‹</span>
    <span class="hljs-keyword">let</span> proto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(instance);
    
    <span class="hljs-comment">// æ²¿ç€åŸå‹é“¾å‘ä¸ŠæŸ¥æ‰¾</span>
    <span class="hljs-keyword">while</span> (proto !== <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (proto === prototype) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        proto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(proto);
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<h3 data-id="heading-6"><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Student</span>(<span class="hljs-params">name, grade</span>) {
    <span class="hljs-title class_">Person</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, name);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">grade</span> = grade;
}

<span class="hljs-comment">// è®¾ç½®åŸå‹ç»§æ‰¿</span>
<span class="hljs-title class_">Student</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
<span class="hljs-title class_">Student</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Student</span>;

<span class="hljs-keyword">const</span> stu = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">'Alice'</span>, <span class="hljs-number">90</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">myInstanceof</span>(stu, <span class="hljs-title class_">Student</span>));  <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">myInstanceof</span>(stu, <span class="hljs-title class_">Person</span>));   <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">myInstanceof</span>(stu, <span class="hljs-title class_">Object</span>));   <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">myInstanceof</span>(stu, <span class="hljs-title class_">Array</span>));    <span class="hljs-comment">// false</span>

<span class="hljs-comment">// è¾¹ç•Œæƒ…å†µæµ‹è¯•</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">myInstanceof</span>(<span class="hljs-literal">null</span>, <span class="hljs-title class_">Object</span>));  <span class="hljs-comment">// false</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">myInstanceof</span>(<span class="hljs-literal">undefined</span>, <span class="hljs-title class_">Object</span>)); <span class="hljs-comment">// false</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">myInstanceof</span>(<span class="hljs-number">123</span>, <span class="hljs-title class_">Number</span>));   <span class="hljs-comment">// false (åŸå§‹ç±»å‹)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">myInstanceof</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Number</span>(<span class="hljs-number">123</span>), <span class="hljs-title class_">Number</span>)); <span class="hljs-comment">// true (å¯¹è±¡ç±»å‹)</span>
</code></pre>
<h2 data-id="heading-7">4.Â <strong>ç‰¹æ®Šæƒ…å†µä¸æ³¨æ„äº‹é¡¹</strong></h2>
<h3 data-id="heading-8"><strong>åŸºæœ¬ç±»å‹æ£€æµ‹ï¼š</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// åŸå§‹ç±»å‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'str'</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">String</span>);     <span class="hljs-comment">// false</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-string">'str'</span>) <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">String</span>); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// ä½¿ç”¨ Object() åŒ…è£…</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>(<span class="hljs-string">'str'</span>) <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">String</span>); <span class="hljs-comment">// true</span>
</code></pre>
<h3 data-id="heading-9"><strong>è¾¹ç•Œæƒ…å†µï¼š</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// 1. æ„é€ å‡½æ•°ä¸æ˜¯å‡½æ•°</span>
<span class="hljs-keyword">try</span> {
    [] <span class="hljs-keyword">instanceof</span> {};  <span class="hljs-comment">// TypeError: Right-hand side of 'instanceof' is not callable</span>
} <span class="hljs-keyword">catch</span>(e) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e.<span class="hljs-property">message</span>);
}

<span class="hljs-comment">// 2. ä¿®æ”¹æ„é€ å‡½æ•°çš„ prototype</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Foo</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">const</span> obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Foo</span>();

<span class="hljs-comment">// ä¿®æ”¹å‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Foo</span>);  <span class="hljs-comment">// true</span>

<span class="hljs-comment">// ä¿®æ”¹åŸå‹</span>
<span class="hljs-title class_">Foo</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = {};

<span class="hljs-comment">// ä¿®æ”¹å</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Foo</span>);  <span class="hljs-comment">// false (å› ä¸º obj.__proto__ æŒ‡å‘çš„æ˜¯æ—§çš„ Foo.prototype)</span>
</code></pre>
<h3 data-id="heading-10"><strong>Symbol.hasInstance è‡ªå®šä¹‰è¡Œä¸ºï¼š</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> {
    <span class="hljs-keyword">static</span> [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">hasInstance</span>](instance) {
        <span class="hljs-comment">// è‡ªå®šä¹‰ instanceof è¡Œä¸º</span>
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(instance);
    }
}

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([] <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">MyClass</span>);  <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>({} <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">MyClass</span>);  <span class="hljs-comment">// false</span>
</code></pre>
<h2 data-id="heading-11">5.Â <strong>æ€§èƒ½ä¼˜åŒ–ç‰ˆæœ¬</strong></h2>
<p>å¯¹äºé«˜é¢‘ä½¿ç”¨åœºæ™¯ï¼Œå¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">fastInstanceof</span>(<span class="hljs-params">instance, Constructor</span>) {
    <span class="hljs-comment">// å¿«é€Ÿå¤±è´¥æ¡ä»¶</span>
    <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span> || 
        <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Constructor</span> !== <span class="hljs-string">'function'</span> ||
        <span class="hljs-keyword">typeof</span> instance !== <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> instance !== <span class="hljs-string">'function'</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-comment">// ç¼“å­˜åŸå‹ï¼Œå‡å°‘å±æ€§è®¿é—®</span>
    <span class="hljs-keyword">const</span> prototype = <span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
    
    <span class="hljs-comment">// ä½¿ç”¨ while å¾ªç¯ï¼Œæ¯”é€’å½’æ€§èƒ½æ›´å¥½</span>
    <span class="hljs-keyword">let</span> proto = instance.<span class="hljs-property">__proto__</span>;  <span class="hljs-comment">// æˆ– Object.getPrototypeOf(instance)</span>
    
    <span class="hljs-keyword">while</span> (proto) {
        <span class="hljs-keyword">if</span> (proto === prototype) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        proto = proto.<span class="hljs-property">__proto__</span>;
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<h2 data-id="heading-12">6.Â <strong>ä¸Â <code>typeof</code>Â å’ŒÂ <code>isPrototypeOf</code>Â çš„åŒºåˆ«</strong></h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// instanceof æ£€æŸ¥åŸå‹é“¾</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([] <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>);      <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([] <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span>);     <span class="hljs-comment">// true</span>

<span class="hljs-comment">// typeof æ£€æŸ¥åŸå§‹ç±»å‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> []);                <span class="hljs-comment">// "object"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {});     <span class="hljs-comment">// "function"</span>

<span class="hljs-comment">// isPrototypeOf ä»åŸå‹è§’åº¦æ£€æŸ¥</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-title function_">isPrototypeOf</span>([]));   <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-title function_">isPrototypeOf</span>([]));  <span class="hljs-comment">// true</span>

<span class="hljs-comment">// ä¸‰è€…çš„å…³ç³»</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">checkType</span>(<span class="hljs-params">value</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'object'</span> &amp;&amp; value !== <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(value)) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">'Array'</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Date</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">'Date'</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">RegExp</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">'RegExp'</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-string">'Object'</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> value;
}
</code></pre>
<h2 data-id="heading-13">7.Â <strong>å®é™…åº”ç”¨åœºæ™¯</strong></h2>
<h3 data-id="heading-14"><strong>ç±»å‹å®‰å…¨æ£€æŸ¥ï¼š</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">processData</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-keyword">if</span> (!(data <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">'Expected an array'</span>);
    }
    <span class="hljs-keyword">return</span> data.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item * <span class="hljs-number">2</span>);
}

<span class="hljs-comment">// æˆ–è€…æ›´å‹å¥½çš„ç‰ˆæœ¬</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">safeProcess</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(data)) {
        <span class="hljs-keyword">return</span> data.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item * <span class="hljs-number">2</span>);
    }
    <span class="hljs-keyword">return</span> [];
}
</code></pre>
<h3 data-id="heading-15"><strong>å¤šé‡ç»§æ‰¿æ£€æµ‹ï¼š</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {}
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Mammal</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> {}
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Mammal</span> {}

<span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>();

<span class="hljs-comment">// æ£€æµ‹ç»§æ‰¿é“¾</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dog <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Dog</span>);      <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dog <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Mammal</span>);   <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dog <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Animal</span>);   <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dog <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span>);   <span class="hljs-comment">// true</span>
</code></pre>
<h3 data-id="heading-16"><strong>å·¥å‚å‡½æ•°ç±»å‹æ£€æµ‹ï¼š</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createShape</span>(<span class="hljs-params">type</span>) {
    <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'circle'</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>();
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'square'</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Square</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Shape</span>();
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params">shape</span>) {
    <span class="hljs-keyword">if</span> (shape <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Circle</span>) {
        <span class="hljs-title function_">drawCircle</span>(shape);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (shape <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Square</span>) {
        <span class="hljs-title function_">drawSquare</span>(shape);
    }
}
</code></pre>
<h2 data-id="heading-17">8.Â <strong>æ³¨æ„äº‹é¡¹</strong></h2>
<ol>
<li><strong><code>instanceof</code>Â ä¸è·¨çª—å£/iframe é—®é¢˜ï¼š</strong></li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¸åŒ iframe ä¸­çš„ Array æ„é€ å‡½æ•°ä¸ç›¸ç­‰</span>
<span class="hljs-keyword">const</span> iframe = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'iframe'</span>);
<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(iframe);
<span class="hljs-keyword">const</span> iframeArray = iframe.<span class="hljs-property">contentWindow</span>.<span class="hljs-property">Array</span>;
<span class="hljs-keyword">const</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-title function_">iframeArray</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>);          <span class="hljs-comment">// false</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(arr));           <span class="hljs-comment">// true (æ›´å®‰å…¨)</span>
</code></pre>
<ol start="2">
<li><strong>ä½¿ç”¨Â <code>Symbol.hasInstance</code>Â æ”¹å˜è¡Œä¸ºï¼š</strong></li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">PrimitiveNumber</span> {
    <span class="hljs-keyword">static</span> [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">hasInstance</span>](x) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> x === <span class="hljs-string">'number'</span>;
    }
}

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">123</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">PrimitiveNumber</span>);  <span class="hljs-comment">// true</span>
</code></pre>
<ol start="3">
<li><strong>ä¼˜å…ˆä½¿ç”¨å†…ç½®æ–¹æ³•ï¼š</strong></li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æ›´å¥½çš„æ•°ç»„æ£€æµ‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>([]));  <span class="hljs-comment">// true (æ¨è)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([] <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// æ›´å¥½çš„åŸå§‹ç±»å‹æ£€æµ‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-number">123</span> === <span class="hljs-string">'number'</span>);  <span class="hljs-comment">// æ¨è</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">123</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Number</span>);    <span class="hljs-comment">// ä¸æ¨è</span>
</code></pre>
<h2 data-id="heading-18"><strong>æ€»ç»“</strong></h2>
<p><code>instanceof</code>Â çš„æ ¸å¿ƒåŸç†æ˜¯<strong>åŸå‹é“¾æŸ¥æ‰¾</strong>ã€‚å®ƒçš„å®ç°æ¶‰åŠï¼š</p>
<ol>
<li>è·å–å¯¹è±¡çš„åŸå‹é“¾</li>
<li>æŸ¥æ‰¾æ„é€ å‡½æ•°çš„Â <code>prototype</code>Â å±æ€§æ˜¯å¦åœ¨åŸå‹é“¾ä¸Š</li>
<li>æ²¿ç€åŸå‹é“¾å‘ä¸Šé€’å½’æŸ¥æ‰¾</li>
</ol>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼š</p>
<ul>
<li>ä½¿ç”¨Â <code>instanceof</code>Â æ£€æµ‹<strong>è‡ªå®šä¹‰å¯¹è±¡ç±»å‹</strong></li>
<li>ä½¿ç”¨Â <code>Array.isArray()</code>Â æ£€æµ‹æ•°ç»„</li>
<li>ä½¿ç”¨Â <code>typeof</code>Â æ£€æµ‹åŸå§‹ç±»å‹</li>
<li>æ³¨æ„è·¨çª—å£/iframe çš„ç¯å¢ƒé—®é¢˜</li>
<li>å¯ä»¥ä½¿ç”¨Â <code>Symbol.hasInstance</code>Â è‡ªå®šä¹‰æ£€æµ‹é€»è¾‘</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Verceléƒ¨ç½²å…¨æ”»ç•¥:ä»GitHubåˆ°ä¸Šçº¿,10åˆ†é’Ÿè®©ä½ çš„å‰ç«¯é¡¹ç›®å…è´¹æ‹¥æœ‰è‡ªå·±çš„åŸŸå]]></title>    <link>https://juejin.cn/post/7591309945511165952</link>    <guid>https://juejin.cn/post/7591309945511165952</guid>    <pubDate>2026-01-04T14:57:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591309945511165952" data-draft-id="7591075684066574351" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Verceléƒ¨ç½²å…¨æ”»ç•¥:ä»GitHubåˆ°ä¸Šçº¿,10åˆ†é’Ÿè®©ä½ çš„å‰ç«¯é¡¹ç›®å…è´¹æ‹¥æœ‰è‡ªå·±çš„åŸŸå"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,Node.js"/> <meta itemprop="datePublished" content="2026-01-04T14:57:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†¬å¥‡Lab"/> <meta itemprop="url" content="https://juejin.cn/user/1857501105781193"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Verceléƒ¨ç½²å…¨æ”»ç•¥:ä»GitHubåˆ°ä¸Šçº¿,10åˆ†é’Ÿè®©ä½ çš„å‰ç«¯é¡¹ç›®å…è´¹æ‹¥æœ‰è‡ªå·±çš„åŸŸå
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1857501105781193/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†¬å¥‡Lab
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T14:57:49.000Z" title="Sun Jan 04 2026 14:57:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å†™åœ¨å‰é¢</h2>
<p>ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™æ ·çš„æƒ…å†µ:</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">ä½ : ç†¬å¤œåšäº†ä¸ªé…·ç‚«çš„å‰ç«¯é¡¹ç›®</span>
<span class="hljs-section">æœ‹å‹: èƒ½ç»™æˆ‘çœ‹çœ‹å—?</span>
<span class="hljs-section">ä½ : å‘ƒ...ä½ å…ˆåœ¨æœ¬åœ°cloneä¸‹æ¥,ç„¶ånpm install,å†npm run dev...</span>
<span class="hljs-section">æœ‹å‹: ç®—äº†ç®—äº† (è½¬èº«ç¦»å¼€)</span>
</code></pre>
<p>è¿™å°±æ˜¯<strong>æ²¡æœ‰éƒ¨ç½²ä¸Šçº¿</strong>çš„å°´å°¬ã€‚ä½ è¾›è¾›è‹¦è‹¦å†™çš„ä»£ç ,èººåœ¨GitHubä»“åº“é‡Œæ— äººé—®æ´¥,æƒ³å±•ç¤ºç»™åˆ«äººçœ‹è¿˜å¾—è®©å¯¹æ–¹æ­å»ºå¼€å‘ç¯å¢ƒã€‚</p>
<p>ä»Šå¤©è¿™ç¯‡æ–‡ç« ,æˆ‘å°†æ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•ç”¨<strong>Vercel</strong>æŠŠä½ çš„å‰ç«¯é¡¹ç›®éƒ¨ç½²åˆ°å…¬ç½‘,è®©ä»»ä½•äººéƒ½èƒ½é€šè¿‡ä¸€ä¸ªé“¾æ¥è®¿é—®ä½ çš„ä½œå“ã€‚æœ€é‡è¦çš„æ˜¯:<strong>å®Œå…¨å…è´¹,æ— éœ€æœåŠ¡å™¨,10åˆ†é’Ÿæå®š!</strong></p>
<h2 data-id="heading-1">ä¸ºä»€ä¹ˆé€‰æ‹©Vercel?</h2>
<p>åœ¨ä¼—å¤šå‰ç«¯éƒ¨ç½²å¹³å°ä¸­(Netlifyã€GitHub Pagesã€Cloudflare Pagesç­‰),æˆ‘ä¸ºä»€ä¹ˆæ¨èVercel?</p>
<h3 data-id="heading-2">Vercelçš„æ ¸å¿ƒä¼˜åŠ¿</h3>





















































<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="center">Vercel</th><th align="center">GitHub Pages</th><th align="center">ä¼ ç»ŸæœåŠ¡å™¨</th></tr></thead><tbody><tr><td align="left"><strong>å…è´¹é¢åº¦</strong></td><td align="center">â­â­â­â­â­ ä¸ªäººç”¨è¶³å¤Ÿ</td><td align="center">â­â­â­â­ é™æ€ç½‘ç«™</td><td align="center">âŒ éœ€ä»˜è´¹</td></tr><tr><td align="left"><strong>éƒ¨ç½²é€Ÿåº¦</strong></td><td align="center">â­â­â­â­â­ ç§’çº§</td><td align="center">â­â­â­ åˆ†é’Ÿçº§</td><td align="center">â­â­ éœ€æ‰‹åŠ¨</td></tr><tr><td align="left"><strong>CDNåŠ é€Ÿ</strong></td><td align="center">âœ… å…¨çƒCDN</td><td align="center">âœ… GitHub CDN</td><td align="center">âŒ éœ€è‡ªå·±é…ç½®</td></tr><tr><td align="left"><strong>è‡ªåŠ¨éƒ¨ç½²</strong></td><td align="center">âœ… Gitæ¨é€å³éƒ¨ç½²</td><td align="center">âœ… æ¨é€åˆ°gh-pages</td><td align="center">âŒ éœ€CI/CD</td></tr><tr><td align="left"><strong>ç¯å¢ƒå˜é‡</strong></td><td align="center">âœ… æ”¯æŒ</td><td align="center">âŒ ä¸æ”¯æŒ</td><td align="center">âœ… æ”¯æŒ</td></tr><tr><td align="left"><strong>è‡ªå®šä¹‰åŸŸå</strong></td><td align="center">âœ… å…è´¹SSL</td><td align="center">âœ… å…è´¹SSL</td><td align="center">âœ… éœ€è‡ªå·±é…ç½®SSL</td></tr><tr><td align="left"><strong>æ¡†æ¶æ”¯æŒ</strong></td><td align="center">â­â­â­â­â­ æ™ºèƒ½è¯†åˆ«</td><td align="center">â­â­ ä»…é™æ€</td><td align="center">â­â­â­â­ ä»»æ„</td></tr></tbody></table>
<p><strong>æœ€å¤§äº®ç‚¹:</strong></p>
<ul>
<li>âœ… <strong>é›¶é…ç½®éƒ¨ç½²</strong> - è‡ªåŠ¨è¯†åˆ«Next.jsã€Reactã€Vueç­‰æ¡†æ¶</li>
<li>âœ… <strong>å…¨çƒCDN</strong> - è®¿é—®é€Ÿåº¦é£å¿«</li>
<li>âœ… <strong>é¢„è§ˆç¯å¢ƒ</strong> - æ¯ä¸ªPRéƒ½æœ‰ç‹¬ç«‹é¢„è§ˆURL</li>
<li>âœ… <strong>å›æ»šæœºåˆ¶</strong> - ä¸€é”®å›é€€åˆ°ä»»æ„å†å²ç‰ˆæœ¬</li>
</ul>
<blockquote>
<p>ğŸ’¡ <strong>æˆ‘è¸©è¿‡çš„å‘</strong>: åˆšå¼€å§‹æˆ‘ç”¨ä¼ ç»ŸVPSéƒ¨ç½²å‰ç«¯,æ¯æ¬¡æ›´æ–°éƒ½è¦SSHç™»å½•ã€git pullã€npm buildã€é‡å¯Nginx...çƒ¦ä¸èƒœçƒ¦ã€‚æ¢åˆ°Vercelå,åªéœ€<code>git push</code>,å‰©ä¸‹çš„å…¨è‡ªåŠ¨!</p>
</blockquote>
<hr/>
<h2 data-id="heading-3">å‰ç½®å‡†å¤‡:ä½ éœ€è¦ä»€ä¹ˆ?</h2>
<p>åœ¨å¼€å§‹ä¹‹å‰,è¯·ç¡®ä¿ä½ å·²ç»å‡†å¤‡å¥½:</p>
<h3 data-id="heading-4">å¿…å¤‡æ¡ä»¶</h3>
<pre><code class="hljs language-markdown" lang="markdown">âœ… ä¸€ä¸ªGitHubè´¦å·
âœ… ä¸€ä¸ªå‰ç«¯é¡¹ç›®(React/Vue/Next.jsç­‰)
âœ… é¡¹ç›®ä»£ç å·²æ¨é€åˆ°GitHubä»“åº“
âœ… (å¯é€‰)ä¸€ä¸ªè‡ªå·±çš„åŸŸå
</code></pre>
<h3 data-id="heading-5">æ”¯æŒçš„å‰ç«¯æ¡†æ¶</h3>
<p>Vercelå¯¹ä»¥ä¸‹æ¡†æ¶æœ‰<strong>åŸç”Ÿæ”¯æŒ</strong>,å¯ä»¥é›¶é…ç½®éƒ¨ç½²:</p>
<ul>
<li><strong>Next.js</strong> - Verceläº²å„¿å­,å®Œç¾æ”¯æŒ</li>
<li><strong>React</strong> (Create React App, Vite)</li>
<li><strong>Vue</strong> (Vue CLI, Vite)</li>
<li><strong>Angular</strong></li>
<li><strong>Svelte</strong></li>
<li><strong>Nuxt.js</strong></li>
<li><strong>çº¯é™æ€HTML/CSS/JS</strong></li>
</ul>
<hr/>
<h2 data-id="heading-6">ç¬¬ä¸€æ­¥:æ³¨å†ŒVercelè´¦å·</h2>
<h3 data-id="heading-7">1.1 è®¿é—®Vercelå®˜ç½‘</h3>
<p>æ‰“å¼€æµè§ˆå™¨,è®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Fvercel.com" target="_blank" title="https://vercel.com" ref="nofollow noopener noreferrer">vercel.com</a></p>
<p><em>Vercelå®˜ç½‘é¦–é¡µ,ç‚¹å‡»å³ä¸Šè§’çš„"Sign Up"æŒ‰é’®</em></p>
<h3 data-id="heading-8">1.2 ä½¿ç”¨GitHubè´¦å·ç™»å½•</h3>
<p><strong>å¼ºçƒˆæ¨èä½¿ç”¨GitHubè´¦å·ç™»å½•</strong>,è¿™æ ·å¯ä»¥ç›´æ¥æˆæƒè®¿é—®ä½ çš„ä»“åº“,çœå»åç»­è¿æ¥çš„éº»çƒ¦ã€‚</p>
<p>ç‚¹å‡» <strong>"Continue with GitHub"</strong>:</p>
<p><em>é€‰æ‹©GitHubç™»å½•æ–¹å¼</em></p>
<h3 data-id="heading-9">1.3 æˆæƒVercelè®¿é—®GitHub</h3>
<p>é¦–æ¬¡ç™»å½•æ—¶,GitHubä¼šè¦æ±‚ä½ æˆæƒVercelè®¿é—®ä½ çš„ä»“åº“ã€‚</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">æˆæƒèŒƒå›´:</span>
âœ… è¯»å–ä»“åº“åˆ—è¡¨
âœ… è¯»å–ä»“åº“ä»£ç 
âœ… æ·»åŠ éƒ¨ç½²çŠ¶æ€(åœ¨PRä¸­æ˜¾ç¤ºéƒ¨ç½²é¢„è§ˆ)
</code></pre>
<p>ç‚¹å‡» <strong>"Authorize Vercel"</strong> å®Œæˆæˆæƒ:</p>
<p><em>æˆæƒVercelè®¿é—®ä½ çš„GitHubä»“åº“</em></p>
<blockquote>
<p>âš ï¸ <strong>éšç§è¯´æ˜</strong>: Vercelåªä¼šè¯»å–ä½ ä¸»åŠ¨å¯¼å…¥çš„ä»“åº“,ä¸ä¼šè®¿é—®å…¶ä»–ç§æœ‰ä»“åº“ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-10">ç¬¬äºŒæ­¥:å¯¼å…¥GitHubé¡¹ç›®åˆ°Vercel</h2>
<h3 data-id="heading-11">2.1 è¿›å…¥é¡¹ç›®å¯¼å…¥é¡µé¢</h3>
<p>ç™»å½•æˆåŠŸå,ä½ ä¼šçœ‹åˆ°Vercelçš„Dashboardã€‚ç‚¹å‡» <strong>"Add New..."</strong> â†’ <strong>"Project"</strong>:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4a23a19dc42d42bf913705808898ed61~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768143469&amp;x-signature=VkM1MOj44qrXPMft3wtZbOWjai4%3D" alt="vercel-add-project.png" loading="lazy"/></p>
<p><em>Dashboardé¡µé¢,ç‚¹å‡»æ·»åŠ æ–°é¡¹ç›®</em></p>
<h3 data-id="heading-12">2.2 é€‰æ‹©è¦éƒ¨ç½²çš„ä»“åº“</h3>
<p>Vercelä¼šåˆ—å‡ºä½ GitHubè´¦å·ä¸‹çš„æ‰€æœ‰ä»“åº“ã€‚æ‰¾åˆ°ä½ æƒ³éƒ¨ç½²çš„é¡¹ç›®,ç‚¹å‡» <strong>"Import"</strong>:</p>
<p><em>ä»GitHubä»“åº“åˆ—è¡¨ä¸­é€‰æ‹©é¡¹ç›®</em></p>
<p><strong>æ‰¾ä¸åˆ°ä½ çš„ä»“åº“?</strong></p>
<p>å¯èƒ½æœ‰ä»¥ä¸‹åŸå› :</p>
<pre><code class="hljs language-markdown" lang="markdown">âŒ ä»“åº“æ˜¯ç§æœ‰çš„,ä½†æœªæˆæƒVercelè®¿é—®
   â†’ è§£å†³: å»GitHub Settingsé‡æ–°æˆæƒ

âŒ ä»“åº“å±äºOrganization,éœ€è¦é¢å¤–æˆæƒ
   â†’ è§£å†³: åœ¨Organizationè®¾ç½®ä¸­æˆæƒVercel

âŒ ä»“åº“åç§°è¢«æœç´¢æ¡†è¿‡æ»¤äº†
   â†’ è§£å†³: æ¸…ç©ºæœç´¢æ¡†æˆ–æ‰‹åŠ¨è¾“å…¥ä»“åº“å
</code></pre>
<h3 data-id="heading-13">2.3 é…ç½®é¡¹ç›®è®¾ç½®</h3>
<p>å¯¼å…¥é¡¹ç›®å,ä¼šè¿›å…¥é…ç½®é¡µé¢ã€‚Vercelä¼š<strong>è‡ªåŠ¨æ£€æµ‹</strong>ä½ çš„é¡¹ç›®ç±»å‹å’Œæ„å»ºå‘½ä»¤ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/abe1ac6dacc1432b95807d6e6d4e0e5b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768143469&amp;x-signature=%2BYgoV1v9uwAsYXMz40Qbx3GEw0s%3D" alt="vercel-project-config.png" loading="lazy"/></p>
<p><em>Vercelè‡ªåŠ¨æ£€æµ‹åˆ°çš„é¡¹ç›®é…ç½®</em></p>
<h4 data-id="heading-14">æ ¸å¿ƒé…ç½®é¡¹è¯´æ˜</h4>
<p><strong>1. Project Name (é¡¹ç›®åç§°)</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">é»˜è®¤: ä½ çš„GitHubä»“åº“å</span>
<span class="hljs-section">ç”¨é€”: å†³å®šé»˜è®¤çš„vercelåŸŸå (å¦‚ my-app.vercel.app)</span>

<span class="hljs-section">å»ºè®®: ä½¿ç”¨ç®€æ´ã€æœ‰æ„ä¹‰çš„åç§°</span>
</code></pre>
<p><strong>2. Framework Preset (æ¡†æ¶é¢„è®¾)</strong></p>
<p>Vercelä¼šè‡ªåŠ¨è¯†åˆ«ä½ çš„æ¡†æ¶:</p>

























<table><thead><tr><th align="left">æ£€æµ‹åˆ°çš„æ¡†æ¶</th><th align="left">è‡ªåŠ¨é…ç½®</th></tr></thead><tbody><tr><td align="left">Next.js</td><td align="left">Build: <code>next build</code>, Output: <code>.next</code></td></tr><tr><td align="left">Create React App</td><td align="left">Build: <code>npm run build</code>, Output: <code>build</code></td></tr><tr><td align="left">Vite</td><td align="left">Build: <code>npm run build</code>, Output: <code>dist</code></td></tr><tr><td align="left">Vue CLI</td><td align="left">Build: <code>npm run build</code>, Output: <code>dist</code></td></tr></tbody></table>
<blockquote>
<p>ğŸ’¡ <strong>æ™ºèƒ½è¯†åˆ«</strong>: Vercelä¼šè¯»å–ä½ çš„<code>package.json</code>æ¥åˆ¤æ–­æ¡†æ¶ç±»å‹ã€‚</p>
</blockquote>
<p><strong>3. Root Directory (æ ¹ç›®å½•)</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">é»˜è®¤: ./</span>
<span class="hljs-section">ç”¨é€”: å¦‚æœä½ çš„å‰ç«¯ä»£ç åœ¨å­ç›®å½•(å¦‚monorepo),åœ¨è¿™é‡ŒæŒ‡å®š</span>

<span class="hljs-section">ç¤ºä¾‹:</span>
monorepo-project/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ frontend/   â† å‰ç«¯ä»£ç åœ¨è¿™é‡Œ
â”‚   â””â”€â”€ backend/
â””â”€â”€ package.json

<span class="hljs-section">é…ç½®: ./packages/frontend</span>
</code></pre>
<p><strong>4. Build Command (æ„å»ºå‘½ä»¤)</strong></p>
<p>è¿™æ˜¯æœ€é‡è¦çš„é…ç½®!Vercelä¼šæ‰§è¡Œè¿™ä¸ªå‘½ä»¤æ¥æ„å»ºä½ çš„é¡¹ç›®ã€‚</p>
<p><strong>å¸¸è§æ¡†æ¶çš„æ„å»ºå‘½ä»¤:</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Next.js</span>
next build

<span class="hljs-comment"># Create React App</span>
npm run build

<span class="hljs-comment"># Vite (React/Vue)</span>
vite build
<span class="hljs-comment"># æˆ–</span>
npm run build

<span class="hljs-comment"># Vue CLI</span>
vue-cli-service build

<span class="hljs-comment"># è‡ªå®šä¹‰è„šæœ¬</span>
npm run build:prod
</code></pre>
<p><strong>å¦‚ä½•ç¡®è®¤ä½ çš„æ„å»ºå‘½ä»¤?</strong></p>
<p>æ‰“å¼€é¡¹ç›®çš„<code>package.json</code>,æŸ¥çœ‹<code>scripts</code>å­—æ®µ:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"dev"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vite"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"build"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vite build"</span><span class="hljs-punctuation">,</span>    â† è¿™å°±æ˜¯æ„å»ºå‘½ä»¤
    <span class="hljs-attr">"preview"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vite preview"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>åœ¨Vercelé…ç½®ä¸­å¡«å†™: <code>npm run build</code></p>
<p><strong>5. Output Directory (è¾“å‡ºç›®å½•)</strong></p>
<p>æ„å»ºå®Œæˆå,é™æ€æ–‡ä»¶çš„è¾“å‡ºä½ç½®ã€‚</p>
<p><strong>å¸¸è§æ¡†æ¶çš„è¾“å‡ºç›®å½•:</strong></p>





























<table><thead><tr><th align="left">æ¡†æ¶</th><th align="left">é»˜è®¤è¾“å‡ºç›®å½•</th></tr></thead><tbody><tr><td align="left">Next.js</td><td align="left"><code>.next</code></td></tr><tr><td align="left">Create React App</td><td align="left"><code>build</code></td></tr><tr><td align="left">Vite</td><td align="left"><code>dist</code></td></tr><tr><td align="left">Vue CLI</td><td align="left"><code>dist</code></td></tr><tr><td align="left">Angular</td><td align="left"><code>dist/&lt;project-name&gt;</code></td></tr></tbody></table>
<p><strong>å¦‚ä½•ç¡®è®¤è¾“å‡ºç›®å½•?</strong></p>
<p>åœ¨æœ¬åœ°è¿è¡Œæ„å»ºå‘½ä»¤:</p>
<pre><code class="hljs language-bash" lang="bash">npm run build
</code></pre>
<p>æŸ¥çœ‹ç”Ÿæˆçš„æ–‡ä»¶å¤¹åç§°,é‚£å°±æ˜¯è¾“å‡ºç›®å½•!</p>
<p><strong>6. Install Command (å®‰è£…å‘½ä»¤)</strong></p>
<p>é»˜è®¤æƒ…å†µä¸‹,Vercelä¼šè‡ªåŠ¨æ£€æµ‹å¹¶ä½¿ç”¨:</p>
<ul>
<li><code>npm install</code> (å¦‚æœæœ‰<code>package-lock.json</code>)</li>
<li><code>yarn install</code> (å¦‚æœæœ‰<code>yarn.lock</code>)</li>
<li><code>pnpm install</code> (å¦‚æœæœ‰<code>pnpm-lock.yaml</code>)</li>
</ul>
<p>é€šå¸¸<strong>ä¸éœ€è¦ä¿®æ”¹</strong>ã€‚</p>
<h4 data-id="heading-15">ç¯å¢ƒå˜é‡é…ç½®(å¯é€‰)</h4>
<p>å¦‚æœä½ çš„é¡¹ç›®éœ€è¦ç¯å¢ƒå˜é‡(å¦‚APIå¯†é’¥ã€åç«¯åœ°å€),åœ¨è¿™é‡Œé…ç½®:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/456882abe04341e7a953ec9bb29f15c7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768143469&amp;x-signature=Z5KMnJJ7QfeKJn5CuEYFkNM2J6U%3D" alt="vercel-env-vars.png" loading="lazy"/></p>
<p><em>æ·»åŠ ç¯å¢ƒå˜é‡</em></p>
<p><strong>ç¤ºä¾‹:</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">Name: VITE_API_URL</span>
<span class="hljs-section">Value: https://api.example.com</span>

<span class="hljs-section">Name: VITE_APP_TITLE</span>
<span class="hljs-section">Value: My Awesome App</span>
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>æç¤º</strong>:</p>
<ul>
<li>Viteé¡¹ç›®çš„ç¯å¢ƒå˜é‡éœ€è¦<code>VITE_</code>å‰ç¼€</li>
<li>Create React Appé¡¹ç›®éœ€è¦<code>REACT_APP_</code>å‰ç¼€</li>
<li>Next.jsé¡¹ç›®éœ€è¦<code>NEXT_PUBLIC_</code>å‰ç¼€(å¦‚æœè¦åœ¨å®¢æˆ·ç«¯è®¿é—®)</li>
</ul>
</blockquote>
<h3 data-id="heading-16">2.4 å¼€å§‹éƒ¨ç½²</h3>
<p>é…ç½®å®Œæˆå,ç‚¹å‡»åº•éƒ¨çš„ <strong>"Deploy"</strong> æŒ‰é’®:</p>
<p><em>ç‚¹å‡»DeployæŒ‰é’®å¼€å§‹éƒ¨ç½²</em></p>
<hr/>
<h2 data-id="heading-17">ç¬¬ä¸‰æ­¥:ç­‰å¾…æ„å»ºå’Œéƒ¨ç½²</h2>
<h3 data-id="heading-18">3.1 æ„å»ºè¿‡ç¨‹å®æ—¶æ—¥å¿—</h3>
<p>ç‚¹å‡»éƒ¨ç½²å,Vercelä¼šæ˜¾ç¤ºå®æ—¶æ„å»ºæ—¥å¿—:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e37349b7fdd4f34bf561dade75c36f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768143469&amp;x-signature=lhcEVTEZVMm%2FnBfpe3ax8kQhgKE%3D" alt="vercel-build-logs.png" loading="lazy"/></p>
<p><em>å®æ—¶æ„å»ºæ—¥å¿—,å¯ä»¥çœ‹åˆ°æ¯ä¸€æ­¥çš„æ‰§è¡Œæƒ…å†µ</em></p>
<p><strong>æ„å»ºæµç¨‹:</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> Cloning repository       â† ä»GitHubå…‹éš†ä»£ç 
<span class="hljs-bullet">2.</span> Analyzing dependencies    â† åˆ†æä¾èµ–å…³ç³»
<span class="hljs-bullet">3.</span> Installing dependencies   â† å®‰è£…npmåŒ… (æœ€è€—æ—¶)
<span class="hljs-bullet">4.</span> Building application      â† æ‰§è¡Œæ„å»ºå‘½ä»¤
<span class="hljs-bullet">5.</span> Uploading build output    â† ä¸Šä¼ åˆ°CDN
<span class="hljs-bullet">6.</span> Deploying to production   â† éƒ¨ç½²å®Œæˆ!
</code></pre>
<p><strong>é¦–æ¬¡éƒ¨ç½²é€šå¸¸éœ€è¦2-5åˆ†é’Ÿ</strong>,å–å†³äºä½ çš„é¡¹ç›®å¤§å°å’Œä¾èµ–æ•°é‡ã€‚</p>
<h3 data-id="heading-19">3.2 éƒ¨ç½²æˆåŠŸ!</h3>
<p>éƒ¨ç½²æˆåŠŸæ—¶ä¼šæœ‰ä¸ªåº†ç¥ç•Œé¢,æ­å–œ,éƒ¨ç½²æˆåŠŸäº†! ğŸ‰</p>
<p><em>éƒ¨ç½²æˆåŠŸé¡µé¢,æ˜¾ç¤ºä½ çš„é¡¹ç›®URL</em></p>
<p>ä½ ä¼šå¾—åˆ°ä¸€ä¸ªé»˜è®¤åŸŸå,æ ¼å¼ä¸º:</p>
<pre><code class="hljs language-arduino" lang="arduino">https:<span class="hljs-comment">//your-project-name.vercel.app</span>
</code></pre>
<p><strong>ç«‹å³è®¿é—®æµ‹è¯•!</strong></p>
<p>ç‚¹å‡» <strong>"Visit"</strong> æŒ‰é’®,æˆ–è€…ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€è¿™ä¸ªURL,çœ‹çœ‹ä½ çš„é¡¹ç›®æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚</p>
<h3 data-id="heading-20">3.3 éƒ¨ç½²å¤±è´¥?åˆ«æ…Œ,çœ‹æ—¥å¿—!</h3>
<p>å¦‚æœéƒ¨ç½²å¤±è´¥,Vercelä¼šæ˜¾ç¤ºè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯:</p>
<p><strong>å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ:</strong></p>
<h4 data-id="heading-21">é”™è¯¯1: <code>Command "npm run build" exited with 1</code></h4>
<pre><code class="hljs language-markdown" lang="markdown">åŸå› : æ„å»ºå‘½ä»¤æ‰§è¡Œå¤±è´¥
è§£å†³:
<span class="hljs-bullet">1.</span> æ£€æŸ¥package.jsonä¸­çš„buildè„šæœ¬æ˜¯å¦æ­£ç¡®
<span class="hljs-bullet">2.</span> åœ¨æœ¬åœ°è¿è¡Œ<span class="hljs-code">`npm run build`</span>çœ‹æ˜¯å¦æœ‰é”™è¯¯
<span class="hljs-bullet">3.</span> æ£€æŸ¥æ˜¯å¦ç¼ºå°‘å¿…è¦çš„ç¯å¢ƒå˜é‡
</code></pre>
<h4 data-id="heading-22">é”™è¯¯2: <code>Error: Cannot find module 'xxx'</code></h4>
<pre><code class="hljs language-go" lang="go">åŸå› : ç¼ºå°‘ä¾èµ–åŒ…
è§£å†³:
<span class="hljs-number">1.</span> ç¡®è®¤ä¾èµ–åŒ…åœ¨<span class="hljs-keyword">package</span>.jsonçš„dependenciesä¸­(ä¸æ˜¯devDependencies)
<span class="hljs-number">2.</span> æœ¬åœ°åˆ é™¤node_modulesé‡æ–°å®‰è£…æµ‹è¯•
<span class="hljs-number">3.</span> æ£€æŸ¥<span class="hljs-keyword">package</span>-lock.jsonæ˜¯å¦æäº¤åˆ°GitHub
</code></pre>
<h4 data-id="heading-23">é”™è¯¯3: <code>Build exceeded maximum duration of 45 minutes</code></h4>
<pre><code class="hljs language-markdown" lang="markdown">åŸå› : æ„å»ºè¶…æ—¶(å…è´¹ç‰ˆé™åˆ¶45åˆ†é’Ÿ)
è§£å†³:
<span class="hljs-bullet">1.</span> ä¼˜åŒ–æ„å»ºé…ç½®,å‡å°‘ä¸å¿…è¦çš„ä¾èµ–
<span class="hljs-bullet">2.</span> ä½¿ç”¨.vercelignoreæ’é™¤ä¸éœ€è¦çš„æ–‡ä»¶
<span class="hljs-bullet">3.</span> è€ƒè™‘å‡çº§åˆ°Proç‰ˆ(300åˆ†é’Ÿé™åˆ¶)
</code></pre>
<h4 data-id="heading-24">é”™è¯¯4: <code>FATAL ERROR: Reached heap limit</code></h4>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">åŸå› : Node.jså†…å­˜ä¸è¶³</span>
<span class="hljs-section">è§£å†³:</span>
<span class="hljs-section">åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºvercel.json:</span>
{
  <span class="hljs-string">"builds"</span>: [
    {
      <span class="hljs-string">"src"</span>: <span class="hljs-string">"package.json"</span>,
      <span class="hljs-string">"use"</span>: <span class="hljs-string">"@vercel/node"</span>,
      <span class="hljs-string">"config"</span>: {
        <span class="hljs-string">"maxLambdaSize"</span>: <span class="hljs-string">"50mb"</span>
      }
    }
  ]
}
</code></pre>
<hr/>
<h2 data-id="heading-25">ç¬¬å››æ­¥:é…ç½®è‡ªåŠ¨éƒ¨ç½²</h2>
<p>éƒ¨ç½²æˆåŠŸå,æœ€é…·çš„åŠŸèƒ½æ¥äº†:<strong>è‡ªåŠ¨éƒ¨ç½²</strong>!</p>
<h3 data-id="heading-26">4.1 Gitè‡ªåŠ¨éƒ¨ç½²åŸç†</h3>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">å·¥ä½œæµç¨‹:</span>
ä½ åœ¨æœ¬åœ°ä¿®æ”¹ä»£ç 
    â†“
git commit &amp; git push
    â†“
Vercelæ£€æµ‹åˆ°GitHubä»“åº“æ›´æ–°
    â†“
è‡ªåŠ¨è§¦å‘æ–°çš„éƒ¨ç½²
    â†“
å‡ åˆ†é’Ÿåæ–°ç‰ˆæœ¬è‡ªåŠ¨ä¸Šçº¿!
</code></pre>
<p><strong>å®Œå…¨ä¸éœ€è¦æ‰‹åŠ¨æ“ä½œ!</strong></p>
<hr/>
<h2 data-id="heading-27">ç¬¬äº”æ­¥:é…ç½®è‡ªå®šä¹‰åŸŸå(è¿›é˜¶)</h2>
<p>é»˜è®¤çš„<code>vercel.app</code>åŸŸåè™½ç„¶èƒ½ç”¨,ä½†ä¸å¤Ÿä¸“ä¸šã€‚è®©æˆ‘ä»¬é…ç½®ä¸€ä¸ªè‡ªå·±çš„åŸŸå!</p>
<h3 data-id="heading-28">5.1 å‰ç½®æ¡ä»¶</h3>
<pre><code class="hljs language-scss" lang="scss">âœ… ä½ å·²ç»æ‹¥æœ‰ä¸€ä¸ªåŸŸå(å¦‚ä»è…¾è®¯äº‘ã€é˜¿é‡Œäº‘ã€GoDaddyè´­ä¹°)
âœ… èƒ½å¤Ÿè®¿é—®åŸŸåçš„DNSç®¡ç†åå°
</code></pre>
<h3 data-id="heading-29">5.2 åœ¨Vercelä¸­æ·»åŠ åŸŸå</h3>
<p>è¿›å…¥é¡¹ç›®çš„ <strong>Settings</strong> â†’ <strong>Domains</strong>:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1b770337eb645ddbf86272c12c0ded8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768143469&amp;x-signature=cPkX1x%2BGVu11DxKyhBklqhNxiX8%3D" alt="vercel-add-domain.png" loading="lazy"/></p>
<p><em>åœ¨Domainsè®¾ç½®é¡µé¢æ·»åŠ è‡ªå®šä¹‰åŸŸå</em></p>
<p>è¾“å…¥ä½ çš„åŸŸå,å¦‚ <code>blog.example.com</code>,ç„¶åç‚¹å‡» <strong>"Add"</strong>ã€‚</p>
<p>Vercelä¼šæ˜¾ç¤ºéœ€è¦é…ç½®çš„DNSè®°å½•:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55a33af601684ba397888ee09b22c1c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768143469&amp;x-signature=5QCBRkAYZtLV3Y3g7WVhLFTwMwU%3D" alt="vercel-dns-instructions.png" loading="lazy"/></p>
<p><em>Vercelæä¾›çš„DNSé…ç½®è¯´æ˜</em></p>
<p><strong>ä¸¤ç§åŸŸåç±»å‹:</strong></p>
<h4 data-id="heading-30">ç±»å‹1: æ ¹åŸŸå(Apex Domain)</h4>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">ç¤ºä¾‹: example.com</span>

<span class="hljs-section">éœ€è¦é…ç½®:</span>
<span class="hljs-section">Aè®°å½•: example.com â†’ 76.76.21.21</span>
</code></pre>
<h4 data-id="heading-31">ç±»å‹2: å­åŸŸå(Subdomain)</h4>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">ç¤ºä¾‹: blog.example.com æˆ– www.example.com</span>

<span class="hljs-section">éœ€è¦é…ç½®:</span>
<span class="hljs-section">CNAMEè®°å½•: blog â†’ cname.vercel-dns.com</span>
</code></pre>
<h3 data-id="heading-32">5.3 åœ¨è…¾è®¯äº‘DNSé…ç½®åŸŸåè§£æ</h3>
<p>æˆ‘ä»¥<strong>è…¾è®¯äº‘DNSPod</strong>ä¸ºä¾‹,æ¼”ç¤ºé…ç½®è¿‡ç¨‹ã€‚(é˜¿é‡Œäº‘ã€Cloudflareç­‰å¹³å°æ“ä½œç±»ä¼¼)</p>
<h4 data-id="heading-33">æ­¥éª¤1: ç™»å½•è…¾è®¯äº‘DNSPod</h4>
<p>è®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Fconsole.dnspod.cn" target="_blank" title="https://console.dnspod.cn" ref="nofollow noopener noreferrer">console.dnspod.cn</a>,ç™»å½•åé€‰æ‹©ä½ çš„åŸŸå:</p>
<h4 data-id="heading-34">æ­¥éª¤2: æ·»åŠ CNAMEè®°å½•</h4>
<p>ç‚¹å‡» <strong>"æ·»åŠ è®°å½•"</strong>:</p>
<p><strong>é…ç½®ç¤ºä¾‹(å­åŸŸå):</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">è®°å½•ç±»å‹: CNAME</span>
<span class="hljs-section">ä¸»æœºè®°å½•: blog    (å¦‚æœæ˜¯wwwåˆ™å¡«www)</span>
<span class="hljs-section">è®°å½•å€¼: å¤åˆ¶Vercelä¸­æ·»åŠ çš„åŸŸåä¸­çš„CNAMEå¯¹åº”çš„ValueæŒ‡</span>
<span class="hljs-section">TTL: 600 (10åˆ†é’Ÿ,å¯ä»¥é»˜è®¤)</span>
</code></pre>
<p><strong>é…ç½®ç¤ºä¾‹(æ ¹åŸŸå):</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">è®°å½•ç±»å‹: A</span>
<span class="hljs-section">ä¸»æœºè®°å½•: @      (@ è¡¨ç¤ºæ ¹åŸŸå)</span>
<span class="hljs-section">è®°å½•å€¼: 76.76.21.21  (Vercelæä¾›çš„IPåœ°å€)</span>
<span class="hljs-section">TTL: 600</span>
</code></pre>
<p>ç‚¹å‡» <strong>"ä¿å­˜"</strong>ã€‚</p>
<h4 data-id="heading-35">æ­¥éª¤3: ç­‰å¾…DNSç”Ÿæ•ˆ</h4>
<p>DNSè®°å½•é€šå¸¸éœ€è¦<strong>å‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶</strong>æ‰èƒ½å…¨çƒç”Ÿæ•ˆã€‚</p>
<p><strong>å¦‚ä½•æ£€æŸ¥DNSæ˜¯å¦ç”Ÿæ•ˆ?</strong></p>
<p>åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œ:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥CNAMEè®°å½•</span>
nslookup blog.example.com

<span class="hljs-comment"># æˆ–ä½¿ç”¨digå‘½ä»¤</span>
dig blog.example.com

<span class="hljs-comment"># åº”è¯¥çœ‹åˆ°è¿”å›:</span>
<span class="hljs-comment"># blog.example.com.   IN  CNAME   cname.vercel-dns.com.</span>
</code></pre>
<h3 data-id="heading-36">5.4 åœ¨Vercelä¸­éªŒè¯åŸŸå</h3>
<p>å›åˆ°Vercelçš„Domainsè®¾ç½®é¡µé¢,ç­‰å¾…ç³»ç»Ÿè‡ªåŠ¨éªŒè¯:</p>
<p>éªŒè¯æˆåŠŸå,ä¼šæ˜¾ç¤º:åŸŸåé…ç½®æˆåŠŸ,è‡ªåŠ¨å¯ç”¨HTTPS</p>
<p><strong>Vercelè‡ªåŠ¨æä¾›:</strong></p>
<ul>
<li>âœ… å…è´¹SSLè¯ä¹¦(Let's Encrypt)</li>
<li>âœ… è‡ªåŠ¨ç»­æœŸ</li>
<li>âœ… å¼ºåˆ¶HTTPSè·³è½¬</li>
</ul>
<h3 data-id="heading-37">5.5 æµ‹è¯•è‡ªå®šä¹‰åŸŸå</h3>
<p>åœ¨æµè§ˆå™¨ä¸­è®¿é—®ä½ çš„è‡ªå®šä¹‰åŸŸå:</p>
<pre><code class="hljs language-arduino" lang="arduino">https:<span class="hljs-comment">//blog.example.com</span>
</code></pre>
<p>æˆåŠŸ! ğŸ‰</p>
<p><strong>åŒæ—¶ä½ è¿˜ä¼šå‘ç°:</strong></p>
<ul>
<li>é»˜è®¤åŸŸå<code>your-app.vercel.app</code>ä»ç„¶å¯ç”¨</li>
<li>HTTPè‡ªåŠ¨è·³è½¬åˆ°HTTPS</li>
<li>åŠ è½½é€Ÿåº¦é£å¿«(å…¨çƒCDNåŠ é€Ÿ)</li>
</ul>
<hr/>
<h2 data-id="heading-38">ç¬¬å…­æ­¥:é¡¹ç›®ç®¡ç†å’Œè¿ç»´</h2>
<h3 data-id="heading-39">6.1 æŸ¥çœ‹éƒ¨ç½²å†å²</h3>
<p>åœ¨é¡¹ç›®çš„ <strong>Deployments</strong> é¡µé¢,å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„éƒ¨ç½²è®°å½•:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4dce930d3724ef99e59ff48ee76dcd4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768143469&amp;x-signature=VztBrkgkjuiraF6ZfaL8HllEqL8%3D" alt="vercel-deployments.png" loading="lazy"/></p>
<p><em>æ‰€æœ‰å†å²éƒ¨ç½²è®°å½•</em></p>
<p>æ¯ä¸ªéƒ¨ç½²éƒ½æœ‰:</p>
<ul>
<li>å”¯ä¸€çš„URL</li>
<li>éƒ¨ç½²æ—¶é—´</li>
<li>Git commitä¿¡æ¯</li>
<li>æ„å»ºæ—¥å¿—</li>
<li>è®¿é—®ç»Ÿè®¡</li>
</ul>
<h3 data-id="heading-40">6.2 ä¸€é”®å›æ»š</h3>
<p>å¦‚æœæ–°ç‰ˆæœ¬æœ‰é—®é¢˜,å¯ä»¥ç¬é—´å›é€€åˆ°ä»»æ„å†å²ç‰ˆæœ¬:</p>
<p><strong>å›æ»šæµç¨‹:</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> æ‰¾åˆ°ä½ æƒ³å›é€€åˆ°çš„ç‰ˆæœ¬
<span class="hljs-bullet">2.</span> ç‚¹å‡»å³ä¾§çš„ â‹¯ æŒ‰é’®
<span class="hljs-bullet">3.</span> é€‰æ‹©"Promote to Production"
<span class="hljs-bullet">4.</span> å‡ ç§’é’Ÿå,æ—§ç‰ˆæœ¬é‡æ–°ä¸Šçº¿!
</code></pre>
<h3 data-id="heading-41">6.3 è®¿é—®ç»Ÿè®¡</h3>
<p>åœ¨ <strong>Analytics</strong> é¡µé¢æŸ¥çœ‹è®¿é—®æ•°æ®:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/08c0b151a6ae447da1935e53aabb6c81~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768143469&amp;x-signature=mxbgs9VYeN5ZzAsmTV%2FFF0Wu3lw%3D" alt="vercel-analytics.png" loading="lazy"/></p>
<p><em>Vercel Analyticsæä¾›å®æ—¶è®¿é—®æ•°æ®</em></p>
<p><strong>å…è´¹ç‰ˆæ•°æ®:</strong></p>
<ul>
<li>è®¿é—®é‡(PV/UV)</li>
<li>åœ°ç†åˆ†å¸ƒ</li>
<li>è®¾å¤‡ç±»å‹</li>
<li>æµè§ˆå™¨ç±»å‹</li>
</ul>
<hr/>
<h2 data-id="heading-42">å¸¸è§é—®é¢˜æ’æŸ¥</h2>
<h3 data-id="heading-43">Q1: éƒ¨ç½²æˆåŠŸä½†é¡µé¢404</h3>
<p><strong>é—®é¢˜ç°è±¡:</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">è®¿é—®é¦–é¡µ: https:<span class="hljs-comment">//my-app.vercel.app  âœ… æ­£å¸¸</span>
è®¿é—®å­é¡µé¢: https:<span class="hljs-comment">//my-app.vercel.app/about  âŒ 404</span>
</code></pre>
<p><strong>åŸå› :</strong> å‰ç«¯è·¯ç”±(React Router/Vue Router)éœ€è¦æœåŠ¡å™¨é…ç½®æ”¯æŒã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ:</strong></p>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º<code>vercel.json</code>:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"rewrites"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"source"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/(.*)"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"destination"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/index.html"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>è¿™ä¼šå°†æ‰€æœ‰è¯·æ±‚é‡å®šå‘åˆ°<code>index.html</code>,è®©å‰ç«¯è·¯ç”±æ¥ç®¡ã€‚</p>
<h3 data-id="heading-44">Q2: é™æ€èµ„æºåŠ è½½å¤±è´¥(404)</h3>
<p><strong>é—®é¢˜ç°è±¡:</strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-built_in">Console</span>é”™è¯¯:
GET https:<span class="hljs-comment">//my-app.vercel.app/assets/logo.png 404</span>
</code></pre>
<p><strong>åŸå› :</strong> é™æ€èµ„æºè·¯å¾„é…ç½®é”™è¯¯ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ:</strong></p>
<p><strong>Viteé¡¹ç›®:</strong></p>
<p>ä¿®æ”¹<code>vite.config.js</code>:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">base</span>: <span class="hljs-string">'/'</span>,  <span class="hljs-comment">// ç¡®ä¿baseæ˜¯ '/' è€Œä¸æ˜¯ç›¸å¯¹è·¯å¾„</span>
  <span class="hljs-attr">build</span>: {
    <span class="hljs-attr">outDir</span>: <span class="hljs-string">'dist'</span>,
  }
}
</code></pre>
<p><strong>Create React App:</strong></p>
<p>ä¿®æ”¹<code>package.json</code>:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"homepage"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://my-app.vercel.app"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-45">Q3: ç¯å¢ƒå˜é‡æœªç”Ÿæ•ˆ</h3>
<p><strong>é—®é¢˜ç°è±¡:</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">VITE_API_URL</span>)
<span class="hljs-comment">// è¾“å‡º: undefined</span>
</code></pre>
<p><strong>æ’æŸ¥æ¸…å•:</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">âŒ</span> <span class="hljs-string">ç¯å¢ƒå˜é‡åç§°é”™è¯¯(ç¼ºå°‘å‰ç¼€)</span>
   <span class="hljs-string">â†’</span> <span class="hljs-attr">Vite:</span> <span class="hljs-string">å¿…é¡»ä»¥VITE_å¼€å¤´</span>
   <span class="hljs-string">â†’</span> <span class="hljs-attr">CRA:</span> <span class="hljs-string">å¿…é¡»ä»¥REACT_APP_å¼€å¤´</span>
   <span class="hljs-string">â†’</span> <span class="hljs-attr">Next.js:</span> <span class="hljs-string">å¿…é¡»ä»¥NEXT_PUBLIC_å¼€å¤´(å®¢æˆ·ç«¯ä½¿ç”¨)</span>

<span class="hljs-string">âŒ</span> <span class="hljs-string">ç¯å¢ƒå˜é‡æœªåœ¨Vercelä¸­é…ç½®</span>
   <span class="hljs-string">â†’</span> <span class="hljs-string">è¿›å…¥Settings</span> <span class="hljs-string">â†’</span> <span class="hljs-string">Environment</span> <span class="hljs-string">Variablesæ·»åŠ </span>

<span class="hljs-string">âŒ</span> <span class="hljs-string">é…ç½®åæœªé‡æ–°éƒ¨ç½²</span>
   <span class="hljs-string">â†’</span> <span class="hljs-string">ä¿®æ”¹ç¯å¢ƒå˜é‡åéœ€è¦è§¦å‘æ–°éƒ¨ç½²æ‰èƒ½ç”Ÿæ•ˆ</span>
</code></pre>
<h3 data-id="heading-46">Q4: æ„å»ºæ—¶é—´è¿‡é•¿</h3>
<p><strong>ä¼˜åŒ–ç­–ç•¥:</strong></p>
<p><strong>1. ä½¿ç”¨.vercelignoreæ’é™¤ä¸å¿…è¦æ–‡ä»¶</strong></p>
<p>åˆ›å»º<code>.vercelignore</code>:</p>
<pre><code class="hljs">.git
*.md
.vscode
.idea
tests
docs
</code></pre>
<p><strong>2. å¯ç”¨ä¾èµ–ç¼“å­˜</strong></p>
<p>Vercelé»˜è®¤ä¼šç¼“å­˜<code>node_modules</code>,ä½†å¯ä»¥ä¼˜åŒ–:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// vercel.json</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"github"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"silent"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"build"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"env"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"NODE_OPTIONS"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"--max_old_space_size=4096"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>3. å¹¶è¡Œæ„å»º</strong></p>
<p>å¦‚æœæ˜¯monorepo,å¯ä»¥é…ç½®å¹¶è¡Œæ„å»º:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"builds"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span> <span class="hljs-attr">"src"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"package.json"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"use"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"@vercel/static-build"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"config"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"parallel"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span> <span class="hljs-punctuation">}</span> <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-47">Q5: è‡ªå®šä¹‰åŸŸåHTTPSè¯ä¹¦é”™è¯¯</h3>
<p><strong>é—®é¢˜ç°è±¡:</strong></p>
<p>æµè§ˆå™¨æ˜¾ç¤º"æ‚¨çš„è¿æ¥ä¸æ˜¯ç§å¯†è¿æ¥"ã€‚</p>
<p><strong>è§£å†³æ­¥éª¤:</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> æ£€æŸ¥DNSæ˜¯å¦ç”Ÿæ•ˆ (nslookup your-domain.com)
<span class="hljs-bullet">2.</span> åœ¨Vercelä¸­åˆ é™¤åŸŸå,é‡æ–°æ·»åŠ 
<span class="hljs-bullet">3.</span> ç­‰å¾…å‡ åˆ†é’Ÿè®©Let's Encrypté‡æ–°ç­¾å‘è¯ä¹¦
<span class="hljs-bullet">4.</span> æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å’ŒSSLçŠ¶æ€
</code></pre>
<hr/>
<h2 data-id="heading-48">è¿›é˜¶æŠ€å·§</h2>
<h3 data-id="heading-49">æŠ€å·§1: ä½¿ç”¨Vercel CLIæœ¬åœ°å¼€å‘</h3>
<p>å®‰è£…Vercel CLI:</p>
<pre><code class="hljs language-bash" lang="bash">npm i -g vercel
</code></pre>
<p><strong>åœ¨æœ¬åœ°æ¨¡æ‹ŸVercelç¯å¢ƒ:</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é“¾æ¥åˆ°Vercelé¡¹ç›®</span>
vercel <span class="hljs-built_in">link</span>

<span class="hljs-comment"># ä¸‹è½½ç¯å¢ƒå˜é‡</span>
vercel <span class="hljs-built_in">env</span> pull

<span class="hljs-comment"># æœ¬åœ°è¿è¡Œ(ä½¿ç”¨ç”Ÿäº§ç¯å¢ƒé…ç½®)</span>
vercel dev
</code></pre>
<p><strong>ä¼˜åŠ¿:</strong></p>
<pre><code class="hljs language-bash" lang="bash">âœ… æœ¬åœ°ä½¿ç”¨Vercelçš„ç¯å¢ƒå˜é‡
âœ… æ¨¡æ‹ŸVercelçš„Serverless Functions
âœ… æµ‹è¯•rewrite/redirectè§„åˆ™
</code></pre>
<h3 data-id="heading-50">æŠ€å·§2: é…ç½®å¤šåŸŸå</h3>
<p>ä¸€ä¸ªé¡¹ç›®å¯ä»¥ç»‘å®šå¤šä¸ªåŸŸå:</p>
<pre><code class="hljs">example.com          â†’ ä¸»åŸŸå
www.example.com      â†’ è‡ªåŠ¨è·³è½¬åˆ°ä¸»åŸŸå
blog.example.com     â†’ ç‹¬ç«‹è®¿é—®
</code></pre>
<p>åœ¨Vercel Domainsè®¾ç½®ä¸­æ·»åŠ å¤šä¸ªåŸŸåå³å¯ã€‚</p>
<h3 data-id="heading-51">æŠ€å·§3: è‡ªå®šä¹‰æ„å»ºç¼“å­˜</h3>
<p>ä¼˜åŒ–æ„å»ºé€Ÿåº¦:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// vercel.json</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"build"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"env"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"ENABLE_EXPERIMENTAL_COREPACK"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"NEXT_PRIVATE_CACHE_HANDLER"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"crons"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/api/clear-cache"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"schedule"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0 0 * * *"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-52">æŠ€å·§4: é…ç½®Redirectè§„åˆ™</h3>
<p>SEOä¼˜åŒ–å’ŒURLç®¡ç†:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"redirects"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"source"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/old-blog/:slug"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"destination"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/blog/:slug"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"permanent"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"source"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/docs"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"destination"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/documentation"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"permanent"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-53">æŠ€å·§5: é…ç½®HTTP Headers</h3>
<p>å®‰å…¨å’Œæ€§èƒ½ä¼˜åŒ–:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"headers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"source"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/(.*)"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"headers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"key"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"X-Frame-Options"</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"DENY"</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"key"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"X-Content-Type-Options"</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"nosniff"</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"key"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Cache-Control"</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"public, max-age=31536000, immutable"</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h2 data-id="heading-54">æˆæœ¬å’Œé™åˆ¶</h2>
<h3 data-id="heading-55">Hobby(å…è´¹)è®¡åˆ’</h3>
<pre><code class="hljs language-javascript" lang="javascript">âœ… æ— é™é¡¹ç›®
âœ… æ— é™éƒ¨ç½²
âœ… 100GBå¸¦å®½/æœˆ
âœ… <span class="hljs-number">1000</span>æ¬¡<span class="hljs-title class_">Serverless</span> <span class="hljs-title class_">Function</span>è°ƒç”¨/å¤©
âœ… è‡ªåŠ¨<span class="hljs-variable constant_">SSL</span>è¯ä¹¦
âœ… å…¨çƒ<span class="hljs-variable constant_">CDN</span>

âŒ å›¢é˜Ÿåä½œ(ä»…é™ä¸ªäºº)
âŒ å•†ä¸šä½¿ç”¨
</code></pre>
<h3 data-id="heading-56">Proè®¡åˆ’($20/æœˆ)</h3>
<pre><code class="hljs language-diff" lang="diff"><span class="hljs-addition">+ Hobbyæ‰€æœ‰åŠŸèƒ½</span>
<span class="hljs-addition">+ 1TBå¸¦å®½/æœˆ</span>
<span class="hljs-addition">+ æ— é™Serverlessè°ƒç”¨</span>
<span class="hljs-addition">+ å›¢é˜Ÿåä½œ(æ— é™æˆå‘˜)</span>
<span class="hljs-addition">+ ä¼˜å…ˆçº§æ”¯æŒ</span>
<span class="hljs-addition">+ å¯†ç ä¿æŠ¤</span>
<span class="hljs-addition">+ åˆ†æå’Œæ—¥å¿—ä¿ç•™æ›´é•¿</span>
</code></pre>
<p><strong>ä»€ä¹ˆæ—¶å€™éœ€è¦å‡çº§Pro?</strong></p>
<pre><code class="hljs">âœ… æœˆè®¿é—®é‡è¶…è¿‡100GBå¸¦å®½
âœ… éœ€è¦å›¢é˜Ÿåä½œå¼€å‘
âœ… éœ€è¦å¯†ç ä¿æŠ¤é¢„è§ˆç¯å¢ƒ
âœ… éœ€è¦æ›´è¯¦ç»†çš„è®¿é—®åˆ†æ
</code></pre>
<p>å¯¹äºä¸ªäººé¡¹ç›®å’Œå°å‹ç½‘ç«™,<strong>å…è´¹è®¡åˆ’å®Œå…¨å¤Ÿç”¨</strong>!</p>
<hr/>
<h2 data-id="heading-57">æ€»ç»“:Verceléƒ¨ç½²æ£€æŸ¥æ¸…å•</h2>
<h3 data-id="heading-58">éƒ¨ç½²å‰æ£€æŸ¥</h3>
<pre><code class="hljs language-markdown" lang="markdown">âœ… ä»£ç å·²æ¨é€åˆ°GitHub
âœ… package.jsonä¸­çš„dependenciesæ­£ç¡®
âœ… æœ¬åœ°æ‰§è¡Œnpm run buildæˆåŠŸ
âœ… æ„å»ºäº§ç‰©åœ¨æ­£ç¡®çš„è¾“å‡ºç›®å½•
âœ… ç¯å¢ƒå˜é‡æ•´ç†å®Œæ¯•
âœ… .gitignoreåŒ…å«node<span class="hljs-emphasis">_moduleså’Œæ„å»ºäº§ç‰©
</span></code></pre>
<h3 data-id="heading-59">éƒ¨ç½²é…ç½®æ£€æŸ¥</h3>
<pre><code class="hljs language-markdown" lang="markdown">âœ… Framework Presetæ­£ç¡®è¯†åˆ«
âœ… Build Commandé…ç½®æ­£ç¡®
âœ… Output Directoryé…ç½®æ­£ç¡®
âœ… Root Directoryé…ç½®æ­£ç¡®(å¦‚æœä¸æ˜¯æ ¹ç›®å½•)
âœ… Environment Variablesæ·»åŠ å®Œæ•´
</code></pre>
<h3 data-id="heading-60">éƒ¨ç½²åæ£€æŸ¥</h3>
<pre><code class="hljs language-markdown" lang="markdown">âœ… é¦–é¡µèƒ½æ­£å¸¸è®¿é—®
âœ… å‰ç«¯è·¯ç”±è·³è½¬æ­£å¸¸(å¤šé¡µåº”ç”¨)
âœ… é™æ€èµ„æºåŠ è½½æ­£å¸¸
âœ… APIè¯·æ±‚æ­£å¸¸(å¦‚æœæœ‰åç«¯)
âœ… ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ
âœ… ç§»åŠ¨ç«¯å“åº”å¼æ­£å¸¸
</code></pre>
<h3 data-id="heading-61">è‡ªå®šä¹‰åŸŸåæ£€æŸ¥</h3>
<pre><code class="hljs language-markdown" lang="markdown">âœ… DNSè®°å½•é…ç½®æ­£ç¡®
âœ… DNSå·²ç”Ÿæ•ˆ(nslookupæ£€æŸ¥)
âœ… Vercelä¸­åŸŸåéªŒè¯æˆåŠŸ
âœ… HTTPSè¯ä¹¦è‡ªåŠ¨ç­¾å‘
âœ… HTTPè‡ªåŠ¨è·³è½¬HTTPS
âœ… wwwå’Œéwwwéƒ½èƒ½è®¿é—®(å¦‚æœéœ€è¦)
</code></pre>
<hr/>
<h2 data-id="heading-62">ä¸‹ä¸€æ­¥è¡ŒåŠ¨</h2>
<p><strong>ä»Šå¤©å°±å¼€å§‹:</strong></p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ³¨å†ŒVercelè´¦å·</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> é€‰æ‹©ä¸€ä¸ªé¡¹ç›®è¿›è¡Œéƒ¨ç½²</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> é…ç½®è‡ªåŠ¨éƒ¨ç½²</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> (å¯é€‰)ç»‘å®šè‡ªå®šä¹‰åŸŸå</li>
</ul>
<p><strong>æœ¬å‘¨ä»»åŠ¡:</strong></p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> å°†æ‰€æœ‰å‰ç«¯é¡¹ç›®è¿ç§»åˆ°Vercel</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> é…ç½®PRé¢„è§ˆç¯å¢ƒ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> ä¼˜åŒ–æ„å»ºé…ç½®</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> è®¾ç½®æ€§èƒ½ç›‘æ§</li>
</ul>
<p><strong>é•¿æœŸä¼˜åŒ–:</strong></p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> ä½¿ç”¨Vercel Analyticsåˆ†æç”¨æˆ·è¡Œä¸º</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ ¹æ®Web Vitalsä¼˜åŒ–æ€§èƒ½</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ¢ç´¢Serverless Functions(Vercelçš„åç«¯èƒ½åŠ›)</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> å­¦ä¹ Vercelçš„Edge Functions(è¾¹ç¼˜è®¡ç®—)</li>
</ul>
<hr/>
<h2 data-id="heading-63">ç›¸å…³èµ„æº</h2>
<p><strong>å®˜æ–¹æ–‡æ¡£:</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fvercel.com%2Fdocs" target="_blank" title="https://vercel.com/docs" ref="nofollow noopener noreferrer">Vercelå®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fvercel.com%2Fdocs%2Fcli" target="_blank" title="https://vercel.com/docs/cli" ref="nofollow noopener noreferrer">Vercel CLIæ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fvercel.com%2Fdocs%2Fbuild-step" target="_blank" title="https://vercel.com/docs/build-step" ref="nofollow noopener noreferrer">éƒ¨ç½²é…ç½®æŒ‡å—</a></li>
</ul>
<p><strong>ç¤¾åŒºèµ„æº:</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvercel%2Fvercel" target="_blank" title="https://github.com/vercel/vercel" ref="nofollow noopener noreferrer">Vercel GitHub</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fvercel.com%2Fdiscord" target="_blank" title="https://vercel.com/discord" ref="nofollow noopener noreferrer">Vercel Discordç¤¾åŒº</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fvercel.com%2Ftemplates" target="_blank" title="https://vercel.com/templates" ref="nofollow noopener noreferrer">Vercelæ¨¡æ¿åº“</a></li>
</ul>
<p><strong>å¯¹æ¯”å‚è€ƒ:</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fvercel.com%2Fblog%2Fvercel-vs-netlify" target="_blank" title="https://vercel.com/blog/vercel-vs-netlify" ref="nofollow noopener noreferrer">Vercel vs Netlify</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fvercel.com%2Fguides%2Fdeploying-react-with-vercel-and-github-pages" target="_blank" title="https://vercel.com/guides/deploying-react-with-vercel-and-github-pages" ref="nofollow noopener noreferrer">Vercel vs GitHub Pages</a></li>
</ul>
<hr/>
<p>ä»ä»Šå¤©å¼€å§‹,è®©ä½ çš„å‰ç«¯é¡¹ç›®èµ°å‡ºæœ¬åœ°,é¢å‘ä¸–ç•Œ!è®°ä½:<strong>éƒ¨ç½²ä¸æ˜¯ç»“æŸ,è€Œæ˜¯ä½ çš„é¡¹ç›®çœŸæ­£å¼€å§‹è¢«ä½¿ç”¨çš„èµ·ç‚¹</strong>ã€‚</p>
<p>ç°åœ¨å°±è¡ŒåŠ¨,10åˆ†é’Ÿå,ä½ çš„ä½œå“å°†æ‹¥æœ‰ä¸€ä¸ªå…¨çƒå¯è®¿é—®çš„URL! ğŸš€</p>
<hr/>
<p><em>è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©å—?åˆ†äº«ä½ çš„Verceléƒ¨ç½²ç»éªŒ,æˆ–è€…åœ¨è¯„è®ºåŒºæé—®!</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ComposeåŸç†ä¸€ä¹‹å¿«ç…§ç³»ç»Ÿ]]></title>    <link>https://juejin.cn/post/7591360623469215754</link>    <guid>https://juejin.cn/post/7591360623469215754</guid>    <pubDate>2026-01-04T11:39:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591360623469215754" data-draft-id="7591346773827354650" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ComposeåŸç†ä¸€ä¹‹å¿«ç…§ç³»ç»Ÿ"/> <meta itemprop="keywords" content="æ¶æ„,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-04T11:39:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è£´äº‘é£"/> <meta itemprop="url" content="https://juejin.cn/user/3734361144570285"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ComposeåŸç†ä¸€ä¹‹å¿«ç…§ç³»ç»Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3734361144570285/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è£´äº‘é£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T11:39:09.000Z" title="Sun Jan 04 2026 11:39:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Composeçš„å¿«ç…§ç³»ç»ŸåŸºäº <strong>MVCC (å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶)</strong> æ€æƒ³ï¼Œç±»ä¼¼äºæ•°æ®åº“äº‹åŠ¡ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">StateObject (mutableStateOf(0))
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Record <span class="hljs-attr">id</span>=<span class="hljs-number">7</span>  â”‚â”€â”€â”€â–ºâ”‚ Record id=<span class="hljs-number">5</span>  â”‚â”€â”€â”€â–ºâ”‚ Record id=<span class="hljs-number">1</span>  â”‚
â”‚ <span class="hljs-attr">value</span>=<span class="hljs-number">100</span>    â”‚    â”‚ value=<span class="hljs-number">50</span>     â”‚    â”‚ value=<span class="hljs-number">0</span>      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     (æœ€æ–°)                                  (åˆå§‹)
</code></pre>
<p>ç›®æ ‡æ˜¯ä¿è¯ï¼š</p>
<ul>
<li><strong>éš”ç¦»æ€§</strong>: ä¸åŒå¿«ç…§çš„ä¿®æ”¹ç›¸äº’éš”ç¦»</li>
<li><strong>åŸå­æ€§</strong>: å¿«ç…§åº”ç”¨æ˜¯åŸå­æ“ä½œ</li>
<li><strong>å¯è§‚å¯Ÿæ€§</strong>: æ”¯æŒçŠ¶æ€è¯»å†™è¿½è¸ª</li>
</ul>
<h2 data-id="heading-0">ç¤ºä¾‹ä»£ç </h2>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {
    <span class="hljs-keyword">var</span> name: MutableState&lt;String&gt; = mutableStateOf(<span class="hljs-string">""</span>)
}

<span class="hljs-keyword">val</span> person = Person()
person.name.value = <span class="hljs-string">"ä»¤ç‹å†²"</span>
<span class="hljs-keyword">val</span> snapshot = Snapshot.takeSnapshot()
person.name.value = <span class="hljs-string">"ä»»ç›ˆç›ˆ"</span>

println(<span class="hljs-string">"ç¬¬ä¸€æ¬¡æ‰“å°ï¼š<span class="hljs-subst">${person.name.value}</span>"</span>)  <span class="hljs-comment">// è¾“å‡º: ä»»ç›ˆç›ˆ</span>
snapshot.enter {
    println(<span class="hljs-string">"ç¬¬äºŒæ¬¡æ‰“å°ï¼š<span class="hljs-subst">${person.name.value}</span>"</span>)  <span class="hljs-comment">// è¾“å‡º: ä»¤ç‹å†²</span>
}
println(<span class="hljs-string">"ç¬¬ä¸‰æ¬¡æ‰“å°ï¼š<span class="hljs-subst">${person.name.value}</span>"</span>)  <span class="hljs-comment">// è¾“å‡º: ä»»ç›ˆç›ˆ</span>
</code></pre>
<p>ç¬¬äºŒæ¬¡æ‰“å°è¾“å‡ºä»¤ç‹å†²ï¼Œè¯´æ˜å¿«ç…§ä¿å­˜ä¹‹å‰çš„çŠ¶æ€ï¼Œå¿«ç…§æ˜¯å¦‚ä½•ä¿å­˜ä¹‹å‰çš„çŠ¶æ€ï¼Ÿç¬¬ä¸‰æ¬¡æ‰“å°ä»»ç›ˆç›ˆï¼Œè¯´æ˜enteræ–¹æ³•æ‰§è¡Œå®Œæˆåï¼Œåˆæ¢å¤æˆæœ€æ–°çŠ¶æ€äº†ï¼Œè¿™åˆæ˜¯ä¸ºä½•ï¼Ÿä¸‹é¢å°†ä¸€æ­¥ä¸€æ­¥çš„è§£æç¤ºä¾‹ä¸­çš„æ¯ä¸€è¡Œä»£ç ã€‚</p>
<h2 data-id="heading-1">ç¬¬ä¸€æ­¥ï¼šåˆ›å»º MutableState (mutableStateOf(""))</h2>
<p>å½“æ‰§è¡Œ <code>mutableStateOf("")</code> æ—¶ï¼š</p>
<h3 data-id="heading-2">æºç ä½ç½®ï¼šSnapshotState.kt</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">mutableStateOf</span><span class="hljs-params">(
    value: <span class="hljs-type">T</span>,
    policy: <span class="hljs-type">SnapshotMutationPolicy</span>&lt;<span class="hljs-type">T</span>&gt; = structuralEqualityPolicy()</span></span>,
): MutableState&lt;T&gt; = createSnapshotMutableState(value, policy)
</code></pre>
<h3 data-id="heading-3">æºç ä½ç½®ï¼šSnapshotState.kt</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SnapshotMutableStateImpl</span>&lt;<span class="hljs-type">T</span>&gt;(
    value: T,
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> policy: SnapshotMutationPolicy&lt;T&gt;,
) : StateObjectImpl(), SnapshotMutableState&lt;T&gt; {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> next: StateStateRecord&lt;T&gt; =
        currentSnapshot().let { snapshot -&gt;
            StateStateRecord(snapshot.snapshotId, value).also {
                <span class="hljs-keyword">if</span> (snapshot !<span class="hljs-keyword">is</span> GlobalSnapshot) {
                    it.next = StateStateRecord(Snapshot.PreexistingSnapshotId.toSnapshotId(), value)
                }
            }
        }
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<h3 data-id="heading-4">å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h3>
<ol>
<li><strong>è·å–å½“å‰å¿«ç…§</strong>: <code>currentSnapshot()</code> è¿”å› GlobalSnapshotï¼ˆå‡è®¾ id=1ï¼‰</li>
<li><strong>åˆ›å»º StateRecord</strong>: åˆ›å»º <code>StateStateRecord(snapshotId=1, value="")</code></li>
<li><strong>å†…å­˜ç»“æ„</strong>:</li>
</ol>
<pre><code class="hljs language-ini" lang="ini">person.name (SnapshotMutableStateImpl)
    â”‚
    â””â”€â”€ next â”€â”€â–º StateStateRecord
                   â”œâ”€â”€ <span class="hljs-attr">snapshotId</span> = <span class="hljs-number">1</span>
                   â”œâ”€â”€ <span class="hljs-attr">value</span> = <span class="hljs-string">""</span>
                   â””â”€â”€ <span class="hljs-attr">next</span> = null
</code></pre>
<hr/>
<h2 data-id="heading-5">ç¬¬äºŒæ­¥ï¼šç¬¬ä¸€æ¬¡èµ‹å€¼ (person.name.value = "ä»¤ç‹å†²")</h2>
<h3 data-id="heading-6">æºç ä½ç½®ï¼šSnapshotState.kt</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">override</span> <span class="hljs-keyword">var</span> value: T
    <span class="hljs-keyword">get</span>() = next.readable(<span class="hljs-keyword">this</span>).value
    <span class="hljs-keyword">set</span>(value) =
        next.withCurrent {
            <span class="hljs-keyword">if</span> (!policy.equivalent(it.value, value)) {
                next.overwritable(<span class="hljs-keyword">this</span>, it) { <span class="hljs-keyword">this</span>.value = value }
            }
        }
</code></pre>
<p>å½“ <code>value = "ä»¤ç‹å†²"</code> æ—¶ï¼š</p>
<ol>
<li><strong>è°ƒç”¨ <code>withCurrent</code></strong>: æ‰¾åˆ°å½“å‰å¯è¯»çš„è®°å½•</li>
<li><strong>æ£€æŸ¥ç­‰ä»·æ€§</strong>: <code>policy.equivalent("", "ä»¤ç‹å†²")</code> è¿”å› <code>false</code></li>
<li><strong>è°ƒç”¨ <code>overwritable</code></strong></li>
</ol>
<h3 data-id="heading-7">æºç ä½ç½®ï¼šSnapshot.kt</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : StateRecord, R&gt;</span> T.<span class="hljs-title">overwritable</span><span class="hljs-params">(
    state: <span class="hljs-type">StateObject</span>,
    candidate: <span class="hljs-type">T</span>,
    block: <span class="hljs-type">T</span>.() -&gt; <span class="hljs-type">R</span>,
)</span></span>: R {
    <span class="hljs-keyword">val</span> snapshot: Snapshot
    <span class="hljs-keyword">return</span> sync {
            snapshot = Snapshot.current  <span class="hljs-comment">// GlobalSnapshot (id=1)</span>
            <span class="hljs-keyword">this</span>.overwritableRecord(state, snapshot, candidate).block()
        }
        .also { notifyWrite(snapshot, state) }
}
</code></pre>
<h3 data-id="heading-8">æºç ä½ç½®ï¼šSnapshot.kt</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : StateRecord&gt;</span> T.<span class="hljs-title">overwritableRecord</span><span class="hljs-params">(
    state: <span class="hljs-type">StateObject</span>,
    snapshot: <span class="hljs-type">Snapshot</span>,
    candidate: <span class="hljs-type">T</span>,
)</span></span>: T {
    <span class="hljs-keyword">val</span> id = snapshot.snapshotId  <span class="hljs-comment">// id=1</span>

    <span class="hljs-comment">// å¦‚æœ candidate å·²ç»æ˜¯å½“å‰å¿«ç…§åˆ›å»ºçš„ï¼Œç›´æ¥è¿”å›</span>
    <span class="hljs-keyword">if</span> (candidate.snapshotId == id) <span class="hljs-keyword">return</span> candidate

    <span class="hljs-comment">// å¦åˆ™åˆ›å»ºæ–°è®°å½•</span>
    <span class="hljs-keyword">val</span> newData = sync { newOverwritableRecordLocked(state) }
    newData.snapshotId = id
    <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">return</span> newData
}
</code></pre>
<h3 data-id="heading-9">å…³é”®ç‚¹</h3>
<p>å› ä¸º <code>candidate.snapshotId == 1</code> ç­‰äº <code>snapshot.snapshotId == 1</code>ï¼Œ<strong>ç›´æ¥ä¿®æ”¹ç°æœ‰è®°å½•</strong>ï¼</p>
<h3 data-id="heading-10">æ‰§è¡Œåçš„å†…å­˜ç»“æ„</h3>
<pre><code class="hljs language-ini" lang="ini">person.name (SnapshotMutableStateImpl)
    â”‚
    â””â”€â”€ next â”€â”€â–º StateStateRecord
                   â”œâ”€â”€ <span class="hljs-attr">snapshotId</span> = <span class="hljs-number">1</span>
                   â”œâ”€â”€ <span class="hljs-attr">value</span> = <span class="hljs-string">"ä»¤ç‹å†²"</span>  â† è¢«è¦†ç›–
                   â””â”€â”€ <span class="hljs-attr">next</span> = null
</code></pre>
<hr/>
<h2 data-id="heading-11">ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºå¿«ç…§ (Snapshot.takeSnapshot())</h2>
<h3 data-id="heading-12">æºç ä½ç½®ï¼šSnapshot.kt</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">takeSnapshot</span><span class="hljs-params">(readObserver: ((<span class="hljs-type">Any</span>) -&gt; <span class="hljs-type">Unit</span>)? = <span class="hljs-literal">null</span>)</span></span>: Snapshot =
    currentSnapshot().takeNestedSnapshot(readObserver)
</code></pre>
<p>è°ƒç”¨ <code>GlobalSnapshot.takeNestedSnapshot()</code>ï¼š</p>
<h3 data-id="heading-13">æºç ä½ç½®ï¼šSnapshot.kt</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">takeNestedSnapshot</span><span class="hljs-params">(readObserver: ((<span class="hljs-type">Any</span>) -&gt; <span class="hljs-type">Unit</span>)?)</span></span>: Snapshot =
    creatingSnapshot(...) { actualReadObserver, _ -&gt;
        takeNewSnapshot { invalid -&gt;
            ReadonlySnapshot(
                snapshotId = sync { nextSnapshotId.also { nextSnapshotId += <span class="hljs-number">1</span> } },  <span class="hljs-comment">// id=2</span>
                invalid = invalid,
                readObserver = actualReadObserver,
            )
        }
    }
</code></pre>
<h3 data-id="heading-14">æºç ä½ç½®ï¼šSnapshot.kt</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Snapshot&gt;</span> <span class="hljs-title">takeNewSnapshot</span><span class="hljs-params">(block: (<span class="hljs-type">invalid</span>: <span class="hljs-type">SnapshotIdSet</span>) -&gt; <span class="hljs-type">T</span>)</span></span>: T =
    advanceGlobalSnapshot { invalid -&gt;
        <span class="hljs-keyword">val</span> result = block(invalid)
        sync { openSnapshots = openSnapshots.<span class="hljs-keyword">set</span>(result.snapshotId) }
        result
    }
</code></pre>
<h3 data-id="heading-15">æºç ä½ç½®ï¼šSnapshot.kt</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">advanceGlobalSnapshot</span><span class="hljs-params">(block: (<span class="hljs-type">invalid</span>: <span class="hljs-type">SnapshotIdSet</span>) -&gt; <span class="hljs-type">T</span>)</span></span>: T {
    <span class="hljs-keyword">val</span> globalSnapshot = globalSnapshot
    <span class="hljs-keyword">val</span> result = sync {
        <span class="hljs-comment">// é‡ç½®å…¨å±€å¿«ç…§ï¼Œåˆ†é…æ–° ID</span>
        resetGlobalSnapshotLocked(globalSnapshot, block)
    }
    <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">return</span> result
}
</code></pre>
<h3 data-id="heading-16">æºç ä½ç½®ï¼šSnapshot.kt</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">resetGlobalSnapshotLocked</span><span class="hljs-params">(
    globalSnapshot: <span class="hljs-type">GlobalSnapshot</span>,
    block: (<span class="hljs-type">invalid</span>: <span class="hljs-type">SnapshotIdSet</span>) -&gt; <span class="hljs-type">T</span>,
)</span></span>: T {
    <span class="hljs-keyword">val</span> snapshotId = globalSnapshot.snapshotId  <span class="hljs-comment">// å½“å‰æ˜¯ 1</span>
    <span class="hljs-keyword">val</span> result = block(openSnapshots.clear(snapshotId))  <span class="hljs-comment">// invalid = {ç©º}</span>
    
    <span class="hljs-keyword">val</span> nextGlobalSnapshotId = nextSnapshotId  <span class="hljs-comment">// è·å–ä¸‹ä¸€ä¸ª ID (2)</span>
    nextSnapshotId += <span class="hljs-number">1</span>
    
    openSnapshots = openSnapshots.clear(snapshotId)
    globalSnapshot.snapshotId = nextGlobalSnapshotId  <span class="hljs-comment">// GlobalSnapshot å˜æˆ id=3</span>
    globalSnapshot.invalid = openSnapshots            <span class="hljs-comment">// {2} - å› ä¸ºå¿«ç…§ 2 è¿˜æœªå…³é—­</span>
    openSnapshots = openSnapshots.<span class="hljs-keyword">set</span>(nextGlobalSnapshotId)  <span class="hljs-comment">// {2, 3}</span>
    
    <span class="hljs-keyword">return</span> result
}
</code></pre>
<h3 data-id="heading-17">æ‰§è¡Œé¡ºåºè¯¦è§£</h3>
<ol>
<li><strong>è¿›å…¥æ—¶</strong>: GlobalSnapshot.id=1, nextSnapshotId=2, openSnapshots={1}</li>
<li><strong>åˆ›å»º ReadonlySnapshot</strong>: id=2, invalid={}ï¼ˆç©ºé›†åˆï¼ï¼‰</li>
<li><strong>æ›´æ–° GlobalSnapshot</strong>: id=3</li>
<li><strong>é€€å‡ºæ—¶</strong>: GlobalSnapshot.id=3, nextSnapshotId=4, openSnapshots={2,3}</li>
</ol>
<h3 data-id="heading-18">å…³é”®ç‚¹ï¼šsnapshot çš„ invalid é›†åˆ</h3>
<pre><code class="hljs language-ini" lang="ini">ReadonlySnapshot:
  <span class="hljs-attr">snapshotId</span> = <span class="hljs-number">2</span>
  <span class="hljs-attr">invalid</span> = {}  â† ç©ºé›†åˆï¼è¿™æ„å‘³ç€å®ƒèƒ½çœ‹åˆ° id &lt;= <span class="hljs-number">2</span> çš„æ‰€æœ‰è®°å½•
</code></pre>
<h3 data-id="heading-19">æ‰§è¡Œåçš„çŠ¶æ€</h3>
<pre><code class="hljs language-ini" lang="ini">GlobalSnapshot: <span class="hljs-attr">id</span>=<span class="hljs-number">3</span>, invalid={<span class="hljs-number">2</span>}
ReadonlySnapshot (æˆ‘ä»¬æ‹¿åˆ°çš„): <span class="hljs-attr">id</span>=<span class="hljs-number">2</span>, invalid={}

person.name çš„è®°å½•é“¾ï¼š
    StateStateRecord(<span class="hljs-attr">snapshotId</span>=<span class="hljs-number">1</span>, value=<span class="hljs-string">"ä»¤ç‹å†²"</span>) â†’ null
</code></pre>
<hr/>
<h2 data-id="heading-20">ç¬¬å››æ­¥ï¼šç¬¬äºŒæ¬¡èµ‹å€¼ (person.name.value = "ä»»ç›ˆç›ˆ")</h2>
<p>å†æ¬¡æ‰§è¡Œ <code>overwritable</code>:</p>
<h3 data-id="heading-21">æºç ä½ç½®ï¼šSnapshot.kt</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : StateRecord&gt;</span> T.<span class="hljs-title">overwritableRecord</span><span class="hljs-params">(
    state: <span class="hljs-type">StateObject</span>,
    snapshot: <span class="hljs-type">Snapshot</span>,
    candidate: <span class="hljs-type">T</span>,
)</span></span>: T {
    <span class="hljs-keyword">val</span> id = snapshot.snapshotId  <span class="hljs-comment">// ç°åœ¨æ˜¯ 3ï¼ˆGlobalSnapshotï¼‰</span>

    <span class="hljs-comment">// candidate.snapshotId = 1, id = 3</span>
    <span class="hljs-comment">// 1 != 3ï¼Œéœ€è¦åˆ›å»ºæ–°è®°å½•ï¼</span>
    <span class="hljs-keyword">if</span> (candidate.snapshotId == id) <span class="hljs-keyword">return</span> candidate

    <span class="hljs-keyword">val</span> newData = sync { newOverwritableRecordLocked(state) }
    newData.snapshotId = id  <span class="hljs-comment">// è®¾ä¸º 3</span>
    <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">return</span> newData
}
</code></pre>
<h3 data-id="heading-22">æºç ä½ç½®ï¼šSnapshot.kt</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : StateRecord&gt;</span> T.<span class="hljs-title">newOverwritableRecordLocked</span><span class="hljs-params">(state: <span class="hljs-type">StateObject</span>)</span></span>: T {
    <span class="hljs-keyword">return</span> (usedLocked(state) <span class="hljs-keyword">as</span> T?)?.apply { snapshotId = SnapshotIdMax }
        ?: create(SnapshotIdMax).apply {
            <span class="hljs-keyword">this</span>.next = state.firstStateRecord  <span class="hljs-comment">// æŒ‡å‘æ—§è®°å½•</span>
            state.prependStateRecord(<span class="hljs-keyword">this</span> <span class="hljs-keyword">as</span> T)  <span class="hljs-comment">// æ’å…¥é“¾è¡¨å¤´éƒ¨</span>
        } <span class="hljs-keyword">as</span> T
}
</code></pre>
<h3 data-id="heading-23">æ‰§è¡Œåçš„å†…å­˜ç»“æ„</h3>
<pre><code class="hljs language-ini" lang="ini">person.name (SnapshotMutableStateImpl)
    â”‚
    â””â”€â”€ next â”€â”€â–º StateStateRecord (æ–°)
                   â”œâ”€â”€ <span class="hljs-attr">snapshotId</span> = <span class="hljs-number">3</span>
                   â”œâ”€â”€ <span class="hljs-attr">value</span> = <span class="hljs-string">"ä»»ç›ˆç›ˆ"</span>
                   â””â”€â”€ next â”€â”€â–º StateStateRecord (æ—§)
                                  â”œâ”€â”€ <span class="hljs-attr">snapshotId</span> = <span class="hljs-number">1</span>
                                  â”œâ”€â”€ <span class="hljs-attr">value</span> = <span class="hljs-string">"ä»¤ç‹å†²"</span>
                                  â””â”€â”€ <span class="hljs-attr">next</span> = null
</code></pre>
<p><strong>è¿™å°±æ˜¯å…³é”®ï¼šæ—§è®°å½•è¢«ä¿ç•™äº†ï¼</strong></p>
<hr/>
<h2 data-id="heading-24">ç¬¬äº”æ­¥ï¼šç¬¬ä¸€æ¬¡æ‰“å° (åœ¨å…¨å±€å¿«ç…§ä¸­è¯»å–)</h2>
<pre><code class="hljs language-kotlin" lang="kotlin">println(<span class="hljs-string">"ç¬¬ä¸€æ¬¡æ‰“å°ï¼š<span class="hljs-subst">${person.name.value}</span>"</span>)
</code></pre>
<h3 data-id="heading-25">æºç ä½ç½®ï¼šSnapshotState</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">override</span> <span class="hljs-keyword">var</span> value: T
    <span class="hljs-keyword">get</span>() = next.readable(<span class="hljs-keyword">this</span>).value
</code></pre>
<h3 data-id="heading-26">æºç ä½ç½®ï¼šSnapshot.kt</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : StateRecord&gt;</span> T.<span class="hljs-title">readable</span><span class="hljs-params">(state: <span class="hljs-type">StateObject</span>)</span></span>: T {
    <span class="hljs-keyword">val</span> snapshot = Snapshot.current  <span class="hljs-comment">// GlobalSnapshot: id=3, invalid={2}</span>
    snapshot.readObserver?.invoke(state)
    <span class="hljs-keyword">return</span> readable(<span class="hljs-keyword">this</span>, snapshot.snapshotId, snapshot.invalid)
        ?: <span class="hljs-comment">// fallback...</span>
}
</code></pre>
<h3 data-id="heading-27">æºç ä½ç½®ï¼šSnapshot.kt</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : StateRecord&gt;</span> <span class="hljs-title">readable</span><span class="hljs-params">(r: <span class="hljs-type">T</span>, id: <span class="hljs-type">SnapshotId</span>, invalid: <span class="hljs-type">SnapshotIdSet</span>)</span></span>: T? {
    <span class="hljs-comment">// id=3, invalid={2}</span>
    <span class="hljs-keyword">var</span> current: StateRecord? = r
    <span class="hljs-keyword">var</span> candidate: StateRecord? = <span class="hljs-literal">null</span>
    <span class="hljs-keyword">while</span> (current != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (valid(current, id, invalid)) {
            candidate =
                <span class="hljs-keyword">if</span> (candidate == <span class="hljs-literal">null</span>) current
                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (candidate.snapshotId &lt; current.snapshotId) current <span class="hljs-keyword">else</span> candidate
        }
        current = current.next
    }
    <span class="hljs-keyword">return</span> candidate <span class="hljs-keyword">as</span>? T
}
</code></pre>
<h3 data-id="heading-28">æºç ä½ç½®ï¼šSnapshot.kt</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">valid</span><span class="hljs-params">(
    currentSnapshot: <span class="hljs-type">SnapshotId</span>,
    candidateSnapshot: <span class="hljs-type">SnapshotId</span>,
    invalid: <span class="hljs-type">SnapshotIdSet</span>,
)</span></span>: <span class="hljs-built_in">Boolean</span> {
    <span class="hljs-keyword">return</span> candidateSnapshot != INVALID_SNAPSHOT &amp;&amp;
        candidateSnapshot &lt;= currentSnapshot &amp;&amp;
        !invalid.<span class="hljs-keyword">get</span>(candidateSnapshot)
}
</code></pre>
<h3 data-id="heading-29">ç‰ˆæœ¬é€‰æ‹©è¿‡ç¨‹</h3>
<p>GlobalSnapshot: id=3, invalid={2}</p>























<table><thead><tr><th>è®°å½•</th><th>snapshotId</th><th>valid() æ£€æŸ¥</th><th>ç»“æœ</th></tr></thead><tbody><tr><td>è®°å½•1</td><td>3</td><td>3 != 0 âœ“, 3 &lt;= 3 âœ“, 3 ä¸åœ¨ {2} âœ“</td><td><strong>æœ‰æ•ˆ</strong></td></tr><tr><td>è®°å½•2</td><td>1</td><td>1 != 0 âœ“, 1 &lt;= 3 âœ“, 1 ä¸åœ¨ {2} âœ“</td><td>æœ‰æ•ˆ</td></tr></tbody></table>
<p>é€‰æ‹© snapshotId æœ€å¤§çš„æœ‰æ•ˆè®°å½• â†’ <strong>è®°å½•1 (snapshotId=3, value="ä»»ç›ˆç›ˆ")</strong></p>
<p><strong>è¾“å‡º: ä»»ç›ˆç›ˆ</strong></p>
<hr/>
<h2 data-id="heading-30">ç¬¬å…­æ­¥ï¼šè¿›å…¥å¿«ç…§ (snapshot.enter { ... })</h2>
<h3 data-id="heading-31">æºç ä½ç½®ï¼šSnapshot.kt</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">enter</span><span class="hljs-params">(block: () -&gt; <span class="hljs-type">T</span>)</span></span>: T {
    <span class="hljs-keyword">val</span> previous = makeCurrent()
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">return</span> block()
    } <span class="hljs-keyword">finally</span> {
        restoreCurrent(previous)
    }
}
</code></pre>
<h3 data-id="heading-32">æºç ä½ç½®ï¼šSnapshot.kt</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">open</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">makeCurrent</span><span class="hljs-params">()</span></span>: Snapshot? {
    <span class="hljs-keyword">val</span> previous = threadSnapshot.<span class="hljs-keyword">get</span>()
    threadSnapshot.<span class="hljs-keyword">set</span>(<span class="hljs-keyword">this</span>)  <span class="hljs-comment">// å°† ReadonlySnapshot è®¾ä¸ºå½“å‰å¿«ç…§</span>
    <span class="hljs-keyword">return</span> previous
}
</code></pre>
<p>ç°åœ¨ <code>Snapshot.current</code> è¿”å›æˆ‘ä»¬çš„ ReadonlySnapshot (id=2, invalid={})</p>
<hr/>
<h2 data-id="heading-33">ç¬¬ä¸ƒæ­¥ï¼šç¬¬äºŒæ¬¡æ‰“å° (åœ¨ ReadonlySnapshot ä¸­è¯»å–)</h2>
<pre><code class="hljs language-kotlin" lang="kotlin">println(<span class="hljs-string">"ç¬¬äºŒæ¬¡æ‰“å°ï¼š<span class="hljs-subst">${person.name.value}</span>"</span>)
</code></pre>
<p>å†æ¬¡è°ƒç”¨ <code>readable()</code>:</p>
<p>ReadonlySnapshot: id=2, invalid={}</p>
<h3 data-id="heading-34">ç‰ˆæœ¬é€‰æ‹©è¿‡ç¨‹</h3>























<table><thead><tr><th>è®°å½•</th><th>snapshotId</th><th>valid() æ£€æŸ¥</th><th>ç»“æœ</th></tr></thead><tbody><tr><td>è®°å½•1</td><td>3</td><td>3 != 0 âœ“, <strong>3 &lt;= 2 âœ—</strong></td><td><strong>æ— æ•ˆ</strong></td></tr><tr><td>è®°å½•2</td><td>1</td><td>1 != 0 âœ“, 1 &lt;= 2 âœ“, 1 ä¸åœ¨ {} âœ“</td><td><strong>æœ‰æ•ˆ</strong></td></tr></tbody></table>
<p>é€‰æ‹©å”¯ä¸€æœ‰æ•ˆçš„è®°å½• â†’ <strong>è®°å½•2 (snapshotId=1, value="ä»¤ç‹å†²")</strong></p>
<p><strong>è¾“å‡º: ä»¤ç‹å†²</strong></p>
<h3 data-id="heading-35">ä¸ºä»€ä¹ˆè®°å½•1æ— æ•ˆï¼Ÿ</h3>
<pre><code class="hljs language-kotlin" lang="kotlin">candidateSnapshot &lt;= currentSnapshot
<span class="hljs-number">3</span> &lt;= <span class="hljs-number">2</span>  <span class="hljs-comment">// FALSEï¼</span>
</code></pre>
<p>è®°å½•1çš„ snapshotId=3 <strong>å¤§äº</strong> ReadonlySnapshot çš„ id=2ï¼Œæ‰€ä»¥å®ƒå¯¹è¿™ä¸ªå¿«ç…§æ˜¯"æœªæ¥"çš„ï¼Œä¸å¯è§ã€‚</p>
<hr/>
<h2 data-id="heading-36">ç¬¬å…«æ­¥ï¼šé€€å‡ºå¿«ç…§å¹¶ç¬¬ä¸‰æ¬¡æ‰“å°</h2>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// snapshot.enter è¿”å›åï¼Œè‡ªåŠ¨è°ƒç”¨ restoreCurrent(previous)</span>
<span class="hljs-comment">// Snapshot.current åˆå˜å› GlobalSnapshot (id=3)</span>
println(<span class="hljs-string">"ç¬¬ä¸‰æ¬¡æ‰“å°ï¼š<span class="hljs-subst">${person.name.value}</span>"</span>)
</code></pre>
<p>ä¸ç¬¬äº”æ­¥ç›¸åŒçš„é€»è¾‘ï¼Œ<strong>è¾“å‡º: ä»»ç›ˆç›ˆ</strong></p>
<hr/>
<h2 data-id="heading-37">æ ¸å¿ƒåŸç†æ€»ç»“</h2>
<h3 data-id="heading-38">1. MVCC å¤šç‰ˆæœ¬</h3>
<p>æ¯æ¬¡åœ¨<strong>æ–°å¿«ç…§</strong>ä¸­ä¿®æ”¹çŠ¶æ€ï¼Œéƒ½ä¼š<strong>åˆ›å»ºæ–°è®°å½•</strong>è€Œä¸æ˜¯è¦†ç›–æ—§è®°å½•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">é“¾è¡¨å¤´ â†’ Record(<span class="hljs-built_in">id</span>=3, <span class="hljs-string">"ä»»ç›ˆç›ˆ"</span>) â†’ Record(<span class="hljs-built_in">id</span>=1, <span class="hljs-string">"ä»¤ç‹å†²"</span>) â†’ null
</code></pre>
<h3 data-id="heading-39">2. ç‰ˆæœ¬é€‰æ‹©ç®—æ³•</h3>
<p><code>readable()</code> å‡½æ•°é€šè¿‡ä¸‰ä¸ªæ¡ä»¶é€‰æ‹©ç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">candidateSnapshot != INVALID_SNAPSHOT &amp;&amp;  <span class="hljs-comment">// ä¸æ˜¯æ— æ•ˆ ID</span>
candidateSnapshot &lt;= currentSnapshot &amp;&amp;   <span class="hljs-comment">// ä¸è¶…è¿‡å½“å‰å¿«ç…§ ID</span>
!invalid.<span class="hljs-keyword">get</span>(candidateSnapshot)           <span class="hljs-comment">// ä¸åœ¨ invalid é›†åˆä¸­</span>
</code></pre>
<h3 data-id="heading-40">3. invalid é›†åˆçš„ä½œç”¨</h3>
<ul>
<li>å¿«ç…§åˆ›å»ºæ—¶ï¼Œè®°å½•å“ªäº›å¿«ç…§ ID æ˜¯"ä¸å¯è§"çš„</li>
<li>å¯¹äº ReadonlySnapshotï¼Œåˆ›å»ºæ—¶çš„ invalid æ˜¯ç©ºçš„</li>
<li>å¯¹äº GlobalSnapshotï¼Œinvalid åŒ…å«æ‰€æœ‰æœª apply çš„ MutableSnapshot</li>
</ul>
<h3 data-id="heading-41">4. ThreadLocal å®ç°çº¿ç¨‹éš”ç¦»</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> threadSnapshot = SnapshotThreadLocal&lt;Snapshot&gt;()

<span class="hljs-keyword">internal</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">currentSnapshot</span><span class="hljs-params">()</span></span>: Snapshot = 
    threadSnapshot.<span class="hljs-keyword">get</span>() ?: globalSnapshot
</code></pre>
<hr/>
<h2 data-id="heading-42">å›¾è§£å®Œæ•´æµç¨‹</h2>
<pre><code class="hljs language-ini" lang="ini">æ—¶é—´çº¿:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º

T1: mutableStateOf("")
    GlobalSnapshot <span class="hljs-attr">id</span>=<span class="hljs-number">1</span>
    Record: <span class="hljs-section">[id=1, value=""]</span>
    
T2: <span class="hljs-attr">value</span> = <span class="hljs-string">"ä»¤ç‹å†²"</span>  
    GlobalSnapshot <span class="hljs-attr">id</span>=<span class="hljs-number">1</span> (æœªå˜)
    Record: <span class="hljs-section">[id=1, value="ä»¤ç‹å†²"]</span>  â† ç›´æ¥è¦†ç›–ï¼Œå› ä¸ºåŒä¸€å¿«ç…§
    
T3: takeSnapshot()
    GlobalSnapshot <span class="hljs-attr">id</span>=<span class="hljs-number">3</span> (æ¨è¿›äº†!)
    ReadonlySnapshot <span class="hljs-attr">id</span>=<span class="hljs-number">2</span>, invalid={}
    Record: ä¸å˜
    
T4: <span class="hljs-attr">value</span> = <span class="hljs-string">"ä»»ç›ˆç›ˆ"</span>
    GlobalSnapshot <span class="hljs-attr">id</span>=<span class="hljs-number">3</span>
    åˆ›å»ºæ–°è®°å½•!
    Recordé“¾: <span class="hljs-section">[id=3, value="ä»»ç›ˆç›ˆ"]</span> â†’ <span class="hljs-section">[id=1, value="ä»¤ç‹å†²"]</span>
    
T5: å…¨å±€è¯»å– (GlobalSnapshot <span class="hljs-attr">id</span>=<span class="hljs-number">3</span>, invalid={<span class="hljs-number">2</span>})
    é€‰æ‹©: <span class="hljs-attr">id</span>=<span class="hljs-number">3</span> çš„è®°å½• (<span class="hljs-number">3</span> &lt;= <span class="hljs-number">3</span> ä¸” <span class="hljs-number">3</span> ä¸åœ¨ {<span class="hljs-number">2</span>})
    ç»“æœ: "ä»»ç›ˆç›ˆ"
    
T6: snapshot.enter è¯»å– (ReadonlySnapshot <span class="hljs-attr">id</span>=<span class="hljs-number">2</span>, invalid={})
    æ£€æŸ¥ <span class="hljs-attr">id</span>=<span class="hljs-number">3</span>: <span class="hljs-number">3</span> &lt;= <span class="hljs-number">2</span>? <span class="hljs-literal">NO</span> â†’ æ— æ•ˆ
    æ£€æŸ¥ <span class="hljs-attr">id</span>=<span class="hljs-number">1</span>: <span class="hljs-number">1</span> &lt;= <span class="hljs-number">2</span>? <span class="hljs-literal">YES</span> â†’ æœ‰æ•ˆ
    ç»“æœ: "ä»¤ç‹å†²"
    
T7: å…¨å±€è¯»å–
    åŒ T5
    ç»“æœ: "ä»»ç›ˆç›ˆ"
</code></pre>
<p>è¿™å°±æ˜¯å¿«ç…§èƒ½çœ‹åˆ°"è¿‡å»"çŠ¶æ€çš„å®Œæ•´åŸç†ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Androidè¾“å…¥ç³»ç»Ÿæºç åˆ†æ(ä¸Š)]]></title>    <link>https://juejin.cn/post/7591338980693639214</link>    <guid>https://juejin.cn/post/7591338980693639214</guid>    <pubDate>2026-01-04T12:31:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591338980693639214" data-draft-id="7591360623469363210" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Androidè¾“å…¥ç³»ç»Ÿæºç åˆ†æ(ä¸Š)"/> <meta itemprop="keywords" content="æºç "/> <meta itemprop="datePublished" content="2026-01-04T12:31:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="CarryZhang"/> <meta itemprop="url" content="https://juejin.cn/user/782508007385415"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Androidè¾“å…¥ç³»ç»Ÿæºç åˆ†æ(ä¸Š)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/782508007385415/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    CarryZhang
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T12:31:26.000Z" title="Sun Jan 04 2026 12:31:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»24åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1.å‰è¨€</h2>
<p>Androidçš„è¾“å…¥ç³»ç»Ÿæ˜¯è´¯ç©¿å„ä¸ªç³»ç»Ÿçš„äº‹ä»¶ç®¡çº¿ã€‚</p>
<p>åœ¨æœ€ä½å±‚ï¼Œç‰©ç†è¾“å…¥è®¾å¤‡ä¼šç”Ÿæˆæè¿°çŠ¶æ€æ›´æ”¹ï¼ˆä¾‹å¦‚æŒ‰é”®æŒ‰å‹å’Œè½»è§¦æ¥è§¦ç‚¹ï¼‰çš„ä¿¡å·ã€‚è®¾å¤‡å›ºä»¶ä»¥æŸç§æ–¹å¼ç¼–ç å’Œä¼ è¾“è¿™äº›ä¿¡å·ï¼Œä¾‹å¦‚å‘ç³»ç»Ÿå‘é€ USB HID æŠ¥å‘Šæˆ–åœ¨ I2C æ€»çº¿ä¸Šäº§ç”Ÿä¸­æ–­ã€‚</p>
<p>è¾“å…¥è®¾å¤‡é©±åŠ¨ç¨‹åºè´Ÿè´£é€šè¿‡ Linux è¾“å…¥åè®®å°†è®¾å¤‡ç‰¹å®šä¿¡å·è½¬æ¢ä¸ºæ ‡å‡†è¾“å…¥äº‹ä»¶æ ¼å¼ã€‚Linux è¾“å…¥åè®®åœ¨Â <code>linux/input.h</code>Â å†…æ ¸å¤´æ–‡ä»¶ä¸­å®šä¹‰äº†ä¸€ç»„æ ‡å‡†äº‹ä»¶ç±»å‹å’Œä»£ç ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼ŒAndroidÂ <code>EventHub</code>Â ç»„ä»¶é€šè¿‡æ‰“å¼€ä¸æ¯ä¸ªè¾“å…¥è®¾å¤‡å…³è”çš„Â <code>evdev</code>Â é©±åŠ¨ç¨‹åºä»å†…æ ¸è¯»å–è¾“å…¥äº‹ä»¶ã€‚ç„¶åï¼ŒAndroid <code>InputReader</code> ç»„ä»¶æ ¹æ®è®¾å¤‡ç±»åˆ«è§£ç è¾“å…¥äº‹ä»¶ï¼Œå¹¶ç”Ÿæˆ Android è¾“å…¥äº‹ä»¶æµã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼ŒLinux è¾“å…¥åè®®äº‹ä»¶ä»£ç å°†æ ¹æ®è¾“å…¥è®¾å¤‡é…ç½®ã€é”®ç›˜å¸ƒå±€æ–‡ä»¶å’Œå„ç§æ˜ å°„è¡¨ï¼Œè½¬åŒ–ä¸º Android äº‹ä»¶ä»£ç ã€‚</p>
<p>æœ€åï¼Œ<code>InputReader</code>Â å°†è¾“å…¥äº‹ä»¶å‘é€åˆ° <code>InputDispatcher</code>ï¼Œç”±å…¶é€šè¿‡<code>socket</code>å¯¹å°†è¿™äº›äº‹ä»¶è½¬å‘åˆ°ç›¸åº”çš„çª—å£clientï¼Œå„çª—å£æ”¶åˆ°äº‹ä»¶æ‰¾åˆ°æœ€åŒ¹é…çš„<code>InputState</code>å¤„ç†äº‹ä»¶,å¤„ç†å®Œäº‹ä»¶æœ€ç»ˆåˆé€šè¿‡<code>socket</code>å¯¹å°†äº‹ä»¶å¤„ç†ç»“æŸæ ‡è®°å›ä¼ åˆ°serverç«¯çš„<code>InputDispatcher</code>ï¼Œè¿™æ ·ä¸€ä¸ªäº‹ä»¶çš„åˆ†å‘å¤„ç†æµç¨‹æ‰ç®—ç»“æŸã€‚ç„¶å<code>InputDispatcher</code>åˆå¯ä»¥å¼€å§‹åˆ†å‘ä¸‹ä¸€ä¸ªäº‹ä»¶äº†ã€‚</p>
<p>æ•´ä½“çš„ æ¶æ„å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/caf88e478f4f481f841c4dc077813108~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2FycnlaaGFuZw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768135397&amp;x-signature=kEjBtegg5R2hE2ZwOXQnKqCCtdM%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-1">2.IMSç³»ç»Ÿåˆå§‹åŒ–</h2>
<p>åœ¨Androidç³»ç»Ÿå¯åŠ¨æ—¶å¯åŠ¨äº†å¾ˆå¤šæœåŠ¡ï¼ŒåŒ…æ‹¬å¼•å¯¼æœåŠ¡ã€æ ¸å¿ƒæœåŠ¡ã€å…¶ä»–æœåŠ¡ç­‰ï¼Œæˆ‘ä»¬çš„IMSå°±æ˜¯åœ¨å…¶ä»–æœåŠ¡é‡Œå¯åŠ¨çš„ã€‚</p>
<p>æœ¬æ–‡çš„æºç æ˜¯åŸºäº<a href="https://link.juejin.cn?target=https%3A%2F%2Fcs.android.com%2F" target="_blank" title="https://cs.android.com/" ref="nofollow noopener noreferrer">cs.android.com/</a> maintåˆ†æ”¯ æœ€æ–°ä»£ç åˆ†æçš„ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">frameworks/base/services/java/com/android/server/SystemServer<span class="hljs-selector-class">.java</span>
private void <span class="hljs-built_in">startOtherServices</span>(@NonNull TimingsTraceAndSlog t) {
    ...
    InputManagerService inputManager = new <span class="hljs-built_in">InputManagerService</span>(context);
    <span class="hljs-comment">//å…³è”WMSå’ŒIMS</span>
    WindowManagerService wm = WindowManagerService<span class="hljs-selector-class">.main</span>(context, inputManager, !mFirstBoot,
                new PhoneWindowManager(), mActivityManagerService<span class="hljs-selector-class">.mActivityTaskManager</span>);
    inputManager<span class="hljs-selector-class">.setWindowManagerCallbacks</span>(wm.getInputManagerCallback());
    <span class="hljs-comment">//å¯åŠ¨ims</span>
    inputManager<span class="hljs-selector-class">.start</span>();
    ...
}

frameworks/base/services/core/java/com/android/server/<span class="hljs-selector-tag">input</span>/InputManagerService<span class="hljs-selector-class">.java</span>
public void <span class="hljs-built_in">start</span>() {
    Slog<span class="hljs-selector-class">.i</span>(TAG, "Starting input manager");
    mNative<span class="hljs-selector-class">.start</span>();

    <span class="hljs-comment">// Add ourselves to the Watchdog monitors.</span>
    Watchdog<span class="hljs-selector-class">.getInstance</span>()<span class="hljs-selector-class">.addMonitor</span>(this);
}

frameworks/base/services/core/jni/com_android_server_input_InputManagerService<span class="hljs-selector-class">.cpp</span>
int <span class="hljs-built_in">register_android_server_InputManager</span>(JNIEnv* env) {
    <span class="hljs-comment">//æ³¨å†Œjniæ–¹æ³•</span>
    int res = <span class="hljs-built_in">jniRegisterNativeMethods</span>(env,
                                       "com/android/server/input/"
                                       "NativeInputManagerService$NativeImpl",
                                       gInputManagerMethods, NELEM(gInputManagerMethods));
    (void)res; <span class="hljs-comment">// Faked use when LOG_NDEBUG.</span>
    <span class="hljs-built_in">LOG_FATAL_IF</span>(res &lt; <span class="hljs-number">0</span>, "Unable to register native methods.");

    <span class="hljs-built_in">FIND_CLASS</span>(gNativeInputManagerServiceImpl.clazz,
               "com/android/server/input/"
               "NativeInputManagerService$NativeImpl");
   <span class="hljs-comment">//æ³¨å†Œjavaå¼•ç”¨</span>
    gNativeInputManagerServiceImpl<span class="hljs-selector-class">.clazz</span> =
            <span class="hljs-built_in">jclass</span>(env-&gt;NewGlobalRef(gNativeInputManagerServiceImpl.clazz));
    gNativeInputManagerServiceImpl<span class="hljs-selector-class">.mPtr</span> =
            env-&gt;<span class="hljs-built_in">GetFieldID</span>(gNativeInputManagerServiceImpl.clazz, "mPtr", "J");
}

static void <span class="hljs-built_in">nativeStart</span>(JNIEnv* env, jobject nativeImplObj) {
    NativeInputManager* im = <span class="hljs-built_in">getNativeInputManager</span>(env, nativeImplObj);

    status_t result = im-&gt;<span class="hljs-built_in">getInputManager</span>()-&gt;<span class="hljs-built_in">start</span>();
    if (result) {
        <span class="hljs-built_in">jniThrowRuntimeException</span>(env, "Input manager could not be started.");
    }
}

frameworks/native/services/inputflinger/InputManager<span class="hljs-selector-class">.cpp</span>
InputManager::<span class="hljs-built_in">InputManager</span>(const sp&lt;InputReaderPolicyInterface&gt;&amp; readerPolicy,
                       InputDispatcherPolicyInterface&amp; dispatcherPolicy,
                       PointerChoreographerPolicyInterface&amp; choreographerPolicy,
                       InputFilterPolicyInterface&amp; inputFilterPolicy) {
    mInputFlingerRust = <span class="hljs-built_in">createInputFlingerRust</span>();
    <span class="hljs-comment">//åˆå§‹åŒ–InputDispatcher</span>
    mDispatcher = <span class="hljs-built_in">createInputDispatcher</span>(dispatcherPolicy);
    mTracingStages<span class="hljs-selector-class">.emplace_back</span>(
        std::make_unique&lt;TracedInputListener&gt;("InputDispatcher", *mDispatcher));
    ...
    <span class="hljs-comment">//åˆå§‹åŒ–InputDispatcher</span>
    mReader = <span class="hljs-built_in">createInputReader</span>(readerPolicy, *mTracingStages.back());
}

status_t InputManager::<span class="hljs-built_in">start</span>() {
    <span class="hljs-comment">//å¼€å§‹è½®è¯¢åˆ†å‘äº‹ä»¶</span>
    status_t result = mDispatcher-&gt;<span class="hljs-built_in">start</span>();
    if (result) {
        <span class="hljs-built_in">ALOGE</span>("Could not start InputDispatcher thread due to error %d.", result);
        return result;
    }
    <span class="hljs-comment">//å¼€å§‹è½®è¯¢è¯»å–äº‹ä»¶</span>
    result = mReader-&gt;<span class="hljs-built_in">start</span>();
    if (result) {
        <span class="hljs-built_in">ALOGE</span>("Could not start InputReader due to error %d.", result);

        mDispatcher-&gt;<span class="hljs-built_in">stop</span>();
        return result;
    }

    return OK;
}
</code></pre>
<p>IMSå¯åŠ¨æ—¶ä¸»è¦æ˜¯åˆå§‹åŒ–äº‹ä»¶åˆ†å‘å™¨InputDispatcherå’Œäº‹ä»¶è¯»å–å™¨InputReaderï¼Œå¹¶åˆ†åˆ«å¼€å§‹è½®è¯¢ã€‚æ¥ä¸‹æ¥å°†åˆ†åˆ«å¯¹äº‹ä»¶è¯»å–æµç¨‹å’Œåˆ†å‘æµç¨‹è¿›è¡Œåˆ†æã€‚</p>
<h2 data-id="heading-2">3.InputReaderäº‹ä»¶è¯»å–ã€ç»„è£…å’Œé¢„åˆ†å‘</h2>
<p><code>InputReader</code>ä¸­çš„<code>InputThread</code>ä¸€ç›´å¾ªç¯ä»<code>EventHub</code>ä¸­è¯»å–è®¾å¤‡è¾“å…¥çš„äº‹ä»¶å’Œå¯¹äº‹ä»¶è¿›è¡Œå°è£…ï¼ŒåŒæ—¶å°†äº‹ä»¶ä¼ é€’åˆ°<code>InputDispatcher</code>çš„é˜Ÿåˆ—ä¸­ï¼Œä»¥ä¾¿åç»­çš„åˆ†å‘ã€‚</p>
<p>å…ˆä»åˆå§‹åŒ–å¼€å§‹å…¥æ‰‹ï¼ŒInputDispatcheråˆå§‹åŒ–æ—¶åŒæ—¶åˆå§‹åŒ–äº†EventHubï¼ŒåŒæ—¶è¿˜å…³è”äº†mTracingStagesï¼Œè€ŒmTracingStagesé‡Œé¢åˆå…³è”äº†äº‹ä»¶åˆ†å‘çš„InputDispatcherã€‚</p>
<pre><code class="hljs language-c" lang="c">frameworks/native/services/inputflinger/reader/InputReaderFactory.cpp
<span class="hljs-built_in">std</span>::<span class="hljs-built_in">unique_ptr</span>&lt;InputReaderInterface&gt; <span class="hljs-title function_">createInputReader</span><span class="hljs-params">(
    <span class="hljs-type">const</span> sp&lt;InputReaderPolicyInterface&gt;&amp; policy, InputListenerInterface&amp; listener)</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">std</span>::make_unique&lt;InputReader&gt;(<span class="hljs-built_in">std</span>::make_unique&lt;EventHub&gt;(), policy, listener);
}
</code></pre>
<p>InputReader::start()é‡Œåˆå§‹åŒ–äº†InputThreadï¼ŒInputThreadæ˜¯C++ Threadçš„å­ç±»ï¼Œè¿™é‡Œç›¸å½“äºå¼€å¯äº†è½®è¯¢ï¼Œå¾ªç¯è°ƒç”¨ loopOnceï¼Œçº¿ç¨‹çš„æ‰§è¡Œæµç¨‹å¯ä»¥å‚é˜…ç›¸å…³ä»‹ç»ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">frameworks/native/services/inputflinger/reader/InputReader.cpp
std::shared_ptr&lt;EventHubInterface&gt; mEventHub;
sp&lt;InputReaderPolicyInterface&gt; mPolicy;
<span class="hljs-function">std::list&lt;NotifyArgs&gt; mPendingArgs <span class="hljs-title">GUARDED_BY</span><span class="hljs-params">(mLock)</span></span>;

<span class="hljs-function"><span class="hljs-type">status_t</span> <span class="hljs-title">InputReader::start</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">if</span> (mThread) {
        <span class="hljs-keyword">return</span> ALREADY_EXISTS;
    }
    mThread = std::<span class="hljs-built_in">make_unique</span>&lt;InputThread&gt;(
            <span class="hljs-string">"InputReader"</span>, [<span class="hljs-keyword">this</span>]() { <span class="hljs-built_in">loopOnce</span>(); }, [<span class="hljs-keyword">this</span>]() { mEventHub-&gt;<span class="hljs-built_in">wake</span>(); });
    <span class="hljs-keyword">return</span> OK;
}


frameworks/native/services/inputflinger/reader/InputReader.<span class="hljs-function">cpp
<span class="hljs-type">void</span> <span class="hljs-title">InputReader::loopOnce</span><span class="hljs-params">()</span> </span>{

    std::vector&lt;InputDeviceInfo&gt; inputDevices;
    std::list&lt;NotifyArgs&gt; notifyArgs;
    { 
        <span class="hljs-comment">//è®¡ç®—epoll_waitç­‰å¾…æ—¶é—´ï¼Œå¤§éƒ¨åˆ†ä¸º-1ï¼Œå³ä¸€ç›´é˜»å¡,ç›´åˆ°è¯»å–åˆ°äº‹ä»¶</span>
        timeoutMillis = <span class="hljs-number">-1</span>;
        ...
    } 
    std::vector&lt;RawEvent&gt; events = mEventHub-&gt;<span class="hljs-built_in">getEvents</span>(timeoutMillis);<span class="hljs-comment">//æ³¨é‡Š1</span>

    { <span class="hljs-comment">// acquire lock</span>

        <span class="hljs-keyword">if</span> (!events.<span class="hljs-built_in">empty</span>()) {

            <span class="hljs-comment">//ç»„è£…äº‹ä»¶ï¼Œäº‹ä»¶åˆ†ä¸‰ç§ï¼š1.æ·»åŠ è¾“å…¥è®¾å¤‡ï¼Œ2.ç§»é™¤è¾“å…¥è®¾å¤‡,3.è®¾å¤‡äº§å“çš„äº‹ä»¶</span>
            mPendingArgs += <span class="hljs-built_in">processEventsLocked</span>(events.<span class="hljs-built_in">data</span>(), events.<span class="hljs-built_in">size</span>());<span class="hljs-comment">//æ³¨é‡Š2</span>
        }
        ...
        std::<span class="hljs-built_in">swap</span>(notifyArgs, mPendingArgs);
        ...
    } <span class="hljs-comment">// release lock</span>


    <span class="hljs-comment">// Flush queued events out to the listener.</span>
    <span class="hljs-comment">//é€šçŸ¥InputDispatcheræœ‰æ–°äº‹ä»¶éœ€è¦å¤„ç†</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> NotifyArgs&amp; args : notifyArgs) {
        mNextListener.<span class="hljs-built_in">notify</span>(args);<span class="hljs-comment">//æ³¨é‡Š3</span>
    }

    <span class="hljs-comment">// Notify the policy that input devices have changed.</span>
    <span class="hljs-keyword">if</span> (inputDevicesChanged) {
        mPolicy-&gt;<span class="hljs-built_in">notifyInputDevicesChanged</span>(inputDevices);
    }
    ...
}
</code></pre>
<p>loopOnceè¿™é‡Œä¸»è¦åˆ†ææ ‡æ³¨æ³¨é‡Šçš„ä¸‰ä¸ªæ–¹æ³•ï¼Œ</p>
<ul>
<li><strong>æ³¨é‡Š1</strong> è¯»å–äº‹ä»¶ï¼šä»EventHubè·å–æ—¶é—´ï¼Œç­‰å¾…æ—¶é—´ä¸ºtimeoutMillisï¼Œè¿™ä¸ªä¸€èˆ¬éƒ½æ˜¯-1ï¼Œå³epoll_waitä¸€ç›´é˜»å¡ç­‰å¾…äº‹ä»¶</li>
<li><strong>æ³¨é‡Š2</strong> å°è£…äº‹ä»¶ï¼šäº‹ä»¶åˆ†ä¸‰ç±»ï¼šæ–°å¢è¾“å…¥è®¾å¤‡(ä¾‹å¦‚å¤–æ¥é”®ç›˜/æ’å…¥è€³æœºç­‰)ï¼Œåˆ é™¤è¾“å…¥è®¾å¤‡ï¼Œè®¾å¤‡æ­£å¸¸çš„è¾“å…¥äº‹ä»¶ã€‚é’ˆå¯¹ä¸åŒç±»å‹çš„æ–°å¢è®¾å¤‡(è§¦æ§å±/é”®ç­‰)InputDeviceClassæ·»åŠ ä¸åŒç±»å‹InputMapperç”¨æ¥å¤„ç†è¯¥è®¾å¤‡åç»­ä¼ å…¥çš„äº‹ä»¶ï¼Œæ”¶åˆ°æŸç§è®¾å¤‡çš„åŸå§‹äº‹ä»¶åï¼Œå°±è·å–å¯¹åº”çš„InputMapperæ¥è¿›è¡Œæ•°æ®å°è£…</li>
<li><strong>æ³¨é‡Š3</strong> åˆ†å‘äº‹ä»¶ï¼šé€šçŸ¥InputDispatcherå¤„ç†å°è£…å¥½çš„äº‹ä»¶</li>
</ul>
<h3 data-id="heading-3">3.1 EventHubè¯»å–äº‹ä»¶</h3>
<p>è¯»å–äº‹ä»¶ä¸»è¦æ˜¯ é€šè¿‡ EventHub è¿›è¡Œçš„ï¼Œè¿™é‡Œæˆ‘ä»¬è¿›ä¸€æ­¥è·Ÿè¿› EventHubçš„æºç ï¼Œå…ˆçœ‹ä¸€ä¸‹EventHub çš„åˆå§‹åŒ–é€»è¾‘</p>
<pre><code class="hljs language-scss" lang="scss">frameworks/native/services/inputflinger/reader/EventHub<span class="hljs-selector-class">.cpp</span>
<span class="hljs-comment">//è¾“å…¥äº‹ä»¶çš„æ–‡ä»¶æ“ä½œç›®å½•</span>
static const char* DEVICE_INPUT_PATH = "/dev/<span class="hljs-selector-tag">input</span>";
<span class="hljs-comment">// v4l2 devices go directly into /dev</span>
static const char* DEVICE_PATH = "/dev";

EventHub::<span class="hljs-built_in">EventHub</span>(void)
  : <span class="hljs-built_in">mBuiltInKeyboardId</span>(NO_BUILT_IN_KEYBOARD),
    <span class="hljs-built_in">mNextDeviceId</span>(<span class="hljs-number">1</span>),
    <span class="hljs-built_in">mControllerNumbers</span>(),
    <span class="hljs-built_in">mNeedToReopenDevices</span>(false),
    <span class="hljs-built_in">mNeedToScanDevices</span>(true),
    <span class="hljs-built_in">mPendingEventCount</span>(<span class="hljs-number">0</span>),
    <span class="hljs-built_in">mPendingEventIndex</span>(<span class="hljs-number">0</span>),
    <span class="hljs-built_in">mPendingINotify</span>(false) {
    <span class="hljs-comment">//åˆå§‹åŒ–mEpollFd</span>
    mEpollFd = <span class="hljs-built_in">epoll_create1</span>(EPOLL_CLOEXEC);
    <span class="hljs-comment">//åˆå§‹åŒ– mINotifyFd</span>
    mINotifyFd = <span class="hljs-built_in">inotify_init1</span>(IN_CLOEXEC);
    <span class="hljs-comment">//å¯¹dev/input ç›®å½•ä¸‹æ–‡ä»¶çš„å¢åˆ è¿›è¡Œç›‘æ§</span>
    if (std::filesystem::exists(DEVICE_INPUT_PATH, errorCode)) {
        <span class="hljs-built_in">addDeviceInputInotify</span>();<span class="hljs-comment">//æ³¨é‡Š4</span>
    } else {
        <span class="hljs-built_in">addDeviceInotify</span>();
    }
    ...
    struct epoll_event eventItem = {};
    eventItem<span class="hljs-selector-class">.events</span> = EPOLLIN | EPOLLWAKEUP;
    eventItem<span class="hljs-selector-class">.data</span><span class="hljs-selector-class">.fd</span> = mINotifyFd;
    <span class="hljs-comment">//FD ç›‘å¬</span>
    int result = <span class="hljs-built_in">epoll_ctl</span>(mEpollFd, EPOLL_CTL_ADD, mINotifyFd, &amp;eventItem);<span class="hljs-comment">//æ³¨é‡Š5</span>
}
void EventHub::<span class="hljs-built_in">addDeviceInputInotify</span>() {
    mDeviceInputWd = <span class="hljs-built_in">inotify_add_watch</span>(mINotifyFd, DEVICE_INPUT_PATH, IN_DELETE | IN_CREATE);
}
void EventHub::<span class="hljs-built_in">addDeviceInotify</span>() {
    mDeviceWd = <span class="hljs-built_in">inotify_add_watch</span>(mINotifyFd, DEVICE_PATH, IN_DELETE | IN_CREATE);
}
</code></pre>
<ul>
<li><strong>æ³¨é‡Š4</strong> è¿™é‡Œä¸»è¦æ˜¯ç›‘å¬ dev/input ç›®å½•ä¸‹æ–‡ä»¶çš„å¢åˆ ï¼Œä¹Ÿå°±æ˜¯ç›‘å¬æ–°å¢å’Œç§»é™¤è¾“å…¥è®¾å¤‡ï¼Œæœ‰æ–°çš„è¾“å…¥è®¾å¤‡æ—¶è¿™é‡Œå°±ä¼šæ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œåˆ é™¤è®¾å¤‡æ—¶è¿™é‡Œå°±ä¼šç§»é™¤ä¸€ä¸ªå¯¹åº”çš„æ–‡ä»¶ã€‚é€šè¿‡æŒ‡ä»¤<code>adb shell --su --getevent -p </code>å¯ä»¥è·å–è®¾å¤‡dev/input/ç›®å½•ä¸‹çš„è¾“å…¥è®¾å¤‡åŠä¿¡æ¯,é€šè¿‡<code>adb shell -- su -- getevent -lt /dev/input/event1</code>å¯ä»¥ç›‘å¬å¯¹åº”è¾“å…¥è®¾å¤‡çš„æ‰€æœ‰äº‹ä»¶ï¼Œå½“ç›‘å¬çš„ä¸ºè§¦æ‘¸å±æ—¶ï¼ŒæŒ‰å‹æ»‘åŠ¨å±å¹•æ—¶å°±ä¼šçœ‹åˆ°è§¦æ‘¸åŸå§‹æ•°æ®ã€‚mEpollFdä¹Ÿä¼šç›‘å¬è¿™ä¸ªåŸå§‹æ•°æ®ï¼Œè¿™ä¸ªä¸‹é¢ä¼šè®²åˆ°ã€‚</li>
<li><strong>æ³¨é‡Š5</strong> è¿™é‡Œåˆ™æ˜¯epollç›‘å¬ï¼ŒmEpollFdæ·»åŠ å¯¹mINotifyFdçš„ç›‘å¬ï¼Œç›‘å¬çš„äº‹ä»¶åˆ™æ˜¯EPOLLIN | EPOLLWAKEUP
ä¹Ÿå°±æ˜¯å½“æœ‰æ–°çš„è¾“å…¥è®¾å¤‡åŠ å…¥æ—¶ï¼Œé©±åŠ¨ä¼šåœ¨dev/inputä¸‹é¢æ–°å»ºä¸€ä¸ªæ–‡ä»¶(ç”¨æ¥å­˜å‚¨äº‹ä»¶æ•°æ®),æ–°å»ºæ–‡ä»¶æ—¶ï¼Œå°±ä¼šé€šçŸ¥åˆ°mINotifyFdé€šçŸ¥åˆ°mEpollFdï¼ŒmEpollFdçš„epoll_waitå°±ä¼šæ”¶åˆ°äº‹ä»¶è¢«å”¤é†’ã€‚androidç³»ç»Ÿæºç åŸºæœ¬åˆ°å¤„å¯ä»¥çœ‹åˆ°å¯¹epollçš„ä½¿ï¼Œå¯¹epollæœºåˆ¶ä¸ç†Ÿæ‚‰çš„å¯ä»¥å‚è€ƒ<a href="https://juejin.cn/post/7591338980693655598" target="_blank" title="https://juejin.cn/post/7591338980693655598">Androidç³»ç»Ÿä¸‹Looperæ·±åº¦è§£æåŠæ— å¤„ä¸åœ¨çš„epoll</a>.</li>
</ul>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬é‡ç‚¹åˆ†æ EventHub::getEvents æ–¹æ³•</p>
<pre><code class="hljs language-scss" lang="scss">frameworks/native/services/inputflinger/reader/EventHub<span class="hljs-selector-class">.cpp</span>
std::vector&lt;RawEvent&gt; EventHub::<span class="hljs-built_in">getEvents</span>(int timeoutMillis) {
    std::scoped_lock <span class="hljs-built_in">_l</span>(mLock);

    std::array&lt;input_event, EVENT_BUFFER_SIZE&gt; readBuffer;

    std::vector&lt;RawEvent&gt; events;
    bool awoken = false;
    for (;;) { <span class="hljs-comment">//å¾ªç¯1</span>
        ...
        <span class="hljs-comment">// Report any devices that had last been added/removed.</span>
        for (auto it = mClosingDevices.begin(); it != mClosingDevices<span class="hljs-selector-class">.end</span>();) {
            std::unique_ptr&lt;Device&gt; device = std::<span class="hljs-built_in">move</span>(*it);
            <span class="hljs-built_in">ALOGV</span>("Reporting device closed: id=%d, name=%s\n", device-&gt;id, device-&gt;path.c_str());
            const int32_t deviceId = (device-&gt;id == mBuiltInKeyboardId)
                    ? ReservedInputDeviceId::BUILT_IN_KEYBOARD_ID
                    : device-&gt;id;
            <span class="hljs-comment">//æ·»åŠ è®¾å¤‡ç§»é™¤äº‹ä»¶</span>
            events<span class="hljs-selector-class">.push_back</span>({
                    .when = now,
                    .deviceId = deviceId,
                    .type = DEVICE_REMOVED,
            });<span class="hljs-comment">//æ³¨é‡Š6</span>
            it = mClosingDevices<span class="hljs-selector-class">.erase</span>(it);
            if (events.size() == EVENT_BUFFER_SIZE) {
                break;
            }
        }

        if (mNeedToScanDevices) { <span class="hljs-comment">//æ„é€ åˆå§‹åŒ–çš„æ—¶å€™mNeedToScanDeviceså°±æ˜¯true</span>
            mNeedToScanDevices = false;
            <span class="hljs-comment">//ç¬¬ä¸€æ¬¡è¿›æ¥æ¯”èµ°åˆ°è¿™é‡Œï¼Œç›‘å¬å·²æœ‰çš„è®¾å¤‡</span>
            <span class="hljs-built_in">scanDevicesLocked</span>();<span class="hljs-comment">//æ³¨é‡Š7</span>
        }
        ...
        while (!mOpeningDevices.empty()) {
            std::unique_ptr&lt;Device&gt; device = std::<span class="hljs-built_in">move</span>(*mOpeningDevices.<span class="hljs-built_in">rbegin</span>());
            mOpeningDevices<span class="hljs-selector-class">.pop_back</span>();
            <span class="hljs-built_in">ALOGV</span>("Reporting device opened: id=%d, name=%s\n", device-&gt;id, device-&gt;path.c_str());
            const int32_t deviceId = device-&gt;id == mBuiltInKeyboardId ? <span class="hljs-number">0</span> : device-&gt;id;
            <span class="hljs-comment">//æ·»åŠ æ–°å¢è®¾å¤‡äº‹ä»¶</span>
            events<span class="hljs-selector-class">.push_back</span>({
                    .when = now,
                    .deviceId = deviceId,
                    .type = DEVICE_ADDED,
            });<span class="hljs-comment">//æ³¨é‡Š8</span>
            ...

            auto <span class="hljs-selector-attr">[dev_it, inserted]</span> = mDevices<span class="hljs-selector-class">.insert_or_assign</span>(device-&gt;id, std::move(device));
            ...
            if (events.size() == EVENT_BUFFER_SIZE) {
                break;
            }
        }

        <span class="hljs-comment">// Grab the next input event.</span>
        bool deviceChanged = false;
        while (mPendingEventIndex &lt; mPendingEventCount) { <span class="hljs-comment">//å¾ªç¯2</span>
            const struct epoll_event&amp; eventItem = mPendingEventItems<span class="hljs-selector-attr">[mPendingEventIndex++]</span>;
            if (eventItem.data.fd == mINotifyFd) { 
                if (eventItem.events &amp; EPOLLIN) {
                    <span class="hljs-comment">//æœ‰å¢åˆ è¾“å…¥è®¾å¤‡æ—¶</span>
                    mPendingINotify = true;<span class="hljs-comment">//æ³¨é‡Š9</span>
                } else {
                    <span class="hljs-built_in">ALOGW</span>("Received unexpected epoll event <span class="hljs-number">0</span>x%<span class="hljs-number">08</span>x for INotify.", eventItem.events);
                }
                continue;
            }

            ...

            Device* device = <span class="hljs-built_in">getDeviceByFdLocked</span>(eventItem.data.fd);

            ...
            <span class="hljs-comment">// This must be an input event</span>
            <span class="hljs-comment">// è¿™é‡Œçš„éƒ½æ˜¯äº‹ä»¶æ•°æ®äº†</span>
            if (eventItem.events &amp; EPOLLIN) {
                int32_t readSize =
                        <span class="hljs-built_in">read</span>(device-&gt;fd, readBuffer.data(),
                             <span class="hljs-built_in">sizeof</span>(decltype(readBuffer)::value_type) * readBuffer.<span class="hljs-built_in">size</span>());
                ...
                const int32_t deviceId = device-&gt;id == mBuiltInKeyboardId ? <span class="hljs-number">0</span> : device-&gt;id;

                const size_t count = <span class="hljs-built_in">size_t</span>(readSize) / <span class="hljs-built_in">sizeof</span>(struct input_event);
                for (size_t i = <span class="hljs-number">0</span>; i &lt; count; i++) {
                    struct input_event&amp; iev = readBuffer<span class="hljs-selector-attr">[i]</span>;
                    device-&gt;<span class="hljs-built_in">trackInputEvent</span>(iev);
                    <span class="hljs-comment">//æ·»åŠ äº‹ä»¶åŸå§‹æ•°æ®</span>
                    events<span class="hljs-selector-class">.push_back</span>({
                            .when = processEventTimestamp(iev),
                            <span class="hljs-selector-class">.readTime</span> = <span class="hljs-built_in">systemTime</span>(SYSTEM_TIME_MONOTONIC),
                            <span class="hljs-selector-class">.deviceId</span> = deviceId,
                            <span class="hljs-selector-class">.type</span> = iev<span class="hljs-selector-class">.type</span>,
                            <span class="hljs-selector-class">.code</span> = iev<span class="hljs-selector-class">.code</span>,
                            <span class="hljs-selector-class">.value</span> = iev<span class="hljs-selector-class">.value</span>,
                    });<span class="hljs-comment">//æ³¨é‡Š10</span>
                }
                ...
            }
        }
        ...
        <span class="hljs-comment">// æœ‰å¢åˆ è¾“å…¥è®¾å¤‡</span>
        if (mPendingINotify &amp;&amp; mPendingEventIndex &gt;= mPendingEventCount) {
            mPendingINotify = false;
            const auto res = <span class="hljs-built_in">readNotifyLocked</span>();<span class="hljs-comment">//æ³¨é‡Š11</span>
            deviceChanged = true;
        }
        if (deviceChanged) {
            continue;
        }
        if (!events.empty() || awoken) {
            break;
        }

        ...

        mPendingEventIndex = <span class="hljs-number">0</span>;
        mLock<span class="hljs-selector-class">.unlock</span>(); <span class="hljs-comment">// release lock before poll</span>
        <span class="hljs-comment">//ç›‘å¬è¾“å…¥äº‹ä»¶(æ–°å¢è®¾å¤‡ï¼Œåˆ é™¤è®¾å¤‡ï¼Œè®¾å¤‡è¾“å…¥äº‹ä»¶)</span>
        int pollResult = <span class="hljs-built_in">epoll_wait</span>(mEpollFd, mPendingEventItems, EPOLL_MAX_EVENTS, timeoutMillis);<span class="hljs-comment">//æ³¨é‡Š12</span>
        mLock<span class="hljs-selector-class">.lock</span>(); <span class="hljs-comment">// reacquire lock after poll</span>

         ...
        <span class="hljs-comment">// Some events occurred.</span>
        mPendingEventCount = <span class="hljs-built_in">size_t</span>(pollResult);
    }

    <span class="hljs-comment">// All done, return the number of events we read.</span>
    return events;
}
</code></pre>
<p>è¿™é‡Œçš„ä»£ç æ¯”è¾ƒé•¿ï¼Œé‡ç‚¹åˆ†æä¸€ä¸‹æœ‰æ³¨é‡Šçš„åœ°æ–¹</p>
<ul>
<li><strong>æ³¨é‡Š7</strong> æ‰«ædev/input/ç›®å½•ä¸‹ç›®å‰å·²æœ‰çš„è®¾å¤‡æ–‡ä»¶ï¼Œæ·»åŠ å¯¹è®¾å¤‡è¾“å…¥äº‹ä»¶æ–‡ä»¶fd çš„ç›‘å¬ï¼Œåˆ›å»ºè®¾å¤‡Device,å¹¶æ ¹æ®é…ç½®ä¿¡æ¯è®¾ç½®Deviceæ”¯æŒçš„classesï¼Œç³»ç»Ÿæ‰€æœ‰çš„classeséƒ½å®šä¹‰åœ¨ InputDeviceClass æšä¸¾ä¸­
(<code>frameworks/native/services/inputflinger/reader/include/EventHub.h é‡Œçš„ enum class InputDeviceClass</code>),å†æ·»åŠ è®¾å¤‡ä¿¡æ¯Deviceåˆ° mOpeningDevices é˜Ÿåˆ—ä¸­ï¼Œä¸»è¦è°ƒç”¨é€»è¾‘å¦‚ä¸‹</li>
</ul>

<pre><code class="hljs language-rust" lang="rust">frameworks/native/services/inputflinger/reader/EventHub.cpp
void EventHub::<span class="hljs-title function_ invoke__">scanDevicesLocked</span>() {
    ...
    <span class="hljs-comment">//åˆ¤æ–­ dev/inputç›®å½•æ˜¯å¦å­˜åœ¨</span>
    <span class="hljs-title function_ invoke__">if</span> (std::filesystem::<span class="hljs-title function_ invoke__">exists</span>(DEVICE_INPUT_PATH, errorCode)) {
        result = <span class="hljs-title function_ invoke__">scanDirLocked</span>(DEVICE_INPUT_PATH);
    }
    ...
}

status_t EventHub::<span class="hljs-title function_ invoke__">scanDirLocked</span>(<span class="hljs-keyword">const</span> std::string&amp; dirname) {
    <span class="hljs-comment">//éå†ç›®å½•å¯¹å·²å­˜åœ¨è®¾å¤‡æ–‡ä»¶</span>
    <span class="hljs-title function_ invoke__">for</span> (<span class="hljs-keyword">const</span> auto&amp; entry : std::filesystem::<span class="hljs-title function_ invoke__">directory_iterator</span>(dirname)) {
        <span class="hljs-title function_ invoke__">openDeviceLocked</span>(entry.<span class="hljs-title function_ invoke__">path</span>());
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}

void EventHub::<span class="hljs-title function_ invoke__">openDeviceLocked</span>(<span class="hljs-keyword">const</span> std::string&amp; devicePath) {
    ...
    int fd = <span class="hljs-title function_ invoke__">open</span>(devicePath.<span class="hljs-title function_ invoke__">c_str</span>(), O_RDWR | O_CLOEXEC | O_NONBLOCK);<span class="hljs-comment">//è·å–è®¾å¤‡æ–‡ä»¶çš„fd</span>
    ...
     std::unique_ptr&lt;Device&gt; device =
    std::make_unique&lt;Device&gt;(fd, deviceId, devicePath, identifier,
                             <span class="hljs-title function_ invoke__">obtainAssociatedDeviceLocked</span>(devicePath));
     ...
     <span class="hljs-comment">//æ·»åŠ é”®ç›˜äº‹ä»¶çš„è®¾å¤‡æ”¯æŒ</span>
   <span class="hljs-comment">//See if this is a device with keys</span>
    <span class="hljs-title function_ invoke__">if</span> (haveKeyboardKeys || haveGamepadButtons || haveStylusButtons) {
        device<span class="hljs-punctuation">-&gt;</span>classes |= InputDeviceClass::KEYBOARD;
    }
    <span class="hljs-comment">//æ·»åŠ è§¦æ‘¸äº‹ä»¶çš„æ”¯æŒ</span>
    <span class="hljs-comment">// See if this is a touch pad.</span>
    <span class="hljs-comment">// Is this a new modern multi-touch driver?</span>
    <span class="hljs-title function_ invoke__">if</span> (device<span class="hljs-punctuation">-&gt;</span>absBitmask.<span class="hljs-title function_ invoke__">test</span>(ABS_MT_POSITION_X) &amp;&amp; device<span class="hljs-punctuation">-&gt;</span>absBitmask.<span class="hljs-title function_ invoke__">test</span>(ABS_MT_POSITION_Y)) {
        <span class="hljs-comment">// Some joysticks such as the PS3 controller report axes that conflict</span>
        <span class="hljs-comment">// with the ABS_MT range.  Try to confirm that the device really is</span>
        <span class="hljs-comment">// a touch screen.</span>
        <span class="hljs-title function_ invoke__">if</span> (device<span class="hljs-punctuation">-&gt;</span>keyBitmask.<span class="hljs-title function_ invoke__">test</span>(BTN_TOUCH) || !haveGamepadButtons) {
            device<span class="hljs-punctuation">-&gt;</span>classes |= (InputDeviceClass::TOUCH | InputDeviceClass::TOUCH_MT);
            <span class="hljs-title function_ invoke__">if</span> (device<span class="hljs-punctuation">-&gt;</span>propBitmask.<span class="hljs-title function_ invoke__">test</span>(INPUT_PROP_POINTER) &amp;&amp;
                !device<span class="hljs-punctuation">-&gt;</span>keyBitmask.<span class="hljs-title function_ invoke__">any</span>(BTN_TOOL_PEN, BTN_TOOL_FINGER) &amp;&amp; !haveStylusButtons) {
                device<span class="hljs-punctuation">-&gt;</span>classes |= InputDeviceClass::TOUCHPAD;
            }
        }
        <span class="hljs-comment">// Is this an old style single-touch driver?</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-title function_ invoke__">if</span> (device<span class="hljs-punctuation">-&gt;</span>keyBitmask.<span class="hljs-title function_ invoke__">test</span>(BTN_TOUCH) &amp;&amp; device<span class="hljs-punctuation">-&gt;</span>absBitmask.<span class="hljs-title function_ invoke__">test</span>(ABS_X) &amp;&amp;
               device<span class="hljs-punctuation">-&gt;</span>absBitmask.<span class="hljs-title function_ invoke__">test</span>(ABS_Y)) {
        device<span class="hljs-punctuation">-&gt;</span>classes |= InputDeviceClass::TOUCH;
        <span class="hljs-comment">// Is this a stylus that reports contact/pressure independently of touch coordinates?</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-title function_ invoke__">if</span> ((device<span class="hljs-punctuation">-&gt;</span>absBitmask.<span class="hljs-title function_ invoke__">test</span>(ABS_PRESSURE) || device<span class="hljs-punctuation">-&gt;</span>keyBitmask.<span class="hljs-title function_ invoke__">test</span>(BTN_TOUCH)) &amp;&amp;
               !device<span class="hljs-punctuation">-&gt;</span>absBitmask.<span class="hljs-title function_ invoke__">test</span>(ABS_X) &amp;&amp; !device<span class="hljs-punctuation">-&gt;</span>absBitmask.<span class="hljs-title function_ invoke__">test</span>(ABS_Y)) {
        device<span class="hljs-punctuation">-&gt;</span>classes |= InputDeviceClass::EXTERNAL_STYLUS;
    }
    ...
    <span class="hljs-comment">//mEpollFdæ·»åŠ å¯¹è®¾å¤‡æ–‡ä»¶fdçš„ç›‘å¬ï¼Œç›‘å¬è®¾å¤‡äº‹ä»¶çš„è¾“å…¥</span>
    <span class="hljs-title function_ invoke__">if</span> (<span class="hljs-title function_ invoke__">registerDeviceForEpollLocked</span>(*device) != OK) {
        <span class="hljs-keyword">return</span>;
    }
    ...
    <span class="hljs-comment">//æ·»åŠ è®¾å¤‡åˆ° mOpeningDevices</span>
    <span class="hljs-title function_ invoke__">addDeviceLocked</span>(std::<span class="hljs-title function_ invoke__">move</span>(device));
}


status_t EventHub::<span class="hljs-title function_ invoke__">registerDeviceForEpollLocked</span>(Device&amp; device) {
    status_t result = <span class="hljs-title function_ invoke__">registerFdForEpoll</span>(device.fd);
    ...
    <span class="hljs-keyword">return</span> result;
}

status_t EventHub::<span class="hljs-title function_ invoke__">registerFdForEpoll</span>(int fd) {
    <span class="hljs-comment">// TODO(b/121395353) - consider adding EPOLLRDHUP</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">epoll_event</span> eventItem = {};
    eventItem.events = EPOLLIN | EPOLLWAKEUP;
    eventItem.data.fd = fd;
    <span class="hljs-comment">//æ·»åŠ å¯¹ è®¾å¤‡è¾“å…¥æ–‡ä»¶æè¿°ç¬¦Fdçš„ç›‘æ§ï¼Œå½“è¯¥è®¾å¤‡æœ‰æ–°äº‹ä»¶è¾“å…¥æ—¶ï¼Œå°±ä¼šå”¤é†’epoll_wait(mEpollFd...)</span>
    <span class="hljs-title function_ invoke__">if</span> (<span class="hljs-title function_ invoke__">epoll_ctl</span>(mEpollFd, EPOLL_CTL_ADD, fd, &amp;eventItem)) {
        <span class="hljs-keyword">return</span> -errno;
    }
    <span class="hljs-keyword">return</span> OK;
}
</code></pre>
<p>è¿™æ ·å½“å½“å‰è®¾å¤‡å¦‚æœæœ‰è¾“å…¥äº‹ä»¶æ—¶ï¼Œå°±ä¼šå”¤é†’ <code>æ³¨é‡Š12</code>å¤„çš„epoll_wait.</p>
<ul>
<li><strong>æ³¨é‡Š12</strong> æ·»åŠ å¯¹mEpollFdçš„ç›‘å¬ï¼Œç›‘å¬mEpollFdçš„å”¤é†’äº‹ä»¶ï¼Œè€Œé€šè¿‡ä¸Šé¢ <code>æ³¨é‡Š7</code>å’Œ<code>æ³¨é‡Š5</code>æ·»åŠ åˆ°mEpollFdçš„fdéƒ½ä¼šè¢«ç›‘æ§åˆ°ï¼Œä¹Ÿå°±æ˜¯ dev/inputä¸‹æœ‰å¢åˆ æ–‡ä»¶(å¢åˆ è¾“å…¥è®¾å¤‡)å’Œæ–‡ä»¶è¾“å…¥(è®¾å¤‡è¾“å…¥äº‹ä»¶)éƒ½ä¼šè¢«ç›‘æ§åˆ°ã€‚åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±æ‹æ¸…äº†æ•´ä¸ªè¾“å…¥äº‹ä»¶çš„ç›‘å¬. epoll_waitä¼šä¸€ç›´é˜»å¡åœ¨è¿™é‡Œï¼Œæœ‰è¾“å…¥è®¾å¤‡å¢åˆ å’Œäº‹ä»¶è¾“å…¥æ—¶éƒ½ä¼šå”¤é†’<code>æ³¨é‡Š12</code>è¿™é‡Œçš„é€»è¾‘ï¼Œæ¥ä¸‹æ¥å°±åˆ†åˆ«å¯¹è®¾å¤‡å¢åˆ äº‹ä»¶å’Œè¾“å…¥äº‹ä»¶çš„æµç¨‹è¿›è¡Œåˆ†æã€‚</li>
</ul>
<h4 data-id="heading-4">3.1.1å¢åˆ è®¾å¤‡äº‹ä»¶çš„è¯»å–</h4>
<p>è®¾å¤‡å¢åˆ ä¸»è¦æ¶‰åŠåˆ° <code>æ³¨é‡Š6ã€æ³¨é‡Š8ã€æ³¨é‡Š9ã€æ³¨é‡Š11</code>ï¼Œå½“æœ‰å¢åˆ è®¾å¤‡æ—¶ï¼Œé¦–å…ˆå”¤é†’äº†<code>æ³¨é‡Š12</code>ï¼Œç„¶åè¿›å…¥åˆ°ä¸‹ä¸€ä¸ªforå¾ªç¯(<code>å¾ªç¯1</code>)ï¼Œæ­¤æ—¶ä¸ä¼šå…ˆèµ°åˆ°<code>æ³¨é‡Š6ã€æ³¨é‡Š8</code>ï¼Œå› ä¸ºæ­¤æ—¶çš„mClosingDeviceså’ŒmOpeningDeviceséƒ½æ˜¯ç©ºçš„ï¼Œä¼šå…ˆæ‰§è¡Œåˆ°whileå¾ªç¯(<code>å¾ªç¯2</code>)ï¼Œå› ä¸ºæ˜¯å¢åˆ è®¾å¤‡ï¼Œæ‰€ä»¥ä¼š æ»¡è¶³ eventItem.data.fd == mINotifyFd å’Œ eventItem.events &amp; EPOLLINï¼Œè¿™æ ·å°±ä¼šæ‰§è¡Œåˆ°<code>æ³¨é‡Š9</code>ï¼Œç„¶åæŒ‘å‡ºwhileå¾ªç¯(<code>å¾ªç¯2</code>)ï¼Œæ­¤æ—¶å°±ä¼šæ‰§è¡Œåˆ°<code>æ³¨é‡Š11</code>.</p>
<ul>
<li><strong>æ³¨é‡Š11</strong> å¤„ç†è®¾å¤‡å¢åˆ é€»è¾‘ï¼Œå½“æœ‰è®¾å¤‡æ–°å¢æ—¶å¤„ç†æµç¨‹å’Œ<code>æ³¨é‡Š7</code>ç±»ä¼¼ï¼Œæ·»åŠ å¯¹è®¾å¤‡è¾“å…¥äº‹ä»¶æ–‡ä»¶fd çš„ç›‘å¬ï¼ŒåŒæ—¶æ·»åŠ è®¾å¤‡ä¿¡æ¯åˆ° mOpeningDevices é˜Ÿåˆ—ä¸­ã€‚ç§»é™¤è®¾å¤‡æ—¶ï¼Œç§»é™¤å¯¹è®¾å¤‡è¾“å…¥äº‹ä»¶æ–‡ä»¶fdçš„ç›‘å¬ï¼ŒåŒäº‹æ·»åŠ è®¾å¤‡ä¿¡æ¯åˆ° mClosingDevices é˜Ÿåˆ—ä¸­ã€‚å…·ä½“è°ƒç”¨é€»è¾‘å¦‚ä¸‹</li>
</ul>

<pre><code class="hljs language-c" lang="c">frameworks/native/services/inputflinger/reader/EventHub.cpp
base::Result&lt;<span class="hljs-type">void</span>&gt; <span class="hljs-title function_">EventHub::readNotifyLocked</span><span class="hljs-params">()</span> {
    ...
    <span class="hljs-keyword">do</span> {
        sizeRead = read(mINotifyFd, eventBuffer, <span class="hljs-keyword">sizeof</span>(eventBuffer));
    } <span class="hljs-keyword">while</span> (sizeRead &lt; <span class="hljs-number">0</span> &amp;&amp; errno == EINTR);
    ...
    <span class="hljs-keyword">for</span> (<span class="hljs-type">ssize_t</span> eventPos = <span class="hljs-number">0</span>; sizeRead &gt;= EVENT_SIZE;) {
        ...
        handleNotifyEventLocked(*event);
        ...
    }
    <span class="hljs-keyword">return</span> {};
}

<span class="hljs-type">void</span> <span class="hljs-title function_">EventHub::handleNotifyEventLocked</span><span class="hljs-params">(<span class="hljs-type">const</span> inotify_event&amp; event)</span> {
    <span class="hljs-keyword">if</span> (event.wd == mDeviceInputWd) {
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> filename = <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>(DEVICE_INPUT_PATH) + <span class="hljs-string">"/"</span> + event.name;
        <span class="hljs-keyword">if</span> (event.mask &amp; IN_CREATE) {
            openDeviceLocked(filename);<span class="hljs-comment">//æ·»åŠ è®¾å¤‡</span>
        } <span class="hljs-keyword">else</span> {
            closeDeviceByPathLocked(filename);<span class="hljs-comment">//ç§»é™¤è®¾å¤‡</span>
        }
    } 
    ...
}
</code></pre>
<p>åˆ°è¿™é‡Œå¢åˆ äº‹ä»¶è¯»å–å®Œæ¯•åï¼Œå°±ä¼šæ·»åŠ åˆ° mOpeningDevices æˆ– mClosingDevicesä¸­äº†ï¼Œæ­¤æ—¶å°±ä¼šç«‹é©¬åˆ°ä¸‹ä¸€ä¸ªforå¾ªç¯(<code>å¾ªç¯1</code>),ç„¶åæ‰§è¡Œåˆ°<code>æ³¨é‡Š6æˆ–æ³¨é‡Š8</code></p>
<ul>
<li><strong>æ³¨é‡Š6</strong> æ·»åŠ è®¾å¤‡ç§»é™¤äº‹ä»¶åˆ°eventsåˆ—è¡¨ä¸­</li>
<li><strong>æ³¨é‡Š8</strong> æ·»åŠ è®¾å¤‡æ–°å¢äº‹ä»¶åˆ°eventsåˆ—è¡¨ä¸­</li>
</ul>
<h4 data-id="heading-5">3.1.2è®¾å¤‡è¾“å…¥äº‹ä»¶çš„è¯»å–</h4>
<p>æ¥ç€<code>æ³¨é‡Š12</code>åˆ†æï¼Œä¸Šä¸€å°èŠ‚ä¸»è¦åˆ†æäº†è®¾å¤‡æ–°å¢å’Œåˆ é™¤æ—¶æ—¶é—´çš„è¯»å–ï¼Œå¦‚æœæ˜¯è®¾å¤‡æ–°å¢æ—¶ï¼Œè¿˜ä¼šå¯¹æ–°å¢è®¾å¤‡æ–‡ä»¶fdè¿›è¡Œç›‘å¬ï¼Œå½“è¯¥è®¾å¤‡æœ‰è¾“å…¥äº‹ä»¶æ—¶ä¹Ÿä¼šå”¤é†’<code>æ³¨é‡Š12</code>çš„epoll_wait,å”¤é†’ä¹‹åï¼Œä¹Ÿæ˜¯è¿›å…¥åˆ°ä¸‹ä¸€ä¸ªforå¾ªç¯(<code>å¾ªç¯1</code>)ï¼Œå¹¶ç›´æ¥è¿›å…¥åˆ°whileå¾ªç¯(<code>å¾ªç¯2</code>),è·³è¿‡ä¸€äº›é€»è¾‘æ‰§è¡Œåˆ°<code>æ³¨é‡Š10</code></p>
<ul>
<li><strong>æ³¨é‡Š10</strong> æ·»åŠ è®¾å¤‡è¾“å…¥äº‹ä»¶åˆ°eventsåˆ—è¡¨ä¸­</li>
</ul>
<p>è¿™æ ·è®¾å¤‡è¾“å…¥äº‹ä»¶(å¢ã€åˆ ã€è¾“å…¥)å°±è¯»å–å®Œå¹¶æ·»åŠ åˆ°eventsä¸­ï¼Œäº‹ä»¶è¯»å–å®Œå…¨åœ¨EventHub::getEvents()ä¸­è¿›è¡Œï¼Œè¯¥æ–¹æ³•æ˜¯é˜»å¡ï¼Œæ²¡æœ‰è¾“å…¥äº‹ä»¶æ—¶ä¼šä¸€ç›´é˜»å¡åœ¨epoll_waitå¤„(<code>æ³¨é‡Š12</code>)ï¼Œ æ‰§è¡Œåœ¨InputReaderçš„InputThreadä¸­ï¼Œå½“è¯»å–å®Œä¸€ç»„äº‹ä»¶å’Œå¤„ç†åï¼Œåˆä¼šè¿›å…¥åˆ°ä¸‹ä¸€ä¸ªè¯»å–æµç¨‹ä¸­ï¼Œè¿™æ ·åªè¦æœ‰æ–°äº‹ä»¶äº§ç”Ÿå°±ä¼šå”¤é†’EventHubå°†äº‹ä»¶ä¼ é€’ç»™InputReaderè¿›è¡Œåç»­å¤„ç†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åˆ†æä¸‹InputReaderè¯»å–äº‹ä»¶çš„åç»­æµç¨‹ã€‚</p>
<h3 data-id="heading-6">3.2 InputReader ç»„è£…äº‹ä»¶æ•°æ®</h3>
<p>å‰ä¸€ç« èŠ‚æˆ‘ä»¬å·²ç»é€šè¿‡EventHub--&gt;getEvents()è·å–åˆ°è¾“å…¥äº‹ä»¶çš„åŸå§‹æ•°æ®ï¼Œè¿™é‡Œçš„äº‹ä»¶æ•°æ®ä¸»è¦åˆ†ä¸ºä¸‰å¤§ç±»ï¼Œæ–°å¢è¾“å…¥è®¾å¤‡ï¼Œåˆ é™¤è¾“å…¥è®¾å¤‡ï¼Œè¾“å…¥è®¾å¤‡è¾“å…¥äº‹ä»¶ã€‚ç»„è£…äº‹ä»¶ä¸»è¦ç”±InputReader::processEventsLocked()å¼€å§‹è¿›è¡Œçš„ã€‚</p>
<pre><code class="hljs language-rust" lang="rust">frameworks/native/services/inputflinger/reader/InputReader.cpp
std::list&lt;NotifyArgs&gt; InputReader::<span class="hljs-title function_ invoke__">processEventsLocked</span>(<span class="hljs-keyword">const</span> RawEvent* rawEvents, size_t count) {
    std::list&lt;NotifyArgs&gt; out;
    <span class="hljs-title function_ invoke__">for</span> (<span class="hljs-keyword">const</span> RawEvent* rawEvent = rawEvents; count;) {
        int32_t <span class="hljs-keyword">type</span> = rawEvent<span class="hljs-punctuation">-&gt;</span><span class="hljs-keyword">type</span>;
        ...
        <span class="hljs-title function_ invoke__">if</span> (<span class="hljs-keyword">type</span> &lt; EventHubInterface::FIRST_SYNTHETIC_EVENT) {
            ...
            <span class="hljs-comment">//å°è£…è¾“å…¥è®¾å¤‡çš„è¾“å…¥äº‹ä»¶</span>
            out += <span class="hljs-title function_ invoke__">processEventsForDeviceLocked</span>(deviceId, rawEvent, batchSize);<span class="hljs-comment">//æ³¨é‡Š13</span>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-title function_ invoke__">switch</span> (rawEvent<span class="hljs-punctuation">-&gt;</span><span class="hljs-keyword">type</span>) {
                case EventHubInterface::DEVICE_ADDED:
                    <span class="hljs-comment">//æ–°å¢è¾“å…¥è®¾å¤‡</span>
                    <span class="hljs-title function_ invoke__">addDeviceLocked</span>(rawEvent<span class="hljs-punctuation">-&gt;</span>when, rawEvent<span class="hljs-punctuation">-&gt;</span>deviceId);<span class="hljs-comment">//æ³¨é‡Š14</span>
                    <span class="hljs-keyword">break</span>;
                case EventHubInterface::DEVICE_REMOVED:
                    <span class="hljs-comment">//åˆ é™¤è¾“å…¥è®¾å¤‡</span>
                    <span class="hljs-title function_ invoke__">removeDeviceLocked</span>(rawEvent<span class="hljs-punctuation">-&gt;</span>when, rawEvent<span class="hljs-punctuation">-&gt;</span>deviceId);<span class="hljs-comment">//æ³¨é‡Š15</span>
                    <span class="hljs-keyword">break</span>;
                default:
                    <span class="hljs-title function_ invoke__">ALOG_ASSERT</span>(<span class="hljs-literal">false</span>); <span class="hljs-comment">// can't happen</span>
                    <span class="hljs-keyword">break</span>;
            }
        }
        ...
    }
    <span class="hljs-keyword">return</span> out;
}
</code></pre>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¾“å…¥è®¾å¤‡æ–°å¢åˆ é™¤äº‹ä»¶å’Œè¾“å…¥è®¾å¤‡è¾“å…¥äº‹ä»¶æ•°æ®å°è£…æµç¨‹è¿›è¡Œåˆ†æ</p>
<h4 data-id="heading-7">3.2.1 InputReader å¢åˆ è¾“å…¥è®¾å¤‡</h4>
<ul>
<li><strong>æ³¨é‡Š14</strong> æ–°å¢è¾“å…¥è®¾å¤‡æ—¶ï¼Œåç»­æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹</li>
</ul>
<pre><code class="hljs language-c" lang="c">frameworks/native/services/inputflinger/reader/InputReader.cpp
<span class="hljs-type">void</span> <span class="hljs-title function_">InputReader::addDeviceLocked</span><span class="hljs-params">(<span class="hljs-type">nsecs_t</span> when, <span class="hljs-type">int32_t</span> eventHubId)</span> {
    ...
    InputDeviceIdentifier identifier = mEventHub-&gt;getDeviceIdentifier(eventHubId);
    <span class="hljs-comment">//æ ¹æ®æ–°å¢è®¾å¤‡çš„ä¿¡æ¯åˆ›é€  InputDevice</span>
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;InputDevice&gt; device = createDeviceLocked(when, eventHubId, identifier);

    mPendingArgs += device-&gt;configure(when, mConfig, <span class="hljs-comment">/*changes=*/</span>{});
    mPendingArgs += device-&gt;reset(when);
    ...
    <span class="hljs-comment">//æ·»åŠ åˆ° é”®å€¼å¯¹é›†åˆ mDevices ä¸­</span>
    mDevices.emplace(eventHubId, device);
    ...
}

<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;InputDevice&gt; <span class="hljs-title function_">InputReader::createDeviceLocked</span><span class="hljs-params">(
        <span class="hljs-type">nsecs_t</span> when, <span class="hljs-type">int32_t</span> eventHubId, <span class="hljs-type">const</span> InputDeviceIdentifier&amp; identifier)</span> {
    <span class="hljs-keyword">auto</span> deviceIt = <span class="hljs-built_in">std</span>::find_if(mDevices.begin(), mDevices.end(), [identifier](<span class="hljs-keyword">auto</span>&amp; devicePair) {
        <span class="hljs-type">const</span> InputDeviceIdentifier identifier2 =
                devicePair.second-&gt;getDeviceInfo().getIdentifier();
        <span class="hljs-keyword">return</span> isSubDevice(identifier, identifier2);
    });

    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;InputDevice&gt; device;
    <span class="hljs-keyword">if</span> (deviceIt != mDevices.end()) {
        device = deviceIt-&gt;second;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-type">int32_t</span> deviceId = (eventHubId &lt; END_RESERVED_ID) ? eventHubId : nextInputDeviceIdLocked();
        <span class="hljs-comment">//æ„é€ InputDevice</span>
        device = <span class="hljs-built_in">std</span>::make_shared&lt;InputDevice&gt;(&amp;mContext, deviceId, bumpGenerationLocked(),
                                               identifier);
    }
    <span class="hljs-comment">//å°†æ–°å¢è®¾å¤‡çš„äº‹ä»¶æ•°æ®è¿›è¡Œå°è£…ï¼Œå¹¶æ·»åŠ åˆ° é›†åˆ mPendingArgs ä¸­</span>
    mPendingArgs += device-&gt;addEventHubDevice(when, eventHubId, mConfig);<span class="hljs-comment">//</span>
    <span class="hljs-keyword">return</span> device;
}

frameworks/native/services/inputflinger/reader/InputDevice.cpp
[[nodiscard]] <span class="hljs-built_in">std</span>::<span class="hljs-built_in">list</span>&lt;NotifyArgs&gt; <span class="hljs-title function_">InputDevice::addEventHubDevice</span><span class="hljs-params">(
        <span class="hljs-type">nsecs_t</span> when, <span class="hljs-type">int32_t</span> eventHubId, <span class="hljs-type">const</span> InputReaderConfiguration&amp; readerConfig)</span> {
    
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">list</span>&lt;NotifyArgs&gt; out = configureInternal(when, readerConfig, {}, <span class="hljs-comment">/*forceEnable=*/</span><span class="hljs-literal">true</span>);

    DevicePair&amp; devicePair = mDevices[eventHubId];
    <span class="hljs-comment">//æ ¹æ®Deviceçš„æ”¯æŒçš„classesåˆ›å»ºå¯¹åº”çš„InputMapper</span>
    devicePair.second = createMappers(*devicePair.first, readerConfig);

    <span class="hljs-comment">// Must change generation to flag this device as changed</span>
    bumpGeneration();
    <span class="hljs-keyword">return</span> out;
}

<span class="hljs-comment">//æ ¹æ®classesåˆ›å»ºå¯¹åº”InputMapper</span>
<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">unique_ptr</span>&lt;InputMapper&gt;&gt; InputDevice::createMappers(
        InputDeviceContext&amp; contextPtr, <span class="hljs-type">const</span> InputReaderConfiguration&amp; readerConfig) {
    ftl::Flags&lt;InputDeviceClass&gt; classes = contextPtr.getDeviceClasses();
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">unique_ptr</span>&lt;InputMapper&gt;&gt; mappers;
    ...
    <span class="hljs-comment">// Keyboard-like devices.</span>
    <span class="hljs-type">uint32_t</span> keyboardSource = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (classes.test(InputDeviceClass::KEYBOARD)) {
        keyboardSource |= AINPUT_SOURCE_KEYBOARD;
    }
    ...
    <span class="hljs-comment">// Touchscreens and touchpad devices.</span>
    <span class="hljs-keyword">if</span> (classes.test(InputDeviceClass::TOUCHPAD) &amp;&amp; classes.test(InputDeviceClass::TOUCH_MT)) {
        mappers.push_back(createInputMapper&lt;TouchpadInputMapper&gt;(contextPtr, readerConfig));
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (classes.test(InputDeviceClass::TOUCH_MT)) {
        mappers.push_back(createInputMapper&lt;MultiTouchInputMapper&gt;(contextPtr, readerConfig));
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (classes.test(InputDeviceClass::TOUCH)) {
        mappers.push_back(createInputMapper&lt;SingleTouchInputMapper&gt;(contextPtr, readerConfig));
    }
    ...
    <span class="hljs-keyword">return</span> mappers;
}


</code></pre>
<p>è¿™é‡Œä¸»è¦æ˜¯æ ¹æ®åŸå§‹æ•°æ®çš„deviceIdè·å–EventHubä¸­åˆ›å»ºçš„Deviceï¼Œå†æ ¹æ®Deviceçš„æ•°æ®åˆ›å»ºInputDeviceï¼Œå†æ ¹æ®Deviceçš„classes(enum InputDeviceClass)åˆ›å»ºå½“å‰è®¾å¤‡InputDeviceå…³è”çš„æ•°æ®å°è£…InputMapperç±»(è¿™é‡Œçš„InputDeviceClasså’ŒInputMapperæ˜¯å¤šå¯¹ä¸€çš„å…³ç³»,å¸¸è§çš„InputMapperçš„æœ‰KeyBoardInputMapper, TouchpadInputMapper,TouchInputMapperç­‰)ï¼Œå¹¶å°†InputDeviceå’ŒInputMapper æ·»åŠ åˆ°mDeviceä¸­ï¼Œä¾›åç»­æ•°æ®å°è£…æ—¶ä½¿ç”¨ã€‚æœ€åå°†æ·»åŠ è®¾å¤‡æ•°æ®å°è£…æˆNotifyArgs ä¾›åç»­ä½¿ç”¨ã€‚</p>
<ul>
<li><strong>æ³¨é‡Š15</strong> åˆ é™¤è¾“å…¥è®¾å¤‡æ—¶ï¼Œåç»­æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹</li>
</ul>
<pre><code class="hljs language-ini" lang="ini">frameworks/native/services/inputflinger/reader/InputReader.cpp
void InputReader::removeDeviceLocked(nsecs_t when, int32_t eventHubId) {
    auto <span class="hljs-attr">deviceIt</span> = mDevices.find(eventHubId)<span class="hljs-comment">;</span>
    if (<span class="hljs-attr">deviceIt</span> == mDevices.end()) {
        ALOGW("Ignoring spurious device removed event for eventHubId %d.", eventHubId)<span class="hljs-comment">;</span>
        return<span class="hljs-comment">;</span>
    }

    std::shared_ptr&lt;InputDevice&gt; <span class="hljs-attr">device</span> = std::move(deviceIt-&gt;second)<span class="hljs-comment">;</span>
    mDevices.erase(deviceIt)<span class="hljs-comment">;</span>
    // Erase device from device to EventHub ids map.
    auto <span class="hljs-attr">mapIt</span> = mDeviceToEventHubIdsMap.find(device)<span class="hljs-comment">;</span>
    if (mapIt != mDeviceToEventHubIdsMap.end()) {
        std::vector&lt;int32_t&gt;&amp; <span class="hljs-attr">eventHubIds</span> = mapIt-&gt;second<span class="hljs-comment">;</span>
        std::erase_if(eventHubIds, <span class="hljs-section">[eventHubId]</span>(int32_t eId) { return <span class="hljs-attr">eId</span> == eventHubId<span class="hljs-comment">; });</span>
        if (eventHubIds.size() == 0) {
            mDeviceToEventHubIdsMap.erase(mapIt)<span class="hljs-comment">;</span>
        }
    }
    device-&gt;removeEventHubDevice(eventHubId)<span class="hljs-comment">;</span>

    if (device-&gt;getClasses().test(InputDeviceClass::EXTERNAL_STYLUS)) {
        notifyExternalStylusPresenceChangedLocked()<span class="hljs-comment">;</span>
    }

    if (device-&gt;hasEventHubDevices()) {
        mPendingArgs += device-&gt;configure(when, mConfig, /*<span class="hljs-attr">changes</span>=*/{})<span class="hljs-comment">;</span>
    }
    mPendingArgs += device-&gt;reset(when)<span class="hljs-comment">;</span>
}

</code></pre>
<p>åˆ é™¤è®¾å¤‡æ—¶ä¸»è¦æ˜¯ä» é”®å€¼å¯¹é›†åˆmDevicesä¸­ç§»é™¤ deviceï¼Œä»mDeviceToEventHubIdsMap ä¸­ç§»é™¤mapperï¼ŒåŒæ—¶å°†åˆ é™¤è®¾å¤‡äº‹ä»¶å°è£…æˆæ•°æ®NotifyArgs ä¾›åç»­ä½¿ç”¨ã€‚</p>
<h4 data-id="heading-8">3.2.2 InputReader å°è£…è¾“å…¥è®¾å¤‡è¾“å…¥äº‹ä»¶</h4>
<p>æ–°å¢å®Œè®¾å¤‡åï¼Œå½“è®¾å¤‡æœ‰äº‹ä»¶è¾“å…¥æ—¶ï¼Œé€»è¾‘å°±ä¼šèµ°åˆ°<code>æ³¨é‡Š13</code>è¿™é‡Œï¼Œ</p>
<ul>
<li><strong>æ³¨é‡Š13</strong> è¾“å…¥äº‹ä»¶åŸå§‹æ•°æ®å°è£…çš„æ ¸å¿ƒé€»è¾‘ä»£ç å¦‚ä¸‹ï¼š</li>
</ul>
<pre><code class="hljs language-rust" lang="rust">frameworks/native/services/inputflinger/reader/InputReader.cpp
std::list&lt;NotifyArgs&gt; InputReader::<span class="hljs-title function_ invoke__">processEventsForDeviceLocked</span>(int32_t eventHubId,
                                                                <span class="hljs-keyword">const</span> RawEvent* rawEvents,
                                                                size_t count) {
    auto deviceIt = mDevices.<span class="hljs-title function_ invoke__">find</span>(eventHubId);
    ...
    std::shared_ptr&lt;InputDevice&gt;&amp; device = deviceIt<span class="hljs-punctuation">-&gt;</span>second;
    ...
    <span class="hljs-keyword">return</span> device<span class="hljs-punctuation">-&gt;</span><span class="hljs-title function_ invoke__">process</span>(rawEvents, count);
}

frameworks/native/services/inputflinger/reader/InputDevice.cpp
std::list&lt;NotifyArgs&gt; InputDevice::<span class="hljs-title function_ invoke__">process</span>(<span class="hljs-keyword">const</span> RawEvent* rawEvents, size_t count) {
    <span class="hljs-comment">// Process all of the events in order for each mapper.</span>
    <span class="hljs-comment">// We cannot simply ask each mapper to process them in bulk because mappers may</span>
    <span class="hljs-comment">// have side-effects that must be interleaved.  For example, joystick movement events and</span>
    <span class="hljs-comment">// gamepad button presses are handled by different mappers but they should be dispatched</span>
    <span class="hljs-comment">// in the order received.</span>
    std::list&lt;NotifyArgs&gt; out;
    <span class="hljs-title function_ invoke__">for</span> (<span class="hljs-keyword">const</span> RawEvent* rawEvent = rawEvents; count != <span class="hljs-number">0</span>; rawEvent++) {
        <span class="hljs-title function_ invoke__">if</span> (mDropUntilNextSync) {
            <span class="hljs-title function_ invoke__">if</span> (rawEvent<span class="hljs-punctuation">-&gt;</span><span class="hljs-keyword">type</span> == EV_SYN &amp;&amp; rawEvent<span class="hljs-punctuation">-&gt;</span>code == SYN_REPORT) {
                out += <span class="hljs-title function_ invoke__">reset</span>(rawEvent<span class="hljs-punctuation">-&gt;</span>when);
                mDropUntilNextSync = <span class="hljs-literal">false</span>;
                <span class="hljs-title function_ invoke__">ALOGD_IF</span>(<span class="hljs-title function_ invoke__">debugRawEvents</span>(), <span class="hljs-string">"Recovered from input event buffer overrun."</span>);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-title function_ invoke__">ALOGD_IF</span>(<span class="hljs-title function_ invoke__">debugRawEvents</span>(),
                         <span class="hljs-string">"Dropped input event while waiting for next input sync."</span>);
            }
        } <span class="hljs-keyword">else</span> <span class="hljs-title function_ invoke__">if</span> (rawEvent<span class="hljs-punctuation">-&gt;</span><span class="hljs-keyword">type</span> == EV_SYN &amp;&amp; rawEvent<span class="hljs-punctuation">-&gt;</span>code == SYN_DROPPED) {
            <span class="hljs-title function_ invoke__">ALOGI</span>(<span class="hljs-string">"Detected input event buffer overrun for device %s."</span>, <span class="hljs-title function_ invoke__">getName</span>().<span class="hljs-title function_ invoke__">c_str</span>());
            mDropUntilNextSync = <span class="hljs-literal">true</span>;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">//éå†InputDeviceæ‰€æœ‰çš„mapperï¼Œä¸²è¡Œå¯¹åŸå§‹äº‹ä»¶è¿›è¡Œå°è£…å¤„ç†</span>
            <span class="hljs-title function_ invoke__">for_each_mapper_in_subdevice</span>(rawEvent<span class="hljs-punctuation">-&gt;</span>deviceId, [&amp;](InputMapper&amp; mapper) {
                out += mapper.<span class="hljs-title function_ invoke__">process</span>(*rawEvent);<span class="hljs-comment">//æ³¨é‡Š16</span>
            });
        }
        --count;
    }
    <span class="hljs-comment">//æ›´æ–°äº‹ä»¶çš„ policy flags</span>
    <span class="hljs-title function_ invoke__">postProcess</span>(out);
    <span class="hljs-keyword">return</span> out;
}

</code></pre>
<p>è¿™é‡Œé¦–å…ˆæ˜¯åœ¨ä¹‹å‰æ·»åŠ è®¾å¤‡(<code>æ³¨é‡Š14</code>)æ—¶æ›´æ–°çš„mDevicesä¸­æ‰¾åˆ°å½“å‰è¾“å…¥äº‹ä»¶å¯¹åº”çš„è®¾å¤‡InputDeviceï¼Œå†éå†å½“å‰InputDeviceçš„æ‰€æœ‰InputMapperï¼Œä¸²è¡Œçš„å¯¹æ•°æ®è¿›è¡Œprocesså¤„ç†</p>
<ul>
<li><strong>æ³¨é‡Š16</strong>æ ¹æ®ä¸åŒçš„ç¡¬ä»¶è¾“å…¥è®¾å¤‡æœ‰ä¸åŒçš„æ•°æ®æ ¼å¼ï¼Œè¿™é‡Œåˆ©ç”¨å„ç§è¾“å…¥è®¾å¤‡å¯¹åº”çš„InputMapperå¯¹åŸå§‹çš„æ•°æ®æ ¼å¼å°è£…ï¼Œå°è£…æˆä¾¿äºåç»­åˆ†å‘å¤„ç†çš„NotifyArgs</li>
</ul>
<p>åˆ°è¿™é‡ŒInputReaderå°±å®Œæˆäº†å¯¹åŸå§‹è¾“å…¥äº‹ä»¶çš„ç»„è£…ï¼Œç»Ÿä¸€ç»„è£…æˆNotifyArgsï¼Œé‡Œé¢åŒ…å«å„ç§è¾“å…¥è®¾å¤‡åç»­åˆ†å‘éœ€è¦çš„æ•°æ®ã€‚æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹InputReaderå¯¹NotifyArgsæ•°æ®çš„é¢„åˆ†å‘ã€‚</p>
<h3 data-id="heading-9">3.3 InputReaderçš„é¢„åˆ†å‘æ•°æ®</h3>
<p>å‰é¢ä¸¤ä¸ªç« èŠ‚å·²ç»åˆ†æäº†InputReader::loopOnceä¸­çš„åŸå§‹äº‹ä»¶çš„è¯»å–å’Œå°è£…ï¼Œæ¥ä¸‹æ¥çœ‹ä¸€ä¸‹å¯¹äº‹ä»¶çš„é¢„åˆ†å‘ï¼Œé¢„åˆ†å‘æµç¨‹å¼€å§‹äº<code>æ³¨é‡Š3</code>,è¿™é‡Œéå†æ‰€æœ‰äº‹ä»¶ç„¶åè°ƒç”¨ <code> mNextListener.notify(args)</code> å»åˆ†å‘äº‹ä»¶ã€‚è€Œè¿™é‡Œçš„ mNextListener æ­£æ˜¯ InputReaderä¸­çš„æ„é€ å‡½æ•°ä¸­ä¼ é€’è¿‡æ¥çš„ï¼Œè€ŒInputReaderæ˜¯åœ¨InputManagerä¸­åˆå§‹åŒ–ï¼Œæˆ‘ä»¬å†å›åˆ°InputManagerçš„åˆå§‹åŒ–ä»£ç </p>
<pre><code class="hljs language-ini" lang="ini">frameworks/native/services/inputflinger/InputManager.cpp
InputManager::InputManager(const sp&lt;InputReaderPolicyInterface&gt;&amp; readerPolicy,
                           InputDispatcherPolicyInterface&amp; dispatcherPolicy,
                           PointerChoreographerPolicyInterface&amp; choreographerPolicy,
                           InputFilterPolicyInterface&amp; inputFilterPolicy) {
    <span class="hljs-attr">mInputFlingerRust</span> = createInputFlingerRust()<span class="hljs-comment">;</span>

    <span class="hljs-attr">mDispatcher</span> = createInputDispatcher(dispatcherPolicy)<span class="hljs-comment">;</span>
    //å¾€mTracingStagesåˆ—è¡¨ä¸­æ·»åŠ  InputDispatcher çš„listener
    mTracingStages.emplace_back(
            std::make_unique&lt;TracedInputListener&gt;("InputDispatcher", *mDispatcher))<span class="hljs-comment">;</span>

    if (ENABLE_INPUT_FILTER_RUST) {
        <span class="hljs-attr">mInputFilter</span> = std::make_unique&lt;InputFilter&gt;(*mTracingStages.back(), *mInputFlingerRust,
                                                     inputFilterPolicy)<span class="hljs-comment">;</span>
        mTracingStages.emplace_back(
                std::make_unique&lt;TracedInputListener&gt;("InputFilter", *mInputFilter))<span class="hljs-comment">;</span>
    }

    if (ENABLE_INPUT_DEVICE_USAGE_METRICS) {
        <span class="hljs-attr">mCollector</span> = std::make_unique&lt;InputDeviceMetricsCollector&gt;(*mTracingStages.back())<span class="hljs-comment">;</span>
        mTracingStages.emplace_back(
                std::make_unique&lt;TracedInputListener&gt;("MetricsCollector", *mCollector))<span class="hljs-comment">;</span>
    }

    <span class="hljs-attr">mProcessor</span> = std::make_unique&lt;InputProcessor&gt;(*mTracingStages.back())<span class="hljs-comment">;</span>
    mTracingStages.emplace_back(
            std::make_unique&lt;TracedInputListener&gt;("InputProcessor", *mProcessor))<span class="hljs-comment">;</span>

    <span class="hljs-attr">mChoreographer</span> =
            std::make_unique&lt;PointerChoreographer&gt;(*mTracingStages.back(), choreographerPolicy)<span class="hljs-comment">;</span>
    mTracingStages.emplace_back(
            std::make_unique&lt;TracedInputListener&gt;("PointerChoreographer", *mChoreographer))<span class="hljs-comment">;</span>

    <span class="hljs-attr">mBlocker</span> = std::make_unique&lt;UnwantedInteractionBlocker&gt;(*mTracingStages.back())<span class="hljs-comment">;</span>
    mTracingStages.emplace_back(
            std::make_unique&lt;TracedInputListener&gt;("UnwantedInteractionBlocker", *mBlocker))<span class="hljs-comment">;</span>
    
    //æ„é€ æ—¶ä¼ å…¥äº†æœ€åä¸€ä¸ª TracedInputListener çš„å®ç°ç±»UnwantedInteractionBlocker å¯¹è±¡
    <span class="hljs-attr">mReader</span> = createInputReader(readerPolicy, *mTracingStages.back())<span class="hljs-comment">;//æ³¨é‡Š17</span>
}
</code></pre>
<p>é˜…è¯»æºç ä¸éš¾å‘ç°è¿™é‡Œæ„é€ äº†å¥½å‡ ä¸ª TracedInputListener å¯¹è±¡ï¼ŒInputDispatcher åˆ™ä½œä¸ºç¬¬ä¸€ä¸ªlistenerå‹å…¥åˆ°åˆ—è¡¨mTracingStagesæœ€å‰é¢äº†ï¼Œè€Œæ¯ä¸€ä¸ªlisteneréƒ½æŒæœ‰åˆ—è¡¨mTracingStagesä¸­å‰ä¸€ä¸ªlistenerçš„å¼•ç”¨ã€‚</p>
<ul>
<li><strong>æ³¨é‡Š17</strong> æ„é€  InputReaderæ—¶ä¼ å…¥çš„åˆ™æ˜¯åˆ—è¡¨mTracingStagesçš„æœ€åä¸€ä¸ªlistener(UnwantedInteractionBlocker)ï¼Œè¿™æ ·ç¬¬ä¸€ä¸ªæ‹¿åˆ°äº‹ä»¶çš„ç±»ä¾¿æ˜¯ UnwantedInteractionBlockerç±»ã€‚</li>
</ul>
<p>ä¸‹é¢éƒ½ä»¥äº‹ä»¶ NotifyMotionArgs æ¥åˆ†æã€‚<code>mNextListener.notify(args)</code>ä¸‹ä¸€æ­¥ä¾¿ä¼šå»æ‰§è¡Œ <code>UnwantedInteractionBlocker::notifyMotion(args);</code>æµç¨‹äº†ã€‚å…¶å®è¿™é‡Œçš„ æ¯ä¸ªTracedInputListener å¤„ç†å®Œäº‹ä»¶åéƒ½ä¼šä¼ é€’åˆ°å‰ä¸€ä¸ª TracedInputListenerï¼Œ  æœ€ç»ˆéƒ½ä¼šä¼ é€’åˆ°InputDispatcherä¸­ï¼Œè§¦æ‘¸äº‹ä»¶å°±ä¼šä¼ é€’åˆ° <code>InputDispatcher::notifyMotion(args)</code>,InputDispatcherå‰é¢çš„ TracedInputListeneræœ‰çš„ä¼šå¯¹æ•°æ®è¿›è¡Œé¢„åŠ å·¥ï¼Œæœ‰çš„åˆ™è´Ÿè´£æ•°æ®ç»Ÿè®¡ï¼Œè¿™é‡Œä¸å±•å¼€åˆ†æï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è‡ªè¡Œé˜…è¯»æºç ã€‚</p>
<p>åº•å±‚äº‹ä»¶è¯»å–å’Œä¸ŠæŠ¥åˆ°InputDispatcheræµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3997aa4cc8294cbd8ceb9865e022aca6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2FycnlaaGFuZw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768135397&amp;x-signature=j6s4NFgt1bbvn%2FTzy%2FDJ21CsiLI%3D" alt="image.png" loading="lazy"/></p>
<p>æ­¤æ—¶InputReaderæ•°æ®çš„é¢„åˆ†å‘ä»»åŠ¡åŸºæœ¬å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥é‡ç‚¹åˆ†æ<code>InputDispatcher::notifyMotion(args)</code></p>
<h2 data-id="heading-10">4.InputDispatcheräº‹ä»¶åˆ†å‘</h2>
<p>InputDispatcheræ¥å—åˆ°InputReaderçš„è¾“å…¥äº‹ä»¶åï¼Œä¼šé¦–å…ˆåˆ¤æ–­æ—¶é—´æ˜¯å¦éœ€è¦æ‹¦æˆªï¼Œç„¶åå°†äº‹ä»¶å­˜å‚¨åˆ° mInboundQueue ä¸­ï¼Œå†é€šè¿‡  <code>mLooper-&gt;wake()</code> å”¤é†’é˜»å¡çš„ loopOnce è·å– mInboundQueue ä¸­çš„äº‹ä»¶è¿›è¡Œåˆ†å‘ã€‚</p>
<h3 data-id="heading-11">4.1 InputDispatcher äº‹ä»¶æ¥å—ã€æ‹¦æˆªåŠå…¥åˆ—</h3>
<pre><code class="hljs language-arduino" lang="arduino">frameworks/native/services/inputflinger/dispatcher/InputDispatcher.<span class="hljs-function">cpp
<span class="hljs-type">status_t</span> <span class="hljs-title">InputDispatcher::start</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">if</span> (mThread) {
        <span class="hljs-keyword">return</span> ALREADY_EXISTS;
    }
    <span class="hljs-comment">//å¼€å§‹loopOnceçš„æ­»å¾ªç¯</span>
    mThread = std::<span class="hljs-built_in">make_unique</span>&lt;InputThread&gt;(
            <span class="hljs-string">"InputDispatcher"</span>, [<span class="hljs-keyword">this</span>]() { <span class="hljs-built_in">dispatchOnce</span>(); }, [<span class="hljs-keyword">this</span>]() { mLooper-&gt;<span class="hljs-built_in">wake</span>(); });<span class="hljs-comment">//æ³¨é‡Š18</span>
    <span class="hljs-keyword">return</span> OK;
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">InputDispatcher::dispatchOnce</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">nsecs_t</span> nextWakeupTime = LLONG_MAX;
    { <span class="hljs-comment">// acquire lock</span>
         ...
        <span class="hljs-comment">// Run a dispatch loop if there are no pending commands.</span>
        <span class="hljs-comment">// The dispatch loop might enqueue commands to run afterwards.</span>
        <span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦æœ‰æ²¡å¤„ç†å®Œçš„æŒ‡ä»¤</span>
        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">haveCommandsLocked</span>()) { <span class="hljs-comment">//æ³¨é‡Š19</span>
            <span class="hljs-comment">//åˆ†å‘äº‹ä»¶åˆ°åº”ç”¨</span>
            <span class="hljs-built_in">dispatchOnceInnerLocked</span>(<span class="hljs-comment">/*byref*/</span> nextWakeupTime); <span class="hljs-comment">//æ³¨é‡Š 20</span>
        }
        ...
        <span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦anräº†</span>
        <span class="hljs-type">const</span> <span class="hljs-type">nsecs_t</span> nextAnrCheck = <span class="hljs-built_in">processAnrsLocked</span>(); <span class="hljs-comment">// æ³¨é‡Š21</span>
        ...
    } <span class="hljs-comment">// release lock</span>
    ...
    <span class="hljs-type">int</span> timeoutMillis = <span class="hljs-built_in">toMillisecondTimeoutDelay</span>(currentTime, nextWakeupTime);
    <span class="hljs-comment">//ä¼šä¸€ç›´é˜»å¡ï¼Œç›´åˆ°ç›‘å¬æœ‰æ•°æ®æ›´æ–°æˆ–è€…è°ƒç”¨mLooper-&gt;wake</span>
    mLooper-&gt;<span class="hljs-built_in">pollOnce</span>(timeoutMillis);<span class="hljs-comment">//æ³¨é‡Š22</span>
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">InputDispatcher::notifyMotion</span><span class="hljs-params">(<span class="hljs-type">const</span> NotifyMotionArgs&amp; args)</span> </span>{
    ...

    <span class="hljs-type">uint32_t</span> policyFlags = args.policyFlags;
    policyFlags |= POLICY_FLAG_TRUSTED;
    <span class="hljs-comment">// è®¾ç½® policyFlags æ ‡è®°,åŒæ—¶åˆ¤æ–­æ˜¯å¦éœ€è¦æ‹¦æˆªäº‹ä»¶</span>
    mPolicy.<span class="hljs-built_in">interceptMotionBeforeQueueing</span>(args.displayId, args.source, args.action, args.eventTime,
                                          policyFlags);<span class="hljs-comment">//æ³¨é‡Š23</span>
    

    <span class="hljs-type">bool</span> needWake = <span class="hljs-literal">false</span>;
    { <span class="hljs-comment">// acquire lock</span>
        mLock.<span class="hljs-built_in">lock</span>();
       

        <span class="hljs-comment">// Just enqueue a new motion event.</span>
        <span class="hljs-comment">//æ•°æ®åˆå§‹åŒ–</span>
        std::unique_ptr&lt;MotionEntry&gt; newEntry =
                std::<span class="hljs-built_in">make_unique</span>&lt;MotionEntry&gt;(args.id, <span class="hljs-comment">/*injectionState=*/</span><span class="hljs-literal">nullptr</span>, args.eventTime,
                                              args.deviceId, args.source, args.displayId,
                                              policyFlags, args.action, args.actionButton,
                                              args.flags, args.metaState, args.buttonState,
                                              args.classification, args.edgeFlags, args.xPrecision,
                                              args.yPrecision, args.xCursorPosition,
                                              args.yCursorPosition, args.downTime,
                                              args.pointerProperties, args.pointerCoords);
       
        <span class="hljs-comment">//æ·»åŠ æ•°æ®åˆ° mInboundQueue ä¸­</span>
        needWake = <span class="hljs-built_in">enqueueInboundEventLocked</span>(std::<span class="hljs-built_in">move</span>(newEntry)); <span class="hljs-comment">//æ³¨é‡Š24</span>
        mLock.<span class="hljs-built_in">unlock</span>();
    } <span class="hljs-comment">// release lock</span>

    <span class="hljs-keyword">if</span> (needWake) {
        <span class="hljs-comment">//å”¤é†’mLooper::pollOnce</span>
        mLooper-&gt;<span class="hljs-built_in">wake</span>();<span class="hljs-comment">//æ³¨é‡Š25</span>
    }
}

<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">InputDispatcher::enqueueInboundEventLocked</span><span class="hljs-params">(std::unique_ptr&lt;EventEntry&gt; newEntry)</span> </span>{
    <span class="hljs-type">bool</span> needWake = mInboundQueue.<span class="hljs-built_in">empty</span>();
    mInboundQueue.<span class="hljs-built_in">push_back</span>(std::<span class="hljs-built_in">move</span>(newEntry));<span class="hljs-comment">//æ³¨é‡Š26</span>
    ...
    <span class="hljs-keyword">return</span> needWake;
}

</code></pre>
<p>åœ¨IMSåˆå§‹åŒ–çš„æ—¶å€™æ˜¯å…ˆè°ƒç”¨<code>InputDispatcher::start()</code>,å†è°ƒç”¨<code>InputReader::start(),InputReader::start()</code>æµç¨‹å‰é¢å·²ç»åˆ†æäº†ï¼Œè¿™é‡Œä» <code>InputDispatcher::start()</code> å¼€å§‹åˆ†æ</p>
<ul>
<li><strong>æ³¨é‡Š18</strong> è¿™é‡Œä¹Ÿæ˜¯æ–°èµ·äº†ä¸€ä¸ªInputThreadï¼Œå¹¶ä¸”å¼€å§‹äº†dispatchOnceçš„æ­»å¾ªç¯ï¼ŒdispatchOnceæ¯æ¬¡æ‰§è¡Œå®Œéƒ½ä¼šé˜»å¡åœ¨<code>æ³¨é‡Š22</code>ç­‰å¾…è¢«å”¤é†’ä»è€Œè¿›è¡Œä¸‹ä¸€ä¸ª dispatchOnce</li>
</ul>
<p>æ ¹æ®ç¬¬3ç« èŠ‚çš„åˆ†æï¼Œå½“InputReaderè¯»å–åˆ°äº‹ä»¶åï¼Œå°±ä¼šè°ƒç”¨åˆ°InputDispatcher::notifyXXX æ¥åˆ†å‘äº‹ä»¶ï¼Œä¸‹é¢è¿˜æ˜¯ä»¥ NotifyMotionArgs ä¸ºä¾‹ï¼Œæ­¤æ—¶ä¼šè°ƒç”¨ <code>InputDispatcher::notifyMotion</code>ï¼Œè¿™ä¸ªæ–¹æ³• ä¸»è¦æ˜¯åˆå§‹åŒ–äº‹ä»¶ï¼Œè®¾ç½®äº‹ä»¶æ ‡è®°ï¼Œå°†äº‹ä»¶æ·»åŠ åˆ° <code>InputDispatcher::mInboundQueue</code>ä¸­ï¼ŒåŒæ—¶å”¤é†’<code>mLooper::loopOnce</code></p>
<ul>
<li><strong>æ³¨é‡Š23</strong> ç»™äº‹ä»¶çš„ policyFlags è®¾ç½®æ ‡è®°å’Œæ‹¦æˆªäº‹ä»¶ï¼Œè¿™é‡Œé‡ç‚¹å…³æ³¨çš„æ ‡è®°æ—¶ POLICY_FLAG_PASS_TO_USER å’Œ ~POLICY_FLAG_PASS_TO_USER,è¿™ä¸¤ä¸ªè¡¨ç¤ºæ˜¯å¦éœ€è¦ä¼ é€’ç»™ç”¨æˆ·ï¼Œè¿™ä¸ªåç»­ä¼šç”¨åˆ°ï¼Œäº‹ä»¶æ‹¦æˆªä¸»è¦æ˜¯é€šè¿‡IMSçš„ interceptXXXBeforeQueueingåˆ°<code>PhoneWindowManager.interceptXXXBeforeQueueing</code>,æ¯”å¦‚æˆ‘ä»¬çš„å¼€æœºé”®/å…³æœºé”®/éŸ³é‡é”®ç­‰æŒ‰é”®äº‹ä»¶å¤§éƒ¨åˆ†æ˜¯ä¼šè¢«ç³»ç»Ÿæ‹¦æˆªæ‰çš„ï¼Œè¿˜æœ‰åœ¨æŸäº›æƒ…å†µä¸‹æœ‰äº›äº‹ä»¶ä¹Ÿä¼šè¢«ç›´æ¥æ‹¦æˆªæ‰ï¼Œè¿™ä¸ªå¤§å®¶å¯ä»¥è‡ªè¡Œé˜…è¯» <code>PhoneWindowManager.interceptXXXBeforeQueueing</code>æ–¹æ³•ã€‚</li>
<li><strong>æ³¨é‡Š24 æ³¨é‡Š26</strong> å°†äº‹ä»¶MotionEntryæ·»åŠ æ·»åŠ åˆ° <code>InputDispatcher::mInboundQueue</code>ä¸­</li>
<li><strong>æ³¨é‡Š25</strong> æ ¹æ®Looperçš„åŸç†ï¼Œæ­¤å¤„ä¼šå”¤é†’ <code>æ³¨é‡Š22</code>çš„é˜»å¡ï¼Œä½¿ dispatchOnce ç»§ç»­æ‰§è¡Œä¸‹å»</li>
</ul>
<h3 data-id="heading-12">4.2 InputDispatcher äº‹ä»¶å‡ºåˆ—åˆ†å‘</h3>
<p>æ­¤æ—¶æˆ‘ä»¬å†å›åˆ° dispatchOnce æ‰§è¡Œä¸‹ä¸€ä¸ªåˆ†å‘ï¼Œè¿™é‡Œä¸»è¦æ˜¯</p>
<ul>
<li><strong>æ³¨é‡Š19</strong> æ£€æŸ¥ mCommandQueue é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºæ—¶ï¼Œæ‰ä¼šå‘ä¸‹åˆ†å‘æ•°æ®ï¼Œä¸ä¸ºç©ºæ—¶ï¼Œä¼šè·³è¿‡è¿™æ¬¡dispatchOnceçš„åˆ†å‘</li>
<li><strong>æ³¨é‡Š20</strong> åˆ†å‘æ•°æ®åˆ°åº”ç”¨</li>
</ul>

<pre><code class="hljs language-c" lang="c">frameworks/native/services/inputflinger/dispatcher/InputDispatcher.cpp
<span class="hljs-type">void</span> <span class="hljs-title function_">InputDispatcher::dispatchOnceInnerLocked</span><span class="hljs-params">(<span class="hljs-type">nsecs_t</span>&amp; nextWakeupTime)</span> {
    <span class="hljs-type">nsecs_t</span> currentTime = now();


    <span class="hljs-comment">// Ready to start a new event.</span>
    <span class="hljs-comment">// If we don't already have a pending event, go grab one.</span>
    <span class="hljs-keyword">if</span> (!mPendingEvent) {
        <span class="hljs-keyword">if</span> (mInboundQueue.empty()) {
          
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// Inbound queue has at least one entry.</span>
            <span class="hljs-comment">// ä» mInboundQueue å‰é¢ç§»é™¤</span>
            mPendingEvent = mInboundQueue.front();
            mInboundQueue.pop_front();<span class="hljs-comment">//æ³¨é‡Š27</span>
            traceInboundQueueLengthLocked();
        }

        <span class="hljs-comment">// Poke user activity for this event.</span>
        <span class="hljs-keyword">if</span> (mPendingEvent-&gt;policyFlags &amp; POLICY_FLAG_PASS_TO_USER) {
            <span class="hljs-comment">//é€šçŸ¥PowerManagerServiceä¸è¦ç†„å±</span>
            pokeUserActivityLocked(*mPendingEvent);<span class="hljs-comment">//æ³¨é‡Š28</span>
        }
    }

    <span class="hljs-comment">// Now we have an event to dispatch.</span>
    <span class="hljs-comment">// All events are eventually dequeued and processed this way, even if we intend to drop them.</span>
    ALOG_ASSERT(mPendingEvent != nullptr);
    <span class="hljs-type">bool</span> done = <span class="hljs-literal">false</span>;
    <span class="hljs-comment">//å®šä¹‰äº†ä¸¢å¼ƒåŸå› ï¼Œå¦‚æœæ²¡æœ‰ä¼ é€’ç»™åº”ç”¨ï¼Œå°±æ˜¯ä¸¢å¼ƒäº†ï¼Œç³»ç»Ÿå¯¹ä¸åŒäº‹ä»¶æœ‰ä¸åŒçš„ä¸¢å¼ƒè§„åˆ™ï¼Œå†³å®šæ˜¯å¦ä¼ é€’ç»™åº”ç”¨</span>
    DropReason dropReason = DropReason::NOT_DROPPED;
    

    <span class="hljs-keyword">switch</span> (mPendingEvent-&gt;type) {
       ...
       <span class="hljs-comment">//è§¦æ‘¸äº‹ä»¶</span>
        <span class="hljs-keyword">case</span> EventEntry::Type::MOTION: {
            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;<span class="hljs-type">const</span> MotionEntry&gt; motionEntry =
                    <span class="hljs-built_in">std</span>::static_pointer_cast&lt;<span class="hljs-type">const</span> MotionEntry&gt;(mPendingEvent);
            ...
            done = dispatchMotionLocked(currentTime, motionEntry, &amp;dropReason, nextWakeupTime);<span class="hljs-comment">//æ³¨é‡Š29</span>
            <span class="hljs-keyword">break</span>;
        }
       ...
    }

    <span class="hljs-keyword">if</span> (done) {
        <span class="hljs-comment">//åˆ†å‘æˆåŠŸ</span>
        ...
    }
}
</code></pre>
<ul>
<li><strong>æ³¨é‡Š27</strong> ä» mInboundQueue(InputReaderä¼ é€’è¿‡æ¥æ—¶ä¼šå­˜å‚¨åˆ°è¿™é‡Œ) é˜Ÿåˆ—ä¸­ç§»é™¤æ•°æ®</li>
<li><strong>æ³¨é‡Š28</strong> é€šè¿‡IMSé€šçŸ¥PowerManagerServiceå¤„ç†ç›¸å…³é€»è¾‘(ä¸è¦ç†„å±ç­‰)</li>
<li><strong>æ³¨é‡Š29</strong> åˆ†å‘è§¦æ‘¸äº‹ä»¶ï¼Œé¦–å…ˆæ‰¾åˆ°äº‹ä»¶å…³è”çš„çª—å£ï¼Œç„¶åå†è¿›è¡Œäº‹ä»¶åˆ†å‘</li>
</ul>
<pre><code class="hljs language-ini" lang="ini">frameworks/native/services/inputflinger/dispatcher/InputDispatcher.cpp
bool InputDispatcher::dispatchMotionLocked(nsecs_t currentTime,
                                           std::shared_ptr&lt;const MotionEntry&gt; entry,
                                           DropReason* dropReason, nsecs_t&amp; nextWakeupTime) {
    ...
    const bool <span class="hljs-attr">isPointerEvent</span> = isFromSource(entry-&gt;source, AINPUT_SOURCE_CLASS_POINTER)<span class="hljs-comment">;</span>
    ...
    // Identify targets.
    std::vector&lt;InputTarget&gt; inputTargets<span class="hljs-comment">;</span>
    ...
    if (isPointerEvent) {
        // Pointer event.  (eg. touchscreen)
        //è·å–å…³è”çª—å£
        Result&lt;std::vector&lt;InputTarget&gt;, InputEventInjectionResult&gt; <span class="hljs-attr">result</span> =
                findTouchedWindowTargetsLocked(currentTime, *entry)<span class="hljs-comment">;//æ³¨é‡Š30</span>
        ...
        if (result.ok()) {
            <span class="hljs-attr">inputTargets</span> = std::move(*result)<span class="hljs-comment">;</span>
        }
        ...
    } else {
        // Non touch event.  (eg. trackball)
       ...
    }
    ...
    // Dispatch the motion.
    //åˆ†å‘äº‹ä»¶
    dispatchEventLocked(currentTime, entry, inputTargets)<span class="hljs-comment">;</span>
    return true<span class="hljs-comment">;</span>
}

void InputDispatcher::dispatchEventLocked(nsecs_t currentTime,
                                          std::shared_ptr&lt;const EventEntry&gt; eventEntry,
                                          const std::vector&lt;InputTarget&gt;&amp; inputTargets) {
   
    //debugä¿¡æ¯å’Œæ•°æ®ç»Ÿè®¡
    processInteractionsLocked(*eventEntry, inputTargets)<span class="hljs-comment">;</span>
    //å†æ¬¡åœæ­¢PowerManagerServiceä¸è¦ç†„å±
    pokeUserActivityLocked(*eventEntry)<span class="hljs-comment">;</span>

    for (const InputTarget&amp; inputTarget : inputTargets) {
        std::shared_ptr&lt;Connection&gt; <span class="hljs-attr">connection</span> = inputTarget.connection<span class="hljs-comment">;</span>
        //å¤„ç†äº‹ä»¶
        prepareDispatchCycleLocked(currentTime, connection, eventEntry, inputTarget)<span class="hljs-comment">;</span>
    }
}

void InputDispatcher::prepareDispatchCycleLocked(nsecs_t currentTime,
                                                 const std::shared_ptr&lt;Connection&gt;&amp; connection,
                                                 std::shared_ptr&lt;const EventEntry&gt; eventEntry,
                                                 const InputTarget&amp; inputTarget) {
    ...
    enqueueDispatchEntryAndStartDispatchCycleLocked(currentTime, connection, eventEntry,
                                                    inputTarget)<span class="hljs-comment">;</span>
}

void InputDispatcher::enqueueDispatchEntryAndStartDispatchCycleLocked(
        nsecs_t currentTime, const std::shared_ptr&lt;Connection&gt;&amp; connection,
        std::shared_ptr&lt;const EventEntry&gt; eventEntry, const InputTarget&amp; inputTarget) {

    //connectçš„å¾…å¤„ç†äº‹ä»¶æ˜¯å¦éƒ½å¤„ç†å®Œäº†
    const bool <span class="hljs-attr">wasEmpty</span> = connection-&gt;outboundQueue.empty()<span class="hljs-comment">;</span>
    //å¾€ connection-&gt;outboundQueue é˜Ÿåˆ—å¡äº‹ä»¶
    enqueueDispatchEntryLocked(connection, eventEntry, inputTarget)<span class="hljs-comment">;//æ³¨é‡Š31</span>

    // If the outbound queue was previously empty, start the dispatch cycle going.
    if (wasEmpty &amp;&amp; !connection-&gt;outboundQueue.empty()) {
        //ä¹‹å‰çš„äº‹ä»¶éƒ½å¤„ç†å®Œäº†ï¼Œä¸”è¿™æ¬¡æœ‰æ–°äº‹ä»¶ï¼Œå¼€å§‹å¤„ç†äº‹ä»¶
        startDispatchCycleLocked(currentTime, connection)<span class="hljs-comment">; //æ³¨é‡Š32</span>
    }
}

void InputDispatcher::enqueueDispatchEntryLocked(const std::shared_ptr&lt;Connection&gt;&amp; connection,
                                                 std::shared_ptr&lt;const EventEntry&gt; eventEntry,
                                                 const InputTarget&amp; inputTarget) {
    ...
    connection-&gt;outboundQueue.emplace_back(std::move(dispatchEntry))<span class="hljs-comment">;</span>
}

void InputDispatcher::startDispatchCycleLocked(nsecs_t currentTime,
                                               const std::shared_ptr&lt;Connection&gt;&amp; connection) {

    ...
    //éå†æ‰€æœ‰å¾…å¤„ç†äº‹ä»¶
    while (connection-&gt;<span class="hljs-attr">status</span> == Connection::Status::NORMAL &amp;&amp; !connection-&gt;outboundQueue.empty()) {
        std::unique_ptr&lt;DispatchEntry&gt;&amp; <span class="hljs-attr">dispatchEntry</span> = connection-&gt;outboundQueue.front()<span class="hljs-comment">;</span>
        dispatchEntry-&gt;<span class="hljs-attr">deliveryTime</span> = currentTime<span class="hljs-comment">;</span>
        const std::chrono::nanoseconds <span class="hljs-attr">timeout</span> = getDispatchingTimeoutLocked(connection)<span class="hljs-comment">;</span>
        dispatchEntry-&gt;<span class="hljs-attr">timeoutTime</span> = currentTime + timeout.count()<span class="hljs-comment">;</span>

        // Publish the event.
        status_t status<span class="hljs-comment">;</span>
        const EventEntry&amp; <span class="hljs-attr">eventEntry</span> = *(dispatchEntry-&gt;eventEntry)<span class="hljs-comment">;</span>
        switch (eventEntry.type) {
            ...
            //è§¦æ‘¸äº‹ä»¶
            case EventEntry::Type::MOTION: {
                if (DEBUG_OUTBOUND_EVENT_DETAILS) {
                    LOG(INFO) &lt;&lt; "Publishing " &lt;&lt; *dispatchEntry &lt;&lt; " to "
                              &lt;&lt; connection-&gt;getInputChannelName()<span class="hljs-comment">;</span>
                }
                const MotionEntry&amp; <span class="hljs-attr">motionEntry</span> = static_cast&lt;const MotionEntry&amp;&gt;(eventEntry)<span class="hljs-comment">;</span>
                //å‘é€äº‹ä»¶
                <span class="hljs-attr">status</span> = publishMotionEvent(*connection, *dispatchEntry)<span class="hljs-comment">;//æ³¨é‡Š33</span>
                
                break<span class="hljs-comment">;</span>
            }
            ...
        }

        // Check the result.
        if (status) {
            if (<span class="hljs-attr">status</span> == WOULD_BLOCK) {
            //äº‹ä»¶å‘é€å¼‚å¸¸å¤„ç†
            return<span class="hljs-comment">;</span>
        }

        ...
        //å°†äº‹ä»¶ä» outboundQueue ä¸­ç§»é™¤æ·»åŠ åˆ° waitQueue
        connection-&gt;waitQueue.emplace_back(std::move(dispatchEntry))<span class="hljs-comment">;</span>
        connection-&gt;outboundQueue.erase(connection-&gt;outboundQueue.begin())<span class="hljs-comment">;</span>
        //è·å–äº‹ä»¶çš„å¤„ç†è¶…æ—¶ANRæ—¶é—´ï¼Œæ·»åŠ è¶…æ—¶çš„ANRæ—¶é—´åˆ° mAnrTrackerï¼Œæ˜¯å¾€åæ·»åŠ 
       const nsecs_t <span class="hljs-attr">timeoutTime</span> = dispatchEntry-&gt;timeoutTime<span class="hljs-comment">;</span>
         if (connection-&gt;responsive) {
            mAnrTracker.insert(timeoutTime, connection-&gt;getToken())<span class="hljs-comment">;</span>
        }
        ...
    }
}

status_t InputDispatcher::publishMotionEvent(Connection&amp; connection,
                                             DispatchEntry&amp; dispatchEntry) const {

    // Publish the motion event.
    //å‘é€äº‹ä»¶
    return connection.inputPublisher
            .publishMotionEvent(dispatchEntry.seq, motionEntry.id, motionEntry.deviceId,
                                motionEntry.source, motionEntry.displayId, std::move(hmac),
                                motionEntry.action, motionEntry.actionButton,
                                dispatchEntry.resolvedFlags, motionEntry.edgeFlags,
                                motionEntry.metaState, motionEntry.buttonState,
                                motionEntry.classification, dispatchEntry.transform,
                                motionEntry.xPrecision, motionEntry.yPrecision,
                                motionEntry.xCursorPosition, motionEntry.yCursorPosition,
                                dispatchEntry.rawTransform, motionEntry.downTime,
                                motionEntry.eventTime, motionEntry.getPointerCount(),
                                motionEntry.pointerProperties.data(), usingCoords)<span class="hljs-comment">;</span>
}

frameworks/native/libs/input/InputTransport.cpp
status_t InputPublisher::publishMotionEvent(
        uint32_t seq, int32_t eventId, int32_t deviceId, int32_t source,
        ui::LogicalDisplayId displayId, std::array&lt;uint8_t, 32&gt; hmac, int32_t action,
        int32_t actionButton, int32_t flags, int32_t edgeFlags, int32_t metaState,
        int32_t buttonState, MotionClassification classification, const ui::Transform&amp; transform,
        float xPrecision, float yPrecision, float xCursorPosition, float yCursorPosition,
        const ui::Transform&amp; rawTransform, nsecs_t downTime, nsecs_t eventTime,
        uint32_t pointerCount, const PointerProperties* pointerProperties,
        const PointerCoords* pointerCoords) {
    ...
    
    // æ„é€  InputMessage  å¹¶èµ‹å€¼
    InputMessage msg<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.header.type</span> = InputMessage::Type::MOTION<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.header.seq</span> = seq<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.eventId</span> = eventId<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.deviceId</span> = deviceId<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.source</span> = source<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.displayId</span> = displayId.val()<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.hmac</span> = std::move(hmac)<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.action</span> = action<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.actionButton</span> = actionButton<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.flags</span> = flags<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.edgeFlags</span> = edgeFlags<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.metaState</span> = metaState<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.buttonState</span> = buttonState<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.classification</span> = classification<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.dsdx</span> = transform.dsdx()<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.dtdx</span> = transform.dtdx()<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.dtdy</span> = transform.dtdy()<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.dsdy</span> = transform.dsdy()<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.tx</span> = transform.tx()<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.ty</span> = transform.ty()<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.xPrecision</span> = xPrecision<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.yPrecision</span> = yPrecision<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.xCursorPosition</span> = xCursorPosition<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.yCursorPosition</span> = yCursorPosition<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.dsdxRaw</span> = rawTransform.dsdx()<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.dtdxRaw</span> = rawTransform.dtdx()<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.dtdyRaw</span> = rawTransform.dtdy()<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.dsdyRaw</span> = rawTransform.dsdy()<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.txRaw</span> = rawTransform.tx()<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.tyRaw</span> = rawTransform.ty()<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.downTime</span> = downTime<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.eventTime</span> = eventTime<span class="hljs-comment">;</span>
    <span class="hljs-attr">msg.body.motion.pointerCount</span> = pointerCount<span class="hljs-comment">;</span>
    for (uint32_t <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; pointerCount; i++) {</span>
        msg.body.motion.pointers<span class="hljs-section">[i]</span>.<span class="hljs-attr">properties</span> = pointerProperties[i]<span class="hljs-comment">;</span>
        msg.body.motion.pointers<span class="hljs-section">[i]</span>.<span class="hljs-attr">coords</span> = pointerCoords[i]<span class="hljs-comment">;</span>
    }
    //é€šè¿‡å‘é€æ•°æ®
    return mChannel-&gt;sendMessage(&amp;msg)<span class="hljs-comment">;</span>
}

</code></pre>
<ul>
<li><strong>æ³¨é‡Š30</strong> å¯»æ‰¾äº‹ä»¶å…³è”ä¸”æœ‰ç„¦ç‚¹çš„çª—å£ï¼Œåœ¨Viewåˆå§‹åŒ–çª—å£åˆ›å»ºæ—¶ä¼šå…³è”tokenï¼Œçª—å£ä¸Šæœ‰InputChannelä¿¡æ¯ï¼Œ InputChannelé‡Œé¢æ˜¯æœ‰ä¸€ä¸ªsocketå¯¹çš„ï¼Œç”¨æ¥cleint-serveré€šä¿¡çš„ã€‚è‹¥æ˜¯æ²¡æ‰¾åˆ°æœ‰ç„¦ç‚¹çš„çª—å£ï¼Œè¿™é‡Œä¼šè®°å½•æ— ç„¦ç‚¹anræ—¶é—´ <code>mNoFocusedWindowTimeoutTime</code>ï¼Œè¿™æ ‡è®°åé¢å†ç¬¬7ç« èŠ‚åˆ†æANRçš„æµç¨‹æ—¶ä¼šç”¨åˆ°ã€‚</li>
<li><strong>æ³¨é‡Š31</strong> å¾€ <code>connection-&gt;outboundQueue</code> é˜Ÿåˆ—æ·»åŠ å¾…å¤„ç†äº‹ä»¶</li>
<li><strong>æ³¨é‡Š32</strong> å¦‚æœä¹‹å‰çš„<code>connection-&gt;outboundQueue</code>ä¸­çš„äº‹ä»¶éƒ½å¤„ç†å®Œäº†ï¼Œä¸”è¿™æ¬¡æœ‰æ–°äº‹ä»¶ï¼Œå¼€å§‹å¤„ç†äº‹ä»¶</li>
<li><strong>æ³¨é‡Š33</strong> è°ƒç”¨socketå‘é€äº‹ä»¶</li>
</ul>
<p>æ ¹æ®ä¸Šé¢çš„ InputDispatcher çš„äº‹ä»¶åˆ†å‘æœ€ç»ˆè°ƒç”¨çš„æ˜¯socketå‘é€æ¶ˆæ¯ï¼Œä½†æ˜¯æ¶ˆæ¯æ¥æ”¶æ–¹è¿˜ä¸çŸ¥é“æ˜¯å“ªé‡Œã€‚æˆ‘ä»¬çŸ¥é“è§¦æ‘¸äº‹ä»¶æœ€ç»ˆæ˜¯è¦åˆ†å‘åˆ°åº”ç”¨Appçš„çª—å£(View/Activity)å»å¤„ç†ï¼Œè¿™é‡Œ InputDispatcher çš„äº‹ä»¶åˆ†å‘æˆ‘ä»¬å…ˆæš‚ç¼“ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸‹Appçª—å£æ˜¯æ€ä¹ˆè·å–åˆ°äº‹ä»¶çš„ï¼Œåªè¦Appçª—å£é‚£è¾¹èƒ½æ‰¾äº‹ä»¶æ¥å—çš„cleintSocketï¼Œä¸”å’Œè¿™é‡Œçš„äº‹ä»¶å‘é€çš„serverSocketæ˜¯æˆå¯¹çš„è¯ï¼Œé‚£ä¸Šé¢ InputDispatcheré€šè¿‡serverSocketå‘é€çš„äº‹ä»¶åº”ç”¨çª—å£é‚£è¾¹å°±èƒ½æ”¶åˆ°ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[çº¿ç¨‹æ± è¯¦è§£]]></title>    <link>https://juejin.cn/post/7591075684066410511</link>    <guid>https://juejin.cn/post/7591075684066410511</guid>    <pubDate>2026-01-04T13:09:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591075684066410511" data-draft-id="7590681158717489192" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="çº¿ç¨‹æ± è¯¦è§£"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-01-04T13:09:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="XRay"/> <meta itemprop="url" content="https://juejin.cn/user/3966693685869288"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            çº¿ç¨‹æ± è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3966693685869288/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    XRay
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T13:09:45.000Z" title="Sun Jan 04 2026 13:09:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>æˆ‘ä»¬ç»å¸¸ä¼šé€šè¿‡å¯åŠ¨çº¿ç¨‹åœ¨å­çº¿ç¨‹å¤„ç†è€—æ—¶ä»»åŠ¡ï¼Œä½†æ˜¯æ¯ä¸ªçº¿ç¨‹çš„åˆ›å»ºå’Œé”€æ¯éƒ½éœ€è¦ä¸€å®šçš„å¼€é”€ã€‚å¹¶ä¸”æ¯æ¬¡é€šè¿‡new Thread().start()æ¥å¯åŠ¨çº¿ç¨‹ï¼Œå„ä¸ªçº¿ç¨‹å„è‡ªä¸ºæ”¿ï¼Œå¾ˆéš¾å¯¹å…¶è¿›è¡Œæ§åˆ¶ã€‚è¿™æ—¶å€™å°±éœ€è¦çº¿ç¨‹æ± æ¥å¯¹çº¿ç¨‹è¿›è¡Œç®¡ç†ã€‚</p>
<h3 data-id="heading-1">çº¿ç¨‹æ± </h3>
<p>ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼Ÿç®€å•ç†è§£ï¼Œå°±æ˜¯ä¸€ä¸ªç®¡ç†çº¿ç¨‹çš„æ± å­ã€‚çº¿ç¨‹æ± å°±æ˜¯é‡‡ç”¨æ± åŒ–æ€æƒ³ï¼ˆç±»ä¼¼è¿æ¥æ± ã€å¸¸é‡æ± ã€å¯¹è±¡æ± ç­‰ï¼‰ç®¡ç†çº¿ç¨‹çš„å·¥å…·ã€‚</p>
<p>ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„ï¼š</p>
<ul>
<li><strong>é‡ç”¨çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹</strong>ã€‚çº¿ç¨‹çš„åˆ›å»ºå’Œé”€æ¯çš„å¼€é”€æ˜¯å·¨å¤§çš„ï¼Œè€Œé€šè¿‡é‡ç”¨çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹å¤§å¤§å‡å°‘äº†è¿™äº›ä¸å¿…è¦çš„å¼€é”€ã€‚</li>
<li><strong>èƒ½æœ‰æ•ˆæ§åˆ¶çº¿ç¨‹æ± çš„æœ€å¤§å¹¶å‘æ•°</strong>ã€‚é¿å…å¤§é‡çº¿ç¨‹ä¹‹é—´å› æŠ¢å ç³»ç»Ÿèµ„æºè€Œå¯¼è‡´çš„é˜»å¡ç°è±¡ã€‚</li>
<li><strong>èƒ½å¤Ÿå¯¹çº¿ç¨‹è¿›è¡Œç®€å•çš„ç®¡ç†</strong>ã€‚çº¿ç¨‹æ± å¯ä»¥æä¾›å®šæ—¶æ‰§è¡Œä»¥åŠæŒ‡å®šé—´éš”å¾ªç¯æ‰§è¡Œç­‰åŠŸèƒ½ã€‚</li>
</ul>
<h3 data-id="heading-2">ThreadPoolExecutor</h3>
<p>å¯ä»¥é€šè¿‡ThreadPoolExecutoræ¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ï¼ŒThreadPoolExecutorä¸€å…±æœ‰4ä¸ªæ„é€ æ–¹æ³•ï¼Œå¦å¤–3ä¸ªæ„é€ æ–¹æ³•éƒ½é—´æ¥è°ƒç”¨äº†å‚æ•°æœ€å¤šçš„æ„é€ æ–¹æ³•ï¼Œå‚æ•°æœ€å¤šçš„æ„é€ æ–¹æ³•ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadPoolExecutor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractExecutorService</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ThreadPoolExecutor</span><span class="hljs-params">(<span class="hljs-type">int</span> corePoolSize,
        <span class="hljs-type">int</span> maximumPoolSize,
        <span class="hljs-type">long</span> keepAliveTime,
        TimeUnit unit,
        BlockingQueue&lt;Runnable&gt; workQueue,
        ThreadFactory threadFactory,
        RejectedExecutionHandler handler)</span> {
        ...
    }

}
</code></pre>
<p>å…¶æ„é€ æ–¹æ³•ä¸­å‚æ•°çš„ä½œç”¨å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>corePoolSize</strong>ï¼šçº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹æ•°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ ¸å¿ƒçº¿ç¨‹ä¼šåœ¨çº¿ç¨‹æ± ä¸­ä¸€ç›´å­˜æ´»ï¼Œå³ä½¿å®ƒä»¬å¤„äºé—²ç½®çŠ¶æ€ã€‚é™¤éä½ å°†å‚æ•°allowCoreThreadTimeOutè®¾ç½®ä¸ºtrueï¼Œé‚£ä¹ˆé—²ç½®çš„æ ¸å¿ƒçº¿ç¨‹åœ¨ç­‰å¾…æ–°ä»»åŠ¡åˆ°æ¥æ—¶ä¼šæœ‰è¶…æ—¶ç­–ç•¥ï¼Œè¿™ä¸ªæ—¶é—´é—´éš”ç”±keepAliveTimeæŒ‡å®šï¼Œå½“ç­‰å¾…æ—¶é—´è¶…è¿‡keepAliveTimeæ‰€æŒ‡å®šçš„æ—¶é•¿åï¼Œæ ¸å¿ƒçº¿ç¨‹å°±ä¼šè¢«ç»ˆæ­¢ã€‚</li>
<li><strong>maximumPoolSize</strong>ï¼šçº¿ç¨‹æ± å…è®¸åˆ›å»ºçš„æœ€å¤§çº¿ç¨‹æ•°ã€‚å½“æ´»åŠ¨çº¿ç¨‹æ•°è¾¾åˆ°è¿™ä¸ªæ•°å€¼åï¼Œåç»­çš„æ–°ä»»åŠ¡å°†ä¼šè¢«é˜»å¡ã€‚</li>
<li><strong>keepAliveTime</strong>ï¼šéæ ¸å¿ƒçº¿ç¨‹é—²ç½®æ—¶çš„è¶…æ—¶æ—¶é•¿ã€‚è¶…è¿‡è¿™ä¸ªæ—¶é•¿ï¼Œéæ ¸å¿ƒçº¿ç¨‹å°±ä¼šè¢«å›æ”¶ã€‚å½“allowCoreThreadTimeOutè®¾ç½®ä¸ºtrueæ—¶ï¼ŒkeepAliveTimeåŒæ ·ä¼šä½œç”¨äºæ ¸å¿ƒçº¿ç¨‹ã€‚</li>
<li><strong>unit</strong>ï¼škeepAliveTimeçš„å•ä½ã€‚è¿™æ˜¯ä¸€ä¸ªæšä¸¾ï¼Œå¸¸ç”¨çš„æœ‰ TimeUnit.MILLISECONDS(æ¯«ç§’)ã€TimeUnit.SECONDS(ç§’)ä»¥åŠTimeUnit.MINUTES (åˆ†é’Ÿ)ç­‰ã€‚</li>
<li><strong>workQueue</strong>ï¼šçº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡é˜Ÿåˆ—ã€‚é€šè¿‡çº¿ç¨‹æ± çš„execute()æ–¹æ³•æäº¤çš„Runnableå¯¹è±¡ä¼šå­˜å‚¨åœ¨è¿™é‡Œï¼Œå®ƒæ˜¯BlockingQueueç±»å‹çš„ï¼Œä¹Ÿå°±æ˜¯é˜»å¡é˜Ÿåˆ—ã€‚</li>
<li><strong>threadFactory</strong>ï¼šçº¿ç¨‹å·¥å‚ã€‚ä¸ºçº¿ç¨‹æ± æä¾›åˆ›å»ºæ–°çº¿ç¨‹çš„åŠŸèƒ½ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ— éœ€è®¾ç½®è¯¥å‚æ•°ï¼Œä½¿ç”¨é»˜è®¤çš„å°±è¡Œã€‚</li>
<li><strong>handler</strong>ï¼šæ‹’ç»ç­–ç•¥ã€‚å½“çº¿ç¨‹æ± æ— æ³•æ‰§è¡Œæ–°ä»»åŠ¡æ—¶ï¼Œè¿™å¯èƒ½æ˜¯ç”±äºä»»åŠ¡é˜Ÿåˆ—å·²æ»¡æˆ–è€…æ˜¯æ— æ³•æˆåŠŸæ‰§è¡Œä»»åŠ¡ï¼Œè¿™ä¸ªæ—¶å€™ThreadPoolExecutorä¼šè°ƒç”¨handlerçš„rejectedExecution()æ–¹æ³•æ¥é€šçŸ¥è°ƒç”¨è€…ã€‚</li>
</ul>
<p>ThreadPoolExecutor ä¸º RejectedExecutionHandler æä¾›äº†å‡ ä¸ªå¯é€‰å€¼ï¼šAbortPolicyã€CallerRunsPolicyã€DiscardPolicy å’Œ DiscardOldestPolicyï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadPoolExecutor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractExecutorService</span> {

    <span class="hljs-comment">/**
    * A handler for rejected tasks that runs the rejected task
    * directly in the calling thread of the {<span class="hljs-doctag">@code</span> execute} method,
    * unless the executor has been shut down, in which case the task
    * is discarded.
    */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CallerRunsPolicy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RejectedExecutionHandler</span> {
        <span class="hljs-comment">/**
        * Creates a {<span class="hljs-doctag">@code</span> CallerRunsPolicy}.
        */</span>
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">CallerRunsPolicy</span><span class="hljs-params">()</span> { }

        <span class="hljs-comment">/**
        * Executes task r in the caller's thread, unless the executor
        * has been shut down, in which case the task is discarded.
        *
        * <span class="hljs-doctag">@param</span> r the runnable task requested to be executed
        * <span class="hljs-doctag">@param</span> e the executor attempting to execute this task
        */</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rejectedExecution</span><span class="hljs-params">(Runnable r, ThreadPoolExecutor e)</span> {
            <span class="hljs-keyword">if</span> (!e.isShutdown()) {
                r.run();
            }
        }
    }

    <span class="hljs-comment">/**
    * A handler for rejected tasks that throws a
    * {<span class="hljs-doctag">@code</span> RejectedExecutionException}.
    */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbortPolicy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RejectedExecutionHandler</span> {
        <span class="hljs-comment">/**
        * Creates an {<span class="hljs-doctag">@code</span> AbortPolicy}.
        */</span>
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">AbortPolicy</span><span class="hljs-params">()</span> { }

        <span class="hljs-comment">/**
        * Always throws RejectedExecutionException.
        *
        * <span class="hljs-doctag">@param</span> r the runnable task requested to be executed
        * <span class="hljs-doctag">@param</span> e the executor attempting to execute this task
        * <span class="hljs-doctag">@throws</span> RejectedExecutionException always
        */</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rejectedExecution</span><span class="hljs-params">(Runnable r, ThreadPoolExecutor e)</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RejectedExecutionException</span>(<span class="hljs-string">"Task "</span> + r.toString() +
            <span class="hljs-string">" rejected from "</span> +
            e.toString());
        }
    }

    <span class="hljs-comment">/**
    * A handler for rejected tasks that silently discards the
    * rejected task.
    */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DiscardPolicy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RejectedExecutionHandler</span> {
        <span class="hljs-comment">/**
        * Creates a {<span class="hljs-doctag">@code</span> DiscardPolicy}.
        */</span>
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">DiscardPolicy</span><span class="hljs-params">()</span> { }

        <span class="hljs-comment">/**
        * Does nothing, which has the effect of discarding task r.
        *
        * <span class="hljs-doctag">@param</span> r the runnable task requested to be executed
        * <span class="hljs-doctag">@param</span> e the executor attempting to execute this task
        */</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rejectedExecution</span><span class="hljs-params">(Runnable r, ThreadPoolExecutor e)</span> {
        }
    }

    <span class="hljs-comment">/**
    * A handler for rejected tasks that discards the oldest unhandled
    * request and then retries {<span class="hljs-doctag">@code</span> execute}, unless the executor
    * is shut down, in which case the task is discarded.
    */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DiscardOldestPolicy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RejectedExecutionHandler</span> {
        <span class="hljs-comment">/**
        * Creates a {<span class="hljs-doctag">@code</span> DiscardOldestPolicy} for the given executor.
        */</span>
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">DiscardOldestPolicy</span><span class="hljs-params">()</span> { }

        <span class="hljs-comment">/**
        * Obtains and ignores the next task that the executor
        * would otherwise execute, if one is immediately available,
        * and then retries execution of task r, unless the executor
        * is shut down, in which case task r is instead discarded.
        *
        * <span class="hljs-doctag">@param</span> r the runnable task requested to be executed
        * <span class="hljs-doctag">@param</span> e the executor attempting to execute this task
        */</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rejectedExecution</span><span class="hljs-params">(Runnable r, ThreadPoolExecutor e)</span> {
            <span class="hljs-keyword">if</span> (!e.isShutdown()) {
                e.getQueue().poll();
                e.execute(r);
            }
        }
    }
} 
</code></pre>
<ol>
<li>AbortPolicyï¼šé»˜è®¤å€¼ï¼Œç›´æ¥æŠ›å‡º RejectedExecutionException å¼‚å¸¸ã€‚</li>
<li>CallerRunsPolicyï¼šäº¤ç»™è°ƒç”¨ execute() æ–¹æ³•çš„çº¿ç¨‹è¿›è¡Œæ‰§è¡Œã€‚å¦‚æœ executor å·²ç» shutdown äº†ï¼Œåˆ™ç›´æ¥ä¸¢å¼ƒã€‚</li>
<li>DiscardPolicyï¼šç›´æ¥ä¸¢å¼ƒã€‚</li>
<li>DiscardOldestPolicyï¼šä¸¢å¼ƒæœ€è€çš„æœªå¤„ç†çš„è¯·æ±‚ï¼Œç„¶åé‡æ–°æ‰§è¡Œ execute() æ–¹æ³•ã€‚å¦‚æœ executor å·²ç» shutdown äº†ï¼Œåˆ™ç›´æ¥ä¸¢å¼ƒã€‚</li>
</ol>
<h3 data-id="heading-3">çº¿ç¨‹æ± çš„å¤„ç†æµç¨‹</h3>
<p>ThreadPoolExecutoræ‰§è¡Œä»»åŠ¡æ—¶å¤§è‡´éµå¾ªå¦‚ä¸‹æµç¨‹:</p>
<ol>
<li>å¦‚æœçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡æœªè¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹çš„æ•°é‡ï¼Œé‚£ä¹ˆä¼šç›´æ¥å¯åŠ¨ä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ã€‚</li>
<li>å¦‚æœçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å·²ç»è¾¾åˆ°æˆ–è€…è¶…è¿‡æ ¸å¿ƒçº¿ç¨‹çš„æ•°é‡ï¼Œé‚£ä¹ˆæ–°ä»»åŠ¡ä¼šè¢«æ’å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­æ’é˜Ÿç­‰å¾…æ‰§è¡Œã€‚</li>
<li>å¦‚æœåœ¨æ­¥éª¤2ä¸­æ— æ³•å°†ä»»åŠ¡æ’å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œè¿™å¾€å¾€æ˜¯ç”±äºä»»åŠ¡é˜Ÿåˆ—å·²æ»¡ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœçº¿ç¨‹æ•°é‡æœªè¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°ï¼Œé‚£ä¹ˆä¼šç«‹åˆ»å¯åŠ¨ä¸€ä¸ªéæ ¸å¿ƒçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ã€‚</li>
<li>å¦‚æœæ­¥éª¤3ä¸­çº¿ç¨‹æ•°é‡å·²ç»è¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œæ‹’ç»ç­–ç•¥ã€‚</li>
</ol>
<h3 data-id="heading-4">4ç§å¸¸ç”¨çš„çº¿ç¨‹æ± </h3>
<p>ä¸‹é¢ä»‹ç»4ç§å¸¸ç”¨çš„çº¿ç¨‹æ± ï¼Œå®ƒä»¬éƒ½æ˜¯ç›´æ¥æˆ–é—´æ¥åœ°é€šè¿‡é…ç½®ThreadPoolExecutoræ¥å®ç°è‡ªå·±çš„åŠŸèƒ½ç‰¹æ€§ã€‚</p>
<ol>
<li><strong>FixedThreadPool</strong>ï¼Œå…¶ä»£ç å¦‚ä¸‹ï¼š</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Executors</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ExecutorService <span class="hljs-title function_">newFixedThreadPool</span><span class="hljs-params">(<span class="hljs-type">int</span> nThreads)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(nThreads, nThreads,
                <span class="hljs-number">0L</span>, TimeUnit.MILLISECONDS,
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;());
    }
}
</code></pre>
<p>å®ƒé€šè¿‡Executorsçš„newFixedThreadPool()æ–¹æ³•æ¥åˆ›å»ºã€‚å®ƒæ˜¯ä¸€ç§çº¿ç¨‹æ•°é‡å›ºå®šçš„çº¿ç¨‹æ± ï¼Œå…¶æ ¸å¿ƒçº¿ç¨‹æ•°å’Œæœ€å¤§çº¿ç¨‹æ•°éƒ½è¢«è®¾ç½®æˆnThreadsã€‚å¦å¤–ï¼Œç”±äºä»»åŠ¡é˜Ÿåˆ—æ˜¯æ— ç•Œé˜»å¡é˜Ÿåˆ—LinkedBlockingQueueï¼ˆå®¹é‡é»˜è®¤ä¸ºInteger.MAX_VALUEï¼‰ï¼Œç›¸å½“äºä¸ä¼šäº§ç”Ÿéæ ¸å¿ƒçº¿ç¨‹ï¼ŒkeepAliveTimeå‚æ•°æ— æ•ˆã€‚å½“çº¿ç¨‹å¤„äºç©ºé—²çŠ¶æ€æ—¶ï¼Œå®ƒä»¬å¹¶ä¸ä¼šè¢«å›æ”¶ï¼Œé™¤éçº¿ç¨‹æ± è¢«å…³é—­äº†ï¼Œè¿™æ ·ï¼Œçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹å¯ä»¥å¾—åˆ°é‡ç”¨ã€‚å½“æ‰€æœ‰çš„çº¿ç¨‹éƒ½å¤„äºæ´»åŠ¨çŠ¶æ€æ—¶ï¼Œæ–°ä»»åŠ¡ä¼šè¢«æ·»åŠ åˆ°LinkedBlockingQueueä¸­ç­‰å¾…ï¼Œç›´åˆ°æœ‰çº¿ç¨‹ç©ºé—²å‡ºæ¥ã€‚ç”±äºFixedThreadPoolåªæœ‰æ ¸å¿ƒçº¿ç¨‹å¹¶ä¸”è¿™äº›æ ¸å¿ƒçº¿ç¨‹ä¸ä¼šè¢«å›æ”¶ï¼Œè¿™æ„å‘³ç€å®ƒèƒ½å¤Ÿæ›´åŠ å¿«é€Ÿåœ°å“åº”å¤–ç•Œçš„è¯·æ±‚ã€‚</p>
<ol start="2">
<li><strong>CachedThreadPool</strong>ï¼Œä»£ç å¦‚ä¸‹ï¼š</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Executors</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ExecutorService <span class="hljs-title function_">newCachedThreadPool</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(<span class="hljs-number">0</span>, Integer.MAX_VALUE,
                <span class="hljs-number">60L</span>, TimeUnit.SECONDS,
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">SynchronousQueue</span>&lt;Runnable&gt;());
    }
} 
</code></pre>
<p>é€šè¿‡Executorsçš„newCachedThreadPool()æ–¹æ³•æ¥åˆ›å»ºã€‚å®ƒæ˜¯ä¸€ç§çº¿ç¨‹æ•°é‡ä¸å®šçš„çº¿ç¨‹æ± ï¼Œå…¶æ ¸å¿ƒçº¿ç¨‹ä¸º0ï¼Œæœ€å¤§çº¿ç¨‹æ•°ä¸ºInteger.MAX_VALUEã€‚ç”±äºInteger.MAX_VALUEæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ•°ï¼Œå®é™…ä¸Šå°±ç›¸å½“äºæœ€å¤§çº¿ç¨‹æ•°å¯ä»¥ä»»æ„å¤§ã€‚å½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹éƒ½å¤„äºæ´»åŠ¨çŠ¶æ€æ—¶ï¼Œçº¿ç¨‹æ± ä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹æ¥å¤„ç†æ–°ä»»åŠ¡ï¼Œå¦åˆ™å°±ä¼šåˆ©ç”¨ç©ºé—²çš„çº¿ç¨‹æ¥å¤„ç†æ–°ä»»åŠ¡ã€‚çº¿ç¨‹æ± ä¸­çš„ç©ºé—²çº¿ç¨‹çš„è¶…æ—¶æ—¶é•¿ä¸º60ç§’ï¼Œè¶…è¿‡60ç§’é—²ç½®çº¿ç¨‹å°±ä¼šè¢«å›æ”¶ã€‚CachedThreadPoolçš„ä»»åŠ¡é˜Ÿåˆ—SynchronousQueueæ˜¯ä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ï¼Œå…¶æ¯ä¸€ä¸ªæ’å…¥æ“ä½œå¿…é¡»ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹ç›¸åº”çš„ç§»é™¤æ“ä½œï¼Œç›¸å½“äºæ¯æ¬¡æäº¤åˆ°ä»»åŠ¡é˜Ÿåˆ—çš„ä»»åŠ¡é©¬ä¸Šå°±ä¼šè¢«çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ‹¿å»æ‰§è¡Œã€‚ä»CachedThreadPoolçš„ç‰¹æ€§æ¥çœ‹ï¼Œè¿™ç±»çº¿ç¨‹æ± æ¯”è¾ƒé€‚åˆæ‰§è¡Œå¤§é‡çš„è€—æ—¶è¾ƒå°‘çš„ä»»åŠ¡ã€‚å½“æ•´ä¸ªçº¿ç¨‹æ± éƒ½å¤„äºé—²ç½®çŠ¶æ€æ—¶ï¼Œçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹éƒ½ä¼šè¶…æ—¶è€Œè¢«åœæ­¢ï¼Œè¿™ä¸ªæ—¶å€™CachedThreadPoolä¹‹ä¸­å®é™…ä¸Šæ˜¯æ²¡æœ‰ä»»ä½•çº¿ç¨‹çš„ï¼Œå®ƒå‡ ä¹æ˜¯ä¸å ç”¨ä»»ä½•ç³»ç»Ÿèµ„æºçš„ã€‚</p>
<p>3.<strong>SingleThreadExecutor</strong>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Executors</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ExecutorService <span class="hljs-title function_">newSingleThreadExecutor</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FinalizableDelegatedExecutorService</span>
                (<span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>,
                        <span class="hljs-number">0L</span>, TimeUnit.MILLISECONDS,
                        <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;()));
    }
} 
</code></pre>
<p>é€šè¿‡Executorsçš„newSingleThreadExecutor()æ–¹æ³•æ¥åˆ›å»ºã€‚çº¿ç¨‹æ± å†…éƒ¨åªæœ‰ä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹ï¼Œå®ƒç¡®ä¿æ‰€æœ‰çš„ä»»åŠ¡éƒ½åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­æŒ‰é¡ºåºæ‰§è¡Œã€‚SingleThreadExecutor çš„æ„ä¹‰åœ¨äºç»Ÿä¸€æ‰€æœ‰çš„ä»»åŠ¡åˆ°ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œè¿™ä½¿å¾—åœ¨è¿™äº›ä»»åŠ¡ä¹‹é—´ä¸éœ€è¦å¤„ç†çº¿ç¨‹åŒæ­¥çš„é—®é¢˜ã€‚</p>
<ol start="4">
<li><strong>ScheduledThreadPool</strong>ï¼Œä»£ç å¦‚ä¸‹ï¼š</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Executors</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ScheduledExecutorService <span class="hljs-title function_">newScheduledThreadPool</span><span class="hljs-params">(<span class="hljs-type">int</span> corePoolSize)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ScheduledThreadPoolExecutor</span>(corePoolSize);
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ScheduledThreadPoolExecutor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ThreadPoolExecutor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ScheduledExecutorService</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ong</span> <span class="hljs-variable">DEFAULT_KEEPALIVEMILLIS</span> <span class="hljs-operator">=</span> <span class="hljs-number">10L</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ScheduledThreadPoolExecutor</span><span class="hljs-params">(<span class="hljs-type">int</span> corePoolSize)</span> {
        <span class="hljs-built_in">super</span>(corePoolSize, Integer.MAX_VALUE,
                DEFAULT_KEEPALIVE_MILLIS, MILLISECONDS,
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">DelayedWorkQueue</span>());
    }

}
</code></pre>
<p>é€šè¿‡Executorsçš„newScheduledThreadPool()æ–¹æ³•æ¥åˆ›å»ºã€‚å®ƒçš„æ ¸å¿ƒçº¿ç¨‹æ•°æ˜¯å›ºå®šçš„ï¼Œæœ€å¤§çº¿ç¨‹æ•°æ˜¯æ²¡æœ‰é™åˆ¶çš„ï¼Œç”±äºDelayedWorkQueueæ˜¯æ— ç•Œçš„ï¼Œæ‰€ä»¥æœ€å¤§çº¿ç¨‹æ•°è¿™ä¸ªå‚æ•°æ˜¯æ— æ•ˆçš„ã€‚ScheduledThreadPool è¿™ç±»çº¿ç¨‹æ± ä¸»è¦ç”¨äºæ‰§è¡Œå®šæ—¶ä»»åŠ¡å’Œå…·æœ‰å›ºå®šå‘¨æœŸçš„é‡å¤ä»»åŠ¡ã€‚å¯ä»¥è°ƒç”¨ScheduledThreadPoolExecutorçš„scheduleAtFixedRate()æˆ–è€…scheduleWithFixedDelay()æ–¹æ³•æ¥æ‰§è¡Œå‘¨æœŸæ€§çš„ä»»åŠ¡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨çš„å®ä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Runnable</span> <span class="hljs-variable">runnable</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"current time millis is:"</span> + System.currentTimeMillis());
    }
};

<span class="hljs-type">ScheduledExecutorService</span> <span class="hljs-variable">scheduledThreadPool</span> <span class="hljs-operator">=</span> Executors.newScheduledThreadPool(<span class="hljs-number">4</span>);

<span class="hljs-comment">//2ç§’åæ‰§è¡Œrunnable</span>
scheduledThreadPool.schedule(runnable, <span class="hljs-number">2</span>, TimeUnit.SECONDS);

<span class="hljs-comment">//ç¬¬ä¸€ä¸ªä»»åŠ¡10msåæ‰§è¡Œï¼Œåé¢æ¯éš”1000msæ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡</span>
scheduledThreadPool.scheduleAtFixedRate(runnable, <span class="hljs-number">10</span>, <span class="hljs-number">1000</span>, TimeUnit.MILLISECONDS);

<span class="hljs-comment">//ç¬¬ä¸€ä¸ªä»»åŠ¡10msåæ‰§è¡Œï¼Œåé¢çš„ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´æ˜¯ä¸Šä¸€ä¸ªä»»åŠ¡æ‰§è¡Œç»“æŸåçš„1000ms</span>
scheduledThreadPool.scheduleWithFixedDelay(runnable, <span class="hljs-number">10</span>, <span class="hljs-number">1000</span>, TimeUnit.MILLISECONDS);
</code></pre>
<p>ä¸€èˆ¬ä¸æ¨èä½¿ç”¨Executorså»åˆ›å»ºçº¿ç¨‹æ± ï¼Œè€Œæ¨èä½¿ç”¨ThreadPoolExecutorçš„æ–¹å¼ï¼Œä½¿ç”¨Executorså»åˆ›å»ºçº¿ç¨‹æ± çš„é£é™©å¦‚ä¸‹ï¼š</p>
<ol>
<li>FixedThreadPoolå’ŒSingleThreadExecutorï¼šå…è®¸çš„ä»»åŠ¡é˜Ÿåˆ—é•¿åº¦ä¸ºInteger.MAX_VALUEï¼Œå¯èƒ½ä¼šå †ç§¯å¤§é‡çš„è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´OOMã€‚</li>
<li>CachedThreadPoolï¼šå…è®¸åˆ›å»ºçš„çº¿ç¨‹æ•°é‡ä¸ºInteger.MAX_VALUEï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤§é‡çº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´OOMã€‚</li>
</ol>
<h3 data-id="heading-5">çº¿ç¨‹æ± çš„å¼‚å¸¸å¤„ç†</h3>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ExecutorService</span> <span class="hljs-variable">threadPool</span> <span class="hljs-operator">=</span> Executors.newFixedThreadPool(<span class="hljs-number">5</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
    threadPool.submit(() -&gt; {
        System.out.println(<span class="hljs-string">"current thread nameï¼š"</span> + Thread.currentThread().getName());
        <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        System.out.println(<span class="hljs-string">"resultï¼š"</span> + object.toString());
    });
}
</code></pre>
<p>æ‰§è¡Œåæ‰“å°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">current thread nameï¼špool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">1</span>
current thread nameï¼špool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">3</span>
current thread nameï¼špool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">4</span>
current thread nameï¼špool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">2</span>
current thread nameï¼špool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">5</span>
</code></pre>
<p>æ˜¾ç„¶ä¸Šé¢çš„ä»£ç ä¸­objectä¸ºnullï¼Œæ‰§è¡Œobject.toString()ä¼šæœ‰å¼‚å¸¸ï¼Œä½†æ˜¯æ‰“å°å¹¶æ²¡æœ‰çœ‹åˆ°å¼‚å¸¸ï¼Œè¿™ç§æƒ…å†µä¸‹å°±æ²¡åŠæ³•æ„ŸçŸ¥ä»£ç ä¸­çš„å¼‚å¸¸äº†ã€‚</p>
<p>çº¿ç¨‹æ± ä¸­å¤„ç†å¼‚å¸¸çš„æ–¹å¼æœ‰4ç§ï¼š</p>
<ol>
<li><strong>æ·»åŠ try catchè¯­å¥</strong>;</li>
<li><strong>é€šè¿‡Futureå¯¹è±¡çš„get()æ–¹æ³•æ¥æ”¶æŠ›å‡ºçš„å¼‚å¸¸è¿›è¡Œå¤„ç†</strong>;</li>
<li><strong>ç»™çº¿ç¨‹è®¾ç½®UncaughtExceptionHandler</strong>;</li>
<li><strong>é‡å†™ThreadPoolExecutorçš„afterExecute()æ–¹æ³•</strong>;</li>
</ol>
<p>å…ˆæ¥çœ‹çœ‹ç¬¬1ç§æ–¹å¼ï¼Œè‡ªå·±æ·»åŠ try catchè¯­å¥ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ExecutorService</span> <span class="hljs-variable">threadPool</span> <span class="hljs-operator">=</span> Executors.newFixedThreadPool(<span class="hljs-number">5</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
    threadPool.submit(() -&gt; {
        System.out.println(<span class="hljs-string">"current thread nameï¼š"</span> + Thread.currentThread().getName());
        <span class="hljs-keyword">try</span>{
            <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
            System.out.println(<span class="hljs-string">"resultï¼š"</span> + object.toString());
        }<span class="hljs-keyword">catch</span> (Exception e){
            System.out.println(Thread.currentThread().getName() + <span class="hljs-string">" å‡ºå¼‚å¸¸äº†"</span>);
        }
    });
}
</code></pre>
<p>æ‰§è¡Œåæ‰“å°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">current thread nameï¼špool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">1</span>
pool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">1</span> å‡ºå¼‚å¸¸äº†
current thread nameï¼špool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">2</span>
current thread nameï¼špool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">4</span>
current thread nameï¼špool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">3</span>
current thread nameï¼špool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">5</span>
pool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">4</span> å‡ºå¼‚å¸¸äº†
pool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">2</span> å‡ºå¼‚å¸¸äº†
pool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">5</span> å‡ºå¼‚å¸¸äº†
pool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">3</span> å‡ºå¼‚å¸¸äº†
</code></pre>
<p>ç¬¬2ç§æ–¹å¼æˆ‘ä»¬éœ€è¦åˆ†æä¸€ä¸‹æºç ï¼Œçœ‹çœ‹ä¸ºä»€ä¹ˆå¯ä»¥é€šè¿‡Futureå¯¹è±¡çš„get()æ–¹æ³•æ‹¿åˆ°æŠ›å‡ºçš„å¼‚å¸¸ï¼Œæˆ‘ä»¬ä»submit()æ–¹æ³•å¼€å§‹è·Ÿä¸€ä¸‹æºç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractExecutorService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ExecutorService</span> {

    <span class="hljs-keyword">public</span> Future&lt;?&gt; submit(Runnable task) {
        <span class="hljs-keyword">if</span> (task == <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();
        RunnableFuture&lt;Void&gt; ftask = newTaskFor(task, <span class="hljs-literal">null</span>);
        execute(ftask);
        <span class="hljs-keyword">return</span> ftask;
    }

    <span class="hljs-keyword">protected</span> &lt;T&gt; RunnableFuture&lt;T&gt; <span class="hljs-title function_">newTaskFor</span><span class="hljs-params">(Runnable runnable, T value)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FutureTask</span>&lt;T&gt;(runnable, value);
    }
}
</code></pre>
<p>submit()æ–¹æ³•é‡Œé¢é€šè¿‡newTaskFor()æ–¹æ³•å°†ä¼ å…¥çš„Runnableå¯¹è±¡åŒ…è£…æˆFutureTaskï¼Œç„¶åå°†è¿™ä¸ªFutureTaskäº¤ç»™execute()æ–¹æ³•æ‰§è¡Œï¼Œæœ€åè¿”å›FutureTaskã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">classDiagram
    Future &lt;|-- RunnableFuture
    Runnable &lt;|-- RunnableFuture
    RunnableFuture &lt;|.. FutureTask

    class Future {
        &lt;&lt;interface&gt;&gt;
        +cancel()
        +isCancelled()
        +get()
    }
    
    class Runnable {
        &lt;&lt;interface&gt;&gt;
        +run()
    }
    
    class RunnableFuture {
        &lt;&lt;interface&gt;&gt;
    }
    
    class FutureTask {
        +run()
        +get()
        +cancel()
    }
</code></pre>
<p>FutureTaskå¯ä»¥ç”¨æ¥åŒ…è£…Callableæˆ–Runnableå¯¹è±¡ï¼Œå› ä¸ºFutureTaskå®ç°äº†Runnableæ¥å£ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FutureTask</span>&lt;V&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RunnableFuture</span>&lt;V&gt; {

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">FutureTask</span><span class="hljs-params">(Runnable runnable, V result)</span> {
        <span class="hljs-built_in">this</span>.callable = Executors.callable(runnable, result);
        <span class="hljs-built_in">this</span>.state = NEW; <span class="hljs-comment">// ensure visibility of callable</span>
    }
}
</code></pre>
<p>åœ¨FutureTaskçš„æ„é€ æ–¹æ³•ä¸­ï¼Œå°†RunnableåŒ…è£…æˆäº†ä¸€ä¸ªCallableç±»å‹çš„å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (state != NEW ||
            !U.compareAndSwapObject(<span class="hljs-built_in">this</span>, RUNNER, <span class="hljs-literal">null</span>, Thread.currentThread()))
        <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">try</span> {
        Callable&lt;V&gt; c = callable;
        <span class="hljs-keyword">if</span> (c != <span class="hljs-literal">null</span> &amp;&amp; state == NEW) {
            V result;
            <span class="hljs-type">boolean</span> ran;
            <span class="hljs-keyword">try</span> {
                result = c.call();
                ran = <span class="hljs-literal">true</span>;
            } <span class="hljs-keyword">catch</span> (Throwable ex) {
                result = <span class="hljs-literal">null</span>;
                ran = <span class="hljs-literal">false</span>;
                setException(ex);
            }
            <span class="hljs-keyword">if</span> (ran)
                set(result);
        }
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-comment">// runner must be non-null until state is settled to</span>
        <span class="hljs-comment">// prevent concurrent calls to run()</span>
        runner = <span class="hljs-literal">null</span>;
        <span class="hljs-comment">// state must be re-read after nulling runner to prevent</span>
        <span class="hljs-comment">// leaked interrupts</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> state;
        <span class="hljs-keyword">if</span> (s &gt;= INTERRUPTING)
            handlePossibleCancellationInterrupt(s);
    }
}
</code></pre>
<p>åœ¨FutureTaskçš„run()æ–¹æ³•ä¸­ï¼Œè°ƒç”¨äº†Callableå¯¹è±¡çš„call()æ–¹æ³•ï¼Œä¹Ÿå°±è°ƒç”¨äº†æˆ‘ä»¬ä¼ å…¥çš„Runnableå¯¹è±¡çš„run()æ–¹æ³•ã€‚è¿™é‡Œå¯ä»¥çœ‹åˆ°æœ‰æ·»åŠ try catchè¯­å¥ï¼ŒæŠ›å‡ºçš„å¼‚å¸¸ä¼šä¼ å…¥setException()æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setException</span><span class="hljs-params">(Throwable t)</span> {
    <span class="hljs-keyword">if</span> (U.compareAndSwapInt(<span class="hljs-built_in">this</span>, STATE, NEW, COMPLETING)) {
        outcome = t;
        U.putOrderedInt(<span class="hljs-built_in">this</span>, STATE, EXCEPTIONAL); <span class="hljs-comment">// final state</span>
        finishCompletion();
    }
}
</code></pre>
<p>åœ¨setException()æ–¹æ³•ä¸­å°†å¼‚å¸¸èµ‹å€¼ç»™äº†outcomeã€‚æ¥ç€çœ‹çœ‹FutureTaskçš„get()æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> V <span class="hljs-title function_">get</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException, ExecutionException {
    <span class="hljs-type">int</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> state;
    <span class="hljs-keyword">if</span> (s &lt;= COMPLETING)
        s = awaitDone(<span class="hljs-literal">false</span>, <span class="hljs-number">0L</span>);
    <span class="hljs-keyword">return</span> report(s);
}
</code></pre>
<p>é‡Œé¢åˆè°ƒç”¨äº†report()æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> V <span class="hljs-title function_">report</span><span class="hljs-params">(<span class="hljs-type">int</span> s)</span> <span class="hljs-keyword">throws</span> ExecutionException {
    <span class="hljs-type">Object</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> outcome;
    <span class="hljs-keyword">if</span> (s == NORMAL)
        <span class="hljs-keyword">return</span> (V)x;
    <span class="hljs-keyword">if</span> (s &gt;= CANCELLED)
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CancellationException</span>();
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExecutionException</span>((Throwable)x);
}
</code></pre>
<p>åœ¨report()æ–¹æ³•æ–¹æ³•ä¸­ä¼šæ‹¿åˆ°è¿™ä¸ªoutcomeå¹¶æŠ›å‡ºï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡Futureçš„get()æ–¹æ³•æ¥æ”¶æŠ›å‡ºçš„å¼‚å¸¸è¿›è¡Œå¤„ç†ï¼Œå°†ä¸Šé¢çš„ç¤ºä¾‹æ”¹é€ ä¸€ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ExecutorService</span> <span class="hljs-variable">threadPool</span> <span class="hljs-operator">=</span> Executors.newFixedThreadPool(<span class="hljs-number">5</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
    <span class="hljs-type">Future</span> <span class="hljs-variable">future</span> <span class="hljs-operator">=</span> threadPool.submit(() -&gt; {
        System.out.println(<span class="hljs-string">"current thread nameï¼š"</span> + Thread.currentThread().getName());
        <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        System.out.println(<span class="hljs-string">"resultï¼š"</span> + object.toString());
    });

    <span class="hljs-keyword">try</span>{
        future.get();
    }<span class="hljs-keyword">catch</span> (Exception e){
        System.out.println(<span class="hljs-string">"å‡ºå¼‚å¸¸äº†"</span>);
    }
}
</code></pre>
<p>æ‰“å°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">current thread nameï¼špool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">1</span>
å‡ºå¼‚å¸¸äº†
current thread nameï¼špool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">2</span>
å‡ºå¼‚å¸¸äº†
current thread nameï¼špool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">3</span>
å‡ºå¼‚å¸¸äº†
current thread nameï¼špool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">4</span>
å‡ºå¼‚å¸¸äº†
current thread nameï¼špool-<span class="hljs-number">1</span>-thread-<span class="hljs-number">5</span>
å‡ºå¼‚å¸¸äº†
</code></pre>
<p>ç¬¬3ç§æ–¹å¼æ˜¯é€šè¿‡ç»™çº¿ç¨‹è®¾ç½®UncaughtExceptionHandlerï¼Œç„¶ååœ¨å…¶uncaughtException()æ–¹æ³•ä¸­å¤„ç†å¼‚å¸¸ï¼Œè¿™ç§æ–¹å¼åªèƒ½ç”¨åœ¨ä½¿ç”¨execute()æäº¤ä»»åŠ¡çš„ä»£ç ä¸­ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ExecutorService</span> <span class="hljs-variable">threadPool</span> <span class="hljs-operator">=</span> Executors.newFixedThreadPool(<span class="hljs-number">5</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadFactory</span>() {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Thread <span class="hljs-title function_">newThread</span><span class="hljs-params">(Runnable r)</span> {
        <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(r);
        t.setUncaughtExceptionHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>.UncaughtExceptionHandler() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">uncaughtException</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Thread t, <span class="hljs-meta">@NonNull</span> Throwable e)</span> {
                System.out.println(t.getName() + <span class="hljs-string">" æŠ›å‡ºäº†å¼‚å¸¸ï¼š"</span> + e);
            }
        });
        <span class="hljs-keyword">return</span> t;
    }
});

<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
    threadPool.execute(() -&gt; {
        System.out.println(<span class="hljs-string">"current thread nameï¼š"</span> + Thread.currentThread().getName());
        <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        System.out.println(<span class="hljs-string">"resultï¼š"</span> + object.toString());
    });
}
</code></pre>
<p>æ‰“å°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">current thread nameï¼šThread-<span class="hljs-number">2</span>
current thread nameï¼šThread-<span class="hljs-number">4</span>
current thread nameï¼šThread-<span class="hljs-number">3</span>
current thread nameï¼šThread-<span class="hljs-number">5</span>
current thread nameï¼šThread-<span class="hljs-number">6</span>
Thread-<span class="hljs-number">2</span> æŠ›å‡ºäº†å¼‚å¸¸ï¼šjava.lang.NullPointerException: Cannot invoke <span class="hljs-string">"Object.toString()"</span> because <span class="hljs-string">"object"</span> is <span class="hljs-literal">null</span>
Thread-<span class="hljs-number">4</span> æŠ›å‡ºäº†å¼‚å¸¸ï¼šjava.lang.NullPointerException: Cannot invoke <span class="hljs-string">"Object.toString()"</span> because <span class="hljs-string">"object"</span> is <span class="hljs-literal">null</span>
Thread-<span class="hljs-number">3</span> æŠ›å‡ºäº†å¼‚å¸¸ï¼šjava.lang.NullPointerException: Cannot invoke <span class="hljs-string">"Object.toString()"</span> because <span class="hljs-string">"object"</span> is <span class="hljs-literal">null</span>
Thread-<span class="hljs-number">5</span> æŠ›å‡ºäº†å¼‚å¸¸ï¼šjava.lang.NullPointerException: Cannot invoke <span class="hljs-string">"Object.toString()"</span> because <span class="hljs-string">"object"</span> is <span class="hljs-literal">null</span>
Thread-<span class="hljs-number">6</span> æŠ›å‡ºäº†å¼‚å¸¸ï¼šjava.lang.NullPointerException: Cannot invoke <span class="hljs-string">"Object.toString()"</span> because <span class="hljs-string">"object"</span> is <span class="hljs-literal">null</span>
</code></pre>
<p>ç¬¬4ç§æ–¹å¼ï¼šé‡å†™ThreadPoolExecutorçš„afterExecute()æ–¹æ³•ã€‚</p>
<p>åœ¨ä½¿ç”¨execute()æäº¤ä»»åŠ¡çš„æ—¶å€™ï¼ˆsubmit()å…¶å®ä¹Ÿæ˜¯è°ƒç”¨çš„execute()æ–¹æ³•ï¼‰ï¼Œä¼šæ‰§è¡ŒThreadPoolExecutorçš„runWorker()æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadPoolExecutor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractExecutorService</span> {

    <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">runWorker</span><span class="hljs-params">(Worker w)</span> {
        <span class="hljs-type">Thread</span> <span class="hljs-variable">wt</span> <span class="hljs-operator">=</span> Thread.currentThread();
        <span class="hljs-type">Runnable</span> <span class="hljs-variable">task</span> <span class="hljs-operator">=</span> w.firstTask;
        w.firstTask = <span class="hljs-literal">null</span>;
        w.unlock(); <span class="hljs-comment">// allow interrupts</span>
        <span class="hljs-type">boolean</span> <span class="hljs-variable">completedAbruptly</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">while</span> (task != <span class="hljs-literal">null</span> || (task = getTask()) != <span class="hljs-literal">null</span>) {
                w.lock();
                <span class="hljs-comment">// If pool is stopping, ensure thread is interrupted;</span>
                <span class="hljs-comment">// if not, ensure thread is not interrupted. This</span>
                <span class="hljs-comment">// requires a recheck in second case to deal with</span>
                <span class="hljs-comment">// shutdownNow race while clearing interrupt</span>
                <span class="hljs-keyword">if</span> ((runStateAtLeast(ctl.get(), STOP) ||
                        (Thread.interrupted() &amp;&amp;
                                runStateAtLeast(ctl.get(), STOP))) &amp;&amp;
                        !wt.isInterrupted())
                    wt.interrupt();
                <span class="hljs-keyword">try</span> {
                    beforeExecute(wt, task);
                    <span class="hljs-type">Throwable</span> <span class="hljs-variable">thrown</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
                    <span class="hljs-keyword">try</span> {
                        task.run();
                    } <span class="hljs-keyword">catch</span> (RuntimeException x) {
                        thrown = x;
                        <span class="hljs-keyword">throw</span> x;
                    } <span class="hljs-keyword">catch</span> (Error x) {
                        thrown = x;
                        <span class="hljs-keyword">throw</span> x;
                    } <span class="hljs-keyword">catch</span> (Throwable x) {
                        thrown = x;
                        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(x);
                    } <span class="hljs-keyword">finally</span> {
                        afterExecute(task, thrown);
                    }
                } <span class="hljs-keyword">finally</span> {
                    task = <span class="hljs-literal">null</span>;
                    w.completedTasks++;
                    w.unlock();
                }
            }
            completedAbruptly = <span class="hljs-literal">false</span>;
        } <span class="hljs-keyword">finally</span> {
            processWorkerExit(w, completedAbruptly);
        }
    }
}
</code></pre>
<p>ä¸Šé¢çš„ä»£ç ä¼šä¸åœåœ°ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡æ‰§è¡Œï¼Œå¦‚æœrun()æ–¹æ³•æŠ›å‡ºäº†å¼‚å¸¸ï¼Œä¼šæŠŠå¼‚å¸¸èµ‹å€¼ç»™thrownï¼Œæœ€ç»ˆä¼ ç»™afterExecute()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•é»˜è®¤æ˜¯ç©ºçš„ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®ç°è¿™ä¸ªæ–¹æ³•è¿›è¡Œå¤„ç†ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ExtendedExecutor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ThreadPoolExecutor</span> {
    <span class="hljs-comment">// jdkæ–‡æ¡£é‡Œé¢çš„ä¾‹å­</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterExecute</span><span class="hljs-params">(Runnable r, Throwable t)</span> {
        <span class="hljs-built_in">super</span>.afterExecute(r, t);
        <span class="hljs-keyword">if</span> (t == <span class="hljs-literal">null</span> &amp;&amp; r <span class="hljs-keyword">instanceof</span> Future&lt;?&gt;) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-type">Object</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> ((Future&lt;?&gt;) r).get();
            } <span class="hljs-keyword">catch</span> (CancellationException ce) {
                t = ce;
            } <span class="hljs-keyword">catch</span> (ExecutionException ee) {
                t = ee.getCause();
            } <span class="hljs-keyword">catch</span> (InterruptedException ie) {
                Thread.currentThread().interrupt(); <span class="hljs-comment">// ignore/reset</span>
            }
        }
        <span class="hljs-keyword">if</span> (t != <span class="hljs-literal">null</span>)
            System.out.println(t);
    }
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Androidè¾“å…¥ç³»ç»Ÿæºç åˆ†æ(ä¸‹)]]></title>    <link>https://juejin.cn/post/7591293897085534258</link>    <guid>https://juejin.cn/post/7591293897085534258</guid>    <pubDate>2026-01-04T12:32:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591293897085534258" data-draft-id="7591360623469379594" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Androidè¾“å…¥ç³»ç»Ÿæºç åˆ†æ(ä¸‹)"/> <meta itemprop="keywords" content="æºç "/> <meta itemprop="datePublished" content="2026-01-04T12:32:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="CarryZhang"/> <meta itemprop="url" content="https://juejin.cn/user/782508007385415"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Androidè¾“å…¥ç³»ç»Ÿæºç åˆ†æ(ä¸‹)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/782508007385415/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    CarryZhang
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T12:32:42.000Z" title="Sun Jan 04 2026 12:32:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»24åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸Šä¸€ç¯‡<a href="https://juejin.cn/editor/drafts/7591360623469363210" target="_blank" title="https://juejin.cn/editor/drafts/7591360623469363210">Androidè¾“å…¥ç³»ç»Ÿæºç åˆ†æ(ä¸Š)</a> ä¸»è¦è®²è¿°äº†è¾“å…¥äº‹ä»¶çš„è¯»å–å’Œåˆ†å‘ï¼Œè¿™é‡Œæ¥ç€åˆ†æäº‹ä»¶çš„æ¥å—ï¼Œå¤„ç†å®Œçš„å›ä¼ å’Œäº‹ä»¶ANRçš„æµç¨‹ã€‚</p>
<h2 data-id="heading-0">5.Appçª—å£æ¥å—äº‹ä»¶ä»¥åŠä¼ é€’åˆ°View/Activity</h2>
<p>å‰é¢çš„ç« èŠ‚å·²ç»åˆ†æçš„è¾“å…¥äº‹ä»¶çš„è¯»å–å’Œåœ¨serverç«¯çš„åˆ†å‘ï¼Œåˆ†å‘æœ€ç»ˆè°ƒç”¨çš„æ˜¯socketå‘é€æ•°æ®ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä»Appçª—å£çš„åˆå§‹åŒ–æµç¨‹åˆ†æï¼Œé‡ç‚¹å…³æ³¨äºè¾“å…¥äº‹ä»¶æœ‰å…³çš„apiè°ƒç”¨ã€‚ç¨å¾®è·Ÿè¿›ä¸€ä¸‹Appçª—å£çš„åˆå§‹åŒ–é€»è¾‘ï¼Œå°±ä¼šå‘ç° Appçª—å£æ·»åŠ æ—¶æœ€ç»ˆéƒ½ä¼šèµ°åˆ° <code>ViewRootImpl.setView</code>ï¼Œå¯¹è¿™ä¸€å—è°ƒç”¨æµç¨‹ä¸æ¸…æ¥šçš„å¯ä»¥å‚è€ƒ <a href="https://juejin.cn/editor/drafts/7462671646630199346" target="_blank" title="https://juejin.cn/editor/drafts/7462671646630199346">Androidçª—å£æ·»åŠ æµç¨‹æºç åˆ†æ</a>. ä¸‹é¢çš„ åˆ†æå°±ä» <code>ViewRootImpl.setView</code> å¼€å§‹ï¼Œ<code>ViewRootImpl.setView</code>æ•´ä¸ªæ–¹æ³•æ¯”è¾ƒé•¿ï¼Œæ ¸å¿ƒé€»è¾‘ä»£ç ä¹Ÿå¾ˆå¤šï¼Œè¿™é‡Œé‡ç‚¹å…³æ³¨è¾“å…¥äº‹ä»¶ç›¸å…³çš„é€»è¾‘ï¼Œè¿˜æ˜¯æˆªå–éƒ¨åˆ†ç›¸å…³ä»£ç æ¥åˆ†æ</p>
<pre><code class="hljs language-ini" lang="ini"> frameworks/base/core/java/android/view/ViewRootImpl.java
 public void setView(View view, WindowManager.LayoutParams attrs, View panelParentView,
            int userId) {
        synchronized (this) {
            if (<span class="hljs-attr">mView</span> == null) {
                <span class="hljs-attr">mView</span> = view<span class="hljs-comment">;</span>

                ...
                InputChannel <span class="hljs-attr">inputChannel</span> = null<span class="hljs-comment">;</span>
                if ((mWindowAttributes.inputFeatures
                        &amp; WindowManager.LayoutParams.INPUT_FEATURE_NO_INPUT_CHANNEL) == 0) {
                    //åˆå§‹åŒ– InputChannel
                    <span class="hljs-attr">inputChannel</span> = new InputChannel()<span class="hljs-comment">;//æ³¨é‡Š34</span>
                }
                

                try {
                    ...
                    //æ·»åŠ çª—å£åˆ°ws
                    <span class="hljs-attr">res</span> = mWindowSession.addToDisplayAsUser(mWindow, mWindowAttributes,
                            getHostVisibility(), mDisplay.getDisplayId(), userId,
                            mInsetsController.getRequestedVisibleTypes(), inputChannel, mTempInsets,
                            mTempControls, attachedFrame, compatScale)<span class="hljs-comment">;//æ³¨é‡Š35</span>
                   ...
                } catch (RemoteException | RuntimeException e) {
                  ...
                } finally {
                   ...
                }
                ...
                if (inputChannel != null) {
                    if (mInputQueueCallback != null) {
                        <span class="hljs-attr">mInputQueue</span> = new InputQueue()<span class="hljs-comment">;</span>
                        mInputQueueCallback.onInputQueueCreated(mInputQueue)<span class="hljs-comment">;</span>
                    }
                    //åˆå§‹åŒ– äº‹ä»¶æ¥å—çš„ InputEventReceiver
                    <span class="hljs-attr">mInputEventReceiver</span> = new WindowInputEventReceiver(inputChannel,
                            Looper.myLooper())<span class="hljs-comment">;//æ³¨é‡Š36</span>
                    ...
                }
                ...
                view.assignParent(this)<span class="hljs-comment">;</span>
                ...
                // Set up the input pipeline.
                // æ·»åŠ  Input äº‹ä»¶å¤„ç†å™¨ç®¡çº¿
                CharSequence <span class="hljs-attr">counterSuffix</span> = attrs.getTitle()<span class="hljs-comment">;</span>
                <span class="hljs-attr">mSyntheticInputStage</span> = new SyntheticInputStage()<span class="hljs-comment">;</span>
                InputStage <span class="hljs-attr">viewPostImeStage</span> = new ViewPostImeInputStage(mSyntheticInputStage)<span class="hljs-comment">;//æ³¨é‡Š37</span>
                InputStage <span class="hljs-attr">nativePostImeStage</span> = new NativePostImeInputStage(viewPostImeStage,
                        "aq:native-post-ime:" + counterSuffix)<span class="hljs-comment">;</span>
                InputStage <span class="hljs-attr">earlyPostImeStage</span> = new EarlyPostImeInputStage(nativePostImeStage)<span class="hljs-comment">;</span>
                InputStage <span class="hljs-attr">imeStage</span> = new ImeInputStage(earlyPostImeStage,
                        "aq:ime:" + counterSuffix)<span class="hljs-comment">;</span>
                InputStage <span class="hljs-attr">viewPreImeStage</span> = new ViewPreImeInputStage(imeStage)<span class="hljs-comment">;</span>
                InputStage <span class="hljs-attr">nativePreImeStage</span> = new NativePreImeInputStage(viewPreImeStage,
                        "aq:native-pre-ime:" + counterSuffix)<span class="hljs-comment">;</span>

                <span class="hljs-attr">mFirstInputStage</span> = nativePreImeStage<span class="hljs-comment">;</span>
                <span class="hljs-attr">mFirstPostImeInputStage</span> = earlyPostImeStage<span class="hljs-comment">;</span>
                ....
            }
        }
    }

</code></pre>
<p>æˆ‘ä»¬å…ˆçœ‹ä¸‹ App çª—å£ä¸Šçš„InputChannel æ˜¯å¦‚ä½•åˆå§‹åŒ–ï¼Œä»¥åŠå¦‚ä½•å…³è”åˆ°Serverç«¯ï¼Œå’ŒInputDispatcherçš„äº‹ä»¶åˆ†å‘å…³è”ä¸Šã€‚</p>
<h3 data-id="heading-1">5.1 App çª—å£ InputChannel åˆå§‹åŒ–å’Œå…³è”Server</h3>
<ul>
<li><strong>æ³¨é‡Š34</strong> åˆå§‹åŒ–äº†ä¸€ä¸ª java çš„ InputChannel</li>
<li><strong>æ³¨é‡Š35</strong> å¼€å§‹è°ƒç”¨æ·»åŠ çª—å£çš„é€»è¾‘ï¼Œæ·»åŠ çª—å£çš„æ•´ä¸ªé€»è¾‘ä¹Ÿæ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œå…ˆä¸å±•å¼€äº†ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»é˜…è¯»<a href="https://juejin.cn/editor/drafts/7462671646630199346" target="_blank" title="https://juejin.cn/editor/drafts/7462671646630199346">Androidçª—å£æ·»åŠ æµç¨‹æºç åˆ†æ</a>ï¼Œ è¿˜æ˜¯åªå…³æ³¨è¾“å…¥äº‹ä»¶ç›¸å…³çš„é€»è¾‘ï¼Œæ·»åŠ çª—å£çš„é€»è¾‘ä¼šæ¥åˆ°<code> WMS.addWindow</code>,è¿™é‡Œæ„å»ºäº†ä¸€ä¸ª WindowStateå¯¹è±¡(æ¯ä¸ªçª—å£éƒ½æœ‰ä¸€ä¸ªWindowStateå¯¹è±¡ï¼ŒWMSé‡Œå­˜åœ¨çš„çª—å£å¯¹è±¡)ï¼Œç„¶å è°ƒç”¨äº†<code> win.openInputChannel(outInputChannel)</code>,è¿™é‡Œçš„ outInputChannel å°±æ˜¯æˆ‘ä»¬å¤–é¢åœ¨ ViewRootImplåˆå§‹åŒ–æ„å»ºçš„ InputChannelï¼Œå³ <code>æ³¨é‡Š34</code> é‚£é‡Œçš„ inputChannelå¯¹è±¡ã€‚</li>
</ul>
<pre><code class="hljs language-java" lang="java">frameworks/base/services/core/java/com/android/server/wm/Session.java
   <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">addToDisplayAsUser</span><span class="hljs-params">(IWindow window, WindowManager.LayoutParams attrs,
            <span class="hljs-type">int</span> viewVisibility, <span class="hljs-type">int</span> displayId, <span class="hljs-type">int</span> userId, <span class="hljs-meta">@InsetsType</span> <span class="hljs-type">int</span> requestedVisibleTypes,
            InputChannel outInputChannel, InsetsState outInsetsState,
            InsetsSourceControl.Array outActiveControls, Rect outAttachedFrame,
            <span class="hljs-type">float</span>[] outSizeCompatScale)</span> {
            <span class="hljs-comment">//è¿™é‡Œçš„mServiceå³ WMS(WindowManagerService)</span>
        <span class="hljs-keyword">return</span> mService.addWindow(<span class="hljs-built_in">this</span>, window, attrs, viewVisibility, displayId, userId,
                requestedVisibleTypes, outInputChannel, outInsetsState, outActiveControls,
                outAttachedFrame, outSizeCompatScale);
    }
    
    
frameworks/base/services/core/java/com/android/server/wm/WindowManagerService.java
<span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">addWindow</span><span class="hljs-params">(Session session, IWindow client, LayoutParams attrs, <span class="hljs-type">int</span> viewVisibility,
            <span class="hljs-type">int</span> displayId, <span class="hljs-type">int</span> requestUserId, <span class="hljs-meta">@InsetsType</span> <span class="hljs-type">int</span> requestedVisibleTypes,
            InputChannel outInputChannel, InsetsState outInsetsState,
            InsetsSourceControl.Array outActiveControls, Rect outAttachedFrame,
            <span class="hljs-type">float</span>[] outSizeCompatScale)</span> {
        outActiveControls.set(<span class="hljs-literal">null</span>, <span class="hljs-literal">false</span> <span class="hljs-comment">/* copyControls */</span>);
        ...
        <span class="hljs-keyword">synchronized</span> (mGlobalLock) {
            ...
            <span class="hljs-keyword">final</span> <span class="hljs-type">WindowState</span> <span class="hljs-variable">win</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WindowState</span>(<span class="hljs-built_in">this</span>, session, client, token, parentWindow,
                    appOp[<span class="hljs-number">0</span>], attrs, viewVisibility, session.mUid, userId,
                    session.mCanAddInternalSystemWindow);
            ....
            <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">openInputChannels</span> <span class="hljs-operator">=</span> (outInputChannel != <span class="hljs-literal">null</span>
                    &amp;&amp; (attrs.inputFeatures &amp; INPUT_FEATURE_NO_INPUT_CHANNEL) == <span class="hljs-number">0</span>);
            <span class="hljs-keyword">if</span>  (openInputChannels) {
                win.openInputChannel(outInputChannel);
            }
            ...
        }
        ...
        <span class="hljs-keyword">return</span> res;
    }

</code></pre>
<p>ç»§ç»­è·Ÿè¿› <code>WindowState.openInputChannel</code>ï¼Œå…³é”®ä»£ç å¦‚ä¸‹</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">frameworks</span>/<span class="hljs-selector-tag">base</span>/<span class="hljs-selector-tag">services</span>/<span class="hljs-selector-tag">core</span>/<span class="hljs-selector-tag">java</span>/<span class="hljs-selector-tag">com</span>/<span class="hljs-selector-tag">android</span>/<span class="hljs-selector-tag">server</span>/<span class="hljs-selector-tag">wm</span>/<span class="hljs-selector-tag">WindowState</span><span class="hljs-selector-class">.java</span>
 <span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">openInputChannel</span>(<span class="hljs-variable">@NonNull</span> InputChannel outInputChannel) {
        <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">name</span> = <span class="hljs-selector-tag">getName</span>();
        <span class="hljs-selector-tag">mInputChannel</span> = <span class="hljs-selector-tag">mWmService</span><span class="hljs-selector-class">.mInputManager</span><span class="hljs-selector-class">.createInputChannel</span>(name);<span class="hljs-comment">//æ³¨é‡Š38</span>
        <span class="hljs-selector-tag">mInputChannelToken</span> = <span class="hljs-selector-tag">mInputChannel</span><span class="hljs-selector-class">.getToken</span>();
        <span class="hljs-selector-tag">mInputWindowHandle</span><span class="hljs-selector-class">.setToken</span>(mInputChannelToken);<span class="hljs-comment">//æ³¨é‡Š39</span>
        <span class="hljs-selector-tag">mWmService</span><span class="hljs-selector-class">.mInputToWindowMap</span><span class="hljs-selector-class">.put</span>(mInputChannelToken, this);
        <span class="hljs-selector-tag">mInputChannel</span><span class="hljs-selector-class">.copyTo</span>(outInputChannel);<span class="hljs-comment">//æ³¨é‡Š40</span>
    }
</code></pre>
<ul>
<li><strong>æ³¨é‡Š38</strong> è¿™é‡Œçš„ mInputManager å°±æ˜¯ æˆ‘ä»¬åœ¨ç¬¬äºŒç« èŠ‚ <code>IMSç³»ç»Ÿåˆå§‹åŒ–</code> ä¸­çš„ InputManagerService å¯¹è±¡ï¼Œåˆå§‹åŒ– WMSæ—¶å°±å…³è”äº†IMSï¼ŒIMS.createInputChannel ä¸€æ­¥æ­¥è°ƒç”¨æ¥åˆ° nativeçš„nativeCreateInputChannelï¼Œä¸»è¦é€»è¾‘å¦‚ä¸‹ï¼Œ</li>
</ul>

<pre><code class="hljs language-c" lang="c">frameworks/base/services/core/jni/com_android_server_input_InputManagerService.cpp
<span class="hljs-type">static</span> jobject <span class="hljs-title function_">nativeCreateInputChannel</span><span class="hljs-params">(JNIEnv* env, jobject nativeImplObj, jstring nameObj)</span> {
    NativeInputManager* im = getNativeInputManager(env, nativeImplObj);
    ...
    <span class="hljs-comment">//æ„é€ Native çš„ InputChannel</span>
    base::Result&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">unique_ptr</span>&lt;InputChannel&gt;&gt; inputChannel = im-&gt;createInputChannel(name);<span class="hljs-comment">//æ³¨é‡Š41</span>
    
    <span class="hljs-comment">//æ„é€ Javaå±‚çš„ InputChannelï¼Œå¹¶ä¸”å…³è”Native çš„ InputChannel</span>
    jobject inputChannelObj =
            android_view_InputChannel_createJavaObject(env, <span class="hljs-built_in">std</span>::move(*inputChannel));<span class="hljs-comment">//æ³¨é‡Š42</span>
    ...
    <span class="hljs-comment">//æœ€ç»ˆè¿”å›äº† clientChannel ç»™ App åº”ç”¨ç«¯</span>
    <span class="hljs-keyword">return</span> inputChannelObj;<span class="hljs-comment">//æ³¨é‡Š43</span>
}

base::Result&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">unique_ptr</span>&lt;InputChannel&gt;&gt; NativeInputManager::createInputChannel(
        <span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; name) {
    ATRACE_CALL();
    <span class="hljs-keyword">return</span> mInputManager-&gt;getDispatcher().createInputChannel(name);<span class="hljs-comment">//æ³¨é‡Š44</span>
}
</code></pre>
<p>çœ‹åˆ°<code>æ³¨é‡Š44</code>è¿™è¡Œä»£ç æ˜¯ä¸æ˜¯æœ‰æŸ³æš—èŠ±æ˜åˆä¸€æ‘çš„æ„Ÿè§‰ï¼Œæˆ‘ä»¬åˆå›åˆ°äº† InputDispatcher äº†ï¼ŒåŸæ¥æ·»åŠ çª—å£æ—¶ä¼šè°ƒç”¨ <code>InputDispatcher::createInputChannel</code> åˆ›å»º InputChannel(å…³è”äº†socket)ï¼Œåˆ°è¿™é‡ŒåŸºæœ¬å°±å¿«å’Œ <code>4.2 InputDispatcher äº‹ä»¶å‡ºåˆ—åˆ†å‘</code> æœ€åçš„çŒœæƒ³å¯¹ä¸Šäº†ã€‚ç»§ç»­è·Ÿè¿› <code>InputDispatcher::createInputChannel</code> å…³é”®ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-c" lang="c">frameworks/native/services/inputflinger/dispatcher/InputDispatcher.cpp
Result&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">unique_ptr</span>&lt;InputChannel&gt;&gt; InputDispatcher::createInputChannel(<span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; name) {
    

    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">unique_ptr</span>&lt;InputChannel&gt; serverChannel;
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">unique_ptr</span>&lt;InputChannel&gt; clientChannel;
    <span class="hljs-comment">//åˆ›å»º InputChannel å¯¹ï¼Œä¸€ä¸ªserverï¼Œä¸€ä¸ªclient</span>
    <span class="hljs-type">status_t</span> result = InputChannel::openInputChannelPair(name, serverChannel, clientChannel);<span class="hljs-comment">//æ³¨é‡Š45</span>

   ...

    { <span class="hljs-comment">// acquire lock</span>
        <span class="hljs-built_in">std</span>::scoped_lock _l(mLock);
        <span class="hljs-type">const</span> sp&lt;IBinder&gt;&amp; token = serverChannel-&gt;getConnectionToken();
        <span class="hljs-type">const</span> <span class="hljs-type">int</span> fd = serverChannel-&gt;getFd();
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Connection&gt; connection =
                <span class="hljs-built_in">std</span>::make_shared&lt;Connection&gt;(<span class="hljs-built_in">std</span>::move(serverChannel), <span class="hljs-comment">/*monitor=*/</span><span class="hljs-literal">false</span>,
                                             mIdGenerator);
                                             
        <span class="hljs-comment">//æ·»åŠ  token å’ŒserverClient åˆ° mConnectionsByTokenï¼Œè¿™æ · InputDispatcher åˆ†å‘äº‹ä»¶å°±çŸ¥é“ ç”¨å“ªä¸ª serverClient äº†</span>
        <span class="hljs-keyword">auto</span> [_, inserted] = mConnectionsByToken.try_emplace(token, connection);<span class="hljs-comment">// æ³¨é‡Š46</span>
       
       ...

        <span class="hljs-built_in">std</span>::function&lt;<span class="hljs-type">int</span>(<span class="hljs-type">int</span> events)&gt; callback = <span class="hljs-built_in">std</span>::bind(&amp;InputDispatcher::handleReceiveCallback,
                                                            this, <span class="hljs-built_in">std</span>::placeholders::_1, token);
        
        <span class="hljs-comment">//æ·»åŠ  serverCleint çš„ socketFd ç›‘å¬ï¼Œç›‘å¬æœ‰æ•°æ®å†™å…¥(å³clientServerå†™å‡ºæ•°æ®)æ—¶ï¼Œ</span>
        <span class="hljs-comment">//ä¼šè°ƒç”¨InputDispatcher::handleReceiveCallback,è¿™ä¸ªåœ¨åé¢çš„ç¬¬6ç« èŠ‚å’Œç¬¬7ç« èŠ‚ä¼šé‡ç‚¹åˆ†æ</span>
        mLooper-&gt;addFd(fd, <span class="hljs-number">0</span>, ALOOPER_EVENT_INPUT, sp&lt;LooperEventCallback&gt;::make(callback),
                       nullptr);<span class="hljs-comment">//æ³¨é‡Š47</span>
    } <span class="hljs-comment">// release lock</span>

    <span class="hljs-comment">// Wake the looper because some connections have changed.</span>
    mLooper-&gt;wake();
    
    <span class="hljs-keyword">return</span> clientChannel;
}


frameworks/native/libs/input/InputTransport.cpp
<span class="hljs-type">status_t</span> <span class="hljs-title function_">InputChannel::openInputChannelPair</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; name,
                                            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">unique_ptr</span>&lt;InputChannel&gt;&amp; outServerChannel,
                                            <span class="hljs-built_in">std</span>::<span class="hljs-built_in">unique_ptr</span>&lt;InputChannel&gt;&amp; outClientChannel)</span> {
    <span class="hljs-type">int</span> sockets[<span class="hljs-number">2</span>];
    <span class="hljs-comment">//åˆ›å»ºsocketå¯¹</span>
    <span class="hljs-keyword">if</span> (socketpair(AF_UNIX, SOCK_SEQPACKET, <span class="hljs-number">0</span>, sockets)) {<span class="hljs-comment">//æ³¨é‡Š48</span>
        <span class="hljs-type">status_t</span> result = -errno;
        ALOGE(<span class="hljs-string">"channel '%s' ~ Could not create socket pair.  errno=%s(%d)"</span>, name.c_str(),
              strerror(errno), errno);
        outServerChannel.reset();
        outClientChannel.reset();
        <span class="hljs-keyword">return</span> result;
    }

    <span class="hljs-type">int</span> bufferSize = SOCKET_BUFFER_SIZE;
    setsockopt(sockets[<span class="hljs-number">0</span>], SOL_SOCKET, SO_SNDBUF, &amp;bufferSize, <span class="hljs-keyword">sizeof</span>(bufferSize));
    setsockopt(sockets[<span class="hljs-number">0</span>], SOL_SOCKET, SO_RCVBUF, &amp;bufferSize, <span class="hljs-keyword">sizeof</span>(bufferSize));
    setsockopt(sockets[<span class="hljs-number">1</span>], SOL_SOCKET, SO_SNDBUF, &amp;bufferSize, <span class="hljs-keyword">sizeof</span>(bufferSize));
    setsockopt(sockets[<span class="hljs-number">1</span>], SOL_SOCKET, SO_RCVBUF, &amp;bufferSize, <span class="hljs-keyword">sizeof</span>(bufferSize));

    sp&lt;IBinder&gt; token = sp&lt;BBinder&gt;::make();

    android::base::unique_fd <span class="hljs-title function_">serverFd</span><span class="hljs-params">(sockets[<span class="hljs-number">0</span>])</span>;
    <span class="hljs-comment">//serverChannel å…³è” serverSocket</span>
    outServerChannel = InputChannel::create(name, <span class="hljs-built_in">std</span>::move(serverFd), token);<span class="hljs-comment">//æ³¨é‡Š49</span>

    android::base::unique_fd <span class="hljs-title function_">clientFd</span><span class="hljs-params">(sockets[<span class="hljs-number">1</span>])</span>;
    <span class="hljs-comment">//clientChannel å…³è” cleintSocket</span>
    outClientChannel = InputChannel::create(name, <span class="hljs-built_in">std</span>::move(clientFd), token);<span class="hljs-comment">//æ³¨é‡Š50</span>
    <span class="hljs-keyword">return</span> OK;
}
</code></pre>
<ul>
<li>
<p><strong>æ³¨é‡Š45</strong> é€šè¿‡ <code>æ³¨é‡Š48</code> åˆ›å»ºäº†socketå¯¹ï¼Œå¹¶é€šè¿‡<code>æ³¨é‡Š49</code>æŠŠ serverInputChannel å…³è”åˆ° serverSocketï¼Œé€šè¿‡<code>æ³¨é‡Š50</code>æŠŠclientInputChannelå…³è”åˆ°cleintSocketã€‚è¿™æ ·å°±å®Œæˆäº†serverInputChannelå’ŒclientInputChannelçš„åˆ›å»ºä»¥åŠå…³ç³»ç»‘å®š.</p>
</li>
<li>
<p><strong>æ³¨é‡Š46</strong> å°†serverChannelå’Œtoken æ·»åŠ åˆ° mConnectionsByToken é›†åˆä¸­ï¼Œç„¶ååœ¨<code>4.2 InputDispatcher äº‹ä»¶å‡ºåˆ—åˆ†å‘</code> ä¸­ <code>æ³¨é‡Š30</code> å¤„çš„ <code>findTouchedWindowTargetsLocked</code> ä¼šæ ¹æ® çª—å£çš„token æ‰¾åˆ°å¯¹åº”çš„ serverInputChannel,å°† äº‹ä»¶ã€çª—å£ã€InputChannel(socket)å¯¹ ä¸‰è€…å…³è”ä¸Šï¼Œè¿™æ ·æœ€å <code>æ³¨é‡Š33</code>å¤„è°ƒç”¨socketå‘é€äº‹ä»¶å°±èƒ½å‘é€åˆ°å¯¹åº”çš„çª—å£äº†ã€‚<code>findTouchedWindowTargetsLocked</code> çš„é€»è¾‘å°±ä¸å±•å¼€åˆ†æï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥è‡ªè¡Œè·Ÿè¿›æºç éªŒè¯ã€‚</p>
</li>
<li>
<p><strong>æ³¨é‡Š47</strong> è¿™é‡Œæ˜¯å°† serverInputChannelçš„socketçš„fdçš„è¾“å…¥äº‹ä»¶ALOOPER_EVENT_INPUTæ·»åŠ åˆ°mLooperçš„ç›‘å¬ä¸­ï¼Œè¿™æ ·å½“ clientInputChannelçš„ socket å†™å…¥æ•°æ®æ—¶ï¼Œå°±ä¼šå”¤é†’è¿™é‡Œçš„ handleReceiveCallbackï¼Œåœ¨ ç¬¬å…­ã€ä¸ƒç« èŠ‚ä¼šé‡ç‚¹åˆ†æè¿™é‡Œã€‚</p>
</li>
<li>
<p><strong>æ³¨é‡Š41</strong> åˆ°è¿™é‡ŒåŸºæœ¬ç®—å®Œæˆäº†Nativeå±‚çš„InputChannelçš„åˆ›å»ºå’Œåˆå§‹åŒ–</p>
</li>
<li>
<p><strong>æ³¨é‡Š42</strong> åˆ›å»ºJavaå±‚çš„InputChannelå¹¶å…³è”InputDispatcherè¿”å›çš„Nativeå±‚InputChannel,è¯¦ç»†é€»è¾‘å¦‚ä¸‹</p>
</li>
</ul>
<pre><code class="hljs language-ini" lang="ini">frameworks/base/core/jni/android_view_InputChannel.cpp
jobject android_view_InputChannel_createJavaObject(JNIEnv* env,
                                                   std::unique_ptr&lt;InputChannel&gt; inputChannel) {
    std::string <span class="hljs-attr">name</span> = inputChannel-&gt;getName()<span class="hljs-comment">;</span>
    //å°†InputDispatcherè¿”å›çš„ Nativeå±‚çš„InputChannelå°è£…æˆ NativeInputChannel
    jlong <span class="hljs-attr">ptr</span> = android_view_InputChannel_createInputChannel(env, std::move(inputChannel))<span class="hljs-comment">;</span>
    
    //<span class="hljs-attr">gInputChannelClassInfo.clazz</span> = <span class="hljs-string">"android/view/InputChannel"</span>
    //<span class="hljs-attr">gInputChannelClassInfo.mCtor</span> = <span class="hljs-string">"&lt;init&gt;"</span>
    //è¿™é‡Œå°±æ˜¯è°ƒç”¨äº†Javaå±‚ InputChannel çš„æ„é€ å‡½æ•°æ„é€ äº† InputChannel å¯¹è±¡
    jobject <span class="hljs-attr">javaInputChannel</span> =
            env-&gt;NewObject(gInputChannelClassInfo.clazz, gInputChannelClassInfo.mCtor)<span class="hljs-comment">;</span>
    if (!javaInputChannel) {
        ALOGE("Failed to create a Java InputChannel for channel %s.", name.c_str())<span class="hljs-comment">;</span>
        return nullptr<span class="hljs-comment">;</span>
    }
    
    //<span class="hljs-attr">gInputChannelClassInfo.mSetNativeInputChannel</span> = <span class="hljs-string">"setNativeInputChannel"</span>
    //è°ƒç”¨Javaå±‚çš„ InputChannel.mPtrçš„ setNativeInputChannel å°†Nativeå±‚çš„ NativeInputChannel çš„å¼•ç”¨åœ°å€ä¼ é€’ç»™ Javaå±‚çš„ InputChannel.mPtr
    env-&gt;CallVoidMethod(javaInputChannel, gInputChannelClassInfo.mSetNativeInputChannel, ptr)<span class="hljs-comment">;</span>
    if (env-&gt;ExceptionOccurred()) {
        ALOGE("Failed to set native ptr to the Java InputChannel for channel %s.",
              inputChannel-&gt;getName().c_str())<span class="hljs-comment">;</span>
        return nullptr<span class="hljs-comment">;</span>
    }
    return javaInputChannel<span class="hljs-comment">;</span>
}

</code></pre>
<ul>
<li><strong>æ³¨é‡Š43</strong> è¿”å›Javaç«¯çš„ InputChannel(å…³è”äº†Nativeçš„InputChannel)ç»™Appã€‚</li>
</ul>
<p>å†å›åˆ°å‰é¢çš„<code>æ³¨é‡Š38</code>ï¼Œè¿™é‡Œå°†IMSåˆšåˆ›å»º çš„ InputChannelå…³è”çš„Nativeçš„InputChannel åˆä¼ é€’ ViewRootImplçª—å£æ·»åŠ æ—¶åˆ›å»ºçš„InputChannelï¼Œ
è¿™æ ·ViewRootImpl çª—å£æ·»åŠ setViewæ—¶åˆ›å»ºçš„InputChannelå°±èƒ½å…³è”åˆ°InputDispatcheråˆ›å»ºçš„clientInputChannel(å…³è”äº†cleintSocket)ã€‚åˆ°è¿™é‡Œï¼ŒåŸºæœ¬å®Œæˆäº†InputChannelåˆ›å»ºå’Œåˆå§‹åŒ–ä»¥åŠå…³è”Serverçš„é€»è¾‘ã€‚</p>
<p>ç›®å‰Appçª—å£ç«¯å·²ç»æ‹¿åˆ°äº†å…³è”Serverç«¯çš„InputChannel(socket), æ¥ä¸‹æ¥ç»§ç»­åˆ†æAppç«¯æ˜¯å¦‚ä½•ç›‘å¬è¿™ä¸ªsocketè¯»å–äº‹ä»¶å¹¶ä¸”åˆ†å‘åˆ°View/Activityçš„ã€‚</p>
<h3 data-id="heading-2">5.2 APP çª—å£æ¥å—äº‹ä»¶</h3>
<p>ç»§ç»­å›åˆ°ViewRootImplçš„setViewï¼Œä¸Šé¢åˆ†æäº†<code>æ³¨é‡Š35</code>æ˜¯å¦‚ä½•æ„é€ InputChannelå¹¶å…³è”åˆ°InputDispatcherä¸­çš„clientSocketã€‚</p>
<ul>
<li><strong>æ³¨é‡Š36</strong> åˆå§‹åŒ–InputEventReceiver,ä¼ å…¥äº†ä¸Šé¢åˆå§‹åŒ–çš„InputChannelå’ŒAppä¸»çº¿ç¨‹çš„Looperï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š</li>
</ul>

<pre><code class="hljs language-scss" lang="scss">frameworks/base/core/java/android/view/InputEventReceiver<span class="hljs-selector-class">.java</span>
public <span class="hljs-built_in">InputEventReceiver</span>(InputChannel inputChannel, Looper looper) {
    ...
    mInputChannel = inputChannel;
    mMessageQueue = looper<span class="hljs-selector-class">.getQueue</span>();
    mReceiverPtr = <span class="hljs-built_in">nativeInit</span>(new WeakReference&lt;InputEventReceiver&gt;(this),
            mInputChannel, mMessageQueue);
    ...
}


frameworks/base/core/jni/android_view_InputEventReceiver<span class="hljs-selector-class">.cpp</span>
static jlong <span class="hljs-built_in">nativeInit</span>(JNIEnv* env, jclass clazz, jobject receiverWeak,
        jobject inputChannelObj, jobject messageQueueObj) {
    <span class="hljs-comment">//è·å–Javaå±‚InputChannel.mPtr å¼•ç”¨,å³Nativeå±‚çš„InputChannel çš„å¼•ç”¨</span>
    std::shared_ptr&lt;InputChannel&gt; inputChannel =
            <span class="hljs-built_in">android_view_InputChannel_getInputChannel</span>(env, inputChannelObj);
    
    <span class="hljs-comment">//è·å–Javaå±‚MessageQueue.mPtr,å³Nativeå±‚çš„MessageQueue çš„å¼•ç”¨</span>
    sp&lt;MessageQueue&gt; messageQueue = <span class="hljs-built_in">android_os_MessageQueue_getMessageQueue</span>(env, messageQueueObj);
    

    sp&lt;NativeInputEventReceiver&gt; receiver = new <span class="hljs-built_in">NativeInputEventReceiver</span>(env,
            receiverWeak, inputChannel, messageQueue);
    <span class="hljs-comment">//åˆå§‹åŒ–</span>
    status_t status = receiver-&gt;<span class="hljs-built_in">initialize</span>();
    
    return reinterpret_cast&lt;jlong&gt;(receiver.get());
}

status_t NativeInputEventReceiver::<span class="hljs-built_in">initialize</span>() {
    <span class="hljs-built_in">setFdEvents</span>(ALOOPER_EVENT_INPUT);
    return OK;
}

void NativeInputEventReceiver::<span class="hljs-built_in">setFdEvents</span>(int events) {
    if (mFdEvents != events) {
        mFdEvents = events;
        const int fd = mInputConsumer<span class="hljs-selector-class">.getChannel</span>()-&gt;<span class="hljs-built_in">getFd</span>();
        if (events) {
            <span class="hljs-comment">//Android ä¸»çº¿ç¨‹çš„ Looper æ·»åŠ å¯¹ InputChannel çš„ socketçš„fdçš„ç›‘å¬</span>
            mMessageQueue-&gt;<span class="hljs-built_in">getLooper</span>()-&gt;<span class="hljs-built_in">addFd</span>(fd, <span class="hljs-number">0</span>, events, this, nullptr);<span class="hljs-comment">//æ³¨é‡Š51</span>
        } else {
            mMessageQueue-&gt;<span class="hljs-built_in">getLooper</span>()-&gt;<span class="hljs-built_in">removeFd</span>(fd);
        }
    }
}
</code></pre>
<ul>
<li><strong>æ³¨é‡Š51</strong> åˆ›å»ºInputEventReceiverçš„æ—¶å€™è°ƒç”¨äº†nativeInitåˆå§‹åŒ–æ–¹æ³•ï¼Œæœ€ç»ˆé€šè¿‡ <code>NativeInputEventReceiver::initialize()</code> è°ƒç”¨äº†<code>Looper::addFd</code>ï¼Œæ ¹æ®ä¹‹å‰çš„ä¼ å‚ï¼Œè¿™é‡Œä¾¿å®ŒæˆAppä¸»çº¿ç¨‹Nativeå±‚Looperå¯¹Nativeå±‚çš„clientInputChannelä¸­çš„socketçš„fdçš„ç›‘å¬ï¼Œå½“InputDispatcherä¸­åœ¨<code>æ³¨é‡Š33</code>å¤„è°ƒç”¨serverSocketå‘åŠ¨æ¶ˆæ¯æ—¶ï¼ŒAppä¸»çº¿ç¨‹çš„Nativeçš„Looperå°±ä¼šè¢«å”¤é†’ï¼Œè°ƒç”¨å›è°ƒ<code>handleEvent</code>å¼€å§‹äº‹ä»¶çš„åˆ†å‘.</li>
</ul>
<h3 data-id="heading-3">5.3 APP çª—å£åˆ†å‘äº‹ä»¶åˆ°View/Activity</h3>
<p>è¾“å…¥äº‹ä»¶çš„åˆ†å‘å…¥å£ä¸º <code> NativeInputEventReceiver::handleEvent</code>,æ¥ä¸‹æ¥æˆ‘ä»¬åˆ†æäº‹ä»¶æ˜¯å¦‚ä½•ä¸€æ­¥æ­¥ä¼ é€’åˆ°View/Activityçš„ã€‚handleEvent æ¥å—åˆ°äº‹ä»¶åˆ†å‘æ—¶ä¹Ÿä¼š ç»è¿‡å¾ˆå¤šæ¡ä»¶åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰§è¡Œï¼Œæ˜¯ç«‹å³æ‰§è¡Œè¿˜æ˜¯å»¶è¿Ÿæ‰§è¡Œï¼Œè¿™é‡Œè¿˜æ˜¯çœ‹å…³é”®ä»£ç æ¥åˆ†æä¸»æµç¨‹ï¼Œè¿™é‡Œè¿˜æ˜¯ä»¥å¸¸è§çš„è§¦æ‘¸äº‹ä»¶ä¸ºä¾‹è¿›è¡Œåˆ†æï¼Œéƒ¨åˆ†å…³é”®ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">frameworks/base/core/jni/android_view_InputEventReceiver<span class="hljs-selector-class">.cpp</span>
int NativeInputEventReceiver::<span class="hljs-built_in">handleEvent</span>(int receiveFd, int events, void* data) {
   ...
    if (events &amp; ALOOPER_EVENT_INPUT) {
        JNIEnv* env = AndroidRuntime::<span class="hljs-built_in">getJNIEnv</span>();
        <span class="hljs-comment">//æ¶ˆè´¹äº‹ä»¶</span>
        status_t status = <span class="hljs-built_in">consumeEvents</span>(env, /*consumeBatches=*/false, -<span class="hljs-number">1</span>, nullptr);<span class="hljs-comment">//æ³¨é‡Š52</span>
        return status == OK || status == NO_MEMORY ? KEEP_CALLBACK : REMOVE_CALLBACK;
    }
   ...
    return KEEP_CALLBACK;
}

status_t NativeInputEventReceiver::<span class="hljs-built_in">consumeEvents</span>(JNIEnv* env,
        bool consumeBatches, nsecs_t frameTime, bool* outConsumedBatch) {
    ...
    ScopedLocalRef&lt;jobject&gt; <span class="hljs-built_in">receiverObj</span>(env, nullptr);
    bool skipCallbacks = false;
    for (;;) {
        uint32_t seq;
        InputEvent* inputEvent;
         <span class="hljs-comment">// è¯»å–äº‹ä»¶</span>
        status_t status = mInputConsumer<span class="hljs-selector-class">.consume</span>(&amp;mInputEventFactory,
                consumeBatches, frameTime, &amp;seq, &amp;inputEvent);<span class="hljs-comment">//æ³¨é‡Š53</span>
        ...

        if (!skipCallbacks) {
            ...
            ScopedLocalRef&lt;jobject&gt; <span class="hljs-built_in">inputEventObj</span>(env);
            switch (inputEvent-&gt;getType()) {
                ...
                case InputEventType::MOTION: {
                    ...
                    <span class="hljs-comment">// å°†Nativeå±‚ çš„ MotionEvent ä¼ é€’ç»™ Java å±‚ çš„ MotionEvent</span>
                    inputEventObj = <span class="hljs-built_in">android_view_MotionEvent_obtainAsCopy</span>(env, motionEvent);<span class="hljs-comment">//æ³¨é‡Š54</span>
                    break;
                }
                ....
            }
            ...
            if (inputEventObj.get()) {
                ...
                <span class="hljs-comment">//è°ƒç”¨Java å±‚ InputEventReceiver.dispatchInputEvent</span>
                env-&gt;<span class="hljs-built_in">CallVoidMethod</span>(receiverObj.get(),
                                    gInputEventReceiverClassInfo<span class="hljs-selector-class">.dispatchInputEvent</span>, seq,
                                    inputEventObj<span class="hljs-selector-class">.get</span>());<span class="hljs-comment">//æ³¨é‡Š55</span>
            } else {
               ...
            }
        }
    }
}


frameworks/native/libs/<span class="hljs-selector-tag">input</span>/InputConsumer<span class="hljs-selector-class">.cpp</span>
status_t InputConsumer::<span class="hljs-built_in">consume</span>(InputEventFactoryInterface* factory, bool consumeBatches,
                                nsecs_t frameTime, uint32_t* outSeq, InputEvent** outEvent) {
    <span class="hljs-built_in">ALOGD_IF</span>(DEBUG_TRANSPORT_CONSUMER,
             "channel '%s' consumer ~ consume: consumeBatches=%s, frameTime=%" PRId64,
             mChannel-&gt;getName()<span class="hljs-selector-class">.c_str</span>(), <span class="hljs-built_in">toString</span>(consumeBatches), frameTime);

    *outSeq = <span class="hljs-number">0</span>;
    *outEvent = nullptr;

    ...
    while (!*outEvent) {
        if (mMsgDeferred) {
           ...
        } else {
            <span class="hljs-comment">// Receive a fresh message.</span>
            android::base::Result&lt;InputMessage&gt; result = mChannel-&gt;<span class="hljs-built_in">receiveMessage</span>();<span class="hljs-comment">//æ³¨é‡Š56</span>
            if (result.ok()) {
                mMsg = std::<span class="hljs-built_in">move</span>(result.<span class="hljs-built_in">value</span>());
                <span class="hljs-comment">//å¾€é˜Ÿåˆ—ä¸­æ·»åŠ äº‹ä»¶</span>
                const auto <span class="hljs-selector-attr">[_, inserted]</span> =
                        mConsumeTimes<span class="hljs-selector-class">.emplace</span>(mMsg.header.seq, systemTime(SYSTEM_TIME_MONOTONIC));
                ...
            } else {
                ...
            }
        }

        switch (mMsg.header.type) {
            ....
            case InputMessage::Type::MOTION: {
                ssize_t batchIndex = <span class="hljs-built_in">findBatch</span>(mMsg.body.motion.deviceId, mMsg.body.motion.source);
                if (batchIndex &gt;= <span class="hljs-number">0</span>) {
                    Batch&amp; batch = mBatches<span class="hljs-selector-attr">[batchIndex]</span>;
                    if (canAddSample(batch, &amp;mMsg)) {
                        batch<span class="hljs-selector-class">.samples</span><span class="hljs-selector-class">.push_back</span>(mMsg);
                        break;
                    } 
                }
                ....
                <span class="hljs-comment">//åˆ›å»ºäº‹ä»¶ MotionEvent</span>
                MotionEvent* motionEvent = factory-&gt;<span class="hljs-built_in">createMotionEvent</span>();
                if (!motionEvent) return NO_MEMORY;

                <span class="hljs-built_in">updateTouchState</span>(mMsg);
                <span class="hljs-comment">//åˆå§‹åŒ–äº‹ä»¶</span>
                <span class="hljs-built_in">initializeMotionEvent</span>(*motionEvent, mMsg);<span class="hljs-comment">//æ³¨é‡Š57</span>
                *outSeq = mMsg<span class="hljs-selector-class">.header</span><span class="hljs-selector-class">.seq</span>;
                *outEvent = motionEvent;
                
                break;
            }
            ...
        }
    }
    return OK;
}
</code></pre>
<p>è¿™é‡Œä¹Ÿæ¶‰åŠåˆ°å¾ˆå¤šäº‹ä»¶æ¶ˆæ¯çš„å…¥åˆ—å’Œå‡ºåˆ—é€»è¾‘ï¼Œè¿˜æœ‰ä¸€äº›æ‹¦æˆªä»¥åŠå¼‚å¸¸å¤„ç†æµç¨‹ï¼Œæˆ‘ä»¬ç›´æ¥è·³è¿‡ã€‚</p>
<ul>
<li><strong>æ³¨é‡Š56</strong> ä»cleintSocketä¸­è¯»å–InputDispatcherä¸­çš„serverSocketå‘é€çš„äº‹ä»¶æ•°æ®</li>
<li><strong>æ³¨é‡Š57</strong> åˆå§‹åŒ–å’Œç»„è£…è¯»å–åˆ°çš„äº‹ä»¶æ¶ˆæ¯åˆ°MotionEventä¸­</li>
<li><strong>æ³¨é‡Š54</strong> å°†Nativeå±‚ çš„ MotionEvent ä¼ é€’ç»™ Java å±‚ çš„ MotionEvent</li>
<li><strong>æ³¨é‡Š55</strong> è°ƒç”¨Java å±‚ InputEventReceiver.dispatchInputEventï¼ŒNativeå±‚è°ƒç”¨Javaå±‚é€»è¾‘å’Œä¸Šé¢çš„<code>æ³¨é‡Š42</code> çš„ å­æµç¨‹å¾ˆç±»ä¼¼ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œå»åˆ†æã€‚</li>
</ul>
<p>è¿™æ ·ç»è¿‡ äº‹ä»¶ä¹Ÿæ˜¯ç»è¿‡äº†è¯»å–ã€ç»„è£…ã€åˆ†å‘çš„æµç¨‹ï¼Œè·ŸInputFlinger(InputReader/InputDispatcher/EventHub)ä¸­çš„æµç¨‹åŸºæœ¬ç±»ä¼¼ï¼Œåªæ˜¯è¿‡ç¨‹çš„ç¹ç®€ã€‚æ¥ä¸‹æ¥çœ‹ä¸‹Javaå±‚çš„äº‹ä»¶ä¼ é€’æµç¨‹ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">frameworks/<span class="hljs-keyword">base</span>/core/java/android/view/InputEventReceiver.java
<span class="hljs-comment">// Called from native code.</span>
@SuppressWarnings(<span class="hljs-string">"unused"</span>)
@UnsupportedAppUsage(maxTargetSdk = Build.VERSION_CODES.R, trackingBug = <span class="hljs-number">170729553</span>)
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">dispatchInputEvent</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> seq, InputEvent <span class="hljs-keyword">event</span></span>)</span> {
    ...
    onInputEvent(<span class="hljs-keyword">event</span>);
    ...
}


@UnsupportedAppUsage(maxTargetSdk = Build.VERSION_CODES.R, trackingBug = <span class="hljs-number">170729553</span>)
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onInputEvent</span>(<span class="hljs-params">InputEvent <span class="hljs-keyword">event</span></span>)</span> {
    finishInputEvent(<span class="hljs-keyword">event</span>, <span class="hljs-literal">false</span>);
}
</code></pre>
<p><code>InputEventReceiver.dispatchInputEvent</code>æ–¹æ³•ç›´æ¥è°ƒç”¨ onInputEventï¼ŒonInputEventçš„é»˜è®¤æ˜¯ç°å® finishInputEventï¼Œè€Œæˆ‘ä»¬ åœ¨ ViewRootImplä¸­åˆå§‹åŒ–æ„é€ çš„æ˜¯ WindowInputEventReceiver(<code>æ³¨é‡Š36</code>)ï¼Œ
WindowInputEventReceiverçš„å®ç°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">frameworks/base/core/java/android/view/ViewRootImpl<span class="hljs-selector-class">.java</span>
final class WindowInputEventReceiver extends InputEventReceiver {
    ...
    <span class="hljs-keyword">@Override</span>
    public void onInputEvent(InputEvent event) {
        Trace<span class="hljs-selector-class">.traceBegin</span>(Trace.TRACE_TAG_VIEW, "processInputEventForCompatibility");
        List&lt;InputEvent&gt; processedEvents;
        try {
            processedEvents =
                mInputCompatProcessor<span class="hljs-selector-class">.processInputEventForCompatibility</span>(event);
        } finally {
            Trace<span class="hljs-selector-class">.traceEnd</span>(Trace.TRACE_TAG_VIEW);
        }
        if (processedEvents != null) {
            if (processedEvents.isEmpty()) {
                <span class="hljs-comment">// InputEvent consumed by mInputCompatProcessor</span>
                <span class="hljs-built_in">finishInputEvent</span>(event, true);
            } else {
                for (int i = <span class="hljs-number">0</span>; i &lt; processedEvents.size(); <span class="hljs-selector-tag">i</span>++) {
                    <span class="hljs-comment">//äº‹ä»¶å…¥åˆ—</span>
                    <span class="hljs-built_in">enqueueInputEvent</span>(
                            processedEvents.get(i), this,
                            QueuedInputEvent<span class="hljs-selector-class">.FLAG_MODIFIED_FOR_COMPATIBILITY</span>, true);
                }
            }
        } else {
            <span class="hljs-built_in">enqueueInputEvent</span>(event, this, <span class="hljs-number">0</span>, true);
        }
    }
    ...
}

 QueuedInputEvent <span class="hljs-built_in">enqueueInputEvent</span>(InputEvent event,
            InputEventReceiver receiver, int flags, boolean processImmediately) {
        QueuedInputEvent <span class="hljs-selector-tag">q</span> = <span class="hljs-built_in">obtainQueuedInputEvent</span>(event, receiver, flags);
        ...
        if (processImmediately) {
            <span class="hljs-built_in">doProcessInputEvents</span>();
        } else {
            <span class="hljs-comment">//å¼‚æ­¥å¤„ç†ï¼Œæœ€ç»ˆè¿˜æ˜¯ è°ƒç”¨  doProcessInputEvents</span>
            <span class="hljs-built_in">scheduleProcessInputEvents</span>();
        }
        return <span class="hljs-selector-tag">q</span>;
    }
void <span class="hljs-built_in">doProcessInputEvents</span>() {
    <span class="hljs-comment">// Deliver all pending input events in the queue.</span>
    while (mPendingInputEventHead != null) {
        ...
        <span class="hljs-comment">//ä¼ é€’äº‹ä»¶</span>
        <span class="hljs-built_in">deliverInputEvent</span>(q);
    }
    ...
}

 private void <span class="hljs-built_in">deliverInputEvent</span>(QueuedInputEvent q) {
    ...
    try {
        ...
        if (stage != null) {
            <span class="hljs-built_in">handleWindowFocusChanged</span>();
            <span class="hljs-comment">//ä¼ é€’äº‹ä»¶</span>
            stage<span class="hljs-selector-class">.deliver</span>(q);
        } else {
            <span class="hljs-built_in">finishInputEvent</span>(q);
        }
    } finally {
    }
}

 public final void <span class="hljs-built_in">deliver</span>(QueuedInputEvent q) {
            if ((q.mFlags &amp; QueuedInputEvent.FLAG_FINISHED) != <span class="hljs-number">0</span>) {
                <span class="hljs-built_in">forward</span>(q);
            } else if (shouldDropInputEvent(q)) {
                <span class="hljs-built_in">finish</span>(q, false);
            } else {
                <span class="hljs-built_in">traceEvent</span>(q, Trace.TRACE_TAG_VIEW);
                final int result;
                try {
                    <span class="hljs-comment">//å¤„ç†äº‹ä»¶</span>
                    result = <span class="hljs-built_in">onProcess</span>(q);<span class="hljs-comment">//æ³¨é‡Š58</span>
                } finally {
                    Trace<span class="hljs-selector-class">.traceEnd</span>(Trace.TRACE_TAG_VIEW);
                }
                <span class="hljs-built_in">apply</span>(q, result);
            }
        }
</code></pre>
<p>æ‹¿åˆ°äº‹ä»¶åä¹Ÿè¿˜æ˜¯è¦ç»å†å…¥åˆ—ï¼Œå‡ºåˆ—ï¼Œè¿‡æ»¤ç­‰åˆ¤æ–­ï¼Œæœ€ååˆ°<code>æ³¨é‡Š58</code></p>
<ul>
<li><strong>æ³¨é‡Š58</strong> InputState.onProcess å¤„ç†äº‹ä»¶ï¼Œç”±å­ç±»å»å®ç°ï¼Œå­ç±»å†³å®šæ˜¯ä¼ é€’äº‹ä»¶ï¼Œå¤„ç†äº‹ä»¶è¿˜æ˜¯ç»“æŸäº‹ä»¶ã€‚InputState çš„å­ç±»æœ‰å¥½å‡ ä¸ªï¼Œåˆå§‹åŒ–åœ¨setViewä¸­çš„ <code>æ³¨é‡Š37</code></li>
<li><strong>æ³¨é‡Š37</strong> setViewæ—¶åˆå§‹åŒ–äº†å¥½å¤šä¸ªäº‹ä»¶å¤„ç†å™¨InputStateç®¡çº¿ï¼Œä¸²è¡Œå¤„ç†ï¼Œä»åå¾€å‰ä¼ é€’ï¼Œè¿™é‡Œæˆ‘ä»¬åˆ†æä¸‹è§¦æ‘¸äº‹ä»¶çš„å¤„ç†å™¨  ViewPostImeInputStage,å…³é”®ä»£ç å¦‚ä¸‹ï¼š</li>
</ul>
<pre><code class="hljs language-java" lang="java">frameworks/base/core/java/android/view/ViewRootImpl.java
<span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewPostImeInputStage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">InputStage</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ViewPostImeInputStage</span><span class="hljs-params">(InputStage next)</span> {
        <span class="hljs-built_in">super</span>(next);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-type">int</span> <span class="hljs-title function_">onProcess</span><span class="hljs-params">(QueuedInputEvent q)</span> {
        <span class="hljs-keyword">if</span> (q.mEvent <span class="hljs-keyword">instanceof</span> KeyEvent) {
            <span class="hljs-keyword">return</span> processKeyEvent(q);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">source</span> <span class="hljs-operator">=</span> q.mEvent.getSource();
            <span class="hljs-keyword">if</span> ((source &amp; InputDevice.SOURCE_CLASS_POINTER) != <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">return</span> processPointerEvent(q);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((source &amp; InputDevice.SOURCE_CLASS_TRACKBALL) != <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">return</span> processTrackballEvent(q);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> processGenericMotionEvent(q);
            }
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">processPointerEvent</span><span class="hljs-params">(QueuedInputEvent q)</span> {
        <span class="hljs-keyword">final</span> <span class="hljs-type">MotionEvent</span> <span class="hljs-variable">event</span> <span class="hljs-operator">=</span> (MotionEvent)q.mEvent;
        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">action</span> <span class="hljs-operator">=</span> event.getAction();
        ...
        <span class="hljs-comment">// to the view tree.</span>
        <span class="hljs-comment">//åˆ†å‘åˆ° View æ ‘</span>
        handled = handled || mView.dispatchPointerEvent(event);<span class="hljs-comment">//æ³¨é‡Š59</span>
        ...
        <span class="hljs-keyword">return</span> handled ? FINISH_HANDLED : FORWARD;
    }
}


frameworks/base/core/java/android/view/View.java
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">dispatchPointerEvent</span><span class="hljs-params">(MotionEvent event)</span> {
    <span class="hljs-keyword">if</span> (event.isTouchEvent()) {
        <span class="hljs-keyword">return</span> dispatchTouchEvent(event);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> dispatchGenericMotionEvent(event);
    }
}

frameworks/base/core/java/com/android/internal/policy/DecorView.java
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">dispatchTouchEvent</span><span class="hljs-params">(MotionEvent ev)</span> {
    <span class="hljs-keyword">final</span> Window.<span class="hljs-type">Callback</span> <span class="hljs-variable">cb</span> <span class="hljs-operator">=</span> mWindow.getCallback();
    <span class="hljs-comment">//ä¼ é€’ç»™Activity</span>
    <span class="hljs-keyword">return</span> cb != <span class="hljs-literal">null</span> &amp;&amp; !mWindow.isDestroyed() &amp;&amp; mFeatureId &lt; <span class="hljs-number">0</span>
            ? cb.dispatchTouchEvent(ev) : <span class="hljs-built_in">super</span>.dispatchTouchEvent(ev);
}

</code></pre>
<ul>
<li><strong>æ³¨é‡Š59</strong> åˆ°è¿™é‡Œä»EventHubè¯»å–åˆ°çš„äº‹ä»¶ç»socketéä¼ é€’åˆ°æˆ‘ä»¬çš„mView(DecorView), ç„¶åå†è°ƒç”¨åˆ°<code>DecorView.dispatchTouchEvent</code> è¿™é‡Œå°±ä¼šåˆ° <code>Activity.dispatchTouchEvent</code>,åé¢å°±æ˜¯App çª—å£çš„äº‹ä»¶ä¼ é€’æµç¨‹ï¼Œè¿™ä¸€å—å¤§å®¶åº”è¯¥éƒ½å¾ˆç†Ÿæ‚‰ï¼Œå°±ä¸åœ¨è¿™é‡Œèµ˜è¿°äº†ã€‚</li>
</ul>
<p>è‡³æ­¤ï¼ŒInputDispatcher åˆ†å‘äº‹ä»¶åˆ° APPçš„ VIewRootImplæµç¨‹å·²ç»æ‰“é€šäº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9969f3d153b14d68bc730b41da6eb276~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2FycnlaaGFuZw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768134762&amp;x-signature=NjS%2B41lhovHkinq8tWi7CYv8JfA%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-4">6.äº‹ä»¶ç»“æŸæ ‡è®°å›ä¼ åŠå¤„ç†</h2>
<p>ç»è¿‡ä¸Šé¢ç« èŠ‚çš„åˆ†æï¼Œè¾“å…¥äº‹ä»¶ç”±EventReaderä»EventHubè¯»å–åä¼ é€’åˆ°InputDispatcherï¼Œå†ç”±socketåˆ†å‘åˆ°Appçš„çª—å£ï¼Œè€Œåä¼ é€’åˆ°æˆ‘ä»¬çš„Viewæ ‘ï¼Œè¿™æ ·å°±å¯ä»¥æ­£å¸¸æ¶ˆè´¹äº‹ä»¶äº†ã€‚ä½†æ˜¯äº‹ä»¶æ¶ˆè´¹å®Œä¹‹åï¼Œè¿˜éœ€è¦é€šçŸ¥InputDispatcherçš„ï¼Œè¿™é‡Œä¹Ÿæ˜¯ é€šè¿‡socketå¯¹æ¥é€šçŸ¥ï¼Œç”±clientInputChannelå†™å…¥æ•°æ®ï¼Œè€Œåå”¤é†’åˆ°InputDispatcherçš„mEpollFdçš„ç›‘å¬ï¼Œä¸‹é¢ä»å…³é”®ä»£ç ä¸Šæ‹ä¸€ä¸‹è¿™éƒ¨åˆ†æµç¨‹</p>
<h3 data-id="heading-5">6.1 äº‹ä»¶ç»“æŸæ ‡è®°å›ä¼ </h3>
<p>ç»§ç»­è·Ÿè¿› InputState.onProcess å¤„ç†æµç¨‹ï¼Œä½ ä¼šå‘ç°æ‰€æœ‰çš„äº‹ä»¶å¤„ç†å®Œäº†éƒ½ä¼šè°ƒç”¨ finishInputEvent,æ¥ä¸‹æ¥ä»è¿™ä¸ªæ–¹æ³•å¼€å§‹åˆ†æ äº‹ä»¶ç»“æŸæ ‡è®°çš„å›ä¼ ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">frameworks/base/core/java/android/view/ViewRootImpl.java
 private void finishInputEvent(QueuedInputEvent q) {
      
       if (q.mReceiver != null) {
           // äº‹ä»¶ç»“æŸæ ‡è®°å›ä¼ 
           q.mReceiver.finishInputEvent(q.mEvent, handled)<span class="hljs-comment">;</span>
       } else {
           q.mEvent.recycleIfNeededAfterDispatch()<span class="hljs-comment">;</span>
       }
       //äº‹ä»¶å¯¹è±¡å›æ”¶
       recycleQueuedInputEvent(q)<span class="hljs-comment">;</span>
   }
   
   
frameworks/base/core/java/android/view/InputEventReceiver.java
public final void finishInputEvent(InputEvent event, boolean handled) {
   
   if (<span class="hljs-attr">mReceiverPtr</span> == <span class="hljs-number">0</span>) {
       
   } else {
       int <span class="hljs-attr">index</span> = mSeqMap.indexOfKey(event.getSequenceNumber())<span class="hljs-comment">;</span>
       if (index &lt; 0) {
       } else {
           int <span class="hljs-attr">seq</span> = mSeqMap.valueAt(index)<span class="hljs-comment">;</span>
           mSeqMap.removeAt(index)<span class="hljs-comment">;</span>
           //è°ƒç”¨nativeæ–¹æ³•
           nativeFinishInputEvent(mReceiverPtr, seq, handled)<span class="hljs-comment">;</span>
       }
   }
   event.recycleIfNeededAfterDispatch()<span class="hljs-comment">;</span>
}


frameworks/base/core/jni/android_view_InputEventReceiver.cpp
static void nativeFinishInputEvent(JNIEnv* env, jclass clazz, jlong receiverPtr,
       jint seq, jboolean handled) {
   sp&lt;NativeInputEventReceiver&gt; <span class="hljs-attr">receiver</span> =
           reinterpret_cast&lt;NativeInputEventReceiver*&gt;(receiverPtr)<span class="hljs-comment">;</span>
   //è°ƒç”¨receiver çš„ finishInputEvent
   status_t <span class="hljs-attr">status</span> = receiver-&gt;finishInputEvent(seq, handled)<span class="hljs-comment">;</span>
   if (<span class="hljs-attr">status</span> == OK || status == WOULD_BLOCK) {
       return<span class="hljs-comment">; // normal operation</span>
   }
   ...
}

status_t NativeInputEventReceiver::finishInputEvent(uint32_t seq, bool handled) {

   Finish finish{
           .<span class="hljs-attr">seq</span> = seq,
           .<span class="hljs-attr">handled</span> = handled,
   }<span class="hljs-comment">;</span>
   //æ•°æ®å…¥åˆ— 
   mOutboundQueue.push_back(finish)<span class="hljs-comment">;</span>
   return processOutboundEvents()<span class="hljs-comment">;//å¤„ç†æ•°æ®</span>
}



frameworks/base/core/jni/android_view_InputEventReceiver.cpp
status_t NativeInputEventReceiver::processOutboundEvents() {
   while (!mOutboundQueue.empty()) {
       //æ•°æ®å‡ºåˆ—
       OutboundEvent&amp; <span class="hljs-attr">outbound</span> = *mOutboundQueue.begin()<span class="hljs-comment">;</span>
       status_t status<span class="hljs-comment">;</span>

       if (std::holds_alternative&lt;Finish&gt;(outbound)) {
           const Finish&amp; <span class="hljs-attr">finish</span> = std::get&lt;Finish&gt;(outbound)<span class="hljs-comment">;</span>
           //å‘é€äº‹ä»¶ç»“æŸæ ‡è®°
           <span class="hljs-attr">status</span> = mInputConsumer.sendFinishedSignal(finish.seq, finish.handled)<span class="hljs-comment">;//æ³¨é‡Š60</span>
       } else if (std::holds_alternative&lt;Timeline&gt;(outbound)) {
           const Timeline&amp; <span class="hljs-attr">timeline</span> = std::get&lt;Timeline&gt;(outbound)<span class="hljs-comment">;</span>
           <span class="hljs-attr">status</span> = mInputConsumer.sendTimeline(timeline.inputEventId, timeline.timeline)<span class="hljs-comment">;</span>
       } else {
          
       }
       ...
       return status<span class="hljs-comment">;</span>
   }
   ...
   // The queue is now empty. Tell looper there's no more output to expect.
   setFdEvents(ALOOPER_EVENT_INPUT)<span class="hljs-comment">;</span>
   return OK<span class="hljs-comment">;</span>
}



frameworks/native/libs/input/InputConsumer.cpp
status_t InputConsumer::sendFinishedSignal(uint32_t seq, bool handled) {

   // Send finished signals for the batch sequence chain first.
   size_t <span class="hljs-attr">seqChainCount</span> = mSeqChains.size()<span class="hljs-comment">;</span>
      

   // Send finished signal for the last message in the batch.
   // å‘é€ç»“æŸæ ‡è®°ï¼Œè¿™é‡Œæ˜¯æŒ‰æ‰¹å¤„ç†ï¼Œå› ä¸ºæ¥å—æ•°æ®æ—¶ä¹Ÿæ˜¯æŒ‰ æ‰¹æ¥å—çš„ï¼Œ
   return sendUnchainedFinishedSignal(seq, handled)<span class="hljs-comment">;</span>
}

status_t InputConsumer::sendUnchainedFinishedSignal(uint32_t seq, bool handled) {
   InputMessage msg<span class="hljs-comment">;</span>
   <span class="hljs-attr">msg.header.type</span> = InputMessage::Type::FINISHED<span class="hljs-comment">;</span>
   <span class="hljs-attr">msg.header.seq</span> = seq<span class="hljs-comment">;</span>
   <span class="hljs-attr">msg.body.finished.handled</span> = handled<span class="hljs-comment">;</span>
   <span class="hljs-attr">msg.body.finished.consumeTime</span> = getConsumeTime(seq)<span class="hljs-comment">;</span>
   //å‘é€æ•°æ®
   status_t <span class="hljs-attr">result</span> = mChannel-&gt;sendMessage(&amp;msg)<span class="hljs-comment">; //æ³¨é‡Š61</span>
   ....
   return result<span class="hljs-comment">;</span>
}
</code></pre>
<p>è¿™é‡Œé€»è¾‘ä¸æ˜¯å¾ˆå¤æ‚ï¼Œä¸»è¦æ˜¯å¯¹è±¡æ± çš„å›æ”¶å¤„ç†ï¼Œä¸€æ­¥æ­¥è°ƒç”¨åˆ°Nativeå±‚çš„finishInputEventï¼Œç„¶ååˆæ˜¯ æ•°æ®å…¥åˆ—ï¼Œå‡ºåˆ—ï¼Œå†å¤„ç†æ•°æ®</p>
<ul>
<li><strong>æ³¨é‡Š60</strong> è°ƒç”¨äº†ä¹‹å‰æ¥æ”¶äº‹ä»¶çš„ InputConsumerçš„sendFinishedSignalæ¥å‘é€æ•°æ®ï¼Œç”±äºä¹‹å‰æ¥æ”¶äº‹ä»¶æ˜¯ä¸€æ‰¹ä¸€æ‰¹æ¥å—çš„ï¼Œè¿™è¾¹å‘é€æ¥é¼ æ ‡ä¹Ÿåªéœ€è¦ä¸€æ‰¹å‘é€ä¸€æ¬¡å°±å¯ä»¥äº†</li>
<li><strong>æ³¨é‡Š61</strong> è°ƒç”¨äº†æ¥æ”¶æ•°æ®çš„ clientInputChannel çš„sendMessageï¼Œå³clientSocket å†™å…¥äº†æ•°æ®</li>
</ul>
<p>æ­¤æ—¶clientç«¯çš„æ•°æ®ç»“æŸæ ‡è®°å·²ç»é€šè¿‡clientSocketå‘é€å‡ºå»äº†ï¼Œæ¥ä¸‹æ¥çœ‹ä¸‹serverç«¯(inpuDispatcher)çš„æ¥æ”¶æ•°æ®å’Œå¤„ç†æµç¨‹ã€‚</p>
<h3 data-id="heading-6">6.2 InputDispatcheræ¥æ”¶åˆ°äº‹ä»¶ç»“æŸæ ‡è®°åå¤„ç†</h3>
<p>æˆ‘ä»¬å›åˆ°<code>æ³¨é‡Š47</code>ï¼Œåœ¨InputChannelåˆå§‹åŒ–æ—¶ï¼ŒInputDispatcher å°±æ·»åŠ äº†å¯¹ serverSocketçš„fdçš„ç›‘å¬ï¼Œå½“ clientServerç«¯æœ‰æ•°æ®å†™å…¥æ—¶ï¼Œå°±ä¼šè§¦å‘è¿™é‡Œçš„å›è°ƒå‡½æ•° handleReceiveCallbackï¼ŒInputDispatcherå°±ä»è¿™é‡Œå¼€å§‹å¤„ç†äº‹ä»¶ç»“æŸæ ‡è®°ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä»å…³é”®ä»£ç å…¥æ‰‹åˆ†æï¼š</p>
<pre><code class="hljs language-c" lang="c">frameworks/native/services/inputflinger/dispatcher/InputDispatcher.cpp
<span class="hljs-type">int</span> <span class="hljs-title function_">InputDispatcher::handleReceiveCallback</span><span class="hljs-params">(<span class="hljs-type">int</span> events, sp&lt;IBinder&gt; connectionToken)</span> {
      ...
    <span class="hljs-keyword">if</span> (!(events &amp; (ALOOPER_EVENT_ERROR | ALOOPER_EVENT_HANGUP))) {
        <span class="hljs-type">nsecs_t</span> currentTime = now();
        <span class="hljs-type">bool</span> gotOne = <span class="hljs-literal">false</span>;
        <span class="hljs-type">status_t</span> status = OK;
        ...
        <span class="hljs-keyword">for</span> (;;) {
            <span class="hljs-comment">//ä»serverSocketä¸­æ¥æ”¶æ•°æ®</span>
            Result&lt;InputPublisher::ConsumerResponse&gt; result =
                    connection-&gt;inputPublisher.receiveConsumerResponse();<span class="hljs-comment">//æ³¨é‡Š62</span>
            <span class="hljs-keyword">if</span> (!result.ok()) {
                status = result.error().code();
                <span class="hljs-keyword">break</span>;
            }

            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">std</span>::holds_alternative&lt;InputPublisher::Finished&gt;(*result)) {
                <span class="hljs-comment">//äº‹ä»¶ç»“æŸ</span>
                <span class="hljs-type">const</span> InputPublisher::Finished&amp; finish =
                        <span class="hljs-built_in">std</span>::get&lt;InputPublisher::Finished&gt;(*result);
                <span class="hljs-comment">//æ·»åŠ äº‹ä»¶ç»“æŸå¤„ç†çš„æŒ‡ä»¤åˆ°é˜Ÿåˆ—ä¸­</span>
                finishDispatchCycleLocked(currentTime, connection, finish.seq, finish.handled,
                                          finish.consumeTime);<span class="hljs-comment">//63</span>
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">std</span>::holds_alternative&lt;InputPublisher::Timeline&gt;(*result)) {
                ...
            }
            gotOne = <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">if</span> (gotOne) {
            <span class="hljs-comment">//ä»é˜Ÿåˆ—ä¸­æ‹¿å‡ºæŒ‡ä»¤å¤„ç†</span>
            runCommandsLockedInterruptable();
            <span class="hljs-keyword">if</span> (status == WOULD_BLOCK) {
                <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
            }
        }

        notify = status != DEAD_OBJECT || !connection-&gt;monitor;
        
    } <span class="hljs-keyword">else</span> {
        ...
    }
    ...
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; <span class="hljs-comment">// remove the callback</span>
}

<span class="hljs-type">void</span> <span class="hljs-title function_">InputDispatcher::finishDispatchCycleLocked</span><span class="hljs-params">(<span class="hljs-type">nsecs_t</span> currentTime,
                                                <span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Connection&gt;&amp; connection,
                                                <span class="hljs-type">uint32_t</span> seq, <span class="hljs-type">bool</span> handled, <span class="hljs-type">nsecs_t</span> consumeTime)</span> {
    ...
    <span class="hljs-comment">// Notify other system components and prepare to start the next dispatch cycle.</span>
    <span class="hljs-keyword">auto</span> command = [this, currentTime, connection, seq, handled, consumeTime]() REQUIRES(mLock) {
        doDispatchCycleFinishedCommand(currentTime, connection, seq, handled, consumeTime);
    };
    <span class="hljs-comment">//æŒ‡ä»¤å…¥åˆ—</span>
    postCommandLocked(<span class="hljs-built_in">std</span>::move(command));
}


<span class="hljs-type">void</span> <span class="hljs-title function_">InputDispatcher::doDispatchCycleFinishedCommand</span><span class="hljs-params">(<span class="hljs-type">nsecs_t</span> finishTime,
                                                     <span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;Connection&gt;&amp; connection,
                                                     <span class="hljs-type">uint32_t</span> seq, <span class="hljs-type">bool</span> handled,
                                                     <span class="hljs-type">nsecs_t</span> consumeTime)</span> {
   ...
    <span class="hljs-comment">// Dequeue the event and start the next cycle.</span>
    <span class="hljs-comment">// Because the lock might have been released, it is possible that the</span>
    <span class="hljs-comment">// contents of the wait queue to have been drained, so we need to double-check</span>
    <span class="hljs-comment">// a few things.</span>
   
    <span class="hljs-keyword">auto</span> entryIt = <span class="hljs-built_in">std</span>::find_if(connection-&gt;waitQueue.begin(), connection-&gt;waitQueue.end(),
                                [seq](<span class="hljs-keyword">auto</span>&amp; e) { <span class="hljs-keyword">return</span> e-&gt;seq == seq; });
     <span class="hljs-comment">//éå† connection-&gt;waitQueue æ‰€æœ‰çš„åˆ†å‘äº‹ä»¶</span>
    <span class="hljs-keyword">if</span> (entryIt != connection-&gt;waitQueue.end()) {<span class="hljs-comment">//æ³¨é‡Š64</span>
        <span class="hljs-built_in">std</span>::<span class="hljs-built_in">unique_ptr</span>&lt;DispatchEntry&gt; dispatchEntry = <span class="hljs-built_in">std</span>::move(*entryIt);
        <span class="hljs-comment">//ä»waitQueueä¸­ç§»é™¤æ¶ˆæ¯</span>
        connection-&gt;waitQueue.erase(entryIt);<span class="hljs-comment">//æ³¨é‡Š65</span>

        <span class="hljs-type">const</span> sp&lt;IBinder&gt;&amp; connectionToken = connection-&gt;getToken();
        <span class="hljs-comment">//ç§»é™¤è®°å½•anr çš„æ—¶é—´</span>
        mAnrTracker.erase(dispatchEntry-&gt;timeoutTime, connectionToken);<span class="hljs-comment">//æ³¨é‡Š66</span>
        ...
    }

    <span class="hljs-comment">// Start the next dispatch cycle for this connection.</span>
    <span class="hljs-comment">// å¼€å§‹ä¸‹ä¸€ä¸ªå¾ªç¯(è‹¥outboundQueueä¸­è¿˜æœ‰å…ƒç´ )</span>
    startDispatchCycleLocked(now(), connection);<span class="hljs-comment">//æ³¨é‡Š67</span>
}
</code></pre>
<ul>
<li><strong>æ³¨é‡Š62</strong> é€šè¿‡inputPublisher ä»serverSocket ä¸­è¯»å– clientServerå‘é€è¿‡æ¥çš„æ•°æ®</li>
<li><strong>æ³¨é‡Š63</strong> åˆ¤æ–­æ¥æ”¶çš„æ•°æ®æ˜¯å¦æ˜¯äº‹ä»¶ç»“æŸçš„æ ‡è®°ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œå¡å…¥åˆ°å¾…å¤„ç†çš„ æŒ‡ä»¤é›†åˆ mCommandQueue ä¸­ï¼Œç´§æ¥ç€ä»é›†åˆä¸­è·å–æŒ‡ä»¤å¹¶æ‰§è¡Œ</li>
<li><strong>æ³¨é‡Š64</strong> éå†connect-&gt;waitQueueä¸­æ‰€æœ‰å·²åˆ†å‘äº‹ä»¶ï¼Œè¿™ä¸ªé›†åˆä¸­çš„äº‹ä»¶æ˜¯åœ¨InputDispatcherä¸­åˆ†å‘äº‹ä»¶çš„æ–¹æ³•startDispatchCycleLockedå†…æ·»åŠ çš„ï¼Œå‚è€ƒ<code>æ³¨é‡Š32</code></li>
<li><strong>æ³¨é‡Š65</strong> ä»connect-&gt;waitQueue ç§»é™¤äº‹ä»¶ï¼Œæ­¤æ—¶æ‰è¯´æ˜è¿™ä¸ªäº‹ä»¶æ˜¯å¤„ç†å®Œäº†çš„,è¿™ä¸ªé›†åˆæ˜¯å¦ä¸ºç©º ä¹Ÿæ˜¯åç»­åˆ¤æ–­æ˜¯å¦æœ‰ANRçš„ä¾æ®ä¹‹ä¸€</li>
<li><strong>æ³¨é‡Š66</strong> æ“¦é™¤mAnrTrackerä¸­çš„ANRè¶…æ—¶æ—¶é—´ï¼Œè¿™ä¸ªä¹Ÿæ˜¯åœ¨InputDispatcherä¸­åˆ†å‘äº‹ä»¶çš„æ–¹æ³•:startDispatchCycleLockedå†…æ·»åŠ ï¼Œå‚è€ƒ<code>æ³¨é‡Š32</code></li>
<li><strong>æ³¨é‡Š67</strong> éå†å®Œæ‰€æœ‰å·²åˆ†å‘çš„äº‹ä»¶åï¼Œå°±å¼€å§‹ä¸‹ä¸€ä¸ªå¾ªç¯(å¦‚æœconnection--&gt;outboundQueueä¸­è¿˜æœ‰å¾…åˆ†å‘äº‹ä»¶),æ­¤æ—¶å°±åˆå¼€å§‹äº†äº‹ä»¶çš„åˆ†å‘ï¼Œæµç¨‹å°±åˆå›åˆ°äº† <code>4.2 InputDispatcher äº‹ä»¶å‡ºåˆ—åˆ†å‘</code></li>
</ul>
<p>åˆ°è¿™é‡Œï¼Œä»InputState.finishInputEvent ä¸€æ­¥æ­¥è°ƒç”¨åˆ°Nativeå±‚ç”±clientSocketå‘é€åˆ°InputDispatcherä¸­çš„äº‹ä»¶ç»“æŸæ ‡è®°çš„æ¥æ”¶å’Œå¤„ç†æµç¨‹åŸºæœ¬ç»“æŸäº†ï¼Œåç»­å°±ä¼šè¿›å…¥åˆ°ä¸‹ä¸€æ‰¹æ¬¡æ˜¯äº‹ä»¶åˆ†å‘ã€‚</p>
<p>InputDispatcher å’Œ Appçª—å£ä¹‹é—´çš„äº¤äº’è¿‡ç¨‹å¦‚ä¸‹
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ba0f8757995b4d7586bbdd70696b28e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2FycnlaaGFuZw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768134762&amp;x-signature=wKZ%2Bc9NlKvJk70EsPdMnYPX6X0Q%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-7">7.ANRæµç¨‹</h2>
<p>ä¸ºäº†è§„é¿ANRï¼Œå¤§å®¶éƒ½çŸ¥é“Viewæ ‘é‡Œæ¥æ”¶äº‹ä»¶å¤„ç†é€»è¾‘æ—¶æ—¶ä¸åšè€—æ—¶æ“ä½œã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±ä»æºç çš„è§’åº¦åˆ†æä¸€ä¸‹è¿™ç§ANRæ˜¯å¦‚ä½•äº§ç”Ÿå’Œå¤„ç†çš„ã€‚</p>
<h3 data-id="heading-8">7.1 äº‹ä»¶åˆ†å‘ANRçš„äº§ç”Ÿ</h3>
<p>æ•´ä¸ªInputDispatcherçš„äº‹ä»¶åˆ†å‘æ˜¯ä» dispatchOnce å¼€å§‹çš„ï¼Œä¸Šé¢çš„ç« èŠ‚åˆ†æäº†<code>æ³¨é‡Š20</code>å‡ºçš„äº‹ä»¶åˆ†å‘ã€Appçª—å£äº‹ä»¶æ¥æ”¶ä»¥åŠç»“æŸæ ‡è®°å›ä¼ ã€‚ä½†æ˜¯ dispatchOnce ä¸‹é¢è¿˜æœ‰å…³äºANRåˆ¤æ–­çš„å…³é”®è°ƒç”¨é€»è¾‘<code>æ³¨é‡Š21</code></p>
<ul>
<li><strong>æ³¨é‡Š21</strong> åˆ†å‘å®Œä¸€æ‰¹äº‹ä»¶å åˆ¤æ–­æ˜¯å¦æœ‰ANRäº§ç”Ÿï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š</li>
</ul>

<pre><code class="hljs language-scss" lang="scss">frameworks/native/services/inputflinger/dispatcher/InputDispatcher<span class="hljs-selector-class">.cpp</span>
nsecs_t InputDispatcher::<span class="hljs-built_in">processAnrsLocked</span>() {
    const nsecs_t currentTime = <span class="hljs-built_in">now</span>();
    nsecs_t nextAnrCheck = LLONG_MAX;
    <span class="hljs-comment">// Check if we are waiting for a focused window to appear. Raise ANR if waited too long</span>
    <span class="hljs-comment">//æ— ç„¦ç‚¹çª—å£çš„ANR</span>
    if (mNoFocusedWindowTimeoutTime.has_value() &amp;&amp; mAwaitedFocusedApplication != nullptr) {
        if (currentTime &gt;= *mNoFocusedWindowTimeoutTime) {<span class="hljs-comment">//æ³¨é‡Š68</span>
            <span class="hljs-comment">//ANRäº‹ä»¶å¤„ç†</span>
            <span class="hljs-built_in">processNoFocusedWindowAnrLocked</span>();<span class="hljs-comment">//æ³¨é‡Š69</span>
            mAwaitedFocusedApplication<span class="hljs-selector-class">.reset</span>();
            mNoFocusedWindowTimeoutTime = std::nullopt;
            return LLONG_MIN;
        } else {
            <span class="hljs-comment">// Keep waiting. We will drop the event when mNoFocusedWindowTimeoutTime comes.</span>
            nextAnrCheck = *mNoFocusedWindowTimeoutTime;
        }
    }

    <span class="hljs-comment">// Check if any connection ANRs are due</span>
    nextAnrCheck = std::<span class="hljs-built_in">min</span>(nextAnrCheck, mAnrTracker.<span class="hljs-built_in">firstTimeout</span>());
    <span class="hljs-comment">// äº‹ä»¶åˆ†å‘æ—¶çš„ANR</span>
    if (currentTime &lt; nextAnrCheck) { <span class="hljs-comment">// æ³¨é‡Š70</span>
        return nextAnrCheck;          <span class="hljs-comment">// everything is normal. Let's check again at nextAnrCheck</span>
    }

    <span class="hljs-comment">// If we reached here, we have an unresponsive connection.</span>
    std::shared_ptr&lt;Connection&gt; connection = <span class="hljs-built_in">getConnectionLocked</span>(mAnrTracker.<span class="hljs-built_in">firstToken</span>());
    if (connection == nullptr) {
        <span class="hljs-built_in">ALOGE</span>("Could not find connection for entry %" PRId64, mAnrTracker.firstTimeout());
        return nextAnrCheck;
    }
    connection-&gt;responsive = false;
    <span class="hljs-comment">// Stop waking up for this unresponsive connection</span>
    mAnrTracker<span class="hljs-selector-class">.eraseToken</span>(connection-&gt;getToken());
    <span class="hljs-built_in">onAnrLocked</span>(connection);<span class="hljs-comment">//æ³¨é‡Š71</span>
    return LLONG_MIN;
}

void InputDispatcher::<span class="hljs-built_in">processNoFocusedWindowAnrLocked</span>() {
     ...
    <span class="hljs-built_in">onAnrLocked</span>(mAwaitedFocusedApplication);<span class="hljs-comment">//æ³¨é‡Š72</span>
}
</code></pre>
<ul>
<li><strong>æ³¨é‡Š68</strong> åˆ¤æ–­å½“å‰çš„æ—¶å€™æ˜¯å¦å¤§äºæ— ç„¦ç‚¹çª—å£ANRè¶…æ—¶æ—¶é—´ï¼Œå¦‚æœå¤§äºï¼Œå°±æ˜¯æ— ç„¦ç‚¹ANRï¼Œ</li>
<li><strong>æ³¨é‡Š69</strong> æ— ç„¦ç‚¹ANRçš„å¤„ç†æµç¨‹,è¿™é‡Œä¼šå†æ¬¡æ ¡éªŒæ˜¯å¦è¿˜æ˜¯è·å–ä¸åˆ°ç„¦ç‚¹çª—å£ï¼Œè‹¥è¿˜æ˜¯æ²¡æœ‰ï¼Œåˆ™ä¼šè¿›å…¥çœŸæ­£çš„ANRå¤„ç†æµç¨‹</li>
<li><strong>æ³¨é‡Š70</strong> è·å–mAnrTrackerä¸­æœ€å‰é¢çš„äº‹ä»¶åˆ†å‘(æœ‰ç„¦ç‚¹çª—å£)çš„ANRè¶…æ—¶æ—¶é—´ï¼Œæ—¶åˆ¤æ–­å½“å‰æ—¶é—´æ˜¯å¦å°äºANRè¶…æ—¶æ—¶é—´ï¼Œå¦‚æœå°äºå°±æ˜¯æ­£å¸¸æµç¨‹ï¼Œå¤§äºå°±æ˜¯äº‹ä»¶åˆ†å‘ANR</li>
<li><strong>æ³¨é‡Š71ã€æ³¨é‡Š72</strong> ANRçš„å¤„ç†æµç¨‹</li>
</ul>
<p>çœ‹åˆ°è¿™é‡Œå¤§å®¶å‘ç°æ²¡æœ‰äº‹ä»¶åˆ†å‘ANRå¹¶ä¸æ˜¯ä¸¥æ ¼éµå®ˆè¶…æ—¶é€»è¾‘çš„ï¼Œå‡è®¾äº‹ä»¶åˆ†å‘ANRè¶…æ—¶æ—¶é—´æ˜¯5ç§’ï¼Œä½†æ˜¯è¶…æ—¶åˆ¤æ–­æ˜¯è¦åˆ†å‘å®Œä¸€æ‰¹äº‹ä»¶åæ‰ä¼šåˆ¤æ–­æ²¡æœ‰æ”¶åˆ°ç»“æŸäº‹ä»¶æ ‡è®°çš„äº‹ä»¶é˜Ÿåˆ—ä¸­æœ€å‰é¢é‚£ä¸ªäº‹ä»¶çš„è¶…æ—¶é€»è¾‘ï¼Œå¦‚æœè¶…æ—¶äº†ï¼Œå°±ä¼šäº§ç”ŸANRï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªç‚¹å‡»äº‹ä»¶ï¼Œæˆ‘ä»¬åœ¨é‡Œé¢ç›´æ¥å»¶æ—¶10ç§’ï¼Œç‚¹å‡»å®Œ10ç§’å†…ä¸åšä»»ä½•æ“ä½œï¼Œä¸è¦å†è¾“å…¥å’Œåˆ†å‘å…¶ä»–äº‹ä»¶ï¼Œæ­¤æ—¶å¹¶ä¸ä¼šäº§ç”ŸANRçš„ã€‚ä½†æ˜¯å¦‚æœåœ¨10ç§’å†…å†æ¬¡è§¦æ‘¸/ç‚¹å‡»å°±ä¼šäº§ç”ŸANRå¹¶å¼¹çª—å‘ŠçŸ¥Appã€‚</p>
<h3 data-id="heading-9">7.2 ANRæ¶ˆæ¯ä¼ é€’åˆ°AppåŠå¼¹çª—</h3>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­åˆ†æè¿™ä¸ªANRäº‹ä»¶æ˜¯å¦‚ä½•ä¼ é€’åˆ°åº”ç”¨å¹¶å¼¹çª—å¤„ç†çš„ã€‚æ¥ç€ä¸Šé¢çš„ä»£ç ç»§ç»­åˆ†æ</p>
<pre><code class="hljs language-scss" lang="scss">frameworks/native/services/inputflinger/dispatcher/InputDispatcher<span class="hljs-selector-class">.cpp</span>
<span class="hljs-comment">//æœ‰ç„¦ç‚¹çª—å£æ— å“åº”ANRå¤„ç†æµç¨‹</span>
void InputDispatcher::<span class="hljs-built_in">onAnrLocked</span>(const std::shared_ptr&lt;Connection&gt;&amp; connection) {
   
    <span class="hljs-comment">// Since we are allowing the policy to extend the timeout, maybe the waitQueue</span>
    <span class="hljs-comment">// is already healthy again. Don't raise ANR in this situation</span>
    <span class="hljs-comment">// ä¼šå†æ¬¡æ ¡éªŒ connection-&gt;waitQueueï¼Œ</span>
    if (connection-&gt;waitQueue.empty()) {<span class="hljs-comment">//æ³¨é‡Š73</span>
        <span class="hljs-built_in">ALOGI</span>("Not raising ANR because the connection %s has recovered",
              connection-&gt;getInputChannelName()<span class="hljs-selector-class">.c_str</span>());
        return;
    }
    ...
    <span class="hljs-built_in">processConnectionUnresponsiveLocked</span>(*connection, std::move(reason));
    ...
}

void InputDispatcher::<span class="hljs-built_in">processConnectionUnresponsiveLocked</span>(const Connection&amp; connection,
                                                          std::string reason) {
    const sp&lt;IBinder&gt;&amp; connectionToken = connection<span class="hljs-selector-class">.getToken</span>();
    std::optional&lt;gui::Pid&gt; pid;
    ...
    <span class="hljs-built_in">sendWindowUnresponsiveCommandLocked</span>(connectionToken, pid, std::move(reason));
}

void InputDispatcher::<span class="hljs-built_in">sendWindowUnresponsiveCommandLocked</span>(const sp&lt;IBinder&gt;&amp; token,
                                                          std::optional&lt;gui::Pid&gt; pid,
                                                          std::string reason) {
    auto command = <span class="hljs-selector-attr">[this, token, pid, r = std::move(reason)]</span>() <span class="hljs-built_in">REQUIRES</span>(mLock) {
        scoped_unlock <span class="hljs-built_in">unlock</span>(mLock);
        mPolicy<span class="hljs-selector-class">.notifyWindowUnresponsive</span>(token, pid, r);<span class="hljs-comment">//æ³¨é‡Š74</span>
    };
    <span class="hljs-built_in">postCommandLocked</span>(std::move(command));
}

<span class="hljs-comment">//æ— ç„¦ç‚¹çª—å£ANRå¤„ç†æµç¨‹</span>
void InputDispatcher::<span class="hljs-built_in">onAnrLocked</span>(std::shared_ptr&lt;InputApplicationHandle&gt; application) {
    std::string reason =
            <span class="hljs-built_in">StringPrintf</span>(<span class="hljs-string">"%s does not have a focused window"</span>, application-&gt;<span class="hljs-built_in">getName</span>().<span class="hljs-built_in">c_str</span>());
    <span class="hljs-built_in">updateLastAnrStateLocked</span>(*application, reason);

    auto command = <span class="hljs-selector-attr">[this, app = std::move(application)]</span>() <span class="hljs-built_in">REQUIRES</span>(mLock) {
        scoped_unlock <span class="hljs-built_in">unlock</span>(mLock);
        mPolicy<span class="hljs-selector-class">.notifyNoFocusedWindowAnr</span>(app);<span class="hljs-comment">//æ³¨é‡Š75</span>
    };
    <span class="hljs-built_in">postCommandLocked</span>(std::move(command));
}
</code></pre>
<ul>
<li><strong>æ³¨é‡Š73</strong> è¿™é‡Œè¿˜ä¼šå†æ¬¡æ ¡éªŒ connection-&gt;waitQueue æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™ä¸è®¤ä¸ºæ˜¯ANRï¼Œå’Œ äº‹ä»¶ç»“æŸæ ‡è®°å¤„ç†ä¸­çš„ <code>æ³¨é‡Š65</code> å…³è”ã€‚</li>
<li><strong>æ³¨é‡Š74</strong> æœ‰ç„¦ç‚¹çª—å£æ— å“åº”ANRå¤„ç†æµç¨‹</li>
<li><strong>æ³¨é‡Š75</strong> æ— ç„¦ç‚¹çª—å£ANRå¤„ç†æµç¨‹</li>
</ul>
<p>è¿™é‡Œçš„ANRåˆ†ä¸ºæ— ç„¦ç‚¹çª—å£ANRå’Œæœ‰ç„¦ç‚¹æ— å“åº”ANRï¼Œä¸¤ä¸ªæµç¨‹éƒ½å·®ä¸å¤šï¼Œæˆ‘ä»¬ä»¥å¸¸è§çš„æœ‰ç„¦ç‚¹æ— å“åº”ANRä¸ºä¾‹è¿›è¡Œåˆ†æ,æœ€ç»ˆè°ƒç”¨åˆ° <code>mPolicy.notifyWindowUnresponsive</code>ã€‚mPolicy æ˜¯åœ¨ IMS åˆå§‹åŒ–æ—¶ä¼ å…¥çš„NativeInputManager å¯¹è±¡</p>
<pre><code class="hljs language-scss" lang="scss">frameworks/base/services/core/jni/com_android_server_input_InputManagerService<span class="hljs-selector-class">.cpp</span>
void NativeInputManager::<span class="hljs-built_in">notifyWindowUnresponsive</span>(const sp&lt;IBinder&gt;&amp; token,
                                                  std::optional&lt;gui::Pid&gt; pid,
                                                  const std::string&amp; reason) {
<span class="hljs-selector-id">#if</span> DEBUG_INPUT_DISPATCHER_POLICY
    <span class="hljs-built_in">ALOGD</span>("notifyWindowUnresponsive");
<span class="hljs-selector-id">#endif</span>
    <span class="hljs-built_in">ATRACE_CALL</span>();

    JNIEnv* env = <span class="hljs-built_in">jniEnv</span>();
    ScopedLocalFrame <span class="hljs-built_in">localFrame</span>(env);

    jobject tokenObj = <span class="hljs-built_in">javaObjectForIBinder</span>(env, token);
    ScopedLocalRef&lt;jstring&gt; <span class="hljs-built_in">reasonObj</span>(env, env-&gt;NewStringUTF(reason.c_str()));

    env-&gt;<span class="hljs-built_in">CallVoidMethod</span>(mServiceObj, gServiceClassInfo.notifyWindowUnresponsive, tokenObj,
                        pid.value_or(gui::Pid{<span class="hljs-number">0</span>})<span class="hljs-selector-class">.val</span>(), pid<span class="hljs-selector-class">.has_value</span>(), reasonObj<span class="hljs-selector-class">.get</span>());<span class="hljs-comment">//æ³¨é‡Š76</span>
    <span class="hljs-built_in">checkAndClearExceptionFromCallback</span>(env, "notifyWindowUnresponsive");
}

</code></pre>
<ul>
<li><strong>æ³¨é‡Š76</strong> è¿™é‡Œè°ƒå›äº†Javaç«¯çš„InputManagerService.otifyWindowUnresponsive,æ­¤æ—¶äº‹ä»¶å·²ç»ä¼ é€’åˆ°Javaç«¯çš„IMSäº†ï¼Œç»§ç»­å¾€ä¸‹è·Ÿè¿›ï¼Œæ‘˜å–äº†ANRäº‹ä»¶æµè½¬ç›¸å…³çš„ä»£ç å¦‚ä¸‹ï¼š</li>
</ul>

<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">frameworks</span>/<span class="hljs-selector-tag">base</span>/<span class="hljs-selector-tag">services</span>/<span class="hljs-selector-tag">core</span>/<span class="hljs-selector-tag">java</span>/<span class="hljs-selector-tag">com</span>/<span class="hljs-selector-tag">android</span>/<span class="hljs-selector-tag">server</span>/<span class="hljs-selector-tag">input</span>/<span class="hljs-selector-tag">InputManagerService</span><span class="hljs-selector-class">.java</span>
    <span class="hljs-comment">// Native callback</span>
    @<span class="hljs-selector-tag">SuppressWarnings</span>(<span class="hljs-string">"unused"</span>)
    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">notifyWindowUnresponsive</span>(IBinder token, int pid, boolean isPidValid,
            String reason) {
        <span class="hljs-comment">//IMSä¸­è½¬ANR</span>
        <span class="hljs-selector-tag">mWindowManagerCallbacks</span><span class="hljs-selector-class">.notifyWindowUnresponsive</span>(token,
                isPidValid ? OptionalInt.<span class="hljs-built_in">of</span>(pid) : OptionalInt.<span class="hljs-built_in">empty</span>(), reason);
    }
    
<span class="hljs-selector-tag">frameworks</span>/<span class="hljs-selector-tag">base</span>/<span class="hljs-selector-tag">services</span>/<span class="hljs-selector-tag">core</span>/<span class="hljs-selector-tag">java</span>/<span class="hljs-selector-tag">com</span>/<span class="hljs-selector-tag">android</span>/<span class="hljs-selector-tag">server</span>/<span class="hljs-selector-tag">wm</span>/<span class="hljs-selector-tag">InputManagerCallback</span><span class="hljs-selector-class">.java</span>
@<span class="hljs-selector-tag">Override</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">notifyWindowUnresponsive</span>(<span class="hljs-variable">@NonNull</span> IBinder token, <span class="hljs-variable">@NonNull</span> OptionalInt pid,
        String reason) {
    <span class="hljs-selector-tag">TimeoutRecord</span> <span class="hljs-selector-tag">timeoutRecord</span> = <span class="hljs-selector-tag">TimeoutRecord</span><span class="hljs-selector-class">.forInputDispatchWindowUnresponsive</span>(
            <span class="hljs-built_in">timeoutMessage</span>(pid, reason));
    <span class="hljs-comment">//ANRäº‹ä»¶ä¸­è½¬åˆ°AnrController</span>
    <span class="hljs-selector-tag">mService</span><span class="hljs-selector-class">.mAnrController</span><span class="hljs-selector-class">.notifyWindowUnresponsive</span>(token, pid, timeoutRecord);
}

<span class="hljs-selector-tag">frameworks</span>/<span class="hljs-selector-tag">base</span>/<span class="hljs-selector-tag">services</span>/<span class="hljs-selector-tag">core</span>/<span class="hljs-selector-tag">java</span>/<span class="hljs-selector-tag">com</span>/<span class="hljs-selector-tag">android</span>/<span class="hljs-selector-tag">server</span>/<span class="hljs-selector-tag">wm</span>/<span class="hljs-selector-tag">AnrController</span><span class="hljs-selector-class">.java</span>
<span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">notifyWindowUnresponsive</span>(<span class="hljs-variable">@NonNull</span> IBinder token, <span class="hljs-variable">@NonNull</span> OptionalInt pid,
        <span class="hljs-variable">@NonNull</span> TimeoutRecord timeoutRecord) {
    <span class="hljs-selector-tag">try</span> {
        <span class="hljs-selector-tag">timeoutRecord</span><span class="hljs-selector-class">.mLatencyTracker</span><span class="hljs-selector-class">.notifyWindowUnresponsiveStarted</span>();
        <span class="hljs-selector-tag">if</span> (<span class="hljs-built_in">notifyWindowUnresponsive</span>(token, timeoutRecord)) {
            <span class="hljs-selector-tag">return</span>;
        }
        ...
    } <span class="hljs-selector-tag">finally</span> {
        <span class="hljs-selector-tag">timeoutRecord</span><span class="hljs-selector-class">.mLatencyTracker</span><span class="hljs-selector-class">.notifyWindowUnresponsiveEnded</span>();
    }
}

 <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">boolean</span> <span class="hljs-selector-tag">notifyWindowUnresponsive</span>(<span class="hljs-variable">@NonNull</span> IBinder inputToken,
            TimeoutRecord timeoutRecord) {
        ...
        <span class="hljs-selector-tag">if</span> (activity != null) {
            <span class="hljs-comment">//è¿™é‡Œæœ€ç»ˆä¹Ÿæ˜¯è°ƒç”¨ mService.mAmInternal.inputDispatchingTimedOut</span>
            <span class="hljs-selector-tag">activity</span><span class="hljs-selector-class">.inputDispatchingTimedOut</span>(timeoutRecord, pid);
        } <span class="hljs-selector-tag">else</span> {
            <span class="hljs-comment">//ANRäº‹ä»¶ä¸­è½¬åˆ°AMS</span>
            <span class="hljs-selector-tag">mService</span><span class="hljs-selector-class">.mAmInternal</span><span class="hljs-selector-class">.inputDispatchingTimedOut</span>(pid, aboveSystem, timeoutRecord);
        }
        <span class="hljs-selector-tag">dumpAnrStateAsync</span>(activity, windowState, timeoutRecord.mReason);
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">true</span>;
    }

<span class="hljs-selector-tag">frameworks</span>/<span class="hljs-selector-tag">base</span>/<span class="hljs-selector-tag">services</span>/<span class="hljs-selector-tag">core</span>/<span class="hljs-selector-tag">java</span>/<span class="hljs-selector-tag">com</span>/<span class="hljs-selector-tag">android</span>/<span class="hljs-selector-tag">server</span>/<span class="hljs-selector-tag">am</span>/<span class="hljs-selector-tag">ActivityManagerService</span><span class="hljs-selector-class">.java</span>
@<span class="hljs-selector-tag">Override</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">long</span> <span class="hljs-selector-tag">inputDispatchingTimedOut</span>(int pid, boolean aboveSystem,
        TimeoutRecord timeoutRecord) {
    <span class="hljs-comment">//ANRäº‹ä»¶æ¥åˆ° AMS</span>
    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ActivityManagerService</span><span class="hljs-selector-class">.this</span><span class="hljs-selector-class">.inputDispatchingTimedOut</span>(pid, aboveSystem,
            timeoutRecord);
}

@<span class="hljs-selector-tag">Override</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">boolean</span> <span class="hljs-selector-tag">inputDispatchingTimedOut</span>(Object proc, String activityShortComponentName,
        ApplicationInfo aInfo, String parentShortComponentName, Object parentProc,
        boolean aboveSystem, TimeoutRecord timeoutRecord) {
    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ActivityManagerService</span><span class="hljs-selector-class">.this</span><span class="hljs-selector-class">.inputDispatchingTimedOut</span>((ProcessRecord) proc,
            activityShortComponentName, aInfo, parentShortComponentName,
            (WindowProcessController) parentProc, aboveSystem, timeoutRecord);
}

 <span class="hljs-selector-tag">boolean</span> <span class="hljs-selector-tag">inputDispatchingTimedOut</span>(ProcessRecord proc, String activityShortComponentName,
            ApplicationInfo aInfo, String parentShortComponentName,
            WindowProcessController parentProcess, boolean aboveSystem,
            TimeoutRecord timeoutRecord) {
        <span class="hljs-selector-tag">try</span> {
            ...
            <span class="hljs-selector-tag">if</span> (proc != null) {
                ...
                <span class="hljs-selector-tag">timeoutRecord</span><span class="hljs-selector-class">.mLatencyTracker</span><span class="hljs-selector-class">.waitingOnAMSLockStarted</span>();
                 <span class="hljs-comment">//ANRäº‹ä»¶ä¸­è½¬ AnrHelper</span>
                <span class="hljs-selector-tag">mAnrHelper</span><span class="hljs-selector-class">.appNotResponding</span>(proc, activityShortComponentName, aInfo,
                        parentShortComponentName, parentProcess, aboveSystem, timeoutRecord,
                        <span class="hljs-comment">/*isContinuousAnr*/</span> true); <span class="hljs-comment">//æ³¨é‡Š77</span>
            }
            <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">true</span>;
        } <span class="hljs-selector-tag">finally</span> {
            <span class="hljs-selector-tag">Trace</span><span class="hljs-selector-class">.traceEnd</span>(Trace.TRACE_TAG_ACTIVITY_MANAGER);
        }
    }
</code></pre>
<p>å‡ ç»å‘¨è½¬ANRäº‹ä»¶æ¥åˆ°äº†AMS</p>
<ul>
<li><strong>æ³¨é‡Š77</strong> è°ƒç”¨ AnrHelper.appNotRespondingæ¥ç»Ÿä¸€å¤„ç†ANR</li>
</ul>
<pre><code class="hljs language-java" lang="java">frameworks/base/services/core/java/com/android/server/am/AnrHelper.java
<span class="hljs-keyword">void</span> <span class="hljs-title function_">appNotResponding</span><span class="hljs-params">(ProcessRecord anrProcess, String activityShortComponentName,
            ApplicationInfo aInfo, String parentShortComponentName,
            WindowProcessController parentProcess, <span class="hljs-type">boolean</span> aboveSystem,
            TimeoutRecord timeoutRecord, <span class="hljs-type">boolean</span> isContinuousAnr)</span> {
    <span class="hljs-keyword">try</span> {
        timeoutRecord.mLatencyTracker.appNotRespondingStarted();
        <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">incomingPid</span> <span class="hljs-operator">=</span> anrProcess.mPid;
        timeoutRecord.mLatencyTracker.waitingOnAnrRecordLockStarted();
        <span class="hljs-keyword">synchronized</span> (mAnrRecords) {
            ...
            <span class="hljs-comment">//æ·»åŠ anräº‹ä»¶(åŒ…å«anräº‹ä»¶æ•°æ®å’Œå½“å‰ANRçš„åº”ç”¨ä¿¡æ¯)åˆ°listä¸­</span>
            mAnrRecords.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AnrRecord</span>(anrProcess, activityShortComponentName, aInfo,
                    parentShortComponentName, parentProcess, aboveSystem, timeoutRecord,
                    isContinuousAnr, firstPidDumpPromise));<span class="hljs-comment">//æ³¨é‡Š78</span>
        }
        <span class="hljs-comment">//å¼€å§‹æ¶ˆè´¹ANRäº‹ä»¶</span>
        startAnrConsumerIfNeeded();<span class="hljs-comment">//æ³¨é‡Š79</span>
    } <span class="hljs-keyword">finally</span> {
        timeoutRecord.mLatencyTracker.appNotRespondingEnded();
    }
}
    
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startAnrConsumerIfNeeded</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (mRunning.compareAndSet(<span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>)) {
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">AnrConsumerThread</span>().start();
    }
}


<span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AnrConsumerThread</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span> {
    AnrConsumerThread() {
        <span class="hljs-built_in">super</span>(<span class="hljs-string">"AnrConsumer"</span>);
    }

    ...

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
        AnrRecord r;
        <span class="hljs-keyword">while</span> ((r = next()) != <span class="hljs-literal">null</span>) {
            scheduleBinderHeavyHitterAutoSamplerIfNecessary();
            <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">currentPid</span> <span class="hljs-operator">=</span> r.mApp.mPid;
            <span class="hljs-keyword">if</span> (currentPid != r.mPid) { <span class="hljs-comment">// åŒ¹é…pid</span>
                <span class="hljs-comment">// The process may have restarted or died.</span>
                Slog.i(TAG, <span class="hljs-string">"Skip ANR with mismatched pid="</span> + r.mPid + <span class="hljs-string">", current pid="</span>
                        + currentPid);
                <span class="hljs-keyword">continue</span>;
            }
            <span class="hljs-comment">//ç»§ç»­åˆ†å‘</span>
            r.appNotResponding(onlyDumpSelf);
        }

        mRunning.set(<span class="hljs-literal">false</span>);
        <span class="hljs-keyword">synchronized</span> (mAnrRecords) {
            mProcessingPid = -<span class="hljs-number">1</span>;
            <span class="hljs-comment">// The race should be unlikely to happen. Just to make sure we don't miss.</span>
            <span class="hljs-keyword">if</span> (!mAnrRecords.isEmpty()) {
                <span class="hljs-comment">//ç»§ç»­å¤„ç†å‰©ä¸‹çš„ANR äº‹ä»¶</span>
                startAnrConsumerIfNeeded();
            }
        }
    }
}

 <span class="hljs-keyword">void</span> <span class="hljs-title function_">appNotResponding</span><span class="hljs-params">(<span class="hljs-type">boolean</span> onlyDumpSelf)</span> {
    <span class="hljs-keyword">try</span> {
        mTimeoutRecord.mLatencyTracker.anrProcessingStarted();
        <span class="hljs-comment">//äº¤ç”±ProcessErrorStateRecordå¤„ç†</span>
        mApp.mErrorState.appNotResponding(mActivityShortComponentName, mAppInfo,
                mParentShortComponentName, mParentProcess, mAboveSystem,
                mTimeoutRecord, mAuxiliaryTaskExecutor, onlyDumpSelf,
                mIsContinuousAnr, mFirstPidFilePromise);<span class="hljs-comment">//æ³¨é‡Š80</span>
    } <span class="hljs-keyword">finally</span> {
        mTimeoutRecord.mLatencyTracker.anrProcessingEnded();
    }
}

</code></pre>
<ul>
<li><strong>æ³¨é‡Š78</strong> å°† InputDispatcher ä¼ é€’è¿‡æ¥çš„ ANR çš„äº‹ä»¶æ•°æ®å’Œå½“å‰ANRçš„è¿›ç¨‹ä¿¡æ¯å°è£…åˆ°ä¸€èµ· å¹¶æ·»åŠ åˆ°é›†åˆlist ä¸­</li>
<li><strong>æ³¨é‡Š79</strong> å¼€å¯å­çº¿ç¨‹ éå†å¤„ç†æ‰€æœ‰çš„ANRäº‹ä»¶ï¼Œå› ä¸ºåé¢è¿˜è¦æ”¶é›† ANRåº”ç”¨çš„è°ƒç”¨å †æ ˆ/å†…å­˜/CPU/Traceç­‰ä¿¡æ¯ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯åœ¨å­çº¿ç¨‹ä¸­å¤„ç†ANRäº‹ä»¶</li>
<li><strong>æ³¨é‡Š80</strong> äº¤ç”±ProcessErrorStateRecord.appNotResponding åœ¨å­çº¿ç¨‹å¼€å§‹çœŸæ­£å¤„ç†ANRï¼Œæ–¹æ³• appNotResponding çš„é€»è¾‘ä¹Ÿå¾ˆå¤šï¼Œæˆ‘ä»¬æŒ‘ä¸€äº›å…³é”®ä»£ç åˆ†æï¼š</li>
</ul>
<pre><code class="hljs language-java" lang="java">frameworks/base/services/core/java/com/android/server/am/ProcessErrorStateRecord.java
 <span class="hljs-keyword">void</span> <span class="hljs-title function_">appNotResponding</span><span class="hljs-params">(String activityShortComponentName, ApplicationInfo aInfo,
            String parentShortComponentName, WindowProcessController parentProcess,
            <span class="hljs-type">boolean</span> aboveSystem, TimeoutRecord timeoutRecord,
            ExecutorService auxiliaryTaskExecutor, <span class="hljs-type">boolean</span> onlyDumpSelf,
            <span class="hljs-type">boolean</span> isContinuousAnr, Future&lt;File&gt; firstPidFilePromise)</span> {
        ...

    <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> isSilentAnr;
    <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> pid;
    <span class="hljs-keyword">final</span> UUID errorId;
    latencyTracker.waitingOnAMSLockStarted();

    <span class="hljs-comment">// Build memory headers for the ANRing process.</span>
    <span class="hljs-comment">// æ”¶é›† ANRçš„å†…å­˜ä¿¡æ¯</span>
    LinkedHashMap&lt;String, String&gt; memoryHeaders = buildMemoryHeadersFor(pid); <span class="hljs-comment">//æ³¨é‡Š81</span>

    ...

    <span class="hljs-comment">// We push the native pids collection task to the helper thread through</span>
    <span class="hljs-comment">// the Anr auxiliary task executor, and wait on it later after dumping the first pids</span>
    <span class="hljs-comment">// æ”¶é›†native ä¿¡æ¯</span>
    Future&lt;ArrayList&lt;Integer&gt;&gt; nativePidsFuture =
            auxiliaryTaskExecutor.submit(
                () -&gt; {
                   ...
                    <span class="hljs-keyword">return</span> nativePids;
                });

    <span class="hljs-comment">// For background ANRs, don't pass the ProcessCpuTracker to</span>
    <span class="hljs-comment">// avoid spending 1/2 second collecting stats to rank lastPids.</span>
    <span class="hljs-type">StringWriter</span> <span class="hljs-variable">tracesFileException</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringWriter</span>();
    <span class="hljs-comment">// To hold the start and end offset to the ANR trace file respectively.</span>
    <span class="hljs-keyword">final</span> <span class="hljs-type">AtomicLong</span> <span class="hljs-variable">firstPidEndOffset</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicLong</span>(-<span class="hljs-number">1</span>);
    <span class="hljs-comment">//æ„é€ trace file æ–‡ä»¶ å¹¶dump trace ä¿¡æ¯</span>
    <span class="hljs-type">File</span> <span class="hljs-variable">tracesFile</span> <span class="hljs-operator">=</span> StackTracesDumpHelper.dumpStackTraces(firstPids,
            isSilentAnr ? <span class="hljs-literal">null</span> : processCpuTracker, isSilentAnr ? <span class="hljs-literal">null</span> : lastPids,
            nativePidsFuture, tracesFileException, firstPidEndOffset, annotation,
            criticalEventLog, memoryHeaders, auxiliaryTaskExecutor, firstPidFilePromise,
            latencyTracker);<span class="hljs-comment">// æ³¨é‡Š82</span>

    ...
    <span class="hljs-keyword">synchronized</span> (mService) {
        ...
        <span class="hljs-comment">//åå°åº”ç”¨ANRç›´æ¥killæ‰</span>
        <span class="hljs-keyword">if</span> (isSilentAnr() &amp;&amp; !mApp.isDebugging()) {
            mApp.killLocked(<span class="hljs-string">"bg anr"</span>, ApplicationExitInfo.REASON_ANR, <span class="hljs-literal">true</span>);ã€ã€æ³¨é‡Š<span class="hljs-number">83</span>
            <span class="hljs-keyword">return</span>;
        }
        ...
        <span class="hljs-keyword">if</span> (mService.mUiHandler != <span class="hljs-literal">null</span>) {
            <span class="hljs-comment">// Bring up the infamous App Not Responding dialog</span>
            <span class="hljs-type">Message</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> Message.obtain();
            msg.what = ActivityManagerService.SHOW_NOT_RESPONDING_UI_MSG;
            msg.obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AppNotRespondingDialog</span>.Data(mApp, aInfo, aboveSystem,
                    isContinuousAnr);
            <span class="hljs-comment">// å‘é€æ¶ˆæ¯SHOW_NOT_RESPONDING_UI_MSG åˆ°ä¸»çº¿ç¨‹ å¤„ç†</span>
            mService.mUiHandler.sendMessageDelayed(msg, anrDialogDelayMs);<span class="hljs-comment">//æ³¨é‡Š84</span>
        }
    }
}

</code></pre>
<ul>
<li><strong>æ³¨é‡Š81</strong> æ”¶é›†ANRçš„å†…å­˜ä¿¡æ¯</li>
<li><strong>æ³¨é‡Š82</strong> è¿™é‡Œæ˜¯é€šè¿‡å®ˆæŠ¤è¿›ç¨‹Debuggeræ¥æ”¶é›†Trace ä¿¡æ¯å¹¶ç”ŸæˆTraceæ–‡ä»¶ï¼Œè¿™é‡Œçš„ç»†èŠ‚åç»­ä¼šåœ¨å†…å­˜ä¼˜åŒ–çš„ç³»åˆ—æ–‡ç« ä¸­è®²è§£ã€‚</li>
<li><strong>æ³¨é‡Š83</strong> å¦‚æœå‘ç”ŸANRçš„è¿›ç¨‹ä¸åœ¨å‰å°ï¼Œåˆ™ç›´æ¥killæ‰</li>
<li><strong>æ³¨é‡Š84</strong> å‘é€ SHOW_NOT_RESPONDING_UI_MSG ç±»å‹çš„æ¶ˆæ¯åˆ°AMSçš„ä¸»çº¿ç¨‹åšå¼¹çª—å¤„ç†ï¼Œåé¢çš„é€»è¾‘å°±æ¯”è¾ƒç®€å•äº†ï¼Œè¿™é‡Œä¹Ÿä¸å±•å¼€äº†ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œé˜…è¯»æºç ã€‚</li>
</ul>
<h2 data-id="heading-10">8.æ€»ç»“</h2>
<p><code>InputReader</code>è´Ÿè´£ä¸€ç›´è¯»å–<code>EventHub</code>ä¸­ç›‘å¬åˆ°çš„è®¾å¤‡çš„äº‹ä»¶è¾“å…¥å’Œäº‹ä»¶å°è£…ï¼Œå¹¶å°†äº‹ä»¶ä¼ é€’ç»™<code>InputDispatcher</code>çš„é˜Ÿåˆ—ä¸­ï¼Œè€Œ<code>InputDispatcher</code>åˆ™è´Ÿè´£è¯»å–é˜Ÿåˆ—ä¸­çš„äº‹ä»¶å¹¶é€šè¿‡<code>socket</code>ä¼ é€’ç»™<code>IMS</code>å’Œ<code>WMS</code>å¯¹åº”çš„çª—å£çš„<code>ViewRootImpl</code>ç»‘å®šçš„<code>InpuChannel</code>çš„<code>socket</code>,å†ç»ç”±<code>InputState</code>è¿›è¡Œäº‹ä»¶çš„å¤„ç†ï¼Œ<code>InputState</code>å¤„ç†å®Œå†é€šè¿‡ <code>InputChannel</code> çš„<code>socket</code>å°†ç»“æŸæ ‡è®°å›ä¼ ç»™<code>InputDispatcher</code>ï¼Œæ­¤æ—¶<code>InputDispatcher</code>æ›´æ–°ANRæ ‡è®°å’Œåˆ†å‘ä¸‹ä¸€æ‰¹äº‹ä»¶.</p>
<p>è¿™é‡Œå†æ¥ä¸€å¼ å®Œæ•´çš„æµç¨‹å›¾</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0030b83c1e6f488e8b9ec3a3822674bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2FycnlaaGFuZw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768134762&amp;x-signature=iEGzfS1EE5yhZWMfvnnXqDE6rug%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ComposeåŸç†äºŒä¹‹GapBuffer]]></title>    <link>https://juejin.cn/post/7591338980693852206</link>    <guid>https://juejin.cn/post/7591338980693852206</guid>    <pubDate>2026-01-04T13:33:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591338980693852206" data-draft-id="7591334208997474330" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ComposeåŸç†äºŒä¹‹GapBuffer"/> <meta itemprop="keywords" content="Android,æ¶æ„"/> <meta itemprop="datePublished" content="2026-01-04T13:33:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è£´äº‘é£"/> <meta itemprop="url" content="https://juejin.cn/user/3734361144570285"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ComposeåŸç†äºŒä¹‹GapBuffer
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3734361144570285/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è£´äº‘é£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T13:33:07.000Z" title="Sun Jan 04 2026 13:33:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¼ ç»Ÿæ•°ç»„çš„æ’å…¥æ—¶é—´å¤æ‚åº¦æ˜¯O(n)ï¼ŒGapBufferå°±æ˜¯ä¸ºäº†è§£å†³æ•°ç»„æ’å…¥æ…¢çš„é—®é¢˜ã€‚GapBufferæ˜¯ä¸€ç§ä¼˜åŒ–çš„æ•°æ®ç»“æ„ï¼Œç”¨äºé«˜æ•ˆåœ°åœ¨ä»»æ„ä½ç½®è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ç»´æŠ¤ä¸€ä¸ª"é—´éš™"ï¼ˆgapï¼‰ï¼Œåœ¨é—´éš™ä½ç½®çš„æ’å…¥/åˆ é™¤çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(1) ã€‚</p>
<p>ç›´æ¥ä¸Šä»£ç ï¼Œæœ‰è¯¦ç»†çš„ä»£ç æ³¨é‡Šã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin">
<span class="hljs-comment">/**
 * Gap Buffer æ•°æ®ç»“æ„å®ç°
 *
 * Gap Buffer æ˜¯ä¸€ç§ä¼˜åŒ–çš„æ•°æ®ç»“æ„ï¼Œç”¨äºé«˜æ•ˆåœ°åœ¨ä»»æ„ä½ç½®è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œã€‚
 * å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ç»´æŠ¤ä¸€ä¸ª"é—´éš™"ï¼ˆgapï¼‰ï¼Œåœ¨é—´éš™ä½ç½®çš„æ’å…¥/åˆ é™¤æ˜¯ O(1) çš„ã€‚
 *
 * ç»“æ„ç¤ºæ„å›¾:
 * ```
 * [A][B][C][_][_][_][_][D][E][F]
 *          â†‘           â†‘
 *       gapStart    gapEnd
 *
 * é€»è¾‘å†…å®¹: [A, B, C, D, E, F]
 * ```
 *
 * è¿™æ˜¯ Compose Runtime ä¸­ SlotTable ä½¿ç”¨çš„æ ¸å¿ƒæ•°æ®ç»“æ„ã€‚
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">GapBuffer</span>&lt;<span class="hljs-type">T</span>&gt;(initialCapacity: <span class="hljs-built_in">Int</span> = <span class="hljs-number">16</span>) {

    <span class="hljs-comment">// å†…éƒ¨æ•°ç»„å­˜å‚¨</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> buffer: Array&lt;Any?&gt; = arrayOfNulls(initialCapacity)

    <span class="hljs-comment">// é—´éš™èµ·å§‹ä½ç½®ï¼ˆåŒ…å«ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> gapStart: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>

    <span class="hljs-comment">// é—´éš™ç»“æŸä½ç½®ï¼ˆä¸åŒ…å«ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> gapEnd: <span class="hljs-built_in">Int</span> = initialCapacity

    <span class="hljs-comment">/**
     * é€»è¾‘å¤§å°ï¼ˆä¸åŒ…å«é—´éš™ï¼‰
     */</span>
    <span class="hljs-keyword">val</span> size: <span class="hljs-built_in">Int</span>
        <span class="hljs-keyword">get</span>() = buffer.size - gapSize

    <span class="hljs-comment">/**
     * é—´éš™å¤§å°
     */</span>
    <span class="hljs-keyword">val</span> gapSize: <span class="hljs-built_in">Int</span>
        <span class="hljs-keyword">get</span>() = gapEnd - gapStart

    <span class="hljs-comment">/**
     * å½“å‰é—´éš™ä½ç½®
     */</span>
    <span class="hljs-keyword">val</span> currentGapStart: <span class="hljs-built_in">Int</span>
        <span class="hljs-keyword">get</span>() = gapStart

    <span class="hljs-comment">/**
     * åœ¨æŒ‡å®šä½ç½®æ’å…¥å…ƒç´ 
     *
     * æ­¥éª¤ï¼š
     * 1. å¦‚æœé—´éš™å¤§å°ä¸º 0ï¼Œæ‰©å®¹
     * 2. å°†é—´éš™ç§»åŠ¨åˆ°æ’å…¥ä½ç½®
     * 3. åœ¨é—´éš™èµ·å§‹ä½ç½®æ’å…¥å…ƒç´ 
     * 4. gapStart++
     *
     * <span class="hljs-doctag">@param</span> index é€»è¾‘ç´¢å¼•ä½ç½®
     * <span class="hljs-doctag">@param</span> element è¦æ’å…¥çš„å…ƒç´ 
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">insert</span><span class="hljs-params">(index: <span class="hljs-type">Int</span>, element: <span class="hljs-type">T</span>)</span></span> {
        require(index <span class="hljs-keyword">in</span> <span class="hljs-number">0.</span>.size) { <span class="hljs-string">"Index <span class="hljs-variable">$index</span> out of bounds for size <span class="hljs-variable">$size</span>"</span> }

        <span class="hljs-comment">// 1. éœ€è¦æ—¶æ‰©å®¹</span>
        <span class="hljs-keyword">if</span> (gapSize == <span class="hljs-number">0</span>) {
            grow()
        }

        <span class="hljs-comment">// 2. ç§»åŠ¨é—´éš™åˆ°ç›®æ ‡ä½ç½®</span>
        moveGap(index)

        <span class="hljs-comment">// 3. åœ¨é—´éš™ä½ç½®æ’å…¥</span>
        buffer[gapStart] = element

        <span class="hljs-comment">// 4. ç¼©å°é—´éš™</span>
        gapStart++
    }

    <span class="hljs-comment">/**
     * åœ¨æŒ‡å®šä½ç½®æ’å…¥å¤šä¸ªå…ƒç´ 
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">insertAll</span><span class="hljs-params">(index: <span class="hljs-type">Int</span>, elements: <span class="hljs-type">List</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> {
        require(index <span class="hljs-keyword">in</span> <span class="hljs-number">0.</span>.size) { <span class="hljs-string">"Index <span class="hljs-variable">$index</span> out of bounds for size <span class="hljs-variable">$size</span>"</span> }

        <span class="hljs-comment">// ç¡®ä¿æœ‰è¶³å¤Ÿç©ºé—´</span>
        <span class="hljs-keyword">while</span> (gapSize &lt; elements.size) {
            grow()
        }

        <span class="hljs-comment">// ç§»åŠ¨é—´éš™åˆ°ç›®æ ‡ä½ç½®</span>
        moveGap(index)

        <span class="hljs-comment">// é€ä¸ªæ’å…¥</span>
        <span class="hljs-keyword">for</span> (element <span class="hljs-keyword">in</span> elements) {
            buffer[gapStart] = element
            gapStart++
        }
    }

    <span class="hljs-comment">/**
     * åˆ é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ 
     *
     * æ­¥éª¤ï¼š
     * 1. å°†é—´éš™ç§»åŠ¨åˆ°åˆ é™¤ä½ç½®
     * 2. gapEnd++ (æ‰©å¤§é—´éš™ï¼Œè¦†ç›–è¦åˆ é™¤çš„å…ƒç´ )
     *
     * <span class="hljs-doctag">@param</span> index é€»è¾‘ç´¢å¼•ä½ç½®
     * <span class="hljs-doctag">@return</span> è¢«åˆ é™¤çš„å…ƒç´ 
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">removeAt</span><span class="hljs-params">(index: <span class="hljs-type">Int</span>)</span></span>: T {
        require(index <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> until size) { <span class="hljs-string">"Index <span class="hljs-variable">$index</span> out of bounds for size <span class="hljs-variable">$size</span>"</span> }

        <span class="hljs-comment">// ç§»åŠ¨é—´éš™åˆ°ç›®æ ‡ä½ç½®åé¢</span>
        moveGap(index + <span class="hljs-number">1</span>)

        <span class="hljs-comment">// æ‰©å¤§é—´éš™çš„èµ·å§‹ä½ç½®ï¼ˆç›¸å½“äºåˆ é™¤å…ƒç´ ï¼‰</span>
        gapStart--

        <span class="hljs-comment">// è·å–å¹¶æ¸…é™¤è¢«åˆ é™¤çš„å…ƒç´ </span>
        <span class="hljs-meta">@Suppress(<span class="hljs-string">"UNCHECKED_CAST"</span>)</span>
        <span class="hljs-keyword">val</span> removed = buffer[gapStart] <span class="hljs-keyword">as</span> T
        buffer[gapStart] = <span class="hljs-literal">null</span>

        <span class="hljs-keyword">return</span> removed
    }

    <span class="hljs-comment">/**
     * åˆ é™¤æŒ‡å®šèŒƒå›´çš„å…ƒç´ 
     *
     * <span class="hljs-doctag">@param</span> startIndex èµ·å§‹ç´¢å¼•ï¼ˆåŒ…å«ï¼‰
     * <span class="hljs-doctag">@param</span> endIndex ç»“æŸç´¢å¼•ï¼ˆä¸åŒ…å«ï¼‰
     * <span class="hljs-doctag">@return</span> è¢«åˆ é™¤çš„å…ƒç´ åˆ—è¡¨
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">removeRange</span><span class="hljs-params">(startIndex: <span class="hljs-type">Int</span>, endIndex: <span class="hljs-type">Int</span>)</span></span>: List&lt;T&gt; {
        require(startIndex <span class="hljs-keyword">in</span> <span class="hljs-number">0.</span>.size) { <span class="hljs-string">"Start index <span class="hljs-variable">$startIndex</span> out of bounds"</span> }
        require(endIndex <span class="hljs-keyword">in</span> startIndex..size) { <span class="hljs-string">"End index <span class="hljs-variable">$endIndex</span> out of bounds"</span> }

        <span class="hljs-keyword">val</span> count = endIndex - startIndex
        <span class="hljs-keyword">if</span> (count == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> emptyList()

        <span class="hljs-keyword">val</span> removed = mutableListOf&lt;T&gt;()

        <span class="hljs-comment">// ç§»åŠ¨é—´éš™åˆ°åˆ é™¤èŒƒå›´ä¹‹å</span>
        moveGap(endIndex)

        <span class="hljs-comment">// æ”¶é›†è¢«åˆ é™¤çš„å…ƒç´ å¹¶æ‰©å¤§é—´éš™</span>
        repeat(count) {
            gapStart--
            <span class="hljs-meta">@Suppress(<span class="hljs-string">"UNCHECKED_CAST"</span>)</span>
            removed.add(<span class="hljs-number">0</span>, buffer[gapStart] <span class="hljs-keyword">as</span> T)
            buffer[gapStart] = <span class="hljs-literal">null</span>
        }

        <span class="hljs-keyword">return</span> removed
    }

    <span class="hljs-comment">/**
     * è·å–æŒ‡å®šä½ç½®çš„å…ƒç´ 
     *
     * éœ€è¦å¤„ç†é€»è¾‘ç´¢å¼•åˆ°ç‰©ç†ç´¢å¼•çš„è½¬æ¢
     */</span>
    <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">get</span><span class="hljs-params">(index: <span class="hljs-type">Int</span>)</span></span>: T {
        require(index <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> until size) { <span class="hljs-string">"Index <span class="hljs-variable">$index</span> out of bounds for size <span class="hljs-variable">$size</span>"</span> }
        <span class="hljs-meta">@Suppress(<span class="hljs-string">"UNCHECKED_CAST"</span>)</span>
        <span class="hljs-keyword">return</span> buffer[toPhysicalIndex(index)] <span class="hljs-keyword">as</span> T
    }

    <span class="hljs-comment">/**
     * è®¾ç½®æŒ‡å®šä½ç½®çš„å…ƒç´ 
     */</span>
    <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">set</span><span class="hljs-params">(index: <span class="hljs-type">Int</span>, element: <span class="hljs-type">T</span>)</span></span> {
        require(index <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> until size) { <span class="hljs-string">"Index <span class="hljs-variable">$index</span> out of bounds for size <span class="hljs-variable">$size</span>"</span> }
        buffer[toPhysicalIndex(index)] = element
    }

    <span class="hljs-comment">/**
     * å°†é€»è¾‘ç´¢å¼•è½¬æ¢ä¸ºç‰©ç†ç´¢å¼•
     *
     * é€»è¾‘è§†å›¾: [A][B][C][D][E][F]
     *            0  1  2  3  4  5
     *
     * ç‰©ç†æ•°ç»„: [A][B][C][_][_][_][D][E][F]
     *            0  1  2  3  4  5  6  7  8
     *                     â†‘        â†‘
     *                  gapStart  gapEnd
     *
     * é€»è¾‘ç´¢å¼• 0-2 ç›´æ¥å¯¹åº”ç‰©ç†ç´¢å¼• 0-2
     * é€»è¾‘ç´¢å¼• 3-5 éœ€è¦åŠ ä¸Š gapSize
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">toPhysicalIndex</span><span class="hljs-params">(logicalIndex: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> (logicalIndex &lt; gapStart) {
            logicalIndex
        } <span class="hljs-keyword">else</span> {
            logicalIndex + gapSize
        }
    }

    <span class="hljs-comment">/**
     * ç§»åŠ¨é—´éš™åˆ°ç›®æ ‡ä½ç½®
     *
     * è¿™æ˜¯ Gap Buffer çš„æ ¸å¿ƒæ“ä½œã€‚
     *
     * åœºæ™¯1: é—´éš™å‘å³ç§»åŠ¨ (targetIndex &gt; gapStart)
     * ```
     * ç§»åŠ¨å‰: [A][B][_][_][_][C][D][E]
     *               â†‘        â†‘
     *            gapStart  gapEnd
     *
     * ç›®æ ‡: ç§»åŠ¨åˆ°ç´¢å¼• 4
     *
     * æ“ä½œ: æŠŠ gapEnd åˆ° gapEnd+ç§»åŠ¨è·ç¦» çš„å…ƒç´ å¤åˆ¶åˆ° gapStart
     *       [A][B][C][D][_][_][_][E]
     *
     * ç§»åŠ¨å: [A][B][C][D][_][_][_][E]
     *                     â†‘        â†‘
     *                  gapStart  gapEnd
     * ```
     *
     * åœºæ™¯2: é—´éš™å‘å·¦ç§»åŠ¨ (targetIndex &lt; gapStart)
     * ```
     * ç§»åŠ¨å‰: [A][B][C][D][_][_][_][E]
     *                     â†‘        â†‘
     *                  gapStart  gapEnd
     *
     * ç›®æ ‡: ç§»åŠ¨åˆ°ç´¢å¼• 1
     *
     * æ“ä½œ: æŠŠ targetIndex åˆ° gapStart çš„å…ƒç´ å¤åˆ¶åˆ° gapEnd ä¹‹å‰
     *       [A][_][_][_][B][C][D][E]
     *
     * ç§»åŠ¨å: [A][_][_][_][B][C][D][E]
     *            â†‘        â†‘
     *         gapStart  gapEnd
     * ```
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">moveGap</span><span class="hljs-params">(targetIndex: <span class="hljs-type">Int</span>)</span></span> {
        <span class="hljs-keyword">if</span> (targetIndex == gapStart) {
            <span class="hljs-comment">// é—´éš™å·²åœ¨ç›®æ ‡ä½ç½®</span>
            <span class="hljs-keyword">return</span>
        }

        <span class="hljs-keyword">if</span> (targetIndex &gt; gapStart) {
            <span class="hljs-comment">// é—´éš™å‘å³ç§»åŠ¨</span>
            <span class="hljs-comment">// éœ€è¦æŠŠé—´éš™å³è¾¹çš„å…ƒç´ ç§»åˆ°å·¦è¾¹</span>

            <span class="hljs-keyword">val</span> moveCount = targetIndex - gapStart
            <span class="hljs-comment">// ä» gapEnd å¤åˆ¶ moveCount ä¸ªå…ƒç´ åˆ° gapStart</span>
            <span class="hljs-comment">// copyInto(destination, destinationOffset, startIndex, endIndex)</span>
            buffer.copyInto(buffer, gapStart, gapEnd, gapEnd + moveCount)
            <span class="hljs-comment">// æ¸…é™¤åŸä½ç½®</span>
            <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> gapEnd until gapEnd + moveCount) {
                buffer[i] = <span class="hljs-literal">null</span>
            }
            <span class="hljs-comment">// æ›´æ–°é—´éš™ä½ç½®</span>
            gapStart += moveCount
            gapEnd += moveCount

        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// é—´éš™å‘å·¦ç§»åŠ¨</span>
            <span class="hljs-comment">// éœ€è¦æŠŠé—´éš™å·¦è¾¹çš„å…ƒç´ ç§»åˆ°å³è¾¹</span>

            <span class="hljs-keyword">val</span> moveCount = gapStart - targetIndex
            <span class="hljs-comment">// ä» targetIndex å¤åˆ¶ moveCount ä¸ªå…ƒç´ åˆ° gapEnd - moveCount</span>
            <span class="hljs-comment">// copyInto(destination, destinationOffset, startIndex, endIndex)</span>
            buffer.copyInto(buffer, gapEnd - moveCount, targetIndex, targetIndex + moveCount)
            <span class="hljs-comment">// æ¸…é™¤åŸä½ç½®</span>
            <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> targetIndex until targetIndex + moveCount) {
                buffer[i] = <span class="hljs-literal">null</span>
            }
            <span class="hljs-comment">// æ›´æ–°é—´éš™ä½ç½®</span>
            gapStart -= moveCount
            gapEnd -= moveCount
        }
    }

    <span class="hljs-comment">/**
     * æ‰©å®¹
     *
     * ç­–ç•¥: å®¹é‡ç¿»å€ï¼Œæ–°ç©ºé—´å…¨éƒ¨åŠ å…¥é—´éš™
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">grow</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">val</span> oldCapacity = buffer.size
        <span class="hljs-keyword">val</span> newCapacity = oldCapacity * <span class="hljs-number">2</span>
        <span class="hljs-keyword">val</span> newBuffer = arrayOfNulls&lt;Any?&gt;(newCapacity)

        <span class="hljs-comment">// å¤åˆ¶é—´éš™ä¹‹å‰çš„å…ƒç´ </span>
        <span class="hljs-comment">// copyInto(destination, destinationOffset, startIndex, endIndex)</span>
        buffer.copyInto(newBuffer, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, gapStart)

        <span class="hljs-comment">// å¤åˆ¶é—´éš™ä¹‹åçš„å…ƒç´ ï¼ˆæ”¾åˆ°æ–°æ•°ç»„çš„æœ«å°¾ï¼‰</span>
        <span class="hljs-keyword">val</span> afterGapCount = oldCapacity - gapEnd
        <span class="hljs-keyword">val</span> newGapEnd = newCapacity - afterGapCount
        buffer.copyInto(newBuffer, newGapEnd, gapEnd, oldCapacity)

        buffer = newBuffer
        gapEnd = newGapEnd
    }

    <span class="hljs-comment">/**
     * è·å–å½“å‰çŠ¶æ€çš„å¯è§†åŒ–å­—ç¬¦ä¸²
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">visualize</span><span class="hljs-params">()</span></span>: String {
        <span class="hljs-keyword">val</span> sb = StringBuilder()
        sb.append(<span class="hljs-string">"GapBuffer(size=<span class="hljs-variable">$size</span>, capacity=<span class="hljs-subst">${buffer.size}</span>, gap=<span class="hljs-variable">$gapStart</span>..<span class="hljs-variable">$gapEnd</span>)\n"</span>)
        sb.append(<span class="hljs-string">"Physical: ["</span>)
        <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> buffer.indices) {
            <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span>) sb.append(<span class="hljs-string">"]["</span>)
            <span class="hljs-keyword">if</span> (i <span class="hljs-keyword">in</span> gapStart until gapEnd) {
                sb.append(<span class="hljs-string">"_"</span>)
            } <span class="hljs-keyword">else</span> {
                sb.append(buffer[i] ?: <span class="hljs-string">"null"</span>)
            }
        }
        sb.append(<span class="hljs-string">"]\n"</span>)
        sb.append(<span class="hljs-string">"Logical:  ["</span>)
        <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> until size) {
            <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span>) sb.append(<span class="hljs-string">", "</span>)
            sb.append(<span class="hljs-keyword">get</span>(i))
        }
        sb.append(<span class="hljs-string">"]"</span>)
        <span class="hljs-keyword">return</span> sb.toString()
    }

    <span class="hljs-comment">/**
     * è½¬æ¢ä¸ºåˆ—è¡¨
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">toList</span><span class="hljs-params">()</span></span>: List&lt;T&gt; {
        <span class="hljs-keyword">val</span> result = mutableListOf&lt;T&gt;()
        <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> until size) {
            result.add(<span class="hljs-keyword">get</span>(i))
        }
        <span class="hljs-keyword">return</span> result
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">toString</span><span class="hljs-params">()</span></span>: String = toList().toString()
}

</code></pre>
<p>ä¸Šé¢å°±æ˜¯GapBufferçš„å®ç°ä»£ç ï¼Œåˆæ¬¡æŸ¥çœ‹å¯èƒ½æœ‰ç‚¹éš¾ä»¥ç†è§£ï¼Œä¸‹é¢æ˜¯å¸¦è¯¦ç»†æ—¥å¿—çš„GapBufferï¼Œç”¨äºæ¼”ç¤ºæ‰§è¡Œæµç¨‹ã€‚åœºæ™¯æ˜¯æ„å»º [1,2,4,5,6]ï¼Œç„¶ååœ¨2åé¢æ’å…¥3ï¼Œçœ‹ä¸‹æ‰§è¡Œæµç¨‹ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * å¸¦è¯¦ç»†æ—¥å¿—çš„ GapBufferï¼Œç”¨äºæ¼”ç¤ºæ‰§è¡Œæµç¨‹
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">GapBufferDebug</span>&lt;<span class="hljs-type">T</span>&gt;(initialCapacity: <span class="hljs-built_in">Int</span> = <span class="hljs-number">16</span>) {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> buffer: Array&lt;Any?&gt; = arrayOfNulls(initialCapacity)
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> gapStart: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> gapEnd: <span class="hljs-built_in">Int</span> = initialCapacity

    <span class="hljs-keyword">val</span> size: <span class="hljs-built_in">Int</span> <span class="hljs-keyword">get</span>() = buffer.size - gapSize
    <span class="hljs-keyword">val</span> gapSize: <span class="hljs-built_in">Int</span> <span class="hljs-keyword">get</span>() = gapEnd - gapStart

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">insert</span><span class="hljs-params">(index: <span class="hljs-type">Int</span>, element: <span class="hljs-type">T</span>)</span></span> {
        println(<span class="hljs-string">"â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"</span>)
        println(<span class="hljs-string">"â”‚ è°ƒç”¨ insert(index=<span class="hljs-variable">$index</span>, element=<span class="hljs-variable">$element</span>)"</span>)
        println(<span class="hljs-string">"â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"</span>)
        println(<span class="hljs-string">"â”‚ ã€è¿›å…¥ insert æ–¹æ³•ã€‘"</span>)
        println(<span class="hljs-string">"â”‚   å½“å‰çŠ¶æ€:"</span>)
        println(<span class="hljs-string">"â”‚     size = <span class="hljs-variable">$size</span>"</span>)
        println(<span class="hljs-string">"â”‚     gapStart = <span class="hljs-variable">$gapStart</span>"</span>)
        println(<span class="hljs-string">"â”‚     gapEnd = <span class="hljs-variable">$gapEnd</span>"</span>)
        println(<span class="hljs-string">"â”‚     gapSize = <span class="hljs-variable">$gapSize</span>"</span>)
        println(<span class="hljs-string">"â”‚     buffer = <span class="hljs-subst">${bufferToString()}</span>"</span>)
        println(<span class="hljs-string">"â”‚"</span>)

        require(index <span class="hljs-keyword">in</span> <span class="hljs-number">0.</span>.size) { <span class="hljs-string">"Index <span class="hljs-variable">$index</span> out of bounds for size <span class="hljs-variable">$size</span>"</span> }

        <span class="hljs-comment">// 1. æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹</span>
        println(<span class="hljs-string">"â”‚ ã€æ­¥éª¤1ã€‘æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹"</span>)
        println(<span class="hljs-string">"â”‚   gapSize (<span class="hljs-variable">$gapSize</span>) == 0 ? <span class="hljs-subst">${gapSize == <span class="hljs-number">0</span>}</span>"</span>)
        <span class="hljs-keyword">if</span> (gapSize == <span class="hljs-number">0</span>) {
            println(<span class="hljs-string">"â”‚   â†’ éœ€è¦æ‰©å®¹ï¼Œè°ƒç”¨ grow()"</span>)
            grow()
        } <span class="hljs-keyword">else</span> {
            println(<span class="hljs-string">"â”‚   â†’ ä¸éœ€è¦æ‰©å®¹"</span>)
        }
        println(<span class="hljs-string">"â”‚"</span>)

        <span class="hljs-comment">// 2. ç§»åŠ¨é—´éš™åˆ°ç›®æ ‡ä½ç½®</span>
        println(<span class="hljs-string">"â”‚ ã€æ­¥éª¤2ã€‘ç§»åŠ¨é—´éš™åˆ°ç›®æ ‡ä½ç½® (targetIndex=<span class="hljs-variable">$index</span>)"</span>)
        moveGap(index)
        println(<span class="hljs-string">"â”‚"</span>)

        <span class="hljs-comment">// 3. åœ¨é—´éš™ä½ç½®æ’å…¥</span>
        println(<span class="hljs-string">"â”‚ ã€æ­¥éª¤3ã€‘åœ¨é—´éš™ä½ç½®æ’å…¥å…ƒç´ "</span>)
        println(<span class="hljs-string">"â”‚   buffer[<span class="hljs-variable">$gapStart</span>] = <span class="hljs-variable">$element</span>"</span>)
        buffer[gapStart] = element
        println(<span class="hljs-string">"â”‚   æ’å…¥å buffer = <span class="hljs-subst">${bufferToString()}</span>"</span>)
        println(<span class="hljs-string">"â”‚"</span>)

        <span class="hljs-comment">// 4. ç¼©å°é—´éš™</span>
        println(<span class="hljs-string">"â”‚ ã€æ­¥éª¤4ã€‘ç¼©å°é—´éš™ (gapStart++)"</span>)
        println(<span class="hljs-string">"â”‚   gapStart: <span class="hljs-variable">$gapStart</span> â†’ <span class="hljs-subst">${gapStart + <span class="hljs-number">1</span>}</span>"</span>)
        gapStart++
        println(<span class="hljs-string">"â”‚"</span>)

        println(<span class="hljs-string">"â”‚ ã€æ’å…¥å®Œæˆã€‘"</span>)
        println(<span class="hljs-string">"â”‚   æœ€ç»ˆçŠ¶æ€:"</span>)
        println(<span class="hljs-string">"â”‚     size = <span class="hljs-variable">$size</span>"</span>)
        println(<span class="hljs-string">"â”‚     gapStart = <span class="hljs-variable">$gapStart</span>"</span>)
        println(<span class="hljs-string">"â”‚     gapEnd = <span class="hljs-variable">$gapEnd</span>"</span>)
        println(<span class="hljs-string">"â”‚     gapSize = <span class="hljs-variable">$gapSize</span>"</span>)
        println(<span class="hljs-string">"â”‚     buffer = <span class="hljs-subst">${bufferToString()}</span>"</span>)
        println(<span class="hljs-string">"â”‚     é€»è¾‘å†…å®¹ = <span class="hljs-subst">${toList()}</span>"</span>)
        println(<span class="hljs-string">"â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"</span>)
        println()
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">moveGap</span><span class="hljs-params">(targetIndex: <span class="hljs-type">Int</span>)</span></span> {
        println(<span class="hljs-string">"â”‚   â”Œâ”€ moveGap(targetIndex=<span class="hljs-variable">$targetIndex</span>) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"</span>)
        println(<span class="hljs-string">"â”‚   â”‚ å½“å‰ gapStart=<span class="hljs-variable">$gapStart</span>, gapEnd=<span class="hljs-variable">$gapEnd</span>"</span>)
        println(<span class="hljs-string">"â”‚   â”‚ ç›®æ ‡ä½ç½® targetIndex=<span class="hljs-variable">$targetIndex</span>"</span>)

        <span class="hljs-keyword">if</span> (targetIndex == gapStart) {
            println(<span class="hljs-string">"â”‚   â”‚ targetIndex == gapStartï¼Œé—´éš™å·²åœ¨ç›®æ ‡ä½ç½®ï¼Œæ— éœ€ç§»åŠ¨"</span>)
            println(<span class="hljs-string">"â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"</span>)
            <span class="hljs-keyword">return</span>
        }

        <span class="hljs-keyword">if</span> (targetIndex &gt; gapStart) {
            <span class="hljs-comment">// é—´éš™å‘å³ç§»åŠ¨</span>
            println(<span class="hljs-string">"â”‚   â”‚ targetIndex (<span class="hljs-variable">$targetIndex</span>) &gt; gapStart (<span class="hljs-variable">$gapStart</span>)"</span>)
            println(<span class="hljs-string">"â”‚   â”‚ â†’ é—´éš™éœ€è¦ã€å‘å³ç§»åŠ¨ã€‘"</span>)
            println(<span class="hljs-string">"â”‚   â”‚"</span>)
            
            <span class="hljs-keyword">val</span> moveCount = targetIndex - gapStart
            println(<span class="hljs-string">"â”‚   â”‚ è®¡ç®—: moveCount = targetIndex - gapStart = <span class="hljs-variable">$targetIndex</span> - <span class="hljs-variable">$gapStart</span> = <span class="hljs-variable">$moveCount</span>"</span>)
            println(<span class="hljs-string">"â”‚   â”‚"</span>)
            
            println(<span class="hljs-string">"â”‚   â”‚ æ“ä½œ: æŠŠé—´éš™å³è¾¹çš„ <span class="hljs-variable">$moveCount</span> ä¸ªå…ƒç´ ç§»åˆ°é—´éš™å·¦è¾¹"</span>)
            println(<span class="hljs-string">"â”‚   â”‚   copyInto(buffer, destOffset=<span class="hljs-variable">$gapStart</span>, startIndex=<span class="hljs-variable">$gapEnd</span>, endIndex=<span class="hljs-subst">${gapEnd + moveCount}</span>)"</span>)
            println(<span class="hljs-string">"â”‚   â”‚   å³: æŠŠ buffer[<span class="hljs-variable">$gapEnd</span>..<span class="hljs-subst">${gapEnd + moveCount - <span class="hljs-number">1</span>}</span>] å¤åˆ¶åˆ° buffer[<span class="hljs-variable">$gapStart</span>..<span class="hljs-subst">${gapStart + moveCount - <span class="hljs-number">1</span>}</span>]"</span>)
            println(<span class="hljs-string">"â”‚   â”‚"</span>)
            println(<span class="hljs-string">"â”‚   â”‚ ç§»åŠ¨å‰: <span class="hljs-subst">${bufferToString()}</span>"</span>)
            
            buffer.copyInto(buffer, gapStart, gapEnd, gapEnd + moveCount)
            
            println(<span class="hljs-string">"â”‚   â”‚ å¤åˆ¶å: <span class="hljs-subst">${bufferToString()}</span>"</span>)
            
            <span class="hljs-comment">// æ¸…é™¤åŸä½ç½®</span>
            println(<span class="hljs-string">"â”‚   â”‚"</span>)
            println(<span class="hljs-string">"â”‚   â”‚ æ¸…é™¤åŸä½ç½® buffer[<span class="hljs-variable">$gapEnd</span>..<span class="hljs-subst">${gapEnd + moveCount - <span class="hljs-number">1</span>}</span>]"</span>)
            <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> gapEnd until gapEnd + moveCount) {
                buffer[i] = <span class="hljs-literal">null</span>
            }
            println(<span class="hljs-string">"â”‚   â”‚ æ¸…é™¤å: <span class="hljs-subst">${bufferToString()}</span>"</span>)
            
            <span class="hljs-comment">// æ›´æ–°é—´éš™ä½ç½®</span>
            println(<span class="hljs-string">"â”‚   â”‚"</span>)
            println(<span class="hljs-string">"â”‚   â”‚ æ›´æ–°é—´éš™ä½ç½®:"</span>)
            println(<span class="hljs-string">"â”‚   â”‚   gapStart: <span class="hljs-variable">$gapStart</span> â†’ <span class="hljs-subst">${gapStart + moveCount}</span>"</span>)
            println(<span class="hljs-string">"â”‚   â”‚   gapEnd: <span class="hljs-variable">$gapEnd</span> â†’ <span class="hljs-subst">${gapEnd + moveCount}</span>"</span>)
            gapStart += moveCount
            gapEnd += moveCount

        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// é—´éš™å‘å·¦ç§»åŠ¨</span>
            println(<span class="hljs-string">"â”‚   â”‚ targetIndex (<span class="hljs-variable">$targetIndex</span>) &lt; gapStart (<span class="hljs-variable">$gapStart</span>)"</span>)
            println(<span class="hljs-string">"â”‚   â”‚ â†’ é—´éš™éœ€è¦ã€å‘å·¦ç§»åŠ¨ã€‘"</span>)
            println(<span class="hljs-string">"â”‚   â”‚"</span>)
            
            <span class="hljs-keyword">val</span> moveCount = gapStart - targetIndex
            println(<span class="hljs-string">"â”‚   â”‚ è®¡ç®—: moveCount = gapStart - targetIndex = <span class="hljs-variable">$gapStart</span> - <span class="hljs-variable">$targetIndex</span> = <span class="hljs-variable">$moveCount</span>"</span>)
            println(<span class="hljs-string">"â”‚   â”‚"</span>)
            
            println(<span class="hljs-string">"â”‚   â”‚ æ“ä½œ: æŠŠé—´éš™å·¦è¾¹çš„ <span class="hljs-variable">$moveCount</span> ä¸ªå…ƒç´ ç§»åˆ°é—´éš™å³è¾¹"</span>)
            println(<span class="hljs-string">"â”‚   â”‚   copyInto(buffer, destOffset=<span class="hljs-subst">${gapEnd - moveCount}</span>, startIndex=<span class="hljs-variable">$targetIndex</span>, endIndex=<span class="hljs-subst">${targetIndex + moveCount}</span>)"</span>)
            println(<span class="hljs-string">"â”‚   â”‚   å³: æŠŠ buffer[<span class="hljs-variable">$targetIndex</span>..<span class="hljs-subst">${targetIndex + moveCount - <span class="hljs-number">1</span>}</span>] å¤åˆ¶åˆ° buffer[<span class="hljs-subst">${gapEnd - moveCount}</span>..<span class="hljs-subst">${gapEnd - <span class="hljs-number">1</span>}</span>]"</span>)
            println(<span class="hljs-string">"â”‚   â”‚"</span>)
            println(<span class="hljs-string">"â”‚   â”‚ ç§»åŠ¨å‰: <span class="hljs-subst">${bufferToString()}</span>"</span>)
            
            buffer.copyInto(buffer, gapEnd - moveCount, targetIndex, targetIndex + moveCount)
            
            println(<span class="hljs-string">"â”‚   â”‚ å¤åˆ¶å: <span class="hljs-subst">${bufferToString()}</span>"</span>)
            
            <span class="hljs-comment">// æ¸…é™¤åŸä½ç½®</span>
            println(<span class="hljs-string">"â”‚   â”‚"</span>)
            println(<span class="hljs-string">"â”‚   â”‚ æ¸…é™¤åŸä½ç½® buffer[<span class="hljs-variable">$targetIndex</span>..<span class="hljs-subst">${targetIndex + moveCount - <span class="hljs-number">1</span>}</span>]"</span>)
            <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> targetIndex until targetIndex + moveCount) {
                buffer[i] = <span class="hljs-literal">null</span>
            }
            println(<span class="hljs-string">"â”‚   â”‚ æ¸…é™¤å: <span class="hljs-subst">${bufferToString()}</span>"</span>)
            
            <span class="hljs-comment">// æ›´æ–°é—´éš™ä½ç½®</span>
            println(<span class="hljs-string">"â”‚   â”‚"</span>)
            println(<span class="hljs-string">"â”‚   â”‚ æ›´æ–°é—´éš™ä½ç½®:"</span>)
            println(<span class="hljs-string">"â”‚   â”‚   gapStart: <span class="hljs-variable">$gapStart</span> â†’ <span class="hljs-subst">${gapStart - moveCount}</span>"</span>)
            println(<span class="hljs-string">"â”‚   â”‚   gapEnd: <span class="hljs-variable">$gapEnd</span> â†’ <span class="hljs-subst">${gapEnd - moveCount}</span>"</span>)
            gapStart -= moveCount
            gapEnd -= moveCount
        }
        
        println(<span class="hljs-string">"â”‚   â”‚"</span>)
        println(<span class="hljs-string">"â”‚   â”‚ ç§»åŠ¨å®Œæˆ: gapStart=<span class="hljs-variable">$gapStart</span>, gapEnd=<span class="hljs-variable">$gapEnd</span>"</span>)
        println(<span class="hljs-string">"â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"</span>)
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">grow</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">val</span> oldCapacity = buffer.size
        <span class="hljs-keyword">val</span> newCapacity = oldCapacity * <span class="hljs-number">2</span>
        <span class="hljs-keyword">val</span> newBuffer = arrayOfNulls&lt;Any?&gt;(newCapacity)
        buffer.copyInto(newBuffer, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, gapStart)
        <span class="hljs-keyword">val</span> afterGapCount = oldCapacity - gapEnd
        <span class="hljs-keyword">val</span> newGapEnd = newCapacity - afterGapCount
        buffer.copyInto(newBuffer, newGapEnd, gapEnd, oldCapacity)
        buffer = newBuffer
        gapEnd = newGapEnd
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">toPhysicalIndex</span><span class="hljs-params">(logicalIndex: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> (logicalIndex &lt; gapStart) logicalIndex <span class="hljs-keyword">else</span> logicalIndex + gapSize
    }

    <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">get</span><span class="hljs-params">(index: <span class="hljs-type">Int</span>)</span></span>: T {
        require(index <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> until size)
        <span class="hljs-meta">@Suppress(<span class="hljs-string">"UNCHECKED_CAST"</span>)</span>
        <span class="hljs-keyword">return</span> buffer[toPhysicalIndex(index)] <span class="hljs-keyword">as</span> T
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">toList</span><span class="hljs-params">()</span></span>: List&lt;T&gt; {
        <span class="hljs-keyword">val</span> result = mutableListOf&lt;T&gt;()
        <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span> until size) result.add(<span class="hljs-keyword">get</span>(i))
        <span class="hljs-keyword">return</span> result
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">bufferToString</span><span class="hljs-params">()</span></span>: String {
        <span class="hljs-keyword">val</span> sb = StringBuilder(<span class="hljs-string">"["</span>)
        <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> buffer.indices) {
            <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span>) sb.append(<span class="hljs-string">"]["</span>)
            <span class="hljs-keyword">if</span> (i <span class="hljs-keyword">in</span> gapStart until gapEnd) {
                sb.append(<span class="hljs-string">"_"</span>)
            } <span class="hljs-keyword">else</span> {
                sb.append(buffer[i] ?: <span class="hljs-string">"null"</span>)
            }
        }
        sb.append(<span class="hljs-string">"]"</span>)
        <span class="hljs-keyword">return</span> sb.toString()
    }
}

<span class="hljs-comment">/**
 * æ¼”ç¤ºï¼šæ„å»º [1,2,4,5,6]ï¼Œç„¶ååœ¨ 2 åé¢æ’å…¥ 3
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    println(<span class="hljs-string">"â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"</span>)
    println(<span class="hljs-string">"â•‘  Gap Buffer æ‰§è¡Œæµç¨‹æ¼”ç¤º                                        â•‘"</span>)
    println(<span class="hljs-string">"â•‘  ç›®æ ‡: æ„å»º [1,2,4,5,6]ï¼Œç„¶ååœ¨ 2 åé¢æ’å…¥ 3                      â•‘"</span>)
    println(<span class="hljs-string">"â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"</span>)
    println()

    <span class="hljs-keyword">val</span> buffer = GapBufferDebug&lt;<span class="hljs-built_in">Int</span>&gt;(<span class="hljs-number">8</span>)

    println(<span class="hljs-string">"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"</span>)
    println(<span class="hljs-string">"é˜¶æ®µ1: æ„å»ºåˆå§‹æ•°ç»„ [1, 2, 4, 5, 6]"</span>)
    println(<span class="hljs-string">"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"</span>)
    println()

    buffer.insert(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)
    buffer.insert(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)
    buffer.insert(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>)
    buffer.insert(<span class="hljs-number">3</span>, <span class="hljs-number">5</span>)
    buffer.insert(<span class="hljs-number">4</span>, <span class="hljs-number">6</span>)

    println()
    println(<span class="hljs-string">"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"</span>)
    println(<span class="hljs-string">"é˜¶æ®µ2: åœ¨ 2 çš„åé¢æ’å…¥ 3 (å³åœ¨é€»è¾‘ç´¢å¼• 2 å¤„æ’å…¥)"</span>)
    println(<span class="hljs-string">"       å½“å‰: [1, 2, 4, 5, 6]"</span>)
    println(<span class="hljs-string">"       ç›®æ ‡: [1, 2, 3, 4, 5, 6]"</span>)
    println(<span class="hljs-string">"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"</span>)
    println()

    buffer.insert(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)

    println()
    println(<span class="hljs-string">"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"</span>)
    println(<span class="hljs-string">"æœ€ç»ˆç»“æœ: <span class="hljs-subst">${buffer.toList()}</span>"</span>)
    println(<span class="hljs-string">"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"</span>)
}
</code></pre>
<h2 data-id="heading-0">Gap Buffer æ‰§è¡Œæµç¨‹è¿½è¸ª</h2>
<h3 data-id="heading-1">åœºæ™¯ï¼šæ„å»º [1,2,4,5,6]ï¼Œç„¶ååœ¨ 2 åé¢æ’å…¥ 3</h3>
<h3 data-id="heading-2">é˜¶æ®µ1: æ„å»ºåˆå§‹æ•°ç»„ [1, 2, 4, 5, 6]</h3>
<h4 data-id="heading-3">æ’å…¥ 1 åˆ°ä½ç½® 0</h4>
<pre><code class="hljs language-ini" lang="ini">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ è°ƒç”¨ insert(<span class="hljs-attr">index</span>=<span class="hljs-number">0</span>, element=<span class="hljs-number">1</span>)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ ã€è¿›å…¥ insert æ–¹æ³•ã€‘
â”‚   å½“å‰çŠ¶æ€:
â”‚     <span class="hljs-attr">size</span> = <span class="hljs-number">0</span>
â”‚     <span class="hljs-attr">gapStart</span> = <span class="hljs-number">0</span>
â”‚     <span class="hljs-attr">gapEnd</span> = <span class="hljs-number">8</span>
â”‚     <span class="hljs-attr">gapSize</span> = <span class="hljs-number">8</span>
â”‚     <span class="hljs-attr">buffer</span> = [_][_][_][_][_][_][_][_]
â”‚
â”‚ ã€æ­¥éª¤1ã€‘æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹
â”‚   gapSize (8) == 0 ? false
â”‚   â†’ ä¸éœ€è¦æ‰©å®¹
â”‚
â”‚ ã€æ­¥éª¤2ã€‘ç§»åŠ¨é—´éš™åˆ°ç›®æ ‡ä½ç½® (<span class="hljs-attr">targetIndex</span>=<span class="hljs-number">0</span>)
â”‚   â”Œâ”€ moveGap(<span class="hljs-attr">targetIndex</span>=<span class="hljs-number">0</span>) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚   â”‚ å½“å‰ <span class="hljs-attr">gapStart</span>=<span class="hljs-number">0</span>, gapEnd=<span class="hljs-number">8</span>
â”‚   â”‚ ç›®æ ‡ä½ç½® <span class="hljs-attr">targetIndex</span>=<span class="hljs-number">0</span>
â”‚   â”‚ <span class="hljs-attr">targetIndex</span> == gapStartï¼Œé—´éš™å·²åœ¨ç›®æ ‡ä½ç½®ï¼Œæ— éœ€ç§»åŠ¨
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚
â”‚ ã€æ­¥éª¤3ã€‘åœ¨é—´éš™ä½ç½®æ’å…¥å…ƒç´ 
â”‚   buffer<span class="hljs-section">[0]</span> = 1
â”‚   æ’å…¥å <span class="hljs-attr">buffer</span> = [<span class="hljs-number">1</span>][_][_][_][_][_][_][_]
â”‚
â”‚ ã€æ­¥éª¤4ã€‘ç¼©å°é—´éš™ (gapStart++)
â”‚   gapStart: 0 â†’ 1
â”‚
â”‚ ã€æ’å…¥å®Œæˆã€‘
â”‚   æœ€ç»ˆçŠ¶æ€:
â”‚     <span class="hljs-attr">size</span> = <span class="hljs-number">1</span>
â”‚     <span class="hljs-attr">gapStart</span> = <span class="hljs-number">1</span>
â”‚     <span class="hljs-attr">gapEnd</span> = <span class="hljs-number">8</span>
â”‚     <span class="hljs-attr">gapSize</span> = <span class="hljs-number">7</span>
â”‚     <span class="hljs-attr">buffer</span> = [<span class="hljs-number">1</span>][_][_][_][_][_][_][_]
â”‚     é€»è¾‘å†…å®¹ = <span class="hljs-section">[1]</span>
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</code></pre>
<h4 data-id="heading-4">æ’å…¥ 2 åˆ°ä½ç½® 1</h4>
<pre><code class="hljs language-ini" lang="ini">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ è°ƒç”¨ insert(<span class="hljs-attr">index</span>=<span class="hljs-number">1</span>, element=<span class="hljs-number">2</span>)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ ã€è¿›å…¥ insert æ–¹æ³•ã€‘
â”‚   å½“å‰çŠ¶æ€:
â”‚     <span class="hljs-attr">size</span> = <span class="hljs-number">1</span>
â”‚     <span class="hljs-attr">gapStart</span> = <span class="hljs-number">1</span>
â”‚     <span class="hljs-attr">gapEnd</span> = <span class="hljs-number">8</span>
â”‚     <span class="hljs-attr">gapSize</span> = <span class="hljs-number">7</span>
â”‚     <span class="hljs-attr">buffer</span> = [<span class="hljs-number">1</span>][_][_][_][_][_][_][_]
â”‚
â”‚ ã€æ­¥éª¤1ã€‘æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹
â”‚   gapSize (7) == 0 ? false
â”‚   â†’ ä¸éœ€è¦æ‰©å®¹
â”‚
â”‚ ã€æ­¥éª¤2ã€‘ç§»åŠ¨é—´éš™åˆ°ç›®æ ‡ä½ç½® (<span class="hljs-attr">targetIndex</span>=<span class="hljs-number">1</span>)
â”‚   â”Œâ”€ moveGap(<span class="hljs-attr">targetIndex</span>=<span class="hljs-number">1</span>) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚   â”‚ å½“å‰ <span class="hljs-attr">gapStart</span>=<span class="hljs-number">1</span>, gapEnd=<span class="hljs-number">8</span>
â”‚   â”‚ ç›®æ ‡ä½ç½® <span class="hljs-attr">targetIndex</span>=<span class="hljs-number">1</span>
â”‚   â”‚ <span class="hljs-attr">targetIndex</span> == gapStartï¼Œé—´éš™å·²åœ¨ç›®æ ‡ä½ç½®ï¼Œæ— éœ€ç§»åŠ¨
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚
â”‚ ã€æ­¥éª¤3ã€‘åœ¨é—´éš™ä½ç½®æ’å…¥å…ƒç´ 
â”‚   buffer<span class="hljs-section">[1]</span> = 2
â”‚   æ’å…¥å <span class="hljs-attr">buffer</span> = [<span class="hljs-number">1</span>][<span class="hljs-number">2</span>][_][_][_][_][_][_]
â”‚
â”‚ ã€æ­¥éª¤4ã€‘ç¼©å°é—´éš™ (gapStart++)
â”‚   gapStart: 1 â†’ 2
â”‚
â”‚ ã€æ’å…¥å®Œæˆã€‘
â”‚   æœ€ç»ˆçŠ¶æ€:
â”‚     <span class="hljs-attr">size</span> = <span class="hljs-number">2</span>
â”‚     <span class="hljs-attr">gapStart</span> = <span class="hljs-number">2</span>
â”‚     <span class="hljs-attr">gapEnd</span> = <span class="hljs-number">8</span>
â”‚     <span class="hljs-attr">gapSize</span> = <span class="hljs-number">6</span>
â”‚     <span class="hljs-attr">buffer</span> = [<span class="hljs-number">1</span>][<span class="hljs-number">2</span>][_][_][_][_][_][_]
â”‚     é€»è¾‘å†…å®¹ = <span class="hljs-section">[1, 2]</span>
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</code></pre>
<h4 data-id="heading-5">æ’å…¥ 4 åˆ°ä½ç½® 2</h4>
<pre><code class="hljs language-ini" lang="ini">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ è°ƒç”¨ insert(<span class="hljs-attr">index</span>=<span class="hljs-number">2</span>, element=<span class="hljs-number">4</span>)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ ã€è¿›å…¥ insert æ–¹æ³•ã€‘
â”‚   å½“å‰çŠ¶æ€:
â”‚     <span class="hljs-attr">size</span> = <span class="hljs-number">2</span>
â”‚     <span class="hljs-attr">gapStart</span> = <span class="hljs-number">2</span>
â”‚     <span class="hljs-attr">gapEnd</span> = <span class="hljs-number">8</span>
â”‚     <span class="hljs-attr">gapSize</span> = <span class="hljs-number">6</span>
â”‚     <span class="hljs-attr">buffer</span> = [<span class="hljs-number">1</span>][<span class="hljs-number">2</span>][_][_][_][_][_][_]
â”‚
â”‚ ã€æ­¥éª¤1ã€‘æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹
â”‚   gapSize (6) == 0 ? false
â”‚   â†’ ä¸éœ€è¦æ‰©å®¹
â”‚
â”‚ ã€æ­¥éª¤2ã€‘ç§»åŠ¨é—´éš™åˆ°ç›®æ ‡ä½ç½® (<span class="hljs-attr">targetIndex</span>=<span class="hljs-number">2</span>)
â”‚   â”Œâ”€ moveGap(<span class="hljs-attr">targetIndex</span>=<span class="hljs-number">2</span>) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚   â”‚ å½“å‰ <span class="hljs-attr">gapStart</span>=<span class="hljs-number">2</span>, gapEnd=<span class="hljs-number">8</span>
â”‚   â”‚ ç›®æ ‡ä½ç½® <span class="hljs-attr">targetIndex</span>=<span class="hljs-number">2</span>
â”‚   â”‚ <span class="hljs-attr">targetIndex</span> == gapStartï¼Œé—´éš™å·²åœ¨ç›®æ ‡ä½ç½®ï¼Œæ— éœ€ç§»åŠ¨
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚
â”‚ ã€æ­¥éª¤3ã€‘åœ¨é—´éš™ä½ç½®æ’å…¥å…ƒç´ 
â”‚   buffer<span class="hljs-section">[2]</span> = 4
â”‚   æ’å…¥å <span class="hljs-attr">buffer</span> = [<span class="hljs-number">1</span>][<span class="hljs-number">2</span>][<span class="hljs-number">4</span>][_][_][_][_][_]
â”‚
â”‚ ã€æ­¥éª¤4ã€‘ç¼©å°é—´éš™ (gapStart++)
â”‚   gapStart: 2 â†’ 3
â”‚
â”‚ ã€æ’å…¥å®Œæˆã€‘
â”‚   æœ€ç»ˆçŠ¶æ€:
â”‚     <span class="hljs-attr">size</span> = <span class="hljs-number">3</span>
â”‚     <span class="hljs-attr">gapStart</span> = <span class="hljs-number">3</span>
â”‚     <span class="hljs-attr">gapEnd</span> = <span class="hljs-number">8</span>
â”‚     <span class="hljs-attr">gapSize</span> = <span class="hljs-number">5</span>
â”‚     <span class="hljs-attr">buffer</span> = [<span class="hljs-number">1</span>][<span class="hljs-number">2</span>][<span class="hljs-number">4</span>][_][_][_][_][_]
â”‚     é€»è¾‘å†…å®¹ = <span class="hljs-section">[1, 2, 4]</span>
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</code></pre>
<h4 data-id="heading-6">æ’å…¥ 5 åˆ°ä½ç½® 3</h4>
<pre><code class="hljs language-ini" lang="ini">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ è°ƒç”¨ insert(<span class="hljs-attr">index</span>=<span class="hljs-number">3</span>, element=<span class="hljs-number">5</span>)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ ã€è¿›å…¥ insert æ–¹æ³•ã€‘
â”‚   å½“å‰çŠ¶æ€:
â”‚     <span class="hljs-attr">size</span> = <span class="hljs-number">3</span>
â”‚     <span class="hljs-attr">gapStart</span> = <span class="hljs-number">3</span>
â”‚     <span class="hljs-attr">gapEnd</span> = <span class="hljs-number">8</span>
â”‚     <span class="hljs-attr">gapSize</span> = <span class="hljs-number">5</span>
â”‚     <span class="hljs-attr">buffer</span> = [<span class="hljs-number">1</span>][<span class="hljs-number">2</span>][<span class="hljs-number">4</span>][_][_][_][_][_]
â”‚
â”‚ ã€æ­¥éª¤1ã€‘æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹
â”‚   gapSize (5) == 0 ? false
â”‚   â†’ ä¸éœ€è¦æ‰©å®¹
â”‚
â”‚ ã€æ­¥éª¤2ã€‘ç§»åŠ¨é—´éš™åˆ°ç›®æ ‡ä½ç½® (<span class="hljs-attr">targetIndex</span>=<span class="hljs-number">3</span>)
â”‚   â”Œâ”€ moveGap(<span class="hljs-attr">targetIndex</span>=<span class="hljs-number">3</span>) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚   â”‚ å½“å‰ <span class="hljs-attr">gapStart</span>=<span class="hljs-number">3</span>, gapEnd=<span class="hljs-number">8</span>
â”‚   â”‚ ç›®æ ‡ä½ç½® <span class="hljs-attr">targetIndex</span>=<span class="hljs-number">3</span>
â”‚   â”‚ <span class="hljs-attr">targetIndex</span> == gapStartï¼Œé—´éš™å·²åœ¨ç›®æ ‡ä½ç½®ï¼Œæ— éœ€ç§»åŠ¨
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚
â”‚ ã€æ­¥éª¤3ã€‘åœ¨é—´éš™ä½ç½®æ’å…¥å…ƒç´ 
â”‚   buffer<span class="hljs-section">[3]</span> = 5
â”‚   æ’å…¥å <span class="hljs-attr">buffer</span> = [<span class="hljs-number">1</span>][<span class="hljs-number">2</span>][<span class="hljs-number">4</span>][<span class="hljs-number">5</span>][_][_][_][_]
â”‚
â”‚ ã€æ­¥éª¤4ã€‘ç¼©å°é—´éš™ (gapStart++)
â”‚   gapStart: 3 â†’ 4
â”‚
â”‚ ã€æ’å…¥å®Œæˆã€‘
â”‚   æœ€ç»ˆçŠ¶æ€:
â”‚     <span class="hljs-attr">size</span> = <span class="hljs-number">4</span>
â”‚     <span class="hljs-attr">gapStart</span> = <span class="hljs-number">4</span>
â”‚     <span class="hljs-attr">gapEnd</span> = <span class="hljs-number">8</span>
â”‚     <span class="hljs-attr">gapSize</span> = <span class="hljs-number">4</span>
â”‚     <span class="hljs-attr">buffer</span> = [<span class="hljs-number">1</span>][<span class="hljs-number">2</span>][<span class="hljs-number">4</span>][<span class="hljs-number">5</span>][_][_][_][_]
â”‚     é€»è¾‘å†…å®¹ = <span class="hljs-section">[1, 2, 4, 5]</span>
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</code></pre>
<h4 data-id="heading-7">æ’å…¥ 6 åˆ°ä½ç½® 4</h4>
<pre><code class="hljs language-ini" lang="ini">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ è°ƒç”¨ insert(<span class="hljs-attr">index</span>=<span class="hljs-number">4</span>, element=<span class="hljs-number">6</span>)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ ã€è¿›å…¥ insert æ–¹æ³•ã€‘
â”‚   å½“å‰çŠ¶æ€:
â”‚     <span class="hljs-attr">size</span> = <span class="hljs-number">4</span>
â”‚     <span class="hljs-attr">gapStart</span> = <span class="hljs-number">4</span>
â”‚     <span class="hljs-attr">gapEnd</span> = <span class="hljs-number">8</span>
â”‚     <span class="hljs-attr">gapSize</span> = <span class="hljs-number">4</span>
â”‚     <span class="hljs-attr">buffer</span> = [<span class="hljs-number">1</span>][<span class="hljs-number">2</span>][<span class="hljs-number">4</span>][<span class="hljs-number">5</span>][_][_][_][_]
â”‚
â”‚ ã€æ­¥éª¤1ã€‘æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹
â”‚   gapSize (4) == 0 ? false
â”‚   â†’ ä¸éœ€è¦æ‰©å®¹
â”‚
â”‚ ã€æ­¥éª¤2ã€‘ç§»åŠ¨é—´éš™åˆ°ç›®æ ‡ä½ç½® (<span class="hljs-attr">targetIndex</span>=<span class="hljs-number">4</span>)
â”‚   â”Œâ”€ moveGap(<span class="hljs-attr">targetIndex</span>=<span class="hljs-number">4</span>) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚   â”‚ å½“å‰ <span class="hljs-attr">gapStart</span>=<span class="hljs-number">4</span>, gapEnd=<span class="hljs-number">8</span>
â”‚   â”‚ ç›®æ ‡ä½ç½® <span class="hljs-attr">targetIndex</span>=<span class="hljs-number">4</span>
â”‚   â”‚ <span class="hljs-attr">targetIndex</span> == gapStartï¼Œé—´éš™å·²åœ¨ç›®æ ‡ä½ç½®ï¼Œæ— éœ€ç§»åŠ¨
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚
â”‚ ã€æ­¥éª¤3ã€‘åœ¨é—´éš™ä½ç½®æ’å…¥å…ƒç´ 
â”‚   buffer<span class="hljs-section">[4]</span> = 6
â”‚   æ’å…¥å <span class="hljs-attr">buffer</span> = [<span class="hljs-number">1</span>][<span class="hljs-number">2</span>][<span class="hljs-number">4</span>][<span class="hljs-number">5</span>][<span class="hljs-number">6</span>][_][_][_]
â”‚
â”‚ ã€æ­¥éª¤4ã€‘ç¼©å°é—´éš™ (gapStart++)
â”‚   gapStart: 4 â†’ 5
â”‚
â”‚ ã€æ’å…¥å®Œæˆã€‘
â”‚   æœ€ç»ˆçŠ¶æ€:
â”‚     <span class="hljs-attr">size</span> = <span class="hljs-number">5</span>
â”‚     <span class="hljs-attr">gapStart</span> = <span class="hljs-number">5</span>
â”‚     <span class="hljs-attr">gapEnd</span> = <span class="hljs-number">8</span>
â”‚     <span class="hljs-attr">gapSize</span> = <span class="hljs-number">3</span>
â”‚     <span class="hljs-attr">buffer</span> = [<span class="hljs-number">1</span>][<span class="hljs-number">2</span>][<span class="hljs-number">4</span>][<span class="hljs-number">5</span>][<span class="hljs-number">6</span>][_][_][_]
â”‚     é€»è¾‘å†…å®¹ = <span class="hljs-section">[1, 2, 4, 5, 6]</span>
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</code></pre>
<hr/>
<h3 data-id="heading-8">é˜¶æ®µ1å®Œæˆåçš„çŠ¶æ€</h3>
<pre><code class="hljs language-ini" lang="ini">ç‰©ç†æ•°ç»„:  <span class="hljs-section">[1]</span><span class="hljs-section">[2]</span><span class="hljs-section">[4]</span><span class="hljs-section">[5]</span><span class="hljs-section">[6]</span><span class="hljs-section">[_]</span><span class="hljs-section">[_]</span><span class="hljs-section">[_]</span>
           0  1  2  3  4  5  6  7
                          â†‘     â†‘
                       gapStart gapEnd
                         (5)    (8)

é€»è¾‘å†…å®¹:  <span class="hljs-section">[1, 2, 4, 5, 6]</span>
           0  1  2  3  4
</code></pre>
<hr/>
<h3 data-id="heading-9">é˜¶æ®µ2: åœ¨ 2 çš„åé¢æ’å…¥ 3</h3>
<p><strong>ç›®æ ‡</strong>: åœ¨é€»è¾‘ç´¢å¼• 2 å¤„æ’å…¥ 3ï¼ˆå³åœ¨ 2 å’Œ 4 ä¹‹é—´ï¼‰</p>
<p><strong>å½“å‰</strong>: <code>[1, 2, 4, 5, 6]</code>
<strong>ç›®æ ‡</strong>: <code>[1, 2, 3, 4, 5, 6]</code></p>
<pre><code class="hljs language-ini" lang="ini">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ è°ƒç”¨ insert(<span class="hljs-attr">index</span>=<span class="hljs-number">2</span>, element=<span class="hljs-number">3</span>)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚ ã€è¿›å…¥ insert æ–¹æ³•ã€‘
â”‚   å½“å‰çŠ¶æ€:
â”‚     <span class="hljs-attr">size</span> = <span class="hljs-number">5</span>
â”‚     <span class="hljs-attr">gapStart</span> = <span class="hljs-number">5</span>
â”‚     <span class="hljs-attr">gapEnd</span> = <span class="hljs-number">8</span>
â”‚     <span class="hljs-attr">gapSize</span> = <span class="hljs-number">3</span>
â”‚     <span class="hljs-attr">buffer</span> = [<span class="hljs-number">1</span>][<span class="hljs-number">2</span>][<span class="hljs-number">4</span>][<span class="hljs-number">5</span>][<span class="hljs-number">6</span>][_][_][_]
â”‚
â”‚ ã€æ­¥éª¤1ã€‘æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹
â”‚   gapSize (3) == 0 ? false
â”‚   â†’ ä¸éœ€è¦æ‰©å®¹
â”‚
â”‚ ã€æ­¥éª¤2ã€‘ç§»åŠ¨é—´éš™åˆ°ç›®æ ‡ä½ç½® (<span class="hljs-attr">targetIndex</span>=<span class="hljs-number">2</span>)
â”‚   â”Œâ”€ moveGap(<span class="hljs-attr">targetIndex</span>=<span class="hljs-number">2</span>) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚   â”‚ å½“å‰ <span class="hljs-attr">gapStart</span>=<span class="hljs-number">5</span>, gapEnd=<span class="hljs-number">8</span>
â”‚   â”‚ ç›®æ ‡ä½ç½® <span class="hljs-attr">targetIndex</span>=<span class="hljs-number">2</span>
â”‚   â”‚ 
â”‚   â”‚ targetIndex (2) &lt; gapStart (5)
â”‚   â”‚ â†’ é—´éš™éœ€è¦ã€å‘å·¦ç§»åŠ¨ã€‘
â”‚   â”‚
â”‚   â”‚ è®¡ç®—: <span class="hljs-attr">moveCount</span> = gapStart - targetIndex = <span class="hljs-number">5</span> - <span class="hljs-number">2</span> = <span class="hljs-number">3</span>
â”‚   â”‚
â”‚   â”‚ æ“ä½œ: æŠŠé—´éš™å·¦è¾¹çš„ 3 ä¸ªå…ƒç´ ç§»åˆ°é—´éš™å³è¾¹
â”‚   â”‚   copyInto(buffer, <span class="hljs-attr">destOffset</span>=<span class="hljs-number">5</span>, startIndex=<span class="hljs-number">2</span>, endIndex=<span class="hljs-number">5</span>)
â”‚   â”‚   å³: æŠŠ buffer<span class="hljs-section">[2..4]</span> å¤åˆ¶åˆ° buffer<span class="hljs-section">[5..7]</span>
â”‚   â”‚        æŠŠ <span class="hljs-section">[4]</span><span class="hljs-section">[5]</span><span class="hljs-section">[6]</span> ç§»åˆ°åé¢
â”‚   â”‚
â”‚   â”‚ ç§»åŠ¨å‰: <span class="hljs-section">[1]</span><span class="hljs-section">[2]</span><span class="hljs-section">[4]</span><span class="hljs-section">[5]</span><span class="hljs-section">[6]</span><span class="hljs-section">[_]</span><span class="hljs-section">[_]</span><span class="hljs-section">[_]</span>
â”‚   â”‚                â†‘        â†‘
â”‚   â”‚             ç§»åŠ¨è¿™3ä¸ªå…ƒç´ 
â”‚   â”‚
â”‚   â”‚ å¤åˆ¶å: <span class="hljs-section">[1]</span><span class="hljs-section">[2]</span><span class="hljs-section">[4]</span><span class="hljs-section">[5]</span><span class="hljs-section">[6]</span><span class="hljs-section">[4]</span><span class="hljs-section">[5]</span><span class="hljs-section">[6]</span>
â”‚   â”‚              (åŸä½ç½®)   (æ–°ä½ç½®)
â”‚   â”‚
â”‚   â”‚ æ¸…é™¤åŸä½ç½® buffer<span class="hljs-section">[2..4]</span>
â”‚   â”‚ æ¸…é™¤å: <span class="hljs-section">[1]</span><span class="hljs-section">[2]</span><span class="hljs-section">[_]</span><span class="hljs-section">[_]</span><span class="hljs-section">[_]</span><span class="hljs-section">[4]</span><span class="hljs-section">[5]</span><span class="hljs-section">[6]</span>
â”‚   â”‚
â”‚   â”‚ æ›´æ–°é—´éš™ä½ç½®:
â”‚   â”‚   gapStart: 5 â†’ 2  (5 - <span class="hljs-attr">3</span> = <span class="hljs-number">2</span>)
â”‚   â”‚   gapEnd: 8 â†’ 5    (8 - <span class="hljs-attr">3</span> = <span class="hljs-number">5</span>)
â”‚   â”‚
â”‚   â”‚ ç§»åŠ¨å®Œæˆ: <span class="hljs-attr">gapStart</span>=<span class="hljs-number">2</span>, gapEnd=<span class="hljs-number">5</span>
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚
â”‚ ã€æ­¥éª¤3ã€‘åœ¨é—´éš™ä½ç½®æ’å…¥å…ƒç´ 
â”‚   buffer<span class="hljs-section">[2]</span> = 3
â”‚   æ’å…¥å <span class="hljs-attr">buffer</span> = [<span class="hljs-number">1</span>][<span class="hljs-number">2</span>][<span class="hljs-number">3</span>][_][_][<span class="hljs-number">4</span>][<span class="hljs-number">5</span>][<span class="hljs-number">6</span>]
â”‚
â”‚ ã€æ­¥éª¤4ã€‘ç¼©å°é—´éš™ (gapStart++)
â”‚   gapStart: 2 â†’ 3
â”‚
â”‚ ã€æ’å…¥å®Œæˆã€‘
â”‚   æœ€ç»ˆçŠ¶æ€:
â”‚     <span class="hljs-attr">size</span> = <span class="hljs-number">6</span>
â”‚     <span class="hljs-attr">gapStart</span> = <span class="hljs-number">3</span>
â”‚     <span class="hljs-attr">gapEnd</span> = <span class="hljs-number">5</span>
â”‚     <span class="hljs-attr">gapSize</span> = <span class="hljs-number">2</span>
â”‚     <span class="hljs-attr">buffer</span> = [<span class="hljs-number">1</span>][<span class="hljs-number">2</span>][<span class="hljs-number">3</span>][_][_][<span class="hljs-number">4</span>][<span class="hljs-number">5</span>][<span class="hljs-number">6</span>]
â”‚     é€»è¾‘å†…å®¹ = <span class="hljs-section">[1, 2, 3, 4, 5, 6]</span>
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</code></pre>
<hr/>
<h3 data-id="heading-10">å…³é”®æ­¥éª¤å›¾è§£</h3>
<h4 data-id="heading-11">æ’å…¥ 3 åˆ°ä½ç½® 2 çš„é—´éš™ç§»åŠ¨è¿‡ç¨‹</h4>
<pre><code class="hljs language-ini" lang="ini">åˆå§‹çŠ¶æ€ (<span class="hljs-attr">gapStart</span>=<span class="hljs-number">5</span>, gapEnd=<span class="hljs-number">8</span>):
â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
â”‚ 1 â”‚ 2 â”‚ 4 â”‚ 5 â”‚ 6 â”‚ _ â”‚ _ â”‚ _ â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
  0   1   2   3   4   5   6   7
                      â†‘       â†‘
                   gapStart  gapEnd

é€»è¾‘è§†å›¾: <span class="hljs-section">[1, 2, 4, 5, 6]</span>
                â†‘
          è¦åœ¨è¿™é‡Œæ’å…¥ 3

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

æ­¥éª¤1: å¤åˆ¶ buffer<span class="hljs-section">[2..4]</span> åˆ° buffer<span class="hljs-section">[5..7]</span>
â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
â”‚ 1 â”‚ 2 â”‚ 4 â”‚ 5 â”‚ 6 â”‚ 4 â”‚ 5 â”‚ 6 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
  0   1   2   3   4   5   6   7
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            å¤åˆ¶åˆ°è¿™é‡Œ â†—

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

æ­¥éª¤2: æ¸…é™¤åŸä½ç½® buffer<span class="hljs-section">[2..4]</span>
â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
â”‚ 1 â”‚ 2 â”‚ _ â”‚ _ â”‚ _ â”‚ 4 â”‚ 5 â”‚ 6 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
  0   1   2   3   4   5   6   7
          â†‘           â†‘
       gapStart    gapEnd
         (2)        (5)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

æ­¥éª¤3: åœ¨ gapStart ä½ç½®æ’å…¥ 3
â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
â”‚ 1 â”‚ 2 â”‚ 3 â”‚ _ â”‚ _ â”‚ 4 â”‚ 5 â”‚ 6 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
  0   1   2   3   4   5   6   7
          â†‘
       æ’å…¥ 3

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

æ­¥éª¤4: gapStart++
â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
â”‚ 1 â”‚ 2 â”‚ 3 â”‚ _ â”‚ _ â”‚ 4 â”‚ 5 â”‚ 6 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
  0   1   2   3   4   5   6   7
              â†‘       â†‘
           gapStart gapEnd
             (3)     (5)

é€»è¾‘è§†å›¾: <span class="hljs-section">[1, 2, 3, 4, 5, 6]</span>  âœ“
</code></pre>
<hr/>
<h3 data-id="heading-12">å˜é‡è¿½è¸ªè¡¨</h3>


























































































































<table><thead><tr><th>æ“ä½œ</th><th>buffer ç‰©ç†çŠ¶æ€</th><th>gapStart</th><th>gapEnd</th><th>gapSize</th><th>size</th><th>é€»è¾‘å†…å®¹</th></tr></thead><tbody><tr><td>åˆå§‹</td><td><code>[_][_][_][_][_][_][_][_]</code></td><td>0</td><td>8</td><td>8</td><td>0</td><td><code>[]</code></td></tr><tr><td>insert(0,1)</td><td><code>[1][_][_][_][_][_][_][_]</code></td><td>1</td><td>8</td><td>7</td><td>1</td><td><code>[1]</code></td></tr><tr><td>insert(1,2)</td><td><code>[1][2][_][_][_][_][_][_]</code></td><td>2</td><td>8</td><td>6</td><td>2</td><td><code>[1,2]</code></td></tr><tr><td>insert(2,4)</td><td><code>[1][2][4][_][_][_][_][_]</code></td><td>3</td><td>8</td><td>5</td><td>3</td><td><code>[1,2,4]</code></td></tr><tr><td>insert(3,6)</td><td><code>[1][2][4][5][_][_][_][_]</code></td><td>4</td><td>8</td><td>4</td><td>4</td><td><code>[1,2,4,5]</code></td></tr><tr><td>insert(4,6)</td><td><code>[1][2][4][5][6][_][_][_]</code></td><td>5</td><td>8</td><td>3</td><td>5</td><td><code>[1,2,4,5,6]</code></td></tr><tr><td><strong>insert(2,3)</strong></td><td/><td/><td/><td/><td/><td/></tr><tr><td>â”” moveGap(2) å‰</td><td><code>[1][2][4][5][6][_][_][_]</code></td><td>5</td><td>8</td><td>3</td><td>5</td><td><code>[1,2,4,5,6]</code></td></tr><tr><td>â”” å¤åˆ¶å</td><td><code>[1][2][4][5][6][4][5][6]</code></td><td>5</td><td>8</td><td>-</td><td>-</td><td>-</td></tr><tr><td>â”” æ¸…é™¤å</td><td><code>[1][2][_][_][_][4][5][6]</code></td><td>2</td><td>5</td><td>3</td><td>5</td><td><code>[1,2,4,5,6]</code></td></tr><tr><td>â”” æ’å…¥ 3</td><td><code>[1][2][3][_][_][4][5][6]</code></td><td>2</td><td>5</td><td>-</td><td>-</td><td>-</td></tr><tr><td>â”” gapStart++</td><td><code>[1][2][3][_][_][4][5][6]</code></td><td><strong>3</strong></td><td><strong>5</strong></td><td><strong>2</strong></td><td><strong>6</strong></td><td><code>[1,2,3,4,5,6]</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-13">æ€»ç»“</h3>
<ol>
<li><strong>é¡ºåºæ’å…¥æ—¶</strong>ï¼ˆå¦‚æ„å»ºåˆå§‹æ•°ç»„ï¼‰ï¼Œé—´éš™å§‹ç»ˆåœ¨æœ«å°¾ï¼Œæ— éœ€ç§»åŠ¨ï¼ŒO(1)</li>
<li><strong>ä¸­é—´æ’å…¥æ—¶</strong>ï¼ˆå¦‚åœ¨ä½ç½® 2 æ’å…¥ 3ï¼‰ï¼Œéœ€è¦ç§»åŠ¨é—´éš™ï¼Œå¤åˆ¶å…ƒç´ ï¼ŒO(n)</li>
<li><strong>é—´éš™çš„ä½œç”¨</strong>ï¼šå°†å¤æ‚çš„æ•°ç»„æ’å…¥æ“ä½œï¼ˆéœ€è¦ç§»åŠ¨åç»­æ‰€æœ‰å…ƒç´ ï¼‰è½¬åŒ–ä¸ºç®€å•çš„é—´éš™ç§»åŠ¨ + O(1) æ’å…¥</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç¨³å®šæ€§æ€§èƒ½ç³»åˆ—ä¹‹å…«â€”â€”ç³»ç»Ÿæ€§èƒ½åˆ†æåŸºç¡€:Systraceä¸Perfettoå…¥é—¨]]></title>    <link>https://juejin.cn/post/7591075684066541583</link>    <guid>https://juejin.cn/post/7591075684066541583</guid>    <pubDate>2026-01-04T14:24:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591075684066541583" data-draft-id="7591130604430082088" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç¨³å®šæ€§æ€§èƒ½ç³»åˆ—ä¹‹å…«â€”â€”ç³»ç»Ÿæ€§èƒ½åˆ†æåŸºç¡€:Systraceä¸Perfettoå…¥é—¨"/> <meta itemprop="keywords" content="Android,Debug,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2026-01-04T14:24:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†¬å¥‡Lab"/> <meta itemprop="url" content="https://juejin.cn/user/1857501105781193"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç¨³å®šæ€§æ€§èƒ½ç³»åˆ—ä¹‹å…«â€”â€”ç³»ç»Ÿæ€§èƒ½åˆ†æåŸºç¡€:Systraceä¸Perfettoå…¥é—¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1857501105781193/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†¬å¥‡Lab
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T14:24:55.000Z" title="Sun Jan 04 2026 14:24:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ€§èƒ½ä¼˜åŒ–çš„ç¬¬ä¸€æ­¥,ä¸æ˜¯çŒœæµ‹é—®é¢˜åœ¨å“ªé‡Œ,è€Œæ˜¯ç”¨æ•°æ®è¯´è¯ã€‚Traceå·¥å…·å°±æ˜¯é‚£ä¸ªè®©æ€§èƒ½ç“¶é¢ˆæ— æ‰€éå½¢çš„"æ˜¾å¾®é•œ"ã€‚</p>
</blockquote>
<h2 data-id="heading-0">å¼•è¨€:ä»3ç§’åˆ°1ç§’çš„ä¼˜åŒ–å†ç¨‹</h2>
<p>é‚£æ˜¯å»å¹´Q2çš„ä¸€ä¸ªå‘¨ä¸€æ—©æ™¨,äº§å“ç»ç†ç¥è‰²å‡é‡åœ°æ‰¾åˆ°æˆ‘:"ç”¨æˆ·åé¦ˆæˆ‘ä»¬çš„Appå¯åŠ¨å¤ªæ…¢äº†,å¹³å‡3ç§’æ‰èƒ½çœ‹åˆ°é¦–é¡µ,ç«å“åªè¦1ç§’ã€‚è€æ¿è¯´å¦‚æœè¿™ä¸ªå­£åº¦ä¼˜åŒ–ä¸åˆ°1.5ç§’ä»¥å†…,é¡¹ç›®å¯èƒ½è¦é»„ã€‚"</p>
<p>æˆ‘æ‰“å¼€Appè¯•äº†è¯•,ç¡®å®æ…¢å¾—è®©äººæŠ“ç‹‚ã€‚ä½†é—®é¢˜åœ¨å“ªé‡Œå‘¢?Applicationåˆå§‹åŒ–?ActivityåŠ è½½?ç½‘ç»œè¯·æ±‚?è¿˜æ˜¯å›¾ç‰‡æ¸²æŸ“?</p>
<p>å‡­æ„Ÿè§‰ä¼˜åŒ–?é‚£åªæ˜¯åœ¨ç›²äººæ‘¸è±¡ã€‚</p>
<p>äºæ˜¯æˆ‘æ‰“å¼€Systrace,æŠ“å–äº†ä¸€ä»½å¯åŠ¨Traceã€‚å½“Chromeæ‰“å¼€é‚£ä¸ªHTMLæ–‡ä»¶çš„ç¬é—´,æ•´ä¸ªå¯åŠ¨æµç¨‹ä¸€è§ˆæ— é—:</p>
<pre><code class="hljs language-scss" lang="scss">Application<span class="hljs-selector-class">.onCreate</span>(): <span class="hljs-number">450ms</span>
  â”œâ”€ SDKåˆå§‹åŒ–: <span class="hljs-number">280ms</span>    â† å…ƒå‡¶!
  â”œâ”€ æ•°æ®åº“è¿ç§»: <span class="hljs-number">120ms</span>
  â””â”€ å…¶ä»–åˆå§‹åŒ–: <span class="hljs-number">50ms</span>

Activity.<span class="hljs-built_in">onCreate</span>(): <span class="hljs-number">380ms</span>
  â”œâ”€ <span class="hljs-built_in">setContentView</span>(): <span class="hljs-number">80ms</span>
  â”œâ”€ ç½‘ç»œè¯·æ±‚: <span class="hljs-number">200ms</span>      â† åœ¨ä¸»çº¿ç¨‹!
  â””â”€ RecyclerViewé¦–å±æ¸²æŸ“: <span class="hljs-number">100ms</span>
</code></pre>
<p><strong>é—®é¢˜ä¸€ç›®äº†ç„¶</strong>:SDKåˆå§‹åŒ–å’Œç½‘ç»œè¯·æ±‚å æ®äº†å¯åŠ¨æ—¶é—´çš„ä¸€åŠã€‚</p>
<p>ç»è¿‡ä¸¤å‘¨çš„ä¼˜åŒ–(SDKå»¶è¿Ÿåˆå§‹åŒ–ã€ç½‘ç»œè¯·æ±‚ç§»åˆ°åå°ã€é¢„åŠ è½½ä¼˜åŒ–),å¯åŠ¨æ—¶é—´é™åˆ°äº†0.9ç§’ã€‚äº§å“ç»ç†å†ä¹Ÿæ²¡æè¿‡å¯åŠ¨æ…¢çš„é—®é¢˜,é¡¹ç›®ä¹Ÿé¡ºåˆ©ä¸Šçº¿äº†ã€‚</p>
<p><strong>è¿™æ¬¡ç»å†è®©æˆ‘æ˜ç™½</strong>:æ€§èƒ½ä¼˜åŒ–ä¸æ˜¯é ç»éªŒå’Œç›´è§‰,è€Œæ˜¯é æ•°æ®ã€‚è€ŒTraceå·¥å…·,å°±æ˜¯è·å–è¿™äº›æ•°æ®çš„æœ€å¼ºæ­¦å™¨ã€‚</p>
<p>æœ¬æ–‡å°†å¸¦ä½ å…¨é¢æŒæ¡Systraceå’ŒPerfettoä¸¤å¤§æ€§èƒ½åˆ†æå·¥å…·ã€‚è¯»å®Œæœ¬æ–‡,ä½ å°†èƒ½å¤Ÿ:</p>
<ol>
<li>ç†è§£Systraceå’ŒPerfettoçš„å·¥ä½œåŸç†å’ŒåŒºåˆ«</li>
<li>æŒæ¡TraceæŠ“å–çš„å®Œæ•´æµç¨‹å’Œå¸¸ç”¨é…ç½®</li>
<li>å­¦ä¼šåˆ†æTraceæ–‡ä»¶,å¿«é€Ÿå®šä½æ€§èƒ½ç“¶é¢ˆ</li>
<li>ä½¿ç”¨ä»£ç æ’æ¡©æŠ€æœ¯ç²¾ç¡®è¿½è¸ªå…³é”®è·¯å¾„</li>
<li>è¿ç”¨SQLæŸ¥è¯¢è¿›è¡Œé«˜çº§æ€§èƒ½åˆ†æ</li>
</ol>
<hr/>
<h2 data-id="heading-1">ä¸€ã€Traceå·¥å…·æ¦‚è¿°</h2>
<h3 data-id="heading-2">1.1 ä»€ä¹ˆæ˜¯Trace</h3>
<p><strong>Trace(è·Ÿè¸ª)</strong>  æ˜¯ä¸€ç§è®°å½•ç³»ç»Ÿè¿è¡Œæ—¶äº‹ä»¶åºåˆ—çš„æŠ€æœ¯ã€‚ç®€å•æ¥è¯´,å°±æ˜¯ç»™ç³»ç»Ÿ"è£…ä¸ªç›‘æ§æ‘„åƒå¤´",è®°å½•ä¸‹æŒ‡å®šæ—¶é—´æ®µå†…å‘ç”Ÿçš„æ‰€æœ‰å…³é”®äº‹ä»¶ã€‚</p>
<p><strong>Traceèƒ½è®°å½•ä»€ä¹ˆ?</strong></p>













































<table><thead><tr><th align="left">ç±»å‹</th><th align="left">å†…å®¹</th><th align="left">ç”¨é€”</th></tr></thead><tbody><tr><td align="left"><strong>å‡½æ•°è°ƒç”¨</strong></td><td align="left">æ–¹æ³•è¿›å…¥/é€€å‡ºæ—¶é—´</td><td align="left">åˆ†æå“ªä¸ªå‡½æ•°è€—æ—¶é•¿</td></tr><tr><td align="left"><strong>çº¿ç¨‹è°ƒåº¦</strong></td><td align="left">çº¿ç¨‹è¿è¡Œ/ç­‰å¾…/ç¡çœ çŠ¶æ€</td><td align="left">å®šä½çº¿ç¨‹é˜»å¡é—®é¢˜</td></tr><tr><td align="left"><strong>CPUè°ƒåº¦</strong></td><td align="left">å“ªä¸ªçº¿ç¨‹åœ¨å“ªä¸ªæ ¸å¿ƒä¸Šè¿è¡Œ</td><td align="left">CPUå ç”¨åˆ†æ</td></tr><tr><td align="left"><strong>æ¸²æŸ“äº‹ä»¶</strong></td><td align="left">VSYNCã€SurfaceFlingerç»˜åˆ¶</td><td align="left">å¡é¡¿å’Œæ‰å¸§åˆ†æ</td></tr><tr><td align="left"><strong>I/Oæ“ä½œ</strong></td><td align="left">æ–‡ä»¶è¯»å†™ã€ç½‘ç»œè¯·æ±‚</td><td align="left">I/Oæ€§èƒ½åˆ†æ</td></tr><tr><td align="left"><strong>GCäº‹ä»¶</strong></td><td align="left">åƒåœ¾å›æ”¶çš„æ—¶é—´å’Œé¢‘ç‡</td><td align="left">å†…å­˜æŠ–åŠ¨åˆ†æ</td></tr><tr><td align="left"><strong>Binderè°ƒç”¨</strong></td><td align="left">è·¨è¿›ç¨‹é€šä¿¡</td><td align="left">IPCæ€§èƒ½åˆ†æ</td></tr></tbody></table>
<p><strong>Traceèƒ½è§£å†³ä»€ä¹ˆé—®é¢˜?</strong></p>
<p>âœ… <strong>å¯åŠ¨æ…¢</strong> - ç²¾ç¡®å®šä½å¯åŠ¨è¿‡ç¨‹ä¸­çš„è€—æ—¶æ“ä½œ<br/>
âœ… <strong>æ»‘åŠ¨å¡é¡¿</strong> - æ‰¾å‡ºå¯¼è‡´æ‰å¸§çš„å‡½æ•°è°ƒç”¨<br/>
âœ… <strong>åŠ¨ç”»ä¸æµç•…</strong> - åˆ†ææ¸²æŸ“Pipelineçš„ç“¶é¢ˆ<br/>
âœ… <strong>CPUå ç”¨é«˜</strong> - è¯†åˆ«CPUå¯†é›†å‹æ“ä½œ<br/>
âœ… <strong>åŠŸè€—é«˜</strong> - å®šä½é¢‘ç¹å”¤é†’å’Œé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡</p>
<h3 data-id="heading-3">1.2 Systraceç®€ä»‹</h3>
<p><strong>Systrace</strong>æ˜¯Googleæ—©æœŸæ¨å‡ºçš„ç³»ç»Ÿçº§æ€§èƒ½åˆ†æå·¥å…·,ä»Android 4.1å¼€å§‹å¼•å…¥ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹ç‚¹</strong>:</p>
<ul>
<li>åŸºäºLinux <strong>ftrace</strong>æœºåˆ¶</li>
<li>è½»é‡çº§,å¯¹ç³»ç»Ÿæ€§èƒ½å½±å“å°</li>
<li>ä»¥HTMLæ–‡ä»¶å‘ˆç°,ä½¿ç”¨Chrome Trace VieweræŸ¥çœ‹</li>
<li>æ”¯æŒAndroid 4.1åˆ°Android 12çš„æ‰€æœ‰ç‰ˆæœ¬</li>
</ul>
<p><strong>å·¥ä½œåŸç†</strong>:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/38c947baf33f4d649918da90a7ec2449~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141495&amp;x-signature=S9NDM6hh3coHY31UvSZDbJzuJz4%3D" alt="08-01-trace-workflow.png" loading="lazy"/></p>
<p><strong>ä¼˜åŠ¿</strong>:</p>
<ul>
<li>âœ… ç®€å•æ˜“ç”¨,ä¸€è¡Œå‘½ä»¤å³å¯æŠ“å–</li>
<li>âœ… å…¼å®¹æ€§å¥½,æ”¯æŒè€ç‰ˆæœ¬Android</li>
<li>âœ… æ— éœ€é¢å¤–å®‰è£…å·¥å…·</li>
</ul>
<p><strong>å±€é™æ€§</strong>:</p>
<ul>
<li>âŒ UIä½“éªŒä¸€èˆ¬(åŸºäºChromeæ’ä»¶)</li>
<li>âŒ ä¸æ”¯æŒSQLæŸ¥è¯¢</li>
<li>âŒ å¤§æ–‡ä»¶åŠ è½½æ…¢</li>
<li>âŒ åŠŸèƒ½ç›¸å¯¹åŸºç¡€</li>
</ul>
<h3 data-id="heading-4">1.3 Perfettoç®€ä»‹</h3>
<p><strong>Perfetto</strong>  æ˜¯Googleä»Android 10å¼€å§‹æ¨å‡ºçš„æ–°ä¸€ä»£æ€§èƒ½åˆ†æå¹³å°,æ—¨åœ¨å–ä»£Systraceã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹ç‚¹</strong>:</p>
<ul>
<li>ç°ä»£åŒ–çš„Web UI(<a href="https://link.juejin.cn?target=https%3A%2F%2Fui.perfetto.dev%2F" target="_blank" title="https://ui.perfetto.dev/" ref="nofollow noopener noreferrer">ui.perfetto.dev/</a>)</li>
<li>å¼ºå¤§çš„SQLæŸ¥è¯¢å¼•æ“</li>
<li>æ”¯æŒProtobufäºŒè¿›åˆ¶æ ¼å¼,æ–‡ä»¶æ›´å°</li>
<li>æ›´ä¸°å¯Œçš„æ•°æ®æº(å†…å­˜ã€ç”µé‡ã€ç½‘ç»œç­‰)</li>
<li>å‘åå…¼å®¹,å¯ä»¥æ‰“å¼€Systraceæ–‡ä»¶</li>
</ul>
<p><strong>å·¥ä½œåŸç†</strong>:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4bab3d14320444938b8be9c9eb5ae253~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141495&amp;x-signature=UQMiWVWTKQCnXpqNT5tlbinY5u4%3D" alt="08-02-perfetto-architecture.png" loading="lazy"/></p>
<p><strong>ä¼˜åŠ¿</strong>:</p>
<ul>
<li>âœ… ç°ä»£åŒ–UI,äº¤äº’ä½“éªŒæä½³</li>
<li>âœ… SQLæŸ¥è¯¢å¼•æ“,æ”¯æŒå¤æ‚åˆ†æ</li>
<li>âœ… æ›´ä¸°å¯Œçš„æ•°æ®æº</li>
<li>âœ… æ–‡ä»¶æ›´å°,åŠ è½½æ›´å¿«</li>
<li>âœ… æŒç»­æ›´æ–°,åŠŸèƒ½ä¸æ–­å¢å¼º</li>
</ul>
<p><strong>å±€é™æ€§</strong>:</p>
<ul>
<li>âš ï¸ ä¸»è¦æ”¯æŒAndroid 10+</li>
<li>âš ï¸ å­¦ä¹ æ›²çº¿ç¨é™¡(SQLæŸ¥è¯¢)</li>
</ul>
<h3 data-id="heading-5">1.4 å·¥å…·å¯¹æ¯”</h3>




























































<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">Systrace</th><th align="left">Perfetto</th></tr></thead><tbody><tr><td align="left"><strong>æ¨å‡ºæ—¶é—´</strong></td><td align="left">Android 4.1 (2012)</td><td align="left">Android 10 (2019)</td></tr><tr><td align="left"><strong>UIä½“éªŒ</strong></td><td align="left">Chrome Trace Viewer</td><td align="left">ç°ä»£Web UI â­â­â­â­â­</td></tr><tr><td align="left"><strong>åŠŸèƒ½ä¸°å¯Œåº¦</strong></td><td align="left">åŸºç¡€</td><td align="left">å¼ºå¤§ â­â­â­â­â­</td></tr><tr><td align="left"><strong>æ•°æ®æ ¼å¼</strong></td><td align="left">HTML</td><td align="left">Protobuf (æ›´å°)</td></tr><tr><td align="left"><strong>æŸ¥è¯¢èƒ½åŠ›</strong></td><td align="left">æ— </td><td align="left">SQLæŸ¥è¯¢ â­â­â­â­â­</td></tr><tr><td align="left"><strong>æ•°æ®æº</strong></td><td align="left">ftrace</td><td align="left">ftrace + å†…å­˜ + ç”µé‡ + ç½‘ç»œ</td></tr><tr><td align="left"><strong>å…¼å®¹æ€§</strong></td><td align="left">Android 4.1 - 12</td><td align="left">Android 9+ (æœ€å¥½10+)</td></tr><tr><td align="left"><strong>æ–‡ä»¶å¤§å°</strong></td><td align="left">è¾ƒå¤§</td><td align="left">æ›´å°</td></tr><tr><td align="left"><strong>å­¦ä¹ æ›²çº¿</strong></td><td align="left">ç®€å•</td><td align="left">ä¸­ç­‰</td></tr><tr><td align="left"><strong>æ¨èä½¿ç”¨</strong></td><td align="left">Android 9åŠä»¥ä¸‹</td><td align="left"><strong>Android 10+</strong> â­æ¨è</td></tr></tbody></table>
<p><strong>é€‰æ‹©å»ºè®®</strong>:</p>
<ul>
<li>å¦‚æœä½ çš„é¡¹ç›®ä¸»è¦æ”¯æŒAndroid 10+,<strong>å¼ºçƒˆæ¨èPerfetto</strong></li>
<li>å¦‚æœéœ€è¦å…¼å®¹Android 9åŠä»¥ä¸‹,ä½¿ç”¨<strong>Systrace</strong></li>
<li>ä¸¤è€…å¯ä»¥å…±å­˜,æ ¹æ®åœºæ™¯çµæ´»é€‰æ‹©</li>
</ul>
<hr/>
<h2 data-id="heading-6">äºŒã€Systraceä½¿ç”¨æŒ‡å—</h2>
<h3 data-id="heading-7">2.1 ç¯å¢ƒå‡†å¤‡</h3>
<p><strong>å‰ç½®æ¡ä»¶</strong>:</p>
<ol>
<li>âœ… Python 2.7+ æˆ– Python 3.x</li>
<li>âœ… Android SDK Platform-Tools (adbå‘½ä»¤)</li>
<li>âœ… Chromeæµè§ˆå™¨</li>
</ol>
<p><strong>Systraceä½ç½®</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Android SDKä¸­çš„ä½ç½®</span>
<span class="hljs-variable">$ANDROID_HOME</span>/platform-tools/systrace/systrace.py

<span class="hljs-comment"># éªŒè¯Pythonç¯å¢ƒ</span>
python --version  <span class="hljs-comment"># æˆ– python3 --version</span>

<span class="hljs-comment"># éªŒè¯adbè¿æ¥</span>
adb devices
</code></pre>
<p><strong>è®¾å¤‡æƒé™è®¾ç½®</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. å¼€å¯å¼€å‘è€…é€‰é¡¹</span>
<span class="hljs-comment"># è®¾ç½® â†’ å…³äºæ‰‹æœº â†’ è¿ç»­ç‚¹å‡»"ç‰ˆæœ¬å·"7æ¬¡</span>

<span class="hljs-comment"># 2. å¼€å¯USBè°ƒè¯•</span>
<span class="hljs-comment"># è®¾ç½® â†’ å¼€å‘è€…é€‰é¡¹ â†’ USBè°ƒè¯•</span>

<span class="hljs-comment"># 3. æˆäºˆadb rootæƒé™(å¦‚éœ€è¦)</span>
adb root
adb remount
</code></pre>
<h3 data-id="heading-8">2.2 æŠ“å–Systrace</h3>
<p><strong>åŸºç¡€ç”¨æ³•</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿›å…¥systraceç›®å½•</span>
<span class="hljs-built_in">cd</span> <span class="hljs-variable">$ANDROID_HOME</span>/platform-tools/systrace

<span class="hljs-comment"># æŠ“å–10ç§’çš„trace</span>
python systrace.py -o trace.html -t 10 -b 32768 \
  gfx input view webview wm am sm audio video camera hal \
  app res dalvik rs bionic power pm ss database network

<span class="hljs-comment"># å‚æ•°è¯´æ˜:</span>
<span class="hljs-comment"># -o trace.html   : è¾“å‡ºæ–‡ä»¶å</span>
<span class="hljs-comment"># -t 10           : æŠ“å–æ—¶é•¿(ç§’)</span>
<span class="hljs-comment"># -b 32768        : bufferå¤§å°(KB),å»ºè®®32MBä»¥ä¸Š</span>
<span class="hljs-comment"># -a package_name : æŒ‡å®šåº”ç”¨åŒ…å(å¯é€‰)</span>
<span class="hljs-comment"># åé¢æ˜¯categoryåˆ—è¡¨</span>
</code></pre>
<p><strong>æ¨èé…ç½®(é€šç”¨åœºæ™¯)</strong>:</p>
<pre><code class="hljs language-bash" lang="bash">python systrace.py \
  -o trace.html \
  -t 10 \
  -b 32768 \
  <span class="hljs-built_in">sched</span> freq idle am wm gfx view binder_driver hal \
  dalvik input res
</code></pre>
<h3 data-id="heading-9">2.3 å¸¸ç”¨Categoryè¯´æ˜</h3>







































































































































<table><thead><tr><th align="left">Category</th><th align="left">è¯´æ˜</th><th align="left">å…¸å‹ç”¨é€”</th></tr></thead><tbody><tr><td align="left"><strong>sched</strong></td><td align="left">CPUè°ƒåº¦äº‹ä»¶</td><td align="left"><strong>å¿…é€‰</strong>,åˆ†æçº¿ç¨‹è¿è¡ŒçŠ¶æ€</td></tr><tr><td align="left"><strong>freq</strong></td><td align="left">CPUé¢‘ç‡å˜åŒ–</td><td align="left">CPUæ€§èƒ½åˆ†æ</td></tr><tr><td align="left"><strong>idle</strong></td><td align="left">CPU idleçŠ¶æ€</td><td align="left">åŠŸè€—åˆ†æ</td></tr><tr><td align="left"><strong>gfx</strong></td><td align="left">SurfaceFlinger, VSYNC, Texture</td><td align="left"><strong>æ¸²æŸ“åˆ†æå¿…é€‰</strong></td></tr><tr><td align="left"><strong>input</strong></td><td align="left">Inputäº‹ä»¶åˆ†å‘</td><td align="left">è§¦æ‘¸å“åº”åˆ†æ</td></tr><tr><td align="left"><strong>view</strong></td><td align="left">Viewç»˜åˆ¶(measure/layout/draw)</td><td align="left"><strong>å¡é¡¿åˆ†æå¿…é€‰</strong></td></tr><tr><td align="left"><strong>webview</strong></td><td align="left">WebViewæ€§èƒ½</td><td align="left">H5é¡µé¢åˆ†æ</td></tr><tr><td align="left"><strong>wm</strong></td><td align="left">Window Manager</td><td align="left">çª—å£ç®¡ç†åˆ†æ</td></tr><tr><td align="left"><strong>am</strong></td><td align="left">Activity Managerç”Ÿå‘½å‘¨æœŸ</td><td align="left"><strong>å¯åŠ¨åˆ†æå¿…é€‰</strong></td></tr><tr><td align="left"><strong>sm</strong></td><td align="left">Sync Manager</td><td align="left">åŒæ­¥æ“ä½œåˆ†æ</td></tr><tr><td align="left"><strong>audio</strong></td><td align="left">Audioæ’­æ”¾</td><td align="left">éŸ³é¢‘å¡é¡¿åˆ†æ</td></tr><tr><td align="left"><strong>video</strong></td><td align="left">Videoè§£ç </td><td align="left">è§†é¢‘æ€§èƒ½åˆ†æ</td></tr><tr><td align="left"><strong>camera</strong></td><td align="left">Cameraæ“ä½œ</td><td align="left">ç›¸æœºæ€§èƒ½åˆ†æ</td></tr><tr><td align="left"><strong>hal</strong></td><td align="left">HALå±‚äº‹ä»¶</td><td align="left">åº•å±‚ç¡¬ä»¶è°ƒç”¨</td></tr><tr><td align="left"><strong>app</strong></td><td align="left">åº”ç”¨è‡ªå®šä¹‰trace</td><td align="left"><strong>æ’æ¡©åˆ†æå¿…é€‰</strong></td></tr><tr><td align="left"><strong>res</strong></td><td align="left">èµ„æºåŠ è½½</td><td align="left">èµ„æºåŠ è½½æ€§èƒ½</td></tr><tr><td align="left"><strong>dalvik</strong></td><td align="left">GCäº‹ä»¶</td><td align="left"><strong>å†…å­˜æŠ–åŠ¨åˆ†æå¿…é€‰</strong></td></tr><tr><td align="left"><strong>rs</strong></td><td align="left">RenderScript</td><td align="left">å›¾åƒå¤„ç†åˆ†æ</td></tr><tr><td align="left"><strong>bionic</strong></td><td align="left">Bionicåº“è°ƒç”¨</td><td align="left">Nativeæ€§èƒ½åˆ†æ</td></tr><tr><td align="left"><strong>power</strong></td><td align="left">Power HAL</td><td align="left">ç”µé‡åˆ†æ</td></tr><tr><td align="left"><strong>pm</strong></td><td align="left">Package Manager</td><td align="left">å®‰è£…/å¸è½½åˆ†æ</td></tr><tr><td align="left"><strong>ss</strong></td><td align="left">System Server</td><td align="left">ç³»ç»ŸæœåŠ¡åˆ†æ</td></tr><tr><td align="left"><strong>database</strong></td><td align="left">SQLiteæ“ä½œ</td><td align="left">æ•°æ®åº“æ€§èƒ½åˆ†æ</td></tr><tr><td align="left"><strong>network</strong></td><td align="left">ç½‘ç»œI/O</td><td align="left">ç½‘ç»œæ€§èƒ½åˆ†æ</td></tr><tr><td align="left"><strong>binder_driver</strong></td><td align="left">Binderé©±åŠ¨</td><td align="left"><strong>IPCåˆ†æå¿…é€‰</strong></td></tr></tbody></table>
<p><strong>åœºæ™¯æ¨èé…ç½®</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨æ€§èƒ½åˆ†æ</span>
python systrace.py -o launch.html -t 10 -a com.example.app \
  <span class="hljs-built_in">sched</span> freq idle am wm gfx view binder_driver hal dalvik input res

<span class="hljs-comment"># æ»‘åŠ¨å¡é¡¿åˆ†æ</span>
python systrace.py -o scroll.html -t 10 -a com.example.app \
  <span class="hljs-built_in">sched</span> gfx view input wm dalvik app

<span class="hljs-comment"># æ¸²æŸ“æ€§èƒ½åˆ†æ</span>
python systrace.py -o render.html -t 10 -a com.example.app \
  <span class="hljs-built_in">sched</span> freq gfx view wm

<span class="hljs-comment"># å†…å­˜æŠ–åŠ¨åˆ†æ</span>
python systrace.py -o memory.html -t 10 -a com.example.app \
  <span class="hljs-built_in">sched</span> dalvik app

<span class="hljs-comment"># å…¨é¢åˆ†æ(æ–‡ä»¶ä¼šå¾ˆå¤§)</span>
python systrace.py -o full.html -t 10 -a com.example.app \
  <span class="hljs-built_in">sched</span> freq idle am wm gfx view webview binder_driver hal \
  dalvik input res power database network app
</code></pre>
<h3 data-id="heading-10">2.4 å®æˆ˜æ¼”ç»ƒ:æŠ“å–åº”ç”¨å¯åŠ¨Trace</h3>
<p>å®Œæ•´çš„å¯åŠ¨TraceæŠ“å–æµç¨‹:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Step 1: ç¡®å®šåº”ç”¨åŒ…å</span>
adb shell pm list packages | grep example
<span class="hljs-comment"># è¾“å‡º: package:com.example.myapp</span>

<span class="hljs-comment"># Step 2: æ¸…ç†åº”ç”¨æ•°æ®(æ¨¡æ‹Ÿé¦–æ¬¡å¯åŠ¨)</span>
adb shell pm clear com.example.myapp

<span class="hljs-comment"># Step 3: å¯åŠ¨SystraceæŠ“å–(ä¸è¦ç«‹å³å¯åŠ¨App)</span>
<span class="hljs-built_in">cd</span> <span class="hljs-variable">$ANDROID_HOME</span>/platform-tools/systrace
python systrace.py -o launch.html -t 10 -a com.example.myapp \
  <span class="hljs-built_in">sched</span> freq idle am wm gfx view binder_driver hal dalvik input res &amp;

<span class="hljs-comment"># æ³¨æ„: æœ€åçš„ &amp; è®©å‘½ä»¤åœ¨åå°è¿è¡Œ</span>

<span class="hljs-comment"># Step 4: ç­‰å¾…2ç§’,è®©systraceå‡†å¤‡å¥½</span>
<span class="hljs-built_in">sleep</span> 2

<span class="hljs-comment"># Step 5: å¯åŠ¨åº”ç”¨å¹¶è®°å½•å¯åŠ¨æ—¶é—´</span>
adb shell am start -W com.example.myapp/.MainActivity

<span class="hljs-comment"># è¾“å‡ºç¤ºä¾‹:</span>
<span class="hljs-comment"># Starting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] cmp=com.example.myapp/.MainActivity }</span>
<span class="hljs-comment"># Status: ok</span>
<span class="hljs-comment"># Activity: com.example.myapp/.MainActivity</span>
<span class="hljs-comment"># ThisTime: 1245      â† Activityå¯åŠ¨æ—¶é—´</span>
<span class="hljs-comment"># TotalTime: 1245     â† æ€»å¯åŠ¨æ—¶é—´</span>
<span class="hljs-comment"># WaitTime: 1267      â† ç­‰å¾…æ—¶é—´</span>
<span class="hljs-comment"># Complete</span>

<span class="hljs-comment"># Step 6: ç­‰å¾…systraceæŠ“å–å®Œæˆ(10ç§’)</span>
<span class="hljs-comment"># ä¼šè‡ªåŠ¨ç”Ÿæˆ launch.html</span>

<span class="hljs-comment"># Step 7: ä½¿ç”¨Chromeæ‰“å¼€traceæ–‡ä»¶</span>
google-chrome launch.html
<span class="hljs-comment"># æˆ–</span>
open -a <span class="hljs-string">"Google Chrome"</span> launch.html
</code></pre>
<p><strong>Tip</strong>: ä¸ºäº†æŠ“å–åˆ°å®Œæ•´çš„å¯åŠ¨æµç¨‹,å»ºè®®traceæ—¶é•¿è®¾ç½®ä¸º15-20ç§’,ç¡®ä¿ä»åº”ç”¨å†·å¯åŠ¨åˆ°é¦–å±æ¸²æŸ“å®Œæˆéƒ½è¢«è®°å½•ã€‚</p>
<h3 data-id="heading-11">2.5 æŸ¥çœ‹Systrace</h3>
<p><strong>1. æ‰“å¼€Traceæ–‡ä»¶</strong>:</p>
<ul>
<li>ä½¿ç”¨Chromeæµè§ˆå™¨æ‰“å¼€trace.html</li>
<li>æ–‡ä»¶è¾ƒå¤§æ—¶å¯èƒ½éœ€è¦ç­‰å¾…å‡ ç§’åŠ è½½</li>
</ul>
<p><strong>2. ç•Œé¢å¸ƒå±€</strong>:</p>
<pre><code class="hljs language-less" lang="less">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  <span class="hljs-selector-attr">[?]</span> <span class="hljs-selector-attr">[W]</span><span class="hljs-selector-attr">[A]</span><span class="hljs-selector-attr">[S]</span><span class="hljs-selector-attr">[D]</span>  æœç´¢:<span class="hljs-selector-tag">______</span>  æ—¶é—´èŒƒå›´:<span class="hljs-selector-tag">___</span>     â”‚ å·¥å…·æ 
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  <span class="hljs-selector-tag">CPU</span> <span class="hljs-number">0</span>                                            â”‚
â”‚  <span class="hljs-selector-tag">CPU</span> <span class="hljs-number">1</span>                                            â”‚ <span class="hljs-selector-tag">CPU</span>æ ¸å¿ƒ
â”‚  <span class="hljs-selector-tag">CPU</span> <span class="hljs-number">2</span>                                            â”‚
â”‚  <span class="hljs-selector-tag">CPU</span> <span class="hljs-number">3</span>                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.myapp</span>                                â”‚ åº”ç”¨è¿›ç¨‹
â”‚    â””â”€ <span class="hljs-selector-tag">main</span>                  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ      â”‚ ä¸»çº¿ç¨‹
â”‚    â””â”€ <span class="hljs-selector-tag">RenderThread</span>          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                â”‚ æ¸²æŸ“çº¿ç¨‹
â”‚    â””â”€ <span class="hljs-selector-tag">binder</span>:<span class="hljs-selector-tag">xxx</span>            â–ˆâ–ˆâ–ˆ                   â”‚ <span class="hljs-selector-tag">Binder</span>çº¿ç¨‹
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  <span class="hljs-selector-tag">system_server</span>                                    â”‚ ç³»ç»Ÿè¿›ç¨‹
â”‚    â””â”€ <span class="hljs-selector-tag">android</span><span class="hljs-selector-class">.fg</span>            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ             â”‚
â”‚    â””â”€ <span class="hljs-selector-tag">android</span><span class="hljs-selector-class">.ui</span>            â–ˆâ–ˆâ–ˆâ–ˆ                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  <span class="hljs-selector-tag">surfaceflinger</span>                                   â”‚ <span class="hljs-selector-tag">SurfaceFlinger</span>
â”‚    â””â”€ <span class="hljs-selector-tag">surfaceflinger</span>        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>3. åŸºæœ¬æ“ä½œ</strong>:</p>























































<table><thead><tr><th align="left">æ“ä½œ</th><th align="left">å¿«æ·é”®/æ–¹æ³•</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="left"><strong>æ”¾å¤§</strong></td><td align="left"><code>W</code> æˆ– é¼ æ ‡æ»šè½®ä¸Šæ»š</td><td align="left">æ”¾å¤§æ—¶é—´è½´</td></tr><tr><td align="left"><strong>ç¼©å°</strong></td><td align="left"><code>S</code> æˆ– é¼ æ ‡æ»šè½®ä¸‹æ»š</td><td align="left">ç¼©å°æ—¶é—´è½´</td></tr><tr><td align="left"><strong>å·¦ç§»</strong></td><td align="left"><code>A</code></td><td align="left">å‘å·¦ç§»åŠ¨æ—¶é—´è½´</td></tr><tr><td align="left"><strong>å³ç§»</strong></td><td align="left"><code>D</code></td><td align="left">å‘å³ç§»åŠ¨æ—¶é—´è½´</td></tr><tr><td align="left"><strong>é€‰æ‹©åŒºåŸŸ</strong></td><td align="left">é¼ æ ‡å·¦é”®æ‹–æ‹½</td><td align="left">é€‰ä¸­ä¸€æ®µæ—¶é—´èŒƒå›´</td></tr><tr><td align="left"><strong>æŸ¥çœ‹è¯¦æƒ…</strong></td><td align="left">ç‚¹å‡»è‰²å—</td><td align="left">æŸ¥çœ‹å‡½æ•°è°ƒç”¨è¯¦æƒ…</td></tr><tr><td align="left"><strong>æœç´¢</strong></td><td align="left"><code>Ctrl+F</code> æˆ– æœç´¢æ¡†</td><td align="left">æœç´¢å‡½æ•°å</td></tr><tr><td align="left"><strong>é«˜äº®</strong></td><td align="left">ç‚¹å‡»å‡½æ•°å</td><td align="left">é«˜äº®æ‰€æœ‰åŒåå‡½æ•°</td></tr><tr><td align="left"><strong>æ ‡è®°</strong></td><td align="left"><code>M</code></td><td align="left">æ·»åŠ ä¹¦ç­¾æ ‡è®°</td></tr></tbody></table>
<p><strong>4. æŸ¥çœ‹å‡½æ•°è¯¦æƒ…</strong>:
ç‚¹å‡»ä¸€ä¸ªè‰²å—å,å³ä¾§ä¼šæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯:</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">Title:</span> <span class="hljs-string">onCreate</span>
<span class="hljs-attr">Wall Duration:</span> <span class="hljs-string">450ms</span>        <span class="hljs-string">â†</span> <span class="hljs-string">å®é™…è€—æ—¶</span>
<span class="hljs-attr">CPU Duration:</span> <span class="hljs-string">420ms</span>         <span class="hljs-string">â†</span> <span class="hljs-string">CPUå ç”¨æ—¶é—´</span>
<span class="hljs-attr">Self Time:</span> <span class="hljs-string">50ms</span>             <span class="hljs-string">â†</span> <span class="hljs-string">è‡ªèº«è€—æ—¶(ä¸å«å­è°ƒç”¨)</span>
<span class="hljs-attr">Start:</span> <span class="hljs-number">1234.</span><span class="hljs-string">567ms</span>           <span class="hljs-string">â†</span> <span class="hljs-string">å¼€å§‹æ—¶é—´</span>
<span class="hljs-attr">Args:</span>                       <span class="hljs-string">â†</span> <span class="hljs-string">å‚æ•°ä¿¡æ¯</span>
  <span class="hljs-attr">thread_name:</span> <span class="hljs-string">main</span>
  <span class="hljs-attr">process_name:</span> <span class="hljs-string">com.example.myapp</span>
</code></pre>
<p><strong>5. åˆ†ææŠ€å·§</strong>:</p>
<ul>
<li>ğŸ” å…ˆ<strong>ç¼©å°</strong>æŸ¥çœ‹æ•´ä½“,è¯†åˆ«å¤§å—è€—æ—¶</li>
<li>ğŸ” å†<strong>æ”¾å¤§</strong>æŸ¥çœ‹ç»†èŠ‚,å®šä½å…·ä½“å‡½æ•°</li>
<li>ğŸ” å…³æ³¨<strong>ä¸»çº¿ç¨‹</strong>çš„ç©ºç™½åŒºåŸŸ(å¯èƒ½åœ¨ç­‰å¾…)</li>
<li>ğŸ” æŸ¥çœ‹<strong>CPUè°ƒåº¦</strong>,è¯†åˆ«çº¿ç¨‹é˜»å¡</li>
<li>ğŸ” å¯¹æ¯”<strong>VSYNC</strong>ä¿¡å·,åˆ†ææ‰å¸§åŸå› </li>
</ul>
<hr/>
<h2 data-id="heading-12">ä¸‰ã€Perfettoä½¿ç”¨æŒ‡å—</h2>
<h3 data-id="heading-13">3.1 ä¸‰ç§ä½¿ç”¨æ–¹å¼</h3>
<p>Perfettoæä¾›äº†ä¸‰ç§æŠ“å–å’Œåˆ†ætraceçš„æ–¹å¼:</p>
<h4 data-id="heading-14">æ–¹å¼1: Web UI (â­æ¨è)</h4>
<p><strong>ä¼˜ç‚¹</strong>: æ— éœ€å®‰è£…,åŠŸèƒ½å®Œæ•´,ä½“éªŒæœ€ä½³<br/>
<strong>ç¼ºç‚¹</strong>: éœ€è¦ç½‘ç»œè¿æ¥</p>
<p><strong>ä½¿ç”¨æ­¥éª¤</strong>:</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> æ‰“å¼€æµè§ˆå™¨è®¿é—® https://ui.perfetto.dev/
<span class="hljs-bullet">2.</span> ç‚¹å‡»"Record new trace"
<span class="hljs-bullet">3.</span> è¿æ¥è®¾å¤‡ (ä¼šæç¤ºæˆæƒadb)
<span class="hljs-bullet">4.</span> é…ç½®æŠ“å–å‚æ•°
<span class="hljs-bullet">5.</span> ç‚¹å‡»"Start Recording"
<span class="hljs-bullet">6.</span> æ‰§è¡Œå¾…åˆ†æçš„æ“ä½œ
<span class="hljs-bullet">7.</span> ç‚¹å‡»"Stop"å¹¶ä¸‹è½½traceæ–‡ä»¶
</code></pre>
<h4 data-id="heading-15">æ–¹å¼2: å‘½ä»¤è¡Œ</h4>
<p><strong>ä¼˜ç‚¹</strong>: é€‚åˆè‡ªåŠ¨åŒ–è„šæœ¬,CIé›†æˆ<br/>
<strong>ç¼ºç‚¹</strong>: éœ€è¦æ‰‹åŠ¨é…ç½®</p>
<p><strong>ä½¿ç”¨æ­¥éª¤</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ä¸‹è½½Perfettoå·¥å…·(å¦‚æœè®¾å¤‡ä¸Šæ²¡æœ‰)</span>
adb shell perfetto --version
<span class="hljs-comment"># å¦‚æœæ²¡æœ‰,ä» https://get.perfetto.dev/perfetto ä¸‹è½½</span>

<span class="hljs-comment"># 2. æ¨é€é…ç½®æ–‡ä»¶åˆ°è®¾å¤‡</span>
adb push config.pbtx /data/local/tmp/

<span class="hljs-comment"># 3. å¼€å§‹æŠ“å–</span>
adb shell perfetto \
  -c /data/local/tmp/config.pbtx \
  -o /data/local/tmp/trace.perfetto-trace

<span class="hljs-comment"># 4. å¯¼å‡ºtraceæ–‡ä»¶</span>
adb pull /data/local/tmp/trace.perfetto-trace ./
</code></pre>
<h4 data-id="heading-16">æ–¹å¼3: Android Studioé›†æˆ</h4>
<p><strong>ä¼˜ç‚¹</strong>: ä¸å¼€å‘ç¯å¢ƒé›†æˆ,æ“ä½œç®€å•<br/>
<strong>ç¼ºç‚¹</strong>: åŠŸèƒ½ç›¸å¯¹åŸºç¡€</p>
<p><strong>ä½¿ç”¨æ­¥éª¤</strong>:</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> æ‰“å¼€Android Studio
<span class="hljs-bullet">2.</span> View â†’ Tool Windows â†’ Profiler
<span class="hljs-bullet">3.</span> ç‚¹å‡»"+"æ·»åŠ Session
<span class="hljs-bullet">4.</span> é€‰æ‹©è®¾å¤‡å’Œè¿›ç¨‹
<span class="hljs-bullet">5.</span> ç‚¹å‡»"CPU" â†’ "System Trace"
<span class="hljs-bullet">6.</span> ç‚¹å‡»"Record"å¼€å§‹æŠ“å–
<span class="hljs-bullet">7.</span> æ‰§è¡Œæ“ä½œåç‚¹å‡»"Stop"
<span class="hljs-bullet">8.</span> æŸ¥çœ‹trace (ä¼šè‡ªåŠ¨ç”¨Perfetto UIæ‰“å¼€)
</code></pre>
<h3 data-id="heading-17">3.2 Web UIæŠ“å–æµç¨‹è¯¦è§£</h3>
<p>è®©æˆ‘ä»¬è¯¦ç»†è®²è§£æœ€æ¨èçš„Web UIæ–¹å¼:</p>
<p><strong>Step 1: æ‰“å¼€Perfetto UI</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">æµè§ˆå™¨è®¿é—®: https:<span class="hljs-comment">//ui.perfetto.dev/</span>
å»ºè®®ä½¿ç”¨Chromeæˆ–Edgeæµè§ˆå™¨
</code></pre>
<p><strong>Step 2: é€‰æ‹©Record new trace</strong>
ç‚¹å‡»å·¦ä¸Šè§’çš„"Record new trace"æŒ‰é’®</p>
<p><strong>Step 3: è¿æ¥è®¾å¤‡</strong></p>
<ul>
<li>ç¡®ä¿adbå·²è¿æ¥: <code>adb devices</code></li>
<li>åœ¨"Target"ä¸‹æ‹‰æ¡†ä¸­é€‰æ‹©ä½ çš„è®¾å¤‡</li>
<li>é¦–æ¬¡ä½¿ç”¨ä¼šæç¤ºå®‰è£…"Perfetto UI ADB Bridge",ç‚¹å‡»åŒæ„</li>
</ul>
<p><strong>Step 4: é…ç½®æŠ“å–å‚æ•°</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># Recording Settingsé…ç½®é¡¹:</span>

<span class="hljs-attr">Duration:</span> <span class="hljs-number">10000</span> <span class="hljs-string">ms</span>          <span class="hljs-comment"># æŠ“å–æ—¶é•¿</span>
<span class="hljs-attr">Buffer size:</span> <span class="hljs-number">32768</span> <span class="hljs-string">KB</span>       <span class="hljs-comment"># ç¼“å†²åŒºå¤§å°</span>

<span class="hljs-comment"># Probes (æ•°æ®æº)é€‰æ‹©:</span>

<span class="hljs-string">âœ…</span> <span class="hljs-string">Scheduling</span> <span class="hljs-string">details</span>       <span class="hljs-comment"># CPUè°ƒåº¦(å¿…é€‰)</span>
<span class="hljs-string">âœ…</span> <span class="hljs-string">CPU</span> <span class="hljs-string">frequency</span> <span class="hljs-string">and</span> <span class="hljs-string">idle</span> <span class="hljs-string">states</span>  <span class="hljs-comment"># CPUé¢‘ç‡</span>
<span class="hljs-string">âœ…</span> <span class="hljs-string">Syscalls</span>                 <span class="hljs-comment"># ç³»ç»Ÿè°ƒç”¨</span>
<span class="hljs-string">âœ…</span> <span class="hljs-string">Process</span> <span class="hljs-string">tracking</span>         <span class="hljs-comment"># è¿›ç¨‹è·Ÿè¸ª</span>
<span class="hljs-string">âœ…</span> <span class="hljs-string">Frame</span> <span class="hljs-string">timeline</span>           <span class="hljs-comment"># å¸§æ—¶é—´çº¿(æ¸²æŸ“åˆ†æå¿…é€‰)</span>
<span class="hljs-string">âœ…</span> <span class="hljs-string">Memory</span> <span class="hljs-string">(RSS,</span> <span class="hljs-string">PSS,</span> <span class="hljs-string">etc)</span>   <span class="hljs-comment"># å†…å­˜ç»Ÿè®¡</span>
<span class="hljs-string">âœ…</span> <span class="hljs-string">Battery</span> <span class="hljs-string">drain</span> <span class="hljs-string">&amp;</span> <span class="hljs-string">power</span> <span class="hljs-string">rails</span>  <span class="hljs-comment"># ç”µé‡åˆ†æ</span>

<span class="hljs-comment"># Advanced settings:</span>

<span class="hljs-attr">Atrace categories:</span>          <span class="hljs-comment"># é€‰æ‹©category</span>
  <span class="hljs-string">âœ…</span> <span class="hljs-string">gfx</span>
  <span class="hljs-string">âœ…</span> <span class="hljs-string">input</span>
  <span class="hljs-string">âœ…</span> <span class="hljs-string">view</span>
  <span class="hljs-string">âœ…</span> <span class="hljs-string">am</span>
  <span class="hljs-string">âœ…</span> <span class="hljs-string">wm</span>
  <span class="hljs-string">âœ…</span> <span class="hljs-string">dalvik</span>

<span class="hljs-attr">App name:</span> <span class="hljs-string">com.example.myapp</span>  <span class="hljs-comment"># æŒ‡å®šåº”ç”¨åŒ…å</span>
</code></pre>
<p><strong>Step 5: å¼€å§‹æŠ“å–</strong></p>
<ul>
<li>ç‚¹å‡»"Start Recording"æŒ‰é’®</li>
<li>ç­‰å¾…åˆå§‹åŒ–(2-3ç§’)</li>
<li>æ‰§è¡Œä½ è¦åˆ†æçš„æ“ä½œ(å¯åŠ¨Appã€æ»‘åŠ¨åˆ—è¡¨ç­‰)</li>
</ul>
<p><strong>Step 6: åœæ­¢å¹¶ä¸‹è½½</strong></p>
<ul>
<li>ç‚¹å‡»"Stop and get trace"</li>
<li>ç­‰å¾…æ•°æ®ä¼ è¾“(å–å†³äºtraceå¤§å°)</li>
<li>Traceä¼šè‡ªåŠ¨åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€</li>
<li>å¯ä»¥ç‚¹å‡»"Download"ä¿å­˜åˆ°æœ¬åœ°</li>
</ul>
<h3 data-id="heading-18">3.3 å‘½ä»¤è¡ŒæŠ“å–</h3>
<p>å¯¹äºè‡ªåŠ¨åŒ–åœºæ™¯,å‘½ä»¤è¡ŒæŠ“å–æ›´é€‚åˆã€‚</p>
<p><strong>åˆ›å»ºé…ç½®æ–‡ä»¶ config.pbtx</strong>:</p>
<pre><code class="hljs language-protobuf" lang="protobuf"># Perfettoé…ç½®æ–‡ä»¶æ ¼å¼ (Protocol Buffer Text)

buffers {
  size_kb: 32768           # ç¼“å†²åŒº32MB
  fill_policy: RING_BUFFER # ç¯å½¢ç¼“å†²åŒºç­–ç•¥
}

# æ•°æ®æºé…ç½®
data_sources {
  config {
    name: "linux.ftrace"
    ftrace_config {
      # ftraceäº‹ä»¶
      ftrace_events: "sched/sched_switch"
      ftrace_events: "sched/sched_wakeup"
      ftrace_events: "sched/sched_wakeup_new"
      ftrace_events: "sched/sched_waking"
      ftrace_events: "power/suspend_resume"
      ftrace_events: "power/cpu_frequency"
      ftrace_events: "power/cpu_idle"

      # atrace categories
      atrace_categories: "gfx"
      atrace_categories: "view"
      atrace_categories: "am"
      atrace_categories: "wm"
      atrace_categories: "input"
      atrace_categories: "dalvik"

      # æŒ‡å®šåº”ç”¨
      atrace_apps: "com.example.myapp"
    }
  }
}

# æŠ“å–æ—¶é•¿
duration_ms: 10000  # 10ç§’
</code></pre>
<p><strong>æŠ“å–è„šæœ¬ capture_trace.sh</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-comment"># é…ç½®</span>
APP_PACKAGE=<span class="hljs-string">"com.example.myapp"</span>
CONFIG_FILE=<span class="hljs-string">"config.pbtx"</span>
OUTPUT_FILE=<span class="hljs-string">"trace_<span class="hljs-subst">$(date +%Y%m%d_%H%M%S)</span>.perfetto-trace"</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"=== Perfetto Trace Capture ==="</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"App: <span class="hljs-variable">$APP_PACKAGE</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Output: <span class="hljs-variable">$OUTPUT_FILE</span>"</span>

<span class="hljs-comment"># 1. æ¨é€é…ç½®æ–‡ä»¶</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"[1/4] Pushing config..."</span>
adb push <span class="hljs-variable">$CONFIG_FILE</span> /data/local/tmp/config.pbtx

<span class="hljs-comment"># 2. æ¸…ç†åº”ç”¨æ•°æ®(å¯é€‰)</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"[2/4] Clearing app data..."</span>
adb shell pm clear <span class="hljs-variable">$APP_PACKAGE</span>

<span class="hljs-comment"># 3. å¼€å§‹æŠ“å–(åå°è¿è¡Œ)</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"[3/4] Starting trace capture..."</span>
adb shell perfetto \
  -c /data/local/tmp/config.pbtx \
  -o /data/local/tmp/trace.perfetto-trace &amp;

PERFETTO_PID=$!

<span class="hljs-comment"># ç­‰å¾…perfettoå¯åŠ¨</span>
<span class="hljs-built_in">sleep</span> 2

<span class="hljs-comment"># 4. å¯åŠ¨åº”ç”¨</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"[4/4] Launching app..."</span>
adb shell am start -W <span class="hljs-variable">$APP_PACKAGE</span>/.MainActivity

<span class="hljs-comment"># ç­‰å¾…perfettoå®Œæˆ</span>
<span class="hljs-built_in">wait</span> <span class="hljs-variable">$PERFETTO_PID</span>

<span class="hljs-comment"># 5. å¯¼å‡ºtrace</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Pulling trace file..."</span>
adb pull /data/local/tmp/trace.perfetto-trace <span class="hljs-variable">$OUTPUT_FILE</span>

<span class="hljs-comment"># æ¸…ç†è®¾å¤‡ä¸Šçš„æ–‡ä»¶</span>
adb shell <span class="hljs-built_in">rm</span> /data/local/tmp/trace.perfetto-trace
adb shell <span class="hljs-built_in">rm</span> /data/local/tmp/config.pbtx

<span class="hljs-built_in">echo</span> <span class="hljs-string">"âœ… Trace saved to: <span class="hljs-variable">$OUTPUT_FILE</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Open it at: https://ui.perfetto.dev/"</span>
</code></pre>
<p><strong>ä½¿ç”¨è„šæœ¬</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">chmod</span> +x capture_trace.sh
./capture_trace.sh
</code></pre>
<h3 data-id="heading-19">3.4 Perfetto UIè¯¦è§£</h3>
<p><strong>æ•´ä½“ç•Œé¢å¸ƒå±€</strong>:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a83e16a989294aa8af694ddf12cede6a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141495&amp;x-signature=f6bdI3rriQq4cpdW8RHnBFnR9u8%3D" alt="08-03-perfetto-ui.png" loading="lazy"/></p>
<p><strong>æ ¸å¿ƒåŠŸèƒ½åŒºåŸŸ</strong>:</p>
<ol>
<li>
<p><strong>Timeline (æ—¶é—´è½´)</strong></p>
<ul>
<li>æ˜¾ç¤ºæ•´ä¸ªtraceçš„æ—¶é—´èŒƒå›´</li>
<li>å¯ä»¥æ‹–æ‹½é€‰æ‹©æ—¶é—´åŒºé—´</li>
<li>åŒå‡»å¯ä»¥è·³è½¬åˆ°è¯¥æ—¶é—´ç‚¹</li>
</ul>
</li>
<li>
<p><strong>Pinned Tracks (ç½®é¡¶è½¨é“)</strong></p>
<ul>
<li>Frame Timeline: æ¯ä¸€å¸§çš„æ¸²æŸ“æƒ…å†µ
<ul>
<li>ç»¿è‰²: æ­£å¸¸å¸§ (&lt; 16.6ms)</li>
<li>é»„è‰²: è½»å¾®æ‰å¸§ (16.6-33ms)</li>
<li>çº¢è‰²: ä¸¥é‡æ‰å¸§ (&gt; 33ms)</li>
</ul>
</li>
<li>å¯ä»¥æ·»åŠ å…¶ä»–é‡è¦è½¨é“</li>
</ul>
</li>
<li>
<p><strong>CPUè½¨é“</strong></p>
<ul>
<li>æ˜¾ç¤ºæ¯ä¸ªCPUæ ¸å¿ƒçš„ä½¿ç”¨æƒ…å†µ</li>
<li>å¯ä»¥çœ‹åˆ°çº¿ç¨‹åœ¨å“ªä¸ªæ ¸å¿ƒä¸Šè¿è¡Œ</li>
<li>é¢œè‰²ä»£è¡¨ä¸åŒçš„è¿›ç¨‹</li>
</ul>
</li>
<li>
<p><strong>è¿›ç¨‹å’Œçº¿ç¨‹è½¨é“</strong></p>
<ul>
<li>æ¯ä¸ªè¿›ç¨‹å¯ä»¥å±•å¼€æŸ¥çœ‹çº¿ç¨‹</li>
<li>çº¿ç¨‹ä¸Šçš„è‰²å—ä»£è¡¨å‡½æ•°è°ƒç”¨</li>
<li>ç‚¹å‡»è‰²å—æŸ¥çœ‹å‡½æ•°è¯¦æƒ…</li>
</ul>
</li>
<li>
<p><strong>è¯¦æƒ…é¢æ¿ (å³ä¾§æˆ–åº•éƒ¨)</strong></p>
<ul>
<li>æ˜¾ç¤ºé€‰ä¸­sliceçš„è¯¦ç»†ä¿¡æ¯</li>
<li>åŒ…å«Wall Durationã€CPU Timeã€Stack Trace</li>
<li>å¯ä»¥æŸ¥çœ‹å‚æ•°å’Œå±æ€§</li>
</ul>
</li>
</ol>
<p><strong>å¸¸ç”¨æ“ä½œ</strong>:</p>









































<table><thead><tr><th align="left">æ“ä½œ</th><th align="left">æ–¹æ³•</th></tr></thead><tbody><tr><td align="left">æ”¾å¤§/ç¼©å°</td><td align="left">é¼ æ ‡æ»šè½® æˆ– è§¦æ§æ¿åŒæŒ‡ç¼©æ”¾</td></tr><tr><td align="left">å¹³ç§»</td><td align="left">æŒ‰ä½Shift+æ‹–æ‹½ æˆ– è§¦æ§æ¿åŒæŒ‡æ»‘åŠ¨</td></tr><tr><td align="left">é€‰æ‹©åŒºåŸŸ</td><td align="left">æŒ‰ä½å·¦é”®æ‹–æ‹½</td></tr><tr><td align="left">æŸ¥çœ‹è¯¦æƒ…</td><td align="left">ç‚¹å‡»slice(è‰²å—)</td></tr><tr><td align="left">æœç´¢</td><td align="left">ç‚¹å‡»é¡¶éƒ¨æœç´¢å›¾æ ‡ æˆ– æŒ‰<code>/</code></td></tr><tr><td align="left">æµ‹é‡æ—¶é—´</td><td align="left">æŒ‰ä½<code>Shift</code>ç‚¹å‡»ä¸¤ä¸ªæ—¶é—´ç‚¹</td></tr><tr><td align="left">æ·»åŠ æ ‡è®°</td><td align="left">æŒ‰<code>M</code>é”®</td></tr><tr><td align="left">å›åˆ°å…¨æ™¯</td><td align="left">åŒå‡»æ—¶é—´è½´ç©ºç™½å¤„</td></tr></tbody></table>
<p><strong>Frame Timelineåˆ†æ</strong>:</p>
<p>Frame Timelineæ˜¯Perfettoæœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€,ç”¨äºåˆ†ææ¸²æŸ“æ€§èƒ½ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5d083c6d5cc4457bf401a7a10619738~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141495&amp;x-signature=mb5iWEjEfT5Vg14AX5pCKgmNpuM%3D" alt="08-04-frame-timeline-stages.png" loading="lazy"/></p>
<p><strong>åˆ†ææ¯ä¸€å¸§</strong>:</p>
<ul>
<li>ç»¿è‰²å¸§: æ­£å¸¸,&lt; 16.6ms</li>
<li>é»„è‰²å¸§: è½»å¾®æ‰å¸§,16.6-33ms (æ‰1å¸§)</li>
<li>çº¢è‰²å¸§: ä¸¥é‡æ‰å¸§,&gt; 33ms (æ‰2å¸§ä»¥ä¸Š)</li>
</ul>
<p>ç‚¹å‡»ä¸€ä¸ªå¸§,å¯ä»¥çœ‹åˆ°è¯¥å¸§çš„è¯¦ç»†æ—¶é—´åˆ†è§£,å¿«é€Ÿå®šä½ç“¶é¢ˆåœ¨å“ªä¸ªé˜¶æ®µã€‚</p>
<h3 data-id="heading-20">3.5 Perfetto SQLæŸ¥è¯¢å…¥é—¨</h3>
<p>Perfettoæœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€å°±æ˜¯SQLæŸ¥è¯¢å¼•æ“,å¯ä»¥å¯¹traceæ•°æ®è¿›è¡Œå¤æ‚çš„åˆ†æã€‚</p>
<p><strong>æ‰“å¼€SQLæŸ¥è¯¢ç•Œé¢</strong>:</p>
<ol>
<li>åœ¨Perfetto UIä¸­æ‰“å¼€traceæ–‡ä»¶</li>
<li>ç‚¹å‡»å³ä¸Šè§’çš„"Query (SQL)"æŒ‰é’®</li>
<li>åœ¨SQLç¼–è¾‘å™¨ä¸­è¾“å…¥æŸ¥è¯¢è¯­å¥</li>
</ol>
<p><strong>å¸¸ç”¨è¡¨ç»“æ„</strong>:</p>








































<table><thead><tr><th align="left">è¡¨å</th><th align="left">è¯´æ˜</th><th align="left">ä¸»è¦å­—æ®µ</th></tr></thead><tbody><tr><td align="left"><code>slice</code></td><td align="left">æ‰€æœ‰å‡½æ•°è°ƒç”¨</td><td align="left">ts, dur, name, depth, track_id</td></tr><tr><td align="left"><code>thread</code></td><td align="left">çº¿ç¨‹ä¿¡æ¯</td><td align="left">utid, tid, name, upid</td></tr><tr><td align="left"><code>process</code></td><td align="left">è¿›ç¨‹ä¿¡æ¯</td><td align="left">upid, pid, name</td></tr><tr><td align="left"><code>thread_track</code></td><td align="left">çº¿ç¨‹è½¨é“æ˜ å°„</td><td align="left">id, utid</td></tr><tr><td align="left"><code>sched</code></td><td align="left">CPUè°ƒåº¦ä¿¡æ¯</td><td align="left">ts, dur, cpu, utid</td></tr><tr><td align="left"><code>counter</code></td><td align="left">è®¡æ•°å™¨æ•°æ®</td><td align="left">ts, value, track_id</td></tr></tbody></table>
<p><strong>ç¤ºä¾‹æŸ¥è¯¢</strong>:</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥è¯¢ä¸»çº¿ç¨‹çš„æ‰€æœ‰å‡½æ•°è°ƒç”¨</span>
<span class="hljs-keyword">SELECT</span>
  ts <span class="hljs-operator">/</span> <span class="hljs-number">1e9</span> <span class="hljs-keyword">AS</span> start_sec,
  dur <span class="hljs-operator">/</span> <span class="hljs-number">1e6</span> <span class="hljs-keyword">AS</span> duration_ms,
  name
<span class="hljs-keyword">FROM</span> slice
<span class="hljs-keyword">JOIN</span> thread_track <span class="hljs-keyword">ON</span> slice.track_id <span class="hljs-operator">=</span> thread_track.id
<span class="hljs-keyword">JOIN</span> thread <span class="hljs-keyword">ON</span> thread_track.utid <span class="hljs-operator">=</span> thread.utid
<span class="hljs-keyword">WHERE</span> thread.name <span class="hljs-operator">=</span> <span class="hljs-string">'main'</span>
  <span class="hljs-keyword">AND</span> dur <span class="hljs-operator">&gt;</span> <span class="hljs-number">10e6</span>  <span class="hljs-comment">-- åªçœ‹è€—æ—¶è¶…è¿‡10msçš„</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> dur <span class="hljs-keyword">DESC</span>
LIMIT <span class="hljs-number">20</span>;

<span class="hljs-comment">-- æŸ¥è¯¢GCäº‹ä»¶</span>
<span class="hljs-keyword">SELECT</span>
  ts <span class="hljs-operator">/</span> <span class="hljs-number">1e9</span> <span class="hljs-keyword">AS</span> time_sec,
  dur <span class="hljs-operator">/</span> <span class="hljs-number">1e6</span> <span class="hljs-keyword">AS</span> duration_ms,
  name <span class="hljs-keyword">AS</span> gc_type
<span class="hljs-keyword">FROM</span> slice
<span class="hljs-keyword">WHERE</span> name <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'Heap%'</span> <span class="hljs-keyword">OR</span> name <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'GC%'</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> ts;

<span class="hljs-comment">-- æŸ¥è¯¢CPUä½¿ç”¨ç‡</span>
<span class="hljs-keyword">SELECT</span>
  thread.name,
  <span class="hljs-built_in">SUM</span>(sched.dur) <span class="hljs-operator">/</span> <span class="hljs-number">1e9</span> <span class="hljs-keyword">AS</span> cpu_time_sec
<span class="hljs-keyword">FROM</span> sched
<span class="hljs-keyword">JOIN</span> thread <span class="hljs-keyword">USING</span> (utid)
<span class="hljs-keyword">WHERE</span> thread.name <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%myapp%'</span>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> thread.name
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> cpu_time_sec <span class="hljs-keyword">DESC</span>;
</code></pre>
<p>åç»­ç« èŠ‚æˆ‘ä»¬ä¼šè¯¦ç»†ä»‹ç»æ›´å¤šé«˜çº§æŸ¥è¯¢æŠ€å·§ã€‚</p>
<hr/>
<h2 data-id="heading-21">å››ã€Traceåˆ†æå®æˆ˜</h2>
<p>æŒæ¡äº†å·¥å…·çš„ä½¿ç”¨,æ¥ä¸‹æ¥å°±æ˜¯æœ€æ ¸å¿ƒçš„éƒ¨åˆ†:<strong>å¦‚ä½•åˆ†æTraceæ–‡ä»¶,å¿«é€Ÿå®šä½æ€§èƒ½ç“¶é¢ˆ</strong>ã€‚</p>
<h3 data-id="heading-22">4.1 åˆ†ææ€è·¯æ¡†æ¶</h3>
<p>ä¸ç®¡åˆ†æä»€ä¹ˆæ€§èƒ½é—®é¢˜,éƒ½å¯ä»¥éµå¾ªè¿™ä¸ªç³»ç»ŸåŒ–çš„æ€è·¯:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b996063f5b0b42d4be0aa6e3a516f5a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141495&amp;x-signature=m7bBEV5ht3ordhe0Z%2BRvCFtXdWI%3D" alt="08-05-trace-analysis-flow.png" loading="lazy"/></p>
<h3 data-id="heading-23">4.2 å¸¸è§æ€§èƒ½æŒ‡æ ‡</h3>
<p>åœ¨åˆ†æTraceæ—¶,éœ€è¦å…³æ³¨ä»¥ä¸‹å…³é”®æŒ‡æ ‡:</p>
<p><strong>1. Wall Duration (å¢™ä¸Šæ—¶é—´)</strong></p>
<ul>
<li>å‡½æ•°ä»å¼€å§‹åˆ°ç»“æŸçš„å®é™…æ—¶é—´</li>
<li>åŒ…å«CPUæ‰§è¡Œæ—¶é—´å’Œç­‰å¾…æ—¶é—´</li>
<li><strong>è¿™æ˜¯ç”¨æˆ·æ„ŸçŸ¥åˆ°çš„æ—¶é—´</strong></li>
</ul>
<p><strong>2. CPU Time (CPUæ—¶é—´)</strong></p>
<ul>
<li>å‡½æ•°å®é™…å ç”¨CPUçš„æ—¶é—´</li>
<li>ä¸åŒ…å«ç­‰å¾…ã€ç¡çœ ç­‰æ—¶é—´</li>
<li>å¦‚æœ <code>CPU Time &lt;&lt; Wall Duration</code>,è¯´æ˜å¤§éƒ¨åˆ†æ—¶é—´åœ¨ç­‰å¾…</li>
</ul>
<p><strong>3. Self Time (è‡ªèº«æ—¶é—´)</strong></p>
<ul>
<li>å‡½æ•°è‡ªèº«çš„æ‰§è¡Œæ—¶é—´,ä¸åŒ…å«è°ƒç”¨å­å‡½æ•°çš„æ—¶é—´</li>
<li>ç”¨äºè¯†åˆ«çœŸæ­£çš„ç“¶é¢ˆå‡½æ•°</li>
</ul>
<p><strong>4. Thread State (çº¿ç¨‹çŠ¶æ€)</strong></p>
<ul>
<li><strong>Running (R)</strong>: æ­£åœ¨CPUä¸Šæ‰§è¡Œ</li>
<li><strong>Runnable (R)</strong>: å°±ç»ªçŠ¶æ€,ç­‰å¾…CPUè°ƒåº¦</li>
<li><strong>Sleeping (S)</strong>: ç¡çœ ,ç­‰å¾…äº‹ä»¶</li>
<li><strong>Uninterruptible Sleep (D)</strong>: ä¸å¯ä¸­æ–­ç¡çœ ,é€šå¸¸æ˜¯I/Oç­‰å¾…</li>
<li><strong>Stopped (T)</strong>: åœæ­¢çŠ¶æ€</li>
</ul>
<p><strong>å¸§æ¸²æŸ“æŒ‡æ ‡</strong>:</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">ä¸€å¸§çš„ç†æƒ³æ—¶é—´åˆ†é…</span> <span class="hljs-string">(60fps,</span> <span class="hljs-number">16.</span><span class="hljs-string">6ms):</span>
<span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">Input:</span>        <span class="hljs-number">2</span><span class="hljs-string">-3ms</span>    <span class="hljs-string">â”‚</span>  <span class="hljs-string">å¤„ç†è§¦æ‘¸äº‹ä»¶</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">Animation:</span>    <span class="hljs-number">1</span><span class="hljs-string">-2ms</span>    <span class="hljs-string">â”‚</span>  <span class="hljs-string">æ‰§è¡ŒåŠ¨ç”»</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">Measure:</span>      <span class="hljs-number">2</span><span class="hljs-string">-3ms</span>    <span class="hljs-string">â”‚</span>  <span class="hljs-string">æµ‹é‡Viewå°ºå¯¸</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">Layout:</span>       <span class="hljs-number">1</span><span class="hljs-string">-2ms</span>    <span class="hljs-string">â”‚</span>  <span class="hljs-string">å¸ƒå±€Viewä½ç½®</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">Draw:</span>         <span class="hljs-number">2</span><span class="hljs-string">-3ms</span>    <span class="hljs-string">â”‚</span>  <span class="hljs-string">ç»˜åˆ¶View</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">RenderThread:</span> <span class="hljs-number">4</span><span class="hljs-string">-5ms</span>    <span class="hljs-string">â”‚</span>  <span class="hljs-string">æ¸²æŸ“çº¿ç¨‹å¤„ç†</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">GPU:</span>          <span class="hljs-number">2</span><span class="hljs-string">-3ms</span>    <span class="hljs-string">â”‚</span>  <span class="hljs-string">GPUæ¸²æŸ“</span>
<span class="hljs-string">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">Total:</span>       <span class="hljs-number">14</span><span class="hljs-string">-18ms</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">æ€»è€—æ—¶</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre>
<h3 data-id="heading-24">4.3 æ¡ˆä¾‹1: å¯åŠ¨æ€§èƒ½åˆ†æ</h3>
<p><strong>åœºæ™¯</strong>: ä¸€ä¸ªç¤¾äº¤Appå¯åŠ¨éœ€è¦2.8ç§’,éœ€è¦ä¼˜åŒ–åˆ°1.5ç§’ä»¥å†…ã€‚</p>
<p><strong>Step 1: æŠ“å–å¯åŠ¨Trace</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ¸…ç†æ•°æ®</span>
adb shell pm clear com.example.social

<span class="hljs-comment"># æŠ“å–trace</span>
python systrace.py -o launch.html -t 15 -a com.example.social \
  <span class="hljs-built_in">sched</span> freq am wm gfx view dalvik input res app

<span class="hljs-comment"># å¯åŠ¨åº”ç”¨</span>
adb shell am start -W com.example.social/.MainActivity
</code></pre>
<p><strong>Step 2: æ‰“å¼€Trace,å®šä½å…³é”®æ—¶é—´ç‚¹</strong></p>
<p>åœ¨Traceä¸­æœç´¢å…³é”®äº‹ä»¶:</p>
<pre><code class="hljs language-ini" lang="ini">æœç´¢ "activityStart"  â†’ æ‰¾åˆ°å¯åŠ¨å¼€å§‹ç‚¹ (T0)
æœç´¢ "Choreographer<span class="hljs-comment">#doFrame" â†’ æ‰¾åˆ°é¦–å¸§ç»˜åˆ¶ (T1)</span>

æ€»å¯åŠ¨æ—¶é—´: T1 - <span class="hljs-attr">T0</span> = <span class="hljs-number">2850</span>ms
</code></pre>
<p><strong>Step 3: åˆ†æä¸»çº¿ç¨‹æ—¶é—´åˆ†å¸ƒ</strong></p>
<p>æ”¾å¤§ä¸»çº¿ç¨‹,æŸ¥çœ‹å„ä¸ªé˜¶æ®µ:</p>
<pre><code class="hljs language-r" lang="r">Timeline<span class="hljs-operator">:</span>
T0     Application.onCreate<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span>        <span class="hljs-number">450</span>ms
       â”œâ”€ SDKåˆå§‹åŒ–                   <span class="hljs-number">280</span>ms  â† âš ï¸ ç“¶é¢ˆ<span class="hljs-number">1</span>
       â”œâ”€ æ•°æ®åº“åˆå§‹åŒ–                 <span class="hljs-number">120</span>ms
       â””â”€ å…¶ä»–                         <span class="hljs-number">50</span>ms

<span class="hljs-built_in">T</span><span class="hljs-operator">+</span><span class="hljs-number">450</span>  Activity.onCreate<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span>           <span class="hljs-number">380</span>ms
       â”œâ”€ setContentView<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span>            <span class="hljs-number">80</span>ms
       â”œâ”€ loadUserInfo<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">(</span>ç½‘ç»œè¯·æ±‚<span class="hljs-punctuation">)</span>   <span class="hljs-number">200</span>ms  â† âš ï¸ ç“¶é¢ˆ<span class="hljs-number">2</span> <span class="hljs-punctuation">(</span>ä¸»çº¿ç¨‹<span class="hljs-operator">!</span><span class="hljs-punctuation">)</span>
       â””â”€ RecyclerView.init<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span>         <span class="hljs-number">100</span>ms

<span class="hljs-built_in">T</span><span class="hljs-operator">+</span><span class="hljs-number">830</span>  onResume<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span>                     <span class="hljs-number">50</span>ms

<span class="hljs-built_in">T</span><span class="hljs-operator">+</span><span class="hljs-number">880</span>  é¦–å¸§æµ‹é‡å¸ƒå±€ç»˜åˆ¶                 <span class="hljs-number">150</span>ms

<span class="hljs-built_in">T</span><span class="hljs-operator">+</span><span class="hljs-number">1030</span> RenderThreadæ¸²æŸ“               <span class="hljs-number">80</span>ms

<span class="hljs-built_in">T</span><span class="hljs-operator">+</span><span class="hljs-number">1110</span> ç­‰å¾…ç½‘ç»œæ•°æ®                    <span class="hljs-number">1600</span>ms â† âš ï¸ ç“¶é¢ˆ<span class="hljs-number">3</span>
       <span class="hljs-punctuation">(</span>ä¸»çº¿ç¨‹åœ¨sleep<span class="hljs-operator">!</span><span class="hljs-punctuation">)</span>

<span class="hljs-built_in">T</span><span class="hljs-operator">+</span><span class="hljs-number">2710</span> åˆ·æ–°UI                         <span class="hljs-number">140</span>ms

<span class="hljs-built_in">T</span><span class="hljs-operator">+</span><span class="hljs-number">2850</span> å¯åŠ¨å®Œæˆ
</code></pre>
<p><strong>Step 4: æ ¹å› åˆ†æ</strong></p>
<p><strong>ç“¶é¢ˆ1: SDKåˆå§‹åŒ– 280ms</strong></p>
<ul>
<li>ç‚¹å‡»"SDKåˆå§‹åŒ–"slice,æŸ¥çœ‹å †æ ˆ</li>
<li>å‘ç°æ˜¯ç¬¬ä¸‰æ–¹ç»Ÿè®¡SDKåœ¨åšç½‘ç»œè¯·æ±‚</li>
<li><strong>ä¼˜åŒ–æ–¹æ¡ˆ</strong>: å»¶è¿Ÿåˆ°åå°åˆå§‹åŒ–</li>
</ul>
<p><strong>ç“¶é¢ˆ2: ä¸»çº¿ç¨‹ç½‘ç»œè¯·æ±‚ 200ms</strong></p>
<ul>
<li>loadUserInfo()åœ¨ä¸»çº¿ç¨‹æ‰§è¡ŒåŒæ­¥ç½‘ç»œè¯·æ±‚</li>
<li><strong>ä¼˜åŒ–æ–¹æ¡ˆ</strong>: æ”¹ä¸ºå¼‚æ­¥è¯·æ±‚,ä½¿ç”¨ç¼“å­˜æ•°æ®å…ˆå±•ç¤º</li>
</ul>
<p><strong>ç“¶é¢ˆ3: ç­‰å¾…ç½‘ç»œæ•°æ® 1600ms</strong></p>
<ul>
<li>ä¸»çº¿ç¨‹åœ¨ç­‰å¾…æœåŠ¡å™¨è¿”å›</li>
<li><strong>ä¼˜åŒ–æ–¹æ¡ˆ</strong>: ä½¿ç”¨æœ¬åœ°ç¼“å­˜,å¼‚æ­¥åˆ·æ–°</li>
</ul>
<p><strong>Step 5: ä¼˜åŒ–åéªŒè¯</strong></p>
<p>ä¼˜åŒ–åå†æ¬¡æŠ“å–trace:</p>
<pre><code class="hljs language-scss" lang="scss">Timeline (ä¼˜åŒ–å):
T0     Application.<span class="hljs-built_in">onCreate</span>()        <span class="hljs-number">120ms</span>  â† å‡å°‘<span class="hljs-number">330ms</span>
       â”œâ”€ å…³é”®åˆå§‹åŒ–                   <span class="hljs-number">70ms</span>
       â””â”€ å…¶ä»–                         <span class="hljs-number">50ms</span>

T+<span class="hljs-number">120</span>  Activity.<span class="hljs-built_in">onCreate</span>()           <span class="hljs-number">180ms</span>  â† å‡å°‘<span class="hljs-number">200ms</span>
       â”œâ”€ <span class="hljs-built_in">setContentView</span>()            <span class="hljs-number">80ms</span>
       â”œâ”€ ä»ç¼“å­˜åŠ è½½ç”¨æˆ·ä¿¡æ¯            <span class="hljs-number">30ms</span>
       â””â”€ RecyclerView.<span class="hljs-built_in">init</span>()         <span class="hljs-number">70ms</span>

T+<span class="hljs-number">300</span>  <span class="hljs-built_in">onResume</span>()                     <span class="hljs-number">50ms</span>

T+<span class="hljs-number">350</span>  é¦–å¸§æµ‹é‡å¸ƒå±€ç»˜åˆ¶                 <span class="hljs-number">150ms</span>

T+<span class="hljs-number">500</span>  RenderThreadæ¸²æŸ“               <span class="hljs-number">80ms</span>

T+<span class="hljs-number">580</span>  å¯åŠ¨å®Œæˆ (æ˜¾ç¤ºç¼“å­˜æ•°æ®)
       åå°å¼‚æ­¥æ›´æ–°æ•°æ®...

æ€»å¯åŠ¨æ—¶é—´: <span class="hljs-number">580ms</span> âœ… è¾¾æˆç›®æ ‡!
</code></pre>
<p><strong>ä¼˜åŒ–æ•ˆæœ</strong>:</p>
<ul>
<li>å¯åŠ¨æ—¶é—´ä» 2850ms â†’ 580ms</li>
<li>æå‡äº† <strong>79.6%</strong></li>
<li>ç”¨æˆ·ä½“éªŒæ˜¾è‘—æ”¹å–„</li>
</ul>
<h3 data-id="heading-25">4.4 æ¡ˆä¾‹2: å¡é¡¿åˆ†æ</h3>
<p><strong>åœºæ™¯</strong>: RecyclerViewæ»‘åŠ¨æ—¶ç»å¸¸æ‰å¸§,ä½“éªŒå¾ˆå¡ã€‚</p>
<p><strong>Step 1: æŠ“å–æ»‘åŠ¨Trace</strong></p>
<pre><code class="hljs language-bash" lang="bash">python systrace.py -o scroll.html -t 10 -a com.example.social \
  <span class="hljs-built_in">sched</span> gfx view input wm dalvik app
</code></pre>
<p>æŠ“å–æ—¶åœ¨Appä¸­å¿«é€Ÿæ»‘åŠ¨åˆ—è¡¨ã€‚</p>
<p><strong>Step 2: æŸ¥çœ‹Frame Timeline</strong></p>
<p>åœ¨Perfettoä¸­æ‰“å¼€trace,æŸ¥çœ‹Framesè½¨é“:</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">Frame Timeline:</span>
<span class="hljs-string">Frame</span> <span class="hljs-comment">#100: 16ms  âœ… ç»¿è‰²</span>
<span class="hljs-string">Frame</span> <span class="hljs-comment">#101: 17ms  âš ï¸ é»„è‰² (è½»å¾®æ‰å¸§)</span>
<span class="hljs-string">Frame</span> <span class="hljs-comment">#102: 34ms  âŒ çº¢è‰² (æ‰1å¸§)</span>
<span class="hljs-string">Frame</span> <span class="hljs-comment">#103: 18ms  âš ï¸ é»„è‰²</span>
<span class="hljs-string">Frame</span> <span class="hljs-comment">#104: 52ms  âŒâŒ çº¢è‰² (æ‰2å¸§)</span>
</code></pre>
<p><strong>Step 3: åˆ†ææ‰å¸§çš„Frame</strong></p>
<p>ç‚¹å‡»Frame #104 (52msçš„é‚£ä¸€å¸§),æŸ¥çœ‹è¯¦æƒ…:</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">Frame</span> <span class="hljs-comment">#104 è¯¦ç»†åˆ†æ:</span>
<span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">Expected:</span> <span class="hljs-number">16.</span><span class="hljs-string">6ms</span>                     <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">Actual:</span> <span class="hljs-string">52ms</span> <span class="hljs-string">(æ‰3å¸§!)</span>                <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">Input:</span>             <span class="hljs-string">2ms</span>   <span class="hljs-string">â–ˆâ–ˆ</span>          <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">Animation:</span>         <span class="hljs-string">1ms</span>   <span class="hljs-string">â–ˆ</span>           <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">Measure:</span>           <span class="hljs-string">3ms</span>   <span class="hljs-string">â–ˆâ–ˆâ–ˆ</span>         <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">Layout:</span>            <span class="hljs-string">2ms</span>   <span class="hljs-string">â–ˆâ–ˆ</span>          <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">Draw:</span>              <span class="hljs-string">4ms</span>   <span class="hljs-string">â–ˆâ–ˆâ–ˆâ–ˆ</span>        <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-string">RecyclerView.</span>      <span class="hljs-string">35ms</span>  <span class="hljs-string">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span> <span class="hljs-string">â”‚</span> <span class="hljs-string">â†</span> <span class="hljs-string">âš ï¸</span> <span class="hljs-string">ç“¶é¢ˆ!</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">onBindViewHolder</span>                   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span> <span class="hljs-attr">RenderThread:</span>      <span class="hljs-string">5ms</span>   <span class="hljs-string">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>       <span class="hljs-string">â”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre>
<p><strong>Step 4: æ·±å…¥åˆ†æonBindViewHolder</strong></p>
<p>ç‚¹å‡»"onBindViewHolder"slice,æŸ¥çœ‹å †æ ˆ:</p>
<pre><code class="hljs language-java" lang="java">onBindViewHolder (35ms)
  â”œâ”€ loadImage() (20ms)           â† âš ï¸ ä¸»çº¿ç¨‹åŠ è½½å›¾ç‰‡
  â”‚   â”œâ”€ decodeFile() (18ms)      â† è§£ç è€—æ—¶
  â”‚   â””â”€ å…¶ä»– (2ms)
  â”œâ”€ setText() (8ms)
  â”‚   â””â”€ measureText() (7ms)      â† å¤æ‚æ–‡æœ¬æµ‹é‡
  â””â”€ å…¶ä»– (7ms)
</code></pre>
<p><strong>Step 5: æ ¹å› ä¸ä¼˜åŒ–</strong></p>
<p><strong>é—®é¢˜1: ä¸»çº¿ç¨‹åŠ è½½å›¾ç‰‡ 20ms</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ã€ä¼˜åŒ–å‰ã€‘- ä¸»çº¿ç¨‹åŒæ­¥åŠ è½½</span>
override fun <span class="hljs-title function_">onBindViewHolder</span><span class="hljs-params">(holder: ViewHolder, position: Int)</span> {
    <span class="hljs-type">val</span> <span class="hljs-variable">bitmap</span> <span class="hljs-operator">=</span> BitmapFactory.decodeFile(imagePath)  <span class="hljs-comment">// âš ï¸ ä¸»çº¿ç¨‹è§£ç !</span>
    holder.imageView.setImageBitmap(bitmap)
}

<span class="hljs-comment">// ã€ä¼˜åŒ–åã€‘- ä½¿ç”¨Glideå¼‚æ­¥åŠ è½½</span>
override fun <span class="hljs-title function_">onBindViewHolder</span><span class="hljs-params">(holder: ViewHolder, position: Int)</span> {
    Glide.with(context)
        .load(imagePath)
        .placeholder(R.drawable.placeholder)
        .into(holder.imageView)
}
</code></pre>
<p><strong>é—®é¢˜2: å¤æ‚æ–‡æœ¬æµ‹é‡ 7ms</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ã€ä¼˜åŒ–å‰ã€‘- æ¯æ¬¡éƒ½æµ‹é‡</span>
textView.text = SpannableString(text).apply {
    setSpan(ForegroundColorSpan(color), <span class="hljs-number">0</span>, length, <span class="hljs-number">0</span>)
    setSpan(AbsoluteSizeSpan(<span class="hljs-number">20</span>), <span class="hljs-number">0</span>, length, <span class="hljs-number">0</span>)
    <span class="hljs-comment">// å¤šä¸ªspanå¯¼è‡´å¤æ‚æµ‹é‡</span>
}

<span class="hljs-comment">// ã€ä¼˜åŒ–åã€‘- ç¼“å­˜æµ‹é‡ç»“æœ</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">val</span> <span class="hljs-variable">spannableCache</span> <span class="hljs-operator">=</span> LruCache&lt;String, SpannableString&gt;(<span class="hljs-number">100</span>)

fun <span class="hljs-title function_">getSpannable</span><span class="hljs-params">(text: String)</span>: SpannableString {
    <span class="hljs-keyword">return</span> spannableCache.get(text) ?: createSpannable(text).also {
        spannableCache.put(text, it)
    }
}
</code></pre>
<p><strong>ä¼˜åŒ–åéªŒè¯</strong>:</p>
<pre><code class="hljs language-makefile" lang="makefile">Frame Timeline (ä¼˜åŒ–å):
Frame <span class="hljs-comment">#100: 15ms  âœ… ç»¿è‰²</span>
Frame <span class="hljs-comment">#101: 16ms  âœ… ç»¿è‰²</span>
Frame <span class="hljs-comment">#102: 14ms  âœ… ç»¿è‰²</span>
Frame <span class="hljs-comment">#103: 17ms  âš ï¸ é»„è‰² (å¶å°”)</span>
Frame <span class="hljs-comment">#104: 16ms  âœ… ç»¿è‰²</span>

<span class="hljs-section">å¹³å‡å¸§æ—¶é—´: 16ms</span>
<span class="hljs-section">æ‰å¸§ç‡: &lt; 5%  âœ… è¾¾æˆç›®æ ‡!</span>
</code></pre>
<h3 data-id="heading-26">4.5 æ¡ˆä¾‹3: CPUå ç”¨åˆ†æ</h3>
<p><strong>åœºæ™¯</strong>: Appåœ¨åå°CPUå ç”¨é«˜è¾¾30%,å¯¼è‡´è€—ç”µå¿«ã€‚</p>
<p><strong>Step 1: æŠ“å–åå°è¿è¡ŒTrace</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨PerfettoæŠ“å–,åŒ…å«CPUå’Œç”µé‡æ•°æ®</span>
<span class="hljs-comment"># åœ¨ui.perfetto.devé…ç½®:</span>
<span class="hljs-comment"># - Duration: 30s</span>
<span class="hljs-comment"># - Probes: Scheduling, CPU frequency, Battery</span>
</code></pre>
<p><strong>Step 2: ä½¿ç”¨SQLæŸ¥è¯¢åˆ†æCPUå ç”¨</strong></p>
<p>åœ¨Perfetto SQLç•Œé¢è¾“å…¥:</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥è¯¢å„çº¿ç¨‹çš„CPUå ç”¨æ—¶é—´</span>
<span class="hljs-keyword">SELECT</span>
  thread.name <span class="hljs-keyword">AS</span> thread_name,
  process.name <span class="hljs-keyword">AS</span> process_name,
  <span class="hljs-built_in">SUM</span>(sched.dur) <span class="hljs-operator">/</span> <span class="hljs-number">1e9</span> <span class="hljs-keyword">AS</span> cpu_time_seconds,
  <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> schedule_count
<span class="hljs-keyword">FROM</span> sched
<span class="hljs-keyword">JOIN</span> thread <span class="hljs-keyword">USING</span> (utid)
<span class="hljs-keyword">JOIN</span> process <span class="hljs-keyword">USING</span> (upid)
<span class="hljs-keyword">WHERE</span> process.name <span class="hljs-operator">=</span> <span class="hljs-string">'com.example.social'</span>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> thread.utid
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> cpu_time_seconds <span class="hljs-keyword">DESC</span>
LIMIT <span class="hljs-number">20</span>;
</code></pre>
<p><strong>æŸ¥è¯¢ç»“æœ</strong>:</p>
<pre><code class="hljs language-css" lang="css">thread_name              cpu_time_seconds  schedule_count
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
BackgroundWorker         <span class="hljs-number">8.2</span>               <span class="hljs-number">1245</span>          â† âš ï¸ å¼‚å¸¸!
<span class="hljs-selector-tag">main</span>                     <span class="hljs-number">2.1</span>               <span class="hljs-number">856</span>
RenderThread             <span class="hljs-number">0.8</span>               <span class="hljs-number">234</span>
binder:<span class="hljs-number">12345</span>_1           <span class="hljs-number">0.5</span>               <span class="hljs-number">123</span>
...
</code></pre>
<p><strong>Step 3: åˆ†æBackgroundWorkerçº¿ç¨‹</strong></p>
<p>æœç´¢"BackgroundWorker",æ”¾å¤§æŸ¥çœ‹:</p>
<pre><code class="hljs language-makefile" lang="makefile">BackgroundWorker Timeline:
<span class="hljs-section">00:00 - 00:02  è¿è¡Œ (å¤„ç†æ•°æ®)     2s</span>
<span class="hljs-section">00:02 - 00:02  ç¡çœ                0.1s</span>
<span class="hljs-section">00:02 - 00:04  è¿è¡Œ (å¤„ç†æ•°æ®)     2s</span>
<span class="hljs-section">00:04 - 00:04  ç¡çœ                0.1s</span>
<span class="hljs-section">00:04 - 00:06  è¿è¡Œ (å¤„ç†æ•°æ®)     2s</span>
...
(æ¯éš”0.1ç§’å”¤é†’ä¸€æ¬¡,å¤„ç†2ç§’!)
</code></pre>
<p><strong>Step 4: æŸ¥çœ‹æºç å®šä½é—®é¢˜</strong></p>
<p>æŸ¥çœ‹å †æ ˆ,æ‰¾åˆ°å¯¹åº”ä»£ç :</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ã€é—®é¢˜ä»£ç ã€‘</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">BackgroundWorker</span> : <span class="hljs-type">Thread</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">run</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            processData()  <span class="hljs-comment">// è€—æ—¶æ“ä½œ</span>
            Thread.sleep(<span class="hljs-number">100</span>)  <span class="hljs-comment">// åªç¡çœ 0.1ç§’!</span>
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">processData</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// å¤„ç†å¤§é‡æ•°æ®,è€—æ—¶2ç§’</span>
        <span class="hljs-keyword">val</span> <span class="hljs-keyword">data</span> = loadDataFromDB()
        analyzeData(<span class="hljs-keyword">data</span>)
        saveResult(<span class="hljs-keyword">data</span>)
    }
}
</code></pre>
<p><strong>é—®é¢˜æ ¹å› </strong>:</p>
<ul>
<li>åå°çº¿ç¨‹æ¯0.1ç§’å”¤é†’ä¸€æ¬¡</li>
<li>æ¯æ¬¡æ‰§è¡Œè€—æ—¶2ç§’çš„æ•°æ®å¤„ç†</li>
<li>å®é™…ä¸Šè¿™ä¸ªä»»åŠ¡æ ¹æœ¬ä¸éœ€è¦è¿™ä¹ˆé¢‘ç¹</li>
</ul>
<p><strong>Step 5: ä¼˜åŒ–æ–¹æ¡ˆ</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ã€ä¼˜åŒ–åã€‘</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">BackgroundWorker</span> : <span class="hljs-type">Thread</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">run</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            processData()
            Thread.sleep(<span class="hljs-number">300_000</span>)  <span class="hljs-comment">// æ”¹ä¸º5åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡</span>
        }
    }
}

<span class="hljs-comment">// ã€æ›´å¥½çš„æ–¹æ¡ˆã€‘ä½¿ç”¨WorkManager</span>
<span class="hljs-keyword">val</span> workRequest = PeriodicWorkRequestBuilder&lt;DataProcessor&gt;(
    <span class="hljs-number">15</span>, TimeUnit.MINUTES  <span class="hljs-comment">// æ¯15åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡</span>
).build()

WorkManager.getInstance(context).enqueue(workRequest)
</code></pre>
<p><strong>ä¼˜åŒ–æ•ˆæœ</strong>:</p>
<pre><code class="hljs language-diff" lang="diff">ä¼˜åŒ–å‰:
<span class="hljs-deletion">- åå°CPUå ç”¨: 30%</span>
<span class="hljs-deletion">- 30ç§’å†…CPUæ—¶é—´: 8.2ç§’</span>
<span class="hljs-deletion">- ç”µé‡æ¶ˆè€—: é«˜</span>

ä¼˜åŒ–å:
<span class="hljs-deletion">- åå°CPUå ç”¨: &lt; 1%</span>
<span class="hljs-deletion">- 30ç§’å†…CPUæ—¶é—´: 0.1ç§’</span>
<span class="hljs-deletion">- ç”µé‡æ¶ˆè€—: æ­£å¸¸</span>
</code></pre>
<hr/>
<h2 data-id="heading-27">äº”ã€ä»£ç æ’æ¡©:è‡ªå®šä¹‰Traceäº‹ä»¶</h2>
<p>æœ‰æ—¶å€™ç³»ç»Ÿé»˜è®¤çš„traceä¿¡æ¯ä¸å¤Ÿè¯¦ç»†,æˆ‘ä»¬éœ€è¦åœ¨è‡ªå·±çš„ä»£ç ä¸­æ·»åŠ traceæ ‡è®°,è¿™å°±æ˜¯<strong>ä»£ç æ’æ¡©</strong>(Instrumentation)ã€‚</p>
<h3 data-id="heading-28">5.1 Java/Kotlinä»£ç æ’æ¡©</h3>
<p>ä½¿ç”¨<code>android.os.Trace</code> APIæ·»åŠ traceæ ‡è®°:</p>
<p><strong>åŸºç¡€ç”¨æ³•</strong>:</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> android.os.Trace

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        Trace.beginSection(<span class="hljs-string">"MyActivity.onCreate"</span>)
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)

        Trace.beginSection(<span class="hljs-string">"InitData"</span>)
        initData()
        Trace.endSection()

        Trace.beginSection(<span class="hljs-string">"SetupUI"</span>)
        setupUI()
        Trace.endSection()

        Trace.endSection() <span class="hljs-comment">// MyActivity.onCreate</span>
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initData</span><span class="hljs-params">()</span></span> {
        Trace.beginSection(<span class="hljs-string">"LoadConfig"</span>)
        loadConfig()
        Trace.endSection()

        Trace.beginSection(<span class="hljs-string">"ConnectDB"</span>)
        connectDatabase()
        Trace.endSection()
    }
}
</code></pre>
<p><strong>æ³¨æ„äº‹é¡¹</strong>:</p>
<ul>
<li>âš ï¸ <code>beginSection()</code>å’Œ<code>endSection()</code>å¿…é¡»æˆå¯¹å‡ºç°</li>
<li>âš ï¸ å¿…é¡»åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­è°ƒç”¨</li>
<li>âš ï¸ Sectionåç§°æœ€é•¿127ä¸ªå­—ç¬¦</li>
<li>âš ï¸ åµŒå¥—æ·±åº¦æœ‰é™åˆ¶(é€šå¸¸ä¸è¶…è¿‡20å±‚)</li>
</ul>
<p><strong>ä½¿ç”¨æ‰©å±•å‡½æ•°ç®€åŒ–</strong>:</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å®šä¹‰æ‰©å±•å‡½æ•°</span>
<span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">trace</span><span class="hljs-params">(sectionName: <span class="hljs-type">String</span>, block: () -&gt; <span class="hljs-type">T</span>)</span></span>: T {
    Trace.beginSection(sectionName)
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">return</span> block()
    } <span class="hljs-keyword">finally</span> {
        Trace.endSection()
    }
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
    trace(<span class="hljs-string">"MyActivity.onCreate"</span>) {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)

        trace(<span class="hljs-string">"InitData"</span>) {
            initData()
        }

        trace(<span class="hljs-string">"SetupUI"</span>) {
            setupUI()
        }
    }
}
</code></pre>
<h3 data-id="heading-29">5.2 Nativeä»£ç æ’æ¡©</h3>
<p>å¯¹äºC/C++ä»£ç ,ä½¿ç”¨<code>&lt;cutils/trace.h&gt;</code>å¤´æ–‡ä»¶:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cutils/trace.h&gt;</span></span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyNativeClass</span> {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">expensiveOperation</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-built_in">ATRACE_CALL</span>();  <span class="hljs-comment">// è‡ªåŠ¨è·Ÿè¸ªæ•´ä¸ªå‡½æ•°</span>

        <span class="hljs-built_in">ATRACE_BEGIN</span>(<span class="hljs-string">"LoadData"</span>);
        <span class="hljs-built_in">loadData</span>();
        <span class="hljs-built_in">ATRACE_END</span>();

        <span class="hljs-built_in">ATRACE_BEGIN</span>(<span class="hljs-string">"ProcessData"</span>);
        <span class="hljs-built_in">processData</span>();
        <span class="hljs-built_in">ATRACE_END</span>();

        <span class="hljs-built_in">ATRACE_BEGIN</span>(<span class="hljs-string">"SaveResult"</span>);
        <span class="hljs-built_in">saveResult</span>();
        <span class="hljs-built_in">ATRACE_END</span>();
    }

<span class="hljs-keyword">private</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">loadData</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-built_in">ATRACE_CALL</span>();  <span class="hljs-comment">// è·Ÿè¸ªloadDataå‡½æ•°</span>
        <span class="hljs-comment">// ... åŠ è½½æ•°æ®</span>
    }

    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">processData</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-built_in">ATRACE_CALL</span>();
        <span class="hljs-comment">// ... å¤„ç†æ•°æ®</span>
    }
};
</code></pre>
<p><strong>Android.mké…ç½®</strong>:</p>
<pre><code class="hljs language-makefile" lang="makefile">LOCAL_SHARED_LIBRARIES := libcutils
</code></pre>
<p><strong>CMakeé…ç½®</strong>:</p>
<pre><code class="hljs language-cmake" lang="cmake">target_link_libraries(mynative cutils)
</code></pre>
<h3 data-id="heading-30">5.3 å¼‚æ­¥äº‹ä»¶è·Ÿè¸ª</h3>
<p>å¯¹äºå¼‚æ­¥æ“ä½œ(å¦‚ç½‘ç»œè¯·æ±‚ã€å›¾ç‰‡åŠ è½½),ä½¿ç”¨å¼‚æ­¥trace:</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ImageLoader</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> cookie = <span class="hljs-number">0</span>

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadImageAsync</span><span class="hljs-params">(url: <span class="hljs-type">String</span>, callback: (<span class="hljs-type">Bitmap</span>) -&gt; <span class="hljs-type">Unit</span>)</span></span> {
        <span class="hljs-keyword">val</span> currentCookie = cookie++
        Trace.beginAsyncSection(<span class="hljs-string">"LoadImage-<span class="hljs-variable">$url</span>"</span>, currentCookie)

        thread {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">val</span> bitmap = downloadAndDecode(url)

                runOnUiThread {
                    Trace.endAsyncSection(<span class="hljs-string">"LoadImage-<span class="hljs-variable">$url</span>"</span>, currentCookie)
                    callback(bitmap)
                }
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                Trace.endAsyncSection(<span class="hljs-string">"LoadImage-<span class="hljs-variable">$url</span>"</span>, currentCookie)
                Log.e(TAG, <span class="hljs-string">"Failed to load image"</span>, e)
            }
        }
    }
}
</code></pre>
<p><strong>åœ¨Traceä¸­çš„å±•ç¤º</strong>:</p>
<pre><code class="hljs language-css" lang="css">Timeline:
T0    <span class="hljs-built_in">beginAsyncSection</span>(<span class="hljs-string">"LoadImage"</span>, <span class="hljs-number">123</span>)
      |
      |  (ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œå…¶ä»–æ“ä½œ)
      |
T+<span class="hljs-number">200</span> <span class="hljs-built_in">endAsyncSection</span>(<span class="hljs-string">"LoadImage"</span>, <span class="hljs-number">123</span>)

åœ¨Traceä¸­ä¼šæ˜¾ç¤ºä¸€æ¡æ¨ªè·¨<span class="hljs-number">200ms</span>çš„å¼‚æ­¥slice
</code></pre>
<h3 data-id="heading-31">5.4 Counterè·Ÿè¸ª</h3>
<p>è·Ÿè¸ªæ•°å€¼å˜åŒ–(å¦‚å†…å­˜ä½¿ç”¨ã€é˜Ÿåˆ—é•¿åº¦):</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TaskQueue</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> queue = ConcurrentLinkedQueue&lt;Task&gt;()

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">enqueue</span><span class="hljs-params">(task: <span class="hljs-type">Task</span>)</span></span> {
        queue.add(task)
        Trace.setCounter(<span class="hljs-string">"TaskQueue.size"</span>, queue.size.toLong())
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">dequeue</span><span class="hljs-params">()</span></span>: Task? {
        <span class="hljs-keyword">val</span> task = queue.poll()
        Trace.setCounter(<span class="hljs-string">"TaskQueue.size"</span>, queue.size.toLong())
        <span class="hljs-keyword">return</span> task
    }
}
</code></pre>
<p>åœ¨Traceä¸­ä¼šæ˜¾ç¤ºä¸€æ¡æŠ˜çº¿å›¾,å®æ—¶å±•ç¤ºé˜Ÿåˆ—å¤§å°çš„å˜åŒ–ã€‚</p>
<h3 data-id="heading-32">5.5 æœ€ä½³å®è·µ</h3>
<p><strong>1. åˆç†å‘½å</strong>:</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âŒ ä¸å¥½çš„å‘½å</span>
Trace.beginSection(<span class="hljs-string">"func1"</span>)

<span class="hljs-comment">// âœ… å¥½çš„å‘½å</span>
Trace.beginSection(<span class="hljs-string">"UserRepository.loadProfile"</span>)
</code></pre>
<p><strong>2. æ§åˆ¶ç²’åº¦</strong>:</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âŒ å¤ªç»†ç²’åº¦ (æ¯ä¸ªå°å‡½æ•°éƒ½trace)</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">processData</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">List</span>&lt;<span class="hljs-type">Item</span>&gt;)</span></span> {
    Trace.beginSection(<span class="hljs-string">"processData"</span>)
    <span class="hljs-keyword">for</span> (item <span class="hljs-keyword">in</span> <span class="hljs-keyword">data</span>) {
        Trace.beginSection(<span class="hljs-string">"processItem"</span>)  <span class="hljs-comment">// ä¸å¿…è¦</span>
        process(item)
        Trace.endSection()
    }
    Trace.endSection()
}

<span class="hljs-comment">// âœ… åˆé€‚çš„ç²’åº¦</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">processData</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">List</span>&lt;<span class="hljs-type">Item</span>&gt;)</span></span> {
    Trace.beginSection(<span class="hljs-string">"processData"</span>)
    <span class="hljs-keyword">for</span> (item <span class="hljs-keyword">in</span> <span class="hljs-keyword">data</span>) {
        process(item)  <span class="hljs-comment">// ä¸éœ€è¦æ¯ä¸ªiteméƒ½trace</span>
    }
    Trace.endSection()
}
</code></pre>
<p><strong>3. Releaseç‰ˆæœ¬ä¼˜åŒ–</strong>:</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// åœ¨releaseç‰ˆæœ¬ä¸­ç¦ç”¨traceä»¥å‡å°‘å¼€é”€</span>
<span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">traceDebug</span><span class="hljs-params">(sectionName: <span class="hljs-type">String</span>, block: () -&gt; <span class="hljs-type">Unit</span>)</span></span> {
    <span class="hljs-keyword">if</span> (BuildConfig.DEBUG) {
        Trace.beginSection(sectionName)
        <span class="hljs-keyword">try</span> {
            block()
        } <span class="hljs-keyword">finally</span> {
            Trace.endSection()
        }
    } <span class="hljs-keyword">else</span> {
        block()
    }
}
</code></pre>
<p><strong>4. å…³é”®è·¯å¾„ä¼˜å…ˆ</strong>:
ä¼˜å…ˆåœ¨ä»¥ä¸‹åœºæ™¯æ·»åŠ trace:</p>
<ul>
<li>âœ… å¯åŠ¨æµç¨‹çš„å…³é”®æ­¥éª¤</li>
<li>âœ… ç½‘ç»œè¯·æ±‚çš„å„ä¸ªé˜¶æ®µ</li>
<li>âœ… æ•°æ®åº“æ“ä½œ</li>
<li>âœ… å›¾ç‰‡åŠ è½½å’Œè§£ç </li>
<li>âœ… å¤æ‚è®¡ç®—</li>
<li>âœ… RecyclerViewçš„bindæ“ä½œ</li>
</ul>
<hr/>
<h2 data-id="heading-33">å…­ã€è¿›é˜¶æŠ€å·§</h2>
<h3 data-id="heading-34">6.1 Perfettoé«˜çº§SQLæŸ¥è¯¢</h3>
<p><strong>æŸ¥è¯¢æ‰€æœ‰GCäº‹ä»¶åŠå…¶è€—æ—¶</strong>:</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span>
  ts <span class="hljs-operator">/</span> <span class="hljs-number">1e9</span> <span class="hljs-keyword">AS</span> time_sec,
  dur <span class="hljs-operator">/</span> <span class="hljs-number">1e6</span> <span class="hljs-keyword">AS</span> duration_ms,
  name <span class="hljs-keyword">AS</span> gc_type,
  <span class="hljs-keyword">CASE</span>
    <span class="hljs-keyword">WHEN</span> dur <span class="hljs-operator">&lt;</span> <span class="hljs-number">5e6</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Minor'</span>
    <span class="hljs-keyword">WHEN</span> dur <span class="hljs-operator">&lt;</span> <span class="hljs-number">50e6</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Major'</span>
    <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'Critical'</span>
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> severity
<span class="hljs-keyword">FROM</span> slice
<span class="hljs-keyword">WHERE</span> name GLOB <span class="hljs-string">'Heap*'</span> <span class="hljs-keyword">OR</span> name GLOB <span class="hljs-string">'GC*'</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> dur <span class="hljs-keyword">DESC</span>;
</code></pre>
<p><strong>æŸ¥è¯¢ä¸»çº¿ç¨‹è€—æ—¶æœ€é•¿çš„20ä¸ªæ–¹æ³•</strong>:</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span>
  name,
  dur <span class="hljs-operator">/</span> <span class="hljs-number">1e6</span> <span class="hljs-keyword">AS</span> duration_ms,
  ts <span class="hljs-operator">/</span> <span class="hljs-number">1e9</span> <span class="hljs-keyword">AS</span> start_time_sec
<span class="hljs-keyword">FROM</span> slice
<span class="hljs-keyword">JOIN</span> thread_track <span class="hljs-keyword">ON</span> slice.track_id <span class="hljs-operator">=</span> thread_track.id
<span class="hljs-keyword">JOIN</span> thread <span class="hljs-keyword">ON</span> thread_track.utid <span class="hljs-operator">=</span> thread.utid
<span class="hljs-keyword">WHERE</span>
  thread.name <span class="hljs-operator">=</span> <span class="hljs-string">'main'</span>
  <span class="hljs-keyword">AND</span> depth <span class="hljs-operator">=</span> <span class="hljs-number">0</span>  <span class="hljs-comment">-- åªçœ‹é¡¶å±‚è°ƒç”¨</span>
  <span class="hljs-keyword">AND</span> dur <span class="hljs-operator">&gt;</span> <span class="hljs-number">10e6</span>  <span class="hljs-comment">-- è¶…è¿‡10ms</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> dur <span class="hljs-keyword">DESC</span>
LIMIT <span class="hljs-number">20</span>;
</code></pre>
<p><strong>æŸ¥è¯¢Binderè°ƒç”¨ç»Ÿè®¡</strong>:</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span>
  thread.name <span class="hljs-keyword">AS</span> caller_thread,
  slice.name <span class="hljs-keyword">AS</span> binder_method,
  <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> call_count,
  <span class="hljs-built_in">SUM</span>(dur) <span class="hljs-operator">/</span> <span class="hljs-number">1e6</span> <span class="hljs-keyword">AS</span> total_ms,
  <span class="hljs-built_in">AVG</span>(dur) <span class="hljs-operator">/</span> <span class="hljs-number">1e6</span> <span class="hljs-keyword">AS</span> avg_ms,
  <span class="hljs-built_in">MAX</span>(dur) <span class="hljs-operator">/</span> <span class="hljs-number">1e6</span> <span class="hljs-keyword">AS</span> max_ms
<span class="hljs-keyword">FROM</span> slice
<span class="hljs-keyword">JOIN</span> thread_track <span class="hljs-keyword">ON</span> slice.track_id <span class="hljs-operator">=</span> thread_track.id
<span class="hljs-keyword">JOIN</span> thread <span class="hljs-keyword">ON</span> thread_track.utid <span class="hljs-operator">=</span> thread.utid
<span class="hljs-keyword">WHERE</span> slice.name <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'binder%'</span>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> thread.name, slice.name
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> total_ms <span class="hljs-keyword">DESC</span>;
</code></pre>
<p><strong>åˆ†æå¸§è€—æ—¶åˆ†å¸ƒ</strong>:</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span>
  <span class="hljs-keyword">CASE</span>
    <span class="hljs-keyword">WHEN</span> dur <span class="hljs-operator">&lt;</span> <span class="hljs-number">16.6e6</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'æ­£å¸¸ (&lt;16.6ms)'</span>
    <span class="hljs-keyword">WHEN</span> dur <span class="hljs-operator">&lt;</span> <span class="hljs-number">33e6</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'è½»å¾®æ‰å¸§ (16.6-33ms)'</span>
    <span class="hljs-keyword">WHEN</span> dur <span class="hljs-operator">&lt;</span> <span class="hljs-number">50e6</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'ä¸­åº¦æ‰å¸§ (33-50ms)'</span>
    <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'ä¸¥é‡æ‰å¸§ (&gt;50ms)'</span>
  <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> frame_category,
  <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> frame_count,
  ROUND(<span class="hljs-number">100.0</span> <span class="hljs-operator">*</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-operator">/</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> actual_frame_timeline_slice), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> percentage
<span class="hljs-keyword">FROM</span> actual_frame_timeline_slice
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> frame_category
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> frame_count <span class="hljs-keyword">DESC</span>;
</code></pre>
<h3 data-id="heading-35">6.2 è‡ªåŠ¨åŒ–åˆ†æè„šæœ¬</h3>
<p>ä½¿ç”¨Pythonå’ŒPerfetto Trace Processorè¿›è¡Œè‡ªåŠ¨åŒ–åˆ†æ:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#!/usr/bin/env python3</span>
<span class="hljs-string">"""
å¯åŠ¨æ—¶é—´è‡ªåŠ¨åŒ–åˆ†æè„šæœ¬
"""</span>
<span class="hljs-keyword">from</span> perfetto.trace_processor <span class="hljs-keyword">import</span> TraceProcessor
<span class="hljs-keyword">import</span> sys

<span class="hljs-keyword">def</span> <span class="hljs-title function_">analyze_startup</span>(<span class="hljs-params">trace_file</span>):
    tp = TraceProcessor(trace=trace_file)

    <span class="hljs-comment"># æŸ¥è¯¢Application.onCreateçš„è€—æ—¶</span>
    query = <span class="hljs-string">'''
    SELECT
        ts / 1e9 AS start_sec,
        dur / 1e6 AS duration_ms
    FROM slice
    WHERE name = 'Application.onCreate'
    '''</span>

    result = tp.query(query)
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(result) &gt; <span class="hljs-number">0</span>:
        app_create_time = result.duration_ms[<span class="hljs-number">0</span>]
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Application.onCreate: <span class="hljs-subst">{app_create_time:<span class="hljs-number">.2</span>f}</span>ms"</span>)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"æœªæ‰¾åˆ°Application.onCreateäº‹ä»¶"</span>)
        <span class="hljs-keyword">return</span>

    <span class="hljs-comment"># æŸ¥è¯¢Activity.onCreateçš„è€—æ—¶</span>
    query = <span class="hljs-string">'''
    SELECT
        ts / 1e9 AS start_sec,
        dur / 1e6 AS duration_ms
    FROM slice
    WHERE name LIKE '%Activity.onCreate%'
    '''</span>

    result = tp.query(query)
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(result) &gt; <span class="hljs-number">0</span>:
        activity_create_time = result.duration_ms[<span class="hljs-number">0</span>]
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Activity.onCreate: <span class="hljs-subst">{activity_create_time:<span class="hljs-number">.2</span>f}</span>ms"</span>)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"æœªæ‰¾åˆ°Activity.onCreateäº‹ä»¶"</span>)
        <span class="hljs-keyword">return</span>

    <span class="hljs-comment"># æŸ¥è¯¢é¦–å¸§æ¸²æŸ“æ—¶é—´</span>
    query = <span class="hljs-string">'''
    SELECT MIN(ts) / 1e9 AS first_frame_sec
    FROM actual_frame_timeline_slice
    '''</span>

    result = tp.query(query)
    first_frame_time = result.first_frame_sec[<span class="hljs-number">0</span>]

    <span class="hljs-comment"># è®¡ç®—æ€»å¯åŠ¨æ—¶é—´</span>
    query = <span class="hljs-string">'''
    SELECT MIN(ts) / 1e9 AS app_start_sec
    FROM slice
    WHERE name = 'Application.onCreate'
    '''</span>

    result = tp.query(query)
    app_start_time = result.app_start_sec[<span class="hljs-number">0</span>]

    total_startup = (first_frame_time - app_start_time) * <span class="hljs-number">1000</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ€»å¯åŠ¨æ—¶é—´: <span class="hljs-subst">{total_startup:<span class="hljs-number">.2</span>f}</span>ms"</span>)

    <span class="hljs-comment"># æ€§èƒ½è¯„çº§</span>
    <span class="hljs-keyword">if</span> total_startup &lt; <span class="hljs-number">1000</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… æ€§èƒ½è¯„çº§: ä¼˜ç§€"</span>)
    <span class="hljs-keyword">elif</span> total_startup &lt; <span class="hljs-number">2000</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"âš ï¸ æ€§èƒ½è¯„çº§: è‰¯å¥½"</span>)
    <span class="hljs-keyword">elif</span> total_startup &lt; <span class="hljs-number">3000</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"âš ï¸ æ€§èƒ½è¯„çº§: ä¸€èˆ¬"</span>)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"âŒ æ€§èƒ½è¯„çº§: éœ€è¦ä¼˜åŒ–"</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &lt; <span class="hljs-number">2</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç”¨æ³•: python analyze_startup.py trace.perfetto-trace"</span>)
        sys.exit(<span class="hljs-number">1</span>)

    analyze_startup(sys.argv[<span class="hljs-number">1</span>])
</code></pre>
<p><strong>ä½¿ç”¨æ–¹æ³•</strong>:</p>
<pre><code class="hljs language-bash" lang="bash">python analyze_startup.py launch.perfetto-trace

<span class="hljs-comment"># è¾“å‡º:</span>
<span class="hljs-comment"># Application.onCreate: 450.23ms</span>
<span class="hljs-comment"># Activity.onCreate: 380.45ms</span>
<span class="hljs-comment"># æ€»å¯åŠ¨æ—¶é—´: 1245.67ms</span>
<span class="hljs-comment"># âš ï¸ æ€§èƒ½è¯„çº§: è‰¯å¥½</span>
</code></pre>
<hr/>
<h2 data-id="heading-36">ä¸ƒã€å¸¸è§é—®é¢˜ä¸è§£å†³</h2>
<h3 data-id="heading-37">7.1 TraceæŠ“å–å¤±è´¥</h3>
<p><strong>é—®é¢˜</strong>: æ‰§è¡Œsystrace/perfettoå‘½ä»¤åæ— è¾“å‡ºæˆ–æŠ¥é”™</p>
<p><strong>å¯èƒ½åŸå› ä¸è§£å†³</strong>:</p>
<ol>
<li><strong>è®¾å¤‡æœªæˆæƒ</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥è®¾å¤‡è¿æ¥</span>
adb devices
<span class="hljs-comment"># å¦‚æœæ˜¾ç¤º "unauthorized",é‡æ–°æˆæƒ</span>
adb kill-server
adb start-server
</code></pre>
<ol start="2">
<li><strong>æƒé™ä¸è¶³</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># éœ€è¦rootæƒé™</span>
adb root
adb remount
</code></pre>
<ol start="3">
<li><strong>bufferå¤§å°ä¸è¶³</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¢å¤§buffer</span>
python systrace.py -b 65536 ...  <span class="hljs-comment"># 64MB</span>
</code></pre>
<ol start="4">
<li><strong>categoryä¸æ”¯æŒ</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹è®¾å¤‡æ”¯æŒçš„category</span>
adb shell atrace --list_categories
</code></pre>
<h3 data-id="heading-38">7.2 Traceæ–‡ä»¶è¿‡å¤§</h3>
<p><strong>é—®é¢˜</strong>: Traceæ–‡ä»¶å‡ ç™¾MB,Chromeæ‰“ä¸å¼€æˆ–å¾ˆå¡</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>:</p>
<ol>
<li><strong>å‡å°‘æŠ“å–æ—¶é•¿</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä»10ç§’æ”¹ä¸º5ç§’</span>
-t 5
</code></pre>
<ol start="2">
<li><strong>åªé€‰æ‹©å¿…è¦çš„category</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸è¦ç”¨ --all,ç²¾ç¡®æŒ‡å®š</span>
python systrace.py ... <span class="hljs-built_in">sched</span> gfx view am
</code></pre>
<ol start="3">
<li>
<p><strong>ä½¿ç”¨Perfettoä»£æ›¿Systrace</strong>
Perfettoçš„protobufæ ¼å¼æ–‡ä»¶æ›´å°,åŠ è½½æ›´å¿«</p>
</li>
<li>
<p><strong>ä½¿ç”¨Perfettoçš„åœ¨çº¿æŸ¥çœ‹</strong>
ä¸è¦ä¸‹è½½æ–‡ä»¶,ç›´æ¥åœ¨ ui.perfetto.dev ä¸Šåˆ†æ</p>
</li>
</ol>
<h3 data-id="heading-39">7.3 æ‰¾ä¸åˆ°å…³é”®äº‹ä»¶</h3>
<p><strong>é—®é¢˜</strong>: åœ¨Traceä¸­æœç´¢ä¸åˆ°æˆ‘çš„å‡½æ•°è°ƒç”¨</p>
<p><strong>å¯èƒ½åŸå› </strong>:</p>
<ol>
<li><strong>æ²¡æœ‰å¯ç”¨app category</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¡®ä¿åŒ…å« app category</span>
python systrace.py ... app
</code></pre>
<ol start="2">
<li><strong>ä»£ç æ²¡æœ‰æ’æ¡©</strong></li>
</ol>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// éœ€è¦æ·»åŠ  Trace.beginSection()</span>
Trace.beginSection(<span class="hljs-string">"MyFunction"</span>)
myFunction()
Trace.endSection()
</code></pre>
<ol start="3">
<li><strong>å‡½æ•°æ‰§è¡Œæ—¶é—´å¤ªçŸ­</strong></li>
</ol>
<ul>
<li>å°äº0.1msçš„å‡½æ•°å¯èƒ½ä¸ä¼šæ˜¾ç¤º</li>
<li>æ”¾å¤§æ—¶é—´è½´æŸ¥çœ‹</li>
</ul>
<ol start="4">
<li><strong>æ²¡æœ‰æŒ‡å®šåº”ç”¨åŒ…å</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŒ‡å®šåŒ…åä»¥æŠ“å–åº”ç”¨çš„trace</span>
python systrace.py -a com.example.myapp ...
</code></pre>
<h3 data-id="heading-40">7.4 Traceçœ‹ä¸æ‡‚</h3>
<p><strong>é—®é¢˜</strong>: Traceæ–‡ä»¶æ‰“å¼€äº†,ä½†ä¸çŸ¥é“æ€ä¹ˆåˆ†æ</p>
<p><strong>å»ºè®®</strong>:</p>
<ol>
<li>
<p><strong>ä»å®è§‚åˆ°å¾®è§‚</strong></p>
<ul>
<li>å…ˆç¼©å°æŸ¥çœ‹æ•´ä½“</li>
<li>è¯†åˆ«å¤§å—è€—æ—¶</li>
<li>å†æ”¾å¤§æŸ¥çœ‹ç»†èŠ‚</li>
</ul>
</li>
<li>
<p><strong>å…³æ³¨ä¸»çº¿ç¨‹</strong></p>
<ul>
<li>ä¸»çº¿ç¨‹çš„ç©ºç™½åŒºåŸŸå¯èƒ½åœ¨ç­‰å¾…</li>
<li>æŸ¥çœ‹ä¸»çº¿ç¨‹åœ¨åšä»€ä¹ˆ</li>
</ul>
</li>
<li>
<p><strong>å¯¹æ¯”VSYNCä¿¡å·</strong></p>
<ul>
<li>çœ‹æ¸²æŸ“æ˜¯å¦è·Ÿä¸ŠVSYNCèŠ‚å¥</li>
<li>è¯†åˆ«æ‰å¸§åŸå› </li>
</ul>
</li>
<li>
<p><strong>æœç´¢å…³é”®äº‹ä»¶</strong></p>
<ul>
<li><code>activityStart</code>, <code>onCreate</code>, <code>draw</code>, <code>measure</code></li>
<li>ä½¿ç”¨æœç´¢åŠŸèƒ½å¿«é€Ÿå®šä½</li>
</ul>
</li>
<li>
<p><strong>æŸ¥çœ‹CPUè°ƒåº¦</strong></p>
<ul>
<li>çº¿ç¨‹æ˜¯åœ¨è¿è¡Œè¿˜æ˜¯ç­‰å¾…</li>
<li>CPUæ˜¯å¦è¢«å…¶ä»–è¿›ç¨‹å ç”¨</li>
</ul>
</li>
</ol>
<hr/>
<h2 data-id="heading-41">å…«ã€å·¥å…·å¯¹æ¯”ä¸é€‰æ‹©å»ºè®®</h2>
<h3 data-id="heading-42">8.1 ä½•æ—¶ä½¿ç”¨Systrace</h3>
<p><strong>æ¨èåœºæ™¯</strong>:</p>
<ul>
<li>âœ… Android 9åŠä»¥ä¸‹ç³»ç»Ÿ</li>
<li>âœ… ç®€å•çš„æ€§èƒ½åˆ†æ(å¯åŠ¨ã€å¡é¡¿)</li>
<li>âœ… ä¸éœ€è¦å¤æ‚æŸ¥è¯¢</li>
<li>âœ… å›¢é˜Ÿæˆå‘˜å¯¹Chrome Trace Viewerç†Ÿæ‚‰</li>
</ul>
<p><strong>ä¼˜åŠ¿</strong>:</p>
<ul>
<li>ç®€å•æ˜“ç”¨,ä¸€è¡Œå‘½ä»¤æå®š</li>
<li>å…¼å®¹è€ç‰ˆæœ¬Android</li>
<li>HTMLæ–‡ä»¶å¯ä»¥ç¦»çº¿æŸ¥çœ‹</li>
</ul>
<h3 data-id="heading-43">8.2 ä½•æ—¶ä½¿ç”¨Perfetto</h3>
<p><strong>æ¨èåœºæ™¯</strong>:</p>
<ul>
<li>âœ… <strong>Android 10åŠä»¥ä¸Šç³»ç»Ÿ</strong> (å¼ºçƒˆæ¨è)</li>
<li>âœ… éœ€è¦SQLæŸ¥è¯¢è¿›è¡Œæ·±åº¦åˆ†æ</li>
<li>âœ… éœ€è¦å†…å­˜ã€ç”µé‡ç­‰é¢å¤–æ•°æ®</li>
<li>âœ… éœ€è¦è‡ªåŠ¨åŒ–åˆ†æ(CI/CD)</li>
<li>âœ… å¤§å‹traceæ–‡ä»¶</li>
</ul>
<p><strong>ä¼˜åŠ¿</strong>:</p>
<ul>
<li>ç°ä»£åŒ–UI,ä½“éªŒæä½³</li>
<li>SQLæŸ¥è¯¢å¼•æ“,åˆ†æèƒ½åŠ›å¼º</li>
<li>æ–‡ä»¶æ›´å°,åŠ è½½æ›´å¿«</li>
<li>æŒç»­æ›´æ–°,åŠŸèƒ½ä¸°å¯Œ</li>
</ul>
<h3 data-id="heading-44">8.3 é€‰æ‹©å»ºè®®</h3>


















































<table><thead><tr><th align="left">åœºæ™¯</th><th align="left">æ¨èå·¥å…·</th><th align="left">ç†ç”±</th></tr></thead><tbody><tr><td align="left">æ–°é¡¹ç›®</td><td align="left"><strong>Perfetto</strong></td><td align="left">åŠŸèƒ½å¼ºå¤§,ä½“éªŒå¥½</td></tr><tr><td align="left">è€é¡¹ç›®(Android 9-)</td><td align="left">Systrace</td><td align="left">å…¼å®¹æ€§</td></tr><tr><td align="left">å¯åŠ¨ä¼˜åŒ–</td><td align="left">Perfetto</td><td align="left">SQLæŸ¥è¯¢æ–¹ä¾¿ç»Ÿè®¡</td></tr><tr><td align="left">å¡é¡¿åˆ†æ</td><td align="left">Perfetto</td><td align="left">Frame Timelineå¼ºå¤§</td></tr><tr><td align="left">å¿«é€Ÿæ’æŸ¥</td><td align="left">Systrace</td><td align="left">ç®€å•å¿«é€Ÿ</td></tr><tr><td align="left">æ·±åº¦åˆ†æ</td><td align="left"><strong>Perfetto</strong></td><td align="left">SQLæŸ¥è¯¢ + å¤šæ•°æ®æº</td></tr><tr><td align="left">CIé›†æˆ</td><td align="left"><strong>Perfetto</strong></td><td align="left">Trace Processor API</td></tr><tr><td align="left">å­¦ä¹ å…¥é—¨</td><td align="left">Systrace</td><td align="left">ç®€å•æ˜“æ‡‚</td></tr></tbody></table>
<p><strong>æ€»ç»“</strong>: å¦‚æœä½ çš„é¡¹ç›®ä¸»è¦æ”¯æŒAndroid 10+,å¼ºçƒˆæ¨èä»ç°åœ¨å¼€å§‹ä½¿ç”¨Perfetto!</p>
<hr/>
<h2 data-id="heading-45">ä¹ã€æ€»ç»“ä¸å±•æœ›</h2>
<h3 data-id="heading-46">9.1 æ ¸å¿ƒè¦ç‚¹å›é¡¾</h3>
<p>é€šè¿‡æœ¬æ–‡çš„å­¦ä¹ ,æˆ‘ä»¬å…¨é¢æŒæ¡äº†Systraceå’ŒPerfettoä¸¤å¤§æ€§èƒ½åˆ†æå·¥å…·:</p>
<p><strong>å·¥å…·ä½¿ç”¨</strong>:</p>
<ul>
<li>âœ… ç†è§£äº†Traceçš„å·¥ä½œåŸç†å’Œåº”ç”¨åœºæ™¯</li>
<li>âœ… æŒæ¡äº†Systraceå’ŒPerfettoçš„æŠ“å–æ–¹æ³•</li>
<li>âœ… å­¦ä¼šäº†Perfetto UIçš„å„é¡¹åŠŸèƒ½</li>
<li>âœ… äº†è§£äº†ä¸¤ç§å·¥å…·çš„å¯¹æ¯”å’Œé€‰æ‹©</li>
</ul>
<p><strong>åˆ†ææ–¹æ³•</strong>:</p>
<ul>
<li>âœ… å»ºç«‹äº†ç³»ç»ŸåŒ–çš„Traceåˆ†ææ€è·¯</li>
<li>âœ… å­¦ä¼šäº†å®šä½å¯åŠ¨æ…¢ã€å¡é¡¿ã€CPUå ç”¨ç­‰é—®é¢˜</li>
<li>âœ… æŒæ¡äº†Frame Timelineåˆ†ææŠ€å·§</li>
<li>âœ… ç†è§£äº†å…³é”®æ€§èƒ½æŒ‡æ ‡çš„å«ä¹‰</li>
</ul>
<p><strong>å®æˆ˜æŠ€èƒ½</strong>:</p>
<ul>
<li>âœ… æŒæ¡äº†Java/Kotlin/Nativeä»£ç æ’æ¡©</li>
<li>âœ… å­¦ä¼šäº†Perfetto SQLé«˜çº§æŸ¥è¯¢</li>
<li>âœ… äº†è§£äº†è‡ªåŠ¨åŒ–åˆ†æå’ŒCIé›†æˆ</li>
<li>âœ… èƒ½å¤Ÿç‹¬ç«‹å®Œæˆæ€§èƒ½é—®é¢˜çš„æ’æŸ¥</li>
</ul>
<h3 data-id="heading-47">9.2 æœ€ä½³å®è·µæ€»ç»“</h3>
<p><strong>DO (æ¨èåšæ³•)</strong>:</p>
<ul>
<li>âœ… ä¼˜å…ˆä½¿ç”¨Perfetto (Android 10+)</li>
<li>âœ… åœ¨å…³é”®è·¯å¾„æ·»åŠ traceæ ‡è®°</li>
<li>âœ… å®šæœŸè¿›è¡Œæ€§èƒ½å›å½’æµ‹è¯•</li>
<li>âœ… å»ºç«‹æ€§èƒ½åŸºçº¿å’Œé˜ˆå€¼</li>
<li>âœ… ä½¿ç”¨SQLæŸ¥è¯¢è¿›è¡Œæ·±åº¦åˆ†æ</li>
<li>âœ… ä¿å­˜é‡è¦çš„traceæ–‡ä»¶ä»¥ä¾¿å¯¹æ¯”</li>
<li>âœ… å›¢é˜Ÿå†…åˆ†äº«traceåˆ†æç»éªŒ</li>
</ul>
<p><strong>DON'T (é¿å…åšæ³•)</strong>:</p>
<ul>
<li>âŒ ä¸è¦å‡­æ„Ÿè§‰ä¼˜åŒ–,è¦ç”¨æ•°æ®è¯´è¯</li>
<li>âŒ ä¸è¦åªä¼˜åŒ–å±€éƒ¨,è¦çœ‹æ•´ä½“</li>
<li>âŒ ä¸è¦åœ¨releaseç‰ˆæœ¬ä¿ç•™è¿‡å¤štrace</li>
<li>âŒ ä¸è¦å¿½ç•¥å°çš„æ€§èƒ½é—®é¢˜</li>
<li>âŒ ä¸è¦ç­‰ç”¨æˆ·åé¦ˆæ‰å¼€å§‹ä¼˜åŒ–</li>
</ul>
<h3 data-id="heading-48">9.3 è¿›ä¸€æ­¥å­¦ä¹ èµ„æº</h3>
<p><strong>å®˜æ–¹æ–‡æ¡£</strong>:</p>
<ul>
<li>Systrace: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Ftopic%2Fperformance%2Ftracing" target="_blank" title="https://developer.android.com/topic/performance/tracing" ref="nofollow noopener noreferrer">developer.android.com/topic/perfoâ€¦</a></li>
<li>Perfetto: <a href="https://link.juejin.cn?target=https%3A%2F%2Fperfetto.dev%2F" target="_blank" title="https://perfetto.dev/" ref="nofollow noopener noreferrer">perfetto.dev/</a></li>
<li>Perfetto SQL: <a href="https://link.juejin.cn?target=https%3A%2F%2Fperfetto.dev%2Fdocs%2Fanalysis%2Fsql-tables" target="_blank" title="https://perfetto.dev/docs/analysis/sql-tables" ref="nofollow noopener noreferrer">perfetto.dev/docs/analysâ€¦</a></li>
</ul>
<p><strong>å·¥å…·</strong>:</p>
<ul>
<li>Perfetto UI: <a href="https://link.juejin.cn?target=https%3A%2F%2Fui.perfetto.dev%2F" target="_blank" title="https://ui.perfetto.dev/" ref="nofollow noopener noreferrer">ui.perfetto.dev/</a></li>
<li>Trace Processor: <a href="https://link.juejin.cn?target=https%3A%2F%2Fperfetto.dev%2Fdocs%2Fanalysis%2Ftrace-processor" target="_blank" title="https://perfetto.dev/docs/analysis/trace-processor" ref="nofollow noopener noreferrer">perfetto.dev/docs/analysâ€¦</a></li>
</ul>
<p><strong>ç¤¾åŒº</strong>:</p>
<ul>
<li>Android Performance Patterns (YouTube)</li>
<li>Android Developers Blog</li>
<li>Stack Overflow (æ ‡ç­¾: android-performance)</li>
</ul>
<p><strong>ç›¸å…³æ–‡ç« </strong>:</p>
<ul>
<li><a href="https://juejin.cn/post/7590071125397766184" target="_blank" title="https://juejin.cn/post/7590071125397766184">ä¸Šä¸€ç¯‡: ç¨³å®šæ€§æ€§èƒ½ç³»åˆ—ä¹‹ä¸ƒâ€”â€”Watchdogæœºåˆ¶:ç³»ç»Ÿå®ˆæŠ¤è€…çš„å·¥ä½œåŸç†</a></li>
<li><a href="https://juejin.cn/post/7587473691170095104" target="_blank" title="https://juejin.cn/post/7587473691170095104">ç³»åˆ—ç›®å½•: Androidç³»ç»Ÿç¨³å®šæ€§ä¸æ€§èƒ½ä¼˜åŒ–</a></li>
</ul>
<hr/>
<p><strong>è®°ä½</strong>:æ€§èƒ½ä¼˜åŒ–ä¸æ˜¯ä¸€æ¬¡æ€§çš„å·¥ä½œ,è€Œæ˜¯ä¸€ä¸ªæŒç»­çš„è¿‡ç¨‹ã€‚å®šæœŸä½¿ç”¨Traceå·¥å…·æ£€æŸ¥æ€§èƒ½,åŠæ—¶å‘ç°å’Œè§£å†³é—®é¢˜,æ‰èƒ½ä¿è¯åº”ç”¨å§‹ç»ˆä¿æŒæœ€ä½³çŠ¶æ€ã€‚</p>
<p>å½“ä½ ä¸‹æ¬¡é‡åˆ°æ€§èƒ½é—®é¢˜æ—¶,ä¸è¦æ…Œå¼ ,æ‰“å¼€Perfetto,æŠ“ä¸ªtrace,ç­”æ¡ˆå°±åœ¨é‚£é‡Œ! ğŸ“Šâœ¨</p>
<hr/>
<blockquote>
<p><strong>ä½œè€…ç®€ä»‹</strong>: å¤šå¹´Androidç³»ç»Ÿå¼€å‘ç»éªŒ,ä¸“æ³¨äºç³»ç»Ÿç¨³å®šæ€§ä¸æ€§èƒ½ä¼˜åŒ–é¢†åŸŸã€‚æ¬¢è¿å…³æ³¨æœ¬ç³»åˆ—,ä¸€èµ·æ·±å…¥Androidç³»ç»Ÿçš„ç²¾å½©ä¸–ç•Œ!</p>
</blockquote>
<hr/>
<h3 data-id="heading-49">ğŸ‰ æ„Ÿè°¢å…³æ³¨,è®©æˆ‘ä»¬ä¸€èµ·æ·±å…¥Androidç³»ç»Ÿçš„ç²¾å½©ä¸–ç•Œ!</h3>
<h3 data-id="heading-50"><strong>æ‰¾åˆ°æˆ‘</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fhome.wonlab.top" target="_blank" title="https://home.wonlab.top" ref="nofollow noopener noreferrer">ä¸ªäººä¸»é¡µ</a></h3></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Browser-Use æŠ€æœ¯æ¶æ„åˆ†æ]]></title>    <link>https://juejin.cn/post/7591334208997720090</link>    <guid>https://juejin.cn/post/7591334208997720090</guid>    <pubDate>2026-01-04T14:15:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591334208997720090" data-draft-id="7591377757733584905" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Browser-Use æŠ€æœ¯æ¶æ„åˆ†æ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,Agent"/> <meta itemprop="datePublished" content="2026-01-04T14:15:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ²™æ¼ çš„æµªäºº"/> <meta itemprop="url" content="https://juejin.cn/user/2330620382946541"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Browser-Use æŠ€æœ¯æ¶æ„åˆ†æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2330620382946541/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ²™æ¼ çš„æµªäºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T14:15:07.000Z" title="Sun Jan 04 2026 14:15:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Browser-Use æŠ€æœ¯æ¶æ„åˆ†æ</h2>
<h3 data-id="heading-1">æ¦‚è¿°</h3>
<p>Browser-Use æ˜¯ä¸€ä¸ªåŸºäº LLMï¼ˆå¤§è¯­è¨€æ¨¡å‹ï¼‰å’Œ CDPï¼ˆChrome DevTools Protocolï¼‰çš„å¼‚æ­¥ Python æµè§ˆå™¨è‡ªåŠ¨åŒ–åº“ï¼Œæ—¨åœ¨è®© AI æ™ºèƒ½ä½“èƒ½å¤Ÿè‡ªä¸»å¯¼èˆªç½‘é¡µã€ä¸å…ƒç´ äº¤äº’å¹¶å®Œæˆå¤æ‚ä»»åŠ¡ã€‚è¯¥åº“é‡‡ç”¨äº‹ä»¶é©±åŠ¨æ¶æ„ï¼Œé€šè¿‡ LLM é©±åŠ¨çš„å†³ç­–å¾ªç¯å®ç°æ™ºèƒ½åŒ–çš„æµè§ˆå™¨æ“ä½œã€‚Browser-Use æ”¯æŒå¤šç§ LLM æä¾›å•†ï¼ˆOpenAIã€Anthropicã€Googleã€Groq ç­‰ï¼‰ï¼Œæä¾›äº†å®Œæ•´çš„æµè§ˆå™¨è‡ªåŠ¨åŒ–èƒ½åŠ›ï¼ŒåŒ…æ‹¬é¡µé¢å¯¼èˆªã€å…ƒç´ äº¤äº’ã€è¡¨å•å¡«å†™ã€æ–‡ä»¶ä¸Šä¼ ç­‰ã€‚è¯¥åº“ç‰¹åˆ«é€‚ç”¨äºéœ€è¦å¤æ‚ Web äº¤äº’çš„ AI æ™ºèƒ½ä½“åœºæ™¯ï¼Œå¦‚è‡ªåŠ¨åŒ–æµ‹è¯•ã€æ•°æ®æŠ“å–ã€ä»»åŠ¡è‡ªåŠ¨åŒ–ç­‰ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹æ€§ï¼š</strong></p>
<ul>
<li>åŸºäº LLM çš„æ™ºèƒ½å†³ç­–ï¼Œæ— éœ€æ‰‹åŠ¨ç¼–å†™å¤æ‚çš„æµè§ˆå™¨æ“ä½œè„šæœ¬</li>
<li>äº‹ä»¶é©±åŠ¨çš„æµè§ˆå™¨ç®¡ç†ï¼Œé€šè¿‡ Watchdog ç³»ç»Ÿå®ç°è‡ªåŠ¨åŒ–ç›‘æ§å’Œå¤„ç†</li>
<li>å®Œæ•´çš„ DOM å¤„ç†å’Œå¯è®¿é—®æ€§æ ‘æ”¯æŒï¼Œç¡®ä¿æ™ºèƒ½ä½“èƒ½å¤Ÿå‡†ç¡®ç†è§£é¡µé¢ç»“æ„</li>
<li>æ”¯æŒå¤šç§ LLM æä¾›å•†å’Œè‡ªå®šä¹‰å·¥å…·æ‰©å±•</li>
<li>æä¾›äº‘ç«¯æµè§ˆå™¨æœåŠ¡ï¼ˆBrowser Use Cloudï¼‰ï¼Œæ”¯æŒéšèº«æµè§ˆå™¨å’Œä»£ç†è½®æ¢</li>
</ul>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>AI æ™ºèƒ½ä½“çš„æµè§ˆå™¨è‡ªåŠ¨åŒ–ä»»åŠ¡</li>
<li>å¤æ‚çš„ Web è¡¨å•å¡«å†™å’Œæ•°æ®æå–</li>
<li>è‡ªåŠ¨åŒ–æµ‹è¯•å’Œç«¯åˆ°ç«¯æµ‹è¯•</li>
<li>ç½‘é¡µæ•°æ®æŠ“å–å’Œä¿¡æ¯æ”¶é›†</li>
<li>ä»»åŠ¡è‡ªåŠ¨åŒ–å’Œå·¥ä½œæµè‡ªåŠ¨åŒ–</li>
</ul>
<h3 data-id="heading-2">æ ¸å¿ƒæ¦‚å¿µå’Œæœ¯è¯­</h3>
<ul>
<li><strong>Agentï¼ˆæ™ºèƒ½ä½“ï¼‰</strong>ï¼šBrowser-Use çš„æ ¸å¿ƒç¼–æ’å™¨ï¼Œè´Ÿè´£æ¥æ”¶ä»»åŠ¡ã€ç®¡ç†æµè§ˆå™¨ä¼šè¯å¹¶æ‰§è¡Œ LLM é©±åŠ¨çš„åŠ¨ä½œå¾ªç¯</li>
<li><strong>BrowserSessionï¼ˆæµè§ˆå™¨ä¼šè¯ï¼‰</strong>ï¼šç®¡ç†æµè§ˆå™¨ç”Ÿå‘½å‘¨æœŸã€CDP è¿æ¥å’Œå¤šä¸ª Watchdog æœåŠ¡çš„åè°ƒ</li>
<li><strong>CDPï¼ˆChrome DevTools Protocolï¼‰</strong>ï¼šChrome æµè§ˆå™¨æä¾›çš„è°ƒè¯•åè®®ï¼Œç”¨äºç¨‹åºåŒ–æ§åˆ¶æµè§ˆå™¨</li>
<li><strong>Watchdogï¼ˆçœ‹é—¨ç‹—ï¼‰</strong>ï¼šäº‹ä»¶é©±åŠ¨çš„ç›‘æ§æœåŠ¡ï¼Œè‡ªåŠ¨å¤„ç†æµè§ˆå™¨äº‹ä»¶ï¼ˆå¦‚å¼¹çª—ã€ä¸‹è½½ã€å´©æºƒç­‰ï¼‰</li>
<li><strong>DomServiceï¼ˆDOM æœåŠ¡ï¼‰</strong>ï¼šæå–å’Œå¤„ç† DOM å†…å®¹ï¼Œå¤„ç†å…ƒç´ é«˜äº®å’Œå¯è®¿é—®æ€§æ ‘ç”Ÿæˆ</li>
<li><strong>Tools Registryï¼ˆå·¥å…·æ³¨å†Œè¡¨ï¼‰</strong>ï¼šå°† LLM å†³ç­–æ˜ å°„åˆ°æµè§ˆå™¨æ“ä½œçš„æ³¨å†Œè¡¨ç³»ç»Ÿ</li>
<li><strong>EventBusï¼ˆäº‹ä»¶æ€»çº¿ï¼‰</strong>ï¼šåŸºäº <code>bubus</code> çš„äº‹ä»¶é©±åŠ¨é€šä¿¡æœºåˆ¶ï¼Œåè°ƒå„ä¸ªç»„ä»¶</li>
<li><strong>Structured Outputï¼ˆç»“æ„åŒ–è¾“å‡ºï¼‰</strong>ï¼šLLM è¿”å›çš„ç»“æ„åŒ–åŠ¨ä½œæ¨¡å‹ï¼ŒåŒ…å«åŠ¨ä½œç±»å‹å’Œå‚æ•°</li>
<li><strong>CodeAgentï¼ˆä»£ç æ™ºèƒ½ä½“ï¼‰</strong>ï¼šç±»ä¼¼ Jupyter Notebook çš„æ‰§è¡Œç¯å¢ƒï¼Œå…è®¸ LLM ç¼–å†™ Python ä»£ç æ§åˆ¶æµè§ˆå™¨</li>
</ul>
<h3 data-id="heading-3">æ¶æ„è®¾è®¡</h3>
<p>Browser-Use é‡‡ç”¨äº‹ä»¶é©±åŠ¨çš„åˆ†å±‚æ¶æ„ï¼Œæ ¸å¿ƒæ˜¯åŸºäº CDP çš„æµè§ˆå™¨æ§åˆ¶å’Œ LLM é©±åŠ¨çš„å†³ç­–å¾ªç¯ã€‚ç³»ç»Ÿå°†æµè§ˆå™¨æ“ä½œæŠ½è±¡ä¸ºäº‹ä»¶ï¼Œé€šè¿‡äº‹ä»¶æ€»çº¿åè°ƒå„ä¸ªç»„ä»¶ï¼Œå®ç°äº†é«˜åº¦çš„æ¨¡å—åŒ–å’Œå¯æ‰©å±•æ€§ã€‚</p>
<h4 data-id="heading-4">è®¾è®¡åŸåˆ™</h4>
<ol>
<li><strong>äº‹ä»¶é©±åŠ¨æ¶æ„</strong>ï¼šæ‰€æœ‰æµè§ˆå™¨æ“ä½œéƒ½é€šè¿‡äº‹ä»¶ç³»ç»Ÿè¿›è¡Œï¼Œå®ç°äº†æ¾è€¦åˆçš„ç»„ä»¶è®¾è®¡</li>
<li><strong>LLM é©±åŠ¨çš„å†³ç­–</strong>ï¼šæ™ºèƒ½ä½“é€šè¿‡ LLM åˆ†æé¡µé¢çŠ¶æ€å¹¶åšå‡ºå†³ç­–ï¼Œæ— éœ€æ‰‹åŠ¨ç¼–å†™æ“ä½œè„šæœ¬</li>
<li><strong>Watchdog è‡ªåŠ¨åŒ–ç›‘æ§</strong>ï¼šé€šè¿‡å¤šä¸ª Watchdog æœåŠ¡è‡ªåŠ¨å¤„ç†å¸¸è§æµè§ˆå™¨äº‹ä»¶ï¼Œå‡å°‘æ™ºèƒ½ä½“è´Ÿæ‹…</li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šä½¿ç”¨ Pydantic ç¡®ä¿æ•°æ®ä¼ é€’çš„ç±»å‹å®‰å…¨ï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯</li>
<li><strong>å¼‚æ­¥ä¼˜å…ˆ</strong>ï¼šå…¨é¢é‡‡ç”¨å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ï¼Œæ”¯æŒé«˜å¹¶å‘å’Œé«˜æ•ˆçš„èµ„æºåˆ©ç”¨</li>
</ol>
<h4 data-id="heading-5">ç³»ç»Ÿæ¶æ„å›¾</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    ç”¨æˆ·ä»»åŠ¡[ç”¨æˆ·ä»»åŠ¡] --&gt; Agent[Agent æ™ºèƒ½ä½“]
    Agent --&gt; LLMé›†æˆ[LLM é›†æˆå±‚]
    LLMé›†æˆ --&gt; ç»“æ„åŒ–è¾“å‡º[ç»“æ„åŒ–åŠ¨ä½œè¾“å‡º]
    
    ç»“æ„åŒ–è¾“å‡º --&gt; Tools[Tools Registry&lt;br/&gt;å·¥å…·æ³¨å†Œè¡¨]
    Tools --&gt; æµè§ˆå™¨äº‹ä»¶[æµè§ˆå™¨äº‹ä»¶]
    
    æµè§ˆå™¨äº‹ä»¶ --&gt; EventBus[EventBus&lt;br/&gt;äº‹ä»¶æ€»çº¿]
    EventBus --&gt; BrowserSession[BrowserSession&lt;br/&gt;æµè§ˆå™¨ä¼šè¯]
    
    BrowserSession --&gt; CDPè¿æ¥[CDP è¿æ¥&lt;br/&gt;Chrome DevTools Protocol]
    CDPè¿æ¥ --&gt; æµè§ˆå™¨å®ä¾‹[æµè§ˆå™¨å®ä¾‹&lt;br/&gt;Chromium]
    
    EventBus --&gt; Watchdogç³»ç»Ÿ[Watchdog ç³»ç»Ÿ]
    Watchdogç³»ç»Ÿ --&gt; DOMWatchdog[DOM Watchdog&lt;br/&gt;DOM å¿«ç…§å’Œæˆªå›¾]
    Watchdogç³»ç»Ÿ --&gt; PopupsWatchdog[Popups Watchdog&lt;br/&gt;å¼¹çª—å¤„ç†]
    Watchdogç³»ç»Ÿ --&gt; DownloadsWatchdog[Downloads Watchdog&lt;br/&gt;æ–‡ä»¶ä¸‹è½½]
    Watchdogç³»ç»Ÿ --&gt; SecurityWatchdog[Security Watchdog&lt;br/&gt;å®‰å…¨ç­–ç•¥]
    Watchdogç³»ç»Ÿ --&gt; CrashWatchdog[Crash Watchdog&lt;br/&gt;å´©æºƒæ¢å¤]
    
    BrowserSession --&gt; DomService[DomService&lt;br/&gt;DOM å¤„ç†æœåŠ¡]
    DomService --&gt; DOMæ ‘[DOM æ ‘æå–]
    DomService --&gt; å¯è®¿é—®æ€§æ ‘[å¯è®¿é—®æ€§æ ‘ç”Ÿæˆ]
    DomService --&gt; å…ƒç´ é«˜äº®[å…ƒç´ é«˜äº®]
    
    Agent --&gt; åŠ¨ä½œæ‰§è¡Œ[åŠ¨ä½œæ‰§è¡Œå¾ªç¯]
    åŠ¨ä½œæ‰§è¡Œ --&gt; é¡µé¢çŠ¶æ€[è·å–é¡µé¢çŠ¶æ€]
    é¡µé¢çŠ¶æ€ --&gt; DomService
    é¡µé¢çŠ¶æ€ --&gt; LLMé›†æˆ
</code></pre>
<h4 data-id="heading-6">å…³é”®è®¾è®¡å†³ç­–</h4>
<p><strong>äº‹ä»¶é©±åŠ¨ vs ç›´æ¥è°ƒç”¨</strong>ï¼šBrowser-Use é€‰æ‹©äº‹ä»¶é©±åŠ¨æ¶æ„è€Œéç›´æ¥ CDP è°ƒç”¨ï¼Œè¿™ä½¿å¾—ç³»ç»Ÿæ›´åŠ æ¨¡å—åŒ–ï¼Œå„ä¸ªç»„ä»¶å¯ä»¥ç‹¬ç«‹å¼€å‘å’Œæµ‹è¯•ï¼ŒåŒæ—¶æ”¯æŒå¼‚æ­¥å¤„ç†å’Œå¹¶å‘æ“ä½œã€‚</p>
<p><strong>Watchdog ç³»ç»Ÿè®¾è®¡</strong>ï¼šé€šè¿‡å¤šä¸ªä¸“é—¨çš„ Watchdog æœåŠ¡å¤„ç†å¸¸è§æµè§ˆå™¨äº‹ä»¶ï¼Œå°†æ™ºèƒ½ä½“ä»ç¹ççš„äº‹ä»¶å¤„ç†ä¸­è§£æ”¾å‡ºæ¥ï¼Œä¸“æ³¨äºæ ¸å¿ƒä»»åŠ¡é€»è¾‘ã€‚</p>
<p><strong>DOM å¤„ç†ç­–ç•¥</strong>ï¼šé‡‡ç”¨å¢å¼ºçš„ DOM å¿«ç…§å’Œå¯è®¿é—®æ€§æ ‘ï¼Œç»“åˆè§†è§‰æˆªå›¾ï¼Œä¸º LLM æä¾›ä¸°å¯Œçš„é¡µé¢ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæé«˜å†³ç­–å‡†ç¡®æ€§ã€‚</p>
<h3 data-id="heading-7">æ ¸å¿ƒæµç¨‹</h3>
<p>Browser-Use çš„æ ¸å¿ƒæµç¨‹æ˜¯ä¸€ä¸ªè¿­ä»£çš„åŠ¨ä½œæ‰§è¡Œå¾ªç¯ï¼Œæ™ºèƒ½ä½“é€šè¿‡åˆ†æé¡µé¢çŠ¶æ€ã€è°ƒç”¨ LLM è·å–åŠ¨ä½œå†³ç­–ã€æ‰§è¡ŒåŠ¨ä½œå¹¶è§‚å¯Ÿç»“æœï¼Œä¸æ–­æ¨è¿›ä»»åŠ¡å®Œæˆã€‚</p>
<h4 data-id="heading-8">æµç¨‹è¾“å…¥å’Œè¾“å‡º</h4>
<p><strong>è¾“å…¥ï¼š</strong></p>
<ul>
<li>ç”¨æˆ·ä»»åŠ¡æè¿°ï¼ˆè‡ªç„¶è¯­è¨€ï¼‰</li>
<li>æµè§ˆå™¨é…ç½®ï¼ˆé…ç½®æ–‡ä»¶ã€ä»£ç†è®¾ç½®ç­‰ï¼‰</li>
<li>LLM é…ç½®ï¼ˆæ¨¡å‹é€‰æ‹©ã€API å¯†é’¥ç­‰ï¼‰</li>
</ul>
<p><strong>è¾“å‡ºï¼š</strong></p>
<ul>
<li>ä»»åŠ¡æ‰§è¡Œå†å²ï¼ˆåŒ…å«æ‰€æœ‰æ­¥éª¤å’Œç»“æœï¼‰</li>
<li>æå–çš„å†…å®¹ï¼ˆå¦‚æœä»»åŠ¡æ¶‰åŠæ•°æ®æå–ï¼‰</li>
<li>æµè§ˆå™¨çŠ¶æ€å¿«ç…§ï¼ˆæˆªå›¾ã€DOM æ ‘ç­‰ï¼‰</li>
</ul>
<h4 data-id="heading-9">æ ¸å¿ƒæµç¨‹å›¾</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    å¼€å§‹[å¼€å§‹] --&gt; åˆå§‹åŒ–[åˆå§‹åŒ– Agent å’Œ BrowserSession]
    åˆå§‹åŒ– --&gt; å‡†å¤‡ä¸Šä¸‹æ–‡[å‡†å¤‡ä¸Šä¸‹æ–‡&lt;br/&gt;è·å–é¡µé¢çŠ¶æ€]
    
    å‡†å¤‡ä¸Šä¸‹æ–‡ --&gt; DOMæå–[DOM Service æå– DOM æ ‘]
    DOMæå– --&gt; å¯è®¿é—®æ€§æ ‘[ç”Ÿæˆå¯è®¿é—®æ€§æ ‘]
    DOMæå– --&gt; æˆªå›¾[ç”Ÿæˆé¡µé¢æˆªå›¾]
    
    å¯è®¿é—®æ€§æ ‘ --&gt; æ„å»ºæ¶ˆæ¯[æ„å»º LLM æ¶ˆæ¯&lt;br/&gt;åŒ…å«é¡µé¢çŠ¶æ€å’Œä»»åŠ¡]
    æˆªå›¾ --&gt; æ„å»ºæ¶ˆæ¯
    
    æ„å»ºæ¶ˆæ¯ --&gt; LLMè°ƒç”¨[è°ƒç”¨ LLM&lt;br/&gt;è·å–ç»“æ„åŒ–è¾“å‡º]
    LLMè°ƒç”¨ --&gt; åŠ¨ä½œè§£æ[è§£æåŠ¨ä½œæ¨¡å‹&lt;br/&gt;ActionModel]
    
    åŠ¨ä½œè§£æ --&gt; åŠ¨ä½œç±»å‹åˆ¤æ–­{åŠ¨ä½œç±»å‹}
    åŠ¨ä½œç±»å‹åˆ¤æ–­ --&gt;|å¯¼èˆª| å¯¼èˆªåŠ¨ä½œ[æ‰§è¡Œå¯¼èˆªåŠ¨ä½œ]
    åŠ¨ä½œç±»å‹åˆ¤æ–­ --&gt;|ç‚¹å‡»| ç‚¹å‡»åŠ¨ä½œ[æ‰§è¡Œç‚¹å‡»åŠ¨ä½œ]
    åŠ¨ä½œç±»å‹åˆ¤æ–­ --&gt;|è¾“å…¥| è¾“å…¥åŠ¨ä½œ[æ‰§è¡Œè¾“å…¥åŠ¨ä½œ]
    åŠ¨ä½œç±»å‹åˆ¤æ–­ --&gt;|æ»šåŠ¨| æ»šåŠ¨åŠ¨ä½œ[æ‰§è¡Œæ»šåŠ¨åŠ¨ä½œ]
    åŠ¨ä½œç±»å‹åˆ¤æ–­ --&gt;|å®Œæˆ| å®ŒæˆåŠ¨ä½œ[æ ‡è®°ä»»åŠ¡å®Œæˆ]
    
    å¯¼èˆªåŠ¨ä½œ --&gt; Watchdogå¤„ç†[Watchdog å¤„ç†äº‹ä»¶]
    ç‚¹å‡»åŠ¨ä½œ --&gt; Watchdogå¤„ç†
    è¾“å…¥åŠ¨ä½œ --&gt; Watchdogå¤„ç†
    æ»šåŠ¨åŠ¨ä½œ --&gt; Watchdogå¤„ç†
    
    Watchdogå¤„ç† --&gt; ç­‰å¾…ç¨³å®š[ç­‰å¾…é¡µé¢ç¨³å®š]
    ç­‰å¾…ç¨³å®š --&gt; åˆ¤æ–­å®Œæˆ{ä»»åŠ¡æ˜¯å¦å®Œæˆ?}
    
    åˆ¤æ–­å®Œæˆ --&gt;|å¦| å‡†å¤‡ä¸Šä¸‹æ–‡
    åˆ¤æ–­å®Œæˆ --&gt;|æ˜¯| è¿”å›å†å²[è¿”å›æ‰§è¡Œå†å²]
    å®ŒæˆåŠ¨ä½œ --&gt; è¿”å›å†å²
    
    è¿”å›å†å² --&gt; ç»“æŸ[ç»“æŸ]
</code></pre>
<h4 data-id="heading-10">å…³é”®æ­¥éª¤è¯´æ˜</h4>
<ol>
<li>
<p><strong>ä¸Šä¸‹æ–‡å‡†å¤‡é˜¶æ®µ</strong>ï¼š</p>
<ul>
<li>Agent è°ƒç”¨ DomService è·å–å½“å‰é¡µé¢çš„ DOM æ ‘å’Œå¯è®¿é—®æ€§æ ‘</li>
<li>ç”Ÿæˆé¡µé¢æˆªå›¾ï¼Œä¸º LLM æä¾›è§†è§‰ä¸Šä¸‹æ–‡</li>
<li>æå–é¡µé¢æ–‡æœ¬å†…å®¹å’Œäº¤äº’å…ƒç´ ä¿¡æ¯</li>
</ul>
</li>
<li>
<p><strong>LLM å†³ç­–é˜¶æ®µ</strong>ï¼š</p>
<ul>
<li>å°†é¡µé¢çŠ¶æ€ã€ä»»åŠ¡æè¿°å’Œå†å²åŠ¨ä½œæ„å»ºä¸º LLM æ¶ˆæ¯</li>
<li>è°ƒç”¨ LLM è·å–ç»“æ„åŒ–è¾“å‡ºï¼ˆActionModelï¼‰</li>
<li>LLM åˆ†æé¡µé¢çŠ¶æ€ï¼Œå†³å®šä¸‹ä¸€æ­¥åŠ¨ä½œï¼ˆå¯¼èˆªã€ç‚¹å‡»ã€è¾“å…¥ç­‰ï¼‰</li>
</ul>
</li>
<li>
<p><strong>åŠ¨ä½œæ‰§è¡Œé˜¶æ®µ</strong>ï¼š</p>
<ul>
<li>Tools Registry å°†ç»“æ„åŒ–åŠ¨ä½œè½¬æ¢ä¸ºæµè§ˆå™¨äº‹ä»¶</li>
<li>BrowserSession é€šè¿‡ CDP æ‰§è¡Œæµè§ˆå™¨æ“ä½œ</li>
<li>Watchdog ç³»ç»Ÿç›‘æ§å¹¶å¤„ç†ç›¸å…³äº‹ä»¶ï¼ˆå¼¹çª—ã€ä¸‹è½½ç­‰ï¼‰</li>
</ul>
</li>
<li>
<p><strong>çŠ¶æ€è§‚å¯Ÿé˜¶æ®µ</strong>ï¼š</p>
<ul>
<li>ç­‰å¾…é¡µé¢ç¨³å®šï¼ˆDOM å˜åŒ–ã€ç½‘ç»œè¯·æ±‚å®Œæˆç­‰ï¼‰</li>
<li>è§‚å¯ŸåŠ¨ä½œæ‰§è¡Œç»“æœ</li>
<li>æ›´æ–°æ‰§è¡Œå†å²</li>
</ul>
</li>
<li>
<p><strong>è¿­ä»£å¾ªç¯</strong>ï¼š</p>
<ul>
<li>å¦‚æœä»»åŠ¡æœªå®Œæˆï¼Œè¿”å›æ­¥éª¤ 1 ç»§ç»­æ‰§è¡Œ</li>
<li>å¦‚æœä»»åŠ¡å®Œæˆæˆ–è¾¾åˆ°æœ€å¤§æ­¥æ•°ï¼Œç»“æŸå¾ªç¯</li>
</ul>
</li>
</ol>
<h4 data-id="heading-11">å†³ç­–ç‚¹åˆ†æ</h4>
<ul>
<li><strong>åŠ¨ä½œç±»å‹å†³ç­–ç‚¹</strong>ï¼šLLM æ ¹æ®é¡µé¢çŠ¶æ€å’Œä»»åŠ¡ç›®æ ‡ï¼Œå†³å®šæ‰§è¡Œå“ªç§ç±»å‹çš„åŠ¨ä½œ</li>
<li><strong>å…ƒç´ é€‰æ‹©å†³ç­–ç‚¹</strong>ï¼šLLM éœ€è¦ä»å¤šä¸ªå¯äº¤äº’å…ƒç´ ä¸­é€‰æ‹©æœ€åˆé€‚çš„å…ƒç´ è¿›è¡Œæ“ä½œ</li>
<li><strong>ä»»åŠ¡å®Œæˆå†³ç­–ç‚¹</strong>ï¼šLLM åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å·²å®Œæˆï¼Œå†³å®šæ˜¯å¦è°ƒç”¨ <code>done()</code> åŠ¨ä½œ</li>
<li><strong>é”™è¯¯æ¢å¤å†³ç­–ç‚¹</strong>ï¼šå½“åŠ¨ä½œæ‰§è¡Œå¤±è´¥æ—¶ï¼Œç³»ç»Ÿéœ€è¦å†³å®šæ˜¯é‡è¯•ã€è·³è¿‡è¿˜æ˜¯ç»ˆæ­¢ä»»åŠ¡</li>
</ul>
<h3 data-id="heading-12">æ ¸å¿ƒç»„ä»¶</h3>
<h4 data-id="heading-13">Agent æ™ºèƒ½ä½“ï¼ˆAgent Serviceï¼‰</h4>
<p><strong>èŒè´£</strong>ï¼šä½œä¸ºç³»ç»Ÿçš„æ ¸å¿ƒç¼–æ’å™¨ï¼Œè´Ÿè´£æ¥æ”¶ä»»åŠ¡ã€ç®¡ç†æµè§ˆå™¨ä¼šè¯ã€æ‰§è¡Œ LLM é©±åŠ¨çš„åŠ¨ä½œå¾ªç¯ï¼Œå¹¶ç»´æŠ¤æ‰§è¡Œå†å²ã€‚</p>
<p><strong>å·¥ä½œåŸç†</strong>ï¼šAgent é€šè¿‡ <code>step()</code> æ–¹æ³•æ‰§è¡Œå•æ­¥ä»»åŠ¡ï¼Œæ¯ä¸ªæ­¥éª¤åŒ…æ‹¬ï¼šå‡†å¤‡ä¸Šä¸‹æ–‡ï¼ˆè·å–é¡µé¢çŠ¶æ€ï¼‰ã€è°ƒç”¨ LLM è·å–åŠ¨ä½œå†³ç­–ã€æ‰§è¡ŒåŠ¨ä½œã€åå¤„ç†ã€‚Agent ç»´æŠ¤ä¸€ä¸ªåŠ¨ä½œå†å²åˆ—è¡¨ï¼Œè®°å½•æ‰€æœ‰æ‰§è¡Œçš„åŠ¨ä½œå’Œç»“æœï¼Œç”¨äº LLM çš„ä¸Šä¸‹æ–‡ç†è§£ã€‚</p>
<p><strong>å…³é”®å®ç°</strong>ï¼š</p>
<pre><code class="hljs language-124:150:browser-use/browser_use/agent/service.py" lang="124:150:browser-use/browser_use/agent/service.py">class Agent(Generic[Context, AgentStructuredOutput]):
	@time_execution_sync('--init')
	def __init__(
		self,
		task: str,
		llm: BaseChatModel | None = None,
		# Optional parameters
		browser_profile: BrowserProfile | None = None,
		browser_session: BrowserSession | None = None,
		browser: Browser | None = None,  # Alias for browser_session
		tools: Tools[Context] | None = None,
		controller: Tools[Context] | None = None,  # Alias for tools
		# Initial agent run parameters
		sensitive_data: dict[str, str | dict[str, str]] | None = None,
		initial_actions: list[dict[str, dict[str, Any]]] | None = None,
		# Cloud Callbacks
		register_new_step_callback: (
			Callable[['BrowserStateSummary', 'AgentOutput', int], None]  # Sync callback
			| Callable[['BrowserStateSummary', 'AgentOutput', int], Awaitable[None]]  # Async callback
			| None
		) = None,
		register_done_callback: (
			Callable[['AgentHistoryList'], Awaitable[None]]  # Async Callback
			| Callable[['AgentHistoryList'], None]  # Sync Callback
			| None
		) = None,
		register_external_agent_status_raise_error_callback: Callable[[], Awaitable[bool]] | None = None,
</code></pre>
<p>Agent çš„æ ¸å¿ƒæ‰§è¡Œå¾ªç¯ï¼š</p>
<pre><code class="hljs language-716:742:browser-use/browser_use/agent/service.py" lang="716:742:browser-use/browser_use/agent/service.py">	@observe(name='agent.step', ignore_output=True, ignore_input=True)
	@time_execution_async('--step')
	async def step(self, step_info: AgentStepInfo | None = None) -&gt; None:
		"""Execute one step of the task"""
		# Initialize timing first, before any exceptions can occur

		self.step_start_time = time.time()

		browser_state_summary = None

		try:
			# Phase 1: Prepare context and timing
			browser_state_summary = await self._prepare_context(step_info)

			# Phase 2: Get model output and execute actions
			await self._get_next_action(browser_state_summary)
			await self._execute_actions()

			# Phase 3: Post-processing
			await self._post_process()

		except Exception as e:
			# Handle ALL exceptions in one place
			await self._handle_step_error(e)

		finally:
			await self._finalize(browser_state_summary)
</code></pre>
<ul>
<li>æ”¯æŒæ•æ„Ÿæ•°æ®æ³¨å…¥ï¼Œè‡ªåŠ¨æ›¿æ¢æ•æ„Ÿä¿¡æ¯é¿å…æ³„éœ²</li>
<li>å®ç°æ‰§è¡Œå†å²ç®¡ç†ï¼Œè®°å½•æ‰€æœ‰åŠ¨ä½œå’Œç»“æœ</li>
<li>æ”¯æŒè‡ªå®šä¹‰å·¥å…·æ‰©å±•ï¼Œé€šè¿‡ Tools Registry æ³¨å†Œæ–°åŠ¨ä½œ</li>
<li>æä¾›å›è°ƒæœºåˆ¶ï¼Œæ”¯æŒäº‘ç«¯é›†æˆå’Œå¤–éƒ¨ç›‘æ§</li>
</ul>
<p><strong>ä¸å…¶ä»–ç»„ä»¶çš„å…³ç³»</strong>ï¼šAgent åè°ƒ BrowserSessionã€DomServiceã€Tools Registry å’Œ LLM é›†æˆï¼Œæ˜¯æ•´ä¸ªç³»ç»Ÿçš„æ ¸å¿ƒæ§åˆ¶å™¨ã€‚</p>
<h4 data-id="heading-14">BrowserSession æµè§ˆå™¨ä¼šè¯</h4>
<p><strong>èŒè´£</strong>ï¼šç®¡ç†æµè§ˆå™¨ç”Ÿå‘½å‘¨æœŸã€CDP è¿æ¥ã€äº‹ä»¶æ€»çº¿å’Œå¤šä¸ª Watchdog æœåŠ¡çš„åè°ƒã€‚</p>
<p><strong>å·¥ä½œåŸç†</strong>ï¼šBrowserSession ä½¿ç”¨ <code>cdp-use</code> åº“ç®¡ç† CDP å®¢æˆ·ç«¯è¿æ¥ï¼Œé€šè¿‡äº‹ä»¶æ€»çº¿ï¼ˆEventBusï¼‰åè°ƒå„ä¸ª Watchdog æœåŠ¡ã€‚å®ƒæä¾›é«˜çº§æµè§ˆå™¨æ“ä½œæ¥å£ï¼ˆå¯¼èˆªã€ç‚¹å‡»ã€è¾“å…¥ç­‰ï¼‰ï¼ŒåŒæ—¶æ”¯æŒç›´æ¥ CDP è°ƒç”¨ã€‚BrowserSession ç®¡ç†å¤šä¸ªæ ‡ç­¾é¡µå’Œ CDP ä¼šè¯ï¼Œç¡®ä¿èµ„æºæ­£ç¡®æ¸…ç†ã€‚</p>
<p><strong>å…³é”®å®ç°</strong>ï¼š</p>
<pre><code class="hljs language-94:100:browser-use/browser_use/browser/session.py" lang="94:100:browser-use/browser_use/browser/session.py">class BrowserSession(BaseModel):
	"""Event-driven browser session with backwards compatibility.

	This class provides a 2-layer architecture:
	- High-level event handling for agents/tools
	- Direct CDP/Playwright calls for browser operations
</code></pre>
<ul>
<li>äº‹ä»¶é©±åŠ¨çš„æµè§ˆå™¨ç®¡ç†ï¼Œæ‰€æœ‰æ“ä½œé€šè¿‡äº‹ä»¶ç³»ç»Ÿè¿›è¡Œ</li>
<li>æ”¯æŒæœ¬åœ°æµè§ˆå™¨å’Œäº‘ç«¯æµè§ˆå™¨ï¼ˆBrowser Use Cloudï¼‰</li>
<li>å®ç° CDP ä¼šè¯ç¼“å­˜ï¼Œæé«˜æ€§èƒ½</li>
<li>æä¾›æµè§ˆå™¨çŠ¶æ€å¿«ç…§åŠŸèƒ½ï¼ŒåŒ…æ‹¬æˆªå›¾å’Œ DOM æ ‘</li>
</ul>
<p><strong>ä¸å…¶ä»–ç»„ä»¶çš„å…³ç³»</strong>ï¼šBrowserSession æ˜¯æµè§ˆå™¨æ“ä½œçš„åŸºç¡€è®¾æ–½ï¼Œä¸º Agentã€Tools å’Œ DomService æä¾›æµè§ˆå™¨è®¿é—®èƒ½åŠ›ã€‚</p>
<h4 data-id="heading-15">DomService DOM å¤„ç†æœåŠ¡</h4>
<p><strong>èŒè´£</strong>ï¼šæå–å’Œå¤„ç† DOM å†…å®¹ï¼Œå¤„ç†å…ƒç´ é«˜äº®å’Œå¯è®¿é—®æ€§æ ‘ç”Ÿæˆã€‚</p>
<p><strong>å·¥ä½œåŸç†</strong>ï¼šDomService é€šè¿‡ CDP è·å– DOM æ ‘å’Œå¯è®¿é—®æ€§æ ‘ï¼Œè¿›è¡Œå¢å¼ºå¤„ç†ï¼ˆè®¡ç®—æ ·å¼ã€å¸ƒå±€ä¿¡æ¯ç­‰ï¼‰ï¼Œç”Ÿæˆåºåˆ—åŒ–çš„ DOM çŠ¶æ€ä¾› LLM ä½¿ç”¨ã€‚å®ƒæ”¯æŒ iframe å¤„ç†ã€è·¨åŸŸ iframe é™åˆ¶ã€ç»˜åˆ¶é¡ºåºè¿‡æ»¤ç­‰åŠŸèƒ½ï¼Œç¡®ä¿ LLM èƒ½å¤Ÿå‡†ç¡®ç†è§£é¡µé¢ç»“æ„ã€‚</p>
<p><strong>å…³é”®å®ç°</strong>ï¼š</p>
<pre><code class="hljs language-34:60:browser-use/browser_use/dom/service.py" lang="34:60:browser-use/browser_use/dom/service.py">class DomService:
	"""
	Service for getting the DOM tree and other DOM-related information.

	Either browser or page must be provided.

	TODO: currently we start a new websocket connection PER STEP, we should definitely keep this persistent
	"""

	logger: logging.Logger

	def __init__(
		self,
		browser_session: 'BrowserSession',
		logger: logging.Logger | None = None,
		cross_origin_iframes: bool = False,
		paint_order_filtering: bool = True,
		max_iframes: int = 100,
		max_iframe_depth: int = 5,
	):
		self.browser_session = browser_session
		self.logger = logger or browser_session.logger
		self.cross_origin_iframes = cross_origin_iframes
		self.paint_order_filtering = paint_order_filtering
		self.max_iframes = max_iframes
		self.max_iframe_depth = max_iframe_depth
</code></pre>
<ul>
<li>æ”¯æŒå¢å¼ºçš„ DOM å¿«ç…§ï¼ŒåŒ…å«è®¡ç®—æ ·å¼å’Œå¸ƒå±€ä¿¡æ¯</li>
<li>ç”Ÿæˆå¯è®¿é—®æ€§æ ‘ï¼Œæé«˜ LLM å¯¹é¡µé¢ç»“æ„çš„ç†è§£</li>
<li>å®ç°å…ƒç´ é«˜äº®åŠŸèƒ½ï¼Œå¯è§†åŒ– LLM é€‰æ‹©çš„å…ƒç´ </li>
<li>æ”¯æŒ iframe åµŒå¥—å’Œè·¨åŸŸé™åˆ¶</li>
</ul>
<p><strong>ä¸å…¶ä»–ç»„ä»¶çš„å…³ç³»</strong>ï¼šDomService ä¸º Agent æä¾›é¡µé¢çŠ¶æ€ä¿¡æ¯ï¼Œæ˜¯ LLM å†³ç­–çš„é‡è¦æ•°æ®æºã€‚</p>
<h4 data-id="heading-16">Tools Registry å·¥å…·æ³¨å†Œè¡¨</h4>
<p><strong>èŒè´£</strong>ï¼šå°† LLM çš„ç»“æ„åŒ–åŠ¨ä½œå†³ç­–æ˜ å°„åˆ°æµè§ˆå™¨æ“ä½œï¼Œç®¡ç†æ‰€æœ‰å¯ç”¨çš„æµè§ˆå™¨åŠ¨ä½œã€‚</p>
<p><strong>å·¥ä½œåŸç†</strong>ï¼šTools Registry ä½¿ç”¨è£…é¥°å™¨æ¨¡å¼æ³¨å†ŒåŠ¨ä½œå‡½æ•°ï¼Œæ¯ä¸ªåŠ¨ä½œå‡½æ•°æ¥æ”¶åŠ¨ä½œå‚æ•°å’Œ BrowserSessionï¼Œæ‰§è¡Œç›¸åº”çš„æµè§ˆå™¨æ“ä½œå¹¶è¿”å›ç»“æœã€‚Registry ç»´æŠ¤ä¸€ä¸ªåŠ¨ä½œæ¨¡å‹åˆ°æ‰§è¡Œå‡½æ•°çš„æ˜ å°„ï¼Œæ”¯æŒåŠ¨ä½œéªŒè¯å’Œé”™è¯¯å¤„ç†ã€‚</p>
<p><strong>å…³é”®å®ç°</strong>ï¼š</p>
<pre><code class="hljs language-105:150:browser-use/browser_use/tools/service.py" lang="105:150:browser-use/browser_use/tools/service.py">class Tools(Generic[Context]):
	def __init__(
		self,
		exclude_actions: list[str] | None = None,
		output_model: type[T] | None = None,
		display_files_in_done_text: bool = True,
	):
		self.registry = Registry[Context](exclude_actions if exclude_actions is not None else [])
		self.display_files_in_done_text = display_files_in_done_text

		"""Register all default browser actions"""

		self._register_done_action(output_model)

		# Basic Navigation Actions
		@self.registry.action(
			'',
			param_model=SearchAction,
		)
		async def search(params: SearchAction, browser_session: BrowserSession):
			import urllib.parse

			# Encode query for URL safety
			encoded_query = urllib.parse.quote_plus(params.query)

			# Build search URL based on search engine
			search_engines = {
				'duckduckgo': f'https://duckduckgo.com/?q={encoded_query}',
				'google': f'https://www.google.com/search?q={encoded_query}&amp;udm=14',
				'bing': f'https://www.bing.com/search?q={encoded_query}',
			}

			if params.engine.lower() not in search_engines:
				return ActionResult(error=f'Unsupported search engine: {params.engine}. Options: duckduckgo, google, bing')

			search_url = search_engines[params.engine.lower()]

			# Simple tab logic: use current tab by default
			use_new_tab = False

			# Dispatch navigation event
			try:
				event = browser_session.event_bus.dispatch(
					NavigateToUrlEvent(
						url=search_url,
						new_tab=use_new_tab,
</code></pre>
<ul>
<li>æ”¯æŒè‡ªå®šä¹‰åŠ¨ä½œæ³¨å†Œï¼Œç”¨æˆ·å¯ä»¥æ‰©å±•å·¥å…·èƒ½åŠ›</li>
<li>å®ç°åŠ¨ä½œå‚æ•°éªŒè¯ï¼Œç¡®ä¿ç±»å‹å®‰å…¨</li>
<li>æä¾›é”™è¯¯å¤„ç†å’Œç»“æœæ ¼å¼åŒ–</li>
<li>æ”¯æŒæ•æ„Ÿæ•°æ®æ£€æµ‹å’Œæ›¿æ¢</li>
</ul>
<p><strong>ä¸å…¶ä»–ç»„ä»¶çš„å…³ç³»</strong>ï¼šTools Registry è¿æ¥ LLM å†³ç­–å’Œæµè§ˆå™¨æ“ä½œï¼Œæ˜¯åŠ¨ä½œæ‰§è¡Œçš„å…³é”®æ¡¥æ¢ã€‚</p>
<h4 data-id="heading-17">Watchdog ç³»ç»Ÿ</h4>
<p><strong>èŒè´£</strong>ï¼šè‡ªåŠ¨ç›‘æ§å’Œå¤„ç†æµè§ˆå™¨äº‹ä»¶ï¼Œå‡å°‘æ™ºèƒ½ä½“çš„è´Ÿæ‹…ã€‚</p>
<p><strong>å·¥ä½œåŸç†</strong>ï¼šWatchdog ç³»ç»Ÿç”±å¤šä¸ªä¸“é—¨çš„ Watchdog æœåŠ¡ç»„æˆï¼Œæ¯ä¸ªæœåŠ¡ç›‘å¬ç‰¹å®šç±»å‹çš„äº‹ä»¶å¹¶è‡ªåŠ¨å¤„ç†ã€‚ä¾‹å¦‚ï¼ŒPopupsWatchdog è‡ªåŠ¨å¤„ç† JavaScript å¼¹çª—ï¼ŒDownloadsWatchdog ç®¡ç†æ–‡ä»¶ä¸‹è½½ï¼ŒDOMWatchdog å¤„ç† DOM å¿«ç…§å’Œæˆªå›¾ç”Ÿæˆã€‚</p>
<p><strong>ä¸»è¦ Watchdog ç±»å‹</strong>ï¼š</p>
<ul>
<li><strong>DOMWatchdog</strong>ï¼šå¤„ç† DOM å¿«ç…§ã€æˆªå›¾å’Œå…ƒç´ é«˜äº®</li>
<li><strong>PopupsWatchdog</strong>ï¼šè‡ªåŠ¨å¤„ç† JavaScript å¯¹è¯æ¡†å’Œå¼¹çª—</li>
<li><strong>DownloadsWatchdog</strong>ï¼šç®¡ç†æ–‡ä»¶ä¸‹è½½å’Œå­˜å‚¨</li>
<li><strong>SecurityWatchdog</strong>ï¼šå¼ºåˆ¶æ‰§è¡ŒåŸŸåé™åˆ¶å’Œå®‰å…¨ç­–ç•¥</li>
<li><strong>CrashWatchdog</strong>ï¼šç›‘æ§æµè§ˆå™¨å´©æºƒå¹¶å°è¯•æ¢å¤</li>
<li><strong>AboutBlankWatchdog</strong>ï¼šå¤„ç†ç©ºç™½é¡µé‡å®šå‘</li>
<li><strong>PermissionsWatchdog</strong>ï¼šå¤„ç†æƒé™è¯·æ±‚ï¼ˆå¦‚åœ°ç†ä½ç½®ã€é€šçŸ¥ç­‰ï¼‰</li>
</ul>
<p><strong>ä¸å…¶ä»–ç»„ä»¶çš„å…³ç³»</strong>ï¼šWatchdog ç³»ç»Ÿé€šè¿‡äº‹ä»¶æ€»çº¿ä¸ BrowserSession é›†æˆï¼Œè‡ªåŠ¨å¤„ç†æµè§ˆå™¨äº‹ä»¶ï¼Œä¸º Agent æä¾›ç¨³å®šçš„æ‰§è¡Œç¯å¢ƒã€‚</p>
<h4 data-id="heading-18">LLM é›†æˆå±‚</h4>
<p><strong>èŒè´£</strong>ï¼šæä¾›ç»Ÿä¸€çš„ LLM æ¥å£ï¼Œæ”¯æŒå¤šç§ LLM æä¾›å•†ã€‚</p>
<p><strong>å·¥ä½œåŸç†</strong>ï¼šLLM é›†æˆå±‚å®šä¹‰äº† <code>BaseChatModel</code> æŠ½è±¡åŸºç±»ï¼Œå„ä¸ªæä¾›å•†å®ç°å…·ä½“çš„èŠå¤©æ¨¡å‹ç±»ã€‚æ”¯æŒ OpenAIã€Anthropicã€Googleã€Groqã€Ollama ç­‰å¤šç§æä¾›å•†ï¼Œæä¾›ç»Ÿä¸€çš„æ¥å£å’Œæ¶ˆæ¯æ ¼å¼ã€‚</p>
<p><strong>æ”¯æŒçš„ LLM æä¾›å•†</strong>ï¼š</p>
<ul>
<li><strong>ChatBrowserUse</strong>ï¼šBrowser-Use ä¼˜åŒ–çš„ä¸“ç”¨æ¨¡å‹ï¼Œé’ˆå¯¹æµè§ˆå™¨è‡ªåŠ¨åŒ–ä»»åŠ¡ä¼˜åŒ–</li>
<li><strong>ChatOpenAI</strong>ï¼šOpenAI GPT ç³»åˆ—æ¨¡å‹</li>
<li><strong>ChatAnthropic</strong>ï¼šAnthropic Claude ç³»åˆ—æ¨¡å‹</li>
<li><strong>ChatGoogle</strong>ï¼šGoogle Gemini ç³»åˆ—æ¨¡å‹</li>
<li><strong>ChatGroq</strong>ï¼šGroq æä¾›çš„å¿«é€Ÿæ¨ç†æ¨¡å‹</li>
<li><strong>ChatOllama</strong>ï¼šæœ¬åœ°è¿è¡Œçš„ Ollama æ¨¡å‹</li>
</ul>
<p><strong>ä¸å…¶ä»–ç»„ä»¶çš„å…³ç³»</strong>ï¼šLLM é›†æˆå±‚ä¸º Agent æä¾›å†³ç­–èƒ½åŠ›ï¼Œæ˜¯æ™ºèƒ½åŒ–çš„æ ¸å¿ƒç»„ä»¶ã€‚</p>
<h3 data-id="heading-19">ç¼ºç‚¹</h3>
<ul>
<li><strong>æ€§èƒ½å¼€é”€</strong>ï¼šæ¯ä¸ªæ­¥éª¤éƒ½éœ€è¦è°ƒç”¨ LLMï¼Œå¯¹äºç®€å•ä»»åŠ¡å¯èƒ½æ•ˆç‡è¾ƒä½ï¼ŒToken æ¶ˆè€—è¾ƒå¤§</li>
<li><strong>ä¸Šä¸‹æ–‡çª—å£é™åˆ¶</strong>ï¼šé•¿ä»»åŠ¡å¯èƒ½å¯¼è‡´ä¸Šä¸‹æ–‡çª—å£æº¢å‡ºï¼Œéœ€è¦å®ç°ä¸Šä¸‹æ–‡å‹ç¼©æˆ–æ€»ç»“æœºåˆ¶</li>
<li><strong>LLM å†³ç­–ä¸ç¡®å®šæ€§</strong>ï¼šLLM å¯èƒ½åšå‡ºé”™è¯¯çš„å†³ç­–ï¼Œéœ€è¦å¤šæ¬¡é‡è¯•æˆ–äººå·¥å¹²é¢„</li>
<li><strong>æˆæœ¬é—®é¢˜</strong>ï¼šé¢‘ç¹è°ƒç”¨ LLM API å¯èƒ½äº§ç”Ÿè¾ƒé«˜çš„æˆæœ¬ï¼Œç‰¹åˆ«æ˜¯ä½¿ç”¨é«˜æ€§èƒ½æ¨¡å‹æ—¶</li>
<li><strong>æµè§ˆå™¨èµ„æºæ¶ˆè€—</strong>ï¼šæ¯ä¸ª Agent å®ä¾‹éœ€è¦ç‹¬ç«‹çš„æµè§ˆå™¨è¿›ç¨‹ï¼Œå¹¶å‘æ‰§è¡Œæ—¶èµ„æºæ¶ˆè€—è¾ƒå¤§</li>
<li><strong>CAPTCHA å¤„ç†</strong>ï¼šæ— æ³•è‡ªåŠ¨å¤„ç† CAPTCHAï¼Œéœ€è¦ä¾èµ– Browser Use Cloud çš„éšèº«æµè§ˆå™¨åŠŸèƒ½</li>
<li><strong>åŠ¨æ€å†…å®¹å¤„ç†</strong>ï¼šå¯¹äºé«˜åº¦åŠ¨æ€çš„ Web åº”ç”¨ï¼ˆå¦‚ SPAï¼‰ï¼Œå¯èƒ½éœ€è¦ç­‰å¾…è¾ƒé•¿æ—¶é—´æ‰èƒ½ç¨³å®š</li>
<li><strong>é”™è¯¯æ¢å¤æœºåˆ¶</strong>ï¼šå½“åŠ¨ä½œæ‰§è¡Œå¤±è´¥æ—¶ï¼Œé”™è¯¯æ¢å¤ç­–ç•¥å¯èƒ½ä¸å¤Ÿæ™ºèƒ½ï¼Œå¯¼è‡´ä»»åŠ¡å¤±è´¥</li>
<li><strong>è°ƒè¯•å›°éš¾</strong>ï¼šLLM é©±åŠ¨çš„å†³ç­–è¿‡ç¨‹æ˜¯é»‘ç›’çš„ï¼Œè°ƒè¯•å’Œé—®é¢˜å®šä½è¾ƒä¸ºå›°éš¾</li>
<li><strong>ä¾èµ– CDP</strong>ï¼šå®Œå…¨ä¾èµ– Chrome DevTools Protocolï¼Œé™åˆ¶äº†æµè§ˆå™¨å…¼å®¹æ€§</li>
<li><strong>å­¦ä¹ æ›²çº¿</strong>ï¼šéœ€è¦ç†è§£äº‹ä»¶é©±åŠ¨æ¶æ„å’Œ Watchdog ç³»ç»Ÿï¼Œå¯¹æ–°æ‰‹ä¸å¤Ÿå‹å¥½</li>
<li><strong>æ–‡æ¡£å®Œæ•´æ€§</strong>ï¼šéƒ¨åˆ†é«˜çº§åŠŸèƒ½çš„æ–‡æ¡£å¯èƒ½ä¸å¤Ÿå®Œå–„ï¼Œéœ€è¦é˜…è¯»æºä»£ç ç†è§£</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§æ¨¡å‹æ˜¯â€œä¸¥è°¨ç†å·¥ç”·â€è¿˜æ˜¯â€œæµªæ¼«è¯—äººâ€ï¼Ÿæ¶æ„å¸ˆæ‰‹ä¸­çš„ä¸¤æŠŠè°ƒæ•™â€œå¯†é’¥â€ï¼šTemperature ä¸ Top-P]]></title>    <link>https://juejin.cn/post/7591350620188950534</link>    <guid>https://juejin.cn/post/7591350620188950534</guid>    <pubDate>2026-01-04T14:37:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591350620188950534" data-draft-id="7591334602427220031" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§æ¨¡å‹æ˜¯â€œä¸¥è°¨ç†å·¥ç”·â€è¿˜æ˜¯â€œæµªæ¼«è¯—äººâ€ï¼Ÿæ¶æ„å¸ˆæ‰‹ä¸­çš„ä¸¤æŠŠè°ƒæ•™â€œå¯†é’¥â€ï¼šTemperature ä¸ Top-P"/> <meta itemprop="keywords" content="å¤§æ•°æ®"/> <meta itemprop="datePublished" content="2026-01-04T14:37:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€ç›´åœ¨è¿½"/> <meta itemprop="url" content="https://juejin.cn/user/239028506736411"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§æ¨¡å‹æ˜¯â€œä¸¥è°¨ç†å·¥ç”·â€è¿˜æ˜¯â€œæµªæ¼«è¯—äººâ€ï¼Ÿæ¶æ„å¸ˆæ‰‹ä¸­çš„ä¸¤æŠŠè°ƒæ•™â€œå¯†é’¥â€ï¼šTemperature ä¸ Top-P
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/239028506736411/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€ç›´åœ¨è¿½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T14:37:19.000Z" title="Sun Jan 04 2026 14:37:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ğŸ’¡ æœ¬æ–‡ä»·å€¼æç¤º</h3>
<blockquote>
<p><strong>ä½ æ˜¯å¦é‡åˆ°è¿‡è¿™ç§æƒ…å†µ</strong>ï¼šåŒä¸€ä¸ª Promptï¼Œæœ‰æ—¶å€™æ¨¡å‹å›ç­”å¾—ä¸€æœ¬æ­£ç»ï¼Œæœ‰æ—¶å€™å´èƒ¡è¨€ä¹±è¯­ï¼Ÿæˆ–è€…ä½ æƒ³è®©æ¨¡å‹å†™ä»£ç ï¼Œå®ƒå´ç»™ä½ ç¼–é€ äº†ä¸€ä¸ªä¸å­˜åœ¨çš„åº“ï¼Ÿ</p>
<p>ä½œä¸ºä»å¤§æ•°æ®è½¬å‹è€Œæ¥çš„æ¶æ„å¸ˆï¼Œä½ ä¹ æƒ¯äº† SQL æŸ¥è¯¢ç»“æœçš„â€œç¡®å®šæ€§â€ï¼ˆ1+1 æ°¸è¿œç­‰äº 2ï¼‰ã€‚ä½†åœ¨ AI çš„ä¸–ç•Œé‡Œï¼Œ<strong>â€œæ¦‚ç‡â€æ‰æ˜¯ç‹é“</strong>ã€‚</p>
<p>æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥ LLM çš„â€œå¤§è„‘çš®å±‚â€ï¼Œæ­ç¤ºæ§åˆ¶æ¨¡å‹è¾“å‡ºæ€§æ ¼çš„ä¸¤ä¸ªæ ¸å¿ƒå‚æ•°â€”â€”<strong>Temperature</strong> å’Œ <strong>Top-P</strong>ã€‚æŒæ¡å®ƒä»¬ï¼Œä½ å°±èƒ½åœ¨â€œç²¾å‡†çš„ä¸šåŠ¡é€»è¾‘â€å’Œâ€œå‘æ•£çš„åˆ›æ„ç”Ÿæˆâ€ä¹‹é—´è‡ªç”±åˆ‡æ¢ï¼ŒçœŸæ­£é©¾é©­æ¨¡å‹ï¼Œè€Œä¸æ˜¯è¢«æ¨¡å‹â€œæŠ½å¥–â€èˆ¬çš„ç»“æœæ‰€å›°æ‰°ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">ğŸ¬ å‰æƒ…å›é¡¾ä¸å¼•å…¥</h3>
<p>ğŸ‘‹ å¤§å®¶å¥½ï¼æ¬¢è¿å›åˆ°æˆ‘ä»¬çš„**â€œå¤§æ•°æ®å·¥ç¨‹å¸ˆè½¬å‹ AI æ¶æ„å¸ˆâ€**ç³»åˆ—ã€‚</p>
<p>åœ¨ä¸Šä¸€ç¯‡ã€Šæ‹†è§£å¤§æ¨¡å‹â€œå¿ƒè„â€ï¼šBERTä¸GPTçš„ç›¸çˆ±ç›¸æ€ï¼ˆæ¶æ„å¸ˆè¿›é˜¶æŒ‡å—ï¼‰ã€‹ä¸­ï¼Œæˆ‘ä»¬å­¦ä¼šäº†å¦‚ä½•æŠŠä¸‡äº‹ä¸‡ç‰©å˜æˆå‘é‡ï¼Œæ‰”è¿›å‘é‡æ•°æ®åº“é‡Œåšè¯­ä¹‰æ£€ç´¢ã€‚è¿™è®©æˆ‘ä»¬æ‹¥æœ‰äº†å¼ºå¤§çš„â€œè®°å¿†åº“â€ï¼ˆRAG çš„åŸºç¡€ï¼‰ã€‚</p>
<p>ä½†æ˜¯ï¼Œå…‰æœ‰è®°å¿†æ˜¯ä¸å¤Ÿçš„ã€‚å½“æ¨¡å‹æ£€ç´¢åˆ°ä¿¡æ¯ï¼Œå‡†å¤‡å¼€å£è¯´è¯æ—¶ï¼Œ<strong>å®ƒè¯¥æ€ä¹ˆè¯´ï¼Ÿ</strong> æ˜¯åƒæ³•å®˜ä¸€æ ·å­—æ–Ÿå¥é…Œï¼Ÿè¿˜æ˜¯åƒè„±å£ç§€æ¼”å‘˜ä¸€æ ·å¤©é©¬è¡Œç©ºï¼Ÿ</p>
<p>è¿™å°±æ¶‰åŠåˆ°äº†å¤§æ¨¡å‹æ¨ç†ï¼ˆInferenceï¼‰é˜¶æ®µæœ€å…³é”®çš„**â€œæ§åˆ¶è®ºâ€**ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬è¦æ‰“å¼€å¤§æ¨¡å‹çš„é»‘ç›’ï¼Œè°ƒæ•´ä¸¤ä¸ªå†³å®šå®ƒâ€œæ€§æ ¼â€çš„æ—‹é’®ã€‚</p>
<hr/>
<h3 data-id="heading-2">ğŸ² ç¬¬ä¸€éƒ¨åˆ†ï¼šå¤§æ¨¡å‹çš„æœ¬è´¨â€”â€”ä¸€åœºâ€œæ–‡å­—æ¥é¾™â€çš„èµŒå±€</h3>
<p>åœ¨ç†è§£å‚æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»å…ˆæ‰“ç ´ä¸€ä¸ªå¹»æƒ³ï¼š<strong>å¤§æ¨¡å‹å…¶å®å¹¶ä¸â€œæ€è€ƒâ€ï¼Œå®ƒåªæ˜¯åœ¨â€œçŒœâ€ä¸‹ä¸€ä¸ªå­—ã€‚</strong></p>
<p>å½“ä½ è¾“å…¥â€œä»Šå¤©å¤©æ°”çœŸâ€çš„æ—¶å€™ï¼Œæ¨¡å‹å†…éƒ¨ä¼šè®¡ç®—è¯åº“ä¸­æ‰€æœ‰è¯å‡ºç°çš„<strong>æ¦‚ç‡åˆ†å¸ƒ</strong>ï¼š</p>
<ul>
<li><strong>â€œå¥½â€</strong>ï¼šæ¦‚ç‡ 70%</li>
<li><strong>â€œä¸é”™â€</strong>ï¼šæ¦‚ç‡ 20%</li>
<li><strong>â€œç³Ÿç³•â€</strong>ï¼šæ¦‚ç‡ 9%</li>
<li><strong>â€œè‹¹æœâ€</strong>ï¼šæ¦‚ç‡ 0.001% ï¼ˆå®Œå…¨ä¸é€šé¡ºï¼‰</li>
</ul>
<p>æ¨¡å‹æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª<strong>è¶…é«˜ç»´åº¦çš„æ¦‚ç‡é¢„æµ‹æœº</strong>ã€‚</p>
<p>ğŸ‘‰ <strong>æ¶æ„å¸ˆè§†è§’çš„å·®å¼‚</strong>ï¼š</p>
<ul>
<li><strong>ä¼ ç»Ÿç¨‹åº</strong>ï¼š<code>if input == "A" return "B"</code>ï¼ˆç¡®å®šæ€§ï¼‰ã€‚</li>
<li><strong>å¤§æ¨¡å‹</strong>ï¼š<code>input "A" -&gt; P(B)=0.8, P(C)=0.2</code>ï¼ˆéšæœºæ€§ï¼‰ã€‚</li>
</ul>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼š<strong>æ¨¡å‹æ˜¯æ¯æ¬¡éƒ½é€‰æ¦‚ç‡æœ€å¤§çš„é‚£ä¸ªè¯å—ï¼Ÿ</strong>
ç­”æ¡ˆæ˜¯ï¼š<strong>ä¸ä¸€å®šã€‚</strong> è¿™å®Œå…¨å–å†³äºä½ å¦‚ä½•è®¾ç½®æ¥ä¸‹æ¥çš„ä¸¤ä¸ªå‚æ•°ã€‚</p>
<hr/>
<h3 data-id="heading-3">ğŸŒ¡ï¸ ç¬¬äºŒéƒ¨åˆ†ï¼šTemperatureï¼ˆæ¸©åº¦ï¼‰â€”â€”ç»™æ¦‚ç‡åˆ†å¸ƒâ€œåŠ çƒ­â€</h3>
<p><strong>Temperature</strong> æ˜¯æœ€å¸¸ç”¨çš„å‚æ•°ï¼Œé€šå¸¸èŒƒå›´åœ¨ 0 åˆ° 2 ä¹‹é—´ã€‚</p>
<h4 data-id="heading-4">1. æ ¸å¿ƒåŸç†ï¼šå†°ä¸ç«ä¹‹æ­Œ ğŸ”¥â„ï¸</h4>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œæ¨¡å‹çš„å€™é€‰è¯æ¦‚ç‡æ˜¯ä¸€å—<strong>æ©¡çš®æ³¥</strong>ã€‚</p>
<ul>
<li>
<p><strong>â„ï¸ ä½æ¸© (Low Temperature, e.g., 0.1 - 0.3)</strong> ï¼š</p>
<ul>
<li><strong>æ•ˆæœ</strong>ï¼šç›¸å½“äºæŠŠæ©¡çš®æ³¥<strong>å†·å†»</strong>ä½ã€‚æ¦‚ç‡é«˜çš„è¯ï¼ˆå±±å³°ï¼‰ä¼šå˜å¾—æ›´é«˜ï¼Œæ¦‚ç‡ä½çš„è¯ï¼ˆå±±è°·ï¼‰ä¼šå˜å¾—æ›´ä½ã€‚</li>
<li><strong>è¡Œä¸º</strong>ï¼šæ¨¡å‹å˜å¾—æå…¶<strong>ä¿å®ˆã€è‡ªä¿¡ã€æ­»æ¿</strong>ã€‚å®ƒå‡ ä¹åªé€‰æ¦‚ç‡æœ€é«˜çš„é‚£ä¸ªè¯ã€‚</li>
<li><strong>äººè®¾</strong>ï¼šä¸¥è°¨çš„<strong>ç†å·¥ç”·</strong>ã€ä¼šè®¡å¸ˆã€ä»£ç å®¡æŸ¥å‘˜ã€‚</li>
</ul>
</li>
<li>
<p><strong>ğŸ”¥ é«˜æ¸© (High Temperature, e.g., 0.7 - 1.0+)</strong> ï¼š</p>
<ul>
<li><strong>æ•ˆæœ</strong>ï¼šç›¸å½“äºç»™æ©¡çš®æ³¥<strong>åŠ çƒ­</strong>ï¼Œå®ƒèåŒ–äº†ï¼Œæ‘Šå¹³äº†ã€‚åŸæœ¬æ¦‚ç‡é«˜çš„è¯ï¼Œä¼˜åŠ¿ä¸å†æ˜æ˜¾ï¼›åŸæœ¬æ¦‚ç‡ä½çš„è¯ï¼Œä¹Ÿæœ‰æœºä¼šè¢«é€‰ä¸­ã€‚</li>
<li><strong>è¡Œä¸º</strong>ï¼šæ¨¡å‹å˜å¾—<strong>å¤šæ ·ã€æ´»è·ƒã€ä¸å¯é¢„æµ‹</strong>ã€‚å®ƒå¯èƒ½ä¼šé€‰ä¸€äº›å†·é—¨çš„è¯ï¼Œå¸¦æ¥æƒŠå–œï¼ˆæˆ–æƒŠå“ï¼‰ã€‚</li>
<li><strong>äººè®¾</strong>ï¼šæµªæ¼«çš„<strong>è¯—äºº</strong>ã€ç–¯ç™«çš„è‰ºæœ¯å®¶ã€é†‰é…’çš„èŠå¤©ä¼´ä¾£ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-5">2. æµç¨‹å›¾è§£ï¼šæ¸©åº¦å¦‚ä½•å½±å“é€‰æ‹©</h4>
<p><img src="http://openwrite.cn/uploads/20235/58067/8b44ccd0-1e48-4b41-91a5-34d87c863dcb.png" alt="image.png" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-6">ğŸ¯ ç¬¬ä¸‰éƒ¨åˆ†ï¼šTop-P (Nucleus Sampling) â€”â€” è®¾ç«‹â€œVIP é—¨æ§›â€</h3>
<p>é™¤äº†æ¸©åº¦ï¼Œè¿˜æœ‰ä¸€ä¸ªå‚æ•°å« <strong>Top-P</strong>ï¼ˆé€šå¸¸è®¾ä¸º 0.1 åˆ° 1.0ï¼‰ã€‚å¾ˆå¤šåˆå­¦è€…å®¹æ˜“æŠŠå®ƒå’Œ Temperature ææ··ã€‚</p>
<h4 data-id="heading-7">1. æ ¸å¿ƒåŸç†ï¼šåˆ‡æ–­é•¿å°¾ âœ‚ï¸</h4>
<p>å¦‚æœè¯´ Temperature æ˜¯æ”¹å˜æ¦‚ç‡åˆ†å¸ƒçš„<strong>å½¢çŠ¶</strong>ï¼ˆå˜å°–æˆ–å˜å¹³ï¼‰ï¼Œé‚£ä¹ˆ Top-P å°±æ˜¯åœ¨<strong>åˆ’å®šå€™é€‰æ± çš„èŒƒå›´</strong>ã€‚</p>
<p>Top-P = 0.9 æ„å‘³ç€ï¼š<strong>â€œåªåœ¨ç´¯ç§¯æ¦‚ç‡è¾¾åˆ° 90% çš„å‰å‡ ä¸ªè¯é‡Œè¿›è¡Œé€‰æ‹©ï¼Œå‰©ä¸‹çš„åƒåœ¾è¯æˆ‘çœ‹éƒ½ä¸çœ‹ã€‚â€</strong></p>
<ul>
<li><strong>åœºæ™¯æ¨¡æ‹Ÿ</strong>ï¼š
<ul>
<li>è¯åº“é‡Œæœ‰ 10000 ä¸ªè¯ã€‚</li>
<li>å‰ 5 ä¸ªè¯ï¼ˆè‹¹æœã€é¦™è•‰...ï¼‰åŠ èµ·æ¥æ¦‚ç‡å°±åˆ°äº† 90%ã€‚</li>
<li>å¦‚æœ Top-P = 0.9ï¼Œæ¨¡å‹å°±åªåœ¨è¿™ 5 ä¸ªè¯é‡Œæ·éª°å­ã€‚åé¢ 9995 ä¸ªè¯ï¼ˆæ¯”å¦‚â€œæ‹–æ‹‰æœºâ€ã€â€œå¤–æ˜Ÿäººâ€ï¼‰ç›´æ¥è¢«<strong>æˆªæ–­</strong>ï¼ˆTruncatedï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-8">2. ä¸ºä»€ä¹ˆè¦ç”¨ Top-Pï¼Ÿ</h4>
<p>å®ƒå¯ä»¥é˜²æ­¢æ¨¡å‹åœ¨é«˜æ¸©ä¸‹â€œå½»åº•å‘ç–¯â€ã€‚å³ä½¿ Temperature å¾ˆé«˜ï¼ŒTop-P ä¹Ÿèƒ½ä¿è¯æ¨¡å‹é€‰çš„è¯è‡³å°‘æ˜¯â€œé è°±åœˆå­â€é‡Œçš„ï¼Œé¿å…é€‰å‡ºæ¦‚ç‡æä½ã€é€»è¾‘å®Œå…¨ä¸é€šçš„è¯ã€‚</p>
<hr/>
<h3 data-id="heading-9">ğŸ—ï¸ ç¬¬å››éƒ¨åˆ†ï¼šæ¶æ„å¸ˆçš„å†³ç­–æŒ‡å—â€”â€”åœºæ™¯åŒ–é…ç½®</h3>
<p>ä½œä¸ºæ¶æ„å¸ˆï¼Œä½ çš„ä»·å€¼ä¸åœ¨äºçŸ¥é“è¿™äº›å‚æ•°çš„å®šä¹‰ï¼Œè€Œåœ¨äº<strong>é’ˆå¯¹ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ï¼Œåˆ¶å®šæœ€ä½³çš„å‚æ•°ç»„åˆç­–ç•¥</strong>ã€‚</p>
<p>è¿™æ˜¯æˆ‘ä¸ºä½ æ€»ç»“çš„ <strong>â€œé»„é‡‘é…ç½®è¡¨â€</strong>ï¼š</p>















































<table><thead><tr><th align="left">ä¸šåŠ¡åœºæ™¯</th><th align="left">æ¨è Temp</th><th align="left">æ¨è Top-P</th><th align="left">ç†ç”±</th><th align="left">é£é™©æç¤º</th></tr></thead><tbody><tr><td align="left"><strong>ä»£ç ç”Ÿæˆ / SQL è½¬æ¢</strong></td><td align="left"><strong>0</strong></td><td align="left">1.0</td><td align="left">ä»£ç å®¹é”™ç‡æä½ï¼Œå¿…é¡»ç²¾å‡†ï¼Œä¸èƒ½æœ‰éšæœºæ€§ã€‚</td><td align="left">è®¾ä¸º 0 æ—¶ï¼Œæ¨¡å‹å¯èƒ½é™·å…¥é‡å¤å¾ªç¯ã€‚</td></tr><tr><td align="left"><strong>æ•°æ®æå– (JSON)</strong></td><td align="left"><strong>0 - 0.1</strong></td><td align="left">1.0</td><td align="left">æ ¼å¼å¿…é¡»ä¸¥æ ¼ï¼ŒKey/Value ä¸èƒ½ä¹±ç¼–ã€‚</td><td align="left">åŒä¸Šã€‚</td></tr><tr><td align="left"><strong>RAG (çŸ¥è¯†åº“é—®ç­”)</strong></td><td align="left"><strong>0.1 - 0.3</strong></td><td align="left">0.9</td><td align="left">åŸºäºäº‹å®å›ç­”ï¼Œéœ€è¦ä¸¥è°¨ï¼Œä½†ä¿ç•™å¾®å°æ¶¦è‰²ç©ºé—´ã€‚</td><td align="left">æ¸©åº¦è¿‡é«˜ä¼šå¯¼è‡´â€œå¹»è§‰â€ï¼Œç¼–é€ æ–‡æ¡£é‡Œæ²¡æœ‰çš„å†…å®¹ã€‚</td></tr><tr><td align="left"><strong>é€šç”¨èŠå¤©æœºå™¨äºº</strong></td><td align="left"><strong>0.5 - 0.7</strong></td><td align="left">0.9</td><td align="left">éœ€è¦åƒäººä¸€æ ·è‡ªç„¶ï¼Œå¤ªæ­»æ¿ä¼šåƒå¤è¯»æœºã€‚</td><td align="left">å¶å°”ä¼šä¸€æœ¬æ­£ç»åœ°èƒ¡è¯´å…«é“ã€‚</td></tr><tr><td align="left"><strong>åˆ›æ„å†™ä½œ / è¥é”€æ–‡æ¡ˆ</strong></td><td align="left"><strong>0.8 - 1.0</strong></td><td align="left">0.8 - 0.9</td><td align="left">éœ€è¦è„‘æ´ï¼Œæ‹’ç»é™ˆè¯æ»¥è°ƒã€‚</td><td align="left">é€»è¾‘æ€§å¯èƒ½å˜å·®ï¼Œéœ€è¦äººå·¥å®¡æ ¸ã€‚</td></tr></tbody></table>
<h4 data-id="heading-10">ğŸ’¡ æ¶æ„å¸ˆçš„å®æˆ˜å¿ƒæ³•ï¼š</h4>
<ol>
<li><strong>æ§åˆ¶å¹»è§‰ (Hallucination)</strong>ï¼š
åœ¨é‡‘èã€åŒ»ç–—ç­‰ä¸¥è‚ƒåœºæ™¯ï¼Œ<strong>Temperature å¿…é¡»å‹ä½</strong>ã€‚ä½ ç»å¯¹ä¸å¸Œæœ› AI å¸®ä½ ç”Ÿæˆçš„è´¢åŠ¡æŠ¥è¡¨é‡Œå‡ºç°ä¸€ä¸ªéšæœºæ•°å­—ã€‚</li>
<li><strong>äº’æ–¥å…³ç³»</strong>ï¼š
è™½ç„¶ OpenAI æ–‡æ¡£å»ºè®®â€œTemperature å’Œ Top-P æœ€å¥½åªè°ƒä¸€ä¸ªâ€ï¼Œä½†åœ¨å®é™…å·¥ç¨‹ä¸­ï¼Œé€šå¸¸çš„åšæ³•æ˜¯ï¼š<strong>å›ºå®š Top-P (å¦‚ 0.9) ä»¥ä¿è¯ä¸‹é™ï¼Œç„¶ååŠ¨æ€è°ƒæ•´ Temperature ä»¥æ§åˆ¶ä¸Šé™ã€‚</strong></li>
<li><strong>æ–¹å·®æµ‹è¯•</strong>ï¼š
å¦‚ä½•éªŒè¯ä½ çš„ Prompt æ˜¯å¦ç¨³å®šï¼ŸæŠŠ Temperature è®¾ä¸º 0.7ï¼Œè¿ç»­è°ƒç”¨ 5 æ¬¡ã€‚å¦‚æœ 5 æ¬¡ç»“æœæ„æ€å®Œå…¨ä¸ä¸€æ ·ï¼Œè¯´æ˜ä½ çš„ Prompt çº¦æŸåŠ›ä¸å¤Ÿï¼Œæˆ–è€…æ¨¡å‹æœ¬èº«å¯¹è¯¥é¢†åŸŸçŸ¥è¯†æŒæ¡ä¸ç‰¢ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-11">ğŸ“ å®è·µä»»åŠ¡ï¼šäº²æ‰‹â€œè°ƒæˆâ€æ¨¡å‹</h3>
<p>ä¸è¦å…‰çœ‹ï¼Œå»å†™ä»£ç ï¼ä½¿ç”¨ Python è°ƒç”¨ API æ—¶ï¼Œå°è¯•ä¿®æ”¹è¿™ä¸¤ä¸ªå‚æ•°ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> openai

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_response</span>(<span class="hljs-params">prompt, temp</span>):
    response = openai.ChatCompletion.create(
        model=<span class="hljs-string">"gpt-3.5-turbo"</span>,
        messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: prompt}],
        temperature=temp,  <span class="hljs-comment"># &lt;--- å…³é”®åœ¨è¿™é‡Œ</span>
    )
    <span class="hljs-keyword">return</span> response.choices[<span class="hljs-number">0</span>].message.content

prompt = <span class="hljs-string">"è¯·ç”¨ä¸‰ä¸ªè¯å½¢å®¹ä¸€ä¸‹å¤§æ•°æ®å·¥ç¨‹å¸ˆã€‚"</span>

<span class="hljs-comment"># å®éªŒ 1ï¼šä¸¥è°¨æ¨¡å¼</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"Temp=0.1: <span class="hljs-subst">{get_response(prompt, <span class="hljs-number">0.1</span>)}</span>"</span>)
<span class="hljs-comment"># è¾“å‡ºå¯èƒ½æ˜¯ï¼šä¸“ä¸šã€ä¸¥è°¨ã€æŠ€æœ¯æ§ (æ¯æ¬¡è¿è¡Œå‡ ä¹éƒ½ä¸€æ ·)</span>

<span class="hljs-comment"># å®éªŒ 2ï¼šç–¯ç™«æ¨¡å¼</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"Temp=1.2: <span class="hljs-subst">{get_response(prompt, <span class="hljs-number">1.2</span>)}</span>"</span>)
<span class="hljs-comment"># è¾“å‡ºå¯èƒ½æ˜¯ï¼šæ•°æ®çš„é©¯å…½å¸ˆã€é”®ç›˜ä¸Šçš„èˆè€…ã€ç†¬å¤œå† å†› (æ¯æ¬¡è¿è¡Œéƒ½ä¸åŒï¼Œç”šè‡³å‡ºç°æ€ªè¯)</span>
</code></pre>
<hr/>
<h3 data-id="heading-12">ğŸ§  æ€»ç»“ï¼šä»åŸç†åˆ°æ¶æ„çš„æ€ç»´å¯¼å›¾</h3>
<p>è®©æˆ‘ä»¬ç”¨ä¸€å¼ å›¾æ¥æ€»ç»“ä»Šå¤©çš„å†…å®¹ï¼Œè¿™æ˜¯ä½ ä½œä¸ºæ¶æ„å¸ˆçŸ¥è¯†åº“ä¸­çš„é‡è¦æ‹¼å›¾ï¼š</p>
<p><img src="http://openwrite.cn/uploads/20235/58067/b27bc28f-a7b2-4da6-9e81-1198e96a66e0.png" alt="image.png" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-13">ğŸ§© æ¶æ„å¸ˆçš„å®Œæ•´æ‹¼å›¾ï¼šLLM æ ¸å¿ƒé“¾è·¯å¤ç›˜</h3>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº† <strong>â€œå¤§æ¨¡å‹åŸºç¡€ç†è®ºâ€</strong> è¿™ä¸€ä¸“é¢˜çš„å…¨éƒ¨å­¦ä¹ ã€‚ä½œä¸ºæ¶æ„å¸ˆï¼Œå½“ä½ å†æ¬¡å®¡è§†ä¸€ä¸ª AI åº”ç”¨æ—¶ï¼Œä¸åº”å†æŠŠå®ƒçœ‹ä½œä¸€ä¸ªé»‘ç›’ï¼Œè€Œæ˜¯ä¸€æ¡æ¸…æ™°çš„æ•°æ®æµæ°´çº¿ï¼š</p>
<ol>
<li><strong>ğŸ§± æ•°æ®å…¥å£ (Tokenization)</strong> ï¼š
ä¸€åˆ‡å§‹äºåˆ†è¯ã€‚å®ƒæ˜¯è®¡è´¹çš„å•ä½ï¼Œä¹Ÿæ˜¯ä¸Šä¸‹æ–‡çª—å£çš„ç‰©ç†é™åˆ¶ã€‚ä½ æ˜ç™½äº†ä¸ºä»€ä¹ˆä¸­æ–‡å’Œè‹±æ–‡çš„æ¶ˆè€—ä¸åŒï¼Œä¹Ÿæ‡‚å¾—äº†å¦‚ä½•åœ¨æœ‰é™çš„çª—å£å†…â€œç²¾æ‰“ç»†ç®—â€ã€‚</li>
<li><strong>ğŸ§  æ ¸å¿ƒå¼•æ“ (Transformer)</strong> ï¼š
è¿™æ˜¯å¿ƒè„ã€‚é€šè¿‡ Attention æœºåˆ¶ï¼Œæ¨¡å‹ä¸å†æ˜¯æ­»è®°ç¡¬èƒŒï¼Œè€Œæ˜¯å­¦ä¼šäº†â€œå…³æ³¨â€ä¸Šä¸‹æ–‡çš„å…³è”ã€‚ä½ äº†è§£äº† Encoderï¼ˆç†è§£ï¼‰ä¸ Decoderï¼ˆç”Ÿæˆï¼‰çš„åŒºåˆ«ï¼Œä»è€Œèƒ½ä¸ºä¸åŒçš„ä¸šåŠ¡é€‰æ‹©æ­£ç¡®çš„æ¨¡å‹æ¶æ„ã€‚</li>
<li><strong>ğŸŒ‰ è¯­ä¹‰æ¡¥æ¢ (Embedding)</strong> ï¼š
è¿™æ˜¯è¿æ¥äººç±»è¯­è¨€ä¸æœºå™¨æ•°å­¦çš„éš§é“ã€‚é€šè¿‡å‘é‡åŒ–ï¼Œæˆ‘ä»¬å°†æ¨¡ç³Šçš„â€œè¯­ä¹‰â€å˜æˆäº†å¯è®¡ç®—çš„â€œè·ç¦»â€ã€‚è¿™æ˜¯ä½ æ„å»ºä¼ä¸šçº§çŸ¥è¯†åº“ï¼ˆRAGï¼‰å’Œè¯­ä¹‰æœç´¢çš„åŸºçŸ³ã€‚</li>
<li><strong>ğŸ›ï¸ è¾“å‡ºæ§åˆ¶ (Temperature)</strong> ï¼š
è¿™æ˜¯æœ€åä¸€é“é˜€é—¨ã€‚é€šè¿‡è°ƒæ•´æ¦‚ç‡åˆ†å¸ƒï¼Œä½ æŒæ¡äº†æ¨¡å‹çš„â€œæ€§æ ¼â€ã€‚ä½ ä¸å†è¢«åŠ¨æ¥å—ç»“æœï¼Œè€Œæ˜¯ä¸»åŠ¨æƒè¡¡â€œç²¾å‡†â€ä¸â€œåˆ›æ„â€ï¼Œè®©æ¨¡å‹åœ¨ä¸¥è°¨çš„é€»è¾‘ä¸å‘æ•£çš„æ€ç»´é—´è‡ªç”±åˆ‡æ¢ã€‚</li>
</ol>
<p><strong>è¿™å››ä¸ªç¯èŠ‚ï¼Œæ„æˆäº†å¤§æ¨¡å‹åº”ç”¨çš„â€œéª¨æ¶â€ã€‚</strong> æŒæ¡äº†å®ƒä»¬ï¼Œä½ å°±æ‹¥æœ‰äº†é€è¿‡ç°è±¡çœ‹æœ¬è´¨çš„èƒ½åŠ›ï¼Œä¸å†è¢«å±‚å‡ºä¸ç©·çš„æ–°åè¯è¿·æƒ‘ï¼Œè€Œæ˜¯èƒ½ä»åº•å±‚åŸç†å‡ºå‘ï¼Œè®¾è®¡å‡ºç¨³å¥ã€é«˜æ•ˆçš„ AI æ¶æ„ã€‚</p>
<hr/>
<h3 data-id="heading-14">ğŸ’¬ äº’åŠ¨è¯é¢˜</h3>
<p><strong>ä½ åœ¨ä½¿ç”¨ ChatGPT æˆ–å¼€å‘åº”ç”¨æ—¶ï¼Œæœ‰æ²¡æœ‰é‡åˆ°è¿‡å› ä¸º Temperature è®¾ç½®è¿‡é«˜è€Œäº§ç”Ÿçš„â€œç¥å›å¤â€æˆ–ç¦»è°±çš„å¹»è§‰ï¼Ÿ</strong></p>
<p>æ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„â€œç¿»è½¦ç°åœºâ€ï¼Œè®©æˆ‘ä»¬ä¸€èµ·çœ‹çœ‹ AI å–é†‰äº†æ˜¯ä»€ä¹ˆæ ·å­ï¼ğŸ‘‡ğŸ‘‡ğŸ‘‡</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[èŠèŠä¸Šä¸‹æ–‡å·¥ç¨‹ğŸ‘·]]></title>    <link>https://juejin.cn/post/7591360623469805578</link>    <guid>https://juejin.cn/post/7591360623469805578</guid>    <pubDate>2026-01-04T15:32:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591360623469805578" data-draft-id="7589564203872583743" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="èŠèŠä¸Šä¸‹æ–‡å·¥ç¨‹ğŸ‘·"/> <meta itemprop="keywords" content="LLM,è®¾è®¡æ¨¡å¼"/> <meta itemprop="datePublished" content="2026-01-04T15:32:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å°å°æ€ªå…½"/> <meta itemprop="url" content="https://juejin.cn/user/3940246036166776"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            èŠèŠä¸Šä¸‹æ–‡å·¥ç¨‹ğŸ‘·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3940246036166776/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å°å°æ€ªå…½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T15:32:00.000Z" title="Sun Jan 04 2026 15:32:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»26åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;color:rgba(46,36,36,.87);overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{margin-bottom:5px;font-size:30px;font-weight:500}.markdown-body h1:before{content:"#";margin-right:10px;color:#1976d2}.markdown-body h2{font-size:28px;font-weight:400;border-left:5px solid #454545;margin-top:20px;padding-left:10px;transition:all .3s ease-in-out}.markdown-body h2:hover{border-color:#1976d2}.markdown-body h3{font-size:24px;font-weight:400;margin-top:15px;padding-bottom:0}.markdown-body h4{font-size:20px;font-weight:500}.markdown-body h5{font-size:16px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h2:first-letter,.markdown-body h3:first-letter,.markdown-body p:first-letter{text-transform:capitalize}.markdown-body em{text-emphasis:dot;text-emphasis-position:under}.markdown-body img{display:block;margin:0 auto!important;max-width:100%;border-radius:2px;box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)!important}.markdown-body hr{position:relative;width:98%;height:1px;border:none;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,#ddd,#999,#ddd);overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background:#fff;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center}.markdown-body code{font-weight:900;word-break:break-word;border-radius:2px;overflow-x:auto;font-size:.87em;padding:.065em .4em;background-color:#fbe5e1;color:#c0341d}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:0 4px}.markdown-body pre&gt;code{font-weight:400;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{margin:0 4px;text-decoration:none;color:#027fff;transition:all .3s ease-in-out;padding-bottom:4px;border-bottom:2px solid transparent}.markdown-body a:after{content:"";display:inline-block;width:18px;height:18px;margin-left:4px;vertical-align:middle;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMjdGRkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PHBhdGggZD0iTTkuODE1IDYuNDQ4bDEuOTM2LTEuOTM2YzEuMzM3LTEuMzM2IDMuNTgtMS4yNTkgNS4wMTMuMTczIDEuNDMyIDEuNDMyIDEuNTEgMy42NzYuMTczIDUuMDEzbC0xLjQ1MiAxLjQ1Mi0uOTY4Ljk2OGMtMS4zMzcgMS4zMzYtMy41ODEgMS4yNTktNS4wMTMtLjE3MyIvPjxwYXRoIGQ9Ik0xMS4yNjcgMTUuMzY3bC0xLjkzNiAxLjkzNmMtMS4zMzYgMS4zMzctMy41OCAxLjI2LTUuMDEyLS4xNzMtMS40MzItMS40MzItMS41MS0zLjY3Ni0uMTczLTUuMDEybDEuNDUyLTEuNDUyLjk2OC0uOTY4YzEuMzM2LTEuMzM3IDMuNTgtMS4yNiA1LjAxMi4xNzMiLz48L2c+PC9zdmc+);background-size:cover;background-repeat:no-repeat}.markdown-body a:hover{border-color:#027fff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body a.footnote-backref:after,.markdown-body a.footnote-ref:after,.markdown-body sup a:after{display:none!important}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border:2px solid #c6c6c6}.markdown-body table img{box-shadow:none!important}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body del{color:rgba(0,0,0,.6)}.markdown-body blockquote{position:relative;color:#666;padding:5px 23px 1px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:hsla(0,0%,78.4%,.12);transition:all .2s ease-in-out}.markdown-body blockquote:hover{border-color:#1976d2}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;font-size:24px;font-weight:800;line-height:24px;color:#cbcbcb;opacity:.6}.markdown-body blockquote:before{content:"â€œ";top:4px;left:6px}.markdown-body blockquote:after{content:"â€";right:8px;bottom:-8px}.markdown-body blockquote&gt;p,.markdown-body blockquote blockquote{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body details{outline:none;border:none;border-left:4px solid #1976d2;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary:hover::-webkit-details-marker{color:#1976d2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å¼•è¨€ï¼šèŠä¸€èŠæç¤ºè¯å·¥ç¨‹</h2>
<h3 data-id="heading-1">ï¼ˆä¸€ï¼‰ä»€ä¹ˆæ˜¯æç¤ºå·¥ç¨‹</h3>
<p>Promptingæ˜¯äººä¸å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰äº¤äº’çš„æ ¸å¿ƒæ¥å£ï¼Œé€šè¿‡ç²¾å¿ƒè®¾è®¡è¾“å…¥å†…å®¹ï¼Œå¼•å¯¼æ¨¡å‹ç”Ÿæˆç¬¦åˆé¢„æœŸçš„è¾“å‡ºç»“æœã€‚æç¤ºå·¥ç¨‹ä½œä¸ºä¸€é—¨ä¸“é—¨çš„å·¥ç¨‹å­¦ç§‘ï¼Œæ ¸å¿ƒå†…æ¶µåŒ…æ‹¬ï¼šç»“æ„åŒ–è®¾è®¡è¯·æ±‚ã€æä¾›ç²¾å‡†ä¸Šä¸‹æ–‡ã€æŒ‡å®šè¾“å‡ºæ ¼å¼è§„èŒƒã€å®šä¹‰å“åº”ç±»å‹æ ‡å‡†ç­‰å…³é”®åŠ¨ä½œã€‚</p>
<p>ä¼˜è´¨çš„æç¤ºè¯è¯­èƒ½æœ€å¤§åŒ–æ¿€æ´»æ¨¡å‹èƒ½åŠ›ï¼Œè¾“å‡ºå‡†ç¡®ã€ç›¸å…³æ€§å¼ºä¸”å…·å¤‡åˆ›é€ æ€§çš„ç»“æœï¼›åä¹‹ï¼Œè®¾è®¡ä¸å½“çš„æç¤ºè¯å¯èƒ½ä¼šå¯¼è‡´æ¨¡å‹è¾“å‡ºæ¨¡ç³Šã€åç¦»ä¸»é¢˜ç”šè‡³å‡ºç°é”™è¯¯çš„å†…å®¹ã€‚åœ¨æ™ºèƒ½ä½“ç³»ç»Ÿå¼€å‘ä¸­ï¼Œæç¤ºå·¥ç¨‹æ›´æ˜¯è¿æ¥é€šç”¨LLMä¸ä¸“ç”¨ä¸šåŠ¡åœºæ™¯çš„æ¡¥æ¢ï¼Œç›´æ¥å†³å®šæ™ºèƒ½ä½“çš„è§„åˆ’èƒ½åŠ›ã€å·¥å…·ä½¿ç”¨æ•ˆç‡ã€è®°å¿†ç®¡ç†æ•ˆæœä¸åä½œå¯é æ€§ã€‚</p>
<h3 data-id="heading-2">ï¼ˆäºŒï¼‰æç¤ºå·¥ç¨‹çš„æ ¸å¿ƒç›®æ ‡</h3>
<p>æç¤ºå·¥ç¨‹çš„ç»ˆæç›®æ ‡æ˜¯æŒç»­è·å–é«˜è´¨é‡çš„æ¨¡å‹å“åº”ï¼Œè¿™éœ€è¦å¼€å‘è€…åŒæ—¶å…·å¤‡ä¸¤é¡¹æ ¸å¿ƒèƒ½åŠ›ï¼š</p>
<ol>
<li>æ·±åˆ»ç†è§£ç›®æ ‡æ¨¡å‹çš„èƒ½åŠ›è¾¹ç•Œï¼ˆå¦‚ä¸Šä¸‹æ–‡çª—å£å¤§å°ã€æ¨ç†æé™ã€å¤šæ¨¡æ€æ”¯æŒç¨‹åº¦ï¼‰ï¼›</li>
<li>ç²¾å‡†ä¼ è¾¾ä¸šåŠ¡æ„å›¾çš„è¡¨è¾¾èƒ½åŠ›ã€‚</li>
</ol>
<p>æœ¬æ–‡å°†ç³»ç»Ÿè¦†ç›–ä»åŸºç¡€äº¤äº’åˆ°å¤æ‚æ™ºèƒ½ä½“å¼€å‘çš„å…¨æµç¨‹æç¤ºæŠ€æœ¯ï¼Œä¸ºä¸åŒå±‚çº§çš„åº”ç”¨å¼€å‘æä¾›å¯è½åœ°çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-3">äºŒã€æç¤ºè¯å·¥ç¨‹çš„äº”å¤§åŸåˆ™</h2>
<p>å¥½çš„æç¤ºè®¾è®¡ä¸æ˜¯å®Œå…¨ä¾èµ–ä¸»è§‚ç»éªŒï¼Œè€Œæ˜¯å»ºç«‹åœ¨ä¸€å¥—é€šç”¨æ ¸å¿ƒåŸåˆ™ä¹‹ä¸Šã€‚è¿™äº›åŸåˆ™é€‚ç”¨äºå„ç±»LLMä¸ä¸åŒå¤æ‚åº¦çš„ä»»åŠ¡ï¼Œæ˜¯å¤§æ¨¡å‹ç¨³å®šäº§å‡ºä¼˜è´¨è¾“å‡ºçš„åŸºç¡€ã€‚</p>
<h3 data-id="heading-4">ï¼ˆä¸€ï¼‰æ¸…æ™°å…·ä½“ï¼šæ¶ˆé™¤æ­§ä¹‰ï¼Œç²¾å‡†å®šä¹‰ä»»åŠ¡</h3>
<p>LLMçš„æ ¸å¿ƒå·¥ä½œæœºåˆ¶æ˜¯æ¨¡å¼è¯†åˆ«ï¼Œæ¨¡ç³Šçš„æŒ‡ä»¤ä¼šå¯¼è‡´æ¨¡å‹è¯¯åˆ¤ä»»åŠ¡æ–¹å‘ã€‚è®¾è®¡æç¤ºæ—¶éœ€æ˜ç¡®ä¸‰ä¸ªæ ¸å¿ƒè¦ç´ ï¼š<strong>ä»»åŠ¡ç›®æ ‡</strong>ã€<strong>è¾“å‡ºæ ¼å¼</strong>ã€<strong>çº¦æŸæ¡ä»¶</strong>ï¼Œé¿å…ä½¿ç”¨æ¨¡ç³Šè¡¨è¿°æˆ–è®©æ¨¡å‹è¿›è¡Œä¸»è§‚å‡è®¾ã€‚</p>
<p><strong>åä¾‹</strong>ï¼šåˆ†æä¸€ä¸‹è¿™ä¸ªäº§å“æ•°æ®  - ï¼ˆæœªæ˜ç¡®åˆ†æç»´åº¦ã€è¾“å‡ºå½¢å¼ã€æ•°æ®èŒƒå›´ï¼‰ï¼›</p>
<p><strong>æ­£ä¾‹</strong>ï¼šåˆ†æ2025å¹´ç¬¬ä¸‰å­£åº¦æŸå“ç‰Œæ‰‹æœºçš„é”€å”®æ•°æ®ï¼Œä»åŒºåŸŸåˆ†å¸ƒã€ä»·æ ¼æ®µå æ¯”ä¸¤ä¸ªç»´åº¦ç”Ÿæˆåˆ†æç»“è®ºï¼Œè¾“å‡ºæ ¼å¼ä¸ºâ€˜1. åŒºåŸŸåˆ†å¸ƒï¼šXXXï¼›2. ä»·æ ¼æ®µå æ¯”ï¼šXXXâ€™ï¼Œæ•°æ®èŒƒå›´è§é™„ä»¶è¡¨æ ¼æ‘˜è¦ã€‚</p>
<h3 data-id="heading-5">ï¼ˆäºŒï¼‰ç®€æ´ç²¾ç‚¼ï¼šå»å†—ä½™ï¼Œèšç„¦æ ¸å¿ƒä¿¡æ¯</h3>
<p>åœ¨ä¿è¯ä»»åŠ¡æè¿°å®Œæ•´çš„å‰æä¸‹ï¼Œæç¤ºè¯åº”è¯¥å°½é‡ç®€æ˜æ‰¼è¦ã€‚å¤šä½™çš„ä¿®é¥°è¯­ã€å¤æ‚çš„å¥å¼ç»“æ„ä¼šå¹²æ‰°æ¨¡å‹å¯¹æ ¸å¿ƒæŒ‡ä»¤çš„è¯†åˆ«ã€‚å»ºè®®ç”¨ç›´æ¥çš„è¡¨è¾¾å’ŒåŠ¨ä½œï¼Œä¾‹å¦‚ï¼šåˆ†æï¼ˆAnalyzeï¼‰ã€åˆ†ç±»ï¼ˆClassifyï¼‰ã€å¯¹æ¯”ï¼ˆCompareï¼‰ã€ç”Ÿæˆï¼ˆGenerateï¼‰ã€æå–ï¼ˆExtractï¼‰ã€æ€»ç»“ï¼ˆSummarizeï¼‰ã€ç¿»è¯‘ï¼ˆTranslateï¼‰ç­‰ã€‚</p>
<p><strong>ä¼˜åŒ–ç¤ºä¾‹</strong>ï¼š</p>
<p>è¯·ä½ æ€è€ƒä¸€ä¸‹å¯¹ä¸‹é¢è¿™æ®µæ–‡æœ¬è¿›è¡Œæ€»ç»“è¿™ä»¶äº‹ï¼ˆåŸæç¤ºï¼‰</p>
<hr/>
<p>æ€»ç»“ä»¥ä¸‹æ–‡æœ¬ï¼š[æ–‡æœ¬å†…å®¹] ï¼ˆä¼˜åŒ–ï¼‰</p>
<h3 data-id="heading-6">ï¼ˆä¸‰ï¼‰ç²¾å‡†åŠ¨è¯ï¼šæ¿€æ´»æ¨¡å‹å¯¹åº”å¤„ç†é€»è¾‘</h3>
<p>åŠ¨è¯çš„é€‰æ‹©ç›´æ¥å†³å®šæ¨¡å‹å¯¹ä»»åŠ¡ç±»å‹çš„åˆ¤æ–­ã€‚ç²¾å‡†çš„åŠ¨è¯èƒ½å¿«é€Ÿæ¿€æ´»æ¨¡å‹ä¸­å¯¹åº”çš„è®­ç»ƒæ•°æ®ä¸å¤„ç†æµç¨‹ï¼Œæå‡å“åº”æ•ˆç‡ä¸å‡†ç¡®æ€§ã€‚</p>
<p><strong>åœºæ™¯ç¤ºä¾‹</strong>ï¼š</p>
<ul>
<li>ä¿¡æ¯æå–ä»»åŠ¡ï¼šä½¿ç”¨<code>æå–</code>è€Œé<code>æ‰¾å‡º</code>ï¼Œå¦‚ï¼šä»ä»¥ä¸‹åˆåŒæ–‡æœ¬ä¸­æå–ç”²æ–¹åç§°ã€ç­¾çº¦æ—¥æœŸã€è¿çº¦è´£ä»»æ¡æ¬¾ï¼›</li>
<li>åˆ›æ„ç”Ÿæˆä»»åŠ¡ï¼šä½¿ç”¨<code>åˆ›ä½œ</code>è€Œé<code>å†™ä¸€ä¸‹</code>ï¼Œå¦‚: ä¸ºxxå“ç‰Œåˆ›ä½œ3æ¡é€‚åˆç¤¾äº¤åª’ä½“ä¼ æ’­çš„å¹¿å‘Šè¯­ï¼Œé£æ ¼æ´»æ³¼å¹´è½»åŒ–ã€‚</li>
</ul>
<h3 data-id="heading-7">ï¼ˆå››ï¼‰æ­£é¢æŒ‡ä»¤ï¼šæ˜ç¡®åšä»€ä¹ˆè€Œéä¸åšä»€ä¹ˆ</h3>
<p>æ­£é¢æŒ‡ä»¤æ¯”è´Ÿé¢çº¦æŸæ›´ç¬¦åˆäººç±»çš„æŒ‡å¯¼ä¹ æƒ¯ï¼Œä¹Ÿæ›´å®¹æ˜“è¢«LLMç†è§£ã€‚è¿‡åº¦å¼ºè°ƒ<strong>ä¸è¦åšä»€ä¹ˆ</strong>ä¼šè®©æ¨¡å‹èšç„¦äºè§„é¿é”™è¯¯ï¼Œè€Œéè¾¾æˆæ ¸å¿ƒç›®æ ‡ï¼›å»ºè®®åªæœ‰åœ¨å®‰å…¨è§„èŒƒæˆ–æ ¼å¼ç¡¬æ€§è¦æ±‚æ—¶ä½¿ç”¨çº¦æŸæ€§è¡¨è¿°ã€‚</p>
<p><strong>åä¾‹</strong>ï¼šå†™ä¸€ç¯‡äº§å“ä»‹ç»ï¼Œä¸è¦å¤ªå®˜æ–¹ã€ä¸è¦å¤ªé•¿ã€ä¸è¦é—æ¼æ ¸å¿ƒåŠŸèƒ½ï¼›</p>
<p><strong>æ­£ä¾‹</strong>ï¼šå†™ä¸€ç¯‡300å­—ä»¥å†…çš„äº§å“ä»‹ç»ï¼Œé£æ ¼å£è¯­åŒ–ï¼ŒåŒ…å«æ ¸å¿ƒåŠŸèƒ½ï¼šå¿«é€Ÿå……ç”µã€è¶…é•¿ç»­èˆªã€é˜²æ°´é˜²å°˜ã€‚</p>
<h3 data-id="heading-8">ï¼ˆäº”ï¼‰å®éªŒè¿­ä»£ï¼šåŠ¨æ€ä¼˜åŒ–æç¤ºæ–¹æ¡ˆ</h3>
<p>æç¤ºå·¥ç¨‹ä¸å­˜åœ¨ä¸‡èƒ½æ¨¡æ¿ï¼Œæœ€ä¼˜æç¤ºå¾€å¾€éœ€è¦é€šè¿‡å¤šæ¬¡è¿­ä»£è·å¾—ã€‚</p>
<p>æ ‡å‡†è¿­ä»£æµç¨‹ä¸ºï¼š<strong>èµ·è‰åˆå§‹æç¤º â†’ æµ‹è¯•æ¨¡å‹å“åº” â†’ åˆ†æè¾“å‡ºé—®é¢˜ï¼ˆå¦‚é—æ¼ä¿¡æ¯ã€æ ¼å¼é”™è¯¯ã€é€»è¾‘åå·®ï¼‰ â†’ ä¼˜åŒ–æç¤ºç»†èŠ‚ â†’ å†æ¬¡æµ‹è¯•ã€‚</strong></p>
<p>å»ºè®®è®°å½•æ¯æ¬¡çš„æç¤ºç‰ˆæœ¬ã€æ¨¡å‹å‚æ•°ä¸è¾“å‡ºç»“æœï¼Œå½¢æˆè¿­ä»£æ—¥å¿—ï¼Œå¸®åŠ©åˆ¤æ–­æœ€ä¼˜æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-9">ä¸‰ã€åŸºç¡€æç¤ºè¯æŠ€æœ¯</h2>
<p>åŸºç¡€æç¤ºæŠ€æœ¯é€šè¿‡æä¾›ä¸åŒæ•°é‡çš„ç¤ºä¾‹å¼•å¯¼æ¨¡å‹å“åº”ï¼Œé€‚ç”¨äºä»ç®€å•é—®ç­”åˆ°ç»“æ„åŒ–æ•°æ®å¤„ç†çš„å¹¿æ³›åœºæ™¯ã€‚</p>
<h3 data-id="heading-10">ï¼ˆä¸€ï¼‰é›¶æ ·æœ¬æç¤ºï¼šåŸºç¡€ä»»åŠ¡çš„å¿«é€Ÿé€‚é…</h3>
<p>é›¶æ ·æœ¬æç¤ºæ˜¯æœ€ç®€æ´çš„æç¤ºæ–¹å¼ï¼Œä»…åŒ…å«ä»»åŠ¡æè¿°ä¸è¾“å…¥æ•°æ®ï¼Œä¸æä¾›ä»»ä½•ç¤ºä¾‹ï¼Œå®Œå…¨ä¾èµ–æ¨¡å‹çš„é¢„è®­ç»ƒçŸ¥è¯†å®Œæˆä»»åŠ¡ã€‚</p>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šæ¨¡å‹è®­ç»ƒæ•°æ®ä¸­é«˜é¢‘å‡ºç°çš„åŸºç¡€ä»»åŠ¡ï¼Œå¦‚ç®€å•ç¿»è¯‘ã€æ–‡æœ¬è¡¥å…¨ã€åŸºç¡€é—®ç­”ã€å…³é”®è¯æå–ç­‰ã€‚</p>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<p>ä»»åŠ¡ï¼šå°†ä¸­æ–‡å¥å­ç¿»è¯‘æˆè‹±æ–‡ï¼›</p>
<p>æç¤ºï¼šå°†ä»¥ä¸‹ä¸­æ–‡å¥å­ç¿»è¯‘æˆè‹±æ–‡ï¼šâ€˜äººå·¥æ™ºèƒ½æŠ€æœ¯æ­£åœ¨é‡å¡‘å„è¡Œå„ä¸šçš„å‘å±•æ¨¡å¼ã€‚â€™ï¼›</p>
<p>é¢„æœŸè¾“å‡ºï¼šâ€œArtificial intelligence technology is reshaping the development model of various industries.â€</p>
<h3 data-id="heading-11">ï¼ˆäºŒï¼‰å•æ ·æœ¬æç¤ºï¼šç‰¹æ®Šæ ¼å¼/é£æ ¼çš„å¿«é€Ÿå¯¹é½</h3>
<p>å½“æœŸæœ›è¾“å‡ºçš„æ ¼å¼æˆ–é£æ ¼è¾ƒä¸ºç‰¹æ®Šæ—¶ï¼Œå•æ ·æœ¬æç¤ºé€šè¿‡æä¾›1ç»„â€œè¾“å…¥-è¾“å‡ºâ€ç¤ºä¾‹ï¼Œå¸®åŠ©æ¨¡å‹å¿«é€Ÿç†è§£ä»»åŠ¡æ¨¡å¼ï¼Œæå‡å“åº”å‡†ç¡®æ€§ã€‚</p>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<p>å®šåˆ¶åŒ–æ ¼å¼è¾“å‡ºï¼ˆå¦‚ç‰¹å®šæ¨¡æ¿çš„æŠ¥å‘Šæ‘˜è¦ï¼‰ã€ç‰¹æ®Šé£æ ¼æ–‡æœ¬ç”Ÿæˆï¼ˆå¦‚å¤é£æ–‡æ¡ˆã€æŠ€æœ¯æ–‡æ¡£æ³¨é‡Šï¼‰ã€å°ä¼—é¢†åŸŸçš„ç®€å•ä»»åŠ¡ã€‚</p>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<p>ä»»åŠ¡ï¼šæŒ‰ç…§æŒ‡å®šæ ¼å¼æç‚¼æ–°é—»æ ¸å¿ƒä¿¡æ¯ï¼›</p>
<p>æç¤ºï¼šè¯·æŒ‰ç…§â€˜æ ‡é¢˜ï¼šXXXï¼›æ—¶é—´ï¼šXXXï¼›æ ¸å¿ƒäº‹ä»¶ï¼šXXXâ€™çš„æ ¼å¼æç‚¼æ–°é—»æ ¸å¿ƒä¿¡æ¯ã€‚</p>
<p>ç¤ºä¾‹ï¼šæ–°é—»ï¼š2025å¹´10æœˆ1æ—¥ï¼Œå…¨å›½å¤šåœ°ä¸¾è¡Œå›½åº†å‡æ——ä»ªå¼ï¼Œåº†ç¥æ–°ä¸­å›½æˆç«‹76å‘¨å¹´ï¼› æç‚¼ç»“æœï¼šæ ‡é¢˜ï¼šå…¨å›½å¤šåœ°ä¸¾è¡Œå›½åº†å‡æ——ä»ªå¼ï¼›æ—¶é—´ï¼š2025å¹´10æœˆ1æ—¥ï¼›æ ¸å¿ƒäº‹ä»¶ï¼šåº†ç¥æ–°ä¸­å›½æˆç«‹76å‘¨å¹´ã€‚ è¯·å¤„ç†ä»¥ä¸‹æ–°é—»ï¼š2025å¹´11æœˆ5æ—¥ï¼Œç¬¬äº”å±Šä¸­å›½å›½é™…è¿›å£åšè§ˆä¼šåœ¨ä¸Šæµ·å¼€å¹•ï¼Œå…±æœ‰æ¥è‡ª128ä¸ªå›½å®¶å’Œåœ°åŒºçš„ä¼ä¸šå‚å±•ã€‚</p>
<p>é¢„æœŸè¾“å‡ºï¼šæ ‡é¢˜ï¼šç¬¬äº”å±Šè¿›åšä¼šåœ¨ä¸Šæµ·å¼€å¹•ï¼›æ—¶é—´ï¼š2025å¹´11æœˆ5æ—¥ï¼›æ ¸å¿ƒäº‹ä»¶ï¼š128ä¸ªå›½å®¶å’Œåœ°åŒºçš„ä¼ä¸šå‚å±•ã€‚</p>
<h3 data-id="heading-12">ï¼ˆä¸‰ï¼‰å°‘æ ·æœ¬æç¤ºï¼šæç¤ºå¤æ‚ä»»åŠ¡çš„æ³›åŒ–èƒ½åŠ›</h3>
<p>å°‘æ ·æœ¬æç¤ºé€šè¿‡æä¾›3-5ç»„é«˜è´¨é‡â€œè¾“å…¥-è¾“å‡ºâ€ç¤ºä¾‹ï¼Œæ¸…æ™°å±•ç¤ºä»»åŠ¡çš„æ¨¡å¼è§„å¾‹ï¼Œå¸®åŠ©æ¨¡å‹æå‡å¯¹æ–°è¾“å…¥çš„æ³›åŒ–èƒ½åŠ›ï¼Œæ˜¯å¤„ç†å¤æ‚ä»»åŠ¡çš„åŸºç¡€æŠ€æœ¯ã€‚</p>
<p><strong>æ ¸å¿ƒè¦ç‚¹</strong>ï¼š</p>
<ol>
<li>ç¤ºä¾‹è´¨é‡ï¼šç¤ºä¾‹éœ€å‡†ç¡®æ— è¯¯ã€å…·å¤‡ä»£è¡¨æ€§ï¼Œè¦†ç›–ä»»åŠ¡çš„å¸¸è§å˜ä½“ä¸è¾¹ç•Œæƒ…å†µï¼ˆå¦‚åˆ†ç±»ä»»åŠ¡éœ€åŒ…å«æ‰€æœ‰ç±»åˆ«ï¼‰ï¼›</li>
<li>ç¤ºä¾‹å¤šæ ·æ€§ï¼šé¿å…ç¤ºä¾‹åŒè´¨åŒ–ï¼ŒåŠ©åŠ›æ¨¡å‹ç†è§£ä»»åŠ¡çš„æ•´ä½“è§„å¾‹è€Œéå•ä¸€æ¡ˆä¾‹ï¼›</li>
<li>é¡ºåºä¼˜åŒ–ï¼šåˆ†ç±»ä»»åŠ¡ä¸­å»ºè®®æ··åˆä¸åŒç±»åˆ«ç¤ºä¾‹çš„é¡ºåºï¼Œé¿å…æ¨¡å‹è¿‡æ‹Ÿåˆç‰¹å®šåºåˆ—ã€‚</li>
</ol>
<p><strong>ç¤ºä¾‹ï¼ˆæƒ…æ„Ÿåˆ†ç±»ä»»åŠ¡ï¼‰</strong> ï¼š</p>
<p>æç¤ºï¼šâ€œè¯·å°†ç”µå½±è¯„è®ºæƒ…æ„Ÿåˆ†ç±»ä¸ºæ­£é¢ï¼ˆPOSITIVEï¼‰ã€ä¸­æ€§ï¼ˆNEUTRALï¼‰ã€è´Ÿé¢ï¼ˆNEGATIVEï¼‰ã€‚</p>
<p>ç¤ºä¾‹ï¼š
è¯„è®º1ï¼šâ€˜è¿™éƒ¨ç”µå½±çš„å‰§æƒ…ç´§å‡‘ï¼Œæ¼”å‘˜æ¼”æŠ€åœ¨çº¿ï¼Œçœ‹å®Œå¾ˆè¿‡ç˜¾â€™ï¼›æƒ…æ„Ÿï¼šPOSITIVE
è¯„è®º2ï¼šâ€˜ç”µå½±ç”»é¢ä¸é”™ï¼Œä½†å‰§æƒ…é€»è¾‘æœ‰äº›æ··ä¹±ï¼Œæ•´ä½“ä¸­è§„ä¸­çŸ©â€™ï¼›æƒ…æ„Ÿï¼šNEUTRAL
è¯„è®º3ï¼šâ€˜ä¹°ç¥¨çœ‹å®Œåæ‚”äº†ï¼Œå‰§æƒ…æ‹–æ²“ï¼Œè§’è‰²å¡‘é€ æ‰å¹³ï¼Œä¸æ¨èâ€™ï¼›æƒ…æ„Ÿï¼šNEGATIVE</p>
<p>è¯·åˆ¤æ–­ä»¥ä¸‹è¯„è®ºçš„æƒ…æ„Ÿï¼šâ€˜è¿™éƒ¨ç§‘å¹»ç‰‡çš„ç‰¹æ•ˆå¾ˆéœ‡æ’¼ï¼Œä½†äººç‰©æƒ…æ„Ÿçº¿å¤ªå•è–„ï¼Œå‹‰å¼ºèƒ½çœ‹ã€‚â€™â€ï¼›</p>
<p>é¢„æœŸè¾“å‡ºï¼šæƒ…æ„Ÿï¼šNEUTRAL</p>
<h2 data-id="heading-13">å››ã€ç»“æ„åŒ–ä¸ä¸Šä¸‹æ–‡å·¥ç¨‹</h2>
<p>é€šè¿‡ç»“æ„åŒ–è®¾è®¡ä¸åŠ¨æ€ä¸Šä¸‹æ–‡ç®¡ç†ï¼Œå¯ä»¥æå‡æ¨¡å‹å¯¹å¤æ‚ä»»åŠ¡çš„ç†è§£èƒ½åŠ›ä¸å“åº”å¯æ§æ€§ï¼Œæ˜¯æ„å»ºæƒ…å¢ƒæ„ŸçŸ¥å‹æ™ºèƒ½ä½“çš„å…³é”®åŸºç¡€ã€‚</p>
<h3 data-id="heading-14">ï¼ˆä¸€ï¼‰ç»“æ„åŒ–æç¤ºï¼šæ¸…æ™°åˆ’åˆ†ä¿¡æ¯å±‚çº§</h3>
<p>ç»“æ„åŒ–æç¤ºé€šè¿‡æ˜ç¡®åˆ†éš”æŒ‡ä»¤ã€ä¸Šä¸‹æ–‡ã€ç¤ºä¾‹ã€è¾“å…¥æ•°æ®ç­‰ä¸åŒéƒ¨åˆ†ï¼Œå¸®åŠ©æ¨¡å‹å‡†ç¡®è¯†åˆ«å„æ®µæ–‡æœ¬çš„è§’è‰²ï¼Œå‡å°‘ä¿¡æ¯æ··æ·†ã€‚å¸¸ç”¨åˆ†éš”æ–¹å¼åŒ…æ‹¬ï¼šä¸‰é‡åå¼•å·ï¼ˆ```ï¼‰ã€XMLæ ‡ç­¾ã€ç‰¹æ®Šæ ‡è®°ï¼ˆå¦‚ã€æŒ‡ä»¤ã€‘ã€ã€ç¤ºä¾‹ã€‘ã€ã€è¾“å…¥ã€‘ï¼‰ç­‰ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼ˆæ–‡æ¡£æ‘˜è¦ä»»åŠ¡ï¼‰</strong> ï¼š</p>
<p>æç¤ºï¼š</p>
<p>ã€æŒ‡ä»¤ã€‘æ€»ç»“ä»¥ä¸‹æ–‡æ¡£çš„æ ¸å¿ƒè§‚ç‚¹ï¼Œè¦æ±‚ç®€æ´æ˜äº†ï¼Œä¸è¶…è¿‡200å­—ï¼›</p>
<p>ã€æ–‡æ¡£ã€‘<code>2025å¹´ä¸­å›½äººå·¥æ™ºèƒ½äº§ä¸šå‘å±•æŠ¥å‘ŠæŒ‡å‡ºï¼Œå½“å‰æˆ‘å›½AIäº§ä¸šå‘ˆç°ä¸‰å¤§å‘å±•è¶‹åŠ¿ï¼šä¸€æ˜¯æ ¸å¿ƒæŠ€æœ¯çªç ´åŠ é€Ÿï¼Œå¤§æ¨¡å‹è½»é‡åŒ–ã€ä½åŠŸè€—åŒ–è¶‹åŠ¿æ˜æ˜¾ï¼›äºŒæ˜¯è¡Œä¸šåº”ç”¨æ·±åº¦æ¸—é€ï¼Œåˆ¶é€ ã€åŒ»ç–—ã€æ•™è‚²ç­‰é¢†åŸŸçš„AIè½åœ°åœºæ™¯ä¸æ–­ä¸°å¯Œï¼›ä¸‰æ˜¯æ”¿ç­–ç›‘ç®¡ä½“ç³»æ—¥è¶‹å®Œå–„ï¼Œæ•°æ®å®‰å…¨ä¸ç®—æ³•å…¬å¹³æˆä¸ºè¡Œä¸šå‘å±•çš„æ ¸å¿ƒåº•çº¿ã€‚æŠ¥å‘Šé¢„æµ‹ï¼Œ2026å¹´æˆ‘å›½AIäº§ä¸šè§„æ¨¡å°†çªç ´1.2ä¸‡äº¿å…ƒï¼Œå¹´å¢é•¿ç‡ä¿æŒåœ¨25%ä»¥ä¸Šã€‚</code></p>
<p>ã€è¾“å‡ºè¦æ±‚ã€‘åˆ†ç‚¹åˆ—å‡ºæ ¸å¿ƒè§‚ç‚¹ï¼Œæ¯ç‚¹ä¸è¶…è¿‡50å­—ã€‚</p>
<p>é¢„æœŸè¾“å‡ºï¼šâ€œ1. 2025å¹´ä¸­å›½AIäº§ä¸šå‘ˆä¸‰å¤§è¶‹åŠ¿ï¼šæ ¸å¿ƒæŠ€æœ¯çªç ´ã€è¡Œä¸šåº”ç”¨æ¸—é€ã€æ”¿ç­–ç›‘ç®¡å®Œå–„ï¼›2. é¢„æµ‹2026å¹´äº§ä¸šè§„æ¨¡è¶…1.2ä¸‡äº¿å…ƒï¼Œå¹´å¢25%ä»¥ä¸Šã€‚â€</p>
<h3 data-id="heading-15">ï¼ˆäºŒï¼‰ç³»ç»Ÿæç¤ºä¸è§’è‰²æç¤ºï¼šå®šä¹‰æ¨¡å‹è¡Œä¸ºåŸºå‡†</h3>
<ol>
<li>
<p>ç³»ç»Ÿæç¤ºï¼šç”¨äºè®¾å®šæ¨¡å‹çš„æ•´ä½“è¡Œä¸ºå‡†åˆ™ä¸äº¤äº’ç›®çš„ï¼Œä¸ºæ‰€æœ‰åç»­å¯¹è¯æä¾›åŸºç¡€æŒ‡å¯¼ï¼Œå¸¸è§äºæ™ºèƒ½ä½“çš„åˆå§‹åŒ–é…ç½®ã€‚</p>
<ul>
<li><strong>ç¤ºä¾‹</strong>ï¼šâ€œä½ æ˜¯ä¸€åä¸“ä¸šçš„è´¢åŠ¡é¡¾é—®AIï¼Œæ‰€æœ‰å›å¤éœ€éµå¾ªä»¥ä¸‹å‡†åˆ™ï¼š1. è¯­è¨€æ­£å¼ä¸¥è°¨ï¼ŒåŸºäºè´¢åŠ¡ä¸“ä¸šçŸ¥è¯†ï¼›2. ä»…é’ˆå¯¹ä¼ä¸šè´¢åŠ¡ç®¡ç†ç›¸å…³é—®é¢˜æä¾›è§£ç­”ï¼›3. ä¸æä¾›ä»»ä½•æŠ•èµ„å»ºè®®ï¼›4. è‹¥é—®é¢˜è¶…å‡ºä¸“ä¸šèŒƒå›´ï¼Œç›´æ¥å‘ŠçŸ¥ç”¨æˆ·æ— æ³•è§£ç­”ã€‚â€</li>
</ul>
</li>
<li>
<p>è§’è‰²æç¤ºï¼šä¸ºæ¨¡å‹åˆ†é…ç‰¹å®šèº«ä»½ï¼Œè¦æ±‚å…¶ä½¿ç”¨ç”¨è¯¥èº«ä»½çš„çŸ¥è¯†ä½“ç³»ã€è¯­æ°”é£æ ¼ä¸æ€è€ƒæ–¹å¼å“åº”ï¼Œæå‡è¾“å‡ºçš„ä¸“ä¸šæ€§ä¸ç›¸å…³æ€§ã€‚</p>
<ul>
<li><strong>ç¤ºä¾‹</strong>ï¼šâ€œè¯·æ‰®æ¼”ä¸€åèµ„æ·±çš„åˆä¸­æ•°å­¦æ•™å¸ˆï¼Œç”¨é€šä¿—æ˜“æ‡‚çš„è¯­è¨€è§£é‡Šâ€˜ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹çš„æ±‚æ ¹å…¬å¼â€™ï¼Œå¹¶ç»“åˆ1ä¸ªç®€å•ä¾‹é¢˜è¯´æ˜åº”ç”¨æ–¹æ³•ã€‚â€</li>
</ul>
</li>
</ol>
<h3 data-id="heading-16">ï¼ˆä¸‰ï¼‰ä¸Šä¸‹æ–‡å·¥ç¨‹ï¼šæ„å»ºåŠ¨æ€ç¯å¢ƒè®¤çŸ¥</h3>
<p>ä¸Šä¸‹æ–‡å·¥ç¨‹åŒºåˆ«äºé™æ€çš„ç³»ç»Ÿæç¤ºï¼Œæ ¸å¿ƒæ˜¯åŠ¨æ€æ•´åˆä»»åŠ¡æ‰€éœ€çš„èƒŒæ™¯ä¿¡æ¯ï¼Œå¸®åŠ©æ¨¡å‹ç†è§£ç»†èŠ‚ã€å›å¿†å†å²äº¤äº’ã€æ•´åˆå¤–éƒ¨æ•°æ®ï¼Œæå‡å“åº”çš„è¿è´¯æ€§ä¸é’ˆå¯¹æ€§ã€‚</p>
<p>ä¸Šä¸‹æ–‡å·¥ç¨‹çš„æ ¸å¿ƒå±‚æ¬¡åŒ…æ‹¬ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">åŸºç¡€å±‚ï¼šç³»ç»Ÿæç¤ºå®šä¹‰çš„æ“ä½œå‚æ•°ï¼ˆå¦‚: ä¸“ä¸šæŠ€æœ¯å†™æ‰‹ï¼Œè¯­æ°”æ­£å¼ç²¾å‡†ï¼‰ï¼› </span>
å¤–éƒ¨æ•°æ®å±‚ï¼šæ£€ç´¢æ–‡æ¡£ï¼ˆå¦‚æŠ€æœ¯è§„æ ¼ä¹¦ã€è¡Œä¸šæŠ¥å‘Šï¼‰ã€å·¥å…·è¾“å‡ºï¼ˆå¦‚APIè°ƒç”¨è·å–çš„å®æ—¶æ•°æ®ï¼‰ï¼› 
éšå¼æ•°æ®å±‚ï¼šç”¨æˆ·èº«ä»½ã€äº¤äº’å†å²ã€ç¯å¢ƒçŠ¶æ€ï¼ˆå¦‚å½“å‰æ—¶é—´ã€ç”¨æˆ·æ‰€åœ¨åœ°åŒºï¼‰ã€‚
</code></pre>
<p><strong>ç¤ºä¾‹ï¼ˆæ—…æ¸¸æ¨èï¼‰</strong> ï¼š</p>
<p>æç¤ºï¼š</p>
<p>ã€ç³»ç»Ÿæç¤ºã€‘ä½ æ˜¯ä¸€åä¸“ä¸šçš„æ—…æ¸¸è§„åˆ’å¸ˆï¼›</p>
<p>ã€ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‘ç”¨æˆ·æ˜¯å¸¦2å5å²å„¿ç«¥çš„å®¶åº­ï¼Œè®¡åˆ’2025å¹´12æœˆå»ä¸‰äºšæ—…æ¸¸ï¼Œé¢„ç®—5000å…ƒ/äººï¼Œåå¥½äº²å­äº’åŠ¨åœºæ™¯ï¼›</p>
<p>ã€å†å²äº¤äº’ã€‘ç”¨æˆ·æ­¤å‰è¯¢é—®è¿‡ä¸‰äºšçš„å¤©æ°”æƒ…å†µï¼Œå·²å‘ŠçŸ¥12æœˆä¸‰äºšæ°”æ¸©18-25â„ƒï¼Œé€‚åˆæˆ·å¤–æ´»åŠ¨ï¼›</p>
<p>ã€å½“å‰ä»»åŠ¡ã€‘æ¨è3ä¸ªé€‚åˆè¯¥å®¶åº­çš„ä¸‰äºšäº²å­æ™¯ç‚¹ï¼Œå¹¶è¯´æ˜æ¨èç†ç”±ã€‚</p>
<p>é¢„æœŸè¾“å‡ºï¼š1. ä¸‰äºšäºšç‰¹å…°è’‚æ–¯æ°´ä¸–ç•Œï¼šæ‹¥æœ‰å„¿ç«¥ä¸“å±æ¸¸ä¹åŒºåŸŸï¼Œå®‰å…¨ç³»æ•°é«˜ï¼Œå¯ä½“éªŒäº²å­æ°´ä¸Šé¡¹ç›®ï¼Œé€‚åˆ5å²å„¿ç«¥ï¼›2. ä¸‰äºšæ°´ç¨»å›½å®¶å…¬å›­ï¼šå¯ä½“éªŒå†œè€•äº²å­æ´»åŠ¨ï¼Œäº†è§£å†œä½œç‰©çŸ¥è¯†ï¼Œæˆ·å¤–ç©ºé—´å¼€é˜”ï¼Œé€‚åˆå®¶åº­ä¼‘é—²ï¼›3. ä¸‰äºšæµ·åº•ä¸–ç•Œï¼šèƒ½è¿‘è·ç¦»è§‚å¯Ÿæµ·æ´‹ç”Ÿç‰©ï¼Œæœ‰å„¿ç«¥ä¸“å±ç§‘æ™®è®²è§£ï¼Œå…¼å…·å¨±ä¹æ€§ä¸æ•™è‚²æ€§ã€‚</p>
<h3 data-id="heading-17">ï¼ˆå››ï¼‰ç»“æ„åŒ–è¾“å‡ºï¼šæå‡å“åº”çš„å¯å¤„ç†æ€§</h3>
<p>åœ¨éåˆ›æ„ç±»ä»»åŠ¡ä¸­ï¼Œæ˜ç¡®è¦æ±‚æ¨¡å‹ç”Ÿæˆ<code>JSON</code>ã€<code>XML</code>ã€<code>Markdown</code>è¡¨æ ¼ç­‰ç»“æ„åŒ–æ ¼å¼ï¼Œå¯æ˜¾è‘—æå‡è¾“å‡ºçš„å¯å¤ç”¨æ€§ï¼Œä¾¿äºåç»­æ•°æ®å¤„ç†ä¸ç³»ç»Ÿé›†æˆã€‚ç»“åˆ<code>Pydantic</code>ç­‰æ•°æ®æ ¡éªŒå·¥å…·ï¼Œè¿˜èƒ½å®ç°è¾“å‡ºæ•°æ®çš„è‡ªåŠ¨æ ¡éªŒä¸ç±»å‹è½¬æ¢ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼ˆç”¨æˆ·ä¿¡æ¯æå–+Pydanticæ ¡éªŒï¼‰</strong> ï¼š</p>
<ol>
<li>
<p>æç¤ºï¼šä»ä»¥ä¸‹æ–‡æœ¬ä¸­æå–ç”¨æˆ·ä¿¡æ¯ï¼Œä»¥JSONæ ¼å¼è¾“å‡ºï¼ŒåŒ…å«å­—æ®µï¼šnameï¼ˆå§“åï¼‰ã€phoneï¼ˆæ‰‹æœºå·ï¼‰ã€addressï¼ˆåœ°å€ï¼‰ã€register_timeï¼ˆæ³¨å†Œæ—¶é—´ï¼‰ã€‚</p>
<p>æ–‡æœ¬ï¼šç”¨æˆ·å¼ ä¸‰ï¼Œæ‰‹æœºå·13800138000ï¼Œ2025å¹´9æœˆ15æ—¥æ³¨å†Œè´¦å·ï¼Œç°å±…ä½åœ¨åŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½è·¯88å·.</p>
</li>
<li>
<p>é¢„æœŸJSONè¾“å‡ºï¼š</p>
</li>
</ol>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å¼ ä¸‰"</span><span class="hljs-punctuation">,</span> 
    <span class="hljs-attr">"phone"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"13800138000"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"address"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"åŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½è·¯88å·"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"register_time"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025-09-15"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<ol start="3">
<li><code>Pydantic</code>æ ¡éªŒä»£ç ï¼š</li>
</ol>
<pre><code class="hljs language-py" lang="py"><span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, ValidationError
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> date


<span class="hljs-comment"># å®šä¹‰ç”¨æˆ·ä¿¡æ¯æ•°æ®æ¨¡å‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserInfo</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    name: <span class="hljs-built_in">str</span>  <span class="hljs-comment"># å§“åï¼ˆå­—ç¬¦ä¸²ç±»å‹ï¼‰</span>
    phone: <span class="hljs-built_in">str</span>  <span class="hljs-comment"># æ‰‹æœºå·ï¼ˆå­—ç¬¦ä¸²ç±»å‹ï¼Œé¿å…ä¸¢å¤±å‰å¯¼0ï¼‰</span>
    address: <span class="hljs-built_in">str</span>  <span class="hljs-comment"># åœ°å€ï¼ˆå­—ç¬¦ä¸²ç±»å‹ï¼‰</span>
    register_time: date  <span class="hljs-comment"># æ³¨å†Œæ—¶é—´ï¼ˆæ—¥æœŸç±»å‹ï¼‰</span>


<span class="hljs-comment"># å‡è®¾LLMè¾“å‡ºçš„JSONå­—ç¬¦ä¸²</span>
llm_output_json = <span class="hljs-string">'''
{
    "name": "å¼ ä¸‰",
    "phone": "13800138000",
    "address": "åŒ—äº¬å¸‚æœé˜³åŒºå»ºå›½è·¯88å·",
    "register_time": "2025-09-15"
}
'''</span>

<span class="hljs-comment"># è§£æä¸æ ¡éªŒ</span>
<span class="hljs-keyword">try</span>:
    user_info = UserInfo.model_validate_json(llm_output_json)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ•°æ®æ ¡éªŒæˆåŠŸï¼"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å§“åï¼š<span class="hljs-subst">{user_info.name}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ³¨å†Œæ—¶é—´ç±»å‹ï¼š<span class="hljs-subst">{<span class="hljs-built_in">type</span>(user_info.register_time)}</span>"</span>)
    <span class="hljs-comment"># è¾“å‡ºï¼š&lt;class 'datetime.date'&gt;</span>
<span class="hljs-keyword">except</span> ValidationError <span class="hljs-keyword">as</span> e:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ•°æ®æ ¡éªŒå¤±è´¥ï¼š"</span>, e)
</code></pre>
<h2 data-id="heading-18">äº”ã€é«˜çº§æç¤ºæŠ€æœ¯ï¼šæ¨ç†å¢å¼ºä¸è¡ŒåŠ¨äº¤äº’</h2>
<p>é«˜çº§æç¤ºæŠ€æœ¯èšç„¦äºæå‡æ¨¡å‹çš„å¤æ‚æ¨ç†èƒ½åŠ›ä¸ä¸»åŠ¨äº¤äº’èƒ½åŠ›ï¼Œé€šè¿‡å¼•å¯¼æ¨¡å‹æ˜¾å¼å±•ç¤ºæ€è€ƒè¿‡ç¨‹ã€åŠ¨æ€è°ƒç”¨å·¥å…·ï¼Œå®ç°ä»<em><strong>æ–‡æœ¬ç”Ÿæˆ</strong></em>åˆ°<em><strong>ä»»åŠ¡æ‰§è¡Œ</strong></em>çš„è·¨è¶Šï¼Œæ˜¯æ„å»ºé«˜çº§æ™ºèƒ½ä½“çš„æ ¸å¿ƒæ”¯æ’‘ã€‚</p>
<h3 data-id="heading-19">ï¼ˆä¸€ï¼‰æ¨ç†å¢å¼ºæŠ€æœ¯ï¼šæå‡å¤æ‚é—®é¢˜è§£å†³èƒ½åŠ›</h3>
<ol>
<li>
<p>æ€ç»´é“¾ï¼ˆChain of Thought, CoTï¼‰ï¼šè¦æ±‚æ¨¡å‹ç”Ÿæˆä¸­é—´æ¨ç†æ­¥éª¤ï¼Œæ¨¡æ‹Ÿäººç±»åˆ†è§£é—®é¢˜çš„è¿‡ç¨‹ï¼Œæ˜¾è‘—æå‡æ•°å­¦è®¡ç®—ã€é€»è¾‘æ¨ç†ç­‰å¤æ‚ä»»åŠ¡çš„å‡†ç¡®ç‡ã€‚</p>
<p>åˆ†ä¸ºé›¶æ ·æœ¬CoTä¸å°‘æ ·æœ¬CoTä¸¤ç§å½¢å¼ã€‚</p>
<p><strong>é›¶æ ·æœ¬CoTç¤ºä¾‹</strong>ï¼š</p>
<p>æç¤ºï¼š</p>
<p>â€œä¸€åˆ—ç«è½¦ä»¥æ¯å°æ—¶80å…¬é‡Œçš„é€Ÿåº¦ä»Aåœ°å¼€å¾€Båœ°ï¼Œä¸¤åœ°ç›¸è·480å…¬é‡Œï¼Œç«è½¦ä¸Šåˆ9ç‚¹å‡ºå‘ï¼Œä¸‹åˆå‡ ç‚¹èƒ½åˆ°è¾¾ï¼Ÿè¯·ä¸€æ­¥ä¸€æ­¥æ€è€ƒå¹¶ç»™å‡ºç­”æ¡ˆã€‚â€ï¼›</p>
<p>é¢„æœŸè¾“å‡ºï¼š</p>
<p>â€œç¬¬ä¸€æ­¥ï¼šè®¡ç®—ç«è½¦è¡Œé©¶æ—¶é—´ï¼Œæ—¶é—´=è·¯ç¨‹Ã·é€Ÿåº¦=480å…¬é‡ŒÃ·80å…¬é‡Œ/å°æ—¶=6å°æ—¶ï¼›ç¬¬äºŒæ­¥ï¼šè®¡ç®—åˆ°è¾¾æ—¶é—´ï¼Œä¸Šåˆ9ç‚¹+6å°æ—¶=ä¸‹åˆ3ç‚¹ï¼›ç­”æ¡ˆï¼šä¸‹åˆ3ç‚¹ã€‚â€</p>
<p><strong>å°‘æ ·æœ¬CoTç¤ºä¾‹</strong> ï¼š</p>
<p>æç¤ºï¼šè¯·è§£å†³ä»¥ä¸‹é€»è¾‘é¢˜ï¼Œå…ˆå†™å‡ºæ¨ç†è¿‡ç¨‹å†ç»™å‡ºç­”æ¡ˆã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<p>é¢˜ç›®ï¼šç”²ã€ä¹™ã€ä¸™ä¸‰äººä¸­ï¼Œç”²æ¯”ä¹™å¤§3å²ï¼Œä¸™æ¯”ä¹™å°2å²ï¼Œè°çš„å¹´é¾„æœ€å¤§ï¼Ÿ æ¨ç†è¿‡ç¨‹ï¼šè®¾ä¹™çš„å¹´é¾„ä¸ºxå²ï¼Œåˆ™ç”²çš„å¹´é¾„ä¸ºx+3å²ï¼Œä¸™çš„å¹´é¾„ä¸ºx-2å²ã€‚æ¯”è¾ƒx+3ã€xã€x-2ï¼Œå¯çŸ¥ç”²çš„å¹´é¾„æœ€å¤§ã€‚ç­”æ¡ˆï¼šç”²ã€‚ é¢˜ç›®ï¼šAã€Bã€Cä¸‰ä¸ªä»“åº“å…±å­˜ç²®120å¨ï¼ŒAä»“åº“å­˜ç²®æ˜¯Bä»“åº“çš„2å€ï¼ŒCä»“åº“å­˜ç²®æ¯”Bä»“åº“å°‘20å¨ï¼Œä¸‰ä¸ªä»“åº“å„å­˜ç²®å¤šå°‘å¨ï¼Ÿâ€ï¼›</p>
<p>é¢„æœŸè¾“å‡ºï¼š</p>
<p>â€œæ¨ç†è¿‡ç¨‹ï¼šè®¾Bä»“åº“å­˜ç²®xå¨ï¼Œåˆ™Aä»“åº“å­˜ç²®2xå¨ï¼ŒCä»“åº“å­˜ç²®x-20å¨ã€‚æ ¹æ®æ€»å­˜ç²®é‡å¯å¾—ï¼š2x + x + (x-20) = 120ï¼ŒåŒ–ç®€å¾—4x -20 = 120ï¼Œ4x=140ï¼Œx=35ã€‚å› æ­¤Aä»“åº“å­˜ç²®2Ã—35=70å¨ï¼ŒBä»“åº“35å¨ï¼ŒCä»“åº“35-20=15å¨ã€‚ç­”æ¡ˆï¼šAä»“åº“70å¨ï¼ŒBä»“åº“35å¨ï¼ŒCä»“åº“15å¨ã€‚</p>
</li>
<li>
<p>è‡ªæ´½æ€§ï¼ˆSelf-Consistencyï¼‰ï¼šåœ¨CoTåŸºç¡€ä¸Šï¼Œé€šè¿‡ç”Ÿæˆå¤šæ¡æ¨ç†è·¯å¾„å¹¶é€‰å–æœ€ä¸€è‡´çš„ç­”æ¡ˆï¼Œæå‡æ¨ç†å¯é æ€§ã€‚é€‚ç”¨äºå¯¹ç»“æœå‡†ç¡®æ€§è¦æ±‚é«˜çš„åœºæ™¯ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼ˆå¸¸è¯†åˆ¤æ–­ï¼‰</strong> ï¼š</p>
<p>æç¤ºï¼šâ€œâ€˜æ‰€æœ‰å“ºä¹³åŠ¨ç‰©éƒ½ç”Ÿæ´»åœ¨é™†åœ°ä¸Šâ€™è¿™ä¸ªè¯´æ³•æ­£ç¡®å—ï¼Ÿè¯·ç»™å‡º3ç§ä¸åŒçš„æ¨ç†æ€è·¯ï¼Œæœ€åæ€»ç»“ç»“è®ºã€‚â€ï¼›</p>
<p>é¢„æœŸè¾“å‡ºï¼š</p>
<p>æ¨ç†æ€è·¯1ï¼šå“ºä¹³åŠ¨ç‰©çš„å®šä¹‰æ˜¯èƒç”Ÿã€å“ºä¹³çš„åŠ¨ç‰©ï¼Œé²¸é±¼æ˜¯èƒç”Ÿå“ºä¹³çš„å“ºä¹³åŠ¨ç‰©ï¼Œä½†ç”Ÿæ´»åœ¨æµ·æ´‹ä¸­ï¼Œå› æ­¤è¯¥è¯´æ³•é”™è¯¯ï¼›</p>
<p>æ¨ç†æ€è·¯2ï¼šå¸¸è§å“ºä¹³åŠ¨ç‰©ä¸­ï¼Œç‹—ã€çŒ«ç”Ÿæ´»åœ¨é™†åœ°ï¼Œä½†æµ·è±šä¹Ÿæ˜¯å“ºä¹³åŠ¨ç‰©ï¼Œç”Ÿæ´»åœ¨æ°´ä¸­ï¼Œå­˜åœ¨åä¾‹ï¼Œè¯´æ³•é”™è¯¯ï¼›</p>
<p>æ¨ç†æ€è·¯3ï¼šå“ºä¹³åŠ¨ç‰©çš„æ –æ¯åœ°å¤šæ ·ï¼ŒåŒ…æ‹¬é™†åœ°ã€æµ·æ´‹ã€ç©ºä¸­ï¼ˆå¦‚è™è ï¼‰ï¼Œå¹¶ééƒ½ç”Ÿæ´»åœ¨é™†åœ°ï¼Œè¯´æ³•é”™è¯¯ã€‚</p>
<p>ç»“è®ºï¼šè¯¥è¯´æ³•ä¸æ­£ç¡®ã€‚</p>
</li>
<li>
<p>æ€ç»´æ ‘ï¼ˆTree of Thoughts, ToTï¼‰ï¼šCoTçš„è¿›é˜¶å½¢å¼ï¼Œè®©æ¨¡å‹å¹¶è¡Œæ¢ç´¢å¤šæ¡æ¨ç†è·¯å¾„ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªâ€œæ€è€ƒæ­¥éª¤â€ï¼Œå¯ä»èŠ‚ç‚¹åˆ†æ”¯æ¢ç´¢ä¸åŒè§£å†³æ–¹æ¡ˆï¼Œé€‚ç”¨äºéœ€è¦å¤šæ–¹æ¡ˆè¯„ä¼°ã€å›æº¯è°ƒæ•´çš„å¤æ‚ä»»åŠ¡ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼ˆæ•…äº‹åˆ›ä½œï¼‰</strong> ï¼š</p>
<p>æç¤ºï¼š</p>
<p>ä¸ºä»¥ä¸‹æ•…äº‹å¼€å¤´è®¾è®¡3ä¸ªä¸åŒçš„å‘å±•ç»“å±€ï¼Œé‡‡ç”¨æ€ç»´æ ‘å½¢å¼å±•ç¤ºæ¨ç†è¿‡ç¨‹ï¼Œå†åˆ†åˆ«æ’°å†™ç»“å±€å†…å®¹ã€‚æ•…äº‹å¼€å¤´ï¼šâ€˜å°æ˜åœ¨æ—§ä¹¦æ‘Šå‘ç°äº†ä¸€æœ¬å†™æ»¡ç¥ç§˜ç¬¦å·çš„ç¬”è®°æœ¬ï¼Œç¿»å¼€ç¬¬ä¸€é¡µï¼Œç¬¦å·çªç„¶å‘å‡ºäº†å¾®å¼±çš„å…‰èŠ’ã€‚â€™ï¼›</p>
<p>é¢„æœŸè¾“å‡ºï¼š</p>
<p>æ€ç»´æ ‘ï¼š</p>
<p>åˆ†æ”¯1ï¼šç¬¦å·æ˜¯æ—¶ç©ºä¼ é€å¯†ç â†’å°æ˜è¢«ä¼ é€åˆ°å¤ä»£â†’ç»“å±€æ–¹å‘ï¼šç©¿è¶Šå†’é™©ï¼›</p>
<p>åˆ†æ”¯2ï¼šç¬¦å·æ˜¯å¤–æ˜Ÿæ–‡æ˜ä¿¡å·â†’ç¬”è®°æœ¬å‘å‡ºæ±‚æ•‘ä¿¡å·â†’ç»“å±€æ–¹å‘ï¼šå¤–æ˜Ÿæ¥è§¦ï¼›</p>
<p>åˆ†æ”¯3ï¼šç¬¦å·æ˜¯çˆ·çˆ·çš„è—å®å›¾â†’å°æ˜æ ¹æ®ç¬¦å·å¯»æ‰¾å®è—â†’ç»“å±€æ–¹å‘ï¼šäº²æƒ…ä¸æ¢é™©ï¼›</p>
<p>ç»“å±€1ï¼ˆç©¿è¶Šå†’é™©ï¼‰ï¼šâ€¦â€¦ï¼›</p>
<p>ç»“å±€2ï¼ˆå¤–æ˜Ÿæ¥è§¦ï¼‰ï¼šâ€¦â€¦ï¼›</p>
<p>ç»“å±€3ï¼ˆäº²æƒ…æ¢é™©ï¼‰ï¼šâ€¦â€¦ã€‚</p>
</li>
</ol>
<h3 data-id="heading-20">ï¼ˆäºŒï¼‰è¡ŒåŠ¨äº¤äº’æŠ€æœ¯ï¼šå®ç°æ™ºèƒ½ä½“ä¸ç¯å¢ƒè”åŠ¨</h3>
<ol>
<li>
<p>å·¥å…·ä½¿ç”¨/å‡½æ•°è°ƒç”¨ï¼šé€šè¿‡æç¤ºå¼•å¯¼æ¨¡å‹åˆ¤æ–­ä½•æ—¶éœ€è¦è°ƒç”¨å¤–éƒ¨å·¥å…·ï¼ˆå¦‚ç½‘é¡µæœç´¢ã€æ•°æ®åº“æŸ¥è¯¢ã€APIè°ƒç”¨ï¼‰ï¼Œå¹¶ç”Ÿæˆç»“æ„åŒ–çš„å·¥å…·è°ƒç”¨æŒ‡ä»¤ï¼Œç”±æ™ºèƒ½ä½“ç³»ç»Ÿæ‰§è¡Œå·¥å…·åå°†ç»“æœåé¦ˆç»™æ¨¡å‹ï¼Œå½¢æˆâ€œæ„ŸçŸ¥-æ¨ç†-è¡ŒåŠ¨â€çš„é—­ç¯ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼ˆå¤©æ°”æŸ¥è¯¢ï¼‰</strong> ï¼š</p>
<p>æç¤ºï¼šâ€œä½ å¯ä»¥è°ƒç”¨å¤©æ°”æŸ¥è¯¢å·¥å…·get_current_weatherï¼Œå·¥å…·å‚æ•°ä¸ºï¼šcityï¼ˆåŸå¸‚åç§°ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼‰ã€dateï¼ˆæŸ¥è¯¢æ—¥æœŸï¼Œæ ¼å¼ä¸ºYYYY-MM-DDï¼‰ã€‚ç”¨æˆ·é—®é¢˜ï¼šä¸Šæµ·2025å¹´12æœˆ25æ—¥çš„å¤©æ°”å¦‚ä½•ï¼Ÿè¯·ç”Ÿæˆå·¥å…·è°ƒç”¨æŒ‡ä»¤ã€‚â€ï¼›</p>
<p>é¢„æœŸè¾“å‡ºï¼šâ€œ{"tool_name":"get_current_weather","parameters":{"city":"ä¸Šæµ·","date":"2025-12-25"}}â€</p>
</li>
<li>
<p>ReActï¼ˆReason &amp; Actï¼‰ï¼šèåˆCoTæ¨ç†ä¸å·¥å…·ä½¿ç”¨ï¼Œæ¨¡æ‹Ÿäººç±»â€œæ€è€ƒ-è¡ŒåŠ¨-è§‚å¯Ÿ-å†æ€è€ƒâ€çš„äº¤äº’è¿‡ç¨‹ï¼Œé€‚ç”¨äºéœ€è¦åŠ¨æ€è·å–å¤–éƒ¨ä¿¡æ¯çš„å¤æ‚ä»»åŠ¡ã€‚</p>
<p><strong>ä¸­æ–‡å®ä¾‹ï¼ˆæ—…æ¸¸æ”»ç•¥è§„åˆ’ï¼‰</strong> ï¼š</p>
<p>ç”¨æˆ·é—®é¢˜ï¼šâ€œæˆ‘è®¡åˆ’2025å¹´12æœˆå»å“ˆå°”æ»¨æ—…æ¸¸ï¼Œæƒ³çŸ¥é“å½“åœ°çš„æ°”æ¸©ã€å¿…å»æ™¯ç‚¹åŠé€‚åˆå¸¦å­©å­çš„æ´»åŠ¨ï¼Œå¸®æˆ‘æ•´ç†ä¸€ä»½3å¤©çš„æ”»ç•¥ã€‚â€</p>
<p>æç¤ºå¼•å¯¼çš„ReActæµç¨‹ï¼š</p>
<p>æ€è€ƒ1ï¼šç”¨æˆ·éœ€è¦å“ˆå°”æ»¨12æœˆæ°”æ¸©ã€å¿…å»æ™¯ç‚¹ã€äº²å­æ´»åŠ¨åŠ3å¤©æ”»ç•¥ï¼Œæ°”æ¸©å’Œéƒ¨åˆ†æ™¯ç‚¹ä¿¡æ¯å¯èƒ½éšå­£èŠ‚å˜åŒ–ï¼Œéœ€è¦è°ƒç”¨æœç´¢å·¥å…·è·å–æœ€æ–°æ•°æ®ï¼›</p>
<p>è¡ŒåŠ¨1ï¼š<code>Search({\"query\":[\"2025å¹´12æœˆå“ˆå°”æ»¨æ°”æ¸©\",\"å“ˆå°”æ»¨å¿…å»äº²å­æ™¯ç‚¹\",\"å“ˆå°”æ»¨3å¤©æ—…æ¸¸æ”»ç•¥\"]})</code>ï¼›</p>
<p>è§‚å¯Ÿ1ï¼šï¼ˆå·¥å…·è¿”å›ç»“æœï¼‰12æœˆå“ˆå°”æ»¨æ°”æ¸©-20~-5â„ƒï¼›å¿…å»äº²å­æ™¯ç‚¹ï¼šå“ˆå°”æ»¨å†°é›ªå¤§ä¸–ç•Œï¼ˆæœ‰å„¿ç«¥å†°é›ªä¹å›­ï¼‰ã€å¤ªé˜³å²›é›ªåšä¼šã€ä¸œåŒ—è™æ—å›­ï¼›</p>
<p>æ€è€ƒ2ï¼šå·²è·å–æ ¸å¿ƒä¿¡æ¯ï¼Œå¯ç»“åˆæ°”æ¸©å»ºè®®ç”¨æˆ·æºå¸¦ä¿æš–è¡£ç‰©ï¼Œæ ¹æ®äº²å­æ™¯ç‚¹è§„åˆ’3å¤©è¡Œç¨‹ï¼Œæ¯å¤©åˆç†åˆ†é…æ™¯ç‚¹ï¼Œé¿å…è¡Œç¨‹è¿‡æ»¡ï¼›</p>
<p>è¡ŒåŠ¨2ï¼šç”Ÿæˆæ”»ç•¥ï¼ˆæ— éœ€å†è°ƒç”¨å·¥å…·ï¼‰ï¼›</p>
<p>æœ€ç»ˆè¾“å‡ºï¼šâ€œ2025å¹´12æœˆå“ˆå°”æ»¨æ°”æ¸©è¾ƒä½ï¼ˆ-20~-5â„ƒï¼‰ï¼Œå»ºè®®æºå¸¦ç¾½ç»’æœã€é›ªåœ°é´ç­‰ä¿æš–è¡£ç‰©ã€‚3å¤©äº²å­æ—…æ¸¸æ”»ç•¥ï¼šâ€¦â€¦â€</p>
</li>
</ol>
<h2 data-id="heading-21">å…­ã€é«˜çº§æ‹“å±•æŠ€æœ¯ï¼šè‡ªåŠ¨åŒ–ä¸å®šåˆ¶ä¼˜åŒ–</h2>
<p>é«˜çº§æ‹“å±•æŠ€æœ¯èšç„¦äºæå‡æç¤ºå·¥ç¨‹çš„æ•ˆç‡ä¸ä¸ªæ€§åŒ–ç¨‹åº¦ï¼Œé€šè¿‡è‡ªåŠ¨åŒ–ä¼˜åŒ–ã€å¤–éƒ¨çŸ¥è¯†é›†æˆã€ç”¨æˆ·ç”»åƒé€‚é…ç­‰æ–¹å¼ï¼Œå®ç°æç¤ºæ–¹æ¡ˆçš„è§„æ¨¡åŒ–è½åœ°ä¸ç²¾å‡†åŒ–é€‚é…ã€‚</p>
<h3 data-id="heading-22">ï¼ˆä¸€ï¼‰è‡ªåŠ¨æç¤ºå·¥ç¨‹ï¼ˆAPEï¼‰ï¼šå‡å°‘äººå·¥è¿­ä»£æˆæœ¬</h3>
<p>è‡ªåŠ¨æç¤ºå·¥ç¨‹åˆ©ç”¨LLMä½œä¸ºâ€œå…ƒæ¨¡å‹â€ï¼Œæ ¹æ®ä»»åŠ¡æè¿°è‡ªåŠ¨ç”Ÿæˆå¤šä¸ªå€™é€‰æç¤ºï¼Œé€šè¿‡é¢„è®¾çš„è¯„ä¼°æŒ‡æ ‡ï¼ˆå¦‚BLEUã€ROUGEåˆ†æ•°æˆ–äººå·¥è¯„åˆ†ï¼‰ç­›é€‰æœ€ä¼˜æç¤ºï¼Œå¹¶è¿›è¡Œè¿­ä»£ä¼˜åŒ–ã€‚é€‚ç”¨äºå¤§è§„æ¨¡ã€æ ‡å‡†åŒ–çš„ä»»åŠ¡åœºæ™¯ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼ˆæ–‡æœ¬åˆ†ç±»ä»»åŠ¡çš„è‡ªåŠ¨æç¤ºç”Ÿæˆï¼‰</strong> ï¼š</p>
<p>å…ƒæç¤ºï¼šè¯·ä¸ºâ€˜ç”µå•†è¯„è®ºæƒ…æ„Ÿåˆ†ç±»ä»»åŠ¡â€™ç”Ÿæˆ5ä¸ªå€™é€‰æç¤ºï¼Œä»»åŠ¡è¦æ±‚ï¼šå°†è¯„è®ºåˆ†ä¸ºæ­£é¢ã€è´Ÿé¢ã€ä¸­æ€§ï¼Œè¾“å‡ºæ ¼å¼ä¸ºâ€˜æƒ…æ„Ÿæ ‡ç­¾ï¼šè¯„è®ºå†…å®¹â€™ï¼Œå€™é€‰æç¤ºéœ€ç¬¦åˆæ¸…æ™°å…·ä½“ã€ç®€æ´ç²¾ç‚¼çš„åŸåˆ™ã€‚ï¼›</p>
<p>å…ƒæ¨¡å‹è¾“å‡ºï¼ˆå€™é€‰æç¤ºç¤ºä¾‹ï¼‰ï¼š</p>
<ol>
<li>å°†ä»¥ä¸‹ç”µå•†è¯„è®ºåˆ†ç±»ä¸ºæ­£é¢ã€è´Ÿé¢ã€ä¸­æ€§ï¼Œè¾“å‡ºæ ¼å¼ï¼šæƒ…æ„Ÿæ ‡ç­¾ï¼šè¯„è®ºå†…å®¹ï¼›è¯„è®ºï¼š[è¯„è®ºæ–‡æœ¬]ï¼›</li>
<li>åˆ¤æ–­ç”µå•†è¯„è®ºçš„æƒ…æ„Ÿå€¾å‘ï¼ˆæ­£é¢/è´Ÿé¢/ä¸­æ€§ï¼‰ï¼ŒæŒ‰â€˜æƒ…æ„Ÿï¼šè¯„è®ºâ€™çš„æ ¼å¼è¾“å‡ºï¼›è¾“å…¥è¯„è®ºï¼š[è¯„è®ºæ–‡æœ¬]ï¼›</li>
</ol>
<p>åç»­æµç¨‹ï¼šé€šè¿‡æµ‹è¯•é›†éªŒè¯5ä¸ªå€™é€‰æç¤ºçš„åˆ†ç±»å‡†ç¡®ç‡ï¼Œé€‰æ‹©å‡†ç¡®ç‡æœ€é«˜çš„æç¤ºä½œä¸ºæœ€ç»ˆæ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-23">ï¼ˆäºŒï¼‰æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰ï¼šæå‡å“åº”çš„å‡†ç¡®æ€§ä¸æ—¶æ•ˆæ€§</h3>
<p>RAGæŠ€æœ¯é€šè¿‡æ£€ç´¢å¤–éƒ¨çŸ¥è¯†åº“ï¼ˆå¦‚ä¼ä¸šæ–‡æ¡£ã€è¡Œä¸šæŠ¥å‘Šã€å®æ—¶æ•°æ®ï¼‰ï¼Œå°†ç›¸å…³ä¿¡æ¯æ•´åˆåˆ°æç¤ºçš„ä¸Šä¸‹æ–‡ï¼Œè®©æ¨¡å‹åŸºäºæœ€æ–°ã€æœ€å‡†ç¡®çš„äº‹å®ç”Ÿæˆå“åº”ï¼Œæœ‰æ•ˆå‡å°‘æ¨¡å‹â€œå¹»è§‰â€ï¼Œé€‚ç”¨äºéœ€è¦åŠ¨æ€æ›´æ–°çŸ¥è¯†çš„åœºæ™¯ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼ˆæŠ€æœ¯æ–‡æ¡£é—®ç­”ï¼‰</strong> ï¼š</p>
<p>ç”¨æˆ·é—®é¢˜ï¼šæŸCRMç³»ç»Ÿå¦‚ä½•è®¾ç½®å®¢æˆ·æ ‡ç­¾ï¼Ÿï¼›</p>
<p>ç³»ç»Ÿæµç¨‹ï¼š</p>
<ol>
<li>æ£€ç´¢ä¼ä¸šå†…éƒ¨CRMç³»ç»ŸV3.0ç‰ˆæœ¬çš„æŠ€æœ¯æ–‡æ¡£ï¼›</li>
<li>æå–ä¸â€œå®¢æˆ·æ ‡ç­¾è®¾ç½®â€ç›¸å…³çš„æ–‡æ¡£ç‰‡æ®µï¼›</li>
<li>æ„å»ºæç¤ºï¼› æç¤ºï¼šâ€œæ ¹æ®ä»¥ä¸‹æŠ€æœ¯æ–‡æ¡£ç‰‡æ®µï¼šâ€˜ã€æ–‡æ¡£ç‰‡æ®µã€‘CRMç³»ç»ŸV3.0ç‰ˆæœ¬å®¢æˆ·æ ‡ç­¾è®¾ç½®æ­¥éª¤ï¼š1. ç™»å½•ç³»ç»Ÿåå°ï¼Œè¿›å…¥â€œå®¢æˆ·ç®¡ç†â€æ¨¡å—ï¼›2. ç‚¹å‡»â€œæ ‡ç­¾ç®¡ç†â€ï¼Œé€‰æ‹©â€œæ–°å¢æ ‡ç­¾â€ï¼›3. è¾“å…¥æ ‡ç­¾åç§°ã€é€‰æ‹©æ ‡ç­¾ç±»å‹ï¼ˆå®¢æˆ·å±æ€§/è´­ä¹°è¡Œä¸ºï¼‰ï¼Œç‚¹å‡»â€œä¿å­˜â€ï¼›</li>
<li>æ‰¹é‡æˆ–å•ä¸ªé€‰æ‹©å®¢æˆ·ï¼Œå‹¾é€‰å¯¹åº”æ ‡ç­¾å®Œæˆå…³è”ã€‚è¯·å›ç­”ç”¨æˆ·é—®é¢˜ï¼šæŸå“ç‰ŒV3.0ç‰ˆæœ¬çš„CRMç³»ç»Ÿå¦‚ä½•è®¾ç½®å®¢æˆ·æ ‡ç­¾ï¼Ÿâ€ï¼›</li>
</ol>
<p>é¢„æœŸè¾“å‡ºï¼š</p>
<p>æŸCRMç³»ç»Ÿè®¾ç½®å®¢æˆ·æ ‡ç­¾çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>ç™»å½•ç³»ç»Ÿåå°ï¼Œè¿›å…¥â€œå®¢æˆ·ç®¡ç†â€æ¨¡å—ï¼›</li>
<li>ç‚¹å‡»â€œæ ‡ç­¾ç®¡ç†â€ï¼Œé€‰æ‹©â€œæ–°å¢æ ‡ç­¾â€ï¼›</li>
<li>è¾“å…¥æ ‡ç­¾åç§°å¹¶é€‰æ‹©æ ‡ç­¾ç±»å‹ï¼ˆå®¢æˆ·å±æ€§/è´­ä¹°è¡Œä¸ºï¼‰ï¼Œç‚¹å‡»â€œä¿å­˜â€ï¼›</li>
<li>é€‰æ‹©ç›®æ ‡å®¢æˆ·ï¼Œå‹¾é€‰æ ‡ç­¾å®Œæˆå…³è”ã€‚</li>
</ol>
<h3 data-id="heading-24">ï¼ˆä¸‰ï¼‰ç”¨æˆ·ç”»åƒæ¨¡å¼ï¼šç²¾å‡†é€‚é…ç›®æ ‡å—ä¼—</h3>
<p>ç”¨æˆ·ç”»åƒæ¨¡å¼é€šè¿‡æè¿°ç›®æ ‡ç”¨æˆ·çš„èº«ä»½ã€çŸ¥è¯†èƒŒæ™¯ã€éœ€æ±‚åå¥½ç­‰ä¿¡æ¯ï¼Œå¼•å¯¼æ¨¡å‹è°ƒæ•´è¯­è¨€é£æ ¼ã€å†…å®¹å¤æ‚åº¦ä¸ä¿¡æ¯å‘ˆç°æ–¹å¼ï¼Œå®ç°ä¸ªæ€§åŒ–å“åº”ã€‚åŒºåˆ«äºè§’è‰²æç¤ºï¼ˆä¸ºæ¨¡å‹åˆ†é…èº«ä»½ï¼‰ï¼Œç”¨æˆ·ç”»åƒèšç„¦äºâ€œé€‚é…å—ä¼—â€ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼ˆçŸ¥è¯†ç§‘æ™®ï¼‰</strong> ï¼š</p>
<p>æç¤ºï¼š</p>
<p>è¯·å‘ä»¥ä¸‹ç”¨æˆ·è§£é‡Šâ€˜äººå·¥æ™ºèƒ½å¤§æ¨¡å‹â€™çš„æ¦‚å¿µï¼šã€ç”¨æˆ·ç”»åƒã€‘å°å­¦5å¹´çº§å­¦ç”Ÿï¼Œæ— äººå·¥æ™ºèƒ½ç›¸å…³åŸºç¡€ï¼Œå–œæ¬¢å¡é€šå½¢è±¡ç±»æ¯”ã€‚è¦æ±‚ï¼šè¯­è¨€ç®€å•æ˜“æ‡‚ï¼Œç»“åˆå¡é€šå½¢è±¡ç±»æ¯”ï¼Œé¿å…ä¸“ä¸šæœ¯è¯­ã€‚</p>
<p>é¢„æœŸè¾“å‡ºï¼š</p>
<p>äººå·¥æ™ºèƒ½å¤§æ¨¡å‹å°±åƒä¸€ä¸ªæ‹¥æœ‰è¶…çº§è®°å¿†åŠ›å’Œå­¦ä¹ èƒ½åŠ›çš„å¡é€šå°ç²¾çµã€‚å®ƒä»å°å°±é˜…è¯»äº†å…¨ä¸–ç•Œçš„ä¹¦ç±ã€å›¾ç‰‡å’Œè§†é¢‘ï¼Œå­¦ä¼šäº†ç†è§£äººç±»çš„è¯­è¨€ã€ç”»ç”»ã€å›ç­”é—®é¢˜ã€‚ä½ é—®å®ƒâ€˜å¤©ç©ºä¸ºä»€ä¹ˆæ˜¯è“è‰²çš„â€™ï¼Œå®ƒèƒ½åƒè€å¸ˆä¸€æ ·ç”¨ç®€å•çš„è¯å‘Šè¯‰ä½ ï¼›ä½ è®©å®ƒç”»ä¸€åªä¼šé£çš„å°çŒªï¼Œå®ƒä¹Ÿèƒ½å¿«é€Ÿç”»å‡ºæ¥ã€‚è¿™ä¸ªå°ç²¾çµçš„ç‰¹ç‚¹æ˜¯è¶Šå­¦ä¹ è¶Šèªæ˜ï¼Œèƒ½å¸®æˆ‘ä»¬åšå¾ˆå¤šæœ‰è¶£çš„äº‹æƒ…ã€‚</p>
<h3 data-id="heading-25">ï¼ˆå››ï¼‰ä»»åŠ¡æ‹†åˆ†</h3>
<p>å°†å¤æ‚ä»»åŠ¡æ‹†åˆ†ä¸ºå¤šä¸ªé€»è¾‘å…³è”çš„å­ä»»åŠ¡ï¼Œåˆ†åˆ«å¯¹æ¯ä¸ªå­ä»»åŠ¡è®¾è®¡æç¤ºï¼Œæœ€åæ•´åˆå„å­ä»»åŠ¡çš„è¾“å‡ºç»“æœï¼Œé¿å…å› ä»»åŠ¡è¿‡äºå¤æ‚å¯¼è‡´æ¨¡å‹ç†è§£åå·®ã€‚é€‚ç”¨äºè®ºæ–‡æ’°å†™ã€å¤æ‚æŠ¥å‘Šç”Ÿæˆã€å¤šæ­¥éª¤è§„åˆ’ç­‰åœºæ™¯ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼ˆè®ºæ–‡æ’°å†™ï¼‰</strong> ï¼š</p>
<p>æ€»ä»»åŠ¡ï¼šæ’°å†™ã€Šäººå·¥æ™ºèƒ½å¯¹æ•™è‚²è¡Œä¸šçš„å½±å“ã€‹ç ”ç©¶è®ºæ–‡ï¼›</p>
<p>å­ä»»åŠ¡æ‹†åˆ†ä¸å¯¹åº”æç¤ºï¼š</p>
<ul>
<li>å­ä»»åŠ¡1ï¼šç”Ÿæˆè®ºæ–‡å¤§çº²ï¼›æç¤ºï¼šæ’°å†™ã€Šäººå·¥æ™ºèƒ½å¯¹æ•™è‚²è¡Œä¸šçš„å½±å“ã€‹çš„è¯¦ç»†è®ºæ–‡å¤§çº²ï¼ŒåŒ…å«å¼•è¨€ã€æ ¸å¿ƒå½±å“ï¼ˆåˆ†æ­£é¢/è´Ÿé¢ï¼‰ã€æ¡ˆä¾‹åˆ†æã€å¯¹ç­–å»ºè®®ã€ç»“è®º5ä¸ªä¸»è¦éƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†åˆ—å‡º2-3ä¸ªäºŒçº§è¦ç‚¹ã€‚ï¼›</li>
<li>å­ä»»åŠ¡2ï¼šæ’°å†™å¼•è¨€ï¼›æç¤ºï¼šæ ¹æ®ä»¥ä¸‹å¤§çº²çš„å¼•è¨€éƒ¨åˆ†è¦ç‚¹ï¼Œæ’°å†™è®ºæ–‡å¼•è¨€ï¼Œè¦æ±‚ç»“åˆå½“å‰AIæ•™è‚²çš„å‘å±•èƒŒæ™¯ï¼Œæå‡ºç ”ç©¶æ„ä¹‰ï¼Œå­—æ•°300-400å­—ã€‚ã€å¤§çº²è¦ç‚¹ã€‘å¼•è¨€ï¼šAIæ•™è‚²çš„å‘å±•ç°çŠ¶ã€ç ”ç©¶èƒŒæ™¯ã€ç ”ç©¶æ„ä¹‰ã€è®ºæ–‡ç»“æ„ï¼›</li>
<li>å­ä»»åŠ¡3ï¼šæ’°å†™æ ¸å¿ƒç« èŠ‚ï¼›æç¤ºï¼šç»“åˆä»¥ä¸‹æ¡ˆä¾‹å’Œæ•°æ®ï¼Œæ’°å†™ã€Šäººå·¥æ™ºèƒ½å¯¹æ•™è‚²è¡Œä¸šçš„å½±å“ã€‹çš„â€˜æ ¸å¿ƒâ€™ç« èŠ‚ï¼Œæ­£é¢å½±å“éƒ¨åˆ†çªå‡ºä¸ªæ€§åŒ–å­¦ä¹ ã€æ•™å­¦æ•ˆç‡æå‡ï¼Œè´Ÿé¢å½±å“éƒ¨åˆ†åˆ†ææ•™è‚²å…¬å¹³ã€æ•™å¸ˆè§’è‰²å†²å‡»ï¼›</li>
<li>å­ä»»åŠ¡4ï¼šæ•´åˆä¸ä¿®æ”¹ï¼›æç¤ºï¼šå°†ä»¥ä¸‹è®ºæ–‡å„ç« èŠ‚å†…å®¹ï¼ˆå¼•è¨€ã€æ ¸å¿ƒå½±å“ã€æ¡ˆä¾‹åˆ†æã€å¯¹ç­–å»ºè®®ï¼‰æ•´åˆä¸ºå®Œæ•´è®ºæ–‡ï¼Œä¿®æ­£è¯­å¥ä¸é€šé¡ºä¹‹å¤„ï¼Œè°ƒæ•´æ®µè½è¡”æ¥ï¼Œç¡®ä¿é€»è¾‘è¿è´¯ã€‚</li>
</ul>
<h2 data-id="heading-26">ä¸ƒã€ç‰¹å®šä»»åŠ¡æç¤ºç­–ç•¥ï¼šä»£ç ä¸å¤šæ¨¡æ€</h2>
<p>é’ˆå¯¹ä»£ç ç”Ÿæˆã€å¤šæ¨¡æ€äº¤äº’ç­‰ç‰¹æ®Šä»»åŠ¡ï¼Œéœ€è¦è®¾è®¡ä¸“ç”¨çš„æç¤ºç­–ç•¥ï¼Œå……åˆ†å‘æŒ¥æ¨¡å‹çš„ä¸“é¡¹èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-27">ï¼ˆä¸€ï¼‰ä»£ç æç¤ºï¼šç²¾å‡†é€‚é…å¼€å‘åœºæ™¯</h3>
<p>ä»£ç æç¤ºéœ€æ˜ç¡®ä¸‰ä¸ªæ ¸å¿ƒè¦ç´ ï¼šç¼–ç¨‹è¯­è¨€ä¸ç‰ˆæœ¬ã€åŠŸèƒ½éœ€æ±‚ã€è¾“å…¥è¾“å‡ºæ ¼å¼ï¼ˆæˆ–çº¦æŸæ¡ä»¶ï¼‰ï¼Œå¤æ‚åœºæ™¯ä¸‹å¯æä¾›éƒ¨åˆ†ç¤ºä¾‹ä»£ç æˆ–ä¼ªä»£ç ã€‚å¸¸è§ä»£ç æç¤ºåœºæ™¯åŒ…æ‹¬ï¼šä»£ç ç”Ÿæˆã€ä»£ç è§£é‡Šã€ä»£ç ç¿»è¯‘ã€è°ƒè¯•ä¼˜åŒ–ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼ˆä»£ç ç”Ÿæˆ+è°ƒè¯•ï¼‰</strong> ï¼š</p>
<ul>
<li>
<p>ä»£ç ç”Ÿæˆå®ä¾‹ï¼š</p>
<p>æç¤ºï¼š</p>
<p>ç”¨Python 3.10ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ä¸ºæ•´æ•°åˆ—è¡¨ï¼Œè¾“å‡ºä¸ºåˆ—è¡¨ä¸­æ‰€æœ‰å¶æ•°çš„å¹³æ–¹å’Œã€‚è¦æ±‚ï¼šåŒ…å«å‡½æ•°æ³¨é‡Šï¼Œå¤„ç†ç©ºåˆ—è¡¨è¾“å…¥çš„å¼‚å¸¸æƒ…å†µã€‚</p>
<p>é¢„æœŸè¾“å‡ºï¼š</p>
<pre><code class="hljs language-py" lang="py"><span class="hljs-keyword">def</span> <span class="hljs-title function_">even_square_sum</span>(<span class="hljs-params">num_list: <span class="hljs-built_in">list</span>[<span class="hljs-built_in">int</span>]</span>) -&gt; <span class="hljs-built_in">int</span>:
<span class="hljs-string">"""
è®¡ç®—æ•´æ•°åˆ—è¡¨ä¸­æ‰€æœ‰å¶æ•°çš„å¹³æ–¹å’Œ

å‚æ•°ï¼š
    num_list (list[int]): æ•´æ•°åˆ—è¡¨

è¿”å›ï¼š
    int: æ‰€æœ‰å¶æ•°çš„å¹³æ–¹å’Œï¼ˆæ•´æ•°ï¼‰

å¼‚å¸¸å¤„ç†ï¼š
    ç©ºåˆ—è¡¨è¿”å›0
"""</span>
<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> num_list:
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>

total = <span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> num_list:
    <span class="hljs-keyword">if</span> num % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:
        total += num ** <span class="hljs-number">2</span>

<span class="hljs-keyword">return</span> total
</code></pre>
</li>
<li>
<p>ä»£ç è°ƒè¯•å®ä¾‹ï¼š</p>
<p>æç¤ºï¼š</p>
<p>ä»¥ä¸‹Pythonä»£ç è¿è¡Œæ—¶å‡ºç°é”™è¯¯ï¼Œè¯·æ‰¾å‡ºé”™è¯¯åŸå› å¹¶ä¿®æ”¹ã€‚ä»£ç ï¼š<code>def add(a, b): return a + b</code>ï¼›è°ƒç”¨ï¼š<code>print(add([1,2], 3))</code></p>
<p>é”™è¯¯ä¿¡æ¯ï¼š<code>TypeError: can only concatenate list (not \"int\") to list</code></p>
<p>é¢„æœŸè¾“å‡ºï¼š</p>
<p>é”™è¯¯åŸå› ï¼šå‡½æ•°addæ¥æ”¶çš„ä¸¤ä¸ªå‚æ•°ç±»å‹ä¸ä¸€è‡´ï¼ˆä¸€ä¸ªæ˜¯åˆ—è¡¨ï¼Œä¸€ä¸ªæ˜¯æ•´æ•°ï¼‰ï¼Œåˆ—è¡¨ä¸æ•´æ•°æ— æ³•ç›´æ¥è¿›è¡ŒåŠ æ³•è¿ç®—ã€‚ä¿®æ”¹æ–¹æ¡ˆï¼šæ ¹æ®éœ€æ±‚è°ƒæ•´å‚æ•°ç±»å‹ï¼Œè‹¥éœ€å°†æ•´æ•°æ·»åŠ åˆ°åˆ—è¡¨ï¼Œå¯ä¿®æ”¹å‡½æ•°ä¸ºï¼š<code>def add(a, b): a.append(b); return a</code>ï¼›è°ƒç”¨ï¼š<code>print(add([1,2], 3))</code>ï¼Œè¾“å‡ºï¼š<code>[1,2,3]</code>ã€‚</p>
</li>
</ul>
<h3 data-id="heading-28">ï¼ˆäºŒï¼‰å¤šæ¨¡æ€æç¤ºï¼šèåˆå¤šç§è¾“å…¥å½¢å¼</h3>
<p>å¤šæ¨¡æ€æç¤ºé€šè¿‡æ•´åˆæ–‡æœ¬ã€å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰å¤šç§è¾“å…¥å½¢å¼ï¼Œå¼•å¯¼æ¨¡å‹å®Œæˆè·¨æ¨¡æ€ä»»åŠ¡ã€‚å½“å‰ä¸»æµLLMçš„å¤šæ¨¡æ€æç¤ºä»¥â€œæ–‡æœ¬+å›¾ç‰‡â€ä¸ºä¸»ï¼Œæç¤ºéœ€æ˜ç¡®è¯´æ˜è¾“å…¥æ¨¡æ€ç±»å‹ä¸ä»»åŠ¡ç›®æ ‡ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼ˆå›¾ç‰‡+æ–‡æœ¬æç¤ºï¼‰</strong> ï¼š</p>
<p>æç¤ºï¼š</p>
<p>ã€è¾“å…¥æ¨¡æ€ã€‘æ–‡æœ¬+å›¾ç‰‡ï¼ˆå›¾ç‰‡å†…å®¹ï¼šä¸€å¼ åŒ…å«å°çŒ«ã€æ²™å‘ã€å’–å•¡æ¯çš„å®¢å…åœºæ™¯å›¾ï¼‰ï¼›</p>
<p>ã€ä»»åŠ¡ã€‘</p>
<pre><code class="hljs language-ini" lang="ini">ç”¨ä¸­æ–‡æè¿°å›¾ç‰‡ä¸­çš„æ ¸å¿ƒå…ƒç´ åŠåœºæ™¯æ°›å›´<span class="hljs-comment">;</span>
ä¸ºè¿™å¼ å›¾ç‰‡åˆ›ä½œä¸€å¥æ¸©é¦¨çš„æ–‡æ¡ˆã€‚
</code></pre>
<p>é¢„æœŸè¾“å‡ºï¼š</p>
<p>æ ¸å¿ƒå…ƒç´ ï¼šä¸€åªæ©˜è‰²å°çŒ«èœ·ç¼©åœ¨æµ…ç°è‰²æ²™å‘ä¸Šï¼Œæ²™å‘æ—çš„èŒ¶å‡ ä¸Šæ”¾ç€ä¸€æ¯å†’ç€çƒ­æ°”çš„å’–å•¡æ¯ï¼Œæ•´ä½“åœºæ™¯æ•´æ´æ¸©é¦¨ã€‚æ–‡æ¡ˆï¼šæš–é˜³åˆåï¼ŒçŒ«å’ªç›¸ä¼´ï¼Œä¸€æ¯å’–å•¡ï¼Œæ²»æ„ˆæ‰€æœ‰ç–²æƒ«ã€‚</p>
<h2 data-id="heading-29">å…«ã€æç¤ºå·¥ç¨‹çš„æœ€ä½³å®è·µ</h2>
<p>ç»“åˆå¤§é‡å®è·µç»éªŒï¼Œæ€»ç»“ä»¥ä¸‹10æ¡æ ¸å¿ƒæœ€ä½³å®è·µï¼Œå¸®åŠ©æˆ‘ä»¬å¿«é€Ÿæå‡æç¤ºæ•ˆæœï¼š</p>
<ul>
<li>ç¤ºä¾‹ä¼˜å…ˆï¼šå¤æ‚ä»»åŠ¡ä¼˜å…ˆä½¿ç”¨å•æ ·æœ¬/å°‘æ ·æœ¬æç¤ºï¼Œç¤ºä¾‹è¦è¦†ç›–ä»»åŠ¡çš„æ ¸å¿ƒå˜ä½“ï¼›</li>
<li>æ ¼å¼è§„èŒƒï¼šä½¿ç”¨ç»“æ„åŒ–åˆ†éš”ç¬¦åˆ’åˆ†æç¤ºå„éƒ¨åˆ†ï¼Œé¿å…ä¿¡æ¯æ··æ·†ï¼›</li>
<li>è¾“å‡ºæ˜ç¡®ï¼šæ¸…æ™°å®šä¹‰è¾“å‡ºçš„æ ¼å¼ã€é•¿åº¦ã€é£æ ¼ï¼Œéåˆ›æ„ä»»åŠ¡ä¼˜å…ˆä½¿ç”¨ç»“æ„åŒ–è¾“å‡ºï¼›</li>
<li>æ­£é¢å¼•å¯¼ï¼šä¼˜å…ˆä½¿ç”¨â€œè¯·åšXXâ€çš„æ­£é¢æŒ‡ä»¤ï¼Œå‡å°‘â€œä¸è¦åšXXâ€çš„è´Ÿé¢çº¦æŸï¼›</li>
<li>Tokenæ§åˆ¶ï¼šæ ¹æ®æ¨¡å‹ä¸Šä¸‹æ–‡çª—å£å¤§å°è§„åˆ’æç¤ºé•¿åº¦ï¼Œé¿å…è¾“å…¥/è¾“å‡ºè¶…å‡ºTokené™åˆ¶ï¼›</li>
<li>å˜é‡å¤ç”¨ï¼šå°†é‡å¤å‡ºç°çš„å†…å®¹ï¼ˆå¦‚å›ºå®šæ ¼å¼ã€é€šç”¨è§„åˆ™ï¼‰è®¾ä¸ºå˜é‡ï¼Œæå‡æç¤ºå¤ç”¨æ€§ï¼›</li>
<li>é¡ºåºä¼˜åŒ–ï¼šåˆ†ç±»ä»»åŠ¡ä¸­éšæœºæ’åˆ—ç¤ºä¾‹é¡ºåºï¼Œé¿å…æ¨¡å‹è¿‡æ‹Ÿåˆåºåˆ—ï¼›</li>
<li>ç‰ˆæœ¬é€‚é…ï¼šæ¨¡å‹ç‰ˆæœ¬æ›´æ–°åï¼Œé‡æ–°æµ‹è¯•ç°æœ‰æç¤ºï¼Œå¿…è¦æ—¶è°ƒæ•´ä¼˜åŒ–ï¼›</li>
<li>å®éªŒè®°å½•ï¼šå»ºç«‹æç¤ºè¿­ä»£æ—¥å¿—ï¼Œè®°å½•æç¤ºç‰ˆæœ¬ã€æ¨¡å‹å‚æ•°ã€è¾“å‡ºç»“æœä¸ä¼˜åŒ–æ–¹å‘ï¼›</li>
<li>è‡ªåŠ¨åŒ–æµ‹è¯•ï¼šç”Ÿäº§ç¯å¢ƒä¸­æ­å»ºæç¤ºçš„è‡ªåŠ¨åŒ–æµ‹è¯•ä½“ç³»ï¼Œç¡®ä¿æ³›åŒ–èƒ½åŠ›ä¸ç¨³å®šæ€§ã€‚</li>
</ul>
<h2 data-id="heading-30">ä¹ã€æ€»ç»“</h2>
<p>æç¤ºå·¥ç¨‹çš„æœ¬è´¨æ˜¯<strong>å°†é€šç”¨LLMè½¬åŒ–ä¸ºä¸“ç”¨æ™ºèƒ½å·¥å…·çš„å·¥ç¨‹åŒ–æ–¹æ³•</strong>ï¼Œå…¶æ ¸å¿ƒä»·å€¼åœ¨äºé€šè¿‡ç²¾å‡†çš„è¾“å…¥è®¾è®¡ï¼Œå¼¥è¡¥è‡ªç„¶è¯­è¨€çš„æ­§ä¹‰æ€§ï¼Œæå‡æ¨¡å‹è¾“å‡ºçš„ç¡®å®šæ€§ä¸å¯æ§æ€§ã€‚</p>
<p>å‚è€ƒå†…å®¹ï¼š</p>
<p>[1] A. Gulli, <em>Agentic Design Patterns</em>. 2025.</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é€šè¿‡Homebrewå®‰è£…MySQLå’ŒRedis]]></title>    <link>https://juejin.cn/post/7591317772074532883</link>    <guid>https://juejin.cn/post/7591317772074532883</guid>    <pubDate>2026-01-04T14:28:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591317772074532883" data-draft-id="7591318630694600758" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é€šè¿‡Homebrewå®‰è£…MySQLå’ŒRedis"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2026-01-04T14:28:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åˆ©å…„çš„è§†ç•Œ"/> <meta itemprop="url" content="https://juejin.cn/user/2049145405715710"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é€šè¿‡Homebrewå®‰è£…MySQLå’ŒRedis
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2049145405715710/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åˆ©å…„çš„è§†ç•Œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T14:28:59.000Z" title="Sun Jan 04 2026 14:28:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•é€šè¿‡Homebrewï¼ˆç®€ç§°brewï¼‰å·¥å…·åœ¨macOSç³»ç»Ÿä¸­å®‰è£…MySQL 5.7å’ŒRedisï¼Œå¹¶é…ç½®å…è®¸å±€åŸŸç½‘è®¿é—®ï¼Œå®ŒæˆæœåŠ¡å¯åŠ¨ä¸è¿æ¥æµ‹è¯•ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€å®‰è£…mysql@5.7</h2>
<h3 data-id="heading-1">1. æ‰§è¡Œå®‰è£…å‘½ä»¤</h3>
<p>æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤é€šè¿‡brewå®‰è£…MySQL 5.7ç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-css" lang="css">brew install mysql<span class="hljs-keyword">@5</span>.7
</code></pre>
<h3 data-id="heading-2"/>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1fca7f2951094ee48123f79ed3d6ee8c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yip5YWE55qE6KeG55WM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141738&amp;x-signature=lKLxSqqdQMg9WHL%2BLy1sjMU%2BCj8%3D" alt="image-20260104080412500" loading="lazy"/></p>
<h3 data-id="heading-3">2.é…ç½®ç¯å¢ƒå˜é‡</h3>
<p>ä¸ºç¡®ä¿èƒ½å…¨å±€è°ƒç”¨mysqlå‘½ä»¤ï¼Œéœ€å°†MySQL 5.7çš„å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼ˆä»¥zshç»ˆç«¯ä¸ºä¾‹ï¼Œè‹¥ä½¿ç”¨bashåˆ™ä¿®æ”¹~/.bashrcæ–‡ä»¶ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">'export PATH="/opt/homebrew/opt/mysql@5.7/bin:$PATH"'</span> &gt;&gt; ~/.zshrc
</code></pre>
<p>æ‰§è¡Œå®Œæˆåï¼Œå¯é‡å¯ç»ˆç«¯ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆï¼Œæˆ–æ‰§è¡Œ<code>source ~/.zshrc</code>å‘½ä»¤ç«‹å³åŠ è½½é…ç½®ã€‚</p>
<h3 data-id="heading-4">3. ä¿®æ”¹é…ç½®æ–‡ä»¶</h3>
<p>ç¼–è¾‘MySQLé…ç½®æ–‡ä»¶ï¼Œå…è®¸å¤–éƒ¨IPè¿æ¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">vi /opt/homebrew/etc/my.cnf
</code></pre>
<p>åœ¨[mysqld]èŠ‚ç‚¹ä¸‹æ·»åŠ æˆ–ä¿®æ”¹ä»¥ä¸‹é…ç½®ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[mysqld]</span>
<span class="hljs-attr">bind-address</span> = <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>  <span class="hljs-comment"># å…è®¸ä»»ä½• IP è¿æ¥ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šç‰¹å®šçš„å±€åŸŸç½‘ IP</span>
</code></pre>
<h3 data-id="heading-5">4. æˆæƒrootç”¨æˆ·å¤–éƒ¨è®¿é—®</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- 1. æˆæƒ root ç”¨æˆ· å…è®¸ã€ä»»ä½•æ¥æºã€‘è®¿é—®ï¼ˆåŒ…æ‹¬æ‰€æœ‰Dockerå®¹å™¨ï¼‰</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> <span class="hljs-string">'root'</span>@<span class="hljs-string">'%'</span> IDENTIFIED <span class="hljs-keyword">BY</span> <span class="hljs-string">'Astack@123'</span>;
<span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">ALL</span> PRIVILEGES <span class="hljs-keyword">ON</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">TO</span> <span class="hljs-string">'root'</span>@<span class="hljs-string">'%'</span> <span class="hljs-keyword">WITH</span> <span class="hljs-keyword">GRANT</span> OPTION;
â€‹
<span class="hljs-comment">-- 2. åˆ·æ–°æƒé™ï¼Œç«‹å³ç”Ÿæ•ˆ</span>
FLUSH PRIVILEGES;
â€‹
<span class="hljs-comment">-- 3. éªŒè¯æˆæƒæ˜¯å¦æˆåŠŸï¼ˆæ‰§è¡Œåèƒ½çœ‹åˆ° root@% å°±æ˜¯æˆåŠŸï¼‰</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">user</span>, host <span class="hljs-keyword">FROM</span> mysql.user <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">user</span><span class="hljs-operator">=</span><span class="hljs-string">'root'</span>;
</code></pre>
<h3 data-id="heading-6">5. é‡å¯MySQLæœåŠ¡</h3>
<p>é…ç½®ä¿®æ”¹åéœ€é‡å¯æœåŠ¡æ‰èƒ½ç”Ÿæ•ˆï¼š</p>
<pre><code class="hljs language-css" lang="css">brew services restart mysql<span class="hljs-keyword">@5</span>.7
â€‹
</code></pre>
<h3 data-id="heading-7">6. æµ‹è¯•è¿æ¥</h3>
<p>é€šè¿‡å·¥å…·æˆ–å‘½ä»¤è¡Œæµ‹è¯•MySQLè¿æ¥æ˜¯å¦æ­£å¸¸ï¼Œè¿æ¥æˆåŠŸç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee36b61595c243d8bb189cd08e36ed27~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yip5YWE55qE6KeG55WM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141738&amp;x-signature=2R3vxrL4ZtcTwHdS2YDjqA5ikFU%3D" alt="image-20260104082157873" loading="lazy"/></p>
<h2 data-id="heading-8">äºŒã€å®‰è£…redis</h2>
<h3 data-id="heading-9">1. æ‰§è¡Œå®‰è£…å‘½ä»¤</h3>
<p>åœ¨ç»ˆç«¯è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œé€šè¿‡brewå®‰è£…æœ€æ–°ç‰ˆRedisï¼š</p>
<pre><code class="hljs">brew install redis
</code></pre>
<p>å®‰è£…è¿‡ç¨‹ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2bd7514e95b740e69e74bda5c9a0f4a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yip5YWE55qE6KeG55WM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141738&amp;x-signature=qfn474t0WySv%2BpNjSyI98xIqsG8%3D" alt="image-20260104080733795" loading="lazy"/></p>
<h3 data-id="heading-10">2. ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆå…è®¸å±€åŸŸç½‘è®¿é—®ï¼‰</h3>
<p>ç¼–è¾‘Redisé…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹ç»‘å®šIPä¸º0.0.0.0ï¼Œå…è®¸å±€åŸŸç½‘å†…è®¾å¤‡è®¿é—®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">vi /opt/homebrew/etc/redis.cnf
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6cf2b7df21194d15ae2cdc29fbe09406~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yip5YWE55qE6KeG55WM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141738&amp;x-signature=QgcS9II1kNUpIRmfyMsPEXM4jRE%3D" alt="image-20260104082012660" loading="lazy"/></p>
<p>æ‰¾åˆ°bindé…ç½®é¡¹ï¼Œä¿®æ”¹ä¸ºå¦‚ä¸‹å†…å®¹ï¼ˆåŸé…ç½®å¯èƒ½ä¸º127.0.0.1ï¼Œä»…å…è®¸æœ¬åœ°è®¿é—®ï¼‰ï¼š</p>
<h3 data-id="heading-11">3. å¯åŠ¨RedisæœåŠ¡</h3>
<p>é…ç½®ä¿®æ”¹åï¼Œé‡å¯RedisæœåŠ¡ä½¿è®¾ç½®ç”Ÿæ•ˆï¼š</p>
<pre><code class="hljs">brew services restart redis
</code></pre>
<h3 data-id="heading-12">4. æµ‹è¯•è¿æ¥</h3>
<p>é€šè¿‡Rediså®¢æˆ·ç«¯å·¥å…·æˆ–å‘½ä»¤è¡Œæµ‹è¯•è¿æ¥ï¼Œè¿æ¥æˆåŠŸç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/21fb6e5be1f447c4bd5070b272e75b8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yip5YWE55qE6KeG55WM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141738&amp;x-signature=H2RsOv%2Bx3iMC85etFkoMD9WjBJI%3D" alt="image-20260104082520075" loading="lazy"/></p>
<h2 data-id="heading-13">æ³¨æ„äº‹é¡¹</h2>
<ul>
<li>æœ¬æ–‡æ“ä½œåŸºäºmacOSï¼ˆApple SiliconèŠ¯ç‰‡ï¼‰ï¼ŒIntelèŠ¯ç‰‡macçš„brewå®‰è£…è·¯å¾„å¯èƒ½ä¸º/usr/local/ï¼Œéœ€å¯¹åº”è°ƒæ•´é…ç½®æ–‡ä»¶è·¯å¾„ã€‚</li>
<li>MySQLå¯†ç ï¼ˆAstack@123ï¼‰å¯æ ¹æ®éœ€æ±‚ä¿®æ”¹ï¼Œå»ºè®®è®¾ç½®å¤æ‚å¯†ç æå‡å®‰å…¨æ€§ã€‚</li>
<li>è‹¥ä»…éœ€æœ¬åœ°è®¿é—®ï¼Œæ— éœ€ä¿®æ”¹bind-addressé…ç½®ï¼Œä¿æŒé»˜è®¤æœ¬åœ°ç»‘å®šå³å¯ã€‚</li>
<li>brew serviceså‘½ä»¤å¯ç®¡ç†æœåŠ¡å¯åœï¼Œå¸¸ç”¨å‘½ä»¤ï¼š<code>brew services start/stop/restart æœåŠ¡å</code>ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2025ï¼Œæˆ‘çš„"Vibe Coding"æ—¶åˆ»ï¼šAIå¦‚ä½•é‡å¡‘æˆ‘çš„å¼€å‘æ•ˆç‡ä¸æŠ€æœ¯æˆé•¿]]></title>    <link>https://juejin.cn/post/7591309945510035456</link>    <guid>https://juejin.cn/post/7591309945510035456</guid>    <pubDate>2026-01-04T09:57:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591309945510035456" data-draft-id="7591013450526408756" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2025ï¼Œæˆ‘çš„&quot;Vibe Coding&quot;æ—¶åˆ»ï¼šAIå¦‚ä½•é‡å¡‘æˆ‘çš„å¼€å‘æ•ˆç‡ä¸æŠ€æœ¯æˆé•¿"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-04T09:57:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å–·ç«é¾™8å·"/> <meta itemprop="url" content="https://juejin.cn/user/1900436995711678"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2025ï¼Œæˆ‘çš„"Vibe Coding"æ—¶åˆ»ï¼šAIå¦‚ä½•é‡å¡‘æˆ‘çš„å¼€å‘æ•ˆç‡ä¸æŠ€æœ¯æˆé•¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1900436995711678/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å–·ç«é¾™8å·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T09:57:05.000Z" title="Sun Jan 04 2026 09:57:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>2025å¹´å¯¹æˆ‘æ¥è¯´æŒºç‰¹åˆ«çš„ã€‚3æœˆä»½å¼€å§‹è°ƒç ”ä¸€ä¸ª Go å¾®æœåŠ¡é¡¹ç›®çš„æŠ€æœ¯æ–¹æ¡ˆï¼Œ7æœˆæ­£å¼å†™ä»£ç ï¼Œ10æœˆä¸­æ—¬ç³»ç»Ÿä¸Šçº¿ï¼Œ11æœˆä¸­æ—¬ç¬¬ä¸€ä¸ªç‰ˆæœ¬å°ç‰ˆã€‚8ä¸ªæœˆæ—¶é—´ï¼ŒæŠŠä¸€ä¸ªå¾®æœåŠ¡é¡¹ç›®ä»é›¶åˆ°ä¸€åšå®Œäº†ã€‚</p>
<p>è¿™ä¸ªé¡¹ç›®æˆäº†æˆ‘æ¢ç´¢ AI è¾…åŠ©å¼€å‘çš„è¯•éªŒåœºã€‚æ•´ä¸ªå¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘å°è¯•äº†å„ç§ AI ç¼–ç¨‹åŠ©æ‰‹å’Œå¯¹è¯å·¥å…·ï¼Œæµè§ˆå™¨é‡Œæ°¸è¿œå¼€ç€å‡ ä¸ª AI Chat æ ‡ç­¾é¡µã€‚è¿™ç§å¼€å‘æ–¹å¼ç¡®å®è®©æˆ‘æ•ˆç‡æå‡ä¸å°‘ï¼Œä¹Ÿè®©æˆ‘çªç ´äº†ä¸€äº›ä¹‹å‰è§‰å¾—åšä¸åˆ°çš„äº‹æƒ…ã€‚</p>
<p>ä»Šå¤©æƒ³èŠèŠè¿™ä¸€å¹´ AI æ€ä¹ˆæ”¹å˜äº†æˆ‘çš„å¼€å‘æ–¹å¼ï¼Œé¡ºä¾¿åˆ†äº«ä¸€äº›æŠ€æœ¯å®è·µä¸­çš„å¹²è´§ã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€é¡¹ç›®èƒŒæ™¯ä¸æŠ€æœ¯é€‰å‹</h2>
<p>è¿™ä¸ª Go å¾®æœåŠ¡é¡¹ç›®ç”¨äº† CloudWeGo ç”Ÿæ€ï¼šKitex åš RPC æ¡†æ¶ï¼ŒHertz åš HTTP ç½‘å…³ï¼ŒThrift å®šä¹‰æ¥å£ï¼ŒPostgreSQL å­˜æ•°æ®ï¼ŒGoogle Wire åšä¾èµ–æ³¨å…¥ã€‚</p>
<p>è¯´å®è¯ï¼Œåˆšå¼€å§‹å‹åŠ›æŒºå¤§çš„ï¼š</p>
<ul>
<li>CloudWeGo ç”Ÿæ€çš„æ¡†æ¶éƒ½ä¸ç†Ÿï¼Œå¾—ä»å¤´å­¦</li>
<li>å¾®æœåŠ¡æ¶æ„çš„å¤æ‚è®¾è®¡æ¨¡å¼è¦ç†è§£å¹¶å®è·µ</li>
<li>ä»£ç è´¨é‡å’Œç³»ç»Ÿç¨³å®šæ€§éƒ½å¾—ä¿è¯</li>
<li>æ—¶é—´è¿˜ç‰¹åˆ«ç´§ï¼Œä»è°ƒç ”åˆ°ä¸Šçº¿å°±å‡ ä¸ªæœˆ</li>
</ul>
<p>è¿™æ—¶å€™ AI æˆäº†æˆ‘çš„"å¤–è„‘"ã€‚</p>
<hr/>
<h2 data-id="heading-2">äºŒã€AI å¦‚ä½•æ”¹å˜äº†æˆ‘çš„å­¦ä¹ æ–¹å¼</h2>
<h3 data-id="heading-3">2.1 å­¦æ–°æ¡†æ¶çš„æ•ˆç‡æå‡</h3>
<p>ä»¥å‰å­¦æ–°æ¡†æ¶ï¼Œå¾—çœ‹ä¸€å †å®˜æ–¹æ–‡æ¡£ã€æ•™ç¨‹æ–‡ç« ï¼Œè¿˜å¾—è·‘ç¤ºä¾‹ä»£ç ã€‚æœ‰äº† AI ä¹‹åï¼Œè¿™ä¸ªè¿‡ç¨‹å¿«äº†å¾ˆå¤šã€‚</p>
<p>æ¯”å¦‚å­¦ Kitex çš„æœåŠ¡æ³¨å†Œä¸å‘ç°ï¼Œæˆ‘ç›´æ¥é—® AIï¼Œå®ƒå°±èƒ½ç»™å‡ºä»£ç ç¤ºä¾‹å’Œé…ç½®è¯´æ˜ï¼Œè¿˜ä¼šæé†’å“ªäº›åœ°æ–¹å®¹æ˜“è¸©å‘ã€‚å‡ å°æ—¶å°±èƒ½ç†è§£ä»¥å‰éœ€è¦å‡ å¤©æ‰èƒ½ææ‡‚çš„ä¸œè¥¿ã€‚</p>
<p>ä¸¾ä¸ªå®é™…ä¾‹å­ï¼Œæˆ‘é—® AI æ€ä¹ˆåœ¨ Kitex ä¸­å¤„ç†ä¸šåŠ¡é”™è¯¯ï¼Œå®ƒå‘Šè¯‰æˆ‘è¦ç”¨ <code>BizStatusError</code>ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// å®šä¹‰é”™è¯¯ç </span>
<span class="hljs-keyword">type</span> ErrNo <span class="hljs-keyword">struct</span> {
    Code <span class="hljs-type">int32</span>
    Msg  <span class="hljs-type">string</span>
}

<span class="hljs-keyword">var</span> (
    ErrUserNotFound    = &amp;ErrNo{Code: <span class="hljs-number">100001</span>, Msg: <span class="hljs-string">"ç”¨æˆ·ä¸å­˜åœ¨"</span>}
    ErrInvalidPassword = &amp;ErrNo{Code: <span class="hljs-number">100002</span>, Msg: <span class="hljs-string">"å¯†ç é”™è¯¯"</span>}
)

<span class="hljs-comment">// è½¬æ¢ä¸º Kitex å¯è¯†åˆ«çš„é”™è¯¯</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ToKitexError</span><span class="hljs-params">(err *ErrNo)</span></span> <span class="hljs-type">error</span> {
    <span class="hljs-keyword">return</span> kerrors.NewBizStatusError(err.Code, err.Msg)
}
</code></pre>
<p>æ›´å…³é”®çš„æ˜¯ï¼ŒAI è¿˜æé†’æˆ‘å¿…é¡»é…ç½® TTHeader MetaHandlerï¼Œå¦åˆ™é”™è¯¯ä¿¡æ¯ä¼ ä¸è¿‡å»ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// å®¢æˆ·ç«¯é…ç½®</span>
client.WithMetaHandler(transmeta.ClientTTHeaderHandler)

<span class="hljs-comment">// æœåŠ¡ç«¯é…ç½®</span>
server.WithMetaHandler(transmeta.ServerTTHeaderHandler)
</code></pre>
<p>è¿™ä¸ªå‘å¦‚æœé è‡ªå·±æ‘¸ç´¢ï¼Œå¯èƒ½è¦è¸©å¥½å‡ å¤©ã€‚</p>
<h3 data-id="heading-4">2.2 æ¶æ„è®¾è®¡çš„æ€è·¯æ‹“å±•</h3>
<p>é¡¹ç›®é‡‡ç”¨äº†æ˜Ÿå‹æ‹“æ‰‘çš„å¾®æœåŠ¡æ¶æ„ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Client    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ HTTP
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                    â”‚   Gateway   â”‚  (Hertz)
                    â”‚   :<span class="hljs-number">8080</span>     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ Thrift RPC
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚               â”‚               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚ <span class="hljs-keyword">Identity</span>    â”‚ â”‚   <span class="hljs-keyword">User</span>      â”‚ â”‚   <span class="hljs-keyword">Order</span>     â”‚
    â”‚ Service     â”‚ â”‚   Service   â”‚ â”‚   Service   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>è¿™ä¸ªæ¶æ„æ˜¯æˆ‘å’Œ AI åå¤è®¨è®ºåç¡®å®šçš„ã€‚æˆ‘æŠŠä¸šåŠ¡éœ€æ±‚æè¿°ç»™ AIï¼Œå®ƒç»™å‡ºäº†å‡ ç§æ‹“æ‰‘æ–¹æ¡ˆçš„å¯¹æ¯”åˆ†æï¼Œæœ€ç»ˆæˆ‘é€‰æ‹©äº†æ˜Ÿå‹æ‹“æ‰‘ï¼š</p>
<ul>
<li>ç½‘å…³æ˜¯å”¯ä¸€å…¥å£ï¼Œæ‰€æœ‰é‰´æƒåœ¨ç½‘å…³å±‚å®Œæˆ</li>
<li>RPC æœåŠ¡ä¹‹é—´ä¸äº’ç›¸è°ƒç”¨ï¼Œé¿å…å¾ªç¯ä¾èµ–</li>
<li>è°ƒè¯•ç®€å•ã€é“¾è·¯æ¸…æ™°ã€å®¹æ˜“æ‰©å±•</li>
</ul>
<p>AI ä¸æ˜¯æ›¿æˆ‘åšå†³ç­–ï¼Œè€Œæ˜¯å¸®æˆ‘ç†æ¸…æ€è·¯ï¼Œè®©æˆ‘èƒ½æ›´å¿«åœ°åšå‡ºåˆ¤æ–­ã€‚</p>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€AI è¾…åŠ©ç¼–ç çš„å®é™…ä½“éªŒ</h2>
<h3 data-id="heading-6">3.1 å¿«é€ŸåŸå‹éªŒè¯</h3>
<p>è¦å®ç°æ–°åŠŸèƒ½æ—¶ï¼Œæˆ‘å…ˆè®© AI ç”Ÿæˆä¸€ä¸ªåŸºç¡€ä»£ç æ¡†æ¶ï¼Œç„¶åæŒ‰é¡¹ç›®è§„èŒƒè°ƒæ•´ä¼˜åŒ–ã€‚</p>
<p>æ¯”å¦‚ RPC æœåŠ¡çš„åˆ†å±‚æ¶æ„ï¼ŒAI å¸®æˆ‘ç”Ÿæˆäº†åŸºç¡€æ¨¡æ¿ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// Handler å±‚ï¼šå‚æ•°æ ¡éªŒ + è°ƒç”¨ä¸šåŠ¡é€»è¾‘</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *IdentityServiceImpl)</span></span> Login(ctx context.Context, req *identity.LoginRequest) (*identity.LoginResponse, <span class="hljs-type">error</span>) {
    <span class="hljs-keyword">if</span> err := validateLoginRequest(req); err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, errno.ToKitexError(errno.ErrInvalidParam)
    }
    <span class="hljs-keyword">return</span> s.logic.Login(ctx, req)
}

<span class="hljs-comment">// Logic å±‚ï¼šæ ¸å¿ƒä¸šåŠ¡é€»è¾‘</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(l *AuthLogic)</span></span> Login(ctx context.Context, req *identity.LoginRequest) (*identity.LoginResponse, <span class="hljs-type">error</span>) {
    user, err := l.dal.GetUserByEmail(ctx, req.Email)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
    }
    <span class="hljs-keyword">if</span> !l.verifyPassword(req.Password, user.PasswordHash) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, errno.ErrInvalidCredentials
    }
    token, err := l.generateToken(user)
    <span class="hljs-comment">// ...</span>
}

<span class="hljs-comment">// DAL å±‚ï¼šæ•°æ®è®¿é—®</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(d *UserDAL)</span></span> GetUserByEmail(ctx context.Context, email <span class="hljs-type">string</span>) (*models.User, <span class="hljs-type">error</span>) {
    <span class="hljs-keyword">var</span> user models.User
    err := d.db.WithContext(ctx).Where(<span class="hljs-string">"email = ?"</span>, email).First(&amp;user).Error
    <span class="hljs-keyword">if</span> errors.Is(err, gorm.ErrRecordNotFound) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, errno.ErrUserNotFound
    }
    <span class="hljs-keyword">return</span> &amp;user, err
}
</code></pre>
<p>è¿™ä¸ªæ¨¡æ¿æˆ‘æ‹¿æ¥ç¨ä½œä¿®æ”¹å°±èƒ½ç”¨ï¼Œçœäº†ä¸å°‘é‡å¤å·¥ä½œã€‚</p>
<h3 data-id="heading-7">3.2 é‡æ„å»ºè®®</h3>
<p>é¡¹ç›®ä¸­æœŸé‡æ„æ—©æœŸä»£ç æ—¶ï¼ŒAI èƒ½è¯†åˆ«å‡ºé—®é¢˜ï¼Œç»™å‡ºé‡æ„å»ºè®®ã€‚</p>
<p>æ¯”å¦‚å®ƒå‘ç°æˆ‘çš„ä»£ç é‡Œæœ‰å¤§é‡ N+1 æŸ¥è¯¢é—®é¢˜ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// AI æŒ‡å‡ºçš„é—®é¢˜ä»£ç </span>
<span class="hljs-keyword">for</span> _, userID := <span class="hljs-keyword">range</span> userIDs {
    user, _ := dal.GetUserByID(ctx, userID)
    users = <span class="hljs-built_in">append</span>(users, user)
}

<span class="hljs-comment">// AI å»ºè®®çš„ä¼˜åŒ–æ–¹æ¡ˆ</span>
users, _ := dal.GetUsersByIDs(ctx, userIDs)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(d *UserDAL)</span></span> GetUsersByIDs(ctx context.Context, ids []<span class="hljs-type">int64</span>) ([]*models.User, <span class="hljs-type">error</span>) {
    <span class="hljs-keyword">var</span> users []*models.User
    err := d.db.WithContext(ctx).Where(<span class="hljs-string">"id IN ?"</span>, ids).Find(&amp;users).Error
    <span class="hljs-keyword">return</span> users, err
}
</code></pre>
<p>è¿˜æœ‰ DTO å’Œ Model ä¹‹é—´çš„è½¬æ¢ä»£ç é‡å¤ç‡å¾ˆé«˜ï¼ŒAI å»ºè®®æˆ‘æŠ½è±¡æˆé€šç”¨å·¥å…·ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// é€šç”¨æŒ‡é’ˆè½¬æ¢</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">PtrToValue</span>[<span class="hljs-title">T</span> <span class="hljs-title">any</span>]<span class="hljs-params">(ptr *T, defaultVal T)</span></span> T {
    <span class="hljs-keyword">if</span> ptr == <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> defaultVal
    }
    <span class="hljs-keyword">return</span> *ptr
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ValueToPtr</span>[<span class="hljs-title">T</span> <span class="hljs-title">any</span>]<span class="hljs-params">(val T)</span></span> *T {
    <span class="hljs-keyword">return</span> &amp;val
}
</code></pre>
<p>è¿™ä¸ªå·¥å…·åº“åæ¥æˆäº†é¡¹ç›®é‡Œå¹¿æ³›ä½¿ç”¨çš„åŸºç¡€è®¾æ–½ã€‚</p>
<h3 data-id="heading-8">3.3 è¸©å‘æ—¶çš„æ•‘å‘½ç¨»è‰</h3>
<p>ç”¨ Docker éƒ¨ç½²æ—¶é‡åˆ°ä¸€ä¸ªè¯¡å¼‚é—®é¢˜ï¼šæœåŠ¡ä¹‹é—´èƒ½é€šä¿¡ï¼Œä½†ç”Ÿæˆçš„é¢„ç­¾å URL å®¢æˆ·ç«¯è®¿é—®ä¸äº†ã€‚</p>
<p>æˆ‘æŠŠé—®é¢˜æè¿°ç»™ AIï¼Œå®ƒå¾ˆå¿«å®šä½åˆ°åŸå› ï¼šå¯¹è±¡å­˜å‚¨åœ¨å®¹å™¨å†…éƒ¨ç”¨çš„æ˜¯å†…éƒ¨åŸŸåï¼Œç”Ÿæˆçš„ URL å¸¦çš„ä¹Ÿæ˜¯å†…éƒ¨åŸŸåï¼Œå¤–éƒ¨è‡ªç„¶è®¿é—®ä¸äº†ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆæ˜¯åŒç«¯ç‚¹é…ç½®ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">type</span> StorageConfig <span class="hljs-keyword">struct</span> {
    Endpoint       <span class="hljs-type">string</span>  <span class="hljs-comment">// å†…éƒ¨ç«¯ç‚¹ï¼Œå®¹å™¨é—´é€šä¿¡ç”¨</span>
    PublicEndpoint <span class="hljs-type">string</span>  <span class="hljs-comment">// å…¬å…±ç«¯ç‚¹ï¼Œç”Ÿæˆé¢„ç­¾å URL ç”¨</span>
}
</code></pre>
<p>è¿™ç§é—®é¢˜å¦‚æœé è‡ªå·±æ’æŸ¥ï¼Œå¯èƒ½è¦èŠ±åŠå¤©ç”šè‡³æ›´ä¹…ã€‚</p>
<hr/>
<h2 data-id="heading-9">å››ã€AI è¾…åŠ©çš„è¾¹ç•Œä¸å±€é™</h2>
<p>ç”¨äº†ä¸€å¹´ AI è¾…åŠ©å¼€å‘ï¼Œæˆ‘ä¹Ÿå‘ç°äº†å®ƒçš„å±€é™æ€§ã€‚</p>
<h3 data-id="heading-10">4.1 ä¸èƒ½å®Œå…¨ç†è§£ä¸šåŠ¡ä¸Šä¸‹æ–‡</h3>
<p>AI ç”Ÿæˆçš„ä»£ç ç»å¸¸éœ€è¦æ ¹æ®é¡¹ç›®å®é™…æƒ…å†µè°ƒæ•´ã€‚æ¯”å¦‚ Wire ä¾èµ–æ³¨å…¥ï¼ŒAI ç»™çš„ç¤ºä¾‹æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// AI ç”Ÿæˆçš„ç¤ºä¾‹ï¼ˆæœ‰é—®é¢˜ï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewUserDAL</span><span class="hljs-params">()</span></span> (*UserDAL, <span class="hljs-type">error</span>) {
    db, err := gorm.Open(postgres.Open(dsn), &amp;gorm.Config{})
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
    }
    <span class="hljs-keyword">return</span> &amp;UserDAL{db: db}, <span class="hljs-literal">nil</span>
}
</code></pre>
<p>é—®é¢˜åœ¨äºæ¯ä¸ª DAL éƒ½ä¼šåˆ›å»ºæ–°çš„æ•°æ®åº“è¿æ¥ï¼Œè¿æ¥æ± æ ¹æœ¬æ²¡ç”¨ä¸Šã€‚æ­£ç¡®åšæ³•æ˜¯æ•°æ®åº“åˆå§‹åŒ–æ”¾åˆ° config å±‚ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// æ­£ç¡®å†™æ³•</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewDatabase</span><span class="hljs-params">(cfg *Config)</span></span> (*gorm.DB, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span>, <span class="hljs-type">error</span>) {
    db, err := gorm.Open(postgres.Open(cfg.DSN), &amp;gorm.Config{})
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, <span class="hljs-literal">nil</span>, err
    }
    cleanup := <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        sqlDB, _ := db.DB()
        sqlDB.Close()
    }
    <span class="hljs-keyword">return</span> db, cleanup, <span class="hljs-literal">nil</span>
}

<span class="hljs-keyword">var</span> ProviderSet = wire.NewSet(
    config.NewDatabase,
    dal.NewUserDAL,    <span class="hljs-comment">// æ¥æ”¶ *gorm.DB ä½œä¸ºå‚æ•°</span>
    <span class="hljs-comment">// ...</span>
)
</code></pre>
<h3 data-id="heading-11">4.2 éœ€è¦ä¸¥æ ¼å®¡æŸ¥å’Œæµ‹è¯•</h3>
<p>AI ç”Ÿæˆçš„ä»£ç ä¸èƒ½ç›´æ¥ç”¨ï¼Œå¿…é¡»å®¡æŸ¥ã€‚æˆ‘ä¼šè®© AI å¸®å¿™æ£€æŸ¥ï¼š</p>
<ul>
<li>é”™è¯¯å¤„ç†æœ‰æ²¡æœ‰é—æ¼</li>
<li>æœ‰æ²¡æœ‰å¹¶å‘å®‰å…¨é—®é¢˜</li>
<li>ä»£ç é£æ ¼ç¬¦ä¸ç¬¦åˆè§„èŒƒ</li>
<li>æœ‰æ²¡æœ‰æ€§èƒ½ä¼˜åŒ–çš„ç©ºé—´</li>
</ul>
<p>ç„¶åå†å†™æµ‹è¯•éªŒè¯ã€‚AI èƒ½æ ¹æ®ä»£ç é€»è¾‘è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ï¼Œè¦†ç›–å„ç§è¾¹ç•Œæƒ…å†µï¼Œè¿™ä¸ªåŠŸèƒ½æˆ‘ç”¨å¾—å¾ˆå¤šã€‚</p>
<hr/>
<h2 data-id="heading-12">äº”ã€æ„å¤–çš„æ”¶è·ï¼šä»ä½¿ç”¨è€…åˆ°è´¡çŒ®è€…</h2>
<p>å­¦ä¹  CloudWeGo ç”Ÿæ€æ—¶ï¼Œæˆ‘å‘ç°äº†ä¸€äº›å¯ä»¥æ”¹è¿›çš„åœ°æ–¹ã€‚ä»¥å‰å¯èƒ½å°±ç®—äº†ï¼Œä½†æœ‰äº† AI å¸®å¿™ç†è§£æºç å’Œå†™ PRï¼Œæˆ‘çœŸçš„å»æäº¤äº†æ”¹è¿›å»ºè®®ã€‚</p>
<p><strong>ç¤¾åŒºè´¡çŒ®</strong>ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhertz-contrib%2Fobs-opentelemetry%2Fissues%2F66" target="_blank" title="https://github.com/hertz-contrib/obs-opentelemetry/issues/66" ref="nofollow noopener noreferrer">obs-opentelemetry #66</a>ï¼šå…³äº OpenTelemetry é›†æˆçš„é—®é¢˜è®¨è®º</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhertz-contrib%2Fjwt%2Fissues%2F26" target="_blank" title="https://github.com/hertz-contrib/jwt/issues/26" ref="nofollow noopener noreferrer">jwt #26</a>ï¼šJWT ä¸­é—´ä»¶çš„æ”¹è¿›å»ºè®®</li>
</ul>
<p>ä»"ä½¿ç”¨è€…"å˜æˆ"è´¡çŒ®è€…"ï¼Œè¿™æ˜¯æˆ‘ä¹‹å‰æ²¡æƒ³è¿‡çš„äº‹æƒ…ã€‚AI é™ä½äº†å‚ä¸å¼€æºçš„é—¨æ§›ã€‚</p>
<p><strong>å¼€æºæ•™ç¨‹é¡¹ç›®</strong>ï¼š</p>
<p>æˆ‘æŠŠé¡¹ç›®ä¸­çš„ç»éªŒæ•´ç†æˆäº†ä¸€ä¸ªå¼€æºé¡¹ç›® <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmasonsxu%2Fcloudwego-microservice-demo" target="_blank" title="https://github.com/masonsxu/cloudwego-microservice-demo" ref="nofollow noopener noreferrer">cloudwego-microservice-demo</a>ï¼ŒåŒ…å«ï¼š</p>
<ul>
<li>å®Œæ•´çš„é¡¹ç›®ç»“æ„</li>
<li>Wire ä¾èµ–æ³¨å…¥ç¤ºä¾‹</li>
<li>é”™è¯¯å¤„ç†æœ€ä½³å®è·µ</li>
<li>Docker éƒ¨ç½²é…ç½®</li>
</ul>
<p>AI åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¸®æˆ‘æ¢³ç†çŸ¥è¯†ç‚¹ã€ä¼˜åŒ–æ–‡æ¡£ç»“æ„ã€ç”Ÿæˆç¤ºä¾‹ä»£ç ã€‚</p>
<hr/>
<h2 data-id="heading-13">å…­ã€ä¸€äº›æ€è€ƒ</h2>
<h3 data-id="heading-14">6.1 AI æ˜¯æ”¾å¤§å™¨ï¼Œä¸æ˜¯æ›¿ä»£å“</h3>
<p>è¿™ä¸€å¹´ä¸‹æ¥ï¼Œæˆ‘æœ€æ·±çš„ä½“ä¼šæ˜¯ï¼šAI ä¸æ˜¯è¦æ›¿ä»£å¼€å‘è€…ï¼Œè€Œæ˜¯æ”¾å¤§å¼€å‘è€…çš„èƒ½åŠ›ã€‚</p>
<p>å®ƒèƒ½å¤„ç†é‡å¤æ€§å·¥ä½œï¼Œè®©æˆ‘ä¸“æ³¨åœ¨æ›´æœ‰ä»·å€¼çš„åˆ›é€ æ€§å·¥ä½œä¸Šã€‚åŒæ—¶æä¾›å³æ—¶çš„çŸ¥è¯†æ”¯æŒï¼Œå¤§å¤§é™ä½äº†æŠ€æœ¯å­¦ä¹ çš„é—¨æ§›ã€‚</p>
<p>ä½†å†³ç­–è¿˜æ˜¯å¾—è‡ªå·±åšï¼Œä»£ç è¿˜æ˜¯å¾—è‡ªå·±å®¡ï¼Œæ¶æ„è¿˜æ˜¯å¾—è‡ªå·±æŠŠæ§ã€‚</p>
<h3 data-id="heading-15">6.2 å½¢æˆè‡ªå·±çš„å·¥ä½œæµ</h3>
<p>æˆ‘ç°åœ¨çš„å·¥ä½œæµå¤§æ¦‚æ˜¯ï¼š</p>
<ol>
<li>é‡åˆ°æ–°æŠ€æœ¯/æ–°éœ€æ±‚ï¼Œå…ˆé—® AI äº†è§£æ¦‚å¿µå’Œæœ€ä½³å®è·µ</li>
<li>è®© AI ç”Ÿæˆä»£ç æ¡†æ¶ï¼Œè‡ªå·±è°ƒæ•´ç»†èŠ‚</li>
<li>æäº¤å‰è®© AI åš code review</li>
<li>é‡åˆ° bug æ—¶æè¿°é—®é¢˜ï¼Œè®© AI å¸®å¿™åˆ†æ</li>
<li>å†™æ–‡æ¡£æ—¶è®© AI å¸®å¿™æ¢³ç†ç»“æ„</li>
</ol>
<p>è¿™ç§"äººæœºåä½œ"çš„æ¨¡å¼ï¼Œè®©æˆ‘çš„æ•ˆç‡æå‡äº†ä¸å°‘ã€‚</p>
<hr/>
<h2 data-id="heading-16">ä¸ƒã€æ€»ç»“</h2>
<p>å›é¡¾è¿™ä¸€å¹´ï¼ŒAI å·¥å…·ç¡®å®ç»™æˆ‘çš„å¼€å‘å·¥ä½œå¸¦æ¥äº†å¾ˆå¤§å˜åŒ–ï¼š</p>
<p><strong>æ•ˆç‡æå‡</strong>ï¼š</p>
<ul>
<li>å­¦æ–°æ¡†æ¶çš„æ—¶é—´å¤§å¹…ç¼©çŸ­</li>
<li>é—®é¢˜æ’æŸ¥æ›´å¿«</li>
<li>é‡å¤æ€§ä»£ç å·¥ä½œå‡å°‘</li>
</ul>
<p><strong>èƒ½åŠ›çªç ´</strong>ï¼š</p>
<ul>
<li>æˆåŠŸå®Œæˆäº†å¤æ‚çš„å¾®æœåŠ¡æ¶æ„é¡¹ç›®</li>
<li>ä»"ä½¿ç”¨è€…"å˜æˆäº†"è´¡çŒ®è€…"</li>
<li>æŠ€æœ¯æ ˆæ‰©å±•äº†ä¸å°‘ï¼ˆGoã€CloudWeGoã€Dockerã€åˆ†å¸ƒå¼ç³»ç»Ÿï¼‰</li>
</ul>
<p><strong>æ€ç»´æ–¹å¼æ”¹å˜</strong>ï¼š</p>
<ul>
<li>é‡åˆ°é—®é¢˜å…ˆé—® AI æˆäº†ä¹ æƒ¯</li>
<li>çŸ¥è¯†è·å–å’Œé—®é¢˜è§£å†³æ›´é«˜æ•ˆ</li>
<li>æ•¢äºå°è¯•ä»¥å‰è§‰å¾—å¤ªéš¾çš„äº‹æƒ…</li>
</ul>
<p>æœ€é‡è¦çš„æ˜¯ï¼ŒAI è®©æˆ‘èƒ½çªç ´åŸæœ¬çš„èƒ½åŠ›ä¸Šé™ã€‚å®ƒä¸åªæ˜¯æé«˜äº†å·¥ä½œæ•ˆç‡ï¼Œè¿˜æ”¹å˜äº†æˆ‘çš„å­¦ä¹ æ–¹å¼å’Œæ€ç»´æ–¹å¼ã€‚</p>
<hr/>
<h2 data-id="heading-17">å†™åœ¨æœ€å</h2>
<p>å¦‚æœä½ è¿˜æ²¡è¯•è¿‡ AI è¾…åŠ©å¼€å‘ï¼Œå¯ä»¥ä»è¿™å‡ æ­¥å¼€å§‹ï¼š</p>
<ol>
<li>é€‰ä¸€ä¸ªé€‚åˆä½ çš„ AI ç¼–ç¨‹åŠ©æ‰‹</li>
<li>ä»ç®€å•çš„ä»£ç è¡¥å…¨å’Œé—®é¢˜å’¨è¯¢å¼€å§‹</li>
<li>é€æ­¥å°è¯•æ›´å¤æ‚çš„ä»»åŠ¡ï¼Œæ¯”å¦‚ä»£ç é‡æ„ã€æ¶æ„è®¾è®¡</li>
<li>å½¢æˆè‡ªå·±çš„ AI å·¥ä½œæµ</li>
<li>æŒç»­å­¦ä¹ å’Œä¼˜åŒ–ï¼Œæ‰¾åˆ°æœ€é€‚åˆä½ çš„æ–¹å¼</li>
</ol>
<p>è®°ä½ï¼ŒAI æ˜¯å·¥å…·ï¼Œä½ æ‰æ˜¯åˆ›é€ è€…ã€‚å–„ç”¨ AIï¼Œè®©å®ƒæˆä¸ºä½ æŠ€æœ¯æˆé•¿çš„åŠ é€Ÿå™¨ã€‚</p>
<p><strong>2025ï¼Œä¸€èµ·æ‹¥æŠ± Vibe Codingï¼</strong></p>
<hr/>
<p><em>å¦‚æœä½ åœ¨ Go å¾®æœåŠ¡å¼€å‘æˆ– AI è¾…åŠ©ç¼–ç¨‹æ–¹é¢æœ‰ä»€ä¹ˆæƒ³æ³•ï¼Œæ¬¢è¿è¯„è®ºåŒºäº¤æµï¼</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Git æäº¤å†å²å¤ªä¹±ï¼Ÿæ•™ä½ æ¸…ç†å¹¶è§„èŒƒ commit message]]></title>    <link>https://juejin.cn/post/7591317772074418195</link>    <guid>https://juejin.cn/post/7591317772074418195</guid>    <pubDate>2026-01-04T13:02:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591317772074418195" data-draft-id="7591422577937924102" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Git æäº¤å†å²å¤ªä¹±ï¼Ÿæ•™ä½ æ¸…ç†å¹¶è§„èŒƒ commit message"/> <meta itemprop="keywords" content="GitHub"/> <meta itemprop="datePublished" content="2026-01-04T13:02:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BER_c"/> <meta itemprop="url" content="https://juejin.cn/user/2922947632702334"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Git æäº¤å†å²å¤ªä¹±ï¼Ÿæ•™ä½ æ¸…ç†å¹¶è§„èŒƒ commit message
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2922947632702334/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BER_c
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T13:02:35.000Z" title="Sun Jan 04 2026 13:02:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æ—¥å¸¸çš„ Git å¼€å‘åä½œä¸­ï¼Œä½ æ˜¯å¦é‡åˆ°è¿‡è¿™æ ·çš„æƒ…å†µï¼šåŠŸèƒ½åˆ†æ”¯ä¸Šåå¤æäº¤äº†å¤šä¸ªâ€œè¡¥ä¸å¼â€æäº¤ï¼ˆå¦‚â€œä¿®å¤ typoâ€ã€â€œå¿˜è®°æäº¤æ–‡ä»¶â€ï¼‰ï¼Œæœ€ç»ˆå¯¼è‡´æäº¤å†å²æ‚ä¹±æ— ç« ã€éš¾ä»¥è¿½æº¯ï¼Ÿè¿™ä¸ä»…è®© git log å¤±å»äº†åº”æœ‰çš„å¯è¯»æ€§ï¼Œä¹Ÿè®© Code Review å˜å¾—ä½æ•ˆä¸”ç—›è‹¦ã€‚</p>
<p>æœ¬æ–‡å°†ç³»ç»Ÿæ€§åœ°ä¸ºä½ æ¢³ç†å¦‚ä½•é€šè¿‡è§„èŒƒæäº¤ä¿¡æ¯ã€ä½¿ç”¨ rebaseã€merge --squashã€reset ç­‰å‘½ä»¤ï¼Œä»¥åŠå€ŸåŠ©è‡ªåŠ¨åŒ–å·¥å…·ï¼Œå°†é›¶æ•£ã€ä¸è§„èŒƒçš„æäº¤å†å²æ•´ç†æˆæ¸…æ™°ã€é€»è¾‘å®Œæ•´ã€æ˜“äºå›æº¯çš„ç‰ˆæœ¬è®°å½•ã€‚æ— è®ºä½ æ˜¯åˆšæ¥è§¦ Git çš„æ–°æ‰‹ï¼Œè¿˜æ˜¯å¸Œæœ›æå‡å›¢é˜Ÿåä½œæ•ˆç‡çš„è€æ‰‹ï¼Œéƒ½èƒ½ä»ä¸­æ‰¾åˆ°å®ç”¨çš„è§£å†³æ–¹æ¡ˆå’Œæœ€ä½³å®è·µã€‚</p>
<h2 data-id="heading-0">ä¸€ã€æäº¤è§„èŒƒ</h2>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>(<span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>): <span class="hljs-tag">&lt;<span class="hljs-name">subject</span>&gt;</span>
</code></pre>
<ul>
<li>æ³¨æ„å†’å·ï¼ˆè‹±æ–‡ï¼‰ : åæœ‰ç©ºæ ¼</li>
</ul>
<p><strong>scopeé€‰å¡«</strong>è¡¨ç¤ºcommitçš„ä½œç”¨èŒƒå›´ï¼Œå¦‚æ•°æ®å±‚ã€è§†å›¾å±‚ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›®å½•åç§°Â </p>
<p><strong>subjectå¿…å¡«</strong>ç”¨äºå¯¹commitè¿›è¡Œç®€çŸ­çš„æè¿°Â </p>
<p><strong>typeå¿…å¡«</strong>è¡¨ç¤ºæäº¤ç±»å‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">feat - æ–°åŠŸèƒ½ feature
fix - ä¿®å¤ bug
docs - æ–‡æ¡£æ³¨é‡Š
style - ä»£ç æ ¼å¼(ä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨)
refactor - é‡æ„ã€ä¼˜åŒ–(æ—¢ä¸å¢åŠ æ–°åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®å¤bug)
perf - æ€§èƒ½ä¼˜åŒ–
test - å¢åŠ æµ‹è¯•
chore - æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨
revert - å›é€€
build - æ‰“åŒ…
</code></pre>
<h2 data-id="heading-1">äºŒã€è§£å†³æäº¤ä¸å¹²å‡€ã€ä¸è§„èŒƒ</h2>
<p>åœ¨åŠŸèƒ½åˆ†æ”¯ä¸Šå¼€å‘æ—¶ï¼Œå¤šæ¬¡æäº¤ä¸­åŒ…å«â€œè¡¥ä¸å¼æäº¤â€ï¼ˆæ¯”å¦‚â€œå¿˜è®°æäº¤çš„æ–‡ä»¶â€ã€â€œä¿®å¤ä¸Šä¸€æ¬¡çš„ typoâ€ï¼‰ï¼Œå¯¼è‡´æäº¤å†å²ä¸å¹²å‡€ã€ä¸è§„èŒƒ</p>
<h3 data-id="heading-2">è§£å†³ç›®æ ‡ï¼š</h3>
<ul>
<li>åˆå¹¶å¤šä¸ªâ€œè¡¥ä¸å¼â€æäº¤ä¸ºä¸€ä¸ªé€»è¾‘å®Œæ•´çš„æäº¤ã€‚</li>
</ul>

<ul>
<li>é‡å‘½åæäº¤ä¿¡æ¯ï¼Œä½¿å…¶è§„èŒƒã€æ¸…æ™°ã€‚</li>
</ul>

<ul>
<li>æœ€ç»ˆæ¨é€åˆ°è¿œç¨‹åˆ†æ”¯æ—¶ï¼Œæäº¤å†å²å¹²å‡€ã€å¯è¯»ã€ä¾¿äº Code Review å’Œå›æº¯</li>
</ul>
<h3 data-id="heading-3">1. æ–¹æ¡ˆä¸€ï¼š</h3>
<h4 data-id="heading-4">1.1. æŸ¥çœ‹æäº¤å†å²</h4>
<pre><code class="hljs language-lua" lang="lua">git <span class="hljs-built_in">log</span> <span class="hljs-comment">--oneline</span>
</code></pre>
<p>è¾“å‡ºï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">dace4a8</span> <span class="hljs-string">(HEAD</span> <span class="hljs-string">-&gt;</span> <span class="hljs-string">testBase,</span> <span class="hljs-string">origin/testBase)</span> <span class="hljs-attr">feat:</span> <span class="hljs-string">å…¶ä»–æ¨¡å—æäº¤</span>
<span class="hljs-attr">635804e fix:</span> <span class="hljs-string">æ ·å¼ä¿®æ”¹</span>
<span class="hljs-attr">64e9d01 fix:</span> <span class="hljs-string">å»é™¤è°ƒè¯•ä»£ç </span>
<span class="hljs-attr">1aee000 fix:</span> <span class="hljs-string">ç¬¬ä¸€æ¬¡æäº¤çš„è¡¥ä¸</span>
<span class="hljs-attr">21b9b13 feat:</span> <span class="hljs-string">æµ‹è¯•å‡è®¾ä¸€æ¬¡å¤§çš„æäº¤</span>
<span class="hljs-attr">a1caa06 feat:</span> <span class="hljs-string">æ–°åˆ†æ”¯ç¬¬ä¸€æ¬¡æäº¤</span>
</code></pre>
<p>å‡è®¾æƒ³æŠŠ 21b9b13 å’Œä»–çš„è¡¥ä¸ä»£ç åˆå¹¶æˆä¸ºä¸€ä¸ªå®Œæ•´åŠŸèƒ½çš„æäº¤</p>
<h4 data-id="heading-5">1.2. å¯åŠ¨äº¤äº’å¼å˜åŸº</h4>
<p>è¿™é‡Œä» a1caa06 ä¹‹åå¼€å§‹</p>
<pre><code class="hljs language-css" lang="css">git rebase -<span class="hljs-selector-tag">i</span> a1caa06
</code></pre>
<p>ä¼šæ‰“å¼€ç¼–è¾‘å™¨ï¼Œç°å®å¦‚ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">pick 21b9b13 feat:</span> <span class="hljs-string">æµ‹è¯•å‡è®¾ä¸€æ¬¡å¤§çš„æäº¤</span>
<span class="hljs-attr">pick 1aee000 fix:</span> <span class="hljs-string">ç¬¬ä¸€æ¬¡æäº¤çš„è¡¥ä¸</span>
<span class="hljs-attr">pick 64e9d01 fix:</span> <span class="hljs-string">å»é™¤è°ƒè¯•ä»£ç </span>
<span class="hljs-attr">pick 635804e fix:</span> <span class="hljs-string">æ ·å¼ä¿®æ”¹</span>
<span class="hljs-attr">pick dace4a8 feat:</span> <span class="hljs-string">å…¶ä»–æ¨¡å—æäº¤</span>
</code></pre>
<h4 data-id="heading-6">1.3. ä¿®æ”¹æŒ‡ä»¤æ•´ç†æäº¤</h4>
<p>å½“æˆ‘ä»¬æƒ³æŠŠä¸‰ä¸ªfixåˆå¹¶åˆ° f7f0097 å½¢æˆä¸€ä¸ªå®Œæ•´çš„æäº¤ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æ”¹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">pick f7f0097 feat:</span> <span class="hljs-string">è¿™æ˜¯ä¸€æ¬¡å¤§çš„æ”¹åŠ¨</span>
<span class="hljs-attr">s 14f3ec6 fix:</span> <span class="hljs-string">å¯¹ä¸Šä¸€æ¬¡æäº¤çš„è¡¥ä¸</span>
<span class="hljs-attr">s 0cd3e04 fix:</span> <span class="hljs-string">å¿˜è®°å»æ‰è°ƒè¯•çš„ä»£ç äº†</span>
<span class="hljs-attr">s f9491c1 fix:</span> <span class="hljs-string">æ ·å¼ä¿®æ”¹</span>
<span class="hljs-attr">pick 0eab36a feat:</span> <span class="hljs-string">xxxéœ€æ±‚å¼€å‘å®Œæˆ</span>
</code></pre>
<blockquote>
<p><code>squash</code>ï¼ˆæˆ–ç®€å†™ <code>s</code>ï¼‰ï¼šå°†è¯¥æäº¤åˆå¹¶åˆ°ä¸Šä¸€ä¸ª <code>pick</code> çš„æäº¤ä¸­ï¼Œå¹¶è®©ä½ ç¼–è¾‘åˆå¹¶åçš„æäº¤ä¿¡æ¯ã€‚</p>
</blockquote>
<p>ä¿å­˜å¹¶å…³é—­ç¼–è¾‘å™¨</p>
<h4 data-id="heading-7">1.4. <strong>ç¼–è¾‘åˆå¹¶åçš„æäº¤ä¿¡æ¯</strong></h4>
<p>Git ä¼šå†æ¬¡æ‰“å¼€ç¼–è¾‘å™¨ï¼Œè®©ä½ ç¼–è¾‘åˆå¹¶åçš„æäº¤ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-comment"># This is a combination of 4 commits.</span>
<span class="hljs-comment"># This is the 1st commit message:</span>
<span class="hljs-section">feat: æµ‹è¯•å‡è®¾ä¸€æ¬¡å¤§çš„æäº¤</span>
<span class="hljs-comment"># This is the commit message #2:</span>
<span class="hljs-section">fix: ç¬¬ä¸€æ¬¡æäº¤çš„è¡¥ä¸</span>
<span class="hljs-comment"># This is the commit message #3:</span>
<span class="hljs-section">fix: å»é™¤è°ƒè¯•ä»£ç </span>
<span class="hljs-comment"># This is the commit message #4:</span>
<span class="hljs-section">fix: æ ·å¼ä¿®æ”¹</span>
<span class="hljs-comment"># Please enter the commit message for your changes. Lines starting</span>
<span class="hljs-comment"># with '#' will be ignored, and an empty message aborts the commit.</span>
<span class="hljs-comment">#</span>
<span class="hljs-section">feat: å®Œæ•´å®ç°XXXåŠŸèƒ½ï¼ˆå«xxã€xxã€xxï¼‰</span>
</code></pre>
<p>ä¿å­˜å…³é—­</p>
<h4 data-id="heading-8">1.5. <strong>å¼ºåˆ¶æ¨é€ï¼ˆæ³¨æ„ï¼šä»…é™æœªè¢«ä»–äººä½¿ç”¨çš„åˆ†æ”¯ï¼‰</strong></h4>
<pre><code class="hljs language-bash" lang="bash">git push origin feature/xxx --force-with-lease
</code></pre>
<blockquote>
<p>æ¨èä½¿ç”¨ <code>--force-with-lease</code> è€Œä¸æ˜¯ <code>--force</code>ï¼Œå®ƒæ›´å®‰å…¨ â€”â€” å¦‚æœåˆ«äººåœ¨ä½ ä¹‹åæ¨é€äº†ä»£ç ï¼Œä¼šæ‹’ç»å¼ºåˆ¶æ¨é€ï¼Œé¿å…è¦†ç›–ä»–äººå·¥ä½œ</p>
</blockquote>
<h4 data-id="heading-9">1.6. æ•´ç†æ•ˆæœ</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">c58c94a</span> <span class="hljs-string">(HEAD</span> <span class="hljs-string">-&gt;</span> <span class="hljs-string">testBase,</span> <span class="hljs-string">origin/testBase)</span> <span class="hljs-attr">feat:</span> <span class="hljs-string">å…¶ä»–æ¨¡å—æäº¤</span>
<span class="hljs-attr">ec9cfef feat:</span> <span class="hljs-string">æµ‹è¯•å‡è®¾ä¸€æ¬¡å¤§çš„æäº¤</span> <span class="hljs-string">//</span> <span class="hljs-string">å·²ç»è¢«åˆå¹¶</span>
<span class="hljs-attr">a1caa06 feat:</span> <span class="hljs-string">æ–°åˆ†æ”¯ç¬¬ä¸€æ¬¡æäº¤</span>
</code></pre>
<h3 data-id="heading-10">æ–¹æ¡ˆäºŒï¼šä½¿ç”¨åˆå¹¶æ—¶å‹ç¼©æäº¤</h3>
<h4 data-id="heading-11">2.1 åˆ›å»ºæ–°åˆ†æ”¯å¹¶åˆå¹¶å‹ç¼©</h4>
<pre><code class="hljs language-bash" lang="bash"> <span class="hljs-comment"># ä»è¦æ•´ç†çš„æäº¤ä¹‹å‰åˆ›å»ºä¸€ä¸ªæ–°åˆ†æ”¯</span>
git checkout -b clean-branch a1caa06

<span class="hljs-comment"># å°†åŸåˆ†æ”¯åˆå¹¶åˆ°æ–°åˆ†æ”¯ï¼Œå¹¶å‹ç¼©æ‰€æœ‰æäº¤ä¸ºä¸€ä¸ª</span>
git merge --squash testBase

<span class="hljs-comment"># æ­¤æ—¶æ‰€æœ‰æ›´æ”¹éƒ½å·²æš‚å­˜ï¼Œåˆ›å»ºæ–°çš„æäº¤</span>
git commit -m <span class="hljs-string">"feat: å®Œæ•´å®ç°XXXåŠŸèƒ½ï¼ˆå«xxã€xxã€xxï¼‰
</span></code></pre>
<h4 data-id="heading-12">2.2 æ–¹æ¡ˆäºŒå˜ä½“ï¼šé€‰æ‹©æ€§åˆå¹¶</h4>
<pre><code class="hljs language-perl" lang="perl"> <span class="hljs-comment"># åˆ›å»ºæ–°åˆ†æ”¯</span>
git checkout -b clean-branch

<span class="hljs-comment"># ä½¿ç”¨cherry-pické€‰æ‹©éœ€è¦çš„æäº¤</span>
git cherry-pick <span class="hljs-number">21</span>b9b13  <span class="hljs-comment"># åŸºç¡€æäº¤</span>
git cherry-pick <span class="hljs-number">1</span>aee00<span class="hljs-number">0</span>  <span class="hljs-comment"># è¡¥ä¸1</span>
git cherry-pick <span class="hljs-number">64</span>e9d01  <span class="hljs-comment"># è¡¥ä¸2</span>
git cherry-pick <span class="hljs-number">635804</span>e  <span class="hljs-comment"># è¡¥ä¸3</span>

<span class="hljs-comment"># é‡ç½®åˆ°cherry-pickä¹‹å‰çš„çŠ¶æ€ï¼Œä½†ä¿ç•™æ›´æ”¹</span>
git <span class="hljs-keyword">reset</span> --soft HEAD~<span class="hljs-number">4</span>

<span class="hljs-comment"># é‡æ–°æäº¤ä¸ºä¸€ä¸ªå®Œæ•´çš„æäº¤</span>
git commit -m <span class="hljs-string">"feat: å®Œæ•´å®ç°XXXåŠŸèƒ½ï¼ˆå«xxã€xxã€xxï¼‰"</span>

<span class="hljs-comment"># ç»§ç»­æ·»åŠ å…¶ä»–æäº¤ï¼ˆå¦‚æœéœ€è¦ï¼‰</span>
git cherry-pick dace4a8  <span class="hljs-comment"># å…¶ä»–æ¨¡å—æ</span>
</code></pre>
<h3 data-id="heading-13">æ–¹æ¡ˆä¸‰ï¼šä½¿ç”¨resetæ•´ç†æäº¤å†å²</h3>
<h4 data-id="heading-14">3.1 è½¯é‡ç½®åé‡æ–°æäº¤</h4>
<pre><code class="hljs language-perl" lang="perl"> <span class="hljs-comment"># 1. æŸ¥çœ‹è¦åˆå¹¶çš„æäº¤èŒƒå›´</span>
git <span class="hljs-keyword">log</span> --oneline

<span class="hljs-comment"># 2. é‡ç½®åˆ°è¦åˆå¹¶çš„ç¬¬ä¸€ä¸ªæäº¤ä¹‹å‰ï¼ˆä¿ç•™å·¥ä½œåŒºæ›´æ”¹ï¼‰</span>
git <span class="hljs-keyword">reset</span> --soft a1caa06

<span class="hljs-comment"># 3. æš‚å­˜æ‰€æœ‰æ›´æ”¹å¹¶åˆ›å»ºæ–°æäº¤</span>
git add .
git commit -m <span class="hljs-string">"feat: å®Œæ•´å®ç°XXXåŠŸèƒ½ï¼ˆå«xxã€xxã€xxï¼‰"</span>

<span class="hljs-comment"># 4. æ·»åŠ åç»­çš„æäº¤ï¼ˆå¦‚æœéœ€è¦ï¼‰</span>
git cherry-pick dace4a
</code></pre>
<h3 data-id="heading-15">æ–¹æ¡ˆå››ï¼šä½¿ç”¨Git Extensionsæˆ–SourceTreeç­‰GUIå·¥å…·</h3>
<p>å¯¹äºä¸ç†Ÿæ‚‰å‘½ä»¤è¡Œçš„ç”¨æˆ·ï¼Œå¯ä»¥ä½¿ç”¨å›¾å½¢åŒ–å·¥å…·ï¼š</p>
<ol>
<li><strong>Git Extensions</strong>ï¼šå³é”®æäº¤ â†’ "äº¤äº’å¼å˜åŸº"</li>
</ol>

<ol start="2">
<li><strong>SourceTree</strong>ï¼šå³å‡»æäº¤ â†’ "äº¤äº’å¼å˜åŸºå­èœå•"</li>
</ol>

<ol start="3">
<li><strong>VS Code GitLensæ‰©å±•</strong>ï¼šæä¾›å¯è§†åŒ–çš„rebaseç•Œé¢</li>
</ol>
<h2 data-id="heading-16">æœ€ä½³å®è·µå»ºè®®</h2>
<h3 data-id="heading-17">1 æäº¤ä¿¡æ¯è§„èŒƒ</h3>
<h3 data-id="heading-18">1.1 å¼€å‘æ—¶çš„æäº¤ç­–ç•¥</h3>
<pre><code class="hljs language-bash" lang="bash"> <span class="hljs-comment"># å¼€å‘æ—¶é¢‘ç¹æäº¤ï¼ˆæœ¬åœ°ï¼‰</span>
git add .
git commit -m <span class="hljs-string">"WIP: æ­£åœ¨å¼€å‘XXåŠŸèƒ½"</span>

<span class="hljs-comment"># åŠŸèƒ½å®Œæˆåæ•´ç†æäº¤</span>
git rebase -i HEAD~5  <span class="hljs-comment"># æ•´ç†æœ€è¿‘5ä¸ªæäº¤</span>

<span class="hljs-comment"># æ¨é€å‰ç¡®ä¿æäº¤å†å²æ•´æ´</span>
git <span class="hljs-built_in">log</span> --oneline --grap
</code></pre>
<h3 data-id="heading-19">1.2 åˆ†æ”¯ç®¡ç†ç­–ç•¥</h3>
<pre><code class="hljs language-bash" lang="bash"> <span class="hljs-comment"># 1. åŠŸèƒ½åˆ†æ”¯ä»developåˆ†æ”¯åˆ›å»º</span>
git checkout -b feature/xxx develop

<span class="hljs-comment"># 2. å¼€å‘è¿‡ç¨‹ä¸­å®šæœŸrebase developåˆ†æ”¯</span>
git fetch origin
git rebase origin/develop

<span class="hljs-comment"># 3. å®ŒæˆåŠŸèƒ½åæ•´ç†æäº¤</span>
git rebase -i develop

<span class="hljs-comment"># 4. æ¨é€åˆ°è¿œç¨‹</span>
git push origin feature/xxx --force-with-leas
</code></pre>
<h3 data-id="heading-20">1.3 å›¢é˜Ÿåä½œæ³¨æ„äº‹é¡¹</h3>
<ol>
<li><strong>ç§äººåˆ†æ”¯</strong>ï¼šå¯ä»¥è‡ªç”±ä½¿ç”¨force push</li>
</ol>

<ol start="2">
<li><strong>å…±äº«åˆ†æ”¯</strong>ï¼šé¿å…force pushï¼Œæˆ–ä½¿ç”¨<code>--force-with-lease</code></li>
</ol>

<ol start="3">
<li><strong>ä¸»å¹²åˆ†æ”¯</strong>ï¼šç¦æ­¢force push</li>
</ol>

<ol start="4">
<li><strong>ä»£ç å®¡æŸ¥å‰</strong>ï¼šæ•´ç†æäº¤å†å²ï¼Œä¾¿äºreview</li>
</ol>
<h2 data-id="heading-21">è‡ªåŠ¨åŒ–å·¥å…·æ¨è</h2>
<h3 data-id="heading-22">1. æäº¤ä¿¡æ¯æ ¡éªŒ</h3>
<p>ä½¿ç”¨commitlintï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby"> <span class="hljs-comment"># å®‰è£…commitlint</span>
npm install --save-dev <span class="hljs-variable">@commitlint</span>/config-conventional <span class="hljs-variable">@commitlint</span>/cli

<span class="hljs-comment"># é…ç½®.commitlintrc.js</span>
<span class="hljs-keyword">module</span>.exports = {
  <span class="hljs-symbol">extends:</span> [<span class="hljs-string">'@commitlint/config-conventional'</span>]
</code></pre>
<h3 data-id="heading-23">2.GitHub Copilot / Cursor / CodeWhisperer</h3>
<p>å¯æ ¹æ®ä»£ç å˜æ›´å»ºè®®æäº¤ä¿¡æ¯ï¼ˆéœ€æ‰‹åŠ¨ç¡®è®¤ï¼‰ã€‚</p>
<p>ç¤ºä¾‹ï¼šåœ¨ VS Code ä¸­ï¼ŒCopilot æœ‰æ—¶ä¼šåœ¨ä½  git add åæç¤º â€œWrite a commit messageâ€ã€‚</p>
<h2 data-id="heading-24">æ€»ç»“å¯¹æ¯”</h2>



































<table><thead><tr><th><strong>æ–¹æ¡ˆ</strong></th><th><strong>ä¼˜ç‚¹</strong></th><th><strong>ç¼ºç‚¹</strong></th><th><strong>é€‚ç”¨åœºæ™¯</strong></th></tr></thead><tbody><tr><td>äº¤äº’å¼å˜åŸº</td><td>æœ€çµæ´»ï¼Œå¯ç²¾ç¡®æ§åˆ¶</td><td>å‘½ä»¤å¤æ‚ï¼Œå®¹æ˜“å‡ºé”™</td><td>ç²¾ç¡®æ•´ç†æäº¤å†å²</td></tr><tr><td>åˆå¹¶å‹ç¼©</td><td>ç®€å•æ˜“ç”¨</td><td>å¤±å»ä¸­é—´æäº¤è®°å½•</td><td>å¿«é€Ÿåˆå¹¶æ•´ä¸ªåˆ†æ”¯</td></tr><tr><td>reseté‡ç½®</td><td>æ“ä½œç›´æ¥</td><td>é£é™©è¾ƒé«˜</td><td>ä»å¤´å¼€å§‹æ•´ç†</td></tr><tr><td>GUIå·¥å…·</td><td>å¯è§†åŒ–æ“ä½œ</td><td>åŠŸèƒ½å¯èƒ½æœ‰é™</td><td>ä¸ç†Ÿæ‚‰å‘½ä»¤è¡Œçš„ç”¨æˆ·</td></tr></tbody></table>
<h2 data-id="heading-25">æ¨èæµç¨‹</h2>
<pre><code class="hljs language-bash" lang="bash"> <span class="hljs-comment"># 1. å¼€å‘æ—¶é¢‘ç¹æäº¤ï¼ˆæœ¬åœ°ï¼‰</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"è¿›è¡Œå¼€å‘å·¥ä½œ..."</span>

<span class="hljs-comment"># 2. å®Œæˆä¸€ä¸ªåŠŸèƒ½æ¨¡å—åæ•´ç†</span>
git add .
git commit -m <span class="hljs-string">"feat: æ·»åŠ ç”¨æˆ·ç™»å½•åŠŸèƒ½"</span>

<span class="hljs-comment"># 3. å‘ç°éœ€è¦ä¿®å¤</span>
git add .
git commit --fixup HEAD  <span class="hljs-comment"># è‡ªåŠ¨æ ‡è®°ä¸ºfixup</span>

<span class="hljs-comment"># 4. å®šæœŸæ•´ç†</span>
git rebase -i --autosquash origin/main

<span class="hljs-comment"># 5. æ¨é€å‰æ£€æŸ¥</span>
git <span class="hljs-built_in">log</span> --oneline --graph --decorate

<span class="hljs-comment"># 6. å®‰å…¨æ¨é€</span>
git push origin feature/login --force-with-leas
</code></pre>
<p>é€šè¿‡ä¸Šè¿°æ–¹æ¡ˆå’Œå·¥å…·ï¼Œå¯ä»¥ç¡®ä¿æäº¤å†å²çš„æ•´æ´æ€§ï¼Œæé«˜ä»£ç å®¡æŸ¥æ•ˆç‡ï¼Œä¾¿äºé¡¹ç›®ç»´æŠ¤å’Œé—®é¢˜å›æº¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥æ¢ç©¶ Linux æ€»çº¿-è®¾å¤‡-é©±åŠ¨æ¨¡å‹]]></title>    <link>https://juejin.cn/post/7591346773828042778</link>    <guid>https://juejin.cn/post/7591346773828042778</guid>    <pubDate>2026-01-04T13:46:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591346773828042778" data-draft-id="7591346773828010010" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥æ¢ç©¶ Linux æ€»çº¿-è®¾å¤‡-é©±åŠ¨æ¨¡å‹"/> <meta itemprop="keywords" content="Linux"/> <meta itemprop="datePublished" content="2026-01-04T13:46:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="xlp666hub"/> <meta itemprop="url" content="https://juejin.cn/user/2965810860569131"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥æ¢ç©¶ Linux æ€»çº¿-è®¾å¤‡-é©±åŠ¨æ¨¡å‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2965810860569131/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    xlp666hub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T13:46:52.000Z" title="Sun Jan 04 2026 13:46:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»20åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>åœ¨å­¦ä¹  Linux è®¾å¤‡é©±åŠ¨æ—¶ï¼Œç»å¸¸ä¼šçœ‹åˆ°å„ç§å„æ ·çš„ç»“æ„ä½“ã€æ³¨å†Œæ³¨é”€å‡½æ•°ã€åˆå§‹åŒ–å‡½æ•°ï¼Œè¿™äº›ä¸œè¥¿çœ‹èµ·æ¥ç€å®è®©äººå¤´ç–¼ã€‚ä¸ºä»€ä¹ˆä¸èƒ½åƒå•ç‰‡æœºé‚£æ ·ï¼Œç›´æ¥é…ç½®å¯„å­˜å™¨æˆ–è€…è°ƒä¸ªåº“å‡½æ•°å°±æŠŠç¯ç‚¹äº®ï¼Ÿä¸ºä»€ä¹ˆè¦æçš„è¿™ä¹ˆéº»çƒ¦ï¼Ÿ</p>
<p>ä½†æ˜¯å®é™…ä¸Šæ˜¯è¿™ä¹ˆä¸ªæƒ…å†µï¼š</p>
<p>å•ç‰‡æœºè£¸æœºç¼–ç¨‹æ—¶ï¼Œä»£ç å’Œç¡¬ä»¶æ˜¯ç„Šæ­»çš„ï¼ˆå¼ºè€¦åˆï¼‰ï¼Œæ¢ä¸ªå¼•è„šä»£ç å°±å¾—æ”¹ï¼Œè¦æ˜¯æ¢ä¸ªèŠ¯ç‰‡é‚£ä»£ç å¯èƒ½å°±å¾—é‡å†™ã€‚</p>
<p>ä½†æ˜¯å¯¹äº Linux ï¼Œå®ƒçš„å†…æ ¸ä»£ç å¯èƒ½éœ€è¦åœ¨å…¨ä¸–ç•Œæˆåƒä¸Šä¸‡ç§ç¡¬ä»¶å¹³å°ä¸Šéƒ½èƒ½è·‘èµ·æ¥ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒå¯¹é€šç”¨æ€§çš„è¦æ±‚æ˜¯å¾ˆé«˜çš„ï¼Œå¦‚æœæ¯æ¢ä¸€ä¸ªç¡¬ä»¶å°±å»ä¿®æ”¹ä¸€æ¬¡å†…æ ¸æºç ï¼Œé‚£ Linux å°†ä¼šå˜å¾—ååˆ†è‡ƒè‚¿ä¸”ç»´æŠ¤èµ·æ¥æå…¶å›°éš¾ï¼Œè¿™å¬èµ·æ¥æ¯”ä¸Šé¢é‚£äº›ç»“æ„ä½“ã€æŠ½æƒ³åˆ°éƒ½ä¸çŸ¥é“åœ¨å¹²ä»€ä¹ˆçš„å‡½æ•°æ›´ä»¤äººå¤´ç–¼ä¸€äº›ã€‚</p>
<p>ä¸ºäº† Linux çš„é€šç”¨æ€§ï¼Œæˆ‘ä»¬å¿…é¡»ç‰ºç‰²ä»£ç çš„ç®€ä¾¿æ€§ï¼Œå»æ¢å–æ›´å¥½çš„<strong>å¯æ‰©å±•æ€§</strong>ã€‚</p>
<p>é‚£ä¹ˆ Linux ä¸ºäº†èƒ½åœ¨å¾ˆå¤šç¡¬ä»¶å¹³å°ä¸Šéƒ½èƒ½è¿è¡Œï¼Œå®ƒåˆ°åº•æ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿå®ƒçš„è§£å†³æ–¹æ¡ˆå°±æ˜¯æŠŠ â€œ ç¡¬ä»¶è®¾å¤‡éƒ½æœ‰ä»€ä¹ˆ â€ å’Œ â€œ è½¯ä»¶æ€ä¹ˆå»é©±åŠ¨ç¡¬ä»¶ â€ è¿™ä¸¤ä¸ªéƒ¨åˆ†åˆ†ç¦»ï¼Œä½†æ˜¯å®é™…ä¸Šè¿™ä¸¤ä¸ªéƒ¨åˆ†åˆéœ€è¦ååŒå·¥ä½œï¼Œå› æ­¤å°±éœ€è¦ä¸€ä¸ªä¸­é—´äººå°†å®ƒä»¬è”ç³»èµ·æ¥ï¼Œåœ¨ Linux å†…æ ¸ä¸­ï¼Œè¿™ä¸ªä¸­é—´äººå°±æ˜¯<strong>æ€»çº¿</strong>ã€‚</p>
<p>ç”±æ­¤ï¼Œæ„æˆäº† Linux é©±åŠ¨å¼€å‘ä¸­æœ€æ ¸å¿ƒçš„é“ä¸‰è§’ï¼Œä¹Ÿå°±æ˜¯<strong>æ€»çº¿ - è®¾å¤‡ - é©±åŠ¨æ¨¡å‹</strong>ã€‚</p>
<p>Linux è®¾å¤‡é©±åŠ¨æ¨¡å‹çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†<strong>ç¡¬ä»¶å®šä¹‰</strong>ä¸<strong>é©±åŠ¨é€»è¾‘</strong>åˆ†ç¦»ï¼Œå¹¶é€šè¿‡<strong>æ€»çº¿</strong>å°†ä¸¤è€…è”ç³»èµ·æ¥ã€‚è¿™ç§æ¨¡å‹å¯¹åº”å†…æ ¸ä¸­çš„ä¸‰ä¸ªæ ¸å¿ƒæ•°æ®ç»“æ„ï¼š<code>struct bus_type</code>ã€<code>struct device</code> å’Œ <code>struct device_driver</code>ã€‚</p>
<h2 data-id="heading-1">1 æ€»çº¿</h2>
<p>åœ¨å†…æ ¸ä¸­ï¼Œæ€»çº¿ç”± <code>struct bus_type</code> ç»“æ„ä½“è¡¨ç¤ºï¼Œå®ƒæ˜¯ Linux è®¾å¤‡æ¨¡å‹çš„å…³é”®ï¼ˆå…¶å®ä¸‰ä¸ªéƒ¨åˆ†éƒ½å¾ˆå…³é”®ï¼Œåªæ˜¯æ€»çº¿è´Ÿè´£å°†å…¶ä»–ä¸¤ä¸ªéƒ¨åˆ†è”ç³»èµ·æ¥ï¼‰ï¼Œè¿™ä¸ªç»“æ„ä½“è´Ÿè´£<strong>ç®¡ç†</strong>æŒ‚è½½åœ¨æ€»çº¿ä¸Šé¢çš„æ‰€æœ‰è®¾å¤‡å’Œé©±åŠ¨ã€‚</p>
<p>æ€»çº¿é©±åŠ¨æœ€é‡è¦çš„å·¥ä½œæ˜¯åœ¨å†…æ ¸ä¸­ç®¡ç†ç€ä¸¤ä¸ªé“¾è¡¨ï¼š</p>
<p>ç¬¬ä¸€ä¸ªæ˜¯<strong>è®¾å¤‡é“¾è¡¨</strong>ï¼Œç”¨æ¥è®°å½•æ‰€æœ‰æ³¨å†Œåˆ°è¿™ä¸ªæ€»çº¿çš„è®¾å¤‡å®ä¾‹ã€‚</p>
<p>ç¬¬äºŒä¸ªæ˜¯<strong>é©±åŠ¨é“¾è¡¨</strong>ï¼Œç”¨æ¥è®°å½•æ‰€æœ‰æ³¨å†Œåˆ°è¿™ä¸ªæ€»çº¿çš„é©±åŠ¨ç¨‹åºã€‚</p>
<p>ä½¿ç”¨é“¾è¡¨å°†åˆ†æ•£åœ¨å†…å­˜ä¸­çš„è®¾å¤‡å¯¹è±¡å’Œé©±åŠ¨å¯¹è±¡ä¸²è”èµ·æ¥ï¼Œæœ‰åˆ©äºéå†æŸ¥æ‰¾æ—¶çš„æ•ˆç‡ã€‚</p>
<p>å¤§å®¶å¯ä»¥å»ç¿»ä¸€ä¸‹ Linux çš„å†…æ ¸æºç ï¼Œæ‰¾ä¸€ä¸‹è¿™ä¸ªç»“æ„ä½“ï¼Œçœ‹çœ‹å®ƒå…·ä½“æ˜¯é•¿ä»€ä¹ˆæ ·å­çš„ã€‚å†…æ ¸æºç éœ€è¦è‡ªå·±ä¸‹è½½ã€‚</p>
<p>ä¸‹è½½å¥½å†…æ ¸æºç åï¼Œå¯ä»¥å»ä¸‹é¢ç›®å½•æ‰¾è¿™ä¸ªç»“æ„ä½“ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/kernel/include/linux/device.h
</code></pre>
<p>ä¸‹é¢æ˜¯è¿™ä¸ªç»“æ„ä½“éƒ¨åˆ†å†…å®¹çš„æˆªå›¾ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªç»“æ„ä½“çš„æˆå‘˜éå¸¸å¤šï¼Œæˆ‘ä»¬ä¸éœ€è¦å…¨éƒ¨ææ‡‚ï¼Œåªéœ€è¦æ·±å…¥ç†è§£æœ€å…³é”®çš„å‡ ä¸ªå°±è¡Œäº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a403eaad1154115a00a544df49c20b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGxwNjY2aHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768139212&amp;x-signature=JfMIDGC%2BMHVrVQTDXJzJCuGw4Ps%3D" alt="1. æ€»çº¿ç»“æ„ä½“æºç .png" loading="lazy"/></p>
<h3 data-id="heading-2">1.1 æ€»çº¿åç§°</h3>
<p>æˆ‘ä»¬é¦–å…ˆæ¥çœ‹ç¬¬ 123 è¡Œçš„<code>const char *name</code>ï¼Œè¿™å°±æ˜¯<strong>æ€»çº¿çš„åå­—</strong>ã€‚</p>
<p>è¿™ä¸ªå­—ç¬¦ä¸²å°†ä¼šå†³å®šè¿™ä¸ªæ€»çº¿åœ¨ <strong>Sysfs æ–‡ä»¶ç³»ç»Ÿ</strong> ä¸­å¯¹åº”çš„æ–‡ä»¶å¤¹åç§°ã€‚Sysfs æ˜¯ Linux å†…æ ¸æä¾›çš„<strong>åŸºäºå†…å­˜çš„æ–‡ä»¶ç³»ç»Ÿ</strong>ï¼Œä½†æˆ‘ä»¬ä¸€èˆ¬æ›´ä¹ æƒ¯å«ä»–<strong>è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ</strong>ï¼ŒSysfs é€šå¸¸æŒ‚è½½åœ¨ <code>/sys</code> ç›®å½•ä¸‹ï¼Œæ¯ä¸ªå†…æ ¸å¯¹è±¡å¯¹åº”ä¸€ä¸ªç›®å½•ï¼Œå†…æ ¸å¯¹è±¡å¯ä»¥æ˜¯è®¾å¤‡ï¼Œæ€»çº¿ï¼Œé©±åŠ¨ï¼Œç±»ç­‰ç­‰ï¼Œæ¯ä¸ªå†…æ ¸å¯¹è±¡çš„å±æ€§å¯¹åº”ç€ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨<code>ls</code>å‘½ä»¤æŸ¥çœ‹<code>/sys</code>ç›®å½•ä¸‹çš„æ–‡ä»¶å¤¹ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªåä¸º <code>bus</code> çš„æ–‡ä»¶å¤¹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/310030e167c241dda0585417446c4d15~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGxwNjY2aHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768139212&amp;x-signature=YfC5IJmzc1Q9mLs%2Ffqe8FQvUMAw%3D" alt="2. sysä¸‹ç›®å½•.png" loading="lazy"/></p>
<p>æˆ‘ä»¬å†è¿›å…¥<code>bus</code>æ–‡ä»¶å¤¹æŸ¥çœ‹ï¼Œå¤§å®¶åº”è¯¥å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªåä¸º<code>platform</code>çš„æ–‡ä»¶å¤¹ã€‚å¦‚æœå¥½å¥‡ä¸ºä»€ä¹ˆè¿™é‡Œä¼šå‡ºç°è¿™ä¸ªåä¸º<code>platform</code>çš„æ–‡ä»¶å¤¹ï¼Œè¯·ç»§ç»­å¾€ä¸‹çœ‹ï¼ˆå…¶ä»–æ–‡ä»¶å¤¹ä¹Ÿæ˜¯åŒç†ï¼Œè¿™é‡Œä½¿ç”¨<code>platform</code>ä¸¾ä¾‹å­ï¼‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b8d3f7008b104fd1a9567a37e7bc99c1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGxwNjY2aHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768139212&amp;x-signature=9aRZ2eE5LdD2Wkru7%2F4y%2FZlddN0%3D" alt="3. busä¸‹ç›®å½•.png" loading="lazy"/></p>
<p>åœ¨Linuxå†…æ ¸æºç ä¸­ï¼Œæˆ‘ä»¬è¿›å…¥ä¸‹é¢ç›®å½•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/kernel/drivers/base/platform.c
</code></pre>
<p>å¤§å®¶å¯ä»¥æ‰¾åˆ°è¿™æ®µä»£ç </p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb8a398e5cc64fe0b1c82434a991156e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGxwNjY2aHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768139212&amp;x-signature=3floIs7GqQeQXBRrb%2B4XTW%2BzriY%3D" alt="4. platformæºç .png" loading="lazy"/></p>
<p>è¿™é‡Œçš„ 1180 è¡Œ <code>.name</code> è¢«èµ‹å€¼ä¸ºå­—ç¬¦ä¸² <code>"platform"</code>ï¼Œæ­¤æ—¶å®ƒè¿˜åªæ˜¯ä»£ç é‡Œçš„ä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡ã€‚</p>
<p>å½“å†…æ ¸å¯åŠ¨ï¼Œè°ƒç”¨ <code>bus_register(&amp;platform_bus_type)</code> æ³¨å†Œè¿™æ¡æ€»çº¿æ—¶ï¼ŒLinux çš„ <strong>Sysfs æ–‡ä»¶ç³»ç»Ÿ</strong> æœºåˆ¶å°±å¼€å§‹å·¥ä½œäº†ï¼Œå®ƒä¼šæŠŠ<strong>å†…æ ¸é‡Œçš„æ•°æ®ç»“æ„</strong>æ˜ å°„æˆ<strong>ç”¨æˆ·ç©ºé—´çš„æ–‡ä»¶å’Œç›®å½•</strong>ã€‚é¦–å…ˆï¼Œå†…æ ¸çŸ¥é“æ‰€æœ‰çš„æ€»çº¿éƒ½åº”è¯¥æ”¾åœ¨ <code>/sys/bus/</code> è¿™ä¸ªæ€»çº¿ç›®å½•ä¸‹ï¼Œç„¶åå†…æ ¸è¯»å–åˆ°å®šä¹‰çš„ <code>.name</code> æ˜¯ <code>"platform"</code>ï¼Œäºæ˜¯å†…æ ¸å°±åœ¨ <code>/sys/bus/</code> ä¸‹åˆ›å»ºäº†ä¸€ä¸ªåä¸º <code>platform</code> çš„æ–‡ä»¶å¤¹ï¼Œè¿™å°±æ˜¯<code>platform</code>è¿™ä¸ªæ–‡ä»¶å¤¹æ¥æºã€‚å¦‚æœæŠŠ<code>.name</code> èµ‹å€¼ä¸ºåˆ«çš„å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆ<code>/sys/bus/</code>ç›®å½•ä¸‹çš„æ–‡ä»¶å¤¹åç§°ä¹Ÿä¼šæ”¹å˜ã€‚</p>
<p>è¿˜æœ‰ä¸€ç‚¹ï¼ŒSysfs ä¸­çš„å†…å®¹å®Œå…¨åœ¨å†…å­˜ä¸­ç”Ÿæˆï¼Œä¸å ç”¨ç£ç›˜ç©ºé—´ï¼Œç³»ç»Ÿé‡å¯åå°†ä¼šé‡æ–°ç”Ÿæˆã€‚</p>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œä¹Ÿå°±æ˜¯è¯´<strong>å¹³å°æ€»çº¿åˆå§‹åŒ–</strong>æ—¶è®¾ç½® <code>.name = "platform"</code>ï¼Œå†…æ ¸æœ€ç»ˆä¼šè‡ªåŠ¨åˆ›å»ºç›®å½• <code>/sys/bus/platform/</code>ï¼Œè¿™ä¾¿æ˜¯ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´äº¤äº’çš„ä¸€ä¸ªçª—å£ï¼Œä¹Ÿæ˜¯ <code>struct bus_type</code>ç»“æ„ä½“ä¸­<code>const char *name</code>è¿™ä¸ªæˆå‘˜å­˜åœ¨çš„æ„ä¹‰ã€‚</p>
<h3 data-id="heading-3">1.2 match å›è°ƒå‡½æ•°</h3>
<p>æˆ‘ä»¬å†æ¥çœ‹<code>struct bus_type</code>ç»“æ„ä½“é‚£å¼ æˆªå›¾çš„ç¬¬ 130 è¡Œï¼Œè¿™æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œå®ƒæŒ‡å‘äº†å…·ä½“çš„åŒ¹é…ç®—æ³•ã€‚å¦‚æœè¯´<code>name</code>å†³å®šäº†æ€»çº¿çš„ç›®å½•åï¼Œé‚£ä¹ˆ<code>match</code>å°±å†³å®šäº†æ€»çº¿çš„å·¥ä½œé€»è¾‘ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">int</span> (*match)(<span class="hljs-keyword">struct</span> device *dev, <span class="hljs-keyword">struct</span> device_driver *drv);
</code></pre>
<p>å®ƒæ˜¯æ€»çº¿é©±åŠ¨ä¸­æœ€æ ¸å¿ƒï¼Œæœ€ç¹å¿™çš„æˆå‘˜ã€‚æ¯å½“æœ‰<strong>æ–°è®¾å¤‡</strong>æˆ–<strong>æ–°é©±åŠ¨</strong>æ³¨å†Œåˆ°è¿™æ¡æ€»çº¿ä¸Šæ—¶ï¼Œå†…æ ¸éƒ½ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå†…æ ¸ä¼šæ‹¿ç€<strong>æ–°è®¾å¤‡</strong>å»éå†<strong>å·²æœ‰çš„é©±åŠ¨é“¾è¡¨</strong>ï¼Œæˆ–è€…æ‹¿ç€<strong>æ–°é©±åŠ¨</strong>å»éå†<strong>å·²æœ‰çš„è®¾å¤‡é“¾è¡¨</strong>ï¼Œä¸€æ¬¡æ¬¡è°ƒç”¨ <code>match(dev, drv)</code>ã€‚å¯¹äº<strong>å¹³å°æ€»çº¿</strong>ï¼Œè¿™é‡Œçš„ <code>match</code> å‡½æ•°é€»è¾‘å°±æ˜¯ä¼˜å…ˆæ¯”è¾ƒè®¾å¤‡æ ‘ä¸­çš„ <code>compatible</code> å±æ€§ï¼Œå¦‚æœæ²¡æœ‰è®¾å¤‡æ ‘ï¼Œå°±æ¯”è¾ƒ <code>.name</code> å­—æ®µã€‚</p>
<p>ä½†æ˜¯å®é™…ä¸Šï¼ŒLinux å†…æ ¸ä¸­æœ‰ç€å„ç§å„æ ·çš„æ€»çº¿ï¼Œæ¯”å¦‚ USB ï¼ŒI2Cï¼ŒSPIï¼ŒPlatform ç­‰ç­‰ï¼Œè€Œ<strong>æ¯ç§æ€»çº¿çš„åŒ¹é…è§„åˆ™åˆæ˜¯ä¸ä¸€æ ·</strong>çš„ï¼Œæ¯”å¦‚ I2C æ€»çº¿å¯èƒ½çœ‹è®¾å¤‡åå­—ï¼Œè€Œ Platform æ€»çº¿çœ‹çš„æ˜¯è®¾å¤‡æ ‘é‡Œé¢çš„ <code>compatible</code> å±æ€§ã€‚å†…æ ¸ä¸ºäº†ç»Ÿä¸€ç®¡ç†ï¼Œå°±åœ¨ <code>bus_type</code> é‡Œé¢„ç•™äº†è¿™ä¸ª <code>match</code> æ¥å£ï¼Œå…·ä½“çš„åŒ¹é…é€»è¾‘ï¼Œç”±å„ç§æ€»çº¿é©±åŠ¨è‡ªå·±å»å®ç°ã€‚</p>
<p>ä¸Šé¢è®²å®Œäº†åŒ¹é…é€»è¾‘ï¼Œä¸‹æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªåŒ¹é…æœºåˆ¶æœ¬èº«ï¼Œè¿™ä¸ªåŒ¹é…åœ¨ä¸¤ç§æƒ…å†µä¸‹ä¼šè‡ªåŠ¨è§¦å‘ã€‚</p>
<p>ç¬¬ä¸€ç§æƒ…å†µæ˜¯æ·»åŠ æ–°è®¾å¤‡ï¼Œå½“å†…æ ¸è§£æè®¾å¤‡æ ‘ï¼Œæˆ–è€…æœ‰ä¸€ä¸ª USB è®¾å¤‡æ’å…¥æ—¶ï¼Œç³»ç»Ÿä¼šæ³¨å†Œä¸€ä¸ªæ–°çš„ deviceï¼Œæ­¤æ—¶ï¼Œè¿™ä¸ªè®¾å¤‡æ³¨å†Œçš„<strong>æ€»çº¿</strong>å°±ä¼šæ‹¿ç€è¿™ä¸ªæ–°è®¾å¤‡å»éå†è‡ªå·±çš„<strong>é©±åŠ¨é“¾è¡¨</strong>ï¼Œè¿™è®©æˆ‘æƒ³èµ·äº†ç”µå½±ç‰§é©¬äººä¸­çš„é‚£å¥ç»å…¸å°è¯ â€œè€è®¸ï¼Œä½ è¦è€å©†ä¸è¦ï¼Ÿâ€ ã€‚è¿™ä¸ªåŒ¹é…è¿‡ç¨‹å’Œç”µå½±ä¸­çš„åœºæ™¯ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œæ€»çº¿æ‹¿ç€æ–°è®¾å¤‡å»é—®é©±åŠ¨é“¾è¡¨é‡Œé¢çš„æ¯ä¸€ä¸ªé©±åŠ¨ï¼Œä¸€ä¸ªä¸€ä¸ªé—®ä»–ä»¬è¦ä¸è¦è¿™ä¸ªæ–°è®¾å¤‡ï¼Œæ¯é—®ä¸€æ¬¡å°±ç›¸å½“äºè°ƒç”¨ä¸€æ¬¡<code>match</code>å‡½æ•°è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœä¸¤ä¸ªäººæ²¡çœ‹å¯¹çœ¼ï¼Œé‚£åŒ¹é…å°±å¤±è´¥äº†ï¼Œç»§ç»­é—®ä¸‹ä¸€ä¸ªï¼Œå¦‚æœä¸¤äººçœ‹å¯¹çœ¼äº†ï¼Œé‚£å°±åŒ¹é…æˆåŠŸã€‚</p>
<p>ç¬¬äºŒç§æƒ…å†µæ·»åŠ æ–°é©±åŠ¨ï¼Œå½“æ‰§è¡Œ<code>insmod</code>åŠ è½½ä¸€ä¸ªé©±åŠ¨æ¨¡å—æ—¶ï¼Œç³»ç»Ÿä¼šæ³¨å†Œä¸€ä¸ªæ–°çš„ driver ï¼Œæ­¤æ—¶ï¼Œæ€»çº¿ä¼šå¸¦ç€æ–°é©±åŠ¨å»éå†è®¾å¤‡é“¾è¡¨ï¼Œä¸€ä¸ªä¸€ä¸ªé—®ï¼Œç›´åˆ°åŒ¹é…æˆåŠŸæˆ–è€…éå†å®Œæ¯•ã€‚</p>
<p>è¿™ä¸¤ç§æƒ…å†µçœ‹èµ·æ¥ç›¸ä¼¼åº¦å¾ˆé«˜ï¼Œä½†è¿˜æ˜¯æœ‰ä¸€ç‚¹ä¸ä¸€æ ·çš„ï¼Œå°±æ˜¯ä¸€ä¸ªé©±åŠ¨æ¨¡å—å¯ä»¥é©±åŠ¨å¤šä¸ªè®¾å¤‡ï¼Œä½†æ˜¯ä¸€ä¸ªè®¾å¤‡å´åªèƒ½æœ‰ä¸€ä¸ªé©±åŠ¨æ¨¡å—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ·»åŠ æ–°è®¾å¤‡é‚£ç§æƒ…å†µä¸‹ï¼Œæ€»çº¿ä¸ä»…ä¼šå»é—®æ²¡æœ‰é…å¯¹çš„é©±åŠ¨ï¼Œè¿˜ä¼šå»é—®å·²ç»é…å¯¹å¥½çš„é©±åŠ¨ï¼Œè¿™æ„å‘³ç€<strong>ä¸€ä¸ªé©±åŠ¨ç¨‹åºå¯ä»¥åŒæ—¶æœåŠ¡äºå¤šä¸ªåŒç±»å‹çš„è®¾å¤‡å®ä¾‹</strong>ã€‚è€Œåœ¨æ·»åŠ æ–°é©±åŠ¨çš„æƒ…å†µä¸‹ï¼Œæ€»çº¿åªä¼šå»é—®æ²¡æœ‰é…å¯¹å¥½çš„è®¾å¤‡ï¼Œå·²ç»é…å¯¹å¥½çš„è®¾å¤‡å®ƒæ˜¯ä¸ä¼šå»é—®çš„ã€‚</p>
<p>ä¸ºäº†èƒ½å¤Ÿæ·±å…¥ç†è§£è¿™ä¸ªåŒ¹é…é€»è¾‘ï¼Œæˆ‘ä»¬ä¾ç„¶åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œæ‰¾åˆ°å¹³å°æ€»çº¿çš„åŒ¹é…é€»è¾‘ï¼Œå®ƒè¯¦ç»†æè¿°äº†å¹³å°æ€»çº¿æ˜¯å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªè®¾å¤‡å’Œä¸€ä¸ªé©±åŠ¨èƒ½å¦çœ‹å¯¹çœ¼çš„ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/kernel/drivers/base/platform.c
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ea2d03fab815462db5f1d192159c0e85~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGxwNjY2aHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768139212&amp;x-signature=Nl%2BB0h%2FfXvz22jzXjH%2Bm4R%2B6t2Y%3D" alt="5. matchæºç .png" loading="lazy"/></p>
<p>ä»æºç ä¸­æˆ‘ä»¬å¯ä»¥æ¸…æ™°åœ°çœ‹åˆ°ï¼ŒLinux è®¾è®¡äº†ä¸€å¥—ä¸¥å¯†çš„ã€å…·æœ‰ä¼˜å…ˆçº§çš„åŒ¹é…æµç¨‹ï¼Œåªè¦æ»¡è¶³å…¶ä¸­ä»»ä½•ä¸€ä¸ªæ¡ä»¶ï¼Œå°±å¯ä»¥è®¤ä¸ºåŒ¹é…æˆåŠŸã€‚</p>
<p>è¿™ä¸ªå‡½æ•°ä¼ å…¥çš„å‚æ•°æ˜¯é€šç”¨çš„ <code>struct device</code> å’Œ <code>struct device_driver</code>ï¼Œå‡½æ•°çš„ç¬¬ä¸€æ­¥æ˜¯é€šè¿‡å®å°†å®ƒä»¬è¿˜åŸæˆ<strong>å¹³å°è®¾å¤‡</strong>å’Œ<strong>å¹³å°é©±åŠ¨</strong> ï¼Œä»¥ä¾¿è®¿é—®å¹³å°ç‰¹æœ‰çš„å±æ€§ã€‚</p>
<p>ç„¶åæˆ‘ä»¬çœ‹ 994 å’Œ 995 è¡Œï¼Œè¿™æ˜¯æœ€é«˜ä¼˜å…ˆçº§çš„åŒ¹é…è§„åˆ™ï¼Œå¦‚æœåœ¨ç”¨æˆ·ç©ºé—´é€šè¿‡ sysfs ä¿®æ”¹äº†è®¾å¤‡çš„ <code>driver_override</code> å±æ€§ï¼Œå¼ºåˆ¶æŒ‡å®šäº†æŸä¸ªé©±åŠ¨åå­—ï¼Œå†…æ ¸å°±ä¼šå¿½ç•¥åé¢æ‰€æœ‰çš„è§„åˆ™ï¼Œåªçœ‹åå­—å¯¹ä¸å¯¹ï¼Œè¿™é€šå¸¸ç”¨äºè°ƒè¯•ã€‚</p>
<p>å†æ¥çœ‹ 998 å’Œ 999 è¡Œï¼Œè¿™æ˜¯<strong>åµŒå…¥å¼ Linux å¼€å‘ä¸­æœ€å¸¸ç”¨</strong>çš„åŒ¹é…æ–¹å¼ï¼Œ<strong>OF</strong> æŒ‡çš„æ˜¯ <strong>Open Firmware</strong>ï¼Œåœ¨ Linux ä¸­æŒ‡ä»£è®¾å¤‡æ ‘ã€‚å‡½æ•°å†…éƒ¨ä¼šè¿›è¡Œå¯¹æ¯”ï¼Œ<strong>é©±åŠ¨ä¸­</strong><code>driver-&gt;of_match_table</code> ä¸­çš„ <code>compatible</code> å­—ç¬¦ä¸²å’Œ<strong>è®¾å¤‡æ ‘ä¸­</strong>èŠ‚ç‚¹çš„ <code>compatible</code> å±æ€§ã€‚å¦‚æœä¸¤è€…ä¸€è‡´ï¼Œé‚£å°±åŒ¹é…æˆåŠŸã€‚</p>
<p>å†å¾€ä¸‹çœ‹ 1002 å’Œ 1003 è¡Œï¼Œè¿™æ˜¯ <strong>ACPI åŒ¹é…</strong>ï¼Œä¸»è¦ç”¨äº x86 æ¶æ„ï¼Œåœ¨ ARM åµŒå…¥å¼è®¾å¤‡ä¸­å¾ˆå°‘ç”¨åˆ°ã€‚</p>
<p>ç„¶åæ˜¯ 1006 å’Œ 1007 è¡Œçš„ <strong>ID è¡¨åŒ¹é…</strong>ï¼Œåœ¨è®¾å¤‡æ ‘æµè¡Œä¹‹å‰ï¼Œé€šå¸¸ç”¨çš„æ˜¯è¿™ç§åŒ¹é…æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•åœ¨é©±åŠ¨é‡Œä¼šå®šä¹‰ä¸€ä¸ª <code>id_table</code> æ•°ç»„ï¼Œé‡Œé¢åˆ—å‡ºäº†ä¸€å †æ”¯æŒçš„è®¾å¤‡åï¼Œå†…æ ¸ä¼šæ‹¿<strong>å½“å‰è®¾å¤‡çš„åå­—</strong>ï¼Œå»è¿™ä¸ªåˆ—è¡¨é‡Œä¸€ä¸ªä¸ªæŸ¥ï¼Œå¦‚æœæŸ¥åˆ°äº†ï¼Œå°±åŒ¹é…æˆåŠŸã€‚</p>
<p>æœ€å 1010 è¡Œæ˜¯<strong>åå­—åŒ¹é…</strong>ï¼Œè¿™æ˜¯æœ€åçš„æ‰‹æ®µï¼Œå¦‚æœå‰é¢çš„åŒ¹é…æ–¹æ³•éƒ½å¤±è´¥äº†ï¼Œå†…æ ¸ä¼šç®€å•ç²—æš´çš„æ¯”è¾ƒè®¾å¤‡çš„åå­—<code>device.name</code>å’Œé©±åŠ¨çš„åå­—<code>driver.name</code>æ˜¯å¦ä¸€æ ·ï¼Œå¦‚æœä¸€æ ·ï¼Œé‚£å°±åŒ¹é…æˆåŠŸã€‚</p>
<p>ä¸Šé¢ä»‹ç»çš„åŒ¹é…æœºåˆ¶ä¸­ï¼Œ<code>of_driver_match_device</code> çš„ä¼˜å…ˆçº§æ˜¯æœ€é«˜çš„ï¼ˆåœ¨æ²¡æœ‰ <code>driver_override</code> çš„æƒ…å†µä¸‹ï¼‰ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨è®¾å¤‡æ ‘é‡Œå†™ <code>compatible</code> å°±èƒ½åŒ¹é…ä¸Šçš„åŸå› ã€‚</p>
<h3 data-id="heading-4">1.3 çƒ­æ’æ‹”æœºåˆ¶ uevent</h3>
<p>å†æ¥çœ‹<code>struct bus_type</code>ç»“æ„ä½“é‚£å¼ æˆªå›¾çš„ç¬¬ 131 è¡Œï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">int</span> (*uevent)(<span class="hljs-keyword">struct</span> device *dev, <span class="hljs-keyword">struct</span> kobj_uevent_env *env);
</code></pre>
<p>è¿™ä¸ªå‡½æ•°æˆ‘ä»¬åœ¨å†™ç®€å•çš„é©±åŠ¨æ—¶å¾ˆå°‘ç›´æ¥å»ä¿®æ”¹å®ƒï¼Œä½†å®ƒåœ¨ Linux ç³»ç»Ÿä¸­æ‰®æ¼”ç€è‡³å…³é‡è¦çš„è§’è‰²ï¼Œå®ƒæ˜¯<strong>å†…æ ¸ç©ºé—´</strong>å‘<strong>ç”¨æˆ·ç©ºé—´</strong>ä¼ é€’ä¿¡æ¯çš„å·¥å…·ã€‚</p>
<p>å½“æ€»çº¿ä¸Šå‘ç”Ÿè®¾å¤‡æ·»åŠ æˆ–ç§»é™¤ç­‰äº‹ä»¶æ—¶ï¼Œå†…æ ¸å°±ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå®ƒçš„ä¸»è¦ä»»åŠ¡æ˜¯æ•´ç†å¥½å…³äºè¿™ä¸ªè®¾å¤‡çš„ä¿¡æ¯ï¼Œå¹¶æ‰“åŒ…æˆä¸€ç»„<strong>ç¯å¢ƒå˜é‡</strong> ï¼Œç„¶åé€šè¿‡ Netlink å¹¿æ’­å‘é€ç»™ç”¨æˆ·ç©ºé—´ã€‚</p>
<p>è€Œåœ¨ç”¨æˆ·ç©ºé—´ï¼Œé€šå¸¸æœ‰ä¸€ä¸ª<strong>å®ˆæŠ¤è¿›ç¨‹</strong>ï¼ˆæ¯”å¦‚ <strong>udev</strong> æˆ–åµŒå…¥å¼ç³»ç»Ÿä¸­å¸¸è§çš„ <strong>mdev</strong>ï¼‰åœ¨æ—¶åˆ»ç›‘å¬è¿™äº›æ¶ˆæ¯ã€‚</p>
<p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œå½“æŠŠä¸€ä¸ª USB é¼ æ ‡æ’åˆ°ç”µè„‘ä¸Šæ—¶ï¼ŒUSB æ€»çº¿æ£€æµ‹åˆ°ç¡¬ä»¶æ’å…¥ï¼Œä¼šç”Ÿæˆä¸€ä¸ªè®¾å¤‡ç»“æ„ä½“ï¼Œç„¶åå†…æ ¸è°ƒç”¨ USB æ€»çº¿çš„ <code>uevent</code> å‡½æ•°ï¼Œæ‰“åŒ…å¥½ â€œ è¿™æ˜¯ä¸€ä¸ª USB é¼ æ ‡ â€ è¿™æ¡ä¿¡æ¯å¹¶å‘å‡ºå»ï¼Œç”¨æˆ·ç©ºé—´çš„ <code>udev</code> æ”¶åˆ°ä¿¡å·ï¼Œä¼šæ ¹æ®è§„åˆ™è‡ªåŠ¨åŠ è½½å¯¹åº”çš„é©±åŠ¨æ¨¡å—ï¼Œå¹¶åœ¨ <code>/dev/</code> ç›®å½•ä¸‹è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª <code>mouse0</code> çš„è®¾å¤‡èŠ‚ç‚¹ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨ Linux ä¸­æ’å…¥ç¡¬ä»¶å°±èƒ½è‡ªåŠ¨è¯†åˆ«ã€è‡ªåŠ¨åŠ è½½é©±åŠ¨å¹¶è‡ªåŠ¨ç”Ÿæˆè®¾å¤‡èŠ‚ç‚¹çš„åŸå› ï¼ŒèƒŒåå°±æ˜¯ <code>uevent</code> æœºåˆ¶åœ¨é»˜é»˜å·¥ä½œã€‚å¯¹äºå¹³å°æ€»çº¿ï¼Œå®ƒä¹Ÿä¼šåˆ©ç”¨è¿™ä¸ªæœºåˆ¶ï¼Œè®©ç³»ç»Ÿèƒ½<strong>è‡ªåŠ¨è¯†åˆ«è®¾å¤‡æ ‘ä¸­å®šä¹‰çš„èŠ‚ç‚¹å¹¶åŠ è½½å¯¹åº”çš„é©±åŠ¨</strong>ã€‚</p>
<h3 data-id="heading-5">1.4 probe å‡½æ•°</h3>
<p>æ¥çœ‹<code>struct bus_type</code>ç»“æ„ä½“é‚£å¼ æˆªå›¾çš„ç¬¬ 132 è¡Œï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">int</span> (*probe)(<span class="hljs-keyword">struct</span> device *dev);
</code></pre>
<p>è¿™æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œå®ƒä»£è¡¨äº†<strong>æ€»çº¿çš„åˆå§‹åŒ–å…¥å£</strong>ã€‚å½“ <code>match</code> å‡½æ•°åŒ¹é…æˆåŠŸåï¼Œå†…æ ¸çš„é©±åŠ¨æ ¸å¿ƒå±‚å°±ä¼šè¯•å›¾è®©é©±åŠ¨ç¨‹åºæ¥ç®¡è®¾å¤‡ã€‚è¿™æ—¶ï¼Œå†…æ ¸ä¼šéµå¾ªä¸‹é¢çš„è°ƒç”¨è§„åˆ™ï¼š</p>
<p>å†…æ ¸é¦–å…ˆæ£€æŸ¥ <code>bus_type-&gt;probe</code> æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œå†…æ ¸ä¼šè°ƒç”¨æ€»çº¿çš„ <code>probe</code> å‡½æ•°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ€»çº¿é©±åŠ¨é€šå¸¸ä¼šæ‰§è¡Œä¸€äº›è¯¥æ€»çº¿ç‰¹æœ‰çš„å…¬å…±åˆå§‹åŒ–æ“ä½œï¼ˆæ¯”å¦‚å¼€å¯æ€»çº¿æ—¶é’Ÿå’Œç”µæºç®¡ç†ç­‰æ“ä½œï¼‰ï¼Œç„¶åå†ç”±<strong>æ€»çº¿é©±åŠ¨</strong>å»è°ƒç”¨<strong>è®¾å¤‡é©±åŠ¨</strong>é‡Œçš„ <code>probe</code> å‡½æ•°ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œå†…æ ¸ä¼šè·³è¿‡æ€»çº¿å±‚ï¼Œç›´æ¥è°ƒç”¨<strong>è®¾å¤‡é©±åŠ¨</strong>é‡Œçš„ <code>probe</code> å‡½æ•°ã€‚</p>
<p>å¯¹äºæˆ‘ä»¬å¸¸ç”¨çš„ <strong>Platform æ€»çº¿</strong>ï¼Œå®ƒé€šå¸¸ä¸å®šä¹‰æ€»çº¿çº§åˆ«çš„ <code>probe</code>ï¼ˆæˆ–è€…ä»…ä»…ç”¨å®ƒå®ç°ç®€å•çš„é€ä¼ ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å†™é©±åŠ¨æ—¶ï¼Œåªéœ€è¦å…³æ³¨è‡ªå·±å†™çš„é©±åŠ¨ç»“æ„ä½“é‡Œçš„ <code>probe</code> å³å¯ã€‚ä½†æ˜¯æˆ‘ä»¬è¦æ˜ç™½ï¼Œè°ƒç”¨æ ˆä¼šå…ˆç»è¿‡æ€»çº¿å±‚ï¼Œç„¶åæ‰è¿›è¡Œåé¢çš„æ“ä½œçš„ã€‚</p>
<h3 data-id="heading-6">1.5 ç§æœ‰æ•°æ®</h3>
<p><code>struct bus_type</code>ç»“æ„ä½“é‚£å¼ æˆªå›¾çš„ç¬¬ 151 è¡Œï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">subsys_private</span> *<span class="hljs-title">p</span>;</span>
</code></pre>
<p>ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰æƒ³è¿‡ä¸€ä¸ªé—®é¢˜ï¼Œå‰é¢æˆ‘ä»¬è®²åˆ°æ€»çº¿é©±åŠ¨ç®¡ç†ç€ä¸¤ä¸ªé‡è¦çš„é“¾è¡¨ï¼Œä¸€ä¸ªæ˜¯è®¾å¤‡é“¾è¡¨ï¼Œå¦ä¸€ä¸ªæ˜¯é©±åŠ¨é“¾è¡¨ï¼Œé‚£è¿™ä¸¤ä¸ªé“¾è¡¨åˆ°åº•åœ¨å“ªå‘¢ï¼Ÿ</p>
<p>å…¶å®ï¼ŒLinux å†…æ ¸ä¸ºäº†å°è£…æ€§ï¼ŒæŠŠçœŸæ­£çš„æ•°æ®é“¾è¡¨è—åœ¨äº†è¿™ä¸ª <code>subsys_private</code> ç»“æ„ä½“é‡Œï¼Œä½†<code>struct subsys_private</code> è¿™ä¸ªç»“æ„ä½“çš„å®šä¹‰ä¸åœ¨å…¬å¼€çš„å¤´æ–‡ä»¶ <code>include/linux/device.h</code> é‡Œï¼Œè€Œæ˜¯è—åœ¨ä¸€ä¸ªç§æœ‰çš„å¤´æ–‡ä»¶ <code>drivers/base/base.h</code> ä¸­ï¼Œè¿™æ„å‘³ç€æ™®é€šé©±åŠ¨å¼€å‘è€…æ ¹æœ¬ä¸éœ€è¦å»ç›´æ¥è®¿é—®å®ƒã€‚æˆ‘æŠŠè¿™éƒ¨åˆ†çš„æºç æˆªå›¾è¿‡æ¥äº†ï¼Œå¤§å®¶è¯·çœ‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef6b9d7cc5994ed09bfb99de5d23b227~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGxwNjY2aHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768139212&amp;x-signature=5NpIXrPvDkdMjkKpAUVrRovophE%3D" alt="6. ä¸¤ä¸ªé“¾è¡¨çš„çœŸå®ä½ç½®.png" loading="lazy"/></p>
<p>è¯·çœ‹ç¬¬ 36 å’Œ 37 ä¸¤è¡Œï¼Œä»–ä»¬åˆ†åˆ«å°±æ˜¯<strong>è®¾å¤‡é“¾è¡¨</strong>å’Œ<strong>é©±åŠ¨é“¾è¡¨</strong>ã€‚</p>
<p>é‚£ä¹ˆä¸ºä»€ä¹ˆè¦æŠŠè¿™ä¸¤ä¸ªé“¾è¡¨è—çš„è¿™ä¹ˆæ·±å‘¢ï¼Ÿè¿™å…¶å®æ˜¯ä¸ºäº†<strong>å®‰å…¨</strong>å’Œ<strong>ç¨³å®š</strong>ã€‚å†™å†…æ ¸çš„äºº<strong>ä¸å¸Œæœ›</strong>ç¼–å†™é©±åŠ¨æ—¶èƒ½ç›´æ¥å»æ“ä½œè¿™ä¸¤ä¸ªé“¾è¡¨ï¼ˆæ¯”å¦‚æ‰‹åŠ¨éå†é“¾è¡¨ã€æ‰‹åŠ¨æ’å…¥èŠ‚ç‚¹ï¼‰ï¼Œå› ä¸ºè¿™ç§ç›´æ¥æ“ä½œæ˜¯éå¸¸å±é™©çš„ï¼Œå®¹æ˜“å¯¼è‡´å¹¶å‘ç«äº‰æˆ–é“¾è¡¨æŸåã€‚ä»–å¸Œæœ›é€šè¿‡æ ‡å‡†çš„ API æ¥é—´æ¥æ“ä½œè¿™äº›é“¾è¡¨ï¼Œè¿™äº› API å†…éƒ¨ä¼šå¤„ç†å¥½é”ã€å¼•ç”¨è®¡æ•°ç­‰å¤æ‚çš„ç»†èŠ‚ï¼Œä»è€Œä¿è¯æ“ä½œçš„å®‰å…¨æ€§ã€‚</p>
<h2 data-id="heading-7">2 è®¾å¤‡</h2>
<p>åœ¨å†…æ ¸ä¸­ï¼Œè®¾å¤‡ç”± <code>struct device</code> ç»“æ„ä½“è¡¨ç¤ºã€‚è¿™é‡Œæ˜¯å°†ä¸€ä¸ªå…·ä½“çš„ç¡¬ä»¶è®¾å¤‡çš„ç‰©ç†å±æ€§æŠ½è±¡ä¸ºä¸€ä¸ªç»“æ„ä½“ï¼Œä¸»è¦æ˜¯ä¸ºäº†å‘å†…æ ¸æè¿°<strong>ç¡¬ä»¶éƒ½æœ‰ä»€ä¹ˆ</strong>ã€‚</p>
<p>è¿™ä¸ªç»“æ„ä½“é‡Œé¢åŒ…å«ç€è®¾å¤‡åç§°ã€æ€»çº¿ ID å’Œè®¾å¤‡æ ‘ä¸­çš„ <code>compatible</code> å±æ€§ï¼Œç”¨äºåŒ¹é…é©±åŠ¨ï¼Œè¿˜åŒ…å«è®¾å¤‡å ç”¨çš„ç‰©ç†åœ°å€ã€ä¸­æ–­å·ã€æ—¶é’Ÿç­‰èµ„æºä¿¡æ¯ã€‚</p>
<p>åœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯¹äºå¹³å°è®¾å¤‡ï¼Œè¿™äº›è®¾å¤‡å¯¹è±¡é€šå¸¸ä¸éœ€è¦æˆ‘ä»¬è‡ªå·±åœ¨ C ä»£ç ä¸­å®šä¹‰ï¼Œè€Œæ˜¯ç”±å†…æ ¸åœ¨å¯åŠ¨æ—¶è§£æ<strong>è®¾å¤‡æ ‘</strong>è‡ªåŠ¨ç”Ÿæˆå¹¶æ³¨å†Œåˆ°ç›¸åº”çš„æ€»çº¿ä¸Šã€‚</p>
<p>åœ¨ Linux å†…æ ¸ä¸­ï¼Œå¯¹äºè®¾å¤‡çš„æè¿°é‡‡ç”¨äº†<strong>åŸºç±» + å­ç±»</strong>çš„é¢å‘å¯¹è±¡è®¾è®¡æ€æƒ³ã€‚</p>
<h3 data-id="heading-8">2.1 é€šç”¨è®¾å¤‡åŸºç±»ï¼šstruct device</h3>
<p>æ— è®ºæ˜¯ USB é¼ æ ‡ã€I2C ä¼ æ„Ÿå™¨ï¼Œè¿˜æ˜¯ SoC å†…éƒ¨çš„ GPIO ï¼Œåœ¨å†…æ ¸çœ¼é‡Œï¼Œé¦–å…ˆä»–ä»¬éƒ½æ˜¯ä¸€ä¸ª <code>struct device</code>ã€‚è¿™æ˜¯ Linux è®¾å¤‡æ¨¡å‹ä¸­<strong>æœ€åŸºç¡€</strong>çš„æ•°æ®ç»“æ„ã€‚</p>
<p><code>struct device</code>ç»“æ„ä½“çš„å†…æ ¸æºç ç›®å½•å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/kernel/include/linux/device.h
</code></pre>
<p>æºç æˆªå›¾å¦‚ä¸‹ï¼Œç”±äºè¿™ä¸ªç»“æ„ä½“æ¯”è¾ƒé•¿ï¼Œæˆ‘åªæˆªå–äº†åŒ…å«æˆ‘ä»¬éœ€è¦äº†è§£çš„æˆå‘˜çš„éƒ¨åˆ†å†…å®¹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/27ba5b9c919a4fdebf224543b8d4302b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGxwNjY2aHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768139212&amp;x-signature=6gHnFfuJOxkh%2Ba4YrBFXPpKlHnk%3D" alt="7. deviceæºç ï¼ˆ1ï¼‰.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9af3a42f9f9d4f439d2e4b72fc7752d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGxwNjY2aHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768139212&amp;x-signature=8WiBNebVoSG01SSNq86pw79KnHc%3D" alt="8. deviceæºç ï¼ˆ2ï¼‰.png" loading="lazy"/></p>
<p><strong>å…ˆæ¥çœ‹ 1032 è¡Œï¼š</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">device</span> *<span class="hljs-title">parent</span>;</span>
</code></pre>
<p>è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘è®¾å¤‡çš„çˆ¶è®¾å¤‡ï¼Œå®ƒæ˜¯æ„å»ºæ•´ä¸ªç³»ç»Ÿè®¾å¤‡æ ‘çš„å…³é”®ï¼ŒLinux çš„è®¾å¤‡ä¸æ˜¯å­¤ç«‹çš„ï¼Œè€Œæ˜¯æœ‰å±‚æ¬¡å…³ç³»çš„ï¼Œæ¯”å¦‚ SoC ä¸Šçš„ UART æ§åˆ¶å™¨æ˜¯ <code>platform bus</code> çš„å­è®¾å¤‡ï¼Œè€Œ UART æ§åˆ¶å™¨<strong>ä¸‹é¢çš„ä¸²å£è®¾å¤‡</strong>åˆæ˜¯å®ƒçš„å­è®¾å¤‡ã€‚æ­£æ˜¯å› ä¸ºè¿™ä¸ª <code>parent</code> æŒ‡é’ˆï¼Œå†…æ ¸æ‰èƒ½åœ¨ <code>/sys/devices/</code> ä¸‹æ„å»ºå‡ºçœŸå®çš„ç¡¬ä»¶æ‹“æ‰‘ç»“æ„ã€‚è¿™æ•´ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œå°±æ˜¯ç”±æ— æ•° <code>struct device</code> çš„ <code>parent</code> æŒ‡é’ˆä¸²è”èµ·æ¥çš„ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/219f2f1fd9de4b22b0220c5ce80554e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGxwNjY2aHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768139212&amp;x-signature=soB7924bWNUbWpzyeGhHgFDyYQY%3D" alt="9. æ‹“æ‰‘ç»“æ„.png" loading="lazy"/></p>
<p>1034 è¡Œçš„ç§æœ‰ç»“æ„ä½“æ­£æ˜¯ä¸Šä¸€èŠ‚æåˆ°çš„å­˜æ”¾è®¾å¤‡é“¾è¡¨å’Œé©±åŠ¨é“¾è¡¨çš„åœ°æ–¹ã€‚</p>
<p><strong>å†æ¥çœ‹ 1036 è¡Œï¼š</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">kobject</span> <span class="hljs-title">kobj</span>;</span>
</code></pre>
<p>è¿™æ˜¯ Linux é©±åŠ¨æ¨¡å‹ä¸­æœ€åº•å±‚çš„å•å…ƒï¼Œæ¯ä¸€ä¸ª <code>kobject</code> éƒ½å¯¹åº” Sysfs æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ä¸ª<strong>ç›®å½•</strong>ï¼Œæ­£æ˜¯å› ä¸º <code>struct device</code> é‡ŒåŒ…å«äº†å®ƒï¼Œæˆ‘ä»¬æ‰èƒ½åœ¨ <code>/sys/devices/</code> ä¸‹çœ‹åˆ°å„ç§è®¾å¤‡çš„æ–‡ä»¶å¤¹ã€‚</p>
<p><strong>1044 è¡Œï¼š</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bus_type</span> *<span class="hljs-title">bus</span>;</span>
</code></pre>
<p>è®¾å¤‡æ³¨å†Œæ—¶ï¼Œå†…æ ¸ä¼šæ ¹æ®è¿™ä¸ªæŒ‡é’ˆï¼ŒæŠŠè®¾å¤‡æŒ‚è½½åˆ°å¯¹åº”æ€»çº¿çš„è®¾å¤‡é“¾è¡¨ä¸Šå»ã€‚</p>
<p><strong>1045 è¡Œï¼š</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">device_driver</span> *<span class="hljs-title">driver</span>;</span>
</code></pre>
<p>è¿™æ˜¯è®¾å¤‡å½“å‰ç»‘å®šçš„é©±åŠ¨æŒ‡é’ˆï¼Œå½“ <code>match</code> æˆåŠŸå¹¶ <code>probe</code> å®Œæˆåï¼Œå†…æ ¸å°±ä¼šæŠŠé©±åŠ¨æŒ‚åœ¨è¿™é‡Œï¼Œä»è¿™ä¸€åˆ»èµ·ï¼Œè®¾å¤‡å°±æ´»äº†ï¼Œé©±åŠ¨å°±æ˜¯ä»ç°åœ¨å¼€å§‹å¯ä»¥æ“ä½œç¡¬ä»¶çš„ã€‚</p>
<p><strong>1092 è¡Œï¼š</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">device_node</span> *<span class="hljs-title">of_node</span>;</span>
</code></pre>
<p>è¿™æ˜¯<strong>è¿æ¥è®¾å¤‡æ ‘ä¸è®¾å¤‡é©±åŠ¨æ¨¡å‹çš„å…³é”®</strong>ã€‚å½“å†…æ ¸è§£æè®¾å¤‡æ ‘æ—¶ï¼Œä¼šä¸ºæ¯ä¸ªèŠ‚ç‚¹ç”Ÿæˆä¸€ä¸ªè®¾å¤‡æ ‘èŠ‚ç‚¹ <code>device_node</code> ç»“æ„ä½“ï¼Œå½“éšååˆ›å»º <code>struct device</code> æ—¶ï¼Œè¿™ä¸ªæŒ‡é’ˆå°±ä¼šæŒ‡å‘å¯¹åº”çš„ <code>device_node</code>ã€‚é€šè¿‡å®ƒï¼Œé©±åŠ¨å¯ä»¥åœ¨ <code>probe()</code> ä¸­ç”¨ <code>of_match_device()</code> è·å– <code>compatible</code>ã€‚</p>
<h3 data-id="heading-9">2.2 å¹³å°è®¾å¤‡å­ç±» struct platform_device</h3>
<p>åœ¨åµŒå…¥å¼ Linux ä¸­ï¼Œæˆ‘ä»¬å¾ˆå°‘ç›´æ¥æ“ä½œ <code>struct device</code>ï¼Œè€Œæ˜¯ä½¿ç”¨å®ƒçš„å­ç±»ï¼Œä¹Ÿå°±æ˜¯<strong>å¹³å°è®¾å¤‡</strong> ã€‚</p>
<p>è¿™æ˜¯å› ä¸º Soc å†…éƒ¨çš„å¤–è®¾ï¼ˆå¦‚ GPIOã€UARTã€I2C ç­‰ï¼‰æ˜¯ç›´æ¥ä¾é™„äº CPU å†…å­˜ç©ºé—´çš„ï¼Œå®ƒä»¬æ²¡æœ‰åƒ USB é‚£æ ·å¤æ‚çš„ç‰©ç†æ€»çº¿åè®®ã€‚å› æ­¤ï¼ŒLinux è®¾è®¡äº† Platform æ€»çº¿ä½“ç³»ã€‚</p>
<p>å®ƒçš„æºç ä½ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/kernel/include/linux/platform_device.h
</code></pre>
<p>è¿™ä¸ªç»“æ„ä½“é•¿è¿™æ ·ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/556ea5f3de0b43408ed1f0a471a6bde8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGxwNjY2aHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768139212&amp;x-signature=rqnuRA3BUTmR4v%2F%2BKLVUAryarg0%3D" alt="10. å¹³å°è®¾å¤‡ç»“æ„ä½“.png" loading="lazy"/></p>
<p><strong>ç¬¬ 27 è¡Œï¼š</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">device</span> <span class="hljs-title">dev</span>;</span> 
</code></pre>
<p>åœ¨ C è¯­è¨€ä¸­ï¼ŒLinux å†…æ ¸é€šè¿‡<strong>åœ¨ä¸€ä¸ªç»“æ„ä½“ä¸­å†…åµŒå¦ä¸€ä¸ªç»“æ„ä½“</strong>æ¥å®ç°<strong>ç»§æ‰¿</strong>ã€‚</p>
<p><code>platform_device</code> <strong>åŒ…å«</strong>äº† <code>device</code>ï¼Œè¿™æ„å‘³ç€æ‹¥æœ‰äº† <code>platform_device</code>ï¼Œå°±å¤©ç„¶æ‹¥æœ‰äº† <code>device</code> çš„æ‰€æœ‰å±æ€§ï¼Œåœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸çœ‹åˆ° <code>&amp;pdev-&gt;dev</code> è¿™æ ·çš„å†™æ³•ï¼Œè¿™å…¶å®å°±æ˜¯åœ¨è®¿é—®åŸºç±»æˆå‘˜ã€‚</p>
<h3 data-id="heading-10">2.3 ç¡¬ä»¶èµ„æº</h3>
<p><code>struct platform_device</code> ä¸­è¿˜æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„æˆå‘˜ï¼Œå°±æ˜¯<code>struct resource *resource</code>ï¼Œåœ¨ä¸Šé¢é‚£å¼ ä»£ç æˆªå›¾çš„ç¬¬ 29 è¡Œã€‚</p>
<p>è¿™ä¸ªç»“æ„ä½“åœ¨ä¸‹é¢æ–‡ä»¶é‡Œé¢ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">kernel/include/linux/ioport.h
</code></pre>
<p>ä»£ç æˆªå›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e629c84cebde46d38ac118611d5026c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGxwNjY2aHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768139212&amp;x-signature=DuAgo8MAMA5e9vxxip8AALh%2BPNU%3D" alt="11. ç¡¬ä»¶ç»“æ„ä½“.png" loading="lazy"/></p>
<p>åœ¨æ²¡æœ‰è®¾å¤‡æ ‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ C ä»£ç ä¸­æ‰‹åŠ¨å¡«å†™è¿™ä¸ªç»“æ„ä½“ï¼Œå‘Šè¯‰é©±åŠ¨å¯„å­˜å™¨åœ°å€çš„<strong>èµ·å§‹ä½ç½®</strong>å’Œ<strong>ç»“æŸä½ç½®</strong>ï¼Œ<strong>ä¸­æ–­å·</strong>ç­‰ç­‰ã€‚</p>
<p>ç°åœ¨æœ‰äº†è®¾å¤‡æ ‘ï¼Œæˆ‘ä»¬å¾ˆå°‘æ‰‹åŠ¨å¡«å……å®ƒï¼Œä½†å†…æ ¸åœ¨è§£æè®¾å¤‡æ ‘æ—¶ï¼Œä¾ç„¶ä¼šè‡ªåŠ¨æŠŠè®¾å¤‡æ ‘é‡Œçš„ <code>reg</code> å±æ€§è½¬æ¢æˆ <code>IORESOURCE_MEM</code> ç±»å‹çš„ <code>resource</code>ï¼ŒæŠŠ <code>interrupts</code> å±æ€§è½¬æ¢æˆ <code>IORESOURCE_IRQ</code> ç±»å‹çš„ <code>resource</code>ï¼Œå¡«å…¥è¿™ä¸ªç»“æ„ä½“ä¸­ã€‚æ‰€ä»¥åœ¨é©±åŠ¨ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸ç”¨ <code>platform_get_resource()</code> æ¥è·å–è¿™äº›èµ„æºï¼Œåœ¨ä¼ ç»Ÿçš„é©±åŠ¨å¼€å‘ä¸­ï¼Œè¿™æ˜¯è·å–å¯„å­˜å™¨åŸºåœ°å€çš„æ ‡å‡†æ–¹æ³•ã€‚</p>
<h3 data-id="heading-11">2.4 è®¾å¤‡çš„æ³¨å†Œé€»è¾‘</h3>
<p>å½“æˆ‘ä»¬å‡†å¤‡å¥½æˆ–è€…å†…æ ¸é€šè¿‡è§£æè®¾å¤‡æ ‘ä»£ç å‡†å¤‡å¥½äº† <code>platform_device</code> åï¼Œéœ€è¦è°ƒç”¨ <code>platform_device_register()</code> å°†å…¶æ³¨å†Œåˆ°å†…æ ¸ã€‚</p>
<p>è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆä¼šè°ƒç”¨<code>device_add()</code>ï¼Œ<code>device_add()</code> ä¼šå°†è®¾å¤‡åŠ å…¥åˆ° <code>platform_bus</code> çš„ <code>klist_devices</code> é“¾è¡¨ï¼ˆä¸Šé¢è®²è¿‡çš„è®¾å¤‡é“¾è¡¨ï¼‰ä¸­ï¼Œè¿˜ä¼šåˆ›å»º sysfs ç›®å½• (<code>/sys/devices/...</code>)ï¼Œè§¦å‘ uevent ç­‰ï¼Œæœ€ç»ˆ <code>device_add()</code> ä¼šè°ƒç”¨ <code>bus_probe_device()</code>ï¼Œè¿™ä¸ªå‡½æ•°ä¼šéå†è¯¥æ€»çº¿ä¸Šçš„æ‰€æœ‰é©±åŠ¨ï¼Œå¹¶è°ƒç”¨æ€»çº¿çš„ <code>match</code> å‡½æ•°è¿›è¡ŒåŒ¹é…ã€‚</p>
<h2 data-id="heading-12">3 é©±åŠ¨</h2>
<p>åœ¨å†…æ ¸ä¸­ï¼Œé©±åŠ¨ç”± <code>struct device_driver</code> ç»“æ„ä½“è¡¨ç¤ºã€‚å®ƒæœ¬è´¨ä¸Šæ˜¯<strong>ç¡¬ä»¶çš„æ“ä½œæ–¹æ³•</strong>ï¼Œä¸»è¦èŒè´£æ˜¯ä¸ºäº†å‘Šè¯‰å†…æ ¸<strong>è½¯ä»¶åº”è¯¥æ€ä¹ˆåš</strong>ã€‚</p>
<p>è¿™ä¸ªç»“æ„ä½“é‡Œé¢å£°æ˜äº†è¯¥é©±åŠ¨èƒ½å¤Ÿæ”¯æŒçš„è®¾å¤‡åˆ—è¡¨ï¼Œè¿˜æœ‰ä¸€äº›å›è°ƒå‡½æ•°ã€‚</p>
<p>å’Œè®¾å¤‡ä¸€æ ·ï¼Œé©±åŠ¨åœ¨å†…æ ¸ä¸­ä¹Ÿé‡‡ç”¨äº†<strong>åŸºç±» + å­ç±»</strong>çš„è®¾è®¡æ¨¡å¼ã€‚</p>
<h3 data-id="heading-13">3.1 é€šç”¨é©±åŠ¨åŸºç±» struct device_driver</h3>
<p><code>struct device_driver</code> æ˜¯æ‰€æœ‰é©±åŠ¨ç¨‹åºçš„åŸºç¡€ï¼Œæ— è®ºæ˜¯ USB é©±åŠ¨ã€I2C é©±åŠ¨è¿˜æ˜¯ Platform é©±åŠ¨ï¼Œå®ƒä»¬çš„æ ¸å¿ƒéƒ½æ˜¯è¿™ä¸ªç»“æ„ä½“ã€‚</p>
<p>å®ƒçš„æºç ä½ç½®åœ¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/kernel/include/linux/device.h
</code></pre>
<p>æºç æˆªå›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f9f4caa5d3642909911b410a0697b96~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGxwNjY2aHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768139212&amp;x-signature=zqX6q6ozsRQTCx847QdStZVJzPk%3D" alt="12. device_driverç»“æ„ä½“.png" loading="lazy"/></p>
<p><strong>ç¬¬ 299 è¡Œï¼š</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">const</span> <span class="hljs-type">char</span> *name;
</code></pre>
<p>è¿™æ—¶é©±åŠ¨çš„åå­—ï¼Œåœ¨ <code>/sys/bus/platform/drivers/</code> ç›®å½•ä¸‹æ˜¾ç¤ºçš„é©±åŠ¨æ–‡ä»¶å¤¹åå­—å°±æ˜¯å®ƒã€‚åœ¨æ²¡æœ‰è®¾å¤‡æ ‘çš„æ—¶ä»£ï¼Œè¿™ä¸ªåå­—å¿…é¡»å’Œè®¾å¤‡çš„åå­—å®Œå…¨ä¸€æ ·æ‰èƒ½åŒ¹é…æˆåŠŸã€‚</p>
<p><strong>ç¬¬ 300 è¡Œï¼š</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bus_type</span> *<span class="hljs-title">bus</span>;</span>
</code></pre>
<p>è¿™æ˜¯é©±åŠ¨æ‰€å½’å±çš„æ€»çº¿ï¼Œé©±åŠ¨æ³¨å†Œæ—¶ï¼Œå†…æ ¸éœ€è¦çŸ¥é“æŠŠå®ƒæŒ‚åœ¨å“ªæ¡æ€»çº¿çš„<strong>é©±åŠ¨é“¾è¡¨</strong>ä¸Šã€‚</p>
<p><strong>ç¬¬ 308 è¡Œï¼š</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">of_device_id</span> *<span class="hljs-title">of_match_table</span>;</span>
</code></pre>
<p>è¿™æ˜¯<strong>é©±åŠ¨ä¸è®¾å¤‡æ ‘èŠ‚ç‚¹è¿›è¡ŒåŒ¹é…</strong>çš„å…³é”®ã€‚å†…æ ¸åœ¨è¿›è¡Œ <code>match</code> æ“ä½œæ—¶ï¼Œä¼šæ‹¿è®¾å¤‡æ ‘èŠ‚ç‚¹çš„ <code>compatible</code> å±æ€§å’Œè¿™ä¸ªè¡¨é‡Œçš„å­—ç¬¦ä¸²è¿›è¡Œæ¯”å¯¹ã€‚</p>
<p><strong>ç¬¬ 311 è¡Œï¼š</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">int</span> (*probe) (<span class="hljs-keyword">struct</span> device *dev);
</code></pre>
<p>å½“æ€»çº¿ <code>match</code> æˆåŠŸåï¼Œå°±ä¼šè°ƒç”¨è¿™é‡Œçš„ <code>probe</code>ã€‚</p>
<p><strong>ç¬¬ 313 è¡Œï¼š</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">int</span> (*remove) (<span class="hljs-keyword">struct</span> device *dev);
</code></pre>
<p>å½“é©±åŠ¨æ¨¡å—å¸è½½æˆ–è®¾å¤‡è¢«ç§»é™¤æ—¶è°ƒç”¨ã€‚</p>
<h3 data-id="heading-14">3.2 å¹³å°é©±åŠ¨å­ç±» struct platform_driver</h3>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç›´æ¥æ‰“äº¤é“çš„é€šå¸¸æ˜¯ <code>struct platform_driver</code>ï¼Œå®ƒæ˜¯å¯¹é€šç”¨é©±åŠ¨çš„è¿›ä¸€æ­¥å°è£…ï¼Œä¸“é—¨ç”¨äºå¹³å°æ€»çº¿ã€‚</p>
<p>è¿™ä¸ªç»“æ„ä½“åœ¨æºç ä¸­çš„ä½ç½®ä¸ºï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/kernel/include/linux/platform_device.h
</code></pre>
<p>æºç æˆªå›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/844dc57ac97046c79384c9a4e49097ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGxwNjY2aHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768139212&amp;x-signature=moR8tstycyHPybhiA47baLwmvn0%3D" alt="13. å¹³å°é©±åŠ¨ç»“æ„ä½“.png" loading="lazy"/></p>
<p><strong>ç¬¬ 184 è¡Œï¼š</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">int</span> (*probe)(<span class="hljs-keyword">struct</span> platform_device *);
</code></pre>
<p>è¿™æ˜¯æˆ‘ä»¬ç¼–å†™é©±åŠ¨æ—¶æœ€ç†Ÿæ‚‰çš„ <code>probe</code> å‡½æ•°ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®ƒçš„å‚æ•°æ˜¯ <code>platform_device</code> æŒ‡é’ˆï¼Œè€Œä¸æ˜¯é€šç”¨çš„ <code>device</code> æŒ‡é’ˆï¼Œè¿™å…¶å®æ˜¯å†…æ ¸ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨ï¼Œåšäº†ä¸€å±‚å°è£…ï¼Œä½†æ˜¯åº•å±‚è¿˜æ˜¯é€šç”¨çš„ï¼Œåªæ˜¯ä¼ å‚æ—¶è½¬åŒ–äº†ä¸€ä¸‹ã€‚</p>
<p><strong>ç¬¬ 189 è¡Œï¼š</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">device_driver</span> <span class="hljs-title">driver</span>;</span>
</code></pre>
<p>è¿™é‡Œå†æ¬¡ä½¿ç”¨ C è¯­è¨€å®ç°ç»§æ‰¿ï¼Œ <code>platform_driver</code> å†…éƒ¨ç›´æ¥å†…åµŒäº†ä¸€ä¸ª <code>device_driver</code>ã€‚ æˆ‘ä»¬åœ¨ç¼–å†™é©±åŠ¨æ—¶ï¼Œåˆå§‹åŒ–çš„ <code>.driver</code> æˆå‘˜ï¼ŒåŒ…æ‹¬ <code>.name</code> å’Œ <code>.of_match_table</code>ï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨è¿™ä¸ªå†…åµŒçš„åŸºç±»é‡Œè®¾ç½®çš„ã€‚</p>
<h3 data-id="heading-15">3.3 é©±åŠ¨æ³¨å†Œé€»è¾‘</h3>
<p>åœ¨ç¼–å†™é©±åŠ¨æ–‡ä»¶çš„å…¥å£å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬è°ƒç”¨äº† <code>platform_driver_register</code>ã€‚</p>
<p>è€Œ <code>platform_driver_register</code> æœ€ç»ˆä¼šè°ƒç”¨ <code>driver_register</code>ï¼Œå°†æˆ‘ä»¬çš„é©±åŠ¨æ·»åŠ åˆ° Platform æ€»çº¿çš„ <code>klist_drivers</code> é“¾è¡¨ä¸­ã€‚</p>
<p>é©±åŠ¨æ³¨å†Œåï¼Œå†…æ ¸ä¼šç«‹å³è°ƒç”¨ <code>driver_attach</code> å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šéå†<strong>åŒä¸€æ¡æ€»çº¿ä¸Šçš„è®¾å¤‡é“¾è¡¨</strong>ã€‚</p>
<p>å¯¹äºæ¯ä¸€ä¸ªè®¾å¤‡ï¼Œæ€»çº¿éƒ½ä¼šè°ƒç”¨ <code>platform_match</code> å‡½æ•°ï¼Œå®ƒä¼šæ‹¿å‡ºé©±åŠ¨çš„ <code>of_match_table</code>å»å’Œè®¾å¤‡çš„ <code>of_node</code>é‡Œçš„ <code>compatible</code> å±æ€§æ¯”å¯¹ã€‚</p>
<p>ä¸€æ—¦åŒ¹é…æˆåŠŸï¼Œå†…æ ¸å°±ä¼šè°ƒç”¨ <code>driver_probe_device</code>ï¼Œæœ€ç»ˆæ‰§è¡Œæˆ‘ä»¬å†™çš„ <code>led_probe</code> å‡½æ•°ã€‚æ­¤æ—¶ï¼Œç¡¬ä»¶èµ„æºå’Œè½¯ä»¶é€»è¾‘æ­£å¼ç»“åˆï¼Œé©±åŠ¨å¼€å§‹å·¥ä½œã€‚</p>
<p>è‡³æ­¤ï¼Œè®¾å¤‡æ¨¡å‹çš„ä¸‰å¤§ç»„ä»¶å®Œæˆäº†é—­ç¯ï¼šæ€»çº¿è´Ÿè´£åŒ¹é…ï¼Œè®¾å¤‡æä¾›èµ„æºï¼Œé©±åŠ¨æä¾›é€»è¾‘ã€‚<code>probe</code> å‡½æ•°çš„æ‰§è¡Œï¼Œæ ‡å¿—ç€é©±åŠ¨æ­£å¼æ¥ç®¡äº†è®¾å¤‡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring Boot + æ‰§è¡Œç®¡é“ï¼šè®©ä¸šåŠ¡æµç¨‹æ¸…æ™°å¯æ§]]></title>    <link>https://juejin.cn/post/7591350620189130758</link>    <guid>https://juejin.cn/post/7591350620189130758</guid>    <pubDate>2026-01-05T00:14:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591350620189130758" data-draft-id="7589903248620748826" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring Boot + æ‰§è¡Œç®¡é“ï¼šè®©ä¸šåŠ¡æµç¨‹æ¸…æ™°å¯æ§"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-05T00:14:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é£è±¡å—"/> <meta itemprop="url" content="https://juejin.cn/user/2524134428655159"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring Boot + æ‰§è¡Œç®¡é“ï¼šè®©ä¸šåŠ¡æµç¨‹æ¸…æ™°å¯æ§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2524134428655159/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é£è±¡å—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-05T00:14:16.000Z" title="Mon Jan 05 2026 00:14:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§æƒ…å†µï¼šä¸€ä¸ªè®¢å•åˆ›å»ºçš„æ¥å£ï¼Œåˆšä¸Šçº¿çš„æ—¶å€™åªæœ‰å‡ åè¡Œä»£ç ï¼Œé€»è¾‘ä¹Ÿå¾ˆç®€å•ã€‚ä½†éšç€ä¸šåŠ¡è¿­ä»£ï¼Œä¸‰ä¸ªæœˆåå˜æˆäº†è¿™æ ·ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrder</span><span class="hljs-params">(OrderRequest request)</span> {
    <span class="hljs-comment">// å‚æ•°æ ¡éªŒ</span>
    <span class="hljs-keyword">if</span> (request.getUserId() == <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"ç”¨æˆ·IDä¸èƒ½ä¸ºç©º"</span>);
    }
    <span class="hljs-comment">// ... çœç•¥ 20 è¡Œæ ¡éªŒä»£ç </span>

    <span class="hljs-comment">// æƒé™æ ¡éªŒ</span>
    <span class="hljs-keyword">if</span> (!checkPermission(request.getUserId())) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ForbiddenException</span>(<span class="hljs-string">"æ— æƒé™"</span>);
    }

    <span class="hljs-comment">// ä¸šåŠ¡æ ¡éªŒ</span>
    <span class="hljs-keyword">if</span> (getOrderCount(request.getUserId()) &gt;= <span class="hljs-number">10</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BusinessException</span>(<span class="hljs-string">"è®¢å•æ•°é‡è¶…é™"</span>);
    }
    <span class="hljs-comment">// ... çœç•¥ 15 è¡Œä¸šåŠ¡æ ¡éªŒ</span>

    <span class="hljs-comment">// åˆ›å»ºè®¢å•</span>
    <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> buildOrder(request);
    orderMapper.insert(order);

    <span class="hljs-comment">// å†™æ“ä½œæ—¥å¿—</span>
    <span class="hljs-keyword">try</span> {
        operateLogService.log(order.getId(), <span class="hljs-string">"CREATE"</span>);
    } <span class="hljs-keyword">catch</span> (Exception e) {
        <span class="hljs-comment">// æ—¥å¿—å¤±è´¥ä¸å½±å“ä¸»æµç¨‹</span>
        log.error(<span class="hljs-string">"å†™æ—¥å¿—å¤±è´¥"</span>, e);
    }

    <span class="hljs-comment">// å‘é€é€šçŸ¥</span>
    <span class="hljs-keyword">try</span> {
        notificationService.send(order);
    } <span class="hljs-keyword">catch</span> (Exception e) {
        log.error(<span class="hljs-string">"å‘é€é€šçŸ¥å¤±è´¥"</span>, e);
    }

    <span class="hljs-comment">// å¼‚æ­¥é£æ§æ£€æŸ¥</span>
    asyncRiskCheckService.check(order);
}
</code></pre>
<p>å‡ ç™¾è¡Œä»£ç ï¼Œ<code>if</code>ã€<code>try-catch</code> åˆ°å¤„éƒ½æ˜¯ã€‚æ›´å¯æ€•çš„æ˜¯ï¼š</p>
<ul>
<li>æ—¥å¿—å†™å¤±è´¥è¦ä¸è¦æŠ›å¼‚å¸¸ï¼Ÿ</li>
<li>é€šçŸ¥å‘é€å¤±è´¥è¦ä¸è¦å›æ»šè®¢å•ï¼Ÿ</li>
<li>æ–°å¢ä¸€ä¸ª"ä¼˜æƒ åˆ¸æ ¸é”€"é€»è¾‘åŠ åœ¨å“ªé‡Œï¼Ÿ</li>
<li>æµ‹è¯•ç¯å¢ƒæƒ³å…³é—­é£æ§æ£€æŸ¥æ€ä¹ˆæï¼Ÿ</li>
</ul>
<h2 data-id="heading-0">é—®é¢˜å‡ºåœ¨å“ªï¼Ÿ</h2>
<p>ä»”ç»†çœ‹çœ‹ä¸Šé¢çš„ä»£ç ï¼Œå…¶å®å®ƒæƒ³åšçš„äº‹æƒ…å¯ä»¥æ‹†æˆè¿™ä¹ˆå‡ ä¸ªæ­¥éª¤ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> æ ¡éªŒå‚æ•°
<span class="hljs-bullet">2.</span> æ ¡éªŒæƒé™
<span class="hljs-bullet">3.</span> æ ¡éªŒä¸šåŠ¡è§„åˆ™
<span class="hljs-bullet">4.</span> åˆ›å»ºè®¢å•ï¼ˆæ ¸å¿ƒï¼‰
<span class="hljs-bullet">5.</span> è®°å½•æ—¥å¿—
<span class="hljs-bullet">6.</span> å‘é€é€šçŸ¥
<span class="hljs-bullet">7.</span> é£æ§æ£€æŸ¥
</code></pre>
<p>è¿™äº›æ­¥éª¤æœ‰å‡ ä¸ªç‰¹ç‚¹ï¼š</p>
<p><strong>æœ‰çš„å¿…é¡»æˆåŠŸ</strong>ï¼šæ¯”å¦‚å‚æ•°æ ¡éªŒã€è®¢å•åˆ›å»º
<strong>æœ‰çš„å¯ä»¥å¤±è´¥</strong>ï¼šæ¯”å¦‚æ—¥å¿—è®°å½•ã€é€šçŸ¥å‘é€
<strong>æœ‰çš„åŒæ­¥æ‰§è¡Œ</strong>ï¼šæ¯”å¦‚å„ç§æ ¡éªŒ
<strong>æœ‰çš„å¼‚æ­¥æ‰§è¡Œ</strong>ï¼šæ¯”å¦‚é£æ§æ£€æŸ¥
<strong>æœ‰çš„å¯èƒ½è¦å…³é—­</strong>ï¼šæ¯”å¦‚æµ‹è¯•ç¯å¢ƒä¸éœ€è¦é£æ§</p>
<p>ä½†ç°åœ¨çš„å†™æ³•ï¼Œæ‰€æœ‰è¿™äº›é€»è¾‘éƒ½æ··åœ¨ä¸€èµ·ï¼Œ<strong>é¡ºåºã€å¤±è´¥ç­–ç•¥ã€æ˜¯å¦å¯é€‰</strong>ï¼Œå…¨é ä»£ç é‡Œçš„ <code>if</code> å’Œ <code>try-catch</code> æ¥æ§åˆ¶ï¼Œèƒ½ä¸ä¹±å—ï¼Ÿ</p>
<h2 data-id="heading-1">æœ‰æ²¡æœ‰æ›´å¥½çš„å†™æ³•ï¼Ÿ</h2>
<p>å¦‚æœæŠŠè¿™äº›æ­¥éª¤æŠ½è±¡æˆä¸€ä¸ªä¸ª"èŠ‚ç‚¹"ï¼Œç„¶åç”¨ä¸€ä¸ª"ç®¡é“"æŠŠå®ƒä»¬ä¸²èµ·æ¥ï¼Œä¼šæ€æ ·ï¼Ÿ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">PipelineNode</span>&lt;T&gt; {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">execute</span><span class="hljs-params">(PipelineContext&lt;T&gt; context)</span>;
}
</code></pre>
<p>æ¯ä¸ªèŠ‚ç‚¹åªåšä¸€ä»¶äº‹ï¼Œä¸å…³å¿ƒå‰åæ˜¯è°ï¼Œä¸å…³å¿ƒè‡ªå·±æ˜¯ç¬¬å‡ ä¸ªæ‰§è¡Œã€‚</p>
<p>ç„¶åå®šä¹‰ä¸€ä¸ªç®¡é“æ¥æ‰§è¡Œè¿™äº›èŠ‚ç‚¹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExecutionPipeline</span>&lt;T&gt; {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;PipelineNode&lt;T&gt;&gt; nodes;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">execute</span><span class="hljs-params">(T data)</span> {
        PipelineContext&lt;T&gt; ctx = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PipelineContext</span>&lt;&gt;(data);
        <span class="hljs-keyword">for</span> (PipelineNode&lt;T&gt; node : nodes) {
            <span class="hljs-keyword">if</span> (ctx.isInterrupted()) {
                <span class="hljs-keyword">break</span>;
            }
            node.execute(ctx);
        }
    }
}
</code></pre>
<p>ç°åœ¨å†çœ‹çœ‹è®¢å•åˆ›å»ºæ€ä¹ˆå†™ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Pipeline</span> <span class="hljs-variable">pipeline</span> <span class="hljs-operator">=</span> Pipeline.builder()
    .add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ParamValidateNode</span>())       <span class="hljs-comment">// å‚æ•°æ ¡éªŒ</span>
    .add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PermissionCheckNode</span>())     <span class="hljs-comment">// æƒé™æ ¡éªŒ</span>
    .add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BusinessValidateNode</span>())    <span class="hljs-comment">// ä¸šåŠ¡æ ¡éªŒ</span>
    .add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CreateOrderNode</span>())         <span class="hljs-comment">// åˆ›å»ºè®¢å•</span>
    .add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OperateLogNode</span>())          <span class="hljs-comment">// å†™æ—¥å¿—</span>
    .add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NotificationNode</span>())        <span class="hljs-comment">// å‘é€šçŸ¥</span>
    .add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AsyncRiskCheckNode</span>())      <span class="hljs-comment">// é£æ§æ£€æŸ¥</span>
    .build();

pipeline.execute(orderRequest);
</code></pre>
<p><strong>ä¸»æµç¨‹åªå‰©ä¸‹ 10 è¡Œä»£ç ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„é€»è¾‘ç‹¬ç«‹å°è£…ã€‚</strong></p>
<h2 data-id="heading-2">è¿™æ ·åšæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</h2>
<h4 data-id="heading-3">1. èŠ‚ç‚¹å¯æ’æ‹”</h4>
<p>æƒ³åŠ ä¸€ä¸ª"ä¼˜æƒ åˆ¸æ ¸é”€"é€»è¾‘ï¼ŸåŠ ä¸ªèŠ‚ç‚¹å°±è¡Œäº†ï¼š</p>
<pre><code class="hljs language-java" lang="java">.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CouponDeductNode</span>())
</code></pre>
<p>æƒ³å…³é—­æŸä¸ªåŠŸèƒ½ï¼Ÿå»æ‰å¯¹åº”èŠ‚ç‚¹ï¼Œæˆ–è€…é€šè¿‡é…ç½®æ§åˆ¶ï¼š</p>
<pre><code class="hljs language-java" lang="java">.add(env.isProd() ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">RiskCheckNode</span>() : <span class="hljs-keyword">new</span> <span class="hljs-title class_">SkipNode</span>())
</code></pre>
<h4 data-id="heading-4">2. å¤±è´¥ç­–ç•¥æ¸…æ™°</h4>
<p>åœ¨ <code>PipelineContext</code> é‡Œå®šä¹‰å¥½å¤±è´¥ç­–ç•¥ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">FailureStrategy</span> {
    CONTINUE,    <span class="hljs-comment">// å¤±è´¥åç»§ç»­æ‰§è¡Œ</span>
    STOP,        <span class="hljs-comment">// å¤±è´¥åä¸­æ–­ç®¡é“</span>
    ROLLBACK     <span class="hljs-comment">// å¤±è´¥åå›æ»šï¼ˆéœ€è¦é…åˆäº‹åŠ¡ï¼‰</span>
}
</code></pre>
<p>æ—¥å¿—èŠ‚ç‚¹çš„å¤±è´¥ç­–ç•¥æ˜¯ <code>CONTINUE</code>ï¼Œè®¢å•åˆ›å»ºèŠ‚ç‚¹çš„å¤±è´¥ç­–ç•¥æ˜¯ <code>STOP</code>ï¼Œä¸€ç›®äº†ç„¶ã€‚</p>
<h4 data-id="heading-5">3. èŠ‚ç‚¹å¯å¤ç”¨</h4>
<p>å‚æ•°æ ¡éªŒèŠ‚ç‚¹ã€æƒé™æ ¡éªŒèŠ‚ç‚¹ã€æ—¥å¿—èŠ‚ç‚¹ï¼Œéƒ½å¯ä»¥åœ¨å…¶ä»–ä¸šåŠ¡é‡Œå¤ç”¨ã€‚</p>
<h4 data-id="heading-6">4. æ‰§è¡Œé¡ºåºå¯æ§</h4>
<p>èŠ‚ç‚¹çš„æ‰§è¡Œé¡ºåºç”±ç®¡é“å®šä¹‰ï¼Œä¸ç”¨åœ¨æ¯ä¸ªèŠ‚ç‚¹é‡Œå†™ä»£ç æ§åˆ¶ã€‚</p>
<h2 data-id="heading-7">æ‰§è¡Œç®¡é“ï¼šä¸€ç§å·¥ç¨‹åŒ–æ–¹æ¡ˆ</h2>
<p>ä¸Šé¢ä»‹ç»çš„æ–¹æ¡ˆæ—¢<strong>æ‰§è¡Œç®¡é“ï¼ˆExecution Pipelineï¼‰</strong></p>
<p>å®ƒä¸æ˜¯æŸä¸ªæ¡†æ¶ï¼Œè€Œæ˜¯ä¸€ç§å·¥ç¨‹è®¾è®¡æ¨¡å¼ï¼šæŠŠä¸€æ¬¡ä¸šåŠ¡æ‰§è¡Œæ‹†æˆå¤šä¸ªå¯æ’æ‹”ã€æœ‰é¡ºåºã€å¯æ§åˆ¶çš„æ‰§è¡Œé˜¶æ®µï¼Œç”¨ç»Ÿä¸€æœºåˆ¶ä¸²èµ·æ¥ã€‚</p>
<h2 data-id="heading-8">å®ƒè·Ÿ AOPã€è´£ä»»é“¾æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h2>
<p>ä½ å¯èƒ½æƒ³åˆ°äº† AOPã€è´£ä»»é“¾ã€å·¥ä½œæµå¼•æ“è¿™äº›æ¦‚å¿µï¼Œå®ƒä»¬ç¡®å®æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼š</p>



































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>é€‚ç”¨åœºæ™¯</th><th>å±€é™æ€§</th></tr></thead><tbody><tr><td>AOP</td><td>é€šç”¨çš„æ¨ªåˆ‡é€»è¾‘ï¼ˆæ—¥å¿—ã€äº‹åŠ¡ï¼‰</td><td>é¡ºåºä¸ç›´è§‚ï¼Œéš¾ä»¥åšæµç¨‹æ§åˆ¶</td></tr><tr><td>Filter/Interceptor</td><td>HTTP è¯·æ±‚çº§åˆ«çš„å¤„ç†</td><td>åªèƒ½ç”¨äºè¯·æ±‚å¤„ç†</td></tr><tr><td>@Async</td><td>å¼‚æ­¥æ‰§è¡Œ</td><td>åªè§£å†³å¹¶å‘ï¼Œä¸è§£å†³æµç¨‹ç¼–æ’</td></tr><tr><td>è´£ä»»é“¾</td><td>åŠ¨æ€ç»„åˆå¤„ç†é€»è¾‘</td><td>ç¼ºå°‘å·¥ç¨‹åŒ–å°è£…</td></tr><tr><td>å·¥ä½œæµå¼•æ“</td><td>å¤æ‚çš„ä¸šåŠ¡æµç¨‹</td><td>å¤ªé‡ï¼Œå•æœºåº”ç”¨ç”¨ä¸ä¸Š</td></tr></tbody></table>
<p>æ‰§è¡Œç®¡é“å¯ä»¥è¯´æ˜¯<strong>å·¥ç¨‹åŒ–çš„è´£ä»»é“¾æ¨¡å¼</strong>ï¼Œä¸“é—¨ç”¨äºè§£å†³å•æœºåº”ç”¨å†…çš„ä¸šåŠ¡æµç¨‹ç¼–æ’é—®é¢˜ã€‚</p>
<h2 data-id="heading-9">ä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ</h2>
<p>ä¸æ˜¯æ‰€æœ‰åœºæ™¯éƒ½éœ€è¦æ‰§è¡Œç®¡é“ã€‚å¦‚æœä½ çš„ä»£ç ï¼š</p>
<ul>
<li>æ­¥éª¤å›ºå®šã€é€»è¾‘ç®€å•ï¼Œç›´æ¥å†™å°±è¡Œ</li>
<li>æµç¨‹å¤æ‚ä½†ä¸ä¼šå˜åŒ–ï¼Œä¹Ÿæ²¡å¿…è¦è¿‡åº¦è®¾è®¡</li>
</ul>
<p>ä½†å½“å‡ºç°è¿™äº›ä¿¡å·æ—¶ï¼Œå¯ä»¥è€ƒè™‘ï¼š</p>
<ul>
<li>ä¸€ä¸ªæ–¹æ³•è¿‡é•¿ï¼Œä¸åˆ©äºé˜…è¯»ç»´æŠ¤</li>
<li>æœ‰å¤šä¸ª"å¯é€‰"æˆ–"å¼‚æ­¥"çš„æ‰§è¡Œæ­¥éª¤</li>
<li>ç»å¸¸éœ€è¦æ’å…¥æ–°çš„æ‰§è¡Œé€»è¾‘</li>
<li>ä¸åŒç¯å¢ƒéœ€è¦ä¸åŒçš„æ‰§è¡Œæµç¨‹</li>
</ul>
<p>æ‰§è¡Œç®¡é“ç‰¹åˆ«é€‚åˆ<strong>å•æœºåº”ç”¨å†…çš„å¤æ‚ä¸šåŠ¡æµç¨‹</strong>ï¼Œæ¯”å¦‚è®¢å•åˆ›å»ºã€ç”¨æˆ·æ³¨å†Œã€æ•°æ®å¯¼å…¥ç­‰åœºæ™¯ã€‚</p>
<h2 data-id="heading-10">å†™åœ¨æœ€å</h2>
<p>å¥½çš„ä»£ç ä¸æ˜¯ä¸€æ¬¡å†™æˆçš„ï¼Œè€Œæ˜¯åœ¨ä¸æ–­é‡æ„ä¸­è¿›åŒ–å‡ºæ¥çš„ã€‚</p>
<p>å¦‚æœä½ çš„é¡¹ç›®é‡Œå·²ç»æœ‰äº†é‚£ç§"å·¨æ— éœ¸"æ–¹æ³•ï¼Œä¸ç”¨æ€¥ç€å…¨éƒ¨æ¨å€’é‡æ¥ã€‚å…ˆè¯•ç€æŠŠå…¶ä¸­ä¸€ä¸ªç‹¬ç«‹çš„é€»è¾‘æŠ½æˆèŠ‚ç‚¹ï¼Œç„¶åé€æ­¥è¿ç§»ï¼Œä»£ç ä¼šè¶Šæ¥è¶Šæ¸…æ™°ã€‚</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/github.com/yuboon</span><span class="hljs-regexp">/java-examples/tree</span><span class="hljs-regexp">/master/springboot</span>-pipeline
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PHP é«˜æ•ˆçš„æ ‡å‡†åº“ SPL å…¨é¢æŒ‡å—]]></title>    <link>https://juejin.cn/post/7591350620189147142</link>    <guid>https://juejin.cn/post/7591350620189147142</guid>    <pubDate>2026-01-05T00:14:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591350620189147142" data-draft-id="7591334602427482175" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PHP é«˜æ•ˆçš„æ ‡å‡†åº“ SPL å…¨é¢æŒ‡å—"/> <meta itemprop="keywords" content="åç«¯,PHP"/> <meta itemprop="datePublished" content="2026-01-05T00:14:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BingoGo"/> <meta itemprop="url" content="https://juejin.cn/user/993614242266077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PHP é«˜æ•ˆçš„æ ‡å‡†åº“ SPL å…¨é¢æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614242266077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BingoGo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-05T00:14:50.000Z" title="Mon Jan 05 2026 00:14:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">PHP é«˜æ•ˆçš„æ ‡å‡†åº“ SPL å…¨é¢æŒ‡å—</h2>
<p>å¦‚æœä½ æ˜¯ä¸€å PHP å¼€å‘è€…ï¼Œæ— è®ºæ˜¯åœ¨ç¼–å†™ç®€å•è„šæœ¬ï¼Œè¿˜æ˜¯ä½¿ç”¨ Laravel ç­‰æ¡†æ¶æ„å»ºå¤æ‚åº”ç”¨ï¼ŒSPL éƒ½æ˜¯ä¸€å¥—<strong>ç»å¸¸è¢«å¿½è§†å´éå¸¸å¼ºå¤§</strong>çš„å·¥å…·é›†ã€‚</p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ SPL æ˜¯ä»€ä¹ˆã€ä¸ºä»€ä¹ˆå€¼å¾—ä½¿ç”¨ã€å®ƒçš„ä¼˜ç¼ºç‚¹ã€åœ¨ä»£ç ä¸­å¼•å…¥ SPL ä¼šå¸¦æ¥å“ªäº›å½±å“ã€é€‚åˆä½¿ç”¨ SPL çš„åœºæ™¯ï¼Œä»¥åŠå¦‚ä½•åœ¨ Laravel ç¯å¢ƒä¸­é«˜æ•ˆåœ°ä½¿ç”¨å®ƒã€‚åŒæ—¶ï¼Œæˆ‘ä¼šç»“åˆ<strong>çœŸå®ä¸šåŠ¡åœºæ™¯</strong>ç»™å‡ºè¯¦ç»†ç¤ºä¾‹ï¼Œå¸®åŠ©ä½ ç†è§£ SPL çš„å®é™…ä»·å€¼ã€‚</p>
<p>è¯»å®Œæœ¬æ–‡ï¼Œä½ å°†å¯¹ SPL æœ‰ä¸€ä¸ªç³»ç»Ÿã€æ¸…æ™°çš„è®¤è¯†ï¼Œå¹¶èƒ½å¤Ÿåœ¨å®é™…é¡¹ç›®ä¸­è‡ªå¦‚åœ°è¿ç”¨å®ƒã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcatchadmin.com%2Fpost%2F2026-01%2Funderstanding-the-standard-php-library-spl-a-comprehensive-guide" target="_blank" title="https://catchadmin.com/post/2026-01/understanding-the-standard-php-library-spl-a-comprehensive-guide" ref="nofollow noopener noreferrer">åŸæ–‡ PHP é«˜æ•ˆçš„æ ‡å‡†åº“ SPL å…¨é¢æŒ‡å—</a></p>
<hr/>
<h3 data-id="heading-1">ä»€ä¹ˆæ˜¯æ ‡å‡† PHP åº“ï¼ˆSPLï¼‰ï¼Ÿ</h3>
<p>æ ‡å‡† PHP åº“ï¼ˆSPLï¼‰æ˜¯ä¸€ç»„è‡ª PHP 5.0 èµ·å†…ç½®äº PHP æ ¸å¿ƒä¸­çš„ç±»å’Œæ¥å£ï¼Œæ—¨åœ¨ä»¥<strong>æ ‡å‡†åŒ–ã€é«˜æ•ˆ</strong>çš„æ–¹å¼è§£å†³å¸¸è§ç¼–ç¨‹é—®é¢˜ã€‚ä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸º PHP è‡ªå¸¦çš„â€œç‘å£«å†›åˆ€â€ï¼Œä¸“é—¨ç”¨äºå¤„ç†æ•°æ®ç»“æ„ã€è¿­ä»£å™¨ã€å¼‚å¸¸ç­‰å¸¸è§éœ€æ±‚ã€‚</p>
<p>ä¸ç¬¬ä¸‰æ–¹åº“ä¸åŒï¼ŒSPL æ˜¯ PHP æ ¸å¿ƒçš„ä¸€éƒ¨åˆ†ï¼Œä¸éœ€è¦é€šè¿‡ Composer å®‰è£…ï¼Œ<strong>å¼€ç®±å³ç”¨</strong>ã€‚</p>
<p>ä»æ•´ä½“ä¸Šçœ‹ï¼ŒSPL ä¸»è¦æä¾›äº†ä»¥ä¸‹èƒ½åŠ›ï¼š</p>
<ul>
<li><strong>æ•°æ®ç»“æ„</strong>
å¦‚ <code>SplStack</code>ã€<code>SplQueue</code>ã€<code>SplHeap</code>ã€<code>SplDoublyLinkedList</code>ã€<code>SplFixedArray</code> ç­‰ï¼Œç”¨äºæ›´é«˜æ•ˆåœ°ç®¡ç†æ•°æ®é›†åˆã€‚</li>
<li><strong>è¿­ä»£å™¨</strong>
ç”¨äºç»Ÿä¸€éå†æ•°æ®ç»“æ„çš„æ¥å£å’Œå®ç°ï¼Œä¾‹å¦‚ç”¨äºæ–‡ä»¶å¤„ç†çš„ <code>SplFileObject</code>ï¼Œæˆ–ç”¨äºåµŒå¥—ç»“æ„çš„ <code>RecursiveIteratorIterator</code>ã€‚</li>
<li><strong>å¼‚å¸¸ä½“ç³»</strong>
åŒ…å« <code>LogicException</code>ã€<code>RuntimeException</code> ä»¥åŠå®ƒä»¬çš„å­ç±»ï¼ˆå¦‚ <code>InvalidArgumentException</code>ï¼‰ï¼Œç”¨äºæ›´æ¸…æ™°çš„é”™è¯¯å¤„ç†ã€‚</li>
<li><strong>å…¶ä»–å·¥å…·</strong>
åŒ…æ‹¬é€šè¿‡ <code>spl_autoload_register()</code> å®ç°çš„è‡ªåŠ¨åŠ è½½ï¼Œä»¥åŠå¯¹è±¡åå°„ä¸è‡ªçœç›¸å…³å·¥å…·ã€‚</li>
</ul>
<p>SPL å¹¶ä¸æ˜¯ä¸€ä¸ªâ€œæ–°æ½®â€çš„ç‰¹æ€§ï¼Œä½†å®ƒçš„æˆç†Ÿåº¦å’Œé€šç”¨æ€§ï¼Œä½¿å…¶åœ¨ç¼–å†™<strong>å¹²å‡€ã€é«˜æ€§èƒ½ä»£ç </strong>æ—¶éå¸¸æœ‰ä»·å€¼ã€‚</p>
<hr/>
<h3 data-id="heading-2">ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ SPLï¼Ÿ</h3>
<p>åœ¨å½“ä»Š Composer åŒ…å’Œæ¡†æ¶ç››è¡Œçš„æ—¶ä»£ï¼Œä¸ºä»€ä¹ˆè¿˜è¦å…³æ³¨ SPLï¼Ÿæ ¸å¿ƒåŸå› åªæœ‰ä¸¤ä¸ªå­—ï¼š<strong>ç®€å•</strong> å’Œ <strong>æ€§èƒ½</strong>ã€‚</p>
<p>SPL æ˜¯ PHP åŸç”Ÿçš„ä¸€éƒ¨åˆ†ï¼Œå¤©ç„¶é›†æˆï¼Œæ— éœ€é¢å¤–ä¾èµ–ã€‚å®ƒé¼“åŠ±é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰ï¼Œè®©ä»£ç æ›´æ¨¡å—åŒ–ã€æ›´å¯å¤ç”¨ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä½ éœ€è¦å¤„ç†å¤§è§„æ¨¡æ•°æ®ï¼Œæˆ–è€…å®ç°è‡ªå®šä¹‰çš„éå†é€»è¾‘ï¼ŒSPL æä¾›çš„è¿­ä»£å™¨å¯ä»¥è®©ä½ é¿å…ä½¿ç”¨å¤æ‚çš„æ•°ç»„æ“ä½œå’ŒåµŒå¥—å¾ªç¯ã€‚</p>
<p>ä½œä¸º Laravel å¼€å‘è€…ï¼Œä½ å¯èƒ½å·²ç»ä¹ æƒ¯ä½¿ç”¨ Eloquent å¤„ç†æ•°æ®åº“æ•°æ®ï¼Œä½†åœ¨<strong>è‡ªå®šä¹‰æ•°æ®å¤„ç†ã€æ–‡ä»¶è¯»å†™ã€ä»»åŠ¡è°ƒåº¦</strong>ç­‰åœºæ™¯ä¸­ï¼ŒSPL å¾€å¾€æ¯”æ¡†æ¶è‡ªå¸¦å·¥å…·æ›´è½»é‡ã€æ›´ç›´æ¥ã€‚</p>
<p>ä¸€å¥è¯æ€»ç»“ï¼š</p>
<blockquote>
<p>å½“ä½ éœ€è¦<strong>è½»é‡çº§ã€æ— ä¾èµ–ã€ç¬¦åˆ PHP OOP è®¾è®¡ç†å¿µçš„å·¥å…·</strong>æ—¶ï¼ŒSPL éå¸¸å€¼å¾—ä½¿ç”¨ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-3">ä½¿ç”¨ SPL çš„å¥½å¤„</h3>
<p>SPL åœ¨å¯ç»´æŠ¤æ€§å’Œæ€§èƒ½æ–¹é¢æœ‰ä¸å°‘ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>æ•ˆç‡ä¸æ€§èƒ½</strong>
SPL æ˜¯ç¼–è¯‘è¿› PHP å†…æ ¸çš„ã€‚ä¾‹å¦‚ï¼Œ<code>SplFixedArray</code> åœ¨å›ºå®šå¤§å°é›†åˆçš„åœºæ™¯ä¸‹æ¯”æ™®é€šæ•°ç»„æ›´çœå†…å­˜ï¼Œå¹¶ä¸”è®¿é—®å¤æ‚åº¦ä¸º O(1)ã€‚</li>
<li><strong>æ ‡å‡†åŒ–</strong>
è¿­ä»£å™¨æ¥å£è®©æ•°ç»„ã€å¯¹è±¡ã€æ–‡ä»¶éƒ½å¯ä»¥ç”¨ <code>foreach</code> ç»Ÿä¸€éå†ï¼Œå‡å°‘é‡å¤ä»£ç ã€‚</li>
<li><strong>å¯æ‰©å±•æ€§</strong>
SPL ç±»å¯ä»¥è¢«ç»§æ‰¿ï¼Œæ–¹ä¾¿æ„å»ºå¯å¤ç”¨ç»„ä»¶ï¼Œéå¸¸é€‚åˆä¸­å¤§å‹é¡¹ç›®ã€‚</li>
<li><strong>æ›´æ¸…æ™°çš„é”™è¯¯å¤„ç†</strong>
é€šè¿‡å¼‚å¸¸å±‚çº§ç»“æ„ï¼Œå¯ä»¥æŠ›å‡ºè¯­ä¹‰æ˜ç¡®çš„å¼‚å¸¸ï¼Œå¦‚ <code>BadMethodCallException</code>ï¼Œè€Œä¸æ˜¯æ¨¡ç³Šçš„é”™è¯¯ä¿¡æ¯ã€‚</li>
<li><strong>æ— éœ€é¢å¤–ä¾èµ–</strong>
åœ¨ Laravel é¡¹ç›®ä¸­ï¼Œå‡å°‘ Composer ä¾èµ–æ„å‘³ç€æ›´å¹²å‡€çš„ <code>composer.json</code>ã€‚</li>
<li><strong>è¯­ä¹‰æ›´æ¸…æ™°çš„ä»£ç </strong>
<code>SplQueue</code> æ˜ç¡®è¡¨ç¤º FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ï¼Œæ¯”ç›´æ¥ç”¨æ•°ç»„æ›´å®¹æ˜“è®©äººç†è§£ä»£ç æ„å›¾ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-4">ä½¿ç”¨ SPL çš„ä¸è¶³ä¹‹å¤„</h3>
<p>SPL ä¹Ÿå¹¶éå®Œç¾æ— ç¼ºï¼š</p>
<ul>
<li><strong>å­¦ä¹ æˆæœ¬</strong>
å¯¹äºä¹ æƒ¯è¿‡ç¨‹å¼ PHP çš„å¼€å‘è€…æ¥è¯´ï¼ŒSPL çš„æ¥å£å’ŒæŠ½è±¡ç±»å¯èƒ½ä¸å¤ªç›´è§‚ã€‚</li>
<li><strong>åŠŸèƒ½è¦†ç›–æœ‰é™</strong>
å¯¹äºå›¾ç»“æ„ã€å¹³è¡¡æ ‘ç­‰é«˜çº§æ•°æ®ç»“æ„ï¼Œä»ç„¶éœ€è¦ç¬¬ä¸‰æ–¹åº“æˆ– PECL æ‰©å±•ã€‚</li>
<li><strong>ä¸ç°ä»£ PHP ç‰¹æ€§å­˜åœ¨ä»£æ²Ÿ</strong>
éƒ¨åˆ† SPL ç»„ä»¶åœ¨è®¾è®¡ä¸Šç•¥æ˜¾é™ˆæ—§ï¼Œä¸ PHP 8+ çš„æšä¸¾ã€å±æ€§ç­‰ç‰¹æ€§ç»“åˆåº¦ä¸é«˜ã€‚</li>
<li><strong>è°ƒè¯•å¤æ‚åº¦</strong>
ç»§æ‰¿ SPL ç±»å¯èƒ½ä¼šå½¢æˆè¾ƒæ·±çš„ç»§æ‰¿é“¾ï¼Œåœ¨ Laravel è¿™ç§å¤šå±‚æ¶æ„ä¸­è°ƒè¯•ä¼šæ›´å¤æ‚ã€‚</li>
<li><strong>æŸäº›åœºæ™¯ä¸‹çš„æ€§èƒ½å¼€é”€</strong>
åœ¨æå¤§æ•°æ®é‡ä¸‹ï¼Œè¿­ä»£å™¨å¯èƒ½æ¯”åŸç”Ÿ <code>for</code> å¾ªç¯ç¨æ…¢ã€‚</li>
</ul>
<p>æ€»ä½“æ¥è¯´ï¼Œåªè¦<strong>åˆç†ä½¿ç”¨</strong>ï¼Œè¿™äº›ç¼ºç‚¹å¹¶ä¸ä¼šæˆä¸ºè‡´å‘½é—®é¢˜ã€‚</p>
<hr/>
<h3 data-id="heading-5">ä½¿ç”¨ SPL ä¼šå¸¦æ¥ä»€ä¹ˆå½±å“ï¼Ÿ</h3>
<p>åœ¨é¡¹ç›®ä¸­å¼•å…¥ SPLï¼Œé€šå¸¸ä¼šäº§ç”Ÿä»¥ä¸‹å˜åŒ–ï¼š</p>
<ul>
<li><strong>ä»£ç é£æ ¼è½¬å˜</strong>
æ›´åå‘ OOPï¼Œæœ‰åˆ©äºé•¿æœŸç»´æŠ¤ï¼Œä½†å¯èƒ½éœ€è¦é‡æ„æ—§ä»£ç ã€‚</li>
<li><strong>ä¾èµ–ç®¡ç†æ›´è½»é‡</strong>
å‡å°‘å¯¹å¤–éƒ¨åŒ…çš„ä¾èµ–ï¼Œæå‡å¯ç§»æ¤æ€§ã€‚</li>
<li><strong>å¼‚å¸¸æ›´æ—©æš´éœ²</strong>
æ›´ä¸¥æ ¼çš„å¼‚å¸¸ä½“ç³»å¯èƒ½ä¼šæš´éœ²æ—§ä»£ç ä¸­çš„æ½œåœ¨é—®é¢˜ã€‚</li>
<li><strong>å›¢é˜Ÿåä½œå½±å“</strong>
å›¢é˜ŸåˆæœŸå¯èƒ½éœ€è¦é€‚åº” SPLï¼Œä½†ä¸€æ—¦ç»Ÿä¸€è§„èŒƒï¼Œæ•´ä½“ä»£ç è´¨é‡ä¼šæ›´é«˜ã€‚</li>
<li><strong>è¿è¡Œæ—¶è¡¨ç°å˜åŒ–</strong>
ä¸åŒ SPL æ•°æ®ç»“æ„çš„å†…å­˜ä½¿ç”¨æ–¹å¼ä¸åŒï¼Œéœ€è¦é…åˆæ€§èƒ½åˆ†æå·¥å…·è¯„ä¼°ã€‚</li>
</ul>
<p>ç®€è€Œè¨€ä¹‹ï¼šSPL èƒ½è®©ä»£ç æ›´ç°ä»£ï¼Œä½†éœ€è¦<strong>æœ‰æ„è¯†åœ°å¼•å…¥</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-6">é€‚åˆä½¿ç”¨ SPL çš„åœºæ™¯</h3>
<p>SPL ç‰¹åˆ«é€‚åˆä»¥ä¸‹æƒ…å†µï¼š</p>
<ul>
<li><strong>æ•°æ®å¤„ç†ç®¡é“</strong>
ä¾‹å¦‚æ‰¹é‡å¤„ç†ä»»åŠ¡ã€é˜Ÿåˆ—ã€æ ˆç»“æ„ã€‚</li>
<li><strong>æ–‡ä»¶å’Œç›®å½•æ“ä½œ</strong>
é€’å½’éå†ç›®å½•ã€é€è¡Œè¯»å–å¤§æ–‡ä»¶ã€‚</li>
<li><strong>è‡ªå®šä¹‰é›†åˆç»“æ„</strong>
å›ºå®šå¤§å°æ•°ç»„ã€ä¼˜å…ˆçº§æ’åºã€‚</li>
<li><strong>åº“æˆ–ç»„ä»¶å¼€å‘</strong>
éœ€è¦ç²¾ç»†åŒ–å¼‚å¸¸ç®¡ç†ã€‚</li>
<li><strong>æ€§èƒ½æ•æ„Ÿæ¨¡å—</strong>
é«˜å¹¶å‘ã€é«˜é¢‘è®¿é—®çš„æ ¸å¿ƒé€»è¾‘ã€‚</li>
</ul>
<p>ä¸å»ºè®®åœ¨ç®€å•æ•°ç»„æ“ä½œä¸­æ»¥ç”¨ SPLï¼ŒLaravel çš„ <code>Collection</code> åœ¨å¤šæ•°åœºæ™¯ä¸‹æ›´å‹å¥½ã€‚</p>
<hr/>
<h3 data-id="heading-7">Laravel å¼€å‘è€…å¦‚ä½•ä½¿ç”¨ SPLï¼Ÿ</h3>
<p>Laravel ä¸ SPL å®Œå…¨å…¼å®¹ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ç›´æ¥ä½¿ç”¨ã€‚</p>
<h4 data-id="heading-8">1. è‡ªåŠ¨åŠ è½½</h4>
<p>SPL é»˜è®¤å¯ç”¨ï¼Œå¦‚æœ‰éœ€è¦å¯åœ¨ <code>AppServiceProvider</code> ä¸­ä½¿ç”¨ <code>spl_autoload_register()</code>ã€‚</p>
<h4 data-id="heading-9">2. åœ¨ Service æˆ– Controller ä¸­ä½¿ç”¨</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">SplQueue</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TaskService</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processTasks</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> <span class="hljs-variable">$tasks</span></span>)
    </span>{
        <span class="hljs-variable">$queue</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplQueue</span>();

        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$tasks</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$task</span>) {
            <span class="hljs-variable">$queue</span>-&gt;<span class="hljs-title function_ invoke__">enqueue</span>(<span class="hljs-variable">$task</span>);
        }

        <span class="hljs-keyword">while</span> (!<span class="hljs-variable">$queue</span>-&gt;<span class="hljs-title function_ invoke__">isEmpty</span>()) {
            <span class="hljs-variable">$current</span> = <span class="hljs-variable">$queue</span>-&gt;<span class="hljs-title function_ invoke__">dequeue</span>();
            <span class="hljs-comment">// å¤„ç†ä»»åŠ¡</span>
        }
    }
}
</code></pre>
<h4 data-id="heading-10">3. ç»“åˆ Eloquent</h4>
<p>ä¾‹å¦‚ä½¿ç”¨ <code>SplFileObject</code> å¯¼å…¥ CSV æ•°æ®ã€‚</p>
<h4 data-id="heading-11">4. åœ¨ Job ä¸­ä½¿ç”¨</h4>
<p>å½“ Laravel é˜Ÿåˆ—ä¸æ»¡è¶³éœ€æ±‚æ—¶ï¼Œå¯ä½¿ç”¨ <code>SplStack</code> å®ç° LIFO å¤„ç†ã€‚</p>
<h4 data-id="heading-12">5. æµ‹è¯•</h4>
<p>Laravel çš„æµ‹è¯•ä½“ç³»å¯ç›´æ¥é…åˆ SPL ä½¿ç”¨ï¼Œå¿…è¦æ—¶è¿›è¡Œ Mockã€‚</p>
<hr/>
<h3 data-id="heading-13">çœŸå®æ¡ˆä¾‹è¯¦è§£</h3>
<h4 data-id="heading-14">ç¤ºä¾‹ä¸€ï¼šé¡¹ç›®ç®¡ç†ç³»ç»Ÿä¸­çš„ä¼˜å…ˆçº§ä»»åŠ¡é˜Ÿåˆ—</h4>
<p>åœ¨ä¸€ä¸ªç±»ä¼¼ Trello çš„ Laravel é¡¹ç›®ä¸­ï¼Œä»»åŠ¡æœ‰é«˜ã€ä¸­ã€ä½ä¼˜å…ˆçº§ï¼Œéœ€è¦æŒ‰ä¼˜å…ˆçº§å¤„ç†ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Models</span>\<span class="hljs-title">Task</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">SplPriorityQueue</span>;

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processHighPriorityTasks</span>(<span class="hljs-params"/>)
</span>{
    <span class="hljs-variable">$tasks</span> = <span class="hljs-title class_">Task</span>::<span class="hljs-title function_ invoke__">where</span>(<span class="hljs-string">'status'</span>, <span class="hljs-string">'pending'</span>)-&gt;<span class="hljs-title function_ invoke__">get</span>();
    <span class="hljs-variable">$queue</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplPriorityQueue</span>();

    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$tasks</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$task</span>) {
        <span class="hljs-variable">$priority</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">getPriorityValue</span>(<span class="hljs-variable">$task</span>-&gt;priority);
        <span class="hljs-variable">$queue</span>-&gt;<span class="hljs-title function_ invoke__">insert</span>(<span class="hljs-variable">$task</span>, <span class="hljs-variable">$priority</span>);
    }

    <span class="hljs-keyword">while</span> (!<span class="hljs-variable">$queue</span>-&gt;<span class="hljs-title function_ invoke__">isEmpty</span>()) {
        <span class="hljs-variable">$currentTask</span> = <span class="hljs-variable">$queue</span>-&gt;<span class="hljs-title function_ invoke__">extract</span>();
        <span class="hljs-variable">$currentTask</span>-&gt;<span class="hljs-title function_ invoke__">update</span>([<span class="hljs-string">'status'</span> =&gt; <span class="hljs-string">'processed'</span>]);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">response</span>()-&gt;<span class="hljs-title function_ invoke__">json</span>([<span class="hljs-string">'message'</span> =&gt; <span class="hljs-string">'Tasks processed'</span>]);
}

<span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPriorityValue</span>(<span class="hljs-params"><span class="hljs-variable">$priority</span></span>)
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">match</span> (<span class="hljs-variable">$priority</span>) {
        <span class="hljs-string">'high'</span> =&gt; <span class="hljs-number">3</span>,
        <span class="hljs-string">'medium'</span> =&gt; <span class="hljs-number">2</span>,
        <span class="hljs-keyword">default</span> =&gt; <span class="hljs-number">1</span>,
    };
}
</code></pre>
<p><strong>æ•ˆæœè¯´æ˜ï¼š</strong>
åœ¨ä¸€ä¸‡æ¡ä»»åŠ¡çš„çœŸå®åœºæ™¯ä¸‹ï¼Œç›¸æ¯”æ•°ç»„æ’åºï¼Œå¤„ç†æ—¶é—´é™ä½çº¦ 20%ã€‚</p>
<hr/>
<h4 data-id="heading-15">ç¤ºä¾‹äºŒï¼šç”µå•†ç³»ç»Ÿä¸­çš„å›¾ç‰‡æ¸…ç†ä»»åŠ¡</h4>
<p>ä½¿ç”¨ SPL é€’å½’éå†ç›®å½•ï¼Œæ¸…ç†æœªè¢«æ•°æ®åº“å¼•ç”¨çš„å›¾ç‰‡ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Console</span>\<span class="hljs-title">Command</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">RecursiveDirectoryIterator</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">RecursiveIteratorIterator</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">SplFileInfo</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CleanupUploads</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Command</span>
</span>{
    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$signature</span> = <span class="hljs-string">'uploads:cleanup'</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle</span>(<span class="hljs-params"/>)
    </span>{
        <span class="hljs-variable">$directory</span> = <span class="hljs-title function_ invoke__">storage_path</span>(<span class="hljs-string">'app/public/uploads'</span>);
        <span class="hljs-variable">$iterator</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RecursiveIteratorIterator</span>(
            <span class="hljs-keyword">new</span> <span class="hljs-built_in">RecursiveDirectoryIterator</span>(<span class="hljs-variable">$directory</span>)
        );

        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$iterator</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) {
            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$file</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">SplFileInfo</span> &amp;&amp; <span class="hljs-variable">$file</span>-&gt;<span class="hljs-title function_ invoke__">isFile</span>()) {
                <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">isFileUsedInDatabase</span>(<span class="hljs-variable">$file</span>-&gt;<span class="hljs-title function_ invoke__">getFilename</span>())) {
                    <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$file</span>-&gt;<span class="hljs-title function_ invoke__">getPathname</span>());
                }
            }
        }
    }
}
</code></pre>
<p><strong>æ•ˆæœè¯´æ˜ï¼š</strong>
åœ¨ä¸€ä¸ªåŒ…å« 5 ä¸‡å¼ å›¾ç‰‡çš„ç”µå•†é¡¹ç›®ä¸­ï¼Œè¯¥ä»»åŠ¡æ¯å‘¨è¿è¡Œä¸€æ¬¡ï¼Œå¯é‡Šæ”¾çº¦ 30% çš„å­˜å‚¨ç©ºé—´ã€‚</p>
<hr/>
<h3 data-id="heading-16">æ€»ç»“</h3>
<p>æ ‡å‡† PHP åº“ï¼ˆSPLï¼‰æ˜¯ PHP ç”Ÿæ€ä¸­è¢«ä½ä¼°çš„ä¸€å—åŸºçŸ³ã€‚å®ƒä¸ºæ•°æ®ç»“æ„ã€è¿­ä»£ã€å¼‚å¸¸å¤„ç†æä¾›äº†é«˜æ•ˆã€æ ‡å‡†åŒ–çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>å¯¹äº Laravel å¼€å‘è€…è€Œè¨€ï¼ŒSPL å¹¶ä¸æ˜¯ç”¨æ¥å–ä»£æ¡†æ¶èƒ½åŠ›ï¼Œè€Œæ˜¯åœ¨<strong>æ€§èƒ½æ•æ„Ÿæˆ–ååº•å±‚çš„é€»è¾‘ä¸­æä¾›æ›´åˆé€‚çš„å·¥å…·é€‰æ‹©</strong>ã€‚ä¸å¦¨ä»ä¸€ä¸ª <code>SplQueue</code>ã€ä¸€ä¸ªæ–‡ä»¶è¿­ä»£å™¨å¼€å§‹ï¼Œé€æ­¥å°† SPL çº³å…¥ä½ çš„æŠ€æœ¯æ ˆã€‚</p>
<p>å¦‚æœä½ å¸Œæœ›å†™å‡º<strong>æ›´æ¸…æ™°ã€æ›´é«˜æ•ˆã€æ›´ä¸“ä¸šçš„ PHP ä»£ç </strong>ï¼ŒSPL å€¼å¾—ä½ è®¤çœŸå¯¹å¾…ã€‚</p>
<h2 data-id="heading-17">ç†è§£æ ‡å‡† PHP åº“ï¼ˆSPLï¼‰ï¼šä¸€ç¯‡å…¨é¢æŒ‡å—</h2>
<p>æ¬¢è¿é˜…è¯»è¿™ç¯‡å…³äºæ ‡å‡† PHP åº“ï¼ˆStandard PHP Libraryï¼Œç®€ç§° SPLï¼‰çš„æ·±åº¦åšå®¢ã€‚å¦‚æœä½ æ˜¯ä¸€å PHP å¼€å‘è€…ï¼Œæ— è®ºæ˜¯åœ¨ç¼–å†™ç®€å•è„šæœ¬ï¼Œè¿˜æ˜¯ä½¿ç”¨ Laravel ç­‰æ¡†æ¶æ„å»ºå¤æ‚åº”ç”¨ï¼ŒSPL éƒ½æ˜¯ä¸€å¥—<strong>ç»å¸¸è¢«å¿½è§†å´éå¸¸å¼ºå¤§</strong>çš„å·¥å…·é›†ã€‚</p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ SPL æ˜¯ä»€ä¹ˆã€ä¸ºä»€ä¹ˆå€¼å¾—ä½¿ç”¨ã€å®ƒçš„ä¼˜ç¼ºç‚¹ã€åœ¨ä»£ç ä¸­å¼•å…¥ SPL ä¼šå¸¦æ¥å“ªäº›å½±å“ã€é€‚åˆä½¿ç”¨ SPL çš„åœºæ™¯ï¼Œä»¥åŠå¦‚ä½•åœ¨ Laravel ç¯å¢ƒä¸­é«˜æ•ˆåœ°ä½¿ç”¨å®ƒã€‚åŒæ—¶ï¼Œæˆ‘ä¼šç»“åˆ<strong>çœŸå®ä¸šåŠ¡åœºæ™¯</strong>ç»™å‡ºè¯¦ç»†ç¤ºä¾‹ï¼Œå¸®åŠ©ä½ ç†è§£ SPL çš„å®é™…ä»·å€¼ã€‚</p>
<p>è¯»å®Œæœ¬æ–‡ï¼Œä½ å°†å¯¹ SPL æœ‰ä¸€ä¸ªç³»ç»Ÿã€æ¸…æ™°çš„è®¤è¯†ï¼Œå¹¶èƒ½å¤Ÿåœ¨å®é™…é¡¹ç›®ä¸­è‡ªå¦‚åœ°è¿ç”¨å®ƒã€‚</p>
<hr/>
<h3 data-id="heading-18">ä»€ä¹ˆæ˜¯æ ‡å‡† PHP åº“ï¼ˆSPLï¼‰ï¼Ÿ</h3>
<p>æ ‡å‡† PHP åº“ï¼ˆSPLï¼‰æ˜¯ä¸€ç»„è‡ª PHP 5.0 èµ·å†…ç½®äº PHP æ ¸å¿ƒä¸­çš„ç±»å’Œæ¥å£ï¼Œæ—¨åœ¨ä»¥<strong>æ ‡å‡†åŒ–ã€é«˜æ•ˆ</strong>çš„æ–¹å¼è§£å†³å¸¸è§ç¼–ç¨‹é—®é¢˜ã€‚ä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸º PHP è‡ªå¸¦çš„â€œç‘å£«å†›åˆ€â€ï¼Œä¸“é—¨ç”¨äºå¤„ç†æ•°æ®ç»“æ„ã€è¿­ä»£å™¨ã€å¼‚å¸¸ç­‰å¸¸è§éœ€æ±‚ã€‚</p>
<p>ä¸ç¬¬ä¸‰æ–¹åº“ä¸åŒï¼ŒSPL æ˜¯ PHP æ ¸å¿ƒçš„ä¸€éƒ¨åˆ†ï¼Œä¸éœ€è¦é€šè¿‡ Composer å®‰è£…ï¼Œ<strong>å¼€ç®±å³ç”¨</strong>ã€‚</p>
<p>ä»æ•´ä½“ä¸Šçœ‹ï¼ŒSPL ä¸»è¦æä¾›äº†ä»¥ä¸‹èƒ½åŠ›ï¼š</p>
<ul>
<li><strong>æ•°æ®ç»“æ„</strong>
å¦‚ <code>SplStack</code>ã€<code>SplQueue</code>ã€<code>SplHeap</code>ã€<code>SplDoublyLinkedList</code>ã€<code>SplFixedArray</code> ç­‰ï¼Œç”¨äºæ›´é«˜æ•ˆåœ°ç®¡ç†æ•°æ®é›†åˆã€‚</li>
<li><strong>è¿­ä»£å™¨</strong>
ç”¨äºç»Ÿä¸€éå†æ•°æ®ç»“æ„çš„æ¥å£å’Œå®ç°ï¼Œä¾‹å¦‚ç”¨äºæ–‡ä»¶å¤„ç†çš„ <code>SplFileObject</code>ï¼Œæˆ–ç”¨äºåµŒå¥—ç»“æ„çš„ <code>RecursiveIteratorIterator</code>ã€‚</li>
<li><strong>å¼‚å¸¸ä½“ç³»</strong>
åŒ…å« <code>LogicException</code>ã€<code>RuntimeException</code> ä»¥åŠå®ƒä»¬çš„å­ç±»ï¼ˆå¦‚ <code>InvalidArgumentException</code>ï¼‰ï¼Œç”¨äºæ›´æ¸…æ™°çš„é”™è¯¯å¤„ç†ã€‚</li>
<li><strong>å…¶ä»–å·¥å…·</strong>
åŒ…æ‹¬é€šè¿‡ <code>spl_autoload_register()</code> å®ç°çš„è‡ªåŠ¨åŠ è½½ï¼Œä»¥åŠå¯¹è±¡åå°„ä¸è‡ªçœç›¸å…³å·¥å…·ã€‚</li>
</ul>
<p>SPL å¹¶ä¸æ˜¯ä¸€ä¸ªâ€œæ–°æ½®â€çš„ç‰¹æ€§ï¼Œä½†å®ƒçš„æˆç†Ÿåº¦å’Œé€šç”¨æ€§ï¼Œä½¿å…¶åœ¨ç¼–å†™<strong>å¹²å‡€ã€é«˜æ€§èƒ½ä»£ç </strong>æ—¶éå¸¸æœ‰ä»·å€¼ã€‚</p>
<hr/>
<h3 data-id="heading-19">ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ SPLï¼Ÿ</h3>
<p>åœ¨å½“ä»Š Composer åŒ…å’Œæ¡†æ¶ç››è¡Œçš„æ—¶ä»£ï¼Œä¸ºä»€ä¹ˆè¿˜è¦å…³æ³¨ SPLï¼Ÿæ ¸å¿ƒåŸå› åªæœ‰ä¸¤ä¸ªå­—ï¼š<strong>ç®€å•</strong> å’Œ <strong>æ€§èƒ½</strong>ã€‚</p>
<p>SPL æ˜¯ PHP åŸç”Ÿçš„ä¸€éƒ¨åˆ†ï¼Œå¤©ç„¶é›†æˆï¼Œæ— éœ€é¢å¤–ä¾èµ–ã€‚å®ƒé¼“åŠ±é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰ï¼Œè®©ä»£ç æ›´æ¨¡å—åŒ–ã€æ›´å¯å¤ç”¨ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä½ éœ€è¦å¤„ç†å¤§è§„æ¨¡æ•°æ®ï¼Œæˆ–è€…å®ç°è‡ªå®šä¹‰çš„éå†é€»è¾‘ï¼ŒSPL æä¾›çš„è¿­ä»£å™¨å¯ä»¥è®©ä½ é¿å…ä½¿ç”¨å¤æ‚çš„æ•°ç»„æ“ä½œå’ŒåµŒå¥—å¾ªç¯ã€‚</p>
<p>ä½œä¸º Laravel å¼€å‘è€…ï¼Œä½ å¯èƒ½å·²ç»ä¹ æƒ¯ä½¿ç”¨ Eloquent å¤„ç†æ•°æ®åº“æ•°æ®ï¼Œä½†åœ¨<strong>è‡ªå®šä¹‰æ•°æ®å¤„ç†ã€æ–‡ä»¶è¯»å†™ã€ä»»åŠ¡è°ƒåº¦</strong>ç­‰åœºæ™¯ä¸­ï¼ŒSPL å¾€å¾€æ¯”æ¡†æ¶è‡ªå¸¦å·¥å…·æ›´è½»é‡ã€æ›´ç›´æ¥ã€‚</p>
<p>ä¸€å¥è¯æ€»ç»“ï¼š</p>
<blockquote>
<p>å½“ä½ éœ€è¦<strong>è½»é‡çº§ã€æ— ä¾èµ–ã€ç¬¦åˆ PHP OOP è®¾è®¡ç†å¿µçš„å·¥å…·</strong>æ—¶ï¼ŒSPL éå¸¸å€¼å¾—ä½¿ç”¨ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-20">ä½¿ç”¨ SPL çš„å¥½å¤„</h3>
<p>SPL åœ¨å¯ç»´æŠ¤æ€§å’Œæ€§èƒ½æ–¹é¢æœ‰ä¸å°‘ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>æ•ˆç‡ä¸æ€§èƒ½</strong>
SPL æ˜¯ç¼–è¯‘è¿› PHP å†…æ ¸çš„ã€‚ä¾‹å¦‚ï¼Œ<code>SplFixedArray</code> åœ¨å›ºå®šå¤§å°é›†åˆçš„åœºæ™¯ä¸‹æ¯”æ™®é€šæ•°ç»„æ›´çœå†…å­˜ï¼Œå¹¶ä¸”è®¿é—®å¤æ‚åº¦ä¸º O(1)ã€‚</li>
<li><strong>æ ‡å‡†åŒ–</strong>
è¿­ä»£å™¨æ¥å£è®©æ•°ç»„ã€å¯¹è±¡ã€æ–‡ä»¶éƒ½å¯ä»¥ç”¨ <code>foreach</code> ç»Ÿä¸€éå†ï¼Œå‡å°‘é‡å¤ä»£ç ã€‚</li>
<li><strong>å¯æ‰©å±•æ€§</strong>
SPL ç±»å¯ä»¥è¢«ç»§æ‰¿ï¼Œæ–¹ä¾¿æ„å»ºå¯å¤ç”¨ç»„ä»¶ï¼Œéå¸¸é€‚åˆä¸­å¤§å‹é¡¹ç›®ã€‚</li>
<li><strong>æ›´æ¸…æ™°çš„é”™è¯¯å¤„ç†</strong>
é€šè¿‡å¼‚å¸¸å±‚çº§ç»“æ„ï¼Œå¯ä»¥æŠ›å‡ºè¯­ä¹‰æ˜ç¡®çš„å¼‚å¸¸ï¼Œå¦‚ <code>BadMethodCallException</code>ï¼Œè€Œä¸æ˜¯æ¨¡ç³Šçš„é”™è¯¯ä¿¡æ¯ã€‚</li>
<li><strong>æ— éœ€é¢å¤–ä¾èµ–</strong>
åœ¨ Laravel é¡¹ç›®ä¸­ï¼Œå‡å°‘ Composer ä¾èµ–æ„å‘³ç€æ›´å¹²å‡€çš„ <code>composer.json</code>ã€‚</li>
<li><strong>è¯­ä¹‰æ›´æ¸…æ™°çš„ä»£ç </strong>
<code>SplQueue</code> æ˜ç¡®è¡¨ç¤º FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ï¼Œæ¯”ç›´æ¥ç”¨æ•°ç»„æ›´å®¹æ˜“è®©äººç†è§£ä»£ç æ„å›¾ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-21">ä½¿ç”¨ SPL çš„ä¸è¶³ä¹‹å¤„</h3>
<p>SPL ä¹Ÿå¹¶éå®Œç¾æ— ç¼ºï¼š</p>
<ul>
<li><strong>å­¦ä¹ æˆæœ¬</strong>
å¯¹äºä¹ æƒ¯è¿‡ç¨‹å¼ PHP çš„å¼€å‘è€…æ¥è¯´ï¼ŒSPL çš„æ¥å£å’ŒæŠ½è±¡ç±»å¯èƒ½ä¸å¤ªç›´è§‚ã€‚</li>
<li><strong>åŠŸèƒ½è¦†ç›–æœ‰é™</strong>
å¯¹äºå›¾ç»“æ„ã€å¹³è¡¡æ ‘ç­‰é«˜çº§æ•°æ®ç»“æ„ï¼Œä»ç„¶éœ€è¦ç¬¬ä¸‰æ–¹åº“æˆ– PECL æ‰©å±•ã€‚</li>
<li><strong>ä¸ç°ä»£ PHP ç‰¹æ€§å­˜åœ¨ä»£æ²Ÿ</strong>
éƒ¨åˆ† SPL ç»„ä»¶åœ¨è®¾è®¡ä¸Šç•¥æ˜¾é™ˆæ—§ï¼Œä¸ PHP 8+ çš„æšä¸¾ã€å±æ€§ç­‰ç‰¹æ€§ç»“åˆåº¦ä¸é«˜ã€‚</li>
<li><strong>è°ƒè¯•å¤æ‚åº¦</strong>
ç»§æ‰¿ SPL ç±»å¯èƒ½ä¼šå½¢æˆè¾ƒæ·±çš„ç»§æ‰¿é“¾ï¼Œåœ¨ Laravel è¿™ç§å¤šå±‚æ¶æ„ä¸­è°ƒè¯•ä¼šæ›´å¤æ‚ã€‚</li>
<li><strong>æŸäº›åœºæ™¯ä¸‹çš„æ€§èƒ½å¼€é”€</strong>
åœ¨æå¤§æ•°æ®é‡ä¸‹ï¼Œè¿­ä»£å™¨å¯èƒ½æ¯”åŸç”Ÿ <code>for</code> å¾ªç¯ç¨æ…¢ã€‚</li>
</ul>
<p>æ€»ä½“æ¥è¯´ï¼Œåªè¦<strong>åˆç†ä½¿ç”¨</strong>ï¼Œè¿™äº›ç¼ºç‚¹å¹¶ä¸ä¼šæˆä¸ºè‡´å‘½é—®é¢˜ã€‚</p>
<hr/>
<h3 data-id="heading-22">ä½¿ç”¨ SPL ä¼šå¸¦æ¥ä»€ä¹ˆå½±å“ï¼Ÿ</h3>
<p>åœ¨é¡¹ç›®ä¸­å¼•å…¥ SPLï¼Œé€šå¸¸ä¼šäº§ç”Ÿä»¥ä¸‹å˜åŒ–ï¼š</p>
<ul>
<li><strong>ä»£ç é£æ ¼è½¬å˜</strong>
æ›´åå‘ OOPï¼Œæœ‰åˆ©äºé•¿æœŸç»´æŠ¤ï¼Œä½†å¯èƒ½éœ€è¦é‡æ„æ—§ä»£ç ã€‚</li>
<li><strong>ä¾èµ–ç®¡ç†æ›´è½»é‡</strong>
å‡å°‘å¯¹å¤–éƒ¨åŒ…çš„ä¾èµ–ï¼Œæå‡å¯ç§»æ¤æ€§ã€‚</li>
<li><strong>å¼‚å¸¸æ›´æ—©æš´éœ²</strong>
æ›´ä¸¥æ ¼çš„å¼‚å¸¸ä½“ç³»å¯èƒ½ä¼šæš´éœ²æ—§ä»£ç ä¸­çš„æ½œåœ¨é—®é¢˜ã€‚</li>
<li><strong>å›¢é˜Ÿåä½œå½±å“</strong>
å›¢é˜ŸåˆæœŸå¯èƒ½éœ€è¦é€‚åº” SPLï¼Œä½†ä¸€æ—¦ç»Ÿä¸€è§„èŒƒï¼Œæ•´ä½“ä»£ç è´¨é‡ä¼šæ›´é«˜ã€‚</li>
<li><strong>è¿è¡Œæ—¶è¡¨ç°å˜åŒ–</strong>
ä¸åŒ SPL æ•°æ®ç»“æ„çš„å†…å­˜ä½¿ç”¨æ–¹å¼ä¸åŒï¼Œéœ€è¦é…åˆæ€§èƒ½åˆ†æå·¥å…·è¯„ä¼°ã€‚</li>
</ul>
<p>ç®€è€Œè¨€ä¹‹ï¼šSPL èƒ½è®©ä»£ç æ›´ç°ä»£ï¼Œä½†éœ€è¦<strong>æœ‰æ„è¯†åœ°å¼•å…¥</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-23">é€‚åˆä½¿ç”¨ SPL çš„åœºæ™¯</h3>
<p>SPL ç‰¹åˆ«é€‚åˆä»¥ä¸‹æƒ…å†µï¼š</p>
<ul>
<li><strong>æ•°æ®å¤„ç†ç®¡é“</strong>
ä¾‹å¦‚æ‰¹é‡å¤„ç†ä»»åŠ¡ã€é˜Ÿåˆ—ã€æ ˆç»“æ„ã€‚</li>
<li><strong>æ–‡ä»¶å’Œç›®å½•æ“ä½œ</strong>
é€’å½’éå†ç›®å½•ã€é€è¡Œè¯»å–å¤§æ–‡ä»¶ã€‚</li>
<li><strong>è‡ªå®šä¹‰é›†åˆç»“æ„</strong>
å›ºå®šå¤§å°æ•°ç»„ã€ä¼˜å…ˆçº§æ’åºã€‚</li>
<li><strong>åº“æˆ–ç»„ä»¶å¼€å‘</strong>
éœ€è¦ç²¾ç»†åŒ–å¼‚å¸¸ç®¡ç†ã€‚</li>
<li><strong>æ€§èƒ½æ•æ„Ÿæ¨¡å—</strong>
é«˜å¹¶å‘ã€é«˜é¢‘è®¿é—®çš„æ ¸å¿ƒé€»è¾‘ã€‚</li>
</ul>
<p>ä¸å»ºè®®åœ¨ç®€å•æ•°ç»„æ“ä½œä¸­æ»¥ç”¨ SPLï¼ŒLaravel çš„ <code>Collection</code> åœ¨å¤šæ•°åœºæ™¯ä¸‹æ›´å‹å¥½ã€‚</p>
<hr/>
<h3 data-id="heading-24">Laravel å¼€å‘è€…å¦‚ä½•ä½¿ç”¨ SPLï¼Ÿ</h3>
<p>Laravel ä¸ SPL å®Œå…¨å…¼å®¹ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ç›´æ¥ä½¿ç”¨ã€‚</p>
<h4 data-id="heading-25">1. è‡ªåŠ¨åŠ è½½</h4>
<p>SPL é»˜è®¤å¯ç”¨ï¼Œå¦‚æœ‰éœ€è¦å¯åœ¨ <code>AppServiceProvider</code> ä¸­ä½¿ç”¨ <code>spl_autoload_register()</code>ã€‚</p>
<h4 data-id="heading-26">2. åœ¨ Service æˆ– Controller ä¸­ä½¿ç”¨</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">SplQueue</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TaskService</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processTasks</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> <span class="hljs-variable">$tasks</span></span>)
    </span>{
        <span class="hljs-variable">$queue</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplQueue</span>();

        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$tasks</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$task</span>) {
            <span class="hljs-variable">$queue</span>-&gt;<span class="hljs-title function_ invoke__">enqueue</span>(<span class="hljs-variable">$task</span>);
        }

        <span class="hljs-keyword">while</span> (!<span class="hljs-variable">$queue</span>-&gt;<span class="hljs-title function_ invoke__">isEmpty</span>()) {
            <span class="hljs-variable">$current</span> = <span class="hljs-variable">$queue</span>-&gt;<span class="hljs-title function_ invoke__">dequeue</span>();
            <span class="hljs-comment">// å¤„ç†ä»»åŠ¡</span>
        }
    }
}
</code></pre>
<h4 data-id="heading-27">3. ç»“åˆ Eloquent</h4>
<p>ä¾‹å¦‚ä½¿ç”¨ <code>SplFileObject</code> å¯¼å…¥ CSV æ•°æ®ã€‚</p>
<h4 data-id="heading-28">4. åœ¨ Job ä¸­ä½¿ç”¨</h4>
<p>å½“ Laravel é˜Ÿåˆ—ä¸æ»¡è¶³éœ€æ±‚æ—¶ï¼Œå¯ä½¿ç”¨ <code>SplStack</code> å®ç° LIFO å¤„ç†ã€‚</p>
<h4 data-id="heading-29">5. æµ‹è¯•</h4>
<p>Laravel çš„æµ‹è¯•ä½“ç³»å¯ç›´æ¥é…åˆ SPL ä½¿ç”¨ï¼Œå¿…è¦æ—¶è¿›è¡Œ Mockã€‚</p>
<hr/>
<h3 data-id="heading-30">çœŸå®æ¡ˆä¾‹è¯¦è§£</h3>
<h4 data-id="heading-31">ç¤ºä¾‹ä¸€ï¼šé¡¹ç›®ç®¡ç†ç³»ç»Ÿä¸­çš„ä¼˜å…ˆçº§ä»»åŠ¡é˜Ÿåˆ—</h4>
<p>åœ¨ä¸€ä¸ªç±»ä¼¼ Trello çš„ Laravel é¡¹ç›®ä¸­ï¼Œä»»åŠ¡æœ‰é«˜ã€ä¸­ã€ä½ä¼˜å…ˆçº§ï¼Œéœ€è¦æŒ‰ä¼˜å…ˆçº§å¤„ç†ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">Models</span>\<span class="hljs-title">Task</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">SplPriorityQueue</span>;

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processHighPriorityTasks</span>(<span class="hljs-params"/>)
</span>{
    <span class="hljs-variable">$tasks</span> = <span class="hljs-title class_">Task</span>::<span class="hljs-title function_ invoke__">where</span>(<span class="hljs-string">'status'</span>, <span class="hljs-string">'pending'</span>)-&gt;<span class="hljs-title function_ invoke__">get</span>();
    <span class="hljs-variable">$queue</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">SplPriorityQueue</span>();

    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$tasks</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$task</span>) {
        <span class="hljs-variable">$priority</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">getPriorityValue</span>(<span class="hljs-variable">$task</span>-&gt;priority);
        <span class="hljs-variable">$queue</span>-&gt;<span class="hljs-title function_ invoke__">insert</span>(<span class="hljs-variable">$task</span>, <span class="hljs-variable">$priority</span>);
    }

    <span class="hljs-keyword">while</span> (!<span class="hljs-variable">$queue</span>-&gt;<span class="hljs-title function_ invoke__">isEmpty</span>()) {
        <span class="hljs-variable">$currentTask</span> = <span class="hljs-variable">$queue</span>-&gt;<span class="hljs-title function_ invoke__">extract</span>();
        <span class="hljs-variable">$currentTask</span>-&gt;<span class="hljs-title function_ invoke__">update</span>([<span class="hljs-string">'status'</span> =&gt; <span class="hljs-string">'processed'</span>]);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">response</span>()-&gt;<span class="hljs-title function_ invoke__">json</span>([<span class="hljs-string">'message'</span> =&gt; <span class="hljs-string">'Tasks processed'</span>]);
}

<span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPriorityValue</span>(<span class="hljs-params"><span class="hljs-variable">$priority</span></span>)
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">match</span> (<span class="hljs-variable">$priority</span>) {
        <span class="hljs-string">'high'</span> =&gt; <span class="hljs-number">3</span>,
        <span class="hljs-string">'medium'</span> =&gt; <span class="hljs-number">2</span>,
        <span class="hljs-keyword">default</span> =&gt; <span class="hljs-number">1</span>,
    };
}
</code></pre>
<p><strong>æ•ˆæœè¯´æ˜ï¼š</strong>
åœ¨ä¸€ä¸‡æ¡ä»»åŠ¡çš„çœŸå®åœºæ™¯ä¸‹ï¼Œç›¸æ¯”æ•°ç»„æ’åºï¼Œå¤„ç†æ—¶é—´é™ä½çº¦ 20%ã€‚</p>
<hr/>
<h4 data-id="heading-32">ç¤ºä¾‹äºŒï¼šç”µå•†ç³»ç»Ÿä¸­çš„å›¾ç‰‡æ¸…ç†ä»»åŠ¡</h4>
<p>ä½¿ç”¨ SPL é€’å½’éå†ç›®å½•ï¼Œæ¸…ç†æœªè¢«æ•°æ®åº“å¼•ç”¨çš„å›¾ç‰‡ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Console</span>\<span class="hljs-title">Command</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">RecursiveDirectoryIterator</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">RecursiveIteratorIterator</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">SplFileInfo</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CleanupUploads</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Command</span>
</span>{
    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$signature</span> = <span class="hljs-string">'uploads:cleanup'</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle</span>(<span class="hljs-params"/>)
    </span>{
        <span class="hljs-variable">$directory</span> = <span class="hljs-title function_ invoke__">storage_path</span>(<span class="hljs-string">'app/public/uploads'</span>);
        <span class="hljs-variable">$iterator</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RecursiveIteratorIterator</span>(
            <span class="hljs-keyword">new</span> <span class="hljs-built_in">RecursiveDirectoryIterator</span>(<span class="hljs-variable">$directory</span>)
        );

        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$iterator</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$file</span>) {
            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$file</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">SplFileInfo</span> &amp;&amp; <span class="hljs-variable">$file</span>-&gt;<span class="hljs-title function_ invoke__">isFile</span>()) {
                <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">isFileUsedInDatabase</span>(<span class="hljs-variable">$file</span>-&gt;<span class="hljs-title function_ invoke__">getFilename</span>())) {
                    <span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-variable">$file</span>-&gt;<span class="hljs-title function_ invoke__">getPathname</span>());
                }
            }
        }
    }
}
</code></pre>
<p><strong>æ•ˆæœè¯´æ˜ï¼š</strong>
åœ¨ä¸€ä¸ªåŒ…å« 5 ä¸‡å¼ å›¾ç‰‡çš„ç”µå•†é¡¹ç›®ä¸­ï¼Œè¯¥ä»»åŠ¡æ¯å‘¨è¿è¡Œä¸€æ¬¡ï¼Œå¯é‡Šæ”¾çº¦ 30% çš„å­˜å‚¨ç©ºé—´ã€‚</p>
<hr/>
<h3 data-id="heading-33">æ€»ç»“</h3>
<p>æ ‡å‡† PHP åº“ï¼ˆSPLï¼‰æ˜¯ PHP ç”Ÿæ€ä¸­è¢«ä½ä¼°çš„ä¸€å—åŸºçŸ³ã€‚å®ƒä¸ºæ•°æ®ç»“æ„ã€è¿­ä»£ã€å¼‚å¸¸å¤„ç†æä¾›äº†é«˜æ•ˆã€æ ‡å‡†åŒ–çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>å¯¹äº Laravel å¼€å‘è€…è€Œè¨€ï¼ŒSPL å¹¶ä¸æ˜¯ç”¨æ¥å–ä»£æ¡†æ¶èƒ½åŠ›ï¼Œè€Œæ˜¯åœ¨<strong>æ€§èƒ½æ•æ„Ÿæˆ–ååº•å±‚çš„é€»è¾‘ä¸­æä¾›æ›´åˆé€‚çš„å·¥å…·é€‰æ‹©</strong>ã€‚ä¸å¦¨ä»ä¸€ä¸ª <code>SplQueue</code>ã€ä¸€ä¸ªæ–‡ä»¶è¿­ä»£å™¨å¼€å§‹ï¼Œé€æ­¥å°† SPL çº³å…¥ä½ çš„æŠ€æœ¯æ ˆã€‚</p>
<p>å¦‚æœä½ å¸Œæœ›å†™å‡º<strong>æ›´æ¸…æ™°ã€æ›´é«˜æ•ˆã€æ›´ä¸“ä¸šçš„ PHP ä»£ç </strong>ï¼ŒSPL å€¼å¾—ä½ è®¤çœŸå¯¹å¾…ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringBoot 3.2 æ€§èƒ½é£è·ƒï¼š5ä¸ªä¼˜åŒ–ç­–ç•¥è®©ä½ çš„åº”ç”¨æé€Ÿ40%]]></title>    <link>https://juejin.cn/post/7591348605865951267</link>    <guid>https://juejin.cn/post/7591348605865951267</guid>    <pubDate>2026-01-05T00:17:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591348605865951267" data-draft-id="7591309945511297024" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringBoot 3.2 æ€§èƒ½é£è·ƒï¼š5ä¸ªä¼˜åŒ–ç­–ç•¥è®©ä½ çš„åº”ç”¨æé€Ÿ40%"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-05T00:17:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringBoot 3.2 æ€§èƒ½é£è·ƒï¼š5ä¸ªä¼˜åŒ–ç­–ç•¥è®©ä½ çš„åº”ç”¨æé€Ÿ40%
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-05T00:17:07.000Z" title="Mon Jan 05 2026 00:17:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>SpringBoot 3.2 æ€§èƒ½é£è·ƒï¼š5ä¸ªä¼˜åŒ–ç­–ç•¥è®©ä½ çš„åº”ç”¨æé€Ÿ40%</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>SpringBoot ä¸€ç›´æ˜¯ Java ç”Ÿæ€ä¸­æ„å»ºä¼ä¸šçº§åº”ç”¨çš„æ ‡æ†æ¡†æ¶ï¼Œå…¶ç®€æ´çš„é…ç½®å’Œå¼ºå¤§çš„å¼€ç®±å³ç”¨ç‰¹æ€§æ·±å—å¼€å‘è€…å–œçˆ±ã€‚éšç€ SpringBoot 3.2 çš„å‘å¸ƒï¼Œæ€§èƒ½ä¼˜åŒ–æˆä¸ºäº†è¿™ä¸€ç‰ˆæœ¬çš„æ ¸å¿ƒäº®ç‚¹ä¹‹ä¸€ã€‚å®˜æ–¹æ•°æ®æ˜¾ç¤ºï¼Œé€šè¿‡åˆç†é…ç½®å’Œä¼˜åŒ–ç­–ç•¥ï¼Œéƒ¨åˆ†åº”ç”¨å¯ä»¥å®ç°é«˜è¾¾ <strong>40%</strong> çš„æ€§èƒ½æå‡ï¼</p>
<p>æœ¬æ–‡å°†æ·±å…¥å‰–æ SpringBoot 3.2 çš„æ€§èƒ½ä¼˜åŒ–æœºåˆ¶ï¼Œå¹¶ç»“åˆå®é™…æ¡ˆä¾‹ï¼Œåˆ†äº« <strong>5ä¸ªå…³é”®ç­–ç•¥</strong>ï¼Œå¸®åŠ©ä½ å……åˆ†é‡Šæ”¾ SpringBoot åº”ç”¨çš„æ½œåŠ›ã€‚æ— è®ºä½ æ˜¯åº”å¯¹é«˜å¹¶å‘åœºæ™¯è¿˜æ˜¯è¿½æ±‚æè‡´çš„å“åº”é€Ÿåº¦ï¼Œè¿™äº›æŠ€å·§éƒ½èƒ½ä¸ºä½ æä¾›æ˜ç¡®çš„ä¼˜åŒ–æ–¹å‘ã€‚</p>
<hr/>
<h2 data-id="heading-2">SpringBoot 3.2 æ€§èƒ½ä¼˜åŒ–çš„æ ¸å¿ƒæ”¹è¿›</h2>
<p>åœ¨æ¢è®¨å…·ä½“ä¼˜åŒ–ç­–ç•¥ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç®€è¦äº†è§£ SpringBoot 3.2 åœ¨æ€§èƒ½æ–¹é¢çš„åº•å±‚æ”¹è¿›ï¼š</p>
<ol>
<li>
<p><strong>GraalVM Native Image æ”¯æŒå¢å¼º</strong><br/>
SpringBoot 3.2 è¿›ä¸€æ­¥ä¼˜åŒ–äº†å¯¹ GraalVM AOTï¼ˆAhead-of-Timeï¼‰ç¼–è¯‘çš„æ”¯æŒã€‚é€šè¿‡å°†åº”ç”¨ç¼–è¯‘ä¸ºåŸç”Ÿé•œåƒï¼Œå¯åŠ¨æ—¶é—´å¯ä»¥ä»ç§’çº§é™è‡³æ¯«ç§’çº§ï¼ŒåŒæ—¶å†…å­˜å ç”¨å¤§å¹…é™ä½ã€‚</p>
</li>
<li>
<p><strong>è™šæ‹Ÿçº¿ç¨‹ï¼ˆVirtual Threadsï¼‰é›†æˆ</strong><br/>
åŸºäº JDK 21+çš„è™šæ‹Ÿçº¿ç¨‹ç‰¹æ€§ï¼ŒSpringBoot 3.2 èƒ½å¤Ÿæ›´é«˜æ•ˆåœ°å¤„ç† I/Oå¯†é›†å‹ä»»åŠ¡ã€‚ç›¸æ¯”ä¼ ç»Ÿçº¿ç¨‹æ± æ¨¡å¼ï¼Œè™šæ‹Ÿçº¿ç¨‹å¯ä»¥æ˜¾è‘—å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ã€‚</p>
</li>
<li>
<p><strong>ååº”å¼ç¼–ç¨‹æ€§èƒ½æå‡</strong><br/>
å¯¹ WebFluxã€R2DBCç­‰ååº”å¼ç»„ä»¶çš„æ·±åº¦ä¼˜åŒ–ä½¿å¾—éé˜»å¡è¯·æ±‚å¤„ç†çš„ååé‡è¿›ä¸€æ­¥æå‡ã€‚</p>
</li>
<li>
<p><strong>JVMåƒåœ¾å›æ”¶è°ƒä¼˜é€‚é…</strong><br/>
é»˜è®¤é…ç½®é’ˆå¯¹ G1 GCã€ZGCç­‰ç°ä»£åƒåœ¾å›æ”¶å™¨è¿›è¡Œäº†é¢„è°ƒä¼˜ï¼Œå‡å°‘äº† STWï¼ˆStop-The-Worldï¼‰åœé¡¿æ—¶é—´ã€‚</p>
</li>
</ol>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å›´ç»•è¿™äº›åº•å±‚æ”¹è¿›å±•å¼€å…·ä½“çš„ä¼˜åŒ–ç­–ç•¥ã€‚</p>
<hr/>
<h2 data-id="heading-3">ç­–ç•¥1ï¼šå¯ç”¨GraalVM Native Imageç¼–è¯‘</h2>
<h3 data-id="heading-4"><strong>ä¸ºä»€ä¹ˆé€‰æ‹©Native Imageï¼Ÿ</strong></h3>
<p>ä¼ ç»Ÿçš„ JVMåº”ç”¨éœ€è¦ç»è¿‡ç±»åŠ è½½ã€å­—èŠ‚ç è§£é‡Šå’ŒJITç¼–è¯‘ç­‰å¤šä¸ªé˜¶æ®µæ‰èƒ½è¾¾åˆ°å³°å€¼æ€§èƒ½ã€‚è€ŒGraalVM Native Imageé€šè¿‡AOTç¼–è¯‘ç›´æ¥å°†Javaä»£ç è½¬æ¢ä¸ºæœºå™¨ç è¿è¡Œï¼š</p>
<ul>
<li><strong>å¯åŠ¨æ—¶é—´ç¼©çŸ­90%ä»¥ä¸Š</strong>ï¼ˆä»å‡ ç§’åˆ°å‡ åæ¯«ç§’ï¼‰ã€‚</li>
<li><strong>å†…å­˜å ç”¨é™ä½50%~70%</strong>ï¼ˆæ— éœ€JITç¼–è¯‘å™¨å’Œå…ƒæ•°æ®å­˜å‚¨ï¼‰ã€‚</li>
<li><strong>é€‚åˆServerlesså’Œå®¹å™¨åŒ–éƒ¨ç½²</strong>ï¼ˆå†·å¯åŠ¨é—®é¢˜æ˜¾è‘—æ”¹å–„ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-5"><strong>å¦‚ä½•å®æ–½ï¼Ÿ</strong></h3>
<p>1. æ·»åŠ ä¾èµ–ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.graalvm.buildtools<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>native-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>2. æ„å»ºåŸç”Ÿé•œåƒï¼š</p>
<pre><code class="hljs language-bash" lang="bash">mvn -Pnative native:compile
</code></pre>
<h3 data-id="heading-6"><strong>æ³¨æ„äº‹é¡¹</strong></h3>
<ul>
<li><strong>åå°„ä¸åŠ¨æ€ä»£ç†éœ€æ˜¾å¼é…ç½®</strong>ï¼šåœ¨<code>src/main/resources/META-INF/native-image</code>ä¸‹æä¾›é…ç½®æ–‡ä»¶ã€‚</li>
<li><strong>éƒ¨åˆ†åº“ä¸å…¼å®¹åŸç”Ÿç¼–è¯‘</strong>ï¼šä¾‹å¦‚HibernateæŸäº›åŠŸèƒ½éœ€æ›¿æ¢ä¸ºSpring Data JDBCæˆ–MyBatisã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-7">ç­–ç•¥2ï¼šåˆ©ç”¨è™šæ‹Ÿçº¿ç¨‹æ›¿ä»£ä¼ ç»Ÿçº¿ç¨‹æ± </h2>
<h3 data-id="heading-8"><strong>è™šæ‹Ÿçº¿ç¨‹çš„ä¼˜åŠ¿</strong></h3>
<p>JDK21å¼•å…¥çš„è™šæ‹Ÿçº¿ç¨‹ï¼ˆProject Loomï¼‰å½»åº•æ”¹å˜äº†Javaå¹¶å‘æ¨¡å‹ï¼š</p>
<ul>
<li><strong>è½»é‡çº§çº¿ç¨‹åˆ›å»ºä¸é”€æ¯</strong>ï¼ˆæ¯ä¸ªè™šæ‹Ÿçº¿ç¨‹ä»…å ç”¨å°‘é‡KBå†…å­˜ï¼‰ã€‚</li>
<li><strong>è‡ªåŠ¨è°ƒåº¦åˆ°å¹³å°çº¿ç¨‹æ± ä¸Šæ‰§è¡Œ</strong>, I/Oæ“ä½œæ—¶è‡ªåŠ¨æŒ‚èµ·ä¸é˜»å¡å†…æ ¸çº¿ç¨‹ã€‚</li>
</ul>
<h3 data-id="heading-9"><strong>é›†æˆæ­¥éª¤ç¤ºä¾‹</strong></h3>
<p>1. JVMå‚æ•°å¯ç”¨é¢„è§ˆç‰¹æ€§ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">--enable-preview --add-modules jdk.incubator.concurrent
</code></pre>
<p>2. WebæœåŠ¡å™¨é…ç½®ï¼ˆä»¥Tomcatä¸ºä¾‹ï¼‰ï¼š</p>
<pre><code class="hljs language-properties" lang="properties">server.tomcat.threads.max=200
server.tomcat.executor.virtual-threads=true
</code></pre>
<h3 data-id="heading-10"><strong>å®æµ‹æ•ˆæœ</strong></h3>
<p>æŸç”µå•†å¹³å°åœ¨å¤„ç†10,000å¹¶å‘è¯·æ±‚æ—¶ï¼š</p>
<ul>
<li><strong>ä¼ ç»Ÿçº¿ç¨‹æ± </strong>: CPUåˆ©ç”¨ç‡85%ï¼Œå¹³å‡å»¶è¿Ÿ120ms</li>
<li><strong>è™šæ‹Ÿçº¿ç¨‹æ¨¡å¼</strong>: CPUåˆ©ç”¨ç‡é™è‡³60%ï¼Œå¹³å‡å»¶è¿Ÿ45ms</li>
</ul>
<hr/>
<h2 data-id="heading-11">ç­–ç•¥3ï¼šç²¾ç»†åŒ–åƒåœ¾å›æ”¶è°ƒä¼˜</h2>
<p>###Â G1 GC vs ZGCé€‰æ‹©æŒ‡å—</p>




















<table><thead><tr><th>GCç±»å‹</th><th>Â é€‚ç”¨åœºæ™¯</th><th>Â å…³é”®å‚æ•°å»ºè®®</th></tr></thead><tbody><tr><td>G1Â Â Â Â Â </td><td>Â å †å†…å­˜&lt;32GB</td><td><code>-XX:+UseG1GC -XX:MaxGCPauseMillis=200</code></td></tr><tr><td>ZGCÂ Â Â Â </td><td>Â è¶…å¤§å †/ä½å»¶è¿Ÿéœ€æ±‚</td><td><code>-XX:+UseZGC -Xmx16g -Xms16g</code></td></tr></tbody></table>
<p>###Â SpringBootä¸“å±ä¼˜åŒ–é¡¹</p>
<pre><code class="hljs language-properties" lang="properties"># application.properties
spring.jvm.gc.logging.enabled=true #è¾“å‡ºè¯¦ç»†GCæ—¥å¿—ä¾¿äºåˆ†æ
spring.jvm.gc.mode=low-latency     #è‡ªåŠ¨è°ƒæ•´Young/OldåŒºæ¯”ä¾‹
</code></pre>
<hr/>
<p>##Â ç­–ç•¥4ï¼šç¼“å­˜ä¸æ•°æ®åº“è®¿é—®åŠ é€Ÿ</p>
<p>####Â æœ¬åœ°ç¼“å­˜é€‰å‹å¯¹æ¯”(Caffeine vs Ehcache)</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CacheConfig</span> {

    <span class="hljs-meta">@Bean("userCache")</span> 
    <span class="hljs-keyword">public</span> CacheManager <span class="hljs-title function_">caffeineCacheManager</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CaffeineCacheManager</span>()
            .withCacheSpec(<span class="hljs-string">"maximumSize=10000,expireAfterWrite=10m"</span>);
    }
}
</code></pre>
<h4 data-id="heading-12">R2DBCå¼‚æ­¥é©±åŠ¨å®è·µ(å¯¹æ¯”JDBC)</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
Â   <span class="hljs-attr">r2dbc:</span>
Â  Â  <span class="hljs-attr">url:</span> <span class="hljs-string">r2dbc:postgresql://localhost/test</span>Â 
Â  Â  <span class="hljs-attr">username:</span> <span class="hljs-string">dbuser</span>Â 
Â  Â  <span class="hljs-attr">password:</span> <span class="hljs-string">dbpass</span>Â 
Â   <span class="hljs-attr">jpa:</span>
Â  Â  <span class="hljs-attr">open-in-view:</span> <span class="hljs-literal">false</span> <span class="hljs-comment">#å¿…é¡»å…³é—­ï¼</span>
</code></pre>
<hr/>
<p>##Â ç­–ç•¥5ï¼šé™æ€èµ„æºä¸HTTP/3åè®®æ”¯æŒ</p>
<p>####Â æ–°ç‰ˆèµ„æºå¤„ç†ç‰¹æ€§</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>Â 
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addResourceHandlers</span><span class="hljs-params">(ResourceHandlerRegistry registry)</span> {
Â   registry.addResourceHandler(<span class="hljs-string">"/static/**"</span>)
Â  Â  Â  .addResourceLocations(<span class="hljs-string">"classpath:/static/"</span>)
Â  Â  Â  .setOptimizeLocations(<span class="hljs-literal">true</span>); <span class="hljs-comment">//æ–°å¢å“ˆå¸Œæ ¡éªŒï¼</span>
}
</code></pre>
<h4 data-id="heading-13">HTTP/3å¿«é€Ÿå¯ç”¨(éœ€Quarkus Undertow)</h4>
<pre><code class="hljs language-properties" lang="properties">server.http.version=VERSION_3Â 
server.http.host=0.0.0.0Â 
server.http.idle-timeout=30sÂ 
</code></pre>
<hr/>
<p>##Â Â æ€»ç»“</p>
<p>SpringBootÂ Â 3.2çš„æ€§èƒ½æå‡ç»éå¶ç„¶â€”â€”ä»åº•å±‚çš„GraalVMæ”¯æŒåˆ°é¡¶å±‚çš„HTTPåè®®æ ˆå‡çº§,æ¯ä¸€é¡¹æ”¹è¿›éƒ½ä¸ºå¼€å‘è€…æä¾›äº†æ›´é«˜æ•ˆçš„è¿è¡Œæ—¶ç¯å¢ƒã€‚</p>
<p>æœ¬æ–‡ä»‹ç»çš„5å¤§ç­–ç•¥å¯ç»„åˆä½¿ç”¨ï¼š
1ï¸âƒ£ Native Imageæ„å»ºæè‡´è½»é‡åº”ç”¨<br/>
2ï¸âƒ£ Virtual Threadsé‡æ„å¹¶å‘æ¨¡å‹<br/>
3ï¸âƒ£ ZGC/G1ç²¾ç»†è°ƒèŠ‚å†…å­˜ç®¡ç†<br/>
4ï¸âƒ£ Caffeine+R2DBCå®ç°æ•°æ®å±‚åŠ é€Ÿ<br/>
5ï¸âƒ£ HTTP/3+èµ„æºå‹ç¼©ä¼˜åŒ–ç½‘ç»œä¼ è¾“</p>
<p>å»ºè®®å›¢é˜Ÿæ ¹æ®è‡ªèº«æŠ€æœ¯æ ˆé€æ­¥å®æ–½éªŒè¯,é€šå¸¸åªéœ€é‡‡ç”¨å…¶ä¸­2~3é¡¹å³å¯è·å¾—æ˜¾è‘—æ”¶ç›Šã€‚"</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ„å»ºå‰ç«¯ç›‘æ§ä½“ç³»ï¼šSentryç§æœ‰åŒ–éƒ¨ç½²ä¸é¡¹ç›®é›†æˆå®è·µ]]></title>    <link>https://juejin.cn/post/7591439477437726771</link>    <guid>https://juejin.cn/post/7591439477437726771</guid>    <pubDate>2026-01-05T00:28:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591439477437726771" data-draft-id="7591421956215914534" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ„å»ºå‰ç«¯ç›‘æ§ä½“ç³»ï¼šSentryç§æœ‰åŒ–éƒ¨ç½²ä¸é¡¹ç›®é›†æˆå®è·µ"/> <meta itemprop="keywords" content="JavaScript,ç›‘æ§"/> <meta itemprop="datePublished" content="2026-01-05T00:28:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è°¢å°é£"/> <meta itemprop="url" content="https://juejin.cn/user/2717648473034823"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ„å»ºå‰ç«¯ç›‘æ§ä½“ç³»ï¼šSentryç§æœ‰åŒ–éƒ¨ç½²ä¸é¡¹ç›®é›†æˆå®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2717648473034823/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è°¢å°é£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-05T00:28:37.000Z" title="Mon Jan 05 2026 00:28:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»18åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="vs2015">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#1e1e1e;color:#dcdcdc}.hljs-keyword,.hljs-link,.hljs-literal,.hljs-name,.hljs-symbol{color:#569cd6}.hljs-link{text-decoration:underline}.hljs-built_in,.hljs-type{color:#4ec9b0}.hljs-class,.hljs-number{color:#b8d7a3}.hljs-meta-string,.hljs-string{color:#d69d85}.hljs-regexp,.hljs-template-tag{color:#9a5334}.hljs-formula,.hljs-function,.hljs-params,.hljs-subst,.hljs-title{color:#dcdcdc}.hljs-comment,.hljs-quote{color:#57a64a;font-style:italic}.hljs-doctag{color:#608b4e}.hljs-meta,.hljs-meta-keyword,.hljs-tag{color:#9b9b9b}.hljs-template-variable,.hljs-variable{color:#bd63c5}.hljs-attr,.hljs-attribute,.hljs-builtin-name{color:#9cdcfe}.hljs-section{color:gold}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-bullet,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-selector-tag{color:#d7ba7d}.hljs-addition{background-color:#144212}.hljs-addition,.hljs-deletion{display:inline-block;width:100%}.hljs-deletion{background-color:#600}</style><p>ã€€ã€€åœ¨ç°åœ¨å¤æ‚å¤šå˜çš„å‰ç«¯ç¯å¢ƒä¸­ï¼Œé”™è¯¯è¿½è¸ªä¸€ç›´æ˜¯ä¸ªæ£˜æ‰‹éš¾é¢˜ï¼›ç”¨æˆ·è®¾å¤‡åƒå·®ä¸‡åˆ«ã€ç”Ÿäº§ç¯å¢ƒé—®é¢˜æ˜¯éš¾ä»¥å¤ç°ï¼Œä¼ ç»Ÿæ—¥å¿—æ›´æ˜¯åŠ›ä¸ä»å¿ƒï¼›å› æ­¤æ‰èƒ½å¦‚ä½•æ›´å¥½çš„è¿½è¸ªé”™è¯¯ä¸€ç›´æ˜¯ä¸€ä¸ªé—®é¢˜ï¼›ç›®å‰å¸‚é¢ä¸Šæœ‰å¾ˆå¤šå¼€æºçš„å·¥å…·ï¼Œè€ŒSentryæ— ç–‘æ˜¯å…¶ä¸­åŠŸèƒ½ä¸°å¯Œã€æ”¯æŒç‡æœ€é«˜çš„ï¼Œå®ƒè®©é—®é¢˜å®šä½å˜å¾—å‰æ‰€æœªæœ‰åœ°æ¸…æ™°ï¼›æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä¸ºå‰ç«¯é¡¹ç›®éƒ¨ç½²å’Œæ¥å…¥Sentryï¼Œä»åŸºç¡€é…ç½®åˆ°é«˜çº§ä¼˜åŒ–ï¼ŒåŠ©æ‚¨æ„å»ºæ›´ç¨³å®šçš„åº”ç”¨ä½“éªŒã€‚</p>
<p>ã€€ã€€ç»å¸¸åœ¨<code>ç”Ÿäº§ç¯å¢ƒå†™bug</code>çš„åŒå­¦éƒ½çŸ¥é“ï¼Œé¢å¯¹ç”¨æˆ·çªå¦‚å…¶æ¥çš„æŠ¥é”™æœ‰å¤šä¹ˆæ— å¥ˆï¼Œæœ¬åœ°è¿è¡Œä¸€åˆ‡æ­£å¸¸ï¼Œä½†æ˜¯ä¸€åˆ°çº¿ä¸Šï¼Œå°±çŠ¶å†µç™¾å‡ºï¼šè«åçš„ç™½å±ã€äº¤äº’çš„å¡æ­»ã€æ§åˆ¶å°çš„æŠ¥é”™ï¼›æ›´ä»¤äººæŠ“ç‹‚çš„æ˜¯ï¼Œç”¨æˆ·çš„åé¦ˆæ°¸è¿œåªæœ‰ä¸€å¥ï¼šâ€œé¡µé¢æ‰“å¼€å°±è¿™æ ·äº†å•Šï¼â€ä½ æ ¹æœ¬æ— æ³•çœ‹åˆ°ç”¨æˆ·çš„æ“ä½œè½¨è¿¹ï¼Œä¸çŸ¥é“ä»–ä»¬ç‚¹å‡»äº†ä»€ä¹ˆã€è¾“å…¥äº†ä»€ä¹ˆã€é‡åˆ°äº†ä»€ä¹ˆå¼‚å¸¸ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/153c372e57dc47f88f1122ba0c0ca0a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCi5bCP6aOe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768177716&amp;x-signature=z5SKbJUnF9zZf3wYJSopY4lhsQs%3D" alt="å‡ºç°é”™è¯¯å´©æºƒ" loading="lazy"/></p>
<p>ã€€ã€€è¿™ç§æ²¡æœ‰ç›‘æ§çš„è¢«åŠ¨åé¦ˆå°±åƒæ˜¯åœ¨é»‘å¤œä¸­æ‘¸ç´¢ç€ä¿®ç†ä¸€å°ç²¾å¯†çš„ä»ªå™¨ï¼Œä½ åªèƒ½ä»ä»ªå™¨å¶å°”å‘å‡ºçš„å¼‚å“æ¥çŒœæµ‹é—®é¢˜å‡ºåœ¨å“ªï¼Œå´çœ‹ä¸æ¸…å†…éƒ¨å“ªä¸ªé½¿è½®å¡ä½ã€å“ªæ ¹ç”µè·¯ç†”æ–­ï¼Œè¿‡ç¨‹ç¼“æ…¢ä¸”æ— å¥ˆã€‚</p>
<p>ã€€ã€€ç°åœ¨æˆ‘ä»¬æœ‰äº†<code>å¼€æº</code>çš„Sentryï¼Œå°±åƒæ¢è£…ä¸Šäº†å…ˆè¿›æ¢æµ‹çš„æ°®åŒ–é•“é›·è¾¾ç³»ç»Ÿï¼Œå®ƒèƒ½å¤Ÿæ•è·å‰ç«¯çš„æ¯ä¸€æ¬¡å¼‚å¸¸ï¼Œè®°å½•ç”¨æˆ·æ“ä½œçš„å…¨é“¾è·¯è½¨è¿¹ï¼Œè®©ç”Ÿäº§ç¯å¢ƒçš„å´©æºƒç¬é—´å®šæ ¼ä¸ºæ¸…æ™°çš„è¯Šæ–­æŠ¥å‘Šå’Œç›‘æ§å½•åƒï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹ä¸€ä¸‹å¦‚ä½•éƒ¨ç½²Sentryã€‚</p>
<h2 data-id="heading-0">ç§æœ‰åŒ–æœåŠ¡éƒ¨ç½²</h2>
<p>ã€€ã€€Sentryè‹±æ–‡ç¿»è¯‘è¿‡æ¥ï¼Œæ„æ€æ˜¯<code>â€œå“¨å…µâ€</code>ï¼Œåœ¨å¼€å§‹é›†æˆSentryä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç»™è¿™ä½â€œå¿ è¯šâ€çš„å“¨å…µå»ºé€ ä¸€åº§åšå®çš„â€œå²—äº­â€ï¼›æ˜¯ç›´æ¥è®©å®ƒé©»å®ˆåœ¨å®˜æ–¹çš„å…¬å…±äº‘åŸºåœ°ï¼ˆSaaSæœåŠ¡ï¼‰ï¼Œè¿˜æ˜¯åœ¨ä½ è‡ªå·±çš„ç½‘ç»œé¢†åœ°å†…ä¸ºå®ƒæ­å»ºä¸€åº§ä¸“å±çš„å ¡å’ï¼ˆç§æœ‰åŒ–éƒ¨ç½²ï¼‰ï¼Ÿè¿™ä¸ªé€‰æ‹©è‡³å…³é‡è¦ã€‚</p>
<p>ã€€ã€€å®˜æ–¹SaaSæœåŠ¡æ˜¯â€œæ‹åŒ…å…¥ä½â€çš„å¿«æ·é€‰æ‹©â€”â€”æ³¨å†Œå³ç”¨ã€è‡ªåŠ¨ç»´æŠ¤ã€åŠŸèƒ½å³æ—¶æ›´æ–°ï¼Œå°¤å…¶é€‚åˆå¤§å¤šæ•°ç‹¬ç«‹å¼€å‘è€…å’Œåˆåˆ›å›¢é˜Ÿã€‚å…è´¹å¥—é¤è¶³ä»¥æ”¯æ’‘å‰æœŸçš„æ ¸å¿ƒç›‘æ§éœ€æ±‚ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/517baaca6a7b4048ae2cc5cbfcf39dad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCi5bCP6aOe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768177716&amp;x-signature=ChjXj6bRIobkWgyKgpr%2FWZlULq4%3D" alt="Sentryä»·æ ¼" loading="lazy"/></p>
<p>ã€€ã€€ä½†æ˜¯ï¼Œå½“ä½ çš„é¡¹ç›®éœ€è¦æ»¡è¶³ä¸¥æ ¼çš„å†…ç½‘åˆè§„è¦æ±‚æ—¶ï¼Œå°†å“¨å…µå’Œæ‰€æœ‰ç›‘æ§æ•°æ®éƒ½ç•™åœ¨è‡ªå·±çš„åŸå¢™ä¹‹å†…ï¼Œå°±æˆä¸ºäº†å¿…é¡»ã€‚ç§æœ‰åŒ–éƒ¨ç½²èµ‹äºˆäº†ä½ å¯¹æ•°æ®ã€ç½‘ç»œå’Œç‰ˆæœ¬çš„å®Œå…¨æ§åˆ¶æƒï¼Œè™½ç„¶éƒ¨ç½²å’Œç»´æŠ¤æˆæœ¬ç›¸åº”å¢åŠ ï¼Œä½†å®ƒå¸¦æ¥çš„å®‰å…¨æ€§å’Œè‡ªä¸»æ€§ï¼Œå¯¹äºè®¸å¤šä¼ä¸šçº§åº”ç”¨è€Œè¨€æ˜¯ä¸å¯æˆ–ç¼ºçš„ã€‚</p>
<p>ã€€ã€€åœ¨å‘å…¬å¸è¿ç»´åŒäº‹â€œè½¯ç£¨ç¡¬æ³¡â€åï¼Œæˆ‘ä»¬æˆåŠŸç”³è¯·åˆ°äº†ä¸€å°å¦‚ä¸‹é…ç½®ä¸“ç”¨æœåŠ¡å™¨æ¥éƒ¨ç½²Sentryï¼š</p>
<ul>
<li>CPU: 8æ ¸</li>
<li>å†…å­˜: 16G</li>
<li>ç¡¬ç›˜: 50G</li>
</ul>
<p>ã€€ã€€è¿™ä¸ªé…ç½®éƒ¨ç½²Sentryï¼Œè¯´å®è¯ï¼Œå·²ç»ç®—æ˜¯æ‰“äº†ä¸ªâ€œå¯Œè£•ä»—â€â€”â€”æ¯•ç«Ÿå®˜æ–¹æ¨èçš„æœ€ä½é…ç½®æ˜¯4æ ¸8Gï¼Œæˆ‘ä»¬è¿™å·²ç»è¾¾åˆ°äº†ä¸­ç­‰ç”Ÿäº§ç¯å¢ƒçš„è¦æ±‚ã€‚å……è¶³çš„èµ„æºæ„å‘³ç€æˆ‘ä»¬å¯ä»¥æ›´ä»å®¹åœ°é…ç½®ç¼“å­˜ã€å¯ç”¨æ›´å¤šå·¥ä½œè¿›ç¨‹ï¼Œå¹¶ä¸ºæœªæ¥çš„æ•°æ®å¢é•¿ç•™è¶³ç©ºé—´ã€‚</p>
<p>ã€€ã€€åœ¨æ¥ä¸‹æ¥çš„æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬å°†åŸºäºè¿™å°â€œå¯Œè£•â€çš„æœåŠ¡å™¨æ¥å®‰è£…ï¼Œä½¿ç”¨<code>Docker Compose</code>çš„æ ‡å‡†åŒ–éƒ¨ç½²ï¼›é¦–å…ˆå…‹éš†sentry-self-hostedè¿™ä¸ªé¡¹ç›®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">clone</span> https://github.com/getsentry/self-hosted.git sentry-self-hosted
<span class="hljs-built_in">cd</span> sentry-self-hosted
./install.sh
</code></pre>
<p>ã€€ã€€ç„¶åå°±å¯ä»¥çœ‹åˆ°é•œåƒå’”å’”åœ°å¼€å§‹ä¸‹è½½ï¼Œä¸‹è½½åˆ°ä¸€åŠï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°è¿™æ ·çš„æç¤ºï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">Hey, so ... we would love <span class="hljs-keyword">to</span> automatically find out about issues <span class="hljs-keyword">with</span> your
Sentry instance so that we can improve the product. Turns out there <span class="hljs-built_in">is</span> an app
<span class="hljs-keyword">for</span> that, called Sentry. Would you be willing <span class="hljs-keyword">to</span> <span class="hljs-keyword">let</span> us automatically send data
about your instance upstream <span class="hljs-keyword">to</span> Sentry <span class="hljs-keyword">for</span> development <span class="hljs-built_in">and</span> debugging purposes?

  y / yes / <span class="hljs-number">1</span>
  n / no / <span class="hljs-number">0</span>

(Btw, we send this <span class="hljs-keyword">to</span> our own self-hosted Sentry instance, <span class="hljs-built_in">not</span> <span class="hljs-keyword">to</span> Sentry SaaS,
so that we can be <span class="hljs-keyword">in</span> this together.)

Here<span class="hljs-comment">'s the info we may collect:</span>

  - OS username
  - IP address
  - install log
  - runtime errors
  - performance data

Thirty (<span class="hljs-number">30</span>) day retention. No marketing. Privacy policy at sentry.io/privacy.
</code></pre>
<p>ã€€ã€€è¿™æ˜¯ä¸€ä¸ªå¯é€‰çš„åŒ¿åæ•°æ®è´¡çŒ®æç¤ºï¼Œç”¨äºå¸®åŠ©Sentryå›¢é˜Ÿæ”¹è¿›äº§å“åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªèº«éœ€æ±‚å’Œæ•°æ®æ”¿ç­–ï¼Œè‡ªç”±é€‰æ‹©åŒæ„æˆ–è·³è¿‡ã€‚å½“æ‰€æœ‰å¿…éœ€çš„Dockeré•œåƒæˆåŠŸä¸‹è½½å®Œæˆåï¼Œç»ˆç«¯å°†æ˜¾ç¤ºç±»ä¼¼ä¸‹å›¾çš„æç¤ºä¿¡æ¯ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f2da06605ce448c7837306494aff6cb6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCi5bCP6aOe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768177716&amp;x-signature=5rXII4KVt0XUDAfbkmycCMWBrbY%3D" alt="ä¸‹è½½å®Œæˆ" loading="lazy"/></p>
<p>ã€€ã€€æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æŒ‰ç…§æç¤ºå‘½ä»¤ä»¥å¯åŠ¨SentryæœåŠ¡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker compose up --<span class="hljs-built_in">wait</span>
</code></pre>
<p>ã€€ã€€æœåŠ¡å¯åŠ¨åï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š<code>http://[ä½ çš„æœåŠ¡å™¨IP]:9000/</code>ï¼ŒæœŸå¾…å·²ä¹…çš„Sentryç®¡ç†ç•Œé¢ä¾¿ä¼šå±•ç°åœ¨çœ¼å‰ã€‚ä¸è¿‡ï¼Œå¦‚æœå› ä¸ºæˆ‘ä»¬æ˜¯é¦–æ¬¡å¯åŠ¨æœåŠ¡ï¼Œç³»ç»Ÿä¼šå‡ºäºå®‰å…¨è€ƒè™‘ï¼Œé€šå¸¸ä¼šæ˜¾ç¤ºä¸€ä¸ªå…³äºCSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰ä¿æŠ¤çš„é…ç½®æç¤ºé¡µé¢ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/46a468cc42bc4b92a50b8c4197c7276a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCi5bCP6aOe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768177716&amp;x-signature=qo%2Bp1C0wIhUBPjRQ7%2B8t5vrrin0%3D" alt="CSRF" loading="lazy"/></p>
<p>ã€€ã€€è¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦ä¿®æ”¹sentryç›®å½•ä¸‹çš„sentry.conf.pyæ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">vim sentry/sentry.conf.py
</code></pre>
<p>ã€€ã€€å°†æˆ‘ä»¬çš„åŸŸåæ·»åŠ åˆ°CSRF_TRUSTED_ORIGINSä¸­ï¼Œä¸€èˆ¬æ·»åŠ å†…ç½‘çš„ipåœ°å€ï¼Œä»¥åŠéƒ¨ç½²sentryçš„åŸŸåå³å¯ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">CSRF_TRUSTED_ORIGINS</span> = [<span class="hljs-string">"https://sentry.[your domain].com"</span>, <span class="hljs-string">"http://127.0.0.1:9000"</span>, <span class="hljs-string">"http://[your ip]:9000"</span>]
</code></pre>
<p>ã€€ã€€ç»è¿‡ä¸Šé¢çš„ä¿®æ”¹åï¼Œæˆ‘ä»¬å†æ¬¡é‡å¯æœåŠ¡ï¼Œç›¸ä¿¡Sentryå°±å¯ä»¥æ­£å¸¸è®¿é—®äº†ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">docker compose down
docker compose up --<span class="hljs-built_in">wait</span>
</code></pre>
<p>ã€€ã€€æœ€åæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°è¿™æ ·çš„ä¸€ä¸ªæ¬¢è¿ç•Œé¢ï¼Œè¿™é‡Œæ ¹æ®æç¤ºå¡«å†™ç½‘ç«™çš„æ ¹è·¯å¾„å’Œç®¡ç†å‘˜é‚®ç®±åœ°å€ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dbf8fa8929674d5ab5f7bcbb9dd15d27~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCi5bCP6aOe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768177716&amp;x-signature=6LYYDr95k0ffGu%2FenJg6iwI%2FLAc%3D" alt="æ¬¢è¿ç•Œé¢" loading="lazy"/></p>
<p>ã€€ã€€Sentryé»˜è®¤ä¼šä¿ç•™<code>90å¤©</code>çš„æ—¥å¿—æ•°æ®ã€‚å¦‚æœæœåŠ¡å™¨å­˜å‚¨èµ„æºç´§å¼ ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹<code>.env</code>æ–‡ä»¶ä¸­çš„<code>SENTRY_EVENT_RETENTION_DAYS</code>é…ç½®é¡¹æ¥ç¼©çŸ­æ•°æ®ä¿ç•™å‘¨æœŸï¼Œä¾‹å¦‚å°†å…¶ä»90å¤©è°ƒæ•´ä¸º30æˆ–15å¤©ã€‚è¿™èƒ½æœ‰æ•ˆé‡Šæ”¾å­˜å‚¨å‹åŠ›ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ›´çŸ­çš„æ•°æ®ä¿ç•™å‘¨æœŸä¼šé™åˆ¶å†å²é—®é¢˜çš„å›æº¯ä¸åˆ†æèƒ½åŠ›ã€‚</p>
<h3 data-id="heading-1">é‚®ä»¶é…ç½®</h3>
<p>ã€€ã€€é‚®ä»¶é…ç½®æ˜¯Sentryéƒ¨ç½²åè‡³å…³é‡è¦çš„ä¸€ç¯ï¼Œå®ƒç›´æ¥å…³ç³»åˆ°å›¢é˜Ÿçš„åä½œæ•ˆç‡å’Œé—®é¢˜æ„ŸçŸ¥åº¦ï¼Œå¦‚æœæ²¡æœ‰é…ç½®é‚®ä»¶ï¼Œå°†ä¸èƒ½é‚€è¯·å›¢é˜Ÿæˆå‘˜ï¼›æˆ‘ä»¬éœ€è¦åœ¨<code>sentry/config.yml</code>æ–‡ä»¶ä¸­æ­£ç¡®è®¾ç½®SMTPé‚®ä»¶æœåŠ¡å™¨çš„ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment"># SMTPåœ°å€</span>
mail.host: <span class="hljs-string">'smtp.example.com'</span>
<span class="hljs-comment"># ç«¯å£</span>
mail.port: <span class="hljs-number">465</span>
<span class="hljs-comment"># è´¦å·</span>
mail.username: <span class="hljs-string">'XXX@example.com.cn'</span>
<span class="hljs-comment"># å¯†ç </span>
mail.password: <span class="hljs-string">'XXX'</span>
<span class="hljs-comment"># æ˜¯å¦ä½¿ç”¨SSL</span>
mail.<span class="hljs-keyword">use</span>-ssl: <span class="hljs-literal">true</span>
<span class="hljs-comment"># å‘é€æ–¹</span>
mail.<span class="hljs-keyword">from</span>: <span class="hljs-string">'XXX@example.com.cn'</span>
</code></pre>
<p>ã€€ã€€ä¸€æ—¦é…ç½®æˆåŠŸï¼ŒSentryçš„é‚®ä»¶ç³»ç»Ÿå°†æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>é‚€è¯·ç”¨æˆ·æ³¨å†Œï¼šå…è®¸ç”¨æˆ·é€šè¿‡é‚®ä»¶é‚€è¯·åŠ å…¥ç»„ç»‡ã€‚</li>
<li>å®æ—¶å‘Šè­¦é€šçŸ¥ï¼šå½“æŸä¸ªé”™è¯¯é¢‘ç‡è¶…è¿‡è®¾å®šçš„é˜ˆå€¼æ—¶ï¼Œç«‹å³å‘é€é‚®ä»¶é€šçŸ¥ç”¨æˆ·ã€‚</li>
<li>å®šæœŸæ‘˜è¦ï¼šå¯é…ç½®æ¯æ—¥/æ¯å‘¨å‘é€é”™è¯¯æ‘˜è¦æŠ¥å‘Šã€‚</li>
</ul>
<p>ã€€ã€€è®¾ç½®æˆåŠŸï¼Œé‡å¯æœåŠ¡å™¨åï¼Œæ‰“å¼€<code>æ§åˆ¶å° =&gt; ç®¡ç† =&gt; Mail</code>ï¼Œçœ‹åˆ°åˆšæ‰çš„é…ç½®äº†ï¼Œè¿˜å¯ä»¥å‘é€ä¸€å°æµ‹è¯•é‚®ä»¶ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b22fc402313f48098784654e7369759f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCi5bCP6aOe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768177716&amp;x-signature=%2Brx2z2huV%2BsfJP%2FxGTP%2FSoM5PWk%3D" alt="SMTPè®¾ç½®" loading="lazy"/></p>
<h2 data-id="heading-2">é¡¹ç›®æ¥å…¥</h2>
<p>ã€€ã€€ä¸Šé¢Sentryéƒ¨ç½²å®Œæˆåï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ„‰å¿«åœ°å°†æˆ‘ä»¬æ‰‹ä¸Šçš„é¡¹ç›®æ¥æ¥å…¥Sentryäº†ï¼›ç™»å½•æ§åˆ¶å°ï¼Œç‚¹å‡»<code>åˆ›å»ºé¡¹ç›®</code>ï¼Œç„¶åé€‰æ‹©Vueä½œä¸ºå¹³å°ï¼Œè¾“å…¥é¡¹ç›®åç§°<code>(Project slug)</code>ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8cc511ad1eb44aab93288e16d18a9b7a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCi5bCP6aOe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768177716&amp;x-signature=j5Y%2FQRq5S2Y78n%2FDFS2K2KrWZAQ%3D" alt="åˆ›å»ºé¡¹ç›®" loading="lazy"/></p>
<p>ã€€ã€€åˆ›å»ºé¡¹ç›®åï¼Œæ ¹æ®æç¤ºï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸€ä¸ª<code>DSNç </code>ï¼Œè¿™ä¸ªDSNç æ˜¯Sentryä¸Vueé¡¹ç›®ä¹‹é—´çš„é€šä¿¡æ¡¥æ¢ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªDSNé…ç½®åˆ°Vueé¡¹ç›®ä¸­ã€‚</p>
<p>ã€€ã€€Sentryæä¾›äº†Vueçš„å®˜æ–¹æ’ä»¶ï¼ˆæ”¯æŒVue2æˆ–è€…Vue3ï¼‰ï¼Œæˆ‘ä»¬åœ¨Vueé¡¹ç›®ä¸­å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ¥å…¥Sentry;è¿™é‡Œä»¥Vue3é¡¹ç›®ä¸ºä¾‹ï¼Œå®‰è£…å®˜æ–¹SDKæ’ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pnpm add @sentry/vue
</code></pre>
<p>ã€€ã€€åªéœ€è¦åœ¨main.tsä¸­å¼•å…¥å¹¶åˆå§‹åŒ–å³å¯ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">Sentry</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@sentry/vue'</span>;
<span class="hljs-keyword">import</span> pkg <span class="hljs-keyword">from</span> <span class="hljs-string">'../package.json'</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">bootstrap</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>);
  
  <span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">init</span>({
    app,
    <span class="hljs-attr">dsn</span>: <span class="hljs-string">'ã€your-dsnã€‘'</span>,
    <span class="hljs-attr">sendDefaultPii</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-comment">// ç¯å¢ƒ</span>
    <span class="hljs-attr">environment</span>: <span class="hljs-variable constant_">VITE_ENV</span>,
    <span class="hljs-attr">release</span>: <span class="hljs-string">`[project slug]@<span class="hljs-subst">${pkg.version}</span>`</span>
  });
  
  app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>);
}
</code></pre>
<p>ã€€ã€€è¿™é‡Œå±æ€§æ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬é€ä¸ªä»‹ç»æ¯ä¸ªå‚æ•°çš„ä½œç”¨ï¼›æˆ‘ä»¬å°†<code>createApp</code>åˆ›å»ºåçš„Vueå®ä¾‹ä¼ å…¥åˆå§‹åŒ–å‡½æ•°ï¼Œå¦‚æœæœ‰å¤šä¸ªå®ä¾‹ï¼Œè¿˜æ”¯æŒæ•°ç»„æ ¼å¼ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">init</span>({
  <span class="hljs-attr">app</span>: [app1, app2, app3],
  <span class="hljs-attr">dsn</span>: <span class="hljs-string">'[your-dsn]'</span>,
})
</code></pre>
<p>ã€€ã€€è€Œ<code>sendDefaultPii</code>æ§åˆ¶æ˜¯å¦å‘é€ç”¨æˆ·ä¿¡æ¯ï¼Œé»˜è®¤ä¸ºfalseï¼Œåªæ”¶é›†æœ€ç®€å•çš„ä¿¡æ¯ï¼Œæ¯”å¦‚æµè§ˆå™¨ä»¥åŠç‰ˆæœ¬ã€æ“ä½œç³»ç»Ÿï¼›å¦‚æœä¸ºtrueï¼Œåˆ™Sentryä¼šå‘é€æ›´è¯¦ç»†çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå¦‚ï¼šæµè§ˆå™¨è¯¦ç»†agentã€æ“ä½œç³»ç»Ÿã€è®¾å¤‡ç±»å‹ã€IPåœ°å€ç­‰ä¸ªäººèº«ä»½ä¿¡æ¯ï¼›å¼€å¯å‰ç¡®è®¤ç¬¦åˆGDPRç­‰éšç§æ³•è§„è¦æ±‚ï¼Œæ›´å¤šå…³äºGDPRçš„è¯¦æƒ…ï¼Œè¯·æŸ¥çœ‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fxieyufei.com%2F2024%2F11%2F02%2FAccept-Cookie.html" target="_blank" title="https://xieyufei.com/2024/11/02/Accept-Cookie.html" ref="nofollow noopener noreferrer">æµè§ˆç½‘ç«™æ—¶ä¸ºä»€ä¹ˆè€æ˜¯è¦æˆ‘æ¥å—Cookie</a>æ–‡ç« ã€‚</p>
<p>ã€€ã€€<code>environment</code>å­—æ®µæ ¹æ®åç§°æˆ‘ä»¬ä¹Ÿèƒ½çŒœåˆ°ï¼Œæ ‡è¯†å½“å‰ç¯å¢ƒï¼Œæ¯”å¦‚å¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒã€ç”Ÿäº§ç¯å¢ƒç­‰ï¼Œä¾¿äºè¿‡æ»¤å’Œç»Ÿè®¡ç‰¹å®šç¯å¢ƒçš„é”™è¯¯æŠ¥å‘Šï¼›<code>release</code>å­—æ®µåˆ™æ˜¯é¡¹ç›®çš„ç‰ˆæœ¬å·ï¼Œç”¨äºæ ‡è¯†å½“å‰é¡¹ç›®ï¼Œæ–¹ä¾¿åç»­æŸ¥çœ‹ï¼Œæ¨èä¸º<code>é¡¹ç›®å@ç‰ˆæœ¬å·</code>æ ¼å¼ï¼Œç²¾ç¡®è¿½è¸ªç‰¹å®šç‰ˆæœ¬çš„é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥ä»package.jsonè‡ªåŠ¨è·å–ç‰ˆæœ¬å·ï¼Œç¡®ä¿ç‰ˆæœ¬å·çš„ä¸€è‡´æ€§ã€‚</p>
<h3 data-id="heading-3">é›†æˆæ’ä»¶</h3>
<p>ã€€ã€€Sentryæ”¯æŒå°†å¾ˆå¤šåŠŸèƒ½é€šè¿‡æ’ä»¶çš„å½¢å¼é›†æˆè¿›æ¥ï¼›ä¸‹é¢æˆ‘ä»¬ä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„é›†æˆåŠŸèƒ½ã€‚é¦–å…ˆå°±æ˜¯æµè§ˆå™¨è¿½è¸ª<code>browserTracingIntegration</code>é›†æˆï¼Œç”¨äºè¿½è¸ªæµè§ˆå™¨ä¸­çš„é”™è¯¯å’Œæ€§èƒ½æ•°æ®ï¼Œæ¯”å¦‚é¡µé¢åŠ è½½æ—¶é—´ã€èµ„æºåŠ è½½æ—¶é—´ã€ç”¨æˆ·è¡Œä¸ºç­‰ç­‰ï¼›åŒæ—¶ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨äº†Vue Routerï¼Œè¿˜å¯ä»¥å°†Routeré›†æˆè¿›æ¥ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">init</span>({
  <span class="hljs-attr">integrations</span>: [
    <span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">browserTracingIntegration</span>({ 
      router,
      <span class="hljs-attr">routeLabel</span>: <span class="hljs-string">'name'</span>
    })
  ],
  <span class="hljs-attr">tracesSampleRate</span>: <span class="hljs-number">0.8</span>,
})
</code></pre>
<p>ã€€ã€€<code>routeLabel</code>å‚æ•°å†³å®šäº†Sentryå¦‚ä½•æ ‡è¯†ä½ çš„è·¯ç”±é¡µé¢ï¼Œé»˜è®¤ä¸ºpathï¼ŒSentryä¸­è·¯ç”±å°±ä¼šæ˜¾ç¤ºå…·ä½“è·¯å¾„ï¼Œæ¯”å¦‚<code>/user/:id/profile</code>ï¼›è€Œä¿®æ”¹ä¸ºnameï¼ŒSentryä¸­è·¯ç”±å°±ä¼šæ˜¾ç¤ºè·¯ç”±åç§°ï¼Œæ¯”å¦‚<code>UserProfile</code>ï¼Œæ›´ä¸ºç®€æ´ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/16702f0d2e6d43898b78e2246578ba9d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCi5bCP6aOe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768177716&amp;x-signature=pzRcHoil%2FmP%2BlyGCwB%2BKji8z1lI%3D" alt="æµè§ˆå™¨è¿½è¸ª" loading="lazy"/></p>
<p>ã€€ã€€<code>tracesSampleRate</code>å‚æ•°æ§åˆ¶ç€ç”¨æˆ·åœ¨ä½¿ç”¨æ—¶ï¼Œæ€§èƒ½æ•°æ®è¢«ä¸ŠæŠ¥çš„æ¦‚ç‡ï¼Œè¿™æ˜¯ä¸€ä¸ªéœ€è¦åœ¨æ•°æ®è´¨é‡å’Œç³»ç»Ÿå¼€é”€ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ç‚¹çš„é‡è¦é…ç½®é¡¹ï¼›æœ€å¤§å€¼ä¸º1,è¡¨ç¤º100%ä¸ŠæŠ¥ï¼Œè¿™é‡Œæˆ‘ä»¬è®¾ç½®ä¸º0.8ï¼Œæ„å‘³ç€åœ¨ç”¨æˆ·ä½¿ç”¨æ—¶ï¼Œæœ‰20%çš„æ¦‚ç‡ä¼šä¸ŠæŠ¥æ€§èƒ½æ•°æ®ã€‚</p>
<p>ã€€ã€€åœ¨å¼€å‘å’Œè°ƒè¯•é˜¶æ®µï¼Œå¯ä»¥è®¾ç½®ä¸ºè¾ƒé«˜çš„å€¼ï¼Œæ¯”å¦‚1.0ï¼Œè¿™æ ·å¯ä»¥è®©æ‰€æœ‰çš„æ€§èƒ½æ•°æ®éƒ½ä¸ŠæŠ¥ï¼Œæ–¹ä¾¿è°ƒè¯•ï¼›å½“é¡¹ç›®å‘å¸ƒåˆ°ç”Ÿäº§ç¯å¢ƒæ—¶ï¼Œå¯ä»¥è®¾ç½®ä¸€ä¸ªè¾ƒä½çš„å€¼ï¼Œæ¯”å¦‚0.1ï¼Œè¿™æ ·åªæœ‰10%çš„ç”¨æˆ·ä½¿ç”¨ï¼Œæ€§èƒ½æ•°æ®æ‰ä¼šä¸ŠæŠ¥ï¼Œä»è€Œæé«˜æœåŠ¡å™¨çš„æ‰¿è½½åŠ›ã€‚</p>
<p>ã€€ã€€å¯¹äºå¤æ‚åœºæ™¯ï¼ŒSentryæ”¯æŒæ›´æ™ºèƒ½çš„åŠ¨æ€é‡‡æ ·ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">init</span>({
  <span class="hljs-attr">tracesSampleRate</span>: <span class="hljs-number">0.1</span>,
  <span class="hljs-attr">tracesSampler</span>: <span class="hljs-function">(<span class="hljs-params">samplingContext</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { name } = samplingContext;

    <span class="hljs-comment">// æµ‹è¯•ç¯å¢ƒ</span>
    <span class="hljs-keyword">if</span> (process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">"test"</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-number">1.0</span>;
    }

    <span class="hljs-comment">// æ”¯ä»˜é¡µé¢</span>
    <span class="hljs-keyword">if</span> (name.<span class="hljs-title function_">includes</span>(<span class="hljs-string">"/pay"</span>)) {
      <span class="hljs-keyword">return</span> <span class="hljs-number">0.8</span>;
    }

    <span class="hljs-comment">// ç™»å½•é¡µé¢</span>
    <span class="hljs-keyword">if</span> (name.<span class="hljs-title function_">includes</span>(<span class="hljs-string">"/login"</span>)) {
      <span class="hljs-keyword">return</span> <span class="hljs-number">0.6</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-number">0.1</span>;
  },
})
</code></pre>
<p>ã€€ã€€æ¯”å¦‚æˆ‘ä»¬åœ¨æµ‹è¯•ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æ‰€æœ‰çš„æ•°æ®éƒ½ä¸ŠæŠ¥ï¼Œæ”¯ä»˜é¡µé¢å’Œç™»é™†é¡µé¢ï¼Œæˆ‘ä»¬å¸Œæœ›æœ‰80%å’Œ60%çš„æ¦‚ç‡ä¸ŠæŠ¥ï¼Œå…¶ä»–é¡µé¢ï¼Œæˆ‘ä»¬å¸Œæœ›æœ‰10%çš„æ¦‚ç‡ä¸ŠæŠ¥ã€‚</p>
<p>ã€€ã€€å¦ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„é›†æˆæ’ä»¶å°±æ˜¯<code>replayIntegration</code>ä¼šè¯å›æ”¾é›†æˆï¼Œå®ƒå…è®¸æˆ‘ä»¬å½•åˆ¶å¹¶å›æ”¾ç”¨æˆ·åœ¨ç½‘ç«™ä¸Šçš„çœŸå®æ“ä½œè¿‡ç¨‹ï¼›ä¼ ç»Ÿçš„ç›‘æ§æ¨¡å¼åªèƒ½ä½“ç°æŠ¥é”™å †æ ˆçš„å†…å®¹ï¼Œä½†æ˜¯ç”¨æˆ·ç‚¹å‡»äº†ä»€ä¹ˆæ‰å¯¼è‡´è¿™ä¸ªé”™è¯¯ï¼Ÿç‚¹å‡»å‰é¡µé¢æ˜¯ä»€ä¹ˆçŠ¶æ€ï¼Ÿå¯¹äºè¿™äº›æƒ…å†µæˆ‘ä»¬ä¸€æ¦‚éƒ½ä¸æ¸…æ¥šã€‚é€šè¿‡é›†æˆ<code>replayIntegration</code>æ’ä»¶åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç®¡ç†åå°æŸ¥çœ‹é”™è¯¯å‘ç”Ÿå‰å‡ åˆ†é’Ÿçš„ç”¨æˆ·æ“ä½œå½•åƒï¼Œä»è€Œæ›´å®¹æ˜“å¸®åŠ©æˆ‘ä»¬å®šä½é—®é¢˜ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">init</span>({
  <span class="hljs-attr">integrations</span>: [
    <span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">replayIntegration</span>(),
  ],
  <span class="hljs-comment">// 10% ä¼šè¯å½•åˆ¶</span>
  <span class="hljs-attr">replaysSessionSampleRate</span>: <span class="hljs-number">0.1</span>,
  <span class="hljs-comment">// 100% é”™è¯¯æ—¶å½•åˆ¶</span>
  <span class="hljs-attr">replaysOnErrorSampleRate</span>: <span class="hljs-number">1.0</span>,
})
</code></pre>
<p>ã€€ã€€è¿™é‡Œçš„<code>replaysSessionSampleRate</code>ç”¨äºè®¾ç½®å¸¸è§„ç”¨æˆ·ä¼šè¯å½•åˆ¶çš„é‡‡æ ·ç‡ï¼Œè€Œ<code>replaysOnErrorSampleRate</code>åˆ™ä¸“ç”¨äºå¯¹å‘ç”Ÿé”™è¯¯çš„ä¼šè¯è¿›è¡Œå½•åˆ¶çš„é‡‡æ ·ç‡ï¼Œä¸€èˆ¬è®¾ä¸º100%ï¼Œè¡¨ç¤ºæ‰€æœ‰é”™è¯¯éƒ½è¿›è¡Œå½•åˆ¶ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/96a18cab0d494d6c8f5dbf0ebfbbfa69~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCi5bCP6aOe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768177716&amp;x-signature=fu3idI4bGXslW6w5F9hjP0SpPT0%3D" alt="é”™è¯¯å½•åˆ¶å›æ”¾" loading="lazy"/></p>
<p>ã€€ã€€è¿™é‡Œæˆ‘ä»¬åœ¨ç•Œé¢ä¸Šæœ‰ä¸€äº›æ–‡å­—å’Œè¾“å…¥æ¡†ï¼Œåœ¨å›æ”¾ç•Œé¢ä¸Šéƒ½è¢«ç”¨**ç»™éšè—äº†ï¼›è¿™ä¹Ÿæ˜¯å› ä¸ºGDPRæ”¿ç­–çš„é™åˆ¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒSentryä¼šéšè—ç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬ï¼Œé˜²æ­¢æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼›æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢ä¸‰ä¸ªå‚æ•°è®¾ä¸ºfalseï¼Œæ¥æ˜¾ç¤ºæ‰€æœ‰å†…å®¹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">replayIntegration</span>({
  <span class="hljs-comment">// éšè—æ‰€æœ‰çš„æ–‡æœ¬</span>
  <span class="hljs-attr">maskAllText</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-comment">// éšè—æ‰€æœ‰çš„è¾“å…¥æ¡†</span>
  <span class="hljs-attr">maskAllInputs</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-comment">// å±è”½æ‰€æœ‰çš„imgã€canvasç­‰åª’ä½“</span>
  <span class="hljs-attr">blockAllMedia</span>: <span class="hljs-literal">false</span>,
})
</code></pre>
<blockquote>
<p>æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡<code>unblock</code>ã€<code>mask</code>ã€<code>unmask</code>ç­‰å­—æ®µç²¾ç¡®æ§åˆ¶æ–‡æœ¬çš„æ˜¾ç¤ºå’Œéšè—ï¼›ä¾‹å¦‚æˆ‘ä»¬é€šè¿‡è®¾ç½®maskå­—æ®µï¼Œé’ˆå¯¹å¯†ç è¾“å…¥æ¡†ç­‰ç‰¹æ®Šå†…å®¹è¿›è¡Œé®æŒ¡å±è”½ã€‚</p>
</blockquote>
<p>ã€€ã€€è¿˜æœ‰ä¸€ä¸ªvueé¡¹ç›®ä¸­å¯ä»¥ç”¨çš„é›†æˆæ’ä»¶å°±æ˜¯<code>vueIntegration</code>ï¼Œç”¨äºè¿½è¸ªæ‰€æœ‰Vueç»„ä»¶çš„é”™è¯¯å’Œæ€§èƒ½æ•°æ®ï¼Œæ¯”å¦‚åœ¨ç»„ä»¶åŠ è½½mountedã€æ›´æ–°updateã€é”€æ¯unmountçš„ç”Ÿå‘½å‘¨æœŸä¸­è¿›è¡Œè¿½è¸ªã€‚</p>
<p>ã€€ã€€vueIntegrationæ’ä»¶æœ‰ä¸€ä¸ª<code>tracingOptions</code>å‚æ•°ï¼Œå¯ä»¥æ§åˆ¶æˆ‘ä»¬éœ€è¦è¿½è¸ªçš„ç»„ä»¶ï¼Œé»˜è®¤trackComponentsä¸ºfalseï¼Œè¡¨ç¤ºä¸è¿½è¸ªç»„ä»¶ï¼Œè®¾ç½®ä¸ºtrueï¼Œè¡¨ç¤ºè¿½è¸ªæ‰€æœ‰ç»„ä»¶ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">init</span>({
  <span class="hljs-attr">integrations</span>: [
    <span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">vueIntegration</span>({
      <span class="hljs-attr">tracingOptions</span>: {
        <span class="hljs-comment">// è¿½è¸ªæ‰€æœ‰ç»„ä»¶</span>
        <span class="hljs-attr">trackComponents</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-comment">// OR ç‰¹å®šç»„ä»¶</span>
        <span class="hljs-attr">trackComponents</span>: [
          <span class="hljs-string">"App"</span>,
          <span class="hljs-string">"RwvHeader"</span>,
          <span class="hljs-string">"RwvFooter"</span>,
          <span class="hljs-string">"RwvArticleList"</span>,
          <span class="hljs-string">"Pagination"</span>,
        ],
      },
    }),
  ],
});
</code></pre>
<p>ã€€ã€€é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ›´ç²¾ç¡®çš„æ§åˆ¶ï¼Œç»„ä»¶çš„å“ªäº›ç”Ÿå‘½å‘¨æœŸä¼šè¿›è¡Œè¿½è¸ªï¼›ä¾‹å¦‚æˆ‘ä»¬åªæƒ³è¦åœ¨ç»„ä»¶è¢«é”€æ¯æ—¶è¿›è¡Œè¿½è¸ªï¼Œé‚£ä¹ˆå¯ä»¥è®¾ç½®ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">vueIntegration</span>({
  <span class="hljs-attr">tracingOptions</span>: {
    <span class="hljs-attr">trackComponents</span>: <span class="hljs-literal">true</span>
    <span class="hljs-attr">hooks</span>: [<span class="hljs-string">"mount"</span>, <span class="hljs-string">"update"</span>, <span class="hljs-string">"unmount"</span>],
  }
})
</code></pre>
<blockquote>
<p>é»˜è®¤è¿½è¸ªçš„hooksæ˜¯<code>['activate', 'mount', 'update']</code>ã€‚</p>
</blockquote>
<blockquote>
<p>Vue2é¡¹ç›®ä¸­è¿½è¸ªç»„ä»¶é”€æ¯ä½¿ç”¨<code>destroy</code>ï¼Œè€Œä¸æ˜¯<code>unmount</code>ã€‚</p>
</blockquote>
<p>ã€€ã€€å¦ä¸€ä¸ªVueé¡¹ç›®å¯ä»¥æ·»åŠ çš„é›†æˆæ’ä»¶æ˜¯<code>createSentryPiniaPlugin</code>ï¼Œæ˜¯Sentryä¸º<code>PiniaçŠ¶æ€ç®¡ç†åº“</code>æä¾›çš„æ’ä»¶ï¼Œç”¨äºè¿½è¸ªstoreä¸­çš„å¼‚å¸¸å’ŒçŠ¶æ€å˜åŒ–ï¼›å®ƒçš„é›†æˆæ–¹å¼å’Œä¸Šé¢çš„æœ‰æ‰€å·®å¼‚ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { createPinia } <span class="hljs-keyword">from</span> <span class="hljs-string">"pinia"</span>;
<span class="hljs-keyword">import</span> { createSentryPiniaPlugin } <span class="hljs-keyword">from</span> <span class="hljs-string">"@sentry/vue"</span>;

<span class="hljs-keyword">const</span> pinia = <span class="hljs-title function_">createPinia</span>();
pinia.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">createSentryPiniaPlugin</span>());
</code></pre>
<p>ã€€ã€€createSentryPiniaPluginä¼šå°†æœ€åçŠ¶æ€ä½œä¸ºé™„ä»¶ä¸Šä¼ åˆ°æŠ¥é”™ä¿¡æ¯ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç®¡ç†åå°æŸ¥çœ‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/781cf8f762a543598669bc94279f88e3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCi5bCP6aOe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768177716&amp;x-signature=xw3wGVHwQFU43oJfu8afKnqKEpM%3D" alt="PiniaæŠ¥é”™çŠ¶æ€" loading="lazy"/></p>
<p>ã€€ã€€æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®attachPiniaStateä¸ºfalseï¼Œæ¥å…³é—­PiniaçŠ¶æ€çš„é™„ä»¶ä¸Šä¼ ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">createSentryPiniaPlugin</span>({
  <span class="hljs-attr">attachPiniaState</span>: <span class="hljs-literal">false</span>,
})
</code></pre>
<p>ã€€ã€€æœ€åä¸€ä¸ªé›†æˆæ’ä»¶æ˜¯<code>captureConsoleIntegration</code>ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†æ§åˆ¶å°æ‰“å°çš„ä¿¡æ¯å…¨éƒ¨ä¸ŠæŠ¥ç»™Sentryï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">init</span>({
  <span class="hljs-attr">integrations</span>: [
    <span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">captureConsoleIntegration</span>({
      <span class="hljs-comment">// é»˜è®¤æ˜¯æ‰€æœ‰æ—¥å¿—çº§åˆ«</span>
      <span class="hljs-attr">levels</span>: [<span class="hljs-string">'log'</span>, <span class="hljs-string">'info'</span>, <span class="hljs-string">'warn'</span>, <span class="hljs-string">'error'</span>, <span class="hljs-string">'debug'</span>, <span class="hljs-string">'assert'</span>]
    }),
  ]
})
</code></pre>
<p>ã€€ã€€æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡<code>levels</code>å­—æ®µè®¾ç½®ä¸ŠæŠ¥çš„æ—¥å¿—çº§åˆ«ï¼›ä¸ŠæŠ¥åï¼Œåœ¨ç®¡ç†åå°ä¸­æˆ‘ä»¬åœ¨å¯¹åº”çš„äº‹åŠ¡ä¸­å°±èƒ½çœ‹åˆ°æ—¥å¿—ä¿¡æ¯ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d2b684e1184c4dadab00ab1a472fb21e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCi5bCP6aOe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768177716&amp;x-signature=M1HrID4fN2BlbH0wpoTzzb3X%2FuA%3D" alt="æ§åˆ¶å°ä¿¡æ¯ä¸ŠæŠ¥" loading="lazy"/></p>
<h3 data-id="heading-4">è‡ªå®šä¹‰ä¸ŠæŠ¥</h3>
<p>ã€€ã€€åœ¨é”™è¯¯è¿½è¸ªæ—¶ï¼ŒçŸ¥é“â€œå“ªä¸ªç”¨æˆ·é‡åˆ°äº†é—®é¢˜â€å¾€å¾€æ¯”çŸ¥é“â€œå‡ºç°äº†ä»€ä¹ˆé—®é¢˜â€æ›´æœ‰ä»·å€¼ï¼›Sentryçš„<code>setUser</code>å‡½æ•°æ­£æ˜¯è¿æ¥é”™è¯¯ä¸ç”¨æˆ·çš„æ¡¥æ¢ï¼Œå®ƒèƒ½å°†å½“å‰ç”¨æˆ·çš„ä¿¡æ¯å…³è”åˆ°åç»­ä¸ŠæŠ¥çš„é”™è¯¯å’Œæ€§èƒ½äº‹åŠ¡ä¸­ã€‚å½“é”™è¯¯å‘ç”Ÿæ—¶ï¼Œä½ ä¸å†åªæ˜¯çœ‹åˆ°ä¸€ä¸ªå†°å†·çš„å †æ ˆè·Ÿè¸ªï¼Œè€Œæ˜¯èƒ½æ¸…æ™°åœ°çŸ¥é“ï¼š</p>
<ul>
<li>å“ªä¸ªç”¨æˆ·é‡åˆ°äº†è¿™ä¸ªé”™è¯¯</li>
<li>è¿™ä¸ªç”¨æˆ·çš„åŸºæœ¬å±æ€§</li>
<li>ç”¨æˆ·çš„ä½¿ç”¨ç¯å¢ƒä¿¡æ¯</li>
</ul>
<p>ã€€ã€€è€Œç”¨æˆ·ç™»å½•é¡µé¢æ­£æ˜¯è®¾ç½®ç”¨æˆ·åŸºæœ¬å±æ€§çš„æœ€ä½³æ—¶æœºï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">Sentry</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"@sentry/vue"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleLogin</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">loginAPI</span>(params);
  <span class="hljs-keyword">const</span> user = res.<span class="hljs-property">data</span>.<span class="hljs-property">user</span>;
  <span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">setUser</span>({
    <span class="hljs-attr">id</span>: user.<span class="hljs-property">id</span>,
    <span class="hljs-attr">email</span>: user.<span class="hljs-property">email</span>,
    <span class="hljs-attr">username</span>: user.<span class="hljs-property">username</span>,
    <span class="hljs-comment">// è‡ªå®šä¹‰å­—æ®µ</span>
    <span class="hljs-comment">// ç§Ÿæˆ·id</span>
    <span class="hljs-attr">tenantId</span>: user.<span class="hljs-property">tenantId</span>,
    <span class="hljs-comment">// å›½å®¶</span>
    <span class="hljs-attr">country</span>: user.<span class="hljs-property">country</span>,
    <span class="hljs-comment">// éƒ¨é—¨</span>
    <span class="hljs-attr">department</span>: user.<span class="hljs-property">department</span>,
    <span class="hljs-comment">// å…¶ä»–å­—æ®µ...</span>
  });

  <span class="hljs-comment">// å¯é€‰ï¼šè®¾ç½®ç”¨æˆ·æ ‡ç­¾ä¾¿äºç­›é€‰</span>
  <span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">setTag</span>(<span class="hljs-string">'user.tier'</span>, user.<span class="hljs-property">tier</span>);
  <span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">setTag</span>(<span class="hljs-string">'user.plan'</span>, user.<span class="hljs-property">plan</span>);
}
</code></pre>
<p>ã€€ã€€åœ¨ç”¨æˆ·é€€å‡ºç™»å½•æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦é€šè¿‡setUseræ¸…ç†ä¿¡æ¯ï¼Œå¦åˆ™ä¼šå¯¼è‡´å‡ºç°ç”¨æˆ·ä¿¡æ¯â€œå¼ å† ææˆ´â€çš„æƒ…å†µã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">Sentry</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"@sentry/vue"</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleLogout</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">setUser</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">setTag</span>(<span class="hljs-string">'user.tier'</span>, <span class="hljs-literal">null</span>);
  <span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">setTag</span>(<span class="hljs-string">'user.plan'</span>, <span class="hljs-literal">null</span>);
}
</code></pre>
<p>ã€€ã€€åœ¨Sentryä»ªè¡¨ç›˜ï¼Œè¿›è¡Œé¡¹ç›®ï¼Œåœ¨æ¯ä¸ªç”¨æˆ·è·¯ç”±è·Ÿè¸ªçš„ä¸Šé¢ï¼Œæˆ‘ä»¬å°±èƒ½çœ‹åˆ°ç”¨æˆ·ä¿¡æ¯ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bcd974842a044ae5b4aa11c905456a2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCi5bCP6aOe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768177716&amp;x-signature=qY9WmKEFG9jYbMxQVMBEwEHWajQ%3D" alt="ç»‘å®šç”¨æˆ·" loading="lazy"/></p>
<p>ã€€ã€€é™¤æ­¤ä¹‹å¤–ï¼ŒSentryè¿˜æä¾›äº†ä¸°å¯Œçµæ´»çš„å„ç§è‡ªå®šä¹‰ä¸ŠæŠ¥å‡½æ•°ï¼Œè®©æˆ‘ä»¬ä¸ä»…èƒ½å¤Ÿæ•è·é”™è¯¯ï¼Œè¿˜èƒ½ä¸»åŠ¨ä¸ŠæŠ¥å„ç§äº‹ä»¶æ¶ˆæ¯ï¼›å…¶ä¸­æœ€æ ¸å¿ƒã€æœ€å¸¸ç”¨çš„ä¸ŠæŠ¥å‡½æ•°å°±æ˜¯<code>captureException</code>ï¼Œå®ƒå¯ä»¥ç”¨æ¥ä¸ŠæŠ¥ä»»æ„ç±»å‹çš„Javascripté”™è¯¯ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">Sentry</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"@sentry/vue"</span>;

<span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">captureException</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Something went wrong!"</span>));
</code></pre>
<p>ã€€ã€€<code>captureMessage</code>æ˜¯Sentryä¸­ç”¨äºä¸ŠæŠ¥è‡ªå®šä¹‰æ¶ˆæ¯çš„æ ¸å¿ƒå‡½æ•°ã€‚ä¸åŒäºcaptureExceptionä¸“é—¨å¤„ç†å¼‚å¸¸ï¼ŒcaptureMessage æ›´åƒæ˜¯ç›‘æ§ç‰ˆçš„console.logï¼Œä¸“é—¨ç”¨äºè®°å½•åº”ç”¨çŠ¶æ€ã€ç”¨æˆ·è¡Œä¸ºã€æ€§èƒ½æŒ‡æ ‡ç­‰éå¼‚å¸¸ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">Sentry</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"@sentry/vue"</span>;

<span class="hljs-comment">// åŸºæœ¬ç”¨æ³•ï¼šä¸ŠæŠ¥æ–‡æœ¬æ¶ˆæ¯</span>
<span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">captureMessage</span>(<span class="hljs-string">'ç”¨æˆ·ç™»å½•æˆåŠŸ'</span>);
<span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">captureMessage</span>(<span class="hljs-string">'è®¢å•åˆ›å»ºå®Œæˆ'</span>);
<span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">captureMessage</span>(<span class="hljs-string">'é¡µé¢åŠ è½½æ—¶é—´è¿‡é•¿'</span>);

<span class="hljs-comment">// å¸¦çº§åˆ«çš„æ¶ˆæ¯</span>
<span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">captureMessage</span>(<span class="hljs-string">'è°ƒè¯•ä¿¡æ¯'</span>, <span class="hljs-string">'debug'</span>);     <span class="hljs-comment">// è°ƒè¯•çº§åˆ«</span>
<span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">captureMessage</span>(<span class="hljs-string">'ç”¨æˆ·æ“ä½œè®°å½•'</span>, <span class="hljs-string">'info'</span>);    <span class="hljs-comment">// ä¿¡æ¯çº§åˆ«ï¼ˆé»˜è®¤ï¼‰</span>
<span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">captureMessage</span>(<span class="hljs-string">'å†…å­˜ä½¿ç”¨ç‡è¶…è¿‡80%'</span>, <span class="hljs-string">'warning'</span>); <span class="hljs-comment">// è­¦å‘Šçº§åˆ«</span>
<span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">captureMessage</span>(<span class="hljs-string">'APIå“åº”æ—¶é—´è¶…è¿‡5ç§’'</span>, <span class="hljs-string">'error'</span>);  <span class="hljs-comment">// é”™è¯¯çº§åˆ«</span>
<span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">captureMessage</span>(<span class="hljs-string">'æ•°æ®åº“è¿æ¥å¤±è´¥'</span>, <span class="hljs-string">'fatal'</span>);     <span class="hljs-comment">// è‡´å‘½çº§åˆ«</span>
</code></pre>
<h2 data-id="heading-5">sourcemapä¸Šä¼ </h2>
<p>ã€€ã€€åœ¨æœªå¯ç”¨Source Mapçš„æƒ…å†µä¸‹ï¼Œç”Ÿäº§ç¯å¢ƒçš„é”™è¯¯å †æ ˆå°±åƒä¸€å›¢åŠ å¯†åçš„ä¹±ç ï¼Œä½ åªèƒ½çœ‹åˆ°ç±»ä¼¼a1b2c3.min.js:1:23456 è¿™æ ·ä»¤äººå›°æƒ‘çš„å®šä½ï¼Œå‡ ä¹æ— æ³•è¿½æº¯åˆ°å¼•å‘é—®é¢˜çš„åŸå§‹ä¸šåŠ¡é€»è¾‘ã€‚ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c119673342a4c2a95d4c12ad83dfa5e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCi5bCP6aOe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768177716&amp;x-signature=xJy%2FoKy%2FQQ5Ikmv4ltWoGHM8irg%3D" alt="æŠ¥é”™ä¿¡æ¯" loading="lazy"/></p>
<p>ã€€ã€€è€ŒSource Mapçš„ä½œç”¨ï¼Œæ­£æ˜¯ä¸ºè¿™å›¢â€œä¹±ç â€æä¾›äº†ä¸€æŠŠç²¾å‡†çš„è§£ç é’¥åŒ™ï¼›é€šè¿‡æ­£ç¡®é…ç½®å¹¶ä¸Šä¼ ï¼Œé”™è¯¯å †æ ˆå°†è¿˜åŸä¸ºæ¸…æ™°å¯è¯»çš„æºç è·¯å¾„ï¼Œä¾‹å¦‚ src/components/Checkout.vue:42:8ã€‚æ­¤æ—¶ï¼Œæœ‰æ„ä¹‰çš„å˜é‡åã€ç†Ÿæ‚‰çš„å‡½æ•°åå’Œå®Œæ•´çš„ä»£ç ä¸Šä¸‹æ–‡éƒ½å°†ä¸€è§ˆæ— ä½™ï¼Œè®©å®šä½å’Œæ’æŸ¥é—®é¢˜çš„è¿‡ç¨‹ä»â€œå¤§æµ·æé’ˆâ€å˜ä¸ºâ€œæŒ‰å›¾ç´¢éª¥â€ï¼Œæ•ˆç‡å¾—åˆ°è´¨çš„æå‡ã€‚</p>
<h3 data-id="heading-6">è·å–ä¸‰ä¸ªé‡è¦å‚æ•°</h3>
<p>ã€€ã€€åœ¨é…ç½®ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ç®¡ç†åå°è·å–ä¸‰ä¸ªé‡è¦çš„å‚æ•°ä¿¡æ¯ï¼Œé¦–å…ˆæ˜¯org-slugï¼Œè¡¨ç¤ºç»„ç»‡åç§°ï¼Œè¿›å…¥<code>è®¾ç½® =&gt; å¸¸è§„è®¾ç½® =&gt; Organization Slug</code>å°±å¯ä»¥è·å–ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65a11b7d25d444b388118fab0502f1f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCi5bCP6aOe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768177716&amp;x-signature=6j3RwzSziqeUoBHTQhwXvDmp2RQ%3D" alt="Organization Slug" loading="lazy"/></p>
<p>ã€€ã€€ç„¶åæ˜¯project-slugï¼Œä»£è¡¨æ˜¯é¡¹ç›®çš„åç§°ï¼Œåœ¨Sentryä¸­è¿›å…¥å…·ä½“é¡¹ç›®åï¼Œå¯ä»¥æŸ¥çœ‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/43819fc1ad654c1aaff9b695f5283179~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCi5bCP6aOe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768177716&amp;x-signature=ydltB0xFcbWO%2Fasi8vSPWcyIc60%3D" alt="Project Slug" loading="lazy"/></p>
<p>ã€€ã€€æœ€åä¸€ä¸ªï¼Œä¹Ÿæ˜¯æœ€å…³é”®çš„<code>authToken</code>ï¼Œä»£è¡¨æˆæƒä»¤ç‰Œï¼Œè¿›å…¥<code>è®¾ç½® =&gt; å¼€å‘è®¾ç½® =&gt; Organization Tokens</code>ä¸­åˆ›å»ºä¸€ä¸ªTokenï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1a70f237a04479fb3ed06a61adcdb48~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCi5bCP6aOe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768177716&amp;x-signature=wjAw9XCDLFqVGF%2BgHf4IMZDNXVY%3D" alt="Auth Token" loading="lazy"/></p>
<p>ã€€ã€€æˆ‘ä»¬åœ¨å¼€å‘è®¾ç€ä¸­ä¼šçœ‹åˆ°ä¸¤ç§ç±»å‹çš„Tokenï¼Œä¸€ç§æ˜¯<code>Personal Access Token</code>ï¼Œå¦ä¸€ç§æ˜¯<code>Organization Token</code>ï¼Œå®ƒä»¬ä¹‹é—´ä¸»è¦åŒºåˆ«å¦‚ä¸‹è¡¨ï¼š</p>








































<table><thead><tr><th>ç‰¹æ€§</th><th>Personal Tokens</th><th>Organization Tokens</th></tr></thead><tbody><tr><td>å½’å±ä¸»ä½“</td><td>ä¸ªäººç”¨æˆ·è´¦æˆ·</td><td>ç»„ç»‡</td></tr><tr><td>æƒé™èŒƒå›´</td><td>ç»§æ‰¿ç”¨æˆ·çš„æƒé™</td><td>ç»§æ‰¿ç»„ç»‡æƒé™</td></tr><tr><td>åˆ›å»ºè€…</td><td>ç”¨æˆ·è‡ªå·±</td><td>ç»„ç»‡ç®¡ç†å‘˜æˆ– Owner</td></tr><tr><td>ç”Ÿå‘½å‘¨æœŸ</td><td>ç”¨æˆ·ç¦»èŒåå¤±æ•ˆ</td><td>ä¸ç”¨æˆ·è§£è€¦ï¼ŒæŒç»­æœ‰æ•ˆ</td></tr><tr><td>ä½¿ç”¨åœºæ™¯</td><td>ä¸ªäººå¼€å‘ã€è°ƒè¯•</td><td>å›¢é˜Ÿåä½œã€CI/CDã€è‡ªåŠ¨åŒ–</td></tr><tr><td>å¯è§æ€§</td><td>ä»…åˆ›å»ºè€…å¯è§</td><td>ç»„ç»‡ç®¡ç†å‘˜å¯è§</td></tr></tbody></table>
<p>ã€€ã€€<strong>éœ€è¦æ³¨æ„</strong>çš„æ˜¯ï¼ŒauthTokenä¸åº”ç›´æ¥å†™åœ¨é¡¹ç›®ä»£ç é‡Œï¼Œä»¥å…æ„å¤–æ³„éœ²ã€‚æ¨èçš„å®è·µæ˜¯é…ç½®åœ¨æŒç»­é›†æˆç¯å¢ƒï¼ˆå¦‚ Jenkinsï¼‰çš„æ„å»ºå‚æ•°æˆ–ä¿å¯†å˜é‡ä¸­ï¼Œç„¶ååœ¨æ„å»ºè„šæœ¬ä¸­é€šè¿‡å‘½ä»¤æ¥è°ƒç”¨ï¼Œä¾‹å¦‚æˆ‘ä»¬åœ¨Jenkinsæ„å»ºè„šæœ¬ä¸­æ·»åŠ ç¯å¢ƒå˜é‡ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">export</span> VITE_SENTRY_AUTH_TOKEN=<span class="hljs-string">"ã€your-auth-tokenã€‘"</span>
npm run build
</code></pre>
<blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šé…ç½®Linuxçš„ç¯å¢ƒå˜é‡ï¼Œç­‰å·ä¸¤è¾¹ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p>
</blockquote>
<p>ã€€ã€€æˆ–è€…åœ¨æ„å»ºæœåŠ¡å™¨ä¸Šåˆ›å»º<code>.env.production.local</code>çš„é…ç½®æ–‡ä»¶ï¼Œä¸€èˆ¬gitå¿½ç•¥<code>.env.*.local</code>çš„æ–‡ä»¶ï¼›è¿™æ ·åœ¨æ„å»ºæ—¶ï¼Œä¼šè‡ªåŠ¨æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># .env.production.local</span>
<span class="hljs-attr">VITE_SENTRY_AUTH_TOKEN</span> = sntrys_org_xxx_yyy_zzz
</code></pre>
<h3 data-id="heading-7">æ„å»ºå·¥å…·é…ç½®</h3>
<p>ã€€ã€€ä¸Šé¢æˆ‘ä»¬ä¸Šä¼ sourcemapæ‰€éœ€è¦çš„ä¸‰ä¸ªå‚æ•°ä¿¡æ¯éƒ½æœ‰äº†ï¼Œä¸‹é¢ï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨æ„å»ºå·¥å…·ä¸­è¿›è¡Œé…ç½®ä¸Šä¼ ï¼›å¦‚æœæ˜¯webpacké¡¹ç›®ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> { sentryWebpackPlugin } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'@sentry/webpack-plugin'</span>)

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">devtool</span>: <span class="hljs-string">"hidden-source-map"</span>,
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-title function_">sentryWebpackPlugin</span>({
      <span class="hljs-attr">url</span>: <span class="hljs-string">'ã€your-urlã€‘'</span>,
      <span class="hljs-attr">org</span>: <span class="hljs-string">'ã€org-slugã€‘'</span>,
      <span class="hljs-attr">project</span>: <span class="hljs-string">'ã€project-slugã€‘'</span>,
      <span class="hljs-attr">authToken</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">VUE_SENTRY_AUTH_TOKEN</span>,
      <span class="hljs-attr">release</span>: {
        <span class="hljs-attr">name</span>: <span class="hljs-string">`ã€project-slugã€‘@ã€versionã€‘`</span>,
      },
      <span class="hljs-attr">sourcemaps</span>: {
        <span class="hljs-attr">filesToDeleteAfterUpload</span>: [
          <span class="hljs-string">"./dist/**/*.map"</span>,
        ],
      },
    }),
  ],
}
</code></pre>
<p>ã€€ã€€å¦‚æœæ˜¯viteé¡¹ç›®ï¼Œç¼–è¾‘<code>vite.config.ts</code>æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { sentryVitePlugin } <span class="hljs-keyword">from</span> <span class="hljs-string">'@sentry/vite-plugin'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">build</span>: {
    <span class="hljs-attr">sourcemap</span>: <span class="hljs-string">"hidden"</span>,
  },
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-title function_">sentryVitePlugin</span>({
      <span class="hljs-attr">url</span>: <span class="hljs-string">'ã€your-urlã€‘'</span>,
      <span class="hljs-attr">org</span>: <span class="hljs-string">'ã€org-slugã€‘'</span>,
      <span class="hljs-attr">project</span>: <span class="hljs-string">'ã€project-slugã€‘'</span>,
      <span class="hljs-attr">authToken</span>: <span class="hljs-variable constant_">VITE_SENTRY_AUTH_TOKEN</span> || <span class="hljs-string">''</span>,
      <span class="hljs-attr">release</span>: {
        <span class="hljs-attr">name</span>: <span class="hljs-string">`ã€project-slugã€‘@ã€versionã€‘`</span>,
      },
      <span class="hljs-attr">sourcemaps</span>: {
        <span class="hljs-attr">filesToDeleteAfterUpload</span>: [
          <span class="hljs-string">'./dist/assets/*.map'</span>
        ],
      },
    }),
  ]
}
</code></pre>
<blockquote>
<p>urléœ€è¦æ”¹ä¸ºè‡ªå·±æœåŠ¡å™¨çš„åœ°å€ï¼Œå¦‚æœä¸å†™é»˜è®¤ä¼šä¼ åˆ°Sentryçš„å®˜æ–¹æœåŠ¡å™¨ã€‚</p>
</blockquote>
<p>ã€€ã€€è¿™é‡Œçš„<code>filesToDeleteAfterUpload</code>å­—æ®µï¼Œéƒ½æ˜¯ç”¨æ¥åœ¨ä¸Šä¼ æˆåŠŸåï¼Œåˆ é™¤æœ¬åœ°çš„sourcemapæ–‡ä»¶ï¼Œé˜²æ­¢sourcemapæ–‡ä»¶æ³„æ¼ï¼›è€Œ<code>release</code>å­—æ®µï¼Œåˆ™æ˜¯ç”¨æ¥æŒ‡å®šä¸Šä¼ çš„ç‰ˆæœ¬å·ï¼Œéœ€è¦å’Œä¸Šé¢Sentry.initä¸­çš„releaseé…ç½®ä¸€è‡´ã€‚</p>
<p>ã€€ã€€å¦‚æœåç»­å†æ¬¡å‡ºç°æŠ¥é”™,æˆ‘ä»¬å¯ä»¥åœ¨Sentryä¸­å¾ˆæ–¹ä¾¿çš„å®šä½åˆ°æŠ¥é”™æºç ä½ç½®ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d5355ca5ee0e42c18e91ee4336df5d93~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LCi5bCP6aOe:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768177716&amp;x-signature=Lj7Vavd8zxLH1imaAFst99OcJlc%3D" alt="æ˜ å°„å¯¹åº”æºç ä½ç½®" loading="lazy"/></p>
<h2 data-id="heading-8">æ€»ç»“</h2>
<p>ã€€ã€€ğŸ‰ æ­å–œä½ ï¼è·Ÿç€æœ¬æ–‡æŒ‡å—èµ°å®Œï¼Œç›¸ä¿¡ä½ å·²ç»æˆåŠŸä¸ºä½ çš„å‰ç«¯é¡¹ç›®è¯·æ¥äº†ä¸€ä½ â€œ7 * 24å°æ—¶ä¸çœ¨çœ¼çš„å…¨èƒ½å“¨å…µâ€ â€”â€”Sentryï¼æ•´ä¸ªéƒ¨ç½²è¿‡ç¨‹ä»Sentryç§æœ‰åŒ–æœåŠ¡æ­å»ºå¼€å§‹ï¼Œæˆ‘ä»¬é€šè¿‡Docker Composeåœ¨ç‹¬ç«‹æœåŠ¡å™¨ä¸Šå»ºç«‹äº†ä¸“å±ç›‘æ§ä¸­å¿ƒï¼Œç¡®ä¿æ•°æ®å®‰å…¨å¯æ§ã€‚è¿™å°±åƒæ˜¯ç»™é¡¹ç›®é…å¤‡äº†ä¸€ä¸ª24å°æ—¶ä¸çœ¨çœ¼çš„æ•°å­—å“¨å…µã€‚</p>
<p>ã€€ã€€åœ¨é¡¹ç›®é›†æˆç¯èŠ‚ï¼Œæˆ‘ä»¬ä»åŸºç¡€SDKé…ç½®å…¥æ‰‹ï¼Œé€æ­¥å®ç°äº†é”™è¯¯æ•è·ã€ç”¨æˆ·è¿½è¸ªã€æ€§èƒ½ç›‘æ§ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚ç‰¹åˆ«é’ˆå¯¹Vueç”Ÿæ€ï¼Œæˆ‘ä»¬é…ç½®äº†è·¯ç”±è¿½è¸ªã€PiniaçŠ¶æ€ç›‘æ§ã€ç»„ä»¶ç”Ÿå‘½å‘¨æœŸè¿½è¸ªç­‰é’ˆå¯¹æ€§æ–¹æ¡ˆï¼Œè®©ç›‘æ§è¦†ç›–åˆ°åº”ç”¨çš„æ¯ä¸ªè§’è½ã€‚</p>
<p>ã€€ã€€å…³é”®æŠ€æœ¯é…ç½®æ–¹é¢ï¼Œæˆ‘ä»¬é‡ç‚¹è§£å†³äº†ç”Ÿäº§ç¯å¢ƒè°ƒè¯•çš„ä¸¤å¤§éš¾é¢˜ï¼šä¸€æ˜¯é€šè¿‡Source Mapè‡ªåŠ¨ä¸Šä¼ æœºåˆ¶ï¼Œå°†å‹ç¼©ä»£ç çš„æŠ¥é”™ä¿¡æ¯è¿˜åŸä¸ºå¯è¯»çš„æºç ä½ç½®ï¼›äºŒæ˜¯é€šè¿‡æ™ºèƒ½é‡‡æ ·ç­–ç•¥ï¼Œåœ¨ç›‘æ§ç²¾åº¦ä¸ç³»ç»Ÿå¼€é”€ä¹‹é—´æ‰¾åˆ°æœ€ä½³å¹³è¡¡ç‚¹ã€‚</p>
<p>ã€€ã€€æœ€ç»ˆï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªä»å‰ç«¯å¼‚å¸¸å‘ç”Ÿåˆ°å¼€å‘å›¢é˜Ÿå“åº”çš„å®Œæ•´é—­ç¯ã€‚ç°åœ¨å½“çº¿ä¸Šé—®é¢˜å‡ºç°æ—¶ï¼Œä¸å†éœ€è¦ä¾èµ–ç”¨æˆ·æ¨¡ç³Šçš„æè¿°ï¼Œè€Œæ˜¯å¯ä»¥ç›´æ¥æŸ¥çœ‹é”™è¯¯è¯¦æƒ…ã€ç”¨æˆ·æ“ä½œå›æ”¾ã€æ€§èƒ½æ•°æ®ç­‰å¤šç»´åº¦ä¿¡æ¯ï¼Œå¤§å¤§ç¼©çŸ­äº†é—®é¢˜æ’æŸ¥æ—¶é—´ã€‚ä»æ­¤ï¼Œçº¿ä¸Šbugä¸å†æ˜¯â€œè–›å®šè°”çš„çŒ«â€ï¼Œè®©æ¯ä¸ªçº¿ä¸Šé—®é¢˜éƒ½æ— å¤„éå½¢ï¼Œæ˜¾è‘—æå‡äº†åº”ç”¨çš„ç¨³å®šæ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
<p>å¦‚æœè§‰å¾—å†™å¾—è¿˜ä¸é”™ï¼Œè¯·å…³æ³¨æˆ‘çš„<a href="//juejin.im/user/580038cebf22ec0064bd0b2d" target="_blank" title="//juejin.im/user/580038cebf22ec0064bd0b2d">æ˜é‡‘ä¸»é¡µ</a>ã€‚æ›´å¤šæ–‡ç« è¯·è®¿é—®<a href="https://link.juejin.cn?target=http%3A%2F%2Fxieyufei.com" target="_blank" title="http://xieyufei.com" ref="nofollow noopener noreferrer">è°¢å°é£çš„åšå®¢</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŒäº‹é—®æˆ‘ MySQL ç”¨å•¥æ’åºè§„åˆ™ï¼Œæˆ‘å·®ç‚¹ç­”ä¸ä¸Šæ¥]]></title>    <link>https://juejin.cn/post/7591350620189196294</link>    <guid>https://juejin.cn/post/7591350620189196294</guid>    <pubDate>2026-01-05T00:46:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591350620189196294" data-draft-id="7581678301216473088" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŒäº‹é—®æˆ‘ MySQL ç”¨å•¥æ’åºè§„åˆ™ï¼Œæˆ‘å·®ç‚¹ç­”ä¸ä¸Šæ¥"/> <meta itemprop="keywords" content="åç«¯,MySQL"/> <meta itemprop="datePublished" content="2026-01-05T00:46:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å¤§å"/> <meta itemprop="url" content="https://juejin.cn/user/3507878440995946"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŒäº‹é—®æˆ‘ MySQL ç”¨å•¥æ’åºè§„åˆ™ï¼Œæˆ‘å·®ç‚¹ç­”ä¸ä¸Šæ¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3507878440995946/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å¤§å
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-05T00:46:14.000Z" title="Mon Jan 05 2026 00:46:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‰å‡ å¤©ï¼Œæˆ‘åœ¨å»ºæ•°æ®åº“çš„æ—¶å€™ï¼ŒåŒäº‹åˆšå¥½åœ¨æˆ‘æ—è¾¹ï¼Œä»–é—®æˆ‘ï¼šâ€œä½ å»ºåº“ä¸€èˆ¬ç”¨ä»€ä¹ˆæ’åºè§„åˆ™ï¼Œæ€ä¹ˆæ„Ÿè§‰éƒ½ä¸€æ ·å•Šï¼â€ã€‚</p>
<p>æœ¬æ¥æˆ‘è¿˜æƒ³è£…ä¸€ä¸‹çš„ï¼Œå¯å‘ç°æˆ‘è¶Šè®²è¶Šä¸å¯¹ï¼Œèµ¶ç´§å»æœäº†ä¸€ä¸‹ç›¸å…³çŸ¥è¯†ï¼Œè¿™å¯ç»ˆäºæ•´æ˜ç™½äº†ã€‚</p>
<p>ä¸‹é¢ç»™å¤§å®¶åˆ†äº«ä¸€ä¸‹ã€‚</p>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯æ’åºè§„åˆ™ï¼ˆCollationï¼‰ï¼Ÿ</h2>
<p>ç®€å•è¯´ï¼š<strong>æ’åºè§„åˆ™å†³å®šäº† MySQL æ€ä¹ˆâ€œçœ‹â€å­—ç¬¦ä¸²ã€‚</strong></p>
<p>æ¯”å¦‚ï¼š</p>
<ul>
<li>å®ƒè®¤ä¸º <code>'A'</code> å’Œ <code>'a'</code> æ˜¯ä¸€æ ·çš„å—ï¼Ÿ</li>
<li>å®ƒè§‰å¾— <code>'Ã©'</code> å’Œ <code>'e'</code> è¦ä¸è¦åŒºåˆ†ï¼Ÿ</li>
<li>ä¸­æ–‡å­—ç¬¦æŒ‰ä»€ä¹ˆé¡ºåºæ’ï¼Ÿ</li>
</ul>
<p><strong>Collationï¼ˆæ’åºè§„åˆ™ï¼‰</strong> å°±æ˜¯è§£å†³è¿™äº›é—®é¢˜çš„ã€‚</p>
<h2 data-id="heading-1">æ’åºè§„åˆ™é•¿ä»€ä¹ˆæ ·ï¼Ÿ</h2>
<p>MySQL çš„æ’åºè§„åˆ™åå­—é€šå¸¸åƒè¿™æ ·ï¼š</p>
<pre><code class="hljs">utf8mb4_0900_ai_ci
utf8mb4_general_ci
utf8mb4_bin
</code></pre>
<p>å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83e44148eae64b7e8c59099fb5b942ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5aSn5Y2O:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768178773&amp;x-signature=%2FKHzaSGW0fFcRp07v4Az%2FRmQgM8%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ä»¬æ‹†å¼€æ¥çœ‹ï¼š</p>





























<table><thead><tr><th>éƒ¨åˆ†</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><code>utf8mb4</code></td><td>å­—ç¬¦é›†ï¼ˆæ”¯æŒ emojiã€ä¸­æ–‡ã€è‹±æ–‡ç­‰æ‰€æœ‰ Unicode å­—ç¬¦ï¼‰</td></tr><tr><td><code>0900</code></td><td>åŸºäº Unicode 9.0.0 æ ‡å‡†ï¼ˆMySQL 8.0+ æ–°ç‰¹æ€§ï¼‰</td></tr><tr><td><code>ai</code> / <code>as</code></td><td>Accent Insensitiveï¼ˆä¸åŒºåˆ†é‡éŸ³ï¼‰ / Accent Sensitiveï¼ˆåŒºåˆ†é‡éŸ³ï¼‰</td></tr><tr><td><code>ci</code> / <code>cs</code></td><td>Case Insensitiveï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ / Case Sensitiveï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</td></tr><tr><td><code>bin</code></td><td>Binaryï¼ˆäºŒè¿›åˆ¶æ¯”è¾ƒï¼Œæœ€ä¸¥æ ¼ï¼‰</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-2">ä¸¾ä¸ªæ —å­ï¼šä¸åŒæ’åºè§„åˆ™çš„åŒºåˆ«</h2>
<p>æˆ‘ä»¬åˆ›å»ºä¸‰ä¸ªè¡¨ï¼Œåˆ†åˆ«ç”¨ä¸åŒçš„æ’åºè§„åˆ™ï¼Œçœ‹çœ‹æ•ˆæœï¼š</p>
<h3 data-id="heading-3">åœºæ™¯1ï¼šå¤§å°å†™æ•æ„Ÿå—ï¼Ÿ</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- è¡¨1ï¼šä½¿ç”¨ utf8mb4_0900_ai_ciï¼ˆé»˜è®¤ï¼Œä¸åŒºåˆ†å¤§å°å†™ï¼‰</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> users_ci (
  name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>)
) <span class="hljs-keyword">COLLATE</span> utf8mb4_0900_ai_ci;

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> users_ci <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'Alice'</span>), (<span class="hljs-string">'alice'</span>);

<span class="hljs-comment">-- æŸ¥è¯¢</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> users_ci <span class="hljs-keyword">WHERE</span> name <span class="hljs-operator">=</span> <span class="hljs-string">'ALICE'</span>;
<span class="hljs-comment">-- ç»“æœï¼šè¿”å› Alice å’Œ aliceï¼ˆå› ä¸ºä¸åŒºåˆ†å¤§å°å†™ï¼‰</span>
</code></pre>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- è¡¨2ï¼šä½¿ç”¨ utf8mb4_binï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> users_bin (
  name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>)
) <span class="hljs-keyword">COLLATE</span> utf8mb4_bin;

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> users_bin <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'Alice'</span>), (<span class="hljs-string">'alice'</span>);

<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> users_bin <span class="hljs-keyword">WHERE</span> name <span class="hljs-operator">=</span> <span class="hljs-string">'ALICE'</span>;
<span class="hljs-comment">-- ç»“æœï¼šç©ºï¼å› ä¸º 'ALICE' â‰  'Alice' â‰  'alice'</span>
</code></pre>
<p><strong>ç»“è®º</strong>ï¼š<code>_ci</code> ä¸åŒºåˆ†å¤§å°å†™ï¼Œ<code>_bin</code> åŒºåˆ†ã€‚</p>
<hr/>
<h3 data-id="heading-4">åœºæ™¯2ï¼šé‡éŸ³ç¬¦å·è¦ä¸è¦ç®¡ï¼Ÿ</h3>
<p>æ¯”å¦‚æ³•è¯­ä¸­çš„ <code>cafÃ©</code> å’Œ <code>cafe</code>ã€‚</p>
<ul>
<li>åœ¨ <code>_ai</code>ï¼ˆAccent Insensitiveï¼‰è§„åˆ™ä¸‹ï¼š<code>cafÃ© = cafe</code></li>
<li>åœ¨ <code>_as</code> æˆ– <code>_bin</code> è§„åˆ™ä¸‹ï¼š<code>cafÃ© â‰  cafe</code></li>
</ul>
<p>MySQL 8.0+ æ”¯æŒæ›´ç²¾ç»†çš„æ§åˆ¶ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">utf8mb4_0900_as_cs  <span class="hljs-comment">-- åŒºåˆ†å¤§å°å†™ + åŒºåˆ†é‡éŸ³</span>
utf8mb4_0900_ai_ci  <span class="hljs-comment">-- ä¸åŒºåˆ†å¤§å°å†™ + ä¸åŒºåˆ†é‡éŸ³ï¼ˆé»˜è®¤ï¼‰</span>
</code></pre>
<hr/>
<h3 data-id="heading-5">åœºæ™¯3ï¼šä¸­æ–‡æ’åºä¹±åºï¼Ÿ</h3>
<p>å¦‚æœä½ ç”¨ <code>utf8mb4_general_ci</code> æ’ä¸­æ–‡ï¼Œå¯èƒ½ä¼šå‘ç°ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> name <span class="hljs-keyword">FROM</span> users <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> name;
<span class="hljs-comment">-- ç»“æœï¼šå¼ ä¸‰ã€æå››ã€ç‹äº”â€¦â€¦é¡ºåºçœ‹èµ·æ¥â€œä¸å¯¹â€</span>
</code></pre>
<p>è¿™æ˜¯å› ä¸º <code>general_ci</code> æ˜¯ä¸€ç§<strong>ç®€åŒ–çš„æ’åºç®—æ³•</strong>ï¼Œå®ƒä¸ºäº†é€Ÿåº¦ç‰ºç‰²äº†å‡†ç¡®æ€§ã€‚</p>
<p><strong>æ­£ç¡®åšæ³•</strong>ï¼šç”¨ <code>utf8mb4_unicode_ci</code> æˆ–æ›´å¥½çš„ <code>utf8mb4_0900_ai_ci</code>ï¼ˆMySQL 8.0 é»˜è®¤ï¼‰ï¼Œå®ƒä»¬åŸºäº Unicode æ ‡å‡†ï¼Œå¯¹ä¸­æ–‡ã€æ—¥æ–‡ã€éŸ©æ–‡ç­‰æ”¯æŒæ›´å¥½ã€‚</p>
<hr/>
<h2 data-id="heading-6">ä¸»è¦åŒºåˆ«ç»´åº¦</h2>
<hr/>
<h3 data-id="heading-7">1. <strong>å¤§å°å†™æ•æ„Ÿæ€§ï¼ˆCase Sensitivityï¼‰</strong></h3>
<ul>
<li><strong>_ci</strong>ï¼šCase Insensitiveï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰
<ul>
<li>ä¾‹å¦‚ï¼š<code>utf8_general_ci</code> ä¸­ <code>'A' = 'a'</code></li>
</ul>
</li>
<li><strong>_cs</strong> æˆ– <strong>_bin</strong>ï¼šCase Sensitiveï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰
<ul>
<li><code>utf8_bin</code> æˆ– <code>utf8mb4_0900_cs</code> ä¸­ <code>'A' â‰  'a'</code></li>
</ul>
</li>
</ul>
<p>æ³¨æ„ï¼š<code>_cs</code>ï¼ˆCase Sensitiveï¼‰åœ¨æ—§ç‰ˆæœ¬ä¸­è¾ƒå°‘è§ï¼ŒMySQL 8.0 å¼•å…¥äº†æ›´æ ‡å‡†çš„å‘½åå¦‚ <code>utf8mb4_0900_cs</code>ã€‚</p>
<hr/>
<h3 data-id="heading-8">2. <strong>é‡éŸ³ç¬¦å·æ•æ„Ÿæ€§ï¼ˆAccent Sensitivityï¼‰</strong></h3>
<ul>
<li><strong>_ai</strong>ï¼šAccent Insensitiveï¼ˆä¸åŒºåˆ†é‡éŸ³ï¼‰</li>
<li><strong>_as</strong>ï¼šAccent Sensitiveï¼ˆåŒºåˆ†é‡éŸ³ï¼‰</li>
</ul>
<p>åœ¨ MySQL 8.0+ ä¸­ï¼Œéƒ¨åˆ†æ’åºè§„åˆ™æ”¯æŒ <code>_as</code>/<code>_ai</code>ï¼Œä¾‹å¦‚ <code>utf8mb4_0900_as_cs</code> è¡¨ç¤ºæ—¢åŒºåˆ†å¤§å°å†™åˆåŒºåˆ†é‡éŸ³ã€‚</p>
<hr/>
<h3 data-id="heading-9">3. <strong>äºŒè¿›åˆ¶æ’åºï¼ˆBinary Collationï¼‰</strong></h3>
<ul>
<li>ä»¥ <code>_bin</code> ç»“å°¾ï¼ˆå¦‚ <code>utf8mb4_bin</code>ï¼‰</li>
<li>æŒ‰ç…§å­—ç¬¦çš„äºŒè¿›åˆ¶å€¼ï¼ˆå­—èŠ‚å€¼ï¼‰è¿›è¡Œæ¯”è¾ƒï¼Œ<strong>ä¸¥æ ¼åŒºåˆ†å¤§å°å†™ã€é‡éŸ³ã€ç¼–ç é¡ºåº</strong></li>
<li>ä¸ä½¿ç”¨è¯­è¨€è§„åˆ™ï¼Œé€Ÿåº¦è¾ƒå¿«ä½†ä¸ç¬¦åˆäººç±»è¯­è¨€ä¹ æƒ¯</li>
</ul>
<hr/>
<h3 data-id="heading-10">4. <strong>è¯­è¨€/åŒºåŸŸç‰¹å®šæ’åº</strong></h3>
<p>æŸäº›æ’åºè§„åˆ™é’ˆå¯¹ç‰¹å®šè¯­è¨€ä¼˜åŒ–ï¼š</p>
<ul>
<li><code>utf8mb4_spanish_ci</code>ï¼šè¥¿ç­ç‰™è¯­æ’åºï¼ˆå¦‚ Ã± æ’åœ¨ n ä¹‹åï¼‰</li>
<li><code>utf8mb4_german2_ci</code>ï¼šå¾·è¯­ç”µè¯ç°¿æ’åºè§„åˆ™</li>
<li><code>utf8mb4_ja_0900_as_cs</code>ï¼šæ—¥è¯­æ’åºï¼ˆéœ€ MySQL 8.0+ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-11">5. <strong>Unicode ç‰ˆæœ¬å·®å¼‚ï¼ˆMySQL 8.0+ï¼‰</strong></h3>
<p>MySQL 8.0 é»˜è®¤ä½¿ç”¨åŸºäº <strong>Unicode 9.0</strong> çš„æ’åºè§„åˆ™ï¼ˆå¦‚ <code>utf8mb4_0900_ai_ci</code>ï¼‰ï¼š</p>
<ul>
<li>æ›´å‡†ç¡®çš„å¤šè¯­è¨€æ”¯æŒ</li>
<li>æ›´å¥½çš„æ€§èƒ½ï¼ˆç›¸æ¯”æ—§çš„ <code>utf8mb4_general_ci</code>ï¼‰</li>
<li><code>0900</code> è¡¨ç¤ºåŸºäº Unicode 9.0.0</li>
</ul>
<p>å¯¹æ¯”ï¼š</p>
<ul>
<li><code>utf8mb4_general_ci</code>ï¼šæ—§ç‰ˆï¼Œé€Ÿåº¦å¿«ä½†æ’åºä¸å‡†ç¡®ï¼ˆå¦‚è®¤ä¸º <code>'Ã¶' = 'o'</code>ï¼‰</li>
<li><code>utf8mb4_unicode_ci</code>ï¼šåŸºäº Unicode 4.0ï¼Œè¾ƒå‡†ç¡®</li>
<li><code>utf8mb4_0900_ai_ci</code>ï¼šMySQL 8.0 é»˜è®¤ï¼ŒåŸºäº Unicode 9.0ï¼Œæ›´å‡†ç¡®é«˜æ•ˆ</li>
</ul>
<hr/>
<h3 data-id="heading-12">å¸¸è§æ’åºè§„åˆ™å¯¹æ¯”ç¤ºä¾‹</h3>









































<table><thead><tr><th>æ’åºè§„åˆ™</th><th>å¤§å°å†™æ•æ„Ÿ</th><th>é‡éŸ³æ•æ„Ÿ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>utf8mb4_general_ci</code></td><td>å¦</td><td>å¦</td><td>æ—§ç‰ˆé€šç”¨ï¼Œé€Ÿåº¦å¿«ä½†ä¸å‡†</td></tr><tr><td><code>utf8mb4_unicode_ci</code></td><td>å¦</td><td>å¦</td><td>åŸºäº Unicode 4.0ï¼Œè¾ƒå‡†ç¡®</td></tr><tr><td><code>utf8mb4_0900_ai_ci</code></td><td>å¦</td><td>å¦</td><td>MySQL 8.0 é»˜è®¤ï¼ŒåŸºäº Unicode 9.0</td></tr><tr><td><code>utf8mb4_0900_as_cs</code></td><td>æ˜¯</td><td>æ˜¯</td><td>åŒºåˆ†å¤§å°å†™å’Œé‡éŸ³</td></tr><tr><td><code>utf8mb4_bin</code></td><td>æ˜¯</td><td>æ˜¯</td><td>äºŒè¿›åˆ¶æ¯”è¾ƒï¼Œæœ€å¿«ä½†æœ€â€œæœºæ¢°â€</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-13">å¦‚ä½•æŸ¥çœ‹å¯ç”¨æ’åºè§„åˆ™ï¼Ÿ</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">COLLATION</span> <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'utf8mb4%'</span>;
</code></pre>
<h3 data-id="heading-14">å¦‚ä½•è®¾ç½®æ’åºè§„åˆ™ï¼Ÿ</h3>
<p>æ•°æ®åº“çº§ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> DATABASE db_name <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> utf8mb4 <span class="hljs-keyword">COLLATE</span> utf8mb4_0900_ai_ci;
</code></pre>
<p>è¡¨çº§ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t (name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>)) <span class="hljs-keyword">COLLATE</span> utf8mb4_bin;
</code></pre>
<p>åˆ—çº§ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">COLLATE</span> utf8mb4_0900_as_cs
</code></pre>
<p>æŸ¥è¯¢æ—¶ä¸´æ—¶æŒ‡å®šï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> name <span class="hljs-keyword">COLLATE</span> utf8mb4_bin;
</code></pre>
<hr/>
<h2 data-id="heading-15">å®é™…å»ºè®®</h2>
<ul>
<li><strong>ä¸€èˆ¬åº”ç”¨</strong>ï¼šä½¿ç”¨ <code>utf8mb4_0900_ai_ci</code>ï¼ˆMySQL 8.0+ï¼‰æˆ– <code>utf8mb4_unicode_ci</code>ï¼ˆæ—§ç‰ˆæœ¬ï¼‰</li>
<li><strong>éœ€è¦åŒºåˆ†å¤§å°å†™</strong>ï¼šç”¨ <code>utf8mb4_0900_as_cs</code> æˆ– <code>utf8mb4_bin</code></li>
<li><strong>æ€§èƒ½æ•æ„Ÿä¸”æ— éœ€è¯­è¨€è§„åˆ™</strong>ï¼šç”¨ <code>_bin</code></li>
<li><strong>é¿å…ä½¿ç”¨ <code>utf8mb4_general_ci</code></strong>ï¼ˆé™¤éå…¼å®¹æ—§ç³»ç»Ÿï¼‰ï¼Œå› å…¶æ’åºé€»è¾‘ä¸å‡†ç¡®</li>
</ul>
<h2 data-id="heading-16">æ€»ç»“</h2>
<ul>
<li><strong>æ’åºè§„åˆ™ = å­—ç¬¦ä¸²çš„â€œæ¯”è¾ƒè§„åˆ™â€</strong></li>
<li><code>_ci</code> = ä¸åŒºåˆ†å¤§å°å†™ï¼Œ<code>_cs</code>/<code>_bin</code> = åŒºåˆ†</li>
<li>MySQL 8.0 é»˜è®¤çš„ <code>utf8mb4_0900_ai_ci</code> æ˜¯ç›®å‰<strong>æœ€æ¨è</strong>çš„é€‰æ‹©</li>
<li>ä¸­æ–‡ã€å¤šè¯­è¨€é¡¹ç›®<strong>ä¸è¦ç”¨ <code>general_ci</code></strong>ï¼Œå®ƒå·²ç»è¿‡æ—¶äº†</li>
<li>ç”¨æˆ·åã€å¯†ç ç­‰å…³é”®å­—æ®µï¼Œå»ºè®®ç”¨åŒºåˆ†å¤§å°å†™çš„è§„åˆ™</li>
</ul>
<blockquote>
<p>æœ¬æ–‡é¦–å‘äºå…¬ä¼—å·ï¼šç¨‹åºå‘˜åˆ˜å¤§åï¼Œä¸“æ³¨åˆ†äº«å‰åç«¯å¼€å‘çš„å®æˆ˜ç¬”è®°ã€‚å…³æ³¨æˆ‘ï¼Œå°‘èµ°å¼¯è·¯ï¼Œä¸€èµ·è¿›æ­¥ï¼</p>
</blockquote>
<h4 data-id="heading-17">ğŸ“Œå¾€æœŸç²¾å½©</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FU3HhCz5WiAMNM7foxuTa0w" target="_blank" title="https://mp.weixin.qq.com/s/U3HhCz5WiAMNM7foxuTa0w" ref="nofollow noopener noreferrer">ã€Šå‰ç«¯é«˜æ‰‹æ‰çŸ¥é“çš„ç§˜å¯†ï¼šBlob å±…ç„¶è¿™ä¹ˆå¼ºå¤§ã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FX-MSa0CHwVW_qgPezbpMUA" target="_blank" title="https://mp.weixin.qq.com/s/X-MSa0CHwVW_qgPezbpMUA" ref="nofollow noopener noreferrer">ã€Šè¿™ 5 ä¸ªå†·é—¨ HTML æ ‡ç­¾ï¼Œè®©æˆ‘ç›´æ¥åˆ äº†100 è¡Œ JS ä»£ç ã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FsMAKhSLNvmU1ddxg0yv9Fg" target="_blank" title="https://mp.weixin.qq.com/s/sMAKhSLNvmU1ddxg0yv9Fg" ref="nofollow noopener noreferrer">ã€Šé‡æ„äº†20ä¸ªSpringBooté¡¹ç›®åï¼Œæ€»ç»“å‡ºè¿™å¥—ç¨³å®šé«˜æ•ˆçš„æ¶æ„è®¾è®¡ã€‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F184BGM_pdMFLc0ASrferwQ" target="_blank" title="https://mp.weixin.qq.com/s/184BGM_pdMFLc0ASrferwQ" ref="nofollow noopener noreferrer">ã€Šä»£ç é‡Œå…¨æ˜¯ new å¯¹è±¡ï¼ŒçœŸçš„å¾ˆ Low å—ï¼Ÿæˆ‘è®¤çœŸæƒ³äº†ä¸€æ™šã€‹</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ« Kotlin ä¸­è‡ƒè‚¿çš„ when è¡¨è¾¾å¼]]></title>    <link>https://juejin.cn/post/7591330139083735055</link>    <guid>https://juejin.cn/post/7591330139083735055</guid>    <pubDate>2026-01-05T00:46:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591330139083735055" data-draft-id="7587253759092654116" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ« Kotlin ä¸­è‡ƒè‚¿çš„ when è¡¨è¾¾å¼"/> <meta itemprop="keywords" content="Kotlin,Android"/> <meta itemprop="datePublished" content="2026-01-05T00:46:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="RockByte"/> <meta itemprop="url" content="https://juejin.cn/user/1046390797768519"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ« Kotlin ä¸­è‡ƒè‚¿çš„ when è¡¨è¾¾å¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1046390797768519/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    RockByte
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-05T00:46:53.000Z" title="Mon Jan 05 2026 00:46:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body .octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}.markdown-body .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown-body .anchor:focus{outline:none}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1:hover .anchor .octicon-link:before,.markdown-body h2:hover .anchor .octicon-link:before,.markdown-body h3:hover .anchor .octicon-link:before,.markdown-body h4:hover .anchor .octicon-link:before,.markdown-body h5:hover .anchor .octicon-link:before,.markdown-body h6:hover .anchor .octicon-link:before{width:16px;height:16px;content:" ";display:inline-block;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E")}.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body details{display:block}.markdown-body summary{display:list-item}.markdown-body a{background-color:initial}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body strong{font-weight:inherit;font-weight:bolder}.markdown-body h1{margin:.67em 0}.markdown-body img{border-style:none}.markdown-body code,.markdown-body kbd,.markdown-body pre{font-family:monospace,monospace;font-size:1em}.markdown-body hr{box-sizing:initial;overflow:visible}.markdown-body input{font:inherit;margin:0;overflow:visible}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body input{font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body a{color:#0366d6;text-decoration:none}.markdown-body a:hover{text-decoration:underline}.markdown-body strong{font-weight:600}.markdown-body hr{height:0;margin:15px 0;overflow:hidden;background:transparent;border-bottom:1px solid #dfe2e5}.markdown-body hr:after,.markdown-body hr:before{display:table;content:""}.markdown-body hr:after{clear:both}.markdown-body table{border-spacing:0;border-collapse:collapse}.markdown-body td,.markdown-body th{padding:0}.markdown-body details summary{cursor:pointer}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:0;margin-bottom:0}.markdown-body h1{font-size:32px}.markdown-body h1,.markdown-body h2{font-weight:600}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:20px}.markdown-body h3,.markdown-body h4{font-weight:600}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:14px}.markdown-body h5,.markdown-body h6{font-weight:600}.markdown-body h6{font-size:12px}.markdown-body p{margin-top:0;margin-bottom:10px}.markdown-body blockquote{margin:0}.markdown-body ol,.markdown-body ul{padding-left:0;margin-top:0;margin-bottom:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body dd{margin-left:0}.markdown-body code,.markdown-body pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}.markdown-body pre{margin-top:0;margin-bottom:0}.markdown-body input::-webkit-inner-spin-button,.markdown-body input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none;appearance:none}.markdown-body :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}.markdown-body .border{border:1px solid #e1e4e8!important}.markdown-body .border-0{border:0!important}.markdown-body .border-bottom{border-bottom:1px solid #e1e4e8!important}.markdown-body .rounded-1{border-radius:3px!important}.markdown-body .bg-white{background-color:#fff!important}.markdown-body .bg-gray-light{background-color:#fafbfc!important}.markdown-body .text-gray-light{color:#6a737d!important}.markdown-body .pl-3,.markdown-body .px-3{padding-left:16px!important}.markdown-body .px-3{padding-right:16px!important}.markdown-body .f6{font-size:12px!important}.markdown-body .lh-condensed{line-height:1.25!important}.markdown-body .text-bold{font-weight:600!important}.markdown-body .pl-c{color:#6a737d}.markdown-body .pl-c1,.markdown-body .pl-s .pl-v{color:#005cc5}.markdown-body .pl-e,.markdown-body .pl-en{color:#6f42c1}.markdown-body .pl-s .pl-s1,.markdown-body .pl-smi{color:#24292e}.markdown-body .pl-ent{color:#22863a}.markdown-body .pl-k{color:#d73a49}.markdown-body .pl-pds,.markdown-body .pl-s,.markdown-body .pl-s .pl-pse .pl-s1,.markdown-body .pl-sr,.markdown-body .pl-sr .pl-cce,.markdown-body .pl-sr .pl-sra,.markdown-body .pl-sr .pl-sre{color:#032f62}.markdown-body .pl-smw,.markdown-body .pl-v{color:#e36209}.markdown-body .pl-bu{color:#b31d28}.markdown-body .pl-ii{color:#fafbfc;background-color:#b31d28}.markdown-body .pl-c2{color:#fafbfc;background-color:#d73a49}.markdown-body .pl-c2:before{content:"^M"}.markdown-body .pl-sr .pl-cce{font-weight:700;color:#22863a}.markdown-body .pl-ml{color:#735c0f}.markdown-body .pl-mh,.markdown-body .pl-mh .pl-en,.markdown-body .pl-ms{font-weight:700;color:#005cc5}.markdown-body .pl-mi{font-style:italic;color:#24292e}.markdown-body .pl-mb{font-weight:700;color:#24292e}.markdown-body .pl-md{color:#b31d28;background-color:#ffeef0}.markdown-body .pl-mi1{color:#22863a;background-color:#f0fff4}.markdown-body .pl-mc{color:#e36209;background-color:#ffebda}.markdown-body .pl-mi2{color:#f6f8fa;background-color:#005cc5}.markdown-body .pl-mdr{font-weight:700;color:#6f42c1}.markdown-body .pl-ba{color:#586069}.markdown-body .pl-sg{color:#959da5}.markdown-body .pl-corl{text-decoration:underline;color:#032f62}.markdown-body .mb-0{margin-bottom:0!important}.markdown-body .my-2{margin-bottom:8px!important;margin-top:8px!important}.markdown-body .pl-0{padding-left:0!important}.markdown-body .py-0{padding-top:0!important;padding-bottom:0!important}.markdown-body .pl-1{padding-left:4px!important}.markdown-body .pl-2{padding-left:8px!important}.markdown-body .py-2{padding-top:8px!important;padding-bottom:8px!important}.markdown-body .pl-3{padding-left:16px!important}.markdown-body .pl-4{padding-left:24px!important}.markdown-body .pl-5{padding-left:32px!important}.markdown-body .pl-6{padding-left:40px!important}.markdown-body .pl-7{padding-left:48px!important}.markdown-body .pl-8{padding-left:64px!important}.markdown-body .pl-9{padding-left:80px!important}.markdown-body .pl-10{padding-left:96px!important}.markdown-body .pl-11{padding-left:112px!important}.markdown-body .pl-12{padding-left:128px!important}.markdown-body hr{border-bottom-color:#eee}.markdown-body kbd{display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body&gt;:first-child{margin-top:0!important}.markdown-body&gt;:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body blockquote,.markdown-body details,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e1e4e8;border:0}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eaecef}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#6a737d}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li{word-wrap:break-all}.markdown-body li&gt;p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #dfe2e5}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{max-width:100%;box-sizing:initial;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body code{padding:.2em .4em;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body pre{word-wrap:normal}.markdown-body pre&gt;code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:initial;border:0}.markdown-body .commit-tease-sha{display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%;color:#444d56}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}.markdown-body .blob-wrapper{overflow-x:auto;overflow-y:hidden}.markdown-body .blob-wrapper-embedded{max-height:240px;overflow-y:auto}.markdown-body .blob-num{width:1%;min-width:50px;padding-right:10px;padding-left:10px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;vertical-align:top;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-body .blob-num:hover{color:rgba(27,31,35,.6)}.markdown-body .blob-num:before{content:attr(data-line-number)}.markdown-body .blob-code{position:relative;padding-right:10px;padding-left:10px;line-height:20px;vertical-align:top}.markdown-body .blob-code-inner{overflow:visible;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;color:#24292e;word-wrap:normal;white-space:pre}.markdown-body .pl-token.active,.markdown-body .pl-token:hover{cursor:pointer;background:#ffea7f}.markdown-body .tab-size[data-tab-size="1"]{-moz-tab-size:1;tab-size:1}.markdown-body .tab-size[data-tab-size="2"]{-moz-tab-size:2;tab-size:2}.markdown-body .tab-size[data-tab-size="3"]{-moz-tab-size:3;tab-size:3}.markdown-body .tab-size[data-tab-size="4"]{-moz-tab-size:4;tab-size:4}.markdown-body .tab-size[data-tab-size="5"]{-moz-tab-size:5;tab-size:5}.markdown-body .tab-size[data-tab-size="6"]{-moz-tab-size:6;tab-size:6}.markdown-body .tab-size[data-tab-size="7"]{-moz-tab-size:7;tab-size:7}.markdown-body .tab-size[data-tab-size="8"]{-moz-tab-size:8;tab-size:8}.markdown-body .tab-size[data-tab-size="9"]{-moz-tab-size:9;tab-size:9}.markdown-body .tab-size[data-tab-size="10"]{-moz-tab-size:10;tab-size:10}.markdown-body .tab-size[data-tab-size="11"]{-moz-tab-size:11;tab-size:11}.markdown-body .tab-size[data-tab-size="12"]{-moz-tab-size:12;tab-size:12}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}</style><style data-highlight="" data-highlight-key="xcode">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#000}.xml .hljs-meta{color:silver}.hljs-comment,.hljs-quote{color:#007400}.hljs-attribute,.hljs-keyword,.hljs-literal,.hljs-name,.hljs-selector-tag,.hljs-tag{color:#aa0d91}.hljs-template-variable,.hljs-variable{color:#3f6e74}.hljs-code,.hljs-meta-string,.hljs-string{color:#c41a16}.hljs-link,.hljs-regexp{color:#0e0eff}.hljs-bullet,.hljs-number,.hljs-symbol,.hljs-title{color:#1c00cf}.hljs-meta,.hljs-section{color:#643820}.hljs-built_in,.hljs-builtin-name,.hljs-class .hljs-title,.hljs-params,.hljs-type{color:#5c2699}.hljs-attr{color:#836c28}.hljs-subst{color:#000}.hljs-formula{background-color:#eee;font-style:italic}.hljs-addition{background-color:#baeeba}.hljs-deletion{background-color:#ffc8bd}.hljs-selector-class,.hljs-selector-id{color:#9b703f}.hljs-doctag,.hljs-strong{font-weight:700}.hljs-emphasis{font-style:italic}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3ed296ecb41543039d5405088a4b8c43~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768178812&amp;x-signature=fhy2b8bYrAbNNRJ2nFf2XtIJbP8%3D" alt="1.png" loading="lazy"/></p>
<p>ä½ æ˜¯å¦ç®¡ç†è¿‡é‚£äº›æ ¹æ®å†…éƒ¨çŠ¶æ€å‘ç”Ÿå‰§çƒˆè¡Œä¸ºå˜åŒ–çš„å¤æ‚å¯¹è±¡ï¼Ÿ</p>
<p>å¦‚æœæ˜¯ï¼Œé‚£ä½ å¾ˆå¯èƒ½å·²ç»å’Œä¸€ä¸ªå¸¸è§æ•Œäººæ–—äº‰è¿‡â€”â€”éå¸ƒä½ ç±»ä¸­æ¯ä¸ªæ–¹æ³•çš„ã€å†—é•¿çš„ <code>when</code> è¯­å¥ã€‚</p>
<p>å®ƒçœ‹èµ·æ¥å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">handleAction</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">when</span> (state) {
        State.A -&gt; { <span class="hljs-comment">/* A çš„é€»è¾‘ */</span> }
        State.B -&gt; { <span class="hljs-comment">/* B çš„é€»è¾‘ */</span> }
        State.C -&gt; { <span class="hljs-comment">/* C çš„é€»è¾‘ */</span> }
        <span class="hljs-comment">// ... è¿˜åœ¨ä¸æ–­å¢é•¿ï¼</span>
    }
}
</code></pre>
<p>æ¯æ¬¡ä½ æ·»åŠ ä¸€ä¸ªæ–°çŠ¶æ€ï¼ˆæ¯”å¦‚ <code>State.D</code>ï¼‰ï¼Œä½ å°±å¾—é€ä¸ªè¿½è¸ªå¹¶æ›´æ–°æ¯ä¸€ä¸ªå‡½æ•°ï¼ŒåŠ å…¥æ–°çš„åˆ†æ”¯ã€‚</p>
<p>è¿™æ˜¯ä¸ªç»´æŠ¤å™©æ¢¦ï¼Œç›´æ¥è¿åäº†å¼€é—­åŸåˆ™ï¼ˆ<strong>OCP</strong>ï¼‰ï¼Œä¹Ÿæ˜¯ä¸€ç§ä¸¥é‡çš„ä»£ç å¼‚å‘³ã€‚ä½ çš„é€»è¾‘æœ¬è¯¥æŒ‰çŠ¶æ€åˆ†ç»„ï¼Œå´å› ä¸ºåŠ¨ä½œè€Œè¢«æ•£ä¹±åœ°åˆ†å¸ƒåœ¨å„å¤„ã€‚</p>
<p>é‚£ä¹ˆï¼Œè§£å†³æ–¹æ¡ˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>çŠ¶æ€æ¨¡å¼ã€‚è€Œä¸”å€ŸåŠ©ç°ä»£ Kotlinï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æœ€å°‘çš„æ ·æ¿ä»£ç ï¼Œå®ç°æœ€ä¼˜é›…çš„çŠ¶æ€æ¨¡å¼ã€‚</p>
<h2 data-id="heading-0">ä¸€ä¸ªç®€å•çš„è‡ªåŠ¨å”®è´§æœº</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ff32e73dc554e92bcbb7bbc60d105e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768178812&amp;x-signature=Lj6Kgj5yM%2BLbhf8%2BWJDlzh3LWCo%3D" alt="0.png" loading="lazy"/></p>
<p>è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æ­£åœ¨æ„å»ºä¸€ä¸ªç®€å•çš„ <code>VendingMachine</code>ã€‚å®ƒæœ‰å‡ ä¸ªå…³é”®çš„çŠ¶æ€å’ŒåŠ¨ä½œï¼š</p>
<ul>
<li><strong>çŠ¶æ€</strong>ï¼š<code>IDLE</code>ï¼ˆç©ºé—²ï¼‰ã€<code>HAS_MONEY</code>ï¼ˆå·²æŠ•å¸ï¼‰ã€<code>OUT_OF_STOCK</code>ï¼ˆç¼ºè´§ï¼‰</li>
<li><strong>åŠ¨ä½œ</strong>ï¼š<code>insertMoney</code>ï¼ˆæŠ•å¸ï¼‰ã€<code>selectProduct</code>ï¼ˆé€‰æ‹©å•†å“ï¼‰ã€<code>requestRefund</code>ï¼ˆè¯·æ±‚é€€æ¬¾ï¼‰</li>
</ul>
<p>ä¸‹é¢æ˜¯é‚£ç§å­˜åœ¨é—®é¢˜çš„ã€åŸºäºçŠ¶æ€çš„æ£€æŸ¥ä»£ç ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">VendingMachine</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> balance: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> state: State = State.IDLE
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">insertMoney</span><span class="hljs-params">(amount: <span class="hljs-type">Int</span>)</span></span> {
        <span class="hljs-keyword">when</span> (state) {
            State.IDLE -&gt; {
                balance += amount
                state = State.HAS_MONEY
                println(<span class="hljs-string">"å·²æŠ•å¸ã€‚ä½™é¢ï¼š<span class="hljs-variable">$balance</span>"</span>)
            }
            State.HAS_MONEY -&gt; {
                println(<span class="hljs-string">"å·²æŠ•å¸ï¼Œæ— éœ€é‡å¤æŠ•å¸ã€‚ä½™é¢ï¼š<span class="hljs-variable">$balance</span>"</span>)
            }
            State.OUT_OF_STOCK -&gt; {
                println(<span class="hljs-string">"æœºå™¨ç¼ºè´§ã€‚"</span>)
            }
        }
    }
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">selectProduct</span><span class="hljs-params">(code: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-keyword">when</span> (state) {
            State.IDLE -&gt; {
                println(<span class="hljs-string">"è¯·å…ˆæŠ•å¸ã€‚"</span>)
            }
            State.HAS_MONEY -&gt; {
                <span class="hljs-keyword">if</span> (<span class="hljs-comment">/* å•†å“å¯ç”¨ */</span>) {
                    println(<span class="hljs-string">"å•†å“å·²å”®å‡ºã€‚"</span>)
                    state = State.IDLE
                } <span class="hljs-keyword">else</span> {
                    println(<span class="hljs-string">"å•†å“ä¸å¯ç”¨ã€‚"</span>)
                }
            }
            State.OUT_OF_STOCK -&gt; {
                println(<span class="hljs-string">"æœºå™¨ç¼ºè´§ã€‚"</span>)
            }
        }
    }
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">requestRefund</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">when</span> (state) {
            State.IDLE -&gt; {
                println(<span class="hljs-string">"æ²¡æœ‰å¯é€€çš„æ¬¾é¡¹ã€‚"</span>)
            }
            State.HAS_MONEY -&gt; {
                println(<span class="hljs-string">"å·²é€€æ¬¾ï¼š<span class="hljs-variable">$balance</span>"</span>)
                balance = <span class="hljs-number">0</span>
                state = State.IDLE
            }
            State.OUT_OF_STOCK -&gt; {
                println(<span class="hljs-string">"æ²¡æœ‰å¯é€€çš„æ¬¾é¡¹ã€‚"</span>)
            }
        }
    }
}
</code></pre>
<p>å¦‚æœæˆ‘ä»¬æ–°å¢ä¸€ä¸ª <code>MAINTENANCE</code>ï¼ˆç»´æŠ¤ï¼‰çŠ¶æ€ï¼Œå°±ä¼šç ´åå¼€é—­åŸåˆ™ï¼Œå› ä¸ºæˆ‘ä»¬å¿…é¡»ä¿®æ”¹ <code>insertMoney</code>ã€<code>selectProduct</code> ä»¥åŠæ‰€æœ‰å…¶ä»–åŠ¨ä½œæ–¹æ³•ã€‚</p>
<h2 data-id="heading-1">ç»å…¸çš„çŠ¶æ€æ¨¡å¼</h2>
<p>çŠ¶æ€æ¨¡å¼é€šè¿‡å°†â€œçŠ¶æ€â€æœ¬èº«å˜æˆä¸€ä¸ªæŒæœ‰è¡Œä¸ºçš„å¯¹è±¡æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬å¸Œæœ›æŒ‰çŠ¶æ€æ¥ç»„ç»‡è¡Œä¸ºï¼Œè€Œä¸æ˜¯æŒ‰åŠ¨ä½œã€‚</p>
<h3 data-id="heading-2">1. å®šä¹‰æ¥å£</h3>
<p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªé€šç”¨çš„æ¥å£ï¼ˆ<code>MachineState</code>ï¼‰ï¼Œæ‰€æœ‰çŠ¶æ€å¯¹è±¡éƒ½å¿…é¡»å®ç°å®ƒã€‚è¿™ä¸ªæ¥å£åŒ…å«äº†ä¸Šä¸‹æ–‡ï¼ˆ<code>VendingMachineContext</code>ï¼‰å¯ä»¥æ‰§è¡Œçš„æ‰€æœ‰å¯èƒ½åŠ¨ä½œã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">MachineState</span> {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">insertMoney</span><span class="hljs-params">(amount: <span class="hljs-type">Int</span>, context: <span class="hljs-type">VendingMachineContext</span>)</span></span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">selectProduct</span><span class="hljs-params">(code: <span class="hljs-type">String</span>, context: <span class="hljs-type">VendingMachineContext</span>)</span></span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">requestRefund</span><span class="hljs-params">(context: <span class="hljs-type">VendingMachineContext</span>)</span></span>
}
</code></pre>
<h3 data-id="heading-3">2. å…·ä½“å®ç°</h3>
<p>æˆ‘ä»¬ä¸ºæ¯ä¸ªçŠ¶æ€å®ç°å…¶è¡Œä¸ºã€‚å…³é”®ç‚¹åœ¨äºï¼šå•ä¸ªçŠ¶æ€çš„æ‰€æœ‰é€»è¾‘ç°åœ¨éƒ½é›†ä¸­åœ¨ä¸€ä¸ªç±»/å¯¹è±¡ä¸­ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">object</span> IdleState : MachineState {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">insertMoney</span><span class="hljs-params">(amount: <span class="hljs-type">Int</span>, context: <span class="hljs-type">VendingMachineContext</span>)</span></span> {
        context.balance += amount
        context.state = HasMoneyState
        println(<span class="hljs-string">"å·²æŠ•å¸ã€‚ä½™é¢ï¼š<span class="hljs-subst">${context.balance}</span>"</span>)
    }
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">selectProduct</span><span class="hljs-params">(code: <span class="hljs-type">String</span>, context: <span class="hljs-type">VendingMachineContext</span>)</span></span> {
        println(<span class="hljs-string">"è¯·å…ˆæŠ•å¸ã€‚"</span>)
    }
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">requestRefund</span><span class="hljs-params">(context: <span class="hljs-type">VendingMachineContext</span>)</span></span> {
        println(<span class="hljs-string">"æ²¡æœ‰å¯é€€çš„æ¬¾é¡¹ã€‚"</span>)
    }
}

<span class="hljs-keyword">object</span> HasMoneyState : MachineState {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">insertMoney</span><span class="hljs-params">(amount: <span class="hljs-type">Int</span>, context: <span class="hljs-type">VendingMachineContext</span>)</span></span> {
        context.balance += amount
        println(<span class="hljs-string">"å·²æ·»åŠ é‡‘é¢ã€‚ä½™é¢ï¼š<span class="hljs-subst">${context.balance}</span>"</span>)
    }
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">selectProduct</span><span class="hljs-params">(code: <span class="hljs-type">String</span>, context: <span class="hljs-type">VendingMachineContext</span>)</span></span> {
        <span class="hljs-keyword">if</span> (context.balance &gt;= <span class="hljs-number">2</span>) {
            context.balance -= <span class="hljs-number">2</span>
            println(<span class="hljs-string">"å•†å“å·²å”®å‡ºã€‚"</span>)
            context.state = IdleState
        } <span class="hljs-keyword">else</span> {
            println(<span class="hljs-string">"å•†å“ä¸å¯ç”¨ã€‚"</span>)
        }
    }
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">requestRefund</span><span class="hljs-params">(context: <span class="hljs-type">VendingMachineContext</span>)</span></span> {
        println(<span class="hljs-string">"å·²é€€æ¬¾ï¼š<span class="hljs-subst">${context.balance}</span>"</span>)
        context.balance = <span class="hljs-number">0</span>
        context.state = IdleState
    }
}

<span class="hljs-keyword">object</span> OutOfStockState : MachineState {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">insertMoney</span><span class="hljs-params">(amount: <span class="hljs-type">Int</span>, context: <span class="hljs-type">VendingMachineContext</span>)</span></span> {
        println(<span class="hljs-string">"æœºå™¨ç¼ºè´§ã€‚"</span>)
    }
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">selectProduct</span><span class="hljs-params">(code: <span class="hljs-type">String</span>, context: <span class="hljs-type">VendingMachineContext</span>)</span></span> {
        println(<span class="hljs-string">"æœºå™¨ç¼ºè´§ã€‚"</span>)
    }
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">requestRefund</span><span class="hljs-params">(context: <span class="hljs-type">VendingMachineContext</span>)</span></span> {
        println(<span class="hljs-string">"æ²¡æœ‰å¯é€€çš„æ¬¾é¡¹ã€‚"</span>)
    }
}
</code></pre>
<h3 data-id="heading-4">3. ä¸Šä¸‹æ–‡</h3>
<p><code>VendingMachineContext</code>ï¼ˆå³ä¸Šä¸‹æ–‡ï¼‰ç°åœ¨å˜å¾—ç®€æ´ï¼Œåªéœ€å°†åŠ¨ä½œå§”æ‰˜ç»™å…¶å½“å‰çš„çŠ¶æ€å¯¹è±¡å³å¯ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">VendingMachineContext</span>(<span class="hljs-keyword">var</span> balance: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">var</span> state: MachineState = IdleState
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">insertMoney</span><span class="hljs-params">(amount: <span class="hljs-type">Int</span>)</span></span> {
        state.insertMoney(amount, <span class="hljs-keyword">this</span>)
    }
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">selectProduct</span><span class="hljs-params">(code: <span class="hljs-type">String</span>)</span></span> {
        state.selectProduct(code, <span class="hljs-keyword">this</span>)
    }
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">requestRefund</span><span class="hljs-params">()</span></span> {
        state.requestRefund(<span class="hljs-keyword">this</span>)
    }
    <span class="hljs-comment">// è¾…åŠ©å‡½æ•°ï¼Œä¾›çŠ¶æ€å¯¹è±¡åˆ‡æ¢æœºå™¨çŠ¶æ€</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">transitionTo</span><span class="hljs-params">(newState: <span class="hljs-type">MachineState</span>)</span></span> {
        <span class="hljs-keyword">this</span>.state = newState
    }
}
</code></pre>
<p>å¦‚æœä½ æ–°å¢ä¸€ä¸ªçŠ¶æ€ï¼Œåªéœ€åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»ã€‚ä½ æ— éœ€ä¿®æ”¹ <code>VendingMachineContext</code> æˆ–å…¶ä»–ä»»ä½•çŠ¶æ€ç±»ã€‚å¼€é—­åŸåˆ™å¾—åˆ°äº†æ¢å¤ï¼</p>
<h2 data-id="heading-5">å¢å¼ºçš„ Kotlin é£æ ¼çŠ¶æ€æ¨¡å¼</h2>
<p>ç»å…¸æ¨¡å¼å¾ˆå¯é ï¼Œä½† Kotlin ä¸ºæˆ‘ä»¬æä¾›äº†æ›´å¼ºå¤§ã€æ›´ä¼˜é›…çš„æ–¹å¼æ¥æ„å»ºå®ƒï¼šä½¿ç”¨
<strong>å¯†å°æ¥å£</strong>
æ¥å¼ºåˆ¶å®ç°ç±»å‹å®‰å…¨çš„å‘½ä»¤ã€‚</p>
<h3 data-id="heading-6">1. å®šä¹‰æ‰€æœ‰è¾“å…¥</h3>
<p>æˆ‘ä»¬ä½¿ç”¨å¯†å°æ¥å£æ¥å»ºæ¨¡æœºå™¨å¯ä»¥æ¥æ”¶çš„æ‰€æœ‰å¯èƒ½è¾“å…¥ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">sealed</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">VendingInput</span> {
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InsertMoney</span>(<span class="hljs-keyword">val</span> amount: <span class="hljs-built_in">Int</span>) : VendingInput
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SelectProduct</span>(<span class="hljs-keyword">val</span> code: String) : VendingInput
    <span class="hljs-keyword">object</span> RequestRefund : VendingInput
}
</code></pre>
<h3 data-id="heading-7">2. å®šä¹‰çŠ¶æ€å’Œä¸Šä¸‹æ–‡</h3>
<p>çŠ¶æ€æ¥å£ç°åœ¨æ¥å—ä¸€ä¸ªå•ä¸€çš„ <code>VendingInput</code>ã€‚ä¸Šä¸‹æ–‡æ‹¥æœ‰ä¸€ä¸ªå…¬å¼€çš„ <code>process</code> æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin">
<span class="hljs-keyword">sealed</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">VendingState</span> {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">handle</span><span class="hljs-params">(input: <span class="hljs-type">VendingInput</span>, context: <span class="hljs-type">VendingMachineContext</span>)</span></span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">VendingMachineContext</span>(<span class="hljs-keyword">var</span> balance: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">var</span> state: VendingState = IdleState
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">process</span><span class="hljs-params">(input: <span class="hljs-type">VendingInput</span>)</span></span> {
        state.handle(input, <span class="hljs-keyword">this</span>)
    }
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">transitionTo</span><span class="hljs-params">(newState: <span class="hljs-type">VendingState</span>)</span></span> {
        <span class="hljs-keyword">this</span>.state = newState
    }
}
</code></pre>
<h3 data-id="heading-8">3. è¡Œä¸º</h3>
<p>çŠ¶æ€å¯¹è±¡ä½¿ç”¨ä¸€ä¸ªå¯¹ <code>input</code> ç±»å‹çš„å•ä¸€ <code>when</code> è¯­å¥ã€‚å› ä¸º <code>VendingInput</code> æ˜¯å¯†å°çš„ï¼ŒKotlin ä¼šå¼ºåˆ¶æˆ‘ä»¬å¤„ç†æ‰€æœ‰å¯èƒ½çš„è¾“å…¥â€”â€”è¿™ä½¿å¾—æˆ‘ä»¬çš„ä»£ç å˜å¾—ç©·ä¸¾ä¸”å®‰å…¨ï¼</p>
<pre><code class="hljs language-kotlin" lang="kotlin">
<span class="hljs-keyword">object</span> IdleState : VendingState {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">handle</span><span class="hljs-params">(input: <span class="hljs-type">VendingInput</span>, context: <span class="hljs-type">VendingMachineContext</span>)</span></span> {
        <span class="hljs-keyword">when</span> (input) {
            <span class="hljs-keyword">is</span> VendingInput.InsertMoney -&gt; {
                context.balance += input.amount
                context.transitionTo(HasMoneyState)
                println(<span class="hljs-string">"å·²æŠ•å¸ã€‚ä½™é¢ï¼š<span class="hljs-subst">${context.balance}</span>"</span>)
            }
            <span class="hljs-keyword">is</span> VendingInput.SelectProduct -&gt; {
                println(<span class="hljs-string">"è¯·å…ˆæŠ•å¸ã€‚"</span>)
            }
            VendingInput.RequestRefund -&gt; {
                println(<span class="hljs-string">"æ²¡æœ‰å¯é€€çš„æ¬¾é¡¹ã€‚"</span>)
            }
        }
    }
}

<span class="hljs-keyword">object</span> HasMoneyState : VendingState {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">handle</span><span class="hljs-params">(input: <span class="hljs-type">VendingInput</span>, context: <span class="hljs-type">VendingMachineContext</span>)</span></span> {
        <span class="hljs-keyword">when</span> (input) {
            <span class="hljs-keyword">is</span> VendingInput.InsertMoney -&gt; {
                context.balance += input.amount
                println(<span class="hljs-string">"å·²æ·»åŠ é‡‘é¢ã€‚ä½™é¢ï¼š<span class="hljs-subst">${context.balance}</span>"</span>)
            }
            <span class="hljs-keyword">is</span> VendingInput.SelectProduct -&gt; {
                <span class="hljs-keyword">if</span> (context.balance &gt;= <span class="hljs-number">2</span>) {
                    context.balance -= <span class="hljs-number">2</span>
                    println(<span class="hljs-string">"å•†å“å·²å”®å‡ºã€‚"</span>)
                    context.transitionTo(IdleState)
                } <span class="hljs-keyword">else</span> {
                    println(<span class="hljs-string">"å•†å“ä¸å¯ç”¨ã€‚"</span>)
                }
            }
            VendingInput.RequestRefund -&gt; {
                println(<span class="hljs-string">"å·²é€€æ¬¾ï¼š<span class="hljs-subst">${context.balance}</span>"</span>)
                context.balance = <span class="hljs-number">0</span>
                context.transitionTo(IdleState)
            }
        }
    }
}

<span class="hljs-keyword">object</span> OutOfStockState : VendingState {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">handle</span><span class="hljs-params">(input: <span class="hljs-type">VendingInput</span>, context: <span class="hljs-type">VendingMachineContext</span>)</span></span> {
        <span class="hljs-keyword">when</span> (input) {
            <span class="hljs-keyword">is</span> VendingInput.InsertMoney -&gt; {
                println(<span class="hljs-string">"æœºå™¨ç¼ºè´§ã€‚"</span>)
            }
            <span class="hljs-keyword">is</span> VendingInput.SelectProduct -&gt; {
                println(<span class="hljs-string">"æœºå™¨ç¼ºè´§ã€‚"</span>)
            }
            VendingInput.RequestRefund -&gt; {
                println(<span class="hljs-string">"æ²¡æœ‰å¯é€€çš„æ¬¾é¡¹ã€‚"</span>)
            }
        }
    }
}
</code></pre>
<h2 data-id="heading-9">çº¯å‡½æ•°å¼çŠ¶æ€è½¬æ¢</h2>
<p>å¯¹äºçœŸæ­£å¥å£®çš„ç³»ç»Ÿï¼ˆå¦‚ <strong>MVI</strong>ï¼‰ï¼Œä½ å¯èƒ½å¸Œæœ›é¿å…å¯å˜æ€§ã€‚ä½ å¯ä»¥é€šè¿‡è®©çŠ¶æ€å‡½æ•°è¿”å›ä¸‹ä¸€ä¸ªçŠ¶æ€æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œä»è€Œä½¿ç³»ç»Ÿå…·æœ‰é«˜åº¦ç¡®å®šæ€§ï¼š</p>
<h3 data-id="heading-10">1. å®šä¹‰è½¬æ¢</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. å®šä¹‰æ‰€æœ‰è¾“å…¥ï¼ˆä¿æŒä¸å˜ï¼Œå¯†å°æ¥å£éå¸¸é€‚åˆå‡½æ•°å¼ï¼‰</span>
<span class="hljs-keyword">sealed</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">VendingInput</span> {
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InsertMoney</span>(<span class="hljs-keyword">val</span> amount: <span class="hljs-built_in">Int</span>) : VendingInput
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SelectProduct</span>(<span class="hljs-keyword">val</span> code: String) : VendingInput
    <span class="hljs-keyword">object</span> RequestRefund : VendingInput
}

<span class="hljs-comment">// 2. å®šä¹‰çŠ¶æ€ï¼šå°†æ•°æ®ï¼ˆbalanceï¼‰ä¸çŠ¶æ€é€»è¾‘ç»“åˆ</span>
<span class="hljs-comment">// ä½¿ç”¨ä¸å¯å˜å±æ€§ (val)ï¼Œç¡®ä¿çŠ¶æ€ä¸€æ—¦åˆ›å»ºä¸å¯ä¿®æ”¹</span>
<span class="hljs-keyword">sealed</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VendingState</span>(<span class="hljs-keyword">val</span> balance: <span class="hljs-built_in">Int</span>) {
    
    <span class="hljs-comment">// æ ¸å¿ƒè½¬å˜ï¼šå‡½æ•°ç­¾åè¿”å› (æ–°çŠ¶æ€, äº§ç”Ÿçš„ç»“æœæ–‡æœ¬)</span>
    <span class="hljs-keyword">abstract</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">handle</span><span class="hljs-params">(input: <span class="hljs-type">VendingInput</span>)</span></span>: Pair&lt;VendingState, String&gt;

    <span class="hljs-comment">// --- å„ä¸ªçŠ¶æ€çš„å…·ä½“å®ç° ---</span>

    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Idle</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> b: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>) : VendingState(b) {
        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">handle</span><span class="hljs-params">(input: <span class="hljs-type">VendingInput</span>)</span></span> = <span class="hljs-keyword">when</span> (input) {
            <span class="hljs-keyword">is</span> VendingInput.InsertMoney -&gt; 
                HasMoney(balance + input.amount) to <span class="hljs-string">"å·²æŠ•å¸ã€‚ä½™é¢ï¼š<span class="hljs-subst">${balance + input.amount}</span>"</span>
            <span class="hljs-keyword">is</span> VendingInput.SelectProduct -&gt; 
                <span class="hljs-keyword">this</span> to <span class="hljs-string">"è¯·å…ˆæŠ•å¸ã€‚"</span>
            VendingInput.RequestRefund -&gt; 
                <span class="hljs-keyword">this</span> to <span class="hljs-string">"æ²¡æœ‰å¯é€€çš„æ¬¾é¡¹ã€‚"</span>
        }
    }

    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HasMoney</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> b: <span class="hljs-built_in">Int</span>) : VendingState(b) {
        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">handle</span><span class="hljs-params">(input: <span class="hljs-type">VendingInput</span>)</span></span> = <span class="hljs-keyword">when</span> (input) {
            <span class="hljs-keyword">is</span> VendingInput.InsertMoney -&gt; 
                copy(b = balance + input.amount) to <span class="hljs-string">"å·²æ·»åŠ é‡‘é¢ã€‚ä½™é¢ï¼š<span class="hljs-subst">${balance + input.amount}</span>"</span>
            <span class="hljs-keyword">is</span> VendingInput.SelectProduct -&gt; 
                <span class="hljs-keyword">if</span> (balance &gt;= <span class="hljs-number">2</span>) Idle(balance - <span class="hljs-number">2</span>) to <span class="hljs-string">"å•†å“å·²å”®å‡ºï¼š<span class="hljs-subst">${input.code}</span>ã€‚"</span>
                <span class="hljs-keyword">else</span> <span class="hljs-keyword">this</span> to <span class="hljs-string">"ä½™é¢ä¸è¶³ã€‚"</span>
            VendingInput.RequestRefund -&gt; 
                Idle(<span class="hljs-number">0</span>) to <span class="hljs-string">"å·²é€€æ¬¾ï¼š<span class="hljs-variable">$balance</span>"</span>
        }
    }

    <span class="hljs-keyword">object</span> OutOfStock : VendingState(<span class="hljs-number">0</span>) {
        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">handle</span><span class="hljs-params">(input: <span class="hljs-type">VendingInput</span>)</span></span> = <span class="hljs-keyword">this</span> to <span class="hljs-string">"æœºå™¨ç¼ºè´§ã€‚"</span>
    }
}
</code></pre>
<h3 data-id="heading-11">2. ä½¿ç”¨ä¸¾ä¾‹</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> s0 = VendingState.Idle()

    <span class="hljs-comment">// æ‰€æœ‰çš„å¤„ç†ç»“æœéƒ½ä½œä¸ºæ–°å€¼è¿”å›ï¼ŒåŸå§‹ s0 ä¿æŒä¸å˜</span>
    <span class="hljs-keyword">val</span> (s1, msg1) = s0.handle(VendingInput.InsertMoney(<span class="hljs-number">5</span>))
    println(msg1) <span class="hljs-comment">// å·²æŠ•å¸ã€‚ä½™é¢ï¼š5</span>

    <span class="hljs-keyword">val</span> (s2, msg2) = s1.handle(VendingInput.SelectProduct(<span class="hljs-string">"å¯ä¹"</span>))
    println(msg2) <span class="hljs-comment">// å•†å“å·²å”®å‡ºï¼šå¯ä¹ã€‚</span>

    <span class="hljs-comment">// s2 ç°åœ¨æ˜¯ Idle çŠ¶æ€ï¼Œä½™é¢å·²æ‰£é™¤</span>
    println(<span class="hljs-string">"æœ€ç»ˆçŠ¶æ€: <span class="hljs-subst">${s2::class.simpleName}</span>, ä½™é¢: <span class="hljs-subst">${s2.balance}</span>"</span>)
}

</code></pre>
<p>è™½ç„¶æ›´å¤æ‚ï¼Œä½†è¿™ç§æ–¹æ³•åœ¨å“åº”å¼æ¶æ„ä¸­å¾ˆå¸¸è§ï¼Œå› ä¸ºçŠ¶æ€å˜åŒ–æ˜¯å¿…é¡»è¢«ç²¾ç¡®è·Ÿè¸ªçš„äº‹ä»¶ã€‚</p>
<p>å®ƒçš„æ ¸å¿ƒå®é™…ä¸Šå°±æ˜¯å‡½æ•°æœ‰çŠ¶æ€çš„è¿”å›ï¼Œè€ŒçŠ¶æ€æœ¬èº«æ˜¯ä¸å¯å˜çš„ï¼Œå¦‚æœåŒä¸€ä¸ªçŠ¶æ€çš„æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„çŠ¶æ€ã€‚</p>
<h2 data-id="heading-12">æ€»ç»“</h2>
<p>é€šè¿‡åº”ç”¨çŠ¶æ€æ¨¡å¼ï¼Œæˆ‘ä»¬æˆåŠŸåœ°å°†åˆ†æ•£ã€è„†å¼±çš„æ¡ä»¶é€»è¾‘æ›¿æ¢ä¸ºå¹²å‡€ã€å†…èšçš„çŠ¶æ€å¯¹è±¡ã€‚è¿™ä½¿å¾—æˆ‘ä»¬çš„ä»£ç æ›´æ˜“äºç»´æŠ¤ã€æµ‹è¯•å’Œæ‰©å±•ã€‚</p>
<p>å¦‚æœä½ çš„ Kotlin ä»£ç åº“æ­£é­å—â€œè‡ƒè‚¿çš„ <code>when</code> è¯­å¥â€ä¹‹è‹¦ï¼Œä¸å¦¨è¯•è¯•çŠ¶æ€æ¨¡å¼ã€‚å›¢é˜Ÿä¸­çš„å°ä¼™ä¼´ä¸€å®šä¼šæ„Ÿè°¢ä½ çš„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android æ·±å…¥å‰–æAndroidå†…å­˜æ³„æ¼ï¼šViewPager2ä¸Fragmentçš„ç”Ÿå‘½å‘¨æœŸé™·é˜±]]></title>    <link>https://juejin.cn/post/7591413678982905902</link>    <guid>https://juejin.cn/post/7591413678982905902</guid>    <pubDate>2026-01-05T00:48:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591413678982905902" data-draft-id="7582136489770385418" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android æ·±å…¥å‰–æAndroidå†…å­˜æ³„æ¼ï¼šViewPager2ä¸Fragmentçš„ç”Ÿå‘½å‘¨æœŸé™·é˜±"/> <meta itemprop="keywords" content="Android,å‰ç«¯,APP"/> <meta itemprop="datePublished" content="2026-01-05T00:48:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¹ç¨‹åå…«å°‘"/> <meta itemprop="url" content="https://juejin.cn/user/184373685534077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android æ·±å…¥å‰–æAndroidå†…å­˜æ³„æ¼ï¼šViewPager2ä¸Fragmentçš„ç”Ÿå‘½å‘¨æœŸé™·é˜±
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/184373685534077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¹ç¨‹åå…«å°‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-05T00:48:42.000Z" title="Mon Jan 05 2026 00:48:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åœºæ™¯ï¼š åœ¨æ–°èƒ½æºè½¦æœºç³»ç»Ÿæœ‰ä¸€å¥—UIé¡µé¢ï¼Œæ‰‹æœºæœ‰ç«–å±é¡µé¢ï¼Œæ‰‹æœºåˆæ¨ªå±é¡µé¢ï¼Œ3ç§æƒ…å†µç›¸äº’åˆ‡æ¢ï¼Œé¢‘ç¹çš„åˆ‡æ¢ï¼Œæ‰‹æœºçš„ç«–å±é¡µé¢æœ‰3ä¸ªtabå’Œ3ä¸ªå¯¹åº”fragmentï¼Œä¸€ä¸ªå¤–å±‚FragmentåŒ…å«3ä¸ªfragment, ä¸åœçš„åˆ‡æ¢å¯¼è‡´çš„ï¼</p>
</blockquote>
<h2 data-id="heading-0">1.å†…å­˜æ³„æ¼ä¿¡æ¯</h2>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span> <span class="hljs-attr">GC Root:</span> <span class="hljs-string">Global</span> <span class="hljs-string">variable</span> <span class="hljs-string">in</span> <span class="hljs-string">native</span> <span class="hljs-string">code</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-attr">Leaking:</span> <span class="hljs-literal">NO</span> <span class="hljs-string">(MainActivityâ†“</span> <span class="hljs-string">is</span> <span class="hljs-string">not</span> <span class="hljs-string">leaking)</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-string">â†“</span> <span class="hljs-string">-$$Lambda$ViewRootImpl$zmAX2p20-kqxknxcUyGhSNjsJvM.f$0</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-attr">Leaking:</span> <span class="hljs-literal">NO</span> <span class="hljs-string">(MainActivityâ†“</span> <span class="hljs-string">is</span> <span class="hljs-string">not</span> <span class="hljs-string">leaking)</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-string">mContext</span> <span class="hljs-string">instance</span> <span class="hljs-string">of</span> <span class="hljs-string">com.tencent.settings.MainActivity</span> <span class="hljs-string">with</span> <span class="hljs-string">mDestroyed</span> <span class="hljs-string">=</span> <span class="hljs-literal">false</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-string">ViewRootImpl#mView</span> <span class="hljs-string">is</span> <span class="hljs-string">not</span> <span class="hljs-literal">null</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-string">â†“</span> <span class="hljs-string">ViewRootImpl.mContext</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”œâ”€</span> <span class="hljs-string">com.tencent.settings.MainActivity</span> <span class="hljs-string">instance</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-string">â†“</span> <span class="hljs-string">ComponentActivity.mLifecycleRegistry</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>                        <span class="hljs-string">~~~~~~~~~~~~</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-string">Retaining</span> <span class="hljs-number">52</span> <span class="hljs-string">B</span> <span class="hljs-string">in</span> <span class="hljs-number">2</span> <span class="hljs-string">objects</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-string">Anonymous</span> <span class="hljs-string">class</span> <span class="hljs-string">implementing</span> <span class="hljs-string">androidx.lifecycle.LifecycleEventObserver</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”œâ”€</span> <span class="hljs-string">androidx.viewpager2.adapter.FragmentStateAdapter$FragmentMaxLifecycleEnforcer</span> <span class="hljs-string">instance</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-string">â†“</span> <span class="hljs-string">FragmentStateAdapter$FragmentMaxLifecycleEnforcer.mViewPager</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>                                                        <span class="hljs-string">~~~~~~~~~~</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”œâ”€</span> <span class="hljs-string">androidx.viewpager2.widget.ViewPager2</span> <span class="hljs-string">instance</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-attr">Leaking:</span> <span class="hljs-string">UNKNOWN</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-string">Retaining</span> <span class="hljs-number">85.1</span> <span class="hljs-string">kB</span> <span class="hljs-string">in</span> <span class="hljs-number">1109 </span><span class="hljs-string">objects</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-string">View</span> <span class="hljs-string">not</span> <span class="hljs-string">part</span> <span class="hljs-string">of</span> <span class="hljs-string">a</span> <span class="hljs-string">window</span> <span class="hljs-string">view</span> <span class="hljs-string">hierarchy</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-string">View.mAttachInfo</span> <span class="hljs-string">is</span> <span class="hljs-literal">null</span> <span class="hljs-string">(view</span> <span class="hljs-string">detached)</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-string">View.mWindowAttachCount</span> <span class="hljs-string">=</span> <span class="hljs-number">1</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-string">mContext</span> <span class="hljs-string">instance</span> <span class="hljs-string">of</span> <span class="hljs-string">com.tencent.settings.MainActivity</span> <span class="hljs-string">with</span> <span class="hljs-string">mDestroyed</span> <span class="hljs-string">=</span> <span class="hljs-literal">false</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-string">â†“</span> <span class="hljs-string">View.mParent</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â”‚</span>           <span class="hljs-string">~~~~~~~</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â€‹</span>     <span class="hljs-attr">Leaking:</span> <span class="hljs-literal">YES</span> <span class="hljs-string">(ObjectWatcher</span> <span class="hljs-string">was</span> <span class="hljs-string">watching</span> <span class="hljs-string">this</span> <span class="hljs-string">because</span> <span class="hljs-string">com.tencent.settings.PhoneAndroidFragment</span> <span class="hljs-string">received</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â€‹</span>     <span class="hljs-string">Fragment#onDestroyView()</span> <span class="hljs-string">callback</span> <span class="hljs-string">(references</span> <span class="hljs-string">to</span> <span class="hljs-string">its</span> <span class="hljs-string">views</span> <span class="hljs-string">should</span> <span class="hljs-string">be</span> <span class="hljs-string">cleared</span> <span class="hljs-string">to</span> <span class="hljs-string">prevent</span> <span class="hljs-string">leaks))</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â€‹</span>     <span class="hljs-string">key</span> <span class="hljs-string">=</span> <span class="hljs-string">4e6eb9f9-742a-42b5-a71d-42543f7f1407</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â€‹</span>     <span class="hljs-string">watchDurationMillis</span> <span class="hljs-string">=</span> <span class="hljs-number">22525</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â€‹</span>     <span class="hljs-string">View</span> <span class="hljs-string">not</span> <span class="hljs-string">part</span> <span class="hljs-string">of</span> <span class="hljs-string">a</span> <span class="hljs-string">window</span> <span class="hljs-string">view</span> <span class="hljs-string">hierarchy</span>
<span class="hljs-number">2025-12-11 09:35:44.808 </span><span class="hljs-number">57579</span><span class="hljs-number">-61121</span> <span class="hljs-string">LeakCanary</span>              <span class="hljs-string">com.tencent.settings</span>                     <span class="hljs-string">D</span>  <span class="hljs-string">â€‹</span>     <span class="hljs-string">View.mWindowAttachCount</span> <span class="hljs-string">=</span> <span class="hljs-number">1</span>
</code></pre>
<h3 data-id="heading-1">æ³„æ¼ç°è±¡</h3>
<p>LeakCanaryçš„æ—¥å¿—æ˜¾ç¤ºäº†è¿™æ ·ä¸€ä¸ªæ³„æ¼é“¾ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">GC Root: Global variable in native code
â†“
ViewRootImplçš„Lambdaè¡¨è¾¾å¼
â†“
MainActivity (<span class="hljs-attr">mDestroyed</span> = <span class="hljs-literal">false</span>)
â†“
ComponentActivity.mLifecycleRegistry
â†“
FragmentStateAdapter$FragmentMaxLifecycleEnforcer
â†“
ViewPager2å®ä¾‹ (å·²ä»çª—å£åˆ†ç¦»)
â†“
Fragmentå·²é”€æ¯çš„è§†å›¾ (åº”è¢«å›æ”¶ä½†æœªè¢«å›æ”¶)
</code></pre>
<h3 data-id="heading-2">2. ä¸»è¦æ³„æ¼ç‚¹</h3>
<p>PhoneAndroidFragment å·²ç»æ”¶åˆ°äº† onDestroyView() å›è°ƒ</p>
<p>ä½†å…¶è§†å›¾ä»ç„¶è¢« ViewPager2 æŒæœ‰</p>
<p>ViewPager2 æœ¬èº«åˆè¢« FragmentMaxLifecycleEnforcer æŒæœ‰</p>
<h5 data-id="heading-3">2.2 æ ¸å¿ƒåŸå› </h5>
<p>FragmentStateAdapter$FragmentMaxLifecycleEnforcer æ˜¯ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸè§‚å¯Ÿè€…ï¼Œå®ƒï¼š</p>
<p>é€šè¿‡ MainActivity çš„ mLifecycleRegistry æ³¨å†Œ</p>
<p>æŒæœ‰ ViewPager2 çš„å¼•ç”¨</p>
<p>å¯¼è‡´ ViewPager2 åŠå…¶å­è§†å›¾æ— æ³•è¢«é‡Šæ”¾</p>
<p>é—®é¢˜ï¼šè°æŒæœ‰ ViewPager2ï¼Œ ä¸ºä»€ä¹ˆPhoneAndroidFragment ä¸èƒ½è¢«å›æ”¶</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> GC Root (Nativeå…¨å±€å˜é‡)
   â†“
<span class="hljs-bullet">2.</span> ViewRootImplçš„Lambdaå‡½æ•°
   â†“
<span class="hljs-bullet">3.</span> MainActivity (Activityæœ¬èº«æœªé”€æ¯)
   â†“
<span class="hljs-bullet">4.</span> ComponentActivity.mLifecycleRegistry (ç”Ÿå‘½å‘¨æœŸæ³¨å†Œè¡¨)
   â†“
<span class="hljs-bullet">5.</span> FragmentStateAdapter$FragmentMaxLifecycleEnforcer (ç”Ÿå‘½å‘¨æœŸè§‚å¯Ÿè€…)
   â†“
<span class="hljs-bullet">6.</span> ViewPager2 å®ä¾‹ (å…³é”®æŒæœ‰è€…)
   â†“
<span class="hljs-bullet">7.</span> ViewPager2 çš„å†…éƒ¨çŠ¶æ€ (RecyclerViewã€é€‚é…å™¨ç­‰)
   â†“
<span class="hljs-bullet">8.</span> PhoneAndroidFragment çš„è§†å›¾ (Fragmentçš„Viewå±‚æ¬¡ç»“æ„)
</code></pre>
<h3 data-id="heading-4">3.æºç è¯¦ç»†åˆ†æå„ç¯èŠ‚ï¼š</h3>
<h5 data-id="heading-5"><strong>3.1. FragmentMaxLifecycleEnforcer æ˜¯è°ï¼Ÿ</strong></h5>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-comment">// è¿™æ˜¯ViewPager2çš„å†…éƒ¨ç±»ï¼Œè´Ÿè´£ç®¡ç†Fragmentçš„ç”Ÿå‘½å‘¨æœŸ</span>
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FragmentStateAdapter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RecyclerView</span>.<span class="hljs-title">Adapter&lt;</span>...<span class="hljs-title">&gt;</span> </span>{
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FragmentMaxLifecycleEnforcer</span> </span>{
        <span class="hljs-comment">// å…³é”®å­—æ®µ</span>
        <span class="hljs-keyword">private</span> <span class="hljs-type">ViewPager2</span> mViewPager;  <span class="hljs-comment">// æŒæœ‰ViewPager2çš„å¼ºå¼•ç”¨</span>
        <span class="hljs-keyword">private</span> <span class="hljs-type">LifecycleEventObserver</span> mLifecycleObserver;  <span class="hljs-comment">// ç”Ÿå‘½å‘¨æœŸè§‚å¯Ÿè€…</span>
    }
}
</code></pre>
<h5 data-id="heading-6"><strong>3.2. ä¸ºä»€ä¹ˆå®ƒæŒæœ‰ViewPager2ï¼Ÿ</strong></h5>
<p>å½“ViewPager2ä½¿ç”¨<code>FragmentStateAdapter</code>æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª<code>FragmentMaxLifecycleEnforcer</code>å®ä¾‹ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// åœ¨FragmentStateAdapteræ„é€ å‡½æ•°ä¸­</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">FragmentStateAdapter</span>(<span class="hljs-variable">@NonNull</span> FragmentManager fragmentManager, 
                           <span class="hljs-variable">@NonNull</span> Lifecycle lifecycle) {
    <span class="hljs-comment">// ...</span>
    <span class="hljs-selector-tag">mFragmentMaxLifecycleEnforcer</span> = <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">FragmentMaxLifecycleEnforcer</span>();
    <span class="hljs-selector-tag">lifecycle</span><span class="hljs-selector-class">.addObserver</span>(mFragmentMaxLifecycleEnforcer);  <span class="hljs-comment">// æ³¨å†Œåˆ°Activityç”Ÿå‘½å‘¨æœŸ</span>
}
</code></pre>
<h5 data-id="heading-7"><strong>3.3. PhoneAndroidFragmentä¸ºä»€ä¹ˆä¸èƒ½è¢«å›æ”¶ï¼Ÿ</strong></h5>
<p><strong>æ ¹æœ¬åŸå› ï¼šViewPager2ä»ç„¶æŒæœ‰Fragmentçš„è§†å›¾å¼•ç”¨</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// ViewPager2å†…éƒ¨æ˜¯é€šè¿‡RecyclerViewå®ç°çš„</span>
<span class="hljs-comment">// å½“Fragmentè¢«é”€æ¯æ—¶ï¼Œå¦‚æœViewPager2æ²¡æœ‰æ­£ç¡®æ¸…ç†ï¼Œå°±ä¼šï¼š</span>
<span class="hljs-number">1</span>. ViewPager2çš„RecyclerViewä»ç„¶ç¼“å­˜ç€Fragmentçš„ViewHolder
<span class="hljs-number">2</span>. Fragmentçš„Viewä»ç„¶åœ¨ViewPager2çš„å­Viewåˆ—è¡¨ä¸­
<span class="hljs-number">3</span>. Fragmentçš„<span class="hljs-built_in">onDestroyView</span>()è¢«è°ƒç”¨ï¼Œä½†Viewå¯¹è±¡æ²¡æœ‰è¢«GCå›æ”¶
</code></pre>
<h3 data-id="heading-8">3.4 RecyclerViewç¼“å­˜é—®é¢˜</h3>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// ViewPager2å†…éƒ¨ä½¿ç”¨RecyclerViewï¼Œæœ‰ä»¥ä¸‹ç¼“å­˜ï¼š</span>
<span class="hljs-number">1.</span> mAttachedScrap - å·²é™„åŠ çš„åºŸå¼ƒè§†å›¾
<span class="hljs-number">2.</span> mCachedViews - ç¼“å­˜è§†å›¾ï¼ˆé»˜è®¤å¤§å°<span class="hljs-number">2</span>ï¼‰
<span class="hljs-number">3.</span> mRecyclerPool - å›æ”¶æ± 

<span class="hljs-comment">// å½“Fragmenté”€æ¯æ—¶ï¼Œå¦‚æœViewè¿˜åœ¨è¿™äº›ç¼“å­˜ä¸­ï¼š</span>
<span class="hljs-comment">// 1. Viewä¸ä¼šè¢«é‡Šæ”¾</span>
<span class="hljs-comment">// 2. Fragmentçš„è§†å›¾å¼•ç”¨è¢«ä¿ç•™</span>
<span class="hljs-comment">// 3. å¯¼è‡´å†…å­˜æ³„æ¼</span>
</code></pre>
<h3 data-id="heading-9">3.5. å±å¹•åˆ‡æ¢å½±å“</h3>
<pre><code class="hljs language-markdown" lang="markdown">è½¦æœºç³»ç»Ÿ â†” æ‰‹æœºç«–å± â†” æ‰‹æœºæ¨ªå±
<span class="hljs-code">      â†“         â†“         â†“
å¸ƒå±€å®Œå…¨ä¸åŒ   åŒ…å«ViewPager2  å¸ƒå±€å®Œå…¨ä¸åŒ
      â†“         â†“         â†“
æ¯æ¬¡åˆ‡æ¢éœ€è¦   3ä¸ªTabé¢‘ç¹   æ¯æ¬¡åˆ‡æ¢éœ€è¦
å®Œå…¨é‡å»ºUI   åˆ‡æ¢Fragment  å®Œå…¨é‡å»ºUI
</span></code></pre>
<h4 data-id="heading-10">å…·ä½“çš„å¼•ç”¨è·¯å¾„ï¼š</h4>
<pre><code class="hljs language-markdown" lang="markdown">PhoneAndroidFragmentçš„Viewè¢«ä»¥ä¸‹å¯¹è±¡å¼•ç”¨ï¼š
<span class="hljs-bullet">1.</span> ViewPager2.mRecyclerView (RecyclerViewå®ä¾‹)
   â†“
<span class="hljs-bullet">2.</span> RecyclerView.mRecycler (RecyclerView.Recyclerå›æ”¶æ± )
   â†“
<span class="hljs-bullet">3.</span> RecyclerView.Recycler.mCachedViews (ç¼“å­˜è§†å›¾åˆ—è¡¨)
   â†“
<span class="hljs-bullet">4.</span> æˆ– RecyclerView.Recycler.mAttachedScrap (é™„åŠ çš„åºŸå¼ƒè§†å›¾)
   â†“
<span class="hljs-bullet">5.</span> Fragmentçš„Viewåœ¨ç¼“å­˜ä¸­ç­‰å¾…å¤ç”¨
</code></pre>
<h4 data-id="heading-11">ä¸ºä»€ä¹ˆä¼šå½¢æˆè¿™ä¸ªæ³„æ¼é“¾ï¼Ÿ</h4>
<h5 data-id="heading-12"><strong>åœºæ™¯é‡ç°</strong>ï¼š</h5>
<ol>
<li>
<p><strong>åˆå§‹åŒ–</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// MainActivityä¸­
ViewPager2 <span class="hljs-attr">viewPager</span> = findViewById(R.id.view_pager)<span class="hljs-comment">;</span>
<span class="hljs-attr">viewPager.adapter</span> = new FragmentStateAdapter(this)<span class="hljs-comment">;</span>
// æ­¤æ—¶ï¼ŒFragmentMaxLifecycleEnforcerè¢«æ³¨å†Œåˆ°Activityçš„ç”Ÿå‘½å‘¨æœŸ
</code></pre>
</li>
<li>
<p><strong>Fragmentè¢«é”€æ¯</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// å½“PhoneAndroidFragmentæ”¶åˆ°onDestroyView()æ—¶</span>
<span class="hljs-comment">// ç†æƒ³æƒ…å†µï¼šViewPager2åº”è¯¥é‡Šæ”¾å¯¹Fragment Viewçš„å¼•ç”¨</span>
<span class="hljs-comment">// å®é™…æƒ…å†µï¼šViewPager2å¯èƒ½è¿˜åœ¨ç¼“å­˜è¿™ä¸ªView</span>
</code></pre>
</li>
<li>
<p><strong>é—®é¢˜å‘ç”Ÿ</strong>ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// ViewPager2çš„FragmentStateAdapteræ²¡æœ‰æ­£ç¡®å¤„ç†</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">onViewRecycled</span>(<span class="hljs-variable">@NonNull</span> FragmentViewHolder holder) {
    <span class="hljs-comment">// å¯èƒ½æ²¡æœ‰æ­£ç¡®è°ƒç”¨FragmentTransaction.remove()</span>
    <span class="hljs-comment">// æˆ–è€…Fragmentçš„Viewè¿˜åœ¨RecyclerViewçš„ç¼“å­˜ä¸­</span>
}
</code></pre>
</li>
</ol>
<p><strong>æ•´ä½“çš„æµç¨‹å›¾ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee90c5c903ce4bcab2e7c645bb9324bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bmP56iL5Y2B5YWr5bCR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768178922&amp;x-signature=coEmPgMczS3SG9OuDeHvBwXkzdM%3D" alt="å†…å­˜æ³„éœ².png" loading="lazy"/></p>
<h3 data-id="heading-13">4. æ—¥å¿—æ·±åº¦åˆ†æ</h3>
<h4 data-id="heading-14">4.1. GC Rootæº¯æº</h4>
<p>æ—¥å¿—æ˜¾ç¤ºGC Rootæ˜¯<code>Global variable in native code</code>ï¼Œè¿™è¡¨æ˜æ³„æ¼çš„æºå¤´åœ¨Androidç³»ç»Ÿå±‚ã€‚å…·ä½“æ¥è¯´ï¼Œæ˜¯<code>ViewRootImpl</code>çš„Lambdaè¡¨è¾¾å¼è¢«nativeå±‚çš„å…¨å±€å˜é‡æŒæœ‰ã€‚</p>
<p><code>ViewRootImpl</code>æ˜¯Androidçª—å£ç³»ç»Ÿçš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£è¿æ¥åº”ç”¨å±‚çš„Viewå’Œç³»ç»Ÿå±‚çš„Windowã€‚å½“Activityåˆ›å»ºçª—å£æ—¶ï¼Œç³»ç»Ÿä¼šåˆ›å»ºå¯¹åº”çš„ViewRootImplï¼Œå¹¶åœ¨nativeå±‚æ³¨å†Œå„ç§å›è°ƒã€‚</p>
<h4 data-id="heading-15">4.2. å¼•ç”¨é“¾åˆ†æ</h4>
<p>è®©æˆ‘ä»¬é€çº§åˆ†æè¿™ä¸ªå¼•ç”¨é“¾ï¼š</p>
<ol>
<li><strong>ç³»ç»Ÿå±‚æŒæœ‰</strong>ï¼šnativeå±‚çš„å…¨å±€å˜é‡æŒæœ‰ViewRootImplçš„Lambdaå¼•ç”¨</li>
<li><strong>Lambdaæ•è·</strong>ï¼šè¯¥Lambdaæ•è·äº†å¤–éƒ¨ç±»çš„å¼•ç”¨ï¼ˆå³MainActivityï¼‰</li>
<li><strong>Activityå­˜æ´»</strong>ï¼šMainActivityçš„<code>mDestroyed = false</code>ï¼Œè¡¨æ˜Activityå¹¶æœªé”€æ¯</li>
<li><strong>ç”Ÿå‘½å‘¨æœŸæ³¨å†Œ</strong>ï¼šActivityçš„<code>mLifecycleRegistry</code>æŒæœ‰<code>FragmentMaxLifecycleEnforcer</code></li>
<li><strong>ViewPager2å…³è”</strong>ï¼š<code>FragmentMaxLifecycleEnforcer</code>æŒæœ‰ViewPager2çš„å¼•ç”¨</li>
<li><strong>è§†å›¾æœªè¢«é‡Šæ”¾</strong>ï¼šViewPager2æŒæœ‰å·²è°ƒç”¨<code>onDestroyView()</code>çš„Fragmentè§†å›¾</li>
</ol>
<h4 data-id="heading-16">4.3. å…³é”®çŠ¶æ€ä¿¡æ¯</h4>
<p>ä»æ—¥å¿—ä¸­æˆ‘ä»¬æ³¨æ„åˆ°å‡ ä¸ªå…³é”®çŠ¶æ€ï¼š</p>
<ul>
<li><code>View.mAttachInfo is null (view detached)</code>ï¼šViewPager2å·²ä»çª—å£åˆ†ç¦»</li>
<li><code>View not part of a window view hierarchy</code>ï¼šè§†å›¾ä¸åœ¨çª—å£å±‚çº§ä¸­</li>
<li><code>mDestroyed = false</code>ï¼šActivityæœªé”€æ¯</li>
<li><code>PhoneAndroidFragment received Fragment#onDestroyView()</code>ï¼šFragmentçš„è§†å›¾å·²è¢«é”€æ¯</li>
</ul>
<h3 data-id="heading-17">é—®é¢˜æœ¬è´¨</h3>
<h4 data-id="heading-18">ç”Ÿå‘½å‘¨æœŸé”™é…</h4>
<p>è¿™ä¸ªé—®é¢˜çš„æ ¸å¿ƒæ˜¯<strong>ç”Ÿå‘½å‘¨æœŸæ³¨å†Œåœ¨é”™è¯¯çš„å±‚çº§</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// é”™è¯¯å†™æ³•ï¼šæ³¨å†Œåˆ°Activityç”Ÿå‘½å‘¨æœŸ
<span class="hljs-attr">adapter</span> = new ViewPagerAdapter(getActivity())<span class="hljs-comment">;</span>

// æ­£ç¡®å†™æ³•ï¼šæ³¨å†Œåˆ°Fragmentç”Ÿå‘½å‘¨æœŸ  
<span class="hljs-attr">adapter</span> = new ViewPagerAdapter(this)<span class="hljs-comment">;</span>
</code></pre>
<p>å½“ViewPager2çš„<code>FragmentStateAdapter</code>æ¥æ”¶åˆ°Activityä½œä¸ºå‚æ•°æ—¶ï¼Œå®ƒå†…éƒ¨åˆ›å»ºçš„<code>FragmentMaxLifecycleEnforcer</code>ä¼šæ³¨å†Œåˆ°Activityçš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™æ„å‘³ç€ï¼š</p>
<ul>
<li>å³ä½¿Fragmentçš„è§†å›¾è¢«é”€æ¯ï¼Œ<code>FragmentMaxLifecycleEnforcer</code>ä»ç„¶å­˜æ´»</li>
<li><code>FragmentMaxLifecycleEnforcer</code>æŒæœ‰ViewPager2çš„å¼•ç”¨</li>
<li>ViewPager2æŒæœ‰Fragmentå·²é”€æ¯çš„è§†å›¾</li>
<li>å¯¼è‡´Fragmentè§†å›¾æ— æ³•è¢«GCå›æ”¶</li>
</ul>
<h4 data-id="heading-19">ViewRootImplçš„ä»‹å…¥</h4>
<p>ä¸ºä»€ä¹ˆç³»ç»Ÿå±‚çš„ViewRootImplä¼šå‚ä¸è¿™ä¸ªæ³„æ¼é“¾ï¼Ÿ</p>
<p>å½“Activityæ˜¾ç¤ºæ—¶ï¼Œç³»ç»Ÿä¼šåˆ›å»ºViewRootImplæ¥ç®¡ç†çª—å£ã€‚ViewRootImplå¯èƒ½åˆ›å»ºä¸€äº›Lambdaå›è°ƒï¼ˆå¦‚çª—å£ç„¦ç‚¹å˜åŒ–ã€è¾“å…¥äº‹ä»¶å¤„ç†ç­‰ï¼‰ï¼Œè¿™äº›Lambdaéšå¼æ•è·äº†Activityå¼•ç”¨ã€‚ç”±äºè¿™äº›å›è°ƒè¢«nativeå±‚å…¨å±€å˜é‡å¼•ç”¨ï¼Œå®ƒä»¬æˆä¸ºäº†GC Rootï¼Œé˜»æ­¢äº†ActivityåŠå…¶å…³è”å¯¹è±¡çš„å›æ”¶ã€‚</p>
<h3 data-id="heading-20">5. è§£å†³æ–¹æ¡ˆ</h3>
<h4 data-id="heading-21">æ–¹æ¡ˆä¸€ï¼šä¿®æ­£ç”Ÿå‘½å‘¨æœŸæ³¨å†Œï¼ˆæ ¸å¿ƒä¿®å¤ï¼‰</h4>
<p>æ ¸å¿ƒè¦è®°ä½ï¼š<strong>FragmentStateAdapterå¿…é¡»ä½¿ç”¨Fragmentçš„ç”Ÿå‘½å‘¨æœŸï¼Œè€ŒéActivity</strong>ï¼Œè¿™æ˜¯è§£å†³æ­¤ç±»é—®é¢˜çš„å…³é”®ã€‚</p>
<p><strong>ä¿®æ”¹ViewPagerAdapterçš„æ„é€ å‡½æ•°è°ƒç”¨</strong>ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// PhoneAndroidFragment.java</span>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">initView</span>()</span> {
    <span class="hljs-comment">// å°†åŸæœ‰çš„ï¼š</span>
    <span class="hljs-comment">// adapter = new ViewPagerAdapter(getActivity());</span>
    <span class="hljs-comment">// æ”¹ä¸ºï¼š</span>
    adapter = <span class="hljs-keyword">new</span> ViewPagerAdapter(<span class="hljs-keyword">this</span>);  <span class="hljs-comment">// ä¼ é€’Fragmentæœ¬èº«</span>
}
</code></pre>
<p><strong>å¢å¼ºViewPagerAdapteræ”¯æŒFragment</strong>ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// ViewPagerAdapter.java</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">ViewPagerAdapter</span> <span class="hljs-selector-tag">extends</span> <span class="hljs-selector-tag">FragmentStateAdapter</span> {
    
    <span class="hljs-comment">// ä¿ç•™åŸæœ‰çš„Activityæ„é€ å‡½æ•°</span>
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">ViewPagerAdapter</span>(<span class="hljs-variable">@NonNull</span> FragmentActivity fragmentActivity) {
        <span class="hljs-selector-tag">super</span>(fragmentActivity);
    }
    
    <span class="hljs-comment">// æ–°å¢Fragmentæ„é€ å‡½æ•°ï¼ˆå…³é”®ä¿®å¤ï¼‰</span>
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">ViewPagerAdapter</span>(<span class="hljs-variable">@NonNull</span> Fragment fragment) {
        <span class="hljs-selector-tag">super</span>(fragment);
    }
    
    <span class="hljs-comment">// ... å…¶ä»–ä»£ç </span>
}
</code></pre>
<h4 data-id="heading-22">æ–¹æ¡ˆäºŒï¼šå½»åº•æ¸…ç†onDestroyView()</h4>
<pre><code class="hljs language-ini" lang="ini">@Override
public void onDestroyView() {
    <span class="hljs-attr">isDestroyed</span> = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
    
    // 1. æ¸…ç†Handler
    if (handler != null) {
        handler.removeCallbacksAndMessages(null)<span class="hljs-comment">;</span>
    }
    
    // 2. å–æ¶ˆViewPager2å›è°ƒ
    if (viewDataBinding != null &amp;&amp; pageChangeCallback != null) {
        viewDataBinding.phoneSettingPager.unregisterOnPageChangeCallback(pageChangeCallback)<span class="hljs-comment">;</span>
        <span class="hljs-attr">pageChangeCallback</span> = null<span class="hljs-comment">;</span>
    }
    
    // 3. æ¸…ç†ViewPager2é€‚é…å™¨
    if (viewDataBinding != null &amp;&amp; viewDataBinding.phoneSettingPager != null) {
        // æ¸…ç†å†…éƒ¨RecyclerView
        View <span class="hljs-attr">child</span> = viewDataBinding.phoneSettingPager.getChildAt(<span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
        if (child instanceof RecyclerView) {
            RecyclerView <span class="hljs-attr">recyclerView</span> = (RecyclerView) child<span class="hljs-comment">;</span>
            recyclerView.setAdapter(null)<span class="hljs-comment">;</span>
            recyclerView.setLayoutManager(null)<span class="hljs-comment">;</span>
            recyclerView.getRecycledViewPool().clear()<span class="hljs-comment">;</span>
        }
        
        // æ¸…ç†ViewPager2é€‚é…å™¨
        viewDataBinding.phoneSettingPager.setAdapter(null)<span class="hljs-comment">;</span>
    }
    
    // 4. æ¸…ç†é€‚é…å™¨å¼•ç”¨
    <span class="hljs-attr">adapter</span> = null<span class="hljs-comment">;</span>
    
    EventBusUtils.unRegister(this)<span class="hljs-comment">;</span>
    super.onDestroyView()<span class="hljs-comment">;</span>
}
</code></pre>
<h4 data-id="heading-23">æ–¹æ¡ˆä¸‰ï¼šæ·»åŠ çŠ¶æ€æ£€æŸ¥å’Œé˜²æŠ¤</h4>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// æ·»åŠ çŠ¶æ€æ£€æŸ¥æ–¹æ³•</span>
private boolean <span class="hljs-built_in">isFragmentUsable</span>() {
    return !isDestroyed &amp;&amp; 
           <span class="hljs-built_in">isAdded</span>() &amp;&amp; 
           <span class="hljs-built_in">getActivity</span>() != null &amp;&amp; 
           !<span class="hljs-built_in">getActivity</span>()<span class="hljs-selector-class">.isFinishing</span>() &amp;&amp; 
           <span class="hljs-built_in">getView</span>() != null;
}

<span class="hljs-comment">// åœ¨æ‰€æœ‰å›è°ƒä¸­ä½¿ç”¨çŠ¶æ€æ£€æŸ¥</span>
<span class="hljs-keyword">@Subscribe</span>(threadMode = ThreadMode.MAIN)
public void onEvent(SomeEvent event) {
    if (!isFragmentUsable()) return;
   
}
</code></pre>
<h4 data-id="heading-24">æ–¹æ¡ˆå››ï¼šä½¿ç”¨WeakReferenceåŒ…è£…å›è°ƒ</h4>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-comment">// å®‰å…¨çš„å›è°ƒåŒ…è£…ç±»</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SafePageChangeCallback</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ViewPager2</span>.<span class="hljs-title">OnPageChangeCallback</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-type">WeakReference</span>&lt;<span class="hljs-type">PhoneAndroidFragment</span>&gt; fragmentRef;
    
    public <span class="hljs-type">SafePageChangeCallback</span>(<span class="hljs-type">PhoneAndroidFragment</span> fragment) {
        <span class="hljs-keyword">this</span>.fragmentRef = <span class="hljs-keyword">new</span> <span class="hljs-type">WeakReference</span>&lt;&gt;(fragment);
    }
    
    <span class="hljs-meta">@Override</span>
    public void onPageSelected(int position) {
        <span class="hljs-type">PhoneAndroidFragment</span> fragment = fragmentRef.get();
        <span class="hljs-keyword">if</span> (fragment == <span class="hljs-literal">null</span> || !fragment.isFragmentUsable()) {
            <span class="hljs-keyword">return</span>;
        }
    
    }
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åªéœ€ä¸€ä¸ªåŸŸåï¼Œé›¶æˆæœ¬æ‹¥æœ‰æ— é™ä¸ªè‡ªå®šä¹‰é‚®ç®±]]></title>    <link>https://juejin.cn/post/7591421956216029222</link>    <guid>https://juejin.cn/post/7591421956216029222</guid>    <pubDate>2026-01-05T00:58:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591421956216029222" data-draft-id="7591406727137689626" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åªéœ€ä¸€ä¸ªåŸŸåï¼Œé›¶æˆæœ¬æ‹¥æœ‰æ— é™ä¸ªè‡ªå®šä¹‰é‚®ç®±"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-05T00:58:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çŸ¥è¯†æµ…è°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/607378030207176"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åªéœ€ä¸€ä¸ªåŸŸåï¼Œé›¶æˆæœ¬æ‹¥æœ‰æ— é™ä¸ªè‡ªå®šä¹‰é‚®ç®±
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/607378030207176/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çŸ¥è¯†æµ…è°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-05T00:58:10.000Z" title="Mon Jan 05 2026 00:58:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä»Šå¤©ï¼Œæˆ‘å°†æ‰‹æŠŠæ‰‹æ•™ä½ ä¸€ä¸ª**â€œç»ˆæéšç§ä¿æŠ¤â€<strong>æŠ€å·§ï¼šåªéœ€è´­ä¹°ä¸€ä¸ªä¾¿å®œçš„åŸŸåï¼ˆæ¯å¹´ä¸€æ¯å¥¶èŒ¶é’±ï¼‰ï¼Œé…åˆ Cloudflare å¼ºå¤§çš„å…è´¹åŠŸèƒ½ï¼Œä½ å°±èƒ½æ‹¥æœ‰</strong>æ— é™ä¸ª**å±äºè‡ªå·±çš„é‚®ç®±åœ°å€ã€‚</p>
<p><strong>æ ¸å¿ƒåŸç†ï¼š</strong> åŸŸåæ³¨å†Œ (è…¾è®¯äº‘) + DNS è§£æ (Cloudflare) + é‚®ä»¶è·¯ç”± (Cloudflare Email Routing)</p>
<hr/>
<h2 data-id="heading-0">å‡†å¤‡å·¥ä½œ</h2>
<ol>
<li><strong>çº¦ 10-30 å…ƒäººæ°‘å¸</strong>ï¼ˆç”¨äºè´­ä¹°åŸŸåçš„é¦–å¹´è´¹ç”¨ï¼‰ã€‚</li>
<li>ä¸€ä¸ª <strong>è…¾è®¯äº‘</strong> æˆ–è€…å…¶ä»–äº‘è´¦å·ï¼ˆç”¨äºè´­ä¹°åŸŸåï¼‰ã€‚</li>
<li>ä¸€ä¸ª <strong>Cloudflare</strong> è´¦å·ï¼ˆç”¨äºç®¡ç†åŸŸåå’Œé‚®ä»¶è½¬å‘ï¼‰ã€‚</li>
<li>ä¸€ä¸ªä½ å¸¸ç”¨çš„<strong>ä¸»é‚®ç®±</strong>ï¼ˆå¦‚ Gmail, QQ, Outlookï¼Œä½œä¸ºæœ€ç»ˆæ¥æ”¶é‚®ä»¶çš„æ”¶ä»¶ç®±ï¼‰ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-1">ç¬¬ä¸€æ­¥ï¼šåœ¨è…¾è®¯äº‘æ³¨å†ŒåŸŸå</h2>
<p>è…¾è®¯äº‘ï¼ˆDNSPodï¼‰æ˜¯å›½å†…ä¸»æµçš„åŸŸåæ³¨å†Œå•†ï¼Œæ”¯ä»˜æ–¹ä¾¿ä¸”ç®¡ç†ç•Œé¢ä¸­æ–‡å‹å¥½ã€‚</p>
<ol>
<li><strong>æœç´¢åŸŸå</strong>ï¼šç™»å½•è…¾è®¯äº‘å®˜ç½‘ï¼Œè¿›å…¥â€œåŸŸåæ³¨å†Œâ€é¡µé¢ã€‚</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d5c3be15cb2648f4be616099f80abbb2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-l6K-G5rWF6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768179490&amp;x-signature=NcInqWjo3qOZc4ImEB%2FmRRmzKJM%3D" alt="" loading="lazy"/></p>
<ol start="2">
<li><strong>æŒ‘é€‰åç¼€</strong>ï¼šå¦‚æœä½ åªæ˜¯ä¸ºäº†æ”¶é‚®ä»¶ï¼Œä¸éœ€è¦ä¹°æ˜‚è´µçš„ <code>.com</code>ã€‚å¯ä»¥é€‰æ‹© <code>.xyz</code>, <code>.top</code>, <code>.site</code> æˆ– <code>.fun</code> ç­‰ä¾¿å®œçš„åç¼€ï¼Œé¦–å¹´é€šå¸¸åªéœ€å‡ å—é’±ã€‚</li>
<li><strong>è´­ä¹°å¹¶å®åè®¤è¯</strong>ï¼šæŒ‰ç…§æµç¨‹æ”¯ä»˜ï¼Œå¹¶å®ŒæˆåŸŸåçš„å®åè®¤è¯ï¼ˆè¿™æ˜¯å›½å†…æ³¨å†ŒåŸŸåçš„å¿…é¡»æ­¥éª¤ï¼Œé€šå¸¸éœ€è¦ä¸Šä¼ èº«ä»½è¯ï¼‰ã€‚</li>
</ol>
<blockquote>
<p><strong>ğŸ’¡ æç¤ºï¼š</strong> è´­ä¹°å®Œæˆåï¼Œè¯·è¿›å…¥è…¾è®¯äº‘çš„â€œåŸŸåç®¡ç†â€æ§åˆ¶å°ï¼Œç¡®è®¤åŸŸåçŠ¶æ€ä¸ºâ€œæ­£å¸¸â€ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-2">ç¬¬äºŒæ­¥ï¼šå°†åŸŸåâ€œæ‰˜ç®¡â€åˆ° Cloudflare</h2>
<p>ä¸ºäº†ä½¿ç”¨ Cloudflare çš„å…è´¹é‚®ä»¶è·¯ç”±åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦å°†åŸŸåçš„ DNS è§£ææƒä»è…¾è®¯äº‘ç§»äº¤ç»™ Cloudflareã€‚</p>
<ol>
<li><strong>æ·»åŠ ç«™ç‚¹</strong>ï¼š</li>
</ol>
<ul>
<li>ç™»å½• <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.cloudflare.com%2F" target="_blank" title="https://www.cloudflare.com/" ref="nofollow noopener noreferrer">Cloudflare å®˜ç½‘</a>ã€‚</li>
<li>ç‚¹å‡»å³ä¸Šè§’çš„ <strong>"Add a site" (æ·»åŠ ç«™ç‚¹)</strong>ã€‚</li>
<li>è¾“å…¥ä½ åˆšæ‰åœ¨è…¾è®¯äº‘ä¹°çš„åŸŸåï¼ˆä¾‹å¦‚ <code>mycoolmail.xyz</code>ï¼‰ï¼Œç‚¹å‡»ç»§ç»­ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be5bebc87dfb4da6ad3abdf9afee2057~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-l6K-G5rWF6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768179490&amp;x-signature=%2F7HwL2AhHPLxs5oIetJzwQuauxs%3D" alt="" loading="lazy"/></li>
</ul>
<ol start="2">
<li><strong>é€‰æ‹©å¥—é¤</strong>ï¼š</li>
</ol>
<ul>
<li>é¡µé¢ä¼šå±•ç¤ºå„ç§ä»˜è´¹å¥—é¤ï¼Œè¯·<strong>å‘ä¸‹æ»‘åŠ¨</strong>ï¼Œæ‰¾åˆ°åº•éƒ¨çš„ <strong>"Free" (å…è´¹ç‰ˆ)</strong> å¥—é¤æ¡†ï¼Œç‚¹å‡»é€‰æ‹©å¹¶ç»§ç»­ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b6401f4fbab48e6b085c9afa9600a35~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-l6K-G5rWF6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768179490&amp;x-signature=5aseRBZ5KH8lf2bymUjGyhcmGsY%3D" alt="" loading="lazy"/></li>
</ul>
<ol start="3">
<li><strong>è·å– Nameservers (åç§°æœåŠ¡å™¨)</strong>ï¼š</li>
</ol>
<ul>
<li>Cloudflare ä¼šæ‰«æä½ å½“å‰çš„ DNS è®°å½•ï¼Œç›´æ¥ç‚¹å‡»ç»§ç»­ã€‚</li>
<li><strong>å…³é”®æ­¥éª¤</strong>ï¼šCloudflare ä¼šç»™å‡ºä¸¤ä¸ª Nameserver åœ°å€ï¼Œé€šå¸¸æ ¼å¼ä¸º <code>xxxx.ns.cloudflare.com</code>ã€‚è¯·<strong>å¤åˆ¶è¿™ä¸¤ä¸ªåœ°å€</strong>ã€‚</li>
</ul>
<ol start="4">
<li><strong>ä¿®æ”¹è…¾è®¯äº‘ DNS</strong>ï¼š</li>
</ol>
<ul>
<li>
<p>å›åˆ°è…¾è®¯äº‘åŸŸåæ§åˆ¶å°ï¼Œæ‰¾åˆ°ä½ çš„åŸŸåï¼Œç‚¹å‡» <strong>â€œDNS ç®¡ç†â€</strong>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6523a9edf97c4908b7d6a1383ee25bdd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-l6K-G5rWF6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768179490&amp;x-signature=sdI%2FnvfFGyYpWYI1LZitfhJv9G0%3D" alt="" loading="lazy"/></p>
</li>
<li>
<p>ç‚¹å‡»ä¿®æ”¹DNSæœåŠ¡å™¨
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/27b5be67ea61406b9bfbe359d3aadca1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-l6K-G5rWF6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768179490&amp;x-signature=vONW27f%2BdJiF4eFscI70wBpJp4k%3D" alt="" loading="lazy"/></p>
</li>
<li>
<p>å°†é»˜è®¤çš„è…¾è®¯äº‘ DNS åœ°å€ï¼ˆå¦‚ <code>ns1.dnspod.net</code>ï¼‰åˆ é™¤ï¼Œé€‰æ‹©ä½¿ç”¨éè…¾è®¯äº‘DNS</p>
</li>
<li>
<p><strong>ç²˜è´´</strong> åˆšæ‰ä» Cloudflare å¤åˆ¶çš„é‚£ä¸¤ä¸ªåœ°å€ã€‚</p>
</li>
<li>
<p>ä¿å­˜è®¾ç½®ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e4ae8b63e4ff4d06a3a6da1a97137e1a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-l6K-G5rWF6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768179490&amp;x-signature=ny60mQR%2BBL0cvhcDZpCFVwQkrYs%3D" alt="" loading="lazy"/></p>
</li>
</ul>
<blockquote>
<p><strong>â³ æ³¨æ„ï¼š</strong> DNS ä¿®æ”¹ç”Ÿæ•ˆå¯èƒ½éœ€è¦å‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶ã€‚åœ¨ Cloudflare é¡µé¢ç‚¹å‡» "Check nameservers"ï¼Œå½“çœ‹åˆ°ç»¿è‰²çš„ "Active" çŠ¶æ€æ—¶ï¼Œè¯´æ˜ç»‘å®šæˆåŠŸï¼</p>
</blockquote>
<hr/>
<h2 data-id="heading-3">ç¬¬ä¸‰æ­¥ï¼šé…ç½® Cloudflare é‚®ä»¶è·¯ç”± (Email Routing)</h2>
<p>è¿™æ˜¯æœ€ç¥å¥‡çš„ä¸€æ­¥ï¼Œé…ç½®å®Œå…¨å…è´¹ä¸”éå¸¸ç®€å•ã€‚</p>
<ol>
<li><strong>å¯ç”¨åŠŸèƒ½</strong>ï¼š</li>
</ol>
<ul>
<li>åœ¨ Cloudflare å·¦ä¾§èœå•æ ï¼Œæ‰¾åˆ° <strong>"Email" (ç”µå­é‚®ä»¶)</strong> -&gt; <strong>"Email Routing" (é‚®ä»¶è·¯ç”±)</strong>ã€‚</li>
<li>ç‚¹å‡» <strong>"Get Started"</strong> æŒ‰é’®ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/766723283d0b4b39a20b68376e33e04b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-l6K-G5rWF6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768179490&amp;x-signature=sJEIifvNKPGEaG1jEr2u3W8NDuQ%3D" alt="" loading="lazy"/></li>
</ul>
<ol start="2">
<li><strong>è®¾ç½®ç›®æ ‡é‚®ç®±</strong>ï¼š</li>
</ol>
<ul>
<li>åœ¨ <strong>"Destination address" (ç›®æ ‡åœ°å€)</strong> ä¸­ï¼Œå¡«å…¥ä½ å¹³æ—¶ç”¨çš„ä¸»é‚®ç®±ï¼ˆæ¯”å¦‚ä½ çš„ QQ é‚®ç®±æˆ– Gmailï¼‰ã€‚</li>
<li>Cloudflare ä¼šå‘é€ä¸€å°éªŒè¯é‚®ä»¶åˆ°ä½ çš„ä¸»é‚®ç®±ï¼Œå»ç‚¹å‡»é‚®ä»¶ä¸­çš„éªŒè¯é“¾æ¥ï¼Œ<strong>è¿™ä¸€æ­¥ä¸ä¸€å®šæœ‰</strong>ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a452cfbb7b8d41d18b31d39750794173~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-l6K-G5rWF6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768179490&amp;x-signature=tc6TV3kaO%2BlRO%2BfSOT3dXxnl9rE%3D" alt="" loading="lazy"/></li>
</ul>
<ol start="3">
<li><strong>è‡ªåŠ¨æ·»åŠ  DNS è®°å½•</strong>ï¼š</li>
</ol>
<ul>
<li>éªŒè¯æˆåŠŸåï¼Œå›åˆ° Cloudflare é¡µé¢ã€‚ç³»ç»Ÿä¼šæç¤ºä½ ç¼ºå°‘å¿…è¦çš„ MX å’Œ SPF è®°å½•,<strong>ç³»ç»Ÿæç¤ºçš„æ—¶å€™è¦ç‚¹å‡»ç¡®è®¤</strong>ã€‚</li>
<li>ç‚¹å‡» <strong>"Add records and enable" (æ·»åŠ è®°å½•å¹¶å¯ç”¨)</strong>ã€‚Cloudflare ä¼šè‡ªåŠ¨å¸®ä½ é…ç½®å¥½æ‰€æœ‰å¤æ‚çš„å‚æ•°ï¼Œæ— éœ€æ‰‹åŠ¨å¡«å†™ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-4">ç¬¬å››æ­¥ï¼šå¼€å¯â€œæ— é™é‚®ç®±â€æ¨¡å¼</h2>
<p>ç°åœ¨é€šè¿‡éªŒè¯åï¼Œä½ æœ‰ä¸¤ç§æ–¹å¼æ¥åˆ›å»ºé‚®ç®±ã€‚</p>
<h3 data-id="heading-5">æ–¹å¼ä¸€ï¼šåˆ›å»ºå›ºå®šåˆ«å (Custom Addresses)</h3>
<p>é€‚åˆå›ºå®šç”¨é€”ã€‚æ¯”å¦‚ä½ è¦æ³¨å†Œ Netflixï¼Œä½ å¯ä»¥ä¸“é—¨åˆ›å»ºä¸€ä¸ªï¼š</p>
<ul>
<li><strong>Custom address:</strong> <code>netflix</code> (@[å¯ç–‘é“¾æ¥å·²åˆ é™¤])</li>
<li><strong>Destination:</strong> ä½ çš„ä¸»é‚®ç®±</li>
<li>ç‚¹å‡»ä¿å­˜ã€‚ä»¥åæ‰€æœ‰å‘ç»™ <code>netflix@yourdomain.com</code> çš„é‚®ä»¶éƒ½ä¼šèººåœ¨ä½ çš„ä¸»é‚®ç®±é‡Œã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a17e3c41949d4800bc26e8a698bf2716~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-l6K-G5rWF6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768179490&amp;x-signature=8wNqytN9AyXQ3oGfuwPQppMbs0A%3D" alt="" loading="lazy"/></li>
</ul>
<h3 data-id="heading-6">æ–¹å¼äºŒ:å¼€å¯Catch-All(æ¥æ”¶æ‰€æœ‰é‚®ä»¶)æ¨è ğŸ”¥</h3>
<p>è¿™æ˜¯å®ç°â€œæ— é™â€çš„å…³é”®ã€‚å¼€å¯è¿™ä¸ªåŠŸèƒ½åï¼Œ<strong>ä»»ä½•</strong>å‘å¾€ä½ åŸŸåçš„é‚®ä»¶ï¼Œå“ªæ€•å‰ç¼€æ˜¯ä½ åˆšæ‰ä¸´æ—¶çç¼–çš„ï¼Œéƒ½ä¼šè¢«è½¬å‘ã€‚</p>
<ol>
<li>åœ¨ Email Routing é¡µé¢ï¼Œç‚¹å‡» <strong>"Settings" (è®¾ç½®)</strong> æ ‡ç­¾ã€‚</li>
<li>æ‰¾åˆ° <strong>"Catch-All address"</strong> é€‰é¡¹ã€‚</li>
<li>ç‚¹å‡» <strong>"Edit"</strong>ï¼ŒçŠ¶æ€æ”¹ä¸º <strong>"Active"</strong>ï¼Œå¹¶é€šè¿‡ "Action" é€‰æ‹© "Send to"ï¼Œç›®æ ‡å¡«å…¥ä½ çš„ä¸»é‚®ç®±ã€‚</li>
<li>ä¿å­˜ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d34408cede3d4e23bc06451031c342b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-l6K-G5rWF6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768179490&amp;x-signature=Aby92g%2FueH9UtHPOVPNOGKBH06c%3D" alt="" loading="lazy"/></li>
</ol>
<p><strong>ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹ï¼š</strong>
å½“ä½ å»ä¸€å®¶åä¸º "ABCä¹¦åº—" çš„ç½‘ç«™æ³¨å†Œæ—¶ï¼Œç›´æ¥å¡« <code>abcbook@yourdomain.com</code>ã€‚</p>
<ul>
<li><strong>æ— éœ€è®¾ç½®ï¼š</strong> ä½ ä¸éœ€è¦å…ˆå» Cloudflare åå°åˆ›å»ºè¿™ä¸ªåœ°å€ï¼Œç›´æ¥å¡«ï¼Œç›´æ¥æ”¶ã€‚</li>
<li><strong>è¿½è¸ªæ³„éœ²ï¼š</strong> å¦‚æœä»¥åä½ æ”¶åˆ°åƒåœ¾é‚®ä»¶ï¼Œå‘ç°æ”¶ä»¶äººæ˜¯ <code>abcbook@yourdomain.com</code>ï¼Œä½ å°±çŸ¥é“æ˜¯è¿™å®¶ä¹¦åº—æ³„éœ²äº†ä½ çš„ä¿¡æ¯ï¼</li>
</ul>
<hr/>
<h2 data-id="heading-7">æ€»ç»“</h2>
<p>ç°åœ¨ï¼Œä½ å·²ç»æˆåŠŸæ‹¥æœ‰äº†ä¸€ä¸ªå±äºè‡ªå·±çš„ä¼ä¸šçº§åŸŸåé‚®ç®±ç³»ç»Ÿã€‚</p>
<ul>
<li><strong>æˆæœ¬ï¼š</strong> ä»…åŸŸåè´¹ï¼ˆå‡ åå…ƒ/å¹´ï¼‰ã€‚</li>
<li><strong>æ”¶ç›Šï¼š</strong> æ— é™ä¸ªé‚®ç®±è´¦å·ï¼Œå®Œç¾çš„éšç§éš”ç¦»ï¼Œçœ‹èµ·æ¥éå¸¸ä¸“ä¸šçš„ä¸ªäººå½¢è±¡ã€‚</li>
<li><strong>æ³¨æ„ï¼š</strong> ç›®å‰è¯¥æ–¹æ³•ä¸»è¦ç”¨äº<strong>æ¥æ”¶</strong>é‚®ä»¶ã€‚å¦‚æœéœ€è¦ç”¨è¿™äº›åŸŸåé‚®ç®±<strong>å‘é€</strong>é‚®ä»¶ï¼Œé€šå¸¸éœ€è¦é…åˆ Gmail çš„ SMTP åŠŸèƒ½ï¼ˆè®¾ç½®ç¨å¤æ‚ï¼‰ã€‚</li>
</ul>
<p>å¿«å»è¯•è¯•å§,å¥½å¤šç½‘ç«™éœ€è¦é‚®ç®±æ³¨å†Œçš„å¯ä»¥éšä¾¿æ³¨å†Œäº†ï¼Œæ‡‚å¾—éƒ½æ‡‚ğŸ˜</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åç«¯åˆ†å±‚æ¶æ„è§„èŒƒå’Œæ ‡å‡†åŒ…ç»“æ„]]></title>    <link>https://juejin.cn/post/7591350620189048838</link>    <guid>https://juejin.cn/post/7591350620189048838</guid>    <pubDate>2026-01-04T16:36:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591350620189048838" data-draft-id="7587284708943134754" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åç«¯åˆ†å±‚æ¶æ„è§„èŒƒå’Œæ ‡å‡†åŒ…ç»“æ„"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2026-01-04T16:36:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€çº¿å¤§ç "/> <meta itemprop="url" content="https://juejin.cn/user/3280598429340984"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åç«¯åˆ†å±‚æ¶æ„è§„èŒƒå’Œæ ‡å‡†åŒ…ç»“æ„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3280598429340984/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€çº¿å¤§ç 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T16:36:37.000Z" title="Sun Jan 04 2026 16:36:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">1. åç«¯åˆ†å±‚æ¶æ„è§„èŒƒ</h2>
<blockquote>
<p><strong>ç›®æ ‡</strong><br/>
åœ¨çœŸå®å¤æ‚ä¸šåŠ¡ä¸‹ï¼Œä¿æŒä¾èµ–æ–¹å‘æ¸…æ™°ï¼Œé¿å… Service äº’ç›¸çº ç¼ ï¼Œä¿è¯ç³»ç»Ÿå¯é•¿æœŸæ¼”è¿›ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">1.1. åˆ†å±‚æ€»è§ˆï¼ˆå¿…é¡»éµå®ˆï¼‰</h3>
<pre><code class="hljs language-java" lang="java">Controller
    â†“
Service / Facadeï¼ˆä¸šåŠ¡ä¸»ä½“ / æµç¨‹ç¼–æ’ï¼‰
    â†“
Queryï¼ˆåªè¯»æŸ¥è¯¢æ¨¡å‹ï¼Œå…è®¸ JOINï¼‰
    â†“
Daoï¼ˆå•è¡¨æŒä¹…åŒ–ï¼‰
    â†“
Table
</code></pre>
<p><strong>ä¾èµ–åªèƒ½è‡ªä¸Šè€Œä¸‹ï¼Œç¦æ­¢åå‘ã€‚</strong></p>
<h3 data-id="heading-2">1.2. æ ¸å¿ƒæ¦‚å¿µå®šä¹‰ï¼ˆç»Ÿä¸€å£å¾„ï¼‰</h3>
<h4 data-id="heading-3">1.2.1. ä¸šåŠ¡ä¸»ä½“ï¼ˆDomain Entityï¼‰</h4>
<p>å…·æœ‰ç‹¬ç«‹ä¸šåŠ¡è¯­ä¹‰å’Œç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>ç”¨æˆ·ã€è®¢å•ã€åº“å­˜ã€è´¦æˆ·ã€å•†å“</li>
</ul>
<p><strong>ä¸€ä¸ªä¸šåŠ¡ä¸»ä½“ = ä¸€ä¸ª Service</strong></p>
<h4 data-id="heading-4">1.2.2. é™„å±è¡¨ï¼ˆé™„å±/æŠ€æœ¯æ€§æ•°æ®ï¼‰</h4>
<p>ä¸å…·å¤‡ç‹¬ç«‹ä¸šåŠ¡è¯­ä¹‰ï¼Œä»…æœåŠ¡äºæŸä¸€ä¸»ä½“ï¼š</p>
<ul>
<li>æ—¥å¿—ã€æµæ°´ã€å†å²è¡¨ã€å¿«ç…§ã€å®¡è®¡è¡¨</li>
</ul>
<p><strong>å¯ä»¥ç”±ä¸»ä½“ Service ç›´æ¥æ“ä½œ</strong></p>
<h4 data-id="heading-5">1.2.3. è·¨ä¸»ä½“æµç¨‹</h4>
<p>æ¶‰åŠ <strong>ä¸¤ä¸ªåŠä»¥ä¸Šä¸šåŠ¡ä¸»ä½“</strong> çš„å†™æ“ä½œï¼š</p>
<ul>
<li>ä¸‹å•æ‰£åº“å­˜</li>
<li>è®¢å• + æ”¯ä»˜</li>
<li>ç”¨æˆ· + è´¦æˆ·åˆå§‹åŒ–</li>
</ul>
<p><strong>å¿…é¡»ä¸Šç§»åˆ° Facade / Flow Service</strong></p>
<h3 data-id="heading-6">1.3. å„å±‚èŒè´£ä¸ç¡¬è§„åˆ™</h3>
<h4 data-id="heading-7">1.3.1. Controller å±‚ï¼ˆå…¥å£å±‚ï¼‰</h4>
<p><strong>èŒè´£</strong></p>
<ul>
<li>å‚æ•°æ ¡éªŒ</li>
<li>æƒé™æ ¡éªŒ</li>
<li>è°ƒç”¨ Service / Facade</li>
</ul>
<p><strong>ç¦æ­¢</strong></p>
<ul>
<li>âŒ å†™ä¸šåŠ¡é€»è¾‘</li>
<li>âŒ è®¿é—® Dao / Query</li>
<li>âŒ Controller äº’è°ƒ</li>
</ul>
<h4 data-id="heading-8">1.3.2. Service å±‚ï¼ˆä¸šåŠ¡ä¸»ä½“å±‚ï¼‰</h4>
<p><strong>èŒè´£</strong></p>
<ul>
<li>æœ¬ä¸šåŠ¡ä¸»ä½“çš„ä¸šåŠ¡è§„åˆ™</li>
<li>çŠ¶æ€å˜æ›´</li>
<li>æ“ä½œæœ¬ä¸»ä½“è¡¨åŠå…¶é™„å±è¡¨</li>
</ul>
<p><strong>å…è®¸</strong></p>
<ul>
<li>âœ… å†™ï¼šæœ¬ä¸»ä½“ Dao</li>
<li>âœ… å†™ï¼šæœ¬ä¸»ä½“é™„å±è¡¨ Daoï¼ˆæ—¥å¿— / æµæ°´ï¼‰</li>
<li>âœ… è¯»ï¼šQueryï¼ˆç”¨äºæ ¡éªŒ / å±•ç¤º / è®¡ç®—ï¼‰</li>
</ul>
<p><strong>ç¦æ­¢</strong></p>
<ul>
<li>âŒ å†™å…¶ä»–ä¸šåŠ¡ä¸»ä½“è¡¨</li>
<li>âŒ è°ƒç”¨å…¶ä»–ä¸šåŠ¡ä¸»ä½“ Service</li>
<li>âŒ ç¼–å†™ JOIN SQL</li>
</ul>
<blockquote>
<p><strong>åˆ¤æ–­å£è¯€</strong><br/>
â€œå¦‚æœåˆ æ‰å¦ä¸€ä¸ªä¸šåŠ¡ä¸»ä½“ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯å¦ä»æˆç«‹ï¼Ÿâ€</p>
<ul>
<li>æ˜¯ â†’ ç•™åœ¨æœ¬ Service</li>
<li>å¦ â†’ ä¸Šç§» Facade</li>
</ul>
</blockquote>
<h4 data-id="heading-9">1.3.3. Facade / Flow Serviceï¼ˆæµç¨‹ç¼–æ’å±‚ï¼‰</h4>
<p><strong>èŒè´£</strong></p>
<ul>
<li>è·¨ä¸šåŠ¡ä¸»ä½“æµç¨‹</li>
<li>è°ƒç”¨é¡ºåº</li>
<li>äº‹åŠ¡è¾¹ç•Œ</li>
<li>å¼‚å¸¸ä¸å¤±è´¥å¤„ç†</li>
</ul>
<p><strong>å…è®¸</strong></p>
<ul>
<li>âœ… è°ƒç”¨å¤šä¸ª Service</li>
<li>âœ… ç®¡ç†äº‹åŠ¡</li>
</ul>
<p><strong>ç¦æ­¢</strong></p>
<ul>
<li>âŒ ç›´æ¥è®¿é—® Dao</li>
<li>âŒ ç¼–å†™ SQL</li>
<li>âŒ å®ç°é¢†åŸŸç»†èŠ‚è§„åˆ™</li>
</ul>
<h4 data-id="heading-10">1.3.4. Query å±‚ï¼ˆåªè¯»æ¨¡å‹ï¼ŒJOIN ä¸»è¦å½’å±ï¼‰</h4>
<p><strong>èŒè´£</strong></p>
<ul>
<li>å¤šè¡¨æŸ¥è¯¢</li>
<li>åˆ—è¡¨ / è¯¦æƒ… / ç»Ÿè®¡ / æŠ¥è¡¨</li>
<li>æ€§èƒ½ä¼˜åŒ–æŸ¥è¯¢</li>
</ul>
<p><strong>å…è®¸</strong></p>
<ul>
<li>âœ… JOIN å¤šè¡¨</li>
<li>âœ… è·¨ä¸šåŠ¡ä¸»ä½“</li>
<li>âœ… è¿”å› DTO / View Object</li>
</ul>
<p><strong>ç¦æ­¢</strong></p>
<ul>
<li>âŒ å†™æ“ä½œï¼ˆINSERT / UPDATE / DELETEï¼‰</li>
<li>âŒ æ‰¿è½½ä¸šåŠ¡è§„åˆ™</li>
<li>âŒ ä¿®æ”¹ä¸šåŠ¡çŠ¶æ€</li>
</ul>
<p><strong>å‘½åå»ºè®®</strong></p>
<ul>
<li><code>XxxOnlyQuery</code></li>
<li><code>XxxReadModel</code></li>
<li><code>XxxQueryRepository</code></li>
</ul>
<h4 data-id="heading-11">1.3.5. Dao å±‚ï¼ˆæŒä¹…åŒ–å±‚ï¼‰</h4>
<p><strong>èŒè´£</strong></p>
<ul>
<li>å•è¡¨ CRUD</li>
<li>ä¸è¡¨ç»“æ„ä¸€ä¸€å¯¹åº”</li>
</ul>
<p><strong>è§„åˆ™</strong></p>
<ul>
<li>âŒ ä¸å…è®¸ JOIN å¤šä¸ªä¸šåŠ¡ä¸»ä½“è¡¨</li>
<li>âŒ ä¸æ‰¿è½½ä¸šåŠ¡è¯­ä¹‰</li>
<li>âŒ ä¸è¢«è·¨ä¸šåŠ¡ä¸»ä½“å¤ç”¨</li>
</ul>
<h3 data-id="heading-12">1.4. JOIN SQL æ”¾ç½®è§„åˆ™ï¼ˆå¼ºåˆ¶æ‰§è¡Œï¼‰</h3>
<p><strong>ä¸€å¥è¯è§„åˆ™ï¼ˆå†™åœ¨ Code Review æ ‡å‡†é‡Œï¼‰</strong></p>
<blockquote>
<p><strong>å‡¡æ˜¯ JOIN äº†å¤šä¸ªä¸šåŠ¡ä¸»ä½“çš„ SQLï¼Œä¸€å¾‹ä¸è¿›ä¸»ä½“ Daoã€‚</strong></p>
</blockquote>
<h4 data-id="heading-13">1.4.1. JOIN SQL å†³ç­–è¡¨ï¼ˆå¿…é¡»æŒ‰é¡ºåºåˆ¤æ–­ï¼‰</h4>
<p><strong>â“1ï¸âƒ£ æ˜¯å¦è·¨å¤šä¸ªä¸šåŠ¡ä¸»ä½“ï¼Ÿ</strong></p>
<ul>
<li>æ˜¯ â†’ <strong>Query</strong></li>
<li>å¦ â†’ ç»§ç»­</li>
</ul>
<p><strong>â“2ï¸âƒ£ æ˜¯å¦åªè¯»ï¼Ÿ</strong></p>
<ul>
<li>æ˜¯ â†’ <strong>Query</strong></li>
<li>å¦ â†’ âŒ æ‹†ä¸º Service è°ƒç”¨ï¼ˆç¦æ­¢ JOIN å†™ï¼‰</li>
</ul>
<p><strong>â“3ï¸âƒ£ æ˜¯å¦æ‰¿è½½ä¸šåŠ¡è§„åˆ™ï¼Ÿ</strong></p>
<ul>
<li>æ˜¯ â†’ âŒ ä¸å…è®¸ï¼ˆå› Serviceï¼‰</li>
<li>å¦ â†’ <strong>Query</strong></li>
</ul>
<h4 data-id="heading-14">1.4.2. å…è®¸æ”¾åœ¨ä¸»ä½“ Dao çš„å”¯ä¸€ä¾‹å¤–</h4>
<p><strong>åŒæ—¶æ»¡è¶³ä»¥ä¸‹æ‰€æœ‰æ¡ä»¶ï¼š</strong></p>
<ul>
<li>
<p>JOIN çš„è¡¨å…¨éƒ¨å±äº <strong>åŒä¸€ä¸šåŠ¡ä¸»ä½“</strong></p>
</li>
<li>
<p>å…³è”çš„æ˜¯ï¼š</p>
<ul>
<li>æ˜ç»†è¡¨</li>
<li>æ—¥å¿—è¡¨</li>
<li>å¿«ç…§è¡¨</li>
</ul>
</li>
<li>
<p>SQL ä¸å½±å“å…¶ä»–ä¸»ä½“å†³ç­–</p>
</li>
</ul>
<p>âœ… ç¤ºä¾‹ï¼ˆå…è®¸ï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java">OrderDao.findOrderWithItems()
-- Order + OrderItem
</code></pre>
<p>âŒ ç¤ºä¾‹ï¼ˆç¦æ­¢ï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java">OrderDao.findOrderWithUser()
OrderDao.joinStock()
</code></pre>
<h3 data-id="heading-15">1.5. æœ€å®¹æ˜“çŠ¯é”™çš„ 3 ç§æƒ…å†µï¼ˆå¿…é¡»é¿å…ï¼‰</h3>
<h4 data-id="heading-16">1.5.1. åœ¨ Service / Dao ä¸­å†™è·¨ä¸»ä½“ JOIN</h4>
<pre><code class="hljs language-java" lang="java">UPDATE order o
JOIN stock s ...
</code></pre>
<h4 data-id="heading-17">1.5.2. ä¸ºäº†â€œåªæ˜¯æŸ¥ä¸€ä¸‹â€ï¼Œç›´æ¥è·¨ä¸»ä½“ Dao</h4>
<pre><code class="hljs language-java" lang="java">orderService â†’ userDao
</code></pre>
<h4 data-id="heading-18">1.5.3. ç»Ÿè®¡ / æŠ¥è¡¨å¤ç”¨ä¸šåŠ¡ Dao</h4>
<pre><code class="hljs language-java" lang="java">statisticsService â†’ orderDao
</code></pre>
<h3 data-id="heading-19">1.6. å¿«é€Ÿå†³ç­–è¡¨ï¼ˆå†™ä»£ç å‰ 10 ç§’ï¼‰</h3>





























<table><thead><tr><th>åœºæ™¯</th><th>æ”¾ç½®ä½ç½®</th></tr></thead><tbody><tr><td>å•ä¸»ä½“ä¸šåŠ¡å†™</td><td>å¯¹åº” Service</td></tr><tr><td>å¤šä¸»ä½“ä¸šåŠ¡å†™</td><td>Facade / Flow Service</td></tr><tr><td>å¤šè¡¨ JOIN æŸ¥è¯¢</td><td>Query</td></tr><tr><td>æ—¥å¿— / æµæ°´</td><td>ä¸»ä½“ Service</td></tr><tr><td>æŠ¥è¡¨ / ç»Ÿè®¡</td><td>StatisticsService + Query</td></tr></tbody></table>
<h3 data-id="heading-20">1.7. å›¢é˜Ÿå…±è¯†ï¼ˆå¼ºçƒˆå»ºè®®è´´å¢™ï¼‰</h3>
<blockquote>
<p><strong>ä¸è¦æŒ‰â€œè¡¨â€æ‹† Serviceï¼Œè¦æŒ‰â€œä¸šåŠ¡ä¸»ä½“â€æ‹† Serviceã€‚</strong></p>
<p><strong>ä¸è¦ä¸ºäº† JOIN æ–¹ä¾¿ï¼ŒæŠŠæŸ¥è¯¢å¡è¿›ä¸»ä½“ Daoã€‚</strong></p>
</blockquote>
<h2 data-id="heading-21">2. æ ‡å‡†åŒ…ç»“æ„</h2>
<p>ä¸‹é¢æ˜¯ä¸€ä»½æŒ‰<strong>çœŸå®ä¸­å¤§å‹ Java / Spring é¡¹ç›®</strong>æ•´ç†çš„ï¼Œä¸æ˜¯æ•™å­¦ Demoã€‚</p>
<blockquote>
<p>ç›®æ ‡ï¼š</p>
<ul>
<li>ä¸€çœ¼èƒ½çœ‹æ‡‚åˆ†å±‚</li>
<li>æ–°äººä¸å®¹æ˜“å†™é”™</li>
<li>Code Review æ—¶â€œçœ‹è·¯å¾„å°±èƒ½å‘ç°é—®é¢˜â€</li>
</ul>
</blockquote>
<p>æ ‡å‡†åŒ…ç»“æ„ç¤ºä¾‹ï¼ˆå¯ç›´æ¥ç…§æŠ„ï¼‰</p>
<blockquote>
<p>ç¤ºä¾‹ä»¥ <strong>è®¢å• + ç”¨æˆ· + åº“å­˜</strong> åœºæ™¯ä¸ºä¾‹<br/>
åŒ…åä½ å¯ä»¥æ¢ï¼Œå…¬å¸åä¸é‡è¦</p>
</blockquote>
<pre><code class="hljs language-java" lang="java">com.xxx.project
</code></pre>
<h3 data-id="heading-22">2.1. æ•´ä½“ç»“æ„æ€»è§ˆï¼ˆå…ˆçœ‹å…¨è²Œï¼‰</h3>
<pre><code class="hljs language-java" lang="java">com.xxx.project
â”œâ”€ controller
â”œâ”€ application        <span class="hljs-comment">// Facade / æµç¨‹ç¼–æ’</span>
â”œâ”€ domain             <span class="hljs-comment">// ä¸šåŠ¡ä¸»ä½“</span>
â”‚   â”œâ”€ order
â”‚   â”œâ”€ user
â”‚   â””â”€ stock
â”œâ”€ query               <span class="hljs-comment">// åªè¯»æŸ¥è¯¢æ¨¡å‹ï¼ˆJOIN ä¸»è¦åœ¨è¿™ï¼‰</span>
â”œâ”€ statistics          <span class="hljs-comment">// ç»Ÿè®¡ / æŠ¥è¡¨</span>
â”œâ”€ infrastructure      <span class="hljs-comment">// åŸºç¡€è®¾æ–½ï¼ˆDao / Mapper / MQ / Cacheï¼‰</span>
â””â”€ common
</code></pre>
<h3 data-id="heading-23">2.2. Controller å±‚ï¼ˆå…¥å£ï¼‰</h3>
<pre><code class="hljs language-java" lang="java">controller
â”œâ”€ OrderController.java
â”œâ”€ UserController.java
â”œâ”€ StockController.java
â”œâ”€ OrderStockController.java     <span class="hljs-comment">// å¯¹åº” Facade</span>
â””â”€ StatisticsController.java
</code></pre>
<p><strong>è§„åˆ™</strong></p>
<ul>
<li>
<p>Controller åªä¾èµ–ï¼š</p>
<ul>
<li><code>domain.*.service</code></li>
<li><code>application.*</code></li>
</ul>
</li>
<li>
<p>âŒ ä¸å…è®¸å‡ºç° Dao / Query</p>
</li>
</ul>
<h3 data-id="heading-24">2.3. Application å±‚ï¼ˆFacade / Flow Serviceï¼‰</h3>
<blockquote>
<p><strong>æ‰€æœ‰â€œè·¨ä¸šåŠ¡ä¸»ä½“å†™â€çš„é€»è¾‘éƒ½åœ¨è¿™é‡Œ</strong></p>
</blockquote>
<pre><code class="hljs language-java" lang="java">application
â”œâ”€ orderstock
â”‚   â”œâ”€ OrderStockFacade.java
â”‚   â””â”€ OrderStockFacadeImpl.java
â””â”€ payment
    â”œâ”€ OrderPaymentFacade.java
    â””â”€ OrderPaymentFacadeImpl.java
</code></pre>
<p><strong>è§„åˆ™</strong></p>
<ul>
<li>
<p>åªåšï¼š</p>
<ul>
<li>è°ƒç”¨é¡ºåº</li>
<li>äº‹åŠ¡</li>
<li>å¤±è´¥å¤„ç†</li>
</ul>
</li>
<li>
<p>âŒ ä¸å†™ SQL</p>
</li>
<li>
<p>âŒ ä¸è®¿é—® Dao</p>
</li>
</ul>
<h3 data-id="heading-25">2.4. Domain å±‚ï¼ˆä¸šåŠ¡ä¸»ä½“ï¼Œæœ€æ ¸å¿ƒï¼‰</h3>
<h4 data-id="heading-26">2.4.1. Order é¢†åŸŸ</h4>
<pre><code class="hljs language-java" lang="java">domain/order
â”œâ”€ service
â”‚   â”œâ”€ OrderService.java
â”‚   â””â”€ OrderServiceImpl.java
â”œâ”€ model
â”‚   â”œâ”€ Order.java
â”‚   â””â”€ OrderStatus.java
â””â”€ event
    â””â”€ OrderCreatedEvent.java
</code></pre>
<p><strong>OrderService å¯ä»¥ï¼š</strong></p>
<ul>
<li>å†™ OrderDao</li>
<li>å†™ OrderLogDao</li>
<li>è¯» Query</li>
</ul>
<h4 data-id="heading-27">2.4.2. User é¢†åŸŸ</h4>
<pre><code class="hljs language-java" lang="java">domain/user
â”œâ”€ service
â”‚   â”œâ”€ UserService.java
â”‚   â””â”€ UserServiceImpl.java
â”œâ”€ model
â”‚   â””â”€ User.java
â””â”€ validator
    â””â”€ UserValidator.java
</code></pre>
<h4 data-id="heading-28">2.4.3. Stock é¢†åŸŸ</h4>
<pre><code class="hljs language-java" lang="java">domain/stock
â”œâ”€ service
â”‚   â”œâ”€ StockService.java
â”‚   â””â”€ StockServiceImpl.java
â”œâ”€ model
â”‚   â””â”€ Stock.java
â””â”€ policy
    â””â”€ StockDeductPolicy.java
</code></pre>
<h3 data-id="heading-29">2.5. Query å±‚ï¼ˆåªè¯»æ¨¡å‹ï¼ŒJOIN å…¨åœ¨è¿™é‡Œï¼‰</h3>
<blockquote>
<p><strong>è¿™æ˜¯æ¶æ„é‡Œæœ€å…³é”®çš„ä¸€å±‚</strong></p>
</blockquote>
<pre><code class="hljs language-java" lang="java">query
â”œâ”€ order
â”‚   â”œâ”€ OrderOnlyQuery.java
â”‚   â”œâ”€ OrderOnlyQueryImpl.java
â”‚   â””â”€ dto
â”‚       â””â”€ OrderView.java
â”œâ”€ orderlog
â”‚   â”œâ”€ OrderLogOnlyQuery.java
â”‚   â””â”€ OrderLogOnlyQueryImpl.java
â”œâ”€ user
â”‚   â”œâ”€ UserOnlyQuery.java
â”‚   â””â”€ UserOnlyQueryImpl.java
â””â”€ statistics
    â”œâ”€ OrderStatisticsQuery.java
    â””â”€ StatisticsView.java
</code></pre>
<p><strong>è§„åˆ™</strong></p>
<ul>
<li>âœ… å…è®¸ JOIN</li>
<li>âœ… å…è®¸è·¨ä¸»ä½“</li>
<li>âŒ ç¦æ­¢å†™æ“ä½œ</li>
<li>âŒ ç¦æ­¢ä¸šåŠ¡åˆ¤æ–­</li>
</ul>
<h3 data-id="heading-30">2.6. Statistics å±‚ï¼ˆæ¨ªå‘ç»Ÿè®¡ï¼‰</h3>
<pre><code class="hljs language-java" lang="java">statistics
â”œâ”€ StatisticsService.java
â””â”€ StatisticsServiceImpl.java
</code></pre>
<p><strong>ä¾èµ–æ–¹å‘</strong></p>
<pre><code class="hljs language-java" lang="java">StatisticsService
   â†“
Queryï¼ˆå¤šä¸ªï¼‰
</code></pre>
<p>âŒ ä¸å…è®¸ï¼š</p>
<ul>
<li>ç›´æ¥è®¿é—® Dao</li>
<li>è°ƒç”¨ Domain Service</li>
</ul>
<h3 data-id="heading-31">2.7. Infrastructure å±‚ï¼ˆDao / Mapperï¼‰</h3>
<pre><code class="hljs language-java" lang="java">infrastructure
â”œâ”€ dao
â”‚   â”œâ”€ order
â”‚   â”‚   â”œâ”€ OrderDao.java
â”‚   â”‚   â””â”€ OrderLogDao.java
â”‚   â”œâ”€ user
â”‚   â”‚   â””â”€ UserDao.java
â”‚   â””â”€ stock
â”‚       â””â”€ StockDao.java
â”œâ”€ mapper
â”‚   â””â”€ *.xml
â”œâ”€ cache
â”‚   â””â”€ RedisClient.java
â””â”€ mq
    â””â”€ MessageProducer.java
</code></pre>
<p><strong>è§„åˆ™</strong></p>
<ul>
<li>Dao = å•è¡¨</li>
<li>âŒ ä¸å†™ JOIN</li>
<li>âŒ ä¸å†™ä¸šåŠ¡é€»è¾‘</li>
</ul>
<h3 data-id="heading-32">2.8. Common å±‚ï¼ˆé€šç”¨èƒ½åŠ›ï¼‰</h3>
<pre><code class="hljs language-java" lang="java">common
â”œâ”€ exception
â”‚   â””â”€ BizException.java
â”œâ”€ util
â”‚   â””â”€ IdGenerator.java
â”œâ”€ constant
â”‚   â””â”€ ErrorCode.java
â””â”€ base
    â””â”€ BaseEntity.java
</code></pre>
<h3 data-id="heading-33">2.9. å¯ä»¥ç›´æ¥ç”¨çš„ã€ŒåŒ…çº§çº¦æŸå£è¯€ã€</h3>
<p>å¯ä»¥åœ¨å›¢é˜Ÿé‡Œè¿™æ ·è¦æ±‚ï¼š</p>
<blockquote>
<ul>
<li><code>domain</code> <strong>ä¸å‡†ä¾èµ–</strong> <code>application</code></li>
<li><code>query</code> <strong>ä¸å‡†ä¾èµ–</strong> <code>domain.service</code></li>
<li><code>controller</code> <strong>ä¸å‡†ä¾èµ–</strong> <code>dao</code></li>
<li><code>statistics</code> <strong>åªå‡†ä¾èµ–</strong> <code>query</code></li>
</ul>
</blockquote>
<h3 data-id="heading-34">2.10. Code Review ä¸€çœ¼åˆ¤æ–­æ³•ï¼ˆéå¸¸å¥½ç”¨ï¼‰</h3>
<p>çœ‹åˆ°ä¸€ä¸ªç±»ï¼Œåªçœ‹è·¯å¾„å°±èƒ½åˆ¤æ–­å¯¹ä¸å¯¹ï¼š</p>
<ul>
<li>ğŸ“‚ <code>domain/order/service/OrderService</code><br/>
â†’ <strong>åªèƒ½æœ‰è®¢å•é€»è¾‘</strong></li>
<li>ğŸ“‚ <code>query/order/OrderOnlyQuery</code><br/>
â†’ <strong>ä¸€å®šæ˜¯ JOIN + åªè¯»</strong></li>
<li>ğŸ“‚ <code>application/orderstock/OrderStockFacade</code><br/>
â†’ <strong>ä¸€å®šæ˜¯è·¨åŸŸæµç¨‹</strong></li>
<li>ğŸ“‚ <code>statistics/StatisticsService</code><br/>
â†’ <strong>ä¸€å®šä¸å†™ä¸šåŠ¡</strong></li>
</ul>
<p>è¿™å¥—åŒ…ç»“æ„ <strong>ä¸æ˜¯æœ€ç®€å•çš„</strong>ï¼Œä½†å®ƒæ˜¯<strong>å¤æ‚ä¸šåŠ¡ä¸‹æœ€ä¸å®¹æ˜“â€œå†™æ­ªâ€çš„ç»“æ„ä¹‹ä¸€</strong>ã€‚</p>
<h2 data-id="heading-35">3. å¤šæ¨¡å—é¡¹ç›®</h2>
<p>ç”¨ <strong>Gradleï¼ˆå°¤å…¶æ˜¯å¤šæ¨¡å—ï¼‰</strong> åšè¿™ä¸ªåˆ†å±‚éå¸¸é¡ºæ‰‹ã€‚ä¸‹é¢æ˜¯ä¸€å¥—<strong>å¯ç›´æ¥ç…§æŠ„ã€è·‘å¾—èµ·æ¥</strong>çš„æ¨¡æ¿ï¼š</p>
<ul>
<li><code>web</code>ã€<code>open</code> éƒ½èƒ½è®¿é—®æ•°æ®åº“</li>
<li>Entity / Mapper æ¥å£ / mapper.xml ç»Ÿä¸€å¤ç”¨</li>
<li><strong>ä¸æ”¾ common</strong>ï¼Œè€Œæ˜¯æ”¾åˆ° <code>persistence</code> æ¨¡å—ï¼ˆå…±äº«æ•°æ®è®¿é—®å±‚ï¼‰</li>
<li>Spring Boot + MyBatis</li>
</ul>
<h3 data-id="heading-36">3.1. æ¨èçš„ Gradle å¤šæ¨¡å—ç›®å½•ç»“æ„</h3>
<pre><code class="hljs language-java" lang="java">project-root
â”œâ”€ settings.gradle
â”œâ”€ build.gradle
â”œâ”€ common
â”‚  â””â”€ build.gradle
â”œâ”€ persistence
â”‚  â”œâ”€ build.gradle
â”‚  â””â”€ src/main
â”‚     â”œâ”€ java/com/xxx/persistence
â”‚     â”‚  â”œâ”€ entity
â”‚     â”‚  â”œâ”€ mapper
â”‚     â”‚  â””â”€ config
â”‚     â””â”€ resources
â”‚        â””â”€ mapper
â”‚           â”œâ”€ UserMapper.xml
â”‚           â””â”€ OrderMapper.xml
â”œâ”€ web
â”‚  â””â”€ build.gradle
â”œâ”€ open
â”‚  â””â”€ build.gradle
â””â”€ bootstrap
   â””â”€ build.gradle
</code></pre>
<blockquote>
<p><code>bootstrap</code> æ˜¯å¯åŠ¨æ¨¡å—ï¼ˆå¯é€‰ï¼Œä½†å¼ºçƒˆæ¨èï¼‰ï¼Œé¿å… web/open åŒæ—¶ä½œä¸ºå¯åŠ¨å…¥å£å¯¼è‡´é…ç½®ä¹±ã€‚</p>
</blockquote>
<h3 data-id="heading-37">3.2. settings.gradleï¼ˆå¿…é¡»ï¼‰</h3>
<pre><code class="hljs language-java" lang="java">rootProject.name = <span class="hljs-string">"demo-project"</span>

include(
        <span class="hljs-string">"common"</span>,
        <span class="hljs-string">"persistence"</span>,
        <span class="hljs-string">"web"</span>,
        <span class="hljs-string">"open"</span>,
        <span class="hljs-string">"bootstrap"</span>
)
</code></pre>
<h3 data-id="heading-38">3.3. æ ¹ build.gradleï¼ˆç»Ÿä¸€ç‰ˆæœ¬ã€æ’ä»¶ç®¡ç†ï¼‰</h3>
<pre><code class="hljs language-java" lang="java">plugins {
    id <span class="hljs-string">'org.springframework.boot'</span> version <span class="hljs-string">'3.2.3'</span> apply <span class="hljs-literal">false</span>
    id <span class="hljs-string">'io.spring.dependency-management'</span> version <span class="hljs-string">'1.1.4'</span> apply <span class="hljs-literal">false</span>
    id <span class="hljs-string">'java'</span> apply <span class="hljs-literal">false</span>
}

allprojects {
    group = <span class="hljs-string">'com.xxx'</span>
    version = <span class="hljs-string">'1.0.0'</span>
}

subprojects {
    apply plugin: <span class="hljs-string">'java'</span>
    java {
        toolchain {
            languageVersion = JavaLanguageVersion.of(<span class="hljs-number">17</span>)
        }
    }

    repositories {
        mavenCentral()
    }
}
</code></pre>
<h3 data-id="heading-39">3.4. common/build.gradleï¼ˆçº¯é€šç”¨ï¼Œæ— æ•°æ®åº“ä¾èµ–ï¼‰</h3>
<pre><code class="hljs language-java" lang="java">dependencies {
    <span class="hljs-comment">// æ”¾å·¥å…·ç±»ã€å¼‚å¸¸ã€è¿”å›ç»“æ„ç­‰</span>
    implementation <span class="hljs-string">"org.apache.commons:commons-lang3:3.14.0"</span>
}
</code></pre>
<p>common æ¨¡å—æ˜¯é€šç”¨æ¨¡å—ã€‚ä¸»è¦æ”¾ä¸€äº›å…¶å®ƒå„æ¨¡å—å…¬ç”¨çš„ä¸€äº›ä»£ç ï¼š</p>
<p>âœ… common ä¿æŒâ€œå¹²å‡€â€ï¼Œæ”¾ï¼š</p>
<ul>
<li><code>BaseResponse / PageRequest / PageResult</code></li>
<li><code>BizException / ErrorCode</code>ï¼ˆåŸºç¡€ç±»ï¼‰</li>
<li><code>å·¥å…·ç±» util</code></li>
<li><code>å…¬å…±æ³¨è§£</code></li>
<li><code>é€šç”¨æšä¸¾åŸºç±» BaseEnum</code></li>
<li><code>IDç”Ÿæˆå™¨</code></li>
<li><code>å¸¸é‡ GlobalConstants</code></li>
</ul>
<p>âŒ ä¸æ”¾ï¼š</p>
<ul>
<li><code>UserDO / OrderDO</code></li>
<li><code>UserMapper</code></li>
<li><code>mapper.xml</code></li>
<li><code>æ•°æ®åº“ä¾èµ–ä¸é…ç½®</code></li>
</ul>
<h3 data-id="heading-40">3.5. persistence/build.gradleï¼ˆå…±äº«æ•°æ®åº“è®¿é—®å±‚ï¼‰</h3>
<blockquote>
<p>è¿™é‡Œæ”¾ï¼šDO/Entityã€Mapperæ¥å£ã€mapper.xml<br/>
è®© web/open éƒ½ <code>implementation(project(":persistence"))</code>ã€‚</p>
</blockquote>
<pre><code class="hljs language-java" lang="java">plugins {
    id <span class="hljs-string">'io.spring.dependency-management'</span>
}

dependencies {
    implementation <span class="hljs-title function_">project</span><span class="hljs-params">(<span class="hljs-string">":common"</span>)</span>

    <span class="hljs-comment">// MyBatis Spring Boot Starter</span>
    implementation <span class="hljs-string">"org.mybatis.spring.boot:mybatis-spring-boot-starter:3.0.3"</span>

    <span class="hljs-comment">// æ•°æ®åº“é©±åŠ¨ï¼ˆä½ ç”¨ä»€ä¹ˆæ¢ä»€ä¹ˆï¼Œè¿™é‡Œä»¥ MySQL ä¸ºä¾‹ï¼‰</span>
    runtimeOnly <span class="hljs-string">"com.mysql:mysql-connector-j:8.3.0"</span>

    <span class="hljs-comment">// å¯é€‰ï¼šLombok</span>
    compileOnly <span class="hljs-string">"org.projectlombok:lombok:1.18.30"</span>
    annotationProcessor <span class="hljs-string">"org.projectlombok:lombok:1.18.30"</span>
}

tasks.withType(Test).configureEach {
    useJUnitPlatform()
}
</code></pre>
<h4 data-id="heading-41">3.5.1. persistence æ¨¡å—é‡Œ MyBatis æ‰«æä¸ XML è·¯å¾„ï¼ˆéå¸¸å…³é”®ï¼‰</h4>
<p>mapper.xml æ”¾çš„ä½ç½®ï¼ˆæ¨èï¼‰</p>
<pre><code class="hljs language-java" lang="java">persistence/src/main/resources/mapper<span class="hljs-comment">/*.xml
</span></code></pre>
<p>persistence/config/MybatisConfig.javaï¼ˆå¯é€‰ï¼Œä½†å»ºè®®ï¼‰</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.xxx.persistence.config;

<span class="hljs-keyword">import</span> org.mybatis.spring.annotation.MapperScan;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;

<span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@MapperScan("com.xxx.persistence.mapper")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MybatisConfig</span> {
}
</code></pre>
<blockquote>
<p>è¿™æ ·å°±ä¸æ€•æ‰«æä¸åˆ° Mapperã€‚<br/>
<code>web/open/bootstrap</code> å¼•å…¥ persistence åä¼šè‡ªåŠ¨ç”Ÿæ•ˆã€‚</p>
</blockquote>
<h4 data-id="heading-42">3.5.2. persistence æ¨¡å—</h4>
<p>persistence æ˜¯æŒä¹…å±‚æ¨¡å—ã€‚persistence æ¨¡å—å†…å®¹å»ºè®®ï¼š</p>
<pre><code class="hljs language-java" lang="java">persistence
â”œâ”€ entity                 <span class="hljs-comment">// DB å®ä½“ï¼ˆDO / POï¼‰</span>
â”‚  â”œâ”€ UserDO.java
â”‚  â””â”€ OrderDO.java
â”œâ”€ mapper                 <span class="hljs-comment">// MyBatis Mapper æ¥å£ï¼ˆDaoï¼‰</span>
â”‚  â”œâ”€ UserMapper.java
â”‚  â””â”€ OrderMapper.java
â”œâ”€ xml                    <span class="hljs-comment">// mapper.xmlï¼ˆæˆ– resources/mapperï¼‰</span>
â”‚  â”œâ”€ UserMapper.xml
â”‚  â””â”€ OrderMapper.xml
â””â”€ config                 <span class="hljs-comment">// MyBatis é…ç½® / æ‰«æé…ç½®ï¼ˆå¯é€‰ï¼‰</span>
</code></pre>
<p>æ³¨æ„ï¼šè¿™é‡Œçš„å®ä½“æœ€å¥½å« DO/POï¼Œä¸è¦å« Domain Entityï¼ˆé¿å…æŠŠé¢†åŸŸæ¨¡å‹å’Œè¡¨å¼ºç»‘å®šï¼‰ã€‚</p>
<p><strong>Entity / Dao / XML ç»Ÿä¸€æ”¾åˆ° <code>persistence</code> æ¨¡å—ï¼š</strong></p>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">persistence/src/main/java/com/xxx/persistence/entity/UserDO.java
persistence/src/main/java/com/xxx/persistence/mapper/UserMapper.java
persistence/src/main/resources/mapper/UserMapper.xml
</code></pre>
<p>web/open ç›´æ¥æ³¨å…¥ Mapper ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> UserMapper userMapper;
</code></pre>
<p><strong>å¯èƒ½ä¼šæ‹…å¿ƒçš„é—®é¢˜ï¼šweb/open åŒæ—¶è®¿é—® DBï¼Œä¼šä¸ä¼šä¹±ï¼Ÿ</strong></p>
<p>ä¸ä¼šï¼Œåªè¦ä½ éµå®ˆï¼š</p>
<p>âœ… DB ç›¸å…³ä¸œè¥¿åªåœ¨ <code>persistence</code><br/>
âœ… å¯åŠ¨é…ç½®ç»Ÿä¸€æ”¾ <code>bootstrap</code><br/>
âœ… web/open ä¸é‡å¤é…ç½®æ•°æ®æº</p>
<h3 data-id="heading-43">3.6. web/build.gradleï¼ˆä¾èµ– persistenceï¼‰</h3>
<blockquote>
<p>è¿™é‡Œå»ºè®® web ä¸ç›´æ¥å¼•æ•°æ®åº“é©±åŠ¨ã€mybatis ä¾èµ–ï¼Œéƒ½ä» persistence æ¥ã€‚</p>
</blockquote>
<pre><code class="hljs language-java" lang="java">plugins {
    id <span class="hljs-string">'org.springframework.boot'</span>
    id <span class="hljs-string">'io.spring.dependency-management'</span>
}

dependencies {
    implementation <span class="hljs-title function_">project</span><span class="hljs-params">(<span class="hljs-string">":common"</span>)</span>
    implementation <span class="hljs-title function_">project</span><span class="hljs-params">(<span class="hljs-string">":persistence"</span>)</span>

    implementation <span class="hljs-string">"org.springframework.boot:spring-boot-starter-web"</span>
    implementation <span class="hljs-string">"org.springframework.boot:spring-boot-starter-validation"</span>
}
</code></pre>
<h3 data-id="heading-44">3.7. open/build.gradleï¼ˆä¾èµ– persistenceï¼‰</h3>
<pre><code class="hljs language-java" lang="java">plugins {
    id <span class="hljs-string">'org.springframework.boot'</span>
    id <span class="hljs-string">'io.spring.dependency-management'</span>
}

dependencies {
    implementation <span class="hljs-title function_">project</span><span class="hljs-params">(<span class="hljs-string">":common"</span>)</span>
    implementation <span class="hljs-title function_">project</span><span class="hljs-params">(<span class="hljs-string">":persistence"</span>)</span>

    implementation <span class="hljs-string">"org.springframework.boot:spring-boot-starter-web"</span>
}
</code></pre>
<h3 data-id="heading-45">3.8. bootstrap æ¨¡å—çš„å¯åŠ¨ç±»ï¼ˆSpring Boot mainï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.xxx.bootstrap;

<span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;
<span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;

<span class="hljs-meta">@SpringBootApplication(scanBasePackages = "com.xxx")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Application</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        SpringApplication.run(Application.class, args);
    }
}
</code></pre>
<blockquote>
<p><code>scanBasePackages="com.xxx"</code> ç¡®ä¿æ‰«æåˆ° persistence/web/open çš„ beanã€‚</p>
</blockquote>
<h4 data-id="heading-46">3.8.1. bootstrap/build.gradleï¼ˆæ¨èï¼šå”¯ä¸€å¯åŠ¨æ¨¡å—ï¼‰</h4>
<blockquote>
<p>è®© bootstrap ä½œä¸ºå”¯ä¸€å…¥å£ï¼Œweb/open åªæ˜¯åŠŸèƒ½æ¨¡å—ã€‚</p>
</blockquote>
<pre><code class="hljs language-java" lang="java">plugins {
    id <span class="hljs-string">'org.springframework.boot'</span>
    id <span class="hljs-string">'io.spring.dependency-management'</span>
}

dependencies {
    implementation <span class="hljs-title function_">project</span><span class="hljs-params">(<span class="hljs-string">":common"</span>)</span>
    implementation <span class="hljs-title function_">project</span><span class="hljs-params">(<span class="hljs-string">":persistence"</span>)</span>
    implementation <span class="hljs-title function_">project</span><span class="hljs-params">(<span class="hljs-string">":web"</span>)</span>
    implementation <span class="hljs-title function_">project</span><span class="hljs-params">(<span class="hljs-string">":open"</span>)</span>

    implementation <span class="hljs-string">"org.springframework.boot:spring-boot-starter"</span>
}
</code></pre>
<h4 data-id="heading-47">3.8.2. application.ymlï¼ˆæ”¾ bootstrap æ¨¡å—ï¼‰</h4>
<p><code>bootstrap/src/main/resources/application.yml</code></p>
<pre><code class="hljs language-java" lang="java">spring:
  datasource:
    url: jdbc:mysql:<span class="hljs-comment">//localhost:3306/demo?useSSL=false&amp;serverTimezone=UTC</span>
    username: root
    password: root

mybatis:
  mapper-locations: classpath*:mapper<span class="hljs-comment">/*.xml
  type-aliases-package: com.xxx.persistence.entity
</span></code></pre>
<blockquote>
<p>âœ… <code>classpath*:</code> éå¸¸é‡è¦ï¼Œä¿è¯å¤šæ¨¡å— resources èƒ½è¢«æ‰¾åˆ°<br/>
âœ… mapper-locations åŒ¹é… persistence/resources/mapper</p>
</blockquote>
<h4 data-id="heading-48">3.8.3. å¦‚æœä¸è®¾ bootstrap</h4>
<p>å¦‚æœä¸è®¾ bootstrapï¼Œè€Œæ˜¯ <code>web</code>ã€<code>open</code> å„è‡ªå¯åŠ¨ï¼š</p>
<ul>
<li>web/open éƒ½è¦æœ‰è‡ªå·±çš„å¯åŠ¨ç±» <code>@SpringBootApplication(scanBasePackages="com.xxx")</code></li>
<li>application.yml æ”¾å„è‡ªæ¨¡å—é‡Œ</li>
</ul>
<p>ç¼ºç‚¹ï¼šé…ç½®å®¹æ˜“é‡å¤ï¼›ä¼˜ç‚¹ï¼šæ¨¡å—ç‹¬ç«‹è¿è¡Œã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•ç”¨ Dart å†™ä¸ªè‡ªå·±çš„MCPæœåŠ¡]]></title>    <link>https://juejin.cn/post/7591350620189114374</link>    <guid>https://juejin.cn/post/7591350620189114374</guid>    <pubDate>2026-01-04T22:57:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591350620189114374" data-draft-id="7591510742634414143" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•ç”¨ Dart å†™ä¸ªè‡ªå·±çš„MCPæœåŠ¡"/> <meta itemprop="keywords" content="Flutter,MCP,Dart"/> <meta itemprop="datePublished" content="2026-01-04T22:57:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¼ é£æ·ç‰¹çƒˆ"/> <meta itemprop="url" content="https://juejin.cn/user/149189281194766"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•ç”¨ Dart å†™ä¸ªè‡ªå·±çš„MCPæœåŠ¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/149189281194766/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¼ é£æ·ç‰¹çƒˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T22:57:32.000Z" title="Sun Jan 04 2026 22:57:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7f51c2cf7f444182b09071101b2b9241~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1024&amp;h=559&amp;s=404732&amp;e=png&amp;b=042359" alt="" loading="lazy"/></p>
<blockquote>
<p>çº¸ä¸Šå­¦æ¥ç»ˆè§‰æµ…ï¼Œç»çŸ¥æ­¤äº‹è¦èº¬è¡Œ</p>
</blockquote>
<p>äº†è§£äº‹ç‰©æœ€å¥½çš„æ–¹å¼ï¼Œå°±æ˜¯è‡ªå·±å»åšäº›ä»€ä¹ˆã€‚ä½œä¸ºä¸€å Flutter å¼€å‘å·¥ç¨‹å¸ˆï¼Œå½“æˆ‘ä»¬è°ˆè®º MCPï¼ˆModel Context Protocolï¼‰æ—¶ï¼Œä¸å¦¨ä»ä¸€ä¸ªç®€å•çš„æ—¶é—´æœåŠ¡å¼€å§‹ï¼Œçœ‹çœ‹è¿™ä¸ªåè®®å¦‚ä½•åœ¨å®é™…å¼€å‘ä¸­å‘æŒ¥ä½œç”¨ã€‚</p>
<p>åœ¨ AI å¿«é€Ÿå‘å±•çš„ä»Šå¤©ï¼Œæˆ‘ä»¬è§è¯äº†æ— æ•°å·¥å…·çš„è¯ç”Ÿï¼Œä½†å®ƒä»¬ä¹‹é—´çš„åä½œå¾€å¾€å……æ»¡æ‘©æ“¦ã€‚æ¯ä¸ªå·¥å…·éƒ½æœ‰è‡ªå·±çš„æ¥å£è§„èŒƒï¼ŒAI éœ€è¦ä¸ºæ¯ä¸ªå·¥å…·å­¦ä¹ ä¸åŒçš„"è¯­è¨€"ã€‚è¿™ç§ç¢ç‰‡åŒ–çš„ç°çŠ¶ï¼Œæ­£æ˜¯ MCP è¦è§£å†³çš„æ ¸å¿ƒé—®é¢˜ã€‚</p>
<hr/>
<h4 data-id="heading-0">1.ç›´è§‚ä½“éªŒ MCP æ˜¯ä½œç”¨</h4>
<p>MCPï¼ˆModel Context Protocolï¼‰æœ¬è´¨ä¸Šæ˜¯ä¸€ç§<strong>æ ‡å‡†åŒ–çš„é€šä¿¡åè®®</strong>ï¼Œå®ƒå®šä¹‰äº† AI æ¨¡å‹ä¸å¤–éƒ¨å·¥å…·ä¹‹é—´çš„äº¤äº’æ–¹å¼ã€‚å°±åƒ HTTP åè®®è§„èŒƒäº†æµè§ˆå™¨ä¸æœåŠ¡å™¨çš„é€šä¿¡ä¸€æ ·ï¼ŒMCP è§„èŒƒäº† AI ä¸å„ç§æœåŠ¡çš„å¯¹è¯è§„åˆ™ã€‚è¿™é‡Œå°±ä¸è¯´å¤šè¯´é‚£äº›åºŸè¯çš„å¤§é“ç†ï¼Œç›´æ¥ä»å®é™…åœºæ™¯ï¼Œä»‹ç» MCP çš„ä»·å€¼ã€‚<br/>
æ¯”å¦‚è¯´ï¼Œå¦‚æœæ²¡æœ‰ MCP æ—¶ï¼Œè®© AI å¤„ç†è¿™ä¸ªå†…å®¹ï¼š</p>
<blockquote>
<p>å¸®æˆ‘æŸ¥çœ‹ä¸€ä¸‹è¿™ç¯‡æ–‡ç« çš„å†…å®¹ <a href="https://juejin.cn/post/7588004601392529442" target="_blank" title="https://juejin.cn/post/7588004601392529442">juejin.cn/post/758800â€¦</a></p>
</blockquote>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/73294ab11ee940758c5222af517161b4~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1160&amp;h=488&amp;s=113293&amp;e=png&amp;b=272727" alt="" loading="lazy"/></p>
<p>å°±ä¼šå¾—åˆ° <code>æˆ‘æ— æ³•ç›´æ¥è®¿é—®å¤–éƒ¨ç½‘ç«™é“¾æ¥æ¥æŸ¥çœ‹æ–‡ç« å†…å®¹</code>, æ˜æ˜å®ƒæœ‰ä¸ªå¾ˆå¼ºçš„è„‘å­ï¼Œä½†æ˜¯å°±åƒæ˜¯æ²¡æœ‰çœ¼ç›ä¸€æ ·ï¼Œçœ‹ä¸åˆ°ç½‘é¡µé‡Œçš„ä¸œè¥¿ï¼Œå²‚ä¸å¯æƒœã€‚</p>
<hr/>
<p>å¦‚æœå·¥å…·ä¸€æ—¦æ¥å…¥ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.browsermcp.io%2Fsetup-server" target="_blank" title="https://docs.browsermcp.io/setup-server" ref="nofollow noopener noreferrer">browsermcp</a> çš„ MCP æœåŠ¡, å®ƒå°±èƒ½ <strong>çœ‹è§</strong> ç½‘é¡µã€‚åŒç†ï¼Œå†…ç½®çš„æ–‡ä»¶è®¿é—®ã€æœç´¢ç­‰å·¥å…·ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œè¿™æ ·å·¥å…·ä»¬å°±å¯ä»¥è°ƒåº¦å¤§è„‘ï¼Œæ€è€ƒç½‘ç«™ã€å†™å…¥æ–‡ä»¶ï¼Œè®©æ•´ä¸ªæµç¨‹ç•…é€šèµ·æ¥ã€‚</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ef21343822f44212926a19ba8d5e2b40~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1177&amp;h=728&amp;s=135073&amp;e=png&amp;b=272727" alt="" loading="lazy"/></p>
<blockquote>
<p>å¦‚æœè¯´ AI æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å¤§è„‘ï¼Œé‚£ä¹ˆ MCP å°±æ˜¯çœ¼ç›ã€æ‰‹ã€è„šã€‚è®© AI èƒ½çœ‹ã€èƒ½åšã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-1">2.ä»æ—¶é—´æœåŠ¡çœ‹åè®®æœ¬è´¨</h4>
<p>ç†è§£ MCP æœ€å¥½çš„æ–¹å¼ï¼Œå°±æ˜¯åŠ¨æ‰‹å†™ä¸€ä¸ªæœåŠ¡ã€‚æˆ‘ä»¬ä»æœ€ç®€å•çš„æ—¶é—´æœåŠ¡å¼€å§‹ï¼Œçœ‹çœ‹è¿™ä¸ªåè®®å¦‚ä½•å·¥ä½œã€‚
å¦‚æœä»€ä¹ˆéƒ½æ²¡æœ‰çš„æ—¶å€™ï¼Œé—® AI <code>ç°åœ¨ä»€ä¹ˆæ—¶å€™</code>, ä½ å°†å¾—åˆ°ä¸€ä¸ªå®ƒè‡ªè®¤ä¸ºçš„é”™è¯¯æ—¶é—´ï¼š</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dda07d1dece04d6d93203629b8d3cb88~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=750&amp;h=188&amp;s=14864&amp;e=png&amp;b=272727" alt="" loading="lazy"/></p>
<p>æˆ‘ä»¬æœ¬æ–‡è¦åšçš„ï¼Œæ˜¯åŸºäº Dart è¯­è¨€ï¼Œæ­å»ºä¸€ä¸ªå¯ä»¥ç†è§£å½“å‰æ—¶é—´çš„ MCP æœåŠ¡ï¼Œè®© AI å¯ä»¥åœ¨éœ€è¦æ—¶ï¼Œè°ƒç”¨ Dart çš„æœåŠ¡ï¼Œå¾—åˆ°æœ¬æœºçš„ç²¾ç¡®æ—¶é—´ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/265f445bc3a1490f9d7ac07ee247627f~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=767&amp;h=321&amp;s=27724&amp;e=png&amp;b=262626" alt="" loading="lazy"/></p>
<p>é¡¹ç›®ç»“æ„å¾ˆç®€å•ï¼š</p>
<pre><code class="hljs language-python" lang="python">now/
â”œâ”€â”€ <span class="hljs-built_in">bin</span>/
â”‚   â””â”€â”€ server.dart          <span class="hljs-comment"># ä¸»æœåŠ¡å™¨æ–‡ä»¶</span>
â”œâ”€â”€ pubspec.yaml             <span class="hljs-comment"># Dart é¡¹ç›®é…ç½®</span>
â”œâ”€â”€ mcp-config.json          <span class="hljs-comment"># MCP æœåŠ¡é…ç½®</span>
â””â”€â”€ README.md               <span class="hljs-comment"># é¡¹ç›®è¯´æ˜</span>
</code></pre>
<hr/>
<h4 data-id="heading-2">3.åè®®çš„ä¸‰ä¸ªæ ¸å¿ƒé˜¶æ®µ</h4>
<p>MCP æœåŠ¡æœ‰æ˜ç¡®çš„ç”Ÿå‘½å‘¨æœŸï¼Œæ¯ä¸ªé˜¶æ®µéƒ½æœ‰ç‰¹å®šçš„èŒè´£ã€‚</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3f375f74254e4992a614d2278c26d795~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1200&amp;h=722&amp;s=50467&amp;e=png&amp;b=fff9f9" alt="" loading="lazy"/></p>
<p><strong>åˆå§‹åŒ–é˜¶æ®µ</strong> - åè®®æ¡æ‰‹</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">case</span> <span class="hljs-string">'initialize'</span>:
  <span class="hljs-keyword">return</span> {
    <span class="hljs-string">'jsonrpc'</span>: <span class="hljs-string">'2.0'</span>,
    <span class="hljs-string">'result'</span>: {
      <span class="hljs-string">'protocolVersion'</span>: <span class="hljs-string">'2024-11-05'</span>,
      <span class="hljs-string">'capabilities'</span>: {
        <span class="hljs-string">'tools'</span>: {}  <span class="hljs-comment">// å£°æ˜æ”¯æŒå·¥å…·è°ƒç”¨</span>
      },
      <span class="hljs-string">'serverInfo'</span>: {
        <span class="hljs-string">'name'</span>: <span class="hljs-string">'now-server'</span>,
        <span class="hljs-string">'version'</span>: <span class="hljs-string">'1.0.0'</span>
      }
    },
    <span class="hljs-string">'id'</span>: id
  };
</code></pre>
<p>è¿™ä¸ªé˜¶æ®µç¡®ä¿å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä½¿ç”¨å…¼å®¹çš„åè®®ç‰ˆæœ¬ï¼Œå°±åƒä¸¤ä¸ªäººè§é¢å…ˆç¡®è®¤è¯´çš„æ˜¯åŒä¸€ç§è¯­è¨€ã€‚</p>
<p><strong>å·¥å…·å‘ç°é˜¶æ®µ</strong> - èƒ½åŠ›å£°æ˜</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">case</span> <span class="hljs-string">'tools/list'</span>:
  <span class="hljs-keyword">return</span> {
    <span class="hljs-string">'jsonrpc'</span>: <span class="hljs-string">'2.0'</span>,
    <span class="hljs-string">'result'</span>: {
      <span class="hljs-string">'tools'</span>: [
        {
          <span class="hljs-string">'name'</span>: <span class="hljs-string">'get_current_time'</span>,
          <span class="hljs-string">'description'</span>: <span class="hljs-string">'Get the current date and time'</span>,
          <span class="hljs-string">'inputSchema'</span>: {
            <span class="hljs-string">'type'</span>: <span class="hljs-string">'object'</span>,
            <span class="hljs-string">'properties'</span>: {
              <span class="hljs-string">'format'</span>: {
                <span class="hljs-string">'type'</span>: <span class="hljs-string">'string'</span>,
                <span class="hljs-string">'description'</span>: <span class="hljs-string">'Time format (iso, local, utc)'</span>,
                <span class="hljs-string">'default'</span>: <span class="hljs-string">'iso'</span>
              }
            },
            <span class="hljs-string">'additionalProperties'</span>: <span class="hljs-keyword">false</span>
          }
        }
      ]
    },
    <span class="hljs-string">'id'</span>: id
  };
</code></pre>
<p>è¿™é‡Œç”¨ JSON Schema æè¿°å·¥å…·çš„æ¥å£ã€‚AI é€šè¿‡è¿™ä¸ªæè¿°å°±çŸ¥é“å¦‚ä½•è°ƒç”¨å·¥å…·ï¼Œä¸éœ€è¦é¢å¤–çš„æ–‡æ¡£è¯´æ˜ã€‚</p>
<p><strong>å·¥å…·æ‰§è¡Œé˜¶æ®µ</strong> - å®é™…å·¥ä½œ</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">case</span> <span class="hljs-string">'tools/call'</span>:
  <span class="hljs-keyword">final</span> toolName = params[<span class="hljs-string">'name'</span>] <span class="hljs-keyword">as</span> <span class="hljs-built_in">String?</span>;
  <span class="hljs-keyword">final</span> arguments = params[<span class="hljs-string">'arguments'</span>] <span class="hljs-keyword">as</span> <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">dynamic</span>&gt;? ?? {};

  <span class="hljs-keyword">if</span> (toolName == <span class="hljs-string">'get_current_time'</span>) {
    <span class="hljs-keyword">return</span> handleGetCurrentTime(arguments, id);
  }

  <span class="hljs-keyword">return</span> {
    <span class="hljs-string">'jsonrpc'</span>: <span class="hljs-string">'2.0'</span>,
    <span class="hljs-string">'error'</span>: {
      <span class="hljs-string">'code'</span>: <span class="hljs-number">-32601</span>,
      <span class="hljs-string">'message'</span>: <span class="hljs-string">'Tool not found: <span class="hljs-subst">$toolName</span>'</span>
    },
    <span class="hljs-string">'id'</span>: id
  };
</code></pre>
<hr/>
<h4 data-id="heading-3">4.é€šä¿¡æœºåˆ¶çš„æ ¸å¿ƒ</h4>
<p>MCP å»ºç«‹åœ¨ JSON-RPC 2.0 ä¹‹ä¸Šï¼ŒåŸºäº stdio é€šä¿¡ã€‚æœåŠ¡å™¨ç›‘å¬ stdinï¼Œé€šè¿‡ stdout å“åº”ï¼š</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/70772526f1d642ea9493726e7a13244a~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1249&amp;h=265&amp;s=27398&amp;e=png&amp;b=fefdfd" alt="" loading="lazy"/></p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">void</span> main() {
  stdin
      .transform(utf8.decoder)
      .transform(LineSplitter())
      .listen((line) {
    <span class="hljs-keyword">if</span> (line.trim().isEmpty) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">final</span> request = jsonDecode(line);
      <span class="hljs-keyword">final</span> response = handleRequest(request);
      <span class="hljs-keyword">if</span> (response != <span class="hljs-keyword">null</span>) {
        stdout.writeln(jsonEncode(response));
        stdout.flush();
      }
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-keyword">final</span> errorResponse = {
        <span class="hljs-string">'jsonrpc'</span>: <span class="hljs-string">'2.0'</span>,
        <span class="hljs-string">'error'</span>: {
          <span class="hljs-string">'code'</span>: <span class="hljs-number">-32700</span>,
          <span class="hljs-string">'message'</span>: <span class="hljs-string">'Parse error'</span>
        },
        <span class="hljs-string">'id'</span>: <span class="hljs-keyword">null</span>
      };
      stdout.writeln(jsonEncode(errorResponse));
      stdout.flush();
    }
  });
}
</code></pre>
<p>è¿™ç§æ–¹å¼è·¨å¹³å°å…¼å®¹æ€§å¥½ï¼Œè¿›ç¨‹éš”ç¦»å¤©ç„¶å®‰å…¨ï¼Œè°ƒè¯•å’Œæµ‹è¯•å®¹æ˜“ã€‚å¯ä»¥ç›´æ¥è¿è¡Œ dart é¡¹ç›®ï¼Œè¾“å…¥ <code> {"jsonrpc":"2.0","id":1,"method":"initialize"}</code> æ¥æµ‹è¯•æœåŠ¡æ˜¯å¦æ­£å¸¸å“åº”ï¼š</p>
<blockquote>
<p>å‘½ä»¤è¡Œ: dart .\bin\server.dart<br/>
è¾“å…¥:  {"jsonrpc":"2.0","id":1,"method":"initialize"}<br/>
è¾“å‡º: {"jsonrpc":"2.0","result":{"protocolVersion":"2024-11-05","capabilities":{"tools":{}},"serverInfo":{"name":"now-server","version":"1.0.0"}},"id":1}</p>
</blockquote>
<hr/>
<h4 data-id="heading-4">5.åè®®è®¾è®¡çš„æ™ºæ…§</h4>
<p>MCP çš„è®¾è®¡ä½“ç°äº†å‡ ä¸ªé‡è¦çš„è½¯ä»¶å·¥ç¨‹åŸåˆ™ï¼š</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/be9435ed8314445686c8b366aa429fcb~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1208&amp;h=652&amp;s=72603&amp;e=png&amp;b=ffffff" alt="" loading="lazy"/></p>
<p><strong>çº¦å®šä¼˜äºé…ç½®</strong> - ç»Ÿä¸€çš„åè®®å‡å°‘äº†é›†æˆçš„å¤æ‚æ€§<br/>
<strong>æœ€å°æƒŠè®¶åŸåˆ™</strong> - åè®®çš„æ¯ä¸ªéƒ¨åˆ†éƒ½éµå¾ªç›´è§‰ï¼Œæ²¡æœ‰æ„å¤–çš„è¡Œä¸º<br/>
<strong>å…³æ³¨ç‚¹åˆ†ç¦»</strong> - åè®®å±‚é¢åªå…³å¿ƒé€šä¿¡æ ¼å¼ï¼Œä¸šåŠ¡é€»è¾‘ç”±å·¥å…·å®ç°è€…å†³å®š</p>
<p>è¿™ç§æ ‡å‡†åŒ–çš„åŠ›é‡ï¼Œå°±åƒå»ºç­‘è¡Œä¸šçš„æ ‡å‡†åŒ–èºä¸ã€‚çœ‹èµ·æ¥ç®€å•ï¼Œä½†å´è®©æ•´ä¸ªè¡Œä¸šçš„åä½œå˜å¾—é«˜æ•ˆã€‚ä¸€ä¸ª MCP æœåŠ¡ä¸æ˜¯å­¤ç«‹çš„å­˜åœ¨ã€‚AI å¯ä»¥åè°ƒä½¿ç”¨ MCP å·¥å…·ï¼Œè”åˆå¤„ç†ä»»åŠ¡, æ¯”å¦‚:</p>
<blockquote>
<p>å°†å½“å‰æ—¶é—´å†™åˆ°æ–‡ç« å¼€å¤´</p>
</blockquote>
<p>æ­¤æ—¶ AI å¤§è„‘å°±å¯ä»¥è°ƒåº¦è·å–å½“å‰æ—¶é—´çš„ MCPï¼Œç„¶åè°ƒåº¦å†™å…¥æ–‡ä»¶çš„èƒ½åŠ›ï¼Œå®Œæˆå®é™…çš„åŠŸèƒ½ã€‚è®©ä¸€ä¸ªæ–‡ç« å¯ä»¥è‡ªåŠ¨å¡«å…¥å½“å‰æ—¶é—´ï¼š</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b105b3561bb940ae8f20c9c2da0d51df~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1988&amp;h=797&amp;s=304535&amp;e=png&amp;b=252525" alt="" loading="lazy"/></p>
<hr/>
<h4 data-id="heading-5">ç»“è¯­</h4>
<p>MCP ä¸ä»…ä»…æ˜¯ä¸€ä¸ªæŠ€æœ¯åè®®ï¼Œå®ƒä»£è¡¨äº† AI æ—¶ä»£å·¥å…·é›†æˆçš„æ–°æ€è·¯ã€‚é€šè¿‡æ ‡å‡†åŒ–çš„æ¥å£ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ„å»ºæ›´åŠ å¼€æ”¾ã€å¯æ‰©å±•çš„ AI ç”Ÿæ€ç³»ç»Ÿã€‚</p>
<p>å¯¹äº Flutter å¼€å‘è€…è€Œè¨€ï¼ŒæŒæ¡ MCP æ„å‘³ç€èƒ½å¤Ÿä¸º AI æä¾›ç§»åŠ¨ç«¯çš„å„ç§èƒ½åŠ›ï¼Œä»è®¾å¤‡ä¿¡æ¯è·å–åˆ°æœ¬åœ°æ•°æ®å¤„ç†ï¼Œéƒ½å¯ä»¥é€šè¿‡è¿™ç§æ ‡å‡†åŒ–çš„æ–¹å¼æš´éœ²ç»™ AI ä½¿ç”¨ã€‚</p>
<p>ä»è¿™ä¸ªç®€å•çš„æ—¶é—´æœåŠ¡å¼€å§‹ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†åè®®è®¾è®¡çš„æ™ºæ…§ã€å®ç°çš„ç»†èŠ‚ã€æ‰©å±•çš„å¯èƒ½æ€§ã€‚è¿™ç§ä»ç®€å•åˆ°å¤æ‚ã€ä»å…·ä½“åˆ°æŠ½è±¡çš„å­¦ä¹ è·¯å¾„ï¼Œæ­£æ˜¯æŠ€æœ¯æˆé•¿çš„æœ€ä½³æ–¹å¼ã€‚</p>
<p>æŠ€æœ¯çš„æœ¬è´¨ä¸åœ¨äºå¤æ‚æ€§ï¼Œè€Œåœ¨äºè§£å†³é—®é¢˜çš„ä¼˜é›…ç¨‹åº¦ã€‚MCP ç”¨ç®€æ´çš„åè®®è§£å†³äº†å¤æ‚çš„é›†æˆé—®é¢˜ï¼Œè¿™å°±æ˜¯æŠ€æœ¯çš„é­…åŠ›ï¼šç®€å•çš„åè®®ï¼Œæ— é™çš„å¯èƒ½ã€‚</p>
<p>å½“æˆ‘ä»¬ç«™åœ¨ AI æ—¶ä»£çš„é—¨æ§›ä¸Šï¼ŒæŒæ¡ MCP è¿™æ ·çš„åŸºç¡€åè®®ï¼Œå°±åƒæŒæ¡äº†ä¸€æŠŠé’¥åŒ™ï¼Œèƒ½å¤Ÿæ‰“å¼€é€šå¾€æœªæ¥çš„å¤§é—¨ã€‚</p>
<hr/>
<p>æ›´å¤šæ–‡ç« å’Œè§†é¢‘çŸ¥è¯†èµ„è®¯ï¼Œå¤§å®¶å¯ä»¥å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€æ˜é‡‘å’Œ B ç«™ ã€‚è®©æˆ‘ä»¬ä¸€èµ·æˆé•¿ï¼Œå˜å¾—æ›´å¼ºã€‚æˆ‘ä»¬ä¸‹æ¬¡å†è§~</p>
<ul>
<li>QQäº¤æµç¾¤ï¼š 1046304516</li>
<li>æ˜é‡‘è´¦å·ï¼šÂ <a href="https://juejin.cn/user/149189281194766" title="https://juejin.cn/user/149189281194766" target="_blank">å¼ é£æ·ç‰¹çƒˆ</a></li>
<li>bilibli è´¦å·ï¼šÂ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fspace.bilibili.com%2F390457600" title="https://link.juejin.cn/?target=https%3A%2F%2Fspace.bilibili.com%2F390457600" target="_blank">å¼ é£æ·ç‰¹çƒˆ</a></li>
<li>å…¬ä¼—å·ï¼šÂ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fq8Vs5i3SU-4QPoU3-0xOSg" title="https://link.juejin.cn/?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fq8Vs5i3SU-4QPoU3-0xOSg" target="_blank">ç¼–ç¨‹ä¹‹ç‹</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£ System.Lazy<T>ï¼šC#.NET å»¶è¿Ÿåˆå§‹åŒ–ä¸çº¿ç¨‹å®‰å…¨]]></title>    <link>https://juejin.cn/post/7591156262626607139</link>    <guid>https://juejin.cn/post/7591156262626607139</guid>    <pubDate>2026-01-04T23:39:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591156262626607139" data-draft-id="7591330139083653135" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£ System.Lazy&lt;T&gt;ï¼šC#.NET å»¶è¿Ÿåˆå§‹åŒ–ä¸çº¿ç¨‹å®‰å…¨"/> <meta itemprop="keywords" content="C#,.NET"/> <meta itemprop="datePublished" content="2026-01-04T23:39:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å”é’æ«"/> <meta itemprop="url" content="https://juejin.cn/user/3737995266234280"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£ System.Lazy&lt;T&gt;ï¼šC#.NET å»¶è¿Ÿåˆå§‹åŒ–ä¸çº¿ç¨‹å®‰å…¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3737995266234280/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å”é’æ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T23:39:28.000Z" title="Sun Jan 04 2026 23:39:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä»€ä¹ˆæ˜¯ <code>Lazy&lt;T&gt;</code>ï¼Ÿ</h3>
<p><code>System.Lazy&lt;T&gt;</code> æ˜¯ <code>.NET Framework 4.0</code> å¼•å…¥ï¼ˆä½äº <code>System</code> å‘½åç©ºé—´ï¼‰çš„æ³›å‹ç±»ï¼Œç”¨äºå®ç°çº¿ç¨‹å®‰å…¨çš„å»¶è¿Ÿåˆå§‹åŒ–ï¼ˆ<code>Lazy Initialization</code>ï¼‰ã€‚å®ƒç¡®ä¿ä¸€ä¸ªæ˜‚è´µçš„å¯¹è±¡æˆ–èµ„æºåªåœ¨ç¬¬ä¸€æ¬¡çœŸæ­£éœ€è¦æ—¶æ‰è¢«åˆ›å»ºï¼Œå¹¶ä¸”åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¿è¯åˆå§‹åŒ–åªå‘ç”Ÿä¸€æ¬¡ã€‚</p>
<ul>
<li>
<p>æ ¸å¿ƒç‰¹æ€§ï¼š</p>
<ul>
<li>
<p>å»¶è¿Ÿè®¡ç®—ï¼šå€¼çš„åˆ›å»ºè¢«æ¨è¿Ÿåˆ°ç¬¬ä¸€æ¬¡è®¿é—® <code>.Value</code> å±æ€§æ—¶ã€‚</p>
</li>
<li>
<p>çº¿ç¨‹å®‰å…¨ï¼šå†…ç½®å¤šç§çº¿ç¨‹å®‰å…¨æ¨¡å¼ï¼Œé»˜è®¤æƒ…å†µä¸‹å®Œå…¨çº¿ç¨‹å®‰å…¨ã€‚</p>
</li>
<li>
<p>å¼‚å¸¸ç¼“å­˜ï¼šå¦‚æœåˆå§‹åŒ–è¿‡ç¨‹ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œåç»­è®¿é—®ä¼šé‡å¤æŠ›å‡ºåŒä¸€ä¸ªå¼‚å¸¸ï¼ˆä¸é‡å¤æ‰§è¡Œå·¥å‚æ–¹æ³•ï¼‰ã€‚</p>
</li>
<li>
<p>å€¼ç¼“å­˜ï¼šä¸€æ—¦åˆå§‹åŒ–å®Œæˆï¼Œåç»­æ‰€æœ‰è®¿é—®éƒ½è¿”å›åŒä¸€ä¸ªå®ä¾‹ï¼ˆå•ä¾‹è¡Œä¸ºï¼‰ã€‚</p>
</li>
</ul>
</li>
<li>
<p>é€‚ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>
<p>æ˜‚è´µèµ„æºåˆå§‹åŒ–ï¼ˆå¦‚æ•°æ®åº“è¿æ¥ã€å¤§æ–‡ä»¶åŠ è½½ã€å¤æ‚è®¡ç®—ï¼‰ã€‚</p>
</li>
<li>
<p>é…ç½®å¯¹è±¡ã€å•ä¾‹æ¨¡å¼ï¼ˆæ¯”åŒæ£€æŸ¥é”æ›´å®‰å…¨ç®€æ´ï¼‰ã€‚</p>
</li>
<li>
<p>é¿å…å¯åŠ¨æ—¶ä¸å¿…è¦çš„å¼€é”€ï¼ˆå°¤å…¶åœ¨æŸäº›ä»£ç è·¯å¾„å¯èƒ½ä¸ä½¿ç”¨è¯¥å¯¹è±¡æ—¶ï¼‰ã€‚</p>
</li>
</ul>
</li>
</ul>
<h3 data-id="heading-1">ä¸ºä»€ä¹ˆä½¿ç”¨ <code>Lazy&lt;T&gt;</code>ï¼Ÿ</h3>
<p>ä¼ ç»Ÿæ–¹å¼ï¼ˆå¦‚ç›´æ¥åœ¨å­—æ®µåˆå§‹åŒ–æˆ–æ‰‹åŠ¨åŒæ£€æŸ¥é”ï¼‰å­˜åœ¨é—®é¢˜ï¼š</p>
<ul>
<li>
<p>æå‰åˆå§‹åŒ–ï¼šæµªè´¹èµ„æºã€‚</p>
</li>
<li>
<p>æ‰‹åŠ¨é”ï¼šæ˜“å‡ºé”™ï¼ˆæ­»é”ã€ç«äº‰æ¡ä»¶ã€<code>ABA</code> é—®é¢˜ï¼‰ã€‚</p>
</li>
<li>
<p>å¼‚å¸¸å¤„ç†å¤æ‚ï¼šéœ€æ‰‹åŠ¨ç¼“å­˜å¼‚å¸¸ã€‚</p>
</li>
</ul>
<p><code>Lazy&lt;T&gt;</code>æ€§èƒ½ä¼˜åŒ–ï¼šæŒ‰éœ€åˆå§‹åŒ–ã€‚</p>
<ul>
<li>
<p>çº¿ç¨‹å®‰å…¨ï¼šå¾®è½¯é«˜åº¦ä¼˜åŒ–ï¼Œæ— é”æˆ–è½»é‡é”å®ç°ã€‚</p>
</li>
<li>
<p>ä»£ç ç®€æ´ï¼šä¸€è¡Œä»£ç å–ä»£å¤æ‚çš„åŒæ£€æŸ¥é”ã€‚</p>
</li>
<li>
<p>é˜² <code>ABA</code>ï¼šå†…éƒ¨ä½¿ç”¨å¤åˆçŠ¶æ€ + <code>CAS</code> æœºåˆ¶ï¼Œå½»åº•é¿å… <code>ABA</code> é—®é¢˜ã€‚ å®Œç¾è§£å†³è¿™äº›é—®é¢˜ï¼š</p>
</li>
</ul>
<h3 data-id="heading-2">å¦‚ä½•ä½¿ç”¨ <code>Lazy&lt;T&gt;</code>ï¼Ÿ</h3>
<h4 data-id="heading-3">æ ¸å¿ƒè¯­æ³•ä¸å±æ€§</h4>





























<table><thead><tr><th>æˆå‘˜</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>Lazy&lt;T&gt;()</code></td><td>æ„é€ å‡½æ•°ï¼šé»˜è®¤ä½¿ç”¨<code>T</code>çš„æ— å‚æ„é€ åˆ›å»ºå¯¹è±¡ï¼Œçº¿ç¨‹å®‰å…¨æ¨¡å¼ä¸º<code>ExecutionAndPublication</code></td></tr><tr><td><code>Lazy&lt;T&gt;(Func&lt;T&gt; valueFactory)</code></td><td>æ„é€ å‡½æ•°ï¼šè‡ªå®šä¹‰å¯¹è±¡åˆ›å»ºé€»è¾‘ï¼ˆæ”¯æŒä¼ å‚ã€å¤æ‚åˆå§‹åŒ–ï¼‰</td></tr><tr><td><code>Lazy&lt;T&gt;(LazyThreadSafetyMode mode)</code></td><td>æ„é€ å‡½æ•°ï¼šæŒ‡å®šçº¿ç¨‹å®‰å…¨æ¨¡å¼</td></tr><tr><td><code>Value</code></td><td>æ ¸å¿ƒå±æ€§ï¼šé¦–æ¬¡è®¿é—®è§¦å‘å¯¹è±¡åˆå§‹åŒ–ï¼Œåç»­è®¿é—®è¿”å›å·²åˆ›å»ºçš„å®ä¾‹ï¼ˆåªè¯»ï¼‰</td></tr><tr><td><code>IsValueCreated</code></td><td>å¸ƒå°”å±æ€§ï¼šåˆ¤æ–­å¯¹è±¡æ˜¯å¦å·²å®Œæˆåˆå§‹åŒ–</td></tr></tbody></table>
<h4 data-id="heading-4">åŸºç¡€ç¤ºä¾‹ï¼ˆé»˜è®¤æ„é€ ï¼‰</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Threading;

<span class="hljs-comment">// æ¨¡æ‹Ÿåˆ›å»ºæˆæœ¬é«˜çš„å¯¹è±¡ï¼ˆå¦‚åŠ è½½é…ç½®ã€è¿æ¥æ•°æ®åº“ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ExpensiveObject</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ExpensiveObject</span>()</span>
    {
        Console.WriteLine(<span class="hljs-string">"ExpensiveObject å¼€å§‹åˆå§‹åŒ–ï¼ˆè€—æ—¶æ“ä½œï¼‰..."</span>);
        Thread.Sleep(<span class="hljs-number">2000</span>); <span class="hljs-comment">// æ¨¡æ‹Ÿ2ç§’è€—æ—¶åˆå§‹åŒ–</span>
        Console.WriteLine(<span class="hljs-string">"ExpensiveObject åˆå§‹åŒ–å®Œæˆï¼"</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoWork</span>()</span> =&gt; Console.WriteLine(<span class="hljs-string">"ExpensiveObject æ‰§è¡Œä¸šåŠ¡é€»è¾‘..."</span>);
}

<span class="hljs-keyword">class</span> <span class="hljs-title">LazyBasicDemo</span>
{
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
    {
        Console.WriteLine(<span class="hljs-string">"ç¨‹åºå¯åŠ¨ï¼Œåˆ›å»ºLazy&lt;ExpensiveObject&gt;å®ä¾‹..."</span>);
        <span class="hljs-comment">// æ­¤æ—¶ä»…åˆ›å»ºLazy&lt;T&gt;å®¹å™¨ï¼ŒExpensiveObjectå¹¶æœªå®ä¾‹åŒ–</span>
        Lazy&lt;ExpensiveObject&gt; lazyObj = <span class="hljs-keyword">new</span> Lazy&lt;ExpensiveObject&gt;();

        Console.WriteLine(<span class="hljs-string">$"å¯¹è±¡æ˜¯å¦å·²åˆ›å»ºï¼š<span class="hljs-subst">{lazyObj.IsValueCreated}</span>"</span>); <span class="hljs-comment">// è¾“å‡ºï¼šFalse</span>

        <span class="hljs-comment">// é¦–æ¬¡è®¿é—®Valueï¼šè§¦å‘ExpensiveObjectçš„æ„é€ å‡½æ•°</span>
        Console.WriteLine(<span class="hljs-string">"\n=== é¦–æ¬¡è®¿é—®Value ==="</span>);
        lazyObj.Value.DoWork();
        Console.WriteLine(<span class="hljs-string">$"å¯¹è±¡æ˜¯å¦å·²åˆ›å»ºï¼š<span class="hljs-subst">{lazyObj.IsValueCreated}</span>"</span>); <span class="hljs-comment">// è¾“å‡ºï¼šTrue</span>

        <span class="hljs-comment">// å†æ¬¡è®¿é—®Valueï¼šç›´æ¥è¿”å›å·²åˆ›å»ºçš„å®ä¾‹ï¼Œä¸å†åˆå§‹åŒ–</span>
        Console.WriteLine(<span class="hljs-string">"\n=== å†æ¬¡è®¿é—®Value ==="</span>);
        lazyObj.Value.DoWork();
    }
}
</code></pre>
<p>è¾“å‡ºç»“æœï¼š</p>
<pre><code class="hljs language-ini" lang="ini">ç¨‹åºå¯åŠ¨ï¼Œåˆ›å»ºLazy&lt;ExpensiveObject&gt;å®ä¾‹...
å¯¹è±¡æ˜¯å¦å·²åˆ›å»ºï¼š<span class="hljs-attr">False</span>

=== é¦–æ¬¡è®¿é—®<span class="hljs-attr">Value</span> ===
ExpensiveObject å¼€å§‹åˆå§‹åŒ–ï¼ˆè€—æ—¶æ“ä½œï¼‰...
ExpensiveObject åˆå§‹åŒ–å®Œæˆï¼
ExpensiveObject æ‰§è¡Œä¸šåŠ¡é€»è¾‘...
å¯¹è±¡æ˜¯å¦å·²åˆ›å»ºï¼š<span class="hljs-attr">True</span>

=== å†æ¬¡è®¿é—®<span class="hljs-attr">Value</span> ===
ExpensiveObject æ‰§è¡Œä¸šåŠ¡é€»è¾‘...
</code></pre>
<h4 data-id="heading-5">è‡ªå®šä¹‰å·¥å‚æ–¹æ³•ï¼ˆå¸¦å‚æ•°åˆå§‹åŒ–ï¼‰</h4>
<p>è‹¥å¯¹è±¡éœ€è¦ä¼ å‚æˆ–å¤æ‚åˆå§‹åŒ–é€»è¾‘ï¼Œä½¿ç”¨ <code>Func&lt;T&gt;</code> å·¥å‚æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// è‡ªå®šä¹‰å¸¦å‚æ•°çš„å¯¹è±¡æ„é€ </span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ConfigObject</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">string</span> _configPath;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ConfigObject</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> configPath</span>)</span>
    {
        _configPath = configPath;
        Console.WriteLine(<span class="hljs-string">$"åŠ è½½é…ç½®æ–‡ä»¶ï¼š<span class="hljs-subst">{configPath}</span>"</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> <span class="hljs-title">GetConfig</span>()</span> =&gt; <span class="hljs-string">$"é…ç½®å†…å®¹ï¼ˆæ¥è‡ª<span class="hljs-subst">{_configPath}</span>ï¼‰"</span>;
}

<span class="hljs-keyword">class</span> <span class="hljs-title">LazyFactoryDemo</span>
{
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
    {
        <span class="hljs-comment">// è‡ªå®šä¹‰å·¥å‚æ–¹æ³•ï¼šåˆ›å»ºConfigObjectå¹¶ä¼ å…¥å‚æ•°</span>
        Lazy&lt;ConfigObject&gt; lazyConfig = <span class="hljs-keyword">new</span> Lazy&lt;ConfigObject&gt;(() =&gt; 
        {
            Console.WriteLine(<span class="hljs-string">"æ‰§è¡Œè‡ªå®šä¹‰å·¥å‚æ–¹æ³•..."</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ConfigObject(<span class="hljs-string">"appsettings.json"</span>);
        });

        Console.WriteLine(<span class="hljs-string">"é¦–æ¬¡è®¿é—®é…ç½®ï¼š"</span>);
        Console.WriteLine(lazyConfig.Value.GetConfig()); <span class="hljs-comment">// è§¦å‘å·¥å‚æ–¹æ³•</span>
    }
}
</code></pre>
<h4 data-id="heading-6"><code>Lazy&lt;T&gt;</code> çš„çº¿ç¨‹å®‰å…¨æ¨¡å¼</h4>
<p><code>Lazy&lt;T&gt;</code> çš„å…³é”®ç‰¹æ€§æ˜¯æ”¯æŒå¤šçº¿ç¨‹åœºæ™¯ï¼Œé€šè¿‡ <code>LazyThreadSafetyMode</code> æšä¸¾æ§åˆ¶çº¿ç¨‹å®‰å…¨è¡Œä¸º</p>





























<table><thead><tr><th>çº¿ç¨‹å®‰å…¨æ¨¡å¼</th><th>é€‚ç”¨åœºæ™¯</th><th>æ ¸å¿ƒè¡Œä¸º</th><th>æ€§èƒ½</th></tr></thead><tbody><tr><td><code>None</code></td><td>å•çº¿ç¨‹ç¯å¢ƒ</td><td>æ— çº¿ç¨‹å®‰å…¨ä¿éšœï¼Œå¤šçº¿ç¨‹åŒæ—¶è®¿é—®<code>Value</code>å¯èƒ½åˆ›å»ºå¤šä¸ªå®ä¾‹</td><td>æœ€é«˜ï¼ˆæ— é”ï¼‰</td></tr><tr><td><code>PublicationOnly</code></td><td>å¤šçº¿ç¨‹ + å¯¹è±¡åˆ›å»ºæˆæœ¬ä½</td><td>å¤šçº¿ç¨‹å¯åŒæ—¶åˆå§‹åŒ–ï¼Œä½†æœ€ç»ˆä»…ä¿ç•™ä¸€ä¸ªå®ä¾‹ï¼ˆå…¶ä»–å®ä¾‹è¢«ä¸¢å¼ƒï¼‰ï¼Œæ— é”é˜»å¡</td><td>é«˜</td></tr><tr><td><code>ExecutionAndPublication</code>ï¼ˆé»˜è®¤ï¼‰</td><td>å¤šçº¿ç¨‹ + å¯¹è±¡åˆ›å»ºæˆæœ¬é«˜</td><td>åŠ é”ä¿è¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œåˆå§‹åŒ–ï¼Œå…¶ä»–çº¿ç¨‹ç­‰å¾…ï¼Œç»å¯¹å•å®ä¾‹</td><td/></tr></tbody></table>
<p>ç¤ºä¾‹ï¼šå¤šçº¿ç¨‹ä¸‹çš„çº¿ç¨‹å®‰å…¨æ¨¡å¼</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">class</span> <span class="hljs-title">LazyThreadSafetyDemo</span>
{
    <span class="hljs-comment">// é»˜è®¤æ¨¡å¼ï¼šExecutionAndPublicationï¼ˆåŠ é”ä¿è¯å•å®ä¾‹ï¼‰</span>
    <span class="hljs-keyword">static</span> Lazy&lt;ExpensiveObject&gt; lazySafeObj = <span class="hljs-keyword">new</span> Lazy&lt;ExpensiveObject&gt;();

    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AccessLazyObj</span>()</span>
    {
        Console.WriteLine(<span class="hljs-string">$"çº¿ç¨‹<span class="hljs-subst">{Thread.CurrentThread.ManagedThreadId}</span> å°è¯•è®¿é—®Value..."</span>);
        <span class="hljs-keyword">var</span> obj = lazySafeObj.Value;
        Console.WriteLine(<span class="hljs-string">$"çº¿ç¨‹<span class="hljs-subst">{Thread.CurrentThread.ManagedThreadId}</span> è·å–å¯¹è±¡HashCodeï¼š<span class="hljs-subst">{obj.GetHashCode()}</span>"</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
    {
        <span class="hljs-comment">// å¯åŠ¨5ä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)
        {
            <span class="hljs-keyword">new</span> Thread(AccessLazyObj).Start();
        }
        Thread.Sleep(<span class="hljs-number">3000</span>); <span class="hljs-comment">// ç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆ</span>
    }
}
</code></pre>
<p>è¾“å‡ºç»“æœ</p>
<p>æ‰€æœ‰çº¿ç¨‹æœ€ç»ˆè·å–çš„ <code>HashCode</code> å®Œå…¨ç›¸åŒï¼Œä¸”ä»…è§¦å‘ä¸€æ¬¡åˆå§‹åŒ–ï¼ˆè¯æ˜å•å®ä¾‹ï¼‰ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">çº¿ç¨‹<span class="hljs-number">3</span> å°è¯•è®¿é—®Value...
ExpensiveObject å¼€å§‹åˆå§‹åŒ–ï¼ˆè€—æ—¶æ“ä½œï¼‰...
çº¿ç¨‹<span class="hljs-number">4</span> å°è¯•è®¿é—®Value...
çº¿ç¨‹<span class="hljs-number">5</span> å°è¯•è®¿é—®Value...
çº¿ç¨‹<span class="hljs-number">6</span> å°è¯•è®¿é—®Value...
çº¿ç¨‹<span class="hljs-number">7</span> å°è¯•è®¿é—®Value...
ExpensiveObject åˆå§‹åŒ–å®Œæˆï¼
çº¿ç¨‹<span class="hljs-number">3</span> è·å–å¯¹è±¡HashCodeï¼š<span class="hljs-number">46104728</span>
çº¿ç¨‹<span class="hljs-number">4</span> è·å–å¯¹è±¡HashCodeï¼š<span class="hljs-number">46104728</span>
çº¿ç¨‹<span class="hljs-number">5</span> è·å–å¯¹è±¡HashCodeï¼š<span class="hljs-number">46104728</span>
çº¿ç¨‹<span class="hljs-number">6</span> è·å–å¯¹è±¡HashCodeï¼š<span class="hljs-number">46104728</span>
çº¿ç¨‹<span class="hljs-number">7</span> è·å–å¯¹è±¡HashCodeï¼š<span class="hljs-number">46104728</span>
</code></pre>
<h3 data-id="heading-7">é«˜çº§åº”ç”¨åœºæ™¯</h3>
<h4 data-id="heading-8">æ‡’åŠ è½½å•ä¾‹æ¨¡å¼</h4>
<p><code>Lazy&lt;T&gt;</code> æ˜¯ <code>.NET</code> ä¸­å®ç°çº¿ç¨‹å®‰å…¨ã€æ‡’åŠ è½½å•ä¾‹çš„æœ€ä¼˜æ–¹å¼ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">sealed</span> <span class="hljs-keyword">class</span> <span class="hljs-title">LazySingleton</span>
{
    <span class="hljs-comment">// ç§æœ‰é™æ€Lazyå®ä¾‹ï¼šå»¶è¿Ÿåˆå§‹åŒ–ï¼Œé»˜è®¤çº¿ç¨‹å®‰å…¨</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> Lazy&lt;LazySingleton&gt; _lazyInstance = <span class="hljs-keyword">new</span> Lazy&lt;LazySingleton&gt;(() =&gt; <span class="hljs-keyword">new</span> LazySingleton());

    <span class="hljs-comment">// ç§æœ‰æ„é€ å‡½æ•°ï¼šç¦æ­¢å¤–éƒ¨å®ä¾‹åŒ–</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">LazySingleton</span>()</span> 
    {
        Console.WriteLine(<span class="hljs-string">"å•ä¾‹å¯¹è±¡åˆå§‹åŒ–..."</span>);
    }

    <span class="hljs-comment">// å…¬å…±å±æ€§ï¼šé¦–æ¬¡è®¿é—®æ—¶åˆ›å»ºå®ä¾‹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> LazySingleton Instance =&gt; _lazyInstance.Value;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoBusiness</span>()</span> =&gt; Console.WriteLine(<span class="hljs-string">"å•ä¾‹å¯¹è±¡æ‰§è¡Œä¸šåŠ¡é€»è¾‘..."</span>);
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title">SingletonDemo</span>
{
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
    {
        Console.WriteLine(<span class="hljs-string">"ç¨‹åºå¯åŠ¨ï¼Œæœªè®¿é—®å•ä¾‹..."</span>);
        <span class="hljs-comment">// é¦–æ¬¡è®¿é—®Instanceï¼šè§¦å‘å•ä¾‹åˆå§‹åŒ–</span>
        LazySingleton.Instance.DoBusiness();
        <span class="hljs-comment">// å†æ¬¡è®¿é—®ï¼šç›´æ¥è¿”å›å·²åˆ›å»ºçš„å®ä¾‹</span>
        LazySingleton.Instance.DoBusiness();
    }
}
</code></pre>
<h4 data-id="heading-9">å¤„ç†åˆå§‹åŒ–å¼‚å¸¸</h4>
<p>è‹¥ <code>Lazy&lt;T&gt;</code> çš„å·¥å‚æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œåç»­è®¿é—® <code>Value</code> ä¼šç¼“å­˜å¹¶é‡æ–°æŠ›å‡ºåŒä¸€å¼‚å¸¸</p>
<pre><code class="hljs language-csharp" lang="csharp">Lazy&lt;ExpensiveObject&gt; lazyErrorObj = <span class="hljs-keyword">new</span> Lazy&lt;ExpensiveObject&gt;(() =&gt;
{
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> InvalidOperationException(<span class="hljs-string">"åˆå§‹åŒ–å¤±è´¥ï¼šé…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼"</span>);
});

<span class="hljs-keyword">try</span>
{
    <span class="hljs-comment">// é¦–æ¬¡è®¿é—®ï¼šæŠ›å‡ºå¼‚å¸¸</span>
    lazyErrorObj.Value.DoWork();
}
<span class="hljs-keyword">catch</span> (AggregateException ex)
{
    Console.WriteLine(<span class="hljs-string">$"åˆå§‹åŒ–å¼‚å¸¸ï¼š<span class="hljs-subst">{ex.InnerException.Message}</span>"</span>);
}

<span class="hljs-keyword">try</span>
{
    <span class="hljs-comment">// å†æ¬¡è®¿é—®ï¼šä»æŠ›å‡ºåŒä¸€å¼‚å¸¸ï¼ˆå¼‚å¸¸è¢«ç¼“å­˜ï¼‰</span>
    lazyErrorObj.Value.DoWork();
}
<span class="hljs-keyword">catch</span> (AggregateException ex)
{
    Console.WriteLine(<span class="hljs-string">$"å†æ¬¡è®¿é—®å¼‚å¸¸ï¼š<span class="hljs-subst">{ex.InnerException.Message}</span>"</span>);
}
</code></pre>
<h4 data-id="heading-10">å¼‚æ­¥æ‡’åŠ è½½ï¼ˆä¼ª AsyncLazyï¼‰</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> Lazy&lt;Task&lt;ExpensiveObject&gt;&gt; _asyncResource = <span class="hljs-keyword">new</span>(<span class="hljs-keyword">async</span> () =&gt;
{
    <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">2000</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ExpensiveObject();
});

<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task&lt;ExpensiveObject&gt; <span class="hljs-title">GetResourceAsync</span>()</span> =&gt; <span class="hljs-keyword">await</span> _asyncResource.Value;
</code></pre>
<h4 data-id="heading-11">æ”¯æŒåˆ·æ–°ï¼ˆResetï¼‰çš„è‡ªå®šä¹‰åŒ…è£…</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">RefreshableLazy</span>&lt;<span class="hljs-title">T</span>&gt;
{
    <span class="hljs-keyword">private</span> Lazy&lt;T&gt; _current;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">RefreshableLazy</span>(<span class="hljs-params">Func&lt;T&gt; factory</span>)</span>
    {
        _current = <span class="hljs-keyword">new</span> Lazy&lt;T&gt;(factory);
    }

    <span class="hljs-keyword">public</span> T Value =&gt; _current.Value;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Refresh</span>()</span>
    {
        <span class="hljs-keyword">var</span> factory = _current.Value; <span class="hljs-comment">// ä¿ç•™æ—§å·¥å‚ï¼Ÿæˆ–ä¼ å…¥æ–°å·¥å‚</span>
        _current = <span class="hljs-keyword">new</span> Lazy&lt;T&gt;(_current.Factory); <span class="hljs-comment">// é‡æ–°åˆ›å»º</span>
    }
}
</code></pre>
<h4 data-id="heading-12">ä¸ä¾èµ–æ³¨å…¥ç»“åˆï¼ˆASP.NET Coreï¼‰</h4>
<pre><code class="hljs language-csharp" lang="csharp">services.AddSingleton&lt;ExpensiveService&gt;();
services.AddSingleton&lt;Lazy&lt;ExpensiveService&gt;&gt;(provider =&gt; 
    <span class="hljs-keyword">new</span> Lazy&lt;ExpensiveService&gt;(provider.GetRequiredService&lt;ExpensiveService&gt;));
</code></pre>
<h4 data-id="heading-13">é…ç½®æ–‡ä»¶åŠ è½½</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AppConfig</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> Lazy&lt;AppConfig&gt; _instance = 
        <span class="hljs-keyword">new</span> Lazy&lt;AppConfig&gt;(LoadConfiguration);
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> AppConfig Instance =&gt; _instance.Value;
    
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> ConnectionString { <span class="hljs-keyword">get</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Timeout { <span class="hljs-keyword">get</span>; }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">AppConfig</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> config</span>)</span>
    {
        <span class="hljs-comment">// è§£æé…ç½®</span>
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> AppConfig <span class="hljs-title">LoadConfiguration</span>()</span>
    {
        <span class="hljs-built_in">string</span> configData = File.ReadAllText(<span class="hljs-string">"config.json"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> AppConfig(configData);
    }
}
</code></pre>
<h3 data-id="heading-14"><code>Lazy&lt;T&gt;</code> vs æ‰‹åŠ¨æ‡’åŠ è½½</h3>
<p>æ‰‹åŠ¨å®ç°çº¿ç¨‹å®‰å…¨çš„æ‡’åŠ è½½éœ€è¦å†™åŒé‡æ£€æŸ¥é”å®šï¼ˆæ˜“å‡ºé”™ï¼‰ï¼Œè€Œ <code>Lazy&lt;T&gt;</code> å·²å°è£…æ‰€æœ‰é€»è¾‘ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// æ‰‹åŠ¨å®ç°ï¼ˆçº¿ç¨‹å®‰å…¨ï¼Œéœ€åŒé‡æ£€æŸ¥+volatileï¼‰</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> ExpensiveObject _manualObj;
<span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-built_in">object</span> _lockObj = <span class="hljs-keyword">new</span> <span class="hljs-built_in">object</span>();
<span class="hljs-keyword">public</span> ExpensiveObject ManualObj
{
    <span class="hljs-keyword">get</span>
    {
        <span class="hljs-keyword">if</span> (_manualObj == <span class="hljs-literal">null</span>)
        {
            <span class="hljs-keyword">lock</span> (_lockObj)
            {
                <span class="hljs-keyword">if</span> (_manualObj == <span class="hljs-literal">null</span>)
                {
                    _manualObj = <span class="hljs-keyword">new</span> ExpensiveObject();
                }
            }
        }
        <span class="hljs-keyword">return</span> _manualObj;
    }
}

<span class="hljs-comment">// Lazy&lt;T&gt;å®ç°ï¼ˆä¸€è¡Œæå®šï¼Œçº¿ç¨‹å®‰å…¨ï¼‰</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> Lazy&lt;ExpensiveObject&gt; _lazyObj = <span class="hljs-keyword">new</span> Lazy&lt;ExpensiveObject&gt;();
<span class="hljs-keyword">public</span> ExpensiveObject LazyObj =&gt; _lazyObj.Value;
</code></pre>
<h3 data-id="heading-15"><code>Lazy&lt;T&gt;</code> å†…éƒ¨å®ç°åŸç†ï¼ˆç®€è¦ï¼‰</h3>
<ul>
<li>
<p>ä½¿ç”¨ä¸€ä¸ªç§æœ‰å­—æ®µï¼ˆå¦‚ <code>object? _box</code>ï¼‰å­˜å‚¨çŠ¶æ€ï¼š</p>
<ul>
<li>
<p><code>null</code>ï¼šæœªåˆå§‹åŒ–</p>
</li>
<li>
<p><code>Box&lt;T&gt;</code>ï¼šå·²å®Œæˆï¼ˆåŒ…å«å€¼ï¼‰</p>
</li>
<li>
<p>å¼‚å¸¸å¯¹è±¡ï¼šåˆå§‹åŒ–å¤±è´¥</p>
</li>
</ul>
</li>
<li>
<p>åˆå§‹åŒ–æ—¶ä½¿ç”¨ <code>Interlocked.CompareExchange</code> è¿›è¡ŒåŸå­çŠ¶æ€è½¬æ¢ã€‚</p>
</li>
<li>
<p>å†…éƒ¨çŠ¶æ€æœºç»“åˆç‰ˆæœ¬æœºåˆ¶ï¼Œå½»åº•é˜²æ­¢ <code>ABA</code> é—®é¢˜ã€‚</p>
</li>
<li>
<p><code>ExecutionAndPublication</code> æ¨¡å¼ä¸‹ä½¿ç”¨è½»é‡è‡ªæ—‹ + ç­‰å¾…æœºåˆ¶ï¼Œç¡®ä¿åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå·¥å‚æ–¹æ³•ã€‚</p>
</li>
</ul>
<h3 data-id="heading-16">ä¼˜ç‚¹ä¸ç¼ºç‚¹</h3>



































<table><thead><tr><th>æ–¹é¢</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td><strong>çº¿ç¨‹å®‰å…¨</strong></td><td>å†…ç½®å®Œç¾æ”¯æŒï¼Œé˜² ABAã€é˜²é‡å¤åˆå§‹åŒ–</td><td>None æ¨¡å¼ä¸‹éœ€æ‰‹åŠ¨æ³¨æ„</td></tr><tr><td><strong>æ˜“ç”¨æ€§</strong></td><td>ä»£ç æç®€ï¼Œä¸€è¡Œæå®š</td><td>ä¸æ”¯æŒä¸»åŠ¨ Resetï¼ˆéœ€è‡ªå®šä¹‰åŒ…è£…ï¼‰</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>é«˜åº¦ä¼˜åŒ–ï¼Œæ— é”è·¯å¾„æå¿«</td><td>ç¬¬ä¸€æ¬¡è®¿é—®å¯èƒ½é˜»å¡ï¼ˆä½†è¿™æ˜¯å»¶è¿Ÿåˆå§‹åŒ–çš„æœ¬è´¨ï¼‰</td></tr><tr><td><strong>åŠŸèƒ½</strong></td><td>å¼‚å¸¸ç¼“å­˜ã€å€¼ç¼“å­˜ã€IsValueCreated æŸ¥è¯¢</td><td>ä¸æ”¯æŒå¼‚æ­¥åˆå§‹åŒ–ï¼ˆéœ€ç”¨ Lazy&lt;Task&gt;ï¼‰</td></tr><tr><td><strong>é€‚ç”¨æ€§</strong></td><td>å‡ ä¹æ‰€æœ‰æ‡’åŠ è½½åœºæ™¯çš„é¦–é€‰</td><td>è‹¥éœ€æ”¯æŒåˆ·æ–°/é‡ç½®ï¼Œéœ€é¢å¤–å°è£…</td></tr></tbody></table>
<h3 data-id="heading-17">æœ€ä½³å®è·µ</h3>
<ul>
<li>
<p>ä¼˜å…ˆä½¿ç”¨ <code>Lazy&lt;T&gt;</code> æ›¿ä»£æ‰‹åŠ¨åŒæ£€æŸ¥é”ã€‚</p>
</li>
<li>
<p>å§‹ç»ˆä½¿ç”¨é»˜è®¤çº¿ç¨‹å®‰å…¨æ¨¡å¼ï¼ˆé™¤éæ˜ç¡®éœ€è¦ <code>PublicationOnly</code>ï¼‰ã€‚</p>
</li>
<li>
<p>å·¥å‚æ–¹æ³•åº”æ— å‰¯ä½œç”¨ï¼ˆå°¤å…¶åœ¨ <code>PublicationOnly</code> æ¨¡å¼ä¸‹ï¼‰ã€‚</p>
</li>
<li>
<p>å¼‚å¸¸å¤„ç†ï¼šæ•è· <code>.Value</code> æŠ›å‡ºçš„å¼‚å¸¸ã€‚</p>
</li>
<li>
<p>ä¸è¦åœ¨å·¥å‚æ–¹æ³•ä¸­è®¿é—®åŒä¸€ä¸ª <code>Lazy</code> å®ä¾‹ï¼ˆå¯èƒ½æ­»é”ï¼‰ã€‚</p>
</li>
</ul>
<h3 data-id="heading-18">æ€»ç»“</h3>
<ul>
<li>
<p><code>System.Lazy&lt;T&gt;</code> æ˜¯ <code>.NET</code> å®˜æ–¹çš„å»¶è¿Ÿåˆå§‹åŒ–å·¥å…·ï¼Œæ ¸å¿ƒæ˜¯é¦–æ¬¡è®¿é—® <code>Value</code> æ—¶åˆ›å»ºå¯¹è±¡ï¼Œæå‡ç¨‹åºå¯åŠ¨é€Ÿåº¦å’Œå†…å­˜æ•ˆç‡ï¼›</p>
</li>
<li>
<p>æ ¸å¿ƒå±æ€§ï¼š<code>Value</code>ï¼ˆè§¦å‘åˆå§‹åŒ–ï¼‰ã€<code>IsValueCreated</code>ï¼ˆåˆ¤æ–­æ˜¯å¦å·²åˆ›å»ºï¼‰ï¼›</p>
</li>
<li>
<p>çº¿ç¨‹å®‰å…¨æ¨¡å¼éœ€æŒ‰éœ€é€‰æ‹©ï¼šå•çº¿ç¨‹ç”¨ <code>None</code>ï¼Œå¤šçº¿ç¨‹é«˜æˆæœ¬å¯¹è±¡ç”¨é»˜è®¤çš„<code>ExecutionAndPublication</code>ï¼›</p>
</li>
<li>
<p>æœ€ä¼˜åœºæ™¯ï¼šåˆ›å»ºæˆæœ¬é«˜ / ä¸ä¸€å®šä½¿ç”¨çš„å¯¹è±¡ã€æ‡’åŠ è½½å•ä¾‹æ¨¡å¼ï¼›</p>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[çˆ†æ¬¾æ‹†è§£ä¸å®ç°ï¼šåŠ¨æ€ç”»å‡ºç‰©ç†çº¿æ¡ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ åˆ¶ä½œâ€œç”»çº¿æ•‘ç‹—â€]]></title>    <link>https://juejin.cn/post/7591317772074762259</link>    <guid>https://juejin.cn/post/7591317772074762259</guid>    <pubDate>2026-01-05T00:01:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591317772074762259" data-draft-id="7591334602427465791" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="çˆ†æ¬¾æ‹†è§£ä¸å®ç°ï¼šåŠ¨æ€ç”»å‡ºç‰©ç†çº¿æ¡ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ åˆ¶ä½œâ€œç”»çº¿æ•‘ç‹—â€"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-05T00:01:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº¿å…ƒç¨‹åºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/1972988307323236"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            çˆ†æ¬¾æ‹†è§£ä¸å®ç°ï¼šåŠ¨æ€ç”»å‡ºç‰©ç†çº¿æ¡ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ åˆ¶ä½œâ€œç”»çº¿æ•‘ç‹—â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972988307323236/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº¿å…ƒç¨‹åºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-05T00:01:34.000Z" title="Mon Jan 05 2026 00:01:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14b70c6127ad4480a1284a8b63dc0d5d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=khfIBT7jkhJZEaTA7TH8VQis3Ms%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">å¼•è¨€</h2>
<p><strong>å“ˆå–½å¤§å®¶å¥½</strong>ï¼Œä¸çŸ¥é“å°ä¼™ä¼´ä»¬æœ‰æ²¡æœ‰è§è¿‡ä¸Šé¢è¿™æ¬¾æ¸¸æˆï¼Ÿ</p>
<p><strong>è¿™æ¬¾æ¸¸æˆ</strong>åœ¨ä¹°é‡é¢˜æä¸­ç›¸å½“ç«çˆ†ï¼Œå¾ˆå¤šçƒ­é—¨å•†ä¸šæ¸¸æˆä¸­éƒ½æ·»åŠ äº†åŒæ¬¾ç©æ³•ï¼Œç„¶åé€šè¿‡è¯¥ç©æ³•åˆ¶ä½œå¹¿å‘Šç´ æè¿›è¡Œä¹°é‡ã€‚</p>
<p><strong>å‡ºåœºç‡</strong>å¦‚æ­¤é«˜çš„æ¸¸æˆï¼Œç¬”è€…å¥½å¥‡åœ¨<strong>Cocosæ¸¸æˆå¼€å‘</strong>ä¸­åº”è¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿ</p>
<p><strong>è¨€å½’æ­£ä¼ </strong>ï¼Œå°ä¼™ä¼´ä»¬è·Ÿéšç¬”è€…ï¼Œä¸€èµ·æ¥çœ‹çœ‹<strong>åœ¨Cocosæ¸¸æˆå¼€å‘ä¸­ï¼Œå¦‚ä½•å®ç°ç”»çº¿æ•‘ç‹—çš„ç©æ³•</strong>ã€‚</p>
<p><strong>æœ¬æ–‡</strong>æ”¶å½•äº<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FFOi5gCiGzF3LnT03DpPMXA" target="_blank" title="https://mp.weixin.qq.com/s/FOi5gCiGzF3LnT03DpPMXA" ref="nofollow noopener noreferrer">ã€Šäº¿å…ƒCocoså°æ¸¸æˆå®æˆ˜åˆé›†ã€‹</a>ï¼Œæ¬¢è¿å°ä¼™ä¼´ä»¬ç‚¹èµæ¨èè®¢é˜…è½¬å‘ã€‚</p>
<p><strong>æœ¬æ–‡å®æˆ˜æºç å¯åœ¨æ–‡æœ«è·å–ï¼Œå°ä¼™ä¼´ä»¬è‡ªè¡Œå‰å¾€ã€‚</strong></p>
<h2 data-id="heading-1">1. æ‹†è§£ä¸€ä¸‹æ¸¸æˆ</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c732444305564557ac1da78a751917de~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=GJQZrBRTieibQ8fLCgV0ZzIzxtk%3D" alt="" loading="lazy"/></p>
<p><strong>æˆ‘ä»¬</strong>å…ˆæ¥æ‹†è§£ä¸€ä¸‹å®ç°è¿™ä¸ªæ¸¸æˆæœ‰å“ªäº›å…³é”®ç‚¹ï¼š</p>
<ol>
<li>
<p><strong>ç”»çº¿</strong>ï¼šæ¸¸æˆçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå°±æ˜¯åœ¨å±å¹•ä¸Šç”»å‡ºä»»æ„å½¢çŠ¶çš„çº¿ï¼Œç”»å®Œåä¼šäº§ç”Ÿç‰©ç†æ•ˆæœï¼Œä¿æŠ¤ç‹—ç‹—ï¼Œé˜²æ­¢ç‹—ç‹—æ‰è½å’Œè¢«èœœèœ‚æ”»å‡»ã€‚</p>
</li>
<li>
<p><strong>ç‹—ç‹—</strong>ï¼šæ¸¸æˆçš„ä¸»è§’ï¼Œæˆ‘ä»¬è¦é€šè¿‡ç”»çº¿å¯¹å®ƒè¿›è¡Œä¿æŠ¤ï¼Œç‹—ç‹—åœ¨å€’è®¡æ—¶ç»“æŸåæœªæ‰è½å’Œè¢«èœœèœ‚æ”»å‡»å³å¯é€šå…³ï¼Œå¦åˆ™å¤±è´¥ã€‚</p>
</li>
<li>
<p><strong>èœœèœ‚</strong>ï¼šä¸åœåœ°æœç€ç‹—ç‹—çš„æ–¹å‘è¿›æ”»ï¼Œç¢°æ’åˆ°çº¿åï¼Œå°è¯•åé€€å†ç»§ç»­è¿›æ”»ã€‚</p>
</li>
<li>
<p><strong>èœ‚å·¢</strong>ï¼šèœœèœ‚å‡ºå‘çš„åœ°æ–¹ï¼Œåœ¨è¿™é‡Œé¢å®ä¾‹åŒ–æŒ‡å®šæ•°é‡çš„èœœèœ‚ã€‚</p>
</li>
</ol>
<h2 data-id="heading-2">2. æ€ä¹ˆå®ç°ï¼Ÿ</h2>
<h3 data-id="heading-3">1.ç”»çº¿</h3>
<p><strong>ä¸€çœ‹åˆ°ç”»çº¿</strong>ï¼Œç¬¬ä¸€æ—¶é—´å°±è¦æƒ³åˆ°<code>Graphics</code>ç»„ä»¶ï¼Œé€šè¿‡å®ƒå†æ­é…æˆ‘ä»¬çš„è§¦æ‘¸äº‹ä»¶ï¼Œå³å¯åœ¨å±å¹•ä¸Šç”»å‡ºå„ç§å„æ ·çš„çº¿æ¡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be61b8378c7e4f42a070618bc19201cd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=nsIWCFh3knYT59JTabNJCb79BaU%3D" alt="æ¥æºäºCocoså®˜æ–¹æ–‡æ¡£" loading="lazy"/></p>
<p><strong>ç”»çº¿å®Œæˆå</strong>ï¼Œçº¿çš„ä¸»è¦ä½œç”¨æ˜¯ä¿æŠ¤ç‹—ç‹—ï¼Œé˜²æ­¢ç‹—ç‹—æ‰è½å’Œè¢«èœœèœ‚æ”»å‡»ã€‚æˆ‘ä»¬éœ€è¦ç»™çº¿å¢åŠ ç‰©ç†æ•ˆæœ(ä¾‹å¦‚å—é‡åŠ›å½±å“ã€å’Œèœœèœ‚å‘ç”Ÿç¢°æ’)ã€‚</p>
<p><strong>æ¸¸æˆ</strong>ä¸­çš„ç‰©ä½“ï¼Œå¦‚æœæƒ³è¦é€šè¿‡ç‰©ç†ç³»ç»Ÿå‘ç”Ÿç¢°æ’ï¼Œæˆ‘ä»¬éœ€è¦ç»™å®ƒåŠ ä¸Šåˆšä½“ç»„ä»¶å’Œç¢°æ’ç»„ä»¶ã€‚</p>
<ul>
<li><strong>åˆšä½“ç»„ä»¶:</strong>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3da82dbee2e647f0b111673e393bd5f0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=ORvl7fO3mrGvgAwPxuliYHbv27g%3D" alt="åˆšä½“ç»„ä»¶" loading="lazy"/></li>
<li><strong>ç¢°æ’ç»„ä»¶ï¼š</strong>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dcb2de270aa94ac384b1cedc0f256987~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=hUAWueOojxKwq9HqJpzv%2BpYrmeM%3D" alt="ç¢°æ’ç»„ä»¶" loading="lazy"/></li>
</ul>
<p><strong>ç”±äº</strong>çº¿æ˜¯ç©å®¶åœ¨æ¸¸æˆè¿‡ç¨‹ä¸­å®æ—¶ç»˜åˆ¶å‡ºæ¥çš„ï¼Œè€Œä¸”æ˜¯ä¸è§„åˆ™çš„ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä»£ç ä¸­è¿›è¡ŒåŠ¨æ€æ·»åŠ ï¼Œè€Œä¸”è¿˜è¦åˆ†æ®µæ·»åŠ ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡<code>addComponent</code>åŠ¨æ€æ·»åŠ ã€‚</p>
<h3 data-id="heading-4">2.ç‹—ç‹—</h3>
<p><strong>ç‹—ç‹—</strong>å’Œä¸Šé¢ç”»çº¿çš„ä¸€æ ·ï¼Œå¦‚æœæƒ³è¦å‘ç”Ÿç¢°æ’ï¼ŒåŒæ ·éœ€è¦æ·»åŠ åˆšä½“å’Œç¢°æ’ç»„ä»¶ã€‚</p>
<p><strong>æƒ³è¦åœ¨ä»£ç ä¸­</strong>æ ¹æ®ç¢°æ’è¿›è¡Œç›¸å…³é€»è¾‘å¤„ç†ï¼Œå¯ä»¥é€šè¿‡ç›‘å¬ç¢°æ’ç»„ä»¶çš„<code>BEGIN_CONTACT</code>äº‹ä»¶ï¼Œä¾‹å¦‚åˆ¤æ–­ç‹—ç‹—æ˜¯å¦è¢«èœœèœ‚æ”»å‡»åˆ°å’Œç‹—ç‹—æ˜¯å¦æ‰åˆ°æ°´é‡Œã€‚</p>
<p><strong>ä¸ºäº†</strong>åŒºåˆ†å’Œåˆ¤æ–­ç‹—ç‹—å’Œä¸åŒçš„ç‰©ä½“å‘ç”Ÿç¢°æ’ï¼Œæˆ‘ä»¬éœ€è¦åœ¨èœå•<code>é¡¹ç›®-&gt;é¡¹ç›®è®¾ç½®-&gt;ç‰©ç†-&gt;ç¢°æ’çŸ©é˜µ</code>ä¸­æ·»åŠ ç¢°æ’åˆ†ç»„ï¼Œä»¥åŠç¼–è¾‘ä»–ä»¬ä¹‹é—´å“ªäº›å¯ä»¥å‘ç”Ÿç¢°æ’ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f60d1f4146e242dba4b279a7e6106890~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=RwlNOLjOwbkDciOkmFyjeeoEkO4%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">3. èœœèœ‚</h3>
<p><strong>èœœèœ‚</strong>çš„ä¸»è¦é€»è¾‘å°±æ˜¯è¿›æ”»ç‹—ç‹—ï¼Œé€šè¿‡ç‹—ç‹—çš„ä½ç½®å’Œè‡ªèº«çš„ä½ç½®å°±èƒ½å¤Ÿå¾—åˆ°èœœèœ‚è¿›æ”»çš„æ–¹å‘ï¼Œç„¶åé€šè¿‡<code>applyForceToCenter</code>ç»™èœœèœ‚æ·»åŠ åŠ›ï¼Œå³å¯è®©èœœèœ‚è¿›è¡Œè¿åŠ¨ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7fa4dce3ec94423785df187b612d119a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=ZqEcLUeGWWhtQAdLLRwTOMnA70w%3D" alt="" loading="lazy"/></p>
<p><strong>æ­¤å¤–</strong>ï¼Œå½“èœœèœ‚ç¢°æ’åˆ°çº¿æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åšä¸€ä¸ªåé€€æ•ˆæœï¼Œç„¶åç»§ç»­è¿›æ”»ï¼Œå½¢æˆä¸æ–­æ”»å‡»çš„æ•ˆæœã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3de4f85eef0e4e55a97039269cc97549~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=1CdQUbxuLwAgl%2F2cjiO24wEOiqo%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-6">4. èœ‚å·¢</h3>
<p><strong>èœ‚å·¢</strong>çš„é€»è¾‘å°±ç›¸å¯¹ç®€å•äº†ï¼Œå°±æ˜¯é€šè¿‡è®¡æ—¶ï¼Œå®šæ—¶åˆ›å»ºæŒ‡å®šæ•°é‡çš„èœœèœ‚ï¼Œç»™èœœèœ‚æ·»åŠ ç¢°æ’ç›¸å…³ç»„ä»¶ï¼Œä»¥åŠæ§åˆ¶è„šæœ¬å³å¯ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc2966716c7849eba02a58d6c758b218~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=%2BlG0NZ4wHsthnILtwbD9e2KOtVk%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">3. æ¸¸æˆå®æˆ˜</h2>
<h3 data-id="heading-8">1.èµ„æºå‡†å¤‡</h3>
<p><strong>ç®€å•</strong>å‡†å¤‡ä¸€æ‰¹æ¸¸æˆæ‰€éœ€çš„èµ„æºï¼ŒåŒ…æ‹¬<code>èœ‚å·¢ã€åœ°æ¿ã€èƒœåˆ©/å¤±è´¥ç•Œé¢ã€æœ¨å¤´ã€ç‹—ç‹—ã€æ°´å’Œèœœèœ‚</code>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/865345466b454f2ca27c7a920f6915b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=sOTbrfaTjh3MWNPm0goax4ZOINw%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-9">2.æ‹¼UI</h3>
<p><strong>ç•Œé¢</strong>çš„æ‹¼æ¥æ¯”è¾ƒç®€å•ï¼Œä»ä¸Šåˆ°ä¸‹åˆ†åˆ«æ˜¯<code>æ¸¸æˆç®¡ç†å™¨ã€ç”»çº¿å®¹å™¨ã€å…³å¡ç®¡ç†å™¨ã€å€’è®¡æ—¶æ ‡ç­¾ã€èƒœåˆ©/å¤±è´¥ç•Œé¢</code>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5fd42427e0e049ccb27d29ba12b0f79c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=QiS7vrKYj%2FvxBY%2Bj4NRE4iw8DDI%3D" alt="" loading="lazy"/></p>
<p><strong>å…³å¡</strong>é€šè¿‡é¢„åˆ¶ä½“è¿›è¡Œç¼–è¾‘ï¼Œåœ¨å…³å¡ç®¡ç†å™¨ä¸­è¿›è¡ŒåŠ¨æ€åŠ è½½ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3543e1636ae84d09aadedda603d5409f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=9445tIKbQnOGB8VLKqVhZCxeT5k%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-10">3.å†™ä»£ç </h3>
<p><strong>ç”±äº</strong>æ–‡ç« ç¯‡å¹…é—®é¢˜ï¼Œä¸‹é¢åªå±•ç¤ºæ¸¸æˆçš„æ ¸å¿ƒæºç ï¼Œå®æˆ˜å®Œæ•´æºç å¯åœ¨æ–‡æœ«è·å–ã€‚</p>
<p><strong>(1)ç”»çº¿ç®¡ç†å™¨</strong></p>
<p><strong>é¦–å…ˆ</strong>é€šè¿‡è§¦æ‘¸äº‹ä»¶çš„å››å¤§å¤©ç‹è¿›è¡Œç›‘å¬ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d710d60c4f0479ca09e086f97596b40~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=VbQfIg5QRK3rLllVmAoI7C2H8q8%3D" alt="" loading="lazy"/></p>
<p><strong>è§¦æ‘¸å¼€å§‹æ—¶</strong>ï¼Œåˆ›å»ºæ–°èŠ‚ç‚¹ã€æ·»åŠ <code>Graphics</code>ç»„ä»¶ã€ç”»çº¿èµ·ç‚¹ç§»åŠ¨åˆ°è§¦æ‘¸ä½ç½®ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1a004ef76141486d8bcf8759cbf7aadd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=8apzAyToJ2Hm233dFEMLgQRwXxM%3D" alt="" loading="lazy"/></p>
<p><strong>è§¦æ‘¸ç§»åŠ¨æ—¶</strong>ï¼Œæ¯ç§»åŠ¨åˆ°ä¸€ä¸ªä½ç½®ï¼Œç”»çº¿ä¸€æ¬¡ï¼Œå¹¶è®°å½•ç‚¹ä½ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1fd1223838f7450daeca3fff6c95773c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=Cp3yE8hQHzK9XNDRd0B0vjSKNGc%3D" alt="" loading="lazy"/></p>
<p><strong>ä¸Šè¿°è¿‡ç¨‹</strong>å¯ä»¥è¿›è¡Œç®€å•æ£€æµ‹ï¼Œé¿å…é¢‘ç¹ç”»çº¿ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e0d0ba3b76b14f8d953221ec67d9b820~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=ijjTa%2BwiKWYqoH1qFDL%2BqDVQVBI%3D" alt="" loading="lazy"/></p>
<p><strong>ç”»çº¿ç»“æŸæ—¶</strong>ï¼Œç»™è®°å½•çš„æ‰€æœ‰ç‚¹ä½é—´çš„çº¿åŠ¨æ€æ·»åŠ ç»„ä»¶(<strong>æ ¸å¿ƒ</strong>)ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/022f315f268c4c4d9dfb4fa8427eb4c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=sD03eSU5%2FJw3UHX2SXHgCsITYLM%3D" alt="" loading="lazy"/></p>
<p><strong>(2)ç‹—ç‹—æ§åˆ¶å™¨</strong></p>
<p><strong>é€šè¿‡</strong><code>Contact2DType.BEGIN_CONTACT</code>äº‹ä»¶ç›‘å¬ç¢°æ’äº‹ä»¶ï¼Œåˆå§‹çŠ¶æ€ä¸º<code>Static</code>é™æ­¢ä¸åŠ¨ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5afca027cc54437bb82b2aaf3341ea62~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=OeKpx8gREGcax2lBRpR8MB8XwcA%3D" alt="" loading="lazy"/></p>
<p><strong>é€šè¿‡</strong>åå­—ç®€å•åˆ¤æ–­ç¢°æ’åˆ°äº†å“ªäº›ç‰©ä½“ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c604a6e5ca44c6381bc24822517e380~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=X5fvAmix2YGfjxCTKsukiAvE5QA%3D" alt="" loading="lazy"/></p>
<p><strong>(3)èœœèœ‚æ§åˆ¶å™¨</strong></p>
<p><strong>èœœèœ‚çš„è¿›æ”»</strong>ï¼šè®¡ç®—æ–¹å‘å‘é‡ï¼Œæ–½åŠ åŠ›ï¼Œä½¿èœœèœ‚è¿›è¡Œè¿åŠ¨ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a2cabd9760344923b337d0c913215c2f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=1H02RHmJppbeKCFKMO4FwTy6g3g%3D" alt="" loading="lazy"/></p>
<p><strong>èœœèœ‚çš„åæ’¤</strong>ï¼šè®¡ç®—åæ’¤æ–¹å‘ï¼Œé€šè¿‡<code>linearVelocity</code>çº¿æ€§é€Ÿåº¦è¿›è¡Œåæ’¤ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c61c3f22cf9442c823ebc7c63a72ddb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=frUcuYoiBm8zkHY4tAzzzhdWDTc%3D" alt="" loading="lazy"/></p>
<p><strong>(4)èœ‚å·¢æ§åˆ¶å™¨</strong></p>
<p><strong>èœœèœ‚çš„äº§ç”Ÿ</strong>ï¼šåˆ›å»ºèœœèœ‚ã€æ·»åŠ åˆšä½“ã€æ·»åŠ ç¢°æ’ä½“ã€æ·»åŠ èœœèœ‚ç®¡ç†å™¨ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e0b5be12de64377aac50f6cc5fbdcf7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=wKonoDx37Yf2URqKNAHWkY0K7tY%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-11">4.æ•ˆæœæ¼”ç¤º</h3>
<p><strong>å…³å¡1</strong>ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40d0e692c1fa4f4e9e9b510fba0b9959~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=GUekKdO8qptHvYi7%2B2Nj2cAohZI%3D" alt="" loading="lazy"/></p>
<p><strong>å…³å¡2</strong>ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73d1d4fd0c19434faddd0c8daef57f2a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768176094&amp;x-signature=09KfKp4O6YSREzA4GsGzwZ4Ne60%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-12">ç»“è¯­</h2>
<p><strong>ä»¥ä¸Š</strong>å°±æ˜¯çƒ­é—¨ä¹°é‡æ¸¸æˆã€Šç”»çº¿æ•‘ç‹—ã€‹çš„æ‹†è§£ï¼Œä¸çŸ¥é“å°ä¼™ä¼´ä»¬å­¦åºŸäº†æ²¡æœ‰ï¼Ÿ</p>
<p>æœ¬æ–‡<strong>å®æˆ˜æºç </strong>å¯é€šè¿‡<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FFOi5gCiGzF3LnT03DpPMXA" target="_blank" title="https://mp.weixin.qq.com/s/FOi5gCiGzF3LnT03DpPMXA" ref="nofollow noopener noreferrer"><strong>é˜…è¯»åŸæ–‡</strong></a>è·å–ã€‚</p>
<hr/>
<p><strong>æˆ‘æ˜¯"äº¿å…ƒç¨‹åºå‘˜"ï¼Œä¸€ä½æœ‰ç€8å¹´æ¸¸æˆè¡Œä¸šç»éªŒçš„ä¸»ç¨‹ã€‚åœ¨æ¸¸æˆå¼€å‘ä¸­ï¼Œå¸Œæœ›èƒ½ç»™åˆ°æ‚¨å¸®åŠ©, ä¹Ÿå¸Œæœ›é€šè¿‡æ‚¨èƒ½å¸®åŠ©åˆ°å¤§å®¶ã€‚</strong></p>
<p>AD:ç¬”è€…çº¿ä¸Šçš„å°æ¸¸æˆã€Šæ‰“èºä¸é—¯å…³ã€‹ã€Šè´ªåƒè›‡æŒæœºç»å…¸ã€‹ã€Šé‡åŠ›è¿·å®«çƒã€‹ã€Šå¡«è‰²ä¹‹æ—…ã€‹ã€Šæ–¹å—æŒæœºç»å…¸ã€‹å¤§å®¶å¯ä»¥è‡ªè¡Œç‚¹å‡»æœç´¢ä½“éªŒã€‚</p>
<p>å®ä¸ç›¸ç’ï¼Œæƒ³è¦ä¸ª<strong>èµ</strong>å’Œ<strong>çˆ±å¿ƒ</strong>ï¼è¯·æŠŠè¯¥æ–‡ç« <strong>åˆ†äº«</strong>ç»™ä½ è§‰å¾—æœ‰éœ€è¦çš„å…¶ä»–å°ä¼™ä¼´ã€‚è°¢è°¢ï¼</p>
<p>æ¨èæ–‡ç« ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FFOi5gCiGzF3LnT03DpPMXA" target="_blank" title="https://mp.weixin.qq.com/s/FOi5gCiGzF3LnT03DpPMXA" ref="nofollow noopener noreferrer">äº¿å…ƒCocoså°æ¸¸æˆå®æˆ˜åˆé›†</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FXLCknL3fJDubec2GW6KLFA" target="_blank" title="https://mp.weixin.qq.com/s/XLCknL3fJDubec2GW6KLFA" ref="nofollow noopener noreferrer">Cocosæ¸¸æˆå¦‚ä½•æ¥å…¥å®‰å“ç©¿å±±ç”²å¹¿å‘Šå˜ç°ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F3_VrSld4KnDKY_7hxjSoKg" target="_blank" title="https://mp.weixin.qq.com/s/3_VrSld4KnDKY_7hxjSoKg" ref="nofollow noopener noreferrer">ä½ çŸ¥é“å’Œä¸çŸ¥é“çš„å¾®ä¿¡å°æ¸¸æˆå¸¸ç”¨APIæ•´ç†ï¼Œèµ¶ç´§æ”¶è—ç”¨èµ·æ¥~</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F0Lj24VHJ-pL8z82hHqQLiA" target="_blank" title="https://mp.weixin.qq.com/s/0Lj24VHJ-pL8z82hHqQLiA" ref="nofollow noopener noreferrer">Cocosæ¸¸æˆå¦‚ä½•å¿«é€Ÿæ¥å…¥æŠ–éŸ³å°æ¸¸æˆå¹¿å‘Šå˜ç°ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FZ7DusUJA2v1IFZDFtBsueg" target="_blank" title="https://mp.weixin.qq.com/s/Z7DusUJA2v1IFZDFtBsueg" ref="nofollow noopener noreferrer">å¦‚ä½•åœ¨CocosCreator3.8ä¸­å®ç°å‰²ç»³å­æ¸¸æˆæ•ˆæœ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F3BzzFBzeVAO-a6LPTeFTrA" target="_blank" title="https://mp.weixin.qq.com/s/3BzzFBzeVAO-a6LPTeFTrA" ref="nofollow noopener noreferrer">å¦‚ä½•åœ¨CocosCreator3.8ä¸­å®ç°åŠ¨æ€åˆ‡å‰²æ¨¡å‹ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FZIph332u_r24OTY4r6_jow" target="_blank" title="https://mp.weixin.qq.com/s/ZIph332u_r24OTY4r6_jow" ref="nofollow noopener noreferrer">Cocosæ¸¸æˆå¼€å‘ä¸­çš„è´´èŠ±æ•ˆæœ</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰æ³¨æ„åŠ å·¥ï¼šè®©ä½ çš„å›¾è¡¨æŠ“ä½è¯»è€…çš„çœ¼çƒ]]></title>    <link>https://juejin.cn/post/7591350620188999686</link>    <guid>https://juejin.cn/post/7591350620188999686</guid>    <pubDate>2026-01-04T15:08:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591350620188999686" data-draft-id="7591510742634233919" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰æ³¨æ„åŠ å·¥ï¼šè®©ä½ çš„å›¾è¡¨æŠ“ä½è¯»è€…çš„çœ¼çƒ"/> <meta itemprop="keywords" content="Python,æ•°æ®å¯è§†åŒ–,æ•°æ®åˆ†æ"/> <meta itemprop="datePublished" content="2026-01-04T15:08:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="databook"/> <meta itemprop="url" content="https://juejin.cn/user/3526889035006702"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰æ³¨æ„åŠ å·¥ï¼šè®©ä½ çš„å›¾è¡¨æŠ“ä½è¯»è€…çš„çœ¼çƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3526889035006702/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    databook
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T15:08:56.000Z" title="Sun Jan 04 2026 15:08:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ èµ°è¿›ä¸€ä¸ªæŒ¤æ»¡äººçš„æˆ¿é—´ï¼Œæœ‹å‹å‘ä½ æ‹›æ‰‹--ä½ å‡ ä¹ç«‹åˆ»å°±èƒ½çœ‹åˆ°ä»–ã€‚</p>
<p>è¿™æ˜¯å› ä¸ºâ€œæ‹›æ‰‹â€è¿™ä¸ªåŠ¨ä½œåœ¨ä½ çš„å¤§è„‘è¿›è¡Œæ·±å…¥æ€è€ƒä¹‹å‰ï¼Œå°±å·²ç»è¢«æ³¨æ„åˆ°äº†ã€‚</p>
<p>å†æ¯”å¦‚å½“ä½ èµ°åœ¨ç†™ç†™æ”˜æ”˜çš„å¤§è¡—ä¸Šï¼Œå¦‚æœæ‰€æœ‰äººç©¿çš„éƒ½æ˜¯é»‘ç°è‰²çš„å¤§è¡£ï¼Œè€Œæ­¤æ—¶æœ‰ä¸€ä¸ªäººç©¿ç€é²œçº¢è‰²çš„é£è¡£ï¼Œä½ ä¼šçœ‹å“ªé‡Œï¼Ÿ</p>
<p>æ¯«æ— ç–‘é—®ï¼Œä½ çš„ç›®å…‰ä¼šç¬é—´è¢«é‚£æŠ¹çº¢è‰²å¸å¼•ã€‚</p>
<p>è¿™å°±æ˜¯<strong>å‰æ³¨æ„åŠ å·¥</strong>ï¼šæˆ‘ä»¬çš„å¤§è„‘èƒ½åœ¨æçŸ­æ—¶é—´å†…ï¼ˆçº¦200-250æ¯«ç§’ï¼‰è‡ªåŠ¨æ£€æµ‹åˆ°æŸäº›è§†è§‰ç‰¹å¾ï¼Œè€Œæ— éœ€æˆ‘ä»¬æœ‰æ„è¯†åœ°å»å¯»æ‰¾ã€‚</p>
<p>åœ¨æ•°æ®å¯è§†åŒ–ä¸­ï¼Œ<strong>å‰æ³¨æ„åŠ å·¥</strong>å°±æ˜¯æˆ‘ä»¬ç”¨æ¥å¼•å¯¼è¯»è€…æ³¨æ„åŠ›çš„â€œè§†è§‰é­”æœ¯â€ã€‚</p>
<p>é€šè¿‡å·§å¦™åœ°æ”¹å˜é¢œè‰²ã€å¤§å°ã€å½¢çŠ¶ç­‰è§†è§‰å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥è®©å›¾è¡¨ä¸­çš„å…³é”®ä¿¡æ¯ï¼ˆå¦‚æœ€å¤§å€¼ã€æœ€å°å€¼ã€å¼‚å¸¸å€¼ï¼‰åƒæœ‹å‹æ‹›æ‰‹ä¸€æ ·â€œè·³å‡ºæ¥â€ï¼Œç¬¬ä¸€æ—¶é—´æŠ“ä½è¯»è€…çš„çœ¼çƒã€‚</p>
<h2 data-id="heading-0">1. å‰æ³¨æ„åŠ å·¥çš„å®ç”¨æŠ€å·§</h2>
<ol>
<li><strong>å°‘å³æ˜¯å¤š</strong>ï¼šä¸è¦è¿‡åº¦ä½¿ç”¨çªå‡ºæ•ˆæœï¼Œå¦åˆ™ä¼šå¤±å»ç„¦ç‚¹</li>
<li><strong>ä¸€è‡´æ€§åŸåˆ™</strong>ï¼šåœ¨æ•´ä¸ªæŠ¥å‘Šæˆ–ä»ªè¡¨æ¿ä¸­ä½¿ç”¨ç›¸åŒçš„çªå‡ºé¢œè‰²ç¼–ç </li>
<li><strong>è€ƒè™‘è‰²ç›²ç”¨æˆ·</strong>ï¼šé¿å…ä»…ä¾é é¢œè‰²åŒºåˆ†ï¼Œå¯ç»“åˆå½¢çŠ¶ã€çº¹ç†ç­‰</li>
<li><strong>ä¸Šä¸‹æ–‡ç›¸å…³</strong>ï¼šæ ¹æ®æ•°æ®ç‰¹ç‚¹å’Œè§‚ä¼—èƒŒæ™¯é€‰æ‹©åˆé€‚çš„çªå‡ºæ–¹å¼</li>
<li><strong>æµ‹è¯•æ•ˆæœ</strong>ï¼šè®©å…¶ä»–äººæŸ¥çœ‹ä½ çš„å›¾è¡¨ï¼Œç¡®è®¤çªå‡ºæ•ˆæœæ˜¯å¦è¾¾åˆ°é¢„æœŸ</li>
</ol>
<h2 data-id="heading-1">2. å‰æ³¨æ„åŠ å·¥å®ä¾‹</h2>
<p>æ¦‚å¿µä»‹ç»å®Œäº†ï¼Œä¸‹é¢ç›´æ¥çœ‹ä»£ç ï¼Œçœ‹çœ‹å®é™…æƒ…å†µä¸‹å¦‚ä½•ä½¿ç”¨<strong>å‰æ³¨æ„åŠ å·¥</strong>æ¥æé«˜æˆ‘ä»¬çš„å¯è§†åŒ–æ•ˆæœã€‚</p>
<h3 data-id="heading-2">2.1. çªå‡ºæœ€å¤§å€¼å’Œæœ€å°å€¼</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç¤ºä¾‹1ï¼šçªå‡ºæœ€å¤§å€¼å’Œæœ€å°å€¼</span>
<span class="hljs-comment"># åˆ›å»ºæ•°æ®</span>
np.random.seed(<span class="hljs-number">42</span>)
categories = [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'D'</span>, <span class="hljs-string">'E'</span>, <span class="hljs-string">'F'</span>, <span class="hljs-string">'G'</span>, <span class="hljs-string">'H'</span>]
values = np.random.randint(<span class="hljs-number">10</span>, <span class="hljs-number">100</span>, size=<span class="hljs-number">8</span>)

<span class="hljs-comment"># æ‰¾å‡ºæœ€å¤§å€¼å’Œæœ€å°å€¼çš„ç´¢å¼•</span>
max_idx = np.argmax(values)
min_idx = np.argmin(values)

<span class="hljs-comment"># åˆ›å»ºå›¾è¡¨</span>
fig, (ax1, ax2) = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">14</span>, <span class="hljs-number">6</span>))

<span class="hljs-comment"># å·¦å›¾ï¼šæ²¡æœ‰å‰æ³¨æ„åŠ å·¥</span>
bars1 = ax1.bar(categories, values, color=<span class="hljs-string">'lightblue'</span>, edgecolor=<span class="hljs-string">'black'</span>)

<span class="hljs-comment"># å³å›¾ï¼šæœ‰å‰æ³¨æ„åŠ å·¥ï¼ˆçªå‡ºæœ€å¤§æœ€å°å€¼ï¼‰</span>
colors = [<span class="hljs-string">'lightblue'</span>] * <span class="hljs-built_in">len</span>(values)
colors[max_idx] = <span class="hljs-string">'#FF6B6B'</span>  <span class="hljs-comment"># çº¢è‰²çªå‡ºæœ€å¤§å€¼</span>
colors[min_idx] = <span class="hljs-string">'#4ECDC4'</span>  <span class="hljs-comment"># é’è‰²çªå‡ºæœ€å°å€¼</span>

bars2 = ax2.bar(categories, values, color=colors, edgecolor=<span class="hljs-string">'black'</span>)

<span class="hljs-comment"># åœ¨æœ€å¤§å€¼å’Œæœ€å°å€¼ä¸Šæ·»åŠ æ ‡ç­¾</span>
ax2.text(max_idx, values[max_idx] + <span class="hljs-number">2</span>, <span class="hljs-string">f'æœ€å¤§: <span class="hljs-subst">{values[max_idx]}</span>'</span>,
         ha=<span class="hljs-string">'center'</span>, fontweight=<span class="hljs-string">'bold'</span>, color=<span class="hljs-string">'#FF6B6B'</span>)
ax2.text(min_idx, values[min_idx] + <span class="hljs-number">2</span>, <span class="hljs-string">f'æœ€å°: <span class="hljs-subst">{values[min_idx]}</span>'</span>,
         ha=<span class="hljs-string">'center'</span>, fontweight=<span class="hljs-string">'bold'</span>, color=<span class="hljs-string">'#4ECDC4'</span>)

plt.tight_layout()
plt.show()
</code></pre>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f5b3cfac63c404bae4e199caaea3ea0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768144135&amp;x-signature=JIDdIdb1RTsmPmZg86kopP8HIEg%3D" alt="" loading="lazy"/></p>
<p>å·¦å›¾ä¸­ï¼Œæ‰€æœ‰æŸ±å­éƒ½æ˜¯ç›¸åŒçš„è“è‰²ï¼Œè¯»è€…éœ€è¦é€ä¸ªæ¯”è¾ƒæ‰èƒ½æ‰¾å‡ºæœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚</p>
<p>å³å›¾ä¸­ï¼Œæœ€å¤§å€¼ç”¨é†’ç›®çš„çº¢è‰²æ ‡å‡ºï¼Œæœ€å°å€¼ç”¨é’è‰²æ ‡å‡ºï¼Œè¯»è€…ä¸€çœ¼å°±èƒ½çœ‹åˆ°å…³é”®æ•°æ®ç‚¹ã€‚</p>
<p><strong>å‰æ³¨æ„åŠ å·¥çš„å¥½å¤„</strong>ï¼šå°±åƒåœ¨äººç¾¤ä¸­ä¸ºé‡è¦äººç‰©æˆ´ä¸Šç‰¹åˆ«çš„å¸½å­ï¼Œè¯»è€…æ— éœ€è´¹åŠ›å¯»æ‰¾å°±èƒ½ç«‹å³è¯†åˆ«å…³é”®æ•°æ®ç‚¹ã€‚</p>
<h3 data-id="heading-3">2.2. çªå‡ºå¼‚å¸¸å€¼</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç¤ºä¾‹2ï¼šçªå‡ºå¼‚å¸¸å€¼</span>
<span class="hljs-comment"># åˆ›å»ºåŒ…å«å¼‚å¸¸å€¼çš„æ•°æ®</span>
np.random.seed(<span class="hljs-number">42</span>)
data_normal = np.random.normal(<span class="hljs-number">50</span>, <span class="hljs-number">10</span>, <span class="hljs-number">100</span>)
data_outliers = np.array([<span class="hljs-number">5</span>, <span class="hljs-number">125</span>, <span class="hljs-number">130</span>])  <span class="hljs-comment"># å¼‚å¸¸å€¼</span>
all_data = np.concatenate([data_normal, data_outliers])

<span class="hljs-comment"># è¯†åˆ«å¼‚å¸¸å€¼ï¼ˆç®€å•æ–¹æ³•ï¼šè¶…å‡ºå¹³å‡å€¼Â±2å€æ ‡å‡†å·®ï¼‰</span>
mean_val = np.mean(all_data)
std_val = np.std(all_data)
outlier_indices = np.where((all_data &lt; mean_val - <span class="hljs-number">2</span>*std_val) | (all_data &gt; mean_val + <span class="hljs-number">2</span>*std_val))[<span class="hljs-number">0</span>]

<span class="hljs-comment"># åˆ›å»ºå›¾è¡¨</span>
fig, (ax1, ax2) = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">14</span>, <span class="hljs-number">6</span>))

<span class="hljs-comment"># å·¦å›¾ï¼šæ²¡æœ‰å‰æ³¨æ„åŠ å·¥</span>
scatter1 = ax1.scatter(<span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(all_data)), all_data, alpha=<span class="hljs-number">0.7</span>, c=<span class="hljs-string">'gray'</span>, s=<span class="hljs-number">50</span>)
ax1.axhline(y=mean_val, color=<span class="hljs-string">'black'</span>, linestyle=<span class="hljs-string">'--'</span>, alpha=<span class="hljs-number">0.5</span>, label=<span class="hljs-string">f'å¹³å‡å€¼: <span class="hljs-subst">{mean_val:<span class="hljs-number">.1</span>f}</span>'</span>)
ax1.axhline(y=mean_val + <span class="hljs-number">2</span>*std_val, color=<span class="hljs-string">'red'</span>, linestyle=<span class="hljs-string">':'</span>, alpha=<span class="hljs-number">0.5</span>, label=<span class="hljs-string">'Â±2æ ‡å‡†å·®'</span>)
ax1.axhline(y=mean_val - <span class="hljs-number">2</span>*std_val, color=<span class="hljs-string">'red'</span>, linestyle=<span class="hljs-string">':'</span>, alpha=<span class="hljs-number">0.5</span>)

<span class="hljs-comment"># å³å›¾ï¼šæœ‰å‰æ³¨æ„åŠ å·¥ï¼ˆçªå‡ºå¼‚å¸¸å€¼ï¼‰</span>
colors = [<span class="hljs-string">'gray'</span>] * <span class="hljs-built_in">len</span>(all_data)
sizes = [<span class="hljs-number">50</span>] * <span class="hljs-built_in">len</span>(all_data)

<span class="hljs-comment"># çªå‡ºå¼‚å¸¸å€¼</span>
<span class="hljs-keyword">for</span> idx <span class="hljs-keyword">in</span> outlier_indices:
    colors[idx] = <span class="hljs-string">'#FF6B6B'</span>  <span class="hljs-comment"># çº¢è‰²</span>
    sizes[idx] = <span class="hljs-number">150</span>  <span class="hljs-comment"># æ›´å¤§</span>

scatter2 = ax2.scatter(<span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(all_data)), all_data, alpha=<span class="hljs-number">0.7</span>, c=colors, s=sizes)
ax2.axhline(y=mean_val, color=<span class="hljs-string">'black'</span>, linestyle=<span class="hljs-string">'--'</span>, alpha=<span class="hljs-number">0.5</span>, label=<span class="hljs-string">f'å¹³å‡å€¼: <span class="hljs-subst">{mean_val:<span class="hljs-number">.1</span>f}</span>'</span>)
ax2.axhline(y=mean_val + <span class="hljs-number">2</span>*std_val, color=<span class="hljs-string">'red'</span>, linestyle=<span class="hljs-string">':'</span>, alpha=<span class="hljs-number">0.5</span>, label=<span class="hljs-string">'Â±2æ ‡å‡†å·®'</span>)
ax2.axhline(y=mean_val - <span class="hljs-number">2</span>*std_val, color=<span class="hljs-string">'red'</span>, linestyle=<span class="hljs-string">':'</span>, alpha=<span class="hljs-number">0.5</span>)

plt.tight_layout()
plt.show()
</code></pre>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/75dae986c53b4fb0ad21e5223e0e7c26~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768144135&amp;x-signature=VsBftwhA5%2BeJlU93WsU0Gjv%2BE1o%3D" alt="" loading="lazy"/></p>
<p>å·¦å›¾ä¸­ï¼Œå¼‚å¸¸å€¼æ··åœ¨æ™®é€šæ•°æ®ç‚¹ä¸­ï¼Œéš¾ä»¥ç«‹å³è¯†åˆ«ã€‚</p>
<p>å³å›¾ä¸­ï¼Œå¼‚å¸¸å€¼ç”¨æ›´å¤§çš„çº¢è‰²ç‚¹çªå‡ºæ˜¾ç¤ºï¼Œå³ä½¿æ•°æ®é‡å¾ˆå¤§ï¼Œè¯»è€…ä¹Ÿèƒ½ç«‹å³æ³¨æ„åˆ°è¿™äº›ç‰¹æ®Šç‚¹ã€‚</p>
<p><strong>å‰æ³¨æ„åŠ å·¥çš„å¥½å¤„</strong>ï¼šå°±åƒåœ¨å¹³é™æ¹–é¢ä¸Šæ ‡è®°å‡ºæ¶Ÿæ¼ªçš„èµ·æºï¼Œå¼‚å¸¸å€¼ä¸å†éšè—åœ¨æ•°æ®æµ·æ´‹ä¸­ï¼Œè€Œæ˜¯æˆä¸ºåˆ†æçš„é‡ç‚¹ã€‚</p>
<h3 data-id="heading-4">2.3. çªå‡ºè¶‹åŠ¿å˜åŒ–ç‚¹</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç¤ºä¾‹3ï¼šçªå‡ºè¶‹åŠ¿å˜åŒ–ç‚¹</span>
<span class="hljs-comment"># åˆ›å»ºåŒ…å«è¶‹åŠ¿å˜åŒ–çš„æ—¶é—´åºåˆ—æ•°æ®</span>
np.random.seed(<span class="hljs-number">42</span>)
time_points = np.arange(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>)
trend_change_point = <span class="hljs-number">45</span>

<span class="hljs-comment"># åˆ†æ®µåˆ›å»ºè¶‹åŠ¿æ•°æ®</span>
trend1 = <span class="hljs-number">30</span> + <span class="hljs-number">0.5</span> * np.arange(<span class="hljs-number">0</span>, trend_change_point) + np.random.normal(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, trend_change_point)
trend2 = trend1[-<span class="hljs-number">1</span>] - <span class="hljs-number">0.8</span> * np.arange(<span class="hljs-number">0</span>, <span class="hljs-number">100</span> - trend_change_point) + np.random.normal(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">100</span> - trend_change_point)
data = np.concatenate([trend1, trend2])

<span class="hljs-comment"># åˆ›å»ºå›¾è¡¨</span>
fig, (ax1, ax2) = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">14</span>, <span class="hljs-number">6</span>))

<span class="hljs-comment"># å·¦å›¾ï¼šæ²¡æœ‰å‰æ³¨æ„åŠ å·¥</span>
line1 = ax1.plot(time_points, data, color=<span class="hljs-string">'gray'</span>, alpha=<span class="hljs-number">0.8</span>, linewidth=<span class="hljs-number">2</span>)

<span class="hljs-comment"># å³å›¾ï¼šæœ‰å‰æ³¨æ„åŠ å·¥ï¼ˆçªå‡ºè¶‹åŠ¿å˜åŒ–ç‚¹ï¼‰</span>
line2 = ax2.plot(time_points, data, color=<span class="hljs-string">'gray'</span>, alpha=<span class="hljs-number">0.6</span>, linewidth=<span class="hljs-number">2</span>)

<span class="hljs-comment"># çªå‡ºè¶‹åŠ¿å˜åŒ–åŒºåŸŸ</span>
ax2.axvspan(trend_change_point-<span class="hljs-number">5</span>, trend_change_point+<span class="hljs-number">5</span>, alpha=<span class="hljs-number">0.3</span>, color=<span class="hljs-string">'#FF6B6B'</span>, label=<span class="hljs-string">'è¶‹åŠ¿å˜åŒ–åŒºåŸŸ'</span>)
ax2.scatter(trend_change_point, data[trend_change_point], color=<span class="hljs-string">'#FF6B6B'</span>, s=<span class="hljs-number">200</span>, zorder=<span class="hljs-number">5</span>, label=<span class="hljs-string">'å˜åŒ–ç‚¹'</span>)
ax2.plot(time_points[:trend_change_point+<span class="hljs-number">1</span>], data[:trend_change_point+<span class="hljs-number">1</span>], color=<span class="hljs-string">'#4ECDC4'</span>, linewidth=<span class="hljs-number">3</span>, alpha=<span class="hljs-number">0.8</span>, label=<span class="hljs-string">'ä¸Šå‡è¶‹åŠ¿'</span>)
ax2.plot(time_points[trend_change_point:], data[trend_change_point:], color=<span class="hljs-string">'#45B7D1'</span>, linewidth=<span class="hljs-number">3</span>, alpha=<span class="hljs-number">0.8</span>, label=<span class="hljs-string">'ä¸‹é™è¶‹åŠ¿'</span>)

plt.tight_layout()
plt.show()
</code></pre>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8a2dbd998f5473984e0e6bd5ff15826~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768144135&amp;x-signature=RkX6bbP4BvgBLbvQevTRxvaJcIw%3D" alt="" loading="lazy"/></p>
<p>å·¦å›¾å±•ç¤ºäº†ä¸€ä¸ªå®Œæ•´çš„è¶‹åŠ¿çº¿ï¼Œä½†å˜åŒ–ç‚¹ä¸æ˜æ˜¾ã€‚</p>
<p>å³å›¾ä½¿ç”¨ä¸åŒé¢œè‰²åŒºåˆ†è¶‹åŠ¿æ®µï¼Œå¹¶ç”¨é˜´å½±åŒºåŸŸå’Œçªå‡ºç‚¹æ ‡è®°å˜åŒ–åŒºåŸŸï¼Œä½¿è¶‹åŠ¿è½¬æŠ˜ä¸€ç›®äº†ç„¶ã€‚</p>
<p><strong>å‰æ³¨æ„åŠ å·¥çš„å¥½å¤„</strong>ï¼šå°±åƒåœ¨é“è·¯åœ°å›¾ä¸Šæ ‡è®°å‡ºè½¬å¼¯å¤„ï¼Œè¯»è€…èƒ½ç«‹å³çœ‹åˆ°è¶‹åŠ¿å˜åŒ–çš„å…³é”®æ—¶åˆ»ã€‚</p>
<h3 data-id="heading-5">2.4. çªå‡ºç‰¹å®šç±»åˆ«</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç¤ºä¾‹4ï¼šçªå‡ºç‰¹å®šç±»åˆ«</span>
<span class="hljs-comment"># åˆ›å»ºé¥¼å›¾æ•°æ®</span>
categories = [<span class="hljs-string">"ç”µå­äº§å“"</span>, <span class="hljs-string">"æœè£…"</span>, <span class="hljs-string">"é£Ÿå“"</span>, <span class="hljs-string">"å®¶å±…"</span>, <span class="hljs-string">"ä¹¦ç±"</span>, <span class="hljs-string">"å…¶ä»–"</span>]
values = [<span class="hljs-number">25</span>, <span class="hljs-number">18</span>, <span class="hljs-number">22</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>]
highlight_category = <span class="hljs-string">"é£Ÿå“"</span>  <span class="hljs-comment"># è¦çªå‡ºçš„ç±»åˆ«</span>
highlight_idx = categories.index(highlight_category)

<span class="hljs-comment"># åˆ›å»ºå›¾è¡¨</span>
fig, (ax1, ax2) = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">14</span>, <span class="hljs-number">6</span>))

<span class="hljs-comment"># å·¦å›¾ï¼šæ²¡æœ‰å‰æ³¨æ„åŠ å·¥</span>
colors1 = [<span class="hljs-string">"#FF9AA2"</span>, <span class="hljs-string">"#FFB7B2"</span>, <span class="hljs-string">"#FFDAC1"</span>, <span class="hljs-string">"#E2F0CB"</span>, <span class="hljs-string">"#B5EAD7"</span>, <span class="hljs-string">"#C7CEEA"</span>]
wedges1, texts1, autotexts1 = ax1.pie(
    values, labels=categories, autopct=<span class="hljs-string">"%1.1f%%"</span>, colors=colors1, startangle=<span class="hljs-number">90</span>
)

<span class="hljs-comment"># å³å›¾ï¼šæœ‰å‰æ³¨æ„åŠ å·¥ï¼ˆçªå‡ºç‰¹å®šç±»åˆ«ï¼‰</span>
<span class="hljs-comment"># å°†çªå‡ºç±»åˆ«çš„é¢œè‰²æ”¹ä¸ºé†’ç›®çš„é¢œè‰²ï¼Œå…¶ä»–ç±»åˆ«ç”¨ç°åº¦</span>
colors2 = [<span class="hljs-string">"lightgray"</span>] * <span class="hljs-built_in">len</span>(categories)
colors2[highlight_idx] = <span class="hljs-string">"#FF6B6B"</span>  <span class="hljs-comment"># çªå‡ºç±»åˆ«ç”¨çº¢è‰²</span>

<span class="hljs-comment"># çªå‡ºæ˜¾ç¤ºï¼šå°†ç‰¹å®šç±»åˆ«"æ‹‰å‡º"</span>
explode = [<span class="hljs-number">0</span>] * <span class="hljs-built_in">len</span>(categories)
explode[highlight_idx] = <span class="hljs-number">0.1</span>

wedges2, texts2, autotexts2 = ax2.pie(
    values,
    labels=categories,
    autopct=<span class="hljs-string">"%1.1f%%"</span>,
    colors=colors2,
    explode=explode,
    startangle=<span class="hljs-number">90</span>,
)

plt.tight_layout()
plt.show()
</code></pre>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/27631577fe6442ff87cb3febe019a2d7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768144135&amp;x-signature=VVXo4UpyLMdw0BnGAD4q02R1Q1g%3D" alt="" loading="lazy"/></p>
<p>å·¦å›¾ä¸­ï¼Œæ‰€æœ‰ç±»åˆ«è§†è§‰æƒé‡ç›¸åŒï¼Œè¯»è€…éœ€è¦é˜…è¯»æ ‡ç­¾æˆ–ç™¾åˆ†æ¯”æ‰èƒ½æ‰¾åˆ°ç‰¹å®šç±»åˆ«ã€‚</p>
<p>å³å›¾ä¸­ï¼Œç›®æ ‡ç±»åˆ«è¢«"æ‹‰å‡º"å¹¶ç”¨é†’ç›®çš„çº¢è‰²æ˜¾ç¤ºï¼Œå…¶ä»–ç±»åˆ«åˆ™ç”¨ç°è‰²æ·¡åŒ–ï¼Œè¯»è€…ä¸€çœ¼å°±èƒ½çœ‹åˆ°é‡ç‚¹ã€‚</p>
<p><strong>å‰æ³¨æ„åŠ å·¥çš„å¥½å¤„</strong>ï¼šå°±åƒåœ¨åˆå”±å›¢ä¸­ä¸ºç‹¬å”±è€…æ‰“ä¸Šèšå…‰ç¯ï¼Œç‰¹å®šç±»åˆ«ç«‹å³æˆä¸ºè§†è§‰ç„¦ç‚¹ã€‚</p>
<p>åŒæ ·ï¼Œåœ¨ç»˜åˆ¶<strong>å¤šæ¡æŠ˜çº¿å›¾</strong>ï¼ˆä¹Ÿå°±æ˜¯ä¿—ç§°çš„â€œé¢æ¡å›¾â€ï¼‰æ—¶ï¼Œå¦‚æœæ¯æ¡çº¿éƒ½ç”¨é«˜é¥±å’Œåº¦çš„é¢œè‰²ï¼Œç”»é¢ä¼šéå¸¸æ··ä¹±ï¼Œè¯»è€…ä¸çŸ¥é“è¯¥çœ‹å“ªä¸€æ¡ã€‚</p>
<p>ä¹Ÿå¯ä»¥ç”¨ä¸Šé¢é¥¼å›¾ç±»ä¼¼çš„æ€è·¯ï¼Œé™ä½éé‡ç‚¹æ•°æ®çš„<strong>ä¸é€æ˜åº¦</strong>ï¼ˆ<code>Alpha</code>ï¼‰å’Œ<strong>çº¿å®½</strong>ï¼ˆ<code>Linewidth</code>ï¼‰ï¼Œåªä¿ç•™é‡ç‚¹æ•°æ®çš„é²œæ˜æ ·å¼ã€‚</p>
<p>è¿™å°±åƒèˆå°ä¸Šçš„èšå…‰ç¯ï¼Œç¯å…‰æ‰“åœ¨å“ªé‡Œï¼Œè§‚ä¼—å°±çœ‹å“ªé‡Œã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ¨¡æ‹Ÿæ—¶é—´åºåˆ—æ•°æ®</span>
x = np.linspace(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">100</span>)
<span class="hljs-comment"># ç”Ÿæˆ5æ¡å¹²æ‰°çº¿</span>
lines = [np.sin(x + i) * (<span class="hljs-number">1</span> + i/<span class="hljs-number">10</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>)]
<span class="hljs-comment"># ç”Ÿæˆ1æ¡é‡ç‚¹çº¿ï¼ˆæ¯”å¦‚è¿™æ˜¯æˆ‘ä»¬å…¬å¸çš„äº§å“ï¼‰</span>
main_line = np.sin(x) * <span class="hljs-number">2.5</span> + <span class="hljs-number">1</span>

fig, (ax1, ax2) = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">5</span>))

<span class="hljs-comment"># --- å›¾1ï¼šæ²¡æœ‰å‰æ³¨æ„åŠ å·¥ ---</span>
<span class="hljs-comment"># å…¸å‹çš„é¢æ¡å›¾ï¼Œæ‰€æœ‰çº¿éƒ½åœ¨äº‰å¤ºæ³¨æ„åŠ›</span>
<span class="hljs-keyword">for</span> i, line <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(lines):
    ax1.plot(x, line, label=<span class="hljs-string">f'Competitor <span class="hljs-subst">{i}</span>'</span>)
ax1.plot(x, main_line, label=<span class="hljs-string">'Our Product'</span>)

<span class="hljs-comment"># --- å›¾2ï¼šæœ‰å‰æ³¨æ„åŠ å·¥ ---</span>
<span class="hljs-comment"># ç­–ç•¥ï¼šå¼±åŒ–èƒŒæ™¯ï¼Œçªå‡ºå‰æ™¯</span>
<span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:
    ax1.plot(x, line) <span class="hljs-comment"># å·¦å›¾é€»è¾‘</span>
    <span class="hljs-comment"># å³å›¾é€»è¾‘ï¼šç°è‰²ã€ç»†çº¿ã€åŠé€æ˜</span>
    ax2.plot(x, line, color=<span class="hljs-string">'lightgray'</span>, linewidth=<span class="hljs-number">1</span>, alpha=<span class="hljs-number">0.6</span>)

<span class="hljs-comment"># é‡ç‚¹çº¿ï¼šæ·±é’è‰²ã€åŠ ç²—ã€ä¸é€æ˜</span>
ax2.plot(x, main_line, color=<span class="hljs-string">'teal'</span>, linewidth=<span class="hljs-number">3</span>, label=<span class="hljs-string">'Our Product'</span>)

plt.tight_layout()
plt.show()
</code></pre>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b88a68d04722404b8e0a02299f04e02c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768144135&amp;x-signature=BT2qL1g8H2ysRLSUQpqaDEdFmBk%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-6">3. æ€»ç»“</h2>
<p><strong>å‰æ³¨æ„åŠ å·¥</strong>æ˜¯æ•°æ®å¯è§†åŒ–ä¸­çš„"è§†è§‰è¯­æ³•"ï¼Œå®ƒé€šè¿‡é¢„è®¤çŸ¥çš„è§†è§‰ç‰¹å¾å¼•å¯¼è¯»è€…çš„æ³¨æ„åŠ›ã€‚</p>
<p>å°±åƒç†Ÿç»ƒçš„å¯¼æ¸¸ä¼šæŒ‡å‡ºé£æ™¯ä¸­çš„äº®ç‚¹ï¼Œæœ‰æ•ˆçš„æ•°æ®å¯è§†åŒ–åº”è¯¥å¼•å¯¼è¯»è€…ç«‹å³çœ‹åˆ°æ•°æ®æ•…äº‹ä¸­<strong>æœ€å…³é”®</strong>çš„éƒ¨åˆ†ã€‚</p>
<p>æ•°æ®å¯è§†åŒ–ä¸ä»…ä»…æ˜¯æŠŠæ•°æ®ç”»å‡ºæ¥ï¼Œæ›´æ˜¯ä¸€åœº<strong>æ³¨æ„åŠ›çš„ç®¡ç†è‰ºæœ¯</strong>ã€‚</p>
<ul>
<li><strong>ä¸è¦è®©è¯»è€…çš„çœ¼ç›å»â€œå·¥ä½œâ€</strong>ï¼šå¦‚æœä»–ä»¬éœ€è¦èŠ±å¥½å‡ ç§’é’Ÿå»æ‰¾æœ€å¤§å€¼ï¼Œé‚£æ˜¯æˆ‘ä»¬è®¾è®¡è€…çš„å¤±èŒã€‚</li>
<li><strong>åˆ©ç”¨å¯¹æ¯”</strong>ï¼šé¢œè‰²ï¼ˆäº®/æš—ï¼‰ã€å¤§å°ï¼ˆå¤§/å°ï¼‰ã€ä½ç½®ï¼ˆå‰/åï¼‰ï¼Œè¿™äº›ç‰©ç†å±æ€§çš„å¯¹æ¯”èƒ½ç¬é—´è§¦å‘å¤§è„‘çš„â€œç³»ç»Ÿ1â€ï¼ˆç›´è§‰ç³»ç»Ÿï¼‰ã€‚</li>
</ul>
<p>ä¸‹æ¬¡ä½¿ç”¨ <code>Matplotlib</code> ç»˜å›¾æ—¶ï¼Œåœ¨ <code>plt.show()</code> ä¹‹å‰ï¼Œè¯·åœä¸‹æ¥é—®è‡ªå·±ä¸€ä¸ªé—®é¢˜ï¼šâ€œ<strong>æˆ‘è¿™å¼ å›¾é‡Œï¼Œæœ€æƒ³è®©è¯»è€…ç¬¬ä¸€çœ¼çœ‹åˆ°çš„æ˜¯ä»€ä¹ˆï¼Ÿ</strong>â€</p>
<p>ä¸€æ—¦ç¡®å®šäº†ç­”æ¡ˆï¼Œå°±è¯·å¤§èƒ†åœ°ä½¿ç”¨ä¸Šè¿°æŠ€å·§ï¼ŒæŠŠå®ƒâ€œæ¨â€åˆ°è¯»è€…çœ¼å‰å§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[äº‹ä»¶å¾ªç¯ä»‹ç»]]></title>    <link>https://juejin.cn/post/7591130604430213160</link>    <guid>https://juejin.cn/post/7591130604430213160</guid>    <pubDate>2026-01-04T15:11:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591130604430213160" data-draft-id="7591330139083587599" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="äº‹ä»¶å¾ªç¯ä»‹ç»"/> <meta itemprop="keywords" content="FastAPI"/> <meta itemprop="datePublished" content="2026-01-04T15:11:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ˆé‡Œè°¢é¡¿"/> <meta itemprop="url" content="https://juejin.cn/user/3678304397695056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            äº‹ä»¶å¾ªç¯ä»‹ç»
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3678304397695056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ˆé‡Œè°¢é¡¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T15:11:06.000Z" title="Sun Jan 04 2026 15:11:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰çš„â€œç”µæ¢¯â€æ¯”å–»</h2>
<p>æŠŠå•çº¿ç¨‹ CPU æƒ³æˆ<strong>ä¸€éƒ¨åªè½½ä¸€äººçš„ç”µæ¢¯</strong>ï¼š</p>
<ul>
<li>ç”µæ¢¯é‡Œä¸€æ¬¡åªèƒ½è¿è¡Œä¸€ä¸ªäººï¼ˆåŒæ­¥å‡½æ•°ï¼‰</li>
<li>ä½†å¤§æ¥¼é‡Œ 1000 ä¸ªäººéƒ½è¦å»ä¸åŒæ¥¼å±‚ï¼ˆI/O æ“ä½œï¼šç½‘ç»œã€æ–‡ä»¶ã€æ•°æ®åº“ â€¦ï¼‰</li>
<li>å¦‚æœæ¯ä¸ªäººâ€œè‡ªå·±å¼€ç”µæ¢¯â€â†’ ç”µæ¢¯ç©ºè·‘ã€äººå µé—¨å£ï¼Œæ•ˆç‡æä½</li>
</ul>
<p>äº‹ä»¶å¾ªç¯å°±æ˜¯**â€œç”µæ¢¯è°ƒåº¦å‘˜â€**ï¼š</p>
<ol>
<li>æŠŠæ•´æ ‹æ¥¼çš„æ‰€æœ‰â€œä¸Šä¸‹æ¥¼è¯·æ±‚â€ç™»è®°åˆ°ä¸€å¼ <strong>ä»»åŠ¡æ¸…å•</strong></li>
<li>ç”µæ¢¯æ¯æ¬¡åªæ‹‰ä¸€ä¸ªâ€œèƒ½ç«‹åˆ»å‡ºå‘â€çš„äºº</li>
<li>å½“æŸäººæŒ‰ä¸‹â€œå» 15 æ¥¼â€æŒ‰é’®åï¼Œç”µæ¢¯<strong>ä¸ä¼šå‚»ç­‰ä»–èµ°åˆ° 15 æ¥¼å†å›æ¥</strong>ï¼Œè€Œæ˜¯
<ul>
<li>æŠŠâ€œåˆ°è¾¾ 15 æ¥¼åçš„äº‹â€å†™è¿›æ¸…å•ï¼ˆå›è°ƒ / Futureï¼‰</li>
<li>ç«‹åˆ»æ‹‰ä¸‹ä¸€ä½å°±ç»ªçš„äºº</li>
</ul>
</li>
<li>15 æ¥¼æŒ‰é’®äº®èµ·ï¼ˆI/O å®Œæˆï¼‰â†’ è°ƒåº¦å‘˜å†æŠŠâ€œåç»­ä»»åŠ¡â€é‡æ–°å¡è¿›ç”µæ¢¯</li>
</ol>
<p>ç»“æœï¼šä¸€éƒ¨ç”µæ¢¯ï¼ˆå•çº¿ç¨‹ï¼‰<strong>åœ¨ä»»æ„æ—¶åˆ»éƒ½è½½ç€â€œå°±ç»ªâ€çš„äºº</strong>ï¼Œ
è€Œâ€œç­‰äººâ€çš„æ—¶é—´è¢«æ‹¿å»å¹²åˆ«çš„äº‹ï¼Œ<strong>å®è§‚ä¸Š 1000 ä¸ªäººåŒæ—¶ç§»åŠ¨</strong>â€”â€”è¿™å°±æ˜¯å¹¶å‘ã€‚</p>
<hr/>
<h2 data-id="heading-1">æŠ€æœ¯æ˜ å°„</h2>





























<table><thead><tr><th>æ¯”å–»</th><th>çœŸå®æœ¯è¯­</th></tr></thead><tbody><tr><td>ä»»åŠ¡æ¸…å•</td><td>å°±ç»ªé˜Ÿåˆ—ï¼ˆready queueï¼‰</td></tr><tr><td>ç”µæ¢¯</td><td>çº¿ç¨‹ï¼ˆä¸»çº¿ç¨‹ï¼‰</td></tr><tr><td>æŒ‰é’®äº®èµ·</td><td>å†…æ ¸ epoll/select è¿”å›å¯è¯»/å¯å†™äº‹ä»¶</td></tr><tr><td>åˆ°è¾¾åçš„äº‹</td><td>å›è°ƒã€åç¨‹ resumeã€Future.set_result()</td></tr><tr><td>è°ƒåº¦å‘˜</td><td>äº‹ä»¶å¾ªç¯å¯¹è±¡ (asyncio.get_event_loop())</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-2">ä¸ºä»€ä¹ˆèƒ½â€œå¼‚æ­¥â€åˆâ€œå¹¶å‘â€</h2>
<ol>
<li>
<p><strong>å¼‚æ­¥</strong><br/>
è°ƒç”¨ <code>await sock.recv(1024)</code> æ—¶ï¼Œåç¨‹æŠŠâ€œå‰©ä½™ä»£ç â€å°è£…æˆå›è°ƒæŒ‚åˆ°äº‹ä»¶å¾ªç¯ï¼Œ<br/>
ä¸»çº¿ç¨‹ç«‹åˆ»å»æ‰§è¡Œä¸‹ä¸€ä¸ªå°±ç»ªä»»åŠ¡ï¼›<br/>
å½“ socket ç¼“å†²åŒºæ”¶åˆ°æ•°æ® â†’ äº‹ä»¶å¾ªç¯æŠŠå›è°ƒé‡æ–°æ¨è¿›å°±ç»ªé˜Ÿåˆ— â†’ åç¨‹æ¢å¤ã€‚<br/>
å› æ­¤<strong>è°ƒç”¨è€…ä¸ä¼šé˜»å¡åœ¨ recv ä¸Š</strong>ï¼Œå½¢æˆâ€œéé˜»å¡â€æ•ˆæœã€‚</p>
</li>
<li>
<p><strong>å¹¶å‘</strong><br/>
å•çº¿ç¨‹åŒä¸€æ—¶åˆ»åªèƒ½è·‘ä¸€æ¡ CPU æŒ‡ä»¤ï¼Œ<br/>
ä½† I/O æ“ä½œ 99 % æ—¶é—´éƒ½åœ¨<strong>ç­‰ç½‘å¡ã€ç­‰ç£ç›˜ã€ç­‰æ•°æ®åº“å“åº”</strong>ï¼›<br/>
äº‹ä»¶å¾ªç¯æŠŠè¿™äº›â€œç©ºé—²æ—¶é—´â€åˆ‡ç‰‡ï¼Œè®©<strong>æˆåƒä¸Šä¸‡ä¸ªåç¨‹è½®æµå ç”¨ CPU</strong>ï¼Œ<br/>
ä»å®è§‚æ—¶é—´è½´çœ‹ï¼Œå®ƒä»¬åƒæ˜¯â€œåŒæ—¶â€è¿›è¡Œï¼Œäºæ˜¯å®ç°äº†<strong>é«˜å¹¶å‘</strong>ã€‚</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-3">ä¸€å¼ å›¾ç§’æ‡‚</h2>
<pre><code class="hljs language-lua" lang="lua">        ä¸»çº¿ç¨‹ï¼ˆå•æ ¸ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-keyword">while</span> True:                  â”‚
â”‚     â‘  å°†å°±ç»ªåç¨‹æ¨è¿›ç”µæ¢¯      â”‚â†<span class="hljs-comment">---â”</span>
â”‚     â‘¡ è¿è¡Œç›´åˆ°é‡åˆ° I/O        â”‚    â”‚
â”‚     â‘¢ æŠŠâ€œåç»­â€æ³¨å†Œåˆ°å†…æ ¸ + å¾ªç¯ â”‚    â”‚
â”‚     â‘£ å†…æ ¸ epoll é€šçŸ¥å®Œæˆ     â”‚<span class="hljs-comment">----â”˜</span>
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>ç”µæ¢¯æ°¸è¿œæ»¡è½½ï¼Œä½†ä»ä¸ç­‰äººï¼Œååé‡ â†‘â†‘</p>
<hr/>
<h2 data-id="heading-4">ç»“è®º</h2>
<p>äº‹ä»¶å¾ªç¯ä¸æ˜¯é­”æ³•ï¼Œåªæ˜¯æŠŠ**â€œç­‰ I/O çš„æ—¶é—´â€<strong>è½¬åŒ–ä¸º</strong>â€œè¿è¡Œå…¶ä»–ä»»åŠ¡çš„æ—¶é—´â€<strong>ï¼›<br/>
åœ¨å•çº¿ç¨‹é‡Œè®©</strong>å¤§é‡ I/O å¯†é›†ä»»åŠ¡äº¤æ›¿æ¨è¿›**ï¼Œ<br/>
æ—¢é¿å…äº†å¤šçº¿ç¨‹åˆ‡æ¢å¼€é”€ï¼Œåˆè¾¾åˆ°<strong>è¿‘ä¹çº¿æ€§çš„å¹¶å‘èƒ½åŠ›</strong>â€”â€”<br/>
è¿™å°±æ˜¯å®ƒæˆä¸º Node.jsã€Python asyncioã€FastAPI çµé­‚çš„åŸå› ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RAGçŸ¥è¯†åº“è¿œè¿œæ²¡æœ‰ä½ æƒ³è±¡ä¸­çš„é‚£ä¹ˆç®€å•ï¼]]></title>    <link>https://juejin.cn/post/7591334208998031386</link>    <guid>https://juejin.cn/post/7591334208998031386</guid>    <pubDate>2026-01-04T15:14:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591334208998031386" data-draft-id="7591338980694261806" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RAGçŸ¥è¯†åº“è¿œè¿œæ²¡æœ‰ä½ æƒ³è±¡ä¸­çš„é‚£ä¹ˆç®€å•ï¼"/> <meta itemprop="keywords" content="LLM"/> <meta itemprop="datePublished" content="2026-01-04T15:14:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ™ºæ³ŠAI"/> <meta itemprop="url" content="https://juejin.cn/user/3572727470361578"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RAGçŸ¥è¯†åº“è¿œè¿œæ²¡æœ‰ä½ æƒ³è±¡ä¸­çš„é‚£ä¹ˆç®€å•ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3572727470361578/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ™ºæ³ŠAI
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T15:14:33.000Z" title="Sun Jan 04 2026 15:14:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>çŸ¥è¯†åº“ç³»ç»Ÿä½œä¸ºå¤§æ¨¡å‹åº”ç”¨çš„å…³é”®æ¨¡å—ï¼Œå§‹ç»ˆä¿æŒç€ä¸å¤§æ¨¡å‹çš„è§£è€¦ç‰¹æ€§ã€‚</p>
<p>æ­¤å‰æ–‡ä¸­æ›¾æ¢è®¨è¿‡çŸ¥è¯†åº“çš„æ„å»ºå›°å¢ƒï¼Œä¸å°‘è¯»è€…åé¦ˆå†…å®¹ç©ºæ³›ã€ç¼ºä¹å®æ“ä»·å€¼ã€‚</p>
<p>æ„å»ºçŸ¥è¯†åº“ï¼Œä»æ¥ä¸åªæ˜¯å·¥ç¨‹å®ç°çš„å‘½é¢˜ï¼Œæ›´æ˜¯ä¸€åœºè®¾è®¡å“²å­¦çš„æ€è¾¨ï¼šæŠ€æœ¯å±‚é¢ç¡®ä¿å…¶å¯éƒ¨ç½²ã€å¯è¿ç»´ï¼Œè€Œå“²å­¦å±‚é¢åˆ™é”šå®šå…¶é«˜å¯ç”¨æ€§ã€å¯æ‰©å±•æ€§ä¸è·¨ç³»ç»Ÿå…¼å®¹æ€§ã€‚</p>
<p>åœ¨AIæ—¶ä»£ç››è¡Œçš„ä»Šå¤©ï¼ŒçŸ¥è¯†åº“æ—©å·²è¶…è¶ŠRAGçš„è¾¹ç•Œï¼Œæˆä¸ºåº•å±‚çŸ¥è¯†åŸºç¡€è®¾æ–½ï¼›ç†è®ºä¸Šï¼Œå‡¡éœ€çŸ¥è¯†æ”¯æ’‘ä¹‹å¤„ï¼Œçš†æœ‰å…¶å­˜åœ¨â€”â€”æ— è®ºæ˜¯æ™ºèƒ½ä½“å†³ç­–ï¼Œè¿˜æ˜¯AIGCå†…å®¹ç”Ÿæˆï¼Œè«ä¸å¦‚æ­¤ã€‚</p>
<h2 data-id="heading-0">çŸ¥è¯†åº“çš„ä½œç”¨</h2>
<p>æˆ‘ä»¬æš‚ä¸”æç½®å„ç±»æŠ€æœ¯æ¡†æ¶ä¸åº”ç”¨ç†è®ºï¼Œå›å½’æ¨¡å‹æœ€æœ¬è´¨çš„åŸºåº§ï¼Œé‡æ–°å®¡è§†çŸ¥è¯†åº“ä¸ºä½•ä¸å¯æˆ–ç¼ºã€‚</p>
<p>äººå·¥æ™ºèƒ½çš„ç»ˆææ„¿æ™¯ï¼Œæ˜¯æ„å»ºä¸€ä¸ªèƒ½åƒäººç±»ä¸€æ ·åº”å¯¹å¤æ‚ä»»åŠ¡çš„æ™ºèƒ½ä½“ï¼›ä½†æ— è®ºäººè¿˜æ˜¯æœºå™¨ï¼Œèƒ½åŠ›çš†æœ‰è¾¹ç•Œï¼Œå¾€å¾€éœ€å€ŸåŠ›å¤–ç‰©æ‰èƒ½å®Œæˆç›®æ ‡â€”â€”æ­£å¦‚æˆ‘ä»¬è¸å…¥é™Œç”Ÿé¢†åŸŸæ—¶ï¼Œä¾èµ–ä¹¦ç±ç ”è¯»ã€å¸ˆè€…ç‚¹æ‹¨æ¥è·å–è®¤çŸ¥ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fyuan.zhipoai.cn%2F" target="_blank" title="https://yuan.zhipoai.cn/" ref="nofollow noopener noreferrer"><strong>æ›´å¤šAIå¤§æ¨¡å‹å­¦ä¹ è§†é¢‘åŠèµ„æºï¼Œéƒ½åœ¨æ™ºæ³ŠAIã€‚</strong></a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/12e7138a3f2044279e162aee98de58c7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768144473&amp;x-signature=OBEcw6nWtJFSxTPLLXsOCdWW%2BQw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™äº›å¤–éƒ¨ä¿¡æ¯ï¼Œå¯¹äººè€Œè¨€æ˜¯å­¦ä¹ çš„å…»åˆ†ï¼›å¯¹æ¨¡å‹è€Œè¨€ï¼Œåˆ™æ˜¯å…¶è‡ªèº«æ— æ³•æ‰¿è½½çš„â€œå¤–éƒ¨è®°å¿†â€ã€‚ç®¡ç†è¿™ç±»è®°å¿†ï¼Œæ­£éœ€è¦ä¸€ä¸ªçŸ¥è¯†åº“ç³»ç»Ÿï¼Œå¦‚åŒå›¾ä¹¦é¦†å…¸è—å…¸ç±ã€æ¡£æ¡ˆå®¤ä¿å­˜æ–‡çŒ®ã€‚</p>
<p>æ¨¡å‹äº¦ç„¶ã€‚çºµä½¿å‚æ•°è§„æ¨¡æŒç»­è†¨èƒ€ï¼Œå…¶å†…éƒ¨å­˜å‚¨ä»éæ— é™ï¼Œæ€»æœ‰çŸ¥è¯†æ— æ³•å†…åŒ–ã€‚ä»ç»æµæ€§ä¸æ•ˆç‡å‡ºå‘ï¼Œæ›´åˆç†çš„è·¯å¾„æ˜¯ï¼šè®©æ¨¡å‹ä¸“æ³¨æ ¸å¿ƒæ¨ç†èƒ½åŠ›ï¼Œè€Œåœ¨éœ€è¦æ—¶è°ƒç”¨å¤–éƒ¨çŸ¥è¯†ä¸å·¥å…·è§£å†³é—®é¢˜ã€‚æ— éœ€ä¸ºè§£ç­”â€œ1+1=2â€è€Œé‡å­¦å¾®ç§¯åˆ†ã€‚</p>
<p>ç”±æ­¤å¯å¾—ï¼šæ— è®ºæ¨¡å‹å½¢æ€å¦‚ä½•æ¼”è¿›ï¼ŒçŸ¥è¯†åº“éƒ½æ˜¯å…¶æ— æ³•ç»•å¼€çš„åŸºç¡€è®¾æ–½ã€‚</p>
<p>è®¤æ¸…è¿™ä¸€ç‚¹ï¼Œä¾¿ä¸éš¾ç†è§£â€”â€”æ— è®ºæ˜¯æ„å»ºRAGã€å¼€å‘æ™ºèƒ½ä½“ï¼Œè¿˜æ˜¯æ¨è¿›AIGCï¼ŒçŸ¥è¯†åº“å§‹ç»ˆæ˜¯åº•å±‚åˆšéœ€ã€‚</p>
<p>ä»å·¥ç¨‹è§†è§’çœ‹ï¼Œæˆ‘ä»¬å‘æ¨¡å‹è¾“å…¥ä»»åŠ¡éœ€æ±‚ä¸å‚è€ƒçŸ¥è¯†ï¼Œæ¨¡å‹æ®æ­¤ç†è§£æ„å›¾ã€ç”Ÿæˆå“åº”ï¼›è€Œè¿™äº›å‚è€ƒçŸ¥è¯†ï¼Œæ€»ä¸èƒ½æ¯æ¬¡ä¸´æ—¶æ£€ç´¢ã€ç°åœºæŸ¥æ‰¾å§ï¼Ÿ</p>
<p>äºæ˜¯ï¼Œä¸€ä¸ªç»“æ„åŒ–çš„çŸ¥è¯†åº“ç®¡ç†ç³»ç»Ÿåº”è¿è€Œç”Ÿï¼šå®ƒæ²‰æ·€å†å²çŸ¥è¯†ï¼Œç»„ç»‡å¯å¤ç”¨ä¿¡æ¯ã€‚å½“ç›¸ä¼¼é—®é¢˜å†åº¦å‡ºç°ï¼Œç³»ç»Ÿå¯ç›´æ¥è°ƒç”¨å·²æœ‰ç­”æ¡ˆï¼Œæ— éœ€é‡å¤åŠ³åŠ¨ã€‚è¿™ä¸ä»…æ‹“å±•äº†æ¨¡å‹çš„èƒ½åŠ›ä¸Šé™ï¼Œæ›´æ˜¾è‘—æå‡äº†å“åº”æ•ˆç‡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/578881e40e4849809b5b023534ae3ff2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768144473&amp;x-signature=w1ohvgkw0aqFyfoWPaoOyQbUXSM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é’ˆå¯¹å¤§æ¨¡å‹çš„å„ç±»åº”ç”¨åœºæ™¯ï¼ŒçŸ¥è¯†åº“ç®¡ç†ç³»ç»Ÿéƒ½æ˜¯ä¸å¯æˆ–ç¼ºçš„æ”¯æ’‘ç»„ä»¶ï¼›ä½†å…¶æ„å»ºåº”ç´§æ‰£å®é™…éœ€æ±‚çµæ´»é€‚é…ï¼Œæ— éœ€ä¹Ÿä¸åº”è¿½æ±‚é¢é¢ä¿±åˆ°ã€è§„æ¨¡åºå¤§ã€‚</p>
<p>æ¨¡å‹ä¸çŸ¥è¯†åº“ä¹‹é—´çš„å…³ç³»ï¼Œæ°å¦‚ä¸€ä½èƒ½åŠ›å‡ºä¼—çš„ä¸“å®¶ä¸å…¶ä¸“å±åå‹¤å›¢é˜Ÿï¼šæ¨¡å‹è´Ÿè´£å†³ç­–ä¸è¾“å‡ºï¼ŒçŸ¥è¯†åº“åˆ™æŒç»­ä¾›ç»™ç²¾å‡†ã€åŠæ—¶çš„èµ„æºæ”¯æŒï¼ŒäºŒè€…ååŒè¿ä½œï¼Œæ‰èƒ½å‚¬ç”Ÿå‡ºè¿œè¶…æ¨¡å‹å•ä½“èƒ½åŠ›çš„æ™ºèƒ½ä½“ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fyuan.zhipoai.cn%2F" target="_blank" title="https://yuan.zhipoai.cn/" ref="nofollow noopener noreferrer"><strong>æ›´å¤šAIå¤§æ¨¡å‹å­¦ä¹ è§†é¢‘åŠèµ„æºï¼Œéƒ½åœ¨æ™ºæ³ŠAIã€‚</strong></a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2026 æ˜¥æ¶§Â·å‰ç«¯èµ°å‘å…¨æ ˆ]]></title>    <link>https://juejin.cn/post/7591510742634283071</link>    <guid>https://juejin.cn/post/7591510742634283071</guid>    <pubDate>2026-01-04T15:22:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591510742634283071" data-draft-id="7591334602427269183" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2026 æ˜¥æ¶§Â·å‰ç«¯èµ°å‘å…¨æ ˆ"/> <meta itemprop="keywords" content="å…¨æ ˆ,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-04T15:22:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç‰›å¥¶"/> <meta itemprop="url" content="https://juejin.cn/user/1169536100866487"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2026 æ˜¥æ¶§Â·å‰ç«¯èµ°å‘å…¨æ ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1169536100866487/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç‰›å¥¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T15:22:51.000Z" title="Sun Jan 04 2026 15:22:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">2026 æ˜¥æ¶§Â·å‰ç«¯èµ°å‘å…¨æ ˆ</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/becd400be9584391993b37b521b6687a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54mb5aW2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768144971&amp;x-signature=S3Pi0czXxYMlgA7vTu8DGSCQwgo%3D" alt="æ˜¥æ¶§æ„å¢ƒ - æ°´å¢¨å±±æ°´ä¸æ¢…é›¨" loading="lazy"/></p>
<p><code>â€œæˆ‘é†‰å€šæ¥¼å°ç¿å¤´è¯·é…’æ­£è±ªè¿ˆâ€¦â€¦äººç”Ÿå°‘æœ‰å¿«å“‰ä½•é¡»è®ºæˆè´¥â€</code></p>
<p>2025ï¼Œæˆ‘ç»ˆäºä»<code>â€œé—²å¬æ¢…é›¨çª—å¤–â€</code>çš„å‰ç«¯èˆ’é€‚åŒºï¼Œè¸‰è·„ç€é†‰å…¥äº†å…¨æ ˆçš„æ˜¥æ¶§ã€‚</p>
<h3 data-id="heading-1">æ¸…æ„åˆå¼€</h3>
<p>2025ï¼Œå‰ç«¯çš„æ ¸å¿ƒå™äº‹å¯æ¦‚æ‹¬ä¸º â€œå…¨æ ˆåŒ–â€ä¸â€œæ€§èƒ½ä¼˜å…ˆâ€çš„åŒé‡é©±åŠ¨ï¼š</p>
<p><strong>å‰ç«¯å…¨æ ˆåŒ–</strong> ä¸ <strong>æ€§èƒ½ä¼˜å…ˆ</strong>ã€‚</p>
<p>å…ƒæ¡†æ¶ï¼ˆ<code>Next.js</code>ã€<code>Nuxt</code>ã€<code>SvelteKit</code>ï¼‰å·²æˆä¸ºæ–°é¡¹ç›®çš„å‘¼å¸èµ·ç‚¹ã€‚</p>
<p>å¼€å‘è€…ä¸å†åªå†™ç»„ä»¶ï¼Œè€Œæ˜¯ç›´æ¥è®¾è®¡å…¨æ ˆæ¶æ„ã€‚</p>
<p><strong><code>â€œæœåŠ¡å™¨ä¼˜å…ˆâ€å½»åº•èƒœå‡º</code></strong>ã€‚</p>
<p><code>React Server Components</code>ã€Nuxt 3ã€streaming SSRâ€¦â€¦</p>
<p>æœåŠ¡ç«¯æ‰¿è½½æ¸²æŸ“ä¸é€»è¾‘ï¼Œå®¢æˆ·ç«¯è´Ÿæ‹…éª¤å‡ï¼Œå®‰å…¨æ€§ä¸æ ¸å¿ƒæŒ‡æ ‡ï¼ˆLCPã€TTIï¼‰æš´æ¶¨ã€‚</p>
<p>æ€§èƒ½æˆäº†å”¯ä¸€ä¿¡ä»°ã€‚</p>
<p>ç»“æœå¾ˆæ®‹é…·ï¼Œå´å¾ˆç¾ï¼š</p>
<ul>
<li>
<p><code>Rust/GO</code> å·¥å…·é“¾å…¨é¢å´›èµ·ï¼Œ<code>Turbopack</code>ï¼ˆNext.js 15 é»˜è®¤ï¼‰å¸¦æ¥ 700x æ›´å¿« HMRï¼Œ<code>Vite</code>/<code>Rspack</code>è®© <code>Webpack</code> æˆä¸ºä¸Šå¤ä¼ è¯´ã€‚</p>
</li>
<li>
<p><code>â€œå²›å±¿æ¶æ„â€</code>ï¼ˆAstroã€Qwikï¼‰å¸­å·å†…å®¹å‹ç«™ç‚¹ï¼Œé›¶/æå°‘ JS é»˜è®¤ï¼Œç¬æ—¶åŠ è½½æˆä¸ºæ ‡é…ã€‚</p>
</li>
</ul>
<p><strong>AI ä»è¾…åŠ©å˜æˆåŸºçŸ³</strong>ã€‚</p>
<p><code>Cursor</code>ã€<code>Claude</code> ç­‰ AI å·¥å…· æ·±åº¦åµŒå…¥ç¼–ç ã€é‡æ„ã€è°ƒè¯•ï¼Œé—®é¢˜è§£å†³æ–¹å¼å·²å˜å¤©ã€‚</p>
<p><code>TypeScript</code> æ— éœ€è®¨è®ºï¼Œå·²æˆåº•å±‚é“å¾‹ã€‚</p>
<p>è€Œå¸‚åœºæœ€åˆºè€³çš„ä¸€å¥å®è¯æ˜¯ï¼š</p>
<p><code>â€œæˆ‘ä»¬æƒ³è¦ä¸€ä¸ªäººå…¨æå®šã€‚â€</code></p>
<p>çº¯å‰ç«¯çš„ä½“é¢è¿˜åœ¨ï¼Œå´è¶Šæ¥è¶Šåƒ</p>
<p>â€œæ¬ äºŒä¸¤ç¬”å¢¨å€ºï¼Œé—²å¬æ¢…é›¨çª—å¤–â€â€”â€”</p>
<p>é£é›…æœ‰ä½™ï¼Œé”‹èŠ’æ¸å¤±ã€‚</p>
<p>å¹´åº•ï¼Œ<strong>æˆ‘åˆæ¢äº†ä¸€ä»½å·¥ä½œï¼ˆå¸‚åœºè¡Œæƒ…ä¾æ—§ä¸å¥½å•Šï¼‰</strong>ï¼Œæ¢äº†ä¸€ä»½è¦æ±‚<code>â€œèƒ½å‰åç«¯é€šåƒâ€</code>çš„å·¥ä½œã€‚</p>
<p>ä»é‚£ä¸€åˆ»èµ·ï¼ŒçœŸæ­£çš„æ˜¥æ¶§ä¹‹æ—…å¼€å§‹äº†ã€‚</p>
<h3 data-id="heading-2">é£èŠ±é›ªæœˆå…¥æ ˆ</h3>
<p><code>è½¬å‹</code>ä»æ¥ä¸æ˜¯è¯—å’Œè¿œæ–¹ï¼Œè€Œæ˜¯åˆšèµ·æ­¥çš„è¿·é›¾ä¸æ·±å¤œçš„å’–å•¡ã€‚</p>
<p>2025 å¹´åº•ï¼Œæˆ‘ç»ˆäºé¼“èµ·å‹‡æ°”ï¼š</p>
<p>ä»ç†Ÿæ‚‰çš„ React ç»„ä»¶ä¸–ç•Œï¼Œè¿ˆå‘<code>å…¨æ ˆ</code>å’Œ<code>é‡æ„è¿œç¨‹è¿ç»´ç¡¬ä»¶è®¾å¤‡æ§åˆ¶åº”ç”¨</code>çš„æœªçŸ¥å±±æµ·ã€‚</p>
<p>æ¡†æ¶æ­å¥½äº†â€”â€”<code>NestJs + Vue3 + TypeORM + WebSocket + MQTT</code> çš„åŸºæœ¬éª¨æ¶ï¼Œ</p>
<p>MQTT è¿ä¸Šäº†ï¼Œç¬¬ä¸€ä¸ª <code>è®¾å¤‡ä¿¡æ¯æŸ¥è¯¢</code> æ¥å£ä¹Ÿè·‘é€šäº†ã€‚</p>
<p>ä½†åé¢å‘¢ï¼Ÿ</p>
<p>è¿œç¨‹è®¾å¤‡çš„ AI å¼‚å¸¸è¯Šæ–­æ€ä¹ˆåšï¼Ÿ</p>
<p>è®¾å¤‡è‡ªå®šä¹‰æ“ä½œæ€ä¹ˆåšä¸²å‹é“¾è·¯å’Œäº’æ–¥çš„å®‰å…¨æ§åˆ¶ï¼Ÿ</p>
<p>éƒ¨ç½²ä¸Šäº‘è¦è¸©å¤šå°‘å‘ï¼Ÿ</p>
<p><code>æŠ¥é”™</code>ã€<code>å¤±è´¥</code>â€¦â€¦æ¯ä¸€æ¬¡è°ƒè¯•éƒ½åƒåœ¨é›¨å¤œé‡Œæ‘¸é»‘å‰è¡Œï¼Œå¿ƒåº•é‚£å¥<code>â€œäººé—´æ¸…æ„â€</code>åˆå›æ¥äº†ã€‚</p>
<p>æœ‰æ—¶å€™ç›¯ç€æŠ¥é”™çš„æ§åˆ¶å°ï¼Œçªç„¶å°±æƒ³é—®è‡ªå·±ï¼š</p>
<p>â€œæˆ‘çœŸçš„èƒ½èµ°ä¸‹å»å—ï¼Ÿâ€</p>
<p>ä½†å¥‡æ€ªçš„æ˜¯ï¼Œæ¯è§£å†³ä¸€ä¸ªå°é—®é¢˜â€”â€”</p>
<p>å“ªæ€•åªæ˜¯æŠŠ æ¥å£è°ƒç”¨ æ”¹å¯¹ä¸€æ¬¡ï¼Œæ¥å£è¿”å›äº†é¢„æœŸæ•°æ®ï¼Œ</p>
<p>å¿ƒé‡Œçš„<code>â€œé£èŠ±é›ªæœˆâ€</code>å°±å·å·å¤šäº†ä¸€åˆ†ã€‚</p>
<p>ä¸æ˜¯ä»€ä¹ˆå¤§æˆå°±ï¼Œåªæ˜¯é‚£ç§â€œåŸæ¥æˆ‘èƒ½å¾€å‰æŒªä¸€æ­¥â€çš„å¾®é†ºæ„Ÿã€‚</p>
<p>ç°åœ¨æˆ‘æ‰æ˜ç™½ï¼Œå…¨æ ˆä¸æ˜¯ä¸€ä¸‹å­å°±â€œå…¥æ ˆâ€ï¼Œè€Œæ˜¯åƒé†‰é…’ä¸€æ ·ï¼Œä¸€å£ä¸€å£åœ°å–ä¸‹å»ã€‚</p>
<p>å…ˆæŠŠæ¡†æ¶è·‘é€šï¼Œå†è¡¥è®¤è¯ï¼Œå†åŠ ä¸ªçœŸå®çš„å°åŠŸèƒ½â€¦â€¦</p>
<p>æœªçŸ¥å¾ˆå¤šï¼Œä½†æ¯å¤šçŸ¥é“ä¸€ç‚¹ï¼Œå±±æµ·å°±è¿‘ä¸€ç‚¹ã€‚</p>
<h3 data-id="heading-3">2026ï¼Œä¸€èµ·é†‰å…¥æ˜¥æ¶§</h3>
<p>2026 å¹´ 1 æœˆï¼Œæˆ‘è¿˜ç«™åœ¨æ˜¥æ¶§å…¥å£ã€‚</p>
<p>æ¡†æ¶åˆšæ­å¥½ï¼Œè·¯è¿˜æ¨¡ç³Šï¼Œç–‘æƒ‘æ¯”ç­”æ¡ˆå¤šå¾—å¤šã€‚</p>
<p>ä½†æˆ‘å·²ç»é†‰äº†â€”â€”é†‰åœ¨<code>â€œæ•¢è¿ˆå‡ºè¿™ä¸€æ­¥â€</code>çš„è±ªè¿ˆé‡Œã€‚</p>
<p>2026 å¹´çš„å‰ç«¯æœ‹å‹ï¼Œå¦‚æœä½ ä¹Ÿå¬è§äº†é‚£åœºæ¢…é›¨ï¼Œ</p>
<p>å¦‚æœä½ ä¹Ÿå¼€å§‹æ€€ç–‘<code>â€œçº¯å‰ç«¯è¿˜èƒ½èµ°å¤šè¿œâ€</code>ï¼Œ</p>
<p>å¦‚æœä½ ä¹Ÿåˆšæ­å¥½æ¡†æ¶ï¼Œå´è¢«ä¸€å †æœªçŸ¥å“ä½â€”â€”</p>
<p>åˆ«æ€•ã€‚</p>
<p>ä»ä»Šå¤©å¼€å§‹ï¼Œå“ªæ€•åªå¤šå†™ä¸€ä¸ªæ¥å£ã€å¤š <code>debug</code> ä¸€æ¬¡æŠ¥é”™ã€å¤šçœ‹ä¸€ç¯‡æ–‡æ¡£ï¼Œ</p>
<p>å“ªæ€•åªå¤šä¼š 5%ï¼Œ</p>
<p>ä½ å°±å·²ç»æ¯”æ˜¨å¤©æ›´é è¿‘</p>
<p><code>ä¸‹æ¦»å±±æµ·ï¼Œé£èŠ±é›ªæœˆå…¥æˆ‘æ€€</code>ã€‚</p>
<p><code>äººç”Ÿå°‘æœ‰å¿«å“‰ï¼Œä½•é¡»è®ºæˆè´¥</code>ã€‚</p>
<p>æ¥å§ï¼Œä¸€èµ·åœ¨è¿™åœºæ˜¥æ¶§é‡Œï¼Œæ…¢æ…¢é†‰ï¼Œæ…¢æ…¢èµ°ã€‚</p>
<p>ï¼ˆ2026.1.4 åŠå¤œ Â· äºå‡ºå·®çš„æŸä¸ªé…’åº—ï¼‰</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI æœ‰ä½ æƒ³ä¸åˆ°ï¼Œä¹Ÿå®ƒæœ‰åšä¸åˆ° | 2025 å¹´æ·±åº¦ä½¿ç”¨ Cursor/Trae/CodeX æ‰€å¾—åæ¡ç»éªŒ]]></title>    <link>https://juejin.cn/post/7591510742634315839</link>    <guid>https://juejin.cn/post/7591510742634315839</guid>    <pubDate>2026-01-04T15:23:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591510742634315839" data-draft-id="7591510742634266687" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI æœ‰ä½ æƒ³ä¸åˆ°ï¼Œä¹Ÿå®ƒæœ‰åšä¸åˆ° | 2025 å¹´æ·±åº¦ä½¿ç”¨ Cursor/Trae/CodeX æ‰€å¾—åæ¡ç»éªŒ"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,ä»£ç è§„èŒƒ"/> <meta itemprop="datePublished" content="2026-01-04T15:23:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Piperè›‹çª"/> <meta itemprop="url" content="https://juejin.cn/user/844050443272557"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI æœ‰ä½ æƒ³ä¸åˆ°ï¼Œä¹Ÿå®ƒæœ‰åšä¸åˆ° | 2025 å¹´æ·±åº¦ä½¿ç”¨ Cursor/Trae/CodeX æ‰€å¾—åæ¡ç»éªŒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/844050443272557/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Piperè›‹çª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T15:23:57.000Z" title="Sun Jan 04 2026 15:23:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å»å¹´çš„ä»Šå¤©ï¼Œæˆ‘è¿˜åœ¨å¥‹ç¬”ç–¾ä¹¦åœ°å†™ç€ VS Code + Roo Cline çš„è¯„æµ‹å¿ƒå¾—ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FUdSThZX69c8CXkEw48Vy_w" target="_blank" title="https://mp.weixin.qq.com/s/UdSThZX69c8CXkEw48Vy_w" ref="nofollow noopener noreferrer">ä¸ªäººè¯„æµ‹ | Cursor å…è´¹å¹³æ›¿ï¼šRoo Cline + DeepSeek-v3/Gemini-2.0 + RepoPrompt AI è¾…åŠ©ç¼–ç¨‹</a> ã€‚å½“æ—¶çš„æˆ‘æ²¡æœ‰æƒ³è¿‡ï¼šåœ¨ 2025 å¹´ï¼Œ Roo Cline ä¼šè¢«æˆ‘è¿…é€Ÿæ·˜æ±°ï¼Œæˆ‘ä¹Ÿæˆä¸ºäº† Cursor è¿™ç±» Vibe Coding å·¥å…·çš„ç¨³å®šç”¨æˆ·ä¹‹ä¸€ã€‚</p>
<p>ç«™åœ¨ 2026 å¹´ä¼Šå§‹çš„èŠ‚ç‚¹ä¸Šï¼Œå®¡è§†è‡ªå·±çš„å·¥ä½œæµï¼Œå‘ç°å·²ç»å®Œå…¨è¢«é”šå®šåœ¨äº†å¦‚ä¸‹å·¥å…·é“¾ä¸Šï¼š</p>
<ul>
<li>å¯¹è¯å·¥å…·ï¼š ChatGPT 5.2 + Gemini 3 Pro</li>
<li>Vibe Coding ï¼š å·¥ä½œç”¨ Cursor ï¼Œä¸ªäººå­¦ä¹ ç”¨ Trae å›½é™…ç‰ˆ + CodeX ï¼Œè¾…ä»¥ VS Code + GitHub Copliot</li>
</ul>
<p>å…¶ä¸­æˆ‘ä»…ä¸º ChatGPT å’Œ Trae ä»˜è¿‡è´¹ï¼ˆ ChatGPT èµ é€ CodeX è®¢é˜…ï¼‰ï¼Œ GitHub Copliot ä½¿ç”¨çš„å…è´¹é¢åº¦ï¼ˆæ¯ä¸ªæœˆå¯è°ƒç”¨æ¬¡æ•°ä¸å¤šï¼‰ã€‚</p>
<p>æœ¬æ–‡ä¸­ï¼Œæˆ‘æŠŠ 2025 å¹´ä¸€å¹´çš„ç»éªŒæ€»ç»“æˆåæ¡ï¼Œå¸Œæœ›èƒ½å¤Ÿå¼•èµ·è®¨è®ºï¼Œå…±åŒäº¤æµå­¦ä¹ ã€‚</p>
<h3 data-id="heading-0">ï¼ˆä¸€ï¼‰èŠå¤© AI æ²¡æœ‰è¢«æ·˜æ±°ï¼ŒæŸäº›æƒ…å†µä¸‹ï¼Œå®ƒä»¬æ›´å¥½ç”¨</h3>
<p>å¾ˆå¤šæœ‹å‹åœ¨æ‹¿åˆ° Cursor æˆ– Trae è¿™ç§ IDE åï¼Œå®¹æ˜“å…»æˆä¸€ç§ä¹ æƒ¯ï¼šä¸€å¤´æ‰è¿›å…·ä½“çš„ä»£ç æ–‡ä»¶ä¸­ï¼Œè¯•å›¾ç”¨ Tab å’Œ CMD+K è§£å†³æ‰€æœ‰é—®é¢˜ã€‚ä½†ç»è¿‡è¿™ä¸€å¹´çš„å®è·µï¼Œæˆ‘å‘ç°ç½‘é¡µç‰ˆçš„èŠå¤©å‹ AI å’Œ IDE è°ƒç”¨çš„ API æ¨¡å‹æ˜¯æœ‰æœ¬è´¨åŒºåˆ«çš„ã€‚</p>
<p>é¦–å…ˆæ˜¯æ¨¡å‹çš„å¯æ§æ€§ã€‚IDE æ¥å…¥çš„æ¨¡å‹å¾€å¾€ä¸ºäº†ä»£ç ç”Ÿæˆåšè¿‡å¾®è°ƒï¼Œä½†åœ¨é€»è¾‘æ·±åº¦ä¸Šï¼ŒChatGPT 5.2 çš„ Thinking Extended Thinking æ¨¡å¼æˆ–è€… Gemini 3 Pro çš„æ¨ç†æ¨¡å¼ï¼Œæ˜¾ç„¶æ¯” Cursor çš„ Agent æ›´åŠ æ·±æ€ç†Ÿè™‘ã€‚</p>
<p>æ›´å…³é”®çš„æ˜¯ä¸Šä¸‹æ–‡çš„ç®¡ç†ã€‚å½“ä½ éœ€è¦è¿›è¡Œå®è§‚æ¶æ„è®¾è®¡æ—¶ï¼ŒIDE çš„ RAG æ£€ç´¢æœ‰æ—¶ä¼šæ˜¾å¾—è¿‡äºç¢ç‰‡åŒ–ã€‚æˆ‘çš„åšæ³•æ˜¯ï¼Œåˆ©ç”¨ <code>git archive --format=zip HEAD -o project.zip</code> å°†é¡¹ç›®æ‰“åŒ…ã€‚è¿™ä¸ªå‘½ä»¤çš„å¥½å¤„åœ¨äºå®ƒåªæ‰“åŒ… Git è¿½è¸ªçš„æ–‡ä»¶ï¼Œè‡ªåŠ¨æ’é™¤äº† <code>node_modules</code> å’Œä¸´æ—¶æ•°æ®ã€‚æŠŠè¿™ä¸ªå‹ç¼©åŒ…æ‰”ç»™ ChatGPTï¼Œå®ƒç°åœ¨çš„è™šæ‹Ÿæœºèƒ½åŠ›éå¸¸å¼ºï¼Œå¯ä»¥è‡ªè¡Œè§£å‹ã€æœ‰é€‰æ‹©åœ°é˜…è¯»æ–‡ä»¶ã€‚</p>
<p>ç›¸æ¯”äºåœ¨ IDE é‡Œæ•²æ•²æ‰“æ‰“ï¼ŒChatGPT è¿™ç±»å·¥å…·æ›´é€‚åˆåšâ€œé¡¶å±‚è®¾è®¡â€ã€‚æ¯”å¦‚æŠ€æœ¯é€‰å‹å’Œå¼€å‘è·¯çº¿åˆ¶å®šï¼Œå®ƒçš„ Web Searching èƒ½åŠ›æ¯” IDE çš„ Agent æ›´å¹¿æ›´æ·±ï¼›å†æ¯”å¦‚é¡¹ç›®åˆå§‹åŒ–ï¼Œä½ å¯ä»¥ç›´æ¥è®©å®ƒç”Ÿæˆä¸€ä¸ªåŒ…å«å®Œæ•´ç›®å½•ç»“æ„çš„ zip åŒ…ï¼Œç”šè‡³é¡ºä¾¿ç”»å‡º mermaid æµç¨‹å›¾ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b12f2c46458d4e1a964a2417ba0055d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUGlwZXLom4vnqp0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768145037&amp;x-signature=tgCxI0tfvpISS9k3Jnvr9PLRAyE%3D" alt="å–„äºä½¿ç”¨åˆ†æ”¯" loading="lazy"/></p>
<p>è€Œåœ¨æ•°å­¦è®¡ç®—å’Œå¤æ‚ç®—æ³•æ¨å¯¼ä¸Šï¼ŒèŠå¤© AI æ›´æ˜¯é™ç»´æ‰“å‡»ã€‚æˆ‘è‡ªå·±ç ”ç©¶æ²¹æ°”ç®¡é“è°ƒåº¦é—®é¢˜æ—¶ï¼Œå°±å¸¸æŠŠåŸå§‹æ•°æ®æ‰“åŒ…ä¸Šä¼ ï¼Œåˆ©ç”¨ ChatGPT çš„è¶…é•¿æ€è€ƒæ—¶é—´ï¼Œç»“åˆâ€œåˆ†æ”¯èŠå¤©â€ç­–ç•¥ï¼ŒåŒæ—¶æ¢ç´¢æ•´æ•°è§„åˆ’ã€åŠ¨æ€è§„åˆ’å’Œå¼ºåŒ–å­¦ä¹ ä¸‰æ¡è·¯çº¿ã€‚è¿™ç§å·¥ç¨‹å®è·µçš„ç¬¬ä¸€æ­¥ï¼Œç›®å‰çš„ IDE è¿˜åšä¸åˆ°è¿™ä¹ˆå¥½ã€‚</p>
<h3 data-id="heading-1">ï¼ˆäºŒï¼‰å–„äºä½¿ç”¨ workspace æ¦‚å¿µï¼Œä¸è¦æµªè´¹ç±» Cursor å·¥å…·çš„ RAG index</h3>
<p>Cursor å’Œ Trae è¿™ç±»å·¥å…·çš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºäº‘ç«¯ç´¢å¼•ï¼ˆIndexï¼‰ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒä»¬æŠŠä½ çš„ä»£ç â€œè¯»â€äº†ä¸€éå¹¶å»ºç«‹äº†ä¸€ä¸ªå‘é‡æ•°æ®åº“ã€‚è¿™æ„å‘³ç€åœ¨ Agent Chat ä¸­ï¼Œä½ ä¸éœ€è¦ç¬¨æ‹™åœ°æŠŠç¬¬ 1 è¡Œåˆ°ç¬¬ 50 è¡Œä»£ç å¤åˆ¶è¿›å»ï¼Œåªéœ€ <code>@</code> ä¸€ä¸‹ç›¸å…³æ–‡ä»¶ï¼ŒAgent å°±èƒ½é€šè¿‡ç´¢å¼•ç†è§£ä¸Šä¸‹æ–‡ï¼Œæ—¢é«˜æ•ˆåˆèŠ‚çœ tokensã€‚</p>
<p>ä½†åœ¨ Cursor / Trae ä¼¼ä¹å¿½ç•¥äº† VS Code ç¥–ä¼ çš„ <code>workspace</code> åŠŸèƒ½ï¼Œå¯¼è‡´ IDE æ— æ³•ç†è§£å¤šæ¨¡å—é¡¹ç›®çš„å…³ç³»ã€‚Cursor å¦‚æœæ‰¾ä¸åˆ°æ˜ç¡®çš„ root ç›®å½•ï¼Œæœç´¢å’Œç´¢å¼•çš„æ•ˆæœå°±ä¼šå¤§æ‰“æŠ˜æ‰£ã€‚</p>
<p>æˆ‘ç°åœ¨çš„ä¹ æƒ¯æ˜¯æ„å»ºä¸€ä¸ªâ€œæ‰‹åŠ¨çš„ workspaceâ€ã€‚å³ä½¿æ˜¯å‰åç«¯åˆ†ç¦»çš„é¡¹ç›®ï¼Œæˆ‘ä¹Ÿä¼šæŠŠå®ƒä»¬æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œæ¯”å¦‚åˆ›å»ºä¸€ä¸ª <code>_workspace</code> æ–‡ä»¶å¤¹ï¼Œé‡Œé¢åŒ…å« <code>.cursorrules</code>ã€<code>frontend</code>ã€<code>backend</code> å’Œ <code>openapi</code> ç›®å½•ã€‚</p>
<p>ä¸è¦å•ç‹¬æ‰“å¼€ frontend å†™å‰ç«¯ï¼Œç›´æ¥ç”¨ Cursor æ‰“å¼€ <code>_workspace</code>ã€‚è¿™æ ·åœ¨è¿›è¡Œå‰åç«¯è”è°ƒæ—¶ï¼ŒCursor èƒ½å¤ŸåŒæ—¶ç´¢å¼•ä¸¤ç«¯çš„ä»£ç ï¼Œç†è§£æ¥å£å®šä¹‰å’Œä¸šåŠ¡é€»è¾‘çš„å…³è”ã€‚ä½ å¯ä»¥åœ¨ <code>.cursorrules</code> ä¸­æ˜ç¡®è¿™æ˜¯ä¸€ä¸ª monorepoï¼Œå‘Šè¯‰ AI å‰ç«¯ç”¨ pnpmï¼Œåç«¯ç”¨ Python 3.12ï¼Œç”šè‡³å†™æ˜â€œè°ƒè¯•å‰è¯·è¿è¡Œ <code>source ./backend/env/bin/activate</code>â€ã€‚è¿™äº›ç¯å¢ƒä¸Šä¸‹æ–‡çš„æ³¨å…¥ï¼Œèƒ½è®© AI å°‘é—®å¾ˆå¤šå‚»é—®é¢˜ï¼Œæå¤§åœ°æå‡ä¸€æ¬¡æ€§ä»£ç é€šè¿‡ç‡ã€‚</p>
<h3 data-id="heading-2">ï¼ˆä¸‰ï¼‰MCP ã€ Rule è¿˜æ˜¯ Skill ï¼Ÿæ¨¡å‹è¶Šæ¥è¶Šå¼ºï¼Œè¿™ç±»æŠ€æœ¯åœ¨è¢«æ·˜æ±°ï¼Œé€‚åˆé¡¹ç›®çš„æ‰æ˜¯æœ€å¥½çš„</h3>
<p>è®°å¾— 2024 å¹´æœ«ï¼ŒMCPï¼ˆModel Context Protocolï¼‰ æ¦‚å¿µç«å¾—ä¸€å¡Œç³Šæ¶‚ã€‚è€Œç°åœ¨ï¼Œ Claude ä¹Ÿåœ¨æ¨å¹¿ Skill ã€‚ä½†åˆ°äº†ç°åœ¨ï¼Œä½ ä¼šå‘ç°è¿™äº›å¤æ‚çš„æŠ€å·§æ­£åœ¨è¢«è¾¹ç¼˜åŒ–ã€‚æœ¬è´¨åŸå› æ˜¯æ¨¡å‹æœ¬èº«å˜å¼ºäº†ï¼Œå¼ºåˆ°ä¸å†éœ€è¦é‚£ä¹ˆå¤šæ‹æ–ã€‚</p>
<p>MCP è™½ç„¶å¯ä»¥å®‰å…¨åœ°è¿æ¥æ•°æ®åº“ï¼ˆæ¯”å¦‚é™åˆ¶åªè¯»æƒé™ç­‰ç­‰ï¼‰ï¼Œä½†é…ç½®èµ·æ¥ä¾ç„¶ç¹çï¼Œä¸”ç”Ÿæ€æœ¬èº«çš„å®‰å…¨æ€§ä¹Ÿå¹¶éæ— æ‡ˆå¯å‡»ã€‚æ•°æ¬¡å°è¯•åï¼Œæˆ‘å‘ç°æœ€æœ´ç´ çš„æ–¹æ¡ˆåè€Œæ˜¯æœ€æœ‰æ•ˆçš„ï¼šè®© AI åŸºäºä½ çš„ä¸šåŠ¡ä»£ç ï¼Œå†™ä¸€å¥— Python æˆ– Shell è„šæœ¬å·¥å…·ã€‚</p>
<p>æ¯”å¦‚ï¼Œä¸å…¶é…ç½®å¤æ‚çš„ MCP å»æŸ¥è¯¢è®¢å•ï¼Œä¸å¦‚è®© AI å†™ä¸€ä¸ª <code>scripts/get_order_info.py</code>ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¾è€Œæ˜“è§ï¼šä½ è‡ªå·±èƒ½ç”¨ï¼ŒAI ä¹Ÿèƒ½ç”¨ã€‚å½“ä½ éœ€è¦è¿›è¡Œå¤æ‚æµ‹è¯•æ—¶ï¼Œç›´æ¥å‘Šè¯‰ AIï¼šâ€œä½ å¯ä»¥å¹¶è¡Œè°ƒç”¨ <code>scripts/send_test_orders.py</code> å’Œ <code>scripts/listen_mock_executions.py</code>â€ã€‚è¿™å…¶å®å°±æ˜¯ä¸€ç§å®šåˆ¶åŒ–çš„ã€ä½æˆæœ¬çš„ MCPï¼Œè€Œä¸”å®Œå…¨æŒæ¡åœ¨ä½ è‡ªå·±çš„ä»£ç ä»“åº“é‡Œã€‚å½“ç„¶ï¼Œè®°å¾—åœ¨è¿è¡Œå‰æ£€æŸ¥ä¸€ä¸‹ AI ç”Ÿæˆçš„è„šæœ¬ï¼Œå®‰å…¨æ„è¯†ä¸èƒ½ä¸¢ã€‚</p>
<h3 data-id="heading-3">ï¼ˆå››ï¼‰ç»™å‡ºå…·ä½“çš„ä»»åŠ¡ï¼Œ AI ä¸æ˜¯æˆ‘ä»¬å·æ‡’çš„å€Ÿå£ï¼Œè€Œæ˜¯æˆ‘ä»¬æ•ˆç‡çš„ä¹˜æ•°</h3>
<p>åˆ†äº«ä¸€ä¸ªçœŸå®çš„ç¿»è½¦æ¡ˆä¾‹ï¼šå‰æ®µæ—¶é—´æœ‰æœ‹å‹æŠŠä¸€ä»½ Word æ ¼å¼çš„ç®€å†æ‰”ç»™ Cursorï¼Œæ¨¡å‹é€‰çš„ Claude Opus 4.5ï¼Œåªç»™äº†ä¸€å¥æŒ‡ä»¤ï¼šâ€œå¸®æˆ‘è½¬æˆ HTMLâ€ã€‚</p>
<p>ç»“æœ AI æå¾—ä¸€å›¢ç³Ÿã€‚å› ä¸ºå®ƒä¸ç†è§£è¿™ä¸ª HTML æ˜¯è¦ç”¨æ¥åšé™æ€å±•ç¤ºï¼Œè¿˜æ˜¯è¦éƒ¨ç½²åˆ°æŸä¸ªå…·ä½“æœåŠ¡ä¸­ã€‚ä¸ºäº†â€œå®Œæˆä»»åŠ¡â€ï¼ŒAI ç”šè‡³ä¸çŸ¥é“ä»å“ªææ¥äº†ä¸€ä¸ªå…¬æœ‰äº‘å¯¹è±¡å­˜å‚¨çš„ Token ï¼ŒæŠŠç®€å†é‡Œçš„ç…§ç‰‡ä¸Šä¼ åˆ°äº†æŸä¸ªä¸çŸ¥åçš„ OSS ä¸Šï¼Œæƒ³åˆ éƒ½åˆ ä¸æ‰ï¼Œç®€ç›´ä»¤äººå•¼ç¬‘çš†éã€‚</p>
<p>è¿™ä¸ªæ•™è®­å‘Šè¯‰æˆ‘ä»¬ï¼ŒAI åªæ˜¯å·¥å…·ï¼Œå†³ç­–è¿˜å¾—é äººã€‚æ­£ç¡®çš„æ–¹å¼åº”è¯¥æ˜¯å…ˆæ˜ç¡®éœ€æ±‚ï¼šè¿™ä¸ª HTML è¦æ”¾åœ¨å“ªé‡Œï¼Ÿæ˜¯å•é¡µé™æ€åº”ç”¨è¿˜æ˜¯åµŒå…¥å¼ç»„ä»¶ï¼Ÿç„¶åï¼Œåˆ©ç”¨ PLAN æ¨¡å¼æˆ–è€…å…ˆé—® Chat AIï¼šâ€œæˆ‘æƒ³æŠŠ Word è½¬ HTMLï¼Œç›®å‰æœ‰å“ªäº›æˆç†Ÿå·¥å…·ï¼Ÿlatex2html è¿˜æ˜¯ pandocï¼Ÿæˆ–è€…å…ˆè½¬ Markdown å†ç”Ÿæˆ HTMLï¼Ÿâ€</p>
<p>å½“æˆ‘ä»¬æ˜ç¡®äº†æŠ€æœ¯è·¯å¾„ï¼ˆæ¯”å¦‚ Word -&gt; Markdown -&gt; HTMLï¼‰åï¼Œå†è®© IDE å»æ‰§è¡Œã€‚AI æ˜¯æˆ‘ä»¬æ•ˆç‡çš„ä¹˜æ•°ï¼Œå®ƒèƒ½æŠŠ 1 å˜æˆ 100ï¼Œä½†å¦‚æœæˆ‘ä»¬ç»™å‡ºçš„åŸºæ•°æ˜¯ 0 ç”šè‡³è´Ÿæ•°ï¼ˆé”™è¯¯çš„å†³ç­–ï¼‰ï¼Œé‚£ç»“æœåªèƒ½æ˜¯ç¾éš¾ã€‚Cursor çš„ PLAN æ¨¡å¼å’Œ Trae çš„ SOLO æ¨¡å¼ï¼ˆç”Ÿæˆ <code>.docs/xxx.md</code>ï¼‰éƒ½æ˜¯å¾ˆå¥½çš„è¾…åŠ©æ€è€ƒå·¥å…·ï¼Œåˆ«ä¸ºäº†çœäº‹ç›´æ¥è›®å¹²ã€‚</p>
<h3 data-id="heading-4">ï¼ˆäº”ï¼‰ä¸è¦è¿‡åº¦æç¤ºï¼Œä½ è¯´çš„æ¯ä¸ªå­— AI éƒ½å¾ˆä¸Šå¿ƒ</h3>
<p>åœ¨ Prompt Engineering åˆšå…´èµ·æ—¶ï¼Œæˆ‘ä»¬ä¹ æƒ¯å†™ä¸€å¤§å †æç¤ºè¯ã€‚ä½†åœ¨ 2025 å¹´ï¼Œé¢å¯¹æ›´èªæ˜çš„æ¨¡å‹ï¼Œè¿‡åº¦æç¤ºåè€Œæˆäº†ç´¯èµ˜ã€‚</p>
<p>æ¯”å¦‚åœ¨ä¸­æ–‡è¯­å¢ƒä¸‹ï¼Œæˆ‘çœ‹åˆ°å¾ˆå¤šäººå–œæ¬¢åœ¨ç»“å°¾åŠ ä¸€å¥â€œè¯·ç»“åˆä¸Šä¸‹æ–‡ä¿®æ”¹ä»£ç â€ã€‚è¿™å¯¹äººç±»æ¥è¯´æ˜¯ä¸€å¥åºŸè¯ï¼Œä½†å¯¹ AI æ¥è¯´å¯èƒ½æ˜¯ä¸ªå¹²æ‰°ã€‚å®ƒå¯èƒ½ä¼šæ­»æ¿åœ°ç†è§£ä¸ºâ€œç»“åˆä¸Šé¢çš„ä»£ç å’Œä¸‹é¢çš„ä»£ç â€ï¼Œç„¶åå»è¿è¡Œ <code>grep -C 10</code> å¼ºè¡Œè¯»å–ä»£ç çš„ç‰©ç†ä¸Šä¸‹è¡Œï¼Œåè€Œå¿½ç•¥äº†åŸæœ¬é«˜æ•ˆçš„ RAG ç´¢å¼•é€»è¾‘ã€‚</p>
<p>ç°åœ¨çš„æ¨¡å‹å·²ç»è¶³å¤Ÿæ™ºèƒ½ï¼Œèƒ½ç†è§£ä½ çš„æ„å›¾ã€‚ç®€æ´ã€æ¸…æ™°åœ°æè¿°éœ€æ±‚ï¼Œå¾€å¾€æ¯”å †ç Œâ€œæç¤ºè¯é­”æ³•â€æ•ˆæœæ›´å¥½ã€‚è¯´å¾—è¶Šå¤šï¼Œæ¨¡å‹â€œå¹»è§‰â€çš„ç©ºé—´åè€Œè¶Šå¤§ã€‚</p>
<h3 data-id="heading-5">ï¼ˆå…­ï¼‰æä¾›å……è¶³çš„ context ï¼Œè¿˜åŒ…æ‹¬æ“ä½œç³»ç»Ÿç¯å¢ƒå’Œå‘½ä»¤è¡Œæ—¥å¿—</h3>
<p>è™½ç„¶æˆ‘ä»¬ä¸è¯¥å•°å—¦ï¼Œä½†åœ¨æä¾›å®¢è§‚äº‹å®ï¼ˆContextï¼‰ä¸Šï¼Œä¸€å®šè¦å¤§æ–¹ã€‚å¾ˆå¤šæ—¶å€™ AI å†™å‡ºçš„ä»£ç è·‘ä¸é€šï¼Œæ˜¯å› ä¸ºå®ƒæ ¹æœ¬ä¸çŸ¥é“ä½ åœ¨ä»€ä¹ˆç¯å¢ƒä¸‹è¿è¡Œã€‚</p>
<p>æˆ‘æœ‰ä¸€ä¸ªä¹ æƒ¯ï¼Œåœ¨å¼€å¯å¤æ‚ä»»åŠ¡å‰ï¼Œä¼šå…ˆæŠŠç»ˆç«¯é‡Œçš„ç¯å¢ƒä¿¡æ¯ç”©ç»™å®ƒï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">uname</span> -a
<span class="hljs-built_in">cat</span> /etc/os-release
<span class="hljs-comment"># å¦‚æœæœ‰æŠ¥é”™æ—¥å¿—</span>
<span class="hljs-built_in">tail</span> -20f /tmp/dev/server-error.log
</code></pre>
<p>å°†è¿™äº› Terminal çš„è¾“å‡ºç›´æ¥ç²˜è´´åˆ° Chat æ¡†é‡Œï¼Œå‡ ä¹ä¸è´¹ä»€ä¹ˆåŠŸå¤«ï¼Œæ¶ˆè€—çš„ token ä¹Ÿå¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œä½†è¿™å¯¹ AI æ¥è¯´æ˜¯æå…¶å…³é”®çš„â€œåœ°é¢å®å†µâ€ã€‚</p>
<p>è™½ç„¶ Cursor å®£ç§°ä¼šè¯»å– Terminal è¾“å‡ºï¼Œä½†å…·ä½“çš„è¯»å–æ—¶æœºå’Œè§¦å‘è§„åˆ™æ˜¯ä¸ªé»‘ç›’ã€‚ä¸å…¶çŒœå®ƒè¯»æ²¡è¯»ï¼Œä¸å¦‚ä¸»åŠ¨å–‚ç»™å®ƒã€‚ç‰¹åˆ«æ˜¯åœ¨å¤„ç†ç¼–è¯‘é”™è¯¯æˆ–ç¯å¢ƒä¾èµ–é—®é¢˜æ—¶ï¼Œä¸€ä»½å®Œæ•´çš„æ—¥å¿—è¿œæ¯”ä½ æè¿°â€œå®ƒæŠ¥é”™äº†â€è¦ç®¡ç”¨ä¸€ä¸‡å€ã€‚</p>
<h3 data-id="heading-6">ï¼ˆä¸ƒï¼‰æ²¡æœ‰ä¸€è¹´è€Œå°±ï¼Œåˆ«äººçš„ rule / prompt å¯èƒ½å¹¶ä¸é€‚åˆä½ </h3>
<p>ç½‘ä¸Šæµä¼ ç€å„ç§â€œç¥çº§ Promptâ€å’Œâ€œä¸‡èƒ½ Ruleâ€ï¼Œä½†æˆ‘å»ºè®®ä½ è°¨æ…å¤åˆ¶ã€‚æ¨¡å‹åœ¨è¿›åŒ–ï¼Œå·¥å…·åœ¨è¿­ä»£ï¼Œä¸Šä¸ªæœˆå¥½ç”¨çš„æŠ€å·§ï¼Œä¸‹ä¸ªæœˆå¯èƒ½å°±å› ä¸ºæ¨¡å‹æƒé‡è°ƒæ•´è€Œå¤±æ•ˆäº†ã€‚</p>
<p>Rule å¹¶ä¸æ˜¯è¶Šå¤æ‚è¶Šå¥½ã€‚ä½ æ²¡å¿…è¦åœ¨ Rule é‡ŒæŠŠå¸¸è¯†å†å¼ºè°ƒä¸€éï¼Œæ¯”å¦‚å†™ä¸Šâ€œä½¿ç”¨ pnpm ç®¡ç†é¡¹ç›®â€å°±è¶³å¤Ÿäº†ï¼Œä¸éœ€è¦å†åºŸè¯ä¸€å¥â€œå…·ä½“å‘½ä»¤è¯·å‚è€ƒ package.jsonâ€ï¼Œæ¨¡å‹éƒ½æ‡‚ã€‚</p>
<p>æ›´é‡è¦çš„æ˜¯ï¼Œå¦‚æœä½ æƒ³æ•™ä¼š AI ä½¿ç”¨æŸç§å†…éƒ¨æ¡†æ¶ï¼Œä¸å…¶åœ¨ Rule é‡Œç”¨è‡ªç„¶è¯­è¨€å–‹å–‹ä¸ä¼‘ï¼Œä¸å¦‚ç›´æ¥æŠŠæ¡†æ¶çš„æ ¸å¿ƒä»£ç æ”¾è¿› workspace é‡Œï¼Œè®©å®ƒæˆä¸ºç´¢å¼•çš„ä¸€éƒ¨åˆ†ã€‚ä»£ç æœ¬èº«å°±æ˜¯æœ€å¥½çš„è¯´æ˜ä¹¦ã€‚ä½ çš„ Rule åº”è¯¥æ˜¯éšç€å¼€å‘è¿‡ç¨‹åŠ¨æ€ç”Ÿé•¿çš„ï¼Œè€Œä¸æ˜¯ä¸€å¼€å§‹å°±å¡è¿›å»ä¸€å †ä½ è‡ªå·±éƒ½æ²¡è¯»å®Œçš„è§„åˆ™ã€‚</p>
<h3 data-id="heading-7">ï¼ˆå…«ï¼‰æ— è®ºæ˜¯æ¨¡å‹è¿˜æ˜¯å·¥å…·ï¼Œæ—¶åˆ»ä¿ç•™å¤šå¥—æ–¹æ¡ˆ</h3>
<p>åœ¨ 2025 å¹´ï¼Œå”¯ä¸€ä¸å˜çš„å°±æ˜¯å˜åŒ–ã€‚æˆ‘ä»¬è§è¯è¿‡æ¨¡å‹çªç„¶â€œé™æ™ºâ€ï¼Œä¹Ÿé‡åˆ°è¿‡æ”¯ä»˜æ¸ é“çªç„¶è¢«åˆ‡æ–­çš„æƒ…å†µã€‚</p>
<p>æ°¸è¿œä¸è¦æŠŠæ‰€æœ‰å¸Œæœ›å¯„æ‰˜åœ¨å•ä¸€æ¨¡å‹ä¸Šã€‚æŸäº›æ¨¡å‹å°±æ˜¯æœ‰å®ƒçš„å±€é™æ€§ï¼Œæ¯”å¦‚æˆ‘æœ‰ä¸€æ¬¡é‡åˆ°ä¸€ä¸ªæ£˜æ‰‹çš„å‰ç«¯ CSS å±‚å ä¸Šä¸‹æ–‡é—®é¢˜ï¼Œåœ¨ ChatGPT 5.2 å’Œ Gemini 3 Pro ä¸ŠæŠ˜è…¾äº†åŠå¤©æ²¡è§£å†³ï¼Œå®ƒä»¬ç»™å‡ºçš„æ–¹æ¡ˆæ€»æ˜¯åœ¨åŸåœ°æ‰“è½¬ã€‚æœ€åæˆ‘åˆ‡åˆ° GitHub Copilot é‡Œçš„ Claude Opus 4.5ï¼Œå®ƒä¸€çœ¼å°±çœ‹å‡ºäº†é—®é¢˜æ‰€åœ¨ã€‚</p>
<p>æ— è®ºæ˜¯ Cursorã€Trae è¿˜æ˜¯ VS Codeï¼Œæ— è®ºæ˜¯ OpenAI è¿˜æ˜¯ Googleï¼Œä¿æŒå·¥å…·é“¾çš„å†—ä½™åº¦ï¼Œæ˜¯ä½ æŒ‰æ—¶äº¤ä»˜çš„æœ€åä¸€é“é˜²çº¿ã€‚</p>
<h3 data-id="heading-8">ï¼ˆä¹ï¼‰æ•°æ®å®‰å…¨å¾ˆé‡è¦ï¼Œè®°å¾—è„±æ•é‡è¦æ•°æ®</h3>
<p>AI è¡Œä¸šç«äº‰è¿™ä¹ˆæ¿€çƒˆï¼Œä½ å¾ˆéš¾ä¿è¯è¿™äº› AI å…¬å¸ä¸ºäº†æ´»ä¸‹å»ï¼Œä¸ä¼šæ‹¿ä½ çš„æ•°æ®å»â€œç‚¼ä¸¹â€ã€‚æ‰€ä»¥ï¼Œå…³äº Tokenã€å¯†é’¥ï¼ˆSecret Keyï¼‰è¿™ç±»æ•æ„Ÿä¿¡æ¯ï¼Œç»å¯¹ä¸èƒ½äº¤ç»™ AIã€‚</p>
<p>å‡¡æ˜¯ä½ ä¸æ•¢æäº¤åˆ°å…¬å…± Git ä»“åº“çš„å†…å®¹ï¼Œä¹ŸåŒæ ·ä¸è¦å‘ç»™ AIã€‚å–„ç”¨ <code>.cursorignore</code> ç­‰é…ç½®æ–‡ä»¶ï¼ŒæŠŠå­˜æ”¾å¯†é’¥çš„æ–‡ä»¶å±è”½æ‰ã€‚</p>
<p>ä½†å¼€å‘åˆç¦»ä¸å¼€è¿™äº›å¯†é’¥ï¼Œæ€ä¹ˆå…¼é¡¾å®‰å…¨å’Œæ–¹ä¾¿å‘¢ï¼Ÿæˆ‘çš„åšæ³•æ˜¯è®© AI æŠŠæ‰€æœ‰æ•æ„Ÿé…ç½®éƒ½æå–æˆç¯å¢ƒå˜é‡ï¼Œè€Œåœ¨ Codespace ä¹‹å¤–çš„åœ°æ–¹ï¼ˆæ¯”å¦‚æœ¬åœ°çš„ <code>~/.bashrc</code>ï¼‰å»å®é™…èµ‹å€¼ã€‚å¦‚æœæŸä¸ªå·¥å…·å¿…é¡»é€šè¿‡å‘½ä»¤è¡Œä¼ å‚ï¼ˆæ¯”å¦‚ <code>--token xxx</code>ï¼‰ï¼Œæˆ‘å°±è®© AI æŠŠè¿™ä¸²å‘½ä»¤å°è£…æˆ <code>run.sh</code>ï¼Œè„šæœ¬é‡Œåªå†™å˜é‡åã€‚è¿™æ · AI çœ‹åˆ°çš„åªæ˜¯ <code>$MY_SECRET_TOKEN</code>ï¼Œè€ŒçœŸå®çš„å¯†é’¥æ°¸è¿œèººåœ¨ä½ æœ¬åœ°çš„ç¡¬ç›˜é‡Œã€‚ä½ ä¹Ÿä¸æƒ³ä½ çš„ Token åœ¨æœªæ¥å‡ºç°åœ¨æŸä¸ªç³Šæ¶‚è›‹å¼€æºé¡¹ç›®çš„ Prompt ç¤ºä¾‹é‡Œå§ï¼Ÿ</p>
<h3 data-id="heading-9">ï¼ˆåï¼‰å¤§åŠ›ä¸èƒ½å‡ºå¥‡è¿¹ï¼Œä¸è¦é™·å…¥â€œåªå’Œ AI èŠå¤©â€å°±èƒ½è§£å†³æ‰€æœ‰é—®é¢˜çš„è¯¯åŒº</h3>
<p>æœ€åä¸€æ¡ï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€æ¡ï¼šå¦‚æœ AI åå¤å‡ æ¬¡éƒ½è§£å†³ä¸äº†ä¸€ä¸ªé—®é¢˜ï¼Œè¯·ç«‹åˆ»åœæ­¢å¯¹è¯ï¼ŒåŠ¨ç”¨ä½ è‡ªå·±çš„è„‘å­ã€‚</p>
<p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬å®¹æ˜“é™·å…¥ä¸€ç§â€œèµŒå¾’å¿ƒç†â€ï¼Œè§‰å¾—ä¸‹ä¸€æ¬¡ Prompt å°±èƒ½ä¿®å¥½äº†ã€‚ä¸¾ä¸ªæˆ‘æœ€è¿‘å¼€å‘ Tauri æ¡Œé¢åº”ç”¨ï¼ˆRust + Vue3 + Viteï¼‰çš„ä¾‹å­ï¼šæˆ‘åœ¨å¼€å‘ç¯å¢ƒä¸‹ï¼ˆdevï¼‰ï¼Œç‚¹å‡»æŒ‰é’®å¯ä»¥æ­£å¸¸å¼¹å‡ºæ¨¡æ€æ¡†ï¼ˆModalï¼‰ï¼›ä½†æ‰“åŒ…å®‰è£…åï¼ˆbuildï¼‰ï¼ŒæŒ‰é’®ç‚¹å‡»å°±æ¯«æ— ååº”ã€‚</p>
<p>æˆ‘æ¢äº†ä¸‰ä¸ªæ¨¡å‹ï¼Œå°è¯•äº†æ”¹ CSS <code>z-index</code>ã€æŸ¥ Webview2 å…¼å®¹æ€§ã€å¯¹æ¯” build/dev ç¯å¢ƒå˜é‡ï¼Œç”šè‡³è®© Agent åœ¨ä»£ç é‡Œåˆ°å¤„æ‰“ logï¼ŒæŠ˜è…¾äº†ä¸€æ™šä¸Šéƒ½æ— è§£ã€‚Log æ˜¾ç¤ºé€»è¾‘æµè½¬ä¸€åˆ‡æ­£å¸¸ã€‚</p>
<p>æœ€åæˆ‘å®åœ¨æ²¡æ‹›äº†ï¼Œåœ¨ dev æ¨¡å¼ä¸‹ä¸»åŠ¨æ‰“å¼€äº† Webview2 çš„æ§åˆ¶å°ï¼ˆConsoleï¼‰ã€‚ä¸€çœ¼å°±çœ‹åˆ°äº†ä¸€ä¸ª Main Window é‡Œçš„æŠ¥é”™ï¼š<code>i18n</code> æŠ¥è­¦ï¼Œæç¤ºæŸä¸ªç¿»è¯‘å ä½ç¬¦ä¸èƒ½ç”¨ <code>@</code>ï¼Œå¿…é¡»ç”¨ <code>{'@'}</code> è½¬ä¹‰ã€‚è¿™ä¸ªé”™è¯¯åœ¨ dev æ¨¡å¼ä¸‹åªæ˜¯ä¸ª Warningï¼Œä¸å½±å“äº¤äº’ï¼›ä½†åœ¨ build åçš„ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œå®ƒç›´æ¥é˜»æ–­äº†åç»­ JS çš„æ‰§è¡Œã€‚</p>
<p>è¿™ä¸ªæŠ¥é”™ä¸åœ¨åç«¯ Log é‡Œï¼Œä¹Ÿä¸åœ¨æ˜¾çœ¼çš„ç»ˆç«¯è¾“å‡ºé‡Œï¼ŒAI è‡ªç„¶â€œçœ‹â€ä¸åˆ°ã€‚è¿™æé†’æˆ‘ä»¬ï¼šAI å†å¼ºä¹Ÿåªæ˜¯è¾…åŠ©ï¼Œä½œä¸ºå·¥ç¨‹å¸ˆï¼Œæ’æŸ¥é—®é¢˜çš„åŸºæœ¬åŠŸï¼ˆæ¯”å¦‚äº²è‡ªçœ‹ä¸€çœ¼æ§åˆ¶å°ï¼‰æ°¸è¿œä¸èƒ½ä¸¢ã€‚</p>
<hr/>
<p>2025 å¹´å¹´åˆï¼Œæˆ‘è¿˜å†™äº†ä¸€ç¯‡å…³äº AI çš„ä½¿ç”¨å¿ƒå¾—ï¼Œé™¤äº†å‘åœ¨å’±å›½å†…çš„å¹³å°ä¸Šï¼Œè¿˜å‘åœ¨äº†æµ·å¤–çš„æŠ€æœ¯è®ºå› dev.to ä¸Šï¼Œæ²¡æœ‰ä»€ä¹ˆåå“ã€‚</p>
<p>ç»“æœæˆ‘å‘ç°ï¼Œè¿™ç¯‡æ–‡ç« è¢«äººæ´—ç¨¿äº†ï¼Œå¹¶ä¸”ç»å¤§éƒ¨åˆ†å†…å®¹æ˜¯åŸå°ä¸åŠ¨åœ°æŠ„è¢­è¿‡å»çš„ã€‚æˆ‘æ˜¯åœ¨ 2025 å¹´ 2 æœˆ 21 æ—¥é¦–å‘åœ¨ dev.to ä¸Šï¼Œå®ƒæ˜¯åœ¨ 2025 å¹´ 3 æœˆ 20 æ—¥æŠŠæ–‡ç« æ´—ç¨¿å‘åˆ° generativeai.pub ä¸Šçš„ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0f08258b389340dc8294d7718fd78690~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUGlwZXLom4vnqp0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768145037&amp;x-signature=cXxs0zlEIgb6%2F5k%2FKGGv17NXWcE%3D" alt="æ–‡ç« æ ‡é¢˜éƒ½æ²¡æœ‰ä¿®æ”¹" loading="lazy"/></p>
<p>é™¤äº†å¼€å¤´åšäº†å¾®å°æ”¹åŠ¨ï¼Œå‰©ä¸‹çš„æ­£æ–‡éƒ¨åˆ†å†…å®¹åŸºæœ¬ä¸€è‡´ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4677fe6f98404e9bb89443a03e5a14f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUGlwZXLom4vnqp0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768145037&amp;x-signature=DsY0ZB42K3y5lSgkCKRq3MxrhyM%3D" alt="æˆ‘çš„åŸæ–‡" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/20093018a250458faa45fd3d0011ea43~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUGlwZXLom4vnqp0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768145037&amp;x-signature=GAvlXxtGm9YYpCHm5UnljiEeOU0%3D" alt="æŠ„è¢­è€…æ–‡ç« " loading="lazy"/></p>
<p>åŸæ–‡é“¾æ¥ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.to%2Fpiperliu%2Fdont-let-ai-programming-ruin-your-career-treat-them-as-your-interns-not-employees-or-teachers-16bo" target="_blank" title="https://dev.to/piperliu/dont-let-ai-programming-ruin-your-career-treat-them-as-your-interns-not-employees-or-teachers-16bo" ref="nofollow noopener noreferrer">dev.to/piperliu/doâ€¦</a></li>
</ul>
<p>æŠ„è¢­è€…é“¾æ¥ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgenerativeai.pub%2Fdont-let-ai-programming-ruin-your-career-treat-them-as-interns-instead-of-employees-teachers-62e278f4db02" target="_blank" title="https://generativeai.pub/dont-let-ai-programming-ruin-your-career-treat-them-as-interns-instead-of-employees-teachers-62e278f4db02" ref="nofollow noopener noreferrer">generativeai.pub/dont-let-aiâ€¦</a></li>
</ul>
<p>å¥½æ¶ˆæ¯æ˜¯ï¼šæŠ„è¢­è€…çš„æ–‡ç« æœ‰è®¸å¤šç‚¹èµä¸è¯„è®ºï¼Œçœ‹æ¥æˆ‘å†™çš„æ–‡ç« è¿˜æ˜¯æœ‰ä¸€å®šå‚è€ƒä»·å€¼çš„ã€‚</p>
<p>åæ¶ˆæ¯æ˜¯ï¼šéƒ½è¯´ä¸­æ–‡äº’è”ç½‘æ˜¯åƒåœ¾å †ï¼Œçœ‹èµ·æ¥è‹±æ–‡äº’è”ç½‘ä¹Ÿæ²¡æœ‰å¥½åˆ°å“ªé‡Œå»ã€‚è¿™å¯¹æˆ‘è¿™ä¸ª Hacker News è€è¯»è€…çš„å†²å‡»æœ‰äº›å¤§ã€‚</p>
<p>å‡†å¤‡æŠ•è¯‰/ç»´æƒè¯•ä¸€è¯•ï¼Œçœ‹çœ‹è¿™äº›å›½é™…å¹³å°æ˜¯å¦çœŸçš„é‚£ä¹ˆå°Šé‡åŸåˆ›ä¸ç‰ˆæƒã€‚</p>
<p>æ¬¢è¿å…³æ³¨æˆ‘ï¼Œä¹‹åæœ‰ç»“æœäº†æˆ‘ä¹Ÿä¼šæŠŠç»å†æ±‡æ€»æˆä¸€ç¯‡æ–‡ç« ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Go é¡¹ç›®ç»“æ„æ€»æ˜¯å†™ä¹±ï¼Ÿè¿™ä¸ª 50 è¡Œä»£ç çš„ Demo æ•™ä½ æ ‡å‡†å§¿åŠ¿]]></title>    <link>https://juejin.cn/post/7591348605865885731</link>    <guid>https://juejin.cn/post/7591348605865885731</guid>    <pubDate>2026-01-04T15:50:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591348605865885731" data-draft-id="7591330139083603983" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Go é¡¹ç›®ç»“æ„æ€»æ˜¯å†™ä¹±ï¼Ÿè¿™ä¸ª 50 è¡Œä»£ç çš„ Demo æ•™ä½ æ ‡å‡†å§¿åŠ¿"/> <meta itemprop="keywords" content="åç«¯,Go"/> <meta itemprop="datePublished" content="2026-01-04T15:50:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Javaå°æˆ"/> <meta itemprop="url" content="https://juejin.cn/user/3614849960783160"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Go é¡¹ç›®ç»“æ„æ€»æ˜¯å†™ä¹±ï¼Ÿè¿™ä¸ª 50 è¡Œä»£ç çš„ Demo æ•™ä½ æ ‡å‡†å§¿åŠ¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3614849960783160/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Javaå°æˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T15:50:23.000Z" title="Sun Jan 04 2026 15:50:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. åœºæ™¯å¤ç°ï¼šé‚£ä¸ªè®©æˆ‘å¤´ç–¼çš„æ—¶åˆ»</h2>
<p>å»å¹´ï¼Œæˆ‘æ¥æ‰‹äº†ä¸€ä¸ª"ç¥–ä¼ " Go é¡¹ç›®ã€‚æ‰“å¼€ä»£ç ä»“åº“çš„é‚£ä¸€åˆ»ï¼Œæˆ‘æ•´ä¸ªäººéƒ½ä¸å¥½äº†â€”â€”æ‰€æœ‰ä»£ç éƒ½å¡åœ¨ä¸€ä¸ª <code>main.go</code> é‡Œï¼Œè¶³è¶³ 3000 å¤šè¡Œã€‚æƒ³åŠ ä¸ªåŠŸèƒ½ï¼Ÿå…ˆèŠ±åŠå°æ—¶æ‰¾ä»£ç åœ¨å“ªã€‚æƒ³å†™ä¸ªå•å…ƒæµ‹è¯•ï¼ŸæŠ±æ­‰ï¼Œå‡½æ•°å…¨æ˜¯ç§æœ‰çš„ï¼Œè€Œä¸”äº’ç›¸è€¦åˆï¼Œæ ¹æœ¬æ²¡æ³•å•ç‹¬æµ‹ã€‚</p>
<p>æˆ‘å½“æ—¶å°±åœ¨æƒ³ï¼š<strong>å¦‚æœå½“åˆå†™è¿™ä¸ªé¡¹ç›®çš„äººï¼Œèƒ½ä»ç¬¬ä¸€å¤©å°±ç”¨ä¸€ä¸ªè§„èŒƒçš„ç»“æ„ï¼Œåé¢çš„äººå¾—å°‘æ‰å¤šå°‘å¤´å‘ï¼Ÿ</strong></p>
<p>åæ¥æˆ‘å¼€å§‹ç ”ç©¶ Go å®˜æ–¹å’Œç¤¾åŒºæ¨èçš„é¡¹ç›®å¸ƒå±€ï¼Œå‘ç°å…¶å®è§„åˆ™å¾ˆç®€å•ï¼Œä½†å¾ˆå¤šäººå°±æ˜¯ä¸çŸ¥é“ã€‚äºæ˜¯æˆ‘å†™äº†è¿™ä¸ª 50 è¡Œä»£ç çš„å° Demoï¼ŒæŠŠ Go é¡¹ç›®ç»“æ„çš„ç²¾é«“æµ“ç¼©è¿›å»ã€‚ä»Šå¤©ï¼Œæˆ‘å°±å¸¦ä½ ä¸€èµ·æ‹†è§£å®ƒã€‚</p>
<h2 data-id="heading-1">2. æ¶æ„è“å›¾ï¼šä¸Šå¸è§†è§’çœ‹è®¾è®¡</h2>
<p>å…ˆæ¥çœ‹è¿™ä¸ªé¡¹ç›®çš„ç›®å½•ç»“æ„ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">series/<span class="hljs-number">01</span>/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ hello/
â”‚       â””â”€â”€ main.go        <span class="hljs-meta"># ç¨‹åºå…¥å£ï¼Œåªåš I/O</span>
â”œâ”€â”€ <span class="hljs-keyword">internal</span>/
â”‚   â””â”€â”€ reasons/
â”‚       â”œâ”€â”€ reasons.go     <span class="hljs-meta"># æ ¸å¿ƒä¸šåŠ¡é€»è¾‘</span>
â”‚       â””â”€â”€ reasons_test.go <span class="hljs-meta"># å•å…ƒæµ‹è¯•</span>
â””â”€â”€ go.mod                  <span class="hljs-meta"># æ¨¡å—å®šä¹‰</span>
</code></pre>
<p>è¿™ä¸æ˜¯æˆ‘éšä¾¿ç”»çš„ï¼Œè€Œæ˜¯ Go ç¤¾åŒºå¹¿æ³›è®¤å¯çš„<strong>æ ‡å‡†é¡¹ç›®å¸ƒå±€</strong>ã€‚æˆ‘ç”¨ä¸€å¼ å›¾æ¥å±•ç¤ºæ•°æ®æ˜¯æ€ä¹ˆæµè½¬çš„ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
    subgraph ç”¨æˆ·å±‚
        A[å‘½ä»¤è¡Œè¾“å…¥&lt;br/&gt;--name=å°æ˜ --lang=go]
    end
    
    subgraph cmd/hello
        B[main.go&lt;br/&gt;è§£æå‚æ•°]
    end
    
    subgraph internal/reasons
        C[reasons.go&lt;br/&gt;ä¸šåŠ¡é€»è¾‘]
        D[(reasonByLang&lt;br/&gt;map æ•°æ®)]
    end
    
    subgraph è¾“å‡ºå±‚
        E[ç»ˆç«¯è¾“å‡º&lt;br/&gt;æ ¼å¼åŒ–ç»“æœ]
    end
    
    A --&gt; B
    B --&gt;|è°ƒç”¨ Reason å‡½æ•°| C
    C --&gt;|æŸ¥è¯¢| D
    D --&gt;|è¿”å›æ¨èç†ç”±| C
    C --&gt;|è¿”å›å­—ç¬¦ä¸²| B
    B --&gt; E
</code></pre>
<p><strong>æ ¸å¿ƒè®¾è®¡æ€æƒ³ï¼šå…³æ³¨ç‚¹åˆ†ç¦»</strong></p>
<ul>
<li><code>cmd/</code> ç›®å½•ï¼šæ”¾å¯æ‰§è¡Œç¨‹åºçš„å…¥å£ã€‚æ¯ä¸ªå­ç›®å½•å¯¹åº”ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚<code>main.go</code> åªè´Ÿè´£"æ¥æ”¶è¾“å…¥ã€è°ƒç”¨ä¸šåŠ¡ã€è¾“å‡ºç»“æœ"ï¼Œä¸å†™ä»»ä½•ä¸šåŠ¡é€»è¾‘ã€‚</li>
<li><code>internal/</code> ç›®å½•ï¼šæ”¾å†…éƒ¨åŒ…ã€‚è¿™ä¸ªç›®å½•æœ‰ä¸ª<strong>é­”æ³•å±æ€§</strong>â€”â€”Go ç¼–è¯‘å™¨ä¼šå¼ºåˆ¶ç¦æ­¢å¤–éƒ¨é¡¹ç›® import è¿™é‡Œçš„ä»£ç ã€‚è¿™æ˜¯ Go è¯­è¨€çº§åˆ«çš„"ç§æœ‰åŒ–"ä¿æŠ¤ã€‚</li>
<li><code>go.mod</code>ï¼šGo Modules çš„é…ç½®æ–‡ä»¶ï¼Œå£°æ˜æ¨¡å—åå’Œ Go ç‰ˆæœ¬ã€‚</li>
</ul>
<h2 data-id="heading-2">3. æºç æ‹†è§£ï¼šæ‰‹æŠŠæ‰‹å¸¦ä½ è¯»æ ¸å¿ƒ</h2>
<h3 data-id="heading-3">3.1 å…¥å£æ–‡ä»¶ï¼šmain.go</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"flag"</span>
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"runtime"</span>
    <span class="hljs-string">"strings"</span>
    <span class="hljs-string">"time"</span>

    <span class="hljs-string">"learn-go/series/01/internal/reasons"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    name := flag.String(<span class="hljs-string">"name"</span>, <span class="hljs-string">"å·¥ç¨‹å¸ˆ"</span>, <span class="hljs-string">"è¯»è€…åç§°"</span>)
    lang := flag.String(<span class="hljs-string">"lang"</span>, <span class="hljs-string">"go"</span>, <span class="hljs-string">"å…³æ³¨çš„è¯­è¨€"</span>)
    flag.Parse()

    lines := []<span class="hljs-type">string</span>{
        fmt.Sprintf(<span class="hljs-string">"ä½ å¥½ï¼Œ%sï¼"</span>, *name),
        fmt.Sprintf(<span class="hljs-string">"ä½ æ­£åœ¨ä½“éªŒï¼š%s"</span>, strings.ToUpper(*lang)),
        fmt.Sprintf(<span class="hljs-string">"ä»Šå¤©çš„ç»“è®ºï¼š%s"</span>, reasons.Reason(*lang)),
        <span class="hljs-comment">// ... çœç•¥éƒ¨åˆ†</span>
    }

    fmt.Println(strings.Join(lines, <span class="hljs-string">"\n"</span>))
}
</code></pre>
<p><strong>é€è¡Œè§£è¯»ï¼š</strong></p>
<p><strong>ç¬¬ 1 è¡Œ <code>package main</code></strong>ï¼šGo è§„å®šï¼Œå¯æ‰§è¡Œç¨‹åºçš„å…¥å£åŒ…å¿…é¡»å« <code>main</code>ï¼Œå…¥å£å‡½æ•°ä¹Ÿå¿…é¡»å« <code>main()</code>ã€‚è¿™æ˜¯é“å¾‹ï¼Œæ²¡å¾—å•†é‡ã€‚</p>
<p><strong>ç¬¬ 10-11 è¡Œ <code>flag.String(...)</code></strong>ï¼šè¿™æ˜¯ Go æ ‡å‡†åº“æä¾›çš„å‘½ä»¤è¡Œå‚æ•°è§£ææ–¹æ¡ˆã€‚</p>
<blockquote>
<p><strong>çŸ¥è¯†ç‚¹è´´å£«ï¼šflag åŒ…</strong></p>
<p><code>flag.String("name", "é»˜è®¤å€¼", "å¸®åŠ©è¯´æ˜")</code> ä¼šè¿”å›ä¸€ä¸ª <code>*string</code>ï¼ˆå­—ç¬¦ä¸²æŒ‡é’ˆï¼‰ï¼Œè€Œä¸æ˜¯ <code>string</code>ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸º <code>flag.Parse()</code> éœ€è¦åœ¨è§£æå®Œå‘½ä»¤è¡Œåï¼ŒæŠŠå€¼"å†™å›"åˆ°è¿™ä¸ªå˜é‡é‡Œã€‚å¦‚æœè¿”å›çš„æ˜¯å€¼è€Œä¸æ˜¯æŒ‡é’ˆï¼Œå°±æ²¡æ³•ä¿®æ”¹äº†ã€‚</p>
<p>ç±»æ¯” Javaï¼šè¿™æœ‰ç‚¹åƒ Java é‡Œç”¨ <code>AtomicReference</code> æ¥å®ç°"å¯å˜çš„å¼•ç”¨"ã€‚</p>
</blockquote>
<p><strong>ç¬¬ 12 è¡Œ <code>flag.Parse()</code></strong>ï¼šçœŸæ­£æ‰§è¡Œè§£æã€‚è°ƒç”¨è¿™è¡Œä¹‹åï¼Œ<code>name</code> å’Œ <code>lang</code> æŒ‡é’ˆæŒ‡å‘çš„å€¼æ‰ä¼šè¢«å¡«å……ã€‚</p>
<p><strong>ç¬¬ 15 è¡Œ <code>*name</code></strong>ï¼šè¿™é‡Œçš„ <code>*</code> æ˜¯<strong>è§£å¼•ç”¨æ“ä½œç¬¦</strong>ï¼Œæ„æ€æ˜¯"å–å‡ºæŒ‡é’ˆæŒ‡å‘çš„å€¼"ã€‚</p>
<blockquote>
<p><strong>çŸ¥è¯†ç‚¹è´´å£«ï¼šæŒ‡é’ˆ</strong></p>
<p>Go çš„æŒ‡é’ˆæ¯” C ç®€å•å¾ˆå¤šâ€”â€”æ²¡æœ‰æŒ‡é’ˆè¿ç®—ï¼Œåªæœ‰"å–åœ°å€ <code>&amp;</code>"å’Œ"è§£å¼•ç”¨ <code>*</code>"ä¸¤ä¸ªæ“ä½œã€‚ä½ å¯ä»¥æŠŠæŒ‡é’ˆç†è§£ä¸º"å˜é‡çš„é—¨ç‰Œå·"ï¼Œ<code>*</code> å°±æ˜¯"æŒ‰é—¨ç‰Œå·æ‰¾åˆ°æˆ¿é—´é‡Œçš„ä¸œè¥¿"ã€‚</p>
</blockquote>
<p><strong>ç¬¬ 17 è¡Œ <code>reasons.Reason(*lang)</code></strong>ï¼šè°ƒç”¨ <code>internal/reasons</code> åŒ…é‡Œçš„ <code>Reason</code> å‡½æ•°ã€‚æ³¨æ„è¿™é‡Œçš„ <code>R</code> æ˜¯å¤§å†™çš„ã€‚</p>
<blockquote>
<p><strong>çŸ¥è¯†ç‚¹è´´å£«ï¼šå¯è§æ€§è§„åˆ™</strong></p>
<p>Go æ²¡æœ‰ <code>public</code>/<code>private</code> å…³é”®å­—ã€‚å®ƒç”¨ä¸€ä¸ªæç®€çš„è§„åˆ™ï¼š<strong>é¦–å­—æ¯å¤§å†™ = å…¬å¼€ï¼Œé¦–å­—æ¯å°å†™ = ç§æœ‰</strong>ã€‚æ‰€ä»¥ <code>Reason</code> èƒ½è¢«å¤–éƒ¨è°ƒç”¨ï¼Œè€Œå¦‚æœå†™æˆ <code>reason</code> å°±åªèƒ½åœ¨ <code>reasons</code> åŒ…å†…éƒ¨ç”¨ã€‚</p>
</blockquote>
<h3 data-id="heading-4">3.2 ä¸šåŠ¡é€»è¾‘ï¼šreasons.go</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> reasons

<span class="hljs-keyword">import</span> <span class="hljs-string">"strings"</span>

<span class="hljs-keyword">var</span> reasonByLang = <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>{
    <span class="hljs-string">"go"</span>:     <span class="hljs-string">"ç¼–è¯‘å¿«ã€éƒ¨ç½²ç®€å•ã€å¹¶å‘æ¨¡å‹æ¸…æ™°ï¼Œé€‚åˆåšåŸºç¡€è®¾æ–½å’ŒæœåŠ¡ç«¯ã€‚"</span>,
    <span class="hljs-string">"python"</span>: <span class="hljs-string">"ç”Ÿæ€ä¸°å¯Œã€éªŒè¯å¿«ï¼Œé€‚åˆæ•°æ®å¤„ç†å’Œè„šæœ¬ã€‚"</span>,
    <span class="hljs-string">"java"</span>:   <span class="hljs-string">"å·¥ç¨‹æˆç†Ÿã€ç”Ÿæ€åºå¤§ï¼Œé€‚åˆå¤§å‹ä¼ä¸šçº§ç³»ç»Ÿã€‚"</span>,
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Reason</span><span class="hljs-params">(lang <span class="hljs-type">string</span>)</span></span> <span class="hljs-type">string</span> {
    key := strings.ToLower(strings.TrimSpace(lang))
    <span class="hljs-keyword">if</span> key == <span class="hljs-string">""</span> {
        key = <span class="hljs-string">"go"</span>
    }
    <span class="hljs-keyword">if</span> reason, ok := reasonByLang[key]; ok {
        <span class="hljs-keyword">return</span> reason
    }
    <span class="hljs-keyword">return</span> <span class="hljs-string">"å…ˆé€‰ä¸€ä¸ªç›®æ ‡åœºæ™¯ï¼Œå†å†³å®šè¯­è¨€ã€‚Go é€‚åˆæœåŠ¡ç«¯ä¸å·¥å…·é“¾ã€‚"</span>
}
</code></pre>
<p><strong>é€è¡Œè§£è¯»ï¼š</strong></p>
<p><strong>ç¬¬ 5-9 è¡Œ <code>var reasonByLang = map[string]string{...}</code></strong>ï¼šè¿™æ˜¯ Go çš„ <code>map</code> ç±»å‹ï¼Œç›¸å½“äº Java çš„ <code>HashMap</code> æˆ– Python çš„ <code>dict</code>ã€‚</p>
<p>æ³¨æ„è¿™é‡Œç”¨çš„æ˜¯<strong>åŒ…çº§å˜é‡</strong>ï¼ˆå®šä¹‰åœ¨å‡½æ•°å¤–é¢ï¼‰ï¼Œå°å†™å¼€å¤´æ„å‘³ç€å®ƒæ˜¯ç§æœ‰çš„ï¼Œå¤–éƒ¨åŒ…è®¿é—®ä¸åˆ°ã€‚è¿™æ˜¯ä¸€ç§å¸¸è§çš„"æ¨¡å—å†…å…±äº«æ•°æ®"çš„æ–¹å¼ã€‚</p>
<p><strong>ç¬¬ 16 è¡Œ <code>if reason, ok := reasonByLang[key]; ok</code></strong>ï¼šè¿™æ˜¯ Go æœ€ç»å…¸çš„æƒ¯ç”¨æ³•ä¹‹ä¸€â€”â€”<strong>comma ok</strong>ã€‚</p>
<blockquote>
<p><strong>çŸ¥è¯†ç‚¹è´´å£«ï¼šcomma ok æƒ¯ç”¨æ³•</strong></p>
<p>åœ¨ Go é‡Œè®¿é—® mapï¼Œå¯ä»¥ç”¨ä¸¤ç§æ–¹å¼ï¼š</p>
<ul>
<li><code>v := m[key]</code>ï¼šå¦‚æœ key ä¸å­˜åœ¨ï¼Œè¿”å›é›¶å€¼ï¼ˆç©ºå­—ç¬¦ä¸²ã€0 ç­‰ï¼‰</li>
<li><code>v, ok := m[key]</code>ï¼š<code>ok</code> æ˜¯ä¸ªå¸ƒå°”å€¼ï¼Œå‘Šè¯‰ä½  key åˆ°åº•å­˜ä¸å­˜åœ¨</li>
</ul>
<p>ç¬¬äºŒç§æ–¹å¼èƒ½åŒºåˆ†"key å­˜åœ¨ä½†å€¼ä¸ºç©º"å’Œ"key æ ¹æœ¬ä¸å­˜åœ¨"ï¼Œæ›´å®‰å…¨ã€‚</p>
</blockquote>
<h3 data-id="heading-5">3.3 å•å…ƒæµ‹è¯•ï¼šreasons_test.go</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> reasons

<span class="hljs-keyword">import</span> <span class="hljs-string">"testing"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">TestReason</span><span class="hljs-params">(t *testing.T)</span></span> {
    tests := []<span class="hljs-keyword">struct</span> {
        name <span class="hljs-type">string</span>
        lang <span class="hljs-type">string</span>
        want <span class="hljs-type">string</span>
    }{
        {name: <span class="hljs-string">"default"</span>, lang: <span class="hljs-string">""</span>, want: reasonByLang[<span class="hljs-string">"go"</span>]},
        {name: <span class="hljs-string">"go"</span>, lang: <span class="hljs-string">"go"</span>, want: reasonByLang[<span class="hljs-string">"go"</span>]},
        {name: <span class="hljs-string">"python"</span>, lang: <span class="hljs-string">"python"</span>, want: reasonByLang[<span class="hljs-string">"python"</span>]},
    }

    <span class="hljs-keyword">for</span> _, tt := <span class="hljs-keyword">range</span> tests {
        t.Run(tt.name, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(t *testing.T)</span></span> {
            <span class="hljs-keyword">if</span> got := Reason(tt.lang); got != tt.want {
                t.Fatalf(<span class="hljs-string">"Reason(%q) = %q, want %q"</span>, tt.lang, got, tt.want)
            }
        })
    }
}
</code></pre>
<p>è¿™æ˜¯ Go ç¤¾åŒºæ¨å´‡çš„**è¡¨é©±åŠ¨æµ‹è¯•ï¼ˆTable-Driven Testï¼‰**é£æ ¼ã€‚</p>
<blockquote>
<p><strong>çŸ¥è¯†ç‚¹è´´å£«ï¼šè¡¨é©±åŠ¨æµ‹è¯•</strong></p>
<p>æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šæŠŠæµ‹è¯•ç”¨ä¾‹ç»„ç»‡æˆä¸€ä¸ª"è¡¨æ ¼"ï¼ˆåˆ‡ç‰‡ï¼‰ï¼Œç„¶åç”¨å¾ªç¯éå†æ‰§è¡Œã€‚å¥½å¤„æ˜¯ï¼š</p>
<ol>
<li>æ–°å¢ç”¨ä¾‹åªéœ€è¦åŠ ä¸€è¡Œæ•°æ®ï¼Œä¸ç”¨å†™é‡å¤çš„æµ‹è¯•ä»£ç </li>
<li>æµ‹è¯•é€»è¾‘é›†ä¸­ï¼Œä¸€çœ¼å°±èƒ½çœ‹å‡ºè¦†ç›–äº†å“ªäº›åœºæ™¯</li>
<li><code>t.Run()</code> ä¼šç»™æ¯ä¸ªç”¨ä¾‹èµ·åå­—ï¼Œå¤±è´¥æ—¶èƒ½ç²¾ç¡®å®šä½</li>
</ol>
</blockquote>
<p><strong>ç¬¬ 16 è¡Œ <code>for _, tt := range tests</code></strong>ï¼š<code>range</code> æ˜¯ Go éå†åˆ‡ç‰‡/map çš„å…³é”®å­—ã€‚<code>_</code> è¡¨ç¤º"æˆ‘ä¸å…³å¿ƒç´¢å¼•ï¼Œåªè¦å€¼"ã€‚</p>
<h2 data-id="heading-6">4. é¿å‘æŒ‡å— &amp; æ·±åº¦æ€è€ƒ</h2>
<h3 data-id="heading-7">å‘ 1ï¼šå¿˜è®°è°ƒç”¨ flag.Parse()</h3>
<p>å¦‚æœä½ åˆ æ‰ <code>flag.Parse()</code> è¿™è¡Œï¼Œç¨‹åºä¸ä¼šæŠ¥é”™ï¼Œä½† <code>*name</code> å’Œ <code>*lang</code> æ°¸è¿œæ˜¯é»˜è®¤å€¼ã€‚è¿™æ˜¯ä¸ªå¾ˆéšè”½çš„ Bugã€‚</p>
<h3 data-id="heading-8">å‘ 2ï¼šmap å¹¶å‘è¯»å†™ä¼š panic</h3>
<p>å½“å‰ä»£ç é‡Œçš„ <code>reasonByLang</code> æ˜¯åªè¯»çš„ï¼Œæ²¡é—®é¢˜ã€‚ä½†å¦‚æœä½ æƒ³åœ¨è¿è¡Œæ—¶åŠ¨æ€æ·»åŠ è¯­è¨€ï¼Œ<strong>åƒä¸‡ä¸è¦</strong>åœ¨å¤šä¸ª goroutine é‡ŒåŒæ—¶è¯»å†™è¿™ä¸ª mapâ€”â€”Go çš„ map ä¸æ˜¯å¹¶å‘å®‰å…¨çš„ï¼Œä¼šç›´æ¥ panicã€‚</p>
<p><strong>ç”Ÿäº§ç¯å¢ƒæ€ä¹ˆåŠï¼Ÿ</strong> ç”¨ <code>sync.RWMutex</code> åŠ é”ï¼Œæˆ–è€…ç”¨ <code>sync.Map</code>ã€‚</p>
<h3 data-id="heading-9">å‘ 3ï¼šinternal ç›®å½•çš„"é­”æ³•"æ˜¯ç¼–è¯‘å™¨å¼ºåˆ¶çš„</h3>
<p>æœ‰äº›åŒå­¦ä»¥ä¸º <code>internal</code> åªæ˜¯ä¸ªå‘½åçº¦å®šï¼Œå…¶å®ä¸æ˜¯ã€‚Go ç¼–è¯‘å™¨ä¼š<strong>ç¡¬æ€§ç¦æ­¢</strong>å¤–éƒ¨æ¨¡å— import <code>internal</code> ä¸‹çš„åŒ…ã€‚å¦‚æœä½ çš„é¡¹ç›®æ˜¯ä¸ªåº“ï¼Œæƒ³æš´éœ²æŸäº›åŒ…ç»™å¤–éƒ¨ç”¨ï¼Œå°±ä¸èƒ½æ”¾åœ¨ <code>internal</code> é‡Œã€‚</p>
<h3 data-id="heading-10">Demo ä¸ç”Ÿäº§ä»£ç çš„å·®è·</h3>
<p>è¿™ä¸ª Demo ä¸ºäº†æ•™å­¦åšäº†ç®€åŒ–ï¼Œç”Ÿäº§ç¯å¢ƒè¿˜éœ€è¦è€ƒè™‘ï¼š</p>
<ol>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šå½“å‰ä»£ç æ²¡æœ‰ä»»ä½• <code>error</code> è¿”å›ï¼ŒçœŸå®åœºæ™¯è¦å¤„ç†å„ç§å¼‚å¸¸</li>
<li><strong>æ—¥å¿—</strong>ï¼šç”¨ <code>log</code> æˆ– <code>slog</code> åŒ…è®°å½•å…³é”®æ“ä½œ</li>
<li><strong>é…ç½®ç®¡ç†</strong>ï¼šç¡¬ç¼–ç çš„ map åº”è¯¥æ”¹æˆä»é…ç½®æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡è¯»å–</li>
<li><strong>ä¼˜é›…é€€å‡º</strong>ï¼šç›‘å¬ç³»ç»Ÿä¿¡å·ï¼Œåšèµ„æºæ¸…ç†</li>
</ol>
<h2 data-id="heading-11">5. å¿«é€Ÿä¸Šæ‰‹ &amp; æ”¹é€ å»ºè®®</h2>
<h3 data-id="heading-12">è¿è¡Œå‘½ä»¤</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿›å…¥é¡¹ç›®ç›®å½•</span>
<span class="hljs-built_in">cd</span> series/01
</code></pre>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç›´æ¥è¿è¡Œ</span>
go run ./cmd/hello
</code></pre>
<p>è¾“å‡ºç»“æœï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ä½ å¥½ï¼Œå·¥ç¨‹å¸ˆï¼
ä½ æ­£åœ¨ä½“éªŒï¼šGO
ä»Šå¤©çš„ç»“è®ºï¼šç¼–è¯‘å¿«ã€éƒ¨ç½²ç®€å•ã€å¹¶å‘æ¨¡å‹æ¸…æ™°ï¼Œé€‚åˆåšåŸºç¡€è®¾æ–½å’ŒæœåŠ¡ç«¯ã€‚
è¿è¡Œç¯å¢ƒï¼šdarwin/amd64
Go ç‰ˆæœ¬ï¼šgo1.25.5
ç”Ÿæˆæ—¶é—´ï¼š2026-01-04T23:02:19+08:00
</code></pre>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¸¦å‚æ•°è¿è¡Œ</span>
go run ./cmd/hello --name=å°æ˜ --lang=python
</code></pre>
<p>è¾“å‡ºç»“æœï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ä½ å¥½ï¼Œå°æ˜ï¼
ä½ æ­£åœ¨ä½“éªŒï¼šPYTHON
ä»Šå¤©çš„ç»“è®ºï¼šç”Ÿæ€ä¸°å¯Œã€éªŒè¯å¿«ï¼Œé€‚åˆæ•°æ®å¤„ç†å’Œè„šæœ¬ã€‚
è¿è¡Œç¯å¢ƒï¼šdarwin/amd64
Go ç‰ˆæœ¬ï¼šgo1.25.5
ç”Ÿæˆæ—¶é—´ï¼š2026-01-04T23:05:54+08:00
</code></pre>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿è¡Œæµ‹è¯•</span>
go <span class="hljs-built_in">test</span> ./internal/reasons -v
</code></pre>
<p>è¾“å‡ºç»“æœï¼š</p>
<pre><code class="hljs language-bash" lang="bash">=== RUN   TestReason
=== RUN   TestReason/default
=== RUN   TestReason/go
=== RUN   TestReason/python
--- PASS: TestReason (0.00s)
    --- PASS: TestReason/default (0.00s)
    --- PASS: TestReason/go (0.00s)
    --- PASS: TestReason/python (0.00s)
PASS
ok      learn-go/series/01/internal/reasons     0.007s
</code></pre>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶</span>
go build -o hello ./cmd/hello
./hello --name=è¯»è€…
</code></pre>
<p>è¾“å‡ºç»“æœï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ä½ å¥½ï¼Œè¯»è€…ï¼
ä½ æ­£åœ¨ä½“éªŒï¼šGO
ä»Šå¤©çš„ç»“è®ºï¼šç¼–è¯‘å¿«ã€éƒ¨ç½²ç®€å•ã€å¹¶å‘æ¨¡å‹æ¸…æ™°ï¼Œé€‚åˆåšåŸºç¡€è®¾æ–½å’ŒæœåŠ¡ç«¯ã€‚
è¿è¡Œç¯å¢ƒï¼šdarwin/amd64
Go ç‰ˆæœ¬ï¼šgo1.25.5
ç”Ÿæˆæ—¶é—´ï¼š2026-01-04T23:07:16+08:00
</code></pre>
<h3 data-id="heading-13">å·¥ç¨‹åŒ–æ”¹é€ å»ºè®®</h3>
<p><strong>å»ºè®® 1ï¼šåŠ å…¥ç»“æ„åŒ–æ—¥å¿—</strong></p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">import</span> <span class="hljs-string">"log/slog"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    slog.Info(<span class="hljs-string">"ç¨‹åºå¯åŠ¨"</span>, <span class="hljs-string">"name"</span>, *name, <span class="hljs-string">"lang"</span>, *lang)
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<p><code>slog</code> æ˜¯ Go 1.21 å¼•å…¥çš„æ ‡å‡†åº“ï¼Œæ”¯æŒ JSON æ ¼å¼è¾“å‡ºï¼Œæ–¹ä¾¿å¯¹æ¥æ—¥å¿—ç³»ç»Ÿã€‚</p>
<p><strong>å»ºè®® 2ï¼šé…ç½®å¤–éƒ¨åŒ–</strong></p>
<p>æŠŠ <code>reasonByLang</code> æ”¹æˆä» YAML/JSON æ–‡ä»¶è¯»å–ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">import</span> <span class="hljs-string">"os"</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">"encoding/json"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">loadReasons</span><span class="hljs-params">(path <span class="hljs-type">string</span>)</span></span> (<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>, <span class="hljs-type">error</span>) {
    data, err := os.ReadFile(path)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
    }
    <span class="hljs-keyword">var</span> m <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>
    err = json.Unmarshal(data, &amp;m)
    <span class="hljs-keyword">return</span> m, err
}
</code></pre>
<p><strong>å»ºè®® 3ï¼šæ·»åŠ ç‰ˆæœ¬ä¿¡æ¯</strong></p>
<p>åˆ©ç”¨ <code>go build -ldflags</code> åœ¨ç¼–è¯‘æ—¶æ³¨å…¥ç‰ˆæœ¬å·ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">var</span> Version = <span class="hljs-string">"dev"</span> <span class="hljs-comment">// ä¼šè¢«ç¼–è¯‘æ—¶è¦†ç›–</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    fmt.Println(<span class="hljs-string">"ç‰ˆæœ¬ï¼š"</span>, Version)
}
</code></pre>
<p>ç¼–è¯‘å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">go build -ldflags <span class="hljs-string">"-X main.Version=v1.0.0"</span> -o hello ./cmd/hello
</code></pre>
<h2 data-id="heading-14">6. æ€»ç»“ä¸è„‘å›¾</h2>
<ul>
<li><strong>cmd/ æ”¾å…¥å£ï¼Œinternal/ æ”¾ç§æœ‰é€»è¾‘</strong>â€”â€”è¿™æ˜¯ Go é¡¹ç›®ç»“æ„çš„é»„é‡‘æ³•åˆ™</li>
<li><strong>flag åŒ…è¿”å›æŒ‡é’ˆ</strong>ï¼Œè®°å¾—ç”¨ <code>*</code> è§£å¼•ç”¨ï¼Œåˆ«å¿˜äº†è°ƒç”¨ <code>Parse()</code></li>
<li><strong>comma ok æƒ¯ç”¨æ³•</strong>ï¼ˆ<code>v, ok := m[key]</code>ï¼‰æ˜¯å®‰å…¨è®¿é—® map çš„æ ‡å‡†å§¿åŠ¿</li>
<li><strong>é¦–å­—æ¯å¤§å°å†™å†³å®šå¯è§æ€§</strong>ï¼Œè¿™æ˜¯ Go ç‹¬ç‰¹çš„"æ— å…³é”®å­—"è®¾è®¡å“²å­¦</li>
<li><strong>è¡¨é©±åŠ¨æµ‹è¯•</strong>è®©ä½ çš„æµ‹è¯•ä»£ç æ›´ç®€æ´ã€æ›´æ˜“ç»´æŠ¤</li>
</ul>
<p>å¦‚æœä½ æ­£å‡†å¤‡å…¥å‘ Goï¼Œä¸å¦¨æŠŠè¿™ä¸ª Demo clone ä¸‹æ¥ï¼Œäº²æ‰‹æ”¹ä¸€æ”¹ã€è·‘ä¸€è·‘ã€‚<strong>çœ‹åéä¸å¦‚å†™ä¸€é</strong>ï¼Œè¿™æ˜¯æˆ‘è¿™äº›å¹´æœ€æ·±çš„ä½“ä¼šã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€è‡´æ€§å“ˆå¸Œä»‹ç»]]></title>    <link>https://juejin.cn/post/7591330139083489295</link>    <guid>https://juejin.cn/post/7591330139083489295</guid>    <pubDate>2026-01-04T14:23:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591330139083489295" data-draft-id="7591156262626459683" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€è‡´æ€§å“ˆå¸Œä»‹ç»"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2026-01-04T14:23:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ˆé‡Œè°¢é¡¿"/> <meta itemprop="url" content="https://juejin.cn/user/3678304397695056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€è‡´æ€§å“ˆå¸Œä»‹ç»
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3678304397695056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ˆé‡Œè°¢é¡¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T14:23:57.000Z" title="Sun Jan 04 2026 14:23:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸€è‡´æ€§å“ˆå¸Œï¼ˆConsistent Hashingï¼‰æ˜¯ä¸€ç§**â€œè®©èŠ‚ç‚¹æ‰©ç¼©å®¹æ—¶ï¼Œå°½å¯èƒ½å°‘åœ°è¿ç§»æ•°æ®â€<strong>çš„åˆ†å¸ƒå¼å“ˆå¸Œç®—æ³•ã€‚<br/>
1997 å¹´ç”± MIT çš„ Karger ç­‰äººæå‡ºï¼Œç°åœ¨å‡ ä¹æˆäº†</strong>åˆ†å¸ƒå¼ç¼“å­˜ã€è´Ÿè½½å‡è¡¡ã€åˆ†åº“åˆ†è¡¨**çš„æ ‡é…ã€‚</p>
<hr/>
<h3 data-id="heading-0">1. ä¼ ç»Ÿå“ˆå¸Œçš„é—®é¢˜</h3>
<p>å‡è®¾æœ‰ N å°ç¼“å­˜èŠ‚ç‚¹ï¼Œç”¨ <code>hash(key) % N</code> å†³å®šæ•°æ®è½åœ¨å“ªå°æœºå™¨ã€‚</p>
<ul>
<li>èŠ‚ç‚¹å®•æœºæˆ–æ–°å¢ 1 å° â†’ N å˜åŒ– â†’ <strong>å‡ ä¹æ‰€æœ‰ key é‡æ–°æ˜ å°„</strong> â†’ ç¼“å­˜é›ªå´©ï¼Œæ•°æ®åº“ç¬é—´è¢«æ‰“çˆ†ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-1">2. ä¸€è‡´æ€§å“ˆå¸Œçš„æ ¸å¿ƒæ€æƒ³</h3>
<p>æŠŠ<strong>å“ˆå¸Œç©ºé—´</strong>æƒ³è±¡æˆä¸€æ¡<strong>é¦–å°¾ç›¸æ¥çš„ 2Â³Â² ç¯å½¢è½¨é“</strong>ï¼ˆ0 â†’ 2Â³Â²-1 â†’ 0ï¼‰ã€‚<br/>
æ­¥éª¤ï¼š</p>
<ol>
<li>èŠ‚ç‚¹å…¥ç¯ï¼šå¯¹èŠ‚ç‚¹ IP/ID åš hashï¼Œå¾—åˆ°å…¶åœ¨ç¯ä¸Šçš„ä½ç½®ã€‚</li>
<li>æ•°æ®å…¥ç¯ï¼šå¯¹ key åš hashï¼Œé¡ºæ—¶é’ˆæ‰¾åˆ°<strong>ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</strong>ï¼Œå°±æ˜¯å®ƒçš„å½’å±ã€‚</li>
<li>èŠ‚ç‚¹å¢å‡ï¼šåªå½±å“<strong>ç¯ä¸Šç›¸é‚»çš„ä¸€æ®µå¼§</strong>ï¼Œå…¶ä½™æ•°æ®åŸåœ°ä¸åŠ¨ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-2">3. è™šæ‹ŸèŠ‚ç‚¹ï¼ˆVirtual Nodesï¼‰â€”â€”è§£å†³â€œå€¾æ–œâ€**</h3>
<p>çœŸå®èŠ‚ç‚¹å¾ˆå°‘æ—¶ï¼Œç¯ä¸Šåˆ†å¸ƒä¸å‡ï¼Œæ˜“äº§ç”Ÿâ€œæ•°æ®æ‰å †â€ã€‚<br/>
ç»™æ¯å°ç‰©ç†èŠ‚ç‚¹ç”Ÿæˆ<strong>ä¸Šç™¾ä¸ªè™šæ‹ŸèŠ‚ç‚¹</strong>ï¼ˆå¦‚ <code>node1#1</code>ã€<code>node1#2</code>â€¦ï¼‰ï¼Œæ‰“æ•£åœ¨ç¯ä¸Šï¼Œ<strong>è´Ÿè½½æ–¹å·®</strong>ç¬é—´ä¸‹é™ã€‚</p>
<hr/>
<h3 data-id="heading-3">4. æ‰©ç¼©å®¹ç¤ºä¾‹</h3>
<ul>
<li>åˆå§‹ 3 å°èŠ‚ç‚¹ A/B/Cï¼Œkey æŒ‰é¡ºæ—¶é’ˆè§„åˆ™è½ç‚¹ã€‚</li>
<li>æ–°å¢èŠ‚ç‚¹ Dï¼Œä½äº Bâ†’C ä¹‹é—´ï¼š<br/>
ä»…æŠŠåŸæœ¬å½’å± C çš„**â€œBâ†’Dâ€**è¿™æ®µ key è¿ç»™ Dï¼Œ<strong>å‰©ä½™ 90%+ æ•°æ®ä¸åŠ¨</strong>ã€‚</li>
<li>èŠ‚ç‚¹ B å®•æœºï¼š<br/>
åŸæ¥ Bâ†’C ä¹‹é—´çš„ key é¡ºæ—¶é’ˆæ»‘åˆ° Cï¼Œ<strong>å…¶ä»–åŒºé—´æ— æ„ŸçŸ¥</strong>ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-4">5. ä»£ç çº§ç›´è§‰ï¼ˆPython ä¼ªä»£ç ï¼‰</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> hashlib, bisect, collections

ring = []                                      <span class="hljs-comment"># æœ‰åºå“ˆå¸Œç¯</span>
vnode_map = {}                                <span class="hljs-comment"># è™šæ‹ŸèŠ‚ç‚¹ â†’ ç‰©ç†èŠ‚ç‚¹</span>
VNODE_PER_NODE = <span class="hljs-number">150</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">_hash</span>(<span class="hljs-params">x</span>):
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(hashlib.md5(x.encode()).hexdigest(), <span class="hljs-number">16</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">add_node</span>(<span class="hljs-params">node</span>):
    <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(VNODE_PER_NODE):
        h = _<span class="hljs-built_in">hash</span>(<span class="hljs-string">f"<span class="hljs-subst">{node}</span>#<span class="hljs-subst">{v}</span>"</span>)
        ring.insert(bisect.bisect_left(ring, h), h)
        vnode_map[h] = node

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_node</span>(<span class="hljs-params">key</span>):
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ring: <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
    h = _<span class="hljs-built_in">hash</span>(key)
    pos = bisect.bisect(ring, h) % <span class="hljs-built_in">len</span>(ring)
    <span class="hljs-keyword">return</span> vnode_map[ring[pos]]
</code></pre>
<p>å¢åˆ èŠ‚ç‚¹åªéœ€ <code>add_node</code>/<code>remove_node</code>ï¼Œè°ƒç”¨ç«¯é›¶æ„ŸçŸ¥ã€‚</p>
<hr/>
<h3 data-id="heading-5">6. ä¸€å¥è¯æ€»ç»“</h3>
<p>ä¸€è‡´æ€§å“ˆå¸Œ = <strong>â€œæŠŠèŠ‚ç‚¹å’Œæ•°æ®æ”¾åˆ°åŒä¸€ä¸ªç¯ä¸Šï¼Œé¡ºæ—¶é’ˆæ‰¾é‚»å±…â€</strong>ï¼Œ<br/>
è®©<strong>èŠ‚ç‚¹å˜åŒ–æ—¶çš„æ•°æ®è¿ç§»é‡ä» O(M) é™åˆ° O(M/N)</strong>ï¼Œ<br/>
å†åŠ è™šæ‹ŸèŠ‚ç‚¹è§£å†³å€¾æ–œï¼Œå°±æˆä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿé‡Œ<strong>æœ€ä¼˜é›…çš„æ•°æ®åˆ†ç‰‡æ–¹æ¡ˆ</strong>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2026äº‘æœåŠ¡å™¨ä»é›¶ æ­å»ºä¸è¿ç»´ æŒ‡å—]]></title>    <link>https://juejin.cn/post/7591422577936728070</link>    <guid>https://juejin.cn/post/7591422577936728070</guid>    <pubDate>2026-01-04T08:36:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591422577936728070" data-draft-id="7590752433988862006" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2026äº‘æœåŠ¡å™¨ä»é›¶ æ­å»ºä¸è¿ç»´ æŒ‡å—"/> <meta itemprop="keywords" content="åç«¯,æœåŠ¡å™¨,JavaScript"/> <meta itemprop="datePublished" content="2026-01-04T08:36:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç™¾ä¸‡å‰ç«¯å‘å‰å†²"/> <meta itemprop="url" content="https://juejin.cn/user/641770519804926"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2026äº‘æœåŠ¡å™¨ä»é›¶ æ­å»ºä¸è¿ç»´ æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/641770519804926/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç™¾ä¸‡å‰ç«¯å‘å‰å†²
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T08:36:45.000Z" title="Sun Jan 04 2026 08:36:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;color:#282d36}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px;color:#2f845e}.markdown-body h2{font-size:22px;display:inline-block;font-weight:700;background:#2f845e;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(47,132,194,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 32px);border-bottom:3px solid #2f845e}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%;box-shadow:6px 6px 6px #888}.markdown-body hr{border:none;border-top:1px solid rgba(66,185,131,.15);margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#f6ffed;color:#52c41a;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:16px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#262626;border:1px solid #2f845e;border-top:8px solid #2f845e;background:linear-gradient(180deg,rgba(66,185,131,.1),transparent)!important}.markdown-body pre&gt;code.hljs[lang]:before{top:8px!important;color:#2f845e!important}.markdown-body pre&gt;code.language-awesome_error{border:1px solid #ff4d4f!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#ff4d4f!important;background:#fff2f0!important}.markdown-body pre&gt;code.language-awesome_error:before{content:"!"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#ff4d4f!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_warn{border:1px solid #ffc46f!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#ffc46f!important;background:#fffbe6!important}.markdown-body pre&gt;code.language-awesome_warn:before{content:"â˜‚"!important;position:absolute;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#ffc46f!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_success{border:1px solid #52c41a!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#52c41a!important;background:#f6ffed!important}.markdown-body pre&gt;code.language-awesome_success:before{content:"âœ“"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#52c41a!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_info{border:1px solid #1890ff!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#1890ff!important;background:#e6f7ff!important}.markdown-body pre&gt;code.language-awesome_info:before{content:"i"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#1890ff!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body strong{background-color:inherit;color:#2f845e}.markdown-body em{background-color:inherit;color:#949415}.markdown-body a{text-decoration:none;color:#2f8e54;border-bottom:1px solid #3f9e64}.markdown-body a:active,.markdown-body a:hover{color:#3f9e64}.markdown-body a[class^=footnote]{margin-left:4px}.markdown-body a:before{content:"â¤ "}.markdown-body table{font-size:12px;width:100%;max-width:100%;overflow:auto;border:2px solid #2f8e54}.markdown-body thead{background:#2f8e54;color:#fff;text-align:left;font-weight:700}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:22px}.markdown-body td{min-width:120px}.markdown-body blockquote{padding:1px 22px;margin:22px 0;border-left:6px solid #2f845e;background-color:rgba(66,185,131,.1);border-radius:2px}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#2f845e}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px;color:#282d36}.markdown-body del{color:#2f845e}.markdown-body input[type=checkbox]:checked:before{content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA/klEQVQ4T72TMU7DQBBF318XdFR06egQEnAXRINEGlqgowoIR8AF4AZOZ4JEGq5AC5EixBU4A55BNrEVHAcSBTHlaubt37/zxZKlcn7n6mDPXJvz8IJ89HzWu8t7C8D2dfsY52ae4apHnLx0ktsCsHXZjiUuFgG40x2eJ/H/AhztB+zDUTpLwWj8jGkzxSHiHaMPrDQC8sMoilKzLAUqiKQjmb+ZuAdW80tmelCHODoNgSfP7AFprTTaRTzsJN1GEyuIZ7uW6TEEHwCtyV/6EVBKJHhfzgC0Xv/iXwEFBF4FG0378bd7sPQq5xK/hSnk6sdlX3mZrKkwLZKBeu8n9XuWEUE7X+YAAAAASUVORK5CYII=);position:relative;top:-1px;left:-1px}.markdown-body .math .katex{font-family:Menlo,Monaco,Consolas,Courier New,monospace;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#f6ffed;color:#52c41a;font-size:.87em;padding:.065em .4em}@media (max-width:720px){.markdown-body h1{font-size:22px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">â“ªã€è´­ä¹°æœåŠ¡å™¨é€‰æ‹©é…ç½®</h2>
<p>ä½œä¸ºå­¦ç”Ÿé¦–æ¬¡ä½¿ç”¨ é€‰ Windows Server ç³»ç»Ÿ ã€‚</p>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dfa23a1c238b4fd68610abd69013540c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55m-5LiH5YmN56uv5ZCR5YmN5Yay:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141911&amp;x-signature=GsbJW%2Fi8OzBlA48%2F2EsyMRjkfWA%3D" alt="å›¾ç‰‡.png" width="50%" loading="lazy"/>
<h2 data-id="heading-1">ä¸€ã€è¿œç¨‹ç™»å½•(winç³»ç»Ÿè‡ªå¸¦å·¥å…·mstsc)</h2>
<h3 data-id="heading-2">1.1è¿œç¨‹ç™»å½•å‡†å¤‡å·¥ä½œ</h3>
<p>âœï¸åˆ›å»ºä¸€ä¸ªæœ¬åœ°è®°äº‹æœ¬ï¼ï¼ï¼è®°å½•ä¸‹æœåŠ¡å™¨å…¬ç½‘IPã€è´¦å·ã€å¯†ç :<br/>
å»ºè®®å¤§å®¶åˆšå¼€å§‹ç”¨å°†æœåŠ¡å™¨é‡æ–°è®¾ç½®ä¸ºé»˜è®¤çš„å¯†ç <br/>
ï¼ˆå¤åˆ¶é“¾æ¥æ‰“å¼€åœ¨äº‘æœåŠ¡å™¨æ§åˆ¶å°å¯ä»¥é‡ç½®ï¼‰<br/></p>
<p>IPåœ°å€:112.124.62.199 (å…¬ç½‘IP)
è´¦å·:<code>administrator</code>
å¯†ç :<code>2026A#a1</code></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable constant_">IP</span>åœ°å€:<span class="hljs-number">112.124</span><span class="hljs-number">.62</span><span class="hljs-number">.199</span> (å…¬ç½‘<span class="hljs-variable constant_">IP</span>)
è´¦å·:administrator 
å¯†ç :2026A#a1
</code></pre>
<h3 data-id="heading-3">1.2è¿œç¨‹ç™»å½•</h3>
<p>æŒ‰é”®ç›˜ Win+Ré”® è¾“å…¥ <code>mstsc</code> ç‚¹ç¡®å®š<br/></p>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/966814c9ec6e4526865a9f69988fadae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55m-5LiH5YmN56uv5ZCR5YmN5Yay:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141911&amp;x-signature=RpivCRAusjBh9lSouP0xWfgFI1s%3D" alt="å›¾ç‰‡.png" width="70%" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4ec80db3cebb4d15ace481297b0f1db6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55m-5LiH5YmN56uv5ZCR5YmN5Yay:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141911&amp;x-signature=6DpfpmSFxXXr%2FCHSydwt%2FUK03NQ%3D" alt="å›¾ç‰‡.png" width="70%" loading="lazy"/>
<h2 data-id="heading-4">ä¸‰ã€æœåŠ¡å™¨ç¯å¢ƒé…ç½®</h2>
<h3 data-id="heading-5">3.1 é…ç½®Node.jsç½‘ç«™è¿è¡Œç¯å¢ƒ</h3>
<p>ä½¿ç”¨æœåŠ¡å™¨ æµè§ˆå™¨ è®¿é—®ç½‘å€<a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2Fzh-cn%2Fdownload" target="_blank" title="https://nodejs.org/zh-cn/download" ref="nofollow noopener noreferrer">nodejs.org/zh-cn/downlâ€¦</a> ï¼Œä¸‹è½½Node.js V24ä»¥ä¸Š
å¹¶å®‰è£…ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8cdcb12570b84a36b8d00ae8923f07e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55m-5LiH5YmN56uv5ZCR5YmN5Yay:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141911&amp;x-signature=ZQ4Lr9Oy8%2B3vORFPpvcs948y6Q0%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bdc9ed7a0e814baca01f035fc0490190~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55m-5LiH5YmN56uv5ZCR5YmN5Yay:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141911&amp;x-signature=4osJTbkJ2eS%2BwEXQHuSiGJAqMX8%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f5703aa8aab64cc5b175decfa2193f83~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55m-5LiH5YmN56uv5ZCR5YmN5Yay:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141911&amp;x-signature=ZIe7NmIkBcRLu43NUKdwVfO7mFE%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<h3 data-id="heading-6">3.2 å°†ä»£ç ä¸Šä¼ è‡³äº‘æœåŠ¡å™¨(è¿œç¨‹ç”µè„‘)</h3>
<p>ç®€å•æ¥è¯´å°±æ˜¯è¦å…±äº«ç¡¬ç›˜ç»™è¿œç¨‹ç”µè„‘ã€‚
åœ¨Dç›˜æˆ–è€…Eç›˜åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹A æˆ–è€…0104ï¼Œå°†ä½ éœ€è¦å±•ç¤ºçš„é¦–é¡µä»£ç æ”¾å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œ
åŒæ—¶ä¸‹è½½ ç”ŸèœæœåŠ¡å™¨ä»£ç  <code>SC.js</code>(åŸå ç”ŸèœæœåŠ¡å™¨1.7.0)</p>
<h5 data-id="heading-7">1ï¼‰å‡†å¤‡ä»£ç æ–‡ä»¶å’Œç´ æ</h5>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b6c9b4c863c0444da55b540b42441201~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55m-5LiH5YmN56uv5ZCR5YmN5Yay:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141911&amp;x-signature=xVr79Nb6cQWu37ixmiSwCQ4W1Ok%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<h5 data-id="heading-8">2ï¼‰å…±äº«æœ¬åœ°ç¡¬ç›˜ç»™ æœåŠ¡å™¨ç”µè„‘</h5>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/99ed275ad645499daf459a69e6171e8e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55m-5LiH5YmN56uv5ZCR5YmN5Yay:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141911&amp;x-signature=tCOb5AZV82GMmcQjjnl739NhLiE%3D" alt="dbc994b353fec7cbc009feff56207338.png" loading="lazy"/></p>
<h5 data-id="heading-9">3ï¼‰ç‚¹å‡»å›æ”¶ç«™ï¼Œè¿›å…¥æˆ‘çš„ç”µè„‘ï¼ŒæŸ¥çœ‹å…±äº«çš„ç¡¬ç›˜ï¼ŒæŠŠæ–‡ä»¶å¤¹æ‹–åˆ°æ¡Œé¢</h5>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e5a37cfdf7c4660931edb765151bd7b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55m-5LiH5YmN56uv5ZCR5YmN5Yay:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141911&amp;x-signature=MXrdEjX37BlBjcHvrRlZu06zUfg%3D" alt="16ad31727504d101ba0ca19b308c52bd_720.png" loading="lazy"/></p>
<h5 data-id="heading-10">4ï¼‰æ‰¾åˆ°ä»£ç æ–‡ä»¶å¤¹ æ‹–åˆ°æœåŠ¡å™¨ç”µè„‘çš„æ¡Œé¢</h5>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57dbe1eaffeb44e3a62285090aec651b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55m-5LiH5YmN56uv5ZCR5YmN5Yay:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141911&amp;x-signature=v4gXqy1FOgRWW%2BpwLt%2BOHfEP9kw%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<h5 data-id="heading-11">5ï¼‰å¯åŠ¨ç”ŸèœæœåŠ¡å™¨ï¼Œè¿™ä¸ªçª—å£ä¸è¦å…³</h5>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/41451454138f40a5a281fbdd6f159ab8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55m-5LiH5YmN56uv5ZCR5YmN5Yay:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141911&amp;x-signature=dgtjqNGjSqm05z0qZkRT062SJfU%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>ç‰¹åˆ«æ³¨æ„:åç»­ä¼ HTML+CSS+JSéƒ½ä¸éœ€è¦é‡å¯æœåŠ¡å™¨ã€‚åªè¦ä¿æŒé»‘è‰²çª—å£å¯åŠ¨æœåŠ¡å™¨ï¼Œè¿‡å‡ åˆ†é’Ÿè‡ªåŠ¨ä¼šåˆ·æ–°ã€‚</p>
<h2 data-id="heading-12">å››ã€å¼€å¯äº‘æœåŠ¡å™¨é˜²ç«å¢™å…è®¸80ç«¯å£</h2>
<p>ç°åœ¨åªå·®æœ€åä¸€æ­¥ï¼Œå› ä¸ºäº‘æœåŠ¡å™¨çš„è‡ªå¸¦çš„å®‰å…¨ç­–ç•¥æ˜¾ç¤ºï¼Œç½‘ç«™çš„80ç«¯å£æ²¡æœ‰å¯¹å¤–å¼€æ”¾ï¼Œæˆ‘ä»¬å¢åŠ 80ç«¯å£çš„å¯¹å¤–å¼€æ”¾å³å¯ã€‚</p>
<h3 data-id="heading-13">4.1 è¿›å…¥ECS æ§åˆ¶å°å®ä¾‹</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fecs.console.aliyun.com%2Fserver%2F" target="_blank" title="https://ecs.console.aliyun.com/server/" ref="nofollow noopener noreferrer">ecs.console.aliyun.com/server/</a>
ä¾æ¬¡è¿›å…¥:ECSç¤ºä¾‹â†’ç½‘ç»œä¸å®‰å…¨ç»„â†’æ·»åŠ å…¥ç«™æ–¹å‘è§„åˆ™
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/80f346c92d3643d681371dcb7e0f0424~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55m-5LiH5YmN56uv5ZCR5YmN5Yay:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141911&amp;x-signature=Jlu0YihX0CiK%2Bsd3Z9pWGv3LerU%3D" alt="4a2d71ab4fe84a3bb7c775d8c4a20fd7_720.png" loading="lazy"/></p>
<h3 data-id="heading-14">4.2 æ·»åŠ http 80ç«¯å£è§„åˆ™</h3>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºç¡®å®šã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/922649ba659948e28a8889a1f1b41388~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55m-5LiH5YmN56uv5ZCR5YmN5Yay:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768141911&amp;x-signature=OTkb%2BzmcHiqE3o9KcYA3kutrU0A%3D" alt="3fb4181539af37311d6fc43178e8e288_720.png" loading="lazy"/></p>
<h3 data-id="heading-15">4.3 æµè§ˆå™¨è¾“å…¥å…¬ç½‘IPè®¿é—®å³å¯ã€‚</h3>
<p>å…¬ç½‘IPæ”¯æŒä»»æ„å¯ä»¥ä¸Šç½‘çš„è®¾å¤‡ï¼ŒåŒ…æ‹¬æ‰‹æœºã€ç”µè„‘ç­‰ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[DeepSeekæ–°å¹´ç‚¸åœºï¼šç»™å¤±æ§çš„AIæ¨¡å‹è£…ä¸Šæ•°å­¦çº¢ç»¿ç¯]]></title>    <link>https://juejin.cn/post/7591317772074582035</link>    <guid>https://juejin.cn/post/7591317772074582035</guid>    <pubDate>2026-01-04T14:40:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591317772074582035" data-draft-id="7591334602427236415" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="DeepSeekæ–°å¹´ç‚¸åœºï¼šç»™å¤±æ§çš„AIæ¨¡å‹è£…ä¸Šæ•°å­¦çº¢ç»¿ç¯"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2026-01-04T14:40:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¢¨é£å¦‚é›ª"/> <meta itemprop="url" content="https://juejin.cn/user/4064249017803927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            DeepSeekæ–°å¹´ç‚¸åœºï¼šç»™å¤±æ§çš„AIæ¨¡å‹è£…ä¸Šæ•°å­¦çº¢ç»¿ç¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4064249017803927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¢¨é£å¦‚é›ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T14:40:05.000Z" title="Sun Jan 04 2026 14:40:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>2025å¹´çš„è·¨å¹´å¤œï¼Œå½“å¤§å¤šæ•°äººè¿˜åœ¨å€’æ•°è®¡æ—¶è¿æ¥æ–°å¹´çš„æ—¶å€™ï¼ŒDeepSeekçš„å›¢é˜Ÿå¹²äº†ä¸€ä»¶éå¸¸æå®¢çš„äº‹â€”â€”ä»–ä»¬ç”©å‡ºäº†ä¸€ç¯‡é‡ç£…è®ºæ–‡ã€‚</p>
<p>è¿™ç¯‡åä¸ºã€ŠmHC: Manifold-Constrained Hyper-Connectionsã€‹çš„è®ºæ–‡ï¼Œçœ‹ä¼¼æ ‡é¢˜å……æ»¡äº†æ™¦æ¶©çš„æ•°å­¦åè¯ï¼Œä½†å®é™…ä¸Šï¼Œå®ƒå¯èƒ½åˆšåˆšè§£å¼€äº†å›°æ‰°å¤§æ¨¡å‹ç•Œå·²ä¹…çš„ä¸€ä¸ªæ­»ç»“ï¼š<strong>æ¨¡å‹è¶Šå¤§ï¼Œè¶Šå®¹æ˜“ç»ƒå´©ã€‚</strong></p>
<p>ä»Šå¤©æˆ‘ä»¬å°±æŠ›å¼€é‚£äº›å¤æ‚çš„å…¬å¼ï¼Œç”¨äººè¯èŠèŠè¿™é¡¹å¯èƒ½å®šä¹‰â€œåTransformeræ—¶ä»£â€çš„æ–°æŠ€æœ¯ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2FiShot_2026-01-04_22.28.40-1024x547.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/iShot_2026-01-04_22.28.40-1024x547.png" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19e57f8fd38846818d099a20c8e5cca0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768142405&amp;x-signature=IhJA2XveVygi%2BHz06LgqGly%2FWp0%3D" alt="iShot_2026-01-04_22.28.40" loading="lazy"/></a></p>
<h3 data-id="heading-0">è´ªå©ªçš„ä»£ä»·ï¼šå½“â€œå®½å¸¦â€å˜æˆç¾éš¾</h3>
<p>è¿‡å»è¿™åå¹´ï¼Œæ·±åº¦å­¦ä¹ èƒ½å‘å±•è¿™ä¹ˆå¿«ï¼Œä½•å‡¯æ˜å¤§ç¥çš„ResNetï¼ˆæ®‹å·®è¿æ¥ï¼‰åŠŸä¸å¯æ²¡ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€æ¡â€œç›´é€šè½¦é“â€ï¼Œä¿è¯äº†ä¿¡æ¯åœ¨æ·±å±‚ç½‘ç»œä¸­ä¸ä¼šè¿·è·¯ã€‚</p>
<p>åˆ°äº†2024å¹´ï¼Œå­—èŠ‚è·³åŠ¨æå‡ºäº†ä¸€ä¸ªå«â€œè¶…è¿æ¥â€ï¼ˆHyper-Connections, HCï¼‰çš„ä¸œè¥¿ã€‚æ€è·¯å¾ˆç›´æ¥ï¼šæ—¢ç„¶ä¸€æ¡ç›´é€šè½¦é“å¥½ç”¨ï¼Œé‚£æˆ‘æŠŠè½¦é“æ‹“å®½æˆåæ¡ã€ç™¾æ¡ï¼Œè®©ä¿¡æ¯åœ¨ä¸åŒè½¦é“é—´éšæ„ç©¿æ¢­ã€äº¤äº’ï¼Œæ¨¡å‹èƒ½åŠ›å²‚ä¸æ˜¯è¦èµ·é£ï¼Ÿ</p>
<p>ç¡®å®ï¼ŒHCè®©æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›å˜å¼ºäº†ï¼Œä½†ä¹Ÿå¸¦æ¥äº†ä¸€ä¸ªè‡´å‘½å‰¯ä½œç”¨â€”â€”<strong>ä¿¡å·å¤±æ§</strong>ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æŠŠåŸæ¥çš„å•è¡Œé“æ”¹æˆäº†ä¸€ä¸ªæ²¡æœ‰äº¤é€šè§„åˆ™çš„è¶…çº§å¹¿åœºã€‚ä¿¡æ¯åœ¨é‡Œé¢ç–¯ç‹‚ç¢°æ’ã€å åŠ ã€‚DeepSeekçš„å®éªŒæ•°æ®æ˜¾ç¤ºï¼Œåœ¨ä¼ ç»Ÿçš„HCæ¶æ„ä¸‹ï¼Œéšç€å±‚æ•°åŠ æ·±ï¼Œä¿¡å·å¼ºåº¦å¯èƒ½ä¼šè¢«æ— è„‘æ”¾å¤§3000å€ã€‚è¿™å°±å¥½æ¯”ä½ åœ¨éº¦å…‹é£å‰è½»å£°è¯´å¥è¯ï¼ŒéŸ³å“é‡Œå‡ºæ¥çš„å´æ˜¯æ ¸çˆ†èˆ¬çš„å™ªéŸ³ã€‚</p>
<p>ç»“æœå°±æ˜¯ï¼šæ˜¾å­˜çˆ†ç‚¸ï¼Œæ¢¯åº¦æ¶ˆå¤±ï¼Œè®­ç»ƒæ›²çº¿åƒè¿‡å±±è½¦ä¸€æ ·å‡ºç°å°–å³°ï¼Œæœ€åæ¨¡å‹å½»åº•â€œç»ƒåºŸäº†â€ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2FiShot_2026-01-04_22.28.48-1024x409.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/iShot_2026-01-04_22.28.48-1024x409.png" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ba5566a1a6e045bcaaf42841aedc514e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768142405&amp;x-signature=p0V09wZX0IJ6quqAFm6FSpTmqOo%3D" alt="iShot_2026-01-04_22.28.48" loading="lazy"/></a></p>
<h3 data-id="heading-1">æˆ´ç€é•£é“è·³èˆï¼šmHCçš„ä¼˜é›…è§£æ³•</h3>
<p>DeepSeekæå‡ºçš„mHCï¼ˆæµå½¢çº¦æŸè¶…è¿æ¥ï¼‰ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ç»™é‚£ä¸ªæ··ä¹±çš„è¶…çº§å¹¿åœºè£…ä¸Šäº†ä¸€å¥—æå…¶ç²¾å¯†çš„â€œæ™ºèƒ½çº¢ç»¿ç¯ç³»ç»Ÿâ€ã€‚</p>
<p>è¿™é‡Œçš„æ ¸å¿ƒé­”æ³•åœ¨äº**â€œæµå½¢çº¦æŸâ€**ã€‚</p>
<p>å›¢é˜Ÿå¼•å…¥äº†æ•°å­¦ä¸Šçš„â€œåŒéšæœºçŸ©é˜µâ€æ¦‚å¿µã€‚ç®€å•æ¥è¯´ï¼Œä»–ä»¬é€šè¿‡ä¸€ä¸ªå«Sinkhorn-Knoppçš„ç»å…¸ç®—æ³•ï¼Œå¼ºåˆ¶è¦æ±‚ç½‘ç»œä¸­çš„æ¯ä¸€æ¬¡ä¿¡æ¯äº¤æ¢éƒ½å¿…é¡»éµå®ˆä¸€ä¸ªè§„åˆ™ï¼š<strong>èƒ½é‡å®ˆæ’</strong>ã€‚ä¸ç®¡ä¿¡æ¯æ€ä¹ˆå˜é“ã€æ€ä¹ˆæ··åˆï¼Œè¿›å»å¤šå°‘èƒ½é‡ï¼Œå‡ºæ¥è¿˜æ˜¯å¤šå°‘èƒ½é‡ã€‚</p>
<p>è¿™ç§åšæ³•æŠŠåŸæœ¬ç‹‚é‡çš„ä¿¡å·æ”¾å¤§å˜æˆäº†ä¿¡å·çš„â€œå‡¸ç»„åˆâ€ï¼ˆConvex Combinationï¼‰ã€‚è¿™å°±åƒè°ƒé¸¡å°¾é…’ï¼Œä¸ç®¡ä½ æ€ä¹ˆæ‘‡æ™ƒæ··åˆï¼Œé…’çš„æ€»é‡ä¸ä¼šå‡­ç©ºå˜å¤šï¼Œä¹Ÿä¸ä¼šå‡­ç©ºæ¶ˆå¤±ã€‚</p>
<p>è¿™ä¸€æ”¹ï¼Œå¥‡è¿¹å‘ç”Ÿäº†ã€‚</p>
<p>åŸæœ¬å¯èƒ½æ”¾å¤§3000å€çš„ä¿¡å·ï¼Œç°åœ¨è¢«ç¨³ç¨³æ§åˆ¶åœ¨1.6å€å·¦å³ã€‚é‚£æ¡åŸæœ¬è¿˜è¦é è¿æ°”æ‰èƒ½è·‘é€šçš„è®­ç»ƒæ›²çº¿ï¼Œç¬é—´å˜å¾—ä¸èˆ¬é¡ºæ»‘ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2FiShot_2026-01-04_22.28.54-1024x178.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/iShot_2026-01-04_22.28.54-1024x178.png" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/598287a8b2d54729b2e5e0817677d307~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768142405&amp;x-signature=UbxfNoC%2Bcbylfo3hGqPhAe0e7Yc%3D" alt="iShot_2026-01-04_22.28.54" loading="lazy"/></a></p>
<h3 data-id="heading-2">æå…¶æŠ é—¨çš„å·¥ç¨‹ä¼˜åŒ–</h3>
<p>å…‰æœ‰æ•°å­¦ç†è®ºæ²¡ç”¨ï¼Œå¦‚æœè·‘å¾—æ…¢ï¼Œå·¥ä¸šç•Œæ ¹æœ¬ä¸ä¼šçœ‹ä¸€çœ¼ã€‚DeepSeekè¿™å¸®äººæœ€å¯æ€•çš„åœ°æ–¹åœ¨äºï¼Œä»–ä»¬ä¸ä»…æ‡‚æ•°å­¦ï¼Œè¿˜æå…¶æ“…é•¿æŠ ç®—åŠ›ã€‚</p>
<p>ä¸ºäº†æŠŠè¿™ä¸ªå¤æ‚çš„æ•°å­¦çº¦æŸæ¬åˆ°GPUä¸Šè·‘ï¼Œä»–ä»¬åšäº†ä¸€ç³»åˆ—â€œä¸§å¿ƒç—…ç‹‚â€çš„ä¼˜åŒ–ï¼š</p>
<ol>
<li><strong>ç®—å­èåˆ</strong>ï¼šæŠŠå¥½å‡ ä¸ªè®¡ç®—æ­¥éª¤æ‰æˆä¸€æ­¥åšï¼Œå‡å°‘GPUè¯»å–å†…å­˜çš„æ¬¡æ•°ã€‚</li>
<li><strong>é€‰æ‹©æ€§é‡è®¡ç®—</strong>ï¼šä¸ºäº†çœæ˜¾å­˜ï¼Œæœ‰äº›ä¸­é—´ç»“æœç®—å®Œå°±æ‰”ï¼Œéœ€è¦æ—¶å†ç®—ï¼Œè€Œä¸”ä»–ä»¬ç®—å‡†äº†å“ªäº›è¯¥æ‰”ã€å“ªäº›è¯¥ç•™ã€‚</li>
</ol>
<p>ç»“æœå¦‚ä½•ï¼Ÿåœ¨æŠŠæ¨¡å‹å®½åº¦æ‰©å±•4å€çš„æƒ…å†µä¸‹ï¼ŒmHCæ¶æ„åªå¢åŠ äº†**6.7%**çš„é¢å¤–è®­ç»ƒæ—¶é—´ã€‚è¿™å°±å¥½æ¯”ä½ ç»™æ³•æ‹‰åˆ©æ¢äº†ä¸ªæ›´ç¨³çš„å¼•æ“ï¼Œæé€Ÿæ²¡æ‰ï¼Œæ²¹è€—ä¹Ÿæ²¡æ€ä¹ˆæ¶¨ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2FiShot_2026-01-04_22.29.00-1024x397.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/iShot_2026-01-04_22.29.00-1024x397.png" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/75bfe28a0c53414fa8f45a6f237f64a2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768142405&amp;x-signature=yzE3zgZU35BnV22%2BEdtxftNTbdA%3D" alt="iShot_2026-01-04_22.29.00" loading="lazy"/></a></p>
<h3 data-id="heading-3">å®æˆ˜ï¼š27Bæ¨¡å‹çš„å…¨é¢ç¢¾å‹</h3>
<p>DeepSeekæ²¡åœ¨å°æ¨¡å‹ä¸Šç©è¿‡å®¶å®¶ï¼Œç›´æ¥æ‹¿27Bå‚æ•°çš„æ¨¡å‹å¼€åˆ€ã€‚</p>
<p>å®éªŒç»“æœéå¸¸â€œå‡¡å°”èµ›â€ï¼š</p>
<ul>
<li><strong>ç¨³</strong>ï¼šé‚£äº›è®©å·¥ç¨‹å¸ˆå¤´ç§ƒçš„Losså°–å³°å®Œå…¨æ¶ˆå¤±ã€‚</li>
<li><strong>å¼º</strong>ï¼šåœ¨æ•°å­¦æ¨ç†ï¼ˆGSM8Kï¼‰ã€å¸¸è¯†é—®ç­”ï¼ˆBBHï¼‰ç­‰8é¡¹ç¡¬æ ¸æµ‹è¯•ä¸­ï¼Œå…¨é¢åŠæ‰“åŸºçº¿æ¨¡å‹ã€‚ç‰¹åˆ«æ˜¯åœ¨éœ€è¦ç»•å¼¯å­æ€è€ƒçš„BBHå’ŒDROPä»»åŠ¡ä¸Šï¼Œç›´æ¥æå‡äº†çº¦2%çš„æ€§èƒ½ã€‚</li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2FiShot_2026-01-04_22.29.07-1024x320.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/iShot_2026-01-04_22.29.07-1024x320.png" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2678e783ca2b43718b3da5c98062d442~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768142405&amp;x-signature=mlH9v0DiPi5m2JO8RmXVhkDBobA%3D" alt="iShot_2026-01-04_22.29.07" loading="lazy"/></a></p>
<h3 data-id="heading-4">ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ï¼Ÿ</h3>
<p>ä½ å¯èƒ½ä¼šè§‰å¾—ï¼Œè¿™ä¸å°±æ˜¯ä¸€ä¸ªæ¶æ„å¾®è°ƒå—ï¼Ÿ</p>
<p>å…¶å®ä¸ç„¶ã€‚mHCçš„å‡ºç°æ ‡å¿—ç€å¤§æ¨¡å‹è®¾è®¡çš„ä¸€ä¸ªè½¬æŠ˜ç‚¹ã€‚å®ƒå‘Šè¯‰æˆ‘ä»¬ï¼Œå•çº¯åœ°å †å‚æ•°ã€å †å±‚æ•°å·²ç»å¿«èµ°åˆ°å¤´äº†ã€‚æœªæ¥çš„æ–¹å‘ï¼Œæ˜¯ç ”ç©¶å±‚ä¸å±‚ä¹‹é—´å¦‚ä½•æ›´â€œå‡ ä½•â€åœ°è¿æ¥ã€‚</p>
<p>DeepSeekç”¨mHCè¯æ˜äº†ï¼šåœ¨è¿™ä¸ªç®—åŠ›æ˜‚è´µçš„æ—¶ä»£ï¼Œ<strong>æ•°å­¦ä¸Šçš„ä¸¥è°¨çº¦æŸï¼Œåè€Œæ˜¯é€šå‘æ›´å¤§è‡ªç”±åº¦çš„æ·å¾„ã€‚</strong></p>
<p>è¿™ä¸ä»…ä»…æ˜¯è®©å¤§å‚èƒ½æ›´ç¨³åœ°è®­ç»ƒä¸‡äº¿æ¨¡å‹ï¼Œä¹Ÿè®©èµ„æºæœ‰é™çš„å›¢é˜Ÿä¸å†å› ä¸ºä¸€æ¬¡â€œç‚¸ç‚‰â€è€Œå€¾å®¶è¡äº§ã€‚è¿™å°±æ˜¯æŠ€æœ¯çš„æµªæ¼«ä¹‹å¤„â€”â€”ç”¨æœ€æŠ½è±¡çš„æ•°å­¦ï¼Œè§£å†³æœ€ç°å®çš„éš¾é¢˜ã€‚</p>
<p><strong>å¦‚æœä½ ä¹Ÿå¯¹æœ€æ–°çš„AIä¿¡æ¯æ„Ÿå…´è¶£æˆ–è€…æœ‰ç–‘é—® éƒ½å¯ä»¥åŠ å…¥æˆ‘çš„å¤§å®¶åº­ ç¬¬ä¸€æ—¶é—´åˆ†äº«æœ€æ–°AIèµ„è®¯ã€å·¥å…·ã€æ•™ç¨‹ã€æ–‡æ¡£ æ¬¢è¿ä½ çš„åŠ å…¥ï¼ï¼ï¼ğŸ˜‰ğŸ˜‰ğŸ˜‰</strong></p>
<p>å…¬ä¼—å·ï¼šå¢¨é£å¦‚é›ªå°ç«™</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[FastAPI ä» 0 åˆ° 1ï¼šå²ä¸Šæœ€è‰¯å¿ƒçš„ç°ä»£ Python Web æ¡†æ¶å…¥é—¨æŒ‡å—]]></title>    <link>https://juejin.cn/post/7591309945511149568</link>    <guid>https://juejin.cn/post/7591309945511149568</guid>    <pubDate>2026-01-04T14:47:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591309945511149568" data-draft-id="7591309945511133184" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="FastAPI ä» 0 åˆ° 1ï¼šå²ä¸Šæœ€è‰¯å¿ƒçš„ç°ä»£ Python Web æ¡†æ¶å…¥é—¨æŒ‡å—"/> <meta itemprop="keywords" content="FastAPI"/> <meta itemprop="datePublished" content="2026-01-04T14:47:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ˆé‡Œè°¢é¡¿"/> <meta itemprop="url" content="https://juejin.cn/user/3678304397695056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            FastAPI ä» 0 åˆ° 1ï¼šå²ä¸Šæœ€è‰¯å¿ƒçš„ç°ä»£ Python Web æ¡†æ¶å…¥é—¨æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3678304397695056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ˆé‡Œè°¢é¡¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T14:47:04.000Z" title="Sun Jan 04 2026 14:47:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ ‡ç­¾ï¼š<br/>
FastAPI Â· Python Â· å¼‚æ­¥ Â· ç±»å‹æç¤º Â· è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£ Â· é«˜æ€§èƒ½</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆåˆæ˜¯æ–°æ¡†æ¶ï¼Ÿ</h2>
<p>Django / Flask å·²ç»å¤Ÿå¥½äº†ï¼Œä½†æ–°æ—¶ä»£æœ‰äº†æ–°ç—›ç‚¹ï¼š</p>
<ol>
<li>å‰åç«¯åˆ†ç¦» â†’ éœ€è¦<strong>å¼ºåˆ¶ç±»å‹ &amp; è‡ªåŠ¨æ–‡æ¡£</strong></li>
<li>é«˜å¹¶å‘ IO â†’ éœ€è¦<strong>åŸç”Ÿå¼‚æ­¥</strong></li>
<li>æœºå™¨å­¦ä¹ æ¨¡å‹ä¸Šçº¿ â†’ éœ€è¦<strong>é«˜æ€§èƒ½ + è‡ªåŠ¨åºåˆ—åŒ–</strong></li>
</ol>
<p>FastAPI = Starletteï¼ˆå¼‚æ­¥ï¼‰+ Pydanticï¼ˆæ•°æ®æ ¡éªŒï¼‰+ è‡ªåŠ¨ç”Ÿæˆ OpenAPI æ–‡æ¡£ï¼Œä¸‰ç®­é½å‘ï¼Œå®˜æ–¹ benchmark  latency ç›´è¿½ NodeJS å’Œ Goã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€5 åˆ†é’Ÿè·‘é€š Hello World</h2>
<p>å®‰è£…</p>
<pre><code class="hljs language-bash" lang="bash">pip install <span class="hljs-string">"fastapi[all]"</span>   <span class="hljs-comment"># all = uvicorn + å¸¸ç”¨ extras</span>
</code></pre>
<p>main.py</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI

app = FastAPI(title=<span class="hljs-string">"Hello API"</span>)

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/"</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">root</span>():
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"Hello FastAPI"</span>}
</code></pre>
<p>å¯åŠ¨</p>
<pre><code class="hljs language-bash" lang="bash">uvicorn main:app --reload
</code></pre>
<p>æµè§ˆå™¨è®¿é—® <a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A8000" target="_blank" title="http://127.0.0.1:8000" ref="nofollow noopener noreferrer">http://127.0.0.1:8000</a><br/>
äº¤äº’å¼æ–‡æ¡£ <a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A8000%2Fdocs" target="_blank" title="http://127.0.0.1:8000/docs" ref="nofollow noopener noreferrer">http://127.0.0.1:8000/docs</a>ï¼ˆSwagger UIï¼‰è‡ªåŠ¨ç”Ÿæˆï¼</p>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€ç±»å‹æç¤º = è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£ + è¿è¡Œæ—¶æ ¡éªŒ</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Item</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    name: <span class="hljs-built_in">str</span>
    price: <span class="hljs-built_in">float</span>
    tax: <span class="hljs-built_in">float</span> | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>

<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/items/"</span>, response_model=Item</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_item</span>(<span class="hljs-params">item: Item</span>):
    <span class="hljs-keyword">if</span> item.tax:
        item.price += item.tax
    <span class="hljs-keyword">return</span> item    <span class="hljs-comment"># è‡ªåŠ¨åºåˆ—åŒ– JSON</span>
</code></pre>
<ul>
<li>è¯·æ±‚ä½“å°‘å­—æ®µ â†’ 422 é”™è¯¯ + è¯¦ç»†ä½ç½®æç¤º</li>
<li>æ–‡æ¡£é‡Œ Schema ä¸ä»£ç <strong>å•ç‚¹çœŸç†</strong>ï¼Œæ°¸ä¸åŒæ­¥å¤±è´¥</li>
</ul>
<hr/>
<h2 data-id="heading-3">å››ã€å¼‚æ­¥å…¨ç¨‹é«˜èƒ½</h2>
<p>FastAPI é»˜è®¤åŸºäº <code>async def</code>ï¼Œä¸ <code>asyncio</code>ã€<code>aiohttp</code>ã€<code>aiomysql</code> å…¨å®¶æ¡¶æ— ç¼åä½œï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">from</span> aiohttp <span class="hljs-keyword">import</span> ClientSession

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/proxy"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">proxy</span>():
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> ClientSession() <span class="hljs-keyword">as</span> sess:
        <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> sess.get(<span class="hljs-string">"https://httpbin.org/delay/2"</span>) <span class="hljs-keyword">as</span> r:
            data = <span class="hljs-keyword">await</span> r.json()
    <span class="hljs-keyword">return</span> data
</code></pre>
<p>å•è¿›ç¨‹å¯å¹¶å‘ 1000+ æ…¢ IO è¯·æ±‚ï¼Œlatency è¿œä½äºåŒæ­¥æ¡†æ¶ã€‚</p>
<hr/>
<h2 data-id="heading-4">äº”ã€è·¯å¾„å‚æ•° &amp; æŸ¥è¯¢å‚æ•°ä¸€æŠŠæ¢­</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/user/{user_id}"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">read_user</span>(<span class="hljs-params">user_id: <span class="hljs-built_in">int</span>, q: <span class="hljs-built_in">str</span> | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>, limit: <span class="hljs-built_in">int</span> = <span class="hljs-number">10</span></span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"user_id"</span>: user_id, <span class="hljs-string">"q"</span>: q, <span class="hljs-string">"limit"</span>: limit}
</code></pre>
<ul>
<li><code>user_id</code> è‡ªåŠ¨æ ¡éªŒ int â†’ éæ³•è¿”å› 422</li>
<li><code>q</code> å¯é€‰ï¼Œç¼ºçœ None</li>
<li>æ–‡æ¡£å®æ—¶ä½“ç°å‚æ•°ç±»å‹ã€é»˜è®¤å€¼</li>
</ul>
<hr/>
<h2 data-id="heading-5">å…­ã€ä¾èµ–æ³¨å…¥ â€”â€” åƒ Spring ä¸€æ ·ä¼˜é›…</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> Depends, HTTPException, status
<span class="hljs-keyword">from</span> fastapi.security <span class="hljs-keyword">import</span> HTTPBearer, HTTPAuthorizationCredentials

security = HTTPBearer()

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_current_user</span>(<span class="hljs-params">token: HTTPAuthorizationCredentials = Depends(<span class="hljs-params">security</span>)</span>):
    <span class="hljs-keyword">if</span> token.credentials != <span class="hljs-string">"fake-token"</span>:
        <span class="hljs-keyword">raise</span> HTTPException(status_code=status.HTTP_401_UNAUTHORIZED,
                            detail=<span class="hljs-string">"Invalid token"</span>)
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"uid"</span>: <span class="hljs-number">42</span>}

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/secure"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">secure_endpoint</span>(<span class="hljs-params">user=Depends(<span class="hljs-params">get_current_user</span>)</span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"secret data"</span>, <span class="hljs-string">"user"</span>: user}
</code></pre>
<p>ä¾èµ–å¯åµŒå¥—ã€å¯å¤ç”¨ï¼Œå•å…ƒæµ‹è¯•æ—¶ç›´æ¥ mock ä¾èµ–å³å¯ã€‚</p>
<hr/>
<h2 data-id="heading-6">ä¸ƒã€ä¸Šçº¿å¿…å¤‡ï¼šCORS / é™æ€æ–‡ä»¶ / å¼‚å¸¸å¤„ç†</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi.middleware.cors <span class="hljs-keyword">import</span> CORSMiddleware
<span class="hljs-keyword">from</span> fastapi.staticfiles <span class="hljs-keyword">import</span> StaticFiles
<span class="hljs-keyword">from</span> fastapi.responses <span class="hljs-keyword">import</span> JSONResponse

app.add_middleware(
    CORSMiddleware,
    allow_origins=[<span class="hljs-string">"*"</span>],
    allow_methods=[<span class="hljs-string">"*"</span>],
    allow_headers=[<span class="hljs-string">"*"</span>],
)

app.mount(<span class="hljs-string">"/static"</span>, StaticFiles(directory=<span class="hljs-string">"static"</span>), name=<span class="hljs-string">"static"</span>)

<span class="hljs-meta">@app.exception_handler(<span class="hljs-params">ValueError</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">value_error_handler</span>(<span class="hljs-params">request, exc</span>):
    <span class="hljs-keyword">return</span> JSONResponse(status_code=<span class="hljs-number">400</span>,
                        content={<span class="hljs-string">"detail"</span>: <span class="hljs-built_in">str</span>(exc)})
</code></pre>
<p>å…¨åŒæ­¥/å¼‚æ­¥æ··åˆå†™çš†å¯ï¼Œä¿æŒä»£ç é£æ ¼ä¸€è‡´ã€‚</p>
<hr/>
<h2 data-id="heading-7">å…«ã€ä¸ SQL æ•°æ®åº“è”åŠ¨ â€”â€” å¼‚æ­¥ ORM ç¤ºä¾‹</h2>
<pre><code class="hljs language-bash" lang="bash">pip install databases[aiosqlite] sqlalchemy
</code></pre>
<p>database.py</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> databases <span class="hljs-keyword">import</span> Database
database = Database(<span class="hljs-string">"sqlite+aiosqlite:///./demo.db"</span>)
</code></pre>
<p>model.py</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> sqlalchemy
metadata = sqlalchemy.MetaData()
notes = sqlalchemy.Table(
    <span class="hljs-string">"notes"</span>,
    metadata,
    sqlalchemy.Column(<span class="hljs-string">"id"</span>, sqlalchemy.Integer, primary_key=<span class="hljs-literal">True</span>),
    sqlalchemy.Column(<span class="hljs-string">"text"</span>, sqlalchemy.String),
    sqlalchemy.Column(<span class="hljs-string">"completed"</span>, sqlalchemy.Boolean),
)
</code></pre>
<p>main.py èŠ‚é€‰</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@app.on_event(<span class="hljs-params"><span class="hljs-string">"startup"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">startup</span>():
    <span class="hljs-keyword">await</span> database.connect()

<span class="hljs-meta">@app.on_event(<span class="hljs-params"><span class="hljs-string">"shutdown"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">shutdown</span>():
    <span class="hljs-keyword">await</span> database.disconnect()

<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/notes/"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_note</span>(<span class="hljs-params">text: <span class="hljs-built_in">str</span></span>):
    query = notes.insert().values(text=text, completed=<span class="hljs-literal">False</span>)
    last_record_id = <span class="hljs-keyword">await</span> database.execute(query)
    <span class="hljs-keyword">return</span> {**<span class="hljs-built_in">dict</span>(<span class="hljs-built_in">id</span>=last_record_id, text=text, completed=<span class="hljs-literal">False</span>)}
</code></pre>
<p>å…¨ç¨‹ <code>async</code>ï¼Œååé‡æ¯”åŒæ­¥ SQL æé«˜ä¸€ä¸ªé‡çº§ã€‚</p>
<hr/>
<h2 data-id="heading-8">ä¹ã€æ€§èƒ½ &amp; ç”Ÿæ€</h2>
<ul>
<li><strong>Starlette</strong> æ‰“åº•ï¼šæ”¯æŒ HTTP/2ã€WebSocketã€GraphQL</li>
<li><strong>Pydantic</strong> åŠ æŒï¼šæ ¡éªŒé€Ÿåº¦æ˜¯ä¼ ç»Ÿ schema åº“çš„ 2~4 å€</li>
<li><strong>Uvicorn + Gunicorn</strong> å¤š worker éƒ¨ç½²ï¼Œ8 æ ¸è½»æ¾ç ´ 10k RPS</li>
<li>å®˜æ–¹ benchmarkï¼šFastAPI  latency ä¸ Starlette/Go Echo åŒçº§ï¼Œ<strong>æ¯” Flask å¿« 3~5 å€</strong></li>
</ul>
<hr/>
<h2 data-id="heading-9">åã€éƒ¨ç½²ä¸€æ¡å‘½ä»¤</h2>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æœ¬åœ°å¼€å‘</span>
uvicorn main:app --reload

<span class="hljs-comment"># ç”Ÿäº§å¤šæ ¸</span>
gunicorn main:app -w 4 -k uvicorn.workers.UvicornWorker --<span class="hljs-built_in">bind</span> 0.0.0.0:8000
</code></pre>
<p>Dockerfile ç¤ºä¾‹</p>
<pre><code class="hljs language-dockerfile" lang="dockerfile">FROM python:3.11-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY . .
CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]
</code></pre>
<p>é•œåƒ &lt;100 MBï¼ŒK8s/Serverless éšæ„æ‰©ã€‚</p>
<hr/>
<h2 data-id="heading-10">åä¸€ã€æ€»ç»“ï¼šä¸€å¼ å›¾è®°ä½ FastAPI</h2>
<pre><code class="hljs language-lua" lang="lua">â”Œ<span class="hljs-comment">-------------â”        â”Œ------------â”</span>
â”‚ Pydantic    â”‚ &lt;<span class="hljs-comment">-----&gt;â”‚ è¯·æ±‚/å“åº”   â”‚  &lt;-- è‡ªåŠ¨æ ¡éªŒ+åºåˆ—åŒ–</span>
â”‚ æ•°æ®æ¨¡å‹     â”‚        â”‚ ç±»å‹æç¤º    â”‚
â””<span class="hljs-comment">-------------â”˜        â””------------â”˜</span>
        ^                       |
        |                       v
â”Œ<span class="hljs-comment">-------------â”        â”Œ------------â”</span>
â”‚ ä¾èµ–æ³¨å…¥     â”‚        â”‚ OpenAPI    â”‚  &lt;<span class="hljs-comment">-- è‡ªåŠ¨ç”Ÿæˆ docs</span>
â”‚ å®‰å…¨/DB/é€»è¾‘ â”‚        â”‚ æ–‡æ¡£/redoc â”‚
â””<span class="hljs-comment">-------------â”˜        â””------------â”˜</span>
        ^                       |
        |                       v
â”Œ<span class="hljs-comment">-------------------------------â”</span>
â”‚ Starletteï¼ˆASGIï¼‰å¼‚æ­¥æ ¸å¿ƒ      â”‚  &lt;<span class="hljs-comment">-- é«˜æ€§èƒ½</span>
â””<span class="hljs-comment">-------------------------------â”˜</span>
</code></pre>
<p>FastAPI = <strong>ç±»å‹æç¤º + å¼‚æ­¥ + è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£</strong> ä¸‰ç®­é½å‘ï¼Œ<br/>
å†™æ›´å°‘ä»£ç ï¼Œè·‘æ›´å¿«æœåŠ¡ï¼Œå‡ºæ›´å…¨æ–‡æ¡£ã€‚2024 å¹´äº†ï¼Œå¦‚æœä½ è¿˜åœ¨æ‰‹å†™ Swagger JSONï¼Œä¸å¦¨ç»™ FastAPI ä¸€ä¸ªå‘¨æœ«ï¼Œå®ƒä¼šè¿˜ä½ æ•´ä¸ªç”Ÿäº§åŠ›ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æˆ‘ä¸ºè‡ªå·±èµ·äº†ä¸ªç¬”å]]></title>    <link>https://juejin.cn/post/7591338980693770286</link>    <guid>https://juejin.cn/post/7591338980693770286</guid>    <pubDate>2026-01-04T13:05:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591338980693770286" data-draft-id="7591346773827797018" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æˆ‘ä¸ºè‡ªå·±èµ·äº†ä¸ªç¬”å"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-04T13:05:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‹æ¸¡è‹‡"/> <meta itemprop="url" content="https://juejin.cn/user/729731453429159"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æˆ‘ä¸ºè‡ªå·±èµ·äº†ä¸ªç¬”å
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/729731453429159/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‹æ¸¡è‹‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T13:05:49.000Z" title="Sun Jan 04 2026 13:05:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æˆ‘å†³å®šæŠŠæ‰€æœ‰å¹³å°çš„ç½‘åæ”¹æˆç¬”åâ€œè‹æ¸¡è‹‡â€ã€‚</p>
<p>å…¶å®æ”¹è¿™ä¸ªåå­—ï¼Œæ˜¯å› ä¸ºç¿»å¤æ–‡è§‚æ­¢åˆç¿»åˆ°äº†è‹è½¼çš„ã€Šèµ¤å£èµ‹ã€‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d7f1107c9509460d865a6c230fce1678~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5rih6IuH:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768136749&amp;x-signature=x2bHirx14UVSDZ9PEJjco6dxvoo%3D" alt="å¤æ–‡è§‚æ­¢ è‹è½¼Â·å‰èµ¤å£èµ‹" loading="lazy"/></p>
<p>å¤æ–‡è§‚æ­¢ è‹è½¼Â·å‰èµ¤å£èµ‹</p>
<p>è¯»åˆ°â€œçºµä¸€è‹‡ä¹‹æ‰€å¦‚ï¼Œå‡Œä¸‡é¡·ä¹‹èŒ«ç„¶â€é‚£å¥æ—¶ï¼Œæˆ‘ä¼¼ä¹æ­£åœ¨å‘å‘†ã€‚çª—å¤–æ˜¯åŸå¸‚é›¶æ˜Ÿçš„å…‰ï¼Œä¸æ˜¯è‹è½¼æ¸¡çš„æ±Ÿï¼Œä½†å¿ƒé‡Œçš„èŒ«ç„¶æ˜¯çœŸçš„ã€‚é‚£ä¸€ç¬é—´ï¼Œæˆ‘å¥½åƒçœ‹è§äº†ä¹ç™¾å¤šå¹´â€œä¸€è“‘çƒŸé›¨ä»»å¹³ç”Ÿâ€çš„è‹è½¼â€”â€”ä»–æ€»æ˜¯é‚£æ ·ä¹è§‚ï¼Œçºµä½¿å›°é¡¿éš¾è¡Œï¼Œä¾ç„¶å‘ç°è‡ªå·±ç«Ÿå¯ä»¥åƒä¸€ç‰‡è‹‡å¶é‚£æ ·ï¼Œæ‰˜ä»˜ç»™æ±Ÿæ°´å’Œæœˆå…‰ã€‚</p>
<p>è¿™ç§æ¥çº³ç ´ç¢ã€å¹¶ä»ä¸­å‘ç°è‡ªç”±çš„å§¿æ€ï¼Œä¾¿æ˜¯æˆ‘å¿ƒä¸­çš„è‹è½¼æœ€æ·±çš„æµªæ¼«ã€‚å®ƒä¸æ˜¯é£èŠ±é›ªæœˆï¼Œè€Œæ˜¯ä¸€ç§å·¨å¤§çš„è¯šå®ã€‚ä»–è¯šå®åœ°é¢å¯¹è‡ªå·±çš„ç‹¼ç‹ˆï¼Œä¹Ÿè¯šå®åœ°å‘ç°äº†å¤©åœ°é—´è¿˜æœ‰æ¸…é£æ˜æœˆä¸éœ€è¦ç”¨åŠŸåå»æ¢ã€‚</p>
<p>æ‰€ä»¥ï¼Œâ€œè‹æ¸¡è‹‡â€è¿™ä¸‰ä¸ªå­—ï¼Œå¯¹æˆ‘è€Œè¨€å°±æ˜¯ä¸€ç§æœ´ç´ çš„æé†’ã€‚å®ƒä¸æ„å‘³ç€æˆ‘èƒ½ç«‹åˆ»æ‹¥æœ‰ä»–çš„æ—·è¾¾ï¼Œè€Œæ˜¯è¯´ï¼Œå½“æˆ‘æ„Ÿåˆ°è‡ªå·±å¾€ä¸‹æ²‰çš„æ—¶å€™ï¼Œè‡³å°‘å¯ä»¥æƒ³èµ·ï¼Œæ›¾ç»æœ‰äººè¿™æ ·å¤„ç†çœ¼å‰çš„ç‹¼è—‰ï¼šå½“è·¯èµ°åˆ°å¤´ï¼Œå°±åœ¨æ—è¾¹åä¸‹ï¼Œçœ‹çœ‹æ­¤å¤„çš„é£æ™¯æœ‰ä»€ä¹ˆåˆ«è‡´ï¼›å½“äº‹ä¸æ„¿è¿ï¼Œå°±æŠŠâ€œè¿â€çš„éƒ¨åˆ†ï¼Œä¹Ÿæ¥è¿›ç”Ÿå‘½é‡Œæ¥ã€‚</p>
<p>æˆ‘ä¸å¥¢æ±‚ä¸€ä¸ªåå­—å°±å¯ä»¥æ¸¡ä»€ä¹ˆä¸‡é¡·èŒ«ç„¶ï¼Œèƒ½æ¸¡å¾—äº†ç”Ÿæ´»é‡Œä¸€äº›å…·ä½“çš„ã€çç¢çš„æ²®ä¸§ï¼Œå°±å¤Ÿäº†ã€‚å®ƒåƒæ”¾åœ¨ä¹¦æ¡Œè§’è½çš„ä¸€æ ¹çœŸæ­£çš„èŠ¦è‹‡ï¼Œå¹²ç‡¥ï¼Œè½»ç›ˆï¼Œæé†’æˆ‘å¦ä¸€ç§å¯èƒ½çš„å­˜åœ¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ©ç”¨å…ƒæ—¦å‡æœŸï¼Œæˆ‘å¼€æºäº†ä¸€ä¸ªå¤§æ¨¡å‹æ™ºèƒ½é¢è¯•å¹³å°+çŸ¥è¯†åº“ï¼]]></title>    <link>https://juejin.cn/post/7591349113355698185</link>    <guid>https://juejin.cn/post/7591349113355698185</guid>    <pubDate>2026-01-04T13:19:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591349113355698185" data-draft-id="7591360623469461514" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ©ç”¨å…ƒæ—¦å‡æœŸï¼Œæˆ‘å¼€æºäº†ä¸€ä¸ªå¤§æ¨¡å‹æ™ºèƒ½é¢è¯•å¹³å°+çŸ¥è¯†åº“ï¼"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-04T13:19:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JavaGuide"/> <meta itemprop="url" content="https://juejin.cn/user/166781497383294"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ©ç”¨å…ƒæ—¦å‡æœŸï¼Œæˆ‘å¼€æºäº†ä¸€ä¸ªå¤§æ¨¡å‹æ™ºèƒ½é¢è¯•å¹³å°+çŸ¥è¯†åº“ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/166781497383294/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JavaGuide
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T13:19:10.000Z" title="Sun Jan 04 2026 13:19:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ å¥½ï¼Œæˆ‘æ˜¯ Guideã€‚åˆ©ç”¨å…ƒæ—¦å‡æœŸï¼Œæˆ‘å¼€æºäº†ä¸€ä¸ªåŸºäº Spring Boot 4.0 + Java 21 + Spring AI + PostgreSQL + pgvector + RustFS + Redis çš„å¤§æ¨¡å‹é¡¹ç›®ï¼Œå®ç°äº†ç®€å†æ™ºèƒ½åˆ†æã€AI æ¨¡æ‹Ÿé¢è¯•ã€çŸ¥è¯†åº“ RAG æ£€ç´¢ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚</p>
<h2 data-id="heading-0">é¡¹ç›®ä»‹ç»</h2>
<p>InterviewGuide æ˜¯ä¸€ä¸ªé›†æˆäº†ç®€å†åˆ†æã€æ¨¡æ‹Ÿé¢è¯•å’ŒçŸ¥è¯†åº“ç®¡ç†çš„æ™ºèƒ½é¢è¯•è¾…åŠ©å¹³å°ã€‚ç³»ç»Ÿåˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å’Œå‘é‡æ•°æ®åº“æŠ€æœ¯ï¼Œä¸ºæ±‚èŒè€…å’Œ HR æä¾›æ™ºèƒ½åŒ–çš„ç®€å†è¯„ä¼°å’Œé¢è¯•ç»ƒä¹ æœåŠ¡ã€‚</p>
<ul>
<li>Github åœ°å€ï¼š<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSnailclimb%2Finterview-guide" target="_blank" title="https://github.com/Snailclimb/interview-guide" ref="nofollow noopener noreferrer">github.com/Snailclimb/â€¦</a></strong></li>
<li>Gitee åœ°å€ï¼š<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2FSnailClimb%2Finterview-guide" target="_blank" title="https://gitee.com/SnailClimb/interview-guide" ref="nofollow noopener noreferrer">gitee.com/SnailClimb/â€¦</a></strong></li>
</ul>
<h2 data-id="heading-1">ç³»ç»Ÿæ¶æ„</h2>
<p><strong>æç¤º</strong>ï¼šæ¶æ„å›¾é‡‡ç”¨ draw.io ç»˜åˆ¶ï¼Œå¯¼å‡ºä¸º svg æ ¼å¼ï¼Œåœ¨ Github Dark æ¨¡å¼ä¸‹çš„æ˜¾ç¤ºæ•ˆæœä¼šæœ‰é—®é¢˜ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/217805d2f0e2460caddd91e56bbb82b6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUd1aWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768137550&amp;x-signature=xX%2Bz%2FBpdG4i8LkT5Ls0neF9eEZI%3D" alt="" loading="lazy"/></p>
<p><strong>å¼‚æ­¥å¤„ç†æµç¨‹</strong>ï¼š</p>
<p>ç®€å†åˆ†æå’ŒçŸ¥è¯†åº“å‘é‡åŒ–é‡‡ç”¨ Redis Stream å¼‚æ­¥å¤„ç†ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">ä¸Šä¼ è¯·æ±‚ â†’ ä¿å­˜æ–‡ä»¶ â†’ å‘é€æ¶ˆæ¯åˆ° <span class="hljs-built_in">Stream</span> â†’ ç«‹å³è¿”å›
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   â†“
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   Consumer æ¶ˆè´¹æ¶ˆæ¯
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   â†“
 Â  Â  Â  Â  Â  Â  Â  Â  Â   æ‰§è¡Œåˆ†æ/å‘é‡åŒ–ä»»åŠ¡
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   â†“
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   æ›´æ–°æ•°æ®åº“çŠ¶æ€
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   â†“
 Â  Â  Â  Â  Â  Â  Â  Â  Â  å‰ç«¯è½®è¯¢è·å–æœ€æ–°çŠ¶æ€
</code></pre>
<p>çŠ¶æ€æµè½¬ï¼š <code>PENDING</code> â†’ <code>PROCESSING</code> â†’ <code>COMPLETED</code> / <code>FAILED</code></p>
<h2 data-id="heading-2">æŠ€æœ¯æ ˆ</h2>
<h3 data-id="heading-3">åç«¯æŠ€æœ¯</h3>























































<table><thead><tr><th>æŠ€æœ¯</th><th>ç‰ˆæœ¬</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>Spring Boot</td><td>4.0</td><td>åº”ç”¨æ¡†æ¶</td></tr><tr><td>Java</td><td>21</td><td>å¼€å‘è¯­è¨€</td></tr><tr><td>Spring AI</td><td>2.0</td><td>AI é›†æˆæ¡†æ¶</td></tr><tr><td>PostgreSQL + pgvector</td><td>14+</td><td>å…³ç³»æ•°æ®åº“ + å‘é‡å­˜å‚¨</td></tr><tr><td>Redis</td><td>6+</td><td>ç¼“å­˜ + æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆStreamï¼‰</td></tr><tr><td>Apache Tika</td><td>2.9.2</td><td>æ–‡æ¡£è§£æ</td></tr><tr><td>iText 8</td><td>8.0.5</td><td>PDF å¯¼å‡º</td></tr><tr><td>MapStruct</td><td>1.6.3</td><td>å¯¹è±¡æ˜ å°„</td></tr><tr><td>Gradle</td><td>8.14</td><td>æ„å»ºå·¥å…·</td></tr></tbody></table>
<p>æŠ€æœ¯é€‰å‹å¸¸è§é—®é¢˜è§£ç­”ï¼š</p>
<ol start="0">
<li>
<p>æ•°æ®å­˜å‚¨ä¸ºä»€ä¹ˆé€‰æ‹© PostgreSQL + pgvectorï¼ŸPG çš„å‘é‡æ•°æ®å­˜å‚¨åŠŸèƒ½å¤Ÿç”¨äº†ï¼Œç²¾ç®€æ¶æ„ï¼Œä¸æƒ³å¼•å…¥å¤ªå¤šç»„ä»¶ã€‚</p>
</li>
<li>
<p>ä¸ºä»€ä¹ˆå¼•å…¥ Redisï¼Ÿ</p>
<ul>
<li>Redis æ›¿ä»£ <code>ConcurrentHashMap</code> å®ç°é¢è¯•ä¼šè¯çš„ç¼“å­˜ã€‚</li>
<li>åŸºäº Redis Stream å®ç°ç®€å†åˆ†æã€çŸ¥è¯†åº“å‘é‡åŒ–ç­‰åœºæ™¯çš„å¼‚æ­¥ï¼ˆè¿˜èƒ½è§£è€¦ï¼Œåˆ†æå’Œå‘é‡åŒ–å¯ä»¥ä½¿ç”¨å…¶ä»–ç¼–ç¨‹è¯­è¨€æ¥åšï¼‰ã€‚ä¸ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fjavaguide.cn%2Fhigh-performance%2Fmessage-queue%2Fkafka-questions-01.html" target="_blank" title="https://javaguide.cn/high-performance/message-queue/kafka-questions-01.html" ref="nofollow noopener noreferrer">Kafka</a> è¿™ç±»æˆç†Ÿçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¹Ÿæ˜¯ä¸æƒ³å¼•å…¥å¤ªå¤šç»„ä»¶ã€‚</li>
</ul>
</li>
<li>
<p>æ„å»ºå·¥å…·ä¸ºä»€ä¹ˆé€‰æ‹© Gradleï¼Ÿä¸ªäººæ›´å–œæ¬¢ç”¨ Gradleï¼Œä¹Ÿå†™è¿‡ç›¸å…³çš„æ–‡ç« ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fjavaguide.cn%2Ftools%2Fgradle%2Fgradle-core-concepts.html" target="_blank" title="https://javaguide.cn/tools/gradle/gradle-core-concepts.html" ref="nofollow noopener noreferrer">Gradleæ ¸å¿ƒæ¦‚å¿µæ€»ç»“</a>ã€‚</p>
</li>
</ol>
<h3 data-id="heading-4">å‰ç«¯æŠ€æœ¯</h3>


















































<table><thead><tr><th>æŠ€æœ¯</th><th>ç‰ˆæœ¬</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>React</td><td>18.3</td><td>UI æ¡†æ¶</td></tr><tr><td>TypeScript</td><td>5.6</td><td>å¼€å‘è¯­è¨€</td></tr><tr><td>Vite</td><td>5.4</td><td>æ„å»ºå·¥å…·</td></tr><tr><td>Tailwind CSS</td><td>4.1</td><td>æ ·å¼æ¡†æ¶</td></tr><tr><td>React Router</td><td>7.11</td><td>è·¯ç”±ç®¡ç†</td></tr><tr><td>Framer Motion</td><td>12.23</td><td>åŠ¨ç”»åº“</td></tr><tr><td>Recharts</td><td>3.6</td><td>å›¾è¡¨åº“</td></tr><tr><td>Lucide React</td><td>-</td><td>å›¾æ ‡åº“</td></tr></tbody></table>
<h2 data-id="heading-5">åŠŸèƒ½ç‰¹æ€§</h2>
<h3 data-id="heading-6">ç®€å†ç®¡ç†æ¨¡å—</h3>
<ul>
<li>å¤šæ ¼å¼æ”¯æŒï¼šPDFã€DOCXã€DOCã€TXT</li>
<li>å¼‚æ­¥åˆ†æï¼šä¸Šä¼ åç«‹å³è¿”å›ï¼Œåå° Redis Stream å¤„ç†</li>
<li>çŠ¶æ€è½®è¯¢ï¼šå®æ—¶æ˜¾ç¤ºåˆ†æè¿›åº¦ï¼ˆå¾…åˆ†æ/åˆ†æä¸­/å·²å®Œæˆ/å¤±è´¥ï¼‰</li>
<li>è‡ªåŠ¨é‡è¯•ï¼šåˆ†æå¤±è´¥è‡ªåŠ¨é‡è¯•ï¼ˆæœ€å¤š 3 æ¬¡ï¼‰</li>
<li>ç®€å†å»é‡ï¼šåŸºäºå†…å®¹å“ˆå¸Œæ£€æµ‹é‡å¤</li>
<li>PDF æŠ¥å‘Šå¯¼å‡º</li>
</ul>
<h3 data-id="heading-7">æ¨¡æ‹Ÿé¢è¯•æ¨¡å—</h3>
<ul>
<li>åŸºäºç®€å†ç”Ÿæˆä¸ªæ€§åŒ–é¢è¯•é—®é¢˜</li>
<li>å®æ—¶é—®ç­”äº¤äº’</li>
<li>å¤šç»´åº¦è¯„åˆ†ï¼ˆæŠ€æœ¯èƒ½åŠ›ã€æ²Ÿé€šèƒ½åŠ›ç­‰ï¼‰</li>
<li>é¢è¯•æŠ¥å‘Šç”Ÿæˆå’Œå¯¼å‡º</li>
<li>é›·è¾¾å›¾å¯è§†åŒ–å±•ç¤º</li>
<li>é¢è¯•å†å²ç»Ÿè®¡</li>
</ul>
<h3 data-id="heading-8">çŸ¥è¯†åº“ç®¡ç†æ¨¡å—</h3>
<ul>
<li>å¤šæ ¼å¼æ”¯æŒï¼šPDFã€DOCXã€DOCã€TXTã€Markdown</li>
<li>æ–‡æ¡£ä¸Šä¼ å’Œè‡ªåŠ¨åˆ†å—</li>
<li>å¼‚æ­¥å‘é‡åŒ–å¤„ç†</li>
<li>RAG æ£€ç´¢å¢å¼ºç”Ÿæˆ</li>
<li>æµå¼å“åº”ï¼ˆSSEï¼‰</li>
<li>æ™ºèƒ½é—®ç­”å¯¹è¯</li>
<li>çŸ¥è¯†åº“ç»Ÿè®¡ä¿¡æ¯</li>
</ul>
<h3 data-id="heading-9">TODO</h3>
<ul>
<li>é—®ç­”åŠ©æ‰‹çš„ Markdown å±•ç¤ºä¼˜åŒ–</li>
<li>çŸ¥è¯†åº“ç®¡ç†é¡µé¢çš„ä¸‹è½½</li>
<li>å¼‚æ­¥ç”Ÿæˆæ¨¡æ‹Ÿé¢è¯•è¯„ä¼°æŠ¥å‘Š</li>
<li>æ¨¡æ‹Ÿé¢è¯•å¢åŠ è¿½é—®åŠŸèƒ½</li>
<li>æ‰“é€šæ¨¡æ‹Ÿé¢è¯•å’ŒçŸ¥è¯†åº“</li>
</ul>
<h2 data-id="heading-10">æ•ˆæœå±•ç¤º</h2>
<h3 data-id="heading-11">ç®€å†ä¸é¢è¯•</h3>
<p>ç®€å†åº“ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4dc7cc8ff470499e958982ed95123f0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUd1aWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768137550&amp;x-signature=MSXt9QljlslJXaNu%2F14tfqx%2FFmg%3D" alt="" loading="lazy"/></p>
<p>ç®€å†ä¸Šä¼ åˆ†æï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14ca9132ed334766b8f53ef0e7dd2e1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUd1aWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768137550&amp;x-signature=UPE2NKVnqMjAcB5%2Bn1hDzpd2XD8%3D" alt="" loading="lazy"/></p>
<p>ç®€å†åˆ†æè¯¦æƒ…ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef468ba8ee6a45639526a4eb6a6fb96d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUd1aWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768137550&amp;x-signature=vgGh%2BpL1lWgIeguPzHLuvWlYEGY%3D" alt="" loading="lazy"/></p>
<p>é¢è¯•è®°å½•ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/943552cd935c4c01acf8217ede855d33~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUd1aWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768137550&amp;x-signature=RMqQfl%2BlKwv8LVPubOjGkKkRpR4%3D" alt="" loading="lazy"/></p>
<p>é¢è¯•è¯¦æƒ…ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e6c919cf693432aa1284949a8e1bda7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUd1aWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768137550&amp;x-signature=%2Fdakm2zT22X2IgtrdiB80NoYANY%3D" alt="" loading="lazy"/></p>
<p>æ¨¡æ‹Ÿé¢è¯•ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1f141295e5634b689f049884f6bfef42~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUd1aWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768137550&amp;x-signature=FBwEJfcLrq1ocHXQzWI9nABkvtg%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-12">çŸ¥è¯†åº“</h3>
<p>çŸ¥è¯†åº“ç®¡ç†ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/305f368e4399439ea56b61ef8f76513a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUd1aWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768137550&amp;x-signature=mQZY6JVN33xFO4ebhWmbVP5RhWM%3D" alt="" loading="lazy"/></p>
<p>é—®ç­”åŠ©æ‰‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/052629e6935f4f18b01d162ef594bdd7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUd1aWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768137550&amp;x-signature=OvdleNm%2BXgj8FNZSiiOlyUHZKkI%3D" alt="page-qa-assistant" loading="lazy"/></p>
<h2 data-id="heading-13">é¡¹ç›®ç»“æ„</h2>
<pre><code class="hljs language-bash" lang="bash">interview-guide/
â”œâ”€â”€ app/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-comment"># åç«¯åº”ç”¨</span>
â”‚ Â  â”œâ”€â”€ src/main/java/interview/guide/
â”‚ Â  â”‚ Â  â”œâ”€â”€ App.java Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-comment"># ä¸»å¯åŠ¨ç±»</span>
â”‚ Â  â”‚ Â  â”œâ”€â”€ common/ Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># é€šç”¨æ¨¡å—</span>
â”‚ Â  â”‚ Â  â”‚ Â  â”œâ”€â”€ config/ Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># é…ç½®ç±»</span>
â”‚ Â  â”‚ Â  â”‚ Â  â”œâ”€â”€ exception/ Â  Â  Â  Â  Â   <span class="hljs-comment"># å¼‚å¸¸å¤„ç†</span>
â”‚ Â  â”‚ Â  â”‚ Â  â””â”€â”€ result/ Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># ç»Ÿä¸€å“åº”</span>
â”‚ Â  â”‚ Â  â”œâ”€â”€ infrastructure/ Â  Â  Â  Â  Â  <span class="hljs-comment"># åŸºç¡€è®¾æ–½</span>
â”‚ Â  â”‚ Â  â”‚ Â  â”œâ”€â”€ <span class="hljs-built_in">export</span>/ Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># PDF å¯¼å‡º</span>
â”‚ Â  â”‚ Â  â”‚ Â  â”œâ”€â”€ file/ Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># æ–‡ä»¶å¤„ç†</span>
â”‚ Â  â”‚ Â  â”‚ Â  â”œâ”€â”€ redis/ Â  Â  Â  Â  Â  Â  Â   <span class="hljs-comment"># Redis æœåŠ¡</span>
â”‚ Â  â”‚ Â  â”‚ Â  â””â”€â”€ storage/ Â  Â  Â  Â  Â  Â   <span class="hljs-comment"># å¯¹è±¡å­˜å‚¨</span>
â”‚ Â  â”‚ Â  â””â”€â”€ modules/ Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-comment"># ä¸šåŠ¡æ¨¡å—</span>
â”‚ Â  â”‚ Â  Â  Â  â”œâ”€â”€ interview/ Â  Â  Â  Â  Â   <span class="hljs-comment"># é¢è¯•æ¨¡å—</span>
â”‚ Â  â”‚ Â  Â  Â  â”œâ”€â”€ knowledgebase/ Â  Â  Â   <span class="hljs-comment"># çŸ¥è¯†åº“æ¨¡å—</span>
â”‚ Â  â”‚ Â  Â  Â  â””â”€â”€ resume/ Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># ç®€å†æ¨¡å—</span>
â”‚ Â  â””â”€â”€ src/main/resources/
â”‚ Â  Â  Â  â”œâ”€â”€ application.yml Â  Â  Â  Â  Â  <span class="hljs-comment"># åº”ç”¨é…ç½®</span>
â”‚ Â  Â  Â  â””â”€â”€ prompts/ Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-comment"># AI æç¤ºè¯æ¨¡æ¿</span>
â”‚
â”œâ”€â”€ frontend/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># å‰ç«¯åº”ç”¨</span>
â”‚ Â  â”œâ”€â”€ src/
â”‚ Â  â”‚ Â  â”œâ”€â”€ api/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-comment"># API æ¥å£</span>
â”‚ Â  â”‚ Â  â”œâ”€â”€ components/ Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># å…¬å…±ç»„ä»¶</span>
â”‚ Â  â”‚ Â  â”œâ”€â”€ pages/ Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-comment"># é¡µé¢ç»„ä»¶</span>
â”‚ Â  â”‚ Â  â”œâ”€â”€ types/ Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-comment"># ç±»å‹å®šä¹‰</span>
â”‚ Â  â”‚ Â  â””â”€â”€ utils/ Â  Â  Â  Â  Â  Â  Â  Â  Â   <span class="hljs-comment"># å·¥å…·å‡½æ•°</span>
â”‚ Â  â”œâ”€â”€ package.json
â”‚ Â  â””â”€â”€ vite.config.ts
â”‚
â””â”€â”€ README.md
</code></pre>
<h2 data-id="heading-14">å¿«é€Ÿå¼€å§‹</h2>
<p>ç¯å¢ƒè¦æ±‚ï¼š</p>








































<table><thead><tr><th>ä¾èµ–</th><th>ç‰ˆæœ¬</th><th>å¿…éœ€</th></tr></thead><tbody><tr><td>JDK</td><td>21+</td><td>æ˜¯</td></tr><tr><td>Node.js</td><td>18+</td><td>æ˜¯</td></tr><tr><td>PostgreSQL</td><td>14+</td><td>æ˜¯</td></tr><tr><td>pgvector æ‰©å±•</td><td>-</td><td>æ˜¯</td></tr><tr><td>Redis</td><td>6+</td><td>æ˜¯</td></tr><tr><td>S3 å…¼å®¹å­˜å‚¨</td><td>-</td><td>æ˜¯</td></tr></tbody></table>
<h3 data-id="heading-15">1. å…‹éš†é¡¹ç›®</h3>
<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">clone</span> https://github.com/Snailclimb/interview-guide.git
<span class="hljs-built_in">cd</span> interview-guide
</code></pre>
<h3 data-id="heading-16">2. é…ç½®æ•°æ®åº“</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ›å»ºæ•°æ®åº“</span>
<span class="hljs-keyword">CREATE</span> DATABASE interview_guide;
â€‹
<span class="hljs-comment">-- è¿æ¥æ•°æ®åº“å¹¶å¯ç”¨ pgvector æ‰©å±•ï¼ˆå¯é€‰ï¼Œå¯åŠ¨åç«¯SpringAIæ¡†æ¶åº•å±‚ä¼šè‡ªåŠ¨åˆ›å»ºï¼‰</span>
<span class="hljs-keyword">CREATE</span> EXTENSION vector;
</code></pre>
<h3 data-id="heading-17">3. é…ç½®ç¯å¢ƒå˜é‡</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># AI API å¯†é’¥ï¼ˆé˜¿é‡Œäº‘ DashScopeï¼‰</span>
export <span class="hljs-attr">AI_BAILIAN_API_KEY</span>=your_api_key
</code></pre>
<h3 data-id="heading-18">4. ä¿®æ”¹åº”ç”¨é…ç½®</h3>
<p>ç¼–è¾‘ <code>app/src/main/resources/application.yml</code>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
 Â <span class="hljs-comment"># PostgreSQLæ•°æ®åº“é…ç½®</span>
  <span class="hljs-attr">datasource:</span>
 Â   <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:postgresql://localhost:5432/interview_guide</span>
 Â   <span class="hljs-attr">username:</span> <span class="hljs-string">your_username</span>
 Â   <span class="hljs-attr">password:</span> <span class="hljs-string">your_password</span>
<span class="hljs-string">â€‹</span>
  <span class="hljs-attr">data:</span>
 Â   <span class="hljs-attr">redis:</span>
 Â  Â   <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span>
 Â  Â   <span class="hljs-attr">port:</span> <span class="hljs-number">6379</span>
<span class="hljs-string">â€‹</span>
<span class="hljs-comment"># RustFS (S3å…¼å®¹) å­˜å‚¨é…ç½®</span>
<span class="hljs-attr">app:</span>
  <span class="hljs-attr">storage:</span>
 Â   <span class="hljs-attr">endpoint:</span> <span class="hljs-string">http://localhost:9000</span>
 Â   <span class="hljs-attr">access-key:</span> <span class="hljs-string">your_access_key</span>
 Â   <span class="hljs-attr">secret-key:</span> <span class="hljs-string">your_secret_key</span>
 Â   <span class="hljs-attr">bucket:</span> <span class="hljs-string">interview-guide</span>
 Â  Â 
 <span class="hljs-comment"># Redissoné…ç½®</span>
<span class="hljs-attr">redisson:</span>
  <span class="hljs-attr">config:</span> <span class="hljs-string">|
 Â   singleServerConfig:
 Â  Â   address: "redis://localhost:6379"
 Â  Â   database: 0
 Â  Â   idleConnectionTimeout: 10000
 Â  Â   connectTimeout: 10000
 Â  Â   timeout: 3000
 Â  Â   retryAttempts: 3
 Â  Â   retryInterval: 1500
 Â  Â   password: null
 Â  Â   subscriptionsPerConnection: 5
 Â  Â   clientName: null
 Â  Â   subscriptionConnectionMinimumIdleSize: 1
 Â  Â   subscriptionConnectionPoolSize: 50
 Â  Â   connectionMinimumIdleSize: 10
 Â  Â   connectionPoolSize: 64
 Â  Â   dnsMonitoringInterval: 5000
</span><span class="hljs-string">â€‹</span>
</code></pre>
<h3 data-id="heading-19">5. å¯åŠ¨æœåŠ¡</h3>
<p><strong>åç«¯ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">./gradlew bootRun
</code></pre>
<p>åç«¯æœåŠ¡å¯åŠ¨äº <code>http://localhost:8080</code></p>
<p><strong>å‰ç«¯ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> frontend
pnpm install
pnpm dev
</code></pre>
<p>å‰ç«¯æœåŠ¡å¯åŠ¨äº <code>http://localhost:5173</code></p>
<h2 data-id="heading-20">ä½¿ç”¨åœºæ™¯</h2>





















<table><thead><tr><th>ç”¨æˆ·è§’è‰²</th><th>ä½¿ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>æ±‚èŒè€…</strong></td><td>ä¸Šä¼ ç®€å†è·å–åˆ†æå»ºè®®ï¼Œè¿›è¡Œæ¨¡æ‹Ÿé¢è¯•ç»ƒä¹ </td></tr><tr><td><strong>HR/æ‹›è˜äººå‘˜</strong></td><td>æ‰¹é‡åˆ†æç®€å†ï¼Œè¯„ä¼°å€™é€‰äººèƒ½åŠ›</td></tr><tr><td><strong>åŸ¹è®­æœºæ„</strong></td><td>æä¾›é¢è¯•åŸ¹è®­æœåŠ¡ï¼Œç®¡ç†çŸ¥è¯†åº“èµ„æº</td></tr></tbody></table>
<h2 data-id="heading-21">å¸¸è§é—®é¢˜</h2>
<h3 data-id="heading-22">Q: ç®€å†åˆ†æå¤±è´¥</h3>
<p>æ£€æŸ¥ä¸€ä¸‹é˜¿é‡Œäº‘ DashScope API KEY æ˜¯å¦é…ç½®æ­£ç¡®ï¼ˆç”³è¯·åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fbailian.console.aliyun.com%2F" target="_blank" title="https://bailian.console.aliyun.com/" ref="nofollow noopener noreferrer">bailian.console.aliyun.com/</a>ï¼‰ã€‚</p>
<h3 data-id="heading-23">Q: ç®€å†åˆ†æä¸€ç›´æ˜¾ç¤º"åˆ†æä¸­"ï¼Ÿ</h3>
<p>æ£€æŸ¥ Redis è¿æ¥å’Œ Stream Consumer æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚æŸ¥çœ‹åç«¯æ—¥å¿—ç¡®è®¤æ˜¯å¦æœ‰é”™è¯¯ã€‚</p>
<h3 data-id="heading-24">Q: çŸ¥è¯†åº“é—®ç­”æ²¡æœ‰å“åº”ï¼Ÿ</h3>
<p>ç¡®è®¤çŸ¥è¯†åº“å·²å®Œæˆå‘é‡åŒ–ï¼ˆçŠ¶æ€ä¸º COMPLETEDï¼‰ï¼Œæ£€æŸ¥ pgvector æ‰©å±•æ˜¯å¦æ­£ç¡®å®‰è£…ã€‚</p>
<h3 data-id="heading-25">Q: PDF å¯¼å‡ºå¤±è´¥ï¼Ÿ</h3>
<p>æ£€æŸ¥ iText ä¾èµ–æ˜¯å¦æ­£ç¡®ï¼Œç¡®è®¤å­—ä½“æ–‡ä»¶å­˜åœ¨ã€‚</p>
<h2 data-id="heading-26">åˆ†æ”¯è¯´æ˜</h2>

















<table><thead><tr><th>åˆ†æ”¯</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>master</code></td><td>ä¸»åˆ†æ”¯ï¼ŒåŒ…å«å®Œæ•´åŠŸèƒ½ï¼ˆRedis Stream å¼‚æ­¥å¤„ç†ï¼‰</td></tr><tr><td><code>v1.0-without-redis</code></td><td>åŸºç¡€ç‰ˆæœ¬ï¼ŒåŒæ­¥å¤„ç†ï¼Œæ—  Redis ä¾èµ–</td></tr></tbody></table>
<h2 data-id="heading-27">è´¡çŒ®</h2>
<p>æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼</p>
<h2 data-id="heading-28">è®¸å¯è¯</h2>
<p>AGPL-3.0 Licenseï¼ˆåªè¦é€šè¿‡ç½‘ç»œæä¾›æœåŠ¡ï¼Œå°±å¿…é¡»å‘ç”¨æˆ·å…¬å¼€ä¿®æ”¹åçš„æºç ï¼‰</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue åŸºç¡€ï¼šçŠ¶æ€ç®¡ç†å…¥é—¨]]></title>    <link>https://juejin.cn/post/7591318630694551606</link>    <guid>https://juejin.cn/post/7591318630694551606</guid>    <pubDate>2026-01-04T13:40:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591318630694551606" data-draft-id="7591317772074483731" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue åŸºç¡€ï¼šçŠ¶æ€ç®¡ç†å…¥é—¨"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2026-01-04T13:40:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ¡œå¹é›ª"/> <meta itemprop="url" content="https://juejin.cn/user/1179091901098269"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue åŸºç¡€ï¼šçŠ¶æ€ç®¡ç†å…¥é—¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1179091901098269/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ¡œå¹é›ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T13:40:11.000Z" title="Sun Jan 04 2026 13:40:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åŸæ–‡ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.telerik.com%2Fblogs%2Fvue-basics-state-management-vue%23state-at-scale-with-pinia" target="_blank" title="https://www.telerik.com/blogs/vue-basics-state-management-vue#state-at-scale-with-pinia" ref="nofollow noopener noreferrer">Vue Basics: State Management in Vue</a></p>
</blockquote>
<p>å­¦ä¹ å¦‚ä½•éšç€åº”ç”¨è§„æ¨¡çš„æ‰©å¤§ï¼Œåˆ©ç”¨ ref/reactiveã€props/emitsã€provide/inject å’Œ Pinia æ¥æ‰©å±• Vue çš„çŠ¶æ€ç®¡ç†ã€‚</p>
<p>åœ¨ä½¿ç”¨ Vue æ„å»ºä»»ä½•äº¤äº’å¼åº”ç”¨æ—¶ï¼Œâ€œçŠ¶æ€â€æ˜¯ä½ æœ€å…ˆæ¥è§¦åˆ°çš„æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€ã€‚æ— è®ºæ˜¯è¡¨å•ä¸­çš„æ–‡æœ¬ã€è´­ç‰©è½¦é‡Œçš„å•†å“ï¼Œè¿˜æ˜¯å·²ç™»å½•ç”¨æˆ·çš„ä¸ªäººèµ„æ–™ï¼Œæ­£ç¡®åœ°ç®¡ç†è¿™äº›çŠ¶æ€å¯¹äºä¿æŒåº”ç”¨çš„ç¨³å®šæ€§ã€å“åº”æ€§ä»¥åŠæ˜“æ‰©å±•æ€§éƒ½è‡³å…³é‡è¦ã€‚</p>
<p>Vue 3 å¼•å…¥äº†ç»„åˆå¼ API ä»¥åŠå…¨æ–°çš„å“åº”å¼ç³»ç»Ÿï¼Œä¸ºå¼€å‘è€…æä¾›äº†å‰æ‰€æœªæœ‰çš„å¼ºå¤§ä¸”çµæ´»çš„çŠ¶æ€ç®¡ç†æ–¹å¼ã€‚åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨ Vue 3 å¦‚ä½•å¤„ç†çŠ¶æ€â€”â€”ä»ä½¿ç”¨ <code>ref</code> å’Œ <code>reactive</code> ç®¡ç†å±€éƒ¨çŠ¶æ€å¼€å§‹ï¼Œåˆ°é€šè¿‡ <code>props</code> å’Œ <code>provide</code>/<code>inject</code> å…±äº«æ•°æ®ï¼Œæœ€åè¿›é˜¶åˆ° Vue çš„å®˜æ–¹çŠ¶æ€ç®¡ç†åº“ Piniaã€‚è¯»å®Œæœ¬æ–‡ï¼Œä½ å°†è·å¾—ä¸€ä»½æ¸…æ™°çš„è·¯çº¿å›¾ï¼Œèƒ½å¤Ÿæ ¹æ®åº”ç”¨çš„å…·ä½“éœ€æ±‚é€‰æ‹©æœ€åˆé€‚çš„å·¥å…·ã€‚</p>
<h2 data-id="heading-0">ç†è§£ Vue ä¸­çš„çŠ¶æ€ç®¡ç†æ¦‚å¿µ</h2>
<p>çŠ¶æ€æ˜¯æ¯ä¸€ä¸ªäº¤äº’å¼ Vue åº”ç”¨çš„æ ¸å¿ƒã€‚æ­£æ˜¯å®ƒè®©ä½ çš„ UI å˜å¾—åŠ¨æ€â€”â€”åªè¦æ›´æ–°çŠ¶æ€ï¼ŒVue å°±ä¼šè‡ªåŠ¨å°†è¿™äº›å˜åŒ–åæ˜ åœ¨ DOM ä¸­ã€‚</p>
<p>å¹¿ä¹‰ä¸Šè®²ï¼ŒçŠ¶æ€åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼š</p>
<ul>
<li>å±€éƒ¨çŠ¶æ€ï¼š å­˜åœ¨äºå•ä¸ªç»„ä»¶å†…éƒ¨ï¼ˆä¾‹å¦‚ï¼šè®¡æ•°å™¨ç»„ä»¶ä¸­çš„ count å˜é‡ï¼‰ã€‚</li>
<li>å…¨å±€çŠ¶æ€ï¼š åœ¨å¤šä¸ªç»„ä»¶æˆ–åº”ç”¨çš„ä¸åŒéƒ¨åˆ†ä¹‹é—´å…±äº«ï¼ˆä¾‹å¦‚ï¼šç”¨æˆ·ç™»å½•è®¤è¯çŠ¶æ€ï¼‰ã€‚</li>
</ul>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ª Vue ç»„ä»¶éƒ½ç»´æŠ¤ç€è‡ªå·±çš„å“åº”å¼çŠ¶æ€ï¼Œæˆ‘ä»¬é€šå¸¸ç§°ä¹‹ä¸ºå±€éƒ¨çŠ¶æ€ã€‚åœ¨æ¢ç´¢å¦‚ä½•åœ¨ç»„ä»¶é—´å…±äº«çŠ¶æ€ä»¥åŠæœ€ç»ˆä½¿ç”¨ Pinia è¿›è¡Œå…¨å±€ç®¡ç†ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆä»è¿™é‡Œå…¥æ‰‹ã€‚</p>
<h2 data-id="heading-1">ä½¿ç”¨ ref å’Œ reactive ç®¡ç†å±€éƒ¨çŠ¶æ€</h2>
<p>ä¸ºäº†ç®¡ç†å±€éƒ¨å“åº”å¼çŠ¶æ€ï¼ŒVue 3 çš„ç»„åˆå¼ API æä¾›äº†ä¸¤ä¸ªä¸»è¦å·¥å…·ï¼š<code>ref</code> å’Œ <code>reactive</code>ã€‚å¦‚æœä½ åˆšæ¥è§¦ Vueï¼Œå¯èƒ½ä¼šå¯¹é€‰æ‹©å“ªä¸€ä¸ªæ„Ÿåˆ°å›°æƒ‘â€”â€”å› æ­¤ï¼Œè®©æˆ‘ä»¬åŸºäºå¯¹å±€éƒ¨çŠ¶æ€çš„ç†è§£ï¼Œæ¥è¯¦ç»†æ‹†è§£è¿™ä¸¤ä¸ªå·¥å…·ã€‚</p>
<h3 data-id="heading-2">ä½¿ç”¨ ref</h3>
<p>å½“å¤„ç†åŸå§‹å€¼ï¼ˆæ•°å­—ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ï¼‰æ—¶ï¼Œè¯·ä½¿ç”¨ refã€‚</p>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
import { ref } from 'vue'

//state
const count = ref(0)

//actions
function increment() {
  count.value++
}
&lt;/script&gt;

&lt;template&gt;
  &lt;button @click="increment"&gt;Count is: {{ count }}&lt;/button&gt;
&lt;/template&gt;
</code></pre>
<p>åœ¨è¿™é‡Œï¼Œ<code>count</code> è¢«å°è£…åœ¨ä¸€ä¸ª <code>ref</code> ä¸­ï¼Œå¹¶é€šè¿‡ <code>.value</code> æ¥è®¿é—®å…¶å€¼ã€‚</p>
<h3 data-id="heading-3">ä½¿ç”¨ reactive</h3>
<p>å½“å¤„ç†å¯¹è±¡æˆ–æ•°ç»„æ—¶ï¼Œè¯·ä½¿ç”¨ <code>reactive</code>ã€‚</p>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
import { reactive } from 'vue'

const user = reactive({
  name: ' ',
  age: 25
})
&lt;/script&gt;

&lt;template&gt;
  &lt;input v-model="user.name" placeholder="Enter your name" /&gt;
  &lt;p&gt;{{ user.name }} is {{ user.age }} years old.&lt;/p&gt;
&lt;/template&gt;
</code></pre>
<p>åœ¨åº•å±‚ï¼ŒVue å°†å¯¹è±¡å°è£…åœ¨ä¸€ä¸ª Proxy ä¸­ï¼Œå› æ­¤å®ƒå¯ä»¥è‡ªåŠ¨è¿½è¸ªå˜åŒ–å¹¶æ›´æ–° DOMã€‚</p>
<p>å±€éƒ¨çŠ¶æ€æ˜¯ Vue å•å‘æ•°æ®æµæœ€ç®€å•çš„ä¾‹å­ï¼šçŠ¶æ€é©±åŠ¨ UIã€‚ä½†ä¸€æ—¦å¤šä¸ªç»„ä»¶éœ€è¦å…±äº«åŒä¸€ä»½çŠ¶æ€ï¼Œä»…é å±€éƒ¨ç®¡ç†å°±ä¼šå˜å¾—å›°éš¾ï¼Œè¿™æ—¶æˆ‘ä»¬å°±éœ€è¦è¶…è¶Šå±€éƒ¨çŠ¶æ€äº†ã€‚</p>
<h2 data-id="heading-4">åœ¨ç»„ä»¶é—´å…±äº«çŠ¶æ€</h2>
<p>å±€éƒ¨çŠ¶æ€å¯¹äºå•ä¸ªç»„ä»¶æ¥è¯´è¿ä½œè‰¯å¥½ï¼Œä½†å¦‚æœå¤šä¸ªç»„ä»¶éœ€è¦ç›¸åŒçš„æ•°æ®è¯¥æ€ä¹ˆåŠï¼ŸVue æä¾›äº†å‡ ç§å…±äº«çŠ¶æ€çš„æ–¹å¼ï¼šprops/emits å’Œ provide/injectã€‚</p>
<h3 data-id="heading-5">Props å’Œ Emits</h3>
<p>Props å…è®¸çˆ¶ç»„ä»¶å‘ä¸‹ä¼ é€’çŠ¶æ€ï¼Œè€Œ emits å…è®¸å­ç»„ä»¶å‘ä¸Šå‘é€äº‹ä»¶ã€‚</p>
<p>è®©æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢è¿™ä¸ªç®€å•çš„æ¼”ç¤ºï¼š</p>
<h4 data-id="heading-6">çˆ¶ç»„ä»¶</h4>
<p>ä½ å¯ä»¥é€šè¿‡ props å°†æ•°æ®ä»çˆ¶ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶ã€‚</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- Parent.vue --&gt;
&lt;template&gt;
  &lt;Child :count="count" @increment="count++" /&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'
import Child from './Child.vue'

const count = ref(0)
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-7">å­ç»„ä»¶</h4>
<p>å½“å­ç»„ä»¶éœ€è¦æ›´æ–°çˆ¶ç»„ä»¶çš„çŠ¶æ€æ—¶ï¼Œå®ƒå¯ä»¥è§¦å‘ï¼ˆemitï¼‰ä¸€ä¸ªäº‹ä»¶ã€‚</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- Child.vue --&gt;
&lt;template&gt;
  &lt;button @click="$emit('increment')"&gt;Clicked&lt;/button&gt;
&lt;/template&gt;

&lt;script setup&gt;
defineProps(['count'])
defineEmits(['increment'])
&lt;/script&gt;
</code></pre>
<p>è¿™ç§æ–¹æ³•å¯¹äºå°å‹åº”ç”¨æ¥è¯´æ•ˆæœå¾ˆå¥½ï¼Œä½†å¦‚æœä½ æœ‰æ·±å±‚åµŒå¥—çš„ç»„ä»¶ï¼Œåˆ°å¤„ä¼ é€’ props å’Œ emits å¾ˆå¿«å°±ä¼šå˜å¾—æ··ä¹±ï¼Œä»è€Œå¯¼è‡´æ‰€è°“çš„â€œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fguide%2Fcomponents%2Fprovide-inject.html%23prop-drilling" target="_blank" title="https://vuejs.org/guide/components/provide-inject.html#prop-drilling" ref="nofollow noopener noreferrer">Prop Drilling</a>â€ï¼ˆå±æ€§é€çº§é€ä¼ ï¼‰é—®é¢˜ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼ŒVue æä¾›äº†å¦ä¸€ç§é€‰æ‹©ï¼šprovide/injectã€‚</p>
<h3 data-id="heading-8">Provide/injectï¼šé¿å… Prop Drilling</h3>
<p>Vue ä¸­çš„ <code>provide</code>/<code>inject</code> API ä½¿å¾—çˆ¶ç»„ä»¶èƒ½å¤Ÿè½»æ¾åœ°ä¸å­ç»„ä»¶å…±äº«æ•°æ®ï¼Œæ— è®ºåµŒå¥—å¤šæ·±ï¼Œéƒ½æ— éœ€é€šè¿‡æ¯ä¸€ä¸ªä¸­é—´å±‚çº§å‘ä¸‹ä¼ é€’ propsã€‚</p>
<p>è®©æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢è¿™ä¸ªç®€å•çš„ä»£ç æ¼”ç¤ºï¼š</p>
<h4 data-id="heading-9">çˆ¶ç»„ä»¶</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- ParentComponent.vue --&gt;
&lt;script setup&gt;
import { ref, provide } from 'vue'
import ChildComponent from './ChildComponent.vue'

   const count = ref(0)
   provide('count', count)

   const increment = () =&gt; {
      count.value++
  }
&lt;/script&gt;

&lt;template&gt;
  &lt;div&gt;
    &lt;h2&gt;Parent Count: {{ count }}&lt;/h2&gt;
    &lt;button @click="increment"&gt;Increment&lt;/button&gt;
    &lt;!-- ä¸é€šè¿‡propsä¼ é€’ --&gt;
    &lt;ChildComponent /&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p><code>provide()</code> å‡½æ•°ç”¨äºçˆ¶ç»„ä»¶ä¸­ï¼Œä½¿å…¶æ•°æ®å¯¹åä»£ç»„ä»¶å¯ç”¨ã€‚å®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªæ³¨å…¥é”®å’Œä¸€ä¸ªå€¼ã€‚è¿™ä¸ªé”®å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ– Symbolï¼Œåä»£ç»„ä»¶å°†ä½¿ç”¨è¯¥é”®é€šè¿‡ <code>inject()</code> æ¥è®¿é—®å¯¹åº”çš„å€¼ã€‚å•ä¸ªç»„ä»¶ä¸é™äºè°ƒç”¨ä¸€æ¬¡ï¼›ä½ å¯ä»¥ä½¿ç”¨ä¸åŒçš„é”®å¤šæ¬¡è°ƒç”¨ <code>provide()</code> æ¥å…±äº«ä¸åŒçš„å€¼ã€‚</p>
<p><code>provide()</code> çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä½ æƒ³è¦å…±äº«çš„æ•°æ®ï¼Œå®ƒå¯ä»¥æ˜¯ä»»ä½•ç±»å‹â€”â€”åŸå§‹å€¼ã€å¯¹è±¡ã€å‡½æ•°ï¼Œç”šè‡³æ˜¯åƒ ref æˆ– reactive è¿™æ ·çš„å“åº”å¼çŠ¶æ€ã€‚å½“ä½ æä¾›ä¸€ä¸ªå“åº”å¼å€¼æ—¶ï¼ŒVue ä¸ä¼šä¼ é€’å‰¯æœ¬ï¼›å®ƒä¼šå»ºç«‹ä¸€ä¸ªå®æ—¶è¿æ¥ï¼Œå…è®¸ä½¿ç”¨ <code>inject()</code> çš„åä»£ç»„ä»¶è‡ªåŠ¨ä¸æä¾›è€…ä¿æŒåŒæ­¥ã€‚</p>
<h4 data-id="heading-10">å­ç»„ä»¶</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- ChildComponent.vue --&gt;
&lt;script setup&gt;
import GrandChildComponent from './GrandChildComponent.vue'
&lt;/script&gt;
&lt;template&gt;
  &lt;div&gt;
    &lt;h3&gt;I am the Child&lt;/h3&gt;
    &lt;!-- æ³¨æ„: ä¸é€šè¿‡propsä¼ é€’ --&gt;
    &lt;GrandChildComponent /&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>è¦æ³¨å…¥ç¥–å…ˆç»„ä»¶æä¾›çš„æ•°æ®ï¼Œè¯·åœ¨ <code>GrandChildComponent.vue</code> ä¸­ä½¿ç”¨ <code>inject()</code> å‡½æ•°ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- GrandChildComponent.vue --&gt;
&lt;script setup&gt;
import { inject } from 'vue'
const count = inject('count')
&lt;/script&gt;
&lt;template&gt;
  &lt;div&gt;
    &lt;p&gt;Grandchild sees count: {{ count }}&lt;/p&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>åœ¨ä¸Šé¢çš„ä»£ç æ¼”ç¤ºä¸­ï¼ŒParentComponent æä¾›äº†å“åº”å¼çš„ <code>count</code>ï¼Œå› æ­¤ ChildComponent ä¸éœ€è¦åšä»»ä½•æ“ä½œâ€”â€”å®ƒåªéœ€å‘ä¸‹ä¼ é€’æ’æ§½/å­ç»„ä»¶ã€‚ç„¶å GrandChildComponent å¯ä»¥ç›´æ¥æ³¨å…¥ <code>count</code>ï¼Œå¹¶å¯¹çˆ¶ç»„ä»¶çš„æ›´æ–°ä¿æŒå“åº”ã€‚</p>
<p>è¿™æ˜¯å¦‚ä½•ä½¿ç”¨ <code>provide</code>/<code>inject</code> æ¨¡å¼çš„ä¸€ä¸ªåŸºæœ¬æ¼”ç¤ºï¼›ä¸è¿‡ï¼Œå¦‚æœä½ æƒ³äº†è§£æ›´å¤šï¼Œè¿™ç¯‡æ–‡ç« è¿›è¡Œäº†éå¸¸è¯¦ç»†çš„ä»‹ç»ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.telerik.com%2Fblogs%2Fvue-basics-exploring-vue-provide-inject-pattern" target="_blank" title="https://www.telerik.com/blogs/vue-basics-exploring-vue-provide-inject-pattern" ref="nofollow noopener noreferrer">Vue åŸºç¡€ï¼šæ¢ç´¢ Vue çš„ Provide/Inject æ¨¡å¼</a>ã€‚</p>
<p><code>provide</code>/<code>inject</code> æ¨¡å¼éå¸¸é€‚åˆåœ¨ä¸­å‹åº”ç”¨ä¸­é¿å… Prop Drillingã€‚ç„¶è€Œï¼Œéšç€åº”ç”¨è§„æ¨¡çš„å¢é•¿ï¼Œä»¥è¿™ç§æ–¹å¼ç®¡ç†ä¾èµ–å…³ç³»å¯èƒ½ä¼šå˜å¾—å¤æ‚ã€‚å¯¹äºå¤§å‹ä¸”å¤æ‚çš„åº”ç”¨ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ›´å…·ç»“æ„åŒ–å’Œå¯æ‰©å±•æ€§çš„ä¸“é—¨çŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆï¼Œè¿™æ­£æ˜¯åƒ Pinia è¿™æ ·çš„åº“å¤§æ˜¾èº«æ‰‹çš„åœ°æ–¹ã€‚</p>
<h2 data-id="heading-11">åˆ©ç”¨ Pinia åº”å¯¹å¤§è§„æ¨¡çŠ¶æ€ç®¡ç†</h2>
<p>éšç€ä½ çš„åº”ç”¨ä¸æ–­å¢é•¿ï¼Œåœ¨å¤šä¸ªç»„ä»¶ä¹‹é—´æ‰‹åŠ¨ç®¡ç†çŠ¶æ€ä¼šå¾ˆå¿«å˜å¾—ä»¤äººå¤´ç–¼ã€‚æˆ‘ä»¬ä¹‹å‰ä»‹ç»çš„æ¨¡å¼å¯¹äºå°å‹é¡¹ç›®æ¥è¯´è¿ä½œè‰¯å¥½ï¼Œä½†ä¸€æ—¦ä½ å¼€å§‹æ„å»ºå¤§è§„æ¨¡çš„ç”Ÿäº§çº§åº”ç”¨ï¼Œå°±æœ‰è®¸å¤šäº‹æƒ…éœ€è¦è€ƒè™‘ï¼š</p>
<ul>
<li>çƒ­æ¨¡å—æ›¿æ¢ (HMR)</li>
<li>æ›´å¼ºçš„å›¢é˜Ÿåä½œçº¦å®š</li>
<li>ä¸ Vue DevTools çš„é›†æˆï¼ŒåŒ…æ‹¬æ—¶é—´è½´ã€ç»„ä»¶å†…æ£€æŸ¥å’Œæ—¶å…‰æ—…è¡Œè°ƒè¯• (Time-travel debugging)</li>
<li>æœåŠ¡ç«¯æ¸²æŸ“ (SSR) æ”¯æŒ</li>
</ul>
<p>ä½ éœ€è¦ä¸€ä¸ªä¸­å¤®ä»“åº“ï¼Œä¸€ä¸ªå•ä¸€çš„æ•°æ®æºï¼Œä¾›å¤šä¸ªç»„ä»¶è¯»å–å’Œå†™å…¥ï¼Œè€Œè¿™æ­£æ˜¯ <a href="https://link.juejin.cn?target=https%3A%2F%2Fpinia.vuejs.org%2F" target="_blank" title="https://pinia.vuejs.org/" ref="nofollow noopener noreferrer">Pinia</a> ç™»åœºçš„åœ°æ–¹ã€‚</p>
<p>Pinia æ˜¯ Vue 3 çš„å®˜æ–¹çŠ¶æ€ç®¡ç†åº“ï¼Œä¹Ÿæ˜¯ Vuex çš„ç»§ä»»è€…ã€‚å®ƒä¸“ä¸ºå¤„ç†ä¸Šè¿°æ‰€æœ‰åœºæ™¯è€Œè®¾è®¡ã€‚å®ƒæ›´ç®€å•ã€æ›´ç›´è§‚ï¼Œå¹¶ä¸”æ—¨åœ¨ä¸ç»„åˆå¼ API æ— ç¼é…åˆã€‚</p>
<p>åœ¨æ·±å…¥ä»£ç æ¼”ç¤ºä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ˜ç¡®åŸºç¡€çŸ¥è¯†ã€‚ä»æ ¸å¿ƒä¸Šè®²ï¼ŒçŠ¶æ€ç®¡ç†å…³ä¹ä½ çš„æ•°æ®å­˜æ”¾åœ¨å“ªé‡Œã€å¦‚ä½•è¯»å–ä»¥åŠå¦‚ä½•æ›´æ–°ã€‚Pinia ç”¨å››ä¸ªæ¦‚å¿µå°†è¿™äº›è§„èŒƒåŒ–ï¼š</p>
<ul>
<li>State (çŠ¶æ€)ï¼š è¿™æ˜¯ä½ å®é™…çš„å“åº”å¼æ•°æ®ã€‚æŠŠå®ƒçœ‹ä½œä½ åº”ç”¨çš„å•ä¸€æ•°æ®æºã€‚ä¾‹å¦‚ç”¨æˆ·çš„ä¸ªäººèµ„æ–™è¯¦æƒ…ã€è´­ç‰©è½¦ä¸­çš„å•†å“æˆ–æ¨¡æ€æ¡†æ˜¯å¦æ‰“å¼€ã€‚</li>
<li>Store (ä»“åº“)ï¼š å®¹çº³çŠ¶æ€çš„é›†ä¸­å¼å®¹å™¨ã€‚Store å°†æ•°æ®é›†ä¸­ç®¡ç†ï¼Œè€Œä¸æ˜¯åˆ†æ•£åœ¨å¤šä¸ªç»„ä»¶ä¸­ï¼Œå› æ­¤ä»»ä½•ç»„ä»¶éƒ½å¯ä»¥è®¿é—®å’Œæ›´æ–°å®ƒï¼Œè€Œæ— éœ€æ··ä¹±çš„ Prop é€å±‚ä¼ é€’ (Prop Drilling)ã€‚</li>
<li>Getters (è·å–å™¨)ï¼š å®ƒä»¬å°±åƒ Store çš„è®¡ç®—å±æ€§ã€‚å®ƒä»¬å…è®¸ä½ æ´¾ç”Ÿæˆ–è½¬æ¢çŠ¶æ€å€¼ï¼ˆä¾‹å¦‚ï¼Œè®¡ç®—è´­ç‰©è½¦ä¸­å•†å“çš„æˆæœ¬ï¼‰ï¼Œè€Œæ— éœ€åœ¨å¤šå¤„é‡å¤é€»è¾‘ã€‚</li>
<li>Actions (åŠ¨ä½œ)ï¼š æ›´æ–°çŠ¶æ€çš„å‡½æ•°ã€‚å®ƒä»¬å°±åƒ Vue ç»„ä»¶ä¸­çš„ methodsï¼ˆæ–¹æ³•ï¼‰ï¼Œæ˜¯ä½ å­˜æ”¾ä¿®æ”¹é€»è¾‘çš„åœ°æ–¹ï¼Œæ— è®ºæ˜¯å¢åŠ è®¡æ•°å™¨ã€å‘åˆ—è¡¨æ·»åŠ é¡¹ç›®è¿˜æ˜¯ä» API è·å–æ•°æ®ã€‚</li>
</ul>
<p>å¯ä»¥è¿™æ ·ç†è§£ï¼š</p>
<ul>
<li>State æ˜¯ä½ æŒæœ‰çš„æ•°æ®</li>
<li>Getters æ˜¯ä½ æŸ¥çœ‹æ•°æ®çš„æ–¹å¼</li>
<li>Actions å®šä¹‰æ•°æ®å¦‚ä½•å˜åŒ–</li>
<li>Store æ˜¯è¿™ä¸€åˆ‡çš„æ –èº«ä¹‹æ‰€</li>
</ul>
<p>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬æ¼”ç¤ºå¦‚ä½•å°† Pinia é›†æˆåˆ°æˆ‘ä»¬çš„è®¡æ•°å™¨æ¼”ç¤ºåº”ç”¨ä¸­ã€‚</p>
<h2 data-id="heading-12">è®¾ç½® Pinia</h2>
<p>ä¸º Vue 3 å•é¡µåº”ç”¨è®¾ç½® Pinia éå¸¸ç®€å•ã€‚å¦‚æœä½ æ˜¯ä½¿ç”¨ Vue CLI æˆ– create-vue ä»å¤´å¼€å§‹åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ï¼Œè®¾ç½®å‘å¯¼ç”šè‡³ä¼šè¯¢é—®ä½ æ˜¯å¦è¦ä½¿ç”¨ Pinia ä½œä¸ºä½ çš„çŠ¶æ€ç®¡ç†é¦–é€‰ã€‚</p>
<p>è¦åœ¨æ–°é¡¹ç›®ä¸­æ‰‹åŠ¨è®¾ç½® Piniaâ€”â€”æˆ–å°†å…¶æ·»åŠ åˆ°ç°æœ‰åº”ç”¨ä¸­â€”â€”è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š</p>
<p>é¦–å…ˆï¼Œä½¿ç”¨ <code>npm</code> æˆ– <code>yarn</code> å®‰è£… Pinia åŒ…ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">npm install pinia

<span class="hljs-meta"># or</span>

yarn install pinia
</code></pre>
<p>è¦å°† Pinia æ³¨å†Œåˆ°ä½ çš„åº”ç”¨ä¸­ï¼Œè¯·æ‰“å¼€æŒ‚è½½åº”ç”¨çš„å…¥å£æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ <code>main.js</code> æˆ– <code>main.ts</code>ï¼‰ï¼Œå¹¶åœ¨ä½ çš„ Vue åº”ç”¨å®ä¾‹ä¸Šè°ƒç”¨ <code>app.use(pinia)</code>ï¼š</p>
<p><strong>main.js</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// main.js</span>
<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> { createPinia } <span class="hljs-keyword">from</span> <span class="hljs-string">'pinia'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>

<span class="hljs-keyword">const</span> pinia = <span class="hljs-title function_">createPinia</span>()
<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)

app.<span class="hljs-title function_">use</span>(pinia)
app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>)
</code></pre>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹ä¸ºè®¡æ•°å™¨æ¼”ç¤ºåº”ç”¨åˆ›å»º Store äº†ã€‚</p>
<h3 data-id="heading-13">åˆ›å»º Store</h3>
<p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨ Storeï¼Œæ¼”ç¤ºäº†æ‰€æœ‰å››ä¸ªæ¦‚å¿µã€‚è¦åˆ›å»ºä¸€ä¸ª Storeï¼Œé¦–å…ˆæ–°å»ºä¸€ä¸ªæ–‡ä»¶æ¥å­˜æ”¾ä»£ç ã€‚ä¸€ä¸ªå¥½çš„åšæ³•æ˜¯å°†è¿™äº›æ–‡ä»¶æ”¾åœ¨ä¸“ç”¨çš„ <code>stores</code> æ–‡ä»¶å¤¹ä¸­ï¼Œä»¥ä¿æŒé¡¹ç›®äº•äº•æœ‰æ¡ã€‚</p>
<p><strong>CounterStore.js</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useCounterStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">'counter'</span>,  {

----

})
</code></pre>
<p>æˆ‘ä»¬è¦ä½¿ç”¨ Pinia çš„ <code>defineStore</code> æ–¹æ³•æ¥åˆ›å»º Storeã€‚å®ƒæ¥å—ä¸¤ä¸ªä¸»è¦å‚æ•°ï¼šç¬¬ä¸€ä¸ªæ˜¯ Store çš„ <code>id</code>ï¼Œå®ƒåœ¨ä½ çš„åº”ç”¨ä¸­å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚ä½ å¯ä»¥éšæ„å‘½åï¼Œä½†å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œ<code>counter</code> æ˜¯æœ€åˆé€‚çš„ï¼Œå› ä¸ºè¿™æ­£æ˜¯æˆ‘ä»¬çš„ Store æ‰€ç®¡ç†çš„ã€‚</p>
<p>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå®šä¹‰ Store é€‰é¡¹çš„å¯¹è±¡ã€‚è®©æˆ‘ä»¬åˆ†è§£ä¸€ä¸‹å¯ä»¥åœ¨å…¶ä¸­åŒ…å«çš„å†…å®¹ï¼š</p>
<h3 data-id="heading-14">State</h3>
<p>åœ¨ Store ä¸­å®šä¹‰çš„ç¬¬ä¸€ä¸ªé€‰é¡¹æ˜¯ <code>state</code>ã€‚å¦‚æœä½ ä½¿ç”¨è¿‡ Vue çš„é€‰é¡¹å¼ API (Options API)ï¼Œè¿™ä¼šè®©ä½ å€æ„Ÿäº²åˆ‡ã€‚å®ƒåªæ˜¯ä¸€ä¸ªè¿”å›å¯¹è±¡çš„å‡½æ•°ï¼Œè¯¥å¯¹è±¡åŒ…å«ä½ çš„ Store åº”ç®¡ç†çš„æ‰€æœ‰å“åº”å¼æ•°æ®ã€‚å¯¹äºæˆ‘ä»¬çš„è®¡æ•°å™¨åº”ç”¨æ¼”ç¤ºï¼Œæˆ‘ä»¬å°†å‘ state æ·»åŠ  <code>count</code> å±æ€§ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useCounterStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">'counter'</span>,  {
  <span class="hljs-comment">// State â€” å“åº”å¼å…±äº«æ•°æ®</span>
  <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> ({
    <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
  })
})
</code></pre>
<p>ç„¶åæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°åœ¨ <code>CounterButton.vue</code> ç»„ä»¶ä¸­å¯¼å…¥è¿™ä¸ª Store å¹¶ä½¿ç”¨ <code>count</code> çŠ¶æ€ã€‚</p>
<p><strong>CounterButton.vue</strong></p>
<pre><code class="hljs language-js" lang="js">&lt;script setup&gt;
<span class="hljs-keyword">import</span> { useCounterStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'../stores/CounterStore.jsâ€™
const counter = useCounterStore()
&lt;/script&gt;
&lt;template&gt;
  &lt;div&gt;
  &lt;button &gt;
    Clicked {{ counter.count }} times
 &lt;/button&gt;
 
  &lt;/div&gt;
&lt;/template&gt;
</span></code></pre>
<p>åœ¨ä¸Šé¢çš„ä»£ç ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¯¼å…¥äº† <code>useCounterStore</code> ç„¶åè°ƒç”¨äº†è¯¥æ–¹æ³•ã€‚è¿™å°†è¿”å›æˆ‘ä»¬åœ¨å‰é¢åˆ›å»ºçš„è®¡æ•°å™¨ Store çš„å‰¯æœ¬ã€‚è¿™ä¸ª Store ä¸­çš„çŠ¶æ€æ˜¯å…¨å±€çš„ï¼Œæ„å‘³ç€å¯¹å®ƒæ‰€åšçš„ä»»ä½•æ›´æ–°éƒ½ä¼šè‡ªåŠ¨åæ˜ åœ¨æ‰€æœ‰ä½¿ç”¨è¯¥ Store çš„ç»„ä»¶ä¸­ã€‚</p>
<h3 data-id="heading-15">Getters</h3>
<p>å°±åƒ Vue çš„è®¡ç®—å±æ€§ä¸€æ ·ï¼ŒPinia Store å…è®¸æˆ‘ä»¬å®šä¹‰ <code>getters</code>ã€‚Getter æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªä» Store çŠ¶æ€æ´¾ç”Ÿå‡ºæ¥çš„è®¡ç®—å€¼ã€‚å½“ä½ æƒ³è¦åŸºäºç°æœ‰çŠ¶æ€è½¬æ¢ã€è¿‡æ»¤æˆ–è®¡ç®—æŸäº›å†…å®¹ï¼Œè€Œåˆä¸æƒ³åœ¨ç»„ä»¶ä¹‹é—´é‡å¤é€»è¾‘æ—¶ï¼Œå®ƒä»¬éå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ getter æ–¹æ³•è®¡ç®—å½“å‰çŠ¶æ€çš„ä¹˜ç§¯ï¼š</p>
<p>æ›´æ–°ä½ çš„ <code>CounterStore.js</code>ï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useCounterStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">'counter'</span>,  {

  <span class="hljs-comment">// State â€” å“åº”å¼å…±äº«æ•°æ®</span>
  <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> ({
     <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
  })

  <span class="hljs-comment">// Getters â€” æ´¾ç”ŸçŠ¶æ€</span>
  <span class="hljs-attr">getters</span>: {
    <span class="hljs-attr">doubleCount</span>: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">count</span> * <span class="hljs-number">2</span>
  },

})
</code></pre>
<p>å°±æ˜¯è¿™æ ·ã€‚ç°åœ¨æˆ‘ä»¬æ‹¥æœ‰äº†ä¸€ä¸ª <code>doubleCount</code> å±æ€§ï¼Œå¯ä»¥åœ¨ä»»ä½•ç»„ä»¶ä¸­ä½¿ç”¨ã€‚</p>
<p>åˆ›å»ºä¸€ä¸ª <code>CounterDisplay.vue</code> ç»„ä»¶ï¼Œä½¿ç”¨ <code>doubleCount</code> å±æ€§å‘ç”¨æˆ·æ˜¾ç¤ºæ¶ˆæ¯ã€‚</p>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
import { useCounterStore } from '../stores/CounterStore.js'
const counter = useCounterStore()
&lt;/script&gt;

&lt;template&gt;
  &lt;div&gt;
    &lt;p&gt;Current Count: {{ counter.count }}&lt;/p&gt;
    &lt;p&gt;Double Count: {{ counter.doubleCount }}&lt;/p&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>Getters è®¾è®¡ä¸ºåŒæ­¥çš„ã€‚å¦‚æœä½ éœ€è¦æ‰§è¡Œå¼‚æ­¥å·¥ä½œï¼ˆå¦‚è·å–æ•°æ®ï¼‰ï¼Œè¯·æ”¹ç”¨ Actionã€‚</p>
<h3 data-id="heading-16">Actions</h3>
<p>æˆ‘ä»¬å¯ä»¥åœ¨ Store ä¸­å®šä¹‰çš„æœ€åä¸€ä¸ªé€‰é¡¹æ˜¯ actionsã€‚æŠŠ actions æƒ³è±¡æˆ Store ç‰ˆæœ¬çš„ç»„ä»¶æ–¹æ³•â€”â€”å®ƒä»¬å°è£…äº†æ›´æ”¹çŠ¶æ€æˆ–æ‰§è¡Œä»»åŠ¡çš„é€»è¾‘ã€‚ä¸ä»…ç”¨äºæ´¾ç”Ÿå’Œè¿”å›æ•°æ®çš„ getters ä¸åŒï¼Œactions æ—¨åœ¨æ›´æ–°çŠ¶æ€å’Œå¤„ç†å‰¯ä½œç”¨ã€‚</p>
<p>Actions çš„ä¸€ä¸ªä¸»è¦ä¼˜åŠ¿æ˜¯å®ƒä»¬å¯ä»¥æ˜¯å¼‚æ­¥çš„ï¼Œè¿™ä¸ getters ä¸åŒã€‚è¿™ä½¿å¾—å®ƒä»¬éå¸¸é€‚åˆè¯¸å¦‚ä» API è·å–æ•°æ®ã€å¤„ç†è¡¨å•æäº¤æˆ–æ‰§è¡Œä»»ä½•åœ¨å°†ç»“æœæäº¤å› Store ä¹‹å‰éœ€è¦æ—¶é—´çš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œè¿™æ˜¯ä¸€ä¸ªåˆ›å»ºé€»è¾‘æ¥å¢åŠ çŠ¶æ€ <code>count</code> æˆ–ä» API è·å–åˆå§‹ <code>count</code> æ•°æ®çš„å¥½ä½ç½®ã€‚</p>
<p>æ‰“å¼€æˆ‘ä»¬çš„ <code>CounterStore.js</code> å¹¶æ›´æ–°ä»¥ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useCounterStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">'counter'</span>,  {

  <span class="hljs-comment">// State â€” å“åº”å¼å…±äº«æ•°æ®</span>
  <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> ({
     <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
  })

  <span class="hljs-comment">// Getters â€” æ´¾ç”ŸçŠ¶æ€</span>
  <span class="hljs-attr">getters</span>: {
    <span class="hljs-attr">doubleCount</span>: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">count</span> * <span class="hljs-number">2</span>
  },

  <span class="hljs-comment">// Actions â€” æ›´æ–°çŠ¶æ€çš„é€»è¾‘</span>
  <span class="hljs-attr">actions</span>: {
    <span class="hljs-title function_">increment</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++
    },

    <span class="hljs-keyword">async</span> <span class="hljs-title function_">fetchInitialCount</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/count'</span>)
      <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> res.<span class="hljs-title function_">json</span>()
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = data.<span class="hljs-property">value</span>
    }
  }
})
</code></pre>
<p>ç°åœ¨åœ¨ <code>CounterButton.vue</code> ç»„ä»¶å†…éƒ¨ï¼Œä½ å¯ä»¥è°ƒç”¨ action è€Œä¸æ˜¯ç›´æ¥ä¿®æ”¹çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
import { useCounterStore } from '../stores/CounterStore.jsâ€™
const counter = useCounterStore()
&lt;/script&gt;

&lt;template&gt;
  &lt;button @click="counter.increment"&gt;Increment&lt;/button&gt;
  &lt;button @click="counter.fetchInitialCount"&gt;Load Initial Count&lt;/button&gt;
  &lt;p&gt;Count is: {{ counter.count }}&lt;/p&gt;
&lt;/template&gt;
</code></pre>
<p>ä»ä¸Šé¢çš„ä»£ç ä¿®æ”¹å¯ä»¥çœ‹å‡ºï¼Œ<code>increment()</code> æ˜¯ä¸€ä¸ªç›´æ¥ä¿®æ”¹ Store çŠ¶æ€çš„ç®€å• actionï¼Œè€Œ <code>fetchInitialCount()</code> åˆ™æ¼”ç¤ºäº† action ä¹Ÿå¯ä»¥å¤„ç†å¼‚æ­¥ä»»åŠ¡ï¼Œå¦‚å®šæ—¶å™¨æˆ– APIã€‚ç”±äº Pinia Store æ˜¯å“åº”å¼çš„ï¼Œä¸€æ—¦ action æ›´æ–°äº†çŠ¶æ€ï¼Œæ‰€æœ‰ä½¿ç”¨è¯¥ Store çš„ç»„ä»¶å°†ç«‹å³åæ˜ æ–°å€¼ã€‚</p>
<h2 data-id="heading-17">æ€»ç»“</h2>
<p>Vue ä¸­çš„çŠ¶æ€ç®¡ç†ä¸å¿…è®©äººæ„Ÿåˆ°ä¸çŸ¥æ‰€æªã€‚ä»å°å¤„ç€æ‰‹ï¼Œä½¿ç”¨ <code>ref</code> å’Œ <code>reactive</code> å¤„ç†æœ¬åœ°çŠ¶æ€ã€‚å½“ç»„ä»¶éœ€è¦é€šä¿¡æ—¶ï¼Œ<code>props</code> å’Œ <code>emits</code> æ˜¯è‡ªç„¶çš„é€‰æ‹©ã€‚éšç€åº”ç”¨å¢é•¿ï¼Œ<code>provide</code>/<code>inject</code> æœ‰åŠ©äºå‡å°‘ Prop é€å±‚ä¼ é€’å¹¶ä¿æŒæ¡ç†æ¸…æ™°ã€‚</p>
<p>ä½†å½“ä½ çš„åº”ç”¨éœ€è¦ä¸€ä¸ªåœ¨è®¸å¤šç»„ä»¶ä¹‹é—´å…±äº«ä¸”ä¸€è‡´çš„çŠ¶æ€æ—¶ï¼ŒPinia ä¾¿è„±é¢–è€Œå‡ºã€‚å®ƒæä¾›äº†ä¸€ä¸ªé›†ä¸­ã€å¯æ‰©å±•çš„ Storeï¼Œä½œä¸ºä½ åº”ç”¨çš„å•ä¸€æ•°æ®æºã€‚</p>
<p>çŸ¥é“ä½•æ—¶ä½¿ç”¨æ¯ç§æ–¹æ³•æ˜¯çœŸæ­£çš„å…³é”®ã€‚ä½ ä¸éœ€è¦ä»ç¬¬ä¸€å¤©èµ·å°±ä½¿ç”¨ Piniaï¼Œä½†éšç€é¡¹ç›®å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œä½ ä¼šæ„Ÿæ¿€å®ƒçš„ç»“æ„å’Œå¯é æ€§ã€‚æŒæ¡äº†è¿™äº›é€‰é¡¹ï¼Œä½ å°±å¯ä»¥è‡ªä¿¡åœ°ç®¡ç†çŠ¶æ€â€”â€”æ— è®ºä½ æ˜¯æ„å»ºä¸€ä¸ªå°æŒ‚ä»¶è¿˜æ˜¯ä¸€ä¸ªå¤§è§„æ¨¡çš„ç”Ÿäº§çº§åº”ç”¨ã€‚</p>
<p>å¦‚æœä½ æƒ³è¶…è¶ŠåŸºç¡€çŸ¥è¯†ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fpinia.vuejs.org%2F" target="_blank" title="https://pinia.vuejs.org/" ref="nofollow noopener noreferrer">å®˜æ–¹çš„ Pinia æ–‡æ¡£</a>æ˜¯æœ€å¥½çš„ä¸‹ä¸€æ­¥ã€‚å®ƒæ·±å…¥ä»‹ç»äº†æ’ä»¶ã€é«˜çº§æ¨¡å¼ã€DevTools é›†æˆç­‰å†…å®¹â€”â€”æ‰€æœ‰å†…å®¹éƒ½è§£é‡Šå¾—æ¸…æ™°å®ç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Š10 åˆ†é’Ÿä¸Šæ‰‹ RabbitMQï¼šç”¨ Python å†™ä¸€ä¸ªâ€œä¸ä¸¢æ¶ˆæ¯â€çš„è¿·ä½ æ¶ˆæ¯ç³»ç»Ÿã€‹]]></title>    <link>https://juejin.cn/post/7591130604430049320</link>    <guid>https://juejin.cn/post/7591130604430049320</guid>    <pubDate>2026-01-04T13:58:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591130604430049320" data-draft-id="7591309945511002112" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Š10 åˆ†é’Ÿä¸Šæ‰‹ RabbitMQï¼šç”¨ Python å†™ä¸€ä¸ªâ€œä¸ä¸¢æ¶ˆæ¯â€çš„è¿·ä½ æ¶ˆæ¯ç³»ç»Ÿã€‹"/> <meta itemprop="keywords" content="RabbitMQ"/> <meta itemprop="datePublished" content="2026-01-04T13:58:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ˆé‡Œè°¢é¡¿"/> <meta itemprop="url" content="https://juejin.cn/user/3678304397695056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Š10 åˆ†é’Ÿä¸Šæ‰‹ RabbitMQï¼šç”¨ Python å†™ä¸€ä¸ªâ€œä¸ä¸¢æ¶ˆæ¯â€çš„è¿·ä½ æ¶ˆæ¯ç³»ç»Ÿã€‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3678304397695056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ˆé‡Œè°¢é¡¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T13:58:18.000Z" title="Sun Jan 04 2026 13:58:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ ‡ç­¾ï¼š<br/>
RabbitMQ Â· Python Â· æ¶ˆæ¯é˜Ÿåˆ— Â· å®æˆ˜ Demo Â· å…¥é—¨</p>
<hr/>
<h3 data-id="heading-0">ä¸ºä»€ä¹ˆå†™è¿™ç¯‡ï¼Ÿ</h3>
<p>æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰çš„æ¦‚å¿µå¤§å®¶èƒŒå¾—æ»šç“œçƒ‚ç†Ÿï¼šè§£è€¦ã€å¼‚æ­¥ã€å‰Šå³°ã€‚ä½†â€œç¬¬ä¸€æ¬¡æŠŠæ¶ˆæ¯çœŸæ­£å‘å‡ºå»â€çš„é—¨æ§›ä¾æ—§ä¸å°ï¼š</p>
<ul>
<li>éœ€è¦è£… Erlangï¼Ÿ</li>
<li>ç®¡ç†ç•Œé¢æ€ä¹ˆå¼€ï¼Ÿ</li>
<li>æ¶ˆæ¯ä¼šä¸ä¼šä¸€å‘å°±ä¸¢ï¼Ÿ</li>
</ul>
<p>è¿™ç¯‡æ–‡ç« å¸¦ä½  10 åˆ†é’Ÿè·‘é€šç¬¬ä¸€ä¸ªå¯ç”Ÿäº§çš„ RabbitMQ ç¤ºä¾‹ï¼Œä»£ç ä¸è¶³ 80 è¡Œï¼Œå´è¦†ç›–<strong>æŒä¹…åŒ– + æ‰‹åŠ¨ ACK + è¿æ¥æ–­çº¿é‡è¯•</strong>ç­‰ç”Ÿäº§çº§è¦ç´ ï¼Œå¤åˆ¶å³å¯è¿è¡Œã€‚</p>
<hr/>
<h3 data-id="heading-1">1. ä¸€é”®å¯åŠ¨ RabbitMQ</h3>
<p>ä¸æƒ³è£… Erlangï¼ŸDocker ä¸€æŠŠæ¢­ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker run -d --hostname rabbit \
  --name rabbit \
  -p 5672:5672 \
  -p 15672:15672 \
  rabbitmq:3.12-management
</code></pre>
<p>æµè§ˆå™¨æ‰“å¼€ <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A15672" target="_blank" title="http://localhost:15672" ref="nofollow noopener noreferrer">http://localhost:15672</a><br/>
è´¦å·/å¯†ç ï¼š<code>guest / guest</code><br/>
èƒ½çœ‹åˆ°é˜Ÿåˆ—ã€æ¶ˆæ¯é€Ÿç‡ã€èŠ‚ç‚¹å†…å­˜ï¼Œè°ƒè¯•ç¥å™¨ getâœ”</p>
<hr/>
<h3 data-id="heading-2">2. Python ä¾èµ–ä»…ä¸€ä¸ªåŒ…</h3>
<pre><code class="hljs language-bash" lang="bash">pip install pika==1.3.2
</code></pre>
<hr/>
<h3 data-id="heading-3">3. é˜Ÿåˆ—ä¸æ¶ˆæ¯ï¼šå…ˆå£°æ˜ï¼Œå†ä½¿ç”¨</h3>
<p>RabbitMQ çš„å“²å­¦ï¼š<strong>é˜Ÿåˆ—åªåˆ›å»ºä¸€æ¬¡ï¼Œè°å…ˆåˆ°è°å£°æ˜</strong>ã€‚<br/>
ç¤ºä¾‹é‡ŒæŠŠ <code>durable=True</code> æ‰“å¼€ï¼Œå³ä½¿ MQ é‡å¯ï¼Œé˜Ÿåˆ—å…ƒæ•°æ®ä¹Ÿä¸ä¼šä¸¢ã€‚</p>
<hr/>
<h3 data-id="heading-4">4. ç”Ÿäº§è€…ä»£ç ï¼ˆproducer.pyï¼‰</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> pika, sys

QUEUE = <span class="hljs-string">'demo_queue'</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    conn = pika.BlockingConnection(pika.ConnectionParameters(<span class="hljs-string">'localhost'</span>))
    ch = conn.channel()
    ch.queue_declare(queue=QUEUE, durable=<span class="hljs-literal">True</span>)          <span class="hljs-comment"># æŒä¹…åŒ–é˜Ÿåˆ—</span>

    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):
        body = <span class="hljs-string">f'hello <span class="hljs-subst">{i}</span>'</span>
        ch.basic_publish(exchange=<span class="hljs-string">''</span>,
                         routing_key=QUEUE,
                         body=body,
                         properties=pika.BasicProperties(delivery_mode=<span class="hljs-number">2</span>))  <span class="hljs-comment"># æŒä¹…åŒ–æ¶ˆæ¯</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f' [x] Sent "<span class="hljs-subst">{body}</span>"'</span>)
    conn.close()

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-keyword">try</span>:
        main()
    <span class="hljs-keyword">except</span> KeyboardInterrupt:
        sys.exit()
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"> [<span class="hljs-meta">x</span>] Sent <span class="hljs-string">"hello 0"</span>
 [<span class="hljs-meta">x</span>] Sent <span class="hljs-string">"hello 1"</span>
 ...
 [<span class="hljs-meta">x</span>] Sent <span class="hljs-string">"hello 9"</span>
</code></pre>
<hr/>
<h3 data-id="heading-5">5. æ¶ˆè´¹è€…ä»£ç ï¼ˆconsumer.pyï¼‰</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> pika, time, sys

QUEUE = <span class="hljs-string">'demo_queue'</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">callback</span>(<span class="hljs-params">ch, method, properties, body</span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f' [x] Received <span class="hljs-subst">{body.decode()}</span>'</span>)
    time.sleep(<span class="hljs-number">1</span>)                               <span class="hljs-comment"># æ¨¡æ‹Ÿè€—æ—¶</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">' [x] Done'</span>)
    ch.basic_ack(delivery_tag=method.delivery_tag)  <span class="hljs-comment"># æ‰‹åŠ¨ ack</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    conn = pika.BlockingConnection(pika.ConnectionParameters(<span class="hljs-string">'localhost'</span>))
    ch = conn.channel()
    ch.queue_declare(queue=QUEUE, durable=<span class="hljs-literal">True</span>)
    ch.basic_qos(prefetch_count=<span class="hljs-number">1</span>)              <span class="hljs-comment"># å…¬å¹³åˆ†å‘</span>
    ch.basic_consume(queue=QUEUE, on_message_callback=callback)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">' [*] Waiting for messages. To exit press CTRL+C'</span>)
    ch.start_consuming()

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    <span class="hljs-keyword">try</span>:
        main()
    <span class="hljs-keyword">except</span> KeyboardInterrupt:
        sys.exit()
</code></pre>
<p>è¿è¡Œåï¼Œæ¯ç§’å¤„ç† 1 æ¡æ¶ˆæ¯ï¼Œ10 ç§’å®Œæˆå…¨éƒ¨ä»»åŠ¡ï¼›<br/>
RabbitMQ UI ä¸­ <code>Messages</code> ä» 10 â†’ 0ï¼Œæ²¡æœ‰ä¸€æ¡ç§¯å‹ã€‚</p>
<hr/>
<h3 data-id="heading-6">6. å°ç»“ï¼šæˆ‘ä»¬åˆ°åº•åšäº†ä»€ä¹ˆï¼Ÿ</h3>






























<table><thead><tr><th>å…³é”®ç‚¹</th><th>å‘½ä»¤/å‚æ•°</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>é˜Ÿåˆ—æŒä¹…åŒ–</td><td><code>queue_declare(durable=True)</code></td><td>MQ é‡å¯é˜Ÿåˆ—ä¸ä¸¢</td></tr><tr><td>æ¶ˆæ¯æŒä¹…åŒ–</td><td><code>delivery_mode=2</code></td><td>æœåŠ¡å™¨æ‰ç”µæ¶ˆæ¯ä¸ä¸¢</td></tr><tr><td>æ‰‹åŠ¨ ACK</td><td><code>basic_ack</code></td><td>æ¶ˆè´¹è€…å´©æºƒæ—¶æ¶ˆæ¯å¯é‡æ–°æŠ•é€’</td></tr><tr><td>å…¬å¹³åˆ†å‘</td><td><code>basic_qos(prefetch_count=1)</code></td><td>æ…¢æ¶ˆè´¹è€…ä¸ä¼šè¢«å‹å®</td></tr></tbody></table>
<p>æŠŠè¿™ 4 é¡¹é…ç½®æ¬åˆ°ç”Ÿäº§ç¯å¢ƒï¼Œä½ å°±å·²ç»æˆ˜èƒœäº† 80% çš„â€œæ¶ˆæ¯ä¸¢å¤±â€äº‹æ•…ã€‚</p>
<hr/>
<h3 data-id="heading-7">7. ä¸‹ä¸€æ­¥å¯ä»¥ç©ä»€ä¹ˆï¼Ÿ</h3>
<ol>
<li>æŠŠ <code>demo_queue</code> æ¢æˆ <code>topic</code> æ¨¡å¼ï¼Œå®ç°æ—¥å¿—çº§åˆ«è·¯ç”±ï¼›</li>
<li>ç”¨ <code>RPC</code> æ¨¡å¼åšåŒæ­¥è°ƒç”¨ï¼Œå‡è£…è‡ªå·±æ˜¯ä¸€ä¸ªå¾®æœåŠ¡ç½‘å…³ï¼›</li>
<li>å¼€é•œåƒé˜Ÿåˆ— + é›†ç¾¤ï¼ŒKill æ‰ä»»ä¸€èŠ‚ç‚¹ï¼Œæ¶ˆæ¯ä¾æ—§åœ¨çº¿ï¼›</li>
<li>ç»™æ¶ˆè´¹ç«¯åŠ  <code>retry + dead-letter-exchange</code>ï¼Œè‡ªåŠ¨é‡è¯• 3 æ¬¡åè¿›å…¥æ­»ä¿¡é˜Ÿåˆ—ï¼Œäººå·¥å¤„ç†ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-8">8. ä¸€å¥é¸¡æ±¤</h3>
<p>æ¶ˆæ¯é˜Ÿåˆ—çš„éš¾ç‚¹ä»æ¥ä¸åœ¨äºâ€œå‘æ¶ˆæ¯â€ï¼Œè€Œåœ¨äºâ€œå¤±è´¥æ—¶æ¶ˆæ¯è¿˜åœ¨â€ã€‚<br/>
å…ˆè®©ä»Šå¤©çš„ 10 æ¡æ¶ˆæ¯ä¸ä¸¢ï¼Œå†å»è€ƒè™‘ç™¾ä¸‡ QPS çš„å®ä¼Ÿè“å›¾â€”â€”è„šä¸‹å·²å‡ºå‘ï¼Œè¿œæ–¹ä¸è¿œã€‚</p>
<p>å®Œæ•´æºç å·²ä¸Šä¼  GitHubï¼š<br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fyourname%2Frabbitmq-python-minimal" target="_blank" title="https://github.com/yourname/rabbitmq-python-minimal" ref="nofollow noopener noreferrer">github.com/yourname/raâ€¦</a><br/>
æ¬¢è¿ Star &amp; PRï¼Œç¥å¤§å®¶æ’é˜Ÿæ„‰å¿«ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI åŸç”Ÿä¸‹çš„æ–°çš„ç¤¾åŒºå½¢æ€ä¼šæ˜¯ä»€ä¹ˆ]]></title>    <link>https://juejin.cn/post/7591350620188377094</link>    <guid>https://juejin.cn/post/7591350620188377094</guid>    <pubDate>2026-01-04T12:05:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591350620188377094" data-draft-id="7591422577937612806" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI åŸç”Ÿä¸‹çš„æ–°çš„ç¤¾åŒºå½¢æ€ä¼šæ˜¯ä»€ä¹ˆ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-04T12:05:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="XCaptaino"/> <meta itemprop="url" content="https://juejin.cn/user/3052665287739005"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI åŸç”Ÿä¸‹çš„æ–°çš„ç¤¾åŒºå½¢æ€ä¼šæ˜¯ä»€ä¹ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3052665287739005/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    XCaptaino
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T12:05:04.000Z" title="Sun Jan 04 2026 12:05:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>AI ä¸ä¼šæ€æ­»ç¤¾åŒºï¼Œä½†ä¼šæ€æ­»é‚£äº›åªåš â€œä¿¡æ¯æ¬è¿å·¥â€ çš„å¹³åº¸ç¤¾åŒºã€‚Stack Overflow çš„ä¸‹æ»‘ä¸ Reddit çš„åšæŒºå°±æ˜¯æœ€å¥½çš„ä¾‹è¯ã€‚æœªæ¥çš„ç¤¾åŒºå¿…é¡»æ„å»ºä»¥ â€œ<strong>å¯ä¿¡</strong>â€ ä¸ â€œ<strong>ç‹¬åˆ›æ€§</strong>â€ ã€ â€œ<strong>ç”¨æˆ·æ·±åº¦é“¾æ¥</strong>â€ä¸ºæ ¸å¿ƒçš„èµ„äº§ä½“ç³»ï¼Œå°† AI ä½œä¸ºè¿‡æ»¤å™ªéŸ³çš„è¿‡æ»¤å™¨å’Œæ”¾å¤§åˆ›æ„çš„æ”¾å¤§å™¨ï¼Œè€Œéæ›¿ä»£äººç±»æ€è€ƒçš„ç”Ÿæˆå™¨ã€‚æœ¬æ–‡æ²¡æœ‰ç­”æ¡ˆï¼Œå•çº¯è®°å½•ä¸€ä¸‹ä¸€äº›æ€è€ƒ</p>
<p>åœ¨ AIGC è¾¹é™…æˆæœ¬è¶‹é›¶çš„èƒŒæ™¯ä¸‹ï¼Œä¼ ç»Ÿ â€œæé—® - å›ç­”â€ çš„çŸ¥è¯†æ¬è¿æ¨¡å¼å·²éš¾ä»¥ä¸ºç»§ã€‚
æˆ‘è§‰å¾—æœ‰ä¸€äº›é—®é¢˜æ˜¯ä¼ ç»Ÿç¤¾åŒºå’ŒçŸ¥è¯†é—®ç­”ç¤¾åŒºå¿…é¡»è¦å›ç­”çš„é—®é¢˜</p>
<ul>
<li><strong>ä»·å€¼å‡çº§ï¼š</strong> å½“æ ‡å‡†ç­”æ¡ˆå”¾æ‰‹å¯å¾—ï¼Œç¤¾åŒºå¦‚ä½•æä¾› AI æ— æ³•ç”Ÿæˆçš„ç¨€ç¼ºä»·å€¼ï¼Ÿ</li>
<li><strong>ç§©åºé‡æ„ï¼š</strong> åœ¨äººæœºæ··æ‚çš„ç¯å¢ƒä¸­ï¼Œå¦‚ä½•ä¿è¯å†…å®¹çš„å¯ä¿¡åº¦ä¸ç¤¾åŒºçš„è®¨è®ºç§©åºï¼Ÿ</li>
<li><strong>é‡åŒ–è½åœ°ï¼š</strong> å¦‚ä½•å»ºç«‹ä¸€å¥—å¯æ‰§è¡Œã€å¯ç›‘æµ‹çš„æŒ‡æ ‡ä½“ç³»æ¥æŒ‡å¯¼æ—¥å¸¸è¿è¥ï¼Ÿ</li>
</ul>
<h2 data-id="heading-0">ç¤¾åŒºå½¢æ€çš„æ¼”è¿›è„‰ç»œ</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/376b096f1a0e461799a055da60ec4e34~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWENhcHRhaW5v:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768133104&amp;x-signature=lj2KXeX3H6GD2ai0zYW0IEGmVYM%3D" alt="image.png" loading="lazy"/></p>
<p>å›é¡¾äº’è”ç½‘ç¤¾åŒºçš„å‘å±•ï¼Œæ¯ä¸€æ¬¡æŠ€æœ¯è·ƒè¿éƒ½é‡å¡‘äº† â€œè¿æ¥â€ çš„æ–¹å¼ã€‚æˆ‘ä»¬æ­£åœ¨ç»å†ä»ç¤¾äº¤ç½‘ç»œå‘ â€œAI åŸç”Ÿç¤¾åŒºâ€ è·¨è¶Šçš„å…³é”®æ—¶åˆ»ã€‚è¿™ä¸€æ¼”è¿›å¹¶éæ–­è£‚ï¼Œè€Œæ˜¯å¯¹ç¤¾åŒºæ ¸å¿ƒè¦ç´ çš„æ·±åŒ–ã€‚</p>
<p><strong>å…´è¶£è®ºå› (1979-2003)ï¼š</strong> å—é™äºæ‹¨å·å¸¦å®½ï¼Œç”¨æˆ·åŸºäºçº¯ç²¹å…´è¶£èšåˆï¼ˆå¦‚ Usenet, NGAï¼‰ã€‚æ ¸å¿ƒæ˜¯ â€œè®¤åŒæ„Ÿâ€ã€‚</p>
<p><strong>å†…å®¹å¹³å° (2003-2016)ï¼š</strong> æœç´¢å¼•æ“ä¸å®½å¸¦æ™®åŠï¼Œæ”¾å¤§äº†åˆ†å‘æ•ˆç‡ï¼ˆå¦‚ Reddit, çŸ¥ä¹ï¼‰ã€‚æ ¸å¿ƒæ˜¯ â€œå½±å“åŠ›â€ã€‚</p>
<p><strong>ç¤¾äº¤ç½‘ç»œ (2016-è‡³ä»Š)ï¼š</strong> ç§»åŠ¨äº’è”ä¸ç®—æ³•æ¨èï¼Œæµé‡ç²¾å‡†å˜ç°ï¼ˆå¦‚ TikTok, å°çº¢ä¹¦ï¼‰ã€‚æ ¸å¿ƒæ˜¯ â€œå•†ä¸šä»·å€¼â€ã€‚</p>
<p><strong>AIåŸç”Ÿç¤¾åŒº (æœªæ¥ 1)ï¼š</strong> ç”Ÿæˆå¼ AI è®©å†…å®¹ç”Ÿäº§æˆæœ¬è¶‹é›¶ã€‚æ ¸å¿ƒå›å½’ â€œçœŸå®åä½œâ€ ä¸ â€œäººæœºå…±ç”Ÿâ€ã€‚</p>
<p>åœ¨æ–°èŒƒå¼ä¸‹ï¼Œæˆ‘ä»¬å¿…é¡»é‡æ–°å®¡è§†ç¤¾åŒºçš„ä¸‰å¤§åŸºçŸ³ï¼š</p>
<h4 data-id="heading-1">å®šä½</h4>
<p>ä¸å†æ˜¯ â€œæ‰¾ç­”æ¡ˆâ€ï¼Œè€Œæ˜¯ <strong>â€œæ‰¾å…±é¸£â€ ä¸ â€œè§£å†³å¤æ‚é—®é¢˜â€</strong> ã€‚</p>
<p>ç”¨æˆ·æ¥è¿™é‡Œæ˜¯å› ä¸º AI æ— æ³•æä¾›æƒ…æ„Ÿæ…°è—‰æˆ–å¤„ç†éæ ‡åœºæ™¯ã€‚</p>
<h4 data-id="heading-2">æ–‡åŒ–</h4>
<p>ä»å´‡æ‹œ â€œå¤§ç¥â€ è½¬å‘<strong>å´‡æ‹œ â€œçœŸå®â€</strong> ã€‚</p>
<p>ç¤¾åŒºåº”é¼“åŠ±åŸåˆ›ã€ä¸ªäººç»å†ä¸æ·±åº¦æ€è€ƒï¼Œæ˜ç¡®æ’æ–¥æ‰¹é‡ç”Ÿæˆçš„æµæ°´çº¿å†…å®¹ã€‚</p>
<h4 data-id="heading-3">è§„åˆ™</h4>
<p>å»ºç«‹<strong>äººæœºåˆ†å±‚</strong>çš„æ¿€åŠ±æœºåˆ¶ã€‚</p>
<p>ä¸¥æƒ©ä¼ªè£…æˆäººç±»çš„ AI çŒæ°´ï¼Œé‡å¥–ç»è¿‡éªŒè¯çš„é«˜ä»·å€¼äººç±»è´¡çŒ®ã€‚</p>
<h2 data-id="heading-4">ç”Ÿæˆå¼ AI å¯¹çŸ¥è¯†å‹ç¤¾åŒºçš„å·®å¼‚åŒ–å½±å“</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e1319724de9c4bfda29d1ec4a1b8d6ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWENhcHRhaW5v:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768133104&amp;x-signature=JyClvQRbvYUYr2IiWcAdu5Gy9JM%3D" alt="image.png" loading="lazy"/></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.nature.com%2Farticles%2Fs41598-024-61221-0" target="_blank" title="https://www.nature.com/articles/s41598-024-61221-0" ref="nofollow noopener noreferrer">Nature (2024)</a> çš„ç ”ç©¶é€šè¿‡å¯¹æ¯” Stack Overflow (SO) ä¸ Reddit å¼€å‘è€…ç¤¾åŒºï¼Œæ­ç¤ºäº† â€œä¿¡æ¯å‹â€ ä¸ â€œå…³ç³»å‹â€ ç¤¾åŒºçš„ä¸åŒå‘½è¿ã€‚</p>

























<table><thead><tr><th>ç»´åº¦</th><th>Stack Overflow (çº¯ä¿¡æ¯å‹)</th><th>Reddit å¼€å‘è€…ç¤¾åŒº (å…³ç³»/è®¨è®ºå‹)</th></tr></thead><tbody><tr><td><strong>æµé‡å˜åŒ–</strong></td><td><strong>ä¸‹é™çº¦ 12%</strong> (æ—¥å‡å‡å°‘ç™¾ä¸‡çº§è®¿é—®)</td><td>æ— æ˜¾è‘—ç»Ÿè®¡å­¦å·®å¼‚ï¼Œä¿æŒç¨³å®š</td></tr><tr><td><strong>æé—®ç‰¹å¾</strong></td><td>æ€»ä½“æé—®é‡ä¸‹æ»‘ï¼Œç®€å•é—®é¢˜æ¶ˆå¤±ï¼Œ<strong>é—®é¢˜å¤æ‚åº¦æ˜¾è‘—ä¸Šå‡</strong></td><td>ç»´æŒåŸæœ‰è®¨è®ºç”Ÿæ€ï¼Œè¯é¢˜æœªå—æ˜æ˜¾å†²å‡»</td></tr><tr><td><strong>ç”¨æˆ·æµå¤±</strong></td><td><strong>æ–°æ‰‹ç”¨æˆ·å¤§é‡æµå¤±</strong>ï¼Œç•™å­˜ç”¨æˆ·å¤šä¸ºè€æ‰‹</td><td>ç”¨æˆ·ç»“æ„æœªè§æ˜æ˜¾æ–­å±‚</td></tr></tbody></table>
<p><strong>è¿è¥å¯ç¤ºï¼š</strong></p>
<ul>
<li><strong>æ‹¥æŠ±å¤æ‚ï¼š</strong> ç®€å•é—®é¢˜è¢« AI æ‹¦æˆªæ˜¯å¿…ç„¶ï¼Œç¤¾åŒºåº”ä¸»åŠ¨å¼•å¯¼ç”¨æˆ·è®¨è®º â€œæ²¡æœ‰æ ‡å‡†ç­”æ¡ˆâ€ çš„å¤æ‚åœºæ™¯ã€‚</li>
<li><strong>å¢å¼ºçº½å¸¦ï¼š</strong> Reddit çš„éŸ§æ€§è¯æ˜äº† â€œäººé™…è¿æ¥â€ çš„æŠ¤åŸæ²³ä½œç”¨ã€‚åº”å¢åŠ  AMA (Ask Me Anything)ã€åœ†æ¡Œè®¨è®ºç­‰å¼ºäº’åŠ¨å½¢å¼ã€‚</li>
<li><strong>å¥–åŠ±éæ ‡ï¼š</strong> ä¿®æ”¹ç§¯åˆ†è§„åˆ™ï¼Œé™ä½å¯¹ç®€å•æ¬è¿å†…å®¹çš„å¥–åŠ±ï¼Œå¤§å¹…æå‡å¯¹ç»éªŒåˆ†äº«ã€è§‚ç‚¹è¾©è®ºçš„æ¿€åŠ±æƒé‡ã€‚</li>
</ul>
<h2 data-id="heading-5">ä¿¡æ¯/å…³ç³»/è§‚ç‚¹ä¸‰ç±»ç¤¾åŒºçš„å®æ“ç­–ç•¥</h2>
<p>ä¸åŒç±»å‹çš„ç¤¾åŒºåº”é‡‡å–å·®å¼‚åŒ–çš„è½¬å‹ç­–ç•¥ï¼š</p>
<h4 data-id="heading-6">A) Stack Overflow</h4>
<p><strong>ä¿¡æ¯å‹ï¼šè½¬å‹ä¸“å®¶ç½‘ç»œ</strong></p>
<ul>
<li><strong>èšç„¦æ·±åº¦ï¼š</strong> å¼•å¯¼æé—®è€…è¡¥å……è¯¦ç»†ä¸Šä¸‹æ–‡ï¼Œæ‹’ç» â€œä¸€å¥è¯æé—®â€ã€‚</li>
<li><strong>ä¸“å®¶è®¡åˆ’ï¼š</strong> è®¤è¯é¢†åŸŸä¸“å®¶ï¼Œå¯¹ç»è¿‡ä¸“å®¶éªŒè¯çš„ç­”æ¡ˆç»™äºˆåŒå€æƒé‡ã€‚</li>
<li><strong>ä¸¥ç¦çŒæ°´ï¼š</strong> å¯¹å¤åˆ¶ç²˜è´´ GPT ç­”æ¡ˆçš„è´¦å·å®è¡Œé›¶å®¹å¿å°ç¦ã€‚</li>
</ul>
<h4 data-id="heading-7">B) Reddit Dev</h4>
<p><strong>å…³ç³»å‹ï¼šå¼ºåŒ–ç¤¾äº¤å¯†åº¦</strong></p>
<ul>
<li><strong>ä¸»é¢˜æ´»åŠ¨ï¼š</strong> å®šæœŸä¸¾åŠ AMAã€é»‘å®¢é©¬æ‹‰æ¾ï¼Œåˆ¶é€  â€œæ°›å›´æ„Ÿâ€ä¸ºç”¨æˆ·æä¾›æ·±åº¦é“¾æ¥çš„åœºæ™¯å’Œæœºä¼šã€‚</li>
<li><strong>ç‰ˆä¸»è‡ªæ²»ï¼š</strong> èµ‹æƒç‰ˆä¸»åˆ¶å®šä¸ªæ€§åŒ–çš„å AI è§„åˆ™ï¼ˆå¦‚ç‰¹å®šæ¿å—ç¦æ­¢ AIï¼‰ã€‚</li>
<li><strong>ç¾¤ç»„åä½œï¼š</strong> é¼“åŠ±åŸºäºé¡¹ç›®çš„é•¿å‘¨æœŸè®¨è®ºï¼Œè€Œéå•æ¬¡é—®ç­”ã€‚</li>
</ul>
<h4 data-id="heading-8">C) Hacker News</h4>
<p><strong>è§‚ç‚¹å‹ï¼šæå«åŸåˆ›æ€è€ƒ</strong></p>
<ul>
<li><strong>æ…¢é€Ÿ Karmaï¼š</strong> ä¿æŒé«˜é—¨æ§›çš„ä¿¡èª‰ç§¯ç´¯æœºåˆ¶ï¼Œé˜²æ­¢ AI åˆ·å·ã€‚</li>
<li><strong>è¾…åŠ©æ ‡è¯†ï¼š</strong> å…è®¸ AI è¾…åŠ©æ¶¦è‰²ï¼Œä½†å¿…é¡»åœ¨æ–‡æœ«å£°æ˜ï¼Œå¼ºè°ƒè§‚ç‚¹å±äºäººç±»ã€‚</li>
<li><strong>æ¥æºæ ¸æŸ¥ï¼š</strong> å¯¹å¼•ç”¨é“¾æ¥è¿›è¡Œè‡ªåŠ¨åŒ–çœŸå®æ€§æ ¡éªŒï¼Œé˜²æ­¢å¹»è§‰ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b54f9fda5bd4c5db9b599330ddac737~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWENhcHRhaW5v:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768133104&amp;x-signature=bZcHJB4RhA3Fc28QhyWL8uXWUC0%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨Claudeä¸­é—® "å…ƒèŠ³ï¼ˆGeminiï¼‰ä½ æ€ä¹ˆçœ‹ï¼Ÿ"]]></title>    <link>https://juejin.cn/post/7591360623469314058</link>    <guid>https://juejin.cn/post/7591360623469314058</guid>    <pubDate>2026-01-04T12:18:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591360623469314058" data-draft-id="7591322050240610342" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨Claudeä¸­é—® &quot;å…ƒèŠ³ï¼ˆGeminiï¼‰ä½ æ€ä¹ˆçœ‹ï¼Ÿ&quot;"/> <meta itemprop="keywords" content="AIç¼–ç¨‹,Claude,Gemini"/> <meta itemprop="datePublished" content="2026-01-04T12:18:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é»„æ—æ™´"/> <meta itemprop="url" content="https://juejin.cn/user/3985057546510423"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨Claudeä¸­é—® "å…ƒèŠ³ï¼ˆGeminiï¼‰ä½ æ€ä¹ˆçœ‹ï¼Ÿ"
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3985057546510423/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é»„æ—æ™´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T12:18:40.000Z" title="Sun Jan 04 2026 12:18:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»16åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å½“å‰å¯¹ç¨‹åºå‘˜è¾ƒä¸ºå‹å¥½çš„ä¸¤ç§AIå·¥å…·ï¼Œåº”è¯¥éClaudeå’ŒGeminiè«å±ã€‚å°½ç®¡å…¬è®¤Claudeåœ¨ç¼–ç ä¸Šèƒ½åŠ›æ›´å¼ºï¼Œä½†æ˜¯Geminiä¹Ÿæœ‰è‡ªå·±çš„ä¼˜åŠ¿ï¼Œå¦‚100ä¸‡Tokenè¶…é•¿ä¸Šä¸‹æ–‡ã€åŸç”Ÿå¤šæ¨¡æ€æ”¯æŒå›¾ç‰‡ã€PDFã€éŸ³é¢‘ã€è§†é¢‘ç­‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2350f52dd08946a29b5fbdd74b48dff1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buE5p6X5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768133920&amp;x-signature=xu8YihaZWGIgfLpN5xQpU1Y9C%2BM%3D" alt="" loading="lazy"/></p>
<p>åœ¨æˆ‘ä»¬ä½¿ç”¨Claudeçš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå‡ºç°å¦‚ä¸‹åœºæ™¯ï¼š</p>
<ul>
<li>Claudeçš„ç­”æ¡ˆä¸æ˜¯é‚£ä¹ˆæ»¡æ„ï¼Œæƒ³å¯¹æ¯”çœ‹çœ‹Geminiçš„ç­”æ¡ˆ</li>
<li>åœ¨ç‰¹å®šåœºæ™¯ä¸‹ï¼Œå°±æƒ³ä½¿ç”¨æ›´é«˜æ•ˆçš„Geminiæ¥å¤„ç†</li>
</ul>
<p>è¿™ä¸ªæ—¶å€™ï¼Œä¸ç®¡æˆ‘ä»¬æ˜¯åŒæ—¶å¼€ç€ä¸¤ä¸ªCLIè¿˜æ˜¯ä½¿ç”¨ç½‘é¡µç‰ˆçš„Geminiï¼Œéƒ½èƒ½ä½“ä¼šåˆ°æ¥å›åˆ‡æ¢å·¥å…·æˆ–è€…é‡æ–°äº¤ä»£ä¸Šä¸‹æ–‡çš„ç—›è‹¦ã€‚è€Œæˆ‘ä»¬è¦åšåˆ°çš„å°±æ˜¯ï¼Œåœ¨å¿…è¦æ—¶å€™ï¼Œåªéœ€è¦åœ¨Claudeä¸­é—®ä¸€å¥â€œgeminiä½ æ€ä¹ˆçœ‹â€ ï¼ŒClaudeå°±å¯ä»¥è¾“å‡ºGeminiçš„ç»“æœã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/549c23688e574b42b8c30fe15ad53b6b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buE5p6X5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768133920&amp;x-signature=Nt%2BH8AObANgC93IorNeLXNEg5I4%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">æ€ä¹ˆåšğŸŒŸ</h2>
<p>æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ç›´æ¥åœ¨Claudeä¸­æ‰§è¡Œgeminiçš„BashæŒ‡ä»¤ï¼Œæ¯”å¦‚æˆ‘ä»¬å…ˆåœ¨Claudeä¸­é—® 1+1ç­‰äºå¤šå°‘ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f2c595de35f348129170a24d7a357b06~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buE5p6X5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768133920&amp;x-signature=YF%2FW%2F%2FrikyHxFA2DFVfY0JvhvLY%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœæˆ‘ä»¬æƒ³è®©Geminiæ¥å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€è¦æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤ï¼š</p>
<pre><code class="hljs language-css" lang="css">gemini -<span class="hljs-selector-tag">p</span> <span class="hljs-number">1</span>+<span class="hljs-number">1</span>ç­‰äºå¤šå°‘
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bdea7f58aa2f4b029dd37586ec5a29c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buE5p6X5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768133920&amp;x-signature=Y7x%2FP3mAZNgcML%2B5LtYEvZVmrhM%3D" alt="" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒGeminiä¹Ÿç»™å‡ºäº†ç­”æ¡ˆã€‚è¿™ä¸ªä¾‹å­å¯èƒ½ä¸å¤Ÿå‡†ç¡®çš„è®©ä½ æ„è¯†åˆ°è¿™ä¸ªGeminiçš„å›ç­”ç¡®å®æ¥è‡ªGeminiã€‚æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªå›¾ç‰‡çš„ä¾‹å­ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6635bb8debd2472b815c331696857599~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buE5p6X5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768133920&amp;x-signature=SlR%2F%2BCIixp2FQEj9UYZZcYPvS0k%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ä»¬å…ˆè®©Claudeæ¥æè¿°è¿™å¼ å›¾ç‰‡ï¼Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-quote">&gt; test-image.png è¿™å¼ å›¾ç‰‡æ˜¯å¹²å˜›çš„ </span>

âº Let me read the image file to see what it contains.

âº Read(test-image.png)
  â¿  Read image (25.5KB)
  â¿  Running PostToolUse hooksâ€¦ (1/2 done)

âº è¿™å¼ å›¾ç‰‡æ˜¾ç¤ºäº†ä¸€ä¸ªæ·±è‰²ä¸»é¢˜çš„ IDE/ä»£ç ç¼–è¾‘å™¨ç•Œé¢ã€‚ä»å›¾ç‰‡æ¥çœ‹:

<span class="hljs-bullet">  -</span> å·¦ä¾§æ˜¯æ–‡ä»¶èµ„æºç®¡ç†å™¨ä¾§è¾¹æ ï¼Œæ˜¾ç¤ºäº†é¡¹ç›®æ–‡ä»¶ç»“æ„
<span class="hljs-bullet">  -</span> ä¸»ç¼–è¾‘åŒºåŸŸæ˜¾ç¤ºäº†ä¸€ä¸ªæ·±è‰²èƒŒæ™¯çš„ç¼–è¾‘å™¨
<span class="hljs-bullet">  -</span> çœ‹èµ·æ¥åƒæ˜¯ Visual Studio Code æˆ–ç±»ä¼¼çš„å¼€å‘ç¯å¢ƒ

  æ ¹æ®æ–‡ä»¶å test-image.pngï¼Œè¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªæµ‹è¯•ç”¨çš„æˆªå›¾æ–‡ä»¶ã€‚è¿™å¼ å›¾ç‰‡å¯èƒ½æ˜¯ç”¨äº:
<span class="hljs-bullet">  -</span> æµ‹è¯•å›¾ç‰‡è¯»å–åŠŸèƒ½
<span class="hljs-bullet">  -</span> ä½œä¸ºé¡¹ç›®ä¸­çš„ç¤ºä¾‹æˆ–æµ‹è¯•èµ„æº
<span class="hljs-bullet">  -</span> è®°å½•æŸä¸ªå¼€å‘ç¯å¢ƒçš„é…ç½®æˆ–ç•Œé¢
</code></pre>
<p>å†è®©Geminiæ¥æè¿°è¿™å¼ å›¾ç‰‡ï¼Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-scss" lang="scss"> <span class="hljs-built_in">Bash</span>(gemini "è¿™å¼ å›¾ç‰‡æ˜¯å¹²å˜›çš„" &lt; test-image.png)
  â¿ è¿™å¼ å›¾ç‰‡ï¼ˆtest-image<span class="hljs-selector-class">.png</span>ï¼‰æ˜¯ä¸€ä¸ª **<span class="hljs-number">800</span>x600 åƒç´ çš„ PNG å›¾åƒ**ã€‚                                              

    ä»äºŒè¿›åˆ¶æ•°æ®æ¥çœ‹ï¼Œå®ƒä¼¼ä¹æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„å›¾åƒï¼Œå¾ˆå¯èƒ½æ˜¯ä¸€ä¸ªåŒ…å«
    **ç™½è‰²èƒŒæ™¯å’Œå°‘é‡å›¾å½¢å…ƒç´ **ï¼ˆå¦‚ç®€å•çš„çº¿æ¡æˆ–å›¾æ ‡
    â€¦ +<span class="hljs-number">3</span> lines (ctrl+o to expand)
  â¿  Running PostToolUse hooksâ€¦ (<span class="hljs-number">1</span>/<span class="hljs-number">2</span> done)

âº æ ¹æ® Gemini CLI çš„åˆ†æ,test-image<span class="hljs-selector-class">.png</span> æ˜¯ä¸€å¼  <span class="hljs-number">800</span>x600 åƒç´ çš„ PNG å›¾åƒ,åŒ…å«ç™½è‰²èƒŒæ™¯å’Œä¸€äº›ç®€å•çš„å›¾å½¢å…ƒç´ (å¦‚çº¿æ¡æˆ–å›¾æ ‡)ã€‚

  ä»æ–‡ä»¶å test_cl ç›®å½•çš„ä½ç½®æ¥çœ‹,è¿™å¼ å›¾ç‰‡å¾ˆå¯èƒ½æ˜¯ç”¨äºå¼€å‘æˆ–æµ‹è¯• Gemini CLI å›¾åƒå¤„ç†åŠŸèƒ½çš„ç¤ºä¾‹ç´ æã€‚å®ƒä½œä¸ºä¸€ä¸ªæµ‹è¯•æ–‡ä»¶,ç”¨æ¥éªŒè¯å›¾åƒåˆ†æå’Œè§†è§‰è¯†åˆ«åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä»–ä»¬çš„å›ç­”æ˜¯å®Œå…¨ä¸ä¸€è‡´çš„ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸å¯èƒ½æ¯æ¬¡éƒ½å»å†™ä¸€ä¸ª<code>gemini -p</code> æŒ‡ä»¤ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±æƒ³åˆ°äº†å°†ä¸Šè¿°æŒ‡ä»¤æè¿°æˆä¸€ä¸ªskillã€‚</p>
<h2 data-id="heading-2">å¥½çš„æ–¹å¼ğŸŒŸğŸŒŸ</h2>
<p>åˆ›å»ºä¸€ä¸ªskillæ¥æè¿°æˆ‘ä»¬çš„è¦æ±‚ï¼š</p>
<ul>
<li>æ‰§è¡ŒGeminiæŒ‡ä»¤åˆ†æé—®é¢˜</li>
<li>å°†Geminiåˆ†æçš„ç»“æœä¸Claudeçš„ç»“æœè¿›è¡Œå¯¹æ¯”</li>
</ul>

<pre><code class="hljs language-arduino" lang="arduino">---  name:  gemini  description:  Cross-AI  comparison  tool  that  executes  Gemini  CLI  <span class="hljs-keyword">and</span>  compares  results  with  Claude<span class="hljs-number">'</span>s  responses.  Use  when  user  asks  <span class="hljs-string">"geminiæ€ä¹ˆçœ‹"</span>,  <span class="hljs-string">"è®©geminiå›ç­”"</span>,  <span class="hljs-keyword">or</span>  mentions  <span class="hljs-string">"gemini"</span>  to  get  alternative  perspectives  <span class="hljs-keyword">and</span>  compare  AI  model  outputs.  Supports  both  text  questions  <span class="hljs-keyword">and</span>  image  analysis  queries.  ---  # Gemini Cross-AI Comparison   ## Overview   This  skill  enables  cross-AI  comparison  by  executing  the  Gemini  CLI  tool  <span class="hljs-keyword">and</span>  contrasting  its  responses  with  Claude<span class="hljs-number">'</span>s  answers.  This  provides  users  with  multiple  perspectives  <span class="hljs-keyword">and</span>  helps  validate  accuracy.   ## Workflow   ### <span class="hljs-number">1.</span> Detect Trigger   Trigger <span class="hljs-keyword">this</span> skill when user uses phrases like:  -  <span class="hljs-string">"geminiæ€ä¹ˆçœ‹"</span>  -  <span class="hljs-string">"è®©geminiå›ç­”"</span>  -  <span class="hljs-string">"ç”¨geminiåˆ†æ"</span>  -  <span class="hljs-string">"geminiè®¤ä¸ºå‘¢"</span>  -  Or  any  <span class="hljs-keyword">explicit</span>  request  to  get  Gemini<span class="hljs-number">'</span>s  opinion   ### <span class="hljs-number">2.</span> Extract Query   Identify  the  user<span class="hljs-number">'</span>s  actual question <span class="hljs-keyword">or</span> task:  -  For text:  Extract  the  core  question  being  asked  -  For images:  Note  the  image  file  path  <span class="hljs-keyword">and</span>  the  question  about  it  -  Handle  both  direct  questions  <span class="hljs-keyword">and</span>  contextual  follow-ups   ### <span class="hljs-number">3.</span> Execute Gemini CLI   **For  text-only  questions:**  ```bash  gemini  <span class="hljs-string">"ç”¨æˆ·çš„é—®é¢˜"</span>  ```   **For  image  analysis:**  ```bash  gemini  <span class="hljs-string">"ç”¨æˆ·çš„é—®é¢˜"</span>  &lt;  image.png  ```   **For  multiple  images:**  ```bash  gemini  <span class="hljs-string">"ç”¨æˆ·çš„é—®é¢˜"</span>  &lt;  image1.png  ```   Execute  the  command  <span class="hljs-keyword">and</span>  capture  Gemini<span class="hljs-number">'</span>s  complete  response.   ### <span class="hljs-number">4.</span> Compare Responses   Analyze  differences  between  Claude<span class="hljs-number">'</span>s  <span class="hljs-keyword">and</span>  Gemini<span class="hljs-number">'</span>s  answers:   **Comparison  Dimensions:**  -  **Accuracy**:  Which  answer  is  more  factually  correct?  -  **Completeness**:  Did  one  miss  important  details?  -  **Clarity**:  Which  explanation  is  easier  to  understand?  -  **Approach**:  Different  reasoning  paths  <span class="hljs-keyword">or</span>  perspectives  -  **Tone**:  Formal  vs  casual,  concise  vs  verbose  -  **Specific  insights**:  Unique  points  from  either  model   **Key  Differences  to  Highlight:**  -  Contradictions  <span class="hljs-keyword">or</span>  disagreements  -  Complementary  information  -  Different  emphasis  <span class="hljs-keyword">or</span>  priorities  -  Unique  capabilities  shown   ### <span class="hljs-number">5.</span> Present Comparison   Format output as:   ```  ## Gemini çš„å›ç­”   [ Gemini<span class="hljs-number">'</span>s  complete  response ]  ## å¯¹æ¯”åˆ†æ   ### ä¸»è¦å·®å¼‚  [ Key  differences  bullet  points ]  ### å„è‡ªä¼˜åŠ¿  -  **Claude**: [ What  Claude  did  better ] -  **Gemini**: [ What  Gemini  did  better ]  ### å»ºè®®  [ When  to  prefer  which  answer , <span class="hljs-keyword">or</span>  <span class="hljs-keyword">if</span>  combining  both  would  be  optimal ] ```   ## Best Practices   <span class="hljs-number">1</span> .  **Be  fair  <span class="hljs-keyword">and</span>  objective**:  Acknowledge  when  Gemini  provides  better  <span class="hljs-keyword">or</span>  more  accurate  answers  <span class="hljs-number">2</span> .  **Preserve  context**:  If  <span class="hljs-keyword">this</span>  is  a  follow-up  question,  include  relevant  context  in  the  Gemini  query  <span class="hljs-number">3</span> .  **Handle  errors  gracefully**:  If  gemini  CLI  fails,  explain  the  error  <span class="hljs-keyword">and</span>  suggest  alternatives  <span class="hljs-number">4</span> .  **Avoid  bias**:  Don<span class="hljs-number">'</span>t  always  favor  Claude<span class="hljs-number">'</span>s  answer  -  genuinely  assess  which  is  better  <span class="hljs-number">5</span> .  **Be  concise**:  Focus  on  meaningful  differences,  <span class="hljs-keyword">not</span>  minor  stylistic  variations   ## Error Handling   If gemini CLI fails:  -  Check <span class="hljs-keyword">if</span> gemini CLI is installed:  `which  gemini`  -  Verify syntax:  text  questions  use  quotes,  images  use  stdin  redirect  -  Check  image  file  exists  <span class="hljs-keyword">and</span>  is  readable  -  Report  specific  error  message  to  user  -  Fall  back  to  Claude-only  response  <span class="hljs-keyword">if</span>  needed   ## Examples   **Example  <span class="hljs-number">1</span>:  Text  question**  User:  <span class="hljs-string">"geminiæ€ä¹ˆçœ‹ Python çš„å¼‚æ­¥ç¼–ç¨‹ï¼Ÿ"</span>  Execute:  `gemini  <span class="hljs-string">"Python çš„å¼‚æ­¥ç¼–ç¨‹æœ‰ä»€ä¹ˆç‰¹ç‚¹å’Œä¼˜åŠ¿ï¼Ÿ"</span>`   **Example  <span class="hljs-number">2</span>:  Image  analysis**  User:  <span class="hljs-string">"geminiæ€ä¹ˆçœ‹è¿™å¼ å›¾ç‰‡é‡Œçš„ä»£ç æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ screenshot.png"</span>  Execute:  `gemini  <span class="hljs-string">"è¿™å¼ å›¾ç‰‡é‡Œçš„ä»£ç æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ"</span>  &lt;  screenshot.png`   **Example  <span class="hljs-number">3</span>:  Verification**  User:  <span class="hljs-string">"Claude è¯´ç­”æ¡ˆæ˜¯ 42ï¼Œè®©geminiéªŒè¯ä¸€ä¸‹"</span>  Execute:  `gemini  <span class="hljs-string">"ç­”æ¡ˆæ˜¯ 42 å¯¹å—ï¼Ÿ[context from previous conversation]"</span> 
</code></pre>
<p>ç°åœ¨æˆ‘ä»¬æ¥ç”¨ä¸€ä¸ªé”™è¯¯ç™¾å‡ºçš„å®ä½“ç±»ï¼ŒéªŒè¯ä¸‹è¿™ä¸ªskillã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">pakage com.mistake.demo
inport kotlin.random.Random
clas BrokenCalculator {
</code></pre>
<p>Claudeæ‰§è¡Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">&gt; BrokenCalculator è¿™ä¸ªç±»ä¸­æœ‰å“ªäº›é”™è¯¯ 

âº æˆ‘æ¥å¸®ä½ æŸ¥æ‰¾å¹¶åˆ†æ BrokenCalculator ç±»ä¸­çš„é”™è¯¯ã€‚

âº Search(pattern: <span class="hljs-string">"**/*BrokenCalculator*"</span>)
  â¿  Found <span class="hljs-number">1</span> file (ctrl+o to expand)
  â¿  Running PostToolUse hooksâ€¦ (<span class="hljs-number">1</span>/<span class="hljs-number">2</span> done)

âº Bash(file /Users/linqinghuang/test/test_cl/BrokenCalculator)
  â¿  /Users/linqinghuang/test/test_cl/BrokenCalculator: ASCII text
  â¿  Running PostToolUse hooksâ€¦ (<span class="hljs-number">1</span>/<span class="hljs-number">2</span> done)

âº Read(BrokenCalculator)
  â¿  Read <span class="hljs-number">3</span> lines
  â¿  Running PostToolUse hooksâ€¦ (<span class="hljs-number">1</span>/<span class="hljs-number">2</span> done)

âº Read(BrokenCalculator)
  â¿  Read <span class="hljs-number">3</span> lines
  â¿  Running PostToolUse hooksâ€¦ (<span class="hljs-number">1</span>/<span class="hljs-number">2</span> done)

âº æ‰¾åˆ°äº† BrokenCalculator æ–‡ä»¶ï¼Œè¿™ä¸ª Kotlin ç±»ä¸­æœ‰ä»¥ä¸‹å‡ ä¸ªé”™è¯¯ï¼š

  è¯­æ³•é”™è¯¯ï¼ˆæ‹¼å†™é”™è¯¯ï¼‰ï¼š 

  <span class="hljs-number">1.</span> ç¬¬<span class="hljs-number">1</span>è¡Œï¼špakage â†’ åº”è¯¥æ˜¯ <span class="hljs-keyword">package</span>
  pakage com.mistake.demo  <span class="hljs-comment">// é”™è¯¯</span>
  <span class="hljs-keyword">package</span> com.mistake.demo <span class="hljs-comment">// æ­£ç¡®</span>
  <span class="hljs-number">2.</span> ç¬¬<span class="hljs-number">2</span>è¡Œï¼šinport â†’ åº”è¯¥æ˜¯ <span class="hljs-keyword">import</span>
  inport kotlin.random.Random  <span class="hljs-comment">// é”™è¯¯</span>
  <span class="hljs-keyword">import</span> kotlin.random.Random  <span class="hljs-comment">// æ­£ç¡®</span>
  <span class="hljs-number">3.</span> ç¬¬<span class="hljs-number">3</span>è¡Œï¼šclas â†’ åº”è¯¥æ˜¯ <span class="hljs-keyword">class</span>
  <span class="hljs-title class_">clas</span> <span class="hljs-title">BrokenCalculator</span> {  <span class="hljs-comment">// é”™è¯¯</span>
  <span class="hljs-keyword">class</span> <span class="hljs-title class_">BrokenCalculator</span> {  <span class="hljs-comment">// æ­£ç¡®</span>

  å…¶ä»–é—®é¢˜ï¼š 
  - ç±»å®šä¹‰ä¸å®Œæ•´ï¼Œç¼ºå°‘ç±»çš„ä¸»ä½“å†…å®¹
  - æ²¡æœ‰é—­åˆçš„å¤§æ‹¬å· }
  - æ²¡æœ‰å®é™…çš„ç±»å®ç°

  è¿™äº›éƒ½æ˜¯ç¼–è¯‘æ—¶é”™è¯¯ï¼Œä¼šå¯¼è‡´ä»£ç æ— æ³•ç¼–è¯‘é€šè¿‡ã€‚
</code></pre>
<p>æ¥ç€é—®â€œ<strong>geminiä½ æ€ä¹ˆçœ‹</strong>â€ï¼Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"> geminiä½ æ€ä¹ˆçœ‹

âº /gemini

âº Bash(gemini "è¯·åˆ†æ /Users/linqinghuang/test/test<span class="hljs-emphasis">_cl/BrokenCalculator
      è¿™ä¸ªæ–‡ä»¶ä¸­æœ‰å“ªäº›é”™è¯¯ï¼Ÿè¯·è¯¦ç»†æŒ‡å‡ºæ‰€æœ‰é—®é¢˜ã€‚")
  â¿  I will start by verifying the file's existence and reading its content to analyze it.
     `/Users/linqinghuang/test/test_</span>cl/BrokenCalculator` æ–‡ä»¶åŒ…å«ä»¥ä¸‹ Kotlin è¯­æ³•é”™è¯¯ï¼š
<span class="hljs-code">     â€¦ +18 lines (ctrl+o to expand)
  â¿  Running PostToolUse hooksâ€¦ (1/2 done)
</span>
âº Gemini çš„å›ç­”

  Gemini æŒ‡å‡ºäº†ä»¥ä¸‹é—®é¢˜ï¼š

<span class="hljs-bullet">  1.</span> å…³é”®å­—æ‹¼å†™é”™è¯¯ï¼š
<span class="hljs-bullet">    -</span> pakage åº”æ›´æ­£ä¸º package
<span class="hljs-bullet">    -</span> inport åº”æ›´æ­£ä¸º import
<span class="hljs-bullet">    -</span> clas åº”æ›´æ­£ä¸º class
<span class="hljs-bullet">  2.</span> æ–‡ä»¶æ‰©å±•åç¼ºå¤±ï¼š
<span class="hljs-bullet">    -</span> è¯¥æ–‡ä»¶åŒ…å« Kotlin ä»£ç ï¼Œä½†æ²¡æœ‰ .kt æ‰©å±•å
<span class="hljs-bullet">    -</span> å»ºè®®é‡å‘½åä¸º BrokenCalculator.kt

  æä¾›äº†ä¿®æ­£åçš„ä»£ç ç¤ºä¾‹ã€‚

  å¯¹æ¯”åˆ†æ

  ä¸»è¦å·®å¼‚

<span class="hljs-bullet">  -</span> Gemini é¢å¤–å‘ç°ï¼šæ–‡ä»¶æ‰©å±•åé—®é¢˜ï¼ˆç¼ºå°‘ .ktï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå®ç”¨çš„è§‚å¯Ÿ
<span class="hljs-bullet">  -</span> Claude é¢å¤–å‘ç°ï¼šç±»å®šä¹‰ä¸å®Œæ•´ï¼ˆç¼ºå°‘ä¸»ä½“å†…å®¹å’Œé—­åˆå¤§æ‹¬å·ï¼‰

  å„è‡ªä¼˜åŠ¿

<span class="hljs-bullet">  -</span> Claudeï¼šæ›´è¯¦ç»†åœ°å±•ç¤ºäº†é”™è¯¯ä½ç½®å’Œä»£ç å¯¹æ¯”æ ¼å¼ï¼Œä½¿ç”¨äº†ä»£ç å—å±•ç¤ºé”™è¯¯å’Œæ­£ç¡®çš„å†™æ³•å¯¹æ¯”
<span class="hljs-bullet">  -</span> Geminiï¼šå‘ç°äº†æ–‡ä»¶æ‰©å±•åè¿™ä¸ªå®é™…éƒ¨ç½²æ—¶çš„é‡è¦é—®é¢˜ï¼Œå¹¶æä¾›äº†å®Œæ•´çš„ä¿®æ­£åä»£ç ç¤ºä¾‹

  å»ºè®®

  ç»“åˆä¸¤è€…çš„ç­”æ¡ˆæœ€ä½³ï¼š
<span class="hljs-bullet">  -</span> Gemini æŒ‡å‡ºçš„æ–‡ä»¶æ‰©å±•åé—®é¢˜åœ¨å®é™…å¼€å‘ä¸­å¾ˆé‡è¦ï¼Œåº”è¯¥é‡‡çº³
<span class="hljs-bullet">  -</span> ä¸¤ä¸ªæ¨¡å‹éƒ½å‡†ç¡®è¯†åˆ«äº†æ ¸å¿ƒçš„æ‹¼å†™é”™è¯¯
<span class="hljs-bullet">  -</span> ä¸¤è€…éƒ½åº”è¯¥æåˆ°ä»£ç ä¸å®Œæ•´çš„é—®é¢˜ï¼ˆGemini çš„ä¿®æ­£ä»£ç ç¤ºä¾‹éšå«äº†è¿™ä¸€ç‚¹ï¼Œä½†æ²¡æœ‰æ˜ç¡®è¯´æ˜ï¼‰

  æ€»ç»“ï¼šGemini åœ¨æ–‡ä»¶æ‰©å±•åé—®é¢˜ä¸Šæ›´èƒœä¸€ç­¹ï¼Œè¿™æ˜¯ä¸€ä¸ªå®¹æ˜“è¢«å¿½ç•¥ä½†å®é™…å¾ˆé‡è¦çš„ç»†èŠ‚ã€‚
</code></pre>
<p>ä»ç»“æœä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒGeminiè¾“å‡ºäº†è‡ªå·±çš„å›ç­”å¹¶ä¸”å¯¹æ¯”åˆ†æäº†ä¸Claudeå›ç­”çš„å·®å¼‚æ€§ã€‚åˆ°è¿™é‡Œå·²ç»è¾¾åˆ°äº†æˆ‘ä»¬çš„ç›®çš„ã€‚ä½†å½“å‰ä»ç„¶å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šGeminiçš„è¿”å›ç»“æœä¼šæ±¡æŸ“Claudeçš„ä¸Šä¸‹æ–‡ã€‚</p>
<h2 data-id="heading-3">æ›´å¥½çš„æ–¹å¼ ğŸŒŸğŸŒŸğŸŒŸ</h2>
<p>å¦‚æœæˆ‘ä»¬æƒ³è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±éœ€è¦å®šä¹‰ä¸€ä¸ªSubagentæ¥å•ç‹¬æ‰§è¡ŒGeminiçš„ä»»åŠ¡ï¼Œè¿™æ ·Claudeä¸»å¯¹è¯å°±åªæœ‰ä¸€ä¸ªæ‘˜è¦ï¼Œè¿™é‡Œæˆ‘ä»¬å°†Subagentè®¾è®¡ä¸ºåŒæ­¥æ‰§è¡Œçš„ã€‚ skillæè¿°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">---
name: gemini
<span class="hljs-section">description: Cross-AI comparison tool that executes Gemini CLI and compares results with Claude's responses. Use when user asks "geminiæ€ä¹ˆçœ‹", "è®©geminiå›ç­”", or mentions "gemini" to get alternative perspectives and compare AI model outputs. Supports both text questions and image analysis queries.
---</span>

<span class="hljs-section"># Gemini Cross-AI Comparison</span>

<span class="hljs-section">## Overview</span>

This skill enables cross-AI comparison by executing the Gemini CLI tool and contrasting its responses with Claude's answers. This provides users with multiple perspectives and helps validate accuracy.

<span class="hljs-section">## Workflow</span>

<span class="hljs-section">### 1. Detect Trigger</span>

Trigger this skill when user uses phrases like:
<span class="hljs-bullet">-</span> "geminiæ€ä¹ˆçœ‹"
<span class="hljs-bullet">-</span> "è®©geminiå›ç­”"
<span class="hljs-bullet">-</span> "ç”¨geminiåˆ†æ"
<span class="hljs-bullet">-</span> "geminiè®¤ä¸ºå‘¢"
<span class="hljs-bullet">-</span> Or any explicit request to get Gemini's opinion

<span class="hljs-section">### 2. Extract Query and Claude's Response</span>

Identify the user's actual question or task:
<span class="hljs-bullet">-</span> For text: Extract the core question being asked
<span class="hljs-bullet">-</span> For images: Note the image file path and the question about it
<span class="hljs-bullet">-</span> Handle both direct questions and contextual follow-ups

<span class="hljs-strong">**Important**</span> : Capture Claude's response to the user's question, as it will be passed to the Subagent for comparison.

<span class="hljs-section">### 3. Execute Gemini CLI via Subagent</span>

å¯åŠ¨ä¸€ä¸ªç‹¬ç«‹çš„åŒæ­¥ agent æ¥æ‰§è¡Œ gemini å‘½ä»¤å¹¶å®Œæˆå¯¹æ¯”åˆ†æï¼Œé¿å…æ±¡æŸ“ä¸»å¯¹è¯ä¸Šä¸‹æ–‡ã€‚

<span class="hljs-strong">**Agent é…ç½®æ–‡ä»¶**</span> ï¼š<span class="hljs-code">`~/.claude/agents/gemini-comparison-agent.md`</span>

<span class="hljs-strong">**ä½¿ç”¨æ–¹æ³•ï¼š**</span>

<span class="hljs-bullet">1.</span> <span class="hljs-strong">**è¯»å– Agent é…ç½®**</span> ï¼š
   <span class="hljs-code">```
   Read ~/.claude/agents/gemini-comparison-agent.md
   ```</span>

<span class="hljs-bullet">2.</span> <span class="hljs-strong">**å¯åŠ¨ Subagent**</span> ï¼š
   ä½¿ç”¨ Task å·¥å…·ï¼Œä¼ å…¥ï¼š
<span class="hljs-bullet">   -</span> <span class="hljs-strong">**subagent <span class="hljs-emphasis">_type** : general-purpose
   - **run_</span> in <span class="hljs-emphasis">_background** : falseï¼ˆåŒæ­¥æ‰§è¡Œï¼‰
   - **description** : "Compare Gemini and Claude responses"
   - **prompt** : åŒ…å«ä»¥ä¸‹å†…å®¹
     - å¼•ç”¨ gemini-comparison-agent.md çš„å®Œæ•´å†…å®¹
     - Claude çš„å“åº”
     - ç”¨æˆ·æŸ¥è¯¢
     - å›¾ç‰‡è·¯å¾„ï¼ˆå¦‚æœé€‚ç”¨ï¼‰

**ç¤ºä¾‹ Prompt ç»“æ„** ï¼š
```
è¯·æŒ‰ç…§ä»¥ä¸‹ agent é…ç½®æ‰§è¡Œä»»åŠ¡ï¼š

[ä» ~/.claude/agents/gemini-comparison-agent.md è¯»å–çš„å†…å®¹]

---

å½“å‰ä»»åŠ¡ï¼š
- Claude çš„å“åº”ï¼š{CLAUDE'S_</span>RESPONSE}
- ç”¨æˆ·æŸ¥è¯¢ï¼š{USER<span class="hljs-emphasis">_QUERY}
- å›¾ç‰‡è·¯å¾„ï¼š{IMAGE_</span>PATH}ï¼ˆå¯é€‰ï¼‰
```

**</span> å…³é”®ç‚¹ï¼š **
<span class="hljs-bullet">-</span> Agent é…ç½®æ–‡ä»¶ä½äº <span class="hljs-code">`~/.claude/agents/gemini-comparison-agent.md`</span>
<span class="hljs-bullet">-</span> ä½¿ç”¨ <span class="hljs-code">`run_in_background: false`</span> ç¡®ä¿åŒæ­¥æ‰§è¡Œ
<span class="hljs-bullet">-</span> Subagent åœ¨ç‹¬ç«‹ä¼šè¯ä¸­è¿è¡Œï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡å®Œå…¨éš”ç¦»
<span class="hljs-bullet">-</span> ä¸è¦åœ¨ä¸»å¯¹è¯ä¸­ç›´æ¥ä½¿ç”¨ Bash å·¥å…·æ‰§è¡Œ gemini å‘½ä»¤

<span class="hljs-section">### 4. Present Comparison</span>

Subagent ä¼šè¿”å›å®Œæ•´çš„å¯¹æ¯”åˆ†æç»“æœã€‚ç›´æ¥å°† Subagent çš„è¾“å‡ºå±•ç¤ºç»™ç”¨æˆ·å³å¯ï¼Œä¸éœ€è¦å†è¿›è¡Œä»»ä½•å¤„ç†æˆ–æ ¼å¼åŒ–ã€‚

Subagent çš„è¾“å‡ºå·²ç»åŒ…å«äº†ï¼š
<span class="hljs-bullet">-</span> Gemini çš„å®Œæ•´å›ç­”
<span class="hljs-bullet">-</span> ä¸»è¦å·®å¼‚åˆ†æ
<span class="hljs-bullet">-</span> å„è‡ªä¼˜åŠ¿
<span class="hljs-bullet">-</span> ç»¼åˆå»ºè®®

<span class="hljs-section">## Best Practices</span>

<span class="hljs-bullet">1.</span> ** Always use Subagent ** : å¿…é¡»é€šè¿‡ Subagent æ‰§è¡Œ gemini å‘½ä»¤ï¼Œä¸è¦åœ¨ä¸»å¯¹è¯ä¸­ç›´æ¥ä½¿ç”¨ Bash å·¥å…·
<span class="hljs-bullet">2.</span> ** Pass Claude's response ** : ç¡®ä¿ Subagent èƒ½å¤Ÿè·å¾— Claude çš„å®Œæ•´å“åº”ï¼Œä»¥ä¾¿è¿›è¡Œå‡†ç¡®å¯¹æ¯”
<span class="hljs-bullet">3.</span> ** Be fair and objective ** : æ‰¿è®¤å½“ Gemini æä¾›æ›´å¥½æˆ–æ›´å‡†ç¡®çš„ç­”æ¡ˆæ—¶
<span class="hljs-bullet">4.</span> ** Preserve context ** : å¦‚æœæ˜¯åç»­é—®é¢˜ï¼Œåœ¨ä¼ ç»™ Subagent çš„æŸ¥è¯¢ä¸­åŒ…å«ç›¸å…³ä¸Šä¸‹æ–‡
<span class="hljs-bullet">5.</span> ** Avoid bias ** : ä¸è¦æ€»æ˜¯åå‘ Claude çš„ç­”æ¡ˆ - çœŸè¯šåœ°è¯„ä¼°å“ªä¸ªæ›´å¥½
<span class="hljs-bullet">6.</span> ** Be concise ** : ä¸“æ³¨äºæœ‰æ„ä¹‰çš„å·®å¼‚ï¼Œè€Œéæ¬¡è¦çš„é£æ ¼å˜åŒ–
<span class="hljs-bullet">7.</span> ** Context isolation ** : Subagent çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸ä¸»å¯¹è¯å®Œå…¨éš”ç¦»ï¼Œä¿æŒä¸»å¯¹è¯å†å²æ¸…æ™°

<span class="hljs-section">## Error Handling</span>

å½“ä½¿ç”¨ Subagent æ—¶å¯èƒ½é‡åˆ°çš„é”™è¯¯æƒ…å†µï¼š

** Subagent æ‰§è¡Œå¤±è´¥ï¼š **
<span class="hljs-bullet">-</span> å¦‚æœ Task å·¥å…·æ‰§è¡Œå¤±è´¥ï¼Œå‘ç”¨æˆ·è¯´æ˜ Subagent å¯åŠ¨é—®é¢˜
<span class="hljs-bullet">-</span> æä¾›é”™è¯¯è¯¦æƒ…å’Œå»ºè®®çš„é‡è¯•æ–¹æ¡ˆ

** gemini CLI ä¸å¯ç”¨ï¼š **
<span class="hljs-bullet">-</span> Subagent ä¼šæ£€æµ‹ <span class="hljs-code">`gemini`</span> å‘½ä»¤æ˜¯å¦å¯ç”¨
<span class="hljs-bullet">-</span> å¦‚æœä¸å¯ç”¨ï¼ŒSubagent ä¼šæŠ¥å‘Šå…·ä½“é”™è¯¯ä¿¡æ¯
<span class="hljs-bullet">-</span> å»ºè®®ç”¨æˆ·æ£€æŸ¥ gemini CLI æ˜¯å¦å·²æ­£ç¡®å®‰è£…

** å‘½ä»¤è¯­æ³•é”™è¯¯ï¼š **
<span class="hljs-bullet">-</span> æ–‡æœ¬æŸ¥è¯¢ï¼šä½¿ç”¨å¼•å·åŒ…è£¹æŸ¥è¯¢å†…å®¹
<span class="hljs-bullet">-</span> å›¾ç‰‡æŸ¥è¯¢ï¼šä½¿ç”¨ stdin é‡å®šå‘ <span class="hljs-code">`&lt; {IMAGE_PATH}`</span>
<span class="hljs-bullet">-</span> æ£€æŸ¥å›¾ç‰‡æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”å¯è¯»

<span class="hljs-strong">**é™çº§ç­–ç•¥ï¼š**</span>
<span class="hljs-bullet">-</span> å¦‚æœ gemini CLI ä¸å¯ç”¨æˆ–æ‰§è¡Œå¤±è´¥
<span class="hljs-bullet">-</span> å‘ç”¨æˆ·è¯´æ˜æƒ…å†µ
<span class="hljs-bullet">-</span> æä¾› Claude çš„åŸå§‹ç­”æ¡ˆä½œä¸ºå‚è€ƒ
<span class="hljs-bullet">-</span> å»ºè®®ç”¨æˆ·ç¨åé‡è¯•æˆ–æ‰‹åŠ¨ä½¿ç”¨ gemini CLI

<span class="hljs-section">## Examples</span>

<span class="hljs-strong">**Example 1: Text question**</span>

ç”¨æˆ·è¾“å…¥ï¼š
<span class="hljs-code">```
User: "geminiæ€ä¹ˆçœ‹ Python çš„å¼‚æ­¥ç¼–ç¨‹ï¼Ÿ"
```</span>

æ‰§è¡Œæµç¨‹ï¼š
<span class="hljs-bullet">1.</span> Claude å·²ç»ç»™å‡ºäº†å…³äº Python å¼‚æ­¥ç¼–ç¨‹çš„å›ç­”
<span class="hljs-bullet">2.</span> å¯åŠ¨ Subagentï¼Œä¼ å…¥ Claude çš„å“åº”
<span class="hljs-bullet">3.</span> Subagent æ‰§è¡Œï¼š<span class="hljs-code">`gemini "Python çš„å¼‚æ­¥ç¼–ç¨‹æœ‰ä»€ä¹ˆç‰¹ç‚¹å’Œä¼˜åŠ¿ï¼Ÿ"`</span>
<span class="hljs-bullet">4.</span> Subagent è¿”å›å¯¹æ¯”åˆ†æç»“æœ
<span class="hljs-bullet">5.</span> ç›´æ¥å±•ç¤º Subagent çš„è¾“å‡º

<span class="hljs-strong">**Example 2: Image analysis**</span>

ç”¨æˆ·è¾“å…¥ï¼š
<span class="hljs-code">```
User: "geminiæ€ä¹ˆçœ‹è¿™å¼ å›¾ç‰‡é‡Œçš„ä»£ç æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ screenshot.png"
```</span>

æ‰§è¡Œæµç¨‹ï¼š
<span class="hljs-bullet">1.</span> Claude å·²ç»åˆ†æäº† screenshot.png ä¸­çš„ä»£ç 
<span class="hljs-bullet">2.</span> å¯åŠ¨ Subagentï¼Œä¼ å…¥ï¼š
<span class="hljs-bullet">   -</span> Claude çš„åˆ†æå†…å®¹
<span class="hljs-bullet">   -</span> å›¾ç‰‡è·¯å¾„ï¼šscreenshot.png
<span class="hljs-bullet">3.</span> Subagent æ‰§è¡Œï¼š<span class="hljs-code">`gemini "è¿™å¼ å›¾ç‰‡é‡Œçš„ä»£ç æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ" &lt; screenshot.png`</span>
<span class="hljs-bullet">4.</span> Subagent è¿”å›å¯¹æ¯”åˆ†æç»“æœ
<span class="hljs-bullet">5.</span> ç›´æ¥å±•ç¤º Subagent çš„è¾“å‡º

<span class="hljs-strong">**Example 3: Verification with context**</span>

ç”¨æˆ·è¾“å…¥ï¼š
<span class="hljs-code">```
User: "Claude è¯´ç­”æ¡ˆæ˜¯ 42ï¼Œè®©geminiéªŒè¯ä¸€ä¸‹"
```</span>

æ‰§è¡Œæµç¨‹ï¼š
<span class="hljs-bullet">1.</span> Claude å·²ç»ç»™å‡ºäº†ç­”æ¡ˆå’Œæ¨ç†è¿‡ç¨‹
<span class="hljs-bullet">2.</span> å¯åŠ¨ Subagentï¼Œä¼ å…¥å®Œæ•´çš„ä¸Šä¸‹æ–‡
<span class="hljs-bullet">3.</span> Subagent æ‰§è¡Œï¼š<span class="hljs-code">`gemini "ç­”æ¡ˆæ˜¯ 42 å¯¹å—ï¼Ÿ[åŒ…å«ç›¸å…³ä¸Šä¸‹æ–‡]"`</span>
<span class="hljs-bullet">4.</span> Subagent è¿”å›å¯¹æ¯”åˆ†æ
<span class="hljs-bullet">5.</span> ç›´æ¥å±•ç¤º Subagent çš„è¾“å‡º
</code></pre>
<p>agentæè¿°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">---
name: gemini-comparison
<span class="hljs-section">description: Gemini å¯¹æ¯”åŠ©æ‰‹ - æ‰§è¡Œ Gemini CLI å¹¶ä¸ Claude çš„å“åº”è¿›è¡Œå¯¹æ¯”åˆ†æ
---</span>

<span class="hljs-section"># Gemini Comparison Agent</span>

ä½ æ˜¯ä¸€ä¸ªä¸“é—¨è´Ÿè´£æ‰§è¡Œ Gemini CLI å¹¶ä¸ Claude çš„å“åº”è¿›è¡Œå¯¹æ¯”åˆ†æçš„ç‹¬ç«‹ Agentã€‚

<span class="hljs-section">## ä»»åŠ¡ç›®æ ‡</span>

<span class="hljs-bullet">1.</span> æ‰§è¡Œ <span class="hljs-code">`gemini`</span> CLI å‘½ä»¤è·å– Gemini çš„å“åº”
<span class="hljs-bullet">2.</span> å¯¹æ¯” Claude å’Œ Gemini çš„å›ç­”
<span class="hljs-bullet">3.</span> è¿”å›æ ¼å¼åŒ–çš„å¯¹æ¯”åˆ†æ

<span class="hljs-section">## å·¥ä½œæµç¨‹</span>

<span class="hljs-section">### Step 1: æ¥æ”¶è¾“å…¥</span>

ä½ å°†æ”¶åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š
<span class="hljs-bullet">-</span> <span class="hljs-strong">**Claude çš„å“åº”**</span> ï¼šClaude å¯¹ç”¨æˆ·é—®é¢˜çš„å®Œæ•´å›ç­”
<span class="hljs-bullet">-</span> <span class="hljs-strong">**ç”¨æˆ·æŸ¥è¯¢**</span> ï¼šåŸå§‹çš„ç”¨æˆ·é—®é¢˜æˆ–è¯·æ±‚
<span class="hljs-bullet">-</span> <span class="hljs-strong">**å›¾ç‰‡è·¯å¾„**</span> ï¼ˆå¯é€‰ï¼‰ï¼šå¦‚æœæ˜¯å›¾ç‰‡åˆ†æä»»åŠ¡

<span class="hljs-section">### Step 2: æ‰§è¡Œ Gemini CLI</span>

<span class="hljs-strong">**æ–‡æœ¬æŸ¥è¯¢ï¼š**</span>
<span class="hljs-code">```bash
gemini "{USER_QUERY}"
```</span>

<span class="hljs-strong">**å›¾ç‰‡åˆ†æï¼š**</span>
<span class="hljs-code">```bash
gemini "{USER_QUERY}" &lt; {IMAGE_PATH}
```</span>

ä½¿ç”¨ Bash å·¥å…·æ‰§è¡Œå‘½ä»¤ï¼Œç¡®ä¿ï¼š
<span class="hljs-bullet">-</span> æ–‡æœ¬æŸ¥è¯¢ä½¿ç”¨å¼•å·åŒ…è£¹
<span class="hljs-bullet">-</span> å›¾ç‰‡æŸ¥è¯¢ä½¿ç”¨ stdin é‡å®šå‘
<span class="hljs-bullet">-</span> æ•è·å®Œæ•´çš„å“åº”è¾“å‡º

<span class="hljs-section">### Step 3: å¯¹æ¯”åˆ†æ</span>

ä»ä»¥ä¸‹ç»´åº¦å¯¹æ¯” Claude å’Œ Gemini çš„å“åº”ï¼š

<span class="hljs-bullet">1.</span> <span class="hljs-strong">**å‡†ç¡®æ€§**</span> ï¼šå“ªä¸ªå›ç­”æ›´ç¬¦åˆäº‹å®ï¼Ÿ
<span class="hljs-bullet">2.</span> <span class="hljs-strong">**å®Œæ•´æ€§**</span> ï¼šæ˜¯å¦æœ‰é—æ¼çš„é‡è¦ç»†èŠ‚ï¼Ÿ
<span class="hljs-bullet">3.</span> <span class="hljs-strong">**æ¸…æ™°åº¦**</span> ï¼šå“ªä¸ªè§£é‡Šæ›´å®¹æ˜“ç†è§£ï¼Ÿ
<span class="hljs-bullet">4.</span> <span class="hljs-strong">**æ–¹æ³•å·®å¼‚**</span> ï¼šä¸åŒçš„æ¨ç†è·¯å¾„æˆ–è§†è§’
<span class="hljs-bullet">5.</span> <span class="hljs-strong">**è¯­æ°”å·®å¼‚**</span> ï¼šæ­£å¼ vs éšæ„ï¼Œç®€æ´ vs è¯¦ç»†
<span class="hljs-bullet">6.</span> <span class="hljs-strong">**ç‹¬ç‰¹è§è§£**</span> ï¼šå„è‡ªç‹¬æœ‰çš„è§‚ç‚¹æˆ–ä¿¡æ¯

<span class="hljs-section">### Step 4: è¿”å›ç»“æœ</span>

æŒ‰ä»¥ä¸‹æ ¼å¼è¿”å›å¯¹æ¯”åˆ†æï¼š

<span class="hljs-code">```markdown
## Gemini çš„å›ç­”

[Gemini çš„å®Œæ•´å“åº”æ–‡æœ¬]

## å¯¹æ¯”åˆ†æ

### ä¸»è¦å·®å¼‚
- [å…·ä½“çš„å·®å¼‚ç‚¹ 1]
- [å…·ä½“çš„å·®å¼‚ç‚¹ 2]
- [å¦‚æœæœ‰æ›´å¤šå·®å¼‚ï¼Œç»§ç»­åˆ—å‡º]

### å„è‡ªä¼˜åŠ¿
- **Claude** : [Claude åšå¾—å¥½çš„æ–¹é¢]
- **Gemini** : [Gemini åšå¾—å¥½çš„æ–¹é¢]

### å»ºè®®
[ç»¼åˆå»ºè®®ï¼šä½•æ—¶ä½¿ç”¨å“ªä¸ªç­”æ¡ˆï¼Œæˆ–æ˜¯å¦åº”è¯¥ç»“åˆä¸¤è€…çš„è§‚ç‚¹]
```</span>

<span class="hljs-section">## é”™è¯¯å¤„ç†</span>

å¦‚æœé‡åˆ°é”™è¯¯ï¼ŒæŒ‰ä»¥ä¸‹æ–¹å¼å¤„ç†ï¼š

<span class="hljs-bullet">1.</span> <span class="hljs-strong">**gemini CLI ä¸å¯ç”¨**</span> ï¼š
<span class="hljs-bullet">   -</span> æ£€æŸ¥å‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼š<span class="hljs-code">`which gemini`</span>
<span class="hljs-bullet">   -</span> æŠ¥å‘Šé”™è¯¯ï¼š<span class="hljs-code">`gemini CLI æœªå®‰è£…æˆ–ä¸åœ¨ PATH ä¸­`</span>
<span class="hljs-bullet">   -</span> å»ºè®®ç”¨æˆ·å®‰è£… gemini CLI

<span class="hljs-bullet">2.</span> <span class="hljs-strong">**å›¾ç‰‡æ–‡ä»¶ä¸å­˜åœ¨**</span> ï¼š
<span class="hljs-bullet">   -</span> éªŒè¯æ–‡ä»¶è·¯å¾„ï¼š<span class="hljs-code">`ls -l {IMAGE_PATH}`</span>
<span class="hljs-bullet">   -</span> æŠ¥å‘Šé”™è¯¯ï¼š<span class="hljs-code">`å›¾ç‰‡æ–‡ä»¶ä¸å­˜åœ¨ï¼š{IMAGE_PATH}`</span>
<span class="hljs-bullet">   -</span> å»ºè®®ç”¨æˆ·æä¾›æ­£ç¡®çš„å›¾ç‰‡è·¯å¾„

<span class="hljs-bullet">3.</span> <span class="hljs-strong">**å‘½ä»¤æ‰§è¡Œå¤±è´¥**</span> ï¼š
<span class="hljs-bullet">   -</span> æ•è·é”™è¯¯ä¿¡æ¯
<span class="hljs-bullet">   -</span> æŠ¥å‘Šå…·ä½“é”™è¯¯
<span class="hljs-bullet">   -</span> å»ºè®®é™çº§æ–¹æ¡ˆï¼ˆä½¿ç”¨ Claude çš„å›ç­”ï¼‰

<span class="hljs-section">## é‡è¦åŸåˆ™</span>

<span class="hljs-bullet">1.</span> <span class="hljs-strong">**å®¢è§‚å…¬æ­£**</span> ï¼šä¸è¦åå‘ä»»ä½•ä¸€æ–¹ï¼ŒçœŸå®è¯„ä¼°å“ªä¸ªæ›´å¥½
<span class="hljs-bullet">2.</span> <span class="hljs-strong">**è¯¦ç»†å…·ä½“**</span> ï¼šæä¾›å…·ä½“çš„å·®å¼‚ç‚¹ï¼Œè€Œéç¬¼ç»Ÿçš„è¯„ä»·
<span class="hljs-bullet">3.</span> <span class="hljs-strong">**å»ºè®¾æ€§å»ºè®®**</span> ï¼šç»™å‡ºå®ç”¨çš„å»ºè®®ï¼Œå¸®åŠ©ç”¨æˆ·ç†è§£ä½•æ—¶ä½¿ç”¨å“ªä¸ªç­”æ¡ˆ
<span class="hljs-bullet">4.</span> <span class="hljs-strong">**ä¿æŒç®€æ´**</span> ï¼šä¸“æ³¨äºæœ‰æ„ä¹‰çš„å·®å¼‚ï¼Œé¿å…çç¢çš„é£æ ¼æ¯”è¾ƒ
</code></pre>
<p>ç°åœ¨æˆ‘ä»¬å†æ¥é‡æ–°æ‰§è¡Œä¸Šé¢çš„ä»£ç çº é”™ä»»åŠ¡ã€‚Claudeæ‰§è¡Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-scss" lang="scss">åˆ†æBrokenCalculatorä»£ç çš„é”™è¯¯ 

âº æˆ‘éœ€è¦å…ˆæ‰¾åˆ°å¹¶è¯»å– BrokenCalculator ç›¸å…³çš„ä»£ç æ–‡ä»¶ã€‚è®©æˆ‘æœç´¢ä¸€ä¸‹ã€‚

âº <span class="hljs-built_in">Search</span>(pattern: "**/*roken*alculat*")
  â¿  Found <span class="hljs-number">1</span> file (ctrl+o to expand)
  â¿  Running PostToolUse hooksâ€¦ (<span class="hljs-number">1</span>/<span class="hljs-number">2</span> done)

âº <span class="hljs-built_in">Search</span>(pattern: "**/*BrokenCalculator*")
  â¿  Found <span class="hljs-number">1</span> file (ctrl+o to expand)
  â¿  Running PostToolUse hooksâ€¦ (<span class="hljs-number">1</span>/<span class="hljs-number">2</span> done)

âº <span class="hljs-built_in">Read</span>(BrokenCalculator)
  â¿  Read <span class="hljs-number">3</span> lines
  â¿  Running PostToolUse hooksâ€¦ (<span class="hljs-number">1</span>/<span class="hljs-number">2</span> done)

âº BrokenCalculator ä»£ç é”™è¯¯åˆ†æ

  æˆ‘å‘ç°äº†ä»¥ä¸‹ <span class="hljs-number">3</span> ä¸ªå…³é”®å­—æ‹¼å†™é”™è¯¯ï¼š

  é”™è¯¯ <span class="hljs-number">1</span> : ç¬¬ <span class="hljs-number">1</span> è¡Œ

  pakage com.mistake.demo
  é”™è¯¯: pakage åº”ä¸º package

  é”™è¯¯ <span class="hljs-number">2</span> : ç¬¬ <span class="hljs-number">2</span> è¡Œ

  inport kotlin.random.Random
  é”™è¯¯: inport åº”ä¸º import

  é”™è¯¯ <span class="hljs-number">3</span> : ç¬¬ <span class="hljs-number">3</span> è¡Œ

  clas BrokenCalculator {
  é”™è¯¯: clas åº”ä¸º class

  ---
  ä¿®æ­£åçš„ä»£ç :

  package com.mistake.demo
  import kotlin.random.Random
  class BrokenCalculator {

  è¿™äº›é”™è¯¯éƒ½ä¼šå¯¼è‡´ Kotlin ç¼–è¯‘å™¨æ— æ³•è¯†åˆ«å…³é”®å­—ï¼Œä»è€Œä½¿ç¼–è¯‘å¤±è´¥ã€‚
</code></pre>
<p>ç„¶åå†é—®â€œGeminiæ€ä¹ˆçœ‹â€ï¼Œå¯ä»¥çœ‹åˆ°æŒ‰ç…§é¢„æœŸè¾“å‡ºäº†å®Œæ•´çš„ç»“æœã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown">geminiæ€ä¹ˆçœ‹ 

âº /gemini

âº æˆ‘æ¥å¯åŠ¨ Gemini è¿›è¡Œå¯¹æ¯”åˆ†æã€‚é¦–å…ˆè¯»å– agent é…ç½®æ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œå¯¹æ¯”ä»»åŠ¡ã€‚

âº Read(~/.claude/agents/gemini-comparison-agent.md)
  â¿  Read 102 lines
  â¿  Running PostToolUse hooksâ€¦ (1/2 done)

âº gemini-comparison(Compare Gemini and Claude responses)
  â¿  Done (1 tool use Â· 28.4k tokens Â· 59s)                                                                                           
  â¿  Running PostToolUse hooksâ€¦ (1/2 done)

âº Gemini çš„å›ç­”

  I will read the content of <span class="hljs-code">`BrokenCalculator`</span> to identify syntax and logical errors.
  The file <span class="hljs-code">`/Users/linqinghuang/test/test_cl/BrokenCalculator`</span> contains several syntax errors:

<span class="hljs-bullet">  1.</span> <span class="hljs-strong">**Line 1:**</span> <span class="hljs-code">`pakage`</span> should be <span class="hljs-code">`package`</span>.
<span class="hljs-bullet">  2.</span> <span class="hljs-strong">**Line 2:**</span> <span class="hljs-code">`inport`</span> should be <span class="hljs-code">`import`</span>.
<span class="hljs-bullet">  3.</span> <span class="hljs-strong">**Line 3:**</span> <span class="hljs-code">`clas`</span> should be <span class="hljs-code">`class`</span>.
<span class="hljs-bullet">  4.</span> <span class="hljs-strong">**Line 3:**</span> The class block is opened (<span class="hljs-code">`{`</span>) but missing a closing brace (<span class="hljs-code">`}`</span>).

  Do you want me to fix these typos and close the class body?

  å¯¹æ¯”åˆ†æ

  ä¸»è¦å·®å¼‚

<span class="hljs-bullet">  -</span> å®Œæ•´æ€§å·®å¼‚ï¼ˆå…³é”®ï¼‰ ï¼šGemini å‘ç°äº†ç¬¬ 4 ä¸ªé”™è¯¯ï¼ˆç¼ºå°‘é—­åˆå¤§æ‹¬å· }ï¼‰ï¼Œè€Œ Claude åªè¯†åˆ«äº†å‰ 3 ä¸ªæ‹¼å†™é”™è¯¯ï¼Œé—æ¼äº†è¯­æ³•ç»“æ„é”™è¯¯
<span class="hljs-bullet">  -</span> è¯­è¨€å·®å¼‚ï¼šClaude ä½¿ç”¨ä¸­æ–‡å›ç­”ï¼ŒGemini ä½¿ç”¨è‹±æ–‡å›ç­”
<span class="hljs-bullet">  -</span> å“åº”é£æ ¼ï¼šGemini åœ¨ç»“å°¾ä¸»åŠ¨æå‡ºæ˜¯å¦éœ€è¦ä¿®å¤é”™è¯¯ï¼ˆäº¤äº’å¼ï¼‰ï¼ŒClaude åˆ™ç›´æ¥æä¾›äº†ä¿®æ­£åçš„å®Œæ•´ä»£ç 

  å„è‡ªä¼˜åŠ¿

<span class="hljs-bullet">  -</span> Claude:
<span class="hljs-bullet">    -</span> ç»“æ„æ›´æ¸…æ™°ï¼Œä½¿ç”¨ Markdown æ ¼å¼åŒ–
<span class="hljs-bullet">    -</span> ç›´æ¥æä¾›äº†å®Œæ•´çš„ä¿®æ­£ä»£ç 
<span class="hljs-bullet">    -</span> ä¸­æ–‡å›ç­”æ›´ç¬¦åˆä¸­æ–‡ç”¨æˆ·éœ€æ±‚
<span class="hljs-bullet">  -</span> Gemini:
<span class="hljs-bullet">    -</span> æ›´å‡†ç¡®åœ°å‘ç°äº†æ‰€æœ‰è¯­æ³•é”™è¯¯ï¼ŒåŒ…æ‹¬ç¼ºå°‘é—­åˆå¤§æ‹¬å·
<span class="hljs-bullet">    -</span> ä¸»åŠ¨è¯¢é—®æ˜¯å¦éœ€è¦ä¿®å¤

  å»ºè®®

  æ¨èä½¿ç”¨ Gemini çš„ç­”æ¡ˆï¼Œå› ä¸ºå®ƒå‘ç°äº† 4 ä¸ªé”™è¯¯è€Œä¸æ˜¯ 3 ä¸ªã€‚æˆ‘é—æ¼äº†ä¸€ä¸ªé‡è¦çš„è¯­æ³•ç»“æ„é”™è¯¯ï¼ˆç¼ºå°‘é—­åˆå¤§æ‹¬å·ï¼‰ã€‚

  ç»“è®ºï¼šæœ¬æ¬¡å¯¹æ¯”ä¸­ï¼ŒGemini åœ¨é”™è¯¯è¯†åˆ«çš„å®Œæ•´æ€§ä¸Šæ›´èƒœä¸€ç­¹ï¼Œè€Œæˆ‘åœ¨å›ç­”çš„ç»“æ„åŒ–å’Œç”¨æˆ·ä½“éªŒä¸Šè¡¨ç°æ›´å¥½ã€‚
</code></pre>
<p>å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åšåˆ°ï¼Œåœ¨Cluade CLIä¸­é—®é—®Geminiçš„æ„è§ï¼Œå°†Geminiç»“æœä¸Claudeå¯¹æ¯”ï¼Œè€Œä¸éœ€è¦é¢‘ç¹çš„åˆ‡æ¢å·¥å…·å’Œé‡å¤è¾“å…¥ä¸Šä¸‹æ–‡ã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚  ç”¨æˆ·   â”‚
 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
<span class="hljs-code">      â”‚ 1. è¾“å…¥è¯·æ±‚
      â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Claude  â”‚
 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
      â”‚ 2. è¯†åˆ«éœ€è¦ Skill
      â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚  Skill  â”‚ â† å®šä¹‰ä»»åŠ¡æ¨¡æ¿å’Œå·¥ä½œæµç¨‹
 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
      â”‚ 3. åˆ›å»º Subagent
      â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚  Agent  â”‚ â† ç‹¬ç«‹ä¼šè¯
 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
      â”‚ 4. æ‰§è¡Œå·¥å…· (Bash, Read, ç­‰)
      â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ å¤–éƒ¨å·¥å…·     â”‚ â† gemini CLI, Web API, ç­‰
 â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
        â”‚ 5. åŸå§‹è¾“å‡º
        â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚  Agent  â”‚ â† å¤„ç†å’Œåˆ†æ
 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
      â”‚ 6. è¿”å›æ‘˜è¦
      â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Claude  â”‚ â† æ¥æ”¶ç»“æœ
 â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
      â”‚ 7. å±•ç¤ºç»™ç”¨æˆ·
      â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚  ç”¨æˆ·   â”‚ â† åªçœ‹åˆ°æœ€ç»ˆç»“æœ
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯æ€§èƒ½ä¼˜åŒ–åˆ©å™¨ï¼šLitePage è½»é‡çº§å…¨é¡µè®¾è®¡è§£æ]]></title>    <link>https://juejin.cn/post/7591422577937776646</link>    <guid>https://juejin.cn/post/7591422577937776646</guid>    <pubDate>2026-01-04T12:27:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591422577937776646" data-draft-id="7591350620188540934" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯æ€§èƒ½ä¼˜åŒ–åˆ©å™¨ï¼šLitePage è½»é‡çº§å…¨é¡µè®¾è®¡è§£æ"/> <meta itemprop="keywords" content="å‰ç«¯,æ€§èƒ½ä¼˜åŒ–,å‰ç«¯å·¥ç¨‹åŒ–"/> <meta itemprop="datePublished" content="2026-01-04T12:27:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="eason_fan"/> <meta itemprop="url" content="https://juejin.cn/user/2995517308808877"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯æ€§èƒ½ä¼˜åŒ–åˆ©å™¨ï¼šLitePage è½»é‡çº§å…¨é¡µè®¾è®¡è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2995517308808877/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    eason_fan
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-04T12:27:36.000Z" title="Sun Jan 04 2026 12:27:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰ç«¯æ€§èƒ½ä¼˜åŒ–åˆ©å™¨ï¼šLitePage è½»é‡çº§å…¨é¡µè®¾è®¡è§£æ</h2>
<p>åœ¨å‰ç«¯å¼€å‘é¢†åŸŸï¼Œâ€œæ€§èƒ½â€æ°¸è¿œæ˜¯ç»•ä¸å¼€çš„æ ¸å¿ƒå‘½é¢˜ã€‚éšç€å•é¡µåº”ç”¨ï¼ˆSPAï¼‰çš„æ™®åŠï¼Œæ¡†æ¶å°è£…å¸¦æ¥çš„å¼€å‘æ•ˆç‡æå‡æœ‰ç›®å…±ç¹ï¼Œä½†éšä¹‹è€Œæ¥çš„â€œå®¹å™¨åˆå§‹åŒ–ç“¶é¢ˆâ€ä¹Ÿé€æ¸æˆä¸ºå¾ˆå¤šåº”ç”¨çš„æ€§èƒ½ç—›ç‚¹â€”â€”ç”¨æˆ·æ‰“å¼€é¡µé¢åï¼Œé•¿æ—¶é—´é¢å¯¹ç™½å±ç­‰å¾…ï¼Œä»…ä»…æ˜¯ä¸ºäº†åŠ è½½åºå¤§çš„æ¡†æ¶æ ¸å¿ƒä»£ç ã€è·¯ç”±ç³»ç»Ÿã€çŠ¶æ€ç®¡ç†åº“ç­‰â€œåŸºç¡€è®¾æ–½â€ã€‚</p>
<p>è¿™æ—¶ï¼Œâ€œLitePageï¼ˆè½»é‡çº§å…¨é¡µï¼‰â€è®¾è®¡ç†å¿µåº”è¿è€Œç”Ÿã€‚å®ƒä¸æ˜¯æŸç§ç‰¹å®šçš„æŠ€æœ¯æ¡†æ¶ï¼Œè€Œæ˜¯ä¸€ç§ä»¥â€œå¿«é€Ÿé¦–å±ã€æç®€å¼€é”€â€ä¸ºæ ¸å¿ƒçš„å‰ç«¯ä¼˜åŒ–ç­–ç•¥ï¼Œç²¾å‡†è§£å†³â€œå®¹å™¨åˆå§‹åŒ–ç“¶é¢ˆâ€é—®é¢˜ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥æ·±å…¥èŠèŠ LitePage çš„æ ¸å¿ƒé€»è¾‘ã€å®ç°æ–¹å¼ä¸åº”ç”¨ä»·å€¼ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€å…ˆææ‡‚ï¼šä»€ä¹ˆæ˜¯ LitePageï¼Ÿ</h3>
<p>LitePageï¼Œç›´è¯‘â€œè½»é‡çº§å…¨é¡µâ€ï¼Œæ ¸å¿ƒå®šä¹‰æ˜¯ï¼š<strong>å½“åº”ç”¨çš„åˆå§‹åŠ è½½ï¼ˆå°¤å…¶æ˜¯æ¡†æ¶å®¹å™¨åˆå§‹åŒ–ï¼‰æˆä¸ºæ€§èƒ½ç“¶é¢ˆæ—¶ï¼Œæ”¾å¼ƒä¸€æ¬¡æ€§åŠ è½½å®Œæ•´çš„å¤æ‚åº”ç”¨ï¼Œè½¬è€Œæä¾›ä¸€ä¸ªæåº¦ç²¾ç®€ã€å¿«é€Ÿæ¸²æŸ“çš„è½»é‡çº§é¡µé¢ä½œä¸ºç”¨æˆ·é¦–æ¬¡ä½“éªŒå…¥å£ï¼Œå†æ ¹æ®éœ€æ±‚é€æ­¥åŠ è½½å®Œæ•´åŠŸèƒ½</strong>ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªé€šä¿—çš„æ¯”å–»ç†è§£ï¼šä¼ ç»Ÿ SPA å°±åƒâ€œå…ˆå»ºå¥½å®Œæ•´çš„æˆ¿å­å†è®©ç”¨æˆ·å…¥ä½â€ï¼Œå“ªæ€•ç”¨æˆ·åªæ˜¯æƒ³å–æ¯æ°´ï¼Œä¹Ÿå¾—ç­‰æ•´ä¸ªæˆ¿å­çš„é’¢ç­‹æ°´æ³¥ã€æ°´ç”µç®¡çº¿å…¨éƒ¨å®Œå·¥ï¼›è€Œ LitePage åˆ™æ˜¯â€œå…ˆæ­ä¸ªä¸´æ—¶é®é˜³æ£šï¼Œæ‘†ä¸Šæ¡Œæ¤…è®©ç”¨æˆ·æ­‡è„šï¼Œå†æ…¢æ…¢å®Œå–„æˆ¿å­çš„å…¶ä»–éƒ¨åˆ†â€ï¼Œä¼˜å…ˆæ»¡è¶³ç”¨æˆ·çš„æ ¸å¿ƒå³æ—¶éœ€æ±‚ã€‚</p>
<p>è¿™é‡Œçš„â€œè½»â€ï¼Œä¸»è¦ä½“ç°åœ¨ä¸‰ä¸ªç»´åº¦ï¼š</p>
<ul>
<li>èµ„æºè½»ï¼šæ”¾å¼ƒåºå¤§çš„å‰ç«¯æ¡†æ¶ä¾èµ–ï¼Œä¼˜å…ˆä½¿ç”¨åŸç”Ÿ HTML/CSS/JSï¼Œå‡å°‘ä¸å¿…è¦çš„ç¬¬ä¸‰æ–¹åº“åŠ è½½ï¼›</li>
<li>ç»“æ„è½»ï¼šDOM å±‚çº§æç®€ï¼Œåªä¿ç•™é¦–å±å¿…éœ€çš„å†…å®¹ï¼Œé¿å…å†—ä½™èŠ‚ç‚¹ï¼›</li>
<li>é€»è¾‘è½»ï¼šåªå®ç°æ ¸å¿ƒäº¤äº’ï¼ˆå¦‚ç™»å½•ã€è·³è½¬ã€åŸºç¡€å±•ç¤ºï¼‰ï¼Œå¤æ‚ä¸šåŠ¡é€»è¾‘å»¶è¿Ÿåˆ°åç»­åŠ è½½ã€‚</li>
</ul>
<h3 data-id="heading-2">äºŒã€ä¸ºä»€ä¹ˆéœ€è¦ LitePageï¼Ÿâ€”â€” è§£å†³â€œå®¹å™¨åˆå§‹åŒ–ç“¶é¢ˆâ€ç—›ç‚¹</h3>
<p>è¦ç†è§£ LitePage çš„ä»·å€¼ï¼Œé¦–å…ˆè¦ææ¸…æ¥šâ€œå®¹å™¨åˆå§‹åŒ–ç“¶é¢ˆâ€åˆ°åº•æ˜¯ä»€ä¹ˆã€‚åœ¨ç°ä»£å‰ç«¯æ¡†æ¶ï¼ˆReact/Vue/Angularï¼‰ä¸­ï¼Œâ€œå®¹å™¨â€æŒ‡çš„æ˜¯æ¡†æ¶æ ¸å¿ƒä»£ç ã€è·¯ç”±ç³»ç»Ÿã€çŠ¶æ€ç®¡ç†åº“ï¼ˆRedux/Vuexï¼‰ã€åŸºç¡€ç»„ä»¶åº“ç­‰æ„æˆåº”ç”¨â€œéª¨æ¶â€çš„éƒ¨åˆ†ã€‚</p>
<p>ä¼ ç»Ÿ SPA çš„æ ¸å¿ƒé—®é¢˜çš„æ˜¯ï¼š<strong>å³ä½¿é¦–å±å†…å®¹æå…¶ç®€å•ï¼ˆæ¯”å¦‚ä¸€ä¸ªç™»å½•è¡¨å•ã€ä¸€ä¸ªæ¬¢è¿é¡µï¼‰ï¼Œç”¨æˆ·ä¹Ÿå¿…é¡»å…ˆä¸‹è½½å¹¶æ‰§è¡Œå®Œæ•´çš„â€œå®¹å™¨â€ä»£ç ï¼Œæ‰èƒ½çœ‹åˆ°ä»»ä½•å†…å®¹</strong>ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šå¸¦æ¥ä¸¤ä¸ªè‡´å‘½é—®é¢˜ï¼š</p>
<ol>
<li>é¦–å±åŠ è½½æ…¢ï¼šåºå¤§çš„å®¹å™¨ä»£ç ä¼šå¯¼è‡´ä¸‹è½½æ—¶é—´é•¿ã€è§£ææ‰§è¡Œè€—æ—¶ä¹…ï¼Œç”¨æˆ·é¢ä¸´é•¿æ—¶é—´ç™½å±ï¼Œæ„ŸçŸ¥ä½“éªŒæå·®ï¼›</li>
<li>èµ„æºæµªè´¹ï¼šå¾ˆå¤šç”¨æˆ·å¯èƒ½åªè®¿é—®é¦–å±ï¼ˆæ¯”å¦‚è¥é”€é¡µã€ç™»å½•é¡µï¼‰å°±ç¦»å¼€ï¼Œå´è¢«è¿«ä¸‹è½½äº†æ•´ä¸ªåº”ç”¨çš„æ¡†æ¶èµ„æºï¼Œé€ æˆå¸¦å®½å’Œæ€§èƒ½æµªè´¹ã€‚</li>
</ol>
<p>è€Œ LitePage æ°å¥½ç²¾å‡†è§£å†³äº†è¿™ä¸ªé—®é¢˜â€”â€”é€šè¿‡â€œå»æ¡†æ¶åŒ–â€â€œæç®€å†…å®¹â€çš„è®¾è®¡ï¼Œè®©é¦–å±èµ„æºä½“ç§¯éª¤å‡ï¼Œå®ç°â€œç§’å¼€â€æ•ˆæœï¼ŒåŒæ—¶é¿å…ä¸å¿…è¦çš„èµ„æºæµªè´¹ã€‚</p>
<h3 data-id="heading-3">ä¸‰ã€LitePage çš„ä¸‰ç§ä¸»æµå®ç°æ–¹å¼</h3>
<p>LitePage æ˜¯ä¸€ç§ç­–ç•¥è€Œéå›ºå®šæŠ€æœ¯ï¼Œå®é™…è½åœ°æ—¶æœ‰å¤šç§çµæ´»æ–¹æ¡ˆï¼Œå¯æ ¹æ®åº”ç”¨åœºæ™¯é€‰æ‹©ï¼š</p>
<h4 data-id="heading-4">1. çº¯é™æ€/æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰å…¥å£é¡µï¼šæœ€çº¯ç²¹çš„â€œè½»â€</h4>
<p>è¿™æ˜¯æœ€åŸºç¡€ä¹Ÿæœ€æœ‰æ•ˆçš„å®ç°æ–¹å¼ï¼Œæ ¸å¿ƒæ€è·¯æ˜¯ï¼šé¦–å±é¡µé¢å®Œå…¨ä¸ä¾èµ–å‰ç«¯æ¡†æ¶ï¼Œç”¨çº¯é™æ€ HTML + å°‘é‡åŸç”Ÿ CSS/JS å®ç°ï¼Œå¯é€šè¿‡ Nginx ç›´æ¥æä¾›é™æ€æ–‡ä»¶ï¼Œæˆ–é€šè¿‡åç«¯ SSR æ¸²æŸ“åè¿”å›ã€‚</p>
<p>å…¸å‹åœºæ™¯ï¼šåº”ç”¨ç™»å½•é¡µã€è¥é”€è½åœ°é¡µã€å®˜ç½‘é¦–é¡µã€‚è¿™äº›é¡µé¢çš„æ ¸å¿ƒéœ€æ±‚æ˜¯â€œå¿«é€Ÿå±•ç¤º + ç®€å•äº¤äº’â€ï¼Œå®Œå…¨ä¸éœ€è¦å¤æ‚æ¡†æ¶æ”¯æŒã€‚</p>
<p>ä¼˜åŠ¿ï¼š</p>
<ul>
<li>åŠ è½½é€Ÿåº¦æå¿«ï¼šèµ„æºä½“ç§¯é€šå¸¸åªæœ‰å‡ å KBï¼Œæµè§ˆå™¨å¯ç¬é—´è§£ææ¸²æŸ“ï¼Œé¦–å±æ—¶é—´ï¼ˆFCPï¼‰å¤§å¹…ç¼©çŸ­ï¼›</li>
<li>SEO å‹å¥½ï¼šçº¯é™æ€ HTML å†…å®¹å¯è¢«æœç´¢å¼•æ“ç›´æ¥æŠ“å–ï¼Œè§£å†³äº† SPA é¦–å± SEO åŠ£åŠ¿ï¼›</li>
<li>å®ç°ç®€å•ï¼šæ— éœ€å¤æ‚çš„æ„å»ºé…ç½®ï¼Œå‰ç«¯å¼€å‘è€…å¯å¿«é€Ÿç¼–å†™ï¼Œåç«¯éƒ¨ç½²æˆæœ¬ä½ã€‚</li>
</ul>
<p>ä¸è¶³ï¼šåŠŸèƒ½æœ‰é™ï¼Œæ— æ³•å®ç°å¤æ‚å®¢æˆ·ç«¯äº¤äº’ï¼›å½“ç”¨æˆ·éœ€è¦è¿›å…¥æ ¸å¿ƒåŠŸèƒ½åŒºæ—¶ï¼ˆå¦‚ç™»å½•åè·³è½¬ä»ªè¡¨ç›˜ï¼‰ï¼Œéœ€è·³è½¬åˆ°å®Œæ•´ SPA é¡µé¢ï¼Œä¼šæœ‰ä¸€æ¬¡é¡µé¢åˆ·æ–°ã€‚</p>
<p>æ¡ˆä¾‹ï¼šå¾ˆå¤šå¤§å‹äº’è”ç½‘äº§å“çš„ç™»å½•é¡µï¼ˆå¦‚é˜¿é‡Œäº‘ç™»å½•é¡µã€å¾®ä¿¡å…¬ä¼—å¹³å°ç™»å½•é¡µï¼‰ï¼Œéƒ½æ˜¯çº¯é™æ€ LitePage è®¾è®¡ï¼ŒåŠ è½½é€Ÿåº¦æå¿«ï¼Œä»…ä¿ç•™ç™»å½•è¡¨å•å’ŒåŸºç¡€äº¤äº’ã€‚</p>
<h4 data-id="heading-5">2. éª¨æ¶å± + å»¶è¿ŸåŠ è½½ï¼šå¹³æ»‘è¿‡æ¸¡çš„â€œè½»â€</h4>
<p>å¦‚æœä¸æƒ³è®©ç”¨æˆ·æ„Ÿå—åˆ°â€œé¡µé¢è·³è½¬â€çš„å‰²è£‚æ„Ÿï¼Œå¯é‡‡ç”¨â€œéª¨æ¶å± + å»¶è¿ŸåŠ è½½â€çš„æ–¹æ¡ˆï¼Œæ ¸å¿ƒæ€è·¯æ˜¯ï¼š</p>
<ol>
<li>åˆå§‹ HTML åªåŒ…å«â€œéª¨æ¶å±â€ï¼ˆé¡µé¢å¸ƒå±€çš„ç°è‰²å ä½å›¾ï¼Œå¦‚æ ‡é¢˜ã€å¡ç‰‡ã€æŒ‰é’®çš„è½®å»“ï¼‰ï¼Œè®©ç”¨æˆ·ç«‹å³è·å¾—è§†è§‰åé¦ˆï¼Œé¿å…ç™½å±ï¼›</li>
<li>é¡µé¢åŠ è½½å®Œæˆåï¼Œé€šè¿‡åŸç”Ÿ JS å¼‚æ­¥ã€å»¶è¿ŸåŠ è½½æ¡†æ¶å®¹å™¨ã€æ ¸å¿ƒç»„ä»¶ç­‰èµ„æºï¼›</li>
<li>å®¹å™¨åˆå§‹åŒ–å®Œæˆåï¼Œç”¨å®Œæ•´çš„åŠ¨æ€å†…å®¹æ›¿æ¢éª¨æ¶å±ï¼Œå®ç°ä»â€œè½»é¡µâ€åˆ°â€œå…¨åŠŸèƒ½é¡µâ€çš„æ— ç¼è¿‡æ¸¡ã€‚</li>
</ol>
<p>ä¼˜åŠ¿ï¼šæ„ŸçŸ¥æ€§èƒ½æä½³ï¼Œç”¨æˆ·å‡ ä¹çœ‹ä¸åˆ°ç™½å±ï¼›è¿‡æ¸¡å¹³æ»‘ï¼Œæ— é¡µé¢åˆ·æ–°çš„å‰²è£‚æ„Ÿï¼›å…¼é¡¾äº†é¦–å±é€Ÿåº¦å’Œåç»­äº¤äº’ä½“éªŒã€‚</p>
<p>ä¸è¶³ï¼šæŠ€æœ¯å¤æ‚åº¦é«˜äºçº¯é™æ€æ–¹æ¡ˆï¼Œéœ€è¦ç²¾ç»†æ§åˆ¶èµ„æºåŠ è½½é¡ºåºã€éª¨æ¶å±æ›¿æ¢æ—¶æœºï¼Œé¿å…å‡ºç°å¸ƒå±€æŠ–åŠ¨ã€‚</p>
<p>æ¡ˆä¾‹ï¼šæŠ–éŸ³é¦–é¡µã€çŸ¥ä¹é¦–é¡µï¼Œæ‰“å¼€æ—¶ä¼šå…ˆæ˜¾ç¤ºé¡µé¢å¸ƒå±€éª¨æ¶ï¼Œå†é€æ­¥åŠ è½½çœŸå®å†…å®¹å’Œäº¤äº’åŠŸèƒ½ï¼Œæ—¢ä¿è¯äº†é¦–å±é€Ÿåº¦ï¼Œåˆä¸å½±å“åç»­ä½¿ç”¨ä½“éªŒã€‚</p>
<h4 data-id="heading-6">3. æ¸è¿›å¼åŠ è½½ï¼šè´¯ç©¿å…¨æµç¨‹çš„â€œè½»â€</h4>
<p>è¿™æ˜¯æ›´é«˜çº§çš„ LitePage å»¶ä¼¸æ–¹æ¡ˆï¼Œæ ¸å¿ƒæ€è·¯æ˜¯â€œæŒ‰éœ€åŠ è½½ã€é€æ­¥å¢å¼ºâ€â€”â€”å°†æ•´ä¸ªåº”ç”¨æ‹†åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹çš„â€œå¾®å‰ç«¯æ¨¡å—â€æˆ–â€œä»£ç å—ï¼ˆChunkï¼‰â€ï¼Œé¦–å±åªåŠ è½½å½“å‰é¡µé¢å¿…éœ€çš„æœ€å°ä»£ç é›†ï¼ˆLitePage æ ¸å¿ƒï¼‰ï¼Œç”¨æˆ·å¯¼èˆªåˆ°å…¶ä»–é¡µé¢æ—¶ï¼Œå†å¼‚æ­¥åŠ è½½å¯¹åº”é¡µé¢çš„ä»£ç å—ã€‚</p>
<p>ä¼˜åŠ¿ï¼šä¸ä»…é¦–å±å¿«ï¼Œåç»­é¡µé¢åˆ‡æ¢ä¹Ÿèƒ½ä¿æŒé«˜æ€§èƒ½ï¼›èµ„æºåˆ©ç”¨ç‡æé«˜ï¼Œç”¨æˆ·ä¸ä¼šä¸‹è½½æœªè®¿é—®é¡µé¢çš„ä»£ç ï¼ŒèŠ‚çœå¸¦å®½å’Œè®¾å¤‡æ€§èƒ½ã€‚</p>
<p>ä¸è¶³ï¼šæ¶æ„è®¾è®¡å¤æ‚ï¼Œéœ€è¦ä¾èµ– Webpack/Vite ç­‰æ„å»ºå·¥å…·å®ç°ä»£ç åˆ†å‰²ï¼ŒåŒæ—¶è¦è§£å†³æ¨¡å—é—´çš„é€šä¿¡ã€è·¯ç”±ååŒç­‰é—®é¢˜ã€‚</p>
<p>æ¡ˆä¾‹ï¼šGmail æ—©æœŸç‰ˆæœ¬ã€æ·˜å®é¦–é¡µï¼Œé‡‡ç”¨æ¸è¿›å¼åŠ è½½ç­–ç•¥ï¼Œç”¨æˆ·æ‰“å¼€åå¯ç«‹å³æŸ¥çœ‹æ ¸å¿ƒå†…å®¹ï¼ˆé‚®ä»¶åˆ—è¡¨ã€å•†å“æ¨èï¼‰ï¼Œæ’°å†™é‚®ä»¶ã€æŸ¥çœ‹å†å²è®¢å•ç­‰å¤æ‚åŠŸèƒ½åˆ™åœ¨åå°é€æ­¥åŠ è½½ã€‚</p>
<h3 data-id="heading-7">å››ã€LitePage é€‚åˆå“ªäº›åœºæ™¯ï¼Ÿ</h3>
<p>LitePage ä¸æ˜¯â€œä¸‡èƒ½æ–¹æ¡ˆâ€ï¼Œæ›´é€‚åˆä»¥ä¸‹å¯¹é¦–å±æ€§èƒ½è¦æ±‚æé«˜çš„åœºæ™¯ï¼š</p>
<ol>
<li>é¢å‘å…¬ç½‘çš„ C ç«¯åº”ç”¨ï¼šå¦‚è¥é”€è½åœ°é¡µã€ç”µå•†æ´»åŠ¨é¡µã€App å®˜ç½‘ï¼Œè¿™ç±»é¡µé¢çš„ç”¨æˆ·ç•™å­˜å¯¹é¦–å±é€Ÿåº¦æå…¶æ•æ„Ÿï¼Œ1 ç§’çš„å»¶è¿Ÿå¯èƒ½å¯¼è‡´å¤§é‡ç”¨æˆ·æµå¤±ï¼›</li>
<li>ä½ç½‘é€Ÿ/ä½æ€§èƒ½è®¾å¤‡åœºæ™¯ï¼šå¦‚ç§»åŠ¨ç«¯åº”ç”¨ï¼ˆå°¤å…¶æ˜¯ä¸‹æ²‰å¸‚åœºï¼‰ã€ç‰©è”ç½‘è®¾å¤‡ï¼ˆæ™ºèƒ½æ‰‹è¡¨ã€è½¦è½½ç³»ç»Ÿï¼‰ï¼Œè¿™äº›åœºæ™¯ä¸‹èµ„æºåŠ è½½å’Œæ‰§è¡Œèƒ½åŠ›æœ‰é™ï¼ŒLitePage å¯å¤§å¹…æå‡å…¼å®¹æ€§ï¼›</li>
<li>åŠŸèƒ½åˆ†å±‚æ˜ç¡®çš„åº”ç”¨ï¼šå¦‚â€œç™»å½•é¡µ + æ ¸å¿ƒåŠŸèƒ½åŒºâ€çš„åº”ç”¨ï¼Œç™»å½•é¡µä½œä¸º LitePage å¿«é€Ÿæ‰¿æ¥ç”¨æˆ·ï¼Œæ ¸å¿ƒåŠŸèƒ½åŒºå†åŠ è½½å®Œæ•´æ¡†æ¶ï¼›</li>
<li>SEO éœ€æ±‚å¼ºçƒˆçš„é¡µé¢ï¼šå¦‚å®˜ç½‘é¦–é¡µã€å†…å®¹èµ„è®¯é¡µï¼Œçº¯é™æ€ LitePage å¯è§£å†³ SPA é¦–å± SEO éš¾é¢˜ã€‚</li>
</ol>
<p>è€Œå¯¹äºå†…éƒ¨åå°ç³»ç»Ÿã€åŠŸèƒ½å¤æ‚ä¸”äº¤äº’é¢‘ç¹çš„å·¥å…·ç±»åº”ç”¨ï¼ˆå¦‚è®¾è®¡è½¯ä»¶ã€æ•°æ®åˆ†æå¹³å°ï¼‰ï¼ŒLitePage åˆ™ä¸æ˜¯æœ€ä¼˜é€‰æ‹©â€”â€”è¿™ç±»åº”ç”¨çš„ç”¨æˆ·é€šå¸¸æ˜¯å›ºå®šç¾¤ä½“ï¼Œå¯¹é¦–å±é€Ÿåº¦æ•æ„Ÿåº¦è¾ƒä½ï¼Œæ›´éœ€è¦å®Œæ•´æ¡†æ¶å¸¦æ¥çš„å¼€å‘æ•ˆç‡å’Œäº¤äº’ä½“éªŒã€‚</p>
<h3 data-id="heading-8">äº”ã€æ€»ç»“ï¼šLitePage çš„æ ¸å¿ƒä»·å€¼æ˜¯â€œç”¨æˆ·ä½“éªŒä¼˜å…ˆâ€</h3>
<p>å›åˆ°å¼€å¤´çš„é—®é¢˜ï¼šå½“å®¹å™¨åˆå§‹åŒ–æˆä¸ºç“¶é¢ˆæ—¶ï¼Œä¸ºä»€ä¹ˆè¦é€‰æ‹© LitePageï¼Ÿæœ¬è´¨ä¸Šï¼Œè¿™æ˜¯ä¸€ç§â€œåŠ¡å®çš„æ€§èƒ½ä¼˜åŒ–æ€ç»´â€â€”â€”<strong>æŠ€æœ¯æœåŠ¡äºä½“éªŒï¼Œè€Œéåè¿‡æ¥</strong>ã€‚</p>
<p>ä¼ ç»Ÿ SPA è¿½æ±‚â€œæŠ€æœ¯çº¯ç²¹æ€§â€ï¼Œå´ç‰ºç‰²äº†ç”¨æˆ·çš„é¦–æ¬¡ä½“éªŒï¼›è€Œ LitePage åˆ™æ‰“ç ´äº†è¿™ç§â€œéé»‘å³ç™½â€çš„æ€ç»´ï¼Œç”¨â€œè½»é‡é¦–å± + é€æ­¥å¢å¼ºâ€çš„ç­–ç•¥ï¼Œåœ¨â€œæ€§èƒ½â€å’Œâ€œä½“éªŒâ€ä¹‹é—´æ‰¾åˆ°äº†å¹³è¡¡ã€‚å®ƒä¸æ˜¯å¯¹ SPA çš„å¦å®šï¼Œè€Œæ˜¯å¯¹ SPA çš„è¡¥å……å’Œä¼˜åŒ–â€”â€”é€šè¿‡â€œå…ˆè§£å†³ç”¨æˆ·çš„å³æ—¶éœ€æ±‚â€ï¼Œå†é€æ­¥æä¾›å®Œæ•´åŠŸèƒ½ï¼Œæœ€ç»ˆå®ç°â€œå¿«ä¸”å¥½ç”¨â€çš„ç›®æ ‡ã€‚</p>
<p>æœ€åï¼Œè®°ä½ä¸€ä¸ªæ ¸å¿ƒåŸåˆ™ï¼šå‰ç«¯ä¼˜åŒ–çš„æœ¬è´¨ï¼Œæ˜¯è®©ç”¨æˆ·â€œæ›´å¿«åœ°çœ‹åˆ°å†…å®¹ã€æ›´å¿«åœ°å®Œæˆäº¤äº’â€ã€‚LitePage ä¹‹æ‰€ä»¥æœ‰æ•ˆï¼Œæ­£æ˜¯å› ä¸ºå®ƒç²¾å‡†æŠ“ä½äº†è¿™ä¸ªæœ¬è´¨ã€‚</p>
<p>å¦‚æœä½ æ­£åœ¨é¢ä¸´é¦–å±åŠ è½½æ…¢çš„é—®é¢˜ï¼Œä¸å¦¨è¯•è¯• LitePage ç­–ç•¥â€”â€”ä»ä¸€ä¸ªç®€å•çš„é™æ€å…¥å£é¡µå¼€å§‹ï¼Œæˆ–è®¸èƒ½ç»™ç”¨æˆ·ä½“éªŒå¸¦æ¥è´¨çš„æå‡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>