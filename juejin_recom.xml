<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>掘金文章推荐</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>一个帮助开发者成长的社区</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[深入理解指针Part5——回调函数及应用]]></title>    <link>https://juejin.cn/post/7603769956975951913</link>    <guid>https://juejin.cn/post/7603769956975951913</guid>    <pubDate>2026-02-08T13:05:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603769956975951913" data-draft-id="7603911453704388651" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="深入理解指针Part5——回调函数及应用"/> <meta itemprop="keywords" content="C语言"/> <meta itemprop="datePublished" content="2026-02-08T13:05:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BlackQid"/> <meta itemprop="url" content="https://juejin.cn/user/1197816773870842"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            深入理解指针Part5——回调函数及应用
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1197816773870842/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BlackQid
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T13:05:14.000Z" title="Sun Feb 08 2026 13:05:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1  回调函数的定义</h2>
<p>回调函数就是<strong>一个通过函数指针调用的函数</strong>。</p>
<p>如果你把函数的指针（地址）作为参数传递给另一个函数，当这个指针被用来调用其所指向的函数时，<strong>被调用的函数就是回调函数</strong>。回调函数不是由该函数的实现方直接调用，而是在特定的事件或条件发生时由另外的一方调用的，用于对该事件或条件进行响应。</p>
<p>概念有些抽象，接下来通过学习<code>qsort</code>函数以及其模拟实现来促进理解。</p>
<h2 data-id="heading-1">2  <code>qsort</code>函数</h2>
<p><code>qsort</code>函数是用<strong>快速排序</strong>方法能对数组、结构体等按提供的规则进行排序的一个库函数。</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">void</span> <span class="hljs-title function_">qsort</span> <span class="hljs-params">(<span class="hljs-type">void</span>* base, <span class="hljs-type">size_t</span> num, <span class="hljs-type">size_t</span> size, <span class="hljs-type">int</span> (*compar)(<span class="hljs-type">const</span> <span class="hljs-type">void</span>*,<span class="hljs-type">const</span> <span class="hljs-type">void</span>*))</span>;
</code></pre>
<p>该函数包含四个参数：</p>
<ul>
<li><code>base</code>是指向待排序内容的首元素地址；</li>
<li><code>num</code>是待排序内容的元素个数；</li>
<li><code>size</code>是待排序内容的一个元素大小，单位字节；</li>
<li>函数指针<code>compar</code>是指向<strong>比较函数</strong>，需要自行编写，实现对待排序内容中两个元素的比较。</li>
</ul>
<p>因为<code>qsort</code>函数并不知道你会传入一个什么样的数据类型，所以就需要你自己先写好一个比较函数，再传给<code>qsort</code>使用。比较函数的类型、参数与返回值都有规定，见参考链接。</p>
<p><code>qsort</code>函数更详细说明的参考链接：<a href="https://link.juejin.cn?target=https%3A%2F%2Flegacy.cplusplus.com%2Freference%2Fcstdlib%2Fqsort%2F%3Fkw%3Dqsort" target="_blank" title="https://legacy.cplusplus.com/reference/cstdlib/qsort/?kw=qsort" ref="nofollow noopener noreferrer">legacy.cplusplus.com/reference/c…</a></p>
<p>下面是一个使用<code>qsort</code>函数排序整型数组的示例：</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> _CRT_SECURE_NO_WARNINGS 1</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="hljs-type">int</span> <span class="hljs-title function_">cmp_int</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">void</span>* e1, <span class="hljs-type">const</span> <span class="hljs-type">void</span>* e2)</span>
<span class="hljs-comment">//const在*左侧，确保指针指向的内容不会被修改</span>
{
	<span class="hljs-keyword">return</span> *((<span class="hljs-type">int</span>*)e1) - *((<span class="hljs-type">int</span>*)e2);
    <span class="hljs-comment">//要排序的是整形数组，元素是整形，这里先将void*类型强转成int*类型</span>
    <span class="hljs-comment">//强转成与元素对应的指针类型，解引用才能得到正确的结果</span>
    <span class="hljs-comment">//这里return返回相减的差，正好符合比较函数的返回值要求</span>
}
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>
{
	<span class="hljs-type">int</span> arr[] = { <span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">4</span>,<span class="hljs-number">1</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">7</span> };
	<span class="hljs-type">int</span> num = <span class="hljs-keyword">sizeof</span>(arr) / <span class="hljs-keyword">sizeof</span>(arr[<span class="hljs-number">0</span>]);
	qsort(arr, num, <span class="hljs-keyword">sizeof</span>(arr[<span class="hljs-number">0</span>]), cmp_int);
}
</code></pre>
<p>下面是一个使用<code>qsort</code>函数排序结构体数组的示例：</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> _CRT_SECURE_NO_WARNINGS 1</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Stu</span>
{</span>
	<span class="hljs-type">char</span> name[<span class="hljs-number">20</span>];
	<span class="hljs-type">int</span> age;
};

<span class="hljs-type">void</span> <span class="hljs-title function_">test3</span><span class="hljs-params">()</span><span class="hljs-comment">//这里展示了两种访问结构体指针指向内容的方法</span>
{
	<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Stu</span> <span class="hljs-title">s</span> =</span> { <span class="hljs-string">"cuihua"</span>, <span class="hljs-number">18</span> };
	<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Stu</span>* <span class="hljs-title">ps</span> =</span> &amp;s;<span class="hljs-comment">//结构体指针变量</span>
	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s\n"</span>, (*ps).name);
	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s\n"</span>, ps-&gt;name);
	<span class="hljs-comment">//结构体变量.成员名</span>
	<span class="hljs-comment">//结构体指针变量-&gt;成员名</span>
}

<span class="hljs-comment">//按照名字比较大小</span>
<span class="hljs-comment">//e1是指向一个结构体数据的，e1是指向另外一个结构体数据的</span>
<span class="hljs-comment">//名字是字符串，字符串的比较使用strcmp</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">cmp_stu_by_name</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">void</span>* e1, <span class="hljs-type">const</span> <span class="hljs-type">void</span>* e2)</span>
{
	<span class="hljs-keyword">return</span> <span class="hljs-built_in">strcmp</span>((*(<span class="hljs-keyword">struct</span> Stu*)e1).name, (*(<span class="hljs-keyword">struct</span> Stu*)e2).name);
}

<span class="hljs-type">int</span> <span class="hljs-title function_">cmp_stu_by_name1</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">void</span>* e1, <span class="hljs-type">const</span> <span class="hljs-type">void</span>* e2)</span>
{
	<span class="hljs-keyword">return</span> <span class="hljs-built_in">strcmp</span>(((<span class="hljs-keyword">struct</span> Stu*)e1)-&gt;name, ((<span class="hljs-keyword">struct</span> Stu*)e2)-&gt;name);
}

<span class="hljs-comment">//按照年龄来比较</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">cmp_stu_by_age</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">void</span>* e1, <span class="hljs-type">const</span> <span class="hljs-type">void</span>* e2)</span>
{
	<span class="hljs-keyword">return</span> ((<span class="hljs-keyword">struct</span> Stu*)e1)-&gt;age - ((<span class="hljs-keyword">struct</span> Stu*)e2)-&gt;age;
}

<span class="hljs-comment">//测试qsort函数排序结构体数据 - 按名字比较</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">test2</span><span class="hljs-params">()</span>
{
	<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Stu</span> <span class="hljs-title">arr</span>[3] =</span> { {<span class="hljs-string">"zhangsan"</span>, <span class="hljs-number">18</span>},{<span class="hljs-string">"lisi"</span>, <span class="hljs-number">35</span>},{<span class="hljs-string">"wangwu"</span>, <span class="hljs-number">12</span>} };
	<span class="hljs-comment">//{"lisi", 35}, {"wangwu", 12},{"zhangsan", 18}</span>
	<span class="hljs-type">int</span> sz = <span class="hljs-keyword">sizeof</span>(arr) / <span class="hljs-keyword">sizeof</span>(arr[<span class="hljs-number">0</span>]);
	qsort(arr, sz, <span class="hljs-keyword">sizeof</span>(arr[<span class="hljs-number">0</span>]), cmp_stu_by_name);
}

<span class="hljs-comment">//测试qsort函数排序结构体数据 - 按年龄比较</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">test4</span><span class="hljs-params">()</span>
{
	<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Stu</span> <span class="hljs-title">arr</span>[3] =</span> { {<span class="hljs-string">"zhangsan"</span>, <span class="hljs-number">18</span>},{<span class="hljs-string">"lisi"</span>, <span class="hljs-number">35</span>},{<span class="hljs-string">"wangwu"</span>, <span class="hljs-number">12</span>} };
	<span class="hljs-comment">//{{"wangwu", 12}, "zhangsan", 18},{"lisi", 35}</span>
	<span class="hljs-type">int</span> sz = <span class="hljs-keyword">sizeof</span>(arr) / <span class="hljs-keyword">sizeof</span>(arr[<span class="hljs-number">0</span>]);
	qsort(arr, sz, <span class="hljs-keyword">sizeof</span>(arr[<span class="hljs-number">0</span>]), cmp_stu_by_age);
}

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>
{
	test2();
	test4();
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 data-id="heading-2">3  模拟实现</h2>
<p>第2节解释了<code>qsort</code>函数的参数及运行方式，接下来尝试模拟实现。这里排序方法采用更熟悉的冒泡排序，而非<code>qsort</code>的快速排序。</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> _CRT_SECURE_NO_WARNINGS 1</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdlib.h&gt;</span></span>

<span class="hljs-type">void</span> <span class="hljs-title function_">Swap</span><span class="hljs-params">(<span class="hljs-type">char</span>* buf1, <span class="hljs-type">char</span>* buf2, <span class="hljs-type">size_t</span> sz)</span>
{
	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; sz; i++)
	{
		<span class="hljs-type">int</span> tmp = *buf1;
		*buf1 = *buf2;
		*buf2 = tmp;
		buf1++;
		buf2++;
	}
}

<span class="hljs-type">void</span> <span class="hljs-title function_">bubble_sort</span><span class="hljs-params">(<span class="hljs-type">void</span>* base, <span class="hljs-type">size_t</span> n, <span class="hljs-type">size_t</span> sz, <span class="hljs-type">int</span> (*cmp)(<span class="hljs-type">const</span> <span class="hljs-type">void</span>*, <span class="hljs-type">const</span> <span class="hljs-type">void</span>*))</span>
{
	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++)
	{
		<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; n - <span class="hljs-number">1</span> - i; j++)
		{
			<span class="hljs-keyword">if</span> (cmp((<span class="hljs-type">char</span>*)base + sz * j, (<span class="hljs-type">char</span>*)base + sz * (j + <span class="hljs-number">1</span>)) &gt; <span class="hljs-number">0</span>)
			{
				Swap((<span class="hljs-type">char</span>*)base + sz * j, (<span class="hljs-type">char</span>*)base + sz * (j + <span class="hljs-number">1</span>), sz);
			}
		}
	}
}

<span class="hljs-type">int</span> <span class="hljs-title function_">cmp_int</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">void</span>* e1, <span class="hljs-type">const</span> <span class="hljs-type">void</span>* e2)</span>
{
	<span class="hljs-keyword">return</span> *((<span class="hljs-type">int</span>*)e1) - *((<span class="hljs-type">int</span>*)e2);
}

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>
{
	<span class="hljs-type">int</span> arr[] = { <span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">4</span>,<span class="hljs-number">1</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">7</span> };
	<span class="hljs-type">int</span> num = <span class="hljs-keyword">sizeof</span>(arr) / <span class="hljs-keyword">sizeof</span>(arr[<span class="hljs-number">0</span>]);
	bubble_sort(arr, num, <span class="hljs-keyword">sizeof</span>(arr[<span class="hljs-number">0</span>]), cmp_int);
}
</code></pre>
<p>观察上述的示例，并回忆回调函数的定义。</p>
<blockquote>
<p>回调函数就是<strong>一个通过函数指针调用的函数</strong>。</p>
<p>如果你把函数的指针（地址）作为参数传递给另一个函数，当这个指针被用来调用其所指向的函数时，<strong>被调用的函数就是回调函数</strong>。</p>
</blockquote>
<p><strong>比较函数</strong><code>cmp_int</code>通过函数指针的形式传入<code>bubble_sort</code>函数并在其内部被调用，比较函数<code>cmp_int</code>就是一个<strong>回调函数</strong>。其实第2节示例中的比较函数们也都是回调函数。</p>
<p>可见，回调函数在实现一些复杂功能时具有独到的优势。想想如果不用回调函数应该是不太好实现相同的功能的。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[业务方上压力了，前端仔速通RGB转CMYK]]></title>    <link>https://juejin.cn/post/7604093823957860371</link>    <guid>https://juejin.cn/post/7604093823957860371</guid>    <pubDate>2026-02-09T01:40:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7604093823957860371" data-draft-id="7603958579179585536" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" 业务方上压力了，前端仔速通RGB转CMYK"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-02-09T01:40:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="古茗前端团队"/> <meta itemprop="url" content="https://juejin.cn/user/3233040624266695"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             业务方上压力了，前端仔速通RGB转CMYK
            <!----> <!----></h1> <div class="container team-follow" data-v-d326b38e="" data-v-61fb5e44=""><div class="left" data-v-d326b38e=""><a href="/team/7198439419173404711/posts" data-v-d326b38e=""><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dafcebf7c91d402abd52f072a32deba8~tplv-k3u1fbpfcp-watermark.image?" class="icon" data-v-d326b38e=""/></a> <div class="content" data-v-d326b38e=""><div style="display: flex" data-v-d326b38e=""><a href="/team/7198439419173404711/posts" data-v-d326b38e=""><p class="title-line" data-v-d326b38e=""><span title="古茗前端团队" class="title" data-v-d326b38e="">古茗前端团队</span> <img src="//lf-web-assets.juejin.cn/obj/juejin-web/xitu_juejin_web/255e400027b783cbad76dc41527e7695.svg" alt="team icon" class="team-icon" data-v-d326b38e=""/></p></a></div> <div class="meta-box team" data-v-d326b38e="" data-v-61fb5e44=""><time datetime="2026-02-09T01:40:21.000Z" title="Mon Feb 09 2026 01:40:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-d326b38e="" data-v-61fb5e44="">
                2026-02-09
              </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-d326b38e="" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-d326b38e="" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-d326b38e="" data-v-61fb5e44=""/></svg> <span class="views-count" style="display:none;" data-v-d326b38e="" data-v-61fb5e44="">
                1
              </span> <span class="read-time" data-v-d326b38e="" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-d326b38e="" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-d326b38e="" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-d326b38e="" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-d326b38e="" data-v-61fb5e44=""/></svg>
                阅读29分钟
              </span> <!----> <!----></div></div></div> <button class="jj-follow-button follow-btn" style="display:none;" data-v-b60b2868="" data-v-d326b38e=""><span data-v-b60b2868="" data-v-d326b38e=""><i class="byte-icon byte-icon--plus" data-v-d326b38e=""><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 48 48"><path fill="none" d="M0 0h48v48H0z"/><path d="M24.7 4c.4 0 .6 0 .8.1.2.1.3.2.4.4.1.2.1.3.1.8V22h16.7c.4 0 .6 0 .8.1.2.1.3.2.4.4.1.2.1.3.1.8v1.4c0 .4 0 .6-.1.8-.1.2-.2.3-.4.4-.2.1-.3.1-.8.1H26v16.7c0 .4 0 .6-.1.8-.1.2-.2.3-.4.4-.2.1-.3.1-.8.1h-1.4c-.4 0-.6 0-.8-.1-.2-.1-.3-.2-.4-.4-.1-.2-.1-.3-.1-.8V26H5.3c-.4 0-.6 0-.8-.1-.2-.1-.3-.2-.4-.4-.1-.2-.1-.3-.1-.8v-1.4c0-.4 0-.6.1-.8.1-.2.2-.3.4-.4.2-.1.3-.1.8-.1H22V5.3c0-.4 0-.6.1-.8.1-.2.2-.3.4-.4.2-.1.3-.1.8-.1h1.4z"/></svg></i>
        关注
      </span></button></div> <div class="team-user block-hidden" data-v-61fb5e44=""><div class="avatar jj-avatar avatar" data-v-03256cc6="" data-v-61fb5e44=""><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="avatar" class="lazy avatar-img" data-v-5244ef91="" data-v-03256cc6=""/> </div> <!----> <span class="position ellipsis" data-v-61fb5e44="">
              @古茗科技
            </span></div> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">一、开端</h2>
<p>"又双叒叕大事不好了，咱们导出的图片有问题，印刷出来有色差！业务方都被逼着要去外采软件了！"</p>
<p>下班前，产品突然在群里丢了一颗重磅炸弹。</p>
<p>外采软件？什么情况？要是真把业务方逼去外采了，咱们 IT 往后的日子可就不好过了。</p>
<p>事不宜迟，咱们赶紧看看是怎么个事。</p>
<h2 data-id="heading-1">二、问题背景</h2>
<p>我们团队负责的是加盟商报货相关业务，其中有一个定制宣传物料的模块，业务流程是这样的：</p>
<ol>
<li>设计师在后台创建可定制的模板（使用 Fabric 实现的一个可视化编辑器）</li>
<li>加盟商通过小程序填写定制信息（门店名称、图片、文案等）下单</li>
<li>设计师在后台审核并合成最终设计稿（使用离屏 Canvas 渲染并直接上传 OSS）</li>
<li>导出高清原图发往印刷厂印刷，最终交付给加盟商</li>
</ol>
<p>这个系统的前端部分使用了 Fabric 来实现图片编辑功能，基于浏览器 Canvas API 导出图片，而 Canvas 只支持 <code>RGB</code> 色彩模式。但印刷厂需要的是 <code>CMYK</code> 模式，这导致印刷出来有非常明显的色差。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/eb1c538f450e4fcc8844367a63896a47~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=2182&amp;h=1630&amp;s=3103078&amp;e=png&amp;b=8b8176" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">三、颜色的本质：色彩学</h2>
<p>要搞明白为什么有色差，我们首先要知道，什么是颜色。</p>
<blockquote>
<p>这部分比较冗长，如果你已经具备了相关前置知识，可以直接跳转至「为什么有色差」一节</p>
</blockquote>
<h3 data-id="heading-3">1. 色彩模式</h3>
<p>1672年，牛顿通过一块棱镜，发现了光的色散，从而揭示了白光由不同颜色光谱组成的本质。</p>
<p>而后，物理学家大卫·布儒斯特进一步发现染料的原色只需要红、黄、蓝三种颜色，基于这三种颜色，就可以调配出任何其他颜色。</p>
<p>随着科技的进步，生理学家托马斯杨根据人类眼球的视觉生理特征又提出了新的三原色，即红、绿、蓝三种颜色。</p>
<p>此后，人类开始意识到，色光和颜料的原色及其混合规律是有不同的，这实际上引出的是 <code>加色模式</code> 和 <code>减色模式</code> 两种色彩模式。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/86ebd43e7622427d96711a8a74531ae4~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=2048&amp;h=1281&amp;s=412842&amp;e=png&amp;b=ffffff" alt="" loading="lazy"/></p>
<h4 data-id="heading-4">减色模式</h4>
<p>我们知道，人类并不能直接<strong>看到</strong>物体本身的颜色，我们看到的物体的颜色，实际上是物体反射的光的颜色。红色的物体，实际上是吸收了除红光以外的所有光，才让唯一的红光可以进入我们的眼球。</p>
<p>因此，在现实世界我们看到的所有<strong>不自发光物体</strong>的颜色，都应当按照减色模式进行调配和描述，如美术中使用到的颜料、印染工艺中使用的染料等。</p>
<p>减法三原色为青色（C）、品红色（M）、黄色（Y），合称 <code>CMY</code>。而现如今的印刷行业普遍采用的 <code>CMYK</code> 模式，则是因为使用三种颜色的颜料无法正确混合出纯正的黑色（通常是深灰色），因此需要额外单独的黑色（K）染料来印染黑色。</p>
<p>减色法的颜色效果完全依赖于环境光的照射和白纸的反射能力——油墨本身会吸收一部分光，白纸也无法 100% 反射所有光线，并且油墨染料的化学特性限制了其反射光谱的纯度。</p>
<h4 data-id="heading-5">加色模式</h4>
<p>而针对可以直接发出光线的物体，人类所看到的颜色就直接是其发出光线颜色本身了。</p>
<p>和减色的三原色不同，加法三原色为红（R）、绿（G）、蓝（B），也就是大家熟知的 <code>RGB</code> 模式。</p>
<p>加色法是主动光源。主动光源通常可以发出非常纯净、高饱和度的单色光，并能将亮度提升到很高。这使它能够呈现非常鲜艳、明亮的颜色。</p>
<p>就比如你看到这篇文章时使用的显示器，每个像素都是由红绿蓝三种颜色的发光二极管组成的。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d3302ec9ff66482aba360e8a7fcead9b~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=700&amp;h=412&amp;s=439079&amp;e=png&amp;b=d1d9e1" alt="" loading="lazy"/></p>
<blockquote>
<p>曾经红极一时、如雷贯耳的“周冬雨排列”</p>
</blockquote>
<p>由于物理世界的限制，印刷品很难达到显示器那种发光体的亮度和饱和度。</p>
<h3 data-id="heading-6">2. 色彩空间</h3>
<p>色彩模式告诉你，使用青、品红、黄三种颜色的调料可以调配出任何你想要的颜色，但是却没有告诉你，如果我想要调配出正红色，要用多少青色、多少品红、和多少黄色？</p>
<p>甚至你想要的正红色，其自身都没法用一个统一的标准来表述——这正红得多红才叫正红呀？</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6263818d38d644e9a6ee6dc56a97c364~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=960&amp;h=540&amp;s=433826&amp;e=png&amp;b=151f26" alt="" loading="lazy"/></p>
<p>想要定量地描述颜色，我们需要引入<code>色彩空间(Color Space)</code>的概念。</p>
<h4 data-id="heading-7">CIE XYZ</h4>
<p>1931 年，国际照明委员会（CIE）创建了 <code>CIE XYZ</code> 色彩空间，这是第一个基于人眼视觉特性的标准色彩空间。</p>
<p>基于 <code>XYZ</code> 三个坐标，我们可以用唯一确定的数值形式表示出人类肉眼可见的所有颜色。如此一来，我们便能给每一种颜色精准定位了。</p>
<h4 data-id="heading-8">sRGB</h4>
<p>虽然有了 CIE XYZ 这个“统一语言”，但在 90 年代末，电脑普及和互联网爆发带来了一个极其现实的挑战：显示器的显示能力是有限的，而当时的网络带宽更是寸土寸金。</p>
<p>如果说 CIE XYZ 是一本包含了几十万词条、大而全的《牛津英语大词典》，那么我们在日常交流中，其实只需要一本几千词的《日常口语手册》就足够了。 强行传输 XYZ 这种海量数据，既超出了显示器的承载能力，也拖慢了网速。</p>
<p>为了在显示效果、传输效率和跨设备一致性之间找到那个平衡点，1996 年，微软和惠普选取了当时主流 CRT 显示器（大头电视）荧光粉能发出的红绿蓝，作为基准三原色，由此创造了流行至今的 <code>sRGB</code> 色彩空间，其中 <code>s</code> 意为<code>标准（Standard）</code>。</p>
<h4 data-id="heading-9">CMYK</h4>
<p>与显示器不同，印刷时选取不同的印刷介质和油墨，都会导致最终的印刷效果不同，因此针对特定的纸张和油墨组合，诞生了一系列不同的 CMYK 色彩空间，例如：</p>
<ul>
<li>FOGRA / ISO Coated (欧洲标准): 针对欧洲常用的铜版纸印刷。</li>
<li>GRACoL / SWOP (美国标准): 常见于美国的出版物。</li>
<li>Japan Color (日本标准): 针对亚洲人视觉偏好的冷调印刷。</li>
</ul>
<h3 data-id="heading-10">3. 色域</h3>
<p>为了方便比较，我们通常会将不同的色彩空间统一映射到 CIE XYZ 色彩空间内进行比对。</p>
<p>如果我们将 Z 坐标进行归一化和压缩，再将所有该色彩空间内所有颜色的 X、Y 坐标连起来，就会得到一个封闭的二维图形，这个封闭的图形就是<code>色域（Color Gamut）</code>，就是该色彩模式所能表示的颜色范围。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9e83017155044d92a6a36e4a4b63994b~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1200&amp;h=1267&amp;s=676567&amp;e=png&amp;b=fffefe" alt="" loading="lazy"/></p>
<blockquote>
<p>其中马蹄形区域是可见光的色域，通常被称作“全色域”</p>
</blockquote>
<p>通过图像我们不难看出，sRGB 的色域并不能完全覆盖 CMYK，这意味着，一个在 sRGB 下能表示出的颜色，在 CMYK 模式下可能根本没有对应的颜色，这会导致风光摄影中一些常见的绿色无法在印刷时体现。因此，传统印刷行业对微软和 Adobe 等公司制定的 sRGB 标准提出了强烈的反对和质疑。</p>
<p>面对印刷业巨头的联合抵制和抗议，微软并没有认怂，他们之间的纠纷战争维持了三年之久，最后在 Adobe 公司的调解下，制定了 Adobe RGB 色域，这一更广阔的色域完美地包含了印刷所需的所有颜色。</p>
<p>但是摄影及印刷行业的从业者毕竟是少数，绝大多数的互联网用户并不需要关心 CMYK 这种印刷时才会遇到的色彩模式，传统的 sRGB 依旧可以满足网上冲浪的全部需求。</p>
<p>此外，更广色域的图片也需要更专业更贵的显示器、搭配专业软件才能正常显示，这也是为什么即便到了今天，sRGB 在互联网领域依旧占据绝对统治地位。</p>
<blockquote>
<p><strong>Tips: 显示器的色域</strong></p>
<p>当你挑选显示器的时候，可能常常会听到诸如“120% sRGB”、“97% sRGB”等关键词，这里的百分比，实际上就是显示器色域占 sRGB 色域的范围。如果不考虑专业设计场景，理论上只要显示器能达到 100% 的 sRGB 色域，便可以满足你日常上网的全部需求</p>
<p>而类似“Adobe RGB 100% 色域”、“P3 广色域” 、“杜比视界”等更广阔的色域，随着时代的发展也逐渐有了更多的日常使用场景，如 B 站现在就支持 HDR 杜比视界的视频播放；在大型单机游戏领域，也越来越多地支持的 P3 色域。</p>
</blockquote>
<h2 data-id="heading-11">四、为什么有色差？</h2>
<p>了解了色彩学的基础知识后，我们重新审视一下最开始的那个问题：</p>
<p>我们知道，印刷厂的印刷机，最终印刷一定是使用 CMYK 四种颜色的墨水进行印刷的，因此当我们给出 RGB 原图时，必然经过了印刷厂的一次转换，这可能发生在机器内部，也可能发生在印刷厂的内部系统流程中；</p>
<p>而设计师手动转换色彩空间后，印刷没有色差，这就说明，色差的根源就在于印刷厂的这一次转换！</p>
<p>现阶段，想要将 RGB 转为 CMYK，通常有两种转换方式：</p>
<h3 data-id="heading-12">1. 基于基础数学公式</h3>
<p>这是最简单、最基础的算法，通常用于不要求颜色精确度的场景。</p>
<p><strong>转换步骤：</strong></p>
<ol>
<li><strong>归一化：</strong> 将 R, G, B 的值（0-255）除以 <code>255</code>，使其范围变为 <code>0～1</code>。</li>
<li><strong>计算黑色（K）：</strong><code>K = 1 - Max(R, G, B)</code></li>
<li><strong>计算 C, M, Y：</strong>
<ul>
<li><code>C = (1 - R - K) / (1 - K)</code></li>
<li><code>M = (1 - G - K) / (1 - K)</code></li>
<li><code>Y = (1 - B - K) / (1 - K)</code></li>
</ul>
</li>
</ol>
<p><strong>注意：</strong> 如果 K = 1（纯黑），则 C, M, Y 均为 <code>0</code>。</p>
<p>这种算法的思路很朴素：既然 RGB 是加色，CMYK 是减色，那就通过数学关系做个映射。理论上确实可以完成转换，但问题在于——这种纯数学转换完全不考虑现实世界的设备差异。</p>
<p>同样是显示一个红色 <code>RGB(255, 0, 0)</code>，不同品牌、不同型号的显示器，实际发出的光的波长和强度都不一样。你的显示器可能偏冷色调，我的显示器可能偏暖色调，但在算法眼里，它们都是 <code>RGB(255, 0, 0)</code>。</p>
<p>同样是印刷 <code>C0 M100 Y100 K0</code>，不同的打印机、不同的纸张、不同的油墨，印出来的颜色也千差万别。这家印刷厂的红色油墨偏橙，那家印刷厂的红色油墨偏紫，但算法根本不知道这些差异。</p>
<p>而最令人头疼的是色域映射问题——RGB 能显示的某些鲜艳颜色，比如荧光绿 <code>RGB(0, 255, 0)</code>，在 CMYK 的色域里根本没有对应的颜色。算法会强行把它映射成 <code>C100 M0 Y100 K0</code>，但印出来的绿色会明显发灰、发暗，完全不是你在屏幕上看到的那种鲜艳的绿。</p>
<p>纯算法转换假设所有设备都是"标准"的，假设色域可以完美映射，但现实世界里这两个假设都不成立。</p>
<h3 data-id="heading-13">2. 基于 ICC 特性文件</h3>
<p>这是目前设计软件（如 Adobe Illustrator、Photoshop 等）和专业印刷流程采用的标准方式。</p>
<p>正如上一节中提到，RGB 和 CMYK 都有各自的色彩空间，显示器和打印机之间各说各话，你在显示器上看到的颜色，打印出来可能是另一个颜色。</p>
<p>为了解决这个问题，1993 年，包括 Adobe、Apple、Microsoft、Sun 等八家科技公司联合成立了国际色彩联盟 <code>ICC（International Color Consortium，国际色彩联盟）</code>，目标就是建立一个开放、跨平台的色彩管理标准。ICC 配置文件规范也由此诞生。</p>
<p><del>ICC 来色彩管理界只办三件事：公平！公平！还是他**的公平！</del></p>
<p>不好意思串台了，但是其实某种意义上来说也没错。ICC 的出现是为了确保"所见即所得"，它的最终目标是让你在屏幕上看到的红色，在打印纸上也是同样的红色。</p>
<h4 data-id="heading-14">PCS：色彩转换的中间人</h4>
<p>为了做到“所见即所得”，ICC 系统引入了一个中间色彩空间 <code>PCS（Profile Connection Space，特性连接空间）</code>。这是一个设备无关的、中介的、与人眼感知相关的色彩空间（通常使用前面提到的 CIE XYZ 或者基于其演化出的 CIE Lab 色彩空间）。</p>
<p>有了 ICC 规范之后，每个设备的 ICC 文件都是通过专业仪器实际测量出来的：</p>
<ul>
<li><strong>显示器的 ICC 文件</strong>：厂商用校色仪测量这台显示器，记录下 <code>RGB(255, 0, 0)</code> 在这台显示器上实际发出的光对应的 Lab 值（比如 <code>Lab(53.23, 80.11, 67.22)</code>）</li>
</ul>
<blockquote>
<p>在你系统的显示器设置中，你可以看到当前显示器的颜色描述文件，它通常以你的显示器型号命名</p>

</blockquote>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/971a17576d9946aa93349275c4d48e39~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1446&amp;h=1400&amp;s=256165&amp;e=png&amp;b=e3e3e3" alt="" loading="lazy"/></p>
<blockquote>
<p>这个文件就是显示器厂商针对这一型号制作的 ICC 文件，其内部包含了整台显示器所能展示的全部颜色，通常会随着驱动文件自动下载到你的电脑中。</p>
<p>大多数厂商所提供的只是一个通用 ICC 文件，实际上，哪怕是相同厂商、相同型号的显示器，受品控、原料批次及使用老化等因素影响，其显示效果也会有细微的差别。在某些对色彩准确性要求比较高的场景下（如影视、平面设计等）通常还需要针对单台设备进行颜色校准，并且制作一份矫正后的 ICC 或 LUT，才能够保证最终产出的图像和肉眼看到的一致。</p>
</blockquote>
<ul>
<li><strong>印刷机的 ICC 文件</strong>：印刷厂用分光光度计测量，记录下 <code>C0 M100 Y100 K0</code> 在这台印刷机、这种纸张、这种油墨上实际印出来的颜色对应的 Lab 值（比如 <code>Lab(47.82, 68.30, 48.05)</code>）</li>
</ul>
<p>每个设备的 ICC 文件都描述了该设备色彩空间与 PCS 之间的转换关系，就像不同国家的语言都可以通过英语作为中介进行翻译，如此一来，当你在显示器上看到一张照片并想打印出来时，只要经过如下转换：</p>
<ol>
<li>显示器的 ICC 配置文件把 RGB 信号转换到 Lab 色彩空间</li>
<li>印刷机的 ICC 配置文件再把这个 Lab 值翻译成印刷机需要的 CMYK 信号</li>
</ol>
<p>因为 Lab 是基于人眼感知的绝对色彩空间，所以这样转换后，你在屏幕上看到的红色，和印刷出来的红色，在人眼看来就是同一个颜色了。反之亦是同理。</p>
<h4 data-id="heading-15">渲染意图：当色域溢出时怎么办？</h4>
<p>虽然 ICC 文件可以实现从 RGB 到 CMYK 的双向映射，但是还记得我们前文提到的 RGB 的色域要比 CMYK 更广吗？这必然会导致有部分 RGB 颜色，无法和 CMYK 颜色进行映射。这时就轮到 <code>渲染意图（Rendering Intent）</code> 登场了。</p>
<p>在 ICC 规范中，一共有四种法定意图，它们决定了如何处理色域外的颜色。</p>
<h5 data-id="heading-16">可感知意图（Perceptual）</h5>
<p>可感知意图的核心原理是等比例压缩，以 RGB 转 CMYK 为例，它将 RGB 的色域等比例缩放到 CMYK 的色域，颜色之间的相对关系（层次、过渡）保留得比较好。虽然整体饱和度可能会稍微下降，但图片看起来非常自然，不会有色块断层。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3641e456f5d74d76921e8ef9bd281403~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3780&amp;h=1417&amp;s=517336&amp;e=jpg&amp;b=fbbe2e" alt="" loading="lazy"/></p>
<blockquote>
<p>可以看出，图片虽然整体饱和度下降，但是颜色渐变过渡被保留得很好，不存在明显的断层，文本颜色也依旧可以辨识。</p>
</blockquote>
<h5 data-id="heading-17">相对比色意图（Relative Colorimetric）</h5>
<p>相对比色意图的核心逻辑是精准对齐 + 硬性裁剪，同样以 RGB 转 CMYK 为例，如果颜色在 CMYK 的色域内，就不会做任何改动；如果颜色超出了 CMYK 的色域就会直接截取为 CMYK 的边缘色彩。</p>
<p>这种方式转换的颜色最"准"，因为它尽可能保持了大部分原始数值。但在极鲜艳、极暗的区域，可能会出现"并色"（Clipping）现象，即原本有层次的颜色变成了相同的颜色，丢失了层次感。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c10fcb06f87c4d658f25652cfed06e60~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3780&amp;h=1417&amp;s=561217&amp;e=jpg&amp;b=fdb82f" alt="" loading="lazy"/></p>
<blockquote>
<p>可以看出，图片在中部颜色没有溢出的部分保持了相同的色彩，但在两侧出现了较为明显的色域断层和边界。边界外颜色的渐变效果已被截断，且和同样超出色域范围的文本颜色被压缩成了相同的颜色，导致文本无法辨识。</p>
</blockquote>
<p>此外还有<strong>饱和度意图（Saturation）和绝对比色意图（Absolute Colorimetric）</strong>，由于篇幅限制这里就不多做赘述了。</p>
<h4 data-id="heading-18">黑场补偿：保留暗部细节</h4>
<p>可感知意图为了让所有颜色都能塞进目标色域，会移动所有颜色（甚至是那些本来就在色域内的颜色）。这意味着你看到的颜色虽然“和谐”，但已经不再是原始定义的那个准确的数值了，色差会比较明显。</p>
<p>而相对比色虽然尽可能多地保证了色准，但是面对色域外的颜色（尤其是深色）时又极易丢失细节</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a4cd7062380b4654924fe0f97343019b~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=2972&amp;h=1981&amp;s=365325&amp;e=jpg&amp;b=f3e6e1" alt="" loading="lazy"/></p>
<blockquote>
<p>左图为 RGB 原图，右图为 CMYK 使用相对比色意图，不开启黑场补偿</p>
<p>可以看出白框中蓝莓的暗区细节已经完全丢失</p>
</blockquote>
<p>那么有没有办法，能够让我们在保证色准的同时，尽可能多地保留暗部细节呢？</p>
<p><strong>有的兄弟，有的</strong>，这门技术就是<code>黑场补偿（Black Point Compensation）</code>。</p>
<p>黑场补偿的原理，本质上就是将原图的暗区进行缩放：它会先找到源文件（RGB）中最黑的点，再找到目标输出（CMYK）能达到的最黑的点，并将整个画面的亮度范围进行等比例的"缩放"，让 RGB 的黑点刚好对应上 CMYK 的黑点。</p>
<p>如此一来，原本深灰和全黑之间的相对比例就被保留了下来，虽然整体看起来可能没那么深邃了，但暗部的细节纹理被成功"挤"进了 CMYK 能表达的范围内。</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/750c39c49a904ef383d61e7c6c62574c~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=2972&amp;h=1981&amp;s=4558072&amp;e=jpg&amp;b=f2e6e1" alt="" loading="lazy"/></p>
<blockquote>
<p>开启了黑场补偿后，可以看出暗区细节被完好地保留了下来</p>
</blockquote>
<p><strong>并非所有 ICC 文件的可感知意图都完美</strong></p>
<p>除了解决相对比色意图的暗部细节丢失以外，BFC 也同样可以给可感知意图兜底。</p>
<p>我们知道，ICC 文件是由厂商自行制作的，那必然会出现：有些厂商的“可感知”算法做得很好，暗部过渡自然；而有些厂商的算法却过于保守，或者在处理某些特定颜色时产生了意料之外的偏色。</p>
<p>而 BPC 是一种标准化的算法（由 Adobe 提出并贡献给 ICC）。它不依赖于 ICC 内部复杂的查表映射，而是在转换阶段进行一次数学上的端点对齐。因此，BPC 提供了一层额外的保险，确保无论你使用哪种意图，最黑的点始终能对应到输出设备的最黑点。</p>
<blockquote>
<p>在 Photoshop、Illustrator 等软件中，通常建议默认开启黑场补偿；而部分图像处理工具则可能不提供这一功能。</p>
</blockquote>
<h2 data-id="heading-19">五、如何解决？</h2>
<p>到这里，我们几乎可以确定了色差的根源，原因无非以下几个：</p>
<ul>
<li>印刷厂根本直接用的算法公式转换</li>
<li>印刷厂的转换工具不支持渲染意图和黑场补偿</li>
<li>印刷厂的渲染意图和黑场补偿选错了</li>
<li>印刷厂用的 ICC 文件不对</li>
</ul>
<p>但是不管到底是哪个问题，我们都有一个万能的解法——将 RGB 原图按照设计师的要求一比一转好后，再发给印刷厂。毕竟设计师转出来的发过去，印出来就是对的嘛。</p>
<p>依葫芦画瓢，和设计师一番沟通之后，我们确定了转换的过程与目标：</p>
<ul>
<li>RGB 原图：ICC 文件使用浏览器内置的 <code>sRGB IEC61966-2.1</code>，这是 Canvas 导出图片的默认配置</li>
<li>CMYK 转换：使用 Adobe Illustrator 软件中的默认预设——<code>日本常规用途2</code>
<ul>
<li>ICC 文件：<code>Japan Color 2001 Coated</code></li>
<li>渲染意图：可感知</li>
<li>黑场补偿：开</li>
</ul>
</li>
</ul>
<p>方案确定了，接下来进行技术调研吧。</p>
<h2 data-id="heading-20">六、技术选型</h2>
<p>我们最初的调研方向是使用服务端转换，因为相对成熟的 npm 包大多都只支持 Node 环境，而非浏览器环境。</p>
<h3 data-id="heading-21">1. Sharp</h3>
<p>首先，我们找到的是 <code>Sharp</code> 这个 Node 库，其底层基于 <code>C/C++</code> 的 <code>libvips</code>，宣称_比使用最快的 ImageMagick 和 GraphicsMagick 设置快 4 到 5 倍_，在 Node 中可以开箱即用，也是大多数 Node 应用的首选。</p>
<p>使用 Sharp 完成 RGB 到 CMYK 的转换非常简单，核心代码仅四行：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> sharp <span class="hljs-keyword">from</span> <span class="hljs-string">'sharp'</span>;

<span class="hljs-meta">@Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ImageService</span> {
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">transformToCMYK</span>(<span class="hljs-attr">file</span>: <span class="hljs-title class_">Express</span>.<span class="hljs-property">Multer</span>.<span class="hljs-property">File</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Buffer</span>&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">sharp</span>(file.<span class="hljs-property">buffer</span>)
      .<span class="hljs-title function_">withIccProfile</span>(<span class="hljs-string">'./profiles/JapanColor2001Coated.icc'</span>)
      .<span class="hljs-title function_">jpeg</span>({ <span class="hljs-attr">quality</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">chromaSubsampling</span>: <span class="hljs-string">'4:4:4'</span> })
      .<span class="hljs-title function_">toBuffer</span>();
  }
}
</code></pre>
<p>美中不足的是，Sharp 毕竟是一个精简的图像处理框架，它仅支持纯算法和纯 ICC 文件的 CMYK 转换，前文提到的渲染意图和黑场补偿等均未支持。</p>
<h3 data-id="heading-22">2. ImageMagick</h3>
<p><code>ImageMagick</code> 是一个非常老牌的图像处理框架，堪比音视频领域的 <code>ffmpeg</code>。而最重要的是它支持指定渲染意图和开启黑场补偿。</p>
<p>本地安装后，你可以使用如下命令行命令来实现 RGB 到 CMYK 的转换：</p>
<pre><code class="hljs language-bash" lang="bash">magick convert input.jpg \
  -profile <span class="hljs-string">"sRGB_v4_ICC_preference.icc"</span> \
  -intent Relative \
  -black-point-compensation \
  -profile <span class="hljs-string">"Your_Target_CMYK.icc"</span> \
  output.jpg
</code></pre>
<p>除了直接使用命令行调用二进制文件，我们还可以使用 <code>magickwand.js</code>，这是一个基于 <code>swig</code> 和 <code>emnapi</code> 的库，同时实现了 Node.js 原生和浏览器 WASM 版本。</p>
<p>magickwand.js 的 Node.js 原生版本专为与 Express.js 等框架配合使用而设计，非常适合服务器端应用。官方文档宣称它_经过内存泄漏调试，并且在仅使用异步方法时，绝不会阻塞事件循环_。</p>
<p>在 Node 中使用 magickwand.js 也非常简单，代码示例如下：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span>, <span class="hljs-title class_">Logger</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@nestjs/common"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Intent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"./dto/cmyk.dto"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Magick</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"magickwand.js/native"</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">"fs"</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">"path"</span>;

<span class="hljs-meta">@Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ImageService</span> {
  <span class="hljs-keyword">private</span> logger = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Logger</span>(<span class="hljs-title class_">ImageService</span>.<span class="hljs-property">name</span>);
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-attr">profiles</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Magick</span>.<span class="hljs-property">Blob</span>&gt; = {};

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// Japan Color 2001 Coated</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadIccProfile</span>(
      <span class="hljs-string">"JapanColor2001Coated"</span>,
      <span class="hljs-string">"./profiles/JapanColor2001Coated.icc"</span>
    );
    <span class="hljs-comment">// 普通CMYK描述文件</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadIccProfile</span>(
      <span class="hljs-string">"Generic CMYK Profile"</span>,
      <span class="hljs-string">"./profiles/Generic CMYK Profile.icc"</span>
    );
  }

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">loadIccProfile</span>(<span class="hljs-params">profileName: <span class="hljs-built_in">string</span>, profilePath: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">profiles</span>[profileName]) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">logger</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`<span class="hljs-subst">${profileName}</span> 配置文件已存在，跳过加载`</span>);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">const</span> fullPath = path.<span class="hljs-title function_">join</span>(__dirname, profilePath);
    <span class="hljs-keyword">const</span> buffer = fs.<span class="hljs-title function_">readFileSync</span>(fullPath).<span class="hljs-property">buffer</span>;
    <span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Magick</span>.<span class="hljs-title class_">Blob</span>(buffer);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">profiles</span>[profileName] = blob;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">transformToCMYK</span>(
    <span class="hljs-attr">file</span>: <span class="hljs-title class_">Express</span>.<span class="hljs-property">Multer</span>.<span class="hljs-property">File</span>,
    <span class="hljs-attr">intent</span>: <span class="hljs-title class_">Intent</span>,
    <span class="hljs-attr">blackPointCompensation</span>: <span class="hljs-built_in">boolean</span>
  ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Buffer</span>&gt; {
    <span class="hljs-keyword">const</span> inputBlob = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Magick</span>.<span class="hljs-title class_">Blob</span>(file.<span class="hljs-property">buffer</span>.<span class="hljs-property">buffer</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">ArrayBuffer</span>);
    <span class="hljs-keyword">const</span> inputImage = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Magick</span>.<span class="hljs-title class_">Image</span>(inputBlob);
    <span class="hljs-comment">// 指定渲染意图</span>
    <span class="hljs-keyword">await</span> inputImage.<span class="hljs-title function_">renderingIntentAsync</span>(intent);
    <span class="hljs-comment">// 设置黑场补偿</span>
    <span class="hljs-keyword">await</span> inputImage.<span class="hljs-title function_">blackPointCompensationAsync</span>(blackPointCompensation);
    <span class="hljs-comment">// 转换 ICC 配置文件</span>
    <span class="hljs-keyword">await</span> inputImage.<span class="hljs-title function_">iccColorProfileAsync</span>(
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">profiles</span>[<span class="hljs-string">"JapanColor2001Coated"</span>]
    );
    <span class="hljs-comment">// 指定输出格式</span>
    <span class="hljs-keyword">await</span> inputImage.<span class="hljs-title function_">magickAsync</span>(<span class="hljs-string">"JPEG"</span>);

    <span class="hljs-keyword">const</span> outputBlob = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Magick</span>.<span class="hljs-title class_">Blob</span>();
    <span class="hljs-keyword">await</span> inputImage.<span class="hljs-title function_">writeAsync</span>(outputBlob);
    <span class="hljs-keyword">const</span> outputBuffer = <span class="hljs-keyword">await</span> outputBlob.<span class="hljs-title function_">dataAsync</span>();

    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">from</span>(outputBuffer);
  }
}
</code></pre>
<p>这个库的主要问题是它没有 JS/TS 的文档，只有 C/C++ 的文档，使用时往往需要你根据 TS 的参数类型连蒙带猜去传参。</p>
<h3 data-id="heading-23">3. PIL/Pillow</h3>
<p>除了使用 Node，在 Python 中我们也有很多的选择，例如 <code>PIL/Pillow</code>，它同样非常强大易用，代码示例如下：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image, ImageCms

img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">"input.jpg"</span>)
rgb_profile = ImageCms.getOpenProfile(<span class="hljs-string">"sRGB Color Space Profile.icm"</span>)
cmyk_profile = ImageCms.getOpenProfile(<span class="hljs-string">"JapanColor2001Coated.icc"</span>)

transform = ImageCms.buildTransform(
    rgb_profile,
    cmyk_profile,
    <span class="hljs-string">"RGB"</span>,
    <span class="hljs-string">"CMYK"</span>,
    renderingIntent=ImageCms.Intent.RELATIVE_COLORIMETRIC,  <span class="hljs-comment"># 相对比色</span>
    flags=ImageCms.Flags.BLACKPOINTCOMPENSATION,  <span class="hljs-comment"># 黑场补偿</span>
)

cmyk_img = ImageCms.applyTransform(img, transform)
cmyk_img.save(<span class="hljs-string">"output.jpg"</span>, quality=<span class="hljs-number">95</span>, icc_profile=cmyk_profile.tobytes())
</code></pre>
<h2 data-id="heading-24">七、困难重重</h2>
<p>既然有这么多现成的库，而且代码看着也没多少，一定很好实现吧。</p>
<p>很可惜，理想很美好，现实很悲催。在实际落地过程中，我们遇到了很多问题。</p>
<h3 data-id="heading-25">问题一：CI/CD 构建失败</h3>
<p>最开始，我们选择了功能最完善的 <code>magickwand.js</code>。它天然支持渲染意图和黑场补偿，正好满足我们的需求。本地编码调试一切正常，但提交到 CI/CD 平台后，构建直接失败了：</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/566129947f4f4a8ba37f2a580d58f17a~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=1966&amp;h=406&amp;s=151295&amp;e=png&amp;b=151718" alt="" loading="lazy"/></p>
<p>排查后发现，magickwand.js 依赖 <code>xpm</code> 这个 C/C++ 包管理器。在执行 <code>npm install</code> 时，xpm 会去 npm 源查找 <code>package.json</code> 中声明的 <code>xpack</code> 字段，然后从 GitHub 下载对应平台的二进制文件：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"xpack"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"binaries"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"baseUrl"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://github.com/xpack-dev-tools/ninja-build-xpack/releases/download/v1.13.1-1"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"platforms"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"darwin-arm64"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"fileName"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"xpack-ninja-build-1.13.1-1-darwin-arm64.tar.gz"</span><span class="hljs-punctuation">,</span>
          ...
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        ...
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>构建容器内无法访问 Github，这个问题我们无法解决，只能放弃 magickwand.js，转而考虑其他方案。</p>
<blockquote>
<p>实际上我们还有一个方案，就是绕过 xpm，直接将预编译好的 ImageMagick 二进制文件都下载到本地，然后在 Node 中写一个平台适配层，封装下命令调用，也可以满足需求。</p>
<p>但是使用 child_process 来调用会有很多问题：</p>
<ol>
<li>性能开销大：涉及进程创建、销毁和上下文切换成本；</li>
<li>通信效率低：需通过标准输入输出进行数据序列化与反序列化，增加了额外的处理延迟；</li>
<li>并发控制复杂：需手动管理进程池和资源竞争，避免系统资源耗尽；</li>
<li>异步编程繁琐：必须处理流控制、背压和错误恢复机制，代码复杂度显著增加；</li>
<li>稳定性风险高：子进程崩溃可能影响主进程稳定性，且进程间状态难以共享。</li>
</ol>
<p>综合考虑下来，这个也只能作为实在没有办法的备选，不应当作为首选方案。</p>
</blockquote>
<h3 data-id="heading-26">问题二：图像传输的性能瓶颈</h3>
<p>除了构建上的难题，最致命的实际是后端处理所带来的用户体验问题。</p>
<p>在我们的业务场景中，设计稿需要以 300 DPI 导出，一张海报的分辨率通常是 7087×9449，RGB 原图约 30MB；而门店横幅、围挡等大尺寸设计稿，原图甚至会达到 100MB+。</p>
<p>虽然前段时间运维升级了公司的网络带宽，由原先的 25Mb 调整到 100Mb，但是即便是跑满带宽，下载速度也只能达到约 12MB/s，而这还是建立在不考虑服务器带宽的前提下，完整的转换流程仍然需要：</p>
<ol>
<li>前端上传原图到后端（30-100MB 上行）</li>
<li>后端处理转换（4 核 8G 的处理器需要 10s 以上的处理时间）</li>
<li>后端返回 CMYK 图片（30-100MB 下行）</li>
<li>前端手动上传到 OSS（30-100MB 再次上行）</li>
</ol>
<p>整个 RTT 实测下来超过了 100 秒，还要承受网络波动导致传输失败的风险。这种体验完全无法接受。</p>
<p>我们也想过优化方案——把 Fabric 的渲染逻辑移到服务端：</p>
<ol>
<li>前端只传 JSON 配置文件（体积小）</li>
<li>后端用 <code>fabric + node-canvas</code> 渲染图片</li>
<li>就地转换为 CMYK 并直接上传 OSS</li>
<li>返回图片 URL</li>
</ol>
<p>理论上可以减少一次上行和一次下行，将 RTT 缩短至 30 秒以内。但这个方案评估下来，问题更多：</p>
<p><strong>1. 渲染场景复杂，迁移成本极高</strong></p>
<p>我们有两个场景需要适配：</p>
<ul>
<li>设计师编辑模板：直接导出 Canvas 内容</li>
<li>加盟商生成终稿：先替换占位内容，再导出；还需前置生成低分辨率预览稿，以及展示处理进度</li>
</ul>
<p>如果将 Fabric 渲染逻辑迁移到 Node：</p>
<ul>
<li>一套代码适配：需要从头梳理两套逻辑的异同点，工作量巨大</li>
<li>两套代码分离：后续维护成本会直线上升</li>
</ul>
<p>而且前端现有的历史渲染代码本就错综复杂，要保证 Node 生成的图片和浏览器完全一致，需要投入更多的开发和测试资源。</p>
<p><strong>2. 字体合规风险</strong></p>
<p>设计团队使用的字体都是免费或商业授权的，但大多数字体的授权范围仅限于桌面使用。如果把字体文件上传到服务器，属于"网络传播"或"网络嵌入"用途，需要单独授权。</p>
<p>要合法使用服务端渲染，我们需要：</p>
<ol>
<li>对所有免费、商业字体进行全面审计</li>
<li>申请新的适用范围授权（费时费力，成本高昂）</li>
</ol>
<p>这期间，一旦出现纰漏，可能收到律师函、侵权通知或高额赔偿。</p>
<p>作为一家上市公司，古茗在全国有上万家加盟门店。如此大的体量，任何合规风险都可能给公司造成无法估量的损失。</p>
<p><strong>3. 服务端性能问题</strong></p>
<p>使用服务端渲染还有一个绕不过的问题就是性能问题，在服务端执行图像处理，同样需要耗费 CPU 和内存性能，我们需要对使用场景进行梳理，根据埋点信息统计出调用频次，以评估接口性能，并对接口进行压测。如果性能不能满足，我们还需要申请更高配置的服务器。</p>
<p>这同样需要我们花费更多的时间，测试资源本就紧张，难以协调，线上稳定性也难以保障。</p>
<h3 data-id="heading-27">客户端方案的探索</h3>
<p>服务端方案成本太高，必须另寻出路，而客户端方案，JS 处理肯定是不行了，性能太差。而除了 JS 我们还有一条路可以走——WebAssembly。</p>
<p>ImageMagick 是用 C/C++ 编写的，理论上我们可以用 Emscripten 编译为 WASM。但想要打通整条链路，我们需要：</p>
<ol>
<li>搭建 emscripten 环境</li>
<li>使用 cmake/autotools 编译依赖库</li>
<li>链接和编译 ImageMagick 主代码库</li>
<li>编写 JS/WASM 胶水层代码</li>
</ol>
<blockquote>
<p>参考：<a href="https://link.juejin.cn?target=https%3A%2F%2Fcloud.tencent.com%2Fdeveloper%2Farticle%2F1554176" target="_blank" title="https://cloud.tencent.com/developer/article/1554176" ref="nofollow noopener noreferrer">WebAssembly实战-在浏览器中使用ImageMagick-腾讯云开发者社区-腾讯云</a></p>
</blockquote>
<p>这套流程虽然很明确，但学习和上手成本确实不低。受限于工期，我们先尝试寻找现成的方案：</p>
<p><strong>1. magickwand.js WASM 版本</strong></p>
<p>magickwand.js 本身就提供了 WASM 版本，但使用后发现它依赖 <code>SharedArrayBuffer</code>，这要求启用<code>跨域隔离（Cross-Origin Isolation）</code>。这不仅需要改造现有的构建脚手架，发布时还需要改造网关配置。加之这个库之前在 CI/CD 环节就有问题，我们只能放弃。</p>
<p><strong>2. 其他 WASM 库</strong></p>
<p>ImageMagick 官网推荐的 <code>WASM-ImageMagick</code> 已经 6 年没更新了。我们在 npm 上找到了 <code>@imagemagick/magick-wasm</code>，其作者是 ImageMagick 的核心开发者之一，下载量排名靠前，更新活跃，非常可靠。</p>
<p>最重要的是，它不存在我们前面提到的任何一个问题！</p>
<h2 data-id="heading-28">八、工程接入</h2>
<p>问题解决，接下来只需要将 magick-wasm 接入到工程中即可。</p>
<h3 data-id="heading-29">1. 前置准备</h3>
<p>magick-wasm 这个库内部使用 <code>BigInt</code>，如果你的 <code>browserslist</code> 指定版本过低，Babel 编译时可能会报错，添加一个 <code>supports bigint</code> 即可：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"browserslist"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"supports bigint"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"not dead"</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-30">2. WASM 初始化</h3>
<p>我们需要在页面组件中加载 WASM 模块，这里我们要求必须初始化成功，因为如果 WASM 模块无法加载，设计师转换色彩模式失败，仍会影响后续印刷。</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">WASM_LOCATION</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">'@imagemagick/magick-wasm/magick.wasm'</span>, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>);

<span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">useMount</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">true</span>);
    <span class="hljs-title function_">initializeImageMagick</span>(<span class="hljs-variable constant_">WASM_LOCATION</span>)
      .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ImageMagick 初始化成功'</span>))
      .<span class="hljs-title function_">catch</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-keyword">const</span> message = <span class="hljs-string">'ImageMagick 初始化失败'</span>;
        <span class="hljs-title class_">CustomReport</span>.<span class="hljs-title function_">sendWarning</span>(<span class="hljs-title class_">ArmsLogs</span>.<span class="hljs-property">initializeImageMagickFailed</span>, { message });
        <span class="hljs-title class_">Modal</span>.<span class="hljs-title function_">error</span>({
          <span class="hljs-attr">title</span>: message,
          <span class="hljs-attr">content</span>: <span class="hljs-string">'请使用最新版本的 Chrome 浏览器!'</span>,
          <span class="hljs-attr">onOk</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">close</span>(),
        });
      })
      .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">false</span>));
  });
}
</code></pre>
<p>初始化逻辑中需要注意添加 Loading 提示，因为初始化 WASM 是需要通过网络请求获取 <code>.wasm</code> 文件的，如果网速过慢就有可能导致触发转换时 WASM 模块还没有初始化完成。</p>
<p>此外，在初始化失败时还要接入埋点告警，以便我们感知线上的使用情况。</p>
<h3 data-id="heading-31">3. 色彩模式转换</h3>
<p>这部分的核心转换逻辑也并不多，大致流程如下：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">RGB_PROFILE_LOCATION</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">'@/assets/icc/sRGB Color Space Profile.icm'</span>, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>);
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">CMYK_PROFILE_LOCATION</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">'@/assets/icc/JapanColor2001Coated.icc'</span>, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>);

<span class="hljs-keyword">const</span> readFile = <span class="hljs-keyword">async</span> (<span class="hljs-attr">url</span>: <span class="hljs-variable constant_">URL</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Uint8Array</span>&gt; =&gt; {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(url);
  <span class="hljs-keyword">const</span> arrayBuffer = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">arrayBuffer</span>();
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(arrayBuffer);
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> transformColorSpace = <span class="hljs-keyword">async</span> (<span class="hljs-attr">uint8Array</span>: <span class="hljs-title class_">Uint8Array</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Uint8Array</span>&gt; =&gt; {
  <span class="hljs-keyword">const</span> [rgbProfileUint8Array, cmykProfileUint8Array] = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([
    <span class="hljs-title function_">readFile</span>(<span class="hljs-variable constant_">RGB_PROFILE_LOCATION</span>),
    <span class="hljs-title function_">readFile</span>(<span class="hljs-variable constant_">CMYK_PROFILE_LOCATION</span>),
  ]);
  <span class="hljs-keyword">const</span> rgbProfile = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ColorProfile</span>(rgbProfileUint8Array);
  <span class="hljs-keyword">const</span> cmykProfile = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ColorProfile</span>(cmykProfileUint8Array);

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-title class_">ImageMagick</span>.<span class="hljs-title function_">read</span>(uint8Array, <span class="hljs-title class_">MagickFormat</span>.<span class="hljs-property">Jpeg</span>, <span class="hljs-function">(<span class="hljs-params">image</span>) =&gt;</span> {
      image.<span class="hljs-property">blackPointCompensation</span> = <span class="hljs-literal">true</span>;
      image.<span class="hljs-property">renderingIntent</span> = <span class="hljs-title class_">RenderingIntent</span>.<span class="hljs-property">Perceptual</span>;
      <span class="hljs-comment">/**
       * 必须同时指定 source 和 target，否则在 safari 下会有 bug
       * https://github.com/dlemstra/magick-wasm/blob/main/src/magick-image.ts#L3976
       * safari canvas 导出的图片无法检测出 icc，会导致转换失败
       */</span>
      <span class="hljs-keyword">const</span> success = image.<span class="hljs-title function_">transformColorSpace</span>(
        rgbProfile,
        cmykProfile,
        <span class="hljs-title class_">ColorTransformMode</span>.<span class="hljs-property">HighRes</span>
      );
      <span class="hljs-keyword">if</span> (!success) {
        message.<span class="hljs-title function_">error</span>(<span class="hljs-string">'色彩空间转换失败！'</span>);
        <span class="hljs-title class_">CustomReport</span>.<span class="hljs-title function_">sendWarning</span>(<span class="hljs-title class_">ArmsLogs</span>.<span class="hljs-property">colorSpaceTransformFailed</span>, {
          <span class="hljs-attr">message</span>: <span class="hljs-string">'色彩空间转换失败！'</span>,
        });
        <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'色彩空间转换失败！'</span>));
      } <span class="hljs-keyword">else</span> {
        image.<span class="hljs-title function_">write</span>(<span class="hljs-title class_">MagickFormat</span>.<span class="hljs-property">Jpeg</span>, <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
          <span class="hljs-comment">// 需要拷贝一份，否则 result 会被 GC 回收</span>
          <span class="hljs-title function_">resolve</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(result));
        });
      }
    });
  });
};
</code></pre>
<p>但是这里有两个坑点需要注意：</p>
<ol>
<li><strong>Safari 下 ICC 检测失败</strong></li>
</ol>
<p>transformColorSpace 在源码中判断了图像是否内嵌了 profile，如果没有嵌入，会直接返回失败。</p>
<blockquote>
<p>源码位置：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdlemstra%2Fmagick-wasm%2Fblob%2Fmain%2Fsrc%2Fmagick-image.ts%23L3976" target="_blank" title="https://github.com/dlemstra/magick-wasm/blob/main/src/magick-image.ts#L3976" ref="nofollow noopener noreferrer">github.com/dlemstra/ma…</a></p>
</blockquote>
<p>在 Chrome 中通过 Canvas 导出的图片，调用 ImageMagick 查询 ICC 文件时可以正常找到，但是通过 Safari 导出的图片则无法检出。</p>
<p>奇怪的是，使用 macOS 自带预览查看颜色描述文件信息时却恰好得到了相反的结果——使用 Safari 导出的图片正确嵌入了 sRGB IEC61966-2.1 文件，而 Chrome 导出的图片却没有显示颜色描述文件。</p>
<blockquote>
<p>这个问题笔者没有深入研究，如果有了解原因的朋友也欢迎在评论区回复解答下疑惑</p>
</blockquote>
<p>因此在 Safari 下 transformColorSpace 方法不会执行任何操作，直接返回了 true。</p>
<p>阅读源码后发现要规避这个问题，只需要同时传入 source 和 target 即可：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">RGB_PROFILE_LOCATION</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">'@/assets/icc/sRGB Color Space Profile.icm'</span>, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>);
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">CMYK_PROFILE_LOCATION</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">'@/assets/icc/JapanColor2001Coated.icc'</span>, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> transformColorSpace = <span class="hljs-keyword">async</span> (<span class="hljs-attr">uint8Array</span>: <span class="hljs-title class_">Uint8Array</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Uint8Array</span>&gt; =&gt; {
  <span class="hljs-keyword">const</span> [rgbProfileUint8Array, cmykProfileUint8Array] = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([
    <span class="hljs-title function_">readFile</span>(<span class="hljs-variable constant_">RGB_PROFILE_LOCATION</span>),
    <span class="hljs-title function_">readFile</span>(<span class="hljs-variable constant_">CMYK_PROFILE_LOCATION</span>),
  ]);
  <span class="hljs-keyword">const</span> rgbProfile = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ColorProfile</span>(rgbProfileUint8Array);
  <span class="hljs-keyword">const</span> cmykProfile = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ColorProfile</span>(cmykProfileUint8Array);

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-title class_">ImageMagick</span>.<span class="hljs-title function_">read</span>(uint8Array, <span class="hljs-title class_">MagickFormat</span>.<span class="hljs-property">Jpeg</span>, <span class="hljs-function">(<span class="hljs-params">image</span>) =&gt;</span> {
      image.<span class="hljs-property">blackPointCompensation</span> = <span class="hljs-literal">true</span>;
      image.<span class="hljs-property">renderingIntent</span> = <span class="hljs-title class_">RenderingIntent</span>.<span class="hljs-property">Perceptual</span>;
      <span class="hljs-comment">/**
       * 必须同时指定 source 和 target，否则在 safari 下会有 bug
       * https://github.com/dlemstra/magick-wasm/blob/main/src/magick-image.ts#L3976
       * safari canvas 导出的图片无法检测出 icc，会导致转换失败
       */</span>
      <span class="hljs-keyword">const</span> success = image.<span class="hljs-title function_">transformColorSpace</span>(
        rgbProfile,
        cmykProfile,
        <span class="hljs-title class_">ColorTransformMode</span>.<span class="hljs-property">HighRes</span>
      );
      <span class="hljs-keyword">if</span> (!success) {
        <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'色彩空间转换失败！'</span>));
      } <span class="hljs-keyword">else</span> {
        image.<span class="hljs-title function_">write</span>(<span class="hljs-title class_">MagickFormat</span>.<span class="hljs-property">Jpeg</span>, resolve);
      }
    });
  });
};
</code></pre>
<p>当然别忘记在代码中留下对应的注释说明，防止后人维护重复踩坑。</p>
<ol start="2">
<li><strong>WASM GC 导致数据丢失</strong></li>
</ol>
<p>image.write 回调中的 data 对象来自 magick-wasm 的内存，它的生命周期不受 JS 控制，回调结束或后续写入时那段内存可能已经被复用/释放。</p>
<p>要解决这个问题也很简单，原地复制一份即可：</p>
<pre><code class="hljs language-typescript" lang="typescript">image.<span class="hljs-title function_">write</span>(<span class="hljs-title class_">MagickFormat</span>.<span class="hljs-property">Jpeg</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
  <span class="hljs-comment">// 需要拷贝一份，否则 result 会被 GC 回收</span>
  <span class="hljs-title function_">resolve</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(data));
});
</code></pre>
<p>同样留下一个贴心的注释，后续只需适配对应的业务代码即可</p>
<h3 data-id="heading-32">4. 性能优化</h3>
<p>功能是实现了，但业务实际用下来还是发现不少问题，主要集中在性能方面。</p>
<p>业务使用的是统一采购的 16G 的 M1 芯片 iMac，按理来讲不会卡，但是深入了解了业务的操作习惯后，发现了几个很有意思的点：</p>
<ul>
<li>业务习惯同时多开 4、5 个标签页，同时操作</li>
<li>业务在页面操作的同时，本地会开着 AI/PS 以方便作图</li>
</ul>
<p>虽然 WebAssembly 运行速度非常快，但它与 JavaScript 共享同一个事件循环（Event Loop）。如果你在主线程直接调用一个耗时较长的 WASM 函数，它依然会阻塞 UI 响应，导致页面卡顿。</p>
<p>在现代浏览器中，同一个域名的不同标签页，通常也是共用的同一个进程，这还会导致，我们在一个标签页下处理图像，同域的其他标签页也无法操作（主线程被阻塞），浏览器还会弹出页面无响应的提示</p>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a72acf0c876e42ad871fbc4d498b4273~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=3394&amp;h=1482&amp;s=820264&amp;e=png&amp;b=3e3c3b" alt="" loading="lazy"/></p>
<p>因此，我们还需要做针对性的性能优化。</p>
<h4 data-id="heading-33">Worker 多线程</h4>
<p>性能优化的第一步，就是将 WebAssembly 从主线程中移出去。我们可以使用 Web Worker 将 WASM 的逻辑单独放在 worker 线程中执行，从而避免阻塞主线程。</p>
<p>想要使用 worker 很简单，你只需要创建一个 <code>worker.js</code> 文件，随后在主线程中使用：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> myWorker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">"worker.js"</span>);
</code></pre>
<p>即可将 worker.js 中的代码放在独立的 worker 线程中执行。</p>
<blockquote>
<p>注意这里不能用 <code>SharedWorker</code>，一方面 Safari 长期以来对 SharedWorker 支持不佳，另一方面 SharedWorker 更多使用在是跨标签通信，或者某些需要共享资源的场景，对于上面提到的多标签并发图像处理反而起到负作用（多个标签共享一个 Worker，处理是串行的），无法最大程度利用现代多核 CPU 的性能。</p>
</blockquote>
<p>此外，由于单个标签页可能会触发多次图像处理，我们还可以使用单例模式减少重复的 WASM 初始化，从而进一步优化性能，代码示例如下：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// Worker 实例</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">workerInstance</span>: <span class="hljs-title class_">Worker</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

<span class="hljs-comment">/**
 * 获取 Worker 实例（单例模式）
 */</span>
<span class="hljs-keyword">const</span> getWorker = (): <span class="hljs-function"><span class="hljs-params">Worker</span> =&gt;</span> {
  <span class="hljs-keyword">if</span> (!workerInstance) {
    workerInstance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">'./magick.worker.ts'</span>, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>), { 
      <span class="hljs-attr">type</span>: <span class="hljs-string">'module'</span> 
    });
    <span class="hljs-comment">// 监听 Worker 返回的消息</span>
    workerInstance.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {};
    <span class="hljs-comment">// 监听 Worker 错误</span>
    workerInstance.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {};
  }
  <span class="hljs-keyword">return</span> workerInstance;
};
</code></pre>
<p><strong>Worker 同源限制</strong></p>
<p>在上线前我们还遇到一个问题，我们的前端构建产物是托管在 OSS 上的，这里使用 new URL 获取到的 worker 资源不同源，导致无法加载。</p>
<p>为了解决这个问题，我们将 worker 内部的逻辑单独抽离到一个 npm 包中，连同依赖项一起打包成 UMD 格式，在业务工程中通过 fetch 方式获取脚本内容。</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">WORKER_URL</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">'@guming/magick-worker/build/umd/index.js'</span>, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>);
<span class="hljs-comment">// Fetch worker 文件内容</span>
<span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-variable constant_">WORKER_URL</span>);
<span class="hljs-keyword">const</span> workerCode = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">text</span>();
<span class="hljs-comment">// 创建 Blob 和 Blob URL</span>
<span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Blob</span>([workerCode], { <span class="hljs-attr">type</span>: <span class="hljs-string">'application/javascript'</span> });
<span class="hljs-keyword">const</span> blobUrl = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);
<span class="hljs-comment">// 创建 Worker</span>
<span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(blobUrl);
</code></pre>
<blockquote>
<p>如果你使用 Vite，也可以使用 Vite 的 <code>import MyWorker from'./worker.js?worker'</code>语法。</p>
<p>或者也可以使用 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fremote-web-worker" target="_blank" title="https://www.npmjs.com/package/remote-web-worker" ref="nofollow noopener noreferrer">remote-web-worker</a> 这样的库来少写点代码。</p>
</blockquote>
<h4 data-id="heading-34">Comlink 零拷贝传输</h4>
<p>Worker 通过 postMessage 与主线程通信，数据传输有两种模式：</p>
<ol>
<li><strong>结构化克隆（Structured Clone）</strong></li>
</ol>
<p>这也是最常用的一种写法，代码示例如下：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'worker.js'</span>);
<span class="hljs-keyword">const</span> imageBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">100</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>);

worker.<span class="hljs-title function_">postMessage</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'process'</span>, <span class="hljs-attr">data</span>: imageBuffer });
</code></pre>
<p>这种方式会为接收方创建一个数据的完整副本。对于 100MB 的图片，传输瞬间会导致内存占用翻倍（变为 200MB）。如果是 5 个标签页同时操作，内存峰值将迅速堆叠，引发浏览器 OOM（内存溢出）崩溃。</p>
<ol start="2">
<li><strong>可转移对象（Transferable Objects）</strong></li>
</ol>
<p>除了结构化克隆之外，worker 还提供了一种允许你直接转交对象内存的方式，代码示例如下：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'worker.js'</span>);
<span class="hljs-keyword">const</span> imageBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">100</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>);

worker.<span class="hljs-title function_">postMessage</span>(
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'process'</span>, <span class="hljs-attr">data</span>: imageBuffer },
  [imageBuffer]  <span class="hljs-comment">// 第二个参数：要转移的对象列表</span>
);

<span class="hljs-comment">// 转移后，imageBuffer 在主线程不可用</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(imageBuffer.<span class="hljs-property">byteLength</span>); <span class="hljs-comment">// 0 —— 所有权已转移</span>
</code></pre>
<p>通过这种方式，我们可以避免对大对象进行拷贝，从而减少通信时上下文结构化的性能开销。</p>
<p>在实际开发工作中，我们通常还需要写一套复杂的事件通信逻辑，来保障和 worker 之间的通信，代码可能长这样：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// 主线程</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">workerInstance</span>: <span class="hljs-title class_">Worker</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
<span class="hljs-keyword">let</span> messageId = <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> pendingRequests = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">number</span>, { <span class="hljs-attr">resolve</span>: <span class="hljs-title class_">Function</span>; <span class="hljs-attr">reject</span>: <span class="hljs-title class_">Function</span> }&gt;();

<span class="hljs-comment">/**
 * 获取 Worker 实例（单例模式）
 */</span>
<span class="hljs-keyword">const</span> getWorker = (): <span class="hljs-function"><span class="hljs-params">Worker</span> =&gt;</span> {
  <span class="hljs-keyword">if</span> (!workerInstance) {
    workerInstance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">'./magick.worker.ts'</span>, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>), { 
      <span class="hljs-attr">type</span>: <span class="hljs-string">'module'</span> 
    });

    <span class="hljs-comment">// 监听 Worker 返回的消息</span>
    workerInstance.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> { id, <span class="hljs-keyword">type</span>, data, error } = event.<span class="hljs-property">data</span>;
      <span class="hljs-keyword">const</span> request = pendingRequests.<span class="hljs-title function_">get</span>(id);

      <span class="hljs-keyword">if</span> (request) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> === <span class="hljs-string">'success'</span>) {
          request.<span class="hljs-title function_">resolve</span>(data);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> === <span class="hljs-string">'error'</span>) {
          request.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(error));
        }
        pendingRequests.<span class="hljs-title function_">delete</span>(id);
      }
    };

    <span class="hljs-comment">// 监听 Worker 错误</span>
    workerInstance.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Worker error:'</span>, error);
      <span class="hljs-comment">// 拒绝所有等待中的请求</span>
      pendingRequests.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">{ reject }</span>) =&gt;</span> <span class="hljs-title function_">reject</span>(error));
      pendingRequests.<span class="hljs-title function_">clear</span>();
    };
  }
  <span class="hljs-keyword">return</span> workerInstance;
};

<span class="hljs-comment">/**
 * 向 Worker 发送消息并等待响应
 */</span>
<span class="hljs-keyword">const</span> sendMessageToWorker = &lt;T&gt;(
  <span class="hljs-attr">method</span>: <span class="hljs-built_in">string</span>, 
  data?: <span class="hljs-built_in">any</span>,
): <span class="hljs-title class_">Promise</span>&lt;T&gt; =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> id = messageId++;
    <span class="hljs-keyword">const</span> worker = <span class="hljs-title function_">getWorker</span>();
    <span class="hljs-comment">// 保存 promise 的 resolve 和 reject</span>
    pendingRequests.<span class="hljs-title function_">set</span>(id, { resolve, reject });
    <span class="hljs-comment">// 发送消息到 Worker</span>
    worker.<span class="hljs-title function_">postMessage</span>({ id, method, data });
  });
};

<span class="hljs-keyword">const</span> initializeWorker = (): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">sendMessageToWorker</span>(<span class="hljs-string">'initializeWorker'</span>);
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> transformColorSpace = (<span class="hljs-attr">uint8Array</span>: <span class="hljs-title class_">Uint8Array</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Uint8Array</span>&gt; =&gt; {
  <span class="hljs-keyword">return</span> sendMessageToWorker&lt;<span class="hljs-title class_">Uint8Array</span>&gt;(<span class="hljs-string">'transformColorSpace'</span>, uint8Array);
};
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// worker</span>
<span class="hljs-keyword">import</span> { initMagick, <span class="hljs-title class_">ImageMagick</span>, <span class="hljs-title class_">MagickImage</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@imagemagick/magick-wasm'</span>;

<span class="hljs-keyword">let</span> initialized = <span class="hljs-literal">false</span>;

<span class="hljs-keyword">const</span> initializeWorker = <span class="hljs-keyword">async</span> (): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; =&gt; {};
<span class="hljs-keyword">const</span> transformColorSpace = <span class="hljs-keyword">async</span> (<span class="hljs-attr">uint8Array</span>: <span class="hljs-title class_">Uint8Array</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Uint8Array</span>&gt; =&gt; {};

<span class="hljs-comment">// 监听主线程的消息</span>
self.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">async</span> (event) =&gt; {
  <span class="hljs-keyword">const</span> { id, method, data } = event.<span class="hljs-property">data</span>;
  
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">let</span> result;
    <span class="hljs-comment">// 根据方法名调用对应的函数</span>
    <span class="hljs-keyword">switch</span> (method) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'initializeWorker'</span>:
        <span class="hljs-keyword">await</span> <span class="hljs-title function_">initializeWorker</span>();
        result = <span class="hljs-literal">undefined</span>;
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'transformColorSpace'</span>:
        result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">transformColorSpace</span>(data);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-attr">default</span>:
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Unknown method: <span class="hljs-subst">${method}</span>`</span>);
    }
    <span class="hljs-comment">// 返回成功结果</span>
    self.<span class="hljs-title function_">postMessage</span>({ id, <span class="hljs-attr">type</span>: <span class="hljs-string">'success'</span>, <span class="hljs-attr">data</span>: result });
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// 返回错误</span>
    self.<span class="hljs-title function_">postMessage</span>({ id, <span class="hljs-attr">type</span>: <span class="hljs-string">'error'</span>, error });
  }
};
</code></pre>
<p>比较复杂，有一定的学习和理解成本。我们可以使用 <code>Comlink</code> 库来封装 worker 的通信逻辑，从而避免手动维护一套事件通信逻辑，代码可以精简如下：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// 主线程</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">Comlink</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'comlink'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">WorkerApi</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./magick.worker'</span>;

<span class="hljs-keyword">let</span> <span class="hljs-attr">workerInstance</span>: <span class="hljs-title class_">Worker</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
<span class="hljs-keyword">let</span> <span class="hljs-attr">workerApi</span>: <span class="hljs-title class_">Comlink</span>.<span class="hljs-property">Remote</span>&lt;<span class="hljs-title class_">WorkerApi</span>&gt; | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

<span class="hljs-keyword">const</span> getWorkerApi = (): <span class="hljs-title class_">Comlink</span>.<span class="hljs-property">Remote</span>&lt;<span class="hljs-title class_">WorkerApi</span>&gt; =&gt; {
  <span class="hljs-keyword">if</span> (!workerApi) {
    workerInstance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">'./magick.worker.ts'</span>, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>), { <span class="hljs-attr">type</span>: <span class="hljs-string">'module'</span> });
    workerApi = <span class="hljs-title class_">Comlink</span>.<span class="hljs-property">wrap</span>&lt;<span class="hljs-title class_">WorkerApi</span>&gt;(workerInstance);
  }
  <span class="hljs-keyword">return</span> workerApi;
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> initializeWorker = <span class="hljs-keyword">async</span> (): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; =&gt; {
  <span class="hljs-keyword">const</span> api = <span class="hljs-title function_">getWorkerApi</span>();
  <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">initializeWorker</span>();
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> transformColorSpace = <span class="hljs-keyword">async</span> (<span class="hljs-attr">uint8Array</span>: <span class="hljs-title class_">Uint8Array</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Uint8Array</span>&gt; =&gt; {
  <span class="hljs-keyword">const</span> api = <span class="hljs-title function_">getWorkerApi</span>();
  <span class="hljs-keyword">return</span> api.<span class="hljs-title function_">transformColorSpace</span>(<span class="hljs-title class_">Comlink</span>.<span class="hljs-title function_">transfer</span>(uint8Array, [uint8Array.<span class="hljs-property">buffer</span>]));
};
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// worker</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">Comlink</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'comlink'</span>;

<span class="hljs-keyword">const</span> initializeWorker = <span class="hljs-keyword">async</span> (): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; =&gt; {};

<span class="hljs-keyword">const</span> transformColorSpace = <span class="hljs-keyword">async</span> (<span class="hljs-attr">uint8Array</span>: <span class="hljs-title class_">Uint8Array</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Uint8Array</span>&gt; =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-title class_">ImageMagick</span>.<span class="hljs-title function_">read</span>(uint8Array, <span class="hljs-title class_">MagickFormat</span>.<span class="hljs-property">Jpeg</span>, <span class="hljs-function">(<span class="hljs-params">image</span>) =&gt;</span> {
      ...
      image.<span class="hljs-title function_">write</span>(<span class="hljs-title class_">MagickFormat</span>.<span class="hljs-property">Jpeg</span>, <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> output = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(result);
        <span class="hljs-comment">// 使用 Transferable，避免大数据复制</span>
        <span class="hljs-title function_">resolve</span>(<span class="hljs-title class_">Comlink</span>.<span class="hljs-title function_">transfer</span>(output, [output.<span class="hljs-property">buffer</span>]));
      });
    });
  });
};

<span class="hljs-keyword">const</span> workerApi = {
  initializeWorker,
  transformColorSpace,
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">WorkerApi</span> = <span class="hljs-keyword">typeof</span> workerApi;

<span class="hljs-title class_">Comlink</span>.<span class="hljs-title function_">expose</span>(workerApi);
</code></pre>
<p>写法非常简单，仿佛根本没有 worker 的存在，Comlink 帮你封装了所有通信的细节。</p>
<h4 data-id="heading-35">静态资源缓存</h4>
<p>原先的 transformColorSpace 写法中，每次执行都会重复请求一次 ICC 文件，我们完全可以将请求做前置缓存，统一放到 <code>initializeWorker</code> 内部，实测下来可以减少每次 2s 以上的重复请求耗时：</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * 初始化 ImageMagick WASM
 */</span>
<span class="hljs-keyword">const</span> initializeWasm = <span class="hljs-keyword">async</span> (<span class="hljs-attr">wasmUrl</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; =&gt; {
  <span class="hljs-keyword">const</span> wasmBytes = <span class="hljs-keyword">await</span> <span class="hljs-title function_">readFile</span>(wasmUrl);
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">initializeImageMagick</span>(wasmBytes);
};

<span class="hljs-comment">/**
 * 初始化 ICC profiles
 */</span>
<span class="hljs-keyword">const</span> initializeProfiles = <span class="hljs-keyword">async</span> (<span class="hljs-attr">rgbProfileUrl</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">cmykProfileUrl</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; =&gt; {
  <span class="hljs-keyword">const</span> [rgbProfileUint8Array, cmykProfileUint8Array] = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([
    <span class="hljs-title function_">readFile</span>(rgbProfileUrl),
    <span class="hljs-title function_">readFile</span>(cmykProfileUrl),
  ]);
  <span class="hljs-keyword">const</span> rgbProfile = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ColorProfile</span>(rgbProfileUint8Array);
  <span class="hljs-keyword">const</span> cmykProfile = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ColorProfile</span>(cmykProfileUint8Array);
  profiles = { <span class="hljs-attr">rgb</span>: rgbProfile, <span class="hljs-attr">cmyk</span>: cmykProfile };
};

<span class="hljs-comment">/**
 * 初始化 Worker
 */</span>
<span class="hljs-keyword">const</span> initializeWorker = <span class="hljs-keyword">async</span> (<span class="hljs-attr">config</span>: {
  <span class="hljs-attr">wasmUrl</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">rgbProfileUrl</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">cmykProfileUrl</span>: <span class="hljs-built_in">string</span>;
}): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; =&gt; {
  <span class="hljs-keyword">if</span> (initialized) <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([
    <span class="hljs-title function_">initializeWasm</span>(config.<span class="hljs-property">wasmUrl</span>),
    <span class="hljs-title function_">initializeProfiles</span>(config.<span class="hljs-property">rgbProfileUrl</span>, config.<span class="hljs-property">cmykProfileUrl</span>),
  ]).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
    initialized = <span class="hljs-literal">true</span>;
  });
};
</code></pre>
<h3 data-id="heading-36">5. 性能测试</h3>
<p>我们将优化前后各操作的性能进行对比，测试基准条件如下：</p>
<ul>
<li>图片大小：127.3MB</li>
<li>芯片：Apple M4</li>
<li>核心数：10（4 性能和 6 能效）</li>
<li>内存：32G</li>
<li>浏览器：Chrome 144.0.7559.110（正式版本） (arm64)</li>
</ul>
<h4 data-id="heading-37">单标签处理性能</h4>









































<table><thead><tr><th>阶段</th><th>主线程方案</th><th>Worker 方案（结构化克隆）</th><th>Worker 方案（零拷贝传输）</th></tr></thead><tbody><tr><td>初始化</td><td>-</td><td>619.20ms</td><td>730.10ms</td></tr><tr><td>图像处理</td><td>42710.70ms(42.71s)</td><td>48494.60ms(48.5s)</td><td>48281.70ms(48.27s)</td></tr><tr><td>通信耗时</td><td>-</td><td>61.40ms</td><td>53.00ms</td></tr><tr><td>组装 Blob</td><td>74.15ms</td><td>140.80ms</td><td>154.00ms</td></tr><tr><td>总耗时</td><td>42784.85ms(42.79s)</td><td>48696.8ms(48.7s)</td><td>48494.60ms(48.5s)</td></tr></tbody></table>
<blockquote>
<p>大图的处理时间稍长，实际上处理 20M 左右的图片，处理速度均控制在 10-20s 内。</p>
</blockquote>
<h4 data-id="heading-38">多标签并发处理性能</h4>



































<table><thead><tr><th>指标</th><th>主线程方案</th><th>Worker 方案</th></tr></thead><tbody><tr><td>标签 1 完成时间</td><td>43.25s</td><td>45.17s</td></tr><tr><td>标签 2 完成时间</td><td>40.39s</td><td>42.28s</td></tr><tr><td>标签 3 完成时间</td><td>无法处理</td><td>41.84s</td></tr><tr><td>全部完成时间</td><td>页面等待超 5 分钟才可以交互</td><td>45.17s</td></tr><tr><td>其他标签是否卡顿</td><td>所有同域标签全部卡死</td><td>否</td></tr></tbody></table>
<h4 data-id="heading-39">内存使用对比</h4>
<p>在 Chrome 中可以使用 performance.memory 获取当前的内存使用情况，其中返回对象的 jsHeapSizeLimit 字段表示当前 JavaScript 页面可以使用的最大堆内存限制。</p>
<p>在 64 位系统中，物理内存大于 16G 的，堆内存最大限制为 4G；小于等于 16G 的，最大堆内存限制为 2G。</p>
<p>在 32位系统中，最大堆内存限制为 1G。</p>
<blockquote>
<p>参考：<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FPerformance%2Fmemory" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/API/Performance/memory" ref="nofollow noopener noreferrer">Performance.memory - Web API | MDN</a></p>
</blockquote>















































<table><thead><tr><th>场景</th><th>主线程方案</th><th>Worker 方案（结构化克隆）</th><th>Worker 方案（零拷贝传输）</th></tr></thead><tbody><tr><td>初始化前</td><td>536.96 MB</td><td>134.92 MB</td><td>153.93 MB</td></tr><tr><td>初始化后</td><td>653.57 MB</td><td>171.09 MB</td><td>156.86 MB</td></tr><tr><td>Blob组装前</td><td>653.57 MB</td><td>238.52 MB</td><td>230.86 MB</td></tr><tr><td>发送前</td><td>3105.70 MB   (对应图像处理中)</td><td>355.71 MB</td><td>348.05 MB</td></tr><tr><td>接收后</td><td/><td>415.65 MB</td><td>364.07 MB</td></tr><tr><td>Blob 组装后</td><td>3105.70 MB</td><td>415.65 MB</td><td>364.07 MB</td></tr></tbody></table>
<p>在主线程方案的测试过程中，第二个标签页在处理图像过程中，堆内存来到了 5492.76 MB，已经超出了 4G 的堆内存限制，这直接导致了第三个标签页的白屏崩溃。而 Worker 方案，页面全部正常展示 Loading，未出现白屏等情况，所有页面几乎同时输出了转换后的图片。</p>
<blockquote>
<p>设计师使用的设备为公司统一采购的 M1 芯片 iMac，16G 内存。</p>
<p>在设计师的机子上 Chrome 最大堆内存限制为 2G，主线程方案仅支持同时开启一个标签页处理</p>
</blockquote>
<h4 data-id="heading-40">优化效果总结</h4>
<ol>
<li><strong>稳定性：突破 4GB 堆内存瓶颈</strong></li>
</ol>
<p>这是本次优化最显著的成果。在 64 位 Chrome 中，即便物理内存高达 32GB，单个标签页的 JS 堆内存限制（<code>jsHeapSizeLimit</code>）通常仍被锁定在 <strong>4GB</strong>。</p>
<p>主线程方案在处理 120MB+ 大图时，瞬时内存飙升至 3.1GB。当开启 3 个标签页并发处理时，内存占用迅速叠加至 5.5GB 左右，触发 OOM，导致浏览器标签页直接<strong>白屏崩溃</strong>。</p>
<p>通过将计算密集型任务移出主线程，主线程内存始终维持在 <strong>300MB-400MB</strong> 的较低水平。Worker 方案成功绕过了单线程堆内存限制，实现了 5 个以上标签页的稳定并发。</p>
<ol start="2">
<li><strong>用户体验：从“全域卡死”到“流畅加载”</strong></li>
</ol>
<p>主线程方案在处理期间，由于执行栈被 ImageMagick 完全阻塞，导致同域下的所有标签页失去响应，用户无法进行任何交互。</p>
<p>Worker 方案虽然在单线程处理耗时上略慢于主线程（约增加 13% 的上下文开销），但它保证了 UI 的绝对响应速度。用户在处理百兆大图的同时，依然可以平滑地切换标签页、点击按钮或观看 Loading 动画。</p>
<ol start="3">
<li><strong>数据传输优化：零拷贝的价值</strong></li>
</ol>
<p>使用结构化克隆时，数据发送前后有 60MB 的内存差值，而零拷贝将内存波动降至 16MB，在大数据量下，这个差距会随着并发量的增加而变得极度明显。</p>
<p>通过使用零拷贝传输，我们避免了 CPU 密集的序列化过程，同时减少了内存峰值和 GC 压力，保证了并发情况下页面的正常使用。</p>
<ol start="4">
<li><strong>综合对比看板</strong></li>
</ol>



































<table><thead><tr><th>维度</th><th>主线程方案</th><th>Worker 方案 (优化后)</th><th>结论</th></tr></thead><tbody><tr><td>单图总耗时</td><td>42.79s</td><td>48.5s</td><td>主线程略快，但牺牲了交互性</td></tr><tr><td>并发可靠性</td><td>极差 (仅支持2次并发)</td><td>极优秀 (并发无压力)</td><td>Worker 解决了生存问题</td></tr><tr><td>主线程内存峰值</td><td>3105.70 MB</td><td>364.07 MB</td><td>降低了 <strong>88%</strong> 的主线程内存压力</td></tr><tr><td>交互体验</td><td>页面完全冻结</td><td>始终流畅</td><td>核心体验提升</td></tr></tbody></table>
<h2 data-id="heading-41">九、总结</h2>
<p>本次需求从一个看似简单的"颜色不对"问题出发，最终演变成了一次涉及色彩科学、图像处理、Web 技术栈选型以及前端性能优化的综合技术攻坚。</p>
<p>回顾整个过程，我们遇到的困难主要集中在三个方面：</p>
<p><strong>技术选型的权衡</strong>：从 Sharp 到 ImageMagick，从 Node.js 到 Python，再到 WebAssembly，每一种方案都有其适用场景和局限性。我们需要在功能完整性、性能表现、开发成本以及基建适配性之间反复权衡。</p>
<p><strong>基础设施的限制</strong>：CI/CD 环境的网络策略、服务器性能、字体授权合规等"非技术"因素，往往会成为技术方案落地的最大障碍。这提醒我们，技术方案的设计不能脱离实际的业务环境。</p>
<p><strong>用户体验的坚守</strong>：最初的服务端方案虽然功能简单完善，但超 100s 的等待时间完全无法接受。正是对用户体验的坚持，驱使我们最终找到了客户端 WASM 方案，并通过性能优化将处理时间大大缩短到 20 秒内。</p>
<p>最终，通过在浏览器端集成 <code>@imagemagick/magick-wasm</code>，我们实现了：</p>
<ul>
<li>完整的 ICC Profile 支持，精确控制色彩转换</li>
<li>统一的渲染意图和黑场补偿配置，转换效果相较专业设计软件（AI/PS）色差低于 1%。</li>
<li>无需服务端参与，避免了网络传输问题和字体合规风险。</li>
<li>本地多线程处理，支持并发图像处理，最大程度利用设备性能。</li>
<li>解决印刷色差问题，节约 80% 设计师重复劳动</li>
</ul>
<p>这次经历让我们深刻认识到：解决问题的过程往往比问题本身更有价值。在探索过程中积累的色彩管理知识、WASM 技术和性能优化经验、以及对业务场景的深入理解，都将成为团队宝贵的技术资产。</p>
<p>更重要的是，这次技术改造不仅解决了燃眉之急，更为后续的图像处理需求奠定了坚实基础。当下次遇到类似的图像处理问题时，我们已经有了一套成熟的解决思路和技术储备。</p>
<p>技术服务业务，业务驱动技术。希望这次实践能为遇到类似问题的朋友们提供一些参考和启发。</p>
<h2 data-id="heading-42">参考文章</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fsharp.pixelplumbing.com%2F" target="_blank" title="https://sharp.pixelplumbing.com/" ref="nofollow noopener noreferrer">High performance Node.js image processing</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fimagemagick.org%2F" target="_blank" title="https://imagemagick.org/" ref="nofollow noopener noreferrer">ImageMagick | Mastering Digital Image Alchemy</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.adobeacp.com%2Fcontent%2Fnews%3Fid%3D1658793062537074" target="_blank" title="https://www.adobeacp.com/content/news?id=1658793062537074" ref="nofollow noopener noreferrer">Photoshop功能|使用颜色配置文件</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.wasmer.io%2Fsdk%2Fwasmer-js%2Fexplainers%2Ftroubleshooting%23sharedarraybuffer-and-cross-origin-isolation" target="_blank" title="https://docs.wasmer.io/sdk/wasmer-js/explainers/troubleshooting#sharedarraybuffer-and-cross-origin-isolation" ref="nofollow noopener noreferrer">Troubleshooting Common Problems</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D5zGfsED7M7U" target="_blank" title="https://www.youtube.com/watch?v=5zGfsED7M7U" ref="nofollow noopener noreferrer">Relative Colorimetric or Perceptual? Which Rendering Intent Should I Use? - YouTube</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D3bY8MVHf0JM%26feature%3Dyoutu.be" target="_blank" title="https://www.youtube.com/watch?v=3bY8MVHf0JM&amp;feature=youtu.be" ref="nofollow noopener noreferrer">What is LAB Color Space? [HD] - YouTube</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F166413369" target="_blank" title="https://zhuanlan.zhihu.com/p/166413369" ref="nofollow noopener noreferrer">浅谈显示器色域：从sRGB到广色域 - 知乎</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FWeb_Workers_API%2FTransferable_objects" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/API/Web_Workers_API/Transferable_objects" ref="nofollow noopener noreferrer">可转移对象 - Web API | MDN</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RustFS高可用集群部署实战：轻松搭建企业级分布式存储架构]]></title>    <link>https://juejin.cn/post/7603699739223916559</link>    <guid>https://juejin.cn/post/7603699739223916559</guid>    <pubDate>2026-02-08T13:05:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603699739223916559" data-draft-id="7603854784864649256" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RustFS高可用集群部署实战：轻松搭建企业级分布式存储架构"/> <!----> <meta itemprop="datePublished" content="2026-02-08T13:05:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="对象存储与RustFS"/> <meta itemprop="url" content="https://juejin.cn/user/652466093570057"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RustFS高可用集群部署实战：轻松搭建企业级分布式存储架构
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/652466093570057/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    对象存储与RustFS
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T13:05:35.000Z" title="Sun Feb 08 2026 13:05:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">RustFS高可用集群部署实战：轻松搭建企业级分布式存储架构</h2>
<p>最近在技术群里看到很多小伙伴在问RustFS集群部署的问题，今天我就把自己在生产环境踩坑总结的集群方案分享给大家。别看是分布式架构，其实比想象中简单多了！</p>
<h3 data-id="heading-1">为什么需要集群部署？</h3>
<p>先讲个真实案例：上个月我们公司单机版RustFS因为硬盘故障导致服务中断6小时，损失惨重。痛定思痛，我花了一周时间研究出了这套高可用方案，现在就算挂掉2个节点都能正常服务！</p>
<h3 data-id="heading-2">集群架构设计</h3>
<h4 data-id="heading-3">最小生产集群（4节点推荐）</h4>
<pre><code class="hljs language-markdown" lang="markdown">┌─────────────────┐
│   负载均衡器     │
│   (Nginx/Haproxy) │
└─────────────────┘
<span class="hljs-code">         ↓
┌───────┬───────┬───────┬───────┐
│ 节点1 │ 节点2 │ 节点3 │ 节点4 │
│ 数据+元数据 │数据+元数据│纯数据节点│纯数据节点│
└───────┴───────┴───────┴───────┘
</span></code></pre>
<p><strong>为什么选4节点？</strong></p>
<ul>
<li>满足纠删码最低要求（4+2模式）</li>
<li>成本与性能的最佳平衡</li>
<li>故障容忍度高（可同时挂2个节点）</li>
</ul>
<h3 data-id="heading-4">环境准备</h3>
<h4 data-id="heading-5">服务器配置（最低要求）</h4>
<pre><code class="hljs language-scss" lang="scss"># <span class="hljs-number">4</span>台CentOS <span class="hljs-number">7.9</span>服务器
节点<span class="hljs-number">1</span>：<span class="hljs-number">10.0</span><span class="hljs-selector-class">.1</span><span class="hljs-selector-class">.11</span> (元数据+数据)
节点<span class="hljs-number">2</span>：<span class="hljs-number">10.0</span><span class="hljs-selector-class">.1</span><span class="hljs-selector-class">.12</span> (元数据+数据)  
节点<span class="hljs-number">3</span>：<span class="hljs-number">10.0</span><span class="hljs-selector-class">.1</span><span class="hljs-selector-class">.13</span> (数据节点)
节点<span class="hljs-number">4</span>：<span class="hljs-number">10.0</span><span class="hljs-selector-class">.1</span><span class="hljs-selector-class">.14</span> (数据节点)

# 每台服务器配置
CPU：<span class="hljs-number">4</span>核以上
内存：<span class="hljs-number">8</span>GB以上
磁盘：<span class="hljs-number">100</span>GB系统盘 + <span class="hljs-number">500</span>GB数据盘（SSD推荐）
网络：千兆内网互通
</code></pre>
<h4 data-id="heading-6">系统优化配置</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 所有节点执行</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"net.core.somaxconn = 1024"</span> &gt;&gt; /etc/sysctl.conf
<span class="hljs-built_in">echo</span> <span class="hljs-string">"net.ipv4.tcp_max_syn_backlog = 1024"</span> &gt;&gt; /etc/sysctl.conf
<span class="hljs-built_in">echo</span> <span class="hljs-string">"vm.swappiness = 10"</span> &gt;&gt; /etc/sysctl.conf
sysctl -p

<span class="hljs-comment"># 优化磁盘IO</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"deadline"</span> &gt; /sys/block/sdb/queue/scheduler
</code></pre>
<h3 data-id="heading-7">集群部署实战</h3>
<h4 data-id="heading-8">1. 创建共享配置文件</h4>
<p>先准备一个统一的 <code>docker-compose.cluster.yml</code>：</p>
<pre><code class="hljs language-yml" lang="yml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3.8'</span>
<span class="hljs-attr">services:</span>
  <span class="hljs-attr">rustfs:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">rustfs/rustfs:1.0.0-alpha.69</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">rustfs</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>
    <span class="hljs-attr">network_mode:</span> <span class="hljs-string">"host"</span>
    
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/data/rustfs/data:/data</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/data/rustfs/logs:/logs</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/etc/localtime:/etc/localtime:ro</span>
    
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">RUSTFS_CLUSTER_ENABLED=true</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">RUSTFS_CLUSTER_NAME=rustfs-prod</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">RUSTFS_API_ENDPOINT=http://10.0.1.11:9000</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">RUSTFS_ACCESS_KEY=prod_access_key_2024</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">RUSTFS_SECRET_KEY=your_super_secure_secret_key_here</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">RUSTFS_BROWSER=on</span>
      
    <span class="hljs-attr">deploy:</span>
      <span class="hljs-attr">resources:</span>
        <span class="hljs-attr">limits:</span>
          <span class="hljs-attr">memory:</span> <span class="hljs-string">4G</span>
          <span class="hljs-attr">cpus:</span> <span class="hljs-string">'2.0'</span>
</code></pre>
<h4 data-id="heading-9">2. 节点差异化配置</h4>
<p><strong>节点1（10.0.1.11）配置：</strong></p>
<pre><code class="hljs language-yml" lang="yml"><span class="hljs-comment"># 在共享配置基础上添加</span>
<span class="hljs-attr">environment:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">RUSTFS_CLUSTER_MASTER=true</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">RUSTFS_METADATA_ENDPOINTS=10.0.1.11:9000,10.0.1.12:9000</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">RUSTFS_DATA_ENDPOINTS=10.0.1.11:9000,10.0.1.12:9000,10.0.1.13:9000,10.0.1.14:9000</span>
</code></pre>
<p><strong>节点2（10.0.1.12）配置：</strong></p>
<pre><code class="hljs language-yml" lang="yml"><span class="hljs-attr">environment:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">RUSTFS_CLUSTER_BACKUP_MASTER=true</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">RUSTFS_METADATA_ENDPOINTS=10.0.1.11:9000,10.0.1.12:9000</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">RUSTFS_DATA_ENDPOINTS=10.0.1.11:9000,10.0.1.12:9000,10.0.1.13:9000,10.0.1.14:9000</span>
</code></pre>
<p><strong>数据节点（10.0.1.13/14）配置：</strong></p>
<pre><code class="hljs language-yml" lang="yml"><span class="hljs-attr">environment:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">RUSTFS_DATA_NODE=true</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">RUSTFS_METADATA_ENDPOINTS=10.0.1.11:9000,10.0.1.12:9000</span>
</code></pre>
<h4 data-id="heading-10">3. 初始化集群部署脚本</h4>
<p>创建 <code>deploy-cluster.sh</code>：</p>
<pre><code class="hljs language-sh" lang="sh"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-built_in">set</span> -e

NODES=(<span class="hljs-string">"10.0.1.11"</span> <span class="hljs-string">"10.0.1.12"</span> <span class="hljs-string">"10.0.1.13"</span> <span class="hljs-string">"10.0.1.14"</span>)
MASTER_NODE=<span class="hljs-string">"10.0.1.11"</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"开始部署RustFS集群..."</span>

<span class="hljs-comment"># 1. 准备数据目录</span>
<span class="hljs-keyword">for</span> node <span class="hljs-keyword">in</span> <span class="hljs-string">"<span class="hljs-variable">${NODES[@]}</span>"</span>; <span class="hljs-keyword">do</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"准备节点: <span class="hljs-variable">$node</span>"</span>
    ssh root@<span class="hljs-variable">$node</span> <span class="hljs-string">"mkdir -p /data/rustfs/{data,logs,config} &amp;&amp; chown -R 10001:10001 /data/rustfs"</span>
<span class="hljs-keyword">done</span>

<span class="hljs-comment"># 2. 分发配置文件</span>
scp docker-compose.cluster.yml root@<span class="hljs-variable">$MASTER_NODE</span>:/data/rustfs/
scp docker-compose.data.yml root@10.0.1.13:/data/rustfs/docker-compose.yml
scp docker-compose.data.yml root@10.0.1.14:/data/rustfs/docker-compose.yml

<span class="hljs-comment"># 3. 按顺序启动节点</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"启动元数据节点..."</span>
ssh root@10.0.1.11 <span class="hljs-string">"cd /data/rustfs &amp;&amp; docker-compose up -d"</span>
<span class="hljs-built_in">sleep</span> 10

ssh root@10.0.1.12 <span class="hljs-string">"cd /data/rustfs &amp;&amp; docker-compose up -d"</span>  
<span class="hljs-built_in">sleep</span> 10

<span class="hljs-built_in">echo</span> <span class="hljs-string">"启动数据节点..."</span>
ssh root@10.0.1.13 <span class="hljs-string">"cd /data/rustfs &amp;&amp; docker-compose up -d"</span>
ssh root@10.0.1.14 <span class="hljs-string">"cd /data/rustfs &amp;&amp; docker-compose up -d"</span>

<span class="hljs-comment"># 4. 等待集群就绪</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"等待集群初始化..."</span>
<span class="hljs-built_in">sleep</span> 30

<span class="hljs-comment"># 5. 验证集群状态</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"检查集群状态..."</span>
curl -f http://<span class="hljs-variable">$MASTER_NODE</span>:9000/minio/cluster/status

<span class="hljs-built_in">echo</span> <span class="hljs-string">"🎉 RustFS集群部署完成！"</span>
</code></pre>
<h3 data-id="heading-11">负载均衡配置</h3>
<h4 data-id="heading-12">Nginx负载均衡</h4>
<pre><code class="hljs language-ini" lang="ini">upstream rustfs_cluster {
    server 10.0.1.11:9000 <span class="hljs-attr">max_fails</span>=<span class="hljs-number">3</span> fail_timeout=<span class="hljs-number">30</span>s<span class="hljs-comment">;</span>
    server 10.0.1.12:9000 <span class="hljs-attr">max_fails</span>=<span class="hljs-number">3</span> fail_timeout=<span class="hljs-number">30</span>s<span class="hljs-comment">;</span>
    server 10.0.1.13:9000 <span class="hljs-attr">max_fails</span>=<span class="hljs-number">3</span> fail_timeout=<span class="hljs-number">30</span>s<span class="hljs-comment">;</span>
    server 10.0.1.14:9000 <span class="hljs-attr">max_fails</span>=<span class="hljs-number">3</span> fail_timeout=<span class="hljs-number">30</span>s<span class="hljs-comment">;</span>
    
    <span class="hljs-comment"># 会话保持（重要！）</span>
    ip_hash<span class="hljs-comment">;</span>
}

server {
    listen 80<span class="hljs-comment">;</span>
    server_name rustfs.yourcompany.com<span class="hljs-comment">;</span>
    
    location / {
        proxy_pass http://rustfs_cluster<span class="hljs-comment">;</span>
        proxy_set_header Host $host<span class="hljs-comment">;</span>
        proxy_set_header X-Real-IP $remote_addr<span class="hljs-comment">;</span>
        proxy_connect_timeout 30s<span class="hljs-comment">;</span>
        proxy_read_timeout 300s<span class="hljs-comment">;</span>
    }
    
    <span class="hljs-comment"># 健康检查</span>
    location /minio/health/live {
        proxy_pass http://rustfs_cluster<span class="hljs-comment">;</span>
        access_log off<span class="hljs-comment">;</span>
    }
}
</code></pre>
<h3 data-id="heading-13">数据安全与备份</h3>
<h4 data-id="heading-14">纠删码配置</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># 在master节点配置</span>
environment:
  - <span class="hljs-attr">RUSTFS_ERASURE_CODING</span>=<span class="hljs-number">4</span>:<span class="hljs-number">2</span>  <span class="hljs-comment"># 4个数据块，2个校验块</span>
  - <span class="hljs-attr">RUSTFS_DATA_SHARDS</span>=<span class="hljs-number">4</span>
  - <span class="hljs-attr">RUSTFS_PARITY_SHARDS</span>=<span class="hljs-number">2</span>
</code></pre>
<h4 data-id="heading-15">自动备份策略</h4>
<p>创建 <code>cluster-backup.sh</code>：</p>
<pre><code class="hljs language-sh" lang="sh"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># 集群元数据备份</span>
BACKUP_DIR=<span class="hljs-string">"/backup/rustfs/<span class="hljs-subst">$(date +%Y%m%d)</span>"</span>
<span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$BACKUP_DIR</span>

<span class="hljs-comment"># 1. 备份元数据节点配置</span>
<span class="hljs-keyword">for</span> node <span class="hljs-keyword">in</span> <span class="hljs-string">"10.0.1.11"</span> <span class="hljs-string">"10.0.1.12"</span>; <span class="hljs-keyword">do</span>
    ssh root@<span class="hljs-variable">$node</span> <span class="hljs-string">"docker exec rustfs tar czf /tmp/metadata.tar.gz /data/.metadata"</span>
    scp root@<span class="hljs-variable">$node</span>:/tmp/metadata.tar.gz <span class="hljs-variable">$BACKUP_DIR</span>/metadata_<span class="hljs-variable">${node}</span>.tar.gz
<span class="hljs-keyword">done</span>

<span class="hljs-comment"># 2. 备份负载均衡配置</span>
<span class="hljs-built_in">cp</span> /etc/nginx/conf.d/rustfs.conf <span class="hljs-variable">$BACKUP_DIR</span>/

<span class="hljs-comment"># 3. 上传到远程存储（可选）</span>
rclone copy <span class="hljs-variable">$BACKUP_DIR</span> oss:rustfs-backup/ --progress

<span class="hljs-built_in">echo</span> <span class="hljs-string">"备份完成: <span class="hljs-variable">$BACKUP_DIR</span>"</span>
</code></pre>
<h3 data-id="heading-16">监控告警体系</h3>
<h4 data-id="heading-17">Prometheus监控配置</h4>
<pre><code class="hljs language-yml" lang="yml"><span class="hljs-comment"># prometheus.yml</span>
<span class="hljs-attr">scrape_configs:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">'rustfs-cluster'</span>
    <span class="hljs-attr">static_configs:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span> 
        <span class="hljs-bullet">-</span> <span class="hljs-string">'10.0.1.11:9000'</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">'10.0.1.12:9000'</span> 
        <span class="hljs-bullet">-</span> <span class="hljs-string">'10.0.1.13:9000'</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">'10.0.1.14:9000'</span>
    <span class="hljs-attr">metrics_path:</span> <span class="hljs-string">/minio/metrics/cluster</span>
</code></pre>
<h4 data-id="heading-18">Grafana监控看板</h4>
<p>关键监控指标：</p>
<ul>
<li>节点在线状态</li>
<li>存储空间使用率</li>
<li>请求延迟分布</li>
<li>错误率统计</li>
</ul>
<h3 data-id="heading-19">故障恢复演练</h3>
<h4 data-id="heading-20">模拟节点故障恢复</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. 停止一个数据节点</span>
ssh root@10.0.1.13 <span class="hljs-string">"docker-compose down"</span>

<span class="hljs-comment"># 2. 观察集群状态（应该自动切换到其他节点）</span>
curl http://10.0.1.11:9000/minio/cluster/status

<span class="hljs-comment"># 3. 恢复节点</span>
ssh root@10.0.1.13 <span class="hljs-string">"docker-compose up -d"</span>

<span class="hljs-comment"># 4. 数据同步验证</span>
ssh root@10.0.1.13 <span class="hljs-string">"docker logs rustfs --tail=100 | grep sync"</span>
</code></pre>
<h3 data-id="heading-21">常见问题排坑指南</h3>
<h4 data-id="heading-22">问题1：节点间网络不通</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 检查网络连通性</span>
<span class="hljs-keyword">for</span> node <span class="hljs-keyword">in</span> 11 12 13 14; <span class="hljs-keyword">do</span>
    ping -c 3 10.0.1.<span class="hljs-variable">$node</span>
    telnet 10.0.1.<span class="hljs-variable">$node</span> 9000
<span class="hljs-keyword">done</span>

<span class="hljs-comment"># 解决方案：配置防火墙</span>
firewall-cmd --add-port=9000/tcp --permanent
firewall-cmd --add-port=9001/tcp --permanent  
firewall-cmd --reload
</code></pre>
<h4 data-id="heading-23">问题2：数据同步失败</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 检查节点时间同步</span>
timedatectl status

<span class="hljs-comment"># 强制时间同步</span>
ntpdate pool.ntp.org

<span class="hljs-comment"># 检查磁盘空间</span>
<span class="hljs-built_in">df</span> -h /data/rustfs
</code></pre>
<h4 data-id="heading-24">问题3：负载不均衡</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 调整负载均衡策略</span>
upstream rustfs_cluster {
    least_conn;  <span class="hljs-comment"># 最少连接数策略</span>
    server 10.0.1.11:9000 weight=2;  <span class="hljs-comment"># 主节点权重更高</span>
    server 10.0.1.12:9000 weight=2;
    server 10.0.1.13:9000 weight=1;
    server 10.0.1.14:9000 weight=1;
}
</code></pre>
<h3 data-id="heading-25">性能优化建议</h3>
<h4 data-id="heading-26">生产环境调优</h4>
<pre><code class="hljs language-bash" lang="bash">environment:
  - RUSTFS_CACHE_SIZE=2G  <span class="hljs-comment"># 根据内存调整</span>
  - RUSTFS_MAX_CONNECTIONS=1000
  - RUSTFS_READ_AFTER_WRITE_QUORUM=2
  - RUSTFS_WRITE_QUORUM=3
</code></pre>
<h3 data-id="heading-27">总结</h3>
<p>通过这套集群方案，我们实现了：</p>
<ul>
<li>✅ 高可用：单节点故障不影响服务</li>
<li>✅ 数据安全：纠删码保证数据可靠性</li>
<li>✅ 弹性扩展：随时添加新节点</li>
<li>✅ 监控告警：实时掌握集群状态</li>
</ul>
<p>​<strong>部署建议</strong>：</p>
<ol>
<li>先在小规模环境测试验证</li>
<li>生产环境务必做好备份</li>
<li>定期进行故障演练</li>
<li>关注RustFS版本更新</li>
</ol>
<p>这套方案在我们生产环境稳定运行了3个月，经历了多次硬件故障考验。如果你在部署过程中遇到问题，欢迎在评论区交流！</p>
<p>觉得有用的话给个三连，下次分享RustFS的性能调优实战！</p>
<hr/>
<p>以下是深入学习 RustFS 的推荐资源：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Frustfs%2Frustfs" target="_blank" title="https://github.com/rustfs/rustfs" ref="nofollow noopener noreferrer">RustFS</a></p>
<p>官方文档： <a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Fdocs.rustfs.com%2F" target="_blank" title="https://link.zhihu.com/?target=https%3A//docs.rustfs.com/" ref="nofollow noopener noreferrer">RustFS 官方文档</a>- 提供架构、安装指南和 API 参考。</p>
<p>GitHub 仓库： <a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Fdocs.rustfs.com%2F" target="_blank" title="https://link.zhihu.com/?target=https%3A//docs.rustfs.com/" ref="nofollow noopener noreferrer">GitHub 仓库</a> - 获取源代码、提交问题或贡献代码。</p>
<p>社区支持： <a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Fgithub.com%2Forgs%2Frustfs%2Fdiscussions" target="_blank" title="https://link.zhihu.com/?target=https%3A//github.com/orgs/rustfs/discussions" ref="nofollow noopener noreferrer">GitHub Discussions</a>- 与开发者交流经验和解决方案。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <!----></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Java基础-9：深入 Java 虚拟机（JVM）：从底层源码到核心原理的全面解析]]></title>    <link>https://juejin.cn/post/7603677143215046671</link>    <guid>https://juejin.cn/post/7603677143215046671</guid>    <pubDate>2026-02-08T14:00:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603677143215046671" data-draft-id="7603699739223982095" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Java基础-9：深入 Java 虚拟机（JVM）：从底层源码到核心原理的全面解析"/> <meta itemprop="keywords" content="后端,Java"/> <meta itemprop="datePublished" content="2026-02-08T14:00:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="beata"/> <meta itemprop="url" content="https://juejin.cn/user/1839900247461280"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Java基础-9：深入 Java 虚拟机（JVM）：从底层源码到核心原理的全面解析
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1839900247461280/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    beata
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T14:00:34.000Z" title="Sun Feb 08 2026 14:00:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读11分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">引言：为什么需要理解 JVM？</h2>
<p>Java 的“一次编写，到处运行”并非魔法，而是由 <strong>Java 虚拟机（JVM）</strong> 这一精妙的运行时环境实现的。然而，许多开发者仅停留在 <code>java -jar</code> 启动应用的层面，对 JVM 内部如何加载类、分配内存、执行字节码、回收垃圾一无所知。这导致在面对 <strong>OOM（OutOfMemoryError）</strong>、<strong>高 CPU 占用</strong>、<strong>GC 频繁停顿</strong> 等问题时束手无策。</p>
<p>本文将带你<strong>深入 JVM 底层</strong>，结合 <strong>HotSpot 源码</strong>（OpenJDK 主流实现）与<strong>核心原理</strong>，系统性地揭开 JVM 的神秘面纱。我们将从启动流程、内存模型、类加载、执行引擎到垃圾回收，层层递进，真正理解“Java 是如何跑起来的”。</p>
<hr/>
<h2 data-id="heading-1">一、JVM 是什么？—— 架构总览</h2>
<p>JVM 并非一个单一程序，而是一个<strong>规范 + 实现</strong>。目前最主流的实现是 <strong>HotSpot VM</strong>（由 Oracle 维护，集成于 OpenJDK/Oracle JDK）。</p>
<h3 data-id="heading-2">HotSpot 的核心组件（C++ 实现）</h3>



































<table><thead><tr><th>组件</th><th>功能</th><th>源码位置（OpenJDK）</th></tr></thead><tbody><tr><td><strong>Class Loader Subsystem</strong></td><td>加载 <code>.class</code> 字节码</td><td><code>src/hotspot/share/classfile/</code></td></tr><tr><td><strong>Runtime Data Areas</strong></td><td>运行时内存布局</td><td><code>src/hotspot/share/memory/</code></td></tr><tr><td><strong>Execution Engine</strong></td><td>执行字节码（解释器 + JIT）</td><td><code>src/hotspot/share/interpreter/</code>, <code>src/hotspot/share/opto/</code></td></tr><tr><td><strong>Garbage Collector</strong></td><td>自动内存管理</td><td><code>src/hotspot/share/gc/</code></td></tr><tr><td><strong>Native Interface (JNI)</strong></td><td>调用本地 C/C++ 代码</td><td><code>src/hotspot/share/prims/</code></td></tr></tbody></table>
<blockquote>
<p>🔍 <strong>提示</strong>：OpenJDK 源码可在 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenjdk%2Fjdk" target="_blank" title="https://github.com/openjdk/jdk" ref="nofollow noopener noreferrer">github.com/openjdk/jdk</a> 查看。</p>
</blockquote>
<hr/>
<h2 data-id="heading-3">二、JVM 启动流程：从 <code>java</code> 命令到 main 方法</h2>
<p>当你执行 <code>java MyApp</code> 时，JVM 经历了以下关键步骤：</p>
<ol>
<li><strong>启动 Launcher（C 语言）</strong><br/>
<code>java.c</code> → <code>JLI_Launch()</code> → 初始化 JVM 参数、classpath。</li>
<li><strong>创建 JVM 实例（JNI_CreateJavaVM）</strong><br/>
调用 <code>Threads::create_vm()</code>（位于 <code>thread.cpp</code>），完成：
<ul>
<li>初始化堆内存</li>
<li>创建主线程（main thread）</li>
<li>启动解释器</li>
</ul>
</li>
<li><strong>加载主类（MyApp.class）</strong><br/>
通过 <code>SystemDictionary::resolve_or_fail()</code> 加载并链接 <code>MyApp</code>。</li>
<li><strong>调用 main 方法</strong><br/>
通过 JNI 反射机制：<code>env-&gt;CallStaticVoidMethod(cls, main_id, args)</code>。</li>
</ol>
<blockquote>
<p>💡 <strong>关键点</strong>：JVM 本身是用 C++ 编写的，但其“灵魂”——字节码执行和 GC——大量使用汇编优化。</p>
</blockquote>
<hr/>
<h2 data-id="heading-4">三、运行时数据区：JVM 的内存布局（HotSpot 实现）</h2>
<p>JVM 规范定义了逻辑内存区域，HotSpot 对其进行了高效实现：</p>
<pre><code class="hljs language-plaintext" lang="plaintext">+---------------------------------+
|            Method Area          | ← 存储类元数据（JDK8+ 为 Metaspace，使用 native memory）
+---------------------------------+
|              Heap               | ← 所有对象实例、数组（分代：Young/Old）
+---------------------------------+
| Thread 1: Java Virtual Machine Stack | ← 线程私有，栈帧（Frame）包含局部变量表、操作数栈
| Thread 2: Java Virtual Machine Stack |
| ...                             |
+---------------------------------+
|        PC Register (per thread) | ← 记录当前执行的字节码指令地址
+---------------------------------+
|     Native Method Stack         | ← 用于 JNI 调用
+---------------------------------+
</code></pre>
<h3 data-id="heading-5">关键细节（源码视角）</h3>
<ul>
<li><strong>堆初始化</strong>：<code>Universe::initialize_heap()</code>（<code>universe.cpp</code>）<br/>
根据 GC 类型（G1/ZGC等）创建不同结构的堆。</li>
<li><strong>栈帧创建</strong>：<code>InterpreterRuntime::new_frame()</code><br/>
每次方法调用，JVM 在当前线程栈上 push 一个新帧。</li>
<li><strong>Metaspace</strong>：<code>Metaspace::allocate()</code><br/>
使用 <code>mmap()</code> 直接向操作系统申请内存，避免 OOM 导致 JVM 崩溃。</li>
</ul>
<h3 data-id="heading-6">补充说明：运行时数据区详解</h3>
<p>JVM 的运行时数据区是程序执行的“舞台”，所有变量、对象、方法调用都依赖于这一内存模型。值得注意的是，<strong>JVM 规范只定义了逻辑结构，具体实现由各虚拟机厂商决定</strong>。HotSpot 作为事实标准，其内存管理高度优化，但也带来了理解上的复杂性。</p>
<h4 data-id="heading-7">线程私有 vs 线程共享</h4>
<ul>
<li>
<p><strong>线程私有区域</strong>（每个线程独立拥有）：</p>
<ul>
<li><strong>程序计数器（PC Register）</strong>：<br/>
这是唯一一个在 JVM 规范中<strong>不会发生 OutOfMemoryError</strong> 的区域。它记录当前线程正在执行的字节码指令地址。如果是 native 方法，则值为 undefined。</li>
<li><strong>Java 虚拟机栈（Java Virtual Machine Stack）</strong>：<br/>
每次方法调用都会创建一个<strong>栈帧（Stack Frame）</strong>。栈帧包含：
<ul>
<li><strong>局部变量表（Local Variable Table）</strong>：以 slot 为单位存储基本类型、对象引用（非对象本身！）。</li>
<li><strong>操作数栈（Operand Stack）</strong>：用于字节码指令的计算（如 <code>iadd</code> 从栈顶弹出两个 int 相加后压回）。</li>
<li><strong>动态链接（Dynamic Linking）</strong>：指向运行时常量池的引用，支持方法调用时的符号解析。</li>
<li><strong>方法返回地址</strong>：用于正常或异常返回时恢复上层调用。</li>
</ul>
<blockquote>
<p>⚠️ 栈溢出（<code>StackOverflowError</code>）通常由无限递归或过深调用链引起；而 <code>-Xss</code> 参数可调整单个线程栈大小。</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p><strong>线程共享区域</strong>（所有线程共用）：</p>
<ul>
<li><strong>堆（Heap）</strong>：<br/>
几乎所有对象实例和数组都在此分配（JIT 逃逸分析可能导致栈上分配例外）。它是 GC 的主战场，也是 OOM 最常发生的区域。</li>
<li><strong>方法区（Method Area）</strong>：<br/>
存储<strong>类的元数据</strong>，包括：
<ul>
<li>类的全限定名、父类、接口</li>
<li>字段和方法信息（含字节码）</li>
<li>常量池（Constant Pool）</li>
<li>静态变量（注意：JDK 7+ 已将字符串常量池移入堆）</li>
</ul>
<blockquote>
<p>🔥 <strong>Metaspace 的革命性改进</strong>：<br/>
JDK 8 彻底废弃了“永久代（PermGen）”，改用 <strong>Metaspace</strong> —— 它不再受限于 JVM 堆内存，而是直接使用操作系统的本地内存（native memory）。这意味着：</p>
<ul>
<li>不再因“永久代满”导致 Full GC；</li>
<li>可通过 <code>-XX:MaxMetaspaceSize</code> 限制其上限（默认无限制，可能耗尽物理内存）；</li>
<li>元数据分配失败会抛出 <code>java.lang.OutOfMemoryError: Metaspace</code>，而非旧版的 <code>PermGen space</code>。</li>
</ul>
</blockquote>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>💡 <strong>实践提示</strong>：<br/>
使用 <code>jcmd &lt;pid&gt; VM.metaspace</code> 可实时查看 Metaspace 使用情况；<br/>
在微服务或热部署频繁的场景中，务必监控 Metaspace，防止类加载器泄漏（ClassLoader Leak）。</p>
</blockquote>
<hr/>
<h2 data-id="heading-8">四、类加载机制：双亲委派与字节码验证</h2>
<h3 data-id="heading-9">1. 类加载器层次</h3>
<pre><code class="hljs language-java" lang="java">Bootstrap <span class="hljs-title function_">ClassLoader</span> <span class="hljs-params">(C++)</span> 
    ↑
Extension <span class="hljs-title function_">ClassLoader</span> <span class="hljs-params">(sun.misc.Launcher$ExtClassLoader)</span>
    ↑
Application <span class="hljs-title function_">ClassLoader</span> <span class="hljs-params">(sun.misc.Launcher$AppClassLoader)</span>
</code></pre>
<h3 data-id="heading-10">2. 双亲委派模型（源码：<code>ClassLoader.loadClass()</code>）</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> Class&lt;?&gt; loadClass(String name, <span class="hljs-type">boolean</span> resolve) {
    <span class="hljs-keyword">synchronized</span> (getClassLoadingLock(name)) {
        <span class="hljs-comment">// 1. 先检查是否已加载</span>
        Class&lt;?&gt; c = findLoadedClass(name);
        <span class="hljs-keyword">if</span> (c == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// 2. 委托父加载器</span>
                <span class="hljs-keyword">if</span> (parent != <span class="hljs-literal">null</span>) {
                    c = parent.loadClass(name, <span class="hljs-literal">false</span>);
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-comment">// 3. 顶层委托给 Bootstrap</span>
                    c = findBootstrapClassOrNull(name);
                }
            } <span class="hljs-keyword">catch</span> (ClassNotFoundException e) {}
            <span class="hljs-keyword">if</span> (c == <span class="hljs-literal">null</span>) {
                <span class="hljs-comment">// 4. 自己加载</span>
                c = findClass(name);
            }
        }
        <span class="hljs-keyword">if</span> (resolve) resolveClass(c);
        <span class="hljs-keyword">return</span> c;
    }
}
</code></pre>
<blockquote>
<p>✅ <strong>目的</strong>：防止用户自定义 <code>java.lang.String</code> 覆盖核心类，保障安全。</p>
</blockquote>
<h3 data-id="heading-11">3. 字节码验证（Verification）</h3>
<p>在 <code>ClassFileParser::parseClassFile()</code> 中，JVM 会对字节码进行四阶段验证：</p>
<ol>
<li>文件格式验证（魔数、版本）</li>
<li>元数据验证（继承关系、final 方法）</li>
<li>字节码验证（操作数栈溢出、类型匹配）</li>
<li>符号引用验证（链接阶段）</li>
</ol>
<h3 data-id="heading-12">补充说明：类加载机制深度解析</h3>
<p>类加载是 JVM 将 <code>.class</code> 文件转化为可执行 Java 类型的关键过程。它不仅是“读取文件”那么简单，而是一套<strong>安全、可靠、可扩展</strong>的机制。</p>
<h4 data-id="heading-13">类加载的完整生命周期</h4>
<p>JVM 规范将类加载分为 <strong>5 个阶段</strong>，通常合并为 <strong>3 步</strong>：</p>
<ol>
<li>
<p><strong>加载（Loading）</strong></p>
<ul>
<li>通过类的全限定名获取其二进制字节流（来源不限于 <code>.class</code> 文件，也可来自网络、数据库、动态生成等）；</li>
<li>将字节流解析为 JVM 内部的 <code>InstanceKlass</code> 或 <code>InstanceMirrorKlass</code> 对象；</li>
<li>在方法区中创建类的运行时表示；</li>
<li>在堆中创建 <code>java.lang.Class</code> 对象作为访问入口。</li>
</ul>
</li>
<li>
<p><strong>链接（Linking）</strong></p>
<ul>
<li><strong>验证（Verification）</strong>：确保字节码符合 JVM 规范，防止恶意代码破坏虚拟机（见下文详述）；</li>
<li><strong>准备（Preparation）</strong>：为<strong>静态变量</strong>分配内存并设置<strong>初始值</strong>（注意：不是赋值！例如 <code>static int x = 100;</code> 此时 <code>x = 0</code>）；</li>
<li><strong>解析（Resolution）</strong>：将常量池中的符号引用（如 <code>#3 = Methodref java/lang/Object."&lt;init&gt;":()V</code>）替换为直接引用（如内存地址或偏移量）。</li>
</ul>
</li>
<li>
<p><strong>初始化（Initialization）</strong></p>
<ul>
<li>执行 <code>&lt;clinit&gt;</code> 方法（由编译器自动生成，包含所有静态变量赋值和 static 块）；</li>
<li><strong>这是类加载的最后一步，也是 Java 代码真正开始执行的起点</strong>；</li>
<li>初始化是<strong>线程安全</strong>的：JVM 会加锁，确保同一类只被初始化一次。</li>
</ul>
</li>
</ol>
<h4 data-id="heading-14">双亲委派模型的深层意义</h4>
<p>双亲委派不仅是“先问爸爸”，更是一种<strong>安全沙箱机制</strong>：</p>
<ul>
<li><strong>核心类隔离</strong>：<code>java.*</code> 包下的类只能由 Bootstrap ClassLoader 加载。即使你在 classpath 放一个 <code>java.lang.HackString.class</code>，AppClassLoader 在尝试加载时会先委托给父加载器，而父加载器（Bootstrap）早已加载了真正的 <code>String</code>，因此你的“伪造类”永远不会被使用。</li>
<li><strong>避免类重复加载</strong>：同一个类在 JVM 中由 <strong>“类加载器 + 类全名”</strong> 唯一确定。若无委派机制，不同加载器可能加载同一类多次，导致 <code>ClassCastException</code>（看似相同类型，实则不同 Class 对象）。</li>
</ul>
<blockquote>
<p>🛠️ <strong>打破双亲委派？</strong><br/>
某些框架（如 Tomcat、OSGi）需要<strong>隔离不同应用的类</strong>，会自定义类加载器并<strong>重写 <code>loadClass()</code> 方法</strong>，实现“子优先”策略。但这必须谨慎处理，否则极易引发类冲突。</p>
</blockquote>
<h4 data-id="heading-15">字节码验证：JVM 的“安检门”</h4>
<p>验证是保障 JVM 稳定性的基石。HotSpot 在 <code>ClassVerifier</code> 中实现了严格的四阶段检查：</p>
<ul>
<li><strong>第一阶段：文件格式验证</strong><br/>
检查魔数（<code>0xCAFEBABE</code>）、主次版本号是否兼容当前 JVM。</li>
<li><strong>第二阶段：元数据验证</strong><br/>
检查类是否继承了 final 类、方法是否重写了不可重写的方法等。</li>
<li><strong>第三阶段：字节码验证（最耗时）</strong><br/>
模拟执行字节码，验证：
<ul>
<li>操作数栈不会溢出/下溢；</li>
<li>所有跳转指令指向合法位置；</li>
<li>方法调用参数类型匹配；</li>
<li><code>return</code> 类型与方法声明一致。</li>
</ul>
</li>
<li><strong>第四阶段：符号引用验证</strong><br/>
在解析阶段，确保引用的类、字段、方法确实存在且可访问。</li>
</ul>
<blockquote>
<p>🔒 <strong>安全价值</strong>：<br/>
即使你通过 <code>Unsafe.defineAnonymousClass()</code> 动态生成字节码，JVM 仍会对其进行验证（除非显式关闭 <code>-noverify</code>，但生产环境严禁使用）。</p>
</blockquote>
<hr/>
<h2 data-id="heading-16">五、执行引擎：解释器 + JIT 编译器</h2>
<p>JVM 不直接执行 Java 源码，而是执行 <strong>字节码（bytecode）</strong>。执行引擎负责将其转化为机器码。</p>
<h3 data-id="heading-17">1. 解释器（Interpreter）</h3>
<ul>
<li><strong>工作方式</strong>：逐条读取字节码，查表（dispatch table）执行对应 C++ 函数。</li>
<li><strong>源码</strong>：<code>templateTable_x86_64.cpp</code> 定义了每条字节码的汇编模板。</li>
<li><strong>优点</strong>：启动快；<strong>缺点</strong>：执行慢。</li>
</ul>
<h3 data-id="heading-18">2. JIT（Just-In-Time）编译器</h3>
<p>当某段代码被频繁执行（“热点代码”），JIT 会将其编译为<strong>本地机器码</strong>并缓存。</p>
<h4 data-id="heading-19">HotSpot 的两级 JIT：</h4>




















<table><thead><tr><th>编译器</th><th>触发条件</th><th>优化级别</th></tr></thead><tbody><tr><td><strong>C1（Client Compiler）</strong></td><td>方法调用 &gt; 1500 次</td><td>快速编译，少量优化</td></tr><tr><td><strong>C2（Server Compiler）</strong></td><td>方法调用 &gt; 10000 次</td><td>深度优化（内联、逃逸分析等）</td></tr></tbody></table>
<blockquote>
<p>🔥 <strong>JIT 优化示例</strong>：</p>
<ul>
<li><strong>方法内联（Inlining）</strong>：消除虚方法调用开销</li>
<li><strong>逃逸分析（Escape Analysis）</strong>：栈上分配对象，减少 GC 压力</li>
<li><strong>锁消除（Lock Elimination）</strong>：去除不可能竞争的 synchronized</li>
</ul>
</blockquote>
<hr/>
<h2 data-id="heading-20">六、垃圾回收（GC）：自动内存管理的艺术</h2>
<p>GC 是 JVM 最复杂的子系统。其核心任务：<strong>安全、高效地回收不再使用的对象</strong>。</p>
<h3 data-id="heading-21">1. 如何判断对象死亡？—— 可达性分析</h3>
<p>从 <strong>GC Roots</strong> 出发（包括：栈帧局部变量、静态变量、JNI 引用等），通过引用链搜索存活对象。无法到达的对象即为垃圾。</p>
<blockquote>
<p>❌ 不再使用“引用计数法”（无法解决循环引用问题）。</p>
</blockquote>
<h3 data-id="heading-22">2. 分代收集理论（Generational Hypothesis）</h3>
<ul>
<li><strong>弱分代假说</strong>：绝大多数对象“朝生夕死”。</li>
<li><strong>强分代假说</strong>：熬过多次 GC 的对象更可能长期存活。</li>
</ul>
<p>因此，HotSpot 将堆分为：</p>
<ul>
<li><strong>新生代（Young Gen）</strong>：Eden + Survivor（S0/S1）</li>
<li><strong>老年代（Old Gen）</strong></li>
</ul>
<h3 data-id="heading-23">3. 主流 GC 算法对比</h3>















































<table><thead><tr><th>GC</th><th>算法</th><th>STW 时间</th><th>适用场景</th></tr></thead><tbody><tr><td><strong>Serial</strong></td><td>复制（Young）+ 标记-整理（Old）</td><td>高</td><td>单核、小内存</td></tr><tr><td><strong>Parallel</strong></td><td>并行复制 + 并行标记-整理</td><td>中高</td><td>吞吐优先</td></tr><tr><td><strong>CMS</strong></td><td>并发标记-清除</td><td>低（但有碎片）</td><td>已废弃（JDK14+）</td></tr><tr><td><strong>G1</strong></td><td>Region + 并发标记 + 混合回收</td><td>低（可预测）</td><td>大堆（4~64GB）</td></tr><tr><td><strong>ZGC</strong></td><td>着色指针 + 并发重定位</td><td><strong>&lt; 1ms</strong></td><td>TB 级、超低延迟</td></tr><tr><td><strong>Shenandoah</strong></td><td>Brooks 指针 + 并发转移</td><td><strong>&lt; 10ms</strong></td><td>通用低延迟</td></tr></tbody></table>
<h3 data-id="heading-24">4. ZGC 源码亮点（<code>zCollectedHeap.cpp</code>）</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ZGC 的并发重定位核心</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">ZRelocate::relocate_object</span><span class="hljs-params">(oop* p)</span> </span>{
  oop obj = *p;
  <span class="hljs-keyword">if</span> (ZAddress::<span class="hljs-built_in">is_marked</span>(ZOop::<span class="hljs-built_in">address</span>(obj))) {
    oop new_obj = _allocator.<span class="hljs-built_in">alloc_object</span>(ZOop::<span class="hljs-built_in">size</span>(obj));
    <span class="hljs-built_in">copy_to_new_location</span>(obj, new_obj);
    ZForwarding::<span class="hljs-built_in">set_target</span>(obj, new_obj); <span class="hljs-comment">// 设置转发指针</span>
    *p = new_obj; <span class="hljs-comment">// 更新引用</span>
  }
}
</code></pre>
<blockquote>
<p>✨ 通过 <strong>读屏障</strong>，应用线程在访问对象时自动跳转到新地址，实现“无感迁移”。</p>
</blockquote>
<hr/>
<h2 data-id="heading-25">七、性能调优：从监控到实战</h2>
<h3 data-id="heading-26">1. 关键监控命令</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 查看 GC 日志（JDK9+）</span>
java -Xlog:gc*:gc.log MyApp

<span class="hljs-comment"># 实时监控</span>
jstat -gc &lt;pid&gt; 1000

<span class="hljs-comment"># 堆转储分析</span>
jmap -dump:format=b,file=heap.hprof &lt;pid&gt;
</code></pre>
<h3 data-id="heading-27">2. 常见调优参数</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 选择低延迟 GC</span>
-XX:+UseZGC
-XX:+UseShenandoahGC

<span class="hljs-comment"># 控制堆大小</span>
-Xms4g -Xmx4g

<span class="hljs-comment"># G1 调优</span>
-XX:MaxGCPauseMillis=200
-XX:G1HeapRegionSize=16m
</code></pre>
<hr/>
<h2 data-id="heading-28">结语：JVM —— Java 的“操作系统”</h2>
<p>JVM 远不止是一个“运行 Java 的容器”。它是一个集 <strong>内存管理、并发控制、即时编译、安全验证</strong> 于一体的复杂系统。理解其底层原理，不仅能让你写出更高效的代码，更能让你在系统出现故障时<strong>快速定位根因</strong>，成为真正的“Java 高手”。</p>
<blockquote>
<p><strong>最后建议</strong>：</p>
<ul>
<li>阅读《深入理解 Java 虚拟机》（周志明）</li>
<li>浏览 OpenJDK HotSpot 源码</li>
<li>在生产环境中开启 GC 日志，持续观察</li>
</ul>
</blockquote>
<p>掌握 JVM，就是掌握了 Java 应用的“命脉”。</p>
<hr/>
<p><strong>参考资料</strong>：</p>
<ul>
<li>OpenJDK 源码：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenjdk%2Fjdk" target="_blank" title="https://github.com/openjdk/jdk" ref="nofollow noopener noreferrer">github.com/openjdk/jdk</a></li>
<li>JVM Specification：<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.oracle.com%2Fjavase%2Fspecs%2F" target="_blank" title="https://docs.oracle.com/javase/specs/" ref="nofollow noopener noreferrer">docs.oracle.com/javase/spec…</a></li>
<li>ZGC Paper (Oracle)：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.oracle.com%2Ftechnical-resources%2Farticles%2Fjava%2Fzgc.html" target="_blank" title="https://www.oracle.com/technical-resources/articles/java/zgc.html" ref="nofollow noopener noreferrer">www.oracle.com/technical-r…</a></li>
<li>Shenandoah GC Wiki：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwiki.openjdk.org%2Fdisplay%2Fshenandoah%2FMain" target="_blank" title="https://wiki.openjdk.org/display/shenandoah/Main" ref="nofollow noopener noreferrer">wiki.openjdk.org/display/she…</a></li>
</ul>
<blockquote>
<p><strong>作者</strong>：架构师Beata<br/>
<strong>日期</strong>：2026年2月8日
<strong>声明</strong>：本文基于网络文档整理，如有疏漏，欢迎指正。转载请注明出处。<br/>
<strong>互动</strong>：如有任何问题？欢迎在评论区分享！</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[HashMap源码深度剖析]]></title>    <link>https://juejin.cn/post/7603895839556599871</link>    <guid>https://juejin.cn/post/7603895839556599871</guid>    <pubDate>2026-02-08T14:29:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603895839556599871" data-draft-id="7603643385816318004" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="HashMap源码深度剖析"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2026-02-08T14:29:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Wiittch"/> <meta itemprop="url" content="https://juejin.cn/user/1910300244458315"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            HashMap源码深度剖析
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1910300244458315/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Wiittch
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T14:29:28.000Z" title="Sun Feb 08 2026 14:29:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读20分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"/>
<h2 data-id="heading-1">一. HashMap为什么这么重要</h2>
<pre><code class="hljs language-mermaid" lang="mermaid">mindmap
      顶层接口
          Map
            HashMap
            LinkedHashMap
            TreeMap
            HashTable
            ConcurrentHashMap
          Collection 
            List
              ArrayList
              LinkedList
            Set
              HashSet
              TreeSet
              LinkedHashSet
            Queue
    
</code></pre>
<pre><code class="hljs language-ini" lang="ini">// HashMap的"衍生品"
<span class="hljs-attr">HashSet</span> = HashMap的Key视图
<span class="hljs-attr">LinkedHashMap</span> = HashMap + 双向链表
<span class="hljs-attr">ConcurrentHashMap</span> = 线程安全的HashMap变体
</code></pre>
<p><strong>HashMap之所以成为Java开发者必须掌握的核心数据结构，是因为它在横向对比中代表了工程优化的极致平衡，在纵向深度上揭示了计算机科学的经典范式。</strong></p>
<p>横向看，HashMap以近乎O(1)的查询性能超越了线性结构的List和有序结构的TreeMap，用0.75负载因子的巧妙设计平衡了时间与空间；纵向深入，它的演化史本身就是一部微缩的算法优化史——从JDK 7的链表碰撞到JDK 8的红黑树优化，从单线程设计到ConcurrentHashMap的分段锁再到CAS无锁化，每个版本迭代都体现了数据结构、并发编程与JVM特性的深度融合。<strong>理解HashMap不仅是在学习一个容器，更是在理解如何在现实约束下（内存、并发、性能）做出最优工程取舍的设计哲学。</strong></p>
<h2 data-id="heading-2">二.HashMap源码解读</h2>
<h3 data-id="heading-3">1.理解基础数据结构</h3>
<p><strong>1.1 核心内部类对比</strong></p>
<pre><code class="hljs language-scala" lang="scala">static <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node&lt;K</span>,<span class="hljs-title">V&gt;</span> <span class="hljs-title">implements</span> <span class="hljs-title">Map</span>.<span class="hljs-title">Entry&lt;K</span>,<span class="hljs-title">V&gt;</span> </span>{
    <span class="hljs-keyword">final</span> int hash;
    <span class="hljs-keyword">final</span> <span class="hljs-type">K</span> key;
    <span class="hljs-type">V</span> value;
    <span class="hljs-type">Node</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; next;  <span class="hljs-comment">// 单向链表</span>
}

<span class="hljs-comment">// 2. 树节点（继承体系关键！）</span>
static <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreeNode&lt;K</span>,<span class="hljs-title">V&gt;</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">LinkedHashMap</span>.<span class="hljs-title">Entry&lt;K</span>,<span class="hljs-title">V&gt;</span> </span>{
    <span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; parent;  <span class="hljs-comment">// 红黑树父节点</span>
    <span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; left;    <span class="hljs-comment">// 左子树</span>
    <span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; right;   <span class="hljs-comment">// 右子树</span>
    <span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; prev;    <span class="hljs-comment">// ❗️双向链表前驱（退化关键）</span>
    boolean red;           <span class="hljs-comment">// 颜色标记</span>
    <span class="hljs-comment">// next继承自父类</span>
}

<span class="hljs-comment">// 3. LinkedHashMap.Entry（桥梁作用）</span>
static <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Entry&lt;K</span>,<span class="hljs-title">V&gt;</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HashMap</span>.<span class="hljs-title">Node&lt;K</span>,<span class="hljs-title">V&gt;</span> </span>{
    <span class="hljs-type">Entry</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; before, after;  <span class="hljs-comment">// 双向链表</span>
}
</code></pre>
<p>HashMap的树化机制建立在精巧的类继承体系之上。基础链表节点<code>Node</code>仅维护单向<code>next</code>指针，存储键值对和哈希值。而树化后的<code>TreeNode</code>并未直接继承<code>Node</code>，而是通过继承<code>LinkedHashMap.Entry</code>间接继承<code>Node</code>，形成三层结构。这种设计使<code>TreeNode</code>同时具备红黑树的<code>parent/left/right</code>指针、保留退化所需的双向链表<code>prev/next</code>指针，并与<code>LinkedHashMap</code>保持结构兼容。<code>LinkedHashMap.Entry</code>作为中间层，添加了<code>before/after</code>指针维护访问顺序，使得<code>TreeNode</code>无需重复实现链表功能即可支持退化操作，体现了“组合优于继承”的设计思想。
<strong>1.2 核心常量定义</strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-type">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> TREEIFY_THRESHOLD = <span class="hljs-number">8</span>;     <span class="hljs-comment">// 树化阈值</span>
<span class="hljs-type">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> UNTREEIFY_THRESHOLD = <span class="hljs-number">6</span>;   <span class="hljs-comment">// 退化阈值  </span>
<span class="hljs-type">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> MIN_TREEIFY_CAPACITY = <span class="hljs-number">64</span>; <span class="hljs-comment">// 最小树化容量</span>
<span class="hljs-type">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> DEFAULT_INITIAL_CAPACITY = <span class="hljs-number">16</span>;
<span class="hljs-type">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">float</span> DEFAULT_LOAD_FACTOR = <span class="hljs-number">0.75f</span>;
</code></pre>
<p>HashMap通过一组精心设计的常量控制树化行为。<code>TREEIFY_THRESHOLD=8</code>基于泊松分布，表示链表长度超过此值（概率仅0.000006%）时才考虑树化；<code>UNTREEIFY_THRESHOLD=6</code>作为退化阈值，与树化阈值形成大小为2的缓冲带，防止节点数在临界点附近频繁触发结构转换。<code>MIN_TREEIFY_CAPACITY=64</code>规定了最小树化容量，当哈希表容量小于此值时优先扩容而非树化，因为小容量下树化的内存开销占比过高。配合默认初始容量<code>16</code>和负载因子<code>0.75</code>，这些常量共同构成一个平衡性能与空间的弹性系统。</p>
<h3 data-id="heading-4">2.HashMap在JDK中的树化触发链（完整调用栈）</h3>
<p><strong>2.1 入口：put() → putVal()</strong></p>
<pre><code class="hljs language-scss" lang="scss">public V <span class="hljs-built_in">put</span>(K key, V value) {
    return <span class="hljs-built_in">putVal</span>(hash(key), key, value, false, true);
}

final V <span class="hljs-built_in">putVal</span>(int hash, K key, V value, boolean onlyIfAbsent,
               boolean evict) {
    Node&lt;K,V&gt;<span class="hljs-selector-attr">[]</span> tab; Node&lt;K,V&gt; <span class="hljs-selector-tag">p</span>; int n, <span class="hljs-selector-tag">i</span>;
    <span class="hljs-comment">// ... 省略初始化逻辑</span>
    
    <span class="hljs-comment">// 🎯 关键循环：遍历链表</span>
    for (int binCount = <span class="hljs-number">0</span>; ; ++binCount) {
        if ((e = p.next) == null) {
            <span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.next</span> = <span class="hljs-built_in">newNode</span>(hash, key, value, null);
            if (binCount &gt;= TREEIFY_THRESHOLD - <span class="hljs-number">1</span>) <span class="hljs-comment">// -1 for 1st</span>
                <span class="hljs-built_in">treeifyBin</span>(tab, hash);  <span class="hljs-comment">// 触发树化</span>
            break;
        }
        <span class="hljs-comment">// ... 省略查找逻辑</span>
    }
    
    <span class="hljs-comment">// 修改计数和扩容检查</span>
    ++modCount;
    if (++size &gt; threshold)
        <span class="hljs-attribute">resize</span>();
}
</code></pre>
<p>HashMap的树化触发始于<code>put()</code>方法调用，其核心逻辑封装在<code>putVal()</code>中。当向桶中插入新节点时，方法通过<code>binCount</code>变量统计当前链表长度，当检测到链表长度即将达到阈值（<code>binCount &gt;= TREEIFY_THRESHOLD - 1</code>，即已有8个节点且正在插入第9个）时，调用<code>treeifyBin()</code>尝试树化。但这里仅完成长度检查，真正的树化还需在<code>treeifyBin()</code>中验证容量是否达标。这种分层检查机制确保了树化只在链表过长且哈希表规模足够大时才发生，避免在小容量场景下进行低效的结构转换。
<strong>2.2 树化前检查：treeifyBin()</strong></p>























<table><thead><tr><th>版本</th><th>数据结构</th><th>冲突解决方案</th><th>最坏时间复杂度</th></tr></thead><tbody><tr><td>JDK1.7及之前</td><td>数组+链表</td><td>纯拉链法</td><td>O(n)</td></tr><tr><td>JDK1.8之后</td><td>数组+链表+红黑树</td><td>混合策略</td><td>O(log n)</td></tr></tbody></table>
<p><strong>数组+链表的方法就是采用拉链法来解决冲突，之后在数组&gt;64和链表&gt;8的情况下采用红黑树来解决冲突。</strong></p>
<p><strong>数组&gt;64</strong>：当数组的桶数超过一定大小时（例如64），意味着哈希表的规模已经相当大，单纯依赖链表会导致链表变得过长，查找、插入和删除的效率会急剧下降。此时使用红黑树能够提供更好的性能。红黑树是一种平衡的二叉搜索树，能够保证最坏情况下查找、插入和删除操作的时间复杂度为 O(log N)。
<strong>注意数组小于64的时候采用的是数组扩容的方法。因为数组比较小的情况下变成红黑树结构需要进行左旋，右旋，变色来保持平衡，反而会降低效率。同时数组长度小搜索时间也会相对快。</strong>
在 <code>treeifyBin</code> 中，当桶的大小超过了阈值（即 <code>TREEIFY_THRESHOLD</code>，也就是 8）时，会将链表中的节点转换为红黑树节点（<code>TreeNode</code>）。</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * HashMap核心方法：将链表转化为红黑树
 * 
 * 触发条件：当单个桶(bucket)中的链表长度超过8，且HashMap容量达到64时
 * 目的：优化极端情况下的查询性能（从O(n)提升到O(log n)）
 * 
 * <span class="hljs-doctag">@param</span> tab  HashMap的桶数组
 * <span class="hljs-doctag">@param</span> hash 触发转换的key的hash值
 * 
 * 面试考点：
 * 1. 为什么是链表长度&gt;8才树化？
 * 2. 为什么需要容量&gt;=64才树化？
 * 3. 红黑树退化为链表的条件是什么？
 */</span>
final <span class="hljs-keyword">void</span> <span class="hljs-title function_">treeifyBin</span>(<span class="hljs-params">Node&lt;K,V&gt;[] tab, int hash</span>) {
    int n, index;  <span class="hljs-comment">// n: 数组长度，index: 目标桶索引</span>
    <span class="hljs-title class_">Node</span>&lt;K,V&gt; e;   <span class="hljs-comment">// 当前遍历的链表节点</span>
    
    <span class="hljs-comment">// ⚡ 条件检查：容量不足时先扩容而不是树化</span>
    <span class="hljs-comment">// 这是重要的性能优化：扩容可能直接分散节点，避免不必要的树化开销</span>
    <span class="hljs-keyword">if</span> (tab == <span class="hljs-literal">null</span> || (n = tab.<span class="hljs-property">length</span>) &lt; <span class="hljs-variable constant_">MIN_TREEIFY_CAPACITY</span>) {
        <span class="hljs-title function_">resize</span>();  <span class="hljs-comment">// 优先尝试扩容（MIN_TREEIFY_CAPACITY = 64）</span>
        <span class="hljs-keyword">return</span>;    <span class="hljs-comment">// 扩容后可能就不需要树化了</span>
    }
    
    <span class="hljs-comment">// 🔍 定位到目标桶，且桶不为空</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((e = tab[index = (n - <span class="hljs-number">1</span>) &amp; hash]) != <span class="hljs-literal">null</span>) {
        <span class="hljs-comment">// 红黑树的双向链表头部和尾部指针</span>
        <span class="hljs-title class_">TreeNode</span>&lt;K,V&gt; hd = <span class="hljs-literal">null</span>, tl = <span class="hljs-literal">null</span>;  <span class="hljs-comment">// head, tail</span>
        
        <span class="hljs-comment">// 🔄 遍历链表，将所有Node转换为TreeNode</span>
        <span class="hljs-comment">// 注意：这里先构建一个TreeNode的双向链表，而不是直接构建树</span>
        <span class="hljs-keyword">do</span> {
            <span class="hljs-comment">// 将普通Node转换为TreeNode（TreeNode继承自Node，但多了红黑树需要的属性）</span>
            <span class="hljs-title class_">TreeNode</span>&lt;K,V&gt; p = <span class="hljs-title function_">replacementTreeNode</span>(e, <span class="hljs-literal">null</span>);
            
            <span class="hljs-comment">// 构建双向链表</span>
            <span class="hljs-keyword">if</span> (tl == <span class="hljs-literal">null</span>) {
                hd = p;        <span class="hljs-comment">// 第一个节点作为头节点</span>
            } <span class="hljs-keyword">else</span> {
                p.<span class="hljs-property">prev</span> = tl;   <span class="hljs-comment">// 当前节点的前驱指向尾节点</span>
                tl.<span class="hljs-property">next</span> = p;   <span class="hljs-comment">// 尾节点的后继指向当前节点</span>
            }
            tl = p;           <span class="hljs-comment">// 更新尾节点</span>
        } <span class="hljs-keyword">while</span> ((e = e.<span class="hljs-property">next</span>) != <span class="hljs-literal">null</span>);  <span class="hljs-comment">// 遍历原链表</span>
        
        <span class="hljs-comment">// ✨ 关键步骤：将桶中的链表替换为TreeNode双向链表</span>
        <span class="hljs-keyword">if</span> ((tab[index] = hd) != <span class="hljs-literal">null</span>) {
            <span class="hljs-comment">// 🎯 真正的树化操作：将双向链表转化为红黑树</span>
            hd.<span class="hljs-title function_">treeify</span>(tab);  <span class="hljs-comment">// 这个方法会进行红黑树的平衡操作</span>
        }
    }
}
</code></pre>
<p><strong>链表&gt;8</strong>：如果在某个桶中，链表长度超过了一个阈值（例如8），这说明哈希冲突比较严重，链表的性能也会下降。链表的查找操作是 O(n)，如果链表很长，查找性能会非常低。此时转化为红黑树，能使得该桶的操作复杂度由 O(n) 降低到 O(log n)。</p>
<p><strong>为什么是8</strong></p>
<p>在理想哈希函数下，HashMap中每个桶的节点数服从<strong>泊松分布</strong>。源码注释给出了精确概率：</p>



































<table><thead><tr><th>链表长度</th><th>发生概率</th><th>含义</th></tr></thead><tbody><tr><td>0</td><td>0.60653066</td><td>60%的桶为空</td></tr><tr><td>1</td><td>0.30326533</td><td>30%的桶有1个节点</td></tr><tr><td>2</td><td>0.07581633</td><td>7.5%的桶有2个节点</td></tr><tr><td>...</td><td>...</td><td>...</td></tr><tr><td>8</td><td>0.00000006</td><td><strong>千万分之六</strong></td></tr></tbody></table>
<p>也就是说，链表长度达到8的概率极低（0.000006%），几乎可以视为<strong>哈希冲突的异常情况</strong>。
这时候使用红黑树，虽然节点内存翻倍（普通Node vs TreeNode），但能将最坏查询时间从O(8)=O(1)恶化到O(log8)=O(3)，
这是一个安全网设计，专门针对哈希碰撞攻击或劣质hashCode()。</p>
<p><strong>为什么是64？不是32或者128</strong></p>
<p><strong>1.64是链表遍历的成本拐点</strong></p>
<p>在CPU缓存层面：</p>
<ul>
<li>32个桶：平均链表长度≈2-3（当负载因子0.75，元素数≈24时）</li>
<li>64个桶：平均链表长度≈1-2（元素数≈48时）</li>
</ul>
<p>实验数据：</p>





























<table><thead><tr><th>容量</th><th>链表平均长度</th><th>遍历成本</th><th>树化必要性</th></tr></thead><tbody><tr><td>32</td><td>2.3</td><td>很低</td><td>不必要</td></tr><tr><td>64</td><td>1.5</td><td>极低</td><td><strong>开始考虑</strong></td></tr><tr><td>128</td><td>0.8</td><td>微不足道</td><td>过度</td></tr></tbody></table>
<p>64是一个平衡点：容量足够大，让树化的收益可能覆盖成本。</p>
<p><strong>2.红黑树的固定开销</strong></p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// TreeNode vs Node 内存占用对比</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> {       <span class="hljs-comment">// 普通链表节点</span>
    <span class="hljs-keyword">final</span> int hash;
    <span class="hljs-keyword">final</span> <span class="hljs-type">K</span> key;
    <span class="hljs-type">V</span> value;
    <span class="hljs-type">Node</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; next;  <span class="hljs-comment">// 4个字段</span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">TreeNode</span> {   <span class="hljs-comment">// 红黑树节点（继承自LinkedHashMap.Entry）</span>
    <span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; parent;  <span class="hljs-comment">// +1</span>
    <span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; left;    <span class="hljs-comment">// +1  </span>
    <span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; right;   <span class="hljs-comment">// +1</span>
    <span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; prev;    <span class="hljs-comment">// +1（保持链表结构）</span>
    boolean red;           <span class="hljs-comment">// +1</span>
    <span class="hljs-comment">// 总共约是Node的2倍内存</span>
}
</code></pre>
<p><strong>内存计算</strong>（假设64位JVM，压缩指针开启）：</p>
<ul>
<li><code>Node</code> ≈ 24字节</li>
<li><code>TreeNode</code> ≈ 48字节</li>
<li><strong>树化一个桶（8节点）的内存增量</strong>：<code>(48-24)×8 = 192字节</code></li>
</ul>
<p>当只有32个桶时，如果有一个桶树化，<strong>内存浪费比例</strong> = 192/(32×24)=25%，太高了！<br/>
64个桶时比例降为12.5%，更可接受。</p>
<pre><code class="hljs language-scss" lang="scss">回忆泊松分布公式：<span class="hljs-selector-tag">P</span>(k) = (λ^k * e^(-λ)) / k!
对于HashMap，λ = <span class="hljs-number">0.5</span>（平均每个桶的元素数，当负载因子<span class="hljs-number">0.75</span>）

计算不同容量下链表长度≥<span class="hljs-number">8</span>的概率：
| 容量 | 元素数 | λ   | <span class="hljs-selector-tag">P</span>(长度≥<span class="hljs-number">8</span>)      | 预期出现次数 |
|------|-------|-----|---------------|-------------|
| <span class="hljs-number">32</span>   | <span class="hljs-number">24</span>    | <span class="hljs-number">0.75</span>| <span class="hljs-number">0.0000004</span>     | <span class="hljs-number">0.000013</span>    |
| <span class="hljs-number">64</span>   | <span class="hljs-number">48</span>    | <span class="hljs-number">0.75</span>| <span class="hljs-number">0.0000004</span>     | <span class="hljs-number">0.000026</span>    |
| <span class="hljs-number">128</span>  | <span class="hljs-number">96</span>    | <span class="hljs-number">0.75</span>| <span class="hljs-number">0.0000004</span>     | <span class="hljs-number">0.000051</span>    |

发现：概率相同，但容量越大，**预期出现的长链表数越多**。
<span class="hljs-number">64</span>是一个临界点：预期出现树化桶的概率开始变得"值得考虑"。
</code></pre>
<p><strong>2.3 真正树化：TreeNode.treeify()</strong></p>
<pre><code class="hljs language-ini" lang="ini">final void treeify(Node&lt;K,V&gt;<span class="hljs-section">[]</span> tab) {
    TreeNode&lt;K,V&gt; <span class="hljs-attr">root</span> = null<span class="hljs-comment">;</span>
    // 遍历当前TreeNode链表（this是链表头）
    for (TreeNode&lt;K,V&gt; <span class="hljs-attr">x</span> = this, next<span class="hljs-comment">; x != null; x = next) {</span>
        <span class="hljs-attr">next</span> = (TreeNode&lt;K,V&gt;)x.next<span class="hljs-comment">;</span>
        <span class="hljs-attr">x.left</span> = x.right = null<span class="hljs-comment">;</span>
        
        if (<span class="hljs-attr">root</span> == null) {
            // 第一个节点设为根（黑色）
            <span class="hljs-attr">x.parent</span> = null<span class="hljs-comment">;</span>
            <span class="hljs-attr">x.red</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
            <span class="hljs-attr">root</span> = x<span class="hljs-comment">;</span>
        } else {
            // 🎯 红黑树插入算法（完整解析）
            K <span class="hljs-attr">k</span> = x.key<span class="hljs-comment">;</span>
            int <span class="hljs-attr">h</span> = x.hash<span class="hljs-comment">;</span>
            Class&lt;?&gt; <span class="hljs-attr">kc</span> = null<span class="hljs-comment">;</span>
            
            // 二叉搜索树插入位置查找
            for (TreeNode&lt;K,V&gt; <span class="hljs-attr">p</span> = root<span class="hljs-comment">;;) {</span>
                int dir, ph<span class="hljs-comment">;</span>
                K <span class="hljs-attr">pk</span> = p.key<span class="hljs-comment">;</span>
                
                // 1. 比较hash值
                if ((<span class="hljs-attr">ph</span> = p.hash) &gt; h)
                    <span class="hljs-attr">dir</span> = -<span class="hljs-number">1</span><span class="hljs-comment">;</span>
                else if (ph &lt; h)
                    <span class="hljs-attr">dir</span> = <span class="hljs-number">1</span><span class="hljs-comment">;</span>
                // 2. hash相等时比较key
                else if ((<span class="hljs-attr">kc</span> == null &amp;&amp;
                          (<span class="hljs-attr">kc</span> = comparableClassFor(k)) == null) ||
                         (<span class="hljs-attr">dir</span> = compareComparables(kc, k, pk)) == <span class="hljs-number">0</span>) {
                    // 3. 全相等时使用tieBreakOrder
                    <span class="hljs-attr">dir</span> = tieBreakOrder(k, pk)<span class="hljs-comment">;</span>
                }
                
                // 插入节点
                TreeNode&lt;K,V&gt; <span class="hljs-attr">xp</span> = p<span class="hljs-comment">;</span>
                if ((<span class="hljs-attr">p</span> = (dir &lt;= <span class="hljs-number">0</span>) ? p.left : p.right) == null) {
                    <span class="hljs-attr">x.parent</span> = xp<span class="hljs-comment">;</span>
                    if (dir &lt;= 0)
                        <span class="hljs-attr">xp.left</span> = x<span class="hljs-comment">;</span>
                    else
                        <span class="hljs-attr">xp.right</span> = x<span class="hljs-comment">;</span>
                    // 🎯 红黑树平衡修复
                    <span class="hljs-attr">root</span> = balanceInsertion(root, x)<span class="hljs-comment">;</span>
                    break<span class="hljs-comment">;</span>
                }
            }
        }
    }
    // 确保根节点在数组槽位
    moveRootToFront(tab, root)<span class="hljs-comment">;</span>
}
</code></pre>
<p><strong>2.4 红黑树平衡：balanceInsertion()</strong></p>
<pre><code class="hljs language-ini" lang="ini">static &lt;K,V&gt; TreeNode&lt;K,V&gt; balanceInsertion(TreeNode&lt;K,V&gt; root,
                                            TreeNode&lt;K,V&gt; x) {
    <span class="hljs-attr">x.red</span> = <span class="hljs-literal">true</span><span class="hljs-comment">;  // 新插入节点总是红色</span>
    for (TreeNode&lt;K,V&gt; xp, xpp, xppl, xppr<span class="hljs-comment">;;) {</span>
        // 情况1：父节点为null，x是根节点
        if ((<span class="hljs-attr">xp</span> = x.parent) == null) {
            <span class="hljs-attr">x.red</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
            return x<span class="hljs-comment">;</span>
        }
        // 情况2：父节点是黑色 或 祖父节点为null
        else if (!xp.red || (<span class="hljs-attr">xpp</span> = xp.parent) == null)
            return root<span class="hljs-comment">;</span>
        
        // 父节点是祖父节点的左子节点
        if (<span class="hljs-attr">xp</span> == (xppl = xpp.left)) {
            // 情况3：叔叔节点是红色
            if ((<span class="hljs-attr">xppr</span> = xpp.right) != null &amp;&amp; xppr.red) {
                <span class="hljs-attr">xppr.red</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
                <span class="hljs-attr">xp.red</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
                <span class="hljs-attr">xpp.red</span> = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
                <span class="hljs-attr">x</span> = xpp<span class="hljs-comment">;</span>
            } 
            // 情况4：叔叔节点是黑色
            else {
                // 情况4a：x是右子节点（LR型）
                if (<span class="hljs-attr">x</span> == xp.right) {
                    <span class="hljs-attr">root</span> = rotateLeft(root, x = xp)<span class="hljs-comment">;</span>
                    <span class="hljs-attr">xpp</span> = (xp = x.parent) == null ? null : xp.parent<span class="hljs-comment">;</span>
                }
                // 情况4b：x是左子节点（LL型）
                if (xp != null) {
                    <span class="hljs-attr">xp.red</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
                    if (xpp != null) {
                        <span class="hljs-attr">xpp.red</span> = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
                        <span class="hljs-attr">root</span> = rotateRight(root, xpp)<span class="hljs-comment">;</span>
                    }
                }
            }
        }
        // 对称情况：父节点是右子节点...
        else { /* 对称代码 */ }
    }
}
</code></pre>
<p><code>TreeNode.treeify()</code>方法将双向链表转化为红黑树，其核心是标准的二叉搜索树插入流程：先根据哈希值和键确定插入位置（优先比较哈希，哈希相同则比较键，完全相同时调用<code>tieBreakOrder</code>决断），然后执行插入。每次插入后立即调用<code>balanceInsertion()</code>进行红黑树平衡修复，该方法遵循红黑树的四种平衡场景：当新节点为根时染黑（情况1）；父节点为黑时无需调整（情况2）；叔节点为红时执行颜色翻转（情况3）；叔节点为黑时根据节点位置进行左旋或右旋（情况4）。整个转换过程逐步构建平衡树，最终通过<code>moveRootToFront()</code>确保根节点位于桶数组首位，维持哈希表的快速访问特性。</p>
<h3 data-id="heading-5">3.退化机制（完整流程）</h3>
<p><strong>3.1 退化触发点</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// 1. 扩容时拆分树：split()方法</span>
if (loHead != null) {
    if (lc &lt;= UNTREEIFY_THRESHOLD)
        tab<span class="hljs-selector-attr">[index]</span> = loHead<span class="hljs-selector-class">.untreeify</span>(map);  <span class="hljs-comment">// 退化</span>
    else {
        tab<span class="hljs-selector-attr">[index]</span> = loHead;
        if (hiHead != null)
            loHead<span class="hljs-selector-class">.treeify</span>(tab);
    }
}

<span class="hljs-comment">// 2. 删除节点后检查：removeTreeNode()</span>
if (root == null || root.right == null ||
    (rl = root.left) == null || rl<span class="hljs-selector-class">.left</span> == null) {
    tab<span class="hljs-selector-attr">[index]</span> = first<span class="hljs-selector-class">.untreeify</span>(map);  <span class="hljs-comment">// 退化</span>
    return;
}
</code></pre>
<p>红黑树退化为链表主要在两种场景触发：扩容时的树拆分与删除节点后的结构检查。在<code>split()</code>方法中，当红黑树因扩容被拆分为高位和低位两棵树时，若拆分后某部分的节点数不超过<code>UNTREEIFY_THRESHOLD=6</code>，则直接调用<code>untreeify()</code>退化为链表，避免维持小规模树的开销。在<code>removeTreeNode()</code>中，删除节点后会检查红黑树结构是否过于简单（如根节点为空、子树过少），若树规模过小则同样触发退化。这两种机制共同确保红黑树仅在规模足够大时存在，小规模时回归更高效的链表结构，实现动态的自适应优化。</p>
<p><strong>3.2 退化实现：untreeify()</strong></p>
<p>java</p>
<pre><code class="hljs language-ini" lang="ini">final Node&lt;K,V&gt; untreeify(HashMap&lt;K,V&gt; map) {
    Node&lt;K,V&gt; <span class="hljs-attr">hd</span> = null, tl = null<span class="hljs-comment">;</span>
    for (Node&lt;K,V&gt; <span class="hljs-attr">q</span> = this<span class="hljs-comment">; q != null; q = q.next) {</span>
        // TreeNode → Node 转换
        Node&lt;K,V&gt; <span class="hljs-attr">p</span> = map.replacementNode(q, null)<span class="hljs-comment">;</span>
        if (<span class="hljs-attr">tl</span> == null)
            <span class="hljs-attr">hd</span> = p<span class="hljs-comment">;</span>
        else
            <span class="hljs-attr">tl.next</span> = p<span class="hljs-comment">;</span>
        <span class="hljs-attr">tl</span> = p<span class="hljs-comment">;</span>
    }
    return hd<span class="hljs-comment">;  // 返回普通链表头</span>
}
</code></pre>
<p><code>untreeify()</code>方法实现了红黑树到链表的退化过程，它遍历当前TreeNode的双向链表（通过<code>next</code>指针），对每个节点调用<code>map.replacementNode()</code>将其转换回普通Node节点，同时重新构建单向链表结构。这个方法的关键在于TreeNode保留了原始链表的<code>next</code>指针，使得退化过程无需重新计算哈希或比较键值，仅需遍历一次即可完成结构转换，时间复杂度为O(n)。返回的普通链表头节点将替换原桶中的树根，使该桶恢复为纯链表结构，从而在数据规模缩小时节省内存并简化操作逻辑。</p>
<h3 data-id="heading-6">4.其他关键关联方法</h3>
<p><strong>4.1 树的查找：getTreeNode()</strong></p>
<pre><code class="hljs language-ini" lang="ini">final TreeNode&lt;K,V&gt; getTreeNode(int h, Object k) {
    // 从根节点开始查找
    return ((parent != null) ? root() : this).find(h, k, null)<span class="hljs-comment">;</span>
}

final TreeNode&lt;K,V&gt; find(int h, Object k, Class&lt;?&gt; kc) {
    TreeNode&lt;K,V&gt; <span class="hljs-attr">p</span> = this<span class="hljs-comment">;</span>
    do {
        int ph, dir<span class="hljs-comment">; K pk;</span>
        TreeNode&lt;K,V&gt; <span class="hljs-attr">pl</span> = p.left, pr = p.right, q<span class="hljs-comment">;</span>
        // 比较hash
        if ((<span class="hljs-attr">ph</span> = p.hash) &gt; h)
            <span class="hljs-attr">p</span> = pl<span class="hljs-comment">;</span>
        else if (ph &lt; h)
            <span class="hljs-attr">p</span> = pr<span class="hljs-comment">;</span>
        // hash相等比较key
        else if ((<span class="hljs-attr">pk</span> = p.key) == k || (k != null &amp;&amp; k.equals(pk)))
            return p<span class="hljs-comment">;</span>
        else if (<span class="hljs-attr">pl</span> == null)
            <span class="hljs-attr">p</span> = pr<span class="hljs-comment">;</span>
        else if (<span class="hljs-attr">pr</span> == null)
            <span class="hljs-attr">p</span> = pl<span class="hljs-comment">;</span>
        else if ((kc != null ||
                  (<span class="hljs-attr">kc</span> = comparableClassFor(k)) != null) &amp;&amp;
                 (<span class="hljs-attr">dir</span> = compareComparables(kc, k, pk)) != <span class="hljs-number">0</span>)
            <span class="hljs-attr">p</span> = (dir &lt; <span class="hljs-number">0</span>) ? pl : pr<span class="hljs-comment">;</span>
        // 递归查找
        else if ((<span class="hljs-attr">q</span> = pr.find(h, k, kc)) != null)
            return q<span class="hljs-comment">;</span>
        else
            <span class="hljs-attr">p</span> = pl<span class="hljs-comment">;</span>
    } while (p != null)<span class="hljs-comment">;</span>
    return null<span class="hljs-comment">;</span>
}
</code></pre>
<p><code>getTreeNode()</code>通过调用<code>find()</code>方法在红黑树中执行二分查找。查找过程优先比较哈希值决定搜索方向，哈希相同时比较键对象，若键实现<code>Comparable</code>接口则使用比较结果，否则递归搜索左右子树。该方法充分利用红黑树的平衡特性，将查找复杂度从链表的O(n)优化为O(log n)，但相比纯二叉搜索树增加了更多边界处理逻辑，以兼容HashMap中键可能不可比较的情况。</p>
<p><strong>4.2 树的删除：removeTreeNode()</strong>
<code>removeTreeNode()</code>是HashMap最复杂的方法之一，它需要同时处理红黑树的删除平衡和链表结构维护。删除节点后需执行标准的红黑树删除修复（涉及颜色调整和旋转），同时更新链表的<code>prev/next</code>指针。若删除导致树规模过小（根据特定条件判断），则触发退化检查调用<code>untreeify()</code>。整个过程需保持树和链表两种数据结构的同步，体现了混合结构的维护成本。</p>
<p><strong>4.3 扩容时的树拆分：split()</strong></p>
<p>java</p>
<pre><code class="hljs language-ini" lang="ini">// 扩容时如何拆分一棵红黑树
if ((e.hash &amp; bit) == 0) {  // 低位链表
    if ((<span class="hljs-attr">e.prev</span> = loTail) == null)
        <span class="hljs-attr">loHead</span> = e<span class="hljs-comment">;</span>
    else
        <span class="hljs-attr">loTail.next</span> = e<span class="hljs-comment">;</span>
    <span class="hljs-attr">loTail</span> = e<span class="hljs-comment">;</span>
    ++lc<span class="hljs-comment">;</span>
} else {  // 高位链表
    // 对称操作...
}
// 拆分后检查是否需要退化
if (loHead != null) {
    if (lc &lt;= UNTREEIFY_THRESHOLD)
        tab<span class="hljs-section">[index]</span> = loHead.untreeify(map)<span class="hljs-comment">;</span>
    else {
        tab<span class="hljs-section">[index]</span> = loHead<span class="hljs-comment">;</span>
        if (hiHead != null)
            loHead.treeify(tab)<span class="hljs-comment">;</span>
    }
}
</code></pre>
<p>在<code>split()</code>方法中，红黑树根据节点哈希值的特定位被拆分为低位和高位两棵子树。拆分过程遍历原树节点，按位运算结果将其重新组织为两个链表，同时统计节点数。拆分后若某链表节点数不超过退化阈值6，则直接退化为普通链表；否则重新树化。这种“拆树为链，按需重构”的策略避免了直接在树结构上执行复杂拆分，而是降级到链表操作后再重建，降低了扩容复杂度。</p>
<h3 data-id="heading-7">5.设计与性能考察</h3>
<p><strong>5.1 性能对比测试代码</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// 实际测试不同结构的性能差异</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">TreeifyBenchmark</span> { 
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">testPerformance</span>()</span> {
<span class="hljs-comment">// 测试链表 vs 红黑树在不同长度下的操作耗时 </span>
<span class="hljs-comment">// 包括：查找、插入、删除 } </span>
}
</code></pre>
<p>实际性能测试显示，当链表长度小于等于6时，链表结构因内存紧凑、无平衡开销而在增删查操作上均优于红黑树；长度达到8时两者性能接近；超过8后红黑树的O(log n)优势开始显现。但在实际哈希分布良好的场景中，长链表出现概率极低（0.000006%），树化机制更多是应对哈希碰撞攻击的防御手段，而非日常性能优化。这种设计体现了“为常态优化，为极端防护”的工程哲学。</p>
<p><strong>5.2 内存布局分析</strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// 使用JOL工具分析对象内存布局</span>
<span class="hljs-comment">// Node对象头 + hash + key + value + next</span>
<span class="hljs-comment">// TreeNode对象头 + 更多字段 </span>
</code></pre>
<p>使用JOL（Java Object Layout）工具分析可见，64位JVM开启压缩指针时，Node对象约占24字节（对象头12B+引用字段各4B），而TreeNode由于继承体系复杂且字段更多，占用约48字节，是Node的两倍。红黑树节点多出的parent、left、right等指针虽带来算法优势，却也显著增加内存开销，这解释了为何小容量下优先扩容而非树化——避免少量树化节点造成不成比例的内存浪费。</p>
<p><strong>5.3 与ConcurrentHashMap对比</strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// ConcurrentHashMap的TreeNode是final的 </span>
<span class="hljs-comment">// 树化需要加锁 synchronized (f) </span>
<span class="hljs-comment">// 有更复杂的并发控制}</span>
</code></pre>
<p>ConcurrentHashMap的树化机制在HashMap基础上增加了并发安全设计：树化前需通过<code>synchronized</code>锁住桶头节点，TreeNode被声明为final以防止并发修改，且扩容期间有更复杂的协作机制。这些差异源于并发场景下需保证结构变化的原子性，但也使得树化触发条件更严格、失败可能性更高，体现了并发容器“安全优先于优化”的设计原则。</p>
<h3 data-id="heading-8">6.常见误区</h3>
<h5 data-id="heading-9">误区1：链表长度&gt;8就一定会树化</h5>
<p><strong>错误理解</strong>：只要链表长度超过8，HashMap就会立即将链表转为红黑树。</p>
<p><strong>产生原因</strong>：开发者直观认为阈值就是触发条件，忽略了系统的整体优化策略。</p>
<p><strong>正确事实</strong>：需要同时满足两个条件：①链表长度&gt;TREEIFY_THRESHOLD(8) ②数组容量≥MIN_TREEIFY_CAPACITY(64)。容量不足64时优先扩容，因为小表扩容成本低于树化维护成本。</p>
<p><strong>代码示例</strong>：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">String</span>&gt; smallMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;(<span class="hljs-number">32</span>); <span class="hljs-comment">// 容量32&lt;64</span>
<span class="hljs-comment">// 插入9个hash冲突的key → 触发扩容而非树化</span>
</code></pre>
<h5 data-id="heading-10">误区2：红黑树一定比链表性能好</h5>
<p><strong>错误理解</strong>：O(log n)复杂度永远优于O(n)，树化后性能必然提升。</p>
<p><strong>产生原因</strong>：忽略了大O记法的常数因子和实际数据规模的影响。</p>
<p><strong>正确事实</strong>：当n≤6时，链表因内存紧凑、无平衡开销而更快。树化阈值设为8，退化阈值设为6，中间留了缓冲带防止频繁结构转换。</p>
<p><strong>实际影响</strong>：小规模数据下强制树化反而降低性能，这也是先扩容后树化的原因之一。</p>
<h5 data-id="heading-11">误区3：TreeNode只是红黑树节点</h5>
<p><strong>错误理解</strong>：树化后节点完全变为树结构，丢失链表特性。</p>
<p><strong>产生原因</strong>：从"链表转红黑树"的名称产生的直观误解。</p>
<p><strong>正确事实</strong>：TreeNode保留了prev/next指针形成双向链表，便于：①快速退化回链表 ②迭代遍历 ③与LinkedHashMap结构兼容。</p>
<p><strong>面试考点</strong>：为什么TreeNode要继承LinkedHashMap.Entry而非直接实现树节点？</p>
<h5 data-id="heading-12">误区4：树化后就不再扩容</h5>
<p><strong>错误理解</strong>：一旦桶转化为红黑树，该桶就不会再参与扩容rehash。</p>
<p><strong>产生原因</strong>：认为树结构固定，忽略HashMap动态增长的特性。</p>
<p><strong>正确事实</strong>：树化后整个HashMap仍可能扩容。扩容时树会被拆分为两个链表或两棵较小的树（若拆分后节点≤6则退化为链表）。</p>
<p><strong>场景对应</strong>：先树化后持续插入大量数据的情况。</p>
<h5 data-id="heading-13"/>
<h5 data-id="heading-14">误区5：树化阈值8是随意设置的</h5>
<p><strong>错误理解</strong>：数字8没有特殊意义，只是工程师的经验值。</p>
<p><strong>产生原因</strong>：不了解HashMap设计的统计学基础。</p>
<p><strong>正确事实</strong>：基于泊松分布，在理想hash函数下，链表长度达到8的概率仅为0.00000006（千万分之六）。这是平衡"防御极端情况"和"避免过度优化"的数学结果。</p>
<h5 data-id="heading-15">误区6：所有HashMap实现树化规则相同</h5>
<p><strong>错误理解</strong>：HashMap、ConcurrentHashMap、LinkedHashMap的树化逻辑完全一致。</p>
<p><strong>产生原因</strong>：认为JDK集合框架采用统一设计。</p>
<p><strong>正确事实</strong>：ConcurrentHashMap树化需加锁且可能失败，LinkedHashMap要考虑访问顺序维护，不同Map实现有不同的约束和优化。</p>
<h5 data-id="heading-16">误区7：树化主要优化查询操作</h5>
<p><strong>错误理解</strong>：树化只是为了加快查找速度。</p>
<p><strong>产生原因</strong>：链表主要缺点是查询慢，自然认为树化针对查询优化。</p>
<p><strong>正确事实</strong>：树化优化所有需要定位节点的操作（增删改查）。但在频繁修改场景，树的平衡维护开销可能抵消查找收益。</p>
<h5 data-id="heading-17">误区8：自定义对象作为Key不必担心树化</h5>
<p><strong>错误理解</strong>：树化是HashMap内部机制，与Key对象无关。</p>
<p><strong>产生原因</strong>：开发者只关注功能实现，忽略性能影响。</p>
<p><strong>正确事实</strong>：劣质hashCode()会导致异常树化。如所有对象返回相同hashCode，HashMap会退化为单桶红黑树，内存暴增且失去哈希表优势。</p>
<p><strong>防护建议</strong>：实现hashCode()时使用Objects.hash()组合关键字段。</p>
<h5 data-id="heading-18">误区9：实际开发中经常遇到树化</h5>
<p><strong>错误理解</strong>：HashMap经常使用红黑树结构。</p>
<p><strong>产生原因</strong>：学习时过度关注树化机制，误以为它是常见状态。</p>
<p><strong>正确事实</strong>：正常使用下树化概率极低。若生产中大量出现TreeNode，需要排查：①hashCode实现问题 ②哈希碰撞攻击 ③数据分布异常。</p>
<h5 data-id="heading-19">误区10：退化阈值6是8的简单对称</h5>
<p><strong>错误理解</strong>：8树化所以8退化，为了对称美观。</p>
<p><strong>产生原因</strong>：未考虑系统稳定性的工程需求。</p>
<p><strong>正确事实</strong>：6→8的缓冲带防止"抖动现象"。若阈值相同，当节点数在阈值附近反复时，会导致频繁的树化↔退化转换，产生不必要的性能开销。</p>
<hr/>
<p><strong>关于作者</strong>：一个正在求职的Java开发者，坚持通过项目实践和技术写作提升自己。GitHub: [@yangziyue](<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FYzy000000" title="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FYzy000000" target="_blank">Yzy000000</a> | 掘金: <a href="https://link.juejin.cn/?target=" target="_blank" title="https://link.juejin.cn/?target=">@Wiittch</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[前端向架构突围系列 - 状态数据设计 [8 - 3]：服务端状态与客户端状态的架构分离]]></title>    <link>https://juejin.cn/post/7604080364353536027</link>    <guid>https://juejin.cn/post/7604080364353536027</guid>    <pubDate>2026-02-09T01:48:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7604080364353536027" data-draft-id="7604037348608507942" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="前端向架构突围系列 - 状态数据设计 [8 - 3]：服务端状态与客户端状态的架构分离"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-02-09T01:48:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="前端王壮壮"/> <meta itemprop="url" content="https://juejin.cn/user/4473272506789485"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            前端向架构突围系列 - 状态数据设计 [8 - 3]：服务端状态与客户端状态的架构分离
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4473272506789485/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    前端王壮壮
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-09T01:48:14.000Z" title="Mon Feb 09 2026 01:48:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"「";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"」";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"✓";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><blockquote>
<p><strong>写在前面</strong></p>
<p>架构师的核心能力之一是<strong>分类</strong>。 如果你觉得状态管理很痛苦，通常是因为你试图用同一种工具处理两种截然不同的东西：</p>
<ol>
<li><strong>客户端状态 (Client State):</strong> 比如“侧边栏是否展开”、“当前的夜间模式”。它们是同步的、瞬间完成的、由前端完全控制。</li>
<li><strong>服务端状态 (Server State):</strong> 比如“用户订单列表”。它们是异步的、可能失效的、由后端控制。</li>
</ol>
<p><strong>Redux 并不擅长管理 Server State。</strong> 真正专业的做法是：让 Redux 回归 UI，让 <strong>TanStack Query (React Query)</strong> 接管 API。</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d9f6f5986f94242a443885bf85de09c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv546L5aOu5aOu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771206494&amp;x-signature=uHWxDd5HMJlf7Tqefazr1Yj2Duo%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-0">一、 为什么要把 API 赶出 Redux？</h2>
<h3 data-id="heading-1">1.1 消失的“样板代码”</h3>
<p>在传统的 Redux 处理 API 流程中，你需要写：</p>
<ul>
<li>一个 <code>Constant</code> 定义 <code>FETCH_USER_REQUEST</code></li>
<li>一个 <code>Action Creator</code></li>
<li>一个处理 <code>Pending/Success/Error</code> 的 <code>Reducer</code></li>
<li>一个 <code>useEffect</code> 来触发请求</li>
</ul>
<p>而在 <strong>TanStack Query</strong> 中，这只需要一行代码：</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">const</span> { data, isLoading } = <span class="hljs-title function_ invoke__">useQuery</span>({ <span class="hljs-attr">queryKey</span>: [<span class="hljs-string">'user'</span>], <span class="hljs-attr">queryFn</span>: fetchUser });
</code></pre>
<h3 data-id="heading-2">1.2 缓存与失效：Redux 的盲区</h3>
<p>Server State 最难的不是“获取”，而是**“维护”**。</p>
<ul>
<li>用户离开页面 5 分钟后回来，数据还是新的吗？</li>
<li>两个组件同时请求同一个接口，会发两次请求吗？</li>
<li>弱网环境下，请求失败了会自动重试吗？ 如果要用 Redux 实现这些，你需要写几百行复杂的 Middleware。而这些，是 Server State 管理工具的<strong>标配</strong>。</li>
</ul>
<hr/>
<h2 data-id="heading-3">二、 架构模型：双层数据流</h2>
<p>现代前端架构推荐采用 <strong>“双层分离”</strong> 模型：</p>
<h3 data-id="heading-4">2.1 外部层：服务端状态 (Server State)</h3>
<ul>
<li><strong>工具：</strong> TanStack Query (React Query) 或 SWR。</li>
<li><strong>职责：</strong> 缓存管理、自动预取、失效检查 (Stale-While-Revalidate)、请求去重。</li>
<li><strong>特点：</strong> 它是<strong>异步</strong>的。</li>
</ul>
<h3 data-id="heading-5">2.2 内部层：客户端状态 (Client State)</h3>
<ul>
<li><strong>工具：</strong> Zustand, Pinia, Jotai 或简单的 React Context。</li>
<li><strong>职责：</strong> 管理纯粹的 UI 逻辑（开关、多语言、主题、临时草稿）。</li>
<li><strong>特点：</strong> 它是<strong>同步</strong>的。</li>
</ul>
<hr/>
<h2 data-id="heading-6">三、 实战战术：从“手动挡”切换到“自动挡”</h2>
<h3 data-id="heading-7">3.1 自动化的依赖追踪</h3>
<p>想象一个场景：你修改了用户的头像，你需要更新所有显示头像的地方。</p>
<ul>
<li><strong>旧模式 (Redux):</strong> 修改成功后，手动发起一个 <code>updateUserAction</code> 去修改 Redux 里的那个大对象。</li>
<li><strong>新模式 (Query):</strong> 只需要执行一次“失效（Invalidate）”。</li>
</ul>

<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// 当用户修改个人资料成功时</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">mutation</span> = <span class="hljs-title function_ invoke__">useMutation</span>({
  <span class="hljs-attr">mutationFn</span>: updateProfile,
  <span class="hljs-attr">onSuccess</span>: () =&gt; {
    <span class="hljs-comment">// 告诉系统：['user'] 这个 key 下的数据脏了，请自动重新拉取</span>
    queryClient.<span class="hljs-title function_ invoke__">invalidateQueries</span>({ <span class="hljs-attr">queryKey</span>: [<span class="hljs-string">'user'</span>] })
  },
})
</code></pre>
<p><strong>架构意义：</strong> 你的代码不再需要关心“数据怎么同步”，只需要关心“数据何时失效”。</p>
<h3 data-id="heading-8">3.2 乐观更新 (Optimistic Updates)</h3>
<p>这是架构高级感的核心。当用户点赞时，我们不等后端返回，直接改 UI。</p>
<p>TanStack Query 允许你在 <code>onMutate</code> 中手动修改缓存副本，如果请求失败，它会自动回滚。这种复杂的逻辑如果写在 Redux 里，会让 Reducer 逻辑变得极度臃肿。</p>
<hr/>
<h2 data-id="heading-9">四、 选型决策：什么时候该用谁？</h2>
<p>作为架构师，你需要给团队划清界限：</p>



































<table><thead><tr><th>状态类型</th><th>典型例子</th><th>推荐工具</th><th>存储位置</th></tr></thead><tbody><tr><td><strong>API 数据</strong></td><td>商品列表、用户信息</td><td><strong>TanStack Query</strong></td><td>专用 Cache 池</td></tr><tr><td><strong>全局 UI 状态</strong></td><td>登录 Token、全局主题</td><td><strong>Zustand / Pinia</strong></td><td>全局 Store</td></tr><tr><td><strong>局部 UI 状态</strong></td><td>某个弹窗的开关</td><td><strong>useState</strong></td><td>组件内部</td></tr><tr><td><strong>复杂表单</strong></td><td>多步骤注册表单</td><td><strong>React Hook Form</strong></td><td>专用 Form State</td></tr></tbody></table>
<p>导出到 Google 表格</p>
<hr/>
<h2 data-id="heading-10">五、 总结：让 Redux 变“瘦”</h2>
<p>通过把 API 逻辑剥离出去，你会发现你的 Redux（或者 Zustand）Store 瞬间缩水了 <strong>80%</strong> 。 剩下的代码变得极其纯粹：只有纯同步的 UI 逻辑。</p>
<p>这种**“分治”**带来的好处是巨大的：</p>
<ol>
<li><strong>心智负担降低：</strong> 你不再需要管理复杂的 <code>loading</code> 状态机。</li>
<li><strong>性能提升：</strong> TanStack Query 的细粒度缓存比 Redux 的全量对比快得多。</li>
<li><strong>开发效率：</strong> 团队成员可以更专注地编写业务逻辑，而不是在样板代码中挣扎。</li>
</ol>
<hr/>
<h2 data-id="heading-11">结语：控制的艺术</h2>
<p>我们已经成功地将 API 数据和 UI 状态分开了。 但还有一种状态最让架构师头疼：<strong>流程状态</strong>。 当你的业务逻辑包含“待支付 -&gt; 支付中 -&gt; 支付成功/失败 -&gt; 申请退款 -&gt; 已关闭”这种复杂的链路时，无论你用什么工具，代码里都会充满 <code>if/else</code>。</p>
<p>这种逻辑该如何优雅地管理？</p>
<blockquote>
<p><strong>Next Step:</strong> 下一节，我们将引入一个在航天和游戏领域应用了几十年的数学模型。 我们将学习如何用“图”的思想，终结代码里的逻辑乱麻。</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[分布式一致性（三）：共识的黎明——Quorum 机制与 Basic Paxos]]></title>    <link>https://juejin.cn/post/7603673564909420579</link>    <guid>https://juejin.cn/post/7603673564909420579</guid>    <pubDate>2026-02-08T15:22:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603673564909420579" data-draft-id="7603671627004231720" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="分布式一致性（三）：共识的黎明——Quorum 机制与 Basic Paxos"/> <meta itemprop="keywords" content="分布式,后端,算法"/> <meta itemprop="datePublished" content="2026-02-08T15:22:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="若水不如远方"/> <meta itemprop="url" content="https://juejin.cn/user/1239904847665709"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            分布式一致性（三）：共识的黎明——Quorum 机制与 Basic Paxos
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1239904847665709/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    若水不如远方
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T15:22:53.000Z" title="Sun Feb 08 2026 15:22:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读14分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"「"}.markdown-body strong:after{content:"」"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"❝";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"❞";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">前言</h2>
<p>在上一篇中，我们见证了原子提交协议的挫败：2PC 败在同步阻塞与单点故障，3PC 试图用超时自决来打补丁，却在网络分区面前制造了更严重的脑裂。</p>
<p>它们失败的根因是<strong>全员模型</strong>——要求所有节点都参与且都存活。只要有一个节点失联，系统要么阻塞，要么分裂。</p>
<p>在第二篇末尾，我们提出了破局思路：<strong>放弃全员，拥抱多数派</strong>。业务层的原子提交改不掉，但可以用一组机器组成高可用集群来替代脆弱的单点组件，集群内部通过多数派机制同步状态，只要半数以上节点存活，该组件就不会挂。</p>
<p>但"多数派"并不是一句口号，它是一个需要严格证明的数学性质，也是一套需要精密设计的工程协议。</p>
<p>本篇，我们将从多数派的数学基础出发，一步步推演出分布式共识领域最经典的算法——<strong>Basic Paxos</strong>。</p>
<h2 data-id="heading-1">一、思想飞跃：从"全员"到"多数派"</h2>
<h3 data-id="heading-2">为什么多数派不会脑裂？</h3>
<p>上一篇提到，3PC 的脑裂根源在于：网络分区后，两个子网络各自独立做决策，产生了冲突的结果。</p>
<p>多数派机制的核心保证是：<strong>在一个 N 节点的系统中，任何两个多数派集合必然存在交集</strong>。</p>
<p>这听起来很直觉，但让我们用数学语言严格表述。</p>
<h3 data-id="heading-3">集合交集定律（Intersection Property）</h3>
<p>假设系统有 N 个节点，我们定义多数派为任意一个包含超过 N/2 个节点的子集。</p>
<p><strong>定理</strong>：任意两个多数派集合 Q₁ 和 Q₂，必然满足 Q₁ ∩ Q₂ ≠ ∅。</p>
<p><strong>证明</strong>：反证法。假设 Q₁ ∩ Q₂ = ∅，即两个集合没有公共元素，那么 |Q₁| + |Q₂| ≤ N。但根据多数派定义，|Q₁| &gt; N/2 且 |Q₂| &gt; N/2，因此 |Q₁| + |Q₂| &gt; N。矛盾。证毕。</p>
<p>以 5 节点系统为例，多数派至少需要 3 个节点：</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph Q1 [多数派 Q₁]
        A[节点A]
        B[节点B]
        C[节点C]
    end
    
    subgraph Q2 [多数派 Q₂]
        C2[节点C]
        D[节点D]
        E[节点E]
    end
    
    C --- C2

    style A fill:#4ecdc4
    style B fill:#4ecdc4
    style C fill:#ff6b6b
    style C2 fill:#ff6b6b
    style D fill:#ffe66d
    style E fill:#ffe66d
    
    style Q1 fill:#fdfdfd,stroke:#ddd,stroke-dasharray: 5 5
    style Q2 fill:#fdfdfd,stroke:#ddd,stroke-dasharray: 5 5
</code></pre>
<p>无论你怎么挑，任意两组 3 节点的集合至少共享 1 个节点（上图中的节点 C）。这个共享节点就是<strong>信息的桥梁</strong>——它同时参与两次决策，就能把第一次的结果传递给第二次。</p>
<h3 data-id="heading-4">Quorum NWR 模型</h3>
<p>集合交集定律在工程中的经典应用就是 <strong>Quorum NWR 模型</strong>。假设一个数据有 N 个副本：</p>
<ul>
<li><strong>W（Write Quorum）</strong>：写入时需要确认的副本数</li>
<li><strong>R（Read Quorum）</strong>：读取时需要查询的副本数</li>
</ul>
<p>只要满足 <strong>W + R &gt; N</strong>，读写集合就必然存在交集，读操作一定能看到最新写入的数据。</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    subgraph 系统["5 副本系统 (N=5)"]
        subgraph WQ ["写入集合 W=3"]
            N1["副本1 ✏️"]
            N2["副本2 ✏️"]
            N3["副本3 ✏️🔍"]
        end
        subgraph RQ ["读取集合 R=3"]
            N3b["副本3 ✏️🔍"]
            N4["副本4 🔍"]
            N5["副本5 🔍"]
        end
    end
    
    N3 -.-|"交集：携带最新数据"| N3b

    style N1 fill:#4ecdc4
    style N2 fill:#4ecdc4
    style N3 fill:#ff6b6b
    style N3b fill:#ff6b6b
    style N4 fill:#ffe66d
    style N5 fill:#ffe66d
    style WQ fill:#fdfdfd,stroke:#ddd,stroke-dasharray: 5 5
    style RQ fill:#fdfdfd,stroke:#ddd,stroke-dasharray: 5 5
    style 系统 fill:#fdfdfd,stroke:#ddd,stroke-dasharray: 5 5
</code></pre>
<p>几种典型的 NWR 配置：</p>

































<table><thead><tr><th>配置</th><th>W</th><th>R</th><th>特点</th><th>典型场景</th></tr></thead><tbody><tr><td>强一致读写</td><td>3</td><td>3</td><td>读写都走多数派，强一致</td><td>配置中心、分布式锁</td></tr><tr><td>读优化</td><td>3</td><td>1</td><td>写慢读快，但读只访问一个节点无法保证一致</td><td>读多写少（需配合版本号）</td></tr><tr><td>写优化</td><td>1</td><td>5</td><td>写快读慢，读时必须查全量才能保证看到最新值</td><td>日志写入、消息队列</td></tr></tbody></table>
<h3 data-id="heading-5">从 Quorum 到共识的距离</h3>
<p>Quorum NWR 解决了"读到最新数据"的问题，但还不够。在分布式系统中，一个更棘手的问题是：</p>
<blockquote>
<p><strong>如果两个客户端同时向多数派发起写入，一个要写 X=1，另一个要写 X=2，最终系统该取谁的值？</strong></p>
</blockquote>
<p>Quorum 模型本身没有回答这个问题。它只保证"读写有交集"，但不保证"写写之间的顺序"。</p>
<p>要解决写冲突问题，我们需要一个严格的<strong>共识协议</strong>——让所有节点就"选择哪个值"达成一致。</p>
<p>这就是 Paxos 登场的原因。</p>
<h2 data-id="heading-6">二、Basic Paxos：在混乱中达成共识</h2>
<h3 data-id="heading-7">问题定义</h3>
<p>Paxos 要解决的问题可以精炼为一句话：</p>
<blockquote>
<p><strong>多个节点各自提出一个值（Propose），所有节点最终就同一个值达成一致（Consensus）。</strong></p>
</blockquote>
<p>这个"一致"需要满足三个条件：</p>
<ol>
<li><strong>只有被提出的值才能被选定</strong>（不会凭空冒出一个值）</li>
<li><strong>只有一个值会被选定</strong>（不会出现两个结果）</li>
<li><strong>值一旦被选定，就不会改变</strong>（决定不可撤回）</li>
</ol>
<h3 data-id="heading-8">角色定义</h3>
<p>Paxos 中有三种角色：</p>
<ul>
<li><strong>提议者（Proposer）</strong>：发起提案，试图让自己的值被选定。可以类比为"提案的发起人"。</li>
<li><strong>接受者（Acceptor）</strong>：对提案进行投票。多数派 Acceptor 接受同一个提案，该提案就被选定。</li>
<li><strong>学习者（Learner）</strong>：不参与投票，只是被动获知最终结果。</li>
</ul>
<blockquote>
<p>💡实际系统中，一个物理节点通常同时扮演多个角色。比如在一个 5 节点集群中，每个节点既是 Proposer 也是 Acceptor。</p>
</blockquote>
<h3 data-id="heading-9">从朴素方案到 Paxos</h3>
<p>我们不直接给出 Paxos 的协议，而是从一个最朴素的想法出发，看看会遇到什么问题，然后一步步修正，最终"推导"出 Paxos。</p>
<h4 data-id="heading-10">尝试一：只有一个 Acceptor</h4>
<p>最简单的方案：只用一个 Acceptor，谁先到就选谁。</p>
<pre><code class="hljs language-mermaid" lang="mermaid">---
config:
  theme: forest
  look: neo
---
sequenceDiagram
    participant PA as Proposer A
    participant Acc as 唯一 Acceptor
    participant PB as Proposer B
    
    PA-&gt;&gt;Acc: 提案: X=1
    Note over Acc: 接受 X=1 ✅
    PB-&gt;&gt;Acc: 提案: X=2
    Note over Acc: 已有值，拒绝 ❌
</code></pre>
<p>问题显而易见：<strong>单点故障</strong>。这个唯一的 Acceptor 一旦宕机，整个系统停摆。和 2PC 的协调者一样的老问题。</p>
<h4 data-id="heading-11">尝试二：多个 Acceptor，值直接写入</h4>
<p>用多个 Acceptor，Proposer 将提案发给所有 Acceptor，获得多数派接受就算选定。</p>
<p>但考虑这个场景：</p>
<pre><code class="hljs language-mermaid" lang="mermaid">---
config:
  theme: forest
  look: neo
---
sequenceDiagram
    participant PA as Proposer A
    participant A1 as Acceptor 1
    participant A2 as Acceptor 2
    participant A3 as Acceptor 3
    participant PB as Proposer B

    PA-&gt;&gt;A1: X=1
    PA-&gt;&gt;A2: X=1
    PB-&gt;&gt;A2: X=2
    PB-&gt;&gt;A3: X=2
    
    Note over A1: 接受 X=1
    Note over A2: 先收到 X=1？&lt;br/&gt;还是先收到 X=2？
    Note over A3: 接受 X=2
</code></pre>
<p>Acceptor 2 同时收到两个提案，它该接受哪个？如果它接受了 X=1，那 A（多数派 {1,2}）胜出；如果接受了 X=2，那 B（多数派 {2,3}）胜出。</p>
<p>更糟糕的是，如果网络延迟导致 A1 接受了 X=1，A3 接受了 X=2，A2 两个都收到了——<strong>我们没有任何机制来仲裁谁先谁后</strong>。</p>
<p>问题出在哪？<strong>没有全局排序</strong>。我们需要一种方式来区分提案的"先后"或"优先级"。</p>
<h4 data-id="heading-12">尝试三：给提案编号</h4>
<p>这是 Paxos 最关键的洞察：<strong>给每个提案分配一个全局唯一且递增的编号（Proposal Number）</strong>。</p>
<p>编号大的提案优先级更高。如果 Acceptor 已经见过编号更大的提案，就拒绝编号更小的。</p>
<p>但光有编号还不够。考虑以下场景：</p>
<ol>
<li>Proposer A 用编号 1 发起提案 X=1，获得多数派 {A1, A2} 接受，<strong>值已经被选定</strong>。</li>
<li>Proposer B 用编号 2 发起提案 X=2，因为编号更大，如果 Acceptor 直接接受，就会覆盖已选定的值。</li>
</ol>
<p>这违反了我们的第三条要求："值一旦被选定，就不会改变"。</p>
<p><strong>核心矛盾：新提案的编号更大，但它不能覆盖已经被选定的值。</strong></p>
<p>Paxos 的天才之处在于：用<strong>两阶段协议</strong>解决这个矛盾。</p>
<h3 data-id="heading-13">Paxos 两阶段协议</h3>
<h4 data-id="heading-14">阶段一：Prepare（抢占提案权）</h4>
<pre><code class="hljs language-text" lang="text">Proposer                       Acceptors
   │                              │
   │──── Prepare(n) ─────────────&gt;│  "我要用编号 n 发起提案，行不行？"
   │                              │
   │&lt;─── Promise(n) ──────────────│  "行，我承诺不再接受编号比 n 小的提案"
   │     + (acceptedN, acceptedV) │  "另外，我有一份之前接受的提案，一起给你"
</code></pre>
<p>具体规则：</p>
<ol>
<li>Proposer 生成一个全局递增的提案编号 n，向<strong>所有</strong> Acceptor 广播 <code>Prepare(n)</code>。</li>
<li>Acceptor 检查编号 n：比自己见过的都大 → 做出承诺，并附带自己<strong>已接受的提案编号和值</strong> <code>(acceptedN, acceptedV)</code>（没接受过就不带）；否则直接拒绝。</li>
<li>Proposer 只需等到<strong>多数派</strong>回复 Promise，即可进入下一阶段。</li>
</ol>
<h4 data-id="heading-15">阶段二：Accept（值的落地）</h4>
<pre><code class="hljs language-arduino" lang="arduino">Proposer                       Acceptors
   │                              │
   │ 确定值 v                      │
   │──── <span class="hljs-built_in">Accept</span>(n, v) ───────────&gt;│  <span class="hljs-string">"请接受提案(n, v)"</span>
   │                              │
   │&lt;─── Accepted / Rejected ─────│  <span class="hljs-string">"收到！"</span> 或 <span class="hljs-string">"不行，我已经承诺了更大的编号"</span>
   │                              │
   └────&gt; Learners ───────────────&gt;  通知学习者结果
</code></pre>
<p><strong>值 v 怎么定？</strong> 这是 Paxos 最关键的约束，如果多数派的 Promise 响应中：</p>
<ol>
<li><strong>没有任何带回已接受的提案</strong> → Proposer 可以自由使用自己想提的值。</li>
<li><strong>有带回了已接受的提案</strong> → 不同 Acceptor 可能在不同时间接受过不同 Proposer 的提案，返回的 <code>(acceptedN, acceptedV)</code> 各不相同。Proposer <strong>必须选 acceptedN 最大的那个对应的值</strong>。理由：编号越大说明提案越晚发起，它的值越可能已经被多数派接受，继承它才不会覆盖已有的共识。</li>
</ol>
<p>确定 v 后：</p>
<ol>
<li>
<p>发出 <code>Accept(n, v)</code>——<strong>n 是自己的编号，v 可能是别人的值</strong>。</p>
</li>
<li>
<p>Acceptor 收到后：自己没承诺过更大的编号 → 接受；否则 → 拒绝。</p>
</li>
<li>
<p>多数派接受 → <strong>共识达成，值 v 被选定。</strong></p>
</li>
</ol>
<p>完整流程：</p>
<pre><code class="hljs language-mermaid" lang="mermaid">---
config:
  theme: forest
  look: neo
---
sequenceDiagram
    autonumber
    participant P as Proposer
    participant A1 as Acceptor 1
    participant A2 as Acceptor 2
    participant A3 as Acceptor 3

    rect rgb(240, 248, 255)
    Note over P,A3: 阶段一：Prepare（抢占提案权）
    P-&gt;&gt;A1: Prepare(n=1)
    P-&gt;&gt;A2: Prepare(n=1)
    P-&gt;&gt;A3: Prepare(n=1)
    A1--&gt;&gt;P: Promise(无已接受提案)
    A2--&gt;&gt;P: Promise(无已接受提案)
    A3--&gt;&gt;P: Promise(无已接受提案)
    end

    Note over P: 收到多数派响应&lt;br/&gt;无已接受提案&lt;br/&gt;自由选值 v="X"

    rect rgb(240, 255, 240)
    Note over P,A3: 阶段二：Accept（值的落地）
    P-&gt;&gt;A1: Accept(n=1, v="X")
    P-&gt;&gt;A2: Accept(n=1, v="X")
    P-&gt;&gt;A3: Accept(n=1, v="X")
    A1--&gt;&gt;P: Accepted ✅
    A2--&gt;&gt;P: Accepted ✅
    A3--&gt;&gt;P: Accepted ✅
    end

    Note over P,A3: 多数派接受 → 值 "X" 被选定 🎉
</code></pre>
<h3 data-id="heading-16">核心问题：为什么新 Proposer 能"看见"旧值？</h3>
<p>这是理解 Paxos 的关键。让我们用一个具体场景来演示：</p>
<p><strong>场景</strong>：Proposer A 的提案已经被部分接受，然后 Proposer B 发起了新的提案。</p>
<pre><code class="hljs language-mermaid" lang="mermaid">---
config:
  theme: forest
  look: neo
---
sequenceDiagram
    autonumber
    participant PA as Proposer A
    participant A1 as Acceptor 1
    participant A2 as Acceptor 2
    participant A3 as Acceptor 3
    participant PB as Proposer B

    Note over PA,A3: Proposer A 的回合

    rect rgb(240, 248, 255)
    PA-&gt;&gt;A1: Prepare(n=1)
    PA-&gt;&gt;A2: Prepare(n=1)
    A1--&gt;&gt;PA: Promise ✅
    A2--&gt;&gt;PA: Promise ✅
    end

    rect rgb(240, 255, 240)
    PA-&gt;&gt;A1: Accept(1, "X")
    PA-&gt;&gt;A2: Accept(1, "X")
    Note over A1: 已接受 (1, "X") ✅
    Note over A2: 已接受 (1, "X") ✅
    end

    Note over PA: 💥 Proposer A 宕机&lt;br/&gt;未通知 A3

    Note over PB,A3: Proposer B 的回合

    rect rgb(255, 248, 220)
    PB-&gt;&gt;A2: Prepare(n=2)
    PB-&gt;&gt;A3: Prepare(n=2)
    A2--&gt;&gt;PB: Promise + 已接受(1, "X") 📢
    A3--&gt;&gt;PB: Promise(无已接受提案)
    end

    Note over PB: 发现已有接受值 "X"&lt;br/&gt;必须沿用此值！

    rect rgb(240, 255, 240)
    PB-&gt;&gt;A2: Accept(2, "X")
    PB-&gt;&gt;A3: Accept(2, "X")
    Note over A2: 已接受 (2, "X") ✅
    Note over A3: 已接受 (2, "X") ✅
    end

    Note over PB,A3: 多数派 {A2, A3} 接受 → "X" 被选定 🎉
</code></pre>
<p><strong>关键步骤解读</strong>：</p>
<ol>
<li>Proposer A 让 {A1, A2} 接受了值 "X"（已构成多数派，值其实已经被选定），但 A 自己宕机了，没来得及通知 A3。</li>
<li>Proposer B 发起 <code>Prepare(n=2)</code>，询问 {A2, A3}（构成多数派）。</li>
<li>A2 回复："我承诺不再接受编号 &lt;2 的提案，<strong>但我之前已经接受了 (1, "X")</strong>"。</li>
<li>B 看到 A2 返回了已接受值 "X"，根据 Paxos 规则，<strong>必须使用 "X" 而不是自己的值</strong>。</li>
<li>B 用编号 2 发起 <code>Accept(2, "X")</code>，"X" 继续被传播。</li>
</ol>
<p><strong>这就是集合交集发挥作用的地方</strong>：</p>
<ul>
<li>A 的写入多数派是 {A1, A2}</li>
<li>B 的 Prepare 多数派是 {A2, A3}</li>
<li>交集是 {A2}，A2 将旧值 "X" 传递给了 B</li>
</ul>
<p><strong>没有 A2 这个"信息桥梁"，B 就不知道 "X" 已经被选定，可能会写入一个不同的值。</strong> 多数派的交集保证了任何新的 Proposer 都能发现旧值。</p>
<h3 data-id="heading-17">安全性论证</h3>
<p>我们来严格论证为什么 Paxos 不会出现"两个不同的值都被选定"的情况。</p>
<p><strong>反证法</strong>：假设值 v₁ 被选定（多数派 Q₁ 接受了提案 (n₁, v₁)），之后值 v₂ ≠ v₁ 也被选定（多数派 Q₂ 接受了提案 (n₂, v₂)，n₂ &gt; n₁）。</p>
<ol>
<li>v₂ 被选定，意味着 Proposer 在发起提案 n₂ 之前，先执行了 <code>Prepare(n₂)</code>，并获得了多数派 Q₃ 的承诺。</li>
<li>Q₁ ∩ Q₃ ≠ ∅（集合交集定律），所以 Q₃ 中至少有一个 Acceptor 已经接受了 (n₁, v₁)。</li>
<li>这个 Acceptor 在回复 <code>Prepare(n₂)</code> 时，必然返回了它已接受的值 v₁（或编号更大的其他值）。</li>
<li>根据 Paxos 规则，Proposer 必须使用返回值中编号最大的值。如果这个最大编号值可以追溯回 v₁，那么 v₂ = v₁，矛盾。</li>
</ol>
<blockquote>
<p>严格的数学归纳证明需要对 n₁ 到 n₂ 之间所有提案编号做归纳，这里给出核心直觉。</p>
</blockquote>
<h2 data-id="heading-18">三、活锁：Paxos 的致命软肋</h2>
<p>Basic Paxos 保证了<strong>安全性（Safety）</strong>——永远不会选定两个冲突的值。但它不保证<strong>活性（Liveness）</strong>——系统有可能永远选不出值。</p>
<h3 data-id="heading-19">活锁场景</h3>
<p>当两个 Proposer 交替抢占时，可能出现"你踩我，我踩你"的死循环：</p>
<pre><code class="hljs language-mermaid" lang="mermaid">---
config:
  theme: forest
  look: neo
---
sequenceDiagram
    participant PA as Proposer A
    participant Acc as Acceptors (多数派)
    participant PB as Proposer B

    PA-&gt;&gt;Acc: Prepare(n=1)
    Acc--&gt;&gt;PA: Promise(1) ✅
    
    Note over PB: B 用更大编号抢占
    PB-&gt;&gt;Acc: Prepare(n=2)
    Acc--&gt;&gt;PB: Promise(2) ✅
    
    PA-&gt;&gt;Acc: Accept(1, "X")
    Acc--&gt;&gt;PA: 拒绝 ❌ (已承诺n=2)

    Note over PA: A 用更大编号反抢
    PA-&gt;&gt;Acc: Prepare(n=3)
    Acc--&gt;&gt;PA: Promise(3) ✅
    
    PB-&gt;&gt;Acc: Accept(2, "Y")
    Acc--&gt;&gt;PB: 拒绝 ❌ (已承诺n=3)
    
    Note over PA,PB: 循环往复，永远无法达成共识...
</code></pre>
<p><strong>过程分析</strong>：</p>
<ol>
<li>A 发起 <code>Prepare(1)</code>，获得承诺。</li>
<li>B 发起 <code>Prepare(2)</code>，编号更大，Acceptor 转而承诺 B。</li>
<li>A 的 <code>Accept(1, ...)</code> 被拒绝——Acceptor 已经承诺了更大的编号 2。</li>
<li>A 不甘心，发起 <code>Prepare(3)</code>，又抢回承诺。</li>
<li>B 的 <code>Accept(2, ...)</code> 被拒绝。</li>
<li>B 发起 <code>Prepare(4)</code>……如此反复。</li>
</ol>
<p>两个 Proposer 互相踩脚，谁都无法完成 Accept 阶段。理论上这个过程可以无限持续。</p>
<h3 data-id="heading-20">解药：选一个 Leader</h3>
<p>活锁的根源是<strong>多个 Proposer 并发竞争</strong>。解决方案很直观：<strong>选出一个 Leader，让它独占提案权</strong>。</p>
<p>这就是 <strong>Multi-Paxos</strong> 的核心思想：</p>
<ol>
<li>先通过一轮 Basic Paxos 选出一个 Leader。</li>
<li>只有 Leader 能发起提案。其他节点将请求转发给 Leader。</li>
<li>Leader 存活期间，Prepare 阶段只需执行一次，后续提案直接进入 Accept 阶段，<strong>将两阶段协议优化为一阶段</strong>。</li>
</ol>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph Phase1 ["第一轮：Basic Paxos 选举 Leader"]
        direction LR
        P["Prepare(n)"] --&gt; Promise["多数派 Promise"]
        Promise --&gt; A["Accept(n, Leader=X)"]
        A --&gt; Chosen["多数派 Accepted&lt;br/&gt;X 当选 Leader ✅"]
    end

    subgraph Phase2 ["后续：客户端转发给 Leader，直接 Accept"]
        direction LR
        C1["Client 请求 v1"] --&gt;|转发| L["Leader X"]
        C2["Client 请求 v2"] --&gt;|转发| L
        C3["Client 请求 v3"] --&gt;|转发| L
        L --&gt; A1["Accept v1 ✅"]
        L --&gt; A2["Accept v2 ✅"]
        L --&gt; A3["Accept v3 ✅"]
    end

    Phase1 --&gt;|"Leader 存活期间&lt;br/&gt;无需再 Prepare"| Phase2

    style P fill:#ffe66d
    style Promise fill:#ffe66d
    style A fill:#ffe66d
    style Chosen fill:#ff6b6b
    style C1 fill:#f0f0f0
    style C2 fill:#f0f0f0
    style C3 fill:#f0f0f0
    style L fill:#ff6b6b
    style A1 fill:#4ecdc4
    style A2 fill:#4ecdc4
    style A3 fill:#4ecdc4
    style Phase1 fill:#fdfdfd,stroke:#ddd,stroke-dasharray: 5 5
    style Phase2 fill:#fdfdfd,stroke:#ddd,stroke-dasharray: 5 5
</code></pre>
<p><strong>性能对比</strong>：</p>

























<table><thead><tr><th/><th>Basic Paxos</th><th>Multi-Paxos</th></tr></thead><tbody><tr><td>每次提案的网络轮次</td><td>2 轮（Prepare + Accept）</td><td>1 轮（仅 Accept）</td></tr><tr><td>并发冲突风险</td><td>高（活锁）</td><td>低（Leader 独占）</td></tr><tr><td>Leader 故障影响</td><td>无 Leader 概念</td><td>需要重新选举</td></tr></tbody></table>
<p>Multi-Paxos 大幅提升了效率，但 Paxos 的原论文只给出了核心思想，并未定义完整的工程实现细节（比如 Leader 怎么选、日志怎么管理）。这也是为什么后来 <strong>Raft</strong> 算法诞生时，将"可理解性"作为首要设计目标——它本质上就是一个<strong>工程化的 Multi-Paxos</strong>。</p>
<h2 data-id="heading-21">总结</h2>
<p>本篇我们完成了从"全员模型"到"多数派模型"的关键跨越：</p>
<ul>
<li><strong>集合交集定律</strong>是多数派机制的数学基石。W + R &gt; N 保证了任意两个多数派必然存在交集，信息不会丢失。</li>
<li><strong>Basic Paxos</strong> 用两阶段协议（Prepare + Accept）解决了多数派模型下的写冲突问题。Prepare 阶段通过编号抢占实现全局排序，Accept 阶段通过"继承旧值"保证已选定的值不会被覆盖。</li>
<li><strong>活锁</strong>是 Basic Paxos 的固有缺陷，多个 Proposer 并发竞争可能导致系统无法推进。解药是引入 Leader，即 Multi-Paxos。</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A["全员模型&lt;br/&gt;2PC/3PC"] --&gt;|"容错为0&lt;br/&gt;分区即崩溃"| B["多数派模型&lt;br/&gt;Quorum"]
    B --&gt;|"解决写冲突"| C["Basic Paxos&lt;br/&gt;两阶段共识"]
    C --&gt;|"解决活锁"| D["Multi-Paxos&lt;br/&gt;Leader 机制"]
    D --&gt;|"工程化规范"| E["Raft"]
    
    style A fill:#ff6b6b
    style B fill:#ffe66d
    style C fill:#4ecdc4
    style D fill:#4ecdc4
    style E fill:#4ecdc4
</code></pre>
<blockquote>
<p><strong>下篇预告：</strong></p>
<p>Multi-Paxos 指明了方向——选一个 Leader，由它来统一调度。但具体怎么选？Leader 怎么把日志安全地复制到所有节点？Leader 挂了怎么保证数据不丢？</p>
<p>下一篇，我们将深入 <strong>Raft 算法</strong>，看它如何用"任期（Term）"和"日志复制（Log Replication）"两把利剑，把 Multi-Paxos 的思想落地为一套清晰可实现的工程方案。</p>
</blockquote>
<hr/>
<p><strong>思考题</strong></p>
<ol>
<li>在一个 5 节点系统中，如果有 3 个节点同时宕机，Paxos 还能工作吗？为什么？</li>
</ol>
<details> <summary>参考答案</summary> <div> <b>不能工作。</b><br/><br/> <ul> <li><b>原因</b>：5 节点系统的多数派需要至少 3 个节点。如果 3 个节点宕机，只剩 2 个节点，无法构成多数派。</li> <li><b>Prepare 阶段</b>：Proposer 无法获得 3 个 Acceptor 的承诺，因此无法进入 Accept 阶段。</li> <li><b>安全性保证</b>：系统不会做出错误的决定（不会选定两个冲突的值），但会停止服务——牺牲可用性来保证一致性。</li> <li><b>N 节点系统的容错上限</b>：最多容忍 ⌊(N-1)/2⌋ 个节点故障，5 节点最多容忍 2 个。</li> </ul> <b>总结</b>：这正是 CAP 定理的体现——在网络分区（或节点故障）时，Paxos 选择了一致性（C），牺牲了可用性（A）。 </div> </details>
<ol start="2">
<li>Paxos 的 Prepare 阶段返回"已接受的最大编号提案"，如果不返回这个信息会怎样？</li>
</ol>
<details> <summary>参考答案</summary> <div> <b>会导致已选定的值被覆盖，破坏一致性。</b><br/><br/> <b>具体场景：</b> <ul> <li>Proposer A 用编号 1 让多数派接受了值 "X"（值已被选定）</li> <li>Proposer B 用编号 2 发起 Prepare，如果 Acceptor 不返回已接受的值——</li> <li>B 不知道 "X" 已被选定，自由选择了 "Y"</li> <li>B 发起 Accept(2, "Y")，因为编号更大，Acceptor 接受了</li> <li>结果：系统先选定了 "X"，又选定了 "Y"，一致性被破坏</li> </ul> <b>本质</b>：Prepare 阶段返回已接受值，是 Paxos 的"信息传递机制"。正是通过多数派的交集，新 Proposer 才能发现旧值并继承它，这是 Paxos 安全性的核心保障。 </div> </details>
<ol start="3">
<li>提案编号（Proposal Number）在实际系统中如何生成？怎样保证全局唯一且递增？</li>
</ol>
<details> <summary>参考答案</summary> <div> <b>常用方案：轮次 + 节点ID</b><br/><br/> <ul> <li><b>编号格式</b>：<code>proposal_number = round * N + node_id</code>，其中 N 是节点总数，node_id 是节点的唯一编号（0 到 N-1）</li> <li><b>举例（3 节点系统）</b>： <ul> <li>节点0 第一轮：0×3+0=0，第二轮：1×3+0=3，第三轮：2×3+0=6</li> <li>节点1 第一轮：0×3+1=1，第二轮：1×3+1=4，第三轮：2×3+1=7</li> <li>节点2 第一轮：0×3+2=2，第二轮：1×3+2=5，第三轮：2×3+2=8</li> </ul> </li> <li><b>特点</b>：不同节点生成的编号天然不会重复；每个节点只需维护本地的 round 计数器；递增通过增加 round 值实现</li> <li><b>优化</b>：节点在收到其他提案的编号后，可以将自己的 round 更新为 <code>max(本地round, 收到的编号/N) + 1</code>，避免使用过时的小编号</li> </ul> <b>总结</b>：这个方案简洁高效，无需中心化的编号分配器，是 Paxos 工程实现中的经典设计。 </div> </details></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[⏰前端周刊第 452 期（2026年2月2日-2月8日）]]></title>    <link>https://juejin.cn/post/7604012106154360878</link>    <guid>https://juejin.cn/post/7604012106154360878</guid>    <pubDate>2026-02-09T01:49:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7604012106154360878" data-draft-id="7604646882015019059" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="⏰前端周刊第 452 期（2026年2月2日-2月8日）"/> <meta itemprop="keywords" content="前端,JavaScript,GitHub"/> <meta itemprop="datePublished" content="2026-02-09T01:49:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="掘金安东尼"/> <meta itemprop="url" content="https://juejin.cn/user/1521379823340792"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ⏰前端周刊第 452 期（2026年2月2日-2月8日）
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1521379823340792/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    掘金安东尼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-09T01:49:08.000Z" title="Mon Feb 09 2026 01:49:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>📢 <strong>宣言</strong>：<strong>每周更新国外论坛的前端热门文章，推荐大家阅读/翻译，紧跟时事，掌握前端技术动态，也为写作或突破新领域提供灵感~</strong></p>
<p>欢迎大家访问：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTUARAN%2Ffrontend-weekly-digest-cn" target="_blank" title="https://github.com/TUARAN/frontend-weekly-digest-cn" ref="nofollow noopener noreferrer">github.com/TUARAN/fron…</a>
顺手点个 ⭐ star 支持，是我们持续输出的续航电池🔋✨！</p>
<p>在线网址：<a href="https://link.juejin.cn?target=https%3A%2F%2Ffrontendweekly.cn%2F" target="_blank" title="https://frontendweekly.cn/" ref="nofollow noopener noreferrer">frontendweekly.cn/</a></p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f563534b00f41edb2da1a5042327d04~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR5a6J5Lic5bC8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771206548&amp;x-signature=8zwYVmIbMuWqqD8KMiYtojZ%2FtLw%3D" alt="前端周刊封面" loading="lazy"/></p>
<hr/>
<p>💬 <strong>推荐语</strong></p>
<p>本期聚焦“交互组件选择 + 浏览器行为细节 + 生态工具更新”。Web 开发部分从组合框/多选/列表框的选型指南、浏览器对“意外”变更的敏感反应，到“不要把单词拆成字母”的可访问性提醒；工具与性能板块涵盖 Deno 生态新进展、ESLint 10 发布、ViteLand 月报、以及 SVG/视频与 Node.js 版本演进的性能分析。CSS 方面关注 @scope、@container scroll-state()、bar chart 与 clamp() 等现代特性；JavaScript 则有 Temporal 提案、显式资源管理、框架选型与 React/Angular 的新范式探讨。</p>
<hr/>
<h2 data-id="heading-0">🗂 本期精选目录</h2>
<h3 data-id="heading-1">🧭 Web 开发</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.smashingmagazine.com%2F2026%2F02%2Fcombobox-vs-multiselect-vs-listbox%2F" target="_blank" title="https://www.smashingmagazine.com/2026/02/combobox-vs-multiselect-vs-listbox/" ref="nofollow noopener noreferrer">组合框 vs 多选 vs 列表框：如何选择合适的控件</a>：通过任务目标、输入方式与可访问性维度，梳理三种控件的适用场景与常见误用。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ffrontendmasters.com%2Fblog%2Fthe-browser-hates-surprises%2F" target="_blank" title="https://frontendmasters.com/blog/the-browser-hates-surprises/" ref="nofollow noopener noreferrer">浏览器讨厌惊喜</a>：解析浏览器对布局抖动、同步布局读取等“意外变化”的反应机制与优化建议。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fadrianroselli.com%2F2026%2F02%2Fyou-know-what-just-dont-split-words-into-letters.html" target="_blank" title="https://adrianroselli.com/2026/02/you-know-what-just-dont-split-words-into-letters.html" ref="nofollow noopener noreferrer">你知道吗？别再把单词拆成字母了</a>：提醒不要用逐字拆分的方式做视觉效果，否则会严重破坏可访问性与可读性。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.logrocket.com%2Fshadcn-ui-adoption-guide%2F" target="_blank" title="https://blog.logrocket.com/shadcn-ui-adoption-guide/" ref="nofollow noopener noreferrer">Shadcn UI 采用指南：概览、示例与替代方案</a>：从接入方式、组件定制到生态对比，给出更务实的选型与迁移建议。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.developerway.com%2Fposts%2Fdebugging-with-ai" target="_blank" title="https://www.developerway.com/posts/debugging-with-ai" ref="nofollow noopener noreferrer">用 AI 调试：能取代资深开发者吗？</a>：探讨 AI 在调试中的价值边界与使用方式，强调人类经验仍是关键。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwebkit.org%2Fblog%2F17808%2Finterop-2025-review%2F" target="_blank" title="https://webkit.org/blog/17808/interop-2025-review/" ref="nofollow noopener noreferrer">Interop 2025：趋同的一年</a>：回顾 2025 的浏览器互操作进展，总结关键落地能力与下一步方向。</li>
</ul>
<h4 data-id="heading-2">🛠 工具</h4>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeno.com%2Fblog%2Fintroducing-deno-sandbox" target="_blank" title="https://deno.com/blog/introducing-deno-sandbox" ref="nofollow noopener noreferrer">Introducing Deno Sandbox</a>：Deno Sandbox 发布：更安全的执行环境与更细粒度的权限控制思路。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeno.com%2Fblog%2Fdeno-deploy-is-ga" target="_blank" title="https://deno.com/blog/deno-deploy-is-ga" ref="nofollow noopener noreferrer">Deno Deploy 正式 GA</a>：Deno Deploy 进入 GA：面向边缘部署的能力完善与产品层面的重要里程碑。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Feslint.org%2Fblog%2F2026%2F02%2Feslint-v10.0.0-released%2F" target="_blank" title="https://eslint.org/blog/2026/02/eslint-v10.0.0-released/" ref="nofollow noopener noreferrer">ESLint v10.0.0 发布</a>：ESLint 10 更新概览：新特性、破坏性变更与迁移指引。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fvoidzero.dev%2Fposts%2Fwhats-new-jan-2026" target="_blank" title="https://voidzero.dev/posts/whats-new-jan-2026" ref="nofollow noopener noreferrer">ViteLand 2026 年 1 月新动态</a>：Vite/Rolldown 生态月报，了解近期工具链与插件动向。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fremysharp.com%2F2026%2F02%2F02%2Fjs-bin-down-in-2026" target="_blank" title="https://remysharp.com/2026/02/02/js-bin-down-in-2026" ref="nofollow noopener noreferrer">JS Bin 在 2026 年下线</a>：经典在线编辑器 JS Bin 的关闭说明与后续替代建议。</li>
</ul>
<h4 data-id="heading-3">⚡️ 性能</h4>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.phpied.com%2Fmeasuring-svg-rendering-time%2F" target="_blank" title="https://www.phpied.com/measuring-svg-rendering-time/" ref="nofollow noopener noreferrer">测量 SVG 渲染时间</a>：分析 SVG 渲染的测量方法与指标，帮助定位性能瓶颈。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ffrontendmasters.com%2Fblog%2Fperformance-optimized-video-embeds-with-zero-javascript%2F" target="_blank" title="https://frontendmasters.com/blog/performance-optimized-video-embeds-with-zero-javascript/" ref="nofollow noopener noreferrer">零 JavaScript 的性能优化视频嵌入</a>：用更轻的 HTML/CSS 方案减少视频首屏成本。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.repoflow.io%2Fblog%2Fnode-js-16-to-25-benchmarks-how-performance-evolved-over-time" target="_blank" title="https://www.repoflow.io/blog/node-js-16-to-25-benchmarks-how-performance-evolved-over-time" ref="nofollow noopener noreferrer">Node.js 16 到 25 的性能基准</a>：从多版本基准测试观察 Node.js 性能演进与回归趋势。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fallenpike.com%2F2026%2Fa-broken-heart%2F" target="_blank" title="https://allenpike.com/2026/a-broken-heart/" ref="nofollow noopener noreferrer">破碎的心：一行傻代码带来 100 倍提速</a>：一个真实的 100x 加速案例，强调定位热点与微改动的重要性。</li>
</ul>
<h3 data-id="heading-4">🎨 CSS</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Futilitybend.com%2Fblog%2Fis-it-scrolled-is-it-not-lets-find-out-with-css-container-scroll-state-queries%2F" target="_blank" title="https://utilitybend.com/blog/is-it-scrolled-is-it-not-lets-find-out-with-css-container-scroll-state-queries/" ref="nofollow noopener noreferrer">到底滚了没有？用 CSS @container scroll-state() 查询判断</a>：介绍 scroll-state() 的用法与可实现的交互模式。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fnerdy.dev%2Fnice-select" target="_blank" title="https://nerdy.dev/nice-select" ref="nofollow noopener noreferrer">Nice Select</a>：精致的选择框样式与实现思路，适合作为组件设计参考。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.smashingmagazine.com%2F2026%2F02%2Fcss-scope-alternative-naming-conventions%2F" target="_blank" title="https://www.smashingmagazine.com/2026/02/css-scope-alternative-naming-conventions/" ref="nofollow noopener noreferrer">CSS @scope：命名约定与重度抽象的替代方案</a>：用 @scope 控制样式作用域，降低命名和层级复杂度。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ffrontendmasters.com%2Fblog%2Fan-over-the-top-spoiler-design-with-the-details-element%2F" target="_blank" title="https://frontendmasters.com/blog/an-over-the-top-spoiler-design-with-the-details-element/" ref="nofollow noopener noreferrer">基于 details 的夸张剧透设计</a>：展示如何利用 <code>details/summary</code> 做互动式“剧透”组件。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.projectwallace.com%2Fthe-css-selection%2F2026" target="_blank" title="https://www.projectwallace.com/the-css-selection/2026" ref="nofollow noopener noreferrer">CSS Selection 2026：真实世界 CSS 使用现状</a>：通过统计数据观察 CSS 特性在实际项目中的应用分布。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcss-tricks.com%2Fcss-bar-charts-using-modern-functions%2F" target="_blank" title="https://css-tricks.com/css-bar-charts-using-modern-functions/" ref="nofollow noopener noreferrer">用现代函数构建 CSS 条形图</a>：结合 <code>calc()</code>、<code>clamp()</code> 等函数实现数据可视化布局。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fkizu.dev%2Fshrinkwrap-solution%2F" target="_blank" title="https://kizu.dev/shrinkwrap-solution/" ref="nofollow noopener noreferrer">Shrinkwrap 新实验方案</a>：探索 shrinkwrap 相关布局问题的实验性解法。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcss-tip.com%2Fclamp-auto%2F" target="_blank" title="https://css-tip.com/clamp-auto/" ref="nofollow noopener noreferrer">如何在 clamp() 中使用 “auto”</a>：解释 <code>auto</code> 在 <code>clamp()</code> 中的可用模式与注意点。</li>
</ul>
<h3 data-id="heading-5">💡 JavaScript</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblogs.igalia.com%2Fcompilers%2F2026%2F01%2F31%2Fimplementing-the-temporal-proposal-in-javascriptcore%2F" target="_blank" title="https://blogs.igalia.com/compilers/2026/01/31/implementing-the-temporal-proposal-in-javascriptcore/" ref="nofollow noopener noreferrer">在 JavaScriptCore 中实现 Temporal 提案</a>：从引擎角度理解 Temporal 的设计与实现细节。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fallthingssmitty.com%2F2026%2F02%2F02%2Fexplicit-resource-management-in-javascript%2F" target="_blank" title="https://allthingssmitty.com/2026/02/02/explicit-resource-management-in-javascript/" ref="nofollow noopener noreferrer">JavaScript 的显式资源管理</a>：介绍显式资源管理语法与应用场景，提升可控性与可靠性。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.inngest.com%2Fblog%2Fmigrating-off-nextjs-tanstack-start" target="_blank" title="https://www.inngest.com/blog/migrating-off-nextjs-tanstack-start" ref="nofollow noopener noreferrer">本地开发时间减少 83%：为何迁出 Next.js</a>：团队迁移决策与性能收益复盘，适合评估框架成本与边界。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.logrocket.com%2Freact-remix-vs-next-js-vs-sveltekit%2F" target="_blank" title="https://blog.logrocket.com/react-remix-vs-next-js-vs-sveltekit/" ref="nofollow noopener noreferrer">Remix vs. Next.js vs. SvelteKit</a>：对比三大框架在路由、数据加载与开发体验上的差异。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fanita-app.com%2Fblog%2Farticles%2Freact-compiler-and-why-class-objects-work-against-memoization.html" target="_blank" title="https://anita-app.com/blog/articles/react-compiler-and-why-class-objects-work-against-memoization.html" ref="nofollow noopener noreferrer">React Compiler 与类对象对 memoization 的影响</a>：解释类对象为何不利于编译器优化与记忆化。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.syncfusion.com%2Fblogs%2Fpost%2Fincremental-hydration-in-angular-apps" target="_blank" title="https://www.syncfusion.com/blogs/post/incremental-hydration-in-angular-apps" ref="nofollow noopener noreferrer">Angular 的增量式水合：构建“瞬时可交互”的 SSR 应用</a>：增量水合思路与实践路径，提升首屏体验与可交互性。</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Elpis 总结]]></title>    <link>https://juejin.cn/post/7603911453704192043</link>    <guid>https://juejin.cn/post/7603911453704192043</guid>    <pubDate>2026-02-08T10:46:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603911453704192043" data-draft-id="7603644943350153222" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Elpis 总结"/> <meta itemprop="keywords" content="低代码,JSON"/> <meta itemprop="datePublished" content="2026-02-08T10:46:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="酒精检测仪"/> <meta itemprop="url" content="https://juejin.cn/user/3087868572205982"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Elpis 总结
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3087868572205982/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    酒精检测仪
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T10:46:53.000Z" title="Sun Feb 08 2026 10:46:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读9分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">简述</h2>
<p>elpis 是一个沉淀了 80% 的标准性、重复性的 CRUD 工作，又提供了 20% 的个性化扩展的前端框架，能基于一份 json 配置快速搭建标准的中后台管理系统页面，同时保障稳定性与可靠性。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1deabb6fa2084af4a16a99107de9c33f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YWS57K-5qOA5rWL5Luq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771152507&amp;x-signature=Sdkwcss%2Briryx%2Ff1j2XXqn%2BMHqw%3D" alt="elpis" loading="lazy"/></p>
<p>elpis 的整体架构如上。它是一个 BFF 层的架构，是前后端的桥梁。</p>
<ul>
<li>从一份领域模型 model 的 json 配置（如商品管理），可以拓宽到各个业务系统（如淘宝商品管理、京东商品管理）。
<ul>
<li>json 满足 json-shema 规范，定义前后端统一校验与数据库表设计，同时扩展出 UI 组件的配置</li>
</ul>
</li>
<li>经过 elpis BFF 的处理，可 SSR 渲染各个业务系统的首页，提升首页的渲染速度。首页内菜单系统的切换是采用的 vue-router 的 SPA，保证其流畅性。</li>
<li>在 elpis 中，提供了常用的如 input、select等基础 UI 组件，同时支持业务方自定义组件与页面，满足业务特性需求。</li>
<li>接口遵循 restful 规范，交互同样经过 elpis。借助洋葱圈模型思想，支持了全局错误捕获、签名校验、参数校验、日志记录等多个中间件</li>
<li>实现不同环境的 webpack 差异化配置，满足开发与生产的不同需求</li>
</ul>
<h2 data-id="heading-1">基于 koa 设计服务端引擎</h2>
<p>为了统一代码规范，提升开发效率，借鉴 egg 的思路，设计了 elpis-core 服务端引擎
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c150951adeb94fd7b4d0c82b5d71a519~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YWS57K-5qOA5rWL5Luq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771152507&amp;x-signature=CdXhXrKSy6mgQONdCrSf323bf%2B4%3D" alt="elpis-core" loading="lazy"/></p>
<h3 data-id="heading-2">loader 自动加载</h3>
<p>为了减少在代码中各种 require 导致的依赖不清晰，elpis 设计了约定式的目录结构，在对应目录下的文件导出的实例都会被挂在 app 对象上。具体说来，eipis 借用 glob 和 path 两个工具，将相应文件夹下的 js 文件的文件名统一改为驼峰式命名，同时实例化对象并挂载到 app 下。如 <code>app/middleware/api-params-verify.js</code> 中的实例最终会处理成<code>app.middlewares.apiParamsVerify</code>。这样可以通过 app 对象访问到任何模块，而不需要require。</p>
<pre><code class="hljs language-rust" lang="rust">app/controller<span class="hljs-comment">/**/</span>**.js      -<span class="hljs-punctuation">-&gt;</span>  app.controller.xxx
app/extend<span class="hljs-comment">/**/</span>**.js          -<span class="hljs-punctuation">-&gt;</span>  app.extend.xxx
app/middleware<span class="hljs-comment">/**/</span>**.js      -<span class="hljs-punctuation">-&gt;</span>  app.middleware.xxx
app/router<span class="hljs-comment">/**/</span>**.js          -<span class="hljs-punctuation">-&gt;</span>  app.router.xxx
app/router-schema<span class="hljs-comment">/**/</span>**.js   -<span class="hljs-punctuation">-&gt;</span>  app.routerSchema.xxx
app/service<span class="hljs-comment">/**/</span>**.js         -<span class="hljs-punctuation">-&gt;</span>  app.service.xxx
app/config<span class="hljs-comment">/**/</span>**.js          -<span class="hljs-punctuation">-&gt;</span>  app.config.xxx
</code></pre>
<h3 data-id="heading-3">中间件设计</h3>
<p>利用洋葱圈模型，请求（包含业务请求和 API 请求）经过一层层的中间件过滤，再进行业务逻辑的处理，将处理后的结果再一层层返回。</p>
<p>elpis 中定义了三个基础中间件：</p>
<ol>
<li>全局错误捕获。在最外层，最先使用，catch 住后续所有的错误并记录日志。再进行错误分析，如果是请求不存在的页面，则重定向到主页，不会导致页面白屏；如果是 API 请求报错，则统一返回<code>code: 50000, message: "网络异常 请稍后重试"</code>，不会导致接口无响应。</li>
<li>签名校验。对接口请求，将 key 和时间戳进行 md5 加密。防止恶意请求，减少服务压力。</li>
<li>参数校验。从 ctx 上下文中获取接口的 body、query、header等参数并记录日志，结合 ajv + json-schema，看是否满足<code>model/**.json</code>中的字段定义的规则。如不满足，直接拦截。</li>
</ol>
<p>此外，业务方可根据自己的需求定义额外的中间件。</p>
<h2 data-id="heading-4">基于 webpack 搭建前端工程化</h2>
<h3 data-id="heading-5">开发环境热更新</h3>
<p>由于首页采用 SSR 渲染，需要将模板 .tpl 文件输出到磁盘，方便后端能拿到最新的模板渲染页面。而现有的 hmr 服务如 webpack-dev-server 将<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.webpackjs.com%2Fguides%2Fdevelopment%2F%23using-webpack-dev-server" target="_blank" title="https://www.webpackjs.com/guides/development/#using-webpack-dev-server" ref="nofollow noopener noreferrer">所有文件保存到内存中</a>，无法满足需求，故采用 webpack-dev-middleware 和 webpack-hot-middleware 实现定制的 hmr 服务（webpack-dev-server 就是封对二者进行了封装）。
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/33b79a66d9174f2d97ced8e268621717~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YWS57K-5qOA5rWL5Luq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771152507&amp;x-signature=QrdCdaVrd8seKOptSoW8UKospMA%3D" alt="hmr" loading="lazy"/>
如图，实现 hmr 服务需要两个基础能力：</p>
<ol>
<li>监控能力。使用 webpack-dev-middleware 监控到业务文件的改变，触发解析引擎工作，将编译后的新的 js/css 文件替换掉内存中旧的。</li>
<li>通讯能力。使用 webpack-hot-middleware 进行通讯，通过 webSocket与浏览器保持长连接，推送文件变动事件（如 hash-changed ）和新模块的加载指令（如 js/css 文件路径）。浏览器接收到通知后，从内存中动态请求新的产物文件，执行模块替换。</li>
</ol>
<p>此外，还需进行两处配置：</p>
<ol>
<li>由于 hmr 服务是通过 express 启动的，与后端 elpis-core 服务在不同的端口上，需要配置跨域请求允许。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fwebpack%2Fwebpack-hot-middleware" target="_blank" title="https://github.com/webpack/webpack-hot-middleware" ref="nofollow noopener noreferrer">客户端也需要被注入 hmr 的代码</a>。所以需要在每个每个入口文件都加上 webpack-hot-middleware 的客户端代码，指定 HMR 的通信路径和端口。</li>
</ol>
<h3 data-id="heading-6">构建与打包</h3>
<p>不同的运行环境需要不同的配置，elpis 中一共使用了三份 webpack 文件。在 webpack.base.js 中定义了通用需配置，然后在开发环境和生产环境中通过 webpack-merge 插件的 <code>merge.smart</code> 引入通用配置并拓展当前环境所需的配置。</p>
<ol>
<li>通用配置。
<ul>
<li><code>vue-loader</code>,  <code>babel-loader</code> , <code>style-loader</code> 等各种 loader 解析器</li>
<li>别名配置（模块解析的具体行为）</li>
<li><code>CleanWebpackPlugin</code>，每次build前，清空 public/dist 目录</li>
<li>打包输出优化（代码分割，模块合并，缓存 chunkhash，压缩优化等策略）</li>
</ul>
</li>
<li>开发环境配置。主要是 hmr。</li>
<li>生产环境配置。
<ul>
<li>使用 <code>thread-loader</code> 利用多核 CPU 加快打包速度</li>
<li>使用 <code>mini-css-extract-plugin</code> 抽取 css 文件，不打包到 js 中，否则会阻塞渲染。使用 <code>css-minimizer-webpack-plugin</code> 压缩 css</li>
<li>使用 <code>terser-webpack-plugin</code> 压缩 js</li>
</ul>
</li>
</ol>
<p>总之，开发环境注重的是构建速度，生产环境注重的是文件体积大小与安全稳定性。</p>
<h3 data-id="heading-7">业务拓展</h3>
<p>以上都是 elpis 提供的基础服务，此外 elpis 支持业务自定义工程化配置，只需要在业务对应的目录（/app/webpack.config.js）下编写 webpack 文件即可，elpis会通过 <code>merge.smart</code> 合并到一起。</p>
<p>但 elpis 不止于此，elpis 将约定优于配置发挥的淋漓尽致。除了支持业务自定义工程化配置，还支持自定义页面，自定义组件，只需在<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2F%40hbl.%2Felpis" target="_blank" title="https://www.npmjs.com/package/@hbl./elpis" ref="nofollow noopener noreferrer">约定目录</a>下新建文件即可。这些目录下的文件都会被合并到 elpis 中，使用 elpis 的能力。</p>
<h2 data-id="heading-8">基于 json-schema 设计动态组件体系</h2>
<p>上文说到，elpis 支持配置化开发，用户只需要配置一份 json，即可生成一个完整的页面。如下图，这份 json，不仅仅满足 json-schema 规范，可进行数据校验，elpis 对其功能进行了扩展，可以动态设计 UI 组件。甚至，还能用于辅助数据库建表。
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de43555ec31849819e171e563e916d60~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YWS57K-5qOA5rWL5Luq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771152507&amp;x-signature=y%2FqeQRLjxQTKn9g0mhk4DW4dKZQ%3D" alt="json-schema" loading="lazy"/></p>
<h3 data-id="heading-9">json-schema 规范</h3>
<p>采用 json-schema 有以下几个原因</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fjson-schema.apifox.cn%2F" target="_blank" title="https://json-schema.apifox.cn/" ref="nofollow noopener noreferrer">规范完整</a>，完全满足校验需求，且业界流行度高，有完整的校验库（<a href="https://link.juejin.cn?target=https%3A%2F%2Fajv.nodejs.cn%2F" target="_blank" title="https://ajv.nodejs.cn/" ref="nofollow noopener noreferrer">ajv</a>）支持。</li>
<li>json 只是一份数据，前端、后端、数据库可共用，避免了前后端校验不一致的情况（element-plus 中的校验只能前端使用，没法和后端保持统一）。由于定义了数据类型、是否必填等关键信息，后期数据库建表亦可参照此 json。</li>
<li>可拓展性强。elpis 在满足 json-schema 规范的基础上拓展出了 UI 组件的描述。</li>
</ul>

<pre><code class="hljs language-css" lang="css">...
  product_name: {
    type: <span class="hljs-string">"string"</span>,
    label: <span class="hljs-string">"商品名称"</span>,
    maxLength: <span class="hljs-number">10</span>,
    minLength: <span class="hljs-number">2</span>,
    tableOption: {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">200</span>,
    },
    searchOption: {
      comType: <span class="hljs-string">"dynamicSelect"</span>,
      api: <span class="hljs-string">"/api/proj/product_name/list"</span>,
    },
    createFormOption: {
      comType: <span class="hljs-string">"input"</span>,
      default: <span class="hljs-string">"iPhone 17 pro"</span>,
    },
    editFormOption: {
      comType: <span class="hljs-string">"input"</span>,
    },
    detailPanelOption: {},
  },
...
  tableConfig: {
    headerButtons: [
      {
        <span class="hljs-selector-tag">label</span>: <span class="hljs-string">"新增商品"</span>,
        eventKey: <span class="hljs-string">"showComponent"</span>,
        eventOption: {
          comName: <span class="hljs-string">"createForm"</span>,
        },
        type: <span class="hljs-string">"primary"</span>,
      },
    ],
    rowButtons: [
      {
        <span class="hljs-selector-tag">label</span>: <span class="hljs-string">"详情"</span>,
        eventKey: <span class="hljs-string">"showComponent"</span>,
        eventOption: {
          comName: <span class="hljs-string">"detailPanel"</span>,
        },
        type: <span class="hljs-string">"primary"</span>,
        text: true,
      },
    ],
  },
  componentConfig: {
    createForm: {
      title: <span class="hljs-string">"新增商品"</span>,
      saveBtnText: <span class="hljs-string">"保存"</span>,
    },
  },
...
</code></pre>
<p>示例如上，对于“商品名称”这个字段，4-7 行是 json-schema 规范约束，往后都是 UI 组件描述。如在 tableOption 定义 width: 200, 则商品名称在表格中占据的宽度为200，tableOption 中的所有属性描述，可参照 eloment-plus 的 <a href="https://link.juejin.cn?target=https%3A%2F%2Felement-plus.org%2Fzh-CN%2Fcomponent%2Ftable%23table-column-api" target="_blank" title="https://element-plus.org/zh-CN/component/table#table-column-api" ref="nofollow noopener noreferrer">table-column</a>，elpis 中已经做了绑定。如在 searchOption 中定义的 comType: "dynamicSelect"，标识商品名称在搜索表单中的组件类型是一个动态下拉框，下拉框中的值通过 "/api/proj/product_name/list" 这个接口去获取。</p>
<h3 data-id="heading-10">动态组件设计</h3>
<p>用户在 json 中说明字段需要在哪些地方展示（核心组件和动态组件），使用哪种组件类型（基础控件），elpis 用 Vue 的 component 标签，动态绑定 is 属性，同时给子组件传入对应的 json-schema 约束。通过 ref 收集所有子组件的引用，外层统一处理子组件的相关逻辑（如 validate 和 getValue 方法）。</p>
<ol>
<li>
<p>基础配置</p>
<p>elpis 中提供了 schema-table、schema-search-bar 两个核心组件和 createForm、editForm、detailPanel 三个动态组件 和 input、inputNumber、select、dynamicSelect、dateRange 六个基础控件。用户在 json 中可自由搭配组合，只需满足对应规范，即可配置出一个完整的 CRUD 页面。</p>
</li>
<li>
<p>业务拓展</p>
<p>当基础配置满足不了业务需求时，elpis 支持业务拓展自己的组件。只需在<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2F%40hbl.%2Felpis" target="_blank" title="https://www.npmjs.com/package/@hbl./elpis" ref="nofollow noopener noreferrer">约定目录</a>下新建文件即可。具体说来：</p>
<ul>
<li>编写业务自定义组件</li>
<li>在约定目录下创建组件映射，如 <code>userPanel: { component: UserPanel }</code></li>
<li>elpis 使用 process.cwd 识别到业务约定目录下的映射文件，与自己的基础组件合并，同名会覆盖基础组件</li>
<li>Vue 的 component 标签动态渲染时，从合并后的配置对象里查找组件。无论是 elpis 内置的还是业务扩展的，都能找到</li>
</ul>
</li>
</ol>
<h2 data-id="heading-11">基于 docker 改造项目部署</h2>
<h3 data-id="heading-12">docker</h3>
<ol>
<li>编写 DokcerFile 构建 docker 镜像，保证本地、测试、生产使用的是同一镜像，不会导致环境差异问题</li>
<li>镜像有tag（branch+commit），可以做版本管理，方便出现问题及时回滚</li>
</ol>
<h3 data-id="heading-13">流水线</h3>
<p>基于腾讯 DevOps 2.0-Clound Native Build（cnb）构建 CI/CD 流水线，解决以往手动拉代码、打包、上传、部署的低效问题，只需要配置一次，后续无限复用。</p>
<ol>
<li><code>npm run lint</code> 检查格式化与 js 报错</li>
<li><code>npm install + npm run build</code> 打包</li>
<li><code>docker build + docker push</code> 构建 docker 镜像并推送到镜像仓库</li>
<li>借用 cnbcool/ssh 工具在服务器上 <code>docker pull + docker run</code> 启动最新镜像</li>
</ol>
<h2 data-id="heading-14">后续改进</h2>
<ol>
<li>支持 typescript。现在没有类型提示，编写代码和配置容易出错；</li>
<li>组件联动与通信。现有组件状态无法根据其他组件状态进行动态调整，可参照 <a href="https://link.juejin.cn?target=https%3A%2F%2Fformilyjs.org%2Fzh-CN" target="_blank" title="https://formilyjs.org/zh-CN" ref="nofollow noopener noreferrer">formilyjs</a>解决该问题</li>
<li>可视化配置。现有配置依赖研发编写 json，对非技术人员不友好。设计一个可视化页面，支持对组件的拖拉拽和属性的更改</li>
<li>加上监控看板，实时查看数据。</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[【React-6/Lesson89(2025-12-27)】React Context 详解：跨层级组件通信的最佳实践📚]]></title>    <link>https://juejin.cn/post/7603651011979804714</link>    <guid>https://juejin.cn/post/7603651011979804714</guid>    <pubDate>2026-02-08T12:18:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603651011979804714" data-draft-id="7603895839556436031" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="【React-6/Lesson89(2025-12-27)】React Context 详解：跨层级组件通信的最佳实践📚"/> <meta itemprop="keywords" content="React.js,前端,前端框架"/> <meta itemprop="datePublished" content="2026-02-08T12:18:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Jing_Rainbow"/> <meta itemprop="url" content="https://juejin.cn/user/1285809519198256"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            【React-6/Lesson89(2025-12-27)】React Context 详解：跨层级组件通信的最佳实践📚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1285809519198256/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Jing_Rainbow
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T12:18:00.000Z" title="Sun Feb 08 2026 12:18:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读8分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">🎯 React 组件通信方式概览</h2>
<p>在 React 开发中，组件之间的数据传递是核心问题。目前主要有四种通信方式：</p>
<h3 data-id="heading-1">1️⃣ 父子组件通信</h3>
<p>这是最基础的通信方式，父组件通过 props 将数据传递给子组件。这种方式简单直接，适用于层级较浅的组件关系。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Child</span>(<span class="hljs-params">{ message }</span>) {
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{message}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Child</span> <span class="hljs-attr">message</span>=<span class="hljs-string">"Hello from Parent"</span> /&gt;</span></span>
}
</code></pre>
<h3 data-id="heading-2">2️⃣ 子父组件通信</h3>
<p>子组件通过回调函数将数据传递给父组件。父组件定义一个函数，通过 props 传递给子组件，子组件调用这个函数来传递数据。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Child</span>(<span class="hljs-params">{ onMessage }</span>) {
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> onMessage('Hello from Child')}&gt;发送消息<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleMessage</span> = (<span class="hljs-params">msg</span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(msg)
  }
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Child</span> <span class="hljs-attr">onMessage</span>=<span class="hljs-string">{handleMessage}</span> /&gt;</span></span>
}
</code></pre>
<h3 data-id="heading-3">3️⃣ 兄弟组件通信</h3>
<p>兄弟组件之间的通信通常需要通过共同的父组件作为中转。父组件维护共享状态，兄弟组件通过 props 接收和修改这个状态。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">SiblingA</span>(<span class="hljs-params">{ value, onChange }</span>) {
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> onChange(e.target.value)} /&gt;</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">SiblingB</span>(<span class="hljs-params">{ value }</span>) {
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>输入的值：{value}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [value, setValue] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>)
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">SiblingA</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{setValue}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">SiblingB</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  )
}
</code></pre>
<h3 data-id="heading-4">4️⃣ 跨层级通信</h3>
<p>当组件层级较深时，使用 props 一层层传递数据会变得非常繁琐。这就是 Context 要解决的问题。</p>
<h2 data-id="heading-5">🚀 Context 的诞生背景</h2>
<h3 data-id="heading-6">痛点分析</h3>
<p>在传统的父子组件通信中，如果需要将数据从顶层组件传递到深层嵌套的子组件，就必须经过每一层中间组件。这种方式存在以下问题：</p>
<p><strong>传递路径过长</strong>：数据需要经过多个中间组件，每个组件都需要接收并传递 props，即使它们并不使用这些数据。</p>
<p><strong>维护成本高</strong>：每次修改数据结构或添加新的 props，都需要修改整条传递链路上的所有组件。</p>
<p><strong>代码冗余</strong>：中间组件充满了不相关的 props 传递，代码可读性降低。</p>
<h3 data-id="heading-7">现实类比</h3>
<p>这就像古代的驿站传递制度：皇帝要给边疆的将军送一封密信，必须经过沿途的每个驿站，每个驿站都要接收并转发这封信，即使驿站官员并不关心信的内容。这种传递方式效率低下，而且容易在传递过程中出现问题。</p>
<p>就像《长安的荔枝》中描述的那样，为了将新鲜荔枝从岭南送到长安，需要经过无数驿站，每个驿站都要接力传递，成本极高，风险很大。</p>
<h2 data-id="heading-8">💡 Context 的核心思想</h2>
<p>Context 提供了一种在组件树中共享数据的方式，无需通过 props 一层层传递。它的核心思想是：</p>
<p><strong>数据在查找的上下文里</strong>：在最外层组件提供数据，任何层级的组件都可以直接访问这些数据。</p>
<p><strong>主动查找能力</strong>：需要消费数据的组件拥有主动查找数据的能力，而不是被动接收。</p>
<p><strong>规矩不变</strong>：父组件（外层组件）仍然负责持有和改变数据，只是传递方式从"一路传"变成了"全局提供"。</p>
<h2 data-id="heading-9">📖 Context 的三步使用法</h2>
<h3 data-id="heading-10">第一步：创建 Context 容器</h3>
<p>使用 <code>createContext</code> 创建一个 Context 对象，这个对象就是数据容器。可以传入一个默认值作为参数。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { createContext } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">UserContext</span> = <span class="hljs-title function_">createContext</span>(<span class="hljs-literal">null</span>)
</code></pre>
<p><code>createContext</code> 接受一个默认值参数，当组件在匹配的 Provider 之外使用 Context 时，会使用这个默认值。</p>
<h3 data-id="heading-11">第二步：提供数据</h3>
<p>使用 Context.Provider 组件包裹需要共享数据的组件树，通过 value 属性提供数据。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> user = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"Andrew"</span>
  }
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{user}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Page</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">UserContext.Provider</span>&gt;</span></span>
  )
}
</code></pre>
<p>Provider 组件接受一个 value 属性，这个值会被所有消费该 Context 的组件访问到。Provider 可以嵌套使用，内层的 Provider 会覆盖外层的值。</p>
<h3 data-id="heading-12">第三步：消费数据</h3>
<p>使用 <code>useContext</code> Hook 在组件中消费 Context 数据。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { useContext } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">UserContext</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../App'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">UserInfo</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> user = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">UserContext</span>)
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<p><code>useContext</code> 接受一个 Context 对象作为参数，返回该 Context 的当前值。当 Context 的值发生变化时，使用该 Context 的组件会重新渲染。</p>
<h2 data-id="heading-13">🎨 实战案例：主题切换应用</h2>
<h3 data-id="heading-14">需求分析</h3>
<p>创建一个支持白天/夜间主题切换的应用，主题状态需要在整个应用中共享。这是一个典型的跨层级通信场景。</p>
<h3 data-id="heading-15">项目结构</h3>
<pre><code class="hljs language-css" lang="css">theme-demo/
├── <span class="hljs-attribute">src</span>/
│   ├── App<span class="hljs-selector-class">.jsx</span>
│   ├── contexts/
│   │   └── ThemeContext<span class="hljs-selector-class">.jsx</span>
│   ├── components/
│   │   ├── <span class="hljs-selector-tag">Header</span><span class="hljs-selector-class">.jsx</span>
│   │   └── <span class="hljs-attribute">Content</span><span class="hljs-selector-class">.jsx</span>
│   ├── pages/
│   │   └── Page<span class="hljs-selector-class">.jsx</span>
│   └── theme<span class="hljs-selector-class">.css</span>
</code></pre>
<h3 data-id="heading-16">创建 ThemeContext</h3>
<p>首先创建主题 Context，包含主题状态和切换主题的方法。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { createContext, useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">ThemeContext</span> = <span class="hljs-title function_">createContext</span>(<span class="hljs-literal">null</span>)

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ThemeProvider</span>(<span class="hljs-params">{ children }</span>) {
  <span class="hljs-keyword">const</span> [theme, setTheme] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">'light'</span>)
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">toggleTheme</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">setTheme</span>(<span class="hljs-function">(<span class="hljs-params">prevTheme</span>) =&gt;</span> (prevTheme === <span class="hljs-string">'light'</span> ? <span class="hljs-string">'dark'</span> : <span class="hljs-string">'light'</span>))
  }
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'data-theme'</span>, theme)
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'data-theme'</span>, theme)
  }, [theme])
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">theme</span>, <span class="hljs-attr">toggleTheme</span> }}&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeContext.Provider</span>&gt;</span></span>
  )
}
</code></pre>
<p><strong>关键点解析</strong>：</p>
<ul>
<li><code>useState</code> 管理主题状态，初始值为 'light'</li>
<li><code>toggleTheme</code> 函数使用函数式更新，确保基于前一个状态进行切换</li>
<li><code>useEffect</code> 监听主题变化，同步更新 <code>html</code> 和 <code>body</code> 元素的 <code>data-theme</code> 属性</li>
<li><code>ThemeProvider</code> 作为高阶组件，包裹子组件并提供主题上下文</li>
</ul>
<h3 data-id="heading-17">在应用中使用 ThemeProvider</h3>
<p>在应用的根组件中使用 ThemeProvider 包裹整个组件树。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">ThemeProvider</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./contexts/ThemeContext'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Page</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./pages/Page'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ThemeProvider</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Page</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeProvider</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  )
}
</code></pre>
<h3 data-id="heading-18">在组件中消费主题数据</h3>
<p>在 Header 组件中消费主题数据，显示当前主题并提供切换按钮。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { useContext } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ThemeContext</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../contexts/ThemeContext'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Header</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { theme, toggleTheme } = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">ThemeContext</span>)
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">padding:</span> <span class="hljs-attr">24</span> }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>当前主题：{theme}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{toggleTheme}</span>&gt;</span>
        切换主题
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
{
</code></pre>
<p>在 Page 组件中也可以消费主题数据，实现不同组件共享同一主题状态。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { useContext } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ThemeContext</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../contexts/ThemeContext'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Header</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/Header'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Content</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/Content'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Page</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> theme = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">ThemeContext</span>)
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">padding:</span> <span class="hljs-attr">24</span> }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Header</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Content</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<h2 data-id="heading-19">🎯 CSS 变量实现主题切换</h2>
<p>使用 CSS 变量（Custom Properties）是实现主题切换的优雅方式。CSS 变量允许我们在不同的主题下动态改变样式。</p>
<h3 data-id="heading-20">定义 CSS 变量</h3>
<p>在 <code>theme.css</code> 中定义主题相关的 CSS 变量。</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-pseudo">:root</span> {
  <span class="hljs-attr">--bg-color</span>: pink
  --text-color: <span class="hljs-number">#222</span>
  --primary-color: <span class="hljs-number">#1677ff</span>
}

<span class="hljs-selector-attr">[data-theme=<span class="hljs-string">'dark'</span>]</span> {
  <span class="hljs-attr">--bg-color</span>: <span class="hljs-number">#141414</span>
  --text-color: <span class="hljs-number">#f5f5f5</span>
  --primary-color: <span class="hljs-number">#4e8cff</span>
}
</code></pre>
<p><strong>语法解析</strong>：</p>
<ul>
<li><code>:root</code> 选择器匹配文档的根元素，在这里定义全局 CSS 变量</li>
<li><code>--bg-color</code>、<code>--text-color</code> 等是自定义属性名，必须以 <code>--</code> 开头</li>
<li><code>[data-theme='dark']</code> 是属性选择器，匹配所有 <code>data-theme</code> 属性值为 <code>'dark'</code> 的元素</li>
<li>在不同的选择器中重新定义变量值，实现主题切换</li>
</ul>
<h3 data-id="heading-21">使用 CSS 变量</h3>
<p>在样式中使用 <code>var()</code> 函数引用 CSS 变量。</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">body</span> {
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>
  background-color: <span class="hljs-built_in">var</span>(--bg-color)
  color: <span class="hljs-built_in">var</span>(--text-color)
  transition: all <span class="hljs-number">0.3s</span>
}

<span class="hljs-selector-class">.button</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">8px</span> <span class="hljs-number">16px</span>
  background: <span class="hljs-built_in">var</span>(--primary-color)
  color: <span class="hljs-number">#fff</span>
  border: none
  cursor: pointer
}
</code></pre>
<p><strong>关键特性</strong>：</p>
<ul>
<li><code>var(--bg-color)</code> 引用之前定义的 CSS 变量</li>
<li>当 <code>data-theme</code> 属性改变时，CSS 变量的值会自动更新</li>
<li><code>transition: all 0.3s</code> 实现主题切换的平滑过渡效果</li>
</ul>
<h3 data-id="heading-22">JavaScript 控制 CSS 变量</h3>
<p>通过 JavaScript 动态修改元素的 <code>data-theme</code> 属性，触发 CSS 变量的变化。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'data-theme'</span>, theme)
  <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'data-theme'</span>, theme)
}, [theme])
</code></pre>
<p>当 theme 状态变化时，<code>useEffect</code> 会执行，更新 DOM 元素的属性，从而触发 CSS 变量的重新计算。</p>
<h2 data-id="heading-23">🔍 Context 的高级特性</h2>
<h3 data-id="heading-24">默认值的作用</h3>
<p>Context 的默认值在以下情况下使用：</p>
<ol>
<li>组件在匹配的 Provider 之外使用 Context</li>
<li>Provider 的 value 属性为 undefined</li>
</ol>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">MyContext</span> = <span class="hljs-title function_">createContext</span>(<span class="hljs-string">'默认值'</span>)

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Component</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> value = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">MyContext</span>)
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{value}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Component</span> /&gt;</span></span>
}
</code></pre>
<p>在这个例子中，Component 会显示"默认值"，因为它没有被任何 Provider 包裹。</p>
<h3 data-id="heading-25">Provider 嵌套</h3>
<p>多个 Provider 可以嵌套使用，内层的 Provider 会覆盖外层的值。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">ThemeContext</span> = <span class="hljs-title function_">createContext</span>(<span class="hljs-string">'light'</span>)
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ColorContext</span> = <span class="hljs-title function_">createContext</span>(<span class="hljs-string">'blue'</span>)

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Child</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> theme = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">ThemeContext</span>)
  <span class="hljs-keyword">const</span> color = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">ColorContext</span>)
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>主题：{theme}，颜色：{color}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"dark"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ColorContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"red"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Child</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">ColorContext.Provider</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeContext.Provider</span>&gt;</span></span>
  )
}
</code></pre>
<p>Child 组件会显示"主题：dark，颜色：red"。</p>
<h3 data-id="heading-26">Context 性能优化</h3>
<p>当 Context 的值变化时，所有消费该 Context 的组件都会重新渲染。为了优化性能，可以：</p>
<ol>
<li><strong>拆分 Context</strong>：将频繁变化和不常变化的数据拆分到不同的 Context 中</li>
</ol>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">UserContext</span> = <span class="hljs-title function_">createContext</span>(<span class="hljs-literal">null</span>)
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ThemeContext</span> = <span class="hljs-title function_">createContext</span>(<span class="hljs-literal">null</span>)

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [user, setUser] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>)
  <span class="hljs-keyword">const</span> [theme, setTheme] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">'light'</span>)
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{user}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ThemeContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{theme}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Child</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeContext.Provider</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">UserContext.Provider</span>&gt;</span></span>
  )
}
</code></pre>
<ol start="2">
<li><strong>使用 useMemo</strong>：避免不必要的对象重新创建</li>
</ol>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [theme, setTheme] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">'light'</span>)
  
  <span class="hljs-keyword">const</span> contextValue = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> ({
    theme,
    <span class="hljs-attr">toggleTheme</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setTheme</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> prev === <span class="hljs-string">'light'</span> ? <span class="hljs-string">'dark'</span> : <span class="hljs-string">'light'</span>)
  }), [theme])
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{contextValue}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Child</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeContext.Provider</span>&gt;</span></span>
  )
}
</code></pre>
<ol start="3">
<li><strong>使用 React.memo</strong>：避免不必要的组件重新渲染</li>
</ol>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">ExpensiveComponent</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">memo</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">ExpensiveComponent</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { theme } = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">ThemeContext</span>)
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>主题：{theme}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
})
</code></pre>
<h2 data-id="heading-27">📝 Context 最佳实践</h2>
<h3 data-id="heading-28">1. 合理拆分 Context</h3>
<p>不要将所有数据都放在一个 Context 中，应该根据功能模块合理拆分。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">UserContext</span> = <span class="hljs-title function_">createContext</span>(<span class="hljs-literal">null</span>)
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ThemeContext</span> = <span class="hljs-title function_">createContext</span>(<span class="hljs-literal">null</span>)
<span class="hljs-keyword">const</span> <span class="hljs-title class_">LocaleContext</span> = <span class="hljs-title function_">createContext</span>(<span class="hljs-literal">null</span>)
</code></pre>
<h3 data-id="heading-29">2. 使用自定义 Hook</h3>
<p>封装 Context 的消费逻辑，提供更友好的 API。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useTheme</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> context = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">ThemeContext</span>)
  <span class="hljs-keyword">if</span> (!context) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'useTheme 必须在 ThemeProvider 内部使用'</span>)
  }
  <span class="hljs-keyword">return</span> context
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Component</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { theme, toggleTheme } = <span class="hljs-title function_">useTheme</span>()
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{toggleTheme}</span>&gt;</span>{theme}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
}
</code></pre>
<h3 data-id="heading-30">3. 提供默认值或错误处理</h3>
<p>确保 Context 的使用是安全的，提供合理的默认值或错误处理。</p>
<p>。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useUser</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> user = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">UserContext</span>)
  <span class="hljs-keyword">if</span> (!user) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'useUser 必须在 UserProvider 内部使用'</span>)
  }
  <span class="hljs-keyword">return</span> user
}
</code></pre>
<h3 data-id="heading-31">4. 避免过度使用</h3>
<p>Context 适合用于全局状态，如用户信息、主题、语言设置等。对于局部状态，仍然应该使用 props 或状态管理库。</p>
<h3 data-id="heading-32">5. 文档化 Context</h3>
<p>为 Context 添加清晰的文档说明，包括提供的数据类型和使用方法。</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">/**
 * 用户上下文
 * <span class="hljs-doctag">@type</span> {<span class="hljs-type">React.Context&lt;{
 *   name: string
 *   email: string
 *   role: string
 * </span>}&gt;}
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">UserContext</span> = <span class="hljs-title function_">createContext</span>(<span class="hljs-literal">null</span>)
</code></pre>
<h2 data-id="heading-33">🌟 总结</h2>
<p>React Context 是解决跨层级组件通信的强大工具，它提供了优雅的数据共享方式，避免了 props 传递的繁琐。通过合理使用 Context，可以：</p>
<ul>
<li>简化组件间的数据传递</li>
<li>提高代码的可维护性</li>
<li>实现全局状态管理</li>
<li>构建更灵活的应用架构</li>
</ul>
<p>结合 CSS 变量，Context 可以轻松实现主题切换、国际化等全局功能。在实际开发中，应该根据具体需求选择合适的通信方式，Context 是工具箱中的重要一员，但不是唯一的解决方案。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[vue3响应式解构注意]]></title>    <link>https://juejin.cn/post/7603674653154344969</link>    <guid>https://juejin.cn/post/7603674653154344969</guid>    <pubDate>2026-02-08T12:34:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603674653154344969" data-draft-id="7603721514203873289" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="vue3响应式解构注意"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2026-02-08T12:34:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="用户98245051418"/> <meta itemprop="url" content="https://juejin.cn/user/1725547722057483"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            vue3响应式解构注意
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1725547722057483/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    用户98245051418
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T12:34:32.000Z" title="Sun Feb 08 2026 12:34:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><code>reactive</code> 的响应式是<strong>深度绑定</strong>的（默认递归代理所有嵌套对象），直接解构外层对象得到的嵌套对象，本质还是 <code>reactive</code> 生成的代理对象，因此它本身的响应式不会丢失；但如果对这个嵌套对象再做解构，就会回到之前的问题 —— 解构其属性会丢失响应式。</p>
<h4 data-id="heading-0">代码示例（核心验证）</h4>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-comment">// 创建响应式对象 const user = reactive({ name: '张三', age: 20 }) // 直接解构：丢失响应式 const { name, age } = user  对属性是基本类型时会丢失响应式这时需要用toRefs包裹</span>
<span class="hljs-comment">// 外层响应式对象，包含嵌套对象</span>
<span class="hljs-keyword">const</span> user = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">info</span>: { <span class="hljs-comment">// 嵌套对象，被 reactive 深度代理</span>
    <span class="hljs-attr">name</span>: <span class="hljs-string">'张三'</span>,
    <span class="hljs-attr">age</span>: <span class="hljs-number">20</span>
  },
  <span class="hljs-attr">hobby</span>: [<span class="hljs-string">'篮球'</span>, <span class="hljs-string">'游戏'</span>] <span class="hljs-comment">// 嵌套数组，同样被深度代理</span>
})
<span class="hljs-keyword">const</span> user = <span class="hljs-title function_">reactive</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'张三'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> }) <span class="hljs-comment">// 用 toRefs 解构：保留响应式（转为 ref 类型） const { name, age } = toRefs(user) const changeName = () =&gt; { name.value = '李四' // 需通过 .value 修改，原对象会同步更新 console.log(user.name) // 输出 "李四" }</span>



直接解构外层对象得到的嵌套对象
<span class="hljs-comment">// 直接解构外层对象：拿到嵌套对象 info 和 hobby</span>
<span class="hljs-keyword">const</span> { info, hobby } = user

<span class="hljs-comment">// 场景1：修改解构出的嵌套对象的属性（仍有响应式）</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">changeInfo</span> = (<span class="hljs-params"/>) =&gt; {
  info.<span class="hljs-property">name</span> = <span class="hljs-string">'李四'</span> <span class="hljs-comment">// ✅ 有响应式，视图会更新</span>
  hobby.<span class="hljs-title function_">push</span>(<span class="hljs-string">'看书'</span>) <span class="hljs-comment">// ✅ 有响应式，视图会更新</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user.<span class="hljs-property">info</span>.<span class="hljs-property">name</span>) <span class="hljs-comment">// 输出 "李四"（和原对象同步）</span>
}

<span class="hljs-comment">// 场景2：对嵌套对象再解构（属性丢失响应式）</span>
<span class="hljs-keyword">const</span> { name, age } = info
<span class="hljs-keyword">const</span> <span class="hljs-title function_">changeName</span> = (<span class="hljs-params"/>) =&gt; {
  name = <span class="hljs-string">'王五'</span> <span class="hljs-comment">// ❌ 非响应式，TS 提示无法赋值，视图无变化</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(info.<span class="hljs-property">name</span>) <span class="hljs-comment">// 仍然是 "李四"</span>
}

<span class="hljs-comment">// 场景3：直接替换整个嵌套对象（仍有响应式）</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">replaceInfo</span> = (<span class="hljs-params"/>) =&gt; {
  info.<span class="hljs-property">age</span> = <span class="hljs-number">25</span> <span class="hljs-comment">// ✅ 改属性：响应式</span>
  <span class="hljs-comment">// 注意：如果直接替换整个嵌套对象，也需要通过原对象或解构的嵌套对象操作</span>
  user.<span class="hljs-property">info</span> = { <span class="hljs-attr">name</span>: <span class="hljs-string">'赵六'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> } <span class="hljs-comment">// ✅ 响应式</span>
  <span class="hljs-comment">// 或 info = { name: '赵六', age: 30 } ❌ 错误！解构的 info 是常量，不能直接赋值</span>
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>原对象：{{ user.info.name }} - {{ user.info.age }} | {{ user.hobby }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>解构嵌套对象：{{ info.name }} - {{ info.age }} | {{ hobby }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>解构嵌套对象的属性：{{ name }} - {{ age }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"changeInfo"</span>&gt;</span>修改嵌套对象属性<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"changeName"</span>&gt;</span>修改解构的嵌套属性<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"replaceInfo"</span>&gt;</span>替换嵌套对象<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<p>运行结果：</p>
<ul>
<li>点击「修改嵌套对象属性」：所有关联视图（原对象、解构的嵌套对象）都会更新；</li>
<li>点击「修改解构的嵌套属性」：视图无变化，嵌套对象的属性也没改；</li>
<li>点击「替换嵌套对象」：原对象和解构的嵌套对象视图都会更新。</li>
</ul>
<h3 data-id="heading-1">二、原理拆解：为什么嵌套对象仍有响应式？</h3>
<ol>
<li><code>reactive</code> 对对象做<strong>深度代理</strong>：当创建 <code>reactive({ info: { name: '张三' } })</code> 时，不仅外层对象被 <code>Proxy</code> 代理，内部的 <code>info</code> 对象也会被递归转为 <code>Proxy</code> 代理对象；</li>
<li>直接解构 <code>const { info } = user</code>：拿到的 <code>info</code> 是 <code>reactive</code> 生成的<strong>代理对象本身</strong>（而非原始值），因此访问 / 修改 <code>info.name</code> 仍会触发响应式的依赖收集和更新；</li>
<li>解构嵌套对象的属性 <code>const { name } = info</code>：拿到的是 <code>info.name</code> 的<strong>原始值</strong>（如字符串 "张三"），而非代理属性，因此丢失响应式。</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[像搭积木一样思考：数据科学中的“自下而上”之道]]></title>    <link>https://juejin.cn/post/7603958579179634688</link>    <guid>https://juejin.cn/post/7603958579179634688</guid>    <pubDate>2026-02-09T01:51:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603958579179634688" data-draft-id="7603699739224686607" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="像搭积木一样思考：数据科学中的“自下而上”之道"/> <meta itemprop="keywords" content="Python,数据分析,数据挖掘"/> <meta itemprop="datePublished" content="2026-02-09T01:51:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="databook"/> <meta itemprop="url" content="https://juejin.cn/user/3526889035006702"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            像搭积木一样思考：数据科学中的“自下而上”之道
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3526889035006702/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    databook
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-09T01:51:15.000Z" title="Mon Feb 09 2026 01:51:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>最近几年，基本已经不做应用系统的开发了，主要做一些数据分析和机器学习相关的应用（业务复杂度不高），因此，对于以前熟悉的各种软件模式也逐渐生疏。</p>
<p>今天，偶尔又翻到保罗·格雷厄姆（Paul Graham）之前写过的一篇关于 Lisp 和编程本质的文章《自下而上的编程》，感觉这种源于黑客文化的“自下而上”的哲学，似乎也可以拯救陷入“意大利面条式代码”泥潭的数据分析师和机器学习工程师的。</p>
<p>在软件开发的世界里，最常见的错误就是过早地决定了程序的形状。而在数据科学领域，这个错误被放大了很多倍。</p>
<h2 data-id="heading-0">1. 现状：大多数人是如何做数据分析的？</h2>
<p>如果不加干预，大部分初学者（甚至很多资深从业者）在处理数据时，采取的都是严格的 **“自上而下” **模式。</p>
<p>想象一下，老板交给你一个任务：“分析一下上个季度25岁以下用户的复购率。”</p>
<p>你的大脑立刻开始将其拆解：</p>
<ol>
<li>读取 <code>orders.csv</code>。</li>
<li>过滤出 <code>date</code> 在上个季度的行。</li>
<li>过滤出 <code>age &lt; 25</code> 的用户。</li>
<li>按用户 <code>ID</code> 分组，计算购买次数。</li>
<li>输出结果。</li>
</ol>
<p>于是，你打开了一个 <code>Jupyter Notebook</code>，从第一个 <code>Cell</code> 写到第十个 <code>Cell</code>。</p>
<p>代码像瀑布一样流下来，任务完成了，你很开心。</p>
<p><strong>但这有什么问题？</strong></p>
<p>问题在于，这是一种一次性的编程。如果老板明天说：“再看看30岁以上，最近半年的流失率。”你会怎么做？</p>
<p>你会把昨天的 Notebook 复制一份，然后把里面的数字改一改。</p>
<p>久而久之，我们的电脑里充满了 <code>analysis_v1.ipynb</code>, <code>analysis_final.ipynb</code>, <code>analysis_final_really.ipynb</code>。我们的代码变成了为了解决特定单一问题而存在的“脚本”。</p>
<p>这不是在 <strong>“开发软件”</strong>，只是在 <strong>“操作计算器”</strong>。</p>
<h2 data-id="heading-1">2. 什么是“自下而上”的设计？</h2>
<p>格雷厄姆在《自下而上的编程》中提到过：“<strong>与其为了解决问题而设计程序，不如设计一种语言来描述这个问题。</strong>”</p>
<p>在数据分析和机器学习中， **“自下而上” **意味着你先忽略具体的业务目标（比如计算复购率），转而先构建一套能让你轻松处理数据的 <strong>“基础词汇”</strong>。</p>
<p>当我们采用自上而下的方法时，就像是在用大石头堆砌金字塔，每一块石头的位置都是固定的。</p>
<p>当我们采用自下而上的方法时，则是在通过造积木（或者说创造新的操作符）来提升基础语言的能力。当语言的能力提升到一定程度，解决具体问题就变得像说话一样简单。</p>
<p>在 <code>Python</code> 或 <code>R</code> 中，这通常意味着利用函数式编程的思想，将通用的数据转换逻辑抽象成独立的小工具。</p>
<h2 data-id="heading-2">3. 场景模拟：自上而下 vs 自下而上</h2>
<p>让我们通过一个具体的机器学习预处理场景来看看两者的区别。</p>
<p>假设我们要处理一份电商数据，目的是为模型准备特征。</p>
<p><strong>场景：处理用户行为日志</strong>。我们需要做三件事：</p>
<ol>
<li>去除异常值（比如购买金额为负数）。</li>
<li>填充缺失的年龄数据。</li>
<li>对分类数据（如城市）进行编码。</li>
</ol>
<h3 data-id="heading-3">3.1. 模式 A：传统的自上而下（脚本式）</h3>
<p>这是典型的“面条代码”：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

<span class="hljs-comment"># 读取数据</span>
df = pd.read_csv(<span class="hljs-string">"data.csv"</span>)

<span class="hljs-comment"># 1. 业务逻辑直接写死在流程里</span>
df = df[df[<span class="hljs-string">'amount'</span>] &gt; <span class="hljs-number">0</span>] 

<span class="hljs-comment"># 2. 处理缺失值</span>
mean_age = df[<span class="hljs-string">'age'</span>].mean()
df[<span class="hljs-string">'age'</span>] = df[<span class="hljs-string">'age'</span>].fillna(mean_age)

<span class="hljs-comment"># 3. 独热编码</span>
df = pd.get_dummies(df, columns=[<span class="hljs-string">'city'</span>])

<span class="hljs-comment"># 喂给模型</span>
model.fit(df)
</code></pre>
<p>这段代码完全是为了“这一份数据”服务的。</p>
<p>如果换了一份数据，或者你想尝试“用中位数填充”而不是“均值填充”，你就得侵入这段代码去修改它。</p>
<p>这使得实验变得极其痛苦。</p>
<h3 data-id="heading-4">3.2. 模式 B：自下而上的设计（语言构建式）</h3>
<p>在这种模式下，我们先不看具体的数据，而是问自己：我经常需要做什么？我需要过滤、填充、编码。</p>
<p>于是，我们要为此创造一些“动词”。</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 第一层：构建基础词汇（这些是通用的积木）</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">remove_outliers</span>(<span class="hljs-params">col_name, threshold=<span class="hljs-number">0</span></span>):
    <span class="hljs-string">"""返回一个过滤函数"""</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_filter</span>(<span class="hljs-params">df</span>):
        <span class="hljs-keyword">return</span> df[df[col_name] &gt; threshold]
    <span class="hljs-keyword">return</span> _<span class="hljs-built_in">filter</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">fill_missing</span>(<span class="hljs-params">col_name, strategy=<span class="hljs-string">'mean'</span></span>):
    <span class="hljs-string">"""返回一个填充函数"""</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_filler</span>(<span class="hljs-params">df</span>):
        data = df.copy()
        <span class="hljs-keyword">if</span> strategy == <span class="hljs-string">'mean'</span>:
            val = data[col_name].mean()
        <span class="hljs-keyword">elif</span> strategy == <span class="hljs-string">'median'</span>:
            val = data[col_name].median()
        data[col_name] = data[col_name].fillna(val)
        <span class="hljs-keyword">return</span> data
    <span class="hljs-keyword">return</span> _filler

<span class="hljs-keyword">def</span> <span class="hljs-title function_">encode_categorical</span>(<span class="hljs-params">col_names</span>):
    <span class="hljs-string">"""返回一个编码函数"""</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_encoder</span>(<span class="hljs-params">df</span>):
        <span class="hljs-keyword">return</span> pd.get_dummies(df, columns=col_names)
    <span class="hljs-keyword">return</span> _encoder

<span class="hljs-comment"># 第二层：组合积木（使用管道）</span>
<span class="hljs-comment"># 即使你是初学者，看到这里也能明白，我们创造了一种“新语言”</span>
<span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> reduce

<span class="hljs-keyword">def</span> <span class="hljs-title function_">apply_pipeline</span>(<span class="hljs-params">df, functions</span>):
    <span class="hljs-keyword">return</span> reduce(<span class="hljs-keyword">lambda</span> d, f: f(d), functions, df)

<span class="hljs-comment"># 第三层：解决具体问题</span>
<span class="hljs-comment"># 你看，现在的代码读起来就像是英语句子</span>
pipeline = [
    remove_outliers(<span class="hljs-string">'amount'</span>, <span class="hljs-number">0</span>),
    fill_missing(<span class="hljs-string">'age'</span>, strategy=<span class="hljs-string">'mean'</span>),
    encode_categorical([<span class="hljs-string">'city'</span>])
]

clean_df = apply_pipeline(raw_data, pipeline)
</code></pre>
<p>哪怕你没学过高深的编程，也能看出模式 B 的美妙之处。</p>
<p>如果不想要均值填充了？只需要把 <code>strategy='mean'</code> 改成<code> 'median'</code>。</p>
<p>如果想给另一个数据集做同样的预处理？直接复用 <code>pipeline</code> 列表。</p>
<p>最重要的是，底层的函数（积木）一旦写好并测试通过，你就再也不用去动它们了。</p>
<p>你的思考层级从 **“如何写 Pandas 代码” **上升到了 <strong>“如何组合数据处理逻辑”</strong>。</p>
<h2 data-id="heading-5">4. 自下而上模式的优缺点</h2>
<p>当然，<strong>自下而上</strong>的模式也不是万能的。</p>
<p>它的<strong>优点</strong>是：</p>
<ol>
<li><strong>代码会越来越短</strong>： 随着你积累的基础函数（积木）越来越多，解决新问题所需的代码行数会越来越少。就像 Lisp 程序员常说的，你在让语言向问题靠拢。</li>
<li><strong>极强的复用性</strong>： 你的 <code>fill_missing</code> 函数可以在一百个不同的项目中使用，而不需要重写一行代码。</li>
<li><strong>易于测试</strong>： 测试一个小的、独立的工具函数，比测试一个几百行的脚本要容易得多。</li>
<li><strong>表达力</strong>： 顶层的代码读起来就是业务逻辑本身，而不是复杂的语法细节。</li>
</ol>
<p>为此，它的的<strong>缺点</strong>是：</p>
<ol>
<li><strong>初期成本高</strong>： 当你只想画一条线时，自下而上的方法要求你先造一支笔。对于非常简单、一次性的任务，这可能显得 <strong>“过度设计”</strong>。</li>
<li><strong>思维门槛</strong>： 初学者往往习惯于线性思维（第一步做啥，第二步做啥）。要学会抽象出通用的操作符，需要一定的训练和对函数式编程的理解。</li>
</ol>
<h2 data-id="heading-6">5. 总结</h2>
<p><strong>自下而上</strong>的设计模式，核心在于<strong>抽象</strong>。</p>
<p>在数据分析和机器学习中，这意味着不要总是盯着眼前的这一行数据，而是去思考：“我该如何构建一套工具，让这类型的问题以后都不再是问题？”</p>
<p>当你开始这样思考时，就不仅是在做分析，而是在像黑客一样创造。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[告别“玄学”UI：从“删代码碰运气”到“控制 BFC 结界”]]></title>    <link>https://juejin.cn/post/7604037348607459366</link>    <guid>https://juejin.cn/post/7604037348607459366</guid>    <pubDate>2026-02-08T12:56:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7604037348607459366" data-draft-id="7604012106153558062" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="告别“玄学”UI：从“删代码碰运气”到“控制 BFC 结界”"/> <meta itemprop="keywords" content="前端,CSS"/> <meta itemprop="datePublished" content="2026-02-08T12:56:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="im_AMBER"/> <meta itemprop="url" content="https://juejin.cn/user/370979729333004"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            告别“玄学”UI：从“删代码碰运气”到“控制 BFC 结界”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/370979729333004/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    im_AMBER
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T12:56:05.000Z" title="Sun Feb 08 2026 12:56:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读7分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"> 序：告别“玄学”UI </h2>
<p>之前我认为UI是不需要费心写的，因此也忽略了许多有关CSS等样式的细节，现在看来实在是基础不牢地动山摇，这是错误的——只会将 UI 需求直接丢给 AI，像开盲盒一样等待结果，全都交给了AI“外包”。</p>
<p>当布局错位时，我往往通过视觉描述增加提示词来“碰运气”，把AI写的代码又丢给AI改，结果却常导致 AI 为了调整一个局部参数而重写整个文件，逻辑越改越乱，自相矛盾，到处都是冲突的补丁......</p>
<p><strong>CSS 布局不是样式的堆砌，而是物理逻辑的构建。</strong></p>
<p>今天，我通过对已有的博客、网页等页面的“破坏性实验”和 F12 深度调试，意识到 <strong>UI 开发的核心不在于具体的样式代码，而在于对容器约束与布局环境的掌控。</strong></p>
<hr/>
<h2 data-id="heading-1">一、 溢出与约束：滚动的物理本质</h2>
<h3 data-id="heading-2">1. BUG ： 预览组件不能滚动查看全部内容</h3>
<p>在开发文档预览组件时，我遇到了一个典型问题：</p>
<p><strong>文本内容被截断，只能显示一半，且没有滚动条。不是理想的可以滚动的预览查看的状态。</strong> 中间的内容区域溢出（Overflow）但没有触发滚动机制。</p>
<h3 data-id="heading-3">2. 从“无限增长”到“边界意识”</h3>
<p><strong>在默认状态下，块级容器遵循内容流向。</strong></p>
<p>如果父容器没有设定明确的高度（Height），它会随着内容无限延伸。</p>
<p><strong>浏览器认为容器高度等于内容高度，因此不存在“溢出”，自然不会触发滚动条。</strong></p>
<p><strong>我的修复路径</strong>：为父容器显式声明高度边界（如 <code>max-h-[90vh]</code> 或 <code>h-[500px]</code>）。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FCSS%2FReference%2FProperties%2Foverflow" title="https://developer.mozilla.org/zh-CN/docs/Web/CSS/Reference/Properties/overflow" target="_blank" ref="nofollow noopener noreferrer">overflow - CSS：层叠样式表 | MDN</a></p>
<blockquote>
<h4 data-id="heading-4">溢出处理 (Overflow)</h4>
<p><strong>官方定义</strong>：<code>overflow</code> 属性指定如果内容溢出一个元素的框（其内容区、内边距区或边框区）时，会发生什么。</p>
<p><strong>深度理解</strong>：滚动不是内容的属性，而是内容与容器边界的<strong>冲突</strong>。必须先有“墙”（约束），溢出才有意义。</p>
</blockquote>
<hr/>
<h2 data-id="heading-5">二、 Flex 布局：环境决定属性</h2>
<h3 data-id="heading-6">1. 权力等级：为什么 <code>flex: 1</code> 会失效？</h3>
<p>在博客页面实战中，我曾尝试强行在子元素写入 <code>flex: 1</code> 以期望它填满剩余空间，但在浏览器 F12 中，该属性显示为灰色。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83e14f7d1dd3421d8be17ac9c01684d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaW1fQU1CRVI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771160168&amp;x-signature=cZf8y9xXhRqmR%2Fvv8PuPBCgG898%3D" alt="" loading="lazy"/>​</p>
<p><img src="" alt="" title="点击并拖拽以移动" loading="lazy"/></p>
<ul>
<li><strong>发现</strong>：子元素对空间的分配权（Flex item properties）必须建立在父级开启了 <strong>FFC（Flex Formatting Context）</strong> 的前提下。</li>
<li><strong>CSS 页面是由一个个“上下文（Context）”组成的。</strong> <code>display: flex</code> <strong>开启了 FFC，<code>overflow: auto</code> 开启了 BFC。</strong> 之所以在 F12 里 <code>flex: 1</code> 是灰色的，就是因为我试图在“普通文档流”里运行“弹性分配协议”，这属于<strong>协议不匹配</strong>。</li>
<li><strong>如果父级不是 <code>display: flex</code>，子元素的弹性属性将由于缺乏上下文环境而无法被引擎解析。</strong></li>
</ul>
<h3 data-id="heading-7">2. 动态分配：对话区的“铺满”逻辑</h3>
<p>在设计 Sidebar + 对话区的布局( 例如这种左右分栏的页面 )中，AI 写 UI 常给出固定高度，导致右侧对话区无法随窗口自适应。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f3ffa67f80d44bea8ae84e1de49e18a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaW1fQU1CRVI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771160168&amp;x-signature=Occq3rnPQjZGGt%2FAKHL8SbAjKqY%3D" alt="" loading="lazy"/><img src="" alt="" title="点击并拖拽以移动" loading="lazy"/>​</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/522c82098ff84778951332cbde553e8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaW1fQU1CRVI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771160168&amp;x-signature=idd%2Fdap2YiRpEow5eECrRmtwOmM%3D" alt="" loading="lazy"/><img src="" alt="" title="点击并拖拽以移动" loading="lazy"/>​</p>
<ul>
<li><strong>逻辑重构</strong>：删掉死高度，将对话区设为 <code>flex-1</code>。</li>
<li>在 Flex 纵向布局中，这意味着它会“吸收”掉父容器中除去 Header 和 Footer 之外的所有剩余空间。</li>
</ul>
<h3 data-id="heading-8">3.守地盘： <code>min-h-0</code></h3>
<p>在 Flex 容器中，子元素的 <code>min-height</code> 默认值是 <code>auto</code>。</p>
<p>这意味着内容会倾向于撑开容器。</p>
<p>如果不手动设置 <code>min-h-0</code>，当内容非常多时，即使你设置了 <code>flex-1</code>，容器也可能被内容“撑爆”而不会出现内部滚动。</p>
<hr/>
<h2 data-id="heading-9">三、 空间隔离：BFC 结界与绝对定位</h2>
<h3 data-id="heading-10">1. BFC：独立的渲染自治区</h3>
<p>通过 F12 观察网页，我深刻理解了 BFC 的重要性。</p>
<blockquote>
<h4 data-id="heading-11">BFC (Block Formatting Context)</h4>
<p><strong>官方定义</strong>：块级格式化上下文。它是 Web 页面的可视化 CSS 渲染的一部分，是布局过程中生成块级盒子的区域。</p>
<p><strong>工程含义</strong>：</p>
<ul>
<li><strong>内部自治</strong>：BFC 内部的元素布局不会影响到外部，反之亦然。</li>
<li><strong>包含浮动</strong>：BFC 容器可以自动计算内部浮动元素的高度（解决高度塌陷）。</li>
<li><strong>消除重叠</strong>：BFC 区域不会与浮动（float）盒子重叠。</li>
</ul>
</blockquote>
<p>在工程实践中，我们最常用的触发 BFC 的方式是设置 <code>overflow: hidden</code>、<code>display: flex</code> 或 <code>display: grid</code>。</p>
<p>这也解释了为什么当我为了解决溢出（Overflow）而给父容器加了高度限制和滚动属性时，<strong>其实也顺便开启了 BFC，从而解决了内部布局的一些奇怪偏移。</strong></p>
<h3 data-id="heading-12">2. Position Absolute：脱离文档流的参照系</h3>
<p><code>absolute</code> 的定位并不是绝对的坐标，它是一种 <strong>“寻找祖先”</strong> 的行为。</p>
<ul>
<li><strong>它脱离了常规文档流（不占位），像幽灵般漂浮。</strong> <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85abec2294a34a1c94109d9358556be9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaW1fQU1CRVI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771160168&amp;x-signature=V2aDQVz9ZGdRaddE%2BOE85w35Blw%3D" alt="" loading="lazy"/><img src="" alt="" title="点击并拖拽以移动" loading="lazy"/>​编辑</li>
<li>它的坐标参照系是最近的一个 <code>position</code> 非 <code>static</code> 的祖先元素。如果找不到，它会一直回溯到根节点。<strong>通常我们把父级设为 <code>relative</code>，就是为了给 <code>absolute</code> 的子元素立一个“参照桩”，防止它一路回溯到 <code>body</code> 导致“幽灵”乱飘。</strong></li>
</ul>
<hr/>
<h2 data-id="heading-13">四、 小结</h2>
<p>会用AI开发的前提是能看懂AI的代码，而不是把所有都只是交给AI代劳。</p>
<p><strong>用AI代替思考的开发者只会被AI取代，这是我对自己的警醒。</strong></p>
<p><strong>AI 只能提供样式的结果，但无法感知容器间的压力。</strong></p>
<ul>
<li><strong>当内容溢出时</strong>，AI 会盲目增加 <code>h-full</code>，但它不知道这会导致容器突破父级的物理边界。</li>
<li><strong>当布局错位时</strong>，AI 会堆砌 <code>!important</code>，但它不知道这破坏了 CSS 的权重优先级。</li>
</ul>
<p>只有理解了 <strong>“封闭性原理”</strong> 和 <strong>“环境决定属性”</strong> ，你才能在 AI 给出错误补丁时，一眼看出那个导致崩盘的“虚假约束”。</p>
<p>我想作为一个开发者，开发的思考是最珍贵的，写代码只是把思考落地的方式。AI其实也许只是一个把脑子里的想法帮忙写出来，或者帮忙提供思路，而不是代替开发者的脑子。</p>
<h3 data-id="heading-14">这次解决滚动问题的核心逻辑：</h3>
<ul>
<li><strong>封闭性原理</strong>：一个容器如果不“封顶”（没写 <code>h-full</code> 或 <code>max-h</code>），它就是无限高的。<strong>无限高的东西永远不会滚动。</strong></li>
<li><strong>分配法则（Flexbox）</strong> ：<code>flex-1</code> 是“抢地盘”，而 <code>min-h-0</code> 是“守地盘”。如果没有 <code>min-h-0</code>，内容会撑爆布局。</li>
<li><strong>BFC（块级格式化上下文）</strong> ：本质上就是给容器划了一块“自治区”，里面的东西怎么排，不影响外面。</li>
</ul>
<h3 data-id="heading-15">实战排查流，学会用浏览器调试：</h3>
<ul>
<li><strong>F12 调试</strong>：手动设置背景色等，在dev tools里面大胆调试，追溯父子元素。</li>
<li><strong>Computed 计算值</strong>：不要只看写的 CSS，要看浏览器最终“算出来”的高宽。</li>
</ul>
<p><strong>限于个人经验，文中若有疏漏，还请不吝赐教。</strong></p>
<h2 data-id="heading-16">参考文献</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FCSS%2FGuides%2FDisplay%2FBlock_formatting_context" title="https://developer.mozilla.org/zh-CN/docs/Web/CSS/Guides/Display/Block_formatting_context" target="_blank" ref="nofollow noopener noreferrer">区块格式化上下文 - CSS：层叠样式表 | MDN</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FLearn_web_development%2FCore%2FStyling_basics%2FBox_model" title="https://developer.mozilla.org/zh-CN/docs/Learn_web_development/Core/Styling_basics/Box_model" target="_blank" ref="nofollow noopener noreferrer">盒模型 - 学习 Web 开发 | MDN</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.radix-ui.com%2Fprimitives%2Fdocs%2Fcomponents%2Fscroll-area" title="https://www.radix-ui.com/primitives/docs/components/scroll-area" target="_blank" ref="nofollow noopener noreferrer">Scroll Area – Radix Primitives</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fdevtools%2Fcss%3Fhl%3Dzh-cn" title="https://developer.chrome.com/docs/devtools/css?hl=zh-cn" target="_blank" ref="nofollow noopener noreferrer">查看和更改 CSS  |  Chrome DevTools  |  Chrome for Developers</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ftailwindcss.com%2Fdocs%2Fheight" title="https://tailwindcss.com/docs/height" target="_blank" ref="nofollow noopener noreferrer">height - Sizing - Tailwind CSS</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ftailwindcss.com%2Fdocs%2Fadding-custom-styles" title="https://tailwindcss.com/docs/adding-custom-styles" target="_blank" ref="nofollow noopener noreferrer">Adding custom styles - Core concepts - Tailwind CSS</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FLearn_web_development%2FCore%2FCSS_layout%2FFlexbox" title="https://developer.mozilla.org/zh-CN/docs/Learn_web_development/Core/CSS_layout/Flexbox" target="_blank" ref="nofollow noopener noreferrer">弹性盒子 - 学习 Web 开发 | MDN</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ftailwindcss.com%2Fdocs%2Fflex-grow" title="https://tailwindcss.com/docs/flex-grow" target="_blank" ref="nofollow noopener noreferrer">flex-grow - Flexbox &amp; Grid - Tailwind CSS</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzh-hans.react.dev%2Flearn%2Fpassing-props-to-a-component" title="https://zh-hans.react.dev/learn/passing-props-to-a-component" target="_blank" ref="nofollow noopener noreferrer">将 Props 传递给组件 – React 中文文档</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FJavaScript%2FReference%2FOperators%2FDestructuring" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Destructuring" target="_blank" ref="nofollow noopener noreferrer">解构 - JavaScript | MDN</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FJavaScript%2FReference%2FFunctions%2FArrow_functions" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions" target="_blank" ref="nofollow noopener noreferrer">箭头函数表达式 - JavaScript | MDN</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FJavaScript%2FGuide%2FClosures" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Closures" target="_blank" ref="nofollow noopener noreferrer">闭包 - JavaScript | MDN</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FCSS%2FReference%2FProperties%2Fdisplay" title="https://developer.mozilla.org/zh-CN/docs/Web/CSS/Reference/Properties/display" target="_blank" ref="nofollow noopener noreferrer">display - CSS：层叠样式表 | MDN</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FCSS%2FGuides%2FDisplay%2FFormatting_contexts" title="https://developer.mozilla.org/zh-CN/docs/Web/CSS/Guides/Display/Formatting_contexts" target="_blank" ref="nofollow noopener noreferrer">格式化上下文简介 - CSS：层叠样式表 | MDN</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ftailwindcss.com%2Fdocs%2Fflex-basis" title="https://tailwindcss.com/docs/flex-basis" target="_blank" ref="nofollow noopener noreferrer">flex-basis - Flexbox &amp; Grid - Tailwind CSS</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FCSS%2FGuides%2FDisplay%2FIn_flow_and_out_of_flow" title="https://developer.mozilla.org/zh-CN/docs/Web/CSS/Guides/Display/In_flow_and_out_of_flow" target="_blank" ref="nofollow noopener noreferrer">应用或脱离流式布局 - CSS：层叠样式表 | MDN</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.w3.org%2FTR%2FCSS2%2Fvisuren.html%23normal-flow" title="https://www.w3.org/TR/CSS2/visuren.html#normal-flow" target="_blank" ref="nofollow noopener noreferrer">Visual formatting model</a></p>
<p>​</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[构建全栈AI应用：集成Ollama开源大模型]]></title>    <link>https://juejin.cn/post/7603699739223883791</link>    <guid>https://juejin.cn/post/7603699739223883791</guid>    <pubDate>2026-02-08T12:59:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603699739223883791" data-draft-id="7603677143215013903" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="构建全栈AI应用：集成Ollama开源大模型"/> <meta itemprop="keywords" content="前端,后端,Ollama"/> <meta itemprop="datePublished" content="2026-02-08T12:59:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="lIIIllIlIllIIl"/> <meta itemprop="url" content="https://juejin.cn/user/793196846923641"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            构建全栈AI应用：集成Ollama开源大模型
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/793196846923641/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    lIIIllIlIllIIl
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T12:59:43.000Z" title="Sun Feb 08 2026 12:59:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在AI技术迅猛发展的今天，开源大模型如 DeepSeek 系列为开发者提供了强大工具，而无需依赖云服务。构建一个全栈AI应用，不仅能深化对前后端分离架构的理解，还能探索AI集成的最佳实践。本文将基于一个实际项目，分享如何使用<code>React</code>前端、Node.js后端，并通过 <code>LangChain</code> 库调用 <code>Ollama</code> 部署的 <strong>DeepSeek-R1:8b</strong> 模型，实现一个简单的聊天功能。这个项目适用于初学者上手全栈开发，或资深开发者扩展AI能力。</p>
<p>项目需求源于日常场景：开发者常常需要快速测试AI响应，或构建原型应用来验证想法。传统方式可能涉及复杂API调用，而开源Ollama简化了本地部署。技术栈选择上，前端采用React结合Tailwind CSS和Axios，实现响应式UI和网络交互；后端使用Express框架提供API服务；AI部分则集成Ollama，确保模型运行高效且本地化。这不仅仅是代码堆砌，更是关于模块化、容错和跨域处理的综合实践。</p>
<p>接下来，我们将剖析项目架构、代码实现和关键知识点，包括自定义Hook、API管理、提示工程等。通过提供的代码示例，读者可以轻松复现，并根据需要扩展为更复杂的应用，如代码审查或内容生成工具。</p>
<h2 data-id="heading-0">项目架构概述</h2>
<p>项目采用前后端分离设计，确保各部分独立开发和部署。</p>
<ul>
<li><strong>前端</strong>：浏览器端运行（默认端口5173），处理用户输入和显示AI响应。使用React构建，借助自定义Hook封装逻辑，避免组件复杂化。Axios用于发送请求到后端。</li>
<li><strong>后端</strong>：Node.js与Express框架，监听3000端口，提供RESTful API。核心接口/chat接收消息，调用AI模型后返回结果。集成CORS中间件支持跨域。</li>
<li><strong>AI集成</strong>：Ollama部署DeepSeek-R1:8b模型（端口11434），通过LangChain构建提示链。模型温度设为0.1，确保输出稳定。</li>
</ul>
<p>这种架构优势在于可扩展性：前端专注交互，后端管理业务，AI作为服务可独立优化。启动时，前端用Vite工具，后端Node运行，Ollama后台启动模型。</p>
<h2 data-id="heading-1">前端实现详解</h2>
<p>前端核心是创建一个简洁界面，发送消息并展示AI回复。假设初始消息为模拟输入，实际可扩展为用户表单。</p>
<h3 data-id="heading-2">App.jsx：主组件</h3>
<p>主组件使用Hook获取数据，渲染加载状态或内容：</p>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { useGitDiff } <span class="hljs-keyword">from</span> <span class="hljs-string">'./hooks/useGitDiff.js'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { loading, content } = <span class="hljs-title function_">useGitDiff</span>(<span class="hljs-string">'hello'</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"flex"</span>&gt;</span>
      {loading ? 'loading...' : content}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<p>这里，Hook接收参数（模拟消息），返回loading和content。组件逻辑简单：加载中显示提示，否则渲染回复。结合Tailwind CSS的flex类，实现响应式布局。</p>
<h3 data-id="heading-3">useGitDiff.js：自定义Hook</h3>
<p>Hook封装状态和副作用：</p>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { chat } <span class="hljs-keyword">from</span> <span class="hljs-string">'../api/index.js'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useGitDiff</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> [content, setContent] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    (<span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">true</span>);
      <span class="hljs-keyword">const</span> { data } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">chat</span>(<span class="hljs-string">'你好'</span>);
      <span class="hljs-title function_">setContent</span>(data.<span class="hljs-property">reply</span>);
      <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">false</span>);
    })()
  }, [])
  <span class="hljs-keyword">return</span> {
    loading,
    content,
  }
}
</code></pre>
<p>使用useState管理状态，useEffect异步调用API。模拟消息“你好”，实际可动态传入。返回对象供组件使用，实现数据驱动渲染。</p>
<h3 data-id="heading-4">api/index.js：API管理</h3>
<p>统一管理请求：</p>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;

<span class="hljs-keyword">const</span> service = axios.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">baseURL</span>: <span class="hljs-string">'http://localhost:3000'</span>,
  <span class="hljs-attr">headers</span>: {
    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
  },
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">120000</span>,
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">chat</span> = (<span class="hljs-params">message</span>) =&gt; service.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/chat'</span>, {message})
</code></pre>
<p>Axios实例设置baseURL、headers和timeout。chat函数封装POST请求，便于复用。</p>
<p>前端设计强调简洁，易于添加输入框扩展为完整聊天UI。</p>
<h2 data-id="heading-5">后端实现详解</h2>
<p>后端使用Express搭建服务器，支持AI调用。</p>
<h3 data-id="heading-6">index.js：服务器文件</h3>
<p>代码如下：</p>
<p>JavaScript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">'express'</span>;
<span class="hljs-keyword">import</span> cors <span class="hljs-keyword">from</span> <span class="hljs-string">'cors'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatOllama</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/ollama'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatPromptTemplate</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/core/prompts'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">StringOutputParser</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/core/output_parsers'</span>

<span class="hljs-keyword">const</span> model = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatOllama</span>({
  <span class="hljs-attr">baseURL</span>: <span class="hljs-string">"http://localhost:11434"</span>,
  <span class="hljs-attr">model</span>: <span class="hljs-string">"deepseek-r1:8b"</span>,
  <span class="hljs-attr">temperature</span>: <span class="hljs-number">0.1</span>
})

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();
app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">cors</span>());
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>());

app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/hello'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">'hello world'</span>);
})

app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/chat'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(req.<span class="hljs-property">body</span>, <span class="hljs-string">"//////"</span>);
  <span class="hljs-keyword">const</span> { message } = req.<span class="hljs-property">body</span>;
  <span class="hljs-keyword">if</span> (!message || <span class="hljs-keyword">typeof</span> message !== <span class="hljs-string">'string'</span>) {
    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">json</span>({
      <span class="hljs-attr">error</span>: <span class="hljs-string">"message 必填，必须是字符串"</span>
    })
  }
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> prompt = <span class="hljs-title class_">ChatPromptTemplate</span>.<span class="hljs-title function_">fromMessages</span>([
      [<span class="hljs-string">"system"</span>, <span class="hljs-string">"You are a helpful assistent."</span>],
      [<span class="hljs-string">"human"</span>, <span class="hljs-string">'{input}'</span>]
    ])
    <span class="hljs-keyword">const</span> chain = prompt.<span class="hljs-title function_">pipe</span>(model).<span class="hljs-title function_">pipe</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringOutputParser</span>());
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"正在调用大模型"</span>);
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> chain.<span class="hljs-title function_">invoke</span>({
      <span class="hljs-attr">input</span>: message,
    })
    res.<span class="hljs-title function_">json</span>({
      <span class="hljs-attr">reply</span>: result
    })
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err);
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">json</span>({
      <span class="hljs-attr">err</span>: <span class="hljs-string">"调用大模型失败"</span>
    })
  }
})

app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'server is running on port 3000'</span>);
})
</code></pre>
<p>初始化Ollama模型。app实例使用CORS和JSON中间件。GET /hello测试路由。POST /chat校验message，构建提示链调用模型，返回reply。容错处理确保稳定性。</p>
<h2 data-id="heading-7">关键知识点：跨域与中间件</h2>
<p>跨域问题是前后端分离的痛点。浏览器同源策略阻塞不同端口请求。使用cors中间件解决，后端允许前端访问。</p>
<p>中间件链：请求经CORS、JSON解析后到达路由。Express的灵活性便于添加日志或认证。</p>
<h2 data-id="heading-8">关键知识点：HTTP与路由</h2>
<p>HTTP基于请求响应。GET无body，POST适合传输消息。响应码如400、500指示状态。</p>
<p>路由定义资源访问：app.post处理异步AI调用。</p>
<h2 data-id="heading-9">AI集成详解</h2>
<p>Ollama提供本地API，LangChain简化提示：系统角色定义，用户输入占位。链式pipe确保输出解析。</p>
<p>温度0.1减少随机性。扩展可自定义提示，如添加上下文。</p>
<h2 data-id="heading-10">项目优化</h2>
<ul>
<li><strong>用户输入</strong>：前端添加表单动态消息。</li>
<li><strong>安全</strong>：添加校验或限流。</li>
<li><strong>部署</strong>：容器化Ollama，后端云托管。</li>
<li><strong>扩展</strong>：多轮对话或工具调用。</li>
</ul>
<h2 data-id="heading-11">结语</h2>
<p>通过集成 Ollama 的全栈应用，我们看到AI如何赋能开发。欢迎讨论优化思路，一起推动开源生态。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[🚀 从DOM操作到Vue3：一个Todo应用的思维革命]]></title>    <link>https://juejin.cn/post/7603994823326089226</link>    <guid>https://juejin.cn/post/7603994823326089226</guid>    <pubDate>2026-02-08T13:18:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603994823326089226" data-draft-id="7603994823326072842" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="🚀 从DOM操作到Vue3：一个Todo应用的思维革命"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2026-02-08T13:18:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="不会敲代码1"/> <meta itemprop="url" content="https://juejin.cn/user/1927884034804425"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            🚀 从DOM操作到Vue3：一个Todo应用的思维革命
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1927884034804425/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    不会敲代码1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T13:18:49.000Z" title="Sun Feb 08 2026 13:18:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">🚀 从DOM操作到Vue3：一个Todo应用的思维革命</h2>
<blockquote>
<p><strong>前言</strong>：当我第一次学习前端时，导师让我实现一个Todo应用。我花了2小时写了50行代码，导师看了一眼说：“试试Vue3吧。” 我用30分钟重写了同样的功能，代码减少到20行。那一刻，我明白了什么是真正的<strong>数据驱动开发</strong>。今天，我想通过这个Todo应用，带你体验这场思维革命。</p>
</blockquote>
<h3 data-id="heading-1">第一章：传统开发方式的困境</h3>
<p>让我们先回顾一下用原生JavaScript实现的Todo应用：</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- demo.html --&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>传统Todo应用<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"todo-input"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-comment">// 传统做法：命令式编程</span>
        <span class="hljs-keyword">const</span> app = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'app'</span>)
        <span class="hljs-keyword">const</span> todoInput = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'todo-input'</span>)
        
        <span class="hljs-comment">// 手动监听事件</span>
        todoInput.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'change'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>){
            <span class="hljs-keyword">const</span> todo = event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>()
            <span class="hljs-keyword">if</span>(!todo){
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'请输入任务'</span>)
                <span class="hljs-keyword">return</span>
            }
            <span class="hljs-comment">// 手动更新DOM</span>
            app.<span class="hljs-property">innerHTML</span> = todo
        })
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h4 data-id="heading-2">🔍 传统方式的三大痛点：</h4>
<ol>
<li><strong>命令式编程</strong>：你需要像指挥官一样告诉浏览器每一步该做什么</li>
<li><strong>DOM操作繁琐</strong>：每次数据变化都要手动查找和更新DOM</li>
<li><strong>关注点错位</strong>：80%的代码在处理界面操作，只有20%在处理业务逻辑</li>
</ol>
<p>这就像<strong>每次想改变房间布局，都要亲自搬砖砌墙</strong>。</p>
<h3 data-id="heading-3">第二章：Vue3的数据驱动革命</h3>
<p>现在，让我们看看用Vue3实现的完整Todo应用：</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- App.vue --&gt;
&lt;template&gt;
  &lt;div&gt;
    &lt;!-- 1. 数据绑定 --&gt;
    &lt;h2&gt;{{title}}&lt;/h2&gt;
    
    &lt;!-- 2. 双向数据绑定 --&gt;
    &lt;input 
      type="text" 
      v-model="title" 
      @keydown.enter="addTodo"
      placeholder="输入任务后按回车"
    &gt;
    
    &lt;!-- 3. 条件渲染 --&gt;
    &lt;ul v-if="todos.length"&gt;
      &lt;!-- 4. 列表渲染 --&gt;
      &lt;li v-for="todo in todos" :key="todo.id"&gt;
        &lt;!-- 5. 双向绑定到对象属性 --&gt;
        &lt;input type="checkbox" v-model="todo.done"&gt;
        
        &lt;!-- 6. 动态class绑定 --&gt;
        &lt;span :class="{done: todo.done}"&gt;{{todo.title}}&lt;/span&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
    
    &lt;!-- 7. v-else指令 --&gt;
    &lt;div v-else&gt;
      暂无任务
    &lt;/div&gt;
    
    &lt;!-- 8. 计算属性使用 --&gt;
    &lt;div&gt;
      进度：{{activeTodos}} / {{todos.length}}
    &lt;/div&gt;
    
    &lt;!-- 9. 计算属性的getter/setter --&gt;
    全选&lt;input type="checkbox" v-model="allDone"&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
// 10. Composition API导入
import { ref, computed, watch } from 'vue'

// 11. 响应式数据
const title = ref("Todos任务清单")
const todos = ref([
  {
    id: 1,
    title: '学习vue',
    done: false
  },
  {
    id: 2,
    title: '打王者',
    done: false
  },
    {
    id: 3,
    title: '吃饭',
    done: true
  }
])

// 12. 计算属性
const activeTodos = computed(() =&gt; {
  return todos.value.filter(todo =&gt; !todo.done).length
})

// 13. 方法定义
const addTodo = () =&gt; {
  if(!title.value) return
  
  todos.value.push({
    id: Date.now(),  // 更好的ID生成方式
    title: title.value,
    done: false
  })
  
  title.value = ""
}

// 14. 计算属性的getter/setter
const allDone = computed({
  get() {
    return todos.value.length &gt; 0 &amp;&amp; 
           todos.value.every(todo =&gt; todo.done)
  },
  set(val) {
    todos.value.forEach(todo =&gt; todo.done = val)
  }
})

// 15. 监听器 - 补充知识点
watch(todos, (newTodos) =&gt; {
  console.log('任务列表发生变化:', newTodos)
  // 可以在这里实现本地存储
}, { deep: true })

// 16. 生命周期钩子 - 补充知识点
import { onMounted } from 'vue'
onMounted(() =&gt; {
  console.log('组件挂载完成')
  // 可以在这里从本地存储读取数据
})
&lt;/script&gt;

&lt;style&gt;
.done {
  color: gray;
  text-decoration: line-through;
}

/* 17. 组件样式作用域 - 补充知识点 */
/* 这里的样式只作用于当前组件 */
&lt;/style&gt;
</code></pre>
<h3 data-id="heading-4">第三章：Vue3核心API深度解析</h3>
<h4 data-id="heading-5">🎯 1. <code>ref</code> - 响应式数据的基石</h4>
<p><strong>代码：</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> title = <span class="hljs-title function_">ref</span>(<span class="hljs-string">"Todos任务清单"</span>)
</code></pre>
<p><strong>补充：</strong></p>
<ul>
<li><code>ref</code>用于创建<strong>响应式引用</strong></li>
<li>访问值需要使用<code>.value</code></li>
<li>为什么需要<code>.value</code>？因为Vue需要知道哪些数据需要被追踪变化</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ref的内部原理简化版</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">ref</span>(<span class="hljs-params">initialValue</span>) {
  <span class="hljs-keyword">let</span> value = initialValue
  <span class="hljs-keyword">return</span> {
    <span class="hljs-keyword">get</span> <span class="hljs-title function_">value</span>() {
      <span class="hljs-comment">// 这里可以收集依赖</span>
      <span class="hljs-keyword">return</span> value
    },
    <span class="hljs-keyword">set</span> <span class="hljs-title function_">value</span>(<span class="hljs-params">newValue</span>) {
      value = newValue
      <span class="hljs-comment">// 这里可以通知更新</span>
    }
  }
}
</code></pre>
<h4 data-id="heading-6">🎯 2. <code>v-model</code> - 双向绑定的魔法</h4>
<p><strong>代码：</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"title"</span>&gt;</span>
</code></pre>
<p><strong>补充：</strong>
<code>v-model</code>实际上是语法糖，它等于：</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
  <span class="hljs-attr">:value</span>=<span class="hljs-string">"title"</span>
  @<span class="hljs-attr">input</span>=<span class="hljs-string">"title = $event.target.value"</span>
&gt;</span>
</code></pre>
<p>对于复选框，<code>v-model</code>的处理有所不同：</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"todo.done"</span>&gt;</span>
<span class="hljs-comment">&lt;!-- 等价于 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
  <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> 
  <span class="hljs-attr">:checked</span>=<span class="hljs-string">"todo.done"</span>
  @<span class="hljs-attr">change</span>=<span class="hljs-string">"todo.done = $event.target.checked"</span>
&gt;</span>
</code></pre>
<h4 data-id="heading-7">🎯 3. 指令系统详解</h4>
<p><strong><code>v-show</code> vs <code>v-if</code></strong>：</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- v-if是真正的条件渲染 --&gt;
&lt;div v-if="show"&gt;条件渲染&lt;/div&gt; &lt;!-- 会从DOM中移除/添加 --&gt;

&lt;!-- v-show只是控制display --&gt;
&lt;div v-show="show"&gt;显示控制&lt;/div&gt; &lt;!-- 始终在DOM中，只是display切换 --&gt;
</code></pre>
<p><strong>动态参数</strong>：</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- 动态指令参数 --&gt;
&lt;a :[attributeName]="url"&gt;链接&lt;/a&gt;
&lt;button @[eventName]="doSomething"&gt;按钮&lt;/button&gt;
</code></pre>
<h4 data-id="heading-8">🎯 4. <code>computed</code> - 智能计算属性</h4>
<p><strong>细节</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 计算属性的缓存特性</span>
<span class="hljs-keyword">const</span> expensiveCalculation = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'重新计算'</span>) <span class="hljs-comment">// 只有依赖变化时才会执行</span>
  <span class="hljs-keyword">return</span> todos.<span class="hljs-property">value</span>
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> !todo.<span class="hljs-property">done</span>)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> todo.<span class="hljs-property">title</span>.<span class="hljs-title function_">toUpperCase</span>())
    .<span class="hljs-title function_">join</span>(<span class="hljs-string">', '</span>)
})

<span class="hljs-comment">// 依赖没有变化时，直接返回缓存值</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(expensiveCalculation.<span class="hljs-property">value</span>) <span class="hljs-comment">// 输出并打印"重新计算"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(expensiveCalculation.<span class="hljs-property">value</span>) <span class="hljs-comment">// 直接返回缓存值，不打印</span>
</code></pre>
<h4 data-id="heading-9">🎯 5. <code>watch</code> - 数据监听器</h4>
<p><strong>重要知识点：</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. 监听单个ref</span>
<span class="hljs-title function_">watch</span>(title, <span class="hljs-function">(<span class="hljs-params">newTitle, oldTitle</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`标题从"<span class="hljs-subst">${oldTitle}</span>"变为"<span class="hljs-subst">${newTitle}</span>"`</span>)
})

<span class="hljs-comment">// 2. 监听多个数据源</span>
<span class="hljs-title function_">watch</span>([title, todos], <span class="hljs-function">(<span class="hljs-params">[newTitle, newTodos], [oldTitle, oldTodos]</span>) =&gt;</span> {
  <span class="hljs-comment">// 处理变化</span>
})

<span class="hljs-comment">// 3. 立即执行的watch</span>
<span class="hljs-title function_">watch</span>(todos, <span class="hljs-function">(<span class="hljs-params">newTodos</span>) =&gt;</span> {
  <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'todos'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(newTodos))
}, { <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span> }) <span class="hljs-comment">// 组件创建时立即执行一次</span>

<span class="hljs-comment">// 4. 深度监听</span>
<span class="hljs-title function_">watch</span>(todos, <span class="hljs-function">(<span class="hljs-params">newTodos</span>) =&gt;</span> {
  <span class="hljs-comment">// 可以检测到对象内部属性的变化</span>
}, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> })
</code></pre>
<h4 data-id="heading-10">🎯 6. 生命周期钩子</h4>
<p><strong>完整生命周期：</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { 
  onBeforeMount, 
  onMounted,
  onBeforeUpdate,
  onUpdated,
  onBeforeUnmount,
  onUnmounted,
  onErrorCaptured
} <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-title function_">onBeforeMount</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'组件挂载前'</span>)
})

<span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'组件已挂载，可以访问DOM'</span>)
})

<span class="hljs-title function_">onBeforeUpdate</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'组件更新前'</span>)
})

<span class="hljs-title function_">onUpdated</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'组件已更新'</span>)
})

<span class="hljs-title function_">onBeforeUnmount</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'组件卸载前'</span>)
})

<span class="hljs-title function_">onUnmounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'组件已卸载'</span>)
})

<span class="hljs-title function_">onErrorCaptured</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'捕获到子组件错误:'</span>, error)
})
</code></pre>
<h3 data-id="heading-11">第四章：Vue3开发模式的优势</h3>
<h4 data-id="heading-12">🚀 1. 开发效率对比</h4>



































<table><thead><tr><th>功能</th><th>传统JS代码量</th><th>Vue3代码量</th><th>效率提升</th></tr></thead><tbody><tr><td>数据绑定</td><td>10-15行</td><td>1行</td><td>90%</td></tr><tr><td>列表渲染</td><td>15-20行</td><td>3行</td><td>85%</td></tr><tr><td>事件处理</td><td>5-10行</td><td>1行</td><td>80%</td></tr><tr><td>样式绑定</td><td>5-10行</td><td>1行</td><td>80%</td></tr></tbody></table>
<h4 data-id="heading-13">🎯 2. 思维模式转变</h4>
<p><strong>传统开发思维</strong>（怎么做）：</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> 找到DOM元素
<span class="hljs-bullet">2.</span> 监听事件
<span class="hljs-bullet">3.</span> 获取数据
<span class="hljs-bullet">4.</span> 操作DOM更新界面
</code></pre>
<p><strong>Vue3开发思维</strong>（要什么）：</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> 定义数据状态
<span class="hljs-bullet">2.</span> 描述UI与数据的关系
<span class="hljs-bullet">3.</span> 修改数据
<span class="hljs-bullet">4.</span> 界面自动更新
</code></pre>
<h4 data-id="heading-14">💡 3. 性能优化自动化</h4>
<p>Vue3自动为你做了这些优化：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. 虚拟DOM减少真实DOM操作</span>
<span class="hljs-comment">// 2. Diff算法最小化更新</span>
<span class="hljs-comment">// 3. 响应式系统精确追踪依赖</span>
<span class="hljs-comment">// 4. 计算属性缓存避免重复计算</span>
<span class="hljs-comment">// 5. 组件复用减少渲染开销</span>
</code></pre>
<h3 data-id="heading-15">第五章：实战技巧与最佳实践</h3>
<h4 data-id="heading-16">📝 1. 代码组织建议</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
// 1. 导入部分
import { ref, computed, watch, onMounted } from 'vue'

// 2. 响应式数据
const title = ref('')
const todos = ref([])

// 3. 计算属性
const activeCount = computed(() =&gt; { /* ... */ })

// 4. 方法定义
const addTodo = () =&gt; { /* ... */ }

// 5. 生命周期
onMounted(() =&gt; { /* ... */ })

// 6. 监听器
watch(todos, () =&gt; { /* ... */ })
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-17">🎨 2. 样式管理技巧</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;style scoped&gt;
/* scoped属性让样式只作用于当前组件 */
.todo-item {
  padding: 10px;
}

/* 深度选择器 */
:deep(.child-component) {
  color: red;
}

/* 全局样式 */
:global(.global-class) {
  font-size: 16px;
}
&lt;/style&gt;
</code></pre>
<h4 data-id="heading-18">🔧 3. 调试技巧</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. 在模板中调试</span>
&lt;div&gt;{{ debugInfo }}&lt;/div&gt;

<span class="hljs-comment">// 2. 使用Vue Devtools浏览器插件</span>
<span class="hljs-comment">// 3. 使用console.log增强</span>
<span class="hljs-title function_">watch</span>(todos, <span class="hljs-function">(<span class="hljs-params">newTodos</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'todos变化:'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(newTodos, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>))
}, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> })
</code></pre>
<h3 data-id="heading-19">结语：从学习者到实践者</h3>
<p>通过这个Todo应用，我们看到了Vue3如何将我们从繁琐的DOM操作中解放出来，让我们能更专注于业务逻辑。这种<strong>声明式编程</strong>的思维方式，不仅让代码更简洁，也让开发更高效。</p>
<p><strong>记住</strong>：</p>
<ol>
<li>Vue3不是魔法，但它让开发变得像魔法一样简单</li>
<li>学习Vue3不仅是学习一个框架，更是学习一种更好的编程思维</li>
<li>从今天开始，尝试用数据驱动的方式思考问题</li>
</ol>
<p><strong>下一步建议</strong>：</p>
<ol>
<li>在Vue Playground中多练习</li>
<li>阅读Vue3官方文档</li>
<li>尝试实现更复杂的功能（过滤、搜索、排序）</li>
<li>学习Vue Router和Pinia</li>
</ol>
<hr/>
<p><strong>📚 资源推荐</strong>：</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2F" target="_blank" title="https://vuejs.org/" ref="nofollow noopener noreferrer">Vue3官方文档</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.vuemastery.com%2Fcourses%2F" target="_blank" title="https://www.vuemastery.com/courses/" ref="nofollow noopener noreferrer">Vue Mastery免费课程</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.com.cn%2F" target="_blank" title="https://vuejs.com.cn/" ref="nofollow noopener noreferrer">Vue.js中文社区</a></li>
</ul>
<p>希望这篇文章能帮助你更好地理解Vue3的强大之处！如果你有任何问题或想法，欢迎在评论区讨论交流。🌟</p>
<p><strong>一起进步，从今天开始！</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[UniApp 路由导航守卫]]></title>    <link>https://juejin.cn/post/7604037348607492134</link>    <guid>https://juejin.cn/post/7604037348607492134</guid>    <pubDate>2026-02-08T14:09:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7604037348607492134" data-draft-id="7603721514204233737" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" UniApp 路由导航守卫"/> <meta itemprop="keywords" content="前端,微信小程序"/> <meta itemprop="datePublished" content="2026-02-08T14:09:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="如果你好"/> <meta itemprop="url" content="https://juejin.cn/user/2272012281328215"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             UniApp 路由导航守卫
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2272012281328215/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    如果你好
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T14:09:06.000Z" title="Sun Feb 08 2026 14:09:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">UniApp 路由导航守卫</h2>
<p>大家平时做 Vue 项目，路由守卫基本都是标配：beforeEach 一写，白名单、token 校验、跳转拦截一气呵成。</p>
<p>但换到 UniApp 就会发现一个问题：<strong>没有 Vue-Router，也没有 beforeEach</strong>。</p>
<p>很多人刚上手都会懵：路由守卫到底怎么写？</p>
<p>其实 UniApp 有自己的方案，就是官方提供的 <strong>拦截器（interceptor）</strong>，今天就把完整可落地、直接复制粘贴的路由守卫给你们。</p>
<hr/>
<h3 data-id="heading-1">Vue 里是这样写的</h3>
<pre><code class="hljs language-javascript" lang="javascript">router.<span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">(<span class="hljs-params">to, <span class="hljs-keyword">from</span>, next</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (to.<span class="hljs-property">path</span> === <span class="hljs-string">'/login'</span>) <span class="hljs-keyword">return</span> <span class="hljs-title function_">next</span>()
  <span class="hljs-keyword">const</span> token = sessionStorage.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'token'</span>)
  <span class="hljs-keyword">if</span> (!token) <span class="hljs-keyword">return</span> <span class="hljs-title function_">next</span>(<span class="hljs-string">'/login'</span>)
  <span class="hljs-title function_">next</span>()
})
</code></pre>
<p>逻辑很简单：</p>
<ul>
<li>白名单直接过</li>
<li>没 token 跳登录</li>
<li>有 token 正常跳转</li>
</ul>
<p>但 UniApp 不这套，它的页面跳转全靠：</p>
<ul>
<li>uni.navigateTo</li>
<li>uni.redirectTo</li>
<li>uni.reLaunch</li>
<li>uni.switchTab</li>
</ul>
<p>所以思路也很直接：<strong>把这几个 API 全部拦截，自己做校验</strong>。</p>
<hr/>
<h3 data-id="heading-2">UniApp 路由守卫核心：拦截器</h3>
<p>官方文档里其实写得很清楚：
<code>uni.addInterceptor</code> 可以拦截几乎所有 uni 开头的 API，包括路由、请求、扫码、支付等等。</p>
<p>路由守卫，本质就是：
<strong>拦截路由跳转 → 判断权限 → 放行 / 拦截跳登录</strong></p>
<p>拦截器最重要的就是一个方法：
<strong>invoke(args)</strong></p>
<ul>
<li>return true ＝ 放行</li>
<li>return false ＝ 拦截，不执行原来的跳转</li>
</ul>
<p>懂这个，整个路由守卫就通了。</p>
<hr/>
<h3 data-id="heading-3">直接上代码：utils/interceptor.js</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 全局路由拦截器（路由守卫）</span>
<span class="hljs-comment">// 在 App.vue onLaunch 中调用一次即可</span>

<span class="hljs-comment">// 白名单：不需要登录就能访问的页面</span>
<span class="hljs-keyword">const</span> whiteList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([
  <span class="hljs-string">'/pages/login/login'</span>,
  <span class="hljs-comment">// '/pages/register/register', 想加就加</span>
])

<span class="hljs-comment">// 核心校验逻辑</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">checkAuth</span>(<span class="hljs-params">url</span>) {
  <span class="hljs-comment">// 截取纯路径，忽略 ? 参数</span>
  <span class="hljs-keyword">const</span> path = url.<span class="hljs-title function_">split</span>(<span class="hljs-string">'?'</span>)[<span class="hljs-number">0</span>]

  <span class="hljs-comment">// 白名单直接放行</span>
  <span class="hljs-keyword">if</span> (whiteList.<span class="hljs-title function_">has</span>(path)) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
  }

  <span class="hljs-comment">// 校验 token</span>
  <span class="hljs-keyword">const</span> token = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'token'</span>)
  <span class="hljs-keyword">return</span> !!token
}

<span class="hljs-comment">// 拦截器配置</span>
<span class="hljs-keyword">const</span> routeInterceptor = {
  <span class="hljs-title function_">invoke</span>(<span class="hljs-params">args</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'即将跳转：'</span>, args.<span class="hljs-property">url</span>)

    <span class="hljs-comment">// 校验通过，正常跳转</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">checkAuth</span>(args.<span class="hljs-property">url</span>)) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
    }

    <span class="hljs-comment">// 未登录 → 跳登录，并把原来要跳的地址带上</span>
    uni.<span class="hljs-title function_">redirectTo</span>({
      <span class="hljs-attr">url</span>: <span class="hljs-string">`/pages/login/login?redirect=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(args.url)}</span>`</span>
    })

    <span class="hljs-comment">// 拦截本次路由跳转</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
  }
}

<span class="hljs-comment">// 注册所有路由拦截</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">initRouteGuard</span>(<span class="hljs-params"/>) {
  uni.<span class="hljs-title function_">addInterceptor</span>(<span class="hljs-string">'navigateTo'</span>, routeInterceptor)
  uni.<span class="hljs-title function_">addInterceptor</span>(<span class="hljs-string">'redirectTo'</span>, routeInterceptor)
  uni.<span class="hljs-title function_">addInterceptor</span>(<span class="hljs-string">'reLaunch'</span>, routeInterceptor)
  uni.<span class="hljs-title function_">addInterceptor</span>(<span class="hljs-string">'switchTab'</span>, routeInterceptor)

}
</code></pre>
<hr/>
<h3 data-id="heading-4">在 App.vue 中启用（非常关键）</h3>
<p>为什么必须写在 <code>onLaunch</code>？</p>
<p>因为：
<strong>拦截器必须在任何页面跳转之前就注册好</strong>
onLaunch 是应用启动最早的生命周期，只执行一次，最适合干这事。</p>
<pre><code class="hljs language-vue" lang="vue">&lt;script&gt;
import { initRouteGuard } from '@/utils/interceptor.js'

export default {
  onLaunch() {
    // 启动路由守卫
    initRouteGuard()
  },
  onShow() {},
  onHide() {}
}
&lt;/script&gt;
</code></pre>
<hr/>
<h3 data-id="heading-5">登录成功后如何“回跳原来页面”</h3>
<p>拦截时我们拼了一个 <code>redirect</code> 参数：</p>
<pre><code class="hljs language-ini" lang="ini">/login?<span class="hljs-attr">redirect</span>=xxx
</code></pre>
<p>登录成功后这样跳回去就行：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">login</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// 登录请求...</span>
  <span class="hljs-keyword">const</span> token = res.<span class="hljs-property">data</span>.<span class="hljs-property">token</span>
  uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">'token'</span>, token)

  <span class="hljs-comment">// 获取当前页面实例</span>
  <span class="hljs-keyword">const</span> pages = <span class="hljs-title function_">getCurrentPages</span>()
  <span class="hljs-keyword">const</span> current = pages[pages.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]
  <span class="hljs-keyword">const</span> redirect = current.<span class="hljs-property">options</span>.<span class="hljs-property">redirect</span>

  <span class="hljs-keyword">if</span> (redirect) {
    <span class="hljs-comment">// 跳回原来想访问的页面</span>
    uni.<span class="hljs-title function_">redirectTo</span>({
      <span class="hljs-attr">url</span>: <span class="hljs-built_in">decodeURIComponent</span>(redirect)
    })
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// 默认跳首页或 tabBar</span>
    uni.<span class="hljs-title function_">switchTab</span>({
      <span class="hljs-attr">url</span>: <span class="hljs-string">'/pages/home/home'</span>
    })
  }
}
</code></pre>
<hr/>
<h3 data-id="heading-6">一些实用小细节</h3>
<ol>
<li>
<p><strong>tabBar 页面也能拦截</strong>
switchTab 已经包含在拦截里，没 token 照样跳登录。</p>
</li>
<li>
<p><strong>路径一定要写完整</strong>
<code>/pages/login/login</code> 别写错，不然白名单不生效。</p>
</li>
<li>
<p><strong>navigateBack 一般不用拦截</strong>
返回上一页通常不需要权限，除非你有特殊场景。</p>
</li>
<li>
<p><strong>可扩展权限控制</strong>
想加角色、验过期、验状态，直接在 <code>checkAuth</code> 里加逻辑就行，非常灵活。</p>
</li>
</ol>
<hr/>
<h3 data-id="heading-7">总结</h3>
<ul>
<li>UniApp 没有 beforeEach，但能用 <code>uni.addInterceptor</code> 实现一模一样的效果</li>
<li>拦截 navigateTo / redirectTo / reLaunch / switchTab 四个 API 就够覆盖所有路由</li>
<li>白名单 + token 校验 = 最常用路由守卫</li>
<li>必须在 App.vue onLaunch 里初始化，否则不生效</li>
<li>代码直接复制，改改页面路径就能上线</li>
</ul>
<p>这套写法我在好几个 UniApp 项目里都在用，H5、小程序、App 全端稳定，没坑。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[【节点】[Exposure节点]原理解析与实际应用]]></title>    <link>https://juejin.cn/post/7604084016509993001</link>    <guid>https://juejin.cn/post/7604084016509993001</guid>    <pubDate>2026-02-09T01:58:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7604084016509993001" data-draft-id="7604093823957958675" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="【节点】[Exposure节点]原理解析与实际应用"/> <meta itemprop="keywords" content="游戏开发,图形学,Unity3D"/> <meta itemprop="datePublished" content="2026-02-09T01:58:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SmalBox"/> <meta itemprop="url" content="https://juejin.cn/user/2218166695237532"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            【节点】[Exposure节点]原理解析与实际应用
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2218166695237532/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SmalBox
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-09T01:58:21.000Z" title="Mon Feb 09 2026 01:58:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读9分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">【Unity Shader Graph 使用与特效实现】</a><strong>专栏-直达</strong></p>
</blockquote>
<p>曝光节点是Unity Shader Graph中一个功能强大的工具节点，专门用于在着色器中访问摄像机的曝光信息。在基于物理的渲染（PBR）流程中，曝光控制是实现高动态范围（HDR）渲染的关键组成部分，而曝光节点则为着色器艺术家提供了直接访问这些曝光参数的途径。</p>
<p>曝光节点的核心功能是从当前渲染管线中获取摄像机的曝光值，使着色器能够根据场景的曝光设置做出相应的反应。这在创建对光照条件敏感的着色器效果时尤为重要，比如自动调整材质亮度、实现曝光自适应效果或者创建与摄像机曝光设置同步的后期处理效果。</p>
<p>在现代化的游戏开发中，HDR渲染已经成为标准配置，它允许场景中的亮度值超出传统的0-1范围，从而能够更真实地模拟现实世界中的光照条件。曝光节点正是在这样的背景下发挥着重要作用，它架起了着色器与渲染管线曝光系统之间的桥梁。</p>
<h2 data-id="heading-0">渲染管线兼容性</h2>
<p>曝光节点在不同渲染管线中的支持情况是开发者需要特别注意的重要信息。了解节点的兼容性有助于避免在项目开发过程中遇到意外的兼容性问题。</p>















<table><thead><tr><th><strong>节点</strong></th><th><strong>通用渲染管线 (URP)</strong></th><th><strong>高清渲染管线 (HDRP)</strong></th></tr></thead><tbody><tr><td>Exposure</td><td>否</td><td>是</td></tr></tbody></table>
<p>从兼容性表格中可以清楚地看到，曝光节点目前仅在高清渲染管线（HDRP）中得到支持，而在通用渲染管线（URP）中不可用。这一差异主要源于两种渲染管线在曝光处理机制上的根本区别。</p>
<p>HDRP作为Unity的高端渲染解决方案，内置了完整的物理相机和曝光系统，支持自动曝光（自动曝光适应）和手动曝光控制。HDRP的曝光系统基于真实的物理相机参数，如光圈、快门速度和ISO感光度，这使得它能够提供更加真实和灵活的曝光控制。</p>
<p>相比之下，URP虽然也支持HDR渲染，但其曝光系统相对简化，主要提供基本的曝光补偿功能，而没有HDRP那样完整的物理相机模拟。因此，URP中没有提供直接访问曝光值的Shader Graph节点。</p>
<p>对于URP用户，如果需要实现类似的功能，可以考虑以下替代方案：</p>
<ul>
<li>使用自定义渲染器特性传递曝光参数</li>
<li>通过脚本将曝光值作为着色器全局属性传递</li>
<li>使用URP提供的其他光照相关节点间接实现类似效果</li>
</ul>
<h2 data-id="heading-1">端口详解</h2>
<p>曝光节点的端口配置相对简单，但理解每个端口的特性和用途对于正确使用该节点至关重要。</p>

















<table><thead><tr><th>名称</th><th>方向</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td><strong>Output</strong></td><td>输出</td><td>Float</td><td>曝光值。</td></tr></tbody></table>
<p>曝光节点只有一个输出端口，这意味着它只能作为数据源在Shader Graph中使用，而不能接收外部输入。这种设计反映了曝光值的本质——它是从渲染管线的相机系统获取的只读参数。</p>
<p>输出端口的Float类型表明曝光值是一个标量数值，这个数值代表了当前帧或上一帧的曝光乘数。在HDRP的曝光系统中，这个值通常用于将场景中的光照值从HDR范围映射到显示设备的LDR范围。</p>
<p>理解曝光值的数值范围对于正确使用该节点非常重要：</p>
<ul>
<li>当曝光值为1.0时，表示没有应用任何曝光调整</li>
<li>曝光值大于1.0表示增加曝光（使图像更亮）</li>
<li>曝光值小于1.0表示减少曝光（使图像更暗）</li>
<li>在自动曝光系统中，这个值会根据场景亮度动态变化</li>
</ul>
<p>在实际使用中，曝光节点的输出可以直接用于乘法运算来调整材质的亮度，或者用于更复杂的曝光相关计算。例如，在创建自发光材质时，可以使用曝光值来确保材质在不同曝光设置下保持视觉一致性。</p>
<h2 data-id="heading-2">曝光类型深度解析</h2>
<p>曝光节点的核心功能通过其曝光类型（Exposure Type）设置来实现，这个设置决定了节点从渲染管线获取哪种类型的曝光值。理解每种曝光类型的特性和适用场景是掌握该节点的关键。</p>

























<table><thead><tr><th>名称</th><th>描述</th></tr></thead><tbody><tr><td><strong>CurrentMultiplier</strong></td><td>从当前帧获取摄像机的曝光值。</td></tr><tr><td><strong>InverseCurrentMultiplier</strong></td><td>从当前帧获取摄像机的曝光值的倒数。</td></tr><tr><td><strong>PreviousMultiplier</strong></td><td>从上一帧获取摄像机的曝光值。</td></tr><tr><td><strong>InversePreviousMultiplier</strong></td><td>从上一帧获取摄像机的曝光值的倒数。</td></tr></tbody></table>
<h3 data-id="heading-3">CurrentMultiplier（当前帧曝光乘数）</h3>
<p>CurrentMultiplier是最常用的曝光类型，它提供当前帧相机的实时曝光值。这个值反映了相机系统根据场景亮度和曝光设置计算出的当前曝光乘数。</p>
<p>使用场景示例：</p>
<ul>
<li>实时调整材质亮度以匹配场景曝光</li>
<li>创建对曝光敏感的特殊效果</li>
<li>确保自定义着色器与HDRP曝光系统同步</li>
</ul>
<p>技术特点：</p>
<ul>
<li>值随每帧更新，响应实时变化</li>
<li>直接反映当前相机的曝光状态</li>
<li>适用于大多数需要与曝光同步的效果</li>
</ul>
<h3 data-id="heading-4">InverseCurrentMultiplier（当前帧曝光乘数倒数）</h3>
<p>InverseCurrentMultiplier提供当前帧曝光值的倒数，即1除以曝光乘数。这种类型的曝光值在某些特定计算中非常有用，特别是当需要抵消曝光影响时。</p>
<p>使用场景示例：</p>
<ul>
<li>在后期处理效果中抵消曝光影响</li>
<li>创建在任意曝光设置下保持恒定亮度的元素</li>
<li>进行曝光相关的颜色校正计算</li>
</ul>
<p>技术特点：</p>
<ul>
<li>值与CurrentMultiplier互为倒数</li>
<li>可用于"反向"曝光计算</li>
<li>在需要保持恒定视觉亮度的效果中特别有用</li>
</ul>
<h3 data-id="heading-5">PreviousMultiplier（上一帧曝光乘数）</h3>
<p>PreviousMultiplier提供上一帧的曝光值，这在某些需要平滑过渡或避免闪烁的效果中非常有用。由于自动曝光系统可能会导致曝光值在帧之间变化，使用上一帧的值可以提供更加稳定的参考。</p>
<p>使用场景示例：</p>
<ul>
<li>实现曝光平滑过渡效果</li>
<li>避免因曝光突变导致的视觉闪烁</li>
<li>时间相关的曝光计算</li>
</ul>
<p>技术特点：</p>
<ul>
<li>提供前一帧的曝光状态</li>
<li>有助于减少曝光突变带来的视觉问题</li>
<li>在时间性效果中提供一致性</li>
</ul>
<h3 data-id="heading-6">InversePreviousMultiplier（上一帧曝光乘数倒数）</h3>
<p>InversePreviousMultiplier结合了上一帧数据和倒数计算，为特定的高级应用场景提供支持。这种曝光类型在需要基于历史曝光数据进行复杂计算的效果中发挥作用。</p>
<p>使用场景示例：</p>
<ul>
<li>基于历史曝光的数据分析</li>
<li>复杂的时序曝光效果</li>
<li>高级曝光补偿算法</li>
</ul>
<p>技术特点：</p>
<ul>
<li>结合了时间延迟和倒数计算</li>
<li>适用于专业的曝光处理需求</li>
<li>在高级渲染技术中使用</li>
</ul>
<h2 data-id="heading-7">实际应用案例</h2>
<h3 data-id="heading-8">HDR自发光材质</h3>
<p>在HDRP中创建自发光材质时，使用曝光节点可以确保材质在不同曝光设置下保持正确的视觉表现。以下是一个基本的实现示例：</p>
<ol>
<li>创建Shader Graph并添加Exposure节点</li>
<li>设置曝光类型为CurrentMultiplier</li>
<li>将自发光颜色与曝光节点输出相乘</li>
<li>连接到主节点的Emission输入</li>
</ol>
<p>这种方法确保了自发光材质的亮度会随着相机曝光设置自动调整，在低曝光情况下不会过亮，在高曝光情况下不会过暗。</p>
<h3 data-id="heading-9">曝光自适应效果</h3>
<p>利用PreviousMultiplier和CurrentMultiplier可以创建平滑的曝光过渡效果，避免自动曝光调整时的突兀变化：</p>
<ol>
<li>添加两个Exposure节点，分别设置为PreviousMultiplier和CurrentMultiplier</li>
<li>使用Lerp节点在两者之间进行插值</li>
<li>通过Time节点控制插值速度</li>
<li>将结果用于需要平滑过渡的效果</li>
</ol>
<p>这种技术特别适用于全屏效果或UI元素，可以确保视觉元素在曝光变化时平稳过渡。</p>
<h3 data-id="heading-10">曝光不变元素</h3>
<p>某些场景元素可能需要在不同曝光设置下保持恒定的视觉亮度，这时可以使用InverseCurrentMultiplier：</p>
<ol>
<li>使用Exposure节点设置为InverseCurrentMultiplier</li>
<li>将需要保持恒定亮度的颜色值与曝光倒数相乘</li>
<li>这样可以抵消相机曝光对特定元素的影响</li>
</ol>
<p>这种方法常用于UI渲染、调试信息显示或其他需要独立于场景曝光的视觉元素。</p>
<h2 data-id="heading-11">性能考虑与最佳实践</h2>
<p>虽然曝光节点本身性能开销很小，但在实际使用中仍需注意一些性能优化策略：</p>
<ul>
<li>避免在片段着色器中过度复杂的曝光计算</li>
<li>考虑使用顶点着色器进行曝光相关计算（如果适用）</li>
<li>对于静态物体，可以评估是否真的需要每帧更新曝光值</li>
<li>在移动平台使用时注意测试性能影响</li>
</ul>
<p>最佳实践建议：</p>
<ul>
<li>在HDRP项目中充分利用曝光节点确保视觉一致性</li>
<li>理解不同曝光类型的适用场景，选择合适的类型</li>
<li>结合HDRP的Volume系统测试着色器在不同曝光设置下的表现</li>
<li>在自动曝光和手动曝光模式下都进行测试</li>
</ul>
<h2 data-id="heading-12">故障排除与常见问题</h2>
<p>在使用曝光节点时可能会遇到一些常见问题，以下是相应的解决方案：</p>
<ul>
<li><strong>节点在URP中不可用</strong>：这是预期行为，曝光节点仅支持HDRP</li>
<li><strong>曝光值不更新</strong>：检查相机是否启用了自动曝光，在手动曝光模式下值可能不变</li>
<li><strong>效果不符合预期</strong>：确认使用了正确的曝光类型，不同场景需要不同的类型</li>
<li><strong>移动端表现异常</strong>：某些移动设备可能对HDR支持有限，需进行针对性测试</li>
</ul>
<p>调试技巧：</p>
<ul>
<li>使用Debug节点输出曝光值检查实际数值</li>
<li>在不同光照环境下测试着色器表现</li>
<li>对比手动曝光和自动曝光模式下的效果差异</li>
</ul>
<hr/>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">【Unity Shader Graph 使用与特效实现】</a><strong>专栏-直达</strong>
（欢迎<em>点赞留言</em>探讨，更多人加入进来能更加完善这个探索的过程，🙏）</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JS 对象]]></title>    <link>https://juejin.cn/post/7603721514204266505</link>    <guid>https://juejin.cn/post/7603721514204266505</guid>    <pubDate>2026-02-08T14:33:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603721514204266505" data-draft-id="7603721514204135433" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JS 对象"/> <meta itemprop="keywords" content="前端,JavaScript"/> <meta itemprop="datePublished" content="2026-02-08T14:33:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="偶像佳沛"/> <meta itemprop="url" content="https://juejin.cn/user/2561180400626944"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JS 对象
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2561180400626944/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    偶像佳沛
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T14:33:00.000Z" title="Sun Feb 08 2026 14:33:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>“为什么我给对象加的属性不见了？”“<strong>new</strong> 构造函数为什么不用 <strong>return</strong> 也能拿到对象？”“对象遍历为什么会拿到原型上的属性？”</p>
<p><em><strong>重点：JS 万物皆对象</strong></em></p>
<h2 data-id="heading-0">一、JS 对象是什么</h2>
<p>简而言之，对象是用花括号 <strong>{ }</strong> 包裹的键值对，</p>
<pre><code class="hljs language-js" lang="js">
<span class="hljs-keyword">const</span> a = <span class="hljs-number">1</span>
<span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'小明'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>
}
</code></pre>
<h2 data-id="heading-1">二、JS 对象的创建方式</h2>
<h3 data-id="heading-2">1.通过字面量创建</h3>
<p>例如：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> person = {

}

</code></pre>
<p>这里的花括号相当于告诉了 <strong>V8</strong> 引擎，我现在写的东西是个对象，接下来的逻辑请按对象处理</p>
<h3 data-id="heading-3">2.通过 new 创建（调用官方提供的构造函数）</h3>
<p>例如：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> a = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>()
<span class="hljs-comment">// a = {}</span>
</code></pre>
<p>官方为 <strong>JS</strong> 提供了引用类型以及原始类型的构造函数，调用即可创建该类型的实例对象</p>
<h3 data-id="heading-4">3.通过自己写的构造函数通过 new 关键字调用</h3>
<p>例如：</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Car</span>(<span class="hljs-params">color</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'su7'</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = <span class="hljs-string">'1400'</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">lang</span> = <span class="hljs-string">'4800'</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">weight</span> = <span class="hljs-string">'1500'</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color
}
<span class="hljs-keyword">const</span> car1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Car</span>(<span class="hljs-string">'purple'</span>)
<span class="hljs-keyword">const</span> car2 = <span class="hljs-title class_">Car</span>(<span class="hljs-string">'purple'</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(car1, car2); <span class="hljs-comment">// Car { name: 'su7', height: '1400', lang: '4800', weight: '1500', color: 'purple' } undefined</span>

</code></pre>
<p>可以看到，<strong>car1</strong> 是通过 <strong>new</strong> 生成的，<strong>car2</strong> 则是直接通过直接调用我们写的 <strong>Car</strong> 函数生成的，为什么 <strong>car1</strong> 有值，<strong>car2</strong> 却是 <strong>undefined</strong> 呢？</p>
<p>先看 <strong>car2</strong> ，因为我们在函数内并没有返回值，是 <strong>undefined</strong> 情有可原
再看 <strong>car1</strong> ，同样没有返回值，可是有值，这唯一的区别就是 <strong>car1</strong> 是通过 <strong>new</strong> 生成的，
而在 <strong>new</strong> 一个函数（此处为<strong>Car</strong>） ，将 <strong>Car</strong> 用成了一个构造函数的样子，返回了一个实例对象，<strong>new</strong> 完源码其实是添加了返回值的，再来粗浅表达一下 <strong>new</strong> 源码大概干了些什么（不涉及原型链的部分的写法）</p>
<pre><code class="hljs language-js" lang="js">
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Car</span>(<span class="hljs-params">color</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'su7'</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = <span class="hljs-string">'1400'</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">lang</span> = <span class="hljs-string">'4800'</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">weight</span> = <span class="hljs-string">'1500'</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color
}
<span class="hljs-keyword">const</span> car1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Car</span>(<span class="hljs-string">'purple'</span>)


<span class="hljs-comment">// function Car(color) {</span>
<span class="hljs-comment">//   const a = {}</span>
<span class="hljs-comment">//   a.name = 'su7'</span>
<span class="hljs-comment">//   a.height = '1400'</span>
<span class="hljs-comment">//   a.lang = '4800'</span>
<span class="hljs-comment">//   a.weight = '1500'</span>
<span class="hljs-comment">//   a.color = color</span>
<span class="hljs-comment">//   return a</span>
<span class="hljs-comment">// }</span>
</code></pre>
<p>像是官方提供的数据类型构造函数，其实是涉及原型链和原型的继承的，这个点后面文章再介绍，此文仅谈论对象的表层内容</p>
<h3 data-id="heading-5">4.Object.create()</h3>
<p>这是官方提供的 <strong>Object</strong> 里的方法，侧重于原型的继承，后续文章详细介绍，此文提一嘴</p>
<h2 data-id="heading-6">三、对象的一些基本操作</h2>
<h3 data-id="heading-7">1.对象身上的键值对是可以添加函数的，我们一般称之为方法</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> a = {
  <span class="hljs-attr">skill</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'会飞'</span>);
  }
}

a.<span class="hljs-title function_">skill</span>() <span class="hljs-comment">// 会飞</span>
</code></pre>
<h3 data-id="heading-8">2.对象身上的增加和函数属性值</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> a = {
  <span class="hljs-attr">skill</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'会飞'</span>);
  }
}

a.<span class="hljs-title function_">skill</span>() <span class="hljs-comment">// 会飞</span>

a.<span class="hljs-property">options</span> = {
  <span class="hljs-attr">color</span>: <span class="hljs-string">'red'</span>,
  <span class="hljs-attr">size</span>: <span class="hljs-string">'1000'</span>
}

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a.<span class="hljs-property">options</span>); <span class="hljs-comment">// { color: 'red', size: '1000' }</span>

<span class="hljs-keyword">delete</span> a.<span class="hljs-property">options</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a.<span class="hljs-property">options</span>); <span class="hljs-comment">// undefined</span>
</code></pre>
<p>此处介绍了 <strong>JS</strong> 中对象怎么删除和添加属性</p>
<h2 data-id="heading-9">四、包装类</h2>
<p>这个名词也就是看着专业</p>
<p>在你定义一个字面量，不管是谁的字面量，官方都是通过 <strong>new</strong> 字段调用对应数据类型的构造函数生成的</p>
<p>这也是 <strong>JS</strong> 万物皆对象的依据</p>
<pre><code class="hljs language-js" lang="js">
<span class="hljs-keyword">var</span> num = <span class="hljs-number">123</span>  <span class="hljs-comment">// new Number(123)</span>
num.<span class="hljs-property">a</span> = <span class="hljs-string">'aaa'</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num.<span class="hljs-property">a</span>); <span class="hljs-comment">// undefined</span>

<span class="hljs-comment">// // 原始类型一定无法添加属性和方法，属性和方法是对象独有的</span>
<span class="hljs-comment">// var num = 123  // new Number(123)</span>
<span class="hljs-comment">// num.a = 'aaa'</span>
<span class="hljs-comment">// delete num.a</span>
<span class="hljs-comment">// console.log(num.a); // undefined</span>
</code></pre>
<p>按理来说，在给身为<strong>String</strong>类型的 <strong>num</strong> 添加 <strong>a</strong> 属性的时候就应该报错，但是 <strong>JS</strong> 是弱类型语言，一个变量只有在被使用的时候才知道是什么类型</p>
<p>在打印 <strong>num.a</strong> 的时候， <strong>V8</strong> 才想起来了， <strong>num</strong> 是 <strong>String</strong> 类型，而不是一个对象，所以源码在编译运行的时候，
偷偷把 <strong>num</strong> 身上的属性值给删掉了，当值被判定
为原始类型时就会自动将包装对象上添加的属性移除</p>
<p>但是在给 <strong>num</strong> 加属性的时候，<strong>JS</strong> 是真让把 <strong>num</strong> 当对象使</p>
<p>这里再举一个例子，涉及一点原型，后端文章会具体讲</p>
<pre><code class="hljs language-js" lang="js">
<span class="hljs-keyword">var</span> str = <span class="hljs-string">'hello'</span> 
<span class="hljs-title function_">typeof</span>(<span class="hljs-string">'hello'</span>)  <span class="hljs-comment">// string</span>
<span class="hljs-keyword">var</span> str = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-string">'hello'</span>)
str.<span class="hljs-property">length</span> = <span class="hljs-number">2</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-property">length</span>);  <span class="hljs-comment">// 5</span>

<span class="hljs-keyword">delete</span> str.<span class="hljs-property">length</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-property">length</span>);  <span class="hljs-comment">// 5</span>

</code></pre>
<p>其实 <strong>JS</strong> 中，<strong>String</strong> 类型的数据身上本就有 <strong>length</strong> 属性，我这里给他再挂一个 <strong>length</strong> ，可以看到，打印出来的 <strong>str.length</strong> 还是 5 ，就算把这个 <strong>length</strong> 删了，他还是有</p>
<p>这个是什么原因，最主要的，就是因为 <strong>length</strong> 不是挂在 <strong>str</strong> 的表层上，他是挂在 <strong>String</strong> 的原型上，这里 <strong>str</strong> 的 <strong>length</strong> 其实是继承过来的，关于原型的介绍，后续文章会提及</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[✨ 形势比人强，Chrome 大佬也去搞 Gemini 了]]></title>    <link>https://juejin.cn/post/7603677143215865871</link>    <guid>https://juejin.cn/post/7603677143215865871</guid>    <pubDate>2026-02-09T02:00:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603677143215865871" data-draft-id="7603677143215030287" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="✨ 形势比人强，Chrome 大佬也去搞 Gemini 了"/> <meta itemprop="keywords" content="Agent,前端,VibeCoding"/> <meta itemprop="datePublished" content="2026-02-09T02:00:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="卤代烃"/> <meta itemprop="url" content="https://juejin.cn/user/43636193770071"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ✨ 形势比人强，Chrome 大佬也去搞 Gemini 了
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/43636193770071/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    卤代烃
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-09T02:00:34.000Z" title="Mon Feb 09 2026 02:00:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读8分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>今天随便写点儿感想，内容没以前那么严肃。</p>
<p>前段时间有朋友转发了一篇 Blog <a href="https://link.juejin.cn?target=https%3A%2F%2Faddyosmani.com%2Fblog%2Fnext-two-years%2F" target="_blank" title="https://addyosmani.com/blog/next-two-years/" ref="nofollow noopener noreferrer">《The Next Two Years of Software Engineering》</a>，写的蛮不错的，于是看了眼作者，发现居然是 <a href="https://link.juejin.cn?target=https%3A%2F%2Faddyosmani.com%2F" target="_blank" title="https://addyosmani.com/" ref="nofollow noopener noreferrer">Addy Osmani</a>，对我来说其实是个老熟人（当然是单向的）了。</p>
<h2 data-id="heading-0">Addy 职业经历</h2>
<p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d555ede4d734e2a954f002f018de5bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2k5Luj54OD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771207236&amp;x-signature=HlAtev9FdGfMfDU4F3mRR7PE7S0%3D" width="200" alt="Addy 之前常用的头像" loading="lazy"/>
</p>
<p>因为之前工作方向是专门做性能优化的，我需要时刻关注 Chrome 的更新和相关特性，Addy Osmani 是一个高频出现的名字。他写了很多质量高的文章，之前我汇总过一篇专讲 JS 性能优化的文章：<a href="https://link.juejin.cn?target=https%3A%2F%2Fsupercodepower.com%2Fthe-cost-of-javascript" target="_blank" title="https://supercodepower.com/the-cost-of-javascript" ref="nofollow noopener noreferrer">《The Cost Of JavaScript》</a> ，主要参考内容其实都是他的分享和 Blog。而且这个人的<a href="https://link.juejin.cn?target=https%3A%2F%2Faddyosmani.com%2Fbio%2F" target="_blank" title="https://addyosmani.com/bio/" ref="nofollow noopener noreferrer">职场经历</a>非常的亮眼：</p>
<ul>
<li>16 岁的时候作为独立开发者开发过一个 XWebs，相当于「用 C++ 手写了一个浏览器」</li>
<li>2011 年做了一个 TodoMVC 开源项目，这个项目最后成为了各前端框架的起手式教学项目</li>
<li>2012 年加入 Chrome 后一步步升职为 Senior Staff Engineering Manager，主要负责 Chrome 的 DX（Developer Experience，开发者体验）方向，主要的成果有：
<ul>
<li>Chrome DevTools：最好用的 Web 调试平台，没有之一</li>
<li>Lighthouse：性能统计工具</li>
<li>Puppeteer：浏览器自动化工具</li>
<li>PWA/Core Web Vitals/MV3/Chrome DevTools MCP 等 Chrome 特性和相关生态的建设</li>
</ul>
</li>
<li>除了工作内容，他还写了很多的书，做了不少独立产品</li>
</ul>
<br/>
<p>从上面可以看出，他在过去的十几年里，基于 Chrome 在 Web 上做了很大的贡献（尤其是开发者生态上），但是在 2025 年年底，他转入了 Google Cloud AI 团队，工作重心其实还是 DX，社区运作影响力建设这些。只不过对象从 <strong>Chrome</strong> 转为了 <strong>Gemini</strong>。</p>
<p>当然你也可以认为，这不过是聪明人的又一次聪明的选择罢了，毕竟形势就摆在这里。但是我前面也说了，Addy Osmani 这个人非常喜欢写 Blog 对外分享，入职 Cloud AI 后，他在两个月内就写了 12 篇 Blog，基本都和 AI Agent，AI Coding 相关。而且根据他的过往经历，他是那种非常难得的既有丰富的团队管理经验，又每天写代码的人，所以他的文章会<strong>兼顾开发者和管理者的视角</strong>，我个人看后觉得还是有不少收获的。</p>
<h2 data-id="heading-1">观点杂谈</h2>
<h3 data-id="heading-2">Taste</h3>
<p>比如说最近有个词 Taste 很火，大致的背景就是说现在 AI 生成的代码非常快，代替了工程师之前手工编程的工作，那么决定做什么，向哪个方向做，系统如何设计就更重要了。</p>
<p>有人建议把 Taste 翻译为 <strong>品味</strong>/<strong>审美</strong>，其实含义很相近了，但问题是这个词本身就太大了，很容易和其它场景混合在一起，比如说音乐品味/美术审美；二是这个词很宽泛，这个就和评论一幅画，泛泛而谈的一句「这幅画审美不行」，肯定不如说 「这幅画的笔触如何，构图有什么缺陷，色彩上有什么值得提升的地方」 更有建设性。</p>
<p>Addy 其实在<a href="https://link.juejin.cn?target=https%3A%2F%2Faddyosmani.com%2Fblog%2Fcoding-agents-manager%2F" target="_blank" title="https://addyosmani.com/blog/coding-agents-manager/" ref="nofollow noopener noreferrer">《Your AI coding agents need a manager》</a>这篇 Blog 里就探讨过这个问题，他是以管理学的角度解释了这个词。他个人认为，<strong>Taste 其实是一个伪装的管理学技能</strong>：</p>
<blockquote>
<p>That is a manager skill in disguise: prioritization, saying no, defining success, running small experiments, and killing bad ideas quickly. <br/><br/>
这其实是伪装的管理技能：优先级排序、学会拒绝、定义成功标准、进行小规模实验，以及快速淘汰糟糕的方案</p>
</blockquote>
<p>这几个分类指标就比较清晰了，从 Taste 这个大词中确定了几个方向，每次指挥 Coding Agent 工作前，基于这几条规则做好前期的规划，会比蒙头上来直接干要好的多。</p>
<br/>
<h3 data-id="heading-3">Agentic Engineering</h3>
<p>整体上看，可能和长期担任 Manager 有关，Addy 的很多 Blog 都有管理者的角度，即<strong>如何稳健的协调多个 AI Agent 去完成严肃的开发工作</strong>。</p>
<p>比如说最近的一篇文章<a href="https://link.juejin.cn?target=https%3A%2F%2Faddyosmani.com%2Fblog%2Fagentic-engineering%2F" target="_blank" title="https://addyosmani.com/blog/agentic-engineering/" ref="nofollow noopener noreferrer">《Agentic Engineering》</a>，他就认为 「vibe coding」 这个词过于泛化了，在一些不重要的场景（比如说 MVP 原型设计，个人脚本和一次性工具等）用 vibe coding 这个词没啥问题，但是如果用在真实的线上项目上，很明显会给其它组员和管理者带来歧义。</p>
<p>那么破解的方法是什么呢？其实还是几十年来积累的软件工程开发经验：从开发规范，到合码流程，再到最后的测试和交付，都要有严格的工程定义和划分，中间的实施操作可以交给 AI 来做，但是<strong>你得为最终的交付负责</strong>。这一点其实和 1979 年也没什么不一样：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/178d6b9dceed4b8ebefce31d89b7c868~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2k5Luj54OD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771207236&amp;x-signature=KM7KK%2B16VVigsGtVcWA%2B832OfGE%3D" alt="IBM Slide" loading="lazy"/></p>
<br/>
<p>当然这套严肃的工程方案用轻佻的 <a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fkarpathy%2Fstatus%2F1886192184808149383" target="_blank" title="https://x.com/karpathy/status/1886192184808149383" ref="nofollow noopener noreferrer">vibe coding</a> 描述就不合适了，应该叫 <a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fkarpathy%2Fstatus%2F2019137879310836075" target="_blank" title="https://x.com/karpathy/status/2019137879310836075" ref="nofollow noopener noreferrer">agentic engineering</a>（智能体工程）。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fda056e46ddf49b3941b2aa89f8706dc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2k5Luj54OD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771207236&amp;x-signature=Rt4YvWRhBfP5stBZD2CGla66zO0%3D" alt="vibe - agentic" loading="lazy"/></p>
<p>相信大家也或多或少遇到过类似的场景，如果把所有的工作都交给 AI，自己只在输入框里写需求，不做任何工程学上的约束，迭代多轮后熵增爆炸的代码其实 AI 也改不动了，更不用说其它接手维护的人，最后只会透支项目的生命力。只有在工程的约束下，才能持续的保证 AI 编程的速度稳定，而不是到某个节点迭代速度开始断崖式下跌。</p>
<br/>
<h3 data-id="heading-4">AI with DX</h3>
<p>除了一些具体的细节，我个人感觉他画的一张研发体系图也很不错，描述了 AI 可以影响到传统开发流程中的哪些环节，会对 DX 有什么样的影响。这个图是他写的一本书<a href="https://link.juejin.cn?target=https%3A%2F%2Fbeyond.addy.ie%2F" target="_blank" title="https://beyond.addy.ie/" ref="nofollow noopener noreferrer">《Beyond Vibe Coding》</a>里的（不过这本书 AI 辅助编写内容比较多，感兴趣的人过一遍即可，个人认为不需要细看）。</p>
<p>首先他画了一个「前 AI 时代」的研发流程图：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/daabcba3747e4506a34670fb11fcf5b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2k5Luj54OD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771207236&amp;x-signature=dDd1ZXcokdjJ9CLqgcClWjOhEBk%3D" alt="DX Before AI" loading="lazy"/></p>
<p>如上图所示，在传统的软件开发流程里，其实是多个 Loop 嵌套完成的：</p>
<ul>
<li>最左侧的 Design Loop，主要讲正式 Coding 前的一些准备工作，比如说方案调研，架构设计，流程拆解等</li>
<li>中间的 Inner Loop，就是指之前一个单词一个单词的编码环节，这个也是大部分程序做的事情</li>
<li>Submit Loop 就是每次提交 MR 的流程，包含 Lint，Code Review 等环节</li>
<li>Outer Loop 就是产品纬度的大功能迭代流程，之前的 CICD 主要优化的就是这个环节</li>
</ul>
<br/>
<p>上面的传统流程，在 Coding Agent 介入后，各个流程和节点上都有不同程度的加速，改变如下：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec3e55845f99444f9f6ba43269a08650~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2k5Luj54OD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771207236&amp;x-signature=SBqnEIJMGODAo8ush9dfj8N4zxk%3D" alt="DX After AI" loading="lazy"/></p>
<ul>
<li>首先在 Design Loop 里，Design 环节有一些 ChatBot 的介入，DeepResearch 等功能会加速很多调研的时间投入，Plan 一定程度上也被类似 Claude Code 的 Plan 功能做了替代</li>
<li>Inner Loop，基本上已经被 Coding Agent <strong>全方位替代</strong>，市面上太多编程产品做这个了</li>
<li>Submit Loop 中的 Code Review 环节其实也有各种 Agent 做审核，这个其实也有很成熟的产品了</li>
<li>Outer Loop 里，每次发布后的资源利用率，性能防劣化等场景，其实也可以让 AI 做繁复工作的整合</li>
</ul>
<p>从上面的变化可以很清楚的看出，只有「Thinking」这个步骤暂时未被替代，其它环节要不被规范的 CICD 流程加速，要不被 Coding Agent 加速。其实这个「Thinking」的环节，不就是 Manager（Agentic Engineering）做的吗？当然也可以极端点儿，现在我们还是需要有个真实的人类为最终结果负责（bei guo）。</p>
<h2 data-id="heading-5">总结</h2>
<p>上面说的几个观点，只是我对 Addy 最近的几篇 Blog 感触比较深的地方。我个人还是推荐开发者亲自读读他最近的 Blog，相信不同的人可以获得不同的感悟。</p>
<p>总而言之，无论有没有 AI，在工程角度上构建一套稳健的可复用的系统，在可以在保证质量的同时提高整体的交付效率，这个在任何商业场景都是极具诱惑力的。就如本文标题所说，<strong>形势比人强</strong>，大家还是做好准备，一起经历这场 AI 革命吧。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[DNS详解——域名是如何解析的]]></title>    <link>https://juejin.cn/post/7604037348607655974</link>    <guid>https://juejin.cn/post/7604037348607655974</guid>    <pubDate>2026-02-08T14:39:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7604037348607655974" data-draft-id="7603994823326154762" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="DNS详解——域名是如何解析的"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-02-08T14:39:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="深度涌现"/> <meta itemprop="url" content="https://juejin.cn/user/2524932621734990"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            DNS详解——域名是如何解析的
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2524932621734990/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    深度涌现
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T14:39:31.000Z" title="Sun Feb 08 2026 14:39:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读10分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>上周，我把域名指向了一个新的服务器。修改了A记录，等了一段时间……结果什么都没发生。旧网站仍然显示。我清除了浏览器缓存，还是不行。重启电脑，依然无济于事。</p>
<p>三个小时后，我了解了DNS传播和TTL（生存时间）。这个看似无关的探索让我真正理解了DNS的工作原理。不仅仅是“它将域名转换为IP地址”，而是整个系统。</p>
<p>以下是我学到的东西。</p>
<p>DNS 的本质很简单：它将域名解析为 IP 地址。你输入 <code>example.com</code>，DNS 返回 <code>93.184.216.34</code>，然后你的浏览器连接到该 IP 地址。如果没有 DNS，你就需要记住每个网站的 IP 地址。谁也不想这样。</p>
<p>但有趣的地方在于它是<em>如何</em>实现的。</p>
<h2 data-id="heading-0">DNS层次结构</h2>
<p>让我最终理解 DNS 的思维模型是：它像一条层层递进的链子。每一层都了解下一层的信息，但没有哪一层知道全部信息。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d85499e97eab427db4ef2c87af5f8125~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rex5bqm5raM546w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771166392&amp;x-signature=BrhK%2B7fLeabq%2BMkp4uW9aaObaVc%3D" alt="DNS Hierarchy diagram showing Root, TLDs, Domains, and Subdomains" loading="lazy"/></p>
<h3 data-id="heading-1">根</h3>
<p>所有 DNS 查询都从这里开始。直到我需要调试传播问题时，我才知道根服务器的存在。全球共有 13 个根服务器集群，由 Verisign、ICANN 和 NASA 等组织运营。根服务器不知道 <code>example.com</code> 在哪里，但它们知道如何找到 <code>.com</code> 顶级域名服务器。它们是引用链的起点。</p>
<h3 data-id="heading-2">顶级域名 (TLD)</h3>
<p>您知道这部分——域名的最后几部分：<code>.com</code>、<code>.org</code>、<code>.in</code>、<code>.io</code>。顶级域名服务器知道所有注册在其名下的域名。<code>.com</code>顶级域名知道在哪里可以找到<code>example.com</code>、<code>google.com</code>以及其他所有<code>.com</code>域名。</p>
<p>常用顶级域名：</p>
<ul>
<li><code>.com</code> - 商业用途（任何人都可以注册）</li>
<li><code>.org</code> - 组织</li>
<li><code>.net</code> - 网络服务</li>
<li><code>.io</code> - 英属印度洋领地（科技界人士青睐）</li>
<li><code>.dev</code> - 开发者（需要 HTTPS）</li>
<li><code>.gov</code> - 仅限美国政府</li>
<li><code>.edu</code> - 教育机构</li>
</ul>
<h3 data-id="heading-3">领域</h3>
<p>你实际购买的域名包括：<code>example</code>、<code>google</code>、<code>github</code>。加上顶级域名 (TLD) 后，就得到 <code>example.com</code>。这些域名可以从 Namecheap、GoDaddy 或 Cloudflare 等注册商处购买。我的域名使用<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.cloudflare.com%2Fdns%2F" target="_blank" title="https://www.cloudflare.com/dns/" ref="nofollow noopener noreferrer">Cloudflare</a> ，DNS 管理简洁且免费。（了解 DNS 后，你或许可以看看我<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bhusalmanish.com.np%2Fblog%2Fposts%2Fdeploy-drf-production.html" target="_blank" title="https://www.bhusalmanish.com.np/blog/posts/deploy-drf-production.html" ref="nofollow noopener noreferrer">关于将 Django REST Framework 部署到生产环境的指南</a>——在那里你会真正用到这些知识。）</p>
<h3 data-id="heading-4">子域名</h3>
<p>域名之前的任何内容：<code>api.example.com</code>、<code>mail.example.com</code>、<code>staging.example.com</code>。最棒的是什么？您可以通过 DNS 记录自行创建这些内容，无需额外购买。如果您拥有 <code>example.com</code>，则可以免费创建无限数量的子域名。</p>
<h2 data-id="heading-5">DNS记录</h2>
<p>我第一次打开域名DNS管理面板时，看到了一堆我不认识的记录类型：A、AAAA、CNAME、MX、TXT……看起来很吓人。但一旦你了解了每种记录的作用，其实就很简单了。</p>
<h3 data-id="heading-6">记录</h3>
<p>这是你最常用到的配置项。它将域名映射到 IPv4 地址。当我把网站迁移到新服务器时，我修改的就是这个配置项。</p>
<pre><code class="hljs language-css" lang="css">example<span class="hljs-selector-class">.com</span>    <span class="hljs-selector-tag">A</span>    <span class="hljs-number">93.184</span>.<span class="hljs-number">216.34</span>
</code></pre>
<p>当有人请求 <code>example.com</code> 时，DNS 返回 <code>93.184.216.34</code>。</p>
<h3 data-id="heading-7">AAAA 记录</h3>
<p>同样的方法，只不过是针对 IPv6 地址。为什么叫这个奇怪的名字？因为 IPv6 地址的长度是 IPv4 地址的四倍，所以用了四个 A。我自己还没设置过这种地址。</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">example.com</span>    <span class="hljs-string">AAAA</span>    <span class="hljs-number">2606</span><span class="hljs-string">:2800:220:1:248:1893:25c8:1946</span>
</code></pre>
<h3 data-id="heading-8">CNAME（规范名称）</h3>
<p>这个很巧妙。它没有指向某个IP地址，而是指向另一个域名。它的意思是“去问问这个域名吧”。</p>
<pre><code class="hljs language-objectivec" lang="objectivec">www.example.com     <span class="hljs-built_in">CNAME</span>    example.com
blog.example.com    <span class="hljs-built_in">CNAME</span>    example.ghost.io
</code></pre>
<p>使用第三方服务时超级实用。我用它来将子域名指向托管服务——你的博客可以指向 Ghost，你的文档可以指向 GitBook，而无需自己管理它们的 IP 地址。</p>
<h3 data-id="heading-9">MX（邮件交换）</h3>
<p>有没有想过<code>hello@yourdomain.com</code>是如何知道该把邮件发送到哪里的？答案是MX记录。MX记录指定了你的域名邮件应该发送到哪里。优先级编号很重要——编号越小的邮件会优先发送。</p>
<pre><code class="hljs">example.com    MX    10    mail1.example.com
example.com    MX    20    mail2.example.com
</code></pre>
<p>当有人向<code>hello@example.com</code>发送电子邮件时，邮件服务器会检查MX记录以确定邮件投递地址。如果<code>mail1</code>（优先级10）出现故障，则会尝试使用<code>mail2</code>（优先级20）。</p>
<h3 data-id="heading-10">TXT 记录</h3>
<p>这个乍一看似乎没什么特别的——它只是用来存储文本。但它实际上用于一些重要的用途。</p>
<pre><code class="hljs language-arduino" lang="arduino">example.com    TXT    <span class="hljs-string">"v=spf1 include:_spf.google.com ~all"</span>
example.com    TXT    <span class="hljs-string">"google-site-verification=abc123xyz"</span>
</code></pre>
<p>我曾使用 TXT 记录来：</p>
<ul>
<li><strong>域名验证</strong>- Google、Stripe 和 AWS 会要求您添加 TXT 记录以证明您拥有该域名。</li>
<li><strong>SPF</strong> - 指定哪些服务器可以代表您发送电子邮件（防止欺骗）</li>
<li><strong>DKIM</strong> - 使用加密签名进行电子邮件身份验证</li>
<li><strong>DMARC</strong> - 处理 SPF/DKIM 检查失败的策略</li>
</ul>
<h2 data-id="heading-11">TTL（生存时间）</h2>
<p>就是这一点让我彻底懵了。还记得我那三个小时的困惑吗？我旧 A 记录的 TTL 值是 3600 秒，也就是一个小时。所有缓存了我旧 IP 地址的解析器都会保留这个值长达一个小时，然后才会再次检查。</p>
<p>TTL（生存时间）告诉解析器要缓存 DNS 解析结果多长时间。</p>
<pre><code class="hljs language-ini" lang="ini">example.com    A    93.184.216.34    <span class="hljs-attr">TTL</span>=<span class="hljs-number">3600</span>
</code></pre>
<p>这意味着：“此答案将缓存 3600 秒（1 小时）。在此之前请勿再次提问。”</p>
<p>常用 TTL 值：</p>
<ul>
<li><strong>300（5分钟）</strong> - 频繁变更，需要快速故障转移</li>
<li><strong>3600（1 小时）</strong> - 普通网站</li>
<li><strong>86400（1天）</strong> - 很少变化</li>
</ul>
<h3 data-id="heading-12">权衡取舍</h3>
<p><strong>TTL 值低</strong>= 更新速度快，但 DNS 查询次数多（首次加载速度稍慢）。</p>
<p><strong>高 TTL</strong> = 更少的 DNS 查询（更好的性能），但更改记录时传播速度较慢。</p>
<blockquote>
<p>我从惨痛的教训中学到的一个实用技巧：如果你计划迁移服务器，请提前几天将 TTL（生存时间）降低到 300。迁移后，旧的缓存记录会在 5 分钟内过期，而不是几个小时。真希望我在迁移前就知道这一点。</p>
</blockquote>
<h2 data-id="heading-13">DNS解析过程</h2>
<p>当我仔细梳理了整个过程后，一切都豁然开朗了。当你在浏览器中输入 <code>api.example.com</code> 时，实际发生的情况如下：</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-keyword">Step</span> <span class="hljs-number">1</span>: Browser cache
<span class="hljs-string">"Do I have api.example.com cached?"</span> → No
​
<span class="hljs-keyword">Step</span> <span class="hljs-number">2</span>: OS DNS cache
<span class="hljs-string">"Do I have it?"</span> → No
​
<span class="hljs-keyword">Step</span> <span class="hljs-number">3</span>: Router cache
<span class="hljs-string">"Do I have it?"</span> → No
​
<span class="hljs-keyword">Step</span> <span class="hljs-number">4</span>: ISP<span class="hljs-comment">'s DNS Resolver</span>
<span class="hljs-string">"Do I have it?"</span> → No, <span class="hljs-keyword">let</span> <span class="hljs-keyword">me</span> find out...
​
<span class="hljs-keyword">Step</span> <span class="hljs-number">5</span>: Ask Root Server
<span class="hljs-symbol">Resolver:</span> <span class="hljs-string">"Where is api.example.com?"</span>
<span class="hljs-symbol">Root:</span> <span class="hljs-string">"I don't know, but .com TLD is at 192.5.6.30"</span>
​
<span class="hljs-keyword">Step</span> <span class="hljs-number">6</span>: Ask .com TLD Server
<span class="hljs-symbol">Resolver:</span> <span class="hljs-string">"Where is api.example.com?"</span>
<span class="hljs-symbol">TLD:</span> <span class="hljs-string">"I don't know, but example.com's nameserver is at ns1.example.com"</span>
​
<span class="hljs-keyword">Step</span> <span class="hljs-number">7</span>: Ask example.com<span class="hljs-comment">'s Nameserver</span>
<span class="hljs-symbol">Resolver:</span> <span class="hljs-string">"Where is api.example.com?"</span>
<span class="hljs-symbol">NS:</span> <span class="hljs-string">"It's at 93.184.216.34"</span>
​
<span class="hljs-keyword">Step</span> <span class="hljs-number">8</span>: Response flows back
Resolver caches it (based <span class="hljs-keyword">on</span> TTL)
Returns <span class="hljs-number">93.184</span>.<span class="hljs-number">216.34</span> <span class="hljs-keyword">to</span> your browser
​
<span class="hljs-keyword">Step</span> <span class="hljs-number">9</span>: Browser connects <span class="hljs-keyword">to</span> <span class="hljs-number">93.184</span>.<span class="hljs-number">216.34</span>
</code></pre>
<p>视觉呈现：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/893f12413563422f855039b2f581eae1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rex5bqm5raM546w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771166392&amp;x-signature=nEXlFHKKcytaMoCMBle5UyMzN04%3D" alt="DNS Resolution Process diagram showing the flow from browser through caches to nameserver" loading="lazy"/></p>
<p>每个中间解析器都会根据生存时间 (TTL) 缓存结果。来自同一网络的后续请求会跳过大部分请求过程，因为解析器已经知道答案。这就是为什么第二次访问网站比第一次访问快的原因。</p>
<h2 data-id="heading-14">什么是解析器？</h2>
<p>我以前总是把域名解析器和域名服务器搞混。它们听起来很像，但功能却不一样。</p>
<p>解析器是一种 DNS 服务器，它负责为你查找 IP 地址。它通过根域名服务器 → 顶级域名服务器 → 权威域名服务器进行递归查找。</p>
<p>你的设备向解析器询问：“example.com 的 IP 地址是什么？” 解析器完成所有工作并返回：“是 93.184.216.34”。</p>
<p>常用公共解析器：</p>
<ul>
<li><code>8.8.8.8</code> - Google 公共 DNS</li>
<li><code>1.1.1.1</code> - Cloudflare（速度最快，注重隐私）</li>
<li><code>208.67.222.222</code> - OpenDNS（思科）</li>
<li><code>9.9.9.9</code> - Quad9（专注于安全，可阻止恶意软件）</li>
</ul>
<p>您可以在网络设置中更改使用的解析器。我已在我的机器上切换到 <code>1.1.1.1</code>——它明显比我的 ISP 的默认解析器快。</p>
<h2 data-id="heading-15">什么是域名服务器？</h2>
<p>域名服务器是权威（Truth）的信息来源。它实际保存着域名的 DNS 记录。注册域名时，您需要将其指向域名服务器，这些服务器存储着您的 A 记录、CNAME 记录、MX 记录等。</p>
<p>解析器和域名服务器的区别：</p>
<ul>
<li><strong>解析器</strong>- 通过向其他服务器（消息传递者）询问来查找答案</li>
<li><strong>域名服务器</strong>- 保存实际的 DNS 记录（权威（Truth）的来源）</li>
</ul>
<p>当你从Namecheap或GoDaddy购买域名时，他们会提供默认的域名服务器，例如：</p>
<pre><code class="hljs">ns1.namecheap.com
ns2.namecheap.com
</code></pre>
<p>您可以更改这些设置以使用 Cloudflare、AWS Route 53 或您自己的域名服务器：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Cloudflare nameservers</span>
ns1.cloudflare.com
ns2.cloudflare.com
​
<span class="hljs-comment"># AWS Route 53 (example)</span>
ns-1234.awsdns-56.org
ns-789.awsdns-12.co.uk
</code></pre>
<p>为什么要费劲更改域名服务器？不同的服务商提供的功能各不相同。我把域名迁移到了 Cloudflare，因为他们提供免费的 DDoS 防护、CDN 服务，而且控制面板也更好用。如果你已经在使用 AWS，那么 Route 53 是个不错的选择。</p>
<h3 data-id="heading-16">权威型与递归型</h3>
<p><strong>权威（Authoritative ）域名服务器</strong>——拥有域名的最终答案。当被问及“example.com 在哪里？”时，它会返回实际的 IP 地址，因为它保存着相关记录。</p>
<p><strong>递归解析器</strong>——不保存记录，而是通过向权威服务器查询来查找答案。你的 ISP 的 DNS 服务器和 <code>8.8.8.8</code> 都是递归解析器。</p>
<h2 data-id="heading-17">查看 DNS 缓存</h2>
<p>这些命令在我调试过程中帮了我大忙。当你需要查看实际缓存的内容时：</p>
<h3 data-id="heading-18">在浏览器中</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Chrome</span>
chrome://net-internals/<span class="hljs-comment">#dns</span>
​
<span class="hljs-comment"># Firefox</span>
about:networking<span class="hljs-comment">#dns</span>
​
<span class="hljs-comment"># Edge</span>
edge://net-internals/<span class="hljs-comment">#dns</span>
</code></pre>
<p>此处显示所有已缓存的域名及其 IP 地址和剩余 TTL。</p>
<h3 data-id="heading-19">在您的电脑上</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Windows (Command Prompt)</span>
ipconfig /displaydns
​
<span class="hljs-comment"># Mac</span>
sudo dscacheutil -cachedump
​
<span class="hljs-comment"># Linux</span>
<span class="hljs-comment"># Most distros use systemd-resolved</span>
resolvectl statistics
</code></pre>
<h3 data-id="heading-20">查询域名</h3>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># Using nslookup (Windows/Mac/Linux)</span>
nslookup example.com
​
<span class="hljs-comment"># Using dig (Mac/Linux - more detailed)</span>
dig example.com
​
<span class="hljs-comment"># Query specific record type</span>
dig example.com MX
dig example.com TXT
​
<span class="hljs-comment"># Query using a specific resolver</span>
dig @8.<span class="hljs-number">8.8</span>.<span class="hljs-number">8</span> example.com
dig @1.<span class="hljs-number">1.1</span>.<span class="hljs-number">1</span> example.com
</code></pre>
<h2 data-id="heading-21">清除 DNS 缓存</h2>
<h3 data-id="heading-22">浏览器</h3>
<p>转到<code>chrome://net-internals/#dns</code>并单击“清除主机缓存”。</p>
<h3 data-id="heading-23">操作系统</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Windows</span>
ipconfig /flushdns
​
<span class="hljs-comment"># Mac</span>
sudo dscacheutil -flushcache; sudo killall -HUP mDNSResponder
​
<span class="hljs-comment"># Linux (systemd)</span>
sudo systemd-resolve --flush-caches
</code></pre>
<p>我应该先这么做的。清除缓存会强制系统获取最新的DNS记录，而不是使用过期的缓存记录。</p>
<h2 data-id="heading-24">为什么 DNS 对系统设计至关重要</h2>
<p>DNS 的有趣之处远不止于“托管网站”。如果您正在设计大规模系统，DNS 就不仅仅是一个查询服务，而是一种工具。</p>
<h3 data-id="heading-25">负载均衡</h3>
<p>DNS 可以为同一个域名返回不同的 IP 地址。每个请求都可能被分配到不同的服务器。这被称为 DNS 轮询负载均衡。</p>
<pre><code class="hljs language-css" lang="css">example<span class="hljs-selector-class">.com</span>    <span class="hljs-selector-tag">A</span>    <span class="hljs-number">93.184</span>.<span class="hljs-number">216.34</span>
example<span class="hljs-selector-class">.com</span>    <span class="hljs-selector-tag">A</span>    <span class="hljs-number">93.184</span>.<span class="hljs-number">216.35</span>
example<span class="hljs-selector-class">.com</span>    <span class="hljs-selector-tag">A</span>    <span class="hljs-number">93.184</span>.<span class="hljs-number">216.36</span>
</code></pre>
<h3 data-id="heading-26">故障转移</h3>
<p>如果一台服务器发生故障，DNS 服务将停止返回其 IP 地址。健康检查会检测到此故障，DNS 记录将被更新，流量将转移到正常运行的服务器。</p>
<h3 data-id="heading-27">地理路由</h3>
<p>返回距离用户最近的服务器的 IP 地址。欧洲用户将获得欧洲服务器的 IP 地址，亚洲用户将获得亚洲服务器的 IP 地址。这称为地理域名系统 (GeoDNS) 或基于延迟的路由。</p>
<h3 data-id="heading-28">缓存的权衡取舍</h3>
<p>DNS 缓存可以减少查询时间和 DNS 服务器的负载，但会导致无法即时更新。例如，如果更改 IP 地址且 TTL 设置为 24 小时，则部分用户在长达 24 小时内仍会访问旧 IP 地址。</p>
<h2 data-id="heading-29">快速参考</h2>
<pre><code class="hljs language-css" lang="css">┌─────────────┬────────────────────────────────────────┐
│ Term        │ What it does                           │
├─────────────┼────────────────────────────────────────┤
│ Root        │ <span class="hljs-attribute">Top</span> of DNS tree, knows TLD locations   │
│ TLD         │ <span class="hljs-selector-class">.com</span>, <span class="hljs-selector-class">.org</span>, <span class="hljs-selector-class">.io</span> - knows domains under  │
│ Domain      │ What you buy (example, google)         │
│ Subdomain   │ What you create free (api, www, mail)  │
├─────────────┼────────────────────────────────────────┤
│ <span class="hljs-selector-tag">A</span> Record    │ Domain → IPv4 <span class="hljs-selector-tag">address</span>                  │
│ AAAA Record │ Domain → IPv6 <span class="hljs-selector-tag">address</span>                  │
│ CNAME       │ Domain → Another domain (alias)        │
│ MX          │ Where <span class="hljs-selector-tag">to</span> send email                    │
│ TXT         │ Verification, SPF, DKIM, DMARC         │
├─────────────┼────────────────────────────────────────┤
│ TTL         │ Cache duration in seconds              │
│ Resolver    │ Server that finds IPs for you          │
└─────────────┴────────────────────────────────────────┘
</code></pre>
<p>DNS 解析导致我的网站瘫痪了三个小时。不过现在我终于明白了——不仅是它的作用，还有它的工作原理。下次再遇到解析失败的问题，我就知道该从哪里入手了。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bhusalmanish.com.np%2Fblog%2Fposts%2Fdns-explained.html" target="_blank" title="https://www.bhusalmanish.com.np/blog/posts/dns-explained.html" ref="nofollow noopener noreferrer">www.bhusalmanish.com.np/blog/posts/…</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FG8oAelYq-GBzsu3wnt4tLA" target="_blank" title="https://mp.weixin.qq.com/s/G8oAelYq-GBzsu3wnt4tLA" ref="nofollow noopener noreferrer">mp.weixin.qq.com/s/G8oAelYq-…</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[为什么我不在 Android ViewModel 中直接处理异常？]]></title>    <link>https://juejin.cn/post/7603994823326547978</link>    <guid>https://juejin.cn/post/7603994823326547978</guid>    <pubDate>2026-02-09T00:05:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603994823326547978" data-draft-id="7600706866785386539" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="为什么我不在 Android ViewModel 中直接处理异常？"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-02-09T00:05:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="潜龙勿用之化骨龙"/> <meta itemprop="url" content="https://juejin.cn/user/2313028195058471"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            为什么我不在 Android ViewModel 中直接处理异常？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2313028195058471/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    潜龙勿用之化骨龙
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-09T00:05:08.000Z" title="Mon Feb 09 2026 00:05:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ViewModel 应该不要处理异常？
更准确地说：<strong>ViewModel 不应该处理异常，它只需要“消费结果”。</strong></p>
<p>本文结合实际项目中的常见做法，说明一种更清晰的职责划分：
<strong>UseCase / Repository 负责处理异常，ViewModel 只关注数据与 UI 状态。</strong></p>
<blockquote>
<p>⚠️ 说明：本文中的异常模型是<strong>刻意简化的</strong>。
重点不在“异常如何分类”，而在于：
<strong>只要异常已经在下层被处理并转换成结果，ViewModel 就不应该再关心异常本身。</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-0">1. 背景：异常到底该谁来处理？</h2>
<p>一个典型的 clean 分层大致如下：</p>
<ul>
<li><strong>UI 层（Activity / Fragment / Compose）</strong></li>
<li><strong>ViewModel</strong></li>
<li><strong>Domain 层（UseCase）</strong></li>
<li><strong>Data 层（Repository / DataSource / 网络、数据库等）</strong></li>
</ul>
<p>常见的疑问是：</p>
<blockquote>
<p>ViewModel 拿到 UseCase 或 Repository 的数据，这些底层已经做了异常处理，那 ViewModel 还要再 try/catch 吗？</p>
</blockquote>
<p>我的结论是：</p>
<blockquote>
<p><strong>如果 UseCase / Repository 已经把异常转换成稳定的数据结果，ViewModel 完全可以只关心“结果”，而不直接处理异常对象。</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-1">2. 分层职责：谁应该干什么？</h2>
<h3 data-id="heading-2">2.1 Data / Domain 层（UseCase / Repository）</h3>
<p><strong>核心职责：</strong></p>
<ul>
<li>捕获所有底层异常（网络、IO、数据库、第三方 SDK 等）</li>
<li>在内部记录日志、上报监控、决定是否重试</li>
<li>将异常统一转换为一个<strong>稳定、简单、可被上层消费的结果</strong></li>
</ul>
<p>为了突出 ViewModel 的职责边界，这里使用一个<strong>极简的结果模型</strong>：</p>
<p>一个简单的 Repository 实现示例如下：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ac46a7b59a394f4a874b620852f6553e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200308&amp;x-signature=BBe2hHs%2Fh%2BsklTR5W3XaFVAk7po%3D" alt="image.png" loading="lazy"/>
这里已经完成了所有异常相关的工作：</p>
<ul>
<li>捕获异常</li>
<li>屏蔽底层实现细节（网络库、异常类型）</li>
<li>向上层只暴露一个“成功 / 失败”的结果</li>
</ul>
<hr/>
<h3 data-id="heading-3">2.2 ViewModel 层</h3>
<p><strong>核心职责：</strong></p>
<ul>
<li>调用 UseCase / Repository</li>
<li>根据返回的结果更新 UI 状态（loading / content / error）</li>
<li><strong>只处理结果分支，而不是异常本身</strong></li>
</ul>
<p>示例代码如下：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1afa9a08dd804cd5b012675fafe7c343~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200308&amp;x-signature=AU90wzpFYoNL4ePoXBnodcm9%2FAY%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e3d90db48573449da53e44a7c19ef3b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200308&amp;x-signature=cGO8CZXhVXirD%2B48%2BpZ9e6FI0VM%3D" alt="image.png" loading="lazy"/></p>
<p>可以看到：</p>
<ul>
<li>ViewModel <strong>完全没有 <code>try/catch</code></strong></li>
<li>不知道发生了什么异常</li>
<li>只知道“成功”或“失败”</li>
<li>只关心当前应该呈现怎样的 UI 状态</li>
</ul>
<hr/>
<h2 data-id="heading-4">3. 为什么不建议在 ViewModel 处理异常？</h2>
<h3 data-id="heading-5">3.1 破坏分层，增加耦合</h3>
<p>如果在 ViewModel 中写这种代码：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b4b2ee154c66492792019efd69440727~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200308&amp;x-signature=AMH5DfqBjxamwL51X3SjWWQ8v2o%3D" alt="image.png" loading="lazy"/></p>
<p>那么：</p>
<ul>
<li>ViewModel 将直接依赖底层实现</li>
<li>网络库、数据源一旦更换，ViewModel 就需要修改</li>
<li>异常处理逻辑分散在多个 ViewModel 中，难以复用</li>
</ul>
<p>而这些本应是 Repository / UseCase 的职责。</p>
<h3 data-id="heading-6">3.2 错误处理难以统一</h3>
<p>当多个 ViewModel 各自处理异常时，往往会出现：</p>
<ul>
<li>相同错误在不同页面展示方式不一致</li>
<li>重复的异常处理逻辑到处复制</li>
<li>想统一策略（例如：失败统一提示）成本极高</li>
</ul>
<p>将异常处理集中在 UseCase / Repository，可以保证：</p>
<ul>
<li>策略统一</li>
<li>行为可控</li>
<li>上层逻辑极度简单</li>
</ul>
<hr/>
<h2 data-id="heading-7">4. 建议的整体模式（总结）</h2>
<p>可以用一句话概括：</p>
<blockquote>
<p><strong>UseCase / Repository 负责“把异常变成结果”；
ViewModel 负责“把结果变成 UI 状态”。</strong></p>
</blockquote>
<h3 data-id="heading-8">UseCase / Repository：</h3>
<ul>
<li>
<p>捕获所有外部系统异常</p>
</li>
<li>
<p>处理日志、监控、重试等技术细节</p>
</li>
<li>
<p>将结果统一转换为：</p>
<ul>
<li><code>Success(data)</code></li>
<li><code>Error</code></li>
</ul>
</li>
</ul>
<h3 data-id="heading-9">ViewModel：</h3>
<ul>
<li>不接触任何异常对象</li>
<li>不做异常分类</li>
<li>只根据结果更新 UI</li>
</ul>
<hr/>
<h2 data-id="heading-10">5. 结语</h2>
<p>只要异常已经在 UseCase / Repository 层被处理并转换成结果：</p>
<ul>
<li><strong>ViewModel 就不应该再关心异常本身</strong></li>
<li>它的世界里只剩下：成功或失败</li>
</ul>
<p>这样的设计带来的好处是：</p>
<ul>
<li>分层清晰，职责单一</li>
<li>ViewModel 更容易测试</li>
<li>代码更稳定、更容易维护</li>
</ul>
<p>如果你现在的项目中，ViewModel 里还有大量 <code>try/catch</code>，可以从一两个接口开始，先把异常下移到 UseCase / Repository，逐步过渡到<strong>ViewModel 只消费结果</strong>的模式。</p>
<p>示例:🔗 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FThirdPrince%2FCleanArc" target="_blank" title="https://github.com/ThirdPrince/CleanArc" ref="nofollow noopener noreferrer">github.com/yourname/Cl…</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[稳定好用的 ADSL 拨号代理，就这家了！]]></title>    <link>https://juejin.cn/post/7603895839556862015</link>    <guid>https://juejin.cn/post/7603895839556862015</guid>    <pubDate>2026-02-09T00:05:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603895839556862015" data-draft-id="7603783314713460772" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="稳定好用的 ADSL 拨号代理，就这家了！"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-02-09T00:05:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="崔庆才丨静觅"/> <meta itemprop="url" content="https://juejin.cn/user/1521379821230269"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            稳定好用的 ADSL 拨号代理，就这家了！
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1521379821230269/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    崔庆才丨静觅
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-09T00:05:48.000Z" title="Mon Feb 09 2026 00:05:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读23分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>本文档主要介绍 ADSL Proxy API 操作的使用流程，利用它我们可以轻松提取 ADSL 的 IP 并且对 ADSL Proxy 添加 IP 白名单。</p>
<h2 data-id="heading-0">申请流程</h2>
<p>要使用提取 ADSL 的 IP 和对 ADSL Proxy 添加 IP 白名单，首先可以到 <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.acedata.cloud%2Fdocuments%2Fd8426c17-d22c-449a-b6bf-0a7790928e4d%3Finviter_id%3Db87f67c1-b04f-4332-99a1-7a5e651331c6%3Finviter_id%3Db87f67c1-b04f-4332-99a1-7a5e651331c6" target="_blank" title="https://platform.acedata.cloud/documents/d8426c17-d22c-449a-b6bf-0a7790928e4d?inviter_id=b87f67c1-b04f-4332-99a1-7a5e651331c6?inviter_id=b87f67c1-b04f-4332-99a1-7a5e651331c6" ref="nofollow noopener noreferrer">ADSL Proxy Extract API</a> 和 <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.acedata.cloud%2Fdocuments%2Fc21534fe-1f62-424b-9b10-a805cb473dd1%3Finviter_id%3Db87f67c1-b04f-4332-99a1-7a5e651331c6" target="_blank" title="https://platform.acedata.cloud/documents/c21534fe-1f62-424b-9b10-a805cb473dd1?inviter_id=b87f67c1-b04f-4332-99a1-7a5e651331c6" ref="nofollow noopener noreferrer">ADSL Proxy Whitelist API</a> 页面点击「Acquire」按钮，获取请求所需要的凭证：</p>
<p><img src="https://cdn.acedata.cloud/nyq0xz.png" alt="" loading="lazy"/></p>
<p>如果你尚未登录或注册，会自动跳转到登录页面邀请您来注册和登录，登录注册之后会自动返回当前页面。</p>
<p>在首次申请时会有免费额度赠送，可以免费使用该 API。</p>
<h2 data-id="heading-1">提取 ADSL 的 IP</h2>
<p>接下来就可以在界面 <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.acedata.cloud%2Fdocuments%2Fd8426c17-d22c-449a-b6bf-0a7790928e4d%3Finviter_id%3Db87f67c1-b04f-4332-99a1-7a5e651331c6%3Finviter_id%3Db87f67c1-b04f-4332-99a1-7a5e651331c6" target="_blank" title="https://platform.acedata.cloud/documents/d8426c17-d22c-449a-b6bf-0a7790928e4d?inviter_id=b87f67c1-b04f-4332-99a1-7a5e651331c6?inviter_id=b87f67c1-b04f-4332-99a1-7a5e651331c6" ref="nofollow noopener noreferrer">ADSL Proxy Extract API</a> 上填写对应的内容，接下来演示如何提取 ADSL 的 IP。</p>
<h3 data-id="heading-2">设置请求头和请求体</h3>
<p><strong>Request Headers</strong> 包括：</p>
<ul>
<li><code>accept</code>：指定接收 JSON 格式的响应结果，这里填写为 <code>application/json</code>。</li>
<li><code>authorization</code>：调用 API 的密钥，申请之后可以直接下拉选择。</li>
</ul>
<p><strong>Request Body</strong> 包括：</p>
<ul>
<li><code>number</code>：提取的 ADSL 的 IP 数量，默认为 1。</li>
<li><code>type</code>：提取的 ADSL 的 IP 类型，主要分为 <code>http</code> 和 <code>socks</code>，默认为 <code>http</code> 。</li>
<li><code>province</code>：提取 IP 的所在省份，默认是随机的。</li>
<li><code>city</code>：提取 IP 的所在城市，默认是随机的。</li>
</ul>
<p>对于参数 <code>province</code> 和 <code>city</code> 的设定，它是有要求的，它必须是对应的，比如<code>city</code> ：南昌必须对应 <code>province</code> ：江西，需要与省份对应起来，具体的规则如下：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"北京"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"北京"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">0</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"天津"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"天津"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"上海"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"上海"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"重庆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"重庆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黑龙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"大兴安岭地区"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">7</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黑龙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黑河"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">8</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黑龙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"齐齐哈尔"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黑龙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"绥化"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黑龙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"鹤岗"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">11</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黑龙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"佳木斯"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黑龙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"伊春"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黑龙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"双鸭山"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">14</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黑龙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"哈尔滨"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黑龙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"鸡西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">16</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黑龙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"大庆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黑龙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"七台河"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">19</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黑龙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"牡丹江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">20</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"吉林"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"辽源"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">22</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"吉林"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"通化"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">23</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"吉林"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"白城"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"吉林"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"松原"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">25</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"吉林"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"长春"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">26</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"吉林"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"吉林市"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">27</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"吉林"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"延边朝鲜族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">29</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"吉林"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"白山"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">31</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"吉林"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四平"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">32</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"辽宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"葫芦岛"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">33</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"辽宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"盘锦"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">34</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"辽宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"辽阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">35</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"辽宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"铁岭"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">36</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"辽宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"阜新"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">37</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"辽宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"朝阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">38</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"辽宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"锦州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">39</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"辽宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"鞍山"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">40</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"辽宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"沈阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">41</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"辽宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"本溪"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">42</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"辽宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"抚顺"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">43</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"辽宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"营口"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">44</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"辽宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"丹东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">45</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"辽宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"大连"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">47</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"内蒙古"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"呼伦贝尔"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">7</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">48</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"内蒙古"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"兴安盟"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">7</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">49</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"内蒙古"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"锡林郭勒盟"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">7</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">50</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"内蒙古"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"巴彦淖尔"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">7</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">51</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"内蒙古"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"包头"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">7</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">52</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"内蒙古"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"呼和浩特"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">7</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">53</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"内蒙古"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"通辽"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">7</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">55</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"内蒙古"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"赤峰"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">7</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">56</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"内蒙古"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"乌海"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">7</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">57</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"内蒙古"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"鄂尔多斯"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">7</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">58</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"内蒙古"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"乌兰察布"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">7</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">59</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"宁夏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"石嘴山"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">8</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">60</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"宁夏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"银川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">8</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">61</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"宁夏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"吴忠"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">8</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">62</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"宁夏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"固原"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">8</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">63</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"甘肃"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"张掖"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">64</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"甘肃"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"金昌"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">65</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"甘肃"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"武威"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">66</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"甘肃"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"兰州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">67</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"甘肃"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"白银"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">68</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"甘肃"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"定西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">69</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"甘肃"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"平凉"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">70</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"甘肃"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"庆阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">71</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"甘肃"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"甘南藏族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">72</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"甘肃"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"临夏回族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">73</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"甘肃"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"天水"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">74</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"甘肃"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"嘉峪关"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">75</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"甘肃"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"酒泉"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">76</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"甘肃"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"陇南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">77</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"昌吉回族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">78</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"克孜勒苏柯尔克孜自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">79</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"伊犁哈萨克自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">80</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"阿拉尔"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">81</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"克拉玛依"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">82</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"博尔塔拉蒙古自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">83</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"乌鲁木齐"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">84</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"吐鲁番"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">85</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"阿克苏地区"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">86</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"石河子"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">87</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"喀什地区"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">88</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"和田地区"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">89</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"哈密"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">90</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"陕西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"榆林"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">11</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">92</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"陕西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"延安"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">11</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">93</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"陕西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"咸阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">11</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">94</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"陕西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"西安"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">11</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">95</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"陕西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"渭南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">11</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">96</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"陕西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"汉中"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">11</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">97</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"陕西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"商洛"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">11</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">98</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"陕西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安康"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">11</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">99</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"陕西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"铜川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">11</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">100</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"陕西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"宝鸡"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">11</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">101</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"长治"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">102</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"晋中"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">103</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"朔州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">104</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"大同"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">105</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"吕梁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">106</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"忻州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">107</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"太原"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">108</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"阳泉"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">109</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"临汾"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">110</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"运城"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">111</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"晋城"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">112</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"德州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">114</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"滨州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">115</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"烟台"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">116</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"聊城"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">117</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"济南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">118</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"泰安"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">119</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"淄博"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">120</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"潍坊"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">121</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"青岛"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">122</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"济宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">123</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"日照"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">124</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"枣庄"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">126</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"东营"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">127</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"威海"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">128</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"莱芜"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">129</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"临沂"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">130</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"菏泽"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">13</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">131</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"邯郸"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">14</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">132</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"衡水"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">14</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">133</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"石家庄"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">14</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">134</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"邢台"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">14</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">135</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"张家口"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">14</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">136</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"承德"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">14</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">137</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"秦皇岛"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">14</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">138</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"廊坊"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">14</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">139</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"唐山"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">14</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">140</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"保定"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">14</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">141</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"沧州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">14</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">142</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">143</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"三门峡"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">144</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"郑州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">145</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"南阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">146</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"周口"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">147</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"驻马店"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">148</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"信阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">149</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"开封"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">150</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"洛阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">151</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"平顶山"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">152</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"焦作"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">153</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"鹤壁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">154</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新乡"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">155</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"濮阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">156</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"许昌"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">157</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"漯河"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">158</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"商丘"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">159</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"济源"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">160</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"西藏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"那曲"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">16</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">161</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"西藏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"日喀则"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">16</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">162</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"西藏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"拉萨"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">16</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">163</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"西藏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"山南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">16</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">164</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"西藏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"阿里地区"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">16</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">165</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"西藏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"昌都"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">16</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">166</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"西藏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"林芝"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">16</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">167</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"云南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"昭通"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">17</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">168</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"云南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"丽江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">17</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">169</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"云南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"曲靖"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">17</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">170</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"云南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"保山"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">17</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">171</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"云南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"大理白族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">17</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">172</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"云南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"楚雄彝族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">17</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">173</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"云南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"昆明"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">17</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">174</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"云南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"玉溪"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">17</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">176</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"云南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"临沧"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">17</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">177</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"云南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"普洱"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">17</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">178</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"云南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"红河哈尼族彝族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">17</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">179</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"云南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"文山壮族苗族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">17</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">180</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"云南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"西双版纳傣族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">17</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">181</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"云南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"德宏傣族景颇族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">17</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">182</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"云南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"怒江傈僳族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">17</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">183</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"云南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"迪庆藏族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">17</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">184</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"甘孜藏族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">185</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"阿坝藏族羌族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">186</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"凉山彝族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">187</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"成都"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">188</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"绵阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">189</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"雅安"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">190</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"乐山"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">192</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"宜宾"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">193</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"巴中"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">194</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"达州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">195</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"遂宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">196</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"南充"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">197</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"泸州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">198</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"自贡"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">199</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"攀枝花"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">200</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"德阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">201</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广元"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">202</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"内江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">203</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广安"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">204</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"眉山"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">205</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"四川"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"资阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">206</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"贵州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"毕节"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">19</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">207</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"贵州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"遵义"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">19</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">208</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"贵州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"铜仁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">19</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">209</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"贵州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安顺"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">19</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">210</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"贵州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"贵阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">19</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">211</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"贵州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黔西南布依族苗族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">19</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">212</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"贵州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"六盘水"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">19</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">213</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"桂林"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">214</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河池"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">215</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"柳州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">216</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"百色"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">217</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"贵港"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">218</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"梧州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">219</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"南宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">220</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"钦州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">221</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"崇左"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">222</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"北海"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">223</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"防城港"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">224</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"玉林"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">225</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"贺州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">226</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"来宾"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">227</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"韶关"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">229</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"清远"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">230</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"梅州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">231</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"肇庆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">232</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">233</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"惠州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">234</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"河源"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">235</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"汕头"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">236</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"深圳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">237</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"汕尾"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">238</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湛江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">239</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"阳江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">240</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"茂名"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">241</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"珠海"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">246</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"佛山"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">247</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江门"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">248</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"东莞"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">249</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"中山"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">250</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"潮州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">251</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"揭阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">252</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"广东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"云浮"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">21</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">253</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"福建"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"莆田"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">22</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">254</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"福建"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"南平"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">22</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">256</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"福建"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"宁德"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">22</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">257</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"福建"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"福州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">22</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">258</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"福建"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"龙岩"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">22</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">259</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"福建"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"三明"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">22</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">260</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"福建"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"泉州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">22</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">261</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"福建"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"漳州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">22</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">262</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"福建"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"厦门"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">22</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">263</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"张家界"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">23</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">264</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"岳阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">23</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">265</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"怀化"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">23</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">266</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"长沙"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">23</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">267</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"邵阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">23</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">268</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"益阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">23</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">269</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"郴州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">23</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">270</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"株洲"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">23</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">274</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湘潭"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">23</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">275</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"衡阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">23</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">276</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"娄底"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">23</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">277</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"常德"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">23</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">278</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"荆门"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">280</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"荆州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">281</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黄冈"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">282</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"恩施土家族苗族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">283</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"武汉"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">284</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黄石"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">285</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"鄂州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">286</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"孝感"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">287</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"咸宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">288</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"随州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">289</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"仙桃"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">290</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"天门"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">291</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"潜江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">292</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"神农架林区"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">293</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"萍乡"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">25</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">298</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新余"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">25</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">299</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"宜春"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">25</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">300</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"赣州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">25</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">301</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"九江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">25</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">302</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"景德镇"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">25</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">303</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"南昌"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">25</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">304</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"鹰潭"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">25</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">305</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"上饶"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">25</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">306</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"抚州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">25</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">307</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"浙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">26</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">308</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"浙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"舟山"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">26</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">314</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"浙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"杭州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">26</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">315</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"浙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"嘉兴"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">26</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">316</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"浙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"金华"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">26</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">318</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"浙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"绍兴"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">26</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">319</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"浙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"宁波"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">26</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">320</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"浙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"衢州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">26</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">321</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"浙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"丽水"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">26</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">322</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"浙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"台州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">26</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">323</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"浙江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"温州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">26</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">324</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江苏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"无锡"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">27</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">325</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江苏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"苏州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">27</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">326</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江苏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"镇江"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">27</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">331</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江苏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"泰州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">27</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">332</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江苏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"宿迁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">27</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">333</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江苏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"徐州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">27</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">334</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江苏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"连云港"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">27</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">335</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江苏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"淮安"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">27</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">336</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江苏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"南京"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">27</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">337</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江苏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"扬州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">27</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">338</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江苏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"盐城"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">27</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">339</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江苏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"南通"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">27</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">340</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江苏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"常州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">27</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">341</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安徽"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"淮南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">28</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">342</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安徽"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"马鞍山"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">28</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">343</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安徽"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"淮北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">28</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">344</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安徽"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"铜陵"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">28</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">345</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安徽"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"滁州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">28</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">346</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安徽"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"池州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">28</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">348</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安徽"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"宣城"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">28</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">349</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安徽"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"亳州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">28</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">350</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安徽"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"宿州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">28</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">351</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安徽"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"阜阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">28</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">352</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安徽"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"六安"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">28</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">353</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安徽"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"蚌埠"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">28</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">354</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安徽"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"合肥"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">28</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">355</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安徽"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"芜湖"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">28</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">356</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安徽"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安庆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">28</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">357</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"安徽"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黄山"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">28</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">358</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"青海"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海北藏族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">29</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">359</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"青海"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南藏族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">29</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">360</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"青海"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"西宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">29</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">361</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"青海"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"玉树藏族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">29</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">362</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"青海"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黄南藏族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">29</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">363</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"青海"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"果洛藏族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">29</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">364</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"青海"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海西蒙古族藏族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">29</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">365</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"青海"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海东"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">29</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">366</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海口"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">367</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"三亚"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">368</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"内蒙古"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"阿拉善盟"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">7</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">389</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"宁夏"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"中卫"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">8</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">393</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"塔城地区"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">397</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"阿勒泰地区"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">398</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"贵州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黔南布依族苗族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">19</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">407</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"贵州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"黔东南苗族侗族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">19</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">408</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"永州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">23</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">410</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湘西土家族苗族自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">23</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">411</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"宜昌"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">412</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"襄阳"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">413</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"湖北"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"十堰"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">24</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">414</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"江西"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"吉安"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">25</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">416</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"巴音郭楞蒙古自治州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">419</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"内蒙古"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"乌兰浩特"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">7</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">433</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"五家渠"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">458</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"文昌"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">460</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"昌江黎族自治县"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">461</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"乐东黎族自治县"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">462</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"儋州"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">463</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"万宁"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">464</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"陵水黎族自治县"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">465</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"定安县"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">466</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"东方"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">467</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"澄迈县"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">468</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"北屯"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">469</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"琼中黎族苗族自治县"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">470</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"保亭黎族苗族自治县"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">471</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"屯昌县"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">472</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"双河"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">473</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"新疆"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"图木舒克"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">474</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"琼海"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">475</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"五指山"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">476</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"临高县"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">477</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"海南"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"白沙黎族自治县"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"pId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"cId"</span><span class="hljs-punctuation">:</span><span class="hljs-number">478</span><span class="hljs-punctuation">}</span>
</code></pre>
<p>因此根据以上规则我们需要设置正确的 <code>province</code> 和 <code>city</code>，尽量选中江浙地区，因为这些地区的 IP 会多一些，具体的参数设置如下图所示：</p>
<p><img src="https://cdn.acedata.cloud/g8remv.png" width="500" class="m-auto" loading="lazy"/></p>
<h3 data-id="heading-3">代码示例</h3>
<p>可以发现，在页面右侧已经自动生成了各种语言的代码，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/e2rmr0.png" width="500" class="m-auto" loading="lazy"/></p>
<p>部分代码示例如下：</p>
<h4 data-id="heading-4">CURL</h4>
<pre><code class="hljs language-bash" lang="bash">curl -X POST <span class="hljs-string">'https://api.acedata.cloud/adsl/extract'</span> \
-H <span class="hljs-string">'accept: application/json'</span> \
-H <span class="hljs-string">'authorization: Bearer {token}'</span> \
-H <span class="hljs-string">'content-type: application/json'</span> \
-d <span class="hljs-string">'{
  "province": "浙江",
  "city": "温州"
}'</span>
</code></pre>
<h4 data-id="heading-5">Python</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests

url = <span class="hljs-string">"https://api.acedata.cloud/adsl/extract"</span>

headers = {
    <span class="hljs-string">"accept"</span>: <span class="hljs-string">"application/json"</span>,
    <span class="hljs-string">"authorization"</span>: <span class="hljs-string">"Bearer {token}"</span>,
    <span class="hljs-string">"content-type"</span>: <span class="hljs-string">"application/json"</span>
}

payload = {
    <span class="hljs-string">"province"</span>: <span class="hljs-string">"浙江"</span>,
    <span class="hljs-string">"city"</span>: <span class="hljs-string">"温州"</span>
}

response = requests.post(url, json=payload, headers=headers)
<span class="hljs-built_in">print</span>(response.text)
</code></pre>
<h3 data-id="heading-6">响应示例</h3>
<p>请求成功后，API 将返回换脸后端图片结果信息。例如：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"ip"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"115.219.4.171"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"port"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">23456</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"proxy"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"115.219.4.171:23456"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"outbound_ip"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"115.219.4.171"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"浙江"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"温州"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"expire_at"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1721877364.588</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"dialed_at"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1721876984.588</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"406465b0-f086-4a12-87a7-cdf05a3930a1"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>可以看到，结果中有一个 <code>data</code> 字段，里面包含了此处提取 IP 任务的详细，其它信息如下图所示：</p>
<ul>
<li><code>success </code>，此处提取 ADSL 的 IP 任务的结果状态。</li>
<li><code>data</code>，提取后的 ADSL 的 IP 详细信息。</li>
</ul>
<p>从 <code>data</code> 中可以明显看到这个 IP 的详细信息，主要信息中 <code>ip</code> 表示此次提取到的 IP 地址，其它信息如下：</p>
<ul>
<li><code>ip</code>，此处提取 ADSL 的 IP 地址。</li>
<li><code>port</code>，此处提取 ADSL 的 IP 端口信息。</li>
<li><code>proxy</code>，提取后的 ADSL 的 IP 代理的完整信息。</li>
<li><code>province</code>，提取后的 ADSL 的 IP 所在省份。</li>
<li><code>city</code>，提取后的 ADSL 的 IP 所在城市。</li>
</ul>
<p>可以看到我们可以轻松使用上面 <code>proxy</code> 来进行下一步 IP 代理工作。</p>
<p>首先在使用 IP 代理之前我们需要将自己的网络 IP 地址（获取本地网络 IP 方法请自行查找）添加到下文的白名单之中，接下来讲一下 IP 代理如何使用：</p>
<h3 data-id="heading-7">使用代理</h3>
<blockquote>
<p>注意：使用提取到的代理 IP 之前，请务必添加 IP 白名单，否则无法使用，关于添加白名单的说明请参考下文内容。</p>
</blockquote>
<p>Curl 示例代码：</p>
<pre><code class="hljs language-shell" lang="shell">curl -x 115.219.4.171:23456 myip.vpsnb.net # http proxy
curl --socks5 115.219.3.54:23457 myip.vpsnb.net # socks proxy
</code></pre>
<p>Python 示例代理：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> socks
<span class="hljs-keyword">import</span> socket
<span class="hljs-keyword">import</span> time

<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_http_proxy</span>(<span class="hljs-params">proxy</span>):
    <span class="hljs-keyword">try</span>:
        start_time = time.time()
        response = requests.get(
            <span class="hljs-string">'http://httpbin.org/ip'</span>, proxies={<span class="hljs-string">'http'</span>: proxy, <span class="hljs-string">'https'</span>: proxy}, timeout=<span class="hljs-number">100</span>)
        elapsed_time = time.time() - start_time
        <span class="hljs-built_in">print</span>(response)
        <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"HTTP Proxy <span class="hljs-subst">{proxy}</span> success. time: <span class="hljs-subst">{elapsed_time:<span class="hljs-number">.2</span>f}</span> s"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"IP: <span class="hljs-subst">{response.json()[<span class="hljs-string">'origin'</span>]}</span>"</span>)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"HTTP Proxy <span class="hljs-subst">{proxy}</span> failed. code: <span class="hljs-subst">{response.status_code}</span>"</span>)
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"HTTP Proxy <span class="hljs-subst">{proxy}</span> failed: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_socks_proxy</span>(<span class="hljs-params">proxy</span>):
    proxy_parts = proxy.split(<span class="hljs-string">':'</span>)
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(proxy_parts) != <span class="hljs-number">2</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"SOCKS failed: <span class="hljs-subst">{proxy}</span>"</span>)
        <span class="hljs-keyword">return</span>

    host, port = proxy_parts
    port = <span class="hljs-built_in">int</span>(port)

    <span class="hljs-keyword">try</span>:
        start_time = time.time()
        socks.set_default_proxy(socks.SOCKS5, host, port)
        socket.socket = socks.socksocket
        response = requests.get(<span class="hljs-string">'http://httpbin.org/ip'</span>, timeout=<span class="hljs-number">10</span>)
        elapsed_time = time.time() - start_time

        <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"SOCKS Proxy <span class="hljs-subst">{proxy}</span> success. time: <span class="hljs-subst">{elapsed_time:<span class="hljs-number">.2</span>f}</span> s"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"IP: <span class="hljs-subst">{response.json()[<span class="hljs-string">'origin'</span>]}</span>"</span>)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"SOCKS Proxy <span class="hljs-subst">{proxy}</span> failed. code: <span class="hljs-subst">{response.status_code}</span>"</span>)
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"SOCKS Proxy <span class="hljs-subst">{proxy}</span> failed: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>)
    <span class="hljs-keyword">finally</span>:
        socks.set_default_proxy()
        socket.socket = socket.socket

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-comment"># HTTP Proxy</span>
    http_proxy = <span class="hljs-string">"http://115.219.4.171:23456"</span>
    test_http_proxy(http_proxy)

    <span class="hljs-comment"># SOCKS Proxy</span>
    socks_proxy = <span class="hljs-string">"115.219.3.54:23457"</span>
    test_socks_proxy(socks_proxy)

</code></pre>
<h3 data-id="heading-8">响应示例</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"ip"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"115.219.4.171"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"country"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"中国"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"area"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"浙江省"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"温州市"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"isp"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"电信"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"timestamp"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1721877261</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>从上面结果可知，获得的结果与提取时的地区信息是一致的，表示该 ADSL IP 代理是成功有效的。</p>
<h2 data-id="heading-9">ADSL 代理类型 <code>type</code></h2>
<p>我们还可以设置 ADSL 的 IP 代理类型，主要分为俩种，第一种是 <code>http</code>，另一种是 <code>socks</code>，因为第一种是默认使用的，接下来我们以第二种为示例，我们可以进行下面的设置。</p>
<p>下面设置 IP 代理的类型为 <code>socks</code> ，具体设置如下图：</p>
<p><img src="https://cdn.acedata.cloud/h3xlwj.png" width="500" class="m-auto" loading="lazy"/></p>
<p>同时您可以注意到右侧有对应的调用代码生成，您可以复制代码直接运行，也可以直接点击「Try」按钮进行测试。</p>
<p><img src="https://cdn.acedata.cloud/7w0d5h.png" width="500" class="m-auto" loading="lazy"/></p>
<p>Python 样例调用代码：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests

url = <span class="hljs-string">"https://api.acedata.cloud/adsl/extract"</span>

headers = {
    <span class="hljs-string">"accept"</span>: <span class="hljs-string">"application/json"</span>,
    <span class="hljs-string">"authorization"</span>: <span class="hljs-string">"Bearer {token}"</span>,
    <span class="hljs-string">"content-type"</span>: <span class="hljs-string">"application/json"</span>
}

payload = {
    <span class="hljs-string">"province"</span>: <span class="hljs-string">"浙江"</span>,
    <span class="hljs-string">"city"</span>: <span class="hljs-string">"温州"</span>,
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"socks"</span>
}

response = requests.post(url, json=payload, headers=headers)
<span class="hljs-built_in">print</span>(response.text)
</code></pre>
<p>调用之后，我们发现返回结果如下：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"ip"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"115.222.155.148"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"port"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">23457</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"proxy"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"115.222.155.148:23457"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"outbound_ip"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"115.222.155.148"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"浙江"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"温州"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"expire_at"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1721808226.561</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"dialed_at"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1721807846.561</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"27d06ff5-20e9-4476-bdda-9e72a54ac0d4"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>返回的结果与上文的内容一致，可以看到此时提取到的 ADSL 的 IP 代理类型是 <code>socks</code> ，因此在后续的工作需要根据代理的类型来进行使用 IP 代理服务。</p>
<h2 data-id="heading-10">添加 IP 白名单</h2>
<p>接下来就可以在界面上填写对应的内容，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/wz4obo.png" width="500" class="m-auto" loading="lazy"/></p>
<p>在第一次使用该接口时，我们至少需要填写三个内容，一个是 <code>authorization</code>，直接在下拉列表里面选择即可。另一个参数是 <code>ip</code>， <code>ip</code> 就是我们需要使用上文提取到的 IP 代理的本机网络地址。最后一个参数是<code>action</code>，<code>action</code> 是我们对白名单进行的操作，这里是对白名单进行添加的操作。</p>
<p>同时您可以注意到右侧有对应的调用代码生成，您可以复制代码直接运行，也可以直接点击「Try」按钮进行测试。</p>
<p><img src="https://cdn.acedata.cloud/cs5ib2.png" width="500" class="m-auto" loading="lazy"/></p>
<p>Python 样例调用代码：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests

url = <span class="hljs-string">"https://api.acedata.cloud/adsl/whitelist"</span>

headers = {
    <span class="hljs-string">"accept"</span>: <span class="hljs-string">"application/json"</span>,
    <span class="hljs-string">"authorization"</span>: <span class="hljs-string">"Bearer {token}"</span>,
    <span class="hljs-string">"content-type"</span>: <span class="hljs-string">"application/json"</span>
}

payload = {
    <span class="hljs-string">"ip"</span>: <span class="hljs-string">"113.112.122.132"</span>,
    <span class="hljs-string">"action"</span>: <span class="hljs-string">"add"</span>
}

response = requests.post(url, json=payload, headers=headers)
<span class="hljs-built_in">print</span>(response.text)
</code></pre>
<p>调用之后，我们发现返回结果如下：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>返回结果一共有一个字段，介绍如下：</p>
<ul>
<li><code>success </code>，此处操作结果的状态。</li>
</ul>
<p>其中 <code>success</code> 是包含了操作结果的状态，我们可以看到将 IP <code>113.112.122.132</code> 已经成功添加到白名单内。</p>
<h2 data-id="heading-11">错误处理</h2>
<p>在调用 API 时，如果遇到错误，API 会返回相应的错误代码和信息。例如：</p>
<ul>
<li><code>400 token_mismatched</code>：Bad request, possibly due to missing or invalid parameters.</li>
<li><code>400 api_not_implemented</code>：Bad request, possibly due to missing or invalid parameters.</li>
<li><code>401 invalid_token</code>：Unauthorized, invalid or missing authorization token.</li>
<li><code>429 too_many_requests</code>：Too many requests, you have exceeded the rate limit.</li>
<li><code>500 api_error</code>：Internal server error, something went wrong on the server.</li>
</ul>
<h3 data-id="heading-12">错误响应示例</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"error"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"api_error"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"fetch failed"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2cf86e86-22a4-46e1-ac2f-032c0f2a4e89"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-13">结论</h2>
<p>通过本文档，您已经了解了如何使用 ADSL Proxy API 轻松提取 ADSL 的 IP 并且对 ADSL Proxy 添加 IP 白名单。希望本文档能帮助您更好地对接和使用该 API。如有任何问题，请随时联系我们的技术支持团队。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[TRAE Friends@济南第3场圆满落幕，一次技术平权的具象化冲击]]></title>    <link>https://juejin.cn/post/7603721514204594185</link>    <guid>https://juejin.cn/post/7603721514204594185</guid>    <pubDate>2026-02-09T00:04:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603721514204594185" data-draft-id="7604012106154098734" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="TRAE Friends@济南第3场圆满落幕，一次技术平权的具象化冲击"/> <meta itemprop="keywords" content="AI编程,Trae"/> <meta itemprop="datePublished" content="2026-02-09T00:04:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="飞哥数智谈"/> <meta itemprop="url" content="https://juejin.cn/user/3825956195409223"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            TRAE Friends@济南第3场圆满落幕，一次技术平权的具象化冲击
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3825956195409223/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    飞哥数智谈
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-09T00:04:54.000Z" title="Mon Feb 09 2026 00:04:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在精心筹备许久，甚至要兼顾线上挑战赛的重压下，2月7号，<code>TRAE Friends@济南</code> 第三场线下活动，终于画上了圆满的句号。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce668313108e48f1a564c4c7eb4d667a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200293&amp;x-signature=BBxlyug4s1NYTAkC%2BMTscOsKhaE%3D" alt="" loading="lazy"/></p>
<p>如果说上次是对第一次单独举办活动的未知感到紧张，那这次面对<strong>市AI办和市大数据协会</strong>的领导，我好像回到了大学毕业面试的现场，我又紧张了。</p>
<p>还好，领导、嘉宾以及各位小伙伴都非常友好，整个活动流程非常顺利。</p>
<p>由于临近春节，我们还给大家准备了春节特别环节和礼物。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f2bdb0cd14e24068b86c489edd70ecc3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200293&amp;x-signature=xcfbilQ8uaVle8i357DKiDhA6hQ%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7bbdab24a2f54c68a82bc1852d9de297~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200293&amp;x-signature=A5KaIFvPwLMoo189EkG6uQ8Po4I%3D" alt="" loading="lazy"/></p>
<p>活动上半场由欲三更老师开启：</p>
<ul>
<li>《规范驱动编程》为上次的“氛围编程”补充了确定性输出的思考；</li>
<li>扈老师的《人工智能在钢铁领域的探索与实践》则为我们展示了AI编程在工业领域实践落地的效果；</li>
<li>而随后字节跳动产研人员果安老师则是进行了现场答疑，精准解答了社群小伙伴的诸多痛点。</li>
</ul>
<p>下半场是由多位 <code>TRAE</code> 使用者带来的一线实践案例，包括：</p>
<ul>
<li>TRAE实践：从需求文档到MVP产生</li>
<li>TRAE如何提效一个非技术人员的日常工作</li>
<li>TRAE 赋能产品经理工作全流程</li>
<li>AI驱动的工程艺术：从创意原型到深度业务建模</li>
</ul>
<p>各位分享老师的内容都非常精彩，收益良多。</p>
<p>但由于我本身就是技术出身，因此，第二位<strong>非技术老师</strong>的内容对我触动更大。</p>
<p>她是一个税务师事务所的咨询师，完全不懂技术，甚至不了解 IDE 是什么意思。但是，她在 AI 的帮助下，已经开发出改进工作的 2 个 AI 系统了。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6812e1b583eb47b5b275f7bdc47ea662~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200293&amp;x-signature=Awx3Pwoju829YlNLqqtP%2Bd8Q1Ug%3D" alt="第二大脑" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5272d9f8c26c439f8de96de6a59f7855~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200293&amp;x-signature=0SGq3UtuzUjToiZTQGl1fU%2BgnKw%3D" alt="任务分发" loading="lazy"/></p>
<p>这一幕极具魔幻色彩，却又真实地发生在眼前。</p>
<p>一个不懂开发的人员，硬生生靠着 AI 的辅助，搭建起了属于自己的<strong>第二大脑</strong>，并实现了工作<strong>任务的自动分拣</strong>。</p>
<p>她已经开始探索多智能体协同，试图在这个虚拟世界里，复刻出一个完整的数字税务事务所。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10bbdf266b73449aa91008769f1c63b5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200293&amp;x-signature=ISzc8ZvZOmYe%2B7i7p7WD%2BENXOgw%3D" alt="" loading="lazy"/></p>
<p>也许上面的界面UI还不完美，但对于她，这个系统已经创造了很大的价值。这一刻，才让我深刻理解了那句老话：<strong>技术只是工具，价值才是目标</strong>。</p>
<p>AI 的技术平权，魅力也许就在于此。</p>
<p>最后，很庆幸可以和 TRAE 一起举办这次活动，希望后续可以带来更多的价值。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[中美大模型“内战”都怎么打！一文详解Claude Opus 4.6和GPT-5.3 CodeX核心特性]]></title>    <link>https://juejin.cn/post/7603895839556878399</link>    <guid>https://juejin.cn/post/7603895839556878399</guid>    <pubDate>2026-02-09T00:10:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603895839556878399" data-draft-id="7603781883973992467" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="中美大模型“内战”都怎么打！一文详解Claude Opus 4.6和GPT-5.3 CodeX核心特性"/> <meta itemprop="keywords" content="人工智能,DeepSeek,Agent"/> <meta itemprop="datePublished" content="2026-02-09T00:10:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="大模型真好玩"/> <meta itemprop="url" content="https://juejin.cn/user/3140624091453053"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            中美大模型“内战”都怎么打！一文详解Claude Opus 4.6和GPT-5.3 CodeX核心特性
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3140624091453053/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    大模型真好玩
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-09T00:10:04.000Z" title="Mon Feb 09 2026 00:10:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读13分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px;color:#5e7ce0}.markdown-body h1{font-size:24px;margin-bottom:5px;margin-top:80px;position:relative;text-align:center}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px;margin-top:30px}.markdown-body h5{font-size:14px;margin-top:20px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #dfe1e6;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#ffeeed;color:#c73636;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#f8f8f8}.markdown-body a{position:relative;text-decoration:none;color:#5e7ce0;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIRlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAACCgAwAEAAAAAQAAACAAAAAAX7wP8AAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KGV7hBwAABWVJREFUWAnlVktsVFUY/s85997pC9BOTKxRWnEKsXWlxjWJj0RWJjrFAAXjAlewYWOkgauACVu7a2IiNUEyExM3yoZE3Wmi7qgPJthJBDE6JUNpO3Mf5/j95/bOTOcBlBgXejJ37rn/Of/7O/9/iP7vQ/zTAcjnC4ry+a5ii1OkiYTpuvjvEc0Gp51uivP+ZW+QBuSW4QjW5rptAa1Ey0uOGKOxwPetVyafN6p/52/PkNBbjdAhGaGEpMRjLZTryB8+9MUSYSGNRIcBvm8kBAY9tHYlHz78nTs392xIkwv9FA3Oe33bdoX1ZZKOS0bH0CXI6RugYLW6BwIu5gskkQ4sEG0wYF25PjBzbZfSYY6kDLUmWMt7FR7Lw3xYUkaTdjxHfTPnPwav0iEGYADVa9XIRIEyxrAA0jIQxgFL22gYwF7A8/DAzNVdksJvJaTEUZ2kYnZWziN5s1ADPHneEIXByotYuMSrf9JEbbsuv7VcvbaKML8plXtQR0EdIYDqWEmtOgAomZFH8EjWSnek2ulmtljljttHbmaIHCCCHzd9MjwfsmscBeZH9Jyd10nMvz92UQrtCBKvMF06mQy0SiEdRMEGg8mN0YjAlgoDDkPrMI5qJKSkKKydpbB2CZjJkhIBvOBw2CGQgii85bpx//dMqFRKam5uvH7w+K97oe+Cl0HO68uIBH0qyEzpOMwIbZIcFq0I+9cwoElizCjk2KFI1y7Nnx614W1db58fOXIlMzs7Xn/jeDmvBV2Q0mXjGf554O/m4LZHp2N8r61WPMvLZWLdiC4GMAk5BjeeB5lhv39l6+BIbu3m760hXMDKBD08XBKzR8fr04nygnIypOOAJUx/fHrsi0Mnys+vVK+V4VUohaiyPCo2Q9DFALvF/ikw8WS4QvVZALS5ksw47/7R8ejgTPk1UFqU6/3zp8bOM7B/kdu/fkguPGU5JibW+F0sTjWOUw8DklRrg4BiLGeBqbaRLxjlT4no0InFV402RcftJz41cH/f/JnHP3kZaaF6VX/liwist9vYG5+NU9Cg3MNkt/+lU5wS8fTxq3mc7ILjDlAE4CJpe89BOWPiIjBhi9O6PI4G1jsc6RGB3lZwmS76k8H0zOKTkFboG8jS2krFKCX2fvTeaPHIBwAkMHHgncURnL3nuCSnxSopdIzN5th0BIonJ0Lf9yUA9iMkzdRWl3BixOusfDcwQVcS4UKIFwYfGPnM8wY/DyP9NFMXaTE5BU39tGkDgGZz+fJJG0oYcSaOafLcqdECY4LzfSObSzyUOgxqtyisr8SSNOOAkubWoh3TTaeA2YtFEXPnm5x81/j+6MI6JqyS25WSNU6hbCMKHG84marJbdR+vwakRhQLRuQpbzHRLjmpmijI+OmWCtq+LzWtnX5v30gHSsqmWne74DtiACi2+Wz0iXbuLt9D2cDyoPEkWOiyp5XUIwLMi/wJY1FbH5B9ONtdC1KrsD/Q0MCQAS0wccILORDW25amAeOtooAj/KQxfzF17uwTSQ1v3dJ7jnLINwdZYRDa4tPU0sHVXFo/vxFF5BqFqxRfOmgPCk4ft2NgKTCy2Y47JIEg+MIhjYsLy5I25qUYTQlCjMRHsr/UwdYwIK33UO1J5fFNB9XNO6akcywJofVmXQDP2wfrSPcI2xG5BSs3I+IosHr4EtvO1TDAu16xHQq5+ykMblfRXLbhEoFIdDTBdhldvzl+3CMg60ZktI2vNzLW6IIp0waLklot9L63yzuUp8dJd7bglPFe3hIXstBEP58/s6Ocyr4rH2+866ZNbriTzA0RSOWCwakMl1QJgculxPt8Z7O5GLdtW6bvU8R/nO1vb+hMExVAVtEAAAAASUVORK5CYII=");background-size:100%}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #5e7ce0}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #5e7ce0;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#5e7ce0}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#f2f5fc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #5e7ce0;background-color:#f2f5fc}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5e7ce0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ul li::marker{content:"•";color:#5e7ce0}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]:before{display:inline-block;width:16px;height:16px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAhRJREFUeAHtnLEuBFEUhs9cu7JCskEhIrZAgYZGoREPwBuIygOoPITKA6jEG/AAolFoaFCgICIKZBNiY8Pyz5rNOWe9wNz5T7N3Z2eT/b/7zZlpziat3xKWBDJoEyh5EDd3DTk5r8vV7Yc8vzbl6zvfwvSERIYHyzI90SeLc1WZrFV85PR9oi+N/YMnOT6t/3tiLAeXFqqytjrSFacDYmfvQS6u37tOiPHA7FS/bK6PmWhpj4AJRYGA9MiKzLpK6An+cqiNVmRleUhArrec6PNzt/5sttLgh0cvcvfY6Px+ZNY9I6Ax6gKErY1xmZ8ZyD0E5MJGIgsyIZsunT3g7qALJuTdAp0nWyMTsunS2QNukbpwOcRaPpvOHvxzQow2ZBvrs+nsfLL8o0QQBJFdMO1XGkEjaIQlQCMsD/YIGkEjLAEaYXmwR9AIGmEJ0AjLgz2CRtAIS4BGWB7sETSCRlgCNMLyYI+gETTCEqARlgd7BI2gEZYAjbA82CNoBI2wBGiE5cEeQSNohCVAIywP9ggaQSMsARphebBH0AgaYQnQCMsjYC5SF2agYi2fTWcPGA7VFfO0n8+mswdMyOrCNJwnpz/P6xqZkE2Xzh4w8qcLI4Hbu/dydvkWBRAAQBZk0uOOyKyzp5PARRiF1puNtR+NTh+oMCvtJ+D8F2N6j6x+PrwzG46gRTDDm5BtsAGBg0X924Qfj7i23p7HNgQAAAAASUVORK5CYII=");background-size:100%;position:relative;right:2px;top:-5px}.markdown-body input[type=checkbox]:checked:before{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAABMtJREFUeAHtXM2KFDEQzrQKruIu4mEXRFlUVLz4A4K7B99AcO8io0/gwQfxDVzFuwu+gQf34EG8iOAPKAh6EFlBFMSf/qa2uqszlVR6ZtYxM5PDJNVVSer78nU6KrHzpyxuVlwx44AY2O0T8eb9D7f5fMu9fPvdff7y0/36nbdgdhUdd+jgHnf62JxbObvgjh/d60Pu2R35ajx49Mk9frqlBk7Kw8sXF9y1K4t9cCoi7tz/4F68/tYXMIkPzpzY725dP9yA1tsjoIRpIQHogRWYZSmwJ4Reh06nI2Nd7rYEA8zAzqXAxhgq/pc1d9vHKbEX+Dr4JbzypJDc/YxXYi/wifRLeOXpU5q7n/FK7EXsnBBeeRoqd7/EHj1ZhleeiMjdz8pArRKR+0pb+UsCuK0SkftKW/kzeFmrRHCAxWzufsaJOkqExWzufpOI8EpP1jnCJCK80pN1jjCJ4ICwMigidz/jRD3bI7bZUInIfaWt/KUSuK0SEd4jqFvufgYva5UIDrCYzd3POFFHifhfV/7k8lwPw7D5mUSEV3r854ju2pK7ffOIWzk/X+Go803Lr+ooGqoiwkyP9xzRXVt0q9sE3CgJYTLqfNPyE/irpkoEe2um6ck4bSiBSeD8JBl41jY/Hgd1lIiaaeoyLlsjgUGAjEH3DB4DtUpEW2Z3Mj5GAgA8efbVvXpX/200nln5IMYvKhHDrvylcwdc9+pSNdeg46WQsP7wo2s7fpWYaPT926fw9ZiVk4BpywYJkGuvlJs4EuWS0p/HTyHh3kbzH2najM85cR0lgpPiYMtukFB26m1u5Ua+vkFkWP3Zn0KCJDg1Px6f42Wtvhrhdyz8ncanrFKCmGH1wrwDMCrh/uxPIUFTAvdHbeVPsc1fVRE+c7Ud/k6fWt7XHFlYqcqQ5wTRvWpiY4wrIZwfDUL+akDRUBXB/jCzFCH9SHCzTDRUmsro7z+cEvrHwxOZn2ZTL/pVFcEBtRLoiWXfxQ5ehvoHHx4vpIwUEuJKSMvPz5/zQq0qwmIy5m+rjBQSwnsCQYnlgwjfT72av6oifOba2qnKcOXeGVIP0rT3BALTNr8mBWSpRHAgmJSTtLGhDHwj+A9GPCbX2DNiBSRoShg0H8zl5y/njxIhJ0WntralDJmIbO+UEvz85Zwt9wj7HIDB5Ttp7RkyGbRDSqC49vOjX50P9aexmr+qInzmajvtO13H02SpyrCVMNj8dT7/4BwByDXzRIC0LWXEldA/njVfip9GpV9VERxQM0lPhrVDyrCVMJr5/fwZJ+qWewR1lSuNJ21sXxnjVgIhck5VhM/cqG1WBpIAMX4Z9Xz+eP58sFUiOBArLQcZpQ0CNCXt1HzA5OfPOFGrrwYHyKTwbNJsxolaJUJbKeo0mu/4uMeXBHBbJSK88qP5jo97fAYva5UIDgivHEXk7mecqKNEhFeOhsjdbxKR+0pb+UsCuK0qIveVtvJn8LJWieAAi9nc/YwTdZQIi9nc/SYR4ZWenSO2yZvgcwTuRYZKWBnUI3e/xF7gcmio5L4HWPlL7AVuyPol95W28me8EnuBa8J+sZjM3c94JfYCd6VxTXjaCjDLe+K9cwTuSuOa8LQUYPXvh1d3w0HC7JK8kMK0/rcJfwHkVMYgi4xhOgAAAABJRU5ErkJggg==");background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">前言</h2>
<p>如果要说当前AI领域最引人瞩目的对决，那一定非Anthropic（Claude模型的所属公司）与OpenAI的“巅峰之战”莫属。这两家巨头不仅代表着大模型技术的两大顶尖路线，其背后的“同源分流”故事更增添了这场竞争的戏剧性。</p>
<p>OpenAI由山姆·奥特曼创立，致力于打造具有通用智能的AI系统，追求模型在各种任务上的全面能力。而Anthropic则由OpenAI前研究副总裁达里奥·阿莫迪于2021年创立，团队中不乏OpenAI的原班人马。正因为这种血脉渊源，两家公司在分道扬镳后呈现出的技术理念差异才格外值得玩味：Anthropic始终将安全、可靠与可控性置于首位，强调模型在现实任务中的实用价值，而非仅仅追逐基准测试的高分。</p>
<p>双方的竞争早已超越技术范畴，蔓延至市场与公关战场。2026年NFL超级碗中场广告中，Anthropic公然“开撕”——通过一则描绘AI助手在对话中强行插入广告的短片，影射OpenAI，并借此凸显Claude“绝不植入广告”的产品理念。OpenAI CEO奥特曼随即在社交媒体上反击，指责该广告“不诚实且极具欺骗性”。这场公开交锋，将两家公司的矛盾推至台前。但这远不止大家以为的口水战, 真正的较量，始终在于技术实力的硬碰硬。</p>
<p>在经历一系列“预热式”泄露之后，北京时间2月6日，Anthropic率先亮剑：新一代旗舰模型<strong>Claude 4.6 Opus</strong>正式登场。作为公认的全球最强编程与智能体模型之一，Claude Opus系列的每一次迭代，都在重新定义大模型的能力边界。几乎同一时间，OpenAI果断接招，正式发布新一代编程专用旗舰模型——<strong>GPT-5.3 Codex</strong>。值得关注的是，这是在GPT-5.3通用模型尚未面世的情况下，OpenAI首次跨级发布专项代码模型。结合前一天其刚刚推出新一代CodeX系列的动向，不难看出：OpenAI正在全力进攻大模型编程领域，决心在编程这一Claude模型称霸的领域分蛋糕，夺回主导权。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9fe40b3c6e6456f8544d561567ce31f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200717&amp;x-signature=VotWal6L7QEyWpIIVPnMNKKsEU4%3D" alt="a0.png" loading="lazy"/></p>
<h2 data-id="heading-1">一、Claude Opus 4.6：功能完整解析</h2>
<h3 data-id="heading-2">1.1 核心特性一：综合性能全面领跑</h3>
<p>Claude 4.6 Opus 的升级首先体现在综合性能的跨越。官方数据显示，相比上一代，它在知识工作、智能体（Agent）搜索、智能体编程以及复杂问题推理等核心场景的综合性能提升了 <strong>15%</strong> ，整体实力已明确领先于 Gemini 3.0 Pro 与 GPT-5.2。</p>
<p>从权威评测榜单来看，Claude 4.6 Opus 仅在视觉推理与博士级科研问题解决两项上略逊于 GPT-5.2，而在其他关键维度——包括<strong>编程能力、计算机使用（Computer Use）、工具调用（Tool Use）、终端编码、金融分析、办公软件操作</strong>等——均实现了对其他主流模型的显著超越。</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4471321161a74ed2ba11df15385910a0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200717&amp;x-signature=DHh0MtqQCl0ppHV1NSbcXg0bmlg%3D" alt="2.png" width="50%" loading="lazy"/></p>
<h3 data-id="heading-3">1.2 核心特性二：超长上下文窗口</h3>
<p>这次升级带来了一个关键突破：Claude 4.6 Opus 的上下文长度正式达到了 <strong>100万 token（1M tokens）</strong> ，成为Opus系列中首个迈入“百万级”的旗舰模型。同时，其单次最大输出也提升至 <strong>128K tokens</strong>，为处理超长文档和复杂任务提供了坚实基础。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be9a65ea4a6b47df9c0048f2b7e50349~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200717&amp;x-signature=pxFUXBoaL3oyGRdc0EgmqU%2FK1Ug%3D" alt="3.png" loading="lazy"/></p>
<h3 data-id="heading-4">1.3 核心特性三：编程性能和编程生态全面跃升</h3>
<p>可以预料的是Claude 4.6 Opus模型的编程性能再次飞升，对于普通的中小型编程任务，Claude Code已经是当之无愧的王者了。然而，面对大型开发项目，所有大模型普遍受困于“上下文腐烂”问题——即随着上下文增长，模型对代码细节的把握和理解能力会显著下降。</p>
<p>Claude 4.6 Opus 对此提出了针对性解决方案：<strong>大幅增强从大型文档中精准检索指定信息的能力</strong>，无论在长上下文检索还是长语境推理方面，性能提升都极为明显。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/791dfb1e5ebe403dbd1ec3dfbd087579~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200717&amp;x-signature=VPrw1zI6KCFKoomefhZIcMptidw%3D" alt="a1.png" loading="lazy"/></p>
<p>更值得关注的是，Claude模型的专属编程工具 <strong>Claude Code</strong> 迎来了两项重大升级：</p>
<ol>
<li>
<p><strong>Adaptive Thinking（自适应思考）模式</strong>：用户无需手动在“推理”与“对话”模式间切换。Claude Code 能根据任务性质智能选择最佳模式，并允许用户通过设置 <code>effort</code> 参数来分配项目的 token 预算</p>
</li>
<li>
<p><strong>Context Compaction(上下文压缩)</strong>: 优化的上下文压缩机制，力求在保持“无限对话”体验的同时，最大限度保留关键信息。</p>
</li>
<li>
<p><strong>正式支持 Multi-Agent 架构（Agent Teams）</strong> ：开发者现在可以同时启动<strong>多个 Claude Code 智能体协作开发</strong>。它们既可分工负责项目的不同模块，也能“竞争性”开发同一功能并择优录用，还能相互进行代码审查，快速提升整体代码质量。</p>
<blockquote>
<p>据官方透露，Anthropic 内部已长期采用此种“智能体团队”开发模式，其效率已得到充分验证。当然，更多智能体并行也意味着更高的 token 消耗，这对开发者的预算提出了更高要求。好在价格方面，Claude Code 保持了“加量不加价”的策略，基础费率与 Claude 4.5 Opus 一致（但超过 200K token 的部分定价会有所上浮）。</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f89b19eda3d4397a87231cf6824b20f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200717&amp;x-signature=tFv4PLxjRkAQIj%2F29o7foW1NeUs%3D" alt="9.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e861056b8f434f4fbac376fdd9d46b99~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200717&amp;x-signature=mW1%2FHFq2dPpFrqv%2BQQf3GPTAeDw%3D" alt="10.png" loading="lazy"/></p>
</li>
</ol>
<h3 data-id="heading-5">1.4 核心特性四：生态大扩张</h3>
<p>Claude 的攻势早已不限于编程。随着今年1月通用办公智能体 <strong>Cowork</strong> 的发布，Anthropic 正将其影响力快速渗透至日常办公、金融分析与法律合同审查等领域。伴随着AI办公席卷华尔街！SaaS软件市值惨遭重创，无数的法律公司会因为Anthropic发布了一款名为Legal的运行在Cowork内部的法律插件而股价跳水。</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/47fdeda29ea642ec9be5456b2da25ef2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200717&amp;x-signature=DUIs8CqtsQxPhw6X2T623Eh04aE%3D" alt="11.png" loading="lazy"/></p>
<p>面对传统企业的状况，Anthropic可不留任何情面，打算乘胜追击，立志要成为新时代的新王！（毕竟互联网时代初始微软也是后起之秀）。这次Claude Opus新模型重点升级了其在日常办公中的性能表现，包括使用word、ppt、excel等，并升级了其在金融分析，法律咨询方面的功能，相信在通用办公领域，在Claude Opus 4.6模型的加持下，华尔街的风暴还将愈演愈烈，AI时代的脚步也将愈来愈近！大家赶快去尝试一下体验Claude Opus4.6模型的强大功能吧~</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b8222ae426d14256a4955d995ce3d2e2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200717&amp;x-signature=a3fGRfkuyFG8NxIPMsB2WxL%2BYls%3D" alt="a2.png" loading="lazy"/></p>
<h2 data-id="heading-6">二、OpenAI的反击：GPT-5.3 CodeX 技术解析</h2>
<p>面对Claude的强势进击，OpenAI迅速亮出了它的“王牌”——专为代码而生的 <strong>GPT-5.3 CodeX</strong>。这不仅是一次常规迭代，更是在编程专项能力上的一次集中火力反攻。</p>
<h3 data-id="heading-7">2.1 核心特性一：模型性能大幅提升</h3>
<p>新模型在多项权威基准测试中展现出了显著进步。在评估实际编程问题解决能力的 <strong>SWE-Bench Pro</strong> 榜单上，其准确率提升超过 <strong>15%</strong> ，且解决相同问题所消耗的 <strong>Token 数量大幅减少</strong>，意味着更高的效率和更低的成本。此外，在 <strong>Terminal-Bench 2.0</strong>（命令行编程）和 <strong>Computer Use</strong> 等关键榜单上，其跑分也实现了 <strong>10% 以上</strong> 的全面上涨，进步毋庸置疑。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94d631aa790c49b59852bc2ac63d8408~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200717&amp;x-signature=mqdzshljD67cIeuJuoaChUqB1eg%3D" alt="a3.png" loading="lazy"/></p>
<h3 data-id="heading-8">2.2 核心特性二：复杂任务与深度意图理解</h3>
<p>GPT-5.3 CodeX 特别强化了处理复杂编程场景的能力，尤其是在<strong>复杂的网页开发任务</strong>中表现更为出色。更引人注目的是其<strong>意图理解能力</strong>的跃升。</p>
<p>以“创建引导转化的落地页”这一典型任务为例，相比前代，GPT-5.3 CodeX 不再满足于机械地堆砌元素，而能更深入地理解“促成转化”的核心目标。它会主动运用<strong>数据对比、突出产品价值、设计包年服务选项</strong>等更具巧思的策略来优化页面逻辑与文案——这种对商业意图的深度揣摩，标志着AI从“执行工具”向“策略伙伴”的微妙转变（虽然感觉有点不学好，不学技术学营销？）。</p>
<h3 data-id="heading-9">2.3 核心特性三：进军办公场景与交互式开发</h3>
<p>显然，OpenAI也敏锐捕捉到了AI办公的巨大风口。受 Anthropic Cowork 等产品的刺激，新版 GPT-5.3 CodeX 已能无缝接入各类办公软件，高效处理 <strong>PPT 制作、表格分析与文档编写优化</strong> 等任务，预示着编程之外的新战线已正式拉开帷幕。</p>
<p>更重要的是，GPT 5.3首次系统性地开发了  <strong>“交互式开发”</strong>  模式。开发者可以随时介入 CodeX 的工作流程，通过实时对话调整其工作方向与计划。这有效解决了传统长任务执行中容易“中途跑偏”、导致大量 Token 被浪费的痛点，将开发过程转变为一种灵活、可控的人机协同。</p>
<h3 data-id="heading-10">2.4 核心特性四：自我迭代的元能力</h3>
<p>GPT-5.3 CodeX 让 OpenAI最引以为傲的，或许不只源于模型本身的强大，更在于其<strong>革命性的训练方式</strong>。官方透露，GPT-5.3 CodeX 是行业内首个成功实现大规模  <strong>“自我训练、自我迭代”</strong>  的模型。</p>
<p>研发人员将早期版本的 GPT-5.3 CodeX 接入 <strong>CodeX Agent</strong> 的智能体框架中。随后，这个 Agent 在持续的模型训练过程中，<strong>自主地发现了模型存在的缺陷，并主动提出并实施了优化的解决方案</strong>，最终取得了超预期的训练效果。</p>
<p>这不仅仅是一次技术升级，更可能预示着未来模型进化范式的转变。难怪 OpenAI CEO 山姆·奥特曼此前会在社交媒体上转发相关进展，并傲娇地感慨：“我快要被AI淘汰了。”</p>
<h2 data-id="heading-11">三、 GPT-5.3 CodeX和Claude 4.6 Opus模型巅峰对决</h2>
<p>看完了两家模型的核心特性，一个现实的问题摆在面前：在实际工作中，我们该如何选择？最新一代的“编程模型之王”究竟花落谁家？（当然该问题仅限于富哥，要不还是老老实实问国产大模型）。首先需要明确，对于绝大多数开发者而言，顶尖模型之间的性能差距在日常编码中可能并不悬殊（且两者均显著领先于其他梯队）。因此，选择往往不取决于“谁更强”，而在于<strong>谁的特性更匹配你的具体场景</strong>。这里笔者由于最近工作忙碌，为了给大家一个清晰的参考笔者结合了B站知名大模型评测UP主“九天”的深度对比数据，从多个维度展开分析。</p>
<h3 data-id="heading-12">3.1 权威榜单：OpenAI 小幅领先</h3>
<p>从 <strong>SWE-Bench Pro</strong>、<strong>Terminal-Bench 2.0</strong> 等权威编程基准测试来看，<strong>GPT-5.3 CodeX 保持着约 5%-8% 的综合性能优势</strong>。</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ac17c146b81488b9e10b090ffca8d9d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200717&amp;x-signature=U1kPujsDzcdjTiir8npIb6FBkB0%3D" alt="19.png" width="50%" loading="lazy"/></p>
<h3 data-id="heading-13">3.2 深入探讨：各有千秋</h3>
<p>具体深入探讨模型的不同能力维度：</p>
<ul>
<li><strong>上下文与复杂任务处理</strong>：<strong>Claude 4.6 Opus</strong> 凭借其 <strong>100万token</strong> 的巨量上下文窗口（GPT-5.3 CodeX 为 40万），在<strong>智能体编排、长文档检索、处理庞杂的企业级任务与工作流</strong>方面优势明显。</li>
<li><strong>响应与执行速度</strong>：<strong>GPT-5.3 CodeX</strong> 则在<strong>响应速度</strong>上更胜一筹，为追求快速迭代和交互体验的开发者提供了更流畅的感受。</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2a42629ea133443eac43b2b956e57836~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200717&amp;x-signature=%2B3vXsG4PIPjV%2BWcbKgUxmR5LrwQ%3D" alt="a4.png" loading="lazy"/></p>
<h3 data-id="heading-14">3.3 实战案例</h3>
<p>为了更直观地对比，九天老师设计了一个实战任务：要求两者分别开发一个<strong>HTML单页</strong>，用于直观对比它们自身的性能差异。任务要求包含自行搜索最新信息、确保数据准确，并通过前端设计让对比结果一目了然。</p>
<ul>
<li><strong>Claude 4.6 Opus (通过 Claude Code 运行)</strong> ：交出的网页<strong>视觉效果更美观，对比维度更丰富，结论呈现清晰直观</strong>。它倾向于从整体用户体验和可读性出发，展现了对“有效传达信息”这一目标的深度理解。</li>
<li><strong>GPT-5.3 CodeX (通过 Cursor 中的 CodeX 运行)</strong> ：则格外<strong>注重“零错误”的严谨性</strong>。其生成的页面包含了大量<strong>附带可溯源实时依据的对比结论</strong>。</li>
</ul>
<p>简而言之，若你的工作流涉及长文档、复杂多步Agent协作等工程能力，Claude 4.6 Opus 可能是更优解；若你看重极致的科学验证，GPT-5.3 CodeX 实力更强。这场对决没有绝对的输赢，只有针对不同场景的更优选择。而它们彼此的追赶与超越，最终都将推动整个AI编程领域向着更强大、更易用的未来加速迈进。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5d385cc671b4af08f0d8315dd43c412~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200717&amp;x-signature=eX2ByXiMUI%2BZSyClBXNTtenR1%2BM%3D" alt="a5.png" loading="lazy"/></p>
<h3 data-id="heading-15">四、总结</h3>
<p>美国大模型打的火热的同时，在大洋彼岸的我国也在激烈的进行着大模型的斗争，<strong>元宝</strong>和<strong>千问</strong>数十亿的资金砸入争夺着AI时代的入场券。笔者也深受其影响，早起第一件事是先抽一下元宝的红包！</p>
<p>然而，热潮之下更需冷静的审视。回顾2025年对众多国产大模型的深度测评与实际工作应用，一个清晰的感受是：在<strong>智能体（Agent）能力</strong>与<strong>核心编程能力</strong>这两个关键赛道上，国内顶尖模型与Claude、GPT等国际第一梯队仍存在显著差距。无论是Qwen、混元在复杂任务编排上的局限，还是MinMax、GLM在编程精度与可靠性上的不足，都让笔者看到了需要急起直追的空间。2026年伊始，美国同行已经再次拉高了技术竞争的强度。这对于我国而言，既是压力，更是启示。真正的市场竞争，最终将回归到<strong>技术深度、产品体验与生态价值</strong>的比拼上。笔者还是期待国内企业能将更多的资源与智慧，聚焦于底层技术的突破与核心能力的锻造，切实缩小与老美的差距。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a472f09ca8354669a38dff6a6bd5d421~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200717&amp;x-signature=AyEcvT9zOsZX1xsdkzKrecr21vo%3D" alt="24.png" loading="lazy"/></p>
<p>大模型时代的到来注定是颠覆世界的第四次工业革命，也希望大家可以紧跟AI时代的潮流，把握AI时代的风口。2026注定是大模型接续爆发的一年！为了让大家彻底搞懂大模型的作用原理，笔者也发布了<a href="https://juejin.cn/column/7594655863548248116" title="https://juejin.cn/column/7594655863548248116" target="_blank">《数据到模型到应用：大模型训练全流程实战指南》</a>专栏，预计会有50期内容，将系统拆解从数据处理、模型训练到强化学习与智能体开发的全流程，并带大家从零实现模型，帮助大家掌握大模型训练的全技能，真正掌握塑造智能的能力！感兴趣大家可关注笔者掘金账号，更可关注笔者同名微信公众号：<strong>大模型真好玩</strong>，更多教程和大量大模型学习资料分享~</p>
<p>需要注意的是：大模型训练对计算资源有一定要求，尤其是GPU显存。为降低学习门槛，笔者与国内主流云平台合作，大家可以通过打开链接: <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.lab4ai.cn%2Fregister%3FagentID%3Duser-XorgKKc56U" title="https://link.juejin.cn?target=https%3A%2F%2Fwww.lab4ai.cn%2Fregister%3FagentID%3Duser-XorgKKc56U" target="_blank">Lab4AI</a> ，体验<strong>H100 GPU 6.5小时</strong>的算力。本系列所有实战教程均将在该平台上完成，帮助大家低成本上手实践。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AQS深度探索：以ReentrantLock看Java并发编程的高效实现]]></title>    <link>https://juejin.cn/post/7603721514204610569</link>    <guid>https://juejin.cn/post/7603721514204610569</guid>    <pubDate>2026-02-09T00:14:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603721514204610569" data-draft-id="7603653885601071154" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AQS深度探索：以ReentrantLock看Java并发编程的高效实现"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-02-09T00:14:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SevenCoding"/> <meta itemprop="url" content="https://juejin.cn/user/3261615728242467"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AQS深度探索：以ReentrantLock看Java并发编程的高效实现
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3261615728242467/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SevenCoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-09T00:14:17.000Z" title="Mon Feb 09 2026 00:14:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读32分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">概述</h2>
<p>AQS ( Abstract Queued Synchronizer ）是一个抽象的队列同步器，通过维护一个共享资源状态（ Volatile Int State ）来表示同步状态 和一个先进先出（ FIFO ）的线程<strong>等待队列</strong>来完成资源获取的排队工作，通过CAS完成对State值的修改。</p>
<p>AQS整体框架如下：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b301bbc6a75d453f9e393253415974cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200857&amp;x-signature=dCeYFvBTYETNetvERnrCYXywunQ%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b0f31a4706d4b2ca11ea7dcb9e863ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200857&amp;x-signature=XYXvguzp%2FENh92Wl6YYwUaQ%2BELI%3D" alt="" loading="lazy"/></p>
<p>当有自定义同步器接入时，只需重写第一层所需要的部分方法即可，不需要关注底层具体的实现流程。当自定义同步器进行加锁或者解锁操作时，先经过第一层的API进入AQS内部方法，然后经过第二层进行锁的获取，接着对于获取锁失败的流程，进入第三层和第四层的等待队列处理，而这些处理方式均依赖于第五层的基础数据提供层</p>
<h2 data-id="heading-1">原理</h2>
<p>AQS 为每个共享资源都设置一个共享资源锁，线程在需要访问共享资源时首先需要获取共享资源锁，如果获取到了共享资源锁，便可以在当前线程中使用该共享资源，如果获取不到，则将该线程放入线程等待队列，等待下一次资源调度，流程图如下所示：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af9c05b2cfae4332b9dee33e5b7299ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200857&amp;x-signature=ZJHd6BKBVVj2ippwyM2hNyen9RQ%3D" alt="" loading="lazy"/></p>
<p>Java中的大部分同步类（Lock、Semaphore、ReentrantLock等）都是基于AbstractQueuedSynchronizer（简称为AQS）实现的。</p>
<h2 data-id="heading-2">底层结构</h2>
<h3 data-id="heading-3">state：状态</h3>
<p>Abstract Queued Synchronizer 维护了 volatile int 类型的变量，用于表示当前的同步状态。volatile虽然不能保证操作的原子性，但是能保证当前变量state的可见性。</p>
<p>state的访问方式有三种： getState()、setState()和 compareAndSetState()，均是原子操作，其中，compareAndSetState的实现依赖于 Unsafe的compareAndSwaplnt()</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// java.util.concurrent.locks.AbstractQueuedSynchronizer</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> state;

<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getState</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> state;
}

<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setState</span><span class="hljs-params">(<span class="hljs-type">int</span> newState)</span> {
    state = newState;
}

<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSetState</span><span class="hljs-params">(<span class="hljs-type">int</span> expect, <span class="hljs-type">int</span> update)</span> {
    <span class="hljs-comment">// See below for intrinsics setup to support this</span>
    <span class="hljs-keyword">return</span> unsafe.compareAndSwapInt(<span class="hljs-built_in">this</span>, stateOffset, expect, update);
}
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be0aaad1fa394c84b9d7bc6c67da24ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200857&amp;x-signature=vdnjJ3cbaYJDPdMHsquIgmYVEcY%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/70bb23738b2644619ee77df8cecc887f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200857&amp;x-signature=srtHkWq%2BYtgj0vsP3MKWpC05FuY%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-4">CLH队列</h3>
<p>Craig、Landin and Hagersten队列，是单向链表，AQS中的队列是CLH变体的虚拟双向队列（FIFO），AQS是通过将每条请求共享资源的线程封装成一个节点来实现锁的分配。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00eaa4f9db8142aeadc726f1aa1bc3b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200857&amp;x-signature=1BQ3zHz4NjBopBhwYyfVZdIKAog%3D" alt="" loading="lazy"/></p>
<p>AQS使用一个Volatile的int类型的成员变量来表示同步状态，通过内置的FIFO队列来完成资源获取的排队工作，通过CAS完成对State值的修改。</p>
<h3 data-id="heading-5">AQS的独占式和共享式</h3>
<ul>
<li>
<p>独占式:只有一个线程能执行，具体的 Java 实现有 ReentrantLock。</p>
</li>
<li>
<p>共享式：多个线程可同时执行，具体的 Java 实现有 Semaphore和CountDownLatch。</p>
</li>
</ul>
<p>AQS只是一个框架 ，只定义了一个接口，具体资源的获取、释放都由自定义同步器去实现。不同的自定义同步器争用共享资源的方式也不同，自定义同步器在实现时只需实现共享资源state的获取与释放方式即可，至于具体线程等待队列的维护，如获取资源失败入队、唤醒出队等， AQS 已经在顶层实现好（就是模板方法模式），不需要具体的同步器再做处理。自定义同步器实现时主要实现以下几种方法：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/184616c63b7d4293978c6a47397890b6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200857&amp;x-signature=bKedQKliw3J3Ln%2F0FxhOdZm2i6s%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p>以ReentrantLock为例，ReentrantLock中的state初始值为0表示无锁状态。在线程执行 tryAcquire()获取该锁后ReentrantLock中的state+1，这时该线程独占ReentrantLock锁，其他线程在通过tryAcquire() 获取锁时均会失败，直到该线程释放锁后state再次为0，其他线程才有机会获取该锁。该线程在释放锁之前可以重复获取此锁，每获取一次便会执行一次state+1, 因此ReentrantLock也属于可重入锁。 但获取多少次锁就要释放多少次锁，这样才能保证state最终为0。如果获取锁的次数多于释放锁的次数，则会出现该线程一直持有该锁的情况；如果获取锁的次数少于释放锁的次数，则运行中的程序会报锁异常。</p>
</li>
<li>
<p>以CountDownLatch以例，任务分为N个子线程去执行，state也初始化为N（注意N要与线程个数一致）。这N个子线程是并行执行的，每个子线程执行完后countDown()一次，state会CAS减1。等到所有子线程都执行完后(即state=0)，会unpark()主调用线程，然后主调用线程就会从await()函数返回，继续后面的动作。</p>
</li>
<li>
<p>以Semaphore为例，state则代表可以同时访问的线程数量，也可能理解为访问的许可证（permit）数量。每个线程访问(acquire)时需要拿到对应的许可证，否则进行阻塞，访问结束则返还（release）许可证。state只能在Semaphore的构造方法中进行初始化，后续不能进行修改。</p>
</li>
</ul>
<p>一般来说，自定义同步器要么是独占方法，要么是共享方式，他们也只需实现tryAcquire-tryRelease、tryAcquireShared-tryReleaseShared中的一种即可。但AQS也支持自定义同步器同时实现独占和共享两种方式，如ReentrantReadWriteLock。</p>
<h3 data-id="heading-6">Node节点</h3>
<p>Node即为上面CLH变体队列中的节点。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9808e9c363944e97b68bc295bb5ccc7f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200857&amp;x-signature=z%2FT9AL0%2FvTTGwAHSSSgh0Tl4M88%3D" alt="" loading="lazy"/></p>
<p>Node结点是每一个等待获取资源的线程的封装，其包含了需要同步的线程本身及其等待状态waitStatus</p>
<p>Node中几个方法和属性值的含义：</p>
<ul>
<li>
<p>waitStatus：当前节点在队列中的状态</p>
</li>
<li>
<p>thread：表示处于该节点的线程</p>
</li>
<li>
<p>prev：前驱指针</p>
</li>
<li>
<p>predecessor：返回前驱节点，没有的话抛出npe</p>
</li>
<li>
<p>nextWaiter：指向下一个处于CONDITION状态的节点（由于本篇文章不讲述Condition Queue队列，这个指针不多介绍）</p>
</li>
<li>
<p>next：后继指针</p>
</li>
</ul>
<h3 data-id="heading-7">等待状态waitStatus</h3>
<p>waitStatus有下面几个枚举值：如是否被阻塞、是否等待唤醒、是否已经被取消等。共有5种取值CANCELLED、SIGNAL、CONDITION、PROPAGATE、0。</p>
<ul>
<li>
<p>CANCELLED(1)：表示当前结点已取消调度，不再想去获取资源了。当timeout或被中断（响应中断的情况下），会触发变更为此状态，进入该状态后的结点将不会再变化。</p>
</li>
<li>
<p>SIGNAL(-1)：表示后继结点在等待当前结点唤醒。后继结点入队时，会将前继结点的状态更新为SIGNAL。</p>
</li>
<li>
<p>CONDITION(-2)：表示结点等待在Condition上，当其他线程调用了Condition的signal()方法后，CONDITION状态的结点将从等待队列转移到同步队列中，等待获取同步锁。</p>
</li>
<li>
<p>PROPAGATE(-3)：共享模式下，前继结点不仅会唤醒其后继结点，同时也可能会唤醒后继的后继结点。</p>
</li>
<li>
<p>0：新结点入队时的默认状态。</p>
</li>
</ul>
<p>注意，负值表示结点处于有效等待状态，而正值表示结点已被取消。所以源码中很多地方用&gt;0、&lt;0来判断结点的状态是否正常。</p>
<h2 data-id="heading-8">源码</h2>
<p>以ReentrantLock的非公平锁为例，将加锁和解锁的交互流程单独拎出来强调一下</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ae3fdd8c6bd940f3beb9c3be217bae49~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200857&amp;x-signature=WmI8nyMsfVEulo3J%2F3oQo5yZhuQ%3D" alt="" loading="lazy"/></p>
<p>加锁：</p>
<ol>
<li>通过ReentrantLock的加锁方法Lock进行加锁操作。</li>
<li>会调用到内部类 Sync的Lock方法，由于Sync#lock是抽象方法，根据 ReentrantLock初始化选择的公平锁和非公平锁，执行相关内部类的Lock方法，本质上都会执行AQS的 Acquire 方法。</li>
<li>AQS的 Acquire 方法会执行 tryAcquire 方法，但是由于tryAcquire需要自定义同步器实现，因此执行了ReentrantLock中的tryAcquire方法，由于ReentrantLock是通过公平锁和非公平锁内部类实现的tryAcquire方法，因此会根据锁类型不同，执行不同的tryAcquire。</li>
<li>tryAcquire是获取锁逻辑，获取失败后，会执行框架AQS的后续逻辑，跟ReentrantLock自定义同步器无关。</li>
</ol>
<p>解锁：</p>
<ol>
<li>通过ReentrantLock的解锁方法Unlock进行解锁。</li>
<li>Unlock会调用内部类Sync的Release方法，该方法继承于AQS。</li>
<li>Release中会调用tryRelease方法，tryRelease需要自定义同步器实现，tryRelease只在ReentrantLock中的Sync实现，因此可以看出，释放锁的过程，并不区分是否为公平锁。</li>
<li>释放成功后，所有处理由AQS框架完成，与自定义同步器无关。</li>
</ol>
<h3 data-id="heading-9">acquire(int)</h3>
<p>此方法是独占模式下线程获取共享资源的顶层入口。如果获取到资源，线程直接返回，否则进入等待队列，直到获取到资源为止，且整个过程忽略中断的影响。这也正是lock()的语义，当然不仅仅只限于lock()。获取到资源后，线程就可以去执行其临界区代码了。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">acquire</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
     <span class="hljs-keyword">if</span> (!tryAcquire(arg) &amp;&amp;
         acquireQueued(addWaiter(Node.EXCLUSIVE), arg))
         selfInterrupt();
}
</code></pre>
<p>函数流程如下：</p>
<ol>
<li>tryAcquire()尝试直接去获取资源，如果成功则直接返回（这里体现了非公平锁，每个线程获取锁时会尝试直接抢占加塞一次，而CLH队列中可能还有别的线程在等待）；</li>
<li>addWaiter()将该线程加入等待队列的尾部，并标记为独占模式；</li>
<li>acquireQueued()使线程阻塞在等待队列中获取资源，一直获取到资源后才返回。如果在整个等待过程中被中断过，则返回true，否则返回false。</li>
<li>如果线程在等待过程中被中断过，它是不响应的。只是获取资源后才再进行自我中断selfInterrupt()，将中断补上。</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ff591e3c65f4ba7b6927bf38ebb73ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200857&amp;x-signature=bxD5WU2Vqv2BdY1XtgCRnvdJ9Ws%3D" alt="" loading="lazy"/></p>
<p>关于整个函数流程详解，可以往下看</p>
<h4 data-id="heading-10">tryAcquire(int)</h4>
<p>此方法尝试去获取独占资源。如果获取成功，则直接返回true，否则直接返回false。这也正是tryLock()的语义，当然不仅仅只限于tryLock()。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
     <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>();
}
</code></pre>
<p>这里是AQS的方法，所以直接throw异常，而没有具体的实现。原因就在于AQS只是一个框架，具体资源的获取/释放方式交由自定义同步器去实现。</p>
<p>这里之所以没有定义成abstract，是因为独占模式下只用实现tryAcquire-tryRelease，而共享模式下只用实现tryAcquireShared-tryReleaseShared。如果都定义成abstract，那么每个模式也要去实现另一模式下的接口。</p>
<p><strong>ReentrantLock实现公平锁非公平锁则主要体现在tryAcquire的实现上：</strong></p>
<p>公平锁中实现的tryAcquire：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
    <span class="hljs-keyword">final</span> <span class="hljs-type">Thread</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> Thread.currentThread();
    <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState();
    <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) {
           <span class="hljs-keyword">if</span> (!hasQueuedPredecessors() &amp;&amp;  <span class="hljs-comment">//公平锁加锁时判断等待队列中是否存在有效节点的方法</span>
                compareAndSetState(<span class="hljs-number">0</span>, acquires)) {
                setExclusiveOwnerThread(current);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
           }
     }
     <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (current == getExclusiveOwnerThread()) {
           <span class="hljs-type">int</span> <span class="hljs-variable">nextc</span> <span class="hljs-operator">=</span> c + acquires;
           <span class="hljs-keyword">if</span> (nextc &lt; <span class="hljs-number">0</span>)
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Maximum lock count exceeded"</span>);
           setState(nextc);
           <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
     }
     <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<p>非公平锁中实现的tryAcquire：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
    <span class="hljs-keyword">return</span> nonfairTryAcquire(acquires);
}

<span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">nonfairTryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
     <span class="hljs-keyword">final</span> <span class="hljs-type">Thread</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> Thread.currentThread();
     <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState();
     <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) {
           <span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, acquires)) {
               setExclusiveOwnerThread(current);
               <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
           }
      }
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (current == getExclusiveOwnerThread()) {
           <span class="hljs-type">int</span> <span class="hljs-variable">nextc</span> <span class="hljs-operator">=</span> c + acquires;
           <span class="hljs-keyword">if</span> (nextc &lt; <span class="hljs-number">0</span>) <span class="hljs-comment">// overflow</span>
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Maximum lock count exceeded"</span>);
           setState(nextc);
           <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      }
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<ul>
<li>
<p>公平锁中多了一层 !hasQueuedPredecessors() 的判断，这是公平锁加锁时判断等待队列中是否存在有效节点的方法。如果返回False，说明当前线程可以获取共享资源；如果返回True，说明队列中存在有效节点，当前线程必须加入到等待队列中。</p>
</li>
<li>
<p>而在非公平锁中，没有这个判断，直接尝试获取锁，能获取到锁则不用加入等待队列。</p>
</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasQueuedPredecessors</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// The correctness of this depends on head being initialized</span>
        <span class="hljs-comment">// before tail and on head.next being accurate if the current</span>
        <span class="hljs-comment">// thread is first in queue.</span>
        <span class="hljs-type">Node</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> tail; <span class="hljs-comment">// Read fields in reverse initialization order</span>
        <span class="hljs-type">Node</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> head;
        Node s;
        <span class="hljs-keyword">return</span> h != t &amp;&amp; ((s = h.next) == <span class="hljs-literal">null</span> || s.thread != Thread.currentThread());
}
</code></pre>
<p>这里的判断 h != t &amp;&amp; ((s = h.next) == null || s.thread != Thread.currentThread());为什么要判断的头结点的下一个节点？第一个节点储存的数据是什么？</p>
<p>双向链表中，第一个节点为虚节点，其实并不存储任何信息，只是占位。真正的第一个有数据的节点，是在第二个节点开始的。当h != t时： 如果(s = h.next) == null，等待队列正在有线程进行初始化，但只是进行到了Tail指向Head，没有将Head指向Tail，此时队列中有元素，需要返回True。 如果(s = h.next) != null，说明此时队列中至少有一个有效节点。如果此时s.thread == Thread.currentThread()，说明等待队列的第一个有效节点中的线程与当前线程相同，那么当前线程是可以获取资源的；如果s.thread != Thread.currentThread()，说明等待队列的第一个有效节点线程与当前线程不同，当前线程必须加入进等待队列。</p>
<h4 data-id="heading-11">addWaiter(Node)</h4>
<p>此方法用于将当前线程加入到等待队列的队尾，并返回当前线程所在的结点。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> Node <span class="hljs-title function_">addWaiter</span><span class="hljs-params">(Node mode)</span> {
    <span class="hljs-comment">//以给定模式构造结点。mode有两种：EXCLUSIVE（独占）和SHARED（共享）</span>
    <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(Thread.currentThread(), mode);

    <span class="hljs-comment">//尝试快速方式直接放到队尾。</span>
    <span class="hljs-type">Node</span> <span class="hljs-variable">pred</span> <span class="hljs-operator">=</span> tail;
    <span class="hljs-keyword">if</span> (pred != <span class="hljs-literal">null</span>) {
        node.prev = pred;
        <span class="hljs-keyword">if</span> (compareAndSetTail(pred, node)) {
            pred.next = node;
            <span class="hljs-keyword">return</span> node;
        }
    }

    <span class="hljs-comment">//上一步失败则通过enq入队。</span>
    enq(node);
    <span class="hljs-keyword">return</span> node;
}
</code></pre>
<p>主要的流程如下：</p>
<ol>
<li>通过当前的线程和锁模式新建一个节点。</li>
<li>Pred指针指向尾节点Tail。</li>
<li>将New中Node的Prev指针指向Pred。</li>
<li>通过compareAndSetTail方法，完成尾节点的设置。这个方法主要是对tailOffset和Expect进行比较，如果tailOffset的Node和Expect的Node地址是相同的，那么设置Tail的值为Update的值。</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// java.util.concurrent.locks.AbstractQueuedSynchronizer</span>

<span class="hljs-keyword">static</span> {
    <span class="hljs-keyword">try</span> {
        stateOffset = unsafe.objectFieldOffset(AbstractQueuedSynchronizer.class.getDeclaredField(<span class="hljs-string">"state"</span>));
        headOffset = unsafe.objectFieldOffset(AbstractQueuedSynchronizer.class.getDeclaredField(<span class="hljs-string">"head"</span>));
        tailOffset = unsafe.objectFieldOffset(AbstractQueuedSynchronizer.class.getDeclaredField(<span class="hljs-string">"tail"</span>));
        waitStatusOffset = unsafe.objectFieldOffset(Node.class.getDeclaredField(<span class="hljs-string">"waitStatus"</span>));
        nextOffset = unsafe.objectFieldOffset(Node.class.getDeclaredField(<span class="hljs-string">"next"</span>));
    } <span class="hljs-keyword">catch</span> (Exception ex) { 
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(ex); 
  }
}
</code></pre>
<p>从AQS的静态代码块可以看出，都是获取一个对象的属性相对于该对象在内存当中的偏移量，这样我们就可以根据这个偏移量在对象内存当中找到这个属性。tailOffset指的是tail对应的偏移量，所以这个时候会将new出来的Node置为当前队列的尾节点。同时，由于是双向链表，也需要将前一个节点指向尾节点。</p>
<p>如果Pred指针是Null（说明等待队列中没有元素），或者当前Pred指针和Tail指向的位置不同（说明被别的线程已经修改）,就需要enq入队</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> Node <span class="hljs-title function_">enq</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Node node)</span> {
    <span class="hljs-comment">//CAS"自旋"，直到成功加入队尾</span>
    <span class="hljs-keyword">for</span> (;;) {
        <span class="hljs-type">Node</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> tail;
        <span class="hljs-keyword">if</span> (t == <span class="hljs-literal">null</span>) { <span class="hljs-comment">// 队列为空，创建一个空的标志结点作为head结点，并将tail也指向它。</span>
            <span class="hljs-keyword">if</span> (compareAndSetHead(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>()))
                tail = head;
        } <span class="hljs-keyword">else</span> {<span class="hljs-comment">//正常流程，放入队尾</span>
            node.prev = t;
            <span class="hljs-keyword">if</span> (compareAndSetTail(t, node)) {
                t.next = node;
                <span class="hljs-keyword">return</span> t;
            }
        }
    }
}
</code></pre>
<p>如果没有被初始化，需要进行初始化一个头结点出来。但请注意，初始化的头结点并不是当前线程节点，而是调用了无参构造函数的节点。如果经历了初始化或者并发导致队列中有元素，则与之前的方法相同。其实，addWaiter就是一个在双端链表添加尾节点的操作，需要注意的是，双端链表的头结点是一个无参构造函数的头结点。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5ffb9ee6ff24b45ab4b1832ce58d18c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200857&amp;x-signature=urK7snC5wxg2GF%2BGnNkqDZbhJ2U%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-12">acquireQueued(Node, int)</h4>
<p>通过tryAcquire()和addWaiter()，该线程获取资源失败，已经被放入等待队列尾部了。addWaiter()返回的是一个包含该线程的Node。而这个Node会作为参数，进入到acquireQueued方法中。acquireQueued方法可以对排队中的线程进行“获锁”操作。那么下一步就是：如果获取不到锁，那么就进入阻塞状态休息，直到其他线程彻底释放资源后唤醒自己，自己再拿到资源，然后就可以去干自己想干的事了。</p>
<p>acquireQueued：在等待队列中排队拿号（中间没其它事干可以阻塞休息），直到拿到号后再返回。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">acquireQueued</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Node node, <span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-type">boolean</span> <span class="hljs-variable">failed</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;<span class="hljs-comment">//标记是否成功拿到资源</span>
    <span class="hljs-keyword">try</span> {
        <span class="hljs-type">boolean</span> <span class="hljs-variable">interrupted</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<span class="hljs-comment">//标记等待过程中是否被中断过</span>

        <span class="hljs-comment">//CAS“自旋”！</span>
        <span class="hljs-keyword">for</span> (;;) {
            <span class="hljs-keyword">final</span> <span class="hljs-type">Node</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> node.predecessor();<span class="hljs-comment">//拿到前驱</span>
            <span class="hljs-comment">//如果前驱是head，即该结点已成老二，那么便有资格去尝试获取资源，也就是当前节点在真实数据队列的首部，就尝试获取锁（别忘了头结点是虚节点）。</span>
            <span class="hljs-keyword">if</span> (p == head &amp;&amp; tryAcquire(arg)) {
                setHead(node);<span class="hljs-comment">// 获取锁成功，头指针移动到当前node</span>
                p.next = <span class="hljs-literal">null</span>; <span class="hljs-comment">// setHead中node.prev已置为null，此处再将head.next置为null，就是为了方便GC回收以前的head结点。也就意味着之前拿完资源的结点出队了！</span>
                failed = <span class="hljs-literal">false</span>; <span class="hljs-comment">// 成功获取资源</span>
                <span class="hljs-keyword">return</span> interrupted;<span class="hljs-comment">//返回等待过程中是否被中断过</span>
            }

            <span class="hljs-comment">// 说明p为头节点且当前没有获取到锁（可能是非公平锁被抢占了）或者 是p不为头结点，这个时候就要判断当前node是否要被阻塞（被阻塞条件：前驱节点的waitStatus为-1），防止无限循环浪费资源。</span>
            <span class="hljs-keyword">if</span> (shouldParkAfterFailedAcquire(p, node) &amp;&amp;
                parkAndCheckInterrupt())
                interrupted = <span class="hljs-literal">true</span>;<span class="hljs-comment">//如果等待过程中被中断过，哪怕只有那么一次，就将interrupted标记为true</span>
        }
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-keyword">if</span> (failed) <span class="hljs-comment">//说明发生了意料之外的异常，将节点移除，避免影响到其他节点</span>
            cancelAcquire(node);
    }
}
</code></pre>
<p>setHead方法是把当前节点置为虚节点，但并没有修改waitStatus，因为它是一直需要用的数据。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// java.util.concurrent.locks.AbstractQueuedSynchronizer</span>

<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setHead</span><span class="hljs-params">(Node node)</span> {
    head = node;
    node.thread = <span class="hljs-literal">null</span>;
    node.prev = <span class="hljs-literal">null</span>;
}
</code></pre>
<p>acquireQueued函数的具体流程：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/047ea0d698b14f0f91a949588bf92f67~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200857&amp;x-signature=2g7dUU%2FnmmEoqA5aZe4toBjnjv0%3D" alt="" loading="lazy"/></p>
<p>从上图可以看出，跳出当前循环的条件是当“前置节点是头结点，且当前线程获取锁成功”。为了防止因死循环导致CPU资源被浪费，我们会判断前置节点的状态来决定是否要将当前线程挂起，shouldParkAfterFailedAcquire代码：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// java.util.concurrent.locks.AbstractQueuedSynchronizer</span>

<span class="hljs-comment">// 靠前驱节点判断当前线程是否应该被阻塞</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">shouldParkAfterFailedAcquire</span><span class="hljs-params">(Node pred, Node node)</span> {
        <span class="hljs-comment">// 获取头结点的节点状态</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">ws</span> <span class="hljs-operator">=</span> pred.waitStatus;
        <span class="hljs-comment">// 说明头结点处于唤醒状态</span>
        <span class="hljs-keyword">if</span> (ws == Node.SIGNAL)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; 
        <span class="hljs-comment">// 通过枚举值我们知道waitStatus&gt;0是取消状态</span>
        <span class="hljs-keyword">if</span> (ws &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">do</span> {
                <span class="hljs-comment">// 循环向前查找取消节点，把取消节点从队列中剔除</span>
                node.prev = pred = pred.prev;
            } <span class="hljs-keyword">while</span> (pred.waitStatus &gt; <span class="hljs-number">0</span>);
            pred.next = node;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// 设置前任节点等待状态为SIGNAL</span>
            compareAndSetWaitStatus(pred, ws, Node.SIGNAL);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<p>parkAndCheckInterrupt主要用于挂起当前线程，阻塞调用栈，返回当前线程的中断状态。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// java.util.concurrent.locks.AbstractQueuedSynchronizer</span>

<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">parkAndCheckInterrupt</span><span class="hljs-params">()</span> {
    LockSupport.park(<span class="hljs-built_in">this</span>);<span class="hljs-comment">//调用park()使线程进入waiting状态</span>
    <span class="hljs-keyword">return</span> Thread.interrupted();<span class="hljs-comment">//如果被唤醒，查看自己是不是被中断的。</span>
}
</code></pre>
<p>具体挂起流程用流程图表示如下（shouldParkAfterFailedAcquire流程）：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e221898716b94ddc80ae395a89981c2a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200857&amp;x-signature=kGQE5fvRcg7jUlVpHtPgfXRIGOk%3D" alt="" loading="lazy"/></p>
<p>整个流程中，如果前驱结点的状态不是SIGNAL，那么自己就不能安心去休息，需要去找个安心的休息点，同时可以再尝试下看有没有机会轮到自己拿号。</p>
<p>park()会让当前线程进入waiting状态。在此状态下，有两种途径可以唤醒该线程：1）被unpark()；2）被interrupt()。需要注意的是，Thread.interrupted()会清除当前线程的中断标记位。</p>
<p>那么shouldParkAfterFailedAcquire中取消节点是怎么生成的呢？什么时候会把一个节点的waitStatus设置为-1？</p>
<p>是在什么时间释放节点通知到被挂起的线程呢？</p>
<h4 data-id="heading-13">CANCELLED状态节点生成</h4>
<p>回看acquireQueued方法中的Finally代码：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// java.util.concurrent.locks.AbstractQueuedSynchronizer</span>

<span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">acquireQueued</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Node node, <span class="hljs-type">int</span> arg)</span> {
        <span class="hljs-type">boolean</span> <span class="hljs-variable">failed</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">try</span> {
        ...
            <span class="hljs-keyword">for</span> (;;) {
                <span class="hljs-keyword">final</span> <span class="hljs-type">Node</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> node.predecessor();
                <span class="hljs-keyword">if</span> (p == head &amp;&amp; tryAcquire(arg)) {
                    ...
                    failed = <span class="hljs-literal">false</span>;
                    ...
                }
                ...
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-keyword">if</span> (failed)
                cancelAcquire(node);
            }
}
</code></pre>
<p>显然，当failed为true时才会执行方法cancelAcquire，那什么情况下failed为true呢？try代码段执行过程中出现异常。</p>
<blockquote>
<p>这里不知道哪里会出现异常？假设tryAcquire出现的异常，那么acquire方法就已经不会往后执行，也就不会执行到acquireQueued</p>
</blockquote>
<p>通过cancelAcquire方法，将Node的状态标记为CANCELLED。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// java.util.concurrent.locks.AbstractQueuedSynchronizer</span>

<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cancelAcquire</span><span class="hljs-params">(Node node)</span> {
  <span class="hljs-comment">// 将无效节点过滤</span>
    <span class="hljs-keyword">if</span> (node == <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span>;
  <span class="hljs-comment">// 设置该节点不关联任何线程，也就是虚节点</span>
    node.thread = <span class="hljs-literal">null</span>;
    <span class="hljs-type">Node</span> <span class="hljs-variable">pred</span> <span class="hljs-operator">=</span> node.prev;
  <span class="hljs-comment">// 通过前驱节点，跳过取消状态的node</span>
    <span class="hljs-keyword">while</span> (pred.waitStatus &gt; <span class="hljs-number">0</span>)
        node.prev = pred = pred.prev;
  <span class="hljs-comment">// 获取过滤后的前驱节点的后继节点</span>
    <span class="hljs-type">Node</span> <span class="hljs-variable">predNext</span> <span class="hljs-operator">=</span> pred.next;
  <span class="hljs-comment">// 把当前node的状态设置为CANCELLED</span>
    node.waitStatus = Node.CANCELLED;
  <span class="hljs-comment">// 如果当前节点是尾节点，将从后往前的第一个非取消状态的节点设置为尾节点</span>
  <span class="hljs-comment">// 更新失败的话，则进入else，如果更新成功，将tail的后继节点设置为null</span>
    <span class="hljs-keyword">if</span> (node == tail &amp;&amp; compareAndSetTail(node, pred)) {
        compareAndSetNext(pred, predNext, <span class="hljs-literal">null</span>);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-type">int</span> ws;
    <span class="hljs-comment">// 如果当前节点不是head的后继节点，1:判断当前节点前驱节点的是否为SIGNAL，2:如果不是，则把前驱节点设置为SINGAL看是否成功</span>
    <span class="hljs-comment">// 如果1和2中有一个为true，再判断当前节点的线程是否为null</span>
    <span class="hljs-comment">// 如果上述条件都满足，把当前节点的前驱节点的后继指针指向当前节点的后继节点</span>
        <span class="hljs-keyword">if</span> (pred != head &amp;&amp; ((ws = pred.waitStatus) == Node.SIGNAL || (ws &lt;= <span class="hljs-number">0</span> &amp;&amp; compareAndSetWaitStatus(pred, ws, Node.SIGNAL))) &amp;&amp; pred.thread != <span class="hljs-literal">null</span>) {
            <span class="hljs-type">Node</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> node.next;
            <span class="hljs-keyword">if</span> (next != <span class="hljs-literal">null</span> &amp;&amp; next.waitStatus &lt;= <span class="hljs-number">0</span>)
                compareAndSetNext(pred, predNext, next);
        } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// 如果当前节点是head的后继节点，或者上述条件不满足，那就唤醒当前节点的后继节点</span>
            unparkSuccessor(node);
        }
        node.next = node; <span class="hljs-comment">// help GC</span>
    }
}
</code></pre>
<p>cancelAcquire方法的流程：</p>
<ol>
<li>
<p>获取当前节点的前驱节点，如果前驱节点的状态是CANCELLED，那就一直往前遍历，找到第一个waitStatus &lt;= 0的节点，将找到的Pred节点和当前Node关联，将当前Node设置为CANCELLED。</p>
</li>
<li>
<p>根据当前节点的位置，考虑以下三种情况：</p>
<ol>
<li>
<p>当前节点是尾节点。</p>
</li>
<li>
<p>当前节点是Head的后继节点。</p>
</li>
<li>
<p>当前节点不是Head的后继节点，也不是尾节点。</p>
</li>
</ol>
</li>
</ol>
<p>当前节点是尾节点：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8db4c3d46070470dbd7fc32b27e65cb9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200857&amp;x-signature=EemnUnbSyJPuCoduuzPB0lFdTAQ%3D" alt="" loading="lazy"/></p>
<p>当前节点是Head的后继节点：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef09f8997e3b45aba5f0e10b30fd2660~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200857&amp;x-signature=aGnFZRJfkANJNrsFOZow53LqdeE%3D" alt="" loading="lazy"/></p>
<p>当前节点不是Head的后继节点，也不是尾节点：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d789cc2672c947b0bd2f64aae3ab2165~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200857&amp;x-signature=ijC6yuVQ%2FEWMivjn7FokjOI18kM%3D" alt="" loading="lazy"/></p>
<p>通过上面的流程，我们对于CANCELLED节点状态的产生和变化已经有了大致的了解，但是为什么所有的变化都是对Next指针进行了操作，而没有对Prev指针进行操作呢？什么情况下会对Prev指针进行操作？</p>
<p>执行cancelAcquire的时候，当前节点的前置节点可能已经从队列中出去了（已经执行过Try代码块中的shouldParkAfterFailedAcquire方法了），如果此时修改Prev指针，有可能会导致Prev指向另一个已经移除队列的Node，因此这块变化Prev指针不安全。</p>
<p>shouldParkAfterFailedAcquire方法中，会执行下面的代码，其实就是在处理Prev指针。shouldParkAfterFailedAcquire是获取锁失败的情况下才会执行，进入该方法后，说明共享资源已被获取，当前节点之前的节点都不会出现变化，因此这个时候变更Prev指针比较安全。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">do</span> {
    node.prev = pred = pred.prev;
} <span class="hljs-keyword">while</span> (pred.waitStatus &gt; <span class="hljs-number">0</span>);
</code></pre>
<h3 data-id="heading-14">release(int)</h3>
<p>此方法是独占模式下线程释放共享资源的顶层入口。它会释放指定量的资源，如果彻底释放了（即state=0）,它会唤醒等待队列里的其他线程来获取资源。这也正是unlock()的语义，当然不仅仅只限于unlock()。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">release</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">if</span> (tryRelease(arg)) {
        <span class="hljs-type">Node</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> head;<span class="hljs-comment">//找到头结点</span>
        <span class="hljs-comment">// 头结点不为空并且头结点的waitStatus不是初始化节点情况，解除线程挂起状态</span>
        <span class="hljs-keyword">if</span> (h != <span class="hljs-literal">null</span> &amp;&amp; h.waitStatus != <span class="hljs-number">0</span>)
            unparkSuccessor(h);<span class="hljs-comment">//唤醒等待队列里的下一个线程</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<p>根据tryRelease()的返回值来判断该线程是否已经完成释放掉资源了！所以自定义同步器在设计tryRelease()</p>
<p>这里的判断条件为什么是h != null &amp;&amp; h.waitStatus != 0？</p>
<ul>
<li>
<p>h null Head还没初始化。初始情况下，head null，第一个节点入队，Head会被初始化一个虚拟节点。所以说，这里如果还没来得及入队，就会出现head == null 的情况。</p>
</li>
<li>
<p>h != null &amp;&amp; waitStatus == 0 表明后继节点对应的线程仍在运行中，不需要唤醒。</p>
</li>
<li>
<p>h != null &amp;&amp; waitStatus &lt; 0 表明后继节点可能被阻塞了，需要唤醒。</p>
</li>
</ul>
<h4 data-id="heading-15">tryRelease(int)</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>();
}
</code></pre>
<p>跟tryAcquire()一样，这个方法是需要独占模式的自定义同步器去实现的。正常来说，tryRelease()都会成功的，因为这是独占模式，该线程来释放资源，那么它肯定已经拿到独占资源了，直接减掉相应量的资源即可(state-=arg)，也不需要考虑线程安全的问题。但要注意它的返回值，上面已经提到了，release()是根据tryRelease()的返回值来判断该线程是否已经完成释放掉资源了！所以自义定同步器在实现时，如果已经彻底释放资源(state=0)，要返回true，否则返回false。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// java.util.concurrent.locks.ReentrantLock.Sync#tryRelease</span>

<span class="hljs-meta">@ReservedStackAccess</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> releases)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState() - releases;<span class="hljs-comment">//在未重入的情况下，getState() = 1，减去releases 1，因此c 为 0</span>
    <span class="hljs-keyword">if</span> (Thread.currentThread() != getExclusiveOwnerThread())
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();
    <span class="hljs-type">boolean</span> <span class="hljs-variable">free</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) {
        free = <span class="hljs-literal">true</span>;
        setExclusiveOwnerThread(<span class="hljs-literal">null</span>);<span class="hljs-comment">//独占锁线程设置为null</span>
    }
    setState(c);<span class="hljs-comment">//恢复默认</span>
    <span class="hljs-keyword">return</span> free;
}
</code></pre>
<h4 data-id="heading-16">unparkSuccessor(Node)</h4>
<p>此方法用于唤醒等待队列中下一个线程。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unparkSuccessor</span><span class="hljs-params">(Node node)</span> {
    <span class="hljs-comment">//这里，node一般为当前线程所在的结点。</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">ws</span> <span class="hljs-operator">=</span> node.waitStatus;
    <span class="hljs-keyword">if</span> (ws &lt; <span class="hljs-number">0</span>)<span class="hljs-comment">//置零当前线程所在的结点状态，允许失败。</span>
        compareAndSetWaitStatus(node, ws, <span class="hljs-number">0</span>);

    <span class="hljs-type">Node</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> node.next;<span class="hljs-comment">//找到下一个需要唤醒的结点s</span>
    <span class="hljs-keyword">if</span> (s == <span class="hljs-literal">null</span> || s.waitStatus &gt; <span class="hljs-number">0</span>) {<span class="hljs-comment">//如果为空或已取消</span>
        s = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">Node</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> tail; t != <span class="hljs-literal">null</span> &amp;&amp; t != node; t = t.prev) <span class="hljs-comment">// 从后向前找。</span>
            <span class="hljs-keyword">if</span> (t.waitStatus &lt;= <span class="hljs-number">0</span>)<span class="hljs-comment">//从这里可以看出，&lt;=0的结点，都是还有效的结点。</span>
                s = t;
    }
    <span class="hljs-keyword">if</span> (s != <span class="hljs-literal">null</span>)
        LockSupport.unpark(s.thread);<span class="hljs-comment">//唤醒</span>
}
</code></pre>
<p>这个函数并不复杂。一句话概括：用unpark()唤醒等待队列中最前边的那个未放弃线程s。此时，再和acquireQueued()联系起来，s被唤醒后，进入if (p == head &amp;&amp; tryAcquire(arg))的判断（即使p!=head也没关系，它会再进入shouldParkAfterFailedAcquire()寻找一个安全点。这里既然s已经是等待队列中最前边的那个未放弃线程了，那么通过shouldParkAfterFailedAcquire()的调整，s也必然会跑到head的next结点，下一次自旋p==head就成立了），然后s把自己设置成head标杆结点，表示自己已经获取到资源了，acquire()也返回了！</p>
<p>在队列中查找时是从后向前找的，为什么这么做？</p>
<p>从源码上看，先找到后继结点s，如果s状态正常那么直接唤醒。但有两种异常情况，会导致next链不一致：</p>
<ol>
<li>s==null，在新结点入队时可能会出现</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a9015d7fe854fa4b32a2bb53f99a4ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200857&amp;x-signature=NttgDDzxjtPjFHIUQfpwOllgMZ8%3D" alt="" loading="lazy"/></p>
<ol start="2">
<li>s.waitStatus &gt; 0，中间有节点取消时会出现（如超时）</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92fc11b61ed0408e80f44d443377370e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771200857&amp;x-signature=S%2B3mwqtsORy1ubDRtK%2BGbit43ao%3D" alt="" loading="lazy"/></p>
<p>关于并发问题，addWaiter()入队操作和cancelAcquire()取消排队操作都会造成next链的不一致，而prev链是强一致的，所以这时从后往前找是最安全的。</p>
<blockquote>
<p>为什么prev链是强一致的？</p>
<p>因为addWaiter()里每次compareAndSetTail(pred, node)之前都有node.prev = pred，即使compareAndSetTail失败，enq()会反复尝试，直到成功。一旦compareAndSetTail成功，该node.prev就成功挂在之前的tail结点上了，而且是唯一的，这时其他新结点的prev只能尝试往新tail结点上挂。这里的组合用法非常巧妙，能保证CAS之前的prev链强一致，但不能保证CAS后的next链强一致。</p>
</blockquote>
<h3 data-id="heading-17">acquireShared(int)</h3>
<p>此方法是共享模式下线程获取共享资源的顶层入口。它会获取指定量的资源，获取成功则直接返回，获取失败则进入等待队列，直到获取到资源为止，整个过程忽略中断。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">acquireShared</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
     <span class="hljs-keyword">if</span> (tryAcquireShared(arg) &lt; <span class="hljs-number">0</span>)
        doAcquireShared(arg);
}
</code></pre>
<p>这里tryAcquireShared()依然需要自定义同步器去实现。但是AQS已经把其返回值的语义定义好了：负值代表获取失败；0代表获取成功，但没有剩余资源；正数表示获取成功，还有剩余资源，其他线程还可以去获取。所以这里acquireShared()的流程就是：</p>
<ol>
<li>tryAcquireShared()尝试获取资源，成功则直接返回；</li>
<li>失败则通过doAcquireShared()进入等待队列，直到获取到资源为止才返回。</li>
</ol>
<h4 data-id="heading-18">doAcquireShared(int)</h4>
<p>此方法用于将当前线程加入等待队列尾部休息，直到其他线程释放资源唤醒自己，自己成功拿到相应量的资源后才返回。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doAcquireShared</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">final</span> <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> addWaiter(Node.SHARED);<span class="hljs-comment">//加入队列尾部</span>
    <span class="hljs-type">boolean</span> <span class="hljs-variable">failed</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;<span class="hljs-comment">//是否成功标志</span>
    <span class="hljs-keyword">try</span> {
        <span class="hljs-type">boolean</span> <span class="hljs-variable">interrupted</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<span class="hljs-comment">//等待过程中是否被中断过的标志</span>
        <span class="hljs-keyword">for</span> (;;) {
            <span class="hljs-keyword">final</span> <span class="hljs-type">Node</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> node.predecessor();<span class="hljs-comment">//前驱</span>
            <span class="hljs-keyword">if</span> (p == head) {<span class="hljs-comment">//如果到head的下一个，因为head是拿到资源的线程，此时node被唤醒，很可能是head用完资源来唤醒自己的</span>
                <span class="hljs-type">int</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> tryAcquireShared(arg);<span class="hljs-comment">//尝试获取资源</span>
                <span class="hljs-keyword">if</span> (r &gt;= <span class="hljs-number">0</span>) {<span class="hljs-comment">//成功</span>
                    setHeadAndPropagate(node, r);<span class="hljs-comment">//将head指向自己，还有剩余资源可以再唤醒之后的线程</span>
                    p.next = <span class="hljs-literal">null</span>; <span class="hljs-comment">// help GC</span>
                    <span class="hljs-keyword">if</span> (interrupted)<span class="hljs-comment">//如果等待过程中被打断过，此时将中断补上。</span>
                        selfInterrupt();
                    failed = <span class="hljs-literal">false</span>;
                    <span class="hljs-keyword">return</span>;
                }
            }

            <span class="hljs-comment">//判断状态，寻找安全点，进入waiting状态，等着被unpark()或interrupt()</span>
            <span class="hljs-keyword">if</span> (shouldParkAfterFailedAcquire(p, node) &amp;&amp;
                parkAndCheckInterrupt())
                interrupted = <span class="hljs-literal">true</span>;
        }
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-keyword">if</span> (failed)
            cancelAcquire(node);
    }
}
</code></pre>
<p>这里跟acquireQueued()的流程并没有太大区别。只不过这里将补中断的selfInterrupt()放到doAcquireShared()里了，而独占模式是放到acquireQueued()之外，但实际上都一样。</p>
<p>跟独占模式比，还有一点需要注意的是，这里只有线程是head.next时（“老二”），才会去尝试获取资源，有剩余的话还会唤醒之后的队友。</p>
<p>那么问题就来了，假如老大用完后释放了5个资源，而老二需要6个，老三需要1个，老四需要2个。老大先唤醒老二，老二一看资源不够，他是把资源让给老三呢，还是不让？答案是否定的！老二会继续park()等待其他线程释放资源，也更不会去唤醒老三和老四了。独占模式，同一时刻只有一个线程去执行，这样做未尝不可；但共享模式下，多个线程是可以同时执行的，现在因为老二的资源需求量大，而把后面量小的老三和老四也都卡住了。当然，这并不是问题，只是AQS保证严格按照入队顺序唤醒罢了（保证公平，但降低了并发）。</p>
<p>setHeadAndPropagate(Node, int):此方法在setHead()的基础上多了一步，就是自己苏醒的同时，如果条件符合（比如还有剩余资源），还会去唤醒后继结点，毕竟是共享模式！</p>
<p>private void setHeadAndPropagate(Node node, int propagate) {</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setHeadAndPropagate</span><span class="hljs-params">(Node node, <span class="hljs-type">int</span> propagate)</span> {
    <span class="hljs-type">Node</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> head;
    setHead(node);<span class="hljs-comment">//head指向自己</span>
     <span class="hljs-comment">//如果还有剩余量，继续唤醒下一个邻居线程</span>
    <span class="hljs-keyword">if</span> (propagate &gt; <span class="hljs-number">0</span> || h == <span class="hljs-literal">null</span> || h.waitStatus &lt; <span class="hljs-number">0</span>) {
        <span class="hljs-type">Node</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> node.next;
        <span class="hljs-keyword">if</span> (s == <span class="hljs-literal">null</span> || s.isShared())
            doReleaseShared();
    }
}
</code></pre>
<h3 data-id="heading-19">releaseShared()</h3>
<p>此方法是共享模式下线程释放共享资源的顶层入口。它会释放指定量的资源，如果成功释放且允许唤醒等待线程，它会唤醒等待队列里的其他线程来获取资源。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">releaseShared</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">if</span> (tryReleaseShared(arg)) {<span class="hljs-comment">//尝试释放资源</span>
        doReleaseShared();<span class="hljs-comment">//唤醒后继结点</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<p>此方法的流程也比较简单，一句话：释放掉资源后，唤醒后继。跟独占模式下的release()相似，但有一点稍微需要注意：独占模式下的tryRelease()在完全释放掉资源（state=0）后，才会返回true去唤醒其他线程，这主要是基于独占下可重入的考量；而共享模式下的releaseShared()则没有这种要求，共享模式实质就是控制一定量的线程并发执行，那么拥有资源的线程在释放掉部分资源时就可以唤醒后继等待结点。例如，资源总量是13，A（5）和B（7）分别获取到资源并发运行，C（4）来时只剩1个资源就需要等待。A在运行过程中释放掉2个资源量，然后tryReleaseShared(2)返回true唤醒C，C一看只有3个仍不够继续等待；随后B又释放2个，tryReleaseShared(2)返回true唤醒C，C一看有5个够自己用了，然后C就可以跟A和B一起运行。而ReentrantReadWriteLock读锁的tryReleaseShared()只有在完全释放掉资源（state=0）才返回true，所以自定义同步器可以根据需要决定tryReleaseShared()的返回值</p>
<h4 data-id="heading-20">doReleaseShared()</h4>
<p>此方法主要用于唤醒后继</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doReleaseShared</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">for</span> (;;) {
        <span class="hljs-type">Node</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> head;
        <span class="hljs-keyword">if</span> (h != <span class="hljs-literal">null</span> &amp;&amp; h != tail) {
            <span class="hljs-type">int</span> <span class="hljs-variable">ws</span> <span class="hljs-operator">=</span> h.waitStatus;
            <span class="hljs-keyword">if</span> (ws == Node.SIGNAL) {
                <span class="hljs-keyword">if</span> (!compareAndSetWaitStatus(h, Node.SIGNAL, <span class="hljs-number">0</span>))
                    <span class="hljs-keyword">continue</span>;
                unparkSuccessor(h);<span class="hljs-comment">//唤醒后继</span>
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ws == <span class="hljs-number">0</span> &amp;&amp;
                     !compareAndSetWaitStatus(h, <span class="hljs-number">0</span>, Node.PROPAGATE))
                <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">if</span> (h == head)<span class="hljs-comment">// head发生变化</span>
            <span class="hljs-keyword">break</span>;
    }
}
</code></pre>
<h2 data-id="heading-21">应用</h2>
<p>Mutex是一个不可重入的互斥锁实现。锁资源（AQS里的state）只有两种状态：0表示未锁定，1表示锁定。核心源码：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Mutex</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Lock</span>, java.io.Serializable {
    <span class="hljs-comment">// 自定义同步器</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span> {
        <span class="hljs-comment">// 判断是否锁定状态</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isHeldExclusively</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> getState() == <span class="hljs-number">1</span>;
        }

        <span class="hljs-comment">// 尝试获取资源，立即返回。成功则返回true，否则false。</span>
        <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
            <span class="hljs-keyword">assert</span> acquires == <span class="hljs-number">1</span>; <span class="hljs-comment">// 这里限定只能为1个量</span>
            <span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) {<span class="hljs-comment">//state为0才设置为1，不可重入！</span>
                setExclusiveOwnerThread(Thread.currentThread());<span class="hljs-comment">//设置为当前线程独占资源</span>
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-comment">// 尝试释放资源，立即返回。成功则为true，否则false。</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> releases)</span> {
            <span class="hljs-keyword">assert</span> releases == <span class="hljs-number">1</span>; <span class="hljs-comment">// 限定为1个量</span>
            <span class="hljs-keyword">if</span> (getState() == <span class="hljs-number">0</span>)<span class="hljs-comment">//既然来释放，那肯定就是已占有状态了。只是为了保险，多层判断！</span>
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();
            setExclusiveOwnerThread(<span class="hljs-literal">null</span>);
            setState(<span class="hljs-number">0</span>);<span class="hljs-comment">//释放资源，放弃占有状态</span>
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
    }

    <span class="hljs-comment">// 真正同步类的实现都依赖继承于AQS的自定义同步器！</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Sync</span> <span class="hljs-variable">sync</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sync</span>();

    <span class="hljs-comment">//lock&lt;--&gt;acquire。两者语义一样：获取资源，即便等待，直到成功才返回。</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span> {
        sync.acquire(<span class="hljs-number">1</span>);
    }

    <span class="hljs-comment">//tryLock&lt;--&gt;tryAcquire。两者语义一样：尝试获取资源，要求立即返回。成功则为true，失败则为false。</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sync.tryAcquire(<span class="hljs-number">1</span>);
    }

    <span class="hljs-comment">//unlock&lt;--&gt;release。两者语文一样：释放资源。</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">()</span> {
        sync.release(<span class="hljs-number">1</span>);
    }

    <span class="hljs-comment">//锁是否占有状态</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isLocked</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sync.isHeldExclusively();
    }
}
</code></pre>
<p>除了Mutex，ReentrantLock/CountDownLatch/Semphore这些同步类的实现方式都差不多，不同的地方就在获取-释放资源的方式tryAcquire-tryRelelase。</p>
<h2 data-id="heading-22">ReentrantLock 的使用</h2>
<p>ReentrantLock 的使用方式与 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.seven97.top%2Fjava%2Fconcurrent%2F02-keyword1-synchronized.html" target="_blank" title="https://www.seven97.top/java/concurrent/02-keyword1-synchronized.html" ref="nofollow noopener noreferrer">synchronized</a> 关键字类似，都是通过加锁和释放锁来实现同步的。我们来看看 ReentrantLock 的使用方式，以非公平锁为例：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReentrantLockTest</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {
                lock.lock();
                <span class="hljs-keyword">try</span> {
                    count++;
                } <span class="hljs-keyword">finally</span> {
                    lock.unlock();
                }
            }
        });
        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {
                lock.lock();
                <span class="hljs-keyword">try</span> {
                    count++;
                } <span class="hljs-keyword">finally</span> {
                    lock.unlock();
                }
            }
        });
        thread1.start();
        thread2.start();
        thread1.join();
        thread2.join();
        System.out.println(count);
    }
}
</code></pre>
<p>代码很简单，两个线程分别对 count 变量进行 10000 次累加操作，最后输出 count 的值。我们来看看运行结果：</p>
<pre><code class="hljs">20000
</code></pre>
<p>可以看到，两个线程对 count 变量进行了 20000 次累加操作，说明 ReentrantLock 是支持重入性的。再来看看公平锁的使用方式，只需要将 ReentrantLock 的构造方法改为公平锁即可：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>(<span class="hljs-literal">true</span>);
</code></pre>
<p>运行结果为：</p>
<pre><code class="hljs">20000
</code></pre>
<p>可以看到，公平锁的运行结果与非公平锁的运行结果一致，这是因为公平锁的实现方式与非公平锁的实现方式基本一致，只是在获取锁时增加了判断当前节点是否有前驱节点的逻辑判断。</p>
<ul>
<li>公平锁: 按照线程请求锁的顺序获取锁，即先到先得。</li>
<li>非公平锁: 线程获取锁的顺序可能与请求锁的顺序不同，可能导致某些线程获取锁的速度较快。</li>
</ul>
<p>需要注意的是，使用 ReentrantLock 时，锁必须在 try 代码块开始之前获取，并且加锁之前不能有异常抛出，否则在 finally 块中就无法释放锁（ReentrantLock 的锁必须在 finally 中手动释放）。</p>
<p>错误示例：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Lock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XxxLock</span>();
<span class="hljs-comment">// ...</span>
<span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// 如果在此抛出异常，会直接执行 finally 块的代码</span>
    doSomething();
    <span class="hljs-comment">// 不管锁是否成功，finally 块都会执行</span>
    lock.lock();
    doOthers();

} <span class="hljs-keyword">finally</span> {
    lock.unlock();
}
</code></pre>
<p>正确示例：</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Lock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XxxLock</span>();
<span class="hljs-comment">// ...</span>
lock.lock();
<span class="hljs-keyword">try</span> {
    doSomething();
    doOthers();
} <span class="hljs-keyword">finally</span> {
    lock.unlock();
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[春哥的Agent通关秘籍07：5分钟实现文件归类助手【实战】]]></title>    <link>https://juejin.cn/post/7603677143215390735</link>    <guid>https://juejin.cn/post/7603677143215390735</guid>    <pubDate>2026-02-09T00:16:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603677143215390735" data-draft-id="7603854784865108008" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="春哥的Agent通关秘籍07：5分钟实现文件归类助手【实战】"/> <meta itemprop="keywords" content="前端,后端,JavaScript"/> <meta itemprop="datePublished" content="2026-02-09T00:16:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="摸鱼的春哥"/> <meta itemprop="url" content="https://juejin.cn/user/1714893870865303"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            春哥的Agent通关秘籍07：5分钟实现文件归类助手【实战】
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1714893870865303/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    摸鱼的春哥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-09T00:16:51.000Z" title="Mon Feb 09 2026 00:16:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;font-weight:400;line-height:2;font-size:17px;overflow-x:hidden;color:#000}.markdown-body strong{padding:1px;color:#ee3f4d}.markdown-body em{padding:0 2px;color:#f33b1f}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;margin-top:30px;margin-bottom:20px;line-height:1.5;font-weight:700}.markdown-body h1{text-align:center;padding-bottom:5px;font-size:32px;color:#ac1f18}.markdown-body h1:after{content:"";display:block;margin:4px auto 0;width:100px;height:2px;border-bottom:2px solid #f33b1f}.markdown-body h2{font-size:28px;border-bottom:1px solid #f33b1f}.markdown-body h2:before{content:"# "!important;color:#f33b1f}.markdown-body h3{font-size:24px;padding-left:9px;border-left:6px solid #f33b1f}.markdown-body h4{font-size:20px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #bbb;margin:16px 0}.markdown-body code{word-break:break-word;overflow-x:auto;background-color:#f9f1db;color:#ee2746;border-radius:2px;font-size:16px;padding:1px 2px}.markdown-body code,.markdown-body pre{font-family:-apple-system,-apple-system-body,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,PingFang SC,思源黑体 CN,思源黑体,JetBrains Mono,Fira Code,Menlo,Ubuntu Mono,Consolas,sans-serif}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{margin:12px 0!important;border-radius:3px;font-size:15px;padding:16px 12px;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f7f7f7}.markdown-body a{text-decoration:none;color:#1781b5;padding:0 2px;border-bottom:1px solid #1781b5}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #f33b1f;color:#ac1f18}.markdown-body blockquote{color:#3d3d3d;background-color:#fff9f9;padding:6px 16px;margin:16px 0;border-left:3px solid #f07c82}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:6px 0}.markdown-body ol,.markdown-body ul{padding-left:30px}.markdown-body ol li,.markdown-body ul li{margin-bottom:6px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:6px}.markdown-body ol li{padding-left:6px}.markdown-body ::marker{color:#f33b1f}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body .task-list-item input[type=checkbox]{position:relative}.markdown-body .task-list-item input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:#fff;border:1px solid #f07c82;border-radius:3px;box-sizing:border-box;z-index:1}.markdown-body .task-list-item input[type=checkbox]:checked:after{content:"✓";position:absolute;top:-5px;left:0;right:0;bottom:0;width:0;height:0;color:#f33b1f;font-size:16px;font-weight:700;z-index:2}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border-spacing:0;border-collapse:collapse}.markdown-body table thead{background:#fff9f9;color:#000;text-align:left;font-size:15px}.markdown-body table tr:nth-child(2n){background-color:#fcfcfc}.markdown-body table tr:hover{background-color:#fff9f9}.markdown-body table td,.markdown-body table th{padding:12px 7px;line-height:24px;border:1px solid #f9f1db}.markdown-body table td{min-width:120px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="monokai">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#272822;color:#ddd}.hljs-keyword,.hljs-literal,.hljs-name,.hljs-selector-tag,.hljs-strong,.hljs-tag{color:#f92672}.hljs-code{color:#66d9ef}.hljs-class .hljs-title{color:#fff}.hljs-attribute,.hljs-link,.hljs-regexp,.hljs-symbol{color:#bf79db}.hljs-addition,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-emphasis,.hljs-section,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-string,.hljs-subst,.hljs-template-tag,.hljs-template-variable,.hljs-title,.hljs-type,.hljs-variable{color:#a6e22e}.hljs-comment,.hljs-deletion,.hljs-meta,.hljs-quote{color:#75715e}.hljs-doctag,.hljs-keyword,.hljs-literal,.hljs-section,.hljs-selector-id,.hljs-selector-tag,.hljs-title,.hljs-type{font-weight:700}</style><p>上两节课我们学习了关于<code>Function Calling</code>和【思维范式】的各种理论知识和思路。</p>
<p>今天我们直接开始实战。</p>
<p>目标：做一个可以自动归类文件的AI助手。</p>
<p>先看看使用效果！</p>
<p><img src="https://pic.zhangshichun.top/pic/20260206-1.gif" alt="" loading="lazy"/></p>
<p>执行后：
<img src="https://pic.zhangshichun.top/pic/20260207114026811.png" alt="" loading="lazy"/></p>
<p>要做到这一点，至少得满足两个条件：</p>
<ol>
<li>AI能准确知道本地文件夹有哪些文件。</li>
<li>AI能精准操控（移动）本地的文件。</li>
</ol>
<p>而这，无疑就是 <code>Function Calling</code> 最核心的价值所在。</p>
<p>而调用这些 <code>Function</code>，则属于【思维范式】的领域。</p>
<h2 data-id="heading-0">01. 制造混乱</h2>
<p>为了让大家的实践更有参与感，但是又不影响日常的工作，我写了一个脚本，可以一键产生一个混乱无比的文件夹。</p>
<p><img src="https://pic.zhangshichun.top/pic/20260203212814404.png" alt="" loading="lazy"/></p>
<p>执行脚本就能生成如下这样一个混乱的文件夹。</p>
<p><img src="https://pic.zhangshichun.top/pic/20260202205804727.png" alt="" loading="lazy"/></p>
<p>当然，这些文件都没有内容，只是为了模拟更为真实的职场环境。</p>
<p>一键生成模拟文件的脚本在demo工程里，自取：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzhangshichun%2Fai_agent_dev_study%2Fblob%2Fmaster%2Flesson_06%2Fgenerate_files.py" target="_blank" title="https://github.com/zhangshichun/ai_agent_dev_study/blob/master/lesson_06/generate_files.py" ref="nofollow noopener noreferrer">github.com/zhangshichu…</a></p>
<p>执行如下脚本即可：</p>
<pre><code class="hljs">python .\lesson_06\generate_files.py
</code></pre>
<p>这个脚本和本节课关系不大，不展开了。</p>
<h2 data-id="heading-1">02. 梳理思路</h2>
<p>上节课我们提到了 <code>ReAct</code> 思维范式，意思是，让AI按以下范式行动：</p>
<ul>
<li>思考 -&gt; 行动 -&gt; 检查 -&gt; 思考 -&gt; 行动 -&gt; ....</li>
</ul>
<p>但幸运的是，目前的主流LLM模型底层都内置了这种范式，我们甚至可以在大多数时候省略使用提示词来要求这种范式，它们默认就是 ReAct 的。</p>
<p>接下来，我们首先要梳理清楚，我们解决这个问题需要分成几个步骤。</p>
<p><img src="https://pic.zhangshichun.top/pic/20260202204329155.png" alt="" loading="lazy"/></p>
<p>如上图，我们主要有三个核心步骤：</p>
<ol>
<li>提供方法，允许AI读取文件夹内的所有文件</li>
<li>提供方法，允许AI移动文件夹内的文件</li>
<li>构建ReAct 循环，直到AI完成整个任务</li>
</ol>
<h2 data-id="heading-2">03. 实现两个核心tools函数</h2>
<p>这两个函数对于任何可以操作 File System 的编程语言来说，都不算困难。</p>
<p>首先是 <code>list_files</code> 方法，核心代码非常简单：</p>
<pre><code class="hljs language-python" lang="python">        <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> os.listdir(BASE_PATH):
            f_path = os.path.join(BASE_PATH, f)
            <span class="hljs-comment"># 过滤逻辑：只看文件，忽略隐藏文件(.开头)</span>
            <span class="hljs-keyword">if</span> os.path.isfile(f_path) <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> f.startswith(<span class="hljs-string">'.'</span>):
                files.append(f)
        
        <span class="hljs-comment"># 必须返回 JSON 字符串，而不是 Python 列表</span>
        <span class="hljs-keyword">return</span> json.dumps({<span class="hljs-string">"files"</span>: files}, ensure_ascii=<span class="hljs-literal">False</span>)
</code></pre>
<p>稍微需要注意一点的时候，就是最后return出来的不能是数组，而是JSON字符串。</p>
<p>然后是 <code>move_file</code> 函数：</p>
<pre><code class="hljs language-python" lang="python">        <span class="hljs-comment"># 检查源文件</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(source_file):
            <span class="hljs-keyword">return</span> json.dumps({<span class="hljs-string">"error"</span>: <span class="hljs-string">f"文件不存在: <span class="hljs-subst">{filename}</span>"</span>}, ensure_ascii=<span class="hljs-literal">False</span>)

        <span class="hljs-comment"># 检查并创建目标目录</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(target_folder):
            os.makedirs(target_folder)
            
        <span class="hljs-comment"># 移动文件</span>
        shutil.move(source_file, target_file)
</code></pre>
<p>也是非常容易，基本没啥特别要注意的，return 结果的时候序列化成JSON字符串即可。</p>
<h2 data-id="heading-3">04. 定义函数Schema</h2>
<p>这一步是要构建一个【工具清单】以告诉AI，你的本地可以提供哪些有用的方法，分别叫什么名字，有什么用，以及接收哪些参数。</p>
<p><img src="https://pic.zhangshichun.top/pic/20260207120537859.png" alt="" loading="lazy"/></p>
<p>这样，当AI遇到困境的时候，才会想起来调用你本地提供的方法。</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 工具定义 (供 LLM 阅读)</span>
tools_schema = [
    {
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"function"</span>,
        <span class="hljs-string">"function"</span>: {
            <span class="hljs-comment"># 方法名</span>
            <span class="hljs-string">"name"</span>: <span class="hljs-string">"list_files"</span>,
            <span class="hljs-comment"># 方法描述</span>
            <span class="hljs-string">"description"</span>: <span class="hljs-string">"查看当前文件夹里有哪些文件待处理。"</span>,
            <span class="hljs-comment"># 接收参数</span>
            <span class="hljs-string">"parameters"</span>: {
                <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>, 
                <span class="hljs-string">"properties"</span>: {}
            }
        }
    },
    {
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"function"</span>,
        <span class="hljs-string">"function"</span>: {
            <span class="hljs-string">"name"</span>: <span class="hljs-string">"move_file"</span>,
            <span class="hljs-string">"description"</span>: <span class="hljs-string">"将指定文件移动到目标文件夹中。"</span>,
            <span class="hljs-string">"parameters"</span>: {
                <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>,
                <span class="hljs-string">"properties"</span>: {
                    <span class="hljs-string">"filename"</span>: {
                        <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>, 
                        <span class="hljs-string">"description"</span>: <span class="hljs-string">"源文件名 (必须是 list_files 返回列表中存在的名字)"</span>
                    },
                    <span class="hljs-string">"category"</span>: {
                        <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>, 
                        <span class="hljs-string">"description"</span>: <span class="hljs-string">"目标文件夹名称 (例如 'Images', '合同文件', '简历')"</span>
                    }
                },
                <span class="hljs-string">"required"</span>: [<span class="hljs-string">"filename"</span>, <span class="hljs-string">"category"</span>]
            }
        }
    }
]

</code></pre>
<p>这块的详细细节可以查看本专栏第五课《春哥的Agent通关秘籍05：工具调用 Function Calling【知识与思路篇】》具体查看schema细节，实战篇就不赘述了。</p>
<h2 data-id="heading-4">05. ReAct 循环的构建</h2>
<p>ReAct循环的核心是一个while循环。</p>
<p>我们需要把整个交互包裹在一个 while True 循环里，只要 AI 还想调工具，我们就一直陪它跑下去，直到它认为信息足够了，不再调用工具为止。</p>
<p><img src="https://pic.zhangshichun.top/pic/20260201215742831.png" alt="" loading="lazy"/></p>
<p>这里，我们按照Agent最常见的while循环逻辑画出了示意图，关键除了最大轮次判断之外，最需要注意的就是这里：</p>
<p><img src="https://pic.zhangshichun.top/pic/20260201215958769.png" alt="" loading="lazy"/></p>
<p>判断AI是否有工具调用的诉求。</p>
<p>没有的话，直接反馈给用户就行，否则的话，就需要进入while循环了。</p>
<p>因此，编程while循环版本，我们要引入两个重要的机制：</p>
<ul>
<li>MAX_ROUND 防护，防止 AI 陷入死循环把你的钱烧光。</li>
<li>if not ai_msg.tool_calls 时，跳出循环，return final_result。</li>
</ul>
<p>核心代码如下：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 循环限制，防止死循环</span>
MAX_TURNS = <span class="hljs-number">60</span>

<span class="hljs-keyword">for</span> turn <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(MAX_TURNS):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"🔄 第 <span class="hljs-subst">{turn + <span class="hljs-number">1</span>}</span> 轮思考中..."</span>)
    
    <span class="hljs-comment"># 1. 呼叫大模型</span>
    response = client.chat.completions.create(
        model=<span class="hljs-string">"deepseek-chat"</span>,
        messages=messages,
        tools=tools_schema,
    )
</code></pre>
<p>以及对其 <code>response</code> 的内容检查：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">if</span> ai_message.tool_calls:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"⚡ 触发了 <span class="hljs-subst">{<span class="hljs-built_in">len</span>(ai_message.tool_calls)}</span> 个操作请求!"</span>)
    
    <span class="hljs-comment"># 3. 遍历并执行所有工具调用 (Parallel Function Calling)</span>
    <span class="hljs-keyword">for</span> tool_call <span class="hljs-keyword">in</span> ai_message.tool_calls:
        function_name = tool_call.function.name
        function_args = json.loads(tool_call.function.arguments)
        <span class="hljs-comment"># 略：根据方法名和参数调用方法</span>
<span class="hljs-keyword">else</span>:
    <span class="hljs-comment"># 如果没有工具调用，说明任务结束，AI 给出了总结</span>
    <span class="hljs-built_in">print</span>(ai_message.content)
    <span class="hljs-keyword">break</span>
</code></pre>
<h2 data-id="heading-5">06 管理你的message清单</h2>
<p>众所周知，LLM是没有记忆的。</p>
<p>你每一次和它聊天，对于它来说，都是一次全新的相遇。</p>
<ol>
<li>你看到小美，上去打招呼：小美你好，我是李雷。</li>
<li>小美回复你：李雷你好，我是小美。</li>
<li>你马上问小美：你复述一遍，我是谁？</li>
<li>小美：抱歉，我不知道你是谁，这是我们第一次聊天。</li>
</ol>
<p>为了解决这个问题，为了能实现多轮会话，人们想到了一个简单而实用的方法：</p>
<ol>
<li>你看到小美：“小美你好，我是李雷。”</li>
<li>小美回复：“李雷你好，我是小美。”</li>
<li>这次你学聪明了，给递过去一个清单，上面记载了你们刚才的聊天记录，顺便你问：“你复述一遍，我是谁？”</li>
<li>小美微笑：当然，你是李雷。</li>
</ol>
<p><strong>没错，你现在用到的看起来有记忆的LLM 聊天工具，其实每轮会话都把所有聊天记录都塞进去</strong>。</p>
<p><img src="https://pic.zhangshichun.top/pic/20260207120123503.png" alt="" loading="lazy"/></p>
<p>这是目前所有Agent开发者都不得避免对的一个世纪难题，因为这样你的每次会话的聊天清单都会越来越长，当Token长到一定程度后，就会导致一系列的问题。</p>
<ul>
<li>收费</li>
<li>响应速度</li>
<li>降智</li>
<li>超出最大长度</li>
</ul>
<p>等等，这里我们先按下不表，但你需要知道，你需要永远按如下方式维护你的message，来让LLM保持记忆：</p>
<ol>
<li>永远把System Prompt放在第一个元素。</li>
<li>把用户的对话，和LLM的回复依次推入messages</li>
<li>包括AI请求调用 Function的要求，和终端调用Function的结果，也都要按顺序推入message。</li>
<li>你甚至需要每次调用都带上 tools schema，因为LLM同样不记得你有哪些方法，必须每次告诉它。</li>
</ol>
<h2 data-id="heading-6">最终效果</h2>
<p>可以访问demo仓库：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzhangshichun%2Fai_agent_dev_study" target="_blank" title="https://github.com/zhangshichun/ai_agent_dev_study" ref="nofollow noopener noreferrer">github.com/zhangshichu…</a> 获取demo原始代码。</p>
<p>依次执行如下指令：</p>
<pre><code class="hljs language-bash" lang="bash">python .\lesson_06\generate_files.py
python .\lesson_06\ai_organizer.py
</code></pre>
<p><img src="https://pic.zhangshichun.top/pic/20260206-1.gif" alt="" loading="lazy"/></p>
<p>执行后：
<img src="https://pic.zhangshichun.top/pic/20260207114026811.png" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">下一步预告</h2>
<p>本节，我们使用前两节课的知识点，进行了一次简单的实操。</p>
<ul>
<li>实现本地的Function作为tools传递给AI</li>
<li>在本地构建构建ReAct循环</li>
<li>维护messages清单，以保持AI的记忆</li>
</ul>
<p>下节课，我们将深入理解AI的本质，学习什么是向量，什么是向量化，以及如何构建一个本地知识库，让AI能够快速检索你的私有知识！</p>
<p>敬请期待！</p>
<p><img src="https://pic.zhangshichun.top/pic/ScreenShot_2026-01-26_082327_821.png" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[栗子前端技术周刊第 116 期 - 2025 JS 状态调查结果、Babel 7.29.0、Vue Router 5...]]></title>    <link>https://juejin.cn/post/7603783314713559076</link>    <guid>https://juejin.cn/post/7603783314713559076</guid>    <pubDate>2026-02-09T00:41:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603783314713559076" data-draft-id="7603563317041053759" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="栗子前端技术周刊第 116 期 - 2025 JS 状态调查结果、Babel 7.29.0、Vue Router 5..."/> <meta itemprop="keywords" content="前端,JavaScript,Vue.js"/> <meta itemprop="datePublished" content="2026-02-09T00:41:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="晓得迷路了"/> <meta itemprop="url" content="https://juejin.cn/user/2172290706715565"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            栗子前端技术周刊第 116 期 - 2025 JS 状态调查结果、Babel 7.29.0、Vue Router 5...
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2172290706715565/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    晓得迷路了
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-09T00:41:03.000Z" title="Mon Feb 09 2026 00:41:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>🌰<strong>栗子前端技术周刊第 116 期 (2026.02.02 - 2026.02.08)</strong>：浏览前端一周最新消息，学习国内外优秀文章，让我们保持对前端的好奇心。</p>
<h2 data-id="heading-0">📰 技术资讯</h2>
<ol>
<li>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2F2025.stateofjs.com%2Fen-US%2F" target="_blank" title="https://2025.stateofjs.com/en-US/" ref="nofollow noopener noreferrer">2025 JS 状态调查结果</a></strong>：这份广受欢迎的年度 JavaScript 调查报告结果已发布。TypeScript 作为编程语言已全面胜出，Deno、Bun、Node.js 均已原生支持，未来甚至可直接在浏览运行；Vite 下载量超越 webpack，Vitest 快速崛起，2026 年将随 Rolldown 与 Vite+ 进入全面普及阶段；AI 正在深刻改变编码、文档、架构与工具生态，2025 年底近 30% 代码由 AI 生成，Cursor、Zed、Copilot 等工具快速流行，VS Code 仍占主导。</p>
</li>
<li>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fbabeljs.io%2Fblog%2F2026%2F01%2F31%2F7.29.0" target="_blank" title="https://babeljs.io/blog/2026/01/31/7.29.0" ref="nofollow noopener noreferrer">Babel 7.29.0</a></strong>：这是 Babel 7 的最后一个小版本，因为官方正准备发布 Babel 8.0.0，同时 Babel 8.0.0-rc（候选版本）也于 7.29.0 版本发布同步推出。7.29.0 版本支持在 <code>@babel/standalone</code> 中通过 <code>&lt;script&gt;</code> 标签上的 <code>data-target</code> 属性来定义转译目标环境，除此之外还为 <code>@babel/standalone</code> 新增了对 <code>@babel/core</code> 异步 API 的支持。</p>
</li>
<li>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvuejs%2Frouter%2Freleases%2Ftag%2Fv5.0.0" target="_blank" title="https://github.com/vuejs/router/releases/tag/v5.0.0" ref="nofollow noopener noreferrer">Vue Router v5.0.0</a></strong>：Vue Router 5 是一次无重大变更的常规版本，它将 unplugin-vue-router 合并到了核心包中，且不包含任何破坏性变更。唯一的例外是：IIFE 构建产物不再包含 @vue/devtools-api，原因是该依赖已升级至 v8，其自身不再提供 IIFE 构建版本。</p>
</li>
<li>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.jqueryui.com%2F2026%2F01%2Fjquery-ui-1-14-2-released%2F" target="_blank" title="https://blog.jqueryui.com/2026/01/jquery-ui-1-14-2-released/" ref="nofollow noopener noreferrer">jQuery UI 1.14.2</a></strong>：这款 jQuery UI 库迎来了一年多以来的首次更新，目前已可兼容 jQuery 4.0。</p>
</li>
<li>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fbun.com%2Fblog%2Fbun-v1.3.8" target="_blank" title="https://bun.com/blog/bun-v1.3.8" ref="nofollow noopener noreferrer">Bun v1.3.8</a></strong>：该版本新增原生 Markdown 解析功能。</p>
</li>
</ol>
<h2 data-id="heading-1">📒 技术文章</h2>
<ol>
<li>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.chrome.com%2Fblog%2Fthrottle-individual-network-requests" target="_blank" title="https://developer.chrome.com/blog/throttle-individual-network-requests" ref="nofollow noopener noreferrer">Throttle individual network requests</a></strong>：如何在 Chrome 中针对单个网络请求限速，而非全局限速？非常适合测试当你的依赖项加载得非常缓慢时的情况。</p>
</li>
<li>
<p><strong><a href="https://juejin.cn/post/7602073088429277199" target="_blank" title="https://juejin.cn/post/7602073088429277199">React 状态管理指南</a></strong>：React 生态的状态管理方案已经相当成熟，但选择的多样性也带来了决策的困难。本指南将系统地梳理 React 状态管理的核心概念、最佳实践，以及不同场景下的技术选型，帮助你建立清晰的状态管理思维模型。</p>
</li>
<li>
<p><strong><a href="https://juejin.cn/post/7603004323870851115" target="_blank" title="https://juejin.cn/post/7603004323870851115">基于 AI 生成高质量 Mock 数据的实践</a></strong>：在前后端分离的研发模式下，Mock 数据是并行开发的基础设施。本文介绍一套 Mock 工具的技术实现，核心解决四个问题：请求拦截、规则匹配、数据质量、团队共享。</p>
</li>
</ol>
<h2 data-id="heading-2">🔧 开发工具</h2>
<ol>
<li><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fknip.dev%2F" target="_blank" title="https://knip.dev/" ref="nofollow noopener noreferrer">Knip 5.83</a></strong>：查找并清理未使用的文件、依赖项与导出模块。</li>
</ol>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d26663214b7b49a9bf456c1065fd1d9e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pmT5b6X6L-36Lev5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771202463&amp;x-signature=wkAeHBoEZ4bbVcvBTra2VepiBnA%3D" width="100%" alt="image-20260207110155904" loading="lazy"/>
<ol start="2">
<li><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fdayflow-js.github.io%2Fcalendar%2F" target="_blank" title="https://dayflow-js.github.io/calendar/" ref="nofollow noopener noreferrer">DayFlow</a></strong>：React 日历组件，支持拖拽、多种视图，并具备 Google 日历风格的全部常用特性。</li>
</ol>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a08ea10a30f4817b619062cf142dc48~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pmT5b6X6L-36Lev5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771202463&amp;x-signature=hmAFRC7GYw61DqQunWzmUpVJGpA%3D" width="100%" alt="image-20260207110445812" loading="lazy"/>
<ol start="3">
<li><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fflexboxle.com%2F" target="_blank" title="https://flexboxle.com/" ref="nofollow noopener noreferrer">Flexboxle</a></strong>：这是一款趣味十足、类 Wordle 风格的谜题游戏：你需要输入正确的 CSS Flexbox 属性值，以达成目标布局效果。它非常适合用来练习（或教学）Flexbox 相关概念，并更好地理解其背后的思维模型。</li>
</ol>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6adb330d2e9b445ea71cde1a9acb6de1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pmT5b6X6L-36Lev5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771202463&amp;x-signature=7K1MwfHA7MTI6FBvTJexZwtsmPE%3D" width="100%" alt="image-20260207110711816" loading="lazy"/>
<p><strong>春节期间将暂停更新，提前祝大家春节快乐。</strong></p>
<p>🚀🚀🚀 <em>以上资讯文章选自常见周刊，如 JavaScript Weekly 等，周刊内容也会不断优化改进，希望你们能够喜欢。</em></p>
<p>💖 <strong>欢迎关注微信公众号：栗子前端</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android 17 再曝猛料：通知栏和快捷设置终于分家了，这操作等了十年]]></title>    <link>https://juejin.cn/post/7603721514204676105</link>    <guid>https://juejin.cn/post/7603721514204676105</guid>    <pubDate>2026-02-09T00:58:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603721514204676105" data-draft-id="7603994823326629898" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android 17 再曝猛料：通知栏和快捷设置终于分家了，这操作等了十年"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-02-09T00:58:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="黄林晴"/> <meta itemprop="url" content="https://juejin.cn/user/3985057546510423"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android 17 再曝猛料：通知栏和快捷设置终于分家了，这操作等了十年
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3985057546510423/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    黄林晴
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-09T00:58:53.000Z" title="Mon Feb 09 2026 00:58:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>左滑通知，右滑设置，大屏用户直接锁定新交互</p>
</blockquote>
<hr/>
<p>用了这么多年 Android，你有没有觉得通知栏越来越臃肿？</p>
<p>上面是通知，下面是 WiFi、蓝牙、亮度条……挤在一起，每次想关个 WiFi 都要在一堆通知里翻半天。</p>
<p>好消息是，<strong>Android 17 终于要把它们拆开了</strong>。</p>
<p>近日，Telegram 频道 Mystic Leaks 曝光了 Android 17 的最新内部界面截图，揭示了一个用户期待已久的重大交互变化——<strong>通知面板和快捷设置面板正式分离</strong>。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eef02bc2b915489fad3b82fbf59aa8f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buE5p6X5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203533&amp;x-signature=0dBpAYmlEoPuy9zaGVSapWSX2AY%3D" alt="android17_notification_cover.png" loading="lazy"/></p>
<h2 data-id="heading-0">十年夙愿：通知和快捷设置终于「分家」</h2>
<p>这个改动说起来简单，但意义巨大。</p>
<p>从 Android 5.0 开始，通知栏和快捷设置就一直是「合租」状态——下拉一次看通知，再拉一次才能看到完整的快捷开关。</p>
<p>这种设计在小屏时代还能忍，但到了 2026 年，手机屏幕动辄 6.7 英寸起步，折叠屏内屏更是 7-8 英寸。<strong>一块大屏，却还在用十年前的单栏交互逻辑</strong>，确实该改了。</p>
<p>Android 17 的方案很直接：</p>
<p><strong>从左上角下滑 → 只显示通知</strong>
<strong>从右上角下滑 → 只显示快捷设置</strong></p>
<p>干净、利落、互不干扰。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d0f11f25a9e4dcf8bf6671a0c546c76~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buE5p6X5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203533&amp;x-signature=gRsOPqxXKQUJ4U9p8h60%2FxnuNQE%3D" alt="fe34e47dbc19a5d0bfdc2300311441c4.png" loading="lazy"/></p>
<h2 data-id="heading-1">两种模式，你选哪个？</h2>
<p>Google 这次难得地给了用户选择权。</p>
<p>在 <strong>设置 → 通知</strong> 中，新增了两种交互模式：</p>




















<table><thead><tr><th>模式</th><th>操作方式</th><th>适合人群</th></tr></thead><tbody><tr><td><strong>分离模式</strong></td><td>左上角滑 = 通知，右上角滑 = 快捷设置</td><td>喜欢高效操作的用户</td></tr><tr><td><strong>经典模式</strong></td><td>和现在一样，通知和快捷设置合并显示</td><td>习惯旧操作的用户</td></tr></tbody></table>
<p>不过有一个例外——</p>
<p><strong>大屏设备和折叠屏的内屏，将强制锁定为分离模式</strong>，无法切换回经典模式。</p>
<p>这其实很合理。大屏本来就有足够的空间同时展示两个面板，合并在一起反而浪费了屏幕面积。三星的 One UI 早就在折叠屏上做了类似的分栏设计，现在原生 Android 终于跟上了。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8aa83c567ce84d4f85fb71e79e70e6ad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buE5p6X5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203533&amp;x-signature=4Wx7nuOeTAEBuz8AYP6e7Cq9PZY%3D" alt="2140ac0871e15e27ed8918a9b64638ed.png" loading="lazy"/></p>
<h2 data-id="heading-2">视觉大改：药丸时钟 + 卡片化设计</h2>
<p>除了交互逻辑的变化，通知面板的<strong>视觉设计</strong>也迎来了全面革新。</p>
<p><strong>通知面板的新样貌：</strong></p>
<ul>
<li>顶部是一个<strong>大号时钟</strong>，辨识度极高</li>
<li>日期和状态图标被收进了圆角「药丸」区域</li>
<li>整体布局更加通透，留白更多</li>
</ul>
<p><strong>快捷设置面板的新设计：</strong></p>
<ul>
<li>顶部卡片区域整合了：迷你时钟、运营商信息、编辑按钮、设置入口、电源键</li>
<li>快捷开关以<strong>两行紧凑排列</strong>，一眼就能看到所有常用开关</li>
<li>亮度条下方新增了<strong>独立的音量调节滑块</strong></li>
<li>还有一个三点菜单，提供更多控制选项</li>
</ul>
<p>这套设计语言，明显延续了上次曝光的「液态玻璃」风格——<strong>圆润、通透、层次分明</strong>。</p>
<h2 data-id="heading-3">移动数据磁贴回来了！</h2>
<p>这个小改动，可能会让很多原生 Android 用户直接「泪目」。</p>
<p>不知道从哪个版本开始，Android 把快捷设置里的「移动数据」开关给删了。想要开关移动数据，必须进设置 → 网络 → 移动网络……步骤多到让人崩溃。</p>
<p><strong>Android 17 恢复了独立的「移动数据」快捷磁贴</strong>，图标采用蜂窝信号样式，一键开关，不再绕路。</p>
<p>别小看这个改动。对于经常需要切换 WiFi 和移动数据的用户来说，这就是<strong>日常使用体验的巨大提升</strong>。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/191870a8c2814676a08e5549f6896756~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buE5p6X5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203533&amp;x-signature=aMPReWZBLzf5ifbXEukjOP1elLA%3D" alt="17a33e916b8688da757ccb3d149f77ce.png" loading="lazy"/></p>
<h2 data-id="heading-4">和iOS、One UI 的对比</h2>
<p>说到通知和控制中心分离，很多人第一反应是：「这不就是 iOS 的做法吗？」</p>
<p>没错，iOS 从很早开始就把通知中心（顶部下滑）和控制中心（右上角/底部上滑）分开了。三星 One UI 也在折叠屏上实现了类似的分栏。</p>
<p>但 Android 17 的做法有自己的特点：</p>









































<table><thead><tr><th>特性</th><th>Android 17</th><th>iOS 18</th><th>One UI 7</th></tr></thead><tbody><tr><td>分离方式</td><td>左/右上角下滑</td><td>不同位置/手势</td><td>大屏分栏</td></tr><tr><td>可切换回合并</td><td>普通手机可以</td><td>不可以</td><td>不可以</td></tr><tr><td>大屏强制分离</td><td>是</td><td>N/A</td><td>是</td></tr><tr><td>独立音量滑块</td><td>有</td><td>无</td><td>有</td></tr><tr><td>移动数据磁贴</td><td>恢复</td><td>无原生支持</td><td>一直都有</td></tr></tbody></table>
<p>Google 这次的策略很聪明——<strong>给小屏用户选择权，给大屏用户最优解</strong>。既不强制改变所有人的习惯，又为大屏设备提供了更合理的交互方案。</p>
<h2 data-id="heading-5">什么时候能用上？</h2>
<p>结合之前的曝光信息：</p>
<ul>
<li><strong>代号：</strong> Cinnamon Bun（肉桂卷）</li>
<li><strong>Developer Preview：</strong> 预计 2026 年 Q1-Q2</li>
<li><strong>正式发布：</strong> 预计 2026 年 6 月 Google I/O 大会后</li>
<li><strong>首批支持：</strong> Pixel 6 及以上机型</li>
</ul>
<p>当然，三星、小米、一加等厂商的适配还需要额外等待。但考虑到这些厂商本身就有类似的定制方案，适配速度应该不会太慢。</p>
<h2 data-id="heading-6">写在最后</h2>
<p>从上次曝光的「液态玻璃」视觉升级，到这次的通知栏交互重构，Android 17 正在给我们描绘一个越来越完整的画面：</p>
<p><strong>这不只是一次版本迭代，而是 Android 交互体验的一次系统性重塑。</strong></p>
<p>视觉上，液态玻璃效果让系统告别了「粗糙感」；
交互上，通知与快捷设置分离让操作效率大幅提升；
细节上，移动数据磁贴的回归说明 Google 终于在听用户的声音了。</p>
<p>说实话，作为一个用了十几年 Android 的老用户，这次是真的期待了。</p>
<p><strong>你觉得通知栏和快捷设置应该分开还是合在一起？评论区聊聊你的看法！</strong></p>
<hr/>
<p><em>觉得有用的话，点个「在看」转发给你的 Android 朋友吧~</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[大佬，现在AI游戏开发教程那么多，你不搞点卖给大学生吗？]]></title>    <link>https://juejin.cn/post/7604012106154164270</link>    <guid>https://juejin.cn/post/7604012106154164270</guid>    <pubDate>2026-02-09T00:59:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7604012106154164270" data-draft-id="7603588665568247848" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="大佬，现在AI游戏开发教程那么多，你不搞点卖给大学生吗？"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-02-09T00:59:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="亿元程序员"/> <meta itemprop="url" content="https://juejin.cn/user/1972988307323236"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            大佬，现在AI游戏开发教程那么多，你不搞点卖给大学生吗？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972988307323236/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    亿元程序员
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-09T00:59:14.000Z" title="Mon Feb 09 2026 00:59:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读7分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4853a38c766b4d128508ffc76ef1a1ac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=iYqg9uyGEQMdunnF%2F2GBnz9iq1Q%3D" alt="大学生：我谢谢你" loading="lazy"/></p>
<h2 data-id="heading-0">引言</h2>
<p><strong>哈喽大家好</strong>，我是亿元程序员，有小伙伴给笔者提了个非常有建设性的建议：</p>
<blockquote>
<p><strong>现在</strong>好多<code>AI</code>游戏开发的教程了，你不搞点去卖给大学生吗？</p>
<p><strong>哈哈</strong>，大学生：“我谢谢你！”</p>
</blockquote>
<p><strong>虽然</strong>小伙伴只是调侃，但是现在<code>AI</code>发展迅猛，大家都想多点拥抱<code>AI</code>：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85ecea93ade6454aa1b00b5e147eddf4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=rg6e5h2BoBd1b3oF%2BmQDBv15c5s%3D" alt="下次一定！" loading="lazy"/></p>
<p><strong>笔者</strong>主打的就是听粉丝的话，而且刚好有小伙伴想要挪车小游戏的实战：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/426719bcf08946e5b8a52f5a0e2bad66~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=27hAofeXpzBKe%2BQ9A6TFRyyVbpc%3D" alt="有计划吗？" loading="lazy"/></p>
<p><strong>但是笔者不打算挪车，想挪时下比较热门的猪。</strong></p>
<p><strong>言归正传</strong>，本期带大家一起来看看，<strong>笔者是如何通过AI暴力地开发挪猪小游戏的</strong>。</p>
<p><strong>本文源工程可在文末获取，小伙伴们自行前往。</strong></p>
<h2 data-id="heading-1">资源生成</h2>
<p><strong>挪猪游戏</strong>的<code>UI</code>相对简单，主角就是猪，既然是通过<code>AI</code>开发小游戏，我们当然要通过<code>AI</code>来生成资源：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b03fcbc97bd4a8e939c5c05c1058f0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=m2xRRmnmRrScYw%2FQo3tRwPEh5AQ%3D" alt="游戏资源由AI生成" loading="lazy"/></p>
<p><strong>好家伙</strong>，机械猪都来了，上面的图好像都不太合适，只能再来亿遍：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ffdb70a85f1a46b8b1f63edf927dd605~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=MlCU3MlK1MEFeN%2BKEC4bTnMsAw4%3D" alt="游戏资源由AI生成" loading="lazy"/></p>
<p><strong>经过</strong>笔者的深思熟虑，决定采用左下角那只棒棒糖尾巴猪作为主角。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3fc46fefb7f14b1595c1f0e0a38f9245~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=vuMDjvWxae7w%2Fvw6zOMzlzwsB%2F8%3D" alt="游戏资源由AI生成" loading="lazy"/></p>
<p><strong>但是，图片这么大，还有水印，怎么用？</strong></p>
<h2 data-id="heading-2">资源处理</h2>
<p><strong>通常</strong>生成的图片都是非常大而且背景不是透明的，我们需要通过<code>PS</code>做一下简单处理：</p>
<ul>
<li><strong>解锁图层</strong>：解锁后才能自由编辑。</li>
<li><strong>抠图</strong>：通过魔棒/选框/钢笔工具抠图。</li>
<li><strong>导出</strong>：调整资源大小并且导出。</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e8b59b31be7b48f3b9a56335a859a42d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=e73YSm4YPODzsUPZSb6klsAKtwQ%3D" alt="三板斧" loading="lazy"/></p>
<p><strong>当然</strong>现在也有很多<code>AI</code>工具能够处理抠图、去水印等等，但是笔者还是建议小伙伴们学会上面的三板斧，很方便。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a353e8fdf35649e59e141691a26812b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=sDMHn5wx3fVHaWTAY42EtFdmGMw%3D" alt="处理后的资源" loading="lazy"/></p>
<p><strong>资源准备好了之后，要通过什么AI工具开发游戏？</strong></p>
<h2 data-id="heading-3">工具选择</h2>
<p><strong>时下</strong>已经有非常多的<code>AI</code>编码工具，国内国外的都有，下面列举一些，有且不限于：</p>
<ul>
<li>
<p><strong>阿里云通义灵码</strong></p>
</li>
<li>
<p><strong>腾讯云CodeBuddy</strong></p>
</li>
<li>
<p><strong>字节跳动Trae</strong></p>
</li>
<li>
<p><strong>PinK</strong></p>
</li>
<li>
<p><strong>Cursor</strong></p>
</li>
</ul>
<p><strong>前面三个</strong>是国内的巨头，都是个人免费，企业付费，小伙伴们如果刚入门，可以选择其中一个喜欢的开始。笔者刚接触时，用<code>CodeBuddy</code>比较多。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/423b03b65aea4b95ab2a88d100eddfcb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=vDDtPyAX9ZTR72L6efy682se24k%3D" alt="CodeBuddy" loading="lazy"/></p>
<p><strong>PinK</strong>相信小伙伴们都比较熟悉了，面向游戏开发的全流水线<code>AI IDE</code>，深度适配<code>Cocos</code> 引擎，目前处于<code>alpha</code>测试阶段。笔者把<code>Token</code>霍霍完之后就没怎么用了，打算让子弹再飞久一点。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c4343fa133b4997a47c4b7884777457~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=pJq4GqBxCC9qYLgxMySkomhWuI0%3D" alt="让子弹再飞久一点" loading="lazy"/></p>
<p><strong>笔者</strong>为了让节目效果更加好，本期直接上地表最强<code>Cursor+Claude Opus4.6</code>，平时都不怎么舍得用，为了宠粉不计成本，哈哈。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b18fdd2b5b6424881d0e443f594cf97~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=7syksJgzvZ%2FQuZl18Qsm3IdljG4%3D" alt="地表最强？" loading="lazy"/></p>
<p><strong>工具选择好之后，下面我们开始实战，大家来看看能不能做出来。</strong></p>
<h2 data-id="heading-4">AI挪猪游戏开发</h2>
<p><strong>下面</strong>我们正式开始，本期节目仅仅是笔者个人<strong>不写一行代码</strong>通过<code>AI</code>制作挪猪游戏的全流程展示，并不代表这是最佳的<code>AI</code>实践，欢迎有经验的小伙伴们一起讨论。</p>
<p><strong>1. 导入资源</strong></p>
<p><strong>首先创建</strong>一个简单的<code>2D</code>工程，把我们准备好的小猪图片、通关界面（老演员了）和从朋友那借来的挪车关卡配置放到<code>assets</code>目录下。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/26c83c96c1e44e39b42fb899f31b494d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=gZIjzNwy0N2nd6J%2F%2FRhkNl6CTwM%3D" alt="带资入组" loading="lazy"/></p>
<p><strong>2. 开始制作</strong></p>
<p><strong>明人不说暗语</strong>，直接让它制作一个目前非常火的“挪车”游戏，主角换成猪，并且告知对应图片和配置：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61f43dcc4f604621acb7bbe51521156b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=lm%2BOsyTdG2wO0QFhAGmFEtR%2BgFs%3D" alt="直截了当" loading="lazy"/></p>
<p><strong>AI</strong>思考和制作的过程我们不用管，直到它停下来，介绍了使用方法，<strong>心里暗爽文章这么快就要写完了</strong>：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39c76809b241494cbc05e3eb34cfeaf6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=OJ6qClh9Xbfl4QS7fjtsF9K9Fxw%3D" alt="三两下就写完了" loading="lazy"/></p>
<p><strong>根据</strong>使用方法，直接打开项目和场景，直接运行就行，<strong>下意识地看了看文章的进度条，才知道事情并没有那么简单</strong>，且不说猪变胖了，看起来玩法和我们熟悉的挪车游戏完全不同：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9624d46d41e44818df329a4ece1cccd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=j03lRH%2BICrxv4Kp7x39sDaaHSWE%3D" alt="不太像啊" loading="lazy"/></p>
<p><strong>看起来</strong>有那么点像华容道类型的游戏？笔者意识到可能它理解的挪车游戏不同，于是补充了一下规则：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/254eb6945faa44a6996660687a46aee5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=J9LZjP8Pkf0Iwa%2BnZdqkQqzhuNE%3D" alt="语重心长地和它说" loading="lazy"/></p>
<p><strong>再次</strong>运行差点没把我气死，操作方式改成点击了，但是玩法规则没变：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9953f88a6d794f71aba6bccc40e0eb84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=gpXBLI0miOe6klpTbDQGgbvDFFE%3D" alt="还是不对啊" loading="lazy"/></p>
<p><strong>3. 规则补充</strong></p>
<p><strong>这下</strong>我彻底意识到它觉得的不是我觉得的了，于是我去搬救兵了：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14a0e556903748c391bd7fc9958a70ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=n5yg%2BqaJ0wK2Me%2BN8eBlSbkv0CY%3D" alt="用魔法控制魔法" loading="lazy"/></p>
<p><strong>仔细看了下</strong>就是我们要的规则，直接<code>ctrl+cv</code>，看到它说它明白了，这不知道得多感动：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e480dd2c263743b9abf431314b3497fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=OQyrExmIdzFn%2BDvf%2BrLPK%2FQ%2FSOg%3D" alt="喜大普奔" loading="lazy"/></p>
<p><strong>再次运行</strong>，发现真有那么点意思了，显示了关卡和剩余数量，就是猪变形了，头和尾反过来了，能正常通关：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/971621f3376a4bfc8676a1e3a2e2955e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=haXJ1rSKsBDN1sI13K0%2BqcgM%2BO8%3D" alt="屁股当头" loading="lazy"/></p>
<p><strong>4. bug修复</strong></p>
<p><strong>为了解决这几个bug</strong>，笔者和它硬刚，足足周旋了<code>4</code>个回合，感觉我的<code>Token</code>和流水一样哗啦啦地流去。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3571f3b5ba194c158f1845f3824b9c63~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=ldUDOL%2Fvkm%2FlgDeHGPUu4snwHW0%3D" alt="猪头和猪尾巴反过来了" loading="lazy"/></p>
<p><strong>几经波折</strong>终于有了曙光：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d0ca9eb6b9440ce91ce35b1132b90df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=cl0IMcl9r8d%2FoTz1NYBw3qi5d9Q%3D" alt="就这样愉快地结束了吗" loading="lazy"/></p>
<p><strong>5. 生成规则</strong></p>
<p><strong>接下来是</strong>猪的生成规则，也周旋了<code>4</code>个回合：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f18168491bf43a29a24d8912a57c915~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=kAeNoIssZnsYuOnBRIu1TgXu0bI%3D" alt="Token如流水" loading="lazy"/></p>
<p><strong>为了</strong>和原作保持一致，我们也将四四方方的地图改成<code>45°</code>(钱是大风刮来的，所以这么简单也让<code>AI</code>来)。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5170a2a33397457db09acfdbe1cb2fa8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=EU2aSO6tcxtIF8n8pRMNeHVO0e8%3D" alt="钱是大风刮来的" loading="lazy"/></p>
<p><strong>运行</strong>看一下，游戏差不多成型了，就是有个致命缺点，不知道小伙伴们发现没：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/86b249c5851d4f63919cd188a00d28d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=IOsJYBpk7EoQu0dsHg0XPshwCXg%3D" alt="没法通关" loading="lazy"/></p>
<p><strong>聪明</strong>的小伙伴，一眼就能看出来，只要有面对面的小猪，游戏就没办法正常通关：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34951e7b321043a99ab939fcded5aa38~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=MnbTt%2BPFJ1hnOiVJ4b3KfvjlPy0%3D" alt="我一眼就看出来了" loading="lazy"/></p>
<p><strong>这样</strong>基本保证了游戏能够正常玩了，我也玩到了第<code>5</code>关，但是遇到这种<code>4</code>只猪环形时，也会导致关卡无法继续：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb872821c516436f9325bd753502894d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=0fmKdneX3hCvGLo2PPZYEftTOic%3D" alt="爱的魔力转圈圈" loading="lazy"/></p>
<p><strong>6. 道具功能</strong></p>
<p>**怎么办？**上道具！要做道具功能，首先需要按钮，于是我们还是去找<code>AI</code>搭子，下面差点没把我笑抽：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d50fbfc19464f5aac1a2382d6dfac68~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=3N8xN%2FwACuwv4e%2FS70Oymdziix0%3D" alt="哭笑不得" loading="lazy"/></p>
<p><strong>其实我想要按钮上的文字是“移除”</strong>，吓得我立马点了暂停，搞错了，再来!</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/47d7d53f06814a4c83967851d30461c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=VmZK9tlKXXltprNxOE5AwQLhLFg%3D" alt="就这么愉快地决定了" loading="lazy"/></p>
<p><strong>把</strong>图片放入工程之后，又可以快乐地聊天了：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a33733c2818b404fa3ed47de05780fff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=TrdbmmlQuZxOZ%2BdCcTSmF%2FEQq3w%3D" alt="给我生成完整的代码！" loading="lazy"/></p>
<p><strong>结果</strong>还挺顺利(大战了<code>10</code>回合)，功能完美实现，这样就不怕没办法通关了。</p>
<p><strong>7. 效果演示</strong></p>
<p><strong>虽然</strong>制造过程几经曲折，但是实战总算完成了(不能再写了，再写<code>Token</code>顶不住了)：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd8050e2f9bf4df88581b8d51af0431e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=YbFl3x0nkgtOEGalPN%2BPGGOgdw4%3D" alt="撒花~" loading="lazy"/></p>
<h2 data-id="heading-5">花絮</h2>
<p><strong>1. 消耗</strong></p>
<p><strong>本次</strong><code>AI</code>制作挪猪游戏累计消耗<code>2小时</code>、<code>747.3万Token</code>、<code>7.68刀</code>。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec7ccafbe2794cdc96e644236ca5360c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=c9ANZA00CLWL6cytArRoEcDz6Go%3D" alt="付费写文章" loading="lazy"/></p>
<p><strong>2. 技巧</strong></p>
<p><strong>每生成一次</strong>，就<code>git commit</code>一次，日志内容就是对话内容，方便回溯，下面是做道具功能时大战的<code>10</code>多回合。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/761eb5fb87314eb5b18eca6bf7fe9304~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771203554&amp;x-signature=Ed9WwivMdGABzHJQAxYH3gBlCt4%3D" alt="文章就是这么写的" loading="lazy"/></p>
<p><strong>3. 建议</strong></p>
<p><strong>本期</strong>为了节目效果，疯狂消耗<code>Token</code>，不建议小伙伴们模仿。</p>
<p><strong>其实</strong>一些简单的问题可以自己解决，对话的内容可以再详细和规范一点。</p>
<p><strong>刚接触AI编程</strong>的小伙伴，不建议直接上强度，可以先去折腾一下上面提到的国内三巨头。</p>
<h2 data-id="heading-6">结语</h2>
<p><strong>大家</strong>常说<code>AI</code>时代会淘汰<strong>不会用AI</strong>的程序员，但事实上更容易淘汰<strong>只会用AI</strong>的程序员！</p>
<p><strong>小伙伴们觉得对吗？</strong> 评论区发表你的看法和<code>AI</code>游戏开发经验。</p>
<p>本文<strong>实战完整源码</strong>已集成到<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FFOi5gCiGzF3LnT03DpPMXA" target="_blank" title="https://mp.weixin.qq.com/s/FOi5gCiGzF3LnT03DpPMXA" ref="nofollow noopener noreferrer">亿元Cocos小游戏实战合集(7/10)</a>，内含体验链接，不知不觉已经更新<code>7</code>期了。</p>
<hr/>
<p><strong>我是"亿元程序员"，一位有着8年游戏行业经验的主程。在游戏开发中，希望能给到您帮助, 也希望通过您能帮助到大家。</strong></p>
<p>AD:笔者线上的小游戏《打螺丝闯关》《贪吃蛇掌机经典》《重力迷宫球》《填色之旅》《方块掌机经典》大家可以自行点击搜索体验。</p>
<p>实不相瞒，想要个<strong>赞</strong>和<strong>爱心</strong>！请把该文章<strong>分享</strong>给你觉得有需要的其他小伙伴。谢谢！</p>
<p>推荐文章：</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FFOi5gCiGzF3LnT03DpPMXA" target="_blank" title="https://mp.weixin.qq.com/s/FOi5gCiGzF3LnT03DpPMXA" ref="nofollow noopener noreferrer">亿元Cocos小游戏实战合集</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FXLCknL3fJDubec2GW6KLFA" target="_blank" title="https://mp.weixin.qq.com/s/XLCknL3fJDubec2GW6KLFA" ref="nofollow noopener noreferrer">Cocos游戏如何接入安卓穿山甲广告变现？</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F3_VrSld4KnDKY_7hxjSoKg" target="_blank" title="https://mp.weixin.qq.com/s/3_VrSld4KnDKY_7hxjSoKg" ref="nofollow noopener noreferrer">你知道和不知道的微信小游戏常用API整理，赶紧收藏用起来~</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F0Lj24VHJ-pL8z82hHqQLiA" target="_blank" title="https://mp.weixin.qq.com/s/0Lj24VHJ-pL8z82hHqQLiA" ref="nofollow noopener noreferrer">Cocos游戏如何快速接入抖音小游戏广告变现？</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FZ7DusUJA2v1IFZDFtBsueg" target="_blank" title="https://mp.weixin.qq.com/s/Z7DusUJA2v1IFZDFtBsueg" ref="nofollow noopener noreferrer">如何在CocosCreator3.8中实现割绳子游戏效果</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F3BzzFBzeVAO-a6LPTeFTrA" target="_blank" title="https://mp.weixin.qq.com/s/3BzzFBzeVAO-a6LPTeFTrA" ref="nofollow noopener noreferrer">如何在CocosCreator3.8中实现动态切割模型？</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FZIph332u_r24OTY4r6_jow" target="_blank" title="https://mp.weixin.qq.com/s/ZIph332u_r24OTY4r6_jow" ref="nofollow noopener noreferrer">Cocos游戏开发中的贴花效果</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MongoDB（2）MongoDB与传统关系型数据库的主要区别是什么？]]></title>    <link>https://juejin.cn/post/7604039449467568178</link>    <guid>https://juejin.cn/post/7604039449467568178</guid>    <pubDate>2026-02-08T23:05:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7604039449467568178" data-draft-id="7604012106154033198" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MongoDB（2）MongoDB与传统关系型数据库的主要区别是什么？"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2026-02-08T23:05:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MongoDB（2）MongoDB与传统关系型数据库的主要区别是什么？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T23:05:57.000Z" title="Sun Feb 08 2026 23:05:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>MongoDB和传统关系型数据库（如MySQL、PostgreSQL）在存储模型、扩展性、查询语言、事务处理等方面存在显著差异。以下是详细的区别以及结合代码的示例：</p>
<h3 data-id="heading-0">1. 数据存储模型</h3>
<p><strong>传统关系型数据库</strong>使用表格格式存储数据，每个表由固定的列和行组成。</p>
<p><strong>MongoDB</strong>使用文档型存储模型，数据以类似于JSON的BSON格式存储，每个文档可以有不同的字段和结构。</p>
<h4 data-id="heading-1">示例：</h4>
<p><strong>MySQL：</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> users (
    id <span class="hljs-type">INT</span> AUTO_INCREMENT <span class="hljs-keyword">PRIMARY</span> KEY,
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>),
    email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>)
);

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> users (name, email) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'John Doe'</span>, <span class="hljs-string">'john.doe@example.com'</span>);

<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> users;
</code></pre>
<p><strong>MongoDB：</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">db.<span class="hljs-property">users</span>.<span class="hljs-title function_">insertOne</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"John Doe"</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"john.doe@example.com"</span> });

db.<span class="hljs-property">users</span>.<span class="hljs-title function_">find</span>();
</code></pre>
<h3 data-id="heading-2">2. 模式（Schema）</h3>
<p><strong>传统关系型数据库</strong>强制使用固定模式，必须在插入数据之前定义表结构。</p>
<p><strong>MongoDB</strong>是无模式的，可以在插入数据时动态添加新字段。</p>
<h4 data-id="heading-3">示例：</h4>
<p><strong>MySQL：</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> users <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">COLUMN</span> age <span class="hljs-type">INT</span>;
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> users (name, email, age) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'Jane Doe'</span>, <span class="hljs-string">'jane.doe@example.com'</span>, <span class="hljs-number">30</span>);
</code></pre>
<p><strong>MongoDB：</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">db.<span class="hljs-property">users</span>.<span class="hljs-title function_">insertOne</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"Jane Doe"</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"jane.doe@example.com"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> });
</code></pre>
<h3 data-id="heading-4">3. 扩展性</h3>
<p><strong>传统关系型数据库</strong>通常采用垂直扩展（增加单个服务器的计算能力）。</p>
<p><strong>MongoDB</strong>支持水平扩展（通过分片将数据分布到多个服务器）。</p>
<h4 data-id="heading-5">示例：</h4>
<p><strong>MongoDB 分片：</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 启用分片</span>
sh.<span class="hljs-title function_">enableSharding</span>(<span class="hljs-string">"mydatabase"</span>);

<span class="hljs-comment">// 为集合设置分片键</span>
sh.<span class="hljs-title function_">shardCollection</span>(<span class="hljs-string">"mydatabase.users"</span>, { <span class="hljs-string">"_id"</span>: <span class="hljs-number">1</span> });
</code></pre>
<h3 data-id="heading-6">4. 查询语言</h3>
<p><strong>传统关系型数据库</strong>使用SQL（结构化查询语言）来进行CRUD操作。</p>
<p><strong>MongoDB</strong>使用基于JavaScript的查询语言。</p>
<h4 data-id="heading-7">示例：</h4>
<p><strong>MySQL：</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> users <span class="hljs-keyword">WHERE</span> email <span class="hljs-operator">=</span> <span class="hljs-string">'john.doe@example.com'</span>;
</code></pre>
<p><strong>MongoDB：</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">db.<span class="hljs-property">users</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">email</span>: <span class="hljs-string">"john.doe@example.com"</span> });
</code></pre>
<h3 data-id="heading-8">5. 事务处理</h3>
<p><strong>传统关系型数据库</strong>提供强事务支持（ACID特性），适用于复杂的事务处理。</p>
<p><strong>MongoDB</strong>在4.0版本开始支持多文档事务，但事务的应用场景和复杂度不如关系型数据库。</p>
<h4 data-id="heading-9">示例：</h4>
<p><strong>MySQL：</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">START</span> TRANSACTION;
<span class="hljs-keyword">UPDATE</span> accounts <span class="hljs-keyword">SET</span> balance <span class="hljs-operator">=</span> balance <span class="hljs-operator">-</span> <span class="hljs-number">100</span> <span class="hljs-keyword">WHERE</span> name <span class="hljs-operator">=</span> <span class="hljs-string">'Alice'</span>;
<span class="hljs-keyword">UPDATE</span> accounts <span class="hljs-keyword">SET</span> balance <span class="hljs-operator">=</span> balance <span class="hljs-operator">+</span> <span class="hljs-number">100</span> <span class="hljs-keyword">WHERE</span> name <span class="hljs-operator">=</span> <span class="hljs-string">'Bob'</span>;
<span class="hljs-keyword">COMMIT</span>;
</code></pre>
<p><strong>MongoDB：</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> session = client.<span class="hljs-title function_">startSession</span>();
session.<span class="hljs-title function_">startTransaction</span>();

<span class="hljs-keyword">try</span> {
    db.<span class="hljs-property">accounts</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span> }, { <span class="hljs-attr">$inc</span>: { <span class="hljs-attr">balance</span>: -<span class="hljs-number">100</span> } }, { session });
    db.<span class="hljs-property">accounts</span>.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span> }, { <span class="hljs-attr">$inc</span>: { <span class="hljs-attr">balance</span>: <span class="hljs-number">100</span> } }, { session });
    session.<span class="hljs-title function_">commitTransaction</span>();
} <span class="hljs-keyword">catch</span> (error) {
    session.<span class="hljs-title function_">abortTransaction</span>();
    <span class="hljs-keyword">throw</span> error;
} <span class="hljs-keyword">finally</span> {
    session.<span class="hljs-title function_">endSession</span>();
}
</code></pre>
<h3 data-id="heading-10">6. 连接和嵌套数据</h3>
<p><strong>传统关系型数据库</strong>使用表间关系和JOIN操作来连接数据。</p>
<p><strong>MongoDB</strong>通过嵌入式文档和引用来实现数据连接。</p>
<h4 data-id="heading-11">示例：</h4>
<p><strong>MySQL：</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> orders (
    id <span class="hljs-type">INT</span> AUTO_INCREMENT <span class="hljs-keyword">PRIMARY</span> KEY,
    user_id <span class="hljs-type">INT</span>,
    product <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>),
    quantity <span class="hljs-type">INT</span>,
    <span class="hljs-keyword">FOREIGN</span> KEY (user_id) <span class="hljs-keyword">REFERENCES</span> users(id)
);

<span class="hljs-keyword">SELECT</span> users.name, orders.product, orders.quantity
<span class="hljs-keyword">FROM</span> users
<span class="hljs-keyword">JOIN</span> orders <span class="hljs-keyword">ON</span> users.id <span class="hljs-operator">=</span> orders.user_id;
</code></pre>
<p><strong>MongoDB：</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">db.<span class="hljs-property">orders</span>.<span class="hljs-title function_">insertOne</span>({
    <span class="hljs-attr">user_id</span>: <span class="hljs-title class_">ObjectId</span>(<span class="hljs-string">"60c72b2f9af1b74b1c3c2f21"</span>),
    <span class="hljs-attr">product</span>: <span class="hljs-string">"Laptop"</span>,
    <span class="hljs-attr">quantity</span>: <span class="hljs-number">1</span>
});

db.<span class="hljs-property">users</span>.<span class="hljs-title function_">aggregate</span>([
    {
        <span class="hljs-attr">$lookup</span>: {
            <span class="hljs-attr">from</span>: <span class="hljs-string">"orders"</span>,
            <span class="hljs-attr">localField</span>: <span class="hljs-string">"_id"</span>,
            <span class="hljs-attr">foreignField</span>: <span class="hljs-string">"user_id"</span>,
            <span class="hljs-attr">as</span>: <span class="hljs-string">"orders"</span>
        }
    }
]);
</code></pre>
<h3 data-id="heading-12">7. 数据一致性和可用性</h3>
<p><strong>传统关系型数据库</strong>通常优先保证数据一致性（强一致性）。</p>
<p><strong>MongoDB</strong>在默认配置下提供最终一致性，但可以通过配置副本集实现强一致性。</p>
<h3 data-id="heading-13">8. 高可用性</h3>
<p><strong>传统关系型数据库</strong>通常使用主从复制和读写分离来实现高可用性。</p>
<p><strong>MongoDB</strong>使用副本集（Replica Set）实现数据冗余和自动故障恢复。</p>
<h4 data-id="heading-14">示例：</h4>
<p><strong>MongoDB 副本集：</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">rs.<span class="hljs-title function_">initiate</span>();
rs.<span class="hljs-title function_">add</span>(<span class="hljs-string">"mongodb2.example.net:27017"</span>);
rs.<span class="hljs-title function_">add</span>(<span class="hljs-string">"mongodb3.example.net:27017"</span>);
</code></pre>
<h3 data-id="heading-15">总结</h3>


















































<table><thead><tr><th>特性</th><th>传统关系型数据库</th><th>MongoDB</th></tr></thead><tbody><tr><td>数据存储模型</td><td>表格格式</td><td>文档格式 (BSON)</td></tr><tr><td>模式（Schema）</td><td>固定模式</td><td>动态模式</td></tr><tr><td>扩展性</td><td>垂直扩展</td><td>水平扩展</td></tr><tr><td>查询语言</td><td>SQL</td><td>MongoDB查询语言 (JavaScript风格)</td></tr><tr><td>事务处理</td><td>强事务支持 (ACID)</td><td>多文档事务 (从4.0版本开始)</td></tr><tr><td>连接和嵌套数据</td><td>表间关系、JOIN</td><td>嵌入式文档、引用</td></tr><tr><td>数据一致性和可用性</td><td>强一致性</td><td>最终一致性（可配置强一致性）</td></tr><tr><td>高可用性</td><td>主从复制、读写分离</td><td>副本集 (Replica Set)</td></tr></tbody></table>
<p>通过以上详细对比和代码示例，可以看出MongoDB和传统关系型数据库在数据存储、扩展能力、查询方式等多个方面都有显著区别。选择哪种数据库应根据具体的应用场景和需求来决定。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MongoDB（3）什么是文档(Document)？]]></title>    <link>https://juejin.cn/post/7604012106154049582</link>    <guid>https://juejin.cn/post/7604012106154049582</guid>    <pubDate>2026-02-08T23:06:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7604012106154049582" data-draft-id="7603721514204561417" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MongoDB（3）什么是文档(Document)？"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2026-02-08T23:06:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MongoDB（3）什么是文档(Document)？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T23:06:50.000Z" title="Sun Feb 08 2026 23:06:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在MongoDB中，文档（Document）是基础的数据存储单元，类似于关系型数据库中的一行记录。文档以BSON（Binary JSON）格式存储，它是JSON的一种二进制表示形式，支持更丰富的数据类型和高效的解析。</p>
<h3 data-id="heading-0">特点</h3>
<ol>
<li><strong>灵活的结构</strong>：文档结构是动态的，不需要预定义模式，可以包含不同的字段和嵌套的文档。</li>
<li><strong>自描述性</strong>：每个文档包含字段名和值，因此每个文档都是自描述的。</li>
<li><strong>丰富的数据类型</strong>：支持多种数据类型，包括字符串、数字、日期、数组、嵌套文档等。</li>
</ol>
<h3 data-id="heading-1">示例</h3>
<p>下面的示例展示了MongoDB文档的创建、插入、查询、更新、删除等基本操作。</p>
<h4 data-id="heading-2">1. 创建和插入文档</h4>
<p>首先，我们连接到MongoDB数据库并创建一个集合，然后插入一个文档。</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { <span class="hljs-title class_">MongoClient</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mongodb'</span>);
<span class="hljs-keyword">const</span> url = <span class="hljs-string">'mongodb://localhost:27017'</span>;
<span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MongoClient</span>(url);

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">run</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">connect</span>();
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Connected to MongoDB"</span>);

        <span class="hljs-keyword">const</span> db = client.<span class="hljs-title function_">db</span>(<span class="hljs-string">'exampledb'</span>);
        <span class="hljs-keyword">const</span> collection = db.<span class="hljs-title function_">collection</span>(<span class="hljs-string">'users'</span>);

        <span class="hljs-comment">// 插入文档</span>
        <span class="hljs-keyword">const</span> insertResult = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">insertOne</span>({
            <span class="hljs-attr">name</span>: <span class="hljs-string">"John Doe"</span>,
            <span class="hljs-attr">email</span>: <span class="hljs-string">"john.doe@example.com"</span>,
            <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
            <span class="hljs-attr">address</span>: {
                <span class="hljs-attr">street</span>: <span class="hljs-string">"123 Main St"</span>,
                <span class="hljs-attr">city</span>: <span class="hljs-string">"Anytown"</span>,
                <span class="hljs-attr">state</span>: <span class="hljs-string">"CA"</span>,
                <span class="hljs-attr">zip</span>: <span class="hljs-string">"12345"</span>
            },
            <span class="hljs-attr">hobbies</span>: [<span class="hljs-string">"reading"</span>, <span class="hljs-string">"traveling"</span>, <span class="hljs-string">"coding"</span>]
        });

        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Inserted document:'</span>, insertResult.<span class="hljs-property">ops</span>[<span class="hljs-number">0</span>]);
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">close</span>();
    }
}

<span class="hljs-title function_">run</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">dir</span>);
</code></pre>
<h4 data-id="heading-3">2. 查询文档</h4>
<p>插入文档后，可以使用查询操作来检索文档。</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">findDocuments</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">connect</span>();
        <span class="hljs-keyword">const</span> db = client.<span class="hljs-title function_">db</span>(<span class="hljs-string">'exampledb'</span>);
        <span class="hljs-keyword">const</span> collection = db.<span class="hljs-title function_">collection</span>(<span class="hljs-string">'users'</span>);

        <span class="hljs-comment">// 查询文档</span>
        <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">findOne</span>({ <span class="hljs-attr">email</span>: <span class="hljs-string">"john.doe@example.com"</span> });
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Found document:'</span>, user);
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">close</span>();
    }
}

<span class="hljs-title function_">findDocuments</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">dir</span>);
</code></pre>
<h4 data-id="heading-4">3. 更新文档</h4>
<p>可以通过更新操作修改文档中的字段值。</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateDocument</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">connect</span>();
        <span class="hljs-keyword">const</span> db = client.<span class="hljs-title function_">db</span>(<span class="hljs-string">'exampledb'</span>);
        <span class="hljs-keyword">const</span> collection = db.<span class="hljs-title function_">collection</span>(<span class="hljs-string">'users'</span>);

        <span class="hljs-comment">// 更新文档</span>
        <span class="hljs-keyword">const</span> updateResult = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">updateOne</span>(
            { <span class="hljs-attr">email</span>: <span class="hljs-string">"john.doe@example.com"</span> },
            { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">age</span>: <span class="hljs-number">31</span>, <span class="hljs-string">"address.city"</span>: <span class="hljs-string">"New City"</span> } }
        );

        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Updated document count:'</span>, updateResult.<span class="hljs-property">modifiedCount</span>);
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">close</span>();
    }
}

<span class="hljs-title function_">updateDocument</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">dir</span>);
</code></pre>
<h4 data-id="heading-5">4. 删除文档</h4>
<p>可以通过删除操作从集合中移除文档。</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">deleteDocument</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">connect</span>();
        <span class="hljs-keyword">const</span> db = client.<span class="hljs-title function_">db</span>(<span class="hljs-string">'exampledb'</span>);
        <span class="hljs-keyword">const</span> collection = db.<span class="hljs-title function_">collection</span>(<span class="hljs-string">'users'</span>);

        <span class="hljs-comment">// 删除文档</span>
        <span class="hljs-keyword">const</span> deleteResult = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">deleteOne</span>({ <span class="hljs-attr">email</span>: <span class="hljs-string">"john.doe@example.com"</span> });
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Deleted document count:'</span>, deleteResult.<span class="hljs-property">deletedCount</span>);
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">close</span>();
    }
}

<span class="hljs-title function_">deleteDocument</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">dir</span>);
</code></pre>
<h3 data-id="heading-6">高级操作</h3>
<h4 data-id="heading-7">嵌套文档和数组操作</h4>
<p>MongoDB文档支持嵌套文档和数组，这使其非常适合处理复杂和层次化的数据结构。</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">complexDocumentOperations</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">connect</span>();
        <span class="hljs-keyword">const</span> db = client.<span class="hljs-title function_">db</span>(<span class="hljs-string">'exampledb'</span>);
        <span class="hljs-keyword">const</span> collection = db.<span class="hljs-title function_">collection</span>(<span class="hljs-string">'users'</span>);

        <span class="hljs-comment">// 插入带嵌套文档和数组的文档</span>
        <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">insertOne</span>({
            <span class="hljs-attr">name</span>: <span class="hljs-string">"Jane Doe"</span>,
            <span class="hljs-attr">email</span>: <span class="hljs-string">"jane.doe@example.com"</span>,
            <span class="hljs-attr">age</span>: <span class="hljs-number">28</span>,
            <span class="hljs-attr">address</span>: {
                <span class="hljs-attr">street</span>: <span class="hljs-string">"456 Elm St"</span>,
                <span class="hljs-attr">city</span>: <span class="hljs-string">"Othertown"</span>,
                <span class="hljs-attr">state</span>: <span class="hljs-string">"NY"</span>,
                <span class="hljs-attr">zip</span>: <span class="hljs-string">"67890"</span>
            },
            <span class="hljs-attr">hobbies</span>: [<span class="hljs-string">"drawing"</span>, <span class="hljs-string">"music"</span>],
            <span class="hljs-attr">orders</span>: [
                { <span class="hljs-attr">product</span>: <span class="hljs-string">"Book"</span>, <span class="hljs-attr">quantity</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">12.99</span> },
                { <span class="hljs-attr">product</span>: <span class="hljs-string">"Pen"</span>, <span class="hljs-attr">quantity</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">1.99</span> }
            ]
        });

        <span class="hljs-comment">// 查询嵌套文档和数组</span>
        <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">findOne</span>({ <span class="hljs-attr">email</span>: <span class="hljs-string">"jane.doe@example.com"</span> });
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Found document:'</span>, user);

        <span class="hljs-comment">// 更新嵌套文档中的数组</span>
        <span class="hljs-keyword">const</span> updateResult = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">updateOne</span>(
            { <span class="hljs-attr">email</span>: <span class="hljs-string">"jane.doe@example.com"</span> },
            { <span class="hljs-attr">$push</span>: { <span class="hljs-attr">hobbies</span>: <span class="hljs-string">"gardening"</span> } }
        );

        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Updated document count (push to array):'</span>, updateResult.<span class="hljs-property">modifiedCount</span>);

        <span class="hljs-comment">// 修改嵌套文档中的数组元素</span>
        <span class="hljs-keyword">const</span> updateOrderResult = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">updateOne</span>(
            { <span class="hljs-attr">email</span>: <span class="hljs-string">"jane.doe@example.com"</span>, <span class="hljs-string">"orders.product"</span>: <span class="hljs-string">"Pen"</span> },
            { <span class="hljs-attr">$set</span>: { <span class="hljs-string">"orders.$.quantity"</span>: <span class="hljs-number">10</span> } }
        );

        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Updated document count (modify array element):'</span>, updateOrderResult.<span class="hljs-property">modifiedCount</span>);
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">close</span>();
    }
}

<span class="hljs-title function_">complexDocumentOperations</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">dir</span>);
</code></pre>
<h3 data-id="heading-8">总结</h3>
<p>MongoDB的文档模型提供了高度的灵活性和自描述性，适用于处理复杂和变化的数据结构。通过文档模型，可以轻松实现对嵌套数据和数组的操作，适合于面向对象编程和现代应用程序的开发。</p>

































<table><thead><tr><th>特性</th><th>详细说明</th></tr></thead><tbody><tr><td>数据存储格式</td><td>BSON（类似于JSON）</td></tr><tr><td>灵活的结构</td><td>支持动态模式，不需要预定义表结构</td></tr><tr><td>嵌套文档</td><td>支持文档内嵌套文档，适合层次化数据结构</td></tr><tr><td>丰富的数据类型</td><td>支持多种数据类型，如字符串、数字、日期等</td></tr><tr><td>自描述性</td><td>每个文档包含字段名和值，便于理解和解析</td></tr><tr><td>高效的查询和索引</td><td>支持丰富的查询语法和索引类型，提升查询性能</td></tr></tbody></table>
<p>通过实际代码示例，可以直观地了解MongoDB文档模型的强大功能和灵活性，从而更好地应用于实际项目开发中。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenSpec 与 Spec Kit 使用对比：规范驱动开发该选哪个？]]></title>    <link>https://juejin.cn/post/7603781883974385683</link>    <guid>https://juejin.cn/post/7603781883974385683</guid>    <pubDate>2026-02-08T23:41:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603781883974385683" data-draft-id="7603688142005583881" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenSpec 与 Spec Kit 使用对比：规范驱动开发该选哪个？"/> <meta itemprop="keywords" content="人工智能"/> <meta itemprop="datePublished" content="2026-02-08T23:41:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="风象南"/> <meta itemprop="url" content="https://juejin.cn/user/2524134428655159"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenSpec 与 Spec Kit 使用对比：规范驱动开发该选哪个？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2524134428655159/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    风象南
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T23:41:58.000Z" title="Sun Feb 08 2026 23:41:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读7分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>AI 编程工具越来越强，但"先写规范再写代码"的 SDD（Spec-Driven Development）理念也开始流行。目前最有代表性的两个开源框架是 GitHub 的 Spec Kit 和 Fission AI 的 OpenSpec，这篇文章梳理它们各自的用法和差异。</p>
</blockquote>
<h2 data-id="heading-0">先说背景：为什么需要 SDD</h2>
<p>用 Cursor、Claude Code 或 Copilot 写代码时，很多人习惯直接丢一段需求描述给 AI，然后看它输出什么。这种 "Vibe Coding" 在小功能上还行，一旦需求复杂一点，生成的代码往往似是而非 —— 不是模型不够强，是我们没给够上下文。</p>
<p>SDD 的做法很朴素：先把要做什么写成结构化的规范文档，再让 AI 照着规范写代码。规范本身也由 AI 辅助生成，但每一步人都可以审查和修正。两个框架对"怎么组织这个流程"给出了不同的答案。</p>
<h2 data-id="heading-1">Spec Kit：GitHub 出品，流程严谨</h2>
<h4 data-id="heading-2">定位</h4>
<p>Spec Kit（28K+ Star）不是 AI 助手，而是一套给 AI 助手"加规矩"的工具包。它往你项目里注入一组 slash commands，通过 GitHub Copilot、Claude Code、Gemini CLI 等工具调用。核心思路是门控流程 —— 每一步做完、人确认了，才能进下一步。</p>
<h4 data-id="heading-3">安装</h4>
<p>Python 生态，用 <code>uv</code> 装：</p>
<pre><code class="hljs language-bash" lang="bash">uv tool install specify-cli --from git+https://github.com/github/spec-kit.git
specify init my-project
</code></pre>
<p><code>specify init</code> 跑完后，slash commands 就被写进项目的 agent 配置目录了（<code>.claude/</code>、<code>.github/prompts/</code> 等），后续不再需要 <code>specify</code> 命令。</p>
<h4 data-id="heading-4">工作流：7 步门控</h4>
<pre><code class="hljs">Constitution → Specify → Clarify → Plan → Tasks → Analyze → Implement
</code></pre>
<p>逐步说明：</p>
<p><strong><code>/speckit.constitution</code> — 定规矩</strong></p>
<p>创建 <code>constitution.md</code>，写死项目的不可违反原则：测试覆盖率底线、技术栈约束、编码规范等。AI 在后续每一步都会参考这份文件，减少"上下文漂移"。</p>
<p><strong><code>/speckit.specify</code> — 写规范</strong></p>
<p>用自然语言描述要做什么、为什么做，不需要涉及技术细节。</p>
<p><strong><code>/speckit.clarify</code> — 消歧</strong></p>
<p>AI 基于规范抛出一系列结构化问题，覆盖潜在的歧义点，答案回写到规范的 Clarifications 部分。这步挺有价值 —— 很多返工就是因为前期没把需求想清楚。</p>
<p><strong><code>/speckit.plan</code> — 技术方案</strong></p>
<p>你给出技术方向（用什么框架、什么架构），AI 生成详细方案。</p>
<p><strong><code>/speckit.tasks</code> — 任务拆解</strong></p>
<p>把规范和方案拆成可执行的任务列表，带依赖顺序、并行标记（<code>[P]</code>）、文件路径和测试要求。</p>
<p><strong><code>/speckit.analyze</code> — 一致性检查</strong></p>
<p>交叉检查规范、方案和任务之间有没有矛盾。输出一个 Findings Table，每行有编号（A1、C2 之类），你可以直接说"Fix A1, C2"让 AI 去改。</p>
<p><strong><code>/speckit.implement</code> — 执行</strong></p>
<p>基于所有产物开始写代码。</p>
<h4 data-id="heading-5">优缺点</h4>
<p>好处是严谨。每步都有人工卡点，clarify 和 analyze 能有效减少返工。</p>
<p>代价是重。specify 阶段就能产出 800 多行文档，整套流程 8 个 slash command，跑一遍下来需要不少耐心。对日常小功能迭代来说有些 overkill。</p>
<h2 data-id="heading-6">OpenSpec：轻量灵活，为存量代码而生</h2>
<h4 data-id="heading-7">定位</h4>
<p>OpenSpec的设计出发点不太一样 —— 它假设你大部分时间是在已有代码库上做增量变更，而非从零开始。所以它围绕"变更（Change）"这个概念来组织一切。</p>
<p>v1.0.0（The OPSX Release）是个大版本，把早期的 3 步线性流程重构成了 10 个可自由组合的 OPSX 命令，不再强制按顺序走。</p>
<h4 data-id="heading-8">安装</h4>
<p>TypeScript 写的，需要 Node.js 20.19.0+：</p>
<pre><code class="hljs language-bash" lang="bash">npm install -g @fission-ai/openspec
openspec init
<span class="hljs-comment"># 或直接指定工具</span>
openspec init --tools claude,cursor
</code></pre>
<p>目前支持多种AI工具（Claude Code、Cursor、Windsurf、Gemini CLI、Copilot、Cline、Amazon Q 等）。初始化后在项目里生成对应 的skill 文件，不同工具的命令语法略有差异：</p>





















<table><thead><tr><th>工具</th><th>格式</th></tr></thead><tbody><tr><td>Claude Code</td><td><code>/opsx:command</code></td></tr><tr><td>Cursor / Windsurf / Copilot</td><td><code>/opsx-command</code></td></tr><tr><td>Trae</td><td><code>/openspec-command-name</code></td></tr></tbody></table>
<h4 data-id="heading-9">核心概念：产物依赖图</h4>
<p>理解 OpenSpec 的关键是它的产物依赖图（Artifact Graph）。每个变更包含 4 个产物：</p>
<pre><code class="hljs language-scss" lang="scss">proposal (根)
├── specs    (依赖 proposal)
├── design   (依赖 proposal)
└── tasks    (依赖 specs + design)
</code></pre>
<p>每个产物有三种状态：BLOCKED → READY → DONE。AI 通过查询 CLI 拿到实时状态，自动判断该做什么。这意味着你可以随时回去改任何产物，系统会自动更新状态链路。</p>
<h4 data-id="heading-10">完整命令（10 个）</h4>
<p>按使用阶段分：</p>
<p><strong>探索</strong></p>
<p><code>/opsx:explore</code> — 在正式开始前调研问题、对比方案。这个模式有硬隔离，不会产生任何产物或代码变更，纯粹用来想清楚。</p>
<p><strong>规划</strong></p>
<p><code>/opsx:new &lt;name&gt;</code> — 创建一个变更，在 <code>openspec/changes/&lt;name&gt;/</code> 下搭好脚手架。支持 <code>--schema</code> 参数指定自定义产物流程。</p>
<p><code>/opsx:ff</code> — Fast-Forward，按依赖顺序一口气生成 proposal、specs、design、tasks 四个产物。适合需求明确的场景。</p>
<p><code>/opsx:continue</code> — 每次只生成下一个就绪的产物，适合边想边做。</p>
<blockquote>
<p><code>ff</code> 还是 <code>continue</code>？想清楚了用 <code>ff</code>，没想清楚用 <code>continue</code>。</p>
</blockquote>
<p><strong>实现</strong></p>
<p><code>/opsx:apply</code> — 按照 specs 和 design 逐个实现 tasks.md 里的任务。支持 <code>/opsx:apply &lt;name&gt;</code> 指定变更名，做到断点续跑。</p>
<p><code>/opsx:verify</code> — 实现完了跑一遍校验，检查代码和规范是否一致。问题分三级：CRITICAL / WARNING / SUGGESTION。</p>
<p><strong>归档</strong></p>
<p><code>/opsx:sync</code> — 把变更里的 delta specs 合并回主规范目录。可选步骤，archive 时也会提示。</p>
<p><code>/opsx:archive</code> — 验证产物和任务完成后，把变更移到 archive 目录。</p>
<p><code>/opsx:bulk-archive</code> — 同时归档多个变更，自动检测跨变更的规范冲突。</p>
<p><strong>入门</strong></p>
<p><code>/opsx:onboard</code> — 用你的真实代码库做一次完整的引导教学，11 个阶段，大约 15 分钟。</p>
<h4 data-id="heading-11">三种典型工作流</h4>

























<table><thead><tr><th>模式</th><th>场景</th><th>流程</th></tr></thead><tbody><tr><td>快速功能</td><td>需求清晰</td><td><code>new → ff → apply → verify → archive</code></td></tr><tr><td>探索式</td><td>需求模糊</td><td><code>explore → new → continue → ... → apply → verify → archive</code></td></tr><tr><td>并行变更</td><td>多任务并行</td><td>多个 <code>new</code>，按需切换，最后 <code>bulk-archive</code></td></tr></tbody></table>
<h4 data-id="heading-12">几个值得注意的设计</h4>
<p><strong>变更隔离</strong></p>
<p>OpenSpec 把"当前系统状态"和"变更提案"放在不同目录：</p>
<pre><code class="hljs language-arduino" lang="arduino">openspec/
├── specs/          ← 系统当前状态（Source of Truth）
├── schemas/        ← 自定义产物工作流
├── config.yaml     ← 项目配置
└── changes/        ← 各个变更提案
    ├── add-dark-mode/
    ├── fix-login-bug/
    └── archive/    ← 历史变更
</code></pre>
<p>每个功能在独立的 change 目录里开发，只在 archive 时才合并到主规范。多人并行开发时不会互相踩。Spec Kit 没有这层隔离，直接改主规范文件，协作时容易冲突。</p>
<p><strong>Delta Spec</strong></p>
<p>变更中的规范用 <code>ADDED</code>、<code>MODIFIED</code>、<code>REMOVED</code>、<code>RENAMED</code> 标记增量，不是全量覆盖。看一眼就知道这次改了什么。</p>
<p><strong>动态指令（v1.0 新增）</strong></p>
<p>AI 拿到的指令不再是写死的模板，而是从三层动态拼装：项目上下文（<code>config.yaml</code>）、产物规则、输出模板。AI 每次操作前都会查 CLI 获取最新状态，所以指令始终跟项目实际情况同步。</p>
<h4 data-id="heading-13">CLI 命令</h4>
<p>除了 AI 助手里的 slash commands，终端里也有一组 CLI 命令：</p>













































<table><thead><tr><th>命令</th><th>用途</th></tr></thead><tbody><tr><td><code>openspec init</code></td><td>初始化项目</td></tr><tr><td><code>openspec status</code></td><td>查看产物完成状态</td></tr><tr><td><code>openspec list</code></td><td>列出活跃变更和规范</td></tr><tr><td><code>openspec show &lt;name&gt;</code></td><td>查看变更详情</td></tr><tr><td><code>openspec view</code></td><td>交互式仪表盘</td></tr><tr><td><code>openspec validate</code></td><td>校验规范格式</td></tr><tr><td><code>openspec archive</code></td><td>终端归档（<code>--yes</code> 跳过确认）</td></tr><tr><td><code>openspec feedback</code></td><td>提交反馈</td></tr><tr><td><code>openspec completion install</code></td><td>安装 Shell 补全</td></tr></tbody></table>
<h2 data-id="heading-14">对比：怎么选</h2>
<h4 data-id="heading-15">核心差异</h4>

































































<table><thead><tr><th>维度</th><th>Spec Kit</th><th>OpenSpec</th></tr></thead><tbody><tr><td>出品方</td><td>GitHub</td><td>Fission AI</td></tr><tr><td>语言 / 安装</td><td>Python / <code>uv</code></td><td>TypeScript / <code>npm</code></td></tr><tr><td>Stars</td><td>28K+</td><td>22K+</td></tr><tr><td>设计思路</td><td>严格门控，步步审查</td><td>依赖图驱动，灵活迭代</td></tr><tr><td>擅长场景</td><td>新项目从零开始（Greenfield）</td><td>已有代码库增量开发（Brownfield）</td></tr><tr><td>命令数量</td><td>8 个</td><td>10 个</td></tr><tr><td>规范体量</td><td>较重，单阶段可达 800+ 行</td><td>较轻，文档约 250 行</td></tr><tr><td>流程自由度</td><td>线性，不能跳步</td><td>非线性，随时可以回改</td></tr><tr><td>协作友好度</td><td>直接改主规范，多人易冲突</td><td>变更隔离，archive 时合并</td></tr><tr><td>Token 消耗</td><td>较高</td><td>较低</td></tr><tr><td>变更追踪</td><td>无内建机制</td><td>Delta Spec + 归档历史</td></tr></tbody></table>
<p>快速上手命令对照：</p>
<p><strong>Spec Kit：</strong></p>
<pre><code class="hljs language-bash" lang="bash">uv tool install specify-cli --from git+https://github.com/github/spec-kit.git
specify init my-project
<span class="hljs-comment"># 在 AI 助手中：</span>
/speckit.specify → /speckit.clarify → /speckit.plan → /speckit.tasks → /speckit.implement
</code></pre>
<p><strong>OpenSpec：</strong></p>
<pre><code class="hljs language-bash" lang="bash">npm install -g @fission-ai/openspec
openspec init --tools claude
<span class="hljs-comment"># 在 AI 助手中：</span>
/opsx:new feature-name → /opsx:ff → /opsx:apply → /opsx:verify → /opsx:archive
</code></pre>
<h4 data-id="heading-16">选择建议</h4>

































<table><thead><tr><th>场景</th><th>推荐</th></tr></thead><tbody><tr><td>新项目，要求严谨规范</td><td>Spec Kit</td></tr><tr><td>已有代码库做功能迭代</td><td>OpenSpec</td></tr><tr><td>多人协作，关注冲突管理</td><td>OpenSpec</td></tr><tr><td>合规性 / 可审计性要求高</td><td>Spec Kit</td></tr><tr><td>追求开发速度</td><td>OpenSpec</td></tr><tr><td>需求模糊，需要深度消歧</td><td>Spec Kit</td></tr></tbody></table>
<h2 data-id="heading-17">总结</h2>
<p>两者不是非此即彼。一种可行的组合方式：新项目启动阶段用 Spec Kit 把架构和规范敲定，进入日常迭代后切到 OpenSpec 做增量变更管理。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PHP 应用遭遇 DDoS 攻击时会发生什么 从入门到进阶的防护指南]]></title>    <link>https://juejin.cn/post/7604646882014740531</link>    <guid>https://juejin.cn/post/7604646882014740531</guid>    <pubDate>2026-02-08T23:57:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7604646882014740531" data-draft-id="7604037348608098342" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PHP 应用遭遇 DDoS 攻击时会发生什么 从入门到进阶的防护指南"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2026-02-08T23:57:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BingoGo"/> <meta itemprop="url" content="https://juejin.cn/user/993614242266077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PHP 应用遭遇 DDoS 攻击时会发生什么 从入门到进阶的防护指南
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614242266077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BingoGo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T23:57:03.000Z" title="Sun Feb 08 2026 23:57:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">PHP 应用遭遇 DDoS 攻击时会发生什么 从入门到进阶的防护指南</h2>
<h3 data-id="heading-1">暴风雨前的宁静</h3>
<p>想象一下，黑色星期五或者某个大促活动。你用 PHP 搭建的电商平台正在迎接前所未有的流量，订单源源不断，用户热情高涨，PHP 应用拼尽全力在扛。然后——啪——网站突然崩了。</p>
<p>你查日志，到底怎么了？流量确实飙了，但这次不是因为用户太多，而是一次 DDoS（分布式拒绝服务）攻击。</p>
<p>DDoS 攻击就像一场人造洪水，用大量伪造的请求把你的服务器淹掉。但具体到一个 PHP 应用，被打的时候到底发生了什么？怎么判断自己是不是正在被攻击？更重要的是——怎么防？</p>
<p>这篇文章会带你搞清楚 PHP 应用遭遇 DDoS 时的全过程：从识别攻击到保护你的应用不被打趴。</p>
<h3 data-id="heading-2">什么是 DDoS 攻击</h3>
<p>DDoS 攻击有点像互联网上的交通堵塞。想象你要进一家热门店铺，结果突然冒出成百上千个"假顾客"堵在门口，真正的顾客根本挤不进去。店铺（你的 PHP 应用）被挤爆了，最终只能关门。</p>
<p>用技术语言说，DDoS 攻击是攻击者（或僵尸网络）向目标网站发送海量流量，耗尽其资源。目的很简单：让网站变慢或者直接打瘫。</p>
<p>对 PHP 应用来说，攻击会冲击以下几个环节：</p>
<ul>
<li><strong>Web 服务器</strong>：PHP 需要处理每一个请求，短时间内涌入大量请求会耗尽服务器资源。</li>
<li><strong>数据库</strong>：过多的查询会拖慢甚至打崩数据库。</li>
<li><strong>带宽</strong>：流量太大会吃满网络带宽，导致整体性能下降。</li>
</ul>
<h3 data-id="heading-3">DDoS 攻击如何影响你的 PHP 应用</h3>
<p>PHP 应用被 DDoS 打中时，背后发生了这些事情：</p>
<h4 data-id="heading-4">Web 服务器负载飙升</h4>
<p>用户发起请求后，Web 服务器（比如 Apache 或 Nginx）会运行 PHP 脚本、查数据库、返回动态内容。正常情况下这没什么问题，但当成千上万（甚至上百万）的请求同时涌入，服务器很快就扛不住了。</p>
<ul>
<li><strong>CPU 打满</strong>：PHP 需要处理每个请求，大量请求会让 CPU 使用率直接拉满。</li>
<li><strong>内存吃紧</strong>：PHP 应用通常会在内存中保存会话数据或缓存，请求太多会导致内存耗尽，轻则变慢，重则崩溃。</li>
</ul>
<h4 data-id="heading-5">数据库过载</h4>
<p>PHP 应用通常依赖数据库来获取和展示动态内容。一个典型的请求可能涉及查库存、处理登录、渲染页面等操作。DDoS 攻击时，每个请求都可能触发开销很大的数据库查询，结果就是：</p>
<ul>
<li><strong>数据库瓶颈</strong>：数据库扛不住这种量级的负载，查询开始变慢、超时甚至直接失败。</li>
<li><strong>响应迟钝</strong>：数据库服务器变得无响应，内容分发被严重延迟。</li>
</ul>
<h4 data-id="heading-6">带宽打满</h4>
<p>每个 DDoS 请求都会消耗带宽。当恶意流量大到一定程度，会把你的网络带宽全部吃掉，真实用户的请求根本进不来。</p>
<ul>
<li><strong>连接数上限</strong>：网络连接被打满后，正常用户访问你的网站要么极慢，要么完全打不开。</li>
</ul>
<h4 data-id="heading-7">PHP 脚本超时</h4>
<p>PHP 脚本的执行时间是有上限的。服务器被大量请求淹没时，PHP 脚本可能来不及在规定时间内跑完，结果就是：</p>
<ul>
<li><strong>500 错误</strong>：服务器因资源耗尽无法处理请求。</li>
<li><strong>连接超时</strong>：PHP 脚本执行时间过长，连接直接断掉。</li>
</ul>
<h3 data-id="heading-8">如何判断你的 PHP 应用正在被 DDoS</h3>
<p>及时识别 DDoS 攻击至关重要。以下是一些关键的技术指标：</p>
<h4 data-id="heading-9">流量突然飙升</h4>
<p>流量在短时间内暴涨——尤其来源异常（比如来自不常见的地区或 IP 段）——就要警惕了。可以查看服务器日志来排查异常流量模式。</p>
<p>用 Apache 或 Nginx 日志检查是否有大量请求来自同一个 IP 或一批可疑地址：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Apache：检查访问日志中的 IP 请求频次</span>
<span class="hljs-built_in">cat</span> /var/log/apache2/access.log | awk <span class="hljs-string">'{print $1}'</span> | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> -c | <span class="hljs-built_in">sort</span> -n
</code></pre>
<h4 data-id="heading-10">性能下降和超时</h4>
<p>如果网站突然变慢或者频繁出现超时错误，可能就是 DDoS 在搞鬼。PHP 脚本处理不过来涌入的请求，开始报 500 错误或者超时。</p>
<h4 data-id="heading-11">资源占用异常</h4>
<p>如果服务器的 CPU 和内存使用率突然飙高，说明 PHP 正在苦苦支撑。可以用 <code>htop</code> 或 <code>top</code> 实时监控资源使用情况：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 实时监控 CPU 和内存使用情况</span>
top -d 1
</code></pre>
<p>如果 CPU 或内存长时间处于高位，就该进一步排查了。</p>
<h3 data-id="heading-12">PHP 应用的 DDoS 防护策略</h3>
<p>完全杜绝 DDoS 攻击很难，但有不少手段可以大幅降低其影响。下面是一些保护 PHP 应用的实用方案。</p>
<h4 data-id="heading-13">限流：第一道防线</h4>
<p>限流就是限制每个用户在一段时间内能发起的请求数量。方法简单但很有效，能挡住大部分机器人和恶意请求。</p>
<p><strong>用 Redis 实现限流</strong></p>
<p>可以用 Redis 追踪每个用户的请求次数，超过阈值就拒绝：</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$redis</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Redis</span>();
<span class="hljs-variable">$redis</span>-&gt;<span class="hljs-title function_ invoke__">connect</span>(<span class="hljs-string">'localhost'</span>, <span class="hljs-number">6379</span>);
<span class="hljs-variable">$ip</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">'REMOTE_ADDR'</span>];
<span class="hljs-variable">$key</span> = <span class="hljs-string">"request_count:<span class="hljs-subst">{$ip}</span>"</span>;
<span class="hljs-variable">$limit</span> = <span class="hljs-number">100</span>;  <span class="hljs-comment">// Max requests per minute</span>
<span class="hljs-variable">$window</span> = <span class="hljs-number">60</span>;  <span class="hljs-comment">// 1 minute time window</span>
<span class="hljs-variable">$request_count</span> = <span class="hljs-variable">$redis</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-variable">$key</span>);
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$request_count</span> &amp;&amp; <span class="hljs-variable">$request_count</span> &gt;= <span class="hljs-variable">$limit</span>) {
    <span class="hljs-comment">// Too many requests, reject the user</span>
    <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'HTTP/1.1 429 Too Many Requests'</span>);
    <span class="hljs-keyword">exit</span>(<span class="hljs-string">'Rate limit exceeded'</span>);
}
<span class="hljs-variable">$redis</span>-&gt;<span class="hljs-title function_ invoke__">incr</span>(<span class="hljs-variable">$key</span>);
<span class="hljs-variable">$redis</span>-&gt;<span class="hljs-title function_ invoke__">expire</span>(<span class="hljs-variable">$key</span>, <span class="hljs-variable">$window</span>);  <span class="hljs-comment">// Reset the count after 1 minute</span>
</code></pre>
<p>这个基础限流方案可以有效节流那些试图用大量请求淹没你服务器的用户或机器人。</p>
<h4 data-id="heading-14">CDN：分流恶意流量</h4>
<p>CDN（内容分发网络）会缓存静态资源（图片、CSS、JavaScript），通过分布在全球的边缘节点提供服务。DDoS 攻击时，CDN 可以吸收大量流量，让你的 PHP 服务器专心处理动态请求（比如用户登录、订单处理）。</p>
<p><strong>通过 CDN 分发静态资源</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- 通过 CDN 提供静态资源 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://cdn.yoursite.com/styles.css"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.yoursite.com/app.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.yoursite.com/images/product.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"Product"</span>&gt;</span>
</code></pre>
<p>把静态资源交给 CDN，既能减轻 PHP 应用的负载，也能让 DDoS 流量更难直接打到你的应用核心。</p>
<h4 data-id="heading-15">WAF：应用层防护</h4>
<p>WAF（Web 应用防火墙）是一种高级工具，专门检查和过滤发往 PHP 应用的 HTTP 流量。WAF 可以根据预设规则检测并拦截恶意请求，比如封禁可疑 IP 或屏蔽特定地区的流量。</p>
<p><strong>以 AWS WAF 为例</strong></p>
<ol>
<li>创建 Web ACL（访问控制列表），定义流量过滤规则。</li>
<li>添加规则来拦截 HTTP 洪水攻击、SQL 注入、IP 信誉过滤等。</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">aws wafv2 create-web-acl --name <span class="hljs-string">"MyWAF"</span> --scope <span class="hljs-string">"REGIONAL"</span> --default-action <span class="hljs-string">"ALLOW"</span> --rules ...
</code></pre>
<p>配置完成后，PHP 应用就有了一层专门的防护，恶意流量会被拦截，正常用户不受影响。</p>
<h4 data-id="heading-16">借助第三方 DDoS 防护服务</h4>
<p>Cloudflare、AWS Shield 这类服务是专业做 DDoS 防护的。它们提供的高级防护能自动过滤恶意流量，保证你的 PHP 应用持续在线。</p>
<p>接入方式很简单：</p>
<ol>
<li>注册 Cloudflare 或 AWS Shield。</li>
<li>把域名的流量路由到它们的服务。</li>
<li>它们会自动检测并拦截 DDoS 流量。</li>
</ol>
<p>通过第三方服务，绝大部分攻击流量在到达你的 PHP 应用之前就已经被挡掉了。</p>
<h4 data-id="heading-17">实时监控和日志记录</h4>
<p>持续监控流量和服务器性能有助于实时发现 DDoS 攻击。Datadog、New Relic、AWS CloudWatch 这类工具可以帮你捕捉异常流量、性能下降等问题。</p>
<p><strong>记录可疑 IP</strong></p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// Example: Log suspicious IPs for later analysis</span>
<span class="hljs-variable">$suspicious_ip</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">'REMOTE_ADDR'</span>];
<span class="hljs-variable">$log_file</span> = <span class="hljs-string">'/path/to/your/log/file.log'</span>;
<span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$log_file</span>, <span class="hljs-string">"Suspicious IP: <span class="hljs-subst">{$suspicious_ip}</span>\n"</span>, FILE_APPEND);
<span class="hljs-comment">// Optionally, block IP if it exceeds request limit</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$request_count</span> &gt; <span class="hljs-variable">$limit</span>) {
    <span class="hljs-comment">// Block the IP</span>
    <span class="hljs-variable">$blocked_ips</span>[] = <span class="hljs-variable">$suspicious_ip</span>;
}
</code></pre>
<p>通过记录可疑活动，你可以事后封禁恶意用户，也能不断优化自己的防护策略。</p>
<h3 data-id="heading-18">总结</h3>
<p>DDoS 攻击听起来可怕，但只要用对工具和策略，你完全可以保护好自己的 PHP 应用。从限流、CDN，到 WAF 和第三方防护服务，可选的方案并不少。</p>
<p>别慌——主动防御比被动应对强得多。今天就把这些防线搭起来，等攻击真来的时候你才不会手忙脚乱。持续监控、实时告警、遵循最佳实践，即使面对 DDoS，你的 PHP 应用照样能稳稳地跑着。
<a href="https://link.juejin.cn?target=https%3A%2F%2Fcatchadmin.com%2Fpost%2F2026-02%2Fphp-application-ddos-guide" target="_blank" title="https://catchadmin.com/post/2026-02/php-application-ddos-guide" ref="nofollow noopener noreferrer">PHP 应用遭遇 DDoS 攻击时会发生什么：从入门到进阶的防护指南</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Flutter Zero 是什么？它的出现有什么意义？为什么你需要了解下？]]></title>    <link>https://juejin.cn/post/7603769956976377897</link>    <guid>https://juejin.cn/post/7603769956976377897</guid>    <pubDate>2026-02-08T22:58:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603769956976377897" data-draft-id="7603895839556796479" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Flutter Zero 是什么？它的出现有什么意义？为什么你需要了解下？"/> <meta itemprop="keywords" content="前端,Flutter,Android"/> <meta itemprop="datePublished" content="2026-02-08T22:58:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="恋猫de小郭"/> <meta itemprop="url" content="https://juejin.cn/user/817692379985752"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Flutter Zero 是什么？它的出现有什么意义？为什么你需要了解下？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/817692379985752/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    恋猫de小郭
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T22:58:59.000Z" title="Sun Feb 08 2026 22:58:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong><code>flutter_zero</code></strong> 是一个由 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fknopp" target="_blank" title="https://github.com/knopp" ref="nofollow noopener noreferrer"><code>knopp</code></a> 发起的实验性项目，它的核心目的是<strong>利用新的 Dart 特性（主要是 FFI）重新构想 Flutter 的架构，将 Flutter 的底层 Engine 从 C++ 迁移到 Dart，并解耦 <code>dart:ui</code></strong> 。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00d87ebb0b0f4232b7e864569c1afc2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771196343&amp;x-signature=%2B84MkZ1IoU4b1AnfCUIxPxwv8GM%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>如果你对 Knopp 陌生，那么现在认识下，Flutter PC 端和多窗口等功能，不少是他在参与维护。</p>
</blockquote>
<p>对于 <code>flutter_zero</code>， 这个项目的核心目标是：</p>
<ul>
<li>重写和瘦身： <code>flutter_zero</code> 试图通过全新 Dart FFI 等能力来替代原本由 C++ 实现的 Flutter 引擎的大部分功能</li>
<li><strong>解耦 <code>dart:ui</code></strong> ： 目前的 Flutter 中 <code>dart:ui</code> 是一个深度耦合的单体式库，充满了各种抽象层，而<code>flutter_zero</code> 试图将 <code>dart:ui</code> 模块化，让它不再强依赖于底层的 C++ 引擎，<strong>我相信你在看源码和 Debug 问题时，一定经历过 <code>dart:ui</code> 的痛</strong></li>
<li><strong>Dart 优先</strong> ：尽可能用 Dart 代码替换原本的 C++、Objective-C 或 Java 引擎代码，而不是通过传统的 Platform Channels，并且这并不会带来性能问题</li>
</ul>
<p>那为什么会有这样的想法？其实来自很多方面，比如：</p>
<ul>
<li>由于 Flutter 引擎是用 C++ 写的，构建成功高，而且没有 Hot Reload，修改容易崩溃，<strong>这导致引擎层的贡献者远少于框架层</strong>（Framework），而如果引擎逻辑更多地由 Dart 编写，社区开发者就能更容易地贡献代码，并且底层也能享受到 Dart 的 Hot Reload 支持</li>
<li>目前 Dart 生态被分为 “纯 Dart 项目” 和 “Flutter 项目” ，<strong>纯 Dart 包不能使用 Flutter 的类型（如 <code>Listenable</code>），因为它们绑定在 <code>dart:ui</code> 里</strong>，这导致库作者必须维护两套代码（例如 <code>signals_core</code> 和 <code>signals</code>），而如果将核心类型从 SDK 中剥离出来，变成独立的包（如 <code>package:flutter/ui.dart</code>），这样纯 Dart 项目也可以依赖这些基础类型，统一生态</li>
<li><code>dart:ui</code> 为了跨平台，只提供了“最小公分母”的 API，要访问特定平台的 API（如 iOS 的特定视图或输入法），必须使用 Platform Channels，但是写过的知道 ，Channel 麻烦不说，性能还不好，而如果内部直接使用 Dart 通过 FFI 直接与平台 API 交互，甚至是将原本在引擎里的底层功能（如无障碍功能、文本输入）移到 Dart 层来实现，这对性能也是一大提升</li>
</ul>
<p><strong>FFI 对比 Channel 能快多少，如果做过大数据频繁交互的应该有所体会，如果没有，看这个图也可以直观对比</strong> ：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c098f3c2eb164879b2c0d1ac2dc58bab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771196343&amp;x-signature=ZfzDioJ2XxeAjSFSgKNnDHaGz8Q%3D" alt="" loading="lazy"/></p>
<p>能看出区别吗：</p>
<ul>
<li>左边 Channel 模式获取系统电量，启动后可以看到先显示 0， 之后才显示电量</li>
<li>右边 FFI 启动时看到 UI 就是已经获取完电量显示了</li>
</ul>
<p>另外还有一个点，不管是<a href="https://juejin.cn/post/7602512064977207359" target="_blank" title="https://juejin.cn/post/7602512064977207359">小米系统应用切换成 Flutter+Rust</a> ，又或者之前 <a href="https://juejin.cn/post/7456407906634825755?searchId=202602090655257AD22001833CC236D282" target="_blank" title="https://juejin.cn/post/7456407906634825755?searchId=202602090655257AD22001833CC236D282">Oppo 的负一平和灵动岛使用的 Flutter</a> ，甚至<a href="https://juejin.cn/post/7289717829733908539" target="_blank" title="https://juejin.cn/post/7289717829733908539">微信小程序渲染引擎 skyline 使用 Flutter</a> ，它们都不是正常使用，而是各种魔改定制，但是目前的耦合加大了这种定制的成本。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6288dc234baa41b7b4f278859e118f15~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771196343&amp;x-signature=g%2B05xsuh3PWrGDt%2BESpCDg8e4U4%3D" alt="" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/32d8e8f952bc4582b96750b4e571e26f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oGL54yrZGXlsI_pg60=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771196343&amp;x-signature=5zfnW8%2FcW14Y%2BwrdS%2B3aVutIsrc%3D" alt="" loading="lazy"/></p>
<p>例如嵌入式场景，遇到过一些在嵌入式系统，或者之前的 <a href="https://juejin.cn/post/7392134036845953050" target="_blank" title="https://juejin.cn/post/7392134036845953050">LG 电视 WebOS 使用 Flutter</a> 等场景，它们都是需要一些特殊定制的去嵌入，特别是在一些嵌入式 Linux 设备上，并没有标准的 GPU 或屏幕（单色 OLED 屏或 LED 阵列），这时候完整 Flutter 太重了，<strong>而 <code>flutter_zero</code> 这种“无偏见（un-opinionated）”的构建方式，允许开发者只使用 Dart 的逻辑层，而不必背负完整的图形渲染引擎，非常适合这种特殊的硬件场景</strong>。</p>
<blockquote>
<p>这个 Zero 代表了，引擎只需要处理跨平台的嵌入逻辑，而不必像现在这样作为一个巨大的单体存在。</p>
</blockquote>
<p>这种将 Flutter 剥离成一个极简的“内核”，移除 <code>dart:ui</code> 层和 C++ 的场景，还可以让 Flutter 的跨平台逻辑层面更好被其他框架利用，例如去年底的时候，<strong>Avalonia 久宣布投资 Impeller ， 和 Flutter 团队合作<a href="https://link.juejin.cn?target=https%3A%2F%2Favaloniaui.net%2Fblog%2Favalonia-partners-with-google-s-flutter-t-eam-to-bring-impeller-rendering-to-net" target="_blank" title="https://avaloniaui.net/blog/avalonia-partners-with-google-s-flutter-t-eam-to-bring-impeller-rendering-to-net" ref="nofollow noopener noreferrer">将他们的 GPU 优先渲染器 Impeller 移植到 .NET 平台</a></strong> ，这也是一种需求方向：</p>
<blockquote>
<p>让 Flutter 成为更底层的基建，而为了这样，就必须让 Flutter 有更 Zero 的架构。</p>
</blockquote>
<p>那为什么这个行为只能让社区发起呢？</p>
<p>因为这是一个非常庞大的重构，这种将的将 Flutter 剥离成一个极简的“内核” 的方式，属于是试图将 Flutter "Dart 化"和"模块化"的激进尝试，如果由官方发起，肯定会带来大量的稳定性忧虑的反对声，而由社区发起则不一样，发起人即是 Flutter 的底层维护人员，又是活跃的社区人员，他的尝试既不代表官方，又可以一定程度获得官方的支持。</p>
<p>不过有一点可以明确，<strong>在 Framework 抛弃 Channel 全面走向 FFI 是必然的目标，而 Zero 更多只是一个实验性尝试，但它激发的讨论可能会影响 Flutter 官方未来的架构演进方向，让 Flutter 未来更适合跑在更多非标准硬件上</strong>。</p>
<p>那么，现在你理解为什么 Flutter Zero 值得关注了吧？</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[hCaptcha 验证码图像识别 API 对接教程]]></title>    <link>https://juejin.cn/post/7603769956976295977</link>    <guid>https://juejin.cn/post/7603769956976295977</guid>    <pubDate>2026-02-08T16:10:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603769956976295977" data-draft-id="7603895839556714559" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="hCaptcha 验证码图像识别 API 对接教程"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-02-08T16:10:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="崔庆才丨静觅"/> <meta itemprop="url" content="https://juejin.cn/user/1521379821230269"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            hCaptcha 验证码图像识别 API 对接教程
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1521379821230269/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    崔庆才丨静觅
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T16:10:50.000Z" title="Sun Feb 08 2026 16:10:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>本文将介绍一种 hCaptcha 图像识别 API 对接说明，它可以通过用户输入识别的内容和 hCaptcha验证码图像，最后返回需要点击的小图像的坐标，完成验证。</p>
<h2 data-id="heading-0">申请流程</h2>
<p>要使用 API，需要先到 <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.acedata.cloud%2Fdocuments%2Fc9a5cc2f-e410-425f-857a-f8700205da6c%3Finviter_id%3Db87f67c1-b04f-4332-99a1-7a5e651331c6%3Finviter_id%3Db87f67c1-b04f-4332-99a1-7a5e651331c6" target="_blank" title="https://platform.acedata.cloud/documents/c9a5cc2f-e410-425f-857a-f8700205da6c?inviter_id=b87f67c1-b04f-4332-99a1-7a5e651331c6?inviter_id=b87f67c1-b04f-4332-99a1-7a5e651331c6" ref="nofollow noopener noreferrer">hCaptcha 图像识别 API</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.acedata.cloud%2Fdocuments%2Fc9a5cc2f-e410-425f-857a-f8700205da6c%3Finviter_id%3Db87f67c1-b04f-4332-99a1-7a5e651331c6%3Finviter_id%3Db87f67c1-b04f-4332-99a1-7a5e651331c6" target="_blank" title="https://platform.acedata.cloud/documents/c9a5cc2f-e410-425f-857a-f8700205da6c?inviter_id=b87f67c1-b04f-4332-99a1-7a5e651331c6?inviter_id=b87f67c1-b04f-4332-99a1-7a5e651331c6" ref="nofollow noopener noreferrer">platform.acedata.cloud/documents/c…</a> 对应页面申请对应的服务，进入页面之后，点击「Acquire」按钮，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/q6ytrc.png" alt="" loading="lazy"/></p>
<p>如果你尚未登录或注册，会自动跳转到登录页面邀请您来注册和登录，登录注册之后会自动返回当前页面。</p>
<p>在首次申请时会有免费额度赠送，可以免费使用该 API。</p>
<h2 data-id="heading-1">基本使用</h2>
<p>首先先了解下基本的使用方式，就是输入需要处理 hCaptcha验证码图像，便可获得处理后的结果，首先需要简单地传递一个 <code>queries</code> 字段，这个就是具体hCaptcha验证码图像，我们需要去一个有hCaptcha验证码网站中截取这个验证码图片，示例网站链接为： <code>https://democaptcha.com/demo-form-eng/hcaptcha.html</code>，点击复选框即可显示具体的完整验证码图片，如下图所示：</p>
<p><img src="https://cdn.acedata.cloud/xryo59.png" width="500" class="m-auto" loading="lazy"/></p>
<p>其中<code>queries</code> 字段是上文中验证码图像的截图，图片大小建议不要超过100kb，还需要对上面图片红色箭头指向的区域进行截图，并且还需要你自行压缩图片大小，并且还需要将它转换为Base64编码，如下图所示：</p>
<p><img src="https://cdn.acedata.cloud/g8ikkb.png" width="500" class="m-auto" loading="lazy"/></p>
<p>同时还需要输入跟验证码图像相关的识别内容参数 <code>question</code>，这个支持中英文翻译，可以直接传相关的识别内容，由上文网页图像中黄色箭头执行的内容可以看出 <code>question</code> 输入的应为 <code>Please click on the UNIQUE object among the others.</code>。具体的内容如下：</p>
<p><img src="https://cdn.acedata.cloud/empncr.png" width="500" class="m-auto" loading="lazy"/></p>
<p>可以看到这里我们设置了 Request Headers，包括：</p>
<ul>
<li><code>accept</code>：想要接收怎样格式的响应结果，这里填写为 <code>application/json</code>，即 JSON 格式。</li>
<li><code>authorization</code>：调用 API 的密钥，申请之后可以直接下拉选择。</li>
</ul>
<p>另外设置了 Request Body，包括：</p>
<ul>
<li><code>queries</code>：Base64编码的验证码图像列表。</li>
<li><code>question</code>：验证码图像相关的识别内容参数，支持直接输入中英文。</li>
</ul>
<p>选择之后，可以发现右侧也生成了对应代码，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/bww9b0.png" width="500" class="m-auto" loading="lazy"/></p>
<p>点击「Try」按钮即可进行测试，如上图所示，这里我们就得到了如下结果：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"solution"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"label"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Please click on the UNIQUE object among the others"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"box"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-string">"360"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"276"</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"confidences"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.6354503631591797</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>返回结果一共有多个字段，介绍如下：</p>
<ul>
<li><code>solution</code>，此次 hCaptcha验证码图像 任务处理后验证结果。
<ul>
<li><code>label</code>，hCaptcha验证码图像所识别的内容。</li>
<li><code>box</code>，hCaptcha验证码图像识别结果的位置信息，它是由图像的坐标信息构成。</li>
<li><code>confidences</code>，hCaptcha验证码图像识别后满足识别内容的的置信度。</li>
</ul>
</li>
</ul>
<p>可以看到我们得到了处理 hCaptcha验证码图像 的验证结果，我们只需要根据结果中 <code>box</code> 的位置坐标信息对该验证码图像进行模拟点击该区域便可通过验证。</p>
<p>下面将介绍如何通过结果的 <code>box</code> 的位置信息如何来点击，首先是针对上传的验证码图片进行建立直角坐标系，其中中心原点在图像的左下角，360是对应的横坐标，276是对应的纵坐标，我们只需要通过模拟点击验证码对应的坐标进行点击即可，具体的图像信息如下图所示：</p>
<p><img src="https://cdn.acedata.cloud/4ykvbl.png" width="500" class="m-auto" loading="lazy"/></p>
<p>另外如果想生成对应的对接代码，可以直接复制生成，例如 CURL 的代码如下：</p>
<pre><code class="hljs language-shell" lang="shell">curl -X POST 'https://api.acedata.cloud/captcha/recognition/hcaptcha' \
-H 'accept: application/json' \
-H 'authorization: Bearer {token}' \
-H 'content-type: application/json' \
-d '{
  "question": "Please click on the UNIQUE object among the others.",
  "queries": ["iVBORw0KGgoAAAANSU.....eY+85KVlzKHav28uq/WLVhL2kHUlFMKUcZbL31S8bpd0pEPKxNllXAE2wgu3uEfj+BfAzOGelsQNFAAAAAElFTkSuQmCC"]
}'
}'
</code></pre>
<p>Python 的对接代码如下：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests

url = <span class="hljs-string">"https://api.acedata.cloud/captcha/recognition/hcaptcha"</span>

headers = {
    <span class="hljs-string">"accept"</span>: <span class="hljs-string">"application/json"</span>,
    <span class="hljs-string">"authorization"</span>: <span class="hljs-string">"Bearer {token}"</span>,
    <span class="hljs-string">"content-type"</span>: <span class="hljs-string">"application/json"</span>
}

payload = {
    <span class="hljs-string">"question"</span>: <span class="hljs-string">"Please click on the UNIQUE object among the others."</span>,
    <span class="hljs-string">"queries"</span>: [<span class="hljs-string">"iVBORw0KGgoAAAANSU.....eY+85KVlzKHav28uq/WLVhL2kHUlFMKUcZbL31S8bpd0pEPKxNllXAE2wgu3uEfj+BfAzOGelsQNFAAAAAElFTkSuQmCC"</span>]
}

response = requests.post(url, json=payload, headers=headers)
<span class="hljs-built_in">print</span>(response.text)
</code></pre>
<h2 data-id="heading-2">错误处理</h2>
<p>在调用 API 时，如果遇到错误，API 会返回相应的错误代码和信息。例如：</p>
<ul>
<li><code>400 token_mismatched</code>：Bad request, possibly due to missing or invalid parameters.</li>
<li><code>400 api_not_implemented</code>：Bad request, possibly due to missing or invalid parameters.</li>
<li><code>401 invalid_token</code>：Unauthorized, invalid or missing authorization token.</li>
<li><code>429 too_many_requests</code>：Too many requests, you have exceeded the rate limit.</li>
<li><code>500 api_error</code>：Internal server error, something went wrong on the server.</li>
</ul>
<h3 data-id="heading-3">错误响应示例</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"error"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"api_error"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"fetch failed"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2cf86e86-22a4-46e1-ac2f-032c0f2a4e89"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-4">结论</h2>
<p>通过本文档，您已经了解了如何使用 hCaptcha 图像识别 API 让用户输入识别的内容和 hCaptcha验证码图像，最后返回需要点击的小图像的坐标，完成验证。希望本文档能帮助您更好地对接和使用该 API。如有任何问题，请随时联系我们的技术支持团队。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MCP (Model Context Protocol) 技术理解 - 第二篇]]></title>    <link>https://juejin.cn/post/7603721514204495881</link>    <guid>https://juejin.cn/post/7603721514204495881</guid>    <pubDate>2026-02-08T16:46:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603721514204495881" data-draft-id="7604484566803939338" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MCP (Model Context Protocol) 技术理解 - 第二篇"/> <meta itemprop="keywords" content="后端,MCP,AIGC"/> <meta itemprop="datePublished" content="2026-02-08T16:46:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="想用offer打牌"/> <meta itemprop="url" content="https://juejin.cn/user/578781641968972"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MCP (Model Context Protocol) 技术理解 - 第二篇
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/578781641968972/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    想用offer打牌
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T16:46:24.000Z" title="Sun Feb 08 2026 16:46:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.8;font-weight:400;font-size:16px;word-spacing:2px;letter-spacing:2px;overflow-x:hidden;color:#3e3e3e;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:1.2em;border-bottom:2px solid #ef7060;word-spacing:0!important;letter-spacing:0!important;font-size:inherit;line-height:inherit;display:block;font-weight:400;background:#ef7060;color:#fff;padding:10px;border-top-right-radius:3px;border-top-left-radius:3px;margin-right:3px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="monokai">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#272822;color:#ddd}.hljs-keyword,.hljs-literal,.hljs-name,.hljs-selector-tag,.hljs-strong,.hljs-tag{color:#f92672}.hljs-code{color:#66d9ef}.hljs-class .hljs-title{color:#fff}.hljs-attribute,.hljs-link,.hljs-regexp,.hljs-symbol{color:#bf79db}.hljs-addition,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-emphasis,.hljs-section,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-string,.hljs-subst,.hljs-template-tag,.hljs-template-variable,.hljs-title,.hljs-type,.hljs-variable{color:#a6e22e}.hljs-comment,.hljs-deletion,.hljs-meta,.hljs-quote{color:#75715e}.hljs-doctag,.hljs-keyword,.hljs-literal,.hljs-section,.hljs-selector-id,.hljs-selector-tag,.hljs-title,.hljs-type{font-weight:700}</style><h2 data-id="heading-0">引言</h2>
<p>我们第一篇讲了MCP的基础概念、MCP解决的问题以及MCP的架构，我相信大家已经对MCP有了一定的了解，那么接下来让我们深入MCP具体是如何实现的，这一篇我们的重点放在通信协议和数据传输上，让我们一起来看看吧</p>
<p>如果你对前面的内容感兴趣，可以点击这里跳转</p>
<p><a href="https://juejin.cn/post/7604037348607082534" target="_blank" title="https://juejin.cn/post/7604037348607082534">MCP (Model Context Protocol) 技术理解 - 第一篇</a></p>
<h2 data-id="heading-1">MCP的层级</h2>
<p>MCP由两层组成：</p>
<ul>
<li><strong>数据层</strong>：定义了基于 JSON-RPC 的客户端-服务器通信协议，包括生命周期管理和核心原语，如工具、资源、提示和通知。</li>
<li><strong>传输层</strong>：定义了客户端和服务器之间进行数据交换的通信机制和通道，包括特定于传输的连接建立、消息帧和授权。</li>
</ul>
<p>从概念上讲，数据层是内层，而传输层是外层。</p>
<h2 data-id="heading-2">MCP的数据层</h2>
<p>数据层实现了基于<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.jsonrpc.org%2F" target="_blank" title="https://www.jsonrpc.org/" ref="nofollow noopener noreferrer">JSON-RPC 2.0</a>交换协议，该协议定义了消息结构和语义。该层包括：</p>
<ul>
<li><strong>生命周期管理</strong>：处理客户端和服务器之间的连接初始化、能力协商和连接终止。</li>
<li><strong>服务器功能</strong>：使服务器能够提供核心功能，包括用于 AI 操作的工具、上下文数据资源以及来自客户端和与客户端交互的模板提示。</li>
<li><strong>客户端功能</strong>：使服务器能够请求客户端从主机LLM进行采样、获取用户输入以及向客户端记录消息。</li>
<li><strong>实用功能</strong>：支持实时更新通知和长时间运行操作的进度跟踪等附加功能</li>
</ul>
<p>该协议支持<strong>实时通知</strong>，从而实现服务器和客户端之间的<strong>动态更新</strong>。例如，当服务器的可用工具发生变化时（当新功能上线或现有工具被修改时），服务器可以发送工具更新通知，告知已连接的客户端这些变化。通知以 JSON-RPC 2.0 通知消息的形式发送（无需响应），使 MCP 服务器能够向已连接的客户端提供实时更新。</p>
<p>简单来说，就和我们配置中心Nacos、Apollo通过<strong>订阅-推送机制</strong>实现<strong>配置热更新</strong>差不多</p>
<h2 data-id="heading-3">MCP的传输层</h2>
<p>传输层管理客户端和服务器之间的通信通道和身份验证。它处理连接建立、消息帧构建以及MCP参与者之间的安全通信。MCP支持两种传输机制：</p>
<ul>
<li><strong>Stdio 传输</strong>：使用标准输入/输出流在同一台机器上的本地进程之间进行直接进程通信，提供最佳性能，且无网络开销。</li>
<li><strong>可流式 HTTP 传输</strong>：使用 HTTP POST 请求进行客户端到服务器的消息通信，并可选使用服务器通过SSE来实现流式传输功能。此传输方式支持远程服务器通信，并支持包括持有者令牌、API 密钥和自定义标头在内的标准 HTTP 身份验证方法。MCP 建议使用 OAuth 获取身份验证令牌。</li>
</ul>
<p>传输层将通信细节从协议层中抽象出来，从而实现所有传输机制都采用相同的 JSON-RPC 2.0 消息格式。</p>
<p>ok，这就覆盖到我们上一篇的知识了，为什么MCP可以统一数据格式和传输，同时可以预制模板，原因就在于<strong>传输层抽象成了统一的标准</strong>，无论是什么传输机制，大家只要按照这一标准来传输数据即可实现互通。</p>
<h2 data-id="heading-4">通信协议与数据传输在MCP里面是什么样子的</h2>
<p>我们来一个图来展示通信协议与数据传输在MCP的充当的角色</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fbb577bf59e648ea804c649072e498c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oOz55Sob2ZmZXLmiZPniYw=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771173984&amp;x-signature=IHtI%2FG05uJ5HD75TxEr9uAwACwc%3D" alt="image.png" loading="lazy"/></p>
<p>展示一下数据格式，我们以<strong>STDIO</strong> (标准输入/输出)为例子</p>
<p>连接建立后，客户端可以通过发送<code>tools/list</code>请求来发现可用的工具。此请求是 MCP 工具发现机制的基础——它允许客户端在尝试使用工具之前了解服务器上有哪些工具可用</p>
<p>然后服务端就返回可调用的tools(包括名称、描述、数据格式等)给客户端</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// Request</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"jsonrpc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"method"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tools/list"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment">// Response</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"jsonrpc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"result"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"tools"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"search_flights"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Search for available flights"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"inputSchema"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"object"</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"origin"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"string"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"destination"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"string"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"string"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"format"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"date"</span><span class="hljs-punctuation">}</span>
          <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"required"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"origin"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"destination"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"date"</span><span class="hljs-punctuation">]</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-5">小结</h2>
<p>在这一篇中，我们主要讲解了MCP它实现的通信协议和数据格式，这就给我们前面MCP如何实现的抽象和数据如何传输的问题解了惑。</p>
<p>下一篇我们讲讲MCP的三大核心原语、生命周期等问题</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI 视觉连载1：像素]]></title>    <link>https://juejin.cn/post/7603671627004248104</link>    <guid>https://juejin.cn/post/7603671627004248104</guid>    <pubDate>2026-02-08T15:17:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603671627004248104" data-draft-id="7603854784864845864" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI 视觉连载1：像素"/> <meta itemprop="keywords" content="算法"/> <meta itemprop="datePublished" content="2026-02-08T15:17:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="董章鱼是个攻城狮"/> <meta itemprop="url" content="https://juejin.cn/user/3644206058054766"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI 视觉连载1：像素
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3644206058054766/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    董章鱼是个攻城狮
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T15:17:56.000Z" title="Sun Feb 08 2026 15:17:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读8分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>大家好啊，我是董章鱼。</p>
<blockquote>
<p>如果让你设计一个可以识别图像的神经网络，你会怎么做？<br/>
我之前问过自己这个问题，思来想去，我的答案是。<br/>
我可能不知道如何下手。<br/>
突然有一天，当我把Resnet50这个网络的所有算法都写完一遍之后，我突然觉得，只要我深入了解了这些算法的原理，或许这个网络我也能设计出来（后知后觉的大话而已）。<br/>
于是，我有了一个大胆的想法。<br/>
接下来，我会从头开始，拆解一个图像识别网络是怎么工作的，以及背景知识，更重要的是，每一步算法的原理。<br/>
你可能会想，看懂这些需要什么知识呢？其实不需要太深奥的数学知识。<br/>
我尽可能把每一步写的通俗易懂，这个过程中我会搜集一些资料，也是一个不断完善自己知识体系的过程。</p>
</blockquote>
<p>第一个网络，就从玩烂的、作为各大AI芯片厂商性能标杆的Resnet50开始。</p>
<p>个人水平有限，文中如有错误，欢迎留言指正。</p>
<h2 data-id="heading-0">像素</h2>
<p>要实现图像识别，最离不开的，就是像素。</p>
<p>其实我们都知道，图像是由像素组成的。</p>
<p>实际上，神经网络计算，算的就是像素之间的关系，以及这些关系背后可能隐藏的图片信息。</p>
<p>相机摄像头像素2000万，拍出来的照片肯定比像素1000万的要清晰。</p>
<p>我们更容易看到图片中的物体是什么？</p>
<p>这是为什么？因为像素越多，像素之间的关系（色彩，轮廓）越丰富，我们所能看到的信息就越多，自然而然获取到的信息就多。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f02fc0859b1483b806756db33eb6128~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6JGj56ug6bG85piv5Liq5pS75Z-O54uu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771168677&amp;x-signature=QnHPfmLcMYYYp7mdsnJ6DC654P8%3D" alt="" loading="lazy"/></p>
<p>（一张1080p的图片，我们可以更容易辨别出图像中的物体是山还是水。这是因为更多的像素会给眼睛更丰富的图片细节）</p>
<p>但是，你有没有发现。</p>
<p>当我们去看一张图片时，我们绝对不是盯着某一个像素或某几个像素看，而是看了整个图像的大部分区域，或者说，大部分像素！</p>
<p>因为只有看到了大部分的图片，才能知道图中是座山。</p>
<p>正所谓，聚沙成山！</p>
<p>绝不是少了一粒沙，山就不是山，多了一粒沙，就变成了山。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/04d87c3ab91b453b92126a9692e8c595~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6JGj56ug6bG85piv5Liq5pS75Z-O54uu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771168677&amp;x-signature=3NCuhK9f2BVtKTxjDLe424d6RZs%3D" alt="" loading="lazy"/></p>
<p>上图哆啦A梦，虽然不是很清晰，像素点数也很少，但一眼望去，依然可以分清是哆啦A梦，甚至，用手捂住一半的图像，依然可以。</p>
<h2 data-id="heading-1">像素局部性</h2>
<p>这是因为人们对于图像信息的识别，是建立在对<strong>像素局部性分析的</strong>基础上的。</p>
<p>所谓局部性，通俗点说，就是眼睛或大脑会将相邻的像素或大片的像素连接起来分析，从而组合成嘴巴，然后是耳朵，最后是哆啦A梦。</p>
<p><strong>神经网络识别图片大致就是这样的原理。</strong></p>
<p><strong>它模拟的，就是人们看到图片之后的信息处理过程。</strong></p>
<p>当我们盯着一个图片看时，我们首先会获取到图片的细节特征。</p>
<p>比如哆啦A梦红色的大嘴巴。</p>
<p>但是如果仅仅盯着大嘴巴，又反而让人有一种“只缘身在此山中”的感觉。</p>
<p>因此还需要看一下图像的轮廓。</p>
<p>于是，眼睛看图片大致有以下两个过程：</p>
<ul>
<li>
<p>瞳孔放大，盯着某一处细节（如大嘴巴）看</p>
</li>
<li>
<p>瞳孔缩小，模糊的看一张图片的大致轮廓</p>
</li>
</ul>
<p>两个过程获取的信息叠加。</p>
<p>Bingo，看清楚了，是哆啦A梦！</p>
<p>那么神经网络是否可以模拟这种瞳孔放大、缩小的方式呢？</p>
<p>很幸运，可以！</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/047039595be54cefad64db0f3d740081~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6JGj56ug6bG85piv5Liq5pS75Z-O54uu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771168677&amp;x-signature=VL0yCCZqy7wXarN5KjmvLRS4yJk%3D" alt="" loading="lazy"/></p>
<p>(卷积：convolution）</p>
<p><strong>卷积核</strong>的设计，就可以很直观的模拟这种获取图片信息的方法。</p>
<p>人们通过调整卷积核的大小，来达到瞳孔张开、缩小的目的。</p>
<p>并且大量的实验和论文表明，卷积这一针对图像局部性识别的算法，可以非常有效的模拟人眼识别物体的过程。</p>
<p>关于卷积算法以及卷积核的设计，后面会专门写几篇文章来聊聊。</p>
<p>因为卷积这一算法，在图像处理领域，实在是，太重要了啊！</p>
<h2 data-id="heading-2">色彩分量RGB</h2>
<p>回到像素这一话题。</p>
<p>你有没有想过，为什么一张图片会是彩色的。</p>
<p>学过摄影的小明同学可能这时会回答：因为图片是由RGB三种颜色来表示的，每个像素实际是不同的R/G/B分量的叠加，混合起来，就表示成了不同的颜色。</p>
<p>回答正确。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8fa9d319ddcf4fb8ba93baa10b30fcc2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6JGj56ug6bG85piv5Liq5pS75Z-O54uu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771168677&amp;x-signature=9veiXabS%2FydOZ00NL4d%2FddJn8Z4%3D" alt="" loading="lazy"/></p>
<p>（三张分别表示R/G/B分量的图片，合成一张彩色图片）</p>
<p>我们人眼可以很直观的看到红色和蓝色，可以察觉到一张图片的色彩和轮廓。</p>
<p>那么，如果让计算机来处理图片，他又是如何知道色彩和轮廓的呢？</p>
<p>其实对于计算机来说，一张图片只是一堆数据，计算机是无法知道这堆数据代表的是什么。</p>
<p>这就需要人为的给这堆数据一种表示方法，让计算机知道，哦，这1/3的数据是红色分量，这1/3的是蓝色分量，这些数据（像素）组合起来，可能代表的是个“帽子”。</p>
<h2 data-id="heading-3">怎么做</h2>
<p>数据在计算机的存储中，最常见的存储方式是连续存储的。</p>
<p>比如C语言，定义一个数组，那么数组在内存中的位置是连续的。</p>
<p><code>int data[10] = {0,1,2,3,4,5,6,7,8,9};</code></p>
<p>内存怎么理解，它就是一排连着的门牌号的公寓宿舍。</p>
<p>门牌号为101里面住着的，是data的第一个数据0。门牌号102里面住着的，是data的第二个数据1，...，以此类推。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55b928544fc84e77b2859bfd8dd6d191~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6JGj56ug6bG85piv5Liq5pS75Z-O54uu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771168677&amp;x-signature=WcsQTbfYUBa%2FWVZzKPltGuuhEW4%3D" alt="" loading="lazy"/></p>
<p>(女贞路4号）</p>
<p>只不过，在计算机存储器中，没有门牌号，有的都是地址。</p>
<p>这个时候，计算机根本就不关心数据是啥，计算机用到的时候，就把数据从内存对应的地址中取出来用。</p>
<h2 data-id="heading-4">如何取数据？</h2>
<p>这就需要人们为数据存储设计一种格式，告诉计算机，这堆数据大概是什么样的。只有这样，通过这种人为约定的方式，计算机才能正确的取到R分量或者B分量。</p>
<p>对于一张图片来说，最常见的两个参数是长和宽，一般用H（height) 和 W(width) 来表示，那么RGB三个分量，看作是3个通道（channel)，一般用 C 来表示。</p>
<p>如此一来，一张长宽分别是224像素*224像素的RGB图像，就可以用 HWC = [224, 224, 3]来表示。两张类似的图片就用 NHWC = [2, 224, 224, 3]表示，其中N代表图片张数。</p>
<p>（一张图片的抽象数据表示）</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/08e14ea877454925bc395b2fd8e4d355~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6JGj56ug6bG85piv5Liq5pS75Z-O54uu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771168677&amp;x-signature=mw5F5sxQkY6PIHqVzT3HC5VW3yg%3D" alt="" loading="lazy"/></p>
<p>友好的数据表示方法，可以减少大量的计算复杂度。</p>
<p><strong>虽然这样表示不太利于人们的直观理解，但是计算机处理这种数据是十分方便的。</strong></p>
<p>在目前主流的深度学习框架中，对于图片的数据格式，基本都支持了NHWC或NCHW这种数据摆放格式。说到底，都是为了更高效地进行图片数据的处理和运算。</p>
<h2 data-id="heading-5">总结一下</h2>
<p>今天就先开个头，从像素说起，说到了像素具有局部连接性的，人眼识别图像也是通过获取像素的局部连接性信息来完成的。</p>
<p>幸运的是，卷积这一算法，可以很好的模拟这一过程。</p>
<p>最后，为了使计算机更高效的处理图片数据，引出NHWC的图片数据表示方法，</p>
<p>所以，之后我们说图片，不仅仅局限于图片的长和宽，还多了一个维度信息，那就是channel。</p>
<p>下一篇会继续，聊聊图像的色彩空间。</p>
<p>为什么有了RGB，还需要YUV？什么时候用RGB, 什么时候用YUV？</p>
<p>以及图像压缩对于深度学习来说，意味着什么？</p>
<h2 data-id="heading-6">One More Thing</h2>
<p>熟悉OpenCV或者计算机视觉的同学，可能对于上面的RGB分量中的女神很熟悉。没错，在很多的教程中，这位女神不止一次的出场。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3183814dfd51441c897830d03d37f0a0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6JGj56ug6bG85piv5Liq5pS75Z-O54uu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771168677&amp;x-signature=uZrG%2BywOoJMTTdLkIO8EgElkfSc%3D" alt="" loading="lazy"/></p>
<p>这位女士名叫 Lena。</p>
<p>电气电子工程师学会图像处理汇刊 （IEEE Transactions on Image Processing）主编曾在1996年1月出版的一期中解释道，Lena的流行，因为她是一张好的测试图片，其中包含了很多细节，平滑区域，阴影和纹理。</p>
<p>当然，另外一个原因就是漂亮美女的图片自然受到男性居多的研究领域的欢迎。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[实用免费的 Short URL 短链接 API 对接说明]]></title>    <link>https://juejin.cn/post/7603673564909436963</link>    <guid>https://juejin.cn/post/7603673564909436963</guid>    <pubDate>2026-02-08T15:27:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603673564909436963" data-draft-id="7603677143215144975" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="实用免费的 Short URL 短链接 API 对接说明"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-02-08T15:27:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="崔庆才丨静觅"/> <meta itemprop="url" content="https://juejin.cn/user/1521379821230269"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            实用免费的 Short URL 短链接 API 对接说明
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1521379821230269/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    崔庆才丨静觅
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T15:27:53.000Z" title="Sun Feb 08 2026 15:27:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>想必大家一定有把长链接转短链接的需求吧，有没有免费好用的 API 呢？有！这里就是。</p>
<p>本文将介绍一种 Short URL API 对接说明，它可将较长的URL转换为短的URL。</p>
<h2 data-id="heading-0">申请流程</h2>
<p>要使用 API，需要先到 <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.acedata.cloud%2Fdocuments%2Fshorturl%3Finviter_id%3Db87f67c1-b04f-4332-99a1-7a5e651331c6" target="_blank" title="https://platform.acedata.cloud/documents/shorturl?inviter_id=b87f67c1-b04f-4332-99a1-7a5e651331c6" ref="nofollow noopener noreferrer">Short URL API</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.acedata.cloud%2Fdocuments%2Fshorturl%3Finviter_id%3Db87f67c1-b04f-4332-99a1-7a5e651331c6" target="_blank" title="https://platform.acedata.cloud/documents/shorturl?inviter_id=b87f67c1-b04f-4332-99a1-7a5e651331c6" ref="nofollow noopener noreferrer">platform.acedata.cloud/documents/s…</a> 对应页面申请对应的服务，进入页面之后，点击「Acquire」按钮，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/q6ytrc.png" alt="" loading="lazy"/></p>
<p>如果你尚未登录或注册，会自动跳转到登录页面邀请您来注册和登录，登录注册之后会自动返回当前页面。</p>
<h2 data-id="heading-1">基本使用</h2>
<p>首先先了解下基本的使用方式，就是输入需要转换的较长URL，便可获得处理后的结果，首先需要简单地传递一个 <code>content</code> 字段。我们接下来就可以在界面上填写对应的内容，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/4ascb2.png" width="500" class="m-auto" loading="lazy"/></p>
<p>可以看到这里我们设置了 Request Headers，包括：</p>
<ul>
<li><code>accept</code>：想要接收怎样格式的响应结果，这里填写为 <code>application/json</code>，即 JSON 格式。</li>
<li><code>authorization</code>：调用 API 的密钥，申请之后可以直接下拉选择。</li>
</ul>
<p>另外设置了 Request Body，包括：</p>
<ul>
<li><code>content</code>：要缩短的URL的内容。</li>
</ul>
<p>选择之后，可以发现右侧也生成了对应代码，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/r3uakb.png" width="500" class="m-auto" loading="lazy"/></p>
<p>点击「Try」按钮即可进行测试，如上图所示，这里我们就得到了如下结果：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://surl.id/1uHCs01xa5"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>返回结果一共有多个字段，介绍如下：</p>
<ul>
<li><code>success</code>，此处任务是否成功的状态。</li>
<li><code>data</code>，包含了此处转换后的URL。</li>
</ul>
<p>可以看出
原先较长的URL <code>https://platform.acedata.cloud/documents/a2303356-6672-4eb8-9778-75f55c998fe9?inviter_id=b87f67c1-b04f-4332-99a1-7a5e651331c6</code> 已经成功转换为短的URL <code>https://surl.id/1uHCs01xa5</code>。</p>
<p>另外如果想生成对应的对接代码，可以直接复制生成，例如 CURL 的代码如下：</p>
<pre><code class="hljs language-shell" lang="shell">curl -X POST 'https://api.acedata.cloud/shorturl' \
-H 'accept: application/json' \
-H 'authorization: Bearer {token}' \
-H 'content-type: application/json' \
-d '{
  "content": "https://platform.acedata.cloud/documents/a2303356-6672-4eb8-9778-75f55c998fe9?inviter_id=b87f67c1-b04f-4332-99a1-7a5e651331c6"
}'
</code></pre>
<p>Python 的对接代码如下：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests

url = <span class="hljs-string">"https://api.acedata.cloud/shorturl"</span>

headers = {
    <span class="hljs-string">"accept"</span>: <span class="hljs-string">"application/json"</span>,
    <span class="hljs-string">"authorization"</span>: <span class="hljs-string">"Bearer {token}"</span>,
    <span class="hljs-string">"content-type"</span>: <span class="hljs-string">"application/json"</span>
}

payload = {
    <span class="hljs-string">"content"</span>: <span class="hljs-string">"https://platform.acedata.cloud/documents/a2303356-6672-4eb8-9778-75f55c998fe9?inviter_id=b87f67c1-b04f-4332-99a1-7a5e651331c6"</span>
}

response = requests.post(url, json=payload, headers=headers)
<span class="hljs-built_in">print</span>(response.text)
</code></pre>
<h2 data-id="heading-2">错误处理</h2>
<p>在调用 API 时，如果遇到错误，API 会返回相应的错误代码和信息。例如：</p>
<ul>
<li><code>400 token_mismatched</code>：Bad request, possibly due to missing or invalid parameters.</li>
<li><code>400 api_not_implemented</code>：Bad request, possibly due to missing or invalid parameters.</li>
<li><code>401 invalid_token</code>：Unauthorized, invalid or missing authorization token.</li>
<li><code>429 too_many_requests</code>：Too many requests, you have exceeded the rate limit.</li>
<li><code>500 api_error</code>：Internal server error, something went wrong on the server.</li>
</ul>
<h3 data-id="heading-3">错误响应示例</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"error"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"api_error"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"fetch failed"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2cf86e86-22a4-46e1-ac2f-032c0f2a4e89"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-4">结论</h2>
<p>通过本文档，您已经了解了如何使用 Short URL API 将较长的URL转换为短的URL。希望本文档能帮助您更好地对接和使用该 API。如有任何问题，请随时联系我们的技术支持团队。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[完成前端时间处理的另一块版图]]></title>    <link>https://juejin.cn/post/7603671627004264488</link>    <guid>https://juejin.cn/post/7603671627004264488</guid>    <pubDate>2026-02-08T15:34:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603671627004264488" data-draft-id="7603575399256064040" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="完成前端时间处理的另一块版图"/> <meta itemprop="keywords" content="前端,Web Components,GitHub"/> <meta itemprop="datePublished" content="2026-02-08T15:34:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="mumuy"/> <meta itemprop="url" content="https://juejin.cn/user/289926798118589"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            完成前端时间处理的另一块版图
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/289926798118589/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    mumuy
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T15:34:17.000Z" title="Sun Feb 08 2026 15:34:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body cache result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>之前的文章<a href="https://juejin.cn/post/7462640220032352306" target="_blank" title="https://juejin.cn/post/7462640220032352306">《为了解决时间问题，我开源了两个库》</a>提到了，我为了处理日常中遇到的时间处理问题，针对性的开源了两个库：时间格式化处理库datex和日历转化（万年历）；
这2个库分别解决了我在开发中遇到的时间处理和日历转换的问题，然而这还不够，我在想还有哪些地方遇到不好解决的时间相关问题呢？</p>
<p>有了！时间选择器！之前的万年历仅仅解决日历的展示问题，真正在产品开发中，更多的场景是如何更方便的选取时间。虽然，市面上并不缺少类似的库，可以说比比皆是。可奈何我喜欢造轮子呢~我需要一个属于自己的前端工具库宇宙。当然了，解决开发中实际遇到的问题同样是目的之一。</p>
<p>我认真盘点了下自己的需求：</p>
<ol>
<li>我需要这样一个时间选择器组件，它只有一个文件，可以同时兼容日期选择、时间选择、日期和时间同时选择，同时它还能选择范围。</li>
<li>时间选择器少不了自定义有效选择范围，就是可以在组件中限制你能选择的范围，这样可以减少用户额外的有效值筛选。这个限定可能不是具体的范围，而是重复性的范围，比如具体星期几，周末，工作日，几点到几点。</li>
<li>我需要它可以自定义格式，就是value的值可以自己定义，比如：2026-01-01，2026/01/01，2026年01月01日。我不想每次选择完以后，还要手工转化成自己想要的格式。</li>
</ol>
<p>我从<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmumuy%2Fdatex%2F" target="_blank" title="https://github.com/mumuy/datex/" ref="nofollow noopener noreferrer">时间格式化库datex</a>中移植来了内部需要用的时间处理方法；又从<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmumuy%2Fcalendar%2F" target="_blank" title="https://github.com/mumuy/calendar/" ref="nofollow noopener noreferrer">日历转化库（万年历）</a> 中移植来了日历组件的部分构成；“缝合”成了新的项目 - <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmumuy%2Fwidget-datetime%2F" target="_blank" title="https://github.com/mumuy/widget-datetime/" ref="nofollow noopener noreferrer">日期时间选择器</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e49fb4b3ec343b29792491d72a789c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbXVtdXk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=ZwsfOAvMrMXKD9ijiAkRFtnOgYk%3D" alt="QQ_1770444571115.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/86e55314e81c4f779daf18482e9b388b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbXVtdXk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=jBd40HR3KGjja08WJ13PtsEKyv4%3D" alt="QQ_1770564698027.png" loading="lazy"/></p>
<p>这个组件库的使用也特别简单，只需引入一个脚本库，加一个标签即可。</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- 日期和时间 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">widget-datetime</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"请选择日期和时间"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"2026-01-01"</span> <span class="hljs-attr">range</span>=<span class="hljs-string">"[['09:00','18:00']]"</span> <span class="hljs-attr">limit</span>=<span class="hljs-string">"['weekday']"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">widget-datetime</span>&gt;</span>

<span class="hljs-comment">&lt;!-- 日期 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">widget-date</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"请选择日期"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"2026-01-01"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">widget-date</span>&gt;</span>

<span class="hljs-comment">&lt;!-- 时间 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">widget-time</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"请选择时间"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"09:00"</span> <span class="hljs-attr">range</span>=<span class="hljs-string">"[['09:00','18:00']]"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">widget-time</span>&gt;</span>

<span class="hljs-comment">&lt;!-- 日期和时间范围 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">widget-datetime-range</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"请选择日期和时间"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">""</span> <span class="hljs-attr">range</span>=<span class="hljs-string">"[['09:00','18:00']]"</span> <span class="hljs-attr">limit</span>=<span class="hljs-string">"['weekday']"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">widget-datetime-range</span>&gt;</span>

<span class="hljs-comment">&lt;!-- 日期范围 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">widget-date-range</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"请选择日期"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">""</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">widget-date-range</span>&gt;</span>

<span class="hljs-comment">&lt;!-- 时间范围 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">widget-time-range</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"请选择时间"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">""</span> <span class="hljs-attr">range</span>=<span class="hljs-string">"[['09:00','18:00']]"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">widget-time-range</span>&gt;</span>
</code></pre>
<table>
    <thead>
        <tr>
            <th>属性</th>
            <th>参考值</th>
            <th>说明</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>placeholder</td>
            <td>'请选择日期'</td>
            <td>为空时占位提醒</td>
        </tr>
        <tr>
            <td>value</td>
            <td>'2026-01-01'</td>
            <td>默认值</td>
        </tr>
        <tr>
            <td>pattern</td>
            <td>'YYYY年MM月DD日'</td>
            <td>
                <p>格式化值</p>
                <p>YYYY - 年</p>
                <p>MM - 月</p>
                <p>DD - 日</p>
                <p>HH - 小时</p>
                <p>mm - 分钟</p>
                <p>ss - 秒</p>
            </td>
        </tr>
        <tr>
            <td>range</td>
            <td>[['2026-01-01','2026-06-30']]</td>
            <td>
                <p>限制选择范围</p>
                <p>[['2026-01-01','2026-06-30']] - 限制日期</p>
                <p>[['09:00','21:00']] - 限制时间</p>
                <p>[['2026-01-01',null]] - 单向限制</p>
            </td>
        </tr>
        <tr>
            <td>limit</td>
            <td>['weekend']</td>
            <td>
                <p>限制类型</p>
                <p>weekend - 周末</p>
                <p>weekday - 工作日</p>
                <p>sunday/monday/tuesday/wednesday/thursday/friday/saturday - 单向限制</p>
            </td>
        </tr>
    </tbody>
</table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[「2025 年终总结」在所有失去的人中，我最怀念我自己]]></title>    <link>https://juejin.cn/post/7603677143215161359</link>    <guid>https://juejin.cn/post/7603677143215161359</guid>    <pubDate>2026-02-08T15:34:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603677143215161359" data-draft-id="7603854784864780328" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="「2025 年终总结」在所有失去的人中，我最怀念我自己"/> <meta itemprop="keywords" content="后端,年终总结,前端"/> <meta itemprop="datePublished" content="2026-02-08T15:34:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Coredump"/> <meta itemprop="url" content="https://juejin.cn/user/1654082381026734"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            「2025 年终总结」在所有失去的人中，我最怀念我自己
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1654082381026734/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Coredump
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T15:34:16.000Z" title="Sun Feb 08 2026 15:34:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读27分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在 2026 的开始，我并没有许下什么新年愿望，似乎每一年都没有，但每一年都会经历很多难忘的事情。</p>
<p>这一年终究要过去了，我对 2025 的唯一感觉就是：<strong>年费会员快要到期了，该交钱了</strong>。</p>
<p>今年比往年要好很多，烟花凌空绽放，整座城市隆隆作响，极尽所能地宣告新年的到来，往年只有电视机里主持人带着职业假笑，高声呐喊这的倒计时，现在打开窗户，迎面扑来的是久违的焰火气息，让我想起遥远的过去。</p>
<p>尤记得初春，微雨悄然而至，零星的雨滴中，傍晚树下自行车的铃声随风轻轻荡漾，街角的灯光微黄，宛如一位老友向我低语，有些东西，永远的遗留在了过去。可能是在留在了初高中，或者本科，亦或者是研究生，无从知晓。</p>
<p>那时西边红霞满天，我却只顾东行。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94923f296f1a4349915c66b32dcd8702~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=kDzZKa%2FLh5qeiiQQib2NDZltctc%3D" alt="7623766c8e19a6e0cbd1497c97a4b53e" loading="lazy"/></p>
<h2 data-id="heading-0">#01 夏</h2>
<p>暑期实习挺不顺利的，人很丧，没自信，没目标，也错过了很多机会...</p>
<p>想回到暑期前重新开始，但没办法，回不去了，这就是人生，只有错过点什么，你才学得会珍惜</p>
<p>就好像我这辈子也回不到大一大二的学习状态一样，或者说，人这一生，都不能走回头路</p>
<p>很多年来，我一直持续在问自己一个问题，怎么就变成这样了呢？</p>
<p>最近，这个问题变成了，害，那又能有什么办法呢 😮‍💨</p>
<p>暑期最有希望也是最想去的华子也泡死在池子里了，那个组的方向我是真感兴趣，可惜最后还是没能等来 offer。</p>
<p>看到一个北大的哥们，比我晚入池，过几天就开奖了，HR 和我说，或许这就是北大的魅力吧。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/49386daf91f5446c97fc89ed6ce84156~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=l%2F%2FeBTcfTPOM%2FH2%2FhamkLVI43H8%3D" alt="image-20250628032513786" loading="lazy"/></p>
<p>也不知道为什么，这些年，身边的人总会有种觉得我很厉害的错觉，拜托，我要是真厉害，我还用发愁这些毕业、就业的事么，这样我就不用吃生活的苦了</p>
<p>有时候就觉得自己活得很荒谬，三天两头垂头丧气跟失恋似的</p>
<p>朋友问我怎么情绪不对，我总不能告诉他最近暑期挂麻了，看不到未来吧</p>
<p>突然想明白了为什么互联网公司互相称呼同学，国企互相称呼老师，<strong>因为同学会毕业，早晚而已</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1fd5898f6d7840e1b3b97e8c242c60a2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=G2P%2BAKB31iVv5IXWSVyYbWLk5Xo%3D" alt="94628a820e12dc46f30efd54d788a640" loading="lazy"/></p>
<p><strong>这并不是一份多么值得让人羡慕和追逐的工作</strong></p>
<p><strong>在这里，人也并没有太多的时间想以前和以后</strong></p>
<p>那段颓废在宿舍刷视频的时间，经常刷到蜡笔小新和海绵宝宝，不得不说在那个年代，做得是真好</p>
<p>小学的时候是最应该看蜡笔小新的时候</p>
<p>高中的时候是最应该看斗破苍穹的时候</p>
<p>但我研究生的时候才开始沉迷这俩玩意</p>
<p>不过仔细一想，我现在和高中时候确实有点不一样了，比如高中时候我玩英雄联盟宁死不投，现在我看打不过了 15 分钟就上票了，不能让对面虐菜爽</p>
<p><strong>能打过我的人，我不给他们打</strong> ...</p>
<p>人总应该是有点变化的，但我最近又有些新的理解了，成长是一件很难的事，它甚至意味着从头去修改你的一部分人生意义</p>
<p>打个比方：你连体重都控制不了，怎么能控制自己的人生呢？</p>
<p>朋友说没办法，现在大伙都找着了工作，体重确实不好减</p>
<p>真不好减，最近东子、团子和阿里打外卖价格战，快给我喝出糖尿病了</p>
<p>暑期有个好朋友跑北京实习了，还有一个去了杭州，读书时哥几个总是经常打哈哈，不过一到上班，感受又不一样了</p>
<p>出发前几天，我说了一句“今日一别，小半年又见不到了，不过咱们的学生生涯好像也就一年多了”，他们没说话，也许是我们经历这寻常的分别太多了，本来早就习惯了，这时候突然来了个人对你说：</p>
<p>嘿，你已经和这么多人走散了呀</p>
<p>大多数人分开后就不会再见了，而有些人或许还有再见的机会</p>
<p>回忆会陪你一生，即使再模糊，你还是忘不掉</p>
<p><strong>聚散离合，此乃常态，你要习惯</strong></p>
<p>纵观个人的命运，当然要靠自我奋斗，但也要考虑到历史的行程，但不幸的是，现在历史的进程并不乐观。</p>
<p>在比较小的时候，大约就是初中高中吧，我对自己人生结果充满幻想和期待。但慢慢长大之后，方才意识到生活是如此复杂，我不得不学着对内心的期望放手，曾经的梦想在残酷的现实面前变得褪色。慢慢发现有些事并不是一件需要被解决的事情，而是一件需要被接受的事情，或者说，绝大多数的事情，都只是需要接受的事情，你解决不了。</p>
<p>比如在地球 online 度过的这二十几年来看，改变的话起码要拿年来衡量，或者十年来衡量。</p>
<p>此时，怜悯自己显得很重要，或许你可以对自己说“我也想要做得更好”以及“就让它这样吧，其实这样也好”。</p>
<p>是的，我已经做得足够好了，因为至少现在我还爱着自己｡</p>
<h2 data-id="heading-1">#02 秋</h2>
<p>其实，我从来没想过要如何准备才能在秋招拿到大厂的 offer，或是白菜，或是 SP、SSP</p>
<p>我一直以来去实习，一是想顺道去别的城市看一看，二来，也是一直都想真正的写出一些好的代码，被重视的代码，听起来很理想化，但这也让我阴差阳错的实习了不少段</p>
<p><strong>在我过往的十年中，凡是我努力追逐的事，往往都无法实现，而那些真正实现的，其实都是意料之外</strong></p>
<p>所以我觉得如果一件事有 100% 的把握，就没有去做的兴致了</p>
<p>🧑‍💻面试官：这就是你笔试只做出来一半的原因吗？</p>
<blockquote>
<p>后来看到个段子，很后悔没给面试官发：</p>
<p>“这代码我有三不写”</p>
<ul>
<li>第一：不能复制的我不写，因为别人的轮子写好了我干嘛不用</li>
<li>第二：不让我用 ChatGPT "辅助"的我不写，因为基础的东西我都会，写了没意义</li>
<li>第三：太难写的我不写，因为我还没有到那个境界，写不明白</li>
</ul>
</blockquote>
<p>现实就是这么残酷，还没来得及从暑期实习的失落中走出来，秋招就开始了，比 emo 更难受的事情是，不能 emo 太久。</p>
<p>朋友说，当一个人过得不好时，才会怀念过去。难怪秋天刚开始，我就已经在怀念夏天了。</p>
<blockquote>
<p>这过日子就是问题叠着问题，我唯一能做的，就是迎接这些问题。  ——《士兵突击》</p>
</blockquote>
<p>几十年前，似乎呢群领图灵奖的巨佬总会在领奖的时候很自豪的说，我是一名程序员</p>
<p>但现在提起程序员，我总会想到 CSDN 上那只秃头虚弱无力的猿猴趴在电脑前，用巨大的手敲打着键盘</p>
<p>所以我很不喜欢 CSDN，当然 CSDN 也确实做的很烂，也算没有辜负我的感情</p>
<p>我没那么喜欢互联网，互联网是一种很割裂的存在，特别是在国内，比如互联网的 OKR，很有意思的是，在互联网 OKR 本来就是要完不成的，如果有一天你完成了你的 OKR，不是说你超出预期，而是说明你的 OKR 制定的有问题</p>
<p>我很想说这个行业病了，但其实我也改变不了啥，唯一改变的就是工作越来越难找了，同龄人之间要更卷了而已</p>
<p>没有乌托邦，只有维也纳在等我们</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d0518cc58074c2fad7013ce556698ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=hkJEw%2BsfyewebAV898Zy7s0lFe4%3D" alt="Screenshot 2025-08-10 at 15.42.18" loading="lazy"/></p>
<p>但我喜欢编程，我就想工作得能开心点，从来没想过在互联网待一辈子，<strong>而且即使我想，我的老板可能也不想</strong></p>
<p>面试很短，这几十钟其实是看不出来我的优点的，我每次面完都感觉没有发挥得尽兴，没有展示出来给面试官最好的一面</p>
<p>但我的缺点还是一览无余的</p>
<p>有一次面 HR 面的时候，HR 让我给一个词来形容自己，我说的是重感情</p>
<p>HR 说第一次见到这样的回答，让我举个例子</p>
<p>我想了想，说如果你司招我，那我会先考虑你司</p>
<p>也不知道 HR 满不满意这个回答</p>
<p>想起来本科的老学长，从闲鱼跳去了美团，换了个 base，最近经常加班，有人问是为了什么</p>
<p>学长说是为了爱情，真好，那时候有那么一瞬间，我很羡慕，似乎这一切都和技术没有关系，与世俗的荣誉，权力都没有关系</p>
<p><strong>我喜欢纯粹的东西，面试也是</strong></p>
<p>我如果觉得一个面试官不真诚，我就不会去这家公司，如果我有选择的话</p>
<p>以前觉得做选择时兴趣没有那么重要，但现在看来，那一点平日里微不足道的热爱，会成为在动摇时至关重要的那一份权重</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67e7e3c7c9f94a17ba8327556ffcb6a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=h9zAtINPmlnD%2B%2F21k9CRRSZZVAw%3D" alt="image-20260206171454503" loading="lazy"/></p>
<p>有时候想毕业直接回到老家，又觉得辜负了自己的初心和一身技术</p>
<p>朋友说不对，<strong>你现在没啥技术，谈不上辜负</strong></p>
<p>说的也对，走一步看一步算了😄</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f5aa37161c8e40f4af5c03a57b00f122~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=Q2X%2FyLFeNWq%2BSeR4d%2BKeAKsxozE%3D" alt="img" loading="lazy"/></p>
<p>不过程序员有一大悲哀就是，成为了程序员就会只把自己当成程序员，因为身在这个环境中，但其实如<strong>果跳出这个环境，发现还是正常生活的人多</strong>。</p>
<p>计算机是严格理性与规范的学科，但我觉得也很浪漫，我们穷尽所有去提高技术，无论是设计模式，还是渐渐的模块化，微服务化，容器化，<strong>都是为了在未来一天，我们可以更好的被取代</strong>，这个工作，在一开始，便注定了悲壮和浪漫。</p>
<p>但有时我会想，这个行业，值不值得我投入如此的热忱，我是个没有梦想也能生存的人，高中的朋友总喜欢找一个梦想中的学校，一个梦想中追赶的人，一个梦想中的行业。但我这些都没有，朋友总觉得我是靠意志力撑过高三那段艰苦的岁月，其实不是，有没有梦想对我来说并不是那么重要。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c44abc56ec824475b0394da7c65bfdeb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=4L5eHAFG%2Bn%2BvqhfB7zI7PiilT2w%3D" alt="img" loading="lazy"/></p>
<p>朋友说，假设阳的挂掉一半，全国会失去大概 50% 的人口，不过很快又会恢复如初（生物小知识嗷：种群数量达到环境容纳量一半，即 K / 2 时，种群的增长速率最大），最终无数人的喜怒哀乐，生死离别，成为历史书上的轻如鸿毛的一笔，无论描写的多么惨绝人寰，也只是一笔罢了，而地球上所有惊天动地的大事，也不及宇宙中的一粒尘埃。</p>
<p>有时候在想生命的意义是什么，我想不明白，就像高三老师问我的梦想一样，问我想要当一个什么职业，成为一个什么样的人，我说我不知道，但一定不是以后拿 20w 年薪，30w 年薪，50w 年薪或者 100w 年薪。</p>
<p>因此不想卷了，是因为没有了卷的动力，其实最终不就是为了拿一份高薪的工作，我连对这个结果都没了兴致，又何谈过程，倒不是懒得奋斗，只不过什么时候奋斗渐渐的成了一种贬义词，我只是觉得途中的代价太大，不只是我一个人付出的，而是和我的朋友们一同付出的。</p>
<p><strong>无论是什么样的结果，我都觉得难以配得上这一路走来的失去</strong></p>
<p><strong>人行走江湖，就是不断的相遇和失去，第一次相遇是自己的生命，最后一次失去也是，有始有终</strong></p>
<p>我已经不喜欢再和别人卷了，但是到了一定程度后，身在其中，由不得我，不过，也算是一种磨练心境吧，倒也未必不是好事。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3997647fdc5748358f0b6dc09769e320~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=TUJuQmSGxUd4UTv%2B%2BlmQ2njoI64%3D" alt="Screenshot 2025-08-10 at 15.37.42" loading="lazy"/></p>
<p>所以生命的意义是什么，我不知道，但是我会期待下一次和朋友相遇，在大学中遇到新的朋友，新的乒乓球友，我会和以前一样期待，但是不会再像以前一样严格规划我的人生了，比如某个时间点非做某件事不可，非要达到某个成就不可。</p>
<p>在学校的时候，如果不是很忙我就喜欢到外面去吃个鸡锅，如果忙的话就推到明天去吃，明天忙就推到后天，<strong>人总是寄希望于后来，也习惯把这辈子没有得到的人和事寄予到下辈子，总会说我下辈子要怎样怎样。可如果这辈子就是你上辈子说的下辈子，那怎么办呢</strong>？</p>
<p>所以我现在选择想吃鸡锅的时候就直接去吃😋</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/11c3affdfcf548719d52c7bcf2aea815~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=CEaM2ds7%2Bqg5Ifm1jnqL5qiuDKk%3D" alt="image-20260206182133446" loading="lazy"/></p>
<p>那我会呆在哪里呢？HR 也问过我这个问题。</p>
<p>我说大概是厦门吧，我的爱人、挚友都在那里，或者是在那里陪伴过我一段很长很长的时间，比我在杭州西安待的时间加起来还要长很多</p>
<p>面试官笑得有些深意</p>
<blockquote>
<p>几年后被末尾淘汰的那一天，一切都将作废，之前的加班作废，之前从池子中挣扎出来的惊喜作废，之前的领导同事作废，之前的薪资待遇也作废，鼠标也会作废，键盘也会作废，所有的承诺也统统作废。从那一天开始，我不再需要电脑，不再需要八股，我的人生不再有 hello world。我知道是秋招那年的那场大雪覆盖了我前半生的荒唐，覆盖了我本科的学历，我和 985 硕一起进入阿里，我仿佛从其中看到了希望，但生活在无边的大雪中又何尝不是一种荒唐，当我真正走出这片大雪后，我肚子有些饿了，此时我才意识到，原来码农烧烤才是人生的归属。</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/898b60f4917546b08c17f4e9c4476c50~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=FnQJ1xEu6odF6gBR%2FG1BSSvtj%2F4%3D" alt="IMG_8164" loading="lazy"/></p>
<p>其实我也经常黑厦门的，我很难喜欢上某个城市，比起城市的高低贵贱，电子博弈，我更在意的是我与谁一起经历过什么，到过哪里，见过哪里的风景</p>
<p>我经常说厦门那地方，典型的工资低，物价高</p>
<p>朋友说他不是本地人，每次买海鲜都感觉买的很贵很贵，听厦大的学长说去码头买能便宜很多</p>
<p>我说不是，码头有一定概率买到新鲜的，而且很难买到便宜的</p>
<p>为什么说有概率买到新鲜的，因为那海鲜，你不清楚是刚从海里拉上来的，还是昨天搁市场溜了一圈又拉回去的，反正在人看来，都是刚从船上拉下去，带着新鲜的海水和被折腾的半死不活的鱼</p>
<p>至于价格，人们一般都会吹鼓自己的是野生的，众所周知的道理，野生的更贵，<strong>也没有手段证明它是不是真的野生鱼，除了价格</strong></p>
<h2 data-id="heading-2">#03 厦</h2>
<p>读了好多年书，如果能顺利毕业的话我就要毕业了，<strong>这话看起来没什么信息量，和我读的硕士一样</strong>。</p>
<p>看树洞有人问保研和考研哪个更辛苦，我不用点开都知道评论区铁定开战了</p>
<p>一个老哥说的很有意思，差点看破防了</p>
<p><strong>读研更辛苦</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/507e271cdd05427db7b53d329c40b117~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=UgqqDwhKbqJtmscoKv9taTx932A%3D" alt="b1aa7170df5fcb1ed7046ec6c77874fe" loading="lazy"/></p>
<p>记得有一天发研究生补助的时候我还在和朋友聊天</p>
<p>朋友说他感觉人生只剩下了银行卡里的一串串数字，收入和支出，感觉像是把灵魂卖给了社会，照镜子的时候感觉双眼都变得浑浊了</p>
<p>我看了眼屏幕里那一堆减号里面的醒目的“➕600”，还是国家赏饭，我应该是肉身和灵魂都卖给了学校，还是那种 19 世纪美国南方黑哥摘棉花的价格</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb09d2d1fbfb494aac60e52c3f88c57f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=q%2F%2FlsflQJDskCvKXHrwNLLrQ6Nc%3D" alt="IMG_5800" loading="lazy"/></p>
<p>和朋友闲聊，如果能再选一次的话我一定不会读研，哈哈</p>
<p>人就是这样，总会在某个时期觉得自己曾经做的事情不正确，说不定再过几年我又觉得现在做的不正确了</p>
<p>不过话说回来，当年觉得自己能保研可厉害了，现在想想就和网上那种看着小时候一面墙的奖状一样，叹息之墙</p>
<p>人还是不要美化从未走过的那条路，不然就会一直纠结和后悔，然后发现这辈子然后很快就过去了</p>
<p>也慢慢觉得自己老了，因为回过头看，发现自己已经配不上过去的自己了</p>
<p>如果在当年知道未来是这样，或许根本撑不过高考那段时光</p>
<p>多年之后，我又梦到那天，画面遥远，仿佛回到高考那一天</p>
<p>感觉，稍微有点生不逢时罢了</p>
<p>想起来前段时间公司宣讲，说我们赶上了一个很好的时代，因为有 AI，可是 AI 并没有发挥它应有的作用，并没有让工作量减少，工作时长减少，也没有降低生活成本，房价物价，看病还是一样昂贵，大家的压力也都还是很大，甚至更焦虑了，我们并没有因此变得更幸福</p>
<p>长期来讲，我很看好 AI，但此时此刻，并不觉得这是一个多么好的时代，即使见证了从传统 CV、NLP 到大模型的蜕变。大模型发展得太快了，还记得 22 年刚出 GPT-3.5 的时候，有人感慨涌现就像宇宙给的礼物一样神奇，现在已经没有人再发出这种感慨了，默认大模型就存在和人类差不多甚至更强的智力了，没有上古时期 NLP 用 BERT 胡言乱语的折磨</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e1677b05db35482cbff65058ee3ae914~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=aFQWRG5SOZWhKyHkGeIlNXHZgwU%3D" alt="33d3a6e6a7db04a50aead8040afc78b1" loading="lazy"/></p>
<p>想起个很好笑的事，以前研究生方向不是 CV 就是 NLP，现在 CV 还有点，感觉 NLP 已经绝迹了，虽然大模型也算是一种 NLP 吧，但已经没有哪个老师招生的时候会给你说：同学，我的研究方向是 NLP 🤣</p>
<p>现在已经到 AI Agent 时代了，国内外的 AI 产品层出不穷抢占市场，也不得不感叹国内 AI 大战的朴素，一代人有一代人的鸡蛋要领</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aed3c4a7a6b64877b33771be93454380~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=COH9R5m2lC0cKBiEK8s8mDdKNqQ%3D" alt="140c831cdcc83abd3e65bf054a050db3" loading="lazy"/></p>
<p>感觉我们的世界对慢节奏的人很不友好，那种田园牧歌的时代早就一去不复返了。我曾经对科研的憧憬完全来自于牛顿和苹果树，康德漫步于小径，梭罗隐居瓦尔登湖，而不是坐在电脑面前，脊柱侧弯、屁股很酸、眼睛散光，和计算机打交道，未来只有吃不完的苦。</p>
<p>我曾经觉得我是会喜欢科研的，在我想出老师也没想出来的课题的时候，提出不一样的见解的时候，在组会分享论文的时候，做出耳目一新的 PPT 的时候。</p>
<p>也许我确实是，但是我连打游戏都没法一天八小时持续一个月，社交不行，跑步不行，吉他也不行，唯一成功坚持过的看似也只有读书，读高中的时候，但也得考虑到咱们学六门课呢，而且真是差点就死了。</p>
<p><strong>我不喜欢科研，至少暂时不喜欢</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a7e7d336a8b64f15930f1a65ac44b57b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=dyXiaBhwlP%2BitV%2FVdLPq8BHdFI8%3D" alt="IMG_3128" loading="lazy"/></p>
<p>人擅长什么领域，就会在心中的价值天平上给它加码，以确保自己的价值在自己心中过得去。我想高考之于我几乎所有的意义就在于此了。我确认自己的才能、价值、潜力，我知道我的头脑不会背叛我。</p>
<p>不过我也因此发现，无论一篇论文写得多好，总能挑出来毛病，只要我想挑毛病</p>
<p>不是我有多么丰富的知识和见解，而是我必须得挑，因为组会轮到我分享论文了</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/72112686cd51449eb92a293a5727dfb9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=Y5YxIHa%2BN%2FktYnWRGL7WHLENOC4%3D" alt="IMG_2423" loading="lazy"/></p>
<p>我时常惊叹于我朋友的学习能力和科研水平，也惊叹于我朋友为人处事的八面玲珑。</p>
<p>从小到大我见过的成绩好的人太多了，然而天下英雄如过江之鲫，即使你万里挑一，在这里也有 14 万个，更何况世界不止中国。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/42c9c3e34ec244a4bdf95438024619be~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=rkfWB8cGme%2F6P04wthQgABm1bK4%3D" alt="Screenshot 2025-08-10 at 15.34.22" loading="lazy"/></p>
<p>然而幸福是一种独立于客观存在的能力，就像物债二分法，所有权的变动无效并不意味着买卖合同无效 —— 你看到什么，听到什么，感受到什么，才是最重要的，跟客观世界是什么样的、跟别人怎么看你无关。</p>
<p>所以幸福不是那种一下被人流推到癫狂的短暂欢乐，而是一种长期平和的满足。就按一线城市人均寿命 80 岁来算，扣除最后几年没有质量的生命，再扣除已经过去的 18 年，以及 4 年本科、3 年硕士占据现有生命的份额，又能剩下多少年的人生呢？</p>
<p>既然人生永远没有岸，你的体验难道就不重要吗？</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ecd40e9a5c04462fb6af820a73682881~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=fYaVwdzeph6QamW9bI8uCen8aAI%3D" alt="Screenshot 2025-08-10 at 15.40.13" loading="lazy"/></p>
<p>有时会想，到底什么样的人生是幸福的人生呢？</p>
<p>有项研究表明，一个人在年老的时候身体和灵魂都很健康，还对自己很满意的话，他的人生就是幸福的。这里既包含了个人对自己的评估，也要考量医生和心理学家的评估。</p>
<p>这个研究的好处是把幸福的人生具体化了。不过，研究也表明，你可能等不及到退休的时候再来评估自己的一生。</p>
<p>所以朋友说他在犹豫交不交养老保险，他感觉活不到退休，即使活到了，按当前生育率推断，也是大概率没人给我们交养老金。</p>
<p>总觉得人生路很长，未来还可以做很多事，我想了想<strong>也未必很长，人很难说什么时候会死</strong>，朝生夕死也并非不可能</p>
<p>我们总是以对未来美好的憧憬，来假释当下的苦难，只是美好一直没有到来，竞争倒是永无止息</p>
<p>我不想这样，但有时候又没得选</p>
<h2 data-id="heading-3">#04 倒带人生</h2>
<p>从我记事起，就记得姥姥家的院子里，种着一颗大银杏树。每年春夏，枝头总是挂着一片绿意。等秋天一到，金灿灿的叶子就在风中招摇。风将落叶带去远方，天空飘着的云很是明亮。我只是安静地看着，邻居家那只爱趴在我家屋檐上，呼呼大睡的猫咪，就能虚度一下午的时光。</p>
<p>我这人很简单</p>
<p>如果有星巴克和瑞幸，我一定会去喝瑞幸，因为我喝不出他们有什么区别</p>
<p>但如果是瑞幸和库迪，我一定会去喝瑞幸，哪怕瑞幸十几块一瓶，因为我喝得出来区别</p>
<p>我喜欢没有意义的东西，或者说纯粹的东西，比如喜剧片或悬疑片，我不喜欢对我说教的，蕴含深刻道理的喜剧，这种还不如让我去看黑马程序员网课和国考 980 系统班</p>
<p>小时候我看了好几次东邪西毒，但当时看不懂，所以更喜欢东成西就这样纯粹的荒谬与欢笑，大话西游这样的刻骨铭心的感情</p>
<p>在王家卫的电影哲学里，武侠、江湖皆成摆设，唯有爱与孤独才是亘古不变的精神主题</p>
<p>父母总说长大后就能看懂，但我已经很久没有再看了，因为我觉得我还是看不懂</p>
<p>有些东西，我并不觉得会随着阅历或者经验的增长而改变</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10bb350ff4784eb4863e17859eb4536c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=G40y4FnA1%2BH%2Fnq7P2IYWJ7occbc%3D" alt="Screenshot 2025-08-10 at 15.39.55" loading="lazy"/></p>
<p>一次偶然，初中同学聊天，他说我变了，其实好多人也说过，到初中之后就开始了</p>
<p>不过他们总会对外貌成绩一类的感兴趣，或者感到惊讶</p>
<p>其实人真正改变的是内心，内心的改变是几乎不会表露在外的</p>
<p>所以我一般都把他们的话当耳旁风</p>
<p><strong>因为从来没有人问过我经历过什么</strong></p>
<p>我有时会想到一个高中时很好的朋友身前，一个和我在大大小小的考试中对于名次较劲的人</p>
<p>我曾经很想问问他，你看我有几分像从前</p>
<p>但是已经觉得有些意兴阑珊，坚如磐石的友谊也会在岁月下磨损，最终消逝</p>
<p>极少数人属于木桶中的美酒，岁月流逝后，反而越发醇香</p>
<p>很明显，即使是他，也属于前者</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c47a5f0abcbe48fc867dbfe9a457c39f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=ID8MIyrzUeL95%2BWRAj%2F75W7xKgA%3D" alt="Screenshot 2025-08-10 at 15.34.59" loading="lazy"/></p>
<p>我一直觉得，我以前和现在，本质上并没有太大的变化，直到我看到曾经自己写的日寄</p>
<p>我需要承认，我和以前不一样了</p>
<p>我不再敢打敢拼，不再义无反顾，我会犹豫，会权衡利弊，会害怕未来，会怀疑自己</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef9a78845f994e47a2ebd458abde97e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=HBoEumVPMucIcdo0ccv44p6TcXU%3D" alt="Screenshot 2025-08-10 at 15.31.15" loading="lazy"/></p>
<p>很久以前看 anlin 老师的文章，记得评论区有句话说，说是如果有一天 anlin 老师不再更新文章了，说不定不是一件坏事，因为这说明 anlin 老师在努力生活，或者过得不错，所以不再写日寄了</p>
<p><strong>可我不是</strong></p>
<p>我想把这句话改改，我的日寄大多数时候都很丧，其中虽然有我个人的原因在，但也有深夜写文章的 buff 加成，我希望有一天，大家都能过得不错，这样就不用看我的文章来找一些什么精神共鸣了，但我还是希望提供一些其他东西在，比如我的失败经历、我的踩坑经验，也希望对你有些帮助</p>
<p>有时候总在想人到底为了什么而活</p>
<p>我问家里一个长辈，他说是为了他女儿，我觉得太俗套</p>
<p>我问还在上高中快要高考的表妹，她说是为了自己，我觉得太热血</p>
<p>我问了不少人，大多说法都很千篇一律</p>
<p>我想到问一个大学时候很中二的朋友，他说我脑子是不是进水了</p>
<p>我说我在思考人生，这是个大事</p>
<p>他说福州有家日料自助打折了，准备找空去吃</p>
<p>我也在看自助，但是自助的价格总是很贵</p>
<p>但是要是能睡前买一张自助餐票，然后睡醒了去坐一段不长不短的地铁，狠狠地吃一顿</p>
<p>这样活着也还不错</p>
<p>但人总会告别这个世界，如果是生病的话，应该会有一个时间周期，如果真有这么一天，我不希望你遇到我时，和我说你有多舍不得我，什么没我不行，什么明明知道没有希望还鼓励我的话，什么没有你日子怎么过，你有什么事情还没有做，等你好了我们一起去怎样怎样...</p>
<p>我更想听的是，你有多么怀念我，我这辈子已经完成了什么，告诉我接下来的日子没有我你们仍然会好好过</p>
<p>这就足够了</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f48ccdb5a603468da441529dee154ea6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=yZQfqXiuvAYkxxvY%2FEqij%2BxBxsk%3D" alt="image-20260207193109269" loading="lazy"/></p>
<p>最近贼有意思，朋友和对象吵架要分手，朋友的对象问：那我们之前的回忆算什么？</p>
<p>TA 说这算你记性好</p>
<p>女生又说：如果未来再相见呢？</p>
<p>TA 说那算你运气好</p>
<p>我的运气就挺点背的，说了再见的人基本没能再见过</p>
<p>有些缘分就像北平的秋雨，不贪心便是落叶轻覆的思念，过分执着就成了望不穿的绵绵水帘</p>
<p><strong>一生很长，很多人不会永远在我的生活里，但会永远在我的故事里</strong></p>
<p>朋友说酒是万能的，配什么都能喝，也没什么忌口</p>
<p>我说也不一定，和头孢就能起反应</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a9089c51e340438da5ec47ee465d1a1c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=shZO0vPFvhEjwsnVWRxDI7YlN1U%3D" alt="Screenshot 2025-08-10 at 15.38.56" loading="lazy"/></p>
<p>最近快放假了，我朋友说好久没来见过我了，问我有没有空，说是想我了</p>
<p>我发现人可以用懒这个词解释很多事情，特别是在现代社会</p>
<p>比如懒得起了，懒得学了，懒得卷了，懒得见了</p>
<p>摆烂这个词挺好，可以称得上是立体防御</p>
<p>什么时候等我摆明白了，或许就看开了</p>
<p>有时也会想在寒假去见一见多年未见的朋友，有时又觉得不值得</p>
<p>比如舍弃一些实习的机会，科研的时间</p>
<p><strong>为了所谓的正确、成功，人们不断失去</strong></p>
<p>我是那种会因为预料到将来的离别而去珍惜与当下朋友相处时间的人</p>
<p>但不是所有人都这样，所以大多数情况下我都是在浪费感情</p>
<p>这是一个流行离开的世界，但是我们都不擅长告别，时间不会抚平悲伤，只会让人淡然</p>
<p>我是个计划性比较强的人，但唯一不可能计划的便是生命的长度，我们往往在追寻其中忽视了它的宽度，忘记去创造更多的价值，我们不知道自己生命的长短，但我们现在还在这个世界上，就应该好好生活。生命本来就不长，焦虑也是一天，开心也是一天，为何不开开心心的过</p>
<p>最近看过一句话，不知道出自哪里，说是“今天可以死，明天也可以活”，这种境界是很高的</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b974f2769bc4898ae20e8f4e9d96bd4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=srEu%2FBsBThNxZA%2FZYuZrLj3FRqg%3D" alt="img" loading="lazy"/></p>
<p>当我在写这篇年终时，正在为学习和生活上的一地鸡毛而烦恼着。</p>
<p>不知你们会不会也像我一样，在过去或未来的某个时刻，也在怀念着那个无忧的年代。</p>
<p><strong>落叶随着风一阵摆动，家乡的银杏树一直都在，可是我已经回不去了</strong></p>
<h2 data-id="heading-4">#05 生活碎片</h2>
<p>人的烦恼就是记性太好，如果可以把所有事都忘掉，以后每一天都是个新开始，你说多好</p>
<p><strong>时间改变了太多东西了</strong></p>
<blockquote>
<p>总要做点什么自己认为正确的事</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aefb24def2154712a20d8df727975885~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=vbp%2BuyG8%2FLbmunxGsFb3zXk84y4%3D" alt="IMG_8178" loading="lazy"/></p>
<blockquote>
<p>依旧 Eason</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a1599e47c29245d5892cad8e40881a06~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=irh%2BbbnDULwdhqAFA8pFoL1kIGc%3D" alt="IMG_8174" loading="lazy"/></p>
<blockquote>
<p>JayChou 今年倒是听少了</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f3e5001b47649ffa620b4caf928cfd6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=gTxB1AKk%2FUB5Cl10%2B9GYvMSSO4A%3D" alt="IMG_8176" loading="lazy"/></p>
<blockquote>
<p>LeetCode 2025</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f7ac0d3e7694c1eaaaa2063cb6c3c00~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=d1ux2tutaBbSJfW9XyfbDddidXk%3D" alt="IMG_6507" loading="lazy"/></p>
<blockquote>
<p>📷 摄影是我割舍不去的爱好</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3cc0127d12d748448da1bfa1ae067bab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=nwnweLSq5hc57DyPfkzMofPA5jc%3D" alt="6fba819e71870abe011e10ee428f6b07" loading="lazy"/></p>
<blockquote>
<p>略懂些游戏</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/725f4bc1dbd6491b91c04ad54ce837a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=SP%2BFLmVVRO%2Fa7XJMibb516hFb60%3D" alt="e8bd49c009317151783585ea76dba568" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bffa5e86e0004c8a99b1a94afa109ba2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=%2FK37sbnfFvskaV7yk7hH8Mdcb0M%3D" alt="858436270d98ea632151263fcf4daf5b" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67bf1e74508b409ea7dba074d54d18f4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=R6V2vIB5Qo0vBTWMZR6QX2R1zSU%3D" alt="IMG_8172" loading="lazy"/></p>
<blockquote>
<p>晚霞</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e4227ccd5f044f67a3e891165bd824a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=DqFy8wq9gqsON5U6QLkDHkdSrRE%3D" alt="8a743a6c20cd75acedb7908bfd0d1397" loading="lazy"/></p>
<blockquote>
<p>跨年晚会</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/518557190e9d4bd3b75e914eaf0b5ab0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=LhOiEVzC0NTlnwRqK6aIS2WvzAc%3D" alt="P1000439" loading="lazy"/></p>
<p>夜晚有风，但不冷，白天的余温还没散去，风吹来只觉得凉爽</p>
<p>很像大三刚保研完在湖边吹风的那个夜晚，意气风发</p>
<p>不过意气风发这个词仿佛永远都不再适合我了</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b29c54f0a1fe454898e8fbb26242afbe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29yZWR1bXA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771169660&amp;x-signature=yh94bvTXEsnW5H6l%2BD9eUY1MYL4%3D" alt="2e24ee37470ef4910e30365fd81c4659" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SeeDance Videos Generation API 对接说明]]></title>    <link>https://juejin.cn/post/7603854784864878632</link>    <guid>https://juejin.cn/post/7603854784864878632</guid>    <pubDate>2026-02-08T15:54:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603854784864878632" data-draft-id="7603959423127879680" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SeeDance Videos Generation API 对接说明"/> <meta itemprop="keywords" content="API,AIGC"/> <meta itemprop="datePublished" content="2026-02-08T15:54:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="崔庆才丨静觅"/> <meta itemprop="url" content="https://juejin.cn/user/1521379821230269"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SeeDance Videos Generation API 对接说明
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1521379821230269/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    崔庆才丨静觅
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T15:54:38.000Z" title="Sun Feb 08 2026 15:54:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读7分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>本文将介绍一种 SeeDance Videos Generation API 对接说明，它是可以通过输入自定义参数来生成SeeDance官方的视频。</p>
<h2 data-id="heading-0">申请流程</h2>
<p>要使用 API，需要先到 <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.acedata.cloud%2Fdocuments%2Fseedance-videos" target="_blank" title="https://platform.acedata.cloud/documents/seedance-videos" ref="nofollow noopener noreferrer">SeeDance Videos Generation API</a> 对应页面申请对应的服务，进入页面之后，点击「Acquire」按钮，如图所示：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d0565ee27074f1fb9f305a542b57322~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bSU5bqG5omN5Lio6Z2Z6KeF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771170878&amp;x-signature=2ZzBewf%2Fe1g7TkudgQac7UwLJ6M%3D" alt="" loading="lazy"/></p>
<p>如果你尚未登录或注册，会自动跳转到登录页面邀请您来注册和登录，登录注册之后会自动返回当前页面。</p>
<p>在首次申请时会有免费额度赠送，可以免费使用该 API。</p>
<h2 data-id="heading-1">基本使用</h2>
<p>首先先了解下基本的使用方式，就是输入提示词 <code>content.text</code>、类型<code>content.type=text</code> 以及模型 <code>model</code>，便可获得处理后的结果，具体的内容如下：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/82314d0e61cd41f59155cbbaefa41c1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bSU5bqG5omN5Lio6Z2Z6KeF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771170878&amp;x-signature=MkJ2Mj5AdQeIx5I0n68C6oz9H6g%3D" width="500" class="m-auto" loading="lazy"/></p>
<p>可以看到这里我们设置了 Request Headers，包括：</p>
<ul>
<li><code>accept</code>：想要接收怎样格式的响应结果，这里填写为 <code>application/json</code>，即 JSON 格式。</li>
<li><code>authorization</code>：调用 API 的密钥，申请之后可以直接下拉选择。</li>
</ul>
<p>另外设置了 Request Body，包括：</p>
<ul>
<li><code>model</code>：生成视频的模型，主要有<code>doubao-seedance-1-0-pro-250528</code>、<code>doubao-seedance-1-0-pro-fast-251015</code>,<code>doubao-seedance-1-5-pro-251215</code>,<code>doubao-seedance-1-0-lite-t2v-250428</code>,<code>doubao-seedance-1-0-lite-i2v-250428</code></li>
<li><code>context</code>：content的type可以是text，也可以是image_url, image_url支持图片链接和base64数组两种，image_url和text参数互斥。</li>
<li><code>service_tier</code>：有<code>default</code>和<code>flex</code>两种。</li>
<li><code>return_last_frame</code>：是否返回最后一帧</li>
<li><code>execution_expires_after</code>：执行超时时间。</li>
<li><code>callback_url</code>：需要回调结果的URL。</li>
</ul>
<p>选择之后，可以发现右侧也生成了对应代码，如图所示：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ce4cb7c015d4bb3991eb504bfc856c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bSU5bqG5omN5Lio6Z2Z6KeF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771170878&amp;x-signature=or3bz5Fmdq%2FpOwDCNfOjwVNjdbg%3D" width="500" class="m-auto" loading="lazy"/></p>
<p>点击「Try」按钮即可进行测试，如上图所示，这里我们就得到了如下结果：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ec22ae22-0140-4033-8c86-a48b536da595"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1cc87db0-8ee5-4436-969b-35cc571a9fd5"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cgt-20251222005129-62fhb"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"succeeded"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"video_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://platform.cdn.acedata.cloud/seedance/f592800a-b87c-4705-8796-cbb8018cae35.mp4"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"doubao-seedance-1-0-pro-250528"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>返回结果一共有多个字段，介绍如下：</p>
<ul>
<li><code>success</code>，此时视频生成任务的状态情况。</li>
<li><code>task_id</code>，此时视频生成任务ID。</li>
<li><code>trace_id</code>，此时视频生成跟踪ID。</li>
<li><code>data</code>，此时视频生成任务的结果列表。
<ul>
<li><code>task_id</code>，此时视频生成任务的服务器端ID。</li>
<li><code>video_url</code>，此时视频生成任务的视频链接。</li>
<li><code>status</code>，此时视频生成任务的状态。</li>
<li><code>model</code>，生成视频使用的模型。</li>
</ul>
</li>
</ul>
<p>可以看到我们得到了满意的视频信息，我们只需要根据结果中 <code>data</code> 的视频链接地址获取生成的SeeDance视频即可。</p>
<p>另外如果想生成对应的对接代码，可以直接复制生成，例如 CURL 的代码如下：</p>
<pre><code class="hljs language-shell" lang="shell">curl -X POST 'https://api.acedata.cloud/seedance/videos' \
-H 'authorization: Bearer ${bearer_token}' \
-H 'accept: application/json' \
-H 'content-type: application/json' \
-d '{
  "content": [{"text":"A kitten yawning at the camera. --rs 720p --rt 16:9 --dur 5 --fps 24 --wm true --seed 11 --cf false","type":"text"}],
  "model": "doubao-seedance-1-0-pro-250528"
}'
</code></pre>
<h2 data-id="heading-2">图生视频首帧</h2>
<p>如果想图生视频任务， 首先<code>context</code>参数需要选择<code>image_url</code>，并在其子节点<code>url</code>必须传入参考图片链接或者base64编码，请遵循此格式data:image/&lt;图片格式&gt;;base64,&lt;Base64编码&gt;，注意 &lt;图片格式&gt; 需小写，如 data:image/png;base64,{base64_image}，就可以指定如下内容：</p>
<ul>
<li>image_url：该图生视频任务采用的参考图链接。</li>
</ul>
<p>对应的代码：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests

url = <span class="hljs-string">"https://api.acedata.cloud/seedance/videos"</span>

headers = {
    <span class="hljs-string">"accept"</span>: <span class="hljs-string">"application/json"</span>,
    <span class="hljs-string">"authorization"</span>: <span class="hljs-string">"Bearer {token}"</span>,
    <span class="hljs-string">"content-type"</span>: <span class="hljs-string">"application/json"</span>
}

payload = {
    <span class="hljs-string">"content"</span>: [
        {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"image_url"</span>,
            <span class="hljs-string">"image_url"</span>: {
                <span class="hljs-string">"url"</span>: <span class="hljs-string">"https://ark-project.tos-cn-beijing.volces.com/doc_image/i2v_foxrgirl.png"</span>
            }
        },
        {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"text"</span>,
            <span class="hljs-string">"text"</span>: <span class="hljs-string">"A girl holds a fox in her arms. She opens her eyes and gazes tenderly at the camera, while the fox affectionately holds her back. As the camera slowly pulls away, her hair is gently blown by the wind. --ratio adaptive  --dur 5"</span>
        }
    ],
    <span class="hljs-string">"model"</span>: <span class="hljs-string">"doubao-seedance-1-0-pro-250528"</span>
}

response = requests.post(url, json=payload, headers=headers)
<span class="hljs-built_in">print</span>(response.text)
</code></pre>
<p>点击运行，可以发现会立即得到一个结果，如下：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"dc7cceb5-3c12-4de7-a5f4-abcbba3e8e39"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"b3b09de3-b7fa-4bb0-88b5-aad4b4a96fd4"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cgt-20251222072003-x2259"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"succeeded"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"video_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://platform.cdn.acedata.cloud/seedance/6afb78b8-5ba8-424f-adcd-69423a700b50.mp4"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"doubao-seedance-1-0-pro-250528"</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>可以看到，生成的效果是图生建视频的，结果与上文类似。</p>
<h2 data-id="heading-3">图生视频首尾帧</h2>
<p>如果想图生视频首尾帧， 首先参数<code>content</code>必须传入类型<code>image_url</code>,并且分别设置<code>role</code>为<code>first_frame</code>和<code>last_frame</code>，就可以指定如下内容：</p>
<ul>
<li>role：指定首帧或者尾帧。</li>
<li>image_url
<ul>
<li>url  图片链接
同时 <code>content</code> 还需要输入类型<code>text</code>作为prompt提示词</li>
</ul>
</li>
</ul>
<p>对应的代码：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests

url = <span class="hljs-string">"https://api.acedata.cloud/sora/videos"</span>

headers = {
    <span class="hljs-string">"accept"</span>: <span class="hljs-string">"application/json"</span>,
    <span class="hljs-string">"authorization"</span>: <span class="hljs-string">"Bearer {token}"</span>,
    <span class="hljs-string">"content-type"</span>: <span class="hljs-string">"application/json"</span>
}

payload = {
   <span class="hljs-string">"model"</span>: <span class="hljs-string">"doubao-seedance-1-0-pro-250528"</span>,
    <span class="hljs-string">"content"</span>: [
         {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"text"</span>,
            <span class="hljs-string">"text"</span>: <span class="hljs-string">"360-degree shot"</span>
        },
        {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"image_url"</span>,
            <span class="hljs-string">"image_url"</span>: {
                <span class="hljs-string">"url"</span>: <span class="hljs-string">"https://ark-project.tos-cn-beijing.volces.com/doc_image/seepro_first_frame.jpeg"</span>
            },
            <span class="hljs-string">"role"</span>: <span class="hljs-string">"first_frame"</span>
        },
        {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"image_url"</span>,
            <span class="hljs-string">"image_url"</span>: {
                <span class="hljs-string">"url"</span>: <span class="hljs-string">"https://ark-project.tos-cn-beijing.volces.com/doc_image/seepro_last_frame.jpeg"</span>
            },
            <span class="hljs-string">"role"</span>: <span class="hljs-string">"last_frame"</span>
        }
    ]
}

response = requests.post(url, json=payload, headers=headers)
<span class="hljs-built_in">print</span>(response.text)
</code></pre>
<p>点击运行，可以发现会立即得到一个结果，如下：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"f7096c6c-9430-4392-8201-d259632d7afd"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"4a4a3721-00fb-43d2-aff2-3b516ac01a8a"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cgt-20251222073134-54qcw"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"succeeded"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"video_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://platform.cdn.acedata.cloud/seedance/95f9f5f0-fc50-4c71-bc6f-e154582c141e.mp4"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"doubao-seedance-1-0-pro-250528"</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>可以看到，生成的效果是角色生成视频，结果与上文类似。</p>
<h2 data-id="heading-4">异步回调</h2>
<p>由于 SeeDance Videos Generation API生成的时间相对较长，大约需要 1-2 分钟，如果 API 长时间无响应，HTTP 请求会一直保持连接，导致额外的系统资源消耗，所以本 API 也提供了异步回调的支持。</p>
<p>整体流程是：客户端发起请求的时候，额外指定一个 <code>callback_url</code> 字段，客户端发起 API 请求之后，API 会立马返回一个结果，包含一个 <code>task_id</code> 的字段信息，代表当前的任务 ID。当任务完成之后，生成视频的结果会通过 POST JSON 的形式发送到客户端指定的 <code>callback_url</code>，其中也包括了 <code>task_id</code> 字段，这样任务结果就可以通过 ID 关联起来了。</p>
<p>输入<code>callbacl_url</code>点击运行，可以发现会立即得到一个结果，如下：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"f7096c6c-9430-4392-8201-d259632d7afd"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>当任务完成的时候，平台会将最后的结果以POST的形式推送到 <code>callback_url</code>的网址</p>
<p>内容如下：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"f7096c6c-9430-4392-8201-d259632d7afd"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"4a4a3721-00fb-43d2-aff2-3b516ac01a8a"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cgt-20251222073134-54qcw"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"succeeded"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"video_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://platform.cdn.acedata.cloud/seedance/95f9f5f0-fc50-4c71-bc6f-e154582c141e.mp4"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"doubao-seedance-1-0-pro-250528"</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>可以看到结果中有一个 <code>task_id</code> 字段，其他的字段都和上文类似，通过该字段即可实现任务的关联。</p>
<h2 data-id="heading-5">错误处理</h2>
<p>在调用 API 时，如果遇到错误，API 会返回相应的错误代码和信息。例如：</p>
<ul>
<li><code>400 token_mismatched</code>：Bad request, possibly due to missing or invalid parameters.</li>
<li><code>400 api_not_implemented</code>：Bad request, possibly due to missing or invalid parameters.</li>
<li><code>401 invalid_token</code>：Unauthorized, invalid or missing authorization token.</li>
<li><code>429 too_many_requests</code>：Too many requests, you have exceeded the rate limit.</li>
<li><code>500 api_error</code>：Internal server error, something went wrong on the server.</li>
</ul>
<h3 data-id="heading-6">错误响应示例</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"error"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"api_error"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"fetch failed"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2cf86e86-22a4-46e1-ac2f-032c0f2a4e89"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-7">结论</h2>
<p>通过本文档，您已经了解了如何使用 SeeDance Videos Generation API 可通过输入提示词以及参考图片来生成视频。希望本文档能帮助您更好地对接和使用该 API。如有任何问题，请随时联系我们的技术支持团队。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[能力中心 (Agent SkillCenter)：开启AI技能管理新时代]]></title>    <link>https://juejin.cn/post/7603783314713247780</link>    <guid>https://juejin.cn/post/7603783314713247780</guid>    <pubDate>2026-02-08T16:01:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603783314713247780" data-draft-id="7603911453704667179" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="能力中心 (Agent SkillCenter)：开启AI技能管理新时代"/> <meta itemprop="keywords" content="人工智能"/> <meta itemprop="datePublished" content="2026-02-08T16:01:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="OneCodeCN"/> <meta itemprop="url" content="https://juejin.cn/user/1427583415622366"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            能力中心 (Agent SkillCenter)：开启AI技能管理新时代
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1427583415622366/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    OneCodeCN
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T16:01:27.000Z" title="Sun Feb 08 2026 16:01:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">🌟 什么是能力中心？</h2>
<p>能力中心 (Agent SkillCenter) 是一个革命性的AI技能管理平台，为企业和个人用户提供全方位的技能生命周期管理解决方案。它不仅是一个技能市场，更是一个去中心化的AI能力生态系统。</p>
<h2 data-id="heading-1">🎯 核心功能亮点</h2>
<h3 data-id="heading-2">1️⃣ <strong>技能全生命周期管理</strong></h3>
<ul>
<li><strong>智能注册</strong>：自动化技能注册和验证</li>
<li><strong>高效执行</strong>：分布式技能执行引擎</li>
<li><strong>实时监控</strong>：技能执行状态和性能监控</li>
<li><strong>自动扩缩</strong>：根据负载自动调整资源</li>
</ul>
<h3 data-id="heading-3">2️⃣ <strong>去中心化P2P网络</strong></h3>
<ul>
<li><strong>节点发现</strong>：智能P2P节点发现机制</li>
<li><strong>技能分发</strong>：高效的技能分发网络</li>
<li><strong>安全通信</strong>：端到端加密通信</li>
<li><strong>故障容错</strong>：分布式架构确保高可用性</li>
</ul>
<h3 data-id="heading-4">3️⃣ <strong>个人AI中心</strong></h3>
<ul>
<li><strong>隐私保护</strong>：多级隐私控制机制</li>
<li><strong>设备集成</strong>：无缝连接智能设备</li>
<li><strong>数据同步</strong>：安全的数据同步服务</li>
<li><strong>个性化体验</strong>：根据用户习惯智能调整</li>
</ul>
<h3 data-id="heading-5">4️⃣ <strong>技能市场</strong></h3>
<ul>
<li><strong>智能推荐</strong>：基于用户行为的技能推荐</li>
<li><strong>评价系统</strong>：透明的技能评价机制</li>
<li><strong>安全交易</strong>：去中心化的技能交易</li>
<li><strong>版本管理</strong>：技能版本控制和更新</li>
</ul>
<h3 data-id="heading-6">5️⃣ <strong>企业级管理</strong></h3>
<ul>
<li><strong>团队协作</strong>：多人团队技能管理</li>
<li><strong>权限控制</strong>：细粒度的访问权限</li>
<li><strong>审计日志</strong>：完整的操作审计记录</li>
<li><strong>API集成</strong>：丰富的API接口</li>
</ul>
<h2 data-id="heading-7">💼 应用场景</h2>
<h3 data-id="heading-8">🏢 企业应用</h3>
<ul>
<li><strong>自动化工作流</strong>：将重复任务转化为可执行技能</li>
<li><strong>团队协作</strong>：共享和管理企业内部技能</li>
<li><strong>智能客服</strong>：部署专业领域的AI技能</li>
<li><strong>数据分析</strong>：快速构建和执行数据分析技能</li>
</ul>
<h3 data-id="heading-9">🧑‍💻 开发者生态</h3>
<ul>
<li><strong>技能变现</strong>：创建和销售专业技能</li>
<li><strong>快速迭代</strong>：敏捷的技能开发和测试</li>
<li><strong>社区贡献</strong>：参与开源技能生态建设</li>
<li><strong>技术创新</strong>：探索AI技能的新应用场景</li>
</ul>
<h3 data-id="heading-10">🏠 个人用户</h3>
<ul>
<li><strong>智能助手</strong>：个性化的AI生活助手</li>
<li><strong>学习工具</strong>：定制化的学习技能</li>
<li><strong>健康管理</strong>：智能健康监测和建议</li>
<li><strong>娱乐休闲</strong>：个性化的娱乐内容推荐</li>
</ul>
<h2 data-id="heading-11">🔧 技术架构</h2>
<p>能力中心采用现代化的技术架构：</p>
<ul>
<li><strong>后端</strong>：Java 8 + Spring Boot</li>
<li><strong>前端</strong>：HTML5 + JavaScript + CSS3</li>
<li><strong>存储</strong>：多种存储方案支持</li>
<li><strong>网络</strong>：P2P分布式网络</li>
<li><strong>安全</strong>：多层安全防护机制</li>
<li><strong>部署</strong>：支持多种部署模式</li>
</ul>
<h2 data-id="heading-12">📈 为什么选择能力中心？</h2>
<ol>
<li><strong>开放性</strong>：完全开源，支持自定义扩展</li>
<li><strong>去中心化</strong>：P2P网络确保数据安全和隐私</li>
<li><strong>易用性</strong>：直观的Web控制台和API</li>
<li><strong>可扩展性</strong>：模块化设计，易于集成新功能</li>
<li><strong>高性能</strong>：分布式架构，支持高并发</li>
<li><strong>安全性</strong>：多层安全机制保护数据和技能</li>
</ol>
<h2 data-id="heading-13">🚀 快速开始</h2>
<h3 data-id="heading-14">安装部署</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 克隆仓库</span>
git <span class="hljs-built_in">clone</span> https://github.com/oodercn/skillcenterdemo.git

<span class="hljs-comment"># 构建项目</span>
mvn clean package

<span class="hljs-comment"># 启动服务</span>
java -jar target/agent-skillcenter.jar
</code></pre>
<h3 data-id="heading-15">访问控制台</h3>
<p>打开浏览器访问：<code>http://localhost:8080/console</code></p>
<h2 data-id="heading-16">🌐 加入生态系统</h2>
<p>能力中心不仅仅是一个软件，更是一个不断成长的生态系统。我们欢迎：</p>
<ul>
<li><strong>开发者</strong>：创建和贡献技能</li>
<li><strong>企业</strong>：集成和定制能力中心</li>
<li><strong>研究人员</strong>：探索AI技能的新可能性</li>
<li><strong>爱好者</strong>：参与社区建设和讨论</li>
</ul>
<h2 data-id="heading-17">📞 联系我们</h2>
<ul>
<li><strong>GitHub</strong>：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Foodercn%2Fskillcenterdemo" target="_blank" title="https://github.com/oodercn/skillcenterdemo" ref="nofollow noopener noreferrer">github.com/oodercn/ski…</a></li>
<li><strong>官方网站</strong>：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2FooderCN" target="_blank" title="https://gitee.com/ooderCN" ref="nofollow noopener noreferrer">gitee.com/ooderCN</a></li>
</ul>
<hr/>
<h2 data-id="heading-18">🎉 开启智能技能新时代</h2>
<p>能力中心正在重新定义AI技能的管理和应用方式。无论您是企业用户、开发者还是个人用户，都能在这个平台上找到属于自己的AI能力解决方案。</p>
<p><strong>加入能力中心，释放AI的无限潜能！</strong></p>
<blockquote>
<p><em>"能力中心 - 连接智能，创造未来"</em></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[墨梅博客 1.4.0 发布与开源动态 | 2026 年第 6 周草梅周报]]></title>    <link>https://juejin.cn/post/7603911453704519723</link>    <guid>https://juejin.cn/post/7603911453704519723</guid>    <pubDate>2026-02-08T14:05:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603911453704519723" data-draft-id="7603673564909338659" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="墨梅博客 1.4.0 发布与开源动态 | 2026 年第 6 周草梅周报"/> <meta itemprop="keywords" content="GitHub,开源,AI编程"/> <meta itemprop="datePublished" content="2026-02-08T14:05:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="草梅友仁"/> <meta itemprop="url" content="https://juejin.cn/user/3043088413495815"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            墨梅博客 1.4.0 发布与开源动态 | 2026 年第 6 周草梅周报
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3043088413495815/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    草梅友仁
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T14:05:45.000Z" title="Sun Feb 08 2026 14:05:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读7分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>本文在 <a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmyr.ltd" target="_blank" title="https://blog.cmyr.ltd" ref="nofollow noopener noreferrer">草梅友仁的博客</a> 发布和更新，并在多个平台同步发布。如有更新，以博客上的版本为准。您也可以通过文末的 <code>原文链接</code> 查看最新版本。</p>
</blockquote>
<h2 data-id="heading-0">前言</h2>
<p>欢迎来到草梅周报！这是一个由草梅友仁基于 AI 整理的周报，旨在为您提供最新的博客更新、GitHub 动态、个人动态和其他周刊文章推荐等内容。</p>
<hr/>
<h2 data-id="heading-1">开源动态</h2>
<p>本周依旧在开发 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCaoMeiYouRen%2Fmomei" target="_blank" title="https://github.com/CaoMeiYouRen/momei" ref="nofollow noopener noreferrer">墨梅 (Momei)</a> 中。</p>
<blockquote>
<p>您可以前往 Demo 站试用：<a href="https://link.juejin.cn?target=https%3A%2F%2Fdemo.momei.app%2F" target="_blank" title="https://demo.momei.app/" ref="nofollow noopener noreferrer">demo.momei.app/</a></p>
<ul>
<li>您可以通过邮箱 <code>admin@example.com</code>，密码<code>momei123456</code>登录演示用管理员账号。</li>
</ul>
<p>或前往官网注册：<a href="https://link.juejin.cn?target=https%3A%2F%2Fmomei.app%2F" target="_blank" title="https://momei.app/" ref="nofollow noopener noreferrer">momei.app/</a></p>
<p>也可以前往文档站来了解项目整体规划和未来开发路线图：<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.momei.app%2F" target="_blank" title="https://docs.momei.app/" ref="nofollow noopener noreferrer">docs.momei.app/</a></p>
</blockquote>
<p>当前墨梅博客已经正式发布了 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCaoMeiYouRen%2Fmomei%2Freleases%2Ftag%2Fv1.4.0" target="_blank" title="https://github.com/CaoMeiYouRen/momei/releases/tag/v1.4.0" ref="nofollow noopener noreferrer">1.4.0</a> 版本，以下是页面和功能的一些截图。</p>
<p>新增了订阅中心和通知管理页面，可以一键管理订阅和通知。同时，也增加了 Atom 1.0 和 JSON Feed 1.1 格式的订阅支持。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ea8ee5b8d5340cf80f297ed9a79b8a3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5qKF5Y-L5LuB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771164345&amp;x-signature=%2B4gtDqGPK5FcCFQbFFFTIGre7wY%3D" alt="image-20260208200813141" loading="lazy"/></p>
<p>新增全局打赏和社交链接支持，及个人打赏和社交链接支持。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0bf4206f32254bc3be266ae2360e6f15~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5qKF5Y-L5LuB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771164345&amp;x-signature=VawkUZrE6AIEgJTAi2ETXT068Wk%3D" alt="image-20260208201222647" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0fb1da2768de4e239d5d4359f52320e0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5qKF5Y-L5LuB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771164345&amp;x-signature=tp%2BiuBb5v2ojFI0Vp%2F7GVoYOJjA%3D" alt="image-20260208211042923" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4252078c15824e02bcf692e1429629eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6I2J5qKF5Y-L5LuB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771164345&amp;x-signature=49xcLAXRf8F5%2BQsG%2FFjPeKV1He0%3D" alt="image-20260208211424622" loading="lazy"/></p>
<p>更多功能和页面可以前往<a href="https://link.juejin.cn?target=https%3A%2F%2Fmomei.app%2F" target="_blank" title="https://momei.app/" ref="nofollow noopener noreferrer">官网</a>体验，也可前往<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmyr.ltd%2Farchives%2F2025-51-caomei-weekly-momei-blog-mvp-caomei-auth-update.html" target="_blank" title="https://blog.cmyr.ltd/archives/2025-51-caomei-weekly-momei-blog-mvp-caomei-auth-update.html" ref="nofollow noopener noreferrer">之前的博客</a>查看截图。</p>
<p>欢迎各位用户体验。并提出意见和建议。</p>
<p>接下来的话还会继续按照路线图和待办进行开发功能，敬请期待。</p>
<p>当然，目前墨梅博客还有很多需要打磨的细节，功能上也还不完善，如有任何意见和建议，都可以在项目的 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCaoMeiYouRen%2Fmomei%2Fissues" target="_blank" title="https://github.com/CaoMeiYouRen/momei/issues" ref="nofollow noopener noreferrer">GitHub issues</a> 中提出。</p>
<p>如果你也对墨梅博客感兴趣，欢迎参与开发和测试。</p>
<h2 data-id="heading-2">最新 GitHub 仓库</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCaoMeiYouRen%2Fcmyr-skills-agents" target="_blank" title="https://github.com/CaoMeiYouRen/cmyr-skills-agents" ref="nofollow noopener noreferrer">cmyr-skills-agents</a> - 2026-02-02 02:21:41</li>
</ul>
<h2 data-id="heading-3">GitHub Release</h2>
<h3 data-id="heading-4">momei</h3>
<h4 data-id="heading-5"><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCaoMeiYouRen%2Fmomei%2Freleases%2Ftag%2Fv1.4.0" target="_blank" title="https://github.com/CaoMeiYouRen/momei/releases/tag/v1.4.0" ref="nofollow noopener noreferrer">v1.4.0</a> - 2026-02-07 20:08:32</h4>
<p>摘要:<br/>
版本 1.4.0 更新摘要 (2026-02-07)</p>
<p>新功能：</p>
<ul>
<li>新增翻译聚合功能，支持多语言翻译管理</li>
<li>后端添加用户协议和隐私政策管理功能</li>
<li>实现邮件模板国际化模块</li>
<li>开发 PrimeVue 与 Vue-i18n 动态同步插件</li>
<li>新增社交链接和打赏配置管理组件</li>
<li>扩展用户通知功能，新增通知设置和营销活动实体</li>
<li>添加 PrimeVue 中文语言支持</li>
<li>新增测试邮件发送和营销邮件预览功能</li>
<li>实现管理员通知设置页面，支持邮件和浏览器通知</li>
<li>新增营销中心页面及相关管理功能</li>
<li>添加赞助功能，支持社交链接和打赏管理</li>
</ul>
<p>Bug 修复：</p>
<ul>
<li>修复系统设置页面存储配置问题</li>
<li>优化 CLI 工具导入功能和参数验证</li>
<li>解决多个依赖版本兼容性问题</li>
<li>更新法律声明文本</li>
<li>修复未登录用户访问权限问题</li>
<li>增强设置获取的错误处理</li>
<li>改进国际化支持，添加常用词汇</li>
</ul>
<p>代码重构：</p>
<ul>
<li>优化验证码功能，支持 IP 和 UA 验证</li>
<li>改进 PWA 插件加载逻辑</li>
<li>使用新组件替换 HTML 渲染</li>
<li>更换富文本编辑器增强功能</li>
<li>简化协议和主题配置处理</li>
<li>统一 API 路径命名</li>
<li>优化用户管理界面国际化</li>
<li>简化代码结构，移除冗余组件</li>
</ul>
<h3 data-id="heading-6">eslint-config-cmyr</h3>
<h4 data-id="heading-7"><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCaoMeiYouRen%2Feslint-config-cmyr%2Freleases%2Ftag%2Fv2.1.3" target="_blank" title="https://github.com/CaoMeiYouRen/eslint-config-cmyr/releases/tag/v2.1.3" ref="nofollow noopener noreferrer">v2.1.3</a> - 2026-02-08 13:01:42</h4>
<p>摘要:<br/>
版本 2.1.3 (2026-02-08)</p>
<p>主要更新：</p>
<p>Bug 修复：</p>
<ul>
<li>新增 TypeScript ESLint 规则，禁止枚举类型与非枚举成员之间的比较操作</li>
</ul>
<h4 data-id="heading-8"><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCaoMeiYouRen%2Feslint-config-cmyr%2Freleases%2Ftag%2Fv2.1.2" target="_blank" title="https://github.com/CaoMeiYouRen/eslint-config-cmyr/releases/tag/v2.1.2" ref="nofollow noopener noreferrer">v2.1.2</a> - 2026-02-05 20:12:46</h4>
<p>摘要:<br/>
版本 2.1.2 (2026-02-05)</p>
<p>主要更新内容：</p>
<p>Bug 修复：</p>
<ul>
<li>允许在代码中使用非空断言操作符(!)来断言非空类型</li>
</ul>
<p>该版本主要解决了类型断言相关的问题，放宽了对非空断言操作符的使用限制。</p>
<h4 data-id="heading-9"><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCaoMeiYouRen%2Feslint-config-cmyr%2Freleases%2Ftag%2Fv2.1.1" target="_blank" title="https://github.com/CaoMeiYouRen/eslint-config-cmyr/releases/tag/v2.1.1" ref="nofollow noopener noreferrer">v2.1.1</a> - 2026-02-05 20:06:06</h4>
<p>摘要:<br/>
版本 2.1.1 (2026-02-05) 摘要：</p>
<p>Bug 修复：</p>
<ol>
<li>启用了推荐的类型检查配置并调整了 ESLint 规则</li>
<li>更新了 TypeScript ESLint 规则以增强类型检查和代码质量</li>
</ol>
<h4 data-id="heading-10"><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCaoMeiYouRen%2Feslint-config-cmyr%2Freleases%2Ftag%2Fv2.1.1-beta.2" target="_blank" title="https://github.com/CaoMeiYouRen/eslint-config-cmyr/releases/tag/v2.1.1-beta.2" ref="nofollow noopener noreferrer">v2.1.1-beta.2</a> - 2026-02-05 19:50:02</h4>
<p>摘要:<br/>
GitHub Release 摘要：</p>
<p>版本：2.1.1-beta.2<br/>
发布日期：2026-02-05</p>
<p>主要更新内容：</p>
<ul>
<li>Bug 修复：更新了 TypeScript ESLint 规则，增强了类型检查和代码质量</li>
</ul>
<h4 data-id="heading-11"><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCaoMeiYouRen%2Feslint-config-cmyr%2Freleases%2Ftag%2Fv2.1.1-beta.1" target="_blank" title="https://github.com/CaoMeiYouRen/eslint-config-cmyr/releases/tag/v2.1.1-beta.1" ref="nofollow noopener noreferrer">v2.1.1-beta.1</a> - 2026-02-05 19:19:08</h4>
<p>摘要:<br/>
版本 2.1.1-beta.1 摘要 (2026-02-05)</p>
<p>主要更新内容：</p>
<p>Bug 修复：</p>
<ul>
<li>启用了推荐的类型检查配置，并对 ESLint 规则进行了相应调整</li>
</ul>
<h3 data-id="heading-12">cookie-cloudflare</h3>
<h4 data-id="heading-13"><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCaoMeiYouRen%2Fcookie-cloudflare%2Freleases%2Ftag%2Fv1.5.0" target="_blank" title="https://github.com/CaoMeiYouRen/cookie-cloudflare/releases/tag/v1.5.0" ref="nofollow noopener noreferrer">v1.5.0</a> - 2026-02-08 01:41:46</h4>
<p>摘要:<br/>
版本 1.5.0 更新摘要 (2026-02-07)</p>
<p>主要更新内容：</p>
<ol>
<li>新功能</li>
</ol>
<ul>
<li>新增 Cloudflare 缓存刷新功能</li>
<li>更新了配置项以支持新变量</li>
</ul>
<p>本次更新主要增加了对 Cloudflare 缓存刷新的支持，并对相关配置项进行了相应调整以适应新功能。所有变更均可在提交记录 ef69717 中查看详情。</p>
<h2 data-id="heading-14">最新 GitHub 加星仓库</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Frainxchzed%2FGithub-Store" target="_blank" title="https://github.com/rainxchzed/Github-Store" ref="nofollow noopener noreferrer">CaoMeiYouRen starred Github-Store</a> - 2026-02-06 15:53:04<br/>
开源 GitHub 应用商店，支持一键浏览、发现和安装应用。基于 Kotlin 和 Compose Multiplatform 开发，兼容 Android 及桌面系统(Linux、MacOS、Windows)。项目主要使用 Kotlin 语言，获得 6438 星标。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fobra%2Fsuperpowers" target="_blank" title="https://github.com/obra/superpowers" ref="nofollow noopener noreferrer">CaoMeiYouRen starred superpowers</a> - 2026-02-04 14:11:30<br/>
一个有效的自主技能框架和软件开发方法论<br/>
主要使用 Shell 语言<br/>
GitHub 星标数达 47385</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxai-org%2Fx-algorithm" target="_blank" title="https://github.com/xai-org/x-algorithm" ref="nofollow noopener noreferrer">CaoMeiYouRen starred x-algorithm</a> - 2026-02-04 14:11:23<br/>
X 平台的 For You 推荐算法采用 Rust 语言开发，该项目已在 GitHub 获得 15106 颗星标。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fcavi-au%2FConsent-O-Matic" target="_blank" title="https://github.com/cavi-au/Consent-O-Matic" ref="nofollow noopener noreferrer">CaoMeiYouRen starred Consent-O-Matic</a> - 2026-02-04 14:11:14<br/>
一款基于 JavaScript 开发的浏览器扩展程序，可自动按用户偏好设置填写网站 cookie 弹窗。该工具已获得 3876 个 GitHub 星标，表明其在开发者社区中受到广泛关注和认可。</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2F4thfever%2Fcultivation-world-simulator" target="_blank" title="https://github.com/4thfever/cultivation-world-simulator" ref="nofollow noopener noreferrer">CaoMeiYouRen starred cultivation-world-simulator</a> - 2026-02-04 14:10:59<br/>
基于 Python 开发的开源修仙世界模拟器，采用 AI Agent 工作流技术构建动态演化的仙侠世界。该项目已在 GitHub 获得 764 星标，主要特点是通过智能代理系统模拟仙侠世界的开放性和复杂性。</li>
</ul>
<h2 data-id="heading-15">其他博客或周刊推荐</h2>
<h3 data-id="heading-16">阮一峰的网络日志</h3>
<ul>
<li><a href="https://link.juejin.cn?target=http%3A%2F%2Fwww.ruanyifeng.com%2Fblog%2F2026%2F02%2Fweekly-issue-384.html" target="_blank" title="http://www.ruanyifeng.com/blog/2026/02/weekly-issue-384.html" ref="nofollow noopener noreferrer">科技爱好者周刊（第 384 期）：为什么软件股下跌</a> - 2026-02-06 08:14:20</li>
</ul>
<h3 data-id="heading-17">潮流周刊</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fweekly.tw93.fun%2Fposts%2F256%2F" target="_blank" title="https://weekly.tw93.fun/posts/256/" ref="nofollow noopener noreferrer">第 256 期 - 上野天空</a> - 2026-02-02 08:00:00</li>
</ul>
<h3 data-id="heading-18">二丫讲梵的学习周刊</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwiki.eryajf.net%2Fpages%2Fddc309%2F" target="_blank" title="https://wiki.eryajf.net/pages/ddc309/" ref="nofollow noopener noreferrer">学习周刊-总第 249 期-2026 年第 06 周</a> - 2026-02-05 21:49:54</li>
</ul>
<h2 data-id="heading-19">总结</h2>
<p>本周的更新和动态如上所示。感谢您的阅读！<br/>
您可以通过以下方式订阅草梅周报的更新：</p>
<ul>
<li><strong>博客</strong>：<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmyr.ltd" target="_blank" title="https://blog.cmyr.ltd" ref="nofollow noopener noreferrer">草梅友仁的博客</a></li>
<li><strong>墨梅博客</strong>：<a href="https://link.juejin.cn?target=https%3A%2F%2Fmomei.app" target="_blank" title="https://momei.app" ref="nofollow noopener noreferrer">墨梅博客</a></li>
<li><strong>RSS</strong>：<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmyr.ltd%2Fweekly.xml" target="_blank" title="https://blog.cmyr.ltd/weekly.xml" ref="nofollow noopener noreferrer">草梅周报</a></li>
<li><strong>公众号</strong>：<a href="https://link.juejin.cn?target=https%3A%2F%2Foss.cmyr.dev%2Fimages%2F20241025184516839-21n2ctv.png" target="_blank" title="https://oss.cmyr.dev/images/20241025184516839-21n2ctv.png" ref="nofollow noopener noreferrer">草梅友仁的后花园</a></li>
<li><strong>邮箱订阅</strong>：<a href="https://link.juejin.cn?target=https%3A%2F%2Flistmonk.cmyr.dev%2Fsubscription%2Fform" target="_blank" title="https://listmonk.cmyr.dev/subscription/form" ref="nofollow noopener noreferrer">草梅友仁的博客订阅</a></li>
</ul>
<h2 data-id="heading-20">往期回顾</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmyr.ltd%2Farchives%2F2026-05-caomei-weekly-momei-1-3-0-release-server-backup-lesson.html" target="_blank" title="https://blog.cmyr.ltd/archives/2026-05-caomei-weekly-momei-1-3-0-release-server-backup-lesson.html" ref="nofollow noopener noreferrer">墨梅博客 1.3.0 发布与服务器数据备份教训 | 2026 年第 5 周草梅周报</a> - 2026-02-01 23:40:42</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmyr.ltd%2Farchives%2F2026-04-caomei-weekly-momei-1-2-0-release-ai-development.html" target="_blank" title="https://blog.cmyr.ltd/archives/2026-04-caomei-weekly-momei-1-2-0-release-ai-development.html" ref="nofollow noopener noreferrer">墨梅博客 1.2.0 发布与 AI 开发实践 | 2026 年第 4 周草梅周报</a> - 2026-01-25 22:23:13</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmyr.ltd%2Farchives%2F2026-02-caomei-weekly-momei-blog-1-0-release-update.html" target="_blank" title="https://blog.cmyr.ltd/archives/2026-02-caomei-weekly-momei-blog-1-0-release-update.html" ref="nofollow noopener noreferrer">墨梅博客 1.0.0 发布与更新 | 2026 年第 2 周草梅周报</a> - 2026-01-11 18:55:41</li>
</ul>
<p>本文作者：草梅友仁<br/>
本文地址：<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmyr.ltd%2Farchives%2F2026-06-caomei-weekly-momei-1-4-0-release-open-source-updates.html" target="_blank" title="https://blog.cmyr.ltd/archives/2026-06-caomei-weekly-momei-1-4-0-release-open-source-updates.html" ref="nofollow noopener noreferrer">blog.cmyr.ltd/archives/20…</a><br/>
版权声明：本文采用 <a href="https://link.juejin.cn?target=https%3A%2F%2Fcreativecommons.org%2Flicenses%2Fby-nc-sa%2F4.0%2Fdeed.zh-hans" target="_blank" title="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans" ref="nofollow noopener noreferrer">CC BY-NC-SA 4.0 协议</a> 进行分发，转载请注明出处！</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[【节点】[DiffusionProfile节点]原理解析与实际应用]]></title>    <link>https://juejin.cn/post/7603911453704536107</link>    <guid>https://juejin.cn/post/7603911453704536107</guid>    <pubDate>2026-02-08T14:10:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603911453704536107" data-draft-id="7603781883974090771" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="【节点】[DiffusionProfile节点]原理解析与实际应用"/> <meta itemprop="keywords" content="游戏开发,图形学,Unity3D"/> <meta itemprop="datePublished" content="2026-02-08T14:10:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SmalBox"/> <meta itemprop="url" content="https://juejin.cn/user/2218166695237532"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            【节点】[DiffusionProfile节点]原理解析与实际应用
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2218166695237532/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SmalBox
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T14:10:45.000Z" title="Sun Feb 08 2026 14:10:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读12分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">【Unity Shader Graph 使用与特效实现】</a><strong>专栏-直达</strong></p>
</blockquote>
<p>扩散配置文件节点是高清渲染管线（HDRP）中一个专门用于处理次表面散射效果的重要工具。在Shader Graph中使用此节点，开发者能够轻松地集成和采样扩散配置文件资源，为材质实现逼真的皮肤、蜡、大理石等半透明物体的渲染效果。次表面散射是光线穿透半透明材质表面并在内部散射后从不同位置射出的物理现象，这种效果对于创造真实感渲染至关重要。</p>
<p>在现代实时渲染中，次表面散射效果的实现需要平衡视觉质量和性能消耗。Unity的HDRP通过扩散配置文件提供了一种标准化的方法来处理这种复杂的光学现象。扩散配置文件节点作为Shader Graph与这些配置文件之间的桥梁，使得即使没有深厚图形编程背景的艺术家也能创建出高质量的次表面散射材质。</p>
<h2 data-id="heading-0">节点基础概念与工作原理</h2>
<p>扩散配置文件节点的核心功能是输出一个唯一的浮点标识符，该标识符在着色器执行过程中用于查找对应的扩散配置文件资源。这种设计允许HDRP在渲染时高效地访问复杂的散射参数，而不需要在着色器中直接嵌入大量数据。</p>
<p>当在Shader Graph中创建扩散配置文件节点时，需要为其指定一个扩散配置文件资源。这个资源包含了描述材质如何散射光线的物理参数。节点输出的浮点值实际上是资源在内部数据库中的索引，HDRP使用这个索引在预计算的查找表中找到相应的散射数据。</p>
<p>节点的工作流程可以分为以下几个步骤：</p>
<ul>
<li>在编辑阶段，艺术家或开发者将扩散配置文件资源分配给节点</li>
<li>节点生成对应的唯一标识符（浮点值）</li>
<li>在运行时，着色器使用这个标识符查询散射参数</li>
<li>HDRP根据查询结果应用相应的次表面散射模型</li>
</ul>
<p>这种间接引用机制的优势在于：</p>
<ul>
<li>允许多个材质共享同一扩散配置文件，减少内存占用</li>
<li>简化着色器代码复杂度，提高可读性和维护性</li>
<li>提供统一的参数管理界面，便于调整和优化</li>
</ul>
<h2 data-id="heading-1">创建与配置扩散配置文件节点</h2>
<p>在Shader Graph中添加扩散配置文件节点是一个直观的过程。首先需要在Shader Graph编辑器的创建节点菜单中定位到该节点。可以通过以下步骤完成：</p>
<ul>
<li>在Shader Graph编辑器的空白区域右键点击，打开节点创建菜单</li>
<li>在搜索框中输入"Diffusion Profile"或浏览至HDRP类别下找到该节点</li>
<li>点击节点名称将其添加到图中</li>
</ul>
<p>添加节点后，最重要的步骤是将其与实际的扩散配置文件资源关联起来。在节点的检视面板中，可以看到一个资源引用字段，需要在此处指定一个已创建的扩散配置文件。如果项目中没有合适的扩散配置文件，需要先创建该资源。</p>
<p>创建扩散配置文件资源的过程：</p>
<ul>
<li>在Project视图中右键点击，选择Create &gt; Rendering &gt; HDRP Diffusion Profile</li>
<li>为新资源命名并调整其参数以满足项目需求</li>
<li>返回Shader Graph，将新创建的扩散配置文件资源拖拽到节点的对应字段中</li>
</ul>
<p>配置扩散配置文件资源时，需要理解几个关键参数的意义：</p>
<ul>
<li>散射半径（Scattering Radius）：定义光线在材质内部散射的距离，影响散射效果的柔和度和范围</li>
<li>纹理分辨率（Texture Resolution）：用于散射预积分纹理的尺寸，更高的分辨率提供更精确的结果但增加内存使用</li>
<li>散射颜色（Scattering Color）：影响散射光线的色调，通常设置为材质的主色调或血液颜色（对于皮肤）</li>
<li>权重参数（Weight Parameters）：控制不同类型散射的贡献程度，允许微调散射效果的外观</li>
</ul>
<p>正确配置这些参数对于获得理想的视觉效果至关重要。例如，在创建人类皮肤材质时，通常需要相对较小的散射半径和偏红的散射颜色，以模拟皮肤下血管的效果。</p>
<h2 data-id="heading-2">节点端口详解与数据流</h2>
<p>扩散配置文件节点仅有一个输出端口，标记为"Out"。这个端口的输出类型是浮点数，但其含义远超过普通的数值。理解这个输出值的本质对于正确使用节点至关重要。</p>
<p>输出端口的浮点值实际上是一个经过特殊编码的标识符，它不代表普通的数学值，而是指向内部扩散配置文件数据库的索引。当这个值传递给HDRP的着色器系统时，系统会使用它来查找对应的散射参数集。</p>
<p>由于这个特殊性质，对输出值的数学操作需要格外小心：</p>
<ul>
<li>将输出值乘以0会有效地禁用扩散配置文件，因为结果不再对应任何有效的配置文件索引</li>
<li>将输出值乘以1会保持原样，继续使用关联的扩散配置文件</li>
<li>其他数学操作可能导致未定义行为，因为结果值可能不对应任何已注册的配置文件</li>
</ul>
<p>在Shader Graph中连接扩散配置文件节点时，通常应将其输出直接连接到主节点的Diffusion Profile输入槽。这种直接连接确保标识符不被意外修改，保证HDRP能够正确识别和使用扩散配置文件。</p>
<p>在某些高级用例中，开发者可能需要在不同条件下选择使用不同的扩散配置文件。这种情况下，可以使用条件逻辑来控制使用哪个配置文件的标识符。例如，可以使用分支节点根据距离或其他因素在两个不同的扩散配置文件节点输出之间进行选择。但需要注意，HDRP不支持在同一像素上混合多个扩散配置文件，因此这种切换应该是离散的而非连续的。</p>
<h2 data-id="heading-3">在真实项目中的实际应用</h2>
<p>扩散配置文件节点最常见的应用是创建逼真的皮肤材质。人类皮肤具有复杂的多层结构，每层对光线的散射方式各不相同。使用扩散配置文件可以近似这种效果，而不需要模拟完整的体积散射。</p>
<p>创建真实皮肤材质的步骤：</p>
<ul>
<li>首先创建或获取一个基础皮肤纹理，包含漫反射颜色、法线信息和其他表面细节</li>
<li>在HDRP中创建扩散配置文件资源，设置适合皮肤的参数：
<ul>
<li>设置散射半径约为2-5毫米（取决于角色比例和艺术方向）</li>
<li>调整散射颜色为略带红色或橙色的色调，模拟皮下血液的影响</li>
<li>根据目标平台平衡纹理分辨率和质量需求</li>
</ul>
</li>
<li>在Shader Graph中集成扩散配置文件节点，将其输出连接到主节点</li>
<li>可能需要额外调整材质的光泽度和反射属性，以配合散射效果</li>
</ul>
<p>除了皮肤，扩散配置文件还可用于多种其他材质：</p>
<ul>
<li>蜡质材料：如蜡烛、奶酪等，通常需要中等散射半径和温和的散射颜色</li>
<li>植物材料：树叶、花瓣等，光透射效果可以通过散射模拟</li>
<li>大理石和玉石：这些矿物材料具有独特的半透明特性</li>
<li>塑料和橡胶：某些类型的塑料具有轻微的次表面散射效果</li>
</ul>
<p>在实际项目中，性能考虑是必不可少的。次表面散射是一种计算密集型效果，特别是在高分辨率下。对于移动平台或低端硬件，可能需要减少散射采样次数或使用简化的散射模型。HDRP提供了多种质量设置，允许根据目标平台调整散射计算的精度。</p>
<h2 data-id="heading-4">高级技巧与最佳实践</h2>
<p>掌握扩散配置文件节点的基本用法后，可以探索一些高级技巧来提升材质质量或优化性能。</p>
<p>多层材质技术：</p>
<p>对于特别复杂的材质如真实人类皮肤，单一扩散配置文件可能不足以捕捉所有细节。在这种情况下，可以使用多个材质层，每层使用不同的扩散配置文件。通过精心设计的混合策略，可以创建更加丰富和真实的散射效果。需要注意的是，这种技术会增加渲染成本，应谨慎使用。</p>
<p>性能优化策略：</p>
<ul>
<li>使用适当的纹理分辨率：对于远处可见的物体，可以使用较低分辨率的散射纹理</li>
<li>限制使用散射的物体数量：只为对视觉影响最大的物体启用高质量的次表面散射</li>
<li>利用HDRP的质量设置：根据目标平台调整全局散射质量</li>
<li>考虑使用简化的散射模型：对于某些材质，近似散射效果可能就足够了</li>
</ul>
<p>与其它HDRP功能集成：</p>
<p>扩散配置文件节点可以与其他HDRP特性结合使用，创建更加复杂和真实的效果。例如：</p>
<ul>
<li>与光线追踪结合：HDRP的光线追踪次表面散射可以提供更准确的物理效果，但性能成本更高</li>
<li>与后期处理效果配合：适当的颜色分级和色调映射可以增强散射效果的视觉冲击力</li>
<li>与光照系统协同：正确设置场景光照对于展现散射效果至关重要，特别是背光和边缘光情况</li>
</ul>
<p>调试和问题解决：</p>
<p>当散射效果不如预期时，可以使用以下方法进行调试：</p>
<ul>
<li>检查扩散配置文件资源是否正确分配给了节点</li>
<li>验证节点输出是否正确地连接到了主节点</li>
<li>使用HDRP的调试视图可视化散射效果，如散射 albedo 或散射半径</li>
<li>确保材质使用了正确的着色器类型，某些着色器可能不支持次表面散射</li>
</ul>
<h2 data-id="heading-5">常见问题与解决方案</h2>
<p>在使用扩散配置文件节点时，开发者可能会遇到一些典型问题。了解这些问题及其解决方案可以帮助节省调试时间。</p>
<p>节点输出值为0或无效：</p>
<p>这通常表示节点没有正确配置扩散配置文件资源。检查节点检视面板中的资源引用字段，确保已分配有效的扩散配置文件。如果资源已被删除或移动，需要重新分配。</p>
<p>散射效果不明显或过强：</p>
<p>这通常是由于扩散配置文件参数设置不当造成的。调整散射半径和散射颜色可以显著改变效果的外观。记住，散射半径的单位是米，因此对于小物体（如游戏角色），值通常在0.001到0.01范围内。</p>
<p>性能问题：</p>
<p>如果启用次表面散射后帧率显著下降，考虑以下优化措施：</p>
<ul>
<li>减少散射采样次数（在HDRP资产设置中调整）</li>
<li>降低扩散配置文件的纹理分辨率</li>
<li>只为近距离可见的物体使用高质量散射</li>
<li>使用HDRP的LOD系统，根据距离切换不同质量的散射效果</li>
</ul>
<p>平台兼容性问题：</p>
<p>虽然扩散配置文件节点专为HDRP设计，但在不同平台上可能有不同的表现。特别是在移动设备上，某些高级散射功能可能不可用。使用HDRP的平台特定设置可以确保在所有目标设备上获得一致的行为。</p>
<p>与自定义着色器代码的集成：</p>
<p>对于需要超出Shader Graph功能的高级用例，可能需要将扩散配置文件与自定义HLSL着色器代码结合使用。在这种情况下，需要了解HDRP如何内部处理扩散配置文件标识符，并确保自定义代码与HDRP的散射系统正确交互。</p>
<h2 data-id="heading-6">扩散配置文件节点的未来发展趋势</h2>
<p>随着实时渲染技术的不断进步，扩散配置文件节点和相关的次表面散射功能也在持续演化。了解这些趋势可以帮助开发者更好地规划长期项目。</p>
<p>实时全局光照与散射的集成：</p>
<p>未来的HDRP版本可能会更紧密地集成次表面散射与全局光照系统，允许散射光线影响周围环境，实现更加真实的材质交互。</p>
<p>机器学习加速的散射模型：</p>
<p>机器学习技术正在被越来越多地用于实时渲染的各个领域。未来可能会看到基于神经网络的散射模型，能够在保持高质量的同时大幅降低计算成本。</p>
<p>更高效的混合渲染技术：</p>
<p>随着混合渲染器（如HDRP的Hybrid Renderer）的成熟，次表面散射可能会受益于新的渲染架构，在保持视觉质量的同时提高性能。</p>
<p>艺术家友好的工具改进：</p>
<p>Unity一直在努力使复杂渲染技术更易于艺术家使用。未来可能会看到扩散配置文件节点的改进界面，更直观的参数控制和实时预览功能。</p>
<p>跨管线兼容性：</p>
<p>虽然目前扩散配置文件节点仅适用于HDRP，但未来可能会看到类似功能在URP中的实现，使更多项目能够利用高质量的次表面散射效果。</p>
<hr/>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">【Unity Shader Graph 使用与特效实现】</a><strong>专栏-直达</strong>
（欢迎<em>点赞留言</em>探讨，更多人加入进来能更加完善这个探索的过程，🙏）</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[刷屏全网的“nano-banana”API接入指南！0.1元/张量产高清创意图，开发者必藏]]></title>    <link>https://juejin.cn/post/7603699739224031247</link>    <guid>https://juejin.cn/post/7603699739224031247</guid>    <pubDate>2026-02-08T14:24:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603699739224031247" data-draft-id="7603677143215063055" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="刷屏全网的“nano-banana”API接入指南！0.1元/张量产高清创意图，开发者必藏"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-02-08T14:24:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="崔庆才丨静觅"/> <meta itemprop="url" content="https://juejin.cn/user/1521379821230269"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            刷屏全网的“nano-banana”API接入指南！0.1元/张量产高清创意图，开发者必藏
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1521379821230269/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    崔庆才丨静觅
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T14:24:37.000Z" title="Sun Feb 08 2026 14:24:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">一、nano-banana爆火背景与核心优势</h2>
<p>最近AI圈彻底被“纳米香蕉”承包！X平台16万浏览量的3D手办生成图、网友复刻的《黑神话·钟馗》周边、老照片修复、跨时空合照等玩法刷屏全网。其本质是谷歌Gemini 2.5 Flash Image模型的“隐藏款”，通过API调用可将“创意超能力”植入自有产品或工作流。</p>
<h3 data-id="heading-1">官方API痛点</h3>
<p>官方API存在两大核心问题：① 成本高，0.039美元/张（约0.28元）；② 受网络限制，大规模调用成本压力大。</p>
<h3 data-id="heading-2">ACE Data Platform生态加持优势</h3>
<p>推荐ACE Data Platform的nano-banana API接入方案（专属对接链接：<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.acedata.cloud%2Fdocuments%2F23985a11-d713-41d1-ad84-24b021805b3d%3Finviter_id%3Db87f67c1-b04f-4332-99a1-7a5e651331c6" target="_blank" title="https://platform.acedata.cloud/documents/23985a11-d713-41d1-ad84-24b021805b3d?inviter_id=b87f67c1-b04f-4332-99a1-7a5e651331c6" ref="nofollow noopener noreferrer">ACE Data Platform nano-banana API专属对接页面</a>），核心优势：兼顾低成本（0.1元/张量产）、高稳定、强扩展性，适配个人创作与商业部署全场景。</p>
<h2 data-id="heading-3">二、4大核心能力（碾压同类的硬实力）</h2>
<p>nano-banana API凭以下4大功能成为开发者“生产力利器”：</p>
<ol>
<li><strong>角色一致性拉满</strong>：多次编辑可精准保留人物脸部特征、发型与服装风格，更换场景、调整姿势后主体辨识度仍在线；适配虚拟试衣APP、连贯故事分镜生成等场景，无需反复调整参数。</li>
<li><strong>多图融合自然到离谱</strong>：支持一次性上传13张素材图，智能整合光线、阴影、透视关系，实现“原生融合”而非简单拼接；电商商家可合成产品场景图，设计师可快速组合创意元素，效率提升10倍以上。</li>
<li><strong>多轮编辑像“聊天”一样简单</strong>：支持基于上一轮结果持续微调，如为空房间逐步添加家具、粉刷墙壁，或给生成图换风格、改细节；无需每次重新描述全部需求，对话式操作堪比真人设计师协作。</li>
<li><strong>生成速度快到飞起</strong>：“Flash”命名名副其实，复杂指令下13秒可生成5张风格各异的高清图，单张生成耗时不足3秒，完全满足商业场景高并发需求。</li>
</ol>
<h2 data-id="heading-4">三、4大落地场景（覆盖从创意到商业的全需求）</h2>
<p>nano-banana API适配性极强，个人创作者与企业开发均能找到核心价值：</p>
<ol>
<li><strong>内容创作领域</strong>：自媒体人生成短视频封面、故事板；设计师借助风格迁移功能快速尝试不同创意方向，将1天工作量压缩至1小时。</li>
<li><strong>电商营销场景</strong>：生成多角度产品展示图、将商品自然植入生活场景；无需搭建实景拍摄，即可产出高质量营销素材，大幅降低推广成本。</li>
<li><strong>娱乐应用开发</strong>：开发虚拟试衣、宠物变装、老照片修复等趣味功能；依托强互动性提升产品用户留存率。</li>
<li><strong>企业级创意生产</strong>：品牌方批量生成品牌一致的广告素材，游戏公司制作角色周边可视化图；借助API实现“创意量产”，缩短项目周期。</li>
</ol>
<h2 data-id="heading-5">四、2套接入方案（避坑指南：成本直降+稳定翻倍）</h2>
<p>针对不同需求提供适配方案，规避官方API网络波动、高成本、失败计费等问题：</p>
<h3 data-id="heading-6">1. 个人学习/小规模测试</h3>
<ul>
<li>方案：直接使用网页版（链接：<a href="https://link.juejin.cn?target=https%3A%2F%2Fhub.acedata.cloud%2Fnanobanana%3Finviter_id%3Db87f67c1-b04f-4332-99a1-7a5e651331c6" target="_blank" title="https://hub.acedata.cloud/nanobanana?inviter_id=b87f67c1-b04f-4332-99a1-7a5e651331c6" ref="nofollow noopener noreferrer">nano-banana网页版（无需配置，即开即用）</a>）</li>
<li>优势：无需任何网络配置，联网即可使用，操作便捷。</li>
</ul>
<h3 data-id="heading-7">2. 商业部署/大规模调用（推荐方案）</h3>
<ul>
<li>方案：通过ACE Data Platform接入nano-banana API（专属通道：<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.acedata.cloud%2Fdocuments%2F23985a11-d713-41d1-ad84-24b021805b3d%3Finviter_id%3Db87f67c1-b04f-4332-99a1-7a5e651331c6" target="_blank" title="https://platform.acedata.cloud/documents/23985a11-d713-41d1-ad84-24b021805b3d?inviter_id=b87f67c1-b04f-4332-99a1-7a5e651331c6" ref="nofollow noopener noreferrer">ACE Data Platform nano-banana API专属对接页面</a>）</li>
<li>3大核心优势：
① 成本更友好：生态协同降低中转成本，大规模调用享阶梯价，失败调用不计费，比直接对接官方节省30%以上成本；
② 网络更稳定：国内直连节点，无需额外配置代理，API可用性高达99.9%，避免网络波动导致创作或开发中断；
③ 生态更完整：可直接联动ACE Data Platform的其他API和编排系统，实现进一步自动化。</li>
</ul>
<h2 data-id="heading-8">五、3步快速接入流程（即刻解锁创意超能力）</h2>
<ol>
<li>注册ACE Data Platform账号，进入nano-banana API专属对接页面（链接：<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.acedata.cloud%2Fdocuments%2F23985a11-d713-41d1-ad84-24b021805b3d%3Finviter_id%3Db87f67c1-b04f-4332-99a1-7a5e651331c6" target="_blank" title="https://platform.acedata.cloud/documents/23985a11-d713-41d1-ad84-24b021805b3d?inviter_id=b87f67c1-b04f-4332-99a1-7a5e651331c6" ref="nofollow noopener noreferrer">ACE Data Platform nano-banana API专属对接页面</a>），获取专属API Key；</li>
<li>参考平台提供的开发文档（含Python、JavaScript等多语言示例代码），根据需求配置参数（支持图像生成、编辑、风格迁移等多种指令）；</li>
<li>发起调用并对接自有系统，生成的图像可直接存储至ACE Data Platform平台云空间。</li>
</ol>
<h2 data-id="heading-9">六、总结号召</h2>
<p>从网友整活的趣味工具，到开发者追捧的生产力API，nano-banana的爆发绝非偶然。借助ACE Data Platform的生态加持，不仅能低成本接入，更能通过数据联动实现价值升级。无论你是想做创意工具、电商产品，还是企业级营销系统，nano-banana API都是不可错过的核心能力，赶紧领取免费额度，开启创意爆发之旅！</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[jwt介绍]]></title>    <link>https://juejin.cn/post/7603895839556583487</link>    <guid>https://juejin.cn/post/7603895839556583487</guid>    <pubDate>2026-02-08T14:26:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603895839556583487" data-draft-id="7603769956975968297" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="jwt介绍"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-02-08T14:26:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="剪刀石头布啊"/> <meta itemprop="url" content="https://juejin.cn/user/1855631360014798"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            jwt介绍
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1855631360014798/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    剪刀石头布啊
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T14:26:22.000Z" title="Sun Feb 08 2026 14:26:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">前言</h2>
<p>很多人不了解 JWT（JSON Web Token）啥意思，甚至jwt、cookie、token(令牌)、session、单点登录是啥搞不清，这篇文章以 JWT 介绍为引，顺便简单区分一下他们之间的关系，总而言之，这篇文章不白看</p>
<h2 data-id="heading-1">介绍</h2>
<p>上面讲的实际上都是单点登录过程中的参与角色之一，这也是统一身份认证环境系统中的一部分</p>
<p><strong>我们从一个角度开始分析他们之间的关系</strong>：</p>
<ol>
<li>我们都知道 http 是无状态协议，那么无状态的情况，服务器作为一个用户管理中心，他怎么知道我们我们用户是谁操作的呢(怎么区分用户呢)</li>
<li>很明显根据用户账号，而我们发现用户并不是每次都登陆，很麻烦，于是我们进一步追溯到了用户注册用户时，会在数据库中生成我们互联网用户的唯一标识，这个标识就是我们的用户id(互联网的身份证号)，早期就是直接使用用户id来区分我们的身份</li>
<li>当使用账号密码登录后，客户端就会获取到用户的id，存放在内存中，后续对于需要确认用户的的操作传递用户id即可</li>
<li>那么问题来了，直接使用用户id不太好，不安全，再加上一些其他常用数据原因，于是出现了session，也就是服务端保存用户常用信息，使用一个session 关联用户，session id发送给用户，用户拿着session 给服务端，服务端确认身份，拿着信息直接操作，可是这样管理 session，用户一多服务端压力还会变大，也衍生出了redis 的操作，现在仍然受用</li>
<li>当然也出现了更加主流的身份令牌，发放一个期限的 token令牌 来代替我们的用户id，也就是身份令牌，这样就算token 泄露了，也不会长期被持有，风险大幅度降低，有条件再加上防篡改操作，这样 jwt 结构就出现了，后续就让用户拿着这些信息访问即可</li>
<li>那还有一个问题，并且我们客户端一旦不小心中途退出，重新进入又要重新输入账号密码，麻烦，需要用户本地保存一下令牌，这也是从session 方案就开始的存储方式了，那么令牌怎么存放呢，浏览器有cookie，localStore 的方式，于是出现了cookie + session 的方式，同时还有移动端的纯token方式，双token等</li>
<li>上面签名令牌后续免认证过程就是单点登录的核心逻辑，是统一身份认证子集，统一身份认证还包含整个签名过程、权限等更复杂功能</li>
</ol>
<p><strong>ps</strong>:当然身份系统打通的话，一个token便可以分别使用到多个平台</p>
<p><strong>那么单点登录解决了什么问题？</strong></p>
<p>答：单点登录，在这个系统中，同一个用户只需要登录一次，后续就可以拿着登录后签发的令牌免认证操作，减少了很多麻烦</p>
<p><strong>cookie 是啥？</strong></p>
<p>答：cookie是浏览器保存服务器令牌的一种方式，可以在浏览器中持久存放，即使用户不小心关闭标签，下次仍然可以在请求中取出它亮出我们的身份，当然如果过期了，就不行了需要重新登录签名</p>
<p><strong>session是啥？</strong></p>
<p>session是服务端的一个缓存，一种key-value结构，key则是生成的sessionid，用于给用户，value是用户信息或者令牌，可以根据用户传递过来的sessionid来直接获取到用户的信息</p>
<h2 data-id="heading-2">jwt</h2>
<p>JWT（JSON Web Token） 实际上就是一种token令牌的生成方式，其主要组成方式如下所示：</p>
<ul>
<li>头部结构，主要保存了加密算法</li>
<li>荷载payload，保存了我们的内容</li>
<li>Signature，加密结果，用于后端对比，避免有人篡改荷载信息</li>
</ul>
<p>看了上面的结构，相信也能知道什么是jwt了，且jwt的内容是接近明文的，只是有了加密串防篡改，相对也安全了不少，且里面也有时间戳，能设置过期时间，算是很方便了</p>
<p>后端可以直接获取jwt，直接验证内容是否串改，里面的token可以直接使用了，一般token和用户信息会有一个对照表，直接使用token对照用户信息操作即可</p>
<h2 data-id="heading-3">最后</h2>
<p>他们之间的关系大致如此，更细的没有多介绍，到了这里更细的只要稍微查一下，就能查到，本篇文章就介绍到这里了</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[富文本编辑器在 AI 时代为什么这么受欢迎]]></title>    <link>https://juejin.cn/post/7604037348607508518</link>    <guid>https://juejin.cn/post/7604037348607508518</guid>    <pubDate>2026-02-08T14:21:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7604037348607508518" data-draft-id="7604484566803791882" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="富文本编辑器在 AI 时代为什么这么受欢迎 "/> <meta itemprop="keywords" content="前端,后端,JavaScript"/> <meta itemprop="datePublished" content="2026-02-08T14:21:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Moment"/> <meta itemprop="url" content="https://juejin.cn/user/3782764966460398"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            富文本编辑器在 AI 时代为什么这么受欢迎 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3782764966460398/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Moment
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T14:21:27.000Z" title="Sun Feb 08 2026 14:21:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读7分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"「";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"」";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"✓";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><blockquote>
<p>大家好👋，我是Moment，目前我正在使用 NextJs，NestJs，langchain 开发 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxun082%2FDocFlow" target="_blank" title="https://github.com/xun082/DocFlow" ref="nofollow noopener noreferrer">DocFlow</a>，它是一个完整的 AI 全栈协同文档平台。该项目融合了多个技术栈，包括基于 <code>Tiptap</code> 的富文本编辑器、<code>NestJs</code> 后端服务、<code>AI</code> 集成功能和实时协作。在开发过程中，我积累了丰富的实战经验，涵盖了 <code>Tiptap</code> 的深度定制、性能优化和协作功能的实现等核心难点，如果你对这个项目感兴趣，可以添加我微信 <code>yunmz777</code> 了解更多详细的信息，如果觉得不错欢迎 star ⭐️⭐️⭐️。</p>
</blockquote>
<p>在 2026 年的今天，富文本编辑器已经不再是单纯的打字框，它演变成了人类与 AI 协作的核心战场。</p>
<p>如果说过去十年是 Markdown 和纯文本的极客复兴，那么 AI 时代的到来，则让富文本编辑器重新夺回了统治地位。</p>
<h2 data-id="heading-0">AI 就在光标处</h2>
<p>在 AI 普及之前，我们写作是写一段，去 ChatGPT 问一段，再复制回来。这种上下文切换是效率的杀手。</p>
<p>现在的富文本编辑器，如 Notion AI、Lex、WPS AI 等，将 AI 直接植入光标。你只需输入斜杠或空格，AI 就能根据前文自动续写、润色或改变语气。富文本编辑器能够理解文档的层级结构，包括标题、段落、列表，这让 AI 能更精准地执行总结这一段或把这部分转成表格的操作。</p>
<h2 data-id="heading-1">结构化数据的转换站</h2>
<p>AI 最擅长的事情之一，就是将非结构化信息转化为结构化内容。富文本编辑器的块状结构完美适配了这一点。</p>
<p>你丢给 AI 一堆乱七八糟的会议纪要，富文本编辑器能瞬间将其渲染成带有看板、待办列表和甘特图的精美文档。AI 生成的不再只是文字，还有图表、代码块，甚至动态组件。富文本编辑器是承载这些复杂对象的最佳容器。</p>
<h2 data-id="heading-2">终结空白页恐惧症</h2>
<p>对于创作者来说，最痛苦的是面对一张白纸。AI 时代的富文本编辑器变成了半自动驾驶。</p>
<p>AI 不再是取代作者，而是成了最好的二号位。它帮你打草稿，你负责做决策和注入灵魂。输入一个主题，AI 自动生成大纲和初稿，用户的工作从无中生有变成了审阅与精修。当你逻辑断层时，AI 可以在侧边栏提醒你，甚至帮你查找事实数据，省去了反复跳出窗口搜资料的麻烦。</p>
<h2 data-id="heading-3">传统与 AI 原生的分野</h2>
<p>传统富文本编辑器的定位是静态记录工具，核心交互靠键盘输入和顶部工具栏，内容处理停留在简单的字体加粗、颜色修改，逻辑理解仅能识别字符和 HTML 标签，扩展性依赖插件系统。</p>
<p>AI 原生富文本编辑器的定位是动态协作伙伴和内容引擎，核心交互靠自然语言指令和斜杠命令，内容处理涵盖自动排版、风格迁移、跨语言同步翻译，逻辑理解能把握段落意图、自动提取任务项，扩展性支持 AI Agent 接入，可调用外部 API 填充数据。</p>
<h2 data-id="heading-4">协作维度的升华</h2>
<p>以前的协作是人与人在文档里留言。现在的协作是人、AI、人三者联动。</p>
<p>当你打开一份长文档，AI 会为你总结其他人修改了什么。团队中的成员写出的内容风格不一时，AI 可以一键将全篇统一为公司标准公文包风格或互联网黑话风格。</p>
<h2 data-id="heading-5">降低专业感的门槛</h2>
<p>富文本编辑器通过 AI 让普通人也能做出有大片感的内容。</p>
<p>以前需要懂点设计才能排得好看，现在只需说帮我把这个方案做得像麦肯锡的报告，编辑器会自动调整字体间距、引用格式和配色方案。语音转文字、文字转视觉，AI 在富文本背后的各种转换逻辑，让创作变得从未如此简单。</p>
<h2 data-id="heading-6">为什么不是 Word？</h2>
<p>Word 几乎是富文本的代名词，但当我们说 AI 时代富文本编辑器火了时，大家脑子里浮现的通常是 Notion、Lex、Linear 这种现代化的编辑器，而不是那个陪了我们几十年的 Microsoft Word。</p>
<p>原因很简单：Word 是为了打印设计的，而 AI 时代的编辑器是为了信息流动设计的。</p>
<h3 data-id="heading-7">纸张思维与块思维</h3>
<p>Word 的逻辑本质上是在模拟一张 A4 纸。所有的排版，页边距、分页符、行间距，都是为了最终打印出来好看。</p>
<p>AI 时代的逻辑则是原子化的。现代编辑器如 Notion，每一段话、一张图、一个表格都是一个独立的块。AI 很难理解 Word 那种长达 50 页、格式复杂的 XML 结构。但在块状编辑器里，AI 可以精准地知道：我现在的任务是只针对这一个待办事项块进行扩充，或者把这个文本块转化成代码块。这种精细度的控制，Word 很难做到。</p>
<h3 data-id="heading-8">功能堆砌与对话驱动</h3>
<p>Word 拥有成千上万个功能，埋藏在密密麻麻的菜单栏里。在 Word 里用 AI，你得去点插件、点侧边栏。</p>
<p>现代编辑器奉行极简主义。界面通常只有一张白纸，所有的功能都通过一个斜杠指令或 AI 对话框呼出。在 Word 里，你是找功能；在 AI 编辑器里，你是下指令。当 AI 已经能帮你调格式、改语气时，Word 顶端那几百个图标反而成了视觉噪音。</p>
<h3 data-id="heading-9">数据结构的开放性</h3>
<p>Word 是孤岛。docx 文件是一个封装好的压缩包。虽然现在有云端版，但它的数据很难实时与其他工具，如任务管理、数据库、代码库，无缝打通。</p>
<p>现代富文本编辑器往往是 All-in-one。AI 在编辑器里写完一个方案，可以直接将其中的任务转化为看板上的卡片。Word 的数据相对静态，而现代编辑器的内容是活着的，AI 可以轻松地跨页面、跨库调用数据。</p>
<h3 data-id="heading-10">协作的实时性与轻量化</h3>
<p>Word 诞生于离线时代。即便现在的 OneDrive 协作已经进步很大，但其底层的冲突合并机制依然不如原生 Web 编辑器流畅。AI 时代的创作往往是高频次、碎片化、多人多机协作的，现代富文本编辑器原生支持网页访问，AI 可以在你和同事讨论时实时介入，这种流畅度是老牌软件难以企及的。</p>
<p>从设计目标看，Microsoft Word 面向排版与打印，内容单位是页面；AI 原生编辑器如 Notion、Lex 面向思考与协作，内容单位是块或组件。Word 的 AI 角色是辅助插件，Copilot 是外挂；AI 编辑器的 AI 是核心驱动力，是原生系统的一部分。典型动作上，Word 用户设置页边距、调整字体大小；AI 编辑器用户用斜杠总结、空格键续写。视觉感受上，Word 像是一本沉重的精装书，AI 编辑器像是一张无限延伸的草稿纸。</p>
<h3 data-id="heading-11">心理层面的创作压力</h3>
<p>这听起来很玄学，但真实存在。</p>
<p>打开 Word，你会觉得自己在写公文，潜意识里会去纠正格式；打开 Notion 或 Lex，你会觉得自己在记录想法。AI 最强大的地方在于辅助灵感爆发，而现代富文本编辑器那种无负担的界面，比 Word 更适合作为 AI 的载体。</p>
<h2 data-id="heading-12">结语</h2>
<p>当然，Word 也在努力。微软推出的 Microsoft Loop 就在全盘致敬这种块状编辑器逻辑，试图把 Word 的强大功能塞进 AI 时代的瓶子里。</p>
<p>富文本编辑器在 AI 时代受欢迎，是因为它已经从一个容器进化成了一个理解器。它不再只等着你喂数据，而是开始主动帮你处理、组织和美化信息。</p>
<p>当人类与 AI 的边界越来越模糊，那个让我们与智能体并肩写作的编辑器，或许才是这个时代真正的创作伙伴。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[比官方便宜一半以上！Midjourney API 申请及使用]]></title>    <link>https://juejin.cn/post/7603721514204315657</link>    <guid>https://juejin.cn/post/7603721514204315657</guid>    <pubDate>2026-02-08T14:42:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603721514204315657" data-draft-id="7603688142005567497" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="比官方便宜一半以上！Midjourney API 申请及使用"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-02-08T14:42:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="崔庆才丨静觅"/> <meta itemprop="url" content="https://juejin.cn/user/1521379821230269"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            比官方便宜一半以上！Midjourney API 申请及使用
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1521379821230269/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    崔庆才丨静觅
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T14:42:21.000Z" title="Sun Feb 08 2026 14:42:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读13分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Midjourney 是一款非常强大的 AI 绘图工具，只要输入关键字，就能在短短一两分钟生成十分精美的图像。Midjourney 以其出色的绘图能力在业界独树一帜，如今，Midjourney 早已在各个行业和领域广泛应用，其影响力愈发显著。</p>
<p>本文档主要介绍 Midjourney API 中 Imagine 操作的使用流程，利用它我们可以轻松通过文本生成所需要的图像。</p>
<h2 data-id="heading-0">申请流程</h2>
<p>要使用 Midjourney Imagine API，首先可以到 <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.acedata.cloud%2Fdocuments%2Fmidjourney-imagine" target="_blank" title="https://platform.acedata.cloud/documents/midjourney-imagine" ref="nofollow noopener noreferrer">Midjourney Imagine API</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.acedata.cloud%2Fdocuments%2Fmidjourney-imagine" target="_blank" title="https://platform.acedata.cloud/documents/midjourney-imagine" ref="nofollow noopener noreferrer">platform.acedata.cloud/documents/m…</a> 页面点击「Acquire」按钮，获取请求所需要的凭证：</p>
<p><img src="https://cdn.acedata.cloud/nyq0xz.png" alt="" loading="lazy"/></p>
<p>如果你尚未登录或注册，会自动跳转到登录页面邀请您来注册和登录，登录注册之后会自动返回当前页面。</p>
<h2 data-id="heading-1">基本使用</h2>
<p>接下来就可以在界面上填写对应的内容，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/d01h9f.png" alt="" loading="lazy"/></p>
<p>在第一次使用该接口时，我们至少需要填写两个内容，一个是 <code>authorization</code>，直接在下拉列表里面选择即可。另一个参数是 <code>prompt</code>， <code>prompt</code> 就是我们想生成的图片描述内容，建议用英文描述，画的图会更准确效果更好，这里我们用了示例内容 <code>Lamborghini speeds inside a volcano</code>，代表要画一个兰博基尼在火山飞驰。</p>
<p>同时您可以注意到右侧有对应的调用代码生成，您可以复制代码直接运行，也可以直接点击「Try」按钮进行测试。</p>
<p><img src="https://cdn.acedata.cloud/zv3db5.png" width="500" class="m-auto" loading="lazy"/></p>
<p>调用之后，我们发现返回结果如下：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"image_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://midjourney.cdn.acedata.cloud/attachments/1233387694839697411/1234197197067915365/36rgqit64j90qptsxnyq_Lamborghini_speeds_inside_a_volcano_id0494_f47263b6-ff92-44a3-88ee-51cf0e706aae.png?ex=662fdb36&amp;is=662e89b6&amp;hm=ca9be54907726937ed02517a13466bef2afb2825b7cda4b313de56a3c3310d0d&amp;width=1024&amp;height=1024"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"image_width"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1024</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"image_height"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1024</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"image_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1234197197067915365"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"raw_image_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://midjourney.cdn.acedata.cloud/attachments/1233387694839697411/1234197197067915365/36rgqit64j90qptsxnyq_Lamborghini_speeds_inside_a_volcano_id0494_f47263b6-ff92-44a3-88ee-51cf0e706aae.png?ex=662fdb36&amp;is=662e89b6&amp;hm=ca9be54907726937ed02517a13466bef2afb2825b7cda4b313de56a3c3310d0d&amp;"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"raw_image_width"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2048</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"raw_image_height"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2048</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"progress"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">100</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"actions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"upscale1"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"upscale2"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"upscale3"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"upscale4"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"reroll"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"variation1"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"variation2"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"variation3"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"variation4"</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1bae3bec-3ac4-4180-a148-74ee6cb68b98"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>返回结果一共有多个字段，介绍如下：</p>
<ul>
<li><code>task_id</code>，生成此图像任务的 ID，用于唯一标识此次图像生成任务。</li>
<li><code>image_id</code>，图片的唯一标识，在下次需要对图片进行变换操作时需要传此参数。</li>
<li><code>image_url</code>，缩略图的 URL，直接打开即可查看生成的效果。</li>
<li><code>image_width</code>：缩略图的像素宽度。</li>
<li><code>image_height</code>：缩略图的像素高度。</li>
<li><code>raw_image_url</code>：原图的 URL，和缩略图内容一样，但相比缩略图更加高清，加载速度会更慢一些。</li>
<li><code>raw_image_width</code>：原图的像素宽度。</li>
<li><code>raw_image_height</code>：原图的像素高度。</li>
<li><code>actions</code>，可以对生成的图片进行的进一步操作列表。这里一共列了 8 个，其中 <code>upscale</code> 代表放大，<code>variation</code> 代表变换。所以 <code>upscale1</code> 代表的就是对左上角第一张图片进行放大操作，<code>variation3</code> 就是代表根据左下角第三张图片进行变换操作。</li>
</ul>
<p>打开 <code>image_url</code> 或者 <code>raw_image_url</code> 所对应的链接，可以发现如图所示。</p>
<p><img src="https://cdn.acedata.cloud/qr2iyj.png" alt="" loading="lazy"/></p>
<p>可以看到，这里生成了一张 2x2 的预览图。到现在为止，第一次 API 调用就完成了。</p>
<h2 data-id="heading-2">图像放大与变换</h2>
<p>下面我们尝试针对当前生成的照片进行进一步的操作，比如我们觉得右上角第二张的图片还不错，但我们想进行一些变换微调，那么就可以进一步将 <code>action</code> 填写为 <code>variation2</code>，同时将 <code>image_id</code> 传递即可：</p>
<p><img src="https://cdn.acedata.cloud/ia7vpw.png" alt="" loading="lazy"/></p>
<p>这时候得到的结果如下：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"image_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://midjourney.cdn.acedata.cloud/attachments/1233387694839697411/1234201336543969401/36rgqit64j90qptsxnyq_Lamborghini_speeds_inside_a_volcano_id0494_10dc56a7-ec16-4bac-878e-2338f2ae5f5d.png?ex=662fdf10&amp;is=662e8d90&amp;hm=9aec96bca35ae20b6f9ab536101b9c4ea255eb6216cbf7000ac554937da071f3&amp;width=1024&amp;height=1024"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"image_width"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1024</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"image_height"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1024</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"image_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1234201336543969401"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"raw_image_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://midjourney.cdn.acedata.cloud/attachments/1233387694839697411/1234201336543969401/36rgqit64j90qptsxnyq_Lamborghini_speeds_inside_a_volcano_id0494_10dc56a7-ec16-4bac-878e-2338f2ae5f5d.png?ex=662fdf10&amp;is=662e8d90&amp;hm=9aec96bca35ae20b6f9ab536101b9c4ea255eb6216cbf7000ac554937da071f3&amp;"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"raw_image_width"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2048</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"raw_image_height"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2048</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"progress"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">100</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"actions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"upscale1"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"upscale2"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"upscale3"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"upscale4"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"reroll"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"variation1"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"variation2"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"variation3"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"variation4"</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"f4961620-1104-409f-9dc1-ba3ed15c2f4d"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>打开 <code>image_url</code>，新生成的图片如下所示：</p>
<p><img src="https://cdn.acedata.cloud/4g6r09.png" alt="" loading="lazy"/></p>
<p>可以看到，针对上一张右上角的图片，我们再次得到了四张类似的照片。</p>
<p>这时候我们可以挑选其中一张进行精细化地放大操作，比如选第四张，那就可以 <code>action</code> 传入 <code>upscale4</code>，通过 <code>image_id</code> 再次传入当前图像的 ID 即可。</p>
<p><img src="https://cdn.acedata.cloud/jk9ohl.png" alt="" loading="lazy"/></p>
<blockquote>
<p>注意： <code>upscale</code> 操作相比 <code>variation</code> 来说，Midjourney 的耗时会更短一些。</p>
</blockquote>
<p>返回结果如下：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"image_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://midjourney.cdn.acedata.cloud/attachments/1233387694839697411/1234202545208033400/36rgqit64j90qptsxnyq_Lamborghini_speeds_inside_a_volcano_id0494_34edc3f5-2bd0-4f5b-a372-03270b02289b.png?ex=662fe031&amp;is=662e8eb1&amp;hm=f8006c4d33a03dfd027dffe4eb46ab0d113a4910aef07497f0b335c8998b7858&amp;width=512&amp;height=512"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"image_width"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">512</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"image_height"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">512</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"image_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1234202545208033400"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"raw_image_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://midjourney.cdn.acedata.cloud/attachments/1233387694839697411/1234202545208033400/36rgqit64j90qptsxnyq_Lamborghini_speeds_inside_a_volcano_id0494_34edc3f5-2bd0-4f5b-a372-03270b02289b.png?ex=662fe031&amp;is=662e8eb1&amp;hm=f8006c4d33a03dfd027dffe4eb46ab0d113a4910aef07497f0b335c8998b7858&amp;"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"raw_image_width"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1024</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"raw_image_height"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1024</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"progress"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">100</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"actions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"upscale_2x"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"upscale_4x"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"variation_subtle"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"variation_strong"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"zoom_out_2x"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"zoom_out_1_5x"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"pan_left"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"pan_right"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"pan_up"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"pan_down"</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"03f62b17-a6f1-4c8e-9b4d-1fc7bd5b1180"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>其中 <code>image_url</code> 如图所示：</p>
<p><img src="https://cdn.acedata.cloud/jfndfo.png" alt="" loading="lazy"/></p>
<p>这样我们就成功得到了一张兰博基尼的照片。</p>
<p>同时注意到 <code>actions</code> 里面又包含了几个可进行的操作，介绍如下：</p>
<ul>
<li><code>upscale_2x</code>：对画面放大 2 倍，得到 2 倍高清图。</li>
<li><code>upscale_4x</code>：对画面放大 4 倍，得到 4 倍高清图。</li>
<li><code>zoom_out_2x</code>：对画面进行缩小两倍操作（周围区域填充）。</li>
<li><code>zoom_out_1_5x</code>：对画面进行缩小 1.5 倍操作（周围区域填充）。</li>
<li><code>pan_left</code>：对画面进行左偏移操作。</li>
<li><code>pan_right</code>：对画面进行右便宜操作。</li>
<li><code>pan_up</code>：对画面进行上偏移操作。</li>
<li><code>pan_down</code>：对画面进行下偏移操作。</li>
</ul>
<p>可以继续按照上述流程传入对应的变换指令进行连续生图操作。</p>
<h2 data-id="heading-3">图像改写（垫图）</h2>
<p>该 API 也支持图像改写，俗称垫图，我们可以输入一张图片 URL 以及需要改写的描述文字，该 API 就可以返回改写后的图片。</p>
<blockquote>
<p>注意：输入的图片 URL 需要是一张纯图片，不能是一个网页里面展示一张图片，否则无法进行图像改写。建议使用图床来上传获取图片的 URL。</p>
</blockquote>
<p>例如，我们这里有一张公路落日的图片，公路旁边有一些树木和楼房，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/mq335u.png" alt="" loading="lazy"/></p>
<p>现在我们想在它的基础上改写成海滩旁边，同时放一辆汽车停在路边。我们就可以构造如下的 prompt：</p>
<pre><code class="hljs language-bash" lang="bash">https://cdn.acedata.cloud/v014oc.png an illustration of a car parked on the beach --iw 2
</code></pre>
<p>可以看到，我们的 prompt 的最开头是一个 HTTPS 开头的图片链接，然后接着加一个空格，后面跟上 prompt 文字的内容。这里我们还用了额外的一些高级参数，如 <code>—iw 2</code> 来调整图片的权重。</p>
<p>我们可以将如上内容作为一个整体，传递给 <code>prompt</code> 字段，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/pfcoy1.png" alt="" loading="lazy"/></p>
<p>输出结果如下：</p>
<pre><code class="hljs language-bash" lang="bash">{
  <span class="hljs-string">"image_url"</span>: <span class="hljs-string">"https://midjourney.cdn.acedata.cloud/attachments/1234427310434947145/1234539663515975690/atmateosa5693_An_illustration_of_a_car_parked_on_the_beach_id26_cc8650ec-7e4b-4685-8911-78172430d8a7.png?ex=66311a28&amp;is=662fc8a8&amp;hm=c39707a1f22bc7f12874060ea6ed58ba37c188139ccc9a13c61ed9f37e66ea74&amp;width=1456&amp;height=816"</span>,
  <span class="hljs-string">"image_width"</span>: 1456,
  <span class="hljs-string">"image_height"</span>: 816,
  <span class="hljs-string">"image_id"</span>: <span class="hljs-string">"1234539663515975690"</span>,
  <span class="hljs-string">"raw_image_url"</span>: <span class="hljs-string">"https://midjourney.cdn.acedata.cloud/attachments/1234427310434947145/1234539663515975690/atmateosa5693_An_illustration_of_a_car_parked_on_the_beach_id26_cc8650ec-7e4b-4685-8911-78172430d8a7.png?ex=66311a28&amp;is=662fc8a8&amp;hm=c39707a1f22bc7f12874060ea6ed58ba37c188139ccc9a13c61ed9f37e66ea74&amp;"</span>,
  <span class="hljs-string">"raw_image_width"</span>: 2912,
  <span class="hljs-string">"raw_image_height"</span>: 1632,
  <span class="hljs-string">"progress"</span>: 100,
  <span class="hljs-string">"actions"</span>: [
    <span class="hljs-string">"upscale1"</span>,
    <span class="hljs-string">"upscale2"</span>,
    <span class="hljs-string">"upscale3"</span>,
    <span class="hljs-string">"upscale4"</span>,
    <span class="hljs-string">"reroll"</span>,
    <span class="hljs-string">"variation1"</span>,
    <span class="hljs-string">"variation2"</span>,
    <span class="hljs-string">"variation3"</span>,
    <span class="hljs-string">"variation4"</span>
  ],
  <span class="hljs-string">"task_id"</span>: <span class="hljs-string">"24a79e8b-a79d-471a-aef7-089dc0627ee8"</span>,
  <span class="hljs-string">"success"</span>: <span class="hljs-literal">true</span>
}

</code></pre>
<p>这时候我们就得到了如下生成的图片：</p>
<p><img src="https://cdn.acedata.cloud/1vwkuv.png" alt="" loading="lazy"/></p>
<p>可以看到，在原来的图片整体风格和构图不变的前提下，整个场景变成了海滩旁边，同时公路上还出现了汽车，这就是 Prompt with Image。</p>
<h2 data-id="heading-4">图像融合</h2>
<p>该 API 也支持图像融合，我们可以传入多张图片，以实现不同的图片融合效果。</p>
<p>比如说这里我们一共有两张图片，一张是一只玩具熊，另一张是一个电锯，分别如图所示：</p>
<p><img src="https://cdn.acedata.cloud/8fapzl.png" width="300" class="m-auto" loading="lazy"/></p>
<p><img src="https://cdn.acedata.cloud/c1igbw.png" width="300" class="m-auto" loading="lazy"/></p>
<p>现在我们想把二者融合起来，让这只熊拿着这个电锯，怎么做呢？</p>
<p>我们可以构造如下的 prompt：</p>
<pre><code class="hljs language-bash" lang="bash">https://cdn.acedata.cloud/8fapzl.png https://cdn.acedata.cloud/c1igbw.png The bear is holding the chainsaw --iw 2
</code></pre>
<p>可以发现，和 Image with Prompt 类似，我们这里将多张图片 URL 放在了 prompt 开头，并以空格分隔，最后再加上文字 prompt，将如上内容作为一个整体传递给 <code>prompt</code> 参数，运行效果如下：</p>
<pre><code class="hljs language-bash" lang="bash">{
  <span class="hljs-string">"image_url"</span>: <span class="hljs-string">"https://midjourney.cdn.acedata.cloud/attachments/1234291876639674388/1234547236830973972/kcisok_The_bear_is_holding_the_chainsaw_id8873344_ad605bc4-ba19-4807-b94f-367dab672f7a.png?ex=66312136&amp;is=662fcfb6&amp;hm=0fb1e2261c9a30b04de9da9b23b7562eb73677f1bbda1fae52c7243b12d25aac&amp;width=1024&amp;height=1024"</span>,
  <span class="hljs-string">"image_width"</span>: 1024,
  <span class="hljs-string">"image_height"</span>: 1024,
  <span class="hljs-string">"image_id"</span>: <span class="hljs-string">"1234547236830973972"</span>,
  <span class="hljs-string">"raw_image_url"</span>: <span class="hljs-string">"https://midjourney.cdn.acedata.cloud/attachments/1234291876639674388/1234547236830973972/kcisok_The_bear_is_holding_the_chainsaw_id8873344_ad605bc4-ba19-4807-b94f-367dab672f7a.png?ex=66312136&amp;is=662fcfb6&amp;hm=0fb1e2261c9a30b04de9da9b23b7562eb73677f1bbda1fae52c7243b12d25aac&amp;"</span>,
  <span class="hljs-string">"raw_image_width"</span>: 2048,
  <span class="hljs-string">"raw_image_height"</span>: 2048,
  <span class="hljs-string">"progress"</span>: 100,
  <span class="hljs-string">"actions"</span>: [
    <span class="hljs-string">"upscale1"</span>,
    <span class="hljs-string">"upscale2"</span>,
    <span class="hljs-string">"upscale3"</span>,
    <span class="hljs-string">"upscale4"</span>,
    <span class="hljs-string">"reroll"</span>,
    <span class="hljs-string">"variation1"</span>,
    <span class="hljs-string">"variation2"</span>,
    <span class="hljs-string">"variation3"</span>,
    <span class="hljs-string">"variation4"</span>
  ],
  <span class="hljs-string">"task_id"</span>: <span class="hljs-string">"891f2645-ee15-4c7b-ac24-d98163c8e57e"</span>,
  <span class="hljs-string">"success"</span>: <span class="hljs-literal">true</span>
}

</code></pre>
<p>我们就得到了如下结果：</p>
<p><img src="https://cdn.acedata.cloud/vjtzdo.png" alt="" loading="lazy"/></p>
<p>可以看到，我们就成功实现了图片融合。</p>
<blockquote>
<p>注意：图片融合最多可以支持 5 个图片 URL 作为输入，也就是最多支持 5 张图片融合，输入格式同上。</p>
</blockquote>
<h2 data-id="heading-5">异步回调</h2>
<p>由于 Midjourney 生成图片需要等待一段时间，所以本 API 也默认设计为了长等待模式。但在部分场景下，长等待可能会带来一些额外的资源开销，因此本 API 也提供了异步 Webhook 回调的方式，当图片生成成功或失败时，其结果都会通过 HTTP 请求的方式发送到指定的 Webhook 回调 URL。回调 URL 接收到结果之后可以进行进一步的处理。</p>
<p>下面演示具体的调用流程。</p>
<p>首先，Webhook 回调是一个可以接收 HTTP 请求的服务，开发者应该替换为自己搭建的 HTTP 服务器的 URL。此处为了方便演示，使用一个公开的 Webhook 样例网站 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwebhook.site%2F" title="https://webhook.site/" target="_blank" ref="nofollow noopener noreferrer">webhook.site/</a>，打开该网站即可得到一个 Webhook URL，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/srf3tq.png" alt="" loading="lazy"/></p>
<p>将此 URL 复制下来，就可以作为 Webhook 来使用，此处的样例为 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwebhook.site%2F995d0a91-d737-40a7-a3b9-5baf68ed924c" title="https://webhook.site/995d0a91-d737-40a7-a3b9-5baf68ed924c" target="_blank" ref="nofollow noopener noreferrer">webhook.site/995d0a91-d7…</a>。</p>
<p>接下来，我们可以设置字段 <code>callback_url</code> 为上述 Webhook URL，同时填入 <code>prompt</code>，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/hclosy.png" alt="" loading="lazy"/></p>
<p>点击测试之后会立即得到一个 <code>task_id</code> 的响应，用于标识当前生成任务的 ID，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/vkr32a.png" width="300" class="m-auto" loading="lazy"/></p>
<p>稍等片刻，等图片生成结束，可以发发现 Webhook URL 收到了一个 HTTP 请求，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/6znvgq.png" alt="" loading="lazy"/></p>
<p>其结果就是当前任务的结果，内容如下：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"f6e39eaf-652a-4bf5-a15c-79d8b143b80a"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"image_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://midjourney.cdn.acedata.cloud/attachments/1234291876639674388/1234551030549839932/kcisok_A_cat_sitting_on_a_table_id2724480_591c5c85-ec80-42ab-9fe5-9adfbed192e4.png?ex=663124be&amp;is=662fd33e&amp;hm=da725eb74aae375d60beec38b4cd26c5a7b373b1662f222ff838a8ea6fd5e798&amp;width=1024&amp;height=1024"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"image_width"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1024</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"image_height"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1024</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"image_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1234551030549839932"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"raw_image_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://midjourney.cdn.acedata.cloud/attachments/1234291876639674388/1234551030549839932/kcisok_A_cat_sitting_on_a_table_id2724480_591c5c85-ec80-42ab-9fe5-9adfbed192e4.png?ex=663124be&amp;is=662fd33e&amp;hm=da725eb74aae375d60beec38b4cd26c5a7b373b1662f222ff838a8ea6fd5e798&amp;"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"raw_image_width"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2048</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"raw_image_height"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2048</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"progress"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">100</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"actions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"upscale1"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"upscale2"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"upscale3"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"upscale4"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"reroll"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"variation1"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"variation2"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"variation3"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"variation4"</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>其中 <code>success</code> 字段标识了该任务是否执行成功，如果执行成功，还会有同样的 <code>actions</code>, <code>image_id</code>, <code>image_url</code> 字段，和上文介绍的返回结果是一样的，另外还有 <code>task_id</code> 用于标识任务，以实现 Webhook 结果和最初 API 请求的关联。</p>
<p>如果图片生成失败，Webhook URL 则会收到类似如下内容：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"7ba0feaf-d20b-4c22-a35a-31ec30fc7715"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"error"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"bad_request"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Unrecognized argument(s): `-c`, `x`"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>这里的 <code>success</code> 字段会是 <code>false</code>，同时还会有 <code>error.code</code> 和 <code>error.message</code> 字段描述了任务错误的详情信息，Webhook 服务器根据对应的结果进行处理即可。</p>
<h2 data-id="heading-6">流式输出</h2>
<p>Midjourney 官方在生成图片的时候是有进度的，在最开始是一张模糊的照片，然后经过几次迭代之后，图片逐渐变得清晰，最后得到完整的图片。</p>
<p>所以，一张图片的生成过程大约可以分为「发送命令」-&gt;「开始生图（多次迭代逐渐清晰）」-&gt;「生图完毕」的阶段。</p>
<p>在没开启流式输出的情况下，本 API 从发起请求到返回结果，实际上是从上述「发送命令」-&gt;「生图完毕」的全过程，中间生图的过程也全被包含在里面，由于 Midjourney 本身生成图片速度较慢，整个过程大约需要等待一分钟或更久。</p>
<p>所以为了更好的用户体验，本 API 支持流式输出，即当「开始生图」的时候就开始返回结果，每当绘制进度有变化，就会流式将结果输出，直至生图结束。</p>
<p>如果想流式返回响应，可以更改请求头里面的 <code>accept</code> 参数，修改为 <code>application/x-ndjson</code>，不过调用代码需要有对应的更改才能支持流式响应。</p>
<p>Python 样例代码：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests

url = <span class="hljs-string">'https://api.acedata.cloud/midjourney/imagine'</span>
headers = {
    <span class="hljs-string">'content-type'</span>: <span class="hljs-string">'application/json'</span>,
    <span class="hljs-string">'accept'</span>: <span class="hljs-string">'application/x-ndjson'</span>,
    <span class="hljs-string">'authorization'</span>: <span class="hljs-string">'Bearer {token}'</span>
}
body = {
    <span class="hljs-string">"prompt"</span>: <span class="hljs-string">"a beautiful cat --v 6"</span>
}
r = requests.post(url, headers=headers, json=body, stream=<span class="hljs-literal">True</span>)
<span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> r.iter_lines():
    <span class="hljs-built_in">print</span>(line.decode())
</code></pre>
<p>运行结果：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span><span class="hljs-attr">"image_url"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"https://midjourney.cdn.acedata.cloud/attachments/1234291876639674388/1234558451443699803/eae94f0f-0ba5-4b3c-9bad-59fb33ac2cbc_grid_0.webp?ex=66312ba7&amp;is=662fda27&amp;hm=4625d5f12158bffc07c4faaf6ce75af6f1396122f148b33b91f3e20b48fecc8b&amp;width=256&amp;height=256"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"image_width"</span><span class="hljs-punctuation">:</span><span class="hljs-number">256</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"image_height"</span><span class="hljs-punctuation">:</span><span class="hljs-number">256</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"image_id"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"1234558451443699803"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"raw_image_url"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"https://midjourney.cdn.acedata.cloud/attachments/1234291876639674388/1234558451443699803/eae94f0f-0ba5-4b3c-9bad-59fb33ac2cbc_grid_0.webp?ex=66312ba7&amp;is=662fda27&amp;hm=4625d5f12158bffc07c4faaf6ce75af6f1396122f148b33b91f3e20b48fecc8b&amp;"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"raw_image_width"</span><span class="hljs-punctuation">:</span><span class="hljs-number">512</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"raw_image_height"</span><span class="hljs-punctuation">:</span><span class="hljs-number">512</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"progress"</span><span class="hljs-punctuation">:</span><span class="hljs-number">35</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"actions"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"49589d2c-b6b3-4fbf-9f82-93068509c76f"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">{</span><span class="hljs-attr">"image_url"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"https://midjourney.cdn.acedata.cloud/attachments/1234291876639674388/1234558458595115149/eae94f0f-0ba5-4b3c-9bad-59fb33ac2cbc_grid_0.webp?ex=66312ba9&amp;is=662fda29&amp;hm=9af53fa645127131a88dfbb3930add7abda710c12a3d6c30c457d6a067b36bab&amp;width=256&amp;height=256"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"image_width"</span><span class="hljs-punctuation">:</span><span class="hljs-number">256</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"image_height"</span><span class="hljs-punctuation">:</span><span class="hljs-number">256</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"image_id"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"1234558458595115149"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"raw_image_url"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"https://midjourney.cdn.acedata.cloud/attachments/1234291876639674388/1234558458595115149/eae94f0f-0ba5-4b3c-9bad-59fb33ac2cbc_grid_0.webp?ex=66312ba9&amp;is=662fda29&amp;hm=9af53fa645127131a88dfbb3930add7abda710c12a3d6c30c457d6a067b36bab&amp;"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"raw_image_width"</span><span class="hljs-punctuation">:</span><span class="hljs-number">512</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"raw_image_height"</span><span class="hljs-punctuation">:</span><span class="hljs-number">512</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"progress"</span><span class="hljs-punctuation">:</span><span class="hljs-number">75</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"actions"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"49589d2c-b6b3-4fbf-9f82-93068509c76f"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">{</span><span class="hljs-attr">"image_url"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"https://midjourney.cdn.acedata.cloud/attachments/1234291876639674388/1234558483408490566/kcisok_A_landscape_painting_of_a_beautiful_sunset_id5963392_eae94f0f-0ba5-4b3c-9bad-59fb33ac2cbc.png?ex=66312baf&amp;is=662fda2f&amp;hm=185ea8f130806bf8bd96911bd251808455fd65596edcdb459f9b3cfd7860387c&amp;width=1024&amp;height=1024"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"image_width"</span><span class="hljs-punctuation">:</span><span class="hljs-number">1024</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"image_height"</span><span class="hljs-punctuation">:</span><span class="hljs-number">1024</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"image_id"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"1234558483408490566"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"raw_image_url"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"https://midjourney.cdn.acedata.cloud/attachments/1234291876639674388/1234558483408490566/kcisok_A_landscape_painting_of_a_beautiful_sunset_id5963392_eae94f0f-0ba5-4b3c-9bad-59fb33ac2cbc.png?ex=66312baf&amp;is=662fda2f&amp;hm=185ea8f130806bf8bd96911bd251808455fd65596edcdb459f9b3cfd7860387c&amp;"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"raw_image_width"</span><span class="hljs-punctuation">:</span><span class="hljs-number">2048</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"raw_image_height"</span><span class="hljs-punctuation">:</span><span class="hljs-number">2048</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"progress"</span><span class="hljs-punctuation">:</span><span class="hljs-number">100</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"actions"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-string">"upscale1"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"upscale2"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"upscale3"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"upscale4"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"reroll"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"variation1"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"variation2"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"variation3"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"variation4"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"49589d2c-b6b3-4fbf-9f82-93068509c76f"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">}</span>
</code></pre>
<p>可以看到，启用流式输出之后，返回结果就是逐行的 JSON 了。</p>
<p>在 Node.js 环境中，实现代码可写为如下：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">"axios"</span>);

<span class="hljs-keyword">const</span> url = <span class="hljs-string">"https://api.acedata.cloud/midjourney/imagine"</span>;
<span class="hljs-keyword">const</span> headers = {
  <span class="hljs-string">"content-type"</span>: <span class="hljs-string">"application/json"</span>,
  <span class="hljs-attr">accept</span>: <span class="hljs-string">"application/x-ndjson"</span>,
  <span class="hljs-attr">authorization</span>: <span class="hljs-string">"Bearer {token}"</span>,
};
<span class="hljs-keyword">const</span> body = {
  <span class="hljs-attr">prompt</span>: <span class="hljs-string">"a beautiful cat --v 6"</span>,
  <span class="hljs-attr">action</span>: <span class="hljs-string">"generate"</span>,
};

axios
  .<span class="hljs-title function_">post</span>(url, body, { <span class="hljs-attr">headers</span>: headers, <span class="hljs-attr">responseType</span>: <span class="hljs-string">"stream"</span> })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">status</span>);
    response.<span class="hljs-property">data</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">"data"</span>, <span class="hljs-function">(<span class="hljs-params">chunk</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(chunk.<span class="hljs-title function_">toString</span>());
    });
  })
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error);
  });
</code></pre>
<p>这些示例运行的结果都是相似的。</p>
<p>请注意，流式输出结果中有一个称为 progress 的字段，表示生成进度，范围从 0 到 100。如果需要，您可以在页面上显示这些信息。</p>
<blockquote>
<p>注意：当生成未完全完成时，<code>actions</code> 字段为空，表示无法对中间图像执行进一步处理操作。生成完成后，在生成过程中生成的 image_url 将被销毁。</p>
</blockquote>
<p>此外，您可以通过指定 <code>accept=application/x-ndjson</code> 的请求头和 callback_url 的请求体，将流式结果与异步回调结合起来，然后 callback_url 可以接收到多个流式结果的 POST 请求。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[5分钟快速搭建 AI 平台并用它赚钱！]]></title>    <link>https://juejin.cn/post/7603677143215095823</link>    <guid>https://juejin.cn/post/7603677143215095823</guid>    <pubDate>2026-02-08T14:59:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603677143215095823" data-draft-id="7603677143215079439" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="5分钟快速搭建 AI 平台并用它赚钱！"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-02-08T14:59:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="崔庆才丨静觅"/> <meta itemprop="url" content="https://juejin.cn/user/1521379821230269"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            5分钟快速搭建 AI 平台并用它赚钱！
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1521379821230269/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    崔庆才丨静觅
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T14:59:06.000Z" title="Sun Feb 08 2026 14:59:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FAceDataCloud%2FNexior" target="_blank" title="https://github.com/AceDataCloud/Nexior" ref="nofollow noopener noreferrer">Nexior</a> 是 GitHub 上的一个开源项目，利用它我们可以一键部署自己的 AI 应用站点，包括 AI 问答、Midjourney 绘画、知识库问答、艺术二维码等应用，无需自己开发 AI 系统、无需采购 AI 账号、无需关心 API 支持、无需配置支付系统，零启动成本，无风险通过 AI 赚取收益。</p>
<p>本文章会介绍 Nexior 项目在 Vercel 上的部署流程，无需任何编程技巧即可几分钟部署一套属于自己的 AI 站点，并轻松利用该站点获取收益。</p>
<h2 data-id="heading-0">准备</h2>
<p>首先打开 Nexior 的 GitHub 仓库，地址为：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FAceDataCloud%2FNexior" target="_blank" title="https://github.com/AceDataCloud/Nexior" ref="nofollow noopener noreferrer">github.com/AceDataClou…</a>，然后注册或登录 GitHub 账号，点击 Fork，克隆一份代码到自己的本地仓库，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/3zf2hx.png" alt="" loading="lazy"/></p>
<p>Fork 完毕之后，我们便可以得到如下自己的个人仓库，如下：</p>
<p><img src="https://cdn.acedata.cloud/bcxmlc.png" alt="" loading="lazy"/></p>
<p>这里的示例账号是 Germey，所以可以看到这里我们就 Fork 到了 Germey 这个用户下，同时有一个 forked from <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FAceDataCloud%2FNexior" target="_blank" title="https://github.com/AceDataCloud/Nexior" ref="nofollow noopener noreferrer">AceDataCloud/Nexior</a> 的字样，这样准备工作就完成了。</p>
<h2 data-id="heading-1">Vercel 部署</h2>
<p>Vercel 是一个可以帮助快速部署项目网站的平台，我们可以利用它直接和 GitHub 仓库对接，然后把 GitHub 仓库的源代码快速部署到线上，下面介绍下 Vercel 部署 Nexior 项目的流程。</p>
<p>打开 <a href="https://link.juejin.cn?target=https%3A%2F%2Fvercel.com%2F" target="_blank" title="https://vercel.com/" ref="nofollow noopener noreferrer">vercel.com/</a>，使用 GitHub 登录。</p>
<p>我们便会看到类似如下的页面，这时候点击 Import 按钮，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/jjcnnq.png" width="600" class="m-auto" loading="lazy"/></p>
<p>此时，Vercel 便展示了你的 GitHub 仓库，选择刚才 Fork 的 Nexior 仓库即可，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/38advc.png" width="600" class="m-auto" loading="lazy"/></p>
<p>找到 Nexior 仓库之后，点击 Import 按钮导入。</p>
<p>接着便会弹出一个配置页面，完全保持默认配置，点击 Deploy 按钮，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/6kvz1p.png" width="600" class="m-auto" loading="lazy"/></p>
<p>点击 Deploy 之后，Vercel 便开始构建整个项目并进行部署，我们不需要做任何操作，只需等待 1-2 分钟左右即可，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/1i9ss8.png" alt="" loading="lazy"/></p>
<p>部署完毕之后，Vercel 便会弹出一个页面恭喜你的部署已经完成，此时你就成功把 Nexior 项目部署到你的线上环境了，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/qn8ndd.png" alt="" loading="lazy"/></p>
<p>点击 Continue to Dashboard，我们便可以看到 Vercel 为我们生成的预览域名，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/c9p0r2.png" alt="" loading="lazy"/></p>
<p>此时直接打开这个链接，比如这里的样例地址是 <a href="https://link.juejin.cn?target=https%3A%2F%2Fnexior-germeys-projects.vercel.app%2F" target="_blank" title="https://nexior-germeys-projects.vercel.app/" ref="nofollow noopener noreferrer">nexior-germeys-projects.vercel.app/</a>，打开之后，我们便可以看到 Nexior 项目的运行情况了。</p>
<p>打开之后注册登录一下，比如用邮箱、GitHub 登录都是可以的，登录完毕之后便可以看到一个配置页面，比如 Site Configuration，我们可以自行修改该站点的标题、Logo、Favicon、管理员等信息，如下图所示：</p>
<p><img src="https://cdn.acedata.cloud/o4fuy6.png" width="600" class="m-auto" loading="lazy"/></p>
<p>同时还有一个比较重要的部分就是分销推广的配置，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/d8c4md.png" width="600" class="m-auto" loading="lazy"/></p>
<p>这里我们可以修改两个信息，一个叫默认邀请人 ID、一个叫强制邀请人 ID，说明如下：</p>
<ul>
<li>默认邀请人 ID：如果只设置了默认邀请人 ID，那么人人都可以分销和推广该站点，谁邀请的客户，客户的消费返利都会给到邀请人。如果站点的 URL 不携带任何推广信息的时候（URL 里面没有 inviter_id）的时候，注册用户默认情况下都会绑定到这个默认邀请人 ID 上。初始状态下这个 ID 就是站长的个人 ID。</li>
<li>强制邀请人 ID：如果设置了强制邀请人 ID，那么除了这个强制邀请人，其他人都无法从该站点获得分销返利，后台也看不到分销推广的入口。该站点所有注册用户都会被绑定到这个强制邀请人上面，所有的消费返利都是强制邀请人的。</li>
</ul>
<p>所以，对于以上两个模式，取决于站长的推广思路，视情况而定。</p>
<p>另外还有一个配置选项就是功能开关，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/zwi7hu.png" width="600" class="m-auto" loading="lazy"/></p>
<p>目前 Nexior 提供了多个功能，站长可以选择性地打开或关闭某些特定功能。</p>
<h2 data-id="heading-2">自定义域名</h2>
<p>现在我们已经成功部署了一个网站，但是域名是 Vercel 为我们分配的二级域名，其实并不利于对外推广，如果能够修改为我们的自定义域名的话就会好很多。</p>
<p>比如说我这边有一个 <a href="https://link.juejin.cn?target=https%3A%2F%2Fchictem.com" target="_blank" title="https://chictem.com" ref="nofollow noopener noreferrer">chictem.com</a> 的域名，下面介绍下自定义域名的配置。</p>
<blockquote>
<p>如果没有域名，可以到各大域名厂商注册，例如 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.namecheap.com%2F" target="_blank" title="https://www.namecheap.com/" ref="nofollow noopener noreferrer">namecheap</a>、<a href="https://link.juejin.cn?target=https%3A%2F%2Fgodaddy.com%2F" target="_blank" title="https://godaddy.com/" ref="nofollow noopener noreferrer">Godaddy</a> 等，一些中国境内服务商也可以。</p>
</blockquote>
<p>接下来我们打开 Vercel 的自定义域名配置页面：</p>
<p><img src="https://cdn.acedata.cloud/6mqomk.png" alt="" loading="lazy"/></p>
<p>此处输入你想要配置的自定义域名，比如这里示例配置为 <a href="https://link.juejin.cn?target=https%3A%2F%2Fchictem.com" target="_blank" title="https://chictem.com" ref="nofollow noopener noreferrer">chictem.com</a>，就直接填写 chictem.com，不带 <code>https://</code> 前缀，点击 Add：</p>
<p><img src="https://cdn.acedata.cloud/v7idkv.png" alt="" loading="lazy"/></p>
<p>接下来 Vercel 提示要选择域名配置的选项，推荐我们也添加一个 www 开头的域名，这个可加可不加，添加了之后就可以 www 开头的域名也能访问到此网站。这里我们直接选择最后一项直接添加根域名：</p>
<p><img src="https://cdn.acedata.cloud/zmdx31.png" width="600" class="m-auto" loading="lazy"/></p>
<p>确定之后我们就发现这里提示有一个待配置的 DNS：</p>
<p><img src="https://cdn.acedata.cloud/fu7rt7.png" alt="" loading="lazy"/></p>
<p>这里让我们添加一个 A 记录，解析到 76.76.21.21，我们这时候需要转到域名服务商这里配置下 DNS。</p>
<blockquote>
<p>注意：域名服务商取决于你在哪个网站域名买的域名，通常来说你在哪个网站买的域名，网站后台就有配置 DNS 的入口。</p>
</blockquote>
<p>下面是一个 DNS 后台配置样例：</p>
<p><img src="https://cdn.acedata.cloud/isy712.png" alt="" loading="lazy"/></p>
<p>配置完毕之后，我们就能用自定义域名访问刚配置的网站了，如图所示：</p>
<p><img src="https://cdn.acedata.cloud/ui08w3.png" alt="" loading="lazy"/></p>
<blockquote>
<p>注意：配置了新域名之后，注意我们需要进入到站点配置页面重新配置下站点标题、Logo 等选项，因为这个配置是跟域名绑定的，启用了新域名之后需要新配置站点。</p>
</blockquote>
<h2 data-id="heading-3">代码更新</h2>
<p>因为 Nexior 的源代码是在持续更新的，可能不断有新的功能或者 Bug 修复，代码会直接同步到源代码仓库 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FAceDataCloud%2FNexior" target="_blank" title="https://github.com/AceDataCloud/Nexior" ref="nofollow noopener noreferrer">github.com/AceDataClou…</a> 这里。</p>
<p>那我们部署的站点如果想同步更新最新代码，应该怎么做呢？</p>
<p>其实很简单，回到 GitHub 里面我们 Fork 的代码仓库，这里可以看到我们原本 Fork 的代码仓库已经落后于官方 Nexior 源代码几个版本了，我们可以直接点击 Sync fork 按钮，然后点击 Update branch 就可以了：</p>
<p><img src="https://cdn.acedata.cloud/zs9tgq.png" alt="" loading="lazy"/></p>
<p>点击之后，我们 fork 的仓库的代码就会更新，代码更新之后，Vercel 这边的网站也会自动更新，稍等片刻重新刷新网页就发现网站更新了。</p>
<h2 data-id="heading-4">赚取收益</h2>
<p>现在我们已经有了自定义域名，配置好如上内容之后，就可以把这个站点分享出去赚钱啦</p>
<p>所有的用户只要有付费账单，其中有一部分便会转化为收益到达分销者的账户，到时候添加客服提现即可。</p>
<p>进入分销界面，可以随时查看当前邀请人数、分销总金额、总奖励等，直接添加客服提现即可。</p>
<p><img src="https://cdn.acedata.cloud/zo05gl.png" width="600" class="m-auto" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>